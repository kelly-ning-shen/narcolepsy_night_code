cuda:0
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.321246, loss_ss: 1.659712, loss_d: 0.661535
0.0383 --- loss: 2.215851, loss_ss: 1.612001, loss_d: 0.603850
0.0766 --- loss: 2.151037, loss_ss: 1.504120, loss_d: 0.646917
0.1149 --- loss: 2.000725, loss_ss: 1.612664, loss_d: 0.388062
0.1531 --- loss: 1.960929, loss_ss: 1.369551, loss_d: 0.591378
0.1914 --- loss: 1.962211, loss_ss: 1.485528, loss_d: 0.476683
0.2297 --- loss: 2.618672, loss_ss: 1.317019, loss_d: 1.301653
0.2680 --- loss: 1.887510, loss_ss: 1.375229, loss_d: 0.512281
0.3063 --- loss: 2.043447, loss_ss: 1.300210, loss_d: 0.743238
0.3446 --- loss: 2.054055, loss_ss: 1.541951, loss_d: 0.512104
0.3828 --- loss: 1.827832, loss_ss: 1.360102, loss_d: 0.467730
0.4211 --- loss: 2.237488, loss_ss: 1.373026, loss_d: 0.864462
0.4594 --- loss: 1.792677, loss_ss: 1.202017, loss_d: 0.590660
0.4977 --- loss: 1.511112, loss_ss: 1.156397, loss_d: 0.354714
0.5360 --- loss: 2.018722, loss_ss: 1.599720, loss_d: 0.419002
0.5743 --- loss: 1.823024, loss_ss: 1.173912, loss_d: 0.649112
0.6126 --- loss: 1.903500, loss_ss: 1.394745, loss_d: 0.508755
0.6508 --- loss: 1.593861, loss_ss: 1.142052, loss_d: 0.451808
0.6891 --- loss: 1.614957, loss_ss: 1.141309, loss_d: 0.473648
0.7274 --- loss: 1.446955, loss_ss: 1.104555, loss_d: 0.342400
0.7657 --- loss: 1.829720, loss_ss: 1.478989, loss_d: 0.350731
0.8040 --- loss: 1.578504, loss_ss: 1.149893, loss_d: 0.428611
0.8423 --- loss: 1.474959, loss_ss: 1.108855, loss_d: 0.366104
0.8806 --- loss: 1.611462, loss_ss: 1.066485, loss_d: 0.544977
0.9188 --- loss: 1.427558, loss_ss: 1.208209, loss_d: 0.219349
0.9571 --- loss: 1.435123, loss_ss: 1.094178, loss_d: 0.340945
0.9954 --- loss: 1.602282, loss_ss: 1.115556, loss_d: 0.486726
Epoch finished! Loss: 1.8649440410036693
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.515509, loss_ss: 1.241683, loss_d: 0.273827
0.0383 --- loss: 1.610136, loss_ss: 1.131468, loss_d: 0.478669
0.0766 --- loss: 1.385509, loss_ss: 1.126382, loss_d: 0.259127
0.1149 --- loss: 1.239596, loss_ss: 1.106509, loss_d: 0.133086
0.1531 --- loss: 1.614023, loss_ss: 1.121072, loss_d: 0.492951
0.1914 --- loss: 1.549397, loss_ss: 1.135308, loss_d: 0.414089
0.2297 --- loss: 1.332106, loss_ss: 0.961698, loss_d: 0.370408
0.2680 --- loss: 1.476524, loss_ss: 1.163043, loss_d: 0.313480
0.3063 --- loss: 1.508667, loss_ss: 1.243919, loss_d: 0.264748
0.3446 --- loss: 1.244230, loss_ss: 1.136805, loss_d: 0.107425
0.3828 --- loss: 1.332839, loss_ss: 1.052813, loss_d: 0.280026
0.4211 --- loss: 1.625694, loss_ss: 1.106926, loss_d: 0.518767
0.4594 --- loss: 1.620311, loss_ss: 1.001771, loss_d: 0.618540
0.4977 --- loss: 1.300449, loss_ss: 1.070469, loss_d: 0.229980
0.5360 --- loss: 1.708881, loss_ss: 1.169843, loss_d: 0.539038
0.5743 --- loss: 1.418292, loss_ss: 1.188241, loss_d: 0.230051
0.6126 --- loss: 1.544976, loss_ss: 0.988749, loss_d: 0.556227
0.6508 --- loss: 1.231976, loss_ss: 1.106851, loss_d: 0.125125
0.6891 --- loss: 1.705067, loss_ss: 1.242243, loss_d: 0.462824
0.7274 --- loss: 1.206867, loss_ss: 0.981755, loss_d: 0.225112
0.7657 --- loss: 1.366745, loss_ss: 1.099708, loss_d: 0.267037
0.8040 --- loss: 1.338264, loss_ss: 1.006579, loss_d: 0.331685
0.8423 --- loss: 1.577073, loss_ss: 1.235502, loss_d: 0.341571
0.8806 --- loss: 1.141726, loss_ss: 0.866332, loss_d: 0.275394
0.9188 --- loss: 1.305787, loss_ss: 1.067388, loss_d: 0.238399
0.9571 --- loss: 1.578190, loss_ss: 1.399782, loss_d: 0.178407
0.9954 --- loss: 1.436075, loss_ss: 1.148855, loss_d: 0.287220
Epoch finished! Loss: 1.4984078676764536
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.568731, loss_ss: 0.933075, loss_d: 0.635656
0.0383 --- loss: 1.440519, loss_ss: 0.904318, loss_d: 0.536201
0.0766 --- loss: 1.306597, loss_ss: 0.998811, loss_d: 0.307787
0.1149 --- loss: 1.602416, loss_ss: 0.923557, loss_d: 0.678858
0.1531 --- loss: 1.579651, loss_ss: 1.270520, loss_d: 0.309131
0.1914 --- loss: 1.104118, loss_ss: 0.998075, loss_d: 0.106042
0.2297 --- loss: 1.104300, loss_ss: 0.988800, loss_d: 0.115500
0.2680 --- loss: 1.401011, loss_ss: 0.889502, loss_d: 0.511509
0.3063 --- loss: 1.256496, loss_ss: 0.911762, loss_d: 0.344734
0.3446 --- loss: 1.387822, loss_ss: 1.137317, loss_d: 0.250504
0.3828 --- loss: 1.160478, loss_ss: 1.061521, loss_d: 0.098957
0.4211 --- loss: 1.231474, loss_ss: 1.129690, loss_d: 0.101784
0.4594 --- loss: 1.225339, loss_ss: 1.090789, loss_d: 0.134550
0.4977 --- loss: 1.225016, loss_ss: 0.953400, loss_d: 0.271617
0.5360 --- loss: 2.080062, loss_ss: 1.081227, loss_d: 0.998836
0.5743 --- loss: 1.778513, loss_ss: 1.086292, loss_d: 0.692221
0.6126 --- loss: 1.806277, loss_ss: 0.942261, loss_d: 0.864016
0.6508 --- loss: 1.540615, loss_ss: 1.013886, loss_d: 0.526729
0.6891 --- loss: 0.918042, loss_ss: 0.825506, loss_d: 0.092536
0.7274 --- loss: 1.279534, loss_ss: 1.097130, loss_d: 0.182404
0.7657 --- loss: 1.295274, loss_ss: 1.023731, loss_d: 0.271542
0.8040 --- loss: 2.026138, loss_ss: 0.835611, loss_d: 1.190527
0.8423 --- loss: 1.228830, loss_ss: 1.041098, loss_d: 0.187733
0.8806 --- loss: 1.134926, loss_ss: 0.894715, loss_d: 0.240211
0.9188 --- loss: 1.187198, loss_ss: 0.816326, loss_d: 0.370872
0.9571 --- loss: 1.439360, loss_ss: 0.936514, loss_d: 0.502846
0.9954 --- loss: 1.188541, loss_ss: 0.892663, loss_d: 0.295878
Epoch finished! Loss: 1.3517441932268983
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.234083, loss_ss: 0.932331, loss_d: 0.301753
0.0383 --- loss: 1.832442, loss_ss: 1.078021, loss_d: 0.754420
0.0766 --- loss: 1.387330, loss_ss: 1.213751, loss_d: 0.173579
0.1149 --- loss: 1.294957, loss_ss: 0.892474, loss_d: 0.402483
0.1531 --- loss: 1.306027, loss_ss: 0.852795, loss_d: 0.453232
0.1914 --- loss: 1.298518, loss_ss: 0.965369, loss_d: 0.333149
0.2297 --- loss: 1.188488, loss_ss: 1.090491, loss_d: 0.097997
0.2680 --- loss: 1.074269, loss_ss: 0.922603, loss_d: 0.151666
0.3063 --- loss: 1.135664, loss_ss: 0.945450, loss_d: 0.190214
0.3446 --- loss: 1.307290, loss_ss: 1.071490, loss_d: 0.235800
0.3828 --- loss: 1.601172, loss_ss: 0.996581, loss_d: 0.604591
0.4211 --- loss: 1.210193, loss_ss: 1.000239, loss_d: 0.209954
0.4594 --- loss: 1.210051, loss_ss: 0.931874, loss_d: 0.278178
0.4977 --- loss: 1.318746, loss_ss: 1.093989, loss_d: 0.224757
0.5360 --- loss: 0.894835, loss_ss: 0.843468, loss_d: 0.051368
0.5743 --- loss: 1.225746, loss_ss: 1.059802, loss_d: 0.165944
0.6126 --- loss: 1.184556, loss_ss: 0.803476, loss_d: 0.381080
0.6508 --- loss: 1.555279, loss_ss: 0.998242, loss_d: 0.557037
0.6891 --- loss: 1.128119, loss_ss: 0.827388, loss_d: 0.300732
0.7274 --- loss: 1.001708, loss_ss: 0.955877, loss_d: 0.045830
0.7657 --- loss: 0.972902, loss_ss: 0.876422, loss_d: 0.096480
0.8040 --- loss: 1.988418, loss_ss: 1.558043, loss_d: 0.430375
0.8423 --- loss: 1.148974, loss_ss: 0.998753, loss_d: 0.150221
0.8806 --- loss: 1.285687, loss_ss: 1.089014, loss_d: 0.196673
0.9188 --- loss: 1.290585, loss_ss: 0.873740, loss_d: 0.416845
0.9571 --- loss: 1.465235, loss_ss: 1.088868, loss_d: 0.376367
0.9954 --- loss: 1.265126, loss_ss: 0.974977, loss_d: 0.290149
Epoch finished! Loss: 1.236529953178318
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.300975, loss_ss: 1.100129, loss_d: 0.200846
0.0383 --- loss: 1.160574, loss_ss: 0.981154, loss_d: 0.179420
0.0766 --- loss: 1.410862, loss_ss: 1.197519, loss_d: 0.213344
0.1149 --- loss: 1.046453, loss_ss: 0.754288, loss_d: 0.292165
0.1531 --- loss: 1.134530, loss_ss: 0.829427, loss_d: 0.305103
0.1914 --- loss: 2.047383, loss_ss: 0.843532, loss_d: 1.203851
0.2297 --- loss: 1.135749, loss_ss: 0.862196, loss_d: 0.273553
0.2680 --- loss: 1.074335, loss_ss: 1.004901, loss_d: 0.069433
0.3063 --- loss: 1.171122, loss_ss: 1.041965, loss_d: 0.129157
0.3446 --- loss: 1.062658, loss_ss: 0.927056, loss_d: 0.135602
0.3828 --- loss: 0.984282, loss_ss: 0.810192, loss_d: 0.174090
0.4211 --- loss: 1.045833, loss_ss: 0.907598, loss_d: 0.138235
0.4594 --- loss: 1.293977, loss_ss: 1.050428, loss_d: 0.243549
0.4977 --- loss: 0.907504, loss_ss: 0.833643, loss_d: 0.073860
0.5360 --- loss: 1.163954, loss_ss: 0.865844, loss_d: 0.298110
0.5743 --- loss: 1.191877, loss_ss: 0.974351, loss_d: 0.217526
0.6126 --- loss: 1.123736, loss_ss: 0.893327, loss_d: 0.230409
0.6508 --- loss: 1.224364, loss_ss: 1.079208, loss_d: 0.145156
0.6891 --- loss: 1.251350, loss_ss: 0.888286, loss_d: 0.363064
0.7274 --- loss: 0.902850, loss_ss: 0.762682, loss_d: 0.140168
0.7657 --- loss: 0.962249, loss_ss: 0.820391, loss_d: 0.141858
0.8040 --- loss: 1.630540, loss_ss: 1.262472, loss_d: 0.368069
0.8423 --- loss: 1.488955, loss_ss: 1.089722, loss_d: 0.399233
0.8806 --- loss: 1.901809, loss_ss: 1.719430, loss_d: 0.182380
0.9188 --- loss: 1.202617, loss_ss: 1.048732, loss_d: 0.153886
0.9571 --- loss: 1.262284, loss_ss: 0.712620, loss_d: 0.549664
0.9954 --- loss: 1.060210, loss_ss: 0.855207, loss_d: 0.205003
Epoch finished! Loss: 1.1862351133905609
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.286339, loss_ss: 0.851787, loss_d: 0.434552
0.0383 --- loss: 1.010152, loss_ss: 0.891816, loss_d: 0.118335
0.0766 --- loss: 1.052551, loss_ss: 0.920210, loss_d: 0.132341
0.1149 --- loss: 1.616752, loss_ss: 0.874594, loss_d: 0.742158
0.1531 --- loss: 1.276453, loss_ss: 1.064109, loss_d: 0.212345
0.1914 --- loss: 0.972308, loss_ss: 0.871353, loss_d: 0.100956
0.2297 --- loss: 1.000669, loss_ss: 0.872268, loss_d: 0.128400
0.2680 --- loss: 1.015872, loss_ss: 0.608390, loss_d: 0.407482
0.3063 --- loss: 1.080821, loss_ss: 0.940334, loss_d: 0.140487
0.3446 --- loss: 1.126605, loss_ss: 1.027339, loss_d: 0.099266
0.3828 --- loss: 0.878732, loss_ss: 0.738761, loss_d: 0.139971
0.4211 --- loss: 1.281750, loss_ss: 0.958936, loss_d: 0.322814
0.4594 --- loss: 1.064911, loss_ss: 0.850315, loss_d: 0.214596
0.4977 --- loss: 1.739924, loss_ss: 0.989283, loss_d: 0.750642
0.5360 --- loss: 1.390713, loss_ss: 1.339044, loss_d: 0.051669
0.5743 --- loss: 0.826092, loss_ss: 0.732066, loss_d: 0.094027
0.6126 --- loss: 1.732319, loss_ss: 1.249138, loss_d: 0.483181
0.6508 --- loss: 0.884535, loss_ss: 0.796481, loss_d: 0.088054
0.6891 --- loss: 0.841280, loss_ss: 0.783374, loss_d: 0.057906
0.7274 --- loss: 1.359254, loss_ss: 1.082619, loss_d: 0.276636
0.7657 --- loss: 1.081391, loss_ss: 0.955618, loss_d: 0.125773
0.8040 --- loss: 0.793640, loss_ss: 0.694789, loss_d: 0.098851
0.8423 --- loss: 1.194548, loss_ss: 0.979494, loss_d: 0.215054
0.8806 --- loss: 1.073605, loss_ss: 1.036082, loss_d: 0.037523
0.9188 --- loss: 0.843820, loss_ss: 0.743157, loss_d: 0.100664
0.9571 --- loss: 1.062384, loss_ss: 0.950543, loss_d: 0.111841
0.9954 --- loss: 1.780187, loss_ss: 0.512344, loss_d: 1.267842
Epoch finished! Loss: 1.1124995115616312
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.298312, loss_ss: 1.011252, loss_d: 0.287060
0.0383 --- loss: 0.950680, loss_ss: 0.904097, loss_d: 0.046583
0.0766 --- loss: 0.853627, loss_ss: 0.810893, loss_d: 0.042733
0.1149 --- loss: 0.872481, loss_ss: 0.811644, loss_d: 0.060837
0.1531 --- loss: 0.944851, loss_ss: 0.876461, loss_d: 0.068390
0.1914 --- loss: 1.201477, loss_ss: 0.909171, loss_d: 0.292306
0.2297 --- loss: 1.031397, loss_ss: 0.692168, loss_d: 0.339229
0.2680 --- loss: 0.956883, loss_ss: 0.874953, loss_d: 0.081929
0.3063 --- loss: 0.881180, loss_ss: 0.825040, loss_d: 0.056140
0.3446 --- loss: 1.593454, loss_ss: 1.207217, loss_d: 0.386237
0.3828 --- loss: 0.868403, loss_ss: 0.755573, loss_d: 0.112830
0.4211 --- loss: 0.766081, loss_ss: 0.739533, loss_d: 0.026549
0.4594 --- loss: 0.645686, loss_ss: 0.628908, loss_d: 0.016777
0.4977 --- loss: 1.040629, loss_ss: 0.863099, loss_d: 0.177529
0.5360 --- loss: 1.339423, loss_ss: 0.817485, loss_d: 0.521938
0.5743 --- loss: 0.981747, loss_ss: 0.818242, loss_d: 0.163505
0.6126 --- loss: 0.793585, loss_ss: 0.752187, loss_d: 0.041398
0.6508 --- loss: 0.990500, loss_ss: 0.772145, loss_d: 0.218355
0.6891 --- loss: 1.142748, loss_ss: 1.015358, loss_d: 0.127390
0.7274 --- loss: 0.985178, loss_ss: 0.908211, loss_d: 0.076967
0.7657 --- loss: 1.070083, loss_ss: 1.002335, loss_d: 0.067748
0.8040 --- loss: 0.721111, loss_ss: 0.706417, loss_d: 0.014695
0.8423 --- loss: 1.135498, loss_ss: 1.098554, loss_d: 0.036944
0.8806 --- loss: 0.958758, loss_ss: 0.901263, loss_d: 0.057495
0.9188 --- loss: 0.912919, loss_ss: 0.831478, loss_d: 0.081441
0.9571 --- loss: 1.034761, loss_ss: 0.736960, loss_d: 0.297801
0.9954 --- loss: 0.848498, loss_ss: 0.785429, loss_d: 0.063069
Epoch finished! Loss: 1.0421863045272242
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.772770, loss_ss: 0.741264, loss_d: 0.031505
0.0383 --- loss: 1.395838, loss_ss: 1.333367, loss_d: 0.062471
0.0766 --- loss: 0.773454, loss_ss: 0.719473, loss_d: 0.053980
0.1149 --- loss: 0.858192, loss_ss: 0.844002, loss_d: 0.014190
0.1531 --- loss: 0.769831, loss_ss: 0.682928, loss_d: 0.086902
0.1914 --- loss: 1.124249, loss_ss: 0.911064, loss_d: 0.213185
0.2297 --- loss: 1.159407, loss_ss: 1.109777, loss_d: 0.049630
0.2680 --- loss: 0.665310, loss_ss: 0.630064, loss_d: 0.035246
0.3063 --- loss: 0.909760, loss_ss: 0.760502, loss_d: 0.149258
0.3446 --- loss: 0.861087, loss_ss: 0.827078, loss_d: 0.034008
0.3828 --- loss: 1.369499, loss_ss: 0.950005, loss_d: 0.419493
0.4211 --- loss: 0.952140, loss_ss: 0.917017, loss_d: 0.035124
0.4594 --- loss: 0.960893, loss_ss: 0.950851, loss_d: 0.010043
0.4977 --- loss: 1.079489, loss_ss: 0.963084, loss_d: 0.116405
0.5360 --- loss: 1.112172, loss_ss: 0.721130, loss_d: 0.391042
0.5743 --- loss: 0.985964, loss_ss: 0.834420, loss_d: 0.151544
0.6126 --- loss: 0.798451, loss_ss: 0.772204, loss_d: 0.026246
0.6508 --- loss: 1.080219, loss_ss: 0.850041, loss_d: 0.230178
0.6891 --- loss: 0.782944, loss_ss: 0.750420, loss_d: 0.032524
0.7274 --- loss: 1.522282, loss_ss: 1.473097, loss_d: 0.049184
0.7657 --- loss: 1.041864, loss_ss: 0.993332, loss_d: 0.048532
0.8040 --- loss: 0.716280, loss_ss: 0.690674, loss_d: 0.025605
0.8423 --- loss: 1.250684, loss_ss: 1.199090, loss_d: 0.051595
0.8806 --- loss: 0.763215, loss_ss: 0.758833, loss_d: 0.004381
0.9188 --- loss: 0.809477, loss_ss: 0.703552, loss_d: 0.105925
0.9571 --- loss: 1.247076, loss_ss: 1.078762, loss_d: 0.168314
0.9954 --- loss: 1.161927, loss_ss: 0.864417, loss_d: 0.297510
Epoch finished! Loss: 1.0234291425609954
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.336109, loss_ss: 0.925681, loss_d: 0.410428
0.0383 --- loss: 0.965744, loss_ss: 0.843776, loss_d: 0.121968
0.0766 --- loss: 0.900201, loss_ss: 0.781866, loss_d: 0.118336
0.1149 --- loss: 1.286613, loss_ss: 1.133752, loss_d: 0.152861
0.1531 --- loss: 0.923153, loss_ss: 0.908870, loss_d: 0.014284
0.1914 --- loss: 0.742297, loss_ss: 0.611417, loss_d: 0.130880
0.2297 --- loss: 0.785280, loss_ss: 0.753951, loss_d: 0.031329
0.2680 --- loss: 1.079238, loss_ss: 1.053506, loss_d: 0.025732
0.3063 --- loss: 0.651675, loss_ss: 0.628939, loss_d: 0.022736
0.3446 --- loss: 0.626463, loss_ss: 0.595530, loss_d: 0.030932
0.3828 --- loss: 0.863478, loss_ss: 0.857350, loss_d: 0.006128
0.4211 --- loss: 1.002901, loss_ss: 0.995633, loss_d: 0.007269
0.4594 --- loss: 0.844029, loss_ss: 0.746100, loss_d: 0.097929
0.4977 --- loss: 1.180005, loss_ss: 1.149560, loss_d: 0.030445
0.5360 --- loss: 1.086227, loss_ss: 0.734701, loss_d: 0.351526
0.5743 --- loss: 1.131846, loss_ss: 1.009454, loss_d: 0.122392
0.6126 --- loss: 0.671340, loss_ss: 0.604475, loss_d: 0.066865
0.6508 --- loss: 1.198134, loss_ss: 0.964831, loss_d: 0.233303
0.6891 --- loss: 1.011269, loss_ss: 0.660838, loss_d: 0.350430
0.7274 --- loss: 0.965051, loss_ss: 0.768290, loss_d: 0.196761
0.7657 --- loss: 1.078850, loss_ss: 0.684136, loss_d: 0.394714
0.8040 --- loss: 1.124593, loss_ss: 0.823417, loss_d: 0.301175
0.8423 --- loss: 0.954012, loss_ss: 0.865171, loss_d: 0.088842
0.8806 --- loss: 1.055868, loss_ss: 0.976647, loss_d: 0.079221
0.9188 --- loss: 0.774642, loss_ss: 0.743316, loss_d: 0.031326
0.9571 --- loss: 0.712375, loss_ss: 0.645193, loss_d: 0.067181
0.9954 --- loss: 1.089267, loss_ss: 0.722879, loss_d: 0.366388
Epoch finished! Loss: 0.9936062782660298
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.740981, loss_ss: 0.707780, loss_d: 0.033201
0.0383 --- loss: 0.851568, loss_ss: 0.816254, loss_d: 0.035314
0.0766 --- loss: 0.849125, loss_ss: 0.815332, loss_d: 0.033793
0.1149 --- loss: 0.814751, loss_ss: 0.805492, loss_d: 0.009259
0.1531 --- loss: 0.872799, loss_ss: 0.810897, loss_d: 0.061901
0.1914 --- loss: 1.009618, loss_ss: 0.874606, loss_d: 0.135012
0.2297 --- loss: 0.971407, loss_ss: 0.964707, loss_d: 0.006700
0.2680 --- loss: 0.734080, loss_ss: 0.698866, loss_d: 0.035214
0.3063 --- loss: 0.718849, loss_ss: 0.714982, loss_d: 0.003867
0.3446 --- loss: 0.825859, loss_ss: 0.769858, loss_d: 0.056001
0.3828 --- loss: 1.279825, loss_ss: 0.733286, loss_d: 0.546540
0.4211 --- loss: 1.554457, loss_ss: 0.655968, loss_d: 0.898489
0.4594 --- loss: 1.302643, loss_ss: 1.147430, loss_d: 0.155213
0.4977 --- loss: 0.954354, loss_ss: 0.914158, loss_d: 0.040195
0.5360 --- loss: 0.967017, loss_ss: 0.957482, loss_d: 0.009536
0.5743 --- loss: 1.508327, loss_ss: 1.415707, loss_d: 0.092619
0.6126 --- loss: 0.810794, loss_ss: 0.794870, loss_d: 0.015925
0.6508 --- loss: 0.927938, loss_ss: 0.682058, loss_d: 0.245880
0.6891 --- loss: 0.719548, loss_ss: 0.684046, loss_d: 0.035503
0.7274 --- loss: 0.926559, loss_ss: 0.898913, loss_d: 0.027646
0.7657 --- loss: 0.656601, loss_ss: 0.535971, loss_d: 0.120630
0.8040 --- loss: 0.971613, loss_ss: 0.670144, loss_d: 0.301470
0.8423 --- loss: 0.871302, loss_ss: 0.867087, loss_d: 0.004215
0.8806 --- loss: 2.331144, loss_ss: 0.703734, loss_d: 1.627411
0.9188 --- loss: 0.924974, loss_ss: 0.537086, loss_d: 0.387888
0.9571 --- loss: 1.429837, loss_ss: 0.788164, loss_d: 0.641672
0.9954 --- loss: 0.854108, loss_ss: 0.844338, loss_d: 0.009770
Epoch finished! Loss: 0.9633697387815892
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8641025641025641
             precision    recall  f1-score   support

        0.0       0.67      0.96      0.79        78
        1.0       0.50      0.16      0.24        50
        2.0       0.89      0.96      0.92       397
        3.0       0.93      0.97      0.95       143
        4.0       0.97      0.63      0.77       112

avg / total       0.86      0.86      0.85       780
 


====== chc001-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.87  96.15   94.73  66.96     78.95
1  93.59  16.00   98.90  50.00     24.24
2  91.79  95.97   87.47  88.81     92.25
3  98.08  97.20   98.27  92.67     94.88
4  94.49  63.39   99.70  97.26     76.76
Total accuracy: 86.41%
Average sen: 73.74%
Average spec: 95.81%
Macro f1-score: 73.42%
Diagnosis acc on 15mins: 0.9615384615384616
[5.77730185e-04 1.83245004e-03 1.50740787e-04 4.27863561e-03
 3.10650002e-03 4.58140348e-05 2.91411736e-04 3.34634766e-04
 2.34140287e-04 7.26839702e-04 1.76404137e-03 2.48936150e-04
 2.39216350e-03 1.68386530e-02 9.67448053e-04 6.13214390e-04
 4.18057345e-04 3.38624907e-03 7.95990881e-03 3.73843964e-03
 5.83498895e-01 2.37176269e-01 2.00911954e-01 1.25170782e-01
 7.90380966e-03 6.74983836e-04]
pred: 0.04635548856598549, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.354525, loss_ss: 1.708619, loss_d: 0.645907
0.0384 --- loss: 2.068857, loss_ss: 1.556039, loss_d: 0.512819
0.0768 --- loss: 2.067355, loss_ss: 1.468354, loss_d: 0.599001
0.1153 --- loss: 2.066879, loss_ss: 1.461449, loss_d: 0.605431
0.1537 --- loss: 2.285149, loss_ss: 1.595609, loss_d: 0.689539
0.1921 --- loss: 2.203368, loss_ss: 1.520842, loss_d: 0.682526
0.2305 --- loss: 1.988470, loss_ss: 1.422420, loss_d: 0.566050
0.2689 --- loss: 1.927130, loss_ss: 1.456438, loss_d: 0.470692
0.3073 --- loss: 2.198354, loss_ss: 1.500966, loss_d: 0.697388
0.3458 --- loss: 1.821048, loss_ss: 1.533092, loss_d: 0.287956
0.3842 --- loss: 1.835913, loss_ss: 1.432114, loss_d: 0.403799
0.4226 --- loss: 2.032251, loss_ss: 1.431089, loss_d: 0.601162
0.4610 --- loss: 1.889410, loss_ss: 1.503725, loss_d: 0.385685
0.4994 --- loss: 1.789219, loss_ss: 1.271324, loss_d: 0.517895
0.5378 --- loss: 2.012400, loss_ss: 1.340757, loss_d: 0.671643
0.5763 --- loss: 2.089789, loss_ss: 1.448158, loss_d: 0.641631
0.6147 --- loss: 2.057214, loss_ss: 1.356945, loss_d: 0.700269
0.6531 --- loss: 1.877590, loss_ss: 1.186935, loss_d: 0.690655
0.6915 --- loss: 1.899059, loss_ss: 1.314485, loss_d: 0.584574
0.7299 --- loss: 1.799143, loss_ss: 1.308930, loss_d: 0.490213
0.7683 --- loss: 1.649807, loss_ss: 1.280391, loss_d: 0.369416
0.8068 --- loss: 1.490304, loss_ss: 1.143101, loss_d: 0.347203
0.8452 --- loss: 1.833032, loss_ss: 1.206662, loss_d: 0.626370
0.8836 --- loss: 1.669921, loss_ss: 1.216600, loss_d: 0.453322
0.9220 --- loss: 1.954229, loss_ss: 1.112537, loss_d: 0.841692
0.9604 --- loss: 1.587244, loss_ss: 1.130111, loss_d: 0.457133
0.9988 --- loss: 1.834221, loss_ss: 1.110816, loss_d: 0.723405
Epoch finished! Loss: 1.9245921130363757
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.610874, loss_ss: 1.262339, loss_d: 0.348534
0.0384 --- loss: 1.572621, loss_ss: 1.127323, loss_d: 0.445298
0.0768 --- loss: 1.483813, loss_ss: 1.191408, loss_d: 0.292405
0.1153 --- loss: 1.814838, loss_ss: 1.414143, loss_d: 0.400695
0.1537 --- loss: 1.962359, loss_ss: 1.577235, loss_d: 0.385125
0.1921 --- loss: 1.447185, loss_ss: 1.152077, loss_d: 0.295108
0.2305 --- loss: 1.642487, loss_ss: 1.443271, loss_d: 0.199215
0.2689 --- loss: 1.510596, loss_ss: 1.109832, loss_d: 0.400765
0.3073 --- loss: 1.673819, loss_ss: 1.345492, loss_d: 0.328327
0.3458 --- loss: 1.565123, loss_ss: 1.235818, loss_d: 0.329305
0.3842 --- loss: 1.398276, loss_ss: 1.192825, loss_d: 0.205451
0.4226 --- loss: 1.787695, loss_ss: 1.095936, loss_d: 0.691759
0.4610 --- loss: 1.442767, loss_ss: 1.186745, loss_d: 0.256022
0.4994 --- loss: 1.523810, loss_ss: 1.226232, loss_d: 0.297579
0.5378 --- loss: 1.263760, loss_ss: 1.054136, loss_d: 0.209625
0.5763 --- loss: 1.389541, loss_ss: 1.194873, loss_d: 0.194667
0.6147 --- loss: 1.262020, loss_ss: 1.058188, loss_d: 0.203831
0.6531 --- loss: 1.327598, loss_ss: 1.142131, loss_d: 0.185467
0.6915 --- loss: 1.747317, loss_ss: 1.048268, loss_d: 0.699049
0.7299 --- loss: 1.632684, loss_ss: 1.561957, loss_d: 0.070726
0.7683 --- loss: 1.887536, loss_ss: 1.141522, loss_d: 0.746014
0.8068 --- loss: 1.350619, loss_ss: 1.045376, loss_d: 0.305243
0.8452 --- loss: 1.372162, loss_ss: 1.010759, loss_d: 0.361403
0.8836 --- loss: 1.433687, loss_ss: 1.129178, loss_d: 0.304509
0.9220 --- loss: 1.569271, loss_ss: 1.252249, loss_d: 0.317022
0.9604 --- loss: 1.288878, loss_ss: 1.028672, loss_d: 0.260206
0.9988 --- loss: 1.793387, loss_ss: 1.639910, loss_d: 0.153477
Epoch finished! Loss: 1.5292252540588378
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.613753, loss_ss: 0.965882, loss_d: 0.647871
0.0384 --- loss: 1.239842, loss_ss: 1.017031, loss_d: 0.222811
0.0768 --- loss: 1.570692, loss_ss: 0.916639, loss_d: 0.654054
0.1153 --- loss: 1.268394, loss_ss: 0.889147, loss_d: 0.379247
0.1537 --- loss: 1.109013, loss_ss: 0.925376, loss_d: 0.183636
0.1921 --- loss: 1.306818, loss_ss: 1.168604, loss_d: 0.138213
0.2305 --- loss: 1.097805, loss_ss: 0.999327, loss_d: 0.098477
0.2689 --- loss: 1.448420, loss_ss: 0.924958, loss_d: 0.523463
0.3073 --- loss: 1.196979, loss_ss: 0.970505, loss_d: 0.226474
0.3458 --- loss: 1.391782, loss_ss: 1.201079, loss_d: 0.190703
0.3842 --- loss: 1.478557, loss_ss: 0.961445, loss_d: 0.517112
0.4226 --- loss: 1.257729, loss_ss: 0.963725, loss_d: 0.294004
0.4610 --- loss: 1.406434, loss_ss: 1.045658, loss_d: 0.360776
0.4994 --- loss: 1.150997, loss_ss: 1.095866, loss_d: 0.055131
0.5378 --- loss: 1.107095, loss_ss: 0.958863, loss_d: 0.148232
0.5763 --- loss: 1.871582, loss_ss: 1.062842, loss_d: 0.808741
0.6147 --- loss: 1.121470, loss_ss: 0.884796, loss_d: 0.236674
0.6531 --- loss: 1.215364, loss_ss: 0.917102, loss_d: 0.298262
0.6915 --- loss: 0.929890, loss_ss: 0.842346, loss_d: 0.087543
0.7299 --- loss: 1.272873, loss_ss: 0.950552, loss_d: 0.322321
0.7683 --- loss: 1.633001, loss_ss: 1.178709, loss_d: 0.454292
0.8068 --- loss: 1.192227, loss_ss: 0.989188, loss_d: 0.203038
0.8452 --- loss: 1.261279, loss_ss: 1.182873, loss_d: 0.078406
0.8836 --- loss: 1.286636, loss_ss: 1.138226, loss_d: 0.148410
0.9220 --- loss: 1.326989, loss_ss: 0.851378, loss_d: 0.475611
0.9604 --- loss: 1.081311, loss_ss: 0.903836, loss_d: 0.177475
0.9988 --- loss: 1.682940, loss_ss: 1.589448, loss_d: 0.093492
Epoch finished! Loss: 1.3180187594432098
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.084390, loss_ss: 1.007045, loss_d: 0.077345
0.0384 --- loss: 1.054304, loss_ss: 0.862951, loss_d: 0.191353
0.0768 --- loss: 1.969105, loss_ss: 1.036251, loss_d: 0.932854
0.1153 --- loss: 1.243968, loss_ss: 0.948351, loss_d: 0.295618
0.1537 --- loss: 1.411568, loss_ss: 1.178179, loss_d: 0.233389
0.1921 --- loss: 1.142022, loss_ss: 0.909195, loss_d: 0.232827
0.2305 --- loss: 1.213759, loss_ss: 0.935103, loss_d: 0.278656
0.2689 --- loss: 0.913719, loss_ss: 0.830946, loss_d: 0.082773
0.3073 --- loss: 1.055074, loss_ss: 0.986070, loss_d: 0.069005
0.3458 --- loss: 1.200811, loss_ss: 0.947624, loss_d: 0.253187
0.3842 --- loss: 1.187658, loss_ss: 0.969200, loss_d: 0.218459
0.4226 --- loss: 1.417558, loss_ss: 1.147867, loss_d: 0.269691
0.4610 --- loss: 1.296904, loss_ss: 0.923570, loss_d: 0.373334
0.4994 --- loss: 0.886477, loss_ss: 0.796841, loss_d: 0.089636
0.5378 --- loss: 1.101997, loss_ss: 0.920332, loss_d: 0.181665
0.5763 --- loss: 1.221646, loss_ss: 0.933092, loss_d: 0.288555
0.6147 --- loss: 1.183929, loss_ss: 0.880489, loss_d: 0.303439
0.6531 --- loss: 1.242948, loss_ss: 1.061365, loss_d: 0.181583
0.6915 --- loss: 1.018821, loss_ss: 0.941258, loss_d: 0.077563
0.7299 --- loss: 0.972875, loss_ss: 0.817025, loss_d: 0.155850
0.7683 --- loss: 1.281526, loss_ss: 1.120092, loss_d: 0.161434
0.8068 --- loss: 1.657588, loss_ss: 0.879199, loss_d: 0.778390
0.8452 --- loss: 1.090300, loss_ss: 0.763346, loss_d: 0.326955
0.8836 --- loss: 1.254377, loss_ss: 0.925866, loss_d: 0.328511
0.9220 --- loss: 1.408001, loss_ss: 0.647209, loss_d: 0.760793
0.9604 --- loss: 1.400101, loss_ss: 1.318413, loss_d: 0.081688
0.9988 --- loss: 3.261747, loss_ss: 1.473918, loss_d: 1.787828
Epoch finished! Loss: 1.2351189432235865
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.184576, loss_ss: 1.104369, loss_d: 0.080208
0.0384 --- loss: 1.272035, loss_ss: 1.093856, loss_d: 0.178179
0.0768 --- loss: 1.302712, loss_ss: 1.046893, loss_d: 0.255819
0.1153 --- loss: 1.009631, loss_ss: 0.926689, loss_d: 0.082942
0.1537 --- loss: 0.986596, loss_ss: 0.884638, loss_d: 0.101958
0.1921 --- loss: 0.782243, loss_ss: 0.740986, loss_d: 0.041257
0.2305 --- loss: 1.299404, loss_ss: 0.756334, loss_d: 0.543069
0.2689 --- loss: 1.490817, loss_ss: 0.822204, loss_d: 0.668613
0.3073 --- loss: 1.060561, loss_ss: 0.817447, loss_d: 0.243114
0.3458 --- loss: 0.877578, loss_ss: 0.862754, loss_d: 0.014824
0.3842 --- loss: 1.130635, loss_ss: 0.783345, loss_d: 0.347290
0.4226 --- loss: 1.389884, loss_ss: 1.146819, loss_d: 0.243065
0.4610 --- loss: 1.030629, loss_ss: 0.918741, loss_d: 0.111889
0.4994 --- loss: 1.068624, loss_ss: 0.947549, loss_d: 0.121074
0.5378 --- loss: 1.185309, loss_ss: 0.696681, loss_d: 0.488628
0.5763 --- loss: 1.412999, loss_ss: 1.022072, loss_d: 0.390926
0.6147 --- loss: 0.975306, loss_ss: 0.917479, loss_d: 0.057828
0.6531 --- loss: 0.811273, loss_ss: 0.730251, loss_d: 0.081022
0.6915 --- loss: 1.143805, loss_ss: 0.831186, loss_d: 0.312620
0.7299 --- loss: 0.870547, loss_ss: 0.749117, loss_d: 0.121430
0.7683 --- loss: 1.104049, loss_ss: 1.023216, loss_d: 0.080833
0.8068 --- loss: 0.856898, loss_ss: 0.798328, loss_d: 0.058569
0.8452 --- loss: 1.252728, loss_ss: 0.917542, loss_d: 0.335185
0.8836 --- loss: 1.350064, loss_ss: 1.313882, loss_d: 0.036182
0.9220 --- loss: 1.260649, loss_ss: 0.779079, loss_d: 0.481570
0.9604 --- loss: 1.382337, loss_ss: 1.068483, loss_d: 0.313854
0.9988 --- loss: 1.292410, loss_ss: 1.135866, loss_d: 0.156545
Epoch finished! Loss: 1.1465776610832947
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.127663, loss_ss: 1.072481, loss_d: 0.055183
0.0384 --- loss: 1.401414, loss_ss: 1.327766, loss_d: 0.073648
0.0768 --- loss: 0.996018, loss_ss: 0.713859, loss_d: 0.282159
0.1153 --- loss: 1.200181, loss_ss: 0.894249, loss_d: 0.305931
0.1537 --- loss: 0.648449, loss_ss: 0.496245, loss_d: 0.152204
0.1921 --- loss: 1.088808, loss_ss: 0.827632, loss_d: 0.261176
0.2305 --- loss: 1.303106, loss_ss: 1.030254, loss_d: 0.272852
0.2689 --- loss: 1.026096, loss_ss: 0.983537, loss_d: 0.042559
0.3073 --- loss: 1.072697, loss_ss: 0.792546, loss_d: 0.280151
0.3458 --- loss: 1.194565, loss_ss: 0.798687, loss_d: 0.395878
0.3842 --- loss: 0.880101, loss_ss: 0.825902, loss_d: 0.054198
0.4226 --- loss: 0.911848, loss_ss: 0.629546, loss_d: 0.282301
0.4610 --- loss: 0.998585, loss_ss: 0.702464, loss_d: 0.296121
0.4994 --- loss: 0.838833, loss_ss: 0.686945, loss_d: 0.151888
0.5378 --- loss: 1.076138, loss_ss: 0.964340, loss_d: 0.111798
0.5763 --- loss: 0.839529, loss_ss: 0.813510, loss_d: 0.026019
0.6147 --- loss: 1.697888, loss_ss: 1.087570, loss_d: 0.610318
0.6531 --- loss: 1.191117, loss_ss: 0.897861, loss_d: 0.293256
0.6915 --- loss: 1.107744, loss_ss: 0.999725, loss_d: 0.108020
0.7299 --- loss: 1.087118, loss_ss: 1.037555, loss_d: 0.049563
0.7683 --- loss: 1.088271, loss_ss: 1.023835, loss_d: 0.064436
0.8068 --- loss: 0.999441, loss_ss: 0.977997, loss_d: 0.021444
0.8452 --- loss: 0.658748, loss_ss: 0.615066, loss_d: 0.043682
0.8836 --- loss: 0.828483, loss_ss: 0.724527, loss_d: 0.103956
0.9220 --- loss: 1.295398, loss_ss: 1.208070, loss_d: 0.087328
0.9604 --- loss: 1.295100, loss_ss: 1.103963, loss_d: 0.191137
0.9988 --- loss: 1.517432, loss_ss: 1.505125, loss_d: 0.012307
Epoch finished! Loss: 1.108067278449352
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.098098, loss_ss: 0.845117, loss_d: 0.252981
0.0384 --- loss: 1.021776, loss_ss: 0.940923, loss_d: 0.080852
0.0768 --- loss: 0.918444, loss_ss: 0.852666, loss_d: 0.065779
0.1153 --- loss: 0.847789, loss_ss: 0.772886, loss_d: 0.074903
0.1537 --- loss: 0.797862, loss_ss: 0.739288, loss_d: 0.058574
0.1921 --- loss: 0.849262, loss_ss: 0.729859, loss_d: 0.119403
0.2305 --- loss: 1.256116, loss_ss: 1.001646, loss_d: 0.254470
0.2689 --- loss: 0.876062, loss_ss: 0.745941, loss_d: 0.130121
0.3073 --- loss: 0.860052, loss_ss: 0.847074, loss_d: 0.012978
0.3458 --- loss: 0.861735, loss_ss: 0.783227, loss_d: 0.078508
0.3842 --- loss: 1.183100, loss_ss: 0.692499, loss_d: 0.490601
0.4226 --- loss: 1.142737, loss_ss: 1.072937, loss_d: 0.069800
0.4610 --- loss: 1.358600, loss_ss: 0.770562, loss_d: 0.588038
0.4994 --- loss: 1.081820, loss_ss: 0.808590, loss_d: 0.273230
0.5378 --- loss: 0.829606, loss_ss: 0.758828, loss_d: 0.070778
0.5763 --- loss: 0.747922, loss_ss: 0.672512, loss_d: 0.075410
0.6147 --- loss: 0.656845, loss_ss: 0.544419, loss_d: 0.112426
0.6531 --- loss: 0.786038, loss_ss: 0.726856, loss_d: 0.059182
0.6915 --- loss: 0.913268, loss_ss: 0.895356, loss_d: 0.017911
0.7299 --- loss: 0.786305, loss_ss: 0.677256, loss_d: 0.109049
0.7683 --- loss: 0.883021, loss_ss: 0.842568, loss_d: 0.040453
0.8068 --- loss: 0.938809, loss_ss: 0.807668, loss_d: 0.131141
0.8452 --- loss: 1.214393, loss_ss: 0.906179, loss_d: 0.308214
0.8836 --- loss: 0.897736, loss_ss: 0.868444, loss_d: 0.029291
0.9220 --- loss: 1.223988, loss_ss: 0.925155, loss_d: 0.298834
0.9604 --- loss: 0.864103, loss_ss: 0.773190, loss_d: 0.090912
0.9988 --- loss: 2.525081, loss_ss: 1.340393, loss_d: 1.184688
Epoch finished! Loss: 1.0576794220851018
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.920728, loss_ss: 0.669685, loss_d: 0.251042
0.0384 --- loss: 1.208863, loss_ss: 0.862670, loss_d: 0.346192
0.0768 --- loss: 0.914761, loss_ss: 0.807652, loss_d: 0.107109
0.1153 --- loss: 0.944672, loss_ss: 0.825984, loss_d: 0.118688
0.1537 --- loss: 0.848735, loss_ss: 0.800587, loss_d: 0.048148
0.1921 --- loss: 0.810955, loss_ss: 0.778258, loss_d: 0.032697
0.2305 --- loss: 0.776874, loss_ss: 0.675667, loss_d: 0.101207
0.2689 --- loss: 1.343845, loss_ss: 0.895493, loss_d: 0.448352
0.3073 --- loss: 1.987811, loss_ss: 0.816268, loss_d: 1.171543
0.3458 --- loss: 0.933417, loss_ss: 0.883638, loss_d: 0.049778
0.3842 --- loss: 0.835408, loss_ss: 0.757692, loss_d: 0.077716
0.4226 --- loss: 0.905738, loss_ss: 0.862166, loss_d: 0.043572
0.4610 --- loss: 1.062594, loss_ss: 1.007509, loss_d: 0.055086
0.4994 --- loss: 0.772580, loss_ss: 0.720978, loss_d: 0.051602
0.5378 --- loss: 0.854103, loss_ss: 0.794794, loss_d: 0.059309
0.5763 --- loss: 0.807747, loss_ss: 0.675549, loss_d: 0.132197
0.6147 --- loss: 0.735407, loss_ss: 0.725954, loss_d: 0.009453
0.6531 --- loss: 0.813858, loss_ss: 0.676867, loss_d: 0.136991
0.6915 --- loss: 0.841400, loss_ss: 0.776777, loss_d: 0.064622
0.7299 --- loss: 0.933055, loss_ss: 0.805510, loss_d: 0.127545
0.7683 --- loss: 0.981747, loss_ss: 0.945538, loss_d: 0.036210
0.8068 --- loss: 1.200333, loss_ss: 0.810980, loss_d: 0.389354
0.8452 --- loss: 1.219755, loss_ss: 1.041460, loss_d: 0.178295
0.8836 --- loss: 1.095578, loss_ss: 1.043632, loss_d: 0.051946
0.9220 --- loss: 0.865255, loss_ss: 0.802656, loss_d: 0.062599
0.9604 --- loss: 0.916103, loss_ss: 0.681466, loss_d: 0.234637
0.9988 --- loss: 1.176252, loss_ss: 1.124743, loss_d: 0.051508
Epoch finished! Loss: 1.0107696095338234
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.866519, loss_ss: 0.708368, loss_d: 0.158151
0.0384 --- loss: 0.711155, loss_ss: 0.658603, loss_d: 0.052552
0.0768 --- loss: 0.902512, loss_ss: 0.764255, loss_d: 0.138257
0.1153 --- loss: 1.184209, loss_ss: 0.979457, loss_d: 0.204751
0.1537 --- loss: 1.031703, loss_ss: 0.926204, loss_d: 0.105499
0.1921 --- loss: 0.689776, loss_ss: 0.680735, loss_d: 0.009040
0.2305 --- loss: 1.173160, loss_ss: 0.579716, loss_d: 0.593444
0.2689 --- loss: 1.287019, loss_ss: 1.168360, loss_d: 0.118659
0.3073 --- loss: 1.481643, loss_ss: 1.330645, loss_d: 0.150998
0.3458 --- loss: 0.863285, loss_ss: 0.853347, loss_d: 0.009937
0.3842 --- loss: 1.044997, loss_ss: 0.785457, loss_d: 0.259540
0.4226 --- loss: 1.090022, loss_ss: 0.833304, loss_d: 0.256718
0.4610 --- loss: 0.800389, loss_ss: 0.647173, loss_d: 0.153217
0.4994 --- loss: 1.014602, loss_ss: 0.657406, loss_d: 0.357196
0.5378 --- loss: 1.107757, loss_ss: 1.002084, loss_d: 0.105673
0.5763 --- loss: 1.248242, loss_ss: 0.893429, loss_d: 0.354812
0.6147 --- loss: 1.241430, loss_ss: 0.819483, loss_d: 0.421946
0.6531 --- loss: 0.875823, loss_ss: 0.810241, loss_d: 0.065582
0.6915 --- loss: 0.940895, loss_ss: 0.860499, loss_d: 0.080396
0.7299 --- loss: 1.017889, loss_ss: 0.902852, loss_d: 0.115037
0.7683 --- loss: 0.698712, loss_ss: 0.676242, loss_d: 0.022470
0.8068 --- loss: 0.800073, loss_ss: 0.748408, loss_d: 0.051665
0.8452 --- loss: 0.709316, loss_ss: 0.667720, loss_d: 0.041595
0.8836 --- loss: 0.795190, loss_ss: 0.721197, loss_d: 0.073993
0.9220 --- loss: 1.171143, loss_ss: 0.874189, loss_d: 0.296955
0.9604 --- loss: 0.745265, loss_ss: 0.670687, loss_d: 0.074578
0.9988 --- loss: 0.868238, loss_ss: 0.858366, loss_d: 0.009872
Epoch finished! Loss: 0.970228735758708
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.253874, loss_ss: 0.842189, loss_d: 0.411684
0.0384 --- loss: 0.862795, loss_ss: 0.801513, loss_d: 0.061282
0.0768 --- loss: 0.951942, loss_ss: 0.861369, loss_d: 0.090574
0.1153 --- loss: 0.691092, loss_ss: 0.588437, loss_d: 0.102655
0.1537 --- loss: 0.654068, loss_ss: 0.588012, loss_d: 0.066056
0.1921 --- loss: 0.764631, loss_ss: 0.742697, loss_d: 0.021934
0.2305 --- loss: 1.036349, loss_ss: 0.636646, loss_d: 0.399703
0.2689 --- loss: 0.686089, loss_ss: 0.581033, loss_d: 0.105056
0.3073 --- loss: 0.773494, loss_ss: 0.745365, loss_d: 0.028129
0.3458 --- loss: 0.939225, loss_ss: 0.919085, loss_d: 0.020140
0.3842 --- loss: 0.640660, loss_ss: 0.630881, loss_d: 0.009779
0.4226 --- loss: 0.780044, loss_ss: 0.756097, loss_d: 0.023947
0.4610 --- loss: 0.886436, loss_ss: 0.870508, loss_d: 0.015928
0.4994 --- loss: 1.158425, loss_ss: 0.910959, loss_d: 0.247466
0.5378 --- loss: 1.176167, loss_ss: 0.783983, loss_d: 0.392184
0.5763 --- loss: 1.259061, loss_ss: 0.820625, loss_d: 0.438436
0.6147 --- loss: 1.066366, loss_ss: 1.013716, loss_d: 0.052649
0.6531 --- loss: 0.805291, loss_ss: 0.691140, loss_d: 0.114150
0.6915 --- loss: 1.034343, loss_ss: 0.938063, loss_d: 0.096281
0.7299 --- loss: 0.753103, loss_ss: 0.733491, loss_d: 0.019612
0.7683 --- loss: 1.899165, loss_ss: 1.288273, loss_d: 0.610892
0.8068 --- loss: 0.686762, loss_ss: 0.545419, loss_d: 0.141343
0.8452 --- loss: 0.916632, loss_ss: 0.892728, loss_d: 0.023904
0.8836 --- loss: 0.991680, loss_ss: 0.960982, loss_d: 0.030697
0.9220 --- loss: 0.618604, loss_ss: 0.583319, loss_d: 0.035284
0.9604 --- loss: 0.779487, loss_ss: 0.756245, loss_d: 0.023242
0.9988 --- loss: 1.632383, loss_ss: 1.591178, loss_d: 0.041205
Epoch finished! Loss: 0.955255514383316
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8523809523809524
             precision    recall  f1-score   support

        0.0       0.91      0.93      0.92        74
        1.0       0.37      0.38      0.38        42
        2.0       0.87      0.88      0.87       515
        3.0       0.92      0.76      0.83       243
        4.0       0.84      0.99      0.91       176

avg / total       0.86      0.85      0.85      1050
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.86  93.24   99.28  90.79     92.00
1  94.95  38.10   97.32  37.21     37.65
2  87.24  87.57   86.92  86.56     87.07
3  92.76  75.72   97.89  91.54     82.88
4  96.67  99.43   96.11  83.73     90.91
Total accuracy: 85.24%
Average sen: 78.81%
Average spec: 95.50%
Macro f1-score: 78.10%
Diagnosis acc on 15mins: 0.0
[0.78557855 0.88455355 0.9650954  0.90817648 0.94936776 0.9570694
 0.932886   0.85970819 0.82276982 0.87207651 0.89905763 0.95740563
 0.97169185 0.97854692 0.9215917  0.98166704 0.96920222 0.81905168
 0.9008671  0.64494824 0.98505926 0.98400682 0.9863804  0.96012157
 0.96420395 0.92338264 0.90516222 0.72588658 0.97316664 0.98054838
 0.95223248 0.97121304 0.98642528 0.82842886 0.95076996]
pred: 0.9159514222826276, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.537422, loss_ss: 1.827677, loss_d: 0.709745
0.0384 --- loss: 3.333642, loss_ss: 1.729258, loss_d: 1.604384
0.0767 --- loss: 2.213434, loss_ss: 1.589158, loss_d: 0.624276
0.1151 --- loss: 2.450228, loss_ss: 1.745487, loss_d: 0.704741
0.1534 --- loss: 2.501574, loss_ss: 1.637594, loss_d: 0.863979
0.1918 --- loss: 2.619451, loss_ss: 1.626968, loss_d: 0.992483
0.2301 --- loss: 2.153856, loss_ss: 1.494790, loss_d: 0.659065
0.2685 --- loss: 2.153839, loss_ss: 1.563999, loss_d: 0.589839
0.3069 --- loss: 2.081172, loss_ss: 1.460067, loss_d: 0.621105
0.3452 --- loss: 1.998278, loss_ss: 1.406045, loss_d: 0.592233
0.3836 --- loss: 1.995775, loss_ss: 1.460952, loss_d: 0.534823
0.4219 --- loss: 1.572134, loss_ss: 1.186741, loss_d: 0.385393
0.4603 --- loss: 1.665953, loss_ss: 1.332071, loss_d: 0.333883
0.4987 --- loss: 1.870439, loss_ss: 1.324730, loss_d: 0.545708
0.5370 --- loss: 2.043585, loss_ss: 1.517897, loss_d: 0.525688
0.5754 --- loss: 1.698167, loss_ss: 1.394348, loss_d: 0.303820
0.6137 --- loss: 1.892093, loss_ss: 1.332617, loss_d: 0.559476
0.6521 --- loss: 1.868517, loss_ss: 1.425892, loss_d: 0.442625
0.6904 --- loss: 1.773636, loss_ss: 1.287946, loss_d: 0.485690
0.7288 --- loss: 1.820856, loss_ss: 1.263229, loss_d: 0.557627
0.7672 --- loss: 1.610567, loss_ss: 1.279140, loss_d: 0.331427
0.8055 --- loss: 1.815126, loss_ss: 1.460387, loss_d: 0.354739
0.8439 --- loss: 1.975975, loss_ss: 1.342036, loss_d: 0.633938
0.8822 --- loss: 1.686382, loss_ss: 1.302221, loss_d: 0.384160
0.9206 --- loss: 1.422339, loss_ss: 1.254925, loss_d: 0.167414
0.9590 --- loss: 2.386508, loss_ss: 1.237768, loss_d: 1.148740
0.9973 --- loss: 1.695975, loss_ss: 1.351810, loss_d: 0.344165
Epoch finished! Loss: 1.9739775974016922
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.985964, loss_ss: 1.424614, loss_d: 0.561350
0.0384 --- loss: 1.651047, loss_ss: 1.195940, loss_d: 0.455107
0.0767 --- loss: 1.464868, loss_ss: 1.231539, loss_d: 0.233330
0.1151 --- loss: 1.692353, loss_ss: 1.163889, loss_d: 0.528464
0.1534 --- loss: 1.797842, loss_ss: 1.421425, loss_d: 0.376417
0.1918 --- loss: 2.448484, loss_ss: 1.198651, loss_d: 1.249833
0.2301 --- loss: 1.705151, loss_ss: 1.292555, loss_d: 0.412596
0.2685 --- loss: 1.783082, loss_ss: 1.391853, loss_d: 0.391229
0.3069 --- loss: 1.535328, loss_ss: 1.269238, loss_d: 0.266090
0.3452 --- loss: 1.401811, loss_ss: 1.098767, loss_d: 0.303044
0.3836 --- loss: 1.147043, loss_ss: 0.947279, loss_d: 0.199764
0.4219 --- loss: 1.727398, loss_ss: 1.145820, loss_d: 0.581579
0.4603 --- loss: 1.265195, loss_ss: 1.122348, loss_d: 0.142847
0.4987 --- loss: 1.442984, loss_ss: 1.073457, loss_d: 0.369527
0.5370 --- loss: 1.662677, loss_ss: 1.153529, loss_d: 0.509148
0.5754 --- loss: 1.573660, loss_ss: 1.282167, loss_d: 0.291494
0.6137 --- loss: 1.611074, loss_ss: 1.418822, loss_d: 0.192252
0.6521 --- loss: 1.136898, loss_ss: 0.962227, loss_d: 0.174671
0.6904 --- loss: 1.392023, loss_ss: 1.037581, loss_d: 0.354442
0.7288 --- loss: 1.433428, loss_ss: 1.090759, loss_d: 0.342669
0.7672 --- loss: 1.253041, loss_ss: 1.066567, loss_d: 0.186474
0.8055 --- loss: 1.519092, loss_ss: 1.154189, loss_d: 0.364904
0.8439 --- loss: 1.706136, loss_ss: 1.119289, loss_d: 0.586847
0.8822 --- loss: 1.555729, loss_ss: 1.275107, loss_d: 0.280623
0.9206 --- loss: 1.521858, loss_ss: 1.106169, loss_d: 0.415689
0.9590 --- loss: 1.287688, loss_ss: 1.040160, loss_d: 0.247528
0.9973 --- loss: 2.117985, loss_ss: 1.054350, loss_d: 1.063634
Epoch finished! Loss: 1.5081113077127017
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.145218, loss_ss: 0.895796, loss_d: 0.249423
0.0384 --- loss: 1.219602, loss_ss: 0.915755, loss_d: 0.303847
0.0767 --- loss: 1.374949, loss_ss: 1.229205, loss_d: 0.145744
0.1151 --- loss: 1.246698, loss_ss: 0.924810, loss_d: 0.321888
0.1534 --- loss: 1.352020, loss_ss: 1.161014, loss_d: 0.191006
0.1918 --- loss: 1.444397, loss_ss: 1.157727, loss_d: 0.286670
0.2301 --- loss: 1.574618, loss_ss: 1.076306, loss_d: 0.498312
0.2685 --- loss: 1.202642, loss_ss: 0.911057, loss_d: 0.291585
0.3069 --- loss: 1.216043, loss_ss: 0.875879, loss_d: 0.340165
0.3452 --- loss: 1.295783, loss_ss: 0.846914, loss_d: 0.448869
0.3836 --- loss: 1.256061, loss_ss: 1.015376, loss_d: 0.240685
0.4219 --- loss: 1.152176, loss_ss: 0.981219, loss_d: 0.170957
0.4603 --- loss: 1.562553, loss_ss: 0.917749, loss_d: 0.644804
0.4987 --- loss: 1.311268, loss_ss: 0.988942, loss_d: 0.322326
0.5370 --- loss: 1.111940, loss_ss: 0.957526, loss_d: 0.154413
0.5754 --- loss: 1.414802, loss_ss: 0.991930, loss_d: 0.422872
0.6137 --- loss: 1.345410, loss_ss: 1.268504, loss_d: 0.076906
0.6521 --- loss: 1.581391, loss_ss: 0.898554, loss_d: 0.682838
0.6904 --- loss: 1.005315, loss_ss: 0.955532, loss_d: 0.049783
0.7288 --- loss: 1.088974, loss_ss: 0.921008, loss_d: 0.167966
0.7672 --- loss: 1.246786, loss_ss: 0.874377, loss_d: 0.372409
0.8055 --- loss: 1.326070, loss_ss: 0.923797, loss_d: 0.402273
0.8439 --- loss: 0.980467, loss_ss: 0.906052, loss_d: 0.074415
0.8822 --- loss: 1.261336, loss_ss: 0.939970, loss_d: 0.321367
0.9206 --- loss: 1.050560, loss_ss: 0.859764, loss_d: 0.190796
0.9590 --- loss: 0.936527, loss_ss: 0.885699, loss_d: 0.050829
0.9973 --- loss: 1.386538, loss_ss: 0.978434, loss_d: 0.408104
Epoch finished! Loss: 1.3160081347593895
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.550326, loss_ss: 0.862496, loss_d: 0.687830
0.0384 --- loss: 1.165596, loss_ss: 1.022294, loss_d: 0.143302
0.0767 --- loss: 1.061410, loss_ss: 0.894195, loss_d: 0.167215
0.1151 --- loss: 0.954388, loss_ss: 0.842227, loss_d: 0.112161
0.1534 --- loss: 1.105232, loss_ss: 0.948575, loss_d: 0.156657
0.1918 --- loss: 1.163476, loss_ss: 0.843592, loss_d: 0.319885
0.2301 --- loss: 1.295053, loss_ss: 0.891435, loss_d: 0.403618
0.2685 --- loss: 1.154769, loss_ss: 0.931743, loss_d: 0.223026
0.3069 --- loss: 1.261020, loss_ss: 1.159210, loss_d: 0.101811
0.3452 --- loss: 0.832532, loss_ss: 0.712695, loss_d: 0.119838
0.3836 --- loss: 1.680453, loss_ss: 1.245682, loss_d: 0.434771
0.4219 --- loss: 1.306245, loss_ss: 1.166203, loss_d: 0.140042
0.4603 --- loss: 1.019101, loss_ss: 0.814822, loss_d: 0.204278
0.4987 --- loss: 1.064271, loss_ss: 0.994721, loss_d: 0.069550
0.5370 --- loss: 0.915720, loss_ss: 0.807347, loss_d: 0.108372
0.5754 --- loss: 0.911427, loss_ss: 0.864872, loss_d: 0.046556
0.6137 --- loss: 1.356448, loss_ss: 1.048052, loss_d: 0.308396
0.6521 --- loss: 1.216578, loss_ss: 1.102358, loss_d: 0.114220
0.6904 --- loss: 1.624966, loss_ss: 1.249680, loss_d: 0.375286
0.7288 --- loss: 0.952775, loss_ss: 0.743028, loss_d: 0.209748
0.7672 --- loss: 1.712532, loss_ss: 1.164045, loss_d: 0.548487
0.8055 --- loss: 1.002398, loss_ss: 0.759713, loss_d: 0.242685
0.8439 --- loss: 0.799491, loss_ss: 0.641660, loss_d: 0.157831
0.8822 --- loss: 1.454680, loss_ss: 1.091598, loss_d: 0.363081
0.9206 --- loss: 1.082846, loss_ss: 0.742960, loss_d: 0.339887
0.9590 --- loss: 1.196207, loss_ss: 0.933127, loss_d: 0.263080
0.9973 --- loss: 1.471586, loss_ss: 1.083629, loss_d: 0.387956
Epoch finished! Loss: 1.2111451690013593
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.107552, loss_ss: 0.947440, loss_d: 0.160112
0.0384 --- loss: 1.128674, loss_ss: 0.809906, loss_d: 0.318768
0.0767 --- loss: 1.355781, loss_ss: 1.229184, loss_d: 0.126598
0.1151 --- loss: 1.087370, loss_ss: 0.864354, loss_d: 0.223016
0.1534 --- loss: 1.144626, loss_ss: 0.881505, loss_d: 0.263121
0.1918 --- loss: 1.152435, loss_ss: 0.911563, loss_d: 0.240872
0.2301 --- loss: 1.215636, loss_ss: 1.032389, loss_d: 0.183247
0.2685 --- loss: 1.133460, loss_ss: 1.110743, loss_d: 0.022716
0.3069 --- loss: 0.764097, loss_ss: 0.600443, loss_d: 0.163654
0.3452 --- loss: 0.916161, loss_ss: 0.779581, loss_d: 0.136580
0.3836 --- loss: 1.517481, loss_ss: 1.342252, loss_d: 0.175229
0.4219 --- loss: 0.911600, loss_ss: 0.837350, loss_d: 0.074250
0.4603 --- loss: 0.983295, loss_ss: 0.875321, loss_d: 0.107974
0.4987 --- loss: 0.920231, loss_ss: 0.800325, loss_d: 0.119907
0.5370 --- loss: 1.233953, loss_ss: 1.102630, loss_d: 0.131323
0.5754 --- loss: 1.123777, loss_ss: 0.899309, loss_d: 0.224467
0.6137 --- loss: 1.206346, loss_ss: 0.791601, loss_d: 0.414745
0.6521 --- loss: 1.202091, loss_ss: 0.977117, loss_d: 0.224974
0.6904 --- loss: 0.976472, loss_ss: 0.943126, loss_d: 0.033346
0.7288 --- loss: 0.875367, loss_ss: 0.823738, loss_d: 0.051629
0.7672 --- loss: 0.796270, loss_ss: 0.731786, loss_d: 0.064484
0.8055 --- loss: 0.774016, loss_ss: 0.733100, loss_d: 0.040916
0.8439 --- loss: 1.285744, loss_ss: 0.840675, loss_d: 0.445069
0.8822 --- loss: 0.984822, loss_ss: 0.817080, loss_d: 0.167742
0.9206 --- loss: 1.040734, loss_ss: 0.680177, loss_d: 0.360557
0.9590 --- loss: 0.937645, loss_ss: 0.769644, loss_d: 0.168001
0.9973 --- loss: 1.099551, loss_ss: 0.906207, loss_d: 0.193344
Epoch finished! Loss: 1.1297639530438643
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.802640, loss_ss: 0.729341, loss_d: 0.073299
0.0384 --- loss: 1.064910, loss_ss: 0.990905, loss_d: 0.074005
0.0767 --- loss: 0.998167, loss_ss: 0.930803, loss_d: 0.067364
0.1151 --- loss: 1.588457, loss_ss: 1.093605, loss_d: 0.494852
0.1534 --- loss: 0.974123, loss_ss: 0.843744, loss_d: 0.130379
0.1918 --- loss: 1.174221, loss_ss: 0.828029, loss_d: 0.346193
0.2301 --- loss: 0.853711, loss_ss: 0.763664, loss_d: 0.090047
0.2685 --- loss: 0.983396, loss_ss: 0.896393, loss_d: 0.087003
0.3069 --- loss: 1.198750, loss_ss: 1.033429, loss_d: 0.165321
0.3452 --- loss: 0.819724, loss_ss: 0.730314, loss_d: 0.089410
0.3836 --- loss: 1.195148, loss_ss: 1.100109, loss_d: 0.095039
0.4219 --- loss: 1.004809, loss_ss: 0.975823, loss_d: 0.028986
0.4603 --- loss: 1.149413, loss_ss: 0.924136, loss_d: 0.225277
0.4987 --- loss: 1.419903, loss_ss: 1.293053, loss_d: 0.126850
0.5370 --- loss: 0.823775, loss_ss: 0.802793, loss_d: 0.020982
0.5754 --- loss: 1.591588, loss_ss: 0.765700, loss_d: 0.825888
0.6137 --- loss: 0.807969, loss_ss: 0.721876, loss_d: 0.086093
0.6521 --- loss: 0.970987, loss_ss: 0.869477, loss_d: 0.101511
0.6904 --- loss: 1.111439, loss_ss: 1.053447, loss_d: 0.057992
0.7288 --- loss: 1.321500, loss_ss: 0.725039, loss_d: 0.596461
0.7672 --- loss: 0.783116, loss_ss: 0.659540, loss_d: 0.123576
0.8055 --- loss: 0.927207, loss_ss: 0.808280, loss_d: 0.118927
0.8439 --- loss: 1.151353, loss_ss: 0.854233, loss_d: 0.297120
0.8822 --- loss: 0.904093, loss_ss: 0.833751, loss_d: 0.070341
0.9206 --- loss: 0.851739, loss_ss: 0.823468, loss_d: 0.028271
0.9590 --- loss: 0.943524, loss_ss: 0.884738, loss_d: 0.058786
0.9973 --- loss: 1.224919, loss_ss: 0.739716, loss_d: 0.485203
Epoch finished! Loss: 1.0775529723901016
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.054731, loss_ss: 0.883996, loss_d: 0.170736
0.0384 --- loss: 0.932965, loss_ss: 0.893466, loss_d: 0.039499
0.0767 --- loss: 2.349092, loss_ss: 0.976310, loss_d: 1.372782
0.1151 --- loss: 1.228707, loss_ss: 0.910005, loss_d: 0.318702
0.1534 --- loss: 1.075541, loss_ss: 0.916898, loss_d: 0.158642
0.1918 --- loss: 1.821758, loss_ss: 0.988837, loss_d: 0.832921
0.2301 --- loss: 1.304257, loss_ss: 1.010339, loss_d: 0.293917
0.2685 --- loss: 0.750253, loss_ss: 0.711057, loss_d: 0.039197
0.3069 --- loss: 0.668368, loss_ss: 0.579784, loss_d: 0.088584
0.3452 --- loss: 0.976280, loss_ss: 0.904690, loss_d: 0.071589
0.3836 --- loss: 0.809579, loss_ss: 0.747664, loss_d: 0.061914
0.4219 --- loss: 0.905824, loss_ss: 0.752339, loss_d: 0.153485
0.4603 --- loss: 0.924103, loss_ss: 0.656719, loss_d: 0.267383
0.4987 --- loss: 0.815699, loss_ss: 0.720670, loss_d: 0.095029
0.5370 --- loss: 0.947215, loss_ss: 0.770410, loss_d: 0.176805
0.5754 --- loss: 1.052792, loss_ss: 0.976076, loss_d: 0.076716
0.6137 --- loss: 0.861860, loss_ss: 0.807369, loss_d: 0.054491
0.6521 --- loss: 1.320394, loss_ss: 0.731970, loss_d: 0.588423
0.6904 --- loss: 1.114060, loss_ss: 0.910931, loss_d: 0.203129
0.7288 --- loss: 1.266441, loss_ss: 1.013389, loss_d: 0.253052
0.7672 --- loss: 1.097862, loss_ss: 0.984200, loss_d: 0.113661
0.8055 --- loss: 1.188987, loss_ss: 1.136817, loss_d: 0.052170
0.8439 --- loss: 1.267378, loss_ss: 0.916638, loss_d: 0.350740
0.8822 --- loss: 0.858859, loss_ss: 0.761820, loss_d: 0.097039
0.9206 --- loss: 0.782901, loss_ss: 0.638547, loss_d: 0.144354
0.9590 --- loss: 0.741000, loss_ss: 0.720623, loss_d: 0.020378
0.9973 --- loss: 0.890069, loss_ss: 0.851436, loss_d: 0.038633
Epoch finished! Loss: 1.0254789781111937
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.749672, loss_ss: 0.720359, loss_d: 0.029313
0.0384 --- loss: 0.818583, loss_ss: 0.744555, loss_d: 0.074027
0.0767 --- loss: 0.915604, loss_ss: 0.843715, loss_d: 0.071889
0.1151 --- loss: 0.890980, loss_ss: 0.811973, loss_d: 0.079007
0.1534 --- loss: 0.858398, loss_ss: 0.776322, loss_d: 0.082076
0.1918 --- loss: 0.710338, loss_ss: 0.627343, loss_d: 0.082995
0.2301 --- loss: 0.848129, loss_ss: 0.821018, loss_d: 0.027111
0.2685 --- loss: 0.616965, loss_ss: 0.596414, loss_d: 0.020551
0.3069 --- loss: 1.117477, loss_ss: 0.959089, loss_d: 0.158388
0.3452 --- loss: 1.121178, loss_ss: 0.775228, loss_d: 0.345949
0.3836 --- loss: 1.675248, loss_ss: 0.743786, loss_d: 0.931462
0.4219 --- loss: 1.072322, loss_ss: 0.911545, loss_d: 0.160778
0.4603 --- loss: 1.023794, loss_ss: 0.710256, loss_d: 0.313538
0.4987 --- loss: 0.730075, loss_ss: 0.616214, loss_d: 0.113861
0.5370 --- loss: 1.036050, loss_ss: 0.854490, loss_d: 0.181560
0.5754 --- loss: 0.884671, loss_ss: 0.857710, loss_d: 0.026962
0.6137 --- loss: 0.987717, loss_ss: 0.933093, loss_d: 0.054624
0.6521 --- loss: 1.205986, loss_ss: 1.153720, loss_d: 0.052265
0.6904 --- loss: 1.249170, loss_ss: 1.000775, loss_d: 0.248395
0.7288 --- loss: 0.965052, loss_ss: 0.831250, loss_d: 0.133802
0.7672 --- loss: 0.856062, loss_ss: 0.691223, loss_d: 0.164839
0.8055 --- loss: 1.464880, loss_ss: 0.954850, loss_d: 0.510030
0.8439 --- loss: 1.290209, loss_ss: 0.931887, loss_d: 0.358322
0.8822 --- loss: 0.707946, loss_ss: 0.671858, loss_d: 0.036089
0.9206 --- loss: 0.980601, loss_ss: 0.780372, loss_d: 0.200229
0.9590 --- loss: 1.015648, loss_ss: 0.989205, loss_d: 0.026443
0.9973 --- loss: 0.911882, loss_ss: 0.810673, loss_d: 0.101209
Epoch finished! Loss: 0.9956353047719368
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.940295, loss_ss: 0.827317, loss_d: 0.112979
0.0384 --- loss: 0.712676, loss_ss: 0.659440, loss_d: 0.053236
0.0767 --- loss: 0.971928, loss_ss: 0.760818, loss_d: 0.211110
0.1151 --- loss: 0.855935, loss_ss: 0.800824, loss_d: 0.055110
0.1534 --- loss: 0.995154, loss_ss: 0.881886, loss_d: 0.113268
0.1918 --- loss: 0.944064, loss_ss: 0.839886, loss_d: 0.104178
0.2301 --- loss: 0.851707, loss_ss: 0.665996, loss_d: 0.185711
0.2685 --- loss: 0.767932, loss_ss: 0.733588, loss_d: 0.034344
0.3069 --- loss: 0.803825, loss_ss: 0.789950, loss_d: 0.013875
0.3452 --- loss: 0.978268, loss_ss: 0.963042, loss_d: 0.015225
0.3836 --- loss: 0.886748, loss_ss: 0.769831, loss_d: 0.116917
0.4219 --- loss: 0.912014, loss_ss: 0.848161, loss_d: 0.063853
0.4603 --- loss: 0.976575, loss_ss: 0.891280, loss_d: 0.085295
0.4987 --- loss: 0.728269, loss_ss: 0.709034, loss_d: 0.019234
0.5370 --- loss: 1.058112, loss_ss: 0.928434, loss_d: 0.129679
0.5754 --- loss: 1.233507, loss_ss: 1.026167, loss_d: 0.207340
0.6137 --- loss: 0.895837, loss_ss: 0.614331, loss_d: 0.281507
0.6521 --- loss: 0.828987, loss_ss: 0.821952, loss_d: 0.007035
0.6904 --- loss: 0.739229, loss_ss: 0.631570, loss_d: 0.107660
0.7288 --- loss: 0.857387, loss_ss: 0.791362, loss_d: 0.066025
0.7672 --- loss: 1.202078, loss_ss: 0.812317, loss_d: 0.389761
0.8055 --- loss: 0.693167, loss_ss: 0.681632, loss_d: 0.011535
0.8439 --- loss: 0.718496, loss_ss: 0.688014, loss_d: 0.030482
0.8822 --- loss: 1.501250, loss_ss: 0.690133, loss_d: 0.811117
0.9206 --- loss: 1.227746, loss_ss: 1.136219, loss_d: 0.091527
0.9590 --- loss: 0.959545, loss_ss: 0.912103, loss_d: 0.047442
0.9973 --- loss: 1.116479, loss_ss: 0.954334, loss_d: 0.162145
Epoch finished! Loss: 0.9694663244944353
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.809219, loss_ss: 0.774623, loss_d: 0.034596
0.0384 --- loss: 0.731274, loss_ss: 0.719042, loss_d: 0.012232
0.0767 --- loss: 1.147719, loss_ss: 1.063192, loss_d: 0.084528
0.1151 --- loss: 0.731996, loss_ss: 0.699229, loss_d: 0.032767
0.1534 --- loss: 1.027002, loss_ss: 0.697807, loss_d: 0.329195
0.1918 --- loss: 0.953806, loss_ss: 0.672058, loss_d: 0.281748
0.2301 --- loss: 0.939768, loss_ss: 0.832493, loss_d: 0.107275
0.2685 --- loss: 1.052249, loss_ss: 0.960919, loss_d: 0.091329
0.3069 --- loss: 1.224869, loss_ss: 1.009648, loss_d: 0.215221
0.3452 --- loss: 0.941614, loss_ss: 0.911480, loss_d: 0.030134
0.3836 --- loss: 0.902768, loss_ss: 0.888719, loss_d: 0.014049
0.4219 --- loss: 1.503011, loss_ss: 0.837175, loss_d: 0.665836
0.4603 --- loss: 0.830130, loss_ss: 0.670914, loss_d: 0.159216
0.4987 --- loss: 0.794048, loss_ss: 0.767639, loss_d: 0.026410
0.5370 --- loss: 0.697255, loss_ss: 0.591360, loss_d: 0.105894
0.5754 --- loss: 1.046727, loss_ss: 1.040461, loss_d: 0.006266
0.6137 --- loss: 0.715277, loss_ss: 0.579958, loss_d: 0.135319
0.6521 --- loss: 1.469433, loss_ss: 1.354502, loss_d: 0.114931
0.6904 --- loss: 0.535496, loss_ss: 0.522571, loss_d: 0.012924
0.7288 --- loss: 0.926640, loss_ss: 0.918444, loss_d: 0.008196
0.7672 --- loss: 0.921267, loss_ss: 0.903416, loss_d: 0.017851
0.8055 --- loss: 0.963575, loss_ss: 0.642081, loss_d: 0.321494
0.8439 --- loss: 0.863919, loss_ss: 0.733696, loss_d: 0.130223
0.8822 --- loss: 0.822847, loss_ss: 0.753168, loss_d: 0.069679
0.9206 --- loss: 0.885082, loss_ss: 0.864243, loss_d: 0.020839
0.9590 --- loss: 0.996200, loss_ss: 0.728078, loss_d: 0.268123
0.9973 --- loss: 0.934243, loss_ss: 0.829909, loss_d: 0.104335
Epoch finished! Loss: 0.9272293375088618
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.678494623655914
             precision    recall  f1-score   support

        0.0       0.84      0.90      0.87        41
        1.0       0.22      0.76      0.34        33
        2.0       0.74      0.73      0.73       530
        3.0       0.99      0.42      0.59       236
        4.0       0.57      0.92      0.70        90

avg / total       0.77      0.68      0.69       930
 


====== chc005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.82  90.24   99.21  84.09     87.06
1  89.46  75.76   89.97  21.74     33.78
2  69.68  72.83   65.50  73.66     73.24
3  85.27  42.37   99.86  99.01     59.35
4  92.47  92.22   92.50  56.85     70.34
Total accuracy: 67.85%
Average sen: 74.69%
Average spec: 89.41%
Macro f1-score: 64.75%
Diagnosis acc on 15mins: 0.9354838709677419
[0.03072583 0.08190834 0.01873993 0.23893204 0.11671742 0.00369659
 0.0040683  0.00195802 0.00673344 0.02289466 0.02470975 0.00836932
 0.00957152 0.00207784 0.01087895 0.21244416 0.03248429 0.00498909
 0.04126924 0.00816719 0.07690065 0.95472705 0.50216341 0.2290207
 0.00133678 0.03165894 0.01555842 0.00544232 0.29605877 0.17218192
 0.04500948]
pred: 0.10359336578873016, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.267330, loss_ss: 1.599377, loss_d: 0.667953
0.0383 --- loss: 2.221059, loss_ss: 1.565164, loss_d: 0.655894
0.0766 --- loss: 2.351924, loss_ss: 1.419978, loss_d: 0.931946
0.1149 --- loss: 2.376361, loss_ss: 1.498774, loss_d: 0.877587
0.1532 --- loss: 2.425166, loss_ss: 1.504474, loss_d: 0.920692
0.1915 --- loss: 1.905737, loss_ss: 1.388081, loss_d: 0.517657
0.2298 --- loss: 1.795375, loss_ss: 1.252373, loss_d: 0.543002
0.2681 --- loss: 1.993554, loss_ss: 1.226545, loss_d: 0.767009
0.3064 --- loss: 1.808055, loss_ss: 1.321230, loss_d: 0.486825
0.3447 --- loss: 1.831134, loss_ss: 1.196459, loss_d: 0.634675
0.3830 --- loss: 1.843225, loss_ss: 1.095153, loss_d: 0.748072
0.4213 --- loss: 1.801587, loss_ss: 1.182020, loss_d: 0.619566
0.4596 --- loss: 1.903137, loss_ss: 1.515213, loss_d: 0.387924
0.4979 --- loss: 1.693205, loss_ss: 1.036319, loss_d: 0.656886
0.5362 --- loss: 1.792848, loss_ss: 1.017366, loss_d: 0.775483
0.5745 --- loss: 1.811057, loss_ss: 1.349287, loss_d: 0.461769
0.6128 --- loss: 1.876062, loss_ss: 1.395679, loss_d: 0.480383
0.6511 --- loss: 1.935353, loss_ss: 1.325256, loss_d: 0.610098
0.6894 --- loss: 1.976160, loss_ss: 1.457233, loss_d: 0.518927
0.7277 --- loss: 1.580102, loss_ss: 1.132564, loss_d: 0.447538
0.7660 --- loss: 1.516871, loss_ss: 1.120002, loss_d: 0.396869
0.8043 --- loss: 1.458933, loss_ss: 1.099382, loss_d: 0.359550
0.8426 --- loss: 1.401826, loss_ss: 1.022922, loss_d: 0.378904
0.8809 --- loss: 1.380077, loss_ss: 1.123069, loss_d: 0.257008
0.9192 --- loss: 1.383456, loss_ss: 1.043676, loss_d: 0.339780
0.9575 --- loss: 1.627697, loss_ss: 1.080700, loss_d: 0.546996
0.9958 --- loss: 1.650723, loss_ss: 1.035186, loss_d: 0.615536
Epoch finished! Loss: 1.804020530876072
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.052628, loss_ss: 0.928511, loss_d: 0.124117
0.0383 --- loss: 1.459204, loss_ss: 0.944960, loss_d: 0.514244
0.0766 --- loss: 1.242398, loss_ss: 1.142955, loss_d: 0.099443
0.1149 --- loss: 1.386983, loss_ss: 1.172414, loss_d: 0.214569
0.1532 --- loss: 1.305749, loss_ss: 0.995025, loss_d: 0.310724
0.1915 --- loss: 1.586771, loss_ss: 1.016506, loss_d: 0.570265
0.2298 --- loss: 1.230742, loss_ss: 0.936030, loss_d: 0.294712
0.2681 --- loss: 1.132296, loss_ss: 0.927322, loss_d: 0.204975
0.3064 --- loss: 1.275007, loss_ss: 0.941775, loss_d: 0.333232
0.3447 --- loss: 1.053895, loss_ss: 0.860759, loss_d: 0.193136
0.3830 --- loss: 1.160026, loss_ss: 0.941779, loss_d: 0.218247
0.4213 --- loss: 1.433953, loss_ss: 1.221958, loss_d: 0.211996
0.4596 --- loss: 1.507714, loss_ss: 1.347614, loss_d: 0.160100
0.4979 --- loss: 1.294780, loss_ss: 1.138425, loss_d: 0.156355
0.5362 --- loss: 1.396102, loss_ss: 1.086092, loss_d: 0.310010
0.5745 --- loss: 1.192955, loss_ss: 0.837822, loss_d: 0.355132
0.6128 --- loss: 1.441543, loss_ss: 0.964098, loss_d: 0.477444
0.6511 --- loss: 1.255844, loss_ss: 0.844192, loss_d: 0.411652
0.6894 --- loss: 1.264412, loss_ss: 0.984795, loss_d: 0.279617
0.7277 --- loss: 0.960413, loss_ss: 0.732979, loss_d: 0.227434
0.7660 --- loss: 1.197814, loss_ss: 0.917414, loss_d: 0.280400
0.8043 --- loss: 0.974317, loss_ss: 0.839025, loss_d: 0.135292
0.8426 --- loss: 1.417471, loss_ss: 1.157331, loss_d: 0.260140
0.8809 --- loss: 1.311866, loss_ss: 1.132784, loss_d: 0.179081
0.9192 --- loss: 1.397385, loss_ss: 0.973567, loss_d: 0.423818
0.9575 --- loss: 1.216620, loss_ss: 0.960326, loss_d: 0.256294
0.9958 --- loss: 1.094095, loss_ss: 1.003926, loss_d: 0.090169
Epoch finished! Loss: 1.3973806203553503
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.397219, loss_ss: 1.233786, loss_d: 0.163433
0.0383 --- loss: 1.862645, loss_ss: 1.054838, loss_d: 0.807807
0.0766 --- loss: 1.265305, loss_ss: 1.000700, loss_d: 0.264605
0.1149 --- loss: 1.005851, loss_ss: 0.925340, loss_d: 0.080511
0.1532 --- loss: 0.982434, loss_ss: 0.905264, loss_d: 0.077170
0.1915 --- loss: 1.764257, loss_ss: 1.326929, loss_d: 0.437328
0.2298 --- loss: 0.862241, loss_ss: 0.803701, loss_d: 0.058540
0.2681 --- loss: 0.989658, loss_ss: 0.924920, loss_d: 0.064738
0.3064 --- loss: 1.494940, loss_ss: 0.988611, loss_d: 0.506329
0.3447 --- loss: 1.146841, loss_ss: 0.967032, loss_d: 0.179809
0.3830 --- loss: 0.942057, loss_ss: 0.813686, loss_d: 0.128372
0.4213 --- loss: 1.319348, loss_ss: 0.882083, loss_d: 0.437265
0.4596 --- loss: 0.982199, loss_ss: 0.836485, loss_d: 0.145714
0.4979 --- loss: 1.317685, loss_ss: 1.060977, loss_d: 0.256708
0.5362 --- loss: 0.948229, loss_ss: 0.848623, loss_d: 0.099606
0.5745 --- loss: 1.095403, loss_ss: 0.899111, loss_d: 0.196292
0.6128 --- loss: 1.487670, loss_ss: 1.096040, loss_d: 0.391630
0.6511 --- loss: 1.115125, loss_ss: 0.908235, loss_d: 0.206890
0.6894 --- loss: 1.057001, loss_ss: 0.904492, loss_d: 0.152509
0.7277 --- loss: 1.879543, loss_ss: 1.635478, loss_d: 0.244065
0.7660 --- loss: 1.462973, loss_ss: 1.007661, loss_d: 0.455312
0.8043 --- loss: 1.229501, loss_ss: 0.981946, loss_d: 0.247555
0.8426 --- loss: 1.164731, loss_ss: 0.880700, loss_d: 0.284032
0.8809 --- loss: 1.183735, loss_ss: 0.902202, loss_d: 0.281533
0.9192 --- loss: 1.315604, loss_ss: 1.077475, loss_d: 0.238129
0.9575 --- loss: 1.124707, loss_ss: 1.012012, loss_d: 0.112695
0.9958 --- loss: 1.395431, loss_ss: 1.239013, loss_d: 0.156418
Epoch finished! Loss: 1.2660577658035745
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.296837, loss_ss: 1.147592, loss_d: 0.149245
0.0383 --- loss: 1.033300, loss_ss: 0.873879, loss_d: 0.159421
0.0766 --- loss: 0.706181, loss_ss: 0.497669, loss_d: 0.208512
0.1149 --- loss: 1.172789, loss_ss: 0.977927, loss_d: 0.194861
0.1532 --- loss: 1.849584, loss_ss: 1.049377, loss_d: 0.800208
0.1915 --- loss: 1.663255, loss_ss: 1.007817, loss_d: 0.655438
0.2298 --- loss: 0.963208, loss_ss: 0.894621, loss_d: 0.068587
0.2681 --- loss: 1.053583, loss_ss: 0.789785, loss_d: 0.263798
0.3064 --- loss: 1.549170, loss_ss: 0.866150, loss_d: 0.683020
0.3447 --- loss: 1.117474, loss_ss: 1.086447, loss_d: 0.031027
0.3830 --- loss: 1.292453, loss_ss: 1.010607, loss_d: 0.281846
0.4213 --- loss: 1.460952, loss_ss: 0.971895, loss_d: 0.489057
0.4596 --- loss: 1.112236, loss_ss: 0.938957, loss_d: 0.173279
0.4979 --- loss: 0.845232, loss_ss: 0.612541, loss_d: 0.232691
0.5362 --- loss: 1.250047, loss_ss: 1.020422, loss_d: 0.229625
0.5745 --- loss: 1.002503, loss_ss: 0.960860, loss_d: 0.041642
0.6128 --- loss: 0.972901, loss_ss: 0.839884, loss_d: 0.133017
0.6511 --- loss: 1.219813, loss_ss: 1.005363, loss_d: 0.214450
0.6894 --- loss: 0.913467, loss_ss: 0.820472, loss_d: 0.092995
0.7277 --- loss: 0.898134, loss_ss: 0.775411, loss_d: 0.122723
0.7660 --- loss: 1.036966, loss_ss: 1.009360, loss_d: 0.027606
0.8043 --- loss: 1.043868, loss_ss: 0.986675, loss_d: 0.057193
0.8426 --- loss: 1.431791, loss_ss: 0.729231, loss_d: 0.702560
0.8809 --- loss: 1.002970, loss_ss: 0.860652, loss_d: 0.142318
0.9192 --- loss: 1.148557, loss_ss: 1.104652, loss_d: 0.043905
0.9575 --- loss: 0.908028, loss_ss: 0.806182, loss_d: 0.101846
0.9958 --- loss: 1.118860, loss_ss: 1.003245, loss_d: 0.115615
Epoch finished! Loss: 1.175504901856755
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.113206, loss_ss: 0.881713, loss_d: 0.231493
0.0383 --- loss: 0.973861, loss_ss: 0.753401, loss_d: 0.220461
0.0766 --- loss: 1.055638, loss_ss: 0.948186, loss_d: 0.107452
0.1149 --- loss: 0.910423, loss_ss: 0.879563, loss_d: 0.030861
0.1532 --- loss: 0.945639, loss_ss: 0.923103, loss_d: 0.022536
0.1915 --- loss: 1.218277, loss_ss: 1.152612, loss_d: 0.065665
0.2298 --- loss: 1.088439, loss_ss: 0.922245, loss_d: 0.166194
0.2681 --- loss: 1.214568, loss_ss: 0.768435, loss_d: 0.446134
0.3064 --- loss: 0.778064, loss_ss: 0.668923, loss_d: 0.109140
0.3447 --- loss: 0.881639, loss_ss: 0.807810, loss_d: 0.073829
0.3830 --- loss: 1.247876, loss_ss: 0.869529, loss_d: 0.378347
0.4213 --- loss: 0.959263, loss_ss: 0.817849, loss_d: 0.141413
0.4596 --- loss: 1.132404, loss_ss: 1.048975, loss_d: 0.083429
0.4979 --- loss: 1.046558, loss_ss: 1.008419, loss_d: 0.038139
0.5362 --- loss: 1.043924, loss_ss: 0.540224, loss_d: 0.503701
0.5745 --- loss: 0.892899, loss_ss: 0.825861, loss_d: 0.067038
0.6128 --- loss: 1.606187, loss_ss: 0.814956, loss_d: 0.791230
0.6511 --- loss: 0.911127, loss_ss: 0.772559, loss_d: 0.138568
0.6894 --- loss: 0.918779, loss_ss: 0.624607, loss_d: 0.294172
0.7277 --- loss: 1.133611, loss_ss: 0.997944, loss_d: 0.135666
0.7660 --- loss: 1.252046, loss_ss: 1.128460, loss_d: 0.123586
0.8043 --- loss: 0.864441, loss_ss: 0.782421, loss_d: 0.082020
0.8426 --- loss: 0.937169, loss_ss: 0.837605, loss_d: 0.099564
0.8809 --- loss: 0.934337, loss_ss: 0.724957, loss_d: 0.209381
0.9192 --- loss: 0.713154, loss_ss: 0.651250, loss_d: 0.061904
0.9575 --- loss: 0.779607, loss_ss: 0.733132, loss_d: 0.046475
0.9958 --- loss: 0.998079, loss_ss: 0.900207, loss_d: 0.097872
Epoch finished! Loss: 1.1233926625544084
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.299878, loss_ss: 1.218422, loss_d: 0.081456
0.0383 --- loss: 1.186995, loss_ss: 1.079583, loss_d: 0.107411
0.0766 --- loss: 1.120602, loss_ss: 0.818692, loss_d: 0.301910
0.1149 --- loss: 1.023505, loss_ss: 0.946570, loss_d: 0.076935
0.1532 --- loss: 0.826207, loss_ss: 0.735446, loss_d: 0.090761
0.1915 --- loss: 1.111042, loss_ss: 0.909490, loss_d: 0.201552
0.2298 --- loss: 1.000561, loss_ss: 0.880468, loss_d: 0.120093
0.2681 --- loss: 0.666541, loss_ss: 0.599606, loss_d: 0.066935
0.3064 --- loss: 0.899585, loss_ss: 0.755607, loss_d: 0.143979
0.3447 --- loss: 1.048529, loss_ss: 0.969065, loss_d: 0.079464
0.3830 --- loss: 0.886308, loss_ss: 0.786533, loss_d: 0.099774
0.4213 --- loss: 1.291303, loss_ss: 0.987378, loss_d: 0.303925
0.4596 --- loss: 1.347288, loss_ss: 0.904714, loss_d: 0.442574
0.4979 --- loss: 0.990659, loss_ss: 0.664183, loss_d: 0.326477
0.5362 --- loss: 0.932680, loss_ss: 0.901719, loss_d: 0.030960
0.5745 --- loss: 1.266317, loss_ss: 0.908292, loss_d: 0.358026
0.6128 --- loss: 0.858899, loss_ss: 0.761645, loss_d: 0.097254
0.6511 --- loss: 1.467058, loss_ss: 1.444152, loss_d: 0.022906
0.6894 --- loss: 1.046917, loss_ss: 0.938684, loss_d: 0.108233
0.7277 --- loss: 1.023286, loss_ss: 0.813191, loss_d: 0.210094
0.7660 --- loss: 2.183651, loss_ss: 0.803310, loss_d: 1.380340
0.8043 --- loss: 0.899376, loss_ss: 0.865510, loss_d: 0.033867
0.8426 --- loss: 1.020604, loss_ss: 0.857941, loss_d: 0.162663
0.8809 --- loss: 0.947521, loss_ss: 0.685465, loss_d: 0.262056
0.9192 --- loss: 1.088292, loss_ss: 0.918135, loss_d: 0.170157
0.9575 --- loss: 1.934733, loss_ss: 0.671504, loss_d: 1.263229
0.9958 --- loss: 0.885054, loss_ss: 0.712773, loss_d: 0.172281
Epoch finished! Loss: 1.1106534561434924
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.909295, loss_ss: 0.858980, loss_d: 0.050315
0.0383 --- loss: 0.961736, loss_ss: 0.838851, loss_d: 0.122885
0.0766 --- loss: 1.145158, loss_ss: 1.046166, loss_d: 0.098992
0.1149 --- loss: 1.106585, loss_ss: 1.091238, loss_d: 0.015347
0.1532 --- loss: 0.891884, loss_ss: 0.791606, loss_d: 0.100278
0.1915 --- loss: 0.953371, loss_ss: 0.853894, loss_d: 0.099477
0.2298 --- loss: 1.163864, loss_ss: 0.807187, loss_d: 0.356677
0.2681 --- loss: 1.329454, loss_ss: 1.248639, loss_d: 0.080816
0.3064 --- loss: 0.882198, loss_ss: 0.782773, loss_d: 0.099424
0.3447 --- loss: 1.108217, loss_ss: 0.889825, loss_d: 0.218391
0.3830 --- loss: 1.138073, loss_ss: 0.982164, loss_d: 0.155909
0.4213 --- loss: 1.163804, loss_ss: 0.899128, loss_d: 0.264676
0.4596 --- loss: 1.164923, loss_ss: 0.824219, loss_d: 0.340704
0.4979 --- loss: 0.863554, loss_ss: 0.842540, loss_d: 0.021013
0.5362 --- loss: 1.049346, loss_ss: 0.723797, loss_d: 0.325549
0.5745 --- loss: 1.042128, loss_ss: 0.745866, loss_d: 0.296262
0.6128 --- loss: 1.350400, loss_ss: 0.777186, loss_d: 0.573214
0.6511 --- loss: 1.146163, loss_ss: 0.951488, loss_d: 0.194675
0.6894 --- loss: 1.167359, loss_ss: 0.948844, loss_d: 0.218515
0.7277 --- loss: 0.997220, loss_ss: 0.945229, loss_d: 0.051991
0.7660 --- loss: 0.865041, loss_ss: 0.782820, loss_d: 0.082222
0.8043 --- loss: 1.044787, loss_ss: 0.842401, loss_d: 0.202386
0.8426 --- loss: 0.890013, loss_ss: 0.725901, loss_d: 0.164112
0.8809 --- loss: 0.897678, loss_ss: 0.736744, loss_d: 0.160933
0.9192 --- loss: 0.876093, loss_ss: 0.766574, loss_d: 0.109520
0.9575 --- loss: 0.887986, loss_ss: 0.778144, loss_d: 0.109842
0.9958 --- loss: 0.686166, loss_ss: 0.642178, loss_d: 0.043988
Epoch finished! Loss: 1.0450163629776674
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.639578, loss_ss: 0.621180, loss_d: 0.018398
0.0383 --- loss: 0.922253, loss_ss: 0.698531, loss_d: 0.223722
0.0766 --- loss: 0.895571, loss_ss: 0.685498, loss_d: 0.210072
0.1149 --- loss: 1.023273, loss_ss: 0.969505, loss_d: 0.053767
0.1532 --- loss: 1.012566, loss_ss: 0.876364, loss_d: 0.136202
0.1915 --- loss: 0.866313, loss_ss: 0.751792, loss_d: 0.114521
0.2298 --- loss: 1.620466, loss_ss: 0.893286, loss_d: 0.727180
0.2681 --- loss: 1.048375, loss_ss: 1.011552, loss_d: 0.036823
0.3064 --- loss: 1.147074, loss_ss: 1.125992, loss_d: 0.021082
0.3447 --- loss: 0.998886, loss_ss: 0.748611, loss_d: 0.250275
0.3830 --- loss: 0.751808, loss_ss: 0.728496, loss_d: 0.023312
0.4213 --- loss: 0.808492, loss_ss: 0.800911, loss_d: 0.007580
0.4596 --- loss: 0.882225, loss_ss: 0.713624, loss_d: 0.168601
0.4979 --- loss: 1.032063, loss_ss: 0.989912, loss_d: 0.042152
0.5362 --- loss: 0.773853, loss_ss: 0.666820, loss_d: 0.107033
0.5745 --- loss: 0.860818, loss_ss: 0.846714, loss_d: 0.014104
0.6128 --- loss: 2.159983, loss_ss: 0.772787, loss_d: 1.387196
0.6511 --- loss: 0.938635, loss_ss: 0.846197, loss_d: 0.092438
0.6894 --- loss: 0.967894, loss_ss: 0.903762, loss_d: 0.064133
0.7277 --- loss: 0.985838, loss_ss: 0.967876, loss_d: 0.017962
0.7660 --- loss: 0.901754, loss_ss: 0.774759, loss_d: 0.126995
0.8043 --- loss: 0.985419, loss_ss: 0.969371, loss_d: 0.016048
0.8426 --- loss: 1.230468, loss_ss: 1.200415, loss_d: 0.030053
0.8809 --- loss: 0.653583, loss_ss: 0.632907, loss_d: 0.020677
0.9192 --- loss: 0.901355, loss_ss: 0.841387, loss_d: 0.059968
0.9575 --- loss: 1.224908, loss_ss: 1.106571, loss_d: 0.118338
0.9958 --- loss: 1.062055, loss_ss: 0.980137, loss_d: 0.081918
Epoch finished! Loss: 1.0026524439168616
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.755495, loss_ss: 0.643123, loss_d: 0.112372
0.0383 --- loss: 1.168430, loss_ss: 0.966292, loss_d: 0.202138
0.0766 --- loss: 0.888632, loss_ss: 0.760388, loss_d: 0.128244
0.1149 --- loss: 1.076807, loss_ss: 0.799460, loss_d: 0.277347
0.1532 --- loss: 0.870868, loss_ss: 0.846692, loss_d: 0.024176
0.1915 --- loss: 0.691775, loss_ss: 0.657371, loss_d: 0.034403
0.2298 --- loss: 1.274440, loss_ss: 0.904115, loss_d: 0.370325
0.2681 --- loss: 0.894570, loss_ss: 0.880330, loss_d: 0.014240
0.3064 --- loss: 0.764357, loss_ss: 0.690501, loss_d: 0.073857
0.3447 --- loss: 1.073707, loss_ss: 0.673398, loss_d: 0.400309
0.3830 --- loss: 1.065081, loss_ss: 1.039406, loss_d: 0.025675
0.4213 --- loss: 0.919053, loss_ss: 0.646268, loss_d: 0.272784
0.4596 --- loss: 0.763089, loss_ss: 0.642317, loss_d: 0.120772
0.4979 --- loss: 1.028043, loss_ss: 0.847413, loss_d: 0.180630
0.5362 --- loss: 1.375051, loss_ss: 0.906388, loss_d: 0.468663
0.5745 --- loss: 0.996179, loss_ss: 0.853994, loss_d: 0.142185
0.6128 --- loss: 0.980105, loss_ss: 0.939779, loss_d: 0.040326
0.6511 --- loss: 0.950788, loss_ss: 0.802022, loss_d: 0.148767
0.6894 --- loss: 1.334883, loss_ss: 1.196985, loss_d: 0.137898
0.7277 --- loss: 0.864801, loss_ss: 0.734133, loss_d: 0.130668
0.7660 --- loss: 0.827889, loss_ss: 0.778537, loss_d: 0.049352
0.8043 --- loss: 0.600694, loss_ss: 0.582935, loss_d: 0.017759
0.8426 --- loss: 0.770475, loss_ss: 0.754928, loss_d: 0.015547
0.8809 --- loss: 0.674714, loss_ss: 0.621007, loss_d: 0.053707
0.9192 --- loss: 1.128221, loss_ss: 0.879353, loss_d: 0.248869
0.9575 --- loss: 0.879584, loss_ss: 0.874470, loss_d: 0.005114
0.9958 --- loss: 0.904372, loss_ss: 0.629593, loss_d: 0.274779
Epoch finished! Loss: 0.9658921842830848
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.146412, loss_ss: 0.906831, loss_d: 0.239581
0.0383 --- loss: 0.908087, loss_ss: 0.849048, loss_d: 0.059039
0.0766 --- loss: 0.785840, loss_ss: 0.639090, loss_d: 0.146750
0.1149 --- loss: 0.797684, loss_ss: 0.645146, loss_d: 0.152537
0.1532 --- loss: 0.743740, loss_ss: 0.739747, loss_d: 0.003993
0.1915 --- loss: 0.992140, loss_ss: 0.974925, loss_d: 0.017215
0.2298 --- loss: 1.014984, loss_ss: 0.971441, loss_d: 0.043542
0.2681 --- loss: 0.945752, loss_ss: 0.800245, loss_d: 0.145507
0.3064 --- loss: 0.755350, loss_ss: 0.751937, loss_d: 0.003413
0.3447 --- loss: 0.707792, loss_ss: 0.683112, loss_d: 0.024679
0.3830 --- loss: 0.955858, loss_ss: 0.924204, loss_d: 0.031654
0.4213 --- loss: 1.157859, loss_ss: 0.923921, loss_d: 0.233938
0.4596 --- loss: 1.571249, loss_ss: 1.493079, loss_d: 0.078170
0.4979 --- loss: 0.744764, loss_ss: 0.735342, loss_d: 0.009422
0.5362 --- loss: 1.054773, loss_ss: 0.958461, loss_d: 0.096312
0.5745 --- loss: 0.968741, loss_ss: 0.921902, loss_d: 0.046839
0.6128 --- loss: 0.821823, loss_ss: 0.752874, loss_d: 0.068949
0.6511 --- loss: 0.621184, loss_ss: 0.615509, loss_d: 0.005675
0.6894 --- loss: 0.991573, loss_ss: 0.854606, loss_d: 0.136967
0.7277 --- loss: 0.786136, loss_ss: 0.553901, loss_d: 0.232235
0.7660 --- loss: 1.130878, loss_ss: 1.115098, loss_d: 0.015780
0.8043 --- loss: 0.886267, loss_ss: 0.838233, loss_d: 0.048034
0.8426 --- loss: 0.987994, loss_ss: 0.695317, loss_d: 0.292676
0.8809 --- loss: 0.745613, loss_ss: 0.718749, loss_d: 0.026864
0.9192 --- loss: 0.949049, loss_ss: 0.889596, loss_d: 0.059454
0.9575 --- loss: 0.918216, loss_ss: 0.799625, loss_d: 0.118591
0.9958 --- loss: 0.910927, loss_ss: 0.661854, loss_d: 0.249072
Epoch finished! Loss: 0.9526614553626926
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7580246913580246
             precision    recall  f1-score   support

        0.0       0.98      0.68      0.80       158
        1.0       0.44      0.07      0.12       103
        2.0       0.73      0.98      0.83       306
        3.0       0.99      0.79      0.88       133
        4.0       0.57      0.87      0.69       110

avg / total       0.76      0.76      0.72       810
 


====== chc006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.46  67.72   99.69  98.17     80.15
1  87.04   6.80   98.73  43.75     11.76
2  85.31  97.71   77.78  72.75     83.40
3  96.42  78.95   99.85  99.06     87.87
4  89.38  87.27   89.71  57.14     69.06
Total accuracy: 75.80%
Average sen: 67.69%
Average spec: 93.15%
Macro f1-score: 66.45%
Diagnosis acc on 15mins: 0.1111111111111111
[0.8282178  0.95499641 0.99669051 0.9543727  0.89392442 0.99184567
 0.94294274 0.99704319 0.99932706 0.83957309 0.97991085 0.79891008
 0.29989254 0.50517458 0.9783569  0.95404047 0.93900764 0.2354176
 0.70065624 0.57439399 0.35963866 0.84947687 0.93559462 0.75030273
 0.88912177 0.61551481 0.99713731]
pred: 0.8059807872330701, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.360959, loss_ss: 1.627882, loss_d: 0.733078
0.0384 --- loss: 2.237038, loss_ss: 1.640619, loss_d: 0.596419
0.0767 --- loss: 1.702774, loss_ss: 1.528547, loss_d: 0.174227
0.1151 --- loss: 1.791128, loss_ss: 1.385347, loss_d: 0.405781
0.1535 --- loss: 1.826758, loss_ss: 1.458904, loss_d: 0.367854
0.1919 --- loss: 2.087676, loss_ss: 1.458626, loss_d: 0.629049
0.2302 --- loss: 1.883711, loss_ss: 1.368089, loss_d: 0.515622
0.2686 --- loss: 2.098686, loss_ss: 1.544817, loss_d: 0.553869
0.3070 --- loss: 1.865831, loss_ss: 1.343344, loss_d: 0.522487
0.3454 --- loss: 1.996227, loss_ss: 1.351423, loss_d: 0.644804
0.3837 --- loss: 1.991062, loss_ss: 1.312558, loss_d: 0.678504
0.4221 --- loss: 2.233876, loss_ss: 1.589357, loss_d: 0.644519
0.4605 --- loss: 1.894444, loss_ss: 1.239614, loss_d: 0.654830
0.4988 --- loss: 1.913328, loss_ss: 1.335910, loss_d: 0.577418
0.5372 --- loss: 2.001518, loss_ss: 1.206455, loss_d: 0.795062
0.5756 --- loss: 1.872599, loss_ss: 1.276746, loss_d: 0.595853
0.6140 --- loss: 1.967791, loss_ss: 1.237286, loss_d: 0.730505
0.6523 --- loss: 1.618505, loss_ss: 1.046769, loss_d: 0.571735
0.6907 --- loss: 1.645484, loss_ss: 1.097271, loss_d: 0.548212
0.7291 --- loss: 1.978278, loss_ss: 1.442049, loss_d: 0.536229
0.7675 --- loss: 1.607298, loss_ss: 1.159544, loss_d: 0.447755
0.8058 --- loss: 1.716091, loss_ss: 1.103983, loss_d: 0.612108
0.8442 --- loss: 1.687603, loss_ss: 1.086221, loss_d: 0.601382
0.8826 --- loss: 1.573678, loss_ss: 1.170172, loss_d: 0.403506
0.9210 --- loss: 1.721334, loss_ss: 1.298662, loss_d: 0.422672
0.9593 --- loss: 1.907474, loss_ss: 1.157845, loss_d: 0.749629
0.9977 --- loss: 1.607228, loss_ss: 1.205795, loss_d: 0.401432
Epoch finished! Loss: 1.8965033930081587
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.492953, loss_ss: 1.056929, loss_d: 0.436025
0.0384 --- loss: 1.813327, loss_ss: 1.058995, loss_d: 0.754332
0.0767 --- loss: 1.834898, loss_ss: 1.250001, loss_d: 0.584897
0.1151 --- loss: 1.618895, loss_ss: 1.076041, loss_d: 0.542854
0.1535 --- loss: 1.821847, loss_ss: 1.142310, loss_d: 0.679537
0.1919 --- loss: 1.688805, loss_ss: 0.968228, loss_d: 0.720577
0.2302 --- loss: 1.579088, loss_ss: 1.207019, loss_d: 0.372069
0.2686 --- loss: 1.259306, loss_ss: 0.920868, loss_d: 0.338439
0.3070 --- loss: 1.405498, loss_ss: 1.151266, loss_d: 0.254232
0.3454 --- loss: 1.204240, loss_ss: 1.012448, loss_d: 0.191792
0.3837 --- loss: 1.429593, loss_ss: 1.222632, loss_d: 0.206961
0.4221 --- loss: 1.760669, loss_ss: 1.041006, loss_d: 0.719663
0.4605 --- loss: 1.213041, loss_ss: 0.976148, loss_d: 0.236894
0.4988 --- loss: 1.563524, loss_ss: 1.284330, loss_d: 0.279194
0.5372 --- loss: 1.742909, loss_ss: 1.184917, loss_d: 0.557992
0.5756 --- loss: 1.666539, loss_ss: 1.162448, loss_d: 0.504091
0.6140 --- loss: 1.185707, loss_ss: 1.027524, loss_d: 0.158184
0.6523 --- loss: 1.906486, loss_ss: 1.089882, loss_d: 0.816604
0.6907 --- loss: 1.173838, loss_ss: 0.935329, loss_d: 0.238509
0.7291 --- loss: 1.426259, loss_ss: 1.048500, loss_d: 0.377758
0.7675 --- loss: 1.360011, loss_ss: 0.868868, loss_d: 0.491142
0.8058 --- loss: 1.969582, loss_ss: 0.881313, loss_d: 1.088269
0.8442 --- loss: 1.566669, loss_ss: 1.340301, loss_d: 0.226368
0.8826 --- loss: 1.610196, loss_ss: 0.936487, loss_d: 0.673709
0.9210 --- loss: 1.224710, loss_ss: 0.763252, loss_d: 0.461458
0.9593 --- loss: 1.718076, loss_ss: 1.275537, loss_d: 0.442539
0.9977 --- loss: 1.168778, loss_ss: 1.015215, loss_d: 0.153563
Epoch finished! Loss: 1.50946914095145
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.071697, loss_ss: 0.936866, loss_d: 0.134831
0.0384 --- loss: 1.360890, loss_ss: 1.081928, loss_d: 0.278961
0.0767 --- loss: 1.170572, loss_ss: 0.785273, loss_d: 0.385299
0.1151 --- loss: 1.183244, loss_ss: 1.037729, loss_d: 0.145515
0.1535 --- loss: 1.336828, loss_ss: 0.965790, loss_d: 0.371038
0.1919 --- loss: 1.213006, loss_ss: 0.967959, loss_d: 0.245047
0.2302 --- loss: 0.965431, loss_ss: 0.698925, loss_d: 0.266506
0.2686 --- loss: 1.123580, loss_ss: 0.973908, loss_d: 0.149672
0.3070 --- loss: 1.100579, loss_ss: 0.877414, loss_d: 0.223165
0.3454 --- loss: 1.242619, loss_ss: 1.086839, loss_d: 0.155780
0.3837 --- loss: 1.164215, loss_ss: 0.892972, loss_d: 0.271243
0.4221 --- loss: 1.076921, loss_ss: 0.863292, loss_d: 0.213628
0.4605 --- loss: 1.283797, loss_ss: 0.677661, loss_d: 0.606136
0.4988 --- loss: 1.150506, loss_ss: 0.906294, loss_d: 0.244211
0.5372 --- loss: 1.135187, loss_ss: 1.006128, loss_d: 0.129059
0.5756 --- loss: 1.273615, loss_ss: 1.029289, loss_d: 0.244326
0.6140 --- loss: 1.426579, loss_ss: 0.999946, loss_d: 0.426633
0.6523 --- loss: 1.271582, loss_ss: 1.091421, loss_d: 0.180161
0.6907 --- loss: 1.286874, loss_ss: 0.958137, loss_d: 0.328737
0.7291 --- loss: 1.309561, loss_ss: 0.973523, loss_d: 0.336038
0.7675 --- loss: 1.424208, loss_ss: 0.978957, loss_d: 0.445251
0.8058 --- loss: 0.962354, loss_ss: 0.863576, loss_d: 0.098778
0.8442 --- loss: 1.179497, loss_ss: 0.995295, loss_d: 0.184203
0.8826 --- loss: 1.005699, loss_ss: 0.732721, loss_d: 0.272978
0.9210 --- loss: 1.050270, loss_ss: 0.853498, loss_d: 0.196772
0.9593 --- loss: 0.956541, loss_ss: 0.820498, loss_d: 0.136043
0.9977 --- loss: 1.645136, loss_ss: 0.957737, loss_d: 0.687399
Epoch finished! Loss: 1.2782847415942413
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.286393, loss_ss: 0.923075, loss_d: 0.363318
0.0384 --- loss: 2.098685, loss_ss: 1.039837, loss_d: 1.058849
0.0767 --- loss: 1.166739, loss_ss: 0.832278, loss_d: 0.334461
0.1151 --- loss: 1.445248, loss_ss: 1.193269, loss_d: 0.251980
0.1535 --- loss: 1.060985, loss_ss: 0.918773, loss_d: 0.142211
0.1919 --- loss: 1.061753, loss_ss: 0.762373, loss_d: 0.299380
0.2302 --- loss: 1.449242, loss_ss: 1.034338, loss_d: 0.414904
0.2686 --- loss: 1.133767, loss_ss: 0.913108, loss_d: 0.220659
0.3070 --- loss: 1.314772, loss_ss: 0.929946, loss_d: 0.384827
0.3454 --- loss: 1.223597, loss_ss: 0.954044, loss_d: 0.269553
0.3837 --- loss: 1.054213, loss_ss: 0.969399, loss_d: 0.084814
0.4221 --- loss: 0.880851, loss_ss: 0.795312, loss_d: 0.085539
0.4605 --- loss: 1.095248, loss_ss: 0.972030, loss_d: 0.123218
0.4988 --- loss: 0.820437, loss_ss: 0.793520, loss_d: 0.026917
0.5372 --- loss: 1.559057, loss_ss: 0.791639, loss_d: 0.767418
0.5756 --- loss: 0.807869, loss_ss: 0.740853, loss_d: 0.067016
0.6140 --- loss: 0.987687, loss_ss: 0.792926, loss_d: 0.194762
0.6523 --- loss: 1.268353, loss_ss: 0.784811, loss_d: 0.483542
0.6907 --- loss: 1.285190, loss_ss: 1.033900, loss_d: 0.251289
0.7291 --- loss: 1.020520, loss_ss: 0.848460, loss_d: 0.172060
0.7675 --- loss: 1.372809, loss_ss: 0.890911, loss_d: 0.481898
0.8058 --- loss: 1.005659, loss_ss: 0.708307, loss_d: 0.297352
0.8442 --- loss: 0.876955, loss_ss: 0.801658, loss_d: 0.075297
0.8826 --- loss: 1.355251, loss_ss: 0.868168, loss_d: 0.487082
0.9210 --- loss: 1.430438, loss_ss: 0.804002, loss_d: 0.626436
0.9593 --- loss: 1.047762, loss_ss: 0.963377, loss_d: 0.084385
0.9977 --- loss: 1.480829, loss_ss: 1.405156, loss_d: 0.075673
Epoch finished! Loss: 1.2033721692287005
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.231344, loss_ss: 1.006801, loss_d: 0.224543
0.0384 --- loss: 0.931611, loss_ss: 0.899875, loss_d: 0.031735
0.0767 --- loss: 1.072022, loss_ss: 0.992562, loss_d: 0.079460
0.1151 --- loss: 1.221150, loss_ss: 1.097736, loss_d: 0.123414
0.1535 --- loss: 1.445189, loss_ss: 1.008526, loss_d: 0.436663
0.1919 --- loss: 0.986596, loss_ss: 0.784219, loss_d: 0.202378
0.2302 --- loss: 1.021106, loss_ss: 0.764297, loss_d: 0.256810
0.2686 --- loss: 0.815366, loss_ss: 0.680265, loss_d: 0.135100
0.3070 --- loss: 1.057114, loss_ss: 0.837394, loss_d: 0.219720
0.3454 --- loss: 1.181313, loss_ss: 0.962233, loss_d: 0.219080
0.3837 --- loss: 1.468057, loss_ss: 1.071751, loss_d: 0.396307
0.4221 --- loss: 0.817187, loss_ss: 0.679006, loss_d: 0.138181
0.4605 --- loss: 1.019439, loss_ss: 0.951037, loss_d: 0.068402
0.4988 --- loss: 1.156901, loss_ss: 1.067872, loss_d: 0.089029
0.5372 --- loss: 1.207804, loss_ss: 0.913955, loss_d: 0.293849
0.5756 --- loss: 1.333081, loss_ss: 1.114012, loss_d: 0.219069
0.6140 --- loss: 1.145398, loss_ss: 0.997312, loss_d: 0.148085
0.6523 --- loss: 1.422487, loss_ss: 1.316982, loss_d: 0.105505
0.6907 --- loss: 1.031137, loss_ss: 0.923955, loss_d: 0.107181
0.7291 --- loss: 0.846596, loss_ss: 0.764817, loss_d: 0.081779
0.7675 --- loss: 1.195927, loss_ss: 0.743414, loss_d: 0.452513
0.8058 --- loss: 1.488531, loss_ss: 1.002764, loss_d: 0.485767
0.8442 --- loss: 1.144868, loss_ss: 0.703778, loss_d: 0.441090
0.8826 --- loss: 1.294109, loss_ss: 0.970997, loss_d: 0.323113
0.9210 --- loss: 1.007871, loss_ss: 0.795195, loss_d: 0.212675
0.9593 --- loss: 1.135984, loss_ss: 1.054975, loss_d: 0.081009
0.9977 --- loss: 2.950175, loss_ss: 0.864891, loss_d: 2.085285
Epoch finished! Loss: 1.1691920949862553
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.058494, loss_ss: 0.800965, loss_d: 0.257528
0.0384 --- loss: 1.275739, loss_ss: 0.987420, loss_d: 0.288319
0.0767 --- loss: 1.549457, loss_ss: 1.130677, loss_d: 0.418780
0.1151 --- loss: 0.796697, loss_ss: 0.620010, loss_d: 0.176687
0.1535 --- loss: 1.307853, loss_ss: 1.064455, loss_d: 0.243398
0.1919 --- loss: 1.603015, loss_ss: 0.691277, loss_d: 0.911739
0.2302 --- loss: 1.011971, loss_ss: 0.886263, loss_d: 0.125708
0.2686 --- loss: 1.087060, loss_ss: 0.826792, loss_d: 0.260268
0.3070 --- loss: 0.898859, loss_ss: 0.764978, loss_d: 0.133882
0.3454 --- loss: 0.872263, loss_ss: 0.730694, loss_d: 0.141568
0.3837 --- loss: 1.140158, loss_ss: 0.738124, loss_d: 0.402034
0.4221 --- loss: 1.150705, loss_ss: 1.075265, loss_d: 0.075440
0.4605 --- loss: 0.854548, loss_ss: 0.736197, loss_d: 0.118351
0.4988 --- loss: 0.877178, loss_ss: 0.817799, loss_d: 0.059379
0.5372 --- loss: 0.943123, loss_ss: 0.894437, loss_d: 0.048685
0.5756 --- loss: 1.288640, loss_ss: 1.060233, loss_d: 0.228407
0.6140 --- loss: 1.089720, loss_ss: 1.052140, loss_d: 0.037580
0.6523 --- loss: 1.304358, loss_ss: 1.164732, loss_d: 0.139626
0.6907 --- loss: 1.063213, loss_ss: 0.833612, loss_d: 0.229601
0.7291 --- loss: 0.937321, loss_ss: 0.769925, loss_d: 0.167396
0.7675 --- loss: 0.822462, loss_ss: 0.777374, loss_d: 0.045088
0.8058 --- loss: 0.971385, loss_ss: 0.920973, loss_d: 0.050412
0.8442 --- loss: 0.883626, loss_ss: 0.840504, loss_d: 0.043122
0.8826 --- loss: 1.564008, loss_ss: 0.852163, loss_d: 0.711845
0.9210 --- loss: 1.323568, loss_ss: 1.179723, loss_d: 0.143845
0.9593 --- loss: 0.787708, loss_ss: 0.722027, loss_d: 0.065681
0.9977 --- loss: 0.885017, loss_ss: 0.794043, loss_d: 0.090974
Epoch finished! Loss: 1.0874412720020001
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.154971, loss_ss: 0.985864, loss_d: 0.169107
0.0384 --- loss: 1.060108, loss_ss: 1.044045, loss_d: 0.016063
0.0767 --- loss: 1.702075, loss_ss: 1.662511, loss_d: 0.039564
0.1151 --- loss: 1.302342, loss_ss: 1.204759, loss_d: 0.097583
0.1535 --- loss: 1.081537, loss_ss: 0.876004, loss_d: 0.205533
0.1919 --- loss: 1.024530, loss_ss: 1.010355, loss_d: 0.014175
0.2302 --- loss: 1.503442, loss_ss: 0.971259, loss_d: 0.532183
0.2686 --- loss: 1.198686, loss_ss: 0.843498, loss_d: 0.355188
0.3070 --- loss: 1.046930, loss_ss: 0.837873, loss_d: 0.209057
0.3454 --- loss: 1.523518, loss_ss: 1.162063, loss_d: 0.361454
0.3837 --- loss: 1.222508, loss_ss: 0.947290, loss_d: 0.275218
0.4221 --- loss: 1.099476, loss_ss: 0.977888, loss_d: 0.121588
0.4605 --- loss: 1.034776, loss_ss: 0.987748, loss_d: 0.047028
0.4988 --- loss: 1.086944, loss_ss: 1.050160, loss_d: 0.036784
0.5372 --- loss: 0.776539, loss_ss: 0.695173, loss_d: 0.081366
0.5756 --- loss: 1.173527, loss_ss: 0.957739, loss_d: 0.215789
0.6140 --- loss: 1.011642, loss_ss: 0.712490, loss_d: 0.299152
0.6523 --- loss: 1.100255, loss_ss: 0.891220, loss_d: 0.209035
0.6907 --- loss: 0.985909, loss_ss: 0.928567, loss_d: 0.057342
0.7291 --- loss: 0.739040, loss_ss: 0.703973, loss_d: 0.035067
0.7675 --- loss: 1.356921, loss_ss: 0.781181, loss_d: 0.575740
0.8058 --- loss: 1.126522, loss_ss: 0.966729, loss_d: 0.159793
0.8442 --- loss: 0.985428, loss_ss: 0.918843, loss_d: 0.066585
0.8826 --- loss: 0.761322, loss_ss: 0.748540, loss_d: 0.012782
0.9210 --- loss: 1.294780, loss_ss: 1.026093, loss_d: 0.268686
0.9593 --- loss: 1.117559, loss_ss: 1.081209, loss_d: 0.036350
0.9977 --- loss: 1.981923, loss_ss: 0.732028, loss_d: 1.249895
Epoch finished! Loss: 1.0432613535569264
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.982971, loss_ss: 0.896562, loss_d: 0.086410
0.0384 --- loss: 0.821217, loss_ss: 0.706730, loss_d: 0.114486
0.0767 --- loss: 1.466526, loss_ss: 1.007263, loss_d: 0.459263
0.1151 --- loss: 1.117821, loss_ss: 1.030690, loss_d: 0.087131
0.1535 --- loss: 0.837767, loss_ss: 0.810831, loss_d: 0.026936
0.1919 --- loss: 0.905747, loss_ss: 0.886285, loss_d: 0.019462
0.2302 --- loss: 1.367011, loss_ss: 1.324420, loss_d: 0.042590
0.2686 --- loss: 1.034695, loss_ss: 0.993901, loss_d: 0.040794
0.3070 --- loss: 0.588489, loss_ss: 0.577856, loss_d: 0.010633
0.3454 --- loss: 0.934519, loss_ss: 0.655033, loss_d: 0.279485
0.3837 --- loss: 0.848062, loss_ss: 0.610658, loss_d: 0.237405
0.4221 --- loss: 0.881618, loss_ss: 0.704260, loss_d: 0.177358
0.4605 --- loss: 0.980066, loss_ss: 0.741298, loss_d: 0.238768
0.4988 --- loss: 0.788101, loss_ss: 0.766835, loss_d: 0.021266
0.5372 --- loss: 0.755460, loss_ss: 0.741829, loss_d: 0.013631
0.5756 --- loss: 1.312462, loss_ss: 1.254182, loss_d: 0.058280
0.6140 --- loss: 0.938292, loss_ss: 0.861166, loss_d: 0.077125
0.6523 --- loss: 0.924264, loss_ss: 0.854921, loss_d: 0.069344
0.6907 --- loss: 1.107981, loss_ss: 0.821102, loss_d: 0.286879
0.7291 --- loss: 0.815920, loss_ss: 0.773541, loss_d: 0.042379
0.7675 --- loss: 0.712012, loss_ss: 0.681982, loss_d: 0.030030
0.8058 --- loss: 2.004169, loss_ss: 0.893577, loss_d: 1.110592
0.8442 --- loss: 0.987443, loss_ss: 0.745339, loss_d: 0.242104
0.8826 --- loss: 0.906038, loss_ss: 0.739927, loss_d: 0.166111
0.9210 --- loss: 1.125562, loss_ss: 0.775083, loss_d: 0.350479
0.9593 --- loss: 1.327983, loss_ss: 0.749839, loss_d: 0.578145
0.9977 --- loss: 1.086855, loss_ss: 0.914398, loss_d: 0.172457
Epoch finished! Loss: 0.9838019939569327
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.948136, loss_ss: 0.693628, loss_d: 0.254507
0.0384 --- loss: 0.807742, loss_ss: 0.738203, loss_d: 0.069539
0.0767 --- loss: 0.615576, loss_ss: 0.537653, loss_d: 0.077923
0.1151 --- loss: 0.862586, loss_ss: 0.825082, loss_d: 0.037504
0.1535 --- loss: 1.289579, loss_ss: 0.919078, loss_d: 0.370501
0.1919 --- loss: 0.887683, loss_ss: 0.862117, loss_d: 0.025566
0.2302 --- loss: 0.864227, loss_ss: 0.770211, loss_d: 0.094016
0.2686 --- loss: 0.858429, loss_ss: 0.744329, loss_d: 0.114100
0.3070 --- loss: 1.305492, loss_ss: 0.966519, loss_d: 0.338974
0.3454 --- loss: 0.677884, loss_ss: 0.653465, loss_d: 0.024418
0.3837 --- loss: 1.030811, loss_ss: 0.957328, loss_d: 0.073483
0.4221 --- loss: 1.121602, loss_ss: 1.095843, loss_d: 0.025759
0.4605 --- loss: 0.630937, loss_ss: 0.616953, loss_d: 0.013983
0.4988 --- loss: 0.797592, loss_ss: 0.783985, loss_d: 0.013607
0.5372 --- loss: 0.664633, loss_ss: 0.647774, loss_d: 0.016859
0.5756 --- loss: 0.954746, loss_ss: 0.907302, loss_d: 0.047444
0.6140 --- loss: 1.042605, loss_ss: 0.815006, loss_d: 0.227599
0.6523 --- loss: 0.890444, loss_ss: 0.834107, loss_d: 0.056337
0.6907 --- loss: 1.289943, loss_ss: 0.584179, loss_d: 0.705764
0.7291 --- loss: 0.997378, loss_ss: 0.688597, loss_d: 0.308780
0.7675 --- loss: 1.147213, loss_ss: 1.128544, loss_d: 0.018669
0.8058 --- loss: 0.934868, loss_ss: 0.839095, loss_d: 0.095773
0.8442 --- loss: 1.304795, loss_ss: 1.094082, loss_d: 0.210713
0.8826 --- loss: 1.043647, loss_ss: 0.689652, loss_d: 0.353995
0.9210 --- loss: 1.033073, loss_ss: 0.935563, loss_d: 0.097510
0.9593 --- loss: 0.669909, loss_ss: 0.621373, loss_d: 0.048535
0.9977 --- loss: 1.903356, loss_ss: 1.880069, loss_d: 0.023286
Epoch finished! Loss: 0.9507904128386424
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.695271, loss_ss: 0.671615, loss_d: 0.023655
0.0384 --- loss: 1.237086, loss_ss: 1.193937, loss_d: 0.043149
0.0767 --- loss: 0.931174, loss_ss: 0.697995, loss_d: 0.233179
0.1151 --- loss: 0.854750, loss_ss: 0.786189, loss_d: 0.068561
0.1535 --- loss: 1.043381, loss_ss: 0.849371, loss_d: 0.194010
0.1919 --- loss: 0.757023, loss_ss: 0.727401, loss_d: 0.029621
0.2302 --- loss: 0.703501, loss_ss: 0.623119, loss_d: 0.080382
0.2686 --- loss: 0.859108, loss_ss: 0.597336, loss_d: 0.261772
0.3070 --- loss: 0.810493, loss_ss: 0.773783, loss_d: 0.036710
0.3454 --- loss: 1.078310, loss_ss: 0.781175, loss_d: 0.297135
0.3837 --- loss: 1.148530, loss_ss: 0.920555, loss_d: 0.227975
0.4221 --- loss: 0.903778, loss_ss: 0.892045, loss_d: 0.011733
0.4605 --- loss: 0.937821, loss_ss: 0.898206, loss_d: 0.039615
0.4988 --- loss: 0.806506, loss_ss: 0.732770, loss_d: 0.073736
0.5372 --- loss: 0.867705, loss_ss: 0.852444, loss_d: 0.015260
0.5756 --- loss: 1.020857, loss_ss: 1.002416, loss_d: 0.018440
0.6140 --- loss: 1.677789, loss_ss: 1.031970, loss_d: 0.645819
0.6523 --- loss: 0.787945, loss_ss: 0.696496, loss_d: 0.091449
0.6907 --- loss: 0.716190, loss_ss: 0.706562, loss_d: 0.009628
0.7291 --- loss: 1.000444, loss_ss: 0.986211, loss_d: 0.014232
0.7675 --- loss: 0.785636, loss_ss: 0.689256, loss_d: 0.096380
0.8058 --- loss: 1.035346, loss_ss: 0.878309, loss_d: 0.157037
0.8442 --- loss: 0.799059, loss_ss: 0.752507, loss_d: 0.046551
0.8826 --- loss: 0.931510, loss_ss: 0.826679, loss_d: 0.104831
0.9210 --- loss: 1.659881, loss_ss: 0.646913, loss_d: 1.012968
0.9593 --- loss: 0.549894, loss_ss: 0.542253, loss_d: 0.007641
0.9977 --- loss: 1.227755, loss_ss: 1.122570, loss_d: 0.105185
Epoch finished! Loss: 0.9271174731162878
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7427083333333333
             precision    recall  f1-score   support

        0.0       0.87      0.97      0.91       144
        1.0       0.49      0.27      0.35        82
        2.0       0.73      0.77      0.75       379
        3.0       1.00      0.59      0.75       227
        4.0       0.57      0.98      0.72       128

avg / total       0.77      0.74      0.73       960
 


====== chc008-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.29  96.53   97.43   86.88     91.45
1  91.35  26.83   97.38   48.89     34.65
2  79.58  76.78   81.41   72.93     74.81
3  90.42  59.47  100.00  100.00     74.59
4  89.90  98.44   88.58   57.01     72.21
Total accuracy: 74.27%
Average sen: 71.61%
Average spec: 92.96%
Macro f1-score: 69.54%
Diagnosis acc on 15mins: 0.75
[4.21008823e-04 2.61407316e-04 1.34360045e-04 1.45640632e-03
 2.53174990e-01 9.86376822e-01 9.83208716e-01 7.87428498e-01
 6.11756325e-01 8.72082263e-02 4.47631627e-01 1.43715769e-01
 9.54020441e-01 9.98487234e-01 9.56454575e-01 3.81411687e-02
 2.80192513e-02 5.68306983e-01 2.15145126e-01 2.09825276e-03
 1.36225732e-04 1.89476807e-04 1.21711482e-05 1.98677927e-03
 6.12990884e-03 1.62466938e-04 1.86706893e-04 1.43361082e-02
 1.77381933e-01 3.61949096e-05 8.35897026e-07 4.71691892e-05]
pred: 0.2582516613791057, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.576007, loss_ss: 1.812308, loss_d: 0.763699
0.0383 --- loss: 1.949478, loss_ss: 1.620665, loss_d: 0.328814
0.0767 --- loss: 2.100604, loss_ss: 1.657809, loss_d: 0.442794
0.1150 --- loss: 1.927769, loss_ss: 1.517996, loss_d: 0.409773
0.1533 --- loss: 1.757869, loss_ss: 1.496944, loss_d: 0.260925
0.1916 --- loss: 1.820033, loss_ss: 1.419971, loss_d: 0.400063
0.2300 --- loss: 2.044371, loss_ss: 1.481319, loss_d: 0.563051
0.2683 --- loss: 2.161245, loss_ss: 1.519329, loss_d: 0.641916
0.3066 --- loss: 2.066476, loss_ss: 1.388520, loss_d: 0.677957
0.3450 --- loss: 1.786315, loss_ss: 1.394906, loss_d: 0.391409
0.3833 --- loss: 2.044689, loss_ss: 1.480006, loss_d: 0.564683
0.4216 --- loss: 1.612186, loss_ss: 1.252227, loss_d: 0.359958
0.4599 --- loss: 1.837582, loss_ss: 1.275362, loss_d: 0.562221
0.4983 --- loss: 1.831900, loss_ss: 1.336436, loss_d: 0.495465
0.5366 --- loss: 1.964666, loss_ss: 1.309896, loss_d: 0.654770
0.5749 --- loss: 2.269155, loss_ss: 1.240900, loss_d: 1.028255
0.6133 --- loss: 1.773468, loss_ss: 1.424440, loss_d: 0.349027
0.6516 --- loss: 1.886478, loss_ss: 1.345862, loss_d: 0.540616
0.6899 --- loss: 2.033062, loss_ss: 1.172946, loss_d: 0.860116
0.7282 --- loss: 1.702148, loss_ss: 1.238215, loss_d: 0.463933
0.7666 --- loss: 2.047029, loss_ss: 1.325160, loss_d: 0.721869
0.8049 --- loss: 1.723460, loss_ss: 1.243715, loss_d: 0.479745
0.8432 --- loss: 1.761140, loss_ss: 1.181447, loss_d: 0.579693
0.8816 --- loss: 1.603794, loss_ss: 1.075413, loss_d: 0.528381
0.9199 --- loss: 1.723145, loss_ss: 1.160883, loss_d: 0.562262
0.9582 --- loss: 1.494697, loss_ss: 1.195055, loss_d: 0.299642
0.9966 --- loss: 1.835560, loss_ss: 1.517187, loss_d: 0.318372
Epoch finished! Loss: 1.9213021622254298
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.698497, loss_ss: 1.328424, loss_d: 0.370072
0.0383 --- loss: 1.559914, loss_ss: 1.296834, loss_d: 0.263079
0.0767 --- loss: 1.543828, loss_ss: 1.288234, loss_d: 0.255594
0.1150 --- loss: 1.622225, loss_ss: 1.113778, loss_d: 0.508447
0.1533 --- loss: 1.976810, loss_ss: 1.094042, loss_d: 0.882768
0.1916 --- loss: 1.387930, loss_ss: 1.120299, loss_d: 0.267632
0.2300 --- loss: 1.782402, loss_ss: 1.239607, loss_d: 0.542795
0.2683 --- loss: 1.514226, loss_ss: 1.128247, loss_d: 0.385979
0.3066 --- loss: 1.506855, loss_ss: 1.035450, loss_d: 0.471405
0.3450 --- loss: 1.526407, loss_ss: 1.065132, loss_d: 0.461274
0.3833 --- loss: 1.480052, loss_ss: 1.044568, loss_d: 0.435483
0.4216 --- loss: 1.787724, loss_ss: 1.115643, loss_d: 0.672081
0.4599 --- loss: 1.378116, loss_ss: 1.055750, loss_d: 0.322366
0.4983 --- loss: 1.564296, loss_ss: 0.976904, loss_d: 0.587392
0.5366 --- loss: 1.878437, loss_ss: 0.983764, loss_d: 0.894673
0.5749 --- loss: 1.692907, loss_ss: 1.201643, loss_d: 0.491264
0.6133 --- loss: 1.109178, loss_ss: 0.893119, loss_d: 0.216059
0.6516 --- loss: 1.228651, loss_ss: 1.057919, loss_d: 0.170732
0.6899 --- loss: 1.319358, loss_ss: 1.186662, loss_d: 0.132695
0.7282 --- loss: 1.642621, loss_ss: 1.252293, loss_d: 0.390327
0.7666 --- loss: 1.192908, loss_ss: 0.957028, loss_d: 0.235880
0.8049 --- loss: 2.069210, loss_ss: 1.167592, loss_d: 0.901618
0.8432 --- loss: 1.238865, loss_ss: 1.017276, loss_d: 0.221589
0.8816 --- loss: 1.440777, loss_ss: 1.099396, loss_d: 0.341380
0.9199 --- loss: 1.451236, loss_ss: 1.160909, loss_d: 0.290328
0.9582 --- loss: 1.350500, loss_ss: 1.073672, loss_d: 0.276828
0.9966 --- loss: 1.539119, loss_ss: 1.225603, loss_d: 0.313516
Epoch finished! Loss: 1.4965958847449377
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.331727, loss_ss: 1.195852, loss_d: 0.135875
0.0383 --- loss: 1.202373, loss_ss: 0.878440, loss_d: 0.323932
0.0767 --- loss: 1.265401, loss_ss: 1.035498, loss_d: 0.229902
0.1150 --- loss: 1.387398, loss_ss: 0.919844, loss_d: 0.467555
0.1533 --- loss: 1.741450, loss_ss: 1.026827, loss_d: 0.714623
0.1916 --- loss: 1.795903, loss_ss: 1.032333, loss_d: 0.763570
0.2300 --- loss: 1.183027, loss_ss: 0.880861, loss_d: 0.302166
0.2683 --- loss: 1.136613, loss_ss: 0.985962, loss_d: 0.150651
0.3066 --- loss: 1.378030, loss_ss: 1.019170, loss_d: 0.358860
0.3450 --- loss: 1.164669, loss_ss: 0.920758, loss_d: 0.243911
0.3833 --- loss: 1.268253, loss_ss: 0.990968, loss_d: 0.277285
0.4216 --- loss: 1.256261, loss_ss: 0.987214, loss_d: 0.269048
0.4599 --- loss: 1.630866, loss_ss: 1.058168, loss_d: 0.572697
0.4983 --- loss: 1.176045, loss_ss: 1.049366, loss_d: 0.126680
0.5366 --- loss: 1.515795, loss_ss: 1.025686, loss_d: 0.490109
0.5749 --- loss: 1.368564, loss_ss: 1.171164, loss_d: 0.197399
0.6133 --- loss: 1.376878, loss_ss: 1.185246, loss_d: 0.191632
0.6516 --- loss: 1.363826, loss_ss: 1.093608, loss_d: 0.270218
0.6899 --- loss: 1.421106, loss_ss: 1.244372, loss_d: 0.176734
0.7282 --- loss: 0.969202, loss_ss: 0.898903, loss_d: 0.070299
0.7666 --- loss: 1.416456, loss_ss: 1.112958, loss_d: 0.303498
0.8049 --- loss: 1.211915, loss_ss: 1.015921, loss_d: 0.195995
0.8432 --- loss: 1.476382, loss_ss: 1.255943, loss_d: 0.220439
0.8816 --- loss: 1.077135, loss_ss: 0.923134, loss_d: 0.154001
0.9199 --- loss: 1.338036, loss_ss: 0.986399, loss_d: 0.351637
0.9582 --- loss: 1.492852, loss_ss: 1.172637, loss_d: 0.320215
0.9966 --- loss: 1.121932, loss_ss: 1.066914, loss_d: 0.055018
Epoch finished! Loss: 1.355849103285716
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.013593, loss_ss: 0.840010, loss_d: 0.173583
0.0383 --- loss: 1.070193, loss_ss: 0.952178, loss_d: 0.118015
0.0767 --- loss: 1.038651, loss_ss: 0.825337, loss_d: 0.213314
0.1150 --- loss: 0.921798, loss_ss: 0.782180, loss_d: 0.139618
0.1533 --- loss: 1.644739, loss_ss: 1.315031, loss_d: 0.329708
0.1916 --- loss: 1.235584, loss_ss: 1.044806, loss_d: 0.190779
0.2300 --- loss: 1.367862, loss_ss: 1.089821, loss_d: 0.278041
0.2683 --- loss: 1.097361, loss_ss: 0.907630, loss_d: 0.189731
0.3066 --- loss: 1.150505, loss_ss: 0.908780, loss_d: 0.241725
0.3450 --- loss: 1.361248, loss_ss: 1.231043, loss_d: 0.130205
0.3833 --- loss: 1.077814, loss_ss: 0.948579, loss_d: 0.129235
0.4216 --- loss: 1.137677, loss_ss: 0.844925, loss_d: 0.292752
0.4599 --- loss: 1.190045, loss_ss: 1.022589, loss_d: 0.167456
0.4983 --- loss: 1.317361, loss_ss: 1.160024, loss_d: 0.157337
0.5366 --- loss: 1.111564, loss_ss: 0.898142, loss_d: 0.213422
0.5749 --- loss: 0.994618, loss_ss: 0.894803, loss_d: 0.099815
0.6133 --- loss: 1.104134, loss_ss: 0.937304, loss_d: 0.166830
0.6516 --- loss: 1.125054, loss_ss: 0.895533, loss_d: 0.229521
0.6899 --- loss: 0.985328, loss_ss: 0.727771, loss_d: 0.257557
0.7282 --- loss: 1.222438, loss_ss: 0.986448, loss_d: 0.235990
0.7666 --- loss: 1.366257, loss_ss: 1.185334, loss_d: 0.180923
0.8049 --- loss: 0.956459, loss_ss: 0.849263, loss_d: 0.107196
0.8432 --- loss: 1.174398, loss_ss: 0.959259, loss_d: 0.215139
0.8816 --- loss: 2.104808, loss_ss: 1.425877, loss_d: 0.678930
0.9199 --- loss: 0.933138, loss_ss: 0.828134, loss_d: 0.105004
0.9582 --- loss: 1.266344, loss_ss: 1.019671, loss_d: 0.246672
0.9966 --- loss: 1.282208, loss_ss: 1.223202, loss_d: 0.059006
Epoch finished! Loss: 1.250909716120133
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.017091, loss_ss: 0.905546, loss_d: 0.111545
0.0383 --- loss: 1.204585, loss_ss: 1.033572, loss_d: 0.171012
0.0767 --- loss: 1.084656, loss_ss: 1.028955, loss_d: 0.055701
0.1150 --- loss: 0.916074, loss_ss: 0.825948, loss_d: 0.090126
0.1533 --- loss: 1.315777, loss_ss: 1.081716, loss_d: 0.234061
0.1916 --- loss: 1.694367, loss_ss: 1.256021, loss_d: 0.438346
0.2300 --- loss: 1.521533, loss_ss: 1.199137, loss_d: 0.322397
0.2683 --- loss: 0.976967, loss_ss: 0.754870, loss_d: 0.222097
0.3066 --- loss: 1.144050, loss_ss: 0.858915, loss_d: 0.285134
0.3450 --- loss: 1.217683, loss_ss: 1.110874, loss_d: 0.106810
0.3833 --- loss: 0.855968, loss_ss: 0.789339, loss_d: 0.066628
0.4216 --- loss: 1.175366, loss_ss: 1.023207, loss_d: 0.152159
0.4599 --- loss: 2.383143, loss_ss: 0.802554, loss_d: 1.580590
0.4983 --- loss: 1.115611, loss_ss: 0.948286, loss_d: 0.167325
0.5366 --- loss: 1.138970, loss_ss: 0.879037, loss_d: 0.259932
0.5749 --- loss: 1.736201, loss_ss: 1.466390, loss_d: 0.269811
0.6133 --- loss: 0.944627, loss_ss: 0.779128, loss_d: 0.165498
0.6516 --- loss: 1.219083, loss_ss: 0.850121, loss_d: 0.368962
0.6899 --- loss: 0.934960, loss_ss: 0.663990, loss_d: 0.270969
0.7282 --- loss: 1.020927, loss_ss: 0.805888, loss_d: 0.215040
0.7666 --- loss: 1.256682, loss_ss: 1.026659, loss_d: 0.230023
0.8049 --- loss: 1.431337, loss_ss: 1.167370, loss_d: 0.263967
0.8432 --- loss: 1.705394, loss_ss: 0.989171, loss_d: 0.716223
0.8816 --- loss: 1.337401, loss_ss: 1.299112, loss_d: 0.038289
0.9199 --- loss: 1.169242, loss_ss: 1.010827, loss_d: 0.158415
0.9582 --- loss: 1.067720, loss_ss: 1.018478, loss_d: 0.049242
0.9966 --- loss: 1.785593, loss_ss: 1.231086, loss_d: 0.554507
Epoch finished! Loss: 1.189351698756218
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.420698, loss_ss: 0.993708, loss_d: 0.426990
0.0383 --- loss: 1.089048, loss_ss: 1.034173, loss_d: 0.054875
0.0767 --- loss: 1.096966, loss_ss: 0.817428, loss_d: 0.279538
0.1150 --- loss: 0.847550, loss_ss: 0.628187, loss_d: 0.219363
0.1533 --- loss: 0.880341, loss_ss: 0.768988, loss_d: 0.111353
0.1916 --- loss: 1.208442, loss_ss: 0.868883, loss_d: 0.339559
0.2300 --- loss: 1.203843, loss_ss: 0.978506, loss_d: 0.225337
0.2683 --- loss: 0.988227, loss_ss: 0.909189, loss_d: 0.079037
0.3066 --- loss: 1.397653, loss_ss: 0.825713, loss_d: 0.571940
0.3450 --- loss: 1.053431, loss_ss: 0.924024, loss_d: 0.129408
0.3833 --- loss: 0.904578, loss_ss: 0.663172, loss_d: 0.241406
0.4216 --- loss: 1.024147, loss_ss: 0.891548, loss_d: 0.132599
0.4599 --- loss: 1.333397, loss_ss: 0.846534, loss_d: 0.486864
0.4983 --- loss: 0.896817, loss_ss: 0.813842, loss_d: 0.082975
0.5366 --- loss: 0.999059, loss_ss: 0.903996, loss_d: 0.095063
0.5749 --- loss: 1.190534, loss_ss: 0.982090, loss_d: 0.208444
0.6133 --- loss: 1.088382, loss_ss: 0.893706, loss_d: 0.194675
0.6516 --- loss: 1.379544, loss_ss: 1.151327, loss_d: 0.228217
0.6899 --- loss: 1.168264, loss_ss: 0.879515, loss_d: 0.288749
0.7282 --- loss: 1.150087, loss_ss: 0.808305, loss_d: 0.341782
0.7666 --- loss: 1.041652, loss_ss: 0.932489, loss_d: 0.109162
0.8049 --- loss: 1.014543, loss_ss: 0.966604, loss_d: 0.047939
0.8432 --- loss: 1.136434, loss_ss: 0.881801, loss_d: 0.254632
0.8816 --- loss: 1.127679, loss_ss: 0.913954, loss_d: 0.213726
0.9199 --- loss: 1.428363, loss_ss: 0.847262, loss_d: 0.581102
0.9582 --- loss: 0.946866, loss_ss: 0.914073, loss_d: 0.032793
0.9966 --- loss: 1.009943, loss_ss: 0.928175, loss_d: 0.081768
Epoch finished! Loss: 1.153171030833171
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.318865, loss_ss: 0.964091, loss_d: 0.354774
0.0383 --- loss: 1.131223, loss_ss: 0.720064, loss_d: 0.411158
0.0767 --- loss: 1.260241, loss_ss: 0.986486, loss_d: 0.273755
0.1150 --- loss: 1.321189, loss_ss: 0.890417, loss_d: 0.430772
0.1533 --- loss: 1.361609, loss_ss: 1.133839, loss_d: 0.227769
0.1916 --- loss: 1.462600, loss_ss: 1.194175, loss_d: 0.268424
0.2300 --- loss: 0.977806, loss_ss: 0.890387, loss_d: 0.087419
0.2683 --- loss: 0.918899, loss_ss: 0.824084, loss_d: 0.094815
0.3066 --- loss: 1.016265, loss_ss: 0.982090, loss_d: 0.034175
0.3450 --- loss: 0.797528, loss_ss: 0.709084, loss_d: 0.088444
0.3833 --- loss: 1.129497, loss_ss: 1.078823, loss_d: 0.050674
0.4216 --- loss: 1.502580, loss_ss: 1.205921, loss_d: 0.296660
0.4599 --- loss: 1.148957, loss_ss: 1.097942, loss_d: 0.051015
0.4983 --- loss: 1.357693, loss_ss: 0.720998, loss_d: 0.636695
0.5366 --- loss: 1.137126, loss_ss: 1.026047, loss_d: 0.111079
0.5749 --- loss: 0.966329, loss_ss: 0.771318, loss_d: 0.195011
0.6133 --- loss: 1.623243, loss_ss: 0.905299, loss_d: 0.717944
0.6516 --- loss: 0.810580, loss_ss: 0.692118, loss_d: 0.118463
0.6899 --- loss: 1.083736, loss_ss: 1.019434, loss_d: 0.064302
0.7282 --- loss: 0.730451, loss_ss: 0.666371, loss_d: 0.064079
0.7666 --- loss: 0.957009, loss_ss: 0.777554, loss_d: 0.179455
0.8049 --- loss: 0.846087, loss_ss: 0.833601, loss_d: 0.012486
0.8432 --- loss: 1.342824, loss_ss: 0.833414, loss_d: 0.509410
0.8816 --- loss: 1.262734, loss_ss: 1.076316, loss_d: 0.186418
0.9199 --- loss: 0.812625, loss_ss: 0.741745, loss_d: 0.070880
0.9582 --- loss: 0.722503, loss_ss: 0.695108, loss_d: 0.027395
0.9966 --- loss: 0.765023, loss_ss: 0.691847, loss_d: 0.073176
Epoch finished! Loss: 1.0805882135262856
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.814237, loss_ss: 0.769057, loss_d: 0.045180
0.0383 --- loss: 1.238119, loss_ss: 1.084739, loss_d: 0.153380
0.0767 --- loss: 1.189108, loss_ss: 1.162440, loss_d: 0.026668
0.1150 --- loss: 1.209110, loss_ss: 0.626461, loss_d: 0.582649
0.1533 --- loss: 1.316715, loss_ss: 1.256353, loss_d: 0.060363
0.1916 --- loss: 1.129499, loss_ss: 0.994833, loss_d: 0.134666
0.2300 --- loss: 0.983896, loss_ss: 0.919772, loss_d: 0.064125
0.2683 --- loss: 1.009158, loss_ss: 0.775388, loss_d: 0.233771
0.3066 --- loss: 1.072104, loss_ss: 0.900944, loss_d: 0.171160
0.3450 --- loss: 1.439456, loss_ss: 1.164299, loss_d: 0.275157
0.3833 --- loss: 1.098798, loss_ss: 1.076936, loss_d: 0.021862
0.4216 --- loss: 1.242946, loss_ss: 1.135140, loss_d: 0.107806
0.4599 --- loss: 1.028327, loss_ss: 0.783720, loss_d: 0.244607
0.4983 --- loss: 1.211780, loss_ss: 1.193707, loss_d: 0.018072
0.5366 --- loss: 1.050050, loss_ss: 1.025847, loss_d: 0.024203
0.5749 --- loss: 0.869954, loss_ss: 0.811502, loss_d: 0.058451
0.6133 --- loss: 0.806813, loss_ss: 0.759272, loss_d: 0.047541
0.6516 --- loss: 1.126792, loss_ss: 0.811648, loss_d: 0.315143
0.6899 --- loss: 1.006841, loss_ss: 0.770078, loss_d: 0.236763
0.7282 --- loss: 0.842119, loss_ss: 0.784060, loss_d: 0.058059
0.7666 --- loss: 1.024641, loss_ss: 1.013126, loss_d: 0.011516
0.8049 --- loss: 0.849060, loss_ss: 0.755282, loss_d: 0.093779
0.8432 --- loss: 0.896690, loss_ss: 0.809553, loss_d: 0.087137
0.8816 --- loss: 0.859387, loss_ss: 0.818093, loss_d: 0.041294
0.9199 --- loss: 1.034378, loss_ss: 0.936111, loss_d: 0.098267
0.9582 --- loss: 1.268505, loss_ss: 1.143517, loss_d: 0.124988
0.9966 --- loss: 0.980674, loss_ss: 0.952495, loss_d: 0.028179
Epoch finished! Loss: 1.0360983419876832
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.013805, loss_ss: 0.939752, loss_d: 0.074053
0.0383 --- loss: 0.763644, loss_ss: 0.729838, loss_d: 0.033806
0.0767 --- loss: 1.101048, loss_ss: 1.042076, loss_d: 0.058972
0.1150 --- loss: 0.797607, loss_ss: 0.776510, loss_d: 0.021097
0.1533 --- loss: 0.771117, loss_ss: 0.740950, loss_d: 0.030168
0.1916 --- loss: 0.897020, loss_ss: 0.657587, loss_d: 0.239432
0.2300 --- loss: 1.209447, loss_ss: 1.115060, loss_d: 0.094386
0.2683 --- loss: 1.780081, loss_ss: 1.351768, loss_d: 0.428313
0.3066 --- loss: 1.164667, loss_ss: 0.528049, loss_d: 0.636618
0.3450 --- loss: 0.780210, loss_ss: 0.752059, loss_d: 0.028151
0.3833 --- loss: 0.777002, loss_ss: 0.723661, loss_d: 0.053340
0.4216 --- loss: 0.954601, loss_ss: 0.722743, loss_d: 0.231858
0.4599 --- loss: 1.191497, loss_ss: 1.161902, loss_d: 0.029595
0.4983 --- loss: 0.987010, loss_ss: 0.837000, loss_d: 0.150011
0.5366 --- loss: 0.983179, loss_ss: 0.977719, loss_d: 0.005461
0.5749 --- loss: 1.587837, loss_ss: 1.105619, loss_d: 0.482218
0.6133 --- loss: 1.031746, loss_ss: 0.851450, loss_d: 0.180296
0.6516 --- loss: 0.797630, loss_ss: 0.711216, loss_d: 0.086414
0.6899 --- loss: 1.264266, loss_ss: 0.915558, loss_d: 0.348708
0.7282 --- loss: 0.954972, loss_ss: 0.791533, loss_d: 0.163439
0.7666 --- loss: 0.947005, loss_ss: 0.745564, loss_d: 0.201441
0.8049 --- loss: 1.306859, loss_ss: 1.226700, loss_d: 0.080159
0.8432 --- loss: 1.127172, loss_ss: 0.885519, loss_d: 0.241654
0.8816 --- loss: 1.058267, loss_ss: 0.913921, loss_d: 0.144347
0.9199 --- loss: 1.071448, loss_ss: 0.906970, loss_d: 0.164478
0.9582 --- loss: 1.139036, loss_ss: 0.885324, loss_d: 0.253713
0.9966 --- loss: 2.758705, loss_ss: 0.792561, loss_d: 1.966144
Epoch finished! Loss: 1.0302313515773187
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.086857, loss_ss: 0.774859, loss_d: 0.311998
0.0383 --- loss: 0.752896, loss_ss: 0.719598, loss_d: 0.033297
0.0767 --- loss: 0.943560, loss_ss: 0.762590, loss_d: 0.180970
0.1150 --- loss: 1.006162, loss_ss: 0.824615, loss_d: 0.181547
0.1533 --- loss: 1.225775, loss_ss: 1.200276, loss_d: 0.025499
0.1916 --- loss: 0.622965, loss_ss: 0.572862, loss_d: 0.050103
0.2300 --- loss: 1.029925, loss_ss: 0.986711, loss_d: 0.043214
0.2683 --- loss: 0.771980, loss_ss: 0.751099, loss_d: 0.020881
0.3066 --- loss: 1.138822, loss_ss: 1.126860, loss_d: 0.011962
0.3450 --- loss: 0.839917, loss_ss: 0.711815, loss_d: 0.128102
0.3833 --- loss: 1.108841, loss_ss: 0.781138, loss_d: 0.327703
0.4216 --- loss: 0.847812, loss_ss: 0.798854, loss_d: 0.048958
0.4599 --- loss: 0.692923, loss_ss: 0.645104, loss_d: 0.047819
0.4983 --- loss: 0.842668, loss_ss: 0.791545, loss_d: 0.051123
0.5366 --- loss: 0.787758, loss_ss: 0.706339, loss_d: 0.081420
0.5749 --- loss: 1.227210, loss_ss: 1.179443, loss_d: 0.047767
0.6133 --- loss: 1.014910, loss_ss: 0.943843, loss_d: 0.071067
0.6516 --- loss: 0.845633, loss_ss: 0.772689, loss_d: 0.072944
0.6899 --- loss: 1.146718, loss_ss: 0.955668, loss_d: 0.191050
0.7282 --- loss: 0.843700, loss_ss: 0.801396, loss_d: 0.042304
0.7666 --- loss: 1.147269, loss_ss: 1.082941, loss_d: 0.064328
0.8049 --- loss: 0.784181, loss_ss: 0.678606, loss_d: 0.105575
0.8432 --- loss: 0.762571, loss_ss: 0.604576, loss_d: 0.157995
0.8816 --- loss: 0.853383, loss_ss: 0.839068, loss_d: 0.014315
0.9199 --- loss: 0.815806, loss_ss: 0.679862, loss_d: 0.135944
0.9582 --- loss: 1.418893, loss_ss: 1.272388, loss_d: 0.146505
0.9966 --- loss: 0.935728, loss_ss: 0.929579, loss_d: 0.006149
Epoch finished! Loss: 0.9841546058654785
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8517241379310345
             precision    recall  f1-score   support

        0.0       0.91      0.93      0.92        72
        1.0       0.43      0.41      0.42        46
        2.0       0.94      0.81      0.87       443
        3.0       0.91      0.93      0.92       196
        4.0       0.66      0.99      0.79       113

avg / total       0.87      0.85      0.85       870
 


====== chc009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.62  93.06   99.12  90.54     91.78
1  94.02  41.30   96.97  43.18     42.22
2  87.93  81.49   94.61  94.01     87.30
3  96.44  92.86   97.48  91.46     92.15
4  93.33  99.12   92.47  66.27     79.43
Total accuracy: 85.17%
Average sen: 81.56%
Average spec: 96.13%
Macro f1-score: 78.58%
Diagnosis acc on 15mins: 1.0
[6.83427788e-04 3.11806798e-03 5.94475656e-04 3.73875773e-05
 4.14923852e-05 4.29644861e-05 3.80148867e-06 9.03493710e-05
 1.79636030e-04 3.62463208e-04 1.11821013e-04 6.19090642e-05
 3.94838024e-03 1.53865636e-04 1.03668459e-02 5.54710103e-04
 1.18133263e-04 6.32682859e-05 2.52794835e-05 3.34655597e-05
 7.62494310e-05 5.71155339e-04 2.08143698e-04 9.10775561e-05
 3.15617101e-04 2.29935860e-03 1.14357863e-02 9.25151689e-04
 1.03114001e-01]
pred: 0.004814768469823948, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.201048, loss_ss: 1.524880, loss_d: 0.676168
0.0383 --- loss: 2.563868, loss_ss: 1.464755, loss_d: 1.099113
0.0766 --- loss: 2.213519, loss_ss: 1.581599, loss_d: 0.631920
0.1149 --- loss: 2.084085, loss_ss: 1.573968, loss_d: 0.510117
0.1533 --- loss: 1.934904, loss_ss: 1.481303, loss_d: 0.453601
0.1916 --- loss: 1.951666, loss_ss: 1.477050, loss_d: 0.474616
0.2299 --- loss: 2.185855, loss_ss: 1.503282, loss_d: 0.682573
0.2682 --- loss: 2.016118, loss_ss: 1.340974, loss_d: 0.675145
0.3065 --- loss: 1.793788, loss_ss: 1.347913, loss_d: 0.445875
0.3448 --- loss: 1.981816, loss_ss: 1.556852, loss_d: 0.424964
0.3831 --- loss: 2.102679, loss_ss: 1.415192, loss_d: 0.687487
0.4215 --- loss: 1.987523, loss_ss: 1.340191, loss_d: 0.647333
0.4598 --- loss: 2.066493, loss_ss: 1.319718, loss_d: 0.746775
0.4981 --- loss: 1.743991, loss_ss: 1.270492, loss_d: 0.473500
0.5364 --- loss: 1.604457, loss_ss: 1.249364, loss_d: 0.355094
0.5747 --- loss: 1.744379, loss_ss: 1.420173, loss_d: 0.324206
0.6130 --- loss: 1.888571, loss_ss: 1.284884, loss_d: 0.603687
0.6513 --- loss: 2.254995, loss_ss: 1.333672, loss_d: 0.921323
0.6897 --- loss: 1.799143, loss_ss: 1.398032, loss_d: 0.401111
0.7280 --- loss: 1.539563, loss_ss: 1.253962, loss_d: 0.285601
0.7663 --- loss: 1.628061, loss_ss: 1.122899, loss_d: 0.505162
0.8046 --- loss: 1.574482, loss_ss: 1.216689, loss_d: 0.357793
0.8429 --- loss: 1.722496, loss_ss: 1.039371, loss_d: 0.683125
0.8812 --- loss: 1.502240, loss_ss: 1.189934, loss_d: 0.312306
0.9195 --- loss: 1.674355, loss_ss: 1.209151, loss_d: 0.465203
0.9579 --- loss: 1.585202, loss_ss: 1.182417, loss_d: 0.402785
0.9962 --- loss: 1.502279, loss_ss: 1.303164, loss_d: 0.199114
Epoch finished! Loss: 1.893407826240246
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.473144, loss_ss: 1.163442, loss_d: 0.309702
0.0383 --- loss: 1.418506, loss_ss: 1.102443, loss_d: 0.316063
0.0766 --- loss: 2.128484, loss_ss: 1.233924, loss_d: 0.894560
0.1149 --- loss: 1.260765, loss_ss: 1.094445, loss_d: 0.166320
0.1533 --- loss: 1.445129, loss_ss: 1.037091, loss_d: 0.408038
0.1916 --- loss: 1.839923, loss_ss: 1.095964, loss_d: 0.743959
0.2299 --- loss: 1.363509, loss_ss: 1.168986, loss_d: 0.194523
0.2682 --- loss: 1.616991, loss_ss: 1.248073, loss_d: 0.368918
0.3065 --- loss: 1.354611, loss_ss: 0.994858, loss_d: 0.359753
0.3448 --- loss: 1.633613, loss_ss: 1.084152, loss_d: 0.549460
0.3831 --- loss: 1.330461, loss_ss: 1.250466, loss_d: 0.079995
0.4215 --- loss: 2.390327, loss_ss: 1.021025, loss_d: 1.369303
0.4598 --- loss: 1.645424, loss_ss: 1.159547, loss_d: 0.485877
0.4981 --- loss: 1.440579, loss_ss: 0.927449, loss_d: 0.513131
0.5364 --- loss: 1.204340, loss_ss: 0.973187, loss_d: 0.231153
0.5747 --- loss: 1.744248, loss_ss: 1.099249, loss_d: 0.644999
0.6130 --- loss: 1.579228, loss_ss: 1.103143, loss_d: 0.476085
0.6513 --- loss: 1.197863, loss_ss: 1.052802, loss_d: 0.145061
0.6897 --- loss: 1.435229, loss_ss: 1.246644, loss_d: 0.188584
0.7280 --- loss: 1.449507, loss_ss: 1.156589, loss_d: 0.292918
0.7663 --- loss: 1.186394, loss_ss: 0.956728, loss_d: 0.229666
0.8046 --- loss: 2.145669, loss_ss: 1.251244, loss_d: 0.894425
0.8429 --- loss: 1.000267, loss_ss: 0.920522, loss_d: 0.079745
0.8812 --- loss: 1.315208, loss_ss: 0.902160, loss_d: 0.413047
0.9195 --- loss: 1.665723, loss_ss: 1.062790, loss_d: 0.602934
0.9579 --- loss: 1.608221, loss_ss: 1.344445, loss_d: 0.263776
0.9962 --- loss: 1.473307, loss_ss: 1.296126, loss_d: 0.177182
Epoch finished! Loss: 1.4649813065162072
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.058664, loss_ss: 0.878766, loss_d: 0.179898
0.0383 --- loss: 1.401067, loss_ss: 1.109514, loss_d: 0.291553
0.0766 --- loss: 1.239391, loss_ss: 1.047760, loss_d: 0.191631
0.1149 --- loss: 1.124426, loss_ss: 1.012350, loss_d: 0.112076
0.1533 --- loss: 1.312855, loss_ss: 1.178313, loss_d: 0.134541
0.1916 --- loss: 1.502276, loss_ss: 1.141562, loss_d: 0.360715
0.2299 --- loss: 1.135484, loss_ss: 1.014635, loss_d: 0.120850
0.2682 --- loss: 1.356821, loss_ss: 1.074942, loss_d: 0.281880
0.3065 --- loss: 2.171777, loss_ss: 1.404097, loss_d: 0.767680
0.3448 --- loss: 1.239582, loss_ss: 1.145267, loss_d: 0.094316
0.3831 --- loss: 1.204390, loss_ss: 0.915094, loss_d: 0.289296
0.4215 --- loss: 1.096362, loss_ss: 0.926356, loss_d: 0.170006
0.4598 --- loss: 1.881522, loss_ss: 1.195567, loss_d: 0.685955
0.4981 --- loss: 1.352573, loss_ss: 0.956962, loss_d: 0.395612
0.5364 --- loss: 1.297801, loss_ss: 0.786212, loss_d: 0.511589
0.5747 --- loss: 1.282057, loss_ss: 1.042718, loss_d: 0.239339
0.6130 --- loss: 1.191918, loss_ss: 0.889113, loss_d: 0.302805
0.6513 --- loss: 1.221233, loss_ss: 0.971219, loss_d: 0.250014
0.6897 --- loss: 1.090371, loss_ss: 0.899891, loss_d: 0.190480
0.7280 --- loss: 1.356938, loss_ss: 1.251306, loss_d: 0.105632
0.7663 --- loss: 1.394292, loss_ss: 1.029165, loss_d: 0.365126
0.8046 --- loss: 1.242317, loss_ss: 1.095736, loss_d: 0.146581
0.8429 --- loss: 0.896808, loss_ss: 0.783738, loss_d: 0.113071
0.8812 --- loss: 1.050807, loss_ss: 0.763120, loss_d: 0.287687
0.9195 --- loss: 1.264388, loss_ss: 0.874253, loss_d: 0.390135
0.9579 --- loss: 1.003794, loss_ss: 0.909128, loss_d: 0.094666
0.9962 --- loss: 1.052914, loss_ss: 0.837392, loss_d: 0.215522
Epoch finished! Loss: 1.2775714117747086
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.683195, loss_ss: 0.904056, loss_d: 0.779139
0.0383 --- loss: 1.204174, loss_ss: 1.048696, loss_d: 0.155478
0.0766 --- loss: 1.058956, loss_ss: 0.850233, loss_d: 0.208723
0.1149 --- loss: 1.121511, loss_ss: 1.026766, loss_d: 0.094745
0.1533 --- loss: 0.919049, loss_ss: 0.800863, loss_d: 0.118187
0.1916 --- loss: 0.961433, loss_ss: 0.826290, loss_d: 0.135143
0.2299 --- loss: 1.092952, loss_ss: 0.857167, loss_d: 0.235786
0.2682 --- loss: 2.035675, loss_ss: 1.176333, loss_d: 0.859342
0.3065 --- loss: 1.124725, loss_ss: 0.995633, loss_d: 0.129092
0.3448 --- loss: 1.188950, loss_ss: 0.975935, loss_d: 0.213015
0.3831 --- loss: 1.163145, loss_ss: 1.115548, loss_d: 0.047597
0.4215 --- loss: 1.338670, loss_ss: 1.190836, loss_d: 0.147834
0.4598 --- loss: 1.200535, loss_ss: 1.001946, loss_d: 0.198589
0.4981 --- loss: 1.394794, loss_ss: 0.944014, loss_d: 0.450780
0.5364 --- loss: 1.023991, loss_ss: 0.899500, loss_d: 0.124491
0.5747 --- loss: 1.067451, loss_ss: 0.761391, loss_d: 0.306061
0.6130 --- loss: 1.106344, loss_ss: 0.825550, loss_d: 0.280795
0.6513 --- loss: 1.037989, loss_ss: 0.935971, loss_d: 0.102018
0.6897 --- loss: 1.120167, loss_ss: 0.922704, loss_d: 0.197463
0.7280 --- loss: 1.048371, loss_ss: 0.813395, loss_d: 0.234976
0.7663 --- loss: 1.207453, loss_ss: 0.921510, loss_d: 0.285943
0.8046 --- loss: 0.852366, loss_ss: 0.806119, loss_d: 0.046247
0.8429 --- loss: 0.846183, loss_ss: 0.734750, loss_d: 0.111433
0.8812 --- loss: 1.273532, loss_ss: 0.989904, loss_d: 0.283628
0.9195 --- loss: 1.033252, loss_ss: 0.967807, loss_d: 0.065445
0.9579 --- loss: 1.386601, loss_ss: 0.907108, loss_d: 0.479493
0.9962 --- loss: 1.130903, loss_ss: 1.034957, loss_d: 0.095946
Epoch finished! Loss: 1.1813883206019036
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.831052, loss_ss: 0.756220, loss_d: 0.074833
0.0383 --- loss: 1.558739, loss_ss: 1.260873, loss_d: 0.297866
0.0766 --- loss: 1.073058, loss_ss: 1.013092, loss_d: 0.059967
0.1149 --- loss: 1.194910, loss_ss: 1.017359, loss_d: 0.177551
0.1533 --- loss: 1.280792, loss_ss: 1.196880, loss_d: 0.083913
0.1916 --- loss: 0.809809, loss_ss: 0.758053, loss_d: 0.051756
0.2299 --- loss: 0.708391, loss_ss: 0.608852, loss_d: 0.099540
0.2682 --- loss: 1.451740, loss_ss: 1.366383, loss_d: 0.085356
0.3065 --- loss: 1.510786, loss_ss: 1.117201, loss_d: 0.393586
0.3448 --- loss: 0.891033, loss_ss: 0.833245, loss_d: 0.057788
0.3831 --- loss: 0.848436, loss_ss: 0.815382, loss_d: 0.033054
0.4215 --- loss: 0.838674, loss_ss: 0.689455, loss_d: 0.149219
0.4598 --- loss: 1.000850, loss_ss: 0.744817, loss_d: 0.256033
0.4981 --- loss: 1.321458, loss_ss: 0.958189, loss_d: 0.363269
0.5364 --- loss: 1.016573, loss_ss: 0.776256, loss_d: 0.240317
0.5747 --- loss: 1.634041, loss_ss: 1.145280, loss_d: 0.488761
0.6130 --- loss: 1.025809, loss_ss: 0.921314, loss_d: 0.104494
0.6513 --- loss: 1.355067, loss_ss: 0.929300, loss_d: 0.425767
0.6897 --- loss: 0.874424, loss_ss: 0.812343, loss_d: 0.062081
0.7280 --- loss: 1.142043, loss_ss: 0.924193, loss_d: 0.217850
0.7663 --- loss: 1.086659, loss_ss: 0.972729, loss_d: 0.113930
0.8046 --- loss: 0.681207, loss_ss: 0.661298, loss_d: 0.019909
0.8429 --- loss: 1.730538, loss_ss: 1.259140, loss_d: 0.471397
0.8812 --- loss: 1.269295, loss_ss: 1.079116, loss_d: 0.190179
0.9195 --- loss: 1.003348, loss_ss: 0.968287, loss_d: 0.035061
0.9579 --- loss: 0.857178, loss_ss: 0.769372, loss_d: 0.087806
0.9962 --- loss: 0.946339, loss_ss: 0.793251, loss_d: 0.153088
Epoch finished! Loss: 1.1038432765465516
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.396725, loss_ss: 0.868632, loss_d: 0.528093
0.0383 --- loss: 0.724616, loss_ss: 0.679790, loss_d: 0.044826
0.0766 --- loss: 1.271155, loss_ss: 1.214185, loss_d: 0.056971
0.1149 --- loss: 0.845896, loss_ss: 0.754431, loss_d: 0.091465
0.1533 --- loss: 0.839039, loss_ss: 0.817132, loss_d: 0.021908
0.1916 --- loss: 1.215797, loss_ss: 0.856665, loss_d: 0.359132
0.2299 --- loss: 0.908013, loss_ss: 0.721657, loss_d: 0.186356
0.2682 --- loss: 1.824606, loss_ss: 1.338902, loss_d: 0.485704
0.3065 --- loss: 1.075507, loss_ss: 0.994270, loss_d: 0.081237
0.3448 --- loss: 0.853700, loss_ss: 0.834369, loss_d: 0.019330
0.3831 --- loss: 0.946214, loss_ss: 0.857714, loss_d: 0.088500
0.4215 --- loss: 0.975051, loss_ss: 0.909301, loss_d: 0.065751
0.4598 --- loss: 1.127925, loss_ss: 0.999413, loss_d: 0.128512
0.4981 --- loss: 1.504172, loss_ss: 1.171060, loss_d: 0.333112
0.5364 --- loss: 0.847889, loss_ss: 0.753716, loss_d: 0.094174
0.5747 --- loss: 1.034903, loss_ss: 0.830759, loss_d: 0.204144
0.6130 --- loss: 1.242781, loss_ss: 0.995434, loss_d: 0.247347
0.6513 --- loss: 0.785885, loss_ss: 0.731934, loss_d: 0.053951
0.6897 --- loss: 1.236780, loss_ss: 1.089025, loss_d: 0.147754
0.7280 --- loss: 1.230195, loss_ss: 0.940270, loss_d: 0.289925
0.7663 --- loss: 1.118692, loss_ss: 1.069157, loss_d: 0.049535
0.8046 --- loss: 1.398510, loss_ss: 1.004811, loss_d: 0.393699
0.8429 --- loss: 1.407657, loss_ss: 0.979640, loss_d: 0.428016
0.8812 --- loss: 1.061146, loss_ss: 0.855234, loss_d: 0.205911
0.9195 --- loss: 1.077453, loss_ss: 0.856745, loss_d: 0.220708
0.9579 --- loss: 0.783543, loss_ss: 0.665595, loss_d: 0.117947
0.9962 --- loss: 1.071078, loss_ss: 0.790232, loss_d: 0.280846
Epoch finished! Loss: 1.0579836517572403
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.995760, loss_ss: 0.869582, loss_d: 0.126178
0.0383 --- loss: 0.842915, loss_ss: 0.795426, loss_d: 0.047488
0.0766 --- loss: 0.791540, loss_ss: 0.714281, loss_d: 0.077259
0.1149 --- loss: 0.990970, loss_ss: 0.671073, loss_d: 0.319897
0.1533 --- loss: 1.077157, loss_ss: 1.029840, loss_d: 0.047317
0.1916 --- loss: 0.700886, loss_ss: 0.675672, loss_d: 0.025214
0.2299 --- loss: 1.379128, loss_ss: 0.857191, loss_d: 0.521937
0.2682 --- loss: 0.765737, loss_ss: 0.734297, loss_d: 0.031439
0.3065 --- loss: 1.022054, loss_ss: 0.858813, loss_d: 0.163241
0.3448 --- loss: 0.873382, loss_ss: 0.812551, loss_d: 0.060831
0.3831 --- loss: 1.025811, loss_ss: 0.926228, loss_d: 0.099584
0.4215 --- loss: 1.149839, loss_ss: 0.964211, loss_d: 0.185628
0.4598 --- loss: 0.977779, loss_ss: 0.907316, loss_d: 0.070464
0.4981 --- loss: 0.891966, loss_ss: 0.581743, loss_d: 0.310223
0.5364 --- loss: 0.944148, loss_ss: 0.878519, loss_d: 0.065629
0.5747 --- loss: 0.887574, loss_ss: 0.796526, loss_d: 0.091048
0.6130 --- loss: 0.914249, loss_ss: 0.736706, loss_d: 0.177543
0.6513 --- loss: 1.458277, loss_ss: 0.674519, loss_d: 0.783757
0.6897 --- loss: 0.931721, loss_ss: 0.867144, loss_d: 0.064577
0.7280 --- loss: 1.237671, loss_ss: 0.645366, loss_d: 0.592305
0.7663 --- loss: 0.863446, loss_ss: 0.855716, loss_d: 0.007730
0.8046 --- loss: 1.090774, loss_ss: 0.909559, loss_d: 0.181215
0.8429 --- loss: 1.042047, loss_ss: 0.871989, loss_d: 0.170057
0.8812 --- loss: 1.015562, loss_ss: 0.984073, loss_d: 0.031489
0.9195 --- loss: 0.744422, loss_ss: 0.695616, loss_d: 0.048806
0.9579 --- loss: 0.923566, loss_ss: 0.907073, loss_d: 0.016493
0.9962 --- loss: 0.823339, loss_ss: 0.771946, loss_d: 0.051393
Epoch finished! Loss: 1.0099782226177363
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.846305, loss_ss: 0.604313, loss_d: 0.241993
0.0383 --- loss: 0.857377, loss_ss: 0.836552, loss_d: 0.020825
0.0766 --- loss: 1.185344, loss_ss: 1.169490, loss_d: 0.015854
0.1149 --- loss: 0.809581, loss_ss: 0.599771, loss_d: 0.209810
0.1533 --- loss: 1.182147, loss_ss: 1.168832, loss_d: 0.013315
0.1916 --- loss: 1.037381, loss_ss: 0.819730, loss_d: 0.217651
0.2299 --- loss: 0.861681, loss_ss: 0.847811, loss_d: 0.013870
0.2682 --- loss: 0.850865, loss_ss: 0.756684, loss_d: 0.094181
0.3065 --- loss: 1.044583, loss_ss: 1.029396, loss_d: 0.015188
0.3448 --- loss: 0.817673, loss_ss: 0.748998, loss_d: 0.068675
0.3831 --- loss: 0.963766, loss_ss: 0.752640, loss_d: 0.211126
0.4215 --- loss: 0.906207, loss_ss: 0.858795, loss_d: 0.047412
0.4598 --- loss: 0.944592, loss_ss: 0.915451, loss_d: 0.029141
0.4981 --- loss: 0.803254, loss_ss: 0.730966, loss_d: 0.072287
0.5364 --- loss: 1.132150, loss_ss: 1.058296, loss_d: 0.073854
0.5747 --- loss: 0.916798, loss_ss: 0.904871, loss_d: 0.011927
0.6130 --- loss: 0.941493, loss_ss: 0.634539, loss_d: 0.306954
0.6513 --- loss: 0.816486, loss_ss: 0.763105, loss_d: 0.053381
0.6897 --- loss: 0.936994, loss_ss: 0.908913, loss_d: 0.028080
0.7280 --- loss: 1.447677, loss_ss: 1.069930, loss_d: 0.377747
0.7663 --- loss: 0.605402, loss_ss: 0.588951, loss_d: 0.016451
0.8046 --- loss: 0.796726, loss_ss: 0.725382, loss_d: 0.071344
0.8429 --- loss: 1.090452, loss_ss: 1.043653, loss_d: 0.046799
0.8812 --- loss: 1.106626, loss_ss: 0.710182, loss_d: 0.396444
0.9195 --- loss: 1.023911, loss_ss: 0.840138, loss_d: 0.183773
0.9579 --- loss: 0.719890, loss_ss: 0.691334, loss_d: 0.028556
0.9962 --- loss: 0.666084, loss_ss: 0.616812, loss_d: 0.049272
Epoch finished! Loss: 1.0010362356901168
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.851793, loss_ss: 0.771201, loss_d: 0.080592
0.0383 --- loss: 0.927253, loss_ss: 0.909990, loss_d: 0.017263
0.0766 --- loss: 1.055826, loss_ss: 0.828192, loss_d: 0.227634
0.1149 --- loss: 0.805099, loss_ss: 0.782996, loss_d: 0.022104
0.1533 --- loss: 0.869772, loss_ss: 0.760141, loss_d: 0.109630
0.1916 --- loss: 0.857579, loss_ss: 0.838658, loss_d: 0.018921
0.2299 --- loss: 0.706840, loss_ss: 0.683114, loss_d: 0.023727
0.2682 --- loss: 0.931540, loss_ss: 0.904043, loss_d: 0.027497
0.3065 --- loss: 1.086088, loss_ss: 1.065096, loss_d: 0.020992
0.3448 --- loss: 0.794990, loss_ss: 0.776109, loss_d: 0.018881
0.3831 --- loss: 0.810804, loss_ss: 0.801505, loss_d: 0.009299
0.4215 --- loss: 1.868428, loss_ss: 0.747601, loss_d: 1.120826
0.4598 --- loss: 1.186333, loss_ss: 1.173294, loss_d: 0.013039
0.4981 --- loss: 0.720917, loss_ss: 0.717738, loss_d: 0.003179
0.5364 --- loss: 1.642180, loss_ss: 0.955339, loss_d: 0.686840
0.5747 --- loss: 0.862061, loss_ss: 0.776242, loss_d: 0.085819
0.6130 --- loss: 0.860185, loss_ss: 0.827997, loss_d: 0.032188
0.6513 --- loss: 0.787940, loss_ss: 0.782095, loss_d: 0.005845
0.6897 --- loss: 0.704813, loss_ss: 0.675559, loss_d: 0.029254
0.7280 --- loss: 1.159690, loss_ss: 0.965023, loss_d: 0.194667
0.7663 --- loss: 0.730537, loss_ss: 0.660699, loss_d: 0.069838
0.8046 --- loss: 1.128201, loss_ss: 0.918992, loss_d: 0.209208
0.8429 --- loss: 0.732850, loss_ss: 0.692701, loss_d: 0.040149
0.8812 --- loss: 0.779563, loss_ss: 0.753150, loss_d: 0.026412
0.9195 --- loss: 0.854152, loss_ss: 0.848939, loss_d: 0.005213
0.9579 --- loss: 1.051639, loss_ss: 0.918263, loss_d: 0.133377
0.9962 --- loss: 0.672984, loss_ss: 0.665734, loss_d: 0.007250
Epoch finished! Loss: 0.931825933777369
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.239741, loss_ss: 1.165997, loss_d: 0.073744
0.0383 --- loss: 1.482616, loss_ss: 1.468259, loss_d: 0.014357
0.0766 --- loss: 0.743629, loss_ss: 0.722739, loss_d: 0.020890
0.1149 --- loss: 1.068162, loss_ss: 0.990545, loss_d: 0.077616
0.1533 --- loss: 0.723428, loss_ss: 0.646843, loss_d: 0.076586
0.1916 --- loss: 1.502844, loss_ss: 1.299439, loss_d: 0.203405
0.2299 --- loss: 0.926770, loss_ss: 0.861527, loss_d: 0.065243
0.2682 --- loss: 0.861959, loss_ss: 0.680135, loss_d: 0.181824
0.3065 --- loss: 1.052807, loss_ss: 0.935232, loss_d: 0.117574
0.3448 --- loss: 0.969536, loss_ss: 0.938522, loss_d: 0.031015
0.3831 --- loss: 0.682158, loss_ss: 0.677059, loss_d: 0.005099
0.4215 --- loss: 0.818319, loss_ss: 0.776551, loss_d: 0.041769
0.4598 --- loss: 0.930638, loss_ss: 0.664146, loss_d: 0.266492
0.4981 --- loss: 1.012667, loss_ss: 0.936997, loss_d: 0.075670
0.5364 --- loss: 0.976131, loss_ss: 0.837667, loss_d: 0.138465
0.5747 --- loss: 0.822965, loss_ss: 0.798548, loss_d: 0.024417
0.6130 --- loss: 0.761366, loss_ss: 0.710518, loss_d: 0.050848
0.6513 --- loss: 0.710483, loss_ss: 0.695651, loss_d: 0.014832
0.6897 --- loss: 0.972893, loss_ss: 0.793122, loss_d: 0.179771
0.7280 --- loss: 0.668522, loss_ss: 0.609290, loss_d: 0.059232
0.7663 --- loss: 0.733857, loss_ss: 0.718927, loss_d: 0.014930
0.8046 --- loss: 1.828210, loss_ss: 0.520431, loss_d: 1.307780
0.8429 --- loss: 1.087965, loss_ss: 0.942062, loss_d: 0.145903
0.8812 --- loss: 0.821961, loss_ss: 0.729565, loss_d: 0.092396
0.9195 --- loss: 1.024193, loss_ss: 0.928536, loss_d: 0.095657
0.9579 --- loss: 0.690659, loss_ss: 0.630220, loss_d: 0.060439
0.9962 --- loss: 1.415357, loss_ss: 1.371825, loss_d: 0.043532
Epoch finished! Loss: 0.9677845122722479
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7345238095238096
             precision    recall  f1-score   support

        0.0       0.87      0.93      0.90       123
        1.0       0.47      0.16      0.24        43
        2.0       0.67      0.99      0.80       400
        3.0       1.00      0.19      0.32       193
        4.0       0.95      0.75      0.84        81

avg / total       0.79      0.73      0.68       840
 


====== chc010-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.90  92.68   97.63   87.02     89.76
1  94.76  16.28   99.00   46.67     24.14
2  76.55  99.50   55.68   67.12     80.16
3  81.43  19.17  100.00  100.00     32.17
4  97.26  75.31   99.60   95.31     84.14
Total accuracy: 73.45%
Average sen: 60.59%
Average spec: 90.38%
Macro f1-score: 62.07%
Diagnosis acc on 15mins: 0.5714285714285714
[0.02465238 0.2511842  0.48033923 0.01526946 0.60820204 0.0391124
 0.01637322 0.4299008  0.56970334 0.04854602 0.35945472 0.34227374
 0.88209856 0.8438527  0.3604506  0.32764196 0.6986984  0.90458983
 0.07195435 0.86006606 0.88493389 0.38531303 0.73737234 0.53242183
 0.34514084 0.79674685 0.26647773 0.59084058]
pred: 0.45262896711938083, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.478963, loss_ss: 1.793414, loss_d: 0.685548
0.0383 --- loss: 2.198798, loss_ss: 1.716852, loss_d: 0.481946
0.0767 --- loss: 1.786874, loss_ss: 1.590675, loss_d: 0.196199
0.1150 --- loss: 1.901319, loss_ss: 1.597945, loss_d: 0.303374
0.1534 --- loss: 1.901615, loss_ss: 1.357141, loss_d: 0.544474
0.1917 --- loss: 1.804556, loss_ss: 1.335935, loss_d: 0.468621
0.2301 --- loss: 1.957377, loss_ss: 1.381587, loss_d: 0.575790
0.2684 --- loss: 2.076481, loss_ss: 1.580159, loss_d: 0.496322
0.3067 --- loss: 1.889449, loss_ss: 1.294740, loss_d: 0.594710
0.3451 --- loss: 1.946864, loss_ss: 1.472646, loss_d: 0.474218
0.3834 --- loss: 1.890395, loss_ss: 1.566128, loss_d: 0.324266
0.4218 --- loss: 1.800661, loss_ss: 1.410094, loss_d: 0.390567
0.4601 --- loss: 2.059985, loss_ss: 1.392875, loss_d: 0.667109
0.4985 --- loss: 2.186950, loss_ss: 1.177443, loss_d: 1.009507
0.5368 --- loss: 1.846128, loss_ss: 1.400489, loss_d: 0.445640
0.5752 --- loss: 2.657372, loss_ss: 1.470919, loss_d: 1.186453
0.6135 --- loss: 2.162864, loss_ss: 1.340689, loss_d: 0.822175
0.6518 --- loss: 1.949295, loss_ss: 1.431132, loss_d: 0.518162
0.6902 --- loss: 1.726885, loss_ss: 1.245617, loss_d: 0.481268
0.7285 --- loss: 1.595697, loss_ss: 1.206087, loss_d: 0.389610
0.7669 --- loss: 2.219688, loss_ss: 1.536430, loss_d: 0.683259
0.8052 --- loss: 2.014165, loss_ss: 1.223136, loss_d: 0.791029
0.8436 --- loss: 1.767527, loss_ss: 1.318190, loss_d: 0.449338
0.8819 --- loss: 1.439629, loss_ss: 1.203764, loss_d: 0.235865
0.9202 --- loss: 1.874246, loss_ss: 1.174857, loss_d: 0.699389
0.9586 --- loss: 1.905732, loss_ss: 1.255497, loss_d: 0.650235
0.9969 --- loss: 2.079018, loss_ss: 1.297730, loss_d: 0.781288
Epoch finished! Loss: 1.8907369123055384
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.628515, loss_ss: 1.271278, loss_d: 0.357236
0.0383 --- loss: 1.870419, loss_ss: 1.248755, loss_d: 0.621664
0.0767 --- loss: 1.464542, loss_ss: 1.160148, loss_d: 0.304394
0.1150 --- loss: 1.689080, loss_ss: 1.485613, loss_d: 0.203467
0.1534 --- loss: 1.952153, loss_ss: 1.543704, loss_d: 0.408448
0.1917 --- loss: 1.339540, loss_ss: 1.105162, loss_d: 0.234378
0.2301 --- loss: 1.925145, loss_ss: 1.535739, loss_d: 0.389406
0.2684 --- loss: 1.311386, loss_ss: 1.109661, loss_d: 0.201726
0.3067 --- loss: 1.722095, loss_ss: 1.337038, loss_d: 0.385057
0.3451 --- loss: 1.449493, loss_ss: 1.321471, loss_d: 0.128021
0.3834 --- loss: 1.230253, loss_ss: 1.029034, loss_d: 0.201219
0.4218 --- loss: 1.411383, loss_ss: 1.263707, loss_d: 0.147676
0.4601 --- loss: 1.167629, loss_ss: 0.961430, loss_d: 0.206199
0.4985 --- loss: 1.786269, loss_ss: 1.320539, loss_d: 0.465730
0.5368 --- loss: 1.387718, loss_ss: 1.076239, loss_d: 0.311479
0.5752 --- loss: 1.771512, loss_ss: 1.220349, loss_d: 0.551163
0.6135 --- loss: 1.412768, loss_ss: 0.927146, loss_d: 0.485622
0.6518 --- loss: 1.140661, loss_ss: 0.923914, loss_d: 0.216747
0.6902 --- loss: 1.813003, loss_ss: 1.565844, loss_d: 0.247159
0.7285 --- loss: 1.070599, loss_ss: 0.963915, loss_d: 0.106684
0.7669 --- loss: 1.471528, loss_ss: 1.034287, loss_d: 0.437241
0.8052 --- loss: 1.894359, loss_ss: 1.216257, loss_d: 0.678102
0.8436 --- loss: 1.728904, loss_ss: 1.114792, loss_d: 0.614111
0.8819 --- loss: 1.436345, loss_ss: 1.113088, loss_d: 0.323257
0.9202 --- loss: 1.303420, loss_ss: 1.131225, loss_d: 0.172195
0.9586 --- loss: 1.227864, loss_ss: 0.860623, loss_d: 0.367241
0.9969 --- loss: 1.293577, loss_ss: 1.040183, loss_d: 0.253393
Epoch finished! Loss: 1.5481339881053338
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.230068, loss_ss: 1.074712, loss_d: 0.155356
0.0383 --- loss: 1.364602, loss_ss: 1.028060, loss_d: 0.336541
0.0767 --- loss: 1.038329, loss_ss: 0.982270, loss_d: 0.056058
0.1150 --- loss: 1.276149, loss_ss: 1.153424, loss_d: 0.122725
0.1534 --- loss: 1.646932, loss_ss: 1.240937, loss_d: 0.405994
0.1917 --- loss: 1.271098, loss_ss: 1.072956, loss_d: 0.198142
0.2301 --- loss: 1.081940, loss_ss: 0.912450, loss_d: 0.169490
0.2684 --- loss: 1.632009, loss_ss: 1.382482, loss_d: 0.249527
0.3067 --- loss: 1.495881, loss_ss: 1.261820, loss_d: 0.234061
0.3451 --- loss: 1.508053, loss_ss: 1.025769, loss_d: 0.482284
0.3834 --- loss: 1.492442, loss_ss: 1.330513, loss_d: 0.161929
0.4218 --- loss: 1.189661, loss_ss: 1.104569, loss_d: 0.085092
0.4601 --- loss: 1.359557, loss_ss: 1.252461, loss_d: 0.107096
0.4985 --- loss: 1.340182, loss_ss: 1.167607, loss_d: 0.172574
0.5368 --- loss: 1.608106, loss_ss: 1.546294, loss_d: 0.061812
0.5752 --- loss: 1.353458, loss_ss: 0.945506, loss_d: 0.407952
0.6135 --- loss: 1.124722, loss_ss: 1.009875, loss_d: 0.114848
0.6518 --- loss: 1.307905, loss_ss: 1.268399, loss_d: 0.039506
0.6902 --- loss: 1.923978, loss_ss: 1.105305, loss_d: 0.818673
0.7285 --- loss: 1.518470, loss_ss: 1.007029, loss_d: 0.511441
0.7669 --- loss: 1.103288, loss_ss: 0.869858, loss_d: 0.233430
0.8052 --- loss: 1.297267, loss_ss: 1.125855, loss_d: 0.171412
0.8436 --- loss: 1.102513, loss_ss: 1.002760, loss_d: 0.099752
0.8819 --- loss: 1.315465, loss_ss: 1.094238, loss_d: 0.221227
0.9202 --- loss: 1.203602, loss_ss: 1.010178, loss_d: 0.193424
0.9586 --- loss: 1.241888, loss_ss: 1.088042, loss_d: 0.153846
0.9969 --- loss: 1.248682, loss_ss: 1.164652, loss_d: 0.084031
Epoch finished! Loss: 1.4021561938982743
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.309162, loss_ss: 1.057571, loss_d: 0.251590
0.0383 --- loss: 1.048080, loss_ss: 0.912964, loss_d: 0.135116
0.0767 --- loss: 1.404720, loss_ss: 1.136055, loss_d: 0.268665
0.1150 --- loss: 1.017129, loss_ss: 0.889257, loss_d: 0.127872
0.1534 --- loss: 0.950163, loss_ss: 0.842650, loss_d: 0.107513
0.1917 --- loss: 1.552431, loss_ss: 1.329705, loss_d: 0.222725
0.2301 --- loss: 1.258531, loss_ss: 0.928251, loss_d: 0.330280
0.2684 --- loss: 1.066599, loss_ss: 0.983164, loss_d: 0.083434
0.3067 --- loss: 1.217978, loss_ss: 0.901793, loss_d: 0.316185
0.3451 --- loss: 1.269718, loss_ss: 1.168033, loss_d: 0.101686
0.3834 --- loss: 1.224226, loss_ss: 1.178720, loss_d: 0.045506
0.4218 --- loss: 1.138461, loss_ss: 1.011268, loss_d: 0.127193
0.4601 --- loss: 1.249086, loss_ss: 1.114561, loss_d: 0.134525
0.4985 --- loss: 1.256083, loss_ss: 0.919462, loss_d: 0.336621
0.5368 --- loss: 1.078198, loss_ss: 0.967395, loss_d: 0.110802
0.5752 --- loss: 1.206249, loss_ss: 0.907740, loss_d: 0.298509
0.6135 --- loss: 1.203919, loss_ss: 1.048450, loss_d: 0.155468
0.6518 --- loss: 1.160521, loss_ss: 1.068395, loss_d: 0.092126
0.6902 --- loss: 1.329056, loss_ss: 1.031009, loss_d: 0.298047
0.7285 --- loss: 1.144049, loss_ss: 1.060475, loss_d: 0.083574
0.7669 --- loss: 1.600174, loss_ss: 1.115357, loss_d: 0.484817
0.8052 --- loss: 1.778646, loss_ss: 1.429250, loss_d: 0.349395
0.8436 --- loss: 1.093058, loss_ss: 1.011945, loss_d: 0.081112
0.8819 --- loss: 0.945620, loss_ss: 0.869112, loss_d: 0.076507
0.9202 --- loss: 1.354523, loss_ss: 0.955443, loss_d: 0.399080
0.9586 --- loss: 1.213959, loss_ss: 1.157767, loss_d: 0.056192
0.9969 --- loss: 0.992665, loss_ss: 0.909274, loss_d: 0.083392
Epoch finished! Loss: 1.3228997111320495
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.271677, loss_ss: 0.976147, loss_d: 0.295531
0.0383 --- loss: 0.938659, loss_ss: 0.881591, loss_d: 0.057068
0.0767 --- loss: 1.220668, loss_ss: 0.916150, loss_d: 0.304518
0.1150 --- loss: 0.964005, loss_ss: 0.933574, loss_d: 0.030431
0.1534 --- loss: 0.915883, loss_ss: 0.840005, loss_d: 0.075878
0.1917 --- loss: 1.532714, loss_ss: 0.904497, loss_d: 0.628217
0.2301 --- loss: 0.943324, loss_ss: 0.864688, loss_d: 0.078636
0.2684 --- loss: 1.153842, loss_ss: 1.044869, loss_d: 0.108973
0.3067 --- loss: 1.121886, loss_ss: 0.758308, loss_d: 0.363579
0.3451 --- loss: 1.619087, loss_ss: 1.570988, loss_d: 0.048099
0.3834 --- loss: 1.709271, loss_ss: 1.130965, loss_d: 0.578307
0.4218 --- loss: 1.337677, loss_ss: 1.234203, loss_d: 0.103473
0.4601 --- loss: 1.021307, loss_ss: 0.874908, loss_d: 0.146398
0.4985 --- loss: 1.339620, loss_ss: 1.230194, loss_d: 0.109426
0.5368 --- loss: 0.922092, loss_ss: 0.846158, loss_d: 0.075934
0.5752 --- loss: 1.054431, loss_ss: 0.910317, loss_d: 0.144114
0.6135 --- loss: 1.066418, loss_ss: 0.907775, loss_d: 0.158643
0.6518 --- loss: 1.454654, loss_ss: 0.884751, loss_d: 0.569903
0.6902 --- loss: 1.636375, loss_ss: 1.476996, loss_d: 0.159379
0.7285 --- loss: 0.995275, loss_ss: 0.932340, loss_d: 0.062934
0.7669 --- loss: 1.117420, loss_ss: 0.839112, loss_d: 0.278307
0.8052 --- loss: 1.673653, loss_ss: 1.292039, loss_d: 0.381614
0.8436 --- loss: 1.084008, loss_ss: 1.070736, loss_d: 0.013273
0.8819 --- loss: 1.082921, loss_ss: 1.060793, loss_d: 0.022128
0.9202 --- loss: 1.372111, loss_ss: 1.294546, loss_d: 0.077565
0.9586 --- loss: 1.264209, loss_ss: 1.033465, loss_d: 0.230744
0.9969 --- loss: 1.078983, loss_ss: 1.000147, loss_d: 0.078835
Epoch finished! Loss: 1.2585295603825495
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.651518, loss_ss: 1.626102, loss_d: 0.025416
0.0383 --- loss: 1.213612, loss_ss: 1.170044, loss_d: 0.043568
0.0767 --- loss: 0.937310, loss_ss: 0.890728, loss_d: 0.046582
0.1150 --- loss: 1.052243, loss_ss: 1.000667, loss_d: 0.051576
0.1534 --- loss: 1.453801, loss_ss: 1.077962, loss_d: 0.375839
0.1917 --- loss: 1.260417, loss_ss: 1.203884, loss_d: 0.056533
0.2301 --- loss: 0.874109, loss_ss: 0.856817, loss_d: 0.017292
0.2684 --- loss: 1.092990, loss_ss: 0.851140, loss_d: 0.241850
0.3067 --- loss: 1.318200, loss_ss: 1.157958, loss_d: 0.160243
0.3451 --- loss: 0.917484, loss_ss: 0.825965, loss_d: 0.091519
0.3834 --- loss: 1.177852, loss_ss: 1.010422, loss_d: 0.167430
0.4218 --- loss: 1.240384, loss_ss: 0.768478, loss_d: 0.471906
0.4601 --- loss: 1.058963, loss_ss: 0.930940, loss_d: 0.128023
0.4985 --- loss: 1.308495, loss_ss: 1.104659, loss_d: 0.203836
0.5368 --- loss: 1.009250, loss_ss: 0.955363, loss_d: 0.053887
0.5752 --- loss: 2.484407, loss_ss: 1.014030, loss_d: 1.470378
0.6135 --- loss: 0.832618, loss_ss: 0.762781, loss_d: 0.069837
0.6518 --- loss: 1.069488, loss_ss: 0.846668, loss_d: 0.222820
0.6902 --- loss: 1.137466, loss_ss: 1.050874, loss_d: 0.086592
0.7285 --- loss: 1.337562, loss_ss: 1.160970, loss_d: 0.176592
0.7669 --- loss: 1.012053, loss_ss: 0.975430, loss_d: 0.036622
0.8052 --- loss: 1.104211, loss_ss: 1.018589, loss_d: 0.085622
0.8436 --- loss: 1.046345, loss_ss: 0.912195, loss_d: 0.134150
0.8819 --- loss: 1.209979, loss_ss: 1.083392, loss_d: 0.126587
0.9202 --- loss: 1.095939, loss_ss: 0.835790, loss_d: 0.260148
0.9586 --- loss: 1.060431, loss_ss: 1.037017, loss_d: 0.023414
0.9969 --- loss: 1.535178, loss_ss: 1.367762, loss_d: 0.167416
Epoch finished! Loss: 1.1850956625663318
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.955264, loss_ss: 0.892384, loss_d: 0.062880
0.0383 --- loss: 1.301298, loss_ss: 1.080845, loss_d: 0.220453
0.0767 --- loss: 0.991523, loss_ss: 0.884087, loss_d: 0.107436
0.1150 --- loss: 1.024614, loss_ss: 0.883906, loss_d: 0.140709
0.1534 --- loss: 1.033663, loss_ss: 0.867760, loss_d: 0.165902
0.1917 --- loss: 1.064514, loss_ss: 0.891965, loss_d: 0.172549
0.2301 --- loss: 0.985429, loss_ss: 0.787110, loss_d: 0.198319
0.2684 --- loss: 0.964709, loss_ss: 0.850384, loss_d: 0.114325
0.3067 --- loss: 0.892998, loss_ss: 0.816018, loss_d: 0.076980
0.3451 --- loss: 1.210031, loss_ss: 1.117761, loss_d: 0.092270
0.3834 --- loss: 1.048813, loss_ss: 1.040643, loss_d: 0.008170
0.4218 --- loss: 1.047836, loss_ss: 0.959932, loss_d: 0.087903
0.4601 --- loss: 1.380909, loss_ss: 1.136268, loss_d: 0.244641
0.4985 --- loss: 1.008691, loss_ss: 0.972433, loss_d: 0.036258
0.5368 --- loss: 0.887225, loss_ss: 0.854490, loss_d: 0.032735
0.5752 --- loss: 1.377342, loss_ss: 1.105080, loss_d: 0.272261
0.6135 --- loss: 1.864900, loss_ss: 1.727802, loss_d: 0.137098
0.6518 --- loss: 1.335348, loss_ss: 1.206422, loss_d: 0.128926
0.6902 --- loss: 1.146087, loss_ss: 0.912810, loss_d: 0.233277
0.7285 --- loss: 1.176104, loss_ss: 1.034193, loss_d: 0.141911
0.7669 --- loss: 1.211886, loss_ss: 0.747433, loss_d: 0.464453
0.8052 --- loss: 1.025797, loss_ss: 0.879273, loss_d: 0.146523
0.8436 --- loss: 1.356673, loss_ss: 1.262665, loss_d: 0.094008
0.8819 --- loss: 0.977344, loss_ss: 0.880570, loss_d: 0.096774
0.9202 --- loss: 1.341611, loss_ss: 0.823989, loss_d: 0.517623
0.9586 --- loss: 1.161856, loss_ss: 1.106313, loss_d: 0.055543
0.9969 --- loss: 1.467226, loss_ss: 1.219936, loss_d: 0.247290
Epoch finished! Loss: 1.1314073321911005
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.176564, loss_ss: 1.120179, loss_d: 0.056386
0.0383 --- loss: 1.541725, loss_ss: 0.827382, loss_d: 0.714344
0.0767 --- loss: 0.965648, loss_ss: 0.950782, loss_d: 0.014866
0.1150 --- loss: 0.816820, loss_ss: 0.800313, loss_d: 0.016507
0.1534 --- loss: 1.073607, loss_ss: 1.031497, loss_d: 0.042111
0.1917 --- loss: 1.160235, loss_ss: 1.031420, loss_d: 0.128815
0.2301 --- loss: 0.958933, loss_ss: 0.811968, loss_d: 0.146965
0.2684 --- loss: 0.913769, loss_ss: 0.862860, loss_d: 0.050909
0.3067 --- loss: 0.864246, loss_ss: 0.739669, loss_d: 0.124576
0.3451 --- loss: 1.344396, loss_ss: 1.147505, loss_d: 0.196891
0.3834 --- loss: 1.158130, loss_ss: 1.133207, loss_d: 0.024923
0.4218 --- loss: 1.158419, loss_ss: 0.978391, loss_d: 0.180028
0.4601 --- loss: 1.460074, loss_ss: 0.841787, loss_d: 0.618287
0.4985 --- loss: 1.381328, loss_ss: 1.258187, loss_d: 0.123141
0.5368 --- loss: 0.753224, loss_ss: 0.669110, loss_d: 0.084114
0.5752 --- loss: 0.971577, loss_ss: 0.944690, loss_d: 0.026888
0.6135 --- loss: 0.744905, loss_ss: 0.734021, loss_d: 0.010884
0.6518 --- loss: 1.235286, loss_ss: 1.055272, loss_d: 0.180014
0.6902 --- loss: 0.847353, loss_ss: 0.830585, loss_d: 0.016768
0.7285 --- loss: 0.728388, loss_ss: 0.711558, loss_d: 0.016830
0.7669 --- loss: 1.090553, loss_ss: 0.926884, loss_d: 0.163669
0.8052 --- loss: 0.983675, loss_ss: 0.927636, loss_d: 0.056038
0.8436 --- loss: 0.918559, loss_ss: 0.760810, loss_d: 0.157749
0.8819 --- loss: 0.666859, loss_ss: 0.645708, loss_d: 0.021151
0.9202 --- loss: 1.064829, loss_ss: 0.896247, loss_d: 0.168583
0.9586 --- loss: 0.906170, loss_ss: 0.837097, loss_d: 0.069073
0.9969 --- loss: 1.391023, loss_ss: 1.349107, loss_d: 0.041915
Epoch finished! Loss: 1.0611249421651547
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.942587, loss_ss: 0.806761, loss_d: 0.135826
0.0383 --- loss: 1.000352, loss_ss: 0.952562, loss_d: 0.047790
0.0767 --- loss: 1.234903, loss_ss: 1.134016, loss_d: 0.100887
0.1150 --- loss: 0.799568, loss_ss: 0.788963, loss_d: 0.010605
0.1534 --- loss: 1.178421, loss_ss: 0.903210, loss_d: 0.275212
0.1917 --- loss: 0.890822, loss_ss: 0.876794, loss_d: 0.014029
0.2301 --- loss: 0.847943, loss_ss: 0.696353, loss_d: 0.151589
0.2684 --- loss: 0.709051, loss_ss: 0.693463, loss_d: 0.015588
0.3067 --- loss: 0.743754, loss_ss: 0.734669, loss_d: 0.009084
0.3451 --- loss: 0.996068, loss_ss: 0.930239, loss_d: 0.065828
0.3834 --- loss: 0.973106, loss_ss: 0.755273, loss_d: 0.217833
0.4218 --- loss: 0.770334, loss_ss: 0.724956, loss_d: 0.045378
0.4601 --- loss: 0.883155, loss_ss: 0.855901, loss_d: 0.027254
0.4985 --- loss: 0.953755, loss_ss: 0.666338, loss_d: 0.287418
0.5368 --- loss: 1.056243, loss_ss: 0.869037, loss_d: 0.187206
0.5752 --- loss: 1.033911, loss_ss: 0.855021, loss_d: 0.178889
0.6135 --- loss: 1.029268, loss_ss: 0.994934, loss_d: 0.034334
0.6518 --- loss: 1.062800, loss_ss: 1.057870, loss_d: 0.004931
0.6902 --- loss: 0.904213, loss_ss: 0.881653, loss_d: 0.022560
0.7285 --- loss: 1.107904, loss_ss: 0.794717, loss_d: 0.313188
0.7669 --- loss: 1.899333, loss_ss: 1.024294, loss_d: 0.875040
0.8052 --- loss: 0.864396, loss_ss: 0.750327, loss_d: 0.114070
0.8436 --- loss: 1.222438, loss_ss: 0.859156, loss_d: 0.363281
0.8819 --- loss: 0.835794, loss_ss: 0.810233, loss_d: 0.025561
0.9202 --- loss: 1.364701, loss_ss: 0.724756, loss_d: 0.639945
0.9586 --- loss: 2.014725, loss_ss: 0.901805, loss_d: 1.112920
0.9969 --- loss: 1.120321, loss_ss: 1.016538, loss_d: 0.103782
Epoch finished! Loss: 1.01899672632034
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.898053, loss_ss: 0.860362, loss_d: 0.037691
0.0383 --- loss: 1.410653, loss_ss: 1.273259, loss_d: 0.137394
0.0767 --- loss: 0.891874, loss_ss: 0.841421, loss_d: 0.050453
0.1150 --- loss: 0.898312, loss_ss: 0.828579, loss_d: 0.069734
0.1534 --- loss: 0.830090, loss_ss: 0.699531, loss_d: 0.130560
0.1917 --- loss: 0.960730, loss_ss: 0.828601, loss_d: 0.132128
0.2301 --- loss: 1.134025, loss_ss: 1.096656, loss_d: 0.037369
0.2684 --- loss: 0.675254, loss_ss: 0.613748, loss_d: 0.061506
0.3067 --- loss: 1.115248, loss_ss: 0.930176, loss_d: 0.185072
0.3451 --- loss: 0.706088, loss_ss: 0.605733, loss_d: 0.100355
0.3834 --- loss: 0.957655, loss_ss: 0.926806, loss_d: 0.030849
0.4218 --- loss: 0.737173, loss_ss: 0.731385, loss_d: 0.005788
0.4601 --- loss: 0.886276, loss_ss: 0.882615, loss_d: 0.003661
0.4985 --- loss: 0.635182, loss_ss: 0.605936, loss_d: 0.029246
0.5368 --- loss: 0.901677, loss_ss: 0.873706, loss_d: 0.027971
0.5752 --- loss: 1.272751, loss_ss: 0.768096, loss_d: 0.504655
0.6135 --- loss: 1.277688, loss_ss: 1.057690, loss_d: 0.219998
0.6518 --- loss: 0.895966, loss_ss: 0.711029, loss_d: 0.184937
0.6902 --- loss: 0.599959, loss_ss: 0.540416, loss_d: 0.059543
0.7285 --- loss: 1.084511, loss_ss: 0.779589, loss_d: 0.304922
0.7669 --- loss: 1.045245, loss_ss: 0.970577, loss_d: 0.074669
0.8052 --- loss: 0.915664, loss_ss: 0.864096, loss_d: 0.051568
0.8436 --- loss: 1.287216, loss_ss: 1.261300, loss_d: 0.025916
0.8819 --- loss: 0.666012, loss_ss: 0.606561, loss_d: 0.059451
0.9202 --- loss: 1.496655, loss_ss: 1.234176, loss_d: 0.262479
0.9586 --- loss: 1.007044, loss_ss: 0.811588, loss_d: 0.195457
0.9969 --- loss: 1.557221, loss_ss: 0.478507, loss_d: 1.078714
Epoch finished! Loss: 0.9869033144070551
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7666666666666667
             precision    recall  f1-score   support

        0.0       0.78      0.49      0.60        63
        1.0       0.33      0.09      0.14        22
        2.0       0.81      0.91      0.86       541
        3.0       0.99      0.49      0.66       204
        4.0       0.45      0.93      0.61        70

avg / total       0.81      0.77      0.76       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.44  49.21   98.92  77.50     60.19
1  97.33   9.09   99.54  33.33     14.29
2  81.56  90.94   67.41  80.79     85.57
3  88.33  49.02   99.86  99.01     65.57
4  90.67  92.86   90.48  45.14     60.75
Total accuracy: 76.67%
Average sen: 58.22%
Average spec: 91.24%
Macro f1-score: 57.27%
Diagnosis acc on 15mins: 0.6666666666666666
[0.80138248 0.68039495 0.69141406 0.22737239 0.02194568 0.07499608
 0.1628848  0.13749191 0.74152797 0.02816927 0.74573904 0.38232636
 0.0416842  0.10191525 0.16557683 0.0134445  0.07792573 0.00448834
 0.99652171 0.28752649 0.12124598 0.06576493 0.66774374 0.57715279
 0.97610235 0.95660383 0.03282076 0.03470544 0.00814809 0.21065442]
pred: 0.33452234615882237, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.318767, loss_ss: 1.605464, loss_d: 0.713303
0.0384 --- loss: 2.102412, loss_ss: 1.639873, loss_d: 0.462539
0.0767 --- loss: 2.115890, loss_ss: 1.494464, loss_d: 0.621425
0.1151 --- loss: 2.214503, loss_ss: 1.613034, loss_d: 0.601470
0.1534 --- loss: 1.761018, loss_ss: 1.549214, loss_d: 0.211803
0.1918 --- loss: 2.058388, loss_ss: 1.256852, loss_d: 0.801537
0.2301 --- loss: 2.081186, loss_ss: 1.328687, loss_d: 0.752499
0.2685 --- loss: 1.731537, loss_ss: 1.258360, loss_d: 0.473177
0.3069 --- loss: 1.989425, loss_ss: 1.333504, loss_d: 0.655921
0.3452 --- loss: 1.924481, loss_ss: 1.173999, loss_d: 0.750481
0.3836 --- loss: 1.632163, loss_ss: 1.143848, loss_d: 0.488314
0.4219 --- loss: 1.820657, loss_ss: 1.202268, loss_d: 0.618389
0.4603 --- loss: 1.975923, loss_ss: 1.150499, loss_d: 0.825424
0.4987 --- loss: 2.066041, loss_ss: 1.360467, loss_d: 0.705575
0.5370 --- loss: 1.753847, loss_ss: 1.125642, loss_d: 0.628205
0.5754 --- loss: 1.658509, loss_ss: 1.120499, loss_d: 0.538011
0.6137 --- loss: 1.681374, loss_ss: 1.233540, loss_d: 0.447835
0.6521 --- loss: 1.731666, loss_ss: 1.125887, loss_d: 0.605779
0.6904 --- loss: 1.830635, loss_ss: 1.152270, loss_d: 0.678365
0.7288 --- loss: 1.759824, loss_ss: 1.294739, loss_d: 0.465085
0.7672 --- loss: 1.934350, loss_ss: 1.542222, loss_d: 0.392128
0.8055 --- loss: 1.903100, loss_ss: 0.992349, loss_d: 0.910751
0.8439 --- loss: 1.836252, loss_ss: 1.099714, loss_d: 0.736538
0.8822 --- loss: 1.523808, loss_ss: 1.306729, loss_d: 0.217078
0.9206 --- loss: 2.008220, loss_ss: 1.306520, loss_d: 0.701701
0.9590 --- loss: 1.404671, loss_ss: 1.153551, loss_d: 0.251120
0.9973 --- loss: 1.432822, loss_ss: 1.025454, loss_d: 0.407368
Epoch finished! Loss: 1.8413505136966706
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.520086, loss_ss: 1.175609, loss_d: 0.344477
0.0384 --- loss: 1.653996, loss_ss: 1.158039, loss_d: 0.495957
0.0767 --- loss: 1.919397, loss_ss: 1.192639, loss_d: 0.726758
0.1151 --- loss: 1.488755, loss_ss: 1.014806, loss_d: 0.473948
0.1534 --- loss: 1.795443, loss_ss: 1.490560, loss_d: 0.304883
0.1918 --- loss: 1.691903, loss_ss: 1.016142, loss_d: 0.675761
0.2301 --- loss: 1.815804, loss_ss: 1.272959, loss_d: 0.542846
0.2685 --- loss: 1.377544, loss_ss: 1.215418, loss_d: 0.162126
0.3069 --- loss: 1.751612, loss_ss: 1.313809, loss_d: 0.437804
0.3452 --- loss: 1.397537, loss_ss: 1.187987, loss_d: 0.209550
0.3836 --- loss: 1.428626, loss_ss: 1.043335, loss_d: 0.385291
0.4219 --- loss: 1.547408, loss_ss: 1.088446, loss_d: 0.458963
0.4603 --- loss: 1.698733, loss_ss: 1.373220, loss_d: 0.325513
0.4987 --- loss: 1.183040, loss_ss: 1.079430, loss_d: 0.103610
0.5370 --- loss: 1.145574, loss_ss: 1.034709, loss_d: 0.110865
0.5754 --- loss: 1.869066, loss_ss: 1.033592, loss_d: 0.835473
0.6137 --- loss: 1.498423, loss_ss: 1.060284, loss_d: 0.438139
0.6521 --- loss: 1.355518, loss_ss: 1.140872, loss_d: 0.214647
0.6904 --- loss: 1.429859, loss_ss: 1.165135, loss_d: 0.264724
0.7288 --- loss: 1.191246, loss_ss: 0.965044, loss_d: 0.226202
0.7672 --- loss: 1.497275, loss_ss: 1.140090, loss_d: 0.357185
0.8055 --- loss: 1.255944, loss_ss: 0.904263, loss_d: 0.351681
0.8439 --- loss: 1.174282, loss_ss: 1.056945, loss_d: 0.117338
0.8822 --- loss: 1.483216, loss_ss: 1.127817, loss_d: 0.355399
0.9206 --- loss: 1.573151, loss_ss: 1.196452, loss_d: 0.376698
0.9590 --- loss: 1.027826, loss_ss: 0.912892, loss_d: 0.114935
0.9973 --- loss: 2.145014, loss_ss: 1.472289, loss_d: 0.672725
Epoch finished! Loss: 1.4578123617630738
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.426735, loss_ss: 0.953380, loss_d: 0.473355
0.0384 --- loss: 1.176378, loss_ss: 1.031924, loss_d: 0.144454
0.0767 --- loss: 1.386799, loss_ss: 1.023552, loss_d: 0.363247
0.1151 --- loss: 1.278324, loss_ss: 1.153779, loss_d: 0.124545
0.1534 --- loss: 1.265444, loss_ss: 1.095822, loss_d: 0.169622
0.1918 --- loss: 1.157475, loss_ss: 0.953980, loss_d: 0.203495
0.2301 --- loss: 1.407475, loss_ss: 1.073704, loss_d: 0.333771
0.2685 --- loss: 1.033152, loss_ss: 0.815725, loss_d: 0.217428
0.3069 --- loss: 1.096370, loss_ss: 0.987447, loss_d: 0.108924
0.3452 --- loss: 1.868016, loss_ss: 1.389335, loss_d: 0.478681
0.3836 --- loss: 1.088959, loss_ss: 0.978662, loss_d: 0.110297
0.4219 --- loss: 1.229273, loss_ss: 0.831915, loss_d: 0.397359
0.4603 --- loss: 0.832178, loss_ss: 0.725918, loss_d: 0.106260
0.4987 --- loss: 1.108817, loss_ss: 0.988006, loss_d: 0.120811
0.5370 --- loss: 0.820911, loss_ss: 0.719553, loss_d: 0.101358
0.5754 --- loss: 1.196611, loss_ss: 0.779965, loss_d: 0.416646
0.6137 --- loss: 1.190499, loss_ss: 1.049341, loss_d: 0.141158
0.6521 --- loss: 1.257283, loss_ss: 1.046904, loss_d: 0.210379
0.6904 --- loss: 1.030246, loss_ss: 0.935860, loss_d: 0.094386
0.7288 --- loss: 1.322520, loss_ss: 0.909409, loss_d: 0.413111
0.7672 --- loss: 1.086169, loss_ss: 0.869088, loss_d: 0.217081
0.8055 --- loss: 0.936387, loss_ss: 0.844967, loss_d: 0.091420
0.8439 --- loss: 1.128322, loss_ss: 0.841547, loss_d: 0.286775
0.8822 --- loss: 1.209798, loss_ss: 0.829394, loss_d: 0.380404
0.9206 --- loss: 1.322871, loss_ss: 0.836327, loss_d: 0.486544
0.9590 --- loss: 1.348722, loss_ss: 0.723297, loss_d: 0.625424
0.9973 --- loss: 1.486528, loss_ss: 0.989330, loss_d: 0.497198
Epoch finished! Loss: 1.279568986250804
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.979349, loss_ss: 0.777532, loss_d: 0.201816
0.0384 --- loss: 1.228809, loss_ss: 0.934338, loss_d: 0.294471
0.0767 --- loss: 1.138116, loss_ss: 1.084094, loss_d: 0.054022
0.1151 --- loss: 1.151684, loss_ss: 1.054059, loss_d: 0.097625
0.1534 --- loss: 1.057246, loss_ss: 0.935483, loss_d: 0.121762
0.1918 --- loss: 0.886309, loss_ss: 0.785662, loss_d: 0.100646
0.2301 --- loss: 1.560483, loss_ss: 1.322182, loss_d: 0.238301
0.2685 --- loss: 1.088745, loss_ss: 1.042099, loss_d: 0.046646
0.3069 --- loss: 0.967870, loss_ss: 0.921473, loss_d: 0.046396
0.3452 --- loss: 1.592150, loss_ss: 1.297183, loss_d: 0.294967
0.3836 --- loss: 0.762367, loss_ss: 0.673822, loss_d: 0.088546
0.4219 --- loss: 1.268898, loss_ss: 1.016910, loss_d: 0.251987
0.4603 --- loss: 0.929753, loss_ss: 0.767399, loss_d: 0.162354
0.4987 --- loss: 0.828288, loss_ss: 0.704489, loss_d: 0.123799
0.5370 --- loss: 1.116194, loss_ss: 0.778076, loss_d: 0.338118
0.5754 --- loss: 1.223442, loss_ss: 1.109856, loss_d: 0.113586
0.6137 --- loss: 1.167140, loss_ss: 1.037511, loss_d: 0.129630
0.6521 --- loss: 0.987626, loss_ss: 0.758051, loss_d: 0.229575
0.6904 --- loss: 1.062129, loss_ss: 0.925398, loss_d: 0.136730
0.7288 --- loss: 1.315317, loss_ss: 1.007155, loss_d: 0.308162
0.7672 --- loss: 1.200595, loss_ss: 0.742117, loss_d: 0.458479
0.8055 --- loss: 1.458117, loss_ss: 0.977325, loss_d: 0.480792
0.8439 --- loss: 1.021232, loss_ss: 0.876471, loss_d: 0.144760
0.8822 --- loss: 1.017667, loss_ss: 0.960836, loss_d: 0.056831
0.9206 --- loss: 1.152976, loss_ss: 1.123206, loss_d: 0.029770
0.9590 --- loss: 1.013302, loss_ss: 0.873916, loss_d: 0.139385
0.9973 --- loss: 1.291198, loss_ss: 0.999118, loss_d: 0.292080
Epoch finished! Loss: 1.1865686476230621
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.998305, loss_ss: 0.760549, loss_d: 0.237756
0.0384 --- loss: 1.004855, loss_ss: 0.701362, loss_d: 0.303493
0.0767 --- loss: 1.565960, loss_ss: 1.134921, loss_d: 0.431039
0.1151 --- loss: 0.947973, loss_ss: 0.916620, loss_d: 0.031352
0.1534 --- loss: 0.962337, loss_ss: 0.891126, loss_d: 0.071210
0.1918 --- loss: 1.107131, loss_ss: 1.046196, loss_d: 0.060935
0.2301 --- loss: 1.036370, loss_ss: 0.793494, loss_d: 0.242876
0.2685 --- loss: 1.275380, loss_ss: 0.592253, loss_d: 0.683126
0.3069 --- loss: 0.907911, loss_ss: 0.708033, loss_d: 0.199878
0.3452 --- loss: 1.182069, loss_ss: 0.818167, loss_d: 0.363902
0.3836 --- loss: 0.977255, loss_ss: 0.839175, loss_d: 0.138081
0.4219 --- loss: 1.602905, loss_ss: 1.030144, loss_d: 0.572761
0.4603 --- loss: 1.390439, loss_ss: 0.884547, loss_d: 0.505892
0.4987 --- loss: 1.302921, loss_ss: 1.128651, loss_d: 0.174269
0.5370 --- loss: 1.230849, loss_ss: 0.817160, loss_d: 0.413689
0.5754 --- loss: 0.965909, loss_ss: 0.865003, loss_d: 0.100907
0.6137 --- loss: 0.922866, loss_ss: 0.802668, loss_d: 0.120198
0.6521 --- loss: 1.295750, loss_ss: 1.131174, loss_d: 0.164576
0.6904 --- loss: 0.945657, loss_ss: 0.802356, loss_d: 0.143301
0.7288 --- loss: 0.857645, loss_ss: 0.730240, loss_d: 0.127405
0.7672 --- loss: 1.727396, loss_ss: 0.930431, loss_d: 0.796965
0.8055 --- loss: 1.527340, loss_ss: 0.878945, loss_d: 0.648395
0.8439 --- loss: 0.949805, loss_ss: 0.753147, loss_d: 0.196657
0.8822 --- loss: 1.381198, loss_ss: 1.288467, loss_d: 0.092731
0.9206 --- loss: 0.811350, loss_ss: 0.659138, loss_d: 0.152212
0.9590 --- loss: 1.086545, loss_ss: 0.833589, loss_d: 0.252956
0.9973 --- loss: 0.865722, loss_ss: 0.821952, loss_d: 0.043770
Epoch finished! Loss: 1.1150128816182796
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.125578, loss_ss: 0.899972, loss_d: 0.225607
0.0384 --- loss: 0.703233, loss_ss: 0.674454, loss_d: 0.028779
0.0767 --- loss: 0.696417, loss_ss: 0.610150, loss_d: 0.086267
0.1151 --- loss: 1.578739, loss_ss: 1.545942, loss_d: 0.032797
0.1534 --- loss: 1.170898, loss_ss: 0.844368, loss_d: 0.326530
0.1918 --- loss: 1.043722, loss_ss: 0.955337, loss_d: 0.088385
0.2301 --- loss: 1.001590, loss_ss: 0.908411, loss_d: 0.093179
0.2685 --- loss: 0.926531, loss_ss: 0.882657, loss_d: 0.043874
0.3069 --- loss: 1.165732, loss_ss: 0.852922, loss_d: 0.312811
0.3452 --- loss: 0.880697, loss_ss: 0.738330, loss_d: 0.142367
0.3836 --- loss: 0.970659, loss_ss: 0.755413, loss_d: 0.215247
0.4219 --- loss: 1.294564, loss_ss: 0.942362, loss_d: 0.352201
0.4603 --- loss: 0.901295, loss_ss: 0.844856, loss_d: 0.056439
0.4987 --- loss: 0.830790, loss_ss: 0.790034, loss_d: 0.040756
0.5370 --- loss: 0.851411, loss_ss: 0.812733, loss_d: 0.038678
0.5754 --- loss: 1.023294, loss_ss: 0.806917, loss_d: 0.216377
0.6137 --- loss: 0.993792, loss_ss: 0.798266, loss_d: 0.195527
0.6521 --- loss: 1.038536, loss_ss: 0.742210, loss_d: 0.296327
0.6904 --- loss: 1.198292, loss_ss: 0.869567, loss_d: 0.328725
0.7288 --- loss: 0.844946, loss_ss: 0.650957, loss_d: 0.193990
0.7672 --- loss: 1.003268, loss_ss: 0.747723, loss_d: 0.255545
0.8055 --- loss: 0.869066, loss_ss: 0.621215, loss_d: 0.247851
0.8439 --- loss: 0.990789, loss_ss: 0.909135, loss_d: 0.081654
0.8822 --- loss: 0.951384, loss_ss: 0.864963, loss_d: 0.086421
0.9206 --- loss: 1.172761, loss_ss: 0.885703, loss_d: 0.287058
0.9590 --- loss: 0.913735, loss_ss: 0.743041, loss_d: 0.170694
0.9973 --- loss: 1.166115, loss_ss: 0.672138, loss_d: 0.493977
Epoch finished! Loss: 1.066248280956195
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.989258, loss_ss: 0.868886, loss_d: 0.120372
0.0384 --- loss: 1.181882, loss_ss: 0.979247, loss_d: 0.202635
0.0767 --- loss: 0.999681, loss_ss: 0.824350, loss_d: 0.175332
0.1151 --- loss: 0.946820, loss_ss: 0.794369, loss_d: 0.152452
0.1534 --- loss: 0.972810, loss_ss: 0.830854, loss_d: 0.141956
0.1918 --- loss: 1.018999, loss_ss: 0.753713, loss_d: 0.265286
0.2301 --- loss: 1.173676, loss_ss: 1.011773, loss_d: 0.161902
0.2685 --- loss: 1.858405, loss_ss: 0.788394, loss_d: 1.070011
0.3069 --- loss: 1.021221, loss_ss: 0.863942, loss_d: 0.157278
0.3452 --- loss: 1.228756, loss_ss: 0.755795, loss_d: 0.472961
0.3836 --- loss: 0.993287, loss_ss: 0.940447, loss_d: 0.052841
0.4219 --- loss: 0.798798, loss_ss: 0.762663, loss_d: 0.036135
0.4603 --- loss: 0.817208, loss_ss: 0.752720, loss_d: 0.064488
0.4987 --- loss: 0.725540, loss_ss: 0.561533, loss_d: 0.164007
0.5370 --- loss: 0.795318, loss_ss: 0.743809, loss_d: 0.051509
0.5754 --- loss: 0.880596, loss_ss: 0.852043, loss_d: 0.028553
0.6137 --- loss: 0.710225, loss_ss: 0.633208, loss_d: 0.077018
0.6521 --- loss: 0.994677, loss_ss: 0.807897, loss_d: 0.186780
0.6904 --- loss: 0.780374, loss_ss: 0.647751, loss_d: 0.132622
0.7288 --- loss: 1.129272, loss_ss: 0.889530, loss_d: 0.239742
0.7672 --- loss: 0.794984, loss_ss: 0.763822, loss_d: 0.031162
0.8055 --- loss: 1.386593, loss_ss: 1.207252, loss_d: 0.179341
0.8439 --- loss: 1.018143, loss_ss: 0.947739, loss_d: 0.070405
0.8822 --- loss: 0.607378, loss_ss: 0.483588, loss_d: 0.123790
0.9206 --- loss: 0.749226, loss_ss: 0.729362, loss_d: 0.019865
0.9590 --- loss: 0.640829, loss_ss: 0.621089, loss_d: 0.019740
0.9973 --- loss: 0.881521, loss_ss: 0.864948, loss_d: 0.016573
Epoch finished! Loss: 0.999179396721033
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.842754, loss_ss: 0.683339, loss_d: 0.159415
0.0384 --- loss: 0.784952, loss_ss: 0.705169, loss_d: 0.079783
0.0767 --- loss: 1.682083, loss_ss: 0.680946, loss_d: 1.001137
0.1151 --- loss: 0.782860, loss_ss: 0.757502, loss_d: 0.025358
0.1534 --- loss: 1.248135, loss_ss: 0.676680, loss_d: 0.571455
0.1918 --- loss: 0.719813, loss_ss: 0.697056, loss_d: 0.022757
0.2301 --- loss: 1.138516, loss_ss: 1.118791, loss_d: 0.019726
0.2685 --- loss: 0.925687, loss_ss: 0.914636, loss_d: 0.011051
0.3069 --- loss: 0.957065, loss_ss: 0.947112, loss_d: 0.009953
0.3452 --- loss: 0.948811, loss_ss: 0.580523, loss_d: 0.368288
0.3836 --- loss: 0.686220, loss_ss: 0.579584, loss_d: 0.106636
0.4219 --- loss: 0.929241, loss_ss: 0.923572, loss_d: 0.005669
0.4603 --- loss: 0.766194, loss_ss: 0.724171, loss_d: 0.042023
0.4987 --- loss: 1.245078, loss_ss: 0.848041, loss_d: 0.397037
0.5370 --- loss: 1.748880, loss_ss: 1.733167, loss_d: 0.015713
0.5754 --- loss: 0.961142, loss_ss: 0.820601, loss_d: 0.140541
0.6137 --- loss: 1.014687, loss_ss: 0.731854, loss_d: 0.282833
0.6521 --- loss: 0.865235, loss_ss: 0.707952, loss_d: 0.157283
0.6904 --- loss: 0.782229, loss_ss: 0.722992, loss_d: 0.059237
0.7288 --- loss: 1.113162, loss_ss: 0.561056, loss_d: 0.552106
0.7672 --- loss: 0.764912, loss_ss: 0.732826, loss_d: 0.032087
0.8055 --- loss: 0.750641, loss_ss: 0.731628, loss_d: 0.019013
0.8439 --- loss: 1.334541, loss_ss: 0.875668, loss_d: 0.458873
0.8822 --- loss: 1.096399, loss_ss: 0.799439, loss_d: 0.296960
0.9206 --- loss: 0.691084, loss_ss: 0.670759, loss_d: 0.020325
0.9590 --- loss: 0.835266, loss_ss: 0.825340, loss_d: 0.009926
0.9973 --- loss: 1.702157, loss_ss: 1.297800, loss_d: 0.404358
Epoch finished! Loss: 0.9537349198873226
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.812133, loss_ss: 0.805973, loss_d: 0.006159
0.0384 --- loss: 1.774717, loss_ss: 0.828493, loss_d: 0.946224
0.0767 --- loss: 0.949520, loss_ss: 0.705895, loss_d: 0.243625
0.1151 --- loss: 1.792756, loss_ss: 0.865486, loss_d: 0.927270
0.1534 --- loss: 0.902622, loss_ss: 0.616668, loss_d: 0.285955
0.1918 --- loss: 1.887777, loss_ss: 1.036347, loss_d: 0.851431
0.2301 --- loss: 0.800883, loss_ss: 0.746265, loss_d: 0.054618
0.2685 --- loss: 0.863401, loss_ss: 0.817405, loss_d: 0.045996
0.3069 --- loss: 0.844719, loss_ss: 0.828365, loss_d: 0.016354
0.3452 --- loss: 0.796073, loss_ss: 0.752041, loss_d: 0.044032
0.3836 --- loss: 1.102514, loss_ss: 0.744123, loss_d: 0.358391
0.4219 --- loss: 0.917407, loss_ss: 0.902254, loss_d: 0.015152
0.4603 --- loss: 0.683037, loss_ss: 0.669539, loss_d: 0.013498
0.4987 --- loss: 0.669592, loss_ss: 0.657197, loss_d: 0.012395
0.5370 --- loss: 0.761828, loss_ss: 0.694616, loss_d: 0.067212
0.5754 --- loss: 1.022820, loss_ss: 0.930764, loss_d: 0.092057
0.6137 --- loss: 1.047936, loss_ss: 0.853391, loss_d: 0.194545
0.6521 --- loss: 0.666402, loss_ss: 0.616845, loss_d: 0.049557
0.6904 --- loss: 0.935287, loss_ss: 0.897168, loss_d: 0.038119
0.7288 --- loss: 0.723267, loss_ss: 0.704288, loss_d: 0.018979
0.7672 --- loss: 0.847192, loss_ss: 0.824680, loss_d: 0.022512
0.8055 --- loss: 1.050837, loss_ss: 1.030579, loss_d: 0.020258
0.8439 --- loss: 1.017884, loss_ss: 0.994772, loss_d: 0.023112
0.8822 --- loss: 0.776740, loss_ss: 0.767206, loss_d: 0.009534
0.9206 --- loss: 0.950900, loss_ss: 0.773501, loss_d: 0.177399
0.9590 --- loss: 0.689662, loss_ss: 0.555568, loss_d: 0.134094
0.9973 --- loss: 1.375257, loss_ss: 0.731695, loss_d: 0.643562
Epoch finished! Loss: 0.9530826307260073
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.574687, loss_ss: 0.562329, loss_d: 0.012357
0.0384 --- loss: 0.713902, loss_ss: 0.701301, loss_d: 0.012601
0.0767 --- loss: 0.863257, loss_ss: 0.810999, loss_d: 0.052258
0.1151 --- loss: 0.911418, loss_ss: 0.889977, loss_d: 0.021441
0.1534 --- loss: 1.397796, loss_ss: 0.669131, loss_d: 0.728665
0.1918 --- loss: 0.562468, loss_ss: 0.518158, loss_d: 0.044310
0.2301 --- loss: 0.905668, loss_ss: 0.893804, loss_d: 0.011865
0.2685 --- loss: 0.804983, loss_ss: 0.790283, loss_d: 0.014700
0.3069 --- loss: 1.132593, loss_ss: 0.826128, loss_d: 0.306465
0.3452 --- loss: 0.836177, loss_ss: 0.797333, loss_d: 0.038844
0.3836 --- loss: 0.843680, loss_ss: 0.803994, loss_d: 0.039686
0.4219 --- loss: 0.907755, loss_ss: 0.880535, loss_d: 0.027220
0.4603 --- loss: 0.916461, loss_ss: 0.769918, loss_d: 0.146542
0.4987 --- loss: 1.160116, loss_ss: 1.102159, loss_d: 0.057956
0.5370 --- loss: 1.049613, loss_ss: 0.821267, loss_d: 0.228346
0.5754 --- loss: 0.910790, loss_ss: 0.873666, loss_d: 0.037124
0.6137 --- loss: 1.154373, loss_ss: 0.965119, loss_d: 0.189254
0.6521 --- loss: 0.856781, loss_ss: 0.829112, loss_d: 0.027670
0.6904 --- loss: 1.191066, loss_ss: 1.026668, loss_d: 0.164397
0.7288 --- loss: 1.151828, loss_ss: 1.107253, loss_d: 0.044575
0.7672 --- loss: 0.800686, loss_ss: 0.792095, loss_d: 0.008591
0.8055 --- loss: 0.881491, loss_ss: 0.833790, loss_d: 0.047701
0.8439 --- loss: 1.096668, loss_ss: 1.064110, loss_d: 0.032558
0.8822 --- loss: 1.060987, loss_ss: 1.014454, loss_d: 0.046533
0.9206 --- loss: 1.199299, loss_ss: 0.721878, loss_d: 0.477421
0.9590 --- loss: 0.950584, loss_ss: 0.732371, loss_d: 0.218214
0.9973 --- loss: 1.218536, loss_ss: 1.053203, loss_d: 0.165333
Epoch finished! Loss: 0.9356299620408278
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6236559139784946
             precision    recall  f1-score   support

        0.0       0.97      0.51      0.67        69
        1.0       0.30      0.79      0.43        38
        2.0       0.84      0.57      0.68       434
        3.0       1.00      0.48      0.65       228
        4.0       0.40      0.98      0.57       161

avg / total       0.79      0.62      0.64       930
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.24  50.72   99.88   97.22     66.67
1  91.51  78.95   92.04   29.70     43.17
2  75.05  57.14   90.73   84.35     68.13
3  87.31  48.25  100.00  100.00     65.09
4  74.62  97.52   69.83   40.36     57.09
Total accuracy: 62.37%
Average sen: 66.52%
Average spec: 90.50%
Macro f1-score: 60.03%
Diagnosis acc on 15mins: 0.25806451612903225
[0.00119621 0.8027851  0.93078423 0.99479419 0.98201799 0.85977525
 0.54219443 0.93965274 0.52730918 0.83772302 0.87747425 0.71837753
 0.4459897  0.8470673  0.32575074 0.91399544 0.8945424  0.65680301
 0.65315306 0.50861377 0.6456567  0.8129372  0.40194359 0.79378349
 0.98405278 0.73802048 0.69468701 0.01055194 0.10170665 0.35196647
 0.02461693]
pred: 0.6393523474276487, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.303077, loss_ss: 1.680337, loss_d: 0.622740
0.0384 --- loss: 2.115261, loss_ss: 1.580551, loss_d: 0.534711
0.0767 --- loss: 2.421041, loss_ss: 1.715507, loss_d: 0.705534
0.1151 --- loss: 2.446051, loss_ss: 1.642878, loss_d: 0.803173
0.1534 --- loss: 2.202690, loss_ss: 1.688668, loss_d: 0.514023
0.1918 --- loss: 2.034056, loss_ss: 1.631529, loss_d: 0.402527
0.2301 --- loss: 2.283052, loss_ss: 1.439350, loss_d: 0.843702
0.2685 --- loss: 1.907458, loss_ss: 1.473337, loss_d: 0.434121
0.3069 --- loss: 1.872658, loss_ss: 1.507446, loss_d: 0.365213
0.3452 --- loss: 2.108486, loss_ss: 1.374068, loss_d: 0.734418
0.3836 --- loss: 1.883890, loss_ss: 1.353901, loss_d: 0.529989
0.4219 --- loss: 1.791546, loss_ss: 1.424856, loss_d: 0.366690
0.4603 --- loss: 1.794336, loss_ss: 1.374792, loss_d: 0.419544
0.4987 --- loss: 2.386628, loss_ss: 1.449934, loss_d: 0.936694
0.5370 --- loss: 1.892299, loss_ss: 1.307707, loss_d: 0.584591
0.5754 --- loss: 1.959406, loss_ss: 1.430251, loss_d: 0.529155
0.6137 --- loss: 2.018232, loss_ss: 1.194415, loss_d: 0.823817
0.6521 --- loss: 1.951333, loss_ss: 1.313039, loss_d: 0.638293
0.6904 --- loss: 1.771942, loss_ss: 1.258260, loss_d: 0.513682
0.7288 --- loss: 1.807868, loss_ss: 1.245596, loss_d: 0.562273
0.7672 --- loss: 1.830680, loss_ss: 1.284736, loss_d: 0.545944
0.8055 --- loss: 1.744182, loss_ss: 1.227350, loss_d: 0.516831
0.8439 --- loss: 1.893023, loss_ss: 1.301056, loss_d: 0.591967
0.8822 --- loss: 1.534407, loss_ss: 1.120186, loss_d: 0.414220
0.9206 --- loss: 1.694583, loss_ss: 1.270513, loss_d: 0.424070
0.9590 --- loss: 1.535031, loss_ss: 1.228477, loss_d: 0.306554
0.9973 --- loss: 1.379684, loss_ss: 1.011417, loss_d: 0.368268
Epoch finished! Loss: 1.9488144837892973
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.387272, loss_ss: 1.192703, loss_d: 0.194570
0.0384 --- loss: 1.513008, loss_ss: 1.250254, loss_d: 0.262754
0.0767 --- loss: 1.737069, loss_ss: 1.185326, loss_d: 0.551744
0.1151 --- loss: 1.688608, loss_ss: 1.192073, loss_d: 0.496535
0.1534 --- loss: 1.356358, loss_ss: 1.190727, loss_d: 0.165632
0.1918 --- loss: 1.178021, loss_ss: 1.027620, loss_d: 0.150400
0.2301 --- loss: 1.339876, loss_ss: 1.033689, loss_d: 0.306187
0.2685 --- loss: 1.259774, loss_ss: 0.992406, loss_d: 0.267368
0.3069 --- loss: 1.823009, loss_ss: 0.990565, loss_d: 0.832444
0.3452 --- loss: 1.908158, loss_ss: 1.567675, loss_d: 0.340483
0.3836 --- loss: 1.521625, loss_ss: 1.206633, loss_d: 0.314991
0.4219 --- loss: 1.420779, loss_ss: 1.226683, loss_d: 0.194096
0.4603 --- loss: 1.366031, loss_ss: 0.997459, loss_d: 0.368572
0.4987 --- loss: 2.195639, loss_ss: 0.953565, loss_d: 1.242073
0.5370 --- loss: 1.266755, loss_ss: 1.000555, loss_d: 0.266200
0.5754 --- loss: 1.459885, loss_ss: 1.024845, loss_d: 0.435040
0.6137 --- loss: 1.235469, loss_ss: 1.052113, loss_d: 0.183356
0.6521 --- loss: 1.336643, loss_ss: 0.923036, loss_d: 0.413606
0.6904 --- loss: 1.161721, loss_ss: 1.058131, loss_d: 0.103590
0.7288 --- loss: 0.948367, loss_ss: 0.868153, loss_d: 0.080214
0.7672 --- loss: 1.239226, loss_ss: 0.778325, loss_d: 0.460901
0.8055 --- loss: 1.518599, loss_ss: 1.049689, loss_d: 0.468910
0.8439 --- loss: 1.238990, loss_ss: 0.975427, loss_d: 0.263563
0.8822 --- loss: 1.313104, loss_ss: 1.250834, loss_d: 0.062270
0.9206 --- loss: 1.496276, loss_ss: 1.241410, loss_d: 0.254866
0.9590 --- loss: 1.189667, loss_ss: 1.097728, loss_d: 0.091939
0.9973 --- loss: 1.202029, loss_ss: 1.100788, loss_d: 0.101241
Epoch finished! Loss: 1.4224319061407675
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.350492, loss_ss: 0.980823, loss_d: 0.369669
0.0384 --- loss: 1.154937, loss_ss: 1.009977, loss_d: 0.144960
0.0767 --- loss: 1.725196, loss_ss: 0.908958, loss_d: 0.816238
0.1151 --- loss: 1.120967, loss_ss: 0.823740, loss_d: 0.297227
0.1534 --- loss: 1.213338, loss_ss: 1.008532, loss_d: 0.204805
0.1918 --- loss: 1.083777, loss_ss: 0.964253, loss_d: 0.119524
0.2301 --- loss: 1.711793, loss_ss: 1.099009, loss_d: 0.612784
0.2685 --- loss: 1.525228, loss_ss: 0.984499, loss_d: 0.540730
0.3069 --- loss: 1.808938, loss_ss: 1.518712, loss_d: 0.290226
0.3452 --- loss: 1.181167, loss_ss: 0.973975, loss_d: 0.207193
0.3836 --- loss: 1.133536, loss_ss: 1.024437, loss_d: 0.109100
0.4219 --- loss: 1.154726, loss_ss: 1.019873, loss_d: 0.134853
0.4603 --- loss: 1.250248, loss_ss: 0.931417, loss_d: 0.318831
0.4987 --- loss: 0.966564, loss_ss: 0.924850, loss_d: 0.041714
0.5370 --- loss: 1.679030, loss_ss: 1.395706, loss_d: 0.283324
0.5754 --- loss: 1.021938, loss_ss: 0.928192, loss_d: 0.093746
0.6137 --- loss: 1.133278, loss_ss: 0.943197, loss_d: 0.190081
0.6521 --- loss: 1.070363, loss_ss: 0.889926, loss_d: 0.180437
0.6904 --- loss: 1.120086, loss_ss: 1.069562, loss_d: 0.050524
0.7288 --- loss: 1.188053, loss_ss: 1.063341, loss_d: 0.124713
0.7672 --- loss: 1.091514, loss_ss: 0.828169, loss_d: 0.263345
0.8055 --- loss: 1.586019, loss_ss: 1.292333, loss_d: 0.293686
0.8439 --- loss: 1.123379, loss_ss: 1.025645, loss_d: 0.097735
0.8822 --- loss: 0.888543, loss_ss: 0.799554, loss_d: 0.088989
0.9206 --- loss: 1.063922, loss_ss: 1.021948, loss_d: 0.041974
0.9590 --- loss: 1.107304, loss_ss: 0.992861, loss_d: 0.114443
0.9973 --- loss: 1.248050, loss_ss: 1.111828, loss_d: 0.136222
Epoch finished! Loss: 1.2523126251422443
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.173470, loss_ss: 0.989161, loss_d: 0.184309
0.0384 --- loss: 1.668608, loss_ss: 1.328823, loss_d: 0.339785
0.0767 --- loss: 0.951756, loss_ss: 0.835790, loss_d: 0.115967
0.1151 --- loss: 1.007540, loss_ss: 0.907697, loss_d: 0.099843
0.1534 --- loss: 1.777553, loss_ss: 0.992048, loss_d: 0.785506
0.1918 --- loss: 1.206372, loss_ss: 1.180035, loss_d: 0.026337
0.2301 --- loss: 0.925700, loss_ss: 0.888666, loss_d: 0.037034
0.2685 --- loss: 1.224357, loss_ss: 1.154161, loss_d: 0.070197
0.3069 --- loss: 1.402467, loss_ss: 1.108323, loss_d: 0.294144
0.3452 --- loss: 1.299188, loss_ss: 0.826633, loss_d: 0.472555
0.3836 --- loss: 0.787400, loss_ss: 0.718237, loss_d: 0.069164
0.4219 --- loss: 1.653714, loss_ss: 0.886034, loss_d: 0.767680
0.4603 --- loss: 1.290104, loss_ss: 0.974496, loss_d: 0.315608
0.4987 --- loss: 0.967942, loss_ss: 0.734042, loss_d: 0.233900
0.5370 --- loss: 0.996168, loss_ss: 0.949038, loss_d: 0.047130
0.5754 --- loss: 0.896157, loss_ss: 0.813921, loss_d: 0.082236
0.6137 --- loss: 0.892720, loss_ss: 0.845359, loss_d: 0.047361
0.6521 --- loss: 1.376460, loss_ss: 1.274949, loss_d: 0.101512
0.6904 --- loss: 1.189405, loss_ss: 0.866416, loss_d: 0.322989
0.7288 --- loss: 1.380222, loss_ss: 1.231930, loss_d: 0.148292
0.7672 --- loss: 0.872051, loss_ss: 0.831840, loss_d: 0.040211
0.8055 --- loss: 1.043217, loss_ss: 0.794953, loss_d: 0.248264
0.8439 --- loss: 1.438351, loss_ss: 1.192440, loss_d: 0.245912
0.8822 --- loss: 1.129277, loss_ss: 1.020999, loss_d: 0.108278
0.9206 --- loss: 0.945719, loss_ss: 0.855214, loss_d: 0.090505
0.9590 --- loss: 0.761588, loss_ss: 0.716733, loss_d: 0.044855
0.9973 --- loss: 1.091724, loss_ss: 0.999739, loss_d: 0.091984
Epoch finished! Loss: 1.141661487863614
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.264447, loss_ss: 0.807175, loss_d: 0.457273
0.0384 --- loss: 1.546376, loss_ss: 1.196980, loss_d: 0.349396
0.0767 --- loss: 0.979843, loss_ss: 0.813029, loss_d: 0.166814
0.1151 --- loss: 1.056900, loss_ss: 0.964470, loss_d: 0.092430
0.1534 --- loss: 1.140269, loss_ss: 1.020222, loss_d: 0.120047
0.1918 --- loss: 1.077483, loss_ss: 0.891339, loss_d: 0.186144
0.2301 --- loss: 0.991071, loss_ss: 0.922391, loss_d: 0.068679
0.2685 --- loss: 1.371622, loss_ss: 1.331387, loss_d: 0.040235
0.3069 --- loss: 0.882732, loss_ss: 0.688087, loss_d: 0.194645
0.3452 --- loss: 0.959636, loss_ss: 0.739513, loss_d: 0.220123
0.3836 --- loss: 0.922564, loss_ss: 0.815811, loss_d: 0.106752
0.4219 --- loss: 0.871519, loss_ss: 0.799897, loss_d: 0.071622
0.4603 --- loss: 0.970197, loss_ss: 0.920038, loss_d: 0.050160
0.4987 --- loss: 1.050010, loss_ss: 1.002385, loss_d: 0.047625
0.5370 --- loss: 0.766363, loss_ss: 0.726668, loss_d: 0.039695
0.5754 --- loss: 1.259516, loss_ss: 0.882915, loss_d: 0.376602
0.6137 --- loss: 0.759484, loss_ss: 0.733320, loss_d: 0.026163
0.6521 --- loss: 0.820509, loss_ss: 0.776054, loss_d: 0.044455
0.6904 --- loss: 1.179686, loss_ss: 1.095777, loss_d: 0.083908
0.7288 --- loss: 1.157078, loss_ss: 0.756635, loss_d: 0.400443
0.7672 --- loss: 1.234494, loss_ss: 0.723542, loss_d: 0.510953
0.8055 --- loss: 0.925259, loss_ss: 0.889089, loss_d: 0.036169
0.8439 --- loss: 0.989161, loss_ss: 0.882691, loss_d: 0.106471
0.8822 --- loss: 1.516550, loss_ss: 1.483997, loss_d: 0.032553
0.9206 --- loss: 0.813394, loss_ss: 0.782259, loss_d: 0.031135
0.9590 --- loss: 0.814163, loss_ss: 0.726503, loss_d: 0.087660
0.9973 --- loss: 1.016182, loss_ss: 0.810745, loss_d: 0.205437
Epoch finished! Loss: 1.0780200994931735
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.858487, loss_ss: 0.614850, loss_d: 0.243638
0.0384 --- loss: 0.812673, loss_ss: 0.773263, loss_d: 0.039410
0.0767 --- loss: 1.079417, loss_ss: 0.977870, loss_d: 0.101547
0.1151 --- loss: 0.917956, loss_ss: 0.701900, loss_d: 0.216056
0.1534 --- loss: 1.588663, loss_ss: 0.893002, loss_d: 0.695660
0.1918 --- loss: 1.188615, loss_ss: 1.016700, loss_d: 0.171915
0.2301 --- loss: 1.046925, loss_ss: 0.982774, loss_d: 0.064150
0.2685 --- loss: 1.206658, loss_ss: 0.930188, loss_d: 0.276470
0.3069 --- loss: 0.955741, loss_ss: 0.925702, loss_d: 0.030039
0.3452 --- loss: 0.753253, loss_ss: 0.733038, loss_d: 0.020215
0.3836 --- loss: 0.837681, loss_ss: 0.814376, loss_d: 0.023305
0.4219 --- loss: 1.067152, loss_ss: 1.032621, loss_d: 0.034531
0.4603 --- loss: 0.843875, loss_ss: 0.748155, loss_d: 0.095720
0.4987 --- loss: 1.106886, loss_ss: 0.957934, loss_d: 0.148952
0.5370 --- loss: 1.065639, loss_ss: 0.890381, loss_d: 0.175257
0.5754 --- loss: 1.279229, loss_ss: 1.162790, loss_d: 0.116439
0.6137 --- loss: 0.971014, loss_ss: 0.956533, loss_d: 0.014481
0.6521 --- loss: 0.902977, loss_ss: 0.837402, loss_d: 0.065575
0.6904 --- loss: 1.346077, loss_ss: 0.881229, loss_d: 0.464847
0.7288 --- loss: 1.315567, loss_ss: 1.139000, loss_d: 0.176566
0.7672 --- loss: 0.890482, loss_ss: 0.711700, loss_d: 0.178782
0.8055 --- loss: 0.799016, loss_ss: 0.725752, loss_d: 0.073265
0.8439 --- loss: 0.882649, loss_ss: 0.823047, loss_d: 0.059602
0.8822 --- loss: 1.652703, loss_ss: 1.183725, loss_d: 0.468978
0.9206 --- loss: 0.732663, loss_ss: 0.688713, loss_d: 0.043950
0.9590 --- loss: 1.063071, loss_ss: 0.832216, loss_d: 0.230855
0.9973 --- loss: 1.202249, loss_ss: 1.149570, loss_d: 0.052678
Epoch finished! Loss: 1.0536922379181934
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.833002, loss_ss: 0.777776, loss_d: 0.055226
0.0384 --- loss: 0.950055, loss_ss: 0.874835, loss_d: 0.075220
0.0767 --- loss: 1.072969, loss_ss: 0.714449, loss_d: 0.358520
0.1151 --- loss: 1.204191, loss_ss: 1.145871, loss_d: 0.058319
0.1534 --- loss: 0.980237, loss_ss: 0.816953, loss_d: 0.163284
0.1918 --- loss: 1.521135, loss_ss: 1.027039, loss_d: 0.494096
0.2301 --- loss: 0.951588, loss_ss: 0.909889, loss_d: 0.041699
0.2685 --- loss: 0.776875, loss_ss: 0.754136, loss_d: 0.022739
0.3069 --- loss: 1.419749, loss_ss: 1.403799, loss_d: 0.015950
0.3452 --- loss: 0.933142, loss_ss: 0.894196, loss_d: 0.038945
0.3836 --- loss: 0.730287, loss_ss: 0.682087, loss_d: 0.048200
0.4219 --- loss: 1.257195, loss_ss: 0.934431, loss_d: 0.322764
0.4603 --- loss: 0.913186, loss_ss: 0.868856, loss_d: 0.044330
0.4987 --- loss: 0.858303, loss_ss: 0.835467, loss_d: 0.022836
0.5370 --- loss: 0.930406, loss_ss: 0.899499, loss_d: 0.030907
0.5754 --- loss: 0.997555, loss_ss: 0.954282, loss_d: 0.043273
0.6137 --- loss: 0.979472, loss_ss: 0.856543, loss_d: 0.122928
0.6521 --- loss: 0.884777, loss_ss: 0.814242, loss_d: 0.070535
0.6904 --- loss: 1.311923, loss_ss: 0.765184, loss_d: 0.546739
0.7288 --- loss: 0.786841, loss_ss: 0.634809, loss_d: 0.152032
0.7672 --- loss: 1.217607, loss_ss: 1.136949, loss_d: 0.080657
0.8055 --- loss: 1.801626, loss_ss: 1.058308, loss_d: 0.743318
0.8439 --- loss: 1.086785, loss_ss: 0.875790, loss_d: 0.210995
0.8822 --- loss: 0.716876, loss_ss: 0.681037, loss_d: 0.035838
0.9206 --- loss: 1.113863, loss_ss: 0.920026, loss_d: 0.193837
0.9590 --- loss: 0.862503, loss_ss: 0.801607, loss_d: 0.060895
0.9973 --- loss: 0.807845, loss_ss: 0.736326, loss_d: 0.071520
Epoch finished! Loss: 1.0168055506852958
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.818809, loss_ss: 0.790877, loss_d: 0.027932
0.0384 --- loss: 0.999744, loss_ss: 0.908150, loss_d: 0.091594
0.0767 --- loss: 0.746498, loss_ss: 0.705255, loss_d: 0.041242
0.1151 --- loss: 0.818805, loss_ss: 0.812889, loss_d: 0.005916
0.1534 --- loss: 0.755724, loss_ss: 0.718146, loss_d: 0.037578
0.1918 --- loss: 0.816215, loss_ss: 0.776484, loss_d: 0.039731
0.2301 --- loss: 0.834980, loss_ss: 0.803779, loss_d: 0.031201
0.2685 --- loss: 1.608308, loss_ss: 1.010483, loss_d: 0.597825
0.3069 --- loss: 1.069436, loss_ss: 0.982924, loss_d: 0.086512
0.3452 --- loss: 0.889937, loss_ss: 0.855606, loss_d: 0.034331
0.3836 --- loss: 0.989323, loss_ss: 0.790666, loss_d: 0.198658
0.4219 --- loss: 0.766508, loss_ss: 0.709282, loss_d: 0.057226
0.4603 --- loss: 0.784674, loss_ss: 0.735245, loss_d: 0.049429
0.4987 --- loss: 0.760717, loss_ss: 0.752766, loss_d: 0.007951
0.5370 --- loss: 0.778792, loss_ss: 0.692659, loss_d: 0.086133
0.5754 --- loss: 1.572715, loss_ss: 1.152474, loss_d: 0.420241
0.6137 --- loss: 0.855000, loss_ss: 0.755983, loss_d: 0.099017
0.6521 --- loss: 1.136814, loss_ss: 0.785773, loss_d: 0.351041
0.6904 --- loss: 1.031853, loss_ss: 0.918126, loss_d: 0.113727
0.7288 --- loss: 0.630029, loss_ss: 0.607365, loss_d: 0.022664
0.7672 --- loss: 0.925572, loss_ss: 0.794504, loss_d: 0.131068
0.8055 --- loss: 1.320305, loss_ss: 1.186741, loss_d: 0.133564
0.8439 --- loss: 0.888942, loss_ss: 0.865469, loss_d: 0.023473
0.8822 --- loss: 0.827753, loss_ss: 0.553966, loss_d: 0.273787
0.9206 --- loss: 0.974131, loss_ss: 0.970419, loss_d: 0.003711
0.9590 --- loss: 1.299646, loss_ss: 1.286827, loss_d: 0.012819
0.9973 --- loss: 1.345119, loss_ss: 1.147663, loss_d: 0.197456
Epoch finished! Loss: 0.9518949850247457
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.829142, loss_ss: 0.784332, loss_d: 0.044811
0.0384 --- loss: 0.855904, loss_ss: 0.835314, loss_d: 0.020590
0.0767 --- loss: 0.776300, loss_ss: 0.725458, loss_d: 0.050842
0.1151 --- loss: 1.048649, loss_ss: 0.811894, loss_d: 0.236755
0.1534 --- loss: 0.637459, loss_ss: 0.611424, loss_d: 0.026034
0.1918 --- loss: 0.899658, loss_ss: 0.789281, loss_d: 0.110378
0.2301 --- loss: 0.848697, loss_ss: 0.840763, loss_d: 0.007933
0.2685 --- loss: 1.147188, loss_ss: 1.050791, loss_d: 0.096397
0.3069 --- loss: 1.075931, loss_ss: 0.879116, loss_d: 0.196815
0.3452 --- loss: 0.800164, loss_ss: 0.743982, loss_d: 0.056182
0.3836 --- loss: 0.668344, loss_ss: 0.656570, loss_d: 0.011774
0.4219 --- loss: 0.929699, loss_ss: 0.909778, loss_d: 0.019921
0.4603 --- loss: 0.922607, loss_ss: 0.900197, loss_d: 0.022410
0.4987 --- loss: 0.669539, loss_ss: 0.626422, loss_d: 0.043117
0.5370 --- loss: 0.886926, loss_ss: 0.872131, loss_d: 0.014795
0.5754 --- loss: 0.889436, loss_ss: 0.831527, loss_d: 0.057909
0.6137 --- loss: 1.215372, loss_ss: 0.922050, loss_d: 0.293321
0.6521 --- loss: 1.041893, loss_ss: 1.028431, loss_d: 0.013461
0.6904 --- loss: 0.798586, loss_ss: 0.625498, loss_d: 0.173089
0.7288 --- loss: 0.977289, loss_ss: 0.956046, loss_d: 0.021243
0.7672 --- loss: 0.804139, loss_ss: 0.769304, loss_d: 0.034835
0.8055 --- loss: 0.721112, loss_ss: 0.658942, loss_d: 0.062170
0.8439 --- loss: 1.072049, loss_ss: 1.043057, loss_d: 0.028993
0.8822 --- loss: 1.160981, loss_ss: 1.151397, loss_d: 0.009583
0.9206 --- loss: 1.375818, loss_ss: 1.372108, loss_d: 0.003710
0.9590 --- loss: 0.698338, loss_ss: 0.673699, loss_d: 0.024639
0.9973 --- loss: 1.516875, loss_ss: 0.759477, loss_d: 0.757397
Epoch finished! Loss: 0.9518367531207892
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.102325, loss_ss: 0.945859, loss_d: 0.156467
0.0384 --- loss: 0.915178, loss_ss: 0.814660, loss_d: 0.100517
0.0767 --- loss: 0.964267, loss_ss: 0.870387, loss_d: 0.093880
0.1151 --- loss: 0.969178, loss_ss: 0.882588, loss_d: 0.086590
0.1534 --- loss: 1.013644, loss_ss: 0.619934, loss_d: 0.393711
0.1918 --- loss: 0.951021, loss_ss: 0.798867, loss_d: 0.152155
0.2301 --- loss: 0.962348, loss_ss: 0.906142, loss_d: 0.056206
0.2685 --- loss: 0.928206, loss_ss: 0.710131, loss_d: 0.218074
0.3069 --- loss: 0.985800, loss_ss: 0.725531, loss_d: 0.260269
0.3452 --- loss: 1.056598, loss_ss: 0.978944, loss_d: 0.077654
0.3836 --- loss: 0.901363, loss_ss: 0.819690, loss_d: 0.081672
0.4219 --- loss: 0.712469, loss_ss: 0.650771, loss_d: 0.061698
0.4603 --- loss: 0.930649, loss_ss: 0.838363, loss_d: 0.092287
0.4987 --- loss: 0.718325, loss_ss: 0.683541, loss_d: 0.034784
0.5370 --- loss: 0.832709, loss_ss: 0.823817, loss_d: 0.008892
0.5754 --- loss: 0.893216, loss_ss: 0.859801, loss_d: 0.033415
0.6137 --- loss: 1.213158, loss_ss: 1.090930, loss_d: 0.122227
0.6521 --- loss: 0.686955, loss_ss: 0.670671, loss_d: 0.016283
0.6904 --- loss: 1.346547, loss_ss: 0.815574, loss_d: 0.530973
0.7288 --- loss: 0.817864, loss_ss: 0.806381, loss_d: 0.011484
0.7672 --- loss: 1.559852, loss_ss: 0.676057, loss_d: 0.883796
0.8055 --- loss: 0.957389, loss_ss: 0.945519, loss_d: 0.011870
0.8439 --- loss: 0.643623, loss_ss: 0.570492, loss_d: 0.073131
0.8822 --- loss: 0.707981, loss_ss: 0.672780, loss_d: 0.035201
0.9206 --- loss: 0.608736, loss_ss: 0.572073, loss_d: 0.036664
0.9590 --- loss: 0.678147, loss_ss: 0.635064, loss_d: 0.043083
0.9973 --- loss: 0.904338, loss_ss: 0.862626, loss_d: 0.041711
Epoch finished! Loss: 0.9197533653332637
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8494623655913979
             precision    recall  f1-score   support

        0.0       1.00      1.00      1.00       240
        1.0       0.16      1.00      0.27         6
        2.0       0.87      0.81      0.84       439
        3.0       0.97      0.69      0.81       170
        4.0       0.58      0.95      0.72        75

avg / total       0.89      0.85      0.86       930
 


====== chc014-nsrr ======
    acc %   sen %  spec %   ppr %  f1-score
0  100.00  100.00  100.00  100.00    100.00
1   96.56  100.00   96.54   15.79     27.27
2   85.38   81.09   89.21   87.04     83.96
3   93.98   68.82   99.61   97.50     80.69
4   93.98   94.67   93.92   57.72     71.72
Total accuracy: 84.95%
Average sen: 88.92%
Average spec: 95.85%
Macro f1-score: 72.73%
Diagnosis acc on 15mins: 0.3225806451612903
[0.01950687 0.56526071 0.96702844 0.08742154 0.04668945 0.99675828
 0.32200658 0.2008737  0.7716341  0.9976908  0.99990332 0.99989974
 0.97449964 0.42758068 0.89340913 0.97575277 0.98841804 0.57722777
 0.6140759  0.35377392 0.43450162 0.9948855  0.97885495 0.99356836
 0.99330717 0.95303822 0.45925185 0.63985866 0.35297152 0.96177918
 0.9997409 ]
pred: 0.6948764304360074, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.504342, loss_ss: 1.839717, loss_d: 0.664626
0.0384 --- loss: 2.146983, loss_ss: 1.709982, loss_d: 0.437001
0.0767 --- loss: 2.165864, loss_ss: 1.522786, loss_d: 0.643078
0.1151 --- loss: 2.242458, loss_ss: 1.689238, loss_d: 0.553220
0.1534 --- loss: 1.997617, loss_ss: 1.512776, loss_d: 0.484840
0.1918 --- loss: 1.960714, loss_ss: 1.582064, loss_d: 0.378650
0.2301 --- loss: 1.961202, loss_ss: 1.504034, loss_d: 0.457168
0.2685 --- loss: 2.134719, loss_ss: 1.698098, loss_d: 0.436621
0.3069 --- loss: 2.171088, loss_ss: 1.529935, loss_d: 0.641154
0.3452 --- loss: 1.896262, loss_ss: 1.592225, loss_d: 0.304036
0.3836 --- loss: 2.271341, loss_ss: 1.657680, loss_d: 0.613661
0.4219 --- loss: 2.132388, loss_ss: 1.536569, loss_d: 0.595819
0.4603 --- loss: 2.139752, loss_ss: 1.466258, loss_d: 0.673494
0.4987 --- loss: 2.256423, loss_ss: 1.550337, loss_d: 0.706086
0.5370 --- loss: 1.951081, loss_ss: 1.518579, loss_d: 0.432502
0.5754 --- loss: 1.882229, loss_ss: 1.566131, loss_d: 0.316098
0.6137 --- loss: 2.269178, loss_ss: 1.508508, loss_d: 0.760670
0.6521 --- loss: 1.981750, loss_ss: 1.470739, loss_d: 0.511011
0.6904 --- loss: 1.931772, loss_ss: 1.453780, loss_d: 0.477992
0.7288 --- loss: 2.169633, loss_ss: 1.529737, loss_d: 0.639897
0.7672 --- loss: 1.861109, loss_ss: 1.481604, loss_d: 0.379505
0.8055 --- loss: 2.026129, loss_ss: 1.561455, loss_d: 0.464674
0.8439 --- loss: 2.064009, loss_ss: 1.582126, loss_d: 0.481884
0.8822 --- loss: 1.896960, loss_ss: 1.353633, loss_d: 0.543327
0.9206 --- loss: 1.748127, loss_ss: 1.471358, loss_d: 0.276769
0.9590 --- loss: 1.862657, loss_ss: 1.474740, loss_d: 0.387917
0.9973 --- loss: 1.669811, loss_ss: 1.362004, loss_d: 0.307808
Epoch finished! Loss: 2.0807142541958736
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.146118, loss_ss: 1.395650, loss_d: 0.750467
0.0384 --- loss: 1.781628, loss_ss: 1.367679, loss_d: 0.413950
0.0767 --- loss: 1.701521, loss_ss: 1.425780, loss_d: 0.275742
0.1151 --- loss: 1.698929, loss_ss: 1.333118, loss_d: 0.365810
0.1534 --- loss: 1.458998, loss_ss: 1.307737, loss_d: 0.151261
0.1918 --- loss: 1.680616, loss_ss: 1.347900, loss_d: 0.332716
0.2301 --- loss: 2.050768, loss_ss: 1.381781, loss_d: 0.668987
0.2685 --- loss: 1.802836, loss_ss: 1.243066, loss_d: 0.559770
0.3069 --- loss: 1.837800, loss_ss: 1.398344, loss_d: 0.439456
0.3452 --- loss: 1.666749, loss_ss: 1.254005, loss_d: 0.412744
0.3836 --- loss: 1.527090, loss_ss: 1.179390, loss_d: 0.347700
0.4219 --- loss: 1.804434, loss_ss: 1.359905, loss_d: 0.444528
0.4603 --- loss: 1.768468, loss_ss: 1.306762, loss_d: 0.461706
0.4987 --- loss: 1.823101, loss_ss: 1.342916, loss_d: 0.480186
0.5370 --- loss: 1.557885, loss_ss: 1.172034, loss_d: 0.385851
0.5754 --- loss: 1.926357, loss_ss: 1.140782, loss_d: 0.785575
0.6137 --- loss: 1.557539, loss_ss: 1.309561, loss_d: 0.247978
0.6521 --- loss: 1.574952, loss_ss: 1.150795, loss_d: 0.424157
0.6904 --- loss: 1.718455, loss_ss: 1.186970, loss_d: 0.531484
0.7288 --- loss: 1.587224, loss_ss: 1.166209, loss_d: 0.421016
0.7672 --- loss: 1.597185, loss_ss: 1.229762, loss_d: 0.367423
0.8055 --- loss: 1.288573, loss_ss: 1.141696, loss_d: 0.146876
0.8439 --- loss: 1.186519, loss_ss: 1.056814, loss_d: 0.129705
0.8822 --- loss: 1.530740, loss_ss: 1.180929, loss_d: 0.349811
0.9206 --- loss: 1.828079, loss_ss: 1.401222, loss_d: 0.426858
0.9590 --- loss: 1.263755, loss_ss: 1.006460, loss_d: 0.257295
0.9973 --- loss: 1.836182, loss_ss: 1.056949, loss_d: 0.779233
Epoch finished! Loss: 1.6339998932985158
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.297175, loss_ss: 1.135257, loss_d: 0.161918
0.0384 --- loss: 1.510661, loss_ss: 1.046318, loss_d: 0.464343
0.0767 --- loss: 1.434253, loss_ss: 1.105388, loss_d: 0.328864
0.1151 --- loss: 1.343164, loss_ss: 1.117672, loss_d: 0.225492
0.1534 --- loss: 1.244385, loss_ss: 1.106137, loss_d: 0.138248
0.1918 --- loss: 1.209002, loss_ss: 1.098047, loss_d: 0.110955
0.2301 --- loss: 0.975871, loss_ss: 0.905756, loss_d: 0.070115
0.2685 --- loss: 1.318771, loss_ss: 1.243099, loss_d: 0.075672
0.3069 --- loss: 1.573615, loss_ss: 1.225375, loss_d: 0.348240
0.3452 --- loss: 1.187436, loss_ss: 1.029718, loss_d: 0.157718
0.3836 --- loss: 1.310403, loss_ss: 0.986299, loss_d: 0.324103
0.4219 --- loss: 1.362864, loss_ss: 0.985569, loss_d: 0.377295
0.4603 --- loss: 1.352584, loss_ss: 1.215772, loss_d: 0.136812
0.4987 --- loss: 1.469946, loss_ss: 1.009166, loss_d: 0.460780
0.5370 --- loss: 1.017417, loss_ss: 0.945130, loss_d: 0.072287
0.5754 --- loss: 1.242972, loss_ss: 1.039866, loss_d: 0.203107
0.6137 --- loss: 1.117983, loss_ss: 0.923956, loss_d: 0.194026
0.6521 --- loss: 1.420726, loss_ss: 1.164853, loss_d: 0.255873
0.6904 --- loss: 1.169326, loss_ss: 1.109919, loss_d: 0.059407
0.7288 --- loss: 1.413432, loss_ss: 1.273630, loss_d: 0.139801
0.7672 --- loss: 1.124733, loss_ss: 0.916458, loss_d: 0.208276
0.8055 --- loss: 1.177995, loss_ss: 0.998633, loss_d: 0.179362
0.8439 --- loss: 1.339416, loss_ss: 0.947536, loss_d: 0.391880
0.8822 --- loss: 1.298039, loss_ss: 0.999821, loss_d: 0.298217
0.9206 --- loss: 1.327161, loss_ss: 1.063754, loss_d: 0.263407
0.9590 --- loss: 1.528039, loss_ss: 1.266853, loss_d: 0.261186
0.9973 --- loss: 1.562807, loss_ss: 1.027964, loss_d: 0.534844
Epoch finished! Loss: 1.3690071750145691
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.570673, loss_ss: 1.156082, loss_d: 0.414591
0.0384 --- loss: 1.466920, loss_ss: 1.117314, loss_d: 0.349606
0.0767 --- loss: 1.438827, loss_ss: 1.006960, loss_d: 0.431868
0.1151 --- loss: 1.270955, loss_ss: 0.939081, loss_d: 0.331874
0.1534 --- loss: 1.142293, loss_ss: 0.782225, loss_d: 0.360069
0.1918 --- loss: 1.035534, loss_ss: 0.884267, loss_d: 0.151267
0.2301 --- loss: 1.529302, loss_ss: 1.038811, loss_d: 0.490491
0.2685 --- loss: 1.322665, loss_ss: 1.050284, loss_d: 0.272380
0.3069 --- loss: 1.063321, loss_ss: 0.874863, loss_d: 0.188458
0.3452 --- loss: 0.972742, loss_ss: 0.831130, loss_d: 0.141612
0.3836 --- loss: 1.030005, loss_ss: 0.789166, loss_d: 0.240840
0.4219 --- loss: 1.332052, loss_ss: 0.884771, loss_d: 0.447281
0.4603 --- loss: 1.054925, loss_ss: 0.849712, loss_d: 0.205213
0.4987 --- loss: 1.166899, loss_ss: 0.950641, loss_d: 0.216257
0.5370 --- loss: 1.442266, loss_ss: 1.220948, loss_d: 0.221318
0.5754 --- loss: 1.687210, loss_ss: 1.188216, loss_d: 0.498994
0.6137 --- loss: 1.047721, loss_ss: 0.949868, loss_d: 0.097853
0.6521 --- loss: 1.294818, loss_ss: 0.870264, loss_d: 0.424554
0.6904 --- loss: 0.920535, loss_ss: 0.746901, loss_d: 0.173634
0.7288 --- loss: 1.431403, loss_ss: 1.277692, loss_d: 0.153711
0.7672 --- loss: 1.495509, loss_ss: 0.869313, loss_d: 0.626197
0.8055 --- loss: 1.057527, loss_ss: 0.927186, loss_d: 0.130341
0.8439 --- loss: 1.078539, loss_ss: 0.781276, loss_d: 0.297263
0.8822 --- loss: 1.142583, loss_ss: 1.068685, loss_d: 0.073899
0.9206 --- loss: 1.259403, loss_ss: 1.139975, loss_d: 0.119429
0.9590 --- loss: 0.972753, loss_ss: 0.827253, loss_d: 0.145500
0.9973 --- loss: 1.167923, loss_ss: 1.070156, loss_d: 0.097767
Epoch finished! Loss: 1.2076306776358532
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.821083, loss_ss: 0.754186, loss_d: 0.066896
0.0384 --- loss: 1.176301, loss_ss: 0.925869, loss_d: 0.250432
0.0767 --- loss: 0.948268, loss_ss: 0.871610, loss_d: 0.076658
0.1151 --- loss: 1.056803, loss_ss: 1.011571, loss_d: 0.045232
0.1534 --- loss: 1.504985, loss_ss: 1.352425, loss_d: 0.152560
0.1918 --- loss: 1.274644, loss_ss: 1.070912, loss_d: 0.203732
0.2301 --- loss: 1.367231, loss_ss: 0.939305, loss_d: 0.427926
0.2685 --- loss: 0.945941, loss_ss: 0.809149, loss_d: 0.136792
0.3069 --- loss: 1.056659, loss_ss: 0.881448, loss_d: 0.175211
0.3452 --- loss: 0.806826, loss_ss: 0.762187, loss_d: 0.044639
0.3836 --- loss: 0.958296, loss_ss: 0.923395, loss_d: 0.034901
0.4219 --- loss: 1.149253, loss_ss: 0.722430, loss_d: 0.426822
0.4603 --- loss: 0.956845, loss_ss: 0.892785, loss_d: 0.064060
0.4987 --- loss: 0.953349, loss_ss: 0.924148, loss_d: 0.029201
0.5370 --- loss: 1.009959, loss_ss: 0.909786, loss_d: 0.100173
0.5754 --- loss: 0.830677, loss_ss: 0.791107, loss_d: 0.039570
0.6137 --- loss: 1.121257, loss_ss: 0.840321, loss_d: 0.280936
0.6521 --- loss: 1.037773, loss_ss: 0.992674, loss_d: 0.045099
0.6904 --- loss: 1.270494, loss_ss: 1.008686, loss_d: 0.261808
0.7288 --- loss: 1.103588, loss_ss: 1.090580, loss_d: 0.013009
0.7672 --- loss: 0.978878, loss_ss: 0.907586, loss_d: 0.071292
0.8055 --- loss: 1.363777, loss_ss: 0.903276, loss_d: 0.460501
0.8439 --- loss: 0.708919, loss_ss: 0.634823, loss_d: 0.074096
0.8822 --- loss: 0.759729, loss_ss: 0.647547, loss_d: 0.112182
0.9206 --- loss: 1.612910, loss_ss: 1.430359, loss_d: 0.182551
0.9590 --- loss: 1.322314, loss_ss: 1.246195, loss_d: 0.076119
0.9973 --- loss: 1.276146, loss_ss: 1.060889, loss_d: 0.215257
Epoch finished! Loss: 1.1037490798876837
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.939582, loss_ss: 0.744224, loss_d: 0.195358
0.0384 --- loss: 1.196948, loss_ss: 0.829614, loss_d: 0.367334
0.0767 --- loss: 0.964947, loss_ss: 0.916704, loss_d: 0.048243
0.1151 --- loss: 1.089437, loss_ss: 0.688715, loss_d: 0.400721
0.1534 --- loss: 0.894165, loss_ss: 0.832194, loss_d: 0.061971
0.1918 --- loss: 1.070298, loss_ss: 1.032636, loss_d: 0.037662
0.2301 --- loss: 1.503546, loss_ss: 1.286874, loss_d: 0.216672
0.2685 --- loss: 1.423561, loss_ss: 1.201618, loss_d: 0.221943
0.3069 --- loss: 1.081468, loss_ss: 0.936609, loss_d: 0.144860
0.3452 --- loss: 0.739509, loss_ss: 0.684715, loss_d: 0.054794
0.3836 --- loss: 0.967837, loss_ss: 0.956920, loss_d: 0.010917
0.4219 --- loss: 1.036285, loss_ss: 0.944421, loss_d: 0.091864
0.4603 --- loss: 0.923722, loss_ss: 0.894764, loss_d: 0.028959
0.4987 --- loss: 0.816766, loss_ss: 0.777800, loss_d: 0.038966
0.5370 --- loss: 1.127848, loss_ss: 0.958766, loss_d: 0.169082
0.5754 --- loss: 1.034758, loss_ss: 1.024609, loss_d: 0.010150
0.6137 --- loss: 1.210585, loss_ss: 0.865761, loss_d: 0.344824
0.6521 --- loss: 0.886047, loss_ss: 0.870748, loss_d: 0.015299
0.6904 --- loss: 1.103987, loss_ss: 1.000277, loss_d: 0.103710
0.7288 --- loss: 1.196903, loss_ss: 0.803262, loss_d: 0.393641
0.7672 --- loss: 0.965195, loss_ss: 0.788877, loss_d: 0.176318
0.8055 --- loss: 0.932922, loss_ss: 0.846793, loss_d: 0.086129
0.8439 --- loss: 1.269861, loss_ss: 0.771548, loss_d: 0.498313
0.8822 --- loss: 1.058702, loss_ss: 0.998085, loss_d: 0.060618
0.9206 --- loss: 0.705227, loss_ss: 0.668536, loss_d: 0.036690
0.9590 --- loss: 1.055480, loss_ss: 0.786411, loss_d: 0.269068
0.9973 --- loss: 0.729813, loss_ss: 0.657689, loss_d: 0.072124
Epoch finished! Loss: 1.068300503721604
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.066659, loss_ss: 0.931546, loss_d: 0.135114
0.0384 --- loss: 0.920141, loss_ss: 0.780292, loss_d: 0.139849
0.0767 --- loss: 1.100423, loss_ss: 1.079835, loss_d: 0.020588
0.1151 --- loss: 1.114640, loss_ss: 1.103377, loss_d: 0.011263
0.1534 --- loss: 1.068789, loss_ss: 1.035854, loss_d: 0.032936
0.1918 --- loss: 0.903234, loss_ss: 0.830313, loss_d: 0.072921
0.2301 --- loss: 0.750603, loss_ss: 0.637906, loss_d: 0.112697
0.2685 --- loss: 1.304768, loss_ss: 1.049148, loss_d: 0.255620
0.3069 --- loss: 0.884525, loss_ss: 0.814644, loss_d: 0.069881
0.3452 --- loss: 0.914445, loss_ss: 0.788613, loss_d: 0.125832
0.3836 --- loss: 1.469975, loss_ss: 1.430403, loss_d: 0.039572
0.4219 --- loss: 0.985518, loss_ss: 0.920346, loss_d: 0.065172
0.4603 --- loss: 1.179440, loss_ss: 1.073461, loss_d: 0.105978
0.4987 --- loss: 0.762662, loss_ss: 0.676564, loss_d: 0.086098
0.5370 --- loss: 0.619860, loss_ss: 0.599079, loss_d: 0.020781
0.5754 --- loss: 0.914439, loss_ss: 0.873463, loss_d: 0.040977
0.6137 --- loss: 1.071723, loss_ss: 0.992375, loss_d: 0.079347
0.6521 --- loss: 0.675999, loss_ss: 0.631131, loss_d: 0.044867
0.6904 --- loss: 1.112599, loss_ss: 1.108546, loss_d: 0.004053
0.7288 --- loss: 0.707877, loss_ss: 0.638186, loss_d: 0.069692
0.7672 --- loss: 0.860383, loss_ss: 0.835824, loss_d: 0.024558
0.8055 --- loss: 1.306205, loss_ss: 0.712767, loss_d: 0.593438
0.8439 --- loss: 1.160303, loss_ss: 0.875541, loss_d: 0.284761
0.8822 --- loss: 1.423301, loss_ss: 0.836601, loss_d: 0.586701
0.9206 --- loss: 0.795906, loss_ss: 0.727349, loss_d: 0.068556
0.9590 --- loss: 1.042817, loss_ss: 0.786410, loss_d: 0.256407
0.9973 --- loss: 0.619114, loss_ss: 0.521777, loss_d: 0.097336
Epoch finished! Loss: 0.9846561459394602
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.071392, loss_ss: 0.853826, loss_d: 0.217566
0.0384 --- loss: 0.861054, loss_ss: 0.643263, loss_d: 0.217791
0.0767 --- loss: 1.007868, loss_ss: 0.984287, loss_d: 0.023581
0.1151 --- loss: 0.707287, loss_ss: 0.673096, loss_d: 0.034190
0.1534 --- loss: 1.326964, loss_ss: 0.920023, loss_d: 0.406942
0.1918 --- loss: 0.897349, loss_ss: 0.858182, loss_d: 0.039167
0.2301 --- loss: 0.780256, loss_ss: 0.707793, loss_d: 0.072463
0.2685 --- loss: 1.024300, loss_ss: 0.822905, loss_d: 0.201395
0.3069 --- loss: 1.041435, loss_ss: 0.952347, loss_d: 0.089088
0.3452 --- loss: 1.116349, loss_ss: 0.764864, loss_d: 0.351485
0.3836 --- loss: 1.004661, loss_ss: 0.852145, loss_d: 0.152517
0.4219 --- loss: 0.764146, loss_ss: 0.631679, loss_d: 0.132466
0.4603 --- loss: 0.952914, loss_ss: 0.924042, loss_d: 0.028872
0.4987 --- loss: 1.187998, loss_ss: 1.170005, loss_d: 0.017993
0.5370 --- loss: 0.894283, loss_ss: 0.838729, loss_d: 0.055554
0.5754 --- loss: 0.632536, loss_ss: 0.624409, loss_d: 0.008127
0.6137 --- loss: 0.899993, loss_ss: 0.894769, loss_d: 0.005225
0.6521 --- loss: 0.682132, loss_ss: 0.582318, loss_d: 0.099815
0.6904 --- loss: 0.679485, loss_ss: 0.662183, loss_d: 0.017302
0.7288 --- loss: 0.756414, loss_ss: 0.690200, loss_d: 0.066214
0.7672 --- loss: 0.726572, loss_ss: 0.599833, loss_d: 0.126739
0.8055 --- loss: 1.115979, loss_ss: 0.829715, loss_d: 0.286263
0.8439 --- loss: 0.926234, loss_ss: 0.709702, loss_d: 0.216532
0.8822 --- loss: 0.632192, loss_ss: 0.535865, loss_d: 0.096327
0.9206 --- loss: 1.410842, loss_ss: 0.844036, loss_d: 0.566806
0.9590 --- loss: 0.631095, loss_ss: 0.593324, loss_d: 0.037770
0.9973 --- loss: 2.337894, loss_ss: 1.069562, loss_d: 1.268333
Epoch finished! Loss: 0.9561692713544919
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.692755, loss_ss: 0.664529, loss_d: 0.028226
0.0384 --- loss: 1.003959, loss_ss: 0.776797, loss_d: 0.227162
0.0767 --- loss: 0.934398, loss_ss: 0.883764, loss_d: 0.050634
0.1151 --- loss: 0.864996, loss_ss: 0.841726, loss_d: 0.023270
0.1534 --- loss: 1.546726, loss_ss: 1.020917, loss_d: 0.525809
0.1918 --- loss: 0.964199, loss_ss: 0.920744, loss_d: 0.043455
0.2301 --- loss: 1.044720, loss_ss: 0.956332, loss_d: 0.088388
0.2685 --- loss: 1.243545, loss_ss: 1.192846, loss_d: 0.050699
0.3069 --- loss: 0.602820, loss_ss: 0.567328, loss_d: 0.035491
0.3452 --- loss: 1.171969, loss_ss: 0.917383, loss_d: 0.254586
0.3836 --- loss: 0.913631, loss_ss: 0.868609, loss_d: 0.045022
0.4219 --- loss: 0.981368, loss_ss: 0.786903, loss_d: 0.194466
0.4603 --- loss: 0.588581, loss_ss: 0.563697, loss_d: 0.024884
0.4987 --- loss: 0.951929, loss_ss: 0.910688, loss_d: 0.041241
0.5370 --- loss: 0.715174, loss_ss: 0.693981, loss_d: 0.021193
0.5754 --- loss: 0.731015, loss_ss: 0.645457, loss_d: 0.085558
0.6137 --- loss: 0.995086, loss_ss: 0.989588, loss_d: 0.005498
0.6521 --- loss: 0.915341, loss_ss: 0.911083, loss_d: 0.004258
0.6904 --- loss: 0.666576, loss_ss: 0.645896, loss_d: 0.020680
0.7288 --- loss: 0.846794, loss_ss: 0.818806, loss_d: 0.027988
0.7672 --- loss: 0.826756, loss_ss: 0.811583, loss_d: 0.015173
0.8055 --- loss: 1.004580, loss_ss: 0.691143, loss_d: 0.313436
0.8439 --- loss: 1.070780, loss_ss: 1.024726, loss_d: 0.046054
0.8822 --- loss: 0.952712, loss_ss: 0.604391, loss_d: 0.348321
0.9206 --- loss: 0.932524, loss_ss: 0.835081, loss_d: 0.097444
0.9590 --- loss: 1.311683, loss_ss: 0.722096, loss_d: 0.589587
0.9973 --- loss: 2.367666, loss_ss: 0.729709, loss_d: 1.637957
Epoch finished! Loss: 0.9564242649536866
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.111503, loss_ss: 0.743207, loss_d: 0.368296
0.0384 --- loss: 1.250779, loss_ss: 1.035559, loss_d: 0.215220
0.0767 --- loss: 1.380824, loss_ss: 0.639348, loss_d: 0.741476
0.1151 --- loss: 0.786373, loss_ss: 0.659642, loss_d: 0.126731
0.1534 --- loss: 0.973714, loss_ss: 0.964545, loss_d: 0.009169
0.1918 --- loss: 0.696531, loss_ss: 0.686630, loss_d: 0.009901
0.2301 --- loss: 0.702727, loss_ss: 0.685455, loss_d: 0.017273
0.2685 --- loss: 0.823788, loss_ss: 0.777171, loss_d: 0.046616
0.3069 --- loss: 1.078670, loss_ss: 1.045635, loss_d: 0.033034
0.3452 --- loss: 0.706948, loss_ss: 0.694976, loss_d: 0.011972
0.3836 --- loss: 0.996210, loss_ss: 0.878866, loss_d: 0.117344
0.4219 --- loss: 0.876183, loss_ss: 0.821375, loss_d: 0.054808
0.4603 --- loss: 0.800813, loss_ss: 0.783456, loss_d: 0.017357
0.4987 --- loss: 1.104743, loss_ss: 1.015308, loss_d: 0.089435
0.5370 --- loss: 0.999451, loss_ss: 0.963173, loss_d: 0.036277
0.5754 --- loss: 0.965576, loss_ss: 0.941654, loss_d: 0.023922
0.6137 --- loss: 0.707076, loss_ss: 0.648651, loss_d: 0.058425
0.6521 --- loss: 0.760119, loss_ss: 0.755938, loss_d: 0.004181
0.6904 --- loss: 0.922547, loss_ss: 0.855611, loss_d: 0.066936
0.7288 --- loss: 1.169996, loss_ss: 0.729110, loss_d: 0.440886
0.7672 --- loss: 0.613715, loss_ss: 0.612486, loss_d: 0.001229
0.8055 --- loss: 1.080022, loss_ss: 1.077265, loss_d: 0.002757
0.8439 --- loss: 0.860423, loss_ss: 0.799743, loss_d: 0.060680
0.8822 --- loss: 0.820957, loss_ss: 0.731611, loss_d: 0.089346
0.9206 --- loss: 0.758802, loss_ss: 0.733539, loss_d: 0.025263
0.9590 --- loss: 0.759122, loss_ss: 0.729391, loss_d: 0.029732
0.9973 --- loss: 0.852190, loss_ss: 0.846415, loss_d: 0.005775
Epoch finished! Loss: 0.9048143986325997
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8397849462365592
             precision    recall  f1-score   support

        0.0       0.97      0.74      0.84        38
        1.0       1.00      0.06      0.11        83
        2.0       0.80      0.95      0.87       502
        3.0       0.88      1.00      0.94       166
        4.0       0.92      0.76      0.83       141

avg / total       0.86      0.84      0.81       930
 


====== chc015-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  98.82   73.68   99.89   96.55     83.58
1  91.61    6.02  100.00  100.00     11.36
2  84.52   94.62   72.66   80.24     86.84
3  97.63  100.00   97.12   88.30     93.79
4  95.38   75.89   98.86   92.24     83.27
Total accuracy: 83.98%
Average sen: 70.04%
Average spec: 93.71%
Macro f1-score: 71.77%
Diagnosis acc on 15mins: 0.7741935483870968
[0.01416011 0.55404031 0.49876803 0.08227059 0.19119324 0.05588539
 0.30578971 0.51611108 0.12109027 0.08854004 0.07306834 0.01737118
 0.0065513  0.02092348 0.29943067 0.10011169 0.03886509 0.00330748
 0.18783075 0.45524251 0.11445779 0.0293882  0.00404002 0.28408936
 0.20665233 0.89573163 0.87328273 0.84292173 0.37510082 0.54401034
 0.82092267]
pred: 0.27810157660485035, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.434850, loss_ss: 1.728561, loss_d: 0.706289
0.0384 --- loss: 2.143425, loss_ss: 1.522306, loss_d: 0.621119
0.0767 --- loss: 2.126873, loss_ss: 1.431567, loss_d: 0.695306
0.1151 --- loss: 2.289855, loss_ss: 1.518501, loss_d: 0.771354
0.1534 --- loss: 2.103412, loss_ss: 1.570889, loss_d: 0.532523
0.1918 --- loss: 2.127978, loss_ss: 1.431478, loss_d: 0.696499
0.2301 --- loss: 1.913224, loss_ss: 1.456140, loss_d: 0.457084
0.2685 --- loss: 1.955086, loss_ss: 1.451664, loss_d: 0.503421
0.3069 --- loss: 2.033645, loss_ss: 1.415129, loss_d: 0.618516
0.3452 --- loss: 2.385899, loss_ss: 1.470739, loss_d: 0.915160
0.3836 --- loss: 1.827890, loss_ss: 1.477597, loss_d: 0.350293
0.4219 --- loss: 2.161688, loss_ss: 1.396078, loss_d: 0.765610
0.4603 --- loss: 2.084243, loss_ss: 1.496296, loss_d: 0.587947
0.4987 --- loss: 1.896816, loss_ss: 1.258418, loss_d: 0.638397
0.5370 --- loss: 1.977657, loss_ss: 1.334928, loss_d: 0.642729
0.5754 --- loss: 2.005838, loss_ss: 1.542057, loss_d: 0.463781
0.6137 --- loss: 1.808392, loss_ss: 1.431305, loss_d: 0.377087
0.6521 --- loss: 2.055010, loss_ss: 1.337725, loss_d: 0.717285
0.6904 --- loss: 1.975527, loss_ss: 1.507244, loss_d: 0.468283
0.7288 --- loss: 2.148623, loss_ss: 1.282649, loss_d: 0.865974
0.7672 --- loss: 1.608941, loss_ss: 1.262321, loss_d: 0.346621
0.8055 --- loss: 2.830142, loss_ss: 1.182617, loss_d: 1.647525
0.8439 --- loss: 1.598388, loss_ss: 1.262481, loss_d: 0.335907
0.8822 --- loss: 1.796152, loss_ss: 1.257729, loss_d: 0.538424
0.9206 --- loss: 1.506390, loss_ss: 1.209384, loss_d: 0.297006
0.9590 --- loss: 1.694721, loss_ss: 1.276146, loss_d: 0.418575
0.9973 --- loss: 1.982880, loss_ss: 1.277321, loss_d: 0.705559
Epoch finished! Loss: 1.9226536778303294
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.403509, loss_ss: 1.151750, loss_d: 0.251758
0.0384 --- loss: 1.757147, loss_ss: 1.361256, loss_d: 0.395891
0.0767 --- loss: 1.561583, loss_ss: 1.202565, loss_d: 0.359018
0.1151 --- loss: 1.509889, loss_ss: 1.300586, loss_d: 0.209303
0.1534 --- loss: 1.700566, loss_ss: 1.252420, loss_d: 0.448146
0.1918 --- loss: 1.568549, loss_ss: 0.997795, loss_d: 0.570754
0.2301 --- loss: 1.261803, loss_ss: 1.186015, loss_d: 0.075788
0.2685 --- loss: 1.455714, loss_ss: 1.163047, loss_d: 0.292668
0.3069 --- loss: 1.431867, loss_ss: 1.198637, loss_d: 0.233229
0.3452 --- loss: 1.659032, loss_ss: 1.258611, loss_d: 0.400421
0.3836 --- loss: 1.898432, loss_ss: 1.729609, loss_d: 0.168823
0.4219 --- loss: 1.547963, loss_ss: 1.199944, loss_d: 0.348019
0.4603 --- loss: 2.007083, loss_ss: 1.189874, loss_d: 0.817209
0.4987 --- loss: 1.549501, loss_ss: 1.178442, loss_d: 0.371059
0.5370 --- loss: 1.170183, loss_ss: 1.074485, loss_d: 0.095697
0.5754 --- loss: 1.690624, loss_ss: 1.215268, loss_d: 0.475355
0.6137 --- loss: 1.760262, loss_ss: 1.288044, loss_d: 0.472219
0.6521 --- loss: 1.412561, loss_ss: 1.138993, loss_d: 0.273567
0.6904 --- loss: 1.439549, loss_ss: 1.194519, loss_d: 0.245031
0.7288 --- loss: 1.629911, loss_ss: 1.271840, loss_d: 0.358071
0.7672 --- loss: 1.224067, loss_ss: 1.038984, loss_d: 0.185083
0.8055 --- loss: 1.566599, loss_ss: 1.051728, loss_d: 0.514870
0.8439 --- loss: 1.482393, loss_ss: 1.098818, loss_d: 0.383575
0.8822 --- loss: 1.309975, loss_ss: 1.146374, loss_d: 0.163602
0.9206 --- loss: 2.372730, loss_ss: 1.671847, loss_d: 0.700883
0.9590 --- loss: 1.308035, loss_ss: 0.838981, loss_d: 0.469054
0.9973 --- loss: 1.046646, loss_ss: 0.838882, loss_d: 0.207764
Epoch finished! Loss: 1.4966181512062366
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.380241, loss_ss: 1.107057, loss_d: 0.273183
0.0384 --- loss: 1.216817, loss_ss: 0.876147, loss_d: 0.340670
0.0767 --- loss: 2.245078, loss_ss: 1.079442, loss_d: 1.165636
0.1151 --- loss: 1.452732, loss_ss: 1.197427, loss_d: 0.255305
0.1534 --- loss: 1.305298, loss_ss: 1.093144, loss_d: 0.212154
0.1918 --- loss: 0.990349, loss_ss: 0.799481, loss_d: 0.190868
0.2301 --- loss: 0.984937, loss_ss: 0.912010, loss_d: 0.072926
0.2685 --- loss: 1.349966, loss_ss: 1.144720, loss_d: 0.205246
0.3069 --- loss: 1.083891, loss_ss: 0.975312, loss_d: 0.108579
0.3452 --- loss: 1.002112, loss_ss: 0.923007, loss_d: 0.079105
0.3836 --- loss: 1.010010, loss_ss: 0.855260, loss_d: 0.154751
0.4219 --- loss: 1.208485, loss_ss: 0.907403, loss_d: 0.301082
0.4603 --- loss: 1.223306, loss_ss: 0.984173, loss_d: 0.239133
0.4987 --- loss: 1.005872, loss_ss: 0.807178, loss_d: 0.198695
0.5370 --- loss: 0.912234, loss_ss: 0.833422, loss_d: 0.078813
0.5754 --- loss: 1.072271, loss_ss: 0.936596, loss_d: 0.135675
0.6137 --- loss: 1.019641, loss_ss: 0.871848, loss_d: 0.147793
0.6521 --- loss: 0.905466, loss_ss: 0.821024, loss_d: 0.084443
0.6904 --- loss: 1.161855, loss_ss: 0.929235, loss_d: 0.232620
0.7288 --- loss: 1.300200, loss_ss: 1.106441, loss_d: 0.193759
0.7672 --- loss: 1.257662, loss_ss: 0.974806, loss_d: 0.282856
0.8055 --- loss: 1.170049, loss_ss: 0.949285, loss_d: 0.220764
0.8439 --- loss: 1.081533, loss_ss: 0.982275, loss_d: 0.099257
0.8822 --- loss: 1.401520, loss_ss: 1.094940, loss_d: 0.306580
0.9206 --- loss: 1.199914, loss_ss: 0.985361, loss_d: 0.214553
0.9590 --- loss: 1.222657, loss_ss: 1.012158, loss_d: 0.210498
0.9973 --- loss: 1.648606, loss_ss: 1.412696, loss_d: 0.235911
Epoch finished! Loss: 1.3160422471853404
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.259415, loss_ss: 1.164034, loss_d: 0.095381
0.0384 --- loss: 1.113697, loss_ss: 0.711201, loss_d: 0.402496
0.0767 --- loss: 0.978010, loss_ss: 0.864210, loss_d: 0.113800
0.1151 --- loss: 1.193441, loss_ss: 0.947538, loss_d: 0.245903
0.1534 --- loss: 0.921874, loss_ss: 0.763949, loss_d: 0.157925
0.1918 --- loss: 1.166385, loss_ss: 0.938117, loss_d: 0.228268
0.2301 --- loss: 1.070612, loss_ss: 0.782862, loss_d: 0.287750
0.2685 --- loss: 1.331059, loss_ss: 0.990484, loss_d: 0.340575
0.3069 --- loss: 1.175796, loss_ss: 1.000023, loss_d: 0.175773
0.3452 --- loss: 1.039181, loss_ss: 0.741892, loss_d: 0.297289
0.3836 --- loss: 1.063203, loss_ss: 1.013205, loss_d: 0.049998
0.4219 --- loss: 1.034451, loss_ss: 0.764395, loss_d: 0.270056
0.4603 --- loss: 1.180119, loss_ss: 0.966288, loss_d: 0.213830
0.4987 --- loss: 1.283417, loss_ss: 1.052611, loss_d: 0.230806
0.5370 --- loss: 1.130589, loss_ss: 1.003680, loss_d: 0.126908
0.5754 --- loss: 0.919942, loss_ss: 0.826438, loss_d: 0.093504
0.6137 --- loss: 1.076690, loss_ss: 0.879142, loss_d: 0.197549
0.6521 --- loss: 0.795752, loss_ss: 0.622327, loss_d: 0.173425
0.6904 --- loss: 1.102494, loss_ss: 1.017210, loss_d: 0.085283
0.7288 --- loss: 1.058717, loss_ss: 0.733955, loss_d: 0.324761
0.7672 --- loss: 0.705482, loss_ss: 0.639753, loss_d: 0.065729
0.8055 --- loss: 0.947604, loss_ss: 0.802772, loss_d: 0.144832
0.8439 --- loss: 0.903005, loss_ss: 0.685317, loss_d: 0.217688
0.8822 --- loss: 1.071599, loss_ss: 0.721205, loss_d: 0.350394
0.9206 --- loss: 1.294711, loss_ss: 0.947280, loss_d: 0.347431
0.9590 --- loss: 0.721594, loss_ss: 0.686823, loss_d: 0.034771
0.9973 --- loss: 1.048112, loss_ss: 0.880133, loss_d: 0.167979
Epoch finished! Loss: 1.1984581048672016
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.086715, loss_ss: 0.918324, loss_d: 0.168391
0.0384 --- loss: 1.086526, loss_ss: 1.001953, loss_d: 0.084573
0.0767 --- loss: 0.940727, loss_ss: 0.827127, loss_d: 0.113601
0.1151 --- loss: 1.502300, loss_ss: 1.419368, loss_d: 0.082932
0.1534 --- loss: 1.030732, loss_ss: 0.926465, loss_d: 0.104267
0.1918 --- loss: 0.978839, loss_ss: 0.786737, loss_d: 0.192102
0.2301 --- loss: 1.077683, loss_ss: 0.882488, loss_d: 0.195194
0.2685 --- loss: 0.974829, loss_ss: 0.877479, loss_d: 0.097350
0.3069 --- loss: 1.148170, loss_ss: 1.000528, loss_d: 0.147642
0.3452 --- loss: 1.368046, loss_ss: 1.196443, loss_d: 0.171603
0.3836 --- loss: 1.087815, loss_ss: 0.866435, loss_d: 0.221380
0.4219 --- loss: 1.121624, loss_ss: 0.984657, loss_d: 0.136967
0.4603 --- loss: 1.007643, loss_ss: 0.953254, loss_d: 0.054389
0.4987 --- loss: 0.908252, loss_ss: 0.809400, loss_d: 0.098852
0.5370 --- loss: 1.099874, loss_ss: 1.072685, loss_d: 0.027189
0.5754 --- loss: 0.967274, loss_ss: 0.921306, loss_d: 0.045968
0.6137 --- loss: 0.867351, loss_ss: 0.819666, loss_d: 0.047685
0.6521 --- loss: 1.324509, loss_ss: 1.252380, loss_d: 0.072129
0.6904 --- loss: 0.998426, loss_ss: 0.979449, loss_d: 0.018977
0.7288 --- loss: 1.056068, loss_ss: 0.973864, loss_d: 0.082203
0.7672 --- loss: 0.797643, loss_ss: 0.723718, loss_d: 0.073925
0.8055 --- loss: 0.980911, loss_ss: 0.906612, loss_d: 0.074299
0.8439 --- loss: 1.270656, loss_ss: 0.900681, loss_d: 0.369975
0.8822 --- loss: 1.147363, loss_ss: 1.034000, loss_d: 0.113363
0.9206 --- loss: 0.818802, loss_ss: 0.700936, loss_d: 0.117866
0.9590 --- loss: 1.854429, loss_ss: 0.876848, loss_d: 0.977581
0.9973 --- loss: 1.261564, loss_ss: 0.884992, loss_d: 0.376573
Epoch finished! Loss: 1.1320692160954842
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.910765, loss_ss: 0.823973, loss_d: 0.086791
0.0384 --- loss: 1.159828, loss_ss: 0.863879, loss_d: 0.295949
0.0767 --- loss: 0.918099, loss_ss: 0.847682, loss_d: 0.070417
0.1151 --- loss: 0.914232, loss_ss: 0.808560, loss_d: 0.105672
0.1534 --- loss: 0.830885, loss_ss: 0.757744, loss_d: 0.073141
0.1918 --- loss: 0.806560, loss_ss: 0.796360, loss_d: 0.010200
0.2301 --- loss: 1.078436, loss_ss: 0.946245, loss_d: 0.132192
0.2685 --- loss: 0.675636, loss_ss: 0.570613, loss_d: 0.105023
0.3069 --- loss: 0.880703, loss_ss: 0.852336, loss_d: 0.028367
0.3452 --- loss: 1.495929, loss_ss: 1.402328, loss_d: 0.093602
0.3836 --- loss: 0.867352, loss_ss: 0.811704, loss_d: 0.055648
0.4219 --- loss: 0.712656, loss_ss: 0.644089, loss_d: 0.068567
0.4603 --- loss: 0.932795, loss_ss: 0.670985, loss_d: 0.261811
0.4987 --- loss: 0.985697, loss_ss: 0.814698, loss_d: 0.170999
0.5370 --- loss: 1.278675, loss_ss: 0.989452, loss_d: 0.289223
0.5754 --- loss: 1.562206, loss_ss: 1.480569, loss_d: 0.081637
0.6137 --- loss: 1.104697, loss_ss: 0.972759, loss_d: 0.131938
0.6521 --- loss: 0.876877, loss_ss: 0.831846, loss_d: 0.045031
0.6904 --- loss: 0.850692, loss_ss: 0.808815, loss_d: 0.041876
0.7288 --- loss: 1.890762, loss_ss: 0.802461, loss_d: 1.088301
0.7672 --- loss: 1.091254, loss_ss: 1.020341, loss_d: 0.070913
0.8055 --- loss: 0.881475, loss_ss: 0.815654, loss_d: 0.065821
0.8439 --- loss: 1.453852, loss_ss: 1.187330, loss_d: 0.266522
0.8822 --- loss: 1.103382, loss_ss: 1.014902, loss_d: 0.088480
0.9206 --- loss: 0.760830, loss_ss: 0.716602, loss_d: 0.044228
0.9590 --- loss: 1.415308, loss_ss: 0.761675, loss_d: 0.653633
0.9973 --- loss: 0.856417, loss_ss: 0.814183, loss_d: 0.042234
Epoch finished! Loss: 1.0667539585095185
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.351857, loss_ss: 1.196993, loss_d: 0.154864
0.0384 --- loss: 1.069391, loss_ss: 0.933080, loss_d: 0.136311
0.0767 --- loss: 0.910183, loss_ss: 0.872387, loss_d: 0.037795
0.1151 --- loss: 1.104853, loss_ss: 1.076386, loss_d: 0.028467
0.1534 --- loss: 1.013593, loss_ss: 0.875040, loss_d: 0.138554
0.1918 --- loss: 0.985327, loss_ss: 0.747595, loss_d: 0.237733
0.2301 --- loss: 1.293961, loss_ss: 0.779119, loss_d: 0.514842
0.2685 --- loss: 1.330048, loss_ss: 1.309822, loss_d: 0.020225
0.3069 --- loss: 1.250914, loss_ss: 0.901603, loss_d: 0.349311
0.3452 --- loss: 0.929075, loss_ss: 0.897374, loss_d: 0.031701
0.3836 --- loss: 0.836336, loss_ss: 0.762158, loss_d: 0.074178
0.4219 --- loss: 0.877948, loss_ss: 0.854693, loss_d: 0.023255
0.4603 --- loss: 0.785057, loss_ss: 0.720310, loss_d: 0.064747
0.4987 --- loss: 0.909032, loss_ss: 0.877762, loss_d: 0.031270
0.5370 --- loss: 1.074272, loss_ss: 0.619728, loss_d: 0.454544
0.5754 --- loss: 0.879975, loss_ss: 0.725234, loss_d: 0.154741
0.6137 --- loss: 1.276448, loss_ss: 0.651227, loss_d: 0.625221
0.6521 --- loss: 1.291863, loss_ss: 0.682599, loss_d: 0.609265
0.6904 --- loss: 0.696492, loss_ss: 0.679891, loss_d: 0.016601
0.7288 --- loss: 0.841897, loss_ss: 0.780551, loss_d: 0.061346
0.7672 --- loss: 0.825838, loss_ss: 0.781539, loss_d: 0.044298
0.8055 --- loss: 0.738259, loss_ss: 0.654791, loss_d: 0.083467
0.8439 --- loss: 1.166534, loss_ss: 1.156193, loss_d: 0.010341
0.8822 --- loss: 0.858513, loss_ss: 0.851582, loss_d: 0.006931
0.9206 --- loss: 0.906047, loss_ss: 0.890620, loss_d: 0.015428
0.9590 --- loss: 1.066563, loss_ss: 1.000664, loss_d: 0.065898
0.9973 --- loss: 1.157591, loss_ss: 0.857116, loss_d: 0.300474
Epoch finished! Loss: 1.0245045006275177
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.851729, loss_ss: 0.844828, loss_d: 0.006901
0.0384 --- loss: 0.819415, loss_ss: 0.742595, loss_d: 0.076820
0.0767 --- loss: 0.701978, loss_ss: 0.690011, loss_d: 0.011968
0.1151 --- loss: 1.154278, loss_ss: 1.076919, loss_d: 0.077359
0.1534 --- loss: 1.031295, loss_ss: 0.981550, loss_d: 0.049745
0.1918 --- loss: 1.214560, loss_ss: 0.842372, loss_d: 0.372188
0.2301 --- loss: 0.808524, loss_ss: 0.788329, loss_d: 0.020195
0.2685 --- loss: 0.972114, loss_ss: 0.941502, loss_d: 0.030612
0.3069 --- loss: 1.086689, loss_ss: 0.983122, loss_d: 0.103567
0.3452 --- loss: 1.049164, loss_ss: 1.030603, loss_d: 0.018561
0.3836 --- loss: 0.892518, loss_ss: 0.806224, loss_d: 0.086294
0.4219 --- loss: 0.830889, loss_ss: 0.806603, loss_d: 0.024287
0.4603 --- loss: 0.942478, loss_ss: 0.820540, loss_d: 0.121938
0.4987 --- loss: 1.057450, loss_ss: 1.013694, loss_d: 0.043755
0.5370 --- loss: 0.971729, loss_ss: 0.894965, loss_d: 0.076764
0.5754 --- loss: 1.262905, loss_ss: 0.896928, loss_d: 0.365976
0.6137 --- loss: 1.150434, loss_ss: 1.119846, loss_d: 0.030588
0.6521 --- loss: 0.927919, loss_ss: 0.899908, loss_d: 0.028012
0.6904 --- loss: 0.750486, loss_ss: 0.708810, loss_d: 0.041677
0.7288 --- loss: 1.558100, loss_ss: 0.721589, loss_d: 0.836511
0.7672 --- loss: 1.080123, loss_ss: 0.959297, loss_d: 0.120827
0.8055 --- loss: 0.709672, loss_ss: 0.675209, loss_d: 0.034463
0.8439 --- loss: 0.756862, loss_ss: 0.752623, loss_d: 0.004239
0.8822 --- loss: 0.829290, loss_ss: 0.812008, loss_d: 0.017282
0.9206 --- loss: 1.013818, loss_ss: 1.004344, loss_d: 0.009474
0.9590 --- loss: 0.800926, loss_ss: 0.705541, loss_d: 0.095385
0.9973 --- loss: 0.953626, loss_ss: 0.726757, loss_d: 0.226870
Epoch finished! Loss: 0.962383388555967
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.959763, loss_ss: 0.950823, loss_d: 0.008940
0.0384 --- loss: 1.143680, loss_ss: 0.740799, loss_d: 0.402881
0.0767 --- loss: 0.971967, loss_ss: 0.968458, loss_d: 0.003509
0.1151 --- loss: 1.096194, loss_ss: 0.826691, loss_d: 0.269503
0.1534 --- loss: 0.987109, loss_ss: 0.924517, loss_d: 0.062592
0.1918 --- loss: 1.002640, loss_ss: 0.983669, loss_d: 0.018971
0.2301 --- loss: 0.798438, loss_ss: 0.747008, loss_d: 0.051431
0.2685 --- loss: 0.570192, loss_ss: 0.535320, loss_d: 0.034872
0.3069 --- loss: 0.853031, loss_ss: 0.843983, loss_d: 0.009048
0.3452 --- loss: 0.647340, loss_ss: 0.613350, loss_d: 0.033990
0.3836 --- loss: 0.843087, loss_ss: 0.838406, loss_d: 0.004681
0.4219 --- loss: 0.951257, loss_ss: 0.929519, loss_d: 0.021738
0.4603 --- loss: 0.912807, loss_ss: 0.682363, loss_d: 0.230444
0.4987 --- loss: 1.006928, loss_ss: 0.973624, loss_d: 0.033305
0.5370 --- loss: 0.859317, loss_ss: 0.787576, loss_d: 0.071741
0.5754 --- loss: 0.949605, loss_ss: 0.915171, loss_d: 0.034434
0.6137 --- loss: 0.741693, loss_ss: 0.718349, loss_d: 0.023344
0.6521 --- loss: 0.767159, loss_ss: 0.658428, loss_d: 0.108731
0.6904 --- loss: 0.895294, loss_ss: 0.648077, loss_d: 0.247217
0.7288 --- loss: 0.655865, loss_ss: 0.608148, loss_d: 0.047717
0.7672 --- loss: 0.809439, loss_ss: 0.776577, loss_d: 0.032862
0.8055 --- loss: 0.618547, loss_ss: 0.567404, loss_d: 0.051143
0.8439 --- loss: 0.844101, loss_ss: 0.834786, loss_d: 0.009315
0.8822 --- loss: 0.941813, loss_ss: 0.847149, loss_d: 0.094664
0.9206 --- loss: 0.858236, loss_ss: 0.643043, loss_d: 0.215194
0.9590 --- loss: 0.583972, loss_ss: 0.564612, loss_d: 0.019360
0.9973 --- loss: 0.709455, loss_ss: 0.701445, loss_d: 0.008010
Epoch finished! Loss: 0.9571054090674107
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.030158, loss_ss: 0.973885, loss_d: 0.056273
0.0384 --- loss: 0.529203, loss_ss: 0.494093, loss_d: 0.035110
0.0767 --- loss: 0.793625, loss_ss: 0.787863, loss_d: 0.005763
0.1151 --- loss: 1.239652, loss_ss: 0.752448, loss_d: 0.487204
0.1534 --- loss: 0.886716, loss_ss: 0.779090, loss_d: 0.107626
0.1918 --- loss: 0.870571, loss_ss: 0.851174, loss_d: 0.019397
0.2301 --- loss: 0.754253, loss_ss: 0.715813, loss_d: 0.038441
0.2685 --- loss: 0.937459, loss_ss: 0.897543, loss_d: 0.039916
0.3069 --- loss: 0.976240, loss_ss: 0.883377, loss_d: 0.092863
0.3452 --- loss: 0.965172, loss_ss: 0.748929, loss_d: 0.216242
0.3836 --- loss: 1.033612, loss_ss: 0.708025, loss_d: 0.325587
0.4219 --- loss: 0.866730, loss_ss: 0.836380, loss_d: 0.030350
0.4603 --- loss: 1.328353, loss_ss: 1.300512, loss_d: 0.027841
0.4987 --- loss: 0.740230, loss_ss: 0.705903, loss_d: 0.034327
0.5370 --- loss: 0.859602, loss_ss: 0.755913, loss_d: 0.103688
0.5754 --- loss: 0.680447, loss_ss: 0.672631, loss_d: 0.007815
0.6137 --- loss: 1.313282, loss_ss: 0.493820, loss_d: 0.819461
0.6521 --- loss: 0.861131, loss_ss: 0.854728, loss_d: 0.006403
0.6904 --- loss: 1.006142, loss_ss: 0.992958, loss_d: 0.013185
0.7288 --- loss: 0.682870, loss_ss: 0.678673, loss_d: 0.004197
0.7672 --- loss: 0.728669, loss_ss: 0.631192, loss_d: 0.097476
0.8055 --- loss: 1.373160, loss_ss: 0.682464, loss_d: 0.690697
0.8439 --- loss: 0.729707, loss_ss: 0.670727, loss_d: 0.058980
0.8822 --- loss: 0.878322, loss_ss: 0.874559, loss_d: 0.003764
0.9206 --- loss: 0.759869, loss_ss: 0.713889, loss_d: 0.045980
0.9590 --- loss: 0.630684, loss_ss: 0.595743, loss_d: 0.034942
0.9973 --- loss: 1.390849, loss_ss: 0.690388, loss_d: 0.700460
Epoch finished! Loss: 0.9162070180361087
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8505376344086022
             precision    recall  f1-score   support

        0.0       0.78      1.00      0.88       226
        1.0       0.22      0.11      0.15        55
        2.0       0.92      0.85      0.88       410
        3.0       0.98      0.76      0.85       108
        4.0       0.84      0.99      0.91       131

avg / total       0.84      0.85      0.84       930
 


====== chc016-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  93.33  100.00   91.19  78.47     87.94
1  92.47   10.91   97.60  22.22     14.63
2  90.11   84.63   94.42  92.29     88.30
3  96.99   75.93   99.76  97.62     85.42
4  97.20   99.24   96.87  83.87     90.91
Total accuracy: 85.05%
Average sen: 74.14%
Average spec: 95.97%
Macro f1-score: 73.44%
Diagnosis acc on 15mins: 1.0
[9.31399874e-04 1.97833427e-03 1.15692208e-03 1.21877820e-03
 6.78370614e-03 8.38565454e-03 1.19098751e-02 2.16244254e-04
 2.85972637e-04 7.46282807e-04 5.96792263e-04 1.01838692e-03
 1.98775029e-04 1.56304275e-03 5.72296150e-04 9.06010973e-04
 1.17744377e-03 9.97977797e-04 2.05975398e-03 4.64346230e-01
 5.88363619e-04 4.22204426e-03 5.65968594e-03 1.98441747e-04
 7.99566135e-03 7.34472461e-03 2.28266921e-02 2.32653561e-04
 2.08397294e-04 3.06297699e-03 1.16928115e-01]
pred: 0.021816697951327377, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.346845, loss_ss: 1.595926, loss_d: 0.750919
0.0383 --- loss: 2.329688, loss_ss: 1.561627, loss_d: 0.768061
0.0766 --- loss: 2.064879, loss_ss: 1.614956, loss_d: 0.449923
0.1149 --- loss: 2.612402, loss_ss: 1.505799, loss_d: 1.106603
0.1532 --- loss: 2.105729, loss_ss: 1.438752, loss_d: 0.666977
0.1915 --- loss: 2.019982, loss_ss: 1.383475, loss_d: 0.636506
0.2298 --- loss: 1.794214, loss_ss: 1.344945, loss_d: 0.449270
0.2681 --- loss: 2.217844, loss_ss: 1.488812, loss_d: 0.729033
0.3064 --- loss: 2.074076, loss_ss: 1.276740, loss_d: 0.797336
0.3447 --- loss: 2.161785, loss_ss: 1.335045, loss_d: 0.826740
0.3830 --- loss: 1.846906, loss_ss: 1.245607, loss_d: 0.601300
0.4213 --- loss: 1.857620, loss_ss: 1.344706, loss_d: 0.512914
0.4596 --- loss: 1.898681, loss_ss: 1.520275, loss_d: 0.378407
0.4979 --- loss: 1.966676, loss_ss: 1.263062, loss_d: 0.703614
0.5362 --- loss: 2.124643, loss_ss: 1.283206, loss_d: 0.841437
0.5745 --- loss: 2.061625, loss_ss: 1.256885, loss_d: 0.804740
0.6128 --- loss: 1.901410, loss_ss: 1.266513, loss_d: 0.634897
0.6511 --- loss: 1.998830, loss_ss: 1.190372, loss_d: 0.808458
0.6894 --- loss: 1.699857, loss_ss: 1.112977, loss_d: 0.586880
0.7277 --- loss: 2.046699, loss_ss: 1.254928, loss_d: 0.791770
0.7660 --- loss: 1.727301, loss_ss: 1.160076, loss_d: 0.567225
0.8043 --- loss: 1.643173, loss_ss: 1.154146, loss_d: 0.489027
0.8426 --- loss: 1.423816, loss_ss: 1.096484, loss_d: 0.327332
0.8809 --- loss: 1.540328, loss_ss: 1.229798, loss_d: 0.310529
0.9192 --- loss: 2.156616, loss_ss: 1.326229, loss_d: 0.830387
0.9575 --- loss: 1.618012, loss_ss: 1.193002, loss_d: 0.425010
0.9958 --- loss: 1.881512, loss_ss: 1.103162, loss_d: 0.778350
Epoch finished! Loss: 1.8723168359405693
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.408994, loss_ss: 1.115009, loss_d: 0.293985
0.0383 --- loss: 2.147932, loss_ss: 1.308452, loss_d: 0.839480
0.0766 --- loss: 1.573228, loss_ss: 1.309087, loss_d: 0.264140
0.1149 --- loss: 1.618282, loss_ss: 1.251971, loss_d: 0.366311
0.1532 --- loss: 1.459363, loss_ss: 1.067784, loss_d: 0.391578
0.1915 --- loss: 1.649704, loss_ss: 1.055433, loss_d: 0.594271
0.2298 --- loss: 1.346536, loss_ss: 1.111817, loss_d: 0.234719
0.2681 --- loss: 1.588778, loss_ss: 1.448639, loss_d: 0.140140
0.3064 --- loss: 1.655295, loss_ss: 1.156737, loss_d: 0.498557
0.3447 --- loss: 1.482742, loss_ss: 1.218365, loss_d: 0.264377
0.3830 --- loss: 1.139145, loss_ss: 0.961942, loss_d: 0.177203
0.4213 --- loss: 1.481937, loss_ss: 1.090422, loss_d: 0.391515
0.4596 --- loss: 1.469384, loss_ss: 1.191635, loss_d: 0.277749
0.4979 --- loss: 1.554300, loss_ss: 1.003869, loss_d: 0.550431
0.5362 --- loss: 1.357637, loss_ss: 1.002749, loss_d: 0.354888
0.5745 --- loss: 1.467698, loss_ss: 1.223717, loss_d: 0.243981
0.6128 --- loss: 1.403063, loss_ss: 0.960842, loss_d: 0.442221
0.6511 --- loss: 1.228695, loss_ss: 0.913825, loss_d: 0.314871
0.6894 --- loss: 1.403154, loss_ss: 1.327261, loss_d: 0.075892
0.7277 --- loss: 1.187953, loss_ss: 1.024963, loss_d: 0.162989
0.7660 --- loss: 1.667110, loss_ss: 1.025873, loss_d: 0.641237
0.8043 --- loss: 1.425372, loss_ss: 0.931139, loss_d: 0.494233
0.8426 --- loss: 1.159511, loss_ss: 0.866038, loss_d: 0.293474
0.8809 --- loss: 1.530255, loss_ss: 0.970846, loss_d: 0.559409
0.9192 --- loss: 1.045318, loss_ss: 0.882103, loss_d: 0.163214
0.9575 --- loss: 1.024769, loss_ss: 0.799886, loss_d: 0.224883
0.9958 --- loss: 1.335680, loss_ss: 0.894841, loss_d: 0.440839
Epoch finished! Loss: 1.4751086008959804
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.339037, loss_ss: 1.089228, loss_d: 0.249809
0.0383 --- loss: 1.175258, loss_ss: 0.881038, loss_d: 0.294219
0.0766 --- loss: 0.967103, loss_ss: 0.874905, loss_d: 0.092198
0.1149 --- loss: 1.225871, loss_ss: 0.924271, loss_d: 0.301600
0.1532 --- loss: 1.297170, loss_ss: 1.038020, loss_d: 0.259150
0.1915 --- loss: 1.113975, loss_ss: 0.842072, loss_d: 0.271903
0.2298 --- loss: 1.012133, loss_ss: 0.898826, loss_d: 0.113307
0.2681 --- loss: 1.627976, loss_ss: 1.105170, loss_d: 0.522806
0.3064 --- loss: 0.887176, loss_ss: 0.725454, loss_d: 0.161722
0.3447 --- loss: 1.612226, loss_ss: 1.237436, loss_d: 0.374790
0.3830 --- loss: 1.193485, loss_ss: 1.000987, loss_d: 0.192498
0.4213 --- loss: 1.782451, loss_ss: 1.262051, loss_d: 0.520400
0.4596 --- loss: 1.642417, loss_ss: 1.086754, loss_d: 0.555663
0.4979 --- loss: 1.292658, loss_ss: 1.049004, loss_d: 0.243654
0.5362 --- loss: 1.279509, loss_ss: 1.170676, loss_d: 0.108833
0.5745 --- loss: 1.038264, loss_ss: 0.982453, loss_d: 0.055810
0.6128 --- loss: 1.182145, loss_ss: 0.810807, loss_d: 0.371339
0.6511 --- loss: 1.323633, loss_ss: 1.092932, loss_d: 0.230700
0.6894 --- loss: 1.947502, loss_ss: 1.136556, loss_d: 0.810947
0.7277 --- loss: 1.780592, loss_ss: 1.192828, loss_d: 0.587764
0.7660 --- loss: 0.918737, loss_ss: 0.767412, loss_d: 0.151325
0.8043 --- loss: 1.344628, loss_ss: 0.964742, loss_d: 0.379886
0.8426 --- loss: 1.461053, loss_ss: 1.295658, loss_d: 0.165395
0.8809 --- loss: 1.219908, loss_ss: 1.028483, loss_d: 0.191424
0.9192 --- loss: 1.307130, loss_ss: 1.059366, loss_d: 0.247764
0.9575 --- loss: 1.121504, loss_ss: 0.910562, loss_d: 0.210943
0.9958 --- loss: 1.365001, loss_ss: 1.180011, loss_d: 0.184991
Epoch finished! Loss: 1.3216448238983007
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.945182, loss_ss: 0.865016, loss_d: 0.080166
0.0383 --- loss: 1.038096, loss_ss: 0.683594, loss_d: 0.354502
0.0766 --- loss: 1.040803, loss_ss: 0.861983, loss_d: 0.178820
0.1149 --- loss: 1.467235, loss_ss: 1.270930, loss_d: 0.196305
0.1532 --- loss: 1.065048, loss_ss: 1.029493, loss_d: 0.035555
0.1915 --- loss: 1.033622, loss_ss: 0.885340, loss_d: 0.148283
0.2298 --- loss: 0.904320, loss_ss: 0.735411, loss_d: 0.168909
0.2681 --- loss: 1.394065, loss_ss: 1.320832, loss_d: 0.073233
0.3064 --- loss: 1.276063, loss_ss: 0.980458, loss_d: 0.295605
0.3447 --- loss: 2.001606, loss_ss: 1.195717, loss_d: 0.805889
0.3830 --- loss: 0.891683, loss_ss: 0.838642, loss_d: 0.053041
0.4213 --- loss: 1.104560, loss_ss: 1.019994, loss_d: 0.084566
0.4596 --- loss: 0.784463, loss_ss: 0.733857, loss_d: 0.050606
0.4979 --- loss: 1.121254, loss_ss: 0.864189, loss_d: 0.257065
0.5362 --- loss: 1.314782, loss_ss: 0.783918, loss_d: 0.530864
0.5745 --- loss: 1.037343, loss_ss: 0.925994, loss_d: 0.111349
0.6128 --- loss: 1.383162, loss_ss: 0.914682, loss_d: 0.468480
0.6511 --- loss: 1.219792, loss_ss: 1.074348, loss_d: 0.145444
0.6894 --- loss: 1.535439, loss_ss: 0.761395, loss_d: 0.774045
0.7277 --- loss: 1.314850, loss_ss: 1.038802, loss_d: 0.276048
0.7660 --- loss: 1.578919, loss_ss: 1.156731, loss_d: 0.422188
0.8043 --- loss: 1.619658, loss_ss: 1.280447, loss_d: 0.339212
0.8426 --- loss: 0.916497, loss_ss: 0.795448, loss_d: 0.121048
0.8809 --- loss: 1.390993, loss_ss: 0.996704, loss_d: 0.394289
0.9192 --- loss: 1.028355, loss_ss: 0.914091, loss_d: 0.114264
0.9575 --- loss: 1.005314, loss_ss: 0.839483, loss_d: 0.165830
0.9958 --- loss: 1.566539, loss_ss: 1.429140, loss_d: 0.137399
Epoch finished! Loss: 1.2152239531849536
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.132817, loss_ss: 0.812975, loss_d: 0.319842
0.0383 --- loss: 0.977690, loss_ss: 0.765910, loss_d: 0.211780
0.0766 --- loss: 1.455448, loss_ss: 0.944184, loss_d: 0.511265
0.1149 --- loss: 1.126542, loss_ss: 1.012927, loss_d: 0.113614
0.1532 --- loss: 0.739587, loss_ss: 0.685589, loss_d: 0.053998
0.1915 --- loss: 1.514353, loss_ss: 1.156713, loss_d: 0.357640
0.2298 --- loss: 1.007792, loss_ss: 0.939465, loss_d: 0.068328
0.2681 --- loss: 1.129239, loss_ss: 0.764636, loss_d: 0.364603
0.3064 --- loss: 0.924048, loss_ss: 0.783187, loss_d: 0.140861
0.3447 --- loss: 1.219899, loss_ss: 1.012804, loss_d: 0.207095
0.3830 --- loss: 0.952969, loss_ss: 0.818020, loss_d: 0.134949
0.4213 --- loss: 1.093514, loss_ss: 0.828053, loss_d: 0.265461
0.4596 --- loss: 1.170433, loss_ss: 1.031177, loss_d: 0.139256
0.4979 --- loss: 1.335518, loss_ss: 1.268243, loss_d: 0.067275
0.5362 --- loss: 1.048648, loss_ss: 0.721543, loss_d: 0.327106
0.5745 --- loss: 1.320954, loss_ss: 0.914006, loss_d: 0.406948
0.6128 --- loss: 0.857211, loss_ss: 0.782509, loss_d: 0.074702
0.6511 --- loss: 0.985095, loss_ss: 0.763471, loss_d: 0.221624
0.6894 --- loss: 0.970276, loss_ss: 0.922316, loss_d: 0.047960
0.7277 --- loss: 1.055122, loss_ss: 0.867291, loss_d: 0.187832
0.7660 --- loss: 0.873597, loss_ss: 0.807000, loss_d: 0.066597
0.8043 --- loss: 1.039287, loss_ss: 0.798264, loss_d: 0.241023
0.8426 --- loss: 1.224035, loss_ss: 0.843712, loss_d: 0.380323
0.8809 --- loss: 1.015132, loss_ss: 0.936170, loss_d: 0.078962
0.9192 --- loss: 1.118931, loss_ss: 0.889476, loss_d: 0.229456
0.9575 --- loss: 0.753853, loss_ss: 0.727932, loss_d: 0.025921
0.9958 --- loss: 1.346937, loss_ss: 1.169360, loss_d: 0.177578
Epoch finished! Loss: 1.1356252735601988
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.134515, loss_ss: 0.890223, loss_d: 0.244291
0.0383 --- loss: 1.463142, loss_ss: 0.995283, loss_d: 0.467859
0.0766 --- loss: 1.255063, loss_ss: 0.678357, loss_d: 0.576706
0.1149 --- loss: 1.101372, loss_ss: 0.913012, loss_d: 0.188360
0.1532 --- loss: 0.958643, loss_ss: 0.905647, loss_d: 0.052996
0.1915 --- loss: 0.759280, loss_ss: 0.662483, loss_d: 0.096797
0.2298 --- loss: 0.874264, loss_ss: 0.697817, loss_d: 0.176447
0.2681 --- loss: 1.128835, loss_ss: 0.936382, loss_d: 0.192453
0.3064 --- loss: 1.822898, loss_ss: 0.998965, loss_d: 0.823933
0.3447 --- loss: 1.039831, loss_ss: 0.845528, loss_d: 0.194303
0.3830 --- loss: 0.941346, loss_ss: 0.839125, loss_d: 0.102221
0.4213 --- loss: 1.059121, loss_ss: 0.580131, loss_d: 0.478990
0.4596 --- loss: 1.089006, loss_ss: 0.779400, loss_d: 0.309607
0.4979 --- loss: 1.164042, loss_ss: 0.964301, loss_d: 0.199742
0.5362 --- loss: 1.179246, loss_ss: 0.797300, loss_d: 0.381946
0.5745 --- loss: 1.400192, loss_ss: 1.335136, loss_d: 0.065056
0.6128 --- loss: 0.963646, loss_ss: 0.876815, loss_d: 0.086831
0.6511 --- loss: 0.954741, loss_ss: 0.937250, loss_d: 0.017491
0.6894 --- loss: 1.086576, loss_ss: 1.045607, loss_d: 0.040969
0.7277 --- loss: 0.913957, loss_ss: 0.831193, loss_d: 0.082764
0.7660 --- loss: 0.784898, loss_ss: 0.768112, loss_d: 0.016786
0.8043 --- loss: 0.912427, loss_ss: 0.889937, loss_d: 0.022491
0.8426 --- loss: 0.762954, loss_ss: 0.691341, loss_d: 0.071612
0.8809 --- loss: 1.043482, loss_ss: 0.755124, loss_d: 0.288358
0.9192 --- loss: 1.241344, loss_ss: 0.902806, loss_d: 0.338538
0.9575 --- loss: 0.988026, loss_ss: 0.915937, loss_d: 0.072089
0.9958 --- loss: 0.828920, loss_ss: 0.794577, loss_d: 0.034342
Epoch finished! Loss: 1.0641647769116807
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.331356, loss_ss: 1.104461, loss_d: 0.226895
0.0383 --- loss: 1.147575, loss_ss: 0.794277, loss_d: 0.353298
0.0766 --- loss: 1.033784, loss_ss: 0.979718, loss_d: 0.054066
0.1149 --- loss: 0.832177, loss_ss: 0.769626, loss_d: 0.062550
0.1532 --- loss: 0.921130, loss_ss: 0.781950, loss_d: 0.139181
0.1915 --- loss: 0.918152, loss_ss: 0.893608, loss_d: 0.024543
0.2298 --- loss: 0.809118, loss_ss: 0.687011, loss_d: 0.122107
0.2681 --- loss: 1.089716, loss_ss: 0.903399, loss_d: 0.186317
0.3064 --- loss: 0.914678, loss_ss: 0.858017, loss_d: 0.056661
0.3447 --- loss: 1.018691, loss_ss: 0.978788, loss_d: 0.039904
0.3830 --- loss: 0.789396, loss_ss: 0.775286, loss_d: 0.014110
0.4213 --- loss: 0.859614, loss_ss: 0.737874, loss_d: 0.121740
0.4596 --- loss: 1.060354, loss_ss: 1.013039, loss_d: 0.047315
0.4979 --- loss: 0.995283, loss_ss: 0.716204, loss_d: 0.279078
0.5362 --- loss: 0.710560, loss_ss: 0.702391, loss_d: 0.008169
0.5745 --- loss: 1.037649, loss_ss: 0.957547, loss_d: 0.080102
0.6128 --- loss: 0.961723, loss_ss: 0.796703, loss_d: 0.165020
0.6511 --- loss: 0.961012, loss_ss: 0.801840, loss_d: 0.159172
0.6894 --- loss: 1.462411, loss_ss: 1.193727, loss_d: 0.268685
0.7277 --- loss: 1.071627, loss_ss: 0.918944, loss_d: 0.152684
0.7660 --- loss: 0.919745, loss_ss: 0.712761, loss_d: 0.206985
0.8043 --- loss: 1.094731, loss_ss: 0.956774, loss_d: 0.137957
0.8426 --- loss: 0.935255, loss_ss: 0.864807, loss_d: 0.070448
0.8809 --- loss: 0.783830, loss_ss: 0.656265, loss_d: 0.127565
0.9192 --- loss: 1.427241, loss_ss: 0.931758, loss_d: 0.495483
0.9575 --- loss: 0.752218, loss_ss: 0.523775, loss_d: 0.228443
0.9958 --- loss: 1.732189, loss_ss: 0.789132, loss_d: 0.943057
Epoch finished! Loss: 1.037013070565074
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.965086, loss_ss: 0.947115, loss_d: 0.017971
0.0383 --- loss: 0.800008, loss_ss: 0.762201, loss_d: 0.037807
0.0766 --- loss: 0.760500, loss_ss: 0.698234, loss_d: 0.062267
0.1149 --- loss: 0.808802, loss_ss: 0.717194, loss_d: 0.091608
0.1532 --- loss: 0.793115, loss_ss: 0.749331, loss_d: 0.043784
0.1915 --- loss: 0.850027, loss_ss: 0.807828, loss_d: 0.042199
0.2298 --- loss: 1.740745, loss_ss: 1.120234, loss_d: 0.620511
0.2681 --- loss: 1.118800, loss_ss: 1.086887, loss_d: 0.031913
0.3064 --- loss: 1.231111, loss_ss: 0.909370, loss_d: 0.321740
0.3447 --- loss: 1.136238, loss_ss: 0.949469, loss_d: 0.186768
0.3830 --- loss: 0.884680, loss_ss: 0.871111, loss_d: 0.013569
0.4213 --- loss: 1.358711, loss_ss: 0.893018, loss_d: 0.465693
0.4596 --- loss: 0.827969, loss_ss: 0.753380, loss_d: 0.074590
0.4979 --- loss: 0.934298, loss_ss: 0.923752, loss_d: 0.010546
0.5362 --- loss: 1.184763, loss_ss: 1.076621, loss_d: 0.108142
0.5745 --- loss: 1.030534, loss_ss: 0.992706, loss_d: 0.037828
0.6128 --- loss: 0.915994, loss_ss: 0.900052, loss_d: 0.015942
0.6511 --- loss: 1.202394, loss_ss: 0.758050, loss_d: 0.444343
0.6894 --- loss: 0.795875, loss_ss: 0.757421, loss_d: 0.038454
0.7277 --- loss: 1.247463, loss_ss: 0.949653, loss_d: 0.297810
0.7660 --- loss: 1.210938, loss_ss: 0.780579, loss_d: 0.430358
0.8043 --- loss: 1.005460, loss_ss: 0.679093, loss_d: 0.326367
0.8426 --- loss: 1.059443, loss_ss: 0.916024, loss_d: 0.143419
0.8809 --- loss: 1.020409, loss_ss: 0.972126, loss_d: 0.048283
0.9192 --- loss: 0.724635, loss_ss: 0.700219, loss_d: 0.024415
0.9575 --- loss: 0.892322, loss_ss: 0.875346, loss_d: 0.016976
0.9958 --- loss: 1.309734, loss_ss: 1.287645, loss_d: 0.022089
Epoch finished! Loss: 0.9769137725519494
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.068501, loss_ss: 0.837907, loss_d: 0.230594
0.0383 --- loss: 1.042417, loss_ss: 0.961085, loss_d: 0.081332
0.0766 --- loss: 0.778885, loss_ss: 0.771728, loss_d: 0.007157
0.1149 --- loss: 0.831701, loss_ss: 0.803938, loss_d: 0.027763
0.1532 --- loss: 1.421743, loss_ss: 0.769773, loss_d: 0.651969
0.1915 --- loss: 1.271236, loss_ss: 1.076362, loss_d: 0.194875
0.2298 --- loss: 0.769614, loss_ss: 0.737830, loss_d: 0.031784
0.2681 --- loss: 0.842490, loss_ss: 0.775873, loss_d: 0.066617
0.3064 --- loss: 0.789598, loss_ss: 0.620135, loss_d: 0.169462
0.3447 --- loss: 0.930075, loss_ss: 0.809208, loss_d: 0.120867
0.3830 --- loss: 0.830801, loss_ss: 0.770858, loss_d: 0.059942
0.4213 --- loss: 1.234343, loss_ss: 0.925419, loss_d: 0.308923
0.4596 --- loss: 0.842044, loss_ss: 0.755779, loss_d: 0.086265
0.4979 --- loss: 0.685262, loss_ss: 0.662460, loss_d: 0.022802
0.5362 --- loss: 0.856724, loss_ss: 0.829881, loss_d: 0.026843
0.5745 --- loss: 0.890881, loss_ss: 0.784435, loss_d: 0.106446
0.6128 --- loss: 1.207483, loss_ss: 1.121733, loss_d: 0.085750
0.6511 --- loss: 0.662312, loss_ss: 0.623179, loss_d: 0.039132
0.6894 --- loss: 0.901451, loss_ss: 0.812386, loss_d: 0.089064
0.7277 --- loss: 0.981312, loss_ss: 0.747085, loss_d: 0.234226
0.7660 --- loss: 0.929908, loss_ss: 0.924838, loss_d: 0.005070
0.8043 --- loss: 1.132988, loss_ss: 1.031601, loss_d: 0.101387
0.8426 --- loss: 0.867178, loss_ss: 0.839596, loss_d: 0.027583
0.8809 --- loss: 0.889681, loss_ss: 0.864177, loss_d: 0.025504
0.9192 --- loss: 0.865292, loss_ss: 0.639005, loss_d: 0.226286
0.9575 --- loss: 1.733407, loss_ss: 0.960898, loss_d: 0.772508
0.9958 --- loss: 1.026292, loss_ss: 1.007148, loss_d: 0.019144
Epoch finished! Loss: 0.9673631298587697
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.992752, loss_ss: 0.900329, loss_d: 0.092422
0.0383 --- loss: 0.960186, loss_ss: 0.947923, loss_d: 0.012263
0.0766 --- loss: 1.083766, loss_ss: 0.714947, loss_d: 0.368819
0.1149 --- loss: 0.970296, loss_ss: 0.951645, loss_d: 0.018651
0.1532 --- loss: 0.904307, loss_ss: 0.777780, loss_d: 0.126527
0.1915 --- loss: 1.112945, loss_ss: 0.789888, loss_d: 0.323057
0.2298 --- loss: 1.153226, loss_ss: 1.036756, loss_d: 0.116470
0.2681 --- loss: 0.789074, loss_ss: 0.748992, loss_d: 0.040082
0.3064 --- loss: 0.745994, loss_ss: 0.649642, loss_d: 0.096352
0.3447 --- loss: 1.003787, loss_ss: 0.709958, loss_d: 0.293829
0.3830 --- loss: 0.783761, loss_ss: 0.772495, loss_d: 0.011266
0.4213 --- loss: 0.879566, loss_ss: 0.855175, loss_d: 0.024391
0.4596 --- loss: 1.194862, loss_ss: 1.181324, loss_d: 0.013538
0.4979 --- loss: 1.018635, loss_ss: 1.000500, loss_d: 0.018135
0.5362 --- loss: 0.963529, loss_ss: 0.939177, loss_d: 0.024352
0.5745 --- loss: 0.791444, loss_ss: 0.775106, loss_d: 0.016337
0.6128 --- loss: 0.749336, loss_ss: 0.672777, loss_d: 0.076559
0.6511 --- loss: 0.830697, loss_ss: 0.680046, loss_d: 0.150651
0.6894 --- loss: 1.179489, loss_ss: 1.073975, loss_d: 0.105514
0.7277 --- loss: 1.558035, loss_ss: 1.554815, loss_d: 0.003220
0.7660 --- loss: 0.807359, loss_ss: 0.777792, loss_d: 0.029568
0.8043 --- loss: 0.613992, loss_ss: 0.601617, loss_d: 0.012374
0.8426 --- loss: 1.254955, loss_ss: 1.232505, loss_d: 0.022450
0.8809 --- loss: 0.719198, loss_ss: 0.631313, loss_d: 0.087886
0.9192 --- loss: 1.610548, loss_ss: 1.109830, loss_d: 0.500719
0.9575 --- loss: 0.877639, loss_ss: 0.867225, loss_d: 0.010414
0.9958 --- loss: 0.803651, loss_ss: 0.747418, loss_d: 0.056233
Epoch finished! Loss: 0.9411718141986949
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7876543209876543
             precision    recall  f1-score   support

        0.0       0.98      0.81      0.89       102
        1.0       0.40      0.53      0.46        15
        2.0       0.93      0.68      0.78       397
        3.0       0.63      0.99      0.77       187
        4.0       0.78      0.84      0.81       109

avg / total       0.83      0.79      0.79       810
 


====== chc022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.41  81.37   99.72  97.65     88.77
1  97.65  53.33   98.49  40.00     45.71
2  81.60  67.76   94.92  92.76     78.31
3  86.17  99.47   82.18  62.63     76.86
4  94.69  84.40   96.29  77.97     81.06
Total accuracy: 78.77%
Average sen: 77.27%
Average spec: 94.32%
Macro f1-score: 74.14%
Diagnosis acc on 15mins: 1.0
[0.00517481 0.02338672 0.02081345 0.03631706 0.00104514 0.00062639
 0.0006621  0.00457882 0.00081549 0.00694384 0.00432936 0.00298994
 0.00061474 0.20290227 0.18937929 0.04804689 0.00352962 0.01150521
 0.00295599 0.00172469 0.00365807 0.04453632 0.03415241 0.03051213
 0.00714218 0.25855678 0.08111328]
pred: 0.03807455498328501, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.424528, loss_ss: 1.704188, loss_d: 0.720340
0.0383 --- loss: 2.361392, loss_ss: 1.723374, loss_d: 0.638018
0.0766 --- loss: 2.081422, loss_ss: 1.450920, loss_d: 0.630502
0.1149 --- loss: 2.305347, loss_ss: 1.431692, loss_d: 0.873655
0.1532 --- loss: 1.875902, loss_ss: 1.420133, loss_d: 0.455769
0.1915 --- loss: 2.054370, loss_ss: 1.411202, loss_d: 0.643168
0.2298 --- loss: 1.852972, loss_ss: 1.311094, loss_d: 0.541878
0.2681 --- loss: 1.905040, loss_ss: 1.388165, loss_d: 0.516875
0.3064 --- loss: 1.964025, loss_ss: 1.289554, loss_d: 0.674470
0.3447 --- loss: 1.789366, loss_ss: 1.269038, loss_d: 0.520327
0.3830 --- loss: 1.659480, loss_ss: 1.231975, loss_d: 0.427505
0.4213 --- loss: 1.965194, loss_ss: 1.375973, loss_d: 0.589221
0.4596 --- loss: 1.883402, loss_ss: 1.235242, loss_d: 0.648160
0.4979 --- loss: 1.769604, loss_ss: 1.295539, loss_d: 0.474064
0.5362 --- loss: 1.574992, loss_ss: 1.161167, loss_d: 0.413825
0.5745 --- loss: 1.803838, loss_ss: 1.162056, loss_d: 0.641782
0.6128 --- loss: 1.890593, loss_ss: 1.165425, loss_d: 0.725168
0.6511 --- loss: 1.774732, loss_ss: 1.227899, loss_d: 0.546833
0.6894 --- loss: 1.536824, loss_ss: 1.151148, loss_d: 0.385675
0.7277 --- loss: 1.464128, loss_ss: 1.223703, loss_d: 0.240425
0.7660 --- loss: 1.585573, loss_ss: 1.171169, loss_d: 0.414404
0.8043 --- loss: 1.398348, loss_ss: 1.133870, loss_d: 0.264477
0.8426 --- loss: 1.395838, loss_ss: 1.128417, loss_d: 0.267421
0.8809 --- loss: 1.585680, loss_ss: 1.074741, loss_d: 0.510939
0.9192 --- loss: 1.352047, loss_ss: 1.068685, loss_d: 0.283362
0.9575 --- loss: 1.609696, loss_ss: 1.164379, loss_d: 0.445317
0.9958 --- loss: 1.435049, loss_ss: 0.997056, loss_d: 0.437993
Epoch finished! Loss: 1.8047560421443076
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.559766, loss_ss: 1.037639, loss_d: 0.522126
0.0383 --- loss: 1.580998, loss_ss: 1.255131, loss_d: 0.325867
0.0766 --- loss: 1.426130, loss_ss: 1.071028, loss_d: 0.355102
0.1149 --- loss: 1.509903, loss_ss: 1.261692, loss_d: 0.248210
0.1532 --- loss: 1.447668, loss_ss: 1.158043, loss_d: 0.289625
0.1915 --- loss: 1.253586, loss_ss: 1.002685, loss_d: 0.250901
0.2298 --- loss: 1.300416, loss_ss: 1.064233, loss_d: 0.236183
0.2681 --- loss: 1.569628, loss_ss: 1.008206, loss_d: 0.561421
0.3064 --- loss: 1.424703, loss_ss: 0.984199, loss_d: 0.440505
0.3447 --- loss: 1.204832, loss_ss: 0.951440, loss_d: 0.253392
0.3830 --- loss: 1.119055, loss_ss: 0.944906, loss_d: 0.174149
0.4213 --- loss: 1.548875, loss_ss: 0.920066, loss_d: 0.628808
0.4596 --- loss: 1.239938, loss_ss: 0.940477, loss_d: 0.299461
0.4979 --- loss: 1.638101, loss_ss: 1.335083, loss_d: 0.303019
0.5362 --- loss: 1.482690, loss_ss: 1.113526, loss_d: 0.369163
0.5745 --- loss: 1.535373, loss_ss: 1.088299, loss_d: 0.447074
0.6128 --- loss: 1.599563, loss_ss: 1.068016, loss_d: 0.531546
0.6511 --- loss: 1.330553, loss_ss: 0.892453, loss_d: 0.438100
0.6894 --- loss: 1.448029, loss_ss: 1.004626, loss_d: 0.443403
0.7277 --- loss: 1.858561, loss_ss: 1.074341, loss_d: 0.784220
0.7660 --- loss: 1.289407, loss_ss: 0.889151, loss_d: 0.400256
0.8043 --- loss: 1.340769, loss_ss: 0.957724, loss_d: 0.383045
0.8426 --- loss: 1.678907, loss_ss: 1.228603, loss_d: 0.450304
0.8809 --- loss: 1.750774, loss_ss: 1.477650, loss_d: 0.273124
0.9192 --- loss: 1.292955, loss_ss: 0.993980, loss_d: 0.298975
0.9575 --- loss: 1.727383, loss_ss: 1.186588, loss_d: 0.540796
0.9958 --- loss: 1.409235, loss_ss: 0.926571, loss_d: 0.482664
Epoch finished! Loss: 1.4530422372379521
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.734963, loss_ss: 1.281490, loss_d: 0.453472
0.0383 --- loss: 1.111710, loss_ss: 0.947671, loss_d: 0.164040
0.0766 --- loss: 1.480296, loss_ss: 1.111702, loss_d: 0.368594
0.1149 --- loss: 1.038889, loss_ss: 0.797570, loss_d: 0.241319
0.1532 --- loss: 1.407369, loss_ss: 1.061002, loss_d: 0.346368
0.1915 --- loss: 1.337816, loss_ss: 1.050999, loss_d: 0.286817
0.2298 --- loss: 1.546973, loss_ss: 1.115871, loss_d: 0.431101
0.2681 --- loss: 0.953944, loss_ss: 0.864836, loss_d: 0.089108
0.3064 --- loss: 1.140999, loss_ss: 0.977526, loss_d: 0.163473
0.3447 --- loss: 1.239232, loss_ss: 0.828685, loss_d: 0.410547
0.3830 --- loss: 1.397125, loss_ss: 1.321159, loss_d: 0.075966
0.4213 --- loss: 1.402182, loss_ss: 1.221058, loss_d: 0.181124
0.4596 --- loss: 1.063228, loss_ss: 0.956251, loss_d: 0.106977
0.4979 --- loss: 1.167195, loss_ss: 0.824862, loss_d: 0.342333
0.5362 --- loss: 1.009837, loss_ss: 0.898479, loss_d: 0.111358
0.5745 --- loss: 1.090126, loss_ss: 0.764223, loss_d: 0.325903
0.6128 --- loss: 1.459687, loss_ss: 0.922605, loss_d: 0.537082
0.6511 --- loss: 1.138570, loss_ss: 1.077925, loss_d: 0.060645
0.6894 --- loss: 1.458003, loss_ss: 1.121871, loss_d: 0.336132
0.7277 --- loss: 1.217508, loss_ss: 0.916611, loss_d: 0.300896
0.7660 --- loss: 1.336257, loss_ss: 0.958623, loss_d: 0.377634
0.8043 --- loss: 1.659484, loss_ss: 1.279904, loss_d: 0.379580
0.8426 --- loss: 1.512034, loss_ss: 1.209603, loss_d: 0.302431
0.8809 --- loss: 1.772192, loss_ss: 0.938557, loss_d: 0.833635
0.9192 --- loss: 1.460939, loss_ss: 1.290055, loss_d: 0.170884
0.9575 --- loss: 1.128249, loss_ss: 0.984593, loss_d: 0.143656
0.9958 --- loss: 1.141678, loss_ss: 1.031835, loss_d: 0.109843
Epoch finished! Loss: 1.296001591444929
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.139867, loss_ss: 0.866833, loss_d: 0.273034
0.0383 --- loss: 1.536223, loss_ss: 0.888170, loss_d: 0.648053
0.0766 --- loss: 0.976814, loss_ss: 0.899494, loss_d: 0.077320
0.1149 --- loss: 1.155415, loss_ss: 0.985668, loss_d: 0.169747
0.1532 --- loss: 1.006767, loss_ss: 0.840443, loss_d: 0.166324
0.1915 --- loss: 1.451648, loss_ss: 1.029998, loss_d: 0.421650
0.2298 --- loss: 1.512368, loss_ss: 1.117464, loss_d: 0.394905
0.2681 --- loss: 1.680980, loss_ss: 0.965880, loss_d: 0.715100
0.3064 --- loss: 0.945588, loss_ss: 0.795625, loss_d: 0.149964
0.3447 --- loss: 1.079598, loss_ss: 0.865169, loss_d: 0.214429
0.3830 --- loss: 1.272925, loss_ss: 0.967493, loss_d: 0.305432
0.4213 --- loss: 0.999837, loss_ss: 0.931572, loss_d: 0.068265
0.4596 --- loss: 1.311568, loss_ss: 0.939778, loss_d: 0.371790
0.4979 --- loss: 0.864467, loss_ss: 0.752450, loss_d: 0.112017
0.5362 --- loss: 1.354931, loss_ss: 1.254701, loss_d: 0.100230
0.5745 --- loss: 1.098705, loss_ss: 1.055667, loss_d: 0.043039
0.6128 --- loss: 1.159815, loss_ss: 0.713654, loss_d: 0.446160
0.6511 --- loss: 1.021569, loss_ss: 0.962179, loss_d: 0.059390
0.6894 --- loss: 1.031462, loss_ss: 0.986043, loss_d: 0.045419
0.7277 --- loss: 1.005173, loss_ss: 0.786457, loss_d: 0.218716
0.7660 --- loss: 1.434429, loss_ss: 0.848117, loss_d: 0.586312
0.8043 --- loss: 1.100586, loss_ss: 0.719657, loss_d: 0.380929
0.8426 --- loss: 1.543305, loss_ss: 0.897465, loss_d: 0.645840
0.8809 --- loss: 1.304861, loss_ss: 1.054521, loss_d: 0.250340
0.9192 --- loss: 1.100011, loss_ss: 1.033117, loss_d: 0.066894
0.9575 --- loss: 1.424799, loss_ss: 1.077124, loss_d: 0.347675
0.9958 --- loss: 0.825544, loss_ss: 0.782019, loss_d: 0.043525
Epoch finished! Loss: 1.2154866132699667
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.249984, loss_ss: 0.954709, loss_d: 0.295274
0.0383 --- loss: 1.105238, loss_ss: 0.920191, loss_d: 0.185047
0.0766 --- loss: 0.879630, loss_ss: 0.768655, loss_d: 0.110974
0.1149 --- loss: 1.204171, loss_ss: 0.818572, loss_d: 0.385598
0.1532 --- loss: 1.314753, loss_ss: 0.967387, loss_d: 0.347366
0.1915 --- loss: 1.051273, loss_ss: 0.960726, loss_d: 0.090547
0.2298 --- loss: 1.346887, loss_ss: 0.853589, loss_d: 0.493298
0.2681 --- loss: 0.857479, loss_ss: 0.802023, loss_d: 0.055456
0.3064 --- loss: 0.837447, loss_ss: 0.747250, loss_d: 0.090197
0.3447 --- loss: 0.930889, loss_ss: 0.846204, loss_d: 0.084685
0.3830 --- loss: 1.226542, loss_ss: 0.889624, loss_d: 0.336918
0.4213 --- loss: 1.136148, loss_ss: 1.033383, loss_d: 0.102764
0.4596 --- loss: 1.164868, loss_ss: 0.968223, loss_d: 0.196645
0.4979 --- loss: 1.343949, loss_ss: 0.725718, loss_d: 0.618231
0.5362 --- loss: 1.205468, loss_ss: 0.954587, loss_d: 0.250881
0.5745 --- loss: 1.382544, loss_ss: 1.004846, loss_d: 0.377698
0.6128 --- loss: 1.303628, loss_ss: 0.949939, loss_d: 0.353689
0.6511 --- loss: 0.771598, loss_ss: 0.638467, loss_d: 0.133130
0.6894 --- loss: 1.236695, loss_ss: 1.192354, loss_d: 0.044341
0.7277 --- loss: 0.789983, loss_ss: 0.695053, loss_d: 0.094930
0.7660 --- loss: 1.182124, loss_ss: 0.933470, loss_d: 0.248654
0.8043 --- loss: 0.986195, loss_ss: 0.881538, loss_d: 0.104657
0.8426 --- loss: 1.390257, loss_ss: 0.927605, loss_d: 0.462652
0.8809 --- loss: 1.047671, loss_ss: 1.005461, loss_d: 0.042210
0.9192 --- loss: 1.433522, loss_ss: 0.919099, loss_d: 0.514423
0.9575 --- loss: 1.263029, loss_ss: 0.812851, loss_d: 0.450178
0.9958 --- loss: 1.500981, loss_ss: 1.033500, loss_d: 0.467481
Epoch finished! Loss: 1.173965856261637
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.267303, loss_ss: 1.119324, loss_d: 0.147979
0.0383 --- loss: 1.740834, loss_ss: 1.432808, loss_d: 0.308026
0.0766 --- loss: 1.123142, loss_ss: 0.791215, loss_d: 0.331927
0.1149 --- loss: 1.182642, loss_ss: 1.135310, loss_d: 0.047333
0.1532 --- loss: 1.125966, loss_ss: 1.023320, loss_d: 0.102646
0.1915 --- loss: 0.992500, loss_ss: 0.897380, loss_d: 0.095120
0.2298 --- loss: 0.921837, loss_ss: 0.824396, loss_d: 0.097441
0.2681 --- loss: 0.912472, loss_ss: 0.751729, loss_d: 0.160743
0.3064 --- loss: 0.748726, loss_ss: 0.677901, loss_d: 0.070826
0.3447 --- loss: 1.204556, loss_ss: 1.021497, loss_d: 0.183058
0.3830 --- loss: 1.175433, loss_ss: 0.897566, loss_d: 0.277867
0.4213 --- loss: 0.922980, loss_ss: 0.828086, loss_d: 0.094894
0.4596 --- loss: 1.577313, loss_ss: 1.462488, loss_d: 0.114825
0.4979 --- loss: 1.089238, loss_ss: 0.987665, loss_d: 0.101573
0.5362 --- loss: 0.793630, loss_ss: 0.721653, loss_d: 0.071977
0.5745 --- loss: 0.841114, loss_ss: 0.662888, loss_d: 0.178226
0.6128 --- loss: 1.016930, loss_ss: 0.872979, loss_d: 0.143951
0.6511 --- loss: 1.145704, loss_ss: 0.813623, loss_d: 0.332081
0.6894 --- loss: 1.067212, loss_ss: 0.956224, loss_d: 0.110988
0.7277 --- loss: 1.065409, loss_ss: 0.972274, loss_d: 0.093134
0.7660 --- loss: 1.054516, loss_ss: 0.877160, loss_d: 0.177356
0.8043 --- loss: 1.190445, loss_ss: 1.095090, loss_d: 0.095356
0.8426 --- loss: 0.958392, loss_ss: 0.887156, loss_d: 0.071236
0.8809 --- loss: 0.935019, loss_ss: 0.903294, loss_d: 0.031725
0.9192 --- loss: 1.413641, loss_ss: 0.826787, loss_d: 0.586854
0.9575 --- loss: 0.899068, loss_ss: 0.777773, loss_d: 0.121295
0.9958 --- loss: 1.547967, loss_ss: 1.209481, loss_d: 0.338485
Epoch finished! Loss: 1.122566162398035
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.221625, loss_ss: 1.150313, loss_d: 0.071312
0.0383 --- loss: 1.348784, loss_ss: 1.278162, loss_d: 0.070622
0.0766 --- loss: 1.070939, loss_ss: 1.030248, loss_d: 0.040691
0.1149 --- loss: 0.885010, loss_ss: 0.848762, loss_d: 0.036249
0.1532 --- loss: 1.115691, loss_ss: 0.972459, loss_d: 0.143232
0.1915 --- loss: 0.852152, loss_ss: 0.774580, loss_d: 0.077571
0.2298 --- loss: 0.692807, loss_ss: 0.632995, loss_d: 0.059812
0.2681 --- loss: 1.213522, loss_ss: 1.111663, loss_d: 0.101859
0.3064 --- loss: 1.268288, loss_ss: 0.898769, loss_d: 0.369519
0.3447 --- loss: 1.033594, loss_ss: 0.948051, loss_d: 0.085543
0.3830 --- loss: 0.916155, loss_ss: 0.879925, loss_d: 0.036230
0.4213 --- loss: 1.370906, loss_ss: 1.219113, loss_d: 0.151793
0.4596 --- loss: 0.893314, loss_ss: 0.882331, loss_d: 0.010983
0.4979 --- loss: 1.000146, loss_ss: 0.790483, loss_d: 0.209664
0.5362 --- loss: 1.132499, loss_ss: 1.114190, loss_d: 0.018309
0.5745 --- loss: 0.780306, loss_ss: 0.757984, loss_d: 0.022322
0.6128 --- loss: 0.689324, loss_ss: 0.665494, loss_d: 0.023830
0.6511 --- loss: 1.280254, loss_ss: 0.695975, loss_d: 0.584279
0.6894 --- loss: 1.211152, loss_ss: 0.907077, loss_d: 0.304075
0.7277 --- loss: 1.089103, loss_ss: 0.794919, loss_d: 0.294183
0.7660 --- loss: 1.152881, loss_ss: 0.985076, loss_d: 0.167805
0.8043 --- loss: 0.922808, loss_ss: 0.723668, loss_d: 0.199139
0.8426 --- loss: 1.305216, loss_ss: 1.063358, loss_d: 0.241858
0.8809 --- loss: 0.810404, loss_ss: 0.717720, loss_d: 0.092684
0.9192 --- loss: 0.833056, loss_ss: 0.823644, loss_d: 0.009412
0.9575 --- loss: 0.992979, loss_ss: 0.918913, loss_d: 0.074065
0.9958 --- loss: 0.895977, loss_ss: 0.785204, loss_d: 0.110773
Epoch finished! Loss: 1.0824220454555817
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.353884, loss_ss: 1.148278, loss_d: 0.205606
0.0383 --- loss: 0.735330, loss_ss: 0.720923, loss_d: 0.014407
0.0766 --- loss: 1.261169, loss_ss: 0.975293, loss_d: 0.285876
0.1149 --- loss: 1.290316, loss_ss: 0.907464, loss_d: 0.382852
0.1532 --- loss: 0.920918, loss_ss: 0.873897, loss_d: 0.047021
0.1915 --- loss: 1.067357, loss_ss: 0.843405, loss_d: 0.223952
0.2298 --- loss: 0.948772, loss_ss: 0.814432, loss_d: 0.134340
0.2681 --- loss: 1.019059, loss_ss: 0.771359, loss_d: 0.247700
0.3064 --- loss: 1.300461, loss_ss: 1.067292, loss_d: 0.233170
0.3447 --- loss: 0.932245, loss_ss: 0.656255, loss_d: 0.275990
0.3830 --- loss: 0.945057, loss_ss: 0.929432, loss_d: 0.015625
0.4213 --- loss: 1.172316, loss_ss: 1.032776, loss_d: 0.139541
0.4596 --- loss: 0.964493, loss_ss: 0.932722, loss_d: 0.031771
0.4979 --- loss: 1.044504, loss_ss: 0.910061, loss_d: 0.134444
0.5362 --- loss: 0.847859, loss_ss: 0.832346, loss_d: 0.015513
0.5745 --- loss: 1.027478, loss_ss: 0.745657, loss_d: 0.281821
0.6128 --- loss: 1.376496, loss_ss: 1.333629, loss_d: 0.042866
0.6511 --- loss: 0.804308, loss_ss: 0.780490, loss_d: 0.023818
0.6894 --- loss: 1.006149, loss_ss: 0.845339, loss_d: 0.160810
0.7277 --- loss: 1.215635, loss_ss: 1.178547, loss_d: 0.037087
0.7660 --- loss: 0.991570, loss_ss: 0.979680, loss_d: 0.011891
0.8043 --- loss: 1.083587, loss_ss: 1.050821, loss_d: 0.032766
0.8426 --- loss: 1.017930, loss_ss: 0.977934, loss_d: 0.039997
0.8809 --- loss: 0.677854, loss_ss: 0.656072, loss_d: 0.021782
0.9192 --- loss: 0.831224, loss_ss: 0.687928, loss_d: 0.143296
0.9575 --- loss: 1.032696, loss_ss: 0.981539, loss_d: 0.051157
0.9958 --- loss: 1.015060, loss_ss: 0.868807, loss_d: 0.146253
Epoch finished! Loss: 1.0675736823301205
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.867924, loss_ss: 0.747384, loss_d: 0.120540
0.0383 --- loss: 0.811207, loss_ss: 0.657789, loss_d: 0.153418
0.0766 --- loss: 0.888251, loss_ss: 0.836712, loss_d: 0.051539
0.1149 --- loss: 0.864763, loss_ss: 0.800971, loss_d: 0.063792
0.1532 --- loss: 0.798969, loss_ss: 0.745568, loss_d: 0.053401
0.1915 --- loss: 1.090991, loss_ss: 1.039575, loss_d: 0.051416
0.2298 --- loss: 0.819117, loss_ss: 0.799460, loss_d: 0.019657
0.2681 --- loss: 0.919777, loss_ss: 0.860152, loss_d: 0.059625
0.3064 --- loss: 0.993071, loss_ss: 0.954356, loss_d: 0.038715
0.3447 --- loss: 1.356615, loss_ss: 1.011414, loss_d: 0.345202
0.3830 --- loss: 0.954776, loss_ss: 0.807984, loss_d: 0.146792
0.4213 --- loss: 1.179280, loss_ss: 0.969871, loss_d: 0.209409
0.4596 --- loss: 0.747741, loss_ss: 0.673314, loss_d: 0.074427
0.4979 --- loss: 1.045798, loss_ss: 0.938510, loss_d: 0.107288
0.5362 --- loss: 0.923406, loss_ss: 0.894598, loss_d: 0.028808
0.5745 --- loss: 0.867038, loss_ss: 0.793031, loss_d: 0.074007
0.6128 --- loss: 1.456563, loss_ss: 1.063684, loss_d: 0.392880
0.6511 --- loss: 0.835652, loss_ss: 0.769000, loss_d: 0.066652
0.6894 --- loss: 1.118707, loss_ss: 0.682909, loss_d: 0.435798
0.7277 --- loss: 0.834983, loss_ss: 0.813038, loss_d: 0.021945
0.7660 --- loss: 1.081613, loss_ss: 0.743151, loss_d: 0.338462
0.8043 --- loss: 0.892891, loss_ss: 0.662990, loss_d: 0.229902
0.8426 --- loss: 0.926322, loss_ss: 0.906846, loss_d: 0.019476
0.8809 --- loss: 1.397469, loss_ss: 1.352988, loss_d: 0.044480
0.9192 --- loss: 1.128583, loss_ss: 1.054217, loss_d: 0.074366
0.9575 --- loss: 1.370538, loss_ss: 1.352586, loss_d: 0.017952
0.9958 --- loss: 0.982007, loss_ss: 0.958741, loss_d: 0.023267
Epoch finished! Loss: 0.991799927991012
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.834245, loss_ss: 0.806075, loss_d: 0.028170
0.0383 --- loss: 0.926563, loss_ss: 0.812827, loss_d: 0.113736
0.0766 --- loss: 0.993450, loss_ss: 0.947889, loss_d: 0.045561
0.1149 --- loss: 0.749802, loss_ss: 0.644140, loss_d: 0.105662
0.1532 --- loss: 1.140555, loss_ss: 1.099380, loss_d: 0.041175
0.1915 --- loss: 0.965404, loss_ss: 0.927394, loss_d: 0.038010
0.2298 --- loss: 0.705204, loss_ss: 0.688111, loss_d: 0.017092
0.2681 --- loss: 0.788859, loss_ss: 0.765456, loss_d: 0.023403
0.3064 --- loss: 1.556184, loss_ss: 1.534065, loss_d: 0.022119
0.3447 --- loss: 1.225263, loss_ss: 0.868277, loss_d: 0.356986
0.3830 --- loss: 0.768581, loss_ss: 0.738697, loss_d: 0.029885
0.4213 --- loss: 1.065135, loss_ss: 0.946994, loss_d: 0.118141
0.4596 --- loss: 0.748147, loss_ss: 0.724128, loss_d: 0.024019
0.4979 --- loss: 0.982724, loss_ss: 0.968194, loss_d: 0.014529
0.5362 --- loss: 0.881715, loss_ss: 0.850674, loss_d: 0.031041
0.5745 --- loss: 1.112183, loss_ss: 0.963649, loss_d: 0.148535
0.6128 --- loss: 0.711994, loss_ss: 0.691698, loss_d: 0.020296
0.6511 --- loss: 0.894702, loss_ss: 0.814508, loss_d: 0.080194
0.6894 --- loss: 1.296953, loss_ss: 1.177285, loss_d: 0.119668
0.7277 --- loss: 0.796670, loss_ss: 0.771106, loss_d: 0.025564
0.7660 --- loss: 1.212287, loss_ss: 1.154348, loss_d: 0.057939
0.8043 --- loss: 1.027198, loss_ss: 0.777185, loss_d: 0.250013
0.8426 --- loss: 1.259593, loss_ss: 0.923085, loss_d: 0.336508
0.8809 --- loss: 1.046803, loss_ss: 1.003555, loss_d: 0.043247
0.9192 --- loss: 0.642364, loss_ss: 0.628984, loss_d: 0.013380
0.9575 --- loss: 0.820345, loss_ss: 0.815121, loss_d: 0.005225
0.9958 --- loss: 0.987296, loss_ss: 0.851009, loss_d: 0.136287
Epoch finished! Loss: 0.978649169777545
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6370370370370371
             precision    recall  f1-score   support

        0.0       0.38      0.20      0.26        30
        1.0       0.05      0.06      0.06        67
        2.0       0.90      0.61      0.73       427
        3.0       0.96      0.82      0.88       114
        4.0       0.45      0.88      0.60       172

avg / total       0.73      0.64      0.65       810
 


====== chc025-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.80  20.00   98.72  37.50     26.09
1  83.70   5.97   90.71   5.48      5.71
2  76.05  61.12   92.69  90.31     72.91
3  96.91  81.58   99.43  95.88     88.15
4  74.94  88.37   71.32  45.37     59.96
Total accuracy: 63.70%
Average sen: 51.41%
Average spec: 90.57%
Macro f1-score: 50.56%
Diagnosis acc on 15mins: 0.8148148148148148
[2.73855418e-01 2.09821332e-02 9.97062027e-01 9.17582214e-01
 1.42010108e-01 3.09065580e-01 1.92002207e-02 4.97197174e-03
 5.94381848e-03 5.74172940e-04 9.82259662e-05 1.55386247e-03
 2.19846424e-03 8.84234265e-04 3.72038931e-02 2.37450167e-03
 1.16858602e-01 9.16194558e-01 9.61067557e-01 1.37028825e-02
 4.05991403e-03 3.22748721e-01 1.67751790e-03 1.73786702e-03
 4.56623435e-01 5.69677591e-01 1.58290844e-02]
pred: 0.22650883614605172, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.380589, loss_ss: 1.644222, loss_d: 0.736367
0.0383 --- loss: 2.337017, loss_ss: 1.652954, loss_d: 0.684063
0.0767 --- loss: 2.373408, loss_ss: 1.707612, loss_d: 0.665797
0.1150 --- loss: 2.393823, loss_ss: 1.573493, loss_d: 0.820330
0.1534 --- loss: 1.909844, loss_ss: 1.470587, loss_d: 0.439257
0.1917 --- loss: 2.147542, loss_ss: 1.453733, loss_d: 0.693809
0.2301 --- loss: 2.085354, loss_ss: 1.410648, loss_d: 0.674706
0.2684 --- loss: 1.809856, loss_ss: 1.287362, loss_d: 0.522494
0.3067 --- loss: 1.885654, loss_ss: 1.314373, loss_d: 0.571281
0.3451 --- loss: 1.998180, loss_ss: 1.362679, loss_d: 0.635501
0.3834 --- loss: 1.810471, loss_ss: 1.248867, loss_d: 0.561604
0.4218 --- loss: 1.932064, loss_ss: 1.358307, loss_d: 0.573756
0.4601 --- loss: 1.699857, loss_ss: 1.256351, loss_d: 0.443506
0.4985 --- loss: 1.651073, loss_ss: 1.369190, loss_d: 0.281884
0.5368 --- loss: 1.831078, loss_ss: 1.190780, loss_d: 0.640298
0.5752 --- loss: 1.969811, loss_ss: 1.262385, loss_d: 0.707426
0.6135 --- loss: 1.957085, loss_ss: 1.269264, loss_d: 0.687822
0.6518 --- loss: 1.761890, loss_ss: 1.310818, loss_d: 0.451072
0.6902 --- loss: 1.600127, loss_ss: 1.144835, loss_d: 0.455292
0.7285 --- loss: 1.959271, loss_ss: 1.082706, loss_d: 0.876565
0.7669 --- loss: 1.511801, loss_ss: 1.094877, loss_d: 0.416924
0.8052 --- loss: 1.586752, loss_ss: 0.985758, loss_d: 0.600994
0.8436 --- loss: 1.666542, loss_ss: 1.180355, loss_d: 0.486187
0.8819 --- loss: 1.562583, loss_ss: 1.206348, loss_d: 0.356234
0.9202 --- loss: 1.836003, loss_ss: 1.099270, loss_d: 0.736732
0.9586 --- loss: 1.868803, loss_ss: 1.218180, loss_d: 0.650623
0.9969 --- loss: 1.672777, loss_ss: 1.201681, loss_d: 0.471096
Epoch finished! Loss: 1.8737694836579837
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.533435, loss_ss: 1.281578, loss_d: 0.251857
0.0383 --- loss: 1.577095, loss_ss: 0.956453, loss_d: 0.620643
0.0767 --- loss: 1.369843, loss_ss: 1.026316, loss_d: 0.343527
0.1150 --- loss: 1.501822, loss_ss: 1.312620, loss_d: 0.189202
0.1534 --- loss: 1.387724, loss_ss: 1.130039, loss_d: 0.257685
0.1917 --- loss: 1.686601, loss_ss: 1.070065, loss_d: 0.616535
0.2301 --- loss: 1.721728, loss_ss: 1.410537, loss_d: 0.311190
0.2684 --- loss: 1.672885, loss_ss: 1.049281, loss_d: 0.623604
0.3067 --- loss: 1.721997, loss_ss: 1.329330, loss_d: 0.392667
0.3451 --- loss: 1.291561, loss_ss: 1.028730, loss_d: 0.262830
0.3834 --- loss: 1.243608, loss_ss: 0.911924, loss_d: 0.331684
0.4218 --- loss: 1.703643, loss_ss: 1.159942, loss_d: 0.543701
0.4601 --- loss: 1.584675, loss_ss: 1.077525, loss_d: 0.507150
0.4985 --- loss: 1.740048, loss_ss: 1.486635, loss_d: 0.253413
0.5368 --- loss: 1.479068, loss_ss: 1.147316, loss_d: 0.331751
0.5752 --- loss: 1.585750, loss_ss: 1.350498, loss_d: 0.235252
0.6135 --- loss: 1.730532, loss_ss: 1.185480, loss_d: 0.545052
0.6518 --- loss: 1.473191, loss_ss: 1.215822, loss_d: 0.257370
0.6902 --- loss: 1.512695, loss_ss: 1.067850, loss_d: 0.444845
0.7285 --- loss: 1.425908, loss_ss: 1.025978, loss_d: 0.399930
0.7669 --- loss: 1.738744, loss_ss: 1.080757, loss_d: 0.657987
0.8052 --- loss: 1.392801, loss_ss: 1.020683, loss_d: 0.372119
0.8436 --- loss: 1.521810, loss_ss: 1.241956, loss_d: 0.279854
0.8819 --- loss: 1.444718, loss_ss: 1.283470, loss_d: 0.161249
0.9202 --- loss: 1.766036, loss_ss: 0.958560, loss_d: 0.807476
0.9586 --- loss: 1.470127, loss_ss: 1.046686, loss_d: 0.423440
0.9969 --- loss: 1.747836, loss_ss: 1.526413, loss_d: 0.221423
Epoch finished! Loss: 1.509860371167843
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.522779, loss_ss: 1.250600, loss_d: 0.272178
0.0383 --- loss: 1.365505, loss_ss: 0.932399, loss_d: 0.433107
0.0767 --- loss: 1.240540, loss_ss: 0.819150, loss_d: 0.421390
0.1150 --- loss: 1.242664, loss_ss: 0.939663, loss_d: 0.303001
0.1534 --- loss: 1.731130, loss_ss: 1.180042, loss_d: 0.551088
0.1917 --- loss: 1.297628, loss_ss: 1.007840, loss_d: 0.289788
0.2301 --- loss: 2.688849, loss_ss: 1.043640, loss_d: 1.645208
0.2684 --- loss: 1.575483, loss_ss: 0.973548, loss_d: 0.601936
0.3067 --- loss: 1.195931, loss_ss: 1.041272, loss_d: 0.154659
0.3451 --- loss: 1.020102, loss_ss: 0.793121, loss_d: 0.226981
0.3834 --- loss: 1.423302, loss_ss: 1.309318, loss_d: 0.113983
0.4218 --- loss: 1.072515, loss_ss: 0.948479, loss_d: 0.124036
0.4601 --- loss: 1.529120, loss_ss: 1.317233, loss_d: 0.211887
0.4985 --- loss: 1.245877, loss_ss: 0.907964, loss_d: 0.337913
0.5368 --- loss: 1.351118, loss_ss: 0.891394, loss_d: 0.459725
0.5752 --- loss: 1.404408, loss_ss: 1.147515, loss_d: 0.256893
0.6135 --- loss: 1.415744, loss_ss: 0.972181, loss_d: 0.443563
0.6518 --- loss: 1.621721, loss_ss: 0.764306, loss_d: 0.857415
0.6902 --- loss: 1.214214, loss_ss: 0.991716, loss_d: 0.222497
0.7285 --- loss: 1.581197, loss_ss: 1.413149, loss_d: 0.168048
0.7669 --- loss: 1.220130, loss_ss: 1.157832, loss_d: 0.062299
0.8052 --- loss: 1.538687, loss_ss: 1.113268, loss_d: 0.425419
0.8436 --- loss: 1.168945, loss_ss: 1.031965, loss_d: 0.136979
0.8819 --- loss: 1.167890, loss_ss: 1.044920, loss_d: 0.122970
0.9202 --- loss: 1.250078, loss_ss: 0.888540, loss_d: 0.361538
0.9586 --- loss: 1.291263, loss_ss: 0.910732, loss_d: 0.380531
0.9969 --- loss: 1.396378, loss_ss: 0.996969, loss_d: 0.399409
Epoch finished! Loss: 1.3419037972505277
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.274165, loss_ss: 0.985428, loss_d: 0.288737
0.0383 --- loss: 1.237163, loss_ss: 0.808894, loss_d: 0.428269
0.0767 --- loss: 1.468002, loss_ss: 1.058780, loss_d: 0.409223
0.1150 --- loss: 1.003979, loss_ss: 0.763160, loss_d: 0.240819
0.1534 --- loss: 1.041722, loss_ss: 0.844247, loss_d: 0.197474
0.1917 --- loss: 1.106076, loss_ss: 0.781348, loss_d: 0.324728
0.2301 --- loss: 1.097223, loss_ss: 0.872684, loss_d: 0.224539
0.2684 --- loss: 1.022549, loss_ss: 0.900957, loss_d: 0.121592
0.3067 --- loss: 1.402822, loss_ss: 1.154088, loss_d: 0.248733
0.3451 --- loss: 1.308585, loss_ss: 1.074176, loss_d: 0.234409
0.3834 --- loss: 1.164943, loss_ss: 0.960815, loss_d: 0.204128
0.4218 --- loss: 1.745883, loss_ss: 0.982777, loss_d: 0.763105
0.4601 --- loss: 1.417643, loss_ss: 1.155651, loss_d: 0.261992
0.4985 --- loss: 1.243933, loss_ss: 1.116359, loss_d: 0.127575
0.5368 --- loss: 1.300535, loss_ss: 0.986894, loss_d: 0.313640
0.5752 --- loss: 1.070992, loss_ss: 0.871450, loss_d: 0.199543
0.6135 --- loss: 0.927024, loss_ss: 0.578077, loss_d: 0.348947
0.6518 --- loss: 1.375636, loss_ss: 1.132765, loss_d: 0.242871
0.6902 --- loss: 1.493742, loss_ss: 1.036425, loss_d: 0.457317
0.7285 --- loss: 1.170989, loss_ss: 0.826288, loss_d: 0.344700
0.7669 --- loss: 1.364042, loss_ss: 1.018429, loss_d: 0.345612
0.8052 --- loss: 0.780276, loss_ss: 0.697713, loss_d: 0.082563
0.8436 --- loss: 1.115821, loss_ss: 0.991079, loss_d: 0.124743
0.8819 --- loss: 0.965036, loss_ss: 0.731767, loss_d: 0.233269
0.9202 --- loss: 1.076951, loss_ss: 1.024493, loss_d: 0.052458
0.9586 --- loss: 1.570419, loss_ss: 1.017381, loss_d: 0.553038
0.9969 --- loss: 1.164254, loss_ss: 0.931262, loss_d: 0.232992
Epoch finished! Loss: 1.2121024714066433
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.290081, loss_ss: 0.697267, loss_d: 0.592813
0.0383 --- loss: 1.099049, loss_ss: 0.999529, loss_d: 0.099520
0.0767 --- loss: 0.977889, loss_ss: 0.909482, loss_d: 0.068407
0.1150 --- loss: 1.147695, loss_ss: 0.907758, loss_d: 0.239937
0.1534 --- loss: 0.851291, loss_ss: 0.779729, loss_d: 0.071562
0.1917 --- loss: 1.378696, loss_ss: 1.209777, loss_d: 0.168919
0.2301 --- loss: 1.050031, loss_ss: 0.934495, loss_d: 0.115536
0.2684 --- loss: 0.691036, loss_ss: 0.572240, loss_d: 0.118796
0.3067 --- loss: 0.880184, loss_ss: 0.747992, loss_d: 0.132193
0.3451 --- loss: 1.956269, loss_ss: 1.099699, loss_d: 0.856570
0.3834 --- loss: 0.987839, loss_ss: 0.840798, loss_d: 0.147042
0.4218 --- loss: 1.107531, loss_ss: 0.774203, loss_d: 0.333328
0.4601 --- loss: 1.389210, loss_ss: 0.863462, loss_d: 0.525748
0.4985 --- loss: 0.937257, loss_ss: 0.899792, loss_d: 0.037465
0.5368 --- loss: 1.318003, loss_ss: 0.943516, loss_d: 0.374487
0.5752 --- loss: 1.031611, loss_ss: 0.766748, loss_d: 0.264863
0.6135 --- loss: 0.867156, loss_ss: 0.745601, loss_d: 0.121555
0.6518 --- loss: 1.343605, loss_ss: 1.135189, loss_d: 0.208415
0.6902 --- loss: 1.467631, loss_ss: 0.913361, loss_d: 0.554270
0.7285 --- loss: 1.014276, loss_ss: 0.859202, loss_d: 0.155075
0.7669 --- loss: 1.776732, loss_ss: 1.490595, loss_d: 0.286137
0.8052 --- loss: 1.297837, loss_ss: 1.159508, loss_d: 0.138329
0.8436 --- loss: 1.444405, loss_ss: 1.323657, loss_d: 0.120748
0.8819 --- loss: 1.207331, loss_ss: 0.987543, loss_d: 0.219787
0.9202 --- loss: 1.079413, loss_ss: 0.918895, loss_d: 0.160518
0.9586 --- loss: 1.054907, loss_ss: 0.950082, loss_d: 0.104825
0.9969 --- loss: 0.894584, loss_ss: 0.810978, loss_d: 0.083606
Epoch finished! Loss: 1.156249250127719
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.790797, loss_ss: 0.734915, loss_d: 0.055882
0.0383 --- loss: 1.065578, loss_ss: 0.826708, loss_d: 0.238870
0.0767 --- loss: 1.343666, loss_ss: 0.604579, loss_d: 0.739087
0.1150 --- loss: 1.108587, loss_ss: 0.943445, loss_d: 0.165142
0.1534 --- loss: 1.168622, loss_ss: 0.974425, loss_d: 0.194197
0.1917 --- loss: 0.932519, loss_ss: 0.848115, loss_d: 0.084405
0.2301 --- loss: 1.206235, loss_ss: 0.896312, loss_d: 0.309923
0.2684 --- loss: 1.099607, loss_ss: 1.025527, loss_d: 0.074080
0.3067 --- loss: 1.069335, loss_ss: 0.901881, loss_d: 0.167454
0.3451 --- loss: 0.879861, loss_ss: 0.667135, loss_d: 0.212726
0.3834 --- loss: 1.198883, loss_ss: 0.759990, loss_d: 0.438893
0.4218 --- loss: 1.036085, loss_ss: 0.753488, loss_d: 0.282597
0.4601 --- loss: 1.106051, loss_ss: 0.953682, loss_d: 0.152369
0.4985 --- loss: 1.089186, loss_ss: 1.028940, loss_d: 0.060246
0.5368 --- loss: 1.137721, loss_ss: 0.975608, loss_d: 0.162114
0.5752 --- loss: 1.008609, loss_ss: 0.534605, loss_d: 0.474005
0.6135 --- loss: 0.938936, loss_ss: 0.709232, loss_d: 0.229705
0.6518 --- loss: 0.942631, loss_ss: 0.924359, loss_d: 0.018272
0.6902 --- loss: 0.929602, loss_ss: 0.833838, loss_d: 0.095764
0.7285 --- loss: 0.790219, loss_ss: 0.603854, loss_d: 0.186365
0.7669 --- loss: 1.172907, loss_ss: 0.970994, loss_d: 0.201913
0.8052 --- loss: 1.379028, loss_ss: 0.892938, loss_d: 0.486090
0.8436 --- loss: 1.280757, loss_ss: 1.111764, loss_d: 0.168993
0.8819 --- loss: 1.344517, loss_ss: 0.894054, loss_d: 0.450463
0.9202 --- loss: 1.373307, loss_ss: 1.102390, loss_d: 0.270917
0.9586 --- loss: 1.057049, loss_ss: 0.949700, loss_d: 0.107349
0.9969 --- loss: 1.496136, loss_ss: 1.014282, loss_d: 0.481854
Epoch finished! Loss: 1.1168407566272296
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.925655, loss_ss: 0.783470, loss_d: 0.142185
0.0383 --- loss: 0.958939, loss_ss: 0.738521, loss_d: 0.220418
0.0767 --- loss: 1.040336, loss_ss: 0.861732, loss_d: 0.178604
0.1150 --- loss: 1.306607, loss_ss: 1.108326, loss_d: 0.198281
0.1534 --- loss: 1.041401, loss_ss: 1.013469, loss_d: 0.027933
0.1917 --- loss: 1.293772, loss_ss: 1.160483, loss_d: 0.133289
0.2301 --- loss: 0.957146, loss_ss: 0.895078, loss_d: 0.062068
0.2684 --- loss: 1.202569, loss_ss: 0.924112, loss_d: 0.278457
0.3067 --- loss: 0.963655, loss_ss: 0.814431, loss_d: 0.149224
0.3451 --- loss: 0.890971, loss_ss: 0.791562, loss_d: 0.099409
0.3834 --- loss: 0.822589, loss_ss: 0.731349, loss_d: 0.091241
0.4218 --- loss: 1.320200, loss_ss: 0.781812, loss_d: 0.538388
0.4601 --- loss: 1.090857, loss_ss: 1.069777, loss_d: 0.021080
0.4985 --- loss: 0.665866, loss_ss: 0.659470, loss_d: 0.006395
0.5368 --- loss: 1.049731, loss_ss: 0.984140, loss_d: 0.065591
0.5752 --- loss: 1.212701, loss_ss: 0.832457, loss_d: 0.380244
0.6135 --- loss: 1.528878, loss_ss: 1.350391, loss_d: 0.178487
0.6518 --- loss: 0.812810, loss_ss: 0.681190, loss_d: 0.131620
0.6902 --- loss: 0.626003, loss_ss: 0.563560, loss_d: 0.062443
0.7285 --- loss: 0.908169, loss_ss: 0.776030, loss_d: 0.132139
0.7669 --- loss: 0.866176, loss_ss: 0.729855, loss_d: 0.136321
0.8052 --- loss: 0.806187, loss_ss: 0.756813, loss_d: 0.049374
0.8436 --- loss: 0.818167, loss_ss: 0.753029, loss_d: 0.065138
0.8819 --- loss: 1.064594, loss_ss: 0.728668, loss_d: 0.335927
0.9202 --- loss: 1.357296, loss_ss: 1.128316, loss_d: 0.228980
0.9586 --- loss: 1.151167, loss_ss: 0.796283, loss_d: 0.354883
0.9969 --- loss: 1.074828, loss_ss: 1.003708, loss_d: 0.071121
Epoch finished! Loss: 1.0422548580628175
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.303389, loss_ss: 1.036135, loss_d: 0.267254
0.0383 --- loss: 0.647974, loss_ss: 0.596360, loss_d: 0.051614
0.0767 --- loss: 1.080958, loss_ss: 0.839950, loss_d: 0.241008
0.1150 --- loss: 1.356101, loss_ss: 1.092598, loss_d: 0.263503
0.1534 --- loss: 0.774110, loss_ss: 0.637858, loss_d: 0.136252
0.1917 --- loss: 0.802840, loss_ss: 0.750038, loss_d: 0.052802
0.2301 --- loss: 1.359873, loss_ss: 1.191252, loss_d: 0.168621
0.2684 --- loss: 0.966396, loss_ss: 0.920596, loss_d: 0.045800
0.3067 --- loss: 0.976349, loss_ss: 0.695837, loss_d: 0.280512
0.3451 --- loss: 0.786255, loss_ss: 0.748511, loss_d: 0.037743
0.3834 --- loss: 0.865563, loss_ss: 0.707129, loss_d: 0.158435
0.4218 --- loss: 1.852210, loss_ss: 0.826529, loss_d: 1.025681
0.4601 --- loss: 1.522052, loss_ss: 1.087342, loss_d: 0.434711
0.4985 --- loss: 0.698567, loss_ss: 0.670860, loss_d: 0.027706
0.5368 --- loss: 1.062820, loss_ss: 1.015533, loss_d: 0.047288
0.5752 --- loss: 0.688078, loss_ss: 0.652898, loss_d: 0.035180
0.6135 --- loss: 1.111714, loss_ss: 0.999897, loss_d: 0.111817
0.6518 --- loss: 0.777599, loss_ss: 0.681257, loss_d: 0.096342
0.6902 --- loss: 0.981686, loss_ss: 0.784136, loss_d: 0.197550
0.7285 --- loss: 1.191468, loss_ss: 1.089113, loss_d: 0.102355
0.7669 --- loss: 0.944831, loss_ss: 0.763290, loss_d: 0.181541
0.8052 --- loss: 1.126064, loss_ss: 0.936230, loss_d: 0.189834
0.8436 --- loss: 1.006208, loss_ss: 0.988030, loss_d: 0.018178
0.8819 --- loss: 1.521053, loss_ss: 1.155664, loss_d: 0.365389
0.9202 --- loss: 1.489654, loss_ss: 0.842232, loss_d: 0.647421
0.9586 --- loss: 1.194117, loss_ss: 0.611733, loss_d: 0.582384
0.9969 --- loss: 1.292910, loss_ss: 1.088156, loss_d: 0.204754
Epoch finished! Loss: 1.007320767411819
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.873671, loss_ss: 0.759363, loss_d: 0.114308
0.0383 --- loss: 0.829580, loss_ss: 0.762401, loss_d: 0.067178
0.0767 --- loss: 0.894698, loss_ss: 0.785488, loss_d: 0.109210
0.1150 --- loss: 0.916622, loss_ss: 0.848779, loss_d: 0.067843
0.1534 --- loss: 0.926377, loss_ss: 0.831524, loss_d: 0.094853
0.1917 --- loss: 0.977218, loss_ss: 0.943715, loss_d: 0.033502
0.2301 --- loss: 0.900008, loss_ss: 0.755956, loss_d: 0.144052
0.2684 --- loss: 1.067392, loss_ss: 1.030328, loss_d: 0.037064
0.3067 --- loss: 1.128673, loss_ss: 1.014029, loss_d: 0.114644
0.3451 --- loss: 0.706023, loss_ss: 0.636290, loss_d: 0.069734
0.3834 --- loss: 0.899490, loss_ss: 0.893252, loss_d: 0.006238
0.4218 --- loss: 0.855799, loss_ss: 0.812598, loss_d: 0.043202
0.4601 --- loss: 1.069087, loss_ss: 0.949860, loss_d: 0.119227
0.4985 --- loss: 1.223382, loss_ss: 0.871567, loss_d: 0.351815
0.5368 --- loss: 0.714906, loss_ss: 0.686046, loss_d: 0.028860
0.5752 --- loss: 1.127061, loss_ss: 0.947083, loss_d: 0.179978
0.6135 --- loss: 1.101874, loss_ss: 0.708323, loss_d: 0.393552
0.6518 --- loss: 0.980311, loss_ss: 0.872669, loss_d: 0.107642
0.6902 --- loss: 0.789218, loss_ss: 0.705132, loss_d: 0.084086
0.7285 --- loss: 0.832237, loss_ss: 0.726348, loss_d: 0.105889
0.7669 --- loss: 0.886732, loss_ss: 0.829444, loss_d: 0.057288
0.8052 --- loss: 0.759233, loss_ss: 0.725741, loss_d: 0.033492
0.8436 --- loss: 1.030272, loss_ss: 0.781084, loss_d: 0.249188
0.8819 --- loss: 0.860877, loss_ss: 0.788446, loss_d: 0.072431
0.9202 --- loss: 1.104988, loss_ss: 1.032143, loss_d: 0.072845
0.9586 --- loss: 0.760317, loss_ss: 0.741899, loss_d: 0.018419
0.9969 --- loss: 0.942214, loss_ss: 0.897302, loss_d: 0.044911
Epoch finished! Loss: 0.9866085031857857
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.942431, loss_ss: 0.932880, loss_d: 0.009551
0.0383 --- loss: 0.967755, loss_ss: 0.951608, loss_d: 0.016147
0.0767 --- loss: 0.906137, loss_ss: 0.854630, loss_d: 0.051507
0.1150 --- loss: 1.076808, loss_ss: 1.021807, loss_d: 0.055001
0.1534 --- loss: 0.675692, loss_ss: 0.664540, loss_d: 0.011152
0.1917 --- loss: 0.973351, loss_ss: 0.949190, loss_d: 0.024161
0.2301 --- loss: 1.130534, loss_ss: 0.691241, loss_d: 0.439293
0.2684 --- loss: 0.915163, loss_ss: 0.902432, loss_d: 0.012731
0.3067 --- loss: 1.128012, loss_ss: 1.115274, loss_d: 0.012738
0.3451 --- loss: 0.714303, loss_ss: 0.699124, loss_d: 0.015179
0.3834 --- loss: 1.027167, loss_ss: 0.901331, loss_d: 0.125836
0.4218 --- loss: 0.649572, loss_ss: 0.558903, loss_d: 0.090669
0.4601 --- loss: 0.751313, loss_ss: 0.614630, loss_d: 0.136683
0.4985 --- loss: 1.040147, loss_ss: 0.768561, loss_d: 0.271586
0.5368 --- loss: 0.868656, loss_ss: 0.823379, loss_d: 0.045276
0.5752 --- loss: 1.134880, loss_ss: 0.900085, loss_d: 0.234795
0.6135 --- loss: 0.818647, loss_ss: 0.743540, loss_d: 0.075107
0.6518 --- loss: 1.070629, loss_ss: 0.951358, loss_d: 0.119272
0.6902 --- loss: 0.738122, loss_ss: 0.693641, loss_d: 0.044481
0.7285 --- loss: 0.958803, loss_ss: 0.727823, loss_d: 0.230979
0.7669 --- loss: 0.679380, loss_ss: 0.610634, loss_d: 0.068746
0.8052 --- loss: 0.971260, loss_ss: 0.775616, loss_d: 0.195645
0.8436 --- loss: 1.039965, loss_ss: 1.029783, loss_d: 0.010182
0.8819 --- loss: 0.781665, loss_ss: 0.764646, loss_d: 0.017019
0.9202 --- loss: 1.236427, loss_ss: 0.847680, loss_d: 0.388748
0.9586 --- loss: 0.640653, loss_ss: 0.633673, loss_d: 0.006979
0.9969 --- loss: 0.896786, loss_ss: 0.780109, loss_d: 0.116677
Epoch finished! Loss: 0.9702449890283438
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.79
             precision    recall  f1-score   support

        0.0       0.96      0.67      0.79       277
        1.0       0.33      0.61      0.42        66
        2.0       0.76      0.95      0.84       293
        3.0       1.00      0.84      0.91       189
        4.0       0.83      0.64      0.72        75

avg / total       0.85      0.79      0.80       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  89.00  67.15   98.72   95.88     78.98
1  87.89  60.61   90.05   32.52     42.33
2  88.56  94.88   85.50   75.96     84.37
3  96.67  84.13  100.00  100.00     91.38
4  95.89  64.00   98.79   82.76     72.18
Total accuracy: 79.00%
Average sen: 74.15%
Average spec: 94.61%
Macro f1-score: 73.85%
Diagnosis acc on 15mins: 0.8
[0.43382415 0.83038062 0.27036673 0.35505202 0.07955678 0.3411409
 0.08458871 0.16204177 0.07407144 0.07422812 0.03872857 0.06720925
 0.04464074 0.57143182 0.33792558 0.55307651 0.3753936  0.22274588
 0.05884741 0.21540537 0.02698874 0.01350797 0.06933234 0.96273637
 0.7075277  0.5085727  0.0407462  0.08067985 0.09491582 0.01238491]
pred: 0.25693495214606327, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.430625, loss_ss: 1.732249, loss_d: 0.698375
0.0383 --- loss: 2.341677, loss_ss: 1.682531, loss_d: 0.659145
0.0767 --- loss: 2.666835, loss_ss: 1.774520, loss_d: 0.892315
0.1150 --- loss: 2.372542, loss_ss: 1.591935, loss_d: 0.780607
0.1533 --- loss: 2.202938, loss_ss: 1.606018, loss_d: 0.596920
0.1916 --- loss: 2.185775, loss_ss: 1.446506, loss_d: 0.739269
0.2300 --- loss: 2.285983, loss_ss: 1.508572, loss_d: 0.777410
0.2683 --- loss: 2.266626, loss_ss: 1.574654, loss_d: 0.691972
0.3066 --- loss: 1.723082, loss_ss: 1.350806, loss_d: 0.372276
0.3450 --- loss: 2.037361, loss_ss: 1.562612, loss_d: 0.474749
0.3833 --- loss: 1.743821, loss_ss: 1.219448, loss_d: 0.524374
0.4216 --- loss: 2.190956, loss_ss: 1.384074, loss_d: 0.806882
0.4599 --- loss: 1.962369, loss_ss: 1.571118, loss_d: 0.391250
0.4983 --- loss: 1.580796, loss_ss: 1.100140, loss_d: 0.480656
0.5366 --- loss: 2.019056, loss_ss: 1.232479, loss_d: 0.786577
0.5749 --- loss: 1.925340, loss_ss: 1.521159, loss_d: 0.404181
0.6133 --- loss: 1.878723, loss_ss: 1.344219, loss_d: 0.534505
0.6516 --- loss: 1.606275, loss_ss: 1.270866, loss_d: 0.335409
0.6899 --- loss: 1.934327, loss_ss: 1.412762, loss_d: 0.521565
0.7282 --- loss: 1.861939, loss_ss: 1.202496, loss_d: 0.659443
0.7666 --- loss: 2.041244, loss_ss: 1.356485, loss_d: 0.684758
0.8049 --- loss: 1.820355, loss_ss: 1.176208, loss_d: 0.644146
0.8432 --- loss: 1.953282, loss_ss: 1.096681, loss_d: 0.856601
0.8816 --- loss: 1.945402, loss_ss: 1.540613, loss_d: 0.404789
0.9199 --- loss: 1.812206, loss_ss: 1.295989, loss_d: 0.516216
0.9582 --- loss: 1.682448, loss_ss: 1.093828, loss_d: 0.588621
0.9966 --- loss: 1.519992, loss_ss: 1.152925, loss_d: 0.367067
Epoch finished! Loss: 1.9438241192927728
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.402037, loss_ss: 1.154224, loss_d: 0.247813
0.0383 --- loss: 1.444242, loss_ss: 1.098230, loss_d: 0.346012
0.0767 --- loss: 1.504434, loss_ss: 1.173338, loss_d: 0.331096
0.1150 --- loss: 1.496686, loss_ss: 1.190566, loss_d: 0.306119
0.1533 --- loss: 1.298945, loss_ss: 1.055389, loss_d: 0.243556
0.1916 --- loss: 1.691087, loss_ss: 1.230540, loss_d: 0.460546
0.2300 --- loss: 1.455437, loss_ss: 1.386189, loss_d: 0.069248
0.2683 --- loss: 1.934635, loss_ss: 1.386849, loss_d: 0.547785
0.3066 --- loss: 1.609252, loss_ss: 1.241820, loss_d: 0.367433
0.3450 --- loss: 1.608051, loss_ss: 1.215054, loss_d: 0.392997
0.3833 --- loss: 1.604090, loss_ss: 1.083501, loss_d: 0.520589
0.4216 --- loss: 1.592120, loss_ss: 1.292509, loss_d: 0.299612
0.4599 --- loss: 1.274618, loss_ss: 1.164822, loss_d: 0.109796
0.4983 --- loss: 2.079553, loss_ss: 1.339536, loss_d: 0.740017
0.5366 --- loss: 1.993500, loss_ss: 0.972651, loss_d: 1.020849
0.5749 --- loss: 1.388597, loss_ss: 1.209166, loss_d: 0.179431
0.6133 --- loss: 1.229676, loss_ss: 0.960402, loss_d: 0.269274
0.6516 --- loss: 1.317501, loss_ss: 1.133595, loss_d: 0.183906
0.6899 --- loss: 1.298699, loss_ss: 1.086853, loss_d: 0.211846
0.7282 --- loss: 1.323245, loss_ss: 1.067196, loss_d: 0.256049
0.7666 --- loss: 1.425418, loss_ss: 1.117225, loss_d: 0.308194
0.8049 --- loss: 1.344958, loss_ss: 0.865769, loss_d: 0.479189
0.8432 --- loss: 1.360569, loss_ss: 1.091167, loss_d: 0.269402
0.8816 --- loss: 1.315938, loss_ss: 1.204545, loss_d: 0.111392
0.9199 --- loss: 1.777912, loss_ss: 1.130319, loss_d: 0.647592
0.9582 --- loss: 1.250104, loss_ss: 1.048531, loss_d: 0.201573
0.9966 --- loss: 1.451304, loss_ss: 1.054593, loss_d: 0.396711
Epoch finished! Loss: 1.4831490124647433
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.242002, loss_ss: 1.028399, loss_d: 0.213603
0.0383 --- loss: 1.406118, loss_ss: 0.844701, loss_d: 0.561417
0.0767 --- loss: 1.454611, loss_ss: 1.262164, loss_d: 0.192447
0.1150 --- loss: 1.055637, loss_ss: 0.881500, loss_d: 0.174137
0.1533 --- loss: 1.624913, loss_ss: 1.393921, loss_d: 0.230992
0.1916 --- loss: 1.543045, loss_ss: 1.175958, loss_d: 0.367088
0.2300 --- loss: 1.197145, loss_ss: 0.929285, loss_d: 0.267861
0.2683 --- loss: 1.531021, loss_ss: 0.833893, loss_d: 0.697128
0.3066 --- loss: 1.270507, loss_ss: 0.948424, loss_d: 0.322083
0.3450 --- loss: 1.117270, loss_ss: 0.929077, loss_d: 0.188193
0.3833 --- loss: 0.931466, loss_ss: 0.861836, loss_d: 0.069630
0.4216 --- loss: 1.063603, loss_ss: 0.990288, loss_d: 0.073315
0.4599 --- loss: 1.556650, loss_ss: 1.232049, loss_d: 0.324602
0.4983 --- loss: 1.249555, loss_ss: 1.197326, loss_d: 0.052229
0.5366 --- loss: 1.206633, loss_ss: 1.144514, loss_d: 0.062119
0.5749 --- loss: 1.332932, loss_ss: 1.035451, loss_d: 0.297481
0.6133 --- loss: 1.308036, loss_ss: 1.020637, loss_d: 0.287399
0.6516 --- loss: 1.204798, loss_ss: 1.081599, loss_d: 0.123199
0.6899 --- loss: 1.792299, loss_ss: 1.601427, loss_d: 0.190871
0.7282 --- loss: 1.321156, loss_ss: 1.031537, loss_d: 0.289618
0.7666 --- loss: 0.947221, loss_ss: 0.876886, loss_d: 0.070335
0.8049 --- loss: 0.982214, loss_ss: 0.936067, loss_d: 0.046147
0.8432 --- loss: 1.193594, loss_ss: 1.065487, loss_d: 0.128107
0.8816 --- loss: 1.141784, loss_ss: 1.042255, loss_d: 0.099530
0.9199 --- loss: 1.575973, loss_ss: 1.266883, loss_d: 0.309090
0.9582 --- loss: 1.276924, loss_ss: 1.192975, loss_d: 0.083949
0.9966 --- loss: 1.215283, loss_ss: 1.095168, loss_d: 0.120115
Epoch finished! Loss: 1.323596005485608
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.063754, loss_ss: 0.957212, loss_d: 0.106543
0.0383 --- loss: 1.321633, loss_ss: 1.027599, loss_d: 0.294034
0.0767 --- loss: 1.106271, loss_ss: 0.911446, loss_d: 0.194825
0.1150 --- loss: 1.268624, loss_ss: 1.123822, loss_d: 0.144802
0.1533 --- loss: 1.111772, loss_ss: 1.008473, loss_d: 0.103299
0.1916 --- loss: 1.138216, loss_ss: 1.089404, loss_d: 0.048812
0.2300 --- loss: 1.214619, loss_ss: 1.136562, loss_d: 0.078056
0.2683 --- loss: 0.989781, loss_ss: 0.692309, loss_d: 0.297472
0.3066 --- loss: 1.244108, loss_ss: 0.941532, loss_d: 0.302576
0.3450 --- loss: 1.303182, loss_ss: 1.021054, loss_d: 0.282128
0.3833 --- loss: 1.753165, loss_ss: 1.103506, loss_d: 0.649659
0.4216 --- loss: 1.041616, loss_ss: 0.915378, loss_d: 0.126239
0.4599 --- loss: 1.020831, loss_ss: 0.933672, loss_d: 0.087159
0.4983 --- loss: 0.925226, loss_ss: 0.874202, loss_d: 0.051024
0.5366 --- loss: 1.427071, loss_ss: 0.912410, loss_d: 0.514661
0.5749 --- loss: 1.284295, loss_ss: 1.035336, loss_d: 0.248959
0.6133 --- loss: 1.147500, loss_ss: 0.916401, loss_d: 0.231099
0.6516 --- loss: 1.059705, loss_ss: 0.844080, loss_d: 0.215625
0.6899 --- loss: 1.189018, loss_ss: 1.062167, loss_d: 0.126851
0.7282 --- loss: 1.347047, loss_ss: 0.756641, loss_d: 0.590406
0.7666 --- loss: 1.296316, loss_ss: 1.137883, loss_d: 0.158433
0.8049 --- loss: 1.038593, loss_ss: 0.940657, loss_d: 0.097936
0.8432 --- loss: 1.732532, loss_ss: 0.917516, loss_d: 0.815016
0.8816 --- loss: 1.186454, loss_ss: 1.041976, loss_d: 0.144477
0.9199 --- loss: 1.274687, loss_ss: 1.058981, loss_d: 0.215706
0.9582 --- loss: 1.117169, loss_ss: 1.052697, loss_d: 0.064473
0.9966 --- loss: 1.711923, loss_ss: 1.170607, loss_d: 0.541315
Epoch finished! Loss: 1.235156830228292
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.877929, loss_ss: 0.850079, loss_d: 0.027850
0.0383 --- loss: 1.219119, loss_ss: 0.973783, loss_d: 0.245336
0.0767 --- loss: 1.204342, loss_ss: 1.059618, loss_d: 0.144723
0.1150 --- loss: 1.011340, loss_ss: 0.896124, loss_d: 0.115216
0.1533 --- loss: 0.843137, loss_ss: 0.779441, loss_d: 0.063697
0.1916 --- loss: 1.395190, loss_ss: 0.851737, loss_d: 0.543453
0.2300 --- loss: 1.184497, loss_ss: 1.146060, loss_d: 0.038437
0.2683 --- loss: 1.134303, loss_ss: 0.848436, loss_d: 0.285867
0.3066 --- loss: 0.994107, loss_ss: 0.889653, loss_d: 0.104454
0.3450 --- loss: 0.987568, loss_ss: 0.789795, loss_d: 0.197774
0.3833 --- loss: 1.153891, loss_ss: 1.084705, loss_d: 0.069186
0.4216 --- loss: 1.319922, loss_ss: 1.170620, loss_d: 0.149302
0.4599 --- loss: 1.071478, loss_ss: 0.936050, loss_d: 0.135428
0.4983 --- loss: 1.070263, loss_ss: 1.024801, loss_d: 0.045462
0.5366 --- loss: 1.181483, loss_ss: 1.126531, loss_d: 0.054952
0.5749 --- loss: 1.202647, loss_ss: 1.151940, loss_d: 0.050707
0.6133 --- loss: 0.866266, loss_ss: 0.807231, loss_d: 0.059035
0.6516 --- loss: 1.022170, loss_ss: 1.009677, loss_d: 0.012494
0.6899 --- loss: 1.150474, loss_ss: 1.111925, loss_d: 0.038549
0.7282 --- loss: 0.973304, loss_ss: 0.916538, loss_d: 0.056766
0.7666 --- loss: 1.131276, loss_ss: 1.049112, loss_d: 0.082164
0.8049 --- loss: 1.105748, loss_ss: 1.040727, loss_d: 0.065021
0.8432 --- loss: 1.144983, loss_ss: 0.913595, loss_d: 0.231388
0.8816 --- loss: 1.096255, loss_ss: 0.881903, loss_d: 0.214352
0.9199 --- loss: 0.961822, loss_ss: 0.940551, loss_d: 0.021271
0.9582 --- loss: 1.275987, loss_ss: 1.108005, loss_d: 0.167982
0.9966 --- loss: 0.980792, loss_ss: 0.893454, loss_d: 0.087338
Epoch finished! Loss: 1.1381412758277012
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.831313, loss_ss: 0.804826, loss_d: 0.026487
0.0383 --- loss: 0.928689, loss_ss: 0.893850, loss_d: 0.034839
0.0767 --- loss: 0.739734, loss_ss: 0.708167, loss_d: 0.031568
0.1150 --- loss: 0.863357, loss_ss: 0.812105, loss_d: 0.051252
0.1533 --- loss: 1.008686, loss_ss: 0.938922, loss_d: 0.069764
0.1916 --- loss: 0.927835, loss_ss: 0.898985, loss_d: 0.028850
0.2300 --- loss: 1.047751, loss_ss: 0.749092, loss_d: 0.298659
0.2683 --- loss: 0.818850, loss_ss: 0.776311, loss_d: 0.042539
0.3066 --- loss: 1.239866, loss_ss: 0.960757, loss_d: 0.279109
0.3450 --- loss: 1.165955, loss_ss: 1.048464, loss_d: 0.117492
0.3833 --- loss: 1.178224, loss_ss: 0.787105, loss_d: 0.391119
0.4216 --- loss: 1.212196, loss_ss: 1.185044, loss_d: 0.027152
0.4599 --- loss: 1.211189, loss_ss: 1.034558, loss_d: 0.176631
0.4983 --- loss: 0.873722, loss_ss: 0.816765, loss_d: 0.056957
0.5366 --- loss: 1.172019, loss_ss: 1.027442, loss_d: 0.144577
0.5749 --- loss: 0.954271, loss_ss: 0.682796, loss_d: 0.271475
0.6133 --- loss: 1.221406, loss_ss: 0.863607, loss_d: 0.357798
0.6516 --- loss: 0.998998, loss_ss: 0.876778, loss_d: 0.122220
0.6899 --- loss: 1.220616, loss_ss: 1.189882, loss_d: 0.030735
0.7282 --- loss: 1.441442, loss_ss: 1.016307, loss_d: 0.425135
0.7666 --- loss: 0.994304, loss_ss: 0.791854, loss_d: 0.202450
0.8049 --- loss: 0.970701, loss_ss: 0.731218, loss_d: 0.239483
0.8432 --- loss: 0.995225, loss_ss: 0.913111, loss_d: 0.082114
0.8816 --- loss: 0.810176, loss_ss: 0.780277, loss_d: 0.029898
0.9199 --- loss: 1.098255, loss_ss: 0.687608, loss_d: 0.410647
0.9582 --- loss: 1.261795, loss_ss: 1.062719, loss_d: 0.199077
0.9966 --- loss: 0.952248, loss_ss: 0.862902, loss_d: 0.089346
Epoch finished! Loss: 1.093087101670412
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.949557, loss_ss: 0.841753, loss_d: 0.107804
0.0383 --- loss: 1.203483, loss_ss: 0.843071, loss_d: 0.360412
0.0767 --- loss: 1.279331, loss_ss: 1.117110, loss_d: 0.162221
0.1150 --- loss: 0.914405, loss_ss: 0.781728, loss_d: 0.132677
0.1533 --- loss: 1.120685, loss_ss: 0.800857, loss_d: 0.319829
0.1916 --- loss: 0.849785, loss_ss: 0.808348, loss_d: 0.041437
0.2300 --- loss: 0.889525, loss_ss: 0.784359, loss_d: 0.105166
0.2683 --- loss: 1.238146, loss_ss: 0.991473, loss_d: 0.246673
0.3066 --- loss: 0.704824, loss_ss: 0.682494, loss_d: 0.022329
0.3450 --- loss: 0.821239, loss_ss: 0.805536, loss_d: 0.015703
0.3833 --- loss: 1.391464, loss_ss: 0.857998, loss_d: 0.533466
0.4216 --- loss: 1.190258, loss_ss: 1.180793, loss_d: 0.009464
0.4599 --- loss: 1.701856, loss_ss: 1.533586, loss_d: 0.168269
0.4983 --- loss: 0.837439, loss_ss: 0.704070, loss_d: 0.133369
0.5366 --- loss: 0.938568, loss_ss: 0.830062, loss_d: 0.108506
0.5749 --- loss: 0.885892, loss_ss: 0.825707, loss_d: 0.060186
0.6133 --- loss: 0.883498, loss_ss: 0.834783, loss_d: 0.048715
0.6516 --- loss: 1.236654, loss_ss: 1.123467, loss_d: 0.113187
0.6899 --- loss: 0.955316, loss_ss: 0.884851, loss_d: 0.070465
0.7282 --- loss: 1.173176, loss_ss: 0.720505, loss_d: 0.452670
0.7666 --- loss: 1.366764, loss_ss: 0.980869, loss_d: 0.385895
0.8049 --- loss: 0.830911, loss_ss: 0.748579, loss_d: 0.082332
0.8432 --- loss: 1.032518, loss_ss: 0.962663, loss_d: 0.069855
0.8816 --- loss: 1.158956, loss_ss: 1.051687, loss_d: 0.107269
0.9199 --- loss: 1.042380, loss_ss: 0.796099, loss_d: 0.246281
0.9582 --- loss: 0.926229, loss_ss: 0.909764, loss_d: 0.016465
0.9966 --- loss: 1.246576, loss_ss: 1.142147, loss_d: 0.104429
Epoch finished! Loss: 1.0707770838187292
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.063250, loss_ss: 1.049956, loss_d: 0.013294
0.0383 --- loss: 1.181991, loss_ss: 0.943765, loss_d: 0.238226
0.0767 --- loss: 0.882475, loss_ss: 0.857319, loss_d: 0.025156
0.1150 --- loss: 1.062646, loss_ss: 0.815441, loss_d: 0.247204
0.1533 --- loss: 1.453765, loss_ss: 1.434035, loss_d: 0.019730
0.1916 --- loss: 1.217778, loss_ss: 0.952390, loss_d: 0.265388
0.2300 --- loss: 0.986735, loss_ss: 0.951330, loss_d: 0.035405
0.2683 --- loss: 1.355752, loss_ss: 1.070154, loss_d: 0.285598
0.3066 --- loss: 1.189317, loss_ss: 1.154644, loss_d: 0.034673
0.3450 --- loss: 1.120512, loss_ss: 0.864078, loss_d: 0.256434
0.3833 --- loss: 0.901504, loss_ss: 0.860938, loss_d: 0.040566
0.4216 --- loss: 0.879780, loss_ss: 0.800154, loss_d: 0.079626
0.4599 --- loss: 1.346692, loss_ss: 1.205517, loss_d: 0.141175
0.4983 --- loss: 1.087922, loss_ss: 1.029888, loss_d: 0.058034
0.5366 --- loss: 1.066302, loss_ss: 0.894814, loss_d: 0.171488
0.5749 --- loss: 0.817867, loss_ss: 0.699215, loss_d: 0.118652
0.6133 --- loss: 0.801508, loss_ss: 0.728869, loss_d: 0.072639
0.6516 --- loss: 0.921875, loss_ss: 0.918011, loss_d: 0.003864
0.6899 --- loss: 1.050082, loss_ss: 0.745635, loss_d: 0.304447
0.7282 --- loss: 0.876539, loss_ss: 0.680356, loss_d: 0.196183
0.7666 --- loss: 1.036952, loss_ss: 0.728572, loss_d: 0.308380
0.8049 --- loss: 0.944882, loss_ss: 0.924853, loss_d: 0.020029
0.8432 --- loss: 0.831681, loss_ss: 0.821482, loss_d: 0.010199
0.8816 --- loss: 1.161155, loss_ss: 1.073969, loss_d: 0.087186
0.9199 --- loss: 1.142452, loss_ss: 1.053056, loss_d: 0.089395
0.9582 --- loss: 0.869700, loss_ss: 0.851076, loss_d: 0.018624
0.9966 --- loss: 0.970313, loss_ss: 0.905010, loss_d: 0.065302
Epoch finished! Loss: 1.0143362242441911
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.276655, loss_ss: 0.815649, loss_d: 0.461006
0.0383 --- loss: 0.895553, loss_ss: 0.714493, loss_d: 0.181060
0.0767 --- loss: 0.992592, loss_ss: 0.946763, loss_d: 0.045829
0.1150 --- loss: 0.887609, loss_ss: 0.871159, loss_d: 0.016450
0.1533 --- loss: 0.849694, loss_ss: 0.825043, loss_d: 0.024651
0.1916 --- loss: 1.247778, loss_ss: 1.224071, loss_d: 0.023707
0.2300 --- loss: 0.997761, loss_ss: 0.903930, loss_d: 0.093831
0.2683 --- loss: 1.088411, loss_ss: 0.949593, loss_d: 0.138817
0.3066 --- loss: 0.607281, loss_ss: 0.586890, loss_d: 0.020391
0.3450 --- loss: 0.955255, loss_ss: 0.921984, loss_d: 0.033271
0.3833 --- loss: 1.090861, loss_ss: 1.034060, loss_d: 0.056801
0.4216 --- loss: 0.807907, loss_ss: 0.791560, loss_d: 0.016347
0.4599 --- loss: 0.905395, loss_ss: 0.867499, loss_d: 0.037896
0.4983 --- loss: 1.117634, loss_ss: 1.055643, loss_d: 0.061991
0.5366 --- loss: 1.227683, loss_ss: 0.924049, loss_d: 0.303634
0.5749 --- loss: 1.216558, loss_ss: 1.206190, loss_d: 0.010367
0.6133 --- loss: 0.966589, loss_ss: 0.951642, loss_d: 0.014948
0.6516 --- loss: 0.998478, loss_ss: 0.996978, loss_d: 0.001499
0.6899 --- loss: 1.083160, loss_ss: 1.052989, loss_d: 0.030171
0.7282 --- loss: 1.262838, loss_ss: 0.847520, loss_d: 0.415319
0.7666 --- loss: 0.962439, loss_ss: 0.806710, loss_d: 0.155729
0.8049 --- loss: 0.871777, loss_ss: 0.865900, loss_d: 0.005878
0.8432 --- loss: 0.686089, loss_ss: 0.635918, loss_d: 0.050171
0.8816 --- loss: 0.813266, loss_ss: 0.787188, loss_d: 0.026077
0.9199 --- loss: 0.792416, loss_ss: 0.753090, loss_d: 0.039326
0.9582 --- loss: 0.821146, loss_ss: 0.800036, loss_d: 0.021110
0.9966 --- loss: 0.702078, loss_ss: 0.638389, loss_d: 0.063689
Epoch finished! Loss: 0.9755092568122423
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.799867, loss_ss: 0.774182, loss_d: 0.025685
0.0383 --- loss: 0.924386, loss_ss: 0.888534, loss_d: 0.035853
0.0767 --- loss: 1.140575, loss_ss: 0.736261, loss_d: 0.404314
0.1150 --- loss: 1.116878, loss_ss: 1.070961, loss_d: 0.045917
0.1533 --- loss: 0.915582, loss_ss: 0.774603, loss_d: 0.140978
0.1916 --- loss: 0.763187, loss_ss: 0.753492, loss_d: 0.009694
0.2300 --- loss: 0.832847, loss_ss: 0.751628, loss_d: 0.081219
0.2683 --- loss: 0.678860, loss_ss: 0.664201, loss_d: 0.014659
0.3066 --- loss: 0.764422, loss_ss: 0.748111, loss_d: 0.016311
0.3450 --- loss: 0.902987, loss_ss: 0.841480, loss_d: 0.061508
0.3833 --- loss: 1.299611, loss_ss: 1.015443, loss_d: 0.284168
0.4216 --- loss: 1.084412, loss_ss: 1.066979, loss_d: 0.017433
0.4599 --- loss: 0.986851, loss_ss: 0.935719, loss_d: 0.051132
0.4983 --- loss: 1.998955, loss_ss: 1.544853, loss_d: 0.454102
0.5366 --- loss: 0.927088, loss_ss: 0.804372, loss_d: 0.122716
0.5749 --- loss: 1.142326, loss_ss: 1.120165, loss_d: 0.022161
0.6133 --- loss: 0.936371, loss_ss: 0.882275, loss_d: 0.054096
0.6516 --- loss: 0.816165, loss_ss: 0.784730, loss_d: 0.031436
0.6899 --- loss: 0.782220, loss_ss: 0.762138, loss_d: 0.020082
0.7282 --- loss: 1.376122, loss_ss: 0.846141, loss_d: 0.529981
0.7666 --- loss: 1.139367, loss_ss: 0.925058, loss_d: 0.214309
0.8049 --- loss: 0.886258, loss_ss: 0.823465, loss_d: 0.062793
0.8432 --- loss: 1.463923, loss_ss: 0.985879, loss_d: 0.478045
0.8816 --- loss: 1.367112, loss_ss: 1.042160, loss_d: 0.324952
0.9199 --- loss: 0.909701, loss_ss: 0.907365, loss_d: 0.002336
0.9582 --- loss: 1.403194, loss_ss: 1.333467, loss_d: 0.069727
0.9966 --- loss: 0.841640, loss_ss: 0.793544, loss_d: 0.048096
Epoch finished! Loss: 0.9610759347677231
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8241379310344827
             precision    recall  f1-score   support

        0.0       0.93      0.75      0.83       119
        1.0       0.30      0.49      0.37        53
        2.0       0.91      0.85      0.88       460
        3.0       0.93      0.91      0.92       164
        4.0       0.65      0.86      0.74        74

avg / total       0.86      0.82      0.84       870
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.75  74.79   99.07  92.71     82.79
1  89.77  49.06   92.41  29.55     36.88
2  87.47  84.57   90.73  91.10     87.71
3  96.90  90.85   98.30  92.55     91.69
4  94.94  86.49   95.73  65.31     74.42
Total accuracy: 82.41%
Average sen: 77.15%
Average spec: 95.25%
Macro f1-score: 74.70%
Diagnosis acc on 15mins: 0.5172413793103449
[0.80240554 0.40105787 0.65355384 0.96908969 0.98496348 0.94489896
 0.03784727 0.03490116 0.00145496 0.01718899 0.44936663 0.52167046
 0.68249017 0.28280228 0.03340888 0.40838593 0.02959357 0.96928596
 0.15552293 0.88006628 0.09201858 0.63113803 0.60068154 0.22863597
 0.00162155 0.56861478 0.60932624 0.10973573 0.95548904]
pred: 0.45024883834211604, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.450984, loss_ss: 1.769557, loss_d: 0.681427
0.0383 --- loss: 2.274430, loss_ss: 1.619530, loss_d: 0.654900
0.0767 --- loss: 2.091317, loss_ss: 1.735582, loss_d: 0.355734
0.1150 --- loss: 2.070436, loss_ss: 1.501069, loss_d: 0.569366
0.1533 --- loss: 2.040110, loss_ss: 1.435922, loss_d: 0.604189
0.1916 --- loss: 2.084383, loss_ss: 1.567791, loss_d: 0.516591
0.2300 --- loss: 1.746313, loss_ss: 1.404487, loss_d: 0.341825
0.2683 --- loss: 2.103086, loss_ss: 1.561440, loss_d: 0.541646
0.3066 --- loss: 2.100908, loss_ss: 1.457093, loss_d: 0.643815
0.3450 --- loss: 1.782832, loss_ss: 1.338427, loss_d: 0.444405
0.3833 --- loss: 2.100110, loss_ss: 1.526505, loss_d: 0.573605
0.4216 --- loss: 1.946615, loss_ss: 1.392501, loss_d: 0.554113
0.4599 --- loss: 1.941613, loss_ss: 1.231196, loss_d: 0.710417
0.4983 --- loss: 1.988569, loss_ss: 1.285428, loss_d: 0.703142
0.5366 --- loss: 1.756352, loss_ss: 1.435354, loss_d: 0.320998
0.5749 --- loss: 2.168361, loss_ss: 1.321388, loss_d: 0.846973
0.6133 --- loss: 2.053448, loss_ss: 1.382700, loss_d: 0.670747
0.6516 --- loss: 2.093828, loss_ss: 1.449482, loss_d: 0.644345
0.6899 --- loss: 1.484569, loss_ss: 1.142213, loss_d: 0.342357
0.7282 --- loss: 1.654524, loss_ss: 1.233629, loss_d: 0.420895
0.7666 --- loss: 1.375015, loss_ss: 1.046544, loss_d: 0.328471
0.8049 --- loss: 1.640918, loss_ss: 1.103028, loss_d: 0.537890
0.8432 --- loss: 2.114840, loss_ss: 1.510486, loss_d: 0.604353
0.8816 --- loss: 1.759502, loss_ss: 1.370934, loss_d: 0.388568
0.9199 --- loss: 1.649388, loss_ss: 1.231869, loss_d: 0.417519
0.9582 --- loss: 1.605053, loss_ss: 1.189446, loss_d: 0.415607
0.9966 --- loss: 1.726660, loss_ss: 1.217792, loss_d: 0.508868
Epoch finished! Loss: 1.909738915700179
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.616027, loss_ss: 1.241934, loss_d: 0.374093
0.0383 --- loss: 1.511430, loss_ss: 1.076562, loss_d: 0.434868
0.0767 --- loss: 1.595553, loss_ss: 1.238003, loss_d: 0.357551
0.1150 --- loss: 1.729563, loss_ss: 1.217377, loss_d: 0.512187
0.1533 --- loss: 1.608994, loss_ss: 1.116512, loss_d: 0.492482
0.1916 --- loss: 1.865661, loss_ss: 1.091629, loss_d: 0.774032
0.2300 --- loss: 1.288304, loss_ss: 0.998357, loss_d: 0.289946
0.2683 --- loss: 1.115845, loss_ss: 0.858956, loss_d: 0.256889
0.3066 --- loss: 1.841985, loss_ss: 0.887713, loss_d: 0.954273
0.3450 --- loss: 1.339706, loss_ss: 1.042371, loss_d: 0.297335
0.3833 --- loss: 1.583655, loss_ss: 1.227030, loss_d: 0.356625
0.4216 --- loss: 1.221072, loss_ss: 1.063981, loss_d: 0.157091
0.4599 --- loss: 1.447585, loss_ss: 0.983071, loss_d: 0.464514
0.4983 --- loss: 1.190394, loss_ss: 1.047492, loss_d: 0.142901
0.5366 --- loss: 1.719568, loss_ss: 1.257880, loss_d: 0.461688
0.5749 --- loss: 1.128623, loss_ss: 1.000190, loss_d: 0.128433
0.6133 --- loss: 1.249692, loss_ss: 0.919731, loss_d: 0.329961
0.6516 --- loss: 1.057041, loss_ss: 0.806097, loss_d: 0.250944
0.6899 --- loss: 1.173185, loss_ss: 0.990053, loss_d: 0.183131
0.7282 --- loss: 1.275258, loss_ss: 0.862662, loss_d: 0.412596
0.7666 --- loss: 1.655983, loss_ss: 1.013973, loss_d: 0.642010
0.8049 --- loss: 1.222108, loss_ss: 0.912538, loss_d: 0.309570
0.8432 --- loss: 1.316388, loss_ss: 1.027029, loss_d: 0.289359
0.8816 --- loss: 1.888833, loss_ss: 1.224946, loss_d: 0.663888
0.9199 --- loss: 1.797737, loss_ss: 1.412550, loss_d: 0.385187
0.9582 --- loss: 1.058371, loss_ss: 0.880642, loss_d: 0.177729
0.9966 --- loss: 1.287208, loss_ss: 0.837613, loss_d: 0.449595
Epoch finished! Loss: 1.453839424940256
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.641125, loss_ss: 1.131888, loss_d: 0.509237
0.0383 --- loss: 1.520970, loss_ss: 1.205875, loss_d: 0.315095
0.0767 --- loss: 1.101265, loss_ss: 1.009624, loss_d: 0.091641
0.1150 --- loss: 1.300568, loss_ss: 0.734242, loss_d: 0.566326
0.1533 --- loss: 1.116197, loss_ss: 0.967964, loss_d: 0.148232
0.1916 --- loss: 1.455601, loss_ss: 0.933352, loss_d: 0.522248
0.2300 --- loss: 1.214043, loss_ss: 0.826669, loss_d: 0.387374
0.2683 --- loss: 1.184427, loss_ss: 0.848418, loss_d: 0.336009
0.3066 --- loss: 1.245979, loss_ss: 1.047056, loss_d: 0.198923
0.3450 --- loss: 0.977842, loss_ss: 0.744460, loss_d: 0.233381
0.3833 --- loss: 1.142515, loss_ss: 0.954303, loss_d: 0.188212
0.4216 --- loss: 0.965378, loss_ss: 0.912934, loss_d: 0.052444
0.4599 --- loss: 1.263814, loss_ss: 1.113656, loss_d: 0.150158
0.4983 --- loss: 1.078966, loss_ss: 0.894984, loss_d: 0.183982
0.5366 --- loss: 1.062480, loss_ss: 0.977926, loss_d: 0.084554
0.5749 --- loss: 1.119339, loss_ss: 0.781415, loss_d: 0.337924
0.6133 --- loss: 1.644726, loss_ss: 1.219713, loss_d: 0.425013
0.6516 --- loss: 1.226421, loss_ss: 1.010852, loss_d: 0.215569
0.6899 --- loss: 1.518282, loss_ss: 0.969565, loss_d: 0.548718
0.7282 --- loss: 1.072332, loss_ss: 1.026000, loss_d: 0.046332
0.7666 --- loss: 1.264568, loss_ss: 1.211001, loss_d: 0.053568
0.8049 --- loss: 1.295946, loss_ss: 1.051146, loss_d: 0.244801
0.8432 --- loss: 1.110134, loss_ss: 0.820552, loss_d: 0.289582
0.8816 --- loss: 1.008693, loss_ss: 0.842388, loss_d: 0.166305
0.9199 --- loss: 1.354402, loss_ss: 0.992432, loss_d: 0.361971
0.9582 --- loss: 1.124567, loss_ss: 0.856954, loss_d: 0.267613
0.9966 --- loss: 1.032770, loss_ss: 0.891999, loss_d: 0.140771
Epoch finished! Loss: 1.2940991601118674
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.138647, loss_ss: 0.820212, loss_d: 0.318434
0.0383 --- loss: 1.205001, loss_ss: 0.867969, loss_d: 0.337032
0.0767 --- loss: 1.069095, loss_ss: 0.912225, loss_d: 0.156871
0.1150 --- loss: 1.450669, loss_ss: 1.286065, loss_d: 0.164605
0.1533 --- loss: 0.955411, loss_ss: 0.839794, loss_d: 0.115617
0.1916 --- loss: 0.967795, loss_ss: 0.880036, loss_d: 0.087759
0.2300 --- loss: 1.406901, loss_ss: 0.879120, loss_d: 0.527781
0.2683 --- loss: 1.289121, loss_ss: 0.981529, loss_d: 0.307592
0.3066 --- loss: 1.175422, loss_ss: 1.105550, loss_d: 0.069871
0.3450 --- loss: 1.250409, loss_ss: 0.859531, loss_d: 0.390878
0.3833 --- loss: 0.955837, loss_ss: 0.897097, loss_d: 0.058739
0.4216 --- loss: 1.199147, loss_ss: 1.143766, loss_d: 0.055382
0.4599 --- loss: 0.998082, loss_ss: 0.957808, loss_d: 0.040274
0.4983 --- loss: 1.088126, loss_ss: 0.739699, loss_d: 0.348426
0.5366 --- loss: 1.111416, loss_ss: 0.903087, loss_d: 0.208329
0.5749 --- loss: 1.246778, loss_ss: 0.889155, loss_d: 0.357623
0.6133 --- loss: 1.314466, loss_ss: 1.228505, loss_d: 0.085961
0.6516 --- loss: 1.137249, loss_ss: 0.977808, loss_d: 0.159441
0.6899 --- loss: 1.170776, loss_ss: 0.685764, loss_d: 0.485012
0.7282 --- loss: 1.275773, loss_ss: 1.115613, loss_d: 0.160160
0.7666 --- loss: 1.003776, loss_ss: 0.835432, loss_d: 0.168344
0.8049 --- loss: 1.656778, loss_ss: 1.462762, loss_d: 0.194017
0.8432 --- loss: 0.979720, loss_ss: 0.756071, loss_d: 0.223649
0.8816 --- loss: 1.358891, loss_ss: 1.177416, loss_d: 0.181475
0.9199 --- loss: 0.858985, loss_ss: 0.779568, loss_d: 0.079417
0.9582 --- loss: 1.337148, loss_ss: 1.053044, loss_d: 0.284104
0.9966 --- loss: 0.944363, loss_ss: 0.779928, loss_d: 0.164435
Epoch finished! Loss: 1.1978747248649597
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.193579, loss_ss: 0.965028, loss_d: 0.228552
0.0383 --- loss: 1.269514, loss_ss: 0.863076, loss_d: 0.406438
0.0767 --- loss: 0.932595, loss_ss: 0.795044, loss_d: 0.137552
0.1150 --- loss: 1.059197, loss_ss: 0.960173, loss_d: 0.099024
0.1533 --- loss: 1.058465, loss_ss: 0.984447, loss_d: 0.074018
0.1916 --- loss: 1.435428, loss_ss: 0.905341, loss_d: 0.530086
0.2300 --- loss: 0.978817, loss_ss: 0.759597, loss_d: 0.219220
0.2683 --- loss: 1.215464, loss_ss: 0.984333, loss_d: 0.231132
0.3066 --- loss: 1.409269, loss_ss: 1.182275, loss_d: 0.226994
0.3450 --- loss: 1.669052, loss_ss: 1.020500, loss_d: 0.648552
0.3833 --- loss: 1.262927, loss_ss: 1.123103, loss_d: 0.139825
0.4216 --- loss: 0.981464, loss_ss: 0.708707, loss_d: 0.272757
0.4599 --- loss: 1.210632, loss_ss: 0.995359, loss_d: 0.215273
0.4983 --- loss: 0.989265, loss_ss: 0.939059, loss_d: 0.050206
0.5366 --- loss: 0.771370, loss_ss: 0.688224, loss_d: 0.083145
0.5749 --- loss: 1.464596, loss_ss: 1.340945, loss_d: 0.123651
0.6133 --- loss: 1.314128, loss_ss: 0.849491, loss_d: 0.464637
0.6516 --- loss: 1.530676, loss_ss: 1.132990, loss_d: 0.397686
0.6899 --- loss: 1.063120, loss_ss: 0.962318, loss_d: 0.100802
0.7282 --- loss: 1.378119, loss_ss: 0.950144, loss_d: 0.427976
0.7666 --- loss: 1.268748, loss_ss: 0.991869, loss_d: 0.276879
0.8049 --- loss: 0.923770, loss_ss: 0.820755, loss_d: 0.103014
0.8432 --- loss: 1.135265, loss_ss: 0.736735, loss_d: 0.398530
0.8816 --- loss: 0.993912, loss_ss: 0.854470, loss_d: 0.139442
0.9199 --- loss: 0.992485, loss_ss: 0.860226, loss_d: 0.132259
0.9582 --- loss: 1.215666, loss_ss: 1.162853, loss_d: 0.052812
0.9966 --- loss: 1.362304, loss_ss: 0.959923, loss_d: 0.402381
Epoch finished! Loss: 1.1355597626704437
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.058768, loss_ss: 1.013308, loss_d: 0.045460
0.0383 --- loss: 1.100968, loss_ss: 0.814209, loss_d: 0.286759
0.0767 --- loss: 1.649742, loss_ss: 0.773121, loss_d: 0.876621
0.1150 --- loss: 1.108021, loss_ss: 1.023344, loss_d: 0.084677
0.1533 --- loss: 1.365899, loss_ss: 0.976530, loss_d: 0.389369
0.1916 --- loss: 1.136658, loss_ss: 0.901635, loss_d: 0.235023
0.2300 --- loss: 1.808011, loss_ss: 1.080036, loss_d: 0.727975
0.2683 --- loss: 0.857473, loss_ss: 0.797931, loss_d: 0.059542
0.3066 --- loss: 1.493766, loss_ss: 0.617234, loss_d: 0.876532
0.3450 --- loss: 1.787361, loss_ss: 1.164832, loss_d: 0.622529
0.3833 --- loss: 1.041648, loss_ss: 0.947274, loss_d: 0.094373
0.4216 --- loss: 1.107928, loss_ss: 0.722279, loss_d: 0.385649
0.4599 --- loss: 1.232275, loss_ss: 0.966925, loss_d: 0.265350
0.4983 --- loss: 1.328727, loss_ss: 0.904186, loss_d: 0.424541
0.5366 --- loss: 1.023529, loss_ss: 0.717942, loss_d: 0.305587
0.5749 --- loss: 0.882509, loss_ss: 0.624291, loss_d: 0.258218
0.6133 --- loss: 0.970840, loss_ss: 0.833418, loss_d: 0.137422
0.6516 --- loss: 1.139509, loss_ss: 0.863744, loss_d: 0.275765
0.6899 --- loss: 1.045946, loss_ss: 0.961436, loss_d: 0.084510
0.7282 --- loss: 0.952191, loss_ss: 0.778934, loss_d: 0.173257
0.7666 --- loss: 1.001239, loss_ss: 0.905067, loss_d: 0.096172
0.8049 --- loss: 0.876417, loss_ss: 0.719344, loss_d: 0.157074
0.8432 --- loss: 1.405750, loss_ss: 1.017416, loss_d: 0.388333
0.8816 --- loss: 0.998985, loss_ss: 0.867351, loss_d: 0.131634
0.9199 --- loss: 1.112670, loss_ss: 0.930340, loss_d: 0.182330
0.9582 --- loss: 1.189714, loss_ss: 0.915534, loss_d: 0.274181
0.9966 --- loss: 1.055389, loss_ss: 0.989536, loss_d: 0.065852
Epoch finished! Loss: 1.113563992197697
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.503463, loss_ss: 1.173685, loss_d: 0.329778
0.0383 --- loss: 0.983774, loss_ss: 0.924465, loss_d: 0.059309
0.0767 --- loss: 0.881237, loss_ss: 0.842479, loss_d: 0.038758
0.1150 --- loss: 1.139083, loss_ss: 0.963812, loss_d: 0.175270
0.1533 --- loss: 1.367080, loss_ss: 1.152763, loss_d: 0.214317
0.1916 --- loss: 0.823705, loss_ss: 0.792833, loss_d: 0.030873
0.2300 --- loss: 0.882826, loss_ss: 0.851577, loss_d: 0.031249
0.2683 --- loss: 1.387216, loss_ss: 0.964742, loss_d: 0.422474
0.3066 --- loss: 1.324821, loss_ss: 0.927125, loss_d: 0.397696
0.3450 --- loss: 0.862331, loss_ss: 0.828321, loss_d: 0.034010
0.3833 --- loss: 0.675716, loss_ss: 0.649952, loss_d: 0.025764
0.4216 --- loss: 1.204603, loss_ss: 0.840792, loss_d: 0.363811
0.4599 --- loss: 1.120680, loss_ss: 0.929994, loss_d: 0.190686
0.4983 --- loss: 0.962761, loss_ss: 0.744490, loss_d: 0.218271
0.5366 --- loss: 0.843323, loss_ss: 0.794450, loss_d: 0.048873
0.5749 --- loss: 1.340841, loss_ss: 0.900638, loss_d: 0.440202
0.6133 --- loss: 1.297449, loss_ss: 0.939643, loss_d: 0.357806
0.6516 --- loss: 0.897943, loss_ss: 0.788573, loss_d: 0.109370
0.6899 --- loss: 0.986633, loss_ss: 0.625324, loss_d: 0.361309
0.7282 --- loss: 0.745400, loss_ss: 0.722786, loss_d: 0.022614
0.7666 --- loss: 2.728361, loss_ss: 0.718876, loss_d: 2.009485
0.8049 --- loss: 1.087738, loss_ss: 0.943382, loss_d: 0.144356
0.8432 --- loss: 1.197896, loss_ss: 0.988150, loss_d: 0.209746
0.8816 --- loss: 1.267128, loss_ss: 1.019834, loss_d: 0.247294
0.9199 --- loss: 0.936690, loss_ss: 0.883244, loss_d: 0.053446
0.9582 --- loss: 0.938408, loss_ss: 0.780594, loss_d: 0.157814
0.9966 --- loss: 0.873061, loss_ss: 0.699467, loss_d: 0.173594
Epoch finished! Loss: 1.0517511615386377
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.836631, loss_ss: 0.642995, loss_d: 0.193637
0.0383 --- loss: 1.161444, loss_ss: 1.147242, loss_d: 0.014202
0.0767 --- loss: 0.868600, loss_ss: 0.844281, loss_d: 0.024319
0.1150 --- loss: 1.040337, loss_ss: 0.997589, loss_d: 0.042748
0.1533 --- loss: 1.112372, loss_ss: 1.060318, loss_d: 0.052054
0.1916 --- loss: 1.231466, loss_ss: 1.099155, loss_d: 0.132311
0.2300 --- loss: 0.884914, loss_ss: 0.822410, loss_d: 0.062504
0.2683 --- loss: 0.988478, loss_ss: 0.932988, loss_d: 0.055490
0.3066 --- loss: 0.882223, loss_ss: 0.858886, loss_d: 0.023337
0.3450 --- loss: 0.910972, loss_ss: 0.895022, loss_d: 0.015950
0.3833 --- loss: 0.566548, loss_ss: 0.556733, loss_d: 0.009815
0.4216 --- loss: 1.515389, loss_ss: 0.900478, loss_d: 0.614911
0.4599 --- loss: 1.154342, loss_ss: 1.140089, loss_d: 0.014254
0.4983 --- loss: 0.743041, loss_ss: 0.670169, loss_d: 0.072872
0.5366 --- loss: 0.900748, loss_ss: 0.768748, loss_d: 0.132000
0.5749 --- loss: 0.811425, loss_ss: 0.785634, loss_d: 0.025791
0.6133 --- loss: 1.172590, loss_ss: 0.736037, loss_d: 0.436554
0.6516 --- loss: 1.192807, loss_ss: 1.177932, loss_d: 0.014875
0.6899 --- loss: 0.717198, loss_ss: 0.595644, loss_d: 0.121554
0.7282 --- loss: 0.672689, loss_ss: 0.637550, loss_d: 0.035139
0.7666 --- loss: 0.941364, loss_ss: 0.850534, loss_d: 0.090831
0.8049 --- loss: 0.914463, loss_ss: 0.836958, loss_d: 0.077505
0.8432 --- loss: 2.271142, loss_ss: 1.664803, loss_d: 0.606339
0.8816 --- loss: 0.945658, loss_ss: 0.874310, loss_d: 0.071348
0.9199 --- loss: 0.992082, loss_ss: 0.861455, loss_d: 0.130627
0.9582 --- loss: 1.232706, loss_ss: 0.849592, loss_d: 0.383114
0.9966 --- loss: 1.315286, loss_ss: 0.928685, loss_d: 0.386601
Epoch finished! Loss: 1.0203849455484977
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.941381, loss_ss: 0.846977, loss_d: 0.094404
0.0383 --- loss: 1.379029, loss_ss: 1.341432, loss_d: 0.037597
0.0767 --- loss: 0.824255, loss_ss: 0.795497, loss_d: 0.028758
0.1150 --- loss: 0.833952, loss_ss: 0.785894, loss_d: 0.048058
0.1533 --- loss: 0.811955, loss_ss: 0.797529, loss_d: 0.014426
0.1916 --- loss: 0.823314, loss_ss: 0.815719, loss_d: 0.007595
0.2300 --- loss: 1.182020, loss_ss: 0.971773, loss_d: 0.210247
0.2683 --- loss: 0.808835, loss_ss: 0.770494, loss_d: 0.038342
0.3066 --- loss: 1.288968, loss_ss: 1.122341, loss_d: 0.166627
0.3450 --- loss: 0.897474, loss_ss: 0.637352, loss_d: 0.260122
0.3833 --- loss: 1.289328, loss_ss: 1.102955, loss_d: 0.186373
0.4216 --- loss: 0.891652, loss_ss: 0.688734, loss_d: 0.202919
0.4599 --- loss: 0.810989, loss_ss: 0.768396, loss_d: 0.042592
0.4983 --- loss: 1.224360, loss_ss: 0.821991, loss_d: 0.402369
0.5366 --- loss: 0.856971, loss_ss: 0.769895, loss_d: 0.087076
0.5749 --- loss: 0.865736, loss_ss: 0.731953, loss_d: 0.133783
0.6133 --- loss: 0.984666, loss_ss: 0.860426, loss_d: 0.124240
0.6516 --- loss: 0.989147, loss_ss: 0.950538, loss_d: 0.038609
0.6899 --- loss: 1.178157, loss_ss: 1.156872, loss_d: 0.021285
0.7282 --- loss: 0.771153, loss_ss: 0.763167, loss_d: 0.007986
0.7666 --- loss: 0.785543, loss_ss: 0.756654, loss_d: 0.028889
0.8049 --- loss: 1.052773, loss_ss: 0.954445, loss_d: 0.098328
0.8432 --- loss: 0.841727, loss_ss: 0.821049, loss_d: 0.020678
0.8816 --- loss: 1.012530, loss_ss: 0.911001, loss_d: 0.101529
0.9199 --- loss: 1.137420, loss_ss: 1.056197, loss_d: 0.081224
0.9582 --- loss: 0.694460, loss_ss: 0.619409, loss_d: 0.075050
0.9966 --- loss: 1.118112, loss_ss: 0.773474, loss_d: 0.344638
Epoch finished! Loss: 0.9679666322011214
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.935544, loss_ss: 0.815025, loss_d: 0.120519
0.0383 --- loss: 0.787740, loss_ss: 0.721487, loss_d: 0.066253
0.0767 --- loss: 0.918814, loss_ss: 0.704647, loss_d: 0.214168
0.1150 --- loss: 1.103223, loss_ss: 1.075586, loss_d: 0.027636
0.1533 --- loss: 0.896925, loss_ss: 0.855341, loss_d: 0.041584
0.1916 --- loss: 0.900862, loss_ss: 0.884460, loss_d: 0.016402
0.2300 --- loss: 0.894051, loss_ss: 0.850027, loss_d: 0.044023
0.2683 --- loss: 0.845181, loss_ss: 0.839065, loss_d: 0.006116
0.3066 --- loss: 0.851648, loss_ss: 0.835900, loss_d: 0.015748
0.3450 --- loss: 1.065081, loss_ss: 0.898274, loss_d: 0.166807
0.3833 --- loss: 0.841970, loss_ss: 0.772907, loss_d: 0.069063
0.4216 --- loss: 0.861424, loss_ss: 0.847738, loss_d: 0.013686
0.4599 --- loss: 1.263130, loss_ss: 0.958489, loss_d: 0.304641
0.4983 --- loss: 1.138842, loss_ss: 0.999531, loss_d: 0.139312
0.5366 --- loss: 0.971092, loss_ss: 0.957301, loss_d: 0.013791
0.5749 --- loss: 0.855893, loss_ss: 0.746212, loss_d: 0.109680
0.6133 --- loss: 0.875547, loss_ss: 0.759325, loss_d: 0.116222
0.6516 --- loss: 0.933514, loss_ss: 0.929989, loss_d: 0.003525
0.6899 --- loss: 1.125181, loss_ss: 1.094678, loss_d: 0.030503
0.7282 --- loss: 0.823440, loss_ss: 0.734464, loss_d: 0.088976
0.7666 --- loss: 0.763585, loss_ss: 0.718135, loss_d: 0.045450
0.8049 --- loss: 0.644656, loss_ss: 0.623716, loss_d: 0.020940
0.8432 --- loss: 0.766342, loss_ss: 0.756496, loss_d: 0.009846
0.8816 --- loss: 0.668588, loss_ss: 0.618556, loss_d: 0.050032
0.9199 --- loss: 0.991045, loss_ss: 0.938965, loss_d: 0.052080
0.9582 --- loss: 0.900042, loss_ss: 0.859696, loss_d: 0.040346
0.9966 --- loss: 0.994541, loss_ss: 0.932437, loss_d: 0.062104
Epoch finished! Loss: 0.9193133521538515
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8011494252873563
             precision    recall  f1-score   support

        0.0       1.00      0.39      0.56        59
        1.0       0.26      0.32      0.29        60
        2.0       0.95      0.80      0.87       389
        3.0       0.90      0.93      0.92       151
        4.0       0.70      0.96      0.81       211

avg / total       0.84      0.80      0.80       870
 


====== chc033-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.86  38.98  100.00  100.00     56.10
1  89.08  31.67   93.33   26.03     28.57
2  89.20  80.21   96.47   94.83     86.91
3  97.01  92.72   97.91   90.32     91.50
4  89.08  96.21   86.80   70.00     81.04
Total accuracy: 80.11%
Average sen: 67.96%
Average spec: 94.90%
Macro f1-score: 68.82%
Diagnosis acc on 15mins: 0.3793103448275862
[0.53940153 0.846955   0.02134572 0.15375771 0.00527019 0.21815269
 0.60551524 0.95480102 0.43180609 0.12399404 0.01678097 0.18165192
 0.85028481 0.06963092 0.90878427 0.92700177 0.96863538 0.98704535
 0.87476772 0.67729902 0.07443982 0.41460663 0.94767684 0.98564756
 0.96644431 0.98431581 0.89552516 0.98622119 0.93502003]
pred: 0.6052682318018171, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.475273, loss_ss: 1.767449, loss_d: 0.707824
0.0383 --- loss: 2.314601, loss_ss: 1.573298, loss_d: 0.741304
0.0767 --- loss: 2.349629, loss_ss: 1.672561, loss_d: 0.677068
0.1150 --- loss: 2.067601, loss_ss: 1.535686, loss_d: 0.531915
0.1534 --- loss: 1.986047, loss_ss: 1.516718, loss_d: 0.469329
0.1917 --- loss: 1.880952, loss_ss: 1.461110, loss_d: 0.419841
0.2301 --- loss: 2.174883, loss_ss: 1.599916, loss_d: 0.574967
0.2684 --- loss: 1.830352, loss_ss: 1.409601, loss_d: 0.420751
0.3067 --- loss: 1.755657, loss_ss: 1.476053, loss_d: 0.279604
0.3451 --- loss: 1.969277, loss_ss: 1.398860, loss_d: 0.570417
0.3834 --- loss: 1.924148, loss_ss: 1.408201, loss_d: 0.515947
0.4218 --- loss: 1.993121, loss_ss: 1.436500, loss_d: 0.556621
0.4601 --- loss: 2.029731, loss_ss: 1.565728, loss_d: 0.464003
0.4985 --- loss: 1.957072, loss_ss: 1.440411, loss_d: 0.516661
0.5368 --- loss: 2.262048, loss_ss: 1.446633, loss_d: 0.815415
0.5752 --- loss: 1.720102, loss_ss: 1.256003, loss_d: 0.464099
0.6135 --- loss: 1.812337, loss_ss: 1.206681, loss_d: 0.605656
0.6518 --- loss: 1.783979, loss_ss: 1.267608, loss_d: 0.516371
0.6902 --- loss: 1.820856, loss_ss: 1.178681, loss_d: 0.642174
0.7285 --- loss: 1.889323, loss_ss: 1.314926, loss_d: 0.574398
0.7669 --- loss: 1.960209, loss_ss: 1.339722, loss_d: 0.620487
0.8052 --- loss: 1.770334, loss_ss: 1.293418, loss_d: 0.476916
0.8436 --- loss: 1.482762, loss_ss: 1.199940, loss_d: 0.282822
0.8819 --- loss: 1.624629, loss_ss: 1.179552, loss_d: 0.445078
0.9202 --- loss: 1.701903, loss_ss: 1.153430, loss_d: 0.548474
0.9586 --- loss: 1.632784, loss_ss: 1.261294, loss_d: 0.371490
0.9969 --- loss: 1.466697, loss_ss: 1.232863, loss_d: 0.233834
Epoch finished! Loss: 1.9386864772209755
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.393775, loss_ss: 1.162914, loss_d: 0.230862
0.0383 --- loss: 1.564138, loss_ss: 1.059032, loss_d: 0.505107
0.0767 --- loss: 1.738718, loss_ss: 1.263689, loss_d: 0.475029
0.1150 --- loss: 1.701504, loss_ss: 1.407080, loss_d: 0.294424
0.1534 --- loss: 1.504359, loss_ss: 1.033011, loss_d: 0.471348
0.1917 --- loss: 1.472808, loss_ss: 1.162307, loss_d: 0.310502
0.2301 --- loss: 1.330146, loss_ss: 1.090304, loss_d: 0.239842
0.2684 --- loss: 1.886531, loss_ss: 1.597430, loss_d: 0.289100
0.3067 --- loss: 1.310426, loss_ss: 1.039110, loss_d: 0.271315
0.3451 --- loss: 1.626138, loss_ss: 1.372765, loss_d: 0.253373
0.3834 --- loss: 1.392045, loss_ss: 0.928792, loss_d: 0.463254
0.4218 --- loss: 1.355894, loss_ss: 1.020660, loss_d: 0.335234
0.4601 --- loss: 1.961880, loss_ss: 1.345180, loss_d: 0.616700
0.4985 --- loss: 1.898384, loss_ss: 1.459487, loss_d: 0.438897
0.5368 --- loss: 1.481208, loss_ss: 1.032058, loss_d: 0.449151
0.5752 --- loss: 1.384208, loss_ss: 0.986912, loss_d: 0.397295
0.6135 --- loss: 1.634624, loss_ss: 1.220143, loss_d: 0.414480
0.6518 --- loss: 1.300968, loss_ss: 1.025919, loss_d: 0.275049
0.6902 --- loss: 2.141331, loss_ss: 1.170301, loss_d: 0.971030
0.7285 --- loss: 1.625218, loss_ss: 0.907660, loss_d: 0.717558
0.7669 --- loss: 1.544496, loss_ss: 1.336464, loss_d: 0.208032
0.8052 --- loss: 1.487203, loss_ss: 0.990868, loss_d: 0.496335
0.8436 --- loss: 1.709404, loss_ss: 1.142919, loss_d: 0.566486
0.8819 --- loss: 1.991848, loss_ss: 1.472270, loss_d: 0.519578
0.9202 --- loss: 1.719154, loss_ss: 1.150763, loss_d: 0.568391
0.9586 --- loss: 1.238235, loss_ss: 1.022762, loss_d: 0.215474
0.9969 --- loss: 1.817274, loss_ss: 1.080569, loss_d: 0.736705
Epoch finished! Loss: 1.5467214171703045
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.380670, loss_ss: 1.134298, loss_d: 0.246371
0.0383 --- loss: 1.302024, loss_ss: 1.084490, loss_d: 0.217535
0.0767 --- loss: 1.310993, loss_ss: 0.985722, loss_d: 0.325271
0.1150 --- loss: 1.032625, loss_ss: 0.867993, loss_d: 0.164633
0.1534 --- loss: 1.693258, loss_ss: 1.103566, loss_d: 0.589692
0.1917 --- loss: 1.374327, loss_ss: 0.809384, loss_d: 0.564943
0.2301 --- loss: 1.210573, loss_ss: 0.966961, loss_d: 0.243611
0.2684 --- loss: 1.290202, loss_ss: 1.027693, loss_d: 0.262510
0.3067 --- loss: 1.396395, loss_ss: 0.877462, loss_d: 0.518933
0.3451 --- loss: 1.594252, loss_ss: 1.327331, loss_d: 0.266921
0.3834 --- loss: 1.313227, loss_ss: 1.011708, loss_d: 0.301519
0.4218 --- loss: 1.321184, loss_ss: 1.136108, loss_d: 0.185076
0.4601 --- loss: 1.142390, loss_ss: 0.912643, loss_d: 0.229748
0.4985 --- loss: 1.329565, loss_ss: 1.002219, loss_d: 0.327346
0.5368 --- loss: 1.353845, loss_ss: 1.220810, loss_d: 0.133035
0.5752 --- loss: 1.136919, loss_ss: 1.067222, loss_d: 0.069697
0.6135 --- loss: 1.072005, loss_ss: 0.932268, loss_d: 0.139737
0.6518 --- loss: 1.081697, loss_ss: 0.851498, loss_d: 0.230199
0.6902 --- loss: 1.040761, loss_ss: 0.924332, loss_d: 0.116428
0.7285 --- loss: 1.829201, loss_ss: 1.043350, loss_d: 0.785851
0.7669 --- loss: 1.203693, loss_ss: 0.972360, loss_d: 0.231333
0.8052 --- loss: 1.631599, loss_ss: 0.989314, loss_d: 0.642285
0.8436 --- loss: 1.628150, loss_ss: 0.964464, loss_d: 0.663686
0.8819 --- loss: 1.354305, loss_ss: 1.128406, loss_d: 0.225899
0.9202 --- loss: 1.176777, loss_ss: 0.926416, loss_d: 0.250361
0.9586 --- loss: 1.967436, loss_ss: 1.707994, loss_d: 0.259442
0.9969 --- loss: 0.843289, loss_ss: 0.724727, loss_d: 0.118562
Epoch finished! Loss: 1.3649707454901474
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.065955, loss_ss: 0.902853, loss_d: 0.163103
0.0383 --- loss: 1.236102, loss_ss: 0.959457, loss_d: 0.276644
0.0767 --- loss: 0.811925, loss_ss: 0.764791, loss_d: 0.047134
0.1150 --- loss: 1.905395, loss_ss: 1.055182, loss_d: 0.850213
0.1534 --- loss: 1.123352, loss_ss: 1.063100, loss_d: 0.060251
0.1917 --- loss: 1.062771, loss_ss: 0.854998, loss_d: 0.207773
0.2301 --- loss: 0.946814, loss_ss: 0.811408, loss_d: 0.135406
0.2684 --- loss: 1.431085, loss_ss: 1.049461, loss_d: 0.381625
0.3067 --- loss: 0.889297, loss_ss: 0.838688, loss_d: 0.050609
0.3451 --- loss: 1.139247, loss_ss: 0.995095, loss_d: 0.144152
0.3834 --- loss: 1.552951, loss_ss: 1.117094, loss_d: 0.435856
0.4218 --- loss: 1.493816, loss_ss: 1.107536, loss_d: 0.386280
0.4601 --- loss: 1.050317, loss_ss: 0.918507, loss_d: 0.131810
0.4985 --- loss: 1.178600, loss_ss: 0.992109, loss_d: 0.186491
0.5368 --- loss: 1.044393, loss_ss: 0.812054, loss_d: 0.232339
0.5752 --- loss: 1.552728, loss_ss: 0.959749, loss_d: 0.592978
0.6135 --- loss: 1.076059, loss_ss: 0.934992, loss_d: 0.141067
0.6518 --- loss: 1.485649, loss_ss: 1.164686, loss_d: 0.320963
0.6902 --- loss: 1.002551, loss_ss: 0.924808, loss_d: 0.077743
0.7285 --- loss: 1.562951, loss_ss: 0.851314, loss_d: 0.711637
0.7669 --- loss: 1.411778, loss_ss: 1.169989, loss_d: 0.241790
0.8052 --- loss: 1.608824, loss_ss: 1.256491, loss_d: 0.352334
0.8436 --- loss: 1.382980, loss_ss: 0.809054, loss_d: 0.573926
0.8819 --- loss: 1.123339, loss_ss: 0.988144, loss_d: 0.135195
0.9202 --- loss: 0.925031, loss_ss: 0.792090, loss_d: 0.132941
0.9586 --- loss: 1.149950, loss_ss: 0.844016, loss_d: 0.305933
0.9969 --- loss: 1.251565, loss_ss: 0.657898, loss_d: 0.593667
Epoch finished! Loss: 1.257447967162499
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.284831, loss_ss: 1.153954, loss_d: 0.130877
0.0383 --- loss: 0.914085, loss_ss: 0.820457, loss_d: 0.093628
0.0767 --- loss: 1.537922, loss_ss: 0.985886, loss_d: 0.552036
0.1150 --- loss: 1.499077, loss_ss: 1.326470, loss_d: 0.172607
0.1534 --- loss: 1.047034, loss_ss: 0.799508, loss_d: 0.247526
0.1917 --- loss: 0.926592, loss_ss: 0.826306, loss_d: 0.100286
0.2301 --- loss: 1.229562, loss_ss: 1.030208, loss_d: 0.199355
0.2684 --- loss: 1.046876, loss_ss: 0.953105, loss_d: 0.093771
0.3067 --- loss: 1.015841, loss_ss: 0.932226, loss_d: 0.083616
0.3451 --- loss: 1.170616, loss_ss: 1.121095, loss_d: 0.049521
0.3834 --- loss: 1.052828, loss_ss: 0.946356, loss_d: 0.106472
0.4218 --- loss: 1.089612, loss_ss: 0.985942, loss_d: 0.103670
0.4601 --- loss: 1.433230, loss_ss: 1.346689, loss_d: 0.086541
0.4985 --- loss: 0.921292, loss_ss: 0.859342, loss_d: 0.061950
0.5368 --- loss: 0.850906, loss_ss: 0.784757, loss_d: 0.066149
0.5752 --- loss: 1.369054, loss_ss: 1.057314, loss_d: 0.311740
0.6135 --- loss: 1.117255, loss_ss: 1.045357, loss_d: 0.071898
0.6518 --- loss: 0.948898, loss_ss: 0.900652, loss_d: 0.048246
0.6902 --- loss: 1.137035, loss_ss: 0.884979, loss_d: 0.252055
0.7285 --- loss: 1.073149, loss_ss: 0.957877, loss_d: 0.115273
0.7669 --- loss: 1.725012, loss_ss: 1.285189, loss_d: 0.439823
0.8052 --- loss: 1.234071, loss_ss: 0.855269, loss_d: 0.378802
0.8436 --- loss: 1.421535, loss_ss: 1.098425, loss_d: 0.323110
0.8819 --- loss: 1.060042, loss_ss: 0.971135, loss_d: 0.088908
0.9202 --- loss: 1.476673, loss_ss: 1.394438, loss_d: 0.082235
0.9586 --- loss: 1.319123, loss_ss: 0.836591, loss_d: 0.482532
0.9969 --- loss: 1.263061, loss_ss: 0.858944, loss_d: 0.404117
Epoch finished! Loss: 1.164852088002058
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.997059, loss_ss: 0.799612, loss_d: 0.197447
0.0383 --- loss: 1.639549, loss_ss: 1.149109, loss_d: 0.490440
0.0767 --- loss: 0.772577, loss_ss: 0.686516, loss_d: 0.086061
0.1150 --- loss: 1.009897, loss_ss: 0.852663, loss_d: 0.157234
0.1534 --- loss: 1.103085, loss_ss: 1.083294, loss_d: 0.019791
0.1917 --- loss: 1.403179, loss_ss: 1.003073, loss_d: 0.400105
0.2301 --- loss: 1.229557, loss_ss: 0.965596, loss_d: 0.263961
0.2684 --- loss: 1.187584, loss_ss: 0.831678, loss_d: 0.355906
0.3067 --- loss: 1.510154, loss_ss: 0.872122, loss_d: 0.638032
0.3451 --- loss: 1.002592, loss_ss: 0.902992, loss_d: 0.099601
0.3834 --- loss: 0.952056, loss_ss: 0.848626, loss_d: 0.103430
0.4218 --- loss: 1.966104, loss_ss: 1.287392, loss_d: 0.678712
0.4601 --- loss: 0.987185, loss_ss: 0.907924, loss_d: 0.079260
0.4985 --- loss: 1.183771, loss_ss: 1.077512, loss_d: 0.106259
0.5368 --- loss: 1.062720, loss_ss: 0.812525, loss_d: 0.250195
0.5752 --- loss: 1.306829, loss_ss: 1.241471, loss_d: 0.065359
0.6135 --- loss: 1.211364, loss_ss: 1.171076, loss_d: 0.040287
0.6518 --- loss: 1.832857, loss_ss: 1.190238, loss_d: 0.642619
0.6902 --- loss: 1.106214, loss_ss: 0.825763, loss_d: 0.280451
0.7285 --- loss: 1.345354, loss_ss: 0.893129, loss_d: 0.452226
0.7669 --- loss: 1.215237, loss_ss: 0.896489, loss_d: 0.318748
0.8052 --- loss: 0.957058, loss_ss: 0.820439, loss_d: 0.136618
0.8436 --- loss: 1.431064, loss_ss: 0.722851, loss_d: 0.708212
0.8819 --- loss: 1.246480, loss_ss: 0.659398, loss_d: 0.587082
0.9202 --- loss: 0.856215, loss_ss: 0.706357, loss_d: 0.149858
0.9586 --- loss: 0.950798, loss_ss: 0.904951, loss_d: 0.045847
0.9969 --- loss: 1.027363, loss_ss: 0.767232, loss_d: 0.260131
Epoch finished! Loss: 1.1216859842722233
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.060685, loss_ss: 0.980497, loss_d: 0.080188
0.0383 --- loss: 1.186127, loss_ss: 0.954942, loss_d: 0.231185
0.0767 --- loss: 0.811952, loss_ss: 0.744507, loss_d: 0.067446
0.1150 --- loss: 1.148209, loss_ss: 1.121420, loss_d: 0.026789
0.1534 --- loss: 1.195463, loss_ss: 1.148525, loss_d: 0.046938
0.1917 --- loss: 0.972268, loss_ss: 0.782929, loss_d: 0.189338
0.2301 --- loss: 0.988758, loss_ss: 0.829200, loss_d: 0.159558
0.2684 --- loss: 1.079332, loss_ss: 0.876335, loss_d: 0.202997
0.3067 --- loss: 0.951324, loss_ss: 0.927857, loss_d: 0.023467
0.3451 --- loss: 0.875877, loss_ss: 0.840654, loss_d: 0.035222
0.3834 --- loss: 0.895739, loss_ss: 0.803137, loss_d: 0.092601
0.4218 --- loss: 1.094234, loss_ss: 1.026051, loss_d: 0.068183
0.4601 --- loss: 1.289768, loss_ss: 1.072821, loss_d: 0.216947
0.4985 --- loss: 1.593472, loss_ss: 0.844927, loss_d: 0.748545
0.5368 --- loss: 0.986429, loss_ss: 0.675916, loss_d: 0.310513
0.5752 --- loss: 0.979409, loss_ss: 0.936895, loss_d: 0.042514
0.6135 --- loss: 0.811503, loss_ss: 0.774546, loss_d: 0.036957
0.6518 --- loss: 0.989806, loss_ss: 0.916629, loss_d: 0.073177
0.6902 --- loss: 0.958019, loss_ss: 0.668495, loss_d: 0.289524
0.7285 --- loss: 0.918901, loss_ss: 0.886653, loss_d: 0.032249
0.7669 --- loss: 0.952563, loss_ss: 0.813387, loss_d: 0.139176
0.8052 --- loss: 0.925671, loss_ss: 0.888108, loss_d: 0.037562
0.8436 --- loss: 1.398849, loss_ss: 1.134697, loss_d: 0.264151
0.8819 --- loss: 0.829521, loss_ss: 0.712350, loss_d: 0.117171
0.9202 --- loss: 1.235149, loss_ss: 0.971641, loss_d: 0.263508
0.9586 --- loss: 1.331086, loss_ss: 0.959399, loss_d: 0.371687
0.9969 --- loss: 1.158017, loss_ss: 1.046181, loss_d: 0.111836
Epoch finished! Loss: 1.0692630196993167
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.844443, loss_ss: 0.800175, loss_d: 0.044268
0.0383 --- loss: 1.428756, loss_ss: 1.255294, loss_d: 0.173462
0.0767 --- loss: 0.914520, loss_ss: 0.831124, loss_d: 0.083396
0.1150 --- loss: 0.825474, loss_ss: 0.679668, loss_d: 0.145805
0.1534 --- loss: 0.870056, loss_ss: 0.846901, loss_d: 0.023155
0.1917 --- loss: 1.368573, loss_ss: 1.242580, loss_d: 0.125993
0.2301 --- loss: 0.812579, loss_ss: 0.650200, loss_d: 0.162379
0.2684 --- loss: 1.111567, loss_ss: 1.022901, loss_d: 0.088666
0.3067 --- loss: 0.890082, loss_ss: 0.870752, loss_d: 0.019330
0.3451 --- loss: 1.276051, loss_ss: 0.937268, loss_d: 0.338784
0.3834 --- loss: 1.018031, loss_ss: 0.960112, loss_d: 0.057920
0.4218 --- loss: 1.102082, loss_ss: 1.001749, loss_d: 0.100333
0.4601 --- loss: 1.258802, loss_ss: 0.746346, loss_d: 0.512456
0.4985 --- loss: 0.901923, loss_ss: 0.877055, loss_d: 0.024868
0.5368 --- loss: 0.648462, loss_ss: 0.630421, loss_d: 0.018040
0.5752 --- loss: 0.720011, loss_ss: 0.702111, loss_d: 0.017900
0.6135 --- loss: 0.892552, loss_ss: 0.787409, loss_d: 0.105143
0.6518 --- loss: 0.798994, loss_ss: 0.756250, loss_d: 0.042744
0.6902 --- loss: 0.781309, loss_ss: 0.735490, loss_d: 0.045818
0.7285 --- loss: 1.449410, loss_ss: 0.748262, loss_d: 0.701147
0.7669 --- loss: 1.007573, loss_ss: 0.803039, loss_d: 0.204533
0.8052 --- loss: 0.703323, loss_ss: 0.637491, loss_d: 0.065832
0.8436 --- loss: 0.969132, loss_ss: 0.953549, loss_d: 0.015584
0.8819 --- loss: 1.103201, loss_ss: 0.814735, loss_d: 0.288466
0.9202 --- loss: 0.743821, loss_ss: 0.720599, loss_d: 0.023222
0.9586 --- loss: 0.742573, loss_ss: 0.686677, loss_d: 0.055896
0.9969 --- loss: 0.924296, loss_ss: 0.746045, loss_d: 0.178252
Epoch finished! Loss: 1.015394162443968
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.073874, loss_ss: 1.039700, loss_d: 0.034173
0.0383 --- loss: 0.644489, loss_ss: 0.537003, loss_d: 0.107486
0.0767 --- loss: 1.195467, loss_ss: 1.178058, loss_d: 0.017410
0.1150 --- loss: 0.896526, loss_ss: 0.886934, loss_d: 0.009593
0.1534 --- loss: 1.253648, loss_ss: 1.159303, loss_d: 0.094344
0.1917 --- loss: 1.243565, loss_ss: 0.778435, loss_d: 0.465130
0.2301 --- loss: 1.021671, loss_ss: 0.919641, loss_d: 0.102030
0.2684 --- loss: 1.007388, loss_ss: 0.946789, loss_d: 0.060598
0.3067 --- loss: 0.980736, loss_ss: 0.651021, loss_d: 0.329715
0.3451 --- loss: 0.978320, loss_ss: 0.931150, loss_d: 0.047170
0.3834 --- loss: 1.357853, loss_ss: 0.974638, loss_d: 0.383215
0.4218 --- loss: 0.880227, loss_ss: 0.808063, loss_d: 0.072164
0.4601 --- loss: 0.775579, loss_ss: 0.624879, loss_d: 0.150700
0.4985 --- loss: 0.972665, loss_ss: 0.837931, loss_d: 0.134734
0.5368 --- loss: 1.442000, loss_ss: 1.191757, loss_d: 0.250243
0.5752 --- loss: 0.886948, loss_ss: 0.805232, loss_d: 0.081716
0.6135 --- loss: 1.471771, loss_ss: 0.616699, loss_d: 0.855071
0.6518 --- loss: 0.745291, loss_ss: 0.730213, loss_d: 0.015078
0.6902 --- loss: 0.872802, loss_ss: 0.835135, loss_d: 0.037666
0.7285 --- loss: 0.852910, loss_ss: 0.812576, loss_d: 0.040334
0.7669 --- loss: 0.716885, loss_ss: 0.604882, loss_d: 0.112003
0.8052 --- loss: 0.849496, loss_ss: 0.702725, loss_d: 0.146771
0.8436 --- loss: 0.777554, loss_ss: 0.611760, loss_d: 0.165793
0.8819 --- loss: 0.657100, loss_ss: 0.514723, loss_d: 0.142377
0.9202 --- loss: 0.683735, loss_ss: 0.620250, loss_d: 0.063485
0.9586 --- loss: 1.161104, loss_ss: 0.882531, loss_d: 0.278573
0.9969 --- loss: 0.767506, loss_ss: 0.756843, loss_d: 0.010663
Epoch finished! Loss: 0.9978290878809415
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.901050, loss_ss: 0.780545, loss_d: 0.120505
0.0383 --- loss: 1.080819, loss_ss: 1.065008, loss_d: 0.015812
0.0767 --- loss: 0.852545, loss_ss: 0.837626, loss_d: 0.014919
0.1150 --- loss: 0.885221, loss_ss: 0.822550, loss_d: 0.062671
0.1534 --- loss: 0.888678, loss_ss: 0.884826, loss_d: 0.003852
0.1917 --- loss: 0.533354, loss_ss: 0.515698, loss_d: 0.017656
0.2301 --- loss: 1.009251, loss_ss: 0.847818, loss_d: 0.161433
0.2684 --- loss: 1.122274, loss_ss: 1.051901, loss_d: 0.070373
0.3067 --- loss: 1.113946, loss_ss: 1.070411, loss_d: 0.043536
0.3451 --- loss: 0.750217, loss_ss: 0.710838, loss_d: 0.039379
0.3834 --- loss: 0.920376, loss_ss: 0.873362, loss_d: 0.047014
0.4218 --- loss: 1.100797, loss_ss: 1.052549, loss_d: 0.048248
0.4601 --- loss: 0.887414, loss_ss: 0.836145, loss_d: 0.051269
0.4985 --- loss: 1.260973, loss_ss: 0.670468, loss_d: 0.590505
0.5368 --- loss: 1.150622, loss_ss: 1.027091, loss_d: 0.123531
0.5752 --- loss: 0.906675, loss_ss: 0.889873, loss_d: 0.016802
0.6135 --- loss: 0.993238, loss_ss: 0.743614, loss_d: 0.249624
0.6518 --- loss: 0.701562, loss_ss: 0.646050, loss_d: 0.055511
0.6902 --- loss: 0.929103, loss_ss: 0.909903, loss_d: 0.019200
0.7285 --- loss: 1.249101, loss_ss: 1.176632, loss_d: 0.072469
0.7669 --- loss: 0.859828, loss_ss: 0.777496, loss_d: 0.082333
0.8052 --- loss: 0.881817, loss_ss: 0.732875, loss_d: 0.148942
0.8436 --- loss: 1.152066, loss_ss: 0.989459, loss_d: 0.162607
0.8819 --- loss: 0.805287, loss_ss: 0.688511, loss_d: 0.116776
0.9202 --- loss: 1.194724, loss_ss: 1.010289, loss_d: 0.184435
0.9586 --- loss: 1.444922, loss_ss: 1.180868, loss_d: 0.264054
0.9969 --- loss: 1.004817, loss_ss: 0.850171, loss_d: 0.154647
Epoch finished! Loss: 0.973428048308079
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8266666666666667
             precision    recall  f1-score   support

        0.0       0.62      0.97      0.76        29
        1.0       0.54      0.47      0.50        57
        2.0       0.98      0.70      0.82       391
        3.0       0.85      1.00      0.92       250
        4.0       0.71      0.97      0.82       173

avg / total       0.85      0.83      0.82       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.00  96.55   98.05  62.22     75.68
1  94.11  47.37   97.27  54.00     50.47
2  86.33  69.82   99.02  98.20     81.61
3  95.00  99.60   93.23  84.98     91.71
4  91.89  96.53   90.78  71.37     82.06
Total accuracy: 82.67%
Average sen: 81.97%
Average spec: 95.67%
Macro f1-score: 76.31%
Diagnosis acc on 15mins: 0.8
[8.70807171e-01 3.94236557e-02 8.69653188e-03 6.20837882e-03
 2.52075400e-03 2.06662226e-03 4.59872603e-01 3.69940132e-01
 3.61844040e-02 5.26747666e-03 7.47492015e-02 2.22165674e-01
 6.19039759e-02 5.98934114e-01 7.32101738e-01 8.66325855e-01
 5.78780174e-01 2.68625561e-02 3.59774679e-02 2.90154181e-02
 1.63626373e-01 8.61073017e-01 9.21993330e-02 1.52528379e-03
 1.03591783e-02 7.43138604e-04 1.59181457e-03 1.76198373e-03
 1.26686590e-02 2.39281759e-01]
pred: 0.21375448148852835, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.433910, loss_ss: 1.739095, loss_d: 0.694815
0.0383 --- loss: 2.089126, loss_ss: 1.529368, loss_d: 0.559758
0.0767 --- loss: 2.320520, loss_ss: 1.603417, loss_d: 0.717103
0.1150 --- loss: 2.241624, loss_ss: 1.513755, loss_d: 0.727869
0.1533 --- loss: 2.354074, loss_ss: 1.444103, loss_d: 0.909971
0.1916 --- loss: 1.748454, loss_ss: 1.450349, loss_d: 0.298104
0.2300 --- loss: 2.116722, loss_ss: 1.527673, loss_d: 0.589049
0.2683 --- loss: 1.912997, loss_ss: 1.397969, loss_d: 0.515028
0.3066 --- loss: 2.091219, loss_ss: 1.429792, loss_d: 0.661427
0.3450 --- loss: 2.184934, loss_ss: 1.481387, loss_d: 0.703548
0.3833 --- loss: 1.741109, loss_ss: 1.383384, loss_d: 0.357725
0.4216 --- loss: 1.962067, loss_ss: 1.334749, loss_d: 0.627318
0.4599 --- loss: 1.671058, loss_ss: 1.282165, loss_d: 0.388893
0.4983 --- loss: 1.809468, loss_ss: 1.294954, loss_d: 0.514514
0.5366 --- loss: 1.617469, loss_ss: 1.235783, loss_d: 0.381685
0.5749 --- loss: 1.647263, loss_ss: 1.262650, loss_d: 0.384613
0.6133 --- loss: 1.705246, loss_ss: 1.241333, loss_d: 0.463913
0.6516 --- loss: 1.631804, loss_ss: 1.286156, loss_d: 0.345648
0.6899 --- loss: 1.520978, loss_ss: 1.225086, loss_d: 0.295891
0.7282 --- loss: 2.000479, loss_ss: 1.370515, loss_d: 0.629964
0.7666 --- loss: 1.806768, loss_ss: 1.295429, loss_d: 0.511339
0.8049 --- loss: 1.577199, loss_ss: 1.133341, loss_d: 0.443858
0.8432 --- loss: 1.896102, loss_ss: 1.410154, loss_d: 0.485949
0.8816 --- loss: 1.865133, loss_ss: 1.216007, loss_d: 0.649127
0.9199 --- loss: 1.582387, loss_ss: 1.057960, loss_d: 0.524427
0.9582 --- loss: 1.641919, loss_ss: 1.276169, loss_d: 0.365750
0.9966 --- loss: 1.670426, loss_ss: 1.237755, loss_d: 0.432672
Epoch finished! Loss: 1.9058554012041826
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.779276, loss_ss: 1.459000, loss_d: 0.320276
0.0383 --- loss: 1.670047, loss_ss: 1.260444, loss_d: 0.409604
0.0767 --- loss: 1.591149, loss_ss: 1.096504, loss_d: 0.494644
0.1150 --- loss: 1.526971, loss_ss: 1.122995, loss_d: 0.403976
0.1533 --- loss: 1.575619, loss_ss: 1.191454, loss_d: 0.384165
0.1916 --- loss: 1.640376, loss_ss: 1.111509, loss_d: 0.528867
0.2300 --- loss: 1.592073, loss_ss: 1.147575, loss_d: 0.444498
0.2683 --- loss: 1.978296, loss_ss: 1.600707, loss_d: 0.377589
0.3066 --- loss: 1.454272, loss_ss: 1.323839, loss_d: 0.130433
0.3450 --- loss: 1.383570, loss_ss: 1.033183, loss_d: 0.350388
0.3833 --- loss: 1.554223, loss_ss: 1.032578, loss_d: 0.521645
0.4216 --- loss: 1.631855, loss_ss: 1.120003, loss_d: 0.511853
0.4599 --- loss: 1.756810, loss_ss: 1.269513, loss_d: 0.487297
0.4983 --- loss: 1.342181, loss_ss: 1.099827, loss_d: 0.242353
0.5366 --- loss: 1.597289, loss_ss: 1.429189, loss_d: 0.168100
0.5749 --- loss: 1.186928, loss_ss: 1.017215, loss_d: 0.169712
0.6133 --- loss: 1.363326, loss_ss: 1.001771, loss_d: 0.361555
0.6516 --- loss: 1.474888, loss_ss: 1.077379, loss_d: 0.397509
0.6899 --- loss: 1.288269, loss_ss: 0.918867, loss_d: 0.369402
0.7282 --- loss: 1.170869, loss_ss: 0.999085, loss_d: 0.171784
0.7666 --- loss: 1.519046, loss_ss: 0.940438, loss_d: 0.578609
0.8049 --- loss: 1.602244, loss_ss: 0.985675, loss_d: 0.616569
0.8432 --- loss: 1.310058, loss_ss: 0.984800, loss_d: 0.325258
0.8816 --- loss: 1.269517, loss_ss: 0.996776, loss_d: 0.272741
0.9199 --- loss: 1.387282, loss_ss: 1.095650, loss_d: 0.291632
0.9582 --- loss: 1.618995, loss_ss: 1.340286, loss_d: 0.278710
0.9966 --- loss: 1.387181, loss_ss: 1.098622, loss_d: 0.288559
Epoch finished! Loss: 1.4688901188281867
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.060198, loss_ss: 0.934024, loss_d: 0.126174
0.0383 --- loss: 1.360205, loss_ss: 0.866191, loss_d: 0.494014
0.0767 --- loss: 1.845099, loss_ss: 1.338811, loss_d: 0.506288
0.1150 --- loss: 1.024317, loss_ss: 0.902997, loss_d: 0.121320
0.1533 --- loss: 1.463316, loss_ss: 1.019228, loss_d: 0.444088
0.1916 --- loss: 1.111541, loss_ss: 1.050484, loss_d: 0.061057
0.2300 --- loss: 1.227727, loss_ss: 0.883297, loss_d: 0.344430
0.2683 --- loss: 1.342391, loss_ss: 0.762692, loss_d: 0.579698
0.3066 --- loss: 0.990248, loss_ss: 0.806875, loss_d: 0.183373
0.3450 --- loss: 1.371770, loss_ss: 1.137205, loss_d: 0.234565
0.3833 --- loss: 1.619321, loss_ss: 1.421317, loss_d: 0.198004
0.4216 --- loss: 1.271663, loss_ss: 0.888607, loss_d: 0.383056
0.4599 --- loss: 1.343009, loss_ss: 0.938408, loss_d: 0.404601
0.4983 --- loss: 1.265996, loss_ss: 0.836101, loss_d: 0.429895
0.5366 --- loss: 1.839583, loss_ss: 1.052961, loss_d: 0.786622
0.5749 --- loss: 1.181194, loss_ss: 0.846379, loss_d: 0.334815
0.6133 --- loss: 1.612687, loss_ss: 1.086317, loss_d: 0.526370
0.6516 --- loss: 0.994265, loss_ss: 0.864613, loss_d: 0.129652
0.6899 --- loss: 1.339094, loss_ss: 1.011577, loss_d: 0.327518
0.7282 --- loss: 1.007803, loss_ss: 0.838864, loss_d: 0.168940
0.7666 --- loss: 0.937320, loss_ss: 0.773991, loss_d: 0.163329
0.8049 --- loss: 1.114549, loss_ss: 0.718491, loss_d: 0.396058
0.8432 --- loss: 1.389653, loss_ss: 1.179338, loss_d: 0.210315
0.8816 --- loss: 1.649891, loss_ss: 1.238430, loss_d: 0.411461
0.9199 --- loss: 1.602805, loss_ss: 1.045493, loss_d: 0.557312
0.9582 --- loss: 1.722428, loss_ss: 0.811017, loss_d: 0.911411
0.9966 --- loss: 1.080365, loss_ss: 0.775121, loss_d: 0.305244
Epoch finished! Loss: 1.3070223867893218
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.388999, loss_ss: 1.247130, loss_d: 0.141868
0.0383 --- loss: 1.197736, loss_ss: 1.141725, loss_d: 0.056011
0.0767 --- loss: 1.318312, loss_ss: 0.982569, loss_d: 0.335743
0.1150 --- loss: 1.214928, loss_ss: 1.053565, loss_d: 0.161364
0.1533 --- loss: 1.122368, loss_ss: 0.966225, loss_d: 0.156143
0.1916 --- loss: 1.322351, loss_ss: 0.897378, loss_d: 0.424973
0.2300 --- loss: 1.063621, loss_ss: 0.835595, loss_d: 0.228026
0.2683 --- loss: 1.174669, loss_ss: 0.883388, loss_d: 0.291281
0.3066 --- loss: 1.039161, loss_ss: 0.810200, loss_d: 0.228961
0.3450 --- loss: 1.330661, loss_ss: 0.874811, loss_d: 0.455850
0.3833 --- loss: 1.350672, loss_ss: 0.775098, loss_d: 0.575574
0.4216 --- loss: 2.314112, loss_ss: 0.814535, loss_d: 1.499577
0.4599 --- loss: 0.952852, loss_ss: 0.893658, loss_d: 0.059194
0.4983 --- loss: 0.933066, loss_ss: 0.778976, loss_d: 0.154090
0.5366 --- loss: 1.878180, loss_ss: 1.263572, loss_d: 0.614608
0.5749 --- loss: 0.815936, loss_ss: 0.764535, loss_d: 0.051402
0.6133 --- loss: 1.664471, loss_ss: 1.025097, loss_d: 0.639374
0.6516 --- loss: 1.138607, loss_ss: 1.097621, loss_d: 0.040986
0.6899 --- loss: 1.226237, loss_ss: 0.872474, loss_d: 0.353763
0.7282 --- loss: 0.964605, loss_ss: 0.719985, loss_d: 0.244620
0.7666 --- loss: 0.921961, loss_ss: 0.874252, loss_d: 0.047709
0.8049 --- loss: 1.265717, loss_ss: 0.765424, loss_d: 0.500293
0.8432 --- loss: 0.764853, loss_ss: 0.582038, loss_d: 0.182815
0.8816 --- loss: 0.788803, loss_ss: 0.688855, loss_d: 0.099948
0.9199 --- loss: 0.916517, loss_ss: 0.876589, loss_d: 0.039928
0.9582 --- loss: 0.923101, loss_ss: 0.815282, loss_d: 0.107819
0.9966 --- loss: 1.216171, loss_ss: 0.804217, loss_d: 0.411954
Epoch finished! Loss: 1.212698193009083
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.106799, loss_ss: 1.014022, loss_d: 0.092777
0.0383 --- loss: 0.972321, loss_ss: 0.896835, loss_d: 0.075487
0.0767 --- loss: 1.115906, loss_ss: 0.737536, loss_d: 0.378370
0.1150 --- loss: 1.133480, loss_ss: 0.979129, loss_d: 0.154351
0.1533 --- loss: 1.415488, loss_ss: 1.041368, loss_d: 0.374120
0.1916 --- loss: 1.042969, loss_ss: 0.972962, loss_d: 0.070007
0.2300 --- loss: 1.073488, loss_ss: 0.937881, loss_d: 0.135607
0.2683 --- loss: 1.435261, loss_ss: 0.956232, loss_d: 0.479028
0.3066 --- loss: 0.895114, loss_ss: 0.842621, loss_d: 0.052493
0.3450 --- loss: 1.011499, loss_ss: 0.779131, loss_d: 0.232368
0.3833 --- loss: 1.228863, loss_ss: 0.868775, loss_d: 0.360087
0.4216 --- loss: 1.299422, loss_ss: 0.979939, loss_d: 0.319483
0.4599 --- loss: 0.807939, loss_ss: 0.723378, loss_d: 0.084561
0.4983 --- loss: 0.894526, loss_ss: 0.825926, loss_d: 0.068600
0.5366 --- loss: 0.861964, loss_ss: 0.787332, loss_d: 0.074633
0.5749 --- loss: 0.869704, loss_ss: 0.821374, loss_d: 0.048330
0.6133 --- loss: 1.304378, loss_ss: 1.217046, loss_d: 0.087331
0.6516 --- loss: 0.918478, loss_ss: 0.873194, loss_d: 0.045285
0.6899 --- loss: 1.045741, loss_ss: 0.953909, loss_d: 0.091832
0.7282 --- loss: 0.997457, loss_ss: 0.801365, loss_d: 0.196091
0.7666 --- loss: 1.028915, loss_ss: 0.637650, loss_d: 0.391266
0.8049 --- loss: 0.856676, loss_ss: 0.551661, loss_d: 0.305015
0.8432 --- loss: 1.428426, loss_ss: 0.980927, loss_d: 0.447498
0.8816 --- loss: 1.071751, loss_ss: 0.815539, loss_d: 0.256212
0.9199 --- loss: 1.516634, loss_ss: 1.168779, loss_d: 0.347855
0.9582 --- loss: 1.160452, loss_ss: 0.875539, loss_d: 0.284913
0.9966 --- loss: 1.100384, loss_ss: 0.743248, loss_d: 0.357136
Epoch finished! Loss: 1.1249722719192505
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.845571, loss_ss: 0.802812, loss_d: 0.042759
0.0383 --- loss: 0.706118, loss_ss: 0.684544, loss_d: 0.021575
0.0767 --- loss: 0.736401, loss_ss: 0.683168, loss_d: 0.053233
0.1150 --- loss: 0.846308, loss_ss: 0.831649, loss_d: 0.014660
0.1533 --- loss: 0.703801, loss_ss: 0.656032, loss_d: 0.047769
0.1916 --- loss: 1.112270, loss_ss: 0.823449, loss_d: 0.288821
0.2300 --- loss: 0.867335, loss_ss: 0.807846, loss_d: 0.059489
0.2683 --- loss: 0.912922, loss_ss: 0.792325, loss_d: 0.120597
0.3066 --- loss: 1.517672, loss_ss: 0.990903, loss_d: 0.526770
0.3450 --- loss: 1.024887, loss_ss: 0.937809, loss_d: 0.087078
0.3833 --- loss: 0.764085, loss_ss: 0.635342, loss_d: 0.128742
0.4216 --- loss: 1.150853, loss_ss: 1.008554, loss_d: 0.142299
0.4599 --- loss: 0.997097, loss_ss: 0.842176, loss_d: 0.154922
0.4983 --- loss: 1.319878, loss_ss: 1.161632, loss_d: 0.158246
0.5366 --- loss: 1.213277, loss_ss: 1.010599, loss_d: 0.202678
0.5749 --- loss: 1.110219, loss_ss: 0.882048, loss_d: 0.228171
0.6133 --- loss: 1.103914, loss_ss: 1.052304, loss_d: 0.051610
0.6516 --- loss: 0.923558, loss_ss: 0.742906, loss_d: 0.180652
0.6899 --- loss: 1.223303, loss_ss: 1.127697, loss_d: 0.095607
0.7282 --- loss: 0.728212, loss_ss: 0.655312, loss_d: 0.072901
0.7666 --- loss: 0.925260, loss_ss: 0.806129, loss_d: 0.119131
0.8049 --- loss: 0.990619, loss_ss: 0.925270, loss_d: 0.065348
0.8432 --- loss: 0.885269, loss_ss: 0.813474, loss_d: 0.071795
0.8816 --- loss: 1.046381, loss_ss: 0.811593, loss_d: 0.234788
0.9199 --- loss: 1.098912, loss_ss: 1.065038, loss_d: 0.033874
0.9582 --- loss: 1.217231, loss_ss: 0.849148, loss_d: 0.368083
0.9966 --- loss: 0.963898, loss_ss: 0.845437, loss_d: 0.118461
Epoch finished! Loss: 1.0918240063465559
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.041322, loss_ss: 0.800634, loss_d: 0.240687
0.0383 --- loss: 0.981942, loss_ss: 0.835326, loss_d: 0.146617
0.0767 --- loss: 0.814998, loss_ss: 0.756407, loss_d: 0.058592
0.1150 --- loss: 0.809997, loss_ss: 0.697976, loss_d: 0.112021
0.1533 --- loss: 0.832919, loss_ss: 0.703574, loss_d: 0.129345
0.1916 --- loss: 0.938009, loss_ss: 0.616920, loss_d: 0.321088
0.2300 --- loss: 1.301085, loss_ss: 1.071034, loss_d: 0.230051
0.2683 --- loss: 0.968329, loss_ss: 0.951172, loss_d: 0.017157
0.3066 --- loss: 1.232384, loss_ss: 1.149070, loss_d: 0.083314
0.3450 --- loss: 1.148995, loss_ss: 0.940384, loss_d: 0.208611
0.3833 --- loss: 1.286241, loss_ss: 1.201162, loss_d: 0.085080
0.4216 --- loss: 0.824340, loss_ss: 0.804926, loss_d: 0.019413
0.4599 --- loss: 1.020082, loss_ss: 0.845361, loss_d: 0.174722
0.4983 --- loss: 1.661705, loss_ss: 0.922802, loss_d: 0.738903
0.5366 --- loss: 0.871359, loss_ss: 0.715032, loss_d: 0.156327
0.5749 --- loss: 0.807524, loss_ss: 0.746977, loss_d: 0.060547
0.6133 --- loss: 0.710039, loss_ss: 0.686499, loss_d: 0.023540
0.6516 --- loss: 0.972304, loss_ss: 0.895934, loss_d: 0.076370
0.6899 --- loss: 1.142442, loss_ss: 1.029997, loss_d: 0.112445
0.7282 --- loss: 0.776375, loss_ss: 0.749585, loss_d: 0.026790
0.7666 --- loss: 1.582020, loss_ss: 1.002365, loss_d: 0.579655
0.8049 --- loss: 1.093894, loss_ss: 0.812271, loss_d: 0.281623
0.8432 --- loss: 0.809121, loss_ss: 0.712735, loss_d: 0.096386
0.8816 --- loss: 0.967780, loss_ss: 0.912653, loss_d: 0.055127
0.9199 --- loss: 0.742305, loss_ss: 0.677695, loss_d: 0.064610
0.9582 --- loss: 1.112456, loss_ss: 0.892424, loss_d: 0.220033
0.9966 --- loss: 0.796924, loss_ss: 0.752053, loss_d: 0.044871
Epoch finished! Loss: 1.068340087395448
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.876683, loss_ss: 0.809307, loss_d: 0.067377
0.0383 --- loss: 1.038278, loss_ss: 1.004522, loss_d: 0.033755
0.0767 --- loss: 0.705730, loss_ss: 0.603892, loss_d: 0.101838
0.1150 --- loss: 1.541662, loss_ss: 1.311148, loss_d: 0.230514
0.1533 --- loss: 1.254578, loss_ss: 0.863568, loss_d: 0.391010
0.1916 --- loss: 0.901952, loss_ss: 0.687354, loss_d: 0.214598
0.2300 --- loss: 0.984110, loss_ss: 0.891932, loss_d: 0.092179
0.2683 --- loss: 1.507519, loss_ss: 1.344581, loss_d: 0.162938
0.3066 --- loss: 0.954732, loss_ss: 0.637458, loss_d: 0.317273
0.3450 --- loss: 0.969710, loss_ss: 0.840269, loss_d: 0.129441
0.3833 --- loss: 0.842470, loss_ss: 0.734715, loss_d: 0.107755
0.4216 --- loss: 1.263474, loss_ss: 1.164345, loss_d: 0.099129
0.4599 --- loss: 1.125208, loss_ss: 1.067462, loss_d: 0.057746
0.4983 --- loss: 0.713021, loss_ss: 0.687914, loss_d: 0.025107
0.5366 --- loss: 0.981546, loss_ss: 0.813297, loss_d: 0.168249
0.5749 --- loss: 1.002012, loss_ss: 0.952269, loss_d: 0.049743
0.6133 --- loss: 0.784166, loss_ss: 0.741924, loss_d: 0.042242
0.6516 --- loss: 0.786627, loss_ss: 0.775303, loss_d: 0.011324
0.6899 --- loss: 1.098811, loss_ss: 0.877147, loss_d: 0.221664
0.7282 --- loss: 1.110874, loss_ss: 1.008425, loss_d: 0.102449
0.7666 --- loss: 1.414068, loss_ss: 1.010164, loss_d: 0.403904
0.8049 --- loss: 1.145737, loss_ss: 1.016476, loss_d: 0.129261
0.8432 --- loss: 1.134543, loss_ss: 1.088787, loss_d: 0.045756
0.8816 --- loss: 0.855232, loss_ss: 0.793599, loss_d: 0.061633
0.9199 --- loss: 0.830173, loss_ss: 0.668651, loss_d: 0.161522
0.9582 --- loss: 0.597357, loss_ss: 0.557241, loss_d: 0.040116
0.9966 --- loss: 0.958309, loss_ss: 0.878406, loss_d: 0.079904
Epoch finished! Loss: 1.0046397578257782
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.044375, loss_ss: 1.017629, loss_d: 0.026746
0.0383 --- loss: 0.815231, loss_ss: 0.803120, loss_d: 0.012112
0.0767 --- loss: 1.089501, loss_ss: 0.868362, loss_d: 0.221139
0.1150 --- loss: 1.001272, loss_ss: 0.913683, loss_d: 0.087589
0.1533 --- loss: 1.065992, loss_ss: 0.911908, loss_d: 0.154084
0.1916 --- loss: 0.784813, loss_ss: 0.752927, loss_d: 0.031886
0.2300 --- loss: 1.279305, loss_ss: 0.775582, loss_d: 0.503723
0.2683 --- loss: 0.909279, loss_ss: 0.889685, loss_d: 0.019594
0.3066 --- loss: 0.706609, loss_ss: 0.653088, loss_d: 0.053521
0.3450 --- loss: 0.956328, loss_ss: 0.798334, loss_d: 0.157994
0.3833 --- loss: 0.776637, loss_ss: 0.746640, loss_d: 0.029997
0.4216 --- loss: 1.079485, loss_ss: 0.941010, loss_d: 0.138476
0.4599 --- loss: 1.138036, loss_ss: 1.120716, loss_d: 0.017320
0.4983 --- loss: 0.806475, loss_ss: 0.768940, loss_d: 0.037535
0.5366 --- loss: 0.709400, loss_ss: 0.670018, loss_d: 0.039382
0.5749 --- loss: 0.998890, loss_ss: 0.655175, loss_d: 0.343715
0.6133 --- loss: 0.946650, loss_ss: 0.905296, loss_d: 0.041354
0.6516 --- loss: 0.936997, loss_ss: 0.924803, loss_d: 0.012193
0.6899 --- loss: 1.114404, loss_ss: 1.036268, loss_d: 0.078137
0.7282 --- loss: 1.312833, loss_ss: 0.938192, loss_d: 0.374641
0.7666 --- loss: 0.989511, loss_ss: 0.586750, loss_d: 0.402761
0.8049 --- loss: 0.953982, loss_ss: 0.830118, loss_d: 0.123864
0.8432 --- loss: 1.097389, loss_ss: 1.067493, loss_d: 0.029896
0.8816 --- loss: 0.891538, loss_ss: 0.852201, loss_d: 0.039337
0.9199 --- loss: 1.244527, loss_ss: 1.023068, loss_d: 0.221459
0.9582 --- loss: 1.326373, loss_ss: 1.207515, loss_d: 0.118859
0.9966 --- loss: 0.815574, loss_ss: 0.753397, loss_d: 0.062177
Epoch finished! Loss: 0.9759329392359807
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.222929, loss_ss: 1.123260, loss_d: 0.099669
0.0383 --- loss: 1.277789, loss_ss: 0.760140, loss_d: 0.517649
0.0767 --- loss: 0.901037, loss_ss: 0.869603, loss_d: 0.031434
0.1150 --- loss: 0.612579, loss_ss: 0.601008, loss_d: 0.011571
0.1533 --- loss: 0.904550, loss_ss: 0.741247, loss_d: 0.163303
0.1916 --- loss: 0.880837, loss_ss: 0.776263, loss_d: 0.104574
0.2300 --- loss: 0.922464, loss_ss: 0.793685, loss_d: 0.128779
0.2683 --- loss: 0.845378, loss_ss: 0.789311, loss_d: 0.056067
0.3066 --- loss: 1.003442, loss_ss: 0.842625, loss_d: 0.160817
0.3450 --- loss: 0.726775, loss_ss: 0.723270, loss_d: 0.003505
0.3833 --- loss: 0.887418, loss_ss: 0.877852, loss_d: 0.009566
0.4216 --- loss: 0.782566, loss_ss: 0.760185, loss_d: 0.022380
0.4599 --- loss: 0.784056, loss_ss: 0.733293, loss_d: 0.050763
0.4983 --- loss: 0.624841, loss_ss: 0.595140, loss_d: 0.029702
0.5366 --- loss: 0.989769, loss_ss: 0.962081, loss_d: 0.027688
0.5749 --- loss: 0.843839, loss_ss: 0.833300, loss_d: 0.010540
0.6133 --- loss: 0.841853, loss_ss: 0.660751, loss_d: 0.181102
0.6516 --- loss: 1.213557, loss_ss: 1.175836, loss_d: 0.037721
0.6899 --- loss: 0.846608, loss_ss: 0.799958, loss_d: 0.046650
0.7282 --- loss: 0.777977, loss_ss: 0.740371, loss_d: 0.037606
0.7666 --- loss: 0.954316, loss_ss: 0.839578, loss_d: 0.114738
0.8049 --- loss: 0.817180, loss_ss: 0.809298, loss_d: 0.007883
0.8432 --- loss: 1.043537, loss_ss: 0.986536, loss_d: 0.057001
0.8816 --- loss: 0.977683, loss_ss: 0.608357, loss_d: 0.369326
0.9199 --- loss: 0.989591, loss_ss: 0.919811, loss_d: 0.069780
0.9582 --- loss: 0.583371, loss_ss: 0.536553, loss_d: 0.046818
0.9966 --- loss: 0.923909, loss_ss: 0.734973, loss_d: 0.188936
Epoch finished! Loss: 0.9202983159285325
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.9114942528735632
             precision    recall  f1-score   support

        0.0       0.99      0.97      0.98       154
        1.0       0.56      0.56      0.56        34
        2.0       0.95      0.86      0.91       307
        3.0       0.92      0.97      0.94       168
        4.0       0.85      0.95      0.90       207

avg / total       0.91      0.91      0.91       870
 


====== chc037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  99.43  97.40   99.86  99.34     98.36
1  96.55  55.88   98.21  55.88     55.88
2  93.68  86.32   97.69  95.32     90.60
3  97.82  97.02   98.01  92.09     94.49
4  94.83  94.69   94.87  85.22     89.70
Total accuracy: 91.15%
Average sen: 86.26%
Average spec: 97.73%
Macro f1-score: 85.81%
Diagnosis acc on 15mins: 0.6551724137931034
[1.85600342e-07 1.26973623e-02 1.43042374e-02 3.03541819e-05
 2.54328152e-05 9.45356951e-05 8.54162097e-01 3.49121913e-03
 2.14137312e-04 1.95410494e-02 4.12373126e-01 7.76479304e-01
 3.91350985e-02 1.35733408e-03 3.14814417e-04 3.96144437e-03
 8.60721111e-01 5.30922413e-02 9.76160169e-01 8.10315669e-01
 9.88577008e-01 1.05127290e-01 2.85671979e-01 6.08411338e-03
 8.00563216e-01 8.53889763e-01 9.73932922e-01 9.55369890e-01
 6.60611782e-03]
pred: 0.33842390417658685, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.338650, loss_ss: 1.563735, loss_d: 0.774914
0.0384 --- loss: 1.994973, loss_ss: 1.447276, loss_d: 0.547697
0.0769 --- loss: 1.914620, loss_ss: 1.442731, loss_d: 0.471888
0.1153 --- loss: 2.125186, loss_ss: 1.601260, loss_d: 0.523927
0.1537 --- loss: 2.061723, loss_ss: 1.498294, loss_d: 0.563430
0.1922 --- loss: 2.244697, loss_ss: 1.589422, loss_d: 0.655275
0.2306 --- loss: 1.989258, loss_ss: 1.481987, loss_d: 0.507271
0.2690 --- loss: 2.153862, loss_ss: 1.530322, loss_d: 0.623540
0.3075 --- loss: 2.022861, loss_ss: 1.319909, loss_d: 0.702952
0.3459 --- loss: 2.285058, loss_ss: 1.539286, loss_d: 0.745772
0.3843 --- loss: 1.849344, loss_ss: 1.499755, loss_d: 0.349590
0.4228 --- loss: 1.688754, loss_ss: 1.400898, loss_d: 0.287856
0.4612 --- loss: 2.229923, loss_ss: 1.343704, loss_d: 0.886220
0.4996 --- loss: 1.790994, loss_ss: 1.361331, loss_d: 0.429663
0.5380 --- loss: 1.876096, loss_ss: 1.348619, loss_d: 0.527477
0.5765 --- loss: 1.953374, loss_ss: 1.528147, loss_d: 0.425228
0.6149 --- loss: 1.675339, loss_ss: 1.257888, loss_d: 0.417451
0.6533 --- loss: 1.905821, loss_ss: 1.264515, loss_d: 0.641306
0.6918 --- loss: 1.965182, loss_ss: 1.508637, loss_d: 0.456544
0.7302 --- loss: 1.507650, loss_ss: 1.246242, loss_d: 0.261408
0.7686 --- loss: 1.552121, loss_ss: 1.210071, loss_d: 0.342051
0.8071 --- loss: 1.685772, loss_ss: 1.419237, loss_d: 0.266535
0.8455 --- loss: 2.096244, loss_ss: 1.265526, loss_d: 0.830718
0.8839 --- loss: 1.820021, loss_ss: 1.367878, loss_d: 0.452142
0.9224 --- loss: 2.021127, loss_ss: 1.279811, loss_d: 0.741316
0.9608 --- loss: 1.474683, loss_ss: 1.087297, loss_d: 0.387387
0.9992 --- loss: 2.855410, loss_ss: 1.352512, loss_d: 1.502899
Epoch finished! Loss: 1.9578422670180982
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.379636, loss_ss: 1.272773, loss_d: 1.106863
0.0384 --- loss: 1.707491, loss_ss: 1.378923, loss_d: 0.328568
0.0769 --- loss: 1.468604, loss_ss: 1.037159, loss_d: 0.431445
0.1153 --- loss: 1.536413, loss_ss: 1.419873, loss_d: 0.116540
0.1537 --- loss: 1.836516, loss_ss: 1.712222, loss_d: 0.124295
0.1922 --- loss: 1.632067, loss_ss: 1.055012, loss_d: 0.577056
0.2306 --- loss: 1.692683, loss_ss: 1.197749, loss_d: 0.494934
0.2690 --- loss: 1.897453, loss_ss: 1.302357, loss_d: 0.595095
0.3075 --- loss: 1.743349, loss_ss: 1.494160, loss_d: 0.249189
0.3459 --- loss: 1.316796, loss_ss: 1.066897, loss_d: 0.249899
0.3843 --- loss: 1.618564, loss_ss: 0.982921, loss_d: 0.635643
0.4228 --- loss: 1.822100, loss_ss: 1.553650, loss_d: 0.268451
0.4612 --- loss: 1.512816, loss_ss: 1.269926, loss_d: 0.242890
0.4996 --- loss: 1.315651, loss_ss: 1.167249, loss_d: 0.148401
0.5380 --- loss: 1.810567, loss_ss: 1.368074, loss_d: 0.442493
0.5765 --- loss: 1.656596, loss_ss: 1.141825, loss_d: 0.514771
0.6149 --- loss: 1.982267, loss_ss: 1.411291, loss_d: 0.570976
0.6533 --- loss: 1.569688, loss_ss: 1.128440, loss_d: 0.441248
0.6918 --- loss: 1.400350, loss_ss: 1.127833, loss_d: 0.272517
0.7302 --- loss: 1.540308, loss_ss: 1.373221, loss_d: 0.167087
0.7686 --- loss: 1.355000, loss_ss: 1.132190, loss_d: 0.222810
0.8071 --- loss: 1.520369, loss_ss: 1.353303, loss_d: 0.167066
0.8455 --- loss: 1.192055, loss_ss: 0.961852, loss_d: 0.230203
0.8839 --- loss: 1.351976, loss_ss: 1.141572, loss_d: 0.210404
0.9224 --- loss: 1.199803, loss_ss: 0.903576, loss_d: 0.296227
0.9608 --- loss: 1.214192, loss_ss: 0.884149, loss_d: 0.330043
0.9992 --- loss: 5.718013, loss_ss: 1.745228, loss_d: 3.972785
Epoch finished! Loss: 1.5667016272361463
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.253289, loss_ss: 1.172932, loss_d: 0.080357
0.0384 --- loss: 1.247176, loss_ss: 0.830671, loss_d: 0.416504
0.0769 --- loss: 1.203553, loss_ss: 0.967336, loss_d: 0.236217
0.1153 --- loss: 1.375365, loss_ss: 1.086423, loss_d: 0.288941
0.1537 --- loss: 1.875900, loss_ss: 1.017861, loss_d: 0.858040
0.1922 --- loss: 1.609750, loss_ss: 1.042615, loss_d: 0.567135
0.2306 --- loss: 1.280554, loss_ss: 1.077982, loss_d: 0.202572
0.2690 --- loss: 1.542577, loss_ss: 1.093101, loss_d: 0.449476
0.3075 --- loss: 1.189879, loss_ss: 0.959237, loss_d: 0.230643
0.3459 --- loss: 1.439207, loss_ss: 0.974879, loss_d: 0.464327
0.3843 --- loss: 1.303388, loss_ss: 0.932777, loss_d: 0.370611
0.4228 --- loss: 1.615188, loss_ss: 1.376674, loss_d: 0.238514
0.4612 --- loss: 1.299613, loss_ss: 0.885430, loss_d: 0.414183
0.4996 --- loss: 1.583980, loss_ss: 1.181936, loss_d: 0.402044
0.5380 --- loss: 1.205059, loss_ss: 0.838392, loss_d: 0.366667
0.5765 --- loss: 1.027591, loss_ss: 0.830993, loss_d: 0.196599
0.6149 --- loss: 1.611152, loss_ss: 1.203068, loss_d: 0.408084
0.6533 --- loss: 1.237061, loss_ss: 0.851008, loss_d: 0.386053
0.6918 --- loss: 1.458073, loss_ss: 1.240447, loss_d: 0.217625
0.7302 --- loss: 1.064804, loss_ss: 0.929237, loss_d: 0.135566
0.7686 --- loss: 1.171999, loss_ss: 1.104781, loss_d: 0.067218
0.8071 --- loss: 1.522153, loss_ss: 1.161161, loss_d: 0.360993
0.8455 --- loss: 1.647931, loss_ss: 1.207081, loss_d: 0.440850
0.8839 --- loss: 1.588409, loss_ss: 1.343459, loss_d: 0.244950
0.9224 --- loss: 1.441024, loss_ss: 1.364863, loss_d: 0.076162
0.9608 --- loss: 1.138358, loss_ss: 0.881758, loss_d: 0.256600
0.9992 --- loss: 1.754361, loss_ss: 1.628213, loss_d: 0.126148
Epoch finished! Loss: 1.3503003012675505
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.309397, loss_ss: 1.142027, loss_d: 0.167370
0.0384 --- loss: 1.180693, loss_ss: 0.968301, loss_d: 0.212393
0.0769 --- loss: 1.315118, loss_ss: 0.937004, loss_d: 0.378114
0.1153 --- loss: 1.202575, loss_ss: 0.845914, loss_d: 0.356661
0.1537 --- loss: 1.605110, loss_ss: 1.388298, loss_d: 0.216812
0.1922 --- loss: 1.409353, loss_ss: 1.123924, loss_d: 0.285429
0.2306 --- loss: 1.015865, loss_ss: 0.791568, loss_d: 0.224297
0.2690 --- loss: 1.328957, loss_ss: 1.039020, loss_d: 0.289937
0.3075 --- loss: 1.020971, loss_ss: 0.908938, loss_d: 0.112033
0.3459 --- loss: 1.245344, loss_ss: 0.676110, loss_d: 0.569234
0.3843 --- loss: 2.128299, loss_ss: 1.328961, loss_d: 0.799337
0.4228 --- loss: 0.937916, loss_ss: 0.778494, loss_d: 0.159423
0.4612 --- loss: 1.408256, loss_ss: 1.241508, loss_d: 0.166748
0.4996 --- loss: 1.309093, loss_ss: 1.035338, loss_d: 0.273755
0.5380 --- loss: 1.111537, loss_ss: 0.926472, loss_d: 0.185065
0.5765 --- loss: 0.862400, loss_ss: 0.697062, loss_d: 0.165338
0.6149 --- loss: 1.317381, loss_ss: 1.065782, loss_d: 0.251599
0.6533 --- loss: 0.871442, loss_ss: 0.771511, loss_d: 0.099931
0.6918 --- loss: 1.414324, loss_ss: 1.093594, loss_d: 0.320729
0.7302 --- loss: 0.971636, loss_ss: 0.842889, loss_d: 0.128746
0.7686 --- loss: 1.123705, loss_ss: 1.046360, loss_d: 0.077345
0.8071 --- loss: 1.301112, loss_ss: 0.939491, loss_d: 0.361621
0.8455 --- loss: 0.766122, loss_ss: 0.671449, loss_d: 0.094674
0.8839 --- loss: 1.341066, loss_ss: 1.311693, loss_d: 0.029373
0.9224 --- loss: 1.323400, loss_ss: 1.227346, loss_d: 0.096054
0.9608 --- loss: 1.156763, loss_ss: 1.068693, loss_d: 0.088070
0.9992 --- loss: 3.648528, loss_ss: 1.516665, loss_d: 2.131863
Epoch finished! Loss: 1.2401644961192058
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.385678, loss_ss: 0.783434, loss_d: 0.602244
0.0384 --- loss: 0.947719, loss_ss: 0.783433, loss_d: 0.164286
0.0769 --- loss: 0.734150, loss_ss: 0.642896, loss_d: 0.091254
0.1153 --- loss: 1.213681, loss_ss: 0.815657, loss_d: 0.398024
0.1537 --- loss: 1.025702, loss_ss: 0.971404, loss_d: 0.054298
0.1922 --- loss: 1.571618, loss_ss: 0.908110, loss_d: 0.663509
0.2306 --- loss: 1.092638, loss_ss: 0.953254, loss_d: 0.139385
0.2690 --- loss: 1.082497, loss_ss: 0.903841, loss_d: 0.178656
0.3075 --- loss: 1.441769, loss_ss: 1.086221, loss_d: 0.355548
0.3459 --- loss: 1.142269, loss_ss: 0.858140, loss_d: 0.284129
0.3843 --- loss: 1.401489, loss_ss: 0.831275, loss_d: 0.570213
0.4228 --- loss: 1.082658, loss_ss: 0.831709, loss_d: 0.250949
0.4612 --- loss: 1.317214, loss_ss: 1.024522, loss_d: 0.292692
0.4996 --- loss: 1.286455, loss_ss: 0.823097, loss_d: 0.463358
0.5380 --- loss: 1.378804, loss_ss: 1.309923, loss_d: 0.068881
0.5765 --- loss: 1.311100, loss_ss: 1.227263, loss_d: 0.083837
0.6149 --- loss: 0.932039, loss_ss: 0.842630, loss_d: 0.089409
0.6533 --- loss: 1.863860, loss_ss: 1.489408, loss_d: 0.374452
0.6918 --- loss: 1.135092, loss_ss: 0.903496, loss_d: 0.231596
0.7302 --- loss: 1.199509, loss_ss: 1.121852, loss_d: 0.077657
0.7686 --- loss: 0.871528, loss_ss: 0.730314, loss_d: 0.141214
0.8071 --- loss: 0.834360, loss_ss: 0.766241, loss_d: 0.068119
0.8455 --- loss: 1.258754, loss_ss: 1.030205, loss_d: 0.228549
0.8839 --- loss: 1.032795, loss_ss: 0.825735, loss_d: 0.207060
0.9224 --- loss: 1.300385, loss_ss: 0.930099, loss_d: 0.370285
0.9608 --- loss: 0.966496, loss_ss: 0.819204, loss_d: 0.147292
0.9992 --- loss: 4.874196, loss_ss: 2.338733, loss_d: 2.535462
Epoch finished! Loss: 1.1672718579952532
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.095348, loss_ss: 0.927317, loss_d: 0.168031
0.0384 --- loss: 0.983835, loss_ss: 0.786067, loss_d: 0.197768
0.0769 --- loss: 1.223847, loss_ss: 0.895203, loss_d: 0.328644
0.1153 --- loss: 1.523083, loss_ss: 1.488063, loss_d: 0.035021
0.1537 --- loss: 1.294504, loss_ss: 1.098892, loss_d: 0.195611
0.1922 --- loss: 0.895461, loss_ss: 0.867939, loss_d: 0.027522
0.2306 --- loss: 0.916317, loss_ss: 0.822335, loss_d: 0.093981
0.2690 --- loss: 0.864630, loss_ss: 0.849515, loss_d: 0.015115
0.3075 --- loss: 0.840618, loss_ss: 0.669873, loss_d: 0.170745
0.3459 --- loss: 0.751486, loss_ss: 0.673197, loss_d: 0.078289
0.3843 --- loss: 1.081044, loss_ss: 0.741962, loss_d: 0.339082
0.4228 --- loss: 1.190947, loss_ss: 0.996877, loss_d: 0.194071
0.4612 --- loss: 1.284770, loss_ss: 1.171826, loss_d: 0.112944
0.4996 --- loss: 0.933526, loss_ss: 0.741802, loss_d: 0.191724
0.5380 --- loss: 0.721647, loss_ss: 0.684481, loss_d: 0.037166
0.5765 --- loss: 0.962056, loss_ss: 0.910908, loss_d: 0.051148
0.6149 --- loss: 1.039341, loss_ss: 0.943387, loss_d: 0.095953
0.6533 --- loss: 0.973638, loss_ss: 0.823769, loss_d: 0.149869
0.6918 --- loss: 1.307302, loss_ss: 1.111369, loss_d: 0.195933
0.7302 --- loss: 0.882824, loss_ss: 0.714558, loss_d: 0.168266
0.7686 --- loss: 1.420992, loss_ss: 1.152952, loss_d: 0.268040
0.8071 --- loss: 1.332984, loss_ss: 0.861515, loss_d: 0.471469
0.8455 --- loss: 1.273756, loss_ss: 1.223679, loss_d: 0.050077
0.8839 --- loss: 0.882290, loss_ss: 0.860372, loss_d: 0.021918
0.9224 --- loss: 1.113758, loss_ss: 1.065422, loss_d: 0.048337
0.9608 --- loss: 0.845731, loss_ss: 0.801701, loss_d: 0.044030
0.9992 --- loss: 1.580128, loss_ss: 1.574385, loss_d: 0.005743
Epoch finished! Loss: 1.0961335649857153
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.834665, loss_ss: 0.793890, loss_d: 0.040775
0.0384 --- loss: 1.176345, loss_ss: 1.029993, loss_d: 0.146352
0.0769 --- loss: 1.221146, loss_ss: 0.901207, loss_d: 0.319939
0.1153 --- loss: 1.147896, loss_ss: 1.117619, loss_d: 0.030277
0.1537 --- loss: 0.934684, loss_ss: 0.856554, loss_d: 0.078129
0.1922 --- loss: 1.139697, loss_ss: 1.086596, loss_d: 0.053100
0.2306 --- loss: 1.152871, loss_ss: 1.107021, loss_d: 0.045850
0.2690 --- loss: 1.051651, loss_ss: 0.907394, loss_d: 0.144257
0.3075 --- loss: 0.766648, loss_ss: 0.688099, loss_d: 0.078549
0.3459 --- loss: 0.811490, loss_ss: 0.753934, loss_d: 0.057557
0.3843 --- loss: 1.132525, loss_ss: 0.988864, loss_d: 0.143661
0.4228 --- loss: 1.132777, loss_ss: 0.736694, loss_d: 0.396083
0.4612 --- loss: 0.946807, loss_ss: 0.882688, loss_d: 0.064118
0.4996 --- loss: 0.932563, loss_ss: 0.892541, loss_d: 0.040022
0.5380 --- loss: 0.722208, loss_ss: 0.686519, loss_d: 0.035689
0.5765 --- loss: 1.028462, loss_ss: 0.965799, loss_d: 0.062662
0.6149 --- loss: 1.226290, loss_ss: 1.198699, loss_d: 0.027591
0.6533 --- loss: 1.300237, loss_ss: 1.084664, loss_d: 0.215573
0.6918 --- loss: 0.751297, loss_ss: 0.720736, loss_d: 0.030560
0.7302 --- loss: 0.814723, loss_ss: 0.796106, loss_d: 0.018618
0.7686 --- loss: 0.817916, loss_ss: 0.678003, loss_d: 0.139913
0.8071 --- loss: 1.132943, loss_ss: 0.932496, loss_d: 0.200447
0.8455 --- loss: 0.921245, loss_ss: 0.811815, loss_d: 0.109430
0.8839 --- loss: 0.682371, loss_ss: 0.648822, loss_d: 0.033549
0.9224 --- loss: 0.864493, loss_ss: 0.627328, loss_d: 0.237165
0.9608 --- loss: 0.906338, loss_ss: 0.756117, loss_d: 0.150221
0.9992 --- loss: 1.054985, loss_ss: 1.048970, loss_d: 0.006015
Epoch finished! Loss: 1.053489420734919
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.015913, loss_ss: 0.950165, loss_d: 0.065748
0.0384 --- loss: 1.187991, loss_ss: 1.107158, loss_d: 0.080833
0.0769 --- loss: 0.969959, loss_ss: 0.804861, loss_d: 0.165098
0.1153 --- loss: 1.266658, loss_ss: 1.157121, loss_d: 0.109538
0.1537 --- loss: 1.041318, loss_ss: 0.962777, loss_d: 0.078541
0.1922 --- loss: 0.859557, loss_ss: 0.773515, loss_d: 0.086041
0.2306 --- loss: 0.902258, loss_ss: 0.881849, loss_d: 0.020409
0.2690 --- loss: 0.973468, loss_ss: 0.940686, loss_d: 0.032781
0.3075 --- loss: 1.061718, loss_ss: 0.788798, loss_d: 0.272920
0.3459 --- loss: 1.905122, loss_ss: 0.885799, loss_d: 1.019322
0.3843 --- loss: 0.864766, loss_ss: 0.757514, loss_d: 0.107251
0.4228 --- loss: 0.936089, loss_ss: 0.880295, loss_d: 0.055794
0.4612 --- loss: 0.866759, loss_ss: 0.820856, loss_d: 0.045903
0.4996 --- loss: 1.157037, loss_ss: 0.975949, loss_d: 0.181088
0.5380 --- loss: 0.987005, loss_ss: 0.647685, loss_d: 0.339320
0.5765 --- loss: 1.404686, loss_ss: 1.038072, loss_d: 0.366614
0.6149 --- loss: 0.818643, loss_ss: 0.715615, loss_d: 0.103027
0.6533 --- loss: 1.129116, loss_ss: 0.959830, loss_d: 0.169286
0.6918 --- loss: 1.004079, loss_ss: 0.832652, loss_d: 0.171428
0.7302 --- loss: 0.911357, loss_ss: 0.860935, loss_d: 0.050422
0.7686 --- loss: 0.786052, loss_ss: 0.747087, loss_d: 0.038964
0.8071 --- loss: 0.776607, loss_ss: 0.765858, loss_d: 0.010749
0.8455 --- loss: 1.681104, loss_ss: 0.973799, loss_d: 0.707305
0.8839 --- loss: 0.681256, loss_ss: 0.647533, loss_d: 0.033722
0.9224 --- loss: 1.044697, loss_ss: 0.898452, loss_d: 0.146245
0.9608 --- loss: 1.162932, loss_ss: 0.966168, loss_d: 0.196764
0.9992 --- loss: 2.616851, loss_ss: 2.613081, loss_d: 0.003771
Epoch finished! Loss: 1.027123358616462
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.011728, loss_ss: 0.681512, loss_d: 0.330216
0.0384 --- loss: 0.935080, loss_ss: 0.775959, loss_d: 0.159121
0.0769 --- loss: 1.303192, loss_ss: 1.127166, loss_d: 0.176027
0.1153 --- loss: 0.926151, loss_ss: 0.886656, loss_d: 0.039494
0.1537 --- loss: 0.978502, loss_ss: 0.943772, loss_d: 0.034730
0.1922 --- loss: 1.035856, loss_ss: 1.028858, loss_d: 0.006998
0.2306 --- loss: 0.805048, loss_ss: 0.791305, loss_d: 0.013742
0.2690 --- loss: 0.643598, loss_ss: 0.619901, loss_d: 0.023697
0.3075 --- loss: 0.878059, loss_ss: 0.812088, loss_d: 0.065971
0.3459 --- loss: 1.361859, loss_ss: 0.810567, loss_d: 0.551292
0.3843 --- loss: 0.830996, loss_ss: 0.801379, loss_d: 0.029617
0.4228 --- loss: 1.128472, loss_ss: 1.015999, loss_d: 0.112473
0.4612 --- loss: 1.072440, loss_ss: 0.993666, loss_d: 0.078774
0.4996 --- loss: 1.019679, loss_ss: 0.905174, loss_d: 0.114505
0.5380 --- loss: 0.989263, loss_ss: 0.765128, loss_d: 0.224136
0.5765 --- loss: 1.011051, loss_ss: 1.007422, loss_d: 0.003629
0.6149 --- loss: 0.851700, loss_ss: 0.823857, loss_d: 0.027844
0.6533 --- loss: 0.924341, loss_ss: 0.912595, loss_d: 0.011746
0.6918 --- loss: 0.720680, loss_ss: 0.697688, loss_d: 0.022992
0.7302 --- loss: 1.002240, loss_ss: 0.998791, loss_d: 0.003449
0.7686 --- loss: 0.974606, loss_ss: 0.906465, loss_d: 0.068141
0.8071 --- loss: 0.794983, loss_ss: 0.789545, loss_d: 0.005438
0.8455 --- loss: 0.761296, loss_ss: 0.736884, loss_d: 0.024412
0.8839 --- loss: 0.871681, loss_ss: 0.657575, loss_d: 0.214106
0.9224 --- loss: 0.854310, loss_ss: 0.775951, loss_d: 0.078358
0.9608 --- loss: 0.927817, loss_ss: 0.882990, loss_d: 0.044827
0.9992 --- loss: 3.806874, loss_ss: 1.280178, loss_d: 2.526696
Epoch finished! Loss: 0.9594875929447321
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.964341, loss_ss: 0.769484, loss_d: 0.194857
0.0384 --- loss: 0.836672, loss_ss: 0.802453, loss_d: 0.034219
0.0769 --- loss: 0.683351, loss_ss: 0.620773, loss_d: 0.062578
0.1153 --- loss: 0.655121, loss_ss: 0.604923, loss_d: 0.050198
0.1537 --- loss: 0.839504, loss_ss: 0.820372, loss_d: 0.019132
0.1922 --- loss: 1.027542, loss_ss: 0.668422, loss_d: 0.359121
0.2306 --- loss: 0.794444, loss_ss: 0.736658, loss_d: 0.057786
0.2690 --- loss: 1.184389, loss_ss: 1.131529, loss_d: 0.052860
0.3075 --- loss: 1.655278, loss_ss: 1.225586, loss_d: 0.429692
0.3459 --- loss: 0.713568, loss_ss: 0.679740, loss_d: 0.033828
0.3843 --- loss: 0.954634, loss_ss: 0.888462, loss_d: 0.066173
0.4228 --- loss: 0.678735, loss_ss: 0.605776, loss_d: 0.072959
0.4612 --- loss: 1.116236, loss_ss: 1.106480, loss_d: 0.009756
0.4996 --- loss: 0.931156, loss_ss: 0.909442, loss_d: 0.021714
0.5380 --- loss: 0.942956, loss_ss: 0.874793, loss_d: 0.068163
0.5765 --- loss: 1.130126, loss_ss: 1.107286, loss_d: 0.022840
0.6149 --- loss: 0.895841, loss_ss: 0.874982, loss_d: 0.020859
0.6533 --- loss: 0.726482, loss_ss: 0.708703, loss_d: 0.017779
0.6918 --- loss: 0.937423, loss_ss: 0.922216, loss_d: 0.015207
0.7302 --- loss: 0.795983, loss_ss: 0.784568, loss_d: 0.011415
0.7686 --- loss: 0.873194, loss_ss: 0.849917, loss_d: 0.023277
0.8071 --- loss: 1.314498, loss_ss: 1.268889, loss_d: 0.045609
0.8455 --- loss: 0.929153, loss_ss: 0.916112, loss_d: 0.013041
0.8839 --- loss: 1.051943, loss_ss: 0.916432, loss_d: 0.135511
0.9224 --- loss: 0.566933, loss_ss: 0.425497, loss_d: 0.141435
0.9608 --- loss: 0.898295, loss_ss: 0.806114, loss_d: 0.092181
0.9992 --- loss: 4.565312, loss_ss: 2.163684, loss_d: 2.401628
Epoch finished! Loss: 0.9977240113111643
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7138888888888889
             precision    recall  f1-score   support

        0.0       0.93      0.58      0.72       185
        1.0       0.33      0.62      0.43        50
        2.0       0.68      0.96      0.80       483
        3.0       1.00      0.27      0.42       216
        4.0       0.86      0.74      0.80       146

avg / total       0.80      0.71      0.69      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.13  58.38   99.11   93.10     71.76
1  92.31  62.00   93.79   32.63     42.76
2  78.06  96.48   63.15   67.93     79.73
3  85.37  26.85  100.00  100.00     42.34
4  94.91  73.97   98.18   86.40     79.70
Total accuracy: 71.39%
Average sen: 63.54%
Average spec: 90.84%
Macro f1-score: 63.26%
Diagnosis acc on 15mins: 1.0
[0.00441951 0.00124254 0.01007972 0.035557   0.00694215 0.0069702
 0.004254   0.07283409 0.05168473 0.05377045 0.02363807 0.01788256
 0.06370097 0.34864745 0.31385022 0.00554449 0.00330917 0.10118894
 0.14728461 0.07484321 0.01654089 0.01092618 0.00518284 0.01103608
 0.00494051 0.01843133 0.00807942 0.00433806 0.03805765 0.07447655
 0.09335709 0.19128852 0.01709875 0.0396742  0.0046702  0.01586825]
pred: 0.05282251662639384, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.444107, loss_ss: 1.766219, loss_d: 0.677888
0.0383 --- loss: 2.379290, loss_ss: 1.752325, loss_d: 0.626965
0.0766 --- loss: 2.000323, loss_ss: 1.491482, loss_d: 0.508841
0.1149 --- loss: 2.311306, loss_ss: 1.776878, loss_d: 0.534428
0.1533 --- loss: 1.865758, loss_ss: 1.539581, loss_d: 0.326177
0.1916 --- loss: 2.266869, loss_ss: 1.498250, loss_d: 0.768618
0.2299 --- loss: 2.154759, loss_ss: 1.560712, loss_d: 0.594047
0.2682 --- loss: 1.842311, loss_ss: 1.344704, loss_d: 0.497606
0.3065 --- loss: 2.157755, loss_ss: 1.555774, loss_d: 0.601981
0.3448 --- loss: 2.087252, loss_ss: 1.539252, loss_d: 0.547999
0.3831 --- loss: 2.207353, loss_ss: 1.527798, loss_d: 0.679555
0.4215 --- loss: 2.025141, loss_ss: 1.391176, loss_d: 0.633964
0.4598 --- loss: 1.703675, loss_ss: 1.219059, loss_d: 0.484616
0.4981 --- loss: 2.308289, loss_ss: 1.406749, loss_d: 0.901539
0.5364 --- loss: 1.784098, loss_ss: 1.251640, loss_d: 0.532458
0.5747 --- loss: 1.818736, loss_ss: 1.286203, loss_d: 0.532532
0.6130 --- loss: 1.991526, loss_ss: 1.389715, loss_d: 0.601811
0.6513 --- loss: 2.331742, loss_ss: 1.459353, loss_d: 0.872389
0.6897 --- loss: 1.769413, loss_ss: 1.290770, loss_d: 0.478643
0.7280 --- loss: 1.953510, loss_ss: 1.248795, loss_d: 0.704714
0.7663 --- loss: 1.814672, loss_ss: 1.410560, loss_d: 0.404112
0.8046 --- loss: 1.593074, loss_ss: 1.212634, loss_d: 0.380440
0.8429 --- loss: 1.392044, loss_ss: 1.035367, loss_d: 0.356677
0.8812 --- loss: 1.579216, loss_ss: 1.275636, loss_d: 0.303581
0.9195 --- loss: 1.816910, loss_ss: 1.387577, loss_d: 0.429333
0.9579 --- loss: 1.937881, loss_ss: 1.222700, loss_d: 0.715181
0.9962 --- loss: 1.614789, loss_ss: 1.133183, loss_d: 0.481606
Epoch finished! Loss: 1.952686427648251
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.683650, loss_ss: 1.094852, loss_d: 0.588798
0.0383 --- loss: 1.438393, loss_ss: 1.064544, loss_d: 0.373849
0.0766 --- loss: 1.451050, loss_ss: 1.149124, loss_d: 0.301927
0.1149 --- loss: 1.579096, loss_ss: 1.259833, loss_d: 0.319264
0.1533 --- loss: 1.691377, loss_ss: 1.246874, loss_d: 0.444503
0.1916 --- loss: 2.253442, loss_ss: 1.584228, loss_d: 0.669214
0.2299 --- loss: 1.981473, loss_ss: 1.213322, loss_d: 0.768150
0.2682 --- loss: 1.420693, loss_ss: 1.005116, loss_d: 0.415577
0.3065 --- loss: 1.252439, loss_ss: 1.119325, loss_d: 0.133115
0.3448 --- loss: 1.737036, loss_ss: 1.142584, loss_d: 0.594452
0.3831 --- loss: 1.311436, loss_ss: 1.069288, loss_d: 0.242148
0.4215 --- loss: 1.467319, loss_ss: 1.195964, loss_d: 0.271355
0.4598 --- loss: 1.494641, loss_ss: 1.100893, loss_d: 0.393748
0.4981 --- loss: 1.558196, loss_ss: 1.024548, loss_d: 0.533648
0.5364 --- loss: 1.212954, loss_ss: 1.108794, loss_d: 0.104159
0.5747 --- loss: 1.486940, loss_ss: 1.118289, loss_d: 0.368651
0.6130 --- loss: 1.899224, loss_ss: 1.109778, loss_d: 0.789446
0.6513 --- loss: 1.066947, loss_ss: 0.939670, loss_d: 0.127277
0.6897 --- loss: 1.463282, loss_ss: 1.201344, loss_d: 0.261938
0.7280 --- loss: 1.236204, loss_ss: 0.981313, loss_d: 0.254891
0.7663 --- loss: 1.134026, loss_ss: 1.054219, loss_d: 0.079807
0.8046 --- loss: 1.256928, loss_ss: 0.993824, loss_d: 0.263104
0.8429 --- loss: 1.107364, loss_ss: 1.019463, loss_d: 0.087901
0.8812 --- loss: 1.346007, loss_ss: 1.135596, loss_d: 0.210411
0.9195 --- loss: 1.364835, loss_ss: 1.174216, loss_d: 0.190619
0.9579 --- loss: 1.482696, loss_ss: 1.122261, loss_d: 0.360435
0.9962 --- loss: 1.218805, loss_ss: 1.051450, loss_d: 0.167355
Epoch finished! Loss: 1.4950578900483937
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.520600, loss_ss: 1.191239, loss_d: 0.329361
0.0383 --- loss: 1.612479, loss_ss: 1.148402, loss_d: 0.464077
0.0766 --- loss: 1.099603, loss_ss: 0.925179, loss_d: 0.174424
0.1149 --- loss: 1.329074, loss_ss: 1.126594, loss_d: 0.202480
0.1533 --- loss: 1.230568, loss_ss: 1.027550, loss_d: 0.203018
0.1916 --- loss: 1.147146, loss_ss: 1.060672, loss_d: 0.086474
0.2299 --- loss: 1.280726, loss_ss: 1.140651, loss_d: 0.140075
0.2682 --- loss: 1.364668, loss_ss: 1.095654, loss_d: 0.269014
0.3065 --- loss: 1.310202, loss_ss: 1.031805, loss_d: 0.278397
0.3448 --- loss: 1.152151, loss_ss: 1.075519, loss_d: 0.076632
0.3831 --- loss: 1.154645, loss_ss: 0.918433, loss_d: 0.236212
0.4215 --- loss: 1.510306, loss_ss: 1.168205, loss_d: 0.342100
0.4598 --- loss: 0.951515, loss_ss: 0.875456, loss_d: 0.076059
0.4981 --- loss: 1.327999, loss_ss: 1.113404, loss_d: 0.214595
0.5364 --- loss: 1.431778, loss_ss: 1.012804, loss_d: 0.418974
0.5747 --- loss: 1.036541, loss_ss: 0.810074, loss_d: 0.226467
0.6130 --- loss: 1.520225, loss_ss: 1.304753, loss_d: 0.215473
0.6513 --- loss: 1.745863, loss_ss: 1.048439, loss_d: 0.697424
0.6897 --- loss: 1.487540, loss_ss: 1.039562, loss_d: 0.447978
0.7280 --- loss: 1.627405, loss_ss: 0.932436, loss_d: 0.694970
0.7663 --- loss: 1.265284, loss_ss: 0.988361, loss_d: 0.276923
0.8046 --- loss: 1.249776, loss_ss: 1.177553, loss_d: 0.072223
0.8429 --- loss: 1.757668, loss_ss: 0.807604, loss_d: 0.950063
0.8812 --- loss: 1.086742, loss_ss: 0.949599, loss_d: 0.137143
0.9195 --- loss: 1.136602, loss_ss: 1.004028, loss_d: 0.132574
0.9579 --- loss: 1.061672, loss_ss: 0.793327, loss_d: 0.268345
0.9962 --- loss: 1.208961, loss_ss: 0.953180, loss_d: 0.255782
Epoch finished! Loss: 1.3423959230001157
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.328971, loss_ss: 1.092776, loss_d: 0.236195
0.0383 --- loss: 1.024595, loss_ss: 0.835336, loss_d: 0.189259
0.0766 --- loss: 1.067665, loss_ss: 0.996980, loss_d: 0.070686
0.1149 --- loss: 1.103722, loss_ss: 1.016309, loss_d: 0.087413
0.1533 --- loss: 1.376973, loss_ss: 1.012735, loss_d: 0.364238
0.1916 --- loss: 1.826357, loss_ss: 1.273851, loss_d: 0.552506
0.2299 --- loss: 1.331171, loss_ss: 0.970661, loss_d: 0.360510
0.2682 --- loss: 1.140298, loss_ss: 0.955279, loss_d: 0.185019
0.3065 --- loss: 1.173464, loss_ss: 1.012207, loss_d: 0.161257
0.3448 --- loss: 1.263575, loss_ss: 1.080114, loss_d: 0.183461
0.3831 --- loss: 1.164772, loss_ss: 0.915509, loss_d: 0.249263
0.4215 --- loss: 1.368212, loss_ss: 1.209222, loss_d: 0.158989
0.4598 --- loss: 1.127403, loss_ss: 1.073096, loss_d: 0.054308
0.4981 --- loss: 1.082881, loss_ss: 0.947702, loss_d: 0.135179
0.5364 --- loss: 1.257943, loss_ss: 1.097259, loss_d: 0.160683
0.5747 --- loss: 1.111401, loss_ss: 0.876734, loss_d: 0.234667
0.6130 --- loss: 1.128068, loss_ss: 0.943298, loss_d: 0.184769
0.6513 --- loss: 1.244881, loss_ss: 1.036257, loss_d: 0.208624
0.6897 --- loss: 1.074150, loss_ss: 0.933201, loss_d: 0.140949
0.7280 --- loss: 1.418891, loss_ss: 0.899914, loss_d: 0.518977
0.7663 --- loss: 0.870685, loss_ss: 0.745878, loss_d: 0.124808
0.8046 --- loss: 0.944310, loss_ss: 0.888857, loss_d: 0.055453
0.8429 --- loss: 1.244587, loss_ss: 0.997721, loss_d: 0.246865
0.8812 --- loss: 1.227083, loss_ss: 0.815032, loss_d: 0.412051
0.9195 --- loss: 1.331121, loss_ss: 1.072652, loss_d: 0.258468
0.9579 --- loss: 0.920846, loss_ss: 0.849326, loss_d: 0.071520
0.9962 --- loss: 1.089688, loss_ss: 0.970189, loss_d: 0.119500
Epoch finished! Loss: 1.221547864492123
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.082719, loss_ss: 0.911440, loss_d: 0.171280
0.0383 --- loss: 1.412418, loss_ss: 0.844493, loss_d: 0.567925
0.0766 --- loss: 1.241321, loss_ss: 1.192255, loss_d: 0.049066
0.1149 --- loss: 1.076141, loss_ss: 0.858070, loss_d: 0.218070
0.1533 --- loss: 1.153254, loss_ss: 0.963609, loss_d: 0.189645
0.1916 --- loss: 1.234664, loss_ss: 0.982625, loss_d: 0.252039
0.2299 --- loss: 0.997993, loss_ss: 0.916804, loss_d: 0.081189
0.2682 --- loss: 1.102621, loss_ss: 0.865403, loss_d: 0.237218
0.3065 --- loss: 1.075347, loss_ss: 0.952706, loss_d: 0.122642
0.3448 --- loss: 1.131303, loss_ss: 0.897046, loss_d: 0.234257
0.3831 --- loss: 1.106710, loss_ss: 0.937290, loss_d: 0.169420
0.4215 --- loss: 1.189339, loss_ss: 0.769238, loss_d: 0.420100
0.4598 --- loss: 1.144424, loss_ss: 0.872957, loss_d: 0.271467
0.4981 --- loss: 0.971688, loss_ss: 0.870554, loss_d: 0.101134
0.5364 --- loss: 0.916935, loss_ss: 0.830908, loss_d: 0.086028
0.5747 --- loss: 1.370975, loss_ss: 1.062358, loss_d: 0.308617
0.6130 --- loss: 1.166154, loss_ss: 0.828816, loss_d: 0.337339
0.6513 --- loss: 1.479159, loss_ss: 1.164003, loss_d: 0.315156
0.6897 --- loss: 1.008543, loss_ss: 0.827212, loss_d: 0.181331
0.7280 --- loss: 0.930199, loss_ss: 0.877764, loss_d: 0.052435
0.7663 --- loss: 1.216390, loss_ss: 1.187799, loss_d: 0.028590
0.8046 --- loss: 1.220201, loss_ss: 1.190945, loss_d: 0.029256
0.8429 --- loss: 1.618895, loss_ss: 0.881384, loss_d: 0.737511
0.8812 --- loss: 0.927285, loss_ss: 0.727853, loss_d: 0.199432
0.9195 --- loss: 0.891107, loss_ss: 0.696916, loss_d: 0.194191
0.9579 --- loss: 1.050936, loss_ss: 0.747047, loss_d: 0.303889
0.9962 --- loss: 0.810469, loss_ss: 0.756835, loss_d: 0.053634
Epoch finished! Loss: 1.132609412074089
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.676055, loss_ss: 1.046897, loss_d: 0.629158
0.0383 --- loss: 1.159502, loss_ss: 0.982216, loss_d: 0.177286
0.0766 --- loss: 1.036275, loss_ss: 0.917569, loss_d: 0.118705
0.1149 --- loss: 1.237898, loss_ss: 1.134411, loss_d: 0.103487
0.1533 --- loss: 1.099838, loss_ss: 1.045068, loss_d: 0.054770
0.1916 --- loss: 1.048099, loss_ss: 0.950890, loss_d: 0.097209
0.2299 --- loss: 1.417387, loss_ss: 1.385412, loss_d: 0.031974
0.2682 --- loss: 0.768302, loss_ss: 0.660476, loss_d: 0.107826
0.3065 --- loss: 1.384733, loss_ss: 1.298836, loss_d: 0.085897
0.3448 --- loss: 1.087425, loss_ss: 0.764521, loss_d: 0.322904
0.3831 --- loss: 1.235427, loss_ss: 0.942063, loss_d: 0.293364
0.4215 --- loss: 0.902975, loss_ss: 0.860345, loss_d: 0.042631
0.4598 --- loss: 0.924883, loss_ss: 0.724512, loss_d: 0.200370
0.4981 --- loss: 1.188771, loss_ss: 1.138915, loss_d: 0.049856
0.5364 --- loss: 1.338259, loss_ss: 0.888572, loss_d: 0.449687
0.5747 --- loss: 0.841563, loss_ss: 0.688247, loss_d: 0.153317
0.6130 --- loss: 1.001981, loss_ss: 0.896491, loss_d: 0.105490
0.6513 --- loss: 0.821082, loss_ss: 0.537061, loss_d: 0.284021
0.6897 --- loss: 0.951850, loss_ss: 0.820134, loss_d: 0.131716
0.7280 --- loss: 1.072874, loss_ss: 0.964721, loss_d: 0.108153
0.7663 --- loss: 1.194001, loss_ss: 1.139699, loss_d: 0.054302
0.8046 --- loss: 1.098021, loss_ss: 0.937290, loss_d: 0.160732
0.8429 --- loss: 1.082684, loss_ss: 0.816032, loss_d: 0.266652
0.8812 --- loss: 1.200346, loss_ss: 1.024513, loss_d: 0.175833
0.9195 --- loss: 0.977534, loss_ss: 0.950646, loss_d: 0.026889
0.9579 --- loss: 1.353405, loss_ss: 1.200319, loss_d: 0.153086
0.9962 --- loss: 1.490386, loss_ss: 0.794317, loss_d: 0.696069
Epoch finished! Loss: 1.0733061070625598
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.916006, loss_ss: 0.793617, loss_d: 0.122390
0.0383 --- loss: 1.255861, loss_ss: 1.197318, loss_d: 0.058543
0.0766 --- loss: 1.020663, loss_ss: 0.873428, loss_d: 0.147235
0.1149 --- loss: 1.114167, loss_ss: 0.531091, loss_d: 0.583076
0.1533 --- loss: 1.068019, loss_ss: 0.868857, loss_d: 0.199161
0.1916 --- loss: 1.127280, loss_ss: 1.005354, loss_d: 0.121926
0.2299 --- loss: 1.020434, loss_ss: 0.854798, loss_d: 0.165636
0.2682 --- loss: 1.152640, loss_ss: 0.611677, loss_d: 0.540964
0.3065 --- loss: 0.991836, loss_ss: 0.871802, loss_d: 0.120035
0.3448 --- loss: 1.115642, loss_ss: 1.074893, loss_d: 0.040749
0.3831 --- loss: 1.058407, loss_ss: 0.607497, loss_d: 0.450910
0.4215 --- loss: 1.100917, loss_ss: 1.061424, loss_d: 0.039493
0.4598 --- loss: 0.853303, loss_ss: 0.786985, loss_d: 0.066318
0.4981 --- loss: 0.888416, loss_ss: 0.687753, loss_d: 0.200663
0.5364 --- loss: 0.910569, loss_ss: 0.780807, loss_d: 0.129762
0.5747 --- loss: 0.993739, loss_ss: 0.738163, loss_d: 0.255576
0.6130 --- loss: 1.315640, loss_ss: 0.773143, loss_d: 0.542497
0.6513 --- loss: 0.611909, loss_ss: 0.557628, loss_d: 0.054281
0.6897 --- loss: 0.951823, loss_ss: 0.900105, loss_d: 0.051718
0.7280 --- loss: 1.008170, loss_ss: 0.914874, loss_d: 0.093297
0.7663 --- loss: 1.330880, loss_ss: 1.238712, loss_d: 0.092168
0.8046 --- loss: 1.170191, loss_ss: 1.098878, loss_d: 0.071314
0.8429 --- loss: 0.936076, loss_ss: 0.809002, loss_d: 0.127074
0.8812 --- loss: 1.068614, loss_ss: 0.848069, loss_d: 0.220544
0.9195 --- loss: 1.122444, loss_ss: 1.077216, loss_d: 0.045228
0.9579 --- loss: 0.968215, loss_ss: 0.903963, loss_d: 0.064252
0.9962 --- loss: 1.266039, loss_ss: 1.244639, loss_d: 0.021400
Epoch finished! Loss: 1.0604335140723449
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.082144, loss_ss: 0.919363, loss_d: 0.162781
0.0383 --- loss: 0.905067, loss_ss: 0.849962, loss_d: 0.055105
0.0766 --- loss: 0.768664, loss_ss: 0.731607, loss_d: 0.037056
0.1149 --- loss: 1.614844, loss_ss: 1.592910, loss_d: 0.021934
0.1533 --- loss: 0.830572, loss_ss: 0.823119, loss_d: 0.007453
0.1916 --- loss: 1.067422, loss_ss: 0.995829, loss_d: 0.071593
0.2299 --- loss: 1.837905, loss_ss: 1.153097, loss_d: 0.684808
0.2682 --- loss: 0.973389, loss_ss: 0.951373, loss_d: 0.022016
0.3065 --- loss: 1.312798, loss_ss: 1.086980, loss_d: 0.225818
0.3448 --- loss: 0.934835, loss_ss: 0.914420, loss_d: 0.020415
0.3831 --- loss: 0.872720, loss_ss: 0.817885, loss_d: 0.054835
0.4215 --- loss: 1.677947, loss_ss: 1.080652, loss_d: 0.597295
0.4598 --- loss: 1.129071, loss_ss: 0.761846, loss_d: 0.367225
0.4981 --- loss: 1.436218, loss_ss: 0.867162, loss_d: 0.569055
0.5364 --- loss: 0.692542, loss_ss: 0.638314, loss_d: 0.054228
0.5747 --- loss: 1.103927, loss_ss: 0.914632, loss_d: 0.189295
0.6130 --- loss: 0.947320, loss_ss: 0.907511, loss_d: 0.039809
0.6513 --- loss: 0.673113, loss_ss: 0.647796, loss_d: 0.025317
0.6897 --- loss: 0.680137, loss_ss: 0.618705, loss_d: 0.061432
0.7280 --- loss: 1.119165, loss_ss: 0.828897, loss_d: 0.290269
0.7663 --- loss: 0.586161, loss_ss: 0.572283, loss_d: 0.013879
0.8046 --- loss: 0.852612, loss_ss: 0.806414, loss_d: 0.046199
0.8429 --- loss: 0.825424, loss_ss: 0.775184, loss_d: 0.050240
0.8812 --- loss: 0.704335, loss_ss: 0.697378, loss_d: 0.006957
0.9195 --- loss: 0.722143, loss_ss: 0.692762, loss_d: 0.029381
0.9579 --- loss: 1.052450, loss_ss: 0.874376, loss_d: 0.178074
0.9962 --- loss: 1.163154, loss_ss: 1.113164, loss_d: 0.049990
Epoch finished! Loss: 0.9951016641580142
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.201650, loss_ss: 0.887945, loss_d: 0.313705
0.0383 --- loss: 1.189973, loss_ss: 0.990084, loss_d: 0.199888
0.0766 --- loss: 1.124125, loss_ss: 1.076285, loss_d: 0.047840
0.1149 --- loss: 0.871419, loss_ss: 0.858586, loss_d: 0.012833
0.1533 --- loss: 0.771033, loss_ss: 0.744949, loss_d: 0.026083
0.1916 --- loss: 0.975593, loss_ss: 0.961204, loss_d: 0.014388
0.2299 --- loss: 0.751501, loss_ss: 0.721878, loss_d: 0.029623
0.2682 --- loss: 0.695905, loss_ss: 0.637985, loss_d: 0.057920
0.3065 --- loss: 0.754995, loss_ss: 0.684795, loss_d: 0.070200
0.3448 --- loss: 0.883539, loss_ss: 0.810454, loss_d: 0.073086
0.3831 --- loss: 0.633420, loss_ss: 0.591443, loss_d: 0.041977
0.4215 --- loss: 1.100676, loss_ss: 1.031969, loss_d: 0.068707
0.4598 --- loss: 1.067948, loss_ss: 0.955058, loss_d: 0.112890
0.4981 --- loss: 0.864237, loss_ss: 0.853337, loss_d: 0.010900
0.5364 --- loss: 1.284177, loss_ss: 1.166112, loss_d: 0.118065
0.5747 --- loss: 1.228094, loss_ss: 1.018499, loss_d: 0.209596
0.6130 --- loss: 0.852445, loss_ss: 0.831763, loss_d: 0.020682
0.6513 --- loss: 0.769381, loss_ss: 0.698629, loss_d: 0.070752
0.6897 --- loss: 1.237631, loss_ss: 0.816959, loss_d: 0.420672
0.7280 --- loss: 0.674882, loss_ss: 0.533911, loss_d: 0.140971
0.7663 --- loss: 1.010983, loss_ss: 0.982179, loss_d: 0.028804
0.8046 --- loss: 0.638963, loss_ss: 0.606298, loss_d: 0.032665
0.8429 --- loss: 1.002007, loss_ss: 0.930319, loss_d: 0.071688
0.8812 --- loss: 0.973905, loss_ss: 0.910935, loss_d: 0.062970
0.9195 --- loss: 0.749860, loss_ss: 0.690989, loss_d: 0.058871
0.9579 --- loss: 1.096952, loss_ss: 0.832300, loss_d: 0.264653
0.9962 --- loss: 1.098247, loss_ss: 0.801420, loss_d: 0.296827
Epoch finished! Loss: 0.9824349788519052
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.822683, loss_ss: 0.731364, loss_d: 0.091319
0.0383 --- loss: 0.993118, loss_ss: 0.893628, loss_d: 0.099490
0.0766 --- loss: 1.007867, loss_ss: 0.974018, loss_d: 0.033849
0.1149 --- loss: 1.087880, loss_ss: 1.072746, loss_d: 0.015134
0.1533 --- loss: 1.027213, loss_ss: 0.976125, loss_d: 0.051087
0.1916 --- loss: 1.123787, loss_ss: 1.088317, loss_d: 0.035471
0.2299 --- loss: 0.999964, loss_ss: 0.635948, loss_d: 0.364016
0.2682 --- loss: 0.735646, loss_ss: 0.696244, loss_d: 0.039401
0.3065 --- loss: 0.905384, loss_ss: 0.798790, loss_d: 0.106594
0.3448 --- loss: 1.269065, loss_ss: 1.262264, loss_d: 0.006800
0.3831 --- loss: 0.850684, loss_ss: 0.840222, loss_d: 0.010461
0.4215 --- loss: 0.682508, loss_ss: 0.654549, loss_d: 0.027960
0.4598 --- loss: 0.871943, loss_ss: 0.825791, loss_d: 0.046152
0.4981 --- loss: 0.809271, loss_ss: 0.784714, loss_d: 0.024557
0.5364 --- loss: 1.061103, loss_ss: 0.576002, loss_d: 0.485102
0.5747 --- loss: 0.738745, loss_ss: 0.713511, loss_d: 0.025234
0.6130 --- loss: 0.806819, loss_ss: 0.779597, loss_d: 0.027222
0.6513 --- loss: 1.177188, loss_ss: 1.048514, loss_d: 0.128674
0.6897 --- loss: 0.841268, loss_ss: 0.823192, loss_d: 0.018077
0.7280 --- loss: 0.820487, loss_ss: 0.764078, loss_d: 0.056410
0.7663 --- loss: 1.026086, loss_ss: 0.882517, loss_d: 0.143569
0.8046 --- loss: 0.967605, loss_ss: 0.959944, loss_d: 0.007661
0.8429 --- loss: 0.574260, loss_ss: 0.467462, loss_d: 0.106798
0.8812 --- loss: 0.927988, loss_ss: 0.772303, loss_d: 0.155685
0.9195 --- loss: 0.777656, loss_ss: 0.758878, loss_d: 0.018778
0.9579 --- loss: 0.893064, loss_ss: 0.881497, loss_d: 0.011567
0.9962 --- loss: 0.848447, loss_ss: 0.829202, loss_d: 0.019245
Epoch finished! Loss: 0.9272615705545132
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7619047619047619
             precision    recall  f1-score   support

        0.0       0.54      0.36      0.43        56
        1.0       0.15      0.18      0.16        38
        2.0       0.76      0.94      0.84       416
        3.0       0.98      0.69      0.81       188
        4.0       0.85      0.65      0.74       142

avg / total       0.78      0.76      0.76       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.69  35.71   97.83  54.05     43.01
1  91.43  18.42   94.89  14.58     16.28
2  82.26  93.75   70.99  76.02     83.96
3  92.86  69.15   99.69  98.48     81.25
4  92.14  65.49   97.56  84.55     73.81
Total accuracy: 76.19%
Average sen: 56.51%
Average spec: 92.19%
Macro f1-score: 59.66%
Diagnosis acc on 15mins: 0.21428571428571427
[0.00103985 0.58668971 0.71761906 0.6943261  0.19699191 0.12012484
 0.48529693 0.95312732 0.99818915 0.71945184 0.93927926 0.97536409
 0.92958105 0.94662231 0.61396909 0.35777104 0.54447091 0.98255688
 0.92677218 0.96496195 0.99255651 0.98991346 0.98487782 0.74710214
 0.85248333 0.94575971 0.60945994 0.00215899]
pred: 0.7063756206022974, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.338421, loss_ss: 1.572178, loss_d: 0.766243
0.0383 --- loss: 2.301531, loss_ss: 1.476774, loss_d: 0.824756
0.0767 --- loss: 2.049155, loss_ss: 1.350316, loss_d: 0.698839
0.1150 --- loss: 1.711232, loss_ss: 1.284788, loss_d: 0.426444
0.1534 --- loss: 2.085032, loss_ss: 1.273577, loss_d: 0.811455
0.1917 --- loss: 1.926454, loss_ss: 1.479901, loss_d: 0.446553
0.2301 --- loss: 1.838465, loss_ss: 1.419527, loss_d: 0.418938
0.2684 --- loss: 2.277999, loss_ss: 1.341099, loss_d: 0.936900
0.3067 --- loss: 1.864376, loss_ss: 1.361217, loss_d: 0.503160
0.3451 --- loss: 1.818654, loss_ss: 1.309818, loss_d: 0.508835
0.3834 --- loss: 1.864746, loss_ss: 1.196568, loss_d: 0.668178
0.4218 --- loss: 1.617635, loss_ss: 1.135955, loss_d: 0.481679
0.4601 --- loss: 1.726904, loss_ss: 1.269216, loss_d: 0.457688
0.4985 --- loss: 2.036704, loss_ss: 1.447768, loss_d: 0.588936
0.5368 --- loss: 2.028874, loss_ss: 1.251892, loss_d: 0.776981
0.5752 --- loss: 1.738930, loss_ss: 1.284804, loss_d: 0.454125
0.6135 --- loss: 1.804380, loss_ss: 1.299796, loss_d: 0.504584
0.6518 --- loss: 1.925481, loss_ss: 1.258938, loss_d: 0.666542
0.6902 --- loss: 1.785364, loss_ss: 1.220914, loss_d: 0.564450
0.7285 --- loss: 1.815263, loss_ss: 1.188519, loss_d: 0.626743
0.7669 --- loss: 1.942389, loss_ss: 1.276094, loss_d: 0.666295
0.8052 --- loss: 1.670446, loss_ss: 1.200227, loss_d: 0.470220
0.8436 --- loss: 1.366798, loss_ss: 1.136171, loss_d: 0.230627
0.8819 --- loss: 1.620897, loss_ss: 1.315071, loss_d: 0.305827
0.9202 --- loss: 1.935339, loss_ss: 1.142566, loss_d: 0.792774
0.9586 --- loss: 1.510992, loss_ss: 1.111418, loss_d: 0.399574
0.9969 --- loss: 1.381933, loss_ss: 1.097987, loss_d: 0.283946
Epoch finished! Loss: 1.829919560138996
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.362099, loss_ss: 1.094623, loss_d: 0.267476
0.0383 --- loss: 1.593847, loss_ss: 1.028872, loss_d: 0.564974
0.0767 --- loss: 1.817501, loss_ss: 1.105613, loss_d: 0.711888
0.1150 --- loss: 1.841603, loss_ss: 1.503139, loss_d: 0.338464
0.1534 --- loss: 1.610585, loss_ss: 1.171749, loss_d: 0.438836
0.1917 --- loss: 1.276709, loss_ss: 1.049913, loss_d: 0.226797
0.2301 --- loss: 1.233219, loss_ss: 1.065011, loss_d: 0.168208
0.2684 --- loss: 1.168230, loss_ss: 0.987782, loss_d: 0.180448
0.3067 --- loss: 1.818195, loss_ss: 1.124768, loss_d: 0.693427
0.3451 --- loss: 1.570883, loss_ss: 1.171988, loss_d: 0.398894
0.3834 --- loss: 1.104537, loss_ss: 0.946804, loss_d: 0.157733
0.4218 --- loss: 1.285693, loss_ss: 1.177134, loss_d: 0.108558
0.4601 --- loss: 1.201299, loss_ss: 0.871145, loss_d: 0.330155
0.4985 --- loss: 1.507823, loss_ss: 1.161019, loss_d: 0.346804
0.5368 --- loss: 1.359861, loss_ss: 0.943295, loss_d: 0.416566
0.5752 --- loss: 1.818705, loss_ss: 1.171608, loss_d: 0.647098
0.6135 --- loss: 1.302272, loss_ss: 1.038670, loss_d: 0.263602
0.6518 --- loss: 1.612563, loss_ss: 0.998563, loss_d: 0.614000
0.6902 --- loss: 0.988672, loss_ss: 0.899258, loss_d: 0.089414
0.7285 --- loss: 1.470274, loss_ss: 0.935221, loss_d: 0.535053
0.7669 --- loss: 1.188904, loss_ss: 1.017007, loss_d: 0.171897
0.8052 --- loss: 1.237675, loss_ss: 0.971415, loss_d: 0.266260
0.8436 --- loss: 1.256979, loss_ss: 0.947837, loss_d: 0.309142
0.8819 --- loss: 1.192806, loss_ss: 0.913570, loss_d: 0.279235
0.9202 --- loss: 1.151157, loss_ss: 0.949153, loss_d: 0.202004
0.9586 --- loss: 1.363421, loss_ss: 1.069076, loss_d: 0.294345
0.9969 --- loss: 1.287190, loss_ss: 1.229681, loss_d: 0.057509
Epoch finished! Loss: 1.4224386712679495
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.370838, loss_ss: 1.118383, loss_d: 0.252455
0.0383 --- loss: 1.106686, loss_ss: 0.786505, loss_d: 0.320181
0.0767 --- loss: 1.453967, loss_ss: 0.858493, loss_d: 0.595474
0.1150 --- loss: 1.192706, loss_ss: 0.884855, loss_d: 0.307851
0.1534 --- loss: 1.708116, loss_ss: 1.004857, loss_d: 0.703259
0.1917 --- loss: 1.239038, loss_ss: 0.919887, loss_d: 0.319150
0.2301 --- loss: 1.097935, loss_ss: 0.879225, loss_d: 0.218711
0.2684 --- loss: 1.060739, loss_ss: 0.883024, loss_d: 0.177715
0.3067 --- loss: 1.069462, loss_ss: 0.951113, loss_d: 0.118349
0.3451 --- loss: 1.114315, loss_ss: 0.950539, loss_d: 0.163776
0.3834 --- loss: 1.352427, loss_ss: 0.947412, loss_d: 0.405015
0.4218 --- loss: 2.034681, loss_ss: 1.065079, loss_d: 0.969602
0.4601 --- loss: 1.744698, loss_ss: 1.097442, loss_d: 0.647257
0.4985 --- loss: 1.246601, loss_ss: 1.181579, loss_d: 0.065022
0.5368 --- loss: 1.095211, loss_ss: 0.937190, loss_d: 0.158021
0.5752 --- loss: 1.641340, loss_ss: 0.920199, loss_d: 0.721141
0.6135 --- loss: 1.407884, loss_ss: 1.149012, loss_d: 0.258873
0.6518 --- loss: 1.085060, loss_ss: 0.971528, loss_d: 0.113532
0.6902 --- loss: 1.246240, loss_ss: 1.130746, loss_d: 0.115494
0.7285 --- loss: 1.467038, loss_ss: 1.053666, loss_d: 0.413372
0.7669 --- loss: 1.573717, loss_ss: 0.994922, loss_d: 0.578795
0.8052 --- loss: 0.974258, loss_ss: 0.895785, loss_d: 0.078473
0.8436 --- loss: 1.074258, loss_ss: 0.958357, loss_d: 0.115901
0.8819 --- loss: 1.369723, loss_ss: 1.117046, loss_d: 0.252677
0.9202 --- loss: 1.142237, loss_ss: 0.824190, loss_d: 0.318047
0.9586 --- loss: 1.102229, loss_ss: 0.994683, loss_d: 0.107546
0.9969 --- loss: 1.168790, loss_ss: 1.087131, loss_d: 0.081659
Epoch finished! Loss: 1.3020800959605436
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.094719, loss_ss: 0.815664, loss_d: 0.279055
0.0383 --- loss: 1.106087, loss_ss: 0.774783, loss_d: 0.331304
0.0767 --- loss: 1.341306, loss_ss: 1.220133, loss_d: 0.121173
0.1150 --- loss: 1.776697, loss_ss: 0.753225, loss_d: 1.023472
0.1534 --- loss: 1.247978, loss_ss: 0.959583, loss_d: 0.288395
0.1917 --- loss: 0.990427, loss_ss: 0.831598, loss_d: 0.158828
0.2301 --- loss: 1.470029, loss_ss: 0.975976, loss_d: 0.494053
0.2684 --- loss: 1.054473, loss_ss: 0.933194, loss_d: 0.121279
0.3067 --- loss: 1.312018, loss_ss: 1.214482, loss_d: 0.097536
0.3451 --- loss: 1.536611, loss_ss: 1.096424, loss_d: 0.440187
0.3834 --- loss: 1.294500, loss_ss: 1.001022, loss_d: 0.293479
0.4218 --- loss: 1.135269, loss_ss: 0.896513, loss_d: 0.238756
0.4601 --- loss: 1.340958, loss_ss: 1.082181, loss_d: 0.258776
0.4985 --- loss: 0.985710, loss_ss: 0.899413, loss_d: 0.086297
0.5368 --- loss: 1.200813, loss_ss: 1.138516, loss_d: 0.062298
0.5752 --- loss: 1.097052, loss_ss: 0.852112, loss_d: 0.244940
0.6135 --- loss: 1.268842, loss_ss: 0.824316, loss_d: 0.444525
0.6518 --- loss: 1.205909, loss_ss: 1.102394, loss_d: 0.103514
0.6902 --- loss: 1.125950, loss_ss: 1.036070, loss_d: 0.089880
0.7285 --- loss: 1.277586, loss_ss: 0.817651, loss_d: 0.459935
0.7669 --- loss: 1.354184, loss_ss: 1.204686, loss_d: 0.149498
0.8052 --- loss: 1.019345, loss_ss: 0.788897, loss_d: 0.230448
0.8436 --- loss: 0.982663, loss_ss: 0.750609, loss_d: 0.232054
0.8819 --- loss: 1.144844, loss_ss: 1.038689, loss_d: 0.106155
0.9202 --- loss: 1.224756, loss_ss: 1.056984, loss_d: 0.167772
0.9586 --- loss: 1.033541, loss_ss: 0.794238, loss_d: 0.239303
0.9969 --- loss: 2.083592, loss_ss: 1.486752, loss_d: 0.596840
Epoch finished! Loss: 1.2004692238110763
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.150361, loss_ss: 0.948959, loss_d: 0.201402
0.0383 --- loss: 0.823176, loss_ss: 0.742514, loss_d: 0.080661
0.0767 --- loss: 1.649777, loss_ss: 1.075227, loss_d: 0.574550
0.1150 --- loss: 1.078597, loss_ss: 0.980767, loss_d: 0.097830
0.1534 --- loss: 1.050332, loss_ss: 0.999908, loss_d: 0.050424
0.1917 --- loss: 1.306865, loss_ss: 0.943042, loss_d: 0.363823
0.2301 --- loss: 1.217342, loss_ss: 1.138753, loss_d: 0.078589
0.2684 --- loss: 1.235571, loss_ss: 1.026324, loss_d: 0.209248
0.3067 --- loss: 1.199929, loss_ss: 1.038361, loss_d: 0.161568
0.3451 --- loss: 1.213708, loss_ss: 1.044034, loss_d: 0.169674
0.3834 --- loss: 1.544092, loss_ss: 0.906854, loss_d: 0.637238
0.4218 --- loss: 0.900772, loss_ss: 0.813267, loss_d: 0.087505
0.4601 --- loss: 1.396808, loss_ss: 1.241243, loss_d: 0.155565
0.4985 --- loss: 0.759133, loss_ss: 0.738071, loss_d: 0.021061
0.5368 --- loss: 1.314852, loss_ss: 0.892216, loss_d: 0.422636
0.5752 --- loss: 0.898872, loss_ss: 0.852642, loss_d: 0.046230
0.6135 --- loss: 1.047142, loss_ss: 0.955397, loss_d: 0.091745
0.6518 --- loss: 1.610326, loss_ss: 0.806349, loss_d: 0.803977
0.6902 --- loss: 1.171779, loss_ss: 1.110954, loss_d: 0.060825
0.7285 --- loss: 1.032411, loss_ss: 0.862745, loss_d: 0.169666
0.7669 --- loss: 0.916090, loss_ss: 0.709525, loss_d: 0.206565
0.8052 --- loss: 1.078272, loss_ss: 0.916420, loss_d: 0.161853
0.8436 --- loss: 1.257174, loss_ss: 1.040823, loss_d: 0.216351
0.8819 --- loss: 1.218198, loss_ss: 1.056240, loss_d: 0.161958
0.9202 --- loss: 1.014852, loss_ss: 0.781812, loss_d: 0.233040
0.9586 --- loss: 1.098781, loss_ss: 1.029742, loss_d: 0.069039
0.9969 --- loss: 0.948026, loss_ss: 0.880235, loss_d: 0.067791
Epoch finished! Loss: 1.1490516006946563
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.478834, loss_ss: 1.348517, loss_d: 0.130318
0.0383 --- loss: 1.205249, loss_ss: 1.042512, loss_d: 0.162737
0.0767 --- loss: 0.944571, loss_ss: 0.735719, loss_d: 0.208852
0.1150 --- loss: 0.905934, loss_ss: 0.818950, loss_d: 0.086984
0.1534 --- loss: 1.000603, loss_ss: 0.830229, loss_d: 0.170374
0.1917 --- loss: 0.980998, loss_ss: 0.868242, loss_d: 0.112756
0.2301 --- loss: 0.839849, loss_ss: 0.767119, loss_d: 0.072730
0.2684 --- loss: 1.643965, loss_ss: 0.872877, loss_d: 0.771089
0.3067 --- loss: 1.348396, loss_ss: 1.078537, loss_d: 0.269860
0.3451 --- loss: 1.002491, loss_ss: 0.967730, loss_d: 0.034761
0.3834 --- loss: 1.433041, loss_ss: 1.010141, loss_d: 0.422900
0.4218 --- loss: 1.144148, loss_ss: 0.824566, loss_d: 0.319582
0.4601 --- loss: 1.694336, loss_ss: 0.871859, loss_d: 0.822477
0.4985 --- loss: 1.370116, loss_ss: 1.020974, loss_d: 0.349143
0.5368 --- loss: 1.063365, loss_ss: 0.943925, loss_d: 0.119439
0.5752 --- loss: 0.729242, loss_ss: 0.686105, loss_d: 0.043136
0.6135 --- loss: 1.573577, loss_ss: 1.320622, loss_d: 0.252955
0.6518 --- loss: 1.432022, loss_ss: 0.954058, loss_d: 0.477964
0.6902 --- loss: 1.050778, loss_ss: 0.980761, loss_d: 0.070018
0.7285 --- loss: 0.861696, loss_ss: 0.762666, loss_d: 0.099031
0.7669 --- loss: 1.227270, loss_ss: 0.839794, loss_d: 0.387476
0.8052 --- loss: 0.853206, loss_ss: 0.791882, loss_d: 0.061324
0.8436 --- loss: 1.088394, loss_ss: 1.019252, loss_d: 0.069142
0.8819 --- loss: 1.124365, loss_ss: 0.991496, loss_d: 0.132869
0.9202 --- loss: 1.127418, loss_ss: 0.836432, loss_d: 0.290986
0.9586 --- loss: 0.823314, loss_ss: 0.802287, loss_d: 0.021027
0.9969 --- loss: 0.903738, loss_ss: 0.827361, loss_d: 0.076377
Epoch finished! Loss: 1.0939950768764202
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.906064, loss_ss: 0.871910, loss_d: 0.034154
0.0383 --- loss: 0.982768, loss_ss: 0.950518, loss_d: 0.032250
0.0767 --- loss: 0.823185, loss_ss: 0.804682, loss_d: 0.018504
0.1150 --- loss: 0.762862, loss_ss: 0.749733, loss_d: 0.013130
0.1534 --- loss: 0.940447, loss_ss: 0.888020, loss_d: 0.052427
0.1917 --- loss: 0.845473, loss_ss: 0.826424, loss_d: 0.019049
0.2301 --- loss: 0.841854, loss_ss: 0.773270, loss_d: 0.068585
0.2684 --- loss: 0.899233, loss_ss: 0.870204, loss_d: 0.029029
0.3067 --- loss: 1.041481, loss_ss: 0.679039, loss_d: 0.362442
0.3451 --- loss: 0.836344, loss_ss: 0.809773, loss_d: 0.026571
0.3834 --- loss: 1.241266, loss_ss: 1.079565, loss_d: 0.161701
0.4218 --- loss: 0.798912, loss_ss: 0.762618, loss_d: 0.036294
0.4601 --- loss: 0.775645, loss_ss: 0.707419, loss_d: 0.068226
0.4985 --- loss: 1.058656, loss_ss: 0.947891, loss_d: 0.110765
0.5368 --- loss: 1.309870, loss_ss: 1.263550, loss_d: 0.046319
0.5752 --- loss: 2.702339, loss_ss: 0.569763, loss_d: 2.132577
0.6135 --- loss: 0.841556, loss_ss: 0.607334, loss_d: 0.234222
0.6518 --- loss: 0.996172, loss_ss: 0.965475, loss_d: 0.030697
0.6902 --- loss: 0.897983, loss_ss: 0.842741, loss_d: 0.055242
0.7285 --- loss: 1.104299, loss_ss: 1.056030, loss_d: 0.048269
0.7669 --- loss: 0.719845, loss_ss: 0.656484, loss_d: 0.063360
0.8052 --- loss: 0.938872, loss_ss: 0.820040, loss_d: 0.118832
0.8436 --- loss: 0.811579, loss_ss: 0.765853, loss_d: 0.045726
0.8819 --- loss: 0.969633, loss_ss: 0.747245, loss_d: 0.222388
0.9202 --- loss: 1.482353, loss_ss: 0.750653, loss_d: 0.731700
0.9586 --- loss: 1.275987, loss_ss: 1.018168, loss_d: 0.257819
0.9969 --- loss: 0.935354, loss_ss: 0.902283, loss_d: 0.033071
Epoch finished! Loss: 1.0499061515698067
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.867178, loss_ss: 0.777693, loss_d: 0.089486
0.0383 --- loss: 1.211720, loss_ss: 0.891901, loss_d: 0.319818
0.0767 --- loss: 1.031180, loss_ss: 0.986462, loss_d: 0.044718
0.1150 --- loss: 0.801668, loss_ss: 0.779722, loss_d: 0.021946
0.1534 --- loss: 1.230249, loss_ss: 0.843982, loss_d: 0.386267
0.1917 --- loss: 1.504786, loss_ss: 1.070339, loss_d: 0.434447
0.2301 --- loss: 0.992469, loss_ss: 0.950222, loss_d: 0.042247
0.2684 --- loss: 1.005649, loss_ss: 0.946228, loss_d: 0.059421
0.3067 --- loss: 0.906292, loss_ss: 0.820957, loss_d: 0.085334
0.3451 --- loss: 1.093362, loss_ss: 0.877092, loss_d: 0.216269
0.3834 --- loss: 1.110054, loss_ss: 1.033453, loss_d: 0.076601
0.4218 --- loss: 0.850943, loss_ss: 0.698456, loss_d: 0.152487
0.4601 --- loss: 1.151107, loss_ss: 1.137576, loss_d: 0.013530
0.4985 --- loss: 1.371136, loss_ss: 0.890507, loss_d: 0.480629
0.5368 --- loss: 1.177141, loss_ss: 1.064717, loss_d: 0.112424
0.5752 --- loss: 1.066995, loss_ss: 0.896857, loss_d: 0.170137
0.6135 --- loss: 1.181207, loss_ss: 0.957337, loss_d: 0.223870
0.6518 --- loss: 0.680738, loss_ss: 0.635596, loss_d: 0.045142
0.6902 --- loss: 1.519733, loss_ss: 0.979522, loss_d: 0.540211
0.7285 --- loss: 0.885655, loss_ss: 0.811253, loss_d: 0.074402
0.7669 --- loss: 0.645395, loss_ss: 0.576468, loss_d: 0.068928
0.8052 --- loss: 0.926897, loss_ss: 0.892961, loss_d: 0.033936
0.8436 --- loss: 1.379593, loss_ss: 0.986342, loss_d: 0.393251
0.8819 --- loss: 0.821391, loss_ss: 0.739677, loss_d: 0.081715
0.9202 --- loss: 1.077707, loss_ss: 0.870148, loss_d: 0.207559
0.9586 --- loss: 0.869464, loss_ss: 0.781091, loss_d: 0.088372
0.9969 --- loss: 0.726892, loss_ss: 0.707674, loss_d: 0.019218
Epoch finished! Loss: 1.0474824756383896
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.750840, loss_ss: 0.675402, loss_d: 0.075438
0.0383 --- loss: 1.276836, loss_ss: 1.219351, loss_d: 0.057485
0.0767 --- loss: 0.961974, loss_ss: 0.910201, loss_d: 0.051773
0.1150 --- loss: 1.517887, loss_ss: 1.298251, loss_d: 0.219636
0.1534 --- loss: 0.816372, loss_ss: 0.707337, loss_d: 0.109035
0.1917 --- loss: 0.927498, loss_ss: 0.851797, loss_d: 0.075701
0.2301 --- loss: 0.772411, loss_ss: 0.748054, loss_d: 0.024358
0.2684 --- loss: 0.935323, loss_ss: 0.872428, loss_d: 0.062895
0.3067 --- loss: 0.985844, loss_ss: 0.943637, loss_d: 0.042207
0.3451 --- loss: 1.221399, loss_ss: 0.908717, loss_d: 0.312683
0.3834 --- loss: 0.942008, loss_ss: 0.829152, loss_d: 0.112856
0.4218 --- loss: 0.865993, loss_ss: 0.833145, loss_d: 0.032847
0.4601 --- loss: 1.041449, loss_ss: 0.939712, loss_d: 0.101737
0.4985 --- loss: 0.775985, loss_ss: 0.682788, loss_d: 0.093196
0.5368 --- loss: 1.100320, loss_ss: 1.059563, loss_d: 0.040756
0.5752 --- loss: 0.900459, loss_ss: 0.824612, loss_d: 0.075847
0.6135 --- loss: 1.217739, loss_ss: 1.098277, loss_d: 0.119462
0.6518 --- loss: 1.559623, loss_ss: 1.514462, loss_d: 0.045162
0.6902 --- loss: 1.457753, loss_ss: 1.224753, loss_d: 0.233000
0.7285 --- loss: 1.195870, loss_ss: 1.132791, loss_d: 0.063079
0.7669 --- loss: 0.934939, loss_ss: 0.871314, loss_d: 0.063625
0.8052 --- loss: 1.253792, loss_ss: 1.099594, loss_d: 0.154198
0.8436 --- loss: 1.349873, loss_ss: 1.275375, loss_d: 0.074498
0.8819 --- loss: 1.401726, loss_ss: 1.199733, loss_d: 0.201992
0.9202 --- loss: 1.180842, loss_ss: 1.028790, loss_d: 0.152052
0.9586 --- loss: 0.940984, loss_ss: 0.896721, loss_d: 0.044262
0.9969 --- loss: 0.873113, loss_ss: 0.777670, loss_d: 0.095443
Epoch finished! Loss: 1.0310452504799916
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.848350, loss_ss: 0.841358, loss_d: 0.006992
0.0383 --- loss: 0.815071, loss_ss: 0.758960, loss_d: 0.056111
0.0767 --- loss: 0.960223, loss_ss: 0.924520, loss_d: 0.035703
0.1150 --- loss: 0.812940, loss_ss: 0.708623, loss_d: 0.104317
0.1534 --- loss: 0.815556, loss_ss: 0.808744, loss_d: 0.006812
0.1917 --- loss: 1.009652, loss_ss: 0.733042, loss_d: 0.276610
0.2301 --- loss: 0.947024, loss_ss: 0.927004, loss_d: 0.020019
0.2684 --- loss: 0.778040, loss_ss: 0.759734, loss_d: 0.018307
0.3067 --- loss: 0.833761, loss_ss: 0.781385, loss_d: 0.052377
0.3451 --- loss: 0.966579, loss_ss: 0.904984, loss_d: 0.061596
0.3834 --- loss: 0.870056, loss_ss: 0.862920, loss_d: 0.007136
0.4218 --- loss: 0.981669, loss_ss: 0.960726, loss_d: 0.020943
0.4601 --- loss: 0.712023, loss_ss: 0.647999, loss_d: 0.064024
0.4985 --- loss: 1.390072, loss_ss: 0.833360, loss_d: 0.556712
0.5368 --- loss: 0.741475, loss_ss: 0.520227, loss_d: 0.221248
0.5752 --- loss: 0.826071, loss_ss: 0.812767, loss_d: 0.013304
0.6135 --- loss: 1.115534, loss_ss: 1.062290, loss_d: 0.053244
0.6518 --- loss: 0.923121, loss_ss: 0.776943, loss_d: 0.146178
0.6902 --- loss: 0.958238, loss_ss: 0.647616, loss_d: 0.310623
0.7285 --- loss: 1.029141, loss_ss: 1.014330, loss_d: 0.014810
0.7669 --- loss: 0.941519, loss_ss: 0.905858, loss_d: 0.035662
0.8052 --- loss: 0.915197, loss_ss: 0.904767, loss_d: 0.010429
0.8436 --- loss: 0.995817, loss_ss: 0.818549, loss_d: 0.177268
0.8819 --- loss: 0.947636, loss_ss: 0.886903, loss_d: 0.060733
0.9202 --- loss: 0.763482, loss_ss: 0.670415, loss_d: 0.093067
0.9586 --- loss: 1.106831, loss_ss: 1.036861, loss_d: 0.069970
0.9969 --- loss: 0.739800, loss_ss: 0.659290, loss_d: 0.080510
Epoch finished! Loss: 0.9801537252389467
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7888888888888889
             precision    recall  f1-score   support

        0.0       0.99      0.91      0.95       142
        1.0       0.23      0.48      0.31        23
        2.0       0.77      0.93      0.84       466
        3.0       0.97      0.43      0.60       167
        4.0       0.78      0.64      0.70       102

avg / total       0.83      0.79      0.78       900
 


====== chc052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.44  90.85   99.87  99.23     94.85
1  94.67  47.83   95.90  23.40     31.43
2  81.56  92.92   69.35  76.50     83.91
3  89.22  43.11   99.73  97.30     59.75
4  93.89  63.73   97.74  78.31     70.27
Total accuracy: 78.89%
Average sen: 67.69%
Average spec: 92.52%
Macro f1-score: 68.04%
Diagnosis acc on 15mins: 0.6666666666666666
[0.98786503 0.81080055 0.92956579 0.54156905 0.45703167 0.00139295
 0.00459234 0.99278933 0.97753477 0.01071449 0.33990914 0.00491913
 0.76203835 0.20600395 0.288977   0.01482629 0.04118833 0.08043226
 0.00737981 0.10053544 0.02003617 0.10094718 0.01125423 0.82616234
 0.99287391 0.45099175 0.77516949 0.03585927 0.03154879 0.39378056]
pred: 0.37328964430683603, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.380343, loss_ss: 1.696065, loss_d: 0.684278
0.0383 --- loss: 2.221654, loss_ss: 1.546708, loss_d: 0.674946
0.0767 --- loss: 1.992880, loss_ss: 1.599646, loss_d: 0.393235
0.1150 --- loss: 2.321199, loss_ss: 1.574672, loss_d: 0.746527
0.1534 --- loss: 1.952943, loss_ss: 1.519227, loss_d: 0.433716
0.1917 --- loss: 2.282181, loss_ss: 1.646662, loss_d: 0.635520
0.2301 --- loss: 2.016213, loss_ss: 1.578493, loss_d: 0.437720
0.2684 --- loss: 2.004536, loss_ss: 1.445251, loss_d: 0.559286
0.3067 --- loss: 1.889376, loss_ss: 1.388823, loss_d: 0.500553
0.3451 --- loss: 2.011650, loss_ss: 1.437243, loss_d: 0.574407
0.3834 --- loss: 1.755750, loss_ss: 1.310538, loss_d: 0.445212
0.4218 --- loss: 1.917235, loss_ss: 1.391995, loss_d: 0.525240
0.4601 --- loss: 2.448533, loss_ss: 1.319840, loss_d: 1.128693
0.4985 --- loss: 1.828203, loss_ss: 1.258097, loss_d: 0.570105
0.5368 --- loss: 1.940866, loss_ss: 1.207937, loss_d: 0.732929
0.5752 --- loss: 1.730008, loss_ss: 1.220317, loss_d: 0.509691
0.6135 --- loss: 1.842095, loss_ss: 1.413971, loss_d: 0.428124
0.6518 --- loss: 1.724316, loss_ss: 1.295207, loss_d: 0.429108
0.6902 --- loss: 1.864891, loss_ss: 1.446745, loss_d: 0.418146
0.7285 --- loss: 1.815840, loss_ss: 1.419577, loss_d: 0.396263
0.7669 --- loss: 1.404915, loss_ss: 1.139812, loss_d: 0.265102
0.8052 --- loss: 1.800633, loss_ss: 1.367247, loss_d: 0.433386
0.8436 --- loss: 1.595677, loss_ss: 1.218623, loss_d: 0.377053
0.8819 --- loss: 1.514519, loss_ss: 1.261598, loss_d: 0.252920
0.9202 --- loss: 1.510756, loss_ss: 1.137596, loss_d: 0.373159
0.9586 --- loss: 1.570620, loss_ss: 1.121118, loss_d: 0.449502
0.9969 --- loss: 1.600395, loss_ss: 1.275230, loss_d: 0.325165
Epoch finished! Loss: 1.9305125153981721
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.618838, loss_ss: 1.333469, loss_d: 0.285368
0.0383 --- loss: 1.765934, loss_ss: 1.271568, loss_d: 0.494366
0.0767 --- loss: 2.111437, loss_ss: 1.149418, loss_d: 0.962019
0.1150 --- loss: 2.117006, loss_ss: 1.315955, loss_d: 0.801051
0.1534 --- loss: 1.626183, loss_ss: 1.222997, loss_d: 0.403186
0.1917 --- loss: 1.826803, loss_ss: 1.510092, loss_d: 0.316711
0.2301 --- loss: 1.722886, loss_ss: 1.147594, loss_d: 0.575292
0.2684 --- loss: 1.751895, loss_ss: 1.383902, loss_d: 0.367994
0.3067 --- loss: 1.579108, loss_ss: 0.984889, loss_d: 0.594219
0.3451 --- loss: 1.411263, loss_ss: 1.077349, loss_d: 0.333914
0.3834 --- loss: 1.380400, loss_ss: 0.976622, loss_d: 0.403778
0.4218 --- loss: 1.898278, loss_ss: 1.101290, loss_d: 0.796988
0.4601 --- loss: 1.726871, loss_ss: 1.154638, loss_d: 0.572232
0.4985 --- loss: 1.324245, loss_ss: 1.115535, loss_d: 0.208710
0.5368 --- loss: 1.604228, loss_ss: 1.338288, loss_d: 0.265939
0.5752 --- loss: 1.630404, loss_ss: 1.469431, loss_d: 0.160973
0.6135 --- loss: 1.732812, loss_ss: 1.295287, loss_d: 0.437525
0.6518 --- loss: 1.165356, loss_ss: 1.061035, loss_d: 0.104321
0.6902 --- loss: 1.362200, loss_ss: 1.229600, loss_d: 0.132601
0.7285 --- loss: 1.712879, loss_ss: 1.166613, loss_d: 0.546267
0.7669 --- loss: 1.162621, loss_ss: 1.049291, loss_d: 0.113330
0.8052 --- loss: 1.227924, loss_ss: 1.032147, loss_d: 0.195777
0.8436 --- loss: 1.482578, loss_ss: 0.976766, loss_d: 0.505812
0.8819 --- loss: 1.300401, loss_ss: 1.108884, loss_d: 0.191517
0.9202 --- loss: 1.300500, loss_ss: 1.129405, loss_d: 0.171095
0.9586 --- loss: 1.766154, loss_ss: 1.050062, loss_d: 0.716092
0.9969 --- loss: 1.824652, loss_ss: 1.096996, loss_d: 0.727656
Epoch finished! Loss: 1.5014767023233266
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.378558, loss_ss: 0.931649, loss_d: 0.446909
0.0383 --- loss: 1.360559, loss_ss: 1.122864, loss_d: 0.237694
0.0767 --- loss: 1.178401, loss_ss: 0.964381, loss_d: 0.214020
0.1150 --- loss: 1.258448, loss_ss: 1.107569, loss_d: 0.150878
0.1534 --- loss: 1.324536, loss_ss: 1.162012, loss_d: 0.162524
0.1917 --- loss: 1.203369, loss_ss: 0.954115, loss_d: 0.249255
0.2301 --- loss: 1.478436, loss_ss: 1.000024, loss_d: 0.478412
0.2684 --- loss: 1.125027, loss_ss: 0.892175, loss_d: 0.232853
0.3067 --- loss: 1.176786, loss_ss: 1.099832, loss_d: 0.076954
0.3451 --- loss: 1.726279, loss_ss: 0.863565, loss_d: 0.862714
0.3834 --- loss: 1.221869, loss_ss: 1.018019, loss_d: 0.203850
0.4218 --- loss: 1.306867, loss_ss: 1.019791, loss_d: 0.287076
0.4601 --- loss: 1.220863, loss_ss: 1.018857, loss_d: 0.202006
0.4985 --- loss: 1.915393, loss_ss: 1.165703, loss_d: 0.749690
0.5368 --- loss: 1.435693, loss_ss: 1.062418, loss_d: 0.373275
0.5752 --- loss: 1.288177, loss_ss: 1.001237, loss_d: 0.286940
0.6135 --- loss: 1.373220, loss_ss: 1.079681, loss_d: 0.293539
0.6518 --- loss: 2.036377, loss_ss: 1.029936, loss_d: 1.006441
0.6902 --- loss: 0.908360, loss_ss: 0.786942, loss_d: 0.121418
0.7285 --- loss: 1.375461, loss_ss: 1.248812, loss_d: 0.126648
0.7669 --- loss: 1.602997, loss_ss: 1.398607, loss_d: 0.204390
0.8052 --- loss: 1.601415, loss_ss: 1.489668, loss_d: 0.111746
0.8436 --- loss: 1.770535, loss_ss: 1.103533, loss_d: 0.667002
0.8819 --- loss: 1.100993, loss_ss: 0.931685, loss_d: 0.169308
0.9202 --- loss: 0.963548, loss_ss: 0.700127, loss_d: 0.263421
0.9586 --- loss: 0.998770, loss_ss: 0.792168, loss_d: 0.206601
0.9969 --- loss: 0.937749, loss_ss: 0.845354, loss_d: 0.092395
Epoch finished! Loss: 1.3160934244210905
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.991271, loss_ss: 0.753493, loss_d: 0.237778
0.0383 --- loss: 1.282320, loss_ss: 1.028797, loss_d: 0.253522
0.0767 --- loss: 1.269629, loss_ss: 1.012374, loss_d: 0.257255
0.1150 --- loss: 1.019223, loss_ss: 0.911427, loss_d: 0.107796
0.1534 --- loss: 1.143296, loss_ss: 1.053398, loss_d: 0.089898
0.1917 --- loss: 1.504312, loss_ss: 1.151044, loss_d: 0.353269
0.2301 --- loss: 1.573214, loss_ss: 0.775874, loss_d: 0.797341
0.2684 --- loss: 1.204771, loss_ss: 1.104829, loss_d: 0.099943
0.3067 --- loss: 1.324986, loss_ss: 0.916730, loss_d: 0.408256
0.3451 --- loss: 1.114159, loss_ss: 0.990954, loss_d: 0.123206
0.3834 --- loss: 1.805738, loss_ss: 1.315163, loss_d: 0.490576
0.4218 --- loss: 2.277215, loss_ss: 0.858685, loss_d: 1.418531
0.4601 --- loss: 1.468875, loss_ss: 1.133773, loss_d: 0.335102
0.4985 --- loss: 0.814879, loss_ss: 0.701708, loss_d: 0.113171
0.5368 --- loss: 1.349135, loss_ss: 1.040404, loss_d: 0.308731
0.5752 --- loss: 1.209662, loss_ss: 0.908872, loss_d: 0.300791
0.6135 --- loss: 0.918189, loss_ss: 0.808340, loss_d: 0.109849
0.6518 --- loss: 1.201717, loss_ss: 1.103569, loss_d: 0.098148
0.6902 --- loss: 1.112399, loss_ss: 1.070860, loss_d: 0.041538
0.7285 --- loss: 0.938703, loss_ss: 0.792547, loss_d: 0.146156
0.7669 --- loss: 1.146424, loss_ss: 0.844387, loss_d: 0.302037
0.8052 --- loss: 1.493781, loss_ss: 1.331739, loss_d: 0.162042
0.8436 --- loss: 1.319472, loss_ss: 0.848412, loss_d: 0.471060
0.8819 --- loss: 0.940276, loss_ss: 0.808021, loss_d: 0.132255
0.9202 --- loss: 0.969203, loss_ss: 0.661721, loss_d: 0.307482
0.9586 --- loss: 1.233947, loss_ss: 0.928048, loss_d: 0.305899
0.9969 --- loss: 1.505602, loss_ss: 1.053849, loss_d: 0.451754
Epoch finished! Loss: 1.2178209777061755
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.028946, loss_ss: 0.689016, loss_d: 0.339929
0.0383 --- loss: 1.439270, loss_ss: 0.918940, loss_d: 0.520330
0.0767 --- loss: 1.083373, loss_ss: 0.913480, loss_d: 0.169893
0.1150 --- loss: 1.166455, loss_ss: 1.081578, loss_d: 0.084877
0.1534 --- loss: 1.345512, loss_ss: 1.296473, loss_d: 0.049039
0.1917 --- loss: 0.822055, loss_ss: 0.717031, loss_d: 0.105024
0.2301 --- loss: 1.755859, loss_ss: 1.397855, loss_d: 0.358004
0.2684 --- loss: 0.876596, loss_ss: 0.782798, loss_d: 0.093798
0.3067 --- loss: 1.373436, loss_ss: 0.945304, loss_d: 0.428133
0.3451 --- loss: 1.259477, loss_ss: 0.998924, loss_d: 0.260554
0.3834 --- loss: 1.324898, loss_ss: 0.756449, loss_d: 0.568449
0.4218 --- loss: 0.956878, loss_ss: 0.834172, loss_d: 0.122707
0.4601 --- loss: 1.261631, loss_ss: 0.956906, loss_d: 0.304725
0.4985 --- loss: 1.247971, loss_ss: 0.692520, loss_d: 0.555451
0.5368 --- loss: 1.148050, loss_ss: 0.813241, loss_d: 0.334809
0.5752 --- loss: 1.010746, loss_ss: 0.867207, loss_d: 0.143540
0.6135 --- loss: 1.195347, loss_ss: 0.961364, loss_d: 0.233983
0.6518 --- loss: 1.206077, loss_ss: 0.960870, loss_d: 0.245207
0.6902 --- loss: 0.890418, loss_ss: 0.810345, loss_d: 0.080073
0.7285 --- loss: 1.434103, loss_ss: 1.048924, loss_d: 0.385179
0.7669 --- loss: 1.302822, loss_ss: 0.984119, loss_d: 0.318703
0.8052 --- loss: 0.825836, loss_ss: 0.761822, loss_d: 0.064013
0.8436 --- loss: 0.854962, loss_ss: 0.791030, loss_d: 0.063932
0.8819 --- loss: 1.513263, loss_ss: 1.399498, loss_d: 0.113766
0.9202 --- loss: 1.398801, loss_ss: 0.765539, loss_d: 0.633262
0.9586 --- loss: 0.970388, loss_ss: 0.842334, loss_d: 0.128054
0.9969 --- loss: 0.979958, loss_ss: 0.871200, loss_d: 0.108759
Epoch finished! Loss: 1.1517570234262027
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.207645, loss_ss: 0.859922, loss_d: 0.347723
0.0383 --- loss: 1.329239, loss_ss: 1.036686, loss_d: 0.292552
0.0767 --- loss: 0.930109, loss_ss: 0.855867, loss_d: 0.074242
0.1150 --- loss: 1.049571, loss_ss: 0.820581, loss_d: 0.228991
0.1534 --- loss: 0.896578, loss_ss: 0.748779, loss_d: 0.147799
0.1917 --- loss: 1.192666, loss_ss: 1.126667, loss_d: 0.065999
0.2301 --- loss: 0.923375, loss_ss: 0.824808, loss_d: 0.098568
0.2684 --- loss: 1.046068, loss_ss: 0.687516, loss_d: 0.358552
0.3067 --- loss: 1.495783, loss_ss: 1.108080, loss_d: 0.387703
0.3451 --- loss: 1.052286, loss_ss: 0.840231, loss_d: 0.212054
0.3834 --- loss: 0.967949, loss_ss: 0.649893, loss_d: 0.318056
0.4218 --- loss: 0.952160, loss_ss: 0.825357, loss_d: 0.126803
0.4601 --- loss: 1.132014, loss_ss: 1.094008, loss_d: 0.038006
0.4985 --- loss: 1.322000, loss_ss: 1.154392, loss_d: 0.167608
0.5368 --- loss: 0.928887, loss_ss: 0.759067, loss_d: 0.169819
0.5752 --- loss: 1.197032, loss_ss: 0.991154, loss_d: 0.205878
0.6135 --- loss: 0.796970, loss_ss: 0.704222, loss_d: 0.092748
0.6518 --- loss: 0.762736, loss_ss: 0.726608, loss_d: 0.036128
0.6902 --- loss: 1.180164, loss_ss: 0.945699, loss_d: 0.234465
0.7285 --- loss: 1.169394, loss_ss: 1.103908, loss_d: 0.065486
0.7669 --- loss: 1.530020, loss_ss: 1.062481, loss_d: 0.467539
0.8052 --- loss: 1.108962, loss_ss: 1.027703, loss_d: 0.081260
0.8436 --- loss: 0.969514, loss_ss: 0.733812, loss_d: 0.235703
0.8819 --- loss: 0.940089, loss_ss: 0.744604, loss_d: 0.195484
0.9202 --- loss: 0.926122, loss_ss: 0.829109, loss_d: 0.097013
0.9586 --- loss: 0.894264, loss_ss: 0.669709, loss_d: 0.224555
0.9969 --- loss: 1.336152, loss_ss: 1.310343, loss_d: 0.025810
Epoch finished! Loss: 1.0951431975914883
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.399067, loss_ss: 0.846592, loss_d: 0.552475
0.0383 --- loss: 1.103967, loss_ss: 1.059903, loss_d: 0.044063
0.0767 --- loss: 1.084115, loss_ss: 1.045111, loss_d: 0.039005
0.1150 --- loss: 1.098794, loss_ss: 0.982243, loss_d: 0.116550
0.1534 --- loss: 0.921073, loss_ss: 0.896651, loss_d: 0.024422
0.1917 --- loss: 1.320080, loss_ss: 1.245847, loss_d: 0.074233
0.2301 --- loss: 0.741756, loss_ss: 0.724014, loss_d: 0.017742
0.2684 --- loss: 0.986224, loss_ss: 0.949011, loss_d: 0.037213
0.3067 --- loss: 1.180171, loss_ss: 1.011112, loss_d: 0.169060
0.3451 --- loss: 0.885476, loss_ss: 0.827625, loss_d: 0.057851
0.3834 --- loss: 1.079668, loss_ss: 0.958841, loss_d: 0.120826
0.4218 --- loss: 0.997117, loss_ss: 0.946622, loss_d: 0.050495
0.4601 --- loss: 1.343073, loss_ss: 1.161535, loss_d: 0.181538
0.4985 --- loss: 1.352306, loss_ss: 0.752185, loss_d: 0.600121
0.5368 --- loss: 1.172405, loss_ss: 0.708342, loss_d: 0.464062
0.5752 --- loss: 1.561385, loss_ss: 0.660051, loss_d: 0.901335
0.6135 --- loss: 1.272743, loss_ss: 0.686236, loss_d: 0.586506
0.6518 --- loss: 1.033214, loss_ss: 0.867542, loss_d: 0.165673
0.6902 --- loss: 1.024591, loss_ss: 0.956115, loss_d: 0.068476
0.7285 --- loss: 1.140921, loss_ss: 0.936973, loss_d: 0.203948
0.7669 --- loss: 1.043784, loss_ss: 0.951878, loss_d: 0.091906
0.8052 --- loss: 1.044410, loss_ss: 0.778302, loss_d: 0.266108
0.8436 --- loss: 0.890678, loss_ss: 0.827084, loss_d: 0.063594
0.8819 --- loss: 0.960811, loss_ss: 0.848481, loss_d: 0.112330
0.9202 --- loss: 1.136414, loss_ss: 0.954736, loss_d: 0.181678
0.9586 --- loss: 0.797627, loss_ss: 0.694688, loss_d: 0.102940
0.9969 --- loss: 1.327345, loss_ss: 0.838524, loss_d: 0.488821
Epoch finished! Loss: 1.0617210624309688
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.500545, loss_ss: 1.071740, loss_d: 0.428805
0.0383 --- loss: 0.959657, loss_ss: 0.904329, loss_d: 0.055328
0.0767 --- loss: 0.806939, loss_ss: 0.701863, loss_d: 0.105076
0.1150 --- loss: 0.990217, loss_ss: 0.803902, loss_d: 0.186315
0.1534 --- loss: 1.025530, loss_ss: 0.717615, loss_d: 0.307914
0.1917 --- loss: 1.200995, loss_ss: 1.080243, loss_d: 0.120751
0.2301 --- loss: 0.800395, loss_ss: 0.694172, loss_d: 0.106222
0.2684 --- loss: 1.073986, loss_ss: 0.872468, loss_d: 0.201517
0.3067 --- loss: 0.937723, loss_ss: 0.885476, loss_d: 0.052247
0.3451 --- loss: 0.893678, loss_ss: 0.842636, loss_d: 0.051042
0.3834 --- loss: 0.991773, loss_ss: 0.968775, loss_d: 0.022998
0.4218 --- loss: 1.320159, loss_ss: 0.758231, loss_d: 0.561928
0.4601 --- loss: 1.594007, loss_ss: 1.440505, loss_d: 0.153502
0.4985 --- loss: 0.795193, loss_ss: 0.780673, loss_d: 0.014520
0.5368 --- loss: 0.795851, loss_ss: 0.707256, loss_d: 0.088594
0.5752 --- loss: 1.100426, loss_ss: 1.026754, loss_d: 0.073672
0.6135 --- loss: 1.247994, loss_ss: 0.896989, loss_d: 0.351005
0.6518 --- loss: 1.155045, loss_ss: 1.016572, loss_d: 0.138473
0.6902 --- loss: 1.183433, loss_ss: 1.141695, loss_d: 0.041738
0.7285 --- loss: 1.428442, loss_ss: 0.871721, loss_d: 0.556721
0.7669 --- loss: 1.040220, loss_ss: 0.905974, loss_d: 0.134247
0.8052 --- loss: 0.866838, loss_ss: 0.754710, loss_d: 0.112128
0.8436 --- loss: 0.974795, loss_ss: 0.631878, loss_d: 0.342917
0.8819 --- loss: 1.287593, loss_ss: 1.090303, loss_d: 0.197290
0.9202 --- loss: 0.714367, loss_ss: 0.695118, loss_d: 0.019249
0.9586 --- loss: 0.981659, loss_ss: 0.961422, loss_d: 0.020237
0.9969 --- loss: 0.876986, loss_ss: 0.824434, loss_d: 0.052552
Epoch finished! Loss: 1.0308525887819437
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.852485, loss_ss: 0.847171, loss_d: 0.005314
0.0383 --- loss: 0.842606, loss_ss: 0.825404, loss_d: 0.017201
0.0767 --- loss: 0.875814, loss_ss: 0.681052, loss_d: 0.194762
0.1150 --- loss: 0.791267, loss_ss: 0.677151, loss_d: 0.114116
0.1534 --- loss: 0.840468, loss_ss: 0.815172, loss_d: 0.025296
0.1917 --- loss: 0.940688, loss_ss: 0.844604, loss_d: 0.096084
0.2301 --- loss: 0.830149, loss_ss: 0.796472, loss_d: 0.033677
0.2684 --- loss: 1.034694, loss_ss: 0.994171, loss_d: 0.040523
0.3067 --- loss: 0.899921, loss_ss: 0.895886, loss_d: 0.004035
0.3451 --- loss: 0.928253, loss_ss: 0.895596, loss_d: 0.032658
0.3834 --- loss: 1.036889, loss_ss: 1.014380, loss_d: 0.022509
0.4218 --- loss: 0.816034, loss_ss: 0.780869, loss_d: 0.035165
0.4601 --- loss: 1.185212, loss_ss: 0.881340, loss_d: 0.303871
0.4985 --- loss: 0.810531, loss_ss: 0.788285, loss_d: 0.022246
0.5368 --- loss: 0.555752, loss_ss: 0.433123, loss_d: 0.122629
0.5752 --- loss: 0.859806, loss_ss: 0.829923, loss_d: 0.029883
0.6135 --- loss: 0.914755, loss_ss: 0.900629, loss_d: 0.014126
0.6518 --- loss: 0.931558, loss_ss: 0.909101, loss_d: 0.022457
0.6902 --- loss: 0.945696, loss_ss: 0.715154, loss_d: 0.230543
0.7285 --- loss: 1.063270, loss_ss: 0.818900, loss_d: 0.244370
0.7669 --- loss: 1.099444, loss_ss: 0.996925, loss_d: 0.102519
0.8052 --- loss: 0.736905, loss_ss: 0.673591, loss_d: 0.063314
0.8436 --- loss: 1.078252, loss_ss: 0.995948, loss_d: 0.082304
0.8819 --- loss: 3.940053, loss_ss: 0.680989, loss_d: 3.259064
0.9202 --- loss: 1.495701, loss_ss: 0.718722, loss_d: 0.776979
0.9586 --- loss: 1.068550, loss_ss: 0.909330, loss_d: 0.159220
0.9969 --- loss: 1.067122, loss_ss: 0.984000, loss_d: 0.083122
Epoch finished! Loss: 0.9869428733220467
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.135995, loss_ss: 0.978445, loss_d: 0.157550
0.0383 --- loss: 0.539529, loss_ss: 0.510009, loss_d: 0.029519
0.0767 --- loss: 0.897121, loss_ss: 0.804944, loss_d: 0.092177
0.1150 --- loss: 0.598616, loss_ss: 0.591388, loss_d: 0.007227
0.1534 --- loss: 0.994090, loss_ss: 0.980236, loss_d: 0.013854
0.1917 --- loss: 0.629498, loss_ss: 0.601505, loss_d: 0.027993
0.2301 --- loss: 0.909454, loss_ss: 0.787901, loss_d: 0.121554
0.2684 --- loss: 0.952277, loss_ss: 0.827404, loss_d: 0.124873
0.3067 --- loss: 0.889646, loss_ss: 0.875937, loss_d: 0.013709
0.3451 --- loss: 0.881116, loss_ss: 0.738536, loss_d: 0.142580
0.3834 --- loss: 0.810715, loss_ss: 0.785843, loss_d: 0.024872
0.4218 --- loss: 0.793284, loss_ss: 0.754562, loss_d: 0.038721
0.4601 --- loss: 0.994669, loss_ss: 0.888231, loss_d: 0.106438
0.4985 --- loss: 1.089515, loss_ss: 1.077154, loss_d: 0.012361
0.5368 --- loss: 1.254809, loss_ss: 1.247486, loss_d: 0.007323
0.5752 --- loss: 0.898280, loss_ss: 0.880996, loss_d: 0.017285
0.6135 --- loss: 1.226531, loss_ss: 1.170841, loss_d: 0.055690
0.6518 --- loss: 0.726307, loss_ss: 0.645242, loss_d: 0.081065
0.6902 --- loss: 1.324983, loss_ss: 1.290001, loss_d: 0.034982
0.7285 --- loss: 0.981000, loss_ss: 0.949831, loss_d: 0.031169
0.7669 --- loss: 0.822169, loss_ss: 0.806871, loss_d: 0.015299
0.8052 --- loss: 1.081901, loss_ss: 0.963717, loss_d: 0.118184
0.8436 --- loss: 0.979408, loss_ss: 0.827983, loss_d: 0.151426
0.8819 --- loss: 1.207055, loss_ss: 1.070400, loss_d: 0.136655
0.9202 --- loss: 0.717523, loss_ss: 0.634755, loss_d: 0.082767
0.9586 --- loss: 0.689415, loss_ss: 0.668952, loss_d: 0.020463
0.9969 --- loss: 0.896677, loss_ss: 0.871989, loss_d: 0.024688
Epoch finished! Loss: 0.9527213463416466
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7633333333333333
             precision    recall  f1-score   support

        0.0       0.97      0.63      0.77       175
        1.0       0.39      0.62      0.48        86
        2.0       0.81      0.83      0.82       396
        3.0       1.00      0.71      0.83       153
        4.0       0.62      0.93      0.74        90

avg / total       0.82      0.76      0.77       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.56  63.43   99.59   97.37     76.82
1  87.11  61.63   89.80   38.97     47.75
2  84.33  83.33   85.12   81.48     82.40
3  95.11  71.24  100.00  100.00     83.21
4  93.56  93.33   93.58   61.76     74.34
Total accuracy: 76.33%
Average sen: 74.59%
Average spec: 93.62%
Macro f1-score: 72.90%
Diagnosis acc on 15mins: 0.43333333333333335
[0.92133158 0.53559071 0.22900997 0.84741026 0.41243741 0.21387492
 0.72676814 0.55900609 0.18171987 0.28272915 0.00872531 0.5770734
 0.4206388  0.91583729 0.93767297 0.54727101 0.89277571 0.62969226
 0.27601132 0.03118448 0.62320304 0.28391129 0.81011587 0.83722579
 0.96662873 0.86909002 0.99359751 0.43289664 0.1672392  0.45595947]
pred: 0.5528876074589789, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.412869, loss_ss: 1.721864, loss_d: 0.691004
0.0385 --- loss: 1.988881, loss_ss: 1.497870, loss_d: 0.491011
0.0769 --- loss: 2.045478, loss_ss: 1.456610, loss_d: 0.588868
0.1154 --- loss: 2.014573, loss_ss: 1.544273, loss_d: 0.470300
0.1538 --- loss: 2.078854, loss_ss: 1.357404, loss_d: 0.721450
0.1923 --- loss: 1.775234, loss_ss: 1.279553, loss_d: 0.495681
0.2308 --- loss: 1.887717, loss_ss: 1.270314, loss_d: 0.617403
0.2692 --- loss: 2.017198, loss_ss: 1.490920, loss_d: 0.526278
0.3077 --- loss: 1.959062, loss_ss: 1.457038, loss_d: 0.502024
0.3462 --- loss: 1.811999, loss_ss: 1.209266, loss_d: 0.602732
0.3846 --- loss: 1.847424, loss_ss: 1.433294, loss_d: 0.414130
0.4231 --- loss: 1.585661, loss_ss: 1.144010, loss_d: 0.441651
0.4615 --- loss: 2.036675, loss_ss: 1.240089, loss_d: 0.796586
0.5000 --- loss: 1.568026, loss_ss: 1.111107, loss_d: 0.456919
0.5385 --- loss: 1.822652, loss_ss: 1.148637, loss_d: 0.674014
0.5769 --- loss: 1.750334, loss_ss: 1.262102, loss_d: 0.488232
0.6154 --- loss: 1.761000, loss_ss: 1.203091, loss_d: 0.557909
0.6538 --- loss: 2.370479, loss_ss: 1.205348, loss_d: 1.165130
0.6923 --- loss: 1.546558, loss_ss: 0.995294, loss_d: 0.551264
0.7308 --- loss: 1.708947, loss_ss: 1.333619, loss_d: 0.375328
0.7692 --- loss: 1.608002, loss_ss: 1.022818, loss_d: 0.585185
0.8077 --- loss: 1.526729, loss_ss: 1.003628, loss_d: 0.523101
0.8462 --- loss: 1.442363, loss_ss: 1.087011, loss_d: 0.355352
0.8846 --- loss: 1.470456, loss_ss: 1.092023, loss_d: 0.378433
0.9231 --- loss: 2.212500, loss_ss: 1.474354, loss_d: 0.738146
0.9615 --- loss: 2.024433, loss_ss: 1.137771, loss_d: 0.886663
Epoch finished! Loss: 1.8475635005700541
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.425301, loss_ss: 1.151232, loss_d: 0.274069
0.0385 --- loss: 1.577370, loss_ss: 1.165398, loss_d: 0.411972
0.0769 --- loss: 1.450083, loss_ss: 1.238123, loss_d: 0.211960
0.1154 --- loss: 1.347215, loss_ss: 0.969238, loss_d: 0.377978
0.1538 --- loss: 1.631770, loss_ss: 1.182077, loss_d: 0.449693
0.1923 --- loss: 1.491822, loss_ss: 1.132457, loss_d: 0.359364
0.2308 --- loss: 1.906717, loss_ss: 1.043091, loss_d: 0.863626
0.2692 --- loss: 1.266498, loss_ss: 1.014477, loss_d: 0.252021
0.3077 --- loss: 1.293436, loss_ss: 0.924835, loss_d: 0.368601
0.3462 --- loss: 1.116255, loss_ss: 0.947173, loss_d: 0.169082
0.3846 --- loss: 1.657258, loss_ss: 1.286305, loss_d: 0.370954
0.4231 --- loss: 1.484759, loss_ss: 1.093263, loss_d: 0.391496
0.4615 --- loss: 1.774917, loss_ss: 1.470448, loss_d: 0.304469
0.5000 --- loss: 1.343682, loss_ss: 1.130993, loss_d: 0.212689
0.5385 --- loss: 1.554116, loss_ss: 1.291845, loss_d: 0.262271
0.5769 --- loss: 1.205840, loss_ss: 1.029934, loss_d: 0.175906
0.6154 --- loss: 1.353708, loss_ss: 1.190338, loss_d: 0.163370
0.6538 --- loss: 1.397281, loss_ss: 1.081718, loss_d: 0.315563
0.6923 --- loss: 1.270222, loss_ss: 1.041425, loss_d: 0.228796
0.7308 --- loss: 1.402757, loss_ss: 1.206472, loss_d: 0.196285
0.7692 --- loss: 1.267480, loss_ss: 1.004913, loss_d: 0.262567
0.8077 --- loss: 1.322800, loss_ss: 0.922732, loss_d: 0.400068
0.8462 --- loss: 1.460153, loss_ss: 1.377354, loss_d: 0.082798
0.8846 --- loss: 1.672667, loss_ss: 1.318970, loss_d: 0.353698
0.9231 --- loss: 1.607969, loss_ss: 1.280918, loss_d: 0.327052
0.9615 --- loss: 1.254196, loss_ss: 1.113186, loss_d: 0.141010
Epoch finished! Loss: 1.475766051229823
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.028642, loss_ss: 0.939226, loss_d: 0.089416
0.0385 --- loss: 1.407671, loss_ss: 1.004157, loss_d: 0.403513
0.0769 --- loss: 1.401368, loss_ss: 1.061647, loss_d: 0.339721
0.1154 --- loss: 0.931010, loss_ss: 0.830625, loss_d: 0.100385
0.1538 --- loss: 1.758896, loss_ss: 1.364801, loss_d: 0.394096
0.1923 --- loss: 1.445663, loss_ss: 1.020862, loss_d: 0.424801
0.2308 --- loss: 1.160201, loss_ss: 1.028511, loss_d: 0.131691
0.2692 --- loss: 1.391654, loss_ss: 1.197408, loss_d: 0.194246
0.3077 --- loss: 1.317644, loss_ss: 1.089204, loss_d: 0.228440
0.3462 --- loss: 1.416370, loss_ss: 1.226603, loss_d: 0.189766
0.3846 --- loss: 1.546738, loss_ss: 1.290927, loss_d: 0.255811
0.4231 --- loss: 1.410241, loss_ss: 1.313010, loss_d: 0.097231
0.4615 --- loss: 1.275162, loss_ss: 1.161855, loss_d: 0.113307
0.5000 --- loss: 1.185832, loss_ss: 1.116643, loss_d: 0.069189
0.5385 --- loss: 1.315809, loss_ss: 0.975050, loss_d: 0.340759
0.5769 --- loss: 1.132763, loss_ss: 1.063719, loss_d: 0.069044
0.6154 --- loss: 1.398001, loss_ss: 1.051482, loss_d: 0.346520
0.6538 --- loss: 1.047093, loss_ss: 0.948375, loss_d: 0.098717
0.6923 --- loss: 1.143791, loss_ss: 1.042785, loss_d: 0.101006
0.7308 --- loss: 1.146154, loss_ss: 1.049414, loss_d: 0.096740
0.7692 --- loss: 1.502147, loss_ss: 1.265527, loss_d: 0.236621
0.8077 --- loss: 0.941128, loss_ss: 0.848889, loss_d: 0.092238
0.8462 --- loss: 1.227751, loss_ss: 1.127429, loss_d: 0.100322
0.8846 --- loss: 1.323131, loss_ss: 1.087733, loss_d: 0.235398
0.9231 --- loss: 1.038658, loss_ss: 1.011460, loss_d: 0.027198
0.9615 --- loss: 1.505855, loss_ss: 1.126955, loss_d: 0.378900
Epoch finished! Loss: 1.3121051279734461
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.152014, loss_ss: 0.940886, loss_d: 0.211128
0.0385 --- loss: 0.919370, loss_ss: 0.872831, loss_d: 0.046539
0.0769 --- loss: 0.910533, loss_ss: 0.874589, loss_d: 0.035944
0.1154 --- loss: 1.490315, loss_ss: 0.757973, loss_d: 0.732341
0.1538 --- loss: 1.711440, loss_ss: 1.124454, loss_d: 0.586986
0.1923 --- loss: 1.826360, loss_ss: 1.509187, loss_d: 0.317173
0.2308 --- loss: 1.147101, loss_ss: 1.036963, loss_d: 0.110138
0.2692 --- loss: 1.300053, loss_ss: 0.902923, loss_d: 0.397130
0.3077 --- loss: 1.021754, loss_ss: 0.908842, loss_d: 0.112911
0.3462 --- loss: 0.971532, loss_ss: 0.835234, loss_d: 0.136299
0.3846 --- loss: 1.141781, loss_ss: 0.875770, loss_d: 0.266011
0.4231 --- loss: 0.997103, loss_ss: 0.961961, loss_d: 0.035142
0.4615 --- loss: 1.030813, loss_ss: 0.961963, loss_d: 0.068850
0.5000 --- loss: 1.334000, loss_ss: 0.999228, loss_d: 0.334772
0.5385 --- loss: 1.279648, loss_ss: 1.037680, loss_d: 0.241968
0.5769 --- loss: 1.720838, loss_ss: 1.214219, loss_d: 0.506619
0.6154 --- loss: 1.262833, loss_ss: 1.095971, loss_d: 0.166862
0.6538 --- loss: 1.513077, loss_ss: 1.461837, loss_d: 0.051239
0.6923 --- loss: 1.067110, loss_ss: 0.994148, loss_d: 0.072962
0.7308 --- loss: 1.058914, loss_ss: 1.035864, loss_d: 0.023051
0.7692 --- loss: 1.074174, loss_ss: 0.872377, loss_d: 0.201797
0.8077 --- loss: 1.190387, loss_ss: 0.886521, loss_d: 0.303866
0.8462 --- loss: 1.330883, loss_ss: 0.940324, loss_d: 0.390559
0.8846 --- loss: 1.350740, loss_ss: 1.155838, loss_d: 0.194901
0.9231 --- loss: 0.908717, loss_ss: 0.843618, loss_d: 0.065099
0.9615 --- loss: 1.523124, loss_ss: 1.053030, loss_d: 0.470094
Epoch finished! Loss: 1.2577774041407817
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.394194, loss_ss: 1.070008, loss_d: 0.324186
0.0385 --- loss: 1.103200, loss_ss: 1.041105, loss_d: 0.062095
0.0769 --- loss: 0.938078, loss_ss: 0.904612, loss_d: 0.033466
0.1154 --- loss: 1.561533, loss_ss: 1.268826, loss_d: 0.292706
0.1538 --- loss: 0.938183, loss_ss: 0.908232, loss_d: 0.029951
0.1923 --- loss: 1.059513, loss_ss: 0.954044, loss_d: 0.105469
0.2308 --- loss: 1.680948, loss_ss: 1.285693, loss_d: 0.395255
0.2692 --- loss: 1.582819, loss_ss: 1.008901, loss_d: 0.573918
0.3077 --- loss: 0.996234, loss_ss: 0.924014, loss_d: 0.072220
0.3462 --- loss: 0.928835, loss_ss: 0.814985, loss_d: 0.113850
0.3846 --- loss: 1.311647, loss_ss: 1.134736, loss_d: 0.176911
0.4231 --- loss: 0.980090, loss_ss: 0.840057, loss_d: 0.140034
0.4615 --- loss: 1.135414, loss_ss: 0.949469, loss_d: 0.185945
0.5000 --- loss: 0.878139, loss_ss: 0.695706, loss_d: 0.182433
0.5385 --- loss: 1.385961, loss_ss: 1.055915, loss_d: 0.330046
0.5769 --- loss: 1.121002, loss_ss: 1.108416, loss_d: 0.012586
0.6154 --- loss: 1.095048, loss_ss: 0.789533, loss_d: 0.305515
0.6538 --- loss: 0.876143, loss_ss: 0.797992, loss_d: 0.078151
0.6923 --- loss: 1.098629, loss_ss: 0.932863, loss_d: 0.165766
0.7308 --- loss: 0.997643, loss_ss: 0.784630, loss_d: 0.213013
0.7692 --- loss: 1.225373, loss_ss: 0.956153, loss_d: 0.269220
0.8077 --- loss: 1.041769, loss_ss: 0.883187, loss_d: 0.158582
0.8462 --- loss: 0.920333, loss_ss: 0.838549, loss_d: 0.081784
0.8846 --- loss: 1.130573, loss_ss: 1.065541, loss_d: 0.065032
0.9231 --- loss: 1.030471, loss_ss: 0.973094, loss_d: 0.057377
0.9615 --- loss: 1.122894, loss_ss: 0.856435, loss_d: 0.266459
Epoch finished! Loss: 1.183857151210078
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.283237, loss_ss: 1.039653, loss_d: 0.243584
0.0385 --- loss: 1.602583, loss_ss: 1.172522, loss_d: 0.430062
0.0769 --- loss: 0.886107, loss_ss: 0.838466, loss_d: 0.047641
0.1154 --- loss: 0.982618, loss_ss: 0.924515, loss_d: 0.058102
0.1538 --- loss: 1.074488, loss_ss: 1.039458, loss_d: 0.035030
0.1923 --- loss: 1.385312, loss_ss: 1.161662, loss_d: 0.223650
0.2308 --- loss: 0.943604, loss_ss: 0.918584, loss_d: 0.025020
0.2692 --- loss: 1.096204, loss_ss: 0.982833, loss_d: 0.113371
0.3077 --- loss: 1.004907, loss_ss: 0.896671, loss_d: 0.108236
0.3462 --- loss: 0.795304, loss_ss: 0.780906, loss_d: 0.014398
0.3846 --- loss: 1.221233, loss_ss: 1.055042, loss_d: 0.166192
0.4231 --- loss: 0.845143, loss_ss: 0.834422, loss_d: 0.010721
0.4615 --- loss: 1.044427, loss_ss: 1.005142, loss_d: 0.039286
0.5000 --- loss: 1.491953, loss_ss: 0.730462, loss_d: 0.761491
0.5385 --- loss: 1.003811, loss_ss: 0.830265, loss_d: 0.173546
0.5769 --- loss: 1.162499, loss_ss: 0.963163, loss_d: 0.199336
0.6154 --- loss: 1.025981, loss_ss: 0.973455, loss_d: 0.052527
0.6538 --- loss: 1.041489, loss_ss: 0.952072, loss_d: 0.089417
0.6923 --- loss: 1.133314, loss_ss: 0.983607, loss_d: 0.149707
0.7308 --- loss: 1.511272, loss_ss: 0.983924, loss_d: 0.527348
0.7692 --- loss: 0.911433, loss_ss: 0.886565, loss_d: 0.024867
0.8077 --- loss: 1.070313, loss_ss: 0.943489, loss_d: 0.126824
0.8462 --- loss: 1.144925, loss_ss: 0.931824, loss_d: 0.213102
0.8846 --- loss: 1.205586, loss_ss: 1.070883, loss_d: 0.134703
0.9231 --- loss: 1.635109, loss_ss: 1.201566, loss_d: 0.433543
0.9615 --- loss: 1.011954, loss_ss: 0.960718, loss_d: 0.051236
Epoch finished! Loss: 1.1202438611781735
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.096214, loss_ss: 1.053493, loss_d: 0.042721
0.0385 --- loss: 1.395701, loss_ss: 1.006987, loss_d: 0.388714
0.0769 --- loss: 1.022454, loss_ss: 0.993425, loss_d: 0.029028
0.1154 --- loss: 1.421263, loss_ss: 1.280404, loss_d: 0.140859
0.1538 --- loss: 1.193995, loss_ss: 0.776877, loss_d: 0.417118
0.1923 --- loss: 1.272941, loss_ss: 1.143860, loss_d: 0.129081
0.2308 --- loss: 1.102445, loss_ss: 0.921499, loss_d: 0.180946
0.2692 --- loss: 1.266704, loss_ss: 1.154870, loss_d: 0.111834
0.3077 --- loss: 0.844149, loss_ss: 0.806931, loss_d: 0.037218
0.3462 --- loss: 0.920705, loss_ss: 0.825686, loss_d: 0.095019
0.3846 --- loss: 1.080667, loss_ss: 1.000384, loss_d: 0.080282
0.4231 --- loss: 0.942156, loss_ss: 0.914591, loss_d: 0.027565
0.4615 --- loss: 1.127637, loss_ss: 0.752993, loss_d: 0.374644
0.5000 --- loss: 1.538172, loss_ss: 1.205449, loss_d: 0.332724
0.5385 --- loss: 1.244080, loss_ss: 1.090932, loss_d: 0.153148
0.5769 --- loss: 0.858744, loss_ss: 0.841394, loss_d: 0.017350
0.6154 --- loss: 1.382180, loss_ss: 1.057938, loss_d: 0.324243
0.6538 --- loss: 0.888957, loss_ss: 0.841839, loss_d: 0.047118
0.6923 --- loss: 1.432057, loss_ss: 1.378756, loss_d: 0.053301
0.7308 --- loss: 1.048086, loss_ss: 0.956008, loss_d: 0.092078
0.7692 --- loss: 0.919969, loss_ss: 0.855580, loss_d: 0.064389
0.8077 --- loss: 1.075613, loss_ss: 1.071535, loss_d: 0.004078
0.8462 --- loss: 1.577338, loss_ss: 1.040319, loss_d: 0.537019
0.8846 --- loss: 1.560383, loss_ss: 1.079020, loss_d: 0.481363
0.9231 --- loss: 1.156050, loss_ss: 0.955830, loss_d: 0.200221
0.9615 --- loss: 1.853828, loss_ss: 0.859019, loss_d: 0.994809
Epoch finished! Loss: 1.0677668311881283
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.079510, loss_ss: 1.046744, loss_d: 0.032766
0.0385 --- loss: 1.785141, loss_ss: 1.254790, loss_d: 0.530351
0.0769 --- loss: 1.006205, loss_ss: 0.951273, loss_d: 0.054932
0.1154 --- loss: 1.291981, loss_ss: 0.969505, loss_d: 0.322475
0.1538 --- loss: 1.113325, loss_ss: 1.075584, loss_d: 0.037741
0.1923 --- loss: 1.131800, loss_ss: 1.008519, loss_d: 0.123280
0.2308 --- loss: 1.282717, loss_ss: 1.008129, loss_d: 0.274588
0.2692 --- loss: 1.007456, loss_ss: 0.966537, loss_d: 0.040919
0.3077 --- loss: 1.132760, loss_ss: 1.075999, loss_d: 0.056761
0.3462 --- loss: 1.252255, loss_ss: 0.760689, loss_d: 0.491566
0.3846 --- loss: 1.036748, loss_ss: 1.022633, loss_d: 0.014115
0.4231 --- loss: 1.076928, loss_ss: 1.061915, loss_d: 0.015013
0.4615 --- loss: 0.855163, loss_ss: 0.753184, loss_d: 0.101979
0.5000 --- loss: 1.073780, loss_ss: 0.708570, loss_d: 0.365210
0.5385 --- loss: 1.057199, loss_ss: 0.956347, loss_d: 0.100852
0.5769 --- loss: 1.368146, loss_ss: 1.258830, loss_d: 0.109316
0.6154 --- loss: 1.221838, loss_ss: 0.898727, loss_d: 0.323111
0.6538 --- loss: 0.971171, loss_ss: 0.925401, loss_d: 0.045770
0.6923 --- loss: 0.947182, loss_ss: 0.941203, loss_d: 0.005979
0.7308 --- loss: 0.849574, loss_ss: 0.743532, loss_d: 0.106042
0.7692 --- loss: 0.868403, loss_ss: 0.752524, loss_d: 0.115879
0.8077 --- loss: 1.326344, loss_ss: 1.312112, loss_d: 0.014232
0.8462 --- loss: 1.113414, loss_ss: 0.828975, loss_d: 0.284439
0.8846 --- loss: 0.728490, loss_ss: 0.714041, loss_d: 0.014449
0.9231 --- loss: 1.471084, loss_ss: 1.438634, loss_d: 0.032450
0.9615 --- loss: 1.397248, loss_ss: 0.809905, loss_d: 0.587342
Epoch finished! Loss: 1.0500629251988238
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.917692, loss_ss: 0.869575, loss_d: 0.048117
0.0385 --- loss: 1.344588, loss_ss: 0.709590, loss_d: 0.634997
0.0769 --- loss: 0.895483, loss_ss: 0.821670, loss_d: 0.073813
0.1154 --- loss: 1.141021, loss_ss: 0.743080, loss_d: 0.397941
0.1538 --- loss: 1.006938, loss_ss: 0.936573, loss_d: 0.070365
0.1923 --- loss: 1.045970, loss_ss: 0.752156, loss_d: 0.293813
0.2308 --- loss: 1.218745, loss_ss: 1.134670, loss_d: 0.084075
0.2692 --- loss: 0.738443, loss_ss: 0.718301, loss_d: 0.020141
0.3077 --- loss: 0.968591, loss_ss: 0.957711, loss_d: 0.010880
0.3462 --- loss: 1.126462, loss_ss: 0.954144, loss_d: 0.172318
0.3846 --- loss: 1.378982, loss_ss: 1.179864, loss_d: 0.199119
0.4231 --- loss: 0.779392, loss_ss: 0.761443, loss_d: 0.017949
0.4615 --- loss: 0.856652, loss_ss: 0.850697, loss_d: 0.005955
0.5000 --- loss: 1.043017, loss_ss: 1.023058, loss_d: 0.019959
0.5385 --- loss: 0.986708, loss_ss: 0.920689, loss_d: 0.066019
0.5769 --- loss: 1.068388, loss_ss: 1.053252, loss_d: 0.015136
0.6154 --- loss: 0.994368, loss_ss: 0.966326, loss_d: 0.028042
0.6538 --- loss: 1.197152, loss_ss: 1.003476, loss_d: 0.193676
0.6923 --- loss: 1.212152, loss_ss: 0.796877, loss_d: 0.415276
0.7308 --- loss: 1.266762, loss_ss: 1.049877, loss_d: 0.216885
0.7692 --- loss: 1.059776, loss_ss: 0.975112, loss_d: 0.084664
0.8077 --- loss: 1.097971, loss_ss: 1.024226, loss_d: 0.073745
0.8462 --- loss: 0.870897, loss_ss: 0.850839, loss_d: 0.020058
0.8846 --- loss: 0.881152, loss_ss: 0.837623, loss_d: 0.043530
0.9231 --- loss: 0.850694, loss_ss: 0.838177, loss_d: 0.012517
0.9615 --- loss: 0.586807, loss_ss: 0.569758, loss_d: 0.017049
Epoch finished! Loss: 1.0252647747404326
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.956274, loss_ss: 0.946328, loss_d: 0.009946
0.0385 --- loss: 0.752484, loss_ss: 0.739097, loss_d: 0.013387
0.0769 --- loss: 1.106827, loss_ss: 1.067023, loss_d: 0.039803
0.1154 --- loss: 1.232079, loss_ss: 1.212950, loss_d: 0.019128
0.1538 --- loss: 1.070652, loss_ss: 0.903246, loss_d: 0.167406
0.1923 --- loss: 1.593563, loss_ss: 1.133944, loss_d: 0.459618
0.2308 --- loss: 1.011658, loss_ss: 0.938857, loss_d: 0.072800
0.2692 --- loss: 0.882783, loss_ss: 0.790189, loss_d: 0.092594
0.3077 --- loss: 0.695158, loss_ss: 0.670445, loss_d: 0.024713
0.3462 --- loss: 1.186488, loss_ss: 0.859399, loss_d: 0.327089
0.3846 --- loss: 0.857437, loss_ss: 0.770304, loss_d: 0.087133
0.4231 --- loss: 1.057401, loss_ss: 1.046909, loss_d: 0.010492
0.4615 --- loss: 0.994494, loss_ss: 0.920926, loss_d: 0.073568
0.5000 --- loss: 1.443095, loss_ss: 1.039448, loss_d: 0.403648
0.5385 --- loss: 0.912400, loss_ss: 0.861721, loss_d: 0.050679
0.5769 --- loss: 0.858771, loss_ss: 0.828395, loss_d: 0.030376
0.6154 --- loss: 0.713586, loss_ss: 0.693177, loss_d: 0.020409
0.6538 --- loss: 0.898183, loss_ss: 0.894798, loss_d: 0.003386
0.6923 --- loss: 1.403557, loss_ss: 1.356038, loss_d: 0.047520
0.7308 --- loss: 1.009328, loss_ss: 0.977827, loss_d: 0.031501
0.7692 --- loss: 0.934429, loss_ss: 0.741602, loss_d: 0.192827
0.8077 --- loss: 0.851451, loss_ss: 0.842996, loss_d: 0.008455
0.8462 --- loss: 1.158829, loss_ss: 0.985574, loss_d: 0.173255
0.8846 --- loss: 0.882568, loss_ss: 0.872627, loss_d: 0.009941
0.9231 --- loss: 1.026131, loss_ss: 0.884868, loss_d: 0.141263
0.9615 --- loss: 0.861719, loss_ss: 0.846676, loss_d: 0.015043
Epoch finished! Loss: 0.9847457059101709
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6140350877192983
             precision    recall  f1-score   support

        0.0       0.74      0.50      0.60        40
        1.0       0.16      0.80      0.27        79
        2.0       0.83      0.68      0.75       553
        3.0       1.00      0.03      0.06        69
        4.0       0.90      0.60      0.72       399

avg / total       0.81      0.61      0.66      1140
 


====== chp001-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.63  50.00   99.36   74.07     59.70
1  69.82  79.75   69.09   16.11     26.81
2  77.72  67.99   86.88   83.00     74.75
3  94.12   2.90  100.00  100.00      5.63
4  83.51  59.90   96.22   89.51     71.77
Total accuracy: 61.40%
Average sen: 52.11%
Average spec: 90.31%
Macro f1-score: 47.73%
Diagnosis acc on 15mins: 1.0
[0.99519759 0.99569619 0.99844259 0.9964928  0.99700028 0.99320918
 0.997159   0.99884522 0.99863619 0.99659747 0.99775451 0.99935013
 0.99831104 0.99822038 0.99792165 0.99528027 0.99861491 0.998725
 0.99956053 0.99825555 0.99920434 0.99907589 0.99953532 0.99912935
 0.99971181 0.99543321 0.99745935 0.99966705 0.99959499 0.9989717
 0.99920672 0.99960989 0.99945503 0.99777138 0.99904686 0.9999088
 0.9994247  0.99946707]
pred: 0.9981827359450491, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.502988, loss_ss: 1.816963, loss_d: 0.686025
0.0384 --- loss: 2.185604, loss_ss: 1.621440, loss_d: 0.564164
0.0769 --- loss: 2.402729, loss_ss: 1.686258, loss_d: 0.716471
0.1153 --- loss: 2.019864, loss_ss: 1.407334, loss_d: 0.612529
0.1537 --- loss: 1.843216, loss_ss: 1.506509, loss_d: 0.336707
0.1922 --- loss: 1.975633, loss_ss: 1.587923, loss_d: 0.387710
0.2306 --- loss: 1.987249, loss_ss: 1.430343, loss_d: 0.556906
0.2690 --- loss: 1.996405, loss_ss: 1.497244, loss_d: 0.499160
0.3075 --- loss: 2.457244, loss_ss: 1.675425, loss_d: 0.781819
0.3459 --- loss: 2.357861, loss_ss: 1.503366, loss_d: 0.854495
0.3843 --- loss: 2.050627, loss_ss: 1.559350, loss_d: 0.491277
0.4228 --- loss: 1.818603, loss_ss: 1.278926, loss_d: 0.539677
0.4612 --- loss: 1.786084, loss_ss: 1.417643, loss_d: 0.368441
0.4996 --- loss: 1.835184, loss_ss: 1.386447, loss_d: 0.448738
0.5380 --- loss: 1.922103, loss_ss: 1.408208, loss_d: 0.513895
0.5765 --- loss: 1.820104, loss_ss: 1.287384, loss_d: 0.532721
0.6149 --- loss: 1.940135, loss_ss: 1.488389, loss_d: 0.451745
0.6533 --- loss: 1.722195, loss_ss: 1.149660, loss_d: 0.572535
0.6918 --- loss: 1.776179, loss_ss: 1.301970, loss_d: 0.474210
0.7302 --- loss: 1.676041, loss_ss: 1.463665, loss_d: 0.212376
0.7686 --- loss: 1.703214, loss_ss: 1.460558, loss_d: 0.242656
0.8071 --- loss: 1.772619, loss_ss: 1.281140, loss_d: 0.491479
0.8455 --- loss: 1.539612, loss_ss: 1.306315, loss_d: 0.233297
0.8839 --- loss: 2.218202, loss_ss: 1.224364, loss_d: 0.993837
0.9224 --- loss: 1.634025, loss_ss: 1.245136, loss_d: 0.388889
0.9608 --- loss: 1.480858, loss_ss: 1.192724, loss_d: 0.288134
0.9992 --- loss: 2.869300, loss_ss: 1.702380, loss_d: 1.166919
Epoch finished! Loss: 1.9532976388931274
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.611489, loss_ss: 1.287978, loss_d: 0.323511
0.0384 --- loss: 1.805149, loss_ss: 1.412349, loss_d: 0.392800
0.0769 --- loss: 1.759332, loss_ss: 1.479278, loss_d: 0.280054
0.1153 --- loss: 1.468458, loss_ss: 1.270111, loss_d: 0.198346
0.1537 --- loss: 2.066064, loss_ss: 1.259614, loss_d: 0.806450
0.1922 --- loss: 1.503229, loss_ss: 1.225163, loss_d: 0.278066
0.2306 --- loss: 1.215305, loss_ss: 1.020477, loss_d: 0.194828
0.2690 --- loss: 1.470097, loss_ss: 1.096551, loss_d: 0.373545
0.3075 --- loss: 1.397212, loss_ss: 1.133354, loss_d: 0.263857
0.3459 --- loss: 1.593200, loss_ss: 1.342387, loss_d: 0.250813
0.3843 --- loss: 1.445652, loss_ss: 1.310915, loss_d: 0.134736
0.4228 --- loss: 1.329019, loss_ss: 1.030487, loss_d: 0.298532
0.4612 --- loss: 1.218732, loss_ss: 1.134892, loss_d: 0.083839
0.4996 --- loss: 2.143186, loss_ss: 1.467151, loss_d: 0.676035
0.5380 --- loss: 1.758906, loss_ss: 1.323979, loss_d: 0.434927
0.5765 --- loss: 1.232313, loss_ss: 1.089700, loss_d: 0.142613
0.6149 --- loss: 1.520146, loss_ss: 0.975848, loss_d: 0.544298
0.6533 --- loss: 1.537585, loss_ss: 1.095412, loss_d: 0.442174
0.6918 --- loss: 1.519555, loss_ss: 1.053599, loss_d: 0.465956
0.7302 --- loss: 1.194983, loss_ss: 0.965124, loss_d: 0.229859
0.7686 --- loss: 1.868699, loss_ss: 0.993200, loss_d: 0.875499
0.8071 --- loss: 1.692214, loss_ss: 0.960266, loss_d: 0.731948
0.8455 --- loss: 1.228241, loss_ss: 1.003204, loss_d: 0.225037
0.8839 --- loss: 1.350333, loss_ss: 0.998925, loss_d: 0.351408
0.9224 --- loss: 1.715237, loss_ss: 1.103706, loss_d: 0.611531
0.9608 --- loss: 1.245955, loss_ss: 1.117072, loss_d: 0.128882
0.9992 --- loss: 3.036011, loss_ss: 1.742397, loss_d: 1.293613
Epoch finished! Loss: 1.4893905410399804
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.049609, loss_ss: 0.965162, loss_d: 0.084447
0.0384 --- loss: 1.526240, loss_ss: 1.277349, loss_d: 0.248890
0.0769 --- loss: 1.337229, loss_ss: 0.937243, loss_d: 0.399986
0.1153 --- loss: 1.067278, loss_ss: 0.857160, loss_d: 0.210118
0.1537 --- loss: 1.146563, loss_ss: 0.942614, loss_d: 0.203949
0.1922 --- loss: 1.321557, loss_ss: 1.007189, loss_d: 0.314368
0.2306 --- loss: 1.238740, loss_ss: 1.014242, loss_d: 0.224498
0.2690 --- loss: 1.131910, loss_ss: 0.950533, loss_d: 0.181377
0.3075 --- loss: 1.195703, loss_ss: 0.899528, loss_d: 0.296175
0.3459 --- loss: 1.304487, loss_ss: 0.783021, loss_d: 0.521466
0.3843 --- loss: 1.360178, loss_ss: 0.974114, loss_d: 0.386064
0.4228 --- loss: 1.684593, loss_ss: 1.019344, loss_d: 0.665249
0.4612 --- loss: 1.036772, loss_ss: 0.780708, loss_d: 0.256064
0.4996 --- loss: 1.416832, loss_ss: 1.103218, loss_d: 0.313614
0.5380 --- loss: 1.431346, loss_ss: 1.195779, loss_d: 0.235567
0.5765 --- loss: 1.039505, loss_ss: 0.827259, loss_d: 0.212246
0.6149 --- loss: 1.522054, loss_ss: 1.112814, loss_d: 0.409240
0.6533 --- loss: 1.420932, loss_ss: 1.298342, loss_d: 0.122590
0.6918 --- loss: 1.220661, loss_ss: 0.983282, loss_d: 0.237379
0.7302 --- loss: 1.250841, loss_ss: 0.905025, loss_d: 0.345815
0.7686 --- loss: 1.281552, loss_ss: 0.772962, loss_d: 0.508591
0.8071 --- loss: 1.411330, loss_ss: 0.907300, loss_d: 0.504030
0.8455 --- loss: 1.326251, loss_ss: 0.858465, loss_d: 0.467786
0.8839 --- loss: 1.957815, loss_ss: 0.811850, loss_d: 1.145965
0.9224 --- loss: 1.089483, loss_ss: 0.816986, loss_d: 0.272497
0.9608 --- loss: 1.723159, loss_ss: 1.309176, loss_d: 0.413983
0.9992 --- loss: 2.568277, loss_ss: 1.151852, loss_d: 1.416425
Epoch finished! Loss: 1.3062925508389107
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.245864, loss_ss: 0.881770, loss_d: 0.364093
0.0384 --- loss: 1.543710, loss_ss: 1.121579, loss_d: 0.422131
0.0769 --- loss: 1.037241, loss_ss: 0.873885, loss_d: 0.163356
0.1153 --- loss: 0.933789, loss_ss: 0.799031, loss_d: 0.134757
0.1537 --- loss: 1.572535, loss_ss: 1.043774, loss_d: 0.528761
0.1922 --- loss: 1.166170, loss_ss: 1.099262, loss_d: 0.066909
0.2306 --- loss: 1.238640, loss_ss: 0.851883, loss_d: 0.386757
0.2690 --- loss: 1.001689, loss_ss: 0.913049, loss_d: 0.088641
0.3075 --- loss: 1.313384, loss_ss: 1.173309, loss_d: 0.140075
0.3459 --- loss: 1.442541, loss_ss: 0.872426, loss_d: 0.570115
0.3843 --- loss: 1.426197, loss_ss: 1.131633, loss_d: 0.294564
0.4228 --- loss: 1.454944, loss_ss: 1.220622, loss_d: 0.234323
0.4612 --- loss: 1.393473, loss_ss: 0.995873, loss_d: 0.397600
0.4996 --- loss: 2.316028, loss_ss: 0.999887, loss_d: 1.316141
0.5380 --- loss: 1.353025, loss_ss: 0.944509, loss_d: 0.408516
0.5765 --- loss: 1.249238, loss_ss: 0.960352, loss_d: 0.288886
0.6149 --- loss: 1.636512, loss_ss: 0.927170, loss_d: 0.709342
0.6533 --- loss: 1.077881, loss_ss: 0.983533, loss_d: 0.094348
0.6918 --- loss: 1.221783, loss_ss: 0.898912, loss_d: 0.322872
0.7302 --- loss: 0.886901, loss_ss: 0.851264, loss_d: 0.035637
0.7686 --- loss: 0.891898, loss_ss: 0.666984, loss_d: 0.224914
0.8071 --- loss: 1.212437, loss_ss: 0.771037, loss_d: 0.441401
0.8455 --- loss: 1.532896, loss_ss: 0.663500, loss_d: 0.869395
0.8839 --- loss: 1.087109, loss_ss: 0.980348, loss_d: 0.106762
0.9224 --- loss: 1.009055, loss_ss: 0.905616, loss_d: 0.103440
0.9608 --- loss: 1.513363, loss_ss: 0.964805, loss_d: 0.548557
0.9992 --- loss: 2.211815, loss_ss: 2.187164, loss_d: 0.024651
Epoch finished! Loss: 1.2124020979954646
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.223343, loss_ss: 1.057541, loss_d: 0.165801
0.0384 --- loss: 0.910969, loss_ss: 0.873911, loss_d: 0.037058
0.0769 --- loss: 1.041439, loss_ss: 0.765985, loss_d: 0.275454
0.1153 --- loss: 0.837076, loss_ss: 0.744748, loss_d: 0.092328
0.1537 --- loss: 1.470481, loss_ss: 0.950691, loss_d: 0.519790
0.1922 --- loss: 1.288018, loss_ss: 0.821655, loss_d: 0.466363
0.2306 --- loss: 0.811230, loss_ss: 0.778933, loss_d: 0.032297
0.2690 --- loss: 1.313616, loss_ss: 0.818016, loss_d: 0.495600
0.3075 --- loss: 1.591401, loss_ss: 0.738653, loss_d: 0.852749
0.3459 --- loss: 0.843294, loss_ss: 0.744512, loss_d: 0.098783
0.3843 --- loss: 1.103994, loss_ss: 0.781518, loss_d: 0.322476
0.4228 --- loss: 1.017051, loss_ss: 0.816193, loss_d: 0.200858
0.4612 --- loss: 1.176173, loss_ss: 0.874077, loss_d: 0.302096
0.4996 --- loss: 0.876529, loss_ss: 0.597942, loss_d: 0.278587
0.5380 --- loss: 1.019659, loss_ss: 0.861111, loss_d: 0.158548
0.5765 --- loss: 0.850463, loss_ss: 0.743501, loss_d: 0.106962
0.6149 --- loss: 1.458750, loss_ss: 0.865133, loss_d: 0.593617
0.6533 --- loss: 0.924054, loss_ss: 0.854606, loss_d: 0.069448
0.6918 --- loss: 0.921389, loss_ss: 0.639662, loss_d: 0.281727
0.7302 --- loss: 0.896641, loss_ss: 0.788072, loss_d: 0.108569
0.7686 --- loss: 1.347849, loss_ss: 1.049033, loss_d: 0.298816
0.8071 --- loss: 1.319089, loss_ss: 0.951003, loss_d: 0.368086
0.8455 --- loss: 1.154426, loss_ss: 0.885548, loss_d: 0.268878
0.8839 --- loss: 0.768619, loss_ss: 0.711810, loss_d: 0.056809
0.9224 --- loss: 1.722613, loss_ss: 0.933714, loss_d: 0.788899
0.9608 --- loss: 0.856260, loss_ss: 0.777046, loss_d: 0.079214
0.9992 --- loss: 3.612775, loss_ss: 1.902110, loss_d: 1.710665
Epoch finished! Loss: 1.1240535222567045
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.032049, loss_ss: 0.758625, loss_d: 0.273424
0.0384 --- loss: 0.866343, loss_ss: 0.731451, loss_d: 0.134891
0.0769 --- loss: 1.297792, loss_ss: 0.598879, loss_d: 0.698912
0.1153 --- loss: 1.485533, loss_ss: 1.109439, loss_d: 0.376094
0.1537 --- loss: 1.013559, loss_ss: 0.930766, loss_d: 0.082792
0.1922 --- loss: 0.897205, loss_ss: 0.836892, loss_d: 0.060313
0.2306 --- loss: 0.910381, loss_ss: 0.556995, loss_d: 0.353386
0.2690 --- loss: 0.838258, loss_ss: 0.798288, loss_d: 0.039970
0.3075 --- loss: 1.081518, loss_ss: 0.720682, loss_d: 0.360836
0.3459 --- loss: 1.203613, loss_ss: 1.169195, loss_d: 0.034418
0.3843 --- loss: 0.694122, loss_ss: 0.648986, loss_d: 0.045136
0.4228 --- loss: 0.761556, loss_ss: 0.656616, loss_d: 0.104940
0.4612 --- loss: 1.129303, loss_ss: 0.764128, loss_d: 0.365175
0.4996 --- loss: 1.003290, loss_ss: 0.769875, loss_d: 0.233415
0.5380 --- loss: 0.611876, loss_ss: 0.558646, loss_d: 0.053230
0.5765 --- loss: 0.881139, loss_ss: 0.782263, loss_d: 0.098877
0.6149 --- loss: 1.168616, loss_ss: 0.608933, loss_d: 0.559683
0.6533 --- loss: 1.152120, loss_ss: 1.064707, loss_d: 0.087412
0.6918 --- loss: 1.537756, loss_ss: 1.007851, loss_d: 0.529905
0.7302 --- loss: 0.952044, loss_ss: 0.723662, loss_d: 0.228382
0.7686 --- loss: 1.000367, loss_ss: 0.835203, loss_d: 0.165164
0.8071 --- loss: 1.147359, loss_ss: 0.879169, loss_d: 0.268190
0.8455 --- loss: 0.930594, loss_ss: 0.877380, loss_d: 0.053215
0.8839 --- loss: 1.315688, loss_ss: 0.964877, loss_d: 0.350811
0.9224 --- loss: 1.460658, loss_ss: 1.222339, loss_d: 0.238319
0.9608 --- loss: 1.144554, loss_ss: 1.012430, loss_d: 0.132124
0.9992 --- loss: 1.857272, loss_ss: 1.806474, loss_d: 0.050798
Epoch finished! Loss: 1.1019374913894213
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.867362, loss_ss: 0.812122, loss_d: 0.055240
0.0384 --- loss: 0.926398, loss_ss: 0.826613, loss_d: 0.099784
0.0769 --- loss: 0.928226, loss_ss: 0.850544, loss_d: 0.077683
0.1153 --- loss: 1.450331, loss_ss: 1.359746, loss_d: 0.090585
0.1537 --- loss: 0.841575, loss_ss: 0.820745, loss_d: 0.020830
0.1922 --- loss: 0.993448, loss_ss: 0.935621, loss_d: 0.057828
0.2306 --- loss: 0.804567, loss_ss: 0.619175, loss_d: 0.185392
0.2690 --- loss: 1.034186, loss_ss: 0.991679, loss_d: 0.042507
0.3075 --- loss: 0.921631, loss_ss: 0.860762, loss_d: 0.060869
0.3459 --- loss: 0.781254, loss_ss: 0.649913, loss_d: 0.131341
0.3843 --- loss: 1.348631, loss_ss: 1.046844, loss_d: 0.301787
0.4228 --- loss: 0.855768, loss_ss: 0.843294, loss_d: 0.012474
0.4612 --- loss: 0.856602, loss_ss: 0.719915, loss_d: 0.136687
0.4996 --- loss: 0.841826, loss_ss: 0.825695, loss_d: 0.016131
0.5380 --- loss: 1.160011, loss_ss: 0.971870, loss_d: 0.188141
0.5765 --- loss: 0.824224, loss_ss: 0.691893, loss_d: 0.132331
0.6149 --- loss: 0.969906, loss_ss: 0.813037, loss_d: 0.156869
0.6533 --- loss: 1.063828, loss_ss: 0.914384, loss_d: 0.149444
0.6918 --- loss: 0.975096, loss_ss: 0.773878, loss_d: 0.201218
0.7302 --- loss: 0.995146, loss_ss: 0.982668, loss_d: 0.012478
0.7686 --- loss: 0.855275, loss_ss: 0.787753, loss_d: 0.067522
0.8071 --- loss: 0.945127, loss_ss: 0.937905, loss_d: 0.007222
0.8455 --- loss: 1.505185, loss_ss: 0.944432, loss_d: 0.560753
0.8839 --- loss: 1.013035, loss_ss: 0.906688, loss_d: 0.106348
0.9224 --- loss: 1.080283, loss_ss: 0.801172, loss_d: 0.279111
0.9608 --- loss: 0.718447, loss_ss: 0.639765, loss_d: 0.078682
0.9992 --- loss: 1.490220, loss_ss: 1.476620, loss_d: 0.013600
Epoch finished! Loss: 1.030267567359484
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.855540, loss_ss: 0.806232, loss_d: 0.049308
0.0384 --- loss: 0.891220, loss_ss: 0.683401, loss_d: 0.207818
0.0769 --- loss: 0.889770, loss_ss: 0.817511, loss_d: 0.072259
0.1153 --- loss: 0.554390, loss_ss: 0.531454, loss_d: 0.022936
0.1537 --- loss: 0.616120, loss_ss: 0.602102, loss_d: 0.014017
0.1922 --- loss: 0.996868, loss_ss: 0.706023, loss_d: 0.290845
0.2306 --- loss: 0.806617, loss_ss: 0.740191, loss_d: 0.066426
0.2690 --- loss: 0.921407, loss_ss: 0.666621, loss_d: 0.254786
0.3075 --- loss: 1.231726, loss_ss: 0.881145, loss_d: 0.350581
0.3459 --- loss: 0.825046, loss_ss: 0.611848, loss_d: 0.213198
0.3843 --- loss: 0.690267, loss_ss: 0.675153, loss_d: 0.015115
0.4228 --- loss: 0.987665, loss_ss: 0.644494, loss_d: 0.343171
0.4612 --- loss: 1.081792, loss_ss: 1.037213, loss_d: 0.044579
0.4996 --- loss: 0.839461, loss_ss: 0.618123, loss_d: 0.221338
0.5380 --- loss: 0.945961, loss_ss: 0.888392, loss_d: 0.057568
0.5765 --- loss: 0.785939, loss_ss: 0.726217, loss_d: 0.059723
0.6149 --- loss: 0.819434, loss_ss: 0.690005, loss_d: 0.129429
0.6533 --- loss: 0.727317, loss_ss: 0.716026, loss_d: 0.011291
0.6918 --- loss: 0.908182, loss_ss: 0.887017, loss_d: 0.021165
0.7302 --- loss: 0.839324, loss_ss: 0.796535, loss_d: 0.042789
0.7686 --- loss: 1.335152, loss_ss: 0.835070, loss_d: 0.500082
0.8071 --- loss: 0.848271, loss_ss: 0.745678, loss_d: 0.102593
0.8455 --- loss: 0.893120, loss_ss: 0.807847, loss_d: 0.085273
0.8839 --- loss: 0.878292, loss_ss: 0.727712, loss_d: 0.150581
0.9224 --- loss: 1.020142, loss_ss: 0.993430, loss_d: 0.026712
0.9608 --- loss: 1.083834, loss_ss: 0.675146, loss_d: 0.408688
0.9992 --- loss: 2.096365, loss_ss: 2.072570, loss_d: 0.023795
Epoch finished! Loss: 0.9958587421820714
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.836867, loss_ss: 0.648769, loss_d: 0.188097
0.0384 --- loss: 0.715703, loss_ss: 0.663535, loss_d: 0.052168
0.0769 --- loss: 0.713846, loss_ss: 0.702996, loss_d: 0.010849
0.1153 --- loss: 1.284981, loss_ss: 1.039736, loss_d: 0.245245
0.1537 --- loss: 1.027353, loss_ss: 1.010703, loss_d: 0.016650
0.1922 --- loss: 0.936892, loss_ss: 0.761840, loss_d: 0.175052
0.2306 --- loss: 1.132261, loss_ss: 0.988452, loss_d: 0.143809
0.2690 --- loss: 1.412390, loss_ss: 0.813757, loss_d: 0.598633
0.3075 --- loss: 1.169232, loss_ss: 1.108670, loss_d: 0.060562
0.3459 --- loss: 1.102389, loss_ss: 0.831124, loss_d: 0.271265
0.3843 --- loss: 1.137982, loss_ss: 0.989558, loss_d: 0.148424
0.4228 --- loss: 1.150820, loss_ss: 1.092804, loss_d: 0.058016
0.4612 --- loss: 1.042528, loss_ss: 0.900966, loss_d: 0.141561
0.4996 --- loss: 1.455931, loss_ss: 1.394321, loss_d: 0.061610
0.5380 --- loss: 1.016568, loss_ss: 0.834531, loss_d: 0.182037
0.5765 --- loss: 0.633839, loss_ss: 0.590891, loss_d: 0.042948
0.6149 --- loss: 1.297269, loss_ss: 0.703847, loss_d: 0.593423
0.6533 --- loss: 0.858991, loss_ss: 0.625494, loss_d: 0.233496
0.6918 --- loss: 0.734271, loss_ss: 0.716686, loss_d: 0.017585
0.7302 --- loss: 1.004509, loss_ss: 0.998844, loss_d: 0.005666
0.7686 --- loss: 0.789717, loss_ss: 0.676918, loss_d: 0.112799
0.8071 --- loss: 0.662162, loss_ss: 0.637192, loss_d: 0.024969
0.8455 --- loss: 0.677305, loss_ss: 0.615375, loss_d: 0.061930
0.8839 --- loss: 1.069590, loss_ss: 1.013093, loss_d: 0.056498
0.9224 --- loss: 0.890055, loss_ss: 0.779326, loss_d: 0.110729
0.9608 --- loss: 0.804598, loss_ss: 0.742189, loss_d: 0.062408
0.9992 --- loss: 1.212209, loss_ss: 1.208050, loss_d: 0.004160
Epoch finished! Loss: 0.9419925095943305
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.722553, loss_ss: 0.684003, loss_d: 0.038550
0.0384 --- loss: 0.656018, loss_ss: 0.652863, loss_d: 0.003155
0.0769 --- loss: 0.654895, loss_ss: 0.590142, loss_d: 0.064753
0.1153 --- loss: 0.907841, loss_ss: 0.899348, loss_d: 0.008493
0.1537 --- loss: 1.219673, loss_ss: 1.177379, loss_d: 0.042294
0.1922 --- loss: 0.789182, loss_ss: 0.765999, loss_d: 0.023183
0.2306 --- loss: 0.725760, loss_ss: 0.664958, loss_d: 0.060802
0.2690 --- loss: 0.857497, loss_ss: 0.793442, loss_d: 0.064055
0.3075 --- loss: 0.783414, loss_ss: 0.755354, loss_d: 0.028060
0.3459 --- loss: 0.677962, loss_ss: 0.648147, loss_d: 0.029815
0.3843 --- loss: 0.829811, loss_ss: 0.586742, loss_d: 0.243068
0.4228 --- loss: 0.704740, loss_ss: 0.690380, loss_d: 0.014360
0.4612 --- loss: 0.957039, loss_ss: 0.914105, loss_d: 0.042934
0.4996 --- loss: 1.192009, loss_ss: 1.031615, loss_d: 0.160394
0.5380 --- loss: 0.945301, loss_ss: 0.757650, loss_d: 0.187650
0.5765 --- loss: 0.727926, loss_ss: 0.707553, loss_d: 0.020373
0.6149 --- loss: 1.126934, loss_ss: 1.000981, loss_d: 0.125953
0.6533 --- loss: 0.986132, loss_ss: 0.952531, loss_d: 0.033601
0.6918 --- loss: 1.021531, loss_ss: 0.768620, loss_d: 0.252911
0.7302 --- loss: 0.954052, loss_ss: 0.936920, loss_d: 0.017132
0.7686 --- loss: 1.100949, loss_ss: 1.015734, loss_d: 0.085215
0.8071 --- loss: 0.911002, loss_ss: 0.844646, loss_d: 0.066355
0.8455 --- loss: 0.813527, loss_ss: 0.653476, loss_d: 0.160051
0.8839 --- loss: 1.079461, loss_ss: 0.767243, loss_d: 0.312218
0.9224 --- loss: 1.112816, loss_ss: 0.681056, loss_d: 0.431760
0.9608 --- loss: 0.911799, loss_ss: 0.873902, loss_d: 0.037897
0.9992 --- loss: 3.175756, loss_ss: 3.134214, loss_d: 0.041542
Epoch finished! Loss: 0.9385596144657868
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7518518518518519
             precision    recall  f1-score   support

        0.0       0.86      0.42      0.56       260
        1.0       0.62      0.81      0.70       248
        2.0       0.93      0.91      0.92       375
        3.0       1.00      0.86      0.93       169
        4.0       0.12      0.50      0.19        28

avg / total       0.83      0.75      0.77      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  84.35  41.54   97.93   86.40     56.10
1  84.35  81.05   85.34   62.23     70.40
2  94.63  91.47   96.31   92.95     92.20
3  97.87  86.39  100.00  100.00     92.70
4  89.17  50.00   90.21   11.97     19.31
Total accuracy: 75.19%
Average sen: 70.09%
Average spec: 93.96%
Macro f1-score: 66.14%
Diagnosis acc on 15mins: 1.0
[0.97616494 0.99901247 0.96379882 0.98866975 0.98272336 0.96963239
 0.99312782 0.9947561  0.99408168 0.99936837 0.99567479 0.9705084
 0.85613537 0.99534374 0.99687648 0.99809259 0.99984002 0.99205184
 0.99927026 0.99932551 0.99913496 0.99743843 0.99999011 0.99982846
 0.99850947 0.99632925 0.99941134 0.99893636 0.99792755 0.99869835
 0.9977513  0.99623543 0.84068459 0.99530679 0.99642581 0.98405153]
pred: 0.9850309557384915, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.271017, loss_ss: 1.554479, loss_d: 0.716538
0.0384 --- loss: 2.020827, loss_ss: 1.522920, loss_d: 0.497907
0.0768 --- loss: 1.978773, loss_ss: 1.588436, loss_d: 0.390336
0.1152 --- loss: 2.535751, loss_ss: 1.581479, loss_d: 0.954273
0.1536 --- loss: 1.876865, loss_ss: 1.561321, loss_d: 0.315543
0.1919 --- loss: 2.180191, loss_ss: 1.505561, loss_d: 0.674630
0.2303 --- loss: 1.891505, loss_ss: 1.436427, loss_d: 0.455078
0.2687 --- loss: 1.771836, loss_ss: 1.481085, loss_d: 0.290751
0.3071 --- loss: 2.112630, loss_ss: 1.275407, loss_d: 0.837223
0.3455 --- loss: 1.868379, loss_ss: 1.385345, loss_d: 0.483034
0.3839 --- loss: 2.105450, loss_ss: 1.389681, loss_d: 0.715770
0.4223 --- loss: 2.202159, loss_ss: 1.495450, loss_d: 0.706710
0.4607 --- loss: 2.124285, loss_ss: 1.646612, loss_d: 0.477673
0.4990 --- loss: 2.227795, loss_ss: 1.392135, loss_d: 0.835660
0.5374 --- loss: 2.167799, loss_ss: 1.473668, loss_d: 0.694131
0.5758 --- loss: 2.414052, loss_ss: 1.515976, loss_d: 0.898076
0.6142 --- loss: 1.807624, loss_ss: 1.186982, loss_d: 0.620642
0.6526 --- loss: 1.719767, loss_ss: 1.349066, loss_d: 0.370701
0.6910 --- loss: 1.855736, loss_ss: 1.338268, loss_d: 0.517469
0.7294 --- loss: 2.100722, loss_ss: 1.487965, loss_d: 0.612758
0.7678 --- loss: 1.774366, loss_ss: 1.243558, loss_d: 0.530808
0.8061 --- loss: 1.849706, loss_ss: 1.278558, loss_d: 0.571148
0.8445 --- loss: 2.096705, loss_ss: 1.611797, loss_d: 0.484907
0.8829 --- loss: 1.550501, loss_ss: 1.184685, loss_d: 0.365816
0.9213 --- loss: 1.708917, loss_ss: 1.315107, loss_d: 0.393810
0.9597 --- loss: 1.750636, loss_ss: 1.393987, loss_d: 0.356649
0.9981 --- loss: 2.327855, loss_ss: 1.551399, loss_d: 0.776456
Epoch finished! Loss: 1.9834270587334266
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.679806, loss_ss: 1.285682, loss_d: 0.394124
0.0384 --- loss: 1.904146, loss_ss: 1.451499, loss_d: 0.452647
0.0768 --- loss: 1.723221, loss_ss: 1.381789, loss_d: 0.341432
0.1152 --- loss: 1.640023, loss_ss: 1.406518, loss_d: 0.233505
0.1536 --- loss: 1.457969, loss_ss: 1.204947, loss_d: 0.253022
0.1919 --- loss: 1.800045, loss_ss: 1.166053, loss_d: 0.633992
0.2303 --- loss: 1.662624, loss_ss: 1.242802, loss_d: 0.419822
0.2687 --- loss: 1.545193, loss_ss: 1.176247, loss_d: 0.368946
0.3071 --- loss: 1.625215, loss_ss: 1.372162, loss_d: 0.253053
0.3455 --- loss: 1.514658, loss_ss: 1.174866, loss_d: 0.339792
0.3839 --- loss: 1.520842, loss_ss: 1.265491, loss_d: 0.255351
0.4223 --- loss: 1.616165, loss_ss: 1.277595, loss_d: 0.338569
0.4607 --- loss: 1.357968, loss_ss: 1.140356, loss_d: 0.217612
0.4990 --- loss: 1.821405, loss_ss: 1.470258, loss_d: 0.351147
0.5374 --- loss: 1.676094, loss_ss: 1.383133, loss_d: 0.292962
0.5758 --- loss: 1.402700, loss_ss: 1.068061, loss_d: 0.334639
0.6142 --- loss: 1.586965, loss_ss: 1.252115, loss_d: 0.334850
0.6526 --- loss: 1.421107, loss_ss: 1.115679, loss_d: 0.305428
0.6910 --- loss: 1.528942, loss_ss: 1.127516, loss_d: 0.401427
0.7294 --- loss: 1.697332, loss_ss: 1.089317, loss_d: 0.608015
0.7678 --- loss: 1.454952, loss_ss: 1.054315, loss_d: 0.400637
0.8061 --- loss: 1.611450, loss_ss: 1.342623, loss_d: 0.268827
0.8445 --- loss: 1.455400, loss_ss: 1.102178, loss_d: 0.353222
0.8829 --- loss: 1.561196, loss_ss: 1.093297, loss_d: 0.467899
0.9213 --- loss: 1.488658, loss_ss: 1.099000, loss_d: 0.389658
0.9597 --- loss: 1.437310, loss_ss: 1.164511, loss_d: 0.272799
0.9981 --- loss: 1.348708, loss_ss: 1.058837, loss_d: 0.289871
Epoch finished! Loss: 1.5959366151919732
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.414821, loss_ss: 1.141209, loss_d: 0.273612
0.0384 --- loss: 1.879136, loss_ss: 0.950399, loss_d: 0.928737
0.0768 --- loss: 2.019953, loss_ss: 0.930614, loss_d: 1.089340
0.1152 --- loss: 1.356576, loss_ss: 0.984629, loss_d: 0.371947
0.1536 --- loss: 1.234742, loss_ss: 1.074007, loss_d: 0.160736
0.1919 --- loss: 1.487741, loss_ss: 1.102457, loss_d: 0.385284
0.2303 --- loss: 1.197097, loss_ss: 0.946396, loss_d: 0.250701
0.2687 --- loss: 1.370721, loss_ss: 1.094588, loss_d: 0.276133
0.3071 --- loss: 1.333512, loss_ss: 1.163752, loss_d: 0.169760
0.3455 --- loss: 1.394131, loss_ss: 1.151990, loss_d: 0.242141
0.3839 --- loss: 1.789905, loss_ss: 1.157995, loss_d: 0.631910
0.4223 --- loss: 2.102351, loss_ss: 0.918982, loss_d: 1.183370
0.4607 --- loss: 1.384902, loss_ss: 1.045538, loss_d: 0.339363
0.4990 --- loss: 1.602446, loss_ss: 0.805831, loss_d: 0.796615
0.5374 --- loss: 1.107611, loss_ss: 0.804201, loss_d: 0.303410
0.5758 --- loss: 1.658197, loss_ss: 1.065715, loss_d: 0.592482
0.6142 --- loss: 1.165384, loss_ss: 0.880310, loss_d: 0.285075
0.6526 --- loss: 1.121947, loss_ss: 0.945121, loss_d: 0.176827
0.6910 --- loss: 1.624840, loss_ss: 1.077727, loss_d: 0.547113
0.7294 --- loss: 1.208284, loss_ss: 0.902737, loss_d: 0.305547
0.7678 --- loss: 1.149390, loss_ss: 0.913965, loss_d: 0.235426
0.8061 --- loss: 1.565590, loss_ss: 0.842127, loss_d: 0.723463
0.8445 --- loss: 1.069774, loss_ss: 0.799457, loss_d: 0.270317
0.8829 --- loss: 1.694344, loss_ss: 0.875924, loss_d: 0.818420
0.9213 --- loss: 1.103941, loss_ss: 0.970436, loss_d: 0.133505
0.9597 --- loss: 1.142470, loss_ss: 0.856624, loss_d: 0.285846
0.9981 --- loss: 1.936094, loss_ss: 1.691095, loss_d: 0.244999
Epoch finished! Loss: 1.3324490079512963
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.363668, loss_ss: 0.992193, loss_d: 0.371475
0.0384 --- loss: 1.389292, loss_ss: 1.324889, loss_d: 0.064403
0.0768 --- loss: 0.882427, loss_ss: 0.823550, loss_d: 0.058878
0.1152 --- loss: 1.421265, loss_ss: 1.092708, loss_d: 0.328558
0.1536 --- loss: 1.167604, loss_ss: 0.922035, loss_d: 0.245570
0.1919 --- loss: 0.911813, loss_ss: 0.691485, loss_d: 0.220328
0.2303 --- loss: 1.279554, loss_ss: 1.126463, loss_d: 0.153091
0.2687 --- loss: 1.857513, loss_ss: 0.977944, loss_d: 0.879569
0.3071 --- loss: 1.108590, loss_ss: 0.885005, loss_d: 0.223585
0.3455 --- loss: 1.134439, loss_ss: 1.025258, loss_d: 0.109181
0.3839 --- loss: 1.106709, loss_ss: 0.837208, loss_d: 0.269501
0.4223 --- loss: 1.010147, loss_ss: 0.802957, loss_d: 0.207190
0.4607 --- loss: 1.403968, loss_ss: 1.193922, loss_d: 0.210046
0.4990 --- loss: 0.880199, loss_ss: 0.777141, loss_d: 0.103059
0.5374 --- loss: 1.194195, loss_ss: 0.811036, loss_d: 0.383159
0.5758 --- loss: 0.983081, loss_ss: 0.828193, loss_d: 0.154888
0.6142 --- loss: 1.151716, loss_ss: 0.751770, loss_d: 0.399946
0.6526 --- loss: 1.324978, loss_ss: 0.915545, loss_d: 0.409432
0.6910 --- loss: 1.355575, loss_ss: 1.160153, loss_d: 0.195422
0.7294 --- loss: 1.438808, loss_ss: 1.146198, loss_d: 0.292610
0.7678 --- loss: 1.311916, loss_ss: 1.032576, loss_d: 0.279341
0.8061 --- loss: 1.610443, loss_ss: 1.308329, loss_d: 0.302113
0.8445 --- loss: 1.254092, loss_ss: 1.046939, loss_d: 0.207153
0.8829 --- loss: 1.360996, loss_ss: 0.825786, loss_d: 0.535210
0.9213 --- loss: 1.047268, loss_ss: 0.798524, loss_d: 0.248745
0.9597 --- loss: 1.098612, loss_ss: 0.960602, loss_d: 0.138010
0.9981 --- loss: 0.881518, loss_ss: 0.697417, loss_d: 0.184101
Epoch finished! Loss: 1.221006822356811
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.105151, loss_ss: 0.810196, loss_d: 0.294955
0.0384 --- loss: 1.447184, loss_ss: 0.990466, loss_d: 0.456718
0.0768 --- loss: 1.061892, loss_ss: 0.825653, loss_d: 0.236238
0.1152 --- loss: 1.033785, loss_ss: 0.811957, loss_d: 0.221828
0.1536 --- loss: 0.928798, loss_ss: 0.842215, loss_d: 0.086582
0.1919 --- loss: 1.038688, loss_ss: 0.716631, loss_d: 0.322057
0.2303 --- loss: 1.062677, loss_ss: 0.812809, loss_d: 0.249867
0.2687 --- loss: 1.099053, loss_ss: 0.989491, loss_d: 0.109562
0.3071 --- loss: 1.075455, loss_ss: 0.960301, loss_d: 0.115154
0.3455 --- loss: 0.779592, loss_ss: 0.660169, loss_d: 0.119424
0.3839 --- loss: 1.031102, loss_ss: 0.836326, loss_d: 0.194775
0.4223 --- loss: 0.757659, loss_ss: 0.704806, loss_d: 0.052853
0.4607 --- loss: 0.873624, loss_ss: 0.808412, loss_d: 0.065211
0.4990 --- loss: 1.342487, loss_ss: 0.838522, loss_d: 0.503965
0.5374 --- loss: 1.297697, loss_ss: 0.940044, loss_d: 0.357653
0.5758 --- loss: 0.934156, loss_ss: 0.783218, loss_d: 0.150938
0.6142 --- loss: 0.790467, loss_ss: 0.666883, loss_d: 0.123584
0.6526 --- loss: 1.059410, loss_ss: 0.727576, loss_d: 0.331834
0.6910 --- loss: 1.146166, loss_ss: 0.715547, loss_d: 0.430619
0.7294 --- loss: 1.221578, loss_ss: 0.999930, loss_d: 0.221648
0.7678 --- loss: 0.718473, loss_ss: 0.662155, loss_d: 0.056318
0.8061 --- loss: 1.189208, loss_ss: 1.031552, loss_d: 0.157656
0.8445 --- loss: 1.540158, loss_ss: 1.152283, loss_d: 0.387875
0.8829 --- loss: 0.939468, loss_ss: 0.869419, loss_d: 0.070049
0.9213 --- loss: 0.740573, loss_ss: 0.653936, loss_d: 0.086637
0.9597 --- loss: 1.133410, loss_ss: 0.887828, loss_d: 0.245582
0.9981 --- loss: 1.653792, loss_ss: 1.565577, loss_d: 0.088215
Epoch finished! Loss: 1.1385181436171898
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.847154, loss_ss: 0.787054, loss_d: 0.060099
0.0384 --- loss: 0.749868, loss_ss: 0.675520, loss_d: 0.074347
0.0768 --- loss: 1.394374, loss_ss: 0.936074, loss_d: 0.458300
0.1152 --- loss: 0.907470, loss_ss: 0.767660, loss_d: 0.139810
0.1536 --- loss: 0.961370, loss_ss: 0.754865, loss_d: 0.206505
0.1919 --- loss: 1.290574, loss_ss: 1.029188, loss_d: 0.261386
0.2303 --- loss: 1.193349, loss_ss: 0.711718, loss_d: 0.481630
0.2687 --- loss: 0.993772, loss_ss: 0.843083, loss_d: 0.150689
0.3071 --- loss: 0.815543, loss_ss: 0.735387, loss_d: 0.080156
0.3455 --- loss: 1.135090, loss_ss: 0.778774, loss_d: 0.356316
0.3839 --- loss: 0.803859, loss_ss: 0.758488, loss_d: 0.045371
0.4223 --- loss: 0.856916, loss_ss: 0.764900, loss_d: 0.092016
0.4607 --- loss: 1.644471, loss_ss: 0.930866, loss_d: 0.713605
0.4990 --- loss: 0.815817, loss_ss: 0.608967, loss_d: 0.206850
0.5374 --- loss: 1.271108, loss_ss: 1.091327, loss_d: 0.179781
0.5758 --- loss: 0.907172, loss_ss: 0.729726, loss_d: 0.177446
0.6142 --- loss: 1.048473, loss_ss: 0.966356, loss_d: 0.082117
0.6526 --- loss: 0.816262, loss_ss: 0.504949, loss_d: 0.311313
0.6910 --- loss: 1.164036, loss_ss: 0.862515, loss_d: 0.301520
0.7294 --- loss: 0.952504, loss_ss: 0.891204, loss_d: 0.061300
0.7678 --- loss: 1.121114, loss_ss: 0.960921, loss_d: 0.160193
0.8061 --- loss: 0.987326, loss_ss: 0.905176, loss_d: 0.082150
0.8445 --- loss: 1.235580, loss_ss: 1.203563, loss_d: 0.032017
0.8829 --- loss: 1.329907, loss_ss: 1.288793, loss_d: 0.041114
0.9213 --- loss: 1.713228, loss_ss: 1.077111, loss_d: 0.636116
0.9597 --- loss: 1.289178, loss_ss: 1.089529, loss_d: 0.199649
0.9981 --- loss: 1.129287, loss_ss: 0.816539, loss_d: 0.312748
Epoch finished! Loss: 1.074469806597783
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.119798, loss_ss: 0.749609, loss_d: 0.370189
0.0384 --- loss: 1.348852, loss_ss: 0.888282, loss_d: 0.460570
0.0768 --- loss: 0.979020, loss_ss: 0.594513, loss_d: 0.384507
0.1152 --- loss: 0.831056, loss_ss: 0.726171, loss_d: 0.104884
0.1536 --- loss: 1.024807, loss_ss: 0.954036, loss_d: 0.070771
0.1919 --- loss: 1.289812, loss_ss: 0.858308, loss_d: 0.431504
0.2303 --- loss: 0.803312, loss_ss: 0.720511, loss_d: 0.082801
0.2687 --- loss: 0.978896, loss_ss: 0.951103, loss_d: 0.027793
0.3071 --- loss: 0.965155, loss_ss: 0.940633, loss_d: 0.024522
0.3455 --- loss: 0.950415, loss_ss: 0.830972, loss_d: 0.119442
0.3839 --- loss: 0.929143, loss_ss: 0.647732, loss_d: 0.281411
0.4223 --- loss: 0.949875, loss_ss: 0.738661, loss_d: 0.211214
0.4607 --- loss: 2.754806, loss_ss: 0.703660, loss_d: 2.051146
0.4990 --- loss: 1.311542, loss_ss: 1.095829, loss_d: 0.215713
0.5374 --- loss: 1.527883, loss_ss: 0.857047, loss_d: 0.670836
0.5758 --- loss: 0.964997, loss_ss: 0.764019, loss_d: 0.200978
0.6142 --- loss: 0.951549, loss_ss: 0.705872, loss_d: 0.245676
0.6526 --- loss: 1.088312, loss_ss: 0.841984, loss_d: 0.246328
0.6910 --- loss: 0.963643, loss_ss: 0.945672, loss_d: 0.017971
0.7294 --- loss: 1.021344, loss_ss: 0.688916, loss_d: 0.332428
0.7678 --- loss: 1.153913, loss_ss: 0.876745, loss_d: 0.277168
0.8061 --- loss: 0.833234, loss_ss: 0.775463, loss_d: 0.057771
0.8445 --- loss: 1.164254, loss_ss: 0.926406, loss_d: 0.237848
0.8829 --- loss: 1.319716, loss_ss: 0.625217, loss_d: 0.694500
0.9213 --- loss: 0.753472, loss_ss: 0.682103, loss_d: 0.071370
0.9597 --- loss: 1.078456, loss_ss: 0.875762, loss_d: 0.202694
0.9981 --- loss: 1.153252, loss_ss: 1.089689, loss_d: 0.063563
Epoch finished! Loss: 1.0459700531684435
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.834476, loss_ss: 0.761123, loss_d: 0.073353
0.0384 --- loss: 0.639635, loss_ss: 0.489191, loss_d: 0.150444
0.0768 --- loss: 0.897934, loss_ss: 0.827932, loss_d: 0.070002
0.1152 --- loss: 0.968454, loss_ss: 0.797036, loss_d: 0.171417
0.1536 --- loss: 0.976970, loss_ss: 0.807352, loss_d: 0.169618
0.1919 --- loss: 1.213508, loss_ss: 1.002653, loss_d: 0.210855
0.2303 --- loss: 0.992930, loss_ss: 0.618260, loss_d: 0.374670
0.2687 --- loss: 1.092601, loss_ss: 0.668674, loss_d: 0.423927
0.3071 --- loss: 0.755948, loss_ss: 0.719704, loss_d: 0.036244
0.3455 --- loss: 1.078113, loss_ss: 1.049884, loss_d: 0.028229
0.3839 --- loss: 1.182552, loss_ss: 0.880085, loss_d: 0.302467
0.4223 --- loss: 0.988066, loss_ss: 0.852468, loss_d: 0.135598
0.4607 --- loss: 0.904987, loss_ss: 0.604298, loss_d: 0.300689
0.4990 --- loss: 1.126089, loss_ss: 1.049977, loss_d: 0.076111
0.5374 --- loss: 1.014397, loss_ss: 0.930528, loss_d: 0.083869
0.5758 --- loss: 1.512843, loss_ss: 0.688816, loss_d: 0.824027
0.6142 --- loss: 0.657559, loss_ss: 0.498176, loss_d: 0.159383
0.6526 --- loss: 0.971459, loss_ss: 0.809614, loss_d: 0.161844
0.6910 --- loss: 0.785424, loss_ss: 0.769208, loss_d: 0.016216
0.7294 --- loss: 0.739088, loss_ss: 0.541457, loss_d: 0.197631
0.7678 --- loss: 1.031817, loss_ss: 0.850354, loss_d: 0.181463
0.8061 --- loss: 0.913955, loss_ss: 0.800445, loss_d: 0.113510
0.8445 --- loss: 0.698447, loss_ss: 0.650933, loss_d: 0.047514
0.8829 --- loss: 0.907283, loss_ss: 0.812289, loss_d: 0.094993
0.9213 --- loss: 1.164190, loss_ss: 1.093025, loss_d: 0.071165
0.9597 --- loss: 1.153899, loss_ss: 1.126710, loss_d: 0.027189
0.9981 --- loss: 1.817980, loss_ss: 1.779838, loss_d: 0.038141
Epoch finished! Loss: 0.9876618137726417
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.948522, loss_ss: 0.899134, loss_d: 0.049387
0.0384 --- loss: 0.691760, loss_ss: 0.599665, loss_d: 0.092095
0.0768 --- loss: 1.049203, loss_ss: 0.700739, loss_d: 0.348464
0.1152 --- loss: 0.802081, loss_ss: 0.774677, loss_d: 0.027405
0.1536 --- loss: 1.152241, loss_ss: 0.661344, loss_d: 0.490898
0.1919 --- loss: 1.002400, loss_ss: 0.942376, loss_d: 0.060024
0.2303 --- loss: 0.704923, loss_ss: 0.668237, loss_d: 0.036686
0.2687 --- loss: 0.965781, loss_ss: 0.695017, loss_d: 0.270764
0.3071 --- loss: 1.130870, loss_ss: 0.837006, loss_d: 0.293864
0.3455 --- loss: 0.652218, loss_ss: 0.565013, loss_d: 0.087205
0.3839 --- loss: 0.776456, loss_ss: 0.756392, loss_d: 0.020064
0.4223 --- loss: 0.735636, loss_ss: 0.697813, loss_d: 0.037822
0.4607 --- loss: 0.653742, loss_ss: 0.563864, loss_d: 0.089878
0.4990 --- loss: 0.698683, loss_ss: 0.660214, loss_d: 0.038469
0.5374 --- loss: 1.285300, loss_ss: 1.084648, loss_d: 0.200651
0.5758 --- loss: 0.721712, loss_ss: 0.603322, loss_d: 0.118390
0.6142 --- loss: 0.886098, loss_ss: 0.760348, loss_d: 0.125750
0.6526 --- loss: 1.051216, loss_ss: 1.000557, loss_d: 0.050660
0.6910 --- loss: 0.741932, loss_ss: 0.686531, loss_d: 0.055402
0.7294 --- loss: 0.962302, loss_ss: 0.939979, loss_d: 0.022323
0.7678 --- loss: 0.818494, loss_ss: 0.764997, loss_d: 0.053497
0.8061 --- loss: 0.878940, loss_ss: 0.860670, loss_d: 0.018270
0.8445 --- loss: 1.047798, loss_ss: 0.987134, loss_d: 0.060664
0.8829 --- loss: 1.012799, loss_ss: 0.984630, loss_d: 0.028169
0.9213 --- loss: 0.625691, loss_ss: 0.572393, loss_d: 0.053298
0.9597 --- loss: 0.928028, loss_ss: 0.830228, loss_d: 0.097799
0.9981 --- loss: 1.011234, loss_ss: 0.991850, loss_d: 0.019384
Epoch finished! Loss: 0.9567209016818267
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.975438, loss_ss: 0.956258, loss_d: 0.019180
0.0384 --- loss: 1.054287, loss_ss: 1.045076, loss_d: 0.009211
0.0768 --- loss: 0.832055, loss_ss: 0.696666, loss_d: 0.135389
0.1152 --- loss: 0.903649, loss_ss: 0.837459, loss_d: 0.066190
0.1536 --- loss: 1.167668, loss_ss: 1.097324, loss_d: 0.070343
0.1919 --- loss: 0.838377, loss_ss: 0.822016, loss_d: 0.016361
0.2303 --- loss: 0.626349, loss_ss: 0.576131, loss_d: 0.050218
0.2687 --- loss: 1.312889, loss_ss: 0.710006, loss_d: 0.602884
0.3071 --- loss: 0.841671, loss_ss: 0.668223, loss_d: 0.173448
0.3455 --- loss: 0.846941, loss_ss: 0.527080, loss_d: 0.319861
0.3839 --- loss: 0.643961, loss_ss: 0.582699, loss_d: 0.061262
0.4223 --- loss: 1.034052, loss_ss: 0.922657, loss_d: 0.111395
0.4607 --- loss: 0.680774, loss_ss: 0.630888, loss_d: 0.049886
0.4990 --- loss: 0.851843, loss_ss: 0.842094, loss_d: 0.009749
0.5374 --- loss: 1.199444, loss_ss: 1.198161, loss_d: 0.001282
0.5758 --- loss: 1.336100, loss_ss: 0.921074, loss_d: 0.415025
0.6142 --- loss: 1.178177, loss_ss: 1.021509, loss_d: 0.156668
0.6526 --- loss: 0.872548, loss_ss: 0.851023, loss_d: 0.021525
0.6910 --- loss: 0.794121, loss_ss: 0.606666, loss_d: 0.187455
0.7294 --- loss: 0.747716, loss_ss: 0.745779, loss_d: 0.001938
0.7678 --- loss: 0.742933, loss_ss: 0.726649, loss_d: 0.016283
0.8061 --- loss: 0.885519, loss_ss: 0.874596, loss_d: 0.010923
0.8445 --- loss: 0.904138, loss_ss: 0.843720, loss_d: 0.060418
0.8829 --- loss: 0.841101, loss_ss: 0.776240, loss_d: 0.064860
0.9213 --- loss: 1.144354, loss_ss: 0.878933, loss_d: 0.265421
0.9597 --- loss: 0.877365, loss_ss: 0.843525, loss_d: 0.033839
0.9981 --- loss: 0.958738, loss_ss: 0.922036, loss_d: 0.036701
Epoch finished! Loss: 0.9374723189152204
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6373737373737374
             precision    recall  f1-score   support

        0.0       0.45      0.28      0.34        80
        1.0       0.10      0.63      0.17        38
        2.0       0.86      0.68      0.76       478
        3.0       0.97      0.78      0.87       196
        4.0       0.66      0.55      0.60       198

avg / total       0.78      0.64      0.69       990
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.41  27.50   97.03  44.90     34.11
1  76.16  63.16   76.68   9.76     16.90
2  79.29  67.78   90.04  86.40     75.97
3  95.25  78.06   99.50  97.45     86.69
4  85.35  54.55   93.06  66.26     59.83
Total accuracy: 63.74%
Average sen: 58.21%
Average spec: 91.26%
Macro f1-score: 54.70%
Diagnosis acc on 15mins: 0.7575757575757576
[0.99394023 0.5868029  0.86459762 0.9805885  0.98975337 0.93143958
 0.651043   0.07007305 0.09179388 0.40825567 0.9998399  0.9991709
 0.96397889 0.99968827 0.98334229 0.29383019 0.05207428 0.88709265
 0.97883576 0.99249917 0.99872905 0.96993488 0.44773954 0.71471578
 0.93971652 0.94027722 0.8798216  0.43039197 0.07693882 0.64424157
 0.9516083  0.99229974 0.98453206]
pred: 0.7481693067785465, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.342847, loss_ss: 1.630362, loss_d: 0.712484
0.0384 --- loss: 1.906285, loss_ss: 1.505450, loss_d: 0.400835
0.0767 --- loss: 2.163474, loss_ss: 1.536085, loss_d: 0.627388
0.1151 --- loss: 2.164766, loss_ss: 1.527665, loss_d: 0.637101
0.1535 --- loss: 2.016544, loss_ss: 1.487993, loss_d: 0.528551
0.1919 --- loss: 2.096349, loss_ss: 1.551783, loss_d: 0.544566
0.2302 --- loss: 1.836088, loss_ss: 1.394203, loss_d: 0.441885
0.2686 --- loss: 1.850080, loss_ss: 1.452840, loss_d: 0.397240
0.3070 --- loss: 1.873715, loss_ss: 1.316595, loss_d: 0.557120
0.3454 --- loss: 2.067054, loss_ss: 1.445839, loss_d: 0.621214
0.3837 --- loss: 1.853845, loss_ss: 1.455508, loss_d: 0.398337
0.4221 --- loss: 2.075684, loss_ss: 1.283161, loss_d: 0.792523
0.4605 --- loss: 2.031980, loss_ss: 1.433013, loss_d: 0.598967
0.4988 --- loss: 1.823044, loss_ss: 1.313429, loss_d: 0.509615
0.5372 --- loss: 2.041785, loss_ss: 1.228795, loss_d: 0.812990
0.5756 --- loss: 1.824850, loss_ss: 1.256502, loss_d: 0.568348
0.6140 --- loss: 1.740555, loss_ss: 1.277668, loss_d: 0.462887
0.6523 --- loss: 1.697432, loss_ss: 1.295686, loss_d: 0.401745
0.6907 --- loss: 1.920720, loss_ss: 1.203879, loss_d: 0.716841
0.7291 --- loss: 1.806883, loss_ss: 1.235787, loss_d: 0.571096
0.7675 --- loss: 1.766387, loss_ss: 1.271891, loss_d: 0.494497
0.8058 --- loss: 1.689858, loss_ss: 1.254507, loss_d: 0.435351
0.8442 --- loss: 1.709176, loss_ss: 1.297206, loss_d: 0.411970
0.8826 --- loss: 1.585148, loss_ss: 1.141011, loss_d: 0.444137
0.9210 --- loss: 1.921339, loss_ss: 1.136441, loss_d: 0.784898
0.9593 --- loss: 1.536847, loss_ss: 1.156875, loss_d: 0.379972
0.9977 --- loss: 1.596885, loss_ss: 1.354301, loss_d: 0.242585
Epoch finished! Loss: 1.9357863540832814
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.853758, loss_ss: 1.340158, loss_d: 0.513600
0.0384 --- loss: 1.447979, loss_ss: 1.161893, loss_d: 0.286086
0.0767 --- loss: 2.125484, loss_ss: 1.439581, loss_d: 0.685903
0.1151 --- loss: 1.583138, loss_ss: 1.238739, loss_d: 0.344400
0.1535 --- loss: 1.446492, loss_ss: 1.290721, loss_d: 0.155771
0.1919 --- loss: 1.357844, loss_ss: 1.212368, loss_d: 0.145476
0.2302 --- loss: 1.251139, loss_ss: 1.125295, loss_d: 0.125844
0.2686 --- loss: 1.268242, loss_ss: 1.128076, loss_d: 0.140166
0.3070 --- loss: 2.410042, loss_ss: 1.574049, loss_d: 0.835993
0.3454 --- loss: 2.036937, loss_ss: 1.283197, loss_d: 0.753740
0.3837 --- loss: 1.784019, loss_ss: 1.100872, loss_d: 0.683147
0.4221 --- loss: 1.873403, loss_ss: 1.199190, loss_d: 0.674214
0.4605 --- loss: 1.874624, loss_ss: 1.269002, loss_d: 0.605622
0.4988 --- loss: 1.672376, loss_ss: 0.981821, loss_d: 0.690555
0.5372 --- loss: 1.463290, loss_ss: 1.219525, loss_d: 0.243765
0.5756 --- loss: 1.972222, loss_ss: 1.223890, loss_d: 0.748332
0.6140 --- loss: 1.948556, loss_ss: 1.145698, loss_d: 0.802858
0.6523 --- loss: 1.544205, loss_ss: 1.308674, loss_d: 0.235531
0.6907 --- loss: 1.480973, loss_ss: 1.273196, loss_d: 0.207776
0.7291 --- loss: 1.513127, loss_ss: 1.083205, loss_d: 0.429922
0.7675 --- loss: 1.161740, loss_ss: 1.013050, loss_d: 0.148690
0.8058 --- loss: 0.908123, loss_ss: 0.838951, loss_d: 0.069172
0.8442 --- loss: 1.375610, loss_ss: 1.018455, loss_d: 0.357155
0.8826 --- loss: 1.702676, loss_ss: 1.067756, loss_d: 0.634920
0.9210 --- loss: 1.778287, loss_ss: 1.201381, loss_d: 0.576907
0.9593 --- loss: 1.453995, loss_ss: 1.224688, loss_d: 0.229307
0.9977 --- loss: 1.273927, loss_ss: 1.077800, loss_d: 0.196127
Epoch finished! Loss: 1.5230362243377245
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.252352, loss_ss: 1.074520, loss_d: 0.177831
0.0384 --- loss: 1.543687, loss_ss: 1.175896, loss_d: 0.367792
0.0767 --- loss: 1.308032, loss_ss: 0.987115, loss_d: 0.320917
0.1151 --- loss: 1.192151, loss_ss: 1.053270, loss_d: 0.138882
0.1535 --- loss: 1.047228, loss_ss: 0.940582, loss_d: 0.106646
0.1919 --- loss: 1.594200, loss_ss: 0.929699, loss_d: 0.664501
0.2302 --- loss: 1.549168, loss_ss: 1.151510, loss_d: 0.397657
0.2686 --- loss: 0.965541, loss_ss: 0.900395, loss_d: 0.065147
0.3070 --- loss: 1.054047, loss_ss: 0.949646, loss_d: 0.104401
0.3454 --- loss: 1.216510, loss_ss: 0.864901, loss_d: 0.351610
0.3837 --- loss: 1.433947, loss_ss: 0.998425, loss_d: 0.435522
0.4221 --- loss: 1.460977, loss_ss: 1.086727, loss_d: 0.374249
0.4605 --- loss: 1.628508, loss_ss: 0.971907, loss_d: 0.656601
0.4988 --- loss: 1.151317, loss_ss: 1.031498, loss_d: 0.119819
0.5372 --- loss: 0.973934, loss_ss: 0.844866, loss_d: 0.129068
0.5756 --- loss: 1.700849, loss_ss: 1.193293, loss_d: 0.507557
0.6140 --- loss: 1.496196, loss_ss: 1.271991, loss_d: 0.224205
0.6523 --- loss: 1.070080, loss_ss: 0.947320, loss_d: 0.122761
0.6907 --- loss: 0.979064, loss_ss: 0.833360, loss_d: 0.145704
0.7291 --- loss: 1.335944, loss_ss: 0.958519, loss_d: 0.377425
0.7675 --- loss: 1.187485, loss_ss: 1.028492, loss_d: 0.158993
0.8058 --- loss: 1.662442, loss_ss: 1.406223, loss_d: 0.256218
0.8442 --- loss: 1.231149, loss_ss: 0.938934, loss_d: 0.292215
0.8826 --- loss: 1.444990, loss_ss: 0.980369, loss_d: 0.464621
0.9210 --- loss: 0.961056, loss_ss: 0.859658, loss_d: 0.101398
0.9593 --- loss: 1.125188, loss_ss: 1.017887, loss_d: 0.107301
0.9977 --- loss: 1.128125, loss_ss: 0.822237, loss_d: 0.305889
Epoch finished! Loss: 1.3211221928779895
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.484666, loss_ss: 1.264902, loss_d: 0.219764
0.0384 --- loss: 1.005579, loss_ss: 0.864366, loss_d: 0.141213
0.0767 --- loss: 1.024781, loss_ss: 0.699631, loss_d: 0.325150
0.1151 --- loss: 1.288760, loss_ss: 0.998653, loss_d: 0.290108
0.1535 --- loss: 0.919787, loss_ss: 0.878739, loss_d: 0.041048
0.1919 --- loss: 1.103279, loss_ss: 0.844837, loss_d: 0.258442
0.2302 --- loss: 2.005857, loss_ss: 0.895653, loss_d: 1.110204
0.2686 --- loss: 1.196028, loss_ss: 1.119252, loss_d: 0.076776
0.3070 --- loss: 0.989572, loss_ss: 0.882456, loss_d: 0.107116
0.3454 --- loss: 1.204840, loss_ss: 1.153152, loss_d: 0.051688
0.3837 --- loss: 1.090304, loss_ss: 1.027655, loss_d: 0.062648
0.4221 --- loss: 1.280959, loss_ss: 0.828716, loss_d: 0.452243
0.4605 --- loss: 1.108665, loss_ss: 0.899576, loss_d: 0.209089
0.4988 --- loss: 1.189264, loss_ss: 0.984221, loss_d: 0.205043
0.5372 --- loss: 1.434550, loss_ss: 0.864696, loss_d: 0.569854
0.5756 --- loss: 0.975397, loss_ss: 0.897783, loss_d: 0.077614
0.6140 --- loss: 0.978821, loss_ss: 0.900677, loss_d: 0.078144
0.6523 --- loss: 1.073162, loss_ss: 0.692820, loss_d: 0.380342
0.6907 --- loss: 1.318866, loss_ss: 0.955238, loss_d: 0.363628
0.7291 --- loss: 1.197965, loss_ss: 1.025509, loss_d: 0.172456
0.7675 --- loss: 1.119122, loss_ss: 0.863430, loss_d: 0.255692
0.8058 --- loss: 1.412538, loss_ss: 1.141212, loss_d: 0.271326
0.8442 --- loss: 1.172848, loss_ss: 0.835910, loss_d: 0.336938
0.8826 --- loss: 0.835129, loss_ss: 0.779138, loss_d: 0.055991
0.9210 --- loss: 1.270673, loss_ss: 0.730377, loss_d: 0.540296
0.9593 --- loss: 1.259824, loss_ss: 1.026308, loss_d: 0.233516
0.9977 --- loss: 2.274220, loss_ss: 1.048912, loss_d: 1.225308
Epoch finished! Loss: 1.1980696957844954
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.094615, loss_ss: 0.752979, loss_d: 0.341636
0.0384 --- loss: 1.096212, loss_ss: 0.860708, loss_d: 0.235504
0.0767 --- loss: 1.088402, loss_ss: 0.979680, loss_d: 0.108722
0.1151 --- loss: 1.561336, loss_ss: 0.867660, loss_d: 0.693676
0.1535 --- loss: 1.436974, loss_ss: 1.023714, loss_d: 0.413260
0.1919 --- loss: 1.602319, loss_ss: 1.129678, loss_d: 0.472642
0.2302 --- loss: 1.281825, loss_ss: 0.961223, loss_d: 0.320602
0.2686 --- loss: 1.095136, loss_ss: 0.794142, loss_d: 0.300995
0.3070 --- loss: 0.902090, loss_ss: 0.742272, loss_d: 0.159818
0.3454 --- loss: 0.892881, loss_ss: 0.721962, loss_d: 0.170919
0.3837 --- loss: 1.036010, loss_ss: 0.960707, loss_d: 0.075303
0.4221 --- loss: 0.964734, loss_ss: 0.847985, loss_d: 0.116749
0.4605 --- loss: 1.050995, loss_ss: 0.911360, loss_d: 0.139635
0.4988 --- loss: 1.130929, loss_ss: 0.936599, loss_d: 0.194330
0.5372 --- loss: 1.126216, loss_ss: 0.938718, loss_d: 0.187498
0.5756 --- loss: 1.250488, loss_ss: 0.912681, loss_d: 0.337807
0.6140 --- loss: 1.092798, loss_ss: 0.792317, loss_d: 0.300481
0.6523 --- loss: 1.772949, loss_ss: 0.995205, loss_d: 0.777743
0.6907 --- loss: 1.219722, loss_ss: 1.001498, loss_d: 0.218224
0.7291 --- loss: 0.934890, loss_ss: 0.748113, loss_d: 0.186777
0.7675 --- loss: 1.538717, loss_ss: 1.317699, loss_d: 0.221019
0.8058 --- loss: 1.169260, loss_ss: 0.803202, loss_d: 0.366058
0.8442 --- loss: 1.144849, loss_ss: 1.088058, loss_d: 0.056791
0.8826 --- loss: 0.980712, loss_ss: 0.814606, loss_d: 0.166107
0.9210 --- loss: 1.334911, loss_ss: 0.904880, loss_d: 0.430031
0.9593 --- loss: 1.160377, loss_ss: 0.956035, loss_d: 0.204341
0.9977 --- loss: 1.123488, loss_ss: 0.843063, loss_d: 0.280426
Epoch finished! Loss: 1.1649724469735072
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.990564, loss_ss: 0.765442, loss_d: 0.225122
0.0384 --- loss: 1.122034, loss_ss: 0.734501, loss_d: 0.387533
0.0767 --- loss: 1.201890, loss_ss: 1.092927, loss_d: 0.108962
0.1151 --- loss: 1.146961, loss_ss: 0.754743, loss_d: 0.392218
0.1535 --- loss: 1.477693, loss_ss: 1.261799, loss_d: 0.215894
0.1919 --- loss: 1.033697, loss_ss: 0.837962, loss_d: 0.195735
0.2302 --- loss: 1.140461, loss_ss: 1.113200, loss_d: 0.027261
0.2686 --- loss: 0.879520, loss_ss: 0.778655, loss_d: 0.100865
0.3070 --- loss: 0.889952, loss_ss: 0.840900, loss_d: 0.049052
0.3454 --- loss: 1.239511, loss_ss: 1.095380, loss_d: 0.144131
0.3837 --- loss: 0.930247, loss_ss: 0.872015, loss_d: 0.058233
0.4221 --- loss: 1.423232, loss_ss: 0.980805, loss_d: 0.442427
0.4605 --- loss: 1.160790, loss_ss: 0.783132, loss_d: 0.377658
0.4988 --- loss: 0.883405, loss_ss: 0.733632, loss_d: 0.149772
0.5372 --- loss: 1.042281, loss_ss: 0.857590, loss_d: 0.184691
0.5756 --- loss: 1.229498, loss_ss: 1.166692, loss_d: 0.062807
0.6140 --- loss: 0.876469, loss_ss: 0.812116, loss_d: 0.064353
0.6523 --- loss: 0.986383, loss_ss: 0.949592, loss_d: 0.036791
0.6907 --- loss: 1.411275, loss_ss: 1.225556, loss_d: 0.185720
0.7291 --- loss: 1.219778, loss_ss: 0.807121, loss_d: 0.412656
0.7675 --- loss: 1.026316, loss_ss: 0.972323, loss_d: 0.053994
0.8058 --- loss: 1.282403, loss_ss: 1.154842, loss_d: 0.127560
0.8442 --- loss: 1.054359, loss_ss: 1.013438, loss_d: 0.040921
0.8826 --- loss: 0.699616, loss_ss: 0.625217, loss_d: 0.074399
0.9210 --- loss: 1.154665, loss_ss: 1.077846, loss_d: 0.076818
0.9593 --- loss: 1.006184, loss_ss: 0.772034, loss_d: 0.234151
0.9977 --- loss: 1.208801, loss_ss: 0.906552, loss_d: 0.302250
Epoch finished! Loss: 1.0832633969875483
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.902775, loss_ss: 0.847602, loss_d: 0.055173
0.0384 --- loss: 1.130717, loss_ss: 0.735251, loss_d: 0.395466
0.0767 --- loss: 0.971169, loss_ss: 0.641503, loss_d: 0.329666
0.1151 --- loss: 1.268105, loss_ss: 0.929881, loss_d: 0.338224
0.1535 --- loss: 0.963730, loss_ss: 0.730410, loss_d: 0.233320
0.1919 --- loss: 0.807521, loss_ss: 0.727572, loss_d: 0.079949
0.2302 --- loss: 0.908156, loss_ss: 0.798748, loss_d: 0.109409
0.2686 --- loss: 0.963341, loss_ss: 0.849415, loss_d: 0.113926
0.3070 --- loss: 1.005759, loss_ss: 0.860866, loss_d: 0.144893
0.3454 --- loss: 1.033941, loss_ss: 0.825323, loss_d: 0.208619
0.3837 --- loss: 0.733423, loss_ss: 0.702479, loss_d: 0.030944
0.4221 --- loss: 0.865212, loss_ss: 0.807705, loss_d: 0.057506
0.4605 --- loss: 1.652359, loss_ss: 0.719492, loss_d: 0.932867
0.4988 --- loss: 1.001711, loss_ss: 0.682693, loss_d: 0.319018
0.5372 --- loss: 1.004690, loss_ss: 0.904100, loss_d: 0.100590
0.5756 --- loss: 1.052262, loss_ss: 0.786763, loss_d: 0.265499
0.6140 --- loss: 0.748413, loss_ss: 0.492471, loss_d: 0.255942
0.6523 --- loss: 0.863473, loss_ss: 0.758009, loss_d: 0.105464
0.6907 --- loss: 1.097352, loss_ss: 0.970234, loss_d: 0.127119
0.7291 --- loss: 0.845552, loss_ss: 0.724680, loss_d: 0.120872
0.7675 --- loss: 1.148676, loss_ss: 1.125465, loss_d: 0.023212
0.8058 --- loss: 0.992432, loss_ss: 0.766865, loss_d: 0.225567
0.8442 --- loss: 0.633412, loss_ss: 0.581927, loss_d: 0.051486
0.8826 --- loss: 0.959226, loss_ss: 0.770648, loss_d: 0.188578
0.9210 --- loss: 1.205794, loss_ss: 1.101975, loss_d: 0.103819
0.9593 --- loss: 1.000920, loss_ss: 0.941099, loss_d: 0.059821
0.9977 --- loss: 1.449432, loss_ss: 1.088718, loss_d: 0.360714
Epoch finished! Loss: 1.0466378656717448
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.056141, loss_ss: 0.832752, loss_d: 0.223388
0.0384 --- loss: 0.927989, loss_ss: 0.756042, loss_d: 0.171947
0.0767 --- loss: 0.935360, loss_ss: 0.808648, loss_d: 0.126712
0.1151 --- loss: 1.969814, loss_ss: 0.806045, loss_d: 1.163769
0.1535 --- loss: 1.210955, loss_ss: 1.013091, loss_d: 0.197864
0.1919 --- loss: 0.856585, loss_ss: 0.814485, loss_d: 0.042100
0.2302 --- loss: 0.962628, loss_ss: 0.835393, loss_d: 0.127235
0.2686 --- loss: 0.777408, loss_ss: 0.710310, loss_d: 0.067098
0.3070 --- loss: 0.810288, loss_ss: 0.788258, loss_d: 0.022030
0.3454 --- loss: 1.058238, loss_ss: 0.936711, loss_d: 0.121527
0.3837 --- loss: 0.796103, loss_ss: 0.729261, loss_d: 0.066843
0.4221 --- loss: 0.847719, loss_ss: 0.741274, loss_d: 0.106445
0.4605 --- loss: 1.106198, loss_ss: 0.943143, loss_d: 0.163055
0.4988 --- loss: 0.878969, loss_ss: 0.861643, loss_d: 0.017326
0.5372 --- loss: 0.701188, loss_ss: 0.637983, loss_d: 0.063206
0.5756 --- loss: 0.893721, loss_ss: 0.773060, loss_d: 0.120661
0.6140 --- loss: 1.269452, loss_ss: 0.913082, loss_d: 0.356370
0.6523 --- loss: 0.822169, loss_ss: 0.697923, loss_d: 0.124246
0.6907 --- loss: 2.077727, loss_ss: 0.787235, loss_d: 1.290491
0.7291 --- loss: 1.234494, loss_ss: 0.972113, loss_d: 0.262381
0.7675 --- loss: 0.981706, loss_ss: 0.747582, loss_d: 0.234125
0.8058 --- loss: 1.243778, loss_ss: 0.938810, loss_d: 0.304969
0.8442 --- loss: 0.750512, loss_ss: 0.722369, loss_d: 0.028142
0.8826 --- loss: 1.006600, loss_ss: 0.968259, loss_d: 0.038341
0.9210 --- loss: 0.744092, loss_ss: 0.685898, loss_d: 0.058194
0.9593 --- loss: 0.952723, loss_ss: 0.681912, loss_d: 0.270811
0.9977 --- loss: 0.909348, loss_ss: 0.890146, loss_d: 0.019203
Epoch finished! Loss: 1.0191920567017334
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.720278, loss_ss: 0.624798, loss_d: 0.095480
0.0384 --- loss: 0.896907, loss_ss: 0.871801, loss_d: 0.025107
0.0767 --- loss: 0.880457, loss_ss: 0.790183, loss_d: 0.090274
0.1151 --- loss: 1.005165, loss_ss: 0.851453, loss_d: 0.153711
0.1535 --- loss: 0.750224, loss_ss: 0.617879, loss_d: 0.132345
0.1919 --- loss: 0.796568, loss_ss: 0.781656, loss_d: 0.014912
0.2302 --- loss: 0.949253, loss_ss: 0.937979, loss_d: 0.011274
0.2686 --- loss: 1.269487, loss_ss: 1.021996, loss_d: 0.247491
0.3070 --- loss: 0.910535, loss_ss: 0.863442, loss_d: 0.047092
0.3454 --- loss: 1.068722, loss_ss: 0.750429, loss_d: 0.318293
0.3837 --- loss: 1.069693, loss_ss: 0.842421, loss_d: 0.227272
0.4221 --- loss: 1.189632, loss_ss: 0.859268, loss_d: 0.330364
0.4605 --- loss: 1.163108, loss_ss: 0.840421, loss_d: 0.322687
0.4988 --- loss: 0.854495, loss_ss: 0.835016, loss_d: 0.019479
0.5372 --- loss: 1.080047, loss_ss: 1.026169, loss_d: 0.053878
0.5756 --- loss: 0.981504, loss_ss: 0.895935, loss_d: 0.085568
0.6140 --- loss: 0.813632, loss_ss: 0.677095, loss_d: 0.136537
0.6523 --- loss: 0.740875, loss_ss: 0.736153, loss_d: 0.004722
0.6907 --- loss: 0.519337, loss_ss: 0.511820, loss_d: 0.007517
0.7291 --- loss: 0.968124, loss_ss: 0.940984, loss_d: 0.027139
0.7675 --- loss: 1.137957, loss_ss: 1.121062, loss_d: 0.016895
0.8058 --- loss: 1.277178, loss_ss: 0.858422, loss_d: 0.418755
0.8442 --- loss: 1.338797, loss_ss: 0.726431, loss_d: 0.612366
0.8826 --- loss: 1.581164, loss_ss: 1.107090, loss_d: 0.474074
0.9210 --- loss: 0.973312, loss_ss: 0.823745, loss_d: 0.149568
0.9593 --- loss: 0.798431, loss_ss: 0.685334, loss_d: 0.113097
0.9977 --- loss: 1.245394, loss_ss: 1.184962, loss_d: 0.060432
Epoch finished! Loss: 0.9613148253697615
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.877008, loss_ss: 0.757486, loss_d: 0.119522
0.0384 --- loss: 0.996252, loss_ss: 0.957606, loss_d: 0.038647
0.0767 --- loss: 1.275317, loss_ss: 1.001539, loss_d: 0.273778
0.1151 --- loss: 1.264893, loss_ss: 1.227725, loss_d: 0.037168
0.1535 --- loss: 0.873295, loss_ss: 0.842728, loss_d: 0.030567
0.1919 --- loss: 1.466091, loss_ss: 0.654903, loss_d: 0.811188
0.2302 --- loss: 1.066198, loss_ss: 0.750917, loss_d: 0.315281
0.2686 --- loss: 1.108972, loss_ss: 0.964275, loss_d: 0.144697
0.3070 --- loss: 1.279991, loss_ss: 0.788319, loss_d: 0.491672
0.3454 --- loss: 0.813009, loss_ss: 0.744159, loss_d: 0.068850
0.3837 --- loss: 1.022115, loss_ss: 1.008114, loss_d: 0.014001
0.4221 --- loss: 0.870815, loss_ss: 0.856285, loss_d: 0.014529
0.4605 --- loss: 1.067662, loss_ss: 1.055443, loss_d: 0.012219
0.4988 --- loss: 1.508655, loss_ss: 1.493796, loss_d: 0.014859
0.5372 --- loss: 0.871044, loss_ss: 0.800565, loss_d: 0.070480
0.5756 --- loss: 0.520882, loss_ss: 0.471102, loss_d: 0.049779
0.6140 --- loss: 0.610698, loss_ss: 0.584480, loss_d: 0.026219
0.6523 --- loss: 0.836327, loss_ss: 0.806573, loss_d: 0.029754
0.6907 --- loss: 0.946434, loss_ss: 0.882764, loss_d: 0.063670
0.7291 --- loss: 1.281776, loss_ss: 0.526536, loss_d: 0.755240
0.7675 --- loss: 0.905214, loss_ss: 0.871764, loss_d: 0.033450
0.8058 --- loss: 0.856123, loss_ss: 0.828055, loss_d: 0.028069
0.8442 --- loss: 0.754357, loss_ss: 0.705675, loss_d: 0.048681
0.8826 --- loss: 0.884547, loss_ss: 0.762690, loss_d: 0.121857
0.9210 --- loss: 0.923694, loss_ss: 0.878169, loss_d: 0.045525
0.9593 --- loss: 0.689272, loss_ss: 0.661797, loss_d: 0.027475
0.9977 --- loss: 1.541306, loss_ss: 0.701690, loss_d: 0.839617
Epoch finished! Loss: 0.9233073448905578
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.575
             precision    recall  f1-score   support

        0.0       0.69      0.19      0.29       135
        1.0       0.31      0.86      0.46       141
        2.0       0.71      0.67      0.69       354
        3.0       1.00      0.53      0.70       197
        4.0       0.66      0.48      0.56       133

avg / total       0.70      0.57      0.58       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.40  18.52   98.67   69.44     29.24
1  69.90  85.82   67.16   31.03     45.57
2  77.92  66.95   84.32   71.39     69.10
3  90.42  53.30  100.00  100.00     69.54
4  89.38  48.12   96.01   65.98     55.65
Total accuracy: 57.50%
Average sen: 54.54%
Average spec: 89.23%
Macro f1-score: 53.82%
Diagnosis acc on 15mins: 0.9375
[0.99999976 0.99946553 0.67233378 0.83725435 0.99537164 0.99999666
 0.99980527 0.99956423 0.99979347 0.99999964 0.99999857 0.99967754
 0.62564814 0.99963999 0.99999964 0.99999976 0.99999988 0.99990225
 0.99981314 0.98977518 0.9998827  0.99999762 0.99999928 0.99999988
 0.99999988 0.99603158 0.05225019 0.10884929 0.99997735 0.99999607
 0.99999726 0.99999952]
pred: 0.9148443448357284, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.377694, loss_ss: 1.675925, loss_d: 0.701769
0.0385 --- loss: 2.143703, loss_ss: 1.562217, loss_d: 0.581486
0.0771 --- loss: 1.914703, loss_ss: 1.569460, loss_d: 0.345242
0.1156 --- loss: 2.027012, loss_ss: 1.473510, loss_d: 0.553501
0.1541 --- loss: 1.925083, loss_ss: 1.409494, loss_d: 0.515589
0.1927 --- loss: 2.297876, loss_ss: 1.474059, loss_d: 0.823817
0.2312 --- loss: 1.892813, loss_ss: 1.331680, loss_d: 0.561133
0.2697 --- loss: 1.862190, loss_ss: 1.331999, loss_d: 0.530191
0.3083 --- loss: 2.014263, loss_ss: 1.409975, loss_d: 0.604289
0.3468 --- loss: 1.939863, loss_ss: 1.262679, loss_d: 0.677184
0.3854 --- loss: 1.986537, loss_ss: 1.453324, loss_d: 0.533213
0.4239 --- loss: 2.043517, loss_ss: 1.403038, loss_d: 0.640480
0.4624 --- loss: 1.758991, loss_ss: 1.287645, loss_d: 0.471345
0.5010 --- loss: 2.101475, loss_ss: 1.295876, loss_d: 0.805600
0.5395 --- loss: 1.771837, loss_ss: 1.258009, loss_d: 0.513828
0.5780 --- loss: 1.720536, loss_ss: 1.254434, loss_d: 0.466102
0.6166 --- loss: 1.742786, loss_ss: 1.477494, loss_d: 0.265292
0.6551 --- loss: 1.661358, loss_ss: 1.148525, loss_d: 0.512832
0.6936 --- loss: 1.717812, loss_ss: 1.178792, loss_d: 0.539020
0.7322 --- loss: 1.637463, loss_ss: 1.147354, loss_d: 0.490108
0.7707 --- loss: 1.672804, loss_ss: 1.287734, loss_d: 0.385070
0.8092 --- loss: 1.646398, loss_ss: 1.253171, loss_d: 0.393227
0.8478 --- loss: 1.715283, loss_ss: 1.101505, loss_d: 0.613778
0.8863 --- loss: 1.492844, loss_ss: 1.098165, loss_d: 0.394679
0.9249 --- loss: 1.653986, loss_ss: 1.264536, loss_d: 0.389450
0.9634 --- loss: 1.571814, loss_ss: 1.268216, loss_d: 0.303599
Epoch finished! Loss: 1.8980821670252384
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.568623, loss_ss: 1.120029, loss_d: 0.448594
0.0385 --- loss: 1.776582, loss_ss: 1.135389, loss_d: 0.641193
0.0771 --- loss: 1.612309, loss_ss: 0.960240, loss_d: 0.652069
0.1156 --- loss: 1.434485, loss_ss: 1.172265, loss_d: 0.262220
0.1541 --- loss: 1.655559, loss_ss: 1.043036, loss_d: 0.612524
0.1927 --- loss: 1.341517, loss_ss: 1.042854, loss_d: 0.298663
0.2312 --- loss: 1.477553, loss_ss: 1.175723, loss_d: 0.301830
0.2697 --- loss: 1.345828, loss_ss: 1.110593, loss_d: 0.235235
0.3083 --- loss: 1.635119, loss_ss: 0.948182, loss_d: 0.686937
0.3468 --- loss: 1.559108, loss_ss: 1.185377, loss_d: 0.373731
0.3854 --- loss: 1.802149, loss_ss: 0.994922, loss_d: 0.807227
0.4239 --- loss: 1.335498, loss_ss: 1.012871, loss_d: 0.322627
0.4624 --- loss: 1.374605, loss_ss: 1.031126, loss_d: 0.343480
0.5010 --- loss: 1.405260, loss_ss: 0.994647, loss_d: 0.410613
0.5395 --- loss: 1.425055, loss_ss: 1.076913, loss_d: 0.348142
0.5780 --- loss: 1.566935, loss_ss: 1.224727, loss_d: 0.342208
0.6166 --- loss: 1.416648, loss_ss: 1.163253, loss_d: 0.253395
0.6551 --- loss: 1.348733, loss_ss: 0.998145, loss_d: 0.350587
0.6936 --- loss: 1.335028, loss_ss: 0.860389, loss_d: 0.474638
0.7322 --- loss: 1.414110, loss_ss: 1.078463, loss_d: 0.335648
0.7707 --- loss: 1.220577, loss_ss: 0.924489, loss_d: 0.296089
0.8092 --- loss: 1.381893, loss_ss: 0.947899, loss_d: 0.433995
0.8478 --- loss: 1.761779, loss_ss: 1.062430, loss_d: 0.699349
0.8863 --- loss: 1.439141, loss_ss: 1.061757, loss_d: 0.377383
0.9249 --- loss: 1.228877, loss_ss: 1.061194, loss_d: 0.167684
0.9634 --- loss: 1.361550, loss_ss: 0.978661, loss_d: 0.382889
Epoch finished! Loss: 1.4908246648817909
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.764427, loss_ss: 1.532623, loss_d: 0.231804
0.0385 --- loss: 1.335418, loss_ss: 1.074337, loss_d: 0.261081
0.0771 --- loss: 1.782346, loss_ss: 1.391886, loss_d: 0.390460
0.1156 --- loss: 0.961793, loss_ss: 0.886152, loss_d: 0.075641
0.1541 --- loss: 1.123980, loss_ss: 1.006130, loss_d: 0.117850
0.1927 --- loss: 0.891716, loss_ss: 0.827930, loss_d: 0.063786
0.2312 --- loss: 1.056463, loss_ss: 0.883515, loss_d: 0.172948
0.2697 --- loss: 1.583149, loss_ss: 0.972804, loss_d: 0.610345
0.3083 --- loss: 1.462684, loss_ss: 1.333128, loss_d: 0.129555
0.3468 --- loss: 1.666306, loss_ss: 1.377815, loss_d: 0.288491
0.3854 --- loss: 0.996064, loss_ss: 0.775688, loss_d: 0.220376
0.4239 --- loss: 1.809319, loss_ss: 0.988861, loss_d: 0.820458
0.4624 --- loss: 1.084067, loss_ss: 0.941109, loss_d: 0.142957
0.5010 --- loss: 1.761563, loss_ss: 0.982054, loss_d: 0.779509
0.5395 --- loss: 1.280702, loss_ss: 1.077120, loss_d: 0.203582
0.5780 --- loss: 1.177760, loss_ss: 0.923360, loss_d: 0.254400
0.6166 --- loss: 1.169036, loss_ss: 0.948880, loss_d: 0.220156
0.6551 --- loss: 0.906255, loss_ss: 0.775429, loss_d: 0.130826
0.6936 --- loss: 1.336571, loss_ss: 1.086804, loss_d: 0.249768
0.7322 --- loss: 1.144036, loss_ss: 0.963379, loss_d: 0.180656
0.7707 --- loss: 0.977796, loss_ss: 0.775923, loss_d: 0.201873
0.8092 --- loss: 1.341216, loss_ss: 0.900115, loss_d: 0.441101
0.8478 --- loss: 1.450787, loss_ss: 0.843555, loss_d: 0.607232
0.8863 --- loss: 1.376081, loss_ss: 1.048820, loss_d: 0.327262
0.9249 --- loss: 1.089914, loss_ss: 0.860910, loss_d: 0.229005
0.9634 --- loss: 1.183215, loss_ss: 1.129901, loss_d: 0.053314
Epoch finished! Loss: 1.3068754854809823
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.122663, loss_ss: 0.938456, loss_d: 0.184207
0.0385 --- loss: 0.900988, loss_ss: 0.745192, loss_d: 0.155796
0.0771 --- loss: 2.639622, loss_ss: 1.094051, loss_d: 1.545571
0.1156 --- loss: 1.080314, loss_ss: 0.830868, loss_d: 0.249447
0.1541 --- loss: 1.255844, loss_ss: 1.159538, loss_d: 0.096307
0.1927 --- loss: 0.893408, loss_ss: 0.804757, loss_d: 0.088651
0.2312 --- loss: 1.178617, loss_ss: 0.872223, loss_d: 0.306394
0.2697 --- loss: 1.003303, loss_ss: 0.898940, loss_d: 0.104363
0.3083 --- loss: 1.169436, loss_ss: 1.051146, loss_d: 0.118290
0.3468 --- loss: 1.264385, loss_ss: 1.006715, loss_d: 0.257669
0.3854 --- loss: 1.511497, loss_ss: 1.097843, loss_d: 0.413654
0.4239 --- loss: 1.310161, loss_ss: 0.706468, loss_d: 0.603693
0.4624 --- loss: 1.037474, loss_ss: 0.821421, loss_d: 0.216053
0.5010 --- loss: 1.184043, loss_ss: 0.921924, loss_d: 0.262119
0.5395 --- loss: 1.312708, loss_ss: 1.204604, loss_d: 0.108104
0.5780 --- loss: 1.020812, loss_ss: 0.888576, loss_d: 0.132236
0.6166 --- loss: 1.335943, loss_ss: 1.033487, loss_d: 0.302456
0.6551 --- loss: 1.360406, loss_ss: 1.007841, loss_d: 0.352565
0.6936 --- loss: 1.266800, loss_ss: 0.950321, loss_d: 0.316479
0.7322 --- loss: 1.518151, loss_ss: 1.217189, loss_d: 0.300962
0.7707 --- loss: 1.584564, loss_ss: 0.895845, loss_d: 0.688719
0.8092 --- loss: 1.549996, loss_ss: 1.127750, loss_d: 0.422247
0.8478 --- loss: 1.064080, loss_ss: 0.895416, loss_d: 0.168665
0.8863 --- loss: 1.255301, loss_ss: 0.825161, loss_d: 0.430140
0.9249 --- loss: 0.744918, loss_ss: 0.666519, loss_d: 0.078399
0.9634 --- loss: 1.105605, loss_ss: 0.880324, loss_d: 0.225281
Epoch finished! Loss: 1.1876844690112993
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.836665, loss_ss: 0.786750, loss_d: 0.049915
0.0385 --- loss: 1.076209, loss_ss: 1.006597, loss_d: 0.069612
0.0771 --- loss: 1.702556, loss_ss: 1.222221, loss_d: 0.480335
0.1156 --- loss: 1.335684, loss_ss: 1.108951, loss_d: 0.226733
0.1541 --- loss: 1.017339, loss_ss: 0.990386, loss_d: 0.026952
0.1927 --- loss: 1.350882, loss_ss: 1.025292, loss_d: 0.325590
0.2312 --- loss: 0.891851, loss_ss: 0.823426, loss_d: 0.068425
0.2697 --- loss: 1.118234, loss_ss: 1.075614, loss_d: 0.042619
0.3083 --- loss: 0.757677, loss_ss: 0.671085, loss_d: 0.086592
0.3468 --- loss: 1.236813, loss_ss: 1.059680, loss_d: 0.177134
0.3854 --- loss: 1.569172, loss_ss: 1.191853, loss_d: 0.377319
0.4239 --- loss: 0.992967, loss_ss: 0.852845, loss_d: 0.140122
0.4624 --- loss: 1.215261, loss_ss: 0.903557, loss_d: 0.311704
0.5010 --- loss: 1.226015, loss_ss: 0.937621, loss_d: 0.288395
0.5395 --- loss: 1.436649, loss_ss: 1.070263, loss_d: 0.366386
0.5780 --- loss: 1.021344, loss_ss: 0.991965, loss_d: 0.029379
0.6166 --- loss: 0.890114, loss_ss: 0.822000, loss_d: 0.068114
0.6551 --- loss: 1.242250, loss_ss: 1.178518, loss_d: 0.063732
0.6936 --- loss: 0.665926, loss_ss: 0.607175, loss_d: 0.058751
0.7322 --- loss: 0.990655, loss_ss: 0.898124, loss_d: 0.092531
0.7707 --- loss: 0.923308, loss_ss: 0.732021, loss_d: 0.191287
0.8092 --- loss: 0.796775, loss_ss: 0.778129, loss_d: 0.018645
0.8478 --- loss: 0.992769, loss_ss: 0.883658, loss_d: 0.109112
0.8863 --- loss: 0.835387, loss_ss: 0.783219, loss_d: 0.052168
0.9249 --- loss: 1.273034, loss_ss: 0.937890, loss_d: 0.335145
0.9634 --- loss: 1.212804, loss_ss: 1.059626, loss_d: 0.153177
Epoch finished! Loss: 1.127005733118094
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.982757, loss_ss: 0.734291, loss_d: 0.248466
0.0385 --- loss: 0.957635, loss_ss: 0.875997, loss_d: 0.081638
0.0771 --- loss: 0.876230, loss_ss: 0.800024, loss_d: 0.076206
0.1156 --- loss: 1.073666, loss_ss: 0.730580, loss_d: 0.343085
0.1541 --- loss: 1.458151, loss_ss: 1.161962, loss_d: 0.296188
0.1927 --- loss: 0.756871, loss_ss: 0.643905, loss_d: 0.112966
0.2312 --- loss: 0.956346, loss_ss: 0.898918, loss_d: 0.057428
0.2697 --- loss: 1.453057, loss_ss: 0.760079, loss_d: 0.692978
0.3083 --- loss: 1.087344, loss_ss: 1.024239, loss_d: 0.063105
0.3468 --- loss: 1.054422, loss_ss: 0.883396, loss_d: 0.171026
0.3854 --- loss: 0.825170, loss_ss: 0.781884, loss_d: 0.043286
0.4239 --- loss: 0.729397, loss_ss: 0.576511, loss_d: 0.152886
0.4624 --- loss: 1.008057, loss_ss: 0.784602, loss_d: 0.223455
0.5010 --- loss: 0.969081, loss_ss: 0.896520, loss_d: 0.072561
0.5395 --- loss: 0.843487, loss_ss: 0.813651, loss_d: 0.029836
0.5780 --- loss: 1.016830, loss_ss: 0.910596, loss_d: 0.106234
0.6166 --- loss: 1.368203, loss_ss: 1.036701, loss_d: 0.331502
0.6551 --- loss: 1.031675, loss_ss: 0.928066, loss_d: 0.103608
0.6936 --- loss: 1.217989, loss_ss: 1.073677, loss_d: 0.144312
0.7322 --- loss: 1.365213, loss_ss: 1.099354, loss_d: 0.265860
0.7707 --- loss: 1.311674, loss_ss: 1.169345, loss_d: 0.142329
0.8092 --- loss: 1.176616, loss_ss: 0.886296, loss_d: 0.290320
0.8478 --- loss: 0.879905, loss_ss: 0.713166, loss_d: 0.166739
0.8863 --- loss: 0.725492, loss_ss: 0.595206, loss_d: 0.130286
0.9249 --- loss: 1.524902, loss_ss: 1.268593, loss_d: 0.256309
0.9634 --- loss: 0.872748, loss_ss: 0.757278, loss_d: 0.115470
Epoch finished! Loss: 1.081687827598174
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.067413, loss_ss: 0.899590, loss_d: 0.167823
0.0385 --- loss: 1.356547, loss_ss: 0.978387, loss_d: 0.378160
0.0771 --- loss: 0.972118, loss_ss: 0.791508, loss_d: 0.180610
0.1156 --- loss: 1.266100, loss_ss: 0.795837, loss_d: 0.470263
0.1541 --- loss: 1.075905, loss_ss: 0.885610, loss_d: 0.190294
0.1927 --- loss: 0.857765, loss_ss: 0.761433, loss_d: 0.096332
0.2312 --- loss: 1.258649, loss_ss: 0.848992, loss_d: 0.409657
0.2697 --- loss: 1.235905, loss_ss: 1.182762, loss_d: 0.053143
0.3083 --- loss: 1.015120, loss_ss: 0.968058, loss_d: 0.047063
0.3468 --- loss: 0.988196, loss_ss: 0.921080, loss_d: 0.067116
0.3854 --- loss: 0.914386, loss_ss: 0.902177, loss_d: 0.012208
0.4239 --- loss: 1.091761, loss_ss: 0.905555, loss_d: 0.186206
0.4624 --- loss: 1.444523, loss_ss: 1.199873, loss_d: 0.244650
0.5010 --- loss: 1.452850, loss_ss: 1.029500, loss_d: 0.423350
0.5395 --- loss: 0.903761, loss_ss: 0.765994, loss_d: 0.137767
0.5780 --- loss: 1.200637, loss_ss: 0.836376, loss_d: 0.364261
0.6166 --- loss: 1.104477, loss_ss: 0.991902, loss_d: 0.112575
0.6551 --- loss: 1.100913, loss_ss: 0.920657, loss_d: 0.180256
0.6936 --- loss: 1.099229, loss_ss: 0.738046, loss_d: 0.361183
0.7322 --- loss: 0.700638, loss_ss: 0.684539, loss_d: 0.016099
0.7707 --- loss: 0.902756, loss_ss: 0.600967, loss_d: 0.301789
0.8092 --- loss: 0.889570, loss_ss: 0.812698, loss_d: 0.076872
0.8478 --- loss: 0.780428, loss_ss: 0.668196, loss_d: 0.112233
0.8863 --- loss: 0.802699, loss_ss: 0.748964, loss_d: 0.053735
0.9249 --- loss: 0.947267, loss_ss: 0.925122, loss_d: 0.022144
0.9634 --- loss: 1.318805, loss_ss: 1.113634, loss_d: 0.205172
Epoch finished! Loss: 1.0748037178083736
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.071026, loss_ss: 0.908859, loss_d: 0.162168
0.0385 --- loss: 0.999433, loss_ss: 0.889102, loss_d: 0.110331
0.0771 --- loss: 0.958527, loss_ss: 0.838908, loss_d: 0.119618
0.1156 --- loss: 0.805585, loss_ss: 0.761538, loss_d: 0.044047
0.1541 --- loss: 0.776598, loss_ss: 0.735559, loss_d: 0.041038
0.1927 --- loss: 0.710398, loss_ss: 0.673963, loss_d: 0.036435
0.2312 --- loss: 1.170369, loss_ss: 1.114487, loss_d: 0.055882
0.2697 --- loss: 0.933113, loss_ss: 0.891160, loss_d: 0.041953
0.3083 --- loss: 0.885790, loss_ss: 0.767579, loss_d: 0.118211
0.3468 --- loss: 0.926746, loss_ss: 0.774027, loss_d: 0.152719
0.3854 --- loss: 0.921987, loss_ss: 0.899629, loss_d: 0.022358
0.4239 --- loss: 0.993522, loss_ss: 0.931361, loss_d: 0.062161
0.4624 --- loss: 0.774031, loss_ss: 0.745183, loss_d: 0.028849
0.5010 --- loss: 0.813260, loss_ss: 0.692341, loss_d: 0.120919
0.5395 --- loss: 1.034119, loss_ss: 1.014834, loss_d: 0.019285
0.5780 --- loss: 0.887918, loss_ss: 0.813706, loss_d: 0.074211
0.6166 --- loss: 0.643162, loss_ss: 0.557303, loss_d: 0.085859
0.6551 --- loss: 1.169947, loss_ss: 1.161653, loss_d: 0.008294
0.6936 --- loss: 0.907384, loss_ss: 0.726680, loss_d: 0.180704
0.7322 --- loss: 1.432009, loss_ss: 1.049379, loss_d: 0.382630
0.7707 --- loss: 0.914255, loss_ss: 0.755159, loss_d: 0.159096
0.8092 --- loss: 0.954331, loss_ss: 0.814048, loss_d: 0.140283
0.8478 --- loss: 0.785609, loss_ss: 0.659283, loss_d: 0.126326
0.8863 --- loss: 0.820220, loss_ss: 0.751928, loss_d: 0.068292
0.9249 --- loss: 1.129284, loss_ss: 0.899778, loss_d: 0.229506
0.9634 --- loss: 1.137174, loss_ss: 0.867063, loss_d: 0.270111
Epoch finished! Loss: 0.9916931425282394
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.853838, loss_ss: 0.755485, loss_d: 0.098354
0.0385 --- loss: 0.990387, loss_ss: 0.737634, loss_d: 0.252752
0.0771 --- loss: 1.009688, loss_ss: 0.740777, loss_d: 0.268911
0.1156 --- loss: 1.700587, loss_ss: 0.781523, loss_d: 0.919065
0.1541 --- loss: 1.354034, loss_ss: 0.966671, loss_d: 0.387363
0.1927 --- loss: 0.862469, loss_ss: 0.783240, loss_d: 0.079228
0.2312 --- loss: 1.158094, loss_ss: 1.014750, loss_d: 0.143344
0.2697 --- loss: 0.975587, loss_ss: 0.959406, loss_d: 0.016181
0.3083 --- loss: 0.740988, loss_ss: 0.725439, loss_d: 0.015549
0.3468 --- loss: 0.906730, loss_ss: 0.869570, loss_d: 0.037161
0.3854 --- loss: 1.139926, loss_ss: 0.810348, loss_d: 0.329578
0.4239 --- loss: 0.763268, loss_ss: 0.731248, loss_d: 0.032020
0.4624 --- loss: 0.827019, loss_ss: 0.818533, loss_d: 0.008486
0.5010 --- loss: 1.175455, loss_ss: 1.143528, loss_d: 0.031927
0.5395 --- loss: 1.352464, loss_ss: 1.215728, loss_d: 0.136736
0.5780 --- loss: 0.867501, loss_ss: 0.832406, loss_d: 0.035094
0.6166 --- loss: 0.951688, loss_ss: 0.886026, loss_d: 0.065662
0.6551 --- loss: 0.764062, loss_ss: 0.621778, loss_d: 0.142285
0.6936 --- loss: 0.851844, loss_ss: 0.837882, loss_d: 0.013962
0.7322 --- loss: 0.995486, loss_ss: 0.795834, loss_d: 0.199652
0.7707 --- loss: 0.944584, loss_ss: 0.934585, loss_d: 0.009999
0.8092 --- loss: 0.853855, loss_ss: 0.820212, loss_d: 0.033643
0.8478 --- loss: 1.574566, loss_ss: 0.831550, loss_d: 0.743015
0.8863 --- loss: 0.845814, loss_ss: 0.746302, loss_d: 0.099511
0.9249 --- loss: 1.055022, loss_ss: 1.040292, loss_d: 0.014730
0.9634 --- loss: 1.343567, loss_ss: 1.275506, loss_d: 0.068061
Epoch finished! Loss: 0.9997679289703664
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.040031, loss_ss: 0.900830, loss_d: 0.139202
0.0385 --- loss: 0.759520, loss_ss: 0.752597, loss_d: 0.006922
0.0771 --- loss: 0.713177, loss_ss: 0.641044, loss_d: 0.072133
0.1156 --- loss: 0.649874, loss_ss: 0.640404, loss_d: 0.009469
0.1541 --- loss: 1.062150, loss_ss: 1.047186, loss_d: 0.014965
0.1927 --- loss: 0.926282, loss_ss: 0.815401, loss_d: 0.110882
0.2312 --- loss: 0.930454, loss_ss: 0.809307, loss_d: 0.121148
0.2697 --- loss: 1.214840, loss_ss: 1.044785, loss_d: 0.170054
0.3083 --- loss: 1.360264, loss_ss: 1.282014, loss_d: 0.078249
0.3468 --- loss: 0.794969, loss_ss: 0.744232, loss_d: 0.050737
0.3854 --- loss: 0.909886, loss_ss: 0.778696, loss_d: 0.131190
0.4239 --- loss: 0.752752, loss_ss: 0.648934, loss_d: 0.103818
0.4624 --- loss: 0.696705, loss_ss: 0.686322, loss_d: 0.010383
0.5010 --- loss: 0.918603, loss_ss: 0.747242, loss_d: 0.171361
0.5395 --- loss: 0.871765, loss_ss: 0.859422, loss_d: 0.012343
0.5780 --- loss: 0.830087, loss_ss: 0.657116, loss_d: 0.172971
0.6166 --- loss: 0.844017, loss_ss: 0.797432, loss_d: 0.046584
0.6551 --- loss: 0.786967, loss_ss: 0.724064, loss_d: 0.062902
0.6936 --- loss: 0.817901, loss_ss: 0.800936, loss_d: 0.016965
0.7322 --- loss: 0.843437, loss_ss: 0.830743, loss_d: 0.012694
0.7707 --- loss: 0.884831, loss_ss: 0.809510, loss_d: 0.075321
0.8092 --- loss: 1.018128, loss_ss: 0.958919, loss_d: 0.059209
0.8478 --- loss: 0.713459, loss_ss: 0.658774, loss_d: 0.054685
0.8863 --- loss: 1.029216, loss_ss: 0.908830, loss_d: 0.120386
0.9249 --- loss: 1.312901, loss_ss: 0.600206, loss_d: 0.712695
0.9634 --- loss: 1.059968, loss_ss: 0.896443, loss_d: 0.163525
Epoch finished! Loss: 0.9337534731879658
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6449612403100775
             precision    recall  f1-score   support

        0.0       0.30      0.68      0.41        69
        1.0       0.41      0.53      0.47       238
        2.0       0.77      0.96      0.85       565
        3.0       0.98      0.58      0.73       136
        4.0       1.00      0.14      0.24       282

avg / total       0.75      0.64      0.61      1290
 


====== chp005-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  89.61  68.12   90.83   29.56     41.23
1  77.36  53.36   82.79   41.23     46.52
2  85.43  95.58   77.52   76.81     85.17
3  95.43  58.09   99.83   97.53     72.81
4  81.16  13.83  100.00  100.00     24.30
Total accuracy: 64.50%
Average sen: 57.79%
Average spec: 90.19%
Macro f1-score: 54.01%
Diagnosis acc on 15mins: 1.0
[0.99926001 0.99959034 0.99530917 0.99990571 0.99990427 0.99932909
 0.99988806 0.99992168 0.99955887 0.99998736 0.9999975  0.99806148
 0.99988091 0.99997509 0.99999797 0.99998355 0.9999994  0.99999976
 0.99999607 0.99759406 0.99942112 0.99940646 0.99964571 0.99931562
 0.99989009 0.99999976 0.99999809 0.99999213 0.99998522 0.9997009
 0.99942964 0.99986625 0.99991679 0.99996507 0.99990368 0.99943691
 0.99969196 0.99996185 0.99999797 0.99999619 0.99994957 0.99982315
 0.99970835]
pred: 0.9996079733205396, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.297668, loss_ss: 1.666911, loss_d: 0.630756
0.0384 --- loss: 2.802833, loss_ss: 1.550250, loss_d: 1.252584
0.0769 --- loss: 2.095973, loss_ss: 1.567021, loss_d: 0.528951
0.1153 --- loss: 2.367506, loss_ss: 1.653581, loss_d: 0.713925
0.1537 --- loss: 2.297328, loss_ss: 1.661780, loss_d: 0.635548
0.1922 --- loss: 2.232202, loss_ss: 1.481519, loss_d: 0.750683
0.2306 --- loss: 1.989399, loss_ss: 1.384275, loss_d: 0.605124
0.2690 --- loss: 2.012597, loss_ss: 1.461285, loss_d: 0.551312
0.3075 --- loss: 1.860895, loss_ss: 1.406251, loss_d: 0.454644
0.3459 --- loss: 2.089313, loss_ss: 1.495707, loss_d: 0.593606
0.3843 --- loss: 1.785271, loss_ss: 1.471261, loss_d: 0.314010
0.4228 --- loss: 1.957359, loss_ss: 1.505381, loss_d: 0.451978
0.4612 --- loss: 2.107291, loss_ss: 1.305835, loss_d: 0.801456
0.4996 --- loss: 1.989614, loss_ss: 1.495534, loss_d: 0.494080
0.5380 --- loss: 1.936373, loss_ss: 1.310300, loss_d: 0.626073
0.5765 --- loss: 1.754768, loss_ss: 1.415687, loss_d: 0.339081
0.6149 --- loss: 1.812579, loss_ss: 1.402476, loss_d: 0.410103
0.6533 --- loss: 1.975684, loss_ss: 1.224699, loss_d: 0.750985
0.6918 --- loss: 2.017598, loss_ss: 1.350693, loss_d: 0.666905
0.7302 --- loss: 1.987290, loss_ss: 1.225302, loss_d: 0.761988
0.7686 --- loss: 1.849966, loss_ss: 1.369695, loss_d: 0.480271
0.8071 --- loss: 1.756757, loss_ss: 1.278581, loss_d: 0.478176
0.8455 --- loss: 1.819354, loss_ss: 1.389376, loss_d: 0.429978
0.8839 --- loss: 1.831221, loss_ss: 1.381909, loss_d: 0.449311
0.9224 --- loss: 1.755770, loss_ss: 1.167808, loss_d: 0.587962
0.9608 --- loss: 1.891267, loss_ss: 1.293115, loss_d: 0.598152
0.9992 --- loss: 2.628252, loss_ss: 1.819086, loss_d: 0.809165
Epoch finished! Loss: 1.9940544967467968
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.941928, loss_ss: 1.305502, loss_d: 0.636426
0.0384 --- loss: 1.917420, loss_ss: 1.286257, loss_d: 0.631163
0.0769 --- loss: 1.684280, loss_ss: 1.200003, loss_d: 0.484277
0.1153 --- loss: 1.643902, loss_ss: 1.202867, loss_d: 0.441035
0.1537 --- loss: 1.387858, loss_ss: 1.168973, loss_d: 0.218885
0.1922 --- loss: 1.650727, loss_ss: 1.124239, loss_d: 0.526487
0.2306 --- loss: 1.408086, loss_ss: 1.150565, loss_d: 0.257521
0.2690 --- loss: 1.523335, loss_ss: 1.284830, loss_d: 0.238505
0.3075 --- loss: 1.516438, loss_ss: 1.214483, loss_d: 0.301955
0.3459 --- loss: 1.727297, loss_ss: 1.356256, loss_d: 0.371042
0.3843 --- loss: 1.599339, loss_ss: 1.274176, loss_d: 0.325163
0.4228 --- loss: 1.566667, loss_ss: 1.125526, loss_d: 0.441141
0.4612 --- loss: 1.442050, loss_ss: 1.017425, loss_d: 0.424625
0.4996 --- loss: 1.570371, loss_ss: 1.227488, loss_d: 0.342883
0.5380 --- loss: 1.475243, loss_ss: 0.976496, loss_d: 0.498747
0.5765 --- loss: 1.794569, loss_ss: 1.200435, loss_d: 0.594135
0.6149 --- loss: 1.711605, loss_ss: 1.005949, loss_d: 0.705656
0.6533 --- loss: 1.264207, loss_ss: 0.852966, loss_d: 0.411242
0.6918 --- loss: 1.807746, loss_ss: 1.332891, loss_d: 0.474855
0.7302 --- loss: 1.483985, loss_ss: 1.169859, loss_d: 0.314126
0.7686 --- loss: 1.309401, loss_ss: 1.090037, loss_d: 0.219364
0.8071 --- loss: 1.727982, loss_ss: 0.971542, loss_d: 0.756441
0.8455 --- loss: 1.294253, loss_ss: 1.000461, loss_d: 0.293792
0.8839 --- loss: 1.153187, loss_ss: 0.907285, loss_d: 0.245902
0.9224 --- loss: 1.307289, loss_ss: 1.050029, loss_d: 0.257260
0.9608 --- loss: 1.325782, loss_ss: 1.078129, loss_d: 0.247652
0.9992 --- loss: 2.965129, loss_ss: 1.493765, loss_d: 1.471364
Epoch finished! Loss: 1.5713695168495179
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.343945, loss_ss: 1.033459, loss_d: 0.310486
0.0384 --- loss: 1.125751, loss_ss: 1.008886, loss_d: 0.116865
0.0769 --- loss: 1.142167, loss_ss: 0.936449, loss_d: 0.205718
0.1153 --- loss: 1.256864, loss_ss: 1.016130, loss_d: 0.240734
0.1537 --- loss: 1.550954, loss_ss: 0.947796, loss_d: 0.603158
0.1922 --- loss: 1.124763, loss_ss: 0.885474, loss_d: 0.239289
0.2306 --- loss: 1.070368, loss_ss: 0.894262, loss_d: 0.176105
0.2690 --- loss: 1.304466, loss_ss: 0.792891, loss_d: 0.511575
0.3075 --- loss: 1.766677, loss_ss: 1.150246, loss_d: 0.616431
0.3459 --- loss: 1.211054, loss_ss: 0.906170, loss_d: 0.304884
0.3843 --- loss: 1.204585, loss_ss: 0.902345, loss_d: 0.302240
0.4228 --- loss: 1.241574, loss_ss: 0.889353, loss_d: 0.352222
0.4612 --- loss: 1.433911, loss_ss: 1.004665, loss_d: 0.429246
0.4996 --- loss: 1.504787, loss_ss: 0.954571, loss_d: 0.550216
0.5380 --- loss: 1.379442, loss_ss: 1.198990, loss_d: 0.180453
0.5765 --- loss: 1.077580, loss_ss: 0.794348, loss_d: 0.283232
0.6149 --- loss: 1.221761, loss_ss: 0.992255, loss_d: 0.229506
0.6533 --- loss: 1.416910, loss_ss: 1.108520, loss_d: 0.308390
0.6918 --- loss: 0.820652, loss_ss: 0.674904, loss_d: 0.145748
0.7302 --- loss: 1.536228, loss_ss: 1.209267, loss_d: 0.326961
0.7686 --- loss: 1.274470, loss_ss: 1.044945, loss_d: 0.229525
0.8071 --- loss: 1.439477, loss_ss: 1.153359, loss_d: 0.286117
0.8455 --- loss: 1.342096, loss_ss: 1.007511, loss_d: 0.334585
0.8839 --- loss: 1.034449, loss_ss: 0.958991, loss_d: 0.075459
0.9224 --- loss: 1.312471, loss_ss: 1.071715, loss_d: 0.240756
0.9608 --- loss: 1.845740, loss_ss: 0.927875, loss_d: 0.917865
0.9992 --- loss: 2.961380, loss_ss: 1.533062, loss_d: 1.428317
Epoch finished! Loss: 1.3398076538856214
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.310007, loss_ss: 1.049303, loss_d: 0.260703
0.0384 --- loss: 1.256143, loss_ss: 0.934831, loss_d: 0.321312
0.0769 --- loss: 0.904925, loss_ss: 0.692638, loss_d: 0.212287
0.1153 --- loss: 1.380366, loss_ss: 1.089048, loss_d: 0.291318
0.1537 --- loss: 1.074902, loss_ss: 0.934048, loss_d: 0.140854
0.1922 --- loss: 1.214401, loss_ss: 0.986696, loss_d: 0.227704
0.2306 --- loss: 0.996628, loss_ss: 0.857636, loss_d: 0.138992
0.2690 --- loss: 1.224950, loss_ss: 0.907610, loss_d: 0.317340
0.3075 --- loss: 0.956737, loss_ss: 0.826364, loss_d: 0.130374
0.3459 --- loss: 0.812699, loss_ss: 0.783309, loss_d: 0.029390
0.3843 --- loss: 1.231692, loss_ss: 1.056840, loss_d: 0.174852
0.4228 --- loss: 1.200524, loss_ss: 1.026297, loss_d: 0.174228
0.4612 --- loss: 0.944279, loss_ss: 0.813757, loss_d: 0.130522
0.4996 --- loss: 1.312670, loss_ss: 1.020087, loss_d: 0.292583
0.5380 --- loss: 1.154329, loss_ss: 0.942321, loss_d: 0.212008
0.5765 --- loss: 1.649819, loss_ss: 0.726723, loss_d: 0.923096
0.6149 --- loss: 1.069415, loss_ss: 0.874041, loss_d: 0.195374
0.6533 --- loss: 1.954198, loss_ss: 1.095081, loss_d: 0.859117
0.6918 --- loss: 1.162578, loss_ss: 0.852296, loss_d: 0.310281
0.7302 --- loss: 1.446364, loss_ss: 1.073955, loss_d: 0.372409
0.7686 --- loss: 0.834501, loss_ss: 0.715012, loss_d: 0.119489
0.8071 --- loss: 1.409421, loss_ss: 0.873786, loss_d: 0.535634
0.8455 --- loss: 0.864854, loss_ss: 0.719471, loss_d: 0.145383
0.8839 --- loss: 1.108046, loss_ss: 0.750566, loss_d: 0.357480
0.9224 --- loss: 1.117865, loss_ss: 0.795252, loss_d: 0.322613
0.9608 --- loss: 1.140084, loss_ss: 1.045587, loss_d: 0.094496
0.9992 --- loss: 3.258199, loss_ss: 1.809518, loss_d: 1.448681
Epoch finished! Loss: 1.2273740823452288
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.130936, loss_ss: 0.956461, loss_d: 0.174475
0.0384 --- loss: 1.338908, loss_ss: 0.935988, loss_d: 0.402920
0.0769 --- loss: 1.333379, loss_ss: 0.951587, loss_d: 0.381792
0.1153 --- loss: 1.223310, loss_ss: 1.146811, loss_d: 0.076499
0.1537 --- loss: 1.532163, loss_ss: 1.113185, loss_d: 0.418978
0.1922 --- loss: 1.609640, loss_ss: 1.378451, loss_d: 0.231188
0.2306 --- loss: 1.282290, loss_ss: 0.869626, loss_d: 0.412664
0.2690 --- loss: 0.815727, loss_ss: 0.760603, loss_d: 0.055125
0.3075 --- loss: 1.109748, loss_ss: 0.871866, loss_d: 0.237882
0.3459 --- loss: 1.044862, loss_ss: 0.945766, loss_d: 0.099096
0.3843 --- loss: 0.967631, loss_ss: 0.892014, loss_d: 0.075617
0.4228 --- loss: 0.919467, loss_ss: 0.877557, loss_d: 0.041911
0.4612 --- loss: 1.375525, loss_ss: 0.897511, loss_d: 0.478014
0.4996 --- loss: 1.903269, loss_ss: 1.467374, loss_d: 0.435895
0.5380 --- loss: 1.646604, loss_ss: 1.140453, loss_d: 0.506151
0.5765 --- loss: 1.018457, loss_ss: 0.706917, loss_d: 0.311540
0.6149 --- loss: 1.056584, loss_ss: 0.817672, loss_d: 0.238912
0.6533 --- loss: 0.844794, loss_ss: 0.717053, loss_d: 0.127741
0.6918 --- loss: 2.031734, loss_ss: 1.378251, loss_d: 0.653482
0.7302 --- loss: 1.381714, loss_ss: 1.185258, loss_d: 0.196456
0.7686 --- loss: 1.153449, loss_ss: 0.861515, loss_d: 0.291934
0.8071 --- loss: 1.073427, loss_ss: 0.956298, loss_d: 0.117128
0.8455 --- loss: 1.095815, loss_ss: 1.025717, loss_d: 0.070098
0.8839 --- loss: 1.017460, loss_ss: 0.923478, loss_d: 0.093982
0.9224 --- loss: 1.174255, loss_ss: 1.065765, loss_d: 0.108489
0.9608 --- loss: 0.892705, loss_ss: 0.707662, loss_d: 0.185043
0.9992 --- loss: 1.686609, loss_ss: 1.673953, loss_d: 0.012656
Epoch finished! Loss: 1.171417667086308
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.731479, loss_ss: 0.693856, loss_d: 0.037623
0.0384 --- loss: 1.336526, loss_ss: 1.047196, loss_d: 0.289330
0.0769 --- loss: 1.085837, loss_ss: 0.936555, loss_d: 0.149281
0.1153 --- loss: 0.808229, loss_ss: 0.685984, loss_d: 0.122245
0.1537 --- loss: 1.071404, loss_ss: 0.933995, loss_d: 0.137408
0.1922 --- loss: 0.852103, loss_ss: 0.724162, loss_d: 0.127941
0.2306 --- loss: 0.994886, loss_ss: 0.921724, loss_d: 0.073161
0.2690 --- loss: 0.938197, loss_ss: 0.852649, loss_d: 0.085548
0.3075 --- loss: 0.990718, loss_ss: 0.846868, loss_d: 0.143850
0.3459 --- loss: 1.211969, loss_ss: 0.943933, loss_d: 0.268036
0.3843 --- loss: 1.232810, loss_ss: 0.978646, loss_d: 0.254164
0.4228 --- loss: 0.982278, loss_ss: 0.870566, loss_d: 0.111712
0.4612 --- loss: 1.431406, loss_ss: 1.270941, loss_d: 0.160465
0.4996 --- loss: 0.897776, loss_ss: 0.760626, loss_d: 0.137150
0.5380 --- loss: 1.100055, loss_ss: 0.861926, loss_d: 0.238129
0.5765 --- loss: 1.036107, loss_ss: 0.692657, loss_d: 0.343450
0.6149 --- loss: 1.003947, loss_ss: 0.906253, loss_d: 0.097694
0.6533 --- loss: 1.082492, loss_ss: 0.875044, loss_d: 0.207448
0.6918 --- loss: 1.225984, loss_ss: 1.071211, loss_d: 0.154773
0.7302 --- loss: 0.631292, loss_ss: 0.555103, loss_d: 0.076189
0.7686 --- loss: 1.186486, loss_ss: 1.055196, loss_d: 0.131289
0.8071 --- loss: 1.139899, loss_ss: 0.875551, loss_d: 0.264349
0.8455 --- loss: 1.052526, loss_ss: 0.713963, loss_d: 0.338563
0.8839 --- loss: 1.035919, loss_ss: 0.799494, loss_d: 0.236425
0.9224 --- loss: 1.037853, loss_ss: 1.003070, loss_d: 0.034783
0.9608 --- loss: 0.537699, loss_ss: 0.499907, loss_d: 0.037792
0.9992 --- loss: 1.049651, loss_ss: 1.042766, loss_d: 0.006885
Epoch finished! Loss: 1.1320683105633809
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.079676, loss_ss: 0.983946, loss_d: 0.095730
0.0384 --- loss: 1.210146, loss_ss: 1.073474, loss_d: 0.136672
0.0769 --- loss: 0.970156, loss_ss: 0.899935, loss_d: 0.070221
0.1153 --- loss: 0.690546, loss_ss: 0.659023, loss_d: 0.031523
0.1537 --- loss: 1.122616, loss_ss: 1.069346, loss_d: 0.053270
0.1922 --- loss: 1.246046, loss_ss: 1.136492, loss_d: 0.109554
0.2306 --- loss: 0.792115, loss_ss: 0.761886, loss_d: 0.030229
0.2690 --- loss: 1.326138, loss_ss: 0.993139, loss_d: 0.332999
0.3075 --- loss: 1.012012, loss_ss: 0.805328, loss_d: 0.206684
0.3459 --- loss: 0.981876, loss_ss: 0.940237, loss_d: 0.041639
0.3843 --- loss: 1.007479, loss_ss: 0.736898, loss_d: 0.270581
0.4228 --- loss: 1.054530, loss_ss: 0.824045, loss_d: 0.230485
0.4612 --- loss: 2.101793, loss_ss: 1.192002, loss_d: 0.909791
0.4996 --- loss: 1.692676, loss_ss: 1.477801, loss_d: 0.214875
0.5380 --- loss: 1.168522, loss_ss: 0.902616, loss_d: 0.265906
0.5765 --- loss: 1.143867, loss_ss: 1.040746, loss_d: 0.103121
0.6149 --- loss: 1.213660, loss_ss: 0.931452, loss_d: 0.282208
0.6533 --- loss: 1.638282, loss_ss: 0.870626, loss_d: 0.767656
0.6918 --- loss: 0.849324, loss_ss: 0.767063, loss_d: 0.082261
0.7302 --- loss: 1.405550, loss_ss: 1.143609, loss_d: 0.261941
0.7686 --- loss: 1.129814, loss_ss: 1.048800, loss_d: 0.081015
0.8071 --- loss: 0.915235, loss_ss: 0.624093, loss_d: 0.291142
0.8455 --- loss: 0.936040, loss_ss: 0.865757, loss_d: 0.070283
0.8839 --- loss: 0.916622, loss_ss: 0.781805, loss_d: 0.134818
0.9224 --- loss: 1.200724, loss_ss: 1.023752, loss_d: 0.176972
0.9608 --- loss: 0.947096, loss_ss: 0.880463, loss_d: 0.066633
0.9992 --- loss: 3.032733, loss_ss: 1.247570, loss_d: 1.785164
Epoch finished! Loss: 1.0888423291536478
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.065196, loss_ss: 0.887739, loss_d: 0.177457
0.0384 --- loss: 1.051991, loss_ss: 0.915940, loss_d: 0.136051
0.0769 --- loss: 1.730156, loss_ss: 1.623455, loss_d: 0.106700
0.1153 --- loss: 0.997604, loss_ss: 0.854324, loss_d: 0.143279
0.1537 --- loss: 0.869545, loss_ss: 0.717617, loss_d: 0.151929
0.1922 --- loss: 0.834541, loss_ss: 0.679714, loss_d: 0.154827
0.2306 --- loss: 1.342172, loss_ss: 1.076734, loss_d: 0.265438
0.2690 --- loss: 0.690180, loss_ss: 0.607566, loss_d: 0.082613
0.3075 --- loss: 0.729892, loss_ss: 0.697755, loss_d: 0.032136
0.3459 --- loss: 0.798063, loss_ss: 0.776782, loss_d: 0.021281
0.3843 --- loss: 1.298034, loss_ss: 1.032119, loss_d: 0.265916
0.4228 --- loss: 0.917058, loss_ss: 0.863386, loss_d: 0.053672
0.4612 --- loss: 0.905431, loss_ss: 0.792508, loss_d: 0.112922
0.4996 --- loss: 1.026418, loss_ss: 0.920074, loss_d: 0.106344
0.5380 --- loss: 0.948973, loss_ss: 0.624618, loss_d: 0.324355
0.5765 --- loss: 1.278667, loss_ss: 1.165798, loss_d: 0.112869
0.6149 --- loss: 1.295252, loss_ss: 1.263444, loss_d: 0.031808
0.6533 --- loss: 0.671092, loss_ss: 0.644992, loss_d: 0.026100
0.6918 --- loss: 1.322638, loss_ss: 0.545968, loss_d: 0.776670
0.7302 --- loss: 0.836571, loss_ss: 0.825382, loss_d: 0.011189
0.7686 --- loss: 0.814640, loss_ss: 0.691673, loss_d: 0.122967
0.8071 --- loss: 0.838408, loss_ss: 0.791419, loss_d: 0.046989
0.8455 --- loss: 0.938324, loss_ss: 0.781923, loss_d: 0.156401
0.8839 --- loss: 0.683647, loss_ss: 0.633331, loss_d: 0.050315
0.9224 --- loss: 1.225916, loss_ss: 0.968528, loss_d: 0.257388
0.9608 --- loss: 0.886527, loss_ss: 0.856803, loss_d: 0.029724
0.9992 --- loss: 2.780634, loss_ss: 2.770489, loss_d: 0.010145
Epoch finished! Loss: 1.0416684820101811
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.800033, loss_ss: 0.768118, loss_d: 0.031914
0.0384 --- loss: 0.992013, loss_ss: 0.919241, loss_d: 0.072772
0.0769 --- loss: 0.864832, loss_ss: 0.852204, loss_d: 0.012627
0.1153 --- loss: 1.102539, loss_ss: 0.952533, loss_d: 0.150006
0.1537 --- loss: 0.836516, loss_ss: 0.779483, loss_d: 0.057033
0.1922 --- loss: 0.831601, loss_ss: 0.655312, loss_d: 0.176289
0.2306 --- loss: 0.854041, loss_ss: 0.783410, loss_d: 0.070631
0.2690 --- loss: 1.114215, loss_ss: 0.956580, loss_d: 0.157635
0.3075 --- loss: 0.685309, loss_ss: 0.592547, loss_d: 0.092761
0.3459 --- loss: 0.977936, loss_ss: 0.858813, loss_d: 0.119123
0.3843 --- loss: 1.112232, loss_ss: 0.943755, loss_d: 0.168477
0.4228 --- loss: 0.796209, loss_ss: 0.784491, loss_d: 0.011717
0.4612 --- loss: 0.969895, loss_ss: 0.907846, loss_d: 0.062049
0.4996 --- loss: 1.169801, loss_ss: 0.823401, loss_d: 0.346400
0.5380 --- loss: 0.987742, loss_ss: 0.945750, loss_d: 0.041993
0.5765 --- loss: 0.892630, loss_ss: 0.695365, loss_d: 0.197265
0.6149 --- loss: 1.701635, loss_ss: 1.107378, loss_d: 0.594257
0.6533 --- loss: 0.912522, loss_ss: 0.861877, loss_d: 0.050646
0.6918 --- loss: 0.815094, loss_ss: 0.712788, loss_d: 0.102306
0.7302 --- loss: 1.517914, loss_ss: 0.858016, loss_d: 0.659898
0.7686 --- loss: 0.904426, loss_ss: 0.820587, loss_d: 0.083839
0.8071 --- loss: 0.902532, loss_ss: 0.879328, loss_d: 0.023204
0.8455 --- loss: 1.074224, loss_ss: 0.767479, loss_d: 0.306744
0.8839 --- loss: 0.847686, loss_ss: 0.839952, loss_d: 0.007734
0.9224 --- loss: 0.764769, loss_ss: 0.756340, loss_d: 0.008429
0.9608 --- loss: 1.171675, loss_ss: 0.956336, loss_d: 0.215338
0.9992 --- loss: 5.373590, loss_ss: 2.083449, loss_d: 3.290142
Epoch finished! Loss: 1.0090053147994555
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.198948, loss_ss: 0.825628, loss_d: 0.373320
0.0384 --- loss: 0.770444, loss_ss: 0.685449, loss_d: 0.084995
0.0769 --- loss: 1.066612, loss_ss: 0.887827, loss_d: 0.178784
0.1153 --- loss: 0.790110, loss_ss: 0.764709, loss_d: 0.025401
0.1537 --- loss: 0.997766, loss_ss: 0.952165, loss_d: 0.045602
0.1922 --- loss: 0.718711, loss_ss: 0.596149, loss_d: 0.122562
0.2306 --- loss: 0.758700, loss_ss: 0.702036, loss_d: 0.056665
0.2690 --- loss: 0.822150, loss_ss: 0.809467, loss_d: 0.012683
0.3075 --- loss: 0.766366, loss_ss: 0.747686, loss_d: 0.018680
0.3459 --- loss: 1.007560, loss_ss: 0.827417, loss_d: 0.180143
0.3843 --- loss: 0.967418, loss_ss: 0.919353, loss_d: 0.048065
0.4228 --- loss: 0.835333, loss_ss: 0.824880, loss_d: 0.010453
0.4612 --- loss: 0.812121, loss_ss: 0.692673, loss_d: 0.119449
0.4996 --- loss: 0.755405, loss_ss: 0.688585, loss_d: 0.066819
0.5380 --- loss: 0.853999, loss_ss: 0.780686, loss_d: 0.073313
0.5765 --- loss: 0.821855, loss_ss: 0.695046, loss_d: 0.126809
0.6149 --- loss: 0.673931, loss_ss: 0.588305, loss_d: 0.085626
0.6533 --- loss: 2.074484, loss_ss: 0.796978, loss_d: 1.277506
0.6918 --- loss: 0.991376, loss_ss: 0.771978, loss_d: 0.219399
0.7302 --- loss: 1.614937, loss_ss: 1.038332, loss_d: 0.576605
0.7686 --- loss: 1.120169, loss_ss: 1.037732, loss_d: 0.082437
0.8071 --- loss: 1.058941, loss_ss: 1.003983, loss_d: 0.054958
0.8455 --- loss: 0.759998, loss_ss: 0.715778, loss_d: 0.044221
0.8839 --- loss: 1.183757, loss_ss: 1.112899, loss_d: 0.070858
0.9224 --- loss: 1.204383, loss_ss: 1.191498, loss_d: 0.012884
0.9608 --- loss: 0.779943, loss_ss: 0.739088, loss_d: 0.040855
0.9992 --- loss: 2.650040, loss_ss: 1.241763, loss_d: 1.408276
Epoch finished! Loss: 0.9896050398166363
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.687037037037037
             precision    recall  f1-score   support

        0.0       0.89      0.33      0.48       120
        1.0       0.65      0.52      0.58       322
        2.0       0.64      0.88      0.74       274
        3.0       1.00      0.76      0.86       224
        4.0       0.53      0.91      0.67       140

avg / total       0.73      0.69      0.68      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.04  32.50   99.48   88.64     47.56
1  77.41  51.55   88.39   65.35     57.64
2  84.54  87.59   83.50   64.34     74.19
3  95.00  75.89  100.00  100.00     86.29
4  88.43  90.71   88.09   53.14     67.02
Total accuracy: 68.70%
Average sen: 67.65%
Average spec: 91.89%
Macro f1-score: 66.54%
Diagnosis acc on 15mins: 1.0
[0.9999969  0.99936241 0.95502675 0.9892379  0.99112427 0.99981564
 0.99984777 0.99998474 0.99998677 0.99999774 0.99994063 0.99935442
 0.99934953 0.99851054 0.99624252 0.99820578 0.99994719 0.99997139
 0.99999547 0.99991238 0.9999975  0.99999714 0.99992204 0.99999905
 0.99928445 0.99995863 0.99898487 0.99924123 0.99061757 0.99926692
 0.99999177 0.99999547 0.99998093 0.99992478 0.99985301 0.99999821]
pred: 0.9975784536865022, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.683503, loss_ss: 1.972942, loss_d: 0.710562
0.0385 --- loss: 2.543162, loss_ss: 1.685069, loss_d: 0.858093
0.0769 --- loss: 2.053608, loss_ss: 1.613852, loss_d: 0.439756
0.1154 --- loss: 2.038077, loss_ss: 1.440896, loss_d: 0.597181
0.1538 --- loss: 2.007792, loss_ss: 1.386375, loss_d: 0.621418
0.1923 --- loss: 2.127926, loss_ss: 1.456686, loss_d: 0.671240
0.2308 --- loss: 2.162912, loss_ss: 1.351301, loss_d: 0.811611
0.2692 --- loss: 2.247818, loss_ss: 1.270559, loss_d: 0.977259
0.3077 --- loss: 1.929281, loss_ss: 1.351327, loss_d: 0.577954
0.3462 --- loss: 2.134057, loss_ss: 1.432508, loss_d: 0.701549
0.3846 --- loss: 1.829564, loss_ss: 1.225713, loss_d: 0.603851
0.4231 --- loss: 1.945415, loss_ss: 1.286611, loss_d: 0.658805
0.4615 --- loss: 1.886852, loss_ss: 1.406822, loss_d: 0.480030
0.5000 --- loss: 1.545168, loss_ss: 1.260122, loss_d: 0.285046
0.5385 --- loss: 1.830735, loss_ss: 1.380390, loss_d: 0.450345
0.5769 --- loss: 2.077837, loss_ss: 1.351218, loss_d: 0.726619
0.6154 --- loss: 1.999545, loss_ss: 1.318928, loss_d: 0.680616
0.6538 --- loss: 2.002654, loss_ss: 1.492072, loss_d: 0.510583
0.6923 --- loss: 2.023919, loss_ss: 1.437815, loss_d: 0.586104
0.7308 --- loss: 1.752023, loss_ss: 1.300580, loss_d: 0.451444
0.7692 --- loss: 1.676569, loss_ss: 1.263327, loss_d: 0.413242
0.8077 --- loss: 1.499458, loss_ss: 1.173342, loss_d: 0.326116
0.8462 --- loss: 2.150329, loss_ss: 1.378517, loss_d: 0.771812
0.8846 --- loss: 1.668794, loss_ss: 1.328247, loss_d: 0.340547
0.9231 --- loss: 2.108475, loss_ss: 1.442767, loss_d: 0.665708
0.9615 --- loss: 1.507661, loss_ss: 1.062647, loss_d: 0.445014
Epoch finished! Loss: 1.925978499029594
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.739836, loss_ss: 1.466249, loss_d: 0.273587
0.0385 --- loss: 1.543002, loss_ss: 1.318249, loss_d: 0.224753
0.0769 --- loss: 1.484892, loss_ss: 1.183205, loss_d: 0.301688
0.1154 --- loss: 1.604416, loss_ss: 1.128252, loss_d: 0.476164
0.1538 --- loss: 1.710523, loss_ss: 1.342382, loss_d: 0.368141
0.1923 --- loss: 1.581697, loss_ss: 1.280919, loss_d: 0.300778
0.2308 --- loss: 1.383636, loss_ss: 0.962954, loss_d: 0.420682
0.2692 --- loss: 1.627077, loss_ss: 1.205048, loss_d: 0.422029
0.3077 --- loss: 1.767726, loss_ss: 1.137210, loss_d: 0.630516
0.3462 --- loss: 1.304850, loss_ss: 0.911946, loss_d: 0.392904
0.3846 --- loss: 1.253924, loss_ss: 0.993225, loss_d: 0.260698
0.4231 --- loss: 1.338825, loss_ss: 1.015136, loss_d: 0.323690
0.4615 --- loss: 1.352626, loss_ss: 1.009332, loss_d: 0.343294
0.5000 --- loss: 1.427376, loss_ss: 1.106754, loss_d: 0.320623
0.5385 --- loss: 1.187814, loss_ss: 0.973731, loss_d: 0.214083
0.5769 --- loss: 1.234328, loss_ss: 0.996436, loss_d: 0.237891
0.6154 --- loss: 1.445145, loss_ss: 1.280663, loss_d: 0.164482
0.6538 --- loss: 1.303962, loss_ss: 0.958881, loss_d: 0.345081
0.6923 --- loss: 1.306700, loss_ss: 0.939264, loss_d: 0.367436
0.7308 --- loss: 1.348263, loss_ss: 0.955601, loss_d: 0.392663
0.7692 --- loss: 1.162749, loss_ss: 0.791185, loss_d: 0.371564
0.8077 --- loss: 1.581886, loss_ss: 1.051714, loss_d: 0.530173
0.8462 --- loss: 1.672854, loss_ss: 1.056771, loss_d: 0.616083
0.8846 --- loss: 1.244195, loss_ss: 1.121745, loss_d: 0.122449
0.9231 --- loss: 1.414724, loss_ss: 0.905420, loss_d: 0.509304
0.9615 --- loss: 1.129448, loss_ss: 0.933514, loss_d: 0.195934
Epoch finished! Loss: 1.4768620227754807
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.124207, loss_ss: 0.873759, loss_d: 0.250448
0.0385 --- loss: 1.039315, loss_ss: 0.827945, loss_d: 0.211371
0.0769 --- loss: 1.243841, loss_ss: 1.025884, loss_d: 0.217957
0.1154 --- loss: 1.334096, loss_ss: 1.020436, loss_d: 0.313660
0.1538 --- loss: 1.056012, loss_ss: 0.908126, loss_d: 0.147886
0.1923 --- loss: 0.929706, loss_ss: 0.786130, loss_d: 0.143576
0.2308 --- loss: 1.816713, loss_ss: 1.250964, loss_d: 0.565749
0.2692 --- loss: 1.114458, loss_ss: 0.941279, loss_d: 0.173179
0.3077 --- loss: 1.272832, loss_ss: 1.047493, loss_d: 0.225339
0.3462 --- loss: 1.016563, loss_ss: 0.844902, loss_d: 0.171661
0.3846 --- loss: 1.369280, loss_ss: 0.925865, loss_d: 0.443415
0.4231 --- loss: 1.266968, loss_ss: 1.001968, loss_d: 0.265001
0.4615 --- loss: 1.136290, loss_ss: 0.918098, loss_d: 0.218192
0.5000 --- loss: 1.367765, loss_ss: 0.847317, loss_d: 0.520448
0.5385 --- loss: 1.115656, loss_ss: 0.961404, loss_d: 0.154252
0.5769 --- loss: 1.177735, loss_ss: 0.883200, loss_d: 0.294535
0.6154 --- loss: 1.316466, loss_ss: 1.028686, loss_d: 0.287780
0.6538 --- loss: 1.307188, loss_ss: 0.969782, loss_d: 0.337407
0.6923 --- loss: 1.125562, loss_ss: 1.038035, loss_d: 0.087528
0.7308 --- loss: 1.142675, loss_ss: 0.923660, loss_d: 0.219015
0.7692 --- loss: 1.166430, loss_ss: 1.056743, loss_d: 0.109687
0.8077 --- loss: 1.168047, loss_ss: 0.891948, loss_d: 0.276099
0.8462 --- loss: 1.438901, loss_ss: 0.910012, loss_d: 0.528889
0.8846 --- loss: 1.052583, loss_ss: 0.830672, loss_d: 0.221910
0.9231 --- loss: 1.272984, loss_ss: 1.092199, loss_d: 0.180786
0.9615 --- loss: 1.260960, loss_ss: 1.132013, loss_d: 0.128947
Epoch finished! Loss: 1.2852038761823794
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.956368, loss_ss: 0.895548, loss_d: 0.060820
0.0385 --- loss: 1.240084, loss_ss: 0.993728, loss_d: 0.246356
0.0769 --- loss: 0.985400, loss_ss: 0.784803, loss_d: 0.200597
0.1154 --- loss: 1.316159, loss_ss: 1.245535, loss_d: 0.070624
0.1538 --- loss: 0.947410, loss_ss: 0.906948, loss_d: 0.040461
0.1923 --- loss: 1.584893, loss_ss: 1.393851, loss_d: 0.191042
0.2308 --- loss: 0.992373, loss_ss: 0.895702, loss_d: 0.096671
0.2692 --- loss: 1.398781, loss_ss: 1.032245, loss_d: 0.366536
0.3077 --- loss: 1.230644, loss_ss: 1.168278, loss_d: 0.062366
0.3462 --- loss: 0.872761, loss_ss: 0.682043, loss_d: 0.190718
0.3846 --- loss: 1.069378, loss_ss: 0.914310, loss_d: 0.155068
0.4231 --- loss: 1.171726, loss_ss: 0.979787, loss_d: 0.191939
0.4615 --- loss: 1.220815, loss_ss: 0.919122, loss_d: 0.301692
0.5000 --- loss: 1.009778, loss_ss: 0.912672, loss_d: 0.097106
0.5385 --- loss: 1.275331, loss_ss: 1.240034, loss_d: 0.035297
0.5769 --- loss: 1.526900, loss_ss: 1.216465, loss_d: 0.310435
0.6154 --- loss: 1.272194, loss_ss: 1.034318, loss_d: 0.237876
0.6538 --- loss: 1.043923, loss_ss: 0.676413, loss_d: 0.367510
0.6923 --- loss: 0.985390, loss_ss: 0.961808, loss_d: 0.023582
0.7308 --- loss: 1.030542, loss_ss: 0.733147, loss_d: 0.297395
0.7692 --- loss: 0.947104, loss_ss: 0.809012, loss_d: 0.138092
0.8077 --- loss: 0.934543, loss_ss: 0.840793, loss_d: 0.093750
0.8462 --- loss: 1.498304, loss_ss: 0.888094, loss_d: 0.610210
0.8846 --- loss: 1.114786, loss_ss: 0.974054, loss_d: 0.140731
0.9231 --- loss: 1.107998, loss_ss: 0.984614, loss_d: 0.123384
0.9615 --- loss: 1.317740, loss_ss: 1.141206, loss_d: 0.176534
Epoch finished! Loss: 1.183713101282083
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.904141, loss_ss: 0.778591, loss_d: 0.125550
0.0385 --- loss: 0.905967, loss_ss: 0.817405, loss_d: 0.088562
0.0769 --- loss: 0.635985, loss_ss: 0.587963, loss_d: 0.048021
0.1154 --- loss: 0.744900, loss_ss: 0.669887, loss_d: 0.075013
0.1538 --- loss: 0.901676, loss_ss: 0.635657, loss_d: 0.266019
0.1923 --- loss: 0.891661, loss_ss: 0.803612, loss_d: 0.088049
0.2308 --- loss: 1.110723, loss_ss: 1.045956, loss_d: 0.064767
0.2692 --- loss: 1.174794, loss_ss: 0.884088, loss_d: 0.290706
0.3077 --- loss: 1.036575, loss_ss: 0.934317, loss_d: 0.102258
0.3462 --- loss: 1.181261, loss_ss: 0.770464, loss_d: 0.410797
0.3846 --- loss: 1.059755, loss_ss: 0.864357, loss_d: 0.195398
0.4231 --- loss: 0.982287, loss_ss: 0.819402, loss_d: 0.162884
0.4615 --- loss: 0.942792, loss_ss: 0.871126, loss_d: 0.071666
0.5000 --- loss: 1.142299, loss_ss: 0.673519, loss_d: 0.468780
0.5385 --- loss: 1.129984, loss_ss: 0.897837, loss_d: 0.232147
0.5769 --- loss: 0.706277, loss_ss: 0.670227, loss_d: 0.036050
0.6154 --- loss: 0.803022, loss_ss: 0.783713, loss_d: 0.019309
0.6538 --- loss: 0.940967, loss_ss: 0.844907, loss_d: 0.096060
0.6923 --- loss: 1.111363, loss_ss: 0.918345, loss_d: 0.193019
0.7308 --- loss: 1.164001, loss_ss: 1.008128, loss_d: 0.155873
0.7692 --- loss: 1.928867, loss_ss: 0.709053, loss_d: 1.219815
0.8077 --- loss: 0.996520, loss_ss: 0.880362, loss_d: 0.116158
0.8462 --- loss: 1.063782, loss_ss: 0.923669, loss_d: 0.140113
0.8846 --- loss: 0.715077, loss_ss: 0.688154, loss_d: 0.026923
0.9231 --- loss: 1.329189, loss_ss: 1.246120, loss_d: 0.083069
0.9615 --- loss: 1.233448, loss_ss: 1.142268, loss_d: 0.091179
Epoch finished! Loss: 1.0565101253480065
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.847018, loss_ss: 0.775263, loss_d: 0.071756
0.0385 --- loss: 1.052227, loss_ss: 0.995767, loss_d: 0.056460
0.0769 --- loss: 1.342931, loss_ss: 0.499411, loss_d: 0.843520
0.1154 --- loss: 0.904665, loss_ss: 0.797634, loss_d: 0.107031
0.1538 --- loss: 0.858488, loss_ss: 0.692607, loss_d: 0.165881
0.1923 --- loss: 1.382550, loss_ss: 1.195529, loss_d: 0.187021
0.2308 --- loss: 0.851621, loss_ss: 0.831195, loss_d: 0.020426
0.2692 --- loss: 1.505199, loss_ss: 0.769888, loss_d: 0.735311
0.3077 --- loss: 0.772957, loss_ss: 0.665132, loss_d: 0.107825
0.3462 --- loss: 0.832289, loss_ss: 0.706962, loss_d: 0.125327
0.3846 --- loss: 1.160657, loss_ss: 0.873194, loss_d: 0.287462
0.4231 --- loss: 1.041602, loss_ss: 0.897397, loss_d: 0.144206
0.4615 --- loss: 0.821294, loss_ss: 0.667905, loss_d: 0.153388
0.5000 --- loss: 1.124636, loss_ss: 1.014804, loss_d: 0.109833
0.5385 --- loss: 1.453833, loss_ss: 0.812013, loss_d: 0.641820
0.5769 --- loss: 0.713559, loss_ss: 0.650759, loss_d: 0.062800
0.6154 --- loss: 1.188456, loss_ss: 1.055355, loss_d: 0.133101
0.6538 --- loss: 0.828703, loss_ss: 0.602392, loss_d: 0.226311
0.6923 --- loss: 1.548703, loss_ss: 1.449734, loss_d: 0.098969
0.7308 --- loss: 0.748171, loss_ss: 0.700082, loss_d: 0.048088
0.7692 --- loss: 0.781854, loss_ss: 0.723780, loss_d: 0.058074
0.8077 --- loss: 1.092463, loss_ss: 1.049758, loss_d: 0.042705
0.8462 --- loss: 0.713124, loss_ss: 0.689492, loss_d: 0.023632
0.8846 --- loss: 1.277549, loss_ss: 0.599438, loss_d: 0.678112
0.9231 --- loss: 0.842319, loss_ss: 0.804844, loss_d: 0.037474
0.9615 --- loss: 1.139889, loss_ss: 1.050807, loss_d: 0.089082
Epoch finished! Loss: 1.0505625414572166
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.149918, loss_ss: 0.854938, loss_d: 0.294979
0.0385 --- loss: 1.102158, loss_ss: 0.786068, loss_d: 0.316090
0.0769 --- loss: 1.133257, loss_ss: 0.973356, loss_d: 0.159902
0.1154 --- loss: 1.043839, loss_ss: 0.994075, loss_d: 0.049763
0.1538 --- loss: 0.692212, loss_ss: 0.656336, loss_d: 0.035876
0.1923 --- loss: 0.847475, loss_ss: 0.780373, loss_d: 0.067102
0.2308 --- loss: 0.792678, loss_ss: 0.772123, loss_d: 0.020556
0.2692 --- loss: 1.071903, loss_ss: 1.040458, loss_d: 0.031446
0.3077 --- loss: 1.018525, loss_ss: 0.929717, loss_d: 0.088808
0.3462 --- loss: 0.920250, loss_ss: 0.830007, loss_d: 0.090242
0.3846 --- loss: 0.867813, loss_ss: 0.841928, loss_d: 0.025885
0.4231 --- loss: 0.922666, loss_ss: 0.846830, loss_d: 0.075836
0.4615 --- loss: 1.221881, loss_ss: 1.087943, loss_d: 0.133938
0.5000 --- loss: 1.221435, loss_ss: 1.016345, loss_d: 0.205090
0.5385 --- loss: 0.953457, loss_ss: 0.760178, loss_d: 0.193279
0.5769 --- loss: 0.718791, loss_ss: 0.650819, loss_d: 0.067972
0.6154 --- loss: 0.852053, loss_ss: 0.717304, loss_d: 0.134749
0.6538 --- loss: 1.019946, loss_ss: 0.980717, loss_d: 0.039229
0.6923 --- loss: 0.983733, loss_ss: 0.830687, loss_d: 0.153046
0.7308 --- loss: 0.765493, loss_ss: 0.748421, loss_d: 0.017072
0.7692 --- loss: 0.923822, loss_ss: 0.804210, loss_d: 0.119612
0.8077 --- loss: 0.826250, loss_ss: 0.741112, loss_d: 0.085138
0.8462 --- loss: 0.925405, loss_ss: 0.889132, loss_d: 0.036272
0.8846 --- loss: 1.134024, loss_ss: 0.914361, loss_d: 0.219663
0.9231 --- loss: 1.147648, loss_ss: 0.872914, loss_d: 0.274734
0.9615 --- loss: 0.877972, loss_ss: 0.873042, loss_d: 0.004930
Epoch finished! Loss: 0.983862182578525
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.754656, loss_ss: 0.693715, loss_d: 0.060941
0.0385 --- loss: 1.194615, loss_ss: 1.039459, loss_d: 0.155156
0.0769 --- loss: 1.002923, loss_ss: 0.856858, loss_d: 0.146065
0.1154 --- loss: 0.903445, loss_ss: 0.898206, loss_d: 0.005240
0.1538 --- loss: 0.634552, loss_ss: 0.610268, loss_d: 0.024284
0.1923 --- loss: 1.101762, loss_ss: 0.738320, loss_d: 0.363442
0.2308 --- loss: 0.965497, loss_ss: 0.760790, loss_d: 0.204707
0.2692 --- loss: 0.964257, loss_ss: 0.800182, loss_d: 0.164075
0.3077 --- loss: 1.057131, loss_ss: 0.999939, loss_d: 0.057193
0.3462 --- loss: 0.930084, loss_ss: 0.879980, loss_d: 0.050104
0.3846 --- loss: 1.083130, loss_ss: 0.749533, loss_d: 0.333597
0.4231 --- loss: 0.798538, loss_ss: 0.734737, loss_d: 0.063802
0.4615 --- loss: 0.848767, loss_ss: 0.725877, loss_d: 0.122890
0.5000 --- loss: 1.146149, loss_ss: 1.018940, loss_d: 0.127209
0.5385 --- loss: 0.838125, loss_ss: 0.764537, loss_d: 0.073588
0.5769 --- loss: 1.200301, loss_ss: 0.909960, loss_d: 0.290341
0.6154 --- loss: 0.761599, loss_ss: 0.742025, loss_d: 0.019573
0.6538 --- loss: 0.844448, loss_ss: 0.779660, loss_d: 0.064787
0.6923 --- loss: 0.990246, loss_ss: 0.675465, loss_d: 0.314781
0.7308 --- loss: 0.705677, loss_ss: 0.691120, loss_d: 0.014557
0.7692 --- loss: 0.971357, loss_ss: 0.784933, loss_d: 0.186424
0.8077 --- loss: 0.908264, loss_ss: 0.857045, loss_d: 0.051219
0.8462 --- loss: 0.861187, loss_ss: 0.538659, loss_d: 0.322528
0.8846 --- loss: 0.779518, loss_ss: 0.725557, loss_d: 0.053961
0.9231 --- loss: 0.891689, loss_ss: 0.822201, loss_d: 0.069488
0.9615 --- loss: 0.884122, loss_ss: 0.871651, loss_d: 0.012471
Epoch finished! Loss: 0.9550132798642266
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.902454, loss_ss: 0.718885, loss_d: 0.183568
0.0385 --- loss: 0.839689, loss_ss: 0.678637, loss_d: 0.161051
0.0769 --- loss: 0.609047, loss_ss: 0.597326, loss_d: 0.011722
0.1154 --- loss: 0.601796, loss_ss: 0.546477, loss_d: 0.055320
0.1538 --- loss: 0.771535, loss_ss: 0.740117, loss_d: 0.031418
0.1923 --- loss: 0.684427, loss_ss: 0.663623, loss_d: 0.020804
0.2308 --- loss: 1.073907, loss_ss: 0.880593, loss_d: 0.193314
0.2692 --- loss: 1.259462, loss_ss: 1.039580, loss_d: 0.219881
0.3077 --- loss: 0.698119, loss_ss: 0.639059, loss_d: 0.059059
0.3462 --- loss: 0.875285, loss_ss: 0.814426, loss_d: 0.060859
0.3846 --- loss: 0.756283, loss_ss: 0.739201, loss_d: 0.017083
0.4231 --- loss: 0.779382, loss_ss: 0.769217, loss_d: 0.010165
0.4615 --- loss: 0.735795, loss_ss: 0.722291, loss_d: 0.013505
0.5000 --- loss: 0.916385, loss_ss: 0.856893, loss_d: 0.059492
0.5385 --- loss: 0.788358, loss_ss: 0.611091, loss_d: 0.177267
0.5769 --- loss: 0.753669, loss_ss: 0.743695, loss_d: 0.009974
0.6154 --- loss: 0.786454, loss_ss: 0.763112, loss_d: 0.023342
0.6538 --- loss: 1.278402, loss_ss: 0.943420, loss_d: 0.334982
0.6923 --- loss: 0.889611, loss_ss: 0.707197, loss_d: 0.182414
0.7308 --- loss: 1.425483, loss_ss: 0.963438, loss_d: 0.462045
0.7692 --- loss: 1.450130, loss_ss: 0.709172, loss_d: 0.740958
0.8077 --- loss: 0.787734, loss_ss: 0.740434, loss_d: 0.047300
0.8462 --- loss: 0.898728, loss_ss: 0.864699, loss_d: 0.034029
0.8846 --- loss: 0.761193, loss_ss: 0.721585, loss_d: 0.039608
0.9231 --- loss: 1.181354, loss_ss: 0.917567, loss_d: 0.263787
0.9615 --- loss: 0.881746, loss_ss: 0.727355, loss_d: 0.154391
Epoch finished! Loss: 0.9532592538240794
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.921989, loss_ss: 0.890557, loss_d: 0.031432
0.0385 --- loss: 0.786485, loss_ss: 0.752909, loss_d: 0.033575
0.0769 --- loss: 1.219535, loss_ss: 1.203008, loss_d: 0.016527
0.1154 --- loss: 1.298042, loss_ss: 0.902628, loss_d: 0.395414
0.1538 --- loss: 1.001035, loss_ss: 0.933586, loss_d: 0.067449
0.1923 --- loss: 0.888957, loss_ss: 0.873186, loss_d: 0.015771
0.2308 --- loss: 1.340319, loss_ss: 1.293191, loss_d: 0.047128
0.2692 --- loss: 0.866781, loss_ss: 0.816701, loss_d: 0.050080
0.3077 --- loss: 0.974770, loss_ss: 0.933087, loss_d: 0.041683
0.3462 --- loss: 1.435876, loss_ss: 1.199001, loss_d: 0.236875
0.3846 --- loss: 0.770852, loss_ss: 0.752274, loss_d: 0.018578
0.4231 --- loss: 0.757256, loss_ss: 0.718967, loss_d: 0.038289
0.4615 --- loss: 0.725287, loss_ss: 0.718331, loss_d: 0.006956
0.5000 --- loss: 0.771729, loss_ss: 0.740591, loss_d: 0.031138
0.5385 --- loss: 0.968665, loss_ss: 0.953499, loss_d: 0.015166
0.5769 --- loss: 0.871317, loss_ss: 0.804670, loss_d: 0.066647
0.6154 --- loss: 0.835598, loss_ss: 0.662487, loss_d: 0.173111
0.6538 --- loss: 1.067764, loss_ss: 0.964654, loss_d: 0.103110
0.6923 --- loss: 1.160277, loss_ss: 0.936831, loss_d: 0.223447
0.7308 --- loss: 0.765020, loss_ss: 0.703257, loss_d: 0.061763
0.7692 --- loss: 0.841474, loss_ss: 0.726015, loss_d: 0.115459
0.8077 --- loss: 0.753233, loss_ss: 0.679831, loss_d: 0.073402
0.8462 --- loss: 0.802093, loss_ss: 0.751715, loss_d: 0.050378
0.8846 --- loss: 0.732708, loss_ss: 0.724432, loss_d: 0.008276
0.9231 --- loss: 0.694822, loss_ss: 0.655923, loss_d: 0.038899
0.9615 --- loss: 0.610465, loss_ss: 0.602685, loss_d: 0.007781
Epoch finished! Loss: 0.9221034188068051
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6859649122807018
             precision    recall  f1-score   support

        0.0       0.85      0.66      0.74       166
        1.0       0.15      0.62      0.24        58
        2.0       0.77      0.77      0.77       397
        3.0       0.85      0.85      0.85       165
        4.0       0.95      0.54      0.69       354

avg / total       0.82      0.69      0.72      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.33  66.27   97.95  84.62     74.32
1  79.56  62.07   80.50  14.57     23.61
2  83.77  76.83   87.48  76.63     76.73
3  95.70  84.85   97.54  85.37     85.11
4  84.82  53.95   98.73  95.02     68.83
Total accuracy: 68.60%
Average sen: 68.79%
Average spec: 92.44%
Macro f1-score: 65.72%
Diagnosis acc on 15mins: 1.0
[0.99128354 0.99972588 0.99994385 0.99992919 0.99718589 0.99653935
 0.99998152 0.99989438 0.99942195 0.98209906 0.99968123 0.99934191
 0.99893755 0.99922621 0.99900585 0.9990834  0.99784529 0.9244886
 0.99539387 0.99953198 0.99997926 0.99994957 0.99476612 0.99841738
 0.99970287 0.99961746 0.99764854 0.99906915 0.99459594 0.99922431
 0.99847144 0.99801958 0.97244883 0.98450989 0.99460149 0.9934988
 0.99613899 0.99948138]
pred: 0.9947021446729961, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.392188, loss_ss: 1.717403, loss_d: 0.674785
0.0384 --- loss: 2.535025, loss_ss: 1.705504, loss_d: 0.829521
0.0767 --- loss: 2.310200, loss_ss: 1.596245, loss_d: 0.713955
0.1151 --- loss: 2.086646, loss_ss: 1.561803, loss_d: 0.524843
0.1534 --- loss: 2.380332, loss_ss: 1.584234, loss_d: 0.796099
0.1918 --- loss: 2.285912, loss_ss: 1.491693, loss_d: 0.794219
0.2301 --- loss: 2.075547, loss_ss: 1.539878, loss_d: 0.535668
0.2685 --- loss: 1.940867, loss_ss: 1.357224, loss_d: 0.583643
0.3069 --- loss: 2.133454, loss_ss: 1.526224, loss_d: 0.607230
0.3452 --- loss: 1.918235, loss_ss: 1.399878, loss_d: 0.518357
0.3836 --- loss: 1.928945, loss_ss: 1.426678, loss_d: 0.502267
0.4219 --- loss: 1.701648, loss_ss: 1.175466, loss_d: 0.526182
0.4603 --- loss: 1.739792, loss_ss: 1.202053, loss_d: 0.537739
0.4987 --- loss: 2.163584, loss_ss: 1.466058, loss_d: 0.697525
0.5370 --- loss: 1.773945, loss_ss: 1.259306, loss_d: 0.514639
0.5754 --- loss: 2.151478, loss_ss: 1.393233, loss_d: 0.758245
0.6137 --- loss: 1.765203, loss_ss: 1.246026, loss_d: 0.519177
0.6521 --- loss: 1.788121, loss_ss: 1.429664, loss_d: 0.358457
0.6904 --- loss: 1.796849, loss_ss: 1.291289, loss_d: 0.505559
0.7288 --- loss: 1.616904, loss_ss: 1.210522, loss_d: 0.406382
0.7672 --- loss: 1.687469, loss_ss: 1.293616, loss_d: 0.393852
0.8055 --- loss: 1.702639, loss_ss: 1.306803, loss_d: 0.395835
0.8439 --- loss: 1.791672, loss_ss: 1.324073, loss_d: 0.467599
0.8822 --- loss: 1.624659, loss_ss: 1.286939, loss_d: 0.337719
0.9206 --- loss: 1.373585, loss_ss: 0.967333, loss_d: 0.406253
0.9590 --- loss: 1.593454, loss_ss: 1.265320, loss_d: 0.328135
0.9973 --- loss: 1.447633, loss_ss: 1.325073, loss_d: 0.122559
Epoch finished! Loss: 1.9180302028472607
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.459944, loss_ss: 1.315377, loss_d: 0.144568
0.0384 --- loss: 1.486762, loss_ss: 1.190247, loss_d: 0.296515
0.0767 --- loss: 1.338433, loss_ss: 1.096270, loss_d: 0.242164
0.1151 --- loss: 1.404126, loss_ss: 1.018137, loss_d: 0.385989
0.1534 --- loss: 1.731055, loss_ss: 1.374152, loss_d: 0.356903
0.1918 --- loss: 1.869886, loss_ss: 1.178360, loss_d: 0.691526
0.2301 --- loss: 1.472432, loss_ss: 1.202705, loss_d: 0.269727
0.2685 --- loss: 1.671162, loss_ss: 1.051705, loss_d: 0.619458
0.3069 --- loss: 1.486444, loss_ss: 1.101601, loss_d: 0.384842
0.3452 --- loss: 1.332532, loss_ss: 1.109907, loss_d: 0.222625
0.3836 --- loss: 1.563003, loss_ss: 1.019828, loss_d: 0.543175
0.4219 --- loss: 2.289222, loss_ss: 1.064775, loss_d: 1.224447
0.4603 --- loss: 1.547707, loss_ss: 1.217640, loss_d: 0.330066
0.4987 --- loss: 1.618356, loss_ss: 1.128527, loss_d: 0.489829
0.5370 --- loss: 1.555271, loss_ss: 1.127776, loss_d: 0.427494
0.5754 --- loss: 1.546328, loss_ss: 1.061313, loss_d: 0.485015
0.6137 --- loss: 1.426805, loss_ss: 0.968238, loss_d: 0.458567
0.6521 --- loss: 1.486479, loss_ss: 1.205206, loss_d: 0.281273
0.6904 --- loss: 1.192630, loss_ss: 0.925463, loss_d: 0.267167
0.7288 --- loss: 1.324939, loss_ss: 1.119143, loss_d: 0.205796
0.7672 --- loss: 1.668602, loss_ss: 1.345718, loss_d: 0.322884
0.8055 --- loss: 1.309219, loss_ss: 1.131773, loss_d: 0.177446
0.8439 --- loss: 1.712838, loss_ss: 0.950511, loss_d: 0.762327
0.8822 --- loss: 1.086855, loss_ss: 0.925064, loss_d: 0.161790
0.9206 --- loss: 1.161650, loss_ss: 1.006222, loss_d: 0.155428
0.9590 --- loss: 1.351374, loss_ss: 0.963761, loss_d: 0.387614
0.9973 --- loss: 1.273410, loss_ss: 1.004768, loss_d: 0.268642
Epoch finished! Loss: 1.4714500447878471
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.200646, loss_ss: 0.967927, loss_d: 0.232719
0.0384 --- loss: 1.256475, loss_ss: 0.967354, loss_d: 0.289121
0.0767 --- loss: 1.124394, loss_ss: 1.025847, loss_d: 0.098547
0.1151 --- loss: 0.958604, loss_ss: 0.868705, loss_d: 0.089899
0.1534 --- loss: 1.046637, loss_ss: 1.006786, loss_d: 0.039851
0.1918 --- loss: 1.054893, loss_ss: 0.939183, loss_d: 0.115710
0.2301 --- loss: 1.335287, loss_ss: 1.211413, loss_d: 0.123874
0.2685 --- loss: 1.113700, loss_ss: 1.013065, loss_d: 0.100635
0.3069 --- loss: 1.149146, loss_ss: 1.105958, loss_d: 0.043188
0.3452 --- loss: 1.212505, loss_ss: 1.131427, loss_d: 0.081078
0.3836 --- loss: 1.374813, loss_ss: 0.852185, loss_d: 0.522628
0.4219 --- loss: 1.708547, loss_ss: 1.110715, loss_d: 0.597832
0.4603 --- loss: 1.427171, loss_ss: 0.788223, loss_d: 0.638948
0.4987 --- loss: 1.412826, loss_ss: 0.872930, loss_d: 0.539895
0.5370 --- loss: 1.510278, loss_ss: 1.140280, loss_d: 0.369997
0.5754 --- loss: 1.342072, loss_ss: 1.011419, loss_d: 0.330653
0.6137 --- loss: 1.270162, loss_ss: 1.034841, loss_d: 0.235321
0.6521 --- loss: 1.126577, loss_ss: 1.051532, loss_d: 0.075045
0.6904 --- loss: 1.166408, loss_ss: 0.964156, loss_d: 0.202252
0.7288 --- loss: 1.395339, loss_ss: 1.145762, loss_d: 0.249577
0.7672 --- loss: 1.420402, loss_ss: 1.354677, loss_d: 0.065725
0.8055 --- loss: 1.478091, loss_ss: 0.954343, loss_d: 0.523749
0.8439 --- loss: 1.102333, loss_ss: 0.985561, loss_d: 0.116772
0.8822 --- loss: 1.455412, loss_ss: 0.907040, loss_d: 0.548372
0.9206 --- loss: 0.890940, loss_ss: 0.784209, loss_d: 0.106731
0.9590 --- loss: 1.400450, loss_ss: 0.771400, loss_d: 0.629050
0.9973 --- loss: 1.234271, loss_ss: 0.762010, loss_d: 0.472261
Epoch finished! Loss: 1.312361132640105
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.081903, loss_ss: 0.805054, loss_d: 0.276850
0.0384 --- loss: 1.064000, loss_ss: 0.983179, loss_d: 0.080821
0.0767 --- loss: 1.319158, loss_ss: 1.151415, loss_d: 0.167743
0.1151 --- loss: 1.175630, loss_ss: 0.820975, loss_d: 0.354655
0.1534 --- loss: 1.355554, loss_ss: 1.206701, loss_d: 0.148853
0.1918 --- loss: 0.921993, loss_ss: 0.690589, loss_d: 0.231404
0.2301 --- loss: 1.275583, loss_ss: 1.129474, loss_d: 0.146110
0.2685 --- loss: 0.966544, loss_ss: 0.828745, loss_d: 0.137799
0.3069 --- loss: 1.063437, loss_ss: 0.915362, loss_d: 0.148075
0.3452 --- loss: 1.065458, loss_ss: 0.912828, loss_d: 0.152631
0.3836 --- loss: 1.112597, loss_ss: 0.970429, loss_d: 0.142168
0.4219 --- loss: 1.228822, loss_ss: 1.072091, loss_d: 0.156731
0.4603 --- loss: 1.057559, loss_ss: 0.746511, loss_d: 0.311048
0.4987 --- loss: 1.393678, loss_ss: 0.983223, loss_d: 0.410454
0.5370 --- loss: 1.205040, loss_ss: 1.020809, loss_d: 0.184231
0.5754 --- loss: 0.766655, loss_ss: 0.703048, loss_d: 0.063607
0.6137 --- loss: 1.809013, loss_ss: 1.377194, loss_d: 0.431819
0.6521 --- loss: 1.418905, loss_ss: 1.290777, loss_d: 0.128128
0.6904 --- loss: 0.960973, loss_ss: 0.857597, loss_d: 0.103376
0.7288 --- loss: 1.030329, loss_ss: 0.924257, loss_d: 0.106072
0.7672 --- loss: 1.180161, loss_ss: 0.967376, loss_d: 0.212785
0.8055 --- loss: 1.322101, loss_ss: 0.891441, loss_d: 0.430660
0.8439 --- loss: 1.279273, loss_ss: 0.861314, loss_d: 0.417959
0.8822 --- loss: 0.801392, loss_ss: 0.713860, loss_d: 0.087532
0.9206 --- loss: 1.272178, loss_ss: 0.969604, loss_d: 0.302574
0.9590 --- loss: 0.932419, loss_ss: 0.867540, loss_d: 0.064879
0.9973 --- loss: 1.378368, loss_ss: 1.360295, loss_d: 0.018073
Epoch finished! Loss: 1.2127304987265513
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.112897, loss_ss: 1.086952, loss_d: 0.025945
0.0384 --- loss: 0.928364, loss_ss: 0.880548, loss_d: 0.047817
0.0767 --- loss: 0.938415, loss_ss: 0.831948, loss_d: 0.106467
0.1151 --- loss: 1.370304, loss_ss: 1.175859, loss_d: 0.194445
0.1534 --- loss: 1.125558, loss_ss: 0.791456, loss_d: 0.334102
0.1918 --- loss: 0.836652, loss_ss: 0.735446, loss_d: 0.101206
0.2301 --- loss: 1.519018, loss_ss: 1.037074, loss_d: 0.481944
0.2685 --- loss: 0.859259, loss_ss: 0.782356, loss_d: 0.076903
0.3069 --- loss: 0.787490, loss_ss: 0.617939, loss_d: 0.169551
0.3452 --- loss: 1.185081, loss_ss: 1.054699, loss_d: 0.130382
0.3836 --- loss: 1.055341, loss_ss: 0.768661, loss_d: 0.286680
0.4219 --- loss: 0.907118, loss_ss: 0.837807, loss_d: 0.069311
0.4603 --- loss: 1.176007, loss_ss: 1.138864, loss_d: 0.037142
0.4987 --- loss: 0.791356, loss_ss: 0.690902, loss_d: 0.100454
0.5370 --- loss: 0.912405, loss_ss: 0.771545, loss_d: 0.140860
0.5754 --- loss: 1.078948, loss_ss: 0.997792, loss_d: 0.081157
0.6137 --- loss: 1.481294, loss_ss: 1.007613, loss_d: 0.473681
0.6521 --- loss: 1.340753, loss_ss: 1.190291, loss_d: 0.150462
0.6904 --- loss: 0.959550, loss_ss: 0.722624, loss_d: 0.236926
0.7288 --- loss: 1.380186, loss_ss: 0.982157, loss_d: 0.398029
0.7672 --- loss: 1.166610, loss_ss: 0.800445, loss_d: 0.366165
0.8055 --- loss: 1.197969, loss_ss: 1.165852, loss_d: 0.032118
0.8439 --- loss: 0.920785, loss_ss: 0.871550, loss_d: 0.049234
0.8822 --- loss: 1.127705, loss_ss: 0.886825, loss_d: 0.240880
0.9206 --- loss: 1.284318, loss_ss: 0.950569, loss_d: 0.333749
0.9590 --- loss: 1.081195, loss_ss: 0.873031, loss_d: 0.208164
0.9973 --- loss: 1.081047, loss_ss: 0.896344, loss_d: 0.184702
Epoch finished! Loss: 1.1636677402716415
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.834114, loss_ss: 0.787301, loss_d: 0.046813
0.0384 --- loss: 0.971252, loss_ss: 0.649871, loss_d: 0.321381
0.0767 --- loss: 0.843557, loss_ss: 0.798263, loss_d: 0.045294
0.1151 --- loss: 1.056344, loss_ss: 0.880304, loss_d: 0.176040
0.1534 --- loss: 1.011762, loss_ss: 0.851381, loss_d: 0.160382
0.1918 --- loss: 1.204168, loss_ss: 1.105790, loss_d: 0.098378
0.2301 --- loss: 0.992292, loss_ss: 0.969535, loss_d: 0.022757
0.2685 --- loss: 0.845638, loss_ss: 0.818732, loss_d: 0.026906
0.3069 --- loss: 0.901220, loss_ss: 0.846187, loss_d: 0.055034
0.3452 --- loss: 1.401098, loss_ss: 1.063715, loss_d: 0.337383
0.3836 --- loss: 0.832820, loss_ss: 0.789288, loss_d: 0.043532
0.4219 --- loss: 1.210800, loss_ss: 1.081663, loss_d: 0.129137
0.4603 --- loss: 1.529297, loss_ss: 0.738576, loss_d: 0.790721
0.4987 --- loss: 1.014605, loss_ss: 0.734330, loss_d: 0.280275
0.5370 --- loss: 0.828127, loss_ss: 0.651559, loss_d: 0.176568
0.5754 --- loss: 1.442981, loss_ss: 0.826798, loss_d: 0.616183
0.6137 --- loss: 1.534093, loss_ss: 0.774493, loss_d: 0.759600
0.6521 --- loss: 0.870229, loss_ss: 0.759881, loss_d: 0.110348
0.6904 --- loss: 1.111906, loss_ss: 0.957383, loss_d: 0.154523
0.7288 --- loss: 0.956795, loss_ss: 0.821921, loss_d: 0.134875
0.7672 --- loss: 0.866152, loss_ss: 0.671598, loss_d: 0.194554
0.8055 --- loss: 1.442262, loss_ss: 0.699493, loss_d: 0.742769
0.8439 --- loss: 0.868086, loss_ss: 0.490223, loss_d: 0.377863
0.8822 --- loss: 0.948258, loss_ss: 0.798251, loss_d: 0.150006
0.9206 --- loss: 0.769974, loss_ss: 0.719104, loss_d: 0.050870
0.9590 --- loss: 0.881817, loss_ss: 0.741455, loss_d: 0.140362
0.9973 --- loss: 1.053446, loss_ss: 1.005513, loss_d: 0.047933
Epoch finished! Loss: 1.113924185358561
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.678690, loss_ss: 0.643168, loss_d: 0.035522
0.0384 --- loss: 1.370438, loss_ss: 0.947322, loss_d: 0.423116
0.0767 --- loss: 0.743108, loss_ss: 0.699091, loss_d: 0.044017
0.1151 --- loss: 0.853519, loss_ss: 0.488597, loss_d: 0.364922
0.1534 --- loss: 1.112308, loss_ss: 0.727556, loss_d: 0.384752
0.1918 --- loss: 1.044444, loss_ss: 0.966514, loss_d: 0.077930
0.2301 --- loss: 1.006328, loss_ss: 0.808507, loss_d: 0.197821
0.2685 --- loss: 1.339071, loss_ss: 0.526192, loss_d: 0.812879
0.3069 --- loss: 0.906402, loss_ss: 0.828736, loss_d: 0.077667
0.3452 --- loss: 1.078054, loss_ss: 0.985565, loss_d: 0.092489
0.3836 --- loss: 1.006396, loss_ss: 0.955901, loss_d: 0.050495
0.4219 --- loss: 1.110045, loss_ss: 0.915409, loss_d: 0.194636
0.4603 --- loss: 1.536642, loss_ss: 1.151957, loss_d: 0.384685
0.4987 --- loss: 1.293404, loss_ss: 1.033381, loss_d: 0.260023
0.5370 --- loss: 0.988247, loss_ss: 0.950903, loss_d: 0.037344
0.5754 --- loss: 1.136227, loss_ss: 1.068884, loss_d: 0.067343
0.6137 --- loss: 1.356716, loss_ss: 1.154555, loss_d: 0.202161
0.6521 --- loss: 0.926242, loss_ss: 0.875075, loss_d: 0.051166
0.6904 --- loss: 1.425948, loss_ss: 1.193117, loss_d: 0.232831
0.7288 --- loss: 1.102494, loss_ss: 1.082913, loss_d: 0.019581
0.7672 --- loss: 0.857815, loss_ss: 0.646169, loss_d: 0.211646
0.8055 --- loss: 0.915224, loss_ss: 0.772749, loss_d: 0.142475
0.8439 --- loss: 0.857160, loss_ss: 0.832482, loss_d: 0.024677
0.8822 --- loss: 0.912628, loss_ss: 0.686467, loss_d: 0.226161
0.9206 --- loss: 1.226814, loss_ss: 1.010819, loss_d: 0.215995
0.9590 --- loss: 1.089625, loss_ss: 0.819578, loss_d: 0.270047
0.9973 --- loss: 1.185746, loss_ss: 0.971095, loss_d: 0.214650
Epoch finished! Loss: 1.0743093045858236
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.108138, loss_ss: 1.005291, loss_d: 0.102848
0.0384 --- loss: 0.871516, loss_ss: 0.825854, loss_d: 0.045661
0.0767 --- loss: 1.536035, loss_ss: 1.191004, loss_d: 0.345030
0.1151 --- loss: 1.105820, loss_ss: 0.984766, loss_d: 0.121054
0.1534 --- loss: 0.818366, loss_ss: 0.795595, loss_d: 0.022771
0.1918 --- loss: 1.157382, loss_ss: 1.022249, loss_d: 0.135133
0.2301 --- loss: 0.848220, loss_ss: 0.814249, loss_d: 0.033971
0.2685 --- loss: 1.279433, loss_ss: 1.240281, loss_d: 0.039153
0.3069 --- loss: 1.216564, loss_ss: 0.934932, loss_d: 0.281632
0.3452 --- loss: 0.803650, loss_ss: 0.758894, loss_d: 0.044756
0.3836 --- loss: 0.807847, loss_ss: 0.735437, loss_d: 0.072410
0.4219 --- loss: 1.374318, loss_ss: 0.939483, loss_d: 0.434834
0.4603 --- loss: 0.983064, loss_ss: 0.795816, loss_d: 0.187248
0.4987 --- loss: 0.998531, loss_ss: 0.831623, loss_d: 0.166908
0.5370 --- loss: 1.144578, loss_ss: 1.092199, loss_d: 0.052379
0.5754 --- loss: 0.878519, loss_ss: 0.794074, loss_d: 0.084445
0.6137 --- loss: 0.906600, loss_ss: 0.883482, loss_d: 0.023118
0.6521 --- loss: 1.065560, loss_ss: 0.794725, loss_d: 0.270835
0.6904 --- loss: 0.837396, loss_ss: 0.778054, loss_d: 0.059342
0.7288 --- loss: 1.071405, loss_ss: 0.984719, loss_d: 0.086685
0.7672 --- loss: 0.655762, loss_ss: 0.607456, loss_d: 0.048307
0.8055 --- loss: 0.957651, loss_ss: 0.759319, loss_d: 0.198332
0.8439 --- loss: 0.786043, loss_ss: 0.688414, loss_d: 0.097629
0.8822 --- loss: 1.192501, loss_ss: 0.839405, loss_d: 0.353096
0.9206 --- loss: 1.088815, loss_ss: 0.979517, loss_d: 0.109298
0.9590 --- loss: 0.790478, loss_ss: 0.707217, loss_d: 0.083260
0.9973 --- loss: 0.999378, loss_ss: 0.974930, loss_d: 0.024448
Epoch finished! Loss: 1.0305356399371073
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.050373, loss_ss: 0.963140, loss_d: 0.087233
0.0384 --- loss: 1.203551, loss_ss: 1.058423, loss_d: 0.145128
0.0767 --- loss: 1.408294, loss_ss: 1.269137, loss_d: 0.139157
0.1151 --- loss: 0.796964, loss_ss: 0.770657, loss_d: 0.026306
0.1534 --- loss: 1.229396, loss_ss: 1.189343, loss_d: 0.040054
0.1918 --- loss: 1.096609, loss_ss: 0.924282, loss_d: 0.172327
0.2301 --- loss: 1.301282, loss_ss: 0.641861, loss_d: 0.659420
0.2685 --- loss: 0.993372, loss_ss: 0.883974, loss_d: 0.109398
0.3069 --- loss: 0.700914, loss_ss: 0.645207, loss_d: 0.055708
0.3452 --- loss: 1.002473, loss_ss: 0.857894, loss_d: 0.144579
0.3836 --- loss: 1.033291, loss_ss: 0.825505, loss_d: 0.207785
0.4219 --- loss: 0.955295, loss_ss: 0.724597, loss_d: 0.230697
0.4603 --- loss: 1.184898, loss_ss: 0.879033, loss_d: 0.305865
0.4987 --- loss: 0.855826, loss_ss: 0.837495, loss_d: 0.018331
0.5370 --- loss: 1.086453, loss_ss: 0.550418, loss_d: 0.536035
0.5754 --- loss: 1.028547, loss_ss: 0.739171, loss_d: 0.289376
0.6137 --- loss: 1.176150, loss_ss: 1.065611, loss_d: 0.110539
0.6521 --- loss: 0.954200, loss_ss: 0.806111, loss_d: 0.148089
0.6904 --- loss: 1.009614, loss_ss: 0.951891, loss_d: 0.057723
0.7288 --- loss: 0.934769, loss_ss: 0.921174, loss_d: 0.013595
0.7672 --- loss: 0.617909, loss_ss: 0.605909, loss_d: 0.012000
0.8055 --- loss: 1.139211, loss_ss: 1.061409, loss_d: 0.077802
0.8439 --- loss: 1.641446, loss_ss: 0.940478, loss_d: 0.700968
0.8822 --- loss: 0.837521, loss_ss: 0.806541, loss_d: 0.030980
0.9206 --- loss: 0.778615, loss_ss: 0.734010, loss_d: 0.044605
0.9590 --- loss: 1.412929, loss_ss: 1.310717, loss_d: 0.102212
0.9973 --- loss: 0.768645, loss_ss: 0.753684, loss_d: 0.014961
Epoch finished! Loss: 0.995551967391601
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.727714, loss_ss: 0.694706, loss_d: 0.033007
0.0384 --- loss: 0.824363, loss_ss: 0.780051, loss_d: 0.044311
0.0767 --- loss: 2.501307, loss_ss: 0.649964, loss_d: 1.851343
0.1151 --- loss: 1.268325, loss_ss: 0.749580, loss_d: 0.518745
0.1534 --- loss: 0.825338, loss_ss: 0.673613, loss_d: 0.151726
0.1918 --- loss: 1.054885, loss_ss: 0.988952, loss_d: 0.065933
0.2301 --- loss: 0.994661, loss_ss: 0.743621, loss_d: 0.251040
0.2685 --- loss: 0.889117, loss_ss: 0.792380, loss_d: 0.096737
0.3069 --- loss: 0.803876, loss_ss: 0.676344, loss_d: 0.127532
0.3452 --- loss: 1.081317, loss_ss: 1.027646, loss_d: 0.053671
0.3836 --- loss: 1.066672, loss_ss: 0.815909, loss_d: 0.250763
0.4219 --- loss: 0.753607, loss_ss: 0.712404, loss_d: 0.041203
0.4603 --- loss: 0.712221, loss_ss: 0.652314, loss_d: 0.059907
0.4987 --- loss: 0.766964, loss_ss: 0.727717, loss_d: 0.039247
0.5370 --- loss: 0.630495, loss_ss: 0.582120, loss_d: 0.048374
0.5754 --- loss: 0.974319, loss_ss: 0.964784, loss_d: 0.009535
0.6137 --- loss: 1.221214, loss_ss: 0.655436, loss_d: 0.565779
0.6521 --- loss: 0.790507, loss_ss: 0.785878, loss_d: 0.004628
0.6904 --- loss: 0.857610, loss_ss: 0.744055, loss_d: 0.113555
0.7288 --- loss: 1.092201, loss_ss: 1.083112, loss_d: 0.009088
0.7672 --- loss: 0.713108, loss_ss: 0.638351, loss_d: 0.074757
0.8055 --- loss: 1.010922, loss_ss: 0.846360, loss_d: 0.164562
0.8439 --- loss: 1.619303, loss_ss: 0.867707, loss_d: 0.751596
0.8822 --- loss: 0.991952, loss_ss: 0.658639, loss_d: 0.333313
0.9206 --- loss: 1.463807, loss_ss: 0.789711, loss_d: 0.674095
0.9590 --- loss: 0.697445, loss_ss: 0.689395, loss_d: 0.008050
0.9973 --- loss: 1.066768, loss_ss: 0.966681, loss_d: 0.100087
Epoch finished! Loss: 0.9737485883327631
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6580645161290323
             precision    recall  f1-score   support

        0.0       0.55      0.92      0.68       119
        1.0       0.12      0.08      0.10        37
        2.0       0.88      0.37      0.53       387
        3.0       0.79      0.90      0.84       263
        4.0       0.49      0.94      0.64       124

avg / total       0.73      0.66      0.63       930
 


====== chp008-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.14  91.60   88.78  54.50     68.34
1  93.98   8.11   97.54  12.00      9.68
2  71.94  37.47   96.50  88.41     52.63
3  90.43  90.49   90.40  78.81     84.25
4  86.13  94.35   84.86  48.95     64.46
Total accuracy: 65.81%
Average sen: 64.40%
Average spec: 91.62%
Macro f1-score: 55.87%
Diagnosis acc on 15mins: 1.0
[0.99999666 0.99995685 0.99802518 0.99725658 0.99995935 0.99997878
 0.99994254 0.99999857 1.         1.         0.9999994  0.99993336
 0.99994791 0.99289715 0.99984097 0.99991226 0.99932981 0.99933547
 0.99976021 0.99839336 0.99997771 0.99996459 0.99999964 0.99999988
 0.9999963  0.99994862 0.99989843 0.99635339 0.99999559 0.99999988
 1.        ]
pred: 0.9993741435389365, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.374370, loss_ss: 1.749446, loss_d: 0.624924
0.0384 --- loss: 2.446094, loss_ss: 1.783059, loss_d: 0.663035
0.0768 --- loss: 2.300578, loss_ss: 1.646917, loss_d: 0.653661
0.1152 --- loss: 1.991997, loss_ss: 1.523043, loss_d: 0.468954
0.1536 --- loss: 2.061403, loss_ss: 1.556346, loss_d: 0.505056
0.1920 --- loss: 1.888387, loss_ss: 1.286190, loss_d: 0.602197
0.2304 --- loss: 1.872700, loss_ss: 1.551004, loss_d: 0.321696
0.2688 --- loss: 2.397322, loss_ss: 1.685271, loss_d: 0.712050
0.3072 --- loss: 1.921492, loss_ss: 1.457916, loss_d: 0.463577
0.3456 --- loss: 1.696006, loss_ss: 1.382883, loss_d: 0.313123
0.3840 --- loss: 2.021188, loss_ss: 1.398948, loss_d: 0.622240
0.4224 --- loss: 1.502850, loss_ss: 1.215645, loss_d: 0.287204
0.4608 --- loss: 1.894470, loss_ss: 1.492200, loss_d: 0.402271
0.4992 --- loss: 1.823244, loss_ss: 1.457599, loss_d: 0.365645
0.5376 --- loss: 1.695299, loss_ss: 1.362161, loss_d: 0.333138
0.5760 --- loss: 1.745806, loss_ss: 1.333283, loss_d: 0.412523
0.6144 --- loss: 1.941396, loss_ss: 1.387824, loss_d: 0.553572
0.6528 --- loss: 1.938872, loss_ss: 1.285277, loss_d: 0.653596
0.6912 --- loss: 1.787771, loss_ss: 1.238110, loss_d: 0.549660
0.7296 --- loss: 1.947706, loss_ss: 1.264713, loss_d: 0.682994
0.7680 --- loss: 1.849613, loss_ss: 1.292081, loss_d: 0.557532
0.8065 --- loss: 1.383535, loss_ss: 1.111044, loss_d: 0.272490
0.8449 --- loss: 1.528885, loss_ss: 1.183157, loss_d: 0.345728
0.8833 --- loss: 1.451917, loss_ss: 1.256197, loss_d: 0.195719
0.9217 --- loss: 1.472681, loss_ss: 1.244627, loss_d: 0.228054
0.9601 --- loss: 1.550881, loss_ss: 1.311580, loss_d: 0.239301
0.9985 --- loss: 1.585395, loss_ss: 1.378458, loss_d: 0.206937
Epoch finished! Loss: 1.9500571379294762
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.509396, loss_ss: 1.202659, loss_d: 0.306737
0.0384 --- loss: 1.760462, loss_ss: 1.142297, loss_d: 0.618165
0.0768 --- loss: 1.938844, loss_ss: 1.160136, loss_d: 0.778708
0.1152 --- loss: 1.596591, loss_ss: 1.116853, loss_d: 0.479738
0.1536 --- loss: 1.443726, loss_ss: 1.214762, loss_d: 0.228964
0.1920 --- loss: 1.752155, loss_ss: 1.373811, loss_d: 0.378344
0.2304 --- loss: 1.351390, loss_ss: 1.149847, loss_d: 0.201543
0.2688 --- loss: 1.372325, loss_ss: 1.232140, loss_d: 0.140185
0.3072 --- loss: 1.293651, loss_ss: 1.060946, loss_d: 0.232705
0.3456 --- loss: 1.704707, loss_ss: 1.113465, loss_d: 0.591242
0.3840 --- loss: 1.258781, loss_ss: 1.197130, loss_d: 0.061651
0.4224 --- loss: 1.719069, loss_ss: 1.045166, loss_d: 0.673904
0.4608 --- loss: 1.426406, loss_ss: 1.100599, loss_d: 0.325806
0.4992 --- loss: 1.506821, loss_ss: 1.103925, loss_d: 0.402896
0.5376 --- loss: 1.475586, loss_ss: 0.974235, loss_d: 0.501350
0.5760 --- loss: 1.217850, loss_ss: 0.985200, loss_d: 0.232650
0.6144 --- loss: 1.301789, loss_ss: 0.938009, loss_d: 0.363780
0.6528 --- loss: 1.336176, loss_ss: 1.037824, loss_d: 0.298352
0.6912 --- loss: 1.235756, loss_ss: 0.989363, loss_d: 0.246393
0.7296 --- loss: 1.822587, loss_ss: 1.078066, loss_d: 0.744522
0.7680 --- loss: 1.251855, loss_ss: 1.071577, loss_d: 0.180278
0.8065 --- loss: 1.226447, loss_ss: 0.987826, loss_d: 0.238622
0.8449 --- loss: 1.141814, loss_ss: 0.963365, loss_d: 0.178448
0.8833 --- loss: 1.797728, loss_ss: 1.010618, loss_d: 0.787110
0.9217 --- loss: 1.463201, loss_ss: 0.940816, loss_d: 0.522385
0.9601 --- loss: 1.126944, loss_ss: 0.974287, loss_d: 0.152656
0.9985 --- loss: 1.688855, loss_ss: 1.563782, loss_d: 0.125073
Epoch finished! Loss: 1.499156305881647
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.251482, loss_ss: 0.872059, loss_d: 0.379423
0.0384 --- loss: 1.108451, loss_ss: 0.896730, loss_d: 0.211721
0.0768 --- loss: 1.495684, loss_ss: 1.053126, loss_d: 0.442558
0.1152 --- loss: 1.885303, loss_ss: 1.139343, loss_d: 0.745961
0.1536 --- loss: 1.054101, loss_ss: 0.840862, loss_d: 0.213239
0.1920 --- loss: 1.479843, loss_ss: 1.160370, loss_d: 0.319473
0.2304 --- loss: 1.061702, loss_ss: 0.842961, loss_d: 0.218741
0.2688 --- loss: 1.159120, loss_ss: 0.881743, loss_d: 0.277377
0.3072 --- loss: 1.469266, loss_ss: 1.159999, loss_d: 0.309267
0.3456 --- loss: 1.250618, loss_ss: 1.097770, loss_d: 0.152848
0.3840 --- loss: 0.981013, loss_ss: 0.841600, loss_d: 0.139413
0.4224 --- loss: 1.256684, loss_ss: 0.903430, loss_d: 0.353254
0.4608 --- loss: 1.420649, loss_ss: 1.244148, loss_d: 0.176501
0.4992 --- loss: 1.684011, loss_ss: 1.239784, loss_d: 0.444227
0.5376 --- loss: 1.549213, loss_ss: 1.129593, loss_d: 0.419621
0.5760 --- loss: 1.295224, loss_ss: 0.994322, loss_d: 0.300902
0.6144 --- loss: 1.261584, loss_ss: 0.987877, loss_d: 0.273707
0.6528 --- loss: 1.427024, loss_ss: 0.995941, loss_d: 0.431083
0.6912 --- loss: 1.136908, loss_ss: 0.934775, loss_d: 0.202133
0.7296 --- loss: 0.966902, loss_ss: 0.835805, loss_d: 0.131097
0.7680 --- loss: 1.393827, loss_ss: 0.958968, loss_d: 0.434859
0.8065 --- loss: 1.775503, loss_ss: 0.928824, loss_d: 0.846679
0.8449 --- loss: 1.152927, loss_ss: 0.965669, loss_d: 0.187258
0.8833 --- loss: 1.371418, loss_ss: 1.006422, loss_d: 0.364996
0.9217 --- loss: 1.608274, loss_ss: 0.969718, loss_d: 0.638557
0.9601 --- loss: 1.212050, loss_ss: 1.101507, loss_d: 0.110542
0.9985 --- loss: 2.478118, loss_ss: 1.106916, loss_d: 1.371202
Epoch finished! Loss: 1.322174375790816
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.217145, loss_ss: 0.947992, loss_d: 0.269152
0.0384 --- loss: 1.463233, loss_ss: 0.970526, loss_d: 0.492706
0.0768 --- loss: 1.020174, loss_ss: 0.908894, loss_d: 0.111280
0.1152 --- loss: 1.202465, loss_ss: 1.125952, loss_d: 0.076513
0.1536 --- loss: 1.088314, loss_ss: 0.917894, loss_d: 0.170419
0.1920 --- loss: 0.896004, loss_ss: 0.787539, loss_d: 0.108465
0.2304 --- loss: 1.023328, loss_ss: 0.907042, loss_d: 0.116286
0.2688 --- loss: 1.004173, loss_ss: 0.932607, loss_d: 0.071566
0.3072 --- loss: 1.376790, loss_ss: 0.582404, loss_d: 0.794385
0.3456 --- loss: 1.175366, loss_ss: 0.909983, loss_d: 0.265383
0.3840 --- loss: 1.075536, loss_ss: 0.924517, loss_d: 0.151018
0.4224 --- loss: 1.098414, loss_ss: 0.998091, loss_d: 0.100323
0.4608 --- loss: 1.122630, loss_ss: 0.920386, loss_d: 0.202244
0.4992 --- loss: 1.332456, loss_ss: 0.937834, loss_d: 0.394622
0.5376 --- loss: 1.167633, loss_ss: 1.013215, loss_d: 0.154418
0.5760 --- loss: 1.640023, loss_ss: 0.843040, loss_d: 0.796983
0.6144 --- loss: 1.231314, loss_ss: 0.909074, loss_d: 0.322240
0.6528 --- loss: 0.960180, loss_ss: 0.868294, loss_d: 0.091886
0.6912 --- loss: 0.897073, loss_ss: 0.830435, loss_d: 0.066639
0.7296 --- loss: 0.975758, loss_ss: 0.750666, loss_d: 0.225092
0.7680 --- loss: 1.006582, loss_ss: 0.765386, loss_d: 0.241197
0.8065 --- loss: 1.619441, loss_ss: 1.026344, loss_d: 0.593097
0.8449 --- loss: 0.796491, loss_ss: 0.715822, loss_d: 0.080669
0.8833 --- loss: 1.455270, loss_ss: 0.834307, loss_d: 0.620964
0.9217 --- loss: 1.327914, loss_ss: 0.951219, loss_d: 0.376695
0.9601 --- loss: 1.360984, loss_ss: 0.865201, loss_d: 0.495783
0.9985 --- loss: 2.459411, loss_ss: 1.839040, loss_d: 0.620370
Epoch finished! Loss: 1.2038330974487157
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.683577, loss_ss: 0.625040, loss_d: 0.058537
0.0384 --- loss: 1.235823, loss_ss: 0.540576, loss_d: 0.695247
0.0768 --- loss: 0.948120, loss_ss: 0.888046, loss_d: 0.060074
0.1152 --- loss: 0.846176, loss_ss: 0.786988, loss_d: 0.059188
0.1536 --- loss: 1.267986, loss_ss: 0.749983, loss_d: 0.518003
0.1920 --- loss: 0.986175, loss_ss: 0.916057, loss_d: 0.070118
0.2304 --- loss: 0.943487, loss_ss: 0.851404, loss_d: 0.092082
0.2688 --- loss: 1.119737, loss_ss: 1.070143, loss_d: 0.049595
0.3072 --- loss: 1.315628, loss_ss: 1.077752, loss_d: 0.237875
0.3456 --- loss: 0.754719, loss_ss: 0.684263, loss_d: 0.070456
0.3840 --- loss: 0.835620, loss_ss: 0.781807, loss_d: 0.053814
0.4224 --- loss: 1.398103, loss_ss: 0.907634, loss_d: 0.490469
0.4608 --- loss: 0.946756, loss_ss: 0.768999, loss_d: 0.177757
0.4992 --- loss: 1.176799, loss_ss: 0.902878, loss_d: 0.273921
0.5376 --- loss: 1.297541, loss_ss: 0.657736, loss_d: 0.639805
0.5760 --- loss: 1.111854, loss_ss: 0.979722, loss_d: 0.132132
0.6144 --- loss: 1.315538, loss_ss: 1.020374, loss_d: 0.295163
0.6528 --- loss: 0.910644, loss_ss: 0.815642, loss_d: 0.095002
0.6912 --- loss: 1.043822, loss_ss: 0.884596, loss_d: 0.159226
0.7296 --- loss: 0.992962, loss_ss: 0.797332, loss_d: 0.195630
0.7680 --- loss: 0.859304, loss_ss: 0.727997, loss_d: 0.131307
0.8065 --- loss: 1.314034, loss_ss: 0.739104, loss_d: 0.574929
0.8449 --- loss: 0.869033, loss_ss: 0.798553, loss_d: 0.070480
0.8833 --- loss: 0.927362, loss_ss: 0.869671, loss_d: 0.057691
0.9217 --- loss: 0.772934, loss_ss: 0.618120, loss_d: 0.154814
0.9601 --- loss: 1.090813, loss_ss: 0.935225, loss_d: 0.155588
0.9985 --- loss: 2.939267, loss_ss: 1.280740, loss_d: 1.658527
Epoch finished! Loss: 1.1322233135883624
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.077601, loss_ss: 0.752912, loss_d: 0.324690
0.0384 --- loss: 1.093071, loss_ss: 0.812223, loss_d: 0.280849
0.0768 --- loss: 1.024537, loss_ss: 0.795967, loss_d: 0.228570
0.1152 --- loss: 0.967065, loss_ss: 0.910280, loss_d: 0.056785
0.1536 --- loss: 1.148086, loss_ss: 1.120078, loss_d: 0.028008
0.1920 --- loss: 1.405153, loss_ss: 0.911759, loss_d: 0.493394
0.2304 --- loss: 1.023316, loss_ss: 0.943920, loss_d: 0.079395
0.2688 --- loss: 1.155527, loss_ss: 0.996773, loss_d: 0.158754
0.3072 --- loss: 0.804460, loss_ss: 0.779998, loss_d: 0.024462
0.3456 --- loss: 0.971322, loss_ss: 0.632170, loss_d: 0.339152
0.3840 --- loss: 0.852892, loss_ss: 0.828540, loss_d: 0.024352
0.4224 --- loss: 0.995996, loss_ss: 0.892461, loss_d: 0.103536
0.4608 --- loss: 0.752285, loss_ss: 0.736330, loss_d: 0.015955
0.4992 --- loss: 1.070691, loss_ss: 1.033683, loss_d: 0.037008
0.5376 --- loss: 1.079702, loss_ss: 0.730694, loss_d: 0.349008
0.5760 --- loss: 1.231538, loss_ss: 1.198144, loss_d: 0.033394
0.6144 --- loss: 0.862865, loss_ss: 0.819134, loss_d: 0.043731
0.6528 --- loss: 0.902774, loss_ss: 0.801400, loss_d: 0.101374
0.6912 --- loss: 1.077354, loss_ss: 1.046574, loss_d: 0.030780
0.7296 --- loss: 1.013099, loss_ss: 0.968886, loss_d: 0.044214
0.7680 --- loss: 1.242465, loss_ss: 0.795775, loss_d: 0.446690
0.8065 --- loss: 1.317787, loss_ss: 1.031459, loss_d: 0.286328
0.8449 --- loss: 0.785517, loss_ss: 0.705875, loss_d: 0.079642
0.8833 --- loss: 0.801142, loss_ss: 0.752600, loss_d: 0.048542
0.9217 --- loss: 0.802640, loss_ss: 0.693923, loss_d: 0.108717
0.9601 --- loss: 0.953011, loss_ss: 0.854698, loss_d: 0.098313
0.9985 --- loss: 1.747359, loss_ss: 1.116263, loss_d: 0.631097
Epoch finished! Loss: 1.0334029039511314
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.957567, loss_ss: 0.912970, loss_d: 0.044597
0.0384 --- loss: 0.798843, loss_ss: 0.762852, loss_d: 0.035991
0.0768 --- loss: 0.884663, loss_ss: 0.721899, loss_d: 0.162764
0.1152 --- loss: 1.152823, loss_ss: 1.019839, loss_d: 0.132985
0.1536 --- loss: 0.681679, loss_ss: 0.649634, loss_d: 0.032045
0.1920 --- loss: 0.884333, loss_ss: 0.791625, loss_d: 0.092707
0.2304 --- loss: 1.223857, loss_ss: 0.980336, loss_d: 0.243521
0.2688 --- loss: 1.152085, loss_ss: 0.852095, loss_d: 0.299990
0.3072 --- loss: 0.916801, loss_ss: 0.605240, loss_d: 0.311562
0.3456 --- loss: 1.416095, loss_ss: 1.031103, loss_d: 0.384992
0.3840 --- loss: 1.420446, loss_ss: 1.093795, loss_d: 0.326651
0.4224 --- loss: 1.220057, loss_ss: 1.067214, loss_d: 0.152843
0.4608 --- loss: 1.002162, loss_ss: 0.876150, loss_d: 0.126012
0.4992 --- loss: 0.991672, loss_ss: 0.768972, loss_d: 0.222701
0.5376 --- loss: 0.884148, loss_ss: 0.864329, loss_d: 0.019820
0.5760 --- loss: 1.025093, loss_ss: 1.008494, loss_d: 0.016598
0.6144 --- loss: 0.905085, loss_ss: 0.869212, loss_d: 0.035873
0.6528 --- loss: 1.024216, loss_ss: 0.784961, loss_d: 0.239255
0.6912 --- loss: 0.742711, loss_ss: 0.646035, loss_d: 0.096676
0.7296 --- loss: 1.324173, loss_ss: 1.250504, loss_d: 0.073669
0.7680 --- loss: 0.933230, loss_ss: 0.881753, loss_d: 0.051477
0.8065 --- loss: 1.096784, loss_ss: 0.754357, loss_d: 0.342427
0.8449 --- loss: 0.933047, loss_ss: 0.888396, loss_d: 0.044651
0.8833 --- loss: 1.276251, loss_ss: 0.934675, loss_d: 0.341576
0.9217 --- loss: 1.150261, loss_ss: 1.018338, loss_d: 0.131923
0.9601 --- loss: 0.931286, loss_ss: 0.799418, loss_d: 0.131869
0.9985 --- loss: 1.916930, loss_ss: 0.601906, loss_d: 1.315024
Epoch finished! Loss: 1.01519197844542
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.688245, loss_ss: 0.615215, loss_d: 0.073030
0.0384 --- loss: 0.932909, loss_ss: 0.776147, loss_d: 0.156762
0.0768 --- loss: 0.885979, loss_ss: 0.797511, loss_d: 0.088468
0.1152 --- loss: 0.739584, loss_ss: 0.562661, loss_d: 0.176923
0.1536 --- loss: 1.111704, loss_ss: 1.085814, loss_d: 0.025890
0.1920 --- loss: 0.723922, loss_ss: 0.705079, loss_d: 0.018842
0.2304 --- loss: 1.134604, loss_ss: 0.892857, loss_d: 0.241746
0.2688 --- loss: 0.709891, loss_ss: 0.607919, loss_d: 0.101972
0.3072 --- loss: 1.045690, loss_ss: 1.005216, loss_d: 0.040474
0.3456 --- loss: 1.140148, loss_ss: 0.838239, loss_d: 0.301908
0.3840 --- loss: 0.784129, loss_ss: 0.571496, loss_d: 0.212633
0.4224 --- loss: 1.151781, loss_ss: 0.913219, loss_d: 0.238562
0.4608 --- loss: 1.062833, loss_ss: 1.016231, loss_d: 0.046602
0.4992 --- loss: 0.856916, loss_ss: 0.821856, loss_d: 0.035060
0.5376 --- loss: 0.857951, loss_ss: 0.770800, loss_d: 0.087151
0.5760 --- loss: 1.382158, loss_ss: 0.695925, loss_d: 0.686233
0.6144 --- loss: 1.026459, loss_ss: 0.759540, loss_d: 0.266919
0.6528 --- loss: 0.904350, loss_ss: 0.618312, loss_d: 0.286038
0.6912 --- loss: 0.781184, loss_ss: 0.769309, loss_d: 0.011875
0.7296 --- loss: 0.677810, loss_ss: 0.620377, loss_d: 0.057433
0.7680 --- loss: 1.080360, loss_ss: 1.034666, loss_d: 0.045694
0.8065 --- loss: 0.930963, loss_ss: 0.890945, loss_d: 0.040019
0.8449 --- loss: 1.021143, loss_ss: 0.815827, loss_d: 0.205316
0.8833 --- loss: 1.040015, loss_ss: 0.956989, loss_d: 0.083026
0.9217 --- loss: 1.402139, loss_ss: 1.324367, loss_d: 0.077771
0.9601 --- loss: 0.843331, loss_ss: 0.769701, loss_d: 0.073630
0.9985 --- loss: 5.894758, loss_ss: 0.749857, loss_d: 5.144901
Epoch finished! Loss: 0.9983266919851304
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.693577, loss_ss: 0.682874, loss_d: 0.010703
0.0384 --- loss: 1.110460, loss_ss: 1.005386, loss_d: 0.105074
0.0768 --- loss: 1.873926, loss_ss: 1.695819, loss_d: 0.178107
0.1152 --- loss: 0.729689, loss_ss: 0.683534, loss_d: 0.046155
0.1536 --- loss: 1.089206, loss_ss: 1.014169, loss_d: 0.075037
0.1920 --- loss: 1.000079, loss_ss: 0.953245, loss_d: 0.046834
0.2304 --- loss: 1.006320, loss_ss: 0.970358, loss_d: 0.035961
0.2688 --- loss: 0.834181, loss_ss: 0.786689, loss_d: 0.047492
0.3072 --- loss: 0.885915, loss_ss: 0.850634, loss_d: 0.035281
0.3456 --- loss: 1.193235, loss_ss: 0.924338, loss_d: 0.268897
0.3840 --- loss: 0.981750, loss_ss: 0.927694, loss_d: 0.054056
0.4224 --- loss: 0.963110, loss_ss: 0.947646, loss_d: 0.015465
0.4608 --- loss: 0.895698, loss_ss: 0.755453, loss_d: 0.140244
0.4992 --- loss: 0.806296, loss_ss: 0.725920, loss_d: 0.080377
0.5376 --- loss: 0.806585, loss_ss: 0.723622, loss_d: 0.082963
0.5760 --- loss: 1.212522, loss_ss: 1.187560, loss_d: 0.024962
0.6144 --- loss: 0.763539, loss_ss: 0.757906, loss_d: 0.005633
0.6528 --- loss: 0.784937, loss_ss: 0.775203, loss_d: 0.009734
0.6912 --- loss: 0.857169, loss_ss: 0.844132, loss_d: 0.013037
0.7296 --- loss: 1.119797, loss_ss: 0.835506, loss_d: 0.284291
0.7680 --- loss: 0.767914, loss_ss: 0.753585, loss_d: 0.014330
0.8065 --- loss: 0.652823, loss_ss: 0.609838, loss_d: 0.042985
0.8449 --- loss: 0.727272, loss_ss: 0.675866, loss_d: 0.051406
0.8833 --- loss: 0.813190, loss_ss: 0.809135, loss_d: 0.004055
0.9217 --- loss: 0.937176, loss_ss: 0.927161, loss_d: 0.010015
0.9601 --- loss: 1.020985, loss_ss: 0.912158, loss_d: 0.108828
0.9985 --- loss: 2.556470, loss_ss: 0.822535, loss_d: 1.733936
Epoch finished! Loss: 0.938018000125885
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.934947, loss_ss: 0.925042, loss_d: 0.009905
0.0384 --- loss: 1.081558, loss_ss: 0.981459, loss_d: 0.100098
0.0768 --- loss: 0.979113, loss_ss: 0.891205, loss_d: 0.087908
0.1152 --- loss: 1.563983, loss_ss: 0.944551, loss_d: 0.619432
0.1536 --- loss: 1.705066, loss_ss: 0.697768, loss_d: 1.007298
0.1920 --- loss: 0.808417, loss_ss: 0.761001, loss_d: 0.047416
0.2304 --- loss: 1.172756, loss_ss: 0.947658, loss_d: 0.225098
0.2688 --- loss: 0.664805, loss_ss: 0.630824, loss_d: 0.033981
0.3072 --- loss: 0.907149, loss_ss: 0.898082, loss_d: 0.009067
0.3456 --- loss: 0.917425, loss_ss: 0.881667, loss_d: 0.035757
0.3840 --- loss: 1.149638, loss_ss: 0.835317, loss_d: 0.314321
0.4224 --- loss: 1.301940, loss_ss: 0.671411, loss_d: 0.630530
0.4608 --- loss: 0.753809, loss_ss: 0.631176, loss_d: 0.122633
0.4992 --- loss: 0.908170, loss_ss: 0.844165, loss_d: 0.064005
0.5376 --- loss: 1.012126, loss_ss: 0.905160, loss_d: 0.106966
0.5760 --- loss: 0.740495, loss_ss: 0.702497, loss_d: 0.037998
0.6144 --- loss: 3.170480, loss_ss: 0.873338, loss_d: 2.297142
0.6528 --- loss: 0.820791, loss_ss: 0.784679, loss_d: 0.036112
0.6912 --- loss: 1.159436, loss_ss: 1.025354, loss_d: 0.134081
0.7296 --- loss: 0.954080, loss_ss: 0.903024, loss_d: 0.051056
0.7680 --- loss: 0.886076, loss_ss: 0.837022, loss_d: 0.049055
0.8065 --- loss: 0.947986, loss_ss: 0.859842, loss_d: 0.088143
0.8449 --- loss: 0.755205, loss_ss: 0.740108, loss_d: 0.015097
0.8833 --- loss: 0.493999, loss_ss: 0.478407, loss_d: 0.015592
0.9217 --- loss: 0.797450, loss_ss: 0.629814, loss_d: 0.167635
0.9601 --- loss: 0.470261, loss_ss: 0.416317, loss_d: 0.053944
0.9985 --- loss: 3.146166, loss_ss: 0.799089, loss_d: 2.347078
Epoch finished! Loss: 0.9342191549447867
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7578431372549019
             precision    recall  f1-score   support

        0.0       0.91      0.50      0.64        96
        1.0       0.30      0.13      0.18       123
        2.0       0.73      0.86      0.79       355
        3.0       0.98      0.88      0.93       209
        4.0       0.71      0.92      0.80       237

avg / total       0.74      0.76      0.73      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.80  50.00   99.46  90.57     64.43
1  85.88  13.01   95.88  30.19     18.18
2  84.12  86.20   83.01  73.03     79.07
3  97.25  88.04   99.63  98.40     92.93
4  89.51  92.41   88.63  71.10     80.37
Total accuracy: 75.78%
Average sen: 65.93%
Average spec: 93.32%
Macro f1-score: 67.00%
Diagnosis acc on 15mins: 1.0
[0.99985898 0.99996865 0.99999225 0.99998438 0.99982774 0.99986362
 0.99998641 0.99999082 0.99999464 0.99999917 0.99999976 0.99999917
 0.99994969 0.99999762 0.99999595 0.99999881 0.99999988 0.99992526
 0.99999356 0.99999988 0.99994862 0.99986339 0.99983585 0.99990952
 0.99997866 0.99998963 0.99990678 0.99987137 0.99997544 0.9984957
 0.99991119 0.9998492  0.99980873 0.99959344]
pred: 0.9998901100719676, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.349795, loss_ss: 1.667062, loss_d: 0.682734
0.0384 --- loss: 2.337757, loss_ss: 1.588897, loss_d: 0.748860
0.0767 --- loss: 1.960206, loss_ss: 1.453760, loss_d: 0.506445
0.1151 --- loss: 2.109800, loss_ss: 1.503095, loss_d: 0.606705
0.1535 --- loss: 1.983717, loss_ss: 1.508472, loss_d: 0.475245
0.1919 --- loss: 1.963110, loss_ss: 1.320787, loss_d: 0.642323
0.2302 --- loss: 1.870225, loss_ss: 1.356548, loss_d: 0.513676
0.2686 --- loss: 2.189215, loss_ss: 1.312384, loss_d: 0.876831
0.3070 --- loss: 1.967689, loss_ss: 1.471969, loss_d: 0.495720
0.3454 --- loss: 1.816876, loss_ss: 1.332002, loss_d: 0.484874
0.3837 --- loss: 1.911173, loss_ss: 1.425678, loss_d: 0.485495
0.4221 --- loss: 1.899065, loss_ss: 1.287189, loss_d: 0.611876
0.4605 --- loss: 2.005674, loss_ss: 1.285438, loss_d: 0.720236
0.4988 --- loss: 1.906811, loss_ss: 1.321510, loss_d: 0.585301
0.5372 --- loss: 2.007976, loss_ss: 1.422210, loss_d: 0.585766
0.5756 --- loss: 1.688121, loss_ss: 1.334952, loss_d: 0.353168
0.6140 --- loss: 1.623453, loss_ss: 1.140558, loss_d: 0.482895
0.6523 --- loss: 1.901804, loss_ss: 1.252774, loss_d: 0.649030
0.6907 --- loss: 1.849980, loss_ss: 1.256413, loss_d: 0.593567
0.7291 --- loss: 2.377961, loss_ss: 1.370642, loss_d: 1.007318
0.7675 --- loss: 1.594850, loss_ss: 1.126859, loss_d: 0.467991
0.8058 --- loss: 1.790802, loss_ss: 1.268159, loss_d: 0.522643
0.8442 --- loss: 1.749817, loss_ss: 1.288230, loss_d: 0.461587
0.8826 --- loss: 1.339638, loss_ss: 1.050418, loss_d: 0.289220
0.9210 --- loss: 1.672353, loss_ss: 1.307965, loss_d: 0.364388
0.9593 --- loss: 1.358121, loss_ss: 1.144578, loss_d: 0.213543
0.9977 --- loss: 1.411731, loss_ss: 1.195122, loss_d: 0.216609
Epoch finished! Loss: 1.905082175364861
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.537493, loss_ss: 1.214190, loss_d: 0.323303
0.0384 --- loss: 1.701228, loss_ss: 1.217344, loss_d: 0.483884
0.0767 --- loss: 1.296195, loss_ss: 1.057024, loss_d: 0.239170
0.1151 --- loss: 1.617652, loss_ss: 1.075199, loss_d: 0.542452
0.1535 --- loss: 1.572732, loss_ss: 1.109606, loss_d: 0.463125
0.1919 --- loss: 1.723765, loss_ss: 1.082439, loss_d: 0.641326
0.2302 --- loss: 1.722285, loss_ss: 1.473616, loss_d: 0.248669
0.2686 --- loss: 1.080847, loss_ss: 1.018799, loss_d: 0.062048
0.3070 --- loss: 1.559176, loss_ss: 1.093017, loss_d: 0.466160
0.3454 --- loss: 1.472499, loss_ss: 1.015328, loss_d: 0.457171
0.3837 --- loss: 1.529784, loss_ss: 1.241708, loss_d: 0.288076
0.4221 --- loss: 1.717694, loss_ss: 1.041577, loss_d: 0.676116
0.4605 --- loss: 1.504488, loss_ss: 1.312265, loss_d: 0.192223
0.4988 --- loss: 1.340736, loss_ss: 1.027021, loss_d: 0.313716
0.5372 --- loss: 1.093079, loss_ss: 0.874295, loss_d: 0.218784
0.5756 --- loss: 1.344486, loss_ss: 0.967756, loss_d: 0.376731
0.6140 --- loss: 1.518021, loss_ss: 1.252746, loss_d: 0.265275
0.6523 --- loss: 1.285249, loss_ss: 1.083050, loss_d: 0.202199
0.6907 --- loss: 1.227282, loss_ss: 1.004283, loss_d: 0.222999
0.7291 --- loss: 1.291466, loss_ss: 1.081308, loss_d: 0.210158
0.7675 --- loss: 1.244802, loss_ss: 0.887986, loss_d: 0.356816
0.8058 --- loss: 1.965035, loss_ss: 1.138410, loss_d: 0.826624
0.8442 --- loss: 1.450909, loss_ss: 1.065787, loss_d: 0.385121
0.8826 --- loss: 1.270077, loss_ss: 1.159474, loss_d: 0.110603
0.9210 --- loss: 1.117002, loss_ss: 0.958075, loss_d: 0.158927
0.9593 --- loss: 1.521992, loss_ss: 1.251848, loss_d: 0.270144
0.9977 --- loss: 1.636963, loss_ss: 1.415283, loss_d: 0.221680
Epoch finished! Loss: 1.4617992077882473
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.187155, loss_ss: 0.856844, loss_d: 0.330310
0.0384 --- loss: 1.422796, loss_ss: 0.941464, loss_d: 0.481332
0.0767 --- loss: 1.398212, loss_ss: 1.077389, loss_d: 0.320823
0.1151 --- loss: 1.403292, loss_ss: 1.284319, loss_d: 0.118972
0.1535 --- loss: 1.121772, loss_ss: 0.893975, loss_d: 0.227798
0.1919 --- loss: 1.155264, loss_ss: 0.899385, loss_d: 0.255879
0.2302 --- loss: 1.497661, loss_ss: 1.050090, loss_d: 0.447571
0.2686 --- loss: 1.013340, loss_ss: 0.954092, loss_d: 0.059248
0.3070 --- loss: 1.254633, loss_ss: 1.080861, loss_d: 0.173772
0.3454 --- loss: 1.365497, loss_ss: 1.208708, loss_d: 0.156789
0.3837 --- loss: 1.043904, loss_ss: 0.952155, loss_d: 0.091749
0.4221 --- loss: 1.336091, loss_ss: 0.987960, loss_d: 0.348132
0.4605 --- loss: 1.187132, loss_ss: 0.942885, loss_d: 0.244247
0.4988 --- loss: 1.158979, loss_ss: 0.896063, loss_d: 0.262916
0.5372 --- loss: 1.208568, loss_ss: 0.891217, loss_d: 0.317351
0.5756 --- loss: 1.650489, loss_ss: 1.183573, loss_d: 0.466916
0.6140 --- loss: 1.523539, loss_ss: 0.980479, loss_d: 0.543060
0.6523 --- loss: 1.612503, loss_ss: 0.925475, loss_d: 0.687028
0.6907 --- loss: 1.107620, loss_ss: 0.974233, loss_d: 0.133387
0.7291 --- loss: 1.312967, loss_ss: 0.969724, loss_d: 0.343243
0.7675 --- loss: 1.075362, loss_ss: 0.906953, loss_d: 0.168410
0.8058 --- loss: 1.264651, loss_ss: 0.927805, loss_d: 0.336847
0.8442 --- loss: 1.058706, loss_ss: 0.918482, loss_d: 0.140223
0.8826 --- loss: 1.006398, loss_ss: 0.897785, loss_d: 0.108613
0.9210 --- loss: 1.146075, loss_ss: 0.853329, loss_d: 0.292746
0.9593 --- loss: 1.378689, loss_ss: 1.246293, loss_d: 0.132396
0.9977 --- loss: 1.642488, loss_ss: 1.212512, loss_d: 0.429976
Epoch finished! Loss: 1.282028624873895
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.126972, loss_ss: 0.879138, loss_d: 0.247833
0.0384 --- loss: 1.226661, loss_ss: 1.082815, loss_d: 0.143846
0.0767 --- loss: 1.216924, loss_ss: 0.955225, loss_d: 0.261699
0.1151 --- loss: 1.032142, loss_ss: 0.825699, loss_d: 0.206443
0.1535 --- loss: 1.300948, loss_ss: 0.821670, loss_d: 0.479278
0.1919 --- loss: 1.127408, loss_ss: 1.028570, loss_d: 0.098838
0.2302 --- loss: 1.032486, loss_ss: 0.863219, loss_d: 0.169267
0.2686 --- loss: 1.503298, loss_ss: 0.851031, loss_d: 0.652267
0.3070 --- loss: 1.274284, loss_ss: 0.859524, loss_d: 0.414760
0.3454 --- loss: 1.039413, loss_ss: 0.921699, loss_d: 0.117715
0.3837 --- loss: 1.237186, loss_ss: 1.080801, loss_d: 0.156385
0.4221 --- loss: 1.021868, loss_ss: 0.904443, loss_d: 0.117426
0.4605 --- loss: 1.091262, loss_ss: 0.948841, loss_d: 0.142421
0.4988 --- loss: 1.519791, loss_ss: 1.099238, loss_d: 0.420553
0.5372 --- loss: 1.093968, loss_ss: 0.988597, loss_d: 0.105370
0.5756 --- loss: 1.235476, loss_ss: 0.925979, loss_d: 0.309497
0.6140 --- loss: 1.278524, loss_ss: 0.994824, loss_d: 0.283701
0.6523 --- loss: 1.571793, loss_ss: 1.290115, loss_d: 0.281678
0.6907 --- loss: 1.958236, loss_ss: 0.853715, loss_d: 1.104522
0.7291 --- loss: 1.029527, loss_ss: 0.811703, loss_d: 0.217824
0.7675 --- loss: 1.332819, loss_ss: 1.160673, loss_d: 0.172145
0.8058 --- loss: 1.465713, loss_ss: 0.927688, loss_d: 0.538024
0.8442 --- loss: 1.785751, loss_ss: 0.739742, loss_d: 1.046009
0.8826 --- loss: 1.558047, loss_ss: 1.312491, loss_d: 0.245556
0.9210 --- loss: 1.439262, loss_ss: 1.201166, loss_d: 0.238096
0.9593 --- loss: 1.102876, loss_ss: 0.925954, loss_d: 0.176922
0.9977 --- loss: 0.947851, loss_ss: 0.826348, loss_d: 0.121503
Epoch finished! Loss: 1.1834804489062383
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.932612, loss_ss: 0.751049, loss_d: 0.181563
0.0384 --- loss: 1.355501, loss_ss: 1.008037, loss_d: 0.347464
0.0767 --- loss: 1.095670, loss_ss: 0.932853, loss_d: 0.162817
0.1151 --- loss: 1.497464, loss_ss: 1.099081, loss_d: 0.398383
0.1535 --- loss: 1.001204, loss_ss: 0.941456, loss_d: 0.059748
0.1919 --- loss: 1.182641, loss_ss: 0.889306, loss_d: 0.293335
0.2302 --- loss: 1.339099, loss_ss: 1.059426, loss_d: 0.279673
0.2686 --- loss: 1.159844, loss_ss: 1.116854, loss_d: 0.042989
0.3070 --- loss: 1.025570, loss_ss: 0.932626, loss_d: 0.092944
0.3454 --- loss: 1.117473, loss_ss: 0.930713, loss_d: 0.186759
0.3837 --- loss: 0.873006, loss_ss: 0.677412, loss_d: 0.195595
0.4221 --- loss: 1.112960, loss_ss: 0.979754, loss_d: 0.133206
0.4605 --- loss: 1.377009, loss_ss: 1.301015, loss_d: 0.075994
0.4988 --- loss: 1.072732, loss_ss: 0.901486, loss_d: 0.171246
0.5372 --- loss: 1.090537, loss_ss: 0.890262, loss_d: 0.200276
0.5756 --- loss: 1.504648, loss_ss: 1.159157, loss_d: 0.345491
0.6140 --- loss: 1.120414, loss_ss: 1.040220, loss_d: 0.080194
0.6523 --- loss: 1.401887, loss_ss: 1.210832, loss_d: 0.191054
0.6907 --- loss: 0.863744, loss_ss: 0.781069, loss_d: 0.082675
0.7291 --- loss: 1.081222, loss_ss: 0.933004, loss_d: 0.148218
0.7675 --- loss: 0.875600, loss_ss: 0.847542, loss_d: 0.028058
0.8058 --- loss: 1.025084, loss_ss: 0.770430, loss_d: 0.254654
0.8442 --- loss: 0.893018, loss_ss: 0.802450, loss_d: 0.090568
0.8826 --- loss: 1.062708, loss_ss: 0.902809, loss_d: 0.159898
0.9210 --- loss: 1.004252, loss_ss: 0.892842, loss_d: 0.111410
0.9593 --- loss: 1.113225, loss_ss: 1.037898, loss_d: 0.075327
0.9977 --- loss: 2.036455, loss_ss: 0.626983, loss_d: 1.409471
Epoch finished! Loss: 1.135531853712522
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.971067, loss_ss: 0.773371, loss_d: 0.197697
0.0384 --- loss: 1.009460, loss_ss: 0.854758, loss_d: 0.154702
0.0767 --- loss: 1.330635, loss_ss: 1.002070, loss_d: 0.328565
0.1151 --- loss: 1.045876, loss_ss: 0.885753, loss_d: 0.160122
0.1535 --- loss: 0.863777, loss_ss: 0.823847, loss_d: 0.039930
0.1919 --- loss: 0.978423, loss_ss: 0.618347, loss_d: 0.360076
0.2302 --- loss: 1.281035, loss_ss: 0.916702, loss_d: 0.364333
0.2686 --- loss: 1.029827, loss_ss: 0.894533, loss_d: 0.135294
0.3070 --- loss: 1.217598, loss_ss: 0.759342, loss_d: 0.458257
0.3454 --- loss: 0.910290, loss_ss: 0.787897, loss_d: 0.122394
0.3837 --- loss: 1.058592, loss_ss: 0.911573, loss_d: 0.147019
0.4221 --- loss: 1.266523, loss_ss: 0.919847, loss_d: 0.346676
0.4605 --- loss: 0.850426, loss_ss: 0.761761, loss_d: 0.088665
0.4988 --- loss: 1.134196, loss_ss: 0.923162, loss_d: 0.211034
0.5372 --- loss: 0.930072, loss_ss: 0.882904, loss_d: 0.047167
0.5756 --- loss: 0.859167, loss_ss: 0.791287, loss_d: 0.067880
0.6140 --- loss: 0.656356, loss_ss: 0.570728, loss_d: 0.085629
0.6523 --- loss: 0.933915, loss_ss: 0.802062, loss_d: 0.131853
0.6907 --- loss: 0.769292, loss_ss: 0.570478, loss_d: 0.198814
0.7291 --- loss: 0.802594, loss_ss: 0.773102, loss_d: 0.029492
0.7675 --- loss: 1.015852, loss_ss: 0.998646, loss_d: 0.017207
0.8058 --- loss: 1.391189, loss_ss: 1.004687, loss_d: 0.386502
0.8442 --- loss: 0.940124, loss_ss: 0.917719, loss_d: 0.022404
0.8826 --- loss: 1.114831, loss_ss: 1.020497, loss_d: 0.094333
0.9210 --- loss: 1.132972, loss_ss: 0.686134, loss_d: 0.446838
0.9593 --- loss: 0.957533, loss_ss: 0.875323, loss_d: 0.082210
0.9977 --- loss: 1.287568, loss_ss: 0.981891, loss_d: 0.305677
Epoch finished! Loss: 1.0781821007911976
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.978090, loss_ss: 0.960349, loss_d: 0.017742
0.0384 --- loss: 1.219284, loss_ss: 1.063139, loss_d: 0.156145
0.0767 --- loss: 0.986585, loss_ss: 0.895846, loss_d: 0.090739
0.1151 --- loss: 0.850538, loss_ss: 0.836067, loss_d: 0.014471
0.1535 --- loss: 0.827298, loss_ss: 0.781389, loss_d: 0.045908
0.1919 --- loss: 1.061708, loss_ss: 1.008914, loss_d: 0.052793
0.2302 --- loss: 0.959654, loss_ss: 0.936318, loss_d: 0.023335
0.2686 --- loss: 0.932611, loss_ss: 0.924154, loss_d: 0.008457
0.3070 --- loss: 1.029867, loss_ss: 0.957441, loss_d: 0.072426
0.3454 --- loss: 1.192839, loss_ss: 0.815281, loss_d: 0.377558
0.3837 --- loss: 1.260373, loss_ss: 0.813260, loss_d: 0.447113
0.4221 --- loss: 0.762986, loss_ss: 0.704985, loss_d: 0.058001
0.4605 --- loss: 0.785975, loss_ss: 0.598925, loss_d: 0.187050
0.4988 --- loss: 1.024014, loss_ss: 0.798258, loss_d: 0.225757
0.5372 --- loss: 0.912092, loss_ss: 0.881615, loss_d: 0.030476
0.5756 --- loss: 0.919462, loss_ss: 0.815291, loss_d: 0.104171
0.6140 --- loss: 1.170126, loss_ss: 0.945916, loss_d: 0.224209
0.6523 --- loss: 0.981877, loss_ss: 0.912684, loss_d: 0.069194
0.6907 --- loss: 0.870131, loss_ss: 0.822110, loss_d: 0.048021
0.7291 --- loss: 1.236204, loss_ss: 0.856520, loss_d: 0.379684
0.7675 --- loss: 1.188966, loss_ss: 1.141310, loss_d: 0.047655
0.8058 --- loss: 1.369212, loss_ss: 0.861931, loss_d: 0.507281
0.8442 --- loss: 1.005610, loss_ss: 0.962164, loss_d: 0.043446
0.8826 --- loss: 1.169904, loss_ss: 1.088738, loss_d: 0.081166
0.9210 --- loss: 0.817585, loss_ss: 0.733240, loss_d: 0.084345
0.9593 --- loss: 1.266368, loss_ss: 1.082148, loss_d: 0.184220
0.9977 --- loss: 0.973105, loss_ss: 0.925764, loss_d: 0.047341
Epoch finished! Loss: 1.0652574756970772
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.048444, loss_ss: 1.018289, loss_d: 0.030155
0.0384 --- loss: 1.180052, loss_ss: 1.116107, loss_d: 0.063945
0.0767 --- loss: 0.589497, loss_ss: 0.533876, loss_d: 0.055621
0.1151 --- loss: 1.239853, loss_ss: 1.165154, loss_d: 0.074699
0.1535 --- loss: 1.042868, loss_ss: 0.870242, loss_d: 0.172626
0.1919 --- loss: 0.760771, loss_ss: 0.516565, loss_d: 0.244206
0.2302 --- loss: 1.019271, loss_ss: 0.905299, loss_d: 0.113972
0.2686 --- loss: 0.842688, loss_ss: 0.794443, loss_d: 0.048245
0.3070 --- loss: 0.729885, loss_ss: 0.707155, loss_d: 0.022730
0.3454 --- loss: 0.977384, loss_ss: 0.757086, loss_d: 0.220298
0.3837 --- loss: 0.776048, loss_ss: 0.702844, loss_d: 0.073204
0.4221 --- loss: 1.188156, loss_ss: 1.174469, loss_d: 0.013687
0.4605 --- loss: 0.870258, loss_ss: 0.774249, loss_d: 0.096009
0.4988 --- loss: 0.876037, loss_ss: 0.818958, loss_d: 0.057079
0.5372 --- loss: 0.718247, loss_ss: 0.691542, loss_d: 0.026704
0.5756 --- loss: 1.163043, loss_ss: 0.980715, loss_d: 0.182328
0.6140 --- loss: 1.819271, loss_ss: 0.998685, loss_d: 0.820586
0.6523 --- loss: 0.677400, loss_ss: 0.644169, loss_d: 0.033231
0.6907 --- loss: 0.834423, loss_ss: 0.819465, loss_d: 0.014958
0.7291 --- loss: 1.117789, loss_ss: 0.829121, loss_d: 0.288668
0.7675 --- loss: 0.792129, loss_ss: 0.743533, loss_d: 0.048596
0.8058 --- loss: 1.010882, loss_ss: 0.998754, loss_d: 0.012128
0.8442 --- loss: 1.517757, loss_ss: 1.133898, loss_d: 0.383859
0.8826 --- loss: 1.194528, loss_ss: 1.013348, loss_d: 0.181180
0.9210 --- loss: 0.913898, loss_ss: 0.723741, loss_d: 0.190157
0.9593 --- loss: 0.739075, loss_ss: 0.688995, loss_d: 0.050081
0.9977 --- loss: 2.098012, loss_ss: 0.605855, loss_d: 1.492157
Epoch finished! Loss: 1.0271656316060287
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.023453, loss_ss: 1.002747, loss_d: 0.020705
0.0384 --- loss: 0.843245, loss_ss: 0.790951, loss_d: 0.052294
0.0767 --- loss: 0.860081, loss_ss: 0.802244, loss_d: 0.057837
0.1151 --- loss: 1.305080, loss_ss: 1.113475, loss_d: 0.191606
0.1535 --- loss: 0.979234, loss_ss: 0.910595, loss_d: 0.068639
0.1919 --- loss: 0.867193, loss_ss: 0.668284, loss_d: 0.198909
0.2302 --- loss: 0.865426, loss_ss: 0.854648, loss_d: 0.010777
0.2686 --- loss: 0.838858, loss_ss: 0.808301, loss_d: 0.030557
0.3070 --- loss: 1.577346, loss_ss: 0.782550, loss_d: 0.794797
0.3454 --- loss: 1.115197, loss_ss: 0.902919, loss_d: 0.212278
0.3837 --- loss: 0.748185, loss_ss: 0.687235, loss_d: 0.060950
0.4221 --- loss: 1.212906, loss_ss: 1.050165, loss_d: 0.162741
0.4605 --- loss: 1.070336, loss_ss: 1.063159, loss_d: 0.007176
0.4988 --- loss: 1.129458, loss_ss: 0.842463, loss_d: 0.286995
0.5372 --- loss: 0.852128, loss_ss: 0.778735, loss_d: 0.073394
0.5756 --- loss: 1.141679, loss_ss: 1.020895, loss_d: 0.120784
0.6140 --- loss: 0.886289, loss_ss: 0.860851, loss_d: 0.025438
0.6523 --- loss: 1.177803, loss_ss: 1.099596, loss_d: 0.078207
0.6907 --- loss: 0.838721, loss_ss: 0.745219, loss_d: 0.093502
0.7291 --- loss: 0.833324, loss_ss: 0.795610, loss_d: 0.037714
0.7675 --- loss: 0.681403, loss_ss: 0.641864, loss_d: 0.039538
0.8058 --- loss: 1.363945, loss_ss: 1.216230, loss_d: 0.147715
0.8442 --- loss: 0.668427, loss_ss: 0.644180, loss_d: 0.024247
0.8826 --- loss: 0.814414, loss_ss: 0.806470, loss_d: 0.007944
0.9210 --- loss: 1.158188, loss_ss: 1.149572, loss_d: 0.008616
0.9593 --- loss: 0.679474, loss_ss: 0.669861, loss_d: 0.009613
0.9977 --- loss: 1.234301, loss_ss: 1.212589, loss_d: 0.021712
Epoch finished! Loss: 0.9717072977469517
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.682998, loss_ss: 0.677773, loss_d: 0.005225
0.0384 --- loss: 1.337375, loss_ss: 1.143007, loss_d: 0.194367
0.0767 --- loss: 1.220170, loss_ss: 0.975330, loss_d: 0.244840
0.1151 --- loss: 1.435782, loss_ss: 1.200117, loss_d: 0.235665
0.1535 --- loss: 1.034754, loss_ss: 0.903891, loss_d: 0.130863
0.1919 --- loss: 1.199250, loss_ss: 1.099722, loss_d: 0.099528
0.2302 --- loss: 0.755443, loss_ss: 0.725908, loss_d: 0.029536
0.2686 --- loss: 1.116673, loss_ss: 0.798513, loss_d: 0.318160
0.3070 --- loss: 1.026674, loss_ss: 0.934512, loss_d: 0.092162
0.3454 --- loss: 0.923553, loss_ss: 0.894476, loss_d: 0.029077
0.3837 --- loss: 0.939784, loss_ss: 0.680003, loss_d: 0.259781
0.4221 --- loss: 0.824751, loss_ss: 0.758457, loss_d: 0.066294
0.4605 --- loss: 0.819224, loss_ss: 0.748571, loss_d: 0.070654
0.4988 --- loss: 0.970210, loss_ss: 0.796711, loss_d: 0.173499
0.5372 --- loss: 1.178103, loss_ss: 1.034424, loss_d: 0.143679
0.5756 --- loss: 0.905471, loss_ss: 0.900597, loss_d: 0.004875
0.6140 --- loss: 0.934354, loss_ss: 0.900800, loss_d: 0.033554
0.6523 --- loss: 0.832659, loss_ss: 0.818228, loss_d: 0.014431
0.6907 --- loss: 1.092299, loss_ss: 1.090020, loss_d: 0.002279
0.7291 --- loss: 1.204111, loss_ss: 1.151866, loss_d: 0.052246
0.7675 --- loss: 0.921479, loss_ss: 0.781283, loss_d: 0.140196
0.8058 --- loss: 0.753714, loss_ss: 0.677610, loss_d: 0.076104
0.8442 --- loss: 1.322555, loss_ss: 1.045218, loss_d: 0.277338
0.8826 --- loss: 0.936013, loss_ss: 0.920623, loss_d: 0.015389
0.9210 --- loss: 0.868361, loss_ss: 0.866511, loss_d: 0.001850
0.9593 --- loss: 1.227381, loss_ss: 1.223550, loss_d: 0.003831
0.9977 --- loss: 0.936475, loss_ss: 0.932165, loss_d: 0.004311
Epoch finished! Loss: 0.9573954686522483
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6552083333333333
             precision    recall  f1-score   support

        0.0       0.30      0.70      0.42        57
        1.0       0.15      0.43      0.22        60
        2.0       0.85      0.85      0.85       496
        3.0       0.91      0.78      0.84        90
        4.0       0.95      0.28      0.44       257

avg / total       0.81      0.66      0.67       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.33  70.18   89.48  29.63     41.67
1  80.52  43.33   83.00  14.53     21.76
2  84.58  84.68   84.48  85.37     85.02
3  97.19  77.78   99.20  90.91     83.83
4  80.42  28.40   99.43  94.81     43.71
Total accuracy: 65.52%
Average sen: 60.87%
Average spec: 91.12%
Macro f1-score: 55.20%
Diagnosis acc on 15mins: 1.0
[0.99966276 0.99968565 0.99989641 0.99995685 0.99983191 0.99272847
 0.99950373 0.99983239 0.99758565 0.99747676 0.99998593 0.99992561
 0.99969554 0.99975353 0.92582369 0.99537271 0.99944705 0.99995315
 0.99999261 0.99292576 0.99920195 0.98669946 0.99741483 0.96431357
 0.99898583 0.9995479  0.99912673 0.99924433 0.9984237  0.99332291
 0.99847859 0.97313029]
pred: 0.9939664453268051, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.433030, loss_ss: 1.770489, loss_d: 0.662541
0.0384 --- loss: 2.223803, loss_ss: 1.515937, loss_d: 0.707865
0.0768 --- loss: 1.932440, loss_ss: 1.418507, loss_d: 0.513933
0.1152 --- loss: 2.524809, loss_ss: 1.641643, loss_d: 0.883166
0.1536 --- loss: 2.081695, loss_ss: 1.502563, loss_d: 0.579132
0.1919 --- loss: 2.011220, loss_ss: 1.422143, loss_d: 0.589076
0.2303 --- loss: 1.985613, loss_ss: 1.352271, loss_d: 0.633343
0.2687 --- loss: 1.998736, loss_ss: 1.549318, loss_d: 0.449419
0.3071 --- loss: 2.181901, loss_ss: 1.356365, loss_d: 0.825536
0.3455 --- loss: 2.171729, loss_ss: 1.498032, loss_d: 0.673697
0.3839 --- loss: 2.093900, loss_ss: 1.468928, loss_d: 0.624972
0.4223 --- loss: 1.777807, loss_ss: 1.209081, loss_d: 0.568726
0.4607 --- loss: 1.658782, loss_ss: 1.183407, loss_d: 0.475375
0.4990 --- loss: 1.980066, loss_ss: 1.291064, loss_d: 0.689002
0.5374 --- loss: 1.647063, loss_ss: 1.273466, loss_d: 0.373597
0.5758 --- loss: 2.020763, loss_ss: 1.350130, loss_d: 0.670633
0.6142 --- loss: 1.992184, loss_ss: 1.343408, loss_d: 0.648777
0.6526 --- loss: 1.592919, loss_ss: 1.206962, loss_d: 0.385958
0.6910 --- loss: 1.780223, loss_ss: 1.285860, loss_d: 0.494363
0.7294 --- loss: 1.813130, loss_ss: 1.312439, loss_d: 0.500691
0.7678 --- loss: 1.890970, loss_ss: 1.275750, loss_d: 0.615220
0.8061 --- loss: 1.717114, loss_ss: 1.303728, loss_d: 0.413386
0.8445 --- loss: 1.884639, loss_ss: 1.287945, loss_d: 0.596694
0.8829 --- loss: 1.595165, loss_ss: 1.249715, loss_d: 0.345450
0.9213 --- loss: 1.798719, loss_ss: 1.362051, loss_d: 0.436668
0.9597 --- loss: 2.094120, loss_ss: 1.093491, loss_d: 1.000628
0.9981 --- loss: 1.684552, loss_ss: 1.173684, loss_d: 0.510868
Epoch finished! Loss: 1.9045087011960837
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.662617, loss_ss: 1.116852, loss_d: 0.545766
0.0384 --- loss: 1.562205, loss_ss: 1.050608, loss_d: 0.511597
0.0768 --- loss: 1.745370, loss_ss: 1.288156, loss_d: 0.457214
0.1152 --- loss: 1.264403, loss_ss: 1.064949, loss_d: 0.199455
0.1536 --- loss: 1.927857, loss_ss: 1.018439, loss_d: 0.909418
0.1919 --- loss: 1.403019, loss_ss: 1.143449, loss_d: 0.259569
0.2303 --- loss: 1.544486, loss_ss: 1.107525, loss_d: 0.436961
0.2687 --- loss: 1.829282, loss_ss: 1.186310, loss_d: 0.642972
0.3071 --- loss: 1.513888, loss_ss: 1.152917, loss_d: 0.360972
0.3455 --- loss: 1.792293, loss_ss: 1.138541, loss_d: 0.653751
0.3839 --- loss: 1.337389, loss_ss: 1.046519, loss_d: 0.290870
0.4223 --- loss: 1.657709, loss_ss: 1.145439, loss_d: 0.512270
0.4607 --- loss: 1.581863, loss_ss: 1.036378, loss_d: 0.545485
0.4990 --- loss: 1.180091, loss_ss: 0.919069, loss_d: 0.261022
0.5374 --- loss: 1.284068, loss_ss: 1.121732, loss_d: 0.162336
0.5758 --- loss: 1.481478, loss_ss: 0.989722, loss_d: 0.491757
0.6142 --- loss: 1.534990, loss_ss: 1.060550, loss_d: 0.474441
0.6526 --- loss: 1.235876, loss_ss: 1.029680, loss_d: 0.206196
0.6910 --- loss: 1.284103, loss_ss: 0.993146, loss_d: 0.290957
0.7294 --- loss: 1.506534, loss_ss: 1.295557, loss_d: 0.210977
0.7678 --- loss: 1.928257, loss_ss: 1.247250, loss_d: 0.681007
0.8061 --- loss: 1.292656, loss_ss: 0.993626, loss_d: 0.299030
0.8445 --- loss: 1.289847, loss_ss: 1.175218, loss_d: 0.114629
0.8829 --- loss: 0.891918, loss_ss: 0.723356, loss_d: 0.168562
0.9213 --- loss: 1.418887, loss_ss: 1.023975, loss_d: 0.394912
0.9597 --- loss: 1.646557, loss_ss: 1.222645, loss_d: 0.423913
0.9981 --- loss: 1.301712, loss_ss: 1.132847, loss_d: 0.168866
Epoch finished! Loss: 1.4537808287602205
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.240555, loss_ss: 1.046409, loss_d: 0.194147
0.0384 --- loss: 1.399824, loss_ss: 0.876616, loss_d: 0.523209
0.0768 --- loss: 1.395215, loss_ss: 1.134490, loss_d: 0.260725
0.1152 --- loss: 1.022199, loss_ss: 0.911807, loss_d: 0.110392
0.1536 --- loss: 1.237509, loss_ss: 0.941758, loss_d: 0.295751
0.1919 --- loss: 1.392287, loss_ss: 0.971636, loss_d: 0.420651
0.2303 --- loss: 1.272092, loss_ss: 0.806126, loss_d: 0.465965
0.2687 --- loss: 1.160370, loss_ss: 0.935122, loss_d: 0.225248
0.3071 --- loss: 1.799970, loss_ss: 1.222184, loss_d: 0.577786
0.3455 --- loss: 1.030675, loss_ss: 0.898656, loss_d: 0.132019
0.3839 --- loss: 1.217801, loss_ss: 0.866035, loss_d: 0.351766
0.4223 --- loss: 1.335632, loss_ss: 0.936985, loss_d: 0.398647
0.4607 --- loss: 1.148324, loss_ss: 0.932936, loss_d: 0.215388
0.4990 --- loss: 1.092801, loss_ss: 0.862672, loss_d: 0.230129
0.5374 --- loss: 1.509342, loss_ss: 1.028035, loss_d: 0.481307
0.5758 --- loss: 1.185129, loss_ss: 0.957490, loss_d: 0.227640
0.6142 --- loss: 1.476055, loss_ss: 1.366982, loss_d: 0.109072
0.6526 --- loss: 1.046194, loss_ss: 0.972880, loss_d: 0.073314
0.6910 --- loss: 0.829180, loss_ss: 0.736790, loss_d: 0.092390
0.7294 --- loss: 1.304081, loss_ss: 0.959856, loss_d: 0.344225
0.7678 --- loss: 1.246406, loss_ss: 0.909364, loss_d: 0.337042
0.8061 --- loss: 1.280553, loss_ss: 1.140111, loss_d: 0.140442
0.8445 --- loss: 0.882396, loss_ss: 0.787229, loss_d: 0.095167
0.8829 --- loss: 1.179647, loss_ss: 1.048239, loss_d: 0.131408
0.9213 --- loss: 0.973180, loss_ss: 0.888237, loss_d: 0.084943
0.9597 --- loss: 1.035726, loss_ss: 0.811893, loss_d: 0.223834
0.9981 --- loss: 1.542632, loss_ss: 1.459004, loss_d: 0.083628
Epoch finished! Loss: 1.2789748304165327
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.438268, loss_ss: 1.211723, loss_d: 0.226545
0.0384 --- loss: 1.301681, loss_ss: 0.805066, loss_d: 0.496614
0.0768 --- loss: 0.978346, loss_ss: 0.818001, loss_d: 0.160345
0.1152 --- loss: 0.987853, loss_ss: 0.822867, loss_d: 0.164986
0.1536 --- loss: 0.933448, loss_ss: 0.673903, loss_d: 0.259545
0.1919 --- loss: 0.758863, loss_ss: 0.706803, loss_d: 0.052060
0.2303 --- loss: 0.987041, loss_ss: 0.768315, loss_d: 0.218725
0.2687 --- loss: 1.502688, loss_ss: 1.170406, loss_d: 0.332283
0.3071 --- loss: 1.319823, loss_ss: 1.100087, loss_d: 0.219736
0.3455 --- loss: 1.350767, loss_ss: 0.820039, loss_d: 0.530728
0.3839 --- loss: 1.389457, loss_ss: 1.283028, loss_d: 0.106430
0.4223 --- loss: 1.065122, loss_ss: 0.886748, loss_d: 0.178373
0.4607 --- loss: 0.911366, loss_ss: 0.812140, loss_d: 0.099225
0.4990 --- loss: 1.041956, loss_ss: 0.826221, loss_d: 0.215735
0.5374 --- loss: 1.503819, loss_ss: 1.038222, loss_d: 0.465596
0.5758 --- loss: 0.874879, loss_ss: 0.779680, loss_d: 0.095199
0.6142 --- loss: 0.969857, loss_ss: 0.858313, loss_d: 0.111544
0.6526 --- loss: 1.261530, loss_ss: 0.821173, loss_d: 0.440357
0.6910 --- loss: 1.237958, loss_ss: 1.066980, loss_d: 0.170977
0.7294 --- loss: 1.106575, loss_ss: 0.724675, loss_d: 0.381900
0.7678 --- loss: 0.939805, loss_ss: 0.844251, loss_d: 0.095554
0.8061 --- loss: 1.054281, loss_ss: 0.745116, loss_d: 0.309165
0.8445 --- loss: 1.000203, loss_ss: 0.909844, loss_d: 0.090359
0.8829 --- loss: 1.155739, loss_ss: 1.101635, loss_d: 0.054104
0.9213 --- loss: 1.054451, loss_ss: 0.856121, loss_d: 0.198331
0.9597 --- loss: 0.834072, loss_ss: 0.779679, loss_d: 0.054393
0.9981 --- loss: 1.426212, loss_ss: 1.399903, loss_d: 0.026308
Epoch finished! Loss: 1.1787926194759515
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.401917, loss_ss: 0.809933, loss_d: 0.591984
0.0384 --- loss: 1.251570, loss_ss: 0.927741, loss_d: 0.323828
0.0768 --- loss: 1.100576, loss_ss: 0.623396, loss_d: 0.477180
0.1152 --- loss: 1.614951, loss_ss: 0.969450, loss_d: 0.645501
0.1536 --- loss: 0.958006, loss_ss: 0.885189, loss_d: 0.072817
0.1919 --- loss: 1.208363, loss_ss: 0.796404, loss_d: 0.411959
0.2303 --- loss: 0.983937, loss_ss: 0.818342, loss_d: 0.165594
0.2687 --- loss: 1.060907, loss_ss: 0.933071, loss_d: 0.127836
0.3071 --- loss: 0.903912, loss_ss: 0.853281, loss_d: 0.050630
0.3455 --- loss: 1.175465, loss_ss: 0.973309, loss_d: 0.202156
0.3839 --- loss: 0.844479, loss_ss: 0.806532, loss_d: 0.037948
0.4223 --- loss: 0.860988, loss_ss: 0.817664, loss_d: 0.043324
0.4607 --- loss: 0.932793, loss_ss: 0.777093, loss_d: 0.155699
0.4990 --- loss: 1.046462, loss_ss: 0.946288, loss_d: 0.100173
0.5374 --- loss: 1.001265, loss_ss: 0.843723, loss_d: 0.157542
0.5758 --- loss: 1.205429, loss_ss: 0.953823, loss_d: 0.251605
0.6142 --- loss: 1.067449, loss_ss: 0.937796, loss_d: 0.129653
0.6526 --- loss: 0.898189, loss_ss: 0.857159, loss_d: 0.041030
0.6910 --- loss: 2.542368, loss_ss: 0.995143, loss_d: 1.547224
0.7294 --- loss: 1.190425, loss_ss: 1.073813, loss_d: 0.116612
0.7678 --- loss: 0.999178, loss_ss: 0.860682, loss_d: 0.138496
0.8061 --- loss: 1.282272, loss_ss: 1.002866, loss_d: 0.279407
0.8445 --- loss: 0.940084, loss_ss: 0.838733, loss_d: 0.101350
0.8829 --- loss: 1.130253, loss_ss: 0.920517, loss_d: 0.209736
0.9213 --- loss: 1.078206, loss_ss: 0.809611, loss_d: 0.268595
0.9597 --- loss: 1.752238, loss_ss: 1.030047, loss_d: 0.722190
0.9981 --- loss: 1.936744, loss_ss: 1.750064, loss_d: 0.186681
Epoch finished! Loss: 1.1198649642559197
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.282559, loss_ss: 1.148119, loss_d: 0.134440
0.0384 --- loss: 0.869730, loss_ss: 0.717422, loss_d: 0.152308
0.0768 --- loss: 0.886540, loss_ss: 0.740660, loss_d: 0.145880
0.1152 --- loss: 0.992134, loss_ss: 0.930950, loss_d: 0.061184
0.1536 --- loss: 1.170954, loss_ss: 0.930060, loss_d: 0.240894
0.1919 --- loss: 1.497653, loss_ss: 0.774712, loss_d: 0.722941
0.2303 --- loss: 1.382179, loss_ss: 0.965561, loss_d: 0.416618
0.2687 --- loss: 1.192118, loss_ss: 0.974931, loss_d: 0.217187
0.3071 --- loss: 1.106578, loss_ss: 0.865080, loss_d: 0.241499
0.3455 --- loss: 1.018653, loss_ss: 0.874293, loss_d: 0.144360
0.3839 --- loss: 0.706828, loss_ss: 0.648493, loss_d: 0.058335
0.4223 --- loss: 1.490556, loss_ss: 1.423250, loss_d: 0.067306
0.4607 --- loss: 1.044390, loss_ss: 0.863809, loss_d: 0.180581
0.4990 --- loss: 0.912961, loss_ss: 0.784786, loss_d: 0.128175
0.5374 --- loss: 0.861307, loss_ss: 0.790692, loss_d: 0.070616
0.5758 --- loss: 0.815118, loss_ss: 0.754258, loss_d: 0.060860
0.6142 --- loss: 0.848570, loss_ss: 0.774077, loss_d: 0.074494
0.6526 --- loss: 0.857424, loss_ss: 0.675310, loss_d: 0.182114
0.6910 --- loss: 1.132024, loss_ss: 0.853113, loss_d: 0.278912
0.7294 --- loss: 0.827784, loss_ss: 0.681781, loss_d: 0.146003
0.7678 --- loss: 1.050104, loss_ss: 0.881887, loss_d: 0.168217
0.8061 --- loss: 1.165666, loss_ss: 1.044288, loss_d: 0.121378
0.8445 --- loss: 1.289488, loss_ss: 0.938538, loss_d: 0.350950
0.8829 --- loss: 1.361233, loss_ss: 0.864258, loss_d: 0.496975
0.9213 --- loss: 0.910556, loss_ss: 0.873782, loss_d: 0.036774
0.9597 --- loss: 1.043353, loss_ss: 0.873089, loss_d: 0.170264
0.9981 --- loss: 1.301591, loss_ss: 1.160834, loss_d: 0.140756
Epoch finished! Loss: 1.0709914292280491
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.823277, loss_ss: 0.791881, loss_d: 0.031396
0.0384 --- loss: 1.160964, loss_ss: 1.037908, loss_d: 0.123056
0.0768 --- loss: 0.844690, loss_ss: 0.818484, loss_d: 0.026206
0.1152 --- loss: 0.829794, loss_ss: 0.780729, loss_d: 0.049064
0.1536 --- loss: 1.362383, loss_ss: 0.886767, loss_d: 0.475616
0.1919 --- loss: 0.709038, loss_ss: 0.677873, loss_d: 0.031165
0.2303 --- loss: 1.175798, loss_ss: 1.015654, loss_d: 0.160144
0.2687 --- loss: 1.365999, loss_ss: 0.794318, loss_d: 0.571681
0.3071 --- loss: 1.158432, loss_ss: 0.864696, loss_d: 0.293737
0.3455 --- loss: 0.864698, loss_ss: 0.725266, loss_d: 0.139431
0.3839 --- loss: 0.984185, loss_ss: 0.967044, loss_d: 0.017141
0.4223 --- loss: 1.246006, loss_ss: 1.111820, loss_d: 0.134185
0.4607 --- loss: 1.066997, loss_ss: 0.876858, loss_d: 0.190139
0.4990 --- loss: 0.721571, loss_ss: 0.694130, loss_d: 0.027441
0.5374 --- loss: 1.099039, loss_ss: 0.953301, loss_d: 0.145738
0.5758 --- loss: 0.923477, loss_ss: 0.803691, loss_d: 0.119786
0.6142 --- loss: 0.899421, loss_ss: 0.646007, loss_d: 0.253414
0.6526 --- loss: 1.409868, loss_ss: 1.213694, loss_d: 0.196174
0.6910 --- loss: 0.754391, loss_ss: 0.617268, loss_d: 0.137122
0.7294 --- loss: 1.370641, loss_ss: 0.926435, loss_d: 0.444206
0.7678 --- loss: 0.836167, loss_ss: 0.776233, loss_d: 0.059934
0.8061 --- loss: 0.735980, loss_ss: 0.698020, loss_d: 0.037960
0.8445 --- loss: 0.836936, loss_ss: 0.646425, loss_d: 0.190511
0.8829 --- loss: 0.792410, loss_ss: 0.754745, loss_d: 0.037665
0.9213 --- loss: 1.601776, loss_ss: 0.716056, loss_d: 0.885720
0.9597 --- loss: 1.223094, loss_ss: 1.028937, loss_d: 0.194157
0.9981 --- loss: 1.187101, loss_ss: 1.077284, loss_d: 0.109817
Epoch finished! Loss: 1.0378767036474668
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.992798, loss_ss: 0.836310, loss_d: 0.156489
0.0384 --- loss: 1.374752, loss_ss: 1.192624, loss_d: 0.182128
0.0768 --- loss: 0.722763, loss_ss: 0.682565, loss_d: 0.040199
0.1152 --- loss: 0.711069, loss_ss: 0.680851, loss_d: 0.030218
0.1536 --- loss: 0.842309, loss_ss: 0.821752, loss_d: 0.020556
0.1919 --- loss: 0.836654, loss_ss: 0.822598, loss_d: 0.014056
0.2303 --- loss: 0.901350, loss_ss: 0.668156, loss_d: 0.233194
0.2687 --- loss: 2.459707, loss_ss: 0.997349, loss_d: 1.462358
0.3071 --- loss: 1.205954, loss_ss: 1.158761, loss_d: 0.047194
0.3455 --- loss: 1.184359, loss_ss: 0.876910, loss_d: 0.307449
0.3839 --- loss: 1.068170, loss_ss: 1.007237, loss_d: 0.060933
0.4223 --- loss: 1.255847, loss_ss: 1.010221, loss_d: 0.245626
0.4607 --- loss: 0.884749, loss_ss: 0.701323, loss_d: 0.183426
0.4990 --- loss: 0.997141, loss_ss: 0.899141, loss_d: 0.098000
0.5374 --- loss: 1.012376, loss_ss: 0.861610, loss_d: 0.150766
0.5758 --- loss: 0.707330, loss_ss: 0.641010, loss_d: 0.066319
0.6142 --- loss: 1.123112, loss_ss: 0.967767, loss_d: 0.155345
0.6526 --- loss: 0.831324, loss_ss: 0.797667, loss_d: 0.033658
0.6910 --- loss: 0.838142, loss_ss: 0.706286, loss_d: 0.131856
0.7294 --- loss: 0.570463, loss_ss: 0.518396, loss_d: 0.052066
0.7678 --- loss: 1.113031, loss_ss: 0.583087, loss_d: 0.529943
0.8061 --- loss: 1.100440, loss_ss: 0.796430, loss_d: 0.304010
0.8445 --- loss: 0.849642, loss_ss: 0.760235, loss_d: 0.089407
0.8829 --- loss: 0.822051, loss_ss: 0.794032, loss_d: 0.028020
0.9213 --- loss: 0.807021, loss_ss: 0.688281, loss_d: 0.118741
0.9597 --- loss: 0.753439, loss_ss: 0.653696, loss_d: 0.099742
0.9981 --- loss: 2.830544, loss_ss: 0.973797, loss_d: 1.856747
Epoch finished! Loss: 1.0196950779511378
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.025507, loss_ss: 0.758755, loss_d: 0.266752
0.0384 --- loss: 0.879779, loss_ss: 0.712702, loss_d: 0.167078
0.0768 --- loss: 1.005009, loss_ss: 0.844891, loss_d: 0.160117
0.1152 --- loss: 1.301424, loss_ss: 1.246542, loss_d: 0.054882
0.1536 --- loss: 1.054296, loss_ss: 0.988233, loss_d: 0.066063
0.1919 --- loss: 1.859008, loss_ss: 1.316598, loss_d: 0.542410
0.2303 --- loss: 0.793670, loss_ss: 0.781227, loss_d: 0.012442
0.2687 --- loss: 0.737272, loss_ss: 0.659034, loss_d: 0.078237
0.3071 --- loss: 1.320608, loss_ss: 1.270521, loss_d: 0.050087
0.3455 --- loss: 0.991404, loss_ss: 0.983192, loss_d: 0.008212
0.3839 --- loss: 0.810712, loss_ss: 0.800044, loss_d: 0.010669
0.4223 --- loss: 0.869758, loss_ss: 0.859677, loss_d: 0.010082
0.4607 --- loss: 1.078318, loss_ss: 1.023174, loss_d: 0.055144
0.4990 --- loss: 1.360193, loss_ss: 0.855458, loss_d: 0.504735
0.5374 --- loss: 1.040157, loss_ss: 0.993122, loss_d: 0.047035
0.5758 --- loss: 0.881558, loss_ss: 0.784545, loss_d: 0.097013
0.6142 --- loss: 0.694621, loss_ss: 0.581981, loss_d: 0.112640
0.6526 --- loss: 0.882660, loss_ss: 0.701001, loss_d: 0.181659
0.6910 --- loss: 1.349765, loss_ss: 0.658833, loss_d: 0.690932
0.7294 --- loss: 0.987825, loss_ss: 0.963366, loss_d: 0.024459
0.7678 --- loss: 1.065285, loss_ss: 0.923608, loss_d: 0.141678
0.8061 --- loss: 0.798285, loss_ss: 0.788402, loss_d: 0.009884
0.8445 --- loss: 0.777315, loss_ss: 0.754713, loss_d: 0.022602
0.8829 --- loss: 1.030062, loss_ss: 0.748684, loss_d: 0.281379
0.9213 --- loss: 0.908720, loss_ss: 0.857137, loss_d: 0.051583
0.9597 --- loss: 1.035566, loss_ss: 0.886111, loss_d: 0.149455
0.9981 --- loss: 2.197395, loss_ss: 0.713516, loss_d: 1.483879
Epoch finished! Loss: 0.9836547791957855
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.139800, loss_ss: 0.829353, loss_d: 0.310447
0.0384 --- loss: 0.894696, loss_ss: 0.658392, loss_d: 0.236303
0.0768 --- loss: 2.032181, loss_ss: 0.814949, loss_d: 1.217233
0.1152 --- loss: 0.731040, loss_ss: 0.625994, loss_d: 0.105046
0.1536 --- loss: 1.105233, loss_ss: 0.986897, loss_d: 0.118337
0.1919 --- loss: 0.677398, loss_ss: 0.639763, loss_d: 0.037635
0.2303 --- loss: 1.009919, loss_ss: 0.870385, loss_d: 0.139535
0.2687 --- loss: 1.058812, loss_ss: 1.003100, loss_d: 0.055712
0.3071 --- loss: 0.933469, loss_ss: 0.901983, loss_d: 0.031485
0.3455 --- loss: 0.798068, loss_ss: 0.778661, loss_d: 0.019407
0.3839 --- loss: 1.044764, loss_ss: 0.983753, loss_d: 0.061011
0.4223 --- loss: 1.551214, loss_ss: 0.950876, loss_d: 0.600338
0.4607 --- loss: 0.785408, loss_ss: 0.687960, loss_d: 0.097449
0.4990 --- loss: 0.939241, loss_ss: 0.899611, loss_d: 0.039630
0.5374 --- loss: 0.915484, loss_ss: 0.892891, loss_d: 0.022593
0.5758 --- loss: 0.935518, loss_ss: 0.911006, loss_d: 0.024512
0.6142 --- loss: 0.907191, loss_ss: 0.771244, loss_d: 0.135947
0.6526 --- loss: 1.642110, loss_ss: 0.820786, loss_d: 0.821323
0.6910 --- loss: 0.938664, loss_ss: 0.791516, loss_d: 0.147148
0.7294 --- loss: 1.263517, loss_ss: 1.253796, loss_d: 0.009721
0.7678 --- loss: 0.817970, loss_ss: 0.717146, loss_d: 0.100824
0.8061 --- loss: 0.708309, loss_ss: 0.659105, loss_d: 0.049204
0.8445 --- loss: 1.167262, loss_ss: 1.116523, loss_d: 0.050739
0.8829 --- loss: 1.069700, loss_ss: 0.709194, loss_d: 0.360506
0.9213 --- loss: 0.730921, loss_ss: 0.556781, loss_d: 0.174141
0.9597 --- loss: 0.808428, loss_ss: 0.740795, loss_d: 0.067633
0.9981 --- loss: 1.364807, loss_ss: 1.361535, loss_d: 0.003273
Epoch finished! Loss: 0.9563373939349101
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6060606060606061
             precision    recall  f1-score   support

        0.0       0.87      0.24      0.38       219
        1.0       0.30      0.64      0.41       143
        2.0       0.65      0.56      0.60       221
        3.0       0.99      0.89      0.94       271
        4.0       0.47      0.67      0.55       136

avg / total       0.72      0.61      0.61       990
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.42  24.20   98.96  86.89     37.86
1  73.33  63.64   74.97  30.03     40.81
2  83.43  55.66   91.42  65.08     60.00
3  96.87  89.30   99.72  99.18     93.98
4  85.15  66.91   88.06  47.15     55.32
Total accuracy: 60.61%
Average sen: 59.94%
Average spec: 90.63%
Macro f1-score: 57.59%
Diagnosis acc on 15mins: 1.0
[0.99999928 0.99999678 0.99985504 0.999933   0.99993408 1.
 1.         1.         1.         0.99999893 1.         1.
 0.99998736 0.99993658 0.9999907  0.99999988 1.         1.
 1.         0.99998379 0.99999988 0.99999869 0.99988043 0.99999964
 1.         1.         0.99999988 0.9999994  1.         0.99999988
 0.99994123 0.99993074 0.99999845]
pred: 0.9999807169943145, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.512562, loss_ss: 1.815750, loss_d: 0.696812
0.0384 --- loss: 2.446697, loss_ss: 1.761858, loss_d: 0.684840
0.0769 --- loss: 2.273079, loss_ss: 1.487264, loss_d: 0.785815
0.1153 --- loss: 1.963752, loss_ss: 1.441983, loss_d: 0.521768
0.1538 --- loss: 2.540002, loss_ss: 1.812714, loss_d: 0.727288
0.1922 --- loss: 1.847185, loss_ss: 1.356945, loss_d: 0.490239
0.2307 --- loss: 1.926186, loss_ss: 1.591523, loss_d: 0.334663
0.2691 --- loss: 2.176129, loss_ss: 1.678397, loss_d: 0.497732
0.3076 --- loss: 1.963504, loss_ss: 1.570548, loss_d: 0.392955
0.3460 --- loss: 2.029827, loss_ss: 1.537579, loss_d: 0.492248
0.3845 --- loss: 1.814800, loss_ss: 1.417100, loss_d: 0.397700
0.4229 --- loss: 2.067241, loss_ss: 1.457276, loss_d: 0.609966
0.4614 --- loss: 2.322139, loss_ss: 1.641142, loss_d: 0.680997
0.4998 --- loss: 2.136859, loss_ss: 1.635353, loss_d: 0.501506
0.5383 --- loss: 2.042660, loss_ss: 1.397505, loss_d: 0.645155
0.5767 --- loss: 1.618058, loss_ss: 1.221466, loss_d: 0.396593
0.6151 --- loss: 1.989645, loss_ss: 1.489885, loss_d: 0.499760
0.6536 --- loss: 1.933591, loss_ss: 1.205790, loss_d: 0.727801
0.6920 --- loss: 1.563624, loss_ss: 1.278167, loss_d: 0.285457
0.7305 --- loss: 1.949699, loss_ss: 1.342508, loss_d: 0.607191
0.7689 --- loss: 1.676277, loss_ss: 1.206323, loss_d: 0.469954
0.8074 --- loss: 1.728158, loss_ss: 1.272931, loss_d: 0.455227
0.8458 --- loss: 1.709666, loss_ss: 1.301730, loss_d: 0.407936
0.8843 --- loss: 1.566960, loss_ss: 1.150177, loss_d: 0.416783
0.9227 --- loss: 1.481103, loss_ss: 1.301071, loss_d: 0.180032
0.9612 --- loss: 1.846860, loss_ss: 1.088626, loss_d: 0.758234
0.9996 --- loss: 1.302105, loss_ss: 1.073200, loss_d: 0.228905
Epoch finished! Loss: 2.0189917935774875
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.366801, loss_ss: 1.115438, loss_d: 0.251363
0.0384 --- loss: 1.898386, loss_ss: 1.311900, loss_d: 0.586486
0.0769 --- loss: 1.403693, loss_ss: 1.174859, loss_d: 0.228834
0.1153 --- loss: 1.416558, loss_ss: 1.157718, loss_d: 0.258840
0.1538 --- loss: 1.795179, loss_ss: 1.234681, loss_d: 0.560498
0.1922 --- loss: 1.329976, loss_ss: 1.093890, loss_d: 0.236086
0.2307 --- loss: 1.450522, loss_ss: 1.182998, loss_d: 0.267525
0.2691 --- loss: 1.739561, loss_ss: 1.042912, loss_d: 0.696649
0.3076 --- loss: 1.562678, loss_ss: 1.252228, loss_d: 0.310450
0.3460 --- loss: 1.363496, loss_ss: 1.211164, loss_d: 0.152332
0.3845 --- loss: 1.707856, loss_ss: 1.000744, loss_d: 0.707112
0.4229 --- loss: 1.422754, loss_ss: 1.182691, loss_d: 0.240063
0.4614 --- loss: 1.243908, loss_ss: 1.043461, loss_d: 0.200447
0.4998 --- loss: 1.565027, loss_ss: 1.389022, loss_d: 0.176005
0.5383 --- loss: 1.201942, loss_ss: 1.052744, loss_d: 0.149198
0.5767 --- loss: 1.702584, loss_ss: 1.244210, loss_d: 0.458375
0.6151 --- loss: 1.297600, loss_ss: 1.045699, loss_d: 0.251901
0.6536 --- loss: 1.441241, loss_ss: 1.352201, loss_d: 0.089040
0.6920 --- loss: 1.332049, loss_ss: 1.198137, loss_d: 0.133912
0.7305 --- loss: 1.494425, loss_ss: 1.145973, loss_d: 0.348452
0.7689 --- loss: 1.563139, loss_ss: 1.240622, loss_d: 0.322517
0.8074 --- loss: 1.343045, loss_ss: 1.036570, loss_d: 0.306475
0.8458 --- loss: 1.582964, loss_ss: 0.929782, loss_d: 0.653183
0.8843 --- loss: 1.530514, loss_ss: 1.284498, loss_d: 0.246015
0.9227 --- loss: 1.278150, loss_ss: 0.943304, loss_d: 0.334846
0.9612 --- loss: 1.651654, loss_ss: 1.190311, loss_d: 0.461343
0.9996 --- loss: 4.328335, loss_ss: 1.753924, loss_d: 2.574412
Epoch finished! Loss: 1.5570500084987053
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.264489, loss_ss: 0.993792, loss_d: 0.270698
0.0384 --- loss: 1.286056, loss_ss: 0.889872, loss_d: 0.396184
0.0769 --- loss: 1.653021, loss_ss: 0.955379, loss_d: 0.697642
0.1153 --- loss: 1.110309, loss_ss: 0.909409, loss_d: 0.200899
0.1538 --- loss: 1.887286, loss_ss: 1.274884, loss_d: 0.612402
0.1922 --- loss: 1.211511, loss_ss: 0.907139, loss_d: 0.304371
0.2307 --- loss: 1.905339, loss_ss: 0.915760, loss_d: 0.989580
0.2691 --- loss: 1.208327, loss_ss: 1.114640, loss_d: 0.093686
0.3076 --- loss: 1.165496, loss_ss: 0.916528, loss_d: 0.248969
0.3460 --- loss: 1.319032, loss_ss: 1.174870, loss_d: 0.144162
0.3845 --- loss: 2.066568, loss_ss: 1.043920, loss_d: 1.022648
0.4229 --- loss: 1.045876, loss_ss: 0.796843, loss_d: 0.249033
0.4614 --- loss: 1.320585, loss_ss: 1.018106, loss_d: 0.302479
0.4998 --- loss: 1.077767, loss_ss: 0.872405, loss_d: 0.205362
0.5383 --- loss: 1.102705, loss_ss: 0.909609, loss_d: 0.193097
0.5767 --- loss: 1.243482, loss_ss: 1.130858, loss_d: 0.112624
0.6151 --- loss: 1.449797, loss_ss: 1.051711, loss_d: 0.398086
0.6536 --- loss: 1.361200, loss_ss: 1.003426, loss_d: 0.357774
0.6920 --- loss: 1.361847, loss_ss: 1.111992, loss_d: 0.249855
0.7305 --- loss: 1.260307, loss_ss: 0.893118, loss_d: 0.367189
0.7689 --- loss: 0.924324, loss_ss: 0.846682, loss_d: 0.077641
0.8074 --- loss: 1.014346, loss_ss: 0.832385, loss_d: 0.181961
0.8458 --- loss: 2.082901, loss_ss: 1.005439, loss_d: 1.077462
0.8843 --- loss: 1.176703, loss_ss: 1.083296, loss_d: 0.093407
0.9227 --- loss: 1.264839, loss_ss: 0.929541, loss_d: 0.335298
0.9612 --- loss: 0.924911, loss_ss: 0.828510, loss_d: 0.096401
0.9996 --- loss: 3.040058, loss_ss: 1.235795, loss_d: 1.804263
Epoch finished! Loss: 1.353372641480886
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.113768, loss_ss: 1.015531, loss_d: 0.098236
0.0384 --- loss: 1.240014, loss_ss: 1.049850, loss_d: 0.190164
0.0769 --- loss: 1.263874, loss_ss: 1.110915, loss_d: 0.152959
0.1153 --- loss: 1.135691, loss_ss: 0.927881, loss_d: 0.207810
0.1538 --- loss: 0.966982, loss_ss: 0.907362, loss_d: 0.059621
0.1922 --- loss: 1.290398, loss_ss: 1.007867, loss_d: 0.282531
0.2307 --- loss: 1.065594, loss_ss: 0.931007, loss_d: 0.134587
0.2691 --- loss: 1.145225, loss_ss: 0.867564, loss_d: 0.277662
0.3076 --- loss: 1.154453, loss_ss: 0.886971, loss_d: 0.267481
0.3460 --- loss: 1.545424, loss_ss: 1.280379, loss_d: 0.265045
0.3845 --- loss: 1.760345, loss_ss: 1.236957, loss_d: 0.523388
0.4229 --- loss: 1.249087, loss_ss: 0.775224, loss_d: 0.473863
0.4614 --- loss: 1.112852, loss_ss: 0.881186, loss_d: 0.231667
0.4998 --- loss: 1.255519, loss_ss: 1.120599, loss_d: 0.134920
0.5383 --- loss: 1.041841, loss_ss: 1.004944, loss_d: 0.036897
0.5767 --- loss: 1.402981, loss_ss: 0.824689, loss_d: 0.578293
0.6151 --- loss: 1.273228, loss_ss: 1.105643, loss_d: 0.167585
0.6536 --- loss: 1.270849, loss_ss: 1.123510, loss_d: 0.147339
0.6920 --- loss: 0.925528, loss_ss: 0.879080, loss_d: 0.046448
0.7305 --- loss: 1.787796, loss_ss: 0.875321, loss_d: 0.912475
0.7689 --- loss: 2.273458, loss_ss: 1.491849, loss_d: 0.781609
0.8074 --- loss: 0.985687, loss_ss: 0.864869, loss_d: 0.120818
0.8458 --- loss: 1.553610, loss_ss: 1.011213, loss_d: 0.542397
0.8843 --- loss: 1.076906, loss_ss: 0.851328, loss_d: 0.225578
0.9227 --- loss: 1.344226, loss_ss: 1.097851, loss_d: 0.246375
0.9612 --- loss: 0.985301, loss_ss: 0.877131, loss_d: 0.108169
0.9996 --- loss: 1.324151, loss_ss: 1.267936, loss_d: 0.056215
Epoch finished! Loss: 1.2522088885307312
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.005458, loss_ss: 0.875991, loss_d: 0.129467
0.0384 --- loss: 0.953209, loss_ss: 0.798125, loss_d: 0.155084
0.0769 --- loss: 1.843627, loss_ss: 0.868532, loss_d: 0.975096
0.1153 --- loss: 1.226191, loss_ss: 1.171346, loss_d: 0.054845
0.1538 --- loss: 0.893299, loss_ss: 0.748338, loss_d: 0.144961
0.1922 --- loss: 1.048960, loss_ss: 0.933140, loss_d: 0.115820
0.2307 --- loss: 1.351744, loss_ss: 1.038420, loss_d: 0.313324
0.2691 --- loss: 1.123097, loss_ss: 1.048170, loss_d: 0.074927
0.3076 --- loss: 1.119501, loss_ss: 1.056804, loss_d: 0.062697
0.3460 --- loss: 0.893327, loss_ss: 0.788897, loss_d: 0.104430
0.3845 --- loss: 1.057300, loss_ss: 1.041546, loss_d: 0.015755
0.4229 --- loss: 1.574127, loss_ss: 1.037618, loss_d: 0.536509
0.4614 --- loss: 0.810222, loss_ss: 0.734474, loss_d: 0.075748
0.4998 --- loss: 1.023444, loss_ss: 0.793952, loss_d: 0.229492
0.5383 --- loss: 1.268875, loss_ss: 0.666000, loss_d: 0.602876
0.5767 --- loss: 1.125069, loss_ss: 0.884884, loss_d: 0.240185
0.6151 --- loss: 1.441728, loss_ss: 1.362296, loss_d: 0.079432
0.6536 --- loss: 1.402296, loss_ss: 1.274871, loss_d: 0.127425
0.6920 --- loss: 1.582393, loss_ss: 0.746077, loss_d: 0.836316
0.7305 --- loss: 0.972172, loss_ss: 0.893525, loss_d: 0.078647
0.7689 --- loss: 1.127681, loss_ss: 0.960520, loss_d: 0.167161
0.8074 --- loss: 1.250643, loss_ss: 1.149558, loss_d: 0.101085
0.8458 --- loss: 1.180537, loss_ss: 1.106954, loss_d: 0.073583
0.8843 --- loss: 0.995513, loss_ss: 0.705672, loss_d: 0.289841
0.9227 --- loss: 1.123767, loss_ss: 1.021613, loss_d: 0.102154
0.9612 --- loss: 0.891545, loss_ss: 0.843336, loss_d: 0.048209
0.9996 --- loss: 2.664680, loss_ss: 2.662370, loss_d: 0.002309
Epoch finished! Loss: 1.1692084864928172
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.139705, loss_ss: 1.102903, loss_d: 0.036802
0.0384 --- loss: 0.878917, loss_ss: 0.818548, loss_d: 0.060368
0.0769 --- loss: 1.450194, loss_ss: 1.372496, loss_d: 0.077697
0.1153 --- loss: 1.074921, loss_ss: 1.021390, loss_d: 0.053532
0.1538 --- loss: 1.257317, loss_ss: 0.975606, loss_d: 0.281711
0.1922 --- loss: 1.240005, loss_ss: 0.983781, loss_d: 0.256224
0.2307 --- loss: 1.034564, loss_ss: 1.028906, loss_d: 0.005658
0.2691 --- loss: 1.076032, loss_ss: 0.817918, loss_d: 0.258115
0.3076 --- loss: 1.525178, loss_ss: 0.864878, loss_d: 0.660300
0.3460 --- loss: 1.326439, loss_ss: 0.717624, loss_d: 0.608815
0.3845 --- loss: 1.273498, loss_ss: 0.980022, loss_d: 0.293476
0.4229 --- loss: 0.834895, loss_ss: 0.778017, loss_d: 0.056878
0.4614 --- loss: 1.342638, loss_ss: 0.855971, loss_d: 0.486668
0.4998 --- loss: 1.169230, loss_ss: 0.733666, loss_d: 0.435564
0.5383 --- loss: 1.048493, loss_ss: 0.754581, loss_d: 0.293911
0.5767 --- loss: 1.248500, loss_ss: 1.102872, loss_d: 0.145629
0.6151 --- loss: 1.020751, loss_ss: 0.869934, loss_d: 0.150818
0.6536 --- loss: 0.935732, loss_ss: 0.723128, loss_d: 0.212604
0.6920 --- loss: 1.025199, loss_ss: 0.985966, loss_d: 0.039233
0.7305 --- loss: 0.687566, loss_ss: 0.645434, loss_d: 0.042132
0.7689 --- loss: 1.316407, loss_ss: 1.005265, loss_d: 0.311142
0.8074 --- loss: 1.041211, loss_ss: 0.790181, loss_d: 0.251030
0.8458 --- loss: 0.905559, loss_ss: 0.879775, loss_d: 0.025785
0.8843 --- loss: 1.207363, loss_ss: 0.977342, loss_d: 0.230021
0.9227 --- loss: 1.067786, loss_ss: 0.918055, loss_d: 0.149731
0.9612 --- loss: 1.065031, loss_ss: 1.018443, loss_d: 0.046588
0.9996 --- loss: 0.967258, loss_ss: 0.964230, loss_d: 0.003028
Epoch finished! Loss: 1.1219128982378885
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.395703, loss_ss: 0.903613, loss_d: 0.492091
0.0384 --- loss: 0.914127, loss_ss: 0.895699, loss_d: 0.018428
0.0769 --- loss: 1.311519, loss_ss: 0.971474, loss_d: 0.340045
0.1153 --- loss: 0.745731, loss_ss: 0.676826, loss_d: 0.068904
0.1538 --- loss: 0.913197, loss_ss: 0.852546, loss_d: 0.060651
0.1922 --- loss: 1.195934, loss_ss: 1.069051, loss_d: 0.126882
0.2307 --- loss: 1.073273, loss_ss: 0.953077, loss_d: 0.120197
0.2691 --- loss: 1.076884, loss_ss: 0.985571, loss_d: 0.091313
0.3076 --- loss: 0.925996, loss_ss: 0.845273, loss_d: 0.080723
0.3460 --- loss: 0.986236, loss_ss: 0.881114, loss_d: 0.105122
0.3845 --- loss: 0.940433, loss_ss: 0.748348, loss_d: 0.192085
0.4229 --- loss: 0.911245, loss_ss: 0.850563, loss_d: 0.060681
0.4614 --- loss: 0.913794, loss_ss: 0.668171, loss_d: 0.245623
0.4998 --- loss: 1.138921, loss_ss: 0.968591, loss_d: 0.170330
0.5383 --- loss: 1.029579, loss_ss: 0.834019, loss_d: 0.195560
0.5767 --- loss: 1.083456, loss_ss: 0.995539, loss_d: 0.087917
0.6151 --- loss: 1.283874, loss_ss: 1.166108, loss_d: 0.117765
0.6536 --- loss: 0.874610, loss_ss: 0.813896, loss_d: 0.060714
0.6920 --- loss: 1.109704, loss_ss: 1.025107, loss_d: 0.084597
0.7305 --- loss: 0.899186, loss_ss: 0.846437, loss_d: 0.052749
0.7689 --- loss: 1.028670, loss_ss: 0.652338, loss_d: 0.376333
0.8074 --- loss: 1.388596, loss_ss: 0.866511, loss_d: 0.522085
0.8458 --- loss: 1.126647, loss_ss: 0.753151, loss_d: 0.373496
0.8843 --- loss: 0.757227, loss_ss: 0.651588, loss_d: 0.105639
0.9227 --- loss: 1.140213, loss_ss: 1.088015, loss_d: 0.052198
0.9612 --- loss: 2.193664, loss_ss: 0.869259, loss_d: 1.324405
0.9996 --- loss: 1.763764, loss_ss: 1.757746, loss_d: 0.006018
Epoch finished! Loss: 1.0471139483726941
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.014594, loss_ss: 0.991168, loss_d: 0.023426
0.0384 --- loss: 1.535012, loss_ss: 1.469455, loss_d: 0.065557
0.0769 --- loss: 0.910173, loss_ss: 0.886348, loss_d: 0.023825
0.1153 --- loss: 0.890524, loss_ss: 0.830723, loss_d: 0.059801
0.1538 --- loss: 1.309157, loss_ss: 1.043238, loss_d: 0.265919
0.1922 --- loss: 0.902235, loss_ss: 0.820364, loss_d: 0.081871
0.2307 --- loss: 0.980508, loss_ss: 0.919442, loss_d: 0.061066
0.2691 --- loss: 0.908416, loss_ss: 0.808583, loss_d: 0.099833
0.3076 --- loss: 1.387631, loss_ss: 1.071597, loss_d: 0.316034
0.3460 --- loss: 1.208111, loss_ss: 1.033598, loss_d: 0.174513
0.3845 --- loss: 0.824459, loss_ss: 0.792632, loss_d: 0.031828
0.4229 --- loss: 1.021211, loss_ss: 0.994043, loss_d: 0.027168
0.4614 --- loss: 0.957979, loss_ss: 0.941119, loss_d: 0.016860
0.4998 --- loss: 0.938540, loss_ss: 0.889110, loss_d: 0.049430
0.5383 --- loss: 1.084936, loss_ss: 0.699299, loss_d: 0.385637
0.5767 --- loss: 1.221608, loss_ss: 1.078762, loss_d: 0.142847
0.6151 --- loss: 1.025931, loss_ss: 0.825852, loss_d: 0.200079
0.6536 --- loss: 0.890558, loss_ss: 0.839507, loss_d: 0.051051
0.6920 --- loss: 1.229990, loss_ss: 1.008515, loss_d: 0.221475
0.7305 --- loss: 0.926456, loss_ss: 0.835696, loss_d: 0.090760
0.7689 --- loss: 0.980987, loss_ss: 0.968505, loss_d: 0.012482
0.8074 --- loss: 1.235765, loss_ss: 1.129434, loss_d: 0.106331
0.8458 --- loss: 1.005409, loss_ss: 0.941826, loss_d: 0.063583
0.8843 --- loss: 1.346997, loss_ss: 1.111099, loss_d: 0.235899
0.9227 --- loss: 0.753623, loss_ss: 0.651827, loss_d: 0.101796
0.9612 --- loss: 0.838204, loss_ss: 0.823009, loss_d: 0.015195
0.9996 --- loss: 1.257104, loss_ss: 1.252246, loss_d: 0.004859
Epoch finished! Loss: 1.0178888405744846
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.841882, loss_ss: 0.824939, loss_d: 0.016943
0.0384 --- loss: 1.064048, loss_ss: 0.960133, loss_d: 0.103916
0.0769 --- loss: 0.924795, loss_ss: 0.890559, loss_d: 0.034236
0.1153 --- loss: 0.837753, loss_ss: 0.821099, loss_d: 0.016654
0.1538 --- loss: 1.188530, loss_ss: 0.960831, loss_d: 0.227699
0.1922 --- loss: 0.884764, loss_ss: 0.789869, loss_d: 0.094896
0.2307 --- loss: 0.942916, loss_ss: 0.925387, loss_d: 0.017529
0.2691 --- loss: 1.447724, loss_ss: 1.347176, loss_d: 0.100548
0.3076 --- loss: 1.078606, loss_ss: 0.832997, loss_d: 0.245609
0.3460 --- loss: 0.937705, loss_ss: 0.706340, loss_d: 0.231365
0.3845 --- loss: 0.934060, loss_ss: 0.909070, loss_d: 0.024989
0.4229 --- loss: 0.941108, loss_ss: 0.911249, loss_d: 0.029858
0.4614 --- loss: 0.972958, loss_ss: 0.923316, loss_d: 0.049642
0.4998 --- loss: 0.689404, loss_ss: 0.531437, loss_d: 0.157968
0.5383 --- loss: 1.300530, loss_ss: 0.862828, loss_d: 0.437702
0.5767 --- loss: 0.900472, loss_ss: 0.857256, loss_d: 0.043216
0.6151 --- loss: 0.929710, loss_ss: 0.901550, loss_d: 0.028160
0.6536 --- loss: 0.734540, loss_ss: 0.644949, loss_d: 0.089590
0.6920 --- loss: 0.654469, loss_ss: 0.643776, loss_d: 0.010694
0.7305 --- loss: 0.719007, loss_ss: 0.685036, loss_d: 0.033972
0.7689 --- loss: 0.732843, loss_ss: 0.727510, loss_d: 0.005333
0.8074 --- loss: 0.961436, loss_ss: 0.947331, loss_d: 0.014106
0.8458 --- loss: 1.057969, loss_ss: 1.041500, loss_d: 0.016470
0.8843 --- loss: 0.921128, loss_ss: 0.880340, loss_d: 0.040788
0.9227 --- loss: 0.874375, loss_ss: 0.812739, loss_d: 0.061636
0.9612 --- loss: 0.884044, loss_ss: 0.727884, loss_d: 0.156160
0.9996 --- loss: 1.181198, loss_ss: 1.176593, loss_d: 0.004605
Epoch finished! Loss: 0.9699018677839866
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.130081, loss_ss: 0.773177, loss_d: 0.356904
0.0384 --- loss: 0.851959, loss_ss: 0.743484, loss_d: 0.108474
0.0769 --- loss: 0.933203, loss_ss: 0.889184, loss_d: 0.044018
0.1153 --- loss: 0.897156, loss_ss: 0.757844, loss_d: 0.139312
0.1538 --- loss: 0.921299, loss_ss: 0.886928, loss_d: 0.034372
0.1922 --- loss: 0.919957, loss_ss: 0.911596, loss_d: 0.008361
0.2307 --- loss: 0.846817, loss_ss: 0.840236, loss_d: 0.006581
0.2691 --- loss: 0.803072, loss_ss: 0.679799, loss_d: 0.123273
0.3076 --- loss: 0.793276, loss_ss: 0.788172, loss_d: 0.005104
0.3460 --- loss: 1.334517, loss_ss: 0.912040, loss_d: 0.422476
0.3845 --- loss: 0.976583, loss_ss: 0.970252, loss_d: 0.006331
0.4229 --- loss: 0.748014, loss_ss: 0.728899, loss_d: 0.019115
0.4614 --- loss: 0.788902, loss_ss: 0.736794, loss_d: 0.052108
0.4998 --- loss: 0.585911, loss_ss: 0.544314, loss_d: 0.041597
0.5383 --- loss: 0.654194, loss_ss: 0.636565, loss_d: 0.017629
0.5767 --- loss: 0.779797, loss_ss: 0.720003, loss_d: 0.059794
0.6151 --- loss: 1.018067, loss_ss: 0.696518, loss_d: 0.321549
0.6536 --- loss: 1.382721, loss_ss: 0.704704, loss_d: 0.678017
0.6920 --- loss: 1.116020, loss_ss: 1.088190, loss_d: 0.027831
0.7305 --- loss: 0.839577, loss_ss: 0.778018, loss_d: 0.061559
0.7689 --- loss: 0.780153, loss_ss: 0.713490, loss_d: 0.066664
0.8074 --- loss: 0.693933, loss_ss: 0.622195, loss_d: 0.071738
0.8458 --- loss: 1.476332, loss_ss: 1.363847, loss_d: 0.112485
0.8843 --- loss: 1.024253, loss_ss: 0.874480, loss_d: 0.149773
0.9227 --- loss: 0.712773, loss_ss: 0.665533, loss_d: 0.047240
0.9612 --- loss: 1.486628, loss_ss: 1.329859, loss_d: 0.156768
0.9996 --- loss: 1.011627, loss_ss: 1.010360, loss_d: 0.001267
Epoch finished! Loss: 0.9709733715424171
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7171171171171171
             precision    recall  f1-score   support

        0.0       0.24      0.83      0.38        23
        1.0       0.38      0.03      0.05       182
        2.0       0.68      0.96      0.80       379
        3.0       1.00      0.77      0.87       203
        4.0       0.77      0.78      0.77       323

avg / total       0.71      0.72      0.67      1110
 


====== chp012-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.32  82.61   94.57   24.36     37.62
1  83.33   2.75   99.14   38.46      5.13
2  83.33  96.04   76.74   68.16     79.74
3  95.77  76.85  100.00  100.00     86.91
4  86.67  78.02   90.22   76.60     77.30
Total accuracy: 71.71%
Average sen: 67.25%
Average spec: 92.13%
Macro f1-score: 57.34%
Diagnosis acc on 15mins: 1.0
[0.99282962 0.99436355 0.91034245 0.96420515 0.6162684  0.91221976
 0.94891608 0.99048412 0.97146094 0.98419803 0.95989829 0.99817502
 0.98638409 0.99041009 0.98831624 0.99562716 0.99365294 0.99801779
 0.96180582 0.98516577 0.99275666 0.99697196 0.97449243 0.99210817
 0.99727601 0.99784565 0.95561135 0.9847365  0.98973364 0.98332167
 0.98162085 0.98099053 0.99191135 0.99202818 0.98574406 0.99586654
 0.97493714]
pred: 0.9705592973812206, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.445563, loss_ss: 1.749377, loss_d: 0.696186
0.0384 --- loss: 2.328142, loss_ss: 1.762588, loss_d: 0.565554
0.0768 --- loss: 2.124010, loss_ss: 1.554560, loss_d: 0.569450
0.1152 --- loss: 2.109403, loss_ss: 1.671540, loss_d: 0.437862
0.1536 --- loss: 2.289070, loss_ss: 1.529298, loss_d: 0.759772
0.1919 --- loss: 2.202244, loss_ss: 1.640418, loss_d: 0.561825
0.2303 --- loss: 2.234409, loss_ss: 1.513851, loss_d: 0.720558
0.2687 --- loss: 2.026966, loss_ss: 1.570054, loss_d: 0.456912
0.3071 --- loss: 1.802204, loss_ss: 1.389691, loss_d: 0.412513
0.3455 --- loss: 1.797971, loss_ss: 1.327171, loss_d: 0.470800
0.3839 --- loss: 2.372423, loss_ss: 1.472224, loss_d: 0.900199
0.4223 --- loss: 2.065998, loss_ss: 1.453130, loss_d: 0.612868
0.4607 --- loss: 1.846501, loss_ss: 1.291569, loss_d: 0.554932
0.4990 --- loss: 2.351695, loss_ss: 1.572739, loss_d: 0.778955
0.5374 --- loss: 1.977007, loss_ss: 1.459077, loss_d: 0.517930
0.5758 --- loss: 1.731794, loss_ss: 1.274945, loss_d: 0.456849
0.6142 --- loss: 1.982721, loss_ss: 1.368099, loss_d: 0.614622
0.6526 --- loss: 1.837660, loss_ss: 1.482790, loss_d: 0.354870
0.6910 --- loss: 1.867572, loss_ss: 1.320908, loss_d: 0.546665
0.7294 --- loss: 1.770472, loss_ss: 1.335590, loss_d: 0.434882
0.7678 --- loss: 1.741253, loss_ss: 1.178510, loss_d: 0.562743
0.8061 --- loss: 2.434240, loss_ss: 1.217291, loss_d: 1.216949
0.8445 --- loss: 1.666613, loss_ss: 1.346808, loss_d: 0.319805
0.8829 --- loss: 1.583184, loss_ss: 1.302620, loss_d: 0.280564
0.9213 --- loss: 1.359852, loss_ss: 1.131175, loss_d: 0.228676
0.9597 --- loss: 1.838934, loss_ss: 1.212699, loss_d: 0.626235
0.9981 --- loss: 1.946560, loss_ss: 1.486852, loss_d: 0.459707
Epoch finished! Loss: 1.9987292954554925
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.930672, loss_ss: 1.256543, loss_d: 0.674129
0.0384 --- loss: 1.549336, loss_ss: 1.056026, loss_d: 0.493310
0.0768 --- loss: 1.262638, loss_ss: 1.099596, loss_d: 0.163042
0.1152 --- loss: 1.368987, loss_ss: 1.170244, loss_d: 0.198744
0.1536 --- loss: 1.835260, loss_ss: 1.286283, loss_d: 0.548977
0.1919 --- loss: 1.545361, loss_ss: 1.298656, loss_d: 0.246705
0.2303 --- loss: 1.713190, loss_ss: 1.377516, loss_d: 0.335674
0.2687 --- loss: 1.920403, loss_ss: 1.618527, loss_d: 0.301876
0.3071 --- loss: 1.854436, loss_ss: 1.235091, loss_d: 0.619345
0.3455 --- loss: 1.597476, loss_ss: 1.139084, loss_d: 0.458391
0.3839 --- loss: 1.167885, loss_ss: 1.008272, loss_d: 0.159613
0.4223 --- loss: 1.725513, loss_ss: 1.308820, loss_d: 0.416693
0.4607 --- loss: 1.563659, loss_ss: 1.375510, loss_d: 0.188149
0.4990 --- loss: 1.436805, loss_ss: 1.042413, loss_d: 0.394392
0.5374 --- loss: 1.556940, loss_ss: 1.009346, loss_d: 0.547594
0.5758 --- loss: 1.671053, loss_ss: 1.327327, loss_d: 0.343726
0.6142 --- loss: 1.553147, loss_ss: 1.320815, loss_d: 0.232332
0.6526 --- loss: 1.349290, loss_ss: 1.074595, loss_d: 0.274695
0.6910 --- loss: 1.173203, loss_ss: 0.979404, loss_d: 0.193799
0.7294 --- loss: 1.256178, loss_ss: 1.059073, loss_d: 0.197105
0.7678 --- loss: 1.314161, loss_ss: 1.101792, loss_d: 0.212369
0.8061 --- loss: 1.216719, loss_ss: 1.070760, loss_d: 0.145960
0.8445 --- loss: 1.160894, loss_ss: 1.083723, loss_d: 0.077170
0.8829 --- loss: 1.617350, loss_ss: 1.007807, loss_d: 0.609543
0.9213 --- loss: 1.109153, loss_ss: 0.961156, loss_d: 0.147997
0.9597 --- loss: 1.370586, loss_ss: 1.201451, loss_d: 0.169135
0.9981 --- loss: 1.504281, loss_ss: 1.103999, loss_d: 0.400282
Epoch finished! Loss: 1.5354331300808832
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.316030, loss_ss: 1.047963, loss_d: 0.268066
0.0384 --- loss: 1.384017, loss_ss: 1.228924, loss_d: 0.155093
0.0768 --- loss: 1.430936, loss_ss: 1.142606, loss_d: 0.288330
0.1152 --- loss: 1.080030, loss_ss: 0.967004, loss_d: 0.113026
0.1536 --- loss: 1.408322, loss_ss: 1.324250, loss_d: 0.084072
0.1919 --- loss: 2.151403, loss_ss: 1.226359, loss_d: 0.925044
0.2303 --- loss: 2.033962, loss_ss: 1.189667, loss_d: 0.844294
0.2687 --- loss: 1.839214, loss_ss: 1.167868, loss_d: 0.671346
0.3071 --- loss: 1.178633, loss_ss: 1.012693, loss_d: 0.165940
0.3455 --- loss: 1.130124, loss_ss: 0.887581, loss_d: 0.242543
0.3839 --- loss: 1.313072, loss_ss: 1.226552, loss_d: 0.086520
0.4223 --- loss: 1.341141, loss_ss: 1.046986, loss_d: 0.294155
0.4607 --- loss: 1.220004, loss_ss: 0.910421, loss_d: 0.309583
0.4990 --- loss: 1.421068, loss_ss: 1.165872, loss_d: 0.255196
0.5374 --- loss: 1.161247, loss_ss: 0.955956, loss_d: 0.205291
0.5758 --- loss: 1.146480, loss_ss: 0.885134, loss_d: 0.261346
0.6142 --- loss: 1.229953, loss_ss: 1.158139, loss_d: 0.071814
0.6526 --- loss: 1.272759, loss_ss: 1.043780, loss_d: 0.228978
0.6910 --- loss: 1.457641, loss_ss: 1.092770, loss_d: 0.364870
0.7294 --- loss: 1.222196, loss_ss: 0.931345, loss_d: 0.290851
0.7678 --- loss: 1.034113, loss_ss: 0.790536, loss_d: 0.243577
0.8061 --- loss: 1.083435, loss_ss: 0.973577, loss_d: 0.109858
0.8445 --- loss: 0.988121, loss_ss: 0.835642, loss_d: 0.152479
0.8829 --- loss: 1.418945, loss_ss: 0.914422, loss_d: 0.504523
0.9213 --- loss: 1.352991, loss_ss: 0.868801, loss_d: 0.484191
0.9597 --- loss: 1.753611, loss_ss: 0.961088, loss_d: 0.792523
0.9981 --- loss: 1.270707, loss_ss: 1.168992, loss_d: 0.101716
Epoch finished! Loss: 1.3459700740300693
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.562976, loss_ss: 0.822440, loss_d: 0.740536
0.0384 --- loss: 0.898601, loss_ss: 0.793441, loss_d: 0.105160
0.0768 --- loss: 1.049468, loss_ss: 0.781927, loss_d: 0.267541
0.1152 --- loss: 1.163336, loss_ss: 0.969727, loss_d: 0.193609
0.1536 --- loss: 1.245703, loss_ss: 0.978158, loss_d: 0.267545
0.1919 --- loss: 0.937414, loss_ss: 0.803839, loss_d: 0.133576
0.2303 --- loss: 1.295531, loss_ss: 0.942095, loss_d: 0.353436
0.2687 --- loss: 1.439373, loss_ss: 0.960331, loss_d: 0.479042
0.3071 --- loss: 1.119521, loss_ss: 0.852305, loss_d: 0.267216
0.3455 --- loss: 1.243541, loss_ss: 1.032469, loss_d: 0.211072
0.3839 --- loss: 1.102877, loss_ss: 0.985796, loss_d: 0.117081
0.4223 --- loss: 1.227644, loss_ss: 0.728158, loss_d: 0.499486
0.4607 --- loss: 1.114244, loss_ss: 0.985410, loss_d: 0.128834
0.4990 --- loss: 1.043168, loss_ss: 0.770696, loss_d: 0.272472
0.5374 --- loss: 1.058156, loss_ss: 0.807822, loss_d: 0.250334
0.5758 --- loss: 1.273165, loss_ss: 1.186658, loss_d: 0.086506
0.6142 --- loss: 1.009653, loss_ss: 0.849225, loss_d: 0.160428
0.6526 --- loss: 0.907097, loss_ss: 0.664550, loss_d: 0.242547
0.6910 --- loss: 0.816856, loss_ss: 0.790515, loss_d: 0.026341
0.7294 --- loss: 1.105338, loss_ss: 0.815610, loss_d: 0.289727
0.7678 --- loss: 1.132728, loss_ss: 0.878561, loss_d: 0.254167
0.8061 --- loss: 0.890513, loss_ss: 0.828586, loss_d: 0.061927
0.8445 --- loss: 0.968353, loss_ss: 0.888636, loss_d: 0.079717
0.8829 --- loss: 1.297310, loss_ss: 1.097882, loss_d: 0.199428
0.9213 --- loss: 1.393351, loss_ss: 1.070459, loss_d: 0.322893
0.9597 --- loss: 1.162306, loss_ss: 0.977101, loss_d: 0.185206
0.9981 --- loss: 1.758924, loss_ss: 0.681082, loss_d: 1.077842
Epoch finished! Loss: 1.2135477474102607
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.021214, loss_ss: 0.685979, loss_d: 0.335236
0.0384 --- loss: 1.349741, loss_ss: 0.955300, loss_d: 0.394441
0.0768 --- loss: 1.100051, loss_ss: 0.900576, loss_d: 0.199475
0.1152 --- loss: 1.621365, loss_ss: 1.516516, loss_d: 0.104849
0.1536 --- loss: 1.672933, loss_ss: 1.213587, loss_d: 0.459346
0.1919 --- loss: 1.233629, loss_ss: 0.891224, loss_d: 0.342406
0.2303 --- loss: 1.154296, loss_ss: 0.799165, loss_d: 0.355131
0.2687 --- loss: 1.126506, loss_ss: 0.959826, loss_d: 0.166680
0.3071 --- loss: 1.272997, loss_ss: 1.053108, loss_d: 0.219890
0.3455 --- loss: 1.279559, loss_ss: 1.072939, loss_d: 0.206620
0.3839 --- loss: 1.178941, loss_ss: 1.126724, loss_d: 0.052217
0.4223 --- loss: 1.003483, loss_ss: 0.822282, loss_d: 0.181200
0.4607 --- loss: 0.953204, loss_ss: 0.909763, loss_d: 0.043441
0.4990 --- loss: 1.191104, loss_ss: 0.823921, loss_d: 0.367183
0.5374 --- loss: 1.487620, loss_ss: 0.784706, loss_d: 0.702914
0.5758 --- loss: 1.564684, loss_ss: 1.200649, loss_d: 0.364035
0.6142 --- loss: 0.847974, loss_ss: 0.774079, loss_d: 0.073895
0.6526 --- loss: 1.246798, loss_ss: 1.081738, loss_d: 0.165059
0.6910 --- loss: 0.974884, loss_ss: 0.777940, loss_d: 0.196944
0.7294 --- loss: 1.143869, loss_ss: 0.858720, loss_d: 0.285150
0.7678 --- loss: 1.200765, loss_ss: 0.837859, loss_d: 0.362906
0.8061 --- loss: 0.972404, loss_ss: 0.749183, loss_d: 0.223221
0.8445 --- loss: 1.319582, loss_ss: 1.064211, loss_d: 0.255371
0.8829 --- loss: 1.252839, loss_ss: 0.804004, loss_d: 0.448835
0.9213 --- loss: 1.123096, loss_ss: 0.969336, loss_d: 0.153760
0.9597 --- loss: 0.869193, loss_ss: 0.764051, loss_d: 0.105141
0.9981 --- loss: 2.311544, loss_ss: 1.237035, loss_d: 1.074509
Epoch finished! Loss: 1.1653002312550178
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.927186, loss_ss: 0.674030, loss_d: 0.253155
0.0384 --- loss: 1.218773, loss_ss: 0.801250, loss_d: 0.417523
0.0768 --- loss: 0.705309, loss_ss: 0.507470, loss_d: 0.197839
0.1152 --- loss: 1.374953, loss_ss: 0.985823, loss_d: 0.389129
0.1536 --- loss: 1.101157, loss_ss: 0.953424, loss_d: 0.147734
0.1919 --- loss: 1.057783, loss_ss: 0.678384, loss_d: 0.379399
0.2303 --- loss: 0.795264, loss_ss: 0.753527, loss_d: 0.041737
0.2687 --- loss: 1.036628, loss_ss: 0.914408, loss_d: 0.122221
0.3071 --- loss: 0.763158, loss_ss: 0.734885, loss_d: 0.028272
0.3455 --- loss: 0.962446, loss_ss: 0.928313, loss_d: 0.034133
0.3839 --- loss: 1.008185, loss_ss: 0.844987, loss_d: 0.163197
0.4223 --- loss: 1.026769, loss_ss: 0.812161, loss_d: 0.214608
0.4607 --- loss: 1.315862, loss_ss: 1.128507, loss_d: 0.187354
0.4990 --- loss: 1.442519, loss_ss: 0.935989, loss_d: 0.506530
0.5374 --- loss: 1.168572, loss_ss: 0.865933, loss_d: 0.302639
0.5758 --- loss: 0.986767, loss_ss: 0.819380, loss_d: 0.167387
0.6142 --- loss: 0.976185, loss_ss: 0.804089, loss_d: 0.172096
0.6526 --- loss: 0.951564, loss_ss: 0.869031, loss_d: 0.082533
0.6910 --- loss: 1.111612, loss_ss: 1.068543, loss_d: 0.043068
0.7294 --- loss: 0.855162, loss_ss: 0.748335, loss_d: 0.106828
0.7678 --- loss: 0.889109, loss_ss: 0.873298, loss_d: 0.015811
0.8061 --- loss: 0.978365, loss_ss: 0.704251, loss_d: 0.274115
0.8445 --- loss: 1.192438, loss_ss: 0.897896, loss_d: 0.294542
0.8829 --- loss: 0.862559, loss_ss: 0.717593, loss_d: 0.144967
0.9213 --- loss: 1.280189, loss_ss: 1.165905, loss_d: 0.114284
0.9597 --- loss: 1.181452, loss_ss: 1.038007, loss_d: 0.143446
0.9981 --- loss: 2.957174, loss_ss: 1.156261, loss_d: 1.800914
Epoch finished! Loss: 1.102209922671318
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.062352, loss_ss: 0.796722, loss_d: 0.265630
0.0384 --- loss: 0.885685, loss_ss: 0.795912, loss_d: 0.089773
0.0768 --- loss: 0.953060, loss_ss: 0.905425, loss_d: 0.047635
0.1152 --- loss: 1.385297, loss_ss: 1.230324, loss_d: 0.154973
0.1536 --- loss: 1.087895, loss_ss: 0.969941, loss_d: 0.117953
0.1919 --- loss: 0.681497, loss_ss: 0.626221, loss_d: 0.055275
0.2303 --- loss: 0.977791, loss_ss: 0.957588, loss_d: 0.020203
0.2687 --- loss: 0.864213, loss_ss: 0.829541, loss_d: 0.034672
0.3071 --- loss: 0.797635, loss_ss: 0.724846, loss_d: 0.072789
0.3455 --- loss: 1.210823, loss_ss: 1.134276, loss_d: 0.076547
0.3839 --- loss: 0.788711, loss_ss: 0.754408, loss_d: 0.034303
0.4223 --- loss: 1.554121, loss_ss: 0.798148, loss_d: 0.755973
0.4607 --- loss: 1.139416, loss_ss: 0.840629, loss_d: 0.298786
0.4990 --- loss: 1.076623, loss_ss: 0.865927, loss_d: 0.210696
0.5374 --- loss: 0.839284, loss_ss: 0.775290, loss_d: 0.063995
0.5758 --- loss: 0.975995, loss_ss: 0.754316, loss_d: 0.221678
0.6142 --- loss: 1.329191, loss_ss: 0.766223, loss_d: 0.562968
0.6526 --- loss: 1.089997, loss_ss: 0.742004, loss_d: 0.347993
0.6910 --- loss: 0.926908, loss_ss: 0.896721, loss_d: 0.030187
0.7294 --- loss: 0.989739, loss_ss: 0.960913, loss_d: 0.028825
0.7678 --- loss: 1.279421, loss_ss: 1.131629, loss_d: 0.147792
0.8061 --- loss: 1.174494, loss_ss: 0.874048, loss_d: 0.300446
0.8445 --- loss: 1.377168, loss_ss: 1.108984, loss_d: 0.268184
0.8829 --- loss: 0.881670, loss_ss: 0.833464, loss_d: 0.048206
0.9213 --- loss: 1.103163, loss_ss: 1.034079, loss_d: 0.069084
0.9597 --- loss: 0.906018, loss_ss: 0.856006, loss_d: 0.050013
0.9981 --- loss: 0.827162, loss_ss: 0.674224, loss_d: 0.152938
Epoch finished! Loss: 1.0252725222936043
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.311251, loss_ss: 1.023482, loss_d: 0.287769
0.0384 --- loss: 0.824595, loss_ss: 0.660752, loss_d: 0.163844
0.0768 --- loss: 1.061764, loss_ss: 0.786012, loss_d: 0.275752
0.1152 --- loss: 1.109833, loss_ss: 0.902995, loss_d: 0.206838
0.1536 --- loss: 1.047757, loss_ss: 0.833686, loss_d: 0.214071
0.1919 --- loss: 0.727726, loss_ss: 0.644634, loss_d: 0.083092
0.2303 --- loss: 0.931940, loss_ss: 0.885094, loss_d: 0.046846
0.2687 --- loss: 0.684236, loss_ss: 0.650329, loss_d: 0.033907
0.3071 --- loss: 0.955546, loss_ss: 0.918804, loss_d: 0.036742
0.3455 --- loss: 1.134631, loss_ss: 1.103580, loss_d: 0.031051
0.3839 --- loss: 0.736307, loss_ss: 0.720793, loss_d: 0.015515
0.4223 --- loss: 0.710156, loss_ss: 0.633987, loss_d: 0.076170
0.4607 --- loss: 0.778164, loss_ss: 0.705991, loss_d: 0.072173
0.4990 --- loss: 2.713502, loss_ss: 0.715166, loss_d: 1.998336
0.5374 --- loss: 1.144717, loss_ss: 1.004160, loss_d: 0.140557
0.5758 --- loss: 0.881772, loss_ss: 0.863081, loss_d: 0.018691
0.6142 --- loss: 0.900523, loss_ss: 0.499542, loss_d: 0.400981
0.6526 --- loss: 0.748724, loss_ss: 0.663297, loss_d: 0.085427
0.6910 --- loss: 0.785832, loss_ss: 0.691696, loss_d: 0.094136
0.7294 --- loss: 1.129714, loss_ss: 1.025595, loss_d: 0.104120
0.7678 --- loss: 1.112383, loss_ss: 1.099788, loss_d: 0.012595
0.8061 --- loss: 0.815612, loss_ss: 0.783513, loss_d: 0.032099
0.8445 --- loss: 1.083394, loss_ss: 1.002167, loss_d: 0.081228
0.8829 --- loss: 1.267853, loss_ss: 0.732684, loss_d: 0.535170
0.9213 --- loss: 1.009309, loss_ss: 0.863979, loss_d: 0.145330
0.9597 --- loss: 0.770936, loss_ss: 0.727045, loss_d: 0.043891
0.9981 --- loss: 0.877937, loss_ss: 0.854844, loss_d: 0.023093
Epoch finished! Loss: 1.0024821755977777
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.741887, loss_ss: 0.711652, loss_d: 0.030235
0.0384 --- loss: 0.814390, loss_ss: 0.805026, loss_d: 0.009364
0.0768 --- loss: 0.850255, loss_ss: 0.700191, loss_d: 0.150065
0.1152 --- loss: 0.843463, loss_ss: 0.611847, loss_d: 0.231617
0.1536 --- loss: 1.216360, loss_ss: 0.721511, loss_d: 0.494849
0.1919 --- loss: 1.093945, loss_ss: 0.790389, loss_d: 0.303556
0.2303 --- loss: 1.124828, loss_ss: 1.039769, loss_d: 0.085059
0.2687 --- loss: 0.860547, loss_ss: 0.830359, loss_d: 0.030188
0.3071 --- loss: 1.273485, loss_ss: 0.663926, loss_d: 0.609559
0.3455 --- loss: 1.131318, loss_ss: 1.032789, loss_d: 0.098530
0.3839 --- loss: 1.115521, loss_ss: 1.105929, loss_d: 0.009593
0.4223 --- loss: 0.955529, loss_ss: 0.901211, loss_d: 0.054318
0.4607 --- loss: 0.682816, loss_ss: 0.665269, loss_d: 0.017547
0.4990 --- loss: 0.758805, loss_ss: 0.697366, loss_d: 0.061439
0.5374 --- loss: 0.955641, loss_ss: 0.828765, loss_d: 0.126876
0.5758 --- loss: 0.959737, loss_ss: 0.828839, loss_d: 0.130898
0.6142 --- loss: 1.177233, loss_ss: 0.894403, loss_d: 0.282829
0.6526 --- loss: 0.847710, loss_ss: 0.743458, loss_d: 0.104252
0.6910 --- loss: 0.829073, loss_ss: 0.766827, loss_d: 0.062245
0.7294 --- loss: 0.970087, loss_ss: 0.561780, loss_d: 0.408308
0.7678 --- loss: 0.866637, loss_ss: 0.770383, loss_d: 0.096253
0.8061 --- loss: 0.888504, loss_ss: 0.821856, loss_d: 0.066648
0.8445 --- loss: 0.755011, loss_ss: 0.711744, loss_d: 0.043267
0.8829 --- loss: 0.976675, loss_ss: 0.957736, loss_d: 0.018939
0.9213 --- loss: 0.932777, loss_ss: 0.898145, loss_d: 0.034633
0.9597 --- loss: 1.161376, loss_ss: 1.152752, loss_d: 0.008624
0.9981 --- loss: 1.152426, loss_ss: 1.146170, loss_d: 0.006256
Epoch finished! Loss: 0.9710569372543922
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.726757, loss_ss: 0.694204, loss_d: 0.032553
0.0384 --- loss: 0.778784, loss_ss: 0.756357, loss_d: 0.022427
0.0768 --- loss: 0.838917, loss_ss: 0.817557, loss_d: 0.021361
0.1152 --- loss: 0.782485, loss_ss: 0.747738, loss_d: 0.034746
0.1536 --- loss: 0.699987, loss_ss: 0.668042, loss_d: 0.031945
0.1919 --- loss: 1.051924, loss_ss: 0.659554, loss_d: 0.392369
0.2303 --- loss: 0.835998, loss_ss: 0.692507, loss_d: 0.143491
0.2687 --- loss: 0.888314, loss_ss: 0.735772, loss_d: 0.152542
0.3071 --- loss: 0.896596, loss_ss: 0.691661, loss_d: 0.204935
0.3455 --- loss: 1.420286, loss_ss: 1.378712, loss_d: 0.041574
0.3839 --- loss: 0.660926, loss_ss: 0.585616, loss_d: 0.075310
0.4223 --- loss: 0.657944, loss_ss: 0.649360, loss_d: 0.008584
0.4607 --- loss: 1.208214, loss_ss: 1.049943, loss_d: 0.158271
0.4990 --- loss: 1.351236, loss_ss: 1.251059, loss_d: 0.100177
0.5374 --- loss: 1.173192, loss_ss: 0.801786, loss_d: 0.371406
0.5758 --- loss: 1.196494, loss_ss: 1.165647, loss_d: 0.030846
0.6142 --- loss: 1.078357, loss_ss: 0.907533, loss_d: 0.170824
0.6526 --- loss: 1.111996, loss_ss: 1.077023, loss_d: 0.034974
0.6910 --- loss: 1.109884, loss_ss: 0.857029, loss_d: 0.252855
0.7294 --- loss: 0.715936, loss_ss: 0.653454, loss_d: 0.062482
0.7678 --- loss: 0.715234, loss_ss: 0.699884, loss_d: 0.015350
0.8061 --- loss: 0.722429, loss_ss: 0.620796, loss_d: 0.101633
0.8445 --- loss: 0.775234, loss_ss: 0.757973, loss_d: 0.017261
0.8829 --- loss: 1.414272, loss_ss: 0.966544, loss_d: 0.447728
0.9213 --- loss: 1.303532, loss_ss: 1.170722, loss_d: 0.132809
0.9597 --- loss: 0.873548, loss_ss: 0.847802, loss_d: 0.025747
0.9981 --- loss: 1.333215, loss_ss: 0.768134, loss_d: 0.565081
Epoch finished! Loss: 0.9441787048028065
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6767676767676768
             precision    recall  f1-score   support

        0.0       0.28      0.97      0.43        33
        1.0       0.75      0.11      0.19       142
        2.0       0.67      0.94      0.78       433
        3.0       0.91      0.71      0.80       189
        4.0       0.82      0.44      0.57       193

avg / total       0.74      0.68      0.65       990
 


====== chp013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.52  96.97   91.33  27.83     43.24
1  86.67  10.56   99.41  75.00     18.52
2  77.07  93.53   64.27  67.05     78.11
3  93.03  70.90   98.25  90.54     79.53
4  87.07  43.52   97.62  81.55     56.76
Total accuracy: 67.68%
Average sen: 63.10%
Average spec: 90.18%
Macro f1-score: 55.23%
Diagnosis acc on 15mins: 1.0
[0.99806112 0.7575112  0.76528144 0.98095381 0.95357341 0.98398417
 0.98116416 0.99669254 0.98916185 0.99138629 0.99732518 0.99671316
 0.98481941 0.9311614  0.91115415 0.97568899 0.98375905 0.99457127
 0.99906737 0.98919743 0.99714679 0.99532074 0.94536775 0.99958068
 0.9981817  0.99673718 0.98150247 0.94379109 0.61614305 0.96157676
 0.99784052 0.98667407 0.99688077]
pred: 0.9569082115635728, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.362744, loss_ss: 1.727794, loss_d: 0.634949
0.0384 --- loss: 2.294547, loss_ss: 1.658894, loss_d: 0.635653
0.0768 --- loss: 2.124335, loss_ss: 1.541915, loss_d: 0.582420
0.1152 --- loss: 2.203652, loss_ss: 1.514047, loss_d: 0.689605
0.1536 --- loss: 1.985231, loss_ss: 1.514635, loss_d: 0.470596
0.1919 --- loss: 2.184473, loss_ss: 1.615623, loss_d: 0.568850
0.2303 --- loss: 1.981832, loss_ss: 1.439305, loss_d: 0.542527
0.2687 --- loss: 2.000681, loss_ss: 1.419521, loss_d: 0.581161
0.3071 --- loss: 1.894701, loss_ss: 1.389981, loss_d: 0.504720
0.3455 --- loss: 2.092912, loss_ss: 1.372837, loss_d: 0.720075
0.3839 --- loss: 1.888435, loss_ss: 1.339712, loss_d: 0.548723
0.4223 --- loss: 2.218703, loss_ss: 1.518590, loss_d: 0.700112
0.4607 --- loss: 1.713110, loss_ss: 1.294934, loss_d: 0.418176
0.4990 --- loss: 1.521705, loss_ss: 1.179820, loss_d: 0.341885
0.5374 --- loss: 1.891082, loss_ss: 1.251450, loss_d: 0.639632
0.5758 --- loss: 2.069816, loss_ss: 1.375260, loss_d: 0.694556
0.6142 --- loss: 1.637451, loss_ss: 1.286112, loss_d: 0.351339
0.6526 --- loss: 2.028618, loss_ss: 1.252920, loss_d: 0.775698
0.6910 --- loss: 1.680038, loss_ss: 1.323320, loss_d: 0.356719
0.7294 --- loss: 1.534988, loss_ss: 1.213644, loss_d: 0.321344
0.7678 --- loss: 1.655091, loss_ss: 1.215559, loss_d: 0.439532
0.8061 --- loss: 1.892236, loss_ss: 1.181817, loss_d: 0.710418
0.8445 --- loss: 1.440682, loss_ss: 1.072520, loss_d: 0.368162
0.8829 --- loss: 1.640010, loss_ss: 1.240336, loss_d: 0.399674
0.9213 --- loss: 1.487099, loss_ss: 1.181422, loss_d: 0.305677
0.9597 --- loss: 1.735906, loss_ss: 1.387315, loss_d: 0.348592
0.9981 --- loss: 1.479395, loss_ss: 1.089614, loss_d: 0.389781
Epoch finished! Loss: 1.906256504700734
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.383004, loss_ss: 1.119254, loss_d: 0.263750
0.0384 --- loss: 2.231749, loss_ss: 1.104066, loss_d: 1.127683
0.0768 --- loss: 1.652513, loss_ss: 0.975173, loss_d: 0.677340
0.1152 --- loss: 1.353509, loss_ss: 1.114261, loss_d: 0.239248
0.1536 --- loss: 1.327264, loss_ss: 1.153141, loss_d: 0.174122
0.1919 --- loss: 1.393179, loss_ss: 0.975812, loss_d: 0.417367
0.2303 --- loss: 1.254044, loss_ss: 1.020063, loss_d: 0.233981
0.2687 --- loss: 1.257386, loss_ss: 0.931980, loss_d: 0.325406
0.3071 --- loss: 1.322323, loss_ss: 1.082964, loss_d: 0.239360
0.3455 --- loss: 1.404898, loss_ss: 1.120476, loss_d: 0.284422
0.3839 --- loss: 1.359411, loss_ss: 1.099158, loss_d: 0.260254
0.4223 --- loss: 1.210886, loss_ss: 0.961011, loss_d: 0.249876
0.4607 --- loss: 1.253344, loss_ss: 1.119672, loss_d: 0.133672
0.4990 --- loss: 1.274894, loss_ss: 1.035187, loss_d: 0.239707
0.5374 --- loss: 1.509377, loss_ss: 1.227048, loss_d: 0.282330
0.5758 --- loss: 1.046474, loss_ss: 0.864202, loss_d: 0.182271
0.6142 --- loss: 1.143214, loss_ss: 1.001815, loss_d: 0.141399
0.6526 --- loss: 1.149220, loss_ss: 0.908805, loss_d: 0.240415
0.6910 --- loss: 1.509829, loss_ss: 1.150750, loss_d: 0.359079
0.7294 --- loss: 1.295272, loss_ss: 1.160602, loss_d: 0.134670
0.7678 --- loss: 1.472649, loss_ss: 1.161975, loss_d: 0.310673
0.8061 --- loss: 1.208209, loss_ss: 0.962695, loss_d: 0.245514
0.8445 --- loss: 1.267459, loss_ss: 0.914950, loss_d: 0.352509
0.8829 --- loss: 1.763176, loss_ss: 1.051364, loss_d: 0.711812
0.9213 --- loss: 1.162367, loss_ss: 0.977904, loss_d: 0.184463
0.9597 --- loss: 1.471759, loss_ss: 1.073639, loss_d: 0.398120
0.9981 --- loss: 1.430211, loss_ss: 1.265330, loss_d: 0.164881
Epoch finished! Loss: 1.4250310808420181
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.861433, loss_ss: 0.910298, loss_d: 0.951135
0.0384 --- loss: 1.215591, loss_ss: 1.027038, loss_d: 0.188553
0.0768 --- loss: 1.247954, loss_ss: 1.059712, loss_d: 0.188242
0.1152 --- loss: 1.549838, loss_ss: 1.173169, loss_d: 0.376669
0.1536 --- loss: 1.566117, loss_ss: 1.321401, loss_d: 0.244716
0.1919 --- loss: 1.094737, loss_ss: 0.863362, loss_d: 0.231375
0.2303 --- loss: 1.220482, loss_ss: 1.036024, loss_d: 0.184458
0.2687 --- loss: 1.389121, loss_ss: 1.002128, loss_d: 0.386993
0.3071 --- loss: 1.171110, loss_ss: 1.013746, loss_d: 0.157363
0.3455 --- loss: 1.211939, loss_ss: 1.124711, loss_d: 0.087227
0.3839 --- loss: 1.303066, loss_ss: 0.890311, loss_d: 0.412755
0.4223 --- loss: 1.767717, loss_ss: 0.842831, loss_d: 0.924886
0.4607 --- loss: 1.050271, loss_ss: 0.734547, loss_d: 0.315724
0.4990 --- loss: 1.295160, loss_ss: 1.076422, loss_d: 0.218738
0.5374 --- loss: 1.141283, loss_ss: 1.008472, loss_d: 0.132811
0.5758 --- loss: 1.053440, loss_ss: 0.774396, loss_d: 0.279044
0.6142 --- loss: 1.480285, loss_ss: 1.195747, loss_d: 0.284538
0.6526 --- loss: 0.986991, loss_ss: 0.819054, loss_d: 0.167937
0.6910 --- loss: 1.200912, loss_ss: 0.814812, loss_d: 0.386100
0.7294 --- loss: 0.955312, loss_ss: 0.862678, loss_d: 0.092634
0.7678 --- loss: 1.147750, loss_ss: 1.032833, loss_d: 0.114917
0.8061 --- loss: 1.604664, loss_ss: 0.829059, loss_d: 0.775604
0.8445 --- loss: 1.373238, loss_ss: 1.073123, loss_d: 0.300115
0.8829 --- loss: 1.263513, loss_ss: 1.027492, loss_d: 0.236020
0.9213 --- loss: 1.510508, loss_ss: 0.863994, loss_d: 0.646514
0.9597 --- loss: 1.494985, loss_ss: 1.126895, loss_d: 0.368090
0.9981 --- loss: 1.215367, loss_ss: 1.151568, loss_d: 0.063798
Epoch finished! Loss: 1.2895307070933855
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.150769, loss_ss: 0.979863, loss_d: 0.170906
0.0384 --- loss: 1.237618, loss_ss: 0.975741, loss_d: 0.261877
0.0768 --- loss: 1.065037, loss_ss: 0.841467, loss_d: 0.223570
0.1152 --- loss: 1.019051, loss_ss: 0.791826, loss_d: 0.227224
0.1536 --- loss: 1.107911, loss_ss: 1.041771, loss_d: 0.066140
0.1919 --- loss: 1.145586, loss_ss: 0.906488, loss_d: 0.239099
0.2303 --- loss: 1.171729, loss_ss: 0.983180, loss_d: 0.188548
0.2687 --- loss: 1.534417, loss_ss: 1.235841, loss_d: 0.298576
0.3071 --- loss: 1.233983, loss_ss: 1.011592, loss_d: 0.222391
0.3455 --- loss: 0.958472, loss_ss: 0.762047, loss_d: 0.196425
0.3839 --- loss: 1.094680, loss_ss: 0.910144, loss_d: 0.184536
0.4223 --- loss: 1.047185, loss_ss: 0.795810, loss_d: 0.251374
0.4607 --- loss: 1.345791, loss_ss: 0.639837, loss_d: 0.705954
0.4990 --- loss: 1.512213, loss_ss: 0.931329, loss_d: 0.580884
0.5374 --- loss: 1.206712, loss_ss: 0.957701, loss_d: 0.249011
0.5758 --- loss: 1.190817, loss_ss: 0.865805, loss_d: 0.325012
0.6142 --- loss: 0.992875, loss_ss: 0.857977, loss_d: 0.134898
0.6526 --- loss: 0.931414, loss_ss: 0.845858, loss_d: 0.085556
0.6910 --- loss: 0.921796, loss_ss: 0.756230, loss_d: 0.165566
0.7294 --- loss: 1.691702, loss_ss: 0.887889, loss_d: 0.803813
0.7678 --- loss: 1.348839, loss_ss: 1.074321, loss_d: 0.274518
0.8061 --- loss: 1.647905, loss_ss: 0.894971, loss_d: 0.752934
0.8445 --- loss: 1.363175, loss_ss: 0.835468, loss_d: 0.527707
0.8829 --- loss: 1.345959, loss_ss: 1.183995, loss_d: 0.161964
0.9213 --- loss: 0.954933, loss_ss: 0.803124, loss_d: 0.151809
0.9597 --- loss: 1.017210, loss_ss: 0.930501, loss_d: 0.086708
0.9981 --- loss: 2.607343, loss_ss: 1.620820, loss_d: 0.986524
Epoch finished! Loss: 1.2152350317973357
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.566768, loss_ss: 0.918229, loss_d: 0.648540
0.0384 --- loss: 1.295587, loss_ss: 1.051162, loss_d: 0.244425
0.0768 --- loss: 1.073475, loss_ss: 0.686058, loss_d: 0.387416
0.1152 --- loss: 1.250040, loss_ss: 1.137727, loss_d: 0.112313
0.1536 --- loss: 1.322928, loss_ss: 0.980045, loss_d: 0.342883
0.1919 --- loss: 0.931360, loss_ss: 0.741832, loss_d: 0.189528
0.2303 --- loss: 0.923728, loss_ss: 0.757037, loss_d: 0.166691
0.2687 --- loss: 1.045332, loss_ss: 0.754684, loss_d: 0.290647
0.3071 --- loss: 1.019871, loss_ss: 0.869394, loss_d: 0.150477
0.3455 --- loss: 0.798782, loss_ss: 0.745949, loss_d: 0.052832
0.3839 --- loss: 1.254645, loss_ss: 1.137631, loss_d: 0.117014
0.4223 --- loss: 1.150221, loss_ss: 0.616364, loss_d: 0.533857
0.4607 --- loss: 1.079479, loss_ss: 0.771882, loss_d: 0.307597
0.4990 --- loss: 0.898668, loss_ss: 0.799219, loss_d: 0.099449
0.5374 --- loss: 1.148818, loss_ss: 0.844828, loss_d: 0.303990
0.5758 --- loss: 0.825813, loss_ss: 0.665483, loss_d: 0.160330
0.6142 --- loss: 1.554873, loss_ss: 0.881024, loss_d: 0.673848
0.6526 --- loss: 1.225663, loss_ss: 0.840026, loss_d: 0.385637
0.6910 --- loss: 0.904559, loss_ss: 0.840916, loss_d: 0.063643
0.7294 --- loss: 0.874785, loss_ss: 0.763863, loss_d: 0.110922
0.7678 --- loss: 1.892311, loss_ss: 1.096997, loss_d: 0.795314
0.8061 --- loss: 0.863160, loss_ss: 0.756889, loss_d: 0.106271
0.8445 --- loss: 1.268561, loss_ss: 1.148347, loss_d: 0.120214
0.8829 --- loss: 1.258399, loss_ss: 0.947920, loss_d: 0.310480
0.9213 --- loss: 1.419332, loss_ss: 1.092770, loss_d: 0.326562
0.9597 --- loss: 1.446999, loss_ss: 1.183254, loss_d: 0.263745
0.9981 --- loss: 1.301379, loss_ss: 0.875204, loss_d: 0.426175
Epoch finished! Loss: 1.150339711858676
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.283668, loss_ss: 0.861554, loss_d: 0.422114
0.0384 --- loss: 0.829136, loss_ss: 0.725412, loss_d: 0.103724
0.0768 --- loss: 0.703223, loss_ss: 0.659791, loss_d: 0.043432
0.1152 --- loss: 0.893478, loss_ss: 0.833898, loss_d: 0.059580
0.1536 --- loss: 1.268513, loss_ss: 1.000943, loss_d: 0.267570
0.1919 --- loss: 1.313573, loss_ss: 1.074495, loss_d: 0.239078
0.2303 --- loss: 1.607423, loss_ss: 1.164247, loss_d: 0.443176
0.2687 --- loss: 1.010698, loss_ss: 0.796035, loss_d: 0.214663
0.3071 --- loss: 1.081175, loss_ss: 0.720714, loss_d: 0.360461
0.3455 --- loss: 1.318992, loss_ss: 1.143796, loss_d: 0.175196
0.3839 --- loss: 0.898031, loss_ss: 0.619922, loss_d: 0.278109
0.4223 --- loss: 0.848510, loss_ss: 0.760629, loss_d: 0.087881
0.4607 --- loss: 1.005079, loss_ss: 0.908617, loss_d: 0.096461
0.4990 --- loss: 1.069057, loss_ss: 1.019885, loss_d: 0.049173
0.5374 --- loss: 1.052287, loss_ss: 0.944714, loss_d: 0.107573
0.5758 --- loss: 0.933673, loss_ss: 0.712525, loss_d: 0.221148
0.6142 --- loss: 1.347751, loss_ss: 0.786529, loss_d: 0.561221
0.6526 --- loss: 0.700222, loss_ss: 0.571694, loss_d: 0.128527
0.6910 --- loss: 0.963233, loss_ss: 0.917831, loss_d: 0.045403
0.7294 --- loss: 0.847260, loss_ss: 0.603321, loss_d: 0.243939
0.7678 --- loss: 0.836333, loss_ss: 0.752628, loss_d: 0.083705
0.8061 --- loss: 0.934907, loss_ss: 0.820475, loss_d: 0.114432
0.8445 --- loss: 0.909570, loss_ss: 0.824824, loss_d: 0.084746
0.8829 --- loss: 1.167123, loss_ss: 1.058211, loss_d: 0.108911
0.9213 --- loss: 0.961512, loss_ss: 0.820340, loss_d: 0.141172
0.9597 --- loss: 1.093552, loss_ss: 0.728630, loss_d: 0.364922
0.9981 --- loss: 1.086101, loss_ss: 1.050221, loss_d: 0.035879
Epoch finished! Loss: 1.0813179965202624
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.963753, loss_ss: 0.921758, loss_d: 0.041995
0.0384 --- loss: 1.260145, loss_ss: 1.030915, loss_d: 0.229231
0.0768 --- loss: 1.336546, loss_ss: 0.978480, loss_d: 0.358066
0.1152 --- loss: 0.816951, loss_ss: 0.788568, loss_d: 0.028383
0.1536 --- loss: 0.872448, loss_ss: 0.840240, loss_d: 0.032208
0.1919 --- loss: 0.767082, loss_ss: 0.684916, loss_d: 0.082167
0.2303 --- loss: 0.793273, loss_ss: 0.680255, loss_d: 0.113018
0.2687 --- loss: 1.007758, loss_ss: 0.766737, loss_d: 0.241021
0.3071 --- loss: 0.781583, loss_ss: 0.701816, loss_d: 0.079767
0.3455 --- loss: 0.837799, loss_ss: 0.795268, loss_d: 0.042531
0.3839 --- loss: 0.752228, loss_ss: 0.689359, loss_d: 0.062869
0.4223 --- loss: 0.810553, loss_ss: 0.748651, loss_d: 0.061901
0.4607 --- loss: 1.136890, loss_ss: 0.880672, loss_d: 0.256218
0.4990 --- loss: 1.215967, loss_ss: 0.831239, loss_d: 0.384728
0.5374 --- loss: 0.963349, loss_ss: 0.547080, loss_d: 0.416269
0.5758 --- loss: 0.678381, loss_ss: 0.649678, loss_d: 0.028702
0.6142 --- loss: 1.009662, loss_ss: 0.898375, loss_d: 0.111286
0.6526 --- loss: 1.026787, loss_ss: 0.848495, loss_d: 0.178293
0.6910 --- loss: 0.922169, loss_ss: 0.800288, loss_d: 0.121880
0.7294 --- loss: 0.818123, loss_ss: 0.725080, loss_d: 0.093043
0.7678 --- loss: 1.141287, loss_ss: 0.847932, loss_d: 0.293355
0.8061 --- loss: 1.041304, loss_ss: 0.980910, loss_d: 0.060394
0.8445 --- loss: 1.158428, loss_ss: 0.770193, loss_d: 0.388235
0.8829 --- loss: 0.965597, loss_ss: 0.610837, loss_d: 0.354760
0.9213 --- loss: 1.335119, loss_ss: 0.934192, loss_d: 0.400927
0.9597 --- loss: 1.085333, loss_ss: 0.983104, loss_d: 0.102229
0.9981 --- loss: 1.125256, loss_ss: 1.096127, loss_d: 0.029129
Epoch finished! Loss: 1.0521789179398464
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.128112, loss_ss: 1.099458, loss_d: 0.028654
0.0384 --- loss: 1.665719, loss_ss: 0.420329, loss_d: 1.245390
0.0768 --- loss: 0.821254, loss_ss: 0.649548, loss_d: 0.171706
0.1152 --- loss: 1.243045, loss_ss: 1.027811, loss_d: 0.215234
0.1536 --- loss: 1.205022, loss_ss: 1.126125, loss_d: 0.078898
0.1919 --- loss: 1.424925, loss_ss: 1.112106, loss_d: 0.312819
0.2303 --- loss: 1.057880, loss_ss: 0.801263, loss_d: 0.256617
0.2687 --- loss: 0.868690, loss_ss: 0.840288, loss_d: 0.028403
0.3071 --- loss: 1.361758, loss_ss: 0.963200, loss_d: 0.398558
0.3455 --- loss: 1.051090, loss_ss: 1.018123, loss_d: 0.032967
0.3839 --- loss: 0.928462, loss_ss: 0.866845, loss_d: 0.061618
0.4223 --- loss: 1.148444, loss_ss: 0.700995, loss_d: 0.447448
0.4607 --- loss: 1.180924, loss_ss: 0.802750, loss_d: 0.378174
0.4990 --- loss: 0.779204, loss_ss: 0.740100, loss_d: 0.039105
0.5374 --- loss: 1.445103, loss_ss: 0.848676, loss_d: 0.596426
0.5758 --- loss: 0.983211, loss_ss: 0.715487, loss_d: 0.267724
0.6142 --- loss: 1.073861, loss_ss: 0.953969, loss_d: 0.119892
0.6526 --- loss: 0.867261, loss_ss: 0.796683, loss_d: 0.070578
0.6910 --- loss: 0.911016, loss_ss: 0.758042, loss_d: 0.152974
0.7294 --- loss: 1.006600, loss_ss: 0.570554, loss_d: 0.436045
0.7678 --- loss: 1.299805, loss_ss: 1.171827, loss_d: 0.127978
0.8061 --- loss: 0.752210, loss_ss: 0.619415, loss_d: 0.132796
0.8445 --- loss: 0.850097, loss_ss: 0.821107, loss_d: 0.028990
0.8829 --- loss: 0.841947, loss_ss: 0.706650, loss_d: 0.135297
0.9213 --- loss: 2.606854, loss_ss: 1.625444, loss_d: 0.981409
0.9597 --- loss: 0.661669, loss_ss: 0.633067, loss_d: 0.028603
0.9981 --- loss: 1.134569, loss_ss: 1.069903, loss_d: 0.064666
Epoch finished! Loss: 1.0083466004866821
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.058352, loss_ss: 0.822779, loss_d: 0.235572
0.0384 --- loss: 0.888215, loss_ss: 0.782224, loss_d: 0.105992
0.0768 --- loss: 1.305946, loss_ss: 0.795150, loss_d: 0.510797
0.1152 --- loss: 0.990359, loss_ss: 0.775057, loss_d: 0.215302
0.1536 --- loss: 0.977464, loss_ss: 0.894189, loss_d: 0.083275
0.1919 --- loss: 0.886951, loss_ss: 0.797187, loss_d: 0.089764
0.2303 --- loss: 0.891455, loss_ss: 0.827350, loss_d: 0.064105
0.2687 --- loss: 0.787410, loss_ss: 0.758934, loss_d: 0.028476
0.3071 --- loss: 1.177217, loss_ss: 0.867924, loss_d: 0.309292
0.3455 --- loss: 0.755499, loss_ss: 0.711494, loss_d: 0.044005
0.3839 --- loss: 1.159667, loss_ss: 0.799099, loss_d: 0.360568
0.4223 --- loss: 0.829177, loss_ss: 0.778336, loss_d: 0.050841
0.4607 --- loss: 0.774416, loss_ss: 0.684297, loss_d: 0.090119
0.4990 --- loss: 1.292910, loss_ss: 0.750380, loss_d: 0.542530
0.5374 --- loss: 1.367138, loss_ss: 1.136550, loss_d: 0.230588
0.5758 --- loss: 0.908602, loss_ss: 0.827138, loss_d: 0.081464
0.6142 --- loss: 0.868673, loss_ss: 0.855167, loss_d: 0.013506
0.6526 --- loss: 1.666039, loss_ss: 0.799999, loss_d: 0.866039
0.6910 --- loss: 1.138219, loss_ss: 0.710830, loss_d: 0.427389
0.7294 --- loss: 1.080193, loss_ss: 0.772593, loss_d: 0.307599
0.7678 --- loss: 1.014790, loss_ss: 0.801669, loss_d: 0.213120
0.8061 --- loss: 1.108846, loss_ss: 0.674957, loss_d: 0.433888
0.8445 --- loss: 0.781237, loss_ss: 0.722956, loss_d: 0.058280
0.8829 --- loss: 1.792018, loss_ss: 0.895632, loss_d: 0.896386
0.9213 --- loss: 0.900287, loss_ss: 0.789581, loss_d: 0.110706
0.9597 --- loss: 0.703419, loss_ss: 0.645812, loss_d: 0.057607
0.9981 --- loss: 1.343837, loss_ss: 1.237001, loss_d: 0.106837
Epoch finished! Loss: 0.9881054919499618
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.756849, loss_ss: 0.706314, loss_d: 0.050536
0.0384 --- loss: 1.173054, loss_ss: 1.151116, loss_d: 0.021937
0.0768 --- loss: 0.819849, loss_ss: 0.768902, loss_d: 0.050947
0.1152 --- loss: 0.764420, loss_ss: 0.736491, loss_d: 0.027929
0.1536 --- loss: 0.618288, loss_ss: 0.591686, loss_d: 0.026602
0.1919 --- loss: 1.342582, loss_ss: 1.124894, loss_d: 0.217689
0.2303 --- loss: 0.677154, loss_ss: 0.631616, loss_d: 0.045539
0.2687 --- loss: 1.122053, loss_ss: 1.051737, loss_d: 0.070316
0.3071 --- loss: 0.791786, loss_ss: 0.708111, loss_d: 0.083675
0.3455 --- loss: 0.843995, loss_ss: 0.805129, loss_d: 0.038866
0.3839 --- loss: 1.405719, loss_ss: 1.070692, loss_d: 0.335028
0.4223 --- loss: 0.868721, loss_ss: 0.740784, loss_d: 0.127937
0.4607 --- loss: 0.968949, loss_ss: 0.861371, loss_d: 0.107578
0.4990 --- loss: 0.989135, loss_ss: 0.883327, loss_d: 0.105809
0.5374 --- loss: 0.951528, loss_ss: 0.882436, loss_d: 0.069092
0.5758 --- loss: 1.184980, loss_ss: 0.850520, loss_d: 0.334460
0.6142 --- loss: 0.599181, loss_ss: 0.544901, loss_d: 0.054280
0.6526 --- loss: 0.921006, loss_ss: 0.908531, loss_d: 0.012475
0.6910 --- loss: 1.365076, loss_ss: 0.625267, loss_d: 0.739809
0.7294 --- loss: 0.923972, loss_ss: 0.591633, loss_d: 0.332338
0.7678 --- loss: 1.014967, loss_ss: 0.876147, loss_d: 0.138820
0.8061 --- loss: 0.748803, loss_ss: 0.634577, loss_d: 0.114227
0.8445 --- loss: 0.747818, loss_ss: 0.705009, loss_d: 0.042810
0.8829 --- loss: 1.349859, loss_ss: 1.115107, loss_d: 0.234752
0.9213 --- loss: 1.273231, loss_ss: 0.795795, loss_d: 0.477435
0.9597 --- loss: 0.983269, loss_ss: 0.908281, loss_d: 0.074988
0.9981 --- loss: 1.238655, loss_ss: 0.765324, loss_d: 0.473331
Epoch finished! Loss: 0.990702054133782
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6494949494949495
             precision    recall  f1-score   support

        0.0       0.88      0.83      0.85       203
        1.0       0.20      0.57      0.30        68
        2.0       0.68      0.87      0.76       397
        3.0       1.00      0.22      0.36       146
        4.0       0.97      0.32      0.49       176

avg / total       0.78      0.65      0.64       990
 


====== chp014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.14  83.25   96.95   87.56     85.35
1  81.41  57.35   83.19   20.10     29.77
2  78.08  87.15   72.01   67.58     76.13
3  88.48  21.92  100.00  100.00     35.96
4  87.78  32.39   99.75   96.61     48.51
Total accuracy: 64.95%
Average sen: 56.41%
Average spec: 90.38%
Macro f1-score: 55.14%
Diagnosis acc on 15mins: 1.0
[0.9976992  0.99875259 0.99616504 0.99867707 0.99963439 0.99800748
 0.99986744 0.99980742 0.99976379 0.99991393 0.99685425 0.99552745
 0.99747616 0.99970609 0.99992657 0.99996018 0.9997614  0.999511
 0.99956077 0.99635243 0.99976617 0.98264068 0.95545149 0.99722689
 0.98881322 0.99903667 0.98842257 0.99825031 0.9954406  0.98875999
 0.999318   0.99947792 0.99832278]
pred: 0.9958743019537493, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.272099, loss_ss: 1.599961, loss_d: 0.672138
0.0385 --- loss: 2.115923, loss_ss: 1.443736, loss_d: 0.672187
0.0769 --- loss: 2.019540, loss_ss: 1.506844, loss_d: 0.512696
0.1154 --- loss: 2.185069, loss_ss: 1.504321, loss_d: 0.680749
0.1538 --- loss: 1.988445, loss_ss: 1.434397, loss_d: 0.554048
0.1923 --- loss: 1.843426, loss_ss: 1.406602, loss_d: 0.436824
0.2308 --- loss: 1.818049, loss_ss: 1.397503, loss_d: 0.420546
0.2692 --- loss: 1.809649, loss_ss: 1.367700, loss_d: 0.441949
0.3077 --- loss: 2.096164, loss_ss: 1.452617, loss_d: 0.643547
0.3462 --- loss: 1.844356, loss_ss: 1.396831, loss_d: 0.447525
0.3846 --- loss: 1.874578, loss_ss: 1.347707, loss_d: 0.526871
0.4231 --- loss: 2.017327, loss_ss: 1.373949, loss_d: 0.643378
0.4615 --- loss: 1.874487, loss_ss: 1.442437, loss_d: 0.432050
0.5000 --- loss: 1.901982, loss_ss: 1.348422, loss_d: 0.553560
0.5385 --- loss: 2.157694, loss_ss: 1.402893, loss_d: 0.754801
0.5769 --- loss: 2.032498, loss_ss: 1.441903, loss_d: 0.590595
0.6154 --- loss: 1.860723, loss_ss: 1.386316, loss_d: 0.474408
0.6538 --- loss: 1.927286, loss_ss: 1.322056, loss_d: 0.605230
0.6923 --- loss: 1.699423, loss_ss: 1.363196, loss_d: 0.336228
0.7308 --- loss: 1.855031, loss_ss: 1.168713, loss_d: 0.686318
0.7692 --- loss: 1.968883, loss_ss: 1.280895, loss_d: 0.687988
0.8077 --- loss: 1.568049, loss_ss: 1.169000, loss_d: 0.399049
0.8462 --- loss: 1.659611, loss_ss: 1.346996, loss_d: 0.312615
0.8846 --- loss: 1.535018, loss_ss: 1.284565, loss_d: 0.250452
0.9231 --- loss: 1.724024, loss_ss: 1.380223, loss_d: 0.343801
0.9615 --- loss: 1.735503, loss_ss: 1.381216, loss_d: 0.354287
Epoch finished! Loss: 1.9444270562020969
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.545472, loss_ss: 1.169043, loss_d: 0.376429
0.0385 --- loss: 1.630538, loss_ss: 1.225117, loss_d: 0.405421
0.0769 --- loss: 1.794801, loss_ss: 1.339385, loss_d: 0.455416
0.1154 --- loss: 1.401196, loss_ss: 1.168005, loss_d: 0.233192
0.1538 --- loss: 1.539432, loss_ss: 1.145072, loss_d: 0.394360
0.1923 --- loss: 1.575727, loss_ss: 1.172502, loss_d: 0.403225
0.2308 --- loss: 1.534330, loss_ss: 1.137391, loss_d: 0.396939
0.2692 --- loss: 1.600053, loss_ss: 1.174044, loss_d: 0.426009
0.3077 --- loss: 1.431319, loss_ss: 1.071898, loss_d: 0.359420
0.3462 --- loss: 1.422549, loss_ss: 1.203528, loss_d: 0.219022
0.3846 --- loss: 1.795207, loss_ss: 1.095536, loss_d: 0.699671
0.4231 --- loss: 1.740037, loss_ss: 1.056359, loss_d: 0.683678
0.4615 --- loss: 1.444896, loss_ss: 1.161302, loss_d: 0.283593
0.5000 --- loss: 1.260329, loss_ss: 1.047062, loss_d: 0.213267
0.5385 --- loss: 1.850809, loss_ss: 1.442202, loss_d: 0.408606
0.5769 --- loss: 1.527953, loss_ss: 1.247561, loss_d: 0.280392
0.6154 --- loss: 1.322283, loss_ss: 0.998119, loss_d: 0.324164
0.6538 --- loss: 1.580797, loss_ss: 1.302184, loss_d: 0.278613
0.6923 --- loss: 1.120398, loss_ss: 0.936136, loss_d: 0.184261
0.7308 --- loss: 1.409126, loss_ss: 1.007581, loss_d: 0.401545
0.7692 --- loss: 1.499614, loss_ss: 1.096385, loss_d: 0.403228
0.8077 --- loss: 1.629571, loss_ss: 0.994366, loss_d: 0.635205
0.8462 --- loss: 1.241599, loss_ss: 1.089497, loss_d: 0.152103
0.8846 --- loss: 1.986928, loss_ss: 1.141396, loss_d: 0.845532
0.9231 --- loss: 1.298579, loss_ss: 1.038646, loss_d: 0.259933
0.9615 --- loss: 1.255660, loss_ss: 0.957899, loss_d: 0.297761
Epoch finished! Loss: 1.549706355024949
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.633528, loss_ss: 1.316436, loss_d: 0.317092
0.0385 --- loss: 1.251388, loss_ss: 0.932455, loss_d: 0.318933
0.0769 --- loss: 1.553866, loss_ss: 1.029853, loss_d: 0.524013
0.1154 --- loss: 1.451870, loss_ss: 0.920964, loss_d: 0.530906
0.1538 --- loss: 1.158239, loss_ss: 1.010237, loss_d: 0.148002
0.1923 --- loss: 1.739766, loss_ss: 1.093986, loss_d: 0.645780
0.2308 --- loss: 1.384840, loss_ss: 1.184635, loss_d: 0.200206
0.2692 --- loss: 1.397850, loss_ss: 1.286839, loss_d: 0.111010
0.3077 --- loss: 1.445694, loss_ss: 1.132746, loss_d: 0.312948
0.3462 --- loss: 2.004172, loss_ss: 0.988855, loss_d: 1.015317
0.3846 --- loss: 1.684244, loss_ss: 1.017946, loss_d: 0.666299
0.4231 --- loss: 1.323598, loss_ss: 0.874330, loss_d: 0.449268
0.4615 --- loss: 1.537843, loss_ss: 0.969273, loss_d: 0.568570
0.5000 --- loss: 1.512228, loss_ss: 1.135514, loss_d: 0.376714
0.5385 --- loss: 1.092243, loss_ss: 0.949091, loss_d: 0.143152
0.5769 --- loss: 1.317525, loss_ss: 1.001794, loss_d: 0.315731
0.6154 --- loss: 1.527265, loss_ss: 1.241047, loss_d: 0.286218
0.6538 --- loss: 1.076912, loss_ss: 0.910816, loss_d: 0.166096
0.6923 --- loss: 1.410744, loss_ss: 1.096824, loss_d: 0.313920
0.7308 --- loss: 1.132717, loss_ss: 1.076429, loss_d: 0.056288
0.7692 --- loss: 1.408455, loss_ss: 0.862901, loss_d: 0.545554
0.8077 --- loss: 1.272580, loss_ss: 0.821189, loss_d: 0.451391
0.8462 --- loss: 1.367617, loss_ss: 1.144367, loss_d: 0.223250
0.8846 --- loss: 1.109055, loss_ss: 0.955071, loss_d: 0.153983
0.9231 --- loss: 1.594117, loss_ss: 1.070189, loss_d: 0.523929
0.9615 --- loss: 1.071181, loss_ss: 0.945244, loss_d: 0.125937
Epoch finished! Loss: 1.308204538113362
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.005940, loss_ss: 0.938231, loss_d: 0.067709
0.0385 --- loss: 1.297614, loss_ss: 1.194708, loss_d: 0.102905
0.0769 --- loss: 0.970817, loss_ss: 0.925400, loss_d: 0.045417
0.1154 --- loss: 1.186034, loss_ss: 0.984931, loss_d: 0.201103
0.1538 --- loss: 1.324565, loss_ss: 0.907689, loss_d: 0.416876
0.1923 --- loss: 2.115687, loss_ss: 0.829140, loss_d: 1.286547
0.2308 --- loss: 1.031110, loss_ss: 0.793254, loss_d: 0.237856
0.2692 --- loss: 1.212528, loss_ss: 0.940911, loss_d: 0.271616
0.3077 --- loss: 1.332154, loss_ss: 1.108243, loss_d: 0.223911
0.3462 --- loss: 1.346251, loss_ss: 0.961699, loss_d: 0.384552
0.3846 --- loss: 1.408867, loss_ss: 0.798306, loss_d: 0.610561
0.4231 --- loss: 1.065184, loss_ss: 0.842917, loss_d: 0.222267
0.4615 --- loss: 0.982876, loss_ss: 0.833167, loss_d: 0.149709
0.5000 --- loss: 0.985119, loss_ss: 0.901992, loss_d: 0.083127
0.5385 --- loss: 1.129426, loss_ss: 0.782118, loss_d: 0.347308
0.5769 --- loss: 1.274780, loss_ss: 0.696450, loss_d: 0.578330
0.6154 --- loss: 1.079705, loss_ss: 0.829416, loss_d: 0.250288
0.6538 --- loss: 1.079454, loss_ss: 0.925456, loss_d: 0.153999
0.6923 --- loss: 1.595589, loss_ss: 0.899734, loss_d: 0.695854
0.7308 --- loss: 2.098086, loss_ss: 1.581895, loss_d: 0.516191
0.7692 --- loss: 0.954415, loss_ss: 0.837060, loss_d: 0.117355
0.8077 --- loss: 1.378186, loss_ss: 0.694760, loss_d: 0.683426
0.8462 --- loss: 1.257584, loss_ss: 0.849827, loss_d: 0.407757
0.8846 --- loss: 1.317835, loss_ss: 1.160392, loss_d: 0.157444
0.9231 --- loss: 1.331161, loss_ss: 0.767982, loss_d: 0.563179
0.9615 --- loss: 1.016787, loss_ss: 0.739424, loss_d: 0.277362
Epoch finished! Loss: 1.2121422852328385
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.228937, loss_ss: 0.796958, loss_d: 0.431979
0.0385 --- loss: 1.466161, loss_ss: 0.983049, loss_d: 0.483112
0.0769 --- loss: 1.120905, loss_ss: 0.978296, loss_d: 0.142609
0.1154 --- loss: 1.274838, loss_ss: 0.768109, loss_d: 0.506729
0.1538 --- loss: 1.022228, loss_ss: 0.979167, loss_d: 0.043061
0.1923 --- loss: 1.065293, loss_ss: 1.037589, loss_d: 0.027704
0.2308 --- loss: 1.252039, loss_ss: 1.168932, loss_d: 0.083107
0.2692 --- loss: 1.121309, loss_ss: 0.861036, loss_d: 0.260273
0.3077 --- loss: 1.148432, loss_ss: 1.091384, loss_d: 0.057048
0.3462 --- loss: 0.762532, loss_ss: 0.692048, loss_d: 0.070484
0.3846 --- loss: 1.033547, loss_ss: 0.731111, loss_d: 0.302436
0.4231 --- loss: 1.500250, loss_ss: 1.181736, loss_d: 0.318514
0.4615 --- loss: 1.871334, loss_ss: 1.430342, loss_d: 0.440992
0.5000 --- loss: 1.539117, loss_ss: 1.276484, loss_d: 0.262633
0.5385 --- loss: 0.993681, loss_ss: 0.846193, loss_d: 0.147488
0.5769 --- loss: 1.176714, loss_ss: 0.753730, loss_d: 0.422984
0.6154 --- loss: 1.008687, loss_ss: 0.861162, loss_d: 0.147525
0.6538 --- loss: 1.372722, loss_ss: 0.936588, loss_d: 0.436134
0.6923 --- loss: 1.073262, loss_ss: 0.732941, loss_d: 0.340321
0.7308 --- loss: 1.046124, loss_ss: 0.845396, loss_d: 0.200728
0.7692 --- loss: 0.930346, loss_ss: 0.734421, loss_d: 0.195925
0.8077 --- loss: 1.438818, loss_ss: 1.000182, loss_d: 0.438636
0.8462 --- loss: 1.045080, loss_ss: 0.822864, loss_d: 0.222216
0.8846 --- loss: 1.238282, loss_ss: 1.076228, loss_d: 0.162055
0.9231 --- loss: 1.009046, loss_ss: 0.960458, loss_d: 0.048588
0.9615 --- loss: 1.017426, loss_ss: 0.983072, loss_d: 0.034354
Epoch finished! Loss: 1.148050171988351
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.282497, loss_ss: 1.013797, loss_d: 0.268700
0.0385 --- loss: 1.174621, loss_ss: 0.538635, loss_d: 0.635985
0.0769 --- loss: 0.952942, loss_ss: 0.752182, loss_d: 0.200760
0.1154 --- loss: 1.437772, loss_ss: 1.150807, loss_d: 0.286965
0.1538 --- loss: 1.048331, loss_ss: 0.721396, loss_d: 0.326936
0.1923 --- loss: 1.008402, loss_ss: 0.810821, loss_d: 0.197581
0.2308 --- loss: 1.506299, loss_ss: 1.201219, loss_d: 0.305080
0.2692 --- loss: 1.109653, loss_ss: 0.846285, loss_d: 0.263369
0.3077 --- loss: 1.522521, loss_ss: 0.629993, loss_d: 0.892528
0.3462 --- loss: 1.485034, loss_ss: 0.932208, loss_d: 0.552826
0.3846 --- loss: 1.016771, loss_ss: 0.840179, loss_d: 0.176592
0.4231 --- loss: 1.243173, loss_ss: 0.968095, loss_d: 0.275078
0.4615 --- loss: 1.369149, loss_ss: 0.631499, loss_d: 0.737650
0.5000 --- loss: 1.053999, loss_ss: 0.785887, loss_d: 0.268112
0.5385 --- loss: 1.086621, loss_ss: 0.955689, loss_d: 0.130932
0.5769 --- loss: 0.898921, loss_ss: 0.825868, loss_d: 0.073053
0.6154 --- loss: 1.077603, loss_ss: 1.004773, loss_d: 0.072830
0.6538 --- loss: 0.856226, loss_ss: 0.756323, loss_d: 0.099903
0.6923 --- loss: 1.321355, loss_ss: 1.052233, loss_d: 0.269123
0.7308 --- loss: 0.834904, loss_ss: 0.794586, loss_d: 0.040318
0.7692 --- loss: 0.913139, loss_ss: 0.441965, loss_d: 0.471174
0.8077 --- loss: 0.828804, loss_ss: 0.785595, loss_d: 0.043209
0.8462 --- loss: 0.997055, loss_ss: 0.809033, loss_d: 0.188022
0.8846 --- loss: 0.954267, loss_ss: 0.906891, loss_d: 0.047376
0.9231 --- loss: 1.341780, loss_ss: 0.856615, loss_d: 0.485165
0.9615 --- loss: 1.036884, loss_ss: 0.781051, loss_d: 0.255832
Epoch finished! Loss: 1.058762296056195
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.877375, loss_ss: 0.767491, loss_d: 0.109884
0.0385 --- loss: 0.887446, loss_ss: 0.877833, loss_d: 0.009613
0.0769 --- loss: 0.909089, loss_ss: 0.585982, loss_d: 0.323107
0.1154 --- loss: 1.277618, loss_ss: 1.111292, loss_d: 0.166326
0.1538 --- loss: 1.091343, loss_ss: 0.913751, loss_d: 0.177592
0.1923 --- loss: 0.853028, loss_ss: 0.732307, loss_d: 0.120721
0.2308 --- loss: 1.206813, loss_ss: 1.085885, loss_d: 0.120928
0.2692 --- loss: 0.686760, loss_ss: 0.671965, loss_d: 0.014795
0.3077 --- loss: 0.779015, loss_ss: 0.767866, loss_d: 0.011149
0.3462 --- loss: 0.948639, loss_ss: 0.796518, loss_d: 0.152121
0.3846 --- loss: 0.737505, loss_ss: 0.659789, loss_d: 0.077717
0.4231 --- loss: 1.000218, loss_ss: 0.966901, loss_d: 0.033316
0.4615 --- loss: 0.669703, loss_ss: 0.574573, loss_d: 0.095130
0.5000 --- loss: 0.714788, loss_ss: 0.577972, loss_d: 0.136816
0.5385 --- loss: 1.225931, loss_ss: 1.126878, loss_d: 0.099053
0.5769 --- loss: 1.100121, loss_ss: 0.964096, loss_d: 0.136025
0.6154 --- loss: 1.151208, loss_ss: 1.076931, loss_d: 0.074277
0.6538 --- loss: 1.029602, loss_ss: 0.482017, loss_d: 0.547586
0.6923 --- loss: 1.440962, loss_ss: 1.066705, loss_d: 0.374257
0.7308 --- loss: 0.855896, loss_ss: 0.791925, loss_d: 0.063971
0.7692 --- loss: 1.432436, loss_ss: 0.874363, loss_d: 0.558072
0.8077 --- loss: 1.338553, loss_ss: 1.016634, loss_d: 0.321919
0.8462 --- loss: 0.791260, loss_ss: 0.743950, loss_d: 0.047310
0.8846 --- loss: 1.364286, loss_ss: 0.946236, loss_d: 0.418050
0.9231 --- loss: 1.114462, loss_ss: 0.934157, loss_d: 0.180305
0.9615 --- loss: 0.875081, loss_ss: 0.838627, loss_d: 0.036454
Epoch finished! Loss: 1.0321089830177632
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.066135, loss_ss: 0.929384, loss_d: 0.136751
0.0385 --- loss: 1.199835, loss_ss: 1.159799, loss_d: 0.040036
0.0769 --- loss: 0.705276, loss_ss: 0.688940, loss_d: 0.016336
0.1154 --- loss: 1.203948, loss_ss: 0.882960, loss_d: 0.320988
0.1538 --- loss: 0.873992, loss_ss: 0.803526, loss_d: 0.070467
0.1923 --- loss: 0.947181, loss_ss: 0.739644, loss_d: 0.207537
0.2308 --- loss: 1.382254, loss_ss: 0.735791, loss_d: 0.646463
0.2692 --- loss: 0.949930, loss_ss: 0.781458, loss_d: 0.168472
0.3077 --- loss: 0.959991, loss_ss: 0.884815, loss_d: 0.075175
0.3462 --- loss: 1.386485, loss_ss: 1.052397, loss_d: 0.334088
0.3846 --- loss: 1.037134, loss_ss: 0.763266, loss_d: 0.273868
0.4231 --- loss: 1.326696, loss_ss: 1.142192, loss_d: 0.184503
0.4615 --- loss: 0.957104, loss_ss: 0.808834, loss_d: 0.148270
0.5000 --- loss: 0.899448, loss_ss: 0.698408, loss_d: 0.201040
0.5385 --- loss: 0.758903, loss_ss: 0.737069, loss_d: 0.021834
0.5769 --- loss: 0.914728, loss_ss: 0.845394, loss_d: 0.069334
0.6154 --- loss: 1.036507, loss_ss: 1.024439, loss_d: 0.012068
0.6538 --- loss: 1.539430, loss_ss: 0.770623, loss_d: 0.768806
0.6923 --- loss: 0.996959, loss_ss: 0.780664, loss_d: 0.216295
0.7308 --- loss: 1.135839, loss_ss: 0.856192, loss_d: 0.279648
0.7692 --- loss: 0.894849, loss_ss: 0.883542, loss_d: 0.011307
0.8077 --- loss: 0.600378, loss_ss: 0.589209, loss_d: 0.011169
0.8462 --- loss: 1.339885, loss_ss: 1.030087, loss_d: 0.309798
0.8846 --- loss: 0.564402, loss_ss: 0.528491, loss_d: 0.035911
0.9231 --- loss: 1.260595, loss_ss: 1.246870, loss_d: 0.013726
0.9615 --- loss: 1.282906, loss_ss: 1.223904, loss_d: 0.059002
Epoch finished! Loss: 0.9774152376476862
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.898465, loss_ss: 0.865307, loss_d: 0.033157
0.0385 --- loss: 0.794500, loss_ss: 0.784505, loss_d: 0.009996
0.0769 --- loss: 1.027436, loss_ss: 0.873323, loss_d: 0.154113
0.1154 --- loss: 0.828141, loss_ss: 0.817207, loss_d: 0.010934
0.1538 --- loss: 0.913823, loss_ss: 0.759148, loss_d: 0.154675
0.1923 --- loss: 1.004167, loss_ss: 0.990800, loss_d: 0.013367
0.2308 --- loss: 0.772103, loss_ss: 0.745155, loss_d: 0.026948
0.2692 --- loss: 0.844884, loss_ss: 0.835914, loss_d: 0.008970
0.3077 --- loss: 0.685236, loss_ss: 0.672123, loss_d: 0.013113
0.3462 --- loss: 1.091441, loss_ss: 0.971400, loss_d: 0.120041
0.3846 --- loss: 1.069224, loss_ss: 1.030107, loss_d: 0.039117
0.4231 --- loss: 0.913533, loss_ss: 0.820547, loss_d: 0.092986
0.4615 --- loss: 0.814675, loss_ss: 0.806416, loss_d: 0.008259
0.5000 --- loss: 0.967672, loss_ss: 0.952494, loss_d: 0.015178
0.5385 --- loss: 2.095160, loss_ss: 1.159448, loss_d: 0.935712
0.5769 --- loss: 0.624829, loss_ss: 0.537181, loss_d: 0.087648
0.6154 --- loss: 1.071877, loss_ss: 1.032133, loss_d: 0.039744
0.6538 --- loss: 1.098066, loss_ss: 1.069090, loss_d: 0.028976
0.6923 --- loss: 0.600421, loss_ss: 0.581602, loss_d: 0.018819
0.7308 --- loss: 0.695513, loss_ss: 0.679563, loss_d: 0.015950
0.7692 --- loss: 0.777454, loss_ss: 0.569330, loss_d: 0.208125
0.8077 --- loss: 0.737374, loss_ss: 0.695412, loss_d: 0.041963
0.8462 --- loss: 0.883042, loss_ss: 0.838481, loss_d: 0.044561
0.8846 --- loss: 0.846312, loss_ss: 0.740286, loss_d: 0.106026
0.9231 --- loss: 1.256812, loss_ss: 0.968131, loss_d: 0.288681
0.9615 --- loss: 1.129153, loss_ss: 0.874595, loss_d: 0.254558
Epoch finished! Loss: 0.93404200316396
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.948282, loss_ss: 0.899262, loss_d: 0.049020
0.0385 --- loss: 1.052220, loss_ss: 1.041263, loss_d: 0.010957
0.0769 --- loss: 0.890476, loss_ss: 0.866731, loss_d: 0.023745
0.1154 --- loss: 0.571907, loss_ss: 0.555150, loss_d: 0.016757
0.1538 --- loss: 0.884044, loss_ss: 0.752814, loss_d: 0.131230
0.1923 --- loss: 0.676311, loss_ss: 0.632023, loss_d: 0.044287
0.2308 --- loss: 0.931639, loss_ss: 0.847321, loss_d: 0.084318
0.2692 --- loss: 0.929124, loss_ss: 0.816138, loss_d: 0.112986
0.3077 --- loss: 0.779136, loss_ss: 0.757796, loss_d: 0.021340
0.3462 --- loss: 0.819738, loss_ss: 0.815747, loss_d: 0.003991
0.3846 --- loss: 0.855043, loss_ss: 0.763704, loss_d: 0.091339
0.4231 --- loss: 0.654546, loss_ss: 0.597716, loss_d: 0.056831
0.4615 --- loss: 0.985457, loss_ss: 0.895404, loss_d: 0.090053
0.5000 --- loss: 0.774434, loss_ss: 0.690536, loss_d: 0.083899
0.5385 --- loss: 0.909235, loss_ss: 0.816770, loss_d: 0.092466
0.5769 --- loss: 0.665587, loss_ss: 0.599759, loss_d: 0.065828
0.6154 --- loss: 0.648282, loss_ss: 0.636852, loss_d: 0.011430
0.6538 --- loss: 0.887865, loss_ss: 0.878030, loss_d: 0.009835
0.6923 --- loss: 0.596365, loss_ss: 0.593524, loss_d: 0.002841
0.7308 --- loss: 0.822953, loss_ss: 0.761429, loss_d: 0.061524
0.7692 --- loss: 1.273680, loss_ss: 1.187550, loss_d: 0.086131
0.8077 --- loss: 0.723656, loss_ss: 0.665351, loss_d: 0.058304
0.8462 --- loss: 1.146074, loss_ss: 0.900054, loss_d: 0.246020
0.8846 --- loss: 0.748478, loss_ss: 0.734670, loss_d: 0.013807
0.9231 --- loss: 1.269793, loss_ss: 1.026545, loss_d: 0.243248
0.9615 --- loss: 0.834007, loss_ss: 0.771853, loss_d: 0.062153
Epoch finished! Loss: 0.9179187994666081
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.65
             precision    recall  f1-score   support

        0.0       0.27      0.79      0.40        67
        1.0       0.48      0.18      0.26       281
        2.0       0.69      0.85      0.77       335
        3.0       0.99      0.84      0.91       264
        4.0       0.65      0.67      0.66       193

avg / total       0.68      0.65      0.63      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.23  79.10   86.67  27.04     40.30
1  74.91  18.15   93.48  47.66     26.29
2  84.65  85.37   84.35  69.42     76.57
3  96.05  84.09   99.66  98.67     90.80
4  88.16  66.84   92.50  64.50     65.65
Total accuracy: 65.00%
Average sen: 66.71%
Average spec: 91.33%
Macro f1-score: 59.92%
Diagnosis acc on 15mins: 0.8157894736842105
[0.90177804 0.0054301  0.00376374 0.51723003 0.85301298 0.75629151
 0.9581967  0.99683595 0.96950072 0.99139154 0.9901529  0.9979679
 0.97808313 0.7614888  0.01239355 0.0170456  0.96413112 0.99875498
 0.99799025 0.98732865 0.95075828 0.90245736 0.99213988 0.97448575
 0.99611229 0.99925357 0.96576458 0.41928759 0.20289935 0.94138938
 0.82276416 0.14946362 0.86106032 0.9791159  0.98254079 0.9901787
 0.99780816 0.94435585]
pred: 0.7823843080366618, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.242530, loss_ss: 1.557722, loss_d: 0.684807
0.0385 --- loss: 2.343020, loss_ss: 1.491397, loss_d: 0.851624
0.0770 --- loss: 2.136062, loss_ss: 1.531479, loss_d: 0.604583
0.1156 --- loss: 1.773941, loss_ss: 1.422444, loss_d: 0.351497
0.1541 --- loss: 1.922731, loss_ss: 1.432001, loss_d: 0.490730
0.1926 --- loss: 1.968395, loss_ss: 1.395963, loss_d: 0.572432
0.2311 --- loss: 1.811900, loss_ss: 1.410534, loss_d: 0.401366
0.2696 --- loss: 1.942862, loss_ss: 1.423545, loss_d: 0.519316
0.3082 --- loss: 2.229414, loss_ss: 1.396385, loss_d: 0.833029
0.3467 --- loss: 1.634379, loss_ss: 1.286746, loss_d: 0.347633
0.3852 --- loss: 2.044449, loss_ss: 1.277034, loss_d: 0.767415
0.4237 --- loss: 1.753046, loss_ss: 1.319249, loss_d: 0.433797
0.4622 --- loss: 1.750784, loss_ss: 1.162973, loss_d: 0.587811
0.5008 --- loss: 1.596842, loss_ss: 1.285304, loss_d: 0.311538
0.5393 --- loss: 1.918721, loss_ss: 1.254694, loss_d: 0.664028
0.5778 --- loss: 1.650331, loss_ss: 1.282722, loss_d: 0.367609
0.6163 --- loss: 1.697542, loss_ss: 1.251754, loss_d: 0.445787
0.6549 --- loss: 1.532120, loss_ss: 1.304115, loss_d: 0.228005
0.6934 --- loss: 1.562514, loss_ss: 1.208911, loss_d: 0.353603
0.7319 --- loss: 1.614875, loss_ss: 1.227295, loss_d: 0.387580
0.7704 --- loss: 1.760866, loss_ss: 1.439039, loss_d: 0.321827
0.8089 --- loss: 1.734959, loss_ss: 1.146845, loss_d: 0.588114
0.8475 --- loss: 1.582277, loss_ss: 1.030862, loss_d: 0.551415
0.8860 --- loss: 1.599873, loss_ss: 1.292659, loss_d: 0.307214
0.9245 --- loss: 1.721223, loss_ss: 1.177038, loss_d: 0.544185
0.9630 --- loss: 1.510950, loss_ss: 1.098554, loss_d: 0.412396
Epoch finished! Loss: 1.8643208318695599
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.315530, loss_ss: 1.006987, loss_d: 0.308543
0.0385 --- loss: 1.422953, loss_ss: 1.211151, loss_d: 0.211802
0.0770 --- loss: 1.571364, loss_ss: 1.258979, loss_d: 0.312385
0.1156 --- loss: 1.604013, loss_ss: 1.362370, loss_d: 0.241644
0.1541 --- loss: 1.383780, loss_ss: 1.077377, loss_d: 0.306402
0.1926 --- loss: 1.519694, loss_ss: 1.197544, loss_d: 0.322150
0.2311 --- loss: 1.273632, loss_ss: 1.124426, loss_d: 0.149206
0.2696 --- loss: 1.314685, loss_ss: 0.967008, loss_d: 0.347677
0.3082 --- loss: 1.456665, loss_ss: 1.105301, loss_d: 0.351364
0.3467 --- loss: 1.129764, loss_ss: 0.961919, loss_d: 0.167844
0.3852 --- loss: 1.697809, loss_ss: 1.092574, loss_d: 0.605235
0.4237 --- loss: 1.231237, loss_ss: 1.059081, loss_d: 0.172155
0.4622 --- loss: 1.517761, loss_ss: 1.238915, loss_d: 0.278846
0.5008 --- loss: 1.588915, loss_ss: 0.973235, loss_d: 0.615680
0.5393 --- loss: 1.318729, loss_ss: 1.020334, loss_d: 0.298395
0.5778 --- loss: 1.230687, loss_ss: 0.964802, loss_d: 0.265886
0.6163 --- loss: 1.140317, loss_ss: 0.954728, loss_d: 0.185589
0.6549 --- loss: 1.363167, loss_ss: 1.075313, loss_d: 0.287854
0.6934 --- loss: 1.488259, loss_ss: 1.084316, loss_d: 0.403943
0.7319 --- loss: 1.202609, loss_ss: 1.066243, loss_d: 0.136366
0.7704 --- loss: 1.533506, loss_ss: 1.067215, loss_d: 0.466291
0.8089 --- loss: 1.775438, loss_ss: 1.049093, loss_d: 0.726346
0.8475 --- loss: 1.666853, loss_ss: 1.118213, loss_d: 0.548641
0.8860 --- loss: 1.074152, loss_ss: 0.876488, loss_d: 0.197664
0.9245 --- loss: 1.354797, loss_ss: 1.061114, loss_d: 0.293683
0.9630 --- loss: 1.352879, loss_ss: 1.012175, loss_d: 0.340704
Epoch finished! Loss: 1.4763226858897558
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.338386, loss_ss: 1.188769, loss_d: 0.149617
0.0385 --- loss: 1.104619, loss_ss: 1.014880, loss_d: 0.089739
0.0770 --- loss: 2.350804, loss_ss: 1.106226, loss_d: 1.244578
0.1156 --- loss: 1.248569, loss_ss: 0.851178, loss_d: 0.397390
0.1541 --- loss: 1.126616, loss_ss: 0.917725, loss_d: 0.208891
0.1926 --- loss: 1.340050, loss_ss: 0.939062, loss_d: 0.400987
0.2311 --- loss: 1.688674, loss_ss: 1.484189, loss_d: 0.204486
0.2696 --- loss: 1.118626, loss_ss: 0.977976, loss_d: 0.140650
0.3082 --- loss: 1.035837, loss_ss: 0.819834, loss_d: 0.216004
0.3467 --- loss: 1.043779, loss_ss: 0.866858, loss_d: 0.176921
0.3852 --- loss: 1.351866, loss_ss: 1.153661, loss_d: 0.198206
0.4237 --- loss: 1.195549, loss_ss: 0.901280, loss_d: 0.294269
0.4622 --- loss: 1.174308, loss_ss: 1.008132, loss_d: 0.166176
0.5008 --- loss: 1.239146, loss_ss: 0.911941, loss_d: 0.327205
0.5393 --- loss: 1.106562, loss_ss: 1.015567, loss_d: 0.090995
0.5778 --- loss: 1.147320, loss_ss: 0.765262, loss_d: 0.382058
0.6163 --- loss: 1.163415, loss_ss: 0.783287, loss_d: 0.380128
0.6549 --- loss: 1.644168, loss_ss: 0.964004, loss_d: 0.680164
0.6934 --- loss: 1.046817, loss_ss: 0.939856, loss_d: 0.106961
0.7319 --- loss: 1.403625, loss_ss: 0.933927, loss_d: 0.469698
0.7704 --- loss: 1.135681, loss_ss: 0.884722, loss_d: 0.250959
0.8089 --- loss: 1.783637, loss_ss: 1.216962, loss_d: 0.566674
0.8475 --- loss: 1.569248, loss_ss: 1.106885, loss_d: 0.462363
0.8860 --- loss: 1.606136, loss_ss: 1.502978, loss_d: 0.103158
0.9245 --- loss: 1.331723, loss_ss: 1.020720, loss_d: 0.311003
0.9630 --- loss: 1.124163, loss_ss: 0.862988, loss_d: 0.261175
Epoch finished! Loss: 1.304157266055295
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.174710, loss_ss: 0.845919, loss_d: 0.328792
0.0385 --- loss: 1.382220, loss_ss: 1.082604, loss_d: 0.299617
0.0770 --- loss: 0.973924, loss_ss: 0.902550, loss_d: 0.071374
0.1156 --- loss: 1.504088, loss_ss: 0.915366, loss_d: 0.588722
0.1541 --- loss: 1.379194, loss_ss: 0.941972, loss_d: 0.437223
0.1926 --- loss: 1.321048, loss_ss: 1.128497, loss_d: 0.192551
0.2311 --- loss: 1.535609, loss_ss: 1.274355, loss_d: 0.261254
0.2696 --- loss: 1.546630, loss_ss: 1.320646, loss_d: 0.225984
0.3082 --- loss: 1.061793, loss_ss: 0.749188, loss_d: 0.312605
0.3467 --- loss: 1.440604, loss_ss: 1.003440, loss_d: 0.437164
0.3852 --- loss: 0.847949, loss_ss: 0.758415, loss_d: 0.089534
0.4237 --- loss: 1.692428, loss_ss: 1.347119, loss_d: 0.345309
0.4622 --- loss: 1.080288, loss_ss: 0.879070, loss_d: 0.201218
0.5008 --- loss: 1.079779, loss_ss: 0.756592, loss_d: 0.323188
0.5393 --- loss: 1.095929, loss_ss: 0.801224, loss_d: 0.294705
0.5778 --- loss: 1.180493, loss_ss: 0.935581, loss_d: 0.244912
0.6163 --- loss: 1.043474, loss_ss: 0.837317, loss_d: 0.206157
0.6549 --- loss: 1.869625, loss_ss: 1.025156, loss_d: 0.844469
0.6934 --- loss: 1.423362, loss_ss: 1.065224, loss_d: 0.358138
0.7319 --- loss: 1.469594, loss_ss: 1.360363, loss_d: 0.109232
0.7704 --- loss: 1.182397, loss_ss: 0.862004, loss_d: 0.320393
0.8089 --- loss: 1.106443, loss_ss: 0.978000, loss_d: 0.128442
0.8475 --- loss: 1.733262, loss_ss: 1.145494, loss_d: 0.587767
0.8860 --- loss: 0.927855, loss_ss: 0.877240, loss_d: 0.050615
0.9245 --- loss: 1.369654, loss_ss: 1.021216, loss_d: 0.348438
0.9630 --- loss: 1.029425, loss_ss: 0.756206, loss_d: 0.273220
Epoch finished! Loss: 1.2266041677891057
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.035555, loss_ss: 0.959018, loss_d: 0.076536
0.0385 --- loss: 0.990309, loss_ss: 0.792619, loss_d: 0.197690
0.0770 --- loss: 1.579631, loss_ss: 0.844662, loss_d: 0.734969
0.1156 --- loss: 0.767492, loss_ss: 0.679777, loss_d: 0.087715
0.1541 --- loss: 1.365341, loss_ss: 1.003863, loss_d: 0.361477
0.1926 --- loss: 1.198237, loss_ss: 0.901699, loss_d: 0.296538
0.2311 --- loss: 1.136128, loss_ss: 0.993804, loss_d: 0.142324
0.2696 --- loss: 1.221565, loss_ss: 1.017457, loss_d: 0.204108
0.3082 --- loss: 1.234577, loss_ss: 0.756737, loss_d: 0.477840
0.3467 --- loss: 1.108546, loss_ss: 0.967627, loss_d: 0.140919
0.3852 --- loss: 1.092789, loss_ss: 1.012619, loss_d: 0.080170
0.4237 --- loss: 1.028746, loss_ss: 0.877427, loss_d: 0.151319
0.4622 --- loss: 1.854360, loss_ss: 1.630550, loss_d: 0.223810
0.5008 --- loss: 1.186603, loss_ss: 1.046397, loss_d: 0.140206
0.5393 --- loss: 1.327891, loss_ss: 1.134663, loss_d: 0.193228
0.5778 --- loss: 1.545774, loss_ss: 0.942575, loss_d: 0.603199
0.6163 --- loss: 1.167546, loss_ss: 0.952528, loss_d: 0.215018
0.6549 --- loss: 1.152909, loss_ss: 0.968540, loss_d: 0.184369
0.6934 --- loss: 1.016498, loss_ss: 0.853685, loss_d: 0.162813
0.7319 --- loss: 0.997149, loss_ss: 0.922936, loss_d: 0.074213
0.7704 --- loss: 0.823162, loss_ss: 0.674453, loss_d: 0.148709
0.8089 --- loss: 1.090081, loss_ss: 0.811620, loss_d: 0.278461
0.8475 --- loss: 1.024539, loss_ss: 0.954666, loss_d: 0.069873
0.8860 --- loss: 1.227752, loss_ss: 1.141685, loss_d: 0.086067
0.9245 --- loss: 1.298650, loss_ss: 0.974554, loss_d: 0.324096
0.9630 --- loss: 1.024113, loss_ss: 0.670024, loss_d: 0.354089
Epoch finished! Loss: 1.1711875105916763
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.000297, loss_ss: 0.656761, loss_d: 0.343536
0.0385 --- loss: 0.930784, loss_ss: 0.846291, loss_d: 0.084493
0.0770 --- loss: 0.922400, loss_ss: 0.880756, loss_d: 0.041644
0.1156 --- loss: 1.460142, loss_ss: 1.126516, loss_d: 0.333626
0.1541 --- loss: 0.710075, loss_ss: 0.619182, loss_d: 0.090893
0.1926 --- loss: 0.963372, loss_ss: 0.702781, loss_d: 0.260591
0.2311 --- loss: 1.416470, loss_ss: 1.127831, loss_d: 0.288639
0.2696 --- loss: 0.755983, loss_ss: 0.695022, loss_d: 0.060961
0.3082 --- loss: 1.821365, loss_ss: 1.052631, loss_d: 0.768734
0.3467 --- loss: 0.965344, loss_ss: 0.902989, loss_d: 0.062355
0.3852 --- loss: 1.297201, loss_ss: 0.933190, loss_d: 0.364011
0.4237 --- loss: 1.232901, loss_ss: 0.984113, loss_d: 0.248787
0.4622 --- loss: 1.087135, loss_ss: 0.967988, loss_d: 0.119146
0.5008 --- loss: 0.993185, loss_ss: 0.933087, loss_d: 0.060098
0.5393 --- loss: 1.198521, loss_ss: 1.101180, loss_d: 0.097340
0.5778 --- loss: 0.918720, loss_ss: 0.846761, loss_d: 0.071960
0.6163 --- loss: 1.310469, loss_ss: 0.937257, loss_d: 0.373212
0.6549 --- loss: 0.988630, loss_ss: 0.729739, loss_d: 0.258891
0.6934 --- loss: 1.127949, loss_ss: 1.087528, loss_d: 0.040421
0.7319 --- loss: 1.201899, loss_ss: 1.027688, loss_d: 0.174211
0.7704 --- loss: 0.824629, loss_ss: 0.761362, loss_d: 0.063266
0.8089 --- loss: 1.302908, loss_ss: 0.940240, loss_d: 0.362668
0.8475 --- loss: 1.682393, loss_ss: 0.790095, loss_d: 0.892298
0.8860 --- loss: 0.906064, loss_ss: 0.654285, loss_d: 0.251779
0.9245 --- loss: 0.915390, loss_ss: 0.747863, loss_d: 0.167527
0.9630 --- loss: 1.104861, loss_ss: 0.915074, loss_d: 0.189786
Epoch finished! Loss: 1.1094510601294088
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.015988, loss_ss: 0.712309, loss_d: 0.303679
0.0385 --- loss: 1.076160, loss_ss: 1.023024, loss_d: 0.053136
0.0770 --- loss: 1.167181, loss_ss: 1.043292, loss_d: 0.123889
0.1156 --- loss: 1.118624, loss_ss: 0.735931, loss_d: 0.382693
0.1541 --- loss: 1.278312, loss_ss: 1.029200, loss_d: 0.249111
0.1926 --- loss: 1.286565, loss_ss: 0.868536, loss_d: 0.418029
0.2311 --- loss: 1.135197, loss_ss: 0.902771, loss_d: 0.232426
0.2696 --- loss: 0.895082, loss_ss: 0.633520, loss_d: 0.261562
0.3082 --- loss: 0.921110, loss_ss: 0.722795, loss_d: 0.198315
0.3467 --- loss: 0.977404, loss_ss: 0.795421, loss_d: 0.181982
0.3852 --- loss: 1.072223, loss_ss: 1.048502, loss_d: 0.023721
0.4237 --- loss: 1.234801, loss_ss: 0.917419, loss_d: 0.317382
0.4622 --- loss: 1.022976, loss_ss: 0.657802, loss_d: 0.365175
0.5008 --- loss: 1.200574, loss_ss: 1.113174, loss_d: 0.087400
0.5393 --- loss: 1.018444, loss_ss: 1.002199, loss_d: 0.016245
0.5778 --- loss: 1.052473, loss_ss: 0.972990, loss_d: 0.079483
0.6163 --- loss: 1.176281, loss_ss: 0.747533, loss_d: 0.428748
0.6549 --- loss: 1.063197, loss_ss: 0.895834, loss_d: 0.167364
0.6934 --- loss: 1.475154, loss_ss: 1.272729, loss_d: 0.202425
0.7319 --- loss: 0.721385, loss_ss: 0.527512, loss_d: 0.193874
0.7704 --- loss: 0.882753, loss_ss: 0.804074, loss_d: 0.078680
0.8089 --- loss: 0.992371, loss_ss: 0.886151, loss_d: 0.106220
0.8475 --- loss: 1.150068, loss_ss: 1.041669, loss_d: 0.108399
0.8860 --- loss: 0.697015, loss_ss: 0.683932, loss_d: 0.013082
0.9245 --- loss: 1.285062, loss_ss: 1.030204, loss_d: 0.254858
0.9630 --- loss: 0.859980, loss_ss: 0.677912, loss_d: 0.182068
Epoch finished! Loss: 1.0766663348812855
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.875839, loss_ss: 0.817957, loss_d: 0.057882
0.0385 --- loss: 0.802526, loss_ss: 0.627908, loss_d: 0.174617
0.0770 --- loss: 0.856567, loss_ss: 0.818924, loss_d: 0.037643
0.1156 --- loss: 1.021840, loss_ss: 0.906464, loss_d: 0.115376
0.1541 --- loss: 1.877069, loss_ss: 0.559294, loss_d: 1.317775
0.1926 --- loss: 0.897518, loss_ss: 0.726161, loss_d: 0.171356
0.2311 --- loss: 1.069558, loss_ss: 1.042196, loss_d: 0.027362
0.2696 --- loss: 1.961522, loss_ss: 0.862854, loss_d: 1.098667
0.3082 --- loss: 0.886881, loss_ss: 0.771696, loss_d: 0.115184
0.3467 --- loss: 0.925242, loss_ss: 0.805789, loss_d: 0.119453
0.3852 --- loss: 1.286564, loss_ss: 1.153947, loss_d: 0.132616
0.4237 --- loss: 1.110907, loss_ss: 1.024028, loss_d: 0.086879
0.4622 --- loss: 1.088175, loss_ss: 1.050974, loss_d: 0.037201
0.5008 --- loss: 1.124579, loss_ss: 1.072908, loss_d: 0.051671
0.5393 --- loss: 1.491083, loss_ss: 1.118325, loss_d: 0.372758
0.5778 --- loss: 0.764135, loss_ss: 0.618888, loss_d: 0.145246
0.6163 --- loss: 0.966401, loss_ss: 0.913992, loss_d: 0.052409
0.6549 --- loss: 1.010819, loss_ss: 0.824715, loss_d: 0.186104
0.6934 --- loss: 0.906876, loss_ss: 0.658473, loss_d: 0.248403
0.7319 --- loss: 1.258644, loss_ss: 0.970328, loss_d: 0.288315
0.7704 --- loss: 0.957686, loss_ss: 0.704894, loss_d: 0.252792
0.8089 --- loss: 0.910090, loss_ss: 0.756818, loss_d: 0.153272
0.8475 --- loss: 0.955792, loss_ss: 0.827887, loss_d: 0.127905
0.8860 --- loss: 0.610265, loss_ss: 0.551628, loss_d: 0.058637
0.9245 --- loss: 1.016898, loss_ss: 0.829334, loss_d: 0.187564
0.9630 --- loss: 1.861472, loss_ss: 1.226175, loss_d: 0.635297
Epoch finished! Loss: 1.0301261537323587
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.985633, loss_ss: 0.764715, loss_d: 0.220918
0.0385 --- loss: 0.996074, loss_ss: 0.865339, loss_d: 0.130734
0.0770 --- loss: 0.980320, loss_ss: 0.903257, loss_d: 0.077063
0.1156 --- loss: 0.785392, loss_ss: 0.744533, loss_d: 0.040859
0.1541 --- loss: 1.045389, loss_ss: 0.870495, loss_d: 0.174895
0.1926 --- loss: 0.710674, loss_ss: 0.600596, loss_d: 0.110078
0.2311 --- loss: 1.053680, loss_ss: 0.987776, loss_d: 0.065905
0.2696 --- loss: 0.849423, loss_ss: 0.756560, loss_d: 0.092863
0.3082 --- loss: 0.746023, loss_ss: 0.711045, loss_d: 0.034979
0.3467 --- loss: 0.904746, loss_ss: 0.863089, loss_d: 0.041657
0.3852 --- loss: 0.792300, loss_ss: 0.772360, loss_d: 0.019939
0.4237 --- loss: 0.937119, loss_ss: 0.891836, loss_d: 0.045284
0.4622 --- loss: 0.873923, loss_ss: 0.793650, loss_d: 0.080273
0.5008 --- loss: 0.702508, loss_ss: 0.514615, loss_d: 0.187892
0.5393 --- loss: 0.705238, loss_ss: 0.653980, loss_d: 0.051258
0.5778 --- loss: 0.964697, loss_ss: 0.824295, loss_d: 0.140402
0.6163 --- loss: 0.721806, loss_ss: 0.676301, loss_d: 0.045505
0.6549 --- loss: 0.611600, loss_ss: 0.598989, loss_d: 0.012611
0.6934 --- loss: 0.963879, loss_ss: 0.677825, loss_d: 0.286054
0.7319 --- loss: 0.927970, loss_ss: 0.909247, loss_d: 0.018723
0.7704 --- loss: 0.858393, loss_ss: 0.767699, loss_d: 0.090694
0.8089 --- loss: 0.567571, loss_ss: 0.531223, loss_d: 0.036348
0.8475 --- loss: 0.928051, loss_ss: 0.910173, loss_d: 0.017878
0.8860 --- loss: 1.075888, loss_ss: 0.715544, loss_d: 0.360344
0.9245 --- loss: 1.134810, loss_ss: 0.804430, loss_d: 0.330380
0.9630 --- loss: 1.322480, loss_ss: 0.993198, loss_d: 0.329282
Epoch finished! Loss: 0.9854515457245374
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.698900, loss_ss: 0.679869, loss_d: 0.019031
0.0385 --- loss: 1.498561, loss_ss: 0.860597, loss_d: 0.637964
0.0770 --- loss: 1.298028, loss_ss: 1.175021, loss_d: 0.123007
0.1156 --- loss: 1.018185, loss_ss: 0.927215, loss_d: 0.090971
0.1541 --- loss: 0.902797, loss_ss: 0.814607, loss_d: 0.088190
0.1926 --- loss: 0.833133, loss_ss: 0.737303, loss_d: 0.095830
0.2311 --- loss: 0.712192, loss_ss: 0.670546, loss_d: 0.041646
0.2696 --- loss: 0.657835, loss_ss: 0.572839, loss_d: 0.084996
0.3082 --- loss: 0.936742, loss_ss: 0.901814, loss_d: 0.034929
0.3467 --- loss: 1.098994, loss_ss: 0.699431, loss_d: 0.399563
0.3852 --- loss: 1.023938, loss_ss: 1.009283, loss_d: 0.014654
0.4237 --- loss: 0.919944, loss_ss: 0.666606, loss_d: 0.253337
0.4622 --- loss: 0.975940, loss_ss: 0.896515, loss_d: 0.079425
0.5008 --- loss: 0.939556, loss_ss: 0.900981, loss_d: 0.038576
0.5393 --- loss: 1.100981, loss_ss: 1.084444, loss_d: 0.016537
0.5778 --- loss: 0.750258, loss_ss: 0.722728, loss_d: 0.027530
0.6163 --- loss: 0.875510, loss_ss: 0.767557, loss_d: 0.107952
0.6549 --- loss: 0.930705, loss_ss: 0.719824, loss_d: 0.210882
0.6934 --- loss: 1.028558, loss_ss: 1.022636, loss_d: 0.005922
0.7319 --- loss: 1.111943, loss_ss: 1.099087, loss_d: 0.012856
0.7704 --- loss: 0.879212, loss_ss: 0.870551, loss_d: 0.008660
0.8089 --- loss: 0.609065, loss_ss: 0.575747, loss_d: 0.033319
0.8475 --- loss: 1.048499, loss_ss: 0.871007, loss_d: 0.177492
0.8860 --- loss: 1.410587, loss_ss: 0.821003, loss_d: 0.589584
0.9245 --- loss: 0.861576, loss_ss: 0.626592, loss_d: 0.234984
0.9630 --- loss: 1.120995, loss_ss: 1.039598, loss_d: 0.081397
Epoch finished! Loss: 0.9467333120268744
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7865079365079365
             precision    recall  f1-score   support

        0.0       0.74      0.98      0.84       297
        1.0       0.80      0.31      0.45       289
        2.0       0.79      0.88      0.83       330
        3.0       0.87      0.94      0.91       133
        4.0       0.80      0.93      0.86       211

avg / total       0.79      0.79      0.76      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.35  97.64   89.41  73.98     84.18
1  82.38  30.80   97.73  80.18     44.50
2  90.56  87.88   91.51  78.59     82.98
3  97.94  93.98   98.40  87.41     90.58
4  95.08  93.36   95.42  80.41     86.40
Total accuracy: 78.65%
Average sen: 80.73%
Average spec: 94.49%
Macro f1-score: 77.73%
Diagnosis acc on 15mins: 1.0
[0.99994636 0.99997556 0.99999487 0.99999976 0.99999928 0.99997485
 0.99999988 1.         1.         0.99999988 0.99999905 0.99999988
 0.99999547 0.99999857 0.99999976 0.99999976 0.99999869 0.99999654
 0.99999905 1.         1.         1.         0.99995363 0.99999523
 0.99995756 0.99999988 0.99965405 0.99999559 1.         0.99907482
 1.         1.         1.         1.         0.99997389 0.99998868
 0.99999952 0.99999928 0.99999988 0.99997199 0.99969256 0.99995077]
pred: 0.9999543939317975, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.517550, loss_ss: 1.830624, loss_d: 0.686926
0.0384 --- loss: 2.074494, loss_ss: 1.562350, loss_d: 0.512144
0.0768 --- loss: 2.047068, loss_ss: 1.467818, loss_d: 0.579250
0.1152 --- loss: 1.935723, loss_ss: 1.456914, loss_d: 0.478809
0.1536 --- loss: 2.137431, loss_ss: 1.481151, loss_d: 0.656280
0.1919 --- loss: 2.088719, loss_ss: 1.587847, loss_d: 0.500872
0.2303 --- loss: 2.012947, loss_ss: 1.478550, loss_d: 0.534397
0.2687 --- loss: 1.827292, loss_ss: 1.341439, loss_d: 0.485852
0.3071 --- loss: 1.938618, loss_ss: 1.318994, loss_d: 0.619624
0.3455 --- loss: 2.007710, loss_ss: 1.478199, loss_d: 0.529511
0.3839 --- loss: 1.885445, loss_ss: 1.456581, loss_d: 0.428865
0.4223 --- loss: 1.735792, loss_ss: 1.287879, loss_d: 0.447913
0.4607 --- loss: 1.746563, loss_ss: 1.323322, loss_d: 0.423241
0.4990 --- loss: 2.088708, loss_ss: 1.159669, loss_d: 0.929039
0.5374 --- loss: 1.950622, loss_ss: 1.442053, loss_d: 0.508570
0.5758 --- loss: 1.684283, loss_ss: 1.130762, loss_d: 0.553521
0.6142 --- loss: 1.670982, loss_ss: 1.356652, loss_d: 0.314330
0.6526 --- loss: 1.835201, loss_ss: 1.248161, loss_d: 0.587040
0.6910 --- loss: 1.993833, loss_ss: 1.438758, loss_d: 0.555075
0.7294 --- loss: 1.600533, loss_ss: 1.235038, loss_d: 0.365495
0.7678 --- loss: 1.758325, loss_ss: 1.276309, loss_d: 0.482016
0.8061 --- loss: 1.746342, loss_ss: 1.361737, loss_d: 0.384605
0.8445 --- loss: 1.658427, loss_ss: 1.359684, loss_d: 0.298743
0.8829 --- loss: 1.511830, loss_ss: 1.191904, loss_d: 0.319926
0.9213 --- loss: 1.506462, loss_ss: 1.309102, loss_d: 0.197360
0.9597 --- loss: 1.773369, loss_ss: 1.358674, loss_d: 0.414696
0.9981 --- loss: 1.483819, loss_ss: 1.316282, loss_d: 0.167536
Epoch finished! Loss: 1.914999227798902
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.683516, loss_ss: 1.159839, loss_d: 0.523676
0.0384 --- loss: 1.245668, loss_ss: 1.086677, loss_d: 0.158990
0.0768 --- loss: 1.464904, loss_ss: 1.208190, loss_d: 0.256714
0.1152 --- loss: 1.641038, loss_ss: 1.135551, loss_d: 0.505487
0.1536 --- loss: 1.850834, loss_ss: 1.187696, loss_d: 0.663138
0.1919 --- loss: 1.476763, loss_ss: 1.209913, loss_d: 0.266851
0.2303 --- loss: 1.660652, loss_ss: 1.471134, loss_d: 0.189518
0.2687 --- loss: 1.541695, loss_ss: 1.230357, loss_d: 0.311339
0.3071 --- loss: 1.259946, loss_ss: 1.089848, loss_d: 0.170098
0.3455 --- loss: 1.341111, loss_ss: 1.101861, loss_d: 0.239251
0.3839 --- loss: 1.292527, loss_ss: 1.160260, loss_d: 0.132266
0.4223 --- loss: 1.743180, loss_ss: 1.382230, loss_d: 0.360950
0.4607 --- loss: 1.415620, loss_ss: 1.146507, loss_d: 0.269112
0.4990 --- loss: 1.199195, loss_ss: 0.967424, loss_d: 0.231771
0.5374 --- loss: 1.391282, loss_ss: 1.019530, loss_d: 0.371752
0.5758 --- loss: 1.929434, loss_ss: 1.626630, loss_d: 0.302804
0.6142 --- loss: 1.391290, loss_ss: 1.184812, loss_d: 0.206478
0.6526 --- loss: 1.190007, loss_ss: 0.885579, loss_d: 0.304428
0.6910 --- loss: 2.571258, loss_ss: 1.596114, loss_d: 0.975144
0.7294 --- loss: 1.222268, loss_ss: 1.069342, loss_d: 0.152925
0.7678 --- loss: 1.791447, loss_ss: 1.138648, loss_d: 0.652799
0.8061 --- loss: 1.425464, loss_ss: 1.250000, loss_d: 0.175464
0.8445 --- loss: 1.353763, loss_ss: 1.103098, loss_d: 0.250665
0.8829 --- loss: 1.201554, loss_ss: 0.962608, loss_d: 0.238946
0.9213 --- loss: 1.305953, loss_ss: 1.236815, loss_d: 0.069137
0.9597 --- loss: 1.158476, loss_ss: 1.030502, loss_d: 0.127974
0.9981 --- loss: 1.500893, loss_ss: 1.431845, loss_d: 0.069048
Epoch finished! Loss: 1.4994285001204564
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.389674, loss_ss: 1.214907, loss_d: 0.174766
0.0384 --- loss: 1.160599, loss_ss: 0.971804, loss_d: 0.188795
0.0768 --- loss: 1.229552, loss_ss: 0.989815, loss_d: 0.239737
0.1152 --- loss: 1.617084, loss_ss: 1.255262, loss_d: 0.361822
0.1536 --- loss: 1.455422, loss_ss: 1.237323, loss_d: 0.218099
0.1919 --- loss: 1.357105, loss_ss: 0.897699, loss_d: 0.459405
0.2303 --- loss: 1.527003, loss_ss: 1.227453, loss_d: 0.299550
0.2687 --- loss: 0.992281, loss_ss: 0.868014, loss_d: 0.124266
0.3071 --- loss: 1.172133, loss_ss: 0.902825, loss_d: 0.269308
0.3455 --- loss: 1.254905, loss_ss: 1.144187, loss_d: 0.110718
0.3839 --- loss: 1.454989, loss_ss: 1.203032, loss_d: 0.251957
0.4223 --- loss: 1.357926, loss_ss: 0.965926, loss_d: 0.392000
0.4607 --- loss: 1.511820, loss_ss: 1.022522, loss_d: 0.489298
0.4990 --- loss: 1.604750, loss_ss: 1.185147, loss_d: 0.419604
0.5374 --- loss: 1.555289, loss_ss: 0.982020, loss_d: 0.573269
0.5758 --- loss: 1.389556, loss_ss: 1.128684, loss_d: 0.260872
0.6142 --- loss: 1.199297, loss_ss: 1.101200, loss_d: 0.098097
0.6526 --- loss: 1.574333, loss_ss: 1.175587, loss_d: 0.398746
0.6910 --- loss: 1.072734, loss_ss: 0.906013, loss_d: 0.166720
0.7294 --- loss: 0.981002, loss_ss: 0.842875, loss_d: 0.138127
0.7678 --- loss: 1.946252, loss_ss: 1.150043, loss_d: 0.796208
0.8061 --- loss: 1.424272, loss_ss: 1.027055, loss_d: 0.397217
0.8445 --- loss: 1.210250, loss_ss: 1.055987, loss_d: 0.154263
0.8829 --- loss: 1.060086, loss_ss: 0.898254, loss_d: 0.161832
0.9213 --- loss: 1.015788, loss_ss: 0.927276, loss_d: 0.088513
0.9597 --- loss: 1.034727, loss_ss: 0.971565, loss_d: 0.063162
0.9981 --- loss: 1.329213, loss_ss: 1.013729, loss_d: 0.315485
Epoch finished! Loss: 1.364255628677515
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.643177, loss_ss: 0.865968, loss_d: 0.777209
0.0384 --- loss: 1.320742, loss_ss: 0.998327, loss_d: 0.322415
0.0768 --- loss: 1.548540, loss_ss: 1.050457, loss_d: 0.498083
0.1152 --- loss: 1.536425, loss_ss: 1.262056, loss_d: 0.274369
0.1536 --- loss: 1.159509, loss_ss: 0.832607, loss_d: 0.326902
0.1919 --- loss: 1.033807, loss_ss: 0.704242, loss_d: 0.329565
0.2303 --- loss: 1.324622, loss_ss: 1.119153, loss_d: 0.205469
0.2687 --- loss: 1.209276, loss_ss: 1.114149, loss_d: 0.095126
0.3071 --- loss: 0.810384, loss_ss: 0.731943, loss_d: 0.078441
0.3455 --- loss: 1.317401, loss_ss: 1.044502, loss_d: 0.272899
0.3839 --- loss: 1.452091, loss_ss: 1.406268, loss_d: 0.045823
0.4223 --- loss: 0.996563, loss_ss: 0.913779, loss_d: 0.082783
0.4607 --- loss: 1.069853, loss_ss: 0.953665, loss_d: 0.116188
0.4990 --- loss: 1.555632, loss_ss: 1.100314, loss_d: 0.455318
0.5374 --- loss: 1.205002, loss_ss: 0.992456, loss_d: 0.212546
0.5758 --- loss: 1.167811, loss_ss: 1.023741, loss_d: 0.144069
0.6142 --- loss: 1.081421, loss_ss: 0.862193, loss_d: 0.219228
0.6526 --- loss: 1.287409, loss_ss: 1.170802, loss_d: 0.116607
0.6910 --- loss: 1.237013, loss_ss: 0.950867, loss_d: 0.286147
0.7294 --- loss: 1.089682, loss_ss: 0.904116, loss_d: 0.185566
0.7678 --- loss: 1.128362, loss_ss: 0.972315, loss_d: 0.156046
0.8061 --- loss: 1.185270, loss_ss: 0.981516, loss_d: 0.203754
0.8445 --- loss: 0.914366, loss_ss: 0.833402, loss_d: 0.080964
0.8829 --- loss: 1.440287, loss_ss: 0.857073, loss_d: 0.583215
0.9213 --- loss: 1.053577, loss_ss: 1.011209, loss_d: 0.042369
0.9597 --- loss: 1.384845, loss_ss: 1.033198, loss_d: 0.351648
0.9981 --- loss: 1.789858, loss_ss: 1.726718, loss_d: 0.063140
Epoch finished! Loss: 1.2587713081103105
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.895190, loss_ss: 0.844509, loss_d: 0.050681
0.0384 --- loss: 1.274409, loss_ss: 1.080166, loss_d: 0.194243
0.0768 --- loss: 0.845887, loss_ss: 0.712284, loss_d: 0.133603
0.1152 --- loss: 1.121463, loss_ss: 0.814222, loss_d: 0.307242
0.1536 --- loss: 1.147891, loss_ss: 1.057376, loss_d: 0.090515
0.1919 --- loss: 0.895074, loss_ss: 0.823016, loss_d: 0.072058
0.2303 --- loss: 1.337009, loss_ss: 1.088186, loss_d: 0.248824
0.2687 --- loss: 1.122720, loss_ss: 0.846116, loss_d: 0.276604
0.3071 --- loss: 1.128884, loss_ss: 0.979296, loss_d: 0.149588
0.3455 --- loss: 1.192196, loss_ss: 1.095911, loss_d: 0.096285
0.3839 --- loss: 1.084382, loss_ss: 0.962927, loss_d: 0.121455
0.4223 --- loss: 1.399575, loss_ss: 1.309334, loss_d: 0.090241
0.4607 --- loss: 0.953760, loss_ss: 0.893042, loss_d: 0.060718
0.4990 --- loss: 1.549953, loss_ss: 0.868235, loss_d: 0.681718
0.5374 --- loss: 1.272593, loss_ss: 1.086683, loss_d: 0.185910
0.5758 --- loss: 1.314096, loss_ss: 1.099548, loss_d: 0.214548
0.6142 --- loss: 1.175244, loss_ss: 1.042357, loss_d: 0.132887
0.6526 --- loss: 1.095550, loss_ss: 1.025164, loss_d: 0.070386
0.6910 --- loss: 1.011574, loss_ss: 0.842400, loss_d: 0.169175
0.7294 --- loss: 0.702619, loss_ss: 0.671737, loss_d: 0.030882
0.7678 --- loss: 1.281571, loss_ss: 1.009580, loss_d: 0.271990
0.8061 --- loss: 1.120501, loss_ss: 1.104231, loss_d: 0.016270
0.8445 --- loss: 1.332404, loss_ss: 1.046610, loss_d: 0.285794
0.8829 --- loss: 1.174508, loss_ss: 1.154802, loss_d: 0.019706
0.9213 --- loss: 0.908841, loss_ss: 0.817809, loss_d: 0.091032
0.9597 --- loss: 2.369227, loss_ss: 1.769663, loss_d: 0.599564
0.9981 --- loss: 1.307595, loss_ss: 1.131486, loss_d: 0.176109
Epoch finished! Loss: 1.1706330246650256
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.154353, loss_ss: 0.911325, loss_d: 0.243028
0.0384 --- loss: 1.452719, loss_ss: 1.063869, loss_d: 0.388849
0.0768 --- loss: 1.122289, loss_ss: 1.003523, loss_d: 0.118767
0.1152 --- loss: 0.752129, loss_ss: 0.734558, loss_d: 0.017571
0.1536 --- loss: 1.361361, loss_ss: 0.875216, loss_d: 0.486146
0.1919 --- loss: 1.018753, loss_ss: 0.856980, loss_d: 0.161773
0.2303 --- loss: 1.068627, loss_ss: 1.008280, loss_d: 0.060347
0.2687 --- loss: 1.047443, loss_ss: 0.930465, loss_d: 0.116978
0.3071 --- loss: 0.828499, loss_ss: 0.802021, loss_d: 0.026478
0.3455 --- loss: 0.906953, loss_ss: 0.830532, loss_d: 0.076421
0.3839 --- loss: 1.039145, loss_ss: 0.967740, loss_d: 0.071405
0.4223 --- loss: 1.066742, loss_ss: 0.793761, loss_d: 0.272981
0.4607 --- loss: 0.865105, loss_ss: 0.829898, loss_d: 0.035206
0.4990 --- loss: 1.079801, loss_ss: 0.904033, loss_d: 0.175767
0.5374 --- loss: 1.173757, loss_ss: 1.030565, loss_d: 0.143193
0.5758 --- loss: 1.019089, loss_ss: 0.810960, loss_d: 0.208129
0.6142 --- loss: 0.920694, loss_ss: 0.855065, loss_d: 0.065629
0.6526 --- loss: 0.896938, loss_ss: 0.804008, loss_d: 0.092931
0.6910 --- loss: 1.089919, loss_ss: 0.885281, loss_d: 0.204638
0.7294 --- loss: 1.024548, loss_ss: 0.916936, loss_d: 0.107612
0.7678 --- loss: 1.346361, loss_ss: 1.098492, loss_d: 0.247868
0.8061 --- loss: 0.999187, loss_ss: 0.861707, loss_d: 0.137479
0.8445 --- loss: 0.924236, loss_ss: 0.860088, loss_d: 0.064148
0.8829 --- loss: 1.020619, loss_ss: 0.984052, loss_d: 0.036567
0.9213 --- loss: 1.083572, loss_ss: 0.940469, loss_d: 0.143102
0.9597 --- loss: 1.130952, loss_ss: 0.869350, loss_d: 0.261601
0.9981 --- loss: 1.391920, loss_ss: 1.183596, loss_d: 0.208324
Epoch finished! Loss: 1.0954887942625926
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.021488, loss_ss: 0.665446, loss_d: 0.356042
0.0384 --- loss: 1.179768, loss_ss: 0.941511, loss_d: 0.238257
0.0768 --- loss: 1.027477, loss_ss: 0.837388, loss_d: 0.190089
0.1152 --- loss: 1.118425, loss_ss: 1.072106, loss_d: 0.046319
0.1536 --- loss: 1.017892, loss_ss: 0.907100, loss_d: 0.110792
0.1919 --- loss: 1.326755, loss_ss: 0.885040, loss_d: 0.441715
0.2303 --- loss: 0.892427, loss_ss: 0.692337, loss_d: 0.200091
0.2687 --- loss: 1.186949, loss_ss: 0.801588, loss_d: 0.385361
0.3071 --- loss: 1.044345, loss_ss: 0.938497, loss_d: 0.105848
0.3455 --- loss: 0.985989, loss_ss: 0.754095, loss_d: 0.231894
0.3839 --- loss: 1.149970, loss_ss: 1.018707, loss_d: 0.131262
0.4223 --- loss: 1.179504, loss_ss: 1.158799, loss_d: 0.020705
0.4607 --- loss: 1.375058, loss_ss: 1.029433, loss_d: 0.345626
0.4990 --- loss: 0.812995, loss_ss: 0.761390, loss_d: 0.051606
0.5374 --- loss: 0.833865, loss_ss: 0.757802, loss_d: 0.076063
0.5758 --- loss: 0.852306, loss_ss: 0.800853, loss_d: 0.051453
0.6142 --- loss: 1.009911, loss_ss: 0.758406, loss_d: 0.251504
0.6526 --- loss: 0.633118, loss_ss: 0.534547, loss_d: 0.098570
0.6910 --- loss: 0.661939, loss_ss: 0.619661, loss_d: 0.042278
0.7294 --- loss: 1.166655, loss_ss: 0.855519, loss_d: 0.311137
0.7678 --- loss: 0.919966, loss_ss: 0.866589, loss_d: 0.053377
0.8061 --- loss: 0.769353, loss_ss: 0.752613, loss_d: 0.016740
0.8445 --- loss: 1.002444, loss_ss: 0.972848, loss_d: 0.029596
0.8829 --- loss: 1.258889, loss_ss: 0.720933, loss_d: 0.537956
0.9213 --- loss: 1.133203, loss_ss: 1.074366, loss_d: 0.058837
0.9597 --- loss: 1.077130, loss_ss: 0.936887, loss_d: 0.140243
0.9981 --- loss: 0.780697, loss_ss: 0.465721, loss_d: 0.314977
Epoch finished! Loss: 1.0888673181717212
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.396626, loss_ss: 1.064390, loss_d: 0.332236
0.0384 --- loss: 0.848817, loss_ss: 0.789637, loss_d: 0.059180
0.0768 --- loss: 0.988943, loss_ss: 0.916620, loss_d: 0.072323
0.1152 --- loss: 1.135947, loss_ss: 1.091021, loss_d: 0.044927
0.1536 --- loss: 1.118858, loss_ss: 0.971867, loss_d: 0.146991
0.1919 --- loss: 1.056230, loss_ss: 0.774377, loss_d: 0.281853
0.2303 --- loss: 0.871580, loss_ss: 0.815380, loss_d: 0.056201
0.2687 --- loss: 1.358690, loss_ss: 0.891910, loss_d: 0.466780
0.3071 --- loss: 0.675610, loss_ss: 0.658358, loss_d: 0.017252
0.3455 --- loss: 1.116235, loss_ss: 1.050630, loss_d: 0.065605
0.3839 --- loss: 1.127430, loss_ss: 1.116642, loss_d: 0.010788
0.4223 --- loss: 0.698750, loss_ss: 0.627787, loss_d: 0.070963
0.4607 --- loss: 0.962085, loss_ss: 0.960991, loss_d: 0.001094
0.4990 --- loss: 1.025524, loss_ss: 1.005053, loss_d: 0.020471
0.5374 --- loss: 1.141279, loss_ss: 1.007534, loss_d: 0.133745
0.5758 --- loss: 1.238374, loss_ss: 1.213755, loss_d: 0.024619
0.6142 --- loss: 0.744249, loss_ss: 0.723050, loss_d: 0.021199
0.6526 --- loss: 0.813698, loss_ss: 0.799568, loss_d: 0.014130
0.6910 --- loss: 0.679599, loss_ss: 0.662311, loss_d: 0.017288
0.7294 --- loss: 0.936333, loss_ss: 0.873602, loss_d: 0.062730
0.7678 --- loss: 1.413786, loss_ss: 0.745855, loss_d: 0.667931
0.8061 --- loss: 1.158608, loss_ss: 1.073162, loss_d: 0.085446
0.8445 --- loss: 0.777375, loss_ss: 0.572877, loss_d: 0.204499
0.8829 --- loss: 0.893625, loss_ss: 0.780205, loss_d: 0.113419
0.9213 --- loss: 0.862266, loss_ss: 0.842803, loss_d: 0.019463
0.9597 --- loss: 0.970055, loss_ss: 0.953212, loss_d: 0.016842
0.9981 --- loss: 0.818280, loss_ss: 0.801554, loss_d: 0.016725
Epoch finished! Loss: 0.9967348504524964
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.054267, loss_ss: 0.927140, loss_d: 0.127128
0.0384 --- loss: 0.914152, loss_ss: 0.799161, loss_d: 0.114991
0.0768 --- loss: 0.769853, loss_ss: 0.724399, loss_d: 0.045454
0.1152 --- loss: 0.741566, loss_ss: 0.714526, loss_d: 0.027040
0.1536 --- loss: 1.191663, loss_ss: 0.895902, loss_d: 0.295761
0.1919 --- loss: 1.028329, loss_ss: 1.014709, loss_d: 0.013620
0.2303 --- loss: 0.780136, loss_ss: 0.767092, loss_d: 0.013044
0.2687 --- loss: 1.327603, loss_ss: 0.979200, loss_d: 0.348403
0.3071 --- loss: 0.884962, loss_ss: 0.849988, loss_d: 0.034973
0.3455 --- loss: 0.959538, loss_ss: 0.925500, loss_d: 0.034038
0.3839 --- loss: 0.989128, loss_ss: 0.944853, loss_d: 0.044276
0.4223 --- loss: 0.758902, loss_ss: 0.721099, loss_d: 0.037803
0.4607 --- loss: 0.693365, loss_ss: 0.671077, loss_d: 0.022288
0.4990 --- loss: 1.212967, loss_ss: 0.630563, loss_d: 0.582403
0.5374 --- loss: 1.299513, loss_ss: 0.960508, loss_d: 0.339005
0.5758 --- loss: 1.268042, loss_ss: 1.075422, loss_d: 0.192620
0.6142 --- loss: 1.643347, loss_ss: 1.379517, loss_d: 0.263830
0.6526 --- loss: 0.785852, loss_ss: 0.771490, loss_d: 0.014362
0.6910 --- loss: 0.878226, loss_ss: 0.827831, loss_d: 0.050396
0.7294 --- loss: 1.094270, loss_ss: 0.646572, loss_d: 0.447698
0.7678 --- loss: 0.930510, loss_ss: 0.824441, loss_d: 0.106069
0.8061 --- loss: 0.695049, loss_ss: 0.596917, loss_d: 0.098132
0.8445 --- loss: 1.094084, loss_ss: 0.736214, loss_d: 0.357870
0.8829 --- loss: 0.859034, loss_ss: 0.714878, loss_d: 0.144156
0.9213 --- loss: 0.911236, loss_ss: 0.852881, loss_d: 0.058356
0.9597 --- loss: 0.927248, loss_ss: 0.880733, loss_d: 0.046515
0.9981 --- loss: 1.866850, loss_ss: 1.809259, loss_d: 0.057591
Epoch finished! Loss: 0.967168028308795
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.914403, loss_ss: 0.749835, loss_d: 0.164567
0.0384 --- loss: 1.184057, loss_ss: 1.078170, loss_d: 0.105886
0.0768 --- loss: 0.635526, loss_ss: 0.593832, loss_d: 0.041694
0.1152 --- loss: 1.037294, loss_ss: 1.008856, loss_d: 0.028437
0.1536 --- loss: 0.703623, loss_ss: 0.680232, loss_d: 0.023392
0.1919 --- loss: 0.738963, loss_ss: 0.727600, loss_d: 0.011363
0.2303 --- loss: 0.812006, loss_ss: 0.617504, loss_d: 0.194502
0.2687 --- loss: 0.602537, loss_ss: 0.582035, loss_d: 0.020502
0.3071 --- loss: 0.645382, loss_ss: 0.595541, loss_d: 0.049840
0.3455 --- loss: 0.761747, loss_ss: 0.736565, loss_d: 0.025182
0.3839 --- loss: 0.744835, loss_ss: 0.661468, loss_d: 0.083367
0.4223 --- loss: 1.191526, loss_ss: 0.875127, loss_d: 0.316399
0.4607 --- loss: 0.859374, loss_ss: 0.856772, loss_d: 0.002601
0.4990 --- loss: 1.012953, loss_ss: 0.920629, loss_d: 0.092324
0.5374 --- loss: 0.914789, loss_ss: 0.814963, loss_d: 0.099826
0.5758 --- loss: 0.656753, loss_ss: 0.591013, loss_d: 0.065740
0.6142 --- loss: 1.015021, loss_ss: 1.009734, loss_d: 0.005287
0.6526 --- loss: 1.160889, loss_ss: 0.795964, loss_d: 0.364925
0.6910 --- loss: 0.867243, loss_ss: 0.807345, loss_d: 0.059897
0.7294 --- loss: 0.781335, loss_ss: 0.766948, loss_d: 0.014388
0.7678 --- loss: 0.985286, loss_ss: 0.971918, loss_d: 0.013368
0.8061 --- loss: 0.698207, loss_ss: 0.694242, loss_d: 0.003966
0.8445 --- loss: 0.870396, loss_ss: 0.798255, loss_d: 0.072141
0.8829 --- loss: 1.012113, loss_ss: 0.944206, loss_d: 0.067906
0.9213 --- loss: 1.185309, loss_ss: 1.182583, loss_d: 0.002726
0.9597 --- loss: 1.280516, loss_ss: 0.601789, loss_d: 0.678727
0.9981 --- loss: 0.959591, loss_ss: 0.669507, loss_d: 0.290085
Epoch finished! Loss: 0.9297205922695306
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5434343434343434
             precision    recall  f1-score   support

        0.0       0.68      0.83      0.75       237
        1.0       0.57      0.29      0.39       249
        2.0       0.44      0.52      0.48       210
        3.0       1.00      0.47      0.64       245
        4.0       0.21      0.88      0.34        49

avg / total       0.66      0.54      0.55       990
 


====== chp017-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  86.46  83.12   87.52   67.70     74.62
1  76.77  29.32   92.71   57.48     38.83
2  75.76  52.38   82.05   44.00     47.83
3  86.87  46.94  100.00  100.00     63.89
4  82.83  87.76   82.57   20.77     33.59
Total accuracy: 54.34%
Average sen: 59.90%
Average spec: 88.97%
Macro f1-score: 51.75%
Diagnosis acc on 15mins: 0.24242424242424243
[0.00758963 0.61258447 0.71729308 0.47800031 0.82031441 0.32466778
 0.12664059 0.05588747 0.01093793 0.11861511 0.00825964 0.00626036
 0.17688498 0.42785564 0.75886911 1.         0.99928206 1.
 0.02673419 0.0098844  0.08269294 0.68039471 0.17698532 0.11477428
 0.40681916 0.00734485 0.25641853 0.0198214  0.0554658  0.00934574
 0.00469184 0.06337755 0.05053519]
pred: 0.29137056038686726, label: 1
Wrong!!! Real Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.445539, loss_ss: 1.784584, loss_d: 0.660954
0.0384 --- loss: 2.220934, loss_ss: 1.437813, loss_d: 0.783122
0.0769 --- loss: 2.156442, loss_ss: 1.459867, loss_d: 0.696575
0.1153 --- loss: 2.143313, loss_ss: 1.549823, loss_d: 0.593490
0.1538 --- loss: 2.077546, loss_ss: 1.426113, loss_d: 0.651433
0.1922 --- loss: 2.053948, loss_ss: 1.500003, loss_d: 0.553945
0.2307 --- loss: 2.115818, loss_ss: 1.303797, loss_d: 0.812021
0.2691 --- loss: 2.010515, loss_ss: 1.489078, loss_d: 0.521438
0.3076 --- loss: 1.848953, loss_ss: 1.567425, loss_d: 0.281527
0.3460 --- loss: 1.836478, loss_ss: 1.320238, loss_d: 0.516240
0.3845 --- loss: 1.577676, loss_ss: 1.241598, loss_d: 0.336078
0.4229 --- loss: 1.864686, loss_ss: 1.263105, loss_d: 0.601581
0.4614 --- loss: 1.824530, loss_ss: 1.292234, loss_d: 0.532296
0.4998 --- loss: 1.762035, loss_ss: 1.321374, loss_d: 0.440660
0.5383 --- loss: 2.047693, loss_ss: 1.332060, loss_d: 0.715633
0.5767 --- loss: 1.616252, loss_ss: 1.211632, loss_d: 0.404620
0.6151 --- loss: 1.605574, loss_ss: 1.243479, loss_d: 0.362095
0.6536 --- loss: 1.603775, loss_ss: 1.198095, loss_d: 0.405680
0.6920 --- loss: 1.514571, loss_ss: 1.215504, loss_d: 0.299066
0.7305 --- loss: 1.628592, loss_ss: 1.469688, loss_d: 0.158905
0.7689 --- loss: 1.433477, loss_ss: 1.249363, loss_d: 0.184114
0.8074 --- loss: 1.534380, loss_ss: 1.228885, loss_d: 0.305494
0.8458 --- loss: 1.465109, loss_ss: 1.116034, loss_d: 0.349075
0.8843 --- loss: 1.403525, loss_ss: 1.224478, loss_d: 0.179048
0.9227 --- loss: 1.500710, loss_ss: 1.323792, loss_d: 0.176918
0.9612 --- loss: 1.933864, loss_ss: 1.273787, loss_d: 0.660077
0.9996 --- loss: 2.229216, loss_ss: 2.151676, loss_d: 0.077540
Epoch finished! Loss: 1.8614326967642858
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.791468, loss_ss: 0.987553, loss_d: 0.803915
0.0384 --- loss: 1.663714, loss_ss: 1.102931, loss_d: 0.560783
0.0769 --- loss: 1.400386, loss_ss: 1.120434, loss_d: 0.279952
0.1153 --- loss: 1.409803, loss_ss: 1.215276, loss_d: 0.194527
0.1538 --- loss: 1.587391, loss_ss: 1.329564, loss_d: 0.257827
0.1922 --- loss: 1.412117, loss_ss: 1.100033, loss_d: 0.312084
0.2307 --- loss: 1.711396, loss_ss: 1.252555, loss_d: 0.458841
0.2691 --- loss: 1.589089, loss_ss: 1.172559, loss_d: 0.416530
0.3076 --- loss: 1.320890, loss_ss: 1.208959, loss_d: 0.111931
0.3460 --- loss: 1.675786, loss_ss: 1.062087, loss_d: 0.613699
0.3845 --- loss: 1.567381, loss_ss: 1.327828, loss_d: 0.239553
0.4229 --- loss: 1.995377, loss_ss: 1.175878, loss_d: 0.819499
0.4614 --- loss: 1.417162, loss_ss: 1.050814, loss_d: 0.366349
0.4998 --- loss: 1.593276, loss_ss: 1.275281, loss_d: 0.317995
0.5383 --- loss: 1.781816, loss_ss: 1.027620, loss_d: 0.754197
0.5767 --- loss: 1.373250, loss_ss: 1.122608, loss_d: 0.250642
0.6151 --- loss: 1.360118, loss_ss: 1.054777, loss_d: 0.305341
0.6536 --- loss: 1.175292, loss_ss: 0.997593, loss_d: 0.177699
0.6920 --- loss: 1.276262, loss_ss: 1.023723, loss_d: 0.252539
0.7305 --- loss: 1.069768, loss_ss: 0.951782, loss_d: 0.117985
0.7689 --- loss: 1.506633, loss_ss: 0.959181, loss_d: 0.547452
0.8074 --- loss: 1.243629, loss_ss: 1.122439, loss_d: 0.121190
0.8458 --- loss: 1.182658, loss_ss: 1.109150, loss_d: 0.073508
0.8843 --- loss: 1.255627, loss_ss: 1.147738, loss_d: 0.107889
0.9227 --- loss: 1.203201, loss_ss: 1.094177, loss_d: 0.109023
0.9612 --- loss: 1.075248, loss_ss: 0.924998, loss_d: 0.150250
0.9996 --- loss: 1.529290, loss_ss: 1.511533, loss_d: 0.017757
Epoch finished! Loss: 1.4628168990978827
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.566297, loss_ss: 1.093297, loss_d: 0.473000
0.0384 --- loss: 1.339015, loss_ss: 1.070543, loss_d: 0.268473
0.0769 --- loss: 1.342506, loss_ss: 0.999339, loss_d: 0.343167
0.1153 --- loss: 1.448384, loss_ss: 1.081494, loss_d: 0.366890
0.1538 --- loss: 1.144066, loss_ss: 1.062344, loss_d: 0.081722
0.1922 --- loss: 1.034243, loss_ss: 0.914786, loss_d: 0.119457
0.2307 --- loss: 1.119783, loss_ss: 0.893137, loss_d: 0.226646
0.2691 --- loss: 1.298276, loss_ss: 1.148112, loss_d: 0.150164
0.3076 --- loss: 1.004177, loss_ss: 0.843765, loss_d: 0.160412
0.3460 --- loss: 1.479473, loss_ss: 1.090477, loss_d: 0.388996
0.3845 --- loss: 1.215199, loss_ss: 1.060833, loss_d: 0.154366
0.4229 --- loss: 1.021057, loss_ss: 0.793145, loss_d: 0.227912
0.4614 --- loss: 1.495180, loss_ss: 1.284081, loss_d: 0.211099
0.4998 --- loss: 1.186700, loss_ss: 0.879205, loss_d: 0.307495
0.5383 --- loss: 1.166098, loss_ss: 0.981156, loss_d: 0.184942
0.5767 --- loss: 1.411303, loss_ss: 0.951501, loss_d: 0.459801
0.6151 --- loss: 1.106852, loss_ss: 0.956047, loss_d: 0.150805
0.6536 --- loss: 1.308082, loss_ss: 0.993420, loss_d: 0.314662
0.6920 --- loss: 1.310298, loss_ss: 1.106237, loss_d: 0.204061
0.7305 --- loss: 1.229044, loss_ss: 0.802169, loss_d: 0.426875
0.7689 --- loss: 1.479213, loss_ss: 1.212333, loss_d: 0.266880
0.8074 --- loss: 1.055717, loss_ss: 0.924351, loss_d: 0.131366
0.8458 --- loss: 1.327816, loss_ss: 0.971835, loss_d: 0.355982
0.8843 --- loss: 0.980172, loss_ss: 0.900059, loss_d: 0.080113
0.9227 --- loss: 1.447211, loss_ss: 1.037679, loss_d: 0.409531
0.9612 --- loss: 1.234181, loss_ss: 0.872518, loss_d: 0.361663
0.9996 --- loss: 2.565307, loss_ss: 2.548136, loss_d: 0.017171
Epoch finished! Loss: 1.2620104622382384
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.393723, loss_ss: 1.151116, loss_d: 0.242607
0.0384 --- loss: 1.448397, loss_ss: 0.892733, loss_d: 0.555663
0.0769 --- loss: 1.422291, loss_ss: 1.304518, loss_d: 0.117773
0.1153 --- loss: 1.075685, loss_ss: 0.983044, loss_d: 0.092642
0.1538 --- loss: 1.056628, loss_ss: 0.852216, loss_d: 0.204413
0.1922 --- loss: 1.016825, loss_ss: 0.873684, loss_d: 0.143140
0.2307 --- loss: 0.926382, loss_ss: 0.827976, loss_d: 0.098407
0.2691 --- loss: 1.057432, loss_ss: 0.770223, loss_d: 0.287209
0.3076 --- loss: 1.112303, loss_ss: 0.821188, loss_d: 0.291115
0.3460 --- loss: 1.729366, loss_ss: 0.861345, loss_d: 0.868021
0.3845 --- loss: 1.111479, loss_ss: 0.994331, loss_d: 0.117148
0.4229 --- loss: 0.898744, loss_ss: 0.686772, loss_d: 0.211972
0.4614 --- loss: 0.744752, loss_ss: 0.685609, loss_d: 0.059143
0.4998 --- loss: 1.301277, loss_ss: 1.130475, loss_d: 0.170802
0.5383 --- loss: 0.906453, loss_ss: 0.865927, loss_d: 0.040526
0.5767 --- loss: 0.898849, loss_ss: 0.846835, loss_d: 0.052014
0.6151 --- loss: 1.546330, loss_ss: 0.846956, loss_d: 0.699375
0.6536 --- loss: 1.107411, loss_ss: 1.045833, loss_d: 0.061578
0.6920 --- loss: 1.264394, loss_ss: 0.946941, loss_d: 0.317453
0.7305 --- loss: 1.383203, loss_ss: 0.840760, loss_d: 0.542443
0.7689 --- loss: 1.055603, loss_ss: 0.839714, loss_d: 0.215889
0.8074 --- loss: 1.396097, loss_ss: 0.968838, loss_d: 0.427259
0.8458 --- loss: 1.015263, loss_ss: 0.716408, loss_d: 0.298855
0.8843 --- loss: 0.975573, loss_ss: 0.878917, loss_d: 0.096656
0.9227 --- loss: 1.107444, loss_ss: 1.046034, loss_d: 0.061409
0.9612 --- loss: 0.905163, loss_ss: 0.828593, loss_d: 0.076570
0.9996 --- loss: 1.073352, loss_ss: 1.067846, loss_d: 0.005506
Epoch finished! Loss: 1.173904677079274
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.387346, loss_ss: 0.793505, loss_d: 0.593841
0.0384 --- loss: 0.848649, loss_ss: 0.744041, loss_d: 0.104607
0.0769 --- loss: 0.883082, loss_ss: 0.747409, loss_d: 0.135673
0.1153 --- loss: 0.760733, loss_ss: 0.666183, loss_d: 0.094550
0.1538 --- loss: 1.153548, loss_ss: 0.755840, loss_d: 0.397708
0.1922 --- loss: 1.256360, loss_ss: 1.087207, loss_d: 0.169153
0.2307 --- loss: 1.188807, loss_ss: 0.817085, loss_d: 0.371722
0.2691 --- loss: 1.113818, loss_ss: 0.800366, loss_d: 0.313452
0.3076 --- loss: 1.306064, loss_ss: 1.232211, loss_d: 0.073853
0.3460 --- loss: 1.217119, loss_ss: 0.847275, loss_d: 0.369845
0.3845 --- loss: 0.906340, loss_ss: 0.836913, loss_d: 0.069427
0.4229 --- loss: 0.965758, loss_ss: 0.738997, loss_d: 0.226761
0.4614 --- loss: 1.992589, loss_ss: 1.353494, loss_d: 0.639095
0.4998 --- loss: 0.923759, loss_ss: 0.916288, loss_d: 0.007471
0.5383 --- loss: 1.270537, loss_ss: 1.163602, loss_d: 0.106934
0.5767 --- loss: 1.381032, loss_ss: 0.932271, loss_d: 0.448762
0.6151 --- loss: 1.076037, loss_ss: 0.938139, loss_d: 0.137898
0.6536 --- loss: 1.616520, loss_ss: 1.056577, loss_d: 0.559943
0.6920 --- loss: 0.969923, loss_ss: 0.723583, loss_d: 0.246341
0.7305 --- loss: 0.969249, loss_ss: 0.848001, loss_d: 0.121248
0.7689 --- loss: 0.948528, loss_ss: 0.878797, loss_d: 0.069731
0.8074 --- loss: 0.728763, loss_ss: 0.622439, loss_d: 0.106324
0.8458 --- loss: 1.592638, loss_ss: 1.149353, loss_d: 0.443285
0.8843 --- loss: 1.186090, loss_ss: 1.103852, loss_d: 0.082238
0.9227 --- loss: 0.939711, loss_ss: 0.802406, loss_d: 0.137304
0.9612 --- loss: 0.803962, loss_ss: 0.683343, loss_d: 0.120619
0.9996 --- loss: 2.800668, loss_ss: 2.796227, loss_d: 0.004441
Epoch finished! Loss: 1.0910882362952599
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.347766, loss_ss: 1.150273, loss_d: 0.197492
0.0384 --- loss: 1.153273, loss_ss: 0.941395, loss_d: 0.211878
0.0769 --- loss: 0.988571, loss_ss: 0.897545, loss_d: 0.091026
0.1153 --- loss: 0.973297, loss_ss: 0.955990, loss_d: 0.017307
0.1538 --- loss: 0.873193, loss_ss: 0.796545, loss_d: 0.076648
0.1922 --- loss: 0.870667, loss_ss: 0.820049, loss_d: 0.050618
0.2307 --- loss: 0.987983, loss_ss: 0.798364, loss_d: 0.189619
0.2691 --- loss: 0.902055, loss_ss: 0.864241, loss_d: 0.037814
0.3076 --- loss: 0.756498, loss_ss: 0.606313, loss_d: 0.150185
0.3460 --- loss: 0.821939, loss_ss: 0.792199, loss_d: 0.029739
0.3845 --- loss: 1.167228, loss_ss: 1.114732, loss_d: 0.052497
0.4229 --- loss: 1.010650, loss_ss: 0.916199, loss_d: 0.094451
0.4614 --- loss: 1.076681, loss_ss: 0.713753, loss_d: 0.362928
0.4998 --- loss: 0.928102, loss_ss: 0.767927, loss_d: 0.160175
0.5383 --- loss: 1.122955, loss_ss: 0.770755, loss_d: 0.352200
0.5767 --- loss: 1.100033, loss_ss: 1.024606, loss_d: 0.075426
0.6151 --- loss: 0.910457, loss_ss: 0.876586, loss_d: 0.033871
0.6536 --- loss: 0.845985, loss_ss: 0.820548, loss_d: 0.025437
0.6920 --- loss: 1.592483, loss_ss: 1.575145, loss_d: 0.017337
0.7305 --- loss: 1.355470, loss_ss: 0.938528, loss_d: 0.416942
0.7689 --- loss: 0.906187, loss_ss: 0.849743, loss_d: 0.056444
0.8074 --- loss: 0.889810, loss_ss: 0.854080, loss_d: 0.035730
0.8458 --- loss: 1.229284, loss_ss: 1.113495, loss_d: 0.115790
0.8843 --- loss: 1.253428, loss_ss: 0.898908, loss_d: 0.354520
0.9227 --- loss: 1.053558, loss_ss: 0.952447, loss_d: 0.101111
0.9612 --- loss: 1.035374, loss_ss: 0.792962, loss_d: 0.242412
0.9996 --- loss: 9.274437, loss_ss: 3.080676, loss_d: 6.193761
Epoch finished! Loss: 1.0569819040023363
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.932508, loss_ss: 0.882305, loss_d: 0.050204
0.0384 --- loss: 0.935040, loss_ss: 0.745238, loss_d: 0.189802
0.0769 --- loss: 0.883499, loss_ss: 0.790605, loss_d: 0.092893
0.1153 --- loss: 0.965578, loss_ss: 0.877525, loss_d: 0.088053
0.1538 --- loss: 1.453918, loss_ss: 1.102158, loss_d: 0.351761
0.1922 --- loss: 0.907359, loss_ss: 0.827121, loss_d: 0.080239
0.2307 --- loss: 1.181428, loss_ss: 0.834690, loss_d: 0.346738
0.2691 --- loss: 1.097157, loss_ss: 1.021163, loss_d: 0.075995
0.3076 --- loss: 0.807347, loss_ss: 0.801544, loss_d: 0.005802
0.3460 --- loss: 1.650280, loss_ss: 0.868220, loss_d: 0.782060
0.3845 --- loss: 1.078479, loss_ss: 0.974591, loss_d: 0.103888
0.4229 --- loss: 1.029091, loss_ss: 0.776644, loss_d: 0.252448
0.4614 --- loss: 0.894133, loss_ss: 0.806818, loss_d: 0.087315
0.4998 --- loss: 0.948927, loss_ss: 0.842427, loss_d: 0.106500
0.5383 --- loss: 1.238046, loss_ss: 1.022068, loss_d: 0.215978
0.5767 --- loss: 0.823031, loss_ss: 0.788261, loss_d: 0.034771
0.6151 --- loss: 0.821532, loss_ss: 0.744239, loss_d: 0.077292
0.6536 --- loss: 0.794607, loss_ss: 0.708903, loss_d: 0.085703
0.6920 --- loss: 0.853708, loss_ss: 0.757683, loss_d: 0.096025
0.7305 --- loss: 0.836572, loss_ss: 0.732651, loss_d: 0.103921
0.7689 --- loss: 0.913852, loss_ss: 0.782690, loss_d: 0.131162
0.8074 --- loss: 0.915696, loss_ss: 0.843246, loss_d: 0.072450
0.8458 --- loss: 0.828075, loss_ss: 0.725393, loss_d: 0.102682
0.8843 --- loss: 0.770872, loss_ss: 0.701696, loss_d: 0.069177
0.9227 --- loss: 0.946179, loss_ss: 0.855595, loss_d: 0.090584
0.9612 --- loss: 0.839958, loss_ss: 0.834101, loss_d: 0.005856
0.9996 --- loss: 2.433924, loss_ss: 2.432358, loss_d: 0.001567
Epoch finished! Loss: 1.0192540624966988
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.078281, loss_ss: 1.060013, loss_d: 0.018268
0.0384 --- loss: 1.110729, loss_ss: 0.891525, loss_d: 0.219204
0.0769 --- loss: 0.936157, loss_ss: 0.924546, loss_d: 0.011611
0.1153 --- loss: 0.899122, loss_ss: 0.778162, loss_d: 0.120959
0.1538 --- loss: 0.948123, loss_ss: 0.740990, loss_d: 0.207133
0.1922 --- loss: 0.843159, loss_ss: 0.815119, loss_d: 0.028039
0.2307 --- loss: 0.892359, loss_ss: 0.872411, loss_d: 0.019948
0.2691 --- loss: 0.761442, loss_ss: 0.752439, loss_d: 0.009003
0.3076 --- loss: 0.931155, loss_ss: 0.729974, loss_d: 0.201181
0.3460 --- loss: 0.761757, loss_ss: 0.736051, loss_d: 0.025706
0.3845 --- loss: 0.812648, loss_ss: 0.805255, loss_d: 0.007393
0.4229 --- loss: 0.963646, loss_ss: 0.912782, loss_d: 0.050864
0.4614 --- loss: 0.987029, loss_ss: 0.858467, loss_d: 0.128562
0.4998 --- loss: 1.327767, loss_ss: 0.756147, loss_d: 0.571621
0.5383 --- loss: 0.755351, loss_ss: 0.719339, loss_d: 0.036012
0.5767 --- loss: 1.184945, loss_ss: 0.835133, loss_d: 0.349812
0.6151 --- loss: 0.782328, loss_ss: 0.742189, loss_d: 0.040139
0.6536 --- loss: 1.119931, loss_ss: 1.112725, loss_d: 0.007206
0.6920 --- loss: 0.748204, loss_ss: 0.737909, loss_d: 0.010295
0.7305 --- loss: 0.806307, loss_ss: 0.754422, loss_d: 0.051885
0.7689 --- loss: 0.809434, loss_ss: 0.801553, loss_d: 0.007881
0.8074 --- loss: 0.845088, loss_ss: 0.727462, loss_d: 0.117626
0.8458 --- loss: 0.860882, loss_ss: 0.712183, loss_d: 0.148699
0.8843 --- loss: 0.856284, loss_ss: 0.617522, loss_d: 0.238762
0.9227 --- loss: 1.220781, loss_ss: 1.185176, loss_d: 0.035605
0.9612 --- loss: 0.971167, loss_ss: 0.757228, loss_d: 0.213939
0.9996 --- loss: 1.384569, loss_ss: 1.384344, loss_d: 0.000225
Epoch finished! Loss: 0.9733745893606773
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.778707, loss_ss: 0.766409, loss_d: 0.012299
0.0384 --- loss: 0.639091, loss_ss: 0.581539, loss_d: 0.057551
0.0769 --- loss: 0.842766, loss_ss: 0.805777, loss_d: 0.036989
0.1153 --- loss: 0.832489, loss_ss: 0.830252, loss_d: 0.002237
0.1538 --- loss: 1.241802, loss_ss: 0.871931, loss_d: 0.369871
0.1922 --- loss: 0.936298, loss_ss: 0.634651, loss_d: 0.301647
0.2307 --- loss: 0.743759, loss_ss: 0.672671, loss_d: 0.071087
0.2691 --- loss: 0.965844, loss_ss: 0.928050, loss_d: 0.037794
0.3076 --- loss: 0.879973, loss_ss: 0.832762, loss_d: 0.047211
0.3460 --- loss: 0.934849, loss_ss: 0.898791, loss_d: 0.036058
0.3845 --- loss: 0.642836, loss_ss: 0.636834, loss_d: 0.006002
0.4229 --- loss: 0.713261, loss_ss: 0.693428, loss_d: 0.019833
0.4614 --- loss: 0.795026, loss_ss: 0.753039, loss_d: 0.041987
0.4998 --- loss: 1.108436, loss_ss: 1.070164, loss_d: 0.038272
0.5383 --- loss: 0.946636, loss_ss: 0.937207, loss_d: 0.009429
0.5767 --- loss: 1.189052, loss_ss: 0.900113, loss_d: 0.288938
0.6151 --- loss: 0.983171, loss_ss: 0.939209, loss_d: 0.043962
0.6536 --- loss: 0.886514, loss_ss: 0.599868, loss_d: 0.286646
0.6920 --- loss: 1.207822, loss_ss: 1.047561, loss_d: 0.160260
0.7305 --- loss: 0.955891, loss_ss: 0.713325, loss_d: 0.242565
0.7689 --- loss: 0.861826, loss_ss: 0.795039, loss_d: 0.066787
0.8074 --- loss: 0.940679, loss_ss: 0.824620, loss_d: 0.116059
0.8458 --- loss: 0.835168, loss_ss: 0.631282, loss_d: 0.203886
0.8843 --- loss: 0.922887, loss_ss: 0.889370, loss_d: 0.033517
0.9227 --- loss: 1.075414, loss_ss: 1.068989, loss_d: 0.006425
0.9612 --- loss: 0.720410, loss_ss: 0.554017, loss_d: 0.166394
0.9996 --- loss: 1.994917, loss_ss: 1.994521, loss_d: 0.000396
Epoch finished! Loss: 0.9570341381889124
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.918579, loss_ss: 0.884217, loss_d: 0.034362
0.0384 --- loss: 0.463595, loss_ss: 0.455912, loss_d: 0.007682
0.0769 --- loss: 0.777911, loss_ss: 0.734899, loss_d: 0.043012
0.1153 --- loss: 0.830532, loss_ss: 0.823378, loss_d: 0.007154
0.1538 --- loss: 1.039247, loss_ss: 1.012484, loss_d: 0.026764
0.1922 --- loss: 0.897834, loss_ss: 0.859033, loss_d: 0.038801
0.2307 --- loss: 0.847852, loss_ss: 0.837009, loss_d: 0.010843
0.2691 --- loss: 1.168981, loss_ss: 0.988935, loss_d: 0.180046
0.3076 --- loss: 0.630501, loss_ss: 0.610349, loss_d: 0.020152
0.3460 --- loss: 1.157737, loss_ss: 0.974074, loss_d: 0.183663
0.3845 --- loss: 1.351917, loss_ss: 0.766977, loss_d: 0.584939
0.4229 --- loss: 0.587822, loss_ss: 0.547115, loss_d: 0.040707
0.4614 --- loss: 1.271632, loss_ss: 1.264334, loss_d: 0.007298
0.4998 --- loss: 1.180424, loss_ss: 1.133777, loss_d: 0.046647
0.5383 --- loss: 0.693802, loss_ss: 0.683448, loss_d: 0.010354
0.5767 --- loss: 0.995277, loss_ss: 0.986269, loss_d: 0.009008
0.6151 --- loss: 1.444267, loss_ss: 1.342866, loss_d: 0.101401
0.6536 --- loss: 1.160448, loss_ss: 1.048931, loss_d: 0.111516
0.6920 --- loss: 0.580676, loss_ss: 0.513267, loss_d: 0.067410
0.7305 --- loss: 0.918270, loss_ss: 0.860594, loss_d: 0.057676
0.7689 --- loss: 1.122139, loss_ss: 1.102394, loss_d: 0.019745
0.8074 --- loss: 0.908686, loss_ss: 0.749963, loss_d: 0.158723
0.8458 --- loss: 1.111470, loss_ss: 1.062019, loss_d: 0.049451
0.8843 --- loss: 0.844887, loss_ss: 0.805591, loss_d: 0.039296
0.9227 --- loss: 0.862801, loss_ss: 0.807935, loss_d: 0.054866
0.9612 --- loss: 1.088798, loss_ss: 0.940919, loss_d: 0.147879
0.9996 --- loss: 3.489753, loss_ss: 3.485427, loss_d: 0.004326
Epoch finished! Loss: 0.9215935177527941
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.709009009009009
             precision    recall  f1-score   support

        0.0       0.94      0.72      0.81       138
        1.0       0.50      0.02      0.05       123
        2.0       0.39      0.65      0.49       120
        3.0       1.00      0.68      0.81       363
        4.0       0.66      0.99      0.79       366

avg / total       0.76      0.71      0.68      1110
 


====== chp018-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.95  71.74   99.38  94.29     81.48
1  88.92   2.44   99.70  50.00      4.65
2  85.14  65.00   87.58  38.81     48.60
3  89.37  67.77   99.87  99.60     80.66
4  82.43  98.63   74.46  65.52     78.74
Total accuracy: 70.90%
Average sen: 61.12%
Average spec: 92.20%
Macro f1-score: 58.82%
Diagnosis acc on 15mins: 0.972972972972973
[0.99997163 0.99935466 0.99989927 0.91780949 0.90657604 0.44831756
 0.62103695 0.95044959 0.8971681  0.99463499 0.98910552 0.99737716
 0.98847198 0.99981636 0.99188024 0.99984944 0.99999177 0.99990988
 0.99996865 0.85509765 0.96585107 0.92839521 0.90101123 0.95398027
 0.9881506  0.93652833 0.99781787 0.97881007 0.96832407 0.99755031
 0.93730271 0.99481285 0.99998713 0.9980976  0.95548564 0.9475711
 0.9957509 ]
pred: 0.9460030769979632, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.746679, loss_ss: 2.041695, loss_d: 0.704984
0.0384 --- loss: 2.287904, loss_ss: 1.625449, loss_d: 0.662454
0.0767 --- loss: 2.368539, loss_ss: 1.666256, loss_d: 0.702282
0.1151 --- loss: 2.232092, loss_ss: 1.541811, loss_d: 0.690281
0.1534 --- loss: 2.266683, loss_ss: 1.690114, loss_d: 0.576569
0.1918 --- loss: 1.994278, loss_ss: 1.612183, loss_d: 0.382094
0.2301 --- loss: 2.043219, loss_ss: 1.547649, loss_d: 0.495570
0.2685 --- loss: 1.937023, loss_ss: 1.461575, loss_d: 0.475448
0.3069 --- loss: 1.837706, loss_ss: 1.478896, loss_d: 0.358810
0.3452 --- loss: 2.291178, loss_ss: 1.499793, loss_d: 0.791384
0.3836 --- loss: 2.005747, loss_ss: 1.560556, loss_d: 0.445191
0.4219 --- loss: 1.817963, loss_ss: 1.438774, loss_d: 0.379188
0.4603 --- loss: 1.869897, loss_ss: 1.514579, loss_d: 0.355318
0.4987 --- loss: 1.869698, loss_ss: 1.411793, loss_d: 0.457906
0.5370 --- loss: 2.025831, loss_ss: 1.301706, loss_d: 0.724124
0.5754 --- loss: 1.719374, loss_ss: 1.331884, loss_d: 0.387490
0.6137 --- loss: 1.626316, loss_ss: 1.260050, loss_d: 0.366266
0.6521 --- loss: 2.199687, loss_ss: 1.305712, loss_d: 0.893975
0.6904 --- loss: 1.764208, loss_ss: 1.223074, loss_d: 0.541134
0.7288 --- loss: 1.772859, loss_ss: 1.416839, loss_d: 0.356021
0.7672 --- loss: 2.099682, loss_ss: 1.417941, loss_d: 0.681741
0.8055 --- loss: 1.864795, loss_ss: 1.254153, loss_d: 0.610642
0.8439 --- loss: 1.587893, loss_ss: 1.286672, loss_d: 0.301221
0.8822 --- loss: 1.770640, loss_ss: 1.294988, loss_d: 0.475652
0.9206 --- loss: 1.524848, loss_ss: 1.119092, loss_d: 0.405755
0.9590 --- loss: 1.716397, loss_ss: 1.283799, loss_d: 0.432598
0.9973 --- loss: 1.634297, loss_ss: 1.287533, loss_d: 0.346764
Epoch finished! Loss: 1.998144740324754
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.683472, loss_ss: 1.212654, loss_d: 0.470818
0.0384 --- loss: 1.816768, loss_ss: 1.402866, loss_d: 0.413902
0.0767 --- loss: 1.359264, loss_ss: 1.143042, loss_d: 0.216222
0.1151 --- loss: 1.449843, loss_ss: 1.171928, loss_d: 0.277915
0.1534 --- loss: 1.184139, loss_ss: 1.004436, loss_d: 0.179703
0.1918 --- loss: 1.478352, loss_ss: 1.003614, loss_d: 0.474738
0.2301 --- loss: 1.251765, loss_ss: 0.968001, loss_d: 0.283764
0.2685 --- loss: 1.317554, loss_ss: 1.169875, loss_d: 0.147680
0.3069 --- loss: 1.420758, loss_ss: 1.138213, loss_d: 0.282544
0.3452 --- loss: 1.361323, loss_ss: 1.207296, loss_d: 0.154026
0.3836 --- loss: 1.412024, loss_ss: 1.076822, loss_d: 0.335202
0.4219 --- loss: 1.782126, loss_ss: 1.375697, loss_d: 0.406429
0.4603 --- loss: 1.238511, loss_ss: 0.971272, loss_d: 0.267239
0.4987 --- loss: 1.576281, loss_ss: 1.222540, loss_d: 0.353741
0.5370 --- loss: 1.294634, loss_ss: 1.119088, loss_d: 0.175546
0.5754 --- loss: 1.451872, loss_ss: 1.078675, loss_d: 0.373197
0.6137 --- loss: 1.276900, loss_ss: 1.039464, loss_d: 0.237436
0.6521 --- loss: 1.124604, loss_ss: 0.954845, loss_d: 0.169759
0.6904 --- loss: 1.598221, loss_ss: 1.330497, loss_d: 0.267724
0.7288 --- loss: 2.052933, loss_ss: 0.933497, loss_d: 1.119435
0.7672 --- loss: 1.784585, loss_ss: 1.200120, loss_d: 0.584464
0.8055 --- loss: 1.396813, loss_ss: 0.968980, loss_d: 0.427833
0.8439 --- loss: 1.250693, loss_ss: 0.925929, loss_d: 0.324765
0.8822 --- loss: 1.175673, loss_ss: 0.900108, loss_d: 0.275565
0.9206 --- loss: 1.645478, loss_ss: 1.258077, loss_d: 0.387401
0.9590 --- loss: 1.522183, loss_ss: 1.314093, loss_d: 0.208090
0.9973 --- loss: 1.379072, loss_ss: 1.242236, loss_d: 0.136835
Epoch finished! Loss: 1.5100737328712757
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.332552, loss_ss: 1.096317, loss_d: 0.236235
0.0384 --- loss: 1.047771, loss_ss: 0.903702, loss_d: 0.144070
0.0767 --- loss: 1.798568, loss_ss: 1.638671, loss_d: 0.159896
0.1151 --- loss: 1.294261, loss_ss: 1.021673, loss_d: 0.272588
0.1534 --- loss: 1.311279, loss_ss: 1.068232, loss_d: 0.243047
0.1918 --- loss: 1.186026, loss_ss: 0.843736, loss_d: 0.342290
0.2301 --- loss: 1.330926, loss_ss: 1.057724, loss_d: 0.273202
0.2685 --- loss: 1.432370, loss_ss: 1.035726, loss_d: 0.396644
0.3069 --- loss: 1.301785, loss_ss: 0.977028, loss_d: 0.324757
0.3452 --- loss: 1.366183, loss_ss: 0.981475, loss_d: 0.384708
0.3836 --- loss: 1.100022, loss_ss: 1.054099, loss_d: 0.045922
0.4219 --- loss: 1.264418, loss_ss: 1.151764, loss_d: 0.112654
0.4603 --- loss: 1.120374, loss_ss: 0.827287, loss_d: 0.293087
0.4987 --- loss: 1.021914, loss_ss: 0.938803, loss_d: 0.083112
0.5370 --- loss: 1.203631, loss_ss: 1.106225, loss_d: 0.097406
0.5754 --- loss: 1.224969, loss_ss: 0.828685, loss_d: 0.396284
0.6137 --- loss: 1.289748, loss_ss: 0.985444, loss_d: 0.304304
0.6521 --- loss: 1.261085, loss_ss: 1.093465, loss_d: 0.167620
0.6904 --- loss: 1.191320, loss_ss: 1.067604, loss_d: 0.123716
0.7288 --- loss: 1.593593, loss_ss: 1.242264, loss_d: 0.351329
0.7672 --- loss: 1.025646, loss_ss: 0.844019, loss_d: 0.181627
0.8055 --- loss: 1.250415, loss_ss: 0.955114, loss_d: 0.295301
0.8439 --- loss: 1.208958, loss_ss: 0.720423, loss_d: 0.488535
0.8822 --- loss: 1.110105, loss_ss: 1.060260, loss_d: 0.049845
0.9206 --- loss: 1.396656, loss_ss: 0.996043, loss_d: 0.400613
0.9590 --- loss: 1.033119, loss_ss: 0.929690, loss_d: 0.103429
0.9973 --- loss: 1.856399, loss_ss: 1.115658, loss_d: 0.740741
Epoch finished! Loss: 1.2832231008089505
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.086144, loss_ss: 0.905585, loss_d: 0.180560
0.0384 --- loss: 1.172645, loss_ss: 1.045312, loss_d: 0.127333
0.0767 --- loss: 1.075553, loss_ss: 1.002409, loss_d: 0.073144
0.1151 --- loss: 1.982273, loss_ss: 1.151099, loss_d: 0.831174
0.1534 --- loss: 1.028318, loss_ss: 0.810415, loss_d: 0.217903
0.1918 --- loss: 0.974736, loss_ss: 0.737701, loss_d: 0.237036
0.2301 --- loss: 0.892331, loss_ss: 0.793526, loss_d: 0.098805
0.2685 --- loss: 1.287067, loss_ss: 0.846523, loss_d: 0.440544
0.3069 --- loss: 1.314774, loss_ss: 0.959261, loss_d: 0.355513
0.3452 --- loss: 1.221878, loss_ss: 1.042057, loss_d: 0.179821
0.3836 --- loss: 1.267284, loss_ss: 0.939525, loss_d: 0.327760
0.4219 --- loss: 0.841395, loss_ss: 0.722548, loss_d: 0.118847
0.4603 --- loss: 0.931285, loss_ss: 0.875628, loss_d: 0.055657
0.4987 --- loss: 1.097228, loss_ss: 1.050857, loss_d: 0.046371
0.5370 --- loss: 1.234935, loss_ss: 0.946291, loss_d: 0.288644
0.5754 --- loss: 1.202238, loss_ss: 0.789246, loss_d: 0.412992
0.6137 --- loss: 1.181155, loss_ss: 0.996780, loss_d: 0.184374
0.6521 --- loss: 1.111891, loss_ss: 1.003836, loss_d: 0.108055
0.6904 --- loss: 1.288661, loss_ss: 0.975690, loss_d: 0.312971
0.7288 --- loss: 1.024366, loss_ss: 0.832737, loss_d: 0.191629
0.7672 --- loss: 1.016350, loss_ss: 0.869875, loss_d: 0.146475
0.8055 --- loss: 1.544790, loss_ss: 1.358587, loss_d: 0.186204
0.8439 --- loss: 1.664571, loss_ss: 1.017497, loss_d: 0.647073
0.8822 --- loss: 1.270377, loss_ss: 1.115531, loss_d: 0.154846
0.9206 --- loss: 0.991124, loss_ss: 0.851679, loss_d: 0.139445
0.9590 --- loss: 1.236880, loss_ss: 0.859623, loss_d: 0.377257
0.9973 --- loss: 1.302152, loss_ss: 1.067027, loss_d: 0.235124
Epoch finished! Loss: 1.2117769154218527
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.364204, loss_ss: 1.236881, loss_d: 0.127323
0.0384 --- loss: 1.049993, loss_ss: 0.976846, loss_d: 0.073146
0.0767 --- loss: 0.994532, loss_ss: 0.895996, loss_d: 0.098536
0.1151 --- loss: 1.364354, loss_ss: 1.219504, loss_d: 0.144850
0.1534 --- loss: 0.997764, loss_ss: 0.950323, loss_d: 0.047441
0.1918 --- loss: 1.076582, loss_ss: 0.949868, loss_d: 0.126714
0.2301 --- loss: 0.918779, loss_ss: 0.881931, loss_d: 0.036849
0.2685 --- loss: 1.022605, loss_ss: 0.777262, loss_d: 0.245343
0.3069 --- loss: 1.223092, loss_ss: 0.992689, loss_d: 0.230403
0.3452 --- loss: 1.300806, loss_ss: 0.729247, loss_d: 0.571560
0.3836 --- loss: 1.348035, loss_ss: 0.773633, loss_d: 0.574402
0.4219 --- loss: 1.165401, loss_ss: 0.933357, loss_d: 0.232044
0.4603 --- loss: 1.151582, loss_ss: 0.735798, loss_d: 0.415784
0.4987 --- loss: 1.154276, loss_ss: 0.768770, loss_d: 0.385507
0.5370 --- loss: 1.204686, loss_ss: 1.100331, loss_d: 0.104356
0.5754 --- loss: 1.681304, loss_ss: 1.583825, loss_d: 0.097480
0.6137 --- loss: 1.145012, loss_ss: 1.017136, loss_d: 0.127877
0.6521 --- loss: 1.084385, loss_ss: 0.848159, loss_d: 0.236226
0.6904 --- loss: 1.054649, loss_ss: 0.913534, loss_d: 0.141116
0.7288 --- loss: 0.991519, loss_ss: 0.860322, loss_d: 0.131197
0.7672 --- loss: 1.345287, loss_ss: 1.204288, loss_d: 0.141000
0.8055 --- loss: 1.088247, loss_ss: 0.983587, loss_d: 0.104660
0.8439 --- loss: 0.998002, loss_ss: 0.944259, loss_d: 0.053743
0.8822 --- loss: 1.258402, loss_ss: 1.046016, loss_d: 0.212385
0.9206 --- loss: 0.919110, loss_ss: 0.816036, loss_d: 0.103074
0.9590 --- loss: 1.262119, loss_ss: 0.780240, loss_d: 0.481879
0.9973 --- loss: 1.104019, loss_ss: 1.065830, loss_d: 0.038189
Epoch finished! Loss: 1.1466100385555855
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.873661, loss_ss: 0.748515, loss_d: 0.125146
0.0384 --- loss: 1.545632, loss_ss: 0.755136, loss_d: 0.790496
0.0767 --- loss: 1.343631, loss_ss: 1.130504, loss_d: 0.213128
0.1151 --- loss: 1.237144, loss_ss: 0.877248, loss_d: 0.359896
0.1534 --- loss: 0.959214, loss_ss: 0.802501, loss_d: 0.156713
0.1918 --- loss: 0.979112, loss_ss: 0.749781, loss_d: 0.229331
0.2301 --- loss: 0.841919, loss_ss: 0.741866, loss_d: 0.100053
0.2685 --- loss: 1.508244, loss_ss: 0.748541, loss_d: 0.759702
0.3069 --- loss: 0.978758, loss_ss: 0.720291, loss_d: 0.258467
0.3452 --- loss: 1.158829, loss_ss: 0.879586, loss_d: 0.279243
0.3836 --- loss: 1.505562, loss_ss: 1.289990, loss_d: 0.215572
0.4219 --- loss: 1.159421, loss_ss: 0.577671, loss_d: 0.581750
0.4603 --- loss: 1.464009, loss_ss: 1.394145, loss_d: 0.069864
0.4987 --- loss: 1.218868, loss_ss: 0.937125, loss_d: 0.281743
0.5370 --- loss: 1.131096, loss_ss: 0.936035, loss_d: 0.195061
0.5754 --- loss: 0.802009, loss_ss: 0.737341, loss_d: 0.064668
0.6137 --- loss: 0.634923, loss_ss: 0.618187, loss_d: 0.016736
0.6521 --- loss: 0.767521, loss_ss: 0.713301, loss_d: 0.054220
0.6904 --- loss: 0.954671, loss_ss: 0.928671, loss_d: 0.026000
0.7288 --- loss: 0.865821, loss_ss: 0.797649, loss_d: 0.068172
0.7672 --- loss: 0.703202, loss_ss: 0.630227, loss_d: 0.072975
0.8055 --- loss: 1.086231, loss_ss: 1.002967, loss_d: 0.083265
0.8439 --- loss: 0.966525, loss_ss: 0.748713, loss_d: 0.217813
0.8822 --- loss: 1.313377, loss_ss: 1.166112, loss_d: 0.147265
0.9206 --- loss: 1.036959, loss_ss: 0.911722, loss_d: 0.125237
0.9590 --- loss: 1.033541, loss_ss: 0.938020, loss_d: 0.095521
0.9973 --- loss: 0.858324, loss_ss: 0.748853, loss_d: 0.109471
Epoch finished! Loss: 1.0909115236539106
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.110692, loss_ss: 0.940598, loss_d: 0.170093
0.0384 --- loss: 0.951983, loss_ss: 0.843696, loss_d: 0.108287
0.0767 --- loss: 1.170328, loss_ss: 0.948014, loss_d: 0.222314
0.1151 --- loss: 0.812201, loss_ss: 0.783911, loss_d: 0.028290
0.1534 --- loss: 0.993305, loss_ss: 0.909054, loss_d: 0.084251
0.1918 --- loss: 1.380168, loss_ss: 1.314389, loss_d: 0.065779
0.2301 --- loss: 0.921160, loss_ss: 0.776528, loss_d: 0.144632
0.2685 --- loss: 1.072266, loss_ss: 1.044333, loss_d: 0.027933
0.3069 --- loss: 0.893477, loss_ss: 0.841793, loss_d: 0.051684
0.3452 --- loss: 1.090096, loss_ss: 0.876069, loss_d: 0.214026
0.3836 --- loss: 1.023277, loss_ss: 0.897635, loss_d: 0.125643
0.4219 --- loss: 0.955171, loss_ss: 0.907927, loss_d: 0.047244
0.4603 --- loss: 0.999010, loss_ss: 0.936074, loss_d: 0.062936
0.4987 --- loss: 1.161700, loss_ss: 1.013816, loss_d: 0.147884
0.5370 --- loss: 0.958989, loss_ss: 0.658277, loss_d: 0.300712
0.5754 --- loss: 1.475355, loss_ss: 1.143032, loss_d: 0.332323
0.6137 --- loss: 1.126508, loss_ss: 0.888489, loss_d: 0.238019
0.6521 --- loss: 1.521523, loss_ss: 0.937763, loss_d: 0.583760
0.6904 --- loss: 1.357340, loss_ss: 0.826240, loss_d: 0.531100
0.7288 --- loss: 1.067855, loss_ss: 0.977163, loss_d: 0.090692
0.7672 --- loss: 0.797717, loss_ss: 0.607524, loss_d: 0.190194
0.8055 --- loss: 0.890266, loss_ss: 0.874871, loss_d: 0.015395
0.8439 --- loss: 1.021912, loss_ss: 0.983256, loss_d: 0.038656
0.8822 --- loss: 1.070236, loss_ss: 0.952008, loss_d: 0.118228
0.9206 --- loss: 1.471055, loss_ss: 0.926981, loss_d: 0.544074
0.9590 --- loss: 1.113007, loss_ss: 0.953246, loss_d: 0.159761
0.9973 --- loss: 0.862035, loss_ss: 0.824465, loss_d: 0.037570
Epoch finished! Loss: 1.0511987204735096
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.948882, loss_ss: 0.878037, loss_d: 0.070845
0.0384 --- loss: 1.281699, loss_ss: 1.038041, loss_d: 0.243657
0.0767 --- loss: 1.193684, loss_ss: 1.073646, loss_d: 0.120039
0.1151 --- loss: 0.971751, loss_ss: 0.880866, loss_d: 0.090885
0.1534 --- loss: 0.997997, loss_ss: 0.952442, loss_d: 0.045556
0.1918 --- loss: 1.032800, loss_ss: 0.834820, loss_d: 0.197979
0.2301 --- loss: 1.011772, loss_ss: 0.820056, loss_d: 0.191715
0.2685 --- loss: 1.010275, loss_ss: 0.847804, loss_d: 0.162470
0.3069 --- loss: 1.078288, loss_ss: 0.923833, loss_d: 0.154456
0.3452 --- loss: 1.338018, loss_ss: 0.901988, loss_d: 0.436030
0.3836 --- loss: 1.044032, loss_ss: 0.979477, loss_d: 0.064555
0.4219 --- loss: 1.040127, loss_ss: 0.954068, loss_d: 0.086059
0.4603 --- loss: 0.773951, loss_ss: 0.627359, loss_d: 0.146592
0.4987 --- loss: 1.055387, loss_ss: 0.930031, loss_d: 0.125356
0.5370 --- loss: 0.770109, loss_ss: 0.651698, loss_d: 0.118411
0.5754 --- loss: 0.907575, loss_ss: 0.865143, loss_d: 0.042432
0.6137 --- loss: 0.751474, loss_ss: 0.623355, loss_d: 0.128119
0.6521 --- loss: 1.055522, loss_ss: 0.826270, loss_d: 0.229252
0.6904 --- loss: 1.317990, loss_ss: 1.258326, loss_d: 0.059664
0.7288 --- loss: 0.886941, loss_ss: 0.867708, loss_d: 0.019233
0.7672 --- loss: 0.746105, loss_ss: 0.567549, loss_d: 0.178556
0.8055 --- loss: 1.935700, loss_ss: 1.547796, loss_d: 0.387904
0.8439 --- loss: 1.046499, loss_ss: 0.788930, loss_d: 0.257569
0.8822 --- loss: 2.164288, loss_ss: 0.712960, loss_d: 1.451329
0.9206 --- loss: 0.874667, loss_ss: 0.753262, loss_d: 0.121406
0.9590 --- loss: 0.737833, loss_ss: 0.674555, loss_d: 0.063277
0.9973 --- loss: 0.860954, loss_ss: 0.779790, loss_d: 0.081164
Epoch finished! Loss: 1.0048945938165372
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.847727, loss_ss: 0.821273, loss_d: 0.026454
0.0384 --- loss: 1.003538, loss_ss: 0.986365, loss_d: 0.017173
0.0767 --- loss: 0.785017, loss_ss: 0.768639, loss_d: 0.016377
0.1151 --- loss: 0.738983, loss_ss: 0.698748, loss_d: 0.040235
0.1534 --- loss: 0.878317, loss_ss: 0.836087, loss_d: 0.042230
0.1918 --- loss: 0.883579, loss_ss: 0.819845, loss_d: 0.063734
0.2301 --- loss: 1.546486, loss_ss: 0.965668, loss_d: 0.580818
0.2685 --- loss: 1.424104, loss_ss: 1.079391, loss_d: 0.344713
0.3069 --- loss: 0.950565, loss_ss: 0.763342, loss_d: 0.187223
0.3452 --- loss: 0.958068, loss_ss: 0.818976, loss_d: 0.139092
0.3836 --- loss: 1.232124, loss_ss: 1.078794, loss_d: 0.153329
0.4219 --- loss: 1.057987, loss_ss: 0.845614, loss_d: 0.212373
0.4603 --- loss: 1.206330, loss_ss: 1.195876, loss_d: 0.010453
0.4987 --- loss: 1.257457, loss_ss: 1.198060, loss_d: 0.059398
0.5370 --- loss: 0.782362, loss_ss: 0.745552, loss_d: 0.036809
0.5754 --- loss: 0.890656, loss_ss: 0.826113, loss_d: 0.064543
0.6137 --- loss: 0.931713, loss_ss: 0.888493, loss_d: 0.043220
0.6521 --- loss: 0.740320, loss_ss: 0.717886, loss_d: 0.022433
0.6904 --- loss: 0.697932, loss_ss: 0.686759, loss_d: 0.011172
0.7288 --- loss: 1.029255, loss_ss: 0.774606, loss_d: 0.254649
0.7672 --- loss: 0.891908, loss_ss: 0.697900, loss_d: 0.194008
0.8055 --- loss: 0.925638, loss_ss: 0.920884, loss_d: 0.004754
0.8439 --- loss: 1.158662, loss_ss: 0.954545, loss_d: 0.204117
0.8822 --- loss: 0.987525, loss_ss: 0.767856, loss_d: 0.219669
0.9206 --- loss: 1.161392, loss_ss: 1.139038, loss_d: 0.022353
0.9590 --- loss: 1.111242, loss_ss: 0.988623, loss_d: 0.122618
0.9973 --- loss: 1.688602, loss_ss: 0.766090, loss_d: 0.922513
Epoch finished! Loss: 0.9696274071931839
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.130599, loss_ss: 0.970166, loss_d: 0.160433
0.0384 --- loss: 1.389237, loss_ss: 1.378932, loss_d: 0.010305
0.0767 --- loss: 0.960372, loss_ss: 0.710944, loss_d: 0.249428
0.1151 --- loss: 0.635601, loss_ss: 0.610717, loss_d: 0.024884
0.1534 --- loss: 1.253679, loss_ss: 1.156867, loss_d: 0.096812
0.1918 --- loss: 1.314074, loss_ss: 1.193485, loss_d: 0.120590
0.2301 --- loss: 0.858937, loss_ss: 0.852091, loss_d: 0.006846
0.2685 --- loss: 0.959921, loss_ss: 0.951857, loss_d: 0.008065
0.3069 --- loss: 0.676777, loss_ss: 0.656279, loss_d: 0.020498
0.3452 --- loss: 1.102337, loss_ss: 0.750196, loss_d: 0.352141
0.3836 --- loss: 0.941855, loss_ss: 0.912571, loss_d: 0.029284
0.4219 --- loss: 1.167428, loss_ss: 1.110228, loss_d: 0.057200
0.4603 --- loss: 1.041030, loss_ss: 0.836020, loss_d: 0.205010
0.4987 --- loss: 1.423483, loss_ss: 1.157553, loss_d: 0.265931
0.5370 --- loss: 0.862084, loss_ss: 0.754836, loss_d: 0.107248
0.5754 --- loss: 0.782468, loss_ss: 0.698734, loss_d: 0.083735
0.6137 --- loss: 0.634200, loss_ss: 0.579593, loss_d: 0.054607
0.6521 --- loss: 1.309755, loss_ss: 1.280956, loss_d: 0.028800
0.6904 --- loss: 0.983725, loss_ss: 0.953713, loss_d: 0.030012
0.7288 --- loss: 0.917497, loss_ss: 0.898906, loss_d: 0.018591
0.7672 --- loss: 1.169372, loss_ss: 0.886288, loss_d: 0.283084
0.8055 --- loss: 0.725700, loss_ss: 0.690853, loss_d: 0.034847
0.8439 --- loss: 1.008322, loss_ss: 0.933281, loss_d: 0.075041
0.8822 --- loss: 1.082370, loss_ss: 1.045117, loss_d: 0.037254
0.9206 --- loss: 0.938046, loss_ss: 0.910106, loss_d: 0.027941
0.9590 --- loss: 1.811475, loss_ss: 1.372541, loss_d: 0.438933
0.9973 --- loss: 1.092967, loss_ss: 0.820797, loss_d: 0.272170
Epoch finished! Loss: 0.977462261227461
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5978494623655914
             precision    recall  f1-score   support

        0.0       0.25      0.53      0.34        36
        1.0       0.23      0.16      0.19       112
        2.0       0.46      0.91      0.61       224
        3.0       0.95      0.86      0.90       226
        4.0       0.92      0.36      0.52       332

avg / total       0.71      0.60      0.59       930
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.04  52.78   93.62  25.00     33.93
1  83.55  16.07   92.79  23.38     19.05
2  72.26  90.62   66.43  46.14     61.14
3  95.59  86.28   98.58  95.12     90.49
4  76.13  36.45   98.16  91.67     52.16
Total accuracy: 59.78%
Average sen: 56.44%
Average spec: 89.92%
Macro f1-score: 51.35%
Diagnosis acc on 15mins: 1.0
[0.99973577 0.99945086 0.87960976 0.92827863 0.99790287 0.99933738
 0.99946445 0.99965751 0.99983156 0.99959999 0.87700039 0.54451585
 0.9781968  0.9845978  0.98261791 0.98875529 0.98909295 0.97820401
 0.99940348 0.99589396 0.67717957 0.91476107 0.64028597 0.97061354
 0.99854159 0.99969268 0.99957436 0.99489492 0.91306752 0.99015266
 0.9989801 ]
pred: 0.9425448775291443, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.379296, loss_ss: 1.650447, loss_d: 0.728849
0.0385 --- loss: 2.317519, loss_ss: 1.663937, loss_d: 0.653582
0.0769 --- loss: 2.120961, loss_ss: 1.503130, loss_d: 0.617831
0.1154 --- loss: 2.349393, loss_ss: 1.304480, loss_d: 1.044913
0.1538 --- loss: 2.185143, loss_ss: 1.384129, loss_d: 0.801014
0.1923 --- loss: 1.865303, loss_ss: 1.357770, loss_d: 0.507533
0.2308 --- loss: 2.057061, loss_ss: 1.543283, loss_d: 0.513778
0.2692 --- loss: 1.959747, loss_ss: 1.296127, loss_d: 0.663620
0.3077 --- loss: 1.985543, loss_ss: 1.421482, loss_d: 0.564061
0.3462 --- loss: 1.717458, loss_ss: 1.249102, loss_d: 0.468356
0.3846 --- loss: 2.096810, loss_ss: 1.378163, loss_d: 0.718647
0.4231 --- loss: 1.882040, loss_ss: 1.219247, loss_d: 0.662793
0.4615 --- loss: 1.811514, loss_ss: 1.282599, loss_d: 0.528915
0.5000 --- loss: 1.590576, loss_ss: 1.217148, loss_d: 0.373429
0.5385 --- loss: 1.834456, loss_ss: 1.281771, loss_d: 0.552685
0.5769 --- loss: 1.620831, loss_ss: 1.315590, loss_d: 0.305241
0.6154 --- loss: 1.619245, loss_ss: 1.196917, loss_d: 0.422328
0.6538 --- loss: 1.640181, loss_ss: 1.135247, loss_d: 0.504934
0.6923 --- loss: 1.862349, loss_ss: 1.244110, loss_d: 0.618239
0.7308 --- loss: 1.662639, loss_ss: 1.277435, loss_d: 0.385204
0.7692 --- loss: 1.898281, loss_ss: 1.207495, loss_d: 0.690786
0.8077 --- loss: 1.665044, loss_ss: 1.382880, loss_d: 0.282164
0.8462 --- loss: 1.622099, loss_ss: 1.303051, loss_d: 0.319048
0.8846 --- loss: 1.841950, loss_ss: 1.388642, loss_d: 0.453308
0.9231 --- loss: 1.533044, loss_ss: 1.161162, loss_d: 0.371881
0.9615 --- loss: 1.434341, loss_ss: 1.279807, loss_d: 0.154534
Epoch finished! Loss: 1.8566332917415957
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.785589, loss_ss: 1.372001, loss_d: 0.413588
0.0385 --- loss: 1.486767, loss_ss: 1.003615, loss_d: 0.483152
0.0769 --- loss: 1.222247, loss_ss: 0.942042, loss_d: 0.280205
0.1154 --- loss: 1.865662, loss_ss: 1.290911, loss_d: 0.574751
0.1538 --- loss: 1.487142, loss_ss: 1.222048, loss_d: 0.265094
0.1923 --- loss: 1.487970, loss_ss: 1.159459, loss_d: 0.328511
0.2308 --- loss: 1.353171, loss_ss: 1.128798, loss_d: 0.224373
0.2692 --- loss: 1.465538, loss_ss: 1.167100, loss_d: 0.298438
0.3077 --- loss: 1.289672, loss_ss: 1.077733, loss_d: 0.211939
0.3462 --- loss: 1.573821, loss_ss: 1.192154, loss_d: 0.381667
0.3846 --- loss: 1.660904, loss_ss: 1.064986, loss_d: 0.595918
0.4231 --- loss: 1.241338, loss_ss: 0.939398, loss_d: 0.301940
0.4615 --- loss: 1.372276, loss_ss: 1.006902, loss_d: 0.365374
0.5000 --- loss: 1.367184, loss_ss: 0.975964, loss_d: 0.391220
0.5385 --- loss: 1.462632, loss_ss: 1.183476, loss_d: 0.279156
0.5769 --- loss: 1.774771, loss_ss: 1.041262, loss_d: 0.733510
0.6154 --- loss: 1.311876, loss_ss: 1.035514, loss_d: 0.276362
0.6538 --- loss: 1.445861, loss_ss: 0.875999, loss_d: 0.569861
0.6923 --- loss: 1.685258, loss_ss: 1.137367, loss_d: 0.547891
0.7308 --- loss: 1.414831, loss_ss: 1.200519, loss_d: 0.214312
0.7692 --- loss: 1.371377, loss_ss: 1.124792, loss_d: 0.246585
0.8077 --- loss: 1.545279, loss_ss: 1.113175, loss_d: 0.432104
0.8462 --- loss: 1.830381, loss_ss: 1.045240, loss_d: 0.785141
0.8846 --- loss: 1.527703, loss_ss: 1.052051, loss_d: 0.475652
0.9231 --- loss: 1.421740, loss_ss: 0.990741, loss_d: 0.430999
0.9615 --- loss: 1.227854, loss_ss: 0.908027, loss_d: 0.319827
Epoch finished! Loss: 1.510155352846536
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.196317, loss_ss: 0.957466, loss_d: 0.238850
0.0385 --- loss: 1.539882, loss_ss: 1.153547, loss_d: 0.386335
0.0769 --- loss: 1.327065, loss_ss: 0.890676, loss_d: 0.436389
0.1154 --- loss: 1.567381, loss_ss: 1.049163, loss_d: 0.518218
0.1538 --- loss: 1.182348, loss_ss: 0.976824, loss_d: 0.205524
0.1923 --- loss: 1.664414, loss_ss: 1.126773, loss_d: 0.537642
0.2308 --- loss: 1.165667, loss_ss: 0.990234, loss_d: 0.175433
0.2692 --- loss: 1.005631, loss_ss: 0.863621, loss_d: 0.142010
0.3077 --- loss: 1.048864, loss_ss: 0.962312, loss_d: 0.086552
0.3462 --- loss: 1.431000, loss_ss: 1.105952, loss_d: 0.325048
0.3846 --- loss: 1.409504, loss_ss: 1.018888, loss_d: 0.390616
0.4231 --- loss: 1.899890, loss_ss: 1.389736, loss_d: 0.510154
0.4615 --- loss: 1.397739, loss_ss: 1.015886, loss_d: 0.381853
0.5000 --- loss: 1.896675, loss_ss: 1.467096, loss_d: 0.429579
0.5385 --- loss: 1.146015, loss_ss: 1.033737, loss_d: 0.112277
0.5769 --- loss: 1.011477, loss_ss: 0.838886, loss_d: 0.172591
0.6154 --- loss: 1.265574, loss_ss: 1.089853, loss_d: 0.175721
0.6538 --- loss: 1.415917, loss_ss: 1.110792, loss_d: 0.305124
0.6923 --- loss: 1.353547, loss_ss: 1.171963, loss_d: 0.181583
0.7308 --- loss: 1.794159, loss_ss: 1.104711, loss_d: 0.689448
0.7692 --- loss: 1.682955, loss_ss: 1.588301, loss_d: 0.094654
0.8077 --- loss: 1.175155, loss_ss: 0.911459, loss_d: 0.263696
0.8462 --- loss: 1.051304, loss_ss: 0.996704, loss_d: 0.054600
0.8846 --- loss: 1.395866, loss_ss: 1.116278, loss_d: 0.279588
0.9231 --- loss: 1.179881, loss_ss: 1.089298, loss_d: 0.090583
0.9615 --- loss: 1.617811, loss_ss: 1.194386, loss_d: 0.423425
Epoch finished! Loss: 1.3656165309854456
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.787511, loss_ss: 1.477609, loss_d: 0.309902
0.0385 --- loss: 1.766397, loss_ss: 1.340937, loss_d: 0.425459
0.0769 --- loss: 1.393272, loss_ss: 1.098490, loss_d: 0.294782
0.1154 --- loss: 1.190093, loss_ss: 1.098751, loss_d: 0.091342
0.1538 --- loss: 1.243293, loss_ss: 0.854044, loss_d: 0.389249
0.1923 --- loss: 1.265541, loss_ss: 0.966889, loss_d: 0.298652
0.2308 --- loss: 1.285894, loss_ss: 1.011400, loss_d: 0.274494
0.2692 --- loss: 1.591798, loss_ss: 1.013104, loss_d: 0.578694
0.3077 --- loss: 1.196392, loss_ss: 1.004507, loss_d: 0.191885
0.3462 --- loss: 0.949516, loss_ss: 0.922658, loss_d: 0.026858
0.3846 --- loss: 0.993749, loss_ss: 0.784095, loss_d: 0.209654
0.4231 --- loss: 1.595585, loss_ss: 1.196859, loss_d: 0.398726
0.4615 --- loss: 1.241642, loss_ss: 0.954709, loss_d: 0.286933
0.5000 --- loss: 1.206589, loss_ss: 1.112907, loss_d: 0.093682
0.5385 --- loss: 1.145988, loss_ss: 0.904514, loss_d: 0.241474
0.5769 --- loss: 1.959588, loss_ss: 1.193878, loss_d: 0.765710
0.6154 --- loss: 1.185539, loss_ss: 1.016388, loss_d: 0.169151
0.6538 --- loss: 1.093318, loss_ss: 0.921202, loss_d: 0.172116
0.6923 --- loss: 1.157304, loss_ss: 0.713643, loss_d: 0.443661
0.7308 --- loss: 1.037026, loss_ss: 0.861902, loss_d: 0.175123
0.7692 --- loss: 1.141759, loss_ss: 0.827405, loss_d: 0.314354
0.8077 --- loss: 1.010072, loss_ss: 0.895617, loss_d: 0.114455
0.8462 --- loss: 1.575399, loss_ss: 1.331983, loss_d: 0.243415
0.8846 --- loss: 0.870808, loss_ss: 0.812625, loss_d: 0.058183
0.9231 --- loss: 1.279213, loss_ss: 1.199988, loss_d: 0.079225
0.9615 --- loss: 0.932719, loss_ss: 0.835913, loss_d: 0.096807
Epoch finished! Loss: 1.217768433471444
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.406689, loss_ss: 1.019387, loss_d: 0.387302
0.0385 --- loss: 1.116073, loss_ss: 0.970997, loss_d: 0.145076
0.0769 --- loss: 1.592674, loss_ss: 0.939674, loss_d: 0.653000
0.1154 --- loss: 1.107317, loss_ss: 0.999531, loss_d: 0.107786
0.1538 --- loss: 0.785906, loss_ss: 0.696388, loss_d: 0.089517
0.1923 --- loss: 1.037558, loss_ss: 0.645283, loss_d: 0.392275
0.2308 --- loss: 0.970895, loss_ss: 0.929627, loss_d: 0.041268
0.2692 --- loss: 0.978442, loss_ss: 0.927368, loss_d: 0.051074
0.3077 --- loss: 1.719616, loss_ss: 0.807349, loss_d: 0.912267
0.3462 --- loss: 1.434929, loss_ss: 0.788930, loss_d: 0.645999
0.3846 --- loss: 1.353180, loss_ss: 1.079247, loss_d: 0.273933
0.4231 --- loss: 0.982855, loss_ss: 0.877991, loss_d: 0.104864
0.4615 --- loss: 0.788861, loss_ss: 0.681263, loss_d: 0.107598
0.5000 --- loss: 1.289634, loss_ss: 0.873957, loss_d: 0.415678
0.5385 --- loss: 1.096268, loss_ss: 0.957835, loss_d: 0.138434
0.5769 --- loss: 1.192647, loss_ss: 0.861208, loss_d: 0.331439
0.6154 --- loss: 1.288767, loss_ss: 0.923986, loss_d: 0.364781
0.6538 --- loss: 1.103392, loss_ss: 0.776055, loss_d: 0.327337
0.6923 --- loss: 0.927878, loss_ss: 0.834505, loss_d: 0.093374
0.7308 --- loss: 1.149082, loss_ss: 0.990830, loss_d: 0.158252
0.7692 --- loss: 1.641908, loss_ss: 1.360047, loss_d: 0.281861
0.8077 --- loss: 1.075142, loss_ss: 1.033695, loss_d: 0.041447
0.8462 --- loss: 0.838073, loss_ss: 0.722227, loss_d: 0.115846
0.8846 --- loss: 1.232168, loss_ss: 1.064729, loss_d: 0.167438
0.9231 --- loss: 0.898771, loss_ss: 0.844036, loss_d: 0.054736
0.9615 --- loss: 1.514711, loss_ss: 0.829791, loss_d: 0.684920
Epoch finished! Loss: 1.1662126860103093
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.072004, loss_ss: 0.678344, loss_d: 0.393660
0.0385 --- loss: 1.244562, loss_ss: 0.761772, loss_d: 0.482790
0.0769 --- loss: 0.893764, loss_ss: 0.793110, loss_d: 0.100654
0.1154 --- loss: 1.398566, loss_ss: 1.147767, loss_d: 0.250798
0.1538 --- loss: 1.110376, loss_ss: 1.038140, loss_d: 0.072236
0.1923 --- loss: 1.200899, loss_ss: 0.983929, loss_d: 0.216971
0.2308 --- loss: 0.956654, loss_ss: 0.756588, loss_d: 0.200066
0.2692 --- loss: 0.711765, loss_ss: 0.642845, loss_d: 0.068920
0.3077 --- loss: 1.481095, loss_ss: 1.264141, loss_d: 0.216955
0.3462 --- loss: 1.502321, loss_ss: 0.777606, loss_d: 0.724714
0.3846 --- loss: 0.833076, loss_ss: 0.688694, loss_d: 0.144382
0.4231 --- loss: 1.232216, loss_ss: 0.956802, loss_d: 0.275413
0.4615 --- loss: 0.834323, loss_ss: 0.700351, loss_d: 0.133972
0.5000 --- loss: 1.105986, loss_ss: 0.931101, loss_d: 0.174885
0.5385 --- loss: 1.275645, loss_ss: 1.196737, loss_d: 0.078908
0.5769 --- loss: 1.444218, loss_ss: 0.957333, loss_d: 0.486885
0.6154 --- loss: 0.815945, loss_ss: 0.583717, loss_d: 0.232227
0.6538 --- loss: 0.762689, loss_ss: 0.733097, loss_d: 0.029592
0.6923 --- loss: 0.905319, loss_ss: 0.764935, loss_d: 0.140384
0.7308 --- loss: 1.190420, loss_ss: 1.151384, loss_d: 0.039036
0.7692 --- loss: 1.069406, loss_ss: 0.852637, loss_d: 0.216769
0.8077 --- loss: 1.225001, loss_ss: 0.786130, loss_d: 0.438872
0.8462 --- loss: 0.938645, loss_ss: 0.765697, loss_d: 0.172948
0.8846 --- loss: 1.301288, loss_ss: 1.034930, loss_d: 0.266358
0.9231 --- loss: 1.380642, loss_ss: 1.225561, loss_d: 0.155082
0.9615 --- loss: 1.045111, loss_ss: 0.858973, loss_d: 0.186138
Epoch finished! Loss: 1.0912769894802432
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.085333, loss_ss: 1.040077, loss_d: 0.045256
0.0385 --- loss: 1.504000, loss_ss: 1.445551, loss_d: 0.058449
0.0769 --- loss: 0.742548, loss_ss: 0.674818, loss_d: 0.067730
0.1154 --- loss: 0.798556, loss_ss: 0.776931, loss_d: 0.021625
0.1538 --- loss: 1.129751, loss_ss: 0.959738, loss_d: 0.170014
0.1923 --- loss: 1.109031, loss_ss: 0.995320, loss_d: 0.113711
0.2308 --- loss: 1.041065, loss_ss: 0.996895, loss_d: 0.044170
0.2692 --- loss: 0.995980, loss_ss: 0.935649, loss_d: 0.060331
0.3077 --- loss: 0.800403, loss_ss: 0.746036, loss_d: 0.054366
0.3462 --- loss: 1.114221, loss_ss: 0.967126, loss_d: 0.147095
0.3846 --- loss: 1.496820, loss_ss: 1.080609, loss_d: 0.416211
0.4231 --- loss: 0.848924, loss_ss: 0.666543, loss_d: 0.182380
0.4615 --- loss: 0.927067, loss_ss: 0.898353, loss_d: 0.028714
0.5000 --- loss: 1.090144, loss_ss: 0.833905, loss_d: 0.256239
0.5385 --- loss: 1.202638, loss_ss: 0.646037, loss_d: 0.556601
0.5769 --- loss: 0.925461, loss_ss: 0.917746, loss_d: 0.007715
0.6154 --- loss: 1.017698, loss_ss: 0.827981, loss_d: 0.189717
0.6538 --- loss: 1.135609, loss_ss: 0.822093, loss_d: 0.313516
0.6923 --- loss: 1.253426, loss_ss: 0.846452, loss_d: 0.406974
0.7308 --- loss: 1.174439, loss_ss: 1.081328, loss_d: 0.093111
0.7692 --- loss: 0.934141, loss_ss: 0.808312, loss_d: 0.125829
0.8077 --- loss: 1.188635, loss_ss: 0.809126, loss_d: 0.379509
0.8462 --- loss: 1.213123, loss_ss: 0.828239, loss_d: 0.384884
0.8846 --- loss: 0.814246, loss_ss: 0.712112, loss_d: 0.102134
0.9231 --- loss: 1.210769, loss_ss: 1.157951, loss_d: 0.052818
0.9615 --- loss: 1.125155, loss_ss: 1.014550, loss_d: 0.110605
Epoch finished! Loss: 1.046919647561077
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.983616, loss_ss: 0.870533, loss_d: 0.113083
0.0385 --- loss: 0.825665, loss_ss: 0.751346, loss_d: 0.074319
0.0769 --- loss: 0.934848, loss_ss: 0.780739, loss_d: 0.154108
0.1154 --- loss: 0.896695, loss_ss: 0.848725, loss_d: 0.047970
0.1538 --- loss: 1.178159, loss_ss: 0.990411, loss_d: 0.187748
0.1923 --- loss: 1.154168, loss_ss: 1.092138, loss_d: 0.062030
0.2308 --- loss: 1.140032, loss_ss: 0.688347, loss_d: 0.451685
0.2692 --- loss: 0.943009, loss_ss: 0.921009, loss_d: 0.022000
0.3077 --- loss: 1.062841, loss_ss: 1.002434, loss_d: 0.060407
0.3462 --- loss: 1.192829, loss_ss: 1.140133, loss_d: 0.052696
0.3846 --- loss: 0.931328, loss_ss: 0.674297, loss_d: 0.257031
0.4231 --- loss: 1.230792, loss_ss: 0.773316, loss_d: 0.457476
0.4615 --- loss: 0.853753, loss_ss: 0.792914, loss_d: 0.060839
0.5000 --- loss: 1.009740, loss_ss: 0.974470, loss_d: 0.035270
0.5385 --- loss: 0.762705, loss_ss: 0.747472, loss_d: 0.015233
0.5769 --- loss: 1.107494, loss_ss: 0.682509, loss_d: 0.424984
0.6154 --- loss: 1.295554, loss_ss: 0.791355, loss_d: 0.504199
0.6538 --- loss: 1.017002, loss_ss: 0.956354, loss_d: 0.060649
0.6923 --- loss: 1.546063, loss_ss: 1.200757, loss_d: 0.345306
0.7308 --- loss: 0.732468, loss_ss: 0.674108, loss_d: 0.058360
0.7692 --- loss: 0.865406, loss_ss: 0.740091, loss_d: 0.125315
0.8077 --- loss: 1.312049, loss_ss: 0.927516, loss_d: 0.384532
0.8462 --- loss: 1.236109, loss_ss: 1.103327, loss_d: 0.132783
0.8846 --- loss: 0.991411, loss_ss: 0.949686, loss_d: 0.041725
0.9231 --- loss: 0.910914, loss_ss: 0.870055, loss_d: 0.040859
0.9615 --- loss: 0.971680, loss_ss: 0.956239, loss_d: 0.015442
Epoch finished! Loss: 1.0136367529055326
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.265686, loss_ss: 0.908745, loss_d: 0.356941
0.0385 --- loss: 0.949325, loss_ss: 0.781352, loss_d: 0.167973
0.0769 --- loss: 0.952622, loss_ss: 0.839210, loss_d: 0.113413
0.1154 --- loss: 0.965939, loss_ss: 0.948642, loss_d: 0.017296
0.1538 --- loss: 0.922165, loss_ss: 0.822044, loss_d: 0.100121
0.1923 --- loss: 0.908563, loss_ss: 0.877215, loss_d: 0.031348
0.2308 --- loss: 0.927992, loss_ss: 0.667546, loss_d: 0.260446
0.2692 --- loss: 0.841154, loss_ss: 0.831192, loss_d: 0.009963
0.3077 --- loss: 1.083102, loss_ss: 0.676065, loss_d: 0.407037
0.3462 --- loss: 0.946840, loss_ss: 0.916586, loss_d: 0.030254
0.3846 --- loss: 0.739350, loss_ss: 0.525678, loss_d: 0.213672
0.4231 --- loss: 0.909148, loss_ss: 0.793925, loss_d: 0.115222
0.4615 --- loss: 1.892097, loss_ss: 1.254585, loss_d: 0.637512
0.5000 --- loss: 0.804263, loss_ss: 0.796300, loss_d: 0.007963
0.5385 --- loss: 0.712306, loss_ss: 0.644807, loss_d: 0.067499
0.5769 --- loss: 0.543588, loss_ss: 0.460590, loss_d: 0.082997
0.6154 --- loss: 0.909899, loss_ss: 0.889430, loss_d: 0.020469
0.6538 --- loss: 1.376335, loss_ss: 1.161887, loss_d: 0.214448
0.6923 --- loss: 0.932760, loss_ss: 0.906451, loss_d: 0.026310
0.7308 --- loss: 0.800933, loss_ss: 0.785334, loss_d: 0.015600
0.7692 --- loss: 0.981974, loss_ss: 0.650198, loss_d: 0.331776
0.8077 --- loss: 1.371316, loss_ss: 1.275757, loss_d: 0.095559
0.8462 --- loss: 1.134853, loss_ss: 0.863479, loss_d: 0.271374
0.8846 --- loss: 0.631592, loss_ss: 0.616673, loss_d: 0.014920
0.9231 --- loss: 0.730841, loss_ss: 0.685950, loss_d: 0.044890
0.9615 --- loss: 0.750326, loss_ss: 0.723138, loss_d: 0.027188
Epoch finished! Loss: 0.9597424664552607
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.745515, loss_ss: 0.646832, loss_d: 0.098683
0.0385 --- loss: 0.877809, loss_ss: 0.827789, loss_d: 0.050020
0.0769 --- loss: 0.942448, loss_ss: 0.887614, loss_d: 0.054834
0.1154 --- loss: 1.034537, loss_ss: 0.974533, loss_d: 0.060004
0.1538 --- loss: 1.161446, loss_ss: 1.007731, loss_d: 0.153715
0.1923 --- loss: 0.999013, loss_ss: 0.708679, loss_d: 0.290333
0.2308 --- loss: 0.944424, loss_ss: 0.915510, loss_d: 0.028914
0.2692 --- loss: 0.875343, loss_ss: 0.708884, loss_d: 0.166460
0.3077 --- loss: 0.853969, loss_ss: 0.718756, loss_d: 0.135213
0.3462 --- loss: 0.585447, loss_ss: 0.550780, loss_d: 0.034667
0.3846 --- loss: 0.704237, loss_ss: 0.674085, loss_d: 0.030153
0.4231 --- loss: 0.871286, loss_ss: 0.810430, loss_d: 0.060856
0.4615 --- loss: 0.896371, loss_ss: 0.873810, loss_d: 0.022561
0.5000 --- loss: 0.795035, loss_ss: 0.746644, loss_d: 0.048391
0.5385 --- loss: 0.587400, loss_ss: 0.564471, loss_d: 0.022929
0.5769 --- loss: 1.061647, loss_ss: 1.013090, loss_d: 0.048557
0.6154 --- loss: 0.869691, loss_ss: 0.789308, loss_d: 0.080383
0.6538 --- loss: 0.756553, loss_ss: 0.692746, loss_d: 0.063806
0.6923 --- loss: 0.865110, loss_ss: 0.740609, loss_d: 0.124500
0.7308 --- loss: 0.784716, loss_ss: 0.775199, loss_d: 0.009517
0.7692 --- loss: 0.875765, loss_ss: 0.845742, loss_d: 0.030023
0.8077 --- loss: 1.149514, loss_ss: 0.819657, loss_d: 0.329857
0.8462 --- loss: 0.796633, loss_ss: 0.781192, loss_d: 0.015442
0.8846 --- loss: 1.005243, loss_ss: 0.998693, loss_d: 0.006550
0.9231 --- loss: 0.649992, loss_ss: 0.641595, loss_d: 0.008397
0.9615 --- loss: 0.914622, loss_ss: 0.731299, loss_d: 0.183324
Epoch finished! Loss: 0.9288139145346682
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5991228070175438
             precision    recall  f1-score   support

        0.0       1.00      0.20      0.33       297
        1.0       0.44      0.35      0.39       200
        2.0       0.57      0.91      0.70       354
        3.0       0.77      0.96      0.85       159
        4.0       0.48      0.61      0.54       130

avg / total       0.68      0.60      0.55      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  79.12  19.87  100.00  100.00     33.15
1  80.88  35.00   90.64   44.30     39.11
2  76.32  90.96   69.72   57.50     70.46
3  95.44  96.23   95.31   76.88     85.47
4  88.07  60.77   91.58   48.17     53.74
Total accuracy: 59.91%
Average sen: 60.56%
Average spec: 89.45%
Macro f1-score: 56.39%
Diagnosis acc on 15mins: 1.0
[0.87744367 0.7745924  0.86917311 0.99338371 0.99040902 0.93199664
 0.98573685 0.99221134 0.99542505 0.9985677  0.99996328 0.99996161
 0.99999309 0.99993098 0.99079001 0.99527872 0.99966204 0.99991333
 0.99999964 0.9999913  0.99992132 0.99984431 0.99712771 0.96283442
 0.91794556 0.99794096 0.99003756 0.99222809 0.98872441 0.99999726
 0.99995458 0.99996138 0.99998415 0.99990392 0.99814856 0.9864521
 0.97478753 0.9137997 ]
pred: 0.9766846581509239, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.299561, loss_ss: 1.607357, loss_d: 0.692203
0.0385 --- loss: 2.226757, loss_ss: 1.472947, loss_d: 0.753810
0.0770 --- loss: 2.321357, loss_ss: 1.637493, loss_d: 0.683865
0.1156 --- loss: 2.227711, loss_ss: 1.572057, loss_d: 0.655655
0.1541 --- loss: 2.010297, loss_ss: 1.583108, loss_d: 0.427189
0.1926 --- loss: 1.997413, loss_ss: 1.255806, loss_d: 0.741606
0.2311 --- loss: 2.005180, loss_ss: 1.506042, loss_d: 0.499138
0.2696 --- loss: 1.928107, loss_ss: 1.350005, loss_d: 0.578102
0.3082 --- loss: 2.059933, loss_ss: 1.459385, loss_d: 0.600548
0.3467 --- loss: 2.053675, loss_ss: 1.348762, loss_d: 0.704913
0.3852 --- loss: 2.117219, loss_ss: 1.392362, loss_d: 0.724857
0.4237 --- loss: 1.815919, loss_ss: 1.192037, loss_d: 0.623882
0.4622 --- loss: 2.116465, loss_ss: 1.463793, loss_d: 0.652672
0.5008 --- loss: 2.066193, loss_ss: 1.399074, loss_d: 0.667119
0.5393 --- loss: 1.976552, loss_ss: 1.475171, loss_d: 0.501381
0.5778 --- loss: 1.964745, loss_ss: 1.409574, loss_d: 0.555171
0.6163 --- loss: 1.965848, loss_ss: 1.314629, loss_d: 0.651220
0.6549 --- loss: 1.920628, loss_ss: 1.417833, loss_d: 0.502795
0.6934 --- loss: 2.018476, loss_ss: 1.294130, loss_d: 0.724347
0.7319 --- loss: 1.938841, loss_ss: 1.213883, loss_d: 0.724958
0.7704 --- loss: 1.801982, loss_ss: 1.098330, loss_d: 0.703652
0.8089 --- loss: 1.839442, loss_ss: 1.281401, loss_d: 0.558041
0.8475 --- loss: 1.629086, loss_ss: 1.299499, loss_d: 0.329588
0.8860 --- loss: 1.547158, loss_ss: 1.130320, loss_d: 0.416838
0.9245 --- loss: 1.755116, loss_ss: 1.081764, loss_d: 0.673352
0.9630 --- loss: 1.717420, loss_ss: 1.221924, loss_d: 0.495496
Epoch finished! Loss: 1.9163297336534184
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.637650, loss_ss: 1.029622, loss_d: 0.608027
0.0385 --- loss: 1.838258, loss_ss: 1.036365, loss_d: 0.801892
0.0770 --- loss: 1.651820, loss_ss: 1.235542, loss_d: 0.416278
0.1156 --- loss: 1.529636, loss_ss: 1.026156, loss_d: 0.503480
0.1541 --- loss: 1.421533, loss_ss: 1.192269, loss_d: 0.229264
0.1926 --- loss: 1.325803, loss_ss: 1.048809, loss_d: 0.276994
0.2311 --- loss: 1.734403, loss_ss: 1.475966, loss_d: 0.258436
0.2696 --- loss: 1.669523, loss_ss: 1.120354, loss_d: 0.549168
0.3082 --- loss: 1.443037, loss_ss: 1.146621, loss_d: 0.296416
0.3467 --- loss: 1.263846, loss_ss: 1.016119, loss_d: 0.247727
0.3852 --- loss: 1.366939, loss_ss: 1.118408, loss_d: 0.248532
0.4237 --- loss: 1.430837, loss_ss: 1.097793, loss_d: 0.333045
0.4622 --- loss: 1.523033, loss_ss: 1.082044, loss_d: 0.440989
0.5008 --- loss: 1.981514, loss_ss: 1.417589, loss_d: 0.563925
0.5393 --- loss: 1.436167, loss_ss: 1.056959, loss_d: 0.379208
0.5778 --- loss: 1.202103, loss_ss: 1.013556, loss_d: 0.188547
0.6163 --- loss: 1.168485, loss_ss: 1.048730, loss_d: 0.119755
0.6549 --- loss: 1.629218, loss_ss: 1.210109, loss_d: 0.419108
0.6934 --- loss: 1.501963, loss_ss: 1.063337, loss_d: 0.438627
0.7319 --- loss: 1.250335, loss_ss: 1.000325, loss_d: 0.250010
0.7704 --- loss: 1.360111, loss_ss: 1.106276, loss_d: 0.253835
0.8089 --- loss: 1.381636, loss_ss: 1.229104, loss_d: 0.152533
0.8475 --- loss: 1.326020, loss_ss: 0.988473, loss_d: 0.337547
0.8860 --- loss: 1.280054, loss_ss: 1.047751, loss_d: 0.232302
0.9245 --- loss: 1.838105, loss_ss: 0.996068, loss_d: 0.842038
0.9630 --- loss: 1.241733, loss_ss: 0.996532, loss_d: 0.245202
Epoch finished! Loss: 1.5440382170401024
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.300111, loss_ss: 1.043059, loss_d: 0.257052
0.0385 --- loss: 1.331228, loss_ss: 1.044505, loss_d: 0.286723
0.0770 --- loss: 1.232342, loss_ss: 1.053748, loss_d: 0.178594
0.1156 --- loss: 1.247362, loss_ss: 0.995276, loss_d: 0.252086
0.1541 --- loss: 1.367696, loss_ss: 1.008650, loss_d: 0.359046
0.1926 --- loss: 1.591120, loss_ss: 0.912598, loss_d: 0.678522
0.2311 --- loss: 1.303780, loss_ss: 0.994107, loss_d: 0.309673
0.2696 --- loss: 1.636071, loss_ss: 1.279087, loss_d: 0.356985
0.3082 --- loss: 1.176385, loss_ss: 1.004078, loss_d: 0.172307
0.3467 --- loss: 1.208777, loss_ss: 1.072001, loss_d: 0.136776
0.3852 --- loss: 1.623933, loss_ss: 1.363060, loss_d: 0.260873
0.4237 --- loss: 1.091826, loss_ss: 1.030113, loss_d: 0.061714
0.4622 --- loss: 1.012073, loss_ss: 0.946688, loss_d: 0.065385
0.5008 --- loss: 1.305735, loss_ss: 1.057913, loss_d: 0.247822
0.5393 --- loss: 1.347669, loss_ss: 0.945203, loss_d: 0.402467
0.5778 --- loss: 1.235960, loss_ss: 0.996213, loss_d: 0.239748
0.6163 --- loss: 1.559105, loss_ss: 0.902571, loss_d: 0.656534
0.6549 --- loss: 1.823557, loss_ss: 0.831265, loss_d: 0.992293
0.6934 --- loss: 1.211893, loss_ss: 0.773794, loss_d: 0.438099
0.7319 --- loss: 1.085766, loss_ss: 0.977157, loss_d: 0.108609
0.7704 --- loss: 1.184042, loss_ss: 0.870543, loss_d: 0.313500
0.8089 --- loss: 0.927944, loss_ss: 0.814808, loss_d: 0.113136
0.8475 --- loss: 1.429168, loss_ss: 1.028701, loss_d: 0.400467
0.8860 --- loss: 2.203093, loss_ss: 0.998385, loss_d: 1.204707
0.9245 --- loss: 1.247480, loss_ss: 0.756695, loss_d: 0.490784
0.9630 --- loss: 1.115665, loss_ss: 0.981551, loss_d: 0.134114
Epoch finished! Loss: 1.3177293223763986
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.170033, loss_ss: 0.776313, loss_d: 0.393720
0.0385 --- loss: 1.514496, loss_ss: 0.942396, loss_d: 0.572100
0.0770 --- loss: 1.279761, loss_ss: 1.153530, loss_d: 0.126231
0.1156 --- loss: 1.590940, loss_ss: 1.140448, loss_d: 0.450492
0.1541 --- loss: 0.930389, loss_ss: 0.840198, loss_d: 0.090191
0.1926 --- loss: 1.266162, loss_ss: 0.969352, loss_d: 0.296810
0.2311 --- loss: 1.095963, loss_ss: 0.949681, loss_d: 0.146281
0.2696 --- loss: 0.985490, loss_ss: 0.942580, loss_d: 0.042910
0.3082 --- loss: 1.150219, loss_ss: 0.997079, loss_d: 0.153141
0.3467 --- loss: 1.135355, loss_ss: 0.922460, loss_d: 0.212895
0.3852 --- loss: 1.294631, loss_ss: 1.120659, loss_d: 0.173972
0.4237 --- loss: 1.010975, loss_ss: 0.736739, loss_d: 0.274235
0.4622 --- loss: 1.148943, loss_ss: 0.980222, loss_d: 0.168721
0.5008 --- loss: 1.114615, loss_ss: 0.908894, loss_d: 0.205721
0.5393 --- loss: 1.361042, loss_ss: 1.155543, loss_d: 0.205498
0.5778 --- loss: 1.241591, loss_ss: 0.986879, loss_d: 0.254712
0.6163 --- loss: 1.068887, loss_ss: 0.778602, loss_d: 0.290285
0.6549 --- loss: 1.169785, loss_ss: 1.068480, loss_d: 0.101305
0.6934 --- loss: 1.155777, loss_ss: 0.921698, loss_d: 0.234079
0.7319 --- loss: 1.089034, loss_ss: 0.978931, loss_d: 0.110104
0.7704 --- loss: 1.247756, loss_ss: 1.021251, loss_d: 0.226505
0.8089 --- loss: 0.874821, loss_ss: 0.821424, loss_d: 0.053397
0.8475 --- loss: 1.069373, loss_ss: 0.755747, loss_d: 0.313627
0.8860 --- loss: 1.108178, loss_ss: 0.802668, loss_d: 0.305510
0.9245 --- loss: 0.798675, loss_ss: 0.737805, loss_d: 0.060870
0.9630 --- loss: 0.891786, loss_ss: 0.691659, loss_d: 0.200127
Epoch finished! Loss: 1.1960596614822918
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.170031, loss_ss: 0.995963, loss_d: 0.174067
0.0385 --- loss: 1.311815, loss_ss: 0.957189, loss_d: 0.354626
0.0770 --- loss: 1.264453, loss_ss: 0.961618, loss_d: 0.302835
0.1156 --- loss: 0.976136, loss_ss: 0.881646, loss_d: 0.094490
0.1541 --- loss: 2.287789, loss_ss: 1.092012, loss_d: 1.195777
0.1926 --- loss: 1.082448, loss_ss: 0.885935, loss_d: 0.196513
0.2311 --- loss: 1.245858, loss_ss: 0.772244, loss_d: 0.473613
0.2696 --- loss: 1.373966, loss_ss: 1.088284, loss_d: 0.285683
0.3082 --- loss: 1.036990, loss_ss: 0.978824, loss_d: 0.058166
0.3467 --- loss: 0.899256, loss_ss: 0.817106, loss_d: 0.082150
0.3852 --- loss: 0.918195, loss_ss: 0.870451, loss_d: 0.047744
0.4237 --- loss: 0.869999, loss_ss: 0.741122, loss_d: 0.128877
0.4622 --- loss: 1.482204, loss_ss: 0.931168, loss_d: 0.551036
0.5008 --- loss: 1.315150, loss_ss: 1.024534, loss_d: 0.290616
0.5393 --- loss: 1.222389, loss_ss: 1.174077, loss_d: 0.048312
0.5778 --- loss: 0.964942, loss_ss: 0.906821, loss_d: 0.058122
0.6163 --- loss: 1.080703, loss_ss: 0.976882, loss_d: 0.103821
0.6549 --- loss: 1.011243, loss_ss: 0.927505, loss_d: 0.083737
0.6934 --- loss: 0.998325, loss_ss: 0.855520, loss_d: 0.142805
0.7319 --- loss: 0.746058, loss_ss: 0.710781, loss_d: 0.035277
0.7704 --- loss: 1.118363, loss_ss: 0.777179, loss_d: 0.341184
0.8089 --- loss: 1.143429, loss_ss: 1.032907, loss_d: 0.110521
0.8475 --- loss: 1.325649, loss_ss: 0.735911, loss_d: 0.589738
0.8860 --- loss: 1.032113, loss_ss: 0.846644, loss_d: 0.185469
0.9245 --- loss: 0.897497, loss_ss: 0.660234, loss_d: 0.237262
0.9630 --- loss: 0.664056, loss_ss: 0.635667, loss_d: 0.028389
Epoch finished! Loss: 1.1559995113652646
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.354678, loss_ss: 1.049832, loss_d: 0.304846
0.0385 --- loss: 0.953520, loss_ss: 0.866091, loss_d: 0.087429
0.0770 --- loss: 1.330546, loss_ss: 0.737645, loss_d: 0.592900
0.1156 --- loss: 1.151058, loss_ss: 0.687215, loss_d: 0.463843
0.1541 --- loss: 1.129474, loss_ss: 0.941945, loss_d: 0.187529
0.1926 --- loss: 1.003150, loss_ss: 0.967975, loss_d: 0.035175
0.2311 --- loss: 0.981899, loss_ss: 0.879149, loss_d: 0.102749
0.2696 --- loss: 1.126325, loss_ss: 0.937406, loss_d: 0.188919
0.3082 --- loss: 1.105272, loss_ss: 1.051259, loss_d: 0.054013
0.3467 --- loss: 1.051109, loss_ss: 0.916161, loss_d: 0.134948
0.3852 --- loss: 1.971518, loss_ss: 0.683850, loss_d: 1.287668
0.4237 --- loss: 0.827669, loss_ss: 0.546229, loss_d: 0.281439
0.4622 --- loss: 1.097288, loss_ss: 1.079159, loss_d: 0.018129
0.5008 --- loss: 0.804294, loss_ss: 0.761675, loss_d: 0.042620
0.5393 --- loss: 0.917026, loss_ss: 0.672201, loss_d: 0.244825
0.5778 --- loss: 0.972975, loss_ss: 0.590047, loss_d: 0.382927
0.6163 --- loss: 1.225167, loss_ss: 0.569054, loss_d: 0.656113
0.6549 --- loss: 0.812470, loss_ss: 0.753958, loss_d: 0.058513
0.6934 --- loss: 1.185511, loss_ss: 1.012490, loss_d: 0.173022
0.7319 --- loss: 1.020228, loss_ss: 0.727163, loss_d: 0.293065
0.7704 --- loss: 1.028802, loss_ss: 0.817100, loss_d: 0.211702
0.8089 --- loss: 1.173211, loss_ss: 0.856655, loss_d: 0.316557
0.8475 --- loss: 1.193101, loss_ss: 1.124622, loss_d: 0.068479
0.8860 --- loss: 1.108189, loss_ss: 0.888286, loss_d: 0.219903
0.9245 --- loss: 1.822029, loss_ss: 1.091928, loss_d: 0.730101
0.9630 --- loss: 0.968557, loss_ss: 0.843859, loss_d: 0.124698
Epoch finished! Loss: 1.080537619507911
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.949011, loss_ss: 0.899846, loss_d: 0.049166
0.0385 --- loss: 0.983522, loss_ss: 0.957970, loss_d: 0.025552
0.0770 --- loss: 1.063701, loss_ss: 0.982645, loss_d: 0.081056
0.1156 --- loss: 0.801699, loss_ss: 0.739070, loss_d: 0.062628
0.1541 --- loss: 1.212894, loss_ss: 0.839814, loss_d: 0.373081
0.1926 --- loss: 1.031832, loss_ss: 0.969550, loss_d: 0.062282
0.2311 --- loss: 0.946212, loss_ss: 0.826555, loss_d: 0.119657
0.2696 --- loss: 1.593999, loss_ss: 1.125260, loss_d: 0.468740
0.3082 --- loss: 0.944048, loss_ss: 0.854736, loss_d: 0.089312
0.3467 --- loss: 0.972853, loss_ss: 0.891592, loss_d: 0.081260
0.3852 --- loss: 1.681775, loss_ss: 1.097631, loss_d: 0.584144
0.4237 --- loss: 1.065359, loss_ss: 0.893626, loss_d: 0.171733
0.4622 --- loss: 0.876728, loss_ss: 0.746331, loss_d: 0.130398
0.5008 --- loss: 1.181036, loss_ss: 0.897434, loss_d: 0.283602
0.5393 --- loss: 1.700629, loss_ss: 1.243526, loss_d: 0.457103
0.5778 --- loss: 0.965494, loss_ss: 0.820428, loss_d: 0.145066
0.6163 --- loss: 1.033885, loss_ss: 0.869805, loss_d: 0.164080
0.6549 --- loss: 0.962614, loss_ss: 0.837973, loss_d: 0.124641
0.6934 --- loss: 0.626931, loss_ss: 0.606472, loss_d: 0.020459
0.7319 --- loss: 0.829843, loss_ss: 0.790297, loss_d: 0.039546
0.7704 --- loss: 1.068070, loss_ss: 0.781287, loss_d: 0.286783
0.8089 --- loss: 1.104301, loss_ss: 1.085085, loss_d: 0.019216
0.8475 --- loss: 1.271610, loss_ss: 0.920607, loss_d: 0.351003
0.8860 --- loss: 0.718765, loss_ss: 0.681567, loss_d: 0.037198
0.9245 --- loss: 1.103243, loss_ss: 1.082413, loss_d: 0.020830
0.9630 --- loss: 1.043358, loss_ss: 1.032623, loss_d: 0.010736
Epoch finished! Loss: 1.044583942669239
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.681992, loss_ss: 0.617876, loss_d: 0.064116
0.0385 --- loss: 1.049060, loss_ss: 0.981017, loss_d: 0.068044
0.0770 --- loss: 0.903295, loss_ss: 0.862476, loss_d: 0.040819
0.1156 --- loss: 0.898449, loss_ss: 0.843547, loss_d: 0.054902
0.1541 --- loss: 0.852873, loss_ss: 0.795972, loss_d: 0.056900
0.1926 --- loss: 0.809299, loss_ss: 0.671674, loss_d: 0.137625
0.2311 --- loss: 1.335352, loss_ss: 0.862487, loss_d: 0.472865
0.2696 --- loss: 1.062645, loss_ss: 0.892406, loss_d: 0.170239
0.3082 --- loss: 1.214665, loss_ss: 0.981549, loss_d: 0.233116
0.3467 --- loss: 1.065846, loss_ss: 0.809594, loss_d: 0.256252
0.3852 --- loss: 0.957781, loss_ss: 0.835937, loss_d: 0.121845
0.4237 --- loss: 0.882761, loss_ss: 0.822413, loss_d: 0.060347
0.4622 --- loss: 0.729883, loss_ss: 0.639944, loss_d: 0.089939
0.5008 --- loss: 0.965828, loss_ss: 0.915287, loss_d: 0.050541
0.5393 --- loss: 1.307452, loss_ss: 1.073689, loss_d: 0.233764
0.5778 --- loss: 0.921803, loss_ss: 0.809594, loss_d: 0.112209
0.6163 --- loss: 0.777033, loss_ss: 0.757789, loss_d: 0.019244
0.6549 --- loss: 1.186703, loss_ss: 0.999470, loss_d: 0.187233
0.6934 --- loss: 0.816614, loss_ss: 0.796421, loss_d: 0.020193
0.7319 --- loss: 0.835038, loss_ss: 0.746492, loss_d: 0.088545
0.7704 --- loss: 1.072134, loss_ss: 1.044418, loss_d: 0.027716
0.8089 --- loss: 0.962306, loss_ss: 0.865988, loss_d: 0.096317
0.8475 --- loss: 0.960808, loss_ss: 0.687881, loss_d: 0.272927
0.8860 --- loss: 0.915059, loss_ss: 0.887019, loss_d: 0.028040
0.9245 --- loss: 0.855688, loss_ss: 0.837271, loss_d: 0.018417
0.9630 --- loss: 0.836341, loss_ss: 0.822870, loss_d: 0.013471
Epoch finished! Loss: 0.99785168014438
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.872922, loss_ss: 0.545431, loss_d: 0.327491
0.0385 --- loss: 1.043363, loss_ss: 0.980850, loss_d: 0.062513
0.0770 --- loss: 1.146765, loss_ss: 1.095282, loss_d: 0.051483
0.1156 --- loss: 0.939866, loss_ss: 0.815653, loss_d: 0.124213
0.1541 --- loss: 0.779715, loss_ss: 0.764878, loss_d: 0.014837
0.1926 --- loss: 0.838110, loss_ss: 0.824845, loss_d: 0.013265
0.2311 --- loss: 1.069385, loss_ss: 0.723181, loss_d: 0.346204
0.2696 --- loss: 0.844573, loss_ss: 0.719534, loss_d: 0.125039
0.3082 --- loss: 0.837182, loss_ss: 0.754330, loss_d: 0.082852
0.3467 --- loss: 0.923003, loss_ss: 0.881248, loss_d: 0.041755
0.3852 --- loss: 0.752189, loss_ss: 0.729531, loss_d: 0.022658
0.4237 --- loss: 1.097666, loss_ss: 1.047447, loss_d: 0.050219
0.4622 --- loss: 0.675492, loss_ss: 0.537189, loss_d: 0.138302
0.5008 --- loss: 0.877384, loss_ss: 0.855488, loss_d: 0.021896
0.5393 --- loss: 0.726990, loss_ss: 0.652508, loss_d: 0.074482
0.5778 --- loss: 0.777256, loss_ss: 0.748952, loss_d: 0.028304
0.6163 --- loss: 1.050392, loss_ss: 0.910150, loss_d: 0.140242
0.6549 --- loss: 0.657711, loss_ss: 0.647258, loss_d: 0.010454
0.6934 --- loss: 0.891429, loss_ss: 0.876200, loss_d: 0.015230
0.7319 --- loss: 0.695902, loss_ss: 0.665793, loss_d: 0.030109
0.7704 --- loss: 0.890905, loss_ss: 0.853735, loss_d: 0.037170
0.8089 --- loss: 1.188890, loss_ss: 0.918713, loss_d: 0.270177
0.8475 --- loss: 1.236979, loss_ss: 0.977350, loss_d: 0.259630
0.8860 --- loss: 0.885638, loss_ss: 0.698754, loss_d: 0.186884
0.9245 --- loss: 0.913942, loss_ss: 0.640249, loss_d: 0.273693
0.9630 --- loss: 0.679525, loss_ss: 0.653647, loss_d: 0.025877
Epoch finished! Loss: 0.958019760814873
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.905120, loss_ss: 0.886170, loss_d: 0.018950
0.0385 --- loss: 0.756994, loss_ss: 0.658142, loss_d: 0.098852
0.0770 --- loss: 0.966277, loss_ss: 0.914949, loss_d: 0.051329
0.1156 --- loss: 0.858242, loss_ss: 0.838249, loss_d: 0.019993
0.1541 --- loss: 0.922285, loss_ss: 0.877061, loss_d: 0.045224
0.1926 --- loss: 1.015567, loss_ss: 0.896175, loss_d: 0.119392
0.2311 --- loss: 0.875385, loss_ss: 0.842791, loss_d: 0.032593
0.2696 --- loss: 0.794098, loss_ss: 0.771802, loss_d: 0.022296
0.3082 --- loss: 1.343693, loss_ss: 1.311768, loss_d: 0.031925
0.3467 --- loss: 0.818965, loss_ss: 0.790933, loss_d: 0.028032
0.3852 --- loss: 0.589958, loss_ss: 0.570067, loss_d: 0.019891
0.4237 --- loss: 0.828318, loss_ss: 0.668334, loss_d: 0.159984
0.4622 --- loss: 0.692178, loss_ss: 0.646861, loss_d: 0.045316
0.5008 --- loss: 0.682544, loss_ss: 0.648112, loss_d: 0.034433
0.5393 --- loss: 0.925274, loss_ss: 0.780945, loss_d: 0.144328
0.5778 --- loss: 1.071670, loss_ss: 1.055420, loss_d: 0.016250
0.6163 --- loss: 1.230483, loss_ss: 1.080510, loss_d: 0.149973
0.6549 --- loss: 0.769521, loss_ss: 0.609509, loss_d: 0.160012
0.6934 --- loss: 0.889511, loss_ss: 0.865879, loss_d: 0.023633
0.7319 --- loss: 0.831243, loss_ss: 0.819442, loss_d: 0.011801
0.7704 --- loss: 0.674329, loss_ss: 0.608897, loss_d: 0.065432
0.8089 --- loss: 1.000434, loss_ss: 0.823771, loss_d: 0.176663
0.8475 --- loss: 1.223246, loss_ss: 1.208866, loss_d: 0.014380
0.8860 --- loss: 0.672465, loss_ss: 0.646087, loss_d: 0.026377
0.9245 --- loss: 0.901401, loss_ss: 0.887593, loss_d: 0.013808
0.9630 --- loss: 1.049848, loss_ss: 0.806453, loss_d: 0.243395
Epoch finished! Loss: 0.9219730883031279
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5992063492063492
             precision    recall  f1-score   support

        0.0       0.94      0.41      0.57       253
        1.0       0.47      0.70      0.56       293
        2.0       0.90      0.51      0.65       468
        3.0       0.46      0.92      0.61       107
        4.0       0.48      0.80      0.60       139

avg / total       0.72      0.60      0.60      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.62  40.71   99.40  94.50     56.91
1  74.37  69.62   75.80  46.58     55.81
2  79.60  51.07   96.46  89.51     65.03
3  90.00  91.59   89.85  45.58     60.87
4  88.25  79.86   89.30  48.05     60.00
Total accuracy: 59.92%
Average sen: 66.57%
Average spec: 90.16%
Macro f1-score: 59.72%
Diagnosis acc on 15mins: 1.0
[0.99997067 0.99984705 0.99924976 0.99981982 0.99996996 0.99996734
 0.99999952 0.99999881 1.         1.         1.         1.
 1.         0.99999988 1.         1.         0.99999976 0.99999988
 1.         0.99999964 0.9999752  0.99971396 0.99999702 0.99999952
 0.99999988 0.9999975  0.99999535 0.99999976 1.         0.99999869
 0.99997485 0.99992526 0.99999869 0.99999869 0.99999928 0.99999964
 0.99990773 0.99996901 0.99999928 0.9999975  0.99990344 0.99996901]
pred: 0.9999557463895707, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.290613, loss_ss: 1.636870, loss_d: 0.653742
0.0384 --- loss: 2.118070, loss_ss: 1.622354, loss_d: 0.495716
0.0769 --- loss: 2.307426, loss_ss: 1.506997, loss_d: 0.800429
0.1153 --- loss: 2.202152, loss_ss: 1.520069, loss_d: 0.682083
0.1538 --- loss: 2.237907, loss_ss: 1.464212, loss_d: 0.773695
0.1922 --- loss: 1.916336, loss_ss: 1.337202, loss_d: 0.579134
0.2307 --- loss: 2.098514, loss_ss: 1.537120, loss_d: 0.561394
0.2691 --- loss: 2.046444, loss_ss: 1.453074, loss_d: 0.593371
0.3076 --- loss: 2.131752, loss_ss: 1.421690, loss_d: 0.710062
0.3460 --- loss: 1.855347, loss_ss: 1.353050, loss_d: 0.502297
0.3845 --- loss: 1.698380, loss_ss: 1.370371, loss_d: 0.328010
0.4229 --- loss: 1.955110, loss_ss: 1.408696, loss_d: 0.546414
0.4614 --- loss: 1.972350, loss_ss: 1.520689, loss_d: 0.451660
0.4998 --- loss: 1.897260, loss_ss: 1.340627, loss_d: 0.556633
0.5383 --- loss: 1.783846, loss_ss: 1.256045, loss_d: 0.527801
0.5767 --- loss: 1.715393, loss_ss: 1.333530, loss_d: 0.381863
0.6151 --- loss: 1.796099, loss_ss: 1.211924, loss_d: 0.584175
0.6536 --- loss: 1.656275, loss_ss: 1.298270, loss_d: 0.358005
0.6920 --- loss: 2.021157, loss_ss: 1.346825, loss_d: 0.674332
0.7305 --- loss: 1.556892, loss_ss: 1.256631, loss_d: 0.300261
0.7689 --- loss: 1.762953, loss_ss: 1.447190, loss_d: 0.315762
0.8074 --- loss: 2.081010, loss_ss: 1.417478, loss_d: 0.663532
0.8458 --- loss: 1.608030, loss_ss: 1.220495, loss_d: 0.387535
0.8843 --- loss: 1.749320, loss_ss: 1.300335, loss_d: 0.448985
0.9227 --- loss: 1.599805, loss_ss: 1.299156, loss_d: 0.300649
0.9612 --- loss: 1.677305, loss_ss: 1.300481, loss_d: 0.376824
0.9996 --- loss: 1.628696, loss_ss: 1.293421, loss_d: 0.335275
Epoch finished! Loss: 1.944522644006289
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.525376, loss_ss: 1.238005, loss_d: 0.287371
0.0384 --- loss: 1.954398, loss_ss: 1.188953, loss_d: 0.765445
0.0769 --- loss: 1.490954, loss_ss: 1.068081, loss_d: 0.422872
0.1153 --- loss: 1.503453, loss_ss: 1.071306, loss_d: 0.432147
0.1538 --- loss: 1.699593, loss_ss: 1.330330, loss_d: 0.369263
0.1922 --- loss: 1.681668, loss_ss: 1.316226, loss_d: 0.365442
0.2307 --- loss: 1.813729, loss_ss: 1.243594, loss_d: 0.570134
0.2691 --- loss: 1.482162, loss_ss: 1.153006, loss_d: 0.329156
0.3076 --- loss: 1.699531, loss_ss: 1.241311, loss_d: 0.458220
0.3460 --- loss: 1.191110, loss_ss: 0.968579, loss_d: 0.222531
0.3845 --- loss: 1.278863, loss_ss: 1.020836, loss_d: 0.258028
0.4229 --- loss: 1.759414, loss_ss: 1.137619, loss_d: 0.621795
0.4614 --- loss: 1.269042, loss_ss: 0.974120, loss_d: 0.294922
0.4998 --- loss: 1.488793, loss_ss: 1.232193, loss_d: 0.256600
0.5383 --- loss: 1.166552, loss_ss: 0.876320, loss_d: 0.290232
0.5767 --- loss: 1.684926, loss_ss: 1.440815, loss_d: 0.244112
0.6151 --- loss: 1.370091, loss_ss: 1.210278, loss_d: 0.159813
0.6536 --- loss: 1.553752, loss_ss: 1.351411, loss_d: 0.202341
0.6920 --- loss: 1.829912, loss_ss: 1.335335, loss_d: 0.494577
0.7305 --- loss: 1.240124, loss_ss: 1.120914, loss_d: 0.119210
0.7689 --- loss: 1.158149, loss_ss: 0.966176, loss_d: 0.191973
0.8074 --- loss: 1.334111, loss_ss: 1.059335, loss_d: 0.274775
0.8458 --- loss: 1.164591, loss_ss: 0.920710, loss_d: 0.243881
0.8843 --- loss: 1.668003, loss_ss: 1.050817, loss_d: 0.617186
0.9227 --- loss: 1.670218, loss_ss: 1.234446, loss_d: 0.435773
0.9612 --- loss: 1.553789, loss_ss: 0.953706, loss_d: 0.600084
0.9996 --- loss: 1.246981, loss_ss: 1.162818, loss_d: 0.084163
Epoch finished! Loss: 1.5132193056436685
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.469298, loss_ss: 1.118547, loss_d: 0.350751
0.0384 --- loss: 1.352667, loss_ss: 1.011690, loss_d: 0.340977
0.0769 --- loss: 1.106330, loss_ss: 1.000811, loss_d: 0.105519
0.1153 --- loss: 1.443555, loss_ss: 1.168610, loss_d: 0.274945
0.1538 --- loss: 0.947053, loss_ss: 0.821867, loss_d: 0.125185
0.1922 --- loss: 1.373008, loss_ss: 0.890737, loss_d: 0.482271
0.2307 --- loss: 1.427334, loss_ss: 1.074692, loss_d: 0.352641
0.2691 --- loss: 2.117573, loss_ss: 1.263924, loss_d: 0.853650
0.3076 --- loss: 2.134306, loss_ss: 0.987137, loss_d: 1.147170
0.3460 --- loss: 1.341494, loss_ss: 0.919161, loss_d: 0.422334
0.3845 --- loss: 1.624193, loss_ss: 1.137982, loss_d: 0.486211
0.4229 --- loss: 1.831324, loss_ss: 1.313445, loss_d: 0.517879
0.4614 --- loss: 1.157535, loss_ss: 0.939740, loss_d: 0.217795
0.4998 --- loss: 1.431096, loss_ss: 1.088249, loss_d: 0.342848
0.5383 --- loss: 0.932894, loss_ss: 0.791261, loss_d: 0.141633
0.5767 --- loss: 1.328636, loss_ss: 1.019362, loss_d: 0.309275
0.6151 --- loss: 1.344808, loss_ss: 0.935347, loss_d: 0.409460
0.6536 --- loss: 1.253133, loss_ss: 0.963865, loss_d: 0.289269
0.6920 --- loss: 1.199643, loss_ss: 0.845873, loss_d: 0.353770
0.7305 --- loss: 1.112701, loss_ss: 0.997544, loss_d: 0.115157
0.7689 --- loss: 1.363456, loss_ss: 0.998018, loss_d: 0.365438
0.8074 --- loss: 1.581726, loss_ss: 0.787429, loss_d: 0.794297
0.8458 --- loss: 1.419264, loss_ss: 0.959902, loss_d: 0.459362
0.8843 --- loss: 1.223353, loss_ss: 0.978500, loss_d: 0.244853
0.9227 --- loss: 1.010090, loss_ss: 0.761830, loss_d: 0.248260
0.9612 --- loss: 1.404394, loss_ss: 0.993894, loss_d: 0.410500
0.9996 --- loss: 2.362526, loss_ss: 2.342762, loss_d: 0.019765
Epoch finished! Loss: 1.3511083265909782
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.032758, loss_ss: 0.842285, loss_d: 0.190473
0.0384 --- loss: 1.232084, loss_ss: 0.930535, loss_d: 0.301549
0.0769 --- loss: 0.989399, loss_ss: 0.692729, loss_d: 0.296669
0.1153 --- loss: 1.005997, loss_ss: 0.743330, loss_d: 0.262667
0.1538 --- loss: 1.382913, loss_ss: 0.864167, loss_d: 0.518746
0.1922 --- loss: 0.936100, loss_ss: 0.835494, loss_d: 0.100606
0.2307 --- loss: 1.360860, loss_ss: 1.055939, loss_d: 0.304922
0.2691 --- loss: 1.489321, loss_ss: 0.997803, loss_d: 0.491518
0.3076 --- loss: 1.602120, loss_ss: 0.866910, loss_d: 0.735210
0.3460 --- loss: 0.830359, loss_ss: 0.683157, loss_d: 0.147203
0.3845 --- loss: 1.549645, loss_ss: 1.267855, loss_d: 0.281790
0.4229 --- loss: 1.667040, loss_ss: 1.360960, loss_d: 0.306080
0.4614 --- loss: 1.168480, loss_ss: 1.069058, loss_d: 0.099422
0.4998 --- loss: 1.360417, loss_ss: 0.788839, loss_d: 0.571578
0.5383 --- loss: 1.067354, loss_ss: 0.965799, loss_d: 0.101556
0.5767 --- loss: 1.002209, loss_ss: 0.970964, loss_d: 0.031245
0.6151 --- loss: 0.942604, loss_ss: 0.922496, loss_d: 0.020108
0.6536 --- loss: 1.246158, loss_ss: 0.885351, loss_d: 0.360807
0.6920 --- loss: 1.125162, loss_ss: 0.933240, loss_d: 0.191923
0.7305 --- loss: 1.271779, loss_ss: 1.031283, loss_d: 0.240496
0.7689 --- loss: 0.950589, loss_ss: 0.813558, loss_d: 0.137030
0.8074 --- loss: 1.255826, loss_ss: 0.752795, loss_d: 0.503031
0.8458 --- loss: 1.247302, loss_ss: 1.066604, loss_d: 0.180697
0.8843 --- loss: 0.914689, loss_ss: 0.761525, loss_d: 0.153165
0.9227 --- loss: 1.054742, loss_ss: 0.803919, loss_d: 0.250823
0.9612 --- loss: 1.278743, loss_ss: 1.154184, loss_d: 0.124559
0.9996 --- loss: 2.881647, loss_ss: 2.871735, loss_d: 0.009911
Epoch finished! Loss: 1.2259630150519885
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.146114, loss_ss: 0.956967, loss_d: 0.189147
0.0384 --- loss: 0.913028, loss_ss: 0.703726, loss_d: 0.209302
0.0769 --- loss: 1.041734, loss_ss: 0.761173, loss_d: 0.280561
0.1153 --- loss: 2.137620, loss_ss: 0.826549, loss_d: 1.311071
0.1538 --- loss: 1.074580, loss_ss: 0.933353, loss_d: 0.141226
0.1922 --- loss: 1.198841, loss_ss: 1.107654, loss_d: 0.091187
0.2307 --- loss: 1.249158, loss_ss: 0.691248, loss_d: 0.557910
0.2691 --- loss: 1.131352, loss_ss: 0.904224, loss_d: 0.227128
0.3076 --- loss: 1.543350, loss_ss: 1.106082, loss_d: 0.437268
0.3460 --- loss: 0.983717, loss_ss: 0.848455, loss_d: 0.135262
0.3845 --- loss: 1.036373, loss_ss: 0.871662, loss_d: 0.164711
0.4229 --- loss: 0.949946, loss_ss: 0.778469, loss_d: 0.171477
0.4614 --- loss: 1.197724, loss_ss: 0.884832, loss_d: 0.312891
0.4998 --- loss: 1.074267, loss_ss: 0.923909, loss_d: 0.150358
0.5383 --- loss: 1.019888, loss_ss: 0.832542, loss_d: 0.187346
0.5767 --- loss: 0.752669, loss_ss: 0.664986, loss_d: 0.087684
0.6151 --- loss: 0.960442, loss_ss: 0.879714, loss_d: 0.080728
0.6536 --- loss: 0.989543, loss_ss: 0.892172, loss_d: 0.097371
0.6920 --- loss: 1.120013, loss_ss: 0.723109, loss_d: 0.396904
0.7305 --- loss: 1.218059, loss_ss: 0.950725, loss_d: 0.267334
0.7689 --- loss: 0.866312, loss_ss: 0.755489, loss_d: 0.110823
0.8074 --- loss: 1.236051, loss_ss: 0.803268, loss_d: 0.432783
0.8458 --- loss: 1.747931, loss_ss: 0.723254, loss_d: 1.024677
0.8843 --- loss: 1.961323, loss_ss: 1.828786, loss_d: 0.132537
0.9227 --- loss: 0.999716, loss_ss: 0.932599, loss_d: 0.067117
0.9612 --- loss: 1.058762, loss_ss: 0.868989, loss_d: 0.189773
0.9996 --- loss: 1.075505, loss_ss: 1.042533, loss_d: 0.032972
Epoch finished! Loss: 1.1405783167252175
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.054746, loss_ss: 0.874300, loss_d: 0.180446
0.0384 --- loss: 1.103153, loss_ss: 1.073026, loss_d: 0.030127
0.0769 --- loss: 0.967463, loss_ss: 0.949953, loss_d: 0.017510
0.1153 --- loss: 1.012799, loss_ss: 0.762408, loss_d: 0.250391
0.1538 --- loss: 1.254504, loss_ss: 1.232181, loss_d: 0.022322
0.1922 --- loss: 0.818491, loss_ss: 0.696077, loss_d: 0.122414
0.2307 --- loss: 1.223211, loss_ss: 0.828040, loss_d: 0.395171
0.2691 --- loss: 0.979468, loss_ss: 0.857982, loss_d: 0.121486
0.3076 --- loss: 2.315594, loss_ss: 1.463237, loss_d: 0.852357
0.3460 --- loss: 0.913755, loss_ss: 0.843382, loss_d: 0.070373
0.3845 --- loss: 0.806854, loss_ss: 0.740342, loss_d: 0.066511
0.4229 --- loss: 1.065471, loss_ss: 0.839335, loss_d: 0.226136
0.4614 --- loss: 0.955942, loss_ss: 0.850296, loss_d: 0.105646
0.4998 --- loss: 1.062276, loss_ss: 0.835717, loss_d: 0.226558
0.5383 --- loss: 1.061751, loss_ss: 0.926749, loss_d: 0.135002
0.5767 --- loss: 0.742012, loss_ss: 0.679906, loss_d: 0.062107
0.6151 --- loss: 0.850666, loss_ss: 0.837234, loss_d: 0.013433
0.6536 --- loss: 1.114392, loss_ss: 0.788483, loss_d: 0.325909
0.6920 --- loss: 0.743970, loss_ss: 0.627206, loss_d: 0.116764
0.7305 --- loss: 1.183841, loss_ss: 0.884712, loss_d: 0.299129
0.7689 --- loss: 0.906441, loss_ss: 0.817842, loss_d: 0.088599
0.8074 --- loss: 0.944845, loss_ss: 0.722257, loss_d: 0.222588
0.8458 --- loss: 1.211227, loss_ss: 1.156036, loss_d: 0.055190
0.8843 --- loss: 1.234296, loss_ss: 1.164974, loss_d: 0.069322
0.9227 --- loss: 1.027153, loss_ss: 0.878401, loss_d: 0.148752
0.9612 --- loss: 0.934088, loss_ss: 0.806627, loss_d: 0.127462
0.9996 --- loss: 0.807621, loss_ss: 0.806509, loss_d: 0.001112
Epoch finished! Loss: 1.0271882843512756
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.822419, loss_ss: 0.624286, loss_d: 0.198134
0.0384 --- loss: 0.779441, loss_ss: 0.747475, loss_d: 0.031966
0.0769 --- loss: 1.009932, loss_ss: 0.799277, loss_d: 0.210655
0.1153 --- loss: 1.037811, loss_ss: 0.907386, loss_d: 0.130425
0.1538 --- loss: 0.783814, loss_ss: 0.738773, loss_d: 0.045041
0.1922 --- loss: 1.048955, loss_ss: 1.023229, loss_d: 0.025726
0.2307 --- loss: 0.870929, loss_ss: 0.846496, loss_d: 0.024433
0.2691 --- loss: 0.982834, loss_ss: 0.792936, loss_d: 0.189898
0.3076 --- loss: 0.970811, loss_ss: 0.897726, loss_d: 0.073084
0.3460 --- loss: 0.838878, loss_ss: 0.798735, loss_d: 0.040144
0.3845 --- loss: 0.603923, loss_ss: 0.551399, loss_d: 0.052524
0.4229 --- loss: 0.939186, loss_ss: 0.909441, loss_d: 0.029744
0.4614 --- loss: 0.717103, loss_ss: 0.667226, loss_d: 0.049877
0.4998 --- loss: 0.875190, loss_ss: 0.674626, loss_d: 0.200564
0.5383 --- loss: 1.003812, loss_ss: 0.761472, loss_d: 0.242340
0.5767 --- loss: 1.630166, loss_ss: 1.344844, loss_d: 0.285322
0.6151 --- loss: 0.911116, loss_ss: 0.812010, loss_d: 0.099106
0.6536 --- loss: 0.810054, loss_ss: 0.723917, loss_d: 0.086137
0.6920 --- loss: 0.913905, loss_ss: 0.896300, loss_d: 0.017604
0.7305 --- loss: 0.864125, loss_ss: 0.645659, loss_d: 0.218466
0.7689 --- loss: 0.842597, loss_ss: 0.804804, loss_d: 0.037793
0.8074 --- loss: 1.053478, loss_ss: 0.868493, loss_d: 0.184985
0.8458 --- loss: 0.890440, loss_ss: 0.862382, loss_d: 0.028058
0.8843 --- loss: 0.839509, loss_ss: 0.800454, loss_d: 0.039055
0.9227 --- loss: 0.896166, loss_ss: 0.798910, loss_d: 0.097255
0.9612 --- loss: 1.054114, loss_ss: 0.993037, loss_d: 0.061076
0.9996 --- loss: 1.351944, loss_ss: 1.345152, loss_d: 0.006792
Epoch finished! Loss: 0.9965776970753303
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.682546, loss_ss: 0.666098, loss_d: 0.016448
0.0384 --- loss: 1.307647, loss_ss: 1.148547, loss_d: 0.159100
0.0769 --- loss: 0.712000, loss_ss: 0.600144, loss_d: 0.111856
0.1153 --- loss: 0.982662, loss_ss: 0.935227, loss_d: 0.047435
0.1538 --- loss: 1.220289, loss_ss: 0.948170, loss_d: 0.272118
0.1922 --- loss: 0.938486, loss_ss: 0.875808, loss_d: 0.062678
0.2307 --- loss: 0.839499, loss_ss: 0.800091, loss_d: 0.039408
0.2691 --- loss: 0.815390, loss_ss: 0.799133, loss_d: 0.016257
0.3076 --- loss: 0.930525, loss_ss: 0.795365, loss_d: 0.135159
0.3460 --- loss: 0.723386, loss_ss: 0.706809, loss_d: 0.016577
0.3845 --- loss: 0.754225, loss_ss: 0.741836, loss_d: 0.012390
0.4229 --- loss: 0.465147, loss_ss: 0.453402, loss_d: 0.011745
0.4614 --- loss: 0.792330, loss_ss: 0.687233, loss_d: 0.105097
0.4998 --- loss: 0.763669, loss_ss: 0.756323, loss_d: 0.007346
0.5383 --- loss: 0.813064, loss_ss: 0.737547, loss_d: 0.075518
0.5767 --- loss: 0.697270, loss_ss: 0.633280, loss_d: 0.063991
0.6151 --- loss: 0.751536, loss_ss: 0.700723, loss_d: 0.050814
0.6536 --- loss: 0.855703, loss_ss: 0.840778, loss_d: 0.014925
0.6920 --- loss: 1.073683, loss_ss: 0.805717, loss_d: 0.267967
0.7305 --- loss: 0.802570, loss_ss: 0.781860, loss_d: 0.020709
0.7689 --- loss: 0.844655, loss_ss: 0.802280, loss_d: 0.042375
0.8074 --- loss: 0.860580, loss_ss: 0.776088, loss_d: 0.084492
0.8458 --- loss: 1.333452, loss_ss: 0.868258, loss_d: 0.465193
0.8843 --- loss: 0.685924, loss_ss: 0.680578, loss_d: 0.005346
0.9227 --- loss: 1.134970, loss_ss: 1.104482, loss_d: 0.030487
0.9612 --- loss: 1.252779, loss_ss: 1.219277, loss_d: 0.033501
0.9996 --- loss: 1.301793, loss_ss: 1.298543, loss_d: 0.003250
Epoch finished! Loss: 0.948457224208575
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.885228, loss_ss: 0.838162, loss_d: 0.047066
0.0384 --- loss: 0.858886, loss_ss: 0.793573, loss_d: 0.065313
0.0769 --- loss: 0.929682, loss_ss: 0.862186, loss_d: 0.067495
0.1153 --- loss: 0.726412, loss_ss: 0.702006, loss_d: 0.024406
0.1538 --- loss: 0.782412, loss_ss: 0.676166, loss_d: 0.106246
0.1922 --- loss: 0.939300, loss_ss: 0.727770, loss_d: 0.211530
0.2307 --- loss: 0.778920, loss_ss: 0.755882, loss_d: 0.023037
0.2691 --- loss: 0.926555, loss_ss: 0.916841, loss_d: 0.009714
0.3076 --- loss: 0.728959, loss_ss: 0.716298, loss_d: 0.012662
0.3460 --- loss: 0.971636, loss_ss: 0.945728, loss_d: 0.025908
0.3845 --- loss: 0.817015, loss_ss: 0.799391, loss_d: 0.017624
0.4229 --- loss: 0.730305, loss_ss: 0.710304, loss_d: 0.020001
0.4614 --- loss: 1.015764, loss_ss: 0.876956, loss_d: 0.138808
0.4998 --- loss: 0.853916, loss_ss: 0.713601, loss_d: 0.140315
0.5383 --- loss: 0.900978, loss_ss: 0.881128, loss_d: 0.019849
0.5767 --- loss: 0.938878, loss_ss: 0.906405, loss_d: 0.032473
0.6151 --- loss: 1.155365, loss_ss: 0.890175, loss_d: 0.265190
0.6536 --- loss: 0.977420, loss_ss: 0.851585, loss_d: 0.125835
0.6920 --- loss: 0.816550, loss_ss: 0.730730, loss_d: 0.085820
0.7305 --- loss: 0.844033, loss_ss: 0.789079, loss_d: 0.054955
0.7689 --- loss: 1.103379, loss_ss: 1.064243, loss_d: 0.039135
0.8074 --- loss: 0.846205, loss_ss: 0.801629, loss_d: 0.044576
0.8458 --- loss: 0.628250, loss_ss: 0.555038, loss_d: 0.073212
0.8843 --- loss: 0.795514, loss_ss: 0.731527, loss_d: 0.063987
0.9227 --- loss: 0.731352, loss_ss: 0.644437, loss_d: 0.086915
0.9612 --- loss: 0.790898, loss_ss: 0.768187, loss_d: 0.022711
0.9996 --- loss: 2.614493, loss_ss: 2.613451, loss_d: 0.001042
Epoch finished! Loss: 0.9084546020397773
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.748408, loss_ss: 0.735984, loss_d: 0.012424
0.0384 --- loss: 0.802143, loss_ss: 0.711544, loss_d: 0.090599
0.0769 --- loss: 1.151156, loss_ss: 0.898889, loss_d: 0.252267
0.1153 --- loss: 0.810158, loss_ss: 0.776160, loss_d: 0.033998
0.1538 --- loss: 1.151416, loss_ss: 0.971854, loss_d: 0.179562
0.1922 --- loss: 1.051191, loss_ss: 0.875730, loss_d: 0.175461
0.2307 --- loss: 0.800540, loss_ss: 0.780997, loss_d: 0.019543
0.2691 --- loss: 1.068815, loss_ss: 1.045861, loss_d: 0.022954
0.3076 --- loss: 0.849983, loss_ss: 0.843706, loss_d: 0.006277
0.3460 --- loss: 1.072000, loss_ss: 0.906895, loss_d: 0.165105
0.3845 --- loss: 0.708065, loss_ss: 0.673886, loss_d: 0.034179
0.4229 --- loss: 0.692666, loss_ss: 0.668110, loss_d: 0.024557
0.4614 --- loss: 0.633924, loss_ss: 0.576384, loss_d: 0.057540
0.4998 --- loss: 0.729564, loss_ss: 0.716419, loss_d: 0.013145
0.5383 --- loss: 0.902042, loss_ss: 0.822505, loss_d: 0.079537
0.5767 --- loss: 1.064299, loss_ss: 0.894866, loss_d: 0.169433
0.6151 --- loss: 0.629534, loss_ss: 0.590739, loss_d: 0.038796
0.6536 --- loss: 0.881492, loss_ss: 0.803853, loss_d: 0.077639
0.6920 --- loss: 1.300694, loss_ss: 1.088890, loss_d: 0.211804
0.7305 --- loss: 0.883279, loss_ss: 0.629726, loss_d: 0.253553
0.7689 --- loss: 0.895016, loss_ss: 0.795100, loss_d: 0.099915
0.8074 --- loss: 1.086086, loss_ss: 0.680866, loss_d: 0.405219
0.8458 --- loss: 0.639425, loss_ss: 0.623332, loss_d: 0.016093
0.8843 --- loss: 0.915520, loss_ss: 0.881308, loss_d: 0.034212
0.9227 --- loss: 0.862418, loss_ss: 0.859140, loss_d: 0.003278
0.9612 --- loss: 0.829240, loss_ss: 0.799143, loss_d: 0.030097
0.9996 --- loss: 1.375462, loss_ss: 1.329847, loss_d: 0.045615
Epoch finished! Loss: 0.9211768239736557
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5648648648648649
             precision    recall  f1-score   support

        0.0       0.78      0.63      0.70       232
        1.0       0.33      0.64      0.43       179
        2.0       0.48      0.38      0.43       246
        3.0       1.00      0.62      0.77       339
        4.0       0.37      0.53      0.43       114

avg / total       0.67      0.56      0.59      1110
 


====== chp024-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.56  63.36   95.22   77.78     69.83
1  72.79  64.25   74.44   32.58     43.23
2  77.30  38.21   88.43   48.45     42.73
3  88.47  62.24  100.00  100.00     76.73
4  85.86  52.63   89.66   36.81     43.32
Total accuracy: 56.49%
Average sen: 56.14%
Average spec: 89.55%
Macro f1-score: 55.17%
Diagnosis acc on 15mins: 0.918918918918919
[0.98432505 0.84672302 0.39847806 0.96891338 0.99889886 0.99668688
 0.99148375 0.99227929 0.98689693 0.99842572 0.98058516 0.99723756
 0.9977386  0.9950971  0.95425659 0.75249344 0.8230744  0.41955879
 0.99551505 0.99289882 0.97633398 0.99341714 0.99663651 0.99904269
 0.99400264 0.99230617 0.88866729 0.87913764 0.55386716 0.11691955
 0.99006093 0.99458742 0.89191824 0.9714945  0.93410611 0.95837224
 0.97067082]
pred: 0.8965704722984417, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.410847, loss_ss: 1.736071, loss_d: 0.674776
0.0381 --- loss: 2.024326, loss_ss: 1.550359, loss_d: 0.473966
0.0762 --- loss: 2.146567, loss_ss: 1.565712, loss_d: 0.580855
0.1143 --- loss: 2.453794, loss_ss: 1.507474, loss_d: 0.946320
0.1524 --- loss: 2.204762, loss_ss: 1.497640, loss_d: 0.707122
0.1905 --- loss: 2.044777, loss_ss: 1.400697, loss_d: 0.644081
0.2287 --- loss: 1.947212, loss_ss: 1.498586, loss_d: 0.448626
0.2668 --- loss: 2.102282, loss_ss: 1.314420, loss_d: 0.787862
0.3049 --- loss: 1.815181, loss_ss: 1.323498, loss_d: 0.491683
0.3430 --- loss: 1.782484, loss_ss: 1.352788, loss_d: 0.429696
0.3811 --- loss: 1.874777, loss_ss: 1.271601, loss_d: 0.603176
0.4192 --- loss: 2.122270, loss_ss: 1.421225, loss_d: 0.701045
0.4573 --- loss: 1.596007, loss_ss: 1.240457, loss_d: 0.355550
0.4954 --- loss: 1.966223, loss_ss: 1.306016, loss_d: 0.660207
0.5335 --- loss: 2.164785, loss_ss: 1.336482, loss_d: 0.828303
0.5716 --- loss: 1.881242, loss_ss: 1.278698, loss_d: 0.602544
0.6098 --- loss: 1.792166, loss_ss: 1.330136, loss_d: 0.462030
0.6479 --- loss: 1.943177, loss_ss: 1.099717, loss_d: 0.843460
0.6860 --- loss: 1.889494, loss_ss: 1.398487, loss_d: 0.491007
0.7241 --- loss: 1.520459, loss_ss: 1.109387, loss_d: 0.411072
0.7622 --- loss: 1.851494, loss_ss: 1.319038, loss_d: 0.532457
0.8003 --- loss: 1.635276, loss_ss: 1.058221, loss_d: 0.577056
0.8384 --- loss: 1.876392, loss_ss: 1.136495, loss_d: 0.739896
0.8765 --- loss: 1.595146, loss_ss: 1.145561, loss_d: 0.449585
0.9146 --- loss: 1.508814, loss_ss: 1.268071, loss_d: 0.240743
0.9527 --- loss: 1.224439, loss_ss: 1.066059, loss_d: 0.158381
0.9909 --- loss: 1.461855, loss_ss: 1.143911, loss_d: 0.317944
Epoch finished! Loss: 1.852930998984184
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.455471, loss_ss: 1.110408, loss_d: 0.345063
0.0381 --- loss: 1.682561, loss_ss: 1.086547, loss_d: 0.596014
0.0762 --- loss: 1.638545, loss_ss: 1.393406, loss_d: 0.245139
0.1143 --- loss: 1.409006, loss_ss: 1.071993, loss_d: 0.337013
0.1524 --- loss: 1.370130, loss_ss: 1.067385, loss_d: 0.302746
0.1905 --- loss: 2.012828, loss_ss: 1.111264, loss_d: 0.901564
0.2287 --- loss: 1.676468, loss_ss: 1.151577, loss_d: 0.524891
0.2668 --- loss: 1.531645, loss_ss: 1.056633, loss_d: 0.475012
0.3049 --- loss: 1.510021, loss_ss: 1.156304, loss_d: 0.353717
0.3430 --- loss: 1.527259, loss_ss: 1.057218, loss_d: 0.470041
0.3811 --- loss: 1.150198, loss_ss: 0.853610, loss_d: 0.296588
0.4192 --- loss: 1.595755, loss_ss: 0.884553, loss_d: 0.711201
0.4573 --- loss: 1.294639, loss_ss: 1.062576, loss_d: 0.232063
0.4954 --- loss: 1.369107, loss_ss: 1.037851, loss_d: 0.331256
0.5335 --- loss: 1.324154, loss_ss: 1.086452, loss_d: 0.237702
0.5716 --- loss: 1.183341, loss_ss: 0.941970, loss_d: 0.241371
0.6098 --- loss: 1.253057, loss_ss: 0.921014, loss_d: 0.332043
0.6479 --- loss: 1.905180, loss_ss: 1.034462, loss_d: 0.870718
0.6860 --- loss: 1.184047, loss_ss: 0.965707, loss_d: 0.218340
0.7241 --- loss: 1.693567, loss_ss: 0.996071, loss_d: 0.697495
0.7622 --- loss: 1.670783, loss_ss: 1.160796, loss_d: 0.509987
0.8003 --- loss: 1.240935, loss_ss: 1.044287, loss_d: 0.196649
0.8384 --- loss: 1.236210, loss_ss: 1.034194, loss_d: 0.202015
0.8765 --- loss: 1.509265, loss_ss: 1.047785, loss_d: 0.461480
0.9146 --- loss: 1.361033, loss_ss: 1.220590, loss_d: 0.140443
0.9527 --- loss: 1.591155, loss_ss: 0.885800, loss_d: 0.705356
0.9909 --- loss: 1.788047, loss_ss: 1.185320, loss_d: 0.602727
Epoch finished! Loss: 1.43762389758161
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.070805, loss_ss: 0.958698, loss_d: 0.112107
0.0381 --- loss: 1.177653, loss_ss: 0.974183, loss_d: 0.203469
0.0762 --- loss: 1.447053, loss_ss: 1.065492, loss_d: 0.381561
0.1143 --- loss: 1.213978, loss_ss: 0.976674, loss_d: 0.237304
0.1524 --- loss: 1.353975, loss_ss: 1.233580, loss_d: 0.120395
0.1905 --- loss: 1.369134, loss_ss: 1.240120, loss_d: 0.129013
0.2287 --- loss: 1.566281, loss_ss: 1.326365, loss_d: 0.239916
0.2668 --- loss: 1.163105, loss_ss: 0.763603, loss_d: 0.399501
0.3049 --- loss: 1.599726, loss_ss: 1.162547, loss_d: 0.437180
0.3430 --- loss: 1.199344, loss_ss: 0.897745, loss_d: 0.301600
0.3811 --- loss: 1.278781, loss_ss: 1.042891, loss_d: 0.235890
0.4192 --- loss: 1.574512, loss_ss: 1.250636, loss_d: 0.323876
0.4573 --- loss: 1.177595, loss_ss: 0.932195, loss_d: 0.245400
0.4954 --- loss: 1.298471, loss_ss: 0.825082, loss_d: 0.473389
0.5335 --- loss: 1.125992, loss_ss: 0.862740, loss_d: 0.263252
0.5716 --- loss: 0.957775, loss_ss: 0.819530, loss_d: 0.138245
0.6098 --- loss: 0.873959, loss_ss: 0.796167, loss_d: 0.077792
0.6479 --- loss: 0.911342, loss_ss: 0.811547, loss_d: 0.099796
0.6860 --- loss: 0.959036, loss_ss: 0.838455, loss_d: 0.120581
0.7241 --- loss: 1.451657, loss_ss: 0.802704, loss_d: 0.648953
0.7622 --- loss: 0.930808, loss_ss: 0.829918, loss_d: 0.100890
0.8003 --- loss: 1.002789, loss_ss: 0.901411, loss_d: 0.101378
0.8384 --- loss: 0.946744, loss_ss: 0.855116, loss_d: 0.091628
0.8765 --- loss: 1.236299, loss_ss: 0.844553, loss_d: 0.391746
0.9146 --- loss: 0.960785, loss_ss: 0.804997, loss_d: 0.155788
0.9527 --- loss: 1.046119, loss_ss: 0.982338, loss_d: 0.063780
0.9909 --- loss: 1.114208, loss_ss: 1.012089, loss_d: 0.102119
Epoch finished! Loss: 1.28135629259903
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.435873, loss_ss: 0.879699, loss_d: 0.556174
0.0381 --- loss: 1.026884, loss_ss: 0.869464, loss_d: 0.157419
0.0762 --- loss: 1.328758, loss_ss: 1.095797, loss_d: 0.232962
0.1143 --- loss: 1.063217, loss_ss: 0.918555, loss_d: 0.144662
0.1524 --- loss: 0.985856, loss_ss: 0.829331, loss_d: 0.156525
0.1905 --- loss: 1.239253, loss_ss: 0.971725, loss_d: 0.267529
0.2287 --- loss: 1.382506, loss_ss: 1.076171, loss_d: 0.306335
0.2668 --- loss: 1.086375, loss_ss: 0.980250, loss_d: 0.106125
0.3049 --- loss: 0.820841, loss_ss: 0.754318, loss_d: 0.066523
0.3430 --- loss: 0.968288, loss_ss: 0.885425, loss_d: 0.082863
0.3811 --- loss: 1.207436, loss_ss: 1.090877, loss_d: 0.116559
0.4192 --- loss: 1.137890, loss_ss: 0.882845, loss_d: 0.255045
0.4573 --- loss: 1.004657, loss_ss: 0.809412, loss_d: 0.195244
0.4954 --- loss: 1.264606, loss_ss: 0.940789, loss_d: 0.323817
0.5335 --- loss: 1.112733, loss_ss: 0.905735, loss_d: 0.206998
0.5716 --- loss: 1.012422, loss_ss: 0.912266, loss_d: 0.100155
0.6098 --- loss: 1.083024, loss_ss: 0.922446, loss_d: 0.160579
0.6479 --- loss: 1.013741, loss_ss: 0.955578, loss_d: 0.058163
0.6860 --- loss: 0.616687, loss_ss: 0.517743, loss_d: 0.098944
0.7241 --- loss: 0.945204, loss_ss: 0.858806, loss_d: 0.086398
0.7622 --- loss: 1.155371, loss_ss: 0.981370, loss_d: 0.174001
0.8003 --- loss: 1.221760, loss_ss: 0.870568, loss_d: 0.351192
0.8384 --- loss: 0.908978, loss_ss: 0.831923, loss_d: 0.077055
0.8765 --- loss: 1.101847, loss_ss: 0.997330, loss_d: 0.104517
0.9146 --- loss: 0.990442, loss_ss: 0.865213, loss_d: 0.125229
0.9527 --- loss: 0.872898, loss_ss: 0.793808, loss_d: 0.079090
0.9909 --- loss: 0.779494, loss_ss: 0.712328, loss_d: 0.067166
Epoch finished! Loss: 1.165321143756386
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.133850, loss_ss: 0.889427, loss_d: 0.244423
0.0381 --- loss: 1.233729, loss_ss: 0.597785, loss_d: 0.635944
0.0762 --- loss: 1.009588, loss_ss: 0.919430, loss_d: 0.090158
0.1143 --- loss: 1.041236, loss_ss: 1.013041, loss_d: 0.028196
0.1524 --- loss: 1.917667, loss_ss: 1.095100, loss_d: 0.822568
0.1905 --- loss: 1.418500, loss_ss: 1.360000, loss_d: 0.058501
0.2287 --- loss: 0.853557, loss_ss: 0.788549, loss_d: 0.065008
0.2668 --- loss: 1.527857, loss_ss: 1.137942, loss_d: 0.389916
0.3049 --- loss: 1.309289, loss_ss: 0.923365, loss_d: 0.385924
0.3430 --- loss: 1.081578, loss_ss: 0.969053, loss_d: 0.112525
0.3811 --- loss: 0.782153, loss_ss: 0.755713, loss_d: 0.026440
0.4192 --- loss: 0.896562, loss_ss: 0.851992, loss_d: 0.044570
0.4573 --- loss: 1.171919, loss_ss: 0.827738, loss_d: 0.344181
0.4954 --- loss: 1.179728, loss_ss: 1.027489, loss_d: 0.152239
0.5335 --- loss: 1.309819, loss_ss: 0.979101, loss_d: 0.330718
0.5716 --- loss: 0.968235, loss_ss: 0.757954, loss_d: 0.210281
0.6098 --- loss: 1.382747, loss_ss: 0.645125, loss_d: 0.737622
0.6479 --- loss: 1.165938, loss_ss: 0.672015, loss_d: 0.493924
0.6860 --- loss: 0.967765, loss_ss: 0.920020, loss_d: 0.047745
0.7241 --- loss: 0.899399, loss_ss: 0.778027, loss_d: 0.121372
0.7622 --- loss: 0.743003, loss_ss: 0.669338, loss_d: 0.073664
0.8003 --- loss: 1.019260, loss_ss: 0.870746, loss_d: 0.148514
0.8384 --- loss: 1.276066, loss_ss: 0.777792, loss_d: 0.498274
0.8765 --- loss: 1.239549, loss_ss: 1.058377, loss_d: 0.181172
0.9146 --- loss: 0.977265, loss_ss: 0.854337, loss_d: 0.122928
0.9527 --- loss: 0.947270, loss_ss: 0.763392, loss_d: 0.183877
0.9909 --- loss: 0.980159, loss_ss: 0.814964, loss_d: 0.165195
Epoch finished! Loss: 1.10748903464725
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.869702, loss_ss: 0.694799, loss_d: 0.174904
0.0381 --- loss: 0.806943, loss_ss: 0.673274, loss_d: 0.133669
0.0762 --- loss: 1.293294, loss_ss: 1.003075, loss_d: 0.290219
0.1143 --- loss: 1.212755, loss_ss: 1.038754, loss_d: 0.174002
0.1524 --- loss: 0.981013, loss_ss: 0.768371, loss_d: 0.212642
0.1905 --- loss: 0.763656, loss_ss: 0.707365, loss_d: 0.056291
0.2287 --- loss: 0.745003, loss_ss: 0.718522, loss_d: 0.026481
0.2668 --- loss: 1.053693, loss_ss: 0.906924, loss_d: 0.146769
0.3049 --- loss: 1.028056, loss_ss: 1.005880, loss_d: 0.022176
0.3430 --- loss: 1.002510, loss_ss: 0.952683, loss_d: 0.049827
0.3811 --- loss: 1.062568, loss_ss: 0.883509, loss_d: 0.179059
0.4192 --- loss: 1.241633, loss_ss: 1.193911, loss_d: 0.047722
0.4573 --- loss: 1.011003, loss_ss: 0.915279, loss_d: 0.095724
0.4954 --- loss: 0.916381, loss_ss: 0.681580, loss_d: 0.234801
0.5335 --- loss: 0.835622, loss_ss: 0.816677, loss_d: 0.018945
0.5716 --- loss: 1.246208, loss_ss: 0.813300, loss_d: 0.432909
0.6098 --- loss: 1.058865, loss_ss: 0.929894, loss_d: 0.128971
0.6479 --- loss: 1.116522, loss_ss: 1.018497, loss_d: 0.098025
0.6860 --- loss: 0.773676, loss_ss: 0.734700, loss_d: 0.038976
0.7241 --- loss: 1.120970, loss_ss: 1.019359, loss_d: 0.101611
0.7622 --- loss: 0.854443, loss_ss: 0.835820, loss_d: 0.018623
0.8003 --- loss: 1.220761, loss_ss: 1.010987, loss_d: 0.209774
0.8384 --- loss: 0.983750, loss_ss: 0.803730, loss_d: 0.180020
0.8765 --- loss: 0.928760, loss_ss: 0.847388, loss_d: 0.081371
0.9146 --- loss: 1.277662, loss_ss: 1.037743, loss_d: 0.239919
0.9527 --- loss: 1.285415, loss_ss: 0.636137, loss_d: 0.649277
0.9909 --- loss: 0.704182, loss_ss: 0.681626, loss_d: 0.022556
Epoch finished! Loss: 1.0138390885509607
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.866135, loss_ss: 0.785284, loss_d: 0.080851
0.0381 --- loss: 1.151379, loss_ss: 0.904334, loss_d: 0.247044
0.0762 --- loss: 1.027797, loss_ss: 0.935079, loss_d: 0.092718
0.1143 --- loss: 0.953448, loss_ss: 0.815764, loss_d: 0.137684
0.1524 --- loss: 1.392482, loss_ss: 0.948341, loss_d: 0.444141
0.1905 --- loss: 1.060905, loss_ss: 0.969906, loss_d: 0.090999
0.2287 --- loss: 1.475625, loss_ss: 1.052935, loss_d: 0.422690
0.2668 --- loss: 0.710579, loss_ss: 0.652556, loss_d: 0.058023
0.3049 --- loss: 1.168948, loss_ss: 0.890409, loss_d: 0.278539
0.3430 --- loss: 0.911530, loss_ss: 0.768195, loss_d: 0.143335
0.3811 --- loss: 0.867584, loss_ss: 0.847800, loss_d: 0.019784
0.4192 --- loss: 0.903721, loss_ss: 0.796871, loss_d: 0.106849
0.4573 --- loss: 0.834883, loss_ss: 0.783713, loss_d: 0.051171
0.4954 --- loss: 0.973760, loss_ss: 0.907681, loss_d: 0.066079
0.5335 --- loss: 1.042798, loss_ss: 0.999351, loss_d: 0.043447
0.5716 --- loss: 1.007160, loss_ss: 0.931270, loss_d: 0.075889
0.6098 --- loss: 0.892932, loss_ss: 0.629266, loss_d: 0.263666
0.6479 --- loss: 1.301044, loss_ss: 1.161400, loss_d: 0.139644
0.6860 --- loss: 0.778787, loss_ss: 0.757189, loss_d: 0.021598
0.7241 --- loss: 0.885771, loss_ss: 0.706524, loss_d: 0.179248
0.7622 --- loss: 1.484469, loss_ss: 0.993779, loss_d: 0.490689
0.8003 --- loss: 1.355893, loss_ss: 0.834150, loss_d: 0.521744
0.8384 --- loss: 1.582730, loss_ss: 1.028936, loss_d: 0.553794
0.8765 --- loss: 0.837125, loss_ss: 0.738258, loss_d: 0.098867
0.9146 --- loss: 1.265088, loss_ss: 0.747827, loss_d: 0.517261
0.9527 --- loss: 2.006680, loss_ss: 0.959375, loss_d: 1.047306
0.9909 --- loss: 1.185801, loss_ss: 0.916088, loss_d: 0.269714
Epoch finished! Loss: 1.0338984637997533
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.122782, loss_ss: 1.074944, loss_d: 0.047838
0.0381 --- loss: 0.794719, loss_ss: 0.728813, loss_d: 0.065907
0.0762 --- loss: 1.127633, loss_ss: 1.020965, loss_d: 0.106669
0.1143 --- loss: 1.491039, loss_ss: 1.076533, loss_d: 0.414505
0.1524 --- loss: 0.826799, loss_ss: 0.792806, loss_d: 0.033993
0.1905 --- loss: 0.725278, loss_ss: 0.718094, loss_d: 0.007185
0.2287 --- loss: 0.623620, loss_ss: 0.573013, loss_d: 0.050607
0.2668 --- loss: 0.853984, loss_ss: 0.741225, loss_d: 0.112760
0.3049 --- loss: 0.866778, loss_ss: 0.781188, loss_d: 0.085589
0.3430 --- loss: 1.004077, loss_ss: 0.949807, loss_d: 0.054270
0.3811 --- loss: 0.861397, loss_ss: 0.715800, loss_d: 0.145596
0.4192 --- loss: 1.104902, loss_ss: 1.075181, loss_d: 0.029720
0.4573 --- loss: 0.598676, loss_ss: 0.513974, loss_d: 0.084701
0.4954 --- loss: 1.129206, loss_ss: 0.839784, loss_d: 0.289422
0.5335 --- loss: 0.880754, loss_ss: 0.755507, loss_d: 0.125247
0.5716 --- loss: 0.824210, loss_ss: 0.764846, loss_d: 0.059364
0.6098 --- loss: 1.368951, loss_ss: 1.320250, loss_d: 0.048701
0.6479 --- loss: 1.122212, loss_ss: 1.048475, loss_d: 0.073737
0.6860 --- loss: 0.887856, loss_ss: 0.877221, loss_d: 0.010635
0.7241 --- loss: 1.048307, loss_ss: 0.968251, loss_d: 0.080057
0.7622 --- loss: 0.912413, loss_ss: 0.894819, loss_d: 0.017594
0.8003 --- loss: 0.791808, loss_ss: 0.742180, loss_d: 0.049628
0.8384 --- loss: 0.827343, loss_ss: 0.798098, loss_d: 0.029245
0.8765 --- loss: 0.814406, loss_ss: 0.773901, loss_d: 0.040505
0.9146 --- loss: 1.013620, loss_ss: 0.914015, loss_d: 0.099605
0.9527 --- loss: 0.705446, loss_ss: 0.697716, loss_d: 0.007730
0.9909 --- loss: 1.021864, loss_ss: 0.913612, loss_d: 0.108252
Epoch finished! Loss: 0.9708525222221404
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.497325, loss_ss: 0.850498, loss_d: 0.646827
0.0381 --- loss: 1.048478, loss_ss: 0.855554, loss_d: 0.192924
0.0762 --- loss: 0.759611, loss_ss: 0.706260, loss_d: 0.053351
0.1143 --- loss: 0.847755, loss_ss: 0.811902, loss_d: 0.035853
0.1524 --- loss: 1.198679, loss_ss: 0.602320, loss_d: 0.596358
0.1905 --- loss: 0.955899, loss_ss: 0.931354, loss_d: 0.024544
0.2287 --- loss: 0.833588, loss_ss: 0.777057, loss_d: 0.056532
0.2668 --- loss: 0.809892, loss_ss: 0.784451, loss_d: 0.025441
0.3049 --- loss: 0.630500, loss_ss: 0.598377, loss_d: 0.032123
0.3430 --- loss: 0.862183, loss_ss: 0.852862, loss_d: 0.009321
0.3811 --- loss: 0.940115, loss_ss: 0.871833, loss_d: 0.068282
0.4192 --- loss: 1.023603, loss_ss: 0.969170, loss_d: 0.054432
0.4573 --- loss: 1.115548, loss_ss: 0.579651, loss_d: 0.535897
0.4954 --- loss: 0.866629, loss_ss: 0.829944, loss_d: 0.036685
0.5335 --- loss: 0.838997, loss_ss: 0.768106, loss_d: 0.070890
0.5716 --- loss: 1.128905, loss_ss: 1.112620, loss_d: 0.016285
0.6098 --- loss: 0.803907, loss_ss: 0.793374, loss_d: 0.010533
0.6479 --- loss: 1.027213, loss_ss: 1.005562, loss_d: 0.021650
0.6860 --- loss: 0.665784, loss_ss: 0.607787, loss_d: 0.057997
0.7241 --- loss: 1.245450, loss_ss: 1.138258, loss_d: 0.107192
0.7622 --- loss: 1.198317, loss_ss: 0.924223, loss_d: 0.274095
0.8003 --- loss: 1.000227, loss_ss: 0.851245, loss_d: 0.148982
0.8384 --- loss: 1.777395, loss_ss: 1.372395, loss_d: 0.405000
0.8765 --- loss: 0.642712, loss_ss: 0.613987, loss_d: 0.028725
0.9146 --- loss: 0.754740, loss_ss: 0.736945, loss_d: 0.017795
0.9527 --- loss: 0.767391, loss_ss: 0.710772, loss_d: 0.056619
0.9909 --- loss: 1.323539, loss_ss: 1.027327, loss_d: 0.296212
Epoch finished! Loss: 0.9711701023669643
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.741688, loss_ss: 0.689832, loss_d: 0.051857
0.0381 --- loss: 1.282979, loss_ss: 1.263214, loss_d: 0.019766
0.0762 --- loss: 0.912325, loss_ss: 0.679596, loss_d: 0.232728
0.1143 --- loss: 0.800911, loss_ss: 0.628523, loss_d: 0.172388
0.1524 --- loss: 1.221146, loss_ss: 1.134219, loss_d: 0.086926
0.1905 --- loss: 0.713007, loss_ss: 0.588783, loss_d: 0.124224
0.2287 --- loss: 0.807978, loss_ss: 0.772439, loss_d: 0.035539
0.2668 --- loss: 1.144867, loss_ss: 0.744007, loss_d: 0.400859
0.3049 --- loss: 0.966780, loss_ss: 0.624463, loss_d: 0.342317
0.3430 --- loss: 0.753793, loss_ss: 0.710639, loss_d: 0.043154
0.3811 --- loss: 0.795728, loss_ss: 0.524837, loss_d: 0.270892
0.4192 --- loss: 0.661361, loss_ss: 0.494719, loss_d: 0.166642
0.4573 --- loss: 0.919995, loss_ss: 0.762602, loss_d: 0.157393
0.4954 --- loss: 1.117560, loss_ss: 0.853418, loss_d: 0.264142
0.5335 --- loss: 0.727747, loss_ss: 0.717191, loss_d: 0.010555
0.5716 --- loss: 1.113221, loss_ss: 0.982276, loss_d: 0.130946
0.6098 --- loss: 0.728873, loss_ss: 0.615446, loss_d: 0.113426
0.6479 --- loss: 0.903884, loss_ss: 0.862535, loss_d: 0.041349
0.6860 --- loss: 0.905521, loss_ss: 0.771455, loss_d: 0.134065
0.7241 --- loss: 1.088596, loss_ss: 0.972783, loss_d: 0.115812
0.7622 --- loss: 0.767673, loss_ss: 0.698216, loss_d: 0.069456
0.8003 --- loss: 1.142339, loss_ss: 1.096546, loss_d: 0.045793
0.8384 --- loss: 0.797019, loss_ss: 0.735588, loss_d: 0.061430
0.8765 --- loss: 0.800104, loss_ss: 0.642363, loss_d: 0.157741
0.9146 --- loss: 1.137328, loss_ss: 0.912998, loss_d: 0.224330
0.9527 --- loss: 1.214656, loss_ss: 0.915322, loss_d: 0.299334
0.9909 --- loss: 1.309416, loss_ss: 0.943105, loss_d: 0.366311
Epoch finished! Loss: 0.9254809381397626
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4357142857142857
             precision    recall  f1-score   support

        0.0       1.00      0.28      0.44       304
        1.0       0.10      0.44      0.17        25
        2.0       0.65      0.90      0.75        29
        3.0       1.00      0.97      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.92      0.44      0.53       420
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  48.10  28.29  100.00  100.00     44.10
1  74.29  44.00   76.20   10.48     16.92
2  95.95  89.66   96.42   65.00     75.36
3  99.52  96.77  100.00  100.00     98.36
4  69.29    NaN   69.29    0.00       NaN
Total accuracy: 43.57%
Average sen: 64.68%
Average spec: 88.38%
Macro f1-score: 58.69%
Diagnosis acc on 15mins: 1.0
[0.98325092 0.99022597 0.9991731  0.99917811 0.99917018 0.99875796
 0.99954444 0.99894851 0.99896646 0.99884593 0.99810022 0.99811816
 0.99831259 0.99980146]
pred: 0.9971710017749241, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.344585, loss_ss: 1.683202, loss_d: 0.661383
0.0384 --- loss: 2.255560, loss_ss: 1.523552, loss_d: 0.732009
0.0767 --- loss: 1.944571, loss_ss: 1.444517, loss_d: 0.500054
0.1151 --- loss: 2.114098, loss_ss: 1.418204, loss_d: 0.695893
0.1534 --- loss: 1.992939, loss_ss: 1.431327, loss_d: 0.561612
0.1918 --- loss: 2.387591, loss_ss: 1.376821, loss_d: 1.010771
0.2301 --- loss: 1.930011, loss_ss: 1.433744, loss_d: 0.496267
0.2685 --- loss: 1.763627, loss_ss: 1.314134, loss_d: 0.449493
0.3069 --- loss: 1.832009, loss_ss: 1.380330, loss_d: 0.451678
0.3452 --- loss: 1.718598, loss_ss: 1.289043, loss_d: 0.429555
0.3836 --- loss: 1.903736, loss_ss: 1.237911, loss_d: 0.665825
0.4219 --- loss: 1.762857, loss_ss: 1.229970, loss_d: 0.532888
0.4603 --- loss: 1.939993, loss_ss: 1.338028, loss_d: 0.601965
0.4987 --- loss: 1.868166, loss_ss: 1.293575, loss_d: 0.574591
0.5370 --- loss: 2.077295, loss_ss: 1.403677, loss_d: 0.673618
0.5754 --- loss: 1.563195, loss_ss: 1.200111, loss_d: 0.363084
0.6137 --- loss: 1.653537, loss_ss: 1.113197, loss_d: 0.540340
0.6521 --- loss: 1.746193, loss_ss: 1.195202, loss_d: 0.550991
0.6904 --- loss: 1.688753, loss_ss: 1.255408, loss_d: 0.433345
0.7288 --- loss: 1.549377, loss_ss: 1.238975, loss_d: 0.310402
0.7672 --- loss: 1.859067, loss_ss: 1.261315, loss_d: 0.597752
0.8055 --- loss: 1.539379, loss_ss: 1.157024, loss_d: 0.382356
0.8439 --- loss: 1.362444, loss_ss: 1.118844, loss_d: 0.243600
0.8822 --- loss: 1.427073, loss_ss: 1.139333, loss_d: 0.287740
0.9206 --- loss: 1.450376, loss_ss: 1.115698, loss_d: 0.334678
0.9590 --- loss: 1.577740, loss_ss: 1.238172, loss_d: 0.339567
0.9973 --- loss: 1.450957, loss_ss: 1.108773, loss_d: 0.342183
Epoch finished! Loss: 1.8368561822634477
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.625928, loss_ss: 1.097053, loss_d: 0.528875
0.0384 --- loss: 1.699594, loss_ss: 1.096021, loss_d: 0.603573
0.0767 --- loss: 1.383244, loss_ss: 0.988207, loss_d: 0.395038
0.1151 --- loss: 1.420156, loss_ss: 1.091873, loss_d: 0.328283
0.1534 --- loss: 1.216273, loss_ss: 1.035698, loss_d: 0.180576
0.1918 --- loss: 1.161278, loss_ss: 0.982742, loss_d: 0.178536
0.2301 --- loss: 1.946591, loss_ss: 1.007973, loss_d: 0.938618
0.2685 --- loss: 1.433123, loss_ss: 1.244415, loss_d: 0.188709
0.3069 --- loss: 1.559533, loss_ss: 1.057060, loss_d: 0.502473
0.3452 --- loss: 1.396650, loss_ss: 1.143810, loss_d: 0.252840
0.3836 --- loss: 1.539193, loss_ss: 1.058946, loss_d: 0.480246
0.4219 --- loss: 1.347093, loss_ss: 1.156290, loss_d: 0.190803
0.4603 --- loss: 1.490325, loss_ss: 0.986669, loss_d: 0.503656
0.4987 --- loss: 1.412455, loss_ss: 1.085643, loss_d: 0.326812
0.5370 --- loss: 1.360147, loss_ss: 1.073845, loss_d: 0.286302
0.5754 --- loss: 1.340474, loss_ss: 1.002721, loss_d: 0.337754
0.6137 --- loss: 1.623641, loss_ss: 0.988080, loss_d: 0.635561
0.6521 --- loss: 1.119662, loss_ss: 0.931763, loss_d: 0.187899
0.6904 --- loss: 1.622688, loss_ss: 1.065459, loss_d: 0.557228
0.7288 --- loss: 1.360658, loss_ss: 1.189517, loss_d: 0.171140
0.7672 --- loss: 1.968263, loss_ss: 1.007770, loss_d: 0.960494
0.8055 --- loss: 1.364307, loss_ss: 1.174933, loss_d: 0.189374
0.8439 --- loss: 1.167585, loss_ss: 0.876834, loss_d: 0.290751
0.8822 --- loss: 1.417415, loss_ss: 1.162891, loss_d: 0.254524
0.9206 --- loss: 1.426163, loss_ss: 1.049010, loss_d: 0.377153
0.9590 --- loss: 1.251059, loss_ss: 1.134149, loss_d: 0.116910
0.9973 --- loss: 1.259716, loss_ss: 1.118324, loss_d: 0.141392
Epoch finished! Loss: 1.4337372534550152
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.667837, loss_ss: 1.397431, loss_d: 0.270406
0.0384 --- loss: 1.072715, loss_ss: 0.966357, loss_d: 0.106358
0.0767 --- loss: 1.536831, loss_ss: 0.955304, loss_d: 0.581527
0.1151 --- loss: 1.189014, loss_ss: 1.012428, loss_d: 0.176586
0.1534 --- loss: 1.385372, loss_ss: 0.969305, loss_d: 0.416067
0.1918 --- loss: 1.880704, loss_ss: 1.050063, loss_d: 0.830640
0.2301 --- loss: 1.049221, loss_ss: 0.875574, loss_d: 0.173647
0.2685 --- loss: 1.007375, loss_ss: 0.855141, loss_d: 0.152234
0.3069 --- loss: 1.152600, loss_ss: 0.954559, loss_d: 0.198041
0.3452 --- loss: 1.453861, loss_ss: 1.153210, loss_d: 0.300651
0.3836 --- loss: 1.315849, loss_ss: 0.958353, loss_d: 0.357496
0.4219 --- loss: 1.390342, loss_ss: 0.896087, loss_d: 0.494255
0.4603 --- loss: 1.029884, loss_ss: 0.905119, loss_d: 0.124765
0.4987 --- loss: 1.275265, loss_ss: 1.132892, loss_d: 0.142372
0.5370 --- loss: 1.788541, loss_ss: 1.262107, loss_d: 0.526435
0.5754 --- loss: 0.907425, loss_ss: 0.799295, loss_d: 0.108130
0.6137 --- loss: 1.452030, loss_ss: 0.931664, loss_d: 0.520365
0.6521 --- loss: 0.986953, loss_ss: 0.874506, loss_d: 0.112447
0.6904 --- loss: 1.227080, loss_ss: 1.149151, loss_d: 0.077929
0.7288 --- loss: 1.358338, loss_ss: 1.066609, loss_d: 0.291729
0.7672 --- loss: 1.220262, loss_ss: 0.791028, loss_d: 0.429234
0.8055 --- loss: 1.115620, loss_ss: 0.892347, loss_d: 0.223274
0.8439 --- loss: 1.013527, loss_ss: 0.826281, loss_d: 0.187246
0.8822 --- loss: 1.078528, loss_ss: 0.956710, loss_d: 0.121818
0.9206 --- loss: 1.509397, loss_ss: 0.984612, loss_d: 0.524785
0.9590 --- loss: 1.598435, loss_ss: 0.923965, loss_d: 0.674470
0.9973 --- loss: 1.533766, loss_ss: 0.906685, loss_d: 0.627081
Epoch finished! Loss: 1.2549595337647659
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.567103, loss_ss: 0.761536, loss_d: 0.805567
0.0384 --- loss: 1.127676, loss_ss: 0.849616, loss_d: 0.278060
0.0767 --- loss: 1.182997, loss_ss: 1.090688, loss_d: 0.092309
0.1151 --- loss: 0.951531, loss_ss: 0.794961, loss_d: 0.156570
0.1534 --- loss: 1.399370, loss_ss: 1.347812, loss_d: 0.051557
0.1918 --- loss: 1.198099, loss_ss: 0.765402, loss_d: 0.432698
0.2301 --- loss: 1.438392, loss_ss: 0.907671, loss_d: 0.530721
0.2685 --- loss: 1.371106, loss_ss: 1.125925, loss_d: 0.245180
0.3069 --- loss: 1.164189, loss_ss: 0.825060, loss_d: 0.339128
0.3452 --- loss: 0.927360, loss_ss: 0.749445, loss_d: 0.177915
0.3836 --- loss: 1.358382, loss_ss: 1.183255, loss_d: 0.175127
0.4219 --- loss: 1.555950, loss_ss: 1.430342, loss_d: 0.125608
0.4603 --- loss: 1.146860, loss_ss: 0.751147, loss_d: 0.395713
0.4987 --- loss: 1.391805, loss_ss: 0.812978, loss_d: 0.578827
0.5370 --- loss: 1.176331, loss_ss: 0.832669, loss_d: 0.343662
0.5754 --- loss: 1.001716, loss_ss: 0.731982, loss_d: 0.269733
0.6137 --- loss: 0.981946, loss_ss: 0.871716, loss_d: 0.110229
0.6521 --- loss: 1.194619, loss_ss: 0.937757, loss_d: 0.256862
0.6904 --- loss: 1.104957, loss_ss: 0.799195, loss_d: 0.305762
0.7288 --- loss: 1.560090, loss_ss: 1.388407, loss_d: 0.171683
0.7672 --- loss: 1.182932, loss_ss: 1.050060, loss_d: 0.132872
0.8055 --- loss: 0.995828, loss_ss: 0.917926, loss_d: 0.077903
0.8439 --- loss: 0.925220, loss_ss: 0.805060, loss_d: 0.120160
0.8822 --- loss: 1.006899, loss_ss: 0.953871, loss_d: 0.053028
0.9206 --- loss: 0.974774, loss_ss: 0.768419, loss_d: 0.206355
0.9590 --- loss: 1.073721, loss_ss: 0.924941, loss_d: 0.148780
0.9973 --- loss: 1.127778, loss_ss: 0.910148, loss_d: 0.217630
Epoch finished! Loss: 1.1901799818644156
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.028448, loss_ss: 0.866950, loss_d: 0.161498
0.0384 --- loss: 0.970557, loss_ss: 0.832323, loss_d: 0.138235
0.0767 --- loss: 1.201065, loss_ss: 1.032370, loss_d: 0.168695
0.1151 --- loss: 0.841928, loss_ss: 0.763825, loss_d: 0.078103
0.1534 --- loss: 0.932661, loss_ss: 0.893975, loss_d: 0.038685
0.1918 --- loss: 0.996770, loss_ss: 0.910406, loss_d: 0.086364
0.2301 --- loss: 0.983934, loss_ss: 0.864569, loss_d: 0.119365
0.2685 --- loss: 0.987000, loss_ss: 0.960173, loss_d: 0.026827
0.3069 --- loss: 1.085315, loss_ss: 1.049296, loss_d: 0.036019
0.3452 --- loss: 1.316848, loss_ss: 0.904275, loss_d: 0.412574
0.3836 --- loss: 0.992373, loss_ss: 0.720546, loss_d: 0.271826
0.4219 --- loss: 1.108226, loss_ss: 0.884766, loss_d: 0.223460
0.4603 --- loss: 1.331895, loss_ss: 0.842109, loss_d: 0.489786
0.4987 --- loss: 1.695792, loss_ss: 0.900286, loss_d: 0.795506
0.5370 --- loss: 1.064956, loss_ss: 0.997645, loss_d: 0.067311
0.5754 --- loss: 1.039563, loss_ss: 0.805927, loss_d: 0.233636
0.6137 --- loss: 0.890039, loss_ss: 0.834776, loss_d: 0.055263
0.6521 --- loss: 1.021695, loss_ss: 0.983425, loss_d: 0.038270
0.6904 --- loss: 1.544016, loss_ss: 0.906561, loss_d: 0.637455
0.7288 --- loss: 1.312676, loss_ss: 1.177662, loss_d: 0.135014
0.7672 --- loss: 1.130207, loss_ss: 1.111822, loss_d: 0.018385
0.8055 --- loss: 0.757965, loss_ss: 0.720765, loss_d: 0.037200
0.8439 --- loss: 1.261253, loss_ss: 1.241858, loss_d: 0.019396
0.8822 --- loss: 0.908446, loss_ss: 0.790072, loss_d: 0.118374
0.9206 --- loss: 0.870161, loss_ss: 0.710434, loss_d: 0.159727
0.9590 --- loss: 1.175188, loss_ss: 0.969043, loss_d: 0.206145
0.9973 --- loss: 0.968586, loss_ss: 0.810481, loss_d: 0.158105
Epoch finished! Loss: 1.1236962258815766
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.890184, loss_ss: 0.801612, loss_d: 0.088572
0.0384 --- loss: 1.371773, loss_ss: 1.272872, loss_d: 0.098902
0.0767 --- loss: 1.234335, loss_ss: 0.886855, loss_d: 0.347480
0.1151 --- loss: 0.996214, loss_ss: 0.769709, loss_d: 0.226506
0.1534 --- loss: 0.898148, loss_ss: 0.710596, loss_d: 0.187551
0.1918 --- loss: 0.780248, loss_ss: 0.675383, loss_d: 0.104865
0.2301 --- loss: 1.313033, loss_ss: 1.267609, loss_d: 0.045425
0.2685 --- loss: 1.096788, loss_ss: 0.876557, loss_d: 0.220231
0.3069 --- loss: 1.278218, loss_ss: 1.214104, loss_d: 0.064114
0.3452 --- loss: 0.999161, loss_ss: 0.908504, loss_d: 0.090658
0.3836 --- loss: 1.177046, loss_ss: 1.016550, loss_d: 0.160496
0.4219 --- loss: 1.063349, loss_ss: 0.995563, loss_d: 0.067786
0.4603 --- loss: 0.925531, loss_ss: 0.862525, loss_d: 0.063007
0.4987 --- loss: 1.198820, loss_ss: 1.098727, loss_d: 0.100093
0.5370 --- loss: 1.074771, loss_ss: 0.969945, loss_d: 0.104826
0.5754 --- loss: 0.929618, loss_ss: 0.821227, loss_d: 0.108391
0.6137 --- loss: 0.817840, loss_ss: 0.784469, loss_d: 0.033370
0.6521 --- loss: 1.310908, loss_ss: 1.254141, loss_d: 0.056767
0.6904 --- loss: 1.194032, loss_ss: 1.159985, loss_d: 0.034048
0.7288 --- loss: 1.229659, loss_ss: 1.015674, loss_d: 0.213985
0.7672 --- loss: 0.891900, loss_ss: 0.813269, loss_d: 0.078631
0.8055 --- loss: 0.763626, loss_ss: 0.744354, loss_d: 0.019272
0.8439 --- loss: 0.950026, loss_ss: 0.918439, loss_d: 0.031588
0.8822 --- loss: 0.938521, loss_ss: 0.727330, loss_d: 0.211191
0.9206 --- loss: 1.072920, loss_ss: 1.033639, loss_d: 0.039281
0.9590 --- loss: 1.442110, loss_ss: 0.957605, loss_d: 0.484505
0.9973 --- loss: 0.738703, loss_ss: 0.690976, loss_d: 0.047727
Epoch finished! Loss: 1.0887238151752032
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.127015, loss_ss: 0.994859, loss_d: 0.132157
0.0384 --- loss: 1.401982, loss_ss: 1.283282, loss_d: 0.118700
0.0767 --- loss: 0.764219, loss_ss: 0.683247, loss_d: 0.080972
0.1151 --- loss: 1.167153, loss_ss: 1.143297, loss_d: 0.023856
0.1534 --- loss: 0.833731, loss_ss: 0.818395, loss_d: 0.015337
0.1918 --- loss: 0.747867, loss_ss: 0.724035, loss_d: 0.023832
0.2301 --- loss: 0.901620, loss_ss: 0.841320, loss_d: 0.060300
0.2685 --- loss: 0.723993, loss_ss: 0.692869, loss_d: 0.031125
0.3069 --- loss: 0.817364, loss_ss: 0.779989, loss_d: 0.037375
0.3452 --- loss: 1.145105, loss_ss: 0.809671, loss_d: 0.335434
0.3836 --- loss: 1.370061, loss_ss: 1.027226, loss_d: 0.342835
0.4219 --- loss: 1.040926, loss_ss: 0.834765, loss_d: 0.206161
0.4603 --- loss: 0.879306, loss_ss: 0.756264, loss_d: 0.123042
0.4987 --- loss: 1.508247, loss_ss: 0.910830, loss_d: 0.597417
0.5370 --- loss: 0.725044, loss_ss: 0.646510, loss_d: 0.078534
0.5754 --- loss: 1.369811, loss_ss: 1.033711, loss_d: 0.336100
0.6137 --- loss: 1.044213, loss_ss: 0.913881, loss_d: 0.130333
0.6521 --- loss: 1.199830, loss_ss: 1.165602, loss_d: 0.034228
0.6904 --- loss: 0.782762, loss_ss: 0.706488, loss_d: 0.076274
0.7288 --- loss: 1.011972, loss_ss: 0.984583, loss_d: 0.027390
0.7672 --- loss: 0.840351, loss_ss: 0.781139, loss_d: 0.059212
0.8055 --- loss: 1.034175, loss_ss: 0.899164, loss_d: 0.135011
0.8439 --- loss: 1.291447, loss_ss: 0.724008, loss_d: 0.567438
0.8822 --- loss: 1.017045, loss_ss: 0.979494, loss_d: 0.037552
0.9206 --- loss: 0.941661, loss_ss: 0.898743, loss_d: 0.042918
0.9590 --- loss: 1.108329, loss_ss: 0.702266, loss_d: 0.406064
0.9973 --- loss: 1.089259, loss_ss: 0.932297, loss_d: 0.156962
Epoch finished! Loss: 1.0357445194171024
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.827781, loss_ss: 0.791857, loss_d: 0.035924
0.0384 --- loss: 0.795682, loss_ss: 0.704322, loss_d: 0.091360
0.0767 --- loss: 0.972965, loss_ss: 0.869897, loss_d: 0.103068
0.1151 --- loss: 0.861346, loss_ss: 0.773030, loss_d: 0.088317
0.1534 --- loss: 0.723643, loss_ss: 0.693401, loss_d: 0.030243
0.1918 --- loss: 0.756369, loss_ss: 0.724296, loss_d: 0.032073
0.2301 --- loss: 0.678394, loss_ss: 0.663275, loss_d: 0.015118
0.2685 --- loss: 0.946710, loss_ss: 0.914202, loss_d: 0.032508
0.3069 --- loss: 0.804475, loss_ss: 0.778169, loss_d: 0.026306
0.3452 --- loss: 0.672370, loss_ss: 0.580465, loss_d: 0.091904
0.3836 --- loss: 0.796300, loss_ss: 0.721417, loss_d: 0.074883
0.4219 --- loss: 0.962109, loss_ss: 0.892032, loss_d: 0.070076
0.4603 --- loss: 0.830673, loss_ss: 0.824764, loss_d: 0.005909
0.4987 --- loss: 1.086142, loss_ss: 1.061915, loss_d: 0.024226
0.5370 --- loss: 0.835561, loss_ss: 0.825431, loss_d: 0.010130
0.5754 --- loss: 1.034494, loss_ss: 0.950797, loss_d: 0.083696
0.6137 --- loss: 0.955487, loss_ss: 0.878391, loss_d: 0.077096
0.6521 --- loss: 1.053396, loss_ss: 0.961071, loss_d: 0.092325
0.6904 --- loss: 1.033851, loss_ss: 0.989660, loss_d: 0.044191
0.7288 --- loss: 0.974322, loss_ss: 0.836894, loss_d: 0.137428
0.7672 --- loss: 0.684845, loss_ss: 0.643092, loss_d: 0.041753
0.8055 --- loss: 1.372621, loss_ss: 1.192117, loss_d: 0.180504
0.8439 --- loss: 0.878124, loss_ss: 0.812178, loss_d: 0.065946
0.8822 --- loss: 0.875989, loss_ss: 0.827968, loss_d: 0.048021
0.9206 --- loss: 0.759023, loss_ss: 0.732694, loss_d: 0.026329
0.9590 --- loss: 0.876910, loss_ss: 0.639859, loss_d: 0.237051
0.9973 --- loss: 1.352373, loss_ss: 1.316048, loss_d: 0.036324
Epoch finished! Loss: 1.0122602061583446
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.040755, loss_ss: 0.913638, loss_d: 0.127117
0.0384 --- loss: 0.823246, loss_ss: 0.776014, loss_d: 0.047231
0.0767 --- loss: 0.786320, loss_ss: 0.746566, loss_d: 0.039754
0.1151 --- loss: 0.825708, loss_ss: 0.708131, loss_d: 0.117577
0.1534 --- loss: 0.942445, loss_ss: 0.931779, loss_d: 0.010666
0.1918 --- loss: 0.748992, loss_ss: 0.683106, loss_d: 0.065886
0.2301 --- loss: 0.892391, loss_ss: 0.653562, loss_d: 0.238829
0.2685 --- loss: 1.014067, loss_ss: 1.002103, loss_d: 0.011964
0.3069 --- loss: 0.875476, loss_ss: 0.787275, loss_d: 0.088202
0.3452 --- loss: 1.572022, loss_ss: 1.208570, loss_d: 0.363452
0.3836 --- loss: 0.762774, loss_ss: 0.736226, loss_d: 0.026548
0.4219 --- loss: 0.659232, loss_ss: 0.615127, loss_d: 0.044104
0.4603 --- loss: 1.042154, loss_ss: 1.037141, loss_d: 0.005012
0.4987 --- loss: 0.840344, loss_ss: 0.824898, loss_d: 0.015446
0.5370 --- loss: 0.551902, loss_ss: 0.543131, loss_d: 0.008772
0.5754 --- loss: 1.064222, loss_ss: 1.062261, loss_d: 0.001960
0.6137 --- loss: 0.948714, loss_ss: 0.898884, loss_d: 0.049830
0.6521 --- loss: 0.968756, loss_ss: 0.930559, loss_d: 0.038197
0.6904 --- loss: 1.529342, loss_ss: 0.734481, loss_d: 0.794861
0.7288 --- loss: 0.822606, loss_ss: 0.811308, loss_d: 0.011298
0.7672 --- loss: 0.994114, loss_ss: 0.815055, loss_d: 0.179059
0.8055 --- loss: 0.911225, loss_ss: 0.784895, loss_d: 0.126330
0.8439 --- loss: 0.910867, loss_ss: 0.744810, loss_d: 0.166057
0.8822 --- loss: 0.854683, loss_ss: 0.818201, loss_d: 0.036482
0.9206 --- loss: 0.954105, loss_ss: 0.917415, loss_d: 0.036690
0.9590 --- loss: 0.947842, loss_ss: 0.895643, loss_d: 0.052199
0.9973 --- loss: 0.806126, loss_ss: 0.768877, loss_d: 0.037249
Epoch finished! Loss: 0.9680810893957431
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.847807, loss_ss: 0.758049, loss_d: 0.089758
0.0384 --- loss: 0.626009, loss_ss: 0.594049, loss_d: 0.031960
0.0767 --- loss: 0.962429, loss_ss: 0.938701, loss_d: 0.023728
0.1151 --- loss: 1.073488, loss_ss: 0.775605, loss_d: 0.297883
0.1534 --- loss: 0.954016, loss_ss: 0.849065, loss_d: 0.104951
0.1918 --- loss: 1.058554, loss_ss: 0.810759, loss_d: 0.247795
0.2301 --- loss: 0.908535, loss_ss: 0.663166, loss_d: 0.245369
0.2685 --- loss: 0.701241, loss_ss: 0.696300, loss_d: 0.004941
0.3069 --- loss: 0.744431, loss_ss: 0.709112, loss_d: 0.035320
0.3452 --- loss: 1.213771, loss_ss: 1.152407, loss_d: 0.061364
0.3836 --- loss: 0.862323, loss_ss: 0.848070, loss_d: 0.014253
0.4219 --- loss: 1.097564, loss_ss: 0.933953, loss_d: 0.163611
0.4603 --- loss: 1.122422, loss_ss: 0.934054, loss_d: 0.188368
0.4987 --- loss: 1.141875, loss_ss: 1.097887, loss_d: 0.043988
0.5370 --- loss: 0.803893, loss_ss: 0.793858, loss_d: 0.010035
0.5754 --- loss: 0.698934, loss_ss: 0.689028, loss_d: 0.009905
0.6137 --- loss: 1.176310, loss_ss: 1.058344, loss_d: 0.117966
0.6521 --- loss: 1.120328, loss_ss: 0.995923, loss_d: 0.124405
0.6904 --- loss: 0.841031, loss_ss: 0.762455, loss_d: 0.078576
0.7288 --- loss: 0.685075, loss_ss: 0.675075, loss_d: 0.010000
0.7672 --- loss: 0.852514, loss_ss: 0.835593, loss_d: 0.016921
0.8055 --- loss: 1.209858, loss_ss: 1.177573, loss_d: 0.032285
0.8439 --- loss: 1.022858, loss_ss: 0.966462, loss_d: 0.056396
0.8822 --- loss: 0.729544, loss_ss: 0.679351, loss_d: 0.050193
0.9206 --- loss: 0.624599, loss_ss: 0.581398, loss_d: 0.043201
0.9590 --- loss: 0.752609, loss_ss: 0.746397, loss_d: 0.006212
0.9973 --- loss: 0.777785, loss_ss: 0.552043, loss_d: 0.225742
Epoch finished! Loss: 0.953386951639102
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7913978494623656
             precision    recall  f1-score   support

        0.0       0.84      0.83      0.83        58
        1.0       0.17      0.27      0.21        55
        2.0       0.81      0.87      0.84       412
        3.0       0.93      0.83      0.88       182
        4.0       0.92      0.73      0.81       223

avg / total       0.82      0.79      0.80       930
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.96  82.76   98.97  84.21     83.48
1  87.96  27.27   91.77  17.24     21.13
2  85.05  87.38   83.20  80.54     83.82
3  95.48  82.97   98.53  93.21     87.79
4  91.83  72.65   97.88  91.53     81.00
Total accuracy: 79.14%
Average sen: 70.60%
Average spec: 94.07%
Macro f1-score: 71.44%
Diagnosis acc on 15mins: 0.967741935483871
[0.99982709 0.8225044  0.81392318 0.85779691 0.72809881 0.898076
 0.95979297 0.85874093 0.99461454 0.97803169 0.99957734 0.99999654
 0.96728635 0.90196884 0.97490895 0.97941226 0.98540908 0.86384332
 0.80735809 0.91638267 0.99423426 0.96481353 0.98531634 0.99310994
 0.97787195 0.99998832 0.98004204 0.31934956 0.99721897 0.93954623
 0.61963135]
pred: 0.905763627059998, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.376229, loss_ss: 1.694399, loss_d: 0.681830
0.0384 --- loss: 1.810646, loss_ss: 1.555298, loss_d: 0.255348
0.0768 --- loss: 1.923946, loss_ss: 1.538807, loss_d: 0.385139
0.1152 --- loss: 2.138527, loss_ss: 1.511195, loss_d: 0.627333
0.1536 --- loss: 2.159724, loss_ss: 1.437489, loss_d: 0.722235
0.1920 --- loss: 1.970244, loss_ss: 1.476886, loss_d: 0.493358
0.2304 --- loss: 1.885437, loss_ss: 1.442315, loss_d: 0.443123
0.2688 --- loss: 1.676764, loss_ss: 1.199106, loss_d: 0.477659
0.3072 --- loss: 1.944726, loss_ss: 1.351142, loss_d: 0.593585
0.3456 --- loss: 1.856184, loss_ss: 1.447939, loss_d: 0.408245
0.3840 --- loss: 2.305673, loss_ss: 1.204083, loss_d: 1.101590
0.4224 --- loss: 2.067795, loss_ss: 1.371017, loss_d: 0.696778
0.4608 --- loss: 1.796656, loss_ss: 1.408662, loss_d: 0.387994
0.4992 --- loss: 1.871609, loss_ss: 1.284188, loss_d: 0.587421
0.5376 --- loss: 1.692824, loss_ss: 1.229230, loss_d: 0.463594
0.5760 --- loss: 1.506786, loss_ss: 1.189747, loss_d: 0.317039
0.6144 --- loss: 1.761561, loss_ss: 1.282225, loss_d: 0.479336
0.6528 --- loss: 1.891160, loss_ss: 1.253686, loss_d: 0.637474
0.6912 --- loss: 1.685078, loss_ss: 1.220907, loss_d: 0.464171
0.7296 --- loss: 2.021483, loss_ss: 1.329150, loss_d: 0.692333
0.7680 --- loss: 1.525457, loss_ss: 1.100886, loss_d: 0.424571
0.8065 --- loss: 1.915749, loss_ss: 1.386920, loss_d: 0.528829
0.8449 --- loss: 1.979700, loss_ss: 1.265184, loss_d: 0.714515
0.8833 --- loss: 1.467918, loss_ss: 1.052445, loss_d: 0.415474
0.9217 --- loss: 1.691543, loss_ss: 1.277672, loss_d: 0.413871
0.9601 --- loss: 1.609549, loss_ss: 1.068954, loss_d: 0.540595
0.9985 --- loss: 2.457377, loss_ss: 1.477185, loss_d: 0.980193
Epoch finished! Loss: 1.8954947627507723
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.517270, loss_ss: 1.161514, loss_d: 0.355757
0.0384 --- loss: 1.968120, loss_ss: 1.277262, loss_d: 0.690859
0.0768 --- loss: 1.238572, loss_ss: 0.990799, loss_d: 0.247772
0.1152 --- loss: 1.592522, loss_ss: 1.011590, loss_d: 0.580932
0.1536 --- loss: 1.694942, loss_ss: 1.286331, loss_d: 0.408610
0.1920 --- loss: 1.200561, loss_ss: 0.905822, loss_d: 0.294739
0.2304 --- loss: 1.582636, loss_ss: 1.164189, loss_d: 0.418447
0.2688 --- loss: 1.367175, loss_ss: 1.074319, loss_d: 0.292856
0.3072 --- loss: 1.429295, loss_ss: 1.272565, loss_d: 0.156731
0.3456 --- loss: 1.947740, loss_ss: 1.367451, loss_d: 0.580290
0.3840 --- loss: 1.169594, loss_ss: 0.922379, loss_d: 0.247215
0.4224 --- loss: 1.094291, loss_ss: 0.918028, loss_d: 0.176263
0.4608 --- loss: 1.718147, loss_ss: 0.837567, loss_d: 0.880581
0.4992 --- loss: 1.321648, loss_ss: 0.954207, loss_d: 0.367442
0.5376 --- loss: 2.106403, loss_ss: 1.107812, loss_d: 0.998590
0.5760 --- loss: 1.846692, loss_ss: 1.115452, loss_d: 0.731240
0.6144 --- loss: 1.573831, loss_ss: 1.182053, loss_d: 0.391778
0.6528 --- loss: 1.375775, loss_ss: 1.132323, loss_d: 0.243452
0.6912 --- loss: 1.413863, loss_ss: 1.175524, loss_d: 0.238339
0.7296 --- loss: 1.607432, loss_ss: 1.080505, loss_d: 0.526927
0.7680 --- loss: 1.356429, loss_ss: 1.155817, loss_d: 0.200613
0.8065 --- loss: 1.398757, loss_ss: 1.040130, loss_d: 0.358627
0.8449 --- loss: 1.596951, loss_ss: 1.472671, loss_d: 0.124280
0.8833 --- loss: 1.305198, loss_ss: 1.022220, loss_d: 0.282978
0.9217 --- loss: 1.377017, loss_ss: 1.094845, loss_d: 0.282172
0.9601 --- loss: 1.190212, loss_ss: 0.893544, loss_d: 0.296667
0.9985 --- loss: 1.496433, loss_ss: 1.267017, loss_d: 0.229416
Epoch finished! Loss: 1.4621765038141838
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.014364, loss_ss: 0.837542, loss_d: 0.176822
0.0384 --- loss: 1.148446, loss_ss: 0.797923, loss_d: 0.350523
0.0768 --- loss: 1.176183, loss_ss: 1.018470, loss_d: 0.157713
0.1152 --- loss: 1.214623, loss_ss: 0.892398, loss_d: 0.322225
0.1536 --- loss: 1.183306, loss_ss: 1.122001, loss_d: 0.061305
0.1920 --- loss: 0.963294, loss_ss: 0.895054, loss_d: 0.068240
0.2304 --- loss: 1.239045, loss_ss: 0.964330, loss_d: 0.274715
0.2688 --- loss: 1.717143, loss_ss: 1.022628, loss_d: 0.694515
0.3072 --- loss: 1.440021, loss_ss: 0.712143, loss_d: 0.727878
0.3456 --- loss: 1.083131, loss_ss: 0.826419, loss_d: 0.256711
0.3840 --- loss: 1.211064, loss_ss: 0.844346, loss_d: 0.366718
0.4224 --- loss: 1.208640, loss_ss: 1.074640, loss_d: 0.134000
0.4608 --- loss: 1.420223, loss_ss: 0.999347, loss_d: 0.420876
0.4992 --- loss: 1.325612, loss_ss: 1.083323, loss_d: 0.242290
0.5376 --- loss: 1.452154, loss_ss: 0.894311, loss_d: 0.557843
0.5760 --- loss: 1.643188, loss_ss: 1.100670, loss_d: 0.542518
0.6144 --- loss: 1.249801, loss_ss: 1.026598, loss_d: 0.223202
0.6528 --- loss: 1.333587, loss_ss: 1.005398, loss_d: 0.328189
0.6912 --- loss: 1.337490, loss_ss: 0.797912, loss_d: 0.539577
0.7296 --- loss: 0.950920, loss_ss: 0.756055, loss_d: 0.194864
0.7680 --- loss: 1.290719, loss_ss: 0.945695, loss_d: 0.345024
0.8065 --- loss: 1.135038, loss_ss: 0.993588, loss_d: 0.141450
0.8449 --- loss: 1.663447, loss_ss: 0.819988, loss_d: 0.843459
0.8833 --- loss: 1.693964, loss_ss: 0.700370, loss_d: 0.993594
0.9217 --- loss: 1.338433, loss_ss: 0.821378, loss_d: 0.517054
0.9601 --- loss: 0.772851, loss_ss: 0.658468, loss_d: 0.114382
0.9985 --- loss: 1.772843, loss_ss: 1.512462, loss_d: 0.260381
Epoch finished! Loss: 1.3205738869997172
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.123681, loss_ss: 0.887525, loss_d: 0.236157
0.0384 --- loss: 1.122154, loss_ss: 0.938594, loss_d: 0.183560
0.0768 --- loss: 1.361502, loss_ss: 0.980770, loss_d: 0.380732
0.1152 --- loss: 1.568912, loss_ss: 0.939321, loss_d: 0.629591
0.1536 --- loss: 1.051391, loss_ss: 0.870911, loss_d: 0.180480
0.1920 --- loss: 1.429585, loss_ss: 1.206640, loss_d: 0.222944
0.2304 --- loss: 1.293908, loss_ss: 1.118610, loss_d: 0.175297
0.2688 --- loss: 0.985421, loss_ss: 0.811598, loss_d: 0.173823
0.3072 --- loss: 1.681723, loss_ss: 0.906291, loss_d: 0.775431
0.3456 --- loss: 0.923393, loss_ss: 0.812001, loss_d: 0.111391
0.3840 --- loss: 1.181720, loss_ss: 1.058636, loss_d: 0.123085
0.4224 --- loss: 1.186933, loss_ss: 0.992680, loss_d: 0.194253
0.4608 --- loss: 0.901721, loss_ss: 0.677410, loss_d: 0.224311
0.4992 --- loss: 1.491490, loss_ss: 1.329112, loss_d: 0.162378
0.5376 --- loss: 1.061156, loss_ss: 0.779951, loss_d: 0.281205
0.5760 --- loss: 0.991689, loss_ss: 0.817417, loss_d: 0.174273
0.6144 --- loss: 1.102663, loss_ss: 0.992861, loss_d: 0.109802
0.6528 --- loss: 0.870995, loss_ss: 0.686032, loss_d: 0.184963
0.6912 --- loss: 1.654988, loss_ss: 0.909266, loss_d: 0.745722
0.7296 --- loss: 1.076457, loss_ss: 0.955401, loss_d: 0.121056
0.7680 --- loss: 1.150999, loss_ss: 0.871647, loss_d: 0.279351
0.8065 --- loss: 0.997214, loss_ss: 0.945472, loss_d: 0.051741
0.8449 --- loss: 0.740750, loss_ss: 0.688622, loss_d: 0.052127
0.8833 --- loss: 1.109985, loss_ss: 0.828260, loss_d: 0.281724
0.9217 --- loss: 1.051853, loss_ss: 0.799999, loss_d: 0.251854
0.9601 --- loss: 1.187819, loss_ss: 1.016226, loss_d: 0.171593
0.9985 --- loss: 1.291002, loss_ss: 1.260221, loss_d: 0.030780
Epoch finished! Loss: 1.1917096965588057
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.995965, loss_ss: 0.946646, loss_d: 0.049319
0.0384 --- loss: 0.898838, loss_ss: 0.737720, loss_d: 0.161118
0.0768 --- loss: 1.070894, loss_ss: 0.830455, loss_d: 0.240439
0.1152 --- loss: 1.190021, loss_ss: 1.084121, loss_d: 0.105900
0.1536 --- loss: 1.227759, loss_ss: 1.085593, loss_d: 0.142165
0.1920 --- loss: 1.374746, loss_ss: 0.761600, loss_d: 0.613147
0.2304 --- loss: 1.323420, loss_ss: 0.833259, loss_d: 0.490161
0.2688 --- loss: 1.288609, loss_ss: 1.217857, loss_d: 0.070752
0.3072 --- loss: 0.945896, loss_ss: 0.745839, loss_d: 0.200057
0.3456 --- loss: 0.735151, loss_ss: 0.698956, loss_d: 0.036194
0.3840 --- loss: 1.053631, loss_ss: 0.784209, loss_d: 0.269423
0.4224 --- loss: 1.589748, loss_ss: 0.879172, loss_d: 0.710576
0.4608 --- loss: 0.901672, loss_ss: 0.764543, loss_d: 0.137129
0.4992 --- loss: 0.990086, loss_ss: 0.763750, loss_d: 0.226336
0.5376 --- loss: 1.269647, loss_ss: 0.757657, loss_d: 0.511990
0.5760 --- loss: 1.070376, loss_ss: 0.977250, loss_d: 0.093126
0.6144 --- loss: 1.002643, loss_ss: 0.884464, loss_d: 0.118179
0.6528 --- loss: 0.998767, loss_ss: 0.751984, loss_d: 0.246783
0.6912 --- loss: 1.205973, loss_ss: 0.972217, loss_d: 0.233756
0.7296 --- loss: 1.158788, loss_ss: 1.061578, loss_d: 0.097210
0.7680 --- loss: 1.203073, loss_ss: 0.814428, loss_d: 0.388646
0.8065 --- loss: 1.035071, loss_ss: 0.836002, loss_d: 0.199069
0.8449 --- loss: 1.669367, loss_ss: 0.848266, loss_d: 0.821101
0.8833 --- loss: 0.735316, loss_ss: 0.639877, loss_d: 0.095439
0.9217 --- loss: 1.387948, loss_ss: 1.056394, loss_d: 0.331554
0.9601 --- loss: 0.976690, loss_ss: 0.846388, loss_d: 0.130302
0.9985 --- loss: 1.900439, loss_ss: 1.885804, loss_d: 0.014635
Epoch finished! Loss: 1.1349411113904073
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.789825, loss_ss: 0.702819, loss_d: 0.087006
0.0384 --- loss: 1.536945, loss_ss: 0.731602, loss_d: 0.805343
0.0768 --- loss: 1.170780, loss_ss: 1.000327, loss_d: 0.170453
0.1152 --- loss: 0.946195, loss_ss: 0.894720, loss_d: 0.051474
0.1536 --- loss: 1.106442, loss_ss: 0.786353, loss_d: 0.320089
0.1920 --- loss: 1.435964, loss_ss: 0.967850, loss_d: 0.468114
0.2304 --- loss: 0.799756, loss_ss: 0.759122, loss_d: 0.040634
0.2688 --- loss: 0.969453, loss_ss: 0.925741, loss_d: 0.043711
0.3072 --- loss: 0.752059, loss_ss: 0.663063, loss_d: 0.088996
0.3456 --- loss: 1.320417, loss_ss: 0.982090, loss_d: 0.338327
0.3840 --- loss: 1.140012, loss_ss: 1.000088, loss_d: 0.139924
0.4224 --- loss: 1.106956, loss_ss: 0.636612, loss_d: 0.470345
0.4608 --- loss: 1.179084, loss_ss: 0.983707, loss_d: 0.195377
0.4992 --- loss: 0.753329, loss_ss: 0.685685, loss_d: 0.067644
0.5376 --- loss: 0.879012, loss_ss: 0.774872, loss_d: 0.104140
0.5760 --- loss: 0.932977, loss_ss: 0.829209, loss_d: 0.103767
0.6144 --- loss: 1.255500, loss_ss: 1.219535, loss_d: 0.035965
0.6528 --- loss: 1.090296, loss_ss: 0.950041, loss_d: 0.140255
0.6912 --- loss: 0.873358, loss_ss: 0.729440, loss_d: 0.143917
0.7296 --- loss: 1.170497, loss_ss: 1.054483, loss_d: 0.116015
0.7680 --- loss: 1.274851, loss_ss: 0.916824, loss_d: 0.358028
0.8065 --- loss: 1.664065, loss_ss: 0.685072, loss_d: 0.978993
0.8449 --- loss: 0.903601, loss_ss: 0.848425, loss_d: 0.055177
0.8833 --- loss: 0.863993, loss_ss: 0.648621, loss_d: 0.215372
0.9217 --- loss: 1.058542, loss_ss: 0.784070, loss_d: 0.274473
0.9601 --- loss: 0.802056, loss_ss: 0.725931, loss_d: 0.076125
0.9985 --- loss: 0.938234, loss_ss: 0.909199, loss_d: 0.029035
Epoch finished! Loss: 1.0747356680723337
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.888592, loss_ss: 0.846005, loss_d: 0.042587
0.0384 --- loss: 1.184087, loss_ss: 0.892631, loss_d: 0.291456
0.0768 --- loss: 0.827157, loss_ss: 0.780254, loss_d: 0.046903
0.1152 --- loss: 0.768825, loss_ss: 0.739928, loss_d: 0.028897
0.1536 --- loss: 0.972703, loss_ss: 0.752144, loss_d: 0.220560
0.1920 --- loss: 0.976754, loss_ss: 0.928921, loss_d: 0.047833
0.2304 --- loss: 1.106017, loss_ss: 1.051651, loss_d: 0.054366
0.2688 --- loss: 1.150972, loss_ss: 0.948168, loss_d: 0.202805
0.3072 --- loss: 0.689978, loss_ss: 0.647511, loss_d: 0.042467
0.3456 --- loss: 0.720071, loss_ss: 0.643620, loss_d: 0.076451
0.3840 --- loss: 0.967262, loss_ss: 0.842839, loss_d: 0.124423
0.4224 --- loss: 0.985878, loss_ss: 0.962567, loss_d: 0.023311
0.4608 --- loss: 0.864003, loss_ss: 0.819344, loss_d: 0.044659
0.4992 --- loss: 0.935713, loss_ss: 0.803796, loss_d: 0.131917
0.5376 --- loss: 0.883674, loss_ss: 0.794491, loss_d: 0.089183
0.5760 --- loss: 1.052455, loss_ss: 0.956949, loss_d: 0.095506
0.6144 --- loss: 1.169856, loss_ss: 0.854442, loss_d: 0.315414
0.6528 --- loss: 1.190110, loss_ss: 0.723418, loss_d: 0.466692
0.6912 --- loss: 0.873463, loss_ss: 0.849126, loss_d: 0.024337
0.7296 --- loss: 0.800146, loss_ss: 0.726760, loss_d: 0.073386
0.7680 --- loss: 0.998216, loss_ss: 0.772349, loss_d: 0.225867
0.8065 --- loss: 1.157122, loss_ss: 0.755546, loss_d: 0.401576
0.8449 --- loss: 0.585128, loss_ss: 0.565683, loss_d: 0.019445
0.8833 --- loss: 0.967339, loss_ss: 0.904007, loss_d: 0.063332
0.9217 --- loss: 1.019964, loss_ss: 0.802922, loss_d: 0.217042
0.9601 --- loss: 0.709067, loss_ss: 0.653502, loss_d: 0.055565
0.9985 --- loss: 1.070251, loss_ss: 1.056196, loss_d: 0.014054
Epoch finished! Loss: 1.0222669067291112
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.077458, loss_ss: 0.812882, loss_d: 0.264576
0.0384 --- loss: 0.951119, loss_ss: 0.912957, loss_d: 0.038162
0.0768 --- loss: 0.794526, loss_ss: 0.722142, loss_d: 0.072384
0.1152 --- loss: 0.847333, loss_ss: 0.831071, loss_d: 0.016262
0.1536 --- loss: 0.676462, loss_ss: 0.657479, loss_d: 0.018983
0.1920 --- loss: 0.842004, loss_ss: 0.771822, loss_d: 0.070182
0.2304 --- loss: 0.964854, loss_ss: 0.886716, loss_d: 0.078138
0.2688 --- loss: 0.992505, loss_ss: 0.787315, loss_d: 0.205190
0.3072 --- loss: 0.932309, loss_ss: 0.717251, loss_d: 0.215058
0.3456 --- loss: 1.245009, loss_ss: 1.185169, loss_d: 0.059841
0.3840 --- loss: 1.084932, loss_ss: 0.991762, loss_d: 0.093169
0.4224 --- loss: 0.843662, loss_ss: 0.829907, loss_d: 0.013755
0.4608 --- loss: 0.773105, loss_ss: 0.717461, loss_d: 0.055645
0.4992 --- loss: 0.810666, loss_ss: 0.703532, loss_d: 0.107134
0.5376 --- loss: 1.224649, loss_ss: 1.191289, loss_d: 0.033360
0.5760 --- loss: 0.688676, loss_ss: 0.636254, loss_d: 0.052422
0.6144 --- loss: 0.784384, loss_ss: 0.705660, loss_d: 0.078724
0.6528 --- loss: 0.909277, loss_ss: 0.864168, loss_d: 0.045109
0.6912 --- loss: 1.571680, loss_ss: 1.029825, loss_d: 0.541855
0.7296 --- loss: 1.114005, loss_ss: 0.832281, loss_d: 0.281724
0.7680 --- loss: 1.056845, loss_ss: 0.780140, loss_d: 0.276705
0.8065 --- loss: 0.905722, loss_ss: 0.638160, loss_d: 0.267562
0.8449 --- loss: 0.696206, loss_ss: 0.663375, loss_d: 0.032831
0.8833 --- loss: 0.751936, loss_ss: 0.722733, loss_d: 0.029203
0.9217 --- loss: 0.970227, loss_ss: 0.941318, loss_d: 0.028909
0.9601 --- loss: 0.752489, loss_ss: 0.693815, loss_d: 0.058675
0.9985 --- loss: 1.372399, loss_ss: 1.351349, loss_d: 0.021050
Epoch finished! Loss: 1.0262438978140171
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.901273, loss_ss: 0.839931, loss_d: 0.061342
0.0384 --- loss: 1.015300, loss_ss: 0.996062, loss_d: 0.019238
0.0768 --- loss: 0.641255, loss_ss: 0.631550, loss_d: 0.009705
0.1152 --- loss: 0.909368, loss_ss: 0.898943, loss_d: 0.010425
0.1536 --- loss: 1.018829, loss_ss: 0.969504, loss_d: 0.049325
0.1920 --- loss: 0.875181, loss_ss: 0.851431, loss_d: 0.023750
0.2304 --- loss: 1.886329, loss_ss: 1.395732, loss_d: 0.490597
0.2688 --- loss: 1.054201, loss_ss: 1.043427, loss_d: 0.010774
0.3072 --- loss: 2.069491, loss_ss: 0.958190, loss_d: 1.111301
0.3456 --- loss: 0.814505, loss_ss: 0.695080, loss_d: 0.119425
0.3840 --- loss: 0.771562, loss_ss: 0.694736, loss_d: 0.076826
0.4224 --- loss: 0.868413, loss_ss: 0.769598, loss_d: 0.098815
0.4608 --- loss: 1.158714, loss_ss: 0.861890, loss_d: 0.296824
0.4992 --- loss: 1.091304, loss_ss: 0.955882, loss_d: 0.135421
0.5376 --- loss: 1.101454, loss_ss: 0.890522, loss_d: 0.210932
0.5760 --- loss: 0.879574, loss_ss: 0.788539, loss_d: 0.091035
0.6144 --- loss: 0.875587, loss_ss: 0.863113, loss_d: 0.012474
0.6528 --- loss: 0.865048, loss_ss: 0.798869, loss_d: 0.066179
0.6912 --- loss: 1.067371, loss_ss: 0.765812, loss_d: 0.301559
0.7296 --- loss: 1.508406, loss_ss: 1.166762, loss_d: 0.341643
0.7680 --- loss: 0.747342, loss_ss: 0.705318, loss_d: 0.042023
0.8065 --- loss: 1.218142, loss_ss: 1.007746, loss_d: 0.210396
0.8449 --- loss: 1.178949, loss_ss: 0.810212, loss_d: 0.368737
0.8833 --- loss: 0.925307, loss_ss: 0.794880, loss_d: 0.130427
0.9217 --- loss: 1.204420, loss_ss: 1.147009, loss_d: 0.057411
0.9601 --- loss: 0.789524, loss_ss: 0.736605, loss_d: 0.052919
0.9985 --- loss: 1.468867, loss_ss: 1.463171, loss_d: 0.005696
Epoch finished! Loss: 1.0039329001536736
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.752513, loss_ss: 0.739855, loss_d: 0.012657
0.0384 --- loss: 0.719752, loss_ss: 0.692156, loss_d: 0.027597
0.0768 --- loss: 1.043946, loss_ss: 0.822313, loss_d: 0.221633
0.1152 --- loss: 1.110296, loss_ss: 1.081455, loss_d: 0.028841
0.1536 --- loss: 1.060085, loss_ss: 0.981386, loss_d: 0.078699
0.1920 --- loss: 1.116288, loss_ss: 0.970495, loss_d: 0.145793
0.2304 --- loss: 0.575762, loss_ss: 0.567013, loss_d: 0.008749
0.2688 --- loss: 0.582792, loss_ss: 0.443078, loss_d: 0.139714
0.3072 --- loss: 0.834810, loss_ss: 0.769777, loss_d: 0.065033
0.3456 --- loss: 1.061210, loss_ss: 0.930809, loss_d: 0.130401
0.3840 --- loss: 0.929484, loss_ss: 0.694589, loss_d: 0.234895
0.4224 --- loss: 0.969516, loss_ss: 0.898815, loss_d: 0.070700
0.4608 --- loss: 1.056424, loss_ss: 0.891182, loss_d: 0.165242
0.4992 --- loss: 1.037753, loss_ss: 0.964911, loss_d: 0.072843
0.5376 --- loss: 1.006359, loss_ss: 0.972179, loss_d: 0.034180
0.5760 --- loss: 1.031036, loss_ss: 1.008078, loss_d: 0.022958
0.6144 --- loss: 0.629830, loss_ss: 0.515362, loss_d: 0.114468
0.6528 --- loss: 0.865078, loss_ss: 0.826321, loss_d: 0.038758
0.6912 --- loss: 1.068036, loss_ss: 1.049779, loss_d: 0.018257
0.7296 --- loss: 0.834912, loss_ss: 0.763238, loss_d: 0.071674
0.7680 --- loss: 0.991865, loss_ss: 0.767795, loss_d: 0.224070
0.8065 --- loss: 0.896569, loss_ss: 0.852487, loss_d: 0.044082
0.8449 --- loss: 0.965773, loss_ss: 0.931011, loss_d: 0.034762
0.8833 --- loss: 0.966589, loss_ss: 0.940988, loss_d: 0.025601
0.9217 --- loss: 1.083867, loss_ss: 0.984169, loss_d: 0.099699
0.9601 --- loss: 0.626789, loss_ss: 0.618930, loss_d: 0.007859
0.9985 --- loss: 0.707093, loss_ss: 0.682412, loss_d: 0.024681
Epoch finished! Loss: 0.9415359416833291
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5397448478900884
             precision    recall  f1-score   support

        0.0       0.95      0.68      0.79       101
        1.0       0.11      0.58      0.18        55
        2.0       0.64      0.93      0.76       382
        3.0       0.97      0.31      0.47       191
        4.0       0.92      0.12      0.22       290

avg / total       0.78      0.54      0.52      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.47  68.32   99.56  94.52     79.31
1  72.03  58.18   72.82  10.88     18.34
2  77.82  92.67   68.92  64.13     75.80
3  86.85  30.89   99.76  96.72     46.83
4  74.78  12.41   99.59  92.31     21.88
Total accuracy: 53.97%
Average sen: 52.49%
Average spec: 88.13%
Macro f1-score: 48.43%
Diagnosis acc on 15mins: 1.0
[0.99999964 0.99308974 0.99722797 0.99964356 0.99992597 0.99836689
 0.99530518 0.9403587  0.98458982 0.98979986 0.9993825  0.99994946
 0.99995935 0.99672759 0.91784555 0.84505242 0.93849981 0.98654002
 0.9913128  0.98318315 0.9955591  0.99543071 0.99333912 0.97454661
 0.90364784 0.98989618 0.99682367 0.99999571 0.99999869 0.99610054
 0.97905082 0.98097152 0.9528901  0.92414051]
pred: 0.9776220900170943, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.538114, loss_ss: 1.814681, loss_d: 0.723433
0.0384 --- loss: 2.337321, loss_ss: 1.681105, loss_d: 0.656217
0.0768 --- loss: 2.347327, loss_ss: 1.600384, loss_d: 0.746943
0.1152 --- loss: 2.315796, loss_ss: 1.586551, loss_d: 0.729245
0.1536 --- loss: 2.466675, loss_ss: 1.626852, loss_d: 0.839823
0.1920 --- loss: 1.978017, loss_ss: 1.530404, loss_d: 0.447613
0.2304 --- loss: 2.560512, loss_ss: 1.553441, loss_d: 1.007071
0.2688 --- loss: 2.058990, loss_ss: 1.464404, loss_d: 0.594586
0.3072 --- loss: 2.083720, loss_ss: 1.459773, loss_d: 0.623947
0.3456 --- loss: 2.334246, loss_ss: 1.560362, loss_d: 0.773884
0.3840 --- loss: 1.975403, loss_ss: 1.397096, loss_d: 0.578307
0.4224 --- loss: 2.142095, loss_ss: 1.449037, loss_d: 0.693058
0.4608 --- loss: 2.385767, loss_ss: 1.443469, loss_d: 0.942298
0.4992 --- loss: 2.015861, loss_ss: 1.400700, loss_d: 0.615161
0.5376 --- loss: 1.979331, loss_ss: 1.320202, loss_d: 0.659129
0.5760 --- loss: 2.165605, loss_ss: 1.485628, loss_d: 0.679977
0.6144 --- loss: 2.077307, loss_ss: 1.550025, loss_d: 0.527281
0.6528 --- loss: 1.992170, loss_ss: 1.370424, loss_d: 0.621747
0.6912 --- loss: 1.697793, loss_ss: 1.414214, loss_d: 0.283579
0.7296 --- loss: 1.744319, loss_ss: 1.292446, loss_d: 0.451872
0.7680 --- loss: 2.009501, loss_ss: 1.415217, loss_d: 0.594283
0.8065 --- loss: 1.829484, loss_ss: 1.345452, loss_d: 0.484032
0.8449 --- loss: 1.495376, loss_ss: 1.214304, loss_d: 0.281072
0.8833 --- loss: 1.639016, loss_ss: 1.329580, loss_d: 0.309436
0.9217 --- loss: 1.945311, loss_ss: 1.603415, loss_d: 0.341896
0.9601 --- loss: 1.505226, loss_ss: 1.125368, loss_d: 0.379857
0.9985 --- loss: 1.366848, loss_ss: 1.193172, loss_d: 0.173677
Epoch finished! Loss: 1.99906268119812
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.683020, loss_ss: 1.320091, loss_d: 0.362929
0.0384 --- loss: 1.659872, loss_ss: 1.267010, loss_d: 0.392862
0.0768 --- loss: 1.593779, loss_ss: 1.024672, loss_d: 0.569107
0.1152 --- loss: 2.315459, loss_ss: 1.518447, loss_d: 0.797012
0.1536 --- loss: 1.498519, loss_ss: 1.143886, loss_d: 0.354633
0.1920 --- loss: 1.645674, loss_ss: 1.058250, loss_d: 0.587423
0.2304 --- loss: 1.866637, loss_ss: 1.110115, loss_d: 0.756523
0.2688 --- loss: 1.275470, loss_ss: 1.054428, loss_d: 0.221042
0.3072 --- loss: 1.515777, loss_ss: 1.151396, loss_d: 0.364381
0.3456 --- loss: 1.387684, loss_ss: 1.129651, loss_d: 0.258033
0.3840 --- loss: 1.550959, loss_ss: 1.323005, loss_d: 0.227955
0.4224 --- loss: 1.529812, loss_ss: 1.000682, loss_d: 0.529129
0.4608 --- loss: 1.475004, loss_ss: 1.108252, loss_d: 0.366752
0.4992 --- loss: 1.181023, loss_ss: 1.027508, loss_d: 0.153515
0.5376 --- loss: 1.497984, loss_ss: 1.187565, loss_d: 0.310419
0.5760 --- loss: 1.323131, loss_ss: 0.948139, loss_d: 0.374992
0.6144 --- loss: 1.529045, loss_ss: 1.119153, loss_d: 0.409892
0.6528 --- loss: 1.160996, loss_ss: 1.030059, loss_d: 0.130937
0.6912 --- loss: 1.146675, loss_ss: 0.977947, loss_d: 0.168729
0.7296 --- loss: 1.315287, loss_ss: 1.211841, loss_d: 0.103445
0.7680 --- loss: 1.349988, loss_ss: 0.939383, loss_d: 0.410604
0.8065 --- loss: 1.507020, loss_ss: 1.043493, loss_d: 0.463527
0.8449 --- loss: 1.480995, loss_ss: 1.098099, loss_d: 0.382896
0.8833 --- loss: 1.120840, loss_ss: 1.011561, loss_d: 0.109280
0.9217 --- loss: 1.351756, loss_ss: 1.101538, loss_d: 0.250218
0.9601 --- loss: 2.091398, loss_ss: 0.931134, loss_d: 1.160264
0.9985 --- loss: 2.045930, loss_ss: 1.091496, loss_d: 0.954435
Epoch finished! Loss: 1.5194385684453524
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.332997, loss_ss: 0.992755, loss_d: 0.340241
0.0384 --- loss: 1.343215, loss_ss: 0.937772, loss_d: 0.405442
0.0768 --- loss: 1.449710, loss_ss: 1.136661, loss_d: 0.313049
0.1152 --- loss: 1.167040, loss_ss: 0.906303, loss_d: 0.260736
0.1536 --- loss: 1.187747, loss_ss: 0.925549, loss_d: 0.262198
0.1920 --- loss: 0.867371, loss_ss: 0.714635, loss_d: 0.152736
0.2304 --- loss: 1.069854, loss_ss: 0.940414, loss_d: 0.129440
0.2688 --- loss: 1.604663, loss_ss: 1.178503, loss_d: 0.426161
0.3072 --- loss: 1.920429, loss_ss: 1.552172, loss_d: 0.368256
0.3456 --- loss: 1.371241, loss_ss: 1.108241, loss_d: 0.263000
0.3840 --- loss: 1.007972, loss_ss: 0.863468, loss_d: 0.144504
0.4224 --- loss: 1.246601, loss_ss: 1.169636, loss_d: 0.076964
0.4608 --- loss: 1.212936, loss_ss: 0.914294, loss_d: 0.298642
0.4992 --- loss: 1.480307, loss_ss: 1.036045, loss_d: 0.444262
0.5376 --- loss: 1.043744, loss_ss: 0.813408, loss_d: 0.230336
0.5760 --- loss: 1.822944, loss_ss: 1.724338, loss_d: 0.098606
0.6144 --- loss: 1.781714, loss_ss: 0.911072, loss_d: 0.870641
0.6528 --- loss: 1.392194, loss_ss: 0.911962, loss_d: 0.480232
0.6912 --- loss: 1.354151, loss_ss: 1.149657, loss_d: 0.204494
0.7296 --- loss: 1.250007, loss_ss: 0.904415, loss_d: 0.345593
0.7680 --- loss: 1.136531, loss_ss: 0.878525, loss_d: 0.258007
0.8065 --- loss: 1.274464, loss_ss: 1.115407, loss_d: 0.159057
0.8449 --- loss: 0.929620, loss_ss: 0.735299, loss_d: 0.194321
0.8833 --- loss: 0.985445, loss_ss: 0.904424, loss_d: 0.081021
0.9217 --- loss: 1.335245, loss_ss: 0.991224, loss_d: 0.344022
0.9601 --- loss: 1.536093, loss_ss: 1.197860, loss_d: 0.338233
0.9985 --- loss: 1.469206, loss_ss: 1.423990, loss_d: 0.045216
Epoch finished! Loss: 1.2899225496328794
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.310863, loss_ss: 1.162165, loss_d: 0.148698
0.0384 --- loss: 0.806102, loss_ss: 0.720687, loss_d: 0.085416
0.0768 --- loss: 1.151118, loss_ss: 1.033934, loss_d: 0.117184
0.1152 --- loss: 1.468626, loss_ss: 0.845631, loss_d: 0.622995
0.1536 --- loss: 1.303476, loss_ss: 0.953834, loss_d: 0.349643
0.1920 --- loss: 1.203505, loss_ss: 0.839836, loss_d: 0.363670
0.2304 --- loss: 1.133360, loss_ss: 0.857888, loss_d: 0.275472
0.2688 --- loss: 1.084079, loss_ss: 0.994759, loss_d: 0.089320
0.3072 --- loss: 1.589012, loss_ss: 0.683878, loss_d: 0.905134
0.3456 --- loss: 1.341295, loss_ss: 0.888714, loss_d: 0.452581
0.3840 --- loss: 1.307151, loss_ss: 1.117790, loss_d: 0.189361
0.4224 --- loss: 0.841750, loss_ss: 0.756969, loss_d: 0.084782
0.4608 --- loss: 1.153290, loss_ss: 0.844939, loss_d: 0.308351
0.4992 --- loss: 0.941423, loss_ss: 0.811569, loss_d: 0.129854
0.5376 --- loss: 1.200774, loss_ss: 0.947855, loss_d: 0.252919
0.5760 --- loss: 1.107942, loss_ss: 0.968272, loss_d: 0.139670
0.6144 --- loss: 1.561789, loss_ss: 0.767611, loss_d: 0.794178
0.6528 --- loss: 1.880026, loss_ss: 1.537273, loss_d: 0.342753
0.6912 --- loss: 1.845331, loss_ss: 0.775939, loss_d: 1.069392
0.7296 --- loss: 1.257340, loss_ss: 1.013260, loss_d: 0.244079
0.7680 --- loss: 1.215317, loss_ss: 0.953325, loss_d: 0.261992
0.8065 --- loss: 1.029197, loss_ss: 0.825541, loss_d: 0.203656
0.8449 --- loss: 1.322079, loss_ss: 1.237315, loss_d: 0.084764
0.8833 --- loss: 1.056383, loss_ss: 0.882625, loss_d: 0.173759
0.9217 --- loss: 1.259527, loss_ss: 0.853952, loss_d: 0.405575
0.9601 --- loss: 0.931310, loss_ss: 0.826909, loss_d: 0.104400
0.9985 --- loss: 1.836296, loss_ss: 1.767707, loss_d: 0.068590
Epoch finished! Loss: 1.200261718263993
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.126133, loss_ss: 0.930694, loss_d: 0.195439
0.0384 --- loss: 1.044886, loss_ss: 0.791449, loss_d: 0.253437
0.0768 --- loss: 0.817439, loss_ss: 0.632731, loss_d: 0.184708
0.1152 --- loss: 0.931880, loss_ss: 0.539990, loss_d: 0.391891
0.1536 --- loss: 1.340530, loss_ss: 1.059952, loss_d: 0.280578
0.1920 --- loss: 1.208300, loss_ss: 0.891164, loss_d: 0.317136
0.2304 --- loss: 0.933929, loss_ss: 0.679106, loss_d: 0.254824
0.2688 --- loss: 1.033970, loss_ss: 0.714389, loss_d: 0.319581
0.3072 --- loss: 1.198402, loss_ss: 0.918445, loss_d: 0.279957
0.3456 --- loss: 1.130932, loss_ss: 0.725455, loss_d: 0.405477
0.3840 --- loss: 1.158188, loss_ss: 1.007733, loss_d: 0.150455
0.4224 --- loss: 1.108711, loss_ss: 0.865959, loss_d: 0.242752
0.4608 --- loss: 0.999950, loss_ss: 0.785389, loss_d: 0.214560
0.4992 --- loss: 0.879331, loss_ss: 0.688354, loss_d: 0.190977
0.5376 --- loss: 0.966059, loss_ss: 0.801971, loss_d: 0.164088
0.5760 --- loss: 1.161801, loss_ss: 0.957063, loss_d: 0.204738
0.6144 --- loss: 0.949846, loss_ss: 0.736525, loss_d: 0.213321
0.6528 --- loss: 1.235351, loss_ss: 1.025883, loss_d: 0.209467
0.6912 --- loss: 0.996852, loss_ss: 0.944713, loss_d: 0.052139
0.7296 --- loss: 1.051828, loss_ss: 0.825535, loss_d: 0.226292
0.7680 --- loss: 1.190511, loss_ss: 0.645114, loss_d: 0.545397
0.8065 --- loss: 1.237424, loss_ss: 0.893073, loss_d: 0.344351
0.8449 --- loss: 1.089456, loss_ss: 0.879707, loss_d: 0.209749
0.8833 --- loss: 0.936057, loss_ss: 0.864218, loss_d: 0.071839
0.9217 --- loss: 1.823146, loss_ss: 1.160254, loss_d: 0.662892
0.9601 --- loss: 1.230525, loss_ss: 0.966998, loss_d: 0.263527
0.9985 --- loss: 1.001937, loss_ss: 0.910000, loss_d: 0.091937
Epoch finished! Loss: 1.1227130566652004
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.849766, loss_ss: 0.746057, loss_d: 0.103709
0.0384 --- loss: 0.887965, loss_ss: 0.656860, loss_d: 0.231104
0.0768 --- loss: 0.893380, loss_ss: 0.705067, loss_d: 0.188313
0.1152 --- loss: 0.774764, loss_ss: 0.712043, loss_d: 0.062722
0.1536 --- loss: 0.979379, loss_ss: 0.754877, loss_d: 0.224502
0.1920 --- loss: 0.974314, loss_ss: 0.879922, loss_d: 0.094392
0.2304 --- loss: 1.188720, loss_ss: 0.773917, loss_d: 0.414802
0.2688 --- loss: 1.535097, loss_ss: 1.006844, loss_d: 0.528254
0.3072 --- loss: 1.008578, loss_ss: 0.879479, loss_d: 0.129099
0.3456 --- loss: 1.084249, loss_ss: 0.847415, loss_d: 0.236834
0.3840 --- loss: 1.180907, loss_ss: 1.075259, loss_d: 0.105648
0.4224 --- loss: 1.141132, loss_ss: 0.805788, loss_d: 0.335344
0.4608 --- loss: 1.504243, loss_ss: 0.714392, loss_d: 0.789851
0.4992 --- loss: 1.020947, loss_ss: 0.943497, loss_d: 0.077450
0.5376 --- loss: 1.257841, loss_ss: 0.747545, loss_d: 0.510297
0.5760 --- loss: 1.520781, loss_ss: 1.224624, loss_d: 0.296156
0.6144 --- loss: 0.892317, loss_ss: 0.832311, loss_d: 0.060006
0.6528 --- loss: 1.137423, loss_ss: 1.097203, loss_d: 0.040219
0.6912 --- loss: 1.307339, loss_ss: 0.698000, loss_d: 0.609339
0.7296 --- loss: 1.149604, loss_ss: 0.735448, loss_d: 0.414156
0.7680 --- loss: 1.336964, loss_ss: 0.979727, loss_d: 0.357237
0.8065 --- loss: 1.129842, loss_ss: 0.789146, loss_d: 0.340696
0.8449 --- loss: 1.840817, loss_ss: 0.754789, loss_d: 1.086028
0.8833 --- loss: 1.268028, loss_ss: 0.844266, loss_d: 0.423762
0.9217 --- loss: 0.983826, loss_ss: 0.897087, loss_d: 0.086739
0.9601 --- loss: 0.996114, loss_ss: 0.956044, loss_d: 0.040071
0.9985 --- loss: 2.472841, loss_ss: 0.872562, loss_d: 1.600279
Epoch finished! Loss: 1.0806921901611182
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.120084, loss_ss: 0.933290, loss_d: 0.186794
0.0384 --- loss: 0.720627, loss_ss: 0.629253, loss_d: 0.091374
0.0768 --- loss: 1.456620, loss_ss: 1.351013, loss_d: 0.105606
0.1152 --- loss: 0.933637, loss_ss: 0.892538, loss_d: 0.041099
0.1536 --- loss: 1.118081, loss_ss: 1.060709, loss_d: 0.057372
0.1920 --- loss: 0.857315, loss_ss: 0.821162, loss_d: 0.036154
0.2304 --- loss: 0.866700, loss_ss: 0.779549, loss_d: 0.087151
0.2688 --- loss: 0.734466, loss_ss: 0.718554, loss_d: 0.015912
0.3072 --- loss: 0.939000, loss_ss: 0.673218, loss_d: 0.265782
0.3456 --- loss: 1.017306, loss_ss: 0.974440, loss_d: 0.042866
0.3840 --- loss: 0.946261, loss_ss: 0.761925, loss_d: 0.184336
0.4224 --- loss: 1.278843, loss_ss: 0.640427, loss_d: 0.638416
0.4608 --- loss: 1.061795, loss_ss: 0.884644, loss_d: 0.177151
0.4992 --- loss: 1.147017, loss_ss: 0.770601, loss_d: 0.376416
0.5376 --- loss: 0.663060, loss_ss: 0.640241, loss_d: 0.022819
0.5760 --- loss: 0.912462, loss_ss: 0.852598, loss_d: 0.059864
0.6144 --- loss: 0.784769, loss_ss: 0.735740, loss_d: 0.049029
0.6528 --- loss: 0.862378, loss_ss: 0.719968, loss_d: 0.142410
0.6912 --- loss: 1.075422, loss_ss: 0.813711, loss_d: 0.261711
0.7296 --- loss: 0.818300, loss_ss: 0.778221, loss_d: 0.040080
0.7680 --- loss: 0.842673, loss_ss: 0.781366, loss_d: 0.061307
0.8065 --- loss: 0.948746, loss_ss: 0.789948, loss_d: 0.158798
0.8449 --- loss: 0.825793, loss_ss: 0.795327, loss_d: 0.030466
0.8833 --- loss: 1.166664, loss_ss: 1.123189, loss_d: 0.043475
0.9217 --- loss: 0.824911, loss_ss: 0.675180, loss_d: 0.149731
0.9601 --- loss: 0.855948, loss_ss: 0.724655, loss_d: 0.131293
0.9985 --- loss: 0.834230, loss_ss: 0.682485, loss_d: 0.151744
Epoch finished! Loss: 1.0301354960753368
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.702978, loss_ss: 0.614600, loss_d: 0.088377
0.0384 --- loss: 1.001432, loss_ss: 0.996533, loss_d: 0.004899
0.0768 --- loss: 1.190419, loss_ss: 1.011794, loss_d: 0.178625
0.1152 --- loss: 0.985427, loss_ss: 0.925151, loss_d: 0.060276
0.1536 --- loss: 0.864431, loss_ss: 0.732646, loss_d: 0.131785
0.1920 --- loss: 0.771682, loss_ss: 0.751254, loss_d: 0.020428
0.2304 --- loss: 1.168931, loss_ss: 0.745563, loss_d: 0.423368
0.2688 --- loss: 0.855543, loss_ss: 0.824473, loss_d: 0.031070
0.3072 --- loss: 1.138030, loss_ss: 0.924704, loss_d: 0.213325
0.3456 --- loss: 1.388826, loss_ss: 1.294692, loss_d: 0.094134
0.3840 --- loss: 0.937548, loss_ss: 0.609008, loss_d: 0.328540
0.4224 --- loss: 0.770940, loss_ss: 0.715764, loss_d: 0.055176
0.4608 --- loss: 1.044647, loss_ss: 0.840199, loss_d: 0.204449
0.4992 --- loss: 0.864209, loss_ss: 0.767647, loss_d: 0.096562
0.5376 --- loss: 1.128762, loss_ss: 0.869315, loss_d: 0.259447
0.5760 --- loss: 0.919683, loss_ss: 0.800740, loss_d: 0.118943
0.6144 --- loss: 1.522927, loss_ss: 0.994018, loss_d: 0.528909
0.6528 --- loss: 0.833366, loss_ss: 0.624953, loss_d: 0.208413
0.6912 --- loss: 1.085028, loss_ss: 1.040573, loss_d: 0.044455
0.7296 --- loss: 0.917894, loss_ss: 0.594966, loss_d: 0.322928
0.7680 --- loss: 0.895046, loss_ss: 0.862277, loss_d: 0.032769
0.8065 --- loss: 1.379773, loss_ss: 0.779313, loss_d: 0.600461
0.8449 --- loss: 1.457093, loss_ss: 1.329857, loss_d: 0.127237
0.8833 --- loss: 0.803255, loss_ss: 0.761463, loss_d: 0.041792
0.9217 --- loss: 0.830999, loss_ss: 0.795496, loss_d: 0.035504
0.9601 --- loss: 1.150317, loss_ss: 1.013580, loss_d: 0.136737
0.9985 --- loss: 5.052862, loss_ss: 1.843579, loss_d: 3.209283
Epoch finished! Loss: 1.0132970257447316
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.826502, loss_ss: 0.790094, loss_d: 0.036408
0.0384 --- loss: 1.042365, loss_ss: 0.884625, loss_d: 0.157740
0.0768 --- loss: 0.692155, loss_ss: 0.515687, loss_d: 0.176467
0.1152 --- loss: 1.039168, loss_ss: 0.938961, loss_d: 0.100207
0.1536 --- loss: 0.687794, loss_ss: 0.668243, loss_d: 0.019551
0.1920 --- loss: 0.638257, loss_ss: 0.597459, loss_d: 0.040798
0.2304 --- loss: 0.863054, loss_ss: 0.840011, loss_d: 0.023043
0.2688 --- loss: 0.943219, loss_ss: 0.711725, loss_d: 0.231494
0.3072 --- loss: 0.765725, loss_ss: 0.724030, loss_d: 0.041696
0.3456 --- loss: 1.027455, loss_ss: 0.989876, loss_d: 0.037579
0.3840 --- loss: 1.102789, loss_ss: 0.884002, loss_d: 0.218787
0.4224 --- loss: 0.842596, loss_ss: 0.757601, loss_d: 0.084994
0.4608 --- loss: 1.040306, loss_ss: 1.001252, loss_d: 0.039054
0.4992 --- loss: 0.752172, loss_ss: 0.622326, loss_d: 0.129846
0.5376 --- loss: 0.917239, loss_ss: 0.891747, loss_d: 0.025492
0.5760 --- loss: 1.054612, loss_ss: 0.828847, loss_d: 0.225765
0.6144 --- loss: 0.718277, loss_ss: 0.685188, loss_d: 0.033089
0.6528 --- loss: 1.891574, loss_ss: 1.156068, loss_d: 0.735506
0.6912 --- loss: 1.008064, loss_ss: 0.922717, loss_d: 0.085347
0.7296 --- loss: 1.211097, loss_ss: 1.019540, loss_d: 0.191557
0.7680 --- loss: 1.713585, loss_ss: 0.928501, loss_d: 0.785085
0.8065 --- loss: 0.781148, loss_ss: 0.762483, loss_d: 0.018664
0.8449 --- loss: 1.030123, loss_ss: 0.850791, loss_d: 0.179332
0.8833 --- loss: 0.696899, loss_ss: 0.663728, loss_d: 0.033172
0.9217 --- loss: 1.000635, loss_ss: 0.686944, loss_d: 0.313691
0.9601 --- loss: 0.682173, loss_ss: 0.668727, loss_d: 0.013446
0.9985 --- loss: 1.927971, loss_ss: 1.611407, loss_d: 0.316563
Epoch finished! Loss: 0.989634545147419
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.738527, loss_ss: 0.614946, loss_d: 0.123581
0.0384 --- loss: 0.872183, loss_ss: 0.842593, loss_d: 0.029591
0.0768 --- loss: 0.952191, loss_ss: 0.814191, loss_d: 0.138000
0.1152 --- loss: 1.098278, loss_ss: 1.035706, loss_d: 0.062572
0.1536 --- loss: 0.695620, loss_ss: 0.669242, loss_d: 0.026378
0.1920 --- loss: 0.511640, loss_ss: 0.470223, loss_d: 0.041416
0.2304 --- loss: 0.695017, loss_ss: 0.636710, loss_d: 0.058307
0.2688 --- loss: 0.805008, loss_ss: 0.759582, loss_d: 0.045426
0.3072 --- loss: 1.047706, loss_ss: 0.793260, loss_d: 0.254447
0.3456 --- loss: 0.780984, loss_ss: 0.746194, loss_d: 0.034790
0.3840 --- loss: 1.224951, loss_ss: 1.211638, loss_d: 0.013313
0.4224 --- loss: 1.779605, loss_ss: 1.017411, loss_d: 0.762193
0.4608 --- loss: 1.002037, loss_ss: 0.886345, loss_d: 0.115693
0.4992 --- loss: 0.880882, loss_ss: 0.863916, loss_d: 0.016966
0.5376 --- loss: 1.322406, loss_ss: 0.817344, loss_d: 0.505062
0.5760 --- loss: 0.823704, loss_ss: 0.769623, loss_d: 0.054082
0.6144 --- loss: 1.106170, loss_ss: 0.908561, loss_d: 0.197609
0.6528 --- loss: 0.594336, loss_ss: 0.568760, loss_d: 0.025575
0.6912 --- loss: 0.761434, loss_ss: 0.697692, loss_d: 0.063742
0.7296 --- loss: 1.080136, loss_ss: 0.738717, loss_d: 0.341419
0.7680 --- loss: 0.885082, loss_ss: 0.769134, loss_d: 0.115948
0.8065 --- loss: 0.671504, loss_ss: 0.657947, loss_d: 0.013557
0.8449 --- loss: 1.090380, loss_ss: 1.017706, loss_d: 0.072674
0.8833 --- loss: 1.506475, loss_ss: 1.256284, loss_d: 0.250192
0.9217 --- loss: 0.951868, loss_ss: 0.900685, loss_d: 0.051182
0.9601 --- loss: 0.845359, loss_ss: 0.701808, loss_d: 0.143551
0.9985 --- loss: 3.585156, loss_ss: 1.595494, loss_d: 1.989663
Epoch finished! Loss: 0.9423203640259229
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7470588235294118
             precision    recall  f1-score   support

        0.0       0.72      0.83      0.77        66
        1.0       0.20      0.41      0.27        44
        2.0       0.71      0.88      0.78       406
        3.0       0.99      0.67      0.80       334
        4.0       0.89      0.64      0.75       170

avg / total       0.81      0.75      0.76      1020
 


====== chp029-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.86  83.33   97.80  72.37     77.46
1  90.29  40.91   92.52  19.78     26.67
2  80.59  87.68   75.90  70.63     78.24
3  88.92  67.07   99.56  98.68     79.86
4  92.75  64.12   98.47  89.34     74.66
Total accuracy: 74.71%
Average sen: 68.62%
Average spec: 92.85%
Macro f1-score: 67.38%
Diagnosis acc on 15mins: 1.0
[0.999874   0.91847205 0.96004707 0.99482983 0.99994242 0.99997497
 0.99988461 0.99981362 0.99909449 0.99995065 0.99987948 0.98053545
 0.99998784 0.99984324 0.99930763 0.99940729 0.99938238 0.99950814
 0.59463805 0.81118482 0.57452238 0.99646193 0.99845624 0.9990896
 0.99984765 0.99985015 0.99685955 0.999964   0.99988687 0.99995959
 0.99940789 0.99015278 0.75629699 0.99902344]
pred: 0.9578040312318241, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.407043, loss_ss: 1.735501, loss_d: 0.671542
0.0385 --- loss: 1.551950, loss_ss: 1.395388, loss_d: 0.156562
0.0770 --- loss: 2.064673, loss_ss: 1.536633, loss_d: 0.528040
0.1155 --- loss: 2.192709, loss_ss: 1.495956, loss_d: 0.696753
0.1540 --- loss: 2.189253, loss_ss: 1.533947, loss_d: 0.655306
0.1925 --- loss: 1.921257, loss_ss: 1.464425, loss_d: 0.456832
0.2309 --- loss: 2.241311, loss_ss: 1.590902, loss_d: 0.650409
0.2694 --- loss: 2.027863, loss_ss: 1.441676, loss_d: 0.586187
0.3079 --- loss: 1.961919, loss_ss: 1.395486, loss_d: 0.566433
0.3464 --- loss: 2.279280, loss_ss: 1.713501, loss_d: 0.565779
0.3849 --- loss: 2.165556, loss_ss: 1.587129, loss_d: 0.578428
0.4234 --- loss: 1.806105, loss_ss: 1.368853, loss_d: 0.437252
0.4619 --- loss: 2.029670, loss_ss: 1.463443, loss_d: 0.566228
0.5004 --- loss: 1.844403, loss_ss: 1.472333, loss_d: 0.372070
0.5389 --- loss: 1.846568, loss_ss: 1.530609, loss_d: 0.315959
0.5774 --- loss: 1.734381, loss_ss: 1.481329, loss_d: 0.253052
0.6159 --- loss: 1.656402, loss_ss: 1.332589, loss_d: 0.323814
0.6543 --- loss: 2.003421, loss_ss: 1.527187, loss_d: 0.476233
0.6928 --- loss: 1.815212, loss_ss: 1.611323, loss_d: 0.203890
0.7313 --- loss: 2.014859, loss_ss: 1.421432, loss_d: 0.593427
0.7698 --- loss: 1.899241, loss_ss: 1.366107, loss_d: 0.533134
0.8083 --- loss: 2.113590, loss_ss: 1.344897, loss_d: 0.768693
0.8468 --- loss: 1.687569, loss_ss: 1.291054, loss_d: 0.396515
0.8853 --- loss: 1.515435, loss_ss: 1.241327, loss_d: 0.274108
0.9238 --- loss: 1.601783, loss_ss: 1.414330, loss_d: 0.187453
0.9623 --- loss: 1.524271, loss_ss: 1.336999, loss_d: 0.187272
Epoch finished! Loss: 1.9778558913345041
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.706348, loss_ss: 1.379846, loss_d: 0.326502
0.0385 --- loss: 1.596085, loss_ss: 1.360777, loss_d: 0.235308
0.0770 --- loss: 2.012775, loss_ss: 1.277710, loss_d: 0.735065
0.1155 --- loss: 1.720974, loss_ss: 1.220615, loss_d: 0.500359
0.1540 --- loss: 2.127604, loss_ss: 1.235460, loss_d: 0.892144
0.1925 --- loss: 1.786240, loss_ss: 1.237499, loss_d: 0.548741
0.2309 --- loss: 1.557099, loss_ss: 1.339546, loss_d: 0.217553
0.2694 --- loss: 1.237275, loss_ss: 1.074536, loss_d: 0.162739
0.3079 --- loss: 1.508911, loss_ss: 1.349077, loss_d: 0.159834
0.3464 --- loss: 1.363328, loss_ss: 1.011168, loss_d: 0.352160
0.3849 --- loss: 1.764543, loss_ss: 1.292538, loss_d: 0.472005
0.4234 --- loss: 1.596244, loss_ss: 1.213988, loss_d: 0.382256
0.4619 --- loss: 1.568745, loss_ss: 1.274038, loss_d: 0.294708
0.5004 --- loss: 1.478965, loss_ss: 1.120995, loss_d: 0.357970
0.5389 --- loss: 1.375669, loss_ss: 1.076192, loss_d: 0.299477
0.5774 --- loss: 1.011701, loss_ss: 0.845979, loss_d: 0.165722
0.6159 --- loss: 1.704126, loss_ss: 1.103690, loss_d: 0.600436
0.6543 --- loss: 1.412473, loss_ss: 1.117252, loss_d: 0.295221
0.6928 --- loss: 1.689828, loss_ss: 1.388221, loss_d: 0.301607
0.7313 --- loss: 1.312776, loss_ss: 1.137786, loss_d: 0.174990
0.7698 --- loss: 1.112840, loss_ss: 0.946890, loss_d: 0.165951
0.8083 --- loss: 1.545843, loss_ss: 1.068467, loss_d: 0.477376
0.8468 --- loss: 1.238545, loss_ss: 1.088135, loss_d: 0.150410
0.8853 --- loss: 1.863626, loss_ss: 1.081599, loss_d: 0.782028
0.9238 --- loss: 1.585453, loss_ss: 1.063691, loss_d: 0.521761
0.9623 --- loss: 1.191375, loss_ss: 1.010871, loss_d: 0.180504
Epoch finished! Loss: 1.5121002086801418
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.704092, loss_ss: 1.133955, loss_d: 0.570137
0.0385 --- loss: 1.298786, loss_ss: 1.062126, loss_d: 0.236660
0.0770 --- loss: 1.262955, loss_ss: 1.118089, loss_d: 0.144866
0.1155 --- loss: 1.415901, loss_ss: 1.250118, loss_d: 0.165783
0.1540 --- loss: 1.156307, loss_ss: 0.989206, loss_d: 0.167101
0.1925 --- loss: 1.170527, loss_ss: 0.947161, loss_d: 0.223366
0.2309 --- loss: 1.289486, loss_ss: 1.047726, loss_d: 0.241760
0.2694 --- loss: 1.183345, loss_ss: 0.982254, loss_d: 0.201091
0.3079 --- loss: 1.707905, loss_ss: 1.102883, loss_d: 0.605022
0.3464 --- loss: 1.387434, loss_ss: 0.762809, loss_d: 0.624625
0.3849 --- loss: 1.308837, loss_ss: 1.061937, loss_d: 0.246900
0.4234 --- loss: 1.319789, loss_ss: 0.999439, loss_d: 0.320350
0.4619 --- loss: 1.105718, loss_ss: 1.041858, loss_d: 0.063861
0.5004 --- loss: 1.305147, loss_ss: 0.938520, loss_d: 0.366627
0.5389 --- loss: 1.384992, loss_ss: 0.765868, loss_d: 0.619123
0.5774 --- loss: 1.099126, loss_ss: 0.922323, loss_d: 0.176804
0.6159 --- loss: 0.921875, loss_ss: 0.669944, loss_d: 0.251931
0.6543 --- loss: 1.232327, loss_ss: 0.869937, loss_d: 0.362390
0.6928 --- loss: 1.093264, loss_ss: 0.859793, loss_d: 0.233471
0.7313 --- loss: 1.316362, loss_ss: 0.923426, loss_d: 0.392936
0.7698 --- loss: 0.823915, loss_ss: 0.669516, loss_d: 0.154399
0.8083 --- loss: 1.376201, loss_ss: 0.969385, loss_d: 0.406816
0.8468 --- loss: 1.353628, loss_ss: 1.122513, loss_d: 0.231115
0.8853 --- loss: 1.422205, loss_ss: 1.205109, loss_d: 0.217095
0.9238 --- loss: 1.486920, loss_ss: 0.994220, loss_d: 0.492700
0.9623 --- loss: 1.093887, loss_ss: 0.753599, loss_d: 0.340288
Epoch finished! Loss: 1.3246935500141277
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.800389, loss_ss: 0.720546, loss_d: 0.079843
0.0385 --- loss: 1.276758, loss_ss: 0.856462, loss_d: 0.420296
0.0770 --- loss: 1.299491, loss_ss: 1.002505, loss_d: 0.296986
0.1155 --- loss: 1.260777, loss_ss: 1.092149, loss_d: 0.168628
0.1540 --- loss: 0.995367, loss_ss: 0.927658, loss_d: 0.067708
0.1925 --- loss: 0.840534, loss_ss: 0.792897, loss_d: 0.047637
0.2309 --- loss: 0.957353, loss_ss: 0.835062, loss_d: 0.122291
0.2694 --- loss: 1.133935, loss_ss: 1.013780, loss_d: 0.120156
0.3079 --- loss: 1.118047, loss_ss: 0.880562, loss_d: 0.237485
0.3464 --- loss: 1.113567, loss_ss: 1.042991, loss_d: 0.070576
0.3849 --- loss: 1.360703, loss_ss: 1.082392, loss_d: 0.278311
0.4234 --- loss: 1.446661, loss_ss: 0.876886, loss_d: 0.569775
0.4619 --- loss: 1.217196, loss_ss: 0.960014, loss_d: 0.257182
0.5004 --- loss: 1.426459, loss_ss: 1.084664, loss_d: 0.341795
0.5389 --- loss: 0.953249, loss_ss: 0.739345, loss_d: 0.213904
0.5774 --- loss: 0.872521, loss_ss: 0.760341, loss_d: 0.112181
0.6159 --- loss: 1.539104, loss_ss: 0.862928, loss_d: 0.676176
0.6543 --- loss: 1.780982, loss_ss: 1.150430, loss_d: 0.630552
0.6928 --- loss: 1.470924, loss_ss: 1.301505, loss_d: 0.169419
0.7313 --- loss: 1.177832, loss_ss: 1.026329, loss_d: 0.151502
0.7698 --- loss: 0.977540, loss_ss: 0.861289, loss_d: 0.116252
0.8083 --- loss: 1.082869, loss_ss: 0.989549, loss_d: 0.093321
0.8468 --- loss: 1.369854, loss_ss: 0.963876, loss_d: 0.405978
0.8853 --- loss: 1.002533, loss_ss: 0.782348, loss_d: 0.220185
0.9238 --- loss: 1.964945, loss_ss: 1.391553, loss_d: 0.573392
0.9623 --- loss: 0.930436, loss_ss: 0.795094, loss_d: 0.135342
Epoch finished! Loss: 1.1929648362071357
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.878524, loss_ss: 0.713176, loss_d: 0.165348
0.0385 --- loss: 1.561852, loss_ss: 1.328154, loss_d: 0.233697
0.0770 --- loss: 1.045492, loss_ss: 0.916145, loss_d: 0.129347
0.1155 --- loss: 1.371021, loss_ss: 1.016736, loss_d: 0.354285
0.1540 --- loss: 1.505089, loss_ss: 1.337789, loss_d: 0.167300
0.1925 --- loss: 1.366954, loss_ss: 1.150759, loss_d: 0.216195
0.2309 --- loss: 1.370655, loss_ss: 0.952331, loss_d: 0.418324
0.2694 --- loss: 1.452693, loss_ss: 1.009799, loss_d: 0.442894
0.3079 --- loss: 1.298961, loss_ss: 0.958088, loss_d: 0.340872
0.3464 --- loss: 0.810054, loss_ss: 0.762069, loss_d: 0.047985
0.3849 --- loss: 1.341095, loss_ss: 1.082325, loss_d: 0.258770
0.4234 --- loss: 1.062495, loss_ss: 0.955108, loss_d: 0.107387
0.4619 --- loss: 1.016802, loss_ss: 0.897878, loss_d: 0.118924
0.5004 --- loss: 0.932829, loss_ss: 0.867521, loss_d: 0.065309
0.5389 --- loss: 1.419346, loss_ss: 0.795297, loss_d: 0.624050
0.5774 --- loss: 1.417628, loss_ss: 1.283681, loss_d: 0.133947
0.6159 --- loss: 1.257364, loss_ss: 1.192391, loss_d: 0.064973
0.6543 --- loss: 1.234144, loss_ss: 0.657919, loss_d: 0.576225
0.6928 --- loss: 1.113609, loss_ss: 0.817980, loss_d: 0.295629
0.7313 --- loss: 1.189378, loss_ss: 0.995511, loss_d: 0.193867
0.7698 --- loss: 1.147709, loss_ss: 0.858271, loss_d: 0.289438
0.8083 --- loss: 0.689907, loss_ss: 0.614932, loss_d: 0.074975
0.8468 --- loss: 1.085682, loss_ss: 1.024944, loss_d: 0.060737
0.8853 --- loss: 1.038605, loss_ss: 0.854538, loss_d: 0.184067
0.9238 --- loss: 1.051053, loss_ss: 0.781442, loss_d: 0.269611
0.9623 --- loss: 1.186000, loss_ss: 0.976506, loss_d: 0.209495
Epoch finished! Loss: 1.1347195411741042
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.972318, loss_ss: 0.816188, loss_d: 0.156130
0.0385 --- loss: 0.933996, loss_ss: 0.760182, loss_d: 0.173814
0.0770 --- loss: 1.227124, loss_ss: 0.745623, loss_d: 0.481501
0.1155 --- loss: 0.904604, loss_ss: 0.786665, loss_d: 0.117939
0.1540 --- loss: 0.949805, loss_ss: 0.908655, loss_d: 0.041150
0.1925 --- loss: 0.798798, loss_ss: 0.656612, loss_d: 0.142186
0.2309 --- loss: 1.398525, loss_ss: 0.814717, loss_d: 0.583809
0.2694 --- loss: 1.142536, loss_ss: 0.766531, loss_d: 0.376005
0.3079 --- loss: 1.067396, loss_ss: 0.897740, loss_d: 0.169656
0.3464 --- loss: 0.948286, loss_ss: 0.871536, loss_d: 0.076750
0.3849 --- loss: 0.917728, loss_ss: 0.877430, loss_d: 0.040298
0.4234 --- loss: 0.941544, loss_ss: 0.751181, loss_d: 0.190364
0.4619 --- loss: 0.916257, loss_ss: 0.725645, loss_d: 0.190613
0.5004 --- loss: 0.984841, loss_ss: 0.714464, loss_d: 0.270377
0.5389 --- loss: 1.026141, loss_ss: 0.865076, loss_d: 0.161065
0.5774 --- loss: 0.847071, loss_ss: 0.722785, loss_d: 0.124286
0.6159 --- loss: 1.134349, loss_ss: 0.995421, loss_d: 0.138927
0.6543 --- loss: 1.316859, loss_ss: 0.720843, loss_d: 0.596015
0.6928 --- loss: 1.030733, loss_ss: 0.958991, loss_d: 0.071742
0.7313 --- loss: 0.994422, loss_ss: 0.730802, loss_d: 0.263620
0.7698 --- loss: 0.865131, loss_ss: 0.821763, loss_d: 0.043369
0.8083 --- loss: 0.664121, loss_ss: 0.619306, loss_d: 0.044814
0.8468 --- loss: 1.184333, loss_ss: 0.795406, loss_d: 0.388927
0.8853 --- loss: 1.269803, loss_ss: 0.716889, loss_d: 0.552914
0.9238 --- loss: 1.134470, loss_ss: 1.029984, loss_d: 0.104486
0.9623 --- loss: 1.142964, loss_ss: 1.092152, loss_d: 0.050812
Epoch finished! Loss: 1.076414883366883
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.145015, loss_ss: 0.773728, loss_d: 0.371287
0.0385 --- loss: 0.752252, loss_ss: 0.725299, loss_d: 0.026953
0.0770 --- loss: 0.937357, loss_ss: 0.871262, loss_d: 0.066095
0.1155 --- loss: 0.773246, loss_ss: 0.746728, loss_d: 0.026517
0.1540 --- loss: 0.968109, loss_ss: 0.949526, loss_d: 0.018582
0.1925 --- loss: 0.908195, loss_ss: 0.857503, loss_d: 0.050692
0.2309 --- loss: 1.512896, loss_ss: 0.886434, loss_d: 0.626462
0.2694 --- loss: 0.895293, loss_ss: 0.720950, loss_d: 0.174343
0.3079 --- loss: 0.969447, loss_ss: 0.908859, loss_d: 0.060588
0.3464 --- loss: 0.928278, loss_ss: 0.818053, loss_d: 0.110225
0.3849 --- loss: 0.854507, loss_ss: 0.785146, loss_d: 0.069361
0.4234 --- loss: 1.036510, loss_ss: 0.881900, loss_d: 0.154610
0.4619 --- loss: 1.275207, loss_ss: 0.954419, loss_d: 0.320788
0.5004 --- loss: 0.813090, loss_ss: 0.651100, loss_d: 0.161989
0.5389 --- loss: 1.325596, loss_ss: 0.839336, loss_d: 0.486261
0.5774 --- loss: 0.735969, loss_ss: 0.651265, loss_d: 0.084705
0.6159 --- loss: 1.135719, loss_ss: 1.049744, loss_d: 0.085975
0.6543 --- loss: 1.116071, loss_ss: 1.009565, loss_d: 0.106506
0.6928 --- loss: 1.371416, loss_ss: 0.949456, loss_d: 0.421960
0.7313 --- loss: 1.434218, loss_ss: 0.949491, loss_d: 0.484727
0.7698 --- loss: 1.019516, loss_ss: 0.974315, loss_d: 0.045201
0.8083 --- loss: 1.008170, loss_ss: 0.989180, loss_d: 0.018989
0.8468 --- loss: 1.021116, loss_ss: 0.996126, loss_d: 0.024990
0.8853 --- loss: 1.190932, loss_ss: 1.112980, loss_d: 0.077953
0.9238 --- loss: 1.215549, loss_ss: 1.105868, loss_d: 0.109681
0.9623 --- loss: 1.059278, loss_ss: 0.898438, loss_d: 0.160840
Epoch finished! Loss: 1.0371445698167367
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.120636, loss_ss: 0.840869, loss_d: 0.279767
0.0385 --- loss: 0.780647, loss_ss: 0.678828, loss_d: 0.101819
0.0770 --- loss: 0.892582, loss_ss: 0.755790, loss_d: 0.136791
0.1155 --- loss: 0.991399, loss_ss: 0.831654, loss_d: 0.159745
0.1540 --- loss: 0.782068, loss_ss: 0.722286, loss_d: 0.059782
0.1925 --- loss: 0.656192, loss_ss: 0.628117, loss_d: 0.028075
0.2309 --- loss: 0.805025, loss_ss: 0.743197, loss_d: 0.061828
0.2694 --- loss: 0.933888, loss_ss: 0.768156, loss_d: 0.165732
0.3079 --- loss: 1.272901, loss_ss: 0.693245, loss_d: 0.579656
0.3464 --- loss: 0.793593, loss_ss: 0.760196, loss_d: 0.033397
0.3849 --- loss: 0.926091, loss_ss: 0.882674, loss_d: 0.043417
0.4234 --- loss: 0.789530, loss_ss: 0.773470, loss_d: 0.016061
0.4619 --- loss: 0.843098, loss_ss: 0.799391, loss_d: 0.043708
0.5004 --- loss: 1.036774, loss_ss: 0.790339, loss_d: 0.246435
0.5389 --- loss: 0.859313, loss_ss: 0.667922, loss_d: 0.191392
0.5774 --- loss: 0.737452, loss_ss: 0.540827, loss_d: 0.196626
0.6159 --- loss: 1.131592, loss_ss: 0.744300, loss_d: 0.387292
0.6543 --- loss: 1.142554, loss_ss: 0.877444, loss_d: 0.265110
0.6928 --- loss: 0.858659, loss_ss: 0.739846, loss_d: 0.118813
0.7313 --- loss: 1.002691, loss_ss: 0.950883, loss_d: 0.051808
0.7698 --- loss: 1.026637, loss_ss: 0.804935, loss_d: 0.221701
0.8083 --- loss: 1.388160, loss_ss: 0.746820, loss_d: 0.641340
0.8468 --- loss: 0.991287, loss_ss: 0.964675, loss_d: 0.026612
0.8853 --- loss: 0.873357, loss_ss: 0.823112, loss_d: 0.050244
0.9238 --- loss: 1.469915, loss_ss: 0.863073, loss_d: 0.606842
0.9623 --- loss: 0.810431, loss_ss: 0.737052, loss_d: 0.073380
Epoch finished! Loss: 1.0021257349883268
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.761532, loss_ss: 0.543463, loss_d: 0.218069
0.0385 --- loss: 0.790068, loss_ss: 0.692483, loss_d: 0.097585
0.0770 --- loss: 0.975916, loss_ss: 0.923160, loss_d: 0.052756
0.1155 --- loss: 0.660853, loss_ss: 0.646196, loss_d: 0.014657
0.1540 --- loss: 1.080527, loss_ss: 0.955419, loss_d: 0.125109
0.1925 --- loss: 1.207488, loss_ss: 0.923483, loss_d: 0.284005
0.2309 --- loss: 1.199570, loss_ss: 1.003895, loss_d: 0.195675
0.2694 --- loss: 0.915577, loss_ss: 0.772289, loss_d: 0.143288
0.3079 --- loss: 1.086989, loss_ss: 1.022688, loss_d: 0.064301
0.3464 --- loss: 0.763313, loss_ss: 0.755928, loss_d: 0.007385
0.3849 --- loss: 0.872323, loss_ss: 0.869573, loss_d: 0.002750
0.4234 --- loss: 0.760651, loss_ss: 0.753421, loss_d: 0.007230
0.4619 --- loss: 1.131140, loss_ss: 0.619208, loss_d: 0.511932
0.5004 --- loss: 0.761653, loss_ss: 0.686765, loss_d: 0.074889
0.5389 --- loss: 0.982728, loss_ss: 0.974905, loss_d: 0.007823
0.5774 --- loss: 0.566663, loss_ss: 0.522283, loss_d: 0.044380
0.6159 --- loss: 0.976044, loss_ss: 0.943781, loss_d: 0.032263
0.6543 --- loss: 0.567595, loss_ss: 0.526900, loss_d: 0.040695
0.6928 --- loss: 1.143248, loss_ss: 1.079682, loss_d: 0.063566
0.7313 --- loss: 0.986438, loss_ss: 0.645805, loss_d: 0.340632
0.7698 --- loss: 0.741081, loss_ss: 0.701918, loss_d: 0.039163
0.8083 --- loss: 0.741042, loss_ss: 0.733533, loss_d: 0.007509
0.8468 --- loss: 1.025473, loss_ss: 0.892227, loss_d: 0.133246
0.8853 --- loss: 1.161055, loss_ss: 0.964347, loss_d: 0.196708
0.9238 --- loss: 1.593035, loss_ss: 1.338628, loss_d: 0.254407
0.9623 --- loss: 1.209120, loss_ss: 0.672046, loss_d: 0.537074
Epoch finished! Loss: 0.9690063126298912
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.017581, loss_ss: 0.976125, loss_d: 0.041456
0.0385 --- loss: 1.371341, loss_ss: 1.141209, loss_d: 0.230132
0.0770 --- loss: 0.633902, loss_ss: 0.610684, loss_d: 0.023218
0.1155 --- loss: 0.799091, loss_ss: 0.759507, loss_d: 0.039584
0.1540 --- loss: 0.765858, loss_ss: 0.760495, loss_d: 0.005363
0.1925 --- loss: 0.857088, loss_ss: 0.817537, loss_d: 0.039552
0.2309 --- loss: 0.767684, loss_ss: 0.752940, loss_d: 0.014744
0.2694 --- loss: 0.816018, loss_ss: 0.785054, loss_d: 0.030964
0.3079 --- loss: 0.894017, loss_ss: 0.887738, loss_d: 0.006278
0.3464 --- loss: 0.827145, loss_ss: 0.786590, loss_d: 0.040555
0.3849 --- loss: 0.668299, loss_ss: 0.602618, loss_d: 0.065682
0.4234 --- loss: 0.688810, loss_ss: 0.630822, loss_d: 0.057988
0.4619 --- loss: 1.253862, loss_ss: 1.211876, loss_d: 0.041986
0.5004 --- loss: 0.718587, loss_ss: 0.712486, loss_d: 0.006101
0.5389 --- loss: 1.504840, loss_ss: 1.039355, loss_d: 0.465485
0.5774 --- loss: 1.178865, loss_ss: 0.983370, loss_d: 0.195495
0.6159 --- loss: 0.835472, loss_ss: 0.806499, loss_d: 0.028974
0.6543 --- loss: 0.831691, loss_ss: 0.811543, loss_d: 0.020149
0.6928 --- loss: 0.718646, loss_ss: 0.707686, loss_d: 0.010959
0.7313 --- loss: 1.025921, loss_ss: 0.836451, loss_d: 0.189470
0.7698 --- loss: 0.825006, loss_ss: 0.799168, loss_d: 0.025839
0.8083 --- loss: 0.712369, loss_ss: 0.696622, loss_d: 0.015747
0.8468 --- loss: 0.922821, loss_ss: 0.867055, loss_d: 0.055766
0.8853 --- loss: 0.989743, loss_ss: 0.919436, loss_d: 0.070307
0.9238 --- loss: 0.935265, loss_ss: 0.899743, loss_d: 0.035523
0.9623 --- loss: 1.268888, loss_ss: 1.085117, loss_d: 0.183770
Epoch finished! Loss: 0.9370243098284747
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6088407005838199
             precision    recall  f1-score   support

        0.0       0.94      0.47      0.63       350
        1.0       0.25      0.39      0.31       204
        2.0       0.61      0.98      0.75       346
        3.0       0.97      0.68      0.80       179
        4.0       0.74      0.22      0.34       120

avg / total       0.71      0.61      0.61      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.82  47.43   98.82  94.32     63.12
1  70.14  38.73   76.58  25.32     30.62
2  81.57  97.69   75.03  61.34     75.36
3  94.83  67.60   99.61  96.80     79.61
4  91.41  21.67   99.17  74.29     33.55
Total accuracy: 60.88%
Average sen: 54.62%
Average spec: 89.84%
Macro f1-score: 56.45%
Diagnosis acc on 15mins: 0.825
[0.64526504 0.82465392 0.89824468 0.59578663 0.98497689 0.99595559
 0.99282974 0.81881571 0.45043781 0.96328485 0.50072014 0.76105213
 0.45790166 0.96697748 0.96148074 0.97337896 0.71124905 0.92824024
 0.13401805 0.07021011 0.98048431 0.997343   0.96677935 0.77566093
 0.3497822  0.86068696 0.14764026 0.95446014 0.77880222 0.83306646
 0.99917561 0.97324717 0.96895707 0.89072901 0.96639544 0.91802174
 0.38518074 0.98956722 0.99222374 0.99272126]
pred: 0.7839101061224938, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.470667, loss_ss: 1.821754, loss_d: 0.648913
0.0384 --- loss: 2.397205, loss_ss: 1.748400, loss_d: 0.648805
0.0769 --- loss: 2.183445, loss_ss: 1.629807, loss_d: 0.553638
0.1153 --- loss: 2.195070, loss_ss: 1.633893, loss_d: 0.561176
0.1538 --- loss: 2.252651, loss_ss: 1.584039, loss_d: 0.668611
0.1922 --- loss: 2.512115, loss_ss: 1.520993, loss_d: 0.991122
0.2307 --- loss: 1.968529, loss_ss: 1.488793, loss_d: 0.479736
0.2691 --- loss: 2.253795, loss_ss: 1.459768, loss_d: 0.794028
0.3076 --- loss: 2.186220, loss_ss: 1.507665, loss_d: 0.678556
0.3460 --- loss: 2.113971, loss_ss: 1.494506, loss_d: 0.619465
0.3845 --- loss: 2.307296, loss_ss: 1.606493, loss_d: 0.700802
0.4229 --- loss: 1.954987, loss_ss: 1.396370, loss_d: 0.558617
0.4614 --- loss: 2.075927, loss_ss: 1.483019, loss_d: 0.592908
0.4998 --- loss: 1.899966, loss_ss: 1.351029, loss_d: 0.548937
0.5383 --- loss: 1.766518, loss_ss: 1.490389, loss_d: 0.276129
0.5767 --- loss: 2.135383, loss_ss: 1.490545, loss_d: 0.644838
0.6151 --- loss: 2.356958, loss_ss: 1.536695, loss_d: 0.820263
0.6536 --- loss: 1.997908, loss_ss: 1.508797, loss_d: 0.489111
0.6920 --- loss: 1.884310, loss_ss: 1.387288, loss_d: 0.497021
0.7305 --- loss: 1.860977, loss_ss: 1.453585, loss_d: 0.407392
0.7689 --- loss: 1.731933, loss_ss: 1.479494, loss_d: 0.252439
0.8074 --- loss: 1.890415, loss_ss: 1.413986, loss_d: 0.476430
0.8458 --- loss: 1.785364, loss_ss: 1.317755, loss_d: 0.467609
0.8843 --- loss: 1.949888, loss_ss: 1.286310, loss_d: 0.663577
0.9227 --- loss: 1.935800, loss_ss: 1.330097, loss_d: 0.605703
0.9612 --- loss: 1.479839, loss_ss: 1.249699, loss_d: 0.230140
0.9996 --- loss: 2.122056, loss_ss: 2.052360, loss_d: 0.069696
Epoch finished! Loss: 2.030963480931062
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.897884, loss_ss: 1.318631, loss_d: 0.579254
0.0384 --- loss: 2.054638, loss_ss: 1.425724, loss_d: 0.628914
0.0769 --- loss: 1.518564, loss_ss: 1.163595, loss_d: 0.354968
0.1153 --- loss: 1.657648, loss_ss: 1.369515, loss_d: 0.288133
0.1538 --- loss: 1.860077, loss_ss: 1.355177, loss_d: 0.504901
0.1922 --- loss: 2.518489, loss_ss: 1.396596, loss_d: 1.121893
0.2307 --- loss: 1.610172, loss_ss: 1.267093, loss_d: 0.343080
0.2691 --- loss: 1.602198, loss_ss: 1.306044, loss_d: 0.296154
0.3076 --- loss: 1.585608, loss_ss: 1.295820, loss_d: 0.289788
0.3460 --- loss: 1.725835, loss_ss: 1.280939, loss_d: 0.444896
0.3845 --- loss: 1.544587, loss_ss: 1.124564, loss_d: 0.420023
0.4229 --- loss: 1.865140, loss_ss: 1.211128, loss_d: 0.654011
0.4614 --- loss: 1.510598, loss_ss: 1.265194, loss_d: 0.245404
0.4998 --- loss: 1.370609, loss_ss: 1.185885, loss_d: 0.184724
0.5383 --- loss: 1.565194, loss_ss: 1.121821, loss_d: 0.443374
0.5767 --- loss: 1.364264, loss_ss: 1.179255, loss_d: 0.185009
0.6151 --- loss: 1.395506, loss_ss: 1.251162, loss_d: 0.144344
0.6536 --- loss: 2.247379, loss_ss: 1.047316, loss_d: 1.200064
0.6920 --- loss: 1.434793, loss_ss: 1.120095, loss_d: 0.314697
0.7305 --- loss: 1.770755, loss_ss: 1.209222, loss_d: 0.561533
0.7689 --- loss: 1.376913, loss_ss: 1.140136, loss_d: 0.236777
0.8074 --- loss: 1.481102, loss_ss: 1.125355, loss_d: 0.355747
0.8458 --- loss: 1.435235, loss_ss: 1.116578, loss_d: 0.318658
0.8843 --- loss: 1.390160, loss_ss: 1.216161, loss_d: 0.174000
0.9227 --- loss: 1.469743, loss_ss: 1.056627, loss_d: 0.413116
0.9612 --- loss: 1.799104, loss_ss: 1.139590, loss_d: 0.659514
0.9996 --- loss: 2.321262, loss_ss: 2.262894, loss_d: 0.058367
Epoch finished! Loss: 1.5893744344894702
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.524223, loss_ss: 1.053252, loss_d: 0.470972
0.0384 --- loss: 1.378080, loss_ss: 1.040132, loss_d: 0.337949
0.0769 --- loss: 1.224196, loss_ss: 1.040208, loss_d: 0.183988
0.1153 --- loss: 1.400650, loss_ss: 1.097888, loss_d: 0.302761
0.1538 --- loss: 1.628568, loss_ss: 1.016903, loss_d: 0.611665
0.1922 --- loss: 1.463491, loss_ss: 1.004925, loss_d: 0.458565
0.2307 --- loss: 1.539416, loss_ss: 0.953597, loss_d: 0.585819
0.2691 --- loss: 1.568381, loss_ss: 1.090937, loss_d: 0.477444
0.3076 --- loss: 1.374466, loss_ss: 1.227068, loss_d: 0.147398
0.3460 --- loss: 1.045074, loss_ss: 0.921504, loss_d: 0.123569
0.3845 --- loss: 1.486657, loss_ss: 1.316268, loss_d: 0.170388
0.4229 --- loss: 1.318706, loss_ss: 0.993928, loss_d: 0.324779
0.4614 --- loss: 1.240919, loss_ss: 1.028557, loss_d: 0.212363
0.4998 --- loss: 1.436417, loss_ss: 0.965142, loss_d: 0.471275
0.5383 --- loss: 1.432738, loss_ss: 1.130617, loss_d: 0.302121
0.5767 --- loss: 1.523028, loss_ss: 1.345804, loss_d: 0.177224
0.6151 --- loss: 1.252425, loss_ss: 1.112833, loss_d: 0.139591
0.6536 --- loss: 1.368889, loss_ss: 1.048086, loss_d: 0.320803
0.6920 --- loss: 1.832224, loss_ss: 1.404046, loss_d: 0.428179
0.7305 --- loss: 1.468741, loss_ss: 1.281247, loss_d: 0.187494
0.7689 --- loss: 1.022256, loss_ss: 0.939161, loss_d: 0.083095
0.8074 --- loss: 0.995298, loss_ss: 0.808276, loss_d: 0.187022
0.8458 --- loss: 1.030777, loss_ss: 0.851721, loss_d: 0.179056
0.8843 --- loss: 1.463537, loss_ss: 1.029362, loss_d: 0.434174
0.9227 --- loss: 1.315013, loss_ss: 0.950232, loss_d: 0.364781
0.9612 --- loss: 0.942916, loss_ss: 0.762210, loss_d: 0.180706
0.9996 --- loss: 4.555100, loss_ss: 1.586277, loss_d: 2.968823
Epoch finished! Loss: 1.313901684146661
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.350352, loss_ss: 1.045220, loss_d: 0.305132
0.0384 --- loss: 1.580302, loss_ss: 1.135299, loss_d: 0.445003
0.0769 --- loss: 1.244114, loss_ss: 0.998591, loss_d: 0.245523
0.1153 --- loss: 1.456493, loss_ss: 0.926536, loss_d: 0.529957
0.1538 --- loss: 1.337918, loss_ss: 1.029326, loss_d: 0.308592
0.1922 --- loss: 1.646488, loss_ss: 1.055692, loss_d: 0.590796
0.2307 --- loss: 1.045675, loss_ss: 0.877457, loss_d: 0.168218
0.2691 --- loss: 1.195136, loss_ss: 0.990393, loss_d: 0.204744
0.3076 --- loss: 1.445110, loss_ss: 0.624533, loss_d: 0.820577
0.3460 --- loss: 1.257303, loss_ss: 0.920387, loss_d: 0.336915
0.3845 --- loss: 1.031443, loss_ss: 0.850320, loss_d: 0.181123
0.4229 --- loss: 1.151282, loss_ss: 0.946530, loss_d: 0.204752
0.4614 --- loss: 0.862596, loss_ss: 0.766626, loss_d: 0.095970
0.4998 --- loss: 1.121216, loss_ss: 0.906799, loss_d: 0.214417
0.5383 --- loss: 0.909427, loss_ss: 0.806179, loss_d: 0.103248
0.5767 --- loss: 1.375910, loss_ss: 1.275799, loss_d: 0.100111
0.6151 --- loss: 1.609079, loss_ss: 0.949752, loss_d: 0.659327
0.6536 --- loss: 1.179955, loss_ss: 1.014903, loss_d: 0.165052
0.6920 --- loss: 1.117168, loss_ss: 0.895517, loss_d: 0.221652
0.7305 --- loss: 1.468843, loss_ss: 1.101832, loss_d: 0.367010
0.7689 --- loss: 1.305490, loss_ss: 0.859298, loss_d: 0.446192
0.8074 --- loss: 1.139058, loss_ss: 1.026088, loss_d: 0.112970
0.8458 --- loss: 0.909328, loss_ss: 0.844240, loss_d: 0.065089
0.8843 --- loss: 1.046340, loss_ss: 0.888308, loss_d: 0.158032
0.9227 --- loss: 1.253254, loss_ss: 1.040710, loss_d: 0.212545
0.9612 --- loss: 0.907004, loss_ss: 0.737289, loss_d: 0.169715
0.9996 --- loss: 5.031450, loss_ss: 1.059609, loss_d: 3.971841
Epoch finished! Loss: 1.2247513408844288
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.417638, loss_ss: 0.938663, loss_d: 0.478976
0.0384 --- loss: 1.216841, loss_ss: 0.880459, loss_d: 0.336382
0.0769 --- loss: 1.179424, loss_ss: 0.923123, loss_d: 0.256301
0.1153 --- loss: 0.986094, loss_ss: 0.786036, loss_d: 0.200058
0.1538 --- loss: 1.135085, loss_ss: 0.787932, loss_d: 0.347153
0.1922 --- loss: 0.958913, loss_ss: 0.893545, loss_d: 0.065367
0.2307 --- loss: 0.940376, loss_ss: 0.805166, loss_d: 0.135211
0.2691 --- loss: 1.044125, loss_ss: 0.794559, loss_d: 0.249566
0.3076 --- loss: 0.964372, loss_ss: 0.910480, loss_d: 0.053892
0.3460 --- loss: 1.092748, loss_ss: 0.991644, loss_d: 0.101104
0.3845 --- loss: 1.092630, loss_ss: 1.004384, loss_d: 0.088246
0.4229 --- loss: 1.129983, loss_ss: 0.851452, loss_d: 0.278531
0.4614 --- loss: 0.922146, loss_ss: 0.804759, loss_d: 0.117387
0.4998 --- loss: 1.092551, loss_ss: 0.641832, loss_d: 0.450720
0.5383 --- loss: 1.546942, loss_ss: 0.961571, loss_d: 0.585371
0.5767 --- loss: 1.058855, loss_ss: 0.752701, loss_d: 0.306154
0.6151 --- loss: 1.287026, loss_ss: 0.978141, loss_d: 0.308885
0.6536 --- loss: 1.216479, loss_ss: 0.996418, loss_d: 0.220061
0.6920 --- loss: 1.069033, loss_ss: 0.965736, loss_d: 0.103297
0.7305 --- loss: 1.100741, loss_ss: 0.986504, loss_d: 0.114237
0.7689 --- loss: 1.270574, loss_ss: 0.959048, loss_d: 0.311527
0.8074 --- loss: 1.322619, loss_ss: 1.045422, loss_d: 0.277196
0.8458 --- loss: 0.916749, loss_ss: 0.800749, loss_d: 0.116000
0.8843 --- loss: 0.918922, loss_ss: 0.799267, loss_d: 0.119655
0.9227 --- loss: 1.018922, loss_ss: 0.767434, loss_d: 0.251489
0.9612 --- loss: 1.460253, loss_ss: 1.124246, loss_d: 0.336007
0.9996 --- loss: 1.119618, loss_ss: 1.111839, loss_d: 0.007780
Epoch finished! Loss: 1.156499199454601
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.028518, loss_ss: 0.934538, loss_d: 0.093981
0.0384 --- loss: 0.818864, loss_ss: 0.736924, loss_d: 0.081940
0.0769 --- loss: 1.185602, loss_ss: 0.939865, loss_d: 0.245738
0.1153 --- loss: 0.897034, loss_ss: 0.791324, loss_d: 0.105709
0.1538 --- loss: 0.821030, loss_ss: 0.760822, loss_d: 0.060208
0.1922 --- loss: 1.447356, loss_ss: 1.054545, loss_d: 0.392811
0.2307 --- loss: 1.129870, loss_ss: 0.873404, loss_d: 0.256465
0.2691 --- loss: 1.202112, loss_ss: 1.134905, loss_d: 0.067207
0.3076 --- loss: 0.954750, loss_ss: 0.784026, loss_d: 0.170723
0.3460 --- loss: 1.136563, loss_ss: 0.723852, loss_d: 0.412711
0.3845 --- loss: 0.951934, loss_ss: 0.772178, loss_d: 0.179756
0.4229 --- loss: 0.878269, loss_ss: 0.804886, loss_d: 0.073383
0.4614 --- loss: 0.891034, loss_ss: 0.805541, loss_d: 0.085493
0.4998 --- loss: 0.729151, loss_ss: 0.632593, loss_d: 0.096559
0.5383 --- loss: 0.848996, loss_ss: 0.817333, loss_d: 0.031663
0.5767 --- loss: 0.994580, loss_ss: 0.871115, loss_d: 0.123465
0.6151 --- loss: 1.115281, loss_ss: 0.927916, loss_d: 0.187365
0.6536 --- loss: 1.022639, loss_ss: 0.927093, loss_d: 0.095547
0.6920 --- loss: 0.971502, loss_ss: 0.829033, loss_d: 0.142468
0.7305 --- loss: 0.905227, loss_ss: 0.765877, loss_d: 0.139350
0.7689 --- loss: 1.458074, loss_ss: 0.719398, loss_d: 0.738676
0.8074 --- loss: 1.015317, loss_ss: 0.833121, loss_d: 0.182196
0.8458 --- loss: 1.094401, loss_ss: 0.882127, loss_d: 0.212273
0.8843 --- loss: 1.084949, loss_ss: 0.903007, loss_d: 0.181942
0.9227 --- loss: 1.193578, loss_ss: 0.880692, loss_d: 0.312887
0.9612 --- loss: 1.116760, loss_ss: 0.779318, loss_d: 0.337443
0.9996 --- loss: 2.056842, loss_ss: 2.047162, loss_d: 0.009680
Epoch finished! Loss: 1.0997468728285569
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.014615, loss_ss: 0.951529, loss_d: 0.063086
0.0384 --- loss: 0.839406, loss_ss: 0.795931, loss_d: 0.043475
0.0769 --- loss: 1.093598, loss_ss: 0.986712, loss_d: 0.106886
0.1153 --- loss: 0.983710, loss_ss: 0.745170, loss_d: 0.238541
0.1538 --- loss: 0.724820, loss_ss: 0.614962, loss_d: 0.109858
0.1922 --- loss: 0.883088, loss_ss: 0.755717, loss_d: 0.127371
0.2307 --- loss: 0.896904, loss_ss: 0.615645, loss_d: 0.281259
0.2691 --- loss: 1.057725, loss_ss: 1.006092, loss_d: 0.051633
0.3076 --- loss: 0.917145, loss_ss: 0.879603, loss_d: 0.037542
0.3460 --- loss: 0.703217, loss_ss: 0.692210, loss_d: 0.011006
0.3845 --- loss: 1.565431, loss_ss: 0.840552, loss_d: 0.724879
0.4229 --- loss: 1.144901, loss_ss: 1.073451, loss_d: 0.071450
0.4614 --- loss: 0.940238, loss_ss: 0.921957, loss_d: 0.018280
0.4998 --- loss: 0.951610, loss_ss: 0.584907, loss_d: 0.366703
0.5383 --- loss: 0.731018, loss_ss: 0.717832, loss_d: 0.013186
0.5767 --- loss: 0.839742, loss_ss: 0.812437, loss_d: 0.027306
0.6151 --- loss: 1.257550, loss_ss: 0.896541, loss_d: 0.361009
0.6536 --- loss: 0.998967, loss_ss: 0.984458, loss_d: 0.014510
0.6920 --- loss: 0.924040, loss_ss: 0.800514, loss_d: 0.123526
0.7305 --- loss: 0.822264, loss_ss: 0.783618, loss_d: 0.038646
0.7689 --- loss: 0.932573, loss_ss: 0.715680, loss_d: 0.216893
0.8074 --- loss: 0.943928, loss_ss: 0.759048, loss_d: 0.184881
0.8458 --- loss: 0.954313, loss_ss: 0.912072, loss_d: 0.042242
0.8843 --- loss: 0.703525, loss_ss: 0.694967, loss_d: 0.008558
0.9227 --- loss: 1.216313, loss_ss: 0.845283, loss_d: 0.371029
0.9612 --- loss: 0.979466, loss_ss: 0.851696, loss_d: 0.127771
0.9996 --- loss: 3.167406, loss_ss: 3.164086, loss_d: 0.003320
Epoch finished! Loss: 1.0224614693568304
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.919761, loss_ss: 0.894376, loss_d: 0.025384
0.0384 --- loss: 0.805322, loss_ss: 0.563833, loss_d: 0.241489
0.0769 --- loss: 0.770736, loss_ss: 0.703423, loss_d: 0.067313
0.1153 --- loss: 1.422794, loss_ss: 0.865319, loss_d: 0.557474
0.1538 --- loss: 1.140479, loss_ss: 0.848713, loss_d: 0.291766
0.1922 --- loss: 0.766316, loss_ss: 0.634945, loss_d: 0.131371
0.2307 --- loss: 0.862442, loss_ss: 0.801942, loss_d: 0.060500
0.2691 --- loss: 0.860695, loss_ss: 0.838763, loss_d: 0.021931
0.3076 --- loss: 0.868130, loss_ss: 0.825714, loss_d: 0.042416
0.3460 --- loss: 0.945156, loss_ss: 0.807321, loss_d: 0.137835
0.3845 --- loss: 0.878758, loss_ss: 0.841247, loss_d: 0.037511
0.4229 --- loss: 1.133759, loss_ss: 1.071388, loss_d: 0.062371
0.4614 --- loss: 0.777779, loss_ss: 0.664823, loss_d: 0.112957
0.4998 --- loss: 1.259813, loss_ss: 1.246455, loss_d: 0.013359
0.5383 --- loss: 0.908603, loss_ss: 0.860321, loss_d: 0.048282
0.5767 --- loss: 0.988472, loss_ss: 0.855984, loss_d: 0.132488
0.6151 --- loss: 0.829354, loss_ss: 0.803505, loss_d: 0.025849
0.6536 --- loss: 1.216653, loss_ss: 1.153176, loss_d: 0.063477
0.6920 --- loss: 0.872925, loss_ss: 0.739073, loss_d: 0.133853
0.7305 --- loss: 0.863571, loss_ss: 0.708606, loss_d: 0.154966
0.7689 --- loss: 0.936659, loss_ss: 0.870093, loss_d: 0.066565
0.8074 --- loss: 0.984226, loss_ss: 0.880223, loss_d: 0.104003
0.8458 --- loss: 1.161189, loss_ss: 0.915234, loss_d: 0.245955
0.8843 --- loss: 0.877255, loss_ss: 0.816181, loss_d: 0.061074
0.9227 --- loss: 1.282321, loss_ss: 1.081455, loss_d: 0.200867
0.9612 --- loss: 0.891729, loss_ss: 0.885206, loss_d: 0.006523
0.9996 --- loss: 2.286211, loss_ss: 2.281756, loss_d: 0.004456
Epoch finished! Loss: 0.9953321773272295
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.574540, loss_ss: 0.549003, loss_d: 0.025537
0.0384 --- loss: 1.161370, loss_ss: 0.703627, loss_d: 0.457744
0.0769 --- loss: 0.782586, loss_ss: 0.655739, loss_d: 0.126848
0.1153 --- loss: 1.031584, loss_ss: 0.847390, loss_d: 0.184195
0.1538 --- loss: 0.760775, loss_ss: 0.745372, loss_d: 0.015403
0.1922 --- loss: 1.100685, loss_ss: 0.731175, loss_d: 0.369510
0.2307 --- loss: 0.990924, loss_ss: 0.978869, loss_d: 0.012055
0.2691 --- loss: 0.842074, loss_ss: 0.813263, loss_d: 0.028811
0.3076 --- loss: 1.048989, loss_ss: 0.968280, loss_d: 0.080708
0.3460 --- loss: 0.995629, loss_ss: 0.863985, loss_d: 0.131645
0.3845 --- loss: 0.685965, loss_ss: 0.668470, loss_d: 0.017494
0.4229 --- loss: 0.626747, loss_ss: 0.618654, loss_d: 0.008093
0.4614 --- loss: 1.343771, loss_ss: 0.998128, loss_d: 0.345643
0.4998 --- loss: 1.042110, loss_ss: 0.740988, loss_d: 0.301122
0.5383 --- loss: 0.915038, loss_ss: 0.860342, loss_d: 0.054696
0.5767 --- loss: 0.954607, loss_ss: 0.766107, loss_d: 0.188499
0.6151 --- loss: 0.805383, loss_ss: 0.776247, loss_d: 0.029136
0.6536 --- loss: 0.971582, loss_ss: 0.770934, loss_d: 0.200648
0.6920 --- loss: 1.018376, loss_ss: 0.852539, loss_d: 0.165837
0.7305 --- loss: 0.800126, loss_ss: 0.673489, loss_d: 0.126637
0.7689 --- loss: 1.016216, loss_ss: 0.963746, loss_d: 0.052470
0.8074 --- loss: 1.040455, loss_ss: 0.849728, loss_d: 0.190727
0.8458 --- loss: 0.846482, loss_ss: 0.819072, loss_d: 0.027410
0.8843 --- loss: 1.089359, loss_ss: 0.937699, loss_d: 0.151660
0.9227 --- loss: 0.886923, loss_ss: 0.871183, loss_d: 0.015739
0.9612 --- loss: 0.860552, loss_ss: 0.811267, loss_d: 0.049286
0.9996 --- loss: 3.271070, loss_ss: 3.269399, loss_d: 0.001671
Epoch finished! Loss: 0.9853617958151377
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.747360, loss_ss: 0.643364, loss_d: 0.103996
0.0384 --- loss: 0.794460, loss_ss: 0.699343, loss_d: 0.095117
0.0769 --- loss: 1.652826, loss_ss: 1.435543, loss_d: 0.217284
0.1153 --- loss: 1.174072, loss_ss: 1.148626, loss_d: 0.025446
0.1538 --- loss: 0.813246, loss_ss: 0.788520, loss_d: 0.024726
0.1922 --- loss: 0.799061, loss_ss: 0.740456, loss_d: 0.058605
0.2307 --- loss: 0.836586, loss_ss: 0.753022, loss_d: 0.083563
0.2691 --- loss: 1.065146, loss_ss: 0.562700, loss_d: 0.502446
0.3076 --- loss: 0.856737, loss_ss: 0.829336, loss_d: 0.027401
0.3460 --- loss: 0.954254, loss_ss: 0.882733, loss_d: 0.071521
0.3845 --- loss: 1.195021, loss_ss: 0.940626, loss_d: 0.254395
0.4229 --- loss: 0.702963, loss_ss: 0.653244, loss_d: 0.049719
0.4614 --- loss: 0.746801, loss_ss: 0.729285, loss_d: 0.017516
0.4998 --- loss: 1.238337, loss_ss: 0.952385, loss_d: 0.285951
0.5383 --- loss: 1.103395, loss_ss: 1.057597, loss_d: 0.045798
0.5767 --- loss: 0.751984, loss_ss: 0.673919, loss_d: 0.078065
0.6151 --- loss: 1.143233, loss_ss: 0.958894, loss_d: 0.184339
0.6536 --- loss: 0.813583, loss_ss: 0.738285, loss_d: 0.075298
0.6920 --- loss: 0.757212, loss_ss: 0.732819, loss_d: 0.024393
0.7305 --- loss: 1.160337, loss_ss: 0.982173, loss_d: 0.178163
0.7689 --- loss: 0.765269, loss_ss: 0.728022, loss_d: 0.037247
0.8074 --- loss: 1.012340, loss_ss: 0.916774, loss_d: 0.095566
0.8458 --- loss: 1.043815, loss_ss: 1.037524, loss_d: 0.006291
0.8843 --- loss: 1.111427, loss_ss: 0.806081, loss_d: 0.305345
0.9227 --- loss: 0.787484, loss_ss: 0.746144, loss_d: 0.041340
0.9612 --- loss: 0.774936, loss_ss: 0.748338, loss_d: 0.026598
0.9996 --- loss: 2.088414, loss_ss: 2.084107, loss_d: 0.004307
Epoch finished! Loss: 0.9635714318889838
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7801801801801802
             precision    recall  f1-score   support

        0.0       0.32      0.47      0.38        51
        1.0       0.19      0.21      0.20        48
        2.0       0.76      0.83      0.79       309
        3.0       0.94      0.82      0.88       229
        4.0       0.87      0.82      0.85       473

avg / total       0.80      0.78      0.79      1110
 


====== chp031-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.88  47.06   95.09  31.58     37.80
1  92.79  20.83   96.05  19.23     20.00
2  88.02  82.52   90.14  76.35     79.32
3  95.23  81.66   98.75  94.44     87.59
4  87.12  82.45   90.58  86.67     84.51
Total accuracy: 78.02%
Average sen: 62.91%
Average spec: 94.12%
Macro f1-score: 61.84%
Diagnosis acc on 15mins: 1.0
[0.99664152 0.93144286 0.96335477 0.99245727 0.92967469 0.8882907
 0.89289522 0.9736622  0.94900131 0.98680425 0.9617002  0.9382481
 0.97030747 0.97060734 0.57890475 0.90621889 0.9877038  0.96417987
 0.90372765 0.97386259 0.98544669 0.95590276 0.96004874 0.93104362
 0.96575725 0.96762484 0.98022288 0.98879749 0.99059874 0.95571065
 0.95392048 0.99567068 0.97671849 0.944637   0.97487551 0.91668165
 0.94186062]
pred: 0.9471676623499071, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.531446, loss_ss: 1.821511, loss_d: 0.709936
0.0384 --- loss: 2.655788, loss_ss: 1.662136, loss_d: 0.993652
0.0768 --- loss: 2.269533, loss_ss: 1.610323, loss_d: 0.659210
0.1153 --- loss: 2.262073, loss_ss: 1.635985, loss_d: 0.626088
0.1537 --- loss: 2.328240, loss_ss: 1.712415, loss_d: 0.615825
0.1921 --- loss: 2.102800, loss_ss: 1.612320, loss_d: 0.490480
0.2305 --- loss: 2.258492, loss_ss: 1.624127, loss_d: 0.634365
0.2689 --- loss: 1.989240, loss_ss: 1.517018, loss_d: 0.472222
0.3073 --- loss: 2.225564, loss_ss: 1.441511, loss_d: 0.784053
0.3458 --- loss: 1.931680, loss_ss: 1.521945, loss_d: 0.409735
0.3842 --- loss: 1.920323, loss_ss: 1.465079, loss_d: 0.455244
0.4226 --- loss: 2.174973, loss_ss: 1.574661, loss_d: 0.600311
0.4610 --- loss: 2.116863, loss_ss: 1.548843, loss_d: 0.568020
0.4994 --- loss: 2.051908, loss_ss: 1.434657, loss_d: 0.617251
0.5378 --- loss: 1.773652, loss_ss: 1.430514, loss_d: 0.343139
0.5763 --- loss: 2.043252, loss_ss: 1.506593, loss_d: 0.536659
0.6147 --- loss: 2.278453, loss_ss: 1.406569, loss_d: 0.871884
0.6531 --- loss: 2.600821, loss_ss: 1.563994, loss_d: 1.036827
0.6915 --- loss: 1.758793, loss_ss: 1.432442, loss_d: 0.326352
0.7299 --- loss: 1.839482, loss_ss: 1.382033, loss_d: 0.457449
0.7683 --- loss: 2.094231, loss_ss: 1.432841, loss_d: 0.661390
0.8068 --- loss: 1.822431, loss_ss: 1.413930, loss_d: 0.408501
0.8452 --- loss: 1.832082, loss_ss: 1.310266, loss_d: 0.521816
0.8836 --- loss: 1.582631, loss_ss: 1.204454, loss_d: 0.378177
0.9220 --- loss: 1.711609, loss_ss: 1.349457, loss_d: 0.362152
0.9604 --- loss: 1.819850, loss_ss: 1.406176, loss_d: 0.413674
0.9988 --- loss: 1.596994, loss_ss: 1.433408, loss_d: 0.163585
Epoch finished! Loss: 2.05588227051955
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.905867, loss_ss: 1.374327, loss_d: 0.531540
0.0384 --- loss: 1.565445, loss_ss: 1.264023, loss_d: 0.301422
0.0768 --- loss: 1.583667, loss_ss: 1.278014, loss_d: 0.305653
0.1153 --- loss: 1.430532, loss_ss: 1.292394, loss_d: 0.138137
0.1537 --- loss: 1.749843, loss_ss: 1.324078, loss_d: 0.425764
0.1921 --- loss: 2.185914, loss_ss: 1.324436, loss_d: 0.861477
0.2305 --- loss: 1.816496, loss_ss: 1.357009, loss_d: 0.459488
0.2689 --- loss: 1.612268, loss_ss: 1.243885, loss_d: 0.368383
0.3073 --- loss: 1.712053, loss_ss: 1.103773, loss_d: 0.608280
0.3458 --- loss: 1.301198, loss_ss: 1.162697, loss_d: 0.138500
0.3842 --- loss: 1.618160, loss_ss: 1.140663, loss_d: 0.477498
0.4226 --- loss: 1.389075, loss_ss: 1.122515, loss_d: 0.266559
0.4610 --- loss: 1.302312, loss_ss: 1.111935, loss_d: 0.190376
0.4994 --- loss: 1.519997, loss_ss: 1.186337, loss_d: 0.333660
0.5378 --- loss: 1.527008, loss_ss: 1.210333, loss_d: 0.316675
0.5763 --- loss: 1.568554, loss_ss: 1.255037, loss_d: 0.313517
0.6147 --- loss: 1.197759, loss_ss: 1.094520, loss_d: 0.103238
0.6531 --- loss: 1.535268, loss_ss: 1.268172, loss_d: 0.267096
0.6915 --- loss: 1.496087, loss_ss: 1.259703, loss_d: 0.236384
0.7299 --- loss: 1.294135, loss_ss: 1.091448, loss_d: 0.202688
0.7683 --- loss: 1.348875, loss_ss: 1.078507, loss_d: 0.270368
0.8068 --- loss: 1.199569, loss_ss: 0.955932, loss_d: 0.243637
0.8452 --- loss: 1.121129, loss_ss: 0.904919, loss_d: 0.216210
0.8836 --- loss: 1.766250, loss_ss: 1.108419, loss_d: 0.657830
0.9220 --- loss: 1.242183, loss_ss: 1.010432, loss_d: 0.231751
0.9604 --- loss: 1.280837, loss_ss: 0.903128, loss_d: 0.377710
0.9988 --- loss: 1.330023, loss_ss: 1.265808, loss_d: 0.064215
Epoch finished! Loss: 1.529449358353248
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 0.989530, loss_ss: 0.882656, loss_d: 0.106874
0.0384 --- loss: 1.146293, loss_ss: 1.078583, loss_d: 0.067710
0.0768 --- loss: 1.385928, loss_ss: 1.046273, loss_d: 0.339655
0.1153 --- loss: 1.141618, loss_ss: 1.045877, loss_d: 0.095741
0.1537 --- loss: 2.000069, loss_ss: 0.907792, loss_d: 1.092277
0.1921 --- loss: 1.270930, loss_ss: 0.981139, loss_d: 0.289791
0.2305 --- loss: 1.127041, loss_ss: 1.002590, loss_d: 0.124450
0.2689 --- loss: 1.620015, loss_ss: 1.152335, loss_d: 0.467680
0.3073 --- loss: 1.738347, loss_ss: 1.318214, loss_d: 0.420133
0.3458 --- loss: 1.284619, loss_ss: 0.941843, loss_d: 0.342776
0.3842 --- loss: 0.956050, loss_ss: 0.742581, loss_d: 0.213469
0.4226 --- loss: 1.155220, loss_ss: 1.062059, loss_d: 0.093161
0.4610 --- loss: 1.142619, loss_ss: 1.050469, loss_d: 0.092150
0.4994 --- loss: 2.096133, loss_ss: 1.471851, loss_d: 0.624282
0.5378 --- loss: 1.108663, loss_ss: 1.020972, loss_d: 0.087691
0.5763 --- loss: 1.159571, loss_ss: 1.114154, loss_d: 0.045417
0.6147 --- loss: 1.371871, loss_ss: 0.900847, loss_d: 0.471024
0.6531 --- loss: 1.480475, loss_ss: 1.062260, loss_d: 0.418215
0.6915 --- loss: 1.391722, loss_ss: 1.038542, loss_d: 0.353180
0.7299 --- loss: 1.119667, loss_ss: 0.876486, loss_d: 0.243181
0.7683 --- loss: 1.142661, loss_ss: 1.042826, loss_d: 0.099835
0.8068 --- loss: 0.932938, loss_ss: 0.716468, loss_d: 0.216470
0.8452 --- loss: 1.547712, loss_ss: 0.902847, loss_d: 0.644865
0.8836 --- loss: 1.175459, loss_ss: 1.036717, loss_d: 0.138742
0.9220 --- loss: 0.948036, loss_ss: 0.817139, loss_d: 0.130897
0.9604 --- loss: 1.464823, loss_ss: 1.041819, loss_d: 0.423004
0.9988 --- loss: 2.322724, loss_ss: 1.289103, loss_d: 1.033621
Epoch finished! Loss: 1.3294548124074936
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.264737, loss_ss: 0.798419, loss_d: 0.466318
0.0384 --- loss: 1.443471, loss_ss: 1.168039, loss_d: 0.275432
0.0768 --- loss: 1.414901, loss_ss: 1.091622, loss_d: 0.323279
0.1153 --- loss: 1.232683, loss_ss: 1.047261, loss_d: 0.185422
0.1537 --- loss: 1.126174, loss_ss: 0.965779, loss_d: 0.160395
0.1921 --- loss: 1.279472, loss_ss: 0.995178, loss_d: 0.284293
0.2305 --- loss: 1.217162, loss_ss: 0.742957, loss_d: 0.474204
0.2689 --- loss: 1.313234, loss_ss: 0.779997, loss_d: 0.533238
0.3073 --- loss: 1.168496, loss_ss: 0.896799, loss_d: 0.271696
0.3458 --- loss: 1.266990, loss_ss: 1.165272, loss_d: 0.101718
0.3842 --- loss: 2.443289, loss_ss: 0.786045, loss_d: 1.657244
0.4226 --- loss: 1.069568, loss_ss: 0.912352, loss_d: 0.157216
0.4610 --- loss: 1.143192, loss_ss: 0.878077, loss_d: 0.265115
0.4994 --- loss: 1.156060, loss_ss: 0.770865, loss_d: 0.385195
0.5378 --- loss: 1.204370, loss_ss: 1.148607, loss_d: 0.055763
0.5763 --- loss: 1.231091, loss_ss: 0.830904, loss_d: 0.400187
0.6147 --- loss: 1.136925, loss_ss: 0.909135, loss_d: 0.227789
0.6531 --- loss: 1.493355, loss_ss: 0.844818, loss_d: 0.648537
0.6915 --- loss: 1.114376, loss_ss: 0.895211, loss_d: 0.219164
0.7299 --- loss: 1.083635, loss_ss: 1.013774, loss_d: 0.069861
0.7683 --- loss: 1.372176, loss_ss: 0.842647, loss_d: 0.529529
0.8068 --- loss: 1.344488, loss_ss: 1.233303, loss_d: 0.111185
0.8452 --- loss: 0.955996, loss_ss: 0.835793, loss_d: 0.120203
0.8836 --- loss: 1.107960, loss_ss: 0.878752, loss_d: 0.229208
0.9220 --- loss: 0.701027, loss_ss: 0.625983, loss_d: 0.075045
0.9604 --- loss: 0.874078, loss_ss: 0.721058, loss_d: 0.153020
0.9988 --- loss: 1.161993, loss_ss: 1.118694, loss_d: 0.043300
Epoch finished! Loss: 1.250104368191499
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.162175, loss_ss: 0.812788, loss_d: 0.349387
0.0384 --- loss: 1.062081, loss_ss: 0.894160, loss_d: 0.167921
0.0768 --- loss: 0.940737, loss_ss: 0.832827, loss_d: 0.107910
0.1153 --- loss: 0.916457, loss_ss: 0.807329, loss_d: 0.109128
0.1537 --- loss: 1.076930, loss_ss: 0.918701, loss_d: 0.158229
0.1921 --- loss: 1.308928, loss_ss: 0.943980, loss_d: 0.364948
0.2305 --- loss: 0.903571, loss_ss: 0.625862, loss_d: 0.277709
0.2689 --- loss: 1.086333, loss_ss: 0.960371, loss_d: 0.125962
0.3073 --- loss: 1.135731, loss_ss: 0.917670, loss_d: 0.218061
0.3458 --- loss: 1.151233, loss_ss: 0.939072, loss_d: 0.212161
0.3842 --- loss: 0.843657, loss_ss: 0.739838, loss_d: 0.103819
0.4226 --- loss: 1.490271, loss_ss: 0.829752, loss_d: 0.660518
0.4610 --- loss: 1.430074, loss_ss: 0.767407, loss_d: 0.662667
0.4994 --- loss: 1.190729, loss_ss: 0.800926, loss_d: 0.389803
0.5378 --- loss: 1.132455, loss_ss: 0.968464, loss_d: 0.163991
0.5763 --- loss: 1.033283, loss_ss: 0.839595, loss_d: 0.193689
0.6147 --- loss: 0.752817, loss_ss: 0.706194, loss_d: 0.046623
0.6531 --- loss: 1.122048, loss_ss: 1.024440, loss_d: 0.097608
0.6915 --- loss: 1.326754, loss_ss: 0.614028, loss_d: 0.712726
0.7299 --- loss: 0.964755, loss_ss: 0.813750, loss_d: 0.151005
0.7683 --- loss: 1.120489, loss_ss: 1.009803, loss_d: 0.110686
0.8068 --- loss: 0.991908, loss_ss: 0.864548, loss_d: 0.127361
0.8452 --- loss: 1.108497, loss_ss: 1.040766, loss_d: 0.067731
0.8836 --- loss: 1.102719, loss_ss: 0.771507, loss_d: 0.331212
0.9220 --- loss: 0.832289, loss_ss: 0.736539, loss_d: 0.095750
0.9604 --- loss: 1.075338, loss_ss: 1.026564, loss_d: 0.048774
0.9988 --- loss: 3.636032, loss_ss: 1.853217, loss_d: 1.782815
Epoch finished! Loss: 1.1457876888605265
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.818496, loss_ss: 0.682616, loss_d: 0.135880
0.0384 --- loss: 1.048939, loss_ss: 0.946975, loss_d: 0.101964
0.0768 --- loss: 1.151494, loss_ss: 0.917392, loss_d: 0.234102
0.1153 --- loss: 1.232617, loss_ss: 1.032001, loss_d: 0.200615
0.1537 --- loss: 1.250651, loss_ss: 0.957557, loss_d: 0.293094
0.1921 --- loss: 0.853868, loss_ss: 0.815023, loss_d: 0.038845
0.2305 --- loss: 1.569848, loss_ss: 1.272292, loss_d: 0.297557
0.2689 --- loss: 1.548992, loss_ss: 1.234150, loss_d: 0.314842
0.3073 --- loss: 1.393523, loss_ss: 0.923510, loss_d: 0.470012
0.3458 --- loss: 1.228427, loss_ss: 1.136720, loss_d: 0.091707
0.3842 --- loss: 1.427290, loss_ss: 1.035008, loss_d: 0.392282
0.4226 --- loss: 0.892490, loss_ss: 0.756377, loss_d: 0.136113
0.4610 --- loss: 1.057137, loss_ss: 0.913461, loss_d: 0.143676
0.4994 --- loss: 1.146598, loss_ss: 0.744417, loss_d: 0.402180
0.5378 --- loss: 0.781690, loss_ss: 0.744403, loss_d: 0.037287
0.5763 --- loss: 1.377931, loss_ss: 0.632377, loss_d: 0.745554
0.6147 --- loss: 0.968711, loss_ss: 0.875618, loss_d: 0.093093
0.6531 --- loss: 0.963761, loss_ss: 0.920351, loss_d: 0.043410
0.6915 --- loss: 1.050297, loss_ss: 0.845594, loss_d: 0.204703
0.7299 --- loss: 1.627178, loss_ss: 1.384089, loss_d: 0.243088
0.7683 --- loss: 1.469737, loss_ss: 1.023574, loss_d: 0.446162
0.8068 --- loss: 0.964482, loss_ss: 0.762253, loss_d: 0.202229
0.8452 --- loss: 1.056198, loss_ss: 0.773874, loss_d: 0.282324
0.8836 --- loss: 1.441338, loss_ss: 0.684575, loss_d: 0.756763
0.9220 --- loss: 0.816785, loss_ss: 0.748077, loss_d: 0.068708
0.9604 --- loss: 1.015219, loss_ss: 0.820598, loss_d: 0.194621
0.9988 --- loss: 2.328979, loss_ss: 1.019474, loss_d: 1.309505
Epoch finished! Loss: 1.0910051996891315
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.931915, loss_ss: 0.829314, loss_d: 0.102601
0.0384 --- loss: 0.955327, loss_ss: 0.814620, loss_d: 0.140707
0.0768 --- loss: 1.195309, loss_ss: 0.941467, loss_d: 0.253842
0.1153 --- loss: 1.173201, loss_ss: 1.109601, loss_d: 0.063600
0.1537 --- loss: 1.163843, loss_ss: 1.076831, loss_d: 0.087012
0.1921 --- loss: 1.037659, loss_ss: 0.852324, loss_d: 0.185335
0.2305 --- loss: 0.994046, loss_ss: 0.966909, loss_d: 0.027136
0.2689 --- loss: 1.094434, loss_ss: 0.863699, loss_d: 0.230735
0.3073 --- loss: 0.838913, loss_ss: 0.797222, loss_d: 0.041691
0.3458 --- loss: 1.158426, loss_ss: 0.567658, loss_d: 0.590768
0.3842 --- loss: 0.947660, loss_ss: 0.593905, loss_d: 0.353755
0.4226 --- loss: 0.944733, loss_ss: 0.900439, loss_d: 0.044294
0.4610 --- loss: 0.882925, loss_ss: 0.714801, loss_d: 0.168124
0.4994 --- loss: 1.784818, loss_ss: 1.291199, loss_d: 0.493619
0.5378 --- loss: 1.294458, loss_ss: 0.923989, loss_d: 0.370469
0.5763 --- loss: 1.145061, loss_ss: 0.927023, loss_d: 0.218039
0.6147 --- loss: 0.877267, loss_ss: 0.767082, loss_d: 0.110185
0.6531 --- loss: 0.802784, loss_ss: 0.734682, loss_d: 0.068102
0.6915 --- loss: 0.889507, loss_ss: 0.775380, loss_d: 0.114127
0.7299 --- loss: 1.105413, loss_ss: 0.751666, loss_d: 0.353747
0.7683 --- loss: 1.353758, loss_ss: 1.208591, loss_d: 0.145167
0.8068 --- loss: 1.470704, loss_ss: 1.046157, loss_d: 0.424546
0.8452 --- loss: 0.810415, loss_ss: 0.708457, loss_d: 0.101958
0.8836 --- loss: 1.027844, loss_ss: 0.903955, loss_d: 0.123889
0.9220 --- loss: 0.983421, loss_ss: 0.785022, loss_d: 0.198399
0.9604 --- loss: 1.035473, loss_ss: 0.977853, loss_d: 0.057620
0.9988 --- loss: 1.609153, loss_ss: 1.583878, loss_d: 0.025275
Epoch finished! Loss: 1.0401777136784334
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.875970, loss_ss: 0.835317, loss_d: 0.040653
0.0384 --- loss: 0.878528, loss_ss: 0.865096, loss_d: 0.013432
0.0768 --- loss: 1.106952, loss_ss: 0.686971, loss_d: 0.419981
0.1153 --- loss: 0.982864, loss_ss: 0.825392, loss_d: 0.157471
0.1537 --- loss: 1.188262, loss_ss: 0.673636, loss_d: 0.514627
0.1921 --- loss: 0.814467, loss_ss: 0.769094, loss_d: 0.045373
0.2305 --- loss: 1.176855, loss_ss: 0.661270, loss_d: 0.515584
0.2689 --- loss: 1.526836, loss_ss: 0.856849, loss_d: 0.669986
0.3073 --- loss: 0.984047, loss_ss: 0.917857, loss_d: 0.066190
0.3458 --- loss: 0.627819, loss_ss: 0.547275, loss_d: 0.080544
0.3842 --- loss: 1.171125, loss_ss: 1.045431, loss_d: 0.125693
0.4226 --- loss: 0.871968, loss_ss: 0.840321, loss_d: 0.031647
0.4610 --- loss: 0.974814, loss_ss: 0.839948, loss_d: 0.134866
0.4994 --- loss: 0.815065, loss_ss: 0.727811, loss_d: 0.087255
0.5378 --- loss: 1.255080, loss_ss: 0.837898, loss_d: 0.417182
0.5763 --- loss: 1.201204, loss_ss: 1.001722, loss_d: 0.199482
0.6147 --- loss: 0.637785, loss_ss: 0.474246, loss_d: 0.163539
0.6531 --- loss: 0.970757, loss_ss: 0.866569, loss_d: 0.104188
0.6915 --- loss: 1.670219, loss_ss: 0.690276, loss_d: 0.979943
0.7299 --- loss: 0.801306, loss_ss: 0.647415, loss_d: 0.153891
0.7683 --- loss: 1.069503, loss_ss: 0.977637, loss_d: 0.091866
0.8068 --- loss: 1.388353, loss_ss: 0.500374, loss_d: 0.887979
0.8452 --- loss: 0.917529, loss_ss: 0.663099, loss_d: 0.254430
0.8836 --- loss: 0.820731, loss_ss: 0.724531, loss_d: 0.096200
0.9220 --- loss: 1.108141, loss_ss: 0.969539, loss_d: 0.138602
0.9604 --- loss: 0.688326, loss_ss: 0.591497, loss_d: 0.096829
0.9988 --- loss: 1.029312, loss_ss: 0.922179, loss_d: 0.107133
Epoch finished! Loss: 1.004880151611108
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.903962, loss_ss: 0.730880, loss_d: 0.173082
0.0384 --- loss: 1.134720, loss_ss: 0.801166, loss_d: 0.333553
0.0768 --- loss: 1.195552, loss_ss: 1.086860, loss_d: 0.108693
0.1153 --- loss: 0.876756, loss_ss: 0.635520, loss_d: 0.241236
0.1537 --- loss: 0.779769, loss_ss: 0.588063, loss_d: 0.191706
0.1921 --- loss: 1.281362, loss_ss: 0.855647, loss_d: 0.425716
0.2305 --- loss: 1.072022, loss_ss: 0.901803, loss_d: 0.170219
0.2689 --- loss: 1.434179, loss_ss: 1.365908, loss_d: 0.068271
0.3073 --- loss: 1.004449, loss_ss: 0.859214, loss_d: 0.145234
0.3458 --- loss: 1.059137, loss_ss: 1.001490, loss_d: 0.057646
0.3842 --- loss: 0.723015, loss_ss: 0.686703, loss_d: 0.036312
0.4226 --- loss: 0.756964, loss_ss: 0.670935, loss_d: 0.086029
0.4610 --- loss: 0.970016, loss_ss: 0.904525, loss_d: 0.065491
0.4994 --- loss: 1.370705, loss_ss: 1.260066, loss_d: 0.110639
0.5378 --- loss: 1.053352, loss_ss: 0.933558, loss_d: 0.119794
0.5763 --- loss: 0.746356, loss_ss: 0.628562, loss_d: 0.117794
0.6147 --- loss: 0.957550, loss_ss: 0.720438, loss_d: 0.237111
0.6531 --- loss: 0.848588, loss_ss: 0.812019, loss_d: 0.036569
0.6915 --- loss: 1.023754, loss_ss: 0.646997, loss_d: 0.376757
0.7299 --- loss: 0.865507, loss_ss: 0.819482, loss_d: 0.046025
0.7683 --- loss: 0.773055, loss_ss: 0.757770, loss_d: 0.015285
0.8068 --- loss: 0.976246, loss_ss: 0.947622, loss_d: 0.028624
0.8452 --- loss: 0.956124, loss_ss: 0.821992, loss_d: 0.134132
0.8836 --- loss: 1.106151, loss_ss: 0.968023, loss_d: 0.138127
0.9220 --- loss: 0.969528, loss_ss: 0.895817, loss_d: 0.073711
0.9604 --- loss: 1.217423, loss_ss: 0.925095, loss_d: 0.292328
0.9988 --- loss: 1.681909, loss_ss: 1.543405, loss_d: 0.138504
Epoch finished! Loss: 0.9818613054660651
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.585875, loss_ss: 0.566107, loss_d: 0.019768
0.0384 --- loss: 0.791453, loss_ss: 0.679968, loss_d: 0.111485
0.0768 --- loss: 1.753132, loss_ss: 0.979353, loss_d: 0.773779
0.1153 --- loss: 1.047098, loss_ss: 1.029732, loss_d: 0.017367
0.1537 --- loss: 1.150049, loss_ss: 1.036198, loss_d: 0.113851
0.1921 --- loss: 0.932609, loss_ss: 0.897172, loss_d: 0.035437
0.2305 --- loss: 0.884318, loss_ss: 0.815358, loss_d: 0.068960
0.2689 --- loss: 0.581663, loss_ss: 0.554701, loss_d: 0.026962
0.3073 --- loss: 1.287349, loss_ss: 1.091546, loss_d: 0.195803
0.3458 --- loss: 0.573463, loss_ss: 0.490458, loss_d: 0.083006
0.3842 --- loss: 1.300333, loss_ss: 1.280647, loss_d: 0.019686
0.4226 --- loss: 0.831640, loss_ss: 0.803739, loss_d: 0.027902
0.4610 --- loss: 0.933262, loss_ss: 0.875138, loss_d: 0.058124
0.4994 --- loss: 1.141717, loss_ss: 0.616723, loss_d: 0.524994
0.5378 --- loss: 0.636885, loss_ss: 0.560398, loss_d: 0.076487
0.5763 --- loss: 0.783290, loss_ss: 0.740965, loss_d: 0.042325
0.6147 --- loss: 0.787488, loss_ss: 0.723101, loss_d: 0.064387
0.6531 --- loss: 2.117923, loss_ss: 1.036735, loss_d: 1.081188
0.6915 --- loss: 0.887936, loss_ss: 0.604864, loss_d: 0.283072
0.7299 --- loss: 0.810872, loss_ss: 0.759500, loss_d: 0.051372
0.7683 --- loss: 1.101120, loss_ss: 0.810853, loss_d: 0.290268
0.8068 --- loss: 0.688391, loss_ss: 0.573823, loss_d: 0.114568
0.8452 --- loss: 1.033041, loss_ss: 0.904202, loss_d: 0.128838
0.8836 --- loss: 1.009998, loss_ss: 0.829899, loss_d: 0.180099
0.9220 --- loss: 0.994095, loss_ss: 0.967676, loss_d: 0.026418
0.9604 --- loss: 0.960889, loss_ss: 0.745821, loss_d: 0.215068
0.9988 --- loss: 1.007455, loss_ss: 0.976330, loss_d: 0.031125
Epoch finished! Loss: 0.9868290183635858
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7219047619047619
             precision    recall  f1-score   support

        0.0       0.74      0.83      0.78        47
        1.0       0.00      0.00      0.00       108
        2.0       0.89      0.76      0.82       516
        3.0       1.00      0.71      0.83       150
        4.0       0.50      0.97      0.66       229

avg / total       0.72      0.72      0.70      1050
 


====== chp032-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  97.90  82.98   98.60   73.58     78.00
1  88.67   0.00   98.83    0.00      0.00
2  83.43  75.58   91.01   89.04     81.76
3  95.90  71.33  100.00  100.00     83.27
4  78.48  96.94   73.33   50.34     66.27
Total accuracy: 72.19%
Average sen: 65.37%
Average spec: 92.35%
Macro f1-score: 61.86%
Diagnosis acc on 15mins: 0.7142857142857143
[0.99029946 0.97666091 0.03058032 0.44938642 0.19745727 0.16813885
 0.23907271 0.67296684 0.99611473 0.88640875 0.40391615 0.27560326
 0.21901327 0.71786296 0.57807273 0.10834944 0.57314736 0.43219423
 0.97438508 0.99178493 0.99035078 0.98389012 0.99743205 0.94474298
 0.76037323 0.82078809 0.76293433 0.55736858 0.99412835 0.98791039
 0.99916697 0.98660696 0.99100024 0.98989797 0.88632137]
pred: 0.7009808014013937, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.113953, loss_ss: 1.431220, loss_d: 0.682732
0.0384 --- loss: 2.433197, loss_ss: 1.576720, loss_d: 0.856476
0.0768 --- loss: 1.862949, loss_ss: 1.267076, loss_d: 0.595873
0.1152 --- loss: 2.041455, loss_ss: 1.436907, loss_d: 0.604548
0.1536 --- loss: 2.203132, loss_ss: 1.510253, loss_d: 0.692879
0.1919 --- loss: 1.883341, loss_ss: 1.434401, loss_d: 0.448940
0.2303 --- loss: 1.948856, loss_ss: 1.501381, loss_d: 0.447475
0.2687 --- loss: 2.156516, loss_ss: 1.322005, loss_d: 0.834511
0.3071 --- loss: 1.862175, loss_ss: 1.296922, loss_d: 0.565253
0.3455 --- loss: 2.037230, loss_ss: 1.298895, loss_d: 0.738336
0.3839 --- loss: 1.949350, loss_ss: 1.305417, loss_d: 0.643933
0.4223 --- loss: 1.838706, loss_ss: 1.272940, loss_d: 0.565767
0.4607 --- loss: 1.689245, loss_ss: 1.333827, loss_d: 0.355418
0.4990 --- loss: 1.674428, loss_ss: 1.230762, loss_d: 0.443666
0.5374 --- loss: 1.976914, loss_ss: 1.249838, loss_d: 0.727076
0.5758 --- loss: 2.330920, loss_ss: 1.519860, loss_d: 0.811060
0.6142 --- loss: 1.828351, loss_ss: 1.325487, loss_d: 0.502864
0.6526 --- loss: 1.559145, loss_ss: 1.144855, loss_d: 0.414290
0.6910 --- loss: 1.708688, loss_ss: 1.254840, loss_d: 0.453848
0.7294 --- loss: 1.784652, loss_ss: 1.119960, loss_d: 0.664692
0.7678 --- loss: 2.217012, loss_ss: 1.360718, loss_d: 0.856294
0.8061 --- loss: 1.637332, loss_ss: 1.120918, loss_d: 0.516414
0.8445 --- loss: 1.645999, loss_ss: 1.142950, loss_d: 0.503049
0.8829 --- loss: 1.797221, loss_ss: 1.163542, loss_d: 0.633679
0.9213 --- loss: 1.668979, loss_ss: 1.183613, loss_d: 0.485366
0.9597 --- loss: 1.601974, loss_ss: 1.323250, loss_d: 0.278723
0.9981 --- loss: 2.029781, loss_ss: 1.202737, loss_d: 0.827044
Epoch finished! Loss: 1.870398538846236
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.704507, loss_ss: 1.329109, loss_d: 0.375398
0.0384 --- loss: 1.517078, loss_ss: 1.289526, loss_d: 0.227552
0.0768 --- loss: 1.777155, loss_ss: 1.284164, loss_d: 0.492991
0.1152 --- loss: 1.543135, loss_ss: 1.141411, loss_d: 0.401724
0.1536 --- loss: 1.516685, loss_ss: 1.303806, loss_d: 0.212878
0.1919 --- loss: 1.582404, loss_ss: 1.307388, loss_d: 0.275015
0.2303 --- loss: 1.446052, loss_ss: 1.228213, loss_d: 0.217838
0.2687 --- loss: 1.608175, loss_ss: 1.159371, loss_d: 0.448804
0.3071 --- loss: 1.268133, loss_ss: 1.068881, loss_d: 0.199251
0.3455 --- loss: 1.295961, loss_ss: 0.973234, loss_d: 0.322727
0.3839 --- loss: 1.204408, loss_ss: 1.070246, loss_d: 0.134162
0.4223 --- loss: 1.410417, loss_ss: 1.290175, loss_d: 0.120242
0.4607 --- loss: 1.677167, loss_ss: 0.957571, loss_d: 0.719596
0.4990 --- loss: 1.346446, loss_ss: 1.216570, loss_d: 0.129876
0.5374 --- loss: 1.629302, loss_ss: 1.410634, loss_d: 0.218668
0.5758 --- loss: 1.405768, loss_ss: 0.963541, loss_d: 0.442226
0.6142 --- loss: 1.530322, loss_ss: 1.311579, loss_d: 0.218743
0.6526 --- loss: 1.416543, loss_ss: 1.111216, loss_d: 0.305327
0.6910 --- loss: 1.253413, loss_ss: 1.033896, loss_d: 0.219517
0.7294 --- loss: 1.400973, loss_ss: 0.964068, loss_d: 0.436905
0.7678 --- loss: 1.820367, loss_ss: 1.144729, loss_d: 0.675639
0.8061 --- loss: 1.371496, loss_ss: 1.156249, loss_d: 0.215247
0.8445 --- loss: 1.502399, loss_ss: 1.197227, loss_d: 0.305172
0.8829 --- loss: 1.526976, loss_ss: 1.169958, loss_d: 0.357018
0.9213 --- loss: 1.725581, loss_ss: 1.240321, loss_d: 0.485260
0.9597 --- loss: 1.217082, loss_ss: 1.043894, loss_d: 0.173188
0.9981 --- loss: 2.464997, loss_ss: 1.183921, loss_d: 1.281077
Epoch finished! Loss: 1.5112546641093034
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.168548, loss_ss: 0.906120, loss_d: 0.262428
0.0384 --- loss: 1.381359, loss_ss: 1.121251, loss_d: 0.260109
0.0768 --- loss: 1.839625, loss_ss: 1.225036, loss_d: 0.614589
0.1152 --- loss: 1.785006, loss_ss: 0.990225, loss_d: 0.794780
0.1536 --- loss: 1.247393, loss_ss: 1.130683, loss_d: 0.116710
0.1919 --- loss: 1.109305, loss_ss: 0.885284, loss_d: 0.224021
0.2303 --- loss: 1.242163, loss_ss: 1.040127, loss_d: 0.202036
0.2687 --- loss: 1.119656, loss_ss: 1.031471, loss_d: 0.088186
0.3071 --- loss: 1.270682, loss_ss: 1.033942, loss_d: 0.236740
0.3455 --- loss: 1.287326, loss_ss: 1.037659, loss_d: 0.249666
0.3839 --- loss: 1.166690, loss_ss: 1.026787, loss_d: 0.139903
0.4223 --- loss: 1.203126, loss_ss: 1.029116, loss_d: 0.174009
0.4607 --- loss: 1.399065, loss_ss: 1.126873, loss_d: 0.272191
0.4990 --- loss: 1.087313, loss_ss: 0.999914, loss_d: 0.087400
0.5374 --- loss: 1.166877, loss_ss: 1.079148, loss_d: 0.087729
0.5758 --- loss: 1.649933, loss_ss: 1.319958, loss_d: 0.329975
0.6142 --- loss: 1.230816, loss_ss: 1.104776, loss_d: 0.126040
0.6526 --- loss: 1.380200, loss_ss: 0.815004, loss_d: 0.565197
0.6910 --- loss: 1.303216, loss_ss: 0.903967, loss_d: 0.399249
0.7294 --- loss: 1.169144, loss_ss: 1.000342, loss_d: 0.168802
0.7678 --- loss: 1.553903, loss_ss: 1.206533, loss_d: 0.347370
0.8061 --- loss: 1.915850, loss_ss: 1.030949, loss_d: 0.884901
0.8445 --- loss: 1.486008, loss_ss: 0.964176, loss_d: 0.521833
0.8829 --- loss: 1.276750, loss_ss: 1.038599, loss_d: 0.238151
0.9213 --- loss: 1.065516, loss_ss: 0.917147, loss_d: 0.148369
0.9597 --- loss: 1.188678, loss_ss: 0.790550, loss_d: 0.398128
0.9981 --- loss: 2.678272, loss_ss: 1.035418, loss_d: 1.642854
Epoch finished! Loss: 1.3234388663218573
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.416437, loss_ss: 1.002474, loss_d: 0.413963
0.0384 --- loss: 1.163155, loss_ss: 0.853540, loss_d: 0.309615
0.0768 --- loss: 0.930013, loss_ss: 0.813854, loss_d: 0.116159
0.1152 --- loss: 1.460104, loss_ss: 1.025210, loss_d: 0.434894
0.1536 --- loss: 1.147689, loss_ss: 0.828127, loss_d: 0.319562
0.1919 --- loss: 1.407755, loss_ss: 1.075460, loss_d: 0.332294
0.2303 --- loss: 1.097247, loss_ss: 0.980872, loss_d: 0.116374
0.2687 --- loss: 1.156408, loss_ss: 1.005845, loss_d: 0.150563
0.3071 --- loss: 1.135192, loss_ss: 1.010522, loss_d: 0.124670
0.3455 --- loss: 1.023055, loss_ss: 0.947936, loss_d: 0.075119
0.3839 --- loss: 1.041445, loss_ss: 0.961580, loss_d: 0.079864
0.4223 --- loss: 1.059108, loss_ss: 0.751089, loss_d: 0.308019
0.4607 --- loss: 1.213974, loss_ss: 0.847061, loss_d: 0.366913
0.4990 --- loss: 1.349525, loss_ss: 1.253758, loss_d: 0.095767
0.5374 --- loss: 1.137522, loss_ss: 1.019533, loss_d: 0.117989
0.5758 --- loss: 0.867698, loss_ss: 0.722292, loss_d: 0.145406
0.6142 --- loss: 0.985691, loss_ss: 0.934538, loss_d: 0.051153
0.6526 --- loss: 0.901207, loss_ss: 0.856680, loss_d: 0.044527
0.6910 --- loss: 1.007034, loss_ss: 0.937781, loss_d: 0.069253
0.7294 --- loss: 1.077481, loss_ss: 0.812295, loss_d: 0.265185
0.7678 --- loss: 1.595588, loss_ss: 1.014670, loss_d: 0.580918
0.8061 --- loss: 1.301437, loss_ss: 0.733911, loss_d: 0.567526
0.8445 --- loss: 1.657715, loss_ss: 1.135888, loss_d: 0.521827
0.8829 --- loss: 0.961547, loss_ss: 0.786796, loss_d: 0.174751
0.9213 --- loss: 1.084954, loss_ss: 0.966926, loss_d: 0.118028
0.9597 --- loss: 1.314224, loss_ss: 0.999306, loss_d: 0.314917
0.9981 --- loss: 0.972711, loss_ss: 0.943417, loss_d: 0.029294
Epoch finished! Loss: 1.2297579540656163
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.149626, loss_ss: 1.108856, loss_d: 0.040770
0.0384 --- loss: 1.387696, loss_ss: 0.867363, loss_d: 0.520332
0.0768 --- loss: 1.253629, loss_ss: 0.817179, loss_d: 0.436450
0.1152 --- loss: 1.336579, loss_ss: 0.932573, loss_d: 0.404006
0.1536 --- loss: 1.066241, loss_ss: 0.608930, loss_d: 0.457311
0.1919 --- loss: 1.274548, loss_ss: 1.105045, loss_d: 0.169503
0.2303 --- loss: 1.471422, loss_ss: 1.300351, loss_d: 0.171071
0.2687 --- loss: 1.283439, loss_ss: 1.067194, loss_d: 0.216244
0.3071 --- loss: 1.121645, loss_ss: 0.981891, loss_d: 0.139754
0.3455 --- loss: 1.268779, loss_ss: 0.974986, loss_d: 0.293792
0.3839 --- loss: 0.987668, loss_ss: 0.933626, loss_d: 0.054042
0.4223 --- loss: 1.186270, loss_ss: 0.840602, loss_d: 0.345668
0.4607 --- loss: 1.069598, loss_ss: 0.752582, loss_d: 0.317016
0.4990 --- loss: 0.909638, loss_ss: 0.783515, loss_d: 0.126123
0.5374 --- loss: 0.928779, loss_ss: 0.816702, loss_d: 0.112077
0.5758 --- loss: 1.197844, loss_ss: 1.017876, loss_d: 0.179968
0.6142 --- loss: 0.897097, loss_ss: 0.878658, loss_d: 0.018439
0.6526 --- loss: 0.917582, loss_ss: 0.739752, loss_d: 0.177830
0.6910 --- loss: 0.992983, loss_ss: 0.835829, loss_d: 0.157154
0.7294 --- loss: 0.983283, loss_ss: 0.911761, loss_d: 0.071521
0.7678 --- loss: 1.289786, loss_ss: 1.105731, loss_d: 0.184055
0.8061 --- loss: 0.760180, loss_ss: 0.623257, loss_d: 0.136923
0.8445 --- loss: 2.015888, loss_ss: 0.978350, loss_d: 1.037538
0.8829 --- loss: 1.189068, loss_ss: 0.786801, loss_d: 0.402267
0.9213 --- loss: 0.844590, loss_ss: 0.697401, loss_d: 0.147189
0.9597 --- loss: 1.335760, loss_ss: 0.812708, loss_d: 0.523051
0.9981 --- loss: 0.856748, loss_ss: 0.775293, loss_d: 0.081455
Epoch finished! Loss: 1.1657899847397437
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.409898, loss_ss: 1.137649, loss_d: 0.272249
0.0384 --- loss: 1.041694, loss_ss: 0.860974, loss_d: 0.180720
0.0768 --- loss: 2.002405, loss_ss: 1.060167, loss_d: 0.942238
0.1152 --- loss: 1.148121, loss_ss: 1.126573, loss_d: 0.021548
0.1536 --- loss: 1.032040, loss_ss: 0.971336, loss_d: 0.060704
0.1919 --- loss: 1.073482, loss_ss: 1.014179, loss_d: 0.059303
0.2303 --- loss: 1.105364, loss_ss: 1.068555, loss_d: 0.036808
0.2687 --- loss: 1.618235, loss_ss: 0.821425, loss_d: 0.796810
0.3071 --- loss: 0.906997, loss_ss: 0.769361, loss_d: 0.137635
0.3455 --- loss: 0.937524, loss_ss: 0.763018, loss_d: 0.174506
0.3839 --- loss: 1.007296, loss_ss: 0.843549, loss_d: 0.163747
0.4223 --- loss: 1.245565, loss_ss: 0.864021, loss_d: 0.381544
0.4607 --- loss: 1.030689, loss_ss: 0.951108, loss_d: 0.079581
0.4990 --- loss: 1.307144, loss_ss: 1.038287, loss_d: 0.268857
0.5374 --- loss: 1.435121, loss_ss: 1.000051, loss_d: 0.435070
0.5758 --- loss: 1.671313, loss_ss: 0.878267, loss_d: 0.793047
0.6142 --- loss: 0.942173, loss_ss: 0.856363, loss_d: 0.085810
0.6526 --- loss: 0.998380, loss_ss: 0.897681, loss_d: 0.100699
0.6910 --- loss: 1.277652, loss_ss: 1.000798, loss_d: 0.276854
0.7294 --- loss: 0.937836, loss_ss: 0.880939, loss_d: 0.056897
0.7678 --- loss: 1.017342, loss_ss: 0.861326, loss_d: 0.156016
0.8061 --- loss: 1.436570, loss_ss: 1.171909, loss_d: 0.264661
0.8445 --- loss: 0.850958, loss_ss: 0.675066, loss_d: 0.175892
0.8829 --- loss: 1.218326, loss_ss: 0.959086, loss_d: 0.259240
0.9213 --- loss: 1.340209, loss_ss: 0.774626, loss_d: 0.565584
0.9597 --- loss: 0.980880, loss_ss: 0.868949, loss_d: 0.111931
0.9981 --- loss: 1.842754, loss_ss: 1.296304, loss_d: 0.546450
Epoch finished! Loss: 1.131044396987328
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.980113, loss_ss: 0.896598, loss_d: 0.083515
0.0384 --- loss: 1.004773, loss_ss: 0.940427, loss_d: 0.064346
0.0768 --- loss: 1.466900, loss_ss: 0.895537, loss_d: 0.571362
0.1152 --- loss: 1.203986, loss_ss: 0.801287, loss_d: 0.402698
0.1536 --- loss: 0.951817, loss_ss: 0.864671, loss_d: 0.087146
0.1919 --- loss: 0.850711, loss_ss: 0.792796, loss_d: 0.057915
0.2303 --- loss: 1.055634, loss_ss: 0.947592, loss_d: 0.108042
0.2687 --- loss: 0.889430, loss_ss: 0.844325, loss_d: 0.045105
0.3071 --- loss: 0.796471, loss_ss: 0.771714, loss_d: 0.024757
0.3455 --- loss: 1.211798, loss_ss: 0.714196, loss_d: 0.497602
0.3839 --- loss: 1.092176, loss_ss: 0.987086, loss_d: 0.105090
0.4223 --- loss: 1.199273, loss_ss: 0.772668, loss_d: 0.426605
0.4607 --- loss: 1.265355, loss_ss: 0.875565, loss_d: 0.389789
0.4990 --- loss: 1.034345, loss_ss: 0.966832, loss_d: 0.067513
0.5374 --- loss: 1.084311, loss_ss: 0.921656, loss_d: 0.162655
0.5758 --- loss: 1.058586, loss_ss: 0.997531, loss_d: 0.061055
0.6142 --- loss: 1.014813, loss_ss: 0.705445, loss_d: 0.309368
0.6526 --- loss: 0.890661, loss_ss: 0.703927, loss_d: 0.186734
0.6910 --- loss: 0.963809, loss_ss: 0.862612, loss_d: 0.101197
0.7294 --- loss: 1.018708, loss_ss: 0.894115, loss_d: 0.124593
0.7678 --- loss: 1.039690, loss_ss: 0.972044, loss_d: 0.067646
0.8061 --- loss: 1.208878, loss_ss: 1.188457, loss_d: 0.020421
0.8445 --- loss: 0.924565, loss_ss: 0.782273, loss_d: 0.142292
0.8829 --- loss: 0.835684, loss_ss: 0.745282, loss_d: 0.090401
0.9213 --- loss: 1.238025, loss_ss: 1.129999, loss_d: 0.108026
0.9597 --- loss: 1.120983, loss_ss: 0.924796, loss_d: 0.196187
0.9981 --- loss: 1.457248, loss_ss: 1.330900, loss_d: 0.126348
Epoch finished! Loss: 1.0977817457455856
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.004222, loss_ss: 0.731488, loss_d: 0.272734
0.0384 --- loss: 1.150190, loss_ss: 1.077056, loss_d: 0.073134
0.0768 --- loss: 1.111866, loss_ss: 0.991368, loss_d: 0.120499
0.1152 --- loss: 1.027491, loss_ss: 0.811200, loss_d: 0.216290
0.1536 --- loss: 1.233591, loss_ss: 1.192224, loss_d: 0.041367
0.1919 --- loss: 1.485119, loss_ss: 1.097073, loss_d: 0.388047
0.2303 --- loss: 1.009747, loss_ss: 0.975981, loss_d: 0.033766
0.2687 --- loss: 1.059794, loss_ss: 1.006003, loss_d: 0.053790
0.3071 --- loss: 1.017559, loss_ss: 0.969881, loss_d: 0.047678
0.3455 --- loss: 0.864558, loss_ss: 0.763583, loss_d: 0.100976
0.3839 --- loss: 1.147883, loss_ss: 0.967806, loss_d: 0.180077
0.4223 --- loss: 1.002143, loss_ss: 0.889193, loss_d: 0.112950
0.4607 --- loss: 1.109475, loss_ss: 1.002753, loss_d: 0.106722
0.4990 --- loss: 1.150213, loss_ss: 1.004637, loss_d: 0.145576
0.5374 --- loss: 0.891407, loss_ss: 0.849371, loss_d: 0.042036
0.5758 --- loss: 0.965391, loss_ss: 0.875548, loss_d: 0.089843
0.6142 --- loss: 0.623502, loss_ss: 0.552181, loss_d: 0.071321
0.6526 --- loss: 0.800024, loss_ss: 0.745849, loss_d: 0.054175
0.6910 --- loss: 0.935669, loss_ss: 0.780536, loss_d: 0.155133
0.7294 --- loss: 1.176789, loss_ss: 0.992373, loss_d: 0.184416
0.7678 --- loss: 1.217143, loss_ss: 1.193447, loss_d: 0.023696
0.8061 --- loss: 1.036432, loss_ss: 0.908308, loss_d: 0.128124
0.8445 --- loss: 0.925317, loss_ss: 0.906723, loss_d: 0.018594
0.8829 --- loss: 1.172245, loss_ss: 1.085739, loss_d: 0.086506
0.9213 --- loss: 1.048177, loss_ss: 0.982389, loss_d: 0.065788
0.9597 --- loss: 1.006231, loss_ss: 0.827665, loss_d: 0.178566
0.9981 --- loss: 1.013742, loss_ss: 0.999713, loss_d: 0.014029
Epoch finished! Loss: 1.0235104670891395
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.042675, loss_ss: 0.977364, loss_d: 0.065310
0.0384 --- loss: 1.111563, loss_ss: 0.801690, loss_d: 0.309873
0.0768 --- loss: 0.801689, loss_ss: 0.758748, loss_d: 0.042941
0.1152 --- loss: 0.904769, loss_ss: 0.747321, loss_d: 0.157448
0.1536 --- loss: 0.648379, loss_ss: 0.568984, loss_d: 0.079395
0.1919 --- loss: 0.872375, loss_ss: 0.662439, loss_d: 0.209936
0.2303 --- loss: 1.375889, loss_ss: 1.134692, loss_d: 0.241197
0.2687 --- loss: 1.256391, loss_ss: 1.013214, loss_d: 0.243177
0.3071 --- loss: 1.021729, loss_ss: 0.934864, loss_d: 0.086865
0.3455 --- loss: 0.901421, loss_ss: 0.797057, loss_d: 0.104364
0.3839 --- loss: 0.960354, loss_ss: 0.908152, loss_d: 0.052202
0.4223 --- loss: 1.014066, loss_ss: 0.996414, loss_d: 0.017652
0.4607 --- loss: 0.861667, loss_ss: 0.771617, loss_d: 0.090051
0.4990 --- loss: 1.695478, loss_ss: 1.413406, loss_d: 0.282073
0.5374 --- loss: 1.088948, loss_ss: 0.852143, loss_d: 0.236805
0.5758 --- loss: 1.084658, loss_ss: 0.880906, loss_d: 0.203753
0.6142 --- loss: 1.046262, loss_ss: 0.878755, loss_d: 0.167507
0.6526 --- loss: 1.169295, loss_ss: 0.949554, loss_d: 0.219741
0.6910 --- loss: 1.126456, loss_ss: 0.680433, loss_d: 0.446023
0.7294 --- loss: 1.095359, loss_ss: 0.765334, loss_d: 0.330024
0.7678 --- loss: 0.947475, loss_ss: 0.931192, loss_d: 0.016283
0.8061 --- loss: 1.139049, loss_ss: 0.876453, loss_d: 0.262597
0.8445 --- loss: 1.733772, loss_ss: 1.007961, loss_d: 0.725811
0.8829 --- loss: 1.221237, loss_ss: 0.777541, loss_d: 0.443696
0.9213 --- loss: 0.936630, loss_ss: 0.904640, loss_d: 0.031989
0.9597 --- loss: 0.828601, loss_ss: 0.682799, loss_d: 0.145802
0.9981 --- loss: 1.361816, loss_ss: 1.347801, loss_d: 0.014015
Epoch finished! Loss: 1.0355716042793714
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.212863, loss_ss: 0.920982, loss_d: 1.291880
0.0384 --- loss: 1.276831, loss_ss: 1.106821, loss_d: 0.170011
0.0768 --- loss: 1.434520, loss_ss: 1.330323, loss_d: 0.104197
0.1152 --- loss: 0.858966, loss_ss: 0.789414, loss_d: 0.069552
0.1536 --- loss: 1.066870, loss_ss: 0.949782, loss_d: 0.117088
0.1919 --- loss: 1.068341, loss_ss: 0.920212, loss_d: 0.148128
0.2303 --- loss: 1.482444, loss_ss: 1.056089, loss_d: 0.426355
0.2687 --- loss: 0.918157, loss_ss: 0.911861, loss_d: 0.006296
0.3071 --- loss: 1.103137, loss_ss: 1.040283, loss_d: 0.062854
0.3455 --- loss: 1.044408, loss_ss: 1.027542, loss_d: 0.016866
0.3839 --- loss: 0.758066, loss_ss: 0.736406, loss_d: 0.021660
0.4223 --- loss: 0.977371, loss_ss: 0.779215, loss_d: 0.198156
0.4607 --- loss: 0.929538, loss_ss: 0.916624, loss_d: 0.012914
0.4990 --- loss: 0.860906, loss_ss: 0.823854, loss_d: 0.037051
0.5374 --- loss: 0.693350, loss_ss: 0.604110, loss_d: 0.089240
0.5758 --- loss: 0.947789, loss_ss: 0.781468, loss_d: 0.166321
0.6142 --- loss: 0.977815, loss_ss: 0.907845, loss_d: 0.069970
0.6526 --- loss: 0.995576, loss_ss: 0.838085, loss_d: 0.157491
0.6910 --- loss: 0.617280, loss_ss: 0.610604, loss_d: 0.006676
0.7294 --- loss: 0.880276, loss_ss: 0.824781, loss_d: 0.055495
0.7678 --- loss: 0.715253, loss_ss: 0.692633, loss_d: 0.022620
0.8061 --- loss: 0.816128, loss_ss: 0.790666, loss_d: 0.025462
0.8445 --- loss: 1.044880, loss_ss: 0.892909, loss_d: 0.151971
0.8829 --- loss: 0.832026, loss_ss: 0.723886, loss_d: 0.108140
0.9213 --- loss: 0.903547, loss_ss: 0.885404, loss_d: 0.018143
0.9597 --- loss: 0.928069, loss_ss: 0.868585, loss_d: 0.059484
0.9981 --- loss: 0.802687, loss_ss: 0.758111, loss_d: 0.044577
Epoch finished! Loss: 1.0067788721277164
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6585858585858586
             precision    recall  f1-score   support

        0.0       0.26      0.78      0.39        32
        1.0       0.60      0.59      0.59       251
        2.0       0.52      0.79      0.63       208
        3.0       1.00      0.69      0.82       254
        4.0       0.88      0.57      0.69       245

avg / total       0.75      0.66      0.68       990
 


====== chp033-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.22  78.12   92.69   26.32     39.37
1  79.70  58.57   86.87   60.25     59.39
2  80.30  79.33   80.56   52.05     62.86
3  92.02  68.90  100.00  100.00     81.59
4  87.47  57.14   97.45   88.05     69.31
Total accuracy: 65.86%
Average sen: 68.41%
Average spec: 91.52%
Macro f1-score: 62.50%
Diagnosis acc on 15mins: 1.0
[0.70341885 0.9428609  0.9221108  0.93713629 0.97991997 0.99731869
 0.99551195 0.99707711 0.99670249 0.982669   0.94575506 0.93350369
 0.9531374  0.8301906  0.9795956  0.97049856 0.97504473 0.99317604
 0.96819502 0.99734062 0.99609607 0.97831923 0.98157513 0.97121072
 0.98689842 0.98934221 0.99582726 0.9782778  0.98170507 0.85452372
 0.97245985 0.98015583 0.81131935]
pred: 0.9539052735675465, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.434110, loss_ss: 1.703283, loss_d: 0.730827
0.0384 --- loss: 2.162061, loss_ss: 1.536707, loss_d: 0.625354
0.0768 --- loss: 2.348005, loss_ss: 1.685202, loss_d: 0.662803
0.1152 --- loss: 2.342078, loss_ss: 1.663860, loss_d: 0.678217
0.1536 --- loss: 1.878969, loss_ss: 1.280392, loss_d: 0.598577
0.1920 --- loss: 2.164758, loss_ss: 1.229214, loss_d: 0.935544
0.2304 --- loss: 1.827588, loss_ss: 1.395066, loss_d: 0.432523
0.2688 --- loss: 1.710604, loss_ss: 1.182839, loss_d: 0.527765
0.3072 --- loss: 1.852956, loss_ss: 1.133146, loss_d: 0.719809
0.3456 --- loss: 2.051233, loss_ss: 1.515394, loss_d: 0.535838
0.3840 --- loss: 1.888277, loss_ss: 1.418582, loss_d: 0.469695
0.4224 --- loss: 1.858447, loss_ss: 1.146616, loss_d: 0.711830
0.4608 --- loss: 1.936989, loss_ss: 1.491668, loss_d: 0.445322
0.4992 --- loss: 1.806123, loss_ss: 1.196210, loss_d: 0.609914
0.5376 --- loss: 2.168255, loss_ss: 1.287233, loss_d: 0.881022
0.5760 --- loss: 1.806986, loss_ss: 1.333349, loss_d: 0.473636
0.6144 --- loss: 1.997893, loss_ss: 1.269893, loss_d: 0.728000
0.6528 --- loss: 1.677699, loss_ss: 1.058008, loss_d: 0.619691
0.6912 --- loss: 1.460209, loss_ss: 1.213070, loss_d: 0.247138
0.7296 --- loss: 2.157877, loss_ss: 1.245739, loss_d: 0.912139
0.7680 --- loss: 1.731698, loss_ss: 1.384303, loss_d: 0.347395
0.8065 --- loss: 2.084496, loss_ss: 1.698774, loss_d: 0.385722
0.8449 --- loss: 1.564341, loss_ss: 1.303314, loss_d: 0.261027
0.8833 --- loss: 1.764231, loss_ss: 1.175741, loss_d: 0.588489
0.9217 --- loss: 2.451012, loss_ss: 1.315840, loss_d: 1.135172
0.9601 --- loss: 1.671253, loss_ss: 1.329355, loss_d: 0.341899
0.9985 --- loss: 1.341667, loss_ss: 1.175168, loss_d: 0.166499
Epoch finished! Loss: 1.89839306473732
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.240149, loss_ss: 1.037618, loss_d: 0.202531
0.0384 --- loss: 1.602136, loss_ss: 1.187713, loss_d: 0.414423
0.0768 --- loss: 1.537147, loss_ss: 1.055673, loss_d: 0.481474
0.1152 --- loss: 1.696502, loss_ss: 1.215036, loss_d: 0.481465
0.1536 --- loss: 1.841255, loss_ss: 1.113115, loss_d: 0.728141
0.1920 --- loss: 1.701937, loss_ss: 1.417123, loss_d: 0.284813
0.2304 --- loss: 1.971102, loss_ss: 1.374534, loss_d: 0.596568
0.2688 --- loss: 1.444969, loss_ss: 1.187828, loss_d: 0.257141
0.3072 --- loss: 1.606699, loss_ss: 1.059037, loss_d: 0.547661
0.3456 --- loss: 1.521656, loss_ss: 1.127548, loss_d: 0.394108
0.3840 --- loss: 1.631634, loss_ss: 1.327772, loss_d: 0.303863
0.4224 --- loss: 1.826466, loss_ss: 1.148725, loss_d: 0.677741
0.4608 --- loss: 1.404751, loss_ss: 1.133213, loss_d: 0.271537
0.4992 --- loss: 1.262135, loss_ss: 1.105520, loss_d: 0.156615
0.5376 --- loss: 1.188810, loss_ss: 0.911213, loss_d: 0.277596
0.5760 --- loss: 1.713797, loss_ss: 1.149402, loss_d: 0.564395
0.6144 --- loss: 1.091095, loss_ss: 1.009851, loss_d: 0.081244
0.6528 --- loss: 1.262097, loss_ss: 1.041034, loss_d: 0.221063
0.6912 --- loss: 1.569170, loss_ss: 1.183558, loss_d: 0.385612
0.7296 --- loss: 1.462220, loss_ss: 0.953063, loss_d: 0.509157
0.7680 --- loss: 1.501515, loss_ss: 1.029201, loss_d: 0.472314
0.8065 --- loss: 1.371925, loss_ss: 0.938836, loss_d: 0.433089
0.8449 --- loss: 1.347494, loss_ss: 1.010353, loss_d: 0.337140
0.8833 --- loss: 1.400147, loss_ss: 1.024640, loss_d: 0.375508
0.9217 --- loss: 1.682313, loss_ss: 1.493939, loss_d: 0.188374
0.9601 --- loss: 1.180552, loss_ss: 1.058480, loss_d: 0.122073
0.9985 --- loss: 1.567640, loss_ss: 1.189337, loss_d: 0.378303
Epoch finished! Loss: 1.493758749961853
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.197308, loss_ss: 0.956845, loss_d: 0.240464
0.0384 --- loss: 1.042203, loss_ss: 0.988229, loss_d: 0.053974
0.0768 --- loss: 1.479847, loss_ss: 0.911171, loss_d: 0.568676
0.1152 --- loss: 1.030786, loss_ss: 0.952383, loss_d: 0.078403
0.1536 --- loss: 1.374217, loss_ss: 1.135632, loss_d: 0.238584
0.1920 --- loss: 1.342905, loss_ss: 1.137905, loss_d: 0.204999
0.2304 --- loss: 1.753030, loss_ss: 1.210888, loss_d: 0.542142
0.2688 --- loss: 1.564615, loss_ss: 1.123268, loss_d: 0.441347
0.3072 --- loss: 1.293559, loss_ss: 1.079470, loss_d: 0.214089
0.3456 --- loss: 1.316321, loss_ss: 1.094916, loss_d: 0.221405
0.3840 --- loss: 1.080835, loss_ss: 1.011759, loss_d: 0.069075
0.4224 --- loss: 1.007768, loss_ss: 0.816063, loss_d: 0.191704
0.4608 --- loss: 1.781374, loss_ss: 0.891153, loss_d: 0.890221
0.4992 --- loss: 1.292588, loss_ss: 1.210788, loss_d: 0.081800
0.5376 --- loss: 1.229676, loss_ss: 1.151580, loss_d: 0.078096
0.5760 --- loss: 1.007253, loss_ss: 0.904951, loss_d: 0.102302
0.6144 --- loss: 1.080649, loss_ss: 1.027768, loss_d: 0.052881
0.6528 --- loss: 1.460462, loss_ss: 1.027265, loss_d: 0.433197
0.6912 --- loss: 1.440031, loss_ss: 1.098780, loss_d: 0.341251
0.7296 --- loss: 1.016704, loss_ss: 0.893232, loss_d: 0.123471
0.7680 --- loss: 1.593395, loss_ss: 1.074865, loss_d: 0.518530
0.8065 --- loss: 1.008146, loss_ss: 0.875544, loss_d: 0.132602
0.8449 --- loss: 1.408155, loss_ss: 1.081727, loss_d: 0.326428
0.8833 --- loss: 1.104102, loss_ss: 1.040454, loss_d: 0.063647
0.9217 --- loss: 1.256853, loss_ss: 1.203318, loss_d: 0.053535
0.9601 --- loss: 0.888292, loss_ss: 0.786814, loss_d: 0.101478
0.9985 --- loss: 1.413463, loss_ss: 1.202467, loss_d: 0.210996
Epoch finished! Loss: 1.3309724693114942
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.403732, loss_ss: 0.810399, loss_d: 0.593333
0.0384 --- loss: 1.181412, loss_ss: 0.950705, loss_d: 0.230707
0.0768 --- loss: 1.053751, loss_ss: 0.988957, loss_d: 0.064794
0.1152 --- loss: 1.140645, loss_ss: 1.042602, loss_d: 0.098043
0.1536 --- loss: 1.108874, loss_ss: 1.003853, loss_d: 0.105021
0.1920 --- loss: 1.185977, loss_ss: 1.121162, loss_d: 0.064816
0.2304 --- loss: 1.345602, loss_ss: 0.823622, loss_d: 0.521980
0.2688 --- loss: 1.444523, loss_ss: 0.937984, loss_d: 0.506539
0.3072 --- loss: 1.473263, loss_ss: 1.053027, loss_d: 0.420236
0.3456 --- loss: 1.147231, loss_ss: 0.921568, loss_d: 0.225663
0.3840 --- loss: 1.022787, loss_ss: 0.890490, loss_d: 0.132297
0.4224 --- loss: 1.116165, loss_ss: 0.926401, loss_d: 0.189764
0.4608 --- loss: 1.564202, loss_ss: 0.861693, loss_d: 0.702509
0.4992 --- loss: 1.080433, loss_ss: 0.994101, loss_d: 0.086332
0.5376 --- loss: 1.176037, loss_ss: 0.884791, loss_d: 0.291246
0.5760 --- loss: 0.951175, loss_ss: 0.769204, loss_d: 0.181972
0.6144 --- loss: 1.011386, loss_ss: 0.811548, loss_d: 0.199838
0.6528 --- loss: 1.295616, loss_ss: 1.103053, loss_d: 0.192563
0.6912 --- loss: 1.204213, loss_ss: 0.711384, loss_d: 0.492829
0.7296 --- loss: 1.868106, loss_ss: 1.486421, loss_d: 0.381685
0.7680 --- loss: 1.344579, loss_ss: 1.030046, loss_d: 0.314533
0.8065 --- loss: 1.123967, loss_ss: 1.026393, loss_d: 0.097573
0.8449 --- loss: 0.888432, loss_ss: 0.774343, loss_d: 0.114089
0.8833 --- loss: 1.304090, loss_ss: 0.914322, loss_d: 0.389769
0.9217 --- loss: 1.019181, loss_ss: 0.849900, loss_d: 0.169280
0.9601 --- loss: 1.582439, loss_ss: 1.178528, loss_d: 0.403911
0.9985 --- loss: 1.539095, loss_ss: 1.213682, loss_d: 0.325414
Epoch finished! Loss: 1.218844525859906
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.272285, loss_ss: 1.040320, loss_d: 0.231965
0.0384 --- loss: 1.215222, loss_ss: 1.181031, loss_d: 0.034190
0.0768 --- loss: 1.661444, loss_ss: 1.069392, loss_d: 0.592052
0.1152 --- loss: 1.341454, loss_ss: 0.876213, loss_d: 0.465242
0.1536 --- loss: 1.187387, loss_ss: 0.984716, loss_d: 0.202670
0.1920 --- loss: 1.225656, loss_ss: 1.108820, loss_d: 0.116836
0.2304 --- loss: 1.435295, loss_ss: 0.969183, loss_d: 0.466112
0.2688 --- loss: 0.923511, loss_ss: 0.746007, loss_d: 0.177505
0.3072 --- loss: 1.261172, loss_ss: 1.116635, loss_d: 0.144538
0.3456 --- loss: 0.972569, loss_ss: 0.929635, loss_d: 0.042935
0.3840 --- loss: 1.082119, loss_ss: 0.965307, loss_d: 0.116812
0.4224 --- loss: 0.986786, loss_ss: 0.935418, loss_d: 0.051368
0.4608 --- loss: 1.010848, loss_ss: 0.945042, loss_d: 0.065806
0.4992 --- loss: 0.979000, loss_ss: 0.764825, loss_d: 0.214175
0.5376 --- loss: 1.559979, loss_ss: 0.856595, loss_d: 0.703384
0.5760 --- loss: 1.455215, loss_ss: 0.906562, loss_d: 0.548653
0.6144 --- loss: 1.012429, loss_ss: 0.750399, loss_d: 0.262030
0.6528 --- loss: 0.791947, loss_ss: 0.700715, loss_d: 0.091232
0.6912 --- loss: 0.864929, loss_ss: 0.797804, loss_d: 0.067124
0.7296 --- loss: 1.310646, loss_ss: 1.061930, loss_d: 0.248716
0.7680 --- loss: 1.172268, loss_ss: 1.094268, loss_d: 0.078000
0.8065 --- loss: 1.103787, loss_ss: 0.961933, loss_d: 0.141853
0.8449 --- loss: 2.011390, loss_ss: 0.984562, loss_d: 1.026828
0.8833 --- loss: 1.195772, loss_ss: 0.929460, loss_d: 0.266312
0.9217 --- loss: 1.148824, loss_ss: 0.878313, loss_d: 0.270511
0.9601 --- loss: 1.143183, loss_ss: 0.628301, loss_d: 0.514882
0.9985 --- loss: 1.235911, loss_ss: 1.150066, loss_d: 0.085845
Epoch finished! Loss: 1.1645922193160423
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.087142, loss_ss: 0.986544, loss_d: 0.100598
0.0384 --- loss: 1.443431, loss_ss: 0.938260, loss_d: 0.505171
0.0768 --- loss: 1.052642, loss_ss: 0.893939, loss_d: 0.158703
0.1152 --- loss: 0.837735, loss_ss: 0.744357, loss_d: 0.093378
0.1536 --- loss: 1.057406, loss_ss: 0.918007, loss_d: 0.139399
0.1920 --- loss: 1.055301, loss_ss: 0.888161, loss_d: 0.167140
0.2304 --- loss: 0.930079, loss_ss: 0.868467, loss_d: 0.061612
0.2688 --- loss: 1.090856, loss_ss: 0.905829, loss_d: 0.185027
0.3072 --- loss: 0.820125, loss_ss: 0.775628, loss_d: 0.044497
0.3456 --- loss: 1.093611, loss_ss: 0.748121, loss_d: 0.345490
0.3840 --- loss: 1.220099, loss_ss: 0.944214, loss_d: 0.275886
0.4224 --- loss: 1.063421, loss_ss: 0.728949, loss_d: 0.334471
0.4608 --- loss: 0.997502, loss_ss: 0.764137, loss_d: 0.233365
0.4992 --- loss: 1.075103, loss_ss: 0.891382, loss_d: 0.183721
0.5376 --- loss: 1.170942, loss_ss: 1.132231, loss_d: 0.038711
0.5760 --- loss: 0.966143, loss_ss: 0.880409, loss_d: 0.085734
0.6144 --- loss: 0.914543, loss_ss: 0.763318, loss_d: 0.151225
0.6528 --- loss: 0.911783, loss_ss: 0.814180, loss_d: 0.097603
0.6912 --- loss: 0.821463, loss_ss: 0.762393, loss_d: 0.059070
0.7296 --- loss: 1.011484, loss_ss: 0.940900, loss_d: 0.070584
0.7680 --- loss: 1.027002, loss_ss: 0.733142, loss_d: 0.293860
0.8065 --- loss: 1.089580, loss_ss: 0.871060, loss_d: 0.218521
0.8449 --- loss: 1.078932, loss_ss: 0.925348, loss_d: 0.153584
0.8833 --- loss: 0.986986, loss_ss: 0.929732, loss_d: 0.057255
0.9217 --- loss: 1.285012, loss_ss: 0.830712, loss_d: 0.454300
0.9601 --- loss: 1.032800, loss_ss: 1.001604, loss_d: 0.031196
0.9985 --- loss: 1.222564, loss_ss: 1.153488, loss_d: 0.069076
Epoch finished! Loss: 1.0962082872023948
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.949311, loss_ss: 0.796196, loss_d: 0.153115
0.0384 --- loss: 1.018524, loss_ss: 0.781740, loss_d: 0.236784
0.0768 --- loss: 1.443405, loss_ss: 1.411900, loss_d: 0.031505
0.1152 --- loss: 1.157504, loss_ss: 1.001337, loss_d: 0.156167
0.1536 --- loss: 1.002299, loss_ss: 0.943557, loss_d: 0.058741
0.1920 --- loss: 1.081295, loss_ss: 0.848744, loss_d: 0.232551
0.2304 --- loss: 0.843457, loss_ss: 0.822047, loss_d: 0.021410
0.2688 --- loss: 0.879330, loss_ss: 0.774986, loss_d: 0.104344
0.3072 --- loss: 1.274542, loss_ss: 1.190448, loss_d: 0.084093
0.3456 --- loss: 0.810133, loss_ss: 0.597192, loss_d: 0.212941
0.3840 --- loss: 0.846058, loss_ss: 0.723794, loss_d: 0.122264
0.4224 --- loss: 0.917099, loss_ss: 0.816033, loss_d: 0.101066
0.4608 --- loss: 1.156702, loss_ss: 0.829996, loss_d: 0.326706
0.4992 --- loss: 0.742478, loss_ss: 0.575196, loss_d: 0.167282
0.5376 --- loss: 1.335941, loss_ss: 1.111776, loss_d: 0.224165
0.5760 --- loss: 1.363250, loss_ss: 1.119252, loss_d: 0.243998
0.6144 --- loss: 0.748192, loss_ss: 0.687642, loss_d: 0.060550
0.6528 --- loss: 1.058211, loss_ss: 0.989667, loss_d: 0.068544
0.6912 --- loss: 1.456140, loss_ss: 1.108263, loss_d: 0.347878
0.7296 --- loss: 0.915366, loss_ss: 0.897434, loss_d: 0.017932
0.7680 --- loss: 1.491183, loss_ss: 1.022086, loss_d: 0.469097
0.8065 --- loss: 1.093233, loss_ss: 0.909883, loss_d: 0.183350
0.8449 --- loss: 0.897642, loss_ss: 0.746953, loss_d: 0.150690
0.8833 --- loss: 0.821523, loss_ss: 0.748481, loss_d: 0.073043
0.9217 --- loss: 0.842398, loss_ss: 0.826128, loss_d: 0.016271
0.9601 --- loss: 0.822817, loss_ss: 0.765808, loss_d: 0.057009
0.9985 --- loss: 1.253598, loss_ss: 1.176279, loss_d: 0.077319
Epoch finished! Loss: 1.0314881801605225
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.396831, loss_ss: 1.113831, loss_d: 0.283001
0.0384 --- loss: 1.010393, loss_ss: 0.810824, loss_d: 0.199568
0.0768 --- loss: 0.975841, loss_ss: 0.871026, loss_d: 0.104815
0.1152 --- loss: 0.903574, loss_ss: 0.852124, loss_d: 0.051450
0.1536 --- loss: 1.186854, loss_ss: 0.953714, loss_d: 0.233140
0.1920 --- loss: 1.037130, loss_ss: 1.014516, loss_d: 0.022613
0.2304 --- loss: 0.631374, loss_ss: 0.616706, loss_d: 0.014668
0.2688 --- loss: 1.082720, loss_ss: 0.598025, loss_d: 0.484694
0.3072 --- loss: 1.303498, loss_ss: 0.787020, loss_d: 0.516478
0.3456 --- loss: 1.038987, loss_ss: 0.978773, loss_d: 0.060214
0.3840 --- loss: 1.073017, loss_ss: 1.024994, loss_d: 0.048024
0.4224 --- loss: 1.086776, loss_ss: 0.994213, loss_d: 0.092563
0.4608 --- loss: 0.845459, loss_ss: 0.836575, loss_d: 0.008883
0.4992 --- loss: 1.078582, loss_ss: 1.061933, loss_d: 0.016650
0.5376 --- loss: 1.097316, loss_ss: 0.943426, loss_d: 0.153890
0.5760 --- loss: 0.936066, loss_ss: 0.879780, loss_d: 0.056285
0.6144 --- loss: 0.678906, loss_ss: 0.665017, loss_d: 0.013889
0.6528 --- loss: 0.790522, loss_ss: 0.613709, loss_d: 0.176813
0.6912 --- loss: 0.925982, loss_ss: 0.878784, loss_d: 0.047198
0.7296 --- loss: 1.021667, loss_ss: 0.682997, loss_d: 0.338670
0.7680 --- loss: 0.988178, loss_ss: 0.967271, loss_d: 0.020907
0.8065 --- loss: 1.107347, loss_ss: 1.103076, loss_d: 0.004271
0.8449 --- loss: 0.755389, loss_ss: 0.713658, loss_d: 0.041731
0.8833 --- loss: 0.959124, loss_ss: 0.865649, loss_d: 0.093476
0.9217 --- loss: 1.123626, loss_ss: 1.037364, loss_d: 0.086262
0.9601 --- loss: 0.986680, loss_ss: 0.976068, loss_d: 0.010612
0.9985 --- loss: 0.935221, loss_ss: 0.904856, loss_d: 0.030365
Epoch finished! Loss: 0.9772679535242227
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.238031, loss_ss: 1.112297, loss_d: 0.125734
0.0384 --- loss: 1.043050, loss_ss: 0.989549, loss_d: 0.053501
0.0768 --- loss: 0.929443, loss_ss: 0.828056, loss_d: 0.101388
0.1152 --- loss: 0.822177, loss_ss: 0.808670, loss_d: 0.013507
0.1536 --- loss: 1.119560, loss_ss: 0.858053, loss_d: 0.261507
0.1920 --- loss: 1.414914, loss_ss: 1.100865, loss_d: 0.314048
0.2304 --- loss: 0.800645, loss_ss: 0.705924, loss_d: 0.094721
0.2688 --- loss: 1.346509, loss_ss: 1.253327, loss_d: 0.093182
0.3072 --- loss: 1.065841, loss_ss: 1.004899, loss_d: 0.060941
0.3456 --- loss: 1.037459, loss_ss: 0.958260, loss_d: 0.079200
0.3840 --- loss: 0.765571, loss_ss: 0.683983, loss_d: 0.081588
0.4224 --- loss: 0.708789, loss_ss: 0.672270, loss_d: 0.036519
0.4608 --- loss: 1.139532, loss_ss: 1.030455, loss_d: 0.109077
0.4992 --- loss: 1.055561, loss_ss: 1.049967, loss_d: 0.005594
0.5376 --- loss: 1.559851, loss_ss: 0.771844, loss_d: 0.788007
0.5760 --- loss: 1.283896, loss_ss: 1.044396, loss_d: 0.239500
0.6144 --- loss: 0.559214, loss_ss: 0.538648, loss_d: 0.020566
0.6528 --- loss: 0.920829, loss_ss: 0.885605, loss_d: 0.035224
0.6912 --- loss: 0.937370, loss_ss: 0.932064, loss_d: 0.005306
0.7296 --- loss: 0.761591, loss_ss: 0.728983, loss_d: 0.032608
0.7680 --- loss: 0.690298, loss_ss: 0.680474, loss_d: 0.009824
0.8065 --- loss: 1.302881, loss_ss: 0.930936, loss_d: 0.371945
0.8449 --- loss: 0.927140, loss_ss: 0.900919, loss_d: 0.026222
0.8833 --- loss: 0.890230, loss_ss: 0.845681, loss_d: 0.044548
0.9217 --- loss: 0.856551, loss_ss: 0.851650, loss_d: 0.004901
0.9601 --- loss: 1.152467, loss_ss: 0.694366, loss_d: 0.458101
0.9985 --- loss: 3.136018, loss_ss: 1.035847, loss_d: 2.100171
Epoch finished! Loss: 0.9716998155300434
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.767550, loss_ss: 0.757727, loss_d: 0.009823
0.0384 --- loss: 0.813596, loss_ss: 0.807078, loss_d: 0.006518
0.0768 --- loss: 0.619836, loss_ss: 0.568453, loss_d: 0.051383
0.1152 --- loss: 1.061030, loss_ss: 1.028730, loss_d: 0.032300
0.1536 --- loss: 0.926279, loss_ss: 0.897244, loss_d: 0.029035
0.1920 --- loss: 0.833530, loss_ss: 0.592589, loss_d: 0.240941
0.2304 --- loss: 0.952762, loss_ss: 0.937173, loss_d: 0.015589
0.2688 --- loss: 0.990994, loss_ss: 0.978345, loss_d: 0.012648
0.3072 --- loss: 0.811401, loss_ss: 0.734780, loss_d: 0.076621
0.3456 --- loss: 0.681532, loss_ss: 0.654820, loss_d: 0.026712
0.3840 --- loss: 0.880829, loss_ss: 0.727523, loss_d: 0.153305
0.4224 --- loss: 0.537008, loss_ss: 0.373839, loss_d: 0.163169
0.4608 --- loss: 1.192093, loss_ss: 0.788153, loss_d: 0.403941
0.4992 --- loss: 1.716462, loss_ss: 0.636859, loss_d: 1.079603
0.5376 --- loss: 0.980233, loss_ss: 0.909700, loss_d: 0.070533
0.5760 --- loss: 1.143559, loss_ss: 1.039784, loss_d: 0.103775
0.6144 --- loss: 2.012532, loss_ss: 1.035899, loss_d: 0.976634
0.6528 --- loss: 0.609050, loss_ss: 0.558200, loss_d: 0.050850
0.6912 --- loss: 0.968673, loss_ss: 0.805665, loss_d: 0.163008
0.7296 --- loss: 0.922892, loss_ss: 0.908789, loss_d: 0.014103
0.7680 --- loss: 0.609718, loss_ss: 0.598742, loss_d: 0.010976
0.8065 --- loss: 0.905677, loss_ss: 0.892456, loss_d: 0.013221
0.8449 --- loss: 0.730202, loss_ss: 0.655651, loss_d: 0.074550
0.8833 --- loss: 0.988523, loss_ss: 0.967519, loss_d: 0.021004
0.9217 --- loss: 0.609042, loss_ss: 0.603178, loss_d: 0.005864
0.9601 --- loss: 1.045330, loss_ss: 1.013110, loss_d: 0.032220
0.9985 --- loss: 0.987019, loss_ss: 0.984700, loss_d: 0.002319
Epoch finished! Loss: 0.9496961164932984
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6666666666666666
             precision    recall  f1-score   support

        0.0       0.33      0.29      0.31        17
        1.0       0.25      0.03      0.06        62
        2.0       0.61      0.67      0.64       372
        3.0       1.00      0.60      0.75       337
        4.0       0.58      0.95      0.72       232

avg / total       0.70      0.67      0.65      1020
 


====== chp034-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.84  29.41   99.00  33.33     31.25
1  93.53   3.23   99.37  25.00      5.71
2  72.06  67.20   74.85  60.53     63.69
3  86.67  59.94   99.85  99.51     74.81
4  83.24  95.26   79.70  58.01     72.10
Total accuracy: 66.67%
Average sen: 51.01%
Average spec: 90.55%
Macro f1-score: 49.52%
Diagnosis acc on 15mins: 0.6470588235294118
[0.861018   0.20198192 0.53526413 0.19829857 0.44406998 0.23797335
 0.4769564  0.57554317 0.75464064 0.83172321 0.9992137  0.82456177
 0.87073296 0.80953079 0.80279571 0.33025959 0.1519482  0.43212828
 0.97568333 0.8782503  0.39929894 0.89753133 0.5996601  0.33874819
 0.99392211 0.71913826 0.77384102 0.95995128 0.99370909 0.09580725
 0.97217059 0.84482783 0.91864622 0.33044371]
pred: 0.6479491155375453, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.389242, loss_ss: 1.659791, loss_d: 0.729451
0.0385 --- loss: 2.114364, loss_ss: 1.582339, loss_d: 0.532025
0.0770 --- loss: 2.593260, loss_ss: 1.857932, loss_d: 0.735328
0.1156 --- loss: 1.913482, loss_ss: 1.448148, loss_d: 0.465334
0.1541 --- loss: 2.070558, loss_ss: 1.378547, loss_d: 0.692011
0.1926 --- loss: 1.976578, loss_ss: 1.464151, loss_d: 0.512428
0.2311 --- loss: 1.857468, loss_ss: 1.296799, loss_d: 0.560669
0.2696 --- loss: 1.994764, loss_ss: 1.586848, loss_d: 0.407916
0.3082 --- loss: 1.981196, loss_ss: 1.565863, loss_d: 0.415333
0.3467 --- loss: 2.264121, loss_ss: 1.597439, loss_d: 0.666682
0.3852 --- loss: 1.912538, loss_ss: 1.229899, loss_d: 0.682639
0.4237 --- loss: 1.833137, loss_ss: 1.355823, loss_d: 0.477314
0.4622 --- loss: 1.812879, loss_ss: 1.341979, loss_d: 0.470900
0.5008 --- loss: 1.853040, loss_ss: 1.492488, loss_d: 0.360552
0.5393 --- loss: 2.030078, loss_ss: 1.322482, loss_d: 0.707597
0.5778 --- loss: 1.892919, loss_ss: 1.378242, loss_d: 0.514677
0.6163 --- loss: 1.477275, loss_ss: 1.225197, loss_d: 0.252077
0.6549 --- loss: 1.877257, loss_ss: 1.470874, loss_d: 0.406383
0.6934 --- loss: 1.883929, loss_ss: 1.114156, loss_d: 0.769773
0.7319 --- loss: 1.772857, loss_ss: 1.272125, loss_d: 0.500732
0.7704 --- loss: 1.596727, loss_ss: 1.307029, loss_d: 0.289697
0.8089 --- loss: 1.752637, loss_ss: 1.237679, loss_d: 0.514958
0.8475 --- loss: 1.864145, loss_ss: 1.339074, loss_d: 0.525071
0.8860 --- loss: 1.509033, loss_ss: 1.166631, loss_d: 0.342402
0.9245 --- loss: 1.753045, loss_ss: 1.235651, loss_d: 0.517394
0.9630 --- loss: 1.491306, loss_ss: 1.119695, loss_d: 0.371611
Epoch finished! Loss: 1.9022447064116195
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.415617, loss_ss: 1.111540, loss_d: 0.304077
0.0385 --- loss: 1.538699, loss_ss: 1.047750, loss_d: 0.490949
0.0770 --- loss: 2.290424, loss_ss: 1.270784, loss_d: 1.019639
0.1156 --- loss: 1.603659, loss_ss: 1.231280, loss_d: 0.372379
0.1541 --- loss: 1.775933, loss_ss: 1.061672, loss_d: 0.714261
0.1926 --- loss: 1.335162, loss_ss: 1.069407, loss_d: 0.265755
0.2311 --- loss: 1.305712, loss_ss: 1.135326, loss_d: 0.170387
0.2696 --- loss: 1.559166, loss_ss: 1.202100, loss_d: 0.357066
0.3082 --- loss: 1.372663, loss_ss: 1.163563, loss_d: 0.209101
0.3467 --- loss: 1.778192, loss_ss: 1.119507, loss_d: 0.658685
0.3852 --- loss: 1.458534, loss_ss: 1.010497, loss_d: 0.448037
0.4237 --- loss: 1.417259, loss_ss: 0.957605, loss_d: 0.459654
0.4622 --- loss: 1.363078, loss_ss: 1.060958, loss_d: 0.302119
0.5008 --- loss: 1.176079, loss_ss: 0.958291, loss_d: 0.217788
0.5393 --- loss: 1.476824, loss_ss: 1.071097, loss_d: 0.405727
0.5778 --- loss: 1.657637, loss_ss: 1.383963, loss_d: 0.273675
0.6163 --- loss: 1.324972, loss_ss: 1.044765, loss_d: 0.280206
0.6549 --- loss: 1.685820, loss_ss: 1.283728, loss_d: 0.402092
0.6934 --- loss: 1.655137, loss_ss: 1.201454, loss_d: 0.453683
0.7319 --- loss: 1.432450, loss_ss: 1.219599, loss_d: 0.212850
0.7704 --- loss: 1.381661, loss_ss: 1.172441, loss_d: 0.209221
0.8089 --- loss: 1.260281, loss_ss: 1.160833, loss_d: 0.099448
0.8475 --- loss: 1.352526, loss_ss: 1.172030, loss_d: 0.180495
0.8860 --- loss: 1.551053, loss_ss: 1.044735, loss_d: 0.506318
0.9245 --- loss: 1.177530, loss_ss: 1.014131, loss_d: 0.163399
0.9630 --- loss: 1.470247, loss_ss: 0.935855, loss_d: 0.534392
Epoch finished! Loss: 1.477831949368407
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.191410, loss_ss: 0.997452, loss_d: 0.193958
0.0385 --- loss: 1.115519, loss_ss: 0.893724, loss_d: 0.221795
0.0770 --- loss: 1.161945, loss_ss: 0.963969, loss_d: 0.197976
0.1156 --- loss: 1.264505, loss_ss: 1.167219, loss_d: 0.097286
0.1541 --- loss: 1.467088, loss_ss: 1.414428, loss_d: 0.052660
0.1926 --- loss: 1.411834, loss_ss: 1.052901, loss_d: 0.358933
0.2311 --- loss: 1.500706, loss_ss: 0.801688, loss_d: 0.699017
0.2696 --- loss: 1.139822, loss_ss: 0.913150, loss_d: 0.226672
0.3082 --- loss: 1.403436, loss_ss: 1.017548, loss_d: 0.385888
0.3467 --- loss: 1.378382, loss_ss: 0.806751, loss_d: 0.571631
0.3852 --- loss: 1.472597, loss_ss: 1.121060, loss_d: 0.351537
0.4237 --- loss: 0.841155, loss_ss: 0.760818, loss_d: 0.080337
0.4622 --- loss: 1.210899, loss_ss: 0.943858, loss_d: 0.267040
0.5008 --- loss: 1.154157, loss_ss: 0.984016, loss_d: 0.170141
0.5393 --- loss: 1.495925, loss_ss: 1.288988, loss_d: 0.206937
0.5778 --- loss: 1.186919, loss_ss: 1.142922, loss_d: 0.043997
0.6163 --- loss: 1.061540, loss_ss: 0.936326, loss_d: 0.125215
0.6549 --- loss: 1.374622, loss_ss: 0.948468, loss_d: 0.426154
0.6934 --- loss: 1.074322, loss_ss: 0.871804, loss_d: 0.202518
0.7319 --- loss: 1.087054, loss_ss: 0.895468, loss_d: 0.191586
0.7704 --- loss: 1.034690, loss_ss: 0.882671, loss_d: 0.152018
0.8089 --- loss: 1.308564, loss_ss: 0.859267, loss_d: 0.449297
0.8475 --- loss: 1.381411, loss_ss: 1.120437, loss_d: 0.260974
0.8860 --- loss: 1.272000, loss_ss: 0.842608, loss_d: 0.429392
0.9245 --- loss: 1.401538, loss_ss: 1.106681, loss_d: 0.294858
0.9630 --- loss: 1.171107, loss_ss: 0.854204, loss_d: 0.316903
Epoch finished! Loss: 1.3014075806702425
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.286261, loss_ss: 1.070858, loss_d: 0.215404
0.0385 --- loss: 1.239703, loss_ss: 1.035036, loss_d: 0.204667
0.0770 --- loss: 0.941615, loss_ss: 0.848788, loss_d: 0.092827
0.1156 --- loss: 1.183805, loss_ss: 0.887080, loss_d: 0.296725
0.1541 --- loss: 1.043235, loss_ss: 0.845512, loss_d: 0.197723
0.1926 --- loss: 1.153018, loss_ss: 0.887145, loss_d: 0.265873
0.2311 --- loss: 0.956826, loss_ss: 0.850059, loss_d: 0.106767
0.2696 --- loss: 1.494761, loss_ss: 1.203769, loss_d: 0.290992
0.3082 --- loss: 1.218490, loss_ss: 0.970297, loss_d: 0.248192
0.3467 --- loss: 1.224193, loss_ss: 0.893365, loss_d: 0.330828
0.3852 --- loss: 1.253597, loss_ss: 0.890385, loss_d: 0.363212
0.4237 --- loss: 1.362609, loss_ss: 1.050508, loss_d: 0.312101
0.4622 --- loss: 1.037857, loss_ss: 0.954222, loss_d: 0.083636
0.5008 --- loss: 1.149983, loss_ss: 0.668853, loss_d: 0.481129
0.5393 --- loss: 0.921734, loss_ss: 0.757687, loss_d: 0.164048
0.5778 --- loss: 1.382849, loss_ss: 0.875897, loss_d: 0.506953
0.6163 --- loss: 1.217654, loss_ss: 0.988526, loss_d: 0.229128
0.6549 --- loss: 1.327915, loss_ss: 1.079289, loss_d: 0.248626
0.6934 --- loss: 1.028579, loss_ss: 0.940517, loss_d: 0.088062
0.7319 --- loss: 0.834509, loss_ss: 0.706386, loss_d: 0.128123
0.7704 --- loss: 1.461699, loss_ss: 1.131204, loss_d: 0.330495
0.8089 --- loss: 1.024227, loss_ss: 0.825918, loss_d: 0.198308
0.8475 --- loss: 1.438307, loss_ss: 1.193856, loss_d: 0.244451
0.8860 --- loss: 1.488654, loss_ss: 1.249351, loss_d: 0.239303
0.9245 --- loss: 1.623325, loss_ss: 1.017674, loss_d: 0.605651
0.9630 --- loss: 1.246917, loss_ss: 0.911498, loss_d: 0.335419
Epoch finished! Loss: 1.2100070586075653
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.006097, loss_ss: 0.778732, loss_d: 0.227364
0.0385 --- loss: 0.828409, loss_ss: 0.716267, loss_d: 0.112142
0.0770 --- loss: 0.982239, loss_ss: 0.866162, loss_d: 0.116077
0.1156 --- loss: 1.376836, loss_ss: 1.168113, loss_d: 0.208724
0.1541 --- loss: 0.940747, loss_ss: 0.828969, loss_d: 0.111778
0.1926 --- loss: 0.990989, loss_ss: 0.799849, loss_d: 0.191139
0.2311 --- loss: 1.180766, loss_ss: 1.010473, loss_d: 0.170292
0.2696 --- loss: 1.079401, loss_ss: 0.850402, loss_d: 0.229000
0.3082 --- loss: 1.040149, loss_ss: 1.015824, loss_d: 0.024325
0.3467 --- loss: 1.280089, loss_ss: 1.066201, loss_d: 0.213888
0.3852 --- loss: 0.968808, loss_ss: 0.759594, loss_d: 0.209213
0.4237 --- loss: 1.346798, loss_ss: 1.142882, loss_d: 0.203917
0.4622 --- loss: 1.176421, loss_ss: 1.127390, loss_d: 0.049031
0.5008 --- loss: 1.114778, loss_ss: 0.973586, loss_d: 0.141192
0.5393 --- loss: 1.034938, loss_ss: 0.965484, loss_d: 0.069454
0.5778 --- loss: 1.041370, loss_ss: 0.995036, loss_d: 0.046333
0.6163 --- loss: 1.156806, loss_ss: 0.842776, loss_d: 0.314030
0.6549 --- loss: 1.376785, loss_ss: 1.090088, loss_d: 0.286697
0.6934 --- loss: 1.004102, loss_ss: 0.849541, loss_d: 0.154560
0.7319 --- loss: 1.101371, loss_ss: 0.788477, loss_d: 0.312893
0.7704 --- loss: 1.029221, loss_ss: 0.848072, loss_d: 0.181149
0.8089 --- loss: 1.292379, loss_ss: 1.219230, loss_d: 0.073150
0.8475 --- loss: 0.876129, loss_ss: 0.765595, loss_d: 0.110534
0.8860 --- loss: 1.264102, loss_ss: 0.897494, loss_d: 0.366609
0.9245 --- loss: 1.601600, loss_ss: 0.944730, loss_d: 0.656870
0.9630 --- loss: 0.828428, loss_ss: 0.714438, loss_d: 0.113990
Epoch finished! Loss: 1.1456099518477687
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.086790, loss_ss: 1.064814, loss_d: 0.021976
0.0385 --- loss: 1.013355, loss_ss: 0.912144, loss_d: 0.101212
0.0770 --- loss: 1.362704, loss_ss: 1.342893, loss_d: 0.019811
0.1156 --- loss: 0.992191, loss_ss: 0.823228, loss_d: 0.168963
0.1541 --- loss: 1.108183, loss_ss: 1.077660, loss_d: 0.030523
0.1926 --- loss: 0.992311, loss_ss: 0.820550, loss_d: 0.171761
0.2311 --- loss: 1.108948, loss_ss: 0.652246, loss_d: 0.456702
0.2696 --- loss: 0.996175, loss_ss: 0.866856, loss_d: 0.129319
0.3082 --- loss: 0.840508, loss_ss: 0.738797, loss_d: 0.101710
0.3467 --- loss: 0.996186, loss_ss: 0.947713, loss_d: 0.048473
0.3852 --- loss: 1.078911, loss_ss: 0.690443, loss_d: 0.388468
0.4237 --- loss: 1.153022, loss_ss: 0.923684, loss_d: 0.229338
0.4622 --- loss: 1.280030, loss_ss: 0.794009, loss_d: 0.486021
0.5008 --- loss: 1.324002, loss_ss: 1.118862, loss_d: 0.205141
0.5393 --- loss: 0.951655, loss_ss: 0.706178, loss_d: 0.245477
0.5778 --- loss: 0.945257, loss_ss: 0.791352, loss_d: 0.153905
0.6163 --- loss: 0.993444, loss_ss: 0.951204, loss_d: 0.042240
0.6549 --- loss: 1.161842, loss_ss: 1.049846, loss_d: 0.111996
0.6934 --- loss: 1.522040, loss_ss: 0.941661, loss_d: 0.580379
0.7319 --- loss: 0.700020, loss_ss: 0.614323, loss_d: 0.085696
0.7704 --- loss: 1.064368, loss_ss: 0.847444, loss_d: 0.216924
0.8089 --- loss: 1.140803, loss_ss: 1.005381, loss_d: 0.135423
0.8475 --- loss: 1.543011, loss_ss: 1.348757, loss_d: 0.194254
0.8860 --- loss: 1.093614, loss_ss: 0.792340, loss_d: 0.301274
0.9245 --- loss: 1.044720, loss_ss: 0.901824, loss_d: 0.142896
0.9630 --- loss: 0.857316, loss_ss: 0.692600, loss_d: 0.164716
Epoch finished! Loss: 1.0638211282063634
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.175295, loss_ss: 0.859340, loss_d: 0.315955
0.0385 --- loss: 1.279176, loss_ss: 0.948109, loss_d: 0.331068
0.0770 --- loss: 1.196977, loss_ss: 0.815250, loss_d: 0.381728
0.1156 --- loss: 1.214690, loss_ss: 1.145573, loss_d: 0.069117
0.1541 --- loss: 1.334855, loss_ss: 0.730240, loss_d: 0.604615
0.1926 --- loss: 0.849768, loss_ss: 0.647369, loss_d: 0.202399
0.2311 --- loss: 0.808082, loss_ss: 0.740329, loss_d: 0.067753
0.2696 --- loss: 1.668095, loss_ss: 0.768520, loss_d: 0.899575
0.3082 --- loss: 1.141057, loss_ss: 1.078893, loss_d: 0.062163
0.3467 --- loss: 0.990632, loss_ss: 0.903370, loss_d: 0.087262
0.3852 --- loss: 0.999183, loss_ss: 0.933386, loss_d: 0.065797
0.4237 --- loss: 0.827722, loss_ss: 0.765221, loss_d: 0.062501
0.4622 --- loss: 1.193029, loss_ss: 1.049721, loss_d: 0.143308
0.5008 --- loss: 1.126002, loss_ss: 0.993732, loss_d: 0.132270
0.5393 --- loss: 1.337587, loss_ss: 0.779244, loss_d: 0.558343
0.5778 --- loss: 1.488193, loss_ss: 1.252587, loss_d: 0.235605
0.6163 --- loss: 1.908475, loss_ss: 1.119060, loss_d: 0.789416
0.6549 --- loss: 1.785508, loss_ss: 1.237824, loss_d: 0.547684
0.6934 --- loss: 0.826302, loss_ss: 0.781582, loss_d: 0.044720
0.7319 --- loss: 1.102813, loss_ss: 0.760837, loss_d: 0.341976
0.7704 --- loss: 1.247610, loss_ss: 0.969452, loss_d: 0.278158
0.8089 --- loss: 1.438035, loss_ss: 0.767343, loss_d: 0.670692
0.8475 --- loss: 0.948975, loss_ss: 0.874518, loss_d: 0.074457
0.8860 --- loss: 1.214904, loss_ss: 0.762524, loss_d: 0.452380
0.9245 --- loss: 1.084883, loss_ss: 0.743379, loss_d: 0.341504
0.9630 --- loss: 0.814435, loss_ss: 0.632748, loss_d: 0.181686
Epoch finished! Loss: 1.0600170115706544
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.832056, loss_ss: 0.733847, loss_d: 0.098210
0.0385 --- loss: 0.767310, loss_ss: 0.634905, loss_d: 0.132406
0.0770 --- loss: 0.896984, loss_ss: 0.864829, loss_d: 0.032155
0.1156 --- loss: 0.864144, loss_ss: 0.671850, loss_d: 0.192294
0.1541 --- loss: 0.971758, loss_ss: 0.909561, loss_d: 0.062198
0.1926 --- loss: 0.813731, loss_ss: 0.788624, loss_d: 0.025107
0.2311 --- loss: 0.983409, loss_ss: 0.743208, loss_d: 0.240201
0.2696 --- loss: 1.048696, loss_ss: 0.679989, loss_d: 0.368708
0.3082 --- loss: 1.362784, loss_ss: 0.506096, loss_d: 0.856688
0.3467 --- loss: 0.857546, loss_ss: 0.799802, loss_d: 0.057744
0.3852 --- loss: 1.116861, loss_ss: 0.974808, loss_d: 0.142053
0.4237 --- loss: 1.082649, loss_ss: 1.010916, loss_d: 0.071732
0.4622 --- loss: 0.986875, loss_ss: 0.820873, loss_d: 0.166001
0.5008 --- loss: 1.059269, loss_ss: 0.892701, loss_d: 0.166567
0.5393 --- loss: 1.462943, loss_ss: 0.827499, loss_d: 0.635445
0.5778 --- loss: 1.208796, loss_ss: 1.183841, loss_d: 0.024956
0.6163 --- loss: 1.130170, loss_ss: 0.943282, loss_d: 0.186887
0.6549 --- loss: 1.141508, loss_ss: 0.809900, loss_d: 0.331608
0.6934 --- loss: 1.006503, loss_ss: 0.846754, loss_d: 0.159749
0.7319 --- loss: 0.725488, loss_ss: 0.628190, loss_d: 0.097298
0.7704 --- loss: 0.873155, loss_ss: 0.779031, loss_d: 0.094124
0.8089 --- loss: 0.920593, loss_ss: 0.852201, loss_d: 0.068392
0.8475 --- loss: 0.907359, loss_ss: 0.874085, loss_d: 0.033274
0.8860 --- loss: 1.042174, loss_ss: 1.004795, loss_d: 0.037379
0.9245 --- loss: 0.850241, loss_ss: 0.816522, loss_d: 0.033719
0.9630 --- loss: 0.705648, loss_ss: 0.686158, loss_d: 0.019490
Epoch finished! Loss: 1.0226006848471505
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.980249, loss_ss: 0.765848, loss_d: 0.214400
0.0385 --- loss: 0.972608, loss_ss: 0.902502, loss_d: 0.070106
0.0770 --- loss: 0.737667, loss_ss: 0.712645, loss_d: 0.025022
0.1156 --- loss: 1.882414, loss_ss: 0.743573, loss_d: 1.138841
0.1541 --- loss: 0.721110, loss_ss: 0.707811, loss_d: 0.013298
0.1926 --- loss: 0.931214, loss_ss: 0.810461, loss_d: 0.120752
0.2311 --- loss: 0.821029, loss_ss: 0.702067, loss_d: 0.118962
0.2696 --- loss: 1.250016, loss_ss: 1.203991, loss_d: 0.046025
0.3082 --- loss: 1.147672, loss_ss: 1.101120, loss_d: 0.046552
0.3467 --- loss: 1.232621, loss_ss: 1.160256, loss_d: 0.072364
0.3852 --- loss: 1.219534, loss_ss: 1.172135, loss_d: 0.047398
0.4237 --- loss: 1.444806, loss_ss: 1.011592, loss_d: 0.433214
0.4622 --- loss: 0.831065, loss_ss: 0.786244, loss_d: 0.044821
0.5008 --- loss: 1.091622, loss_ss: 1.019105, loss_d: 0.072517
0.5393 --- loss: 0.806685, loss_ss: 0.766416, loss_d: 0.040270
0.5778 --- loss: 0.969704, loss_ss: 0.787064, loss_d: 0.182640
0.6163 --- loss: 0.552264, loss_ss: 0.522028, loss_d: 0.030236
0.6549 --- loss: 0.912485, loss_ss: 0.810717, loss_d: 0.101768
0.6934 --- loss: 0.942306, loss_ss: 0.926834, loss_d: 0.015472
0.7319 --- loss: 1.036396, loss_ss: 0.988656, loss_d: 0.047741
0.7704 --- loss: 0.796109, loss_ss: 0.783423, loss_d: 0.012686
0.8089 --- loss: 0.849379, loss_ss: 0.687921, loss_d: 0.161457
0.8475 --- loss: 0.675514, loss_ss: 0.600470, loss_d: 0.075044
0.8860 --- loss: 1.020797, loss_ss: 0.979267, loss_d: 0.041531
0.9245 --- loss: 0.656921, loss_ss: 0.649996, loss_d: 0.006925
0.9630 --- loss: 0.788689, loss_ss: 0.723844, loss_d: 0.064845
Epoch finished! Loss: 0.9671736258337397
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.006204, loss_ss: 0.995548, loss_d: 0.010656
0.0385 --- loss: 0.966435, loss_ss: 0.950739, loss_d: 0.015696
0.0770 --- loss: 0.990774, loss_ss: 0.962045, loss_d: 0.028729
0.1156 --- loss: 0.753361, loss_ss: 0.663427, loss_d: 0.089934
0.1541 --- loss: 0.896755, loss_ss: 0.839738, loss_d: 0.057018
0.1926 --- loss: 0.809944, loss_ss: 0.660371, loss_d: 0.149572
0.2311 --- loss: 1.181151, loss_ss: 1.100652, loss_d: 0.080499
0.2696 --- loss: 1.017630, loss_ss: 0.763292, loss_d: 0.254338
0.3082 --- loss: 0.803866, loss_ss: 0.560885, loss_d: 0.242981
0.3467 --- loss: 0.872195, loss_ss: 0.838342, loss_d: 0.033853
0.3852 --- loss: 1.074961, loss_ss: 0.994273, loss_d: 0.080689
0.4237 --- loss: 1.071030, loss_ss: 1.011061, loss_d: 0.059969
0.4622 --- loss: 0.873634, loss_ss: 0.824099, loss_d: 0.049535
0.5008 --- loss: 0.743182, loss_ss: 0.703837, loss_d: 0.039345
0.5393 --- loss: 1.239149, loss_ss: 0.810682, loss_d: 0.428467
0.5778 --- loss: 0.892913, loss_ss: 0.856644, loss_d: 0.036269
0.6163 --- loss: 0.562826, loss_ss: 0.500035, loss_d: 0.062791
0.6549 --- loss: 0.926103, loss_ss: 0.849813, loss_d: 0.076290
0.6934 --- loss: 1.178219, loss_ss: 0.837112, loss_d: 0.341106
0.7319 --- loss: 0.711750, loss_ss: 0.694350, loss_d: 0.017400
0.7704 --- loss: 1.748739, loss_ss: 1.125491, loss_d: 0.623248
0.8089 --- loss: 2.159420, loss_ss: 1.941150, loss_d: 0.218270
0.8475 --- loss: 0.864060, loss_ss: 0.833593, loss_d: 0.030467
0.8860 --- loss: 0.809094, loss_ss: 0.730246, loss_d: 0.078847
0.9245 --- loss: 0.991957, loss_ss: 0.887245, loss_d: 0.104712
0.9630 --- loss: 0.956661, loss_ss: 0.929372, loss_d: 0.027288
Epoch finished! Loss: 0.964537653223428
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7293650793650793
             precision    recall  f1-score   support

        0.0       0.75      0.67      0.71       237
        1.0       0.60      0.18      0.28       167
        2.0       0.89      0.81      0.85       563
        3.0       0.10      0.62      0.18         8
        4.0       0.62      0.95      0.75       285

avg / total       0.76      0.73      0.72      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.52  67.09   94.72  74.65     70.67
1  87.54  17.96   98.17  60.00     27.65
2  86.90  80.64   91.97  89.02     84.62
3  96.35  62.50   96.57  10.42     17.86
4  85.56  95.09   82.77  61.73     74.86
Total accuracy: 72.94%
Average sen: 64.66%
Average spec: 92.84%
Macro f1-score: 55.13%
Diagnosis acc on 15mins: 1.0
[0.99999857 0.99999893 0.99976951 0.9996742  0.99877352 0.99961531
 0.99117845 0.99848652 0.99968302 0.99526149 0.99829251 0.99171269
 0.9939037  0.99776924 0.97882628 0.99748552 0.98943847 0.97842789
 0.9062416  0.98609167 0.99501246 0.9996897  0.99976248 0.99990189
 0.99966025 0.9637202  0.99467057 0.99925452 0.9999994  0.99994934
 0.79401046 0.99910468 0.9996171  0.99965739 0.99566627 0.98579109
 0.99997473 0.98916411 0.99901593 0.99797648 0.95336252 0.99700576]
pred: 0.9872046765826997, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.283648, loss_ss: 1.638432, loss_d: 0.645217
0.0384 --- loss: 2.090966, loss_ss: 1.500254, loss_d: 0.590713
0.0768 --- loss: 1.986289, loss_ss: 1.653445, loss_d: 0.332843
0.1152 --- loss: 1.717330, loss_ss: 1.372831, loss_d: 0.344500
0.1536 --- loss: 1.970832, loss_ss: 1.410017, loss_d: 0.560815
0.1920 --- loss: 2.096674, loss_ss: 1.472557, loss_d: 0.624117
0.2304 --- loss: 2.168195, loss_ss: 1.425409, loss_d: 0.742786
0.2688 --- loss: 2.554627, loss_ss: 1.298648, loss_d: 1.255980
0.3072 --- loss: 2.153991, loss_ss: 1.542128, loss_d: 0.611863
0.3456 --- loss: 1.958679, loss_ss: 1.221452, loss_d: 0.737227
0.3840 --- loss: 2.088097, loss_ss: 1.441599, loss_d: 0.646498
0.4224 --- loss: 2.078777, loss_ss: 1.270983, loss_d: 0.807794
0.4608 --- loss: 1.734374, loss_ss: 1.232245, loss_d: 0.502129
0.4992 --- loss: 2.177422, loss_ss: 1.356154, loss_d: 0.821267
0.5376 --- loss: 1.687902, loss_ss: 1.251673, loss_d: 0.436229
0.5760 --- loss: 1.757519, loss_ss: 1.314574, loss_d: 0.442945
0.6144 --- loss: 1.605714, loss_ss: 1.130449, loss_d: 0.475266
0.6528 --- loss: 1.689098, loss_ss: 1.230016, loss_d: 0.459082
0.6912 --- loss: 1.834673, loss_ss: 1.347087, loss_d: 0.487585
0.7296 --- loss: 1.865078, loss_ss: 1.496700, loss_d: 0.368378
0.7680 --- loss: 1.630204, loss_ss: 1.202563, loss_d: 0.427640
0.8065 --- loss: 1.466642, loss_ss: 1.222184, loss_d: 0.244458
0.8449 --- loss: 1.678723, loss_ss: 1.231670, loss_d: 0.447052
0.8833 --- loss: 1.691289, loss_ss: 1.291057, loss_d: 0.400233
0.9217 --- loss: 1.622248, loss_ss: 1.092112, loss_d: 0.530136
0.9601 --- loss: 1.901021, loss_ss: 1.246938, loss_d: 0.654082
0.9985 --- loss: 2.061370, loss_ss: 1.486701, loss_d: 0.574669
Epoch finished! Loss: 1.8863430284536802
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.602734, loss_ss: 1.307365, loss_d: 0.295369
0.0384 --- loss: 1.380374, loss_ss: 1.076020, loss_d: 0.304353
0.0768 --- loss: 1.553433, loss_ss: 1.298073, loss_d: 0.255359
0.1152 --- loss: 1.394904, loss_ss: 1.249145, loss_d: 0.145759
0.1536 --- loss: 1.738433, loss_ss: 1.270221, loss_d: 0.468213
0.1920 --- loss: 1.682402, loss_ss: 1.263099, loss_d: 0.419304
0.2304 --- loss: 1.365444, loss_ss: 1.153607, loss_d: 0.211837
0.2688 --- loss: 1.190819, loss_ss: 1.105981, loss_d: 0.084837
0.3072 --- loss: 1.710405, loss_ss: 1.403127, loss_d: 0.307278
0.3456 --- loss: 1.455623, loss_ss: 1.170275, loss_d: 0.285347
0.3840 --- loss: 1.583635, loss_ss: 1.125103, loss_d: 0.458532
0.4224 --- loss: 1.370477, loss_ss: 1.000767, loss_d: 0.369709
0.4608 --- loss: 1.966074, loss_ss: 1.295854, loss_d: 0.670220
0.4992 --- loss: 1.533936, loss_ss: 1.041406, loss_d: 0.492530
0.5376 --- loss: 1.703078, loss_ss: 1.213521, loss_d: 0.489556
0.5760 --- loss: 1.427561, loss_ss: 1.147620, loss_d: 0.279941
0.6144 --- loss: 1.314362, loss_ss: 1.038743, loss_d: 0.275619
0.6528 --- loss: 1.747842, loss_ss: 1.472019, loss_d: 0.275823
0.6912 --- loss: 1.722651, loss_ss: 1.046733, loss_d: 0.675918
0.7296 --- loss: 1.544799, loss_ss: 1.166199, loss_d: 0.378600
0.7680 --- loss: 1.608646, loss_ss: 1.207156, loss_d: 0.401490
0.8065 --- loss: 1.226884, loss_ss: 1.025551, loss_d: 0.201333
0.8449 --- loss: 1.078763, loss_ss: 0.935793, loss_d: 0.142971
0.8833 --- loss: 1.210468, loss_ss: 1.057310, loss_d: 0.153158
0.9217 --- loss: 1.629771, loss_ss: 1.111342, loss_d: 0.518429
0.9601 --- loss: 1.375376, loss_ss: 1.018936, loss_d: 0.356440
0.9985 --- loss: 1.327379, loss_ss: 1.206543, loss_d: 0.120836
Epoch finished! Loss: 1.536908538524921
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.461577, loss_ss: 1.192762, loss_d: 0.268815
0.0384 --- loss: 1.463762, loss_ss: 1.120173, loss_d: 0.343589
0.0768 --- loss: 1.299302, loss_ss: 1.169455, loss_d: 0.129847
0.1152 --- loss: 1.296354, loss_ss: 1.144760, loss_d: 0.151594
0.1536 --- loss: 1.478025, loss_ss: 1.071872, loss_d: 0.406153
0.1920 --- loss: 1.286406, loss_ss: 0.968583, loss_d: 0.317822
0.2304 --- loss: 1.357970, loss_ss: 1.251665, loss_d: 0.106305
0.2688 --- loss: 1.420213, loss_ss: 0.893225, loss_d: 0.526987
0.3072 --- loss: 1.133454, loss_ss: 0.826889, loss_d: 0.306565
0.3456 --- loss: 1.273511, loss_ss: 0.990937, loss_d: 0.282574
0.3840 --- loss: 1.271763, loss_ss: 1.113679, loss_d: 0.158084
0.4224 --- loss: 1.403030, loss_ss: 0.915294, loss_d: 0.487736
0.4608 --- loss: 1.263809, loss_ss: 0.933711, loss_d: 0.330098
0.4992 --- loss: 1.364174, loss_ss: 1.109013, loss_d: 0.255161
0.5376 --- loss: 1.114355, loss_ss: 0.918418, loss_d: 0.195936
0.5760 --- loss: 1.334026, loss_ss: 1.082941, loss_d: 0.251086
0.6144 --- loss: 1.781631, loss_ss: 1.559038, loss_d: 0.222594
0.6528 --- loss: 1.512975, loss_ss: 0.928419, loss_d: 0.584556
0.6912 --- loss: 1.669619, loss_ss: 1.317874, loss_d: 0.351745
0.7296 --- loss: 1.419662, loss_ss: 1.035087, loss_d: 0.384575
0.7680 --- loss: 1.126275, loss_ss: 0.916472, loss_d: 0.209802
0.8065 --- loss: 1.547807, loss_ss: 1.384855, loss_d: 0.162952
0.8449 --- loss: 1.051779, loss_ss: 0.723572, loss_d: 0.328207
0.8833 --- loss: 1.590672, loss_ss: 1.190705, loss_d: 0.399967
0.9217 --- loss: 1.035743, loss_ss: 0.917346, loss_d: 0.118397
0.9601 --- loss: 1.617966, loss_ss: 0.898974, loss_d: 0.718992
0.9985 --- loss: 1.335506, loss_ss: 0.921659, loss_d: 0.413846
Epoch finished! Loss: 1.3807634161068842
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.243002, loss_ss: 0.989472, loss_d: 0.253530
0.0384 --- loss: 1.015389, loss_ss: 0.849667, loss_d: 0.165722
0.0768 --- loss: 1.198742, loss_ss: 1.147447, loss_d: 0.051295
0.1152 --- loss: 1.775881, loss_ss: 0.978912, loss_d: 0.796969
0.1536 --- loss: 1.311421, loss_ss: 1.143883, loss_d: 0.167538
0.1920 --- loss: 0.909118, loss_ss: 0.724618, loss_d: 0.184500
0.2304 --- loss: 1.457428, loss_ss: 1.412901, loss_d: 0.044526
0.2688 --- loss: 1.145717, loss_ss: 0.758384, loss_d: 0.387334
0.3072 --- loss: 1.246451, loss_ss: 1.018538, loss_d: 0.227913
0.3456 --- loss: 1.755027, loss_ss: 1.025988, loss_d: 0.729039
0.3840 --- loss: 1.207996, loss_ss: 1.061450, loss_d: 0.146546
0.4224 --- loss: 1.182771, loss_ss: 0.817724, loss_d: 0.365047
0.4608 --- loss: 1.107438, loss_ss: 0.887598, loss_d: 0.219840
0.4992 --- loss: 1.233642, loss_ss: 1.068950, loss_d: 0.164692
0.5376 --- loss: 1.749925, loss_ss: 1.144197, loss_d: 0.605728
0.5760 --- loss: 1.606872, loss_ss: 0.957387, loss_d: 0.649485
0.6144 --- loss: 0.996253, loss_ss: 0.836297, loss_d: 0.159955
0.6528 --- loss: 1.317069, loss_ss: 1.038626, loss_d: 0.278443
0.6912 --- loss: 0.957005, loss_ss: 0.701214, loss_d: 0.255790
0.7296 --- loss: 1.106260, loss_ss: 1.018503, loss_d: 0.087757
0.7680 --- loss: 1.233315, loss_ss: 1.077684, loss_d: 0.155632
0.8065 --- loss: 1.234007, loss_ss: 1.143201, loss_d: 0.090806
0.8449 --- loss: 1.063716, loss_ss: 0.997818, loss_d: 0.065898
0.8833 --- loss: 0.865871, loss_ss: 0.745801, loss_d: 0.120071
0.9217 --- loss: 1.446596, loss_ss: 0.847605, loss_d: 0.598991
0.9601 --- loss: 1.817951, loss_ss: 1.310066, loss_d: 0.507885
0.9985 --- loss: 2.322217, loss_ss: 1.852333, loss_d: 0.469885
Epoch finished! Loss: 1.2549369974778248
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.970643, loss_ss: 0.853390, loss_d: 0.117253
0.0384 --- loss: 1.279371, loss_ss: 0.918848, loss_d: 0.360522
0.0768 --- loss: 1.088350, loss_ss: 1.047748, loss_d: 0.040602
0.1152 --- loss: 1.258287, loss_ss: 1.190576, loss_d: 0.067712
0.1536 --- loss: 1.400187, loss_ss: 1.081772, loss_d: 0.318415
0.1920 --- loss: 1.071295, loss_ss: 0.750220, loss_d: 0.321076
0.2304 --- loss: 1.064124, loss_ss: 0.997734, loss_d: 0.066390
0.2688 --- loss: 1.148693, loss_ss: 1.025967, loss_d: 0.122726
0.3072 --- loss: 1.442688, loss_ss: 1.312338, loss_d: 0.130350
0.3456 --- loss: 1.159678, loss_ss: 1.017008, loss_d: 0.142670
0.3840 --- loss: 1.648778, loss_ss: 1.158347, loss_d: 0.490431
0.4224 --- loss: 0.909233, loss_ss: 0.838234, loss_d: 0.070999
0.4608 --- loss: 1.160334, loss_ss: 0.922145, loss_d: 0.238190
0.4992 --- loss: 1.724172, loss_ss: 1.008635, loss_d: 0.715536
0.5376 --- loss: 1.618256, loss_ss: 0.850026, loss_d: 0.768230
0.5760 --- loss: 1.154759, loss_ss: 1.032966, loss_d: 0.121793
0.6144 --- loss: 1.215725, loss_ss: 1.034488, loss_d: 0.181238
0.6528 --- loss: 1.313040, loss_ss: 0.854413, loss_d: 0.458627
0.6912 --- loss: 1.004518, loss_ss: 0.765035, loss_d: 0.239483
0.7296 --- loss: 1.062155, loss_ss: 0.760731, loss_d: 0.301424
0.7680 --- loss: 1.387680, loss_ss: 1.197769, loss_d: 0.189911
0.8065 --- loss: 1.384671, loss_ss: 0.949022, loss_d: 0.435649
0.8449 --- loss: 1.325970, loss_ss: 1.065177, loss_d: 0.260793
0.8833 --- loss: 1.217142, loss_ss: 0.917489, loss_d: 0.299653
0.9217 --- loss: 1.074702, loss_ss: 0.839383, loss_d: 0.235319
0.9601 --- loss: 1.063675, loss_ss: 0.920314, loss_d: 0.143360
0.9985 --- loss: 1.536317, loss_ss: 1.354368, loss_d: 0.181949
Epoch finished! Loss: 1.1948473556683614
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.707137, loss_ss: 0.612215, loss_d: 0.094921
0.0384 --- loss: 1.178712, loss_ss: 0.955516, loss_d: 0.223195
0.0768 --- loss: 1.091500, loss_ss: 0.822056, loss_d: 0.269445
0.1152 --- loss: 0.961088, loss_ss: 0.764268, loss_d: 0.196820
0.1536 --- loss: 0.996482, loss_ss: 0.916904, loss_d: 0.079578
0.1920 --- loss: 1.161759, loss_ss: 1.071977, loss_d: 0.089783
0.2304 --- loss: 1.208361, loss_ss: 0.887272, loss_d: 0.321089
0.2688 --- loss: 1.621333, loss_ss: 0.831642, loss_d: 0.789690
0.3072 --- loss: 1.186109, loss_ss: 0.951550, loss_d: 0.234559
0.3456 --- loss: 0.814554, loss_ss: 0.753145, loss_d: 0.061409
0.3840 --- loss: 0.863840, loss_ss: 0.815623, loss_d: 0.048217
0.4224 --- loss: 1.040093, loss_ss: 0.866910, loss_d: 0.173183
0.4608 --- loss: 1.423268, loss_ss: 0.953315, loss_d: 0.469953
0.4992 --- loss: 0.819976, loss_ss: 0.771443, loss_d: 0.048533
0.5376 --- loss: 1.358528, loss_ss: 0.918672, loss_d: 0.439857
0.5760 --- loss: 1.474705, loss_ss: 1.043569, loss_d: 0.431135
0.6144 --- loss: 1.094105, loss_ss: 0.953416, loss_d: 0.140689
0.6528 --- loss: 1.029359, loss_ss: 0.907559, loss_d: 0.121800
0.6912 --- loss: 0.886133, loss_ss: 0.832367, loss_d: 0.053766
0.7296 --- loss: 0.821614, loss_ss: 0.809553, loss_d: 0.012061
0.7680 --- loss: 1.197065, loss_ss: 1.140631, loss_d: 0.056435
0.8065 --- loss: 1.656839, loss_ss: 0.833368, loss_d: 0.823471
0.8449 --- loss: 1.300571, loss_ss: 0.838279, loss_d: 0.462292
0.8833 --- loss: 0.992431, loss_ss: 0.946407, loss_d: 0.046024
0.9217 --- loss: 1.198395, loss_ss: 0.840665, loss_d: 0.357730
0.9601 --- loss: 0.917066, loss_ss: 0.823498, loss_d: 0.093568
0.9985 --- loss: 1.150338, loss_ss: 1.024834, loss_d: 0.125503
Epoch finished! Loss: 1.1056254801841883
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.275331, loss_ss: 1.001591, loss_d: 0.273740
0.0384 --- loss: 1.099870, loss_ss: 1.013556, loss_d: 0.086314
0.0768 --- loss: 1.204842, loss_ss: 1.179688, loss_d: 0.025154
0.1152 --- loss: 1.041617, loss_ss: 0.846130, loss_d: 0.195487
0.1536 --- loss: 1.238051, loss_ss: 0.876526, loss_d: 0.361525
0.1920 --- loss: 0.888483, loss_ss: 0.823705, loss_d: 0.064778
0.2304 --- loss: 0.952907, loss_ss: 0.802226, loss_d: 0.150681
0.2688 --- loss: 1.014969, loss_ss: 0.833818, loss_d: 0.181151
0.3072 --- loss: 1.039186, loss_ss: 0.870807, loss_d: 0.168379
0.3456 --- loss: 0.886579, loss_ss: 0.810350, loss_d: 0.076229
0.3840 --- loss: 0.806418, loss_ss: 0.779364, loss_d: 0.027054
0.4224 --- loss: 0.901704, loss_ss: 0.832662, loss_d: 0.069042
0.4608 --- loss: 1.235767, loss_ss: 1.104730, loss_d: 0.131037
0.4992 --- loss: 1.316078, loss_ss: 0.669541, loss_d: 0.646536
0.5376 --- loss: 1.512124, loss_ss: 1.079823, loss_d: 0.432301
0.5760 --- loss: 1.104869, loss_ss: 0.929364, loss_d: 0.175506
0.6144 --- loss: 0.923804, loss_ss: 0.869901, loss_d: 0.053903
0.6528 --- loss: 1.065743, loss_ss: 0.925597, loss_d: 0.140146
0.6912 --- loss: 0.850303, loss_ss: 0.815443, loss_d: 0.034860
0.7296 --- loss: 0.803366, loss_ss: 0.775362, loss_d: 0.028004
0.7680 --- loss: 1.119559, loss_ss: 0.794947, loss_d: 0.324612
0.8065 --- loss: 1.079459, loss_ss: 1.008840, loss_d: 0.070619
0.8449 --- loss: 1.653293, loss_ss: 0.870860, loss_d: 0.782434
0.8833 --- loss: 0.983990, loss_ss: 0.850190, loss_d: 0.133800
0.9217 --- loss: 0.954328, loss_ss: 0.823527, loss_d: 0.130800
0.9601 --- loss: 0.840128, loss_ss: 0.781503, loss_d: 0.058625
0.9985 --- loss: 1.325834, loss_ss: 1.254684, loss_d: 0.071150
Epoch finished! Loss: 1.0706772199043861
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.113138, loss_ss: 0.905936, loss_d: 0.207203
0.0384 --- loss: 1.042550, loss_ss: 0.810270, loss_d: 0.232280
0.0768 --- loss: 1.097012, loss_ss: 1.077083, loss_d: 0.019929
0.1152 --- loss: 0.976145, loss_ss: 0.853512, loss_d: 0.122633
0.1536 --- loss: 0.807733, loss_ss: 0.771349, loss_d: 0.036384
0.1920 --- loss: 1.034766, loss_ss: 1.028875, loss_d: 0.005892
0.2304 --- loss: 0.959949, loss_ss: 0.944231, loss_d: 0.015718
0.2688 --- loss: 0.657216, loss_ss: 0.653480, loss_d: 0.003737
0.3072 --- loss: 0.686156, loss_ss: 0.625168, loss_d: 0.060988
0.3456 --- loss: 0.964439, loss_ss: 0.742922, loss_d: 0.221517
0.3840 --- loss: 0.925954, loss_ss: 0.821415, loss_d: 0.104539
0.4224 --- loss: 0.587112, loss_ss: 0.545910, loss_d: 0.041202
0.4608 --- loss: 0.866512, loss_ss: 0.819984, loss_d: 0.046528
0.4992 --- loss: 0.941176, loss_ss: 0.907797, loss_d: 0.033379
0.5376 --- loss: 0.770567, loss_ss: 0.636249, loss_d: 0.134318
0.5760 --- loss: 1.322005, loss_ss: 0.592926, loss_d: 0.729079
0.6144 --- loss: 0.552944, loss_ss: 0.488391, loss_d: 0.064553
0.6528 --- loss: 1.475008, loss_ss: 0.896534, loss_d: 0.578474
0.6912 --- loss: 1.105372, loss_ss: 0.904140, loss_d: 0.201233
0.7296 --- loss: 1.350164, loss_ss: 1.205505, loss_d: 0.144659
0.7680 --- loss: 0.861770, loss_ss: 0.719385, loss_d: 0.142384
0.8065 --- loss: 0.652249, loss_ss: 0.624202, loss_d: 0.028047
0.8449 --- loss: 1.117066, loss_ss: 0.939715, loss_d: 0.177351
0.8833 --- loss: 0.884250, loss_ss: 0.855345, loss_d: 0.028904
0.9217 --- loss: 0.958375, loss_ss: 0.903231, loss_d: 0.055143
0.9601 --- loss: 0.798298, loss_ss: 0.769266, loss_d: 0.029032
0.9985 --- loss: 0.868067, loss_ss: 0.833619, loss_d: 0.034448
Epoch finished! Loss: 0.9868141137636625
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.421433, loss_ss: 1.112337, loss_d: 0.309095
0.0384 --- loss: 1.198419, loss_ss: 0.840121, loss_d: 0.358298
0.0768 --- loss: 1.198299, loss_ss: 0.846545, loss_d: 0.351753
0.1152 --- loss: 0.933774, loss_ss: 0.684656, loss_d: 0.249118
0.1536 --- loss: 0.771713, loss_ss: 0.669168, loss_d: 0.102545
0.1920 --- loss: 0.756900, loss_ss: 0.720536, loss_d: 0.036364
0.2304 --- loss: 0.755760, loss_ss: 0.738694, loss_d: 0.017065
0.2688 --- loss: 0.843803, loss_ss: 0.757280, loss_d: 0.086523
0.3072 --- loss: 0.859216, loss_ss: 0.798940, loss_d: 0.060275
0.3456 --- loss: 0.809301, loss_ss: 0.618671, loss_d: 0.190629
0.3840 --- loss: 0.793487, loss_ss: 0.746732, loss_d: 0.046755
0.4224 --- loss: 0.650397, loss_ss: 0.609090, loss_d: 0.041307
0.4608 --- loss: 0.840197, loss_ss: 0.646748, loss_d: 0.193449
0.4992 --- loss: 1.489920, loss_ss: 0.827416, loss_d: 0.662504
0.5376 --- loss: 1.282753, loss_ss: 1.217582, loss_d: 0.065172
0.5760 --- loss: 0.857349, loss_ss: 0.826300, loss_d: 0.031050
0.6144 --- loss: 1.074158, loss_ss: 0.820939, loss_d: 0.253219
0.6528 --- loss: 0.991813, loss_ss: 0.959243, loss_d: 0.032570
0.6912 --- loss: 0.791337, loss_ss: 0.713821, loss_d: 0.077517
0.7296 --- loss: 1.023789, loss_ss: 0.479795, loss_d: 0.543995
0.7680 --- loss: 1.401103, loss_ss: 1.014228, loss_d: 0.386875
0.8065 --- loss: 1.231123, loss_ss: 0.783009, loss_d: 0.448114
0.8449 --- loss: 0.816402, loss_ss: 0.736575, loss_d: 0.079827
0.8833 --- loss: 1.093631, loss_ss: 1.047121, loss_d: 0.046510
0.9217 --- loss: 0.974245, loss_ss: 0.783195, loss_d: 0.191049
0.9601 --- loss: 0.641840, loss_ss: 0.611798, loss_d: 0.030042
0.9985 --- loss: 0.837972, loss_ss: 0.819838, loss_d: 0.018133
Epoch finished! Loss: 0.9777736677573278
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.768398, loss_ss: 0.759488, loss_d: 0.008910
0.0384 --- loss: 0.855427, loss_ss: 0.847229, loss_d: 0.008198
0.0768 --- loss: 1.162021, loss_ss: 0.772133, loss_d: 0.389888
0.1152 --- loss: 0.826437, loss_ss: 0.804159, loss_d: 0.022277
0.1536 --- loss: 0.969731, loss_ss: 0.938105, loss_d: 0.031627
0.1920 --- loss: 0.658588, loss_ss: 0.604300, loss_d: 0.054288
0.2304 --- loss: 0.854818, loss_ss: 0.834581, loss_d: 0.020237
0.2688 --- loss: 0.746334, loss_ss: 0.711500, loss_d: 0.034834
0.3072 --- loss: 1.081992, loss_ss: 1.027127, loss_d: 0.054865
0.3456 --- loss: 0.736159, loss_ss: 0.700104, loss_d: 0.036055
0.3840 --- loss: 0.668712, loss_ss: 0.651696, loss_d: 0.017017
0.4224 --- loss: 1.055279, loss_ss: 0.672476, loss_d: 0.382804
0.4608 --- loss: 0.926077, loss_ss: 0.919666, loss_d: 0.006411
0.4992 --- loss: 0.592745, loss_ss: 0.570404, loss_d: 0.022341
0.5376 --- loss: 0.856998, loss_ss: 0.824354, loss_d: 0.032645
0.5760 --- loss: 0.869047, loss_ss: 0.794611, loss_d: 0.074436
0.6144 --- loss: 0.677580, loss_ss: 0.650250, loss_d: 0.027331
0.6528 --- loss: 0.691220, loss_ss: 0.621778, loss_d: 0.069442
0.6912 --- loss: 0.792031, loss_ss: 0.716583, loss_d: 0.075447
0.7296 --- loss: 1.147069, loss_ss: 0.854997, loss_d: 0.292072
0.7680 --- loss: 0.719006, loss_ss: 0.695355, loss_d: 0.023651
0.8065 --- loss: 0.740676, loss_ss: 0.684414, loss_d: 0.056261
0.8449 --- loss: 1.038962, loss_ss: 1.027271, loss_d: 0.011692
0.8833 --- loss: 1.005923, loss_ss: 0.969044, loss_d: 0.036879
0.9217 --- loss: 0.827816, loss_ss: 0.777815, loss_d: 0.050001
0.9601 --- loss: 0.978043, loss_ss: 0.931865, loss_d: 0.046178
0.9985 --- loss: 3.203508, loss_ss: 0.651793, loss_d: 2.551716
Epoch finished! Loss: 0.9487632038501593
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6277013752455796
             precision    recall  f1-score   support

        0.0       0.63      0.61      0.62       197
        1.0       0.32      0.74      0.45       161
        2.0       0.79      0.60      0.69       348
        3.0       0.98      0.90      0.94       208
        4.0       0.50      0.01      0.02       104

avg / total       0.70      0.63      0.62      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.66  61.42   91.47  63.35     62.37
1  71.32  73.91   70.83  32.25     44.91
2  81.04  60.34   91.79  79.25     68.52
3  97.74  90.38   99.63  98.43     94.24
4  89.78   0.96   99.89  50.00      1.89
Total accuracy: 62.77%
Average sen: 57.41%
Average spec: 90.72%
Macro f1-score: 54.38%
Diagnosis acc on 15mins: 1.0
[1.         1.         1.         1.         1.         1.
 0.99999964 1.         0.9999975  1.         0.99999964 0.99999952
 0.99999988 0.99999952 1.         0.99999952 1.         1.
 1.         0.99999702 1.         0.99999857 0.99999762 0.99999559
 0.9999963  0.999892   1.         0.99999988 1.         1.
 0.9999969  1.         1.         1.        ]
pred: 0.9999961502411786, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.393899, loss_ss: 1.724751, loss_d: 0.669148
0.0384 --- loss: 2.266156, loss_ss: 1.608030, loss_d: 0.658126
0.0768 --- loss: 2.363552, loss_ss: 1.702709, loss_d: 0.660843
0.1152 --- loss: 2.308165, loss_ss: 1.534310, loss_d: 0.773855
0.1536 --- loss: 2.338093, loss_ss: 1.644871, loss_d: 0.693222
0.1920 --- loss: 2.065810, loss_ss: 1.545795, loss_d: 0.520015
0.2304 --- loss: 2.180297, loss_ss: 1.475396, loss_d: 0.704901
0.2688 --- loss: 1.851152, loss_ss: 1.446520, loss_d: 0.404631
0.3072 --- loss: 2.079499, loss_ss: 1.503647, loss_d: 0.575852
0.3456 --- loss: 2.005401, loss_ss: 1.569694, loss_d: 0.435707
0.3840 --- loss: 2.040456, loss_ss: 1.530945, loss_d: 0.509511
0.4224 --- loss: 2.090143, loss_ss: 1.451775, loss_d: 0.638369
0.4608 --- loss: 1.809497, loss_ss: 1.427267, loss_d: 0.382229
0.4992 --- loss: 1.779731, loss_ss: 1.254738, loss_d: 0.524993
0.5376 --- loss: 1.951233, loss_ss: 1.387141, loss_d: 0.564092
0.5760 --- loss: 2.003340, loss_ss: 1.346166, loss_d: 0.657175
0.6144 --- loss: 1.747794, loss_ss: 1.391572, loss_d: 0.356222
0.6528 --- loss: 1.896721, loss_ss: 1.393582, loss_d: 0.503139
0.6912 --- loss: 1.671808, loss_ss: 1.291292, loss_d: 0.380515
0.7296 --- loss: 1.613012, loss_ss: 1.240353, loss_d: 0.372660
0.7680 --- loss: 1.949076, loss_ss: 1.364645, loss_d: 0.584431
0.8065 --- loss: 1.915942, loss_ss: 1.455725, loss_d: 0.460217
0.8449 --- loss: 1.855132, loss_ss: 1.358285, loss_d: 0.496847
0.8833 --- loss: 1.816116, loss_ss: 1.527261, loss_d: 0.288855
0.9217 --- loss: 1.544732, loss_ss: 1.322738, loss_d: 0.221994
0.9601 --- loss: 1.481620, loss_ss: 1.245521, loss_d: 0.236099
0.9985 --- loss: 2.523708, loss_ss: 1.177876, loss_d: 1.345833
Epoch finished! Loss: 1.9997274009081034
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.541646, loss_ss: 1.205030, loss_d: 0.336616
0.0384 --- loss: 2.220943, loss_ss: 1.162481, loss_d: 1.058463
0.0768 --- loss: 1.680743, loss_ss: 1.262737, loss_d: 0.418006
0.1152 --- loss: 1.520614, loss_ss: 1.181961, loss_d: 0.338653
0.1536 --- loss: 1.484570, loss_ss: 1.085726, loss_d: 0.398844
0.1920 --- loss: 1.738859, loss_ss: 1.153377, loss_d: 0.585482
0.2304 --- loss: 1.507964, loss_ss: 1.173102, loss_d: 0.334863
0.2688 --- loss: 1.914367, loss_ss: 1.150657, loss_d: 0.763709
0.3072 --- loss: 1.560561, loss_ss: 1.045954, loss_d: 0.514607
0.3456 --- loss: 1.668474, loss_ss: 1.158912, loss_d: 0.509561
0.3840 --- loss: 1.319521, loss_ss: 1.124420, loss_d: 0.195102
0.4224 --- loss: 1.409218, loss_ss: 1.170359, loss_d: 0.238859
0.4608 --- loss: 1.366304, loss_ss: 1.310858, loss_d: 0.055446
0.4992 --- loss: 2.037414, loss_ss: 1.491519, loss_d: 0.545895
0.5376 --- loss: 1.363417, loss_ss: 1.086114, loss_d: 0.277304
0.5760 --- loss: 1.359803, loss_ss: 1.162274, loss_d: 0.197529
0.6144 --- loss: 1.554284, loss_ss: 1.199975, loss_d: 0.354310
0.6528 --- loss: 1.339719, loss_ss: 1.130310, loss_d: 0.209409
0.6912 --- loss: 1.447113, loss_ss: 1.245369, loss_d: 0.201743
0.7296 --- loss: 1.157121, loss_ss: 0.993134, loss_d: 0.163987
0.7680 --- loss: 1.118597, loss_ss: 0.924043, loss_d: 0.194555
0.8065 --- loss: 1.639523, loss_ss: 1.243064, loss_d: 0.396459
0.8449 --- loss: 1.233655, loss_ss: 0.940803, loss_d: 0.292852
0.8833 --- loss: 1.326866, loss_ss: 1.196905, loss_d: 0.129962
0.9217 --- loss: 1.264238, loss_ss: 1.106359, loss_d: 0.157879
0.9601 --- loss: 1.625386, loss_ss: 0.941500, loss_d: 0.683885
0.9985 --- loss: 1.509352, loss_ss: 1.074698, loss_d: 0.434654
Epoch finished! Loss: 1.500522645849448
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.137676, loss_ss: 0.910106, loss_d: 0.227570
0.0384 --- loss: 1.691293, loss_ss: 1.153646, loss_d: 0.537647
0.0768 --- loss: 1.209220, loss_ss: 0.838938, loss_d: 0.370282
0.1152 --- loss: 1.597897, loss_ss: 1.122080, loss_d: 0.475816
0.1536 --- loss: 1.237204, loss_ss: 1.016266, loss_d: 0.220938
0.1920 --- loss: 1.391901, loss_ss: 1.128758, loss_d: 0.263143
0.2304 --- loss: 1.724379, loss_ss: 0.892916, loss_d: 0.831463
0.2688 --- loss: 1.269634, loss_ss: 1.084563, loss_d: 0.185071
0.3072 --- loss: 1.216433, loss_ss: 1.101995, loss_d: 0.114439
0.3456 --- loss: 1.523253, loss_ss: 1.245377, loss_d: 0.277876
0.3840 --- loss: 1.343620, loss_ss: 1.093727, loss_d: 0.249892
0.4224 --- loss: 1.398680, loss_ss: 1.041837, loss_d: 0.356843
0.4608 --- loss: 1.435238, loss_ss: 0.787592, loss_d: 0.647646
0.4992 --- loss: 1.203292, loss_ss: 0.811774, loss_d: 0.391518
0.5376 --- loss: 1.320861, loss_ss: 1.028142, loss_d: 0.292719
0.5760 --- loss: 1.154626, loss_ss: 0.926637, loss_d: 0.227990
0.6144 --- loss: 1.698126, loss_ss: 1.214368, loss_d: 0.483758
0.6528 --- loss: 1.224163, loss_ss: 1.020478, loss_d: 0.203685
0.6912 --- loss: 1.109230, loss_ss: 1.013496, loss_d: 0.095734
0.7296 --- loss: 1.075978, loss_ss: 0.976218, loss_d: 0.099760
0.7680 --- loss: 1.315413, loss_ss: 1.244305, loss_d: 0.071108
0.8065 --- loss: 1.574306, loss_ss: 1.171222, loss_d: 0.403084
0.8449 --- loss: 1.079139, loss_ss: 0.903199, loss_d: 0.175939
0.8833 --- loss: 0.686618, loss_ss: 0.638927, loss_d: 0.047691
0.9217 --- loss: 1.273285, loss_ss: 1.113700, loss_d: 0.159585
0.9601 --- loss: 1.081785, loss_ss: 0.883119, loss_d: 0.198666
0.9985 --- loss: 1.518323, loss_ss: 0.948212, loss_d: 0.570112
Epoch finished! Loss: 1.2903165026352956
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.288753, loss_ss: 0.977499, loss_d: 0.311254
0.0384 --- loss: 1.189738, loss_ss: 0.947759, loss_d: 0.241979
0.0768 --- loss: 0.913848, loss_ss: 0.811246, loss_d: 0.102602
0.1152 --- loss: 1.291505, loss_ss: 1.110046, loss_d: 0.181459
0.1536 --- loss: 1.134344, loss_ss: 0.820810, loss_d: 0.313534
0.1920 --- loss: 1.285437, loss_ss: 0.873382, loss_d: 0.412055
0.2304 --- loss: 1.531253, loss_ss: 0.766699, loss_d: 0.764554
0.2688 --- loss: 1.479037, loss_ss: 1.103345, loss_d: 0.375692
0.3072 --- loss: 0.939161, loss_ss: 0.818164, loss_d: 0.120997
0.3456 --- loss: 1.316625, loss_ss: 1.256877, loss_d: 0.059748
0.3840 --- loss: 1.083607, loss_ss: 0.881086, loss_d: 0.202521
0.4224 --- loss: 0.999102, loss_ss: 0.715114, loss_d: 0.283988
0.4608 --- loss: 1.037959, loss_ss: 0.970715, loss_d: 0.067244
0.4992 --- loss: 1.068346, loss_ss: 1.003035, loss_d: 0.065311
0.5376 --- loss: 1.306559, loss_ss: 0.709082, loss_d: 0.597476
0.5760 --- loss: 0.977117, loss_ss: 0.870286, loss_d: 0.106831
0.6144 --- loss: 1.238879, loss_ss: 1.053776, loss_d: 0.185103
0.6528 --- loss: 1.513637, loss_ss: 1.266181, loss_d: 0.247456
0.6912 --- loss: 1.017497, loss_ss: 0.813483, loss_d: 0.204015
0.7296 --- loss: 0.883211, loss_ss: 0.766573, loss_d: 0.116638
0.7680 --- loss: 1.216039, loss_ss: 0.964343, loss_d: 0.251696
0.8065 --- loss: 0.895645, loss_ss: 0.794733, loss_d: 0.100913
0.8449 --- loss: 1.073526, loss_ss: 0.858245, loss_d: 0.215280
0.8833 --- loss: 1.177783, loss_ss: 1.041255, loss_d: 0.136528
0.9217 --- loss: 1.369131, loss_ss: 1.307010, loss_d: 0.062121
0.9601 --- loss: 1.804395, loss_ss: 0.810390, loss_d: 0.994006
0.9985 --- loss: 1.121543, loss_ss: 0.840987, loss_d: 0.280556
Epoch finished! Loss: 1.1795294903791869
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.083124, loss_ss: 0.848688, loss_d: 0.234435
0.0384 --- loss: 1.356755, loss_ss: 0.766415, loss_d: 0.590340
0.0768 --- loss: 1.041581, loss_ss: 0.892237, loss_d: 0.149345
0.1152 --- loss: 0.931435, loss_ss: 0.862810, loss_d: 0.068624
0.1536 --- loss: 0.516293, loss_ss: 0.471997, loss_d: 0.044296
0.1920 --- loss: 1.355632, loss_ss: 1.079988, loss_d: 0.275644
0.2304 --- loss: 1.139009, loss_ss: 0.912897, loss_d: 0.226111
0.2688 --- loss: 0.725591, loss_ss: 0.633037, loss_d: 0.092554
0.3072 --- loss: 1.231591, loss_ss: 0.854838, loss_d: 0.376753
0.3456 --- loss: 0.861373, loss_ss: 0.629796, loss_d: 0.231577
0.3840 --- loss: 1.016436, loss_ss: 0.843731, loss_d: 0.172705
0.4224 --- loss: 1.093797, loss_ss: 1.033420, loss_d: 0.060377
0.4608 --- loss: 1.381534, loss_ss: 1.295027, loss_d: 0.086507
0.4992 --- loss: 1.166056, loss_ss: 0.738295, loss_d: 0.427761
0.5376 --- loss: 0.791886, loss_ss: 0.646735, loss_d: 0.145151
0.5760 --- loss: 1.742276, loss_ss: 1.302448, loss_d: 0.439828
0.6144 --- loss: 0.847505, loss_ss: 0.756490, loss_d: 0.091016
0.6528 --- loss: 0.902886, loss_ss: 0.796728, loss_d: 0.106157
0.6912 --- loss: 1.497734, loss_ss: 1.222666, loss_d: 0.275068
0.7296 --- loss: 0.901659, loss_ss: 0.760226, loss_d: 0.141433
0.7680 --- loss: 1.086311, loss_ss: 1.059406, loss_d: 0.026904
0.8065 --- loss: 1.233210, loss_ss: 0.658404, loss_d: 0.574806
0.8449 --- loss: 1.105529, loss_ss: 0.947813, loss_d: 0.157716
0.8833 --- loss: 1.171211, loss_ss: 0.830981, loss_d: 0.340230
0.9217 --- loss: 0.829381, loss_ss: 0.799819, loss_d: 0.029562
0.9601 --- loss: 1.350190, loss_ss: 1.108432, loss_d: 0.241758
0.9985 --- loss: 2.972294, loss_ss: 1.580997, loss_d: 1.391297
Epoch finished! Loss: 1.118997715298946
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.334430, loss_ss: 0.841362, loss_d: 0.493068
0.0384 --- loss: 0.927058, loss_ss: 0.821840, loss_d: 0.105218
0.0768 --- loss: 0.921460, loss_ss: 0.881182, loss_d: 0.040277
0.1152 --- loss: 1.317402, loss_ss: 0.985998, loss_d: 0.331404
0.1536 --- loss: 0.880785, loss_ss: 0.771922, loss_d: 0.108863
0.1920 --- loss: 1.218845, loss_ss: 0.881658, loss_d: 0.337187
0.2304 --- loss: 0.783382, loss_ss: 0.620072, loss_d: 0.163309
0.2688 --- loss: 1.781606, loss_ss: 0.822654, loss_d: 0.958952
0.3072 --- loss: 1.112074, loss_ss: 0.741041, loss_d: 0.371034
0.3456 --- loss: 1.142102, loss_ss: 1.023647, loss_d: 0.118455
0.3840 --- loss: 1.092775, loss_ss: 0.921842, loss_d: 0.170932
0.4224 --- loss: 0.801181, loss_ss: 0.673823, loss_d: 0.127358
0.4608 --- loss: 1.268775, loss_ss: 1.216222, loss_d: 0.052553
0.4992 --- loss: 0.740312, loss_ss: 0.686154, loss_d: 0.054158
0.5376 --- loss: 1.036968, loss_ss: 0.744141, loss_d: 0.292827
0.5760 --- loss: 1.590363, loss_ss: 1.463596, loss_d: 0.126767
0.6144 --- loss: 0.848780, loss_ss: 0.748918, loss_d: 0.099861
0.6528 --- loss: 1.007719, loss_ss: 0.808652, loss_d: 0.199067
0.6912 --- loss: 1.162812, loss_ss: 0.962710, loss_d: 0.200102
0.7296 --- loss: 1.221426, loss_ss: 1.109639, loss_d: 0.111787
0.7680 --- loss: 0.950421, loss_ss: 0.873399, loss_d: 0.077022
0.8065 --- loss: 0.892958, loss_ss: 0.841414, loss_d: 0.051545
0.8449 --- loss: 0.985755, loss_ss: 0.934449, loss_d: 0.051305
0.8833 --- loss: 0.667943, loss_ss: 0.598766, loss_d: 0.069177
0.9217 --- loss: 1.272037, loss_ss: 0.969334, loss_d: 0.302702
0.9601 --- loss: 0.957372, loss_ss: 0.834674, loss_d: 0.122699
0.9985 --- loss: 1.384918, loss_ss: 1.325540, loss_d: 0.059379
Epoch finished! Loss: 1.067396640777588
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.882613, loss_ss: 0.857228, loss_d: 0.025385
0.0384 --- loss: 0.989494, loss_ss: 0.908660, loss_d: 0.080835
0.0768 --- loss: 1.158528, loss_ss: 1.087979, loss_d: 0.070550
0.1152 --- loss: 0.838441, loss_ss: 0.778394, loss_d: 0.060047
0.1536 --- loss: 0.876069, loss_ss: 0.749046, loss_d: 0.127023
0.1920 --- loss: 1.254687, loss_ss: 0.935854, loss_d: 0.318833
0.2304 --- loss: 0.747576, loss_ss: 0.644868, loss_d: 0.102708
0.2688 --- loss: 0.930171, loss_ss: 0.874954, loss_d: 0.055217
0.3072 --- loss: 0.891307, loss_ss: 0.724526, loss_d: 0.166781
0.3456 --- loss: 0.950558, loss_ss: 0.818428, loss_d: 0.132130
0.3840 --- loss: 0.895176, loss_ss: 0.741135, loss_d: 0.154041
0.4224 --- loss: 1.327009, loss_ss: 0.918113, loss_d: 0.408895
0.4608 --- loss: 1.307153, loss_ss: 0.819983, loss_d: 0.487170
0.4992 --- loss: 1.123072, loss_ss: 0.957866, loss_d: 0.165206
0.5376 --- loss: 0.699553, loss_ss: 0.665076, loss_d: 0.034477
0.5760 --- loss: 1.282887, loss_ss: 1.012033, loss_d: 0.270854
0.6144 --- loss: 0.854043, loss_ss: 0.803279, loss_d: 0.050764
0.6528 --- loss: 0.975275, loss_ss: 0.854046, loss_d: 0.121230
0.6912 --- loss: 1.169740, loss_ss: 0.940088, loss_d: 0.229652
0.7296 --- loss: 0.900147, loss_ss: 0.797511, loss_d: 0.102635
0.7680 --- loss: 1.570773, loss_ss: 1.516326, loss_d: 0.054447
0.8065 --- loss: 0.796154, loss_ss: 0.769697, loss_d: 0.026457
0.8449 --- loss: 0.881898, loss_ss: 0.789835, loss_d: 0.092063
0.8833 --- loss: 1.066783, loss_ss: 0.679060, loss_d: 0.387723
0.9217 --- loss: 1.745414, loss_ss: 0.856603, loss_d: 0.888812
0.9601 --- loss: 1.395133, loss_ss: 1.281271, loss_d: 0.113862
0.9985 --- loss: 2.221497, loss_ss: 1.089256, loss_d: 1.132241
Epoch finished! Loss: 1.0326085810477916
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.527198, loss_ss: 0.718288, loss_d: 0.808910
0.0384 --- loss: 0.966568, loss_ss: 0.763123, loss_d: 0.203444
0.0768 --- loss: 0.882013, loss_ss: 0.821829, loss_d: 0.060184
0.1152 --- loss: 0.863750, loss_ss: 0.774716, loss_d: 0.089033
0.1536 --- loss: 0.846716, loss_ss: 0.808369, loss_d: 0.038347
0.1920 --- loss: 1.141809, loss_ss: 0.619793, loss_d: 0.522016
0.2304 --- loss: 0.959492, loss_ss: 0.790271, loss_d: 0.169221
0.2688 --- loss: 1.094095, loss_ss: 1.045692, loss_d: 0.048403
0.3072 --- loss: 0.863125, loss_ss: 0.806862, loss_d: 0.056263
0.3456 --- loss: 1.094970, loss_ss: 1.045556, loss_d: 0.049413
0.3840 --- loss: 0.711505, loss_ss: 0.686427, loss_d: 0.025078
0.4224 --- loss: 0.931453, loss_ss: 0.895921, loss_d: 0.035532
0.4608 --- loss: 1.224664, loss_ss: 0.958838, loss_d: 0.265826
0.4992 --- loss: 0.873541, loss_ss: 0.786098, loss_d: 0.087443
0.5376 --- loss: 0.859599, loss_ss: 0.619638, loss_d: 0.239961
0.5760 --- loss: 1.226617, loss_ss: 0.952754, loss_d: 0.273863
0.6144 --- loss: 0.958415, loss_ss: 0.932425, loss_d: 0.025990
0.6528 --- loss: 1.228780, loss_ss: 1.144111, loss_d: 0.084669
0.6912 --- loss: 0.668972, loss_ss: 0.573809, loss_d: 0.095163
0.7296 --- loss: 0.615971, loss_ss: 0.567664, loss_d: 0.048307
0.7680 --- loss: 1.292956, loss_ss: 0.889835, loss_d: 0.403121
0.8065 --- loss: 0.800158, loss_ss: 0.759986, loss_d: 0.040172
0.8449 --- loss: 1.600221, loss_ss: 1.542802, loss_d: 0.057419
0.8833 --- loss: 1.057859, loss_ss: 0.815558, loss_d: 0.242301
0.9217 --- loss: 1.425110, loss_ss: 0.916797, loss_d: 0.508314
0.9601 --- loss: 0.842926, loss_ss: 0.676464, loss_d: 0.166462
0.9985 --- loss: 1.170618, loss_ss: 0.844761, loss_d: 0.325857
Epoch finished! Loss: 1.0159222790828117
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.299177, loss_ss: 1.258017, loss_d: 0.041160
0.0384 --- loss: 0.923785, loss_ss: 0.896231, loss_d: 0.027554
0.0768 --- loss: 0.632404, loss_ss: 0.622895, loss_d: 0.009509
0.1152 --- loss: 0.818985, loss_ss: 0.762166, loss_d: 0.056819
0.1536 --- loss: 0.950215, loss_ss: 0.792291, loss_d: 0.157925
0.1920 --- loss: 0.855600, loss_ss: 0.828398, loss_d: 0.027202
0.2304 --- loss: 1.107288, loss_ss: 1.074061, loss_d: 0.033227
0.2688 --- loss: 1.180074, loss_ss: 1.147544, loss_d: 0.032530
0.3072 --- loss: 1.047908, loss_ss: 1.007695, loss_d: 0.040213
0.3456 --- loss: 0.933277, loss_ss: 0.772453, loss_d: 0.160825
0.3840 --- loss: 0.841164, loss_ss: 0.676665, loss_d: 0.164500
0.4224 --- loss: 0.755551, loss_ss: 0.579082, loss_d: 0.176469
0.4608 --- loss: 1.204550, loss_ss: 0.606356, loss_d: 0.598195
0.4992 --- loss: 0.972119, loss_ss: 0.827228, loss_d: 0.144891
0.5376 --- loss: 0.771944, loss_ss: 0.746806, loss_d: 0.025139
0.5760 --- loss: 1.173528, loss_ss: 0.977362, loss_d: 0.196165
0.6144 --- loss: 0.967588, loss_ss: 0.793532, loss_d: 0.174055
0.6528 --- loss: 0.766116, loss_ss: 0.679019, loss_d: 0.087097
0.6912 --- loss: 0.976431, loss_ss: 0.923917, loss_d: 0.052515
0.7296 --- loss: 1.260565, loss_ss: 0.663762, loss_d: 0.596804
0.7680 --- loss: 1.108577, loss_ss: 0.981326, loss_d: 0.127251
0.8065 --- loss: 0.694651, loss_ss: 0.619562, loss_d: 0.075089
0.8449 --- loss: 1.030576, loss_ss: 0.939774, loss_d: 0.090801
0.8833 --- loss: 1.021569, loss_ss: 0.926828, loss_d: 0.094740
0.9217 --- loss: 1.054782, loss_ss: 0.807298, loss_d: 0.247484
0.9601 --- loss: 0.962414, loss_ss: 0.876611, loss_d: 0.085803
0.9985 --- loss: 2.603374, loss_ss: 0.807465, loss_d: 1.795909
Epoch finished! Loss: 0.9671277102369529
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.084562, loss_ss: 1.021987, loss_d: 0.062575
0.0384 --- loss: 1.382617, loss_ss: 0.825854, loss_d: 0.556763
0.0768 --- loss: 0.790697, loss_ss: 0.663821, loss_d: 0.126876
0.1152 --- loss: 0.755426, loss_ss: 0.670925, loss_d: 0.084501
0.1536 --- loss: 1.288640, loss_ss: 0.598730, loss_d: 0.689910
0.1920 --- loss: 1.248808, loss_ss: 1.209043, loss_d: 0.039765
0.2304 --- loss: 0.774276, loss_ss: 0.761811, loss_d: 0.012464
0.2688 --- loss: 0.951423, loss_ss: 0.896280, loss_d: 0.055143
0.3072 --- loss: 0.952496, loss_ss: 0.919019, loss_d: 0.033477
0.3456 --- loss: 1.064836, loss_ss: 1.042632, loss_d: 0.022204
0.3840 --- loss: 1.142672, loss_ss: 0.779172, loss_d: 0.363500
0.4224 --- loss: 2.276625, loss_ss: 0.870544, loss_d: 1.406081
0.4608 --- loss: 1.162736, loss_ss: 0.773286, loss_d: 0.389450
0.4992 --- loss: 1.439839, loss_ss: 1.353981, loss_d: 0.085858
0.5376 --- loss: 0.820978, loss_ss: 0.657392, loss_d: 0.163586
0.5760 --- loss: 0.980743, loss_ss: 0.940030, loss_d: 0.040713
0.6144 --- loss: 0.691896, loss_ss: 0.635163, loss_d: 0.056732
0.6528 --- loss: 0.908717, loss_ss: 0.835017, loss_d: 0.073700
0.6912 --- loss: 1.707717, loss_ss: 0.676924, loss_d: 1.030793
0.7296 --- loss: 0.956460, loss_ss: 0.829661, loss_d: 0.126799
0.7680 --- loss: 1.139458, loss_ss: 1.065575, loss_d: 0.073883
0.8065 --- loss: 1.098354, loss_ss: 0.968807, loss_d: 0.129547
0.8449 --- loss: 0.886211, loss_ss: 0.693637, loss_d: 0.192573
0.8833 --- loss: 0.905190, loss_ss: 0.752936, loss_d: 0.152254
0.9217 --- loss: 1.613731, loss_ss: 0.764110, loss_d: 0.849621
0.9601 --- loss: 0.689015, loss_ss: 0.651940, loss_d: 0.037075
0.9985 --- loss: 0.667200, loss_ss: 0.662341, loss_d: 0.004859
Epoch finished! Loss: 0.9580051811841818
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6372549019607843
             precision    recall  f1-score   support

        0.0       0.37      0.84      0.51        62
        1.0       0.44      0.18      0.26       178
        2.0       0.64      0.98      0.78       437
        3.0       0.97      0.81      0.88       102
        4.0       0.96      0.22      0.36       241

avg / total       0.70      0.64      0.58      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.39  83.87   90.81  37.14     51.49
1  81.76  17.98   95.25  44.44     25.60
2  75.98  98.17   59.35  64.41     77.79
3  97.84  81.37   99.67  96.51     88.30
4  81.47  22.41   99.74  96.43     36.36
Total accuracy: 63.73%
Average sen: 60.76%
Average spec: 88.97%
Macro f1-score: 55.91%
Diagnosis acc on 15mins: 1.0
[0.94109583 0.96007913 0.99470609 0.99232036 0.99465162 0.99985981
 0.99764305 0.99957651 0.99931765 0.99778509 0.99701619 0.99977046
 0.99903774 0.99745876 0.99939287 0.9463976  0.99780017 0.9980318
 0.99922049 0.98901105 0.99823195 0.99786478 0.99667549 0.99928349
 0.94972503 0.94553161 0.99971217 0.99790454 0.99960977 0.99822527
 0.99927634 0.99925941 0.99977702 0.99941885]
pred: 0.9906078822472516, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.185205, loss_ss: 1.519661, loss_d: 0.665545
0.0384 --- loss: 2.240366, loss_ss: 1.622912, loss_d: 0.617455
0.0769 --- loss: 2.307431, loss_ss: 1.587054, loss_d: 0.720377
0.1153 --- loss: 1.663679, loss_ss: 1.403786, loss_d: 0.259893
0.1538 --- loss: 2.281155, loss_ss: 1.597847, loss_d: 0.683309
0.1922 --- loss: 1.932957, loss_ss: 1.478279, loss_d: 0.454679
0.2307 --- loss: 2.297928, loss_ss: 1.559098, loss_d: 0.738829
0.2691 --- loss: 2.201509, loss_ss: 1.385473, loss_d: 0.816036
0.3076 --- loss: 2.338613, loss_ss: 1.522530, loss_d: 0.816084
0.3460 --- loss: 1.769963, loss_ss: 1.457735, loss_d: 0.312227
0.3845 --- loss: 2.190037, loss_ss: 1.365868, loss_d: 0.824169
0.4229 --- loss: 1.834661, loss_ss: 1.444781, loss_d: 0.389880
0.4614 --- loss: 1.996890, loss_ss: 1.398678, loss_d: 0.598212
0.4998 --- loss: 2.335270, loss_ss: 1.428522, loss_d: 0.906749
0.5383 --- loss: 1.754737, loss_ss: 1.285263, loss_d: 0.469473
0.5767 --- loss: 2.611848, loss_ss: 1.310737, loss_d: 1.301111
0.6151 --- loss: 1.936023, loss_ss: 1.319320, loss_d: 0.616702
0.6536 --- loss: 1.957861, loss_ss: 1.266497, loss_d: 0.691364
0.6920 --- loss: 1.614720, loss_ss: 1.206011, loss_d: 0.408709
0.7305 --- loss: 1.829662, loss_ss: 1.227035, loss_d: 0.602627
0.7689 --- loss: 1.730527, loss_ss: 1.334767, loss_d: 0.395760
0.8074 --- loss: 1.692867, loss_ss: 1.397874, loss_d: 0.294993
0.8458 --- loss: 1.541587, loss_ss: 1.315368, loss_d: 0.226219
0.8843 --- loss: 1.471857, loss_ss: 1.169226, loss_d: 0.302631
0.9227 --- loss: 1.874393, loss_ss: 1.424737, loss_d: 0.449656
0.9612 --- loss: 1.502729, loss_ss: 1.050768, loss_d: 0.451961
0.9996 --- loss: 1.457576, loss_ss: 1.342866, loss_d: 0.114710
Epoch finished! Loss: 1.9112763060973241
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.433520, loss_ss: 1.045678, loss_d: 0.387841
0.0384 --- loss: 1.840844, loss_ss: 1.047115, loss_d: 0.793729
0.0769 --- loss: 1.694562, loss_ss: 1.121088, loss_d: 0.573473
0.1153 --- loss: 1.896224, loss_ss: 1.059206, loss_d: 0.837018
0.1538 --- loss: 1.650726, loss_ss: 1.293570, loss_d: 0.357156
0.1922 --- loss: 1.429849, loss_ss: 1.163599, loss_d: 0.266250
0.2307 --- loss: 1.420931, loss_ss: 0.909654, loss_d: 0.511276
0.2691 --- loss: 1.710902, loss_ss: 1.096578, loss_d: 0.614324
0.3076 --- loss: 1.496796, loss_ss: 1.143543, loss_d: 0.353253
0.3460 --- loss: 1.679658, loss_ss: 1.189144, loss_d: 0.490513
0.3845 --- loss: 1.735788, loss_ss: 1.389732, loss_d: 0.346055
0.4229 --- loss: 1.383520, loss_ss: 1.187265, loss_d: 0.196255
0.4614 --- loss: 1.386713, loss_ss: 1.155100, loss_d: 0.231614
0.4998 --- loss: 1.368649, loss_ss: 1.079823, loss_d: 0.288826
0.5383 --- loss: 1.558622, loss_ss: 1.018662, loss_d: 0.539961
0.5767 --- loss: 1.246483, loss_ss: 1.121066, loss_d: 0.125417
0.6151 --- loss: 1.257298, loss_ss: 1.020652, loss_d: 0.236646
0.6536 --- loss: 1.523818, loss_ss: 1.374969, loss_d: 0.148848
0.6920 --- loss: 1.169121, loss_ss: 0.974124, loss_d: 0.194997
0.7305 --- loss: 1.538338, loss_ss: 0.851735, loss_d: 0.686603
0.7689 --- loss: 1.865052, loss_ss: 1.263817, loss_d: 0.601235
0.8074 --- loss: 1.519295, loss_ss: 1.147098, loss_d: 0.372198
0.8458 --- loss: 1.435683, loss_ss: 1.100307, loss_d: 0.335376
0.8843 --- loss: 1.343786, loss_ss: 0.985313, loss_d: 0.358472
0.9227 --- loss: 1.275301, loss_ss: 1.017264, loss_d: 0.258038
0.9612 --- loss: 0.847261, loss_ss: 0.702879, loss_d: 0.144383
0.9996 --- loss: 6.082304, loss_ss: 2.035750, loss_d: 4.046554
Epoch finished! Loss: 1.4983667275080315
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.199023, loss_ss: 0.934205, loss_d: 0.264818
0.0384 --- loss: 1.815606, loss_ss: 1.200350, loss_d: 0.615256
0.0769 --- loss: 1.315250, loss_ss: 0.837677, loss_d: 0.477573
0.1153 --- loss: 1.215476, loss_ss: 0.871410, loss_d: 0.344066
0.1538 --- loss: 1.373923, loss_ss: 1.115797, loss_d: 0.258125
0.1922 --- loss: 1.497025, loss_ss: 0.889034, loss_d: 0.607991
0.2307 --- loss: 1.294220, loss_ss: 0.971593, loss_d: 0.322627
0.2691 --- loss: 1.141223, loss_ss: 0.944467, loss_d: 0.196757
0.3076 --- loss: 1.527505, loss_ss: 0.813918, loss_d: 0.713588
0.3460 --- loss: 1.463522, loss_ss: 1.142181, loss_d: 0.321341
0.3845 --- loss: 1.110666, loss_ss: 0.951968, loss_d: 0.158698
0.4229 --- loss: 1.008389, loss_ss: 0.670760, loss_d: 0.337629
0.4614 --- loss: 1.370112, loss_ss: 0.993987, loss_d: 0.376125
0.4998 --- loss: 1.308969, loss_ss: 1.031662, loss_d: 0.277307
0.5383 --- loss: 1.271361, loss_ss: 0.908616, loss_d: 0.362746
0.5767 --- loss: 1.301627, loss_ss: 0.924420, loss_d: 0.377207
0.6151 --- loss: 1.501354, loss_ss: 1.314511, loss_d: 0.186843
0.6536 --- loss: 1.152466, loss_ss: 0.987757, loss_d: 0.164709
0.6920 --- loss: 1.332985, loss_ss: 0.959568, loss_d: 0.373417
0.7305 --- loss: 1.032004, loss_ss: 0.904481, loss_d: 0.127523
0.7689 --- loss: 1.314701, loss_ss: 0.859259, loss_d: 0.455442
0.8074 --- loss: 1.454190, loss_ss: 1.070035, loss_d: 0.384156
0.8458 --- loss: 1.251066, loss_ss: 0.947719, loss_d: 0.303347
0.8843 --- loss: 1.249948, loss_ss: 1.178013, loss_d: 0.071935
0.9227 --- loss: 0.977504, loss_ss: 0.897861, loss_d: 0.079642
0.9612 --- loss: 1.058639, loss_ss: 0.859982, loss_d: 0.198657
0.9996 --- loss: 3.311918, loss_ss: 1.404036, loss_d: 1.907882
Epoch finished! Loss: 1.3207995148805471
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.462029, loss_ss: 1.090975, loss_d: 0.371055
0.0384 --- loss: 1.215920, loss_ss: 0.853828, loss_d: 0.362091
0.0769 --- loss: 1.057983, loss_ss: 0.845027, loss_d: 0.212956
0.1153 --- loss: 1.442723, loss_ss: 1.151954, loss_d: 0.290769
0.1538 --- loss: 2.340615, loss_ss: 1.016771, loss_d: 1.323843
0.1922 --- loss: 1.138212, loss_ss: 0.894186, loss_d: 0.244026
0.2307 --- loss: 1.079660, loss_ss: 0.760693, loss_d: 0.318967
0.2691 --- loss: 1.226341, loss_ss: 1.069365, loss_d: 0.156977
0.3076 --- loss: 1.238124, loss_ss: 1.029186, loss_d: 0.208938
0.3460 --- loss: 1.059824, loss_ss: 0.899675, loss_d: 0.160148
0.3845 --- loss: 0.770355, loss_ss: 0.727465, loss_d: 0.042890
0.4229 --- loss: 1.557291, loss_ss: 0.680637, loss_d: 0.876655
0.4614 --- loss: 0.961239, loss_ss: 0.785337, loss_d: 0.175902
0.4998 --- loss: 1.069438, loss_ss: 0.831333, loss_d: 0.238105
0.5383 --- loss: 1.492949, loss_ss: 0.703130, loss_d: 0.789820
0.5767 --- loss: 1.230694, loss_ss: 0.916167, loss_d: 0.314528
0.6151 --- loss: 1.304391, loss_ss: 1.133301, loss_d: 0.171091
0.6536 --- loss: 1.109473, loss_ss: 1.048385, loss_d: 0.061089
0.6920 --- loss: 1.162354, loss_ss: 0.730740, loss_d: 0.431615
0.7305 --- loss: 1.434431, loss_ss: 0.925481, loss_d: 0.508950
0.7689 --- loss: 1.599340, loss_ss: 1.131630, loss_d: 0.467710
0.8074 --- loss: 0.915609, loss_ss: 0.703955, loss_d: 0.211654
0.8458 --- loss: 1.165195, loss_ss: 0.956148, loss_d: 0.209047
0.8843 --- loss: 1.398658, loss_ss: 1.300161, loss_d: 0.098497
0.9227 --- loss: 1.434638, loss_ss: 1.104161, loss_d: 0.330477
0.9612 --- loss: 0.819823, loss_ss: 0.752584, loss_d: 0.067239
0.9996 --- loss: 2.303484, loss_ss: 2.251457, loss_d: 0.052027
Epoch finished! Loss: 1.2324512504614316
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.246505, loss_ss: 0.999797, loss_d: 0.246707
0.0384 --- loss: 1.026842, loss_ss: 0.899832, loss_d: 0.127010
0.0769 --- loss: 1.157471, loss_ss: 1.065475, loss_d: 0.091996
0.1153 --- loss: 1.183083, loss_ss: 0.943794, loss_d: 0.239289
0.1538 --- loss: 1.069497, loss_ss: 1.001209, loss_d: 0.068288
0.1922 --- loss: 1.196914, loss_ss: 1.120264, loss_d: 0.076650
0.2307 --- loss: 1.224024, loss_ss: 1.005628, loss_d: 0.218396
0.2691 --- loss: 0.700162, loss_ss: 0.658055, loss_d: 0.042108
0.3076 --- loss: 1.017523, loss_ss: 0.849980, loss_d: 0.167543
0.3460 --- loss: 1.112904, loss_ss: 0.845489, loss_d: 0.267415
0.3845 --- loss: 1.244301, loss_ss: 1.059724, loss_d: 0.184577
0.4229 --- loss: 1.136724, loss_ss: 0.964545, loss_d: 0.172179
0.4614 --- loss: 0.935353, loss_ss: 0.833956, loss_d: 0.101397
0.4998 --- loss: 0.705538, loss_ss: 0.537467, loss_d: 0.168071
0.5383 --- loss: 0.982642, loss_ss: 0.850336, loss_d: 0.132306
0.5767 --- loss: 0.738365, loss_ss: 0.699567, loss_d: 0.038798
0.6151 --- loss: 1.384956, loss_ss: 1.042970, loss_d: 0.341987
0.6536 --- loss: 1.310992, loss_ss: 1.071595, loss_d: 0.239397
0.6920 --- loss: 0.885844, loss_ss: 0.802702, loss_d: 0.083142
0.7305 --- loss: 1.138378, loss_ss: 0.948216, loss_d: 0.190162
0.7689 --- loss: 0.820604, loss_ss: 0.742441, loss_d: 0.078163
0.8074 --- loss: 0.857534, loss_ss: 0.665177, loss_d: 0.192357
0.8458 --- loss: 1.837448, loss_ss: 1.406402, loss_d: 0.431045
0.8843 --- loss: 0.833767, loss_ss: 0.773234, loss_d: 0.060533
0.9227 --- loss: 1.280071, loss_ss: 1.101658, loss_d: 0.178413
0.9612 --- loss: 0.979364, loss_ss: 0.891039, loss_d: 0.088325
0.9996 --- loss: 1.179133, loss_ss: 1.171419, loss_d: 0.007714
Epoch finished! Loss: 1.1345845885001695
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.911866, loss_ss: 0.870302, loss_d: 0.041564
0.0384 --- loss: 1.255505, loss_ss: 0.801723, loss_d: 0.453782
0.0769 --- loss: 1.224676, loss_ss: 1.016458, loss_d: 0.208218
0.1153 --- loss: 0.781382, loss_ss: 0.595793, loss_d: 0.185589
0.1538 --- loss: 1.004674, loss_ss: 0.722154, loss_d: 0.282520
0.1922 --- loss: 1.018448, loss_ss: 0.789514, loss_d: 0.228934
0.2307 --- loss: 0.863809, loss_ss: 0.788106, loss_d: 0.075703
0.2691 --- loss: 1.137845, loss_ss: 0.985480, loss_d: 0.152364
0.3076 --- loss: 1.293651, loss_ss: 0.771445, loss_d: 0.522206
0.3460 --- loss: 0.988699, loss_ss: 0.809142, loss_d: 0.179557
0.3845 --- loss: 0.941830, loss_ss: 0.657160, loss_d: 0.284670
0.4229 --- loss: 0.827499, loss_ss: 0.792173, loss_d: 0.035326
0.4614 --- loss: 0.883416, loss_ss: 0.837563, loss_d: 0.045853
0.4998 --- loss: 0.681122, loss_ss: 0.627771, loss_d: 0.053351
0.5383 --- loss: 1.287744, loss_ss: 0.794757, loss_d: 0.492987
0.5767 --- loss: 1.337237, loss_ss: 1.061487, loss_d: 0.275750
0.6151 --- loss: 1.529094, loss_ss: 1.045121, loss_d: 0.483973
0.6536 --- loss: 0.978515, loss_ss: 0.678314, loss_d: 0.300201
0.6920 --- loss: 1.162110, loss_ss: 1.077798, loss_d: 0.084312
0.7305 --- loss: 0.809083, loss_ss: 0.741710, loss_d: 0.067373
0.7689 --- loss: 1.296520, loss_ss: 0.964453, loss_d: 0.332067
0.8074 --- loss: 0.926228, loss_ss: 0.899286, loss_d: 0.026942
0.8458 --- loss: 0.826412, loss_ss: 0.783451, loss_d: 0.042962
0.8843 --- loss: 1.287419, loss_ss: 1.231398, loss_d: 0.056021
0.9227 --- loss: 1.050644, loss_ss: 0.822189, loss_d: 0.228454
0.9612 --- loss: 1.142789, loss_ss: 0.889225, loss_d: 0.253564
0.9996 --- loss: 1.664046, loss_ss: 1.661348, loss_d: 0.002698
Epoch finished! Loss: 1.0427492072949043
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.895838, loss_ss: 0.838755, loss_d: 0.057082
0.0384 --- loss: 0.941563, loss_ss: 0.778196, loss_d: 0.163367
0.0769 --- loss: 0.918069, loss_ss: 0.908452, loss_d: 0.009616
0.1153 --- loss: 0.819651, loss_ss: 0.692885, loss_d: 0.126766
0.1538 --- loss: 1.271187, loss_ss: 0.931887, loss_d: 0.339300
0.1922 --- loss: 1.602532, loss_ss: 1.293321, loss_d: 0.309212
0.2307 --- loss: 0.948927, loss_ss: 0.734203, loss_d: 0.214723
0.2691 --- loss: 1.199268, loss_ss: 1.031162, loss_d: 0.168106
0.3076 --- loss: 1.282658, loss_ss: 0.769632, loss_d: 0.513026
0.3460 --- loss: 1.338838, loss_ss: 1.016446, loss_d: 0.322391
0.3845 --- loss: 0.711778, loss_ss: 0.663573, loss_d: 0.048205
0.4229 --- loss: 1.129854, loss_ss: 0.865039, loss_d: 0.264815
0.4614 --- loss: 0.743148, loss_ss: 0.687862, loss_d: 0.055286
0.4998 --- loss: 1.075342, loss_ss: 0.809192, loss_d: 0.266149
0.5383 --- loss: 1.624944, loss_ss: 0.918841, loss_d: 0.706103
0.5767 --- loss: 1.299912, loss_ss: 0.961015, loss_d: 0.338898
0.6151 --- loss: 1.130246, loss_ss: 0.843436, loss_d: 0.286810
0.6536 --- loss: 0.789032, loss_ss: 0.709164, loss_d: 0.079869
0.6920 --- loss: 0.822400, loss_ss: 0.737650, loss_d: 0.084750
0.7305 --- loss: 0.884361, loss_ss: 0.740116, loss_d: 0.144246
0.7689 --- loss: 1.059979, loss_ss: 0.903145, loss_d: 0.156834
0.8074 --- loss: 1.122357, loss_ss: 1.017424, loss_d: 0.104932
0.8458 --- loss: 1.212607, loss_ss: 0.711468, loss_d: 0.501139
0.8843 --- loss: 0.729566, loss_ss: 0.612252, loss_d: 0.117314
0.9227 --- loss: 1.125265, loss_ss: 0.894769, loss_d: 0.230496
0.9612 --- loss: 0.865080, loss_ss: 0.816213, loss_d: 0.048867
0.9996 --- loss: 1.352489, loss_ss: 1.339895, loss_d: 0.012594
Epoch finished! Loss: 1.050865092415076
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.931323, loss_ss: 0.847825, loss_d: 0.083498
0.0384 --- loss: 0.867840, loss_ss: 0.735497, loss_d: 0.132342
0.0769 --- loss: 0.764407, loss_ss: 0.666195, loss_d: 0.098212
0.1153 --- loss: 1.005711, loss_ss: 0.922042, loss_d: 0.083669
0.1538 --- loss: 0.732127, loss_ss: 0.718587, loss_d: 0.013540
0.1922 --- loss: 0.936362, loss_ss: 0.744643, loss_d: 0.191719
0.2307 --- loss: 0.851455, loss_ss: 0.795502, loss_d: 0.055953
0.2691 --- loss: 0.930056, loss_ss: 0.912055, loss_d: 0.018001
0.3076 --- loss: 1.034871, loss_ss: 1.022802, loss_d: 0.012070
0.3460 --- loss: 1.073084, loss_ss: 0.801111, loss_d: 0.271973
0.3845 --- loss: 0.903726, loss_ss: 0.860818, loss_d: 0.042908
0.4229 --- loss: 0.796715, loss_ss: 0.781249, loss_d: 0.015466
0.4614 --- loss: 0.869520, loss_ss: 0.816016, loss_d: 0.053505
0.4998 --- loss: 1.226776, loss_ss: 0.986391, loss_d: 0.240385
0.5383 --- loss: 0.598158, loss_ss: 0.526904, loss_d: 0.071254
0.5767 --- loss: 0.958567, loss_ss: 0.694434, loss_d: 0.264133
0.6151 --- loss: 1.081606, loss_ss: 0.930124, loss_d: 0.151482
0.6536 --- loss: 0.723430, loss_ss: 0.650621, loss_d: 0.072809
0.6920 --- loss: 0.968697, loss_ss: 0.856339, loss_d: 0.112357
0.7305 --- loss: 0.814278, loss_ss: 0.784803, loss_d: 0.029475
0.7689 --- loss: 1.172886, loss_ss: 0.904654, loss_d: 0.268232
0.8074 --- loss: 0.877037, loss_ss: 0.842330, loss_d: 0.034707
0.8458 --- loss: 0.944819, loss_ss: 0.913003, loss_d: 0.031817
0.8843 --- loss: 0.697093, loss_ss: 0.612766, loss_d: 0.084328
0.9227 --- loss: 1.085356, loss_ss: 1.053164, loss_d: 0.032192
0.9612 --- loss: 1.029965, loss_ss: 0.889438, loss_d: 0.140527
0.9996 --- loss: 6.018430, loss_ss: 0.807421, loss_d: 5.211009
Epoch finished! Loss: 0.9957800117822794
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.741083, loss_ss: 0.689278, loss_d: 0.051804
0.0384 --- loss: 1.024606, loss_ss: 0.699129, loss_d: 0.325477
0.0769 --- loss: 1.045646, loss_ss: 0.819789, loss_d: 0.225857
0.1153 --- loss: 0.869881, loss_ss: 0.690491, loss_d: 0.179390
0.1538 --- loss: 1.351704, loss_ss: 0.810862, loss_d: 0.540842
0.1922 --- loss: 1.189115, loss_ss: 0.817142, loss_d: 0.371973
0.2307 --- loss: 0.751293, loss_ss: 0.671469, loss_d: 0.079824
0.2691 --- loss: 0.789873, loss_ss: 0.669016, loss_d: 0.120857
0.3076 --- loss: 1.172392, loss_ss: 0.963371, loss_d: 0.209021
0.3460 --- loss: 1.022011, loss_ss: 0.974189, loss_d: 0.047823
0.3845 --- loss: 1.071690, loss_ss: 0.686976, loss_d: 0.384714
0.4229 --- loss: 1.473549, loss_ss: 0.991985, loss_d: 0.481564
0.4614 --- loss: 1.034137, loss_ss: 0.949877, loss_d: 0.084260
0.4998 --- loss: 1.008811, loss_ss: 0.918039, loss_d: 0.090772
0.5383 --- loss: 1.392070, loss_ss: 0.851071, loss_d: 0.540999
0.5767 --- loss: 1.121623, loss_ss: 1.062694, loss_d: 0.058929
0.6151 --- loss: 1.088938, loss_ss: 1.002545, loss_d: 0.086394
0.6536 --- loss: 0.695443, loss_ss: 0.618691, loss_d: 0.076752
0.6920 --- loss: 0.796452, loss_ss: 0.766920, loss_d: 0.029532
0.7305 --- loss: 0.775170, loss_ss: 0.747370, loss_d: 0.027800
0.7689 --- loss: 1.065116, loss_ss: 0.590201, loss_d: 0.474915
0.8074 --- loss: 0.731537, loss_ss: 0.650886, loss_d: 0.080651
0.8458 --- loss: 0.608991, loss_ss: 0.604836, loss_d: 0.004156
0.8843 --- loss: 1.131290, loss_ss: 0.830447, loss_d: 0.300843
0.9227 --- loss: 0.868840, loss_ss: 0.738718, loss_d: 0.130122
0.9612 --- loss: 0.786797, loss_ss: 0.733867, loss_d: 0.052930
0.9996 --- loss: 0.936633, loss_ss: 0.935486, loss_d: 0.001148
Epoch finished! Loss: 0.9552846798529991
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.692787, loss_ss: 0.657491, loss_d: 0.035296
0.0384 --- loss: 1.066044, loss_ss: 0.917347, loss_d: 0.148697
0.0769 --- loss: 0.778081, loss_ss: 0.735953, loss_d: 0.042129
0.1153 --- loss: 1.155703, loss_ss: 1.029599, loss_d: 0.126104
0.1538 --- loss: 1.166262, loss_ss: 1.158785, loss_d: 0.007477
0.1922 --- loss: 0.980861, loss_ss: 0.884797, loss_d: 0.096064
0.2307 --- loss: 0.570139, loss_ss: 0.510986, loss_d: 0.059153
0.2691 --- loss: 0.792241, loss_ss: 0.754959, loss_d: 0.037281
0.3076 --- loss: 0.717767, loss_ss: 0.505555, loss_d: 0.212212
0.3460 --- loss: 0.677277, loss_ss: 0.625356, loss_d: 0.051920
0.3845 --- loss: 0.869462, loss_ss: 0.837903, loss_d: 0.031559
0.4229 --- loss: 0.890295, loss_ss: 0.847922, loss_d: 0.042373
0.4614 --- loss: 1.220180, loss_ss: 1.069882, loss_d: 0.150299
0.4998 --- loss: 0.838904, loss_ss: 0.732612, loss_d: 0.106292
0.5383 --- loss: 0.708875, loss_ss: 0.697987, loss_d: 0.010888
0.5767 --- loss: 1.234777, loss_ss: 1.204839, loss_d: 0.029938
0.6151 --- loss: 1.223397, loss_ss: 0.992691, loss_d: 0.230706
0.6536 --- loss: 0.698081, loss_ss: 0.692019, loss_d: 0.006062
0.6920 --- loss: 1.035865, loss_ss: 1.006357, loss_d: 0.029509
0.7305 --- loss: 0.781944, loss_ss: 0.768656, loss_d: 0.013288
0.7689 --- loss: 0.900115, loss_ss: 0.832163, loss_d: 0.067952
0.8074 --- loss: 1.021546, loss_ss: 0.970945, loss_d: 0.050600
0.8458 --- loss: 0.903580, loss_ss: 0.818530, loss_d: 0.085049
0.8843 --- loss: 0.858014, loss_ss: 0.851012, loss_d: 0.007002
0.9227 --- loss: 0.889137, loss_ss: 0.834561, loss_d: 0.054576
0.9612 --- loss: 1.184837, loss_ss: 0.959034, loss_d: 0.225803
0.9996 --- loss: 7.698908, loss_ss: 1.100843, loss_d: 6.598065
Epoch finished! Loss: 0.9418013242574839
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5738738738738739
             precision    recall  f1-score   support

        0.0       0.20      0.58      0.30        19
        1.0       0.49      0.77      0.60       355
        2.0       0.77      0.32      0.45       376
        3.0       0.99      0.74      0.85       199
        4.0       0.45      0.54      0.49       161

avg / total       0.66      0.57      0.57      1110
 


====== chp039-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.41  57.89   96.06  20.37     30.14
1  66.67  76.62   61.99  48.66     59.52
2  73.78  31.91   95.23  77.42     45.20
3  95.23  73.87   99.89  99.32     84.73
4  83.69  54.04   88.72  44.85     49.01
Total accuracy: 57.39%
Average sen: 58.87%
Average spec: 88.38%
Macro f1-score: 53.72%
Diagnosis acc on 15mins: 1.0
[0.99999976 0.99999928 0.99959511 0.97315764 0.99998951 1.
 1.         0.99999976 0.99999809 0.99999964 1.         1.
 0.99999988 0.99998903 0.99999642 0.99716777 0.9782331  0.98780107
 0.99999475 0.99999654 0.99998474 0.99999619 0.99999988 0.99999666
 0.99997473 0.99998415 0.9999876  0.99999654 0.99999332 0.9998889
 0.99999189 0.99999964 0.99999571 0.99999928 0.99999762 0.99999845
 0.9999994 ]
pred: 0.9982622185268918, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.430789, loss_ss: 1.745033, loss_d: 0.685756
0.0384 --- loss: 2.170286, loss_ss: 1.522107, loss_d: 0.648179
0.0768 --- loss: 1.999506, loss_ss: 1.558690, loss_d: 0.440816
0.1153 --- loss: 2.000413, loss_ss: 1.638945, loss_d: 0.361469
0.1537 --- loss: 2.113155, loss_ss: 1.455478, loss_d: 0.657677
0.1921 --- loss: 2.272891, loss_ss: 1.573731, loss_d: 0.699160
0.2305 --- loss: 2.088536, loss_ss: 1.578456, loss_d: 0.510080
0.2689 --- loss: 1.646292, loss_ss: 1.336924, loss_d: 0.309368
0.3073 --- loss: 1.886852, loss_ss: 1.367032, loss_d: 0.519819
0.3458 --- loss: 1.865908, loss_ss: 1.351326, loss_d: 0.514582
0.3842 --- loss: 1.895796, loss_ss: 1.357942, loss_d: 0.537853
0.4226 --- loss: 1.882216, loss_ss: 1.275024, loss_d: 0.607192
0.4610 --- loss: 2.155864, loss_ss: 1.466678, loss_d: 0.689187
0.4994 --- loss: 1.872386, loss_ss: 1.342464, loss_d: 0.529923
0.5378 --- loss: 1.794562, loss_ss: 1.242578, loss_d: 0.551984
0.5763 --- loss: 1.618620, loss_ss: 1.141840, loss_d: 0.476780
0.6147 --- loss: 1.714049, loss_ss: 1.349641, loss_d: 0.364408
0.6531 --- loss: 1.673210, loss_ss: 1.261239, loss_d: 0.411970
0.6915 --- loss: 1.691540, loss_ss: 1.130965, loss_d: 0.560576
0.7299 --- loss: 1.937096, loss_ss: 1.251811, loss_d: 0.685285
0.7683 --- loss: 2.229743, loss_ss: 1.293205, loss_d: 0.936538
0.8068 --- loss: 1.841328, loss_ss: 1.204422, loss_d: 0.636906
0.8452 --- loss: 1.748842, loss_ss: 1.258481, loss_d: 0.490361
0.8836 --- loss: 1.533061, loss_ss: 1.145165, loss_d: 0.387896
0.9220 --- loss: 1.583991, loss_ss: 1.119368, loss_d: 0.464623
0.9604 --- loss: 1.586028, loss_ss: 1.235868, loss_d: 0.350160
0.9988 --- loss: 2.740442, loss_ss: 1.241618, loss_d: 1.498824
Epoch finished! Loss: 1.9265270063510307
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.709896, loss_ss: 1.301787, loss_d: 0.408110
0.0384 --- loss: 1.763328, loss_ss: 1.402918, loss_d: 0.360411
0.0768 --- loss: 1.508190, loss_ss: 1.228329, loss_d: 0.279861
0.1153 --- loss: 1.753479, loss_ss: 1.197026, loss_d: 0.556454
0.1537 --- loss: 1.571075, loss_ss: 1.288604, loss_d: 0.282471
0.1921 --- loss: 1.523470, loss_ss: 1.214656, loss_d: 0.308814
0.2305 --- loss: 1.733775, loss_ss: 1.276688, loss_d: 0.457087
0.2689 --- loss: 1.399379, loss_ss: 1.106031, loss_d: 0.293347
0.3073 --- loss: 1.481508, loss_ss: 1.153983, loss_d: 0.327525
0.3458 --- loss: 1.215301, loss_ss: 0.956354, loss_d: 0.258947
0.3842 --- loss: 1.376595, loss_ss: 1.200067, loss_d: 0.176528
0.4226 --- loss: 1.908137, loss_ss: 1.299563, loss_d: 0.608573
0.4610 --- loss: 1.394293, loss_ss: 1.105459, loss_d: 0.288833
0.4994 --- loss: 1.665143, loss_ss: 1.478921, loss_d: 0.186221
0.5378 --- loss: 1.625010, loss_ss: 1.361739, loss_d: 0.263271
0.5763 --- loss: 1.417412, loss_ss: 0.990957, loss_d: 0.426456
0.6147 --- loss: 1.372209, loss_ss: 1.107275, loss_d: 0.264935
0.6531 --- loss: 1.400416, loss_ss: 0.953829, loss_d: 0.446587
0.6915 --- loss: 1.622665, loss_ss: 0.928271, loss_d: 0.694394
0.7299 --- loss: 1.378882, loss_ss: 1.133038, loss_d: 0.245844
0.7683 --- loss: 1.172372, loss_ss: 1.040950, loss_d: 0.131422
0.8068 --- loss: 1.336067, loss_ss: 1.026642, loss_d: 0.309425
0.8452 --- loss: 1.539830, loss_ss: 1.234863, loss_d: 0.304967
0.8836 --- loss: 1.277055, loss_ss: 0.978554, loss_d: 0.298500
0.9220 --- loss: 1.461425, loss_ss: 1.114623, loss_d: 0.346802
0.9604 --- loss: 1.227669, loss_ss: 1.131924, loss_d: 0.095745
0.9988 --- loss: 1.753837, loss_ss: 1.337097, loss_d: 0.416740
Epoch finished! Loss: 1.4998734964774205
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.290579, loss_ss: 1.098865, loss_d: 0.191714
0.0384 --- loss: 1.030127, loss_ss: 0.844078, loss_d: 0.186049
0.0768 --- loss: 1.387207, loss_ss: 0.972013, loss_d: 0.415194
0.1153 --- loss: 1.381099, loss_ss: 1.327757, loss_d: 0.053342
0.1537 --- loss: 2.059376, loss_ss: 0.935988, loss_d: 1.123389
0.1921 --- loss: 1.592207, loss_ss: 1.145220, loss_d: 0.446987
0.2305 --- loss: 1.513017, loss_ss: 0.969056, loss_d: 0.543961
0.2689 --- loss: 1.482863, loss_ss: 1.191781, loss_d: 0.291081
0.3073 --- loss: 1.074015, loss_ss: 0.984592, loss_d: 0.089423
0.3458 --- loss: 1.151987, loss_ss: 0.950473, loss_d: 0.201515
0.3842 --- loss: 0.905489, loss_ss: 0.852167, loss_d: 0.053322
0.4226 --- loss: 1.826008, loss_ss: 0.927992, loss_d: 0.898016
0.4610 --- loss: 1.155362, loss_ss: 0.870880, loss_d: 0.284483
0.4994 --- loss: 1.400145, loss_ss: 1.111912, loss_d: 0.288232
0.5378 --- loss: 1.329753, loss_ss: 0.851927, loss_d: 0.477825
0.5763 --- loss: 1.195892, loss_ss: 0.961946, loss_d: 0.233946
0.6147 --- loss: 1.287003, loss_ss: 1.138119, loss_d: 0.148884
0.6531 --- loss: 1.235082, loss_ss: 0.899407, loss_d: 0.335674
0.6915 --- loss: 1.163830, loss_ss: 1.059763, loss_d: 0.104067
0.7299 --- loss: 0.988187, loss_ss: 0.884800, loss_d: 0.103388
0.7683 --- loss: 1.575330, loss_ss: 0.853499, loss_d: 0.721831
0.8068 --- loss: 1.398260, loss_ss: 1.304619, loss_d: 0.093640
0.8452 --- loss: 1.175719, loss_ss: 1.028868, loss_d: 0.146851
0.8836 --- loss: 0.953950, loss_ss: 0.718560, loss_d: 0.235389
0.9220 --- loss: 1.076154, loss_ss: 0.806189, loss_d: 0.269964
0.9604 --- loss: 1.028937, loss_ss: 0.808266, loss_d: 0.220671
0.9988 --- loss: 2.051227, loss_ss: 0.769760, loss_d: 1.281467
Epoch finished! Loss: 1.29914621756627
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.890526, loss_ss: 0.826083, loss_d: 0.064443
0.0384 --- loss: 1.220335, loss_ss: 1.152744, loss_d: 0.067591
0.0768 --- loss: 1.364547, loss_ss: 1.222775, loss_d: 0.141772
0.1153 --- loss: 1.286480, loss_ss: 1.190629, loss_d: 0.095851
0.1537 --- loss: 1.371216, loss_ss: 0.978562, loss_d: 0.392655
0.1921 --- loss: 0.862421, loss_ss: 0.825756, loss_d: 0.036665
0.2305 --- loss: 0.935591, loss_ss: 0.852949, loss_d: 0.082643
0.2689 --- loss: 1.236622, loss_ss: 1.087066, loss_d: 0.149556
0.3073 --- loss: 1.226882, loss_ss: 1.013298, loss_d: 0.213584
0.3458 --- loss: 1.024397, loss_ss: 0.759767, loss_d: 0.264630
0.3842 --- loss: 1.162163, loss_ss: 0.887306, loss_d: 0.274857
0.4226 --- loss: 0.955317, loss_ss: 0.877181, loss_d: 0.078136
0.4610 --- loss: 0.854410, loss_ss: 0.746406, loss_d: 0.108004
0.4994 --- loss: 1.136370, loss_ss: 0.921435, loss_d: 0.214934
0.5378 --- loss: 0.907210, loss_ss: 0.698747, loss_d: 0.208464
0.5763 --- loss: 0.860972, loss_ss: 0.703698, loss_d: 0.157274
0.6147 --- loss: 1.196052, loss_ss: 0.818955, loss_d: 0.377097
0.6531 --- loss: 1.375155, loss_ss: 1.050715, loss_d: 0.324441
0.6915 --- loss: 1.154196, loss_ss: 1.068574, loss_d: 0.085622
0.7299 --- loss: 1.556645, loss_ss: 0.966677, loss_d: 0.589968
0.7683 --- loss: 1.096413, loss_ss: 0.968277, loss_d: 0.128136
0.8068 --- loss: 1.806923, loss_ss: 1.604897, loss_d: 0.202026
0.8452 --- loss: 0.983094, loss_ss: 0.756121, loss_d: 0.226973
0.8836 --- loss: 1.278950, loss_ss: 0.925198, loss_d: 0.353752
0.9220 --- loss: 1.232325, loss_ss: 0.999242, loss_d: 0.233083
0.9604 --- loss: 1.149881, loss_ss: 0.968211, loss_d: 0.181670
0.9988 --- loss: 2.547297, loss_ss: 1.363268, loss_d: 1.184029
Epoch finished! Loss: 1.1778587627869386
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.437587, loss_ss: 1.281155, loss_d: 0.156432
0.0384 --- loss: 1.326338, loss_ss: 0.882673, loss_d: 0.443665
0.0768 --- loss: 1.091265, loss_ss: 0.809179, loss_d: 0.282087
0.1153 --- loss: 1.131288, loss_ss: 0.996098, loss_d: 0.135190
0.1537 --- loss: 1.156796, loss_ss: 0.986778, loss_d: 0.170018
0.1921 --- loss: 1.324407, loss_ss: 0.989057, loss_d: 0.335349
0.2305 --- loss: 1.120340, loss_ss: 0.913027, loss_d: 0.207314
0.2689 --- loss: 1.104531, loss_ss: 0.872424, loss_d: 0.232106
0.3073 --- loss: 1.088741, loss_ss: 0.783572, loss_d: 0.305169
0.3458 --- loss: 1.191796, loss_ss: 0.915625, loss_d: 0.276171
0.3842 --- loss: 1.026964, loss_ss: 0.879888, loss_d: 0.147076
0.4226 --- loss: 1.610782, loss_ss: 0.889164, loss_d: 0.721618
0.4610 --- loss: 0.862107, loss_ss: 0.671994, loss_d: 0.190113
0.4994 --- loss: 0.971004, loss_ss: 0.947781, loss_d: 0.023223
0.5378 --- loss: 0.996857, loss_ss: 0.829073, loss_d: 0.167784
0.5763 --- loss: 0.889850, loss_ss: 0.830944, loss_d: 0.058906
0.6147 --- loss: 0.954987, loss_ss: 0.727398, loss_d: 0.227588
0.6531 --- loss: 1.826443, loss_ss: 0.715619, loss_d: 1.110824
0.6915 --- loss: 0.950423, loss_ss: 0.892905, loss_d: 0.057518
0.7299 --- loss: 0.841393, loss_ss: 0.824465, loss_d: 0.016928
0.7683 --- loss: 0.958379, loss_ss: 0.907094, loss_d: 0.051285
0.8068 --- loss: 0.761556, loss_ss: 0.732039, loss_d: 0.029517
0.8452 --- loss: 0.937083, loss_ss: 0.898357, loss_d: 0.038726
0.8836 --- loss: 1.012416, loss_ss: 0.935094, loss_d: 0.077322
0.9220 --- loss: 1.479297, loss_ss: 1.134359, loss_d: 0.344938
0.9604 --- loss: 0.945309, loss_ss: 0.914235, loss_d: 0.031074
0.9988 --- loss: 1.550928, loss_ss: 1.522735, loss_d: 0.028193
Epoch finished! Loss: 1.113543544595058
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.837332, loss_ss: 0.797673, loss_d: 0.039659
0.0384 --- loss: 1.232149, loss_ss: 1.032747, loss_d: 0.199402
0.0768 --- loss: 1.456913, loss_ss: 1.180570, loss_d: 0.276344
0.1153 --- loss: 0.874580, loss_ss: 0.805845, loss_d: 0.068735
0.1537 --- loss: 1.314470, loss_ss: 1.009232, loss_d: 0.305238
0.1921 --- loss: 0.933381, loss_ss: 0.873159, loss_d: 0.060223
0.2305 --- loss: 0.807656, loss_ss: 0.663257, loss_d: 0.144399
0.2689 --- loss: 1.044516, loss_ss: 0.972677, loss_d: 0.071839
0.3073 --- loss: 1.216992, loss_ss: 1.050784, loss_d: 0.166208
0.3458 --- loss: 0.883852, loss_ss: 0.832407, loss_d: 0.051445
0.3842 --- loss: 1.149327, loss_ss: 1.084141, loss_d: 0.065186
0.4226 --- loss: 0.814700, loss_ss: 0.736927, loss_d: 0.077773
0.4610 --- loss: 1.146632, loss_ss: 1.109481, loss_d: 0.037152
0.4994 --- loss: 0.770536, loss_ss: 0.760638, loss_d: 0.009898
0.5378 --- loss: 1.069568, loss_ss: 0.714778, loss_d: 0.354790
0.5763 --- loss: 1.040914, loss_ss: 0.784385, loss_d: 0.256529
0.6147 --- loss: 1.320549, loss_ss: 0.883731, loss_d: 0.436819
0.6531 --- loss: 0.951463, loss_ss: 0.904150, loss_d: 0.047314
0.6915 --- loss: 0.764880, loss_ss: 0.629144, loss_d: 0.135736
0.7299 --- loss: 0.751412, loss_ss: 0.617660, loss_d: 0.133753
0.7683 --- loss: 1.060429, loss_ss: 0.784938, loss_d: 0.275490
0.8068 --- loss: 0.961190, loss_ss: 0.814987, loss_d: 0.146203
0.8452 --- loss: 0.999169, loss_ss: 0.978731, loss_d: 0.020438
0.8836 --- loss: 0.872547, loss_ss: 0.772114, loss_d: 0.100433
0.9220 --- loss: 0.984905, loss_ss: 0.934570, loss_d: 0.050335
0.9604 --- loss: 1.099415, loss_ss: 1.047036, loss_d: 0.052379
0.9988 --- loss: 1.077689, loss_ss: 1.051126, loss_d: 0.026564
Epoch finished! Loss: 1.032271951666245
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.828496, loss_ss: 0.770974, loss_d: 0.057522
0.0384 --- loss: 0.897831, loss_ss: 0.873752, loss_d: 0.024079
0.0768 --- loss: 0.740301, loss_ss: 0.691086, loss_d: 0.049215
0.1153 --- loss: 1.194570, loss_ss: 0.716130, loss_d: 0.478440
0.1537 --- loss: 1.480746, loss_ss: 0.871166, loss_d: 0.609580
0.1921 --- loss: 1.520882, loss_ss: 0.860943, loss_d: 0.659939
0.2305 --- loss: 0.891025, loss_ss: 0.763707, loss_d: 0.127319
0.2689 --- loss: 1.210333, loss_ss: 1.166940, loss_d: 0.043393
0.3073 --- loss: 0.997294, loss_ss: 0.818316, loss_d: 0.178978
0.3458 --- loss: 0.815545, loss_ss: 0.791375, loss_d: 0.024169
0.3842 --- loss: 0.674737, loss_ss: 0.642148, loss_d: 0.032589
0.4226 --- loss: 0.838315, loss_ss: 0.790065, loss_d: 0.048250
0.4610 --- loss: 0.765777, loss_ss: 0.749322, loss_d: 0.016455
0.4994 --- loss: 1.008117, loss_ss: 0.998869, loss_d: 0.009248
0.5378 --- loss: 1.165653, loss_ss: 1.069773, loss_d: 0.095880
0.5763 --- loss: 0.829772, loss_ss: 0.810008, loss_d: 0.019764
0.6147 --- loss: 1.705471, loss_ss: 1.463581, loss_d: 0.241890
0.6531 --- loss: 0.790208, loss_ss: 0.689994, loss_d: 0.100214
0.6915 --- loss: 1.643143, loss_ss: 1.492076, loss_d: 0.151066
0.7299 --- loss: 1.513067, loss_ss: 1.329539, loss_d: 0.183528
0.7683 --- loss: 1.154587, loss_ss: 1.067455, loss_d: 0.087132
0.8068 --- loss: 0.906483, loss_ss: 0.866362, loss_d: 0.040121
0.8452 --- loss: 0.976947, loss_ss: 0.877226, loss_d: 0.099721
0.8836 --- loss: 0.997936, loss_ss: 0.934465, loss_d: 0.063471
0.9220 --- loss: 1.245692, loss_ss: 0.869491, loss_d: 0.376200
0.9604 --- loss: 1.022238, loss_ss: 0.766792, loss_d: 0.255445
0.9988 --- loss: 1.071703, loss_ss: 0.858369, loss_d: 0.213334
Epoch finished! Loss: 1.036789489021668
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.935744, loss_ss: 0.912572, loss_d: 0.023172
0.0384 --- loss: 0.951216, loss_ss: 0.894555, loss_d: 0.056661
0.0768 --- loss: 0.972656, loss_ss: 0.894296, loss_d: 0.078360
0.1153 --- loss: 1.178569, loss_ss: 0.966775, loss_d: 0.211794
0.1537 --- loss: 0.840605, loss_ss: 0.807545, loss_d: 0.033061
0.1921 --- loss: 1.483510, loss_ss: 1.356040, loss_d: 0.127470
0.2305 --- loss: 0.832169, loss_ss: 0.640855, loss_d: 0.191314
0.2689 --- loss: 0.825753, loss_ss: 0.725290, loss_d: 0.100463
0.3073 --- loss: 0.993456, loss_ss: 0.935131, loss_d: 0.058325
0.3458 --- loss: 0.864505, loss_ss: 0.829704, loss_d: 0.034801
0.3842 --- loss: 0.831547, loss_ss: 0.811632, loss_d: 0.019914
0.4226 --- loss: 2.740613, loss_ss: 0.919324, loss_d: 1.821288
0.4610 --- loss: 1.063429, loss_ss: 0.944347, loss_d: 0.119082
0.4994 --- loss: 0.928230, loss_ss: 0.775668, loss_d: 0.152562
0.5378 --- loss: 0.797399, loss_ss: 0.774447, loss_d: 0.022952
0.5763 --- loss: 1.068728, loss_ss: 1.040403, loss_d: 0.028326
0.6147 --- loss: 1.069180, loss_ss: 0.868869, loss_d: 0.200311
0.6531 --- loss: 0.873757, loss_ss: 0.815105, loss_d: 0.058651
0.6915 --- loss: 0.925638, loss_ss: 0.868819, loss_d: 0.056820
0.7299 --- loss: 1.191999, loss_ss: 1.151008, loss_d: 0.040990
0.7683 --- loss: 0.954080, loss_ss: 0.615760, loss_d: 0.338320
0.8068 --- loss: 1.740904, loss_ss: 1.182128, loss_d: 0.558777
0.8452 --- loss: 0.836700, loss_ss: 0.824041, loss_d: 0.012659
0.8836 --- loss: 1.136432, loss_ss: 0.973785, loss_d: 0.162647
0.9220 --- loss: 0.796038, loss_ss: 0.788051, loss_d: 0.007986
0.9604 --- loss: 0.825672, loss_ss: 0.818426, loss_d: 0.007246
0.9988 --- loss: 3.460553, loss_ss: 0.945809, loss_d: 2.514744
Epoch finished! Loss: 0.9982196427308596
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.593584, loss_ss: 0.579055, loss_d: 0.014529
0.0384 --- loss: 0.818503, loss_ss: 0.758304, loss_d: 0.060199
0.0768 --- loss: 1.167442, loss_ss: 0.980714, loss_d: 0.186728
0.1153 --- loss: 0.916125, loss_ss: 0.768086, loss_d: 0.148039
0.1537 --- loss: 0.870811, loss_ss: 0.825782, loss_d: 0.045029
0.1921 --- loss: 0.933657, loss_ss: 0.830330, loss_d: 0.103327
0.2305 --- loss: 1.096321, loss_ss: 1.043227, loss_d: 0.053094
0.2689 --- loss: 1.777086, loss_ss: 0.852556, loss_d: 0.924530
0.3073 --- loss: 0.965974, loss_ss: 0.690967, loss_d: 0.275007
0.3458 --- loss: 0.721762, loss_ss: 0.680955, loss_d: 0.040808
0.3842 --- loss: 1.022607, loss_ss: 1.014661, loss_d: 0.007946
0.4226 --- loss: 0.922868, loss_ss: 0.883774, loss_d: 0.039094
0.4610 --- loss: 0.694805, loss_ss: 0.654832, loss_d: 0.039973
0.4994 --- loss: 0.918102, loss_ss: 0.905366, loss_d: 0.012736
0.5378 --- loss: 0.758254, loss_ss: 0.742535, loss_d: 0.015718
0.5763 --- loss: 0.844877, loss_ss: 0.830998, loss_d: 0.013879
0.6147 --- loss: 0.657864, loss_ss: 0.606370, loss_d: 0.051494
0.6531 --- loss: 0.608933, loss_ss: 0.575235, loss_d: 0.033698
0.6915 --- loss: 1.343188, loss_ss: 1.304155, loss_d: 0.039033
0.7299 --- loss: 1.048695, loss_ss: 1.008177, loss_d: 0.040518
0.7683 --- loss: 0.962705, loss_ss: 0.922767, loss_d: 0.039938
0.8068 --- loss: 0.712874, loss_ss: 0.585558, loss_d: 0.127316
0.8452 --- loss: 1.068400, loss_ss: 1.009672, loss_d: 0.058728
0.8836 --- loss: 1.056209, loss_ss: 1.015099, loss_d: 0.041110
0.9220 --- loss: 0.941069, loss_ss: 0.902070, loss_d: 0.038999
0.9604 --- loss: 0.877713, loss_ss: 0.702724, loss_d: 0.174989
0.9988 --- loss: 1.278473, loss_ss: 0.706630, loss_d: 0.571843
Epoch finished! Loss: 0.9589356993253414
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.083372, loss_ss: 0.741868, loss_d: 0.341504
0.0384 --- loss: 0.821841, loss_ss: 0.805769, loss_d: 0.016071
0.0768 --- loss: 0.857053, loss_ss: 0.785754, loss_d: 0.071299
0.1153 --- loss: 0.657318, loss_ss: 0.647685, loss_d: 0.009633
0.1537 --- loss: 0.707525, loss_ss: 0.655666, loss_d: 0.051858
0.1921 --- loss: 0.857997, loss_ss: 0.847622, loss_d: 0.010376
0.2305 --- loss: 0.613341, loss_ss: 0.595256, loss_d: 0.018085
0.2689 --- loss: 0.704757, loss_ss: 0.691004, loss_d: 0.013753
0.3073 --- loss: 0.973563, loss_ss: 0.954584, loss_d: 0.018979
0.3458 --- loss: 0.746967, loss_ss: 0.733513, loss_d: 0.013453
0.3842 --- loss: 0.902314, loss_ss: 0.882694, loss_d: 0.019620
0.4226 --- loss: 0.993914, loss_ss: 0.799299, loss_d: 0.194615
0.4610 --- loss: 1.023826, loss_ss: 1.003732, loss_d: 0.020093
0.4994 --- loss: 0.722136, loss_ss: 0.695135, loss_d: 0.027001
0.5378 --- loss: 0.974725, loss_ss: 0.850249, loss_d: 0.124476
0.5763 --- loss: 0.762794, loss_ss: 0.752290, loss_d: 0.010505
0.6147 --- loss: 0.780696, loss_ss: 0.765144, loss_d: 0.015551
0.6531 --- loss: 1.614379, loss_ss: 0.664490, loss_d: 0.949888
0.6915 --- loss: 1.150793, loss_ss: 0.909445, loss_d: 0.241348
0.7299 --- loss: 1.079324, loss_ss: 0.985126, loss_d: 0.094198
0.7683 --- loss: 1.067845, loss_ss: 1.054204, loss_d: 0.013641
0.8068 --- loss: 0.801117, loss_ss: 0.772006, loss_d: 0.029110
0.8452 --- loss: 0.669402, loss_ss: 0.620934, loss_d: 0.048468
0.8836 --- loss: 1.010801, loss_ss: 0.967427, loss_d: 0.043375
0.9220 --- loss: 0.778444, loss_ss: 0.769056, loss_d: 0.009388
0.9604 --- loss: 0.764419, loss_ss: 0.757660, loss_d: 0.006758
0.9988 --- loss: 1.670515, loss_ss: 1.638883, loss_d: 0.031631
Epoch finished! Loss: 0.9441285445139959
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7438095238095238
             precision    recall  f1-score   support

        0.0       0.84      0.78      0.81       163
        1.0       0.52      0.30      0.38       142
        2.0       0.83      0.77      0.80       329
        3.0       0.81      0.90      0.85       200
        4.0       0.62      0.83      0.71       216

avg / total       0.74      0.74      0.73      1050
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.19  77.91   97.18  83.55     80.63
1  86.76  30.28   95.59  51.81     38.22
2  87.90  76.60   93.07  83.44     79.87
3  94.00  89.50   95.06  81.00     85.04
4  85.90  83.33   86.57  61.64     70.87
Total accuracy: 74.38%
Average sen: 71.52%
Average spec: 93.49%
Macro f1-score: 70.93%
Diagnosis acc on 15mins: 1.0
[0.98361766 0.99452567 0.95741564 0.78536594 0.93068588 0.72540456
 0.91239154 0.90968949 0.97287703 0.96123606 0.90436602 0.57248497
 0.92481029 0.80013782 0.96484107 0.90174282 0.83669567 0.83897263
 0.65794355 0.88433397 0.91143858 0.83689165 0.92175728 0.93812889
 0.86378241 0.58628672 0.87313038 0.79603177 0.77809584 0.95722598
 0.83202821 0.92058581 0.54465574 0.62029064 0.54220849]
pred: 0.8383450474057879, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.399870, loss_ss: 1.688848, loss_d: 0.711022
0.0384 --- loss: 2.315079, loss_ss: 1.530274, loss_d: 0.784805
0.0769 --- loss: 2.124214, loss_ss: 1.470707, loss_d: 0.653507
0.1153 --- loss: 2.075450, loss_ss: 1.301087, loss_d: 0.774363
0.1537 --- loss: 1.868177, loss_ss: 1.370563, loss_d: 0.497614
0.1922 --- loss: 1.828990, loss_ss: 1.249756, loss_d: 0.579234
0.2306 --- loss: 1.901063, loss_ss: 1.243780, loss_d: 0.657282
0.2690 --- loss: 2.078428, loss_ss: 1.397943, loss_d: 0.680484
0.3075 --- loss: 1.600251, loss_ss: 1.132107, loss_d: 0.468144
0.3459 --- loss: 1.634982, loss_ss: 1.197780, loss_d: 0.437203
0.3843 --- loss: 1.662483, loss_ss: 1.197731, loss_d: 0.464752
0.4228 --- loss: 1.821924, loss_ss: 1.266336, loss_d: 0.555588
0.4612 --- loss: 1.959753, loss_ss: 1.432356, loss_d: 0.527396
0.4996 --- loss: 1.514467, loss_ss: 1.150952, loss_d: 0.363515
0.5380 --- loss: 1.636828, loss_ss: 1.263938, loss_d: 0.372890
0.5765 --- loss: 1.522100, loss_ss: 1.042028, loss_d: 0.480072
0.6149 --- loss: 1.715742, loss_ss: 1.248136, loss_d: 0.467606
0.6533 --- loss: 2.035174, loss_ss: 1.494246, loss_d: 0.540927
0.6918 --- loss: 1.735912, loss_ss: 1.076972, loss_d: 0.658940
0.7302 --- loss: 1.691771, loss_ss: 1.182615, loss_d: 0.509155
0.7686 --- loss: 1.514674, loss_ss: 1.131675, loss_d: 0.382999
0.8071 --- loss: 1.511022, loss_ss: 1.072960, loss_d: 0.438062
0.8455 --- loss: 1.833385, loss_ss: 1.357878, loss_d: 0.475507
0.8839 --- loss: 1.697983, loss_ss: 1.257598, loss_d: 0.440385
0.9224 --- loss: 1.519179, loss_ss: 1.165507, loss_d: 0.353672
0.9608 --- loss: 1.380402, loss_ss: 1.077254, loss_d: 0.303148
0.9992 --- loss: 2.139882, loss_ss: 1.705957, loss_d: 0.433925
Epoch finished! Loss: 1.8332673302063576
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.568914, loss_ss: 1.215170, loss_d: 0.353745
0.0384 --- loss: 1.444910, loss_ss: 1.188346, loss_d: 0.256564
0.0769 --- loss: 1.508777, loss_ss: 1.103137, loss_d: 0.405640
0.1153 --- loss: 1.483402, loss_ss: 0.975621, loss_d: 0.507781
0.1537 --- loss: 1.137965, loss_ss: 0.922176, loss_d: 0.215790
0.1922 --- loss: 1.494455, loss_ss: 1.261238, loss_d: 0.233217
0.2306 --- loss: 1.287737, loss_ss: 1.041116, loss_d: 0.246621
0.2690 --- loss: 1.728270, loss_ss: 1.476599, loss_d: 0.251671
0.3075 --- loss: 1.524423, loss_ss: 1.219085, loss_d: 0.305338
0.3459 --- loss: 1.196621, loss_ss: 1.006900, loss_d: 0.189721
0.3843 --- loss: 1.762363, loss_ss: 1.098941, loss_d: 0.663422
0.4228 --- loss: 1.484049, loss_ss: 1.150139, loss_d: 0.333910
0.4612 --- loss: 1.486932, loss_ss: 1.253382, loss_d: 0.233549
0.4996 --- loss: 1.427279, loss_ss: 1.328984, loss_d: 0.098295
0.5380 --- loss: 1.704342, loss_ss: 1.403350, loss_d: 0.300992
0.5765 --- loss: 1.633477, loss_ss: 0.967237, loss_d: 0.666240
0.6149 --- loss: 1.598913, loss_ss: 1.070534, loss_d: 0.528379
0.6533 --- loss: 1.992220, loss_ss: 1.157730, loss_d: 0.834490
0.6918 --- loss: 1.841594, loss_ss: 0.949795, loss_d: 0.891799
0.7302 --- loss: 1.748389, loss_ss: 1.267633, loss_d: 0.480755
0.7686 --- loss: 1.332966, loss_ss: 1.030426, loss_d: 0.302540
0.8071 --- loss: 1.593509, loss_ss: 1.265235, loss_d: 0.328274
0.8455 --- loss: 1.250614, loss_ss: 1.010094, loss_d: 0.240520
0.8839 --- loss: 1.356793, loss_ss: 1.100309, loss_d: 0.256485
0.9224 --- loss: 1.363247, loss_ss: 1.057223, loss_d: 0.306023
0.9608 --- loss: 2.158395, loss_ss: 1.234575, loss_d: 0.923820
0.9992 --- loss: 1.745276, loss_ss: 1.421290, loss_d: 0.323986
Epoch finished! Loss: 1.4934537124175291
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.334803, loss_ss: 1.172260, loss_d: 0.162543
0.0384 --- loss: 1.643438, loss_ss: 1.061025, loss_d: 0.582413
0.0769 --- loss: 1.372498, loss_ss: 0.931079, loss_d: 0.441419
0.1153 --- loss: 2.144690, loss_ss: 1.442714, loss_d: 0.701976
0.1537 --- loss: 1.271333, loss_ss: 0.994129, loss_d: 0.277204
0.1922 --- loss: 1.137184, loss_ss: 1.013996, loss_d: 0.123189
0.2306 --- loss: 1.306052, loss_ss: 1.113740, loss_d: 0.192312
0.2690 --- loss: 1.699879, loss_ss: 1.044667, loss_d: 0.655212
0.3075 --- loss: 1.052690, loss_ss: 0.971553, loss_d: 0.081137
0.3459 --- loss: 1.601093, loss_ss: 1.006696, loss_d: 0.594396
0.3843 --- loss: 1.175205, loss_ss: 1.000912, loss_d: 0.174293
0.4228 --- loss: 1.472126, loss_ss: 0.909393, loss_d: 0.562733
0.4612 --- loss: 1.225103, loss_ss: 0.961296, loss_d: 0.263807
0.4996 --- loss: 1.190118, loss_ss: 0.817120, loss_d: 0.372998
0.5380 --- loss: 1.176565, loss_ss: 0.945714, loss_d: 0.230851
0.5765 --- loss: 1.049628, loss_ss: 0.908852, loss_d: 0.140776
0.6149 --- loss: 1.157798, loss_ss: 1.036912, loss_d: 0.120886
0.6533 --- loss: 1.109880, loss_ss: 0.968256, loss_d: 0.141625
0.6918 --- loss: 2.320041, loss_ss: 0.916498, loss_d: 1.403543
0.7302 --- loss: 1.211313, loss_ss: 1.069273, loss_d: 0.142040
0.7686 --- loss: 1.160552, loss_ss: 0.777080, loss_d: 0.383472
0.8071 --- loss: 1.071298, loss_ss: 0.841635, loss_d: 0.229664
0.8455 --- loss: 1.352262, loss_ss: 0.841747, loss_d: 0.510515
0.8839 --- loss: 1.038305, loss_ss: 0.876591, loss_d: 0.161714
0.9224 --- loss: 1.318611, loss_ss: 1.002140, loss_d: 0.316471
0.9608 --- loss: 1.290025, loss_ss: 1.037642, loss_d: 0.252383
0.9992 --- loss: 1.059556, loss_ss: 1.027293, loss_d: 0.032263
Epoch finished! Loss: 1.3162824683464491
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.202754, loss_ss: 0.935780, loss_d: 0.266974
0.0384 --- loss: 1.494356, loss_ss: 0.968285, loss_d: 0.526071
0.0769 --- loss: 1.158278, loss_ss: 0.924785, loss_d: 0.233493
0.1153 --- loss: 0.972586, loss_ss: 0.832116, loss_d: 0.140470
0.1537 --- loss: 0.966140, loss_ss: 0.885074, loss_d: 0.081066
0.1922 --- loss: 1.496716, loss_ss: 0.833127, loss_d: 0.663589
0.2306 --- loss: 1.143798, loss_ss: 1.127508, loss_d: 0.016290
0.2690 --- loss: 1.243275, loss_ss: 0.957406, loss_d: 0.285869
0.3075 --- loss: 1.024851, loss_ss: 0.826512, loss_d: 0.198339
0.3459 --- loss: 1.400332, loss_ss: 1.055795, loss_d: 0.344537
0.3843 --- loss: 0.875878, loss_ss: 0.801963, loss_d: 0.073915
0.4228 --- loss: 1.324382, loss_ss: 1.124080, loss_d: 0.200302
0.4612 --- loss: 1.255445, loss_ss: 0.913621, loss_d: 0.341824
0.4996 --- loss: 1.391607, loss_ss: 1.050422, loss_d: 0.341185
0.5380 --- loss: 1.343115, loss_ss: 0.957504, loss_d: 0.385611
0.5765 --- loss: 0.858765, loss_ss: 0.806887, loss_d: 0.051879
0.6149 --- loss: 0.987630, loss_ss: 0.720348, loss_d: 0.267281
0.6533 --- loss: 1.322957, loss_ss: 0.872949, loss_d: 0.450008
0.6918 --- loss: 0.978483, loss_ss: 0.840541, loss_d: 0.137942
0.7302 --- loss: 1.031994, loss_ss: 0.900136, loss_d: 0.131858
0.7686 --- loss: 1.177790, loss_ss: 0.872567, loss_d: 0.305223
0.8071 --- loss: 1.206321, loss_ss: 1.108747, loss_d: 0.097573
0.8455 --- loss: 0.914073, loss_ss: 0.828976, loss_d: 0.085097
0.8839 --- loss: 1.162795, loss_ss: 0.918341, loss_d: 0.244454
0.9224 --- loss: 0.994554, loss_ss: 0.807602, loss_d: 0.186951
0.9608 --- loss: 0.945146, loss_ss: 0.763844, loss_d: 0.181302
0.9992 --- loss: 2.860130, loss_ss: 1.819958, loss_d: 1.040173
Epoch finished! Loss: 1.2200982811359258
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.549268, loss_ss: 0.873201, loss_d: 0.676067
0.0384 --- loss: 0.933785, loss_ss: 0.767753, loss_d: 0.166032
0.0769 --- loss: 0.987483, loss_ss: 0.806502, loss_d: 0.180981
0.1153 --- loss: 0.997578, loss_ss: 0.720666, loss_d: 0.276912
0.1537 --- loss: 1.176419, loss_ss: 1.085129, loss_d: 0.091291
0.1922 --- loss: 0.868773, loss_ss: 0.828193, loss_d: 0.040580
0.2306 --- loss: 1.470543, loss_ss: 0.799040, loss_d: 0.671503
0.2690 --- loss: 1.393284, loss_ss: 1.172998, loss_d: 0.220286
0.3075 --- loss: 1.050555, loss_ss: 0.819165, loss_d: 0.231391
0.3459 --- loss: 0.919972, loss_ss: 0.749255, loss_d: 0.170717
0.3843 --- loss: 1.303176, loss_ss: 0.829740, loss_d: 0.473436
0.4228 --- loss: 1.096951, loss_ss: 1.023611, loss_d: 0.073340
0.4612 --- loss: 1.032930, loss_ss: 0.923116, loss_d: 0.109814
0.4996 --- loss: 1.060673, loss_ss: 0.776346, loss_d: 0.284326
0.5380 --- loss: 1.066654, loss_ss: 0.984795, loss_d: 0.081859
0.5765 --- loss: 1.247937, loss_ss: 1.154364, loss_d: 0.093573
0.6149 --- loss: 0.987699, loss_ss: 0.865729, loss_d: 0.121970
0.6533 --- loss: 1.095583, loss_ss: 0.769017, loss_d: 0.326567
0.6918 --- loss: 1.196579, loss_ss: 0.924729, loss_d: 0.271849
0.7302 --- loss: 0.779112, loss_ss: 0.765940, loss_d: 0.013172
0.7686 --- loss: 0.944832, loss_ss: 0.682111, loss_d: 0.262721
0.8071 --- loss: 1.071605, loss_ss: 0.794979, loss_d: 0.276626
0.8455 --- loss: 1.404647, loss_ss: 1.263857, loss_d: 0.140790
0.8839 --- loss: 1.009280, loss_ss: 0.931349, loss_d: 0.077932
0.9224 --- loss: 1.514837, loss_ss: 1.123341, loss_d: 0.391497
0.9608 --- loss: 1.756614, loss_ss: 1.199687, loss_d: 0.556927
0.9992 --- loss: 1.660354, loss_ss: 1.582278, loss_d: 0.078076
Epoch finished! Loss: 1.1295848252681586
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.024087, loss_ss: 0.783346, loss_d: 0.240741
0.0384 --- loss: 1.256142, loss_ss: 0.873078, loss_d: 0.383064
0.0769 --- loss: 1.285324, loss_ss: 1.141727, loss_d: 0.143598
0.1153 --- loss: 1.123321, loss_ss: 0.831003, loss_d: 0.292318
0.1537 --- loss: 1.097301, loss_ss: 0.715879, loss_d: 0.381422
0.1922 --- loss: 1.052565, loss_ss: 0.990857, loss_d: 0.061708
0.2306 --- loss: 0.911584, loss_ss: 0.810096, loss_d: 0.101488
0.2690 --- loss: 1.340062, loss_ss: 1.110719, loss_d: 0.229343
0.3075 --- loss: 0.818468, loss_ss: 0.664377, loss_d: 0.154091
0.3459 --- loss: 1.218676, loss_ss: 1.047771, loss_d: 0.170905
0.3843 --- loss: 1.244146, loss_ss: 1.062074, loss_d: 0.182073
0.4228 --- loss: 1.464560, loss_ss: 1.356285, loss_d: 0.108275
0.4612 --- loss: 0.744451, loss_ss: 0.712451, loss_d: 0.031999
0.4996 --- loss: 1.011617, loss_ss: 0.908557, loss_d: 0.103060
0.5380 --- loss: 1.196532, loss_ss: 0.935756, loss_d: 0.260776
0.5765 --- loss: 0.943564, loss_ss: 0.837120, loss_d: 0.106444
0.6149 --- loss: 1.170831, loss_ss: 0.927547, loss_d: 0.243284
0.6533 --- loss: 1.547307, loss_ss: 0.860139, loss_d: 0.687169
0.6918 --- loss: 1.124770, loss_ss: 0.901585, loss_d: 0.223186
0.7302 --- loss: 1.258994, loss_ss: 1.082726, loss_d: 0.176268
0.7686 --- loss: 1.600176, loss_ss: 1.041446, loss_d: 0.558729
0.8071 --- loss: 0.848504, loss_ss: 0.760918, loss_d: 0.087586
0.8455 --- loss: 1.120348, loss_ss: 0.926841, loss_d: 0.193507
0.8839 --- loss: 1.065926, loss_ss: 1.023855, loss_d: 0.042070
0.9224 --- loss: 1.101044, loss_ss: 0.906231, loss_d: 0.194813
0.9608 --- loss: 1.003327, loss_ss: 0.965344, loss_d: 0.037983
0.9992 --- loss: 4.123693, loss_ss: 2.292807, loss_d: 1.830886
Epoch finished! Loss: 1.1122833112111459
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.760103, loss_ss: 0.640613, loss_d: 0.119491
0.0384 --- loss: 2.094418, loss_ss: 0.757284, loss_d: 1.337134
0.0769 --- loss: 1.114746, loss_ss: 0.941084, loss_d: 0.173662
0.1153 --- loss: 1.039861, loss_ss: 1.005558, loss_d: 0.034303
0.1537 --- loss: 0.968660, loss_ss: 0.917933, loss_d: 0.050727
0.1922 --- loss: 1.285137, loss_ss: 1.246946, loss_d: 0.038192
0.2306 --- loss: 1.075670, loss_ss: 0.924760, loss_d: 0.150910
0.2690 --- loss: 1.014645, loss_ss: 0.762366, loss_d: 0.252278
0.3075 --- loss: 0.758119, loss_ss: 0.729372, loss_d: 0.028747
0.3459 --- loss: 0.906766, loss_ss: 0.819097, loss_d: 0.087669
0.3843 --- loss: 1.067156, loss_ss: 0.914374, loss_d: 0.152783
0.4228 --- loss: 0.834201, loss_ss: 0.777823, loss_d: 0.056377
0.4612 --- loss: 1.074738, loss_ss: 0.676262, loss_d: 0.398475
0.4996 --- loss: 0.746918, loss_ss: 0.690965, loss_d: 0.055953
0.5380 --- loss: 1.251889, loss_ss: 0.665534, loss_d: 0.586354
0.5765 --- loss: 1.045564, loss_ss: 0.814196, loss_d: 0.231368
0.6149 --- loss: 0.885307, loss_ss: 0.772584, loss_d: 0.112723
0.6533 --- loss: 0.635469, loss_ss: 0.539203, loss_d: 0.096266
0.6918 --- loss: 1.097769, loss_ss: 0.950440, loss_d: 0.147329
0.7302 --- loss: 0.717676, loss_ss: 0.681004, loss_d: 0.036672
0.7686 --- loss: 0.878468, loss_ss: 0.678393, loss_d: 0.200075
0.8071 --- loss: 0.876608, loss_ss: 0.862132, loss_d: 0.014476
0.8455 --- loss: 1.386035, loss_ss: 1.065838, loss_d: 0.320197
0.8839 --- loss: 1.000892, loss_ss: 0.972447, loss_d: 0.028444
0.9224 --- loss: 1.206586, loss_ss: 0.840088, loss_d: 0.366498
0.9608 --- loss: 1.511364, loss_ss: 0.820762, loss_d: 0.690601
0.9992 --- loss: 2.945379, loss_ss: 2.562528, loss_d: 0.382851
Epoch finished! Loss: 1.0415074751927302
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.207330, loss_ss: 0.892919, loss_d: 0.314411
0.0384 --- loss: 1.623158, loss_ss: 1.604360, loss_d: 0.018798
0.0769 --- loss: 0.896811, loss_ss: 0.784968, loss_d: 0.111843
0.1153 --- loss: 0.947753, loss_ss: 0.875075, loss_d: 0.072678
0.1537 --- loss: 0.867142, loss_ss: 0.645954, loss_d: 0.221188
0.1922 --- loss: 1.175657, loss_ss: 1.018741, loss_d: 0.156915
0.2306 --- loss: 1.058684, loss_ss: 0.830414, loss_d: 0.228270
0.2690 --- loss: 1.002196, loss_ss: 0.839282, loss_d: 0.162913
0.3075 --- loss: 0.767492, loss_ss: 0.625464, loss_d: 0.142028
0.3459 --- loss: 0.935376, loss_ss: 0.915146, loss_d: 0.020230
0.3843 --- loss: 1.138447, loss_ss: 1.125084, loss_d: 0.013363
0.4228 --- loss: 1.245422, loss_ss: 1.081148, loss_d: 0.164274
0.4612 --- loss: 0.994336, loss_ss: 0.967814, loss_d: 0.026521
0.4996 --- loss: 0.745359, loss_ss: 0.715926, loss_d: 0.029432
0.5380 --- loss: 0.816077, loss_ss: 0.790435, loss_d: 0.025642
0.5765 --- loss: 0.930312, loss_ss: 0.877270, loss_d: 0.053042
0.6149 --- loss: 0.570794, loss_ss: 0.517821, loss_d: 0.052974
0.6533 --- loss: 0.969523, loss_ss: 0.809802, loss_d: 0.159721
0.6918 --- loss: 1.537147, loss_ss: 1.115896, loss_d: 0.421251
0.7302 --- loss: 0.794152, loss_ss: 0.714156, loss_d: 0.079996
0.7686 --- loss: 1.244973, loss_ss: 0.820991, loss_d: 0.423981
0.8071 --- loss: 1.658095, loss_ss: 0.868917, loss_d: 0.789178
0.8455 --- loss: 1.038662, loss_ss: 0.930107, loss_d: 0.108555
0.8839 --- loss: 1.560909, loss_ss: 1.503066, loss_d: 0.057842
0.9224 --- loss: 1.041578, loss_ss: 0.887106, loss_d: 0.154471
0.9608 --- loss: 0.984104, loss_ss: 0.972779, loss_d: 0.011324
0.9992 --- loss: 1.440560, loss_ss: 0.912371, loss_d: 0.528189
Epoch finished! Loss: 1.0089894473552703
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.795559, loss_ss: 0.783245, loss_d: 0.012314
0.0384 --- loss: 0.683234, loss_ss: 0.597865, loss_d: 0.085369
0.0769 --- loss: 2.107187, loss_ss: 1.320817, loss_d: 0.786370
0.1153 --- loss: 1.079214, loss_ss: 1.045418, loss_d: 0.033797
0.1537 --- loss: 0.892805, loss_ss: 0.883442, loss_d: 0.009363
0.1922 --- loss: 0.962052, loss_ss: 0.900916, loss_d: 0.061136
0.2306 --- loss: 1.852783, loss_ss: 0.927165, loss_d: 0.925618
0.2690 --- loss: 1.145802, loss_ss: 1.007266, loss_d: 0.138536
0.3075 --- loss: 1.083109, loss_ss: 0.886766, loss_d: 0.196343
0.3459 --- loss: 1.021377, loss_ss: 0.897750, loss_d: 0.123627
0.3843 --- loss: 1.099452, loss_ss: 1.072044, loss_d: 0.027407
0.4228 --- loss: 0.819073, loss_ss: 0.809513, loss_d: 0.009560
0.4612 --- loss: 1.216358, loss_ss: 0.740997, loss_d: 0.475361
0.4996 --- loss: 0.763965, loss_ss: 0.758482, loss_d: 0.005483
0.5380 --- loss: 1.002288, loss_ss: 0.964952, loss_d: 0.037335
0.5765 --- loss: 1.176008, loss_ss: 1.050382, loss_d: 0.125625
0.6149 --- loss: 0.888263, loss_ss: 0.863448, loss_d: 0.024815
0.6533 --- loss: 0.847785, loss_ss: 0.709156, loss_d: 0.138629
0.6918 --- loss: 0.712586, loss_ss: 0.528197, loss_d: 0.184389
0.7302 --- loss: 0.987320, loss_ss: 0.888577, loss_d: 0.098743
0.7686 --- loss: 0.928993, loss_ss: 0.639910, loss_d: 0.289082
0.8071 --- loss: 0.516199, loss_ss: 0.510371, loss_d: 0.005828
0.8455 --- loss: 0.899944, loss_ss: 0.878658, loss_d: 0.021286
0.8839 --- loss: 0.697605, loss_ss: 0.647144, loss_d: 0.050461
0.9224 --- loss: 0.822935, loss_ss: 0.777386, loss_d: 0.045549
0.9608 --- loss: 1.258849, loss_ss: 0.904373, loss_d: 0.354476
0.9992 --- loss: 0.734061, loss_ss: 0.724759, loss_d: 0.009302
Epoch finished! Loss: 0.9594014583871915
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.093564, loss_ss: 0.989417, loss_d: 0.104147
0.0384 --- loss: 1.156347, loss_ss: 0.940368, loss_d: 0.215979
0.0769 --- loss: 0.688348, loss_ss: 0.681168, loss_d: 0.007180
0.1153 --- loss: 1.450985, loss_ss: 1.116186, loss_d: 0.334799
0.1537 --- loss: 1.039453, loss_ss: 1.009366, loss_d: 0.030087
0.1922 --- loss: 0.788470, loss_ss: 0.775514, loss_d: 0.012957
0.2306 --- loss: 1.212035, loss_ss: 1.207325, loss_d: 0.004710
0.2690 --- loss: 1.103786, loss_ss: 1.088199, loss_d: 0.015587
0.3075 --- loss: 0.936776, loss_ss: 0.889804, loss_d: 0.046972
0.3459 --- loss: 0.582754, loss_ss: 0.573433, loss_d: 0.009321
0.3843 --- loss: 0.904727, loss_ss: 0.869109, loss_d: 0.035617
0.4228 --- loss: 1.138742, loss_ss: 1.099466, loss_d: 0.039275
0.4612 --- loss: 0.982156, loss_ss: 0.801370, loss_d: 0.180786
0.4996 --- loss: 1.128120, loss_ss: 1.100582, loss_d: 0.027538
0.5380 --- loss: 0.739982, loss_ss: 0.520231, loss_d: 0.219751
0.5765 --- loss: 1.182354, loss_ss: 0.934699, loss_d: 0.247655
0.6149 --- loss: 0.717583, loss_ss: 0.659624, loss_d: 0.057959
0.6533 --- loss: 0.739727, loss_ss: 0.723004, loss_d: 0.016723
0.6918 --- loss: 0.921192, loss_ss: 0.625065, loss_d: 0.296126
0.7302 --- loss: 0.788643, loss_ss: 0.762527, loss_d: 0.026116
0.7686 --- loss: 0.842060, loss_ss: 0.730971, loss_d: 0.111090
0.8071 --- loss: 0.949504, loss_ss: 0.525123, loss_d: 0.424381
0.8455 --- loss: 0.901777, loss_ss: 0.790330, loss_d: 0.111447
0.8839 --- loss: 0.920310, loss_ss: 0.882412, loss_d: 0.037899
0.9224 --- loss: 0.641619, loss_ss: 0.583453, loss_d: 0.058166
0.9608 --- loss: 1.070530, loss_ss: 0.940738, loss_d: 0.129792
0.9992 --- loss: 2.470004, loss_ss: 2.469388, loss_d: 0.000615
Epoch finished! Loss: 0.9258710438242326
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.662962962962963
             precision    recall  f1-score   support

        0.0       0.88      0.31      0.46       196
        1.0       0.11      0.47      0.17        58
        2.0       0.94      0.74      0.83       527
        3.0       0.52      0.94      0.67        33
        4.0       0.73      0.77      0.75       266

avg / total       0.82      0.66      0.70      1080
 


====== chp041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.76  31.12   99.10  88.41     46.04
1  76.02  46.55   77.69  10.59     17.25
2  85.19  74.19   95.66  94.22     83.01
3  97.13  93.94   97.23  51.67     66.67
4  87.50  77.44   90.79  73.31     75.32
Total accuracy: 66.30%
Average sen: 64.65%
Average spec: 92.09%
Macro f1-score: 57.66%
Diagnosis acc on 15mins: 0.9444444444444444
[0.99999678 0.94724303 0.02345496 0.98309189 0.99984062 0.9998104
 0.99997425 0.99996996 0.99999189 0.995197   0.99685967 0.91435331
 0.99287218 0.98601252 0.4829638  0.8841784  0.9998104  0.99998093
 0.99999845 0.99323177 0.99068463 0.99913305 0.99906009 0.8322956
 0.92798996 0.99999714 0.99995339 0.99995601 0.99995387 0.99119675
 0.96329004 0.76919663 0.9995029  0.99194807 0.99997282 0.99925083]
pred: 0.9350614993729525, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.434513, loss_ss: 1.764757, loss_d: 0.669756
0.0384 --- loss: 2.298790, loss_ss: 1.506961, loss_d: 0.791829
0.0769 --- loss: 1.851013, loss_ss: 1.410800, loss_d: 0.440213
0.1153 --- loss: 1.839925, loss_ss: 1.451347, loss_d: 0.388578
0.1538 --- loss: 1.972938, loss_ss: 1.460894, loss_d: 0.512043
0.1922 --- loss: 2.319240, loss_ss: 1.502408, loss_d: 0.816832
0.2307 --- loss: 1.968331, loss_ss: 1.330277, loss_d: 0.638054
0.2691 --- loss: 2.031770, loss_ss: 1.541329, loss_d: 0.490441
0.3076 --- loss: 2.114106, loss_ss: 1.459444, loss_d: 0.654662
0.3460 --- loss: 1.973711, loss_ss: 1.480252, loss_d: 0.493460
0.3845 --- loss: 2.050047, loss_ss: 1.440766, loss_d: 0.609282
0.4229 --- loss: 1.804155, loss_ss: 1.199651, loss_d: 0.604504
0.4614 --- loss: 1.759167, loss_ss: 1.299834, loss_d: 0.459332
0.4998 --- loss: 1.862189, loss_ss: 1.384914, loss_d: 0.477275
0.5383 --- loss: 1.695917, loss_ss: 1.360714, loss_d: 0.335203
0.5767 --- loss: 2.113956, loss_ss: 1.417475, loss_d: 0.696481
0.6151 --- loss: 1.854949, loss_ss: 1.250985, loss_d: 0.603964
0.6536 --- loss: 2.151878, loss_ss: 1.240795, loss_d: 0.911083
0.6920 --- loss: 2.159355, loss_ss: 1.399857, loss_d: 0.759498
0.7305 --- loss: 1.840587, loss_ss: 1.320263, loss_d: 0.520324
0.7689 --- loss: 1.623947, loss_ss: 1.268857, loss_d: 0.355089
0.8074 --- loss: 1.547739, loss_ss: 1.164477, loss_d: 0.383262
0.8458 --- loss: 1.602145, loss_ss: 1.153989, loss_d: 0.448155
0.8843 --- loss: 1.824198, loss_ss: 1.424933, loss_d: 0.399265
0.9227 --- loss: 1.611717, loss_ss: 1.186143, loss_d: 0.425574
0.9612 --- loss: 1.804470, loss_ss: 1.162320, loss_d: 0.642150
0.9996 --- loss: 2.367317, loss_ss: 2.001109, loss_d: 0.366208
Epoch finished! Loss: 1.9258248365842379
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.847816, loss_ss: 1.230770, loss_d: 0.617046
0.0384 --- loss: 1.481636, loss_ss: 1.111072, loss_d: 0.370564
0.0769 --- loss: 1.730974, loss_ss: 1.330175, loss_d: 0.400799
0.1153 --- loss: 1.932593, loss_ss: 1.323806, loss_d: 0.608787
0.1538 --- loss: 1.727217, loss_ss: 1.250425, loss_d: 0.476792
0.1922 --- loss: 1.518092, loss_ss: 1.231738, loss_d: 0.286353
0.2307 --- loss: 1.481156, loss_ss: 1.003581, loss_d: 0.477575
0.2691 --- loss: 1.573838, loss_ss: 1.112906, loss_d: 0.460932
0.3076 --- loss: 1.755561, loss_ss: 1.142109, loss_d: 0.613452
0.3460 --- loss: 1.496620, loss_ss: 1.233988, loss_d: 0.262632
0.3845 --- loss: 1.381853, loss_ss: 1.126651, loss_d: 0.255202
0.4229 --- loss: 1.495585, loss_ss: 0.949237, loss_d: 0.546347
0.4614 --- loss: 1.304106, loss_ss: 1.220918, loss_d: 0.083188
0.4998 --- loss: 1.560951, loss_ss: 1.217018, loss_d: 0.343933
0.5383 --- loss: 1.332627, loss_ss: 0.971041, loss_d: 0.361586
0.5767 --- loss: 1.423869, loss_ss: 1.111824, loss_d: 0.312045
0.6151 --- loss: 1.320051, loss_ss: 1.104790, loss_d: 0.215262
0.6536 --- loss: 1.116351, loss_ss: 0.876460, loss_d: 0.239891
0.6920 --- loss: 1.373235, loss_ss: 1.209158, loss_d: 0.164077
0.7305 --- loss: 1.695493, loss_ss: 1.351430, loss_d: 0.344064
0.7689 --- loss: 1.625569, loss_ss: 1.124810, loss_d: 0.500759
0.8074 --- loss: 1.319022, loss_ss: 1.189467, loss_d: 0.129556
0.8458 --- loss: 1.671372, loss_ss: 1.049723, loss_d: 0.621649
0.8843 --- loss: 1.419247, loss_ss: 1.125983, loss_d: 0.293264
0.9227 --- loss: 1.220626, loss_ss: 1.104316, loss_d: 0.116310
0.9612 --- loss: 1.696209, loss_ss: 1.203662, loss_d: 0.492547
0.9996 --- loss: 4.565344, loss_ss: 1.853503, loss_d: 2.711841
Epoch finished! Loss: 1.5418488410802988
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.358152, loss_ss: 0.950187, loss_d: 0.407965
0.0384 --- loss: 1.891596, loss_ss: 1.576045, loss_d: 0.315552
0.0769 --- loss: 1.490236, loss_ss: 1.267501, loss_d: 0.222734
0.1153 --- loss: 1.266140, loss_ss: 1.011044, loss_d: 0.255096
0.1538 --- loss: 1.383884, loss_ss: 1.097664, loss_d: 0.286220
0.1922 --- loss: 1.110641, loss_ss: 0.968362, loss_d: 0.142279
0.2307 --- loss: 1.698391, loss_ss: 1.192038, loss_d: 0.506353
0.2691 --- loss: 1.550982, loss_ss: 1.273720, loss_d: 0.277262
0.3076 --- loss: 1.376403, loss_ss: 1.219235, loss_d: 0.157168
0.3460 --- loss: 1.087079, loss_ss: 0.831542, loss_d: 0.255537
0.3845 --- loss: 1.716340, loss_ss: 1.170050, loss_d: 0.546290
0.4229 --- loss: 0.941208, loss_ss: 0.709165, loss_d: 0.232043
0.4614 --- loss: 1.474774, loss_ss: 1.125793, loss_d: 0.348980
0.4998 --- loss: 1.708776, loss_ss: 1.104004, loss_d: 0.604773
0.5383 --- loss: 1.182714, loss_ss: 0.895900, loss_d: 0.286814
0.5767 --- loss: 0.955391, loss_ss: 0.886577, loss_d: 0.068814
0.6151 --- loss: 1.362663, loss_ss: 0.918561, loss_d: 0.444102
0.6536 --- loss: 1.178835, loss_ss: 1.027894, loss_d: 0.150942
0.6920 --- loss: 1.803578, loss_ss: 1.290180, loss_d: 0.513398
0.7305 --- loss: 1.342865, loss_ss: 1.142816, loss_d: 0.200049
0.7689 --- loss: 1.167681, loss_ss: 0.985604, loss_d: 0.182077
0.8074 --- loss: 1.446550, loss_ss: 1.101979, loss_d: 0.344571
0.8458 --- loss: 1.363558, loss_ss: 0.962103, loss_d: 0.401454
0.8843 --- loss: 1.256638, loss_ss: 1.077713, loss_d: 0.178924
0.9227 --- loss: 1.581975, loss_ss: 0.945008, loss_d: 0.636967
0.9612 --- loss: 1.180436, loss_ss: 1.034272, loss_d: 0.146164
0.9996 --- loss: 1.943816, loss_ss: 1.894087, loss_d: 0.049729
Epoch finished! Loss: 1.3727956735170805
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.681036, loss_ss: 1.195691, loss_d: 0.485345
0.0384 --- loss: 1.001988, loss_ss: 0.896836, loss_d: 0.105152
0.0769 --- loss: 1.347810, loss_ss: 1.144530, loss_d: 0.203281
0.1153 --- loss: 1.400743, loss_ss: 1.175086, loss_d: 0.225657
0.1538 --- loss: 1.042992, loss_ss: 0.808329, loss_d: 0.234663
0.1922 --- loss: 2.148265, loss_ss: 0.998661, loss_d: 1.149605
0.2307 --- loss: 1.106670, loss_ss: 0.765519, loss_d: 0.341150
0.2691 --- loss: 0.895307, loss_ss: 0.761454, loss_d: 0.133854
0.3076 --- loss: 1.385645, loss_ss: 1.001245, loss_d: 0.384400
0.3460 --- loss: 1.177003, loss_ss: 0.893354, loss_d: 0.283649
0.3845 --- loss: 1.692568, loss_ss: 1.533018, loss_d: 0.159551
0.4229 --- loss: 1.368840, loss_ss: 1.164249, loss_d: 0.204590
0.4614 --- loss: 0.976244, loss_ss: 0.742190, loss_d: 0.234054
0.4998 --- loss: 1.058649, loss_ss: 0.920985, loss_d: 0.137664
0.5383 --- loss: 1.101828, loss_ss: 0.931175, loss_d: 0.170653
0.5767 --- loss: 1.177107, loss_ss: 0.903181, loss_d: 0.273926
0.6151 --- loss: 1.355893, loss_ss: 1.152321, loss_d: 0.203572
0.6536 --- loss: 1.632362, loss_ss: 1.066852, loss_d: 0.565511
0.6920 --- loss: 0.978448, loss_ss: 0.911847, loss_d: 0.066602
0.7305 --- loss: 1.476308, loss_ss: 0.798955, loss_d: 0.677353
0.7689 --- loss: 1.397603, loss_ss: 1.176923, loss_d: 0.220679
0.8074 --- loss: 1.039644, loss_ss: 0.893911, loss_d: 0.145733
0.8458 --- loss: 0.950517, loss_ss: 0.662265, loss_d: 0.288253
0.8843 --- loss: 1.242552, loss_ss: 1.056093, loss_d: 0.186459
0.9227 --- loss: 1.124400, loss_ss: 1.051281, loss_d: 0.073119
0.9612 --- loss: 1.076255, loss_ss: 0.886829, loss_d: 0.189426
0.9996 --- loss: 4.744810, loss_ss: 1.056095, loss_d: 3.688715
Epoch finished! Loss: 1.2904470219061925
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.604784, loss_ss: 1.222780, loss_d: 0.382004
0.0384 --- loss: 1.231787, loss_ss: 1.075578, loss_d: 0.156209
0.0769 --- loss: 1.392441, loss_ss: 1.165136, loss_d: 0.227304
0.1153 --- loss: 1.700008, loss_ss: 1.307652, loss_d: 0.392357
0.1538 --- loss: 1.284247, loss_ss: 1.026999, loss_d: 0.257248
0.1922 --- loss: 0.992014, loss_ss: 0.952626, loss_d: 0.039388
0.2307 --- loss: 1.807433, loss_ss: 1.202873, loss_d: 0.604560
0.2691 --- loss: 0.842569, loss_ss: 0.699885, loss_d: 0.142683
0.3076 --- loss: 1.422954, loss_ss: 1.188351, loss_d: 0.234603
0.3460 --- loss: 1.226220, loss_ss: 1.051089, loss_d: 0.175131
0.3845 --- loss: 1.279232, loss_ss: 1.108558, loss_d: 0.170675
0.4229 --- loss: 1.091927, loss_ss: 0.773272, loss_d: 0.318655
0.4614 --- loss: 1.260399, loss_ss: 1.031229, loss_d: 0.229170
0.4998 --- loss: 0.735403, loss_ss: 0.671734, loss_d: 0.063669
0.5383 --- loss: 1.222381, loss_ss: 0.997509, loss_d: 0.224872
0.5767 --- loss: 1.002102, loss_ss: 0.789240, loss_d: 0.212863
0.6151 --- loss: 1.160147, loss_ss: 1.089494, loss_d: 0.070652
0.6536 --- loss: 1.431650, loss_ss: 1.083002, loss_d: 0.348648
0.6920 --- loss: 0.984015, loss_ss: 0.816588, loss_d: 0.167427
0.7305 --- loss: 1.819457, loss_ss: 0.764827, loss_d: 1.054630
0.7689 --- loss: 1.754836, loss_ss: 0.716974, loss_d: 1.037862
0.8074 --- loss: 1.152757, loss_ss: 1.100843, loss_d: 0.051915
0.8458 --- loss: 1.609188, loss_ss: 0.976661, loss_d: 0.632527
0.8843 --- loss: 1.244866, loss_ss: 1.083449, loss_d: 0.161417
0.9227 --- loss: 0.996518, loss_ss: 0.918361, loss_d: 0.078157
0.9612 --- loss: 1.089519, loss_ss: 0.993839, loss_d: 0.095680
0.9996 --- loss: 1.337013, loss_ss: 1.308547, loss_d: 0.028466
Epoch finished! Loss: 1.1894714052860553
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.070120, loss_ss: 1.000530, loss_d: 0.069589
0.0384 --- loss: 1.094877, loss_ss: 1.032146, loss_d: 0.062731
0.0769 --- loss: 0.879716, loss_ss: 0.789751, loss_d: 0.089964
0.1153 --- loss: 0.731938, loss_ss: 0.585979, loss_d: 0.145959
0.1538 --- loss: 1.226956, loss_ss: 0.729146, loss_d: 0.497810
0.1922 --- loss: 0.814641, loss_ss: 0.644215, loss_d: 0.170426
0.2307 --- loss: 0.969948, loss_ss: 0.785011, loss_d: 0.184937
0.2691 --- loss: 0.928192, loss_ss: 0.834398, loss_d: 0.093794
0.3076 --- loss: 0.850471, loss_ss: 0.785169, loss_d: 0.065302
0.3460 --- loss: 0.795333, loss_ss: 0.652592, loss_d: 0.142741
0.3845 --- loss: 0.790508, loss_ss: 0.716556, loss_d: 0.073952
0.4229 --- loss: 1.155666, loss_ss: 1.009241, loss_d: 0.146425
0.4614 --- loss: 1.016103, loss_ss: 0.772813, loss_d: 0.243290
0.4998 --- loss: 1.104261, loss_ss: 1.030745, loss_d: 0.073517
0.5383 --- loss: 1.141237, loss_ss: 0.746371, loss_d: 0.394866
0.5767 --- loss: 1.063443, loss_ss: 0.947106, loss_d: 0.116337
0.6151 --- loss: 1.409245, loss_ss: 0.964948, loss_d: 0.444297
0.6536 --- loss: 1.482516, loss_ss: 1.461651, loss_d: 0.020865
0.6920 --- loss: 0.947378, loss_ss: 0.742534, loss_d: 0.204845
0.7305 --- loss: 0.919282, loss_ss: 0.866963, loss_d: 0.052319
0.7689 --- loss: 0.992809, loss_ss: 0.893990, loss_d: 0.098819
0.8074 --- loss: 0.867233, loss_ss: 0.822253, loss_d: 0.044980
0.8458 --- loss: 1.098004, loss_ss: 0.882118, loss_d: 0.215887
0.8843 --- loss: 1.096426, loss_ss: 0.908185, loss_d: 0.188241
0.9227 --- loss: 0.956150, loss_ss: 0.875719, loss_d: 0.080431
0.9612 --- loss: 0.936037, loss_ss: 0.841198, loss_d: 0.094838
0.9996 --- loss: 2.446151, loss_ss: 2.426105, loss_d: 0.020045
Epoch finished! Loss: 1.1162900133774831
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.003379, loss_ss: 0.919950, loss_d: 0.083429
0.0384 --- loss: 0.911487, loss_ss: 0.822217, loss_d: 0.089270
0.0769 --- loss: 0.982924, loss_ss: 0.882381, loss_d: 0.100543
0.1153 --- loss: 0.869541, loss_ss: 0.817393, loss_d: 0.052148
0.1538 --- loss: 0.926157, loss_ss: 0.571539, loss_d: 0.354618
0.1922 --- loss: 0.862010, loss_ss: 0.810774, loss_d: 0.051236
0.2307 --- loss: 1.222294, loss_ss: 0.946413, loss_d: 0.275881
0.2691 --- loss: 1.140320, loss_ss: 0.852738, loss_d: 0.287582
0.3076 --- loss: 0.907147, loss_ss: 0.822699, loss_d: 0.084448
0.3460 --- loss: 0.867204, loss_ss: 0.768491, loss_d: 0.098713
0.3845 --- loss: 0.950116, loss_ss: 0.878691, loss_d: 0.071425
0.4229 --- loss: 1.133270, loss_ss: 1.078509, loss_d: 0.054761
0.4614 --- loss: 0.941137, loss_ss: 0.723069, loss_d: 0.218067
0.4998 --- loss: 0.753855, loss_ss: 0.734374, loss_d: 0.019481
0.5383 --- loss: 1.193819, loss_ss: 0.880864, loss_d: 0.312955
0.5767 --- loss: 0.848166, loss_ss: 0.752805, loss_d: 0.095361
0.6151 --- loss: 1.460239, loss_ss: 0.959516, loss_d: 0.500723
0.6536 --- loss: 0.864926, loss_ss: 0.756557, loss_d: 0.108368
0.6920 --- loss: 1.203712, loss_ss: 1.021139, loss_d: 0.182573
0.7305 --- loss: 1.039930, loss_ss: 0.734524, loss_d: 0.305406
0.7689 --- loss: 1.214683, loss_ss: 0.869874, loss_d: 0.344810
0.8074 --- loss: 1.146120, loss_ss: 0.881323, loss_d: 0.264797
0.8458 --- loss: 1.311485, loss_ss: 0.867006, loss_d: 0.444479
0.8843 --- loss: 1.287225, loss_ss: 0.992157, loss_d: 0.295068
0.9227 --- loss: 0.799423, loss_ss: 0.707620, loss_d: 0.091803
0.9612 --- loss: 0.910775, loss_ss: 0.895606, loss_d: 0.015169
0.9996 --- loss: 5.797470, loss_ss: 0.819548, loss_d: 4.977922
Epoch finished! Loss: 1.0900197801681666
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.746087, loss_ss: 0.713155, loss_d: 0.032933
0.0384 --- loss: 0.938713, loss_ss: 0.847514, loss_d: 0.091199
0.0769 --- loss: 1.051682, loss_ss: 1.012955, loss_d: 0.038727
0.1153 --- loss: 1.729790, loss_ss: 1.640932, loss_d: 0.088858
0.1538 --- loss: 0.938506, loss_ss: 0.901651, loss_d: 0.036856
0.1922 --- loss: 0.906826, loss_ss: 0.877741, loss_d: 0.029086
0.2307 --- loss: 1.189639, loss_ss: 1.147100, loss_d: 0.042539
0.2691 --- loss: 0.973502, loss_ss: 0.753363, loss_d: 0.220139
0.3076 --- loss: 1.391885, loss_ss: 1.003222, loss_d: 0.388663
0.3460 --- loss: 0.959893, loss_ss: 0.885045, loss_d: 0.074848
0.3845 --- loss: 0.876403, loss_ss: 0.797363, loss_d: 0.079040
0.4229 --- loss: 1.145292, loss_ss: 0.993257, loss_d: 0.152034
0.4614 --- loss: 0.984884, loss_ss: 0.945738, loss_d: 0.039146
0.4998 --- loss: 0.786197, loss_ss: 0.738111, loss_d: 0.048086
0.5383 --- loss: 0.824708, loss_ss: 0.722912, loss_d: 0.101797
0.5767 --- loss: 1.277482, loss_ss: 0.999042, loss_d: 0.278440
0.6151 --- loss: 1.337223, loss_ss: 0.871924, loss_d: 0.465299
0.6536 --- loss: 1.246292, loss_ss: 1.171924, loss_d: 0.074367
0.6920 --- loss: 0.928033, loss_ss: 0.921724, loss_d: 0.006309
0.7305 --- loss: 0.768079, loss_ss: 0.713808, loss_d: 0.054270
0.7689 --- loss: 0.999742, loss_ss: 0.885290, loss_d: 0.114452
0.8074 --- loss: 0.756686, loss_ss: 0.697477, loss_d: 0.059210
0.8458 --- loss: 1.084515, loss_ss: 0.857871, loss_d: 0.226643
0.8843 --- loss: 0.850745, loss_ss: 0.811343, loss_d: 0.039402
0.9227 --- loss: 1.894126, loss_ss: 0.700765, loss_d: 1.193361
0.9612 --- loss: 0.835723, loss_ss: 0.551256, loss_d: 0.284467
0.9996 --- loss: 5.193657, loss_ss: 3.002701, loss_d: 2.190956
Epoch finished! Loss: 1.0670771977076163
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.190380, loss_ss: 1.070564, loss_d: 0.119816
0.0384 --- loss: 0.792529, loss_ss: 0.707562, loss_d: 0.084967
0.0769 --- loss: 1.059381, loss_ss: 0.873201, loss_d: 0.186180
0.1153 --- loss: 1.030602, loss_ss: 0.920616, loss_d: 0.109987
0.1538 --- loss: 0.502834, loss_ss: 0.447815, loss_d: 0.055019
0.1922 --- loss: 0.946799, loss_ss: 0.885201, loss_d: 0.061598
0.2307 --- loss: 0.858860, loss_ss: 0.827666, loss_d: 0.031194
0.2691 --- loss: 0.868041, loss_ss: 0.848913, loss_d: 0.019127
0.3076 --- loss: 0.783732, loss_ss: 0.755718, loss_d: 0.028013
0.3460 --- loss: 0.806280, loss_ss: 0.792162, loss_d: 0.014118
0.3845 --- loss: 0.926617, loss_ss: 0.901845, loss_d: 0.024772
0.4229 --- loss: 1.116575, loss_ss: 0.858298, loss_d: 0.258278
0.4614 --- loss: 0.790770, loss_ss: 0.742514, loss_d: 0.048255
0.4998 --- loss: 0.982288, loss_ss: 0.714597, loss_d: 0.267691
0.5383 --- loss: 1.012352, loss_ss: 0.951439, loss_d: 0.060913
0.5767 --- loss: 0.996584, loss_ss: 0.892437, loss_d: 0.104147
0.6151 --- loss: 1.155440, loss_ss: 1.126900, loss_d: 0.028541
0.6536 --- loss: 0.829805, loss_ss: 0.774427, loss_d: 0.055379
0.6920 --- loss: 0.864881, loss_ss: 0.736287, loss_d: 0.128594
0.7305 --- loss: 0.651645, loss_ss: 0.612454, loss_d: 0.039191
0.7689 --- loss: 0.869445, loss_ss: 0.854408, loss_d: 0.015037
0.8074 --- loss: 0.774855, loss_ss: 0.762858, loss_d: 0.011997
0.8458 --- loss: 0.653317, loss_ss: 0.615391, loss_d: 0.037925
0.8843 --- loss: 1.036361, loss_ss: 0.863294, loss_d: 0.173067
0.9227 --- loss: 0.854539, loss_ss: 0.744928, loss_d: 0.109611
0.9612 --- loss: 1.013530, loss_ss: 0.880707, loss_d: 0.132823
0.9996 --- loss: 6.825816, loss_ss: 1.333505, loss_d: 5.492311
Epoch finished! Loss: 1.0136506493274982
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.850083, loss_ss: 0.776928, loss_d: 0.073155
0.0384 --- loss: 0.878393, loss_ss: 0.765065, loss_d: 0.113328
0.0769 --- loss: 1.045888, loss_ss: 0.932132, loss_d: 0.113756
0.1153 --- loss: 0.716622, loss_ss: 0.524769, loss_d: 0.191854
0.1538 --- loss: 0.913297, loss_ss: 0.789334, loss_d: 0.123962
0.1922 --- loss: 0.871246, loss_ss: 0.854608, loss_d: 0.016638
0.2307 --- loss: 1.158348, loss_ss: 1.147962, loss_d: 0.010385
0.2691 --- loss: 0.990547, loss_ss: 0.980286, loss_d: 0.010261
0.3076 --- loss: 0.721503, loss_ss: 0.693242, loss_d: 0.028260
0.3460 --- loss: 0.843209, loss_ss: 0.774996, loss_d: 0.068213
0.3845 --- loss: 0.859399, loss_ss: 0.849905, loss_d: 0.009494
0.4229 --- loss: 0.886444, loss_ss: 0.853673, loss_d: 0.032771
0.4614 --- loss: 1.305215, loss_ss: 1.297494, loss_d: 0.007721
0.4998 --- loss: 1.140381, loss_ss: 1.130190, loss_d: 0.010191
0.5383 --- loss: 0.812829, loss_ss: 0.805895, loss_d: 0.006934
0.5767 --- loss: 0.824008, loss_ss: 0.761266, loss_d: 0.062742
0.6151 --- loss: 1.030433, loss_ss: 0.681990, loss_d: 0.348442
0.6536 --- loss: 0.640177, loss_ss: 0.622164, loss_d: 0.018013
0.6920 --- loss: 1.117358, loss_ss: 0.928886, loss_d: 0.188473
0.7305 --- loss: 1.072390, loss_ss: 1.039269, loss_d: 0.033120
0.7689 --- loss: 1.029251, loss_ss: 0.778557, loss_d: 0.250694
0.8074 --- loss: 0.923546, loss_ss: 0.861284, loss_d: 0.062262
0.8458 --- loss: 0.653125, loss_ss: 0.623206, loss_d: 0.029919
0.8843 --- loss: 0.502290, loss_ss: 0.496102, loss_d: 0.006188
0.9227 --- loss: 0.980529, loss_ss: 0.956050, loss_d: 0.024479
0.9612 --- loss: 0.667254, loss_ss: 0.642146, loss_d: 0.025108
0.9996 --- loss: 2.183453, loss_ss: 2.179255, loss_d: 0.004198
Epoch finished! Loss: 0.9649612339643332
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6387387387387388
             precision    recall  f1-score   support

        0.0       0.40      0.85      0.54       153
        1.0       0.38      0.06      0.10       232
        2.0       0.88      0.69      0.77       441
        3.0       0.72      0.91      0.81        93
        4.0       0.62      0.92      0.74       191

avg / total       0.65      0.64      0.60      1110
 


====== chp042-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.09  84.97   79.31  39.63     54.05
1  78.38   5.60   97.61  38.24      9.77
2  83.87  69.16   93.57  87.64     77.31
3  96.31  91.40   96.76  72.03     80.57
4  89.10  92.15   88.47  62.41     74.42
Total accuracy: 63.87%
Average sen: 68.66%
Average spec: 91.14%
Macro f1-score: 59.23%
Diagnosis acc on 15mins: 1.0
[0.99999988 0.9999938  0.99928719 0.99999702 1.         1.
 1.         1.         1.         1.         0.99999988 0.99982172
 0.99978358 0.99999881 0.99999988 0.99999988 1.         1.
 1.         1.         1.         0.99999988 0.99999571 0.99804664
 0.99982798 0.99991274 1.         1.         1.         1.
 1.         1.         0.99999964 0.99995053 0.99999249 0.99999821
 0.99999893]
pred: 0.9999082265673457, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.454331, loss_ss: 1.788505, loss_d: 0.665826
0.0385 --- loss: 2.203385, loss_ss: 1.651491, loss_d: 0.551894
0.0770 --- loss: 2.174979, loss_ss: 1.655499, loss_d: 0.519481
0.1155 --- loss: 2.037001, loss_ss: 1.601559, loss_d: 0.435442
0.1540 --- loss: 2.169674, loss_ss: 1.516187, loss_d: 0.653486
0.1925 --- loss: 2.251139, loss_ss: 1.457486, loss_d: 0.793653
0.2309 --- loss: 2.027797, loss_ss: 1.550468, loss_d: 0.477328
0.2694 --- loss: 2.142362, loss_ss: 1.560492, loss_d: 0.581870
0.3079 --- loss: 1.896026, loss_ss: 1.423304, loss_d: 0.472721
0.3464 --- loss: 2.305979, loss_ss: 1.660468, loss_d: 0.645511
0.3849 --- loss: 2.031175, loss_ss: 1.420644, loss_d: 0.610531
0.4234 --- loss: 1.800766, loss_ss: 1.319978, loss_d: 0.480788
0.4619 --- loss: 1.834473, loss_ss: 1.419087, loss_d: 0.415385
0.5004 --- loss: 2.129746, loss_ss: 1.484291, loss_d: 0.645454
0.5389 --- loss: 1.903119, loss_ss: 1.368634, loss_d: 0.534485
0.5774 --- loss: 1.783518, loss_ss: 1.291816, loss_d: 0.491701
0.6159 --- loss: 1.647990, loss_ss: 1.241842, loss_d: 0.406148
0.6543 --- loss: 2.189550, loss_ss: 1.577714, loss_d: 0.611836
0.6928 --- loss: 1.925895, loss_ss: 1.383555, loss_d: 0.542341
0.7313 --- loss: 1.942006, loss_ss: 1.516703, loss_d: 0.425303
0.7698 --- loss: 2.135641, loss_ss: 1.593710, loss_d: 0.541930
0.8083 --- loss: 2.040666, loss_ss: 1.201346, loss_d: 0.839320
0.8468 --- loss: 2.109531, loss_ss: 1.738852, loss_d: 0.370679
0.8853 --- loss: 1.783416, loss_ss: 1.217287, loss_d: 0.566129
0.9238 --- loss: 1.833078, loss_ss: 1.305727, loss_d: 0.527350
0.9623 --- loss: 1.660803, loss_ss: 1.285232, loss_d: 0.375571
Epoch finished! Loss: 1.998150846212527
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.635014, loss_ss: 1.181936, loss_d: 0.453079
0.0385 --- loss: 1.769082, loss_ss: 1.389686, loss_d: 0.379396
0.0770 --- loss: 1.847413, loss_ss: 1.337294, loss_d: 0.510119
0.1155 --- loss: 1.525503, loss_ss: 1.219093, loss_d: 0.306410
0.1540 --- loss: 1.818222, loss_ss: 1.143704, loss_d: 0.674518
0.1925 --- loss: 1.625604, loss_ss: 1.123450, loss_d: 0.502154
0.2309 --- loss: 1.628736, loss_ss: 1.220686, loss_d: 0.408051
0.2694 --- loss: 1.464691, loss_ss: 1.196439, loss_d: 0.268252
0.3079 --- loss: 1.413988, loss_ss: 1.128826, loss_d: 0.285162
0.3464 --- loss: 1.123073, loss_ss: 1.019126, loss_d: 0.103947
0.3849 --- loss: 1.565233, loss_ss: 1.210497, loss_d: 0.354736
0.4234 --- loss: 1.941237, loss_ss: 1.051340, loss_d: 0.889897
0.4619 --- loss: 1.780646, loss_ss: 1.175707, loss_d: 0.604939
0.5004 --- loss: 1.525834, loss_ss: 1.008947, loss_d: 0.516887
0.5389 --- loss: 1.360116, loss_ss: 0.948490, loss_d: 0.411626
0.5774 --- loss: 1.330950, loss_ss: 1.126591, loss_d: 0.204359
0.6159 --- loss: 1.540053, loss_ss: 1.091354, loss_d: 0.448699
0.6543 --- loss: 1.380680, loss_ss: 1.089709, loss_d: 0.290970
0.6928 --- loss: 1.173090, loss_ss: 1.062291, loss_d: 0.110799
0.7313 --- loss: 1.288746, loss_ss: 0.929241, loss_d: 0.359505
0.7698 --- loss: 1.611892, loss_ss: 1.127119, loss_d: 0.484773
0.8083 --- loss: 1.333623, loss_ss: 1.032286, loss_d: 0.301337
0.8468 --- loss: 1.604763, loss_ss: 1.235635, loss_d: 0.369128
0.8853 --- loss: 1.465237, loss_ss: 1.127136, loss_d: 0.338100
0.9238 --- loss: 1.351838, loss_ss: 1.174301, loss_d: 0.177537
0.9623 --- loss: 1.225039, loss_ss: 1.006373, loss_d: 0.218667
Epoch finished! Loss: 1.529177936577889
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.453863, loss_ss: 1.174024, loss_d: 0.279839
0.0385 --- loss: 1.599227, loss_ss: 1.141266, loss_d: 0.457961
0.0770 --- loss: 1.030160, loss_ss: 0.927006, loss_d: 0.103154
0.1155 --- loss: 1.415185, loss_ss: 1.089238, loss_d: 0.325947
0.1540 --- loss: 1.388344, loss_ss: 0.952892, loss_d: 0.435452
0.1925 --- loss: 1.719081, loss_ss: 1.153615, loss_d: 0.565467
0.2309 --- loss: 1.259713, loss_ss: 0.909301, loss_d: 0.350411
0.2694 --- loss: 1.335195, loss_ss: 1.009096, loss_d: 0.326099
0.3079 --- loss: 1.810400, loss_ss: 1.232376, loss_d: 0.578024
0.3464 --- loss: 1.196372, loss_ss: 0.972608, loss_d: 0.223764
0.3849 --- loss: 1.209086, loss_ss: 0.940576, loss_d: 0.268510
0.4234 --- loss: 1.058674, loss_ss: 0.971011, loss_d: 0.087663
0.4619 --- loss: 1.253572, loss_ss: 1.156477, loss_d: 0.097095
0.5004 --- loss: 1.240599, loss_ss: 0.982009, loss_d: 0.258590
0.5389 --- loss: 1.537158, loss_ss: 1.099021, loss_d: 0.438137
0.5774 --- loss: 0.847396, loss_ss: 0.754597, loss_d: 0.092798
0.6159 --- loss: 1.201414, loss_ss: 1.081759, loss_d: 0.119655
0.6543 --- loss: 1.295081, loss_ss: 0.821980, loss_d: 0.473101
0.6928 --- loss: 1.012833, loss_ss: 0.807684, loss_d: 0.205149
0.7313 --- loss: 1.273342, loss_ss: 1.110888, loss_d: 0.162453
0.7698 --- loss: 1.332520, loss_ss: 0.859259, loss_d: 0.473260
0.8083 --- loss: 1.093515, loss_ss: 0.912743, loss_d: 0.180772
0.8468 --- loss: 1.233581, loss_ss: 1.042671, loss_d: 0.190910
0.8853 --- loss: 1.001361, loss_ss: 0.972814, loss_d: 0.028547
0.9238 --- loss: 1.427996, loss_ss: 1.004187, loss_d: 0.423809
0.9623 --- loss: 0.874021, loss_ss: 0.809789, loss_d: 0.064232
Epoch finished! Loss: 1.2920537851031684
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.953682, loss_ss: 1.158008, loss_d: 0.795673
0.0385 --- loss: 0.989607, loss_ss: 0.864447, loss_d: 0.125160
0.0770 --- loss: 1.041974, loss_ss: 0.750448, loss_d: 0.291526
0.1155 --- loss: 1.293497, loss_ss: 1.116629, loss_d: 0.176868
0.1540 --- loss: 1.423064, loss_ss: 1.156917, loss_d: 0.266148
0.1925 --- loss: 0.962813, loss_ss: 0.924861, loss_d: 0.037952
0.2309 --- loss: 1.145037, loss_ss: 0.845442, loss_d: 0.299595
0.2694 --- loss: 1.512868, loss_ss: 0.890625, loss_d: 0.622243
0.3079 --- loss: 1.190822, loss_ss: 0.972419, loss_d: 0.218403
0.3464 --- loss: 1.364596, loss_ss: 1.230776, loss_d: 0.133820
0.3849 --- loss: 1.240286, loss_ss: 1.090116, loss_d: 0.150170
0.4234 --- loss: 1.133660, loss_ss: 0.861868, loss_d: 0.271793
0.4619 --- loss: 1.184371, loss_ss: 1.043088, loss_d: 0.141283
0.5004 --- loss: 1.298862, loss_ss: 1.005906, loss_d: 0.292956
0.5389 --- loss: 1.088165, loss_ss: 0.763061, loss_d: 0.325104
0.5774 --- loss: 0.943385, loss_ss: 0.699153, loss_d: 0.244231
0.6159 --- loss: 1.116668, loss_ss: 1.019065, loss_d: 0.097603
0.6543 --- loss: 0.864598, loss_ss: 0.774696, loss_d: 0.089901
0.6928 --- loss: 0.828338, loss_ss: 0.761616, loss_d: 0.066721
0.7313 --- loss: 0.887456, loss_ss: 0.804835, loss_d: 0.082620
0.7698 --- loss: 1.087259, loss_ss: 0.639525, loss_d: 0.447734
0.8083 --- loss: 1.183457, loss_ss: 0.643147, loss_d: 0.540310
0.8468 --- loss: 1.435810, loss_ss: 1.151535, loss_d: 0.284275
0.8853 --- loss: 1.002986, loss_ss: 0.922440, loss_d: 0.080546
0.9238 --- loss: 1.215479, loss_ss: 0.847050, loss_d: 0.368430
0.9623 --- loss: 1.243962, loss_ss: 1.025794, loss_d: 0.218168
Epoch finished! Loss: 1.195656249421904
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.863092, loss_ss: 0.784105, loss_d: 0.078987
0.0385 --- loss: 1.495730, loss_ss: 0.948147, loss_d: 0.547583
0.0770 --- loss: 0.780303, loss_ss: 0.636560, loss_d: 0.143743
0.1155 --- loss: 1.112410, loss_ss: 1.057489, loss_d: 0.054921
0.1540 --- loss: 1.052256, loss_ss: 0.765364, loss_d: 0.286892
0.1925 --- loss: 1.257519, loss_ss: 1.072837, loss_d: 0.184681
0.2309 --- loss: 1.306765, loss_ss: 0.869802, loss_d: 0.436963
0.2694 --- loss: 1.407605, loss_ss: 0.945811, loss_d: 0.461794
0.3079 --- loss: 1.694469, loss_ss: 1.263183, loss_d: 0.431286
0.3464 --- loss: 0.906342, loss_ss: 0.789355, loss_d: 0.116987
0.3849 --- loss: 1.211724, loss_ss: 0.899091, loss_d: 0.312633
0.4234 --- loss: 1.114010, loss_ss: 0.781999, loss_d: 0.332011
0.4619 --- loss: 1.076765, loss_ss: 0.837909, loss_d: 0.238856
0.5004 --- loss: 1.566490, loss_ss: 1.462393, loss_d: 0.104097
0.5389 --- loss: 0.923462, loss_ss: 0.782801, loss_d: 0.140662
0.5774 --- loss: 0.766396, loss_ss: 0.649703, loss_d: 0.116694
0.6159 --- loss: 0.709712, loss_ss: 0.662753, loss_d: 0.046960
0.6543 --- loss: 1.120563, loss_ss: 0.964995, loss_d: 0.155569
0.6928 --- loss: 0.936589, loss_ss: 0.741740, loss_d: 0.194848
0.7313 --- loss: 1.116078, loss_ss: 1.042621, loss_d: 0.073458
0.7698 --- loss: 1.041344, loss_ss: 0.900434, loss_d: 0.140910
0.8083 --- loss: 1.426728, loss_ss: 0.900050, loss_d: 0.526678
0.8468 --- loss: 0.942794, loss_ss: 0.743451, loss_d: 0.199344
0.8853 --- loss: 0.949086, loss_ss: 0.867940, loss_d: 0.081146
0.9238 --- loss: 1.152190, loss_ss: 0.602365, loss_d: 0.549825
0.9623 --- loss: 1.254540, loss_ss: 0.883752, loss_d: 0.370789
Epoch finished! Loss: 1.1268055949892317
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.054568, loss_ss: 0.820661, loss_d: 0.233907
0.0385 --- loss: 1.101753, loss_ss: 0.815625, loss_d: 0.286128
0.0770 --- loss: 1.204750, loss_ss: 0.971996, loss_d: 0.232754
0.1155 --- loss: 0.903314, loss_ss: 0.829182, loss_d: 0.074131
0.1540 --- loss: 0.916023, loss_ss: 0.869377, loss_d: 0.046646
0.1925 --- loss: 1.030610, loss_ss: 0.916105, loss_d: 0.114505
0.2309 --- loss: 1.701846, loss_ss: 1.240104, loss_d: 0.461742
0.2694 --- loss: 0.901517, loss_ss: 0.748595, loss_d: 0.152922
0.3079 --- loss: 1.104662, loss_ss: 0.899557, loss_d: 0.205106
0.3464 --- loss: 1.231149, loss_ss: 1.177706, loss_d: 0.053443
0.3849 --- loss: 1.066594, loss_ss: 1.014475, loss_d: 0.052119
0.4234 --- loss: 0.922570, loss_ss: 0.735867, loss_d: 0.186702
0.4619 --- loss: 0.889398, loss_ss: 0.824001, loss_d: 0.065397
0.5004 --- loss: 0.898210, loss_ss: 0.644286, loss_d: 0.253924
0.5389 --- loss: 1.025258, loss_ss: 0.966066, loss_d: 0.059192
0.5774 --- loss: 1.445659, loss_ss: 1.023420, loss_d: 0.422238
0.6159 --- loss: 1.009064, loss_ss: 0.896108, loss_d: 0.112955
0.6543 --- loss: 1.095927, loss_ss: 0.927997, loss_d: 0.167930
0.6928 --- loss: 1.004135, loss_ss: 0.967308, loss_d: 0.036827
0.7313 --- loss: 1.169089, loss_ss: 0.901978, loss_d: 0.267111
0.7698 --- loss: 1.653572, loss_ss: 1.551709, loss_d: 0.101863
0.8083 --- loss: 1.096460, loss_ss: 0.739036, loss_d: 0.357424
0.8468 --- loss: 1.006899, loss_ss: 0.875410, loss_d: 0.131489
0.8853 --- loss: 1.467454, loss_ss: 1.253407, loss_d: 0.214048
0.9238 --- loss: 1.040943, loss_ss: 0.949666, loss_d: 0.091277
0.9623 --- loss: 0.932270, loss_ss: 0.705952, loss_d: 0.226318
Epoch finished! Loss: 1.0525783781379345
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.975869, loss_ss: 0.722167, loss_d: 0.253702
0.0385 --- loss: 0.772143, loss_ss: 0.683302, loss_d: 0.088842
0.0770 --- loss: 0.921252, loss_ss: 0.880490, loss_d: 0.040762
0.1155 --- loss: 0.878161, loss_ss: 0.855093, loss_d: 0.023068
0.1540 --- loss: 0.679127, loss_ss: 0.663382, loss_d: 0.015745
0.1925 --- loss: 1.109822, loss_ss: 1.053045, loss_d: 0.056777
0.2309 --- loss: 1.003187, loss_ss: 0.901031, loss_d: 0.102156
0.2694 --- loss: 1.012067, loss_ss: 0.820233, loss_d: 0.191834
0.3079 --- loss: 0.768894, loss_ss: 0.755840, loss_d: 0.013054
0.3464 --- loss: 0.818235, loss_ss: 0.790894, loss_d: 0.027341
0.3849 --- loss: 1.003710, loss_ss: 0.929683, loss_d: 0.074027
0.4234 --- loss: 1.107151, loss_ss: 1.088467, loss_d: 0.018685
0.4619 --- loss: 0.673572, loss_ss: 0.638888, loss_d: 0.034684
0.5004 --- loss: 0.727995, loss_ss: 0.625068, loss_d: 0.102927
0.5389 --- loss: 0.776163, loss_ss: 0.762433, loss_d: 0.013730
0.5774 --- loss: 1.476345, loss_ss: 1.401407, loss_d: 0.074938
0.6159 --- loss: 0.809794, loss_ss: 0.782756, loss_d: 0.027039
0.6543 --- loss: 1.378929, loss_ss: 1.180451, loss_d: 0.198479
0.6928 --- loss: 0.972053, loss_ss: 0.842305, loss_d: 0.129748
0.7313 --- loss: 0.910286, loss_ss: 0.880950, loss_d: 0.029336
0.7698 --- loss: 1.179873, loss_ss: 0.870323, loss_d: 0.309550
0.8083 --- loss: 0.710076, loss_ss: 0.686793, loss_d: 0.023283
0.8468 --- loss: 1.051369, loss_ss: 0.755150, loss_d: 0.296219
0.8853 --- loss: 0.607747, loss_ss: 0.590265, loss_d: 0.017482
0.9238 --- loss: 1.039286, loss_ss: 0.900280, loss_d: 0.139006
0.9623 --- loss: 0.906927, loss_ss: 0.777291, loss_d: 0.129636
Epoch finished! Loss: 1.0138251314292084
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.094119, loss_ss: 0.998096, loss_d: 0.096023
0.0385 --- loss: 0.920036, loss_ss: 0.902410, loss_d: 0.017626
0.0770 --- loss: 1.119162, loss_ss: 1.089091, loss_d: 0.030071
0.1155 --- loss: 0.697465, loss_ss: 0.644701, loss_d: 0.052764
0.1540 --- loss: 1.203928, loss_ss: 0.750102, loss_d: 0.453826
0.1925 --- loss: 1.215747, loss_ss: 0.866532, loss_d: 0.349215
0.2309 --- loss: 0.880963, loss_ss: 0.792183, loss_d: 0.088780
0.2694 --- loss: 0.895336, loss_ss: 0.875961, loss_d: 0.019375
0.3079 --- loss: 0.714875, loss_ss: 0.622387, loss_d: 0.092489
0.3464 --- loss: 1.119780, loss_ss: 0.934342, loss_d: 0.185438
0.3849 --- loss: 1.048800, loss_ss: 0.848780, loss_d: 0.200020
0.4234 --- loss: 1.159197, loss_ss: 1.110521, loss_d: 0.048676
0.4619 --- loss: 0.820353, loss_ss: 0.628468, loss_d: 0.191884
0.5004 --- loss: 1.315946, loss_ss: 0.871002, loss_d: 0.444944
0.5389 --- loss: 0.703462, loss_ss: 0.637994, loss_d: 0.065469
0.5774 --- loss: 1.308596, loss_ss: 0.982391, loss_d: 0.326205
0.6159 --- loss: 0.852406, loss_ss: 0.773390, loss_d: 0.079016
0.6543 --- loss: 0.822198, loss_ss: 0.777435, loss_d: 0.044763
0.6928 --- loss: 1.057846, loss_ss: 1.037340, loss_d: 0.020506
0.7313 --- loss: 0.666036, loss_ss: 0.621347, loss_d: 0.044689
0.7698 --- loss: 0.817385, loss_ss: 0.758631, loss_d: 0.058754
0.8083 --- loss: 0.753958, loss_ss: 0.701089, loss_d: 0.052869
0.8468 --- loss: 0.961327, loss_ss: 0.847921, loss_d: 0.113406
0.8853 --- loss: 0.716695, loss_ss: 0.615681, loss_d: 0.101014
0.9238 --- loss: 0.837762, loss_ss: 0.652085, loss_d: 0.185676
0.9623 --- loss: 0.969041, loss_ss: 0.769859, loss_d: 0.199183
Epoch finished! Loss: 0.9868765747224962
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.784629, loss_ss: 0.761629, loss_d: 0.023000
0.0385 --- loss: 0.758343, loss_ss: 0.737903, loss_d: 0.020440
0.0770 --- loss: 0.669705, loss_ss: 0.629873, loss_d: 0.039832
0.1155 --- loss: 1.153274, loss_ss: 0.990493, loss_d: 0.162781
0.1540 --- loss: 0.691413, loss_ss: 0.617874, loss_d: 0.073539
0.1925 --- loss: 0.813625, loss_ss: 0.785209, loss_d: 0.028416
0.2309 --- loss: 1.157720, loss_ss: 0.951801, loss_d: 0.205919
0.2694 --- loss: 0.944767, loss_ss: 0.856969, loss_d: 0.087798
0.3079 --- loss: 1.424928, loss_ss: 1.261749, loss_d: 0.163179
0.3464 --- loss: 1.060495, loss_ss: 1.052321, loss_d: 0.008174
0.3849 --- loss: 1.026340, loss_ss: 0.961713, loss_d: 0.064626
0.4234 --- loss: 1.209600, loss_ss: 0.859295, loss_d: 0.350305
0.4619 --- loss: 0.768779, loss_ss: 0.693468, loss_d: 0.075310
0.5004 --- loss: 0.636499, loss_ss: 0.571475, loss_d: 0.065024
0.5389 --- loss: 0.762922, loss_ss: 0.753424, loss_d: 0.009498
0.5774 --- loss: 1.022987, loss_ss: 0.997841, loss_d: 0.025147
0.6159 --- loss: 0.962282, loss_ss: 0.776565, loss_d: 0.185717
0.6543 --- loss: 0.773421, loss_ss: 0.675822, loss_d: 0.097599
0.6928 --- loss: 0.895375, loss_ss: 0.873134, loss_d: 0.022241
0.7313 --- loss: 1.020505, loss_ss: 0.699844, loss_d: 0.320661
0.7698 --- loss: 1.234204, loss_ss: 0.745516, loss_d: 0.488688
0.8083 --- loss: 1.006116, loss_ss: 0.778063, loss_d: 0.228053
0.8468 --- loss: 0.630773, loss_ss: 0.548262, loss_d: 0.082512
0.8853 --- loss: 0.838613, loss_ss: 0.795102, loss_d: 0.043511
0.9238 --- loss: 0.849544, loss_ss: 0.722591, loss_d: 0.126953
0.9623 --- loss: 0.724122, loss_ss: 0.570452, loss_d: 0.153670
Epoch finished! Loss: 0.9555062819631863
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.690544, loss_ss: 0.673273, loss_d: 0.017272
0.0385 --- loss: 0.769279, loss_ss: 0.694976, loss_d: 0.074303
0.0770 --- loss: 0.573241, loss_ss: 0.543243, loss_d: 0.029997
0.1155 --- loss: 1.004883, loss_ss: 0.793126, loss_d: 0.211757
0.1540 --- loss: 0.646844, loss_ss: 0.622326, loss_d: 0.024518
0.1925 --- loss: 0.932074, loss_ss: 0.900155, loss_d: 0.031919
0.2309 --- loss: 0.880804, loss_ss: 0.846231, loss_d: 0.034573
0.2694 --- loss: 1.222576, loss_ss: 1.129083, loss_d: 0.093493
0.3079 --- loss: 1.068769, loss_ss: 0.918835, loss_d: 0.149934
0.3464 --- loss: 0.729600, loss_ss: 0.608434, loss_d: 0.121165
0.3849 --- loss: 0.795546, loss_ss: 0.682617, loss_d: 0.112929
0.4234 --- loss: 0.757296, loss_ss: 0.730892, loss_d: 0.026404
0.4619 --- loss: 0.742184, loss_ss: 0.731065, loss_d: 0.011119
0.5004 --- loss: 1.007185, loss_ss: 0.754838, loss_d: 0.252347
0.5389 --- loss: 1.242042, loss_ss: 1.233789, loss_d: 0.008252
0.5774 --- loss: 0.999550, loss_ss: 0.965002, loss_d: 0.034548
0.6159 --- loss: 1.089663, loss_ss: 0.808300, loss_d: 0.281363
0.6543 --- loss: 1.087410, loss_ss: 1.067519, loss_d: 0.019891
0.6928 --- loss: 0.759917, loss_ss: 0.743144, loss_d: 0.016773
0.7313 --- loss: 1.011702, loss_ss: 0.981056, loss_d: 0.030646
0.7698 --- loss: 0.622044, loss_ss: 0.618804, loss_d: 0.003240
0.8083 --- loss: 1.056539, loss_ss: 1.005115, loss_d: 0.051425
0.8468 --- loss: 0.862185, loss_ss: 0.601435, loss_d: 0.260751
0.8853 --- loss: 0.793852, loss_ss: 0.790048, loss_d: 0.003804
0.9238 --- loss: 1.054868, loss_ss: 1.034118, loss_d: 0.020750
0.9623 --- loss: 0.820607, loss_ss: 0.804212, loss_d: 0.016395
Epoch finished! Loss: 0.9268471171727052
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7583333333333333
             precision    recall  f1-score   support

        0.0       0.98      0.63      0.77       143
        1.0       0.50      0.52      0.51       197
        2.0       0.81      0.90      0.85       506
        3.0       0.96      0.34      0.51        64
        4.0       0.75      0.83      0.79       290

avg / total       0.77      0.76      0.75      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.42  62.94   99.81  97.83     76.60
1  83.75  52.28   89.93  50.49     51.37
2  86.83  89.72   84.73  81.07     85.18
3  96.42  34.38   99.91  95.65     50.57
4  89.25  83.10   91.21  75.08     78.89
Total accuracy: 75.83%
Average sen: 64.48%
Average spec: 93.12%
Macro f1-score: 68.52%
Diagnosis acc on 15mins: 1.0
[0.9896242  0.96759951 0.99999607 0.99876499 0.97400171 0.99975008
 0.96721697 0.95901161 0.99808002 0.95368159 0.94785082 0.99015778
 0.97266495 0.99830925 0.98896503 0.98673719 0.99851114 0.94775075
 0.88980407 0.9667244  0.99095297 0.99591511 0.99747628 0.9972952
 0.9870978  0.99999368 0.9985227  0.99700791 0.99863774 0.99897599
 0.98916417 0.99103737 0.9986589  0.98993838 0.98840231 0.99893159
 0.9999311  0.99971658 0.98994499 0.98185891]
pred: 0.98461654484272, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.346573, loss_ss: 1.637802, loss_d: 0.708770
0.0384 --- loss: 2.106433, loss_ss: 1.483952, loss_d: 0.622481
0.0768 --- loss: 2.441975, loss_ss: 1.420640, loss_d: 1.021334
0.1153 --- loss: 2.242059, loss_ss: 1.577110, loss_d: 0.664948
0.1537 --- loss: 2.180700, loss_ss: 1.478590, loss_d: 0.702111
0.1921 --- loss: 1.979375, loss_ss: 1.404107, loss_d: 0.575268
0.2305 --- loss: 2.349927, loss_ss: 1.447536, loss_d: 0.902391
0.2689 --- loss: 1.863341, loss_ss: 1.257243, loss_d: 0.606097
0.3073 --- loss: 1.786318, loss_ss: 1.340209, loss_d: 0.446110
0.3458 --- loss: 1.964097, loss_ss: 1.509609, loss_d: 0.454488
0.3842 --- loss: 1.773920, loss_ss: 1.185556, loss_d: 0.588364
0.4226 --- loss: 2.011906, loss_ss: 1.413106, loss_d: 0.598800
0.4610 --- loss: 2.133867, loss_ss: 1.441501, loss_d: 0.692367
0.4994 --- loss: 1.745601, loss_ss: 1.256729, loss_d: 0.488872
0.5378 --- loss: 2.364748, loss_ss: 1.406835, loss_d: 0.957913
0.5763 --- loss: 1.643355, loss_ss: 1.159436, loss_d: 0.483919
0.6147 --- loss: 1.753213, loss_ss: 1.255718, loss_d: 0.497495
0.6531 --- loss: 1.796955, loss_ss: 1.236548, loss_d: 0.560407
0.6915 --- loss: 1.705723, loss_ss: 1.231548, loss_d: 0.474176
0.7299 --- loss: 1.309041, loss_ss: 1.030749, loss_d: 0.278292
0.7683 --- loss: 1.496677, loss_ss: 1.165892, loss_d: 0.330785
0.8068 --- loss: 1.772275, loss_ss: 1.168605, loss_d: 0.603670
0.8452 --- loss: 1.790137, loss_ss: 1.175082, loss_d: 0.615054
0.8836 --- loss: 1.717893, loss_ss: 1.217956, loss_d: 0.499937
0.9220 --- loss: 1.530744, loss_ss: 1.239043, loss_d: 0.291701
0.9604 --- loss: 1.831683, loss_ss: 1.127570, loss_d: 0.704113
0.9988 --- loss: 2.145566, loss_ss: 1.341839, loss_d: 0.803728
Epoch finished! Loss: 1.8909155359634986
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.409042, loss_ss: 1.125736, loss_d: 0.283306
0.0384 --- loss: 1.803603, loss_ss: 1.303522, loss_d: 0.500081
0.0768 --- loss: 1.445763, loss_ss: 1.091888, loss_d: 0.353875
0.1153 --- loss: 1.358730, loss_ss: 1.080473, loss_d: 0.278257
0.1537 --- loss: 1.311900, loss_ss: 1.141621, loss_d: 0.170279
0.1921 --- loss: 1.970575, loss_ss: 1.320814, loss_d: 0.649761
0.2305 --- loss: 1.565202, loss_ss: 1.222736, loss_d: 0.342466
0.2689 --- loss: 1.095707, loss_ss: 0.885889, loss_d: 0.209818
0.3073 --- loss: 2.407270, loss_ss: 1.348594, loss_d: 1.058676
0.3458 --- loss: 1.569632, loss_ss: 1.074875, loss_d: 0.494758
0.3842 --- loss: 1.245641, loss_ss: 1.020885, loss_d: 0.224757
0.4226 --- loss: 1.836316, loss_ss: 1.082816, loss_d: 0.753500
0.4610 --- loss: 1.755695, loss_ss: 1.205740, loss_d: 0.549954
0.4994 --- loss: 1.493239, loss_ss: 1.087314, loss_d: 0.405924
0.5378 --- loss: 1.155778, loss_ss: 1.030615, loss_d: 0.125163
0.5763 --- loss: 1.582715, loss_ss: 1.048310, loss_d: 0.534405
0.6147 --- loss: 1.450185, loss_ss: 1.004701, loss_d: 0.445484
0.6531 --- loss: 1.561367, loss_ss: 0.905025, loss_d: 0.656341
0.6915 --- loss: 1.479621, loss_ss: 0.941179, loss_d: 0.538442
0.7299 --- loss: 1.817949, loss_ss: 1.171366, loss_d: 0.646584
0.7683 --- loss: 1.052205, loss_ss: 0.793932, loss_d: 0.258273
0.8068 --- loss: 1.154718, loss_ss: 0.823744, loss_d: 0.330974
0.8452 --- loss: 1.154514, loss_ss: 0.999174, loss_d: 0.155339
0.8836 --- loss: 1.322042, loss_ss: 0.831399, loss_d: 0.490643
0.9220 --- loss: 1.152616, loss_ss: 0.957745, loss_d: 0.194871
0.9604 --- loss: 1.780082, loss_ss: 1.529364, loss_d: 0.250718
0.9988 --- loss: 2.057339, loss_ss: 1.467997, loss_d: 0.589342
Epoch finished! Loss: 1.4468875442559903
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.122765, loss_ss: 0.915317, loss_d: 0.207448
0.0384 --- loss: 1.186826, loss_ss: 0.956930, loss_d: 0.229896
0.0768 --- loss: 1.235773, loss_ss: 1.057083, loss_d: 0.178689
0.1153 --- loss: 1.160938, loss_ss: 1.038579, loss_d: 0.122359
0.1537 --- loss: 1.064937, loss_ss: 0.844177, loss_d: 0.220759
0.1921 --- loss: 1.802305, loss_ss: 1.426723, loss_d: 0.375582
0.2305 --- loss: 1.290256, loss_ss: 1.117149, loss_d: 0.173107
0.2689 --- loss: 1.400695, loss_ss: 1.090769, loss_d: 0.309926
0.3073 --- loss: 1.299066, loss_ss: 0.923972, loss_d: 0.375094
0.3458 --- loss: 1.572158, loss_ss: 0.975416, loss_d: 0.596742
0.3842 --- loss: 1.095355, loss_ss: 0.958048, loss_d: 0.137307
0.4226 --- loss: 1.406454, loss_ss: 1.246870, loss_d: 0.159584
0.4610 --- loss: 1.122348, loss_ss: 0.954096, loss_d: 0.168252
0.4994 --- loss: 1.130793, loss_ss: 0.927304, loss_d: 0.203489
0.5378 --- loss: 1.223169, loss_ss: 0.871858, loss_d: 0.351311
0.5763 --- loss: 1.038848, loss_ss: 0.875385, loss_d: 0.163463
0.6147 --- loss: 1.272260, loss_ss: 0.938105, loss_d: 0.334155
0.6531 --- loss: 1.087732, loss_ss: 0.983682, loss_d: 0.104050
0.6915 --- loss: 1.239091, loss_ss: 1.039781, loss_d: 0.199311
0.7299 --- loss: 1.297519, loss_ss: 0.980775, loss_d: 0.316743
0.7683 --- loss: 1.077974, loss_ss: 0.947306, loss_d: 0.130668
0.8068 --- loss: 1.100637, loss_ss: 0.913674, loss_d: 0.186963
0.8452 --- loss: 1.384286, loss_ss: 0.865696, loss_d: 0.518590
0.8836 --- loss: 1.280460, loss_ss: 0.971176, loss_d: 0.309283
0.9220 --- loss: 1.042379, loss_ss: 0.918030, loss_d: 0.124350
0.9604 --- loss: 0.758870, loss_ss: 0.724233, loss_d: 0.034636
0.9988 --- loss: 1.872663, loss_ss: 1.642465, loss_d: 0.230198
Epoch finished! Loss: 1.2747436649524249
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.917119, loss_ss: 0.826903, loss_d: 0.090216
0.0384 --- loss: 1.011798, loss_ss: 0.872986, loss_d: 0.138812
0.0768 --- loss: 1.183594, loss_ss: 1.077625, loss_d: 0.105969
0.1153 --- loss: 1.059637, loss_ss: 0.908884, loss_d: 0.150753
0.1537 --- loss: 1.342578, loss_ss: 1.015266, loss_d: 0.327312
0.1921 --- loss: 1.175565, loss_ss: 0.813584, loss_d: 0.361982
0.2305 --- loss: 1.694741, loss_ss: 1.122878, loss_d: 0.571863
0.2689 --- loss: 0.892292, loss_ss: 0.762955, loss_d: 0.129338
0.3073 --- loss: 1.026323, loss_ss: 0.968588, loss_d: 0.057735
0.3458 --- loss: 1.143180, loss_ss: 1.076586, loss_d: 0.066594
0.3842 --- loss: 1.076688, loss_ss: 0.994884, loss_d: 0.081804
0.4226 --- loss: 1.529599, loss_ss: 1.066481, loss_d: 0.463118
0.4610 --- loss: 1.128652, loss_ss: 0.962779, loss_d: 0.165873
0.4994 --- loss: 1.423372, loss_ss: 1.092071, loss_d: 0.331300
0.5378 --- loss: 1.078011, loss_ss: 0.948608, loss_d: 0.129403
0.5763 --- loss: 1.049323, loss_ss: 0.926085, loss_d: 0.123239
0.6147 --- loss: 0.973759, loss_ss: 0.874109, loss_d: 0.099650
0.6531 --- loss: 1.383001, loss_ss: 1.208449, loss_d: 0.174552
0.6915 --- loss: 0.865555, loss_ss: 0.815196, loss_d: 0.050359
0.7299 --- loss: 0.902154, loss_ss: 0.802472, loss_d: 0.099683
0.7683 --- loss: 1.237193, loss_ss: 1.067808, loss_d: 0.169385
0.8068 --- loss: 1.253104, loss_ss: 1.081479, loss_d: 0.171625
0.8452 --- loss: 1.056609, loss_ss: 0.900239, loss_d: 0.156370
0.8836 --- loss: 1.081671, loss_ss: 0.793586, loss_d: 0.288085
0.9220 --- loss: 1.082657, loss_ss: 0.920702, loss_d: 0.161955
0.9604 --- loss: 1.114546, loss_ss: 0.765174, loss_d: 0.349372
0.9988 --- loss: 1.731082, loss_ss: 1.618587, loss_d: 0.112494
Epoch finished! Loss: 1.1928642256901814
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.121274, loss_ss: 0.894935, loss_d: 0.226339
0.0384 --- loss: 1.085091, loss_ss: 1.033074, loss_d: 0.052017
0.0768 --- loss: 1.077399, loss_ss: 0.671823, loss_d: 0.405576
0.1153 --- loss: 1.083959, loss_ss: 0.949268, loss_d: 0.134691
0.1537 --- loss: 1.660659, loss_ss: 1.143801, loss_d: 0.516858
0.1921 --- loss: 1.822002, loss_ss: 1.057242, loss_d: 0.764760
0.2305 --- loss: 1.174706, loss_ss: 1.035453, loss_d: 0.139253
0.2689 --- loss: 1.054549, loss_ss: 0.842753, loss_d: 0.211797
0.3073 --- loss: 1.642008, loss_ss: 1.022475, loss_d: 0.619533
0.3458 --- loss: 1.257790, loss_ss: 0.821265, loss_d: 0.436525
0.3842 --- loss: 1.337860, loss_ss: 1.027292, loss_d: 0.310568
0.4226 --- loss: 1.404998, loss_ss: 0.960892, loss_d: 0.444106
0.4610 --- loss: 0.930686, loss_ss: 0.720673, loss_d: 0.210013
0.4994 --- loss: 0.859468, loss_ss: 0.767141, loss_d: 0.092328
0.5378 --- loss: 0.964262, loss_ss: 0.696349, loss_d: 0.267913
0.5763 --- loss: 1.046962, loss_ss: 0.769280, loss_d: 0.277682
0.6147 --- loss: 1.024515, loss_ss: 0.951985, loss_d: 0.072530
0.6531 --- loss: 1.289510, loss_ss: 0.971835, loss_d: 0.317676
0.6915 --- loss: 1.206143, loss_ss: 0.910813, loss_d: 0.295330
0.7299 --- loss: 0.931085, loss_ss: 0.878024, loss_d: 0.053061
0.7683 --- loss: 0.996298, loss_ss: 0.929945, loss_d: 0.066353
0.8068 --- loss: 1.274204, loss_ss: 0.717652, loss_d: 0.556552
0.8452 --- loss: 1.435431, loss_ss: 1.373517, loss_d: 0.061914
0.8836 --- loss: 0.968597, loss_ss: 0.909162, loss_d: 0.059435
0.9220 --- loss: 1.289703, loss_ss: 0.950126, loss_d: 0.339576
0.9604 --- loss: 0.866952, loss_ss: 0.670911, loss_d: 0.196041
0.9988 --- loss: 2.151198, loss_ss: 2.104883, loss_d: 0.046315
Epoch finished! Loss: 1.1300403436789146
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.731630, loss_ss: 0.680843, loss_d: 0.050787
0.0384 --- loss: 0.877293, loss_ss: 0.744314, loss_d: 0.132979
0.0768 --- loss: 0.936038, loss_ss: 0.737945, loss_d: 0.198092
0.1153 --- loss: 0.928115, loss_ss: 0.890586, loss_d: 0.037528
0.1537 --- loss: 1.202237, loss_ss: 1.111424, loss_d: 0.090813
0.1921 --- loss: 1.344353, loss_ss: 1.112103, loss_d: 0.232250
0.2305 --- loss: 0.931796, loss_ss: 0.878034, loss_d: 0.053762
0.2689 --- loss: 1.723446, loss_ss: 1.322489, loss_d: 0.400958
0.3073 --- loss: 0.752488, loss_ss: 0.722280, loss_d: 0.030208
0.3458 --- loss: 1.441010, loss_ss: 1.271084, loss_d: 0.169927
0.3842 --- loss: 1.155507, loss_ss: 1.055148, loss_d: 0.100359
0.4226 --- loss: 1.232105, loss_ss: 1.048968, loss_d: 0.183137
0.4610 --- loss: 1.388906, loss_ss: 0.652093, loss_d: 0.736814
0.4994 --- loss: 1.136885, loss_ss: 0.943164, loss_d: 0.193721
0.5378 --- loss: 0.918013, loss_ss: 0.782642, loss_d: 0.135372
0.5763 --- loss: 0.875853, loss_ss: 0.851577, loss_d: 0.024276
0.6147 --- loss: 0.975762, loss_ss: 0.851583, loss_d: 0.124178
0.6531 --- loss: 1.134630, loss_ss: 0.999000, loss_d: 0.135630
0.6915 --- loss: 0.884342, loss_ss: 0.849261, loss_d: 0.035082
0.7299 --- loss: 1.252060, loss_ss: 0.625934, loss_d: 0.626126
0.7683 --- loss: 0.689501, loss_ss: 0.650250, loss_d: 0.039251
0.8068 --- loss: 1.122553, loss_ss: 0.790170, loss_d: 0.332383
0.8452 --- loss: 0.992637, loss_ss: 0.916398, loss_d: 0.076239
0.8836 --- loss: 1.017707, loss_ss: 0.893079, loss_d: 0.124628
0.9220 --- loss: 1.045792, loss_ss: 0.846172, loss_d: 0.199620
0.9604 --- loss: 1.268854, loss_ss: 0.817187, loss_d: 0.451667
0.9988 --- loss: 1.819449, loss_ss: 1.785343, loss_d: 0.034107
Epoch finished! Loss: 1.071921292405862
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.012802, loss_ss: 0.875477, loss_d: 0.137325
0.0384 --- loss: 0.760688, loss_ss: 0.714586, loss_d: 0.046102
0.0768 --- loss: 1.844077, loss_ss: 1.199165, loss_d: 0.644911
0.1153 --- loss: 1.470115, loss_ss: 1.006438, loss_d: 0.463677
0.1537 --- loss: 1.504537, loss_ss: 1.203980, loss_d: 0.300557
0.1921 --- loss: 0.815653, loss_ss: 0.616382, loss_d: 0.199270
0.2305 --- loss: 1.172268, loss_ss: 0.904275, loss_d: 0.267993
0.2689 --- loss: 1.007340, loss_ss: 0.831373, loss_d: 0.175967
0.3073 --- loss: 0.710132, loss_ss: 0.662572, loss_d: 0.047560
0.3458 --- loss: 0.951859, loss_ss: 0.823800, loss_d: 0.128059
0.3842 --- loss: 0.868647, loss_ss: 0.787581, loss_d: 0.081066
0.4226 --- loss: 1.146846, loss_ss: 1.028055, loss_d: 0.118792
0.4610 --- loss: 1.017831, loss_ss: 0.996041, loss_d: 0.021790
0.4994 --- loss: 0.869733, loss_ss: 0.832375, loss_d: 0.037358
0.5378 --- loss: 0.767011, loss_ss: 0.721924, loss_d: 0.045087
0.5763 --- loss: 1.134662, loss_ss: 0.672425, loss_d: 0.462238
0.6147 --- loss: 1.141136, loss_ss: 0.729873, loss_d: 0.411264
0.6531 --- loss: 1.337938, loss_ss: 1.238041, loss_d: 0.099898
0.6915 --- loss: 1.459517, loss_ss: 1.263504, loss_d: 0.196013
0.7299 --- loss: 0.796755, loss_ss: 0.779356, loss_d: 0.017399
0.7683 --- loss: 0.949653, loss_ss: 0.878404, loss_d: 0.071249
0.8068 --- loss: 0.908582, loss_ss: 0.689204, loss_d: 0.219378
0.8452 --- loss: 0.779104, loss_ss: 0.724039, loss_d: 0.055064
0.8836 --- loss: 2.847191, loss_ss: 1.107394, loss_d: 1.739797
0.9220 --- loss: 0.865600, loss_ss: 0.799401, loss_d: 0.066199
0.9604 --- loss: 1.245876, loss_ss: 1.138297, loss_d: 0.107579
0.9988 --- loss: 2.337261, loss_ss: 2.237612, loss_d: 0.099650
Epoch finished! Loss: 1.028422342126186
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.940636, loss_ss: 0.931272, loss_d: 0.009364
0.0384 --- loss: 0.956730, loss_ss: 0.911551, loss_d: 0.045179
0.0768 --- loss: 0.727412, loss_ss: 0.677795, loss_d: 0.049617
0.1153 --- loss: 0.974231, loss_ss: 0.709403, loss_d: 0.264828
0.1537 --- loss: 0.794026, loss_ss: 0.747919, loss_d: 0.046106
0.1921 --- loss: 0.792922, loss_ss: 0.767388, loss_d: 0.025533
0.2305 --- loss: 0.951974, loss_ss: 0.862062, loss_d: 0.089912
0.2689 --- loss: 1.195078, loss_ss: 0.892751, loss_d: 0.302328
0.3073 --- loss: 1.169997, loss_ss: 1.115567, loss_d: 0.054430
0.3458 --- loss: 1.151683, loss_ss: 1.110327, loss_d: 0.041356
0.3842 --- loss: 1.211199, loss_ss: 0.754892, loss_d: 0.456307
0.4226 --- loss: 0.595563, loss_ss: 0.525879, loss_d: 0.069684
0.4610 --- loss: 0.962101, loss_ss: 0.932630, loss_d: 0.029470
0.4994 --- loss: 0.795826, loss_ss: 0.678125, loss_d: 0.117702
0.5378 --- loss: 0.803961, loss_ss: 0.781193, loss_d: 0.022768
0.5763 --- loss: 1.490467, loss_ss: 1.004422, loss_d: 0.486044
0.6147 --- loss: 0.915615, loss_ss: 0.890374, loss_d: 0.025241
0.6531 --- loss: 0.967624, loss_ss: 0.590354, loss_d: 0.377270
0.6915 --- loss: 1.307623, loss_ss: 0.951494, loss_d: 0.356129
0.7299 --- loss: 0.976585, loss_ss: 0.900277, loss_d: 0.076308
0.7683 --- loss: 0.828246, loss_ss: 0.791027, loss_d: 0.037220
0.8068 --- loss: 1.111640, loss_ss: 1.097895, loss_d: 0.013745
0.8452 --- loss: 1.321718, loss_ss: 0.959568, loss_d: 0.362150
0.8836 --- loss: 1.020528, loss_ss: 0.882697, loss_d: 0.137832
0.9220 --- loss: 1.057820, loss_ss: 0.643135, loss_d: 0.414686
0.9604 --- loss: 1.557377, loss_ss: 1.165031, loss_d: 0.392346
0.9988 --- loss: 1.291091, loss_ss: 1.282611, loss_d: 0.008480
Epoch finished! Loss: 1.0233392692529237
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.861067, loss_ss: 0.790244, loss_d: 0.070823
0.0384 --- loss: 1.229397, loss_ss: 1.128534, loss_d: 0.100863
0.0768 --- loss: 0.985509, loss_ss: 0.971674, loss_d: 0.013835
0.1153 --- loss: 0.816464, loss_ss: 0.589770, loss_d: 0.226694
0.1537 --- loss: 0.777486, loss_ss: 0.703098, loss_d: 0.074389
0.1921 --- loss: 0.824189, loss_ss: 0.809141, loss_d: 0.015048
0.2305 --- loss: 0.816485, loss_ss: 0.794714, loss_d: 0.021771
0.2689 --- loss: 0.677296, loss_ss: 0.674116, loss_d: 0.003181
0.3073 --- loss: 0.996605, loss_ss: 0.786991, loss_d: 0.209614
0.3458 --- loss: 0.943030, loss_ss: 0.693394, loss_d: 0.249635
0.3842 --- loss: 1.010017, loss_ss: 0.889498, loss_d: 0.120519
0.4226 --- loss: 0.804877, loss_ss: 0.735423, loss_d: 0.069454
0.4610 --- loss: 0.678865, loss_ss: 0.659116, loss_d: 0.019749
0.4994 --- loss: 1.122865, loss_ss: 1.084065, loss_d: 0.038800
0.5378 --- loss: 1.125346, loss_ss: 0.984517, loss_d: 0.140829
0.5763 --- loss: 1.187099, loss_ss: 1.058856, loss_d: 0.128244
0.6147 --- loss: 0.869420, loss_ss: 0.811305, loss_d: 0.058115
0.6531 --- loss: 0.998557, loss_ss: 0.962274, loss_d: 0.036283
0.6915 --- loss: 0.995528, loss_ss: 0.682294, loss_d: 0.313234
0.7299 --- loss: 0.703738, loss_ss: 0.603364, loss_d: 0.100374
0.7683 --- loss: 0.851628, loss_ss: 0.765650, loss_d: 0.085977
0.8068 --- loss: 1.222606, loss_ss: 1.179204, loss_d: 0.043403
0.8452 --- loss: 0.962331, loss_ss: 0.780636, loss_d: 0.181695
0.8836 --- loss: 1.905709, loss_ss: 0.755619, loss_d: 1.150090
0.9220 --- loss: 0.876440, loss_ss: 0.864981, loss_d: 0.011459
0.9604 --- loss: 1.292184, loss_ss: 1.014339, loss_d: 0.277845
0.9988 --- loss: 1.487893, loss_ss: 1.319993, loss_d: 0.167900
Epoch finished! Loss: 0.993239069214234
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.064294, loss_ss: 1.023779, loss_d: 0.040515
0.0384 --- loss: 0.967594, loss_ss: 0.799216, loss_d: 0.168378
0.0768 --- loss: 1.337595, loss_ss: 1.064655, loss_d: 0.272940
0.1153 --- loss: 0.736926, loss_ss: 0.724440, loss_d: 0.012485
0.1537 --- loss: 0.940341, loss_ss: 0.824930, loss_d: 0.115410
0.1921 --- loss: 1.079995, loss_ss: 0.846355, loss_d: 0.233640
0.2305 --- loss: 0.774573, loss_ss: 0.734773, loss_d: 0.039800
0.2689 --- loss: 1.179294, loss_ss: 1.101324, loss_d: 0.077970
0.3073 --- loss: 0.799855, loss_ss: 0.676672, loss_d: 0.123183
0.3458 --- loss: 1.045099, loss_ss: 1.022624, loss_d: 0.022475
0.3842 --- loss: 1.041712, loss_ss: 1.018287, loss_d: 0.023425
0.4226 --- loss: 1.051222, loss_ss: 0.903917, loss_d: 0.147305
0.4610 --- loss: 0.747684, loss_ss: 0.687749, loss_d: 0.059934
0.4994 --- loss: 0.758781, loss_ss: 0.644378, loss_d: 0.114402
0.5378 --- loss: 0.997990, loss_ss: 0.973982, loss_d: 0.024008
0.5763 --- loss: 0.925565, loss_ss: 0.894195, loss_d: 0.031370
0.6147 --- loss: 0.871727, loss_ss: 0.795630, loss_d: 0.076098
0.6531 --- loss: 1.197111, loss_ss: 1.124760, loss_d: 0.072350
0.6915 --- loss: 0.800007, loss_ss: 0.795348, loss_d: 0.004660
0.7299 --- loss: 0.722031, loss_ss: 0.657926, loss_d: 0.064106
0.7683 --- loss: 0.956137, loss_ss: 0.743560, loss_d: 0.212577
0.8068 --- loss: 1.153536, loss_ss: 1.134928, loss_d: 0.018608
0.8452 --- loss: 1.027038, loss_ss: 0.609796, loss_d: 0.417241
0.8836 --- loss: 0.877930, loss_ss: 0.695281, loss_d: 0.182649
0.9220 --- loss: 1.012541, loss_ss: 0.780545, loss_d: 0.231996
0.9604 --- loss: 0.687407, loss_ss: 0.666729, loss_d: 0.020678
0.9988 --- loss: 2.598477, loss_ss: 2.144410, loss_d: 0.454067
Epoch finished! Loss: 0.9301055607887415
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5666666666666667
             precision    recall  f1-score   support

        0.0       0.38      0.96      0.54        25
        1.0       0.23      0.45      0.30        93
        2.0       0.45      0.58      0.51       324
        3.0       0.98      0.56      0.71       484
        4.0       0.65      0.55      0.59       124

avg / total       0.70      0.57      0.60      1050
 


====== chp044-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.10  96.00   96.10  37.50     53.93
1  81.71  45.16   85.27  22.95     30.43
2  65.14  58.33   68.18  45.00     50.81
3  79.24  56.20   98.94  97.84     71.39
4  91.14  54.84   96.00  64.76     59.39
Total accuracy: 56.67%
Average sen: 62.11%
Average spec: 88.90%
Macro f1-score: 53.19%
Diagnosis acc on 15mins: 1.0
[0.99984932 0.99947137 0.99977165 0.99995613 0.99984717 0.99940181
 0.99843019 0.98230064 0.99939656 0.99607348 0.99787652 0.98090476
 0.98088056 0.9872362  0.99973541 0.99973458 0.99991691 0.99992287
 0.99940431 0.99684048 0.99750692 0.99600416 0.98433256 0.99736065
 0.99866986 0.9996978  0.99606341 0.99284703 0.98964792 0.99937028
 0.99870014 0.9998976  0.91595632 0.97565049 0.99686533]
pred: 0.993014897618975, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.358781, loss_ss: 1.648693, loss_d: 0.710088
0.0385 --- loss: 2.146621, loss_ss: 1.488353, loss_d: 0.658268
0.0770 --- loss: 1.913489, loss_ss: 1.554730, loss_d: 0.358760
0.1155 --- loss: 2.022056, loss_ss: 1.468735, loss_d: 0.553321
0.1540 --- loss: 2.244117, loss_ss: 1.516049, loss_d: 0.728068
0.1925 --- loss: 2.120049, loss_ss: 1.533235, loss_d: 0.586814
0.2309 --- loss: 1.915940, loss_ss: 1.350572, loss_d: 0.565367
0.2694 --- loss: 2.008476, loss_ss: 1.380527, loss_d: 0.627949
0.3079 --- loss: 1.826082, loss_ss: 1.333698, loss_d: 0.492384
0.3464 --- loss: 2.163627, loss_ss: 1.499600, loss_d: 0.664028
0.3849 --- loss: 2.036268, loss_ss: 1.310212, loss_d: 0.726056
0.4234 --- loss: 1.871222, loss_ss: 1.487905, loss_d: 0.383316
0.4619 --- loss: 1.777320, loss_ss: 1.458804, loss_d: 0.318516
0.5004 --- loss: 2.171077, loss_ss: 1.277224, loss_d: 0.893853
0.5389 --- loss: 2.063695, loss_ss: 1.493340, loss_d: 0.570356
0.5774 --- loss: 1.862664, loss_ss: 1.179015, loss_d: 0.683649
0.6159 --- loss: 1.777048, loss_ss: 1.191874, loss_d: 0.585174
0.6543 --- loss: 1.684457, loss_ss: 1.314974, loss_d: 0.369483
0.6928 --- loss: 2.197274, loss_ss: 1.303311, loss_d: 0.893963
0.7313 --- loss: 1.960157, loss_ss: 1.418527, loss_d: 0.541630
0.7698 --- loss: 1.826385, loss_ss: 1.397466, loss_d: 0.428920
0.8083 --- loss: 1.832149, loss_ss: 1.207297, loss_d: 0.624852
0.8468 --- loss: 1.638308, loss_ss: 1.222162, loss_d: 0.416145
0.8853 --- loss: 1.748402, loss_ss: 1.257446, loss_d: 0.490956
0.9238 --- loss: 1.731869, loss_ss: 1.290517, loss_d: 0.441352
0.9623 --- loss: 1.487218, loss_ss: 1.156971, loss_d: 0.330247
Epoch finished! Loss: 1.8926236762963666
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.287732, loss_ss: 1.128184, loss_d: 0.159548
0.0385 --- loss: 1.435588, loss_ss: 1.158188, loss_d: 0.277399
0.0770 --- loss: 1.435178, loss_ss: 1.039728, loss_d: 0.395450
0.1155 --- loss: 1.286088, loss_ss: 0.988800, loss_d: 0.297288
0.1540 --- loss: 1.186760, loss_ss: 1.073541, loss_d: 0.113220
0.1925 --- loss: 1.378929, loss_ss: 1.033739, loss_d: 0.345190
0.2309 --- loss: 1.887861, loss_ss: 1.350576, loss_d: 0.537285
0.2694 --- loss: 1.460153, loss_ss: 1.001780, loss_d: 0.458373
0.3079 --- loss: 1.202024, loss_ss: 0.816218, loss_d: 0.385806
0.3464 --- loss: 1.672399, loss_ss: 1.186449, loss_d: 0.485950
0.3849 --- loss: 1.447948, loss_ss: 1.009248, loss_d: 0.438699
0.4234 --- loss: 1.363855, loss_ss: 1.170225, loss_d: 0.193630
0.4619 --- loss: 1.544823, loss_ss: 1.290504, loss_d: 0.254319
0.5004 --- loss: 1.681799, loss_ss: 1.430128, loss_d: 0.251671
0.5389 --- loss: 1.308640, loss_ss: 1.127221, loss_d: 0.181419
0.5774 --- loss: 1.152022, loss_ss: 1.001243, loss_d: 0.150779
0.6159 --- loss: 1.284919, loss_ss: 1.063317, loss_d: 0.221602
0.6543 --- loss: 1.439542, loss_ss: 0.997431, loss_d: 0.442111
0.6928 --- loss: 1.744637, loss_ss: 1.185499, loss_d: 0.559138
0.7313 --- loss: 1.307875, loss_ss: 1.052786, loss_d: 0.255089
0.7698 --- loss: 1.229617, loss_ss: 0.911877, loss_d: 0.317740
0.8083 --- loss: 1.128827, loss_ss: 1.066080, loss_d: 0.062747
0.8468 --- loss: 1.138994, loss_ss: 0.763824, loss_d: 0.375170
0.8853 --- loss: 1.564690, loss_ss: 0.944870, loss_d: 0.619820
0.9238 --- loss: 1.350533, loss_ss: 0.871784, loss_d: 0.478749
0.9623 --- loss: 1.796060, loss_ss: 1.358445, loss_d: 0.437615
Epoch finished! Loss: 1.479838528458216
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.192882, loss_ss: 0.983158, loss_d: 0.209725
0.0385 --- loss: 1.379063, loss_ss: 1.200616, loss_d: 0.178447
0.0770 --- loss: 1.446182, loss_ss: 0.888557, loss_d: 0.557624
0.1155 --- loss: 1.281051, loss_ss: 1.128963, loss_d: 0.152088
0.1540 --- loss: 1.290756, loss_ss: 1.096030, loss_d: 0.194726
0.1925 --- loss: 1.545078, loss_ss: 0.978859, loss_d: 0.566219
0.2309 --- loss: 1.389458, loss_ss: 0.962998, loss_d: 0.426460
0.2694 --- loss: 1.650577, loss_ss: 1.415904, loss_d: 0.234673
0.3079 --- loss: 1.066681, loss_ss: 0.961986, loss_d: 0.104695
0.3464 --- loss: 0.932257, loss_ss: 0.869224, loss_d: 0.063033
0.3849 --- loss: 1.053258, loss_ss: 0.881955, loss_d: 0.171303
0.4234 --- loss: 1.144112, loss_ss: 0.968612, loss_d: 0.175499
0.4619 --- loss: 1.140659, loss_ss: 1.002974, loss_d: 0.137685
0.5004 --- loss: 0.954800, loss_ss: 0.907896, loss_d: 0.046903
0.5389 --- loss: 0.894890, loss_ss: 0.786937, loss_d: 0.107953
0.5774 --- loss: 1.024492, loss_ss: 0.859390, loss_d: 0.165103
0.6159 --- loss: 1.362283, loss_ss: 1.130442, loss_d: 0.231840
0.6543 --- loss: 1.067985, loss_ss: 0.922267, loss_d: 0.145718
0.6928 --- loss: 1.230606, loss_ss: 1.078988, loss_d: 0.151618
0.7313 --- loss: 0.979896, loss_ss: 0.796164, loss_d: 0.183732
0.7698 --- loss: 1.509350, loss_ss: 0.995170, loss_d: 0.514181
0.8083 --- loss: 1.129178, loss_ss: 0.881491, loss_d: 0.247687
0.8468 --- loss: 1.760214, loss_ss: 0.938301, loss_d: 0.821913
0.8853 --- loss: 1.283957, loss_ss: 0.983297, loss_d: 0.300660
0.9238 --- loss: 1.149073, loss_ss: 1.102815, loss_d: 0.046258
0.9623 --- loss: 1.599390, loss_ss: 0.973334, loss_d: 0.626055
Epoch finished! Loss: 1.2671967859894153
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.045518, loss_ss: 0.949760, loss_d: 0.095758
0.0385 --- loss: 0.850219, loss_ss: 0.711093, loss_d: 0.139126
0.0770 --- loss: 1.160261, loss_ss: 0.888911, loss_d: 0.271350
0.1155 --- loss: 0.856246, loss_ss: 0.675516, loss_d: 0.180729
0.1540 --- loss: 1.098455, loss_ss: 1.049786, loss_d: 0.048669
0.1925 --- loss: 1.746324, loss_ss: 1.472040, loss_d: 0.274284
0.2309 --- loss: 1.131642, loss_ss: 0.995692, loss_d: 0.135951
0.2694 --- loss: 1.209879, loss_ss: 1.035928, loss_d: 0.173951
0.3079 --- loss: 1.152063, loss_ss: 0.960092, loss_d: 0.191971
0.3464 --- loss: 1.079849, loss_ss: 0.980768, loss_d: 0.099081
0.3849 --- loss: 1.203137, loss_ss: 1.073695, loss_d: 0.129442
0.4234 --- loss: 1.422223, loss_ss: 1.340589, loss_d: 0.081634
0.4619 --- loss: 1.009987, loss_ss: 0.770276, loss_d: 0.239712
0.5004 --- loss: 0.980635, loss_ss: 0.924582, loss_d: 0.056053
0.5389 --- loss: 1.830607, loss_ss: 0.819252, loss_d: 1.011356
0.5774 --- loss: 1.130654, loss_ss: 1.075780, loss_d: 0.054874
0.6159 --- loss: 1.293679, loss_ss: 0.753701, loss_d: 0.539978
0.6543 --- loss: 1.225095, loss_ss: 1.030971, loss_d: 0.194124
0.6928 --- loss: 1.333750, loss_ss: 0.869777, loss_d: 0.463972
0.7313 --- loss: 0.974637, loss_ss: 0.867018, loss_d: 0.107620
0.7698 --- loss: 1.409643, loss_ss: 0.870549, loss_d: 0.539094
0.8083 --- loss: 1.495022, loss_ss: 0.845774, loss_d: 0.649248
0.8468 --- loss: 1.139416, loss_ss: 0.833553, loss_d: 0.305862
0.8853 --- loss: 1.326742, loss_ss: 1.161321, loss_d: 0.165422
0.9238 --- loss: 0.876253, loss_ss: 0.824594, loss_d: 0.051659
0.9623 --- loss: 1.152640, loss_ss: 1.116043, loss_d: 0.036597
Epoch finished! Loss: 1.1928793362208776
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.042437, loss_ss: 0.968114, loss_d: 0.074323
0.0385 --- loss: 1.008835, loss_ss: 0.960408, loss_d: 0.048427
0.0770 --- loss: 1.094474, loss_ss: 0.932709, loss_d: 0.161765
0.1155 --- loss: 1.195755, loss_ss: 0.965007, loss_d: 0.230748
0.1540 --- loss: 1.911219, loss_ss: 0.854390, loss_d: 1.056829
0.1925 --- loss: 1.099144, loss_ss: 1.033092, loss_d: 0.066052
0.2309 --- loss: 1.064938, loss_ss: 0.955107, loss_d: 0.109832
0.2694 --- loss: 0.841250, loss_ss: 0.797835, loss_d: 0.043415
0.3079 --- loss: 0.981960, loss_ss: 0.847585, loss_d: 0.134375
0.3464 --- loss: 1.190735, loss_ss: 1.055943, loss_d: 0.134792
0.3849 --- loss: 0.899634, loss_ss: 0.781729, loss_d: 0.117905
0.4234 --- loss: 1.241592, loss_ss: 1.176844, loss_d: 0.064748
0.4619 --- loss: 1.083067, loss_ss: 0.872229, loss_d: 0.210838
0.5004 --- loss: 1.276986, loss_ss: 1.129492, loss_d: 0.147494
0.5389 --- loss: 1.124731, loss_ss: 0.905246, loss_d: 0.219485
0.5774 --- loss: 0.972053, loss_ss: 0.663726, loss_d: 0.308327
0.6159 --- loss: 0.950074, loss_ss: 0.868636, loss_d: 0.081438
0.6543 --- loss: 0.965207, loss_ss: 0.784268, loss_d: 0.180939
0.6928 --- loss: 0.951806, loss_ss: 0.881944, loss_d: 0.069862
0.7313 --- loss: 1.043755, loss_ss: 0.903190, loss_d: 0.140565
0.7698 --- loss: 1.474816, loss_ss: 1.437473, loss_d: 0.037343
0.8083 --- loss: 1.077840, loss_ss: 0.778095, loss_d: 0.299745
0.8468 --- loss: 1.186405, loss_ss: 0.840462, loss_d: 0.345943
0.8853 --- loss: 1.236589, loss_ss: 1.146579, loss_d: 0.090010
0.9238 --- loss: 0.923344, loss_ss: 0.821599, loss_d: 0.101745
0.9623 --- loss: 0.881207, loss_ss: 0.767231, loss_d: 0.113976
Epoch finished! Loss: 1.1375101491751358
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.686295, loss_ss: 1.304270, loss_d: 0.382025
0.0385 --- loss: 0.852551, loss_ss: 0.830562, loss_d: 0.021989
0.0770 --- loss: 1.060698, loss_ss: 0.883108, loss_d: 0.177591
0.1155 --- loss: 1.278886, loss_ss: 0.958056, loss_d: 0.320830
0.1540 --- loss: 0.962353, loss_ss: 0.789018, loss_d: 0.173335
0.1925 --- loss: 0.944978, loss_ss: 0.868920, loss_d: 0.076058
0.2309 --- loss: 1.177297, loss_ss: 0.802952, loss_d: 0.374345
0.2694 --- loss: 1.024606, loss_ss: 0.954668, loss_d: 0.069938
0.3079 --- loss: 0.902903, loss_ss: 0.844102, loss_d: 0.058801
0.3464 --- loss: 0.886876, loss_ss: 0.687184, loss_d: 0.199692
0.3849 --- loss: 1.086746, loss_ss: 1.007917, loss_d: 0.078829
0.4234 --- loss: 1.177566, loss_ss: 0.772689, loss_d: 0.404878
0.4619 --- loss: 0.830081, loss_ss: 0.669722, loss_d: 0.160359
0.5004 --- loss: 1.486568, loss_ss: 1.098009, loss_d: 0.388559
0.5389 --- loss: 1.127227, loss_ss: 0.703204, loss_d: 0.424024
0.5774 --- loss: 1.030099, loss_ss: 0.882726, loss_d: 0.147373
0.6159 --- loss: 0.983470, loss_ss: 0.963854, loss_d: 0.019616
0.6543 --- loss: 0.980399, loss_ss: 0.924353, loss_d: 0.056047
0.6928 --- loss: 1.153313, loss_ss: 1.138920, loss_d: 0.014393
0.7313 --- loss: 0.902162, loss_ss: 0.789849, loss_d: 0.112312
0.7698 --- loss: 0.894636, loss_ss: 0.790068, loss_d: 0.104568
0.8083 --- loss: 1.035319, loss_ss: 1.017253, loss_d: 0.018066
0.8468 --- loss: 1.262318, loss_ss: 0.959585, loss_d: 0.302734
0.8853 --- loss: 1.117493, loss_ss: 0.815889, loss_d: 0.301604
0.9238 --- loss: 1.216018, loss_ss: 0.948266, loss_d: 0.267752
0.9623 --- loss: 0.900063, loss_ss: 0.726058, loss_d: 0.174005
Epoch finished! Loss: 1.0715438286309997
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.391113, loss_ss: 1.223430, loss_d: 0.167683
0.0385 --- loss: 0.839309, loss_ss: 0.808696, loss_d: 0.030613
0.0770 --- loss: 1.213202, loss_ss: 1.057199, loss_d: 0.156003
0.1155 --- loss: 1.484004, loss_ss: 1.009719, loss_d: 0.474285
0.1540 --- loss: 0.933695, loss_ss: 0.894476, loss_d: 0.039219
0.1925 --- loss: 0.909404, loss_ss: 0.853311, loss_d: 0.056093
0.2309 --- loss: 0.977859, loss_ss: 0.842384, loss_d: 0.135476
0.2694 --- loss: 1.011768, loss_ss: 0.813947, loss_d: 0.197821
0.3079 --- loss: 0.961545, loss_ss: 0.920469, loss_d: 0.041076
0.3464 --- loss: 0.626786, loss_ss: 0.621346, loss_d: 0.005440
0.3849 --- loss: 1.091662, loss_ss: 1.084609, loss_d: 0.007053
0.4234 --- loss: 0.749017, loss_ss: 0.725373, loss_d: 0.023644
0.4619 --- loss: 1.004493, loss_ss: 0.863783, loss_d: 0.140711
0.5004 --- loss: 0.796803, loss_ss: 0.587660, loss_d: 0.209143
0.5389 --- loss: 0.805666, loss_ss: 0.737944, loss_d: 0.067722
0.5774 --- loss: 1.099065, loss_ss: 0.976324, loss_d: 0.122741
0.6159 --- loss: 1.019308, loss_ss: 1.014667, loss_d: 0.004642
0.6543 --- loss: 0.778765, loss_ss: 0.746909, loss_d: 0.031856
0.6928 --- loss: 1.234191, loss_ss: 1.131295, loss_d: 0.102896
0.7313 --- loss: 0.796521, loss_ss: 0.756434, loss_d: 0.040087
0.7698 --- loss: 0.732869, loss_ss: 0.707856, loss_d: 0.025013
0.8083 --- loss: 0.939757, loss_ss: 0.912175, loss_d: 0.027582
0.8468 --- loss: 0.693607, loss_ss: 0.597842, loss_d: 0.095765
0.8853 --- loss: 0.980821, loss_ss: 0.846964, loss_d: 0.133857
0.9238 --- loss: 1.015329, loss_ss: 0.955034, loss_d: 0.060296
0.9623 --- loss: 0.924934, loss_ss: 0.884432, loss_d: 0.040502
Epoch finished! Loss: 1.0043617480049722
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.788550, loss_ss: 0.771823, loss_d: 0.016728
0.0385 --- loss: 0.842134, loss_ss: 0.818155, loss_d: 0.023979
0.0770 --- loss: 1.099854, loss_ss: 1.059296, loss_d: 0.040558
0.1155 --- loss: 0.925228, loss_ss: 0.824193, loss_d: 0.101034
0.1540 --- loss: 0.884601, loss_ss: 0.869461, loss_d: 0.015140
0.1925 --- loss: 1.151759, loss_ss: 1.061376, loss_d: 0.090384
0.2309 --- loss: 0.874891, loss_ss: 0.800292, loss_d: 0.074599
0.2694 --- loss: 1.081535, loss_ss: 0.906268, loss_d: 0.175266
0.3079 --- loss: 1.492109, loss_ss: 1.396675, loss_d: 0.095434
0.3464 --- loss: 0.863358, loss_ss: 0.754700, loss_d: 0.108658
0.3849 --- loss: 0.782541, loss_ss: 0.693842, loss_d: 0.088700
0.4234 --- loss: 0.827334, loss_ss: 0.770338, loss_d: 0.056996
0.4619 --- loss: 0.974034, loss_ss: 0.925012, loss_d: 0.049022
0.5004 --- loss: 1.505859, loss_ss: 0.716948, loss_d: 0.788912
0.5389 --- loss: 1.016184, loss_ss: 0.920494, loss_d: 0.095690
0.5774 --- loss: 0.952309, loss_ss: 0.859240, loss_d: 0.093069
0.6159 --- loss: 1.020039, loss_ss: 0.908484, loss_d: 0.111555
0.6543 --- loss: 0.888865, loss_ss: 0.853806, loss_d: 0.035059
0.6928 --- loss: 1.317289, loss_ss: 0.700542, loss_d: 0.616747
0.7313 --- loss: 1.065871, loss_ss: 1.043880, loss_d: 0.021991
0.7698 --- loss: 0.895111, loss_ss: 0.886163, loss_d: 0.008949
0.8083 --- loss: 1.067497, loss_ss: 1.039880, loss_d: 0.027616
0.8468 --- loss: 1.190601, loss_ss: 1.142011, loss_d: 0.048590
0.8853 --- loss: 0.972621, loss_ss: 0.899014, loss_d: 0.073608
0.9238 --- loss: 0.763485, loss_ss: 0.685349, loss_d: 0.078136
0.9623 --- loss: 0.733850, loss_ss: 0.718730, loss_d: 0.015120
Epoch finished! Loss: 0.9962737699503144
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.903255, loss_ss: 0.849556, loss_d: 0.053699
0.0385 --- loss: 1.172142, loss_ss: 0.934877, loss_d: 0.237265
0.0770 --- loss: 0.857159, loss_ss: 0.850843, loss_d: 0.006316
0.1155 --- loss: 0.853901, loss_ss: 0.843745, loss_d: 0.010156
0.1540 --- loss: 0.973983, loss_ss: 0.950076, loss_d: 0.023907
0.1925 --- loss: 0.913689, loss_ss: 0.889059, loss_d: 0.024630
0.2309 --- loss: 0.826247, loss_ss: 0.799304, loss_d: 0.026944
0.2694 --- loss: 1.213624, loss_ss: 0.764042, loss_d: 0.449582
0.3079 --- loss: 1.315173, loss_ss: 1.239473, loss_d: 0.075700
0.3464 --- loss: 1.064662, loss_ss: 1.022684, loss_d: 0.041978
0.3849 --- loss: 0.697557, loss_ss: 0.600569, loss_d: 0.096989
0.4234 --- loss: 0.978762, loss_ss: 0.927773, loss_d: 0.050989
0.4619 --- loss: 1.266467, loss_ss: 1.099186, loss_d: 0.167281
0.5004 --- loss: 1.332570, loss_ss: 1.030069, loss_d: 0.302500
0.5389 --- loss: 0.788623, loss_ss: 0.712542, loss_d: 0.076081
0.5774 --- loss: 0.609251, loss_ss: 0.592284, loss_d: 0.016968
0.6159 --- loss: 0.791547, loss_ss: 0.626987, loss_d: 0.164561
0.6543 --- loss: 0.914903, loss_ss: 0.887800, loss_d: 0.027104
0.6928 --- loss: 0.790334, loss_ss: 0.719505, loss_d: 0.070829
0.7313 --- loss: 0.630458, loss_ss: 0.612607, loss_d: 0.017851
0.7698 --- loss: 0.589002, loss_ss: 0.580129, loss_d: 0.008874
0.8083 --- loss: 1.051393, loss_ss: 0.869243, loss_d: 0.182150
0.8468 --- loss: 0.897006, loss_ss: 0.855829, loss_d: 0.041177
0.8853 --- loss: 1.101562, loss_ss: 1.091552, loss_d: 0.010010
0.9238 --- loss: 0.882334, loss_ss: 0.808676, loss_d: 0.073659
0.9623 --- loss: 0.832908, loss_ss: 0.825700, loss_d: 0.007208
Epoch finished! Loss: 0.9512345015312254
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.930064, loss_ss: 0.911892, loss_d: 0.018172
0.0385 --- loss: 1.081761, loss_ss: 0.815630, loss_d: 0.266131
0.0770 --- loss: 0.879728, loss_ss: 0.871183, loss_d: 0.008544
0.1155 --- loss: 0.811284, loss_ss: 0.807173, loss_d: 0.004111
0.1540 --- loss: 1.170890, loss_ss: 0.884575, loss_d: 0.286314
0.1925 --- loss: 0.914127, loss_ss: 0.729609, loss_d: 0.184518
0.2309 --- loss: 1.114162, loss_ss: 0.894895, loss_d: 0.219268
0.2694 --- loss: 1.440344, loss_ss: 0.758276, loss_d: 0.682068
0.3079 --- loss: 0.773855, loss_ss: 0.659629, loss_d: 0.114227
0.3464 --- loss: 1.290929, loss_ss: 0.837608, loss_d: 0.453321
0.3849 --- loss: 0.818144, loss_ss: 0.742482, loss_d: 0.075662
0.4234 --- loss: 0.928744, loss_ss: 0.916974, loss_d: 0.011770
0.4619 --- loss: 0.669832, loss_ss: 0.666963, loss_d: 0.002869
0.5004 --- loss: 0.909813, loss_ss: 0.904508, loss_d: 0.005305
0.5389 --- loss: 0.772866, loss_ss: 0.714255, loss_d: 0.058611
0.5774 --- loss: 0.997961, loss_ss: 0.775064, loss_d: 0.222898
0.6159 --- loss: 1.090134, loss_ss: 1.055475, loss_d: 0.034660
0.6543 --- loss: 0.975063, loss_ss: 0.813425, loss_d: 0.161638
0.6928 --- loss: 0.700787, loss_ss: 0.682223, loss_d: 0.018563
0.7313 --- loss: 1.040551, loss_ss: 0.980359, loss_d: 0.060192
0.7698 --- loss: 1.024230, loss_ss: 0.900407, loss_d: 0.123822
0.8083 --- loss: 1.003632, loss_ss: 0.991728, loss_d: 0.011904
0.8468 --- loss: 0.832294, loss_ss: 0.798297, loss_d: 0.033997
0.8853 --- loss: 1.433620, loss_ss: 1.184027, loss_d: 0.249594
0.9238 --- loss: 1.037353, loss_ss: 0.977366, loss_d: 0.059987
0.9623 --- loss: 1.196053, loss_ss: 1.171763, loss_d: 0.024290
Epoch finished! Loss: 0.9487849057411135
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5429524603836531
             precision    recall  f1-score   support

        0.0       0.76      0.63      0.69       151
        1.0       0.23      0.59      0.33       135
        2.0       0.58      0.77      0.66       442
        3.0       0.98      0.20      0.34       221
        4.0       0.84      0.37      0.51       250

avg / total       0.69      0.54      0.54      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.83  62.91   97.14  76.00     68.84
1  73.81  58.52   75.75  23.44     33.47
2  71.31  76.92   68.03  58.42     66.41
3  85.24  20.36   99.90  97.83     33.71
4  85.40  36.80   98.21  84.40     51.25
Total accuracy: 54.30%
Average sen: 51.10%
Average spec: 87.81%
Macro f1-score: 50.74%
Diagnosis acc on 15mins: 1.0
[0.99069959 0.98248255 0.99922836 0.99953496 0.99997294 0.99998057
 0.99996138 0.99946541 0.99997163 0.99991906 0.99999785 0.99999774
 0.99990392 0.99958342 0.99999714 0.99999177 0.99985647 0.99959403
 0.99994814 0.99972373 0.9999367  0.99996865 0.99978679 0.99978286
 0.99999869 0.99996841 0.99991751 0.99988341 0.99782962 0.99866235
 0.99860734 0.99985147 0.99888831 0.99834192 0.99641114 0.9969067
 0.95723224 0.99839932 0.99971527 0.99998486]
pred: 0.9977471053600311, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.199387, loss_ss: 1.534351, loss_d: 0.665036
0.0384 --- loss: 2.093608, loss_ss: 1.380641, loss_d: 0.712967
0.0769 --- loss: 1.987497, loss_ss: 1.517289, loss_d: 0.470207
0.1153 --- loss: 2.124164, loss_ss: 1.474410, loss_d: 0.649754
0.1537 --- loss: 2.190896, loss_ss: 1.478055, loss_d: 0.712840
0.1922 --- loss: 1.932268, loss_ss: 1.512594, loss_d: 0.419674
0.2306 --- loss: 2.016105, loss_ss: 1.635004, loss_d: 0.381101
0.2690 --- loss: 2.132308, loss_ss: 1.263203, loss_d: 0.869105
0.3075 --- loss: 1.802540, loss_ss: 1.271745, loss_d: 0.530794
0.3459 --- loss: 1.866187, loss_ss: 1.370250, loss_d: 0.495937
0.3843 --- loss: 1.723972, loss_ss: 1.205593, loss_d: 0.518380
0.4228 --- loss: 1.724466, loss_ss: 1.212023, loss_d: 0.512443
0.4612 --- loss: 1.868431, loss_ss: 1.106578, loss_d: 0.761853
0.4996 --- loss: 1.743810, loss_ss: 1.276152, loss_d: 0.467658
0.5380 --- loss: 1.926747, loss_ss: 1.322666, loss_d: 0.604081
0.5765 --- loss: 1.770340, loss_ss: 1.234839, loss_d: 0.535501
0.6149 --- loss: 1.888038, loss_ss: 1.328673, loss_d: 0.559365
0.6533 --- loss: 2.040918, loss_ss: 1.430731, loss_d: 0.610186
0.6918 --- loss: 1.734064, loss_ss: 1.277380, loss_d: 0.456684
0.7302 --- loss: 2.250681, loss_ss: 1.385530, loss_d: 0.865151
0.7686 --- loss: 1.644051, loss_ss: 1.272717, loss_d: 0.371334
0.8071 --- loss: 1.686181, loss_ss: 1.383971, loss_d: 0.302210
0.8455 --- loss: 1.911027, loss_ss: 1.319398, loss_d: 0.591628
0.8839 --- loss: 2.085935, loss_ss: 1.291416, loss_d: 0.794518
0.9224 --- loss: 2.010861, loss_ss: 1.184988, loss_d: 0.825874
0.9608 --- loss: 1.599685, loss_ss: 1.280807, loss_d: 0.318877
0.9992 --- loss: 1.597045, loss_ss: 1.530494, loss_d: 0.066551
Epoch finished! Loss: 1.901628055022313
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.761233, loss_ss: 1.161851, loss_d: 0.599382
0.0384 --- loss: 1.389067, loss_ss: 1.067525, loss_d: 0.321541
0.0769 --- loss: 1.535097, loss_ss: 1.155344, loss_d: 0.379753
0.1153 --- loss: 1.922859, loss_ss: 1.326885, loss_d: 0.595974
0.1537 --- loss: 1.349744, loss_ss: 1.139199, loss_d: 0.210545
0.1922 --- loss: 1.691773, loss_ss: 1.123051, loss_d: 0.568722
0.2306 --- loss: 2.175761, loss_ss: 1.172391, loss_d: 1.003370
0.2690 --- loss: 1.719377, loss_ss: 1.134377, loss_d: 0.585000
0.3075 --- loss: 1.402370, loss_ss: 1.198243, loss_d: 0.204128
0.3459 --- loss: 1.549742, loss_ss: 1.268320, loss_d: 0.281422
0.3843 --- loss: 1.404603, loss_ss: 1.001926, loss_d: 0.402678
0.4228 --- loss: 1.382000, loss_ss: 1.115219, loss_d: 0.266782
0.4612 --- loss: 1.816775, loss_ss: 1.112504, loss_d: 0.704271
0.4996 --- loss: 1.585005, loss_ss: 0.956963, loss_d: 0.628041
0.5380 --- loss: 1.563300, loss_ss: 1.168390, loss_d: 0.394911
0.5765 --- loss: 1.448618, loss_ss: 1.316516, loss_d: 0.132101
0.6149 --- loss: 1.280398, loss_ss: 0.934126, loss_d: 0.346272
0.6533 --- loss: 1.151594, loss_ss: 0.920901, loss_d: 0.230692
0.6918 --- loss: 1.482727, loss_ss: 1.112888, loss_d: 0.369839
0.7302 --- loss: 1.567507, loss_ss: 1.094394, loss_d: 0.473113
0.7686 --- loss: 1.379803, loss_ss: 1.038642, loss_d: 0.341161
0.8071 --- loss: 1.179065, loss_ss: 1.054823, loss_d: 0.124242
0.8455 --- loss: 1.124367, loss_ss: 0.968663, loss_d: 0.155704
0.8839 --- loss: 1.068563, loss_ss: 0.918316, loss_d: 0.150247
0.9224 --- loss: 1.255634, loss_ss: 1.019726, loss_d: 0.235908
0.9608 --- loss: 1.326217, loss_ss: 1.183954, loss_d: 0.142263
0.9992 --- loss: 2.988839, loss_ss: 1.780515, loss_d: 1.208324
Epoch finished! Loss: 1.4849995411359347
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.356614, loss_ss: 0.871120, loss_d: 0.485494
0.0384 --- loss: 1.523628, loss_ss: 1.262940, loss_d: 0.260688
0.0769 --- loss: 1.271781, loss_ss: 1.010960, loss_d: 0.260820
0.1153 --- loss: 1.364761, loss_ss: 1.096157, loss_d: 0.268604
0.1537 --- loss: 1.504013, loss_ss: 1.210495, loss_d: 0.293517
0.1922 --- loss: 1.637802, loss_ss: 1.002085, loss_d: 0.635717
0.2306 --- loss: 1.488435, loss_ss: 0.961183, loss_d: 0.527252
0.2690 --- loss: 1.535211, loss_ss: 1.322146, loss_d: 0.213066
0.3075 --- loss: 1.568958, loss_ss: 1.356437, loss_d: 0.212521
0.3459 --- loss: 1.424465, loss_ss: 1.034924, loss_d: 0.389541
0.3843 --- loss: 1.153776, loss_ss: 1.039361, loss_d: 0.114415
0.4228 --- loss: 1.323109, loss_ss: 0.804245, loss_d: 0.518864
0.4612 --- loss: 1.652428, loss_ss: 1.110800, loss_d: 0.541628
0.4996 --- loss: 1.373507, loss_ss: 0.892844, loss_d: 0.480663
0.5380 --- loss: 1.332754, loss_ss: 1.130454, loss_d: 0.202301
0.5765 --- loss: 1.272673, loss_ss: 0.982001, loss_d: 0.290672
0.6149 --- loss: 1.009109, loss_ss: 0.856445, loss_d: 0.152664
0.6533 --- loss: 1.334878, loss_ss: 1.055558, loss_d: 0.279320
0.6918 --- loss: 1.153677, loss_ss: 0.796184, loss_d: 0.357492
0.7302 --- loss: 1.218380, loss_ss: 1.001777, loss_d: 0.216603
0.7686 --- loss: 1.159666, loss_ss: 0.898780, loss_d: 0.260886
0.8071 --- loss: 1.189691, loss_ss: 0.901912, loss_d: 0.287780
0.8455 --- loss: 1.581394, loss_ss: 1.492634, loss_d: 0.088760
0.8839 --- loss: 1.328990, loss_ss: 1.041145, loss_d: 0.287845
0.9224 --- loss: 1.210700, loss_ss: 0.978658, loss_d: 0.232041
0.9608 --- loss: 1.315374, loss_ss: 0.983116, loss_d: 0.332258
0.9992 --- loss: 1.598388, loss_ss: 1.567347, loss_d: 0.031041
Epoch finished! Loss: 1.30006391451909
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.747074, loss_ss: 1.088576, loss_d: 0.658498
0.0384 --- loss: 1.135348, loss_ss: 0.786185, loss_d: 0.349163
0.0769 --- loss: 1.361374, loss_ss: 0.864896, loss_d: 0.496478
0.1153 --- loss: 1.212846, loss_ss: 0.905633, loss_d: 0.307213
0.1537 --- loss: 0.915173, loss_ss: 0.829157, loss_d: 0.086016
0.1922 --- loss: 1.213986, loss_ss: 0.855193, loss_d: 0.358793
0.2306 --- loss: 1.314031, loss_ss: 1.027404, loss_d: 0.286627
0.2690 --- loss: 1.061242, loss_ss: 0.839940, loss_d: 0.221302
0.3075 --- loss: 0.929942, loss_ss: 0.716615, loss_d: 0.213326
0.3459 --- loss: 1.130385, loss_ss: 0.964670, loss_d: 0.165714
0.3843 --- loss: 1.386042, loss_ss: 0.792102, loss_d: 0.593940
0.4228 --- loss: 1.541181, loss_ss: 1.012186, loss_d: 0.528995
0.4612 --- loss: 1.165567, loss_ss: 1.062501, loss_d: 0.103067
0.4996 --- loss: 1.031334, loss_ss: 0.751290, loss_d: 0.280045
0.5380 --- loss: 1.245735, loss_ss: 1.060170, loss_d: 0.185565
0.5765 --- loss: 1.489193, loss_ss: 0.722625, loss_d: 0.766568
0.6149 --- loss: 1.217581, loss_ss: 1.107089, loss_d: 0.110492
0.6533 --- loss: 1.314053, loss_ss: 1.004040, loss_d: 0.310013
0.6918 --- loss: 0.991372, loss_ss: 0.768305, loss_d: 0.223068
0.7302 --- loss: 1.036016, loss_ss: 0.869246, loss_d: 0.166770
0.7686 --- loss: 1.046530, loss_ss: 0.966377, loss_d: 0.080153
0.8071 --- loss: 1.126717, loss_ss: 0.832510, loss_d: 0.294207
0.8455 --- loss: 0.949218, loss_ss: 0.895957, loss_d: 0.053261
0.8839 --- loss: 1.522779, loss_ss: 0.894176, loss_d: 0.628604
0.9224 --- loss: 1.660371, loss_ss: 0.915373, loss_d: 0.744998
0.9608 --- loss: 1.349194, loss_ss: 1.032985, loss_d: 0.316209
0.9992 --- loss: 1.500484, loss_ss: 1.470006, loss_d: 0.030478
Epoch finished! Loss: 1.19270757322128
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.168554, loss_ss: 0.840307, loss_d: 0.328248
0.0384 --- loss: 1.138301, loss_ss: 0.969863, loss_d: 0.168438
0.0769 --- loss: 0.936729, loss_ss: 0.866223, loss_d: 0.070505
0.1153 --- loss: 1.050810, loss_ss: 0.985417, loss_d: 0.065392
0.1537 --- loss: 0.924126, loss_ss: 0.825164, loss_d: 0.098962
0.1922 --- loss: 1.179002, loss_ss: 0.927289, loss_d: 0.251713
0.2306 --- loss: 1.135304, loss_ss: 0.983118, loss_d: 0.152185
0.2690 --- loss: 0.760109, loss_ss: 0.719453, loss_d: 0.040656
0.3075 --- loss: 0.620446, loss_ss: 0.598331, loss_d: 0.022115
0.3459 --- loss: 1.048685, loss_ss: 0.872814, loss_d: 0.175871
0.3843 --- loss: 1.476256, loss_ss: 0.825735, loss_d: 0.650521
0.4228 --- loss: 0.975425, loss_ss: 0.927378, loss_d: 0.048047
0.4612 --- loss: 1.400369, loss_ss: 0.859397, loss_d: 0.540972
0.4996 --- loss: 0.777751, loss_ss: 0.629458, loss_d: 0.148293
0.5380 --- loss: 1.065446, loss_ss: 0.953541, loss_d: 0.111904
0.5765 --- loss: 0.677908, loss_ss: 0.667179, loss_d: 0.010729
0.6149 --- loss: 0.925736, loss_ss: 0.873884, loss_d: 0.051851
0.6533 --- loss: 1.460737, loss_ss: 1.010292, loss_d: 0.450445
0.6918 --- loss: 1.687182, loss_ss: 1.106573, loss_d: 0.580609
0.7302 --- loss: 1.002215, loss_ss: 0.841016, loss_d: 0.161199
0.7686 --- loss: 0.902595, loss_ss: 0.858844, loss_d: 0.043751
0.8071 --- loss: 1.175332, loss_ss: 1.112684, loss_d: 0.062648
0.8455 --- loss: 1.073114, loss_ss: 1.005276, loss_d: 0.067838
0.8839 --- loss: 0.902050, loss_ss: 0.762661, loss_d: 0.139389
0.9224 --- loss: 0.924304, loss_ss: 0.755025, loss_d: 0.169279
0.9608 --- loss: 1.117956, loss_ss: 0.784210, loss_d: 0.333746
0.9992 --- loss: 4.518803, loss_ss: 2.206491, loss_d: 2.312312
Epoch finished! Loss: 1.132112791446539
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.974242, loss_ss: 0.769971, loss_d: 0.204271
0.0384 --- loss: 0.838879, loss_ss: 0.739000, loss_d: 0.099879
0.0769 --- loss: 1.128273, loss_ss: 0.844981, loss_d: 0.283292
0.1153 --- loss: 0.896596, loss_ss: 0.752762, loss_d: 0.143835
0.1537 --- loss: 1.138320, loss_ss: 0.961707, loss_d: 0.176613
0.1922 --- loss: 1.116122, loss_ss: 0.964909, loss_d: 0.151212
0.2306 --- loss: 1.558039, loss_ss: 1.143239, loss_d: 0.414800
0.2690 --- loss: 0.773510, loss_ss: 0.708790, loss_d: 0.064721
0.3075 --- loss: 0.934759, loss_ss: 0.915013, loss_d: 0.019746
0.3459 --- loss: 0.892042, loss_ss: 0.863606, loss_d: 0.028436
0.3843 --- loss: 0.956553, loss_ss: 0.938662, loss_d: 0.017891
0.4228 --- loss: 1.115561, loss_ss: 0.945517, loss_d: 0.170044
0.4612 --- loss: 0.818590, loss_ss: 0.792517, loss_d: 0.026073
0.4996 --- loss: 1.297799, loss_ss: 1.088543, loss_d: 0.209256
0.5380 --- loss: 0.750093, loss_ss: 0.548458, loss_d: 0.201635
0.5765 --- loss: 0.988716, loss_ss: 0.783188, loss_d: 0.205528
0.6149 --- loss: 1.076838, loss_ss: 0.812791, loss_d: 0.264047
0.6533 --- loss: 0.996144, loss_ss: 0.969370, loss_d: 0.026773
0.6918 --- loss: 1.036430, loss_ss: 0.918370, loss_d: 0.118060
0.7302 --- loss: 1.072931, loss_ss: 0.991311, loss_d: 0.081619
0.7686 --- loss: 1.020895, loss_ss: 0.865780, loss_d: 0.155114
0.8071 --- loss: 1.403031, loss_ss: 0.696254, loss_d: 0.706776
0.8455 --- loss: 1.046784, loss_ss: 0.974883, loss_d: 0.071901
0.8839 --- loss: 0.997426, loss_ss: 0.888506, loss_d: 0.108921
0.9224 --- loss: 1.233208, loss_ss: 0.962443, loss_d: 0.270765
0.9608 --- loss: 1.113062, loss_ss: 0.868063, loss_d: 0.244999
0.9992 --- loss: 2.889767, loss_ss: 1.537427, loss_d: 1.352340
Epoch finished! Loss: 1.0576270245588744
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.969943, loss_ss: 0.916686, loss_d: 0.053257
0.0384 --- loss: 0.757434, loss_ss: 0.691206, loss_d: 0.066228
0.0769 --- loss: 0.907821, loss_ss: 0.863753, loss_d: 0.044068
0.1153 --- loss: 0.794289, loss_ss: 0.669715, loss_d: 0.124574
0.1537 --- loss: 0.715155, loss_ss: 0.687783, loss_d: 0.027373
0.1922 --- loss: 0.761157, loss_ss: 0.715761, loss_d: 0.045395
0.2306 --- loss: 0.726243, loss_ss: 0.657944, loss_d: 0.068299
0.2690 --- loss: 0.921831, loss_ss: 0.853299, loss_d: 0.068532
0.3075 --- loss: 0.967626, loss_ss: 0.825549, loss_d: 0.142077
0.3459 --- loss: 1.228827, loss_ss: 1.092068, loss_d: 0.136759
0.3843 --- loss: 1.261874, loss_ss: 0.877534, loss_d: 0.384340
0.4228 --- loss: 0.873302, loss_ss: 0.822802, loss_d: 0.050499
0.4612 --- loss: 0.666220, loss_ss: 0.614247, loss_d: 0.051973
0.4996 --- loss: 0.938276, loss_ss: 0.895992, loss_d: 0.042284
0.5380 --- loss: 1.541080, loss_ss: 0.737721, loss_d: 0.803359
0.5765 --- loss: 0.860462, loss_ss: 0.721829, loss_d: 0.138633
0.6149 --- loss: 1.041813, loss_ss: 0.842168, loss_d: 0.199644
0.6533 --- loss: 1.072387, loss_ss: 0.864311, loss_d: 0.208076
0.6918 --- loss: 0.905268, loss_ss: 0.878557, loss_d: 0.026711
0.7302 --- loss: 1.011629, loss_ss: 0.913030, loss_d: 0.098599
0.7686 --- loss: 0.967744, loss_ss: 0.806292, loss_d: 0.161451
0.8071 --- loss: 0.685037, loss_ss: 0.652354, loss_d: 0.032683
0.8455 --- loss: 0.837597, loss_ss: 0.807431, loss_d: 0.030166
0.8839 --- loss: 1.211056, loss_ss: 0.761953, loss_d: 0.449102
0.9224 --- loss: 0.855467, loss_ss: 0.849350, loss_d: 0.006116
0.9608 --- loss: 1.346682, loss_ss: 0.808088, loss_d: 0.538594
0.9992 --- loss: 1.593340, loss_ss: 1.533209, loss_d: 0.060132
Epoch finished! Loss: 1.0064532887477142
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.055716, loss_ss: 1.011066, loss_d: 0.044650
0.0384 --- loss: 0.735083, loss_ss: 0.680014, loss_d: 0.055069
0.0769 --- loss: 0.855077, loss_ss: 0.831846, loss_d: 0.023231
0.1153 --- loss: 1.123891, loss_ss: 1.100105, loss_d: 0.023786
0.1537 --- loss: 0.806382, loss_ss: 0.519562, loss_d: 0.286821
0.1922 --- loss: 0.981199, loss_ss: 0.876131, loss_d: 0.105068
0.2306 --- loss: 1.071970, loss_ss: 0.933442, loss_d: 0.138527
0.2690 --- loss: 0.909962, loss_ss: 0.884275, loss_d: 0.025687
0.3075 --- loss: 0.874923, loss_ss: 0.857672, loss_d: 0.017251
0.3459 --- loss: 1.163586, loss_ss: 1.032072, loss_d: 0.131514
0.3843 --- loss: 1.104829, loss_ss: 0.836115, loss_d: 0.268714
0.4228 --- loss: 1.377816, loss_ss: 1.164533, loss_d: 0.213283
0.4612 --- loss: 0.920304, loss_ss: 0.885195, loss_d: 0.035109
0.4996 --- loss: 0.903565, loss_ss: 0.816963, loss_d: 0.086602
0.5380 --- loss: 0.925305, loss_ss: 0.910576, loss_d: 0.014729
0.5765 --- loss: 0.999583, loss_ss: 0.747392, loss_d: 0.252191
0.6149 --- loss: 0.697005, loss_ss: 0.577612, loss_d: 0.119394
0.6533 --- loss: 0.858629, loss_ss: 0.849084, loss_d: 0.009546
0.6918 --- loss: 1.323698, loss_ss: 0.991972, loss_d: 0.331726
0.7302 --- loss: 1.301935, loss_ss: 1.148666, loss_d: 0.153269
0.7686 --- loss: 0.803933, loss_ss: 0.650616, loss_d: 0.153317
0.8071 --- loss: 0.933170, loss_ss: 0.703042, loss_d: 0.230128
0.8455 --- loss: 1.238677, loss_ss: 0.850539, loss_d: 0.388138
0.8839 --- loss: 0.796604, loss_ss: 0.697940, loss_d: 0.098664
0.9224 --- loss: 1.007419, loss_ss: 0.989434, loss_d: 0.017985
0.9608 --- loss: 1.197001, loss_ss: 1.091046, loss_d: 0.105955
0.9992 --- loss: 1.604792, loss_ss: 1.595388, loss_d: 0.009404
Epoch finished! Loss: 0.9872170326801447
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.793797, loss_ss: 0.703995, loss_d: 0.089801
0.0384 --- loss: 0.855358, loss_ss: 0.731660, loss_d: 0.123697
0.0769 --- loss: 0.908110, loss_ss: 0.763232, loss_d: 0.144878
0.1153 --- loss: 0.802985, loss_ss: 0.726941, loss_d: 0.076044
0.1537 --- loss: 0.888659, loss_ss: 0.750920, loss_d: 0.137738
0.1922 --- loss: 0.940571, loss_ss: 0.935138, loss_d: 0.005433
0.2306 --- loss: 1.380952, loss_ss: 1.119959, loss_d: 0.260993
0.2690 --- loss: 0.637271, loss_ss: 0.623303, loss_d: 0.013969
0.3075 --- loss: 0.727636, loss_ss: 0.707904, loss_d: 0.019732
0.3459 --- loss: 0.729629, loss_ss: 0.715024, loss_d: 0.014605
0.3843 --- loss: 0.781508, loss_ss: 0.720336, loss_d: 0.061173
0.4228 --- loss: 0.956291, loss_ss: 0.922939, loss_d: 0.033352
0.4612 --- loss: 0.700468, loss_ss: 0.693436, loss_d: 0.007033
0.4996 --- loss: 0.901501, loss_ss: 0.863085, loss_d: 0.038416
0.5380 --- loss: 0.987553, loss_ss: 0.972647, loss_d: 0.014906
0.5765 --- loss: 0.847686, loss_ss: 0.725638, loss_d: 0.122048
0.6149 --- loss: 1.004785, loss_ss: 0.818206, loss_d: 0.186579
0.6533 --- loss: 0.858876, loss_ss: 0.742030, loss_d: 0.116846
0.6918 --- loss: 1.076371, loss_ss: 0.995063, loss_d: 0.081308
0.7302 --- loss: 1.085165, loss_ss: 1.007641, loss_d: 0.077524
0.7686 --- loss: 1.056288, loss_ss: 1.033144, loss_d: 0.023143
0.8071 --- loss: 0.985997, loss_ss: 0.943679, loss_d: 0.042317
0.8455 --- loss: 0.911513, loss_ss: 0.873131, loss_d: 0.038382
0.8839 --- loss: 1.297620, loss_ss: 1.273630, loss_d: 0.023989
0.9224 --- loss: 1.743383, loss_ss: 1.258541, loss_d: 0.484841
0.9608 --- loss: 0.873548, loss_ss: 0.683423, loss_d: 0.190125
0.9992 --- loss: 2.834441, loss_ss: 2.831696, loss_d: 0.002746
Epoch finished! Loss: 0.9435262349935678
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.161807, loss_ss: 0.994821, loss_d: 0.166985
0.0384 --- loss: 0.993993, loss_ss: 0.701953, loss_d: 0.292040
0.0769 --- loss: 0.794286, loss_ss: 0.704841, loss_d: 0.089445
0.1153 --- loss: 0.891630, loss_ss: 0.860645, loss_d: 0.030986
0.1537 --- loss: 0.974014, loss_ss: 0.969944, loss_d: 0.004070
0.1922 --- loss: 0.857136, loss_ss: 0.844983, loss_d: 0.012152
0.2306 --- loss: 0.847497, loss_ss: 0.819710, loss_d: 0.027787
0.2690 --- loss: 1.109090, loss_ss: 0.980616, loss_d: 0.128474
0.3075 --- loss: 0.662076, loss_ss: 0.654613, loss_d: 0.007463
0.3459 --- loss: 0.965182, loss_ss: 0.939662, loss_d: 0.025520
0.3843 --- loss: 1.073678, loss_ss: 1.047756, loss_d: 0.025921
0.4228 --- loss: 1.244799, loss_ss: 1.080522, loss_d: 0.164277
0.4612 --- loss: 0.783577, loss_ss: 0.771984, loss_d: 0.011593
0.4996 --- loss: 0.716711, loss_ss: 0.691385, loss_d: 0.025326
0.5380 --- loss: 1.054398, loss_ss: 0.814941, loss_d: 0.239457
0.5765 --- loss: 0.900333, loss_ss: 0.896573, loss_d: 0.003760
0.6149 --- loss: 0.714182, loss_ss: 0.708856, loss_d: 0.005326
0.6533 --- loss: 0.617612, loss_ss: 0.600007, loss_d: 0.017605
0.6918 --- loss: 0.901013, loss_ss: 0.606367, loss_d: 0.294647
0.7302 --- loss: 1.735908, loss_ss: 1.618386, loss_d: 0.117522
0.7686 --- loss: 0.722115, loss_ss: 0.682902, loss_d: 0.039213
0.8071 --- loss: 0.990975, loss_ss: 0.822553, loss_d: 0.168422
0.8455 --- loss: 0.739356, loss_ss: 0.713827, loss_d: 0.025529
0.8839 --- loss: 1.166487, loss_ss: 0.852645, loss_d: 0.313842
0.9224 --- loss: 1.183838, loss_ss: 0.661448, loss_d: 0.522390
0.9608 --- loss: 0.951567, loss_ss: 0.771484, loss_d: 0.180083
0.9992 --- loss: 2.011546, loss_ss: 1.392826, loss_d: 0.618720
Epoch finished! Loss: 0.9284393826356301
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6435185185185185
             precision    recall  f1-score   support

        0.0       0.79      0.95      0.86       226
        1.0       0.69      0.35      0.46       357
        2.0       0.57      0.54      0.55       192
        3.0       0.04      1.00      0.07         2
        4.0       0.64      0.83      0.72       303

avg / total       0.67      0.64      0.63      1080
 


====== chp046-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  93.61   94.69   93.33  78.97     86.12
1  73.33   35.01   92.25  69.06     46.47
2  84.44   54.17   90.99  56.52     55.32
3  95.28  100.00   95.27   3.77      7.27
4  82.04   82.51   81.85  63.94     72.05
Total accuracy: 64.35%
Average sen: 73.28%
Average spec: 90.74%
Macro f1-score: 53.44%
Diagnosis acc on 15mins: 1.0
[0.99997592 0.99931169 0.99999917 0.99999917 0.99999642 1.
 0.99999964 0.99998808 0.99998546 0.99999774 0.99997962 0.99999952
 0.99999988 0.99977332 0.9996736  0.99999559 0.99999928 0.99999988
 0.99986589 0.99999833 0.99973577 0.99993026 0.99999559 0.99999881
 1.         1.         1.         0.99987662 0.99999344 0.99999988
 0.9990707  0.99984181 0.99974972 0.99999976 0.99999964 0.99878591]
pred: 0.999875447816319, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.410858, loss_ss: 1.740393, loss_d: 0.670465
0.0383 --- loss: 2.141449, loss_ss: 1.423283, loss_d: 0.718166
0.0767 --- loss: 2.715946, loss_ss: 1.497267, loss_d: 1.218679
0.1150 --- loss: 2.339415, loss_ss: 1.567237, loss_d: 0.772178
0.1533 --- loss: 1.857002, loss_ss: 1.421754, loss_d: 0.435248
0.1916 --- loss: 1.961031, loss_ss: 1.501306, loss_d: 0.459725
0.2300 --- loss: 1.931784, loss_ss: 1.270829, loss_d: 0.660956
0.2683 --- loss: 2.142578, loss_ss: 1.583878, loss_d: 0.558701
0.3066 --- loss: 2.308452, loss_ss: 1.649840, loss_d: 0.658611
0.3450 --- loss: 2.026500, loss_ss: 1.474908, loss_d: 0.551591
0.3833 --- loss: 1.606827, loss_ss: 1.233216, loss_d: 0.373612
0.4216 --- loss: 1.854454, loss_ss: 1.347722, loss_d: 0.506732
0.4599 --- loss: 2.116416, loss_ss: 1.535288, loss_d: 0.581128
0.4983 --- loss: 1.779017, loss_ss: 1.281872, loss_d: 0.497145
0.5366 --- loss: 1.829095, loss_ss: 1.240629, loss_d: 0.588466
0.5749 --- loss: 1.694709, loss_ss: 1.369880, loss_d: 0.324829
0.6133 --- loss: 1.697158, loss_ss: 1.290998, loss_d: 0.406159
0.6516 --- loss: 1.931518, loss_ss: 1.273212, loss_d: 0.658306
0.6899 --- loss: 1.897613, loss_ss: 1.283215, loss_d: 0.614398
0.7282 --- loss: 2.017924, loss_ss: 1.280959, loss_d: 0.736965
0.7666 --- loss: 2.125769, loss_ss: 1.732237, loss_d: 0.393532
0.8049 --- loss: 1.736476, loss_ss: 1.394045, loss_d: 0.342431
0.8432 --- loss: 1.784206, loss_ss: 1.447662, loss_d: 0.336544
0.8816 --- loss: 1.810138, loss_ss: 1.313076, loss_d: 0.497061
0.9199 --- loss: 1.662460, loss_ss: 0.939262, loss_d: 0.723198
0.9582 --- loss: 1.705678, loss_ss: 1.076106, loss_d: 0.629573
0.9966 --- loss: 1.410938, loss_ss: 1.147277, loss_d: 0.263661
Epoch finished! Loss: 1.9379641867600954
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.588579, loss_ss: 1.188612, loss_d: 0.399967
0.0383 --- loss: 1.541694, loss_ss: 1.242280, loss_d: 0.299414
0.0767 --- loss: 1.466704, loss_ss: 1.257257, loss_d: 0.209448
0.1150 --- loss: 1.826774, loss_ss: 1.390505, loss_d: 0.436269
0.1533 --- loss: 1.864733, loss_ss: 1.451851, loss_d: 0.412881
0.1916 --- loss: 1.610546, loss_ss: 1.284484, loss_d: 0.326062
0.2300 --- loss: 2.161104, loss_ss: 1.479834, loss_d: 0.681270
0.2683 --- loss: 1.974355, loss_ss: 1.149549, loss_d: 0.824806
0.3066 --- loss: 1.307663, loss_ss: 1.047199, loss_d: 0.260464
0.3450 --- loss: 1.389290, loss_ss: 1.073676, loss_d: 0.315614
0.3833 --- loss: 1.288446, loss_ss: 1.168089, loss_d: 0.120358
0.4216 --- loss: 1.471277, loss_ss: 1.140300, loss_d: 0.330976
0.4599 --- loss: 1.643133, loss_ss: 1.250984, loss_d: 0.392149
0.4983 --- loss: 1.857239, loss_ss: 1.147156, loss_d: 0.710082
0.5366 --- loss: 1.268995, loss_ss: 1.101475, loss_d: 0.167520
0.5749 --- loss: 1.356578, loss_ss: 1.205918, loss_d: 0.150659
0.6133 --- loss: 1.448999, loss_ss: 1.305886, loss_d: 0.143113
0.6516 --- loss: 1.741253, loss_ss: 1.220448, loss_d: 0.520805
0.6899 --- loss: 1.766804, loss_ss: 1.209475, loss_d: 0.557329
0.7282 --- loss: 1.152834, loss_ss: 0.949721, loss_d: 0.203112
0.7666 --- loss: 1.718347, loss_ss: 1.053586, loss_d: 0.664761
0.8049 --- loss: 1.376214, loss_ss: 1.184077, loss_d: 0.192137
0.8432 --- loss: 1.542890, loss_ss: 1.223051, loss_d: 0.319839
0.8816 --- loss: 1.145349, loss_ss: 0.928363, loss_d: 0.216986
0.9199 --- loss: 1.295897, loss_ss: 1.083551, loss_d: 0.212346
0.9582 --- loss: 1.179788, loss_ss: 0.927763, loss_d: 0.252025
0.9966 --- loss: 1.393743, loss_ss: 1.289509, loss_d: 0.104234
Epoch finished! Loss: 1.5582333500568684
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.523670, loss_ss: 1.234617, loss_d: 0.289053
0.0383 --- loss: 1.172824, loss_ss: 1.106319, loss_d: 0.066505
0.0767 --- loss: 1.367642, loss_ss: 1.178423, loss_d: 0.189219
0.1150 --- loss: 2.095861, loss_ss: 0.946680, loss_d: 1.149182
0.1533 --- loss: 1.627986, loss_ss: 1.051551, loss_d: 0.576435
0.1916 --- loss: 1.285771, loss_ss: 1.133646, loss_d: 0.152124
0.2300 --- loss: 1.525846, loss_ss: 1.043193, loss_d: 0.482654
0.2683 --- loss: 1.458848, loss_ss: 1.268565, loss_d: 0.190283
0.3066 --- loss: 1.495402, loss_ss: 1.239737, loss_d: 0.255665
0.3450 --- loss: 1.484702, loss_ss: 1.351819, loss_d: 0.132884
0.3833 --- loss: 1.152923, loss_ss: 1.052561, loss_d: 0.100361
0.4216 --- loss: 1.343011, loss_ss: 0.899521, loss_d: 0.443490
0.4599 --- loss: 1.883398, loss_ss: 1.487978, loss_d: 0.395420
0.4983 --- loss: 1.344359, loss_ss: 1.077071, loss_d: 0.267288
0.5366 --- loss: 1.595381, loss_ss: 1.004915, loss_d: 0.590467
0.5749 --- loss: 1.234406, loss_ss: 1.075929, loss_d: 0.158478
0.6133 --- loss: 1.379887, loss_ss: 1.088966, loss_d: 0.290921
0.6516 --- loss: 1.561617, loss_ss: 1.248006, loss_d: 0.313610
0.6899 --- loss: 1.268949, loss_ss: 1.195818, loss_d: 0.073131
0.7282 --- loss: 1.448630, loss_ss: 1.201651, loss_d: 0.246979
0.7666 --- loss: 1.464881, loss_ss: 1.078014, loss_d: 0.386867
0.8049 --- loss: 1.303107, loss_ss: 1.060796, loss_d: 0.242311
0.8432 --- loss: 1.466897, loss_ss: 1.255654, loss_d: 0.211244
0.8816 --- loss: 0.917723, loss_ss: 0.760049, loss_d: 0.157674
0.9199 --- loss: 1.002287, loss_ss: 0.878724, loss_d: 0.123563
0.9582 --- loss: 1.607708, loss_ss: 1.392458, loss_d: 0.215250
0.9966 --- loss: 1.478218, loss_ss: 0.974162, loss_d: 0.504056
Epoch finished! Loss: 1.3663925047104175
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.667787, loss_ss: 1.294361, loss_d: 0.373427
0.0383 --- loss: 1.296882, loss_ss: 0.887584, loss_d: 0.409299
0.0767 --- loss: 1.115170, loss_ss: 0.934815, loss_d: 0.180354
0.1150 --- loss: 1.164954, loss_ss: 0.939257, loss_d: 0.225697
0.1533 --- loss: 1.024085, loss_ss: 0.909144, loss_d: 0.114941
0.1916 --- loss: 1.251242, loss_ss: 1.086981, loss_d: 0.164261
0.2300 --- loss: 0.967231, loss_ss: 0.888361, loss_d: 0.078870
0.2683 --- loss: 1.298451, loss_ss: 0.935768, loss_d: 0.362683
0.3066 --- loss: 1.095364, loss_ss: 0.870086, loss_d: 0.225278
0.3450 --- loss: 1.385827, loss_ss: 0.885317, loss_d: 0.500510
0.3833 --- loss: 1.160687, loss_ss: 1.006470, loss_d: 0.154217
0.4216 --- loss: 1.151842, loss_ss: 0.657316, loss_d: 0.494527
0.4599 --- loss: 1.179215, loss_ss: 0.842438, loss_d: 0.336778
0.4983 --- loss: 1.177636, loss_ss: 0.847979, loss_d: 0.329657
0.5366 --- loss: 1.021140, loss_ss: 0.793238, loss_d: 0.227902
0.5749 --- loss: 1.205549, loss_ss: 0.926740, loss_d: 0.278809
0.6133 --- loss: 1.245083, loss_ss: 1.029466, loss_d: 0.215618
0.6516 --- loss: 1.108274, loss_ss: 1.011503, loss_d: 0.096771
0.6899 --- loss: 1.658638, loss_ss: 1.004261, loss_d: 0.654376
0.7282 --- loss: 2.502245, loss_ss: 0.925187, loss_d: 1.577058
0.7666 --- loss: 2.150216, loss_ss: 1.243180, loss_d: 0.907036
0.8049 --- loss: 1.153353, loss_ss: 0.792578, loss_d: 0.360775
0.8432 --- loss: 1.409618, loss_ss: 1.038900, loss_d: 0.370718
0.8816 --- loss: 1.312539, loss_ss: 1.250350, loss_d: 0.062189
0.9199 --- loss: 1.073224, loss_ss: 0.900135, loss_d: 0.173090
0.9582 --- loss: 1.356384, loss_ss: 1.257549, loss_d: 0.098835
0.9966 --- loss: 1.025712, loss_ss: 0.872902, loss_d: 0.152810
Epoch finished! Loss: 1.2277256413147999
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.189300, loss_ss: 0.954593, loss_d: 0.234707
0.0383 --- loss: 1.072839, loss_ss: 0.981083, loss_d: 0.091756
0.0767 --- loss: 0.859053, loss_ss: 0.812927, loss_d: 0.046126
0.1150 --- loss: 0.812993, loss_ss: 0.712233, loss_d: 0.100760
0.1533 --- loss: 1.018203, loss_ss: 0.750217, loss_d: 0.267986
0.1916 --- loss: 1.101258, loss_ss: 0.905483, loss_d: 0.195775
0.2300 --- loss: 0.828975, loss_ss: 0.741791, loss_d: 0.087184
0.2683 --- loss: 1.025519, loss_ss: 0.854869, loss_d: 0.170650
0.3066 --- loss: 1.023691, loss_ss: 0.940403, loss_d: 0.083288
0.3450 --- loss: 0.806550, loss_ss: 0.711237, loss_d: 0.095314
0.3833 --- loss: 0.744996, loss_ss: 0.702637, loss_d: 0.042359
0.4216 --- loss: 0.848977, loss_ss: 0.732751, loss_d: 0.116226
0.4599 --- loss: 0.921109, loss_ss: 0.763034, loss_d: 0.158075
0.4983 --- loss: 1.294157, loss_ss: 1.195723, loss_d: 0.098434
0.5366 --- loss: 1.073867, loss_ss: 0.964596, loss_d: 0.109272
0.5749 --- loss: 0.977410, loss_ss: 0.817702, loss_d: 0.159708
0.6133 --- loss: 0.902853, loss_ss: 0.827263, loss_d: 0.075590
0.6516 --- loss: 1.304841, loss_ss: 1.080950, loss_d: 0.223891
0.6899 --- loss: 0.735676, loss_ss: 0.625303, loss_d: 0.110372
0.7282 --- loss: 1.112015, loss_ss: 0.976587, loss_d: 0.135428
0.7666 --- loss: 1.739819, loss_ss: 1.198480, loss_d: 0.541338
0.8049 --- loss: 1.397577, loss_ss: 0.772959, loss_d: 0.624618
0.8432 --- loss: 1.335107, loss_ss: 1.256833, loss_d: 0.078273
0.8816 --- loss: 1.329613, loss_ss: 1.265111, loss_d: 0.064502
0.9199 --- loss: 1.614362, loss_ss: 1.270098, loss_d: 0.344264
0.9582 --- loss: 1.268574, loss_ss: 0.799017, loss_d: 0.469557
0.9966 --- loss: 0.989727, loss_ss: 0.896999, loss_d: 0.092728
Epoch finished! Loss: 1.1073439694367921
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.061585, loss_ss: 0.828115, loss_d: 0.233471
0.0383 --- loss: 1.335460, loss_ss: 0.926784, loss_d: 0.408676
0.0767 --- loss: 0.907751, loss_ss: 0.847003, loss_d: 0.060748
0.1150 --- loss: 0.920819, loss_ss: 0.718416, loss_d: 0.202403
0.1533 --- loss: 1.258128, loss_ss: 1.006641, loss_d: 0.251487
0.1916 --- loss: 0.864371, loss_ss: 0.802110, loss_d: 0.062260
0.2300 --- loss: 1.838407, loss_ss: 1.176803, loss_d: 0.661604
0.2683 --- loss: 0.779454, loss_ss: 0.646086, loss_d: 0.133368
0.3066 --- loss: 0.930047, loss_ss: 0.786130, loss_d: 0.143917
0.3450 --- loss: 1.146979, loss_ss: 0.895446, loss_d: 0.251533
0.3833 --- loss: 0.790508, loss_ss: 0.608726, loss_d: 0.181782
0.4216 --- loss: 1.007087, loss_ss: 0.963149, loss_d: 0.043938
0.4599 --- loss: 0.993975, loss_ss: 0.854490, loss_d: 0.139485
0.4983 --- loss: 0.720088, loss_ss: 0.696154, loss_d: 0.023933
0.5366 --- loss: 0.814679, loss_ss: 0.714580, loss_d: 0.100099
0.5749 --- loss: 1.016578, loss_ss: 0.888848, loss_d: 0.127730
0.6133 --- loss: 1.025805, loss_ss: 0.984464, loss_d: 0.041341
0.6516 --- loss: 1.066151, loss_ss: 0.997943, loss_d: 0.068208
0.6899 --- loss: 0.928862, loss_ss: 0.846068, loss_d: 0.082794
0.7282 --- loss: 1.979450, loss_ss: 0.720496, loss_d: 1.258953
0.7666 --- loss: 0.791458, loss_ss: 0.646827, loss_d: 0.144631
0.8049 --- loss: 1.211906, loss_ss: 0.957627, loss_d: 0.254279
0.8432 --- loss: 1.041133, loss_ss: 0.905900, loss_d: 0.135233
0.8816 --- loss: 1.096427, loss_ss: 1.012670, loss_d: 0.083757
0.9199 --- loss: 1.063828, loss_ss: 0.761705, loss_d: 0.302123
0.9582 --- loss: 1.054654, loss_ss: 0.905570, loss_d: 0.149084
0.9966 --- loss: 0.935668, loss_ss: 0.688514, loss_d: 0.247154
Epoch finished! Loss: 1.0665442987130238
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.871867, loss_ss: 0.817531, loss_d: 0.054336
0.0383 --- loss: 1.140643, loss_ss: 0.953168, loss_d: 0.187475
0.0767 --- loss: 0.869396, loss_ss: 0.824967, loss_d: 0.044429
0.1150 --- loss: 0.847775, loss_ss: 0.815303, loss_d: 0.032472
0.1533 --- loss: 0.555647, loss_ss: 0.487930, loss_d: 0.067717
0.1916 --- loss: 1.300023, loss_ss: 0.825058, loss_d: 0.474965
0.2300 --- loss: 0.907405, loss_ss: 0.791368, loss_d: 0.116037
0.2683 --- loss: 0.918757, loss_ss: 0.846762, loss_d: 0.071995
0.3066 --- loss: 0.895568, loss_ss: 0.774946, loss_d: 0.120621
0.3450 --- loss: 1.287314, loss_ss: 1.232799, loss_d: 0.054516
0.3833 --- loss: 0.745462, loss_ss: 0.664451, loss_d: 0.081012
0.4216 --- loss: 0.804676, loss_ss: 0.795286, loss_d: 0.009390
0.4599 --- loss: 0.947339, loss_ss: 0.879267, loss_d: 0.068073
0.4983 --- loss: 0.962409, loss_ss: 0.830250, loss_d: 0.132158
0.5366 --- loss: 0.857786, loss_ss: 0.733961, loss_d: 0.123825
0.5749 --- loss: 0.913570, loss_ss: 0.899079, loss_d: 0.014491
0.6133 --- loss: 0.884676, loss_ss: 0.794488, loss_d: 0.090187
0.6516 --- loss: 1.022956, loss_ss: 1.008316, loss_d: 0.014640
0.6899 --- loss: 0.915001, loss_ss: 0.787754, loss_d: 0.127246
0.7282 --- loss: 0.954640, loss_ss: 0.857625, loss_d: 0.097015
0.7666 --- loss: 1.022729, loss_ss: 0.974887, loss_d: 0.047842
0.8049 --- loss: 1.247980, loss_ss: 0.921300, loss_d: 0.326680
0.8432 --- loss: 1.106453, loss_ss: 0.866922, loss_d: 0.239531
0.8816 --- loss: 0.871924, loss_ss: 0.787164, loss_d: 0.084759
0.9199 --- loss: 1.127610, loss_ss: 0.727922, loss_d: 0.399689
0.9582 --- loss: 0.559683, loss_ss: 0.538045, loss_d: 0.021639
0.9966 --- loss: 0.959323, loss_ss: 0.759189, loss_d: 0.200133
Epoch finished! Loss: 0.9827021878499251
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.935351, loss_ss: 0.872543, loss_d: 0.062808
0.0383 --- loss: 1.058924, loss_ss: 0.783335, loss_d: 0.275589
0.0767 --- loss: 0.917025, loss_ss: 0.895548, loss_d: 0.021476
0.1150 --- loss: 0.848681, loss_ss: 0.774355, loss_d: 0.074327
0.1533 --- loss: 1.043087, loss_ss: 0.656356, loss_d: 0.386731
0.1916 --- loss: 0.779977, loss_ss: 0.764429, loss_d: 0.015548
0.2300 --- loss: 0.950719, loss_ss: 0.728157, loss_d: 0.222562
0.2683 --- loss: 1.155252, loss_ss: 0.999273, loss_d: 0.155980
0.3066 --- loss: 1.174730, loss_ss: 0.882623, loss_d: 0.292107
0.3450 --- loss: 1.189997, loss_ss: 0.837447, loss_d: 0.352550
0.3833 --- loss: 0.977013, loss_ss: 0.711607, loss_d: 0.265406
0.4216 --- loss: 1.027093, loss_ss: 0.972520, loss_d: 0.054574
0.4599 --- loss: 0.770672, loss_ss: 0.704202, loss_d: 0.066470
0.4983 --- loss: 1.069885, loss_ss: 0.981313, loss_d: 0.088572
0.5366 --- loss: 1.194082, loss_ss: 0.811062, loss_d: 0.383020
0.5749 --- loss: 1.284863, loss_ss: 0.883202, loss_d: 0.401661
0.6133 --- loss: 1.028174, loss_ss: 0.871918, loss_d: 0.156255
0.6516 --- loss: 0.879534, loss_ss: 0.749242, loss_d: 0.130292
0.6899 --- loss: 0.890058, loss_ss: 0.793003, loss_d: 0.097055
0.7282 --- loss: 0.679891, loss_ss: 0.640775, loss_d: 0.039116
0.7666 --- loss: 0.781823, loss_ss: 0.718416, loss_d: 0.063407
0.8049 --- loss: 0.661547, loss_ss: 0.532671, loss_d: 0.128876
0.8432 --- loss: 1.220058, loss_ss: 1.145869, loss_d: 0.074189
0.8816 --- loss: 0.873317, loss_ss: 0.789729, loss_d: 0.083588
0.9199 --- loss: 0.839089, loss_ss: 0.772548, loss_d: 0.066541
0.9582 --- loss: 1.002246, loss_ss: 0.982188, loss_d: 0.020058
0.9966 --- loss: 0.989266, loss_ss: 0.911732, loss_d: 0.077534
Epoch finished! Loss: 0.9735577649795092
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.923583, loss_ss: 0.898198, loss_d: 0.025386
0.0383 --- loss: 0.776979, loss_ss: 0.756285, loss_d: 0.020694
0.0767 --- loss: 0.712660, loss_ss: 0.593848, loss_d: 0.118812
0.1150 --- loss: 1.097086, loss_ss: 0.893880, loss_d: 0.203206
0.1533 --- loss: 0.957641, loss_ss: 0.883059, loss_d: 0.074581
0.1916 --- loss: 1.108207, loss_ss: 1.012138, loss_d: 0.096069
0.2300 --- loss: 0.857115, loss_ss: 0.821622, loss_d: 0.035493
0.2683 --- loss: 1.367331, loss_ss: 0.655373, loss_d: 0.711958
0.3066 --- loss: 0.758838, loss_ss: 0.682125, loss_d: 0.076712
0.3450 --- loss: 0.816858, loss_ss: 0.711513, loss_d: 0.105345
0.3833 --- loss: 0.828955, loss_ss: 0.812231, loss_d: 0.016724
0.4216 --- loss: 0.939007, loss_ss: 0.896266, loss_d: 0.042740
0.4599 --- loss: 1.088105, loss_ss: 0.810182, loss_d: 0.277923
0.4983 --- loss: 0.700147, loss_ss: 0.644153, loss_d: 0.055993
0.5366 --- loss: 1.111278, loss_ss: 1.026202, loss_d: 0.085076
0.5749 --- loss: 0.773096, loss_ss: 0.707526, loss_d: 0.065570
0.6133 --- loss: 0.801175, loss_ss: 0.731370, loss_d: 0.069805
0.6516 --- loss: 0.947398, loss_ss: 0.774043, loss_d: 0.173355
0.6899 --- loss: 0.844255, loss_ss: 0.773155, loss_d: 0.071099
0.7282 --- loss: 1.183863, loss_ss: 1.149987, loss_d: 0.033876
0.7666 --- loss: 0.977194, loss_ss: 0.907374, loss_d: 0.069820
0.8049 --- loss: 0.929595, loss_ss: 0.908685, loss_d: 0.020910
0.8432 --- loss: 0.933004, loss_ss: 0.590190, loss_d: 0.342814
0.8816 --- loss: 0.906951, loss_ss: 0.685333, loss_d: 0.221617
0.9199 --- loss: 0.954749, loss_ss: 0.857251, loss_d: 0.097497
0.9582 --- loss: 0.816687, loss_ss: 0.746547, loss_d: 0.070140
0.9966 --- loss: 0.897158, loss_ss: 0.861770, loss_d: 0.035388
Epoch finished! Loss: 0.9208900914742396
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.734932, loss_ss: 0.614327, loss_d: 0.120605
0.0383 --- loss: 0.911205, loss_ss: 0.757572, loss_d: 0.153633
0.0767 --- loss: 1.066604, loss_ss: 0.814525, loss_d: 0.252080
0.1150 --- loss: 0.571601, loss_ss: 0.514906, loss_d: 0.056695
0.1533 --- loss: 0.746799, loss_ss: 0.727911, loss_d: 0.018887
0.1916 --- loss: 0.922550, loss_ss: 0.900959, loss_d: 0.021592
0.2300 --- loss: 0.860755, loss_ss: 0.667982, loss_d: 0.192773
0.2683 --- loss: 0.911294, loss_ss: 0.859950, loss_d: 0.051344
0.3066 --- loss: 1.442995, loss_ss: 1.064168, loss_d: 0.378827
0.3450 --- loss: 1.224681, loss_ss: 0.939853, loss_d: 0.284828
0.3833 --- loss: 0.867418, loss_ss: 0.733498, loss_d: 0.133921
0.4216 --- loss: 0.826648, loss_ss: 0.667014, loss_d: 0.159634
0.4599 --- loss: 0.563895, loss_ss: 0.488297, loss_d: 0.075598
0.4983 --- loss: 0.685895, loss_ss: 0.655782, loss_d: 0.030113
0.5366 --- loss: 0.685877, loss_ss: 0.656916, loss_d: 0.028961
0.5749 --- loss: 0.560740, loss_ss: 0.552737, loss_d: 0.008004
0.6133 --- loss: 0.623115, loss_ss: 0.615589, loss_d: 0.007526
0.6516 --- loss: 0.796952, loss_ss: 0.649188, loss_d: 0.147764
0.6899 --- loss: 0.750115, loss_ss: 0.706893, loss_d: 0.043223
0.7282 --- loss: 0.892105, loss_ss: 0.669604, loss_d: 0.222501
0.7666 --- loss: 0.796876, loss_ss: 0.775505, loss_d: 0.021371
0.8049 --- loss: 1.375703, loss_ss: 1.365188, loss_d: 0.010514
0.8432 --- loss: 0.914070, loss_ss: 0.878974, loss_d: 0.035096
0.8816 --- loss: 0.729289, loss_ss: 0.710490, loss_d: 0.018799
0.9199 --- loss: 0.905247, loss_ss: 0.889694, loss_d: 0.015553
0.9582 --- loss: 0.926754, loss_ss: 0.740337, loss_d: 0.186416
0.9966 --- loss: 1.259708, loss_ss: 0.946952, loss_d: 0.312756
Epoch finished! Loss: 0.8837360566625229
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.3632183908045977
             precision    recall  f1-score   support

        0.0       0.69      0.57      0.63       291
        1.0       0.26      0.17      0.21       231
        2.0       0.63      0.17      0.27       233
        3.0       0.00      0.00      0.00        25
        4.0       0.17      0.77      0.27        90

avg / total       0.49      0.36      0.37       870
 


====== chp047-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  77.24  57.39   87.22  69.29     62.78
1  64.94  17.32   82.16  25.97     20.78
2  75.17  17.17   96.39  63.49     27.03
3  97.13   0.00  100.00   0.00      0.00
4  58.16  76.67   56.03  16.75     27.49
Total accuracy: 36.32%
Average sen: 33.71%
Average spec: 84.36%
Macro f1-score: 27.62%
Diagnosis acc on 15mins: 1.0
[0.99997973 0.99988091 0.9999572  0.99999309 0.99999964 0.99999845
 0.99999571 0.99999976 0.99999964 0.99999917 1.         0.99999976
 1.         0.99999797 0.99999762 0.99999988 0.99998975 0.99999988
 0.99999869 0.99999464 0.99999011 0.99999988 0.99999845 0.99997699
 0.99998724 0.99999344 0.99999797 0.99995053 0.99998653]
pred: 0.999988366817606, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.425189, loss_ss: 1.729730, loss_d: 0.695459
0.0384 --- loss: 2.266210, loss_ss: 1.553108, loss_d: 0.713102
0.0768 --- loss: 2.034164, loss_ss: 1.517529, loss_d: 0.516635
0.1152 --- loss: 1.963312, loss_ss: 1.484729, loss_d: 0.478583
0.1536 --- loss: 1.916958, loss_ss: 1.430975, loss_d: 0.485983
0.1920 --- loss: 2.057630, loss_ss: 1.426861, loss_d: 0.630769
0.2304 --- loss: 2.240377, loss_ss: 1.354644, loss_d: 0.885733
0.2688 --- loss: 2.069128, loss_ss: 1.448017, loss_d: 0.621111
0.3072 --- loss: 2.079113, loss_ss: 1.507576, loss_d: 0.571536
0.3456 --- loss: 1.871718, loss_ss: 1.442692, loss_d: 0.429027
0.3840 --- loss: 2.341825, loss_ss: 1.430239, loss_d: 0.911586
0.4224 --- loss: 2.025207, loss_ss: 1.452240, loss_d: 0.572967
0.4608 --- loss: 1.772625, loss_ss: 1.287754, loss_d: 0.484871
0.4992 --- loss: 1.864127, loss_ss: 1.392505, loss_d: 0.471622
0.5376 --- loss: 1.666595, loss_ss: 1.296152, loss_d: 0.370443
0.5760 --- loss: 1.573389, loss_ss: 1.293702, loss_d: 0.279687
0.6144 --- loss: 1.998440, loss_ss: 1.332723, loss_d: 0.665717
0.6528 --- loss: 1.822288, loss_ss: 1.286026, loss_d: 0.536262
0.6912 --- loss: 2.056416, loss_ss: 1.413642, loss_d: 0.642774
0.7296 --- loss: 1.806266, loss_ss: 1.480814, loss_d: 0.325452
0.7680 --- loss: 2.066643, loss_ss: 1.617159, loss_d: 0.449484
0.8065 --- loss: 1.767466, loss_ss: 1.377022, loss_d: 0.390444
0.8449 --- loss: 1.787624, loss_ss: 1.360220, loss_d: 0.427404
0.8833 --- loss: 1.428956, loss_ss: 1.098868, loss_d: 0.330089
0.9217 --- loss: 1.650623, loss_ss: 1.139830, loss_d: 0.510793
0.9601 --- loss: 1.913089, loss_ss: 1.352497, loss_d: 0.560592
0.9985 --- loss: 1.636556, loss_ss: 1.446999, loss_d: 0.189557
Epoch finished! Loss: 1.9393076580304367
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.561806, loss_ss: 1.346351, loss_d: 0.215455
0.0384 --- loss: 2.256134, loss_ss: 1.360410, loss_d: 0.895724
0.0768 --- loss: 2.094076, loss_ss: 1.272095, loss_d: 0.821981
0.1152 --- loss: 1.410053, loss_ss: 1.026521, loss_d: 0.383532
0.1536 --- loss: 1.887502, loss_ss: 1.310364, loss_d: 0.577138
0.1920 --- loss: 1.857252, loss_ss: 1.353965, loss_d: 0.503287
0.2304 --- loss: 1.545281, loss_ss: 1.246842, loss_d: 0.298439
0.2688 --- loss: 1.934289, loss_ss: 1.337402, loss_d: 0.596887
0.3072 --- loss: 1.692476, loss_ss: 1.446756, loss_d: 0.245720
0.3456 --- loss: 1.455244, loss_ss: 1.256186, loss_d: 0.199057
0.3840 --- loss: 1.186202, loss_ss: 1.073735, loss_d: 0.112467
0.4224 --- loss: 1.391454, loss_ss: 1.072694, loss_d: 0.318761
0.4608 --- loss: 1.632079, loss_ss: 1.249316, loss_d: 0.382763
0.4992 --- loss: 1.201917, loss_ss: 1.110869, loss_d: 0.091048
0.5376 --- loss: 1.533413, loss_ss: 1.343957, loss_d: 0.189456
0.5760 --- loss: 1.522522, loss_ss: 1.313463, loss_d: 0.209059
0.6144 --- loss: 1.424617, loss_ss: 1.105570, loss_d: 0.319047
0.6528 --- loss: 1.241342, loss_ss: 1.033653, loss_d: 0.207689
0.6912 --- loss: 1.262188, loss_ss: 1.072840, loss_d: 0.189348
0.7296 --- loss: 1.117589, loss_ss: 0.805038, loss_d: 0.312551
0.7680 --- loss: 1.351348, loss_ss: 1.047229, loss_d: 0.304119
0.8065 --- loss: 1.284952, loss_ss: 0.954884, loss_d: 0.330068
0.8449 --- loss: 1.522927, loss_ss: 1.070560, loss_d: 0.452367
0.8833 --- loss: 1.228654, loss_ss: 1.071662, loss_d: 0.156992
0.9217 --- loss: 1.614527, loss_ss: 1.287641, loss_d: 0.326886
0.9601 --- loss: 1.234319, loss_ss: 1.132844, loss_d: 0.101475
0.9985 --- loss: 1.623838, loss_ss: 1.334669, loss_d: 0.289169
Epoch finished! Loss: 1.4804986318716635
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.135989, loss_ss: 1.055519, loss_d: 0.080470
0.0384 --- loss: 1.134232, loss_ss: 0.998759, loss_d: 0.135473
0.0768 --- loss: 1.161448, loss_ss: 0.979518, loss_d: 0.181930
0.1152 --- loss: 1.625571, loss_ss: 1.188478, loss_d: 0.437092
0.1536 --- loss: 1.980097, loss_ss: 1.277506, loss_d: 0.702591
0.1920 --- loss: 1.360112, loss_ss: 0.821957, loss_d: 0.538155
0.2304 --- loss: 1.313690, loss_ss: 1.129870, loss_d: 0.183821
0.2688 --- loss: 1.006768, loss_ss: 0.868075, loss_d: 0.138693
0.3072 --- loss: 1.258957, loss_ss: 1.180034, loss_d: 0.078923
0.3456 --- loss: 1.306706, loss_ss: 1.169588, loss_d: 0.137118
0.3840 --- loss: 1.198070, loss_ss: 0.936933, loss_d: 0.261137
0.4224 --- loss: 1.230790, loss_ss: 0.906098, loss_d: 0.324693
0.4608 --- loss: 1.549011, loss_ss: 1.252597, loss_d: 0.296414
0.4992 --- loss: 1.257022, loss_ss: 1.094015, loss_d: 0.163007
0.5376 --- loss: 1.140479, loss_ss: 1.058659, loss_d: 0.081820
0.5760 --- loss: 1.942739, loss_ss: 1.119743, loss_d: 0.822996
0.6144 --- loss: 0.959900, loss_ss: 0.810388, loss_d: 0.149513
0.6528 --- loss: 1.488124, loss_ss: 1.084189, loss_d: 0.403935
0.6912 --- loss: 1.555761, loss_ss: 1.297722, loss_d: 0.258039
0.7296 --- loss: 1.103316, loss_ss: 0.993916, loss_d: 0.109400
0.7680 --- loss: 1.479383, loss_ss: 0.982508, loss_d: 0.496876
0.8065 --- loss: 1.242853, loss_ss: 1.051800, loss_d: 0.191053
0.8449 --- loss: 1.115678, loss_ss: 0.948605, loss_d: 0.167073
0.8833 --- loss: 1.214062, loss_ss: 1.086785, loss_d: 0.127277
0.9217 --- loss: 1.672452, loss_ss: 1.421218, loss_d: 0.251234
0.9601 --- loss: 0.952346, loss_ss: 0.922110, loss_d: 0.030236
0.9985 --- loss: 1.116856, loss_ss: 1.046102, loss_d: 0.070754
Epoch finished! Loss: 1.3358735678287652
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.479024, loss_ss: 1.236079, loss_d: 0.242944
0.0384 --- loss: 1.766059, loss_ss: 1.096455, loss_d: 0.669604
0.0768 --- loss: 1.060684, loss_ss: 0.962296, loss_d: 0.098388
0.1152 --- loss: 1.710217, loss_ss: 1.200566, loss_d: 0.509651
0.1536 --- loss: 1.289168, loss_ss: 1.058108, loss_d: 0.231060
0.1920 --- loss: 1.269030, loss_ss: 1.165718, loss_d: 0.103312
0.2304 --- loss: 1.213766, loss_ss: 1.094809, loss_d: 0.118957
0.2688 --- loss: 0.903810, loss_ss: 0.855399, loss_d: 0.048411
0.3072 --- loss: 1.068590, loss_ss: 0.888370, loss_d: 0.180219
0.3456 --- loss: 0.945514, loss_ss: 0.897334, loss_d: 0.048179
0.3840 --- loss: 1.103355, loss_ss: 0.931487, loss_d: 0.171868
0.4224 --- loss: 0.907590, loss_ss: 0.784202, loss_d: 0.123388
0.4608 --- loss: 1.486812, loss_ss: 1.125851, loss_d: 0.360962
0.4992 --- loss: 1.289261, loss_ss: 1.157428, loss_d: 0.131833
0.5376 --- loss: 1.190614, loss_ss: 1.096824, loss_d: 0.093790
0.5760 --- loss: 0.901124, loss_ss: 0.766384, loss_d: 0.134740
0.6144 --- loss: 1.721530, loss_ss: 1.189708, loss_d: 0.531822
0.6528 --- loss: 1.250030, loss_ss: 1.012582, loss_d: 0.237448
0.6912 --- loss: 1.027469, loss_ss: 0.845524, loss_d: 0.181945
0.7296 --- loss: 1.276014, loss_ss: 1.015399, loss_d: 0.260616
0.7680 --- loss: 1.200333, loss_ss: 1.052107, loss_d: 0.148226
0.8065 --- loss: 1.065093, loss_ss: 0.956965, loss_d: 0.108128
0.8449 --- loss: 0.914832, loss_ss: 0.736144, loss_d: 0.178688
0.8833 --- loss: 1.190955, loss_ss: 1.021850, loss_d: 0.169105
0.9217 --- loss: 1.023408, loss_ss: 0.936659, loss_d: 0.086750
0.9601 --- loss: 1.302300, loss_ss: 0.806184, loss_d: 0.496116
0.9985 --- loss: 4.663456, loss_ss: 1.853075, loss_d: 2.810381
Epoch finished! Loss: 1.2243569183808107
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.161950, loss_ss: 0.870998, loss_d: 0.290951
0.0384 --- loss: 1.338372, loss_ss: 1.090491, loss_d: 0.247880
0.0768 --- loss: 1.256853, loss_ss: 0.916791, loss_d: 0.340061
0.1152 --- loss: 0.976451, loss_ss: 0.783429, loss_d: 0.193022
0.1536 --- loss: 1.100705, loss_ss: 1.069015, loss_d: 0.031690
0.1920 --- loss: 0.857527, loss_ss: 0.778535, loss_d: 0.078992
0.2304 --- loss: 0.896543, loss_ss: 0.859637, loss_d: 0.036907
0.2688 --- loss: 1.311930, loss_ss: 0.809915, loss_d: 0.502016
0.3072 --- loss: 0.967052, loss_ss: 0.928180, loss_d: 0.038872
0.3456 --- loss: 1.262435, loss_ss: 0.842704, loss_d: 0.419731
0.3840 --- loss: 1.024130, loss_ss: 1.008266, loss_d: 0.015864
0.4224 --- loss: 1.263122, loss_ss: 1.072708, loss_d: 0.190414
0.4608 --- loss: 1.041518, loss_ss: 0.993620, loss_d: 0.047899
0.4992 --- loss: 1.035902, loss_ss: 0.904567, loss_d: 0.131334
0.5376 --- loss: 0.813126, loss_ss: 0.738733, loss_d: 0.074393
0.5760 --- loss: 0.915542, loss_ss: 0.631181, loss_d: 0.284362
0.6144 --- loss: 1.006221, loss_ss: 0.897379, loss_d: 0.108842
0.6528 --- loss: 1.460392, loss_ss: 1.313030, loss_d: 0.147362
0.6912 --- loss: 0.833385, loss_ss: 0.797163, loss_d: 0.036222
0.7296 --- loss: 0.838429, loss_ss: 0.789912, loss_d: 0.048517
0.7680 --- loss: 1.073103, loss_ss: 0.915958, loss_d: 0.157145
0.8065 --- loss: 1.221964, loss_ss: 1.176572, loss_d: 0.045392
0.8449 --- loss: 0.922965, loss_ss: 0.839370, loss_d: 0.083594
0.8833 --- loss: 0.881316, loss_ss: 0.700409, loss_d: 0.180906
0.9217 --- loss: 1.384492, loss_ss: 1.210134, loss_d: 0.174358
0.9601 --- loss: 1.234262, loss_ss: 0.777373, loss_d: 0.456889
0.9985 --- loss: 1.439751, loss_ss: 1.398135, loss_d: 0.041616
Epoch finished! Loss: 1.1440585079101415
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.168443, loss_ss: 0.893465, loss_d: 0.274978
0.0384 --- loss: 1.331073, loss_ss: 1.018088, loss_d: 0.312985
0.0768 --- loss: 1.015607, loss_ss: 0.975028, loss_d: 0.040578
0.1152 --- loss: 1.409376, loss_ss: 0.859298, loss_d: 0.550078
0.1536 --- loss: 1.242544, loss_ss: 1.095914, loss_d: 0.146631
0.1920 --- loss: 0.907987, loss_ss: 0.808726, loss_d: 0.099261
0.2304 --- loss: 0.920644, loss_ss: 0.747096, loss_d: 0.173548
0.2688 --- loss: 0.996265, loss_ss: 0.904901, loss_d: 0.091365
0.3072 --- loss: 1.155198, loss_ss: 1.102833, loss_d: 0.052364
0.3456 --- loss: 1.348256, loss_ss: 1.074721, loss_d: 0.273534
0.3840 --- loss: 1.558159, loss_ss: 1.006649, loss_d: 0.551509
0.4224 --- loss: 1.216796, loss_ss: 0.927003, loss_d: 0.289793
0.4608 --- loss: 1.478836, loss_ss: 1.280876, loss_d: 0.197959
0.4992 --- loss: 1.389121, loss_ss: 0.937983, loss_d: 0.451138
0.5376 --- loss: 1.299924, loss_ss: 0.950285, loss_d: 0.349639
0.5760 --- loss: 1.167415, loss_ss: 1.075724, loss_d: 0.091691
0.6144 --- loss: 1.156074, loss_ss: 1.088625, loss_d: 0.067449
0.6528 --- loss: 1.141801, loss_ss: 1.129211, loss_d: 0.012590
0.6912 --- loss: 0.975941, loss_ss: 0.888786, loss_d: 0.087155
0.7296 --- loss: 1.226618, loss_ss: 1.140686, loss_d: 0.085932
0.7680 --- loss: 1.013173, loss_ss: 0.870997, loss_d: 0.142176
0.8065 --- loss: 1.145275, loss_ss: 1.035648, loss_d: 0.109627
0.8449 --- loss: 1.018852, loss_ss: 0.920015, loss_d: 0.098836
0.8833 --- loss: 1.105182, loss_ss: 1.087570, loss_d: 0.017612
0.9217 --- loss: 0.932596, loss_ss: 0.883539, loss_d: 0.049057
0.9601 --- loss: 0.903306, loss_ss: 0.859899, loss_d: 0.043407
0.9985 --- loss: 1.437393, loss_ss: 1.330439, loss_d: 0.106954
Epoch finished! Loss: 1.100172519683838
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.295087, loss_ss: 1.115415, loss_d: 0.179672
0.0384 --- loss: 0.799050, loss_ss: 0.654015, loss_d: 0.145035
0.0768 --- loss: 0.865288, loss_ss: 0.833004, loss_d: 0.032284
0.1152 --- loss: 0.859322, loss_ss: 0.807684, loss_d: 0.051638
0.1536 --- loss: 1.246682, loss_ss: 1.218003, loss_d: 0.028679
0.1920 --- loss: 0.929403, loss_ss: 0.909870, loss_d: 0.019533
0.2304 --- loss: 0.796669, loss_ss: 0.673087, loss_d: 0.123583
0.2688 --- loss: 0.793146, loss_ss: 0.612397, loss_d: 0.180748
0.3072 --- loss: 0.694368, loss_ss: 0.640197, loss_d: 0.054172
0.3456 --- loss: 0.925914, loss_ss: 0.911538, loss_d: 0.014376
0.3840 --- loss: 1.379658, loss_ss: 1.252094, loss_d: 0.127565
0.4224 --- loss: 0.879838, loss_ss: 0.823784, loss_d: 0.056054
0.4608 --- loss: 1.157234, loss_ss: 1.111220, loss_d: 0.046014
0.4992 --- loss: 0.527326, loss_ss: 0.494318, loss_d: 0.033008
0.5376 --- loss: 1.127648, loss_ss: 0.845308, loss_d: 0.282340
0.5760 --- loss: 1.312977, loss_ss: 1.061485, loss_d: 0.251492
0.6144 --- loss: 0.815460, loss_ss: 0.769417, loss_d: 0.046043
0.6528 --- loss: 0.874714, loss_ss: 0.837850, loss_d: 0.036864
0.6912 --- loss: 1.332424, loss_ss: 0.861565, loss_d: 0.470859
0.7296 --- loss: 0.854045, loss_ss: 0.805724, loss_d: 0.048321
0.7680 --- loss: 0.922756, loss_ss: 0.904327, loss_d: 0.018429
0.8065 --- loss: 1.675596, loss_ss: 0.980380, loss_d: 0.695215
0.8449 --- loss: 0.991497, loss_ss: 0.889683, loss_d: 0.101814
0.8833 --- loss: 1.195732, loss_ss: 0.854537, loss_d: 0.341195
0.9217 --- loss: 0.755420, loss_ss: 0.710218, loss_d: 0.045201
0.9601 --- loss: 0.975601, loss_ss: 0.797161, loss_d: 0.178440
0.9985 --- loss: 3.532288, loss_ss: 0.759377, loss_d: 2.772911
Epoch finished! Loss: 1.0347625461908487
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.068601, loss_ss: 0.795757, loss_d: 0.272843
0.0384 --- loss: 1.327924, loss_ss: 1.079639, loss_d: 0.248286
0.0768 --- loss: 0.820501, loss_ss: 0.750612, loss_d: 0.069889
0.1152 --- loss: 0.841714, loss_ss: 0.790148, loss_d: 0.051567
0.1536 --- loss: 1.050668, loss_ss: 0.982927, loss_d: 0.067741
0.1920 --- loss: 0.830343, loss_ss: 0.716244, loss_d: 0.114099
0.2304 --- loss: 0.813852, loss_ss: 0.782929, loss_d: 0.030923
0.2688 --- loss: 0.790683, loss_ss: 0.765786, loss_d: 0.024897
0.3072 --- loss: 1.006355, loss_ss: 0.905526, loss_d: 0.100829
0.3456 --- loss: 0.922628, loss_ss: 0.725931, loss_d: 0.196697
0.3840 --- loss: 0.933179, loss_ss: 0.927373, loss_d: 0.005805
0.4224 --- loss: 0.861680, loss_ss: 0.844105, loss_d: 0.017575
0.4608 --- loss: 1.252661, loss_ss: 0.990228, loss_d: 0.262433
0.4992 --- loss: 0.853691, loss_ss: 0.845721, loss_d: 0.007969
0.5376 --- loss: 1.144052, loss_ss: 0.843286, loss_d: 0.300766
0.5760 --- loss: 0.923722, loss_ss: 0.735787, loss_d: 0.187934
0.6144 --- loss: 1.314671, loss_ss: 0.929439, loss_d: 0.385232
0.6528 --- loss: 0.756549, loss_ss: 0.747282, loss_d: 0.009267
0.6912 --- loss: 1.083677, loss_ss: 0.997360, loss_d: 0.086317
0.7296 --- loss: 1.460348, loss_ss: 1.075654, loss_d: 0.384694
0.7680 --- loss: 1.178111, loss_ss: 1.107131, loss_d: 0.070980
0.8065 --- loss: 0.850017, loss_ss: 0.824636, loss_d: 0.025381
0.8449 --- loss: 0.818160, loss_ss: 0.803087, loss_d: 0.015073
0.8833 --- loss: 0.862504, loss_ss: 0.784000, loss_d: 0.078504
0.9217 --- loss: 0.922066, loss_ss: 0.870314, loss_d: 0.051753
0.9601 --- loss: 0.812296, loss_ss: 0.801975, loss_d: 0.010321
0.9985 --- loss: 1.197166, loss_ss: 1.182621, loss_d: 0.014545
Epoch finished! Loss: 1.0042675609772023
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.924565, loss_ss: 0.801218, loss_d: 0.123347
0.0384 --- loss: 0.971119, loss_ss: 0.965057, loss_d: 0.006062
0.0768 --- loss: 0.881110, loss_ss: 0.845404, loss_d: 0.035706
0.1152 --- loss: 0.906049, loss_ss: 0.784323, loss_d: 0.121726
0.1536 --- loss: 0.849532, loss_ss: 0.825214, loss_d: 0.024318
0.1920 --- loss: 1.006402, loss_ss: 0.860965, loss_d: 0.145436
0.2304 --- loss: 0.748416, loss_ss: 0.694822, loss_d: 0.053594
0.2688 --- loss: 1.118149, loss_ss: 1.036038, loss_d: 0.082110
0.3072 --- loss: 2.602848, loss_ss: 0.911602, loss_d: 1.691246
0.3456 --- loss: 0.784990, loss_ss: 0.741285, loss_d: 0.043705
0.3840 --- loss: 0.799780, loss_ss: 0.682147, loss_d: 0.117633
0.4224 --- loss: 1.303810, loss_ss: 0.952756, loss_d: 0.351054
0.4608 --- loss: 1.188349, loss_ss: 1.171152, loss_d: 0.017197
0.4992 --- loss: 0.899111, loss_ss: 0.723557, loss_d: 0.175554
0.5376 --- loss: 0.682256, loss_ss: 0.625751, loss_d: 0.056506
0.5760 --- loss: 0.966819, loss_ss: 0.898423, loss_d: 0.068396
0.6144 --- loss: 0.810203, loss_ss: 0.808721, loss_d: 0.001482
0.6528 --- loss: 1.200448, loss_ss: 1.102254, loss_d: 0.098194
0.6912 --- loss: 0.797198, loss_ss: 0.778164, loss_d: 0.019034
0.7296 --- loss: 1.441120, loss_ss: 0.732642, loss_d: 0.708479
0.7680 --- loss: 1.146952, loss_ss: 1.130801, loss_d: 0.016151
0.8065 --- loss: 0.941157, loss_ss: 0.910638, loss_d: 0.030519
0.8449 --- loss: 0.939028, loss_ss: 0.708039, loss_d: 0.230989
0.8833 --- loss: 1.333616, loss_ss: 1.001211, loss_d: 0.332405
0.9217 --- loss: 0.977994, loss_ss: 0.922808, loss_d: 0.055185
0.9601 --- loss: 0.888997, loss_ss: 0.842992, loss_d: 0.046004
0.9985 --- loss: 1.363719, loss_ss: 1.356345, loss_d: 0.007374
Epoch finished! Loss: 0.9669400100524609
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.178494, loss_ss: 1.025738, loss_d: 0.152756
0.0384 --- loss: 0.948199, loss_ss: 0.912124, loss_d: 0.036075
0.0768 --- loss: 0.858153, loss_ss: 0.840358, loss_d: 0.017794
0.1152 --- loss: 1.376044, loss_ss: 1.326481, loss_d: 0.049563
0.1536 --- loss: 0.653610, loss_ss: 0.592215, loss_d: 0.061395
0.1920 --- loss: 0.588306, loss_ss: 0.576335, loss_d: 0.011971
0.2304 --- loss: 1.024344, loss_ss: 0.795526, loss_d: 0.228817
0.2688 --- loss: 0.887602, loss_ss: 0.853512, loss_d: 0.034090
0.3072 --- loss: 0.920691, loss_ss: 0.884440, loss_d: 0.036251
0.3456 --- loss: 1.121227, loss_ss: 0.739936, loss_d: 0.381290
0.3840 --- loss: 0.794959, loss_ss: 0.792749, loss_d: 0.002210
0.4224 --- loss: 0.851315, loss_ss: 0.832306, loss_d: 0.019009
0.4608 --- loss: 0.723809, loss_ss: 0.625795, loss_d: 0.098014
0.4992 --- loss: 1.086987, loss_ss: 1.057832, loss_d: 0.029155
0.5376 --- loss: 0.537420, loss_ss: 0.466370, loss_d: 0.071051
0.5760 --- loss: 0.893107, loss_ss: 0.866498, loss_d: 0.026609
0.6144 --- loss: 0.745388, loss_ss: 0.737358, loss_d: 0.008031
0.6528 --- loss: 0.870676, loss_ss: 0.859119, loss_d: 0.011557
0.6912 --- loss: 0.881263, loss_ss: 0.860232, loss_d: 0.021031
0.7296 --- loss: 0.800264, loss_ss: 0.796746, loss_d: 0.003518
0.7680 --- loss: 0.748192, loss_ss: 0.720083, loss_d: 0.028109
0.8065 --- loss: 0.873178, loss_ss: 0.868849, loss_d: 0.004328
0.8449 --- loss: 0.739711, loss_ss: 0.689883, loss_d: 0.049828
0.8833 --- loss: 1.262543, loss_ss: 1.183441, loss_d: 0.079102
0.9217 --- loss: 0.887502, loss_ss: 0.873595, loss_d: 0.013907
0.9601 --- loss: 0.643751, loss_ss: 0.589921, loss_d: 0.053829
0.9985 --- loss: 1.124251, loss_ss: 1.123503, loss_d: 0.000748
Epoch finished! Loss: 0.9511065109417989
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6107843137254902
             precision    recall  f1-score   support

        0.0       0.19      0.97      0.32        38
        1.0       0.38      0.56      0.45       144
        2.0       0.82      0.81      0.82       495
        3.0       0.71      0.57      0.63       107
        4.0       0.98      0.18      0.30       236

avg / total       0.76      0.61      0.61      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.90  97.37   84.42  19.47     32.46
1  80.88  55.56   85.05  37.91     45.07
2  82.45  81.41   83.43  82.24     81.83
3  93.04  57.01   97.26  70.93     63.21
4  80.88  17.80   99.87  97.67     30.11
Total accuracy: 61.08%
Average sen: 61.83%
Average spec: 90.01%
Macro f1-score: 50.53%
Diagnosis acc on 15mins: 0.029411764705882353
[7.14029709e-04 3.89783736e-03 4.03210428e-03 2.87989620e-03
 1.46866292e-02 4.36892062e-02 1.08519783e-02 8.29383731e-03
 5.94011992e-02 4.36472939e-03 6.89749606e-04 7.23201735e-03
 2.38709687e-03 9.71051212e-03 1.19296154e-02 2.88222753e-03
 7.15618022e-04 1.51828906e-04 2.08613998e-03 4.06225119e-03
 1.99627387e-03 4.36406545e-02 5.04255556e-02 1.75006762e-02
 4.45574075e-02 1.88336428e-03 1.38194850e-02 8.95026565e-01
 4.66008931e-01 7.02174241e-03 2.29758680e-01 5.06967120e-02
 5.36785387e-02 1.85758285e-02]
pred: 0.061448497604835534, label: 1
Wrong!!! Real Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.636706, loss_ss: 1.955867, loss_d: 0.680839
0.0384 --- loss: 1.853581, loss_ss: 1.449078, loss_d: 0.404503
0.0769 --- loss: 1.796386, loss_ss: 1.451944, loss_d: 0.344442
0.1153 --- loss: 2.121825, loss_ss: 1.466893, loss_d: 0.654931
0.1537 --- loss: 1.893760, loss_ss: 1.357107, loss_d: 0.536654
0.1922 --- loss: 2.273283, loss_ss: 1.682935, loss_d: 0.590348
0.2306 --- loss: 1.938146, loss_ss: 1.455678, loss_d: 0.482468
0.2690 --- loss: 1.784063, loss_ss: 1.407193, loss_d: 0.376870
0.3075 --- loss: 1.933204, loss_ss: 1.393372, loss_d: 0.539832
0.3459 --- loss: 1.810868, loss_ss: 1.366485, loss_d: 0.444383
0.3843 --- loss: 2.127738, loss_ss: 1.500378, loss_d: 0.627360
0.4228 --- loss: 1.879052, loss_ss: 1.247199, loss_d: 0.631853
0.4612 --- loss: 2.067309, loss_ss: 1.429941, loss_d: 0.637368
0.4996 --- loss: 2.233778, loss_ss: 1.519089, loss_d: 0.714689
0.5380 --- loss: 2.106689, loss_ss: 1.604006, loss_d: 0.502683
0.5765 --- loss: 1.849147, loss_ss: 1.320512, loss_d: 0.528636
0.6149 --- loss: 1.612230, loss_ss: 1.343168, loss_d: 0.269062
0.6533 --- loss: 1.578716, loss_ss: 1.191371, loss_d: 0.387345
0.6918 --- loss: 2.272475, loss_ss: 1.583210, loss_d: 0.689265
0.7302 --- loss: 1.926257, loss_ss: 1.431299, loss_d: 0.494957
0.7686 --- loss: 1.644691, loss_ss: 1.347311, loss_d: 0.297380
0.8071 --- loss: 1.579059, loss_ss: 1.189214, loss_d: 0.389846
0.8455 --- loss: 1.841161, loss_ss: 1.203981, loss_d: 0.637180
0.8839 --- loss: 2.166692, loss_ss: 1.630417, loss_d: 0.536275
0.9224 --- loss: 1.781202, loss_ss: 1.632378, loss_d: 0.148824
0.9608 --- loss: 1.496795, loss_ss: 1.247434, loss_d: 0.249360
0.9992 --- loss: 1.452889, loss_ss: 1.269573, loss_d: 0.183316
Epoch finished! Loss: 1.911256848848783
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.616341, loss_ss: 1.411162, loss_d: 0.205178
0.0384 --- loss: 1.333307, loss_ss: 1.052046, loss_d: 0.281261
0.0769 --- loss: 1.427366, loss_ss: 1.089390, loss_d: 0.337976
0.1153 --- loss: 1.489831, loss_ss: 1.077730, loss_d: 0.412101
0.1537 --- loss: 1.494780, loss_ss: 1.223615, loss_d: 0.271165
0.1922 --- loss: 2.195858, loss_ss: 1.293201, loss_d: 0.902657
0.2306 --- loss: 1.760686, loss_ss: 1.280560, loss_d: 0.480126
0.2690 --- loss: 2.254977, loss_ss: 1.292013, loss_d: 0.962965
0.3075 --- loss: 1.370321, loss_ss: 1.111693, loss_d: 0.258629
0.3459 --- loss: 1.371372, loss_ss: 1.131864, loss_d: 0.239508
0.3843 --- loss: 2.147964, loss_ss: 1.002431, loss_d: 1.145533
0.4228 --- loss: 1.750451, loss_ss: 1.250289, loss_d: 0.500162
0.4612 --- loss: 1.514221, loss_ss: 0.988664, loss_d: 0.525557
0.4996 --- loss: 1.601274, loss_ss: 1.064176, loss_d: 0.537098
0.5380 --- loss: 1.118960, loss_ss: 0.977138, loss_d: 0.141822
0.5765 --- loss: 1.592139, loss_ss: 0.877858, loss_d: 0.714281
0.6149 --- loss: 1.875304, loss_ss: 1.454979, loss_d: 0.420326
0.6533 --- loss: 1.343941, loss_ss: 1.143260, loss_d: 0.200681
0.6918 --- loss: 1.359339, loss_ss: 1.124793, loss_d: 0.234545
0.7302 --- loss: 1.685684, loss_ss: 1.134898, loss_d: 0.550786
0.7686 --- loss: 1.408346, loss_ss: 1.025319, loss_d: 0.383027
0.8071 --- loss: 1.448777, loss_ss: 1.086231, loss_d: 0.362546
0.8455 --- loss: 1.675579, loss_ss: 1.138013, loss_d: 0.537566
0.8839 --- loss: 1.169659, loss_ss: 1.070601, loss_d: 0.099059
0.9224 --- loss: 1.320856, loss_ss: 1.019992, loss_d: 0.300864
0.9608 --- loss: 1.408459, loss_ss: 1.045027, loss_d: 0.363432
0.9992 --- loss: 1.860990, loss_ss: 1.122672, loss_d: 0.738317
Epoch finished! Loss: 1.4800609964590805
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.289463, loss_ss: 0.722293, loss_d: 0.567169
0.0384 --- loss: 1.344039, loss_ss: 0.925540, loss_d: 0.418499
0.0769 --- loss: 1.359636, loss_ss: 0.802950, loss_d: 0.556685
0.1153 --- loss: 1.125639, loss_ss: 0.987301, loss_d: 0.138338
0.1537 --- loss: 1.511455, loss_ss: 1.034289, loss_d: 0.477166
0.1922 --- loss: 1.216900, loss_ss: 0.896196, loss_d: 0.320704
0.2306 --- loss: 1.395546, loss_ss: 0.892812, loss_d: 0.502734
0.2690 --- loss: 0.981858, loss_ss: 0.894651, loss_d: 0.087207
0.3075 --- loss: 1.429736, loss_ss: 1.109256, loss_d: 0.320481
0.3459 --- loss: 1.359475, loss_ss: 1.017798, loss_d: 0.341677
0.3843 --- loss: 1.190169, loss_ss: 0.847443, loss_d: 0.342726
0.4228 --- loss: 1.311985, loss_ss: 0.986045, loss_d: 0.325941
0.4612 --- loss: 1.308476, loss_ss: 1.204838, loss_d: 0.103638
0.4996 --- loss: 1.531178, loss_ss: 0.830258, loss_d: 0.700920
0.5380 --- loss: 1.473087, loss_ss: 0.887527, loss_d: 0.585560
0.5765 --- loss: 0.895657, loss_ss: 0.788058, loss_d: 0.107599
0.6149 --- loss: 1.205487, loss_ss: 1.063758, loss_d: 0.141729
0.6533 --- loss: 1.314997, loss_ss: 1.133261, loss_d: 0.181736
0.6918 --- loss: 1.137657, loss_ss: 0.840288, loss_d: 0.297368
0.7302 --- loss: 1.172733, loss_ss: 0.898810, loss_d: 0.273923
0.7686 --- loss: 1.318231, loss_ss: 0.874148, loss_d: 0.444083
0.8071 --- loss: 1.126960, loss_ss: 0.924756, loss_d: 0.202204
0.8455 --- loss: 1.313041, loss_ss: 0.769667, loss_d: 0.543374
0.8839 --- loss: 1.279189, loss_ss: 0.711278, loss_d: 0.567911
0.9224 --- loss: 1.097694, loss_ss: 0.876535, loss_d: 0.221158
0.9608 --- loss: 1.096910, loss_ss: 0.869646, loss_d: 0.227264
0.9992 --- loss: 3.165572, loss_ss: 1.782878, loss_d: 1.382694
Epoch finished! Loss: 1.3053622073852098
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.646338, loss_ss: 0.958522, loss_d: 0.687816
0.0384 --- loss: 0.914940, loss_ss: 0.835333, loss_d: 0.079606
0.0769 --- loss: 1.039528, loss_ss: 0.910788, loss_d: 0.128740
0.1153 --- loss: 1.013280, loss_ss: 0.870459, loss_d: 0.142821
0.1537 --- loss: 1.516284, loss_ss: 1.401219, loss_d: 0.115066
0.1922 --- loss: 1.329636, loss_ss: 1.079123, loss_d: 0.250513
0.2306 --- loss: 1.166794, loss_ss: 1.012244, loss_d: 0.154550
0.2690 --- loss: 1.719556, loss_ss: 1.125473, loss_d: 0.594084
0.3075 --- loss: 0.913411, loss_ss: 0.841203, loss_d: 0.072208
0.3459 --- loss: 0.821743, loss_ss: 0.745874, loss_d: 0.075869
0.3843 --- loss: 0.973889, loss_ss: 0.741144, loss_d: 0.232746
0.4228 --- loss: 1.665663, loss_ss: 0.996144, loss_d: 0.669519
0.4612 --- loss: 1.105424, loss_ss: 0.909963, loss_d: 0.195460
0.4996 --- loss: 1.297994, loss_ss: 0.967881, loss_d: 0.330113
0.5380 --- loss: 1.233546, loss_ss: 1.019045, loss_d: 0.214501
0.5765 --- loss: 0.901520, loss_ss: 0.820388, loss_d: 0.081132
0.6149 --- loss: 1.244823, loss_ss: 0.960666, loss_d: 0.284158
0.6533 --- loss: 1.022729, loss_ss: 0.870438, loss_d: 0.152291
0.6918 --- loss: 1.439535, loss_ss: 1.271443, loss_d: 0.168092
0.7302 --- loss: 1.004289, loss_ss: 0.846107, loss_d: 0.158182
0.7686 --- loss: 1.371561, loss_ss: 0.910361, loss_d: 0.461200
0.8071 --- loss: 1.083423, loss_ss: 0.792674, loss_d: 0.290749
0.8455 --- loss: 1.015344, loss_ss: 0.890074, loss_d: 0.125269
0.8839 --- loss: 1.138615, loss_ss: 1.028584, loss_d: 0.110031
0.9224 --- loss: 0.931012, loss_ss: 0.891124, loss_d: 0.039888
0.9608 --- loss: 1.090809, loss_ss: 0.922594, loss_d: 0.168215
0.9992 --- loss: 2.104785, loss_ss: 2.100930, loss_d: 0.003855
Epoch finished! Loss: 1.2136028952323474
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.953853, loss_ss: 0.893782, loss_d: 0.060071
0.0384 --- loss: 0.887799, loss_ss: 0.726158, loss_d: 0.161641
0.0769 --- loss: 1.183852, loss_ss: 0.829371, loss_d: 0.354481
0.1153 --- loss: 1.420473, loss_ss: 0.808845, loss_d: 0.611628
0.1537 --- loss: 1.347443, loss_ss: 1.252581, loss_d: 0.094863
0.1922 --- loss: 0.943489, loss_ss: 0.888297, loss_d: 0.055191
0.2306 --- loss: 0.795652, loss_ss: 0.650598, loss_d: 0.145055
0.2690 --- loss: 1.043491, loss_ss: 0.775241, loss_d: 0.268250
0.3075 --- loss: 1.059035, loss_ss: 0.948598, loss_d: 0.110437
0.3459 --- loss: 1.326593, loss_ss: 0.785314, loss_d: 0.541280
0.3843 --- loss: 1.437481, loss_ss: 1.087873, loss_d: 0.349608
0.4228 --- loss: 1.042534, loss_ss: 0.868505, loss_d: 0.174029
0.4612 --- loss: 0.770235, loss_ss: 0.596255, loss_d: 0.173980
0.4996 --- loss: 0.973315, loss_ss: 0.860922, loss_d: 0.112393
0.5380 --- loss: 1.085128, loss_ss: 0.843659, loss_d: 0.241469
0.5765 --- loss: 0.841338, loss_ss: 0.694771, loss_d: 0.146567
0.6149 --- loss: 0.900304, loss_ss: 0.867812, loss_d: 0.032493
0.6533 --- loss: 1.096266, loss_ss: 0.824803, loss_d: 0.271463
0.6918 --- loss: 0.979688, loss_ss: 0.899005, loss_d: 0.080684
0.7302 --- loss: 0.840487, loss_ss: 0.811847, loss_d: 0.028639
0.7686 --- loss: 0.946901, loss_ss: 0.886308, loss_d: 0.060593
0.8071 --- loss: 0.807294, loss_ss: 0.724688, loss_d: 0.082605
0.8455 --- loss: 1.029372, loss_ss: 0.851256, loss_d: 0.178117
0.8839 --- loss: 1.033561, loss_ss: 1.006585, loss_d: 0.026976
0.9224 --- loss: 1.564438, loss_ss: 0.729961, loss_d: 0.834476
0.9608 --- loss: 1.151068, loss_ss: 0.849632, loss_d: 0.301436
0.9992 --- loss: 2.638347, loss_ss: 1.874700, loss_d: 0.763646
Epoch finished! Loss: 1.1315752767599545
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.060950, loss_ss: 0.986986, loss_d: 0.073963
0.0384 --- loss: 1.061335, loss_ss: 0.756334, loss_d: 0.305002
0.0769 --- loss: 1.626296, loss_ss: 0.709490, loss_d: 0.916805
0.1153 --- loss: 1.253096, loss_ss: 0.852046, loss_d: 0.401050
0.1537 --- loss: 1.397426, loss_ss: 0.994185, loss_d: 0.403242
0.1922 --- loss: 1.153298, loss_ss: 1.107304, loss_d: 0.045995
0.2306 --- loss: 1.153310, loss_ss: 0.873459, loss_d: 0.279851
0.2690 --- loss: 0.909066, loss_ss: 0.811874, loss_d: 0.097192
0.3075 --- loss: 0.926021, loss_ss: 0.795274, loss_d: 0.130746
0.3459 --- loss: 1.200498, loss_ss: 0.910590, loss_d: 0.289907
0.3843 --- loss: 1.069703, loss_ss: 0.868386, loss_d: 0.201316
0.4228 --- loss: 0.854274, loss_ss: 0.764664, loss_d: 0.089610
0.4612 --- loss: 0.834538, loss_ss: 0.743293, loss_d: 0.091246
0.4996 --- loss: 0.709701, loss_ss: 0.656269, loss_d: 0.053432
0.5380 --- loss: 0.795496, loss_ss: 0.734579, loss_d: 0.060917
0.5765 --- loss: 0.808344, loss_ss: 0.752638, loss_d: 0.055706
0.6149 --- loss: 0.892789, loss_ss: 0.823012, loss_d: 0.069777
0.6533 --- loss: 1.370949, loss_ss: 1.064347, loss_d: 0.306602
0.6918 --- loss: 1.263950, loss_ss: 1.072068, loss_d: 0.191882
0.7302 --- loss: 1.464100, loss_ss: 0.747013, loss_d: 0.717087
0.7686 --- loss: 1.552745, loss_ss: 1.465816, loss_d: 0.086929
0.8071 --- loss: 0.853054, loss_ss: 0.745543, loss_d: 0.107511
0.8455 --- loss: 1.038182, loss_ss: 0.846535, loss_d: 0.191647
0.8839 --- loss: 0.886390, loss_ss: 0.872236, loss_d: 0.014154
0.9224 --- loss: 1.162144, loss_ss: 0.889888, loss_d: 0.272256
0.9608 --- loss: 0.862233, loss_ss: 0.656645, loss_d: 0.205587
0.9992 --- loss: 4.579941, loss_ss: 2.044988, loss_d: 2.534953
Epoch finished! Loss: 1.10348400083872
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.391555, loss_ss: 1.160438, loss_d: 0.231117
0.0384 --- loss: 0.598311, loss_ss: 0.545961, loss_d: 0.052350
0.0769 --- loss: 1.368687, loss_ss: 1.237963, loss_d: 0.130724
0.1153 --- loss: 1.924956, loss_ss: 1.301325, loss_d: 0.623631
0.1537 --- loss: 0.958901, loss_ss: 0.778994, loss_d: 0.179907
0.1922 --- loss: 0.913458, loss_ss: 0.770754, loss_d: 0.142704
0.2306 --- loss: 1.211255, loss_ss: 0.839977, loss_d: 0.371277
0.2690 --- loss: 1.107744, loss_ss: 0.866185, loss_d: 0.241559
0.3075 --- loss: 0.914322, loss_ss: 0.850559, loss_d: 0.063763
0.3459 --- loss: 0.776785, loss_ss: 0.731616, loss_d: 0.045169
0.3843 --- loss: 1.196065, loss_ss: 1.031616, loss_d: 0.164449
0.4228 --- loss: 1.449916, loss_ss: 0.848169, loss_d: 0.601747
0.4612 --- loss: 0.871938, loss_ss: 0.818276, loss_d: 0.053662
0.4996 --- loss: 0.757947, loss_ss: 0.722545, loss_d: 0.035401
0.5380 --- loss: 0.629631, loss_ss: 0.607895, loss_d: 0.021736
0.5765 --- loss: 1.093926, loss_ss: 0.961529, loss_d: 0.132397
0.6149 --- loss: 0.905534, loss_ss: 0.708181, loss_d: 0.197353
0.6533 --- loss: 1.037429, loss_ss: 0.934104, loss_d: 0.103325
0.6918 --- loss: 0.812932, loss_ss: 0.771463, loss_d: 0.041469
0.7302 --- loss: 0.840433, loss_ss: 0.817128, loss_d: 0.023306
0.7686 --- loss: 0.967782, loss_ss: 0.927370, loss_d: 0.040412
0.8071 --- loss: 0.813208, loss_ss: 0.726218, loss_d: 0.086990
0.8455 --- loss: 0.952706, loss_ss: 0.834151, loss_d: 0.118555
0.8839 --- loss: 1.954608, loss_ss: 0.690969, loss_d: 1.263639
0.9224 --- loss: 0.784139, loss_ss: 0.712159, loss_d: 0.071980
0.9608 --- loss: 0.680903, loss_ss: 0.619052, loss_d: 0.061851
0.9992 --- loss: 2.625332, loss_ss: 2.575241, loss_d: 0.050092
Epoch finished! Loss: 1.0578729955049662
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.923850, loss_ss: 0.878843, loss_d: 0.045006
0.0384 --- loss: 0.881252, loss_ss: 0.830031, loss_d: 0.051220
0.0769 --- loss: 0.693235, loss_ss: 0.648590, loss_d: 0.044645
0.1153 --- loss: 1.153444, loss_ss: 0.764547, loss_d: 0.388896
0.1537 --- loss: 0.960047, loss_ss: 0.643467, loss_d: 0.316580
0.1922 --- loss: 0.975906, loss_ss: 0.898182, loss_d: 0.077724
0.2306 --- loss: 1.571388, loss_ss: 1.293477, loss_d: 0.277911
0.2690 --- loss: 0.538422, loss_ss: 0.490870, loss_d: 0.047551
0.3075 --- loss: 0.645949, loss_ss: 0.620685, loss_d: 0.025264
0.3459 --- loss: 0.790691, loss_ss: 0.742815, loss_d: 0.047876
0.3843 --- loss: 2.556313, loss_ss: 0.686043, loss_d: 1.870270
0.4228 --- loss: 1.268800, loss_ss: 0.901423, loss_d: 0.367377
0.4612 --- loss: 0.793534, loss_ss: 0.730602, loss_d: 0.062933
0.4996 --- loss: 1.078930, loss_ss: 0.993556, loss_d: 0.085373
0.5380 --- loss: 0.987630, loss_ss: 0.910097, loss_d: 0.077534
0.5765 --- loss: 0.945425, loss_ss: 0.872605, loss_d: 0.072820
0.6149 --- loss: 1.376009, loss_ss: 0.692353, loss_d: 0.683655
0.6533 --- loss: 1.217375, loss_ss: 0.806128, loss_d: 0.411248
0.6918 --- loss: 0.731713, loss_ss: 0.711096, loss_d: 0.020617
0.7302 --- loss: 0.997923, loss_ss: 0.726694, loss_d: 0.271228
0.7686 --- loss: 1.727254, loss_ss: 1.633235, loss_d: 0.094020
0.8071 --- loss: 0.816965, loss_ss: 0.796738, loss_d: 0.020227
0.8455 --- loss: 0.972176, loss_ss: 0.882500, loss_d: 0.089677
0.8839 --- loss: 0.820340, loss_ss: 0.788557, loss_d: 0.031783
0.9224 --- loss: 1.025569, loss_ss: 0.987552, loss_d: 0.038017
0.9608 --- loss: 1.014570, loss_ss: 0.726473, loss_d: 0.288097
0.9992 --- loss: 1.122495, loss_ss: 1.121751, loss_d: 0.000743
Epoch finished! Loss: 0.9994000732898712
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.866534, loss_ss: 0.821261, loss_d: 0.045273
0.0384 --- loss: 0.945192, loss_ss: 0.908163, loss_d: 0.037029
0.0769 --- loss: 1.234851, loss_ss: 1.175516, loss_d: 0.059335
0.1153 --- loss: 1.004706, loss_ss: 0.991278, loss_d: 0.013428
0.1537 --- loss: 0.709100, loss_ss: 0.701236, loss_d: 0.007864
0.1922 --- loss: 0.765056, loss_ss: 0.723576, loss_d: 0.041481
0.2306 --- loss: 0.922180, loss_ss: 0.870813, loss_d: 0.051367
0.2690 --- loss: 1.184277, loss_ss: 1.092388, loss_d: 0.091889
0.3075 --- loss: 0.779058, loss_ss: 0.712276, loss_d: 0.066783
0.3459 --- loss: 1.120141, loss_ss: 0.775713, loss_d: 0.344428
0.3843 --- loss: 0.922135, loss_ss: 0.892752, loss_d: 0.029383
0.4228 --- loss: 2.033141, loss_ss: 0.757934, loss_d: 1.275207
0.4612 --- loss: 0.812602, loss_ss: 0.766619, loss_d: 0.045983
0.4996 --- loss: 0.974125, loss_ss: 0.746568, loss_d: 0.227557
0.5380 --- loss: 1.191616, loss_ss: 0.559960, loss_d: 0.631656
0.5765 --- loss: 0.739026, loss_ss: 0.709064, loss_d: 0.029961
0.6149 --- loss: 0.653570, loss_ss: 0.603526, loss_d: 0.050045
0.6533 --- loss: 1.440675, loss_ss: 1.179423, loss_d: 0.261252
0.6918 --- loss: 0.955773, loss_ss: 0.791799, loss_d: 0.163974
0.7302 --- loss: 0.856634, loss_ss: 0.785857, loss_d: 0.070777
0.7686 --- loss: 0.714623, loss_ss: 0.650648, loss_d: 0.063975
0.8071 --- loss: 1.625519, loss_ss: 0.914142, loss_d: 0.711377
0.8455 --- loss: 0.972051, loss_ss: 0.838331, loss_d: 0.133720
0.8839 --- loss: 0.763637, loss_ss: 0.720868, loss_d: 0.042769
0.9224 --- loss: 0.808677, loss_ss: 0.693325, loss_d: 0.115352
0.9608 --- loss: 1.299362, loss_ss: 0.654182, loss_d: 0.645180
0.9992 --- loss: 1.454273, loss_ss: 1.276435, loss_d: 0.177838
Epoch finished! Loss: 0.9683423881347363
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.069283, loss_ss: 0.858417, loss_d: 0.210866
0.0384 --- loss: 1.131754, loss_ss: 0.870905, loss_d: 0.260849
0.0769 --- loss: 0.835859, loss_ss: 0.818704, loss_d: 0.017155
0.1153 --- loss: 1.156687, loss_ss: 1.139634, loss_d: 0.017053
0.1537 --- loss: 0.843672, loss_ss: 0.839794, loss_d: 0.003878
0.1922 --- loss: 1.233054, loss_ss: 0.962827, loss_d: 0.270227
0.2306 --- loss: 0.861413, loss_ss: 0.767546, loss_d: 0.093867
0.2690 --- loss: 0.576477, loss_ss: 0.533482, loss_d: 0.042995
0.3075 --- loss: 0.816058, loss_ss: 0.766929, loss_d: 0.049128
0.3459 --- loss: 0.819807, loss_ss: 0.781705, loss_d: 0.038103
0.3843 --- loss: 0.746362, loss_ss: 0.735066, loss_d: 0.011296
0.4228 --- loss: 0.991454, loss_ss: 0.784328, loss_d: 0.207126
0.4612 --- loss: 0.828215, loss_ss: 0.805598, loss_d: 0.022617
0.4996 --- loss: 0.698851, loss_ss: 0.642083, loss_d: 0.056768
0.5380 --- loss: 1.101663, loss_ss: 0.818375, loss_d: 0.283289
0.5765 --- loss: 1.666592, loss_ss: 0.910526, loss_d: 0.756065
0.6149 --- loss: 0.863924, loss_ss: 0.792880, loss_d: 0.071045
0.6533 --- loss: 0.879960, loss_ss: 0.779544, loss_d: 0.100416
0.6918 --- loss: 0.839320, loss_ss: 0.829860, loss_d: 0.009460
0.7302 --- loss: 0.607710, loss_ss: 0.486583, loss_d: 0.121127
0.7686 --- loss: 0.736566, loss_ss: 0.686121, loss_d: 0.050444
0.8071 --- loss: 0.923141, loss_ss: 0.851328, loss_d: 0.071813
0.8455 --- loss: 0.917240, loss_ss: 0.881190, loss_d: 0.036050
0.8839 --- loss: 1.235869, loss_ss: 1.025517, loss_d: 0.210351
0.9224 --- loss: 0.994313, loss_ss: 0.770708, loss_d: 0.223605
0.9608 --- loss: 1.005160, loss_ss: 0.679158, loss_d: 0.326002
0.9992 --- loss: 2.526231, loss_ss: 2.521807, loss_d: 0.004424
Epoch finished! Loss: 0.9538505600048945
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.524074074074074
             precision    recall  f1-score   support

        0.0       0.24      0.60      0.34       108
        1.0       0.52      0.73      0.60       387
        2.0       0.78      0.29      0.42       360
        3.0       0.98      0.88      0.93        95
        4.0       0.71      0.25      0.37       130

avg / total       0.64      0.52      0.52      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  76.67  60.19   78.50  23.72     34.03
1  66.02  72.61   62.34  51.85     60.50
2  73.61  28.89   95.97  78.20     42.19
3  98.80  88.42   99.80  97.67     92.82
4  89.72  24.62   98.63  71.11     36.57
Total accuracy: 52.41%
Average sen: 54.94%
Average spec: 87.05%
Macro f1-score: 53.22%
Diagnosis acc on 15mins: 1.0
[0.96791804 0.9991591  0.99978572 0.99968147 0.99787915 0.99998951
 0.99990523 0.99974221 0.9999752  0.99989569 0.99993622 0.99999428
 0.9999944  0.99591064 0.99800187 0.99929523 0.99999607 0.99998379
 0.99999726 0.99996698 0.99994063 0.99997926 0.99999249 0.99998677
 0.99989343 0.99997759 0.99945122 0.99993742 0.99947625 0.99992275
 0.99988663 0.99999845 0.99771106 0.99991775 0.99955362 0.99864858]
pred: 0.9986467212438583, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.386881, loss_ss: 1.691014, loss_d: 0.695867
0.0384 --- loss: 2.118644, loss_ss: 1.574175, loss_d: 0.544468
0.0769 --- loss: 2.493178, loss_ss: 1.595943, loss_d: 0.897235
0.1153 --- loss: 2.318055, loss_ss: 1.568424, loss_d: 0.749631
0.1537 --- loss: 2.049714, loss_ss: 1.538454, loss_d: 0.511260
0.1922 --- loss: 2.099174, loss_ss: 1.405813, loss_d: 0.693361
0.2306 --- loss: 1.931555, loss_ss: 1.374541, loss_d: 0.557013
0.2690 --- loss: 2.403730, loss_ss: 1.469411, loss_d: 0.934319
0.3075 --- loss: 1.828575, loss_ss: 1.459864, loss_d: 0.368711
0.3459 --- loss: 1.890678, loss_ss: 1.322199, loss_d: 0.568479
0.3843 --- loss: 2.189257, loss_ss: 1.379013, loss_d: 0.810244
0.4228 --- loss: 1.889050, loss_ss: 1.361820, loss_d: 0.527230
0.4612 --- loss: 1.989962, loss_ss: 1.435907, loss_d: 0.554056
0.4996 --- loss: 1.933467, loss_ss: 1.385995, loss_d: 0.547472
0.5380 --- loss: 1.708986, loss_ss: 1.350873, loss_d: 0.358114
0.5765 --- loss: 1.726172, loss_ss: 1.321587, loss_d: 0.404586
0.6149 --- loss: 2.233494, loss_ss: 1.401667, loss_d: 0.831827
0.6533 --- loss: 1.630633, loss_ss: 1.226218, loss_d: 0.404415
0.6918 --- loss: 1.516664, loss_ss: 1.340115, loss_d: 0.176548
0.7302 --- loss: 1.857555, loss_ss: 1.256476, loss_d: 0.601079
0.7686 --- loss: 1.948013, loss_ss: 1.378567, loss_d: 0.569446
0.8071 --- loss: 1.637158, loss_ss: 1.266729, loss_d: 0.370429
0.8455 --- loss: 1.863772, loss_ss: 1.318200, loss_d: 0.545572
0.8839 --- loss: 1.309356, loss_ss: 1.094262, loss_d: 0.215094
0.9224 --- loss: 2.040960, loss_ss: 1.441040, loss_d: 0.599920
0.9608 --- loss: 1.733295, loss_ss: 1.191754, loss_d: 0.541540
0.9992 --- loss: 2.812512, loss_ss: 1.508616, loss_d: 1.303896
Epoch finished! Loss: 1.9287942588329314
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.442994, loss_ss: 1.164723, loss_d: 0.278271
0.0384 --- loss: 1.423704, loss_ss: 1.232758, loss_d: 0.190946
0.0769 --- loss: 1.306692, loss_ss: 1.133574, loss_d: 0.173119
0.1153 --- loss: 1.591091, loss_ss: 1.111872, loss_d: 0.479220
0.1537 --- loss: 2.136397, loss_ss: 1.235848, loss_d: 0.900548
0.1922 --- loss: 1.491462, loss_ss: 1.203110, loss_d: 0.288352
0.2306 --- loss: 1.868357, loss_ss: 1.236078, loss_d: 0.632279
0.2690 --- loss: 1.264462, loss_ss: 0.970609, loss_d: 0.293853
0.3075 --- loss: 1.715790, loss_ss: 1.432390, loss_d: 0.283400
0.3459 --- loss: 1.207765, loss_ss: 1.034488, loss_d: 0.173277
0.3843 --- loss: 1.385220, loss_ss: 1.053283, loss_d: 0.331937
0.4228 --- loss: 1.609848, loss_ss: 1.040944, loss_d: 0.568904
0.4612 --- loss: 1.575434, loss_ss: 1.149828, loss_d: 0.425606
0.4996 --- loss: 1.119543, loss_ss: 0.999255, loss_d: 0.120288
0.5380 --- loss: 1.529051, loss_ss: 1.419625, loss_d: 0.109427
0.5765 --- loss: 1.579645, loss_ss: 1.263636, loss_d: 0.316009
0.6149 --- loss: 1.162340, loss_ss: 0.937654, loss_d: 0.224686
0.6533 --- loss: 1.652087, loss_ss: 1.218633, loss_d: 0.433454
0.6918 --- loss: 1.452134, loss_ss: 0.907314, loss_d: 0.544819
0.7302 --- loss: 1.884069, loss_ss: 1.022472, loss_d: 0.861597
0.7686 --- loss: 1.540213, loss_ss: 1.156905, loss_d: 0.383308
0.8071 --- loss: 1.570177, loss_ss: 1.025887, loss_d: 0.544290
0.8455 --- loss: 1.394453, loss_ss: 0.988404, loss_d: 0.406049
0.8839 --- loss: 1.147218, loss_ss: 0.965317, loss_d: 0.181901
0.9224 --- loss: 0.946359, loss_ss: 0.822096, loss_d: 0.124263
0.9608 --- loss: 1.400674, loss_ss: 0.951551, loss_d: 0.449122
0.9992 --- loss: 1.906877, loss_ss: 1.820571, loss_d: 0.086306
Epoch finished! Loss: 1.4947070688009263
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.427724, loss_ss: 0.988370, loss_d: 0.439354
0.0384 --- loss: 1.094820, loss_ss: 0.827149, loss_d: 0.267672
0.0769 --- loss: 1.245447, loss_ss: 0.930440, loss_d: 0.315008
0.1153 --- loss: 0.992324, loss_ss: 0.859092, loss_d: 0.133232
0.1537 --- loss: 1.203930, loss_ss: 1.019216, loss_d: 0.184714
0.1922 --- loss: 1.035928, loss_ss: 0.823983, loss_d: 0.211945
0.2306 --- loss: 1.640408, loss_ss: 1.477482, loss_d: 0.162926
0.2690 --- loss: 1.445475, loss_ss: 0.993421, loss_d: 0.452054
0.3075 --- loss: 1.063885, loss_ss: 0.906293, loss_d: 0.157592
0.3459 --- loss: 1.111833, loss_ss: 1.042563, loss_d: 0.069269
0.3843 --- loss: 1.342966, loss_ss: 0.910703, loss_d: 0.432263
0.4228 --- loss: 1.130558, loss_ss: 0.952798, loss_d: 0.177760
0.4612 --- loss: 1.535638, loss_ss: 1.206356, loss_d: 0.329282
0.4996 --- loss: 1.650720, loss_ss: 1.076949, loss_d: 0.573772
0.5380 --- loss: 1.266265, loss_ss: 0.986264, loss_d: 0.280001
0.5765 --- loss: 1.125531, loss_ss: 0.942513, loss_d: 0.183018
0.6149 --- loss: 1.363450, loss_ss: 0.843686, loss_d: 0.519764
0.6533 --- loss: 1.076747, loss_ss: 0.790828, loss_d: 0.285918
0.6918 --- loss: 1.499574, loss_ss: 1.192490, loss_d: 0.307084
0.7302 --- loss: 1.165931, loss_ss: 0.958270, loss_d: 0.207662
0.7686 --- loss: 1.147794, loss_ss: 0.930975, loss_d: 0.216819
0.8071 --- loss: 1.400038, loss_ss: 0.946142, loss_d: 0.453896
0.8455 --- loss: 1.215356, loss_ss: 1.105495, loss_d: 0.109861
0.8839 --- loss: 1.567030, loss_ss: 1.394661, loss_d: 0.172369
0.9224 --- loss: 1.099144, loss_ss: 0.902043, loss_d: 0.197101
0.9608 --- loss: 1.242041, loss_ss: 0.870679, loss_d: 0.371362
0.9992 --- loss: 2.246854, loss_ss: 2.226656, loss_d: 0.020198
Epoch finished! Loss: 1.2884914464675463
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.267431, loss_ss: 0.794257, loss_d: 0.473174
0.0384 --- loss: 0.895287, loss_ss: 0.752736, loss_d: 0.142550
0.0769 --- loss: 1.361184, loss_ss: 1.066201, loss_d: 0.294983
0.1153 --- loss: 1.123260, loss_ss: 0.790548, loss_d: 0.332711
0.1537 --- loss: 1.245659, loss_ss: 0.881969, loss_d: 0.363690
0.1922 --- loss: 1.212433, loss_ss: 1.097828, loss_d: 0.114605
0.2306 --- loss: 1.241956, loss_ss: 0.819454, loss_d: 0.422501
0.2690 --- loss: 1.243257, loss_ss: 1.040533, loss_d: 0.202724
0.3075 --- loss: 0.910120, loss_ss: 0.759304, loss_d: 0.150816
0.3459 --- loss: 1.531391, loss_ss: 1.048350, loss_d: 0.483042
0.3843 --- loss: 0.934033, loss_ss: 0.891739, loss_d: 0.042294
0.4228 --- loss: 1.532813, loss_ss: 1.040550, loss_d: 0.492263
0.4612 --- loss: 1.164586, loss_ss: 0.927477, loss_d: 0.237109
0.4996 --- loss: 0.972411, loss_ss: 0.859529, loss_d: 0.112882
0.5380 --- loss: 1.327867, loss_ss: 1.149034, loss_d: 0.178833
0.5765 --- loss: 1.224660, loss_ss: 0.830815, loss_d: 0.393845
0.6149 --- loss: 1.048907, loss_ss: 0.809401, loss_d: 0.239506
0.6533 --- loss: 0.948232, loss_ss: 0.676914, loss_d: 0.271317
0.6918 --- loss: 1.258327, loss_ss: 0.837514, loss_d: 0.420812
0.7302 --- loss: 0.878645, loss_ss: 0.784467, loss_d: 0.094178
0.7686 --- loss: 1.122574, loss_ss: 1.001025, loss_d: 0.121549
0.8071 --- loss: 1.360007, loss_ss: 1.289131, loss_d: 0.070876
0.8455 --- loss: 0.999534, loss_ss: 0.759382, loss_d: 0.240152
0.8839 --- loss: 1.051722, loss_ss: 0.777885, loss_d: 0.273837
0.9224 --- loss: 1.215399, loss_ss: 0.838907, loss_d: 0.376493
0.9608 --- loss: 1.198704, loss_ss: 0.914854, loss_d: 0.283850
0.9992 --- loss: 5.535698, loss_ss: 1.673713, loss_d: 3.861985
Epoch finished! Loss: 1.2212901706878956
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.041846, loss_ss: 0.897203, loss_d: 0.144643
0.0384 --- loss: 1.235558, loss_ss: 0.846424, loss_d: 0.389133
0.0769 --- loss: 0.996042, loss_ss: 0.803652, loss_d: 0.192390
0.1153 --- loss: 1.299693, loss_ss: 0.864738, loss_d: 0.434955
0.1537 --- loss: 1.143244, loss_ss: 0.939243, loss_d: 0.204001
0.1922 --- loss: 0.826384, loss_ss: 0.737036, loss_d: 0.089348
0.2306 --- loss: 0.977474, loss_ss: 0.950701, loss_d: 0.026772
0.2690 --- loss: 1.070969, loss_ss: 0.688859, loss_d: 0.382110
0.3075 --- loss: 1.340894, loss_ss: 0.751475, loss_d: 0.589419
0.3459 --- loss: 1.374138, loss_ss: 0.726556, loss_d: 0.647582
0.3843 --- loss: 0.836747, loss_ss: 0.782657, loss_d: 0.054090
0.4228 --- loss: 1.226040, loss_ss: 0.878772, loss_d: 0.347268
0.4612 --- loss: 1.117078, loss_ss: 0.924554, loss_d: 0.192525
0.4996 --- loss: 1.094202, loss_ss: 0.779208, loss_d: 0.314994
0.5380 --- loss: 0.975824, loss_ss: 0.845909, loss_d: 0.129914
0.5765 --- loss: 1.472651, loss_ss: 1.225878, loss_d: 0.246773
0.6149 --- loss: 1.510518, loss_ss: 1.399661, loss_d: 0.110857
0.6533 --- loss: 1.441648, loss_ss: 0.982400, loss_d: 0.459248
0.6918 --- loss: 0.963305, loss_ss: 0.854005, loss_d: 0.109300
0.7302 --- loss: 1.650587, loss_ss: 1.057762, loss_d: 0.592825
0.7686 --- loss: 1.079145, loss_ss: 0.947735, loss_d: 0.131410
0.8071 --- loss: 0.969495, loss_ss: 0.853602, loss_d: 0.115893
0.8455 --- loss: 1.226695, loss_ss: 0.689351, loss_d: 0.537345
0.8839 --- loss: 0.971796, loss_ss: 0.827910, loss_d: 0.143886
0.9224 --- loss: 1.118534, loss_ss: 1.045257, loss_d: 0.073277
0.9608 --- loss: 0.883492, loss_ss: 0.823245, loss_d: 0.060247
0.9992 --- loss: 6.715695, loss_ss: 2.645131, loss_d: 4.070564
Epoch finished! Loss: 1.1721764475107193
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.534150, loss_ss: 1.314769, loss_d: 0.219381
0.0384 --- loss: 0.855179, loss_ss: 0.729012, loss_d: 0.126166
0.0769 --- loss: 0.989272, loss_ss: 0.761978, loss_d: 0.227295
0.1153 --- loss: 0.760429, loss_ss: 0.694084, loss_d: 0.066345
0.1537 --- loss: 1.402436, loss_ss: 1.035882, loss_d: 0.366553
0.1922 --- loss: 1.010006, loss_ss: 0.894793, loss_d: 0.115214
0.2306 --- loss: 0.915920, loss_ss: 0.857486, loss_d: 0.058434
0.2690 --- loss: 1.018032, loss_ss: 1.000897, loss_d: 0.017135
0.3075 --- loss: 1.253809, loss_ss: 1.042848, loss_d: 0.210961
0.3459 --- loss: 1.022544, loss_ss: 0.995962, loss_d: 0.026582
0.3843 --- loss: 0.946661, loss_ss: 0.887312, loss_d: 0.059349
0.4228 --- loss: 1.121749, loss_ss: 1.045869, loss_d: 0.075880
0.4612 --- loss: 0.888591, loss_ss: 0.780087, loss_d: 0.108504
0.4996 --- loss: 1.239416, loss_ss: 1.081783, loss_d: 0.157633
0.5380 --- loss: 1.331940, loss_ss: 1.021071, loss_d: 0.310869
0.5765 --- loss: 1.077889, loss_ss: 0.995150, loss_d: 0.082739
0.6149 --- loss: 1.325482, loss_ss: 1.195310, loss_d: 0.130172
0.6533 --- loss: 1.651229, loss_ss: 0.765010, loss_d: 0.886219
0.6918 --- loss: 1.438265, loss_ss: 0.907408, loss_d: 0.530858
0.7302 --- loss: 1.155174, loss_ss: 0.829855, loss_d: 0.325320
0.7686 --- loss: 1.009949, loss_ss: 0.952937, loss_d: 0.057011
0.8071 --- loss: 1.076613, loss_ss: 0.873827, loss_d: 0.202785
0.8455 --- loss: 1.292220, loss_ss: 0.806807, loss_d: 0.485413
0.8839 --- loss: 1.081419, loss_ss: 1.065446, loss_d: 0.015972
0.9224 --- loss: 1.087679, loss_ss: 0.589419, loss_d: 0.498260
0.9608 --- loss: 1.867312, loss_ss: 1.455482, loss_d: 0.411830
0.9992 --- loss: 1.663427, loss_ss: 1.660059, loss_d: 0.003369
Epoch finished! Loss: 1.080195853114128
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.858864, loss_ss: 0.698673, loss_d: 0.160191
0.0384 --- loss: 1.121154, loss_ss: 0.819939, loss_d: 0.301215
0.0769 --- loss: 1.242007, loss_ss: 0.839454, loss_d: 0.402553
0.1153 --- loss: 1.175594, loss_ss: 0.778342, loss_d: 0.397251
0.1537 --- loss: 0.927174, loss_ss: 0.898041, loss_d: 0.029133
0.1922 --- loss: 1.337935, loss_ss: 1.014851, loss_d: 0.323084
0.2306 --- loss: 0.967001, loss_ss: 0.788562, loss_d: 0.178439
0.2690 --- loss: 0.962257, loss_ss: 0.846221, loss_d: 0.116036
0.3075 --- loss: 0.889376, loss_ss: 0.659902, loss_d: 0.229473
0.3459 --- loss: 1.050329, loss_ss: 0.961364, loss_d: 0.088965
0.3843 --- loss: 0.883541, loss_ss: 0.758337, loss_d: 0.125204
0.4228 --- loss: 1.083333, loss_ss: 1.050567, loss_d: 0.032767
0.4612 --- loss: 0.556437, loss_ss: 0.520254, loss_d: 0.036183
0.4996 --- loss: 1.000405, loss_ss: 0.912265, loss_d: 0.088139
0.5380 --- loss: 0.933676, loss_ss: 0.887429, loss_d: 0.046247
0.5765 --- loss: 1.296874, loss_ss: 1.056267, loss_d: 0.240607
0.6149 --- loss: 0.846065, loss_ss: 0.791522, loss_d: 0.054543
0.6533 --- loss: 0.715648, loss_ss: 0.665266, loss_d: 0.050383
0.6918 --- loss: 1.011554, loss_ss: 0.993241, loss_d: 0.018313
0.7302 --- loss: 0.929198, loss_ss: 0.880318, loss_d: 0.048881
0.7686 --- loss: 0.939853, loss_ss: 0.875261, loss_d: 0.064592
0.8071 --- loss: 1.110528, loss_ss: 1.104057, loss_d: 0.006471
0.8455 --- loss: 0.815568, loss_ss: 0.810302, loss_d: 0.005266
0.8839 --- loss: 1.377071, loss_ss: 1.043054, loss_d: 0.334017
0.9224 --- loss: 0.760673, loss_ss: 0.650365, loss_d: 0.110308
0.9608 --- loss: 0.750293, loss_ss: 0.708306, loss_d: 0.041987
0.9992 --- loss: 1.787149, loss_ss: 1.785545, loss_d: 0.001604
Epoch finished! Loss: 1.0229287404280443
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.984324, loss_ss: 0.799438, loss_d: 0.184886
0.0384 --- loss: 0.829661, loss_ss: 0.698687, loss_d: 0.130974
0.0769 --- loss: 1.027636, loss_ss: 0.647283, loss_d: 0.380353
0.1153 --- loss: 1.081323, loss_ss: 1.064125, loss_d: 0.017197
0.1537 --- loss: 1.022995, loss_ss: 0.874503, loss_d: 0.148492
0.1922 --- loss: 1.003755, loss_ss: 0.952685, loss_d: 0.051070
0.2306 --- loss: 1.120072, loss_ss: 0.993815, loss_d: 0.126257
0.2690 --- loss: 0.985758, loss_ss: 0.960442, loss_d: 0.025316
0.3075 --- loss: 0.968000, loss_ss: 0.900485, loss_d: 0.067515
0.3459 --- loss: 1.207982, loss_ss: 0.976112, loss_d: 0.231870
0.3843 --- loss: 1.458169, loss_ss: 0.780165, loss_d: 0.678004
0.4228 --- loss: 0.996189, loss_ss: 0.911595, loss_d: 0.084594
0.4612 --- loss: 0.905865, loss_ss: 0.882444, loss_d: 0.023421
0.4996 --- loss: 0.933386, loss_ss: 0.920076, loss_d: 0.013310
0.5380 --- loss: 0.939687, loss_ss: 0.830425, loss_d: 0.109262
0.5765 --- loss: 1.632145, loss_ss: 0.868998, loss_d: 0.763147
0.6149 --- loss: 1.086978, loss_ss: 0.963357, loss_d: 0.123622
0.6533 --- loss: 1.334372, loss_ss: 0.871504, loss_d: 0.462868
0.6918 --- loss: 0.905699, loss_ss: 0.778398, loss_d: 0.127301
0.7302 --- loss: 0.969502, loss_ss: 0.792689, loss_d: 0.176813
0.7686 --- loss: 0.975983, loss_ss: 0.907736, loss_d: 0.068247
0.8071 --- loss: 0.938876, loss_ss: 0.931471, loss_d: 0.007405
0.8455 --- loss: 0.935696, loss_ss: 0.741874, loss_d: 0.193822
0.8839 --- loss: 0.821141, loss_ss: 0.705845, loss_d: 0.115296
0.9224 --- loss: 0.851596, loss_ss: 0.783961, loss_d: 0.067635
0.9608 --- loss: 0.980765, loss_ss: 0.923733, loss_d: 0.057031
0.9992 --- loss: 1.851980, loss_ss: 1.849832, loss_d: 0.002148
Epoch finished! Loss: 0.9928145154164387
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.989207, loss_ss: 0.954065, loss_d: 0.035142
0.0384 --- loss: 1.072376, loss_ss: 0.995184, loss_d: 0.077192
0.0769 --- loss: 0.639371, loss_ss: 0.544844, loss_d: 0.094527
0.1153 --- loss: 1.003410, loss_ss: 0.970727, loss_d: 0.032683
0.1537 --- loss: 1.046309, loss_ss: 1.023949, loss_d: 0.022360
0.1922 --- loss: 0.847454, loss_ss: 0.787676, loss_d: 0.059778
0.2306 --- loss: 0.911348, loss_ss: 0.857063, loss_d: 0.054285
0.2690 --- loss: 0.798369, loss_ss: 0.787780, loss_d: 0.010588
0.3075 --- loss: 0.783565, loss_ss: 0.622890, loss_d: 0.160675
0.3459 --- loss: 0.978026, loss_ss: 0.940720, loss_d: 0.037306
0.3843 --- loss: 0.822976, loss_ss: 0.790622, loss_d: 0.032354
0.4228 --- loss: 0.816600, loss_ss: 0.646342, loss_d: 0.170258
0.4612 --- loss: 0.751316, loss_ss: 0.693334, loss_d: 0.057982
0.4996 --- loss: 1.204747, loss_ss: 1.173515, loss_d: 0.031232
0.5380 --- loss: 0.609536, loss_ss: 0.595677, loss_d: 0.013859
0.5765 --- loss: 0.910847, loss_ss: 0.872816, loss_d: 0.038031
0.6149 --- loss: 1.366312, loss_ss: 1.052491, loss_d: 0.313821
0.6533 --- loss: 1.051468, loss_ss: 1.031677, loss_d: 0.019791
0.6918 --- loss: 0.885493, loss_ss: 0.840606, loss_d: 0.044887
0.7302 --- loss: 0.637780, loss_ss: 0.590277, loss_d: 0.047503
0.7686 --- loss: 1.174259, loss_ss: 0.751473, loss_d: 0.422787
0.8071 --- loss: 1.082697, loss_ss: 1.064963, loss_d: 0.017733
0.8455 --- loss: 0.770747, loss_ss: 0.583813, loss_d: 0.186933
0.8839 --- loss: 0.814837, loss_ss: 0.801815, loss_d: 0.013022
0.9224 --- loss: 0.823019, loss_ss: 0.796608, loss_d: 0.026412
0.9608 --- loss: 1.101219, loss_ss: 0.662703, loss_d: 0.438516
0.9992 --- loss: 3.494725, loss_ss: 1.845783, loss_d: 1.648942
Epoch finished! Loss: 0.9722525883179445
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.787594, loss_ss: 0.591458, loss_d: 0.196135
0.0384 --- loss: 1.154429, loss_ss: 0.859019, loss_d: 0.295410
0.0769 --- loss: 0.989358, loss_ss: 0.928115, loss_d: 0.061242
0.1153 --- loss: 1.018305, loss_ss: 0.991501, loss_d: 0.026804
0.1537 --- loss: 0.749472, loss_ss: 0.586556, loss_d: 0.162916
0.1922 --- loss: 1.227396, loss_ss: 1.058918, loss_d: 0.168477
0.2306 --- loss: 1.037635, loss_ss: 0.715136, loss_d: 0.322499
0.2690 --- loss: 1.184287, loss_ss: 1.162275, loss_d: 0.022012
0.3075 --- loss: 0.644726, loss_ss: 0.593210, loss_d: 0.051516
0.3459 --- loss: 0.816970, loss_ss: 0.789415, loss_d: 0.027555
0.3843 --- loss: 1.019632, loss_ss: 0.942267, loss_d: 0.077365
0.4228 --- loss: 0.795411, loss_ss: 0.777885, loss_d: 0.017526
0.4612 --- loss: 1.003425, loss_ss: 0.992522, loss_d: 0.010902
0.4996 --- loss: 1.036847, loss_ss: 1.019048, loss_d: 0.017799
0.5380 --- loss: 1.130280, loss_ss: 1.119789, loss_d: 0.010491
0.5765 --- loss: 1.122391, loss_ss: 0.712361, loss_d: 0.410030
0.6149 --- loss: 0.756498, loss_ss: 0.738074, loss_d: 0.018424
0.6533 --- loss: 0.801456, loss_ss: 0.788049, loss_d: 0.013407
0.6918 --- loss: 0.959573, loss_ss: 0.924426, loss_d: 0.035147
0.7302 --- loss: 1.053715, loss_ss: 0.865792, loss_d: 0.187924
0.7686 --- loss: 0.939832, loss_ss: 0.813232, loss_d: 0.126600
0.8071 --- loss: 1.138062, loss_ss: 0.782454, loss_d: 0.355607
0.8455 --- loss: 0.869573, loss_ss: 0.714064, loss_d: 0.155509
0.8839 --- loss: 0.850955, loss_ss: 0.828884, loss_d: 0.022070
0.9224 --- loss: 1.119695, loss_ss: 0.818254, loss_d: 0.301441
0.9608 --- loss: 0.895133, loss_ss: 0.815146, loss_d: 0.079987
0.9992 --- loss: 1.015524, loss_ss: 1.014705, loss_d: 0.000819
Epoch finished! Loss: 0.94054258282368
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6675925925925926
             precision    recall  f1-score   support

        0.0       0.33      0.90      0.48        30
        1.0       0.31      0.35      0.33       136
        2.0       0.71      0.62      0.66       404
        3.0       0.91      0.77      0.83       239
        4.0       0.74      0.79      0.76       271

avg / total       0.70      0.67      0.68      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.54  90.00   94.67  32.53     47.79
1  82.04  35.29   88.77  31.17     33.10
2  76.11  61.63   84.76  70.74     65.87
3  93.15  76.57   97.86  91.04     83.18
4  87.69  78.97   90.61  73.79     76.29
Total accuracy: 66.76%
Average sen: 68.49%
Average spec: 91.33%
Macro f1-score: 61.25%
Diagnosis acc on 15mins: 0.9722222222222222
[0.87636274 0.82445282 0.96524984 0.94020885 0.94599211 0.45084739
 0.52291262 0.79188579 0.96984988 0.72263294 0.93081468 0.98198986
 0.97674483 0.86601651 0.99885786 0.99590427 0.99954885 0.96588159
 0.99186462 0.99488801 0.92457521 0.9997403  0.70997542 0.96946782
 0.9996112  0.97514749 0.85114002 0.98195523 0.94150627 0.96521807
 0.94876581 0.97804344 0.93180698 0.98309177 0.98669851 0.87349379]
pred: 0.9092539830340279, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.345585, loss_ss: 1.683449, loss_d: 0.662136
0.0384 --- loss: 2.320452, loss_ss: 1.475359, loss_d: 0.845094
0.0768 --- loss: 2.058547, loss_ss: 1.493078, loss_d: 0.565469
0.1152 --- loss: 2.195414, loss_ss: 1.498500, loss_d: 0.696914
0.1536 --- loss: 1.879991, loss_ss: 1.382351, loss_d: 0.497640
0.1919 --- loss: 2.095187, loss_ss: 1.429195, loss_d: 0.665992
0.2303 --- loss: 1.960466, loss_ss: 1.428168, loss_d: 0.532298
0.2687 --- loss: 1.937881, loss_ss: 1.284048, loss_d: 0.653833
0.3071 --- loss: 1.875428, loss_ss: 1.337710, loss_d: 0.537718
0.3455 --- loss: 1.931124, loss_ss: 1.228469, loss_d: 0.702656
0.3839 --- loss: 1.918073, loss_ss: 1.206795, loss_d: 0.711278
0.4223 --- loss: 1.424010, loss_ss: 1.197248, loss_d: 0.226762
0.4607 --- loss: 1.906193, loss_ss: 1.325171, loss_d: 0.581022
0.4990 --- loss: 1.867665, loss_ss: 1.322492, loss_d: 0.545173
0.5374 --- loss: 1.768538, loss_ss: 1.174511, loss_d: 0.594027
0.5758 --- loss: 1.651762, loss_ss: 1.189417, loss_d: 0.462344
0.6142 --- loss: 2.435126, loss_ss: 1.263529, loss_d: 1.171597
0.6526 --- loss: 1.793694, loss_ss: 1.187298, loss_d: 0.606395
0.6910 --- loss: 1.686379, loss_ss: 1.134017, loss_d: 0.552362
0.7294 --- loss: 1.471349, loss_ss: 1.135031, loss_d: 0.336318
0.7678 --- loss: 1.607951, loss_ss: 1.035792, loss_d: 0.572159
0.8061 --- loss: 1.714246, loss_ss: 1.108958, loss_d: 0.605288
0.8445 --- loss: 1.651936, loss_ss: 1.261988, loss_d: 0.389948
0.8829 --- loss: 1.640763, loss_ss: 1.189990, loss_d: 0.450773
0.9213 --- loss: 1.724391, loss_ss: 1.254658, loss_d: 0.469734
0.9597 --- loss: 1.431870, loss_ss: 1.074069, loss_d: 0.357801
0.9981 --- loss: 1.367634, loss_ss: 1.253738, loss_d: 0.113896
Epoch finished! Loss: 1.8561104173843677
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.501121, loss_ss: 1.252296, loss_d: 0.248825
0.0384 --- loss: 1.507990, loss_ss: 1.194587, loss_d: 0.313403
0.0768 --- loss: 1.278661, loss_ss: 1.051653, loss_d: 0.227008
0.1152 --- loss: 1.346223, loss_ss: 1.146479, loss_d: 0.199744
0.1536 --- loss: 1.640611, loss_ss: 0.965364, loss_d: 0.675247
0.1919 --- loss: 1.567153, loss_ss: 0.989360, loss_d: 0.577793
0.2303 --- loss: 1.417752, loss_ss: 1.031272, loss_d: 0.386480
0.2687 --- loss: 1.398087, loss_ss: 1.053517, loss_d: 0.344570
0.3071 --- loss: 1.669384, loss_ss: 1.013476, loss_d: 0.655908
0.3455 --- loss: 1.352113, loss_ss: 1.128145, loss_d: 0.223968
0.3839 --- loss: 1.290160, loss_ss: 1.093102, loss_d: 0.197058
0.4223 --- loss: 1.404921, loss_ss: 1.159016, loss_d: 0.245905
0.4607 --- loss: 1.501998, loss_ss: 1.035839, loss_d: 0.466158
0.4990 --- loss: 1.424924, loss_ss: 0.968041, loss_d: 0.456884
0.5374 --- loss: 1.418319, loss_ss: 1.233030, loss_d: 0.185289
0.5758 --- loss: 1.676240, loss_ss: 1.286924, loss_d: 0.389316
0.6142 --- loss: 1.453082, loss_ss: 1.153896, loss_d: 0.299186
0.6526 --- loss: 1.631617, loss_ss: 0.891129, loss_d: 0.740488
0.6910 --- loss: 1.492195, loss_ss: 1.118308, loss_d: 0.373888
0.7294 --- loss: 1.432160, loss_ss: 0.898796, loss_d: 0.533363
0.7678 --- loss: 1.789047, loss_ss: 1.460405, loss_d: 0.328643
0.8061 --- loss: 1.300966, loss_ss: 1.151633, loss_d: 0.149332
0.8445 --- loss: 1.383502, loss_ss: 1.265284, loss_d: 0.118218
0.8829 --- loss: 2.036764, loss_ss: 1.555372, loss_d: 0.481392
0.9213 --- loss: 1.380124, loss_ss: 1.164057, loss_d: 0.216066
0.9597 --- loss: 1.285539, loss_ss: 0.932096, loss_d: 0.353443
0.9981 --- loss: 4.571638, loss_ss: 1.284427, loss_d: 3.287212
Epoch finished! Loss: 1.4700953584450942
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.374530, loss_ss: 1.155566, loss_d: 0.218964
0.0384 --- loss: 1.548769, loss_ss: 1.125732, loss_d: 0.423037
0.0768 --- loss: 1.165550, loss_ss: 0.936857, loss_d: 0.228693
0.1152 --- loss: 1.292423, loss_ss: 1.122186, loss_d: 0.170237
0.1536 --- loss: 1.406552, loss_ss: 0.808787, loss_d: 0.597765
0.1919 --- loss: 1.061803, loss_ss: 0.842087, loss_d: 0.219715
0.2303 --- loss: 1.705436, loss_ss: 1.034100, loss_d: 0.671337
0.2687 --- loss: 1.398211, loss_ss: 1.030526, loss_d: 0.367685
0.3071 --- loss: 1.140019, loss_ss: 0.978823, loss_d: 0.161196
0.3455 --- loss: 1.991925, loss_ss: 1.064381, loss_d: 0.927543
0.3839 --- loss: 1.154638, loss_ss: 0.809094, loss_d: 0.345544
0.4223 --- loss: 1.404791, loss_ss: 0.867824, loss_d: 0.536967
0.4607 --- loss: 0.976893, loss_ss: 0.878209, loss_d: 0.098685
0.4990 --- loss: 1.122638, loss_ss: 0.917623, loss_d: 0.205015
0.5374 --- loss: 1.534478, loss_ss: 1.052355, loss_d: 0.482124
0.5758 --- loss: 1.601989, loss_ss: 1.134710, loss_d: 0.467278
0.6142 --- loss: 1.329072, loss_ss: 1.146646, loss_d: 0.182426
0.6526 --- loss: 1.077069, loss_ss: 0.972120, loss_d: 0.104949
0.6910 --- loss: 1.179230, loss_ss: 1.031074, loss_d: 0.148156
0.7294 --- loss: 1.213679, loss_ss: 0.883611, loss_d: 0.330068
0.7678 --- loss: 0.787806, loss_ss: 0.657564, loss_d: 0.130242
0.8061 --- loss: 0.858079, loss_ss: 0.747625, loss_d: 0.110453
0.8445 --- loss: 1.408406, loss_ss: 1.145735, loss_d: 0.262671
0.8829 --- loss: 1.247185, loss_ss: 0.740315, loss_d: 0.506870
0.9213 --- loss: 1.181124, loss_ss: 0.968688, loss_d: 0.212436
0.9597 --- loss: 1.383408, loss_ss: 1.243722, loss_d: 0.139686
0.9981 --- loss: 1.018594, loss_ss: 0.840787, loss_d: 0.177807
Epoch finished! Loss: 1.2849119663238526
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.169135, loss_ss: 0.905563, loss_d: 0.263573
0.0384 --- loss: 1.155419, loss_ss: 0.809128, loss_d: 0.346290
0.0768 --- loss: 2.052200, loss_ss: 1.060234, loss_d: 0.991967
0.1152 --- loss: 1.301272, loss_ss: 1.085032, loss_d: 0.216239
0.1536 --- loss: 0.810627, loss_ss: 0.685377, loss_d: 0.125250
0.1919 --- loss: 1.146834, loss_ss: 0.870170, loss_d: 0.276664
0.2303 --- loss: 1.064116, loss_ss: 0.869840, loss_d: 0.194276
0.2687 --- loss: 1.119338, loss_ss: 0.742232, loss_d: 0.377107
0.3071 --- loss: 1.095082, loss_ss: 1.034385, loss_d: 0.060698
0.3455 --- loss: 1.029741, loss_ss: 0.925469, loss_d: 0.104272
0.3839 --- loss: 1.462214, loss_ss: 1.087686, loss_d: 0.374528
0.4223 --- loss: 0.811675, loss_ss: 0.770027, loss_d: 0.041648
0.4607 --- loss: 1.014542, loss_ss: 0.707584, loss_d: 0.306959
0.4990 --- loss: 0.769058, loss_ss: 0.716124, loss_d: 0.052934
0.5374 --- loss: 0.744189, loss_ss: 0.682432, loss_d: 0.061757
0.5758 --- loss: 1.173521, loss_ss: 0.861735, loss_d: 0.311786
0.6142 --- loss: 1.117786, loss_ss: 0.995669, loss_d: 0.122117
0.6526 --- loss: 1.441978, loss_ss: 1.037751, loss_d: 0.404227
0.6910 --- loss: 1.041533, loss_ss: 0.888983, loss_d: 0.152550
0.7294 --- loss: 1.185975, loss_ss: 1.082260, loss_d: 0.103715
0.7678 --- loss: 1.417660, loss_ss: 1.315423, loss_d: 0.102237
0.8061 --- loss: 1.080899, loss_ss: 0.809416, loss_d: 0.271483
0.8445 --- loss: 1.392671, loss_ss: 0.674435, loss_d: 0.718236
0.8829 --- loss: 1.216947, loss_ss: 0.835783, loss_d: 0.381163
0.9213 --- loss: 1.216755, loss_ss: 0.994250, loss_d: 0.222505
0.9597 --- loss: 1.194463, loss_ss: 0.896129, loss_d: 0.298334
0.9981 --- loss: 2.162475, loss_ss: 1.718190, loss_d: 0.444285
Epoch finished! Loss: 1.20444981776751
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.417820, loss_ss: 1.237629, loss_d: 0.180190
0.0384 --- loss: 1.040492, loss_ss: 0.950027, loss_d: 0.090466
0.0768 --- loss: 1.071812, loss_ss: 1.009283, loss_d: 0.062529
0.1152 --- loss: 1.097675, loss_ss: 0.811935, loss_d: 0.285740
0.1536 --- loss: 1.078278, loss_ss: 0.958173, loss_d: 0.120105
0.1919 --- loss: 1.148717, loss_ss: 0.733198, loss_d: 0.415519
0.2303 --- loss: 1.314457, loss_ss: 0.691108, loss_d: 0.623349
0.2687 --- loss: 1.149632, loss_ss: 1.007560, loss_d: 0.142072
0.3071 --- loss: 1.515514, loss_ss: 1.148319, loss_d: 0.367195
0.3455 --- loss: 1.246310, loss_ss: 1.105207, loss_d: 0.141103
0.3839 --- loss: 0.795585, loss_ss: 0.746331, loss_d: 0.049254
0.4223 --- loss: 1.144411, loss_ss: 0.935985, loss_d: 0.208426
0.4607 --- loss: 1.143070, loss_ss: 0.740362, loss_d: 0.402707
0.4990 --- loss: 0.838153, loss_ss: 0.692900, loss_d: 0.145253
0.5374 --- loss: 1.150366, loss_ss: 1.080363, loss_d: 0.070003
0.5758 --- loss: 0.785744, loss_ss: 0.685854, loss_d: 0.099890
0.6142 --- loss: 0.927675, loss_ss: 0.877141, loss_d: 0.050534
0.6526 --- loss: 0.886150, loss_ss: 0.842378, loss_d: 0.043771
0.6910 --- loss: 1.418641, loss_ss: 1.240230, loss_d: 0.178411
0.7294 --- loss: 1.490993, loss_ss: 0.930888, loss_d: 0.560105
0.7678 --- loss: 1.249688, loss_ss: 1.126483, loss_d: 0.123205
0.8061 --- loss: 1.266918, loss_ss: 0.746355, loss_d: 0.520563
0.8445 --- loss: 0.748784, loss_ss: 0.657635, loss_d: 0.091149
0.8829 --- loss: 1.137574, loss_ss: 0.680558, loss_d: 0.457016
0.9213 --- loss: 0.997156, loss_ss: 0.842928, loss_d: 0.154227
0.9597 --- loss: 0.976668, loss_ss: 0.884949, loss_d: 0.091719
0.9981 --- loss: 1.578095, loss_ss: 1.557197, loss_d: 0.020898
Epoch finished! Loss: 1.13862229012526
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.091130, loss_ss: 0.895176, loss_d: 0.195954
0.0384 --- loss: 1.629027, loss_ss: 1.168765, loss_d: 0.460261
0.0768 --- loss: 0.998306, loss_ss: 0.916897, loss_d: 0.081409
0.1152 --- loss: 1.118818, loss_ss: 0.874525, loss_d: 0.244293
0.1536 --- loss: 0.966857, loss_ss: 0.915370, loss_d: 0.051487
0.1919 --- loss: 0.932322, loss_ss: 0.864456, loss_d: 0.067866
0.2303 --- loss: 1.087777, loss_ss: 0.729253, loss_d: 0.358524
0.2687 --- loss: 0.839085, loss_ss: 0.777483, loss_d: 0.061602
0.3071 --- loss: 0.817104, loss_ss: 0.768240, loss_d: 0.048864
0.3455 --- loss: 1.294988, loss_ss: 0.825306, loss_d: 0.469683
0.3839 --- loss: 0.874407, loss_ss: 0.699064, loss_d: 0.175343
0.4223 --- loss: 1.428375, loss_ss: 0.933360, loss_d: 0.495015
0.4607 --- loss: 1.101887, loss_ss: 1.047029, loss_d: 0.054857
0.4990 --- loss: 1.091961, loss_ss: 0.824842, loss_d: 0.267119
0.5374 --- loss: 1.006141, loss_ss: 0.760958, loss_d: 0.245183
0.5758 --- loss: 0.633139, loss_ss: 0.551241, loss_d: 0.081898
0.6142 --- loss: 1.011470, loss_ss: 0.686596, loss_d: 0.324874
0.6526 --- loss: 1.258365, loss_ss: 1.107343, loss_d: 0.151022
0.6910 --- loss: 0.831475, loss_ss: 0.629604, loss_d: 0.201870
0.7294 --- loss: 0.984747, loss_ss: 0.961122, loss_d: 0.023625
0.7678 --- loss: 0.653687, loss_ss: 0.575808, loss_d: 0.077879
0.8061 --- loss: 1.011662, loss_ss: 0.967877, loss_d: 0.043784
0.8445 --- loss: 1.037336, loss_ss: 1.018390, loss_d: 0.018947
0.8829 --- loss: 1.181896, loss_ss: 0.742679, loss_d: 0.439218
0.9213 --- loss: 1.291849, loss_ss: 1.085100, loss_d: 0.206749
0.9597 --- loss: 1.118156, loss_ss: 0.852548, loss_d: 0.265608
0.9981 --- loss: 1.470803, loss_ss: 1.141767, loss_d: 0.329036
Epoch finished! Loss: 1.060614389868883
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.918369, loss_ss: 0.845037, loss_d: 0.073333
0.0384 --- loss: 1.223879, loss_ss: 0.867127, loss_d: 0.356751
0.0768 --- loss: 2.014096, loss_ss: 1.223518, loss_d: 0.790578
0.1152 --- loss: 1.095004, loss_ss: 1.059314, loss_d: 0.035690
0.1536 --- loss: 0.907155, loss_ss: 0.862121, loss_d: 0.045033
0.1919 --- loss: 0.898113, loss_ss: 0.799984, loss_d: 0.098129
0.2303 --- loss: 0.817031, loss_ss: 0.790544, loss_d: 0.026487
0.2687 --- loss: 0.814943, loss_ss: 0.633091, loss_d: 0.181852
0.3071 --- loss: 1.551302, loss_ss: 0.965270, loss_d: 0.586033
0.3455 --- loss: 0.953112, loss_ss: 0.900454, loss_d: 0.052658
0.3839 --- loss: 1.309539, loss_ss: 0.817746, loss_d: 0.491793
0.4223 --- loss: 0.877848, loss_ss: 0.835286, loss_d: 0.042562
0.4607 --- loss: 0.820463, loss_ss: 0.613387, loss_d: 0.207076
0.4990 --- loss: 0.739213, loss_ss: 0.683800, loss_d: 0.055413
0.5374 --- loss: 1.175108, loss_ss: 0.858059, loss_d: 0.317049
0.5758 --- loss: 0.871987, loss_ss: 0.829591, loss_d: 0.042395
0.6142 --- loss: 0.770085, loss_ss: 0.696727, loss_d: 0.073358
0.6526 --- loss: 1.393916, loss_ss: 1.169430, loss_d: 0.224486
0.6910 --- loss: 1.220167, loss_ss: 0.818690, loss_d: 0.401477
0.7294 --- loss: 0.919523, loss_ss: 0.898265, loss_d: 0.021258
0.7678 --- loss: 1.363478, loss_ss: 1.332295, loss_d: 0.031183
0.8061 --- loss: 0.981453, loss_ss: 0.945987, loss_d: 0.035466
0.8445 --- loss: 0.545629, loss_ss: 0.529089, loss_d: 0.016540
0.8829 --- loss: 1.652507, loss_ss: 0.774711, loss_d: 0.877796
0.9213 --- loss: 0.907387, loss_ss: 0.848958, loss_d: 0.058429
0.9597 --- loss: 1.570114, loss_ss: 0.590813, loss_d: 0.979301
0.9981 --- loss: 2.564212, loss_ss: 1.001164, loss_d: 1.563048
Epoch finished! Loss: 1.0383368462324143
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.633706, loss_ss: 0.562328, loss_d: 0.071378
0.0384 --- loss: 0.990814, loss_ss: 0.888299, loss_d: 0.102515
0.0768 --- loss: 1.029194, loss_ss: 0.992255, loss_d: 0.036938
0.1152 --- loss: 0.848714, loss_ss: 0.682502, loss_d: 0.166212
0.1536 --- loss: 1.264457, loss_ss: 1.239373, loss_d: 0.025084
0.1919 --- loss: 1.120428, loss_ss: 0.816035, loss_d: 0.304394
0.2303 --- loss: 0.779268, loss_ss: 0.758443, loss_d: 0.020825
0.2687 --- loss: 1.345287, loss_ss: 1.004370, loss_d: 0.340917
0.3071 --- loss: 1.074075, loss_ss: 0.904094, loss_d: 0.169982
0.3455 --- loss: 0.932159, loss_ss: 0.913274, loss_d: 0.018885
0.3839 --- loss: 3.226035, loss_ss: 1.042016, loss_d: 2.184019
0.4223 --- loss: 1.433319, loss_ss: 1.332462, loss_d: 0.100857
0.4607 --- loss: 0.803489, loss_ss: 0.777249, loss_d: 0.026241
0.4990 --- loss: 1.145640, loss_ss: 1.103798, loss_d: 0.041842
0.5374 --- loss: 0.598652, loss_ss: 0.571078, loss_d: 0.027575
0.5758 --- loss: 0.978730, loss_ss: 0.924492, loss_d: 0.054238
0.6142 --- loss: 1.962510, loss_ss: 0.809029, loss_d: 1.153481
0.6526 --- loss: 0.654049, loss_ss: 0.638590, loss_d: 0.015459
0.6910 --- loss: 1.109952, loss_ss: 0.917837, loss_d: 0.192115
0.7294 --- loss: 0.920601, loss_ss: 0.814207, loss_d: 0.106394
0.7678 --- loss: 0.707209, loss_ss: 0.693802, loss_d: 0.013407
0.8061 --- loss: 1.079512, loss_ss: 0.886403, loss_d: 0.193110
0.8445 --- loss: 0.978750, loss_ss: 0.632909, loss_d: 0.345841
0.8829 --- loss: 1.186692, loss_ss: 1.006697, loss_d: 0.179995
0.9213 --- loss: 0.998008, loss_ss: 0.921304, loss_d: 0.076705
0.9597 --- loss: 0.799826, loss_ss: 0.697175, loss_d: 0.102651
0.9981 --- loss: 0.987654, loss_ss: 0.855176, loss_d: 0.132478
Epoch finished! Loss: 1.0084857906286533
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.717246, loss_ss: 0.677455, loss_d: 0.039790
0.0384 --- loss: 0.748378, loss_ss: 0.687959, loss_d: 0.060419
0.0768 --- loss: 1.317515, loss_ss: 0.686090, loss_d: 0.631425
0.1152 --- loss: 1.144997, loss_ss: 1.052884, loss_d: 0.092114
0.1536 --- loss: 0.727594, loss_ss: 0.705554, loss_d: 0.022040
0.1919 --- loss: 1.221817, loss_ss: 1.093065, loss_d: 0.128752
0.2303 --- loss: 1.072989, loss_ss: 0.958649, loss_d: 0.114340
0.2687 --- loss: 0.928241, loss_ss: 0.885633, loss_d: 0.042608
0.3071 --- loss: 0.701948, loss_ss: 0.670689, loss_d: 0.031259
0.3455 --- loss: 0.811454, loss_ss: 0.778955, loss_d: 0.032499
0.3839 --- loss: 0.786584, loss_ss: 0.710211, loss_d: 0.076373
0.4223 --- loss: 1.041323, loss_ss: 1.006457, loss_d: 0.034865
0.4607 --- loss: 0.959955, loss_ss: 0.639300, loss_d: 0.320655
0.4990 --- loss: 1.018462, loss_ss: 0.952590, loss_d: 0.065873
0.5374 --- loss: 0.876915, loss_ss: 0.865111, loss_d: 0.011804
0.5758 --- loss: 1.506765, loss_ss: 1.415996, loss_d: 0.090769
0.6142 --- loss: 0.949046, loss_ss: 0.925244, loss_d: 0.023802
0.6526 --- loss: 0.937940, loss_ss: 0.926964, loss_d: 0.010976
0.6910 --- loss: 0.760561, loss_ss: 0.753572, loss_d: 0.006989
0.7294 --- loss: 1.021611, loss_ss: 0.804353, loss_d: 0.217258
0.7678 --- loss: 0.626041, loss_ss: 0.515256, loss_d: 0.110785
0.8061 --- loss: 0.846164, loss_ss: 0.787147, loss_d: 0.059017
0.8445 --- loss: 1.084325, loss_ss: 1.019395, loss_d: 0.064930
0.8829 --- loss: 0.823154, loss_ss: 0.661706, loss_d: 0.161448
0.9213 --- loss: 1.113902, loss_ss: 1.048486, loss_d: 0.065416
0.9597 --- loss: 0.635845, loss_ss: 0.594382, loss_d: 0.041463
0.9981 --- loss: 2.147695, loss_ss: 0.750863, loss_d: 1.396832
Epoch finished! Loss: 0.9561500986035053
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.809513, loss_ss: 0.781485, loss_d: 0.028028
0.0384 --- loss: 1.020879, loss_ss: 0.722419, loss_d: 0.298460
0.0768 --- loss: 0.786495, loss_ss: 0.691634, loss_d: 0.094862
0.1152 --- loss: 0.758113, loss_ss: 0.720200, loss_d: 0.037914
0.1536 --- loss: 1.254557, loss_ss: 1.135161, loss_d: 0.119397
0.1919 --- loss: 1.390940, loss_ss: 1.038498, loss_d: 0.352441
0.2303 --- loss: 0.806475, loss_ss: 0.788927, loss_d: 0.017548
0.2687 --- loss: 0.919298, loss_ss: 0.780584, loss_d: 0.138714
0.3071 --- loss: 0.838340, loss_ss: 0.774051, loss_d: 0.064290
0.3455 --- loss: 0.729607, loss_ss: 0.717657, loss_d: 0.011950
0.3839 --- loss: 0.900240, loss_ss: 0.869099, loss_d: 0.031140
0.4223 --- loss: 0.732183, loss_ss: 0.710003, loss_d: 0.022180
0.4607 --- loss: 0.591189, loss_ss: 0.558020, loss_d: 0.033169
0.4990 --- loss: 0.757090, loss_ss: 0.732648, loss_d: 0.024442
0.5374 --- loss: 0.734976, loss_ss: 0.723535, loss_d: 0.011440
0.5758 --- loss: 0.761025, loss_ss: 0.714298, loss_d: 0.046727
0.6142 --- loss: 1.565464, loss_ss: 0.875077, loss_d: 0.690387
0.6526 --- loss: 0.772615, loss_ss: 0.729148, loss_d: 0.043467
0.6910 --- loss: 1.696455, loss_ss: 1.016067, loss_d: 0.680388
0.7294 --- loss: 0.932271, loss_ss: 0.881198, loss_d: 0.051073
0.7678 --- loss: 1.814476, loss_ss: 0.826678, loss_d: 0.987798
0.8061 --- loss: 0.810467, loss_ss: 0.716209, loss_d: 0.094257
0.8445 --- loss: 0.965571, loss_ss: 0.907137, loss_d: 0.058434
0.8829 --- loss: 1.045495, loss_ss: 0.773414, loss_d: 0.272081
0.9213 --- loss: 0.892602, loss_ss: 0.875367, loss_d: 0.017235
0.9597 --- loss: 1.031812, loss_ss: 0.899143, loss_d: 0.132669
0.9981 --- loss: 1.774949, loss_ss: 0.823023, loss_d: 0.951926
Epoch finished! Loss: 0.9442731363268999
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.798989898989899
             precision    recall  f1-score   support

        0.0       0.80      0.92      0.86       159
        1.0       0.24      0.14      0.18        87
        2.0       0.89      0.83      0.86       439
        3.0       0.99      0.69      0.81        99
        4.0       0.71      0.97      0.82       206

avg / total       0.79      0.80      0.79       990
 


====== chp052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.15  92.45   95.67  80.33     85.96
1  88.69  13.79   95.90  24.49     17.65
2  88.08  82.92   92.20  89.43     86.05
3  96.77  68.69   99.89  98.55     80.95
4  91.11  97.09   89.54  70.92     81.97
Total accuracy: 79.90%
Average sen: 70.99%
Average spec: 94.64%
Macro f1-score: 70.52%
Diagnosis acc on 15mins: 0.7272727272727273
[0.95461577 0.94372433 0.98084313 0.99318087 0.93859184 0.07627754
 0.4443813  0.54778063 0.09939556 0.2607401  0.99612397 0.72579116
 0.96118242 0.8870827  0.50333214 0.22596936 0.12679094 0.34232047
 0.10860649 0.78081167 0.89818144 0.92647791 0.84733731 0.70809573
 0.5242371  0.60818982 0.93181729 0.96391463 0.94639182 0.96201485
 0.77690446 0.2695424  0.5716449 ]
pred: 0.661584607127941, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.234152, loss_ss: 1.578659, loss_d: 0.655494
0.0384 --- loss: 2.178755, loss_ss: 1.573652, loss_d: 0.605103
0.0769 --- loss: 2.265444, loss_ss: 1.505720, loss_d: 0.759724
0.1153 --- loss: 2.190423, loss_ss: 1.423740, loss_d: 0.766682
0.1537 --- loss: 2.041668, loss_ss: 1.450780, loss_d: 0.590888
0.1922 --- loss: 2.041047, loss_ss: 1.471256, loss_d: 0.569791
0.2306 --- loss: 2.108122, loss_ss: 1.442141, loss_d: 0.665981
0.2690 --- loss: 1.913537, loss_ss: 1.521996, loss_d: 0.391541
0.3075 --- loss: 2.185497, loss_ss: 1.451315, loss_d: 0.734182
0.3459 --- loss: 1.709653, loss_ss: 1.354084, loss_d: 0.355568
0.3843 --- loss: 1.938573, loss_ss: 1.431206, loss_d: 0.507367
0.4228 --- loss: 1.761826, loss_ss: 1.308038, loss_d: 0.453787
0.4612 --- loss: 2.042616, loss_ss: 1.358464, loss_d: 0.684151
0.4996 --- loss: 1.887197, loss_ss: 1.338616, loss_d: 0.548582
0.5380 --- loss: 1.845710, loss_ss: 1.182711, loss_d: 0.662999
0.5765 --- loss: 2.110122, loss_ss: 1.266509, loss_d: 0.843613
0.6149 --- loss: 1.868012, loss_ss: 1.311610, loss_d: 0.556401
0.6533 --- loss: 2.122446, loss_ss: 1.317167, loss_d: 0.805279
0.6918 --- loss: 1.940000, loss_ss: 1.245660, loss_d: 0.694339
0.7302 --- loss: 1.540128, loss_ss: 1.220653, loss_d: 0.319475
0.7686 --- loss: 1.824490, loss_ss: 1.231253, loss_d: 0.593238
0.8071 --- loss: 1.649511, loss_ss: 1.235410, loss_d: 0.414101
0.8455 --- loss: 1.941169, loss_ss: 1.221706, loss_d: 0.719463
0.8839 --- loss: 1.764795, loss_ss: 1.264143, loss_d: 0.500651
0.9224 --- loss: 1.818117, loss_ss: 1.286148, loss_d: 0.531968
0.9608 --- loss: 1.681205, loss_ss: 1.144474, loss_d: 0.536730
0.9992 --- loss: 1.904260, loss_ss: 1.781326, loss_d: 0.122934
Epoch finished! Loss: 1.9367851353608645
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.384300, loss_ss: 1.038107, loss_d: 0.346193
0.0384 --- loss: 1.877690, loss_ss: 1.102546, loss_d: 0.775144
0.0769 --- loss: 1.364354, loss_ss: 1.147436, loss_d: 0.216918
0.1153 --- loss: 1.988362, loss_ss: 1.069780, loss_d: 0.918582
0.1537 --- loss: 1.533471, loss_ss: 1.302775, loss_d: 0.230696
0.1922 --- loss: 1.540505, loss_ss: 1.080069, loss_d: 0.460436
0.2306 --- loss: 1.591888, loss_ss: 1.370967, loss_d: 0.220921
0.2690 --- loss: 1.719852, loss_ss: 1.233848, loss_d: 0.486003
0.3075 --- loss: 1.339244, loss_ss: 1.096220, loss_d: 0.243024
0.3459 --- loss: 1.648022, loss_ss: 1.301383, loss_d: 0.346639
0.3843 --- loss: 1.328263, loss_ss: 1.018050, loss_d: 0.310213
0.4228 --- loss: 1.552682, loss_ss: 1.042457, loss_d: 0.510226
0.4612 --- loss: 1.270725, loss_ss: 0.975796, loss_d: 0.294929
0.4996 --- loss: 1.852423, loss_ss: 1.233506, loss_d: 0.618917
0.5380 --- loss: 1.469794, loss_ss: 1.052104, loss_d: 0.417691
0.5765 --- loss: 1.464283, loss_ss: 1.087158, loss_d: 0.377124
0.6149 --- loss: 1.286891, loss_ss: 1.144894, loss_d: 0.141997
0.6533 --- loss: 1.259892, loss_ss: 0.953134, loss_d: 0.306758
0.6918 --- loss: 1.390418, loss_ss: 1.139846, loss_d: 0.250572
0.7302 --- loss: 1.811771, loss_ss: 1.024918, loss_d: 0.786853
0.7686 --- loss: 1.422187, loss_ss: 1.016098, loss_d: 0.406089
0.8071 --- loss: 1.409667, loss_ss: 1.058306, loss_d: 0.351362
0.8455 --- loss: 1.729338, loss_ss: 1.062940, loss_d: 0.666398
0.8839 --- loss: 1.340565, loss_ss: 1.165425, loss_d: 0.175140
0.9224 --- loss: 1.315042, loss_ss: 0.781750, loss_d: 0.533293
0.9608 --- loss: 1.265812, loss_ss: 1.115427, loss_d: 0.150385
0.9992 --- loss: 3.313449, loss_ss: 1.913365, loss_d: 1.400084
Epoch finished! Loss: 1.522381329536438
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.186072, loss_ss: 1.053590, loss_d: 0.132482
0.0384 --- loss: 1.117793, loss_ss: 0.851550, loss_d: 0.266243
0.0769 --- loss: 1.717700, loss_ss: 0.995039, loss_d: 0.722661
0.1153 --- loss: 1.561063, loss_ss: 1.247284, loss_d: 0.313779
0.1537 --- loss: 1.147186, loss_ss: 1.022794, loss_d: 0.124392
0.1922 --- loss: 1.285261, loss_ss: 1.055753, loss_d: 0.229509
0.2306 --- loss: 1.356083, loss_ss: 1.017656, loss_d: 0.338427
0.2690 --- loss: 1.305663, loss_ss: 1.069249, loss_d: 0.236413
0.3075 --- loss: 1.073798, loss_ss: 0.799546, loss_d: 0.274252
0.3459 --- loss: 1.393961, loss_ss: 1.074193, loss_d: 0.319768
0.3843 --- loss: 1.141955, loss_ss: 0.933723, loss_d: 0.208232
0.4228 --- loss: 1.295104, loss_ss: 0.971361, loss_d: 0.323743
0.4612 --- loss: 1.184278, loss_ss: 1.046975, loss_d: 0.137303
0.4996 --- loss: 2.180060, loss_ss: 0.979667, loss_d: 1.200392
0.5380 --- loss: 1.213492, loss_ss: 0.927743, loss_d: 0.285750
0.5765 --- loss: 1.158527, loss_ss: 0.962043, loss_d: 0.196484
0.6149 --- loss: 1.485884, loss_ss: 1.052333, loss_d: 0.433551
0.6533 --- loss: 1.398898, loss_ss: 1.041250, loss_d: 0.357648
0.6918 --- loss: 1.213749, loss_ss: 1.015906, loss_d: 0.197843
0.7302 --- loss: 1.148957, loss_ss: 0.777331, loss_d: 0.371626
0.7686 --- loss: 0.896948, loss_ss: 0.729509, loss_d: 0.167439
0.8071 --- loss: 1.299344, loss_ss: 0.891605, loss_d: 0.407739
0.8455 --- loss: 1.290676, loss_ss: 1.018820, loss_d: 0.271856
0.8839 --- loss: 1.392091, loss_ss: 0.914198, loss_d: 0.477893
0.9224 --- loss: 1.266344, loss_ss: 0.896412, loss_d: 0.369932
0.9608 --- loss: 1.354606, loss_ss: 0.924825, loss_d: 0.429781
0.9992 --- loss: 2.414483, loss_ss: 2.305459, loss_d: 0.109025
Epoch finished! Loss: 1.3406505850645212
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.207306, loss_ss: 1.024190, loss_d: 0.183116
0.0384 --- loss: 1.437478, loss_ss: 1.157675, loss_d: 0.279803
0.0769 --- loss: 1.400458, loss_ss: 0.955181, loss_d: 0.445277
0.1153 --- loss: 1.116954, loss_ss: 0.838701, loss_d: 0.278254
0.1537 --- loss: 1.402657, loss_ss: 0.915497, loss_d: 0.487160
0.1922 --- loss: 1.228798, loss_ss: 1.097552, loss_d: 0.131246
0.2306 --- loss: 0.971510, loss_ss: 0.830980, loss_d: 0.140530
0.2690 --- loss: 0.884957, loss_ss: 0.812208, loss_d: 0.072749
0.3075 --- loss: 0.800376, loss_ss: 0.739295, loss_d: 0.061081
0.3459 --- loss: 1.276889, loss_ss: 1.163256, loss_d: 0.113634
0.3843 --- loss: 1.100192, loss_ss: 0.959481, loss_d: 0.140711
0.4228 --- loss: 1.200745, loss_ss: 0.879805, loss_d: 0.320940
0.4612 --- loss: 1.456696, loss_ss: 0.861155, loss_d: 0.595541
0.4996 --- loss: 1.056796, loss_ss: 0.885582, loss_d: 0.171214
0.5380 --- loss: 1.073603, loss_ss: 0.896167, loss_d: 0.177436
0.5765 --- loss: 1.617110, loss_ss: 0.895228, loss_d: 0.721882
0.6149 --- loss: 1.298429, loss_ss: 1.059020, loss_d: 0.239409
0.6533 --- loss: 1.059198, loss_ss: 0.957788, loss_d: 0.101410
0.6918 --- loss: 0.682564, loss_ss: 0.613622, loss_d: 0.068941
0.7302 --- loss: 1.001506, loss_ss: 0.815997, loss_d: 0.185508
0.7686 --- loss: 1.112952, loss_ss: 0.894625, loss_d: 0.218326
0.8071 --- loss: 1.139293, loss_ss: 0.815123, loss_d: 0.324170
0.8455 --- loss: 1.559200, loss_ss: 0.859515, loss_d: 0.699685
0.8839 --- loss: 1.015414, loss_ss: 0.948913, loss_d: 0.066502
0.9224 --- loss: 1.143754, loss_ss: 0.987088, loss_d: 0.156666
0.9608 --- loss: 1.056848, loss_ss: 0.794763, loss_d: 0.262085
0.9992 --- loss: 3.141669, loss_ss: 1.573935, loss_d: 1.567734
Epoch finished! Loss: 1.2430314419361261
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.139387, loss_ss: 0.903554, loss_d: 0.235833
0.0384 --- loss: 1.043889, loss_ss: 0.748399, loss_d: 0.295491
0.0769 --- loss: 1.106775, loss_ss: 0.811326, loss_d: 0.295449
0.1153 --- loss: 1.057553, loss_ss: 0.771118, loss_d: 0.286435
0.1537 --- loss: 1.040662, loss_ss: 0.910746, loss_d: 0.129916
0.1922 --- loss: 1.130007, loss_ss: 1.078899, loss_d: 0.051108
0.2306 --- loss: 1.238509, loss_ss: 0.717244, loss_d: 0.521265
0.2690 --- loss: 0.842934, loss_ss: 0.664156, loss_d: 0.178778
0.3075 --- loss: 0.997720, loss_ss: 0.876602, loss_d: 0.121118
0.3459 --- loss: 1.488256, loss_ss: 1.216517, loss_d: 0.271739
0.3843 --- loss: 1.460528, loss_ss: 1.011095, loss_d: 0.449433
0.4228 --- loss: 1.766741, loss_ss: 1.175248, loss_d: 0.591492
0.4612 --- loss: 1.286390, loss_ss: 0.846379, loss_d: 0.440011
0.4996 --- loss: 0.757560, loss_ss: 0.635818, loss_d: 0.121741
0.5380 --- loss: 1.352325, loss_ss: 1.002348, loss_d: 0.349977
0.5765 --- loss: 1.051824, loss_ss: 0.990294, loss_d: 0.061530
0.6149 --- loss: 1.161085, loss_ss: 1.040630, loss_d: 0.120454
0.6533 --- loss: 1.150213, loss_ss: 0.795651, loss_d: 0.354561
0.6918 --- loss: 1.202950, loss_ss: 1.110586, loss_d: 0.092364
0.7302 --- loss: 1.127942, loss_ss: 0.958575, loss_d: 0.169367
0.7686 --- loss: 0.948317, loss_ss: 0.886548, loss_d: 0.061769
0.8071 --- loss: 1.468169, loss_ss: 1.064722, loss_d: 0.403447
0.8455 --- loss: 0.987858, loss_ss: 0.831275, loss_d: 0.156583
0.8839 --- loss: 1.041724, loss_ss: 0.934995, loss_d: 0.106729
0.9224 --- loss: 0.934971, loss_ss: 0.848778, loss_d: 0.086193
0.9608 --- loss: 0.870474, loss_ss: 0.743147, loss_d: 0.127328
0.9992 --- loss: 2.548333, loss_ss: 2.478626, loss_d: 0.069708
Epoch finished! Loss: 1.176365279005124
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.914838, loss_ss: 0.744369, loss_d: 0.170470
0.0384 --- loss: 1.243159, loss_ss: 1.118362, loss_d: 0.124797
0.0769 --- loss: 1.146513, loss_ss: 1.026837, loss_d: 0.119676
0.1153 --- loss: 1.502886, loss_ss: 0.827465, loss_d: 0.675421
0.1537 --- loss: 1.141934, loss_ss: 0.861031, loss_d: 0.280903
0.1922 --- loss: 1.270002, loss_ss: 1.146590, loss_d: 0.123413
0.2306 --- loss: 0.774594, loss_ss: 0.657634, loss_d: 0.116960
0.2690 --- loss: 0.852382, loss_ss: 0.733417, loss_d: 0.118965
0.3075 --- loss: 1.337164, loss_ss: 0.958396, loss_d: 0.378768
0.3459 --- loss: 1.261061, loss_ss: 1.006855, loss_d: 0.254206
0.3843 --- loss: 0.859695, loss_ss: 0.801336, loss_d: 0.058359
0.4228 --- loss: 1.264865, loss_ss: 1.054107, loss_d: 0.210758
0.4612 --- loss: 0.946232, loss_ss: 0.759279, loss_d: 0.186953
0.4996 --- loss: 1.187667, loss_ss: 0.966750, loss_d: 0.220917
0.5380 --- loss: 0.973687, loss_ss: 0.867943, loss_d: 0.105745
0.5765 --- loss: 1.084230, loss_ss: 0.920813, loss_d: 0.163417
0.6149 --- loss: 1.127776, loss_ss: 0.937048, loss_d: 0.190728
0.6533 --- loss: 0.966082, loss_ss: 0.802456, loss_d: 0.163626
0.6918 --- loss: 0.847606, loss_ss: 0.769283, loss_d: 0.078323
0.7302 --- loss: 1.603698, loss_ss: 0.708877, loss_d: 0.894821
0.7686 --- loss: 1.453264, loss_ss: 0.916183, loss_d: 0.537080
0.8071 --- loss: 1.076223, loss_ss: 0.743074, loss_d: 0.333149
0.8455 --- loss: 1.432412, loss_ss: 1.080348, loss_d: 0.352064
0.8839 --- loss: 0.790695, loss_ss: 0.647206, loss_d: 0.143489
0.9224 --- loss: 1.095567, loss_ss: 0.847399, loss_d: 0.248167
0.9608 --- loss: 1.264598, loss_ss: 0.688422, loss_d: 0.576176
0.9992 --- loss: 2.070113, loss_ss: 2.054043, loss_d: 0.016071
Epoch finished! Loss: 1.1225033721098534
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.018272, loss_ss: 0.897869, loss_d: 0.120403
0.0384 --- loss: 0.930559, loss_ss: 0.871152, loss_d: 0.059407
0.0769 --- loss: 1.223552, loss_ss: 0.808862, loss_d: 0.414690
0.1153 --- loss: 1.182131, loss_ss: 0.869039, loss_d: 0.313092
0.1537 --- loss: 1.644664, loss_ss: 0.948091, loss_d: 0.696573
0.1922 --- loss: 0.916972, loss_ss: 0.748512, loss_d: 0.168460
0.2306 --- loss: 0.888116, loss_ss: 0.843506, loss_d: 0.044610
0.2690 --- loss: 1.472930, loss_ss: 0.965174, loss_d: 0.507757
0.3075 --- loss: 0.879360, loss_ss: 0.838171, loss_d: 0.041189
0.3459 --- loss: 1.068875, loss_ss: 0.856262, loss_d: 0.212613
0.3843 --- loss: 1.073596, loss_ss: 1.054310, loss_d: 0.019286
0.4228 --- loss: 1.028028, loss_ss: 0.717585, loss_d: 0.310443
0.4612 --- loss: 0.923030, loss_ss: 0.899476, loss_d: 0.023553
0.4996 --- loss: 0.906197, loss_ss: 0.813881, loss_d: 0.092315
0.5380 --- loss: 1.096607, loss_ss: 0.956651, loss_d: 0.139956
0.5765 --- loss: 0.863857, loss_ss: 0.747654, loss_d: 0.116203
0.6149 --- loss: 0.976860, loss_ss: 0.871199, loss_d: 0.105661
0.6533 --- loss: 1.221307, loss_ss: 1.021029, loss_d: 0.200277
0.6918 --- loss: 0.916859, loss_ss: 0.591660, loss_d: 0.325199
0.7302 --- loss: 0.940893, loss_ss: 0.891968, loss_d: 0.048925
0.7686 --- loss: 1.178316, loss_ss: 1.111883, loss_d: 0.066434
0.8071 --- loss: 1.049264, loss_ss: 0.812251, loss_d: 0.237013
0.8455 --- loss: 1.320753, loss_ss: 1.216961, loss_d: 0.103792
0.8839 --- loss: 1.069118, loss_ss: 0.913811, loss_d: 0.155307
0.9224 --- loss: 0.829931, loss_ss: 0.690611, loss_d: 0.139320
0.9608 --- loss: 1.130642, loss_ss: 0.876884, loss_d: 0.253758
0.9992 --- loss: 1.658216, loss_ss: 1.645155, loss_d: 0.013061
Epoch finished! Loss: 1.0586581878937207
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.214463, loss_ss: 0.940011, loss_d: 0.274452
0.0384 --- loss: 1.083712, loss_ss: 0.986966, loss_d: 0.096746
0.0769 --- loss: 0.865196, loss_ss: 0.791545, loss_d: 0.073651
0.1153 --- loss: 0.962660, loss_ss: 0.649271, loss_d: 0.313389
0.1537 --- loss: 0.812200, loss_ss: 0.659375, loss_d: 0.152825
0.1922 --- loss: 0.975033, loss_ss: 0.896793, loss_d: 0.078240
0.2306 --- loss: 0.771743, loss_ss: 0.673229, loss_d: 0.098515
0.2690 --- loss: 0.703770, loss_ss: 0.524121, loss_d: 0.179649
0.3075 --- loss: 1.188852, loss_ss: 0.914458, loss_d: 0.274394
0.3459 --- loss: 0.781477, loss_ss: 0.706198, loss_d: 0.075279
0.3843 --- loss: 0.946663, loss_ss: 0.797346, loss_d: 0.149316
0.4228 --- loss: 1.135345, loss_ss: 1.081751, loss_d: 0.053593
0.4612 --- loss: 1.049651, loss_ss: 1.020560, loss_d: 0.029091
0.4996 --- loss: 0.948140, loss_ss: 0.658073, loss_d: 0.290067
0.5380 --- loss: 1.393635, loss_ss: 0.739072, loss_d: 0.654563
0.5765 --- loss: 1.077696, loss_ss: 1.008095, loss_d: 0.069601
0.6149 --- loss: 0.951631, loss_ss: 0.894456, loss_d: 0.057174
0.6533 --- loss: 0.904808, loss_ss: 0.763546, loss_d: 0.141262
0.6918 --- loss: 0.834550, loss_ss: 0.660888, loss_d: 0.173662
0.7302 --- loss: 0.878725, loss_ss: 0.823838, loss_d: 0.054886
0.7686 --- loss: 0.697194, loss_ss: 0.584216, loss_d: 0.112977
0.8071 --- loss: 0.885243, loss_ss: 0.776150, loss_d: 0.109094
0.8455 --- loss: 1.100230, loss_ss: 0.972993, loss_d: 0.127237
0.8839 --- loss: 1.061939, loss_ss: 0.898889, loss_d: 0.163050
0.9224 --- loss: 1.025728, loss_ss: 0.728454, loss_d: 0.297274
0.9608 --- loss: 0.803814, loss_ss: 0.740556, loss_d: 0.063258
0.9992 --- loss: 1.256322, loss_ss: 1.251974, loss_d: 0.004349
Epoch finished! Loss: 0.9978820413351059
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.380377, loss_ss: 1.320002, loss_d: 0.060375
0.0384 --- loss: 1.139038, loss_ss: 1.066777, loss_d: 0.072261
0.0769 --- loss: 1.016531, loss_ss: 0.960609, loss_d: 0.055922
0.1153 --- loss: 1.173281, loss_ss: 1.138867, loss_d: 0.034414
0.1537 --- loss: 0.945872, loss_ss: 0.754343, loss_d: 0.191529
0.1922 --- loss: 0.971670, loss_ss: 0.795181, loss_d: 0.176489
0.2306 --- loss: 1.140996, loss_ss: 1.130776, loss_d: 0.010220
0.2690 --- loss: 1.470618, loss_ss: 1.419237, loss_d: 0.051380
0.3075 --- loss: 0.780796, loss_ss: 0.659697, loss_d: 0.121099
0.3459 --- loss: 1.004988, loss_ss: 0.973132, loss_d: 0.031856
0.3843 --- loss: 0.699281, loss_ss: 0.687826, loss_d: 0.011455
0.4228 --- loss: 1.073230, loss_ss: 0.798783, loss_d: 0.274447
0.4612 --- loss: 0.768794, loss_ss: 0.755077, loss_d: 0.013718
0.4996 --- loss: 0.401220, loss_ss: 0.385871, loss_d: 0.015348
0.5380 --- loss: 0.710377, loss_ss: 0.668770, loss_d: 0.041606
0.5765 --- loss: 1.692841, loss_ss: 1.320776, loss_d: 0.372064
0.6149 --- loss: 1.082335, loss_ss: 0.913734, loss_d: 0.168601
0.6533 --- loss: 1.038515, loss_ss: 0.968174, loss_d: 0.070341
0.6918 --- loss: 0.960864, loss_ss: 0.854764, loss_d: 0.106100
0.7302 --- loss: 0.911015, loss_ss: 0.857649, loss_d: 0.053366
0.7686 --- loss: 0.825353, loss_ss: 0.747513, loss_d: 0.077840
0.8071 --- loss: 1.350874, loss_ss: 0.997105, loss_d: 0.353769
0.8455 --- loss: 0.875276, loss_ss: 0.843806, loss_d: 0.031470
0.8839 --- loss: 0.867814, loss_ss: 0.749561, loss_d: 0.118254
0.9224 --- loss: 0.697935, loss_ss: 0.662613, loss_d: 0.035322
0.9608 --- loss: 1.910860, loss_ss: 1.595938, loss_d: 0.314921
0.9992 --- loss: 2.027935, loss_ss: 0.856440, loss_d: 1.171494
Epoch finished! Loss: 1.0012512737741837
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.817022, loss_ss: 0.574204, loss_d: 0.242819
0.0384 --- loss: 0.825406, loss_ss: 0.727335, loss_d: 0.098071
0.0769 --- loss: 0.946958, loss_ss: 0.903627, loss_d: 0.043331
0.1153 --- loss: 1.059568, loss_ss: 1.031727, loss_d: 0.027840
0.1537 --- loss: 0.718334, loss_ss: 0.602163, loss_d: 0.116171
0.1922 --- loss: 1.057790, loss_ss: 0.860685, loss_d: 0.197105
0.2306 --- loss: 1.851910, loss_ss: 0.658475, loss_d: 1.193436
0.2690 --- loss: 1.117027, loss_ss: 0.851708, loss_d: 0.265320
0.3075 --- loss: 1.025931, loss_ss: 0.877660, loss_d: 0.148271
0.3459 --- loss: 0.901658, loss_ss: 0.769270, loss_d: 0.132387
0.3843 --- loss: 1.004467, loss_ss: 0.950997, loss_d: 0.053471
0.4228 --- loss: 0.996576, loss_ss: 0.826413, loss_d: 0.170163
0.4612 --- loss: 0.924996, loss_ss: 0.867758, loss_d: 0.057238
0.4996 --- loss: 0.733158, loss_ss: 0.704909, loss_d: 0.028249
0.5380 --- loss: 1.078107, loss_ss: 1.020444, loss_d: 0.057663
0.5765 --- loss: 1.156578, loss_ss: 1.147276, loss_d: 0.009302
0.6149 --- loss: 1.055076, loss_ss: 0.970034, loss_d: 0.085042
0.6533 --- loss: 1.120278, loss_ss: 0.895816, loss_d: 0.224463
0.6918 --- loss: 0.837786, loss_ss: 0.831225, loss_d: 0.006561
0.7302 --- loss: 1.125328, loss_ss: 1.039252, loss_d: 0.086076
0.7686 --- loss: 1.027032, loss_ss: 0.999213, loss_d: 0.027819
0.8071 --- loss: 1.089478, loss_ss: 0.772549, loss_d: 0.316929
0.8455 --- loss: 0.962747, loss_ss: 0.904082, loss_d: 0.058665
0.8839 --- loss: 1.095698, loss_ss: 0.975864, loss_d: 0.119834
0.9224 --- loss: 0.926364, loss_ss: 0.868879, loss_d: 0.057485
0.9608 --- loss: 0.737181, loss_ss: 0.668525, loss_d: 0.068656
0.9992 --- loss: 3.260805, loss_ss: 1.787778, loss_d: 1.473026
Epoch finished! Loss: 0.9566984530824881
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7148148148148148
             precision    recall  f1-score   support

        0.0       0.81      0.78      0.79       251
        1.0       0.42      0.12      0.18       147
        2.0       0.59      0.96      0.73       305
        3.0       0.99      0.81      0.89       250
        4.0       0.67      0.50      0.58       127

avg / total       0.72      0.71      0.69      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.46  77.69   94.33  80.58     79.11
1  85.83  11.56   97.53  42.50     18.18
2  79.91  96.07   73.55  58.84     72.98
3  95.46  81.20   99.76  99.02     89.23
4  91.30  50.39   96.75  67.37     57.66
Total accuracy: 71.48%
Average sen: 63.38%
Average spec: 92.38%
Macro f1-score: 63.43%
Diagnosis acc on 15mins: 1.0
[0.99954826 0.98128891 0.99477696 0.99850345 0.99932122 0.75161725
 0.99321085 0.9994567  0.99456125 0.99272352 0.99299508 0.99826801
 0.99691856 0.99737298 0.99524492 0.89626753 0.84938723 0.85647452
 0.82180399 0.99458945 0.9977715  0.99640298 0.99663597 0.99590343
 0.99885035 0.99541312 0.92161763 0.99795961 0.90931875 0.92545158
 0.96356165 0.97417092 0.80464262 0.96667916 0.972179   0.99679536]
pred: 0.9588245633575652, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.314295, loss_ss: 1.687268, loss_d: 0.627027
0.0384 --- loss: 2.530228, loss_ss: 1.623004, loss_d: 0.907223
0.0769 --- loss: 2.037910, loss_ss: 1.536401, loss_d: 0.501509
0.1153 --- loss: 1.995180, loss_ss: 1.600105, loss_d: 0.395075
0.1538 --- loss: 2.003922, loss_ss: 1.425494, loss_d: 0.578428
0.1922 --- loss: 1.937236, loss_ss: 1.317132, loss_d: 0.620104
0.2307 --- loss: 1.838314, loss_ss: 1.301016, loss_d: 0.537299
0.2691 --- loss: 2.149878, loss_ss: 1.495951, loss_d: 0.653928
0.3076 --- loss: 1.863885, loss_ss: 1.494795, loss_d: 0.369089
0.3460 --- loss: 1.888556, loss_ss: 1.366501, loss_d: 0.522055
0.3845 --- loss: 2.203040, loss_ss: 1.367748, loss_d: 0.835292
0.4229 --- loss: 1.738348, loss_ss: 1.150211, loss_d: 0.588137
0.4614 --- loss: 2.136850, loss_ss: 1.194952, loss_d: 0.941898
0.4998 --- loss: 2.091493, loss_ss: 1.391291, loss_d: 0.700202
0.5383 --- loss: 1.707346, loss_ss: 1.185990, loss_d: 0.521356
0.5767 --- loss: 1.987605, loss_ss: 1.286048, loss_d: 0.701557
0.6151 --- loss: 1.971485, loss_ss: 1.394346, loss_d: 0.577139
0.6536 --- loss: 1.891726, loss_ss: 1.517567, loss_d: 0.374159
0.6920 --- loss: 1.852064, loss_ss: 1.478850, loss_d: 0.373214
0.7305 --- loss: 1.756373, loss_ss: 1.179956, loss_d: 0.576417
0.7689 --- loss: 1.583572, loss_ss: 1.306351, loss_d: 0.277221
0.8074 --- loss: 1.858353, loss_ss: 1.345464, loss_d: 0.512889
0.8458 --- loss: 1.656846, loss_ss: 1.280439, loss_d: 0.376407
0.8843 --- loss: 1.738682, loss_ss: 1.161010, loss_d: 0.577672
0.9227 --- loss: 1.418433, loss_ss: 1.129469, loss_d: 0.288964
0.9612 --- loss: 1.818064, loss_ss: 1.180921, loss_d: 0.637143
0.9996 --- loss: 1.930604, loss_ss: 1.856622, loss_d: 0.073982
Epoch finished! Loss: 1.8757802202151372
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.489904, loss_ss: 1.182663, loss_d: 0.307241
0.0384 --- loss: 1.662978, loss_ss: 1.125504, loss_d: 0.537475
0.0769 --- loss: 1.454512, loss_ss: 1.112492, loss_d: 0.342020
0.1153 --- loss: 1.692183, loss_ss: 1.280345, loss_d: 0.411838
0.1538 --- loss: 1.427436, loss_ss: 1.107703, loss_d: 0.319733
0.1922 --- loss: 1.331944, loss_ss: 1.043235, loss_d: 0.288709
0.2307 --- loss: 1.208173, loss_ss: 1.143683, loss_d: 0.064491
0.2691 --- loss: 1.359200, loss_ss: 1.116696, loss_d: 0.242504
0.3076 --- loss: 1.456439, loss_ss: 1.019221, loss_d: 0.437218
0.3460 --- loss: 1.221822, loss_ss: 0.934496, loss_d: 0.287326
0.3845 --- loss: 1.443218, loss_ss: 1.163899, loss_d: 0.279320
0.4229 --- loss: 1.678859, loss_ss: 0.945740, loss_d: 0.733119
0.4614 --- loss: 1.409767, loss_ss: 1.150588, loss_d: 0.259179
0.4998 --- loss: 1.302697, loss_ss: 1.188642, loss_d: 0.114055
0.5383 --- loss: 1.251588, loss_ss: 0.969463, loss_d: 0.282125
0.5767 --- loss: 1.202847, loss_ss: 1.049736, loss_d: 0.153111
0.6151 --- loss: 1.252880, loss_ss: 1.114452, loss_d: 0.138428
0.6536 --- loss: 1.104785, loss_ss: 1.040576, loss_d: 0.064209
0.6920 --- loss: 1.217852, loss_ss: 0.994027, loss_d: 0.223825
0.7305 --- loss: 1.872203, loss_ss: 0.953748, loss_d: 0.918455
0.7689 --- loss: 1.308362, loss_ss: 0.997941, loss_d: 0.310420
0.8074 --- loss: 1.215755, loss_ss: 0.933273, loss_d: 0.282481
0.8458 --- loss: 1.552537, loss_ss: 1.168957, loss_d: 0.383580
0.8843 --- loss: 1.412921, loss_ss: 1.024773, loss_d: 0.388149
0.9227 --- loss: 1.166364, loss_ss: 0.986708, loss_d: 0.179656
0.9612 --- loss: 1.547908, loss_ss: 1.066917, loss_d: 0.480991
0.9996 --- loss: 1.038387, loss_ss: 0.961005, loss_d: 0.077382
Epoch finished! Loss: 1.4612931817770005
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.503170, loss_ss: 0.829065, loss_d: 0.674105
0.0384 --- loss: 1.147333, loss_ss: 0.907370, loss_d: 0.239963
0.0769 --- loss: 1.783639, loss_ss: 1.419459, loss_d: 0.364180
0.1153 --- loss: 1.458370, loss_ss: 1.324283, loss_d: 0.134087
0.1538 --- loss: 1.159787, loss_ss: 0.913825, loss_d: 0.245962
0.1922 --- loss: 1.721539, loss_ss: 0.938650, loss_d: 0.782889
0.2307 --- loss: 1.074821, loss_ss: 0.985677, loss_d: 0.089144
0.2691 --- loss: 1.288223, loss_ss: 1.095322, loss_d: 0.192901
0.3076 --- loss: 1.157685, loss_ss: 1.001295, loss_d: 0.156390
0.3460 --- loss: 1.135259, loss_ss: 0.972281, loss_d: 0.162978
0.3845 --- loss: 1.410079, loss_ss: 0.990354, loss_d: 0.419725
0.4229 --- loss: 1.279575, loss_ss: 0.860588, loss_d: 0.418987
0.4614 --- loss: 1.130995, loss_ss: 0.935557, loss_d: 0.195437
0.4998 --- loss: 1.217702, loss_ss: 0.855544, loss_d: 0.362159
0.5383 --- loss: 1.158778, loss_ss: 0.845531, loss_d: 0.313248
0.5767 --- loss: 1.093435, loss_ss: 0.851441, loss_d: 0.241994
0.6151 --- loss: 1.032423, loss_ss: 0.857808, loss_d: 0.174615
0.6536 --- loss: 1.140980, loss_ss: 1.019725, loss_d: 0.121255
0.6920 --- loss: 1.174863, loss_ss: 1.089920, loss_d: 0.084943
0.7305 --- loss: 1.673074, loss_ss: 1.011081, loss_d: 0.661993
0.7689 --- loss: 1.306779, loss_ss: 1.028685, loss_d: 0.278094
0.8074 --- loss: 1.603819, loss_ss: 1.237599, loss_d: 0.366219
0.8458 --- loss: 0.971936, loss_ss: 0.806509, loss_d: 0.165427
0.8843 --- loss: 1.105901, loss_ss: 0.878298, loss_d: 0.227603
0.9227 --- loss: 1.431232, loss_ss: 1.157086, loss_d: 0.274146
0.9612 --- loss: 2.252551, loss_ss: 1.898878, loss_d: 0.353673
0.9996 --- loss: 2.597867, loss_ss: 2.457519, loss_d: 0.140348
Epoch finished! Loss: 1.2838771544969998
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.970890, loss_ss: 0.848385, loss_d: 0.122506
0.0384 --- loss: 1.370634, loss_ss: 0.867808, loss_d: 0.502827
0.0769 --- loss: 1.285195, loss_ss: 0.946627, loss_d: 0.338568
0.1153 --- loss: 1.519613, loss_ss: 1.264876, loss_d: 0.254736
0.1538 --- loss: 1.422463, loss_ss: 1.053666, loss_d: 0.368798
0.1922 --- loss: 0.736169, loss_ss: 0.659183, loss_d: 0.076987
0.2307 --- loss: 1.243563, loss_ss: 1.064203, loss_d: 0.179360
0.2691 --- loss: 1.321614, loss_ss: 0.896056, loss_d: 0.425558
0.3076 --- loss: 1.455565, loss_ss: 1.007458, loss_d: 0.448107
0.3460 --- loss: 1.377706, loss_ss: 0.915963, loss_d: 0.461744
0.3845 --- loss: 1.852803, loss_ss: 0.892418, loss_d: 0.960385
0.4229 --- loss: 1.153356, loss_ss: 0.955061, loss_d: 0.198295
0.4614 --- loss: 1.045570, loss_ss: 0.852836, loss_d: 0.192734
0.4998 --- loss: 1.343820, loss_ss: 1.207182, loss_d: 0.136637
0.5383 --- loss: 1.125971, loss_ss: 0.913616, loss_d: 0.212355
0.5767 --- loss: 1.050314, loss_ss: 1.015710, loss_d: 0.034604
0.6151 --- loss: 0.919480, loss_ss: 0.886695, loss_d: 0.032785
0.6536 --- loss: 1.510822, loss_ss: 1.088008, loss_d: 0.422814
0.6920 --- loss: 1.209206, loss_ss: 0.965281, loss_d: 0.243925
0.7305 --- loss: 0.951069, loss_ss: 0.753852, loss_d: 0.197217
0.7689 --- loss: 0.955338, loss_ss: 0.809368, loss_d: 0.145970
0.8074 --- loss: 0.880104, loss_ss: 0.801489, loss_d: 0.078615
0.8458 --- loss: 1.514766, loss_ss: 1.056334, loss_d: 0.458431
0.8843 --- loss: 1.482930, loss_ss: 1.245577, loss_d: 0.237353
0.9227 --- loss: 0.959193, loss_ss: 0.723073, loss_d: 0.236119
0.9612 --- loss: 1.279044, loss_ss: 1.059237, loss_d: 0.219807
0.9996 --- loss: 1.526715, loss_ss: 1.479968, loss_d: 0.046747
Epoch finished! Loss: 1.217891946205726
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.121119, loss_ss: 0.843756, loss_d: 0.277363
0.0384 --- loss: 0.770049, loss_ss: 0.693704, loss_d: 0.076345
0.0769 --- loss: 0.923989, loss_ss: 0.605330, loss_d: 0.318659
0.1153 --- loss: 1.138743, loss_ss: 1.017337, loss_d: 0.121406
0.1538 --- loss: 0.952683, loss_ss: 0.850633, loss_d: 0.102050
0.1922 --- loss: 1.164011, loss_ss: 0.759380, loss_d: 0.404631
0.2307 --- loss: 0.737299, loss_ss: 0.699445, loss_d: 0.037854
0.2691 --- loss: 1.130033, loss_ss: 1.017443, loss_d: 0.112589
0.3076 --- loss: 1.491168, loss_ss: 1.375274, loss_d: 0.115895
0.3460 --- loss: 0.952167, loss_ss: 0.916555, loss_d: 0.035612
0.3845 --- loss: 1.216506, loss_ss: 0.989935, loss_d: 0.226571
0.4229 --- loss: 1.069792, loss_ss: 1.031270, loss_d: 0.038522
0.4614 --- loss: 1.300573, loss_ss: 1.079502, loss_d: 0.221071
0.4998 --- loss: 1.026338, loss_ss: 0.894656, loss_d: 0.131682
0.5383 --- loss: 1.101687, loss_ss: 0.911428, loss_d: 0.190259
0.5767 --- loss: 1.150797, loss_ss: 0.686775, loss_d: 0.464022
0.6151 --- loss: 0.859529, loss_ss: 0.569163, loss_d: 0.290366
0.6536 --- loss: 1.218916, loss_ss: 1.046342, loss_d: 0.172574
0.6920 --- loss: 1.258309, loss_ss: 1.088078, loss_d: 0.170231
0.7305 --- loss: 1.378127, loss_ss: 1.236591, loss_d: 0.141536
0.7689 --- loss: 0.941849, loss_ss: 0.842229, loss_d: 0.099619
0.8074 --- loss: 1.145184, loss_ss: 0.747275, loss_d: 0.397909
0.8458 --- loss: 1.366711, loss_ss: 0.813795, loss_d: 0.552917
0.8843 --- loss: 1.017531, loss_ss: 0.968021, loss_d: 0.049510
0.9227 --- loss: 0.952894, loss_ss: 0.893676, loss_d: 0.059219
0.9612 --- loss: 0.672761, loss_ss: 0.631288, loss_d: 0.041474
0.9996 --- loss: 2.904168, loss_ss: 2.901877, loss_d: 0.002291
Epoch finished! Loss: 1.1222160573189075
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.142799, loss_ss: 0.768977, loss_d: 0.373822
0.0384 --- loss: 1.286514, loss_ss: 0.657480, loss_d: 0.629034
0.0769 --- loss: 1.060201, loss_ss: 0.910049, loss_d: 0.150152
0.1153 --- loss: 1.274511, loss_ss: 0.867217, loss_d: 0.407293
0.1538 --- loss: 1.245099, loss_ss: 0.926392, loss_d: 0.318707
0.1922 --- loss: 1.147775, loss_ss: 0.910579, loss_d: 0.237196
0.2307 --- loss: 1.020502, loss_ss: 0.878255, loss_d: 0.142248
0.2691 --- loss: 1.185844, loss_ss: 1.047593, loss_d: 0.138251
0.3076 --- loss: 0.907521, loss_ss: 0.708424, loss_d: 0.199097
0.3460 --- loss: 1.252051, loss_ss: 0.862166, loss_d: 0.389884
0.3845 --- loss: 1.178208, loss_ss: 1.018655, loss_d: 0.159553
0.4229 --- loss: 1.199534, loss_ss: 0.839331, loss_d: 0.360203
0.4614 --- loss: 0.806949, loss_ss: 0.748103, loss_d: 0.058845
0.4998 --- loss: 1.314980, loss_ss: 0.880025, loss_d: 0.434955
0.5383 --- loss: 1.734260, loss_ss: 0.743361, loss_d: 0.990898
0.5767 --- loss: 0.860367, loss_ss: 0.819106, loss_d: 0.041261
0.6151 --- loss: 0.742347, loss_ss: 0.652016, loss_d: 0.090330
0.6536 --- loss: 0.766274, loss_ss: 0.638166, loss_d: 0.128108
0.6920 --- loss: 1.034166, loss_ss: 0.763004, loss_d: 0.271161
0.7305 --- loss: 0.850757, loss_ss: 0.710062, loss_d: 0.140695
0.7689 --- loss: 0.693330, loss_ss: 0.661848, loss_d: 0.031482
0.8074 --- loss: 1.045239, loss_ss: 0.991209, loss_d: 0.054030
0.8458 --- loss: 1.040301, loss_ss: 0.988589, loss_d: 0.051712
0.8843 --- loss: 1.285771, loss_ss: 1.056816, loss_d: 0.228955
0.9227 --- loss: 0.673837, loss_ss: 0.624733, loss_d: 0.049104
0.9612 --- loss: 1.180452, loss_ss: 1.010917, loss_d: 0.169535
0.9996 --- loss: 2.078459, loss_ss: 2.077489, loss_d: 0.000970
Epoch finished! Loss: 1.0858757129082313
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.934729, loss_ss: 0.784378, loss_d: 0.150351
0.0384 --- loss: 1.019386, loss_ss: 0.762050, loss_d: 0.257336
0.0769 --- loss: 0.932686, loss_ss: 0.891145, loss_d: 0.041542
0.1153 --- loss: 0.711153, loss_ss: 0.660741, loss_d: 0.050412
0.1538 --- loss: 1.031785, loss_ss: 0.988914, loss_d: 0.042870
0.1922 --- loss: 1.249621, loss_ss: 1.166219, loss_d: 0.083401
0.2307 --- loss: 1.142627, loss_ss: 1.095542, loss_d: 0.047085
0.2691 --- loss: 0.850265, loss_ss: 0.785549, loss_d: 0.064716
0.3076 --- loss: 0.772146, loss_ss: 0.742894, loss_d: 0.029253
0.3460 --- loss: 1.057285, loss_ss: 0.884899, loss_d: 0.172386
0.3845 --- loss: 1.105408, loss_ss: 0.956720, loss_d: 0.148688
0.4229 --- loss: 1.029498, loss_ss: 0.707321, loss_d: 0.322176
0.4614 --- loss: 1.190167, loss_ss: 0.967192, loss_d: 0.222976
0.4998 --- loss: 1.334880, loss_ss: 1.274988, loss_d: 0.059892
0.5383 --- loss: 2.094529, loss_ss: 1.002241, loss_d: 1.092287
0.5767 --- loss: 1.007663, loss_ss: 0.663422, loss_d: 0.344241
0.6151 --- loss: 0.715275, loss_ss: 0.682638, loss_d: 0.032637
0.6536 --- loss: 1.270679, loss_ss: 0.953624, loss_d: 0.317055
0.6920 --- loss: 1.372622, loss_ss: 0.960667, loss_d: 0.411955
0.7305 --- loss: 1.185640, loss_ss: 1.159911, loss_d: 0.025729
0.7689 --- loss: 1.063876, loss_ss: 0.831092, loss_d: 0.232783
0.8074 --- loss: 1.018348, loss_ss: 0.778591, loss_d: 0.239758
0.8458 --- loss: 1.129953, loss_ss: 1.055734, loss_d: 0.074219
0.8843 --- loss: 0.928662, loss_ss: 0.600892, loss_d: 0.327771
0.9227 --- loss: 0.807769, loss_ss: 0.662085, loss_d: 0.145684
0.9612 --- loss: 1.051823, loss_ss: 0.752443, loss_d: 0.299380
0.9996 --- loss: 4.870639, loss_ss: 3.210545, loss_d: 1.660094
Epoch finished! Loss: 1.0356040342495991
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.038178, loss_ss: 0.842091, loss_d: 0.196088
0.0384 --- loss: 1.810502, loss_ss: 0.974412, loss_d: 0.836090
0.0769 --- loss: 1.141145, loss_ss: 0.761848, loss_d: 0.379297
0.1153 --- loss: 1.113482, loss_ss: 1.066002, loss_d: 0.047480
0.1538 --- loss: 0.814441, loss_ss: 0.710013, loss_d: 0.104428
0.1922 --- loss: 0.888974, loss_ss: 0.829047, loss_d: 0.059927
0.2307 --- loss: 0.896383, loss_ss: 0.712408, loss_d: 0.183975
0.2691 --- loss: 0.825704, loss_ss: 0.746837, loss_d: 0.078867
0.3076 --- loss: 0.988041, loss_ss: 0.958237, loss_d: 0.029804
0.3460 --- loss: 0.981876, loss_ss: 0.658808, loss_d: 0.323067
0.3845 --- loss: 1.159808, loss_ss: 0.827276, loss_d: 0.332532
0.4229 --- loss: 0.975011, loss_ss: 0.941309, loss_d: 0.033702
0.4614 --- loss: 0.945305, loss_ss: 0.849895, loss_d: 0.095410
0.4998 --- loss: 0.751821, loss_ss: 0.684705, loss_d: 0.067115
0.5383 --- loss: 1.887951, loss_ss: 1.480591, loss_d: 0.407359
0.5767 --- loss: 1.259200, loss_ss: 1.074483, loss_d: 0.184717
0.6151 --- loss: 0.918702, loss_ss: 0.878873, loss_d: 0.039829
0.6536 --- loss: 0.994906, loss_ss: 0.654177, loss_d: 0.340729
0.6920 --- loss: 0.801030, loss_ss: 0.788469, loss_d: 0.012560
0.7305 --- loss: 1.146453, loss_ss: 0.899612, loss_d: 0.246841
0.7689 --- loss: 0.745953, loss_ss: 0.641095, loss_d: 0.104858
0.8074 --- loss: 1.061319, loss_ss: 0.946149, loss_d: 0.115170
0.8458 --- loss: 1.270205, loss_ss: 1.116123, loss_d: 0.154081
0.8843 --- loss: 0.927010, loss_ss: 0.846437, loss_d: 0.080573
0.9227 --- loss: 0.776204, loss_ss: 0.729602, loss_d: 0.046603
0.9612 --- loss: 1.107496, loss_ss: 0.998707, loss_d: 0.108789
0.9996 --- loss: 0.894607, loss_ss: 0.892309, loss_d: 0.002297
Epoch finished! Loss: 1.0173083101327602
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.066601, loss_ss: 0.658093, loss_d: 0.408508
0.0384 --- loss: 1.133786, loss_ss: 0.913640, loss_d: 0.220146
0.0769 --- loss: 0.826278, loss_ss: 0.780277, loss_d: 0.046001
0.1153 --- loss: 1.716578, loss_ss: 1.630672, loss_d: 0.085906
0.1538 --- loss: 0.833493, loss_ss: 0.807234, loss_d: 0.026259
0.1922 --- loss: 0.984282, loss_ss: 0.945238, loss_d: 0.039044
0.2307 --- loss: 0.790995, loss_ss: 0.677304, loss_d: 0.113690
0.2691 --- loss: 0.721776, loss_ss: 0.707997, loss_d: 0.013780
0.3076 --- loss: 1.056463, loss_ss: 0.886344, loss_d: 0.170119
0.3460 --- loss: 1.044493, loss_ss: 0.970320, loss_d: 0.074174
0.3845 --- loss: 0.706472, loss_ss: 0.643501, loss_d: 0.062972
0.4229 --- loss: 1.076761, loss_ss: 0.773593, loss_d: 0.303168
0.4614 --- loss: 0.776650, loss_ss: 0.764601, loss_d: 0.012048
0.4998 --- loss: 0.902416, loss_ss: 0.734472, loss_d: 0.167944
0.5383 --- loss: 0.974612, loss_ss: 0.835098, loss_d: 0.139513
0.5767 --- loss: 0.809394, loss_ss: 0.782163, loss_d: 0.027231
0.6151 --- loss: 0.829541, loss_ss: 0.747271, loss_d: 0.082271
0.6536 --- loss: 0.801287, loss_ss: 0.741145, loss_d: 0.060142
0.6920 --- loss: 0.916694, loss_ss: 0.910201, loss_d: 0.006493
0.7305 --- loss: 0.994150, loss_ss: 0.955506, loss_d: 0.038644
0.7689 --- loss: 1.032430, loss_ss: 0.945267, loss_d: 0.087163
0.8074 --- loss: 0.981714, loss_ss: 0.884146, loss_d: 0.097568
0.8458 --- loss: 0.610461, loss_ss: 0.587328, loss_d: 0.023133
0.8843 --- loss: 0.977084, loss_ss: 0.571006, loss_d: 0.406078
0.9227 --- loss: 0.706094, loss_ss: 0.626977, loss_d: 0.079117
0.9612 --- loss: 1.069979, loss_ss: 1.036866, loss_d: 0.033113
0.9996 --- loss: 1.231895, loss_ss: 1.225903, loss_d: 0.005992
Epoch finished! Loss: 0.9636234617004028
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.864918, loss_ss: 0.767007, loss_d: 0.097910
0.0384 --- loss: 0.904394, loss_ss: 0.691666, loss_d: 0.212727
0.0769 --- loss: 0.935752, loss_ss: 0.912306, loss_d: 0.023446
0.1153 --- loss: 1.031841, loss_ss: 0.924969, loss_d: 0.106872
0.1538 --- loss: 0.759862, loss_ss: 0.724882, loss_d: 0.034979
0.1922 --- loss: 0.806171, loss_ss: 0.620161, loss_d: 0.186010
0.2307 --- loss: 1.594092, loss_ss: 1.018665, loss_d: 0.575427
0.2691 --- loss: 0.999189, loss_ss: 0.736296, loss_d: 0.262893
0.3076 --- loss: 0.898431, loss_ss: 0.814282, loss_d: 0.084149
0.3460 --- loss: 0.834774, loss_ss: 0.754165, loss_d: 0.080609
0.3845 --- loss: 1.133470, loss_ss: 0.700206, loss_d: 0.433264
0.4229 --- loss: 1.046010, loss_ss: 0.962645, loss_d: 0.083365
0.4614 --- loss: 0.860725, loss_ss: 0.778487, loss_d: 0.082238
0.4998 --- loss: 0.982447, loss_ss: 0.928225, loss_d: 0.054222
0.5383 --- loss: 0.667439, loss_ss: 0.626794, loss_d: 0.040646
0.5767 --- loss: 0.878029, loss_ss: 0.571076, loss_d: 0.306953
0.6151 --- loss: 0.863865, loss_ss: 0.632764, loss_d: 0.231101
0.6536 --- loss: 0.778388, loss_ss: 0.755289, loss_d: 0.023099
0.6920 --- loss: 1.006383, loss_ss: 0.962637, loss_d: 0.043746
0.7305 --- loss: 0.863820, loss_ss: 0.837962, loss_d: 0.025858
0.7689 --- loss: 0.782790, loss_ss: 0.751532, loss_d: 0.031258
0.8074 --- loss: 0.652136, loss_ss: 0.595372, loss_d: 0.056764
0.8458 --- loss: 0.732362, loss_ss: 0.691040, loss_d: 0.041322
0.8843 --- loss: 0.679267, loss_ss: 0.647971, loss_d: 0.031296
0.9227 --- loss: 0.944992, loss_ss: 0.930251, loss_d: 0.014741
0.9612 --- loss: 0.904017, loss_ss: 0.822710, loss_d: 0.081307
0.9996 --- loss: 2.519951, loss_ss: 2.515577, loss_d: 0.004374
Epoch finished! Loss: 0.9492459842791924
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6936936936936937
             precision    recall  f1-score   support

        0.0       0.91      0.47      0.62       231
        1.0       0.19      0.43      0.26        92
        2.0       0.75      0.89      0.82       472
        3.0       1.00      0.90      0.95        99
        4.0       0.87      0.51      0.65       216

avg / total       0.78      0.69      0.71      1110
 


====== chp054-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.02  47.19   98.75   90.83     62.11
1  79.55  43.48   82.81   18.60     26.06
2  82.97  89.19   78.37   75.31     81.67
3  99.10  89.90  100.00  100.00     94.68
4  89.10  51.39   98.21   87.40     64.72
Total accuracy: 69.37%
Average sen: 64.23%
Average spec: 91.63%
Macro f1-score: 65.85%
Diagnosis acc on 15mins: 1.0
[0.99998152 0.99998009 0.9999572  0.99591547 0.99974626 0.999982
 0.99979764 0.97290009 0.99957186 0.96208978 0.99432534 0.99782443
 0.98015976 0.99974531 0.99961805 0.99719608 0.99947602 0.99995399
 0.98060191 0.99984264 0.99992549 0.99992955 0.99963355 0.98752439
 0.99848515 0.86523008 0.99853611 0.98315549 0.99981922 0.99988043
 0.99999547 0.99981481 0.99997175 0.99994981 0.99924868 0.99962056
 0.99995482]
pred: 0.9921443462371826, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.325377, loss_ss: 1.730070, loss_d: 0.595307
0.0384 --- loss: 2.146535, loss_ss: 1.674920, loss_d: 0.471615
0.0769 --- loss: 2.469056, loss_ss: 1.750329, loss_d: 0.718727
0.1153 --- loss: 2.127757, loss_ss: 1.681596, loss_d: 0.446162
0.1538 --- loss: 2.237705, loss_ss: 1.622985, loss_d: 0.614719
0.1922 --- loss: 2.253424, loss_ss: 1.562738, loss_d: 0.690686
0.2307 --- loss: 1.995156, loss_ss: 1.479129, loss_d: 0.516026
0.2691 --- loss: 2.119761, loss_ss: 1.496056, loss_d: 0.623705
0.3076 --- loss: 2.196329, loss_ss: 1.462968, loss_d: 0.733361
0.3460 --- loss: 2.189501, loss_ss: 1.619237, loss_d: 0.570264
0.3845 --- loss: 1.735004, loss_ss: 1.412747, loss_d: 0.322256
0.4229 --- loss: 2.124449, loss_ss: 1.338812, loss_d: 0.785637
0.4614 --- loss: 2.144134, loss_ss: 1.563527, loss_d: 0.580607
0.4998 --- loss: 1.797570, loss_ss: 1.273694, loss_d: 0.523877
0.5383 --- loss: 1.567306, loss_ss: 1.283071, loss_d: 0.284235
0.5767 --- loss: 1.783125, loss_ss: 1.378372, loss_d: 0.404753
0.6151 --- loss: 2.158551, loss_ss: 1.435204, loss_d: 0.723347
0.6536 --- loss: 1.938141, loss_ss: 1.255893, loss_d: 0.682248
0.6920 --- loss: 1.998883, loss_ss: 1.470736, loss_d: 0.528147
0.7305 --- loss: 1.813056, loss_ss: 1.291544, loss_d: 0.521512
0.7689 --- loss: 1.919235, loss_ss: 1.369964, loss_d: 0.549270
0.8074 --- loss: 1.676965, loss_ss: 1.267070, loss_d: 0.409895
0.8458 --- loss: 1.966637, loss_ss: 1.200824, loss_d: 0.765813
0.8843 --- loss: 2.028174, loss_ss: 1.617489, loss_d: 0.410685
0.9227 --- loss: 1.861755, loss_ss: 1.377326, loss_d: 0.484429
0.9612 --- loss: 1.716840, loss_ss: 1.426388, loss_d: 0.290452
0.9996 --- loss: 1.335313, loss_ss: 1.301926, loss_d: 0.033387
Epoch finished! Loss: 1.9867500814107748
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.529135, loss_ss: 1.241153, loss_d: 0.287981
0.0384 --- loss: 1.685788, loss_ss: 1.275352, loss_d: 0.410436
0.0769 --- loss: 1.427920, loss_ss: 1.238590, loss_d: 0.189331
0.1153 --- loss: 1.636840, loss_ss: 1.236192, loss_d: 0.400648
0.1538 --- loss: 1.462866, loss_ss: 1.114308, loss_d: 0.348558
0.1922 --- loss: 1.275070, loss_ss: 1.109492, loss_d: 0.165577
0.2307 --- loss: 1.576138, loss_ss: 1.162438, loss_d: 0.413700
0.2691 --- loss: 1.429337, loss_ss: 1.050927, loss_d: 0.378410
0.3076 --- loss: 1.918249, loss_ss: 1.316669, loss_d: 0.601580
0.3460 --- loss: 1.453333, loss_ss: 1.017772, loss_d: 0.435561
0.3845 --- loss: 1.283855, loss_ss: 1.094800, loss_d: 0.189054
0.4229 --- loss: 1.482197, loss_ss: 1.240043, loss_d: 0.242153
0.4614 --- loss: 1.497108, loss_ss: 1.109733, loss_d: 0.387375
0.4998 --- loss: 1.815497, loss_ss: 1.148530, loss_d: 0.666967
0.5383 --- loss: 1.591352, loss_ss: 1.337163, loss_d: 0.254189
0.5767 --- loss: 1.291885, loss_ss: 1.004449, loss_d: 0.287436
0.6151 --- loss: 1.587923, loss_ss: 1.231309, loss_d: 0.356614
0.6536 --- loss: 1.909018, loss_ss: 1.287560, loss_d: 0.621458
0.6920 --- loss: 1.366885, loss_ss: 1.069940, loss_d: 0.296945
0.7305 --- loss: 1.990503, loss_ss: 1.069757, loss_d: 0.920746
0.7689 --- loss: 1.071926, loss_ss: 0.940507, loss_d: 0.131419
0.8074 --- loss: 1.019495, loss_ss: 0.898342, loss_d: 0.121153
0.8458 --- loss: 1.624961, loss_ss: 1.190016, loss_d: 0.434946
0.8843 --- loss: 1.519271, loss_ss: 0.961277, loss_d: 0.557994
0.9227 --- loss: 1.538868, loss_ss: 1.103974, loss_d: 0.434894
0.9612 --- loss: 1.438373, loss_ss: 1.008094, loss_d: 0.430279
0.9996 --- loss: 1.491724, loss_ss: 1.437826, loss_d: 0.053899
Epoch finished! Loss: 1.4741002108042056
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.269275, loss_ss: 1.093768, loss_d: 0.175507
0.0384 --- loss: 1.181465, loss_ss: 0.895261, loss_d: 0.286203
0.0769 --- loss: 1.059170, loss_ss: 0.851874, loss_d: 0.207296
0.1153 --- loss: 1.165821, loss_ss: 1.082126, loss_d: 0.083695
0.1538 --- loss: 1.233991, loss_ss: 0.948306, loss_d: 0.285685
0.1922 --- loss: 1.280900, loss_ss: 0.986362, loss_d: 0.294538
0.2307 --- loss: 1.384967, loss_ss: 0.982459, loss_d: 0.402508
0.2691 --- loss: 1.276702, loss_ss: 0.873908, loss_d: 0.402794
0.3076 --- loss: 1.097376, loss_ss: 0.928449, loss_d: 0.168927
0.3460 --- loss: 1.017902, loss_ss: 0.923685, loss_d: 0.094217
0.3845 --- loss: 1.472651, loss_ss: 1.028885, loss_d: 0.443766
0.4229 --- loss: 1.094372, loss_ss: 0.966988, loss_d: 0.127384
0.4614 --- loss: 1.174219, loss_ss: 1.019718, loss_d: 0.154501
0.4998 --- loss: 1.092923, loss_ss: 0.817682, loss_d: 0.275240
0.5383 --- loss: 1.406875, loss_ss: 0.935142, loss_d: 0.471734
0.5767 --- loss: 1.229804, loss_ss: 1.027603, loss_d: 0.202201
0.6151 --- loss: 1.131341, loss_ss: 0.974885, loss_d: 0.156456
0.6536 --- loss: 1.031914, loss_ss: 0.790369, loss_d: 0.241545
0.6920 --- loss: 1.076622, loss_ss: 0.898001, loss_d: 0.178622
0.7305 --- loss: 1.008017, loss_ss: 0.863594, loss_d: 0.144422
0.7689 --- loss: 1.509145, loss_ss: 1.191265, loss_d: 0.317881
0.8074 --- loss: 1.180749, loss_ss: 0.852814, loss_d: 0.327935
0.8458 --- loss: 1.318533, loss_ss: 0.847641, loss_d: 0.470892
0.8843 --- loss: 1.240298, loss_ss: 1.141945, loss_d: 0.098353
0.9227 --- loss: 1.075281, loss_ss: 0.834599, loss_d: 0.240682
0.9612 --- loss: 2.046469, loss_ss: 1.124636, loss_d: 0.921833
0.9996 --- loss: 2.013491, loss_ss: 2.008321, loss_d: 0.005170
Epoch finished! Loss: 1.2735407437269504
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 0.998350, loss_ss: 0.901839, loss_d: 0.096511
0.0384 --- loss: 1.334464, loss_ss: 1.184004, loss_d: 0.150460
0.0769 --- loss: 1.020302, loss_ss: 0.871144, loss_d: 0.149158
0.1153 --- loss: 1.553359, loss_ss: 1.451105, loss_d: 0.102254
0.1538 --- loss: 1.186729, loss_ss: 0.870872, loss_d: 0.315857
0.1922 --- loss: 1.655394, loss_ss: 1.230226, loss_d: 0.425167
0.2307 --- loss: 1.308978, loss_ss: 0.881208, loss_d: 0.427770
0.2691 --- loss: 0.895052, loss_ss: 0.835315, loss_d: 0.059737
0.3076 --- loss: 1.106942, loss_ss: 0.847936, loss_d: 0.259007
0.3460 --- loss: 1.018476, loss_ss: 0.968882, loss_d: 0.049594
0.3845 --- loss: 1.163640, loss_ss: 1.009145, loss_d: 0.154495
0.4229 --- loss: 0.978991, loss_ss: 0.915540, loss_d: 0.063451
0.4614 --- loss: 1.057425, loss_ss: 0.600867, loss_d: 0.456557
0.4998 --- loss: 1.153757, loss_ss: 0.967403, loss_d: 0.186355
0.5383 --- loss: 1.221675, loss_ss: 1.056972, loss_d: 0.164703
0.5767 --- loss: 1.188087, loss_ss: 0.907195, loss_d: 0.280893
0.6151 --- loss: 0.950852, loss_ss: 0.894162, loss_d: 0.056690
0.6536 --- loss: 1.331048, loss_ss: 0.894336, loss_d: 0.436712
0.6920 --- loss: 1.196339, loss_ss: 0.897045, loss_d: 0.299294
0.7305 --- loss: 0.948163, loss_ss: 0.797711, loss_d: 0.150452
0.7689 --- loss: 1.418128, loss_ss: 1.122154, loss_d: 0.295974
0.8074 --- loss: 1.201262, loss_ss: 1.107240, loss_d: 0.094023
0.8458 --- loss: 1.143673, loss_ss: 0.882809, loss_d: 0.260864
0.8843 --- loss: 1.278338, loss_ss: 0.896213, loss_d: 0.382125
0.9227 --- loss: 1.014796, loss_ss: 0.950228, loss_d: 0.064568
0.9612 --- loss: 1.007808, loss_ss: 0.696565, loss_d: 0.311243
0.9996 --- loss: 1.152736, loss_ss: 1.137843, loss_d: 0.014892
Epoch finished! Loss: 1.1616043707499137
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.304210, loss_ss: 1.089121, loss_d: 0.215090
0.0384 --- loss: 1.107046, loss_ss: 1.029393, loss_d: 0.077653
0.0769 --- loss: 1.314858, loss_ss: 1.206953, loss_d: 0.107905
0.1153 --- loss: 1.116531, loss_ss: 1.060791, loss_d: 0.055740
0.1538 --- loss: 1.025202, loss_ss: 0.911194, loss_d: 0.114008
0.1922 --- loss: 0.863075, loss_ss: 0.817301, loss_d: 0.045773
0.2307 --- loss: 1.400696, loss_ss: 0.967026, loss_d: 0.433670
0.2691 --- loss: 1.083586, loss_ss: 0.942499, loss_d: 0.141087
0.3076 --- loss: 1.592671, loss_ss: 1.152376, loss_d: 0.440295
0.3460 --- loss: 1.477167, loss_ss: 1.038731, loss_d: 0.438436
0.3845 --- loss: 1.097708, loss_ss: 0.856664, loss_d: 0.241044
0.4229 --- loss: 0.960531, loss_ss: 0.921810, loss_d: 0.038720
0.4614 --- loss: 0.926680, loss_ss: 0.716122, loss_d: 0.210558
0.4998 --- loss: 1.277536, loss_ss: 0.725767, loss_d: 0.551769
0.5383 --- loss: 0.985928, loss_ss: 0.882350, loss_d: 0.103578
0.5767 --- loss: 1.027406, loss_ss: 0.971723, loss_d: 0.055682
0.6151 --- loss: 1.065119, loss_ss: 1.025602, loss_d: 0.039516
0.6536 --- loss: 1.315387, loss_ss: 1.184752, loss_d: 0.130635
0.6920 --- loss: 1.341190, loss_ss: 1.143970, loss_d: 0.197219
0.7305 --- loss: 1.006124, loss_ss: 0.822208, loss_d: 0.183916
0.7689 --- loss: 0.884230, loss_ss: 0.809735, loss_d: 0.074495
0.8074 --- loss: 0.966190, loss_ss: 0.891349, loss_d: 0.074841
0.8458 --- loss: 0.882443, loss_ss: 0.739791, loss_d: 0.142653
0.8843 --- loss: 0.946488, loss_ss: 0.866439, loss_d: 0.080049
0.9227 --- loss: 0.705886, loss_ss: 0.664001, loss_d: 0.041884
0.9612 --- loss: 0.743695, loss_ss: 0.705234, loss_d: 0.038461
0.9996 --- loss: 2.919729, loss_ss: 2.916337, loss_d: 0.003391
Epoch finished! Loss: 1.0950686612954506
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.954062, loss_ss: 0.743756, loss_d: 0.210306
0.0384 --- loss: 0.923805, loss_ss: 0.855320, loss_d: 0.068485
0.0769 --- loss: 1.006348, loss_ss: 0.841981, loss_d: 0.164367
0.1153 --- loss: 1.144408, loss_ss: 0.893401, loss_d: 0.251006
0.1538 --- loss: 1.086422, loss_ss: 0.962850, loss_d: 0.123572
0.1922 --- loss: 1.074772, loss_ss: 0.968438, loss_d: 0.106334
0.2307 --- loss: 0.929575, loss_ss: 0.803869, loss_d: 0.125705
0.2691 --- loss: 1.534610, loss_ss: 0.977759, loss_d: 0.556851
0.3076 --- loss: 1.065360, loss_ss: 0.981239, loss_d: 0.084120
0.3460 --- loss: 0.890800, loss_ss: 0.802492, loss_d: 0.088308
0.3845 --- loss: 0.874774, loss_ss: 0.776269, loss_d: 0.098505
0.4229 --- loss: 1.584336, loss_ss: 1.258061, loss_d: 0.326275
0.4614 --- loss: 0.940256, loss_ss: 0.873983, loss_d: 0.066273
0.4998 --- loss: 0.815788, loss_ss: 0.694720, loss_d: 0.121068
0.5383 --- loss: 0.775750, loss_ss: 0.722943, loss_d: 0.052806
0.5767 --- loss: 0.800193, loss_ss: 0.789883, loss_d: 0.010309
0.6151 --- loss: 0.804114, loss_ss: 0.778530, loss_d: 0.025584
0.6536 --- loss: 1.148579, loss_ss: 1.131357, loss_d: 0.017222
0.6920 --- loss: 0.725337, loss_ss: 0.712638, loss_d: 0.012699
0.7305 --- loss: 1.237392, loss_ss: 0.838692, loss_d: 0.398701
0.7689 --- loss: 1.005573, loss_ss: 0.952607, loss_d: 0.052966
0.8074 --- loss: 1.106449, loss_ss: 0.945363, loss_d: 0.161085
0.8458 --- loss: 0.847628, loss_ss: 0.817105, loss_d: 0.030523
0.8843 --- loss: 0.649426, loss_ss: 0.634660, loss_d: 0.014766
0.9227 --- loss: 1.421386, loss_ss: 1.034213, loss_d: 0.387173
0.9612 --- loss: 1.259946, loss_ss: 0.693884, loss_d: 0.566062
0.9996 --- loss: 3.236542, loss_ss: 3.227534, loss_d: 0.009008
Epoch finished! Loss: 1.044721893622325
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.903403, loss_ss: 0.876394, loss_d: 0.027009
0.0384 --- loss: 2.352066, loss_ss: 0.652524, loss_d: 1.699542
0.0769 --- loss: 0.645654, loss_ss: 0.597070, loss_d: 0.048584
0.1153 --- loss: 1.063096, loss_ss: 0.761033, loss_d: 0.302063
0.1538 --- loss: 0.798376, loss_ss: 0.670474, loss_d: 0.127903
0.1922 --- loss: 1.154058, loss_ss: 1.030682, loss_d: 0.123376
0.2307 --- loss: 1.031925, loss_ss: 1.016529, loss_d: 0.015396
0.2691 --- loss: 0.815533, loss_ss: 0.803272, loss_d: 0.012261
0.3076 --- loss: 0.918563, loss_ss: 0.795402, loss_d: 0.123161
0.3460 --- loss: 1.043575, loss_ss: 1.027882, loss_d: 0.015693
0.3845 --- loss: 0.931856, loss_ss: 0.865420, loss_d: 0.066436
0.4229 --- loss: 0.846984, loss_ss: 0.775789, loss_d: 0.071195
0.4614 --- loss: 0.814391, loss_ss: 0.776883, loss_d: 0.037508
0.4998 --- loss: 0.680557, loss_ss: 0.608000, loss_d: 0.072557
0.5383 --- loss: 0.957605, loss_ss: 0.862183, loss_d: 0.095423
0.5767 --- loss: 1.051264, loss_ss: 0.964119, loss_d: 0.087145
0.6151 --- loss: 0.959060, loss_ss: 0.893307, loss_d: 0.065753
0.6536 --- loss: 0.821202, loss_ss: 0.703847, loss_d: 0.117355
0.6920 --- loss: 1.001948, loss_ss: 0.941824, loss_d: 0.060124
0.7305 --- loss: 0.704861, loss_ss: 0.694066, loss_d: 0.010795
0.7689 --- loss: 1.135762, loss_ss: 0.973877, loss_d: 0.161885
0.8074 --- loss: 0.791959, loss_ss: 0.753873, loss_d: 0.038086
0.8458 --- loss: 0.673192, loss_ss: 0.635873, loss_d: 0.037319
0.8843 --- loss: 0.920109, loss_ss: 0.782455, loss_d: 0.137654
0.9227 --- loss: 0.807317, loss_ss: 0.794528, loss_d: 0.012789
0.9612 --- loss: 0.727080, loss_ss: 0.702208, loss_d: 0.024872
0.9996 --- loss: 0.955151, loss_ss: 0.953548, loss_d: 0.001603
Epoch finished! Loss: 0.9969908067813287
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.057517, loss_ss: 1.024259, loss_d: 0.033258
0.0384 --- loss: 1.091074, loss_ss: 1.037195, loss_d: 0.053879
0.0769 --- loss: 0.987136, loss_ss: 0.872792, loss_d: 0.114344
0.1153 --- loss: 1.926152, loss_ss: 0.662264, loss_d: 1.263888
0.1538 --- loss: 1.057600, loss_ss: 0.880979, loss_d: 0.176621
0.1922 --- loss: 0.969551, loss_ss: 0.931042, loss_d: 0.038508
0.2307 --- loss: 0.622947, loss_ss: 0.587746, loss_d: 0.035201
0.2691 --- loss: 1.072268, loss_ss: 0.942184, loss_d: 0.130084
0.3076 --- loss: 1.091872, loss_ss: 1.079479, loss_d: 0.012393
0.3460 --- loss: 1.061043, loss_ss: 1.046683, loss_d: 0.014359
0.3845 --- loss: 0.778912, loss_ss: 0.738749, loss_d: 0.040163
0.4229 --- loss: 0.862857, loss_ss: 0.834796, loss_d: 0.028061
0.4614 --- loss: 1.048121, loss_ss: 0.780806, loss_d: 0.267314
0.4998 --- loss: 0.924257, loss_ss: 0.908556, loss_d: 0.015701
0.5383 --- loss: 1.360914, loss_ss: 1.115570, loss_d: 0.245344
0.5767 --- loss: 0.941852, loss_ss: 0.928962, loss_d: 0.012890
0.6151 --- loss: 1.032208, loss_ss: 0.931076, loss_d: 0.101132
0.6536 --- loss: 0.594242, loss_ss: 0.517988, loss_d: 0.076254
0.6920 --- loss: 0.980789, loss_ss: 0.897285, loss_d: 0.083504
0.7305 --- loss: 0.965353, loss_ss: 0.927853, loss_d: 0.037500
0.7689 --- loss: 0.795485, loss_ss: 0.707352, loss_d: 0.088133
0.8074 --- loss: 0.819335, loss_ss: 0.778147, loss_d: 0.041189
0.8458 --- loss: 1.981862, loss_ss: 0.827048, loss_d: 1.154814
0.8843 --- loss: 0.800533, loss_ss: 0.743445, loss_d: 0.057088
0.9227 --- loss: 0.821945, loss_ss: 0.798680, loss_d: 0.023265
0.9612 --- loss: 1.101112, loss_ss: 0.858016, loss_d: 0.243096
0.9996 --- loss: 1.296203, loss_ss: 1.293879, loss_d: 0.002324
Epoch finished! Loss: 0.9918304248498037
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.755535, loss_ss: 0.701315, loss_d: 0.054219
0.0384 --- loss: 1.030926, loss_ss: 0.904251, loss_d: 0.126675
0.0769 --- loss: 0.861277, loss_ss: 0.801552, loss_d: 0.059724
0.1153 --- loss: 0.952293, loss_ss: 0.897175, loss_d: 0.055118
0.1538 --- loss: 0.843895, loss_ss: 0.833303, loss_d: 0.010592
0.1922 --- loss: 1.008617, loss_ss: 0.819445, loss_d: 0.189172
0.2307 --- loss: 0.589823, loss_ss: 0.567198, loss_d: 0.022625
0.2691 --- loss: 0.919467, loss_ss: 0.815806, loss_d: 0.103661
0.3076 --- loss: 0.671538, loss_ss: 0.652408, loss_d: 0.019130
0.3460 --- loss: 0.586284, loss_ss: 0.573495, loss_d: 0.012789
0.3845 --- loss: 0.830476, loss_ss: 0.813337, loss_d: 0.017139
0.4229 --- loss: 0.798843, loss_ss: 0.777080, loss_d: 0.021763
0.4614 --- loss: 0.643237, loss_ss: 0.620267, loss_d: 0.022971
0.4998 --- loss: 0.871019, loss_ss: 0.816862, loss_d: 0.054157
0.5383 --- loss: 0.850410, loss_ss: 0.727176, loss_d: 0.123234
0.5767 --- loss: 0.810168, loss_ss: 0.787157, loss_d: 0.023012
0.6151 --- loss: 0.770468, loss_ss: 0.679367, loss_d: 0.091100
0.6536 --- loss: 1.533008, loss_ss: 0.834056, loss_d: 0.698952
0.6920 --- loss: 0.860292, loss_ss: 0.850315, loss_d: 0.009977
0.7305 --- loss: 0.865692, loss_ss: 0.694702, loss_d: 0.170989
0.7689 --- loss: 0.700889, loss_ss: 0.669435, loss_d: 0.031454
0.8074 --- loss: 1.574237, loss_ss: 1.033196, loss_d: 0.541040
0.8458 --- loss: 0.963854, loss_ss: 0.693930, loss_d: 0.269924
0.8843 --- loss: 0.975520, loss_ss: 0.510114, loss_d: 0.465406
0.9227 --- loss: 1.177605, loss_ss: 1.140401, loss_d: 0.037203
0.9612 --- loss: 1.035066, loss_ss: 0.955362, loss_d: 0.079704
0.9996 --- loss: 5.949387, loss_ss: 0.711605, loss_d: 5.237782
Epoch finished! Loss: 0.984034888790204
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.820391, loss_ss: 0.805420, loss_d: 0.014971
0.0384 --- loss: 1.441044, loss_ss: 0.887745, loss_d: 0.553299
0.0769 --- loss: 1.237599, loss_ss: 0.723018, loss_d: 0.514581
0.1153 --- loss: 1.095314, loss_ss: 0.920581, loss_d: 0.174733
0.1538 --- loss: 0.865096, loss_ss: 0.838595, loss_d: 0.026500
0.1922 --- loss: 0.814448, loss_ss: 0.740412, loss_d: 0.074036
0.2307 --- loss: 0.708566, loss_ss: 0.686838, loss_d: 0.021727
0.2691 --- loss: 0.788911, loss_ss: 0.781922, loss_d: 0.006989
0.3076 --- loss: 1.055671, loss_ss: 1.020179, loss_d: 0.035492
0.3460 --- loss: 1.018530, loss_ss: 0.846805, loss_d: 0.171725
0.3845 --- loss: 1.229229, loss_ss: 0.918685, loss_d: 0.310544
0.4229 --- loss: 0.764667, loss_ss: 0.757694, loss_d: 0.006972
0.4614 --- loss: 1.351239, loss_ss: 1.336455, loss_d: 0.014784
0.4998 --- loss: 0.964211, loss_ss: 0.628902, loss_d: 0.335310
0.5383 --- loss: 0.956454, loss_ss: 0.865856, loss_d: 0.090598
0.5767 --- loss: 1.158622, loss_ss: 0.839642, loss_d: 0.318980
0.6151 --- loss: 0.626420, loss_ss: 0.603926, loss_d: 0.022493
0.6536 --- loss: 0.634699, loss_ss: 0.618542, loss_d: 0.016157
0.6920 --- loss: 0.932967, loss_ss: 0.886636, loss_d: 0.046330
0.7305 --- loss: 0.840551, loss_ss: 0.831901, loss_d: 0.008650
0.7689 --- loss: 0.675280, loss_ss: 0.661805, loss_d: 0.013475
0.8074 --- loss: 0.874446, loss_ss: 0.802073, loss_d: 0.072372
0.8458 --- loss: 1.126515, loss_ss: 0.670670, loss_d: 0.455845
0.8843 --- loss: 1.043287, loss_ss: 0.621002, loss_d: 0.422285
0.9227 --- loss: 0.698238, loss_ss: 0.690238, loss_d: 0.008000
0.9612 --- loss: 0.981777, loss_ss: 0.934589, loss_d: 0.047188
0.9996 --- loss: 7.990099, loss_ss: 1.077035, loss_d: 6.913064
Epoch finished! Loss: 0.9504967310107671
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6477477477477478
             precision    recall  f1-score   support

        0.0       0.95      0.47      0.63       211
        1.0       0.47      0.12      0.19       184
        2.0       0.81      0.87      0.84       408
        3.0       0.71      0.71      0.71       130
        4.0       0.39      0.86      0.53       177

avg / total       0.70      0.65      0.63      1110
 


====== chp055-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.55  47.39   99.44  95.24     63.29
1  83.15  11.96   97.30  46.81     19.05
2  87.66  86.52   88.32  81.15     83.75
3  93.15  70.77   96.12  70.77     70.77
4  76.04  85.88   74.17  38.68     53.33
Total accuracy: 64.77%
Average sen: 60.50%
Average spec: 91.07%
Macro f1-score: 58.04%
Diagnosis acc on 15mins: 0.918918918918919
[0.99766731 0.96985328 0.4614535  0.32350311 0.99453545 0.77188575
 0.97133327 0.856592   0.89293563 0.98555785 0.97924042 0.97177595
 0.48943943 0.54435891 0.98359251 0.99033397 0.98029113 0.95855403
 0.98372066 0.98811954 0.97613144 0.94671553 0.9752686  0.99383104
 0.98265302 0.87336564 0.79304546 0.7329911  0.91688555 0.96730965
 0.99696892 0.89650738 0.99402726 0.89904022 0.87590283 0.53109205
 0.90744376]
pred: 0.8744303559934771, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.304143, loss_ss: 1.631289, loss_d: 0.672855
0.0384 --- loss: 2.114319, loss_ss: 1.603805, loss_d: 0.510514
0.0769 --- loss: 1.728548, loss_ss: 1.292723, loss_d: 0.435825
0.1153 --- loss: 2.636907, loss_ss: 1.512049, loss_d: 1.124858
0.1537 --- loss: 1.908062, loss_ss: 1.444075, loss_d: 0.463987
0.1922 --- loss: 1.870347, loss_ss: 1.293733, loss_d: 0.576614
0.2306 --- loss: 2.476732, loss_ss: 1.526591, loss_d: 0.950141
0.2690 --- loss: 1.856996, loss_ss: 1.328601, loss_d: 0.528394
0.3075 --- loss: 1.665776, loss_ss: 1.164715, loss_d: 0.501061
0.3459 --- loss: 1.988068, loss_ss: 1.226642, loss_d: 0.761426
0.3843 --- loss: 2.092458, loss_ss: 1.399294, loss_d: 0.693165
0.4228 --- loss: 1.813969, loss_ss: 1.241283, loss_d: 0.572685
0.4612 --- loss: 1.837905, loss_ss: 1.207227, loss_d: 0.630678
0.4996 --- loss: 1.802178, loss_ss: 1.191291, loss_d: 0.610887
0.5380 --- loss: 1.793447, loss_ss: 1.329415, loss_d: 0.464032
0.5765 --- loss: 1.649552, loss_ss: 1.259860, loss_d: 0.389691
0.6149 --- loss: 1.971579, loss_ss: 1.334079, loss_d: 0.637500
0.6533 --- loss: 1.900350, loss_ss: 1.290930, loss_d: 0.609420
0.6918 --- loss: 1.966420, loss_ss: 1.411291, loss_d: 0.555129
0.7302 --- loss: 1.679032, loss_ss: 1.393304, loss_d: 0.285728
0.7686 --- loss: 1.675789, loss_ss: 1.137822, loss_d: 0.537968
0.8071 --- loss: 1.697675, loss_ss: 1.143403, loss_d: 0.554272
0.8455 --- loss: 1.509145, loss_ss: 1.158195, loss_d: 0.350950
0.8839 --- loss: 1.722022, loss_ss: 1.177428, loss_d: 0.544594
0.9224 --- loss: 1.858868, loss_ss: 1.210875, loss_d: 0.647993
0.9608 --- loss: 1.296858, loss_ss: 1.079636, loss_d: 0.217222
0.9992 --- loss: 2.495348, loss_ss: 1.437922, loss_d: 1.057427
Epoch finished! Loss: 1.872540650000939
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.599251, loss_ss: 1.237343, loss_d: 0.361908
0.0384 --- loss: 1.314268, loss_ss: 0.996136, loss_d: 0.318132
0.0769 --- loss: 1.743802, loss_ss: 1.467979, loss_d: 0.275823
0.1153 --- loss: 1.675805, loss_ss: 1.054845, loss_d: 0.620960
0.1537 --- loss: 1.277015, loss_ss: 1.084747, loss_d: 0.192268
0.1922 --- loss: 1.690444, loss_ss: 1.061088, loss_d: 0.629356
0.2306 --- loss: 1.498684, loss_ss: 1.145530, loss_d: 0.353153
0.2690 --- loss: 1.238567, loss_ss: 1.052788, loss_d: 0.185779
0.3075 --- loss: 1.447277, loss_ss: 1.120836, loss_d: 0.326442
0.3459 --- loss: 1.484636, loss_ss: 1.003088, loss_d: 0.481548
0.3843 --- loss: 1.840199, loss_ss: 1.130208, loss_d: 0.709991
0.4228 --- loss: 1.584079, loss_ss: 1.147235, loss_d: 0.436843
0.4612 --- loss: 1.409261, loss_ss: 1.076766, loss_d: 0.332495
0.4996 --- loss: 1.180225, loss_ss: 0.915725, loss_d: 0.264500
0.5380 --- loss: 1.686317, loss_ss: 1.310956, loss_d: 0.375361
0.5765 --- loss: 1.507109, loss_ss: 1.063688, loss_d: 0.443421
0.6149 --- loss: 1.203141, loss_ss: 0.954351, loss_d: 0.248790
0.6533 --- loss: 1.126703, loss_ss: 0.982919, loss_d: 0.143784
0.6918 --- loss: 1.383087, loss_ss: 1.063000, loss_d: 0.320087
0.7302 --- loss: 1.212641, loss_ss: 0.912428, loss_d: 0.300213
0.7686 --- loss: 1.584503, loss_ss: 1.195774, loss_d: 0.388729
0.8071 --- loss: 1.590823, loss_ss: 1.130610, loss_d: 0.460213
0.8455 --- loss: 1.263979, loss_ss: 1.012370, loss_d: 0.251609
0.8839 --- loss: 1.654100, loss_ss: 1.234084, loss_d: 0.420016
0.9224 --- loss: 1.488168, loss_ss: 1.274824, loss_d: 0.213344
0.9608 --- loss: 1.352126, loss_ss: 0.758638, loss_d: 0.593488
0.9992 --- loss: 1.137726, loss_ss: 1.002104, loss_d: 0.135622
Epoch finished! Loss: 1.478110130245869
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.208185, loss_ss: 1.036422, loss_d: 0.171764
0.0384 --- loss: 1.690556, loss_ss: 0.893939, loss_d: 0.796617
0.0769 --- loss: 1.011044, loss_ss: 0.890486, loss_d: 0.120558
0.1153 --- loss: 1.215969, loss_ss: 0.857212, loss_d: 0.358757
0.1537 --- loss: 1.496408, loss_ss: 1.267912, loss_d: 0.228496
0.1922 --- loss: 1.216169, loss_ss: 0.836727, loss_d: 0.379442
0.2306 --- loss: 1.012134, loss_ss: 0.693755, loss_d: 0.318379
0.2690 --- loss: 1.520671, loss_ss: 0.980475, loss_d: 0.540196
0.3075 --- loss: 1.156866, loss_ss: 0.974833, loss_d: 0.182033
0.3459 --- loss: 1.024756, loss_ss: 0.761097, loss_d: 0.263658
0.3843 --- loss: 1.519353, loss_ss: 1.189437, loss_d: 0.329915
0.4228 --- loss: 1.080048, loss_ss: 0.799396, loss_d: 0.280651
0.4612 --- loss: 1.486946, loss_ss: 1.044089, loss_d: 0.442856
0.4996 --- loss: 1.451368, loss_ss: 1.103272, loss_d: 0.348096
0.5380 --- loss: 1.730879, loss_ss: 1.332207, loss_d: 0.398672
0.5765 --- loss: 0.794815, loss_ss: 0.712088, loss_d: 0.082726
0.6149 --- loss: 1.907518, loss_ss: 1.377594, loss_d: 0.529924
0.6533 --- loss: 1.104096, loss_ss: 0.837157, loss_d: 0.266939
0.6918 --- loss: 1.378061, loss_ss: 1.266793, loss_d: 0.111268
0.7302 --- loss: 1.178739, loss_ss: 0.984237, loss_d: 0.194502
0.7686 --- loss: 1.303303, loss_ss: 1.084786, loss_d: 0.218517
0.8071 --- loss: 1.030301, loss_ss: 0.957139, loss_d: 0.073162
0.8455 --- loss: 1.074256, loss_ss: 0.871835, loss_d: 0.202421
0.8839 --- loss: 1.391671, loss_ss: 0.941691, loss_d: 0.449980
0.9224 --- loss: 0.877371, loss_ss: 0.739818, loss_d: 0.137553
0.9608 --- loss: 1.648430, loss_ss: 1.237167, loss_d: 0.411263
0.9992 --- loss: 1.362084, loss_ss: 1.338015, loss_d: 0.024069
Epoch finished! Loss: 1.2835372782670535
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.074094, loss_ss: 0.998179, loss_d: 0.075915
0.0384 --- loss: 1.152828, loss_ss: 1.058608, loss_d: 0.094220
0.0769 --- loss: 1.335046, loss_ss: 1.032299, loss_d: 0.302747
0.1153 --- loss: 1.302933, loss_ss: 1.080566, loss_d: 0.222367
0.1537 --- loss: 1.111994, loss_ss: 1.034734, loss_d: 0.077259
0.1922 --- loss: 0.999816, loss_ss: 0.750660, loss_d: 0.249156
0.2306 --- loss: 1.205496, loss_ss: 0.936218, loss_d: 0.269279
0.2690 --- loss: 1.067215, loss_ss: 1.006302, loss_d: 0.060912
0.3075 --- loss: 1.680218, loss_ss: 1.515485, loss_d: 0.164733
0.3459 --- loss: 1.581352, loss_ss: 0.837282, loss_d: 0.744070
0.3843 --- loss: 1.290989, loss_ss: 1.161255, loss_d: 0.129734
0.4228 --- loss: 1.339477, loss_ss: 0.954950, loss_d: 0.384527
0.4612 --- loss: 1.034307, loss_ss: 0.938403, loss_d: 0.095904
0.4996 --- loss: 1.026556, loss_ss: 0.826657, loss_d: 0.199898
0.5380 --- loss: 1.149390, loss_ss: 0.915688, loss_d: 0.233702
0.5765 --- loss: 1.189078, loss_ss: 0.759285, loss_d: 0.429793
0.6149 --- loss: 1.009578, loss_ss: 0.836745, loss_d: 0.172833
0.6533 --- loss: 1.006414, loss_ss: 0.882119, loss_d: 0.124295
0.6918 --- loss: 0.920261, loss_ss: 0.874244, loss_d: 0.046017
0.7302 --- loss: 1.752056, loss_ss: 1.243513, loss_d: 0.508543
0.7686 --- loss: 1.542244, loss_ss: 1.289776, loss_d: 0.252468
0.8071 --- loss: 1.486949, loss_ss: 1.334431, loss_d: 0.152519
0.8455 --- loss: 1.420394, loss_ss: 1.363272, loss_d: 0.057122
0.8839 --- loss: 1.002294, loss_ss: 0.879614, loss_d: 0.122679
0.9224 --- loss: 1.001662, loss_ss: 0.853837, loss_d: 0.147825
0.9608 --- loss: 1.140311, loss_ss: 0.759372, loss_d: 0.380939
0.9992 --- loss: 1.649800, loss_ss: 1.646342, loss_d: 0.003458
Epoch finished! Loss: 1.1832565307617187
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.077205, loss_ss: 0.729122, loss_d: 0.348083
0.0384 --- loss: 1.310948, loss_ss: 0.969447, loss_d: 0.341501
0.0769 --- loss: 1.027444, loss_ss: 0.973958, loss_d: 0.053486
0.1153 --- loss: 1.028182, loss_ss: 0.725737, loss_d: 0.302445
0.1537 --- loss: 0.982419, loss_ss: 0.902844, loss_d: 0.079575
0.1922 --- loss: 0.895753, loss_ss: 0.805626, loss_d: 0.090127
0.2306 --- loss: 1.432781, loss_ss: 0.801628, loss_d: 0.631152
0.2690 --- loss: 0.789955, loss_ss: 0.649239, loss_d: 0.140716
0.3075 --- loss: 0.899304, loss_ss: 0.770456, loss_d: 0.128848
0.3459 --- loss: 1.081659, loss_ss: 0.829727, loss_d: 0.251933
0.3843 --- loss: 1.596142, loss_ss: 1.333738, loss_d: 0.262404
0.4228 --- loss: 1.223794, loss_ss: 1.204564, loss_d: 0.019230
0.4612 --- loss: 1.149505, loss_ss: 0.774427, loss_d: 0.375078
0.4996 --- loss: 1.372439, loss_ss: 1.035324, loss_d: 0.337114
0.5380 --- loss: 1.013695, loss_ss: 0.967860, loss_d: 0.045835
0.5765 --- loss: 0.974156, loss_ss: 0.736369, loss_d: 0.237787
0.6149 --- loss: 1.263610, loss_ss: 1.040791, loss_d: 0.222818
0.6533 --- loss: 1.499032, loss_ss: 0.863986, loss_d: 0.635046
0.6918 --- loss: 1.559906, loss_ss: 0.970056, loss_d: 0.589850
0.7302 --- loss: 0.880350, loss_ss: 0.692088, loss_d: 0.188262
0.7686 --- loss: 1.157854, loss_ss: 0.929798, loss_d: 0.228056
0.8071 --- loss: 1.250128, loss_ss: 1.092672, loss_d: 0.157456
0.8455 --- loss: 0.930431, loss_ss: 0.781839, loss_d: 0.148591
0.8839 --- loss: 1.347623, loss_ss: 1.143940, loss_d: 0.203683
0.9224 --- loss: 0.842284, loss_ss: 0.798505, loss_d: 0.043779
0.9608 --- loss: 0.700096, loss_ss: 0.663049, loss_d: 0.037046
0.9992 --- loss: 1.187841, loss_ss: 1.177804, loss_d: 0.010038
Epoch finished! Loss: 1.113712396300756
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.071416, loss_ss: 0.773813, loss_d: 0.297603
0.0384 --- loss: 1.018817, loss_ss: 0.909944, loss_d: 0.108873
0.0769 --- loss: 0.920933, loss_ss: 0.827071, loss_d: 0.093862
0.1153 --- loss: 1.141479, loss_ss: 1.000333, loss_d: 0.141147
0.1537 --- loss: 0.632325, loss_ss: 0.596703, loss_d: 0.035622
0.1922 --- loss: 1.492716, loss_ss: 1.410907, loss_d: 0.081809
0.2306 --- loss: 1.351527, loss_ss: 0.591378, loss_d: 0.760149
0.2690 --- loss: 1.189273, loss_ss: 1.169681, loss_d: 0.019592
0.3075 --- loss: 1.247452, loss_ss: 0.868716, loss_d: 0.378737
0.3459 --- loss: 1.251586, loss_ss: 1.200969, loss_d: 0.050617
0.3843 --- loss: 0.993794, loss_ss: 0.925962, loss_d: 0.067831
0.4228 --- loss: 1.155302, loss_ss: 1.042092, loss_d: 0.113210
0.4612 --- loss: 1.053726, loss_ss: 0.962142, loss_d: 0.091584
0.4996 --- loss: 0.858035, loss_ss: 0.781445, loss_d: 0.076590
0.5380 --- loss: 1.055426, loss_ss: 0.779782, loss_d: 0.275644
0.5765 --- loss: 1.073002, loss_ss: 1.021694, loss_d: 0.051308
0.6149 --- loss: 0.852955, loss_ss: 0.832607, loss_d: 0.020348
0.6533 --- loss: 0.625588, loss_ss: 0.591075, loss_d: 0.034513
0.6918 --- loss: 0.981327, loss_ss: 0.952174, loss_d: 0.029153
0.7302 --- loss: 1.066970, loss_ss: 1.019226, loss_d: 0.047745
0.7686 --- loss: 1.156674, loss_ss: 1.056422, loss_d: 0.100253
0.8071 --- loss: 1.160960, loss_ss: 0.993459, loss_d: 0.167500
0.8455 --- loss: 1.236354, loss_ss: 1.040792, loss_d: 0.195562
0.8839 --- loss: 0.813741, loss_ss: 0.712807, loss_d: 0.100935
0.9224 --- loss: 1.160060, loss_ss: 1.025816, loss_d: 0.134244
0.9608 --- loss: 1.258637, loss_ss: 0.814601, loss_d: 0.444036
0.9992 --- loss: 5.056039, loss_ss: 2.041888, loss_d: 3.014151
Epoch finished! Loss: 1.0524807480665355
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.978366, loss_ss: 0.939122, loss_d: 0.039244
0.0384 --- loss: 1.091878, loss_ss: 1.002688, loss_d: 0.089190
0.0769 --- loss: 0.910232, loss_ss: 0.869815, loss_d: 0.040417
0.1153 --- loss: 0.829149, loss_ss: 0.795441, loss_d: 0.033708
0.1537 --- loss: 0.952484, loss_ss: 0.890176, loss_d: 0.062307
0.1922 --- loss: 1.008583, loss_ss: 0.707036, loss_d: 0.301547
0.2306 --- loss: 0.684432, loss_ss: 0.610862, loss_d: 0.073570
0.2690 --- loss: 0.917002, loss_ss: 0.904531, loss_d: 0.012471
0.3075 --- loss: 0.759856, loss_ss: 0.701782, loss_d: 0.058074
0.3459 --- loss: 0.973920, loss_ss: 0.936103, loss_d: 0.037818
0.3843 --- loss: 0.945235, loss_ss: 0.639696, loss_d: 0.305540
0.4228 --- loss: 1.037731, loss_ss: 0.936005, loss_d: 0.101726
0.4612 --- loss: 0.901776, loss_ss: 0.821262, loss_d: 0.080514
0.4996 --- loss: 1.204388, loss_ss: 1.123887, loss_d: 0.080501
0.5380 --- loss: 1.413047, loss_ss: 0.937991, loss_d: 0.475056
0.5765 --- loss: 0.921332, loss_ss: 0.834098, loss_d: 0.087233
0.6149 --- loss: 1.003057, loss_ss: 0.981890, loss_d: 0.021167
0.6533 --- loss: 1.207406, loss_ss: 1.125882, loss_d: 0.081525
0.6918 --- loss: 0.992034, loss_ss: 0.667263, loss_d: 0.324771
0.7302 --- loss: 1.310672, loss_ss: 1.262946, loss_d: 0.047726
0.7686 --- loss: 1.375146, loss_ss: 1.316029, loss_d: 0.059116
0.8071 --- loss: 0.817151, loss_ss: 0.805493, loss_d: 0.011658
0.8455 --- loss: 1.367691, loss_ss: 1.234745, loss_d: 0.132946
0.8839 --- loss: 1.312386, loss_ss: 1.239391, loss_d: 0.072995
0.9224 --- loss: 1.531118, loss_ss: 0.904811, loss_d: 0.626307
0.9608 --- loss: 0.797073, loss_ss: 0.705466, loss_d: 0.091607
0.9992 --- loss: 2.584505, loss_ss: 2.569782, loss_d: 0.014723
Epoch finished! Loss: 1.0066922584405311
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.224225, loss_ss: 1.195796, loss_d: 0.028428
0.0384 --- loss: 0.939600, loss_ss: 0.666222, loss_d: 0.273379
0.0769 --- loss: 1.265085, loss_ss: 1.170257, loss_d: 0.094827
0.1153 --- loss: 0.627155, loss_ss: 0.617671, loss_d: 0.009484
0.1537 --- loss: 0.682473, loss_ss: 0.633346, loss_d: 0.049127
0.1922 --- loss: 1.193286, loss_ss: 0.471733, loss_d: 0.721553
0.2306 --- loss: 0.995821, loss_ss: 0.983733, loss_d: 0.012088
0.2690 --- loss: 1.676162, loss_ss: 0.841013, loss_d: 0.835149
0.3075 --- loss: 0.692546, loss_ss: 0.675727, loss_d: 0.016818
0.3459 --- loss: 1.072353, loss_ss: 1.044564, loss_d: 0.027789
0.3843 --- loss: 0.889287, loss_ss: 0.722479, loss_d: 0.166808
0.4228 --- loss: 1.158369, loss_ss: 1.001890, loss_d: 0.156479
0.4612 --- loss: 0.625703, loss_ss: 0.594218, loss_d: 0.031485
0.4996 --- loss: 1.057241, loss_ss: 1.033692, loss_d: 0.023549
0.5380 --- loss: 0.691551, loss_ss: 0.663648, loss_d: 0.027903
0.5765 --- loss: 0.645635, loss_ss: 0.634052, loss_d: 0.011584
0.6149 --- loss: 1.185750, loss_ss: 0.673300, loss_d: 0.512449
0.6533 --- loss: 0.877900, loss_ss: 0.824309, loss_d: 0.053590
0.6918 --- loss: 0.901764, loss_ss: 0.750636, loss_d: 0.151128
0.7302 --- loss: 0.972347, loss_ss: 0.957400, loss_d: 0.014947
0.7686 --- loss: 0.916302, loss_ss: 0.863578, loss_d: 0.052724
0.8071 --- loss: 1.416720, loss_ss: 1.087866, loss_d: 0.328855
0.8455 --- loss: 1.074948, loss_ss: 0.938935, loss_d: 0.136013
0.8839 --- loss: 1.374987, loss_ss: 0.913381, loss_d: 0.461605
0.9224 --- loss: 0.959003, loss_ss: 0.805283, loss_d: 0.153720
0.9608 --- loss: 1.121016, loss_ss: 0.933524, loss_d: 0.187492
0.9992 --- loss: 1.742802, loss_ss: 1.738422, loss_d: 0.004380
Epoch finished! Loss: 0.9784995989157603
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.379988, loss_ss: 1.021124, loss_d: 0.358865
0.0384 --- loss: 0.808270, loss_ss: 0.779197, loss_d: 0.029073
0.0769 --- loss: 0.729373, loss_ss: 0.659332, loss_d: 0.070041
0.1153 --- loss: 0.757538, loss_ss: 0.729401, loss_d: 0.028137
0.1537 --- loss: 1.077515, loss_ss: 1.040367, loss_d: 0.037148
0.1922 --- loss: 0.667132, loss_ss: 0.637816, loss_d: 0.029315
0.2306 --- loss: 0.872029, loss_ss: 0.783988, loss_d: 0.088042
0.2690 --- loss: 1.020981, loss_ss: 1.017143, loss_d: 0.003838
0.3075 --- loss: 0.854513, loss_ss: 0.810852, loss_d: 0.043661
0.3459 --- loss: 0.624377, loss_ss: 0.620590, loss_d: 0.003787
0.3843 --- loss: 1.058933, loss_ss: 1.001351, loss_d: 0.057582
0.4228 --- loss: 0.920010, loss_ss: 0.912832, loss_d: 0.007178
0.4612 --- loss: 0.969305, loss_ss: 0.895110, loss_d: 0.074195
0.4996 --- loss: 0.954234, loss_ss: 0.924803, loss_d: 0.029431
0.5380 --- loss: 1.054554, loss_ss: 0.733180, loss_d: 0.321373
0.5765 --- loss: 0.854209, loss_ss: 0.840171, loss_d: 0.014038
0.6149 --- loss: 0.787338, loss_ss: 0.783437, loss_d: 0.003901
0.6533 --- loss: 0.874068, loss_ss: 0.855686, loss_d: 0.018381
0.6918 --- loss: 0.735089, loss_ss: 0.726589, loss_d: 0.008500
0.7302 --- loss: 0.931140, loss_ss: 0.911199, loss_d: 0.019942
0.7686 --- loss: 1.207021, loss_ss: 0.761327, loss_d: 0.445693
0.8071 --- loss: 1.082668, loss_ss: 1.036673, loss_d: 0.045995
0.8455 --- loss: 0.769176, loss_ss: 0.523380, loss_d: 0.245796
0.8839 --- loss: 1.114801, loss_ss: 1.049952, loss_d: 0.064849
0.9224 --- loss: 0.574072, loss_ss: 0.564832, loss_d: 0.009240
0.9608 --- loss: 0.694894, loss_ss: 0.655708, loss_d: 0.039186
0.9992 --- loss: 4.251796, loss_ss: 1.489408, loss_d: 2.762388
Epoch finished! Loss: 0.9438262909650803
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.956579, loss_ss: 0.952121, loss_d: 0.004458
0.0384 --- loss: 1.281515, loss_ss: 1.118976, loss_d: 0.162539
0.0769 --- loss: 0.981609, loss_ss: 0.562187, loss_d: 0.419422
0.1153 --- loss: 0.872997, loss_ss: 0.849971, loss_d: 0.023026
0.1537 --- loss: 0.852465, loss_ss: 0.819308, loss_d: 0.033157
0.1922 --- loss: 0.696142, loss_ss: 0.680202, loss_d: 0.015940
0.2306 --- loss: 0.873538, loss_ss: 0.848531, loss_d: 0.025006
0.2690 --- loss: 1.015695, loss_ss: 0.887399, loss_d: 0.128295
0.3075 --- loss: 0.775338, loss_ss: 0.723539, loss_d: 0.051799
0.3459 --- loss: 0.753225, loss_ss: 0.742799, loss_d: 0.010427
0.3843 --- loss: 0.770226, loss_ss: 0.705529, loss_d: 0.064697
0.4228 --- loss: 1.067855, loss_ss: 0.847796, loss_d: 0.220059
0.4612 --- loss: 0.551103, loss_ss: 0.513782, loss_d: 0.037321
0.4996 --- loss: 0.971274, loss_ss: 0.720537, loss_d: 0.250736
0.5380 --- loss: 1.983899, loss_ss: 1.208799, loss_d: 0.775100
0.5765 --- loss: 0.704634, loss_ss: 0.700518, loss_d: 0.004116
0.6149 --- loss: 1.423091, loss_ss: 1.008011, loss_d: 0.415080
0.6533 --- loss: 0.915388, loss_ss: 0.874824, loss_d: 0.040565
0.6918 --- loss: 0.797181, loss_ss: 0.767558, loss_d: 0.029623
0.7302 --- loss: 0.745059, loss_ss: 0.683711, loss_d: 0.061348
0.7686 --- loss: 0.601605, loss_ss: 0.567138, loss_d: 0.034467
0.8071 --- loss: 1.064602, loss_ss: 0.797546, loss_d: 0.267056
0.8455 --- loss: 0.948102, loss_ss: 0.934293, loss_d: 0.013808
0.8839 --- loss: 1.046400, loss_ss: 0.860575, loss_d: 0.185825
0.9224 --- loss: 1.205086, loss_ss: 0.821501, loss_d: 0.383585
0.9608 --- loss: 1.020540, loss_ss: 0.915680, loss_d: 0.104860
0.9992 --- loss: 2.886404, loss_ss: 2.871525, loss_d: 0.014879
Epoch finished! Loss: 0.9331251543301803
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6296296296296297
             precision    recall  f1-score   support

        0.0       0.33      0.76      0.46        78
        1.0       0.68      0.07      0.12       284
        2.0       0.57      0.88      0.69       258
        3.0       0.91      0.97      0.94       185
        4.0       0.70      0.71      0.70       275

avg / total       0.67      0.63      0.57      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.13  75.64   88.02  32.96     45.91
1  74.63   6.69   98.87  67.86     12.18
2  81.30  88.37   79.08  57.00     69.30
3  97.96  97.30   98.10  91.37     94.24
4  84.91  70.55   89.81  70.29     70.42
Total accuracy: 62.96%
Average sen: 67.71%
Average spec: 90.78%
Macro f1-score: 58.41%
Diagnosis acc on 15mins: 1.0
[0.86577517 0.99039233 0.98875779 0.99257916 0.9488852  0.98023009
 0.98962003 0.99462962 0.98213953 0.98545343 0.99784684 0.99758375
 0.99768257 0.88226193 0.9972921  0.99982977 0.99996912 0.99992979
 0.98874414 0.99491799 0.99904662 0.99280292 0.99647141 0.99271858
 0.97789335 0.98963493 0.98606735 0.98970675 0.95590484 0.99563426
 0.99857485 0.9998523  0.99997306 0.99856782 0.98387778 0.99395084]
pred: 0.9840332782930798, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.209840, loss_ss: 1.570441, loss_d: 0.639398
0.0385 --- loss: 2.048572, loss_ss: 1.435394, loss_d: 0.613178
0.0770 --- loss: 1.997079, loss_ss: 1.476540, loss_d: 0.520539
0.1154 --- loss: 2.528719, loss_ss: 1.357478, loss_d: 1.171241
0.1539 --- loss: 1.777647, loss_ss: 1.141092, loss_d: 0.636556
0.1924 --- loss: 1.787439, loss_ss: 1.237715, loss_d: 0.549724
0.2309 --- loss: 1.828162, loss_ss: 1.285858, loss_d: 0.542304
0.2693 --- loss: 1.903170, loss_ss: 1.141095, loss_d: 0.762074
0.3078 --- loss: 1.806816, loss_ss: 1.252486, loss_d: 0.554331
0.3463 --- loss: 1.480637, loss_ss: 1.051284, loss_d: 0.429353
0.3848 --- loss: 1.680851, loss_ss: 1.176328, loss_d: 0.504523
0.4232 --- loss: 1.731175, loss_ss: 1.200633, loss_d: 0.530541
0.4617 --- loss: 1.484399, loss_ss: 1.213063, loss_d: 0.271337
0.5002 --- loss: 1.746697, loss_ss: 1.078599, loss_d: 0.668098
0.5387 --- loss: 1.865529, loss_ss: 1.233194, loss_d: 0.632335
0.5771 --- loss: 1.606869, loss_ss: 1.183263, loss_d: 0.423606
0.6156 --- loss: 1.962964, loss_ss: 1.567111, loss_d: 0.395853
0.6541 --- loss: 1.998476, loss_ss: 1.286845, loss_d: 0.711630
0.6926 --- loss: 2.137614, loss_ss: 1.251902, loss_d: 0.885712
0.7311 --- loss: 1.702403, loss_ss: 1.104819, loss_d: 0.597584
0.7695 --- loss: 1.651156, loss_ss: 1.234573, loss_d: 0.416583
0.8080 --- loss: 1.955515, loss_ss: 1.307052, loss_d: 0.648463
0.8465 --- loss: 2.062985, loss_ss: 1.320854, loss_d: 0.742131
0.8850 --- loss: 1.453986, loss_ss: 1.025133, loss_d: 0.428853
0.9234 --- loss: 1.826597, loss_ss: 1.355157, loss_d: 0.471440
0.9619 --- loss: 1.466939, loss_ss: 1.096404, loss_d: 0.370535
Epoch finished! Loss: 1.8428880901410312
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.059707, loss_ss: 1.547773, loss_d: 0.511934
0.0385 --- loss: 1.515042, loss_ss: 1.116205, loss_d: 0.398838
0.0770 --- loss: 1.578865, loss_ss: 1.215536, loss_d: 0.363328
0.1154 --- loss: 1.355336, loss_ss: 1.147751, loss_d: 0.207585
0.1539 --- loss: 1.586307, loss_ss: 1.053593, loss_d: 0.532714
0.1924 --- loss: 1.321346, loss_ss: 0.938897, loss_d: 0.382450
0.2309 --- loss: 1.549253, loss_ss: 1.121127, loss_d: 0.428126
0.2693 --- loss: 1.330419, loss_ss: 1.056634, loss_d: 0.273785
0.3078 --- loss: 1.305927, loss_ss: 1.051786, loss_d: 0.254141
0.3463 --- loss: 1.175266, loss_ss: 0.931890, loss_d: 0.243376
0.3848 --- loss: 1.553188, loss_ss: 1.143188, loss_d: 0.410000
0.4232 --- loss: 1.736331, loss_ss: 1.333838, loss_d: 0.402493
0.4617 --- loss: 1.897567, loss_ss: 1.364352, loss_d: 0.533215
0.5002 --- loss: 1.650534, loss_ss: 1.029232, loss_d: 0.621302
0.5387 --- loss: 1.278949, loss_ss: 0.985533, loss_d: 0.293416
0.5771 --- loss: 1.593091, loss_ss: 1.289957, loss_d: 0.303133
0.6156 --- loss: 1.130297, loss_ss: 0.961665, loss_d: 0.168632
0.6541 --- loss: 2.034251, loss_ss: 1.193129, loss_d: 0.841121
0.6926 --- loss: 1.536402, loss_ss: 1.078870, loss_d: 0.457532
0.7311 --- loss: 1.147456, loss_ss: 0.854482, loss_d: 0.292974
0.7695 --- loss: 1.269145, loss_ss: 1.096485, loss_d: 0.172661
0.8080 --- loss: 1.081200, loss_ss: 0.932442, loss_d: 0.148759
0.8465 --- loss: 1.400828, loss_ss: 1.032308, loss_d: 0.368520
0.8850 --- loss: 1.396526, loss_ss: 0.997055, loss_d: 0.399470
0.9234 --- loss: 1.251039, loss_ss: 1.024398, loss_d: 0.226641
0.9619 --- loss: 1.199709, loss_ss: 0.952811, loss_d: 0.246898
Epoch finished! Loss: 1.4828168917806912
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.366993, loss_ss: 1.013638, loss_d: 0.353355
0.0385 --- loss: 1.431869, loss_ss: 1.184406, loss_d: 0.247463
0.0770 --- loss: 1.354917, loss_ss: 0.913824, loss_d: 0.441093
0.1154 --- loss: 1.230761, loss_ss: 1.000746, loss_d: 0.230015
0.1539 --- loss: 1.360757, loss_ss: 1.002944, loss_d: 0.357813
0.1924 --- loss: 1.029405, loss_ss: 0.777068, loss_d: 0.252338
0.2309 --- loss: 1.475157, loss_ss: 0.961796, loss_d: 0.513362
0.2693 --- loss: 1.168488, loss_ss: 0.800177, loss_d: 0.368311
0.3078 --- loss: 1.363371, loss_ss: 1.074286, loss_d: 0.289085
0.3463 --- loss: 1.222663, loss_ss: 1.081662, loss_d: 0.141002
0.3848 --- loss: 1.438630, loss_ss: 0.988035, loss_d: 0.450595
0.4232 --- loss: 1.200795, loss_ss: 1.056866, loss_d: 0.143929
0.4617 --- loss: 1.530182, loss_ss: 1.056513, loss_d: 0.473669
0.5002 --- loss: 1.382719, loss_ss: 1.153138, loss_d: 0.229581
0.5387 --- loss: 1.088774, loss_ss: 0.823405, loss_d: 0.265369
0.5771 --- loss: 0.903819, loss_ss: 0.776012, loss_d: 0.127807
0.6156 --- loss: 1.100524, loss_ss: 1.032570, loss_d: 0.067954
0.6541 --- loss: 2.430464, loss_ss: 1.094338, loss_d: 1.336126
0.6926 --- loss: 1.248762, loss_ss: 0.949946, loss_d: 0.298816
0.7311 --- loss: 1.445318, loss_ss: 0.751966, loss_d: 0.693351
0.7695 --- loss: 1.196478, loss_ss: 0.891853, loss_d: 0.304625
0.8080 --- loss: 1.415844, loss_ss: 1.138566, loss_d: 0.277279
0.8465 --- loss: 1.065952, loss_ss: 1.004418, loss_d: 0.061534
0.8850 --- loss: 1.165406, loss_ss: 0.833696, loss_d: 0.331710
0.9234 --- loss: 1.103349, loss_ss: 0.928941, loss_d: 0.174408
0.9619 --- loss: 1.109645, loss_ss: 0.922014, loss_d: 0.187630
Epoch finished! Loss: 1.3046584532067582
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.289374, loss_ss: 0.977461, loss_d: 0.311913
0.0385 --- loss: 1.007620, loss_ss: 0.870141, loss_d: 0.137479
0.0770 --- loss: 1.296686, loss_ss: 1.138392, loss_d: 0.158294
0.1154 --- loss: 1.410137, loss_ss: 0.904011, loss_d: 0.506126
0.1539 --- loss: 1.339816, loss_ss: 1.045766, loss_d: 0.294050
0.1924 --- loss: 1.307234, loss_ss: 1.141855, loss_d: 0.165378
0.2309 --- loss: 1.060126, loss_ss: 0.951031, loss_d: 0.109095
0.2693 --- loss: 1.251769, loss_ss: 1.042522, loss_d: 0.209247
0.3078 --- loss: 1.769624, loss_ss: 1.290231, loss_d: 0.479393
0.3463 --- loss: 1.289046, loss_ss: 0.970863, loss_d: 0.318182
0.3848 --- loss: 1.181108, loss_ss: 0.943655, loss_d: 0.237453
0.4232 --- loss: 1.175585, loss_ss: 0.889488, loss_d: 0.286096
0.4617 --- loss: 1.238610, loss_ss: 0.831014, loss_d: 0.407595
0.5002 --- loss: 1.226052, loss_ss: 1.091192, loss_d: 0.134860
0.5387 --- loss: 1.404119, loss_ss: 1.191440, loss_d: 0.212679
0.5771 --- loss: 1.389043, loss_ss: 1.224482, loss_d: 0.164560
0.6156 --- loss: 1.455283, loss_ss: 1.284020, loss_d: 0.171262
0.6541 --- loss: 1.341874, loss_ss: 0.917222, loss_d: 0.424651
0.6926 --- loss: 1.240707, loss_ss: 1.064530, loss_d: 0.176177
0.7311 --- loss: 1.398624, loss_ss: 1.086537, loss_d: 0.312087
0.7695 --- loss: 1.484619, loss_ss: 1.075078, loss_d: 0.409541
0.8080 --- loss: 1.146635, loss_ss: 1.079919, loss_d: 0.066716
0.8465 --- loss: 1.565829, loss_ss: 1.060437, loss_d: 0.505391
0.8850 --- loss: 0.747058, loss_ss: 0.561325, loss_d: 0.185733
0.9234 --- loss: 1.636162, loss_ss: 1.073666, loss_d: 0.562497
0.9619 --- loss: 1.231417, loss_ss: 0.907239, loss_d: 0.324178
Epoch finished! Loss: 1.1812845157840537
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.162431, loss_ss: 1.093149, loss_d: 0.069282
0.0385 --- loss: 0.964541, loss_ss: 0.902813, loss_d: 0.061728
0.0770 --- loss: 1.212851, loss_ss: 0.846905, loss_d: 0.365947
0.1154 --- loss: 1.161123, loss_ss: 1.036949, loss_d: 0.124174
0.1539 --- loss: 1.593496, loss_ss: 1.241838, loss_d: 0.351657
0.1924 --- loss: 0.823457, loss_ss: 0.770377, loss_d: 0.053080
0.2309 --- loss: 1.148267, loss_ss: 0.934854, loss_d: 0.213413
0.2693 --- loss: 1.001466, loss_ss: 0.795081, loss_d: 0.206385
0.3078 --- loss: 0.855745, loss_ss: 0.792697, loss_d: 0.063049
0.3463 --- loss: 0.809566, loss_ss: 0.784230, loss_d: 0.025336
0.3848 --- loss: 0.949997, loss_ss: 0.889352, loss_d: 0.060645
0.4232 --- loss: 1.055008, loss_ss: 0.794592, loss_d: 0.260417
0.4617 --- loss: 0.942445, loss_ss: 0.866360, loss_d: 0.076085
0.5002 --- loss: 1.219124, loss_ss: 1.112723, loss_d: 0.106401
0.5387 --- loss: 1.135978, loss_ss: 0.993406, loss_d: 0.142572
0.5771 --- loss: 1.140700, loss_ss: 0.912500, loss_d: 0.228200
0.6156 --- loss: 1.016560, loss_ss: 0.838401, loss_d: 0.178159
0.6541 --- loss: 1.183277, loss_ss: 1.011133, loss_d: 0.172143
0.6926 --- loss: 0.778736, loss_ss: 0.740705, loss_d: 0.038031
0.7311 --- loss: 1.148216, loss_ss: 0.954435, loss_d: 0.193781
0.7695 --- loss: 0.888980, loss_ss: 0.800497, loss_d: 0.088483
0.8080 --- loss: 0.979330, loss_ss: 0.888559, loss_d: 0.090771
0.8465 --- loss: 0.938245, loss_ss: 0.888718, loss_d: 0.049527
0.8850 --- loss: 1.057377, loss_ss: 0.702119, loss_d: 0.355258
0.9234 --- loss: 1.338051, loss_ss: 1.161919, loss_d: 0.176132
0.9619 --- loss: 0.746375, loss_ss: 0.649118, loss_d: 0.097257
Epoch finished! Loss: 1.130174000520964
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.966942, loss_ss: 0.903283, loss_d: 0.063659
0.0385 --- loss: 0.971271, loss_ss: 0.905321, loss_d: 0.065950
0.0770 --- loss: 1.175955, loss_ss: 1.106450, loss_d: 0.069505
0.1154 --- loss: 1.159445, loss_ss: 1.050691, loss_d: 0.108754
0.1539 --- loss: 1.350936, loss_ss: 0.908506, loss_d: 0.442430
0.1924 --- loss: 0.708052, loss_ss: 0.659878, loss_d: 0.048174
0.2309 --- loss: 0.770326, loss_ss: 0.749122, loss_d: 0.021204
0.2693 --- loss: 1.469817, loss_ss: 0.770366, loss_d: 0.699452
0.3078 --- loss: 1.288717, loss_ss: 1.049478, loss_d: 0.239239
0.3463 --- loss: 1.096354, loss_ss: 0.955518, loss_d: 0.140837
0.3848 --- loss: 1.376380, loss_ss: 0.994782, loss_d: 0.381598
0.4232 --- loss: 1.003747, loss_ss: 0.872490, loss_d: 0.131257
0.4617 --- loss: 0.939836, loss_ss: 0.915195, loss_d: 0.024642
0.5002 --- loss: 1.334119, loss_ss: 1.283582, loss_d: 0.050537
0.5387 --- loss: 1.298101, loss_ss: 0.933050, loss_d: 0.365051
0.5771 --- loss: 0.784383, loss_ss: 0.736697, loss_d: 0.047687
0.6156 --- loss: 0.925577, loss_ss: 0.885245, loss_d: 0.040331
0.6541 --- loss: 1.072987, loss_ss: 1.019293, loss_d: 0.053694
0.6926 --- loss: 1.066229, loss_ss: 1.039355, loss_d: 0.026874
0.7311 --- loss: 0.947930, loss_ss: 0.845059, loss_d: 0.102872
0.7695 --- loss: 1.846269, loss_ss: 1.030447, loss_d: 0.815821
0.8080 --- loss: 1.096929, loss_ss: 0.847367, loss_d: 0.249562
0.8465 --- loss: 0.980174, loss_ss: 0.903739, loss_d: 0.076434
0.8850 --- loss: 1.077563, loss_ss: 0.995425, loss_d: 0.082139
0.9234 --- loss: 1.072562, loss_ss: 0.873172, loss_d: 0.199391
0.9619 --- loss: 1.025787, loss_ss: 0.844206, loss_d: 0.181581
Epoch finished! Loss: 1.0794759586050704
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.009389, loss_ss: 0.876273, loss_d: 0.133116
0.0385 --- loss: 1.208307, loss_ss: 1.078778, loss_d: 0.129529
0.0770 --- loss: 0.848743, loss_ss: 0.775772, loss_d: 0.072971
0.1154 --- loss: 0.791775, loss_ss: 0.729351, loss_d: 0.062423
0.1539 --- loss: 1.293670, loss_ss: 0.833944, loss_d: 0.459726
0.1924 --- loss: 0.790826, loss_ss: 0.641537, loss_d: 0.149289
0.2309 --- loss: 0.800242, loss_ss: 0.744136, loss_d: 0.056106
0.2693 --- loss: 0.919286, loss_ss: 0.846144, loss_d: 0.073142
0.3078 --- loss: 0.835020, loss_ss: 0.637853, loss_d: 0.197167
0.3463 --- loss: 1.363080, loss_ss: 1.175044, loss_d: 0.188036
0.3848 --- loss: 1.245506, loss_ss: 0.921397, loss_d: 0.324109
0.4232 --- loss: 0.785717, loss_ss: 0.737362, loss_d: 0.048355
0.4617 --- loss: 0.974645, loss_ss: 0.684217, loss_d: 0.290428
0.5002 --- loss: 1.129932, loss_ss: 0.898774, loss_d: 0.231159
0.5387 --- loss: 1.026675, loss_ss: 0.889772, loss_d: 0.136903
0.5771 --- loss: 0.790241, loss_ss: 0.745620, loss_d: 0.044622
0.6156 --- loss: 1.133214, loss_ss: 0.710751, loss_d: 0.422463
0.6541 --- loss: 1.267759, loss_ss: 1.005647, loss_d: 0.262112
0.6926 --- loss: 1.067283, loss_ss: 1.042473, loss_d: 0.024810
0.7311 --- loss: 0.844133, loss_ss: 0.761383, loss_d: 0.082750
0.7695 --- loss: 0.758652, loss_ss: 0.727394, loss_d: 0.031258
0.8080 --- loss: 0.669039, loss_ss: 0.631241, loss_d: 0.037799
0.8465 --- loss: 1.131224, loss_ss: 1.032219, loss_d: 0.099005
0.8850 --- loss: 0.917869, loss_ss: 0.903109, loss_d: 0.014760
0.9234 --- loss: 0.598406, loss_ss: 0.550661, loss_d: 0.047744
0.9619 --- loss: 0.828930, loss_ss: 0.701440, loss_d: 0.127490
Epoch finished! Loss: 1.011547445790648
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.853727, loss_ss: 0.813891, loss_d: 0.039836
0.0385 --- loss: 1.086036, loss_ss: 1.068681, loss_d: 0.017355
0.0770 --- loss: 0.878436, loss_ss: 0.857622, loss_d: 0.020814
0.1154 --- loss: 0.819607, loss_ss: 0.776382, loss_d: 0.043225
0.1539 --- loss: 1.047681, loss_ss: 1.000640, loss_d: 0.047041
0.1924 --- loss: 1.480671, loss_ss: 0.794289, loss_d: 0.686382
0.2309 --- loss: 1.021013, loss_ss: 0.619913, loss_d: 0.401099
0.2693 --- loss: 1.027947, loss_ss: 0.998322, loss_d: 0.029624
0.3078 --- loss: 0.648474, loss_ss: 0.622539, loss_d: 0.025935
0.3463 --- loss: 0.926537, loss_ss: 0.798319, loss_d: 0.128218
0.3848 --- loss: 0.917586, loss_ss: 0.907712, loss_d: 0.009875
0.4232 --- loss: 0.850816, loss_ss: 0.844787, loss_d: 0.006029
0.4617 --- loss: 0.726504, loss_ss: 0.713453, loss_d: 0.013051
0.5002 --- loss: 1.245764, loss_ss: 1.237046, loss_d: 0.008718
0.5387 --- loss: 0.995892, loss_ss: 0.985703, loss_d: 0.010189
0.5771 --- loss: 1.072282, loss_ss: 0.975404, loss_d: 0.096879
0.6156 --- loss: 0.960851, loss_ss: 0.558591, loss_d: 0.402259
0.6541 --- loss: 1.237928, loss_ss: 0.722682, loss_d: 0.515246
0.6926 --- loss: 1.031931, loss_ss: 0.957581, loss_d: 0.074350
0.7311 --- loss: 0.798908, loss_ss: 0.736254, loss_d: 0.062654
0.7695 --- loss: 0.812759, loss_ss: 0.726058, loss_d: 0.086701
0.8080 --- loss: 0.961229, loss_ss: 0.937040, loss_d: 0.024188
0.8465 --- loss: 0.839166, loss_ss: 0.830966, loss_d: 0.008200
0.8850 --- loss: 0.988985, loss_ss: 0.899107, loss_d: 0.089878
0.9234 --- loss: 0.619173, loss_ss: 0.607352, loss_d: 0.011821
0.9619 --- loss: 0.601974, loss_ss: 0.592025, loss_d: 0.009948
Epoch finished! Loss: 0.9782840193008364
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.842983, loss_ss: 0.820491, loss_d: 0.022492
0.0385 --- loss: 0.731685, loss_ss: 0.721566, loss_d: 0.010119
0.0770 --- loss: 0.871385, loss_ss: 0.857344, loss_d: 0.014041
0.1154 --- loss: 0.931752, loss_ss: 0.815643, loss_d: 0.116109
0.1539 --- loss: 1.300888, loss_ss: 0.800888, loss_d: 0.500000
0.1924 --- loss: 1.119674, loss_ss: 0.772105, loss_d: 0.347569
0.2309 --- loss: 0.871103, loss_ss: 0.858569, loss_d: 0.012534
0.2693 --- loss: 1.247316, loss_ss: 1.238305, loss_d: 0.009012
0.3078 --- loss: 0.936828, loss_ss: 0.927008, loss_d: 0.009820
0.3463 --- loss: 1.194208, loss_ss: 0.852973, loss_d: 0.341236
0.3848 --- loss: 0.814114, loss_ss: 0.645977, loss_d: 0.168137
0.4232 --- loss: 1.036557, loss_ss: 0.897752, loss_d: 0.138805
0.4617 --- loss: 0.962140, loss_ss: 0.950787, loss_d: 0.011354
0.5002 --- loss: 0.730554, loss_ss: 0.668841, loss_d: 0.061713
0.5387 --- loss: 0.950875, loss_ss: 0.516407, loss_d: 0.434468
0.5771 --- loss: 0.782186, loss_ss: 0.774367, loss_d: 0.007819
0.6156 --- loss: 0.911303, loss_ss: 0.577991, loss_d: 0.333312
0.6541 --- loss: 1.176777, loss_ss: 1.122968, loss_d: 0.053809
0.6926 --- loss: 0.912046, loss_ss: 0.859154, loss_d: 0.052892
0.7311 --- loss: 0.828401, loss_ss: 0.711007, loss_d: 0.117394
0.7695 --- loss: 1.269144, loss_ss: 1.063553, loss_d: 0.205590
0.8080 --- loss: 1.236541, loss_ss: 1.116726, loss_d: 0.119815
0.8465 --- loss: 0.936804, loss_ss: 0.787429, loss_d: 0.149376
0.8850 --- loss: 0.835826, loss_ss: 0.782211, loss_d: 0.053615
0.9234 --- loss: 1.207239, loss_ss: 1.104527, loss_d: 0.102712
0.9619 --- loss: 0.820495, loss_ss: 0.785576, loss_d: 0.034919
Epoch finished! Loss: 0.9789944788203736
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.945364, loss_ss: 0.873923, loss_d: 0.071440
0.0385 --- loss: 0.672154, loss_ss: 0.547416, loss_d: 0.124739
0.0770 --- loss: 1.305811, loss_ss: 1.074383, loss_d: 0.231428
0.1154 --- loss: 0.779157, loss_ss: 0.698586, loss_d: 0.080571
0.1539 --- loss: 0.844829, loss_ss: 0.809114, loss_d: 0.035715
0.1924 --- loss: 0.816511, loss_ss: 0.772033, loss_d: 0.044477
0.2309 --- loss: 0.930408, loss_ss: 0.865933, loss_d: 0.064475
0.2693 --- loss: 0.912448, loss_ss: 0.889917, loss_d: 0.022531
0.3078 --- loss: 0.933580, loss_ss: 0.921188, loss_d: 0.012392
0.3463 --- loss: 1.330507, loss_ss: 1.162597, loss_d: 0.167910
0.3848 --- loss: 1.238391, loss_ss: 0.955922, loss_d: 0.282469
0.4232 --- loss: 0.786484, loss_ss: 0.777519, loss_d: 0.008965
0.4617 --- loss: 0.673641, loss_ss: 0.637625, loss_d: 0.036016
0.5002 --- loss: 0.961386, loss_ss: 0.947589, loss_d: 0.013797
0.5387 --- loss: 0.896580, loss_ss: 0.831230, loss_d: 0.065350
0.5771 --- loss: 0.655703, loss_ss: 0.649373, loss_d: 0.006330
0.6156 --- loss: 1.047887, loss_ss: 0.677204, loss_d: 0.370683
0.6541 --- loss: 0.924478, loss_ss: 0.910713, loss_d: 0.013764
0.6926 --- loss: 1.216112, loss_ss: 0.829382, loss_d: 0.386731
0.7311 --- loss: 1.075781, loss_ss: 0.991467, loss_d: 0.084313
0.7695 --- loss: 1.014971, loss_ss: 0.794108, loss_d: 0.220863
0.8080 --- loss: 0.723419, loss_ss: 0.629250, loss_d: 0.094169
0.8465 --- loss: 0.911443, loss_ss: 0.904443, loss_d: 0.006999
0.8850 --- loss: 0.962000, loss_ss: 0.838606, loss_d: 0.123395
0.9234 --- loss: 0.811163, loss_ss: 0.790108, loss_d: 0.021055
0.9619 --- loss: 1.091144, loss_ss: 0.723573, loss_d: 0.367571
Epoch finished! Loss: 0.9119685490158994
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.76732249786142
             precision    recall  f1-score   support

        0.0       0.71      0.83      0.77       267
        1.0       0.46      0.24      0.32       152
        2.0       0.80      0.89      0.84       496
        3.0       0.94      0.61      0.74        74
        4.0       0.85      0.85      0.85       180

avg / total       0.75      0.77      0.75      1169
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.45  83.15   90.02  71.15     76.68
1  86.40  24.34   95.67  45.68     31.76
2  85.97  88.71   83.95  80.29     84.29
3  97.26  60.81   99.73  93.75     73.77
4  95.38  85.00   97.27  85.00     85.00
Total accuracy: 76.73%
Average sen: 68.40%
Average spec: 93.33%
Macro f1-score: 70.30%
Diagnosis acc on 15mins: 1.0
[0.99979788 0.98917973 0.9998939  0.99207628 0.99976057 0.99987102
 0.99998462 0.99997306 0.9992975  0.99990118 0.99999809 0.99902248
 1.         0.99989688 1.         0.99999976 0.99998951 0.99980539
 1.         0.99973887 0.99960679 0.99999988 0.99999416 0.99983442
 0.99975759 0.99843687 0.9993149  0.99999726 0.99996126 0.9999299
 0.99999917 1.         0.99999976 0.99770856 0.99990988 0.99957615
 0.99994767 0.99983203 0.99954957]
pred: 0.9992703214669839, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.314652, loss_ss: 1.581391, loss_d: 0.733262
0.0384 --- loss: 2.005453, loss_ss: 1.481236, loss_d: 0.524217
0.0768 --- loss: 2.241573, loss_ss: 1.654497, loss_d: 0.587076
0.1152 --- loss: 2.114063, loss_ss: 1.588544, loss_d: 0.525519
0.1536 --- loss: 1.871828, loss_ss: 1.477402, loss_d: 0.394426
0.1920 --- loss: 1.855228, loss_ss: 1.391368, loss_d: 0.463861
0.2304 --- loss: 1.887753, loss_ss: 1.332202, loss_d: 0.555551
0.2688 --- loss: 1.912302, loss_ss: 1.396245, loss_d: 0.516057
0.3072 --- loss: 1.884164, loss_ss: 1.352540, loss_d: 0.531625
0.3456 --- loss: 2.166921, loss_ss: 1.303136, loss_d: 0.863785
0.3840 --- loss: 2.302915, loss_ss: 1.413040, loss_d: 0.889874
0.4224 --- loss: 1.679929, loss_ss: 1.206159, loss_d: 0.473770
0.4608 --- loss: 1.843386, loss_ss: 1.260813, loss_d: 0.582573
0.4992 --- loss: 1.918266, loss_ss: 1.273099, loss_d: 0.645167
0.5376 --- loss: 1.567514, loss_ss: 1.069448, loss_d: 0.498066
0.5760 --- loss: 1.668883, loss_ss: 1.271964, loss_d: 0.396919
0.6144 --- loss: 1.784219, loss_ss: 1.275889, loss_d: 0.508330
0.6528 --- loss: 2.188683, loss_ss: 1.384541, loss_d: 0.804143
0.6912 --- loss: 1.575797, loss_ss: 1.240813, loss_d: 0.334984
0.7296 --- loss: 1.700807, loss_ss: 1.197690, loss_d: 0.503118
0.7680 --- loss: 2.064904, loss_ss: 1.376532, loss_d: 0.688372
0.8065 --- loss: 1.585645, loss_ss: 1.007805, loss_d: 0.577841
0.8449 --- loss: 1.794598, loss_ss: 1.366568, loss_d: 0.428029
0.8833 --- loss: 2.159547, loss_ss: 1.578467, loss_d: 0.581080
0.9217 --- loss: 1.583374, loss_ss: 1.199862, loss_d: 0.383512
0.9601 --- loss: 1.464797, loss_ss: 1.102753, loss_d: 0.362044
0.9985 --- loss: 1.805880, loss_ss: 1.528159, loss_d: 0.277721
Epoch finished! Loss: 1.873585004072923
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.307202, loss_ss: 1.107921, loss_d: 0.199281
0.0384 --- loss: 1.622099, loss_ss: 1.298422, loss_d: 0.323677
0.0768 --- loss: 1.180802, loss_ss: 0.903440, loss_d: 0.277362
0.1152 --- loss: 1.525187, loss_ss: 1.010594, loss_d: 0.514593
0.1536 --- loss: 1.323079, loss_ss: 1.045622, loss_d: 0.277457
0.1920 --- loss: 1.269529, loss_ss: 0.977983, loss_d: 0.291546
0.2304 --- loss: 1.367153, loss_ss: 1.028355, loss_d: 0.338798
0.2688 --- loss: 1.357652, loss_ss: 1.052054, loss_d: 0.305597
0.3072 --- loss: 1.428216, loss_ss: 1.188507, loss_d: 0.239708
0.3456 --- loss: 1.640943, loss_ss: 1.075369, loss_d: 0.565574
0.3840 --- loss: 1.450610, loss_ss: 1.001522, loss_d: 0.449088
0.4224 --- loss: 1.401798, loss_ss: 1.064266, loss_d: 0.337532
0.4608 --- loss: 1.513218, loss_ss: 1.122435, loss_d: 0.390784
0.4992 --- loss: 2.184135, loss_ss: 1.262198, loss_d: 0.921937
0.5376 --- loss: 1.365256, loss_ss: 1.036572, loss_d: 0.328684
0.5760 --- loss: 1.551697, loss_ss: 1.227850, loss_d: 0.323846
0.6144 --- loss: 1.351638, loss_ss: 0.986396, loss_d: 0.365242
0.6528 --- loss: 1.537000, loss_ss: 0.888911, loss_d: 0.648089
0.6912 --- loss: 1.140423, loss_ss: 0.944251, loss_d: 0.196172
0.7296 --- loss: 1.379356, loss_ss: 1.050856, loss_d: 0.328500
0.7680 --- loss: 1.421689, loss_ss: 1.107352, loss_d: 0.314337
0.8065 --- loss: 1.522667, loss_ss: 0.953641, loss_d: 0.569025
0.8449 --- loss: 1.178429, loss_ss: 1.088105, loss_d: 0.090325
0.8833 --- loss: 1.064818, loss_ss: 0.863463, loss_d: 0.201356
0.9217 --- loss: 1.442110, loss_ss: 1.019406, loss_d: 0.422704
0.9601 --- loss: 1.160915, loss_ss: 0.887424, loss_d: 0.273491
0.9985 --- loss: 2.776311, loss_ss: 1.619296, loss_d: 1.157015
Epoch finished! Loss: 1.4576628102706028
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.458379, loss_ss: 1.173797, loss_d: 0.284583
0.0384 --- loss: 1.144916, loss_ss: 1.022112, loss_d: 0.122804
0.0768 --- loss: 1.176332, loss_ss: 0.903142, loss_d: 0.273189
0.1152 --- loss: 1.289521, loss_ss: 0.823811, loss_d: 0.465710
0.1536 --- loss: 1.547930, loss_ss: 1.130259, loss_d: 0.417670
0.1920 --- loss: 1.628664, loss_ss: 1.306598, loss_d: 0.322066
0.2304 --- loss: 0.952757, loss_ss: 0.784902, loss_d: 0.167855
0.2688 --- loss: 1.151785, loss_ss: 1.044411, loss_d: 0.107374
0.3072 --- loss: 1.647647, loss_ss: 1.251144, loss_d: 0.396503
0.3456 --- loss: 1.130298, loss_ss: 0.962835, loss_d: 0.167464
0.3840 --- loss: 1.216337, loss_ss: 1.128337, loss_d: 0.088000
0.4224 --- loss: 1.016232, loss_ss: 0.850933, loss_d: 0.165299
0.4608 --- loss: 1.375265, loss_ss: 0.885301, loss_d: 0.489964
0.4992 --- loss: 1.210035, loss_ss: 1.013901, loss_d: 0.196134
0.5376 --- loss: 1.059539, loss_ss: 0.816517, loss_d: 0.243022
0.5760 --- loss: 1.279124, loss_ss: 1.077601, loss_d: 0.201523
0.6144 --- loss: 1.026693, loss_ss: 0.960388, loss_d: 0.066305
0.6528 --- loss: 0.835787, loss_ss: 0.760710, loss_d: 0.075077
0.6912 --- loss: 1.013367, loss_ss: 0.958091, loss_d: 0.055275
0.7296 --- loss: 1.115308, loss_ss: 1.060324, loss_d: 0.054984
0.7680 --- loss: 1.073794, loss_ss: 0.894936, loss_d: 0.178859
0.8065 --- loss: 1.180267, loss_ss: 1.083197, loss_d: 0.097071
0.8449 --- loss: 1.165002, loss_ss: 0.829912, loss_d: 0.335090
0.8833 --- loss: 1.471423, loss_ss: 1.024148, loss_d: 0.447275
0.9217 --- loss: 1.303321, loss_ss: 0.986739, loss_d: 0.316582
0.9601 --- loss: 0.920762, loss_ss: 0.828479, loss_d: 0.092283
0.9985 --- loss: 1.631047, loss_ss: 1.566433, loss_d: 0.064614
Epoch finished! Loss: 1.2454509281195127
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.212698, loss_ss: 0.928201, loss_d: 0.284496
0.0384 --- loss: 0.955881, loss_ss: 0.719746, loss_d: 0.236135
0.0768 --- loss: 1.253375, loss_ss: 0.966711, loss_d: 0.286664
0.1152 --- loss: 1.254103, loss_ss: 0.770699, loss_d: 0.483404
0.1536 --- loss: 1.369838, loss_ss: 0.895023, loss_d: 0.474814
0.1920 --- loss: 0.956302, loss_ss: 0.789463, loss_d: 0.166839
0.2304 --- loss: 0.942728, loss_ss: 0.836241, loss_d: 0.106486
0.2688 --- loss: 1.472793, loss_ss: 1.123177, loss_d: 0.349616
0.3072 --- loss: 0.852095, loss_ss: 0.777639, loss_d: 0.074456
0.3456 --- loss: 1.329182, loss_ss: 1.013054, loss_d: 0.316128
0.3840 --- loss: 1.334205, loss_ss: 1.000885, loss_d: 0.333320
0.4224 --- loss: 1.335406, loss_ss: 1.078795, loss_d: 0.256611
0.4608 --- loss: 0.993239, loss_ss: 0.901507, loss_d: 0.091732
0.4992 --- loss: 0.836073, loss_ss: 0.768384, loss_d: 0.067689
0.5376 --- loss: 0.994269, loss_ss: 0.855777, loss_d: 0.138492
0.5760 --- loss: 1.183630, loss_ss: 0.883655, loss_d: 0.299974
0.6144 --- loss: 1.060555, loss_ss: 0.915618, loss_d: 0.144936
0.6528 --- loss: 0.985098, loss_ss: 0.925448, loss_d: 0.059650
0.6912 --- loss: 1.487079, loss_ss: 1.461435, loss_d: 0.025644
0.7296 --- loss: 1.863245, loss_ss: 0.819991, loss_d: 1.043254
0.7680 --- loss: 0.863231, loss_ss: 0.787422, loss_d: 0.075809
0.8065 --- loss: 1.037649, loss_ss: 0.953408, loss_d: 0.084241
0.8449 --- loss: 1.109229, loss_ss: 0.640566, loss_d: 0.468664
0.8833 --- loss: 0.915111, loss_ss: 0.849621, loss_d: 0.065490
0.9217 --- loss: 1.028392, loss_ss: 0.797647, loss_d: 0.230744
0.9601 --- loss: 1.294145, loss_ss: 1.233806, loss_d: 0.060339
0.9985 --- loss: 1.755067, loss_ss: 1.558084, loss_d: 0.196984
Epoch finished! Loss: 1.1878927735181954
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.989077, loss_ss: 0.924721, loss_d: 0.064356
0.0384 --- loss: 0.915130, loss_ss: 0.809406, loss_d: 0.105724
0.0768 --- loss: 1.807783, loss_ss: 1.575646, loss_d: 0.232137
0.1152 --- loss: 1.026355, loss_ss: 0.944124, loss_d: 0.082231
0.1536 --- loss: 0.961916, loss_ss: 0.873469, loss_d: 0.088447
0.1920 --- loss: 1.068702, loss_ss: 0.715058, loss_d: 0.353644
0.2304 --- loss: 1.179206, loss_ss: 1.098867, loss_d: 0.080339
0.2688 --- loss: 0.762368, loss_ss: 0.612977, loss_d: 0.149391
0.3072 --- loss: 1.760877, loss_ss: 1.406601, loss_d: 0.354276
0.3456 --- loss: 1.181232, loss_ss: 0.568897, loss_d: 0.612336
0.3840 --- loss: 1.144112, loss_ss: 0.953953, loss_d: 0.190159
0.4224 --- loss: 1.010534, loss_ss: 0.866082, loss_d: 0.144452
0.4608 --- loss: 1.036578, loss_ss: 0.958455, loss_d: 0.078123
0.4992 --- loss: 1.366918, loss_ss: 1.089558, loss_d: 0.277361
0.5376 --- loss: 0.989480, loss_ss: 0.814489, loss_d: 0.174991
0.5760 --- loss: 0.925319, loss_ss: 0.825063, loss_d: 0.100256
0.6144 --- loss: 1.733556, loss_ss: 0.901930, loss_d: 0.831626
0.6528 --- loss: 0.958761, loss_ss: 0.883915, loss_d: 0.074846
0.6912 --- loss: 1.014662, loss_ss: 0.981465, loss_d: 0.033196
0.7296 --- loss: 1.778860, loss_ss: 0.868740, loss_d: 0.910120
0.7680 --- loss: 1.108688, loss_ss: 0.970055, loss_d: 0.138633
0.8065 --- loss: 0.973807, loss_ss: 0.819915, loss_d: 0.153891
0.8449 --- loss: 1.066177, loss_ss: 0.817659, loss_d: 0.248518
0.8833 --- loss: 1.226493, loss_ss: 1.047645, loss_d: 0.178848
0.9217 --- loss: 1.310856, loss_ss: 0.775716, loss_d: 0.535141
0.9601 --- loss: 1.245984, loss_ss: 1.059124, loss_d: 0.186860
0.9985 --- loss: 1.167649, loss_ss: 1.133493, loss_d: 0.034156
Epoch finished! Loss: 1.13530584527896
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.017351, loss_ss: 0.849210, loss_d: 0.168141
0.0384 --- loss: 0.702515, loss_ss: 0.656192, loss_d: 0.046323
0.0768 --- loss: 0.982498, loss_ss: 0.868850, loss_d: 0.113648
0.1152 --- loss: 1.165077, loss_ss: 0.857445, loss_d: 0.307632
0.1536 --- loss: 0.929874, loss_ss: 0.778950, loss_d: 0.150924
0.1920 --- loss: 0.804604, loss_ss: 0.773270, loss_d: 0.031334
0.2304 --- loss: 0.876368, loss_ss: 0.770913, loss_d: 0.105455
0.2688 --- loss: 1.283180, loss_ss: 1.000112, loss_d: 0.283067
0.3072 --- loss: 0.918056, loss_ss: 0.777217, loss_d: 0.140839
0.3456 --- loss: 1.032414, loss_ss: 0.993926, loss_d: 0.038488
0.3840 --- loss: 1.144119, loss_ss: 0.981375, loss_d: 0.162744
0.4224 --- loss: 0.889032, loss_ss: 0.779337, loss_d: 0.109695
0.4608 --- loss: 1.032930, loss_ss: 0.856047, loss_d: 0.176882
0.4992 --- loss: 0.710578, loss_ss: 0.553986, loss_d: 0.156592
0.5376 --- loss: 0.859387, loss_ss: 0.754195, loss_d: 0.105192
0.5760 --- loss: 0.977365, loss_ss: 0.912782, loss_d: 0.064583
0.6144 --- loss: 1.359660, loss_ss: 0.615943, loss_d: 0.743716
0.6528 --- loss: 0.873270, loss_ss: 0.745155, loss_d: 0.128115
0.6912 --- loss: 1.172089, loss_ss: 1.033605, loss_d: 0.138484
0.7296 --- loss: 0.863243, loss_ss: 0.757398, loss_d: 0.105845
0.7680 --- loss: 0.966830, loss_ss: 0.842697, loss_d: 0.124133
0.8065 --- loss: 1.085222, loss_ss: 0.768059, loss_d: 0.317163
0.8449 --- loss: 0.853979, loss_ss: 0.807215, loss_d: 0.046764
0.8833 --- loss: 2.244372, loss_ss: 0.836077, loss_d: 1.408296
0.9217 --- loss: 1.260978, loss_ss: 0.866485, loss_d: 0.394493
0.9601 --- loss: 1.156999, loss_ss: 0.829206, loss_d: 0.327793
0.9985 --- loss: 1.034285, loss_ss: 1.014643, loss_d: 0.019642
Epoch finished! Loss: 1.086826112637153
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.581467, loss_ss: 0.502301, loss_d: 0.079166
0.0384 --- loss: 1.117685, loss_ss: 0.900556, loss_d: 0.217129
0.0768 --- loss: 0.894614, loss_ss: 0.866291, loss_d: 0.028323
0.1152 --- loss: 1.094442, loss_ss: 0.899515, loss_d: 0.194927
0.1536 --- loss: 1.306670, loss_ss: 0.924289, loss_d: 0.382381
0.1920 --- loss: 0.952933, loss_ss: 0.903105, loss_d: 0.049829
0.2304 --- loss: 0.732054, loss_ss: 0.682951, loss_d: 0.049103
0.2688 --- loss: 0.883486, loss_ss: 0.647622, loss_d: 0.235863
0.3072 --- loss: 0.682346, loss_ss: 0.633123, loss_d: 0.049223
0.3456 --- loss: 1.047026, loss_ss: 0.789484, loss_d: 0.257543
0.3840 --- loss: 0.834422, loss_ss: 0.750847, loss_d: 0.083575
0.4224 --- loss: 0.730895, loss_ss: 0.668929, loss_d: 0.061966
0.4608 --- loss: 0.897827, loss_ss: 0.840744, loss_d: 0.057084
0.4992 --- loss: 1.084298, loss_ss: 0.911731, loss_d: 0.172568
0.5376 --- loss: 1.059894, loss_ss: 0.920305, loss_d: 0.139590
0.5760 --- loss: 1.207575, loss_ss: 0.975095, loss_d: 0.232480
0.6144 --- loss: 0.788013, loss_ss: 0.673469, loss_d: 0.114543
0.6528 --- loss: 0.899563, loss_ss: 0.767820, loss_d: 0.131743
0.6912 --- loss: 1.048913, loss_ss: 0.886910, loss_d: 0.162004
0.7296 --- loss: 1.032731, loss_ss: 0.960135, loss_d: 0.072596
0.7680 --- loss: 0.785403, loss_ss: 0.710360, loss_d: 0.075043
0.8065 --- loss: 1.106067, loss_ss: 0.882980, loss_d: 0.223087
0.8449 --- loss: 1.341530, loss_ss: 0.819865, loss_d: 0.521665
0.8833 --- loss: 1.394015, loss_ss: 0.817713, loss_d: 0.576301
0.9217 --- loss: 1.240816, loss_ss: 1.087351, loss_d: 0.153464
0.9601 --- loss: 1.113100, loss_ss: 0.829763, loss_d: 0.283338
0.9985 --- loss: 1.350512, loss_ss: 1.200773, loss_d: 0.149738
Epoch finished! Loss: 1.0613826701274285
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.987807, loss_ss: 0.884634, loss_d: 0.103173
0.0384 --- loss: 0.886318, loss_ss: 0.698731, loss_d: 0.187588
0.0768 --- loss: 1.421844, loss_ss: 0.744691, loss_d: 0.677153
0.1152 --- loss: 1.120880, loss_ss: 1.010059, loss_d: 0.110820
0.1536 --- loss: 0.807609, loss_ss: 0.747272, loss_d: 0.060337
0.1920 --- loss: 1.230047, loss_ss: 0.865399, loss_d: 0.364648
0.2304 --- loss: 0.907854, loss_ss: 0.676207, loss_d: 0.231647
0.2688 --- loss: 0.936596, loss_ss: 0.882015, loss_d: 0.054582
0.3072 --- loss: 0.886539, loss_ss: 0.734506, loss_d: 0.152033
0.3456 --- loss: 0.800030, loss_ss: 0.737378, loss_d: 0.062652
0.3840 --- loss: 1.238186, loss_ss: 1.087693, loss_d: 0.150493
0.4224 --- loss: 1.235740, loss_ss: 1.033838, loss_d: 0.201902
0.4608 --- loss: 0.725189, loss_ss: 0.691542, loss_d: 0.033647
0.4992 --- loss: 1.332485, loss_ss: 1.281711, loss_d: 0.050774
0.5376 --- loss: 1.171442, loss_ss: 1.120664, loss_d: 0.050778
0.5760 --- loss: 0.789461, loss_ss: 0.602458, loss_d: 0.187003
0.6144 --- loss: 0.906679, loss_ss: 0.797418, loss_d: 0.109261
0.6528 --- loss: 1.198974, loss_ss: 1.124505, loss_d: 0.074469
0.6912 --- loss: 0.715368, loss_ss: 0.575676, loss_d: 0.139693
0.7296 --- loss: 0.960298, loss_ss: 0.806325, loss_d: 0.153973
0.7680 --- loss: 1.137897, loss_ss: 0.855274, loss_d: 0.282623
0.8065 --- loss: 1.187274, loss_ss: 1.022560, loss_d: 0.164714
0.8449 --- loss: 1.113621, loss_ss: 0.942374, loss_d: 0.171247
0.8833 --- loss: 0.925505, loss_ss: 0.889132, loss_d: 0.036372
0.9217 --- loss: 0.955471, loss_ss: 0.939040, loss_d: 0.016432
0.9601 --- loss: 0.674648, loss_ss: 0.662028, loss_d: 0.012620
0.9985 --- loss: 3.027986, loss_ss: 1.961333, loss_d: 1.066653
Epoch finished! Loss: 1.0030060843779491
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.399798, loss_ss: 1.367643, loss_d: 0.032155
0.0384 --- loss: 0.641305, loss_ss: 0.610582, loss_d: 0.030723
0.0768 --- loss: 0.694613, loss_ss: 0.657521, loss_d: 0.037091
0.1152 --- loss: 1.117701, loss_ss: 0.924221, loss_d: 0.193480
0.1536 --- loss: 0.689525, loss_ss: 0.609601, loss_d: 0.079924
0.1920 --- loss: 0.889647, loss_ss: 0.830915, loss_d: 0.058732
0.2304 --- loss: 1.061045, loss_ss: 0.694324, loss_d: 0.366721
0.2688 --- loss: 0.861494, loss_ss: 0.777097, loss_d: 0.084397
0.3072 --- loss: 0.774828, loss_ss: 0.717240, loss_d: 0.057588
0.3456 --- loss: 0.933371, loss_ss: 0.770888, loss_d: 0.162482
0.3840 --- loss: 1.142299, loss_ss: 1.008956, loss_d: 0.133342
0.4224 --- loss: 1.397927, loss_ss: 0.933837, loss_d: 0.464090
0.4608 --- loss: 0.945865, loss_ss: 0.833053, loss_d: 0.112812
0.4992 --- loss: 1.571991, loss_ss: 0.976317, loss_d: 0.595674
0.5376 --- loss: 1.674953, loss_ss: 0.774983, loss_d: 0.899970
0.5760 --- loss: 0.955559, loss_ss: 0.761609, loss_d: 0.193950
0.6144 --- loss: 0.888354, loss_ss: 0.850539, loss_d: 0.037814
0.6528 --- loss: 1.338350, loss_ss: 0.809976, loss_d: 0.528374
0.6912 --- loss: 1.168297, loss_ss: 1.022791, loss_d: 0.145506
0.7296 --- loss: 0.989223, loss_ss: 0.677282, loss_d: 0.311941
0.7680 --- loss: 1.065910, loss_ss: 0.811904, loss_d: 0.254006
0.8065 --- loss: 0.885902, loss_ss: 0.869725, loss_d: 0.016177
0.8449 --- loss: 1.252548, loss_ss: 1.018144, loss_d: 0.234404
0.8833 --- loss: 1.028167, loss_ss: 0.984909, loss_d: 0.043258
0.9217 --- loss: 0.821663, loss_ss: 0.778131, loss_d: 0.043532
0.9601 --- loss: 0.857701, loss_ss: 0.821634, loss_d: 0.036066
0.9985 --- loss: 2.624352, loss_ss: 0.906190, loss_d: 1.718162
Epoch finished! Loss: 1.0072676273492667
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.927821, loss_ss: 0.872196, loss_d: 0.055625
0.0384 --- loss: 0.912629, loss_ss: 0.825981, loss_d: 0.086648
0.0768 --- loss: 0.871590, loss_ss: 0.739486, loss_d: 0.132104
0.1152 --- loss: 1.293450, loss_ss: 1.066184, loss_d: 0.227266
0.1536 --- loss: 1.414257, loss_ss: 1.164532, loss_d: 0.249725
0.1920 --- loss: 1.018284, loss_ss: 0.931509, loss_d: 0.086775
0.2304 --- loss: 1.028923, loss_ss: 0.950680, loss_d: 0.078243
0.2688 --- loss: 1.172873, loss_ss: 1.057251, loss_d: 0.115621
0.3072 --- loss: 2.071113, loss_ss: 1.876664, loss_d: 0.194449
0.3456 --- loss: 0.838602, loss_ss: 0.710088, loss_d: 0.128514
0.3840 --- loss: 0.996572, loss_ss: 0.920903, loss_d: 0.075670
0.4224 --- loss: 1.162507, loss_ss: 1.111518, loss_d: 0.050989
0.4608 --- loss: 1.256888, loss_ss: 0.784414, loss_d: 0.472474
0.4992 --- loss: 0.945701, loss_ss: 0.883220, loss_d: 0.062481
0.5376 --- loss: 0.684015, loss_ss: 0.648893, loss_d: 0.035122
0.5760 --- loss: 0.967291, loss_ss: 0.959840, loss_d: 0.007451
0.6144 --- loss: 1.733585, loss_ss: 1.534660, loss_d: 0.198925
0.6528 --- loss: 0.818770, loss_ss: 0.674875, loss_d: 0.143895
0.6912 --- loss: 0.752278, loss_ss: 0.663805, loss_d: 0.088472
0.7296 --- loss: 0.778847, loss_ss: 0.699276, loss_d: 0.079571
0.7680 --- loss: 0.954742, loss_ss: 0.754739, loss_d: 0.200004
0.8065 --- loss: 1.020146, loss_ss: 1.007136, loss_d: 0.013011
0.8449 --- loss: 0.939353, loss_ss: 0.933183, loss_d: 0.006170
0.8833 --- loss: 1.126884, loss_ss: 0.869882, loss_d: 0.257003
0.9217 --- loss: 1.112600, loss_ss: 0.932997, loss_d: 0.179603
0.9601 --- loss: 0.784640, loss_ss: 0.749656, loss_d: 0.034983
0.9985 --- loss: 1.702827, loss_ss: 1.547541, loss_d: 0.155286
Epoch finished! Loss: 0.9725558299284714
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6333333333333333
             precision    recall  f1-score   support

        0.0       0.73      0.76      0.74       105
        1.0       0.04      0.09      0.05        44
        2.0       0.59      0.80      0.68       317
        3.0       1.00      0.46      0.63       258
        4.0       0.74      0.64      0.68       296

avg / total       0.73      0.63      0.65      1020
 


====== chp058-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.61  76.19   96.72   72.73     74.42
1  86.37   9.09   89.86    3.88      5.44
2  76.47  80.44   74.68   58.89     68.00
3  86.27  45.74  100.00  100.00     62.77
4  82.94  63.85   90.75   73.83     68.48
Total accuracy: 63.33%
Average sen: 55.06%
Average spec: 90.40%
Macro f1-score: 55.82%
Diagnosis acc on 15mins: 1.0
[0.99996257 0.99978048 0.99075669 0.99991965 0.99802607 0.99990344
 0.99970883 0.99964368 0.9991886  0.99999475 0.99771571 0.99994898
 0.99954259 0.99995983 0.99988425 0.99995041 0.99998915 0.9999907
 0.99993932 0.99935919 0.99977654 0.9998197  0.99998069 0.99984789
 0.99983644 0.99950552 0.99993157 0.99898118 0.99993384 0.99997258
 0.99977535 0.99859291 0.99916399 0.99876034]
pred: 0.9993248073493733, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.279907, loss_ss: 1.628332, loss_d: 0.651576
0.0384 --- loss: 2.171012, loss_ss: 1.575553, loss_d: 0.595459
0.0769 --- loss: 2.150241, loss_ss: 1.596514, loss_d: 0.553727
0.1153 --- loss: 2.090964, loss_ss: 1.392052, loss_d: 0.698912
0.1538 --- loss: 1.980715, loss_ss: 1.381317, loss_d: 0.599397
0.1922 --- loss: 1.821494, loss_ss: 1.394125, loss_d: 0.427370
0.2307 --- loss: 2.303049, loss_ss: 1.265901, loss_d: 1.037148
0.2691 --- loss: 1.698969, loss_ss: 1.294137, loss_d: 0.404832
0.3076 --- loss: 1.703450, loss_ss: 1.220511, loss_d: 0.482940
0.3460 --- loss: 1.774293, loss_ss: 1.264600, loss_d: 0.509693
0.3845 --- loss: 1.970822, loss_ss: 1.332364, loss_d: 0.638458
0.4229 --- loss: 1.818316, loss_ss: 1.214820, loss_d: 0.603497
0.4614 --- loss: 2.112734, loss_ss: 1.226923, loss_d: 0.885811
0.4998 --- loss: 1.804286, loss_ss: 1.295548, loss_d: 0.508738
0.5383 --- loss: 1.518857, loss_ss: 1.140435, loss_d: 0.378422
0.5767 --- loss: 1.722089, loss_ss: 1.252424, loss_d: 0.469665
0.6151 --- loss: 2.103129, loss_ss: 1.173814, loss_d: 0.929315
0.6536 --- loss: 1.907817, loss_ss: 1.234816, loss_d: 0.673001
0.6920 --- loss: 1.689514, loss_ss: 1.334095, loss_d: 0.355419
0.7305 --- loss: 1.655688, loss_ss: 1.131498, loss_d: 0.524190
0.7689 --- loss: 1.778121, loss_ss: 1.185481, loss_d: 0.592641
0.8074 --- loss: 1.457638, loss_ss: 1.178520, loss_d: 0.279118
0.8458 --- loss: 1.422388, loss_ss: 1.130299, loss_d: 0.292088
0.8843 --- loss: 1.599258, loss_ss: 1.238257, loss_d: 0.361001
0.9227 --- loss: 1.816900, loss_ss: 1.318412, loss_d: 0.498487
0.9612 --- loss: 1.293642, loss_ss: 1.011488, loss_d: 0.282154
0.9996 --- loss: 4.219017, loss_ss: 2.041223, loss_d: 2.177794
Epoch finished! Loss: 1.8689796690757459
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.656576, loss_ss: 1.187739, loss_d: 0.468837
0.0384 --- loss: 1.572120, loss_ss: 1.185180, loss_d: 0.386940
0.0769 --- loss: 1.381291, loss_ss: 1.084694, loss_d: 0.296597
0.1153 --- loss: 1.610316, loss_ss: 1.255257, loss_d: 0.355059
0.1538 --- loss: 1.585887, loss_ss: 1.083335, loss_d: 0.502552
0.1922 --- loss: 1.787538, loss_ss: 1.028825, loss_d: 0.758713
0.2307 --- loss: 1.183714, loss_ss: 0.941989, loss_d: 0.241725
0.2691 --- loss: 1.378883, loss_ss: 1.116855, loss_d: 0.262029
0.3076 --- loss: 1.587260, loss_ss: 1.192153, loss_d: 0.395107
0.3460 --- loss: 1.821532, loss_ss: 1.069125, loss_d: 0.752406
0.3845 --- loss: 1.559358, loss_ss: 1.192845, loss_d: 0.366513
0.4229 --- loss: 1.862879, loss_ss: 1.496480, loss_d: 0.366400
0.4614 --- loss: 1.478796, loss_ss: 1.234698, loss_d: 0.244098
0.4998 --- loss: 1.563759, loss_ss: 1.133036, loss_d: 0.430723
0.5383 --- loss: 1.834053, loss_ss: 1.157750, loss_d: 0.676303
0.5767 --- loss: 1.290128, loss_ss: 1.063933, loss_d: 0.226194
0.6151 --- loss: 1.347210, loss_ss: 1.118592, loss_d: 0.228618
0.6536 --- loss: 1.386576, loss_ss: 0.971994, loss_d: 0.414581
0.6920 --- loss: 1.561021, loss_ss: 1.140622, loss_d: 0.420399
0.7305 --- loss: 1.398789, loss_ss: 1.062613, loss_d: 0.336177
0.7689 --- loss: 1.346101, loss_ss: 0.947610, loss_d: 0.398491
0.8074 --- loss: 1.444973, loss_ss: 0.943056, loss_d: 0.501917
0.8458 --- loss: 1.758493, loss_ss: 0.900250, loss_d: 0.858243
0.8843 --- loss: 1.392762, loss_ss: 0.842003, loss_d: 0.550759
0.9227 --- loss: 1.526100, loss_ss: 1.328483, loss_d: 0.197617
0.9612 --- loss: 1.365603, loss_ss: 1.119557, loss_d: 0.246046
0.9996 --- loss: 1.461188, loss_ss: 1.384430, loss_d: 0.076758
Epoch finished! Loss: 1.485717024252965
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.031740, loss_ss: 0.887981, loss_d: 0.143759
0.0384 --- loss: 0.841330, loss_ss: 0.716299, loss_d: 0.125031
0.0769 --- loss: 1.553822, loss_ss: 0.979110, loss_d: 0.574713
0.1153 --- loss: 1.470766, loss_ss: 1.137799, loss_d: 0.332968
0.1538 --- loss: 1.158857, loss_ss: 0.982280, loss_d: 0.176577
0.1922 --- loss: 1.203463, loss_ss: 1.027569, loss_d: 0.175894
0.2307 --- loss: 1.089797, loss_ss: 0.995787, loss_d: 0.094011
0.2691 --- loss: 1.211885, loss_ss: 0.941519, loss_d: 0.270366
0.3076 --- loss: 1.532492, loss_ss: 1.266973, loss_d: 0.265520
0.3460 --- loss: 1.193153, loss_ss: 0.985892, loss_d: 0.207261
0.3845 --- loss: 1.457798, loss_ss: 1.258442, loss_d: 0.199357
0.4229 --- loss: 1.315623, loss_ss: 1.126782, loss_d: 0.188841
0.4614 --- loss: 1.113116, loss_ss: 0.982431, loss_d: 0.130685
0.4998 --- loss: 1.914016, loss_ss: 0.837487, loss_d: 1.076530
0.5383 --- loss: 1.232323, loss_ss: 0.917150, loss_d: 0.315173
0.5767 --- loss: 1.177764, loss_ss: 1.026379, loss_d: 0.151385
0.6151 --- loss: 1.584625, loss_ss: 1.126050, loss_d: 0.458575
0.6536 --- loss: 1.256958, loss_ss: 1.169037, loss_d: 0.087921
0.6920 --- loss: 1.151566, loss_ss: 0.852007, loss_d: 0.299559
0.7305 --- loss: 1.343600, loss_ss: 1.062264, loss_d: 0.281336
0.7689 --- loss: 1.539599, loss_ss: 1.222538, loss_d: 0.317061
0.8074 --- loss: 1.400803, loss_ss: 0.927716, loss_d: 0.473088
0.8458 --- loss: 1.116984, loss_ss: 0.908333, loss_d: 0.208651
0.8843 --- loss: 1.247991, loss_ss: 0.902468, loss_d: 0.345523
0.9227 --- loss: 1.191590, loss_ss: 1.046858, loss_d: 0.144732
0.9612 --- loss: 1.303287, loss_ss: 1.000516, loss_d: 0.302771
0.9996 --- loss: 1.575996, loss_ss: 1.497556, loss_d: 0.078440
Epoch finished! Loss: 1.3178226691025954
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.066434, loss_ss: 0.969264, loss_d: 0.097170
0.0384 --- loss: 1.379105, loss_ss: 1.244415, loss_d: 0.134690
0.0769 --- loss: 1.234846, loss_ss: 1.055368, loss_d: 0.179478
0.1153 --- loss: 1.235435, loss_ss: 0.873199, loss_d: 0.362236
0.1538 --- loss: 1.406080, loss_ss: 1.088302, loss_d: 0.317778
0.1922 --- loss: 0.946773, loss_ss: 0.817734, loss_d: 0.129039
0.2307 --- loss: 1.452187, loss_ss: 1.307873, loss_d: 0.144314
0.2691 --- loss: 0.936103, loss_ss: 0.881196, loss_d: 0.054906
0.3076 --- loss: 1.372452, loss_ss: 0.860148, loss_d: 0.512304
0.3460 --- loss: 1.166820, loss_ss: 1.048981, loss_d: 0.117838
0.3845 --- loss: 1.471992, loss_ss: 1.060741, loss_d: 0.411251
0.4229 --- loss: 1.463967, loss_ss: 1.134275, loss_d: 0.329692
0.4614 --- loss: 1.130881, loss_ss: 0.976210, loss_d: 0.154670
0.4998 --- loss: 1.112243, loss_ss: 1.031771, loss_d: 0.080472
0.5383 --- loss: 1.198183, loss_ss: 0.823633, loss_d: 0.374550
0.5767 --- loss: 0.837349, loss_ss: 0.714963, loss_d: 0.122386
0.6151 --- loss: 1.221395, loss_ss: 1.025461, loss_d: 0.195934
0.6536 --- loss: 1.198125, loss_ss: 1.134975, loss_d: 0.063150
0.6920 --- loss: 1.077568, loss_ss: 1.002338, loss_d: 0.075230
0.7305 --- loss: 1.024040, loss_ss: 0.829565, loss_d: 0.194475
0.7689 --- loss: 1.572198, loss_ss: 1.173036, loss_d: 0.399161
0.8074 --- loss: 1.171998, loss_ss: 1.020263, loss_d: 0.151734
0.8458 --- loss: 1.395229, loss_ss: 1.250558, loss_d: 0.144672
0.8843 --- loss: 1.393152, loss_ss: 1.243835, loss_d: 0.149317
0.9227 --- loss: 1.645034, loss_ss: 1.510264, loss_d: 0.134770
0.9612 --- loss: 1.400796, loss_ss: 0.846966, loss_d: 0.553831
0.9996 --- loss: 2.776754, loss_ss: 2.761633, loss_d: 0.015121
Epoch finished! Loss: 1.2411282553122593
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.480931, loss_ss: 0.882488, loss_d: 0.598444
0.0384 --- loss: 1.180626, loss_ss: 0.909775, loss_d: 0.270851
0.0769 --- loss: 1.519161, loss_ss: 1.364752, loss_d: 0.154409
0.1153 --- loss: 1.161259, loss_ss: 1.033870, loss_d: 0.127389
0.1538 --- loss: 1.148551, loss_ss: 0.877284, loss_d: 0.271267
0.1922 --- loss: 0.954700, loss_ss: 0.788303, loss_d: 0.166397
0.2307 --- loss: 1.108801, loss_ss: 0.859080, loss_d: 0.249722
0.2691 --- loss: 1.628587, loss_ss: 1.338120, loss_d: 0.290468
0.3076 --- loss: 1.549550, loss_ss: 1.368750, loss_d: 0.180800
0.3460 --- loss: 1.652931, loss_ss: 1.436033, loss_d: 0.216898
0.3845 --- loss: 1.172159, loss_ss: 0.955114, loss_d: 0.217045
0.4229 --- loss: 1.109569, loss_ss: 1.046153, loss_d: 0.063416
0.4614 --- loss: 1.556284, loss_ss: 0.747249, loss_d: 0.809036
0.4998 --- loss: 1.590550, loss_ss: 0.977811, loss_d: 0.612739
0.5383 --- loss: 0.990491, loss_ss: 0.806589, loss_d: 0.183901
0.5767 --- loss: 0.915907, loss_ss: 0.812667, loss_d: 0.103239
0.6151 --- loss: 1.291075, loss_ss: 1.142046, loss_d: 0.149029
0.6536 --- loss: 1.012738, loss_ss: 0.876764, loss_d: 0.135974
0.6920 --- loss: 1.287856, loss_ss: 0.901986, loss_d: 0.385870
0.7305 --- loss: 1.091129, loss_ss: 0.862957, loss_d: 0.228172
0.7689 --- loss: 1.107611, loss_ss: 1.031681, loss_d: 0.075930
0.8074 --- loss: 0.999987, loss_ss: 0.656403, loss_d: 0.343584
0.8458 --- loss: 0.941413, loss_ss: 0.853812, loss_d: 0.087601
0.8843 --- loss: 0.954515, loss_ss: 0.704549, loss_d: 0.249966
0.9227 --- loss: 0.906802, loss_ss: 0.752041, loss_d: 0.154761
0.9612 --- loss: 1.352074, loss_ss: 1.124128, loss_d: 0.227945
0.9996 --- loss: 5.896302, loss_ss: 1.383450, loss_d: 4.512852
Epoch finished! Loss: 1.169014442884005
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.078280, loss_ss: 0.976667, loss_d: 0.101613
0.0384 --- loss: 0.865466, loss_ss: 0.717109, loss_d: 0.148357
0.0769 --- loss: 0.976982, loss_ss: 0.886913, loss_d: 0.090069
0.1153 --- loss: 1.027174, loss_ss: 0.775420, loss_d: 0.251754
0.1538 --- loss: 1.059032, loss_ss: 0.815697, loss_d: 0.243335
0.1922 --- loss: 1.235520, loss_ss: 0.990380, loss_d: 0.245140
0.2307 --- loss: 0.914369, loss_ss: 0.884097, loss_d: 0.030273
0.2691 --- loss: 1.114038, loss_ss: 1.009790, loss_d: 0.104248
0.3076 --- loss: 0.948713, loss_ss: 0.907052, loss_d: 0.041661
0.3460 --- loss: 0.606547, loss_ss: 0.548145, loss_d: 0.058403
0.3845 --- loss: 1.438601, loss_ss: 1.243438, loss_d: 0.195163
0.4229 --- loss: 1.193681, loss_ss: 1.025419, loss_d: 0.168261
0.4614 --- loss: 1.020689, loss_ss: 0.791477, loss_d: 0.229212
0.4998 --- loss: 0.890959, loss_ss: 0.783021, loss_d: 0.107938
0.5383 --- loss: 1.171191, loss_ss: 0.831109, loss_d: 0.340082
0.5767 --- loss: 1.292302, loss_ss: 0.777930, loss_d: 0.514373
0.6151 --- loss: 1.101351, loss_ss: 0.936449, loss_d: 0.164901
0.6536 --- loss: 1.051480, loss_ss: 0.925597, loss_d: 0.125883
0.6920 --- loss: 0.914943, loss_ss: 0.771252, loss_d: 0.143690
0.7305 --- loss: 0.871370, loss_ss: 0.826132, loss_d: 0.045238
0.7689 --- loss: 1.323946, loss_ss: 0.681007, loss_d: 0.642939
0.8074 --- loss: 1.170746, loss_ss: 1.118383, loss_d: 0.052363
0.8458 --- loss: 1.612790, loss_ss: 0.881792, loss_d: 0.730998
0.8843 --- loss: 1.479987, loss_ss: 1.408647, loss_d: 0.071340
0.9227 --- loss: 0.880467, loss_ss: 0.718497, loss_d: 0.161970
0.9612 --- loss: 0.913693, loss_ss: 0.826755, loss_d: 0.086937
0.9996 --- loss: 6.846074, loss_ss: 2.865886, loss_d: 3.980188
Epoch finished! Loss: 1.1182387597285783
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.758834, loss_ss: 0.707436, loss_d: 0.051398
0.0384 --- loss: 0.993420, loss_ss: 0.823996, loss_d: 0.169424
0.0769 --- loss: 0.971748, loss_ss: 0.773639, loss_d: 0.198109
0.1153 --- loss: 0.571219, loss_ss: 0.531137, loss_d: 0.040082
0.1538 --- loss: 1.244252, loss_ss: 1.080207, loss_d: 0.164045
0.1922 --- loss: 1.237718, loss_ss: 0.723758, loss_d: 0.513960
0.2307 --- loss: 0.940172, loss_ss: 0.681383, loss_d: 0.258789
0.2691 --- loss: 0.998825, loss_ss: 0.947147, loss_d: 0.051678
0.3076 --- loss: 1.344437, loss_ss: 1.149286, loss_d: 0.195151
0.3460 --- loss: 1.100886, loss_ss: 1.013689, loss_d: 0.087197
0.3845 --- loss: 1.121901, loss_ss: 1.043120, loss_d: 0.078782
0.4229 --- loss: 0.892193, loss_ss: 0.868371, loss_d: 0.023821
0.4614 --- loss: 1.274321, loss_ss: 0.721455, loss_d: 0.552866
0.4998 --- loss: 1.250039, loss_ss: 0.944492, loss_d: 0.305547
0.5383 --- loss: 1.215361, loss_ss: 0.695304, loss_d: 0.520057
0.5767 --- loss: 1.347898, loss_ss: 0.944850, loss_d: 0.403048
0.6151 --- loss: 1.013757, loss_ss: 0.719807, loss_d: 0.293951
0.6536 --- loss: 0.936196, loss_ss: 0.839398, loss_d: 0.096798
0.6920 --- loss: 0.984271, loss_ss: 0.766979, loss_d: 0.217292
0.7305 --- loss: 1.253115, loss_ss: 1.059078, loss_d: 0.194038
0.7689 --- loss: 1.051968, loss_ss: 0.977137, loss_d: 0.074831
0.8074 --- loss: 0.746703, loss_ss: 0.712539, loss_d: 0.034163
0.8458 --- loss: 1.024660, loss_ss: 0.889373, loss_d: 0.135287
0.8843 --- loss: 0.956776, loss_ss: 0.797184, loss_d: 0.159592
0.9227 --- loss: 1.133448, loss_ss: 1.081209, loss_d: 0.052239
0.9612 --- loss: 1.493152, loss_ss: 1.459030, loss_d: 0.034121
0.9996 --- loss: 1.224509, loss_ss: 1.197571, loss_d: 0.026938
Epoch finished! Loss: 1.0646676214841695
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.719718, loss_ss: 0.675720, loss_d: 0.043998
0.0384 --- loss: 0.974124, loss_ss: 0.939812, loss_d: 0.034312
0.0769 --- loss: 0.793766, loss_ss: 0.780160, loss_d: 0.013606
0.1153 --- loss: 0.784270, loss_ss: 0.769574, loss_d: 0.014696
0.1538 --- loss: 1.332148, loss_ss: 0.905069, loss_d: 0.427079
0.1922 --- loss: 0.839568, loss_ss: 0.811761, loss_d: 0.027807
0.2307 --- loss: 1.186760, loss_ss: 0.989983, loss_d: 0.196777
0.2691 --- loss: 0.912898, loss_ss: 0.896846, loss_d: 0.016052
0.3076 --- loss: 0.834115, loss_ss: 0.725584, loss_d: 0.108531
0.3460 --- loss: 0.815282, loss_ss: 0.750395, loss_d: 0.064887
0.3845 --- loss: 1.381456, loss_ss: 0.699802, loss_d: 0.681654
0.4229 --- loss: 0.876456, loss_ss: 0.861209, loss_d: 0.015247
0.4614 --- loss: 1.142476, loss_ss: 0.864389, loss_d: 0.278087
0.4998 --- loss: 1.040930, loss_ss: 0.821332, loss_d: 0.219598
0.5383 --- loss: 1.015358, loss_ss: 0.891743, loss_d: 0.123615
0.5767 --- loss: 0.898487, loss_ss: 0.848435, loss_d: 0.050052
0.6151 --- loss: 1.416497, loss_ss: 0.786661, loss_d: 0.629836
0.6536 --- loss: 1.163424, loss_ss: 0.965598, loss_d: 0.197826
0.6920 --- loss: 1.150582, loss_ss: 0.768219, loss_d: 0.382363
0.7305 --- loss: 0.654030, loss_ss: 0.615472, loss_d: 0.038558
0.7689 --- loss: 0.709824, loss_ss: 0.652608, loss_d: 0.057216
0.8074 --- loss: 0.835344, loss_ss: 0.721656, loss_d: 0.113688
0.8458 --- loss: 1.869472, loss_ss: 1.651762, loss_d: 0.217710
0.8843 --- loss: 0.721713, loss_ss: 0.670935, loss_d: 0.050778
0.9227 --- loss: 0.762535, loss_ss: 0.703619, loss_d: 0.058916
0.9612 --- loss: 0.927848, loss_ss: 0.843562, loss_d: 0.084286
0.9996 --- loss: 2.344004, loss_ss: 2.342707, loss_d: 0.001297
Epoch finished! Loss: 1.0212346455225578
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.516998, loss_ss: 1.016892, loss_d: 0.500106
0.0384 --- loss: 0.794923, loss_ss: 0.763424, loss_d: 0.031499
0.0769 --- loss: 0.853982, loss_ss: 0.843326, loss_d: 0.010656
0.1153 --- loss: 1.040726, loss_ss: 1.023052, loss_d: 0.017675
0.1538 --- loss: 0.921838, loss_ss: 0.875154, loss_d: 0.046684
0.1922 --- loss: 0.850112, loss_ss: 0.810684, loss_d: 0.039428
0.2307 --- loss: 1.042539, loss_ss: 1.011009, loss_d: 0.031531
0.2691 --- loss: 1.205689, loss_ss: 1.145953, loss_d: 0.059736
0.3076 --- loss: 0.913257, loss_ss: 0.880722, loss_d: 0.032534
0.3460 --- loss: 0.961493, loss_ss: 0.887139, loss_d: 0.074354
0.3845 --- loss: 0.828277, loss_ss: 0.797919, loss_d: 0.030357
0.4229 --- loss: 0.912078, loss_ss: 0.772926, loss_d: 0.139152
0.4614 --- loss: 1.761953, loss_ss: 0.777038, loss_d: 0.984915
0.4998 --- loss: 1.028415, loss_ss: 0.934380, loss_d: 0.094035
0.5383 --- loss: 1.299588, loss_ss: 1.187378, loss_d: 0.112211
0.5767 --- loss: 0.986997, loss_ss: 0.715119, loss_d: 0.271878
0.6151 --- loss: 0.851066, loss_ss: 0.846053, loss_d: 0.005014
0.6536 --- loss: 1.057438, loss_ss: 0.942856, loss_d: 0.114582
0.6920 --- loss: 0.798901, loss_ss: 0.719962, loss_d: 0.078940
0.7305 --- loss: 0.889724, loss_ss: 0.860595, loss_d: 0.029129
0.7689 --- loss: 0.985892, loss_ss: 0.664096, loss_d: 0.321797
0.8074 --- loss: 0.899131, loss_ss: 0.834808, loss_d: 0.064323
0.8458 --- loss: 1.092759, loss_ss: 0.902845, loss_d: 0.189914
0.8843 --- loss: 0.753591, loss_ss: 0.738946, loss_d: 0.014645
0.9227 --- loss: 0.943725, loss_ss: 0.725620, loss_d: 0.218105
0.9612 --- loss: 0.762811, loss_ss: 0.757832, loss_d: 0.004979
0.9996 --- loss: 1.145774, loss_ss: 1.134524, loss_d: 0.011250
Epoch finished! Loss: 0.9635782536405784
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.026835, loss_ss: 0.766012, loss_d: 0.260823
0.0384 --- loss: 1.116143, loss_ss: 1.062750, loss_d: 0.053393
0.0769 --- loss: 0.703133, loss_ss: 0.667775, loss_d: 0.035358
0.1153 --- loss: 0.727976, loss_ss: 0.715454, loss_d: 0.012521
0.1538 --- loss: 0.902375, loss_ss: 0.868582, loss_d: 0.033793
0.1922 --- loss: 1.032765, loss_ss: 0.943988, loss_d: 0.088777
0.2307 --- loss: 1.452882, loss_ss: 0.821996, loss_d: 0.630885
0.2691 --- loss: 1.828206, loss_ss: 0.907733, loss_d: 0.920473
0.3076 --- loss: 1.401953, loss_ss: 1.390042, loss_d: 0.011911
0.3460 --- loss: 1.075489, loss_ss: 0.880698, loss_d: 0.194792
0.3845 --- loss: 1.177081, loss_ss: 0.689385, loss_d: 0.487697
0.4229 --- loss: 0.865426, loss_ss: 0.701845, loss_d: 0.163582
0.4614 --- loss: 0.911337, loss_ss: 0.898596, loss_d: 0.012741
0.4998 --- loss: 0.856571, loss_ss: 0.793006, loss_d: 0.063565
0.5383 --- loss: 0.958829, loss_ss: 0.567378, loss_d: 0.391451
0.5767 --- loss: 0.940577, loss_ss: 0.793884, loss_d: 0.146693
0.6151 --- loss: 0.890425, loss_ss: 0.711189, loss_d: 0.179236
0.6536 --- loss: 0.838258, loss_ss: 0.692594, loss_d: 0.145664
0.6920 --- loss: 1.948492, loss_ss: 1.001390, loss_d: 0.947102
0.7305 --- loss: 0.811968, loss_ss: 0.803124, loss_d: 0.008844
0.7689 --- loss: 1.187916, loss_ss: 0.969101, loss_d: 0.218815
0.8074 --- loss: 1.106704, loss_ss: 0.785801, loss_d: 0.320903
0.8458 --- loss: 0.882686, loss_ss: 0.869368, loss_d: 0.013317
0.8843 --- loss: 0.871930, loss_ss: 0.865025, loss_d: 0.006905
0.9227 --- loss: 0.985975, loss_ss: 0.976829, loss_d: 0.009147
0.9612 --- loss: 0.769239, loss_ss: 0.724408, loss_d: 0.044831
0.9996 --- loss: 2.247147, loss_ss: 2.243567, loss_d: 0.003580
Epoch finished! Loss: 0.9458187520503998
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6585585585585586
             precision    recall  f1-score   support

        0.0       0.80      0.85      0.83       247
        1.0       0.59      0.24      0.34       254
        2.0       0.59      0.99      0.74       355
        3.0       1.00      0.22      0.36        87
        4.0       0.71      0.54      0.61       167

avg / total       0.69      0.66      0.62      1110
 


====== chp059-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.07  85.02   94.09   80.46     82.68
1  78.74  24.02   94.98   58.65     34.08
2  77.30  98.59   67.28   58.63     73.53
3  93.87  21.84  100.00  100.00     35.85
4  89.73  54.49   95.97   70.54     61.49
Total accuracy: 65.86%
Average sen: 56.79%
Average spec: 90.46%
Macro f1-score: 57.52%
Diagnosis acc on 15mins: 1.0
[0.99999845 1.         0.9999783  0.99999869 0.99999964 0.99638593
 0.99876416 0.99514389 0.99985492 0.99969471 0.99930251 0.99889934
 0.99954283 0.99973053 0.99984527 0.99925512 0.9982748  0.99931836
 0.99997854 0.99969614 0.99999833 0.99998939 0.99997985 0.99998105
 0.99534863 0.99163276 0.99861646 0.99775082 0.99715269 0.99946398
 0.99984336 0.99988985 0.99932182 0.99849594 0.9866491  0.9909355
 0.99969518]
pred: 0.9983353195963679, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.356622, loss_ss: 1.660660, loss_d: 0.695962
0.0385 --- loss: 2.088987, loss_ss: 1.506436, loss_d: 0.582551
0.0770 --- loss: 2.046021, loss_ss: 1.474188, loss_d: 0.571832
0.1156 --- loss: 2.040742, loss_ss: 1.577009, loss_d: 0.463733
0.1541 --- loss: 2.124603, loss_ss: 1.432155, loss_d: 0.692448
0.1926 --- loss: 1.890400, loss_ss: 1.393748, loss_d: 0.496652
0.2311 --- loss: 2.093865, loss_ss: 1.382224, loss_d: 0.711641
0.2696 --- loss: 2.048535, loss_ss: 1.476473, loss_d: 0.572062
0.3082 --- loss: 1.797852, loss_ss: 1.460375, loss_d: 0.337477
0.3467 --- loss: 1.845733, loss_ss: 1.392438, loss_d: 0.453294
0.3852 --- loss: 2.156000, loss_ss: 1.541733, loss_d: 0.614267
0.4237 --- loss: 1.879469, loss_ss: 1.363250, loss_d: 0.516220
0.4622 --- loss: 1.751336, loss_ss: 1.266613, loss_d: 0.484723
0.5008 --- loss: 1.618896, loss_ss: 1.338505, loss_d: 0.280390
0.5393 --- loss: 1.901655, loss_ss: 1.333955, loss_d: 0.567700
0.5778 --- loss: 1.847805, loss_ss: 1.359172, loss_d: 0.488633
0.6163 --- loss: 1.649522, loss_ss: 1.356742, loss_d: 0.292780
0.6549 --- loss: 1.723483, loss_ss: 1.383503, loss_d: 0.339980
0.6934 --- loss: 1.645410, loss_ss: 1.243560, loss_d: 0.401850
0.7319 --- loss: 1.824392, loss_ss: 1.223893, loss_d: 0.600499
0.7704 --- loss: 1.767341, loss_ss: 1.218267, loss_d: 0.549074
0.8089 --- loss: 1.928585, loss_ss: 1.264853, loss_d: 0.663732
0.8475 --- loss: 1.663077, loss_ss: 1.387686, loss_d: 0.275390
0.8860 --- loss: 1.585769, loss_ss: 1.161353, loss_d: 0.424416
0.9245 --- loss: 1.595809, loss_ss: 1.180300, loss_d: 0.415509
0.9630 --- loss: 1.626630, loss_ss: 1.240674, loss_d: 0.385956
Epoch finished! Loss: 1.8869047233957121
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.756182, loss_ss: 1.367979, loss_d: 0.388203
0.0385 --- loss: 1.580206, loss_ss: 1.302034, loss_d: 0.278172
0.0770 --- loss: 1.570663, loss_ss: 1.189598, loss_d: 0.381065
0.1156 --- loss: 1.667825, loss_ss: 1.374902, loss_d: 0.292922
0.1541 --- loss: 1.718963, loss_ss: 1.361473, loss_d: 0.357490
0.1926 --- loss: 1.840660, loss_ss: 1.097051, loss_d: 0.743609
0.2311 --- loss: 1.562071, loss_ss: 1.188135, loss_d: 0.373936
0.2696 --- loss: 1.348886, loss_ss: 1.047749, loss_d: 0.301137
0.3082 --- loss: 1.811930, loss_ss: 1.003676, loss_d: 0.808254
0.3467 --- loss: 1.372477, loss_ss: 1.162476, loss_d: 0.210001
0.3852 --- loss: 1.392274, loss_ss: 1.102708, loss_d: 0.289565
0.4237 --- loss: 1.598201, loss_ss: 1.178390, loss_d: 0.419811
0.4622 --- loss: 1.722338, loss_ss: 1.104551, loss_d: 0.617787
0.5008 --- loss: 1.352925, loss_ss: 1.096555, loss_d: 0.256370
0.5393 --- loss: 1.350388, loss_ss: 1.181896, loss_d: 0.168492
0.5778 --- loss: 1.375948, loss_ss: 1.091717, loss_d: 0.284231
0.6163 --- loss: 1.374309, loss_ss: 0.994176, loss_d: 0.380134
0.6549 --- loss: 1.688639, loss_ss: 1.283160, loss_d: 0.405480
0.6934 --- loss: 1.211626, loss_ss: 0.982186, loss_d: 0.229440
0.7319 --- loss: 1.225086, loss_ss: 1.078178, loss_d: 0.146908
0.7704 --- loss: 1.080624, loss_ss: 1.012825, loss_d: 0.067800
0.8089 --- loss: 1.129063, loss_ss: 1.018255, loss_d: 0.110808
0.8475 --- loss: 1.396486, loss_ss: 1.050769, loss_d: 0.345717
0.8860 --- loss: 1.031515, loss_ss: 0.852443, loss_d: 0.179072
0.9245 --- loss: 1.539562, loss_ss: 1.175442, loss_d: 0.364121
0.9630 --- loss: 1.372551, loss_ss: 1.156045, loss_d: 0.216505
Epoch finished! Loss: 1.5188633295559975
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.658925, loss_ss: 0.955659, loss_d: 0.703265
0.0385 --- loss: 1.196505, loss_ss: 0.912484, loss_d: 0.284022
0.0770 --- loss: 1.112108, loss_ss: 0.985201, loss_d: 0.126907
0.1156 --- loss: 1.127649, loss_ss: 0.992158, loss_d: 0.135491
0.1541 --- loss: 1.454960, loss_ss: 1.222349, loss_d: 0.232611
0.1926 --- loss: 1.068595, loss_ss: 0.938729, loss_d: 0.129867
0.2311 --- loss: 1.316643, loss_ss: 1.217058, loss_d: 0.099585
0.2696 --- loss: 1.158452, loss_ss: 0.902149, loss_d: 0.256303
0.3082 --- loss: 1.246333, loss_ss: 0.950648, loss_d: 0.295685
0.3467 --- loss: 1.271707, loss_ss: 1.182752, loss_d: 0.088956
0.3852 --- loss: 1.285095, loss_ss: 0.938906, loss_d: 0.346189
0.4237 --- loss: 1.181743, loss_ss: 0.841443, loss_d: 0.340300
0.4622 --- loss: 1.746551, loss_ss: 1.263196, loss_d: 0.483355
0.5008 --- loss: 1.477846, loss_ss: 1.186353, loss_d: 0.291493
0.5393 --- loss: 1.045461, loss_ss: 0.953236, loss_d: 0.092225
0.5778 --- loss: 1.303938, loss_ss: 1.122233, loss_d: 0.181705
0.6163 --- loss: 1.206210, loss_ss: 0.989076, loss_d: 0.217133
0.6549 --- loss: 1.316813, loss_ss: 1.133382, loss_d: 0.183431
0.6934 --- loss: 1.057933, loss_ss: 0.962620, loss_d: 0.095313
0.7319 --- loss: 1.208290, loss_ss: 0.866805, loss_d: 0.341485
0.7704 --- loss: 1.161608, loss_ss: 0.920574, loss_d: 0.241034
0.8089 --- loss: 1.107991, loss_ss: 0.976420, loss_d: 0.131571
0.8475 --- loss: 0.960757, loss_ss: 0.836923, loss_d: 0.123834
0.8860 --- loss: 1.468311, loss_ss: 1.058122, loss_d: 0.410189
0.9245 --- loss: 1.124970, loss_ss: 1.086722, loss_d: 0.038248
0.9630 --- loss: 1.162615, loss_ss: 0.914723, loss_d: 0.247891
Epoch finished! Loss: 1.3123938160513358
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.551855, loss_ss: 1.433634, loss_d: 0.118221
0.0385 --- loss: 1.370098, loss_ss: 1.037303, loss_d: 0.332795
0.0770 --- loss: 1.195912, loss_ss: 0.918347, loss_d: 0.277564
0.1156 --- loss: 1.060737, loss_ss: 0.983208, loss_d: 0.077529
0.1541 --- loss: 1.106909, loss_ss: 0.954465, loss_d: 0.152444
0.1926 --- loss: 1.432405, loss_ss: 0.890392, loss_d: 0.542014
0.2311 --- loss: 1.580453, loss_ss: 1.094689, loss_d: 0.485764
0.2696 --- loss: 1.064889, loss_ss: 0.934709, loss_d: 0.130179
0.3082 --- loss: 1.316007, loss_ss: 0.803756, loss_d: 0.512251
0.3467 --- loss: 1.142905, loss_ss: 0.965111, loss_d: 0.177795
0.3852 --- loss: 2.033023, loss_ss: 1.076615, loss_d: 0.956407
0.4237 --- loss: 1.196181, loss_ss: 0.882359, loss_d: 0.313821
0.4622 --- loss: 1.206651, loss_ss: 1.010011, loss_d: 0.196640
0.5008 --- loss: 1.119958, loss_ss: 0.851691, loss_d: 0.268267
0.5393 --- loss: 1.380320, loss_ss: 1.280843, loss_d: 0.099476
0.5778 --- loss: 1.014395, loss_ss: 0.891158, loss_d: 0.123237
0.6163 --- loss: 1.064127, loss_ss: 1.001043, loss_d: 0.063083
0.6549 --- loss: 1.288632, loss_ss: 0.963182, loss_d: 0.325450
0.6934 --- loss: 1.043204, loss_ss: 0.994273, loss_d: 0.048931
0.7319 --- loss: 1.312947, loss_ss: 0.803148, loss_d: 0.509799
0.7704 --- loss: 1.169764, loss_ss: 1.090134, loss_d: 0.079630
0.8089 --- loss: 1.044835, loss_ss: 0.964058, loss_d: 0.080777
0.8475 --- loss: 1.268522, loss_ss: 1.194217, loss_d: 0.074305
0.8860 --- loss: 1.012448, loss_ss: 0.908488, loss_d: 0.103960
0.9245 --- loss: 1.036776, loss_ss: 0.939819, loss_d: 0.096957
0.9630 --- loss: 1.552291, loss_ss: 1.160047, loss_d: 0.392244
Epoch finished! Loss: 1.2245761259642347
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.829212, loss_ss: 1.671856, loss_d: 0.157356
0.0385 --- loss: 1.647350, loss_ss: 1.401157, loss_d: 0.246193
0.0770 --- loss: 1.435032, loss_ss: 0.894686, loss_d: 0.540346
0.1156 --- loss: 0.972182, loss_ss: 0.774232, loss_d: 0.197951
0.1541 --- loss: 0.840525, loss_ss: 0.733106, loss_d: 0.107418
0.1926 --- loss: 1.021039, loss_ss: 0.852328, loss_d: 0.168710
0.2311 --- loss: 1.093703, loss_ss: 1.061457, loss_d: 0.032246
0.2696 --- loss: 1.569400, loss_ss: 1.095459, loss_d: 0.473941
0.3082 --- loss: 1.179410, loss_ss: 0.880714, loss_d: 0.298696
0.3467 --- loss: 1.065060, loss_ss: 0.973080, loss_d: 0.091980
0.3852 --- loss: 1.450410, loss_ss: 1.021244, loss_d: 0.429166
0.4237 --- loss: 1.350749, loss_ss: 0.964100, loss_d: 0.386649
0.4622 --- loss: 1.548292, loss_ss: 0.987816, loss_d: 0.560476
0.5008 --- loss: 0.786125, loss_ss: 0.705693, loss_d: 0.080432
0.5393 --- loss: 1.190679, loss_ss: 0.760154, loss_d: 0.430525
0.5778 --- loss: 1.017107, loss_ss: 0.762998, loss_d: 0.254109
0.6163 --- loss: 0.759303, loss_ss: 0.681756, loss_d: 0.077547
0.6549 --- loss: 0.881095, loss_ss: 0.782600, loss_d: 0.098495
0.6934 --- loss: 1.690231, loss_ss: 0.915655, loss_d: 0.774576
0.7319 --- loss: 1.069111, loss_ss: 1.027560, loss_d: 0.041550
0.7704 --- loss: 0.927319, loss_ss: 0.875826, loss_d: 0.051493
0.8089 --- loss: 1.013037, loss_ss: 0.965099, loss_d: 0.047938
0.8475 --- loss: 1.551335, loss_ss: 1.077839, loss_d: 0.473495
0.8860 --- loss: 1.018198, loss_ss: 0.887090, loss_d: 0.131108
0.9245 --- loss: 1.149630, loss_ss: 0.867462, loss_d: 0.282169
0.9630 --- loss: 0.928967, loss_ss: 0.632296, loss_d: 0.296671
Epoch finished! Loss: 1.1679453974064713
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.082439, loss_ss: 0.761509, loss_d: 0.320930
0.0385 --- loss: 1.191886, loss_ss: 0.956794, loss_d: 0.235092
0.0770 --- loss: 0.916107, loss_ss: 0.866735, loss_d: 0.049372
0.1156 --- loss: 1.068160, loss_ss: 1.026104, loss_d: 0.042057
0.1541 --- loss: 1.393177, loss_ss: 0.854325, loss_d: 0.538852
0.1926 --- loss: 1.274671, loss_ss: 1.191269, loss_d: 0.083402
0.2311 --- loss: 1.005275, loss_ss: 0.939278, loss_d: 0.065997
0.2696 --- loss: 1.152266, loss_ss: 1.055040, loss_d: 0.097227
0.3082 --- loss: 0.958828, loss_ss: 0.926893, loss_d: 0.031935
0.3467 --- loss: 0.950146, loss_ss: 0.904604, loss_d: 0.045541
0.3852 --- loss: 1.004374, loss_ss: 0.955155, loss_d: 0.049219
0.4237 --- loss: 0.898023, loss_ss: 0.823911, loss_d: 0.074112
0.4622 --- loss: 1.295460, loss_ss: 0.970830, loss_d: 0.324630
0.5008 --- loss: 1.401064, loss_ss: 1.046026, loss_d: 0.355038
0.5393 --- loss: 0.795800, loss_ss: 0.723882, loss_d: 0.071918
0.5778 --- loss: 1.336531, loss_ss: 0.935562, loss_d: 0.400970
0.6163 --- loss: 1.013350, loss_ss: 0.890991, loss_d: 0.122359
0.6549 --- loss: 0.954234, loss_ss: 0.824561, loss_d: 0.129674
0.6934 --- loss: 0.963227, loss_ss: 0.924128, loss_d: 0.039099
0.7319 --- loss: 0.918658, loss_ss: 0.823285, loss_d: 0.095373
0.7704 --- loss: 0.970429, loss_ss: 0.886890, loss_d: 0.083539
0.8089 --- loss: 0.776691, loss_ss: 0.703000, loss_d: 0.073690
0.8475 --- loss: 1.060367, loss_ss: 0.790448, loss_d: 0.269918
0.8860 --- loss: 0.879380, loss_ss: 0.705761, loss_d: 0.173620
0.9245 --- loss: 1.274334, loss_ss: 1.221782, loss_d: 0.052551
0.9630 --- loss: 0.755212, loss_ss: 0.706886, loss_d: 0.048326
Epoch finished! Loss: 1.1046543006271008
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.268198, loss_ss: 0.948170, loss_d: 0.320029
0.0385 --- loss: 0.914145, loss_ss: 0.789706, loss_d: 0.124440
0.0770 --- loss: 1.191819, loss_ss: 0.894259, loss_d: 0.297560
0.1156 --- loss: 1.623704, loss_ss: 0.925918, loss_d: 0.697786
0.1541 --- loss: 1.163331, loss_ss: 1.014742, loss_d: 0.148589
0.1926 --- loss: 1.103370, loss_ss: 0.852403, loss_d: 0.250967
0.2311 --- loss: 1.090312, loss_ss: 1.038732, loss_d: 0.051581
0.2696 --- loss: 0.913201, loss_ss: 0.770995, loss_d: 0.142206
0.3082 --- loss: 0.955093, loss_ss: 0.944664, loss_d: 0.010430
0.3467 --- loss: 0.835100, loss_ss: 0.771041, loss_d: 0.064059
0.3852 --- loss: 0.680475, loss_ss: 0.618942, loss_d: 0.061533
0.4237 --- loss: 1.203925, loss_ss: 0.901373, loss_d: 0.302553
0.4622 --- loss: 0.864783, loss_ss: 0.842807, loss_d: 0.021975
0.5008 --- loss: 1.665498, loss_ss: 0.899811, loss_d: 0.765687
0.5393 --- loss: 0.871568, loss_ss: 0.851328, loss_d: 0.020239
0.5778 --- loss: 0.814322, loss_ss: 0.766104, loss_d: 0.048218
0.6163 --- loss: 1.293373, loss_ss: 0.785195, loss_d: 0.508178
0.6549 --- loss: 0.748330, loss_ss: 0.734765, loss_d: 0.013565
0.6934 --- loss: 1.795413, loss_ss: 1.322180, loss_d: 0.473233
0.7319 --- loss: 1.241824, loss_ss: 1.175004, loss_d: 0.066820
0.7704 --- loss: 0.779141, loss_ss: 0.746243, loss_d: 0.032898
0.8089 --- loss: 1.448315, loss_ss: 1.296025, loss_d: 0.152290
0.8475 --- loss: 1.553588, loss_ss: 1.113450, loss_d: 0.440138
0.8860 --- loss: 1.089272, loss_ss: 0.891380, loss_d: 0.197892
0.9245 --- loss: 1.291977, loss_ss: 0.908678, loss_d: 0.383299
0.9630 --- loss: 0.756258, loss_ss: 0.699015, loss_d: 0.057243
Epoch finished! Loss: 1.044308687499131
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.879854, loss_ss: 0.623644, loss_d: 0.256210
0.0385 --- loss: 0.792301, loss_ss: 0.684224, loss_d: 0.108077
0.0770 --- loss: 0.897980, loss_ss: 0.810179, loss_d: 0.087801
0.1156 --- loss: 1.014543, loss_ss: 0.972521, loss_d: 0.042021
0.1541 --- loss: 1.303706, loss_ss: 1.226434, loss_d: 0.077272
0.1926 --- loss: 1.205566, loss_ss: 0.817188, loss_d: 0.388378
0.2311 --- loss: 0.947553, loss_ss: 0.786234, loss_d: 0.161319
0.2696 --- loss: 0.919232, loss_ss: 0.804395, loss_d: 0.114837
0.3082 --- loss: 1.255988, loss_ss: 0.956359, loss_d: 0.299628
0.3467 --- loss: 1.084358, loss_ss: 1.001217, loss_d: 0.083140
0.3852 --- loss: 1.008922, loss_ss: 0.731512, loss_d: 0.277410
0.4237 --- loss: 0.856268, loss_ss: 0.836540, loss_d: 0.019728
0.4622 --- loss: 0.786766, loss_ss: 0.664194, loss_d: 0.122573
0.5008 --- loss: 0.767394, loss_ss: 0.741994, loss_d: 0.025401
0.5393 --- loss: 0.872949, loss_ss: 0.842501, loss_d: 0.030448
0.5778 --- loss: 0.847337, loss_ss: 0.828267, loss_d: 0.019069
0.6163 --- loss: 1.189475, loss_ss: 0.748577, loss_d: 0.440898
0.6549 --- loss: 0.975933, loss_ss: 0.927831, loss_d: 0.048102
0.6934 --- loss: 0.815896, loss_ss: 0.766956, loss_d: 0.048939
0.7319 --- loss: 0.745646, loss_ss: 0.652223, loss_d: 0.093422
0.7704 --- loss: 0.990096, loss_ss: 0.883975, loss_d: 0.106121
0.8089 --- loss: 0.814026, loss_ss: 0.805732, loss_d: 0.008294
0.8475 --- loss: 0.746375, loss_ss: 0.661413, loss_d: 0.084962
0.8860 --- loss: 0.924681, loss_ss: 0.785129, loss_d: 0.139551
0.9245 --- loss: 0.876379, loss_ss: 0.808871, loss_d: 0.067507
0.9630 --- loss: 1.103430, loss_ss: 0.774372, loss_d: 0.329058
Epoch finished! Loss: 1.0157949627596439
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.966271, loss_ss: 0.926071, loss_d: 0.040200
0.0385 --- loss: 0.810547, loss_ss: 0.737052, loss_d: 0.073495
0.0770 --- loss: 0.887962, loss_ss: 0.803652, loss_d: 0.084310
0.1156 --- loss: 1.410057, loss_ss: 0.964014, loss_d: 0.446043
0.1541 --- loss: 0.707742, loss_ss: 0.701270, loss_d: 0.006472
0.1926 --- loss: 1.067471, loss_ss: 0.962443, loss_d: 0.105028
0.2311 --- loss: 0.680374, loss_ss: 0.609866, loss_d: 0.070508
0.2696 --- loss: 0.856421, loss_ss: 0.829591, loss_d: 0.026830
0.3082 --- loss: 0.870704, loss_ss: 0.818472, loss_d: 0.052232
0.3467 --- loss: 1.155244, loss_ss: 0.926931, loss_d: 0.228313
0.3852 --- loss: 0.537285, loss_ss: 0.531588, loss_d: 0.005697
0.4237 --- loss: 0.925052, loss_ss: 0.811996, loss_d: 0.113056
0.4622 --- loss: 1.231554, loss_ss: 0.865492, loss_d: 0.366062
0.5008 --- loss: 1.049353, loss_ss: 0.674873, loss_d: 0.374480
0.5393 --- loss: 0.901331, loss_ss: 0.745519, loss_d: 0.155813
0.5778 --- loss: 1.024143, loss_ss: 0.776066, loss_d: 0.248077
0.6163 --- loss: 0.725399, loss_ss: 0.691915, loss_d: 0.033484
0.6549 --- loss: 0.853360, loss_ss: 0.492623, loss_d: 0.360737
0.6934 --- loss: 1.033705, loss_ss: 0.997897, loss_d: 0.035808
0.7319 --- loss: 1.120803, loss_ss: 1.041630, loss_d: 0.079173
0.7704 --- loss: 0.890683, loss_ss: 0.790712, loss_d: 0.099971
0.8089 --- loss: 0.756899, loss_ss: 0.719390, loss_d: 0.037509
0.8475 --- loss: 1.074415, loss_ss: 0.760423, loss_d: 0.313992
0.8860 --- loss: 0.840974, loss_ss: 0.811992, loss_d: 0.028982
0.9245 --- loss: 0.911375, loss_ss: 0.824380, loss_d: 0.086995
0.9630 --- loss: 0.829328, loss_ss: 0.625939, loss_d: 0.203390
Epoch finished! Loss: 0.99108079271427
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.189566, loss_ss: 0.723949, loss_d: 0.465617
0.0385 --- loss: 0.695670, loss_ss: 0.686049, loss_d: 0.009622
0.0770 --- loss: 0.898211, loss_ss: 0.848401, loss_d: 0.049810
0.1156 --- loss: 0.950515, loss_ss: 0.799705, loss_d: 0.150810
0.1541 --- loss: 1.033375, loss_ss: 0.953544, loss_d: 0.079831
0.1926 --- loss: 0.741194, loss_ss: 0.718276, loss_d: 0.022919
0.2311 --- loss: 1.084812, loss_ss: 0.938907, loss_d: 0.145904
0.2696 --- loss: 1.164913, loss_ss: 0.994181, loss_d: 0.170732
0.3082 --- loss: 1.291676, loss_ss: 0.878846, loss_d: 0.412830
0.3467 --- loss: 1.195453, loss_ss: 1.011635, loss_d: 0.183818
0.3852 --- loss: 1.217882, loss_ss: 1.010653, loss_d: 0.207228
0.4237 --- loss: 1.323434, loss_ss: 1.195228, loss_d: 0.128206
0.4622 --- loss: 0.818394, loss_ss: 0.767303, loss_d: 0.051091
0.5008 --- loss: 1.009278, loss_ss: 0.759612, loss_d: 0.249666
0.5393 --- loss: 1.212516, loss_ss: 0.925614, loss_d: 0.286902
0.5778 --- loss: 0.993364, loss_ss: 0.962748, loss_d: 0.030616
0.6163 --- loss: 0.876316, loss_ss: 0.842371, loss_d: 0.033945
0.6549 --- loss: 1.284781, loss_ss: 0.926352, loss_d: 0.358430
0.6934 --- loss: 0.668020, loss_ss: 0.604920, loss_d: 0.063101
0.7319 --- loss: 0.967440, loss_ss: 0.918168, loss_d: 0.049272
0.7704 --- loss: 1.215128, loss_ss: 1.123758, loss_d: 0.091369
0.8089 --- loss: 1.677625, loss_ss: 1.215682, loss_d: 0.461943
0.8475 --- loss: 0.803337, loss_ss: 0.717674, loss_d: 0.085662
0.8860 --- loss: 0.854134, loss_ss: 0.836285, loss_d: 0.017848
0.9245 --- loss: 0.817367, loss_ss: 0.599817, loss_d: 0.217550
0.9630 --- loss: 0.677417, loss_ss: 0.665621, loss_d: 0.011796
Epoch finished! Loss: 0.9730419376181819
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.626984126984127
             precision    recall  f1-score   support

        0.0       0.81      0.82      0.81       519
        1.0       0.42      0.62      0.50       201
        2.0       0.50      0.77      0.61       228
        3.0       1.00      0.04      0.07       158
        4.0       0.76      0.38      0.51       154

avg / total       0.71      0.63      0.60      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  84.68  81.70   86.77   81.23     81.46
1  80.00  62.19   83.38   41.53     49.80
2  81.83  77.19   82.85   49.86     60.59
3  87.94   3.80  100.00  100.00      7.32
4  90.95  38.31   98.28   75.64     50.86
Total accuracy: 62.70%
Average sen: 52.64%
Average spec: 90.26%
Macro f1-score: 50.01%
Diagnosis acc on 15mins: 1.0
[0.99969232 0.99997461 0.99999297 1.         0.99999964 1.
 0.99999964 1.         0.99999976 0.99984574 0.99999988 0.99999988
 0.99999988 0.99999976 0.99999809 1.         1.         1.
 1.         1.         0.99880469 0.99979073 0.99992585 0.99989212
 0.99959391 0.99999988 0.99980956 0.99999988 0.99910396 0.99827826
 0.99999654 0.99998474 0.99999988 0.99999988 1.         0.99999988
 0.99999905 0.99966967 0.99978369 0.99956721 0.99948394 0.99999833]
pred: 0.9998377107438587, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.59  67.06   95.53  70.72     68.84
1  83.21  39.28   89.58  35.36     37.22
2  81.77  79.13   83.37  74.30     76.64
3  93.47  69.62   98.55  91.10     78.93
4  87.54  68.36   91.78  64.80     66.54
Total accuracy: 68.79%
Average sen: 64.69%
Average spec: 91.76%
Macro f1-score: 65.63%
Diagnosis acc on patients: 0.8846153846153846

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.46  69.57   96.36  88.89     78.05
1  88.46  96.36   69.57  88.33     92.17
Total accuracy: 88.46%
Average sen: 82.96%
Average spec: 82.96%
Macro f1-score: 85.11%
fpr: 0.0, tpr: 0.01818181818181818, threshold: 0.9999961502411786, 
fpr: 0.0, tpr: 0.7454545454545455, threshold: 0.9350614993729525, 
fpr: 0.043478260869565216, tpr: 0.7454545454545455, threshold: 0.9159514222826276, 
fpr: 0.043478260869565216, tpr: 0.8545454545454545, threshold: 0.8383450474057879, 
fpr: 0.08695652173913043, tpr: 0.8545454545454545, threshold: 0.8059807872330701, 
fpr: 0.08695652173913043, tpr: 0.9090909090909091, threshold: 0.7481693067785465, 
fpr: 0.13043478260869565, tpr: 0.9090909090909091, threshold: 0.7063756206022974, 
fpr: 0.13043478260869565, tpr: 0.9272727272727272, threshold: 0.7009808014013937, 
fpr: 0.17391304347826086, tpr: 0.9272727272727272, threshold: 0.6948764304360074, 
fpr: 0.17391304347826086, tpr: 0.9636363636363636, threshold: 0.6479491155375453, 
fpr: 0.5217391304347826, tpr: 0.9636363636363636, threshold: 0.33452234615882237, 
fpr: 0.5217391304347826, tpr: 0.9818181818181818, threshold: 0.29137056038686726, 
fpr: 0.782608695652174, tpr: 0.9818181818181818, threshold: 0.10359336578873016, 
fpr: 0.782608695652174, tpr: 1.0, threshold: 0.061448497604835534, 
fpr: 1.0, tpr: 1.0, threshold: 0.004814768469823948, 

=== best_threshold: 0.7481693067785465, best_fpr: 0.08695652173913043, best_tpr: 0.9090909090909091 ===
fpr: 0.0, tpr: 0.04920553562275756, threshold: 1.0, 
fpr: 0.0, tpr: 0.07124551512045105, threshold: 0.9999998807907104, 
fpr: 0.0, tpr: 0.08098411071245515, threshold: 0.9999997615814209, 
fpr: 0.0, tpr: 0.0912352639671963, threshold: 0.9999996423721313, 
fpr: 0.0, tpr: 0.09533572526909277, threshold: 0.9999995231628418, 
fpr: 0.0, tpr: 0.09789851358277807, threshold: 0.9999994039535522, 
fpr: 0.0, tpr: 0.10251153254741159, threshold: 0.9999992847442627, 
fpr: 0.0, tpr: 0.10558687852383393, threshold: 0.9999991655349731, 
fpr: 0.0, tpr: 0.10763710917478217, threshold: 0.9999990463256836, 
fpr: 0.0, tpr: 0.10917478216299334, threshold: 0.999998927116394, 
fpr: 0.0, tpr: 0.11122501281394157, threshold: 0.9999988079071045, 
fpr: 0.0, tpr: 0.11583803177857509, threshold: 0.9999986886978149, 
fpr: 0.0, tpr: 0.11840082009226038, threshold: 0.9999985694885254, 
fpr: 0.0, tpr: 0.12198872373141978, threshold: 0.9999984502792358, 
fpr: 0.0, tpr: 0.12352639671963096, threshold: 0.9999983310699463, 
fpr: 0.0, tpr: 0.12455151204510508, threshold: 0.9999982118606567, 
fpr: 0.0, tpr: 0.12865197334700154, threshold: 0.9999979734420776, 
fpr: 0.0, tpr: 0.1291645310097386, threshold: 0.9999978542327881, 
fpr: 0.0, tpr: 0.13070220399794977, threshold: 0.9999977350234985, 
fpr: 0.0, tpr: 0.13582778062532036, threshold: 0.9999974966049194, 
fpr: 0.0, tpr: 0.13787801127626859, threshold: 0.9999972581863403, 
fpr: 0.0, tpr: 0.14095335725269093, threshold: 0.9999970197677612, 
fpr: 0.0, tpr: 0.14300358790363915, threshold: 0.9999967813491821, 
fpr: 0.0, tpr: 0.14454126089185032, threshold: 0.9999966621398926, 
fpr: 0.0, tpr: 0.14710404920553563, threshold: 0.999996542930603, 
fpr: 0.0, tpr: 0.15017939518195797, threshold: 0.9999961853027344, 
fpr: 0.0, tpr: 0.1522296258329062, threshold: 0.9999960660934448, 
fpr: 0.0, tpr: 0.15274218349564325, threshold: 0.9999959468841553, 
fpr: 0.0, tpr: 0.15479241414659148, threshold: 0.9999957084655762, 
fpr: 0.0, tpr: 0.1573552024602768, threshold: 0.9999955892562866, 
fpr: 0.0, tpr: 0.15940543311122501, threshold: 0.9999954700469971, 
fpr: 0.0, tpr: 0.16094310609943618, threshold: 0.9999948740005493, 
fpr: 0.0, tpr: 0.1629933367503844, threshold: 0.9999946355819702, 
fpr: 0.0, tpr: 0.16606868272680678, threshold: 0.9999935626983643, 
fpr: 0.0, tpr: 0.1670937980522809, threshold: 0.9999934434890747, 
fpr: 0.0, tpr: 0.16760635571501795, threshold: 0.9999933242797852, 
fpr: 0.0, tpr: 0.16863147104049206, threshold: 0.999993085861206, 
fpr: 0.0, tpr: 0.16965658636596617, threshold: 0.9999926090240479, 
fpr: 0.0, tpr: 0.17068170169144029, threshold: 0.9999924898147583, 
fpr: 0.0, tpr: 0.1717068170169144, threshold: 0.9999921321868896, 
fpr: 0.0, tpr: 0.1727319323423885, threshold: 0.9999918937683105, 
fpr: 0.0, tpr: 0.17426960533059968, threshold: 0.999991774559021, 
fpr: 0.0, tpr: 0.17529472065607382, threshold: 0.9999908208847046, 
fpr: 0.0, tpr: 0.17734495130702205, threshold: 0.9999901056289673, 
fpr: 0.0, tpr: 0.17837006663249616, threshold: 0.9999896287918091, 
fpr: 0.0, tpr: 0.17990773962070733, threshold: 0.9999895095825195, 
fpr: 0.0, tpr: 0.18400820092260378, threshold: 0.9999876022338867, 
fpr: 0.0, tpr: 0.18503331624807792, threshold: 0.9999873638153076, 
fpr: 0.0, tpr: 0.18605843157355204, threshold: 0.9999871253967285, 
fpr: 0.0, tpr: 0.18708354689902615, threshold: 0.9999867677688599, 
fpr: 0.0, tpr: 0.1901588928754485, threshold: 0.999984860420227, 
fpr: 0.0, tpr: 0.19169656586365966, threshold: 0.9999847412109375, 
fpr: 0.0, tpr: 0.19272168118913377, threshold: 0.9999843835830688, 
fpr: 0.0, tpr: 0.194771911840082, threshold: 0.9999837875366211, 
fpr: 0.0, tpr: 0.19579702716555614, threshold: 0.9999819993972778, 
fpr: 0.0, tpr: 0.19682214249103025, threshold: 0.9999815225601196, 
fpr: 0.0, tpr: 0.1973347001537673, threshold: 0.9999810457229614, 
fpr: 0.0, tpr: 0.19835981547924142, threshold: 0.9999809265136719, 
fpr: 0.0, tpr: 0.20143516145566376, threshold: 0.9999796152114868, 
fpr: 0.0, tpr: 0.20246027678113787, threshold: 0.9999792575836182, 
fpr: 0.0, tpr: 0.20809841107124552, threshold: 0.9999754428863525, 
fpr: 0.0, tpr: 0.20912352639671963, threshold: 0.9999752044677734, 
fpr: 0.0, tpr: 0.21014864172219375, threshold: 0.9999749660491943, 
fpr: 0.0, tpr: 0.21219887237314197, threshold: 0.9999747276306152, 
fpr: 0.0, tpr: 0.21373654536135314, threshold: 0.9999738931655884, 
fpr: 0.0, tpr: 0.21476166068682725, threshold: 0.9999730587005615, 
fpr: 0.0, tpr: 0.21732444900051257, threshold: 0.9999717473983765, 
fpr: 0.0, tpr: 0.21834956432598668, threshold: 0.9999716281890869, 
fpr: 0.0, tpr: 0.2193746796514608, threshold: 0.9999706745147705, 
fpr: 0.0, tpr: 0.2203997949769349, threshold: 0.9999699592590332, 
fpr: 0.0, tpr: 0.22091235263967196, threshold: 0.9999691247940063, 
fpr: 0.0, tpr: 0.22193746796514607, threshold: 0.9999690055847168, 
fpr: 0.0, tpr: 0.22347514095335724, threshold: 0.9999686479568481, 
fpr: 0.0, tpr: 0.22860071758072784, threshold: 0.9999616146087646, 
fpr: 0.0, tpr: 0.22962583290620195, threshold: 0.9999613761901855, 
fpr: 0.0, tpr: 0.23167606355715017, threshold: 0.9999595880508423, 
fpr: 0.0, tpr: 0.2327011788826243, threshold: 0.9999593496322632, 
fpr: 0.0, tpr: 0.2337262942080984, threshold: 0.9999575614929199, 
fpr: 0.0, tpr: 0.23577652485904665, threshold: 0.9999568462371826, 
fpr: 0.0, tpr: 0.24141465914915428, threshold: 0.999950647354126, 
fpr: 0.0, tpr: 0.2424397744746284, threshold: 0.9999505281448364, 
fpr: 0.0, tpr: 0.24397744746283956, threshold: 0.9999496936798096, 
fpr: 0.0, tpr: 0.2450025627883137, threshold: 0.99994957447052, 
fpr: 0.0, tpr: 0.24654023577652487, threshold: 0.9999489784240723, 
fpr: 0.0, tpr: 0.24756535110199898, threshold: 0.9999486207962036, 
fpr: 0.0, tpr: 0.2521783700666325, threshold: 0.9999412298202515, 
fpr: 0.0, tpr: 0.25320348539210663, threshold: 0.9999406337738037, 
fpr: 0.0, tpr: 0.26499231163505893, threshold: 0.9999254941940308, 
fpr: 0.0, tpr: 0.26601742696053304, threshold: 0.9999252557754517, 
fpr: 0.0, tpr: 0.2752434648898001, threshold: 0.9999111890792847, 
fpr: 0.0, tpr: 0.27626858021527423, threshold: 0.9999098777770996, 
fpr: 0.0, tpr: 0.2798564838544336, threshold: 0.9999042749404907, 
fpr: 0.0, tpr: 0.28088159917990774, threshold: 0.9999039173126221, 
fpr: 0.0, tpr: 0.2813941568426448, threshold: 0.999903678894043, 
fpr: 0.0, tpr: 0.2824192721681189, threshold: 0.9999034404754639, 
fpr: 0.001455604075691412, tpr: 0.2824192721681189, threshold: 0.9999033212661743, 
fpr: 0.001455604075691412, tpr: 0.2839569451563301, threshold: 0.9999011754989624, 
fpr: 0.002911208151382824, tpr: 0.2839569451563301, threshold: 0.9998997449874878, 
fpr: 0.002911208151382824, tpr: 0.2947206560738083, threshold: 0.999882698059082, 
fpr: 0.002911208151382824, tpr: 0.29677088672475654, threshold: 0.9998804330825806, 
fpr: 0.002911208151382824, tpr: 0.32752434648898, threshold: 0.9998131394386292, 
fpr: 0.002911208151382824, tpr: 0.3285494618144541, threshold: 0.9998103976249695, 
fpr: 0.002911208151382824, tpr: 0.3470015376729882, threshold: 0.9997422099113464, 
fpr: 0.004366812227074236, tpr: 0.3470015376729882, threshold: 0.9997408986091614, 
fpr: 0.004366812227074236, tpr: 0.3480266529984623, threshold: 0.999738872051239, 
fpr: 0.004366812227074236, tpr: 0.3490517683239364, threshold: 0.9997357726097107, 
fpr: 0.004366812227074236, tpr: 0.4192721681189134, threshold: 0.9993290901184082, 
fpr: 0.005822416302765648, tpr: 0.4192721681189134, threshold: 0.9993270635604858, 
fpr: 0.005822416302765648, tpr: 0.48385443362378266, threshold: 0.9984956979751587, 
fpr: 0.00727802037845706, tpr: 0.48385443362378266, threshold: 0.9984872341156006, 
fpr: 0.00727802037845706, tpr: 0.49871860584315736, threshold: 0.9982057809829712, 
fpr: 0.008733624454148471, tpr: 0.49871860584315736, threshold: 0.9981891512870789, 
fpr: 0.008733624454148471, tpr: 0.5248590466427473, threshold: 0.9976992011070251, 
fpr: 0.010189228529839884, tpr: 0.5248590466427473, threshold: 0.9976907968521118, 
fpr: 0.010189228529839884, tpr: 0.5448487954894926, threshold: 0.9971467852592468, 
fpr: 0.011644832605531296, tpr: 0.5448487954894926, threshold: 0.9971373081207275, 
fpr: 0.011644832605531296, tpr: 0.5458739108149667, threshold: 0.9970771074295044, 
fpr: 0.01455604075691412, tpr: 0.5458739108149667, threshold: 0.9970431923866272, 
fpr: 0.01455604075691412, tpr: 0.5550999487442337, threshold: 0.9967953562736511, 
fpr: 0.01601164483260553, tpr: 0.5550999487442337, threshold: 0.9967582821846008, 
fpr: 0.01601164483260553, tpr: 0.557662737057919, threshold: 0.9966925382614136, 
fpr: 0.017467248908296942, tpr: 0.557662737057919, threshold: 0.9966905117034912, 
fpr: 0.017467248908296942, tpr: 0.5612506406970784, threshold: 0.9965393543243408, 
fpr: 0.018922852983988356, tpr: 0.5612506406970784, threshold: 0.9965217113494873, 
fpr: 0.018922852983988356, tpr: 0.5966171194259354, threshold: 0.9948880076408386, 
fpr: 0.020378457059679767, tpr: 0.5966171194259354, threshold: 0.9948855042457581, 
fpr: 0.020378457059679767, tpr: 0.5976422347514095, threshold: 0.9948128461837769, 
fpr: 0.021834061135371178, tpr: 0.5976422347514095, threshold: 0.9947941899299622, 
fpr: 0.021834061135371178, tpr: 0.6135315222962583, threshold: 0.9936529397964478, 
fpr: 0.024745269286754003, tpr: 0.6135315222962583, threshold: 0.9935683608055115, 
fpr: 0.024745269286754003, tpr: 0.6160943106099436, threshold: 0.9933229088783264, 
fpr: 0.026200873362445413, tpr: 0.6160943106099436, threshold: 0.9933071732521057, 
fpr: 0.026200873362445413, tpr: 0.6222450025627884, threshold: 0.9928971529006958, 
fpr: 0.027656477438136828, tpr: 0.6222450025627884, threshold: 0.9928739070892334, 
fpr: 0.027656477438136828, tpr: 0.6248077908764736, threshold: 0.9928029179573059, 
fpr: 0.02911208151382824, tpr: 0.6248077908764736, threshold: 0.9927893280982971, 
fpr: 0.02911208151382824, tpr: 0.627883136852896, threshold: 0.9925791621208191, 
fpr: 0.03056768558951965, tpr: 0.627883136852896, threshold: 0.9925565123558044, 
fpr: 0.03056768558951965, tpr: 0.637109174782163, threshold: 0.9918646216392517, 
fpr: 0.03202328966521106, tpr: 0.637109174782163, threshold: 0.9918456673622131, 
fpr: 0.03202328966521106, tpr: 0.6565863659661711, threshold: 0.9899383783340454, 
fpr: 0.033478893740902474, tpr: 0.6565863659661711, threshold: 0.9899134635925293, 
fpr: 0.033478893740902474, tpr: 0.6729882111737571, threshold: 0.988669753074646, 
fpr: 0.034934497816593885, tpr: 0.6729882111737571, threshold: 0.9885770082473755, 
fpr: 0.034934497816593885, tpr: 0.6740133264992312, threshold: 0.9884225726127625, 
fpr: 0.036390101892285295, tpr: 0.6740133264992312, threshold: 0.9884180426597595, 
fpr: 0.036390101892285295, tpr: 0.6765761148129165, threshold: 0.9879103899002075, 
fpr: 0.03784570596797671, tpr: 0.6765761148129165, threshold: 0.9878650307655334, 
fpr: 0.03784570596797671, tpr: 0.6796514607893388, threshold: 0.9870977997779846, 
fpr: 0.039301310043668124, tpr: 0.6796514607893388, threshold: 0.9870453476905823, 
fpr: 0.039301310043668124, tpr: 0.6852895950794464, threshold: 0.9864521026611328, 
fpr: 0.040756914119359534, tpr: 0.6852895950794464, threshold: 0.9864252805709839, 
fpr: 0.040756914119359534, tpr: 0.6858021527421835, threshold: 0.9863840937614441, 
fpr: 0.04512372634643377, tpr: 0.6858021527421835, threshold: 0.986221194267273, 
fpr: 0.04512372634643377, tpr: 0.6888774987186058, threshold: 0.9857368469238281, 
fpr: 0.046579330422125184, tpr: 0.6888774987186058, threshold: 0.9856475591659546, 
fpr: 0.046579330422125184, tpr: 0.6919528446950282, threshold: 0.9851657748222351, 
fpr: 0.048034934497816595, tpr: 0.6919528446950282, threshold: 0.9850592613220215, 
fpr: 0.048034934497816595, tpr: 0.6924654023577652, threshold: 0.9849768877029419, 
fpr: 0.050946142649199416, tpr: 0.6924654023577652, threshold: 0.9848778247833252, 
fpr: 0.050946142649199416, tpr: 0.6965658636596617, threshold: 0.9843250513076782, 
fpr: 0.05240174672489083, tpr: 0.6965658636596617, threshold: 0.984315812587738, 
fpr: 0.05240174672489083, tpr: 0.6970784213223987, threshold: 0.9841980338096619, 
fpr: 0.053857350800582245, tpr: 0.6970784213223987, threshold: 0.9840527772903442, 
fpr: 0.053857350800582245, tpr: 0.6975909789851358, threshold: 0.984051525592804, 
fpr: 0.055312954876273655, tpr: 0.6975909789851358, threshold: 0.9840068221092224, 
fpr: 0.055312954876273655, tpr: 0.7027165556125065, threshold: 0.9832509160041809, 
fpr: 0.056768558951965066, tpr: 0.7027165556125065, threshold: 0.9832087159156799, 
fpr: 0.056768558951965066, tpr: 0.70732957457714, threshold: 0.9826179146766663, 
fpr: 0.05822416302765648, tpr: 0.70732957457714, threshold: 0.9825568795204163, 
fpr: 0.05822416302765648, tpr: 0.7098923628908252, threshold: 0.9820990562438965, 
fpr: 0.05967976710334789, tpr: 0.7098923628908252, threshold: 0.982017993927002, 
fpr: 0.05967976710334789, tpr: 0.7119425935417735, threshold: 0.9817050695419312, 
fpr: 0.0611353711790393, tpr: 0.7119425935417735, threshold: 0.9816670417785645, 
fpr: 0.0611353711790393, tpr: 0.7191184008200923, threshold: 0.9805851578712463, 
fpr: 0.06259097525473072, tpr: 0.7191184008200923, threshold: 0.9805483818054199, 
fpr: 0.06259097525473072, tpr: 0.7237314197847258, threshold: 0.979919970035553, 
fpr: 0.06404657933042213, tpr: 0.7237314197847258, threshold: 0.9799108505249023, 
fpr: 0.06404657933042213, tpr: 0.726294208098411, threshold: 0.9790508151054382, 
fpr: 0.06550218340611354, tpr: 0.726294208098411, threshold: 0.9788549542427063, 
fpr: 0.06550218340611354, tpr: 0.7278318810866222, threshold: 0.9788100719451904, 
fpr: 0.06695778748180495, tpr: 0.7278318810866222, threshold: 0.9785469174385071, 
fpr: 0.06695778748180495, tpr: 0.7283444387493593, threshold: 0.9784278869628906, 
fpr: 0.06841339155749636, tpr: 0.7283444387493593, threshold: 0.9783568978309631, 
fpr: 0.06841339155749636, tpr: 0.7334700153767298, threshold: 0.9778719544410706, 
fpr: 0.06986899563318777, tpr: 0.7334700153767298, threshold: 0.9775347709655762, 
fpr: 0.06986899563318777, tpr: 0.7360328036904151, threshold: 0.9761649370193481, 
fpr: 0.07132459970887918, tpr: 0.7360328036904151, threshold: 0.9761601686477661, 
fpr: 0.07132459970887918, tpr: 0.7365453613531522, threshold: 0.9761314392089844, 
fpr: 0.07423580786026202, tpr: 0.7365453613531522, threshold: 0.9757527709007263, 
fpr: 0.07423580786026202, tpr: 0.7380830343413634, threshold: 0.9756504893302917, 
fpr: 0.07569141193595343, tpr: 0.7380830343413634, threshold: 0.975364089012146, 
fpr: 0.07569141193595343, tpr: 0.7421834956432599, threshold: 0.9745466113090515, 
fpr: 0.07714701601164484, tpr: 0.7421834956432599, threshold: 0.9744996428489685, 
fpr: 0.07714701601164484, tpr: 0.7447462839569452, threshold: 0.9740017056465149, 
fpr: 0.07860262008733625, tpr: 0.7447462839569452, threshold: 0.9739329218864441, 
fpr: 0.07860262008733625, tpr: 0.7467965146078934, threshold: 0.9732471704483032, 
fpr: 0.08005822416302766, tpr: 0.7467965146078934, threshold: 0.9731666445732117, 
fpr: 0.08005822416302766, tpr: 0.751922091235264, threshold: 0.9717759490013123, 
fpr: 0.08151382823871907, tpr: 0.751922091235264, threshold: 0.9716918468475342, 
fpr: 0.08151382823871907, tpr: 0.7534597642234752, threshold: 0.9713332653045654, 
fpr: 0.08296943231441048, tpr: 0.7534597642234752, threshold: 0.9712130427360535, 
fpr: 0.08296943231441048, tpr: 0.7601230138390569, threshold: 0.96946781873703, 
fpr: 0.08733624454148471, tpr: 0.7601230138390569, threshold: 0.969089686870575, 
fpr: 0.08733624454148471, tpr: 0.761148129164531, threshold: 0.9689133763313293, 
fpr: 0.08879184861717612, tpr: 0.761148129164531, threshold: 0.9686353802680969, 
fpr: 0.08879184861717612, tpr: 0.7652485904664275, threshold: 0.967216968536377, 
fpr: 0.09024745269286755, tpr: 0.7652485904664275, threshold: 0.9670284390449524, 
fpr: 0.09024745269286755, tpr: 0.7672988211173757, threshold: 0.9666791558265686, 
fpr: 0.09315866084425037, tpr: 0.7672988211173757, threshold: 0.9664443135261536, 
fpr: 0.09315866084425037, tpr: 0.7708867247565351, threshold: 0.9652180671691895, 
fpr: 0.09606986899563319, tpr: 0.7708867247565351, threshold: 0.9649619460105896, 
fpr: 0.09606986899563319, tpr: 0.7729369554074833, threshold: 0.9642051458358765, 
fpr: 0.0975254730713246, tpr: 0.7729369554074833, threshold: 0.964203953742981, 
fpr: 0.0975254730713246, tpr: 0.7785750896975909, threshold: 0.9628344178199768, 
fpr: 0.09898107714701601, tpr: 0.7785750896975909, threshold: 0.9627363681793213, 
fpr: 0.09898107714701601, tpr: 0.7801127626858022, threshold: 0.9618058204650879, 
fpr: 0.10043668122270742, tpr: 0.7801127626858022, threshold: 0.9617791771888733, 
fpr: 0.10043668122270742, tpr: 0.7826755509994875, threshold: 0.9611824154853821, 
fpr: 0.10334788937409024, tpr: 0.7826755509994875, threshold: 0.9601215720176697, 
fpr: 0.10334788937409024, tpr: 0.7883136852895951, threshold: 0.9574156403541565, 
fpr: 0.10480349344978165, tpr: 0.7883136852895951, threshold: 0.9574056267738342, 
fpr: 0.10480349344978165, tpr: 0.7893388006150692, threshold: 0.9572259783744812, 
fpr: 0.1091703056768559, tpr: 0.7893388006150692, threshold: 0.9564545750617981, 
fpr: 0.1091703056768559, tpr: 0.7913890312660175, threshold: 0.9556113481521606, 
fpr: 0.11062590975254731, tpr: 0.7913890312660175, threshold: 0.9554890394210815, 
fpr: 0.11062590975254731, tpr: 0.7924141465914916, threshold: 0.955451488494873, 
fpr: 0.11208151382823872, tpr: 0.7924141465914916, threshold: 0.9553698897361755, 
fpr: 0.11208151382823872, tpr: 0.7929267042542286, threshold: 0.9550267457962036, 
fpr: 0.11644832605531295, tpr: 0.7929267042542286, threshold: 0.954727053642273, 
fpr: 0.11644832605531295, tpr: 0.7939518195797027, threshold: 0.9544601440429688, 
fpr: 0.11790393013100436, tpr: 0.7939518195797027, threshold: 0.9543727040290833, 
fpr: 0.11790393013100436, tpr: 0.7944643772424398, threshold: 0.9542565941810608, 
fpr: 0.12081513828238719, tpr: 0.7944643772424398, threshold: 0.9540204405784607, 
fpr: 0.12081513828238719, tpr: 0.7975397232188621, threshold: 0.9531373977661133, 
fpr: 0.12372634643377002, tpr: 0.7975397232188621, threshold: 0.953038215637207, 
fpr: 0.12372634643377002, tpr: 0.7980522808815992, threshold: 0.9528900980949402, 
fpr: 0.12518195050946143, tpr: 0.7980522808815992, threshold: 0.9522324800491333, 
fpr: 0.12518195050946143, tpr: 0.7985648385443362, threshold: 0.9516083002090454, 
fpr: 0.12663755458515283, tpr: 0.7985648385443362, threshold: 0.9507699608802795, 
fpr: 0.12663755458515283, tpr: 0.8001025115325474, threshold: 0.9497250318527222, 
fpr: 0.12809315866084425, tpr: 0.8001025115325474, threshold: 0.9493677616119385, 
fpr: 0.12809315866084425, tpr: 0.8031778575089698, threshold: 0.9477507472038269, 
fpr: 0.12954876273653565, tpr: 0.8031778575089698, threshold: 0.9476768374443054, 
fpr: 0.12954876273653565, tpr: 0.8047155304971809, threshold: 0.9467155337333679, 
fpr: 0.13100436681222707, tpr: 0.8047155304971809, threshold: 0.9466223120689392, 
fpr: 0.13100436681222707, tpr: 0.8062532034853921, threshold: 0.945992112159729, 
fpr: 0.1324599708879185, tpr: 0.8062532034853921, threshold: 0.9457597136497498, 
fpr: 0.1324599708879185, tpr: 0.8077908764736033, threshold: 0.9453677535057068, 
fpr: 0.1339155749636099, tpr: 0.8077908764736033, threshold: 0.9448989629745483, 
fpr: 0.1339155749636099, tpr: 0.8103536647872885, threshold: 0.9437243342399597, 
fpr: 0.13537117903930132, tpr: 0.8103536647872885, threshold: 0.94294273853302, 
fpr: 0.13537117903930132, tpr: 0.814966683751922, threshold: 0.9397165179252625, 
fpr: 0.13682678311499272, tpr: 0.814966683751922, threshold: 0.9396527409553528, 
fpr: 0.13682678311499272, tpr: 0.8154792414146591, threshold: 0.9395462274551392, 
fpr: 0.13973799126637554, tpr: 0.8154792414146591, threshold: 0.9390076398849487, 
fpr: 0.13973799126637554, tpr: 0.8175294720656073, threshold: 0.9381288886070251, 
fpr: 0.14119359534206696, tpr: 0.8175294720656073, threshold: 0.9376729726791382, 
fpr: 0.14119359534206696, tpr: 0.8190671450538185, threshold: 0.9365283250808716, 
fpr: 0.14410480349344978, tpr: 0.8190671450538185, threshold: 0.9350200295448303, 
fpr: 0.14410480349344978, tpr: 0.8200922603792927, threshold: 0.9335036873817444, 
fpr: 0.14556040756914118, tpr: 0.8200922603792927, threshold: 0.932886004447937, 
fpr: 0.14556040756914118, tpr: 0.8241927216811892, threshold: 0.9308146834373474, 
fpr: 0.1470160116448326, tpr: 0.8241927216811892, threshold: 0.9307842254638672, 
fpr: 0.1470160116448326, tpr: 0.8252178370066633, threshold: 0.9296746850013733, 
fpr: 0.14992721979621543, tpr: 0.8252178370066633, threshold: 0.9295657873153687, 
fpr: 0.14992721979621543, tpr: 0.8272680676576115, threshold: 0.9279899597167969, 
fpr: 0.15283842794759825, tpr: 0.8272680676576115, threshold: 0.9267721772193909, 
fpr: 0.15283842794759825, tpr: 0.8308559712967709, threshold: 0.9241405129432678, 
fpr: 0.15429403202328967, tpr: 0.8308559712967709, threshold: 0.9233826398849487, 
fpr: 0.15429403202328967, tpr: 0.8323936442849821, threshold: 0.9216176271438599, 
fpr: 0.1572052401746725, tpr: 0.8323936442849821, threshold: 0.9213315844535828, 
fpr: 0.1572052401746725, tpr: 0.8359815479241415, threshold: 0.9178094863891602, 
fpr: 0.1586608442503639, tpr: 0.8359815479241415, threshold: 0.9175822138786316, 
fpr: 0.1586608442503639, tpr: 0.8375192209123526, threshold: 0.9163826704025269, 
fpr: 0.16011644832605532, tpr: 0.8375192209123526, threshold: 0.9161945581436157, 
fpr: 0.16011644832605532, tpr: 0.8380317785750897, threshold: 0.9159563183784485, 
fpr: 0.1615720524017467, tpr: 0.8380317785750897, threshold: 0.915837287902832, 
fpr: 0.1615720524017467, tpr: 0.8390568939005638, threshold: 0.9143533110618591, 
fpr: 0.16302765647743814, tpr: 0.8390568939005638, threshold: 0.9139954447746277, 
fpr: 0.16302765647743814, tpr: 0.8436699128651973, threshold: 0.909318745136261, 
fpr: 0.16593886462882096, tpr: 0.8436699128651973, threshold: 0.9081764817237854, 
fpr: 0.16593886462882096, tpr: 0.8457201435161456, threshold: 0.9062188863754272, 
fpr: 0.16885007278020378, tpr: 0.8457201435161456, threshold: 0.904589831829071, 
fpr: 0.16885007278020378, tpr: 0.849820604818042, threshold: 0.9010112285614014, 
fpr: 0.1717612809315866, tpr: 0.849820604818042, threshold: 0.8990576267242432, 
fpr: 0.1717612809315866, tpr: 0.8539210661199385, threshold: 0.8962675333023071, 
fpr: 0.17467248908296942, tpr: 0.8539210661199385, threshold: 0.8955251574516296, 
fpr: 0.17467248908296942, tpr: 0.8544336237826755, threshold: 0.8950265645980835, 
fpr: 0.17903930131004367, tpr: 0.8544336237826755, threshold: 0.8934091329574585, 
fpr: 0.17903930131004367, tpr: 0.8554587391081496, threshold: 0.8928952217102051, 
fpr: 0.1804949053857351, tpr: 0.8554587391081496, threshold: 0.8927757143974304, 
fpr: 0.1804949053857351, tpr: 0.8569964120963608, threshold: 0.8898040652275085, 
fpr: 0.1819505094614265, tpr: 0.8569964120963608, threshold: 0.8891217708587646, 
fpr: 0.1819505094614265, tpr: 0.8600717580727832, threshold: 0.8863213658332825, 
fpr: 0.1848617176128093, tpr: 0.8600717580727832, threshold: 0.8845535516738892, 
fpr: 0.1848617176128093, tpr: 0.8616094310609944, threshold: 0.8822619318962097, 
fpr: 0.18777292576419213, tpr: 0.8616094310609944, threshold: 0.8800662755966187, 
fpr: 0.18777292576419213, tpr: 0.8636596617119426, threshold: 0.8782503008842468, 
fpr: 0.18922852983988356, tpr: 0.8636596617119426, threshold: 0.8774742484092712, 
fpr: 0.18922852983988356, tpr: 0.8657098923628909, threshold: 0.8759028315544128, 
fpr: 0.19068413391557495, tpr: 0.8657098923628909, threshold: 0.8747677206993103, 
fpr: 0.19068413391557495, tpr: 0.866735007688365, threshold: 0.8733656406402588, 
fpr: 0.19213973799126638, tpr: 0.866735007688365, threshold: 0.8732827305793762, 
fpr: 0.19213973799126638, tpr: 0.867247565351102, threshold: 0.8731303811073303, 
fpr: 0.1950509461426492, tpr: 0.867247565351102, threshold: 0.8708071708679199, 
fpr: 0.1950509461426492, tpr: 0.8682726806765761, threshold: 0.8691731095314026, 
fpr: 0.19796215429403202, tpr: 0.8682726806765761, threshold: 0.866325855255127, 
fpr: 0.19796215429403202, tpr: 0.8713480266529985, threshold: 0.8637824058532715, 
fpr: 0.19941775836972345, tpr: 0.8713480266529985, threshold: 0.8610730171203613, 
fpr: 0.19941775836972345, tpr: 0.8723731419784726, threshold: 0.8610180020332336, 
fpr: 0.20087336244541484, tpr: 0.8723731419784726, threshold: 0.8607211112976074, 
fpr: 0.20087336244541484, tpr: 0.8728856996412097, threshold: 0.8606869578361511, 
fpr: 0.2052401746724891, tpr: 0.8728856996412097, threshold: 0.8597081899642944, 
fpr: 0.2052401746724891, tpr: 0.876473603280369, threshold: 0.8545237183570862, 
fpr: 0.2081513828238719, tpr: 0.876473603280369, threshold: 0.8538897633552551, 
fpr: 0.2081513828238719, tpr: 0.8769861609431061, threshold: 0.8530129790306091, 
fpr: 0.2096069868995633, tpr: 0.8769861609431061, threshold: 0.852483332157135, 
fpr: 0.2096069868995633, tpr: 0.8774987186058432, threshold: 0.851140022277832, 
fpr: 0.21251819505094613, tpr: 0.8774987186058432, threshold: 0.8494768738746643, 
fpr: 0.21251819505094613, tpr: 0.8780112762685802, threshold: 0.8493872284889221, 
fpr: 0.21397379912663755, tpr: 0.8780112762685802, threshold: 0.847410261631012, 
fpr: 0.21397379912663755, tpr: 0.8785238339313173, threshold: 0.8473373055458069, 
fpr: 0.21688500727802038, tpr: 0.8785238339313173, threshold: 0.8469550013542175, 
fpr: 0.21688500727802038, tpr: 0.8800615069195284, threshold: 0.8448278307914734, 
fpr: 0.2197962154294032, tpr: 0.8800615069195284, threshold: 0.8429217338562012, 
fpr: 0.2197962154294032, tpr: 0.8805740645822655, threshold: 0.8406845927238464, 
fpr: 0.22125181950509462, tpr: 0.8805740645822655, threshold: 0.839573085308075, 
fpr: 0.22125181950509462, tpr: 0.8810866222450026, threshold: 0.8389726281166077, 
fpr: 0.22270742358078602, tpr: 0.8810866222450026, threshold: 0.8377230167388916, 
fpr: 0.22270742358078602, tpr: 0.8815991799077396, threshold: 0.8372543454170227, 
fpr: 0.22416302765647744, tpr: 0.8815991799077396, threshold: 0.8372257947921753, 
fpr: 0.22416302765647744, tpr: 0.884674525884162, threshold: 0.8317232131958008, 
fpr: 0.22561863173216884, tpr: 0.884674525884162, threshold: 0.8303806185722351, 
fpr: 0.22561863173216884, tpr: 0.885187083546899, threshold: 0.8301905989646912, 
fpr: 0.22998544395924309, tpr: 0.885187083546899, threshold: 0.8261623382568359, 
fpr: 0.22998544395924309, tpr: 0.8872373141978472, threshold: 0.8230744004249573, 
fpr: 0.2314410480349345, tpr: 0.8872373141978472, threshold: 0.822769820690155, 
fpr: 0.2314410480349345, tpr: 0.8887749871860584, threshold: 0.8218039870262146, 
fpr: 0.2328966521106259, tpr: 0.8887749871860584, threshold: 0.8209226727485657, 
fpr: 0.2328966521106259, tpr: 0.8898001025115325, threshold: 0.8203144073486328, 
fpr: 0.23435225618631733, tpr: 0.8898001025115325, threshold: 0.8190516829490662, 
fpr: 0.23435225618631733, tpr: 0.8908252178370066, threshold: 0.813923180103302, 
fpr: 0.23580786026200873, tpr: 0.8908252178370066, threshold: 0.8129372000694275, 
fpr: 0.23580786026200873, tpr: 0.8918503331624807, threshold: 0.811184823513031, 
fpr: 0.24017467248908297, tpr: 0.8918503331624807, threshold: 0.8101158738136292, 
fpr: 0.24017467248908297, tpr: 0.893900563813429, threshold: 0.8027957081794739, 
fpr: 0.24599708879184862, tpr: 0.893900563813429, threshold: 0.8005632162094116, 
fpr: 0.24599708879184862, tpr: 0.894413121476166, threshold: 0.8001378178596497, 
fpr: 0.24890829694323144, tpr: 0.894413121476166, threshold: 0.7967468500137329, 
fpr: 0.24890829694323144, tpr: 0.8954382368016401, threshold: 0.7940104603767395, 
fpr: 0.25036390101892286, tpr: 0.8954382368016401, threshold: 0.7937834858894348, 
fpr: 0.25036390101892286, tpr: 0.8964633521271143, threshold: 0.7918857932090759, 
fpr: 0.25327510917030566, tpr: 0.8964633521271143, threshold: 0.7855785489082336, 
fpr: 0.25327510917030566, tpr: 0.8990261404407995, threshold: 0.7769044637680054, 
fpr: 0.2547307132459971, tpr: 0.8990261404407995, threshold: 0.7764793038368225, 
fpr: 0.2547307132459971, tpr: 0.8995386981035366, threshold: 0.7756609320640564, 
fpr: 0.2561863173216885, tpr: 0.8995386981035366, threshold: 0.7751694917678833, 
fpr: 0.2561863173216885, tpr: 0.9010763710917479, threshold: 0.7718857526779175, 
fpr: 0.2576419213973799, tpr: 0.9010763710917479, threshold: 0.7716341018676758, 
fpr: 0.2576419213973799, tpr: 0.902614044079959, threshold: 0.7629343271255493, 
fpr: 0.2590975254730713, tpr: 0.902614044079959, threshold: 0.7620383501052856, 
fpr: 0.2590975254730713, tpr: 0.9077396207073296, threshold: 0.7516172528266907, 
fpr: 0.2678311499272198, tpr: 0.9077396207073296, threshold: 0.7373723387718201, 
fpr: 0.2678311499272198, tpr: 0.9082521783700667, threshold: 0.732991099357605, 
fpr: 0.2692867540029112, tpr: 0.9082521783700667, threshold: 0.7321017384529114, 
fpr: 0.2692867540029112, tpr: 0.9087647360328037, threshold: 0.7280988097190857, 
fpr: 0.27219796215429404, tpr: 0.9087647360328037, threshold: 0.7258865833282471, 
fpr: 0.27219796215429404, tpr: 0.9103024090210149, threshold: 0.7226329445838928, 
fpr: 0.27365356622998543, tpr: 0.9103024090210149, threshold: 0.7194518446922302, 
fpr: 0.27365356622998543, tpr: 0.910814966683752, threshold: 0.7191382646560669, 
fpr: 0.27510917030567683, tpr: 0.910814966683752, threshold: 0.7183775305747986, 
fpr: 0.27510917030567683, tpr: 0.911327524346489, threshold: 0.7178629636764526, 
fpr: 0.2765647743813683, tpr: 0.911327524346489, threshold: 0.7176190614700317, 
fpr: 0.2765647743813683, tpr: 0.9138903126601743, threshold: 0.7080957293510437, 
fpr: 0.2780203784570597, tpr: 0.9138903126601743, threshold: 0.7075276970863342, 
fpr: 0.2780203784570597, tpr: 0.9144028703229113, threshold: 0.7034188508987427, 
fpr: 0.28820960698689957, tpr: 0.9144028703229113, threshold: 0.6803949475288391, 
fpr: 0.28820960698689957, tpr: 0.9149154279856484, threshold: 0.68039470911026, 
fpr: 0.28966521106259097, tpr: 0.9149154279856484, threshold: 0.6772990226745605, 
fpr: 0.28966521106259097, tpr: 0.9164531009738596, threshold: 0.6723337769508362, 
fpr: 0.29112081513828236, tpr: 0.9164531009738596, threshold: 0.6677437424659729, 
fpr: 0.29112081513828236, tpr: 0.9169656586365966, threshold: 0.6579435467720032, 
fpr: 0.2954876273653566, tpr: 0.9169656586365966, threshold: 0.6531530618667603, 
fpr: 0.2954876273653566, tpr: 0.9174782162993337, threshold: 0.6510429978370667, 
fpr: 0.29694323144104806, tpr: 0.9174782162993337, threshold: 0.6456567049026489, 
fpr: 0.29694323144104806, tpr: 0.9179907739620707, threshold: 0.6452650427818298, 
fpr: 0.29839883551673946, tpr: 0.9179907739620707, threshold: 0.6449482440948486, 
fpr: 0.29839883551673946, tpr: 0.9190158892875449, threshold: 0.6402859687805176, 
fpr: 0.3027656477438137, tpr: 0.9190158892875449, threshold: 0.6296922564506531, 
fpr: 0.3027656477438137, tpr: 0.9195284469502819, threshold: 0.6256481409072876, 
fpr: 0.3042212518195051, tpr: 0.9195284469502819, threshold: 0.6232030391693115, 
fpr: 0.3042212518195051, tpr: 0.9220912352639672, threshold: 0.6161430478096008, 
fpr: 0.30858806404657935, tpr: 0.9220912352639672, threshold: 0.613969087600708, 
fpr: 0.30858806404657935, tpr: 0.9226037929267042, threshold: 0.6125844717025757, 
fpr: 0.314410480349345, tpr: 0.9226037929267042, threshold: 0.6082020401954651, 
fpr: 0.314410480349345, tpr: 0.9231163505894413, threshold: 0.6081898212432861, 
fpr: 0.3173216885007278, tpr: 0.9231163505894413, threshold: 0.6006815433502197, 
fpr: 0.3173216885007278, tpr: 0.9236289082521784, threshold: 0.5996600985527039, 
fpr: 0.31877729257641924, tpr: 0.9236289082521784, threshold: 0.5989341139793396, 
fpr: 0.31877729257641924, tpr: 0.9246540235776525, threshold: 0.5946380496025085, 
fpr: 0.32023289665211063, tpr: 0.9246540235776525, threshold: 0.5908405780792236, 
fpr: 0.32023289665211063, tpr: 0.9251665812403895, threshold: 0.5868028998374939, 
fpr: 0.32168850072780203, tpr: 0.9251665812403895, threshold: 0.5866897106170654, 
fpr: 0.32168850072780203, tpr: 0.9256791389031266, threshold: 0.586286723613739, 
fpr: 0.3231441048034934, tpr: 0.9256791389031266, threshold: 0.5834988951683044, 
fpr: 0.3231441048034934, tpr: 0.9261916965658636, threshold: 0.5789047479629517, 
fpr: 0.3245997088791849, tpr: 0.9261916965658636, threshold: 0.5787801742553711, 
fpr: 0.3245997088791849, tpr: 0.9267042542286007, threshold: 0.578072726726532, 
fpr: 0.3289665211062591, tpr: 0.9267042542286007, threshold: 0.5770733952522278, 
fpr: 0.3289665211062591, tpr: 0.9277293695540748, threshold: 0.5745223760604858, 
fpr: 0.3304221251819505, tpr: 0.9277293695540748, threshold: 0.5743939876556396, 
fpr: 0.3304221251819505, tpr: 0.929267042542286, threshold: 0.5716449022293091, 
fpr: 0.3406113537117904, tpr: 0.929267042542286, threshold: 0.5590060949325562, 
fpr: 0.3406113537117904, tpr: 0.929779600205023, threshold: 0.5573685765266418, 
fpr: 0.3420669577874818, tpr: 0.929779600205023, threshold: 0.5540403127670288, 
fpr: 0.3420669577874818, tpr: 0.9302921578677601, threshold: 0.5538671612739563, 
fpr: 0.3435225618631732, tpr: 0.9302921578677601, threshold: 0.5530765056610107, 
fpr: 0.3435225618631732, tpr: 0.9308047155304972, threshold: 0.5477806329727173, 
fpr: 0.34497816593886466, tpr: 0.9308047155304972, threshold: 0.5472710132598877, 
fpr: 0.34497816593886466, tpr: 0.9318298308559713, threshold: 0.54451584815979, 
fpr: 0.34643377001455605, tpr: 0.9318298308559713, threshold: 0.5444709062576294, 
fpr: 0.34643377001455605, tpr: 0.9323423885187083, threshold: 0.5443589091300964, 
fpr: 0.34788937409024745, tpr: 0.9323423885187083, threshold: 0.54401034116745, 
fpr: 0.34788937409024745, tpr: 0.9328549461814454, threshold: 0.5422084927558899, 
fpr: 0.3537117903930131, tpr: 0.9328549461814454, threshold: 0.5355907082557678, 
fpr: 0.3537117903930131, tpr: 0.9333675038441824, threshold: 0.5352641344070435, 
fpr: 0.3551673944687045, tpr: 0.9333675038441824, threshold: 0.5324218273162842, 
fpr: 0.3551673944687045, tpr: 0.9338800615069195, threshold: 0.5310920476913452, 
fpr: 0.35662299854439594, tpr: 0.9338800615069195, threshold: 0.5273091793060303, 
fpr: 0.35662299854439594, tpr: 0.9349051768323936, threshold: 0.5229126214981079, 
fpr: 0.35807860262008734, tpr: 0.9349051768323936, threshold: 0.5216704607009888, 
fpr: 0.35807860262008734, tpr: 0.9354177344951307, threshold: 0.5172300338745117, 
fpr: 0.363901018922853, tpr: 0.9354177344951307, threshold: 0.5051745772361755, 
fpr: 0.363901018922853, tpr: 0.9359302921578677, threshold: 0.5033321380615234, 
fpr: 0.3653566229985444, tpr: 0.9359302921578677, threshold: 0.5021634101867676, 
fpr: 0.3653566229985444, tpr: 0.9364428498206048, threshold: 0.5007201433181763, 
fpr: 0.36681222707423583, tpr: 0.9364428498206048, threshold: 0.49876803159713745, 
fpr: 0.36681222707423583, tpr: 0.9369554074833418, threshold: 0.4894394278526306, 
fpr: 0.3682678311499272, tpr: 0.9369554074833418, threshold: 0.48529693484306335, 
fpr: 0.3682678311499272, tpr: 0.9374679651460789, threshold: 0.48296380043029785, 
fpr: 0.3697234352256186, tpr: 0.9374679651460789, threshold: 0.4803392291069031, 
fpr: 0.3697234352256186, tpr: 0.93900563813429, threshold: 0.4660089313983917, 
fpr: 0.37117903930131, tpr: 0.93900563813429, threshold: 0.4643462300300598, 
fpr: 0.37117903930131, tpr: 0.9395181957970271, threshold: 0.46145349740982056, 
fpr: 0.37409024745269287, tpr: 0.9395181957970271, threshold: 0.45925185084342957, 
fpr: 0.37409024745269287, tpr: 0.9400307534597643, threshold: 0.45790165662765503, 
fpr: 0.3813682678311499, tpr: 0.9400307534597643, threshold: 0.45099174976348877, 
fpr: 0.3813682678311499, tpr: 0.9415684264479754, threshold: 0.4493864178657532, 
fpr: 0.38282387190684136, tpr: 0.9415684264479754, threshold: 0.44936662912368774, 
fpr: 0.38282387190684136, tpr: 0.9425935417734496, threshold: 0.44773954153060913, 
fpr: 0.38573508005822416, tpr: 0.9425935417734496, threshold: 0.4459896981716156, 
fpr: 0.38573508005822416, tpr: 0.9436186570989237, threshold: 0.4440699815750122, 
fpr: 0.3901018922852984, tpr: 0.9436186570989237, threshold: 0.4328966438770294, 
fpr: 0.3901018922852984, tpr: 0.9446437724243978, threshold: 0.43212828040122986, 
fpr: 0.3915574963609898, tpr: 0.9446437724243978, threshold: 0.4318060874938965, 
fpr: 0.3915574963609898, tpr: 0.9451563300871348, threshold: 0.43039196729660034, 
fpr: 0.3930131004366812, tpr: 0.9451563300871348, threshold: 0.42990079522132874, 
fpr: 0.3930131004366812, tpr: 0.9456688877498719, threshold: 0.42785564064979553, 
fpr: 0.39592430858806404, tpr: 0.9456688877498719, threshold: 0.4206387996673584, 
fpr: 0.39592430858806404, tpr: 0.946694003075346, threshold: 0.4192875921726227, 
fpr: 0.4017467248908297, tpr: 0.946694003075346, threshold: 0.4083859324455261, 
fpr: 0.4017467248908297, tpr: 0.9482316760635572, threshold: 0.4039161503314972, 
fpr: 0.40465793304221254, tpr: 0.9482316760635572, threshold: 0.4010578691959381, 
fpr: 0.40465793304221254, tpr: 0.9492567913890313, threshold: 0.39847806096076965, 
fpr: 0.40756914119359533, tpr: 0.9492567913890313, threshold: 0.3853130340576172, 
fpr: 0.40756914119359533, tpr: 0.9497693490517684, threshold: 0.3851807415485382, 
fpr: 0.42503639010189226, tpr: 0.9497693490517684, threshold: 0.3519664704799652, 
fpr: 0.42503639010189226, tpr: 0.9502819067145054, threshold: 0.34978219866752625, 
fpr: 0.4279475982532751, tpr: 0.9502819067145054, threshold: 0.34514084458351135, 
fpr: 0.4279475982532751, tpr: 0.9507944643772425, threshold: 0.3423204720020294, 
fpr: 0.43231441048034935, tpr: 0.9507944643772425, threshold: 0.3399091362953186, 
fpr: 0.43231441048034935, tpr: 0.9513070220399795, threshold: 0.33874818682670593, 
fpr: 0.43377001455604075, tpr: 0.9513070220399795, threshold: 0.33792558312416077, 
fpr: 0.43377001455604075, tpr: 0.9523321373654536, threshold: 0.3302595913410187, 
fpr: 0.4366812227074236, tpr: 0.9523321373654536, threshold: 0.3257507383823395, 
fpr: 0.4366812227074236, tpr: 0.9533572526909277, threshold: 0.3235031068325043, 
fpr: 0.4395924308588064, tpr: 0.9533572526909277, threshold: 0.32200658321380615, 
fpr: 0.4395924308588064, tpr: 0.9538698103536648, threshold: 0.3193495571613312, 
fpr: 0.4483260553129549, tpr: 0.9538698103536648, threshold: 0.2960587739944458, 
fpr: 0.4483260553129549, tpr: 0.9543823680164019, threshold: 0.29383018612861633, 
fpr: 0.45997088791848617, tpr: 0.9543823680164019, threshold: 0.27601131796836853, 
fpr: 0.45997088791848617, tpr: 0.9548949256791389, threshold: 0.2756032645702362, 
fpr: 0.462882096069869, tpr: 0.9548949256791389, threshold: 0.27036672830581665, 
fpr: 0.462882096069869, tpr: 0.955407483341876, threshold: 0.269542396068573, 
fpr: 0.4643377001455604, tpr: 0.955407483341876, threshold: 0.2664777338504791, 
fpr: 0.4643377001455604, tpr: 0.955920041004613, threshold: 0.26074010133743286, 
fpr: 0.4657933042212518, tpr: 0.955920041004613, threshold: 0.2585567831993103, 
fpr: 0.4657933042212518, tpr: 0.9564325986673501, threshold: 0.25641852617263794, 
fpr: 0.47016011644832606, tpr: 0.9564325986673501, threshold: 0.2392817586660385, 
fpr: 0.47016011644832606, tpr: 0.9569451563300871, threshold: 0.23907271027565002, 
fpr: 0.47161572052401746, tpr: 0.9569451563300871, threshold: 0.2389320433139801, 
fpr: 0.47161572052401746, tpr: 0.9574577139928242, threshold: 0.23797334730625153, 
fpr: 0.4745269286754003, tpr: 0.9574577139928242, threshold: 0.23541760444641113, 
fpr: 0.4745269286754003, tpr: 0.9579702716555613, threshold: 0.22975867986679077, 
fpr: 0.48034934497816595, tpr: 0.9579702716555613, threshold: 0.22737239301204681, 
fpr: 0.48034934497816595, tpr: 0.9584828293182983, threshold: 0.2259693592786789, 
fpr: 0.48326055312954874, tpr: 0.9584828293182983, threshold: 0.22216567397117615, 
fpr: 0.48326055312954874, tpr: 0.9589953869810354, threshold: 0.2190132737159729, 
fpr: 0.4963609898107715, tpr: 0.9589953869810354, threshold: 0.20290227234363556, 
fpr: 0.4963609898107715, tpr: 0.9600205023065095, threshold: 0.20198191702365875, 
fpr: 0.4992721979621543, tpr: 0.9600205023065095, threshold: 0.2008737027645111, 
fpr: 0.4992721979621543, tpr: 0.9610456176319836, threshold: 0.19745726883411407, 
fpr: 0.5109170305676856, tpr: 0.9610456176319836, threshold: 0.17738193273544312, 
fpr: 0.5109170305676856, tpr: 0.9620707329574577, threshold: 0.1768849790096283, 
fpr: 0.512372634643377, tpr: 0.9620707329574577, threshold: 0.17218191921710968, 
fpr: 0.512372634643377, tpr: 0.9625832906201948, threshold: 0.16813884675502777, 
fpr: 0.5225618631732168, tpr: 0.9625832906201948, threshold: 0.153757706284523, 
fpr: 0.5225618631732168, tpr: 0.9641209636084059, threshold: 0.14764025807380676, 
fpr: 0.5283842794759825, tpr: 0.9641209636084059, threshold: 0.13749191164970398, 
fpr: 0.5283842794759825, tpr: 0.9656586365966171, threshold: 0.12664058804512024, 
fpr: 0.5356622998544396, tpr: 0.9656586365966171, threshold: 0.12012483924627304, 
fpr: 0.5356622998544396, tpr: 0.9661711942593542, threshold: 0.11861511319875717, 
fpr: 0.537117903930131, tpr: 0.9661711942593542, threshold: 0.1169281154870987, 
fpr: 0.537117903930131, tpr: 0.9666837519220912, threshold: 0.11691954731941223, 
fpr: 0.5400291120815138, tpr: 0.9666837519220912, threshold: 0.11671742051839828, 
fpr: 0.5400291120815138, tpr: 0.9671963095848283, threshold: 0.11477427929639816, 
fpr: 0.5429403202328966, tpr: 0.9671963095848283, threshold: 0.10973572731018066, 
fpr: 0.5429403202328966, tpr: 0.9687339825730394, threshold: 0.10834944248199463, 
fpr: 0.5545851528384279, tpr: 0.9687339825730394, threshold: 0.1001116931438446, 
fpr: 0.5545851528384279, tpr: 0.9697590978985136, threshold: 0.09580724686384201, 
fpr: 0.5604075691411936, tpr: 0.9697590978985136, threshold: 0.09201858192682266, 
fpr: 0.5604075691411936, tpr: 0.9702716555612506, threshold: 0.09179387986660004, 
fpr: 0.5662299854439592, tpr: 0.9702716555612506, threshold: 0.08458870649337769, 
fpr: 0.5662299854439592, tpr: 0.9707842132239877, threshold: 0.0826929435133934, 
fpr: 0.5764192139737991, tpr: 0.9707842132239877, threshold: 0.07792573422193527, 
fpr: 0.5764192139737991, tpr: 0.9712967708867247, threshold: 0.07693881541490555, 
fpr: 0.5778748180494906, tpr: 0.9712967708867247, threshold: 0.07690064609050751, 
fpr: 0.5778748180494906, tpr: 0.9718093285494618, threshold: 0.07627753913402557, 
fpr: 0.5924308588064047, tpr: 0.9718093285494618, threshold: 0.07195434719324112, 
fpr: 0.5924308588064047, tpr: 0.9728344438749359, threshold: 0.07007305324077606, 
fpr: 0.5997088791848617, tpr: 0.9728344438749359, threshold: 0.06370096653699875, 
fpr: 0.5997088791848617, tpr: 0.973347001537673, threshold: 0.06337755173444748, 
fpr: 0.6011644832605532, tpr: 0.973347001537673, threshold: 0.061903975903987885, 
fpr: 0.6011644832605532, tpr: 0.97385955920041, threshold: 0.05940119922161102, 
fpr: 0.6026200873362445, tpr: 0.97385955920041, threshold: 0.05884741246700287, 
fpr: 0.6026200873362445, tpr: 0.9743721168631471, threshold: 0.05588746815919876, 
fpr: 0.604075691411936, tpr: 0.9743721168631471, threshold: 0.05588538944721222, 
fpr: 0.604075691411936, tpr: 0.9748846745258841, threshold: 0.05546580255031586, 
fpr: 0.6055312954876274, tpr: 0.9748846745258841, threshold: 0.05377045273780823, 
fpr: 0.6055312954876274, tpr: 0.9753972321886212, threshold: 0.05367853865027428, 
fpr: 0.6069868995633187, tpr: 0.9753972321886212, threshold: 0.053092241287231445, 
fpr: 0.6069868995633187, tpr: 0.9764223475140953, threshold: 0.052074283361434937, 
fpr: 0.6084425036390102, tpr: 0.9764223475140953, threshold: 0.051684726029634476, 
fpr: 0.6084425036390102, tpr: 0.9779600205023065, threshold: 0.05042555555701256, 
fpr: 0.6157205240174672, tpr: 0.9779600205023065, threshold: 0.04464074224233627, 
fpr: 0.6157205240174672, tpr: 0.9784725781650435, threshold: 0.04455740749835968, 
fpr: 0.6171761280931587, tpr: 0.9784725781650435, threshold: 0.04453631862998009, 
fpr: 0.6171761280931587, tpr: 0.9794976934905176, threshold: 0.043640654534101486, 
fpr: 0.6593886462882096, tpr: 0.9794976934905176, threshold: 0.030725831165909767, 
fpr: 0.6593886462882096, tpr: 0.9800102511532548, threshold: 0.030580317601561546, 
fpr: 0.6710334788937409, tpr: 0.9800102511532548, threshold: 0.026862556114792824, 
fpr: 0.6710334788937409, tpr: 0.9805228088159919, threshold: 0.026734190061688423, 
fpr: 0.6768558951965066, tpr: 0.9805228088159919, threshold: 0.02363807149231434, 
fpr: 0.6768558951965066, tpr: 0.9810353664787289, threshold: 0.02345496043562889, 
fpr: 0.6899563318777293, tpr: 0.9810353664787289, threshold: 0.02003617025911808, 
fpr: 0.6899563318777293, tpr: 0.981547924141466, threshold: 0.019821399822831154, 
fpr: 0.6957787481804949, tpr: 0.981547924141466, threshold: 0.018739931285381317, 
fpr: 0.6957787481804949, tpr: 0.982060481804203, threshold: 0.01857582852244377, 
fpr: 0.6986899563318777, tpr: 0.982060481804203, threshold: 0.017882557585835457, 
fpr: 0.6986899563318777, tpr: 0.9825730394669401, threshold: 0.017500676214694977, 
fpr: 0.7030567685589519, tpr: 0.9825730394669401, threshold: 0.01709875278174877, 
fpr: 0.7030567685589519, tpr: 0.9830855971296771, threshold: 0.01704559661448002, 
fpr: 0.7161572052401747, tpr: 0.9830855971296771, threshold: 0.014826285652816296, 
fpr: 0.7161572052401747, tpr: 0.9835981547924142, threshold: 0.014686629176139832, 
fpr: 0.7205240174672489, tpr: 0.9835981547924142, threshold: 0.01416010595858097, 
fpr: 0.7205240174672489, tpr: 0.9841107124551512, threshold: 0.01381948497146368, 
fpr: 0.727802037845706, tpr: 0.9841107124551512, threshold: 0.01266865897923708, 
fpr: 0.727802037845706, tpr: 0.9846232701178883, threshold: 0.012393546290695667, 
fpr: 0.7292576419213974, tpr: 0.9846232701178883, threshold: 0.012384911067783833, 
fpr: 0.7292576419213974, tpr: 0.9851358277806254, threshold: 0.011929615400731564, 
fpr: 0.7365356622998545, tpr: 0.9851358277806254, threshold: 0.01103607751429081, 
fpr: 0.7365356622998545, tpr: 0.9856483854433624, threshold: 0.010937931016087532, 
fpr: 0.7394468704512372, tpr: 0.9856483854433624, threshold: 0.01087894570082426, 
fpr: 0.7394468704512372, tpr: 0.9861609431060995, threshold: 0.010851978324353695, 
fpr: 0.7467248908296943, tpr: 0.9861609431060995, threshold: 0.010079722851514816, 
fpr: 0.7467248908296943, tpr: 0.9871860584315736, threshold: 0.00971051212400198, 
fpr: 0.7481804949053857, tpr: 0.9871860584315736, threshold: 0.009571519680321217, 
fpr: 0.7481804949053857, tpr: 0.9876986160943106, threshold: 0.00934574380517006, 
fpr: 0.7540029112081513, tpr: 0.9876986160943106, threshold: 0.008369321003556252, 
fpr: 0.7540029112081513, tpr: 0.9887237314197848, threshold: 0.008259637281298637, 
fpr: 0.7627365356622998, tpr: 0.9887237314197848, threshold: 0.007903809659183025, 
fpr: 0.7627365356622998, tpr: 0.9892362890825218, threshold: 0.007589632645249367, 
fpr: 0.7641921397379913, tpr: 0.9892362890825218, threshold: 0.007379805203527212, 
fpr: 0.7641921397379913, tpr: 0.9897488467452589, threshold: 0.007344846148043871, 
fpr: 0.7656477438136827, tpr: 0.9897488467452589, threshold: 0.007344724610447884, 
fpr: 0.7656477438136827, tpr: 0.9902614044079959, threshold: 0.00723201734945178, 
fpr: 0.7671033478893741, tpr: 0.9902614044079959, threshold: 0.007142180576920509, 
fpr: 0.7671033478893741, tpr: 0.990773962070733, threshold: 0.007021742407232523, 
fpr: 0.777292576419214, tpr: 0.990773962070733, threshold: 0.00655130110681057, 
fpr: 0.777292576419214, tpr: 0.99128651973347, threshold: 0.0062603638507425785, 
fpr: 0.7874818049490538, tpr: 0.99128651973347, threshold: 0.005442317575216293, 
fpr: 0.7874818049490538, tpr: 0.9917990773962071, threshold: 0.005430099554359913, 
fpr: 0.7991266375545851, tpr: 0.9917990773962071, threshold: 0.004919129889458418, 
fpr: 0.7991266375545851, tpr: 0.9923116350589442, threshold: 0.004691841080784798, 
fpr: 0.8064046579330422, tpr: 0.9923116350589442, threshold: 0.004419506993144751, 
fpr: 0.8064046579330422, tpr: 0.9928241927216812, threshold: 0.004364729393273592, 
fpr: 0.8151382823871907, tpr: 0.9928241927216812, threshold: 0.004068297799676657, 
fpr: 0.8151382823871907, tpr: 0.9933367503844183, threshold: 0.004062251187860966, 
fpr: 0.8180494905385735, tpr: 0.9933367503844183, threshold: 0.004040020518004894, 
fpr: 0.8180494905385735, tpr: 0.9938493080471553, threshold: 0.004032104276120663, 
fpr: 0.8209606986899564, tpr: 0.9938493080471553, threshold: 0.00394838023930788, 
fpr: 0.8209606986899564, tpr: 0.9948744233726294, threshold: 0.003763742046430707, 
fpr: 0.8398835516739447, tpr: 0.9948744233726294, threshold: 0.002955993404611945, 
fpr: 0.8398835516739447, tpr: 0.9958995386981035, threshold: 0.0028798962011933327, 
fpr: 0.8427947598253275, tpr: 0.9958995386981035, threshold: 0.002392163500189781, 
fpr: 0.8427947598253275, tpr: 0.9964120963608406, threshold: 0.0023870968725532293, 
fpr: 0.8500727802037845, tpr: 0.9964120963608406, threshold: 0.0020982527639716864, 
fpr: 0.8500727802037845, tpr: 0.9969246540235777, threshold: 0.0020861399825662374, 
fpr: 0.8544395924308588, tpr: 0.9969246540235777, threshold: 0.0020597539842128754, 
fpr: 0.8544395924308588, tpr: 0.9974372116863147, threshold: 0.001996273873373866, 
fpr: 0.858806404657933, tpr: 0.9974372116863147, threshold: 0.001958023989573121, 
fpr: 0.858806404657933, tpr: 0.9979497693490518, threshold: 0.0018833642825484276, 
fpr: 0.9082969432314411, tpr: 0.9979497693490518, threshold: 0.0007268397021107376, 
fpr: 0.9082969432314411, tpr: 0.9994874423372629, threshold: 0.0006897496059536934, 
fpr: 0.9621542940320232, tpr: 0.9994874423372629, threshold: 0.00015386563609354198, 
fpr: 0.9621542940320232, tpr: 1.0, threshold: 0.00015182890638243407, 
fpr: 1.0, tpr: 1.0, threshold: 1.856003422062713e-07, 

=== best_threshold: 0.9574156403541565, best_fpr: 0.10334788937409024, best_tpr: 0.7883136852895951 ===
