cuda:2
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.401199, loss_ss: 1.658861, loss_d: 0.742338
0.0383 --- loss: 2.098728, loss_ss: 1.614405, loss_d: 0.484323
0.0766 --- loss: 2.099373, loss_ss: 1.537031, loss_d: 0.562342
0.1149 --- loss: 2.688941, loss_ss: 1.428114, loss_d: 1.260827
0.1531 --- loss: 2.994696, loss_ss: 1.518362, loss_d: 1.476334
0.1914 --- loss: 2.221157, loss_ss: 1.495774, loss_d: 0.725383
0.2297 --- loss: 1.972118, loss_ss: 1.382122, loss_d: 0.589996
0.2680 --- loss: 1.758020, loss_ss: 1.257541, loss_d: 0.500479
0.3063 --- loss: 1.776772, loss_ss: 1.456361, loss_d: 0.320411
0.3446 --- loss: 1.963312, loss_ss: 1.343676, loss_d: 0.619636
0.3828 --- loss: 2.007383, loss_ss: 1.513443, loss_d: 0.493940
0.4211 --- loss: 1.951845, loss_ss: 1.434400, loss_d: 0.517445
0.4594 --- loss: 1.843888, loss_ss: 1.277882, loss_d: 0.566006
0.4977 --- loss: 1.881060, loss_ss: 1.345176, loss_d: 0.535884
0.5360 --- loss: 1.714218, loss_ss: 1.276984, loss_d: 0.437234
0.5743 --- loss: 1.717734, loss_ss: 1.229487, loss_d: 0.488246
0.6126 --- loss: 1.731728, loss_ss: 1.408625, loss_d: 0.323103
0.6508 --- loss: 1.781291, loss_ss: 1.360939, loss_d: 0.420352
0.6891 --- loss: 1.563198, loss_ss: 1.241629, loss_d: 0.321570
0.7274 --- loss: 1.752124, loss_ss: 1.435041, loss_d: 0.317083
0.7657 --- loss: 1.524537, loss_ss: 1.083268, loss_d: 0.441270
0.8040 --- loss: 1.569752, loss_ss: 1.160858, loss_d: 0.408894
0.8423 --- loss: 1.890895, loss_ss: 1.249365, loss_d: 0.641531
0.8806 --- loss: 1.930019, loss_ss: 1.002311, loss_d: 0.927708
0.9188 --- loss: 2.085799, loss_ss: 1.140779, loss_d: 0.945020
0.9571 --- loss: 1.592581, loss_ss: 1.232998, loss_d: 0.359583
0.9954 --- loss: 1.748147, loss_ss: 1.405982, loss_d: 0.342165
Epoch finished! Loss: 1.8535577707363728
Starting epoch 2/10.
0.0000 --- loss: 1.510676, loss_ss: 1.150446, loss_d: 0.360230
0.0383 --- loss: 1.612549, loss_ss: 1.314445, loss_d: 0.298104
0.0766 --- loss: 1.914545, loss_ss: 1.071190, loss_d: 0.843355
0.1149 --- loss: 1.478118, loss_ss: 0.984554, loss_d: 0.493565
0.1531 --- loss: 1.701132, loss_ss: 1.271988, loss_d: 0.429144
0.1914 --- loss: 1.313984, loss_ss: 1.093191, loss_d: 0.220793
0.2297 --- loss: 1.222268, loss_ss: 0.903392, loss_d: 0.318875
0.2680 --- loss: 1.556702, loss_ss: 1.258374, loss_d: 0.298328
0.3063 --- loss: 1.709347, loss_ss: 0.985417, loss_d: 0.723930
0.3446 --- loss: 1.266871, loss_ss: 0.895550, loss_d: 0.371321
0.3828 --- loss: 1.082190, loss_ss: 0.835836, loss_d: 0.246353
0.4211 --- loss: 1.302628, loss_ss: 1.064480, loss_d: 0.238147
0.4594 --- loss: 1.292023, loss_ss: 1.076296, loss_d: 0.215726
0.4977 --- loss: 1.166103, loss_ss: 1.007769, loss_d: 0.158334
0.5360 --- loss: 1.190614, loss_ss: 0.969946, loss_d: 0.220668
0.5743 --- loss: 1.135230, loss_ss: 0.857099, loss_d: 0.278131
0.6126 --- loss: 1.323414, loss_ss: 0.906664, loss_d: 0.416750
0.6508 --- loss: 1.549208, loss_ss: 0.715688, loss_d: 0.833521
0.6891 --- loss: 1.227567, loss_ss: 1.008994, loss_d: 0.218574
0.7274 --- loss: 1.318761, loss_ss: 0.920825, loss_d: 0.397936
0.7657 --- loss: 1.511632, loss_ss: 0.928284, loss_d: 0.583348
0.8040 --- loss: 1.179089, loss_ss: 1.074445, loss_d: 0.104644
0.8423 --- loss: 1.065267, loss_ss: 0.985558, loss_d: 0.079709
0.8806 --- loss: 1.138999, loss_ss: 1.008888, loss_d: 0.130111
0.9188 --- loss: 1.447281, loss_ss: 1.110137, loss_d: 0.337144
0.9571 --- loss: 1.332939, loss_ss: 1.071041, loss_d: 0.261899
0.9954 --- loss: 0.977947, loss_ss: 0.871702, loss_d: 0.106245
Epoch finished! Loss: 1.3480972707043206
Starting epoch 3/10.
0.0000 --- loss: 1.170326, loss_ss: 0.979396, loss_d: 0.190930
0.0383 --- loss: 0.986494, loss_ss: 0.867932, loss_d: 0.118562
0.0766 --- loss: 1.571507, loss_ss: 1.001490, loss_d: 0.570016
0.1149 --- loss: 1.168254, loss_ss: 1.062173, loss_d: 0.106081
0.1531 --- loss: 1.243225, loss_ss: 1.081619, loss_d: 0.161606
0.1914 --- loss: 1.049514, loss_ss: 0.946458, loss_d: 0.103056
0.2297 --- loss: 1.318043, loss_ss: 1.172717, loss_d: 0.145327
0.2680 --- loss: 1.098858, loss_ss: 0.811441, loss_d: 0.287417
0.3063 --- loss: 1.335892, loss_ss: 1.265472, loss_d: 0.070421
0.3446 --- loss: 1.080693, loss_ss: 0.895711, loss_d: 0.184981
0.3828 --- loss: 0.918323, loss_ss: 0.831773, loss_d: 0.086551
0.4211 --- loss: 1.227302, loss_ss: 0.954473, loss_d: 0.272829
0.4594 --- loss: 0.825892, loss_ss: 0.714221, loss_d: 0.111671
0.4977 --- loss: 1.303530, loss_ss: 1.104668, loss_d: 0.198861
0.5360 --- loss: 0.842976, loss_ss: 0.688644, loss_d: 0.154332
0.5743 --- loss: 1.440259, loss_ss: 0.949376, loss_d: 0.490883
0.6126 --- loss: 1.191857, loss_ss: 0.639281, loss_d: 0.552577
0.6508 --- loss: 1.170748, loss_ss: 0.899446, loss_d: 0.271301
0.6891 --- loss: 1.015599, loss_ss: 0.789257, loss_d: 0.226343
0.7274 --- loss: 1.014652, loss_ss: 0.988412, loss_d: 0.026241
0.7657 --- loss: 1.272010, loss_ss: 1.235861, loss_d: 0.036149
0.8040 --- loss: 1.004583, loss_ss: 0.755671, loss_d: 0.248912
0.8423 --- loss: 1.215189, loss_ss: 0.892773, loss_d: 0.322417
0.8806 --- loss: 1.337371, loss_ss: 0.973661, loss_d: 0.363710
0.9188 --- loss: 1.001437, loss_ss: 0.937727, loss_d: 0.063710
0.9571 --- loss: 1.144219, loss_ss: 0.953064, loss_d: 0.191155
0.9954 --- loss: 1.363271, loss_ss: 1.171587, loss_d: 0.191684
Epoch finished! Loss: 1.1529798174269812
Starting epoch 4/10.
0.0000 --- loss: 1.109224, loss_ss: 0.788445, loss_d: 0.320779
0.0383 --- loss: 1.756085, loss_ss: 1.521604, loss_d: 0.234482
0.0766 --- loss: 1.099853, loss_ss: 0.888043, loss_d: 0.211810
0.1149 --- loss: 1.128786, loss_ss: 0.774599, loss_d: 0.354187
0.1531 --- loss: 1.337583, loss_ss: 0.970910, loss_d: 0.366673
0.1914 --- loss: 1.044991, loss_ss: 0.890119, loss_d: 0.154872
0.2297 --- loss: 1.225964, loss_ss: 0.863849, loss_d: 0.362115
0.2680 --- loss: 1.390582, loss_ss: 0.984913, loss_d: 0.405669
0.3063 --- loss: 0.943280, loss_ss: 0.776222, loss_d: 0.167057
0.3446 --- loss: 1.189349, loss_ss: 1.086566, loss_d: 0.102783
0.3828 --- loss: 1.267285, loss_ss: 0.956119, loss_d: 0.311166
0.4211 --- loss: 1.295630, loss_ss: 1.164717, loss_d: 0.130912
0.4594 --- loss: 1.137349, loss_ss: 1.035245, loss_d: 0.102105
0.4977 --- loss: 0.655396, loss_ss: 0.532223, loss_d: 0.123174
0.5360 --- loss: 1.038659, loss_ss: 0.919109, loss_d: 0.119550
0.5743 --- loss: 1.098626, loss_ss: 0.679196, loss_d: 0.419430
0.6126 --- loss: 0.828648, loss_ss: 0.750247, loss_d: 0.078401
0.6508 --- loss: 1.266456, loss_ss: 0.711455, loss_d: 0.555001
0.6891 --- loss: 1.624714, loss_ss: 1.174928, loss_d: 0.449786
0.7274 --- loss: 0.823324, loss_ss: 0.699374, loss_d: 0.123950
0.7657 --- loss: 0.768403, loss_ss: 0.714501, loss_d: 0.053901
0.8040 --- loss: 1.102624, loss_ss: 0.849708, loss_d: 0.252916
0.8423 --- loss: 0.942917, loss_ss: 0.848089, loss_d: 0.094828
0.8806 --- loss: 0.877503, loss_ss: 0.803802, loss_d: 0.073701
0.9188 --- loss: 0.762036, loss_ss: 0.705435, loss_d: 0.056601
0.9571 --- loss: 0.802004, loss_ss: 0.732049, loss_d: 0.069956
0.9954 --- loss: 1.427753, loss_ss: 0.936022, loss_d: 0.491732
Epoch finished! Loss: 1.0523423330993944
Starting epoch 5/10.
0.0000 --- loss: 0.769755, loss_ss: 0.738442, loss_d: 0.031313
0.0383 --- loss: 0.809990, loss_ss: 0.678800, loss_d: 0.131190
0.0766 --- loss: 1.241697, loss_ss: 0.918178, loss_d: 0.323519
0.1149 --- loss: 1.096666, loss_ss: 0.767227, loss_d: 0.329439
0.1531 --- loss: 0.942528, loss_ss: 0.611378, loss_d: 0.331150
0.1914 --- loss: 1.256834, loss_ss: 0.928617, loss_d: 0.328216
0.2297 --- loss: 0.816460, loss_ss: 0.683905, loss_d: 0.132555
0.2680 --- loss: 0.880738, loss_ss: 0.670457, loss_d: 0.210281
0.3063 --- loss: 1.059055, loss_ss: 0.940566, loss_d: 0.118490
0.3446 --- loss: 0.954686, loss_ss: 0.776892, loss_d: 0.177793
0.3828 --- loss: 0.550825, loss_ss: 0.491965, loss_d: 0.058860
0.4211 --- loss: 1.878011, loss_ss: 1.488462, loss_d: 0.389549
0.4594 --- loss: 1.177349, loss_ss: 0.939343, loss_d: 0.238006
0.4977 --- loss: 0.913983, loss_ss: 0.884944, loss_d: 0.029039
0.5360 --- loss: 0.921258, loss_ss: 0.715298, loss_d: 0.205960
0.5743 --- loss: 1.374987, loss_ss: 1.369355, loss_d: 0.005632
0.6126 --- loss: 1.010037, loss_ss: 0.805298, loss_d: 0.204740
0.6508 --- loss: 1.393158, loss_ss: 0.879183, loss_d: 0.513975
0.6891 --- loss: 1.178809, loss_ss: 1.040073, loss_d: 0.138736
0.7274 --- loss: 1.171934, loss_ss: 1.137821, loss_d: 0.034114
0.7657 --- loss: 1.136027, loss_ss: 0.652881, loss_d: 0.483146
0.8040 --- loss: 0.957049, loss_ss: 0.829045, loss_d: 0.128004
0.8423 --- loss: 1.230688, loss_ss: 0.734385, loss_d: 0.496304
0.8806 --- loss: 0.851846, loss_ss: 0.756546, loss_d: 0.095300
0.9188 --- loss: 0.942190, loss_ss: 0.842162, loss_d: 0.100028
0.9571 --- loss: 0.827591, loss_ss: 0.795155, loss_d: 0.032436
0.9954 --- loss: 1.028323, loss_ss: 0.798487, loss_d: 0.229836
Epoch finished! Loss: 0.9938369003977355
Starting epoch 6/10.
0.0000 --- loss: 1.463083, loss_ss: 1.001174, loss_d: 0.461910
0.0383 --- loss: 0.930073, loss_ss: 0.848366, loss_d: 0.081707
0.0766 --- loss: 0.981728, loss_ss: 0.793422, loss_d: 0.188306
0.1149 --- loss: 0.932171, loss_ss: 0.857110, loss_d: 0.075062
0.1531 --- loss: 1.049055, loss_ss: 0.846184, loss_d: 0.202871
0.1914 --- loss: 1.395311, loss_ss: 0.991142, loss_d: 0.404169
0.2297 --- loss: 1.006132, loss_ss: 0.897985, loss_d: 0.108147
0.2680 --- loss: 0.863312, loss_ss: 0.833285, loss_d: 0.030027
0.3063 --- loss: 0.892174, loss_ss: 0.549015, loss_d: 0.343158
0.3446 --- loss: 0.980515, loss_ss: 0.451565, loss_d: 0.528950
0.3828 --- loss: 0.783726, loss_ss: 0.762294, loss_d: 0.021432
0.4211 --- loss: 1.056952, loss_ss: 0.835221, loss_d: 0.221731
0.4594 --- loss: 0.799238, loss_ss: 0.625950, loss_d: 0.173288
0.4977 --- loss: 0.857625, loss_ss: 0.842139, loss_d: 0.015485
0.5360 --- loss: 0.784400, loss_ss: 0.772126, loss_d: 0.012273
0.5743 --- loss: 0.913468, loss_ss: 0.659412, loss_d: 0.254055
0.6126 --- loss: 0.861247, loss_ss: 0.824074, loss_d: 0.037173
0.6508 --- loss: 2.052553, loss_ss: 0.901423, loss_d: 1.151130
0.6891 --- loss: 1.487146, loss_ss: 0.915581, loss_d: 0.571565
0.7274 --- loss: 0.793485, loss_ss: 0.724598, loss_d: 0.068887
0.7657 --- loss: 0.826954, loss_ss: 0.813810, loss_d: 0.013144
0.8040 --- loss: 0.702288, loss_ss: 0.601586, loss_d: 0.100701
0.8423 --- loss: 0.944528, loss_ss: 0.836641, loss_d: 0.107887
0.8806 --- loss: 1.011177, loss_ss: 0.657257, loss_d: 0.353920
0.9188 --- loss: 0.817052, loss_ss: 0.724252, loss_d: 0.092800
0.9571 --- loss: 0.709741, loss_ss: 0.636407, loss_d: 0.073334
0.9954 --- loss: 0.880361, loss_ss: 0.864389, loss_d: 0.015972
Epoch finished! Loss: 0.9471004694357685
Starting epoch 7/10.
0.0000 --- loss: 0.917967, loss_ss: 0.851068, loss_d: 0.066898
0.0383 --- loss: 0.746618, loss_ss: 0.722172, loss_d: 0.024446
0.0766 --- loss: 0.929810, loss_ss: 0.920812, loss_d: 0.008998
0.1149 --- loss: 0.769071, loss_ss: 0.741424, loss_d: 0.027646
0.1531 --- loss: 1.065433, loss_ss: 0.999858, loss_d: 0.065575
0.1914 --- loss: 0.900377, loss_ss: 0.672057, loss_d: 0.228320
0.2297 --- loss: 0.680561, loss_ss: 0.602198, loss_d: 0.078364
0.2680 --- loss: 0.801849, loss_ss: 0.789641, loss_d: 0.012207
0.3063 --- loss: 1.215691, loss_ss: 1.037082, loss_d: 0.178609
0.3446 --- loss: 0.846877, loss_ss: 0.837390, loss_d: 0.009487
0.3828 --- loss: 0.693563, loss_ss: 0.683827, loss_d: 0.009737
0.4211 --- loss: 0.580038, loss_ss: 0.567914, loss_d: 0.012124
0.4594 --- loss: 0.888321, loss_ss: 0.857472, loss_d: 0.030849
0.4977 --- loss: 0.810451, loss_ss: 0.781037, loss_d: 0.029414
0.5360 --- loss: 1.188743, loss_ss: 0.753557, loss_d: 0.435185
0.5743 --- loss: 0.940593, loss_ss: 0.821659, loss_d: 0.118934
0.6126 --- loss: 0.621199, loss_ss: 0.581031, loss_d: 0.040167
0.6508 --- loss: 0.755511, loss_ss: 0.592255, loss_d: 0.163256
0.6891 --- loss: 0.580911, loss_ss: 0.549781, loss_d: 0.031130
0.7274 --- loss: 0.990408, loss_ss: 0.851540, loss_d: 0.138868
0.7657 --- loss: 1.141565, loss_ss: 1.092948, loss_d: 0.048617
0.8040 --- loss: 1.308496, loss_ss: 0.655198, loss_d: 0.653297
0.8423 --- loss: 1.027280, loss_ss: 0.940821, loss_d: 0.086459
0.8806 --- loss: 0.722867, loss_ss: 0.638909, loss_d: 0.083958
0.9188 --- loss: 1.003439, loss_ss: 0.950769, loss_d: 0.052671
0.9571 --- loss: 0.958637, loss_ss: 0.914602, loss_d: 0.044035
0.9954 --- loss: 0.867467, loss_ss: 0.838916, loss_d: 0.028551
Epoch finished! Loss: 0.9020508548309063
Starting epoch 8/10.
0.0000 --- loss: 0.791078, loss_ss: 0.780940, loss_d: 0.010138
0.0383 --- loss: 1.345989, loss_ss: 1.272203, loss_d: 0.073786
0.0766 --- loss: 0.825365, loss_ss: 0.697721, loss_d: 0.127644
0.1149 --- loss: 0.823498, loss_ss: 0.702725, loss_d: 0.120773
0.1531 --- loss: 0.758346, loss_ss: 0.675710, loss_d: 0.082635
0.1914 --- loss: 0.978642, loss_ss: 0.940793, loss_d: 0.037848
0.2297 --- loss: 0.876537, loss_ss: 0.620644, loss_d: 0.255892
0.2680 --- loss: 1.188019, loss_ss: 1.146443, loss_d: 0.041576
0.3063 --- loss: 1.099195, loss_ss: 0.749669, loss_d: 0.349526
0.3446 --- loss: 0.520502, loss_ss: 0.513004, loss_d: 0.007498
0.3828 --- loss: 0.665737, loss_ss: 0.606785, loss_d: 0.058953
0.4211 --- loss: 0.831746, loss_ss: 0.802632, loss_d: 0.029114
0.4594 --- loss: 0.841124, loss_ss: 0.813539, loss_d: 0.027585
0.4977 --- loss: 1.286194, loss_ss: 0.632755, loss_d: 0.653439
0.5360 --- loss: 1.191448, loss_ss: 0.851982, loss_d: 0.339466
0.5743 --- loss: 0.897087, loss_ss: 0.864602, loss_d: 0.032486
0.6126 --- loss: 0.644252, loss_ss: 0.628094, loss_d: 0.016158
0.6508 --- loss: 0.714774, loss_ss: 0.701103, loss_d: 0.013671
0.6891 --- loss: 0.744877, loss_ss: 0.707215, loss_d: 0.037662
0.7274 --- loss: 0.732835, loss_ss: 0.682942, loss_d: 0.049893
0.7657 --- loss: 0.716886, loss_ss: 0.616788, loss_d: 0.100098
0.8040 --- loss: 0.611101, loss_ss: 0.597744, loss_d: 0.013357
0.8423 --- loss: 0.905998, loss_ss: 0.901814, loss_d: 0.004184
0.8806 --- loss: 0.949856, loss_ss: 0.920203, loss_d: 0.029654
0.9188 --- loss: 0.908401, loss_ss: 0.818084, loss_d: 0.090317
0.9571 --- loss: 0.924229, loss_ss: 0.920038, loss_d: 0.004191
0.9954 --- loss: 0.798132, loss_ss: 0.791583, loss_d: 0.006549
Epoch finished! Loss: 0.8727864472345374
Starting epoch 9/10.
0.0000 --- loss: 0.994858, loss_ss: 0.980024, loss_d: 0.014834
0.0383 --- loss: 0.713271, loss_ss: 0.694157, loss_d: 0.019115
0.0766 --- loss: 0.790256, loss_ss: 0.736634, loss_d: 0.053623
0.1149 --- loss: 0.731637, loss_ss: 0.642954, loss_d: 0.088682
0.1531 --- loss: 0.712775, loss_ss: 0.679931, loss_d: 0.032843
0.1914 --- loss: 1.314723, loss_ss: 1.302472, loss_d: 0.012252
0.2297 --- loss: 0.723091, loss_ss: 0.696488, loss_d: 0.026603
0.2680 --- loss: 0.654691, loss_ss: 0.642175, loss_d: 0.012516
0.3063 --- loss: 1.389845, loss_ss: 0.778034, loss_d: 0.611811
0.3446 --- loss: 0.944664, loss_ss: 0.842168, loss_d: 0.102495
0.3828 --- loss: 1.094639, loss_ss: 0.978335, loss_d: 0.116304
0.4211 --- loss: 0.824216, loss_ss: 0.815019, loss_d: 0.009197
0.4594 --- loss: 0.586982, loss_ss: 0.550107, loss_d: 0.036875
0.4977 --- loss: 1.012385, loss_ss: 0.953423, loss_d: 0.058962
0.5360 --- loss: 0.784133, loss_ss: 0.734755, loss_d: 0.049378
0.5743 --- loss: 0.894597, loss_ss: 0.869780, loss_d: 0.024818
0.6126 --- loss: 0.782064, loss_ss: 0.611042, loss_d: 0.171022
0.6508 --- loss: 0.817719, loss_ss: 0.768088, loss_d: 0.049630
0.6891 --- loss: 0.949012, loss_ss: 0.939190, loss_d: 0.009822
0.7274 --- loss: 1.170124, loss_ss: 1.017950, loss_d: 0.152174
0.7657 --- loss: 0.729776, loss_ss: 0.720471, loss_d: 0.009305
0.8040 --- loss: 0.959828, loss_ss: 0.953632, loss_d: 0.006196
0.8423 --- loss: 0.709776, loss_ss: 0.707828, loss_d: 0.001949
0.8806 --- loss: 0.804550, loss_ss: 0.791607, loss_d: 0.012943
0.9188 --- loss: 0.734580, loss_ss: 0.697568, loss_d: 0.037012
0.9571 --- loss: 1.204915, loss_ss: 0.969771, loss_d: 0.235144
0.9954 --- loss: 0.780194, loss_ss: 0.546101, loss_d: 0.234093
Epoch finished! Loss: 0.842616375378722
Starting epoch 10/10.
0.0000 --- loss: 0.856085, loss_ss: 0.732485, loss_d: 0.123600
0.0383 --- loss: 0.579182, loss_ss: 0.548938, loss_d: 0.030244
0.0766 --- loss: 1.010903, loss_ss: 0.722280, loss_d: 0.288623
0.1149 --- loss: 1.203276, loss_ss: 0.951944, loss_d: 0.251332
0.1531 --- loss: 1.014601, loss_ss: 1.002679, loss_d: 0.011922
0.1914 --- loss: 0.691652, loss_ss: 0.639107, loss_d: 0.052545
0.2297 --- loss: 0.738237, loss_ss: 0.731522, loss_d: 0.006715
0.2680 --- loss: 0.820221, loss_ss: 0.795018, loss_d: 0.025203
0.3063 --- loss: 0.892255, loss_ss: 0.643983, loss_d: 0.248272
0.3446 --- loss: 0.975380, loss_ss: 0.965674, loss_d: 0.009706
0.3828 --- loss: 0.784238, loss_ss: 0.626422, loss_d: 0.157816
0.4211 --- loss: 0.802822, loss_ss: 0.792605, loss_d: 0.010217
0.4594 --- loss: 0.894569, loss_ss: 0.825282, loss_d: 0.069287
0.4977 --- loss: 0.701713, loss_ss: 0.681115, loss_d: 0.020598
0.5360 --- loss: 1.022660, loss_ss: 0.926948, loss_d: 0.095712
0.5743 --- loss: 0.972817, loss_ss: 0.959152, loss_d: 0.013665
0.6126 --- loss: 0.670938, loss_ss: 0.509041, loss_d: 0.161897
0.6508 --- loss: 0.600195, loss_ss: 0.558404, loss_d: 0.041791
0.6891 --- loss: 0.889077, loss_ss: 0.877792, loss_d: 0.011285
0.7274 --- loss: 0.947524, loss_ss: 0.826746, loss_d: 0.120778
0.7657 --- loss: 1.133692, loss_ss: 0.921344, loss_d: 0.212349
0.8040 --- loss: 0.579705, loss_ss: 0.569153, loss_d: 0.010552
0.8423 --- loss: 1.032552, loss_ss: 0.922397, loss_d: 0.110154
0.8806 --- loss: 0.801267, loss_ss: 0.796955, loss_d: 0.004312
0.9188 --- loss: 0.972419, loss_ss: 0.652729, loss_d: 0.319690
0.9571 --- loss: 0.845989, loss_ss: 0.811823, loss_d: 0.034166
0.9954 --- loss: 0.753315, loss_ss: 0.633765, loss_d: 0.119551
Epoch finished! Loss: 0.8528448858251974
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.9051282051282051
             precision    recall  f1-score   support

        0.0       0.82      0.96      0.88        78
        1.0       0.50      0.08      0.14        50
        2.0       0.93      0.95      0.94       397
        3.0       0.92      1.00      0.96       143
        4.0       0.90      0.96      0.93       112

avg / total       0.88      0.91      0.88       780
 


====== chc001-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  97.44   96.15   97.58  81.52     88.24
1  93.59    8.00   99.45  50.00     13.79
2  93.85   94.96   92.69  93.09     94.01
3  98.33  100.00   97.96  91.67     95.65
4  97.82   95.54   98.20  89.92     92.64
Total accuracy: 90.51%
Average sen: 78.93%
Average spec: 97.18%
Macro f1-score: 76.87%
Diagnosis acc on 15mins: 1.0
[0.32124671 0.01902892 0.00367537 0.02166375 0.12696943 0.30961445
 0.00183584 0.01317502 0.05195382 0.02712458 0.1377784  0.16789095
 0.01555363 0.00466635 0.01349464 0.03032326 0.03107427 0.408456
 0.24311812 0.15241295 0.04324037 0.01818945 0.01408111 0.00129979
 0.00075059 0.00064011]
pred: 0.08381761115966722, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.375487, loss_ss: 1.668270, loss_d: 0.707217
0.0384 --- loss: 2.291790, loss_ss: 1.580360, loss_d: 0.711430
0.0768 --- loss: 2.287195, loss_ss: 1.576247, loss_d: 0.710948
0.1153 --- loss: 2.313007, loss_ss: 1.634272, loss_d: 0.678735
0.1537 --- loss: 2.045452, loss_ss: 1.416241, loss_d: 0.629211
0.1921 --- loss: 1.992401, loss_ss: 1.390257, loss_d: 0.602145
0.2305 --- loss: 1.833639, loss_ss: 1.584759, loss_d: 0.248879
0.2689 --- loss: 2.027395, loss_ss: 1.463094, loss_d: 0.564302
0.3073 --- loss: 1.666850, loss_ss: 1.264669, loss_d: 0.402181
0.3458 --- loss: 1.980050, loss_ss: 1.415314, loss_d: 0.564737
0.3842 --- loss: 2.005927, loss_ss: 1.302829, loss_d: 0.703098
0.4226 --- loss: 2.345711, loss_ss: 1.407944, loss_d: 0.937768
0.4610 --- loss: 2.082074, loss_ss: 1.215499, loss_d: 0.866576
0.4994 --- loss: 1.845872, loss_ss: 1.257935, loss_d: 0.587937
0.5378 --- loss: 1.637605, loss_ss: 1.220595, loss_d: 0.417009
0.5763 --- loss: 1.860536, loss_ss: 1.392605, loss_d: 0.467931
0.6147 --- loss: 1.838136, loss_ss: 1.117164, loss_d: 0.720973
0.6531 --- loss: 1.643996, loss_ss: 1.115643, loss_d: 0.528354
0.6915 --- loss: 1.906696, loss_ss: 1.428055, loss_d: 0.478640
0.7299 --- loss: 2.123579, loss_ss: 1.378882, loss_d: 0.744696
0.7683 --- loss: 1.718342, loss_ss: 1.363235, loss_d: 0.355107
0.8068 --- loss: 1.828569, loss_ss: 1.279378, loss_d: 0.549191
0.8452 --- loss: 1.618701, loss_ss: 1.115034, loss_d: 0.503667
0.8836 --- loss: 1.529606, loss_ss: 1.092169, loss_d: 0.437437
0.9220 --- loss: 1.794284, loss_ss: 1.269317, loss_d: 0.524967
0.9604 --- loss: 1.527315, loss_ss: 1.182557, loss_d: 0.344757
0.9988 --- loss: 1.047747, loss_ss: 0.898060, loss_d: 0.149687
Epoch finished! Loss: 1.9001683744100424
Starting epoch 2/10.
0.0000 --- loss: 1.452870, loss_ss: 1.209425, loss_d: 0.243445
0.0384 --- loss: 1.448897, loss_ss: 1.246403, loss_d: 0.202494
0.0768 --- loss: 1.440976, loss_ss: 1.128304, loss_d: 0.312672
0.1153 --- loss: 1.532881, loss_ss: 1.220334, loss_d: 0.312547
0.1537 --- loss: 1.417574, loss_ss: 1.025381, loss_d: 0.392193
0.1921 --- loss: 1.189514, loss_ss: 0.975217, loss_d: 0.214297
0.2305 --- loss: 1.551222, loss_ss: 1.278560, loss_d: 0.272662
0.2689 --- loss: 1.434238, loss_ss: 0.937343, loss_d: 0.496895
0.3073 --- loss: 1.522289, loss_ss: 1.247707, loss_d: 0.274581
0.3458 --- loss: 1.273749, loss_ss: 1.151084, loss_d: 0.122665
0.3842 --- loss: 1.596630, loss_ss: 0.903398, loss_d: 0.693231
0.4226 --- loss: 1.463535, loss_ss: 1.262336, loss_d: 0.201198
0.4610 --- loss: 1.090537, loss_ss: 0.953931, loss_d: 0.136605
0.4994 --- loss: 1.112690, loss_ss: 0.981817, loss_d: 0.130874
0.5378 --- loss: 1.034004, loss_ss: 0.976292, loss_d: 0.057712
0.5763 --- loss: 1.011771, loss_ss: 0.937386, loss_d: 0.074385
0.6147 --- loss: 1.648132, loss_ss: 1.064406, loss_d: 0.583727
0.6531 --- loss: 1.295652, loss_ss: 1.078610, loss_d: 0.217042
0.6915 --- loss: 1.318302, loss_ss: 1.075928, loss_d: 0.242373
0.7299 --- loss: 1.107636, loss_ss: 0.979913, loss_d: 0.127724
0.7683 --- loss: 1.069916, loss_ss: 0.977343, loss_d: 0.092573
0.8068 --- loss: 1.018590, loss_ss: 0.914862, loss_d: 0.103728
0.8452 --- loss: 1.251790, loss_ss: 1.083312, loss_d: 0.168478
0.8836 --- loss: 0.997322, loss_ss: 0.763862, loss_d: 0.233460
0.9220 --- loss: 1.071064, loss_ss: 0.941549, loss_d: 0.129515
0.9604 --- loss: 1.472916, loss_ss: 0.938423, loss_d: 0.534493
0.9988 --- loss: 1.976207, loss_ss: 1.500334, loss_d: 0.475874
Epoch finished! Loss: 1.3824477198032232
Starting epoch 3/10.
0.0000 --- loss: 1.073186, loss_ss: 0.965966, loss_d: 0.107220
0.0384 --- loss: 1.279445, loss_ss: 1.146349, loss_d: 0.133097
0.0768 --- loss: 1.049382, loss_ss: 0.952885, loss_d: 0.096497
0.1153 --- loss: 1.543927, loss_ss: 1.197508, loss_d: 0.346418
0.1537 --- loss: 1.197706, loss_ss: 1.025450, loss_d: 0.172256
0.1921 --- loss: 1.255241, loss_ss: 1.135895, loss_d: 0.119346
0.2305 --- loss: 1.431443, loss_ss: 1.014573, loss_d: 0.416870
0.2689 --- loss: 1.366171, loss_ss: 0.933231, loss_d: 0.432939
0.3073 --- loss: 0.926351, loss_ss: 0.814324, loss_d: 0.112027
0.3458 --- loss: 1.183468, loss_ss: 1.123327, loss_d: 0.060140
0.3842 --- loss: 1.054672, loss_ss: 0.864866, loss_d: 0.189806
0.4226 --- loss: 1.050264, loss_ss: 0.939186, loss_d: 0.111079
0.4610 --- loss: 1.397102, loss_ss: 1.132381, loss_d: 0.264721
0.4994 --- loss: 1.727747, loss_ss: 0.979658, loss_d: 0.748088
0.5378 --- loss: 1.147863, loss_ss: 0.917984, loss_d: 0.229879
0.5763 --- loss: 1.198188, loss_ss: 1.049215, loss_d: 0.148973
0.6147 --- loss: 1.023436, loss_ss: 0.946760, loss_d: 0.076676
0.6531 --- loss: 1.011605, loss_ss: 0.888998, loss_d: 0.122606
0.6915 --- loss: 1.023131, loss_ss: 0.866897, loss_d: 0.156234
0.7299 --- loss: 1.334105, loss_ss: 0.863685, loss_d: 0.470420
0.7683 --- loss: 1.246683, loss_ss: 1.029904, loss_d: 0.216779
0.8068 --- loss: 1.743621, loss_ss: 1.359282, loss_d: 0.384339
0.8452 --- loss: 1.051905, loss_ss: 0.724891, loss_d: 0.327013
0.8836 --- loss: 1.441068, loss_ss: 0.857851, loss_d: 0.583218
0.9220 --- loss: 1.040938, loss_ss: 0.958703, loss_d: 0.082235
0.9604 --- loss: 1.006733, loss_ss: 0.947051, loss_d: 0.059683
0.9988 --- loss: 1.210383, loss_ss: 1.102750, loss_d: 0.107633
Epoch finished! Loss: 1.1936948331502768
Starting epoch 4/10.
0.0000 --- loss: 0.991386, loss_ss: 0.957042, loss_d: 0.034344
0.0384 --- loss: 0.985866, loss_ss: 0.765027, loss_d: 0.220839
0.0768 --- loss: 1.167220, loss_ss: 1.034743, loss_d: 0.132477
0.1153 --- loss: 1.075163, loss_ss: 1.013998, loss_d: 0.061165
0.1537 --- loss: 1.052356, loss_ss: 0.788292, loss_d: 0.264065
0.1921 --- loss: 1.238207, loss_ss: 0.869861, loss_d: 0.368347
0.2305 --- loss: 0.763158, loss_ss: 0.737982, loss_d: 0.025175
0.2689 --- loss: 1.142704, loss_ss: 1.045831, loss_d: 0.096873
0.3073 --- loss: 1.460423, loss_ss: 1.134923, loss_d: 0.325500
0.3458 --- loss: 0.878085, loss_ss: 0.744376, loss_d: 0.133709
0.3842 --- loss: 0.914684, loss_ss: 0.855401, loss_d: 0.059283
0.4226 --- loss: 1.138877, loss_ss: 1.012142, loss_d: 0.126735
0.4610 --- loss: 0.790286, loss_ss: 0.764662, loss_d: 0.025624
0.4994 --- loss: 0.926439, loss_ss: 0.757357, loss_d: 0.169083
0.5378 --- loss: 1.128273, loss_ss: 0.927019, loss_d: 0.201254
0.5763 --- loss: 0.742894, loss_ss: 0.702772, loss_d: 0.040122
0.6147 --- loss: 1.103274, loss_ss: 0.890373, loss_d: 0.212901
0.6531 --- loss: 0.974211, loss_ss: 0.838523, loss_d: 0.135688
0.6915 --- loss: 0.895718, loss_ss: 0.767999, loss_d: 0.127719
0.7299 --- loss: 1.231445, loss_ss: 0.775071, loss_d: 0.456374
0.7683 --- loss: 1.255014, loss_ss: 0.838456, loss_d: 0.416559
0.8068 --- loss: 0.927423, loss_ss: 0.882240, loss_d: 0.045183
0.8452 --- loss: 0.975067, loss_ss: 0.883890, loss_d: 0.091177
0.8836 --- loss: 1.242047, loss_ss: 1.026909, loss_d: 0.215137
0.9220 --- loss: 1.213808, loss_ss: 1.096136, loss_d: 0.117673
0.9604 --- loss: 1.147475, loss_ss: 0.877231, loss_d: 0.270244
0.9988 --- loss: 1.371392, loss_ss: 0.605013, loss_d: 0.766380
Epoch finished! Loss: 1.0602341622114182
Starting epoch 5/10.
0.0000 --- loss: 0.854621, loss_ss: 0.792534, loss_d: 0.062087
0.0384 --- loss: 1.508084, loss_ss: 0.945396, loss_d: 0.562688
0.0768 --- loss: 1.255962, loss_ss: 1.130070, loss_d: 0.125892
0.1153 --- loss: 0.938286, loss_ss: 0.898652, loss_d: 0.039634
0.1537 --- loss: 0.992747, loss_ss: 0.880511, loss_d: 0.112235
0.1921 --- loss: 0.860961, loss_ss: 0.718728, loss_d: 0.142233
0.2305 --- loss: 1.065208, loss_ss: 0.664322, loss_d: 0.400886
0.2689 --- loss: 1.332259, loss_ss: 1.035764, loss_d: 0.296495
0.3073 --- loss: 0.934597, loss_ss: 0.814888, loss_d: 0.119709
0.3458 --- loss: 0.966401, loss_ss: 0.867026, loss_d: 0.099375
0.3842 --- loss: 1.751808, loss_ss: 0.777985, loss_d: 0.973823
0.4226 --- loss: 1.242119, loss_ss: 1.007732, loss_d: 0.234387
0.4610 --- loss: 0.794801, loss_ss: 0.660322, loss_d: 0.134480
0.4994 --- loss: 0.842884, loss_ss: 0.651399, loss_d: 0.191485
0.5378 --- loss: 1.358234, loss_ss: 1.247023, loss_d: 0.111211
0.5763 --- loss: 0.846539, loss_ss: 0.811579, loss_d: 0.034960
0.6147 --- loss: 1.210286, loss_ss: 0.887658, loss_d: 0.322627
0.6531 --- loss: 0.921247, loss_ss: 0.684849, loss_d: 0.236397
0.6915 --- loss: 0.958191, loss_ss: 0.924325, loss_d: 0.033867
0.7299 --- loss: 1.078599, loss_ss: 0.968226, loss_d: 0.110373
0.7683 --- loss: 0.928746, loss_ss: 0.658666, loss_d: 0.270080
0.8068 --- loss: 0.784075, loss_ss: 0.763363, loss_d: 0.020712
0.8452 --- loss: 1.110799, loss_ss: 0.935306, loss_d: 0.175494
0.8836 --- loss: 0.951377, loss_ss: 0.913880, loss_d: 0.037497
0.9220 --- loss: 0.765279, loss_ss: 0.703237, loss_d: 0.062042
0.9604 --- loss: 1.099286, loss_ss: 0.850043, loss_d: 0.249243
0.9988 --- loss: 1.787357, loss_ss: 0.703289, loss_d: 1.084068
Epoch finished! Loss: 1.0330277094474205
Starting epoch 6/10.
0.0000 --- loss: 0.711981, loss_ss: 0.648664, loss_d: 0.063317
0.0384 --- loss: 0.844709, loss_ss: 0.718519, loss_d: 0.126190
0.0768 --- loss: 1.269952, loss_ss: 0.976610, loss_d: 0.293342
0.1153 --- loss: 0.771823, loss_ss: 0.730491, loss_d: 0.041332
0.1537 --- loss: 0.902371, loss_ss: 0.874601, loss_d: 0.027771
0.1921 --- loss: 1.000403, loss_ss: 0.948067, loss_d: 0.052336
0.2305 --- loss: 0.858417, loss_ss: 0.744285, loss_d: 0.114132
0.2689 --- loss: 1.072314, loss_ss: 0.832315, loss_d: 0.239998
0.3073 --- loss: 1.472063, loss_ss: 0.831545, loss_d: 0.640518
0.3458 --- loss: 1.662747, loss_ss: 1.413179, loss_d: 0.249569
0.3842 --- loss: 0.737291, loss_ss: 0.709423, loss_d: 0.027868
0.4226 --- loss: 0.924117, loss_ss: 0.834496, loss_d: 0.089621
0.4610 --- loss: 0.981712, loss_ss: 0.831433, loss_d: 0.150279
0.4994 --- loss: 0.877291, loss_ss: 0.840964, loss_d: 0.036328
0.5378 --- loss: 1.065433, loss_ss: 1.017690, loss_d: 0.047743
0.5763 --- loss: 0.983451, loss_ss: 0.703690, loss_d: 0.279761
0.6147 --- loss: 1.218210, loss_ss: 1.169257, loss_d: 0.048954
0.6531 --- loss: 0.901617, loss_ss: 0.816626, loss_d: 0.084991
0.6915 --- loss: 0.777720, loss_ss: 0.724631, loss_d: 0.053089
0.7299 --- loss: 1.383969, loss_ss: 0.955779, loss_d: 0.428190
0.7683 --- loss: 0.947739, loss_ss: 0.788201, loss_d: 0.159539
0.8068 --- loss: 0.900947, loss_ss: 0.753235, loss_d: 0.147712
0.8452 --- loss: 0.968982, loss_ss: 0.933582, loss_d: 0.035400
0.8836 --- loss: 0.880201, loss_ss: 0.757293, loss_d: 0.122909
0.9220 --- loss: 0.755673, loss_ss: 0.734717, loss_d: 0.020956
0.9604 --- loss: 0.595382, loss_ss: 0.576899, loss_d: 0.018483
0.9988 --- loss: 1.537269, loss_ss: 0.969188, loss_d: 0.568082
Epoch finished! Loss: 0.9636538181167382
Starting epoch 7/10.
0.0000 --- loss: 0.909637, loss_ss: 0.896498, loss_d: 0.013140
0.0384 --- loss: 1.013642, loss_ss: 0.936323, loss_d: 0.077319
0.0768 --- loss: 0.846895, loss_ss: 0.814546, loss_d: 0.032349
0.1153 --- loss: 0.811041, loss_ss: 0.735913, loss_d: 0.075128
0.1537 --- loss: 1.075052, loss_ss: 0.914717, loss_d: 0.160335
0.1921 --- loss: 1.092112, loss_ss: 0.821533, loss_d: 0.270579
0.2305 --- loss: 1.157879, loss_ss: 0.766562, loss_d: 0.391317
0.2689 --- loss: 0.974110, loss_ss: 0.784773, loss_d: 0.189336
0.3073 --- loss: 0.949833, loss_ss: 0.927425, loss_d: 0.022408
0.3458 --- loss: 1.124066, loss_ss: 1.031718, loss_d: 0.092348
0.3842 --- loss: 0.695917, loss_ss: 0.662928, loss_d: 0.032989
0.4226 --- loss: 1.069364, loss_ss: 1.009419, loss_d: 0.059945
0.4610 --- loss: 0.987076, loss_ss: 0.948238, loss_d: 0.038838
0.4994 --- loss: 0.760977, loss_ss: 0.638443, loss_d: 0.122534
0.5378 --- loss: 0.995132, loss_ss: 0.758972, loss_d: 0.236159
0.5763 --- loss: 0.828053, loss_ss: 0.778115, loss_d: 0.049938
0.6147 --- loss: 0.654566, loss_ss: 0.571373, loss_d: 0.083193
0.6531 --- loss: 0.980179, loss_ss: 0.962245, loss_d: 0.017934
0.6915 --- loss: 0.765810, loss_ss: 0.724141, loss_d: 0.041669
0.7299 --- loss: 0.759861, loss_ss: 0.653114, loss_d: 0.106746
0.7683 --- loss: 0.694770, loss_ss: 0.675110, loss_d: 0.019660
0.8068 --- loss: 0.992241, loss_ss: 0.848620, loss_d: 0.143620
0.8452 --- loss: 0.799500, loss_ss: 0.715405, loss_d: 0.084095
0.8836 --- loss: 0.896585, loss_ss: 0.868195, loss_d: 0.028390
0.9220 --- loss: 0.781509, loss_ss: 0.573313, loss_d: 0.208195
0.9604 --- loss: 0.912252, loss_ss: 0.816472, loss_d: 0.095780
0.9988 --- loss: 1.310931, loss_ss: 1.187971, loss_d: 0.122960
Epoch finished! Loss: 0.9199868644659336
Starting epoch 8/10.
0.0000 --- loss: 0.655011, loss_ss: 0.635532, loss_d: 0.019479
0.0384 --- loss: 1.296961, loss_ss: 0.852188, loss_d: 0.444773
0.0768 --- loss: 0.617902, loss_ss: 0.575728, loss_d: 0.042175
0.1153 --- loss: 0.996958, loss_ss: 0.952302, loss_d: 0.044657
0.1537 --- loss: 0.831602, loss_ss: 0.817965, loss_d: 0.013637
0.1921 --- loss: 0.917595, loss_ss: 0.866590, loss_d: 0.051005
0.2305 --- loss: 1.012557, loss_ss: 0.810751, loss_d: 0.201806
0.2689 --- loss: 0.676706, loss_ss: 0.637516, loss_d: 0.039189
0.3073 --- loss: 0.446102, loss_ss: 0.398279, loss_d: 0.047823
0.3458 --- loss: 0.744321, loss_ss: 0.676126, loss_d: 0.068195
0.3842 --- loss: 0.618594, loss_ss: 0.611135, loss_d: 0.007460
0.4226 --- loss: 0.749837, loss_ss: 0.633620, loss_d: 0.116218
0.4610 --- loss: 0.859231, loss_ss: 0.844237, loss_d: 0.014995
0.4994 --- loss: 1.198283, loss_ss: 0.913005, loss_d: 0.285278
0.5378 --- loss: 1.303882, loss_ss: 0.862357, loss_d: 0.441526
0.5763 --- loss: 0.701598, loss_ss: 0.642843, loss_d: 0.058755
0.6147 --- loss: 0.653754, loss_ss: 0.614408, loss_d: 0.039345
0.6531 --- loss: 0.710806, loss_ss: 0.686899, loss_d: 0.023907
0.6915 --- loss: 0.870800, loss_ss: 0.763199, loss_d: 0.107601
0.7299 --- loss: 1.025148, loss_ss: 0.537772, loss_d: 0.487376
0.7683 --- loss: 1.080052, loss_ss: 0.787602, loss_d: 0.292450
0.8068 --- loss: 0.754002, loss_ss: 0.680678, loss_d: 0.073324
0.8452 --- loss: 0.849096, loss_ss: 0.822912, loss_d: 0.026184
0.8836 --- loss: 0.632413, loss_ss: 0.625213, loss_d: 0.007200
0.9220 --- loss: 0.822406, loss_ss: 0.812463, loss_d: 0.009943
0.9604 --- loss: 0.822540, loss_ss: 0.666054, loss_d: 0.156486
0.9988 --- loss: 0.725876, loss_ss: 0.710188, loss_d: 0.015688
Epoch finished! Loss: 0.9108607435455689
Starting epoch 9/10.
0.0000 --- loss: 0.701985, loss_ss: 0.690880, loss_d: 0.011105
0.0384 --- loss: 0.940033, loss_ss: 0.606210, loss_d: 0.333824
0.0768 --- loss: 1.077971, loss_ss: 0.987598, loss_d: 0.090373
0.1153 --- loss: 1.174942, loss_ss: 0.643584, loss_d: 0.531359
0.1537 --- loss: 0.558972, loss_ss: 0.541860, loss_d: 0.017112
0.1921 --- loss: 0.812369, loss_ss: 0.665681, loss_d: 0.146687
0.2305 --- loss: 0.801446, loss_ss: 0.686202, loss_d: 0.115244
0.2689 --- loss: 0.711680, loss_ss: 0.686324, loss_d: 0.025356
0.3073 --- loss: 0.812025, loss_ss: 0.662426, loss_d: 0.149599
0.3458 --- loss: 0.848050, loss_ss: 0.819699, loss_d: 0.028350
0.3842 --- loss: 0.667702, loss_ss: 0.591059, loss_d: 0.076643
0.4226 --- loss: 0.761855, loss_ss: 0.753857, loss_d: 0.007998
0.4610 --- loss: 0.672873, loss_ss: 0.641855, loss_d: 0.031018
0.4994 --- loss: 0.859994, loss_ss: 0.826178, loss_d: 0.033816
0.5378 --- loss: 0.914110, loss_ss: 0.909222, loss_d: 0.004888
0.5763 --- loss: 0.955932, loss_ss: 0.950303, loss_d: 0.005629
0.6147 --- loss: 0.963439, loss_ss: 0.957069, loss_d: 0.006371
0.6531 --- loss: 0.760206, loss_ss: 0.755706, loss_d: 0.004500
0.6915 --- loss: 0.808789, loss_ss: 0.801975, loss_d: 0.006815
0.7299 --- loss: 0.848850, loss_ss: 0.838834, loss_d: 0.010015
0.7683 --- loss: 0.725405, loss_ss: 0.675457, loss_d: 0.049949
0.8068 --- loss: 1.056250, loss_ss: 0.905702, loss_d: 0.150548
0.8452 --- loss: 1.335567, loss_ss: 0.838178, loss_d: 0.497390
0.8836 --- loss: 0.707396, loss_ss: 0.608694, loss_d: 0.098702
0.9220 --- loss: 0.739724, loss_ss: 0.697889, loss_d: 0.041835
0.9604 --- loss: 0.783001, loss_ss: 0.757357, loss_d: 0.025644
0.9988 --- loss: 1.283174, loss_ss: 1.281728, loss_d: 0.001446
Epoch finished! Loss: 0.8783592098034345
Starting epoch 10/10.
0.0000 --- loss: 0.840777, loss_ss: 0.804291, loss_d: 0.036486
0.0384 --- loss: 0.730160, loss_ss: 0.602789, loss_d: 0.127370
0.0768 --- loss: 0.740563, loss_ss: 0.721762, loss_d: 0.018801
0.1153 --- loss: 0.752430, loss_ss: 0.711562, loss_d: 0.040869
0.1537 --- loss: 0.593569, loss_ss: 0.582254, loss_d: 0.011315
0.1921 --- loss: 0.577214, loss_ss: 0.553252, loss_d: 0.023963
0.2305 --- loss: 0.923462, loss_ss: 0.897423, loss_d: 0.026038
0.2689 --- loss: 0.950062, loss_ss: 0.938318, loss_d: 0.011744
0.3073 --- loss: 0.619609, loss_ss: 0.592270, loss_d: 0.027338
0.3458 --- loss: 0.749271, loss_ss: 0.679353, loss_d: 0.069918
0.3842 --- loss: 0.959882, loss_ss: 0.925820, loss_d: 0.034062
0.4226 --- loss: 0.571048, loss_ss: 0.558230, loss_d: 0.012817
0.4610 --- loss: 1.007846, loss_ss: 0.969175, loss_d: 0.038670
0.4994 --- loss: 0.798052, loss_ss: 0.793311, loss_d: 0.004741
0.5378 --- loss: 1.154437, loss_ss: 0.956014, loss_d: 0.198423
0.5763 --- loss: 0.751643, loss_ss: 0.740178, loss_d: 0.011465
0.6147 --- loss: 0.870118, loss_ss: 0.794894, loss_d: 0.075224
0.6531 --- loss: 0.540596, loss_ss: 0.532431, loss_d: 0.008165
0.6915 --- loss: 0.666683, loss_ss: 0.641222, loss_d: 0.025460
0.7299 --- loss: 0.732823, loss_ss: 0.677362, loss_d: 0.055461
0.7683 --- loss: 0.910414, loss_ss: 0.754544, loss_d: 0.155870
0.8068 --- loss: 0.805604, loss_ss: 0.779624, loss_d: 0.025980
0.8452 --- loss: 1.308794, loss_ss: 1.266487, loss_d: 0.042307
0.8836 --- loss: 0.794857, loss_ss: 0.786591, loss_d: 0.008266
0.9220 --- loss: 1.478627, loss_ss: 1.143564, loss_d: 0.335063
0.9604 --- loss: 0.980324, loss_ss: 0.810620, loss_d: 0.169704
0.9988 --- loss: 1.250076, loss_ss: 0.677930, loss_d: 0.572146
Epoch finished! Loss: 0.877086492226674
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8304761904761905
             precision    recall  f1-score   support

        0.0       0.82      0.84      0.83        74
        1.0       0.33      0.57      0.42        42
        2.0       0.87      0.87      0.87       515
        3.0       0.87      0.82      0.84       243
        4.0       0.88      0.78      0.83       176

avg / total       0.85      0.83      0.84      1050
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.52  83.78   98.57  81.58     82.67
1  93.62  57.14   95.14  32.88     41.74
2  87.52  87.38   87.66  87.21     87.29
3  92.86  81.89   96.16  86.52     84.14
4  94.57  77.84   97.94  88.39     82.78
Total accuracy: 83.05%
Average sen: 77.61%
Average spec: 95.09%
Macro f1-score: 75.72%
Diagnosis acc on 15mins: 0.05714285714285714
[0.9981997  0.2362633  0.93946648 0.98006517 0.99439973 0.9992047
 0.99877232 0.99795842 0.98987621 0.74588227 0.56296569 0.58111745
 0.89794707 0.78980875 0.87504333 0.93113881 0.92795354 0.58003807
 0.96675038 0.94875199 0.9398011  0.9804371  0.99875212 0.97835332
 0.19498612 0.86667019 0.99827158 0.98540527 0.9548955  0.76971728
 0.98616415 0.93184245 0.94888633 0.98993611 0.99809378]
pred: 0.870394736954144, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.438232, loss_ss: 1.786292, loss_d: 0.651940
0.0384 --- loss: 2.090551, loss_ss: 1.527069, loss_d: 0.563482
0.0767 --- loss: 1.945055, loss_ss: 1.546828, loss_d: 0.398227
0.1151 --- loss: 2.758955, loss_ss: 1.545306, loss_d: 1.213650
0.1534 --- loss: 2.140289, loss_ss: 1.483882, loss_d: 0.656407
0.1918 --- loss: 1.832869, loss_ss: 1.478114, loss_d: 0.354755
0.2301 --- loss: 2.149249, loss_ss: 1.502964, loss_d: 0.646286
0.2685 --- loss: 1.824995, loss_ss: 1.351838, loss_d: 0.473156
0.3069 --- loss: 1.956314, loss_ss: 1.432673, loss_d: 0.523641
0.3452 --- loss: 1.855221, loss_ss: 1.481571, loss_d: 0.373651
0.3836 --- loss: 1.615575, loss_ss: 1.352247, loss_d: 0.263328
0.4219 --- loss: 1.809949, loss_ss: 1.424778, loss_d: 0.385171
0.4603 --- loss: 1.964706, loss_ss: 1.416791, loss_d: 0.547915
0.4987 --- loss: 1.861482, loss_ss: 1.352944, loss_d: 0.508538
0.5370 --- loss: 1.905993, loss_ss: 1.292716, loss_d: 0.613277
0.5754 --- loss: 2.123534, loss_ss: 1.488413, loss_d: 0.635121
0.6137 --- loss: 2.002157, loss_ss: 1.274832, loss_d: 0.727325
0.6521 --- loss: 2.014217, loss_ss: 1.328307, loss_d: 0.685909
0.6904 --- loss: 1.756514, loss_ss: 1.323619, loss_d: 0.432895
0.7288 --- loss: 1.844027, loss_ss: 1.397648, loss_d: 0.446379
0.7672 --- loss: 1.793569, loss_ss: 1.368717, loss_d: 0.424852
0.8055 --- loss: 1.492592, loss_ss: 1.224518, loss_d: 0.268073
0.8439 --- loss: 1.704103, loss_ss: 1.142511, loss_d: 0.561591
0.8822 --- loss: 1.615692, loss_ss: 1.249439, loss_d: 0.366252
0.9206 --- loss: 1.822557, loss_ss: 1.179988, loss_d: 0.642569
0.9590 --- loss: 1.605426, loss_ss: 1.234537, loss_d: 0.370889
0.9973 --- loss: 1.267134, loss_ss: 1.092391, loss_d: 0.174743
Epoch finished! Loss: 1.9135129717680124
Starting epoch 2/10.
0.0000 --- loss: 2.011219, loss_ss: 1.527388, loss_d: 0.483831
0.0384 --- loss: 1.295133, loss_ss: 1.126332, loss_d: 0.168801
0.0767 --- loss: 1.603530, loss_ss: 1.339747, loss_d: 0.263783
0.1151 --- loss: 1.614698, loss_ss: 1.105094, loss_d: 0.509604
0.1534 --- loss: 1.214787, loss_ss: 0.900158, loss_d: 0.314629
0.1918 --- loss: 1.548445, loss_ss: 1.171686, loss_d: 0.376759
0.2301 --- loss: 1.831243, loss_ss: 1.157314, loss_d: 0.673929
0.2685 --- loss: 1.523781, loss_ss: 1.036963, loss_d: 0.486818
0.3069 --- loss: 1.369359, loss_ss: 1.020713, loss_d: 0.348646
0.3452 --- loss: 1.366262, loss_ss: 1.116967, loss_d: 0.249296
0.3836 --- loss: 1.773634, loss_ss: 1.393686, loss_d: 0.379948
0.4219 --- loss: 1.509479, loss_ss: 1.058068, loss_d: 0.451410
0.4603 --- loss: 1.143912, loss_ss: 0.990935, loss_d: 0.152977
0.4987 --- loss: 1.132722, loss_ss: 0.901435, loss_d: 0.231288
0.5370 --- loss: 2.128686, loss_ss: 1.039599, loss_d: 1.089088
0.5754 --- loss: 1.343855, loss_ss: 1.119557, loss_d: 0.224298
0.6137 --- loss: 1.415794, loss_ss: 1.280972, loss_d: 0.134822
0.6521 --- loss: 1.660098, loss_ss: 1.037197, loss_d: 0.622901
0.6904 --- loss: 1.309414, loss_ss: 0.997988, loss_d: 0.311426
0.7288 --- loss: 1.163934, loss_ss: 0.916246, loss_d: 0.247688
0.7672 --- loss: 1.478892, loss_ss: 1.161003, loss_d: 0.317888
0.8055 --- loss: 1.540365, loss_ss: 1.084436, loss_d: 0.455929
0.8439 --- loss: 1.132941, loss_ss: 1.001114, loss_d: 0.131826
0.8822 --- loss: 1.137420, loss_ss: 1.001932, loss_d: 0.135488
0.9206 --- loss: 1.446190, loss_ss: 1.087762, loss_d: 0.358428
0.9590 --- loss: 1.809389, loss_ss: 1.051915, loss_d: 0.757473
0.9973 --- loss: 1.497117, loss_ss: 0.990327, loss_d: 0.506791
Epoch finished! Loss: 1.4293136848853185
Starting epoch 3/10.
0.0000 --- loss: 1.125767, loss_ss: 1.010989, loss_d: 0.114777
0.0384 --- loss: 0.911558, loss_ss: 0.790106, loss_d: 0.121453
0.0767 --- loss: 0.854497, loss_ss: 0.687164, loss_d: 0.167333
0.1151 --- loss: 1.208903, loss_ss: 0.919144, loss_d: 0.289759
0.1534 --- loss: 1.187501, loss_ss: 0.948045, loss_d: 0.239456
0.1918 --- loss: 0.937152, loss_ss: 0.872285, loss_d: 0.064867
0.2301 --- loss: 1.330052, loss_ss: 0.886002, loss_d: 0.444049
0.2685 --- loss: 1.149251, loss_ss: 0.913033, loss_d: 0.236218
0.3069 --- loss: 1.139065, loss_ss: 0.928309, loss_d: 0.210756
0.3452 --- loss: 1.197098, loss_ss: 0.978260, loss_d: 0.218838
0.3836 --- loss: 1.133332, loss_ss: 0.971702, loss_d: 0.161630
0.4219 --- loss: 1.016437, loss_ss: 0.815435, loss_d: 0.201002
0.4603 --- loss: 0.955998, loss_ss: 0.687316, loss_d: 0.268682
0.4987 --- loss: 1.108486, loss_ss: 0.801044, loss_d: 0.307442
0.5370 --- loss: 1.179603, loss_ss: 1.148154, loss_d: 0.031449
0.5754 --- loss: 1.232260, loss_ss: 0.771159, loss_d: 0.461102
0.6137 --- loss: 0.988658, loss_ss: 0.741948, loss_d: 0.246710
0.6521 --- loss: 1.204374, loss_ss: 1.111874, loss_d: 0.092500
0.6904 --- loss: 1.077366, loss_ss: 0.944707, loss_d: 0.132659
0.7288 --- loss: 1.113572, loss_ss: 0.906693, loss_d: 0.206879
0.7672 --- loss: 0.840127, loss_ss: 0.581929, loss_d: 0.258198
0.8055 --- loss: 0.840966, loss_ss: 0.711391, loss_d: 0.129576
0.8439 --- loss: 1.050665, loss_ss: 0.872792, loss_d: 0.177873
0.8822 --- loss: 0.991663, loss_ss: 0.906446, loss_d: 0.085217
0.9206 --- loss: 1.021770, loss_ss: 0.912279, loss_d: 0.109490
0.9590 --- loss: 1.148422, loss_ss: 1.016576, loss_d: 0.131846
0.9973 --- loss: 1.325717, loss_ss: 0.966834, loss_d: 0.358883
Epoch finished! Loss: 1.1805533633782312
Starting epoch 4/10.
0.0000 --- loss: 1.223267, loss_ss: 1.001631, loss_d: 0.221635
0.0384 --- loss: 1.708945, loss_ss: 0.681179, loss_d: 1.027767
0.0767 --- loss: 1.099060, loss_ss: 1.037353, loss_d: 0.061707
0.1151 --- loss: 1.167558, loss_ss: 0.967242, loss_d: 0.200316
0.1534 --- loss: 1.109721, loss_ss: 0.888227, loss_d: 0.221494
0.1918 --- loss: 1.049636, loss_ss: 0.619416, loss_d: 0.430220
0.2301 --- loss: 1.179692, loss_ss: 1.074538, loss_d: 0.105154
0.2685 --- loss: 1.250811, loss_ss: 0.934212, loss_d: 0.316599
0.3069 --- loss: 1.242791, loss_ss: 0.987817, loss_d: 0.254975
0.3452 --- loss: 1.216307, loss_ss: 1.074987, loss_d: 0.141320
0.3836 --- loss: 1.435603, loss_ss: 1.151947, loss_d: 0.283655
0.4219 --- loss: 0.860770, loss_ss: 0.693531, loss_d: 0.167239
0.4603 --- loss: 0.977128, loss_ss: 0.765459, loss_d: 0.211669
0.4987 --- loss: 1.088794, loss_ss: 1.057450, loss_d: 0.031343
0.5370 --- loss: 0.832893, loss_ss: 0.803808, loss_d: 0.029085
0.5754 --- loss: 0.963396, loss_ss: 0.924838, loss_d: 0.038558
0.6137 --- loss: 0.969956, loss_ss: 0.931566, loss_d: 0.038389
0.6521 --- loss: 0.800528, loss_ss: 0.758493, loss_d: 0.042036
0.6904 --- loss: 0.826184, loss_ss: 0.756456, loss_d: 0.069728
0.7288 --- loss: 0.706988, loss_ss: 0.627755, loss_d: 0.079232
0.7672 --- loss: 1.306673, loss_ss: 1.212179, loss_d: 0.094493
0.8055 --- loss: 0.881440, loss_ss: 0.764631, loss_d: 0.116809
0.8439 --- loss: 1.120979, loss_ss: 0.811571, loss_d: 0.309407
0.8822 --- loss: 1.062343, loss_ss: 0.928117, loss_d: 0.134225
0.9206 --- loss: 0.805291, loss_ss: 0.623249, loss_d: 0.182042
0.9590 --- loss: 1.054138, loss_ss: 0.891956, loss_d: 0.162182
0.9973 --- loss: 0.785787, loss_ss: 0.766653, loss_d: 0.019133
Epoch finished! Loss: 1.0840343853602044
Starting epoch 5/10.
0.0000 --- loss: 0.831713, loss_ss: 0.716758, loss_d: 0.114955
0.0384 --- loss: 1.477819, loss_ss: 1.100271, loss_d: 0.377548
0.0767 --- loss: 1.034608, loss_ss: 1.028518, loss_d: 0.006089
0.1151 --- loss: 1.138551, loss_ss: 0.884314, loss_d: 0.254237
0.1534 --- loss: 1.402797, loss_ss: 1.111328, loss_d: 0.291469
0.1918 --- loss: 0.847278, loss_ss: 0.777675, loss_d: 0.069603
0.2301 --- loss: 0.557423, loss_ss: 0.499209, loss_d: 0.058214
0.2685 --- loss: 0.914801, loss_ss: 0.882544, loss_d: 0.032257
0.3069 --- loss: 0.862429, loss_ss: 0.738999, loss_d: 0.123430
0.3452 --- loss: 1.437016, loss_ss: 0.726262, loss_d: 0.710754
0.3836 --- loss: 0.788677, loss_ss: 0.752468, loss_d: 0.036210
0.4219 --- loss: 1.343034, loss_ss: 1.107638, loss_d: 0.235396
0.4603 --- loss: 0.941406, loss_ss: 0.884801, loss_d: 0.056605
0.4987 --- loss: 0.893466, loss_ss: 0.857046, loss_d: 0.036420
0.5370 --- loss: 1.058516, loss_ss: 0.995735, loss_d: 0.062781
0.5754 --- loss: 0.727116, loss_ss: 0.693540, loss_d: 0.033575
0.6137 --- loss: 0.929512, loss_ss: 0.879362, loss_d: 0.050149
0.6521 --- loss: 0.915615, loss_ss: 0.860802, loss_d: 0.054813
0.6904 --- loss: 0.796879, loss_ss: 0.734086, loss_d: 0.062794
0.7288 --- loss: 0.873457, loss_ss: 0.863107, loss_d: 0.010351
0.7672 --- loss: 1.061859, loss_ss: 1.015801, loss_d: 0.046058
0.8055 --- loss: 0.909626, loss_ss: 0.851593, loss_d: 0.058033
0.8439 --- loss: 1.007651, loss_ss: 0.998641, loss_d: 0.009010
0.8822 --- loss: 0.669531, loss_ss: 0.649249, loss_d: 0.020282
0.9206 --- loss: 1.785901, loss_ss: 1.507321, loss_d: 0.278580
0.9590 --- loss: 0.756032, loss_ss: 0.718041, loss_d: 0.037991
0.9973 --- loss: 0.962086, loss_ss: 0.884358, loss_d: 0.077729
Epoch finished! Loss: 1.0054249552580026
Starting epoch 6/10.
0.0000 --- loss: 0.922952, loss_ss: 0.844238, loss_d: 0.078713
0.0384 --- loss: 0.981865, loss_ss: 0.788602, loss_d: 0.193263
0.0767 --- loss: 0.878007, loss_ss: 0.800501, loss_d: 0.077506
0.1151 --- loss: 0.796859, loss_ss: 0.780551, loss_d: 0.016308
0.1534 --- loss: 0.922270, loss_ss: 0.874977, loss_d: 0.047292
0.1918 --- loss: 1.106704, loss_ss: 0.858345, loss_d: 0.248359
0.2301 --- loss: 1.012085, loss_ss: 0.835519, loss_d: 0.176566
0.2685 --- loss: 0.970898, loss_ss: 0.879848, loss_d: 0.091050
0.3069 --- loss: 0.975250, loss_ss: 0.838533, loss_d: 0.136718
0.3452 --- loss: 0.931501, loss_ss: 0.869133, loss_d: 0.062367
0.3836 --- loss: 1.073486, loss_ss: 0.820006, loss_d: 0.253480
0.4219 --- loss: 0.823942, loss_ss: 0.802527, loss_d: 0.021415
0.4603 --- loss: 0.858202, loss_ss: 0.827769, loss_d: 0.030433
0.4987 --- loss: 0.650701, loss_ss: 0.628816, loss_d: 0.021885
0.5370 --- loss: 1.024456, loss_ss: 0.994775, loss_d: 0.029681
0.5754 --- loss: 0.783965, loss_ss: 0.726879, loss_d: 0.057086
0.6137 --- loss: 1.137820, loss_ss: 0.675035, loss_d: 0.462786
0.6521 --- loss: 0.916616, loss_ss: 0.844746, loss_d: 0.071870
0.6904 --- loss: 0.713290, loss_ss: 0.688511, loss_d: 0.024779
0.7288 --- loss: 0.863795, loss_ss: 0.829979, loss_d: 0.033816
0.7672 --- loss: 0.786379, loss_ss: 0.759759, loss_d: 0.026620
0.8055 --- loss: 0.770799, loss_ss: 0.758808, loss_d: 0.011991
0.8439 --- loss: 1.032117, loss_ss: 0.971459, loss_d: 0.060658
0.8822 --- loss: 0.908750, loss_ss: 0.864953, loss_d: 0.043796
0.9206 --- loss: 0.783917, loss_ss: 0.742590, loss_d: 0.041327
0.9590 --- loss: 0.679846, loss_ss: 0.650407, loss_d: 0.029439
0.9973 --- loss: 1.240890, loss_ss: 0.962706, loss_d: 0.278184
Epoch finished! Loss: 0.9487715319945262
Starting epoch 7/10.
0.0000 --- loss: 0.983650, loss_ss: 0.775629, loss_d: 0.208021
0.0384 --- loss: 0.967524, loss_ss: 0.789710, loss_d: 0.177814
0.0767 --- loss: 1.143215, loss_ss: 0.794696, loss_d: 0.348519
0.1151 --- loss: 0.775039, loss_ss: 0.717292, loss_d: 0.057748
0.1534 --- loss: 0.756954, loss_ss: 0.711116, loss_d: 0.045838
0.1918 --- loss: 1.105125, loss_ss: 1.008463, loss_d: 0.096662
0.2301 --- loss: 0.859019, loss_ss: 0.828633, loss_d: 0.030387
0.2685 --- loss: 0.560645, loss_ss: 0.532788, loss_d: 0.027857
0.3069 --- loss: 0.717164, loss_ss: 0.706117, loss_d: 0.011048
0.3452 --- loss: 0.838534, loss_ss: 0.824850, loss_d: 0.013684
0.3836 --- loss: 1.288453, loss_ss: 0.785839, loss_d: 0.502614
0.4219 --- loss: 0.751804, loss_ss: 0.744629, loss_d: 0.007175
0.4603 --- loss: 0.929177, loss_ss: 0.803217, loss_d: 0.125960
0.4987 --- loss: 0.852839, loss_ss: 0.818003, loss_d: 0.034836
0.5370 --- loss: 0.661281, loss_ss: 0.646837, loss_d: 0.014444
0.5754 --- loss: 0.777925, loss_ss: 0.769983, loss_d: 0.007942
0.6137 --- loss: 0.928987, loss_ss: 0.847198, loss_d: 0.081790
0.6521 --- loss: 0.962547, loss_ss: 0.944701, loss_d: 0.017847
0.6904 --- loss: 0.967852, loss_ss: 0.920788, loss_d: 0.047064
0.7288 --- loss: 0.766366, loss_ss: 0.729747, loss_d: 0.036620
0.7672 --- loss: 0.756784, loss_ss: 0.725933, loss_d: 0.030852
0.8055 --- loss: 1.104071, loss_ss: 1.087256, loss_d: 0.016815
0.8439 --- loss: 0.827860, loss_ss: 0.815988, loss_d: 0.011872
0.8822 --- loss: 0.874018, loss_ss: 0.775373, loss_d: 0.098645
0.9206 --- loss: 0.495290, loss_ss: 0.463584, loss_d: 0.031706
0.9590 --- loss: 1.406374, loss_ss: 1.104116, loss_d: 0.302258
0.9973 --- loss: 0.640959, loss_ss: 0.584645, loss_d: 0.056314
Epoch finished! Loss: 0.9130703214269418
Starting epoch 8/10.
0.0000 --- loss: 0.898747, loss_ss: 0.892476, loss_d: 0.006271
0.0384 --- loss: 1.129052, loss_ss: 1.100794, loss_d: 0.028258
0.0767 --- loss: 0.875107, loss_ss: 0.862456, loss_d: 0.012651
0.1151 --- loss: 1.628067, loss_ss: 1.037954, loss_d: 0.590113
0.1534 --- loss: 0.983123, loss_ss: 0.604999, loss_d: 0.378124
0.1918 --- loss: 0.826879, loss_ss: 0.813115, loss_d: 0.013765
0.2301 --- loss: 1.250548, loss_ss: 0.588233, loss_d: 0.662315
0.2685 --- loss: 0.573969, loss_ss: 0.496700, loss_d: 0.077269
0.3069 --- loss: 0.822294, loss_ss: 0.771798, loss_d: 0.050496
0.3452 --- loss: 0.799946, loss_ss: 0.736707, loss_d: 0.063239
0.3836 --- loss: 0.719946, loss_ss: 0.713722, loss_d: 0.006224
0.4219 --- loss: 0.783406, loss_ss: 0.728517, loss_d: 0.054888
0.4603 --- loss: 0.895388, loss_ss: 0.884574, loss_d: 0.010814
0.4987 --- loss: 0.838465, loss_ss: 0.752003, loss_d: 0.086462
0.5370 --- loss: 0.819892, loss_ss: 0.803881, loss_d: 0.016011
0.5754 --- loss: 0.859039, loss_ss: 0.809502, loss_d: 0.049537
0.6137 --- loss: 0.859415, loss_ss: 0.780555, loss_d: 0.078860
0.6521 --- loss: 1.164366, loss_ss: 1.019639, loss_d: 0.144727
0.6904 --- loss: 0.610970, loss_ss: 0.594714, loss_d: 0.016256
0.7288 --- loss: 0.846490, loss_ss: 0.756653, loss_d: 0.089838
0.7672 --- loss: 1.085059, loss_ss: 1.046339, loss_d: 0.038720
0.8055 --- loss: 0.701859, loss_ss: 0.675529, loss_d: 0.026329
0.8439 --- loss: 1.021259, loss_ss: 0.691973, loss_d: 0.329286
0.8822 --- loss: 0.915437, loss_ss: 0.898999, loss_d: 0.016438
0.9206 --- loss: 1.046861, loss_ss: 0.985762, loss_d: 0.061099
0.9590 --- loss: 0.735410, loss_ss: 0.711576, loss_d: 0.023834
0.9973 --- loss: 0.763121, loss_ss: 0.601659, loss_d: 0.161463
Epoch finished! Loss: 0.8986110216149917
Starting epoch 9/10.
0.0000 --- loss: 0.942334, loss_ss: 0.920282, loss_d: 0.022052
0.0384 --- loss: 1.030754, loss_ss: 0.890167, loss_d: 0.140587
0.0767 --- loss: 0.787592, loss_ss: 0.698431, loss_d: 0.089161
0.1151 --- loss: 0.938546, loss_ss: 0.898690, loss_d: 0.039856
0.1534 --- loss: 0.790126, loss_ss: 0.777458, loss_d: 0.012668
0.1918 --- loss: 0.891153, loss_ss: 0.868462, loss_d: 0.022691
0.2301 --- loss: 0.698470, loss_ss: 0.683006, loss_d: 0.015464
0.2685 --- loss: 0.800294, loss_ss: 0.777657, loss_d: 0.022637
0.3069 --- loss: 0.622291, loss_ss: 0.608167, loss_d: 0.014123
0.3452 --- loss: 0.899659, loss_ss: 0.827602, loss_d: 0.072057
0.3836 --- loss: 0.871291, loss_ss: 0.853326, loss_d: 0.017965
0.4219 --- loss: 0.677435, loss_ss: 0.665725, loss_d: 0.011709
0.4603 --- loss: 0.774137, loss_ss: 0.772411, loss_d: 0.001726
0.4987 --- loss: 0.645699, loss_ss: 0.638812, loss_d: 0.006887
0.5370 --- loss: 0.577071, loss_ss: 0.571182, loss_d: 0.005889
0.5754 --- loss: 0.633869, loss_ss: 0.628879, loss_d: 0.004990
0.6137 --- loss: 0.751106, loss_ss: 0.721050, loss_d: 0.030056
0.6521 --- loss: 0.879401, loss_ss: 0.873295, loss_d: 0.006106
0.6904 --- loss: 0.978728, loss_ss: 0.953014, loss_d: 0.025714
0.7288 --- loss: 0.859124, loss_ss: 0.856497, loss_d: 0.002627
0.7672 --- loss: 0.674407, loss_ss: 0.649743, loss_d: 0.024664
0.8055 --- loss: 1.268424, loss_ss: 1.248293, loss_d: 0.020131
0.8439 --- loss: 0.836562, loss_ss: 0.618149, loss_d: 0.218413
0.8822 --- loss: 1.176203, loss_ss: 0.642521, loss_d: 0.533682
0.9206 --- loss: 0.900211, loss_ss: 0.890418, loss_d: 0.009793
0.9590 --- loss: 0.782237, loss_ss: 0.737970, loss_d: 0.044266
0.9973 --- loss: 0.745205, loss_ss: 0.705368, loss_d: 0.039836
Epoch finished! Loss: 0.8463426063840206
Starting epoch 10/10.
0.0000 --- loss: 0.902076, loss_ss: 0.672989, loss_d: 0.229087
0.0384 --- loss: 0.734861, loss_ss: 0.685582, loss_d: 0.049279
0.0767 --- loss: 1.200711, loss_ss: 0.961877, loss_d: 0.238833
0.1151 --- loss: 0.559113, loss_ss: 0.557418, loss_d: 0.001695
0.1534 --- loss: 0.735610, loss_ss: 0.727768, loss_d: 0.007842
0.1918 --- loss: 0.692887, loss_ss: 0.641862, loss_d: 0.051025
0.2301 --- loss: 0.904309, loss_ss: 0.835945, loss_d: 0.068364
0.2685 --- loss: 0.966003, loss_ss: 0.942023, loss_d: 0.023980
0.3069 --- loss: 0.739352, loss_ss: 0.726631, loss_d: 0.012721
0.3452 --- loss: 0.958885, loss_ss: 0.949020, loss_d: 0.009865
0.3836 --- loss: 0.867432, loss_ss: 0.822655, loss_d: 0.044777
0.4219 --- loss: 0.881935, loss_ss: 0.879908, loss_d: 0.002027
0.4603 --- loss: 0.571488, loss_ss: 0.561417, loss_d: 0.010071
0.4987 --- loss: 0.846839, loss_ss: 0.805470, loss_d: 0.041369
0.5370 --- loss: 0.803812, loss_ss: 0.719680, loss_d: 0.084131
0.5754 --- loss: 0.696937, loss_ss: 0.623467, loss_d: 0.073471
0.6137 --- loss: 0.777086, loss_ss: 0.770658, loss_d: 0.006429
0.6521 --- loss: 0.665703, loss_ss: 0.646487, loss_d: 0.019217
0.6904 --- loss: 1.119468, loss_ss: 1.063615, loss_d: 0.055853
0.7288 --- loss: 0.702449, loss_ss: 0.610870, loss_d: 0.091579
0.7672 --- loss: 0.619979, loss_ss: 0.573083, loss_d: 0.046896
0.8055 --- loss: 0.816047, loss_ss: 0.812920, loss_d: 0.003127
0.8439 --- loss: 0.908387, loss_ss: 0.901888, loss_d: 0.006498
0.8822 --- loss: 1.171826, loss_ss: 1.092126, loss_d: 0.079700
0.9206 --- loss: 0.897126, loss_ss: 0.885693, loss_d: 0.011434
0.9590 --- loss: 0.992201, loss_ss: 0.755167, loss_d: 0.237034
0.9973 --- loss: 0.911770, loss_ss: 0.906538, loss_d: 0.005231
Epoch finished! Loss: 0.8334113561190092
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7462365591397849
             precision    recall  f1-score   support

        0.0       0.65      1.00      0.79        41
        1.0       0.38      0.39      0.39        33
        2.0       0.82      0.76      0.79       530
        3.0       0.99      0.62      0.76       236
        4.0       0.47      1.00      0.64        90

avg / total       0.80      0.75      0.75       930
 


====== chc005-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  97.63  100.00   97.53  65.08     78.85
1  95.59   39.39   97.66  38.24     38.81
2  76.56   76.04   77.25  81.58     78.71
3  90.22   62.29   99.71  98.66     76.36
4  89.25  100.00   88.10  47.37     64.29
Total accuracy: 74.62%
Average sen: 75.54%
Average spec: 92.05%
Macro f1-score: 67.40%
Diagnosis acc on 15mins: 0.967741935483871
[9.02210188e-04 2.19557479e-01 2.97613833e-02 1.17449556e-02
 4.25274253e-01 3.29745701e-03 7.04114884e-03 8.05112720e-03
 1.40173524e-03 6.21030526e-03 8.04340746e-03 3.08276713e-03
 2.78916918e-02 2.23776256e-03 2.88766087e-03 4.41663153e-03
 3.34715960e-03 1.61005836e-03 1.69726629e-02 1.10369513e-03
 7.06155133e-03 1.09817199e-01 7.89880157e-01 6.47195010e-03
 6.60232501e-04 1.04942648e-02 5.40153757e-02 1.95892900e-03
 9.04123671e-03 6.97861006e-03 9.18635109e-04]
pred: 0.05748818364490064, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.349599, loss_ss: 1.671119, loss_d: 0.678480
0.0383 --- loss: 2.268179, loss_ss: 1.671292, loss_d: 0.596887
0.0766 --- loss: 2.192223, loss_ss: 1.611702, loss_d: 0.580521
0.1149 --- loss: 2.022120, loss_ss: 1.590795, loss_d: 0.431325
0.1532 --- loss: 2.245300, loss_ss: 1.777333, loss_d: 0.467967
0.1915 --- loss: 2.255262, loss_ss: 1.529688, loss_d: 0.725573
0.2298 --- loss: 1.809191, loss_ss: 1.421138, loss_d: 0.388053
0.2681 --- loss: 1.792801, loss_ss: 1.423365, loss_d: 0.369436
0.3064 --- loss: 2.357000, loss_ss: 1.421736, loss_d: 0.935264
0.3447 --- loss: 1.872689, loss_ss: 1.407326, loss_d: 0.465363
0.3830 --- loss: 1.851127, loss_ss: 1.516181, loss_d: 0.334946
0.4213 --- loss: 2.050919, loss_ss: 1.357127, loss_d: 0.693792
0.4596 --- loss: 2.080449, loss_ss: 1.526574, loss_d: 0.553874
0.4979 --- loss: 1.734025, loss_ss: 1.334057, loss_d: 0.399969
0.5362 --- loss: 1.797916, loss_ss: 1.279727, loss_d: 0.518189
0.5745 --- loss: 1.600649, loss_ss: 1.418668, loss_d: 0.181982
0.6128 --- loss: 1.592591, loss_ss: 1.269436, loss_d: 0.323155
0.6511 --- loss: 1.891517, loss_ss: 1.363245, loss_d: 0.528271
0.6894 --- loss: 2.232003, loss_ss: 1.225719, loss_d: 1.006284
0.7277 --- loss: 2.070536, loss_ss: 1.337325, loss_d: 0.733211
0.7660 --- loss: 1.766113, loss_ss: 1.160622, loss_d: 0.605492
0.8043 --- loss: 1.549767, loss_ss: 1.173814, loss_d: 0.375953
0.8426 --- loss: 1.509842, loss_ss: 1.194959, loss_d: 0.314883
0.8809 --- loss: 1.515123, loss_ss: 1.053094, loss_d: 0.462029
0.9192 --- loss: 1.550948, loss_ss: 1.176780, loss_d: 0.374169
0.9575 --- loss: 1.584794, loss_ss: 1.145884, loss_d: 0.438910
0.9958 --- loss: 1.778456, loss_ss: 1.189977, loss_d: 0.588479
Epoch finished! Loss: 1.8867655992507935
Starting epoch 2/10.
0.0000 --- loss: 1.332636, loss_ss: 1.057937, loss_d: 0.274699
0.0383 --- loss: 1.320413, loss_ss: 1.189094, loss_d: 0.131319
0.0766 --- loss: 1.495621, loss_ss: 1.131162, loss_d: 0.364458
0.1149 --- loss: 1.276026, loss_ss: 1.068225, loss_d: 0.207801
0.1532 --- loss: 1.415918, loss_ss: 1.168320, loss_d: 0.247598
0.1915 --- loss: 1.361350, loss_ss: 1.092465, loss_d: 0.268884
0.2298 --- loss: 1.262304, loss_ss: 1.025109, loss_d: 0.237194
0.2681 --- loss: 1.327002, loss_ss: 1.003248, loss_d: 0.323754
0.3064 --- loss: 1.210257, loss_ss: 1.136305, loss_d: 0.073952
0.3447 --- loss: 1.451652, loss_ss: 1.091994, loss_d: 0.359658
0.3830 --- loss: 1.535932, loss_ss: 1.036974, loss_d: 0.498958
0.4213 --- loss: 1.701866, loss_ss: 1.271572, loss_d: 0.430294
0.4596 --- loss: 1.288597, loss_ss: 0.977606, loss_d: 0.310991
0.4979 --- loss: 1.254666, loss_ss: 1.018912, loss_d: 0.235754
0.5362 --- loss: 1.057826, loss_ss: 0.875161, loss_d: 0.182665
0.5745 --- loss: 1.164655, loss_ss: 0.995520, loss_d: 0.169135
0.6128 --- loss: 1.476060, loss_ss: 1.216648, loss_d: 0.259411
0.6511 --- loss: 0.980751, loss_ss: 0.876646, loss_d: 0.104106
0.6894 --- loss: 1.278256, loss_ss: 1.066682, loss_d: 0.211574
0.7277 --- loss: 1.512810, loss_ss: 1.197631, loss_d: 0.315180
0.7660 --- loss: 1.202901, loss_ss: 1.152873, loss_d: 0.050028
0.8043 --- loss: 0.881272, loss_ss: 0.796661, loss_d: 0.084611
0.8426 --- loss: 1.119510, loss_ss: 0.891255, loss_d: 0.228255
0.8809 --- loss: 1.684810, loss_ss: 0.788748, loss_d: 0.896062
0.9192 --- loss: 1.359429, loss_ss: 0.948832, loss_d: 0.410596
0.9575 --- loss: 1.005408, loss_ss: 0.890033, loss_d: 0.115375
0.9958 --- loss: 1.121814, loss_ss: 0.868598, loss_d: 0.253216
Epoch finished! Loss: 1.3651804181807798
Starting epoch 3/10.
0.0000 --- loss: 1.237263, loss_ss: 1.120476, loss_d: 0.116787
0.0383 --- loss: 1.353057, loss_ss: 0.785377, loss_d: 0.567681
0.0766 --- loss: 1.316172, loss_ss: 1.087682, loss_d: 0.228490
0.1149 --- loss: 1.085752, loss_ss: 0.940204, loss_d: 0.145547
0.1532 --- loss: 1.320831, loss_ss: 1.177555, loss_d: 0.143276
0.1915 --- loss: 1.150576, loss_ss: 1.082168, loss_d: 0.068408
0.2298 --- loss: 1.120014, loss_ss: 0.839527, loss_d: 0.280488
0.2681 --- loss: 1.476031, loss_ss: 0.934589, loss_d: 0.541442
0.3064 --- loss: 1.185373, loss_ss: 1.133752, loss_d: 0.051622
0.3447 --- loss: 1.311836, loss_ss: 0.948670, loss_d: 0.363166
0.3830 --- loss: 1.207184, loss_ss: 0.917679, loss_d: 0.289505
0.4213 --- loss: 1.657465, loss_ss: 0.997264, loss_d: 0.660201
0.4596 --- loss: 1.332228, loss_ss: 0.943416, loss_d: 0.388812
0.4979 --- loss: 1.039430, loss_ss: 0.898882, loss_d: 0.140548
0.5362 --- loss: 1.110188, loss_ss: 0.831763, loss_d: 0.278426
0.5745 --- loss: 0.908249, loss_ss: 0.798657, loss_d: 0.109592
0.6128 --- loss: 1.363192, loss_ss: 1.102252, loss_d: 0.260940
0.6511 --- loss: 1.173665, loss_ss: 0.767692, loss_d: 0.405973
0.6894 --- loss: 1.029680, loss_ss: 0.944670, loss_d: 0.085010
0.7277 --- loss: 0.906658, loss_ss: 0.779021, loss_d: 0.127637
0.7660 --- loss: 0.920544, loss_ss: 0.800541, loss_d: 0.120003
0.8043 --- loss: 1.077161, loss_ss: 0.876036, loss_d: 0.201125
0.8426 --- loss: 0.945434, loss_ss: 0.873856, loss_d: 0.071578
0.8809 --- loss: 0.967098, loss_ss: 0.838543, loss_d: 0.128555
0.9192 --- loss: 1.266356, loss_ss: 1.081598, loss_d: 0.184759
0.9575 --- loss: 0.862386, loss_ss: 0.789903, loss_d: 0.072483
0.9958 --- loss: 1.247950, loss_ss: 1.091828, loss_d: 0.156122
Epoch finished! Loss: 1.223192215422561
Starting epoch 4/10.
0.0000 --- loss: 1.042581, loss_ss: 0.793593, loss_d: 0.248987
0.0383 --- loss: 1.154436, loss_ss: 1.001992, loss_d: 0.152445
0.0766 --- loss: 1.087211, loss_ss: 0.738105, loss_d: 0.349107
0.1149 --- loss: 1.118141, loss_ss: 0.968961, loss_d: 0.149180
0.1532 --- loss: 0.899767, loss_ss: 0.757272, loss_d: 0.142496
0.1915 --- loss: 0.991080, loss_ss: 0.919046, loss_d: 0.072034
0.2298 --- loss: 0.941023, loss_ss: 0.864230, loss_d: 0.076793
0.2681 --- loss: 1.143653, loss_ss: 0.866914, loss_d: 0.276739
0.3064 --- loss: 1.001620, loss_ss: 0.884673, loss_d: 0.116947
0.3447 --- loss: 1.303753, loss_ss: 1.098548, loss_d: 0.205205
0.3830 --- loss: 1.201088, loss_ss: 0.982840, loss_d: 0.218248
0.4213 --- loss: 0.813539, loss_ss: 0.743060, loss_d: 0.070479
0.4596 --- loss: 1.092240, loss_ss: 0.860121, loss_d: 0.232119
0.4979 --- loss: 1.085254, loss_ss: 0.959243, loss_d: 0.126012
0.5362 --- loss: 1.596439, loss_ss: 1.161265, loss_d: 0.435174
0.5745 --- loss: 1.213298, loss_ss: 1.163286, loss_d: 0.050012
0.6128 --- loss: 0.979262, loss_ss: 0.856307, loss_d: 0.122955
0.6511 --- loss: 1.159073, loss_ss: 1.087998, loss_d: 0.071075
0.6894 --- loss: 1.037282, loss_ss: 0.942474, loss_d: 0.094807
0.7277 --- loss: 0.827565, loss_ss: 0.723171, loss_d: 0.104394
0.7660 --- loss: 0.995107, loss_ss: 0.862511, loss_d: 0.132597
0.8043 --- loss: 0.987042, loss_ss: 0.734870, loss_d: 0.252172
0.8426 --- loss: 0.896881, loss_ss: 0.822573, loss_d: 0.074308
0.8809 --- loss: 0.983458, loss_ss: 0.906298, loss_d: 0.077160
0.9192 --- loss: 1.014168, loss_ss: 0.957428, loss_d: 0.056740
0.9575 --- loss: 0.689437, loss_ss: 0.674746, loss_d: 0.014692
0.9958 --- loss: 0.852606, loss_ss: 0.742356, loss_d: 0.110250
Epoch finished! Loss: 1.1397362017996924
Starting epoch 5/10.
0.0000 --- loss: 1.101601, loss_ss: 0.972366, loss_d: 0.129235
0.0383 --- loss: 1.076023, loss_ss: 0.841135, loss_d: 0.234887
0.0766 --- loss: 1.301358, loss_ss: 1.210879, loss_d: 0.090480
0.1149 --- loss: 0.954998, loss_ss: 0.815083, loss_d: 0.139916
0.1532 --- loss: 1.010889, loss_ss: 0.946121, loss_d: 0.064767
0.1915 --- loss: 0.948200, loss_ss: 0.728779, loss_d: 0.219421
0.2298 --- loss: 0.991019, loss_ss: 0.812757, loss_d: 0.178262
0.2681 --- loss: 1.304586, loss_ss: 1.056888, loss_d: 0.247698
0.3064 --- loss: 1.078253, loss_ss: 0.827671, loss_d: 0.250582
0.3447 --- loss: 1.077546, loss_ss: 0.936187, loss_d: 0.141359
0.3830 --- loss: 1.189856, loss_ss: 1.013004, loss_d: 0.176853
0.4213 --- loss: 0.970617, loss_ss: 0.916178, loss_d: 0.054439
0.4596 --- loss: 1.420629, loss_ss: 0.873469, loss_d: 0.547161
0.4979 --- loss: 1.079705, loss_ss: 1.006418, loss_d: 0.073287
0.5362 --- loss: 1.188787, loss_ss: 0.923015, loss_d: 0.265772
0.5745 --- loss: 1.124810, loss_ss: 0.983302, loss_d: 0.141508
0.6128 --- loss: 0.740706, loss_ss: 0.648686, loss_d: 0.092020
0.6511 --- loss: 1.000641, loss_ss: 0.752203, loss_d: 0.248438
0.6894 --- loss: 1.071190, loss_ss: 0.853404, loss_d: 0.217787
0.7277 --- loss: 1.035226, loss_ss: 0.795722, loss_d: 0.239504
0.7660 --- loss: 0.967278, loss_ss: 0.931396, loss_d: 0.035882
0.8043 --- loss: 0.892276, loss_ss: 0.799205, loss_d: 0.093071
0.8426 --- loss: 0.867578, loss_ss: 0.808735, loss_d: 0.058842
0.8809 --- loss: 1.509578, loss_ss: 1.411144, loss_d: 0.098435
0.9192 --- loss: 0.894682, loss_ss: 0.721764, loss_d: 0.172918
0.9575 --- loss: 1.053308, loss_ss: 0.675796, loss_d: 0.377512
0.9958 --- loss: 1.241191, loss_ss: 0.847856, loss_d: 0.393335
Epoch finished! Loss: 1.0720825894125576
Starting epoch 6/10.
0.0000 --- loss: 1.067914, loss_ss: 0.985093, loss_d: 0.082822
0.0383 --- loss: 1.007565, loss_ss: 0.814148, loss_d: 0.193417
0.0766 --- loss: 1.083841, loss_ss: 0.985941, loss_d: 0.097899
0.1149 --- loss: 0.994718, loss_ss: 0.811327, loss_d: 0.183391
0.1532 --- loss: 1.250935, loss_ss: 1.104584, loss_d: 0.146352
0.1915 --- loss: 1.130160, loss_ss: 1.106392, loss_d: 0.023768
0.2298 --- loss: 1.459447, loss_ss: 1.085486, loss_d: 0.373961
0.2681 --- loss: 0.860332, loss_ss: 0.807775, loss_d: 0.052557
0.3064 --- loss: 0.951837, loss_ss: 0.895041, loss_d: 0.056796
0.3447 --- loss: 0.934843, loss_ss: 0.913980, loss_d: 0.020863
0.3830 --- loss: 0.786558, loss_ss: 0.734563, loss_d: 0.051996
0.4213 --- loss: 1.161704, loss_ss: 1.132990, loss_d: 0.028714
0.4596 --- loss: 0.854558, loss_ss: 0.714947, loss_d: 0.139611
0.4979 --- loss: 0.969277, loss_ss: 0.823978, loss_d: 0.145299
0.5362 --- loss: 0.835096, loss_ss: 0.777879, loss_d: 0.057217
0.5745 --- loss: 1.217830, loss_ss: 1.198010, loss_d: 0.019821
0.6128 --- loss: 0.984478, loss_ss: 0.703431, loss_d: 0.281046
0.6511 --- loss: 0.905357, loss_ss: 0.857450, loss_d: 0.047908
0.6894 --- loss: 1.111375, loss_ss: 0.874403, loss_d: 0.236972
0.7277 --- loss: 0.986560, loss_ss: 0.799946, loss_d: 0.186614
0.7660 --- loss: 0.969870, loss_ss: 0.817583, loss_d: 0.152288
0.8043 --- loss: 0.904216, loss_ss: 0.875587, loss_d: 0.028630
0.8426 --- loss: 1.172976, loss_ss: 1.112139, loss_d: 0.060837
0.8809 --- loss: 0.776981, loss_ss: 0.740370, loss_d: 0.036610
0.9192 --- loss: 0.778938, loss_ss: 0.689781, loss_d: 0.089157
0.9575 --- loss: 1.344649, loss_ss: 0.747881, loss_d: 0.596768
0.9958 --- loss: 1.006621, loss_ss: 0.914786, loss_d: 0.091835
Epoch finished! Loss: 1.028322136950219
Starting epoch 7/10.
0.0000 --- loss: 0.888693, loss_ss: 0.781907, loss_d: 0.106786
0.0383 --- loss: 0.980562, loss_ss: 0.870303, loss_d: 0.110259
0.0766 --- loss: 0.920435, loss_ss: 0.914094, loss_d: 0.006340
0.1149 --- loss: 0.626243, loss_ss: 0.607096, loss_d: 0.019147
0.1532 --- loss: 1.044719, loss_ss: 1.019071, loss_d: 0.025648
0.1915 --- loss: 0.826296, loss_ss: 0.744573, loss_d: 0.081723
0.2298 --- loss: 0.839380, loss_ss: 0.692841, loss_d: 0.146538
0.2681 --- loss: 1.048939, loss_ss: 1.045476, loss_d: 0.003463
0.3064 --- loss: 1.102281, loss_ss: 0.830983, loss_d: 0.271298
0.3447 --- loss: 1.101787, loss_ss: 0.698335, loss_d: 0.403452
0.3830 --- loss: 0.753640, loss_ss: 0.658682, loss_d: 0.094959
0.4213 --- loss: 0.807189, loss_ss: 0.777108, loss_d: 0.030082
0.4596 --- loss: 0.977530, loss_ss: 0.783576, loss_d: 0.193954
0.4979 --- loss: 0.716167, loss_ss: 0.692308, loss_d: 0.023859
0.5362 --- loss: 0.786472, loss_ss: 0.732144, loss_d: 0.054328
0.5745 --- loss: 0.864501, loss_ss: 0.792293, loss_d: 0.072208
0.6128 --- loss: 0.857938, loss_ss: 0.702152, loss_d: 0.155786
0.6511 --- loss: 0.820143, loss_ss: 0.813170, loss_d: 0.006974
0.6894 --- loss: 1.170114, loss_ss: 1.122828, loss_d: 0.047286
0.7277 --- loss: 1.859693, loss_ss: 0.777342, loss_d: 1.082352
0.7660 --- loss: 0.944301, loss_ss: 0.839843, loss_d: 0.104458
0.8043 --- loss: 1.082449, loss_ss: 0.816549, loss_d: 0.265901
0.8426 --- loss: 0.903863, loss_ss: 0.708219, loss_d: 0.195645
0.8809 --- loss: 0.879476, loss_ss: 0.802000, loss_d: 0.077475
0.9192 --- loss: 1.021847, loss_ss: 0.855094, loss_d: 0.166753
0.9575 --- loss: 0.876387, loss_ss: 0.775324, loss_d: 0.101062
0.9958 --- loss: 0.800949, loss_ss: 0.713556, loss_d: 0.087393
Epoch finished! Loss: 0.9896634673250133
Starting epoch 8/10.
0.0000 --- loss: 0.801622, loss_ss: 0.625027, loss_d: 0.176595
0.0383 --- loss: 1.528251, loss_ss: 1.270569, loss_d: 0.257682
0.0766 --- loss: 0.898068, loss_ss: 0.767337, loss_d: 0.130731
0.1149 --- loss: 1.003892, loss_ss: 0.960211, loss_d: 0.043681
0.1532 --- loss: 1.107518, loss_ss: 1.097476, loss_d: 0.010042
0.1915 --- loss: 0.697817, loss_ss: 0.660017, loss_d: 0.037800
0.2298 --- loss: 0.772961, loss_ss: 0.738274, loss_d: 0.034687
0.2681 --- loss: 1.331106, loss_ss: 0.961297, loss_d: 0.369809
0.3064 --- loss: 1.004750, loss_ss: 0.972067, loss_d: 0.032683
0.3447 --- loss: 1.268858, loss_ss: 0.802096, loss_d: 0.466762
0.3830 --- loss: 1.023729, loss_ss: 0.922749, loss_d: 0.100980
0.4213 --- loss: 0.801953, loss_ss: 0.586611, loss_d: 0.215342
0.4596 --- loss: 0.931361, loss_ss: 0.857424, loss_d: 0.073937
0.4979 --- loss: 0.845699, loss_ss: 0.541220, loss_d: 0.304479
0.5362 --- loss: 1.587303, loss_ss: 1.240338, loss_d: 0.346965
0.5745 --- loss: 1.003761, loss_ss: 0.989929, loss_d: 0.013832
0.6128 --- loss: 1.515437, loss_ss: 0.713372, loss_d: 0.802065
0.6511 --- loss: 0.906451, loss_ss: 0.843603, loss_d: 0.062848
0.6894 --- loss: 1.136763, loss_ss: 0.964330, loss_d: 0.172433
0.7277 --- loss: 1.213172, loss_ss: 0.929375, loss_d: 0.283797
0.7660 --- loss: 0.817438, loss_ss: 0.814843, loss_d: 0.002595
0.8043 --- loss: 0.907284, loss_ss: 0.702695, loss_d: 0.204589
0.8426 --- loss: 0.897530, loss_ss: 0.867012, loss_d: 0.030519
0.8809 --- loss: 0.924604, loss_ss: 0.897546, loss_d: 0.027057
0.9192 --- loss: 0.909477, loss_ss: 0.649640, loss_d: 0.259837
0.9575 --- loss: 0.851562, loss_ss: 0.791876, loss_d: 0.059686
0.9958 --- loss: 0.984977, loss_ss: 0.953309, loss_d: 0.031668
Epoch finished! Loss: 0.9791798141724305
Starting epoch 9/10.
0.0000 --- loss: 1.055853, loss_ss: 0.871210, loss_d: 0.184643
0.0383 --- loss: 0.971574, loss_ss: 0.783247, loss_d: 0.188327
0.0766 --- loss: 0.890313, loss_ss: 0.815473, loss_d: 0.074840
0.1149 --- loss: 1.289125, loss_ss: 1.219029, loss_d: 0.070096
0.1532 --- loss: 1.070226, loss_ss: 1.055929, loss_d: 0.014297
0.1915 --- loss: 1.112722, loss_ss: 0.747758, loss_d: 0.364964
0.2298 --- loss: 0.845543, loss_ss: 0.806865, loss_d: 0.038678
0.2681 --- loss: 0.979246, loss_ss: 0.945450, loss_d: 0.033795
0.3064 --- loss: 0.686214, loss_ss: 0.639486, loss_d: 0.046728
0.3447 --- loss: 1.350707, loss_ss: 1.214800, loss_d: 0.135908
0.3830 --- loss: 1.151093, loss_ss: 0.790190, loss_d: 0.360903
0.4213 --- loss: 1.145031, loss_ss: 0.865419, loss_d: 0.279613
0.4596 --- loss: 0.682310, loss_ss: 0.677235, loss_d: 0.005076
0.4979 --- loss: 0.995105, loss_ss: 0.970074, loss_d: 0.025031
0.5362 --- loss: 0.895608, loss_ss: 0.884301, loss_d: 0.011307
0.5745 --- loss: 0.939939, loss_ss: 0.685716, loss_d: 0.254223
0.6128 --- loss: 1.183871, loss_ss: 1.166836, loss_d: 0.017035
0.6511 --- loss: 1.908453, loss_ss: 1.246197, loss_d: 0.662256
0.6894 --- loss: 0.732967, loss_ss: 0.683664, loss_d: 0.049303
0.7277 --- loss: 0.781545, loss_ss: 0.766800, loss_d: 0.014745
0.7660 --- loss: 1.401577, loss_ss: 1.260132, loss_d: 0.141445
0.8043 --- loss: 0.756933, loss_ss: 0.728276, loss_d: 0.028656
0.8426 --- loss: 0.750562, loss_ss: 0.732857, loss_d: 0.017706
0.8809 --- loss: 1.026132, loss_ss: 0.718012, loss_d: 0.308120
0.9192 --- loss: 0.933596, loss_ss: 0.721016, loss_d: 0.212580
0.9575 --- loss: 0.978247, loss_ss: 0.925865, loss_d: 0.052382
0.9958 --- loss: 2.134931, loss_ss: 0.786232, loss_d: 1.348699
Epoch finished! Loss: 0.9674595098842607
Starting epoch 10/10.
0.0000 --- loss: 0.646827, loss_ss: 0.608123, loss_d: 0.038704
0.0383 --- loss: 0.799418, loss_ss: 0.713477, loss_d: 0.085941
0.0766 --- loss: 0.682348, loss_ss: 0.566591, loss_d: 0.115758
0.1149 --- loss: 0.944619, loss_ss: 0.686741, loss_d: 0.257877
0.1532 --- loss: 1.049478, loss_ss: 0.955501, loss_d: 0.093977
0.1915 --- loss: 0.919711, loss_ss: 0.873264, loss_d: 0.046447
0.2298 --- loss: 1.173835, loss_ss: 0.952719, loss_d: 0.221116
0.2681 --- loss: 1.311970, loss_ss: 0.904781, loss_d: 0.407189
0.3064 --- loss: 0.929197, loss_ss: 0.813731, loss_d: 0.115466
0.3447 --- loss: 0.753511, loss_ss: 0.721737, loss_d: 0.031775
0.3830 --- loss: 1.017300, loss_ss: 0.749183, loss_d: 0.268118
0.4213 --- loss: 1.346757, loss_ss: 1.055779, loss_d: 0.290978
0.4596 --- loss: 0.851557, loss_ss: 0.674192, loss_d: 0.177366
0.4979 --- loss: 0.839023, loss_ss: 0.786207, loss_d: 0.052816
0.5362 --- loss: 0.702010, loss_ss: 0.659993, loss_d: 0.042017
0.5745 --- loss: 1.188384, loss_ss: 1.083872, loss_d: 0.104512
0.6128 --- loss: 0.861173, loss_ss: 0.804732, loss_d: 0.056441
0.6511 --- loss: 0.925179, loss_ss: 0.894791, loss_d: 0.030389
0.6894 --- loss: 1.158713, loss_ss: 0.911663, loss_d: 0.247050
0.7277 --- loss: 0.802692, loss_ss: 0.776575, loss_d: 0.026117
0.7660 --- loss: 1.264750, loss_ss: 1.011447, loss_d: 0.253303
0.8043 --- loss: 1.028856, loss_ss: 1.021762, loss_d: 0.007095
0.8426 --- loss: 0.701983, loss_ss: 0.664716, loss_d: 0.037268
0.8809 --- loss: 0.853065, loss_ss: 0.795900, loss_d: 0.057165
0.9192 --- loss: 0.901332, loss_ss: 0.718693, loss_d: 0.182639
0.9575 --- loss: 0.861504, loss_ss: 0.835307, loss_d: 0.026197
0.9958 --- loss: 0.648010, loss_ss: 0.634185, loss_d: 0.013825
Epoch finished! Loss: 0.9047092244999618
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7802469135802469
             precision    recall  f1-score   support

        0.0       0.96      0.78      0.86       158
        1.0       0.51      0.72      0.60       103
        2.0       0.81      0.87      0.84       306
        3.0       1.00      0.56      0.72       133
        4.0       0.71      0.84      0.77       110

avg / total       0.82      0.78      0.78       810
 


====== chc006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.19  78.48   99.23   96.12     86.41
1  87.65  71.84   89.96   51.03     59.68
2  87.28  87.25   87.30   80.66     83.83
3  92.84  56.39  100.00  100.00     72.12
4  93.09  83.64   94.57   70.77     76.67
Total accuracy: 78.02%
Average sen: 75.52%
Average spec: 94.21%
Macro f1-score: 75.74%
Diagnosis acc on 15mins: 0.0
[0.99992597 0.99970704 0.99991179 0.99936444 0.99978775 0.99998999
 0.99982303 0.99980623 0.99999714 0.99753189 0.99954093 0.99995697
 0.99977547 0.99998569 0.99931645 0.99880648 0.99990189 0.99967158
 0.99992967 0.99999058 0.99988878 0.9997676  0.99987733 0.99935061
 0.9999069  0.95222163 0.99968731]
pred: 0.99790448612637, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.157898, loss_ss: 1.485930, loss_d: 0.671968
0.0384 --- loss: 2.216886, loss_ss: 1.626108, loss_d: 0.590778
0.0767 --- loss: 1.997448, loss_ss: 1.546168, loss_d: 0.451280
0.1151 --- loss: 2.078365, loss_ss: 1.481757, loss_d: 0.596608
0.1535 --- loss: 2.066973, loss_ss: 1.522923, loss_d: 0.544051
0.1919 --- loss: 2.205420, loss_ss: 1.460045, loss_d: 0.745375
0.2302 --- loss: 1.921594, loss_ss: 1.423863, loss_d: 0.497731
0.2686 --- loss: 1.914088, loss_ss: 1.302642, loss_d: 0.611445
0.3070 --- loss: 1.914746, loss_ss: 1.199573, loss_d: 0.715173
0.3454 --- loss: 1.815711, loss_ss: 1.316887, loss_d: 0.498825
0.3837 --- loss: 1.893739, loss_ss: 1.286942, loss_d: 0.606797
0.4221 --- loss: 1.955924, loss_ss: 1.248515, loss_d: 0.707409
0.4605 --- loss: 1.816901, loss_ss: 1.243275, loss_d: 0.573626
0.4988 --- loss: 1.850732, loss_ss: 1.244008, loss_d: 0.606724
0.5372 --- loss: 1.909440, loss_ss: 1.304760, loss_d: 0.604680
0.5756 --- loss: 1.608459, loss_ss: 1.270797, loss_d: 0.337662
0.6140 --- loss: 1.557449, loss_ss: 1.297653, loss_d: 0.259796
0.6523 --- loss: 1.884101, loss_ss: 1.110088, loss_d: 0.774014
0.6907 --- loss: 1.708884, loss_ss: 1.330275, loss_d: 0.378609
0.7291 --- loss: 2.020963, loss_ss: 1.415614, loss_d: 0.605349
0.7675 --- loss: 1.597391, loss_ss: 1.110363, loss_d: 0.487028
0.8058 --- loss: 1.570531, loss_ss: 1.142219, loss_d: 0.428312
0.8442 --- loss: 1.609398, loss_ss: 1.368727, loss_d: 0.240671
0.8826 --- loss: 1.559369, loss_ss: 1.178092, loss_d: 0.381277
0.9210 --- loss: 1.370596, loss_ss: 1.161410, loss_d: 0.209186
0.9593 --- loss: 1.484561, loss_ss: 1.047493, loss_d: 0.437069
0.9977 --- loss: 1.954394, loss_ss: 1.325911, loss_d: 0.628483
Epoch finished! Loss: 1.8076805917116312
Starting epoch 2/10.
0.0000 --- loss: 1.680820, loss_ss: 1.480421, loss_d: 0.200399
0.0384 --- loss: 1.688417, loss_ss: 1.065518, loss_d: 0.622899
0.0767 --- loss: 1.466004, loss_ss: 1.123783, loss_d: 0.342220
0.1151 --- loss: 1.320830, loss_ss: 1.131846, loss_d: 0.188983
0.1535 --- loss: 1.620019, loss_ss: 1.072578, loss_d: 0.547441
0.1919 --- loss: 1.774197, loss_ss: 1.162100, loss_d: 0.612096
0.2302 --- loss: 1.223371, loss_ss: 1.047542, loss_d: 0.175829
0.2686 --- loss: 1.440700, loss_ss: 1.217164, loss_d: 0.223536
0.3070 --- loss: 1.273539, loss_ss: 1.060401, loss_d: 0.213138
0.3454 --- loss: 1.450353, loss_ss: 1.121179, loss_d: 0.329175
0.3837 --- loss: 1.592201, loss_ss: 1.237053, loss_d: 0.355148
0.4221 --- loss: 1.791775, loss_ss: 1.383151, loss_d: 0.408624
0.4605 --- loss: 1.225359, loss_ss: 1.061200, loss_d: 0.164159
0.4988 --- loss: 1.483770, loss_ss: 1.005365, loss_d: 0.478405
0.5372 --- loss: 1.649390, loss_ss: 0.997799, loss_d: 0.651591
0.5756 --- loss: 1.253253, loss_ss: 1.136490, loss_d: 0.116764
0.6140 --- loss: 1.359535, loss_ss: 0.870678, loss_d: 0.488857
0.6523 --- loss: 1.136824, loss_ss: 1.021937, loss_d: 0.114887
0.6907 --- loss: 1.106475, loss_ss: 0.844638, loss_d: 0.261837
0.7291 --- loss: 1.915511, loss_ss: 1.117843, loss_d: 0.797667
0.7675 --- loss: 1.448742, loss_ss: 1.079129, loss_d: 0.369612
0.8058 --- loss: 1.138967, loss_ss: 1.015029, loss_d: 0.123938
0.8442 --- loss: 1.163190, loss_ss: 0.919999, loss_d: 0.243191
0.8826 --- loss: 1.551419, loss_ss: 0.941230, loss_d: 0.610189
0.9210 --- loss: 1.075823, loss_ss: 0.870019, loss_d: 0.205804
0.9593 --- loss: 1.012011, loss_ss: 0.894192, loss_d: 0.117819
0.9977 --- loss: 1.191543, loss_ss: 1.032387, loss_d: 0.159157
Epoch finished! Loss: 1.350001557973715
Starting epoch 3/10.
0.0000 --- loss: 1.455024, loss_ss: 1.248719, loss_d: 0.206305
0.0384 --- loss: 1.321056, loss_ss: 1.049019, loss_d: 0.272037
0.0767 --- loss: 1.198230, loss_ss: 1.014877, loss_d: 0.183353
0.1151 --- loss: 1.237508, loss_ss: 0.937694, loss_d: 0.299814
0.1535 --- loss: 0.912181, loss_ss: 0.817818, loss_d: 0.094363
0.1919 --- loss: 1.085622, loss_ss: 0.981146, loss_d: 0.104476
0.2302 --- loss: 1.259974, loss_ss: 0.973730, loss_d: 0.286244
0.2686 --- loss: 1.306576, loss_ss: 1.008330, loss_d: 0.298247
0.3070 --- loss: 1.420106, loss_ss: 1.043530, loss_d: 0.376576
0.3454 --- loss: 1.355574, loss_ss: 0.948627, loss_d: 0.406947
0.3837 --- loss: 1.152286, loss_ss: 0.938296, loss_d: 0.213990
0.4221 --- loss: 0.972086, loss_ss: 0.752490, loss_d: 0.219596
0.4605 --- loss: 1.083744, loss_ss: 0.914802, loss_d: 0.168942
0.4988 --- loss: 1.582978, loss_ss: 0.975318, loss_d: 0.607661
0.5372 --- loss: 1.091005, loss_ss: 1.023624, loss_d: 0.067381
0.5756 --- loss: 1.083123, loss_ss: 0.898668, loss_d: 0.184455
0.6140 --- loss: 1.144711, loss_ss: 0.904059, loss_d: 0.240652
0.6523 --- loss: 1.196235, loss_ss: 1.079209, loss_d: 0.117025
0.6907 --- loss: 0.907882, loss_ss: 0.789361, loss_d: 0.118521
0.7291 --- loss: 1.165352, loss_ss: 0.814310, loss_d: 0.351041
0.7675 --- loss: 0.992866, loss_ss: 0.784518, loss_d: 0.208348
0.8058 --- loss: 1.388986, loss_ss: 1.107269, loss_d: 0.281717
0.8442 --- loss: 1.309121, loss_ss: 0.819428, loss_d: 0.489694
0.8826 --- loss: 1.046628, loss_ss: 0.683661, loss_d: 0.362967
0.9210 --- loss: 0.746693, loss_ss: 0.594135, loss_d: 0.152557
0.9593 --- loss: 0.987134, loss_ss: 0.862698, loss_d: 0.124437
0.9977 --- loss: 1.117533, loss_ss: 1.028569, loss_d: 0.088964
Epoch finished! Loss: 1.1648724086009539
Starting epoch 4/10.
0.0000 --- loss: 1.440677, loss_ss: 1.133721, loss_d: 0.306956
0.0384 --- loss: 1.046072, loss_ss: 0.856491, loss_d: 0.189581
0.0767 --- loss: 1.184981, loss_ss: 0.740415, loss_d: 0.444566
0.1151 --- loss: 0.938317, loss_ss: 0.862928, loss_d: 0.075389
0.1535 --- loss: 1.563583, loss_ss: 0.960890, loss_d: 0.602693
0.1919 --- loss: 0.928167, loss_ss: 0.751678, loss_d: 0.176489
0.2302 --- loss: 1.160291, loss_ss: 0.753370, loss_d: 0.406921
0.2686 --- loss: 0.878020, loss_ss: 0.708140, loss_d: 0.169880
0.3070 --- loss: 0.825888, loss_ss: 0.686211, loss_d: 0.139677
0.3454 --- loss: 1.467100, loss_ss: 1.191085, loss_d: 0.276015
0.3837 --- loss: 1.206201, loss_ss: 0.713388, loss_d: 0.492814
0.4221 --- loss: 0.967311, loss_ss: 0.760616, loss_d: 0.206694
0.4605 --- loss: 0.722020, loss_ss: 0.559592, loss_d: 0.162428
0.4988 --- loss: 0.829386, loss_ss: 0.772131, loss_d: 0.057255
0.5372 --- loss: 0.903086, loss_ss: 0.688842, loss_d: 0.214243
0.5756 --- loss: 0.976611, loss_ss: 0.773776, loss_d: 0.202835
0.6140 --- loss: 0.992494, loss_ss: 0.596977, loss_d: 0.395517
0.6523 --- loss: 0.833851, loss_ss: 0.757312, loss_d: 0.076539
0.6907 --- loss: 1.355189, loss_ss: 0.940240, loss_d: 0.414949
0.7291 --- loss: 0.790171, loss_ss: 0.630308, loss_d: 0.159863
0.7675 --- loss: 0.830017, loss_ss: 0.695673, loss_d: 0.134343
0.8058 --- loss: 0.861004, loss_ss: 0.719751, loss_d: 0.141254
0.8442 --- loss: 0.949142, loss_ss: 0.831166, loss_d: 0.117975
0.8826 --- loss: 0.867005, loss_ss: 0.802326, loss_d: 0.064679
0.9210 --- loss: 0.957259, loss_ss: 0.569273, loss_d: 0.387987
0.9593 --- loss: 1.210245, loss_ss: 0.894795, loss_d: 0.315450
0.9977 --- loss: 0.681114, loss_ss: 0.640736, loss_d: 0.040378
Epoch finished! Loss: 1.036390944169118
Starting epoch 5/10.
0.0000 --- loss: 1.028076, loss_ss: 0.994663, loss_d: 0.033412
0.0384 --- loss: 0.805269, loss_ss: 0.726418, loss_d: 0.078851
0.0767 --- loss: 1.504045, loss_ss: 1.326565, loss_d: 0.177481
0.1151 --- loss: 1.389807, loss_ss: 1.278156, loss_d: 0.111650
0.1535 --- loss: 0.799322, loss_ss: 0.620243, loss_d: 0.179079
0.1919 --- loss: 1.195620, loss_ss: 0.794319, loss_d: 0.401301
0.2302 --- loss: 0.800247, loss_ss: 0.729607, loss_d: 0.070640
0.2686 --- loss: 0.823913, loss_ss: 0.790282, loss_d: 0.033631
0.3070 --- loss: 1.051193, loss_ss: 0.939999, loss_d: 0.111194
0.3454 --- loss: 0.922740, loss_ss: 0.828576, loss_d: 0.094163
0.3837 --- loss: 0.902854, loss_ss: 0.797464, loss_d: 0.105390
0.4221 --- loss: 1.100560, loss_ss: 0.796067, loss_d: 0.304493
0.4605 --- loss: 1.139281, loss_ss: 0.715559, loss_d: 0.423722
0.4988 --- loss: 0.761403, loss_ss: 0.681214, loss_d: 0.080190
0.5372 --- loss: 1.055332, loss_ss: 0.821918, loss_d: 0.233414
0.5756 --- loss: 1.044904, loss_ss: 0.993359, loss_d: 0.051545
0.6140 --- loss: 1.089390, loss_ss: 0.822972, loss_d: 0.266417
0.6523 --- loss: 0.879342, loss_ss: 0.816684, loss_d: 0.062659
0.6907 --- loss: 0.693941, loss_ss: 0.643829, loss_d: 0.050112
0.7291 --- loss: 1.105959, loss_ss: 0.981863, loss_d: 0.124095
0.7675 --- loss: 1.493685, loss_ss: 0.917510, loss_d: 0.576174
0.8058 --- loss: 1.352447, loss_ss: 0.996584, loss_d: 0.355862
0.8442 --- loss: 0.970338, loss_ss: 0.861649, loss_d: 0.108689
0.8826 --- loss: 0.741967, loss_ss: 0.543986, loss_d: 0.197981
0.9210 --- loss: 0.918556, loss_ss: 0.605827, loss_d: 0.312729
0.9593 --- loss: 0.703718, loss_ss: 0.614803, loss_d: 0.088914
0.9977 --- loss: 0.792925, loss_ss: 0.731978, loss_d: 0.060947
Epoch finished! Loss: 0.9991716425006206
Starting epoch 6/10.
0.0000 --- loss: 0.892614, loss_ss: 0.838788, loss_d: 0.053826
0.0384 --- loss: 1.155364, loss_ss: 0.793107, loss_d: 0.362256
0.0767 --- loss: 0.994824, loss_ss: 0.917815, loss_d: 0.077009
0.1151 --- loss: 0.589802, loss_ss: 0.437663, loss_d: 0.152139
0.1535 --- loss: 1.193632, loss_ss: 0.949100, loss_d: 0.244533
0.1919 --- loss: 1.078933, loss_ss: 0.617045, loss_d: 0.461888
0.2302 --- loss: 0.857971, loss_ss: 0.823363, loss_d: 0.034608
0.2686 --- loss: 0.865474, loss_ss: 0.806036, loss_d: 0.059438
0.3070 --- loss: 1.514171, loss_ss: 0.923190, loss_d: 0.590981
0.3454 --- loss: 1.421622, loss_ss: 0.784595, loss_d: 0.637026
0.3837 --- loss: 1.012641, loss_ss: 0.884254, loss_d: 0.128387
0.4221 --- loss: 0.685576, loss_ss: 0.640254, loss_d: 0.045322
0.4605 --- loss: 0.750331, loss_ss: 0.648963, loss_d: 0.101368
0.4988 --- loss: 0.786969, loss_ss: 0.745988, loss_d: 0.040981
0.5372 --- loss: 0.932231, loss_ss: 0.852231, loss_d: 0.080000
0.5756 --- loss: 0.842271, loss_ss: 0.697338, loss_d: 0.144934
0.6140 --- loss: 0.969663, loss_ss: 0.801124, loss_d: 0.168538
0.6523 --- loss: 0.975187, loss_ss: 0.947669, loss_d: 0.027518
0.6907 --- loss: 0.954071, loss_ss: 0.825592, loss_d: 0.128479
0.7291 --- loss: 1.393601, loss_ss: 0.595774, loss_d: 0.797827
0.7675 --- loss: 0.841687, loss_ss: 0.809678, loss_d: 0.032010
0.8058 --- loss: 0.834045, loss_ss: 0.792822, loss_d: 0.041222
0.8442 --- loss: 0.826463, loss_ss: 0.790287, loss_d: 0.036175
0.8826 --- loss: 1.314670, loss_ss: 0.987199, loss_d: 0.327471
0.9210 --- loss: 0.973053, loss_ss: 0.822805, loss_d: 0.150248
0.9593 --- loss: 0.662430, loss_ss: 0.604692, loss_d: 0.057738
0.9977 --- loss: 0.583561, loss_ss: 0.571257, loss_d: 0.012304
Epoch finished! Loss: 0.94475373006784
Starting epoch 7/10.
0.0000 --- loss: 1.050509, loss_ss: 1.040200, loss_d: 0.010309
0.0384 --- loss: 0.500079, loss_ss: 0.461209, loss_d: 0.038869
0.0767 --- loss: 0.997127, loss_ss: 0.958459, loss_d: 0.038668
0.1151 --- loss: 0.645947, loss_ss: 0.628573, loss_d: 0.017375
0.1535 --- loss: 1.112854, loss_ss: 1.046042, loss_d: 0.066811
0.1919 --- loss: 0.876297, loss_ss: 0.838040, loss_d: 0.038257
0.2302 --- loss: 0.833772, loss_ss: 0.642386, loss_d: 0.191386
0.2686 --- loss: 0.684311, loss_ss: 0.639098, loss_d: 0.045212
0.3070 --- loss: 0.742896, loss_ss: 0.729700, loss_d: 0.013195
0.3454 --- loss: 0.985472, loss_ss: 0.933606, loss_d: 0.051865
0.3837 --- loss: 0.962230, loss_ss: 0.711675, loss_d: 0.250554
0.4221 --- loss: 0.686770, loss_ss: 0.628697, loss_d: 0.058073
0.4605 --- loss: 0.619227, loss_ss: 0.602062, loss_d: 0.017164
0.4988 --- loss: 0.548028, loss_ss: 0.518743, loss_d: 0.029285
0.5372 --- loss: 1.098701, loss_ss: 0.869925, loss_d: 0.228776
0.5756 --- loss: 0.929687, loss_ss: 0.648504, loss_d: 0.281183
0.6140 --- loss: 0.839594, loss_ss: 0.823629, loss_d: 0.015965
0.6523 --- loss: 0.718537, loss_ss: 0.681466, loss_d: 0.037071
0.6907 --- loss: 0.707418, loss_ss: 0.651753, loss_d: 0.055665
0.7291 --- loss: 1.065223, loss_ss: 0.994876, loss_d: 0.070347
0.7675 --- loss: 0.970736, loss_ss: 0.925968, loss_d: 0.044769
0.8058 --- loss: 0.792170, loss_ss: 0.633855, loss_d: 0.158315
0.8442 --- loss: 0.744929, loss_ss: 0.651898, loss_d: 0.093032
0.8826 --- loss: 0.949196, loss_ss: 0.587472, loss_d: 0.361724
0.9210 --- loss: 1.240922, loss_ss: 1.160730, loss_d: 0.080191
0.9593 --- loss: 0.836416, loss_ss: 0.734655, loss_d: 0.101761
0.9977 --- loss: 0.624211, loss_ss: 0.615866, loss_d: 0.008345
Epoch finished! Loss: 0.8823986594493572
Starting epoch 8/10.
0.0000 --- loss: 0.557045, loss_ss: 0.532699, loss_d: 0.024346
0.0384 --- loss: 0.758210, loss_ss: 0.725251, loss_d: 0.032959
0.0767 --- loss: 1.042225, loss_ss: 0.862847, loss_d: 0.179377
0.1151 --- loss: 0.779096, loss_ss: 0.765927, loss_d: 0.013169
0.1535 --- loss: 0.686865, loss_ss: 0.663213, loss_d: 0.023652
0.1919 --- loss: 0.768062, loss_ss: 0.736980, loss_d: 0.031082
0.2302 --- loss: 0.824919, loss_ss: 0.780569, loss_d: 0.044350
0.2686 --- loss: 0.910792, loss_ss: 0.675222, loss_d: 0.235570
0.3070 --- loss: 0.986851, loss_ss: 0.711544, loss_d: 0.275307
0.3454 --- loss: 0.891643, loss_ss: 0.810062, loss_d: 0.081581
0.3837 --- loss: 0.673051, loss_ss: 0.598784, loss_d: 0.074267
0.4221 --- loss: 1.607516, loss_ss: 1.357946, loss_d: 0.249570
0.4605 --- loss: 0.773656, loss_ss: 0.586590, loss_d: 0.187066
0.4988 --- loss: 0.852256, loss_ss: 0.724419, loss_d: 0.127837
0.5372 --- loss: 0.588387, loss_ss: 0.519088, loss_d: 0.069299
0.5756 --- loss: 0.925656, loss_ss: 0.881103, loss_d: 0.044553
0.6140 --- loss: 1.197978, loss_ss: 1.172315, loss_d: 0.025664
0.6523 --- loss: 0.756624, loss_ss: 0.661413, loss_d: 0.095211
0.6907 --- loss: 1.027430, loss_ss: 0.713194, loss_d: 0.314236
0.7291 --- loss: 1.044483, loss_ss: 0.719408, loss_d: 0.325075
0.7675 --- loss: 0.635973, loss_ss: 0.547513, loss_d: 0.088461
0.8058 --- loss: 0.732798, loss_ss: 0.690861, loss_d: 0.041936
0.8442 --- loss: 1.013540, loss_ss: 0.994636, loss_d: 0.018904
0.8826 --- loss: 1.394853, loss_ss: 1.377889, loss_d: 0.016964
0.9210 --- loss: 1.196177, loss_ss: 1.160394, loss_d: 0.035783
0.9593 --- loss: 0.891057, loss_ss: 0.875408, loss_d: 0.015649
0.9977 --- loss: 0.859034, loss_ss: 0.851769, loss_d: 0.007265
Epoch finished! Loss: 0.8864054615680989
Starting epoch 9/10.
0.0000 --- loss: 0.599297, loss_ss: 0.592635, loss_d: 0.006663
0.0384 --- loss: 1.023234, loss_ss: 0.855731, loss_d: 0.167502
0.0767 --- loss: 1.204961, loss_ss: 1.066888, loss_d: 0.138073
0.1151 --- loss: 0.842215, loss_ss: 0.824261, loss_d: 0.017954
0.1535 --- loss: 0.802201, loss_ss: 0.740913, loss_d: 0.061288
0.1919 --- loss: 1.034665, loss_ss: 0.952507, loss_d: 0.082158
0.2302 --- loss: 0.904747, loss_ss: 0.731725, loss_d: 0.173022
0.2686 --- loss: 0.622699, loss_ss: 0.593497, loss_d: 0.029201
0.3070 --- loss: 0.926728, loss_ss: 0.728843, loss_d: 0.197885
0.3454 --- loss: 0.695033, loss_ss: 0.645926, loss_d: 0.049107
0.3837 --- loss: 0.787983, loss_ss: 0.744893, loss_d: 0.043090
0.4221 --- loss: 1.103446, loss_ss: 0.656962, loss_d: 0.446484
0.4605 --- loss: 0.766448, loss_ss: 0.757995, loss_d: 0.008453
0.4988 --- loss: 0.571839, loss_ss: 0.555725, loss_d: 0.016114
0.5372 --- loss: 0.660871, loss_ss: 0.656891, loss_d: 0.003980
0.5756 --- loss: 0.604899, loss_ss: 0.416189, loss_d: 0.188710
0.6140 --- loss: 0.703673, loss_ss: 0.668908, loss_d: 0.034765
0.6523 --- loss: 0.856081, loss_ss: 0.840809, loss_d: 0.015272
0.6907 --- loss: 0.755278, loss_ss: 0.727961, loss_d: 0.027317
0.7291 --- loss: 0.599418, loss_ss: 0.588755, loss_d: 0.010663
0.7675 --- loss: 1.024556, loss_ss: 0.979227, loss_d: 0.045329
0.8058 --- loss: 0.888956, loss_ss: 0.513440, loss_d: 0.375516
0.8442 --- loss: 0.875227, loss_ss: 0.861550, loss_d: 0.013678
0.8826 --- loss: 0.860786, loss_ss: 0.827581, loss_d: 0.033205
0.9210 --- loss: 0.787689, loss_ss: 0.778838, loss_d: 0.008851
0.9593 --- loss: 0.708346, loss_ss: 0.545684, loss_d: 0.162662
0.9977 --- loss: 1.135989, loss_ss: 1.131455, loss_d: 0.004534
Epoch finished! Loss: 0.8263675438670012
Starting epoch 10/10.
0.0000 --- loss: 0.620456, loss_ss: 0.594918, loss_d: 0.025538
0.0384 --- loss: 0.840324, loss_ss: 0.683222, loss_d: 0.157102
0.0767 --- loss: 0.869731, loss_ss: 0.738913, loss_d: 0.130817
0.1151 --- loss: 1.060091, loss_ss: 0.965761, loss_d: 0.094330
0.1535 --- loss: 0.614160, loss_ss: 0.468636, loss_d: 0.145524
0.1919 --- loss: 0.809923, loss_ss: 0.744005, loss_d: 0.065918
0.2302 --- loss: 0.845244, loss_ss: 0.787046, loss_d: 0.058197
0.2686 --- loss: 0.593702, loss_ss: 0.552550, loss_d: 0.041152
0.3070 --- loss: 0.483472, loss_ss: 0.480679, loss_d: 0.002793
0.3454 --- loss: 0.633430, loss_ss: 0.629280, loss_d: 0.004149
0.3837 --- loss: 0.632635, loss_ss: 0.580682, loss_d: 0.051953
0.4221 --- loss: 0.559735, loss_ss: 0.483698, loss_d: 0.076037
0.4605 --- loss: 0.715693, loss_ss: 0.695035, loss_d: 0.020658
0.4988 --- loss: 0.792802, loss_ss: 0.665381, loss_d: 0.127421
0.5372 --- loss: 0.673357, loss_ss: 0.668341, loss_d: 0.005016
0.5756 --- loss: 0.752524, loss_ss: 0.643912, loss_d: 0.108612
0.6140 --- loss: 0.742716, loss_ss: 0.726247, loss_d: 0.016468
0.6523 --- loss: 1.085723, loss_ss: 1.059336, loss_d: 0.026387
0.6907 --- loss: 0.673516, loss_ss: 0.660892, loss_d: 0.012624
0.7291 --- loss: 0.598308, loss_ss: 0.577470, loss_d: 0.020838
0.7675 --- loss: 1.319493, loss_ss: 0.600725, loss_d: 0.718768
0.8058 --- loss: 0.761863, loss_ss: 0.738918, loss_d: 0.022945
0.8442 --- loss: 1.244033, loss_ss: 0.835637, loss_d: 0.408397
0.8826 --- loss: 0.731208, loss_ss: 0.722089, loss_d: 0.009119
0.9210 --- loss: 0.594431, loss_ss: 0.557121, loss_d: 0.037309
0.9593 --- loss: 0.562664, loss_ss: 0.546596, loss_d: 0.016069
0.9977 --- loss: 0.848949, loss_ss: 0.847913, loss_d: 0.001036
Epoch finished! Loss: 0.8079710163749181
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7614583333333333
             precision    recall  f1-score   support

        0.0       0.95      0.88      0.91       144
        1.0       0.45      0.63      0.53        82
        2.0       0.77      0.72      0.74       379
        3.0       1.00      0.68      0.81       227
        4.0       0.62      1.00      0.76       128

avg / total       0.81      0.76      0.77       960
 


====== chc008-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  97.50   87.50   99.26   95.45     91.30
1  90.21   63.41   92.71   44.83     52.53
2  80.42   71.50   86.23   77.21     74.25
3  92.40   67.84  100.00  100.00     80.84
4  91.77  100.00   90.50   61.84     76.42
Total accuracy: 76.15%
Average sen: 78.05%
Average spec: 93.74%
Macro f1-score: 75.07%
Diagnosis acc on 15mins: 0.65625
[9.99061525e-01 7.82279670e-01 1.28240541e-01 9.88751352e-01
 9.78576720e-01 9.99955058e-01 9.98706937e-01 9.31205414e-03
 8.35240446e-03 7.83442855e-01 8.31942558e-01 5.03417313e-01
 4.56514329e-01 9.38864529e-01 4.69391584e-01 2.85556525e-01
 4.76572439e-02 6.89397335e-01 4.32465702e-01 1.24301342e-02
 1.06710664e-04 8.58421918e-05 5.06491733e-06 4.98897815e-03
 7.12656509e-03 9.10871080e-04 1.77622816e-04 1.09370484e-03
 2.67085456e-03 4.28680960e-06 2.03645456e-07 3.75268087e-06]
pred: 0.3550465883531415, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.571171, loss_ss: 1.801634, loss_d: 0.769537
0.0383 --- loss: 2.430190, loss_ss: 1.719155, loss_d: 0.711034
0.0767 --- loss: 2.366445, loss_ss: 1.774525, loss_d: 0.591920
0.1150 --- loss: 2.289895, loss_ss: 1.650581, loss_d: 0.639313
0.1533 --- loss: 1.878522, loss_ss: 1.435447, loss_d: 0.443075
0.1916 --- loss: 2.626755, loss_ss: 1.596851, loss_d: 1.029904
0.2300 --- loss: 1.942253, loss_ss: 1.372534, loss_d: 0.569719
0.2683 --- loss: 2.099841, loss_ss: 1.385470, loss_d: 0.714371
0.3066 --- loss: 2.062570, loss_ss: 1.508689, loss_d: 0.553881
0.3450 --- loss: 2.228983, loss_ss: 1.518241, loss_d: 0.710742
0.3833 --- loss: 2.033193, loss_ss: 1.538772, loss_d: 0.494421
0.4216 --- loss: 2.055269, loss_ss: 1.272717, loss_d: 0.782552
0.4599 --- loss: 1.881426, loss_ss: 1.393923, loss_d: 0.487503
0.4983 --- loss: 1.754315, loss_ss: 1.286846, loss_d: 0.467468
0.5366 --- loss: 1.670422, loss_ss: 1.377563, loss_d: 0.292859
0.5749 --- loss: 1.619745, loss_ss: 1.342991, loss_d: 0.276753
0.6133 --- loss: 2.015599, loss_ss: 1.602573, loss_d: 0.413026
0.6516 --- loss: 1.798494, loss_ss: 1.390317, loss_d: 0.408176
0.6899 --- loss: 1.994120, loss_ss: 1.375114, loss_d: 0.619006
0.7282 --- loss: 1.910269, loss_ss: 1.230168, loss_d: 0.680102
0.7666 --- loss: 1.938565, loss_ss: 1.509148, loss_d: 0.429417
0.8049 --- loss: 1.596269, loss_ss: 1.161024, loss_d: 0.435245
0.8432 --- loss: 1.896502, loss_ss: 1.477421, loss_d: 0.419081
0.8816 --- loss: 1.844203, loss_ss: 1.358484, loss_d: 0.485719
0.9199 --- loss: 1.648133, loss_ss: 1.165423, loss_d: 0.482710
0.9582 --- loss: 1.752031, loss_ss: 1.281648, loss_d: 0.470383
0.9966 --- loss: 1.701343, loss_ss: 1.206468, loss_d: 0.494875
Epoch finished! Loss: 1.971974907013086
Starting epoch 2/10.
0.0000 --- loss: 1.586646, loss_ss: 1.307471, loss_d: 0.279175
0.0383 --- loss: 1.783973, loss_ss: 1.212275, loss_d: 0.571699
0.0767 --- loss: 1.611184, loss_ss: 1.295621, loss_d: 0.315563
0.1150 --- loss: 1.372120, loss_ss: 1.163724, loss_d: 0.208395
0.1533 --- loss: 1.619786, loss_ss: 1.055559, loss_d: 0.564227
0.1916 --- loss: 1.529773, loss_ss: 1.158264, loss_d: 0.371510
0.2300 --- loss: 1.399399, loss_ss: 1.076662, loss_d: 0.322737
0.2683 --- loss: 1.263275, loss_ss: 1.086758, loss_d: 0.176517
0.3066 --- loss: 1.488166, loss_ss: 1.167160, loss_d: 0.321006
0.3450 --- loss: 1.380175, loss_ss: 1.191656, loss_d: 0.188518
0.3833 --- loss: 1.267658, loss_ss: 1.021080, loss_d: 0.246578
0.4216 --- loss: 1.252591, loss_ss: 0.936918, loss_d: 0.315673
0.4599 --- loss: 1.465005, loss_ss: 1.177483, loss_d: 0.287522
0.4983 --- loss: 1.087212, loss_ss: 0.943809, loss_d: 0.143403
0.5366 --- loss: 1.339193, loss_ss: 1.184597, loss_d: 0.154596
0.5749 --- loss: 1.618246, loss_ss: 0.942545, loss_d: 0.675701
0.6133 --- loss: 1.679137, loss_ss: 0.867306, loss_d: 0.811830
0.6516 --- loss: 1.496076, loss_ss: 1.167068, loss_d: 0.329008
0.6899 --- loss: 1.217676, loss_ss: 0.801986, loss_d: 0.415690
0.7282 --- loss: 1.379335, loss_ss: 1.022522, loss_d: 0.356813
0.7666 --- loss: 1.189134, loss_ss: 1.089645, loss_d: 0.099490
0.8049 --- loss: 1.145244, loss_ss: 1.052496, loss_d: 0.092749
0.8432 --- loss: 1.343153, loss_ss: 1.032253, loss_d: 0.310900
0.8816 --- loss: 1.811490, loss_ss: 1.184796, loss_d: 0.626693
0.9199 --- loss: 1.231002, loss_ss: 0.996572, loss_d: 0.234431
0.9582 --- loss: 1.031239, loss_ss: 0.779564, loss_d: 0.251675
0.9966 --- loss: 1.293333, loss_ss: 1.156613, loss_d: 0.136720
Epoch finished! Loss: 1.4141681047586294
Starting epoch 3/10.
0.0000 --- loss: 1.601036, loss_ss: 0.863284, loss_d: 0.737752
0.0383 --- loss: 1.108378, loss_ss: 0.877083, loss_d: 0.231295
0.0767 --- loss: 1.045261, loss_ss: 0.898730, loss_d: 0.146531
0.1150 --- loss: 1.079930, loss_ss: 0.961447, loss_d: 0.118482
0.1533 --- loss: 1.114383, loss_ss: 0.823196, loss_d: 0.291187
0.1916 --- loss: 1.311714, loss_ss: 1.112514, loss_d: 0.199200
0.2300 --- loss: 1.048570, loss_ss: 0.767716, loss_d: 0.280853
0.2683 --- loss: 1.187021, loss_ss: 0.892759, loss_d: 0.294262
0.3066 --- loss: 0.872105, loss_ss: 0.753882, loss_d: 0.118223
0.3450 --- loss: 1.325487, loss_ss: 1.244019, loss_d: 0.081468
0.3833 --- loss: 1.056108, loss_ss: 1.005821, loss_d: 0.050287
0.4216 --- loss: 1.251353, loss_ss: 0.704277, loss_d: 0.547076
0.4599 --- loss: 1.079619, loss_ss: 0.770301, loss_d: 0.309318
0.4983 --- loss: 1.113612, loss_ss: 0.750952, loss_d: 0.362660
0.5366 --- loss: 0.907353, loss_ss: 0.754273, loss_d: 0.153079
0.5749 --- loss: 0.886011, loss_ss: 0.830019, loss_d: 0.055991
0.6133 --- loss: 1.079089, loss_ss: 1.014240, loss_d: 0.064850
0.6516 --- loss: 0.996274, loss_ss: 0.908315, loss_d: 0.087959
0.6899 --- loss: 1.527914, loss_ss: 0.923136, loss_d: 0.604778
0.7282 --- loss: 0.818857, loss_ss: 0.714114, loss_d: 0.104743
0.7666 --- loss: 1.402362, loss_ss: 1.017596, loss_d: 0.384765
0.8049 --- loss: 1.811511, loss_ss: 0.821575, loss_d: 0.989936
0.8432 --- loss: 1.196617, loss_ss: 0.956424, loss_d: 0.240194
0.8816 --- loss: 1.128592, loss_ss: 1.005775, loss_d: 0.122817
0.9199 --- loss: 1.002923, loss_ss: 0.835218, loss_d: 0.167706
0.9582 --- loss: 1.147355, loss_ss: 0.938859, loss_d: 0.208496
0.9966 --- loss: 0.920878, loss_ss: 0.896719, loss_d: 0.024159
Epoch finished! Loss: 1.147082292345854
Starting epoch 4/10.
0.0000 --- loss: 0.830114, loss_ss: 0.785223, loss_d: 0.044890
0.0383 --- loss: 0.956898, loss_ss: 0.821853, loss_d: 0.135046
0.0767 --- loss: 1.058251, loss_ss: 0.823763, loss_d: 0.234488
0.1150 --- loss: 0.877808, loss_ss: 0.734184, loss_d: 0.143624
0.1533 --- loss: 0.952982, loss_ss: 0.772523, loss_d: 0.180459
0.1916 --- loss: 0.993067, loss_ss: 0.847563, loss_d: 0.145504
0.2300 --- loss: 0.741775, loss_ss: 0.702684, loss_d: 0.039091
0.2683 --- loss: 1.063535, loss_ss: 0.980994, loss_d: 0.082542
0.3066 --- loss: 0.892380, loss_ss: 0.729010, loss_d: 0.163371
0.3450 --- loss: 0.900657, loss_ss: 0.732803, loss_d: 0.167854
0.3833 --- loss: 0.886116, loss_ss: 0.821586, loss_d: 0.064530
0.4216 --- loss: 1.345782, loss_ss: 0.909734, loss_d: 0.436048
0.4599 --- loss: 1.338391, loss_ss: 0.743322, loss_d: 0.595069
0.4983 --- loss: 1.039605, loss_ss: 0.750592, loss_d: 0.289012
0.5366 --- loss: 0.992269, loss_ss: 0.810498, loss_d: 0.181771
0.5749 --- loss: 1.061178, loss_ss: 1.017520, loss_d: 0.043658
0.6133 --- loss: 0.933263, loss_ss: 0.668399, loss_d: 0.264865
0.6516 --- loss: 1.150744, loss_ss: 0.926905, loss_d: 0.223839
0.6899 --- loss: 0.947718, loss_ss: 0.646038, loss_d: 0.301680
0.7282 --- loss: 0.817708, loss_ss: 0.775293, loss_d: 0.042415
0.7666 --- loss: 1.005326, loss_ss: 0.884107, loss_d: 0.121219
0.8049 --- loss: 0.666660, loss_ss: 0.625305, loss_d: 0.041355
0.8432 --- loss: 0.905186, loss_ss: 0.784498, loss_d: 0.120687
0.8816 --- loss: 1.058314, loss_ss: 0.683210, loss_d: 0.375104
0.9199 --- loss: 0.933668, loss_ss: 0.857026, loss_d: 0.076643
0.9582 --- loss: 0.922842, loss_ss: 0.840361, loss_d: 0.082482
0.9966 --- loss: 1.278907, loss_ss: 0.837575, loss_d: 0.441332
Epoch finished! Loss: 1.032055288553238
Starting epoch 5/10.
0.0000 --- loss: 0.731657, loss_ss: 0.660051, loss_d: 0.071606
0.0383 --- loss: 1.232391, loss_ss: 1.169358, loss_d: 0.063034
0.0767 --- loss: 1.057622, loss_ss: 0.894339, loss_d: 0.163283
0.1150 --- loss: 0.790410, loss_ss: 0.689061, loss_d: 0.101350
0.1533 --- loss: 0.829664, loss_ss: 0.797824, loss_d: 0.031839
0.1916 --- loss: 0.555025, loss_ss: 0.527012, loss_d: 0.028013
0.2300 --- loss: 0.892516, loss_ss: 0.653237, loss_d: 0.239279
0.2683 --- loss: 1.015653, loss_ss: 0.927152, loss_d: 0.088501
0.3066 --- loss: 0.734390, loss_ss: 0.689406, loss_d: 0.044984
0.3450 --- loss: 1.017880, loss_ss: 0.840272, loss_d: 0.177608
0.3833 --- loss: 1.050131, loss_ss: 0.772036, loss_d: 0.278095
0.4216 --- loss: 1.035138, loss_ss: 1.010458, loss_d: 0.024681
0.4599 --- loss: 0.838130, loss_ss: 0.767229, loss_d: 0.070902
0.4983 --- loss: 0.955319, loss_ss: 0.933693, loss_d: 0.021626
0.5366 --- loss: 0.735773, loss_ss: 0.543604, loss_d: 0.192169
0.5749 --- loss: 0.810342, loss_ss: 0.784754, loss_d: 0.025588
0.6133 --- loss: 0.956878, loss_ss: 0.591996, loss_d: 0.364882
0.6516 --- loss: 0.845793, loss_ss: 0.815153, loss_d: 0.030640
0.6899 --- loss: 1.114010, loss_ss: 0.964080, loss_d: 0.149931
0.7282 --- loss: 0.942470, loss_ss: 0.839793, loss_d: 0.102678
0.7666 --- loss: 0.723542, loss_ss: 0.659762, loss_d: 0.063780
0.8049 --- loss: 1.217435, loss_ss: 0.626016, loss_d: 0.591419
0.8432 --- loss: 0.621291, loss_ss: 0.566127, loss_d: 0.055164
0.8816 --- loss: 0.639611, loss_ss: 0.616426, loss_d: 0.023185
0.9199 --- loss: 0.648838, loss_ss: 0.584679, loss_d: 0.064159
0.9582 --- loss: 0.960410, loss_ss: 0.816756, loss_d: 0.143654
0.9966 --- loss: 0.879938, loss_ss: 0.581137, loss_d: 0.298801
Epoch finished! Loss: 0.9520926156869302
Starting epoch 6/10.
0.0000 --- loss: 0.952926, loss_ss: 0.924307, loss_d: 0.028619
0.0383 --- loss: 0.935644, loss_ss: 0.804331, loss_d: 0.131313
0.0767 --- loss: 1.256661, loss_ss: 1.157381, loss_d: 0.099281
0.1150 --- loss: 0.754897, loss_ss: 0.677488, loss_d: 0.077408
0.1533 --- loss: 0.824166, loss_ss: 0.772061, loss_d: 0.052105
0.1916 --- loss: 0.994607, loss_ss: 0.951926, loss_d: 0.042681
0.2300 --- loss: 0.723502, loss_ss: 0.692976, loss_d: 0.030526
0.2683 --- loss: 0.907657, loss_ss: 0.744842, loss_d: 0.162815
0.3066 --- loss: 0.634828, loss_ss: 0.484444, loss_d: 0.150384
0.3450 --- loss: 0.592742, loss_ss: 0.575637, loss_d: 0.017105
0.3833 --- loss: 0.997640, loss_ss: 0.661158, loss_d: 0.336483
0.4216 --- loss: 1.088241, loss_ss: 1.041553, loss_d: 0.046688
0.4599 --- loss: 1.009447, loss_ss: 0.969798, loss_d: 0.039649
0.4983 --- loss: 0.810498, loss_ss: 0.771218, loss_d: 0.039280
0.5366 --- loss: 0.855038, loss_ss: 0.811210, loss_d: 0.043828
0.5749 --- loss: 0.803780, loss_ss: 0.769599, loss_d: 0.034181
0.6133 --- loss: 0.927988, loss_ss: 0.662355, loss_d: 0.265633
0.6516 --- loss: 0.979230, loss_ss: 0.829439, loss_d: 0.149791
0.6899 --- loss: 0.880821, loss_ss: 0.858989, loss_d: 0.021831
0.7282 --- loss: 0.826651, loss_ss: 0.802094, loss_d: 0.024556
0.7666 --- loss: 0.878621, loss_ss: 0.738758, loss_d: 0.139863
0.8049 --- loss: 0.650523, loss_ss: 0.621681, loss_d: 0.028843
0.8432 --- loss: 0.964062, loss_ss: 0.945095, loss_d: 0.018966
0.8816 --- loss: 0.928461, loss_ss: 0.833242, loss_d: 0.095219
0.9199 --- loss: 1.029040, loss_ss: 1.016876, loss_d: 0.012164
0.9582 --- loss: 1.106504, loss_ss: 1.076106, loss_d: 0.030398
0.9966 --- loss: 0.793855, loss_ss: 0.617127, loss_d: 0.176728
Epoch finished! Loss: 0.9119322900588696
Starting epoch 7/10.
0.0000 --- loss: 1.285777, loss_ss: 0.962347, loss_d: 0.323430
0.0383 --- loss: 0.932809, loss_ss: 0.594008, loss_d: 0.338801
0.0767 --- loss: 1.048179, loss_ss: 0.790603, loss_d: 0.257576
0.1150 --- loss: 0.519299, loss_ss: 0.513236, loss_d: 0.006063
0.1533 --- loss: 0.677641, loss_ss: 0.572068, loss_d: 0.105572
0.1916 --- loss: 0.773895, loss_ss: 0.735605, loss_d: 0.038290
0.2300 --- loss: 0.843594, loss_ss: 0.697369, loss_d: 0.146225
0.2683 --- loss: 0.779763, loss_ss: 0.736277, loss_d: 0.043486
0.3066 --- loss: 0.652932, loss_ss: 0.626717, loss_d: 0.026216
0.3450 --- loss: 1.173103, loss_ss: 1.152347, loss_d: 0.020756
0.3833 --- loss: 0.912289, loss_ss: 0.903458, loss_d: 0.008831
0.4216 --- loss: 0.815328, loss_ss: 0.803492, loss_d: 0.011835
0.4599 --- loss: 1.312668, loss_ss: 0.910312, loss_d: 0.402357
0.4983 --- loss: 0.692370, loss_ss: 0.570716, loss_d: 0.121654
0.5366 --- loss: 0.822280, loss_ss: 0.536761, loss_d: 0.285519
0.5749 --- loss: 1.006387, loss_ss: 0.883255, loss_d: 0.123133
0.6133 --- loss: 1.203986, loss_ss: 0.792033, loss_d: 0.411954
0.6516 --- loss: 1.462852, loss_ss: 1.360020, loss_d: 0.102832
0.6899 --- loss: 0.586931, loss_ss: 0.527317, loss_d: 0.059614
0.7282 --- loss: 0.861272, loss_ss: 0.695258, loss_d: 0.166014
0.7666 --- loss: 0.711722, loss_ss: 0.690236, loss_d: 0.021486
0.8049 --- loss: 0.962229, loss_ss: 0.617453, loss_d: 0.344776
0.8432 --- loss: 1.194387, loss_ss: 1.004097, loss_d: 0.190290
0.8816 --- loss: 1.062468, loss_ss: 1.033717, loss_d: 0.028751
0.9199 --- loss: 0.757967, loss_ss: 0.746351, loss_d: 0.011616
0.9582 --- loss: 0.813404, loss_ss: 0.806306, loss_d: 0.007097
0.9966 --- loss: 1.225628, loss_ss: 0.931694, loss_d: 0.293935
Epoch finished! Loss: 0.864529524399684
Starting epoch 8/10.
0.0000 --- loss: 0.634293, loss_ss: 0.622810, loss_d: 0.011483
0.0383 --- loss: 0.672574, loss_ss: 0.604544, loss_d: 0.068030
0.0767 --- loss: 0.774846, loss_ss: 0.763716, loss_d: 0.011130
0.1150 --- loss: 0.615517, loss_ss: 0.605672, loss_d: 0.009845
0.1533 --- loss: 0.893750, loss_ss: 0.870148, loss_d: 0.023602
0.1916 --- loss: 0.999168, loss_ss: 0.887815, loss_d: 0.111352
0.2300 --- loss: 0.656449, loss_ss: 0.627899, loss_d: 0.028550
0.2683 --- loss: 0.692838, loss_ss: 0.677070, loss_d: 0.015768
0.3066 --- loss: 0.694929, loss_ss: 0.674608, loss_d: 0.020322
0.3450 --- loss: 0.740690, loss_ss: 0.709621, loss_d: 0.031069
0.3833 --- loss: 0.962004, loss_ss: 0.923853, loss_d: 0.038150
0.4216 --- loss: 0.599029, loss_ss: 0.533590, loss_d: 0.065439
0.4599 --- loss: 0.803221, loss_ss: 0.772787, loss_d: 0.030433
0.4983 --- loss: 0.809411, loss_ss: 0.682549, loss_d: 0.126862
0.5366 --- loss: 0.809143, loss_ss: 0.775430, loss_d: 0.033713
0.5749 --- loss: 0.766648, loss_ss: 0.693311, loss_d: 0.073337
0.6133 --- loss: 0.543494, loss_ss: 0.464798, loss_d: 0.078696
0.6516 --- loss: 0.929126, loss_ss: 0.703312, loss_d: 0.225813
0.6899 --- loss: 0.945431, loss_ss: 0.919976, loss_d: 0.025455
0.7282 --- loss: 0.642986, loss_ss: 0.634374, loss_d: 0.008613
0.7666 --- loss: 0.690962, loss_ss: 0.678893, loss_d: 0.012070
0.8049 --- loss: 0.743697, loss_ss: 0.731729, loss_d: 0.011968
0.8432 --- loss: 0.963295, loss_ss: 0.778283, loss_d: 0.185012
0.8816 --- loss: 0.662588, loss_ss: 0.508230, loss_d: 0.154357
0.9199 --- loss: 0.844791, loss_ss: 0.819409, loss_d: 0.025382
0.9582 --- loss: 0.662175, loss_ss: 0.659507, loss_d: 0.002667
0.9966 --- loss: 0.840381, loss_ss: 0.609205, loss_d: 0.231175
Epoch finished! Loss: 0.8578691347287252
Starting epoch 9/10.
0.0000 --- loss: 0.621824, loss_ss: 0.620722, loss_d: 0.001102
0.0383 --- loss: 0.777111, loss_ss: 0.748015, loss_d: 0.029095
0.0767 --- loss: 0.831113, loss_ss: 0.777412, loss_d: 0.053701
0.1150 --- loss: 0.980719, loss_ss: 0.809804, loss_d: 0.170914
0.1533 --- loss: 0.778007, loss_ss: 0.620977, loss_d: 0.157030
0.1916 --- loss: 0.720171, loss_ss: 0.704742, loss_d: 0.015429
0.2300 --- loss: 0.698770, loss_ss: 0.657987, loss_d: 0.040783
0.2683 --- loss: 0.584112, loss_ss: 0.572330, loss_d: 0.011783
0.3066 --- loss: 0.744851, loss_ss: 0.700000, loss_d: 0.044850
0.3450 --- loss: 0.640384, loss_ss: 0.637756, loss_d: 0.002627
0.3833 --- loss: 0.674746, loss_ss: 0.578257, loss_d: 0.096490
0.4216 --- loss: 0.840331, loss_ss: 0.816881, loss_d: 0.023450
0.4599 --- loss: 0.809422, loss_ss: 0.724013, loss_d: 0.085409
0.4983 --- loss: 1.389272, loss_ss: 0.851713, loss_d: 0.537559
0.5366 --- loss: 0.709556, loss_ss: 0.643928, loss_d: 0.065628
0.5749 --- loss: 0.632456, loss_ss: 0.627581, loss_d: 0.004875
0.6133 --- loss: 0.933170, loss_ss: 0.798180, loss_d: 0.134990
0.6516 --- loss: 0.938263, loss_ss: 0.792026, loss_d: 0.146237
0.6899 --- loss: 1.407552, loss_ss: 1.055986, loss_d: 0.351566
0.7282 --- loss: 1.148981, loss_ss: 0.867762, loss_d: 0.281219
0.7666 --- loss: 0.813878, loss_ss: 0.793693, loss_d: 0.020185
0.8049 --- loss: 0.520035, loss_ss: 0.495230, loss_d: 0.024805
0.8432 --- loss: 0.909267, loss_ss: 0.884887, loss_d: 0.024379
0.8816 --- loss: 0.672018, loss_ss: 0.653359, loss_d: 0.018659
0.9199 --- loss: 1.004887, loss_ss: 0.977622, loss_d: 0.027265
0.9582 --- loss: 0.735654, loss_ss: 0.616653, loss_d: 0.119001
0.9966 --- loss: 1.079983, loss_ss: 0.955198, loss_d: 0.124785
Epoch finished! Loss: 0.8541476814792707
Starting epoch 10/10.
0.0000 --- loss: 0.621061, loss_ss: 0.568833, loss_d: 0.052228
0.0383 --- loss: 0.777722, loss_ss: 0.775589, loss_d: 0.002134
0.0767 --- loss: 1.121853, loss_ss: 0.850598, loss_d: 0.271255
0.1150 --- loss: 0.891397, loss_ss: 0.878346, loss_d: 0.013051
0.1533 --- loss: 0.671850, loss_ss: 0.662326, loss_d: 0.009524
0.1916 --- loss: 0.860587, loss_ss: 0.824380, loss_d: 0.036207
0.2300 --- loss: 1.914986, loss_ss: 0.704862, loss_d: 1.210124
0.2683 --- loss: 1.079633, loss_ss: 1.021014, loss_d: 0.058619
0.3066 --- loss: 1.421356, loss_ss: 0.641464, loss_d: 0.779892
0.3450 --- loss: 1.096910, loss_ss: 0.965479, loss_d: 0.131431
0.3833 --- loss: 0.672045, loss_ss: 0.626697, loss_d: 0.045347
0.4216 --- loss: 0.699627, loss_ss: 0.678698, loss_d: 0.020929
0.4599 --- loss: 0.708061, loss_ss: 0.675872, loss_d: 0.032189
0.4983 --- loss: 0.614950, loss_ss: 0.603742, loss_d: 0.011209
0.5366 --- loss: 1.343533, loss_ss: 1.195314, loss_d: 0.148219
0.5749 --- loss: 0.723370, loss_ss: 0.718532, loss_d: 0.004838
0.6133 --- loss: 0.599357, loss_ss: 0.591241, loss_d: 0.008116
0.6516 --- loss: 0.707385, loss_ss: 0.702887, loss_d: 0.004499
0.6899 --- loss: 0.920129, loss_ss: 0.918715, loss_d: 0.001414
0.7282 --- loss: 0.768234, loss_ss: 0.763389, loss_d: 0.004845
0.7666 --- loss: 1.121788, loss_ss: 0.765450, loss_d: 0.356338
0.8049 --- loss: 1.040949, loss_ss: 1.005100, loss_d: 0.035848
0.8432 --- loss: 1.083275, loss_ss: 1.077189, loss_d: 0.006086
0.8816 --- loss: 0.583736, loss_ss: 0.575624, loss_d: 0.008112
0.9199 --- loss: 0.789268, loss_ss: 0.783453, loss_d: 0.005815
0.9582 --- loss: 0.866758, loss_ss: 0.735539, loss_d: 0.131220
0.9966 --- loss: 0.713031, loss_ss: 0.674700, loss_d: 0.038332
Epoch finished! Loss: 0.8241165553147977
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8597701149425288
             precision    recall  f1-score   support

        0.0       0.84      0.94      0.89        72
        1.0       0.45      0.20      0.27        46
        2.0       0.89      0.88      0.89       443
        3.0       0.83      0.96      0.89       196
        4.0       0.89      0.82      0.85       113

avg / total       0.85      0.86      0.85       870
 


====== chc009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.05  94.44   98.37  83.95     88.89
1  94.48  19.57   98.67  45.00     27.27
2  88.39  88.04   88.76  89.04     88.54
3  94.71  95.92   94.36  83.19     89.10
4  96.32  82.30   98.41  88.57     85.32
Total accuracy: 85.98%
Average sen: 76.05%
Average spec: 95.71%
Macro f1-score: 75.82%
Diagnosis acc on 15mins: 1.0
[9.20741702e-04 3.17098834e-02 1.28478161e-03 1.44873997e-02
 3.66563397e-03 1.15623395e-03 4.34362475e-04 9.62254708e-05
 1.26697167e-04 4.45661228e-03 9.05152131e-03 2.46773213e-01
 4.34849769e-01 1.10594858e-03 8.57970212e-04 1.25334761e-03
 3.18314706e-04 3.90223693e-03 1.69498485e-03 5.70749398e-04
 8.55266349e-04 1.32313138e-03 3.35779530e-03 9.42020863e-03
 3.97687964e-03 4.17567644e-04 7.87369092e-04 4.52951179e-04
 2.91320086e-01]
pred: 0.03691820283008916, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.365367, loss_ss: 1.792481, loss_d: 0.572887
0.0383 --- loss: 2.161942, loss_ss: 1.623510, loss_d: 0.538432
0.0766 --- loss: 2.126491, loss_ss: 1.548139, loss_d: 0.578352
0.1149 --- loss: 2.317363, loss_ss: 1.662762, loss_d: 0.654601
0.1533 --- loss: 2.218470, loss_ss: 1.628402, loss_d: 0.590067
0.1916 --- loss: 2.145620, loss_ss: 1.580677, loss_d: 0.564943
0.2299 --- loss: 1.888377, loss_ss: 1.537857, loss_d: 0.350519
0.2682 --- loss: 1.936119, loss_ss: 1.399894, loss_d: 0.536225
0.3065 --- loss: 2.355194, loss_ss: 1.449322, loss_d: 0.905872
0.3448 --- loss: 2.105953, loss_ss: 1.558475, loss_d: 0.547478
0.3831 --- loss: 1.939902, loss_ss: 1.388214, loss_d: 0.551689
0.4215 --- loss: 2.378886, loss_ss: 1.496254, loss_d: 0.882633
0.4598 --- loss: 1.952343, loss_ss: 1.351050, loss_d: 0.601293
0.4981 --- loss: 1.845606, loss_ss: 1.366259, loss_d: 0.479347
0.5364 --- loss: 1.778112, loss_ss: 1.251598, loss_d: 0.526515
0.5747 --- loss: 1.817405, loss_ss: 1.382383, loss_d: 0.435022
0.6130 --- loss: 1.844570, loss_ss: 1.300427, loss_d: 0.544143
0.6513 --- loss: 1.748289, loss_ss: 1.308335, loss_d: 0.439954
0.6897 --- loss: 2.167912, loss_ss: 1.193069, loss_d: 0.974843
0.7280 --- loss: 1.535382, loss_ss: 1.243047, loss_d: 0.292334
0.7663 --- loss: 1.621757, loss_ss: 1.162783, loss_d: 0.458974
0.8046 --- loss: 1.623304, loss_ss: 1.168079, loss_d: 0.455225
0.8429 --- loss: 1.414416, loss_ss: 1.208391, loss_d: 0.206026
0.8812 --- loss: 2.024504, loss_ss: 1.286561, loss_d: 0.737943
0.9195 --- loss: 1.922340, loss_ss: 1.135783, loss_d: 0.786557
0.9579 --- loss: 1.264273, loss_ss: 1.177721, loss_d: 0.086552
0.9962 --- loss: 1.439138, loss_ss: 1.077184, loss_d: 0.361954
Epoch finished! Loss: 1.9081011400772976
Starting epoch 2/10.
0.0000 --- loss: 1.362246, loss_ss: 1.147345, loss_d: 0.214901
0.0383 --- loss: 1.546774, loss_ss: 1.133387, loss_d: 0.413387
0.0766 --- loss: 1.393605, loss_ss: 1.138262, loss_d: 0.255342
0.1149 --- loss: 1.623099, loss_ss: 1.038776, loss_d: 0.584323
0.1533 --- loss: 1.025444, loss_ss: 0.939035, loss_d: 0.086409
0.1916 --- loss: 1.270964, loss_ss: 0.947756, loss_d: 0.323208
0.2299 --- loss: 2.038363, loss_ss: 1.174045, loss_d: 0.864318
0.2682 --- loss: 1.861365, loss_ss: 1.307431, loss_d: 0.553934
0.3065 --- loss: 1.659272, loss_ss: 1.206499, loss_d: 0.452774
0.3448 --- loss: 1.333846, loss_ss: 1.130201, loss_d: 0.203644
0.3831 --- loss: 1.502736, loss_ss: 1.176549, loss_d: 0.326187
0.4215 --- loss: 1.491085, loss_ss: 1.364338, loss_d: 0.126747
0.4598 --- loss: 1.216526, loss_ss: 1.057212, loss_d: 0.159314
0.4981 --- loss: 1.253565, loss_ss: 0.926966, loss_d: 0.326600
0.5364 --- loss: 1.188249, loss_ss: 0.973292, loss_d: 0.214956
0.5747 --- loss: 1.521827, loss_ss: 1.051168, loss_d: 0.470659
0.6130 --- loss: 1.330098, loss_ss: 1.130918, loss_d: 0.199180
0.6513 --- loss: 1.493421, loss_ss: 1.298679, loss_d: 0.194742
0.6897 --- loss: 1.338104, loss_ss: 0.979413, loss_d: 0.358691
0.7280 --- loss: 1.110389, loss_ss: 0.925255, loss_d: 0.185134
0.7663 --- loss: 1.216517, loss_ss: 1.036476, loss_d: 0.180042
0.8046 --- loss: 1.561518, loss_ss: 1.034423, loss_d: 0.527095
0.8429 --- loss: 1.504977, loss_ss: 1.258929, loss_d: 0.246048
0.8812 --- loss: 1.787220, loss_ss: 1.263821, loss_d: 0.523399
0.9195 --- loss: 1.071354, loss_ss: 0.987145, loss_d: 0.084209
0.9579 --- loss: 1.793679, loss_ss: 1.326133, loss_d: 0.467546
0.9962 --- loss: 1.417494, loss_ss: 1.023150, loss_d: 0.394344
Epoch finished! Loss: 1.410119891166687
Starting epoch 3/10.
0.0000 --- loss: 1.271709, loss_ss: 0.874022, loss_d: 0.397688
0.0383 --- loss: 1.240672, loss_ss: 0.951969, loss_d: 0.288703
0.0766 --- loss: 1.500794, loss_ss: 1.285636, loss_d: 0.215159
0.1149 --- loss: 1.542953, loss_ss: 1.203007, loss_d: 0.339946
0.1533 --- loss: 1.024278, loss_ss: 0.937360, loss_d: 0.086918
0.1916 --- loss: 1.557088, loss_ss: 0.934436, loss_d: 0.622652
0.2299 --- loss: 1.792738, loss_ss: 0.890725, loss_d: 0.902012
0.2682 --- loss: 1.046221, loss_ss: 0.928985, loss_d: 0.117236
0.3065 --- loss: 1.533310, loss_ss: 1.157530, loss_d: 0.375781
0.3448 --- loss: 1.344862, loss_ss: 1.214424, loss_d: 0.130437
0.3831 --- loss: 1.469657, loss_ss: 0.955790, loss_d: 0.513867
0.4215 --- loss: 1.068704, loss_ss: 0.948975, loss_d: 0.119729
0.4598 --- loss: 1.167529, loss_ss: 1.105759, loss_d: 0.061769
0.4981 --- loss: 1.000646, loss_ss: 0.924373, loss_d: 0.076272
0.5364 --- loss: 1.089793, loss_ss: 0.968180, loss_d: 0.121614
0.5747 --- loss: 1.032561, loss_ss: 0.912372, loss_d: 0.120189
0.6130 --- loss: 1.127874, loss_ss: 1.035232, loss_d: 0.092642
0.6513 --- loss: 1.051967, loss_ss: 0.858253, loss_d: 0.193715
0.6897 --- loss: 1.157476, loss_ss: 0.906231, loss_d: 0.251245
0.7280 --- loss: 1.364497, loss_ss: 1.110677, loss_d: 0.253820
0.7663 --- loss: 1.134825, loss_ss: 0.927891, loss_d: 0.206933
0.8046 --- loss: 1.666048, loss_ss: 0.892379, loss_d: 0.773669
0.8429 --- loss: 1.277828, loss_ss: 0.865634, loss_d: 0.412194
0.8812 --- loss: 0.977266, loss_ss: 0.854795, loss_d: 0.122471
0.9195 --- loss: 0.948671, loss_ss: 0.815612, loss_d: 0.133059
0.9579 --- loss: 1.118836, loss_ss: 0.991912, loss_d: 0.126924
0.9962 --- loss: 2.016429, loss_ss: 1.209564, loss_d: 0.806865
Epoch finished! Loss: 1.2715210919196789
Starting epoch 4/10.
0.0000 --- loss: 0.991057, loss_ss: 0.932078, loss_d: 0.058980
0.0383 --- loss: 1.448051, loss_ss: 1.078689, loss_d: 0.369362
0.0766 --- loss: 1.273082, loss_ss: 1.165619, loss_d: 0.107463
0.1149 --- loss: 0.995239, loss_ss: 0.911784, loss_d: 0.083456
0.1533 --- loss: 1.335159, loss_ss: 0.977056, loss_d: 0.358103
0.1916 --- loss: 1.083715, loss_ss: 0.977821, loss_d: 0.105895
0.2299 --- loss: 1.135919, loss_ss: 0.826754, loss_d: 0.309164
0.2682 --- loss: 0.923989, loss_ss: 0.778259, loss_d: 0.145731
0.3065 --- loss: 0.906961, loss_ss: 0.883298, loss_d: 0.023663
0.3448 --- loss: 1.007102, loss_ss: 0.889697, loss_d: 0.117405
0.3831 --- loss: 1.143535, loss_ss: 0.849169, loss_d: 0.294367
0.4215 --- loss: 1.059719, loss_ss: 1.021080, loss_d: 0.038639
0.4598 --- loss: 1.030081, loss_ss: 0.888991, loss_d: 0.141090
0.4981 --- loss: 1.129261, loss_ss: 1.058925, loss_d: 0.070336
0.5364 --- loss: 0.863016, loss_ss: 0.753588, loss_d: 0.109428
0.5747 --- loss: 0.822217, loss_ss: 0.783372, loss_d: 0.038845
0.6130 --- loss: 1.151646, loss_ss: 0.807834, loss_d: 0.343812
0.6513 --- loss: 1.119085, loss_ss: 0.716181, loss_d: 0.402903
0.6897 --- loss: 0.908886, loss_ss: 0.852720, loss_d: 0.056166
0.7280 --- loss: 1.140892, loss_ss: 0.927513, loss_d: 0.213380
0.7663 --- loss: 1.149584, loss_ss: 1.028703, loss_d: 0.120881
0.8046 --- loss: 0.856596, loss_ss: 0.760810, loss_d: 0.095786
0.8429 --- loss: 1.036206, loss_ss: 0.965194, loss_d: 0.071012
0.8812 --- loss: 1.241418, loss_ss: 0.907652, loss_d: 0.333766
0.9195 --- loss: 0.892070, loss_ss: 0.865018, loss_d: 0.027053
0.9579 --- loss: 1.300685, loss_ss: 0.843445, loss_d: 0.457240
0.9962 --- loss: 1.020770, loss_ss: 0.967139, loss_d: 0.053631
Epoch finished! Loss: 1.142921547477062
Starting epoch 5/10.
0.0000 --- loss: 1.056911, loss_ss: 0.916877, loss_d: 0.140034
0.0383 --- loss: 0.945891, loss_ss: 0.914511, loss_d: 0.031380
0.0766 --- loss: 0.921703, loss_ss: 0.903223, loss_d: 0.018480
0.1149 --- loss: 0.782170, loss_ss: 0.772861, loss_d: 0.009308
0.1533 --- loss: 1.096121, loss_ss: 0.939225, loss_d: 0.156896
0.1916 --- loss: 1.219496, loss_ss: 0.948854, loss_d: 0.270642
0.2299 --- loss: 1.320849, loss_ss: 1.297520, loss_d: 0.023329
0.2682 --- loss: 0.937399, loss_ss: 0.760590, loss_d: 0.176809
0.3065 --- loss: 1.001199, loss_ss: 0.810470, loss_d: 0.190730
0.3448 --- loss: 0.738030, loss_ss: 0.697228, loss_d: 0.040802
0.3831 --- loss: 0.986781, loss_ss: 0.932874, loss_d: 0.053907
0.4215 --- loss: 1.386631, loss_ss: 0.712147, loss_d: 0.674484
0.4598 --- loss: 0.817830, loss_ss: 0.745313, loss_d: 0.072517
0.4981 --- loss: 1.012516, loss_ss: 0.862626, loss_d: 0.149891
0.5364 --- loss: 0.933808, loss_ss: 0.872556, loss_d: 0.061252
0.5747 --- loss: 0.802644, loss_ss: 0.722704, loss_d: 0.079940
0.6130 --- loss: 0.856040, loss_ss: 0.765275, loss_d: 0.090765
0.6513 --- loss: 0.961463, loss_ss: 0.894452, loss_d: 0.067011
0.6897 --- loss: 1.041300, loss_ss: 0.827570, loss_d: 0.213729
0.7280 --- loss: 0.887057, loss_ss: 0.851459, loss_d: 0.035598
0.7663 --- loss: 1.265674, loss_ss: 0.720176, loss_d: 0.545497
0.8046 --- loss: 1.175125, loss_ss: 1.085527, loss_d: 0.089598
0.8429 --- loss: 0.874916, loss_ss: 0.798385, loss_d: 0.076530
0.8812 --- loss: 1.053101, loss_ss: 0.800858, loss_d: 0.252243
0.9195 --- loss: 1.140140, loss_ss: 0.879229, loss_d: 0.260911
0.9579 --- loss: 0.917133, loss_ss: 0.818920, loss_d: 0.098213
0.9962 --- loss: 1.038205, loss_ss: 0.855414, loss_d: 0.182791
Epoch finished! Loss: 1.0577730169663062
Starting epoch 6/10.
0.0000 --- loss: 0.873012, loss_ss: 0.778969, loss_d: 0.094043
0.0383 --- loss: 0.748330, loss_ss: 0.632163, loss_d: 0.116166
0.0766 --- loss: 0.718250, loss_ss: 0.688198, loss_d: 0.030052
0.1149 --- loss: 1.452487, loss_ss: 1.058203, loss_d: 0.394284
0.1533 --- loss: 1.057729, loss_ss: 1.035582, loss_d: 0.022146
0.1916 --- loss: 0.800394, loss_ss: 0.758860, loss_d: 0.041534
0.2299 --- loss: 0.977710, loss_ss: 0.802853, loss_d: 0.174857
0.2682 --- loss: 1.357481, loss_ss: 1.310563, loss_d: 0.046918
0.3065 --- loss: 1.017316, loss_ss: 0.897922, loss_d: 0.119395
0.3448 --- loss: 1.189419, loss_ss: 1.119789, loss_d: 0.069630
0.3831 --- loss: 0.878191, loss_ss: 0.860410, loss_d: 0.017780
0.4215 --- loss: 1.317964, loss_ss: 1.289557, loss_d: 0.028406
0.4598 --- loss: 1.114197, loss_ss: 1.048491, loss_d: 0.065706
0.4981 --- loss: 1.069268, loss_ss: 1.036397, loss_d: 0.032870
0.5364 --- loss: 1.025870, loss_ss: 0.993856, loss_d: 0.032014
0.5747 --- loss: 0.758955, loss_ss: 0.725178, loss_d: 0.033777
0.6130 --- loss: 1.357322, loss_ss: 0.876463, loss_d: 0.480860
0.6513 --- loss: 0.919725, loss_ss: 0.901068, loss_d: 0.018657
0.6897 --- loss: 0.939467, loss_ss: 0.918453, loss_d: 0.021014
0.7280 --- loss: 0.878184, loss_ss: 0.829563, loss_d: 0.048621
0.7663 --- loss: 0.734020, loss_ss: 0.674916, loss_d: 0.059104
0.8046 --- loss: 1.206066, loss_ss: 0.860152, loss_d: 0.345914
0.8429 --- loss: 0.939672, loss_ss: 0.918979, loss_d: 0.020693
0.8812 --- loss: 0.961918, loss_ss: 0.916128, loss_d: 0.045791
0.9195 --- loss: 1.003006, loss_ss: 0.997654, loss_d: 0.005352
0.9579 --- loss: 1.058468, loss_ss: 0.745964, loss_d: 0.312504
0.9962 --- loss: 0.939765, loss_ss: 0.932573, loss_d: 0.007192
Epoch finished! Loss: 1.0057539763358923
Starting epoch 7/10.
0.0000 --- loss: 0.772794, loss_ss: 0.736861, loss_d: 0.035933
0.0383 --- loss: 1.699044, loss_ss: 1.029315, loss_d: 0.669729
0.0766 --- loss: 0.940176, loss_ss: 0.901751, loss_d: 0.038426
0.1149 --- loss: 1.442972, loss_ss: 1.124511, loss_d: 0.318460
0.1533 --- loss: 0.917745, loss_ss: 0.792979, loss_d: 0.124766
0.1916 --- loss: 0.991075, loss_ss: 0.971716, loss_d: 0.019359
0.2299 --- loss: 1.001348, loss_ss: 0.764765, loss_d: 0.236584
0.2682 --- loss: 0.863089, loss_ss: 0.849026, loss_d: 0.014063
0.3065 --- loss: 0.773741, loss_ss: 0.711254, loss_d: 0.062487
0.3448 --- loss: 1.030434, loss_ss: 0.935129, loss_d: 0.095305
0.3831 --- loss: 1.194888, loss_ss: 0.905876, loss_d: 0.289012
0.4215 --- loss: 1.020863, loss_ss: 0.947309, loss_d: 0.073554
0.4598 --- loss: 1.016917, loss_ss: 0.789962, loss_d: 0.226955
0.4981 --- loss: 1.156819, loss_ss: 0.808953, loss_d: 0.347866
0.5364 --- loss: 0.742988, loss_ss: 0.641724, loss_d: 0.101265
0.5747 --- loss: 0.868314, loss_ss: 0.699704, loss_d: 0.168610
0.6130 --- loss: 0.959641, loss_ss: 0.944670, loss_d: 0.014970
0.6513 --- loss: 0.891167, loss_ss: 0.797206, loss_d: 0.093961
0.6897 --- loss: 1.321181, loss_ss: 1.210165, loss_d: 0.111016
0.7280 --- loss: 0.677574, loss_ss: 0.640332, loss_d: 0.037242
0.7663 --- loss: 1.352363, loss_ss: 1.014346, loss_d: 0.338017
0.8046 --- loss: 1.321999, loss_ss: 1.034036, loss_d: 0.287963
0.8429 --- loss: 0.738754, loss_ss: 0.677796, loss_d: 0.060958
0.8812 --- loss: 0.786545, loss_ss: 0.675117, loss_d: 0.111428
0.9195 --- loss: 0.847116, loss_ss: 0.667320, loss_d: 0.179796
0.9579 --- loss: 1.016301, loss_ss: 1.002136, loss_d: 0.014164
0.9962 --- loss: 0.803949, loss_ss: 0.748571, loss_d: 0.055378
Epoch finished! Loss: 1.0047876963248619
Starting epoch 8/10.
0.0000 --- loss: 0.680117, loss_ss: 0.672343, loss_d: 0.007774
0.0383 --- loss: 0.618550, loss_ss: 0.589296, loss_d: 0.029253
0.0766 --- loss: 1.245584, loss_ss: 0.889529, loss_d: 0.356054
0.1149 --- loss: 1.062136, loss_ss: 0.939696, loss_d: 0.122440
0.1533 --- loss: 0.833442, loss_ss: 0.629834, loss_d: 0.203608
0.1916 --- loss: 0.890942, loss_ss: 0.886606, loss_d: 0.004337
0.2299 --- loss: 0.782968, loss_ss: 0.664666, loss_d: 0.118302
0.2682 --- loss: 1.073228, loss_ss: 0.865278, loss_d: 0.207950
0.3065 --- loss: 0.643529, loss_ss: 0.623459, loss_d: 0.020070
0.3448 --- loss: 0.971897, loss_ss: 0.860726, loss_d: 0.111172
0.3831 --- loss: 1.271607, loss_ss: 0.850884, loss_d: 0.420723
0.4215 --- loss: 1.037397, loss_ss: 0.986551, loss_d: 0.050845
0.4598 --- loss: 0.929635, loss_ss: 0.882704, loss_d: 0.046931
0.4981 --- loss: 0.625436, loss_ss: 0.612187, loss_d: 0.013249
0.5364 --- loss: 0.898246, loss_ss: 0.879675, loss_d: 0.018572
0.5747 --- loss: 0.954455, loss_ss: 0.824938, loss_d: 0.129517
0.6130 --- loss: 1.007339, loss_ss: 0.802796, loss_d: 0.204544
0.6513 --- loss: 0.805231, loss_ss: 0.659171, loss_d: 0.146060
0.6897 --- loss: 1.284087, loss_ss: 1.098510, loss_d: 0.185577
0.7280 --- loss: 0.813905, loss_ss: 0.780495, loss_d: 0.033410
0.7663 --- loss: 0.968167, loss_ss: 0.953569, loss_d: 0.014598
0.8046 --- loss: 0.819083, loss_ss: 0.813493, loss_d: 0.005591
0.8429 --- loss: 0.629466, loss_ss: 0.582738, loss_d: 0.046728
0.8812 --- loss: 1.112948, loss_ss: 1.076700, loss_d: 0.036248
0.9195 --- loss: 0.804697, loss_ss: 0.798537, loss_d: 0.006159
0.9579 --- loss: 0.917920, loss_ss: 0.907190, loss_d: 0.010729
0.9962 --- loss: 0.773619, loss_ss: 0.647722, loss_d: 0.125898
Epoch finished! Loss: 0.9005040536706265
Starting epoch 9/10.
0.0000 --- loss: 0.636227, loss_ss: 0.609116, loss_d: 0.027112
0.0383 --- loss: 1.190774, loss_ss: 1.183339, loss_d: 0.007435
0.0766 --- loss: 0.772445, loss_ss: 0.706845, loss_d: 0.065600
0.1149 --- loss: 0.989545, loss_ss: 0.944992, loss_d: 0.044553
0.1533 --- loss: 0.825068, loss_ss: 0.799012, loss_d: 0.026056
0.1916 --- loss: 0.833706, loss_ss: 0.763634, loss_d: 0.070072
0.2299 --- loss: 0.840161, loss_ss: 0.770746, loss_d: 0.069415
0.2682 --- loss: 0.637115, loss_ss: 0.558232, loss_d: 0.078883
0.3065 --- loss: 0.883619, loss_ss: 0.688576, loss_d: 0.195043
0.3448 --- loss: 0.905693, loss_ss: 0.849659, loss_d: 0.056034
0.3831 --- loss: 0.996393, loss_ss: 0.933315, loss_d: 0.063078
0.4215 --- loss: 0.734199, loss_ss: 0.698665, loss_d: 0.035534
0.4598 --- loss: 0.838784, loss_ss: 0.836092, loss_d: 0.002692
0.4981 --- loss: 0.829759, loss_ss: 0.819854, loss_d: 0.009904
0.5364 --- loss: 0.696575, loss_ss: 0.678292, loss_d: 0.018282
0.5747 --- loss: 0.805957, loss_ss: 0.802790, loss_d: 0.003167
0.6130 --- loss: 0.774896, loss_ss: 0.771048, loss_d: 0.003849
0.6513 --- loss: 0.627973, loss_ss: 0.622759, loss_d: 0.005214
0.6897 --- loss: 0.917061, loss_ss: 0.874302, loss_d: 0.042759
0.7280 --- loss: 0.709195, loss_ss: 0.641548, loss_d: 0.067647
0.7663 --- loss: 1.822098, loss_ss: 0.648407, loss_d: 1.173691
0.8046 --- loss: 0.931736, loss_ss: 0.894399, loss_d: 0.037337
0.8429 --- loss: 0.631185, loss_ss: 0.622980, loss_d: 0.008206
0.8812 --- loss: 0.550880, loss_ss: 0.523321, loss_d: 0.027559
0.9195 --- loss: 0.915417, loss_ss: 0.896149, loss_d: 0.019268
0.9579 --- loss: 0.500242, loss_ss: 0.494191, loss_d: 0.006051
0.9962 --- loss: 0.870220, loss_ss: 0.714257, loss_d: 0.155963
Epoch finished! Loss: 0.8694842852078951
Starting epoch 10/10.
0.0000 --- loss: 0.786003, loss_ss: 0.776300, loss_d: 0.009703
0.0383 --- loss: 0.704374, loss_ss: 0.703138, loss_d: 0.001237
0.0766 --- loss: 1.275484, loss_ss: 0.826481, loss_d: 0.449003
0.1149 --- loss: 0.574855, loss_ss: 0.557113, loss_d: 0.017742
0.1533 --- loss: 0.758017, loss_ss: 0.755259, loss_d: 0.002758
0.1916 --- loss: 0.663835, loss_ss: 0.603636, loss_d: 0.060199
0.2299 --- loss: 0.583100, loss_ss: 0.579667, loss_d: 0.003433
0.2682 --- loss: 0.769080, loss_ss: 0.697855, loss_d: 0.071225
0.3065 --- loss: 0.940576, loss_ss: 0.890816, loss_d: 0.049760
0.3448 --- loss: 0.731651, loss_ss: 0.711172, loss_d: 0.020480
0.3831 --- loss: 0.719838, loss_ss: 0.687614, loss_d: 0.032224
0.4215 --- loss: 0.586017, loss_ss: 0.581466, loss_d: 0.004551
0.4598 --- loss: 0.811859, loss_ss: 0.803171, loss_d: 0.008687
0.4981 --- loss: 0.730684, loss_ss: 0.728767, loss_d: 0.001918
0.5364 --- loss: 1.111428, loss_ss: 0.756172, loss_d: 0.355256
0.5747 --- loss: 0.825296, loss_ss: 0.776485, loss_d: 0.048812
0.6130 --- loss: 0.716786, loss_ss: 0.700385, loss_d: 0.016401
0.6513 --- loss: 1.226529, loss_ss: 0.557514, loss_d: 0.669015
0.6897 --- loss: 0.661977, loss_ss: 0.646499, loss_d: 0.015478
0.7280 --- loss: 0.904998, loss_ss: 0.879256, loss_d: 0.025742
0.7663 --- loss: 0.564479, loss_ss: 0.533797, loss_d: 0.030682
0.8046 --- loss: 0.791864, loss_ss: 0.784078, loss_d: 0.007787
0.8429 --- loss: 0.842902, loss_ss: 0.795969, loss_d: 0.046933
0.8812 --- loss: 1.031650, loss_ss: 1.009680, loss_d: 0.021969
0.9195 --- loss: 0.965047, loss_ss: 0.958589, loss_d: 0.006458
0.9579 --- loss: 0.924438, loss_ss: 0.919413, loss_d: 0.005025
0.9962 --- loss: 0.943366, loss_ss: 0.926809, loss_d: 0.016556
Epoch finished! Loss: 0.8500258376965156
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7654761904761904
             precision    recall  f1-score   support

        0.0       0.86      0.98      0.91       123
        1.0       0.51      0.58      0.54        43
        2.0       0.80      0.90      0.85       400
        3.0       1.00      0.31      0.47       193
        4.0       0.56      0.99      0.71        81

avg / total       0.82      0.77      0.74       840
 


====== chc010-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.26  97.56   97.21   85.71     91.25
1  95.00  58.14   96.99   51.02     54.35
2  84.40  89.50   79.77   80.09     84.53
3  84.17  31.09  100.00  100.00     47.43
4  92.26  98.77   91.57   55.56     71.11
Total accuracy: 76.55%
Average sen: 75.01%
Average spec: 93.11%
Macro f1-score: 69.74%
Diagnosis acc on 15mins: 0.7857142857142857
[1.38011668e-03 5.56937302e-04 7.83143818e-01 8.99302773e-03
 4.51763831e-02 3.51619325e-03 1.46713806e-02 2.76439577e-01
 3.53023022e-01 1.92524835e-01 8.95293474e-01 6.20822273e-02
 4.70092654e-01 1.17604516e-01 9.70711466e-03 9.66364145e-01
 8.73515248e-01 2.65461653e-01 8.61401036e-02 9.46000963e-02
 2.46296778e-01 6.46996439e-01 8.28140914e-01 1.38362367e-02
 1.70588549e-02 1.93784181e-02 6.91259652e-02 2.59711538e-02]
pred: 0.26382468879039933, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.554580, loss_ss: 1.761289, loss_d: 0.793292
0.0383 --- loss: 2.058629, loss_ss: 1.494285, loss_d: 0.564344
0.0767 --- loss: 2.104852, loss_ss: 1.572477, loss_d: 0.532375
0.1150 --- loss: 2.098040, loss_ss: 1.474581, loss_d: 0.623459
0.1534 --- loss: 2.232164, loss_ss: 1.521543, loss_d: 0.710621
0.1917 --- loss: 2.228459, loss_ss: 1.562439, loss_d: 0.666020
0.2301 --- loss: 2.023262, loss_ss: 1.385867, loss_d: 0.637395
0.2684 --- loss: 2.073265, loss_ss: 1.411596, loss_d: 0.661669
0.3067 --- loss: 1.918774, loss_ss: 1.398829, loss_d: 0.519946
0.3451 --- loss: 1.886393, loss_ss: 1.473591, loss_d: 0.412802
0.3834 --- loss: 2.356146, loss_ss: 1.353576, loss_d: 1.002570
0.4218 --- loss: 1.923945, loss_ss: 1.337117, loss_d: 0.586828
0.4601 --- loss: 1.929324, loss_ss: 1.279728, loss_d: 0.649596
0.4985 --- loss: 2.209193, loss_ss: 1.353360, loss_d: 0.855833
0.5368 --- loss: 1.688716, loss_ss: 1.310093, loss_d: 0.378623
0.5752 --- loss: 1.745280, loss_ss: 1.245952, loss_d: 0.499328
0.6135 --- loss: 1.717096, loss_ss: 1.339842, loss_d: 0.377255
0.6518 --- loss: 1.692650, loss_ss: 1.320696, loss_d: 0.371954
0.6902 --- loss: 2.215998, loss_ss: 1.157733, loss_d: 1.058265
0.7285 --- loss: 1.305005, loss_ss: 1.073200, loss_d: 0.231804
0.7669 --- loss: 1.399621, loss_ss: 1.170599, loss_d: 0.229023
0.8052 --- loss: 1.726302, loss_ss: 1.418746, loss_d: 0.307556
0.8436 --- loss: 1.523725, loss_ss: 1.283181, loss_d: 0.240545
0.8819 --- loss: 1.544849, loss_ss: 1.257610, loss_d: 0.287239
0.9202 --- loss: 1.467399, loss_ss: 1.177454, loss_d: 0.289945
0.9586 --- loss: 1.310281, loss_ss: 0.991056, loss_d: 0.319225
0.9969 --- loss: 1.349220, loss_ss: 1.188259, loss_d: 0.160961
Epoch finished! Loss: 1.8652914675382468
Starting epoch 2/10.
0.0000 --- loss: 1.428216, loss_ss: 1.297789, loss_d: 0.130427
0.0383 --- loss: 1.541627, loss_ss: 1.058390, loss_d: 0.483237
0.0767 --- loss: 1.208975, loss_ss: 1.141037, loss_d: 0.067938
0.1150 --- loss: 1.331808, loss_ss: 1.078055, loss_d: 0.253754
0.1534 --- loss: 1.413870, loss_ss: 1.022737, loss_d: 0.391133
0.1917 --- loss: 1.481937, loss_ss: 1.192898, loss_d: 0.289039
0.2301 --- loss: 1.455065, loss_ss: 1.006037, loss_d: 0.449028
0.2684 --- loss: 1.611514, loss_ss: 1.144148, loss_d: 0.467366
0.3067 --- loss: 1.461269, loss_ss: 1.352521, loss_d: 0.108748
0.3451 --- loss: 1.308787, loss_ss: 0.991160, loss_d: 0.317626
0.3834 --- loss: 1.167710, loss_ss: 1.049879, loss_d: 0.117831
0.4218 --- loss: 1.383059, loss_ss: 1.081229, loss_d: 0.301829
0.4601 --- loss: 1.382320, loss_ss: 1.104797, loss_d: 0.277523
0.4985 --- loss: 1.257386, loss_ss: 1.123243, loss_d: 0.134143
0.5368 --- loss: 1.463729, loss_ss: 1.183527, loss_d: 0.280201
0.5752 --- loss: 1.484024, loss_ss: 1.067963, loss_d: 0.416060
0.6135 --- loss: 1.588970, loss_ss: 1.227302, loss_d: 0.361668
0.6518 --- loss: 1.421950, loss_ss: 1.059861, loss_d: 0.362089
0.6902 --- loss: 1.358185, loss_ss: 0.937865, loss_d: 0.420320
0.7285 --- loss: 1.572048, loss_ss: 1.103250, loss_d: 0.468798
0.7669 --- loss: 2.060484, loss_ss: 1.454062, loss_d: 0.606423
0.8052 --- loss: 1.156130, loss_ss: 0.925749, loss_d: 0.230381
0.8436 --- loss: 1.377763, loss_ss: 0.968138, loss_d: 0.409625
0.8819 --- loss: 1.102003, loss_ss: 1.018056, loss_d: 0.083946
0.9202 --- loss: 1.242046, loss_ss: 1.042317, loss_d: 0.199729
0.9586 --- loss: 0.968886, loss_ss: 0.908795, loss_d: 0.060091
0.9969 --- loss: 1.626049, loss_ss: 1.135522, loss_d: 0.490527
Epoch finished! Loss: 1.3769349329746687
Starting epoch 3/10.
0.0000 --- loss: 1.442518, loss_ss: 0.949673, loss_d: 0.492845
0.0383 --- loss: 0.918234, loss_ss: 0.842378, loss_d: 0.075856
0.0767 --- loss: 1.033514, loss_ss: 0.946168, loss_d: 0.087346
0.1150 --- loss: 0.864802, loss_ss: 0.746582, loss_d: 0.118220
0.1534 --- loss: 1.353101, loss_ss: 1.097905, loss_d: 0.255197
0.1917 --- loss: 1.011109, loss_ss: 0.944005, loss_d: 0.067104
0.2301 --- loss: 0.848336, loss_ss: 0.760773, loss_d: 0.087563
0.2684 --- loss: 1.143830, loss_ss: 1.043460, loss_d: 0.100371
0.3067 --- loss: 0.983877, loss_ss: 0.891546, loss_d: 0.092330
0.3451 --- loss: 1.120818, loss_ss: 0.914056, loss_d: 0.206762
0.3834 --- loss: 1.251797, loss_ss: 0.942689, loss_d: 0.309108
0.4218 --- loss: 0.931494, loss_ss: 0.822063, loss_d: 0.109431
0.4601 --- loss: 1.797868, loss_ss: 0.806011, loss_d: 0.991856
0.4985 --- loss: 1.101831, loss_ss: 1.018865, loss_d: 0.082966
0.5368 --- loss: 1.415751, loss_ss: 1.030734, loss_d: 0.385016
0.5752 --- loss: 1.108197, loss_ss: 0.845966, loss_d: 0.262231
0.6135 --- loss: 0.896551, loss_ss: 0.831390, loss_d: 0.065161
0.6518 --- loss: 1.027938, loss_ss: 0.990092, loss_d: 0.037846
0.6902 --- loss: 1.140368, loss_ss: 0.988833, loss_d: 0.151535
0.7285 --- loss: 0.742344, loss_ss: 0.591812, loss_d: 0.150533
0.7669 --- loss: 0.791382, loss_ss: 0.770686, loss_d: 0.020696
0.8052 --- loss: 1.101373, loss_ss: 1.016746, loss_d: 0.084627
0.8436 --- loss: 1.411206, loss_ss: 1.105116, loss_d: 0.306090
0.8819 --- loss: 0.951823, loss_ss: 0.861539, loss_d: 0.090284
0.9202 --- loss: 0.962845, loss_ss: 0.866229, loss_d: 0.096616
0.9586 --- loss: 1.015870, loss_ss: 0.933749, loss_d: 0.082121
0.9969 --- loss: 1.426607, loss_ss: 0.701686, loss_d: 0.724921
Epoch finished! Loss: 1.1435649523368248
Starting epoch 4/10.
0.0000 --- loss: 1.369106, loss_ss: 1.316273, loss_d: 0.052833
0.0383 --- loss: 1.133259, loss_ss: 0.810374, loss_d: 0.322885
0.0767 --- loss: 1.156779, loss_ss: 1.084313, loss_d: 0.072466
0.1150 --- loss: 1.212164, loss_ss: 0.911638, loss_d: 0.300526
0.1534 --- loss: 0.771613, loss_ss: 0.686084, loss_d: 0.085529
0.1917 --- loss: 1.000448, loss_ss: 0.801381, loss_d: 0.199067
0.2301 --- loss: 0.876257, loss_ss: 0.778252, loss_d: 0.098005
0.2684 --- loss: 0.826542, loss_ss: 0.739648, loss_d: 0.086894
0.3067 --- loss: 0.923122, loss_ss: 0.786420, loss_d: 0.136702
0.3451 --- loss: 1.037735, loss_ss: 0.974786, loss_d: 0.062949
0.3834 --- loss: 1.132296, loss_ss: 1.045552, loss_d: 0.086744
0.4218 --- loss: 1.155893, loss_ss: 0.692861, loss_d: 0.463032
0.4601 --- loss: 0.882573, loss_ss: 0.847168, loss_d: 0.035406
0.4985 --- loss: 1.432682, loss_ss: 1.145015, loss_d: 0.287667
0.5368 --- loss: 1.435095, loss_ss: 0.791753, loss_d: 0.643343
0.5752 --- loss: 1.223066, loss_ss: 0.862302, loss_d: 0.360764
0.6135 --- loss: 0.827766, loss_ss: 0.787106, loss_d: 0.040660
0.6518 --- loss: 0.895544, loss_ss: 0.763602, loss_d: 0.131941
0.6902 --- loss: 0.906018, loss_ss: 0.832469, loss_d: 0.073549
0.7285 --- loss: 1.364855, loss_ss: 0.844683, loss_d: 0.520172
0.7669 --- loss: 0.954944, loss_ss: 0.878283, loss_d: 0.076661
0.8052 --- loss: 0.778801, loss_ss: 0.732269, loss_d: 0.046532
0.8436 --- loss: 0.828135, loss_ss: 0.744718, loss_d: 0.083417
0.8819 --- loss: 0.853612, loss_ss: 0.826214, loss_d: 0.027398
0.9202 --- loss: 1.161579, loss_ss: 1.003893, loss_d: 0.157686
0.9586 --- loss: 0.848659, loss_ss: 0.835103, loss_d: 0.013556
0.9969 --- loss: 1.022165, loss_ss: 0.918231, loss_d: 0.103934
Epoch finished! Loss: 1.049829428241803
Starting epoch 5/10.
0.0000 --- loss: 1.205949, loss_ss: 0.767888, loss_d: 0.438062
0.0383 --- loss: 1.376608, loss_ss: 1.258748, loss_d: 0.117861
0.0767 --- loss: 0.977733, loss_ss: 0.966709, loss_d: 0.011024
0.1150 --- loss: 0.896381, loss_ss: 0.724551, loss_d: 0.171830
0.1534 --- loss: 0.871886, loss_ss: 0.719586, loss_d: 0.152300
0.1917 --- loss: 0.762682, loss_ss: 0.566813, loss_d: 0.195869
0.2301 --- loss: 1.119639, loss_ss: 0.646019, loss_d: 0.473620
0.2684 --- loss: 0.982032, loss_ss: 0.924971, loss_d: 0.057060
0.3067 --- loss: 0.853772, loss_ss: 0.786287, loss_d: 0.067485
0.3451 --- loss: 0.680140, loss_ss: 0.663555, loss_d: 0.016585
0.3834 --- loss: 1.087051, loss_ss: 0.671628, loss_d: 0.415423
0.4218 --- loss: 0.841744, loss_ss: 0.705870, loss_d: 0.135874
0.4601 --- loss: 0.916901, loss_ss: 0.895158, loss_d: 0.021742
0.4985 --- loss: 1.002337, loss_ss: 0.959701, loss_d: 0.042637
0.5368 --- loss: 0.947607, loss_ss: 0.717013, loss_d: 0.230595
0.5752 --- loss: 0.778033, loss_ss: 0.701777, loss_d: 0.076256
0.6135 --- loss: 0.898796, loss_ss: 0.857010, loss_d: 0.041786
0.6518 --- loss: 0.713379, loss_ss: 0.650921, loss_d: 0.062458
0.6902 --- loss: 0.917041, loss_ss: 0.851520, loss_d: 0.065521
0.7285 --- loss: 0.756700, loss_ss: 0.734551, loss_d: 0.022149
0.7669 --- loss: 0.724183, loss_ss: 0.633484, loss_d: 0.090699
0.8052 --- loss: 0.799385, loss_ss: 0.769758, loss_d: 0.029628
0.8436 --- loss: 0.939170, loss_ss: 0.894497, loss_d: 0.044672
0.8819 --- loss: 0.828955, loss_ss: 0.778618, loss_d: 0.050336
0.9202 --- loss: 1.030829, loss_ss: 0.795748, loss_d: 0.235081
0.9586 --- loss: 0.840483, loss_ss: 0.828053, loss_d: 0.012430
0.9969 --- loss: 0.692656, loss_ss: 0.607210, loss_d: 0.085446
Epoch finished! Loss: 0.9698153337607017
Starting epoch 6/10.
0.0000 --- loss: 0.664686, loss_ss: 0.659260, loss_d: 0.005425
0.0383 --- loss: 0.999644, loss_ss: 0.990000, loss_d: 0.009644
0.0767 --- loss: 2.310126, loss_ss: 0.762337, loss_d: 1.547789
0.1150 --- loss: 0.916400, loss_ss: 0.811272, loss_d: 0.105128
0.1534 --- loss: 0.790040, loss_ss: 0.690886, loss_d: 0.099153
0.1917 --- loss: 0.906707, loss_ss: 0.778404, loss_d: 0.128303
0.2301 --- loss: 1.511755, loss_ss: 0.855783, loss_d: 0.655971
0.2684 --- loss: 0.871538, loss_ss: 0.814092, loss_d: 0.057446
0.3067 --- loss: 0.636830, loss_ss: 0.606826, loss_d: 0.030004
0.3451 --- loss: 1.212411, loss_ss: 0.828235, loss_d: 0.384176
0.3834 --- loss: 0.906097, loss_ss: 0.741199, loss_d: 0.164898
0.4218 --- loss: 1.003972, loss_ss: 0.811941, loss_d: 0.192031
0.4601 --- loss: 0.771034, loss_ss: 0.653927, loss_d: 0.117106
0.4985 --- loss: 0.993292, loss_ss: 0.974434, loss_d: 0.018858
0.5368 --- loss: 1.163306, loss_ss: 0.895300, loss_d: 0.268005
0.5752 --- loss: 0.516583, loss_ss: 0.465608, loss_d: 0.050975
0.6135 --- loss: 0.601330, loss_ss: 0.580255, loss_d: 0.021075
0.6518 --- loss: 1.320619, loss_ss: 1.055846, loss_d: 0.264774
0.6902 --- loss: 0.902488, loss_ss: 0.820277, loss_d: 0.082212
0.7285 --- loss: 0.936372, loss_ss: 0.901291, loss_d: 0.035081
0.7669 --- loss: 0.814024, loss_ss: 0.784701, loss_d: 0.029323
0.8052 --- loss: 1.097890, loss_ss: 1.084326, loss_d: 0.013564
0.8436 --- loss: 0.957981, loss_ss: 0.801537, loss_d: 0.156444
0.8819 --- loss: 0.902731, loss_ss: 0.885077, loss_d: 0.017654
0.9202 --- loss: 0.727450, loss_ss: 0.675296, loss_d: 0.052154
0.9586 --- loss: 0.986159, loss_ss: 0.917974, loss_d: 0.068185
0.9969 --- loss: 0.878944, loss_ss: 0.850064, loss_d: 0.028880
Epoch finished! Loss: 0.9480854876912557
Starting epoch 7/10.
0.0000 --- loss: 1.162163, loss_ss: 0.980178, loss_d: 0.181985
0.0383 --- loss: 0.855424, loss_ss: 0.735893, loss_d: 0.119531
0.0767 --- loss: 0.875766, loss_ss: 0.859457, loss_d: 0.016309
0.1150 --- loss: 0.728629, loss_ss: 0.692759, loss_d: 0.035870
0.1534 --- loss: 0.710229, loss_ss: 0.664378, loss_d: 0.045851
0.1917 --- loss: 0.751952, loss_ss: 0.734523, loss_d: 0.017429
0.2301 --- loss: 0.699299, loss_ss: 0.671806, loss_d: 0.027492
0.2684 --- loss: 0.756114, loss_ss: 0.687908, loss_d: 0.068206
0.3067 --- loss: 0.887807, loss_ss: 0.602223, loss_d: 0.285584
0.3451 --- loss: 0.893844, loss_ss: 0.671994, loss_d: 0.221850
0.3834 --- loss: 0.874395, loss_ss: 0.847453, loss_d: 0.026941
0.4218 --- loss: 1.036626, loss_ss: 1.028693, loss_d: 0.007933
0.4601 --- loss: 0.812053, loss_ss: 0.724455, loss_d: 0.087598
0.4985 --- loss: 0.630382, loss_ss: 0.515425, loss_d: 0.114957
0.5368 --- loss: 1.126796, loss_ss: 0.849413, loss_d: 0.277382
0.5752 --- loss: 1.129551, loss_ss: 1.077303, loss_d: 0.052248
0.6135 --- loss: 0.849979, loss_ss: 0.838564, loss_d: 0.011415
0.6518 --- loss: 0.593259, loss_ss: 0.591219, loss_d: 0.002040
0.6902 --- loss: 0.819008, loss_ss: 0.784011, loss_d: 0.034998
0.7285 --- loss: 0.659130, loss_ss: 0.610901, loss_d: 0.048229
0.7669 --- loss: 0.789739, loss_ss: 0.785374, loss_d: 0.004364
0.8052 --- loss: 1.006702, loss_ss: 1.005742, loss_d: 0.000960
0.8436 --- loss: 1.256602, loss_ss: 1.059912, loss_d: 0.196690
0.8819 --- loss: 0.873416, loss_ss: 0.812789, loss_d: 0.060627
0.9202 --- loss: 0.610210, loss_ss: 0.588890, loss_d: 0.021320
0.9586 --- loss: 0.996486, loss_ss: 0.987814, loss_d: 0.008672
0.9969 --- loss: 0.871000, loss_ss: 0.865754, loss_d: 0.005246
Epoch finished! Loss: 0.8828032240271568
Starting epoch 8/10.
0.0000 --- loss: 1.096547, loss_ss: 0.890517, loss_d: 0.206030
0.0383 --- loss: 0.769650, loss_ss: 0.753735, loss_d: 0.015915
0.0767 --- loss: 0.999777, loss_ss: 0.985115, loss_d: 0.014663
0.1150 --- loss: 0.689865, loss_ss: 0.670651, loss_d: 0.019215
0.1534 --- loss: 0.498017, loss_ss: 0.490847, loss_d: 0.007170
0.1917 --- loss: 0.748977, loss_ss: 0.718006, loss_d: 0.030971
0.2301 --- loss: 0.657432, loss_ss: 0.645831, loss_d: 0.011601
0.2684 --- loss: 0.978181, loss_ss: 0.883486, loss_d: 0.094695
0.3067 --- loss: 1.046059, loss_ss: 1.029881, loss_d: 0.016178
0.3451 --- loss: 1.072600, loss_ss: 1.032879, loss_d: 0.039720
0.3834 --- loss: 0.874621, loss_ss: 0.863007, loss_d: 0.011614
0.4218 --- loss: 0.725626, loss_ss: 0.715214, loss_d: 0.010412
0.4601 --- loss: 0.768038, loss_ss: 0.625343, loss_d: 0.142695
0.4985 --- loss: 1.277035, loss_ss: 1.077803, loss_d: 0.199233
0.5368 --- loss: 0.781738, loss_ss: 0.775806, loss_d: 0.005932
0.5752 --- loss: 0.929250, loss_ss: 0.775480, loss_d: 0.153770
0.6135 --- loss: 0.687329, loss_ss: 0.683074, loss_d: 0.004255
0.6518 --- loss: 0.495777, loss_ss: 0.490723, loss_d: 0.005054
0.6902 --- loss: 0.658662, loss_ss: 0.644805, loss_d: 0.013857
0.7285 --- loss: 0.723775, loss_ss: 0.717528, loss_d: 0.006247
0.7669 --- loss: 0.719185, loss_ss: 0.717548, loss_d: 0.001637
0.8052 --- loss: 1.040259, loss_ss: 1.016348, loss_d: 0.023911
0.8436 --- loss: 0.735098, loss_ss: 0.692589, loss_d: 0.042509
0.8819 --- loss: 0.908615, loss_ss: 0.709911, loss_d: 0.198704
0.9202 --- loss: 0.833257, loss_ss: 0.801326, loss_d: 0.031930
0.9586 --- loss: 0.770899, loss_ss: 0.765828, loss_d: 0.005071
0.9969 --- loss: 0.809342, loss_ss: 0.749454, loss_d: 0.059888
Epoch finished! Loss: 0.862845731813174
Starting epoch 9/10.
0.0000 --- loss: 0.624297, loss_ss: 0.619378, loss_d: 0.004919
0.0383 --- loss: 0.844569, loss_ss: 0.839087, loss_d: 0.005482
0.0767 --- loss: 0.853820, loss_ss: 0.848584, loss_d: 0.005236
0.1150 --- loss: 0.629895, loss_ss: 0.496825, loss_d: 0.133070
0.1534 --- loss: 0.943993, loss_ss: 0.850813, loss_d: 0.093180
0.1917 --- loss: 0.605410, loss_ss: 0.593741, loss_d: 0.011670
0.2301 --- loss: 1.303828, loss_ss: 0.715697, loss_d: 0.588130
0.2684 --- loss: 0.593954, loss_ss: 0.588884, loss_d: 0.005071
0.3067 --- loss: 0.839037, loss_ss: 0.831382, loss_d: 0.007655
0.3451 --- loss: 0.815980, loss_ss: 0.717345, loss_d: 0.098635
0.3834 --- loss: 0.903563, loss_ss: 0.837885, loss_d: 0.065679
0.4218 --- loss: 0.736027, loss_ss: 0.722788, loss_d: 0.013239
0.4601 --- loss: 0.728254, loss_ss: 0.667030, loss_d: 0.061224
0.4985 --- loss: 0.780377, loss_ss: 0.758024, loss_d: 0.022353
0.5368 --- loss: 2.108935, loss_ss: 0.862608, loss_d: 1.246326
0.5752 --- loss: 0.626641, loss_ss: 0.610233, loss_d: 0.016408
0.6135 --- loss: 1.096929, loss_ss: 1.003739, loss_d: 0.093191
0.6518 --- loss: 1.247109, loss_ss: 1.230840, loss_d: 0.016269
0.6902 --- loss: 0.954998, loss_ss: 0.903133, loss_d: 0.051866
0.7285 --- loss: 0.795355, loss_ss: 0.783735, loss_d: 0.011619
0.7669 --- loss: 0.818104, loss_ss: 0.806257, loss_d: 0.011847
0.8052 --- loss: 0.787855, loss_ss: 0.754671, loss_d: 0.033184
0.8436 --- loss: 0.768266, loss_ss: 0.759504, loss_d: 0.008762
0.8819 --- loss: 1.095262, loss_ss: 1.083203, loss_d: 0.012059
0.9202 --- loss: 0.724207, loss_ss: 0.723208, loss_d: 0.001000
0.9586 --- loss: 0.716108, loss_ss: 0.712192, loss_d: 0.003915
0.9969 --- loss: 1.180826, loss_ss: 0.544543, loss_d: 0.636283
Epoch finished! Loss: 0.8539934974450332
Starting epoch 10/10.
0.0000 --- loss: 0.610073, loss_ss: 0.601929, loss_d: 0.008145
0.0383 --- loss: 1.134884, loss_ss: 0.845632, loss_d: 0.289252
0.0767 --- loss: 0.600941, loss_ss: 0.538579, loss_d: 0.062362
0.1150 --- loss: 0.823464, loss_ss: 0.815576, loss_d: 0.007889
0.1534 --- loss: 0.929984, loss_ss: 0.793953, loss_d: 0.136031
0.1917 --- loss: 0.990197, loss_ss: 0.834411, loss_d: 0.155786
0.2301 --- loss: 0.953303, loss_ss: 0.931592, loss_d: 0.021711
0.2684 --- loss: 0.793762, loss_ss: 0.791961, loss_d: 0.001801
0.3067 --- loss: 0.983363, loss_ss: 0.835626, loss_d: 0.147737
0.3451 --- loss: 0.690758, loss_ss: 0.689041, loss_d: 0.001717
0.3834 --- loss: 0.720247, loss_ss: 0.714697, loss_d: 0.005551
0.4218 --- loss: 0.627977, loss_ss: 0.625154, loss_d: 0.002823
0.4601 --- loss: 0.776244, loss_ss: 0.761704, loss_d: 0.014540
0.4985 --- loss: 0.685152, loss_ss: 0.681788, loss_d: 0.003364
0.5368 --- loss: 0.684946, loss_ss: 0.654220, loss_d: 0.030725
0.5752 --- loss: 0.585763, loss_ss: 0.549754, loss_d: 0.036008
0.6135 --- loss: 0.617606, loss_ss: 0.606500, loss_d: 0.011106
0.6518 --- loss: 0.873455, loss_ss: 0.867506, loss_d: 0.005949
0.6902 --- loss: 0.775919, loss_ss: 0.772113, loss_d: 0.003806
0.7285 --- loss: 0.971870, loss_ss: 0.970441, loss_d: 0.001430
0.7669 --- loss: 0.561382, loss_ss: 0.555489, loss_d: 0.005894
0.8052 --- loss: 0.735936, loss_ss: 0.728225, loss_d: 0.007711
0.8436 --- loss: 0.537672, loss_ss: 0.536823, loss_d: 0.000849
0.8819 --- loss: 0.730609, loss_ss: 0.702590, loss_d: 0.028019
0.9202 --- loss: 0.917993, loss_ss: 0.916685, loss_d: 0.001308
0.9586 --- loss: 0.850514, loss_ss: 0.844827, loss_d: 0.005687
0.9969 --- loss: 0.923993, loss_ss: 0.641429, loss_d: 0.282564
Epoch finished! Loss: 0.7979907552783306
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8255555555555556
             precision    recall  f1-score   support

        0.0       0.83      0.90      0.86        63
        1.0       0.23      0.27      0.25        22
        2.0       0.85      0.91      0.88       541
        3.0       0.98      0.64      0.77       204
        4.0       0.62      0.81      0.70        70

avg / total       0.84      0.83      0.82       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.00  90.48   98.57  82.61     86.36
1  96.00  27.27   97.72  23.08     25.00
2  84.89  91.13   75.49  84.85     87.88
3  91.56  63.73   99.71  98.48     77.38
4  94.67  81.43   95.78  61.96     70.37
Total accuracy: 82.56%
Average sen: 70.81%
Average spec: 93.45%
Macro f1-score: 69.40%
Diagnosis acc on 15mins: 0.6333333333333333
[0.98421681 0.26396322 0.52517897 0.16698328 0.04809082 0.28322238
 0.80075449 0.43126446 0.96208006 0.04487645 0.15445045 0.04567502
 0.14473572 0.85220194 0.14476979 0.07129305 0.4785288  0.30782101
 0.99897921 0.44197381 0.09219615 0.69623542 0.75105739 0.59578586
 0.99936837 0.96381056 0.10412633 0.11842541 0.04273853 0.42288592]
pred: 0.43125632194181285, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.425969, loss_ss: 1.788125, loss_d: 0.637844
0.0384 --- loss: 2.390365, loss_ss: 1.748332, loss_d: 0.642033
0.0767 --- loss: 2.474883, loss_ss: 1.571113, loss_d: 0.903770
0.1151 --- loss: 1.676037, loss_ss: 1.442572, loss_d: 0.233465
0.1534 --- loss: 2.289210, loss_ss: 1.737716, loss_d: 0.551494
0.1918 --- loss: 2.214393, loss_ss: 1.576680, loss_d: 0.637713
0.2301 --- loss: 2.062784, loss_ss: 1.529421, loss_d: 0.533364
0.2685 --- loss: 2.205520, loss_ss: 1.528334, loss_d: 0.677186
0.3069 --- loss: 1.977075, loss_ss: 1.477474, loss_d: 0.499601
0.3452 --- loss: 2.119513, loss_ss: 1.370434, loss_d: 0.749079
0.3836 --- loss: 1.961116, loss_ss: 1.495877, loss_d: 0.465239
0.4219 --- loss: 2.363267, loss_ss: 1.475291, loss_d: 0.887976
0.4603 --- loss: 2.313484, loss_ss: 1.434717, loss_d: 0.878767
0.4987 --- loss: 1.869157, loss_ss: 1.366626, loss_d: 0.502530
0.5370 --- loss: 1.818446, loss_ss: 1.411239, loss_d: 0.407207
0.5754 --- loss: 1.780166, loss_ss: 1.388021, loss_d: 0.392145
0.6137 --- loss: 1.637623, loss_ss: 1.302047, loss_d: 0.335575
0.6521 --- loss: 1.630426, loss_ss: 1.267528, loss_d: 0.362898
0.6904 --- loss: 2.118695, loss_ss: 1.135100, loss_d: 0.983595
0.7288 --- loss: 1.764636, loss_ss: 1.246962, loss_d: 0.517674
0.7672 --- loss: 1.789424, loss_ss: 1.373877, loss_d: 0.415547
0.8055 --- loss: 1.564394, loss_ss: 1.265926, loss_d: 0.298467
0.8439 --- loss: 1.656506, loss_ss: 1.340151, loss_d: 0.316354
0.8822 --- loss: 2.210708, loss_ss: 1.358326, loss_d: 0.852382
0.9206 --- loss: 1.504836, loss_ss: 1.270606, loss_d: 0.234231
0.9590 --- loss: 1.420595, loss_ss: 1.203015, loss_d: 0.217580
0.9973 --- loss: 1.843353, loss_ss: 1.350389, loss_d: 0.492964
Epoch finished! Loss: 1.9453434311426603
Starting epoch 2/10.
0.0000 --- loss: 1.302029, loss_ss: 1.126839, loss_d: 0.175190
0.0384 --- loss: 1.650644, loss_ss: 1.275139, loss_d: 0.375504
0.0767 --- loss: 1.392116, loss_ss: 1.316382, loss_d: 0.075734
0.1151 --- loss: 1.464862, loss_ss: 1.158972, loss_d: 0.305890
0.1534 --- loss: 1.501351, loss_ss: 1.174145, loss_d: 0.327206
0.1918 --- loss: 1.254333, loss_ss: 1.132141, loss_d: 0.122191
0.2301 --- loss: 1.630340, loss_ss: 1.007147, loss_d: 0.623193
0.2685 --- loss: 1.404594, loss_ss: 1.266602, loss_d: 0.137993
0.3069 --- loss: 1.369578, loss_ss: 1.172397, loss_d: 0.197181
0.3452 --- loss: 1.430770, loss_ss: 1.111814, loss_d: 0.318957
0.3836 --- loss: 1.537111, loss_ss: 1.131697, loss_d: 0.405415
0.4219 --- loss: 1.586085, loss_ss: 1.132856, loss_d: 0.453229
0.4603 --- loss: 1.376725, loss_ss: 1.193827, loss_d: 0.182898
0.4987 --- loss: 1.332753, loss_ss: 1.091089, loss_d: 0.241664
0.5370 --- loss: 1.299338, loss_ss: 0.905158, loss_d: 0.394180
0.5754 --- loss: 1.528871, loss_ss: 1.139346, loss_d: 0.389525
0.6137 --- loss: 1.391503, loss_ss: 1.036184, loss_d: 0.355319
0.6521 --- loss: 1.447410, loss_ss: 0.970954, loss_d: 0.476456
0.6904 --- loss: 1.614326, loss_ss: 0.941017, loss_d: 0.673310
0.7288 --- loss: 1.389865, loss_ss: 1.160633, loss_d: 0.229232
0.7672 --- loss: 1.201883, loss_ss: 0.885009, loss_d: 0.316874
0.8055 --- loss: 1.182267, loss_ss: 1.045561, loss_d: 0.136706
0.8439 --- loss: 1.226887, loss_ss: 1.017422, loss_d: 0.209466
0.8822 --- loss: 1.100781, loss_ss: 0.887308, loss_d: 0.213473
0.9206 --- loss: 1.294049, loss_ss: 1.104055, loss_d: 0.189994
0.9590 --- loss: 1.330803, loss_ss: 1.036843, loss_d: 0.293959
0.9973 --- loss: 1.061791, loss_ss: 1.020756, loss_d: 0.041035
Epoch finished! Loss: 1.4038645874995452
Starting epoch 3/10.
0.0000 --- loss: 1.503531, loss_ss: 0.974051, loss_d: 0.529480
0.0384 --- loss: 1.288994, loss_ss: 0.979772, loss_d: 0.309222
0.0767 --- loss: 1.342384, loss_ss: 1.169144, loss_d: 0.173240
0.1151 --- loss: 0.891722, loss_ss: 0.826476, loss_d: 0.065247
0.1534 --- loss: 1.030095, loss_ss: 0.887459, loss_d: 0.142636
0.1918 --- loss: 1.276817, loss_ss: 1.068511, loss_d: 0.208306
0.2301 --- loss: 0.932486, loss_ss: 0.863132, loss_d: 0.069354
0.2685 --- loss: 1.321167, loss_ss: 0.800179, loss_d: 0.520987
0.3069 --- loss: 1.188483, loss_ss: 0.785686, loss_d: 0.402797
0.3452 --- loss: 1.123378, loss_ss: 1.058586, loss_d: 0.064792
0.3836 --- loss: 1.055041, loss_ss: 0.921213, loss_d: 0.133828
0.4219 --- loss: 1.148659, loss_ss: 0.653290, loss_d: 0.495369
0.4603 --- loss: 1.226077, loss_ss: 0.966585, loss_d: 0.259492
0.4987 --- loss: 1.420814, loss_ss: 0.852485, loss_d: 0.568329
0.5370 --- loss: 0.977291, loss_ss: 0.870195, loss_d: 0.107095
0.5754 --- loss: 1.097184, loss_ss: 1.053009, loss_d: 0.044175
0.6137 --- loss: 1.213942, loss_ss: 1.010704, loss_d: 0.203237
0.6521 --- loss: 1.376879, loss_ss: 1.260044, loss_d: 0.116835
0.6904 --- loss: 1.186053, loss_ss: 0.959617, loss_d: 0.226435
0.7288 --- loss: 1.083190, loss_ss: 0.876822, loss_d: 0.206368
0.7672 --- loss: 1.463114, loss_ss: 0.924462, loss_d: 0.538653
0.8055 --- loss: 0.991574, loss_ss: 0.759855, loss_d: 0.231720
0.8439 --- loss: 1.072879, loss_ss: 0.988100, loss_d: 0.084779
0.8822 --- loss: 0.890810, loss_ss: 0.842335, loss_d: 0.048476
0.9206 --- loss: 1.336946, loss_ss: 1.188334, loss_d: 0.148613
0.9590 --- loss: 1.139992, loss_ss: 0.942415, loss_d: 0.197577
0.9973 --- loss: 1.146353, loss_ss: 0.877130, loss_d: 0.269224
Epoch finished! Loss: 1.1839929855786837
Starting epoch 4/10.
0.0000 --- loss: 1.235173, loss_ss: 0.715985, loss_d: 0.519188
0.0384 --- loss: 1.074047, loss_ss: 0.883604, loss_d: 0.190443
0.0767 --- loss: 1.255144, loss_ss: 1.000033, loss_d: 0.255112
0.1151 --- loss: 1.102586, loss_ss: 0.981053, loss_d: 0.121533
0.1534 --- loss: 1.062832, loss_ss: 0.994872, loss_d: 0.067960
0.1918 --- loss: 1.004593, loss_ss: 0.820004, loss_d: 0.184589
0.2301 --- loss: 0.891588, loss_ss: 0.835560, loss_d: 0.056028
0.2685 --- loss: 0.946121, loss_ss: 0.752181, loss_d: 0.193940
0.3069 --- loss: 0.891987, loss_ss: 0.819893, loss_d: 0.072093
0.3452 --- loss: 0.988957, loss_ss: 0.757851, loss_d: 0.231106
0.3836 --- loss: 1.201011, loss_ss: 0.983423, loss_d: 0.217588
0.4219 --- loss: 0.928036, loss_ss: 0.828732, loss_d: 0.099304
0.4603 --- loss: 1.429616, loss_ss: 1.157320, loss_d: 0.272296
0.4987 --- loss: 1.519801, loss_ss: 1.252968, loss_d: 0.266834
0.5370 --- loss: 1.236473, loss_ss: 1.085865, loss_d: 0.150608
0.5754 --- loss: 0.623044, loss_ss: 0.556804, loss_d: 0.066240
0.6137 --- loss: 1.202454, loss_ss: 1.142748, loss_d: 0.059706
0.6521 --- loss: 0.895682, loss_ss: 0.802122, loss_d: 0.093560
0.6904 --- loss: 1.223406, loss_ss: 0.862841, loss_d: 0.360565
0.7288 --- loss: 1.392158, loss_ss: 0.912961, loss_d: 0.479198
0.7672 --- loss: 1.163300, loss_ss: 0.935510, loss_d: 0.227790
0.8055 --- loss: 0.979224, loss_ss: 0.820502, loss_d: 0.158722
0.8439 --- loss: 0.620224, loss_ss: 0.579693, loss_d: 0.040531
0.8822 --- loss: 0.881126, loss_ss: 0.831828, loss_d: 0.049298
0.9206 --- loss: 1.162471, loss_ss: 0.959605, loss_d: 0.202867
0.9590 --- loss: 1.203436, loss_ss: 0.757741, loss_d: 0.445695
0.9973 --- loss: 1.078830, loss_ss: 0.976494, loss_d: 0.102337
Epoch finished! Loss: 1.0589486968058806
Starting epoch 5/10.
0.0000 --- loss: 1.782914, loss_ss: 1.048074, loss_d: 0.734840
0.0384 --- loss: 1.317636, loss_ss: 1.228947, loss_d: 0.088689
0.0767 --- loss: 1.531881, loss_ss: 1.332962, loss_d: 0.198919
0.1151 --- loss: 1.081604, loss_ss: 0.975420, loss_d: 0.106184
0.1534 --- loss: 0.766957, loss_ss: 0.676634, loss_d: 0.090323
0.1918 --- loss: 0.856254, loss_ss: 0.762896, loss_d: 0.093358
0.2301 --- loss: 0.980816, loss_ss: 0.912091, loss_d: 0.068725
0.2685 --- loss: 0.991381, loss_ss: 0.976946, loss_d: 0.014435
0.3069 --- loss: 0.785094, loss_ss: 0.733835, loss_d: 0.051259
0.3452 --- loss: 0.888380, loss_ss: 0.710096, loss_d: 0.178285
0.3836 --- loss: 0.837294, loss_ss: 0.798697, loss_d: 0.038598
0.4219 --- loss: 0.853043, loss_ss: 0.572753, loss_d: 0.280289
0.4603 --- loss: 1.037375, loss_ss: 0.755082, loss_d: 0.282293
0.4987 --- loss: 1.199805, loss_ss: 0.874009, loss_d: 0.325796
0.5370 --- loss: 0.883452, loss_ss: 0.795544, loss_d: 0.087909
0.5754 --- loss: 0.982116, loss_ss: 0.790637, loss_d: 0.191479
0.6137 --- loss: 1.057847, loss_ss: 0.725679, loss_d: 0.332168
0.6521 --- loss: 1.147531, loss_ss: 0.890138, loss_d: 0.257393
0.6904 --- loss: 1.204770, loss_ss: 0.998826, loss_d: 0.205944
0.7288 --- loss: 1.036247, loss_ss: 0.732788, loss_d: 0.303459
0.7672 --- loss: 0.798019, loss_ss: 0.645077, loss_d: 0.152942
0.8055 --- loss: 1.019387, loss_ss: 0.757813, loss_d: 0.261574
0.8439 --- loss: 0.741687, loss_ss: 0.711312, loss_d: 0.030375
0.8822 --- loss: 0.905192, loss_ss: 0.836779, loss_d: 0.068413
0.9206 --- loss: 1.495032, loss_ss: 1.410799, loss_d: 0.084234
0.9590 --- loss: 0.807792, loss_ss: 0.712013, loss_d: 0.095779
0.9973 --- loss: 0.945222, loss_ss: 0.924988, loss_d: 0.020234
Epoch finished! Loss: 1.0078467797774535
Starting epoch 6/10.
0.0000 --- loss: 0.609872, loss_ss: 0.578244, loss_d: 0.031628
0.0384 --- loss: 1.368283, loss_ss: 1.312678, loss_d: 0.055605
0.0767 --- loss: 0.598772, loss_ss: 0.489314, loss_d: 0.109457
0.1151 --- loss: 0.951949, loss_ss: 0.902986, loss_d: 0.048963
0.1534 --- loss: 0.799534, loss_ss: 0.653102, loss_d: 0.146433
0.1918 --- loss: 0.847161, loss_ss: 0.767073, loss_d: 0.080088
0.2301 --- loss: 0.846720, loss_ss: 0.723260, loss_d: 0.123460
0.2685 --- loss: 0.874240, loss_ss: 0.788902, loss_d: 0.085338
0.3069 --- loss: 0.930012, loss_ss: 0.836545, loss_d: 0.093467
0.3452 --- loss: 0.787333, loss_ss: 0.762920, loss_d: 0.024413
0.3836 --- loss: 0.800958, loss_ss: 0.584079, loss_d: 0.216879
0.4219 --- loss: 0.940581, loss_ss: 0.688227, loss_d: 0.252354
0.4603 --- loss: 0.889904, loss_ss: 0.739617, loss_d: 0.150287
0.4987 --- loss: 0.861207, loss_ss: 0.617164, loss_d: 0.244043
0.5370 --- loss: 0.994817, loss_ss: 0.947317, loss_d: 0.047501
0.5754 --- loss: 0.893999, loss_ss: 0.771613, loss_d: 0.122386
0.6137 --- loss: 0.839386, loss_ss: 0.772190, loss_d: 0.067197
0.6521 --- loss: 1.015275, loss_ss: 0.901526, loss_d: 0.113749
0.6904 --- loss: 1.067871, loss_ss: 0.726691, loss_d: 0.341179
0.7288 --- loss: 0.967992, loss_ss: 0.735027, loss_d: 0.232965
0.7672 --- loss: 1.055199, loss_ss: 0.569929, loss_d: 0.485270
0.8055 --- loss: 1.128752, loss_ss: 1.064160, loss_d: 0.064591
0.8439 --- loss: 1.044018, loss_ss: 0.788992, loss_d: 0.255026
0.8822 --- loss: 0.609009, loss_ss: 0.524500, loss_d: 0.084508
0.9206 --- loss: 0.767486, loss_ss: 0.754705, loss_d: 0.012781
0.9590 --- loss: 0.486169, loss_ss: 0.435981, loss_d: 0.050188
0.9973 --- loss: 0.916470, loss_ss: 0.908149, loss_d: 0.008320
Epoch finished! Loss: 0.9496003242639395
Starting epoch 7/10.
0.0000 --- loss: 0.993458, loss_ss: 0.982380, loss_d: 0.011078
0.0384 --- loss: 0.792486, loss_ss: 0.670726, loss_d: 0.121760
0.0767 --- loss: 0.911330, loss_ss: 0.788698, loss_d: 0.122632
0.1151 --- loss: 0.827568, loss_ss: 0.797902, loss_d: 0.029666
0.1534 --- loss: 0.956150, loss_ss: 0.900814, loss_d: 0.055336
0.1918 --- loss: 1.041304, loss_ss: 0.674188, loss_d: 0.367116
0.2301 --- loss: 1.055297, loss_ss: 1.006979, loss_d: 0.048318
0.2685 --- loss: 1.050263, loss_ss: 0.833422, loss_d: 0.216841
0.3069 --- loss: 0.783218, loss_ss: 0.772575, loss_d: 0.010643
0.3452 --- loss: 1.145790, loss_ss: 1.136676, loss_d: 0.009114
0.3836 --- loss: 0.773349, loss_ss: 0.714699, loss_d: 0.058650
0.4219 --- loss: 1.087246, loss_ss: 0.901745, loss_d: 0.185501
0.4603 --- loss: 0.674668, loss_ss: 0.658344, loss_d: 0.016324
0.4987 --- loss: 0.906588, loss_ss: 0.856421, loss_d: 0.050168
0.5370 --- loss: 0.940079, loss_ss: 0.695162, loss_d: 0.244917
0.5754 --- loss: 1.050341, loss_ss: 0.940607, loss_d: 0.109734
0.6137 --- loss: 0.798291, loss_ss: 0.656532, loss_d: 0.141759
0.6521 --- loss: 0.958218, loss_ss: 0.855474, loss_d: 0.102744
0.6904 --- loss: 1.384495, loss_ss: 1.329257, loss_d: 0.055239
0.7288 --- loss: 0.888354, loss_ss: 0.549890, loss_d: 0.338465
0.7672 --- loss: 0.689161, loss_ss: 0.660551, loss_d: 0.028610
0.8055 --- loss: 1.552470, loss_ss: 1.164476, loss_d: 0.387993
0.8439 --- loss: 1.378612, loss_ss: 0.853190, loss_d: 0.525421
0.8822 --- loss: 0.919680, loss_ss: 0.905962, loss_d: 0.013718
0.9206 --- loss: 0.827777, loss_ss: 0.453618, loss_d: 0.374159
0.9590 --- loss: 1.465752, loss_ss: 1.275096, loss_d: 0.190655
0.9973 --- loss: 0.649673, loss_ss: 0.606318, loss_d: 0.043355
Epoch finished! Loss: 0.9005455724321879
Starting epoch 8/10.
0.0000 --- loss: 0.815129, loss_ss: 0.743166, loss_d: 0.071964
0.0384 --- loss: 0.769375, loss_ss: 0.692721, loss_d: 0.076654
0.0767 --- loss: 0.622459, loss_ss: 0.611142, loss_d: 0.011318
0.1151 --- loss: 0.528886, loss_ss: 0.509062, loss_d: 0.019824
0.1534 --- loss: 1.522331, loss_ss: 0.570446, loss_d: 0.951885
0.1918 --- loss: 0.691181, loss_ss: 0.651299, loss_d: 0.039882
0.2301 --- loss: 0.947366, loss_ss: 0.868672, loss_d: 0.078693
0.2685 --- loss: 0.598696, loss_ss: 0.585386, loss_d: 0.013311
0.3069 --- loss: 0.851512, loss_ss: 0.828237, loss_d: 0.023274
0.3452 --- loss: 1.503151, loss_ss: 0.655452, loss_d: 0.847700
0.3836 --- loss: 1.387018, loss_ss: 1.131508, loss_d: 0.255511
0.4219 --- loss: 0.780658, loss_ss: 0.740206, loss_d: 0.040452
0.4603 --- loss: 0.677106, loss_ss: 0.593713, loss_d: 0.083393
0.4987 --- loss: 1.358394, loss_ss: 1.047550, loss_d: 0.310844
0.5370 --- loss: 0.716421, loss_ss: 0.709837, loss_d: 0.006584
0.5754 --- loss: 1.200274, loss_ss: 1.113429, loss_d: 0.086845
0.6137 --- loss: 1.157982, loss_ss: 1.115065, loss_d: 0.042917
0.6521 --- loss: 1.125918, loss_ss: 1.049848, loss_d: 0.076070
0.6904 --- loss: 0.715655, loss_ss: 0.631777, loss_d: 0.083878
0.7288 --- loss: 0.878847, loss_ss: 0.765999, loss_d: 0.112848
0.7672 --- loss: 0.550238, loss_ss: 0.524095, loss_d: 0.026143
0.8055 --- loss: 0.727611, loss_ss: 0.712519, loss_d: 0.015092
0.8439 --- loss: 0.978260, loss_ss: 0.852768, loss_d: 0.125492
0.8822 --- loss: 0.917676, loss_ss: 0.843828, loss_d: 0.073847
0.9206 --- loss: 0.787988, loss_ss: 0.746842, loss_d: 0.041146
0.9590 --- loss: 0.698785, loss_ss: 0.604944, loss_d: 0.093841
0.9973 --- loss: 0.915361, loss_ss: 0.568146, loss_d: 0.347215
Epoch finished! Loss: 0.9066019462851378
Starting epoch 9/10.
0.0000 --- loss: 0.729289, loss_ss: 0.588685, loss_d: 0.140604
0.0384 --- loss: 0.625868, loss_ss: 0.609762, loss_d: 0.016105
0.0767 --- loss: 0.724534, loss_ss: 0.618684, loss_d: 0.105849
0.1151 --- loss: 0.852848, loss_ss: 0.769386, loss_d: 0.083462
0.1534 --- loss: 0.861518, loss_ss: 0.842897, loss_d: 0.018622
0.1918 --- loss: 1.076599, loss_ss: 1.065553, loss_d: 0.011046
0.2301 --- loss: 1.038327, loss_ss: 0.989048, loss_d: 0.049279
0.2685 --- loss: 0.805998, loss_ss: 0.750990, loss_d: 0.055008
0.3069 --- loss: 0.647088, loss_ss: 0.636309, loss_d: 0.010779
0.3452 --- loss: 0.611045, loss_ss: 0.591076, loss_d: 0.019969
0.3836 --- loss: 1.218606, loss_ss: 1.212957, loss_d: 0.005649
0.4219 --- loss: 1.142457, loss_ss: 0.890621, loss_d: 0.251836
0.4603 --- loss: 1.382496, loss_ss: 1.343042, loss_d: 0.039454
0.4987 --- loss: 0.779868, loss_ss: 0.628106, loss_d: 0.151762
0.5370 --- loss: 1.104003, loss_ss: 0.757099, loss_d: 0.346903
0.5754 --- loss: 0.720277, loss_ss: 0.692890, loss_d: 0.027387
0.6137 --- loss: 0.884614, loss_ss: 0.666045, loss_d: 0.218569
0.6521 --- loss: 1.099397, loss_ss: 1.004884, loss_d: 0.094512
0.6904 --- loss: 0.685883, loss_ss: 0.630047, loss_d: 0.055836
0.7288 --- loss: 0.686926, loss_ss: 0.669831, loss_d: 0.017094
0.7672 --- loss: 0.864097, loss_ss: 0.785921, loss_d: 0.078176
0.8055 --- loss: 0.849517, loss_ss: 0.739495, loss_d: 0.110022
0.8439 --- loss: 0.780451, loss_ss: 0.772851, loss_d: 0.007600
0.8822 --- loss: 0.803172, loss_ss: 0.793703, loss_d: 0.009470
0.9206 --- loss: 0.775932, loss_ss: 0.771412, loss_d: 0.004520
0.9590 --- loss: 0.840465, loss_ss: 0.815663, loss_d: 0.024801
0.9973 --- loss: 0.806478, loss_ss: 0.747245, loss_d: 0.059233
Epoch finished! Loss: 0.8527075193249263
Starting epoch 10/10.
0.0000 --- loss: 1.053635, loss_ss: 0.899063, loss_d: 0.154572
0.0384 --- loss: 0.831138, loss_ss: 0.635731, loss_d: 0.195406
0.0767 --- loss: 0.903010, loss_ss: 0.827143, loss_d: 0.075867
0.1151 --- loss: 0.810761, loss_ss: 0.805419, loss_d: 0.005343
0.1534 --- loss: 0.796506, loss_ss: 0.717534, loss_d: 0.078972
0.1918 --- loss: 1.094017, loss_ss: 0.800177, loss_d: 0.293840
0.2301 --- loss: 0.683120, loss_ss: 0.675874, loss_d: 0.007245
0.2685 --- loss: 0.527172, loss_ss: 0.438089, loss_d: 0.089083
0.3069 --- loss: 0.888377, loss_ss: 0.884564, loss_d: 0.003813
0.3452 --- loss: 0.933161, loss_ss: 0.725885, loss_d: 0.207276
0.3836 --- loss: 0.690046, loss_ss: 0.672823, loss_d: 0.017223
0.4219 --- loss: 1.182106, loss_ss: 1.181670, loss_d: 0.000436
0.4603 --- loss: 0.858792, loss_ss: 0.811257, loss_d: 0.047536
0.4987 --- loss: 0.951256, loss_ss: 0.925118, loss_d: 0.026138
0.5370 --- loss: 0.709068, loss_ss: 0.607375, loss_d: 0.101694
0.5754 --- loss: 0.530322, loss_ss: 0.529558, loss_d: 0.000763
0.6137 --- loss: 0.815583, loss_ss: 0.812613, loss_d: 0.002971
0.6521 --- loss: 0.584429, loss_ss: 0.577070, loss_d: 0.007360
0.6904 --- loss: 0.648964, loss_ss: 0.636679, loss_d: 0.012286
0.7288 --- loss: 0.520446, loss_ss: 0.472244, loss_d: 0.048202
0.7672 --- loss: 0.588099, loss_ss: 0.538545, loss_d: 0.049554
0.8055 --- loss: 0.622562, loss_ss: 0.580409, loss_d: 0.042153
0.8439 --- loss: 0.695316, loss_ss: 0.673886, loss_d: 0.021430
0.8822 --- loss: 0.780971, loss_ss: 0.764485, loss_d: 0.016486
0.9206 --- loss: 0.835893, loss_ss: 0.821772, loss_d: 0.014121
0.9590 --- loss: 0.603485, loss_ss: 0.506841, loss_d: 0.096644
0.9973 --- loss: 0.801020, loss_ss: 0.789650, loss_d: 0.011370
Epoch finished! Loss: 0.82568888515234
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7408602150537634
             precision    recall  f1-score   support

        0.0       0.96      0.62      0.75        69
        1.0       0.27      0.87      0.41        38
        2.0       0.80      0.71      0.75       434
        3.0       1.00      0.68      0.81       228
        4.0       0.67      0.93      0.78       161

avg / total       0.82      0.74      0.76       930
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.99  62.32   99.77   95.56     75.44
1  89.68  86.84   89.80   26.61     40.74
2  78.39  70.97   84.88   80.42     75.40
3  92.15  67.98  100.00  100.00     80.94
4  90.97  93.17   90.51   67.26     78.12
Total accuracy: 74.09%
Average sen: 76.26%
Average spec: 92.99%
Macro f1-score: 70.13%
Diagnosis acc on 15mins: 0.2903225806451613
[2.19261143e-04 8.79521251e-01 4.45781708e-01 3.34916025e-01
 4.09655124e-01 6.81464449e-02 8.19592595e-01 9.85218465e-01
 9.86334443e-01 9.80714798e-01 9.85351086e-01 8.80150497e-01
 6.83867097e-01 8.16614091e-01 9.50890839e-01 9.05523062e-01
 6.58120692e-01 9.52538013e-01 4.34776753e-01 5.81882834e-01
 9.24967408e-01 8.69035006e-01 9.64083016e-01 7.32243776e-01
 8.61267984e-01 9.48777020e-01 6.87661588e-01 8.98484364e-02
 5.83904564e-01 4.61549073e-01 1.89808384e-02]
pred: 0.6742623803433925, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.406354, loss_ss: 1.700027, loss_d: 0.706327
0.0384 --- loss: 2.008940, loss_ss: 1.722203, loss_d: 0.286738
0.0767 --- loss: 2.180585, loss_ss: 1.546280, loss_d: 0.634305
0.1151 --- loss: 1.713641, loss_ss: 1.476174, loss_d: 0.237467
0.1534 --- loss: 1.964888, loss_ss: 1.494977, loss_d: 0.469911
0.1918 --- loss: 1.673226, loss_ss: 1.280836, loss_d: 0.392390
0.2301 --- loss: 1.854140, loss_ss: 1.381664, loss_d: 0.472475
0.2685 --- loss: 1.778304, loss_ss: 1.298274, loss_d: 0.480030
0.3069 --- loss: 1.952987, loss_ss: 1.291382, loss_d: 0.661606
0.3452 --- loss: 2.302714, loss_ss: 1.693274, loss_d: 0.609440
0.3836 --- loss: 2.042483, loss_ss: 1.237462, loss_d: 0.805021
0.4219 --- loss: 1.873163, loss_ss: 1.304392, loss_d: 0.568771
0.4603 --- loss: 1.627072, loss_ss: 1.314861, loss_d: 0.312212
0.4987 --- loss: 2.113480, loss_ss: 1.374406, loss_d: 0.739074
0.5370 --- loss: 1.755530, loss_ss: 1.209464, loss_d: 0.546066
0.5754 --- loss: 1.834215, loss_ss: 1.170734, loss_d: 0.663481
0.6137 --- loss: 1.765501, loss_ss: 1.308415, loss_d: 0.457086
0.6521 --- loss: 1.524316, loss_ss: 1.210520, loss_d: 0.313795
0.6904 --- loss: 1.492857, loss_ss: 1.137146, loss_d: 0.355711
0.7288 --- loss: 1.546581, loss_ss: 1.436854, loss_d: 0.109727
0.7672 --- loss: 1.747532, loss_ss: 1.196428, loss_d: 0.551104
0.8055 --- loss: 1.809435, loss_ss: 1.436929, loss_d: 0.372506
0.8439 --- loss: 1.418187, loss_ss: 1.019335, loss_d: 0.398852
0.8822 --- loss: 1.287633, loss_ss: 1.014190, loss_d: 0.273443
0.9206 --- loss: 1.596659, loss_ss: 1.088383, loss_d: 0.508276
0.9590 --- loss: 1.512909, loss_ss: 1.187560, loss_d: 0.325348
0.9973 --- loss: 1.743444, loss_ss: 1.227229, loss_d: 0.516214
Epoch finished! Loss: 1.8405920679752643
Starting epoch 2/10.
0.0000 --- loss: 1.514318, loss_ss: 1.128164, loss_d: 0.386154
0.0384 --- loss: 1.355170, loss_ss: 1.163176, loss_d: 0.191994
0.0767 --- loss: 1.717700, loss_ss: 1.253648, loss_d: 0.464052
0.1151 --- loss: 1.489775, loss_ss: 1.073468, loss_d: 0.416307
0.1534 --- loss: 1.730968, loss_ss: 1.448178, loss_d: 0.282791
0.1918 --- loss: 1.763666, loss_ss: 1.008978, loss_d: 0.754688
0.2301 --- loss: 1.379356, loss_ss: 1.071541, loss_d: 0.307815
0.2685 --- loss: 1.293375, loss_ss: 1.040545, loss_d: 0.252830
0.3069 --- loss: 1.086959, loss_ss: 0.962858, loss_d: 0.124102
0.3452 --- loss: 1.097368, loss_ss: 0.891264, loss_d: 0.206104
0.3836 --- loss: 1.347766, loss_ss: 0.965947, loss_d: 0.381819
0.4219 --- loss: 1.841597, loss_ss: 1.273023, loss_d: 0.568574
0.4603 --- loss: 1.145881, loss_ss: 1.062557, loss_d: 0.083324
0.4987 --- loss: 1.378877, loss_ss: 1.097272, loss_d: 0.281605
0.5370 --- loss: 1.280383, loss_ss: 0.836692, loss_d: 0.443692
0.5754 --- loss: 1.202231, loss_ss: 0.970122, loss_d: 0.232109
0.6137 --- loss: 1.462550, loss_ss: 1.092802, loss_d: 0.369748
0.6521 --- loss: 1.490901, loss_ss: 1.165926, loss_d: 0.324975
0.6904 --- loss: 1.146063, loss_ss: 0.975345, loss_d: 0.170718
0.7288 --- loss: 1.544753, loss_ss: 1.060712, loss_d: 0.484041
0.7672 --- loss: 1.017591, loss_ss: 0.846317, loss_d: 0.171274
0.8055 --- loss: 1.042766, loss_ss: 0.906374, loss_d: 0.136392
0.8439 --- loss: 1.295419, loss_ss: 1.159254, loss_d: 0.136165
0.8822 --- loss: 1.336494, loss_ss: 1.204041, loss_d: 0.132453
0.9206 --- loss: 0.937014, loss_ss: 0.885260, loss_d: 0.051754
0.9590 --- loss: 1.223241, loss_ss: 0.967966, loss_d: 0.255275
0.9973 --- loss: 1.354812, loss_ss: 1.106361, loss_d: 0.248451
Epoch finished! Loss: 1.352544975051513
Starting epoch 3/10.
0.0000 --- loss: 1.115488, loss_ss: 0.861827, loss_d: 0.253661
0.0384 --- loss: 0.918720, loss_ss: 0.844741, loss_d: 0.073979
0.0767 --- loss: 1.104528, loss_ss: 0.775780, loss_d: 0.328749
0.1151 --- loss: 1.249018, loss_ss: 0.943239, loss_d: 0.305780
0.1534 --- loss: 1.253701, loss_ss: 1.073236, loss_d: 0.180466
0.1918 --- loss: 1.194496, loss_ss: 0.881508, loss_d: 0.312988
0.2301 --- loss: 1.201391, loss_ss: 1.098089, loss_d: 0.103302
0.2685 --- loss: 1.553070, loss_ss: 0.883758, loss_d: 0.669311
0.3069 --- loss: 2.189746, loss_ss: 0.926865, loss_d: 1.262881
0.3452 --- loss: 1.305269, loss_ss: 0.983032, loss_d: 0.322237
0.3836 --- loss: 1.122351, loss_ss: 0.913559, loss_d: 0.208792
0.4219 --- loss: 1.312432, loss_ss: 1.183790, loss_d: 0.128642
0.4603 --- loss: 1.068530, loss_ss: 1.008567, loss_d: 0.059963
0.4987 --- loss: 1.305970, loss_ss: 1.030194, loss_d: 0.275776
0.5370 --- loss: 1.325346, loss_ss: 1.058159, loss_d: 0.267186
0.5754 --- loss: 1.006120, loss_ss: 0.725181, loss_d: 0.280940
0.6137 --- loss: 1.742397, loss_ss: 1.585778, loss_d: 0.156619
0.6521 --- loss: 0.930460, loss_ss: 0.898518, loss_d: 0.031942
0.6904 --- loss: 1.175730, loss_ss: 1.051626, loss_d: 0.124104
0.7288 --- loss: 1.286583, loss_ss: 1.080174, loss_d: 0.206408
0.7672 --- loss: 0.924172, loss_ss: 0.707839, loss_d: 0.216334
0.8055 --- loss: 1.028278, loss_ss: 0.974815, loss_d: 0.053463
0.8439 --- loss: 1.368660, loss_ss: 1.101665, loss_d: 0.266995
0.8822 --- loss: 1.000481, loss_ss: 0.854318, loss_d: 0.146163
0.9206 --- loss: 0.890406, loss_ss: 0.770792, loss_d: 0.119615
0.9590 --- loss: 0.769724, loss_ss: 0.738484, loss_d: 0.031240
0.9973 --- loss: 0.782430, loss_ss: 0.729468, loss_d: 0.052963
Epoch finished! Loss: 1.191870052080888
Starting epoch 4/10.
0.0000 --- loss: 0.946568, loss_ss: 0.840009, loss_d: 0.106559
0.0384 --- loss: 2.011610, loss_ss: 0.930469, loss_d: 1.081141
0.0767 --- loss: 0.796105, loss_ss: 0.644812, loss_d: 0.151293
0.1151 --- loss: 1.434416, loss_ss: 1.310661, loss_d: 0.123754
0.1534 --- loss: 1.264131, loss_ss: 1.007481, loss_d: 0.256650
0.1918 --- loss: 1.278759, loss_ss: 0.888330, loss_d: 0.390429
0.2301 --- loss: 1.165918, loss_ss: 0.832173, loss_d: 0.333745
0.2685 --- loss: 1.164662, loss_ss: 0.938790, loss_d: 0.225872
0.3069 --- loss: 0.930649, loss_ss: 0.905708, loss_d: 0.024941
0.3452 --- loss: 1.142935, loss_ss: 0.773089, loss_d: 0.369846
0.3836 --- loss: 0.928261, loss_ss: 0.798751, loss_d: 0.129511
0.4219 --- loss: 1.422698, loss_ss: 0.952439, loss_d: 0.470260
0.4603 --- loss: 1.098441, loss_ss: 0.925077, loss_d: 0.173363
0.4987 --- loss: 0.977147, loss_ss: 0.829742, loss_d: 0.147405
0.5370 --- loss: 1.088514, loss_ss: 0.806371, loss_d: 0.282143
0.5754 --- loss: 0.904256, loss_ss: 0.804208, loss_d: 0.100048
0.6137 --- loss: 1.059456, loss_ss: 0.836127, loss_d: 0.223329
0.6521 --- loss: 0.840952, loss_ss: 0.825281, loss_d: 0.015672
0.6904 --- loss: 1.274879, loss_ss: 0.714229, loss_d: 0.560650
0.7288 --- loss: 1.269683, loss_ss: 0.978765, loss_d: 0.290919
0.7672 --- loss: 1.036053, loss_ss: 0.963198, loss_d: 0.072855
0.8055 --- loss: 1.047401, loss_ss: 0.970292, loss_d: 0.077110
0.8439 --- loss: 0.866627, loss_ss: 0.843565, loss_d: 0.023061
0.8822 --- loss: 1.247904, loss_ss: 0.896078, loss_d: 0.351827
0.9206 --- loss: 1.196121, loss_ss: 0.913402, loss_d: 0.282719
0.9590 --- loss: 1.012630, loss_ss: 0.885811, loss_d: 0.126820
0.9973 --- loss: 0.975712, loss_ss: 0.711721, loss_d: 0.263991
Epoch finished! Loss: 1.1179671801053561
Starting epoch 5/10.
0.0000 --- loss: 1.125059, loss_ss: 0.735827, loss_d: 0.389232
0.0384 --- loss: 1.100949, loss_ss: 0.913332, loss_d: 0.187617
0.0767 --- loss: 1.105453, loss_ss: 0.798814, loss_d: 0.306638
0.1151 --- loss: 0.996669, loss_ss: 0.948434, loss_d: 0.048234
0.1534 --- loss: 1.064968, loss_ss: 0.952817, loss_d: 0.112151
0.1918 --- loss: 0.849796, loss_ss: 0.820922, loss_d: 0.028874
0.2301 --- loss: 1.424231, loss_ss: 0.851201, loss_d: 0.573030
0.2685 --- loss: 1.021520, loss_ss: 0.909618, loss_d: 0.111901
0.3069 --- loss: 0.705383, loss_ss: 0.690625, loss_d: 0.014759
0.3452 --- loss: 1.051670, loss_ss: 0.768346, loss_d: 0.283324
0.3836 --- loss: 0.774891, loss_ss: 0.682751, loss_d: 0.092140
0.4219 --- loss: 0.764166, loss_ss: 0.693911, loss_d: 0.070255
0.4603 --- loss: 0.820560, loss_ss: 0.774432, loss_d: 0.046128
0.4987 --- loss: 1.176431, loss_ss: 1.151369, loss_d: 0.025062
0.5370 --- loss: 1.079251, loss_ss: 0.818982, loss_d: 0.260269
0.5754 --- loss: 0.814154, loss_ss: 0.729189, loss_d: 0.084964
0.6137 --- loss: 1.239336, loss_ss: 0.944520, loss_d: 0.294816
0.6521 --- loss: 1.683347, loss_ss: 1.038955, loss_d: 0.644392
0.6904 --- loss: 1.319967, loss_ss: 1.166382, loss_d: 0.153585
0.7288 --- loss: 0.864685, loss_ss: 0.789216, loss_d: 0.075469
0.7672 --- loss: 0.724762, loss_ss: 0.675943, loss_d: 0.048819
0.8055 --- loss: 0.863630, loss_ss: 0.634968, loss_d: 0.228662
0.8439 --- loss: 0.924124, loss_ss: 0.727382, loss_d: 0.196742
0.8822 --- loss: 0.837508, loss_ss: 0.799114, loss_d: 0.038394
0.9206 --- loss: 1.083759, loss_ss: 1.062998, loss_d: 0.020761
0.9590 --- loss: 1.157145, loss_ss: 0.898093, loss_d: 0.259052
0.9973 --- loss: 0.789991, loss_ss: 0.738255, loss_d: 0.051736
Epoch finished! Loss: 1.0429098500655247
Starting epoch 6/10.
0.0000 --- loss: 0.997387, loss_ss: 0.781457, loss_d: 0.215930
0.0384 --- loss: 0.770950, loss_ss: 0.709099, loss_d: 0.061851
0.0767 --- loss: 1.201159, loss_ss: 1.138584, loss_d: 0.062575
0.1151 --- loss: 1.148986, loss_ss: 0.842918, loss_d: 0.306068
0.1534 --- loss: 0.733801, loss_ss: 0.693886, loss_d: 0.039915
0.1918 --- loss: 0.902120, loss_ss: 0.841106, loss_d: 0.061014
0.2301 --- loss: 0.872206, loss_ss: 0.701964, loss_d: 0.170241
0.2685 --- loss: 1.517702, loss_ss: 1.031145, loss_d: 0.486557
0.3069 --- loss: 1.345224, loss_ss: 0.844636, loss_d: 0.500588
0.3452 --- loss: 0.895470, loss_ss: 0.720558, loss_d: 0.174911
0.3836 --- loss: 0.914819, loss_ss: 0.632537, loss_d: 0.282282
0.4219 --- loss: 0.888892, loss_ss: 0.810514, loss_d: 0.078378
0.4603 --- loss: 0.887990, loss_ss: 0.874248, loss_d: 0.013742
0.4987 --- loss: 1.268167, loss_ss: 1.064060, loss_d: 0.204108
0.5370 --- loss: 0.768418, loss_ss: 0.737819, loss_d: 0.030599
0.5754 --- loss: 1.607513, loss_ss: 1.253200, loss_d: 0.354313
0.6137 --- loss: 0.789230, loss_ss: 0.641093, loss_d: 0.148137
0.6521 --- loss: 0.770421, loss_ss: 0.741379, loss_d: 0.029042
0.6904 --- loss: 0.929263, loss_ss: 0.878251, loss_d: 0.051013
0.7288 --- loss: 0.700356, loss_ss: 0.542369, loss_d: 0.157986
0.7672 --- loss: 0.960686, loss_ss: 0.792116, loss_d: 0.168571
0.8055 --- loss: 0.962073, loss_ss: 0.912402, loss_d: 0.049671
0.8439 --- loss: 0.869230, loss_ss: 0.828898, loss_d: 0.040332
0.8822 --- loss: 1.204503, loss_ss: 0.654443, loss_d: 0.550061
0.9206 --- loss: 0.709233, loss_ss: 0.665175, loss_d: 0.044057
0.9590 --- loss: 1.105183, loss_ss: 0.990116, loss_d: 0.115067
0.9973 --- loss: 0.890425, loss_ss: 0.678455, loss_d: 0.211971
Epoch finished! Loss: 1.00567100414863
Starting epoch 7/10.
0.0000 --- loss: 0.634581, loss_ss: 0.598498, loss_d: 0.036083
0.0384 --- loss: 1.004335, loss_ss: 0.986976, loss_d: 0.017359
0.0767 --- loss: 1.237759, loss_ss: 0.901668, loss_d: 0.336091
0.1151 --- loss: 1.003815, loss_ss: 0.844129, loss_d: 0.159687
0.1534 --- loss: 0.946698, loss_ss: 0.918945, loss_d: 0.027753
0.1918 --- loss: 1.009274, loss_ss: 0.980115, loss_d: 0.029159
0.2301 --- loss: 0.964798, loss_ss: 0.717267, loss_d: 0.247531
0.2685 --- loss: 0.947434, loss_ss: 0.892476, loss_d: 0.054958
0.3069 --- loss: 1.094124, loss_ss: 0.818564, loss_d: 0.275560
0.3452 --- loss: 0.645207, loss_ss: 0.589841, loss_d: 0.055366
0.3836 --- loss: 0.684544, loss_ss: 0.654878, loss_d: 0.029666
0.4219 --- loss: 1.085983, loss_ss: 0.795196, loss_d: 0.290787
0.4603 --- loss: 0.654804, loss_ss: 0.570855, loss_d: 0.083950
0.4987 --- loss: 1.097463, loss_ss: 0.663955, loss_d: 0.433509
0.5370 --- loss: 0.758671, loss_ss: 0.745605, loss_d: 0.013066
0.5754 --- loss: 0.925083, loss_ss: 0.768727, loss_d: 0.156356
0.6137 --- loss: 0.925289, loss_ss: 0.897160, loss_d: 0.028129
0.6521 --- loss: 0.875164, loss_ss: 0.823853, loss_d: 0.051312
0.6904 --- loss: 1.055573, loss_ss: 0.928378, loss_d: 0.127195
0.7288 --- loss: 1.222071, loss_ss: 1.158196, loss_d: 0.063875
0.7672 --- loss: 1.048475, loss_ss: 0.704691, loss_d: 0.343784
0.8055 --- loss: 0.991898, loss_ss: 0.950182, loss_d: 0.041716
0.8439 --- loss: 0.600757, loss_ss: 0.574733, loss_d: 0.026024
0.8822 --- loss: 0.948371, loss_ss: 0.916916, loss_d: 0.031455
0.9206 --- loss: 0.883094, loss_ss: 0.863691, loss_d: 0.019403
0.9590 --- loss: 0.774550, loss_ss: 0.742298, loss_d: 0.032252
0.9973 --- loss: 1.200564, loss_ss: 0.974080, loss_d: 0.226484
Epoch finished! Loss: 0.9639197264726346
Starting epoch 8/10.
0.0000 --- loss: 1.491152, loss_ss: 0.712364, loss_d: 0.778787
0.0384 --- loss: 0.857816, loss_ss: 0.826635, loss_d: 0.031181
0.0767 --- loss: 0.699748, loss_ss: 0.678742, loss_d: 0.021005
0.1151 --- loss: 0.849760, loss_ss: 0.541005, loss_d: 0.308756
0.1534 --- loss: 0.743466, loss_ss: 0.655835, loss_d: 0.087631
0.1918 --- loss: 0.917063, loss_ss: 0.789085, loss_d: 0.127978
0.2301 --- loss: 0.769383, loss_ss: 0.698644, loss_d: 0.070739
0.2685 --- loss: 1.579683, loss_ss: 0.698602, loss_d: 0.881081
0.3069 --- loss: 0.745260, loss_ss: 0.710795, loss_d: 0.034465
0.3452 --- loss: 0.919691, loss_ss: 0.869874, loss_d: 0.049818
0.3836 --- loss: 1.012796, loss_ss: 0.978807, loss_d: 0.033989
0.4219 --- loss: 0.684412, loss_ss: 0.639001, loss_d: 0.045412
0.4603 --- loss: 0.687182, loss_ss: 0.635775, loss_d: 0.051406
0.4987 --- loss: 0.929820, loss_ss: 0.888074, loss_d: 0.041747
0.5370 --- loss: 1.039483, loss_ss: 0.855354, loss_d: 0.184129
0.5754 --- loss: 0.879157, loss_ss: 0.832078, loss_d: 0.047080
0.6137 --- loss: 0.935458, loss_ss: 0.835696, loss_d: 0.099761
0.6521 --- loss: 0.848813, loss_ss: 0.842690, loss_d: 0.006123
0.6904 --- loss: 0.673161, loss_ss: 0.664985, loss_d: 0.008176
0.7288 --- loss: 0.681991, loss_ss: 0.676252, loss_d: 0.005739
0.7672 --- loss: 1.165240, loss_ss: 0.833679, loss_d: 0.331561
0.8055 --- loss: 0.827893, loss_ss: 0.760073, loss_d: 0.067821
0.8439 --- loss: 1.218217, loss_ss: 0.920365, loss_d: 0.297852
0.8822 --- loss: 0.871543, loss_ss: 0.853180, loss_d: 0.018364
0.9206 --- loss: 0.981910, loss_ss: 0.915078, loss_d: 0.066832
0.9590 --- loss: 0.693704, loss_ss: 0.647285, loss_d: 0.046419
0.9973 --- loss: 0.894040, loss_ss: 0.594738, loss_d: 0.299302
Epoch finished! Loss: 0.9089966356754303
Starting epoch 9/10.
0.0000 --- loss: 0.821155, loss_ss: 0.811542, loss_d: 0.009612
0.0384 --- loss: 0.741794, loss_ss: 0.732487, loss_d: 0.009307
0.0767 --- loss: 0.704968, loss_ss: 0.692922, loss_d: 0.012046
0.1151 --- loss: 0.991572, loss_ss: 0.978480, loss_d: 0.013092
0.1534 --- loss: 0.789400, loss_ss: 0.758312, loss_d: 0.031088
0.1918 --- loss: 0.686508, loss_ss: 0.666118, loss_d: 0.020389
0.2301 --- loss: 0.561851, loss_ss: 0.526391, loss_d: 0.035460
0.2685 --- loss: 0.513102, loss_ss: 0.501100, loss_d: 0.012002
0.3069 --- loss: 0.785133, loss_ss: 0.760302, loss_d: 0.024830
0.3452 --- loss: 0.657456, loss_ss: 0.574911, loss_d: 0.082545
0.3836 --- loss: 0.686895, loss_ss: 0.643758, loss_d: 0.043137
0.4219 --- loss: 1.117179, loss_ss: 0.705011, loss_d: 0.412169
0.4603 --- loss: 1.348806, loss_ss: 0.874833, loss_d: 0.473973
0.4987 --- loss: 0.859858, loss_ss: 0.830613, loss_d: 0.029245
0.5370 --- loss: 0.849051, loss_ss: 0.725310, loss_d: 0.123741
0.5754 --- loss: 1.064998, loss_ss: 0.901964, loss_d: 0.163034
0.6137 --- loss: 1.247073, loss_ss: 1.006430, loss_d: 0.240644
0.6521 --- loss: 0.954807, loss_ss: 0.724063, loss_d: 0.230744
0.6904 --- loss: 0.767696, loss_ss: 0.764613, loss_d: 0.003084
0.7288 --- loss: 0.830632, loss_ss: 0.776900, loss_d: 0.053732
0.7672 --- loss: 0.869978, loss_ss: 0.645578, loss_d: 0.224400
0.8055 --- loss: 0.801073, loss_ss: 0.778669, loss_d: 0.022404
0.8439 --- loss: 0.880355, loss_ss: 0.862768, loss_d: 0.017588
0.8822 --- loss: 0.760950, loss_ss: 0.751930, loss_d: 0.009020
0.9206 --- loss: 1.633668, loss_ss: 1.285441, loss_d: 0.348227
0.9590 --- loss: 0.836534, loss_ss: 0.803419, loss_d: 0.033116
0.9973 --- loss: 1.217911, loss_ss: 0.874375, loss_d: 0.343536
Epoch finished! Loss: 0.8843679139247307
Starting epoch 10/10.
0.0000 --- loss: 1.041055, loss_ss: 1.001842, loss_d: 0.039213
0.0384 --- loss: 0.935831, loss_ss: 0.920655, loss_d: 0.015176
0.0767 --- loss: 0.801030, loss_ss: 0.782006, loss_d: 0.019024
0.1151 --- loss: 0.655775, loss_ss: 0.644599, loss_d: 0.011176
0.1534 --- loss: 0.714821, loss_ss: 0.706842, loss_d: 0.007979
0.1918 --- loss: 0.972293, loss_ss: 0.909525, loss_d: 0.062768
0.2301 --- loss: 0.902164, loss_ss: 0.811646, loss_d: 0.090518
0.2685 --- loss: 0.858861, loss_ss: 0.782939, loss_d: 0.075921
0.3069 --- loss: 0.876059, loss_ss: 0.856872, loss_d: 0.019186
0.3452 --- loss: 1.114829, loss_ss: 1.009804, loss_d: 0.105025
0.3836 --- loss: 1.092297, loss_ss: 1.010652, loss_d: 0.081645
0.4219 --- loss: 0.672793, loss_ss: 0.584675, loss_d: 0.088117
0.4603 --- loss: 0.670775, loss_ss: 0.576024, loss_d: 0.094751
0.4987 --- loss: 1.040708, loss_ss: 1.020601, loss_d: 0.020106
0.5370 --- loss: 0.568878, loss_ss: 0.475051, loss_d: 0.093827
0.5754 --- loss: 1.281076, loss_ss: 0.979248, loss_d: 0.301828
0.6137 --- loss: 0.617580, loss_ss: 0.598827, loss_d: 0.018753
0.6521 --- loss: 0.745745, loss_ss: 0.735560, loss_d: 0.010184
0.6904 --- loss: 1.553826, loss_ss: 0.851738, loss_d: 0.702088
0.7288 --- loss: 0.604015, loss_ss: 0.557589, loss_d: 0.046426
0.7672 --- loss: 0.804127, loss_ss: 0.778096, loss_d: 0.026031
0.8055 --- loss: 0.459597, loss_ss: 0.394369, loss_d: 0.065228
0.8439 --- loss: 0.901482, loss_ss: 0.865059, loss_d: 0.036423
0.8822 --- loss: 0.908652, loss_ss: 0.855131, loss_d: 0.053521
0.9206 --- loss: 0.695993, loss_ss: 0.669511, loss_d: 0.026482
0.9590 --- loss: 0.688185, loss_ss: 0.588900, loss_d: 0.099285
0.9973 --- loss: 0.842707, loss_ss: 0.733792, loss_d: 0.108915
Epoch finished! Loss: 0.8511317123587315
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.9086021505376344
             precision    recall  f1-score   support

        0.0       1.00      1.00      1.00       240
        1.0       0.56      0.83      0.67         6
        2.0       0.90      0.91      0.90       439
        3.0       0.93      0.76      0.84       170
        4.0       0.73      0.95      0.83        75

avg / total       0.91      0.91      0.91       930
 


====== chc014-nsrr ======
    acc %   sen %  spec %   ppr %  f1-score
0  100.00  100.00  100.00  100.00    100.00
1   99.46   83.33   99.57   55.56     66.67
2   90.86   91.12   90.63   89.69     90.40
3   94.62   75.88   98.82   93.48     83.77
4   96.77   94.67   96.96   73.20     82.56
Total accuracy: 90.86%
Average sen: 89.00%
Average spec: 97.19%
Macro f1-score: 84.68%
Diagnosis acc on 15mins: 0.8709677419354839
[0.02170249 0.55619723 0.33103028 0.23496059 0.00640903 0.32001671
 0.33684474 0.97431731 0.4622449  0.00705222 0.01582904 0.31184995
 0.03858966 0.27468285 0.02290456 0.05309813 0.91981995 0.0484463
 0.07100603 0.02301257 0.05239946 0.06712037 0.56342924 0.44580802
 0.49410638 0.10068408 0.14007977 0.15785538 0.17975125 0.06770424
 0.29764891]
pred: 0.24505166599767342, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.382885, loss_ss: 1.667364, loss_d: 0.715521
0.0384 --- loss: 2.360837, loss_ss: 1.627154, loss_d: 0.733683
0.0767 --- loss: 2.076959, loss_ss: 1.371831, loss_d: 0.705129
0.1151 --- loss: 1.905699, loss_ss: 1.560377, loss_d: 0.345322
0.1534 --- loss: 2.046452, loss_ss: 1.372737, loss_d: 0.673715
0.1918 --- loss: 1.980224, loss_ss: 1.598637, loss_d: 0.381588
0.2301 --- loss: 1.888419, loss_ss: 1.320395, loss_d: 0.568024
0.2685 --- loss: 1.842504, loss_ss: 1.290631, loss_d: 0.551873
0.3069 --- loss: 1.902563, loss_ss: 1.383100, loss_d: 0.519463
0.3452 --- loss: 1.717071, loss_ss: 1.240265, loss_d: 0.476806
0.3836 --- loss: 1.738397, loss_ss: 1.121394, loss_d: 0.617004
0.4219 --- loss: 2.205839, loss_ss: 1.657073, loss_d: 0.548765
0.4603 --- loss: 1.479363, loss_ss: 1.100262, loss_d: 0.379101
0.4987 --- loss: 1.820650, loss_ss: 1.279717, loss_d: 0.540932
0.5370 --- loss: 1.799408, loss_ss: 1.177484, loss_d: 0.621924
0.5754 --- loss: 2.032723, loss_ss: 1.480608, loss_d: 0.552115
0.6137 --- loss: 2.224510, loss_ss: 1.272744, loss_d: 0.951766
0.6521 --- loss: 1.789984, loss_ss: 1.015862, loss_d: 0.774122
0.6904 --- loss: 1.409342, loss_ss: 1.092534, loss_d: 0.316808
0.7288 --- loss: 1.669276, loss_ss: 1.485490, loss_d: 0.183786
0.7672 --- loss: 1.332935, loss_ss: 1.101141, loss_d: 0.231794
0.8055 --- loss: 2.000148, loss_ss: 1.135872, loss_d: 0.864276
0.8439 --- loss: 1.630147, loss_ss: 1.251614, loss_d: 0.378532
0.8822 --- loss: 1.644986, loss_ss: 1.319266, loss_d: 0.325721
0.9206 --- loss: 1.647938, loss_ss: 1.334793, loss_d: 0.313145
0.9590 --- loss: 1.668097, loss_ss: 1.088758, loss_d: 0.579338
0.9973 --- loss: 1.707999, loss_ss: 1.432470, loss_d: 0.275529
Epoch finished! Loss: 1.8384226157115056
Starting epoch 2/10.
0.0000 --- loss: 1.294610, loss_ss: 1.159191, loss_d: 0.135419
0.0384 --- loss: 1.341707, loss_ss: 1.175114, loss_d: 0.166593
0.0767 --- loss: 1.793546, loss_ss: 1.269005, loss_d: 0.524541
0.1151 --- loss: 1.358557, loss_ss: 1.104121, loss_d: 0.254437
0.1534 --- loss: 1.411173, loss_ss: 1.184317, loss_d: 0.226855
0.1918 --- loss: 1.987187, loss_ss: 1.553490, loss_d: 0.433696
0.2301 --- loss: 1.543232, loss_ss: 1.294450, loss_d: 0.248782
0.2685 --- loss: 1.553378, loss_ss: 1.054989, loss_d: 0.498389
0.3069 --- loss: 1.322908, loss_ss: 0.935734, loss_d: 0.387173
0.3452 --- loss: 1.188937, loss_ss: 1.100072, loss_d: 0.088865
0.3836 --- loss: 1.396556, loss_ss: 1.058214, loss_d: 0.338342
0.4219 --- loss: 1.237513, loss_ss: 1.090060, loss_d: 0.147453
0.4603 --- loss: 1.692917, loss_ss: 1.372066, loss_d: 0.320851
0.4987 --- loss: 1.523013, loss_ss: 1.146293, loss_d: 0.376720
0.5370 --- loss: 1.300386, loss_ss: 1.104089, loss_d: 0.196297
0.5754 --- loss: 1.282468, loss_ss: 1.031706, loss_d: 0.250762
0.6137 --- loss: 1.207376, loss_ss: 0.897698, loss_d: 0.309678
0.6521 --- loss: 1.410511, loss_ss: 1.111161, loss_d: 0.299349
0.6904 --- loss: 1.749641, loss_ss: 0.863242, loss_d: 0.886398
0.7288 --- loss: 1.733837, loss_ss: 1.452081, loss_d: 0.281756
0.7672 --- loss: 1.742570, loss_ss: 1.449617, loss_d: 0.292953
0.8055 --- loss: 1.297568, loss_ss: 0.985358, loss_d: 0.312210
0.8439 --- loss: 1.215294, loss_ss: 0.987010, loss_d: 0.228283
0.8822 --- loss: 1.013284, loss_ss: 0.948630, loss_d: 0.064655
0.9206 --- loss: 1.120764, loss_ss: 1.075928, loss_d: 0.044837
0.9590 --- loss: 1.399462, loss_ss: 1.218192, loss_d: 0.181270
0.9973 --- loss: 1.578359, loss_ss: 1.385999, loss_d: 0.192360
Epoch finished! Loss: 1.4333856484064689
Starting epoch 3/10.
0.0000 --- loss: 1.827939, loss_ss: 1.191062, loss_d: 0.636878
0.0384 --- loss: 1.103547, loss_ss: 0.923627, loss_d: 0.179919
0.0767 --- loss: 1.158367, loss_ss: 0.914520, loss_d: 0.243847
0.1151 --- loss: 1.229385, loss_ss: 1.086817, loss_d: 0.142567
0.1534 --- loss: 1.235911, loss_ss: 0.973602, loss_d: 0.262309
0.1918 --- loss: 1.243199, loss_ss: 0.845381, loss_d: 0.397819
0.2301 --- loss: 1.432796, loss_ss: 1.076708, loss_d: 0.356088
0.2685 --- loss: 1.073512, loss_ss: 0.791339, loss_d: 0.282173
0.3069 --- loss: 1.112799, loss_ss: 1.011379, loss_d: 0.101420
0.3452 --- loss: 1.144886, loss_ss: 1.001722, loss_d: 0.143163
0.3836 --- loss: 1.175001, loss_ss: 1.139032, loss_d: 0.035969
0.4219 --- loss: 1.387725, loss_ss: 0.855080, loss_d: 0.532646
0.4603 --- loss: 1.349359, loss_ss: 1.193808, loss_d: 0.155551
0.4987 --- loss: 1.188720, loss_ss: 1.066604, loss_d: 0.122116
0.5370 --- loss: 1.186614, loss_ss: 1.146834, loss_d: 0.039780
0.5754 --- loss: 1.330277, loss_ss: 0.934054, loss_d: 0.396223
0.6137 --- loss: 1.374994, loss_ss: 1.165983, loss_d: 0.209011
0.6521 --- loss: 1.132561, loss_ss: 0.804868, loss_d: 0.327694
0.6904 --- loss: 1.237001, loss_ss: 0.983403, loss_d: 0.253598
0.7288 --- loss: 1.037927, loss_ss: 0.930029, loss_d: 0.107898
0.7672 --- loss: 1.239533, loss_ss: 1.026684, loss_d: 0.212849
0.8055 --- loss: 1.176775, loss_ss: 0.979943, loss_d: 0.196832
0.8439 --- loss: 1.190809, loss_ss: 0.918318, loss_d: 0.272491
0.8822 --- loss: 1.096864, loss_ss: 0.940643, loss_d: 0.156221
0.9206 --- loss: 1.036303, loss_ss: 0.759249, loss_d: 0.277055
0.9590 --- loss: 0.952760, loss_ss: 0.810209, loss_d: 0.142551
0.9973 --- loss: 1.459641, loss_ss: 0.683574, loss_d: 0.776067
Epoch finished! Loss: 1.2077728904210605
Starting epoch 4/10.
0.0000 --- loss: 1.236761, loss_ss: 0.928735, loss_d: 0.308026
0.0384 --- loss: 0.884970, loss_ss: 0.848527, loss_d: 0.036443
0.0767 --- loss: 1.285205, loss_ss: 1.043246, loss_d: 0.241959
0.1151 --- loss: 1.002981, loss_ss: 0.734863, loss_d: 0.268118
0.1534 --- loss: 1.024988, loss_ss: 0.902127, loss_d: 0.122861
0.1918 --- loss: 1.488199, loss_ss: 1.403742, loss_d: 0.084457
0.2301 --- loss: 0.786954, loss_ss: 0.743793, loss_d: 0.043161
0.2685 --- loss: 1.327973, loss_ss: 0.905991, loss_d: 0.421983
0.3069 --- loss: 1.794287, loss_ss: 0.820799, loss_d: 0.973488
0.3452 --- loss: 1.000219, loss_ss: 0.745601, loss_d: 0.254618
0.3836 --- loss: 0.823782, loss_ss: 0.768758, loss_d: 0.055024
0.4219 --- loss: 0.891162, loss_ss: 0.736035, loss_d: 0.155128
0.4603 --- loss: 1.338561, loss_ss: 0.906573, loss_d: 0.431988
0.4987 --- loss: 0.882041, loss_ss: 0.666198, loss_d: 0.215843
0.5370 --- loss: 1.082842, loss_ss: 0.878295, loss_d: 0.204547
0.5754 --- loss: 0.826233, loss_ss: 0.804425, loss_d: 0.021808
0.6137 --- loss: 0.823865, loss_ss: 0.784523, loss_d: 0.039343
0.6521 --- loss: 0.915305, loss_ss: 0.828698, loss_d: 0.086607
0.6904 --- loss: 1.567597, loss_ss: 1.232268, loss_d: 0.335329
0.7288 --- loss: 1.125531, loss_ss: 0.821469, loss_d: 0.304062
0.7672 --- loss: 0.846108, loss_ss: 0.801805, loss_d: 0.044303
0.8055 --- loss: 0.898966, loss_ss: 0.876174, loss_d: 0.022792
0.8439 --- loss: 0.698006, loss_ss: 0.578447, loss_d: 0.119559
0.8822 --- loss: 0.917091, loss_ss: 0.850276, loss_d: 0.066815
0.9206 --- loss: 1.017923, loss_ss: 0.910100, loss_d: 0.107823
0.9590 --- loss: 1.279894, loss_ss: 1.044181, loss_d: 0.235713
0.9973 --- loss: 0.710809, loss_ss: 0.670824, loss_d: 0.039985
Epoch finished! Loss: 1.07026115999772
Starting epoch 5/10.
0.0000 --- loss: 0.859182, loss_ss: 0.811791, loss_d: 0.047392
0.0384 --- loss: 0.949808, loss_ss: 0.853641, loss_d: 0.096167
0.0767 --- loss: 0.835475, loss_ss: 0.779497, loss_d: 0.055978
0.1151 --- loss: 0.931809, loss_ss: 0.771806, loss_d: 0.160003
0.1534 --- loss: 0.983298, loss_ss: 0.867710, loss_d: 0.115588
0.1918 --- loss: 0.940622, loss_ss: 0.896971, loss_d: 0.043651
0.2301 --- loss: 0.898771, loss_ss: 0.880520, loss_d: 0.018250
0.2685 --- loss: 0.893523, loss_ss: 0.808811, loss_d: 0.084713
0.3069 --- loss: 1.045207, loss_ss: 0.973529, loss_d: 0.071678
0.3452 --- loss: 0.807640, loss_ss: 0.664899, loss_d: 0.142741
0.3836 --- loss: 0.817513, loss_ss: 0.749511, loss_d: 0.068002
0.4219 --- loss: 0.844169, loss_ss: 0.735121, loss_d: 0.109049
0.4603 --- loss: 1.047274, loss_ss: 1.017244, loss_d: 0.030030
0.4987 --- loss: 1.334958, loss_ss: 0.969702, loss_d: 0.365256
0.5370 --- loss: 0.831643, loss_ss: 0.759338, loss_d: 0.072305
0.5754 --- loss: 0.761332, loss_ss: 0.728578, loss_d: 0.032754
0.6137 --- loss: 0.985831, loss_ss: 0.873638, loss_d: 0.112193
0.6521 --- loss: 0.830212, loss_ss: 0.627330, loss_d: 0.202882
0.6904 --- loss: 0.974695, loss_ss: 0.812427, loss_d: 0.162267
0.7288 --- loss: 0.676545, loss_ss: 0.626119, loss_d: 0.050426
0.7672 --- loss: 0.721246, loss_ss: 0.621607, loss_d: 0.099639
0.8055 --- loss: 1.054830, loss_ss: 0.823707, loss_d: 0.231123
0.8439 --- loss: 0.847588, loss_ss: 0.654000, loss_d: 0.193588
0.8822 --- loss: 1.392873, loss_ss: 1.332669, loss_d: 0.060203
0.9206 --- loss: 0.968714, loss_ss: 0.811627, loss_d: 0.157087
0.9590 --- loss: 0.845605, loss_ss: 0.686613, loss_d: 0.158992
0.9973 --- loss: 1.042915, loss_ss: 0.925153, loss_d: 0.117762
Epoch finished! Loss: 1.0019809890251894
Starting epoch 6/10.
0.0000 --- loss: 0.877435, loss_ss: 0.730181, loss_d: 0.147254
0.0384 --- loss: 0.720194, loss_ss: 0.713845, loss_d: 0.006349
0.0767 --- loss: 0.671593, loss_ss: 0.636818, loss_d: 0.034775
0.1151 --- loss: 1.051527, loss_ss: 0.897769, loss_d: 0.153757
0.1534 --- loss: 0.679167, loss_ss: 0.631138, loss_d: 0.048029
0.1918 --- loss: 0.786874, loss_ss: 0.728544, loss_d: 0.058330
0.2301 --- loss: 0.957087, loss_ss: 0.896991, loss_d: 0.060096
0.2685 --- loss: 0.990529, loss_ss: 0.967372, loss_d: 0.023157
0.3069 --- loss: 0.866425, loss_ss: 0.758597, loss_d: 0.107828
0.3452 --- loss: 0.866446, loss_ss: 0.669867, loss_d: 0.196579
0.3836 --- loss: 1.185105, loss_ss: 0.846792, loss_d: 0.338313
0.4219 --- loss: 0.860307, loss_ss: 0.815721, loss_d: 0.044585
0.4603 --- loss: 0.742150, loss_ss: 0.709803, loss_d: 0.032347
0.4987 --- loss: 1.348406, loss_ss: 0.898976, loss_d: 0.449429
0.5370 --- loss: 0.724494, loss_ss: 0.702134, loss_d: 0.022360
0.5754 --- loss: 0.701588, loss_ss: 0.695557, loss_d: 0.006031
0.6137 --- loss: 1.451299, loss_ss: 0.854597, loss_d: 0.596703
0.6521 --- loss: 1.414214, loss_ss: 1.176554, loss_d: 0.237661
0.6904 --- loss: 0.935882, loss_ss: 0.722009, loss_d: 0.213873
0.7288 --- loss: 0.803474, loss_ss: 0.756013, loss_d: 0.047460
0.7672 --- loss: 0.868544, loss_ss: 0.751540, loss_d: 0.117004
0.8055 --- loss: 0.857075, loss_ss: 0.812263, loss_d: 0.044812
0.8439 --- loss: 0.768320, loss_ss: 0.754705, loss_d: 0.013615
0.8822 --- loss: 0.866219, loss_ss: 0.795943, loss_d: 0.070276
0.9206 --- loss: 0.964601, loss_ss: 0.902589, loss_d: 0.062013
0.9590 --- loss: 0.732934, loss_ss: 0.718414, loss_d: 0.014520
0.9973 --- loss: 0.975978, loss_ss: 0.933360, loss_d: 0.042618
Epoch finished! Loss: 0.9436329103433169
Starting epoch 7/10.
0.0000 --- loss: 1.071647, loss_ss: 0.810630, loss_d: 0.261017
0.0384 --- loss: 0.974883, loss_ss: 0.804411, loss_d: 0.170473
0.0767 --- loss: 0.666291, loss_ss: 0.653777, loss_d: 0.012515
0.1151 --- loss: 0.567946, loss_ss: 0.553529, loss_d: 0.014418
0.1534 --- loss: 0.628321, loss_ss: 0.547223, loss_d: 0.081098
0.1918 --- loss: 0.795481, loss_ss: 0.735231, loss_d: 0.060249
0.2301 --- loss: 0.790555, loss_ss: 0.751386, loss_d: 0.039169
0.2685 --- loss: 0.959128, loss_ss: 0.915690, loss_d: 0.043437
0.3069 --- loss: 0.610198, loss_ss: 0.595919, loss_d: 0.014279
0.3452 --- loss: 1.028181, loss_ss: 0.852170, loss_d: 0.176012
0.3836 --- loss: 1.334754, loss_ss: 0.683216, loss_d: 0.651538
0.4219 --- loss: 0.684114, loss_ss: 0.663950, loss_d: 0.020163
0.4603 --- loss: 0.845330, loss_ss: 0.793576, loss_d: 0.051754
0.4987 --- loss: 0.596633, loss_ss: 0.554554, loss_d: 0.042079
0.5370 --- loss: 0.858611, loss_ss: 0.840366, loss_d: 0.018245
0.5754 --- loss: 0.868968, loss_ss: 0.516720, loss_d: 0.352248
0.6137 --- loss: 0.974864, loss_ss: 0.937137, loss_d: 0.037727
0.6521 --- loss: 0.757107, loss_ss: 0.598424, loss_d: 0.158683
0.6904 --- loss: 0.657412, loss_ss: 0.497634, loss_d: 0.159778
0.7288 --- loss: 1.123558, loss_ss: 0.540034, loss_d: 0.583524
0.7672 --- loss: 0.831711, loss_ss: 0.664012, loss_d: 0.167699
0.8055 --- loss: 0.784527, loss_ss: 0.715811, loss_d: 0.068716
0.8439 --- loss: 0.731426, loss_ss: 0.618838, loss_d: 0.112588
0.8822 --- loss: 0.752315, loss_ss: 0.718620, loss_d: 0.033695
0.9206 --- loss: 0.794739, loss_ss: 0.749846, loss_d: 0.044893
0.9590 --- loss: 0.759222, loss_ss: 0.693182, loss_d: 0.066040
0.9973 --- loss: 1.132807, loss_ss: 1.113989, loss_d: 0.018818
Epoch finished! Loss: 0.8662247749475332
Starting epoch 8/10.
0.0000 --- loss: 0.739858, loss_ss: 0.670865, loss_d: 0.068993
0.0384 --- loss: 0.759780, loss_ss: 0.686561, loss_d: 0.073219
0.0767 --- loss: 0.683521, loss_ss: 0.680941, loss_d: 0.002580
0.1151 --- loss: 0.870557, loss_ss: 0.864317, loss_d: 0.006240
0.1534 --- loss: 0.695503, loss_ss: 0.582218, loss_d: 0.113285
0.1918 --- loss: 1.049675, loss_ss: 0.993873, loss_d: 0.055803
0.2301 --- loss: 0.944614, loss_ss: 0.743111, loss_d: 0.201503
0.2685 --- loss: 0.866580, loss_ss: 0.859004, loss_d: 0.007575
0.3069 --- loss: 1.112077, loss_ss: 1.066244, loss_d: 0.045833
0.3452 --- loss: 0.781386, loss_ss: 0.763634, loss_d: 0.017752
0.3836 --- loss: 0.824501, loss_ss: 0.818081, loss_d: 0.006420
0.4219 --- loss: 1.615440, loss_ss: 0.963711, loss_d: 0.651729
0.4603 --- loss: 1.446931, loss_ss: 1.182231, loss_d: 0.264700
0.4987 --- loss: 0.740013, loss_ss: 0.597099, loss_d: 0.142915
0.5370 --- loss: 0.744752, loss_ss: 0.725284, loss_d: 0.019467
0.5754 --- loss: 0.851656, loss_ss: 0.846075, loss_d: 0.005581
0.6137 --- loss: 0.844403, loss_ss: 0.840061, loss_d: 0.004343
0.6521 --- loss: 0.920885, loss_ss: 0.897197, loss_d: 0.023688
0.6904 --- loss: 0.801184, loss_ss: 0.646769, loss_d: 0.154415
0.7288 --- loss: 0.968488, loss_ss: 0.937784, loss_d: 0.030704
0.7672 --- loss: 0.902456, loss_ss: 0.898658, loss_d: 0.003799
0.8055 --- loss: 1.400669, loss_ss: 0.798347, loss_d: 0.602323
0.8439 --- loss: 0.686489, loss_ss: 0.677553, loss_d: 0.008935
0.8822 --- loss: 0.959644, loss_ss: 0.761871, loss_d: 0.197773
0.9206 --- loss: 0.855690, loss_ss: 0.809157, loss_d: 0.046533
0.9590 --- loss: 0.803658, loss_ss: 0.798164, loss_d: 0.005494
0.9973 --- loss: 1.222194, loss_ss: 0.876733, loss_d: 0.345460
Epoch finished! Loss: 0.8627188907219814
Starting epoch 9/10.
0.0000 --- loss: 1.004937, loss_ss: 0.976373, loss_d: 0.028564
0.0384 --- loss: 0.965494, loss_ss: 0.962172, loss_d: 0.003322
0.0767 --- loss: 0.739673, loss_ss: 0.694291, loss_d: 0.045382
0.1151 --- loss: 1.113611, loss_ss: 1.014239, loss_d: 0.099372
0.1534 --- loss: 0.831079, loss_ss: 0.823459, loss_d: 0.007620
0.1918 --- loss: 1.136615, loss_ss: 0.968273, loss_d: 0.168342
0.2301 --- loss: 0.834236, loss_ss: 0.714498, loss_d: 0.119738
0.2685 --- loss: 0.688548, loss_ss: 0.682940, loss_d: 0.005608
0.3069 --- loss: 1.062500, loss_ss: 1.060442, loss_d: 0.002058
0.3452 --- loss: 0.840338, loss_ss: 0.796197, loss_d: 0.044141
0.3836 --- loss: 0.617357, loss_ss: 0.611532, loss_d: 0.005825
0.4219 --- loss: 0.608091, loss_ss: 0.587923, loss_d: 0.020168
0.4603 --- loss: 0.949472, loss_ss: 0.901282, loss_d: 0.048190
0.4987 --- loss: 0.580100, loss_ss: 0.537891, loss_d: 0.042209
0.5370 --- loss: 0.806366, loss_ss: 0.784685, loss_d: 0.021681
0.5754 --- loss: 0.676523, loss_ss: 0.657592, loss_d: 0.018931
0.6137 --- loss: 0.623708, loss_ss: 0.620872, loss_d: 0.002836
0.6521 --- loss: 0.664901, loss_ss: 0.659517, loss_d: 0.005384
0.6904 --- loss: 1.383384, loss_ss: 1.367424, loss_d: 0.015960
0.7288 --- loss: 0.765276, loss_ss: 0.764565, loss_d: 0.000710
0.7672 --- loss: 1.002939, loss_ss: 0.925809, loss_d: 0.077131
0.8055 --- loss: 0.736938, loss_ss: 0.736682, loss_d: 0.000256
0.8439 --- loss: 0.923059, loss_ss: 0.913740, loss_d: 0.009319
0.8822 --- loss: 0.645142, loss_ss: 0.637273, loss_d: 0.007869
0.9206 --- loss: 0.884144, loss_ss: 0.877951, loss_d: 0.006193
0.9590 --- loss: 1.544334, loss_ss: 1.038079, loss_d: 0.506255
0.9973 --- loss: 0.741390, loss_ss: 0.684999, loss_d: 0.056390
Epoch finished! Loss: 0.8161828878980416
Starting epoch 10/10.
0.0000 --- loss: 0.555360, loss_ss: 0.549070, loss_d: 0.006290
0.0384 --- loss: 0.764575, loss_ss: 0.651727, loss_d: 0.112848
0.0767 --- loss: 0.957208, loss_ss: 0.800669, loss_d: 0.156539
0.1151 --- loss: 0.732914, loss_ss: 0.724122, loss_d: 0.008792
0.1534 --- loss: 0.729757, loss_ss: 0.676213, loss_d: 0.053544
0.1918 --- loss: 0.803882, loss_ss: 0.523981, loss_d: 0.279901
0.2301 --- loss: 1.148244, loss_ss: 0.627822, loss_d: 0.520423
0.2685 --- loss: 0.504302, loss_ss: 0.500810, loss_d: 0.003492
0.3069 --- loss: 0.820452, loss_ss: 0.817646, loss_d: 0.002806
0.3452 --- loss: 1.186425, loss_ss: 0.823423, loss_d: 0.363002
0.3836 --- loss: 0.617722, loss_ss: 0.591474, loss_d: 0.026248
0.4219 --- loss: 1.018868, loss_ss: 0.951547, loss_d: 0.067321
0.4603 --- loss: 0.708717, loss_ss: 0.416795, loss_d: 0.291922
0.4987 --- loss: 0.844438, loss_ss: 0.716524, loss_d: 0.127914
0.5370 --- loss: 0.617916, loss_ss: 0.587012, loss_d: 0.030904
0.5754 --- loss: 0.587259, loss_ss: 0.584267, loss_d: 0.002992
0.6137 --- loss: 0.880344, loss_ss: 0.878915, loss_d: 0.001429
0.6521 --- loss: 0.596448, loss_ss: 0.564282, loss_d: 0.032165
0.6904 --- loss: 0.583429, loss_ss: 0.567938, loss_d: 0.015491
0.7288 --- loss: 0.673779, loss_ss: 0.670208, loss_d: 0.003571
0.7672 --- loss: 0.642622, loss_ss: 0.642112, loss_d: 0.000510
0.8055 --- loss: 0.787384, loss_ss: 0.786964, loss_d: 0.000420
0.8439 --- loss: 0.904608, loss_ss: 0.902841, loss_d: 0.001766
0.8822 --- loss: 0.495281, loss_ss: 0.493833, loss_d: 0.001448
0.9206 --- loss: 0.714770, loss_ss: 0.657382, loss_d: 0.057388
0.9590 --- loss: 0.926013, loss_ss: 0.670662, loss_d: 0.255351
0.9973 --- loss: 1.287193, loss_ss: 0.738677, loss_d: 0.548516
Epoch finished! Loss: 0.8132929522257585
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7752688172043011
             precision    recall  f1-score   support

        0.0       0.34      1.00      0.50        38
        1.0       0.41      0.36      0.38        83
        2.0       0.86      0.87      0.87       502
        3.0       1.00      0.76      0.86       166
        4.0       0.81      0.63      0.71       141

avg / total       0.82      0.78      0.78       930
 


====== chc015-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  91.94  100.00   91.59   33.63     50.33
1  89.68   36.14   94.92   41.10     38.46
2  85.59   87.25   83.64   86.22     86.73
3  95.70   75.90  100.00  100.00     86.30
4  92.15   63.12   97.34   80.91     70.92
Total accuracy: 77.53%
Average sen: 72.48%
Average spec: 93.50%
Macro f1-score: 66.55%
Diagnosis acc on 15mins: 0.03225806451612903
[0.93248695 0.9917624  0.83146977 0.95992547 0.99947959 0.99990356
 0.4094049  0.99999213 0.99999475 0.99895465 0.99630839 0.97399479
 0.75685728 0.99887568 0.99999928 0.99996638 0.99954212 0.99936575
 0.99970347 0.99999642 0.99998009 0.99972695 0.997343   0.99999237
 0.99999928 0.9999764  0.99984658 0.99996066 0.99999988 1.
 0.99999988]
pred: 0.9627357692487778, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.428409, loss_ss: 1.771080, loss_d: 0.657328
0.0384 --- loss: 2.256189, loss_ss: 1.586259, loss_d: 0.669931
0.0767 --- loss: 1.967980, loss_ss: 1.612283, loss_d: 0.355697
0.1151 --- loss: 2.433613, loss_ss: 1.657004, loss_d: 0.776609
0.1534 --- loss: 2.327213, loss_ss: 1.644883, loss_d: 0.682330
0.1918 --- loss: 1.998619, loss_ss: 1.542146, loss_d: 0.456473
0.2301 --- loss: 2.079371, loss_ss: 1.469100, loss_d: 0.610271
0.2685 --- loss: 2.047385, loss_ss: 1.464224, loss_d: 0.583161
0.3069 --- loss: 1.999227, loss_ss: 1.391679, loss_d: 0.607548
0.3452 --- loss: 1.936440, loss_ss: 1.414559, loss_d: 0.521882
0.3836 --- loss: 2.133259, loss_ss: 1.282160, loss_d: 0.851099
0.4219 --- loss: 1.909069, loss_ss: 1.318401, loss_d: 0.590667
0.4603 --- loss: 1.897594, loss_ss: 1.322025, loss_d: 0.575569
0.4987 --- loss: 1.561058, loss_ss: 1.229518, loss_d: 0.331540
0.5370 --- loss: 1.773469, loss_ss: 1.213991, loss_d: 0.559478
0.5754 --- loss: 1.754236, loss_ss: 1.216512, loss_d: 0.537723
0.6137 --- loss: 1.859582, loss_ss: 1.342903, loss_d: 0.516679
0.6521 --- loss: 1.650992, loss_ss: 1.212920, loss_d: 0.438071
0.6904 --- loss: 1.700631, loss_ss: 1.254823, loss_d: 0.445808
0.7288 --- loss: 1.549655, loss_ss: 1.088053, loss_d: 0.461602
0.7672 --- loss: 1.558036, loss_ss: 1.199192, loss_d: 0.358843
0.8055 --- loss: 1.490986, loss_ss: 1.142211, loss_d: 0.348774
0.8439 --- loss: 2.786785, loss_ss: 1.209024, loss_d: 1.577761
0.8822 --- loss: 1.456253, loss_ss: 1.085729, loss_d: 0.370524
0.9206 --- loss: 1.762509, loss_ss: 1.315893, loss_d: 0.446616
0.9590 --- loss: 1.523575, loss_ss: 1.301707, loss_d: 0.221868
0.9973 --- loss: 1.516164, loss_ss: 1.288733, loss_d: 0.227431
Epoch finished! Loss: 1.8633309290959286
Starting epoch 2/10.
0.0000 --- loss: 1.373469, loss_ss: 1.130508, loss_d: 0.242961
0.0384 --- loss: 1.225626, loss_ss: 1.085343, loss_d: 0.140282
0.0767 --- loss: 1.386287, loss_ss: 1.166196, loss_d: 0.220091
0.1151 --- loss: 1.318034, loss_ss: 1.249161, loss_d: 0.068873
0.1534 --- loss: 1.549104, loss_ss: 1.133943, loss_d: 0.415161
0.1918 --- loss: 1.470765, loss_ss: 1.115645, loss_d: 0.355120
0.2301 --- loss: 1.333502, loss_ss: 1.204323, loss_d: 0.129179
0.2685 --- loss: 1.471083, loss_ss: 1.178680, loss_d: 0.292403
0.3069 --- loss: 1.648648, loss_ss: 1.050349, loss_d: 0.598299
0.3452 --- loss: 1.111360, loss_ss: 0.989017, loss_d: 0.122343
0.3836 --- loss: 1.009686, loss_ss: 0.902166, loss_d: 0.107520
0.4219 --- loss: 1.625708, loss_ss: 1.183627, loss_d: 0.442082
0.4603 --- loss: 1.311803, loss_ss: 1.197280, loss_d: 0.114524
0.4987 --- loss: 1.457196, loss_ss: 1.056291, loss_d: 0.400905
0.5370 --- loss: 1.431340, loss_ss: 1.231374, loss_d: 0.199966
0.5754 --- loss: 0.993556, loss_ss: 0.920462, loss_d: 0.073095
0.6137 --- loss: 1.036625, loss_ss: 0.949184, loss_d: 0.087441
0.6521 --- loss: 1.040391, loss_ss: 0.876681, loss_d: 0.163710
0.6904 --- loss: 1.247408, loss_ss: 0.836168, loss_d: 0.411239
0.7288 --- loss: 1.037652, loss_ss: 0.898737, loss_d: 0.138915
0.7672 --- loss: 0.994461, loss_ss: 0.834137, loss_d: 0.160324
0.8055 --- loss: 1.899633, loss_ss: 0.824538, loss_d: 1.075095
0.8439 --- loss: 1.645313, loss_ss: 0.996368, loss_d: 0.648944
0.8822 --- loss: 1.336195, loss_ss: 1.093109, loss_d: 0.243086
0.9206 --- loss: 1.049913, loss_ss: 0.961840, loss_d: 0.088074
0.9590 --- loss: 1.051776, loss_ss: 0.927525, loss_d: 0.124251
0.9973 --- loss: 1.246309, loss_ss: 1.074407, loss_d: 0.171902
Epoch finished! Loss: 1.359253630729822
Starting epoch 3/10.
0.0000 --- loss: 1.626799, loss_ss: 1.277762, loss_d: 0.349037
0.0384 --- loss: 1.409055, loss_ss: 0.849326, loss_d: 0.559729
0.0767 --- loss: 1.326428, loss_ss: 1.171667, loss_d: 0.154761
0.1151 --- loss: 1.759238, loss_ss: 0.794304, loss_d: 0.964935
0.1534 --- loss: 1.481896, loss_ss: 0.993385, loss_d: 0.488511
0.1918 --- loss: 0.978025, loss_ss: 0.859845, loss_d: 0.118181
0.2301 --- loss: 1.149685, loss_ss: 0.677159, loss_d: 0.472525
0.2685 --- loss: 1.307681, loss_ss: 0.876136, loss_d: 0.431545
0.3069 --- loss: 1.306985, loss_ss: 0.906054, loss_d: 0.400931
0.3452 --- loss: 1.680141, loss_ss: 1.529688, loss_d: 0.150453
0.3836 --- loss: 1.149056, loss_ss: 1.089949, loss_d: 0.059107
0.4219 --- loss: 1.144118, loss_ss: 0.998063, loss_d: 0.146055
0.4603 --- loss: 0.953653, loss_ss: 0.913472, loss_d: 0.040181
0.4987 --- loss: 1.080749, loss_ss: 0.981583, loss_d: 0.099165
0.5370 --- loss: 0.876607, loss_ss: 0.842360, loss_d: 0.034247
0.5754 --- loss: 1.217335, loss_ss: 0.874870, loss_d: 0.342464
0.6137 --- loss: 1.018425, loss_ss: 0.694360, loss_d: 0.324066
0.6521 --- loss: 1.254360, loss_ss: 0.965840, loss_d: 0.288520
0.6904 --- loss: 0.983229, loss_ss: 0.872510, loss_d: 0.110720
0.7288 --- loss: 0.963545, loss_ss: 0.704151, loss_d: 0.259394
0.7672 --- loss: 1.166633, loss_ss: 0.776257, loss_d: 0.390375
0.8055 --- loss: 0.980237, loss_ss: 0.717770, loss_d: 0.262467
0.8439 --- loss: 1.083894, loss_ss: 1.028056, loss_d: 0.055838
0.8822 --- loss: 1.024581, loss_ss: 0.988139, loss_d: 0.036442
0.9206 --- loss: 0.808806, loss_ss: 0.745122, loss_d: 0.063684
0.9590 --- loss: 0.818085, loss_ss: 0.720623, loss_d: 0.097463
0.9973 --- loss: 1.169355, loss_ss: 1.117844, loss_d: 0.051511
Epoch finished! Loss: 1.143057345885497
Starting epoch 4/10.
0.0000 --- loss: 1.256427, loss_ss: 1.117750, loss_d: 0.138677
0.0384 --- loss: 0.827115, loss_ss: 0.759316, loss_d: 0.067799
0.0767 --- loss: 0.741830, loss_ss: 0.709058, loss_d: 0.032773
0.1151 --- loss: 1.200245, loss_ss: 0.900113, loss_d: 0.300132
0.1534 --- loss: 1.100091, loss_ss: 1.064126, loss_d: 0.035965
0.1918 --- loss: 1.031664, loss_ss: 0.837226, loss_d: 0.194437
0.2301 --- loss: 0.819702, loss_ss: 0.781271, loss_d: 0.038431
0.2685 --- loss: 1.118987, loss_ss: 1.047337, loss_d: 0.071651
0.3069 --- loss: 1.178076, loss_ss: 0.670374, loss_d: 0.507702
0.3452 --- loss: 1.075646, loss_ss: 0.685069, loss_d: 0.390577
0.3836 --- loss: 0.731848, loss_ss: 0.621483, loss_d: 0.110365
0.4219 --- loss: 0.920052, loss_ss: 0.653204, loss_d: 0.266848
0.4603 --- loss: 1.255418, loss_ss: 0.759019, loss_d: 0.496399
0.4987 --- loss: 1.107519, loss_ss: 0.971668, loss_d: 0.135851
0.5370 --- loss: 1.139011, loss_ss: 0.835412, loss_d: 0.303599
0.5754 --- loss: 0.902669, loss_ss: 0.889816, loss_d: 0.012853
0.6137 --- loss: 1.310702, loss_ss: 1.023167, loss_d: 0.287534
0.6521 --- loss: 2.351288, loss_ss: 0.732920, loss_d: 1.618369
0.6904 --- loss: 1.047806, loss_ss: 0.905330, loss_d: 0.142475
0.7288 --- loss: 1.301480, loss_ss: 0.958779, loss_d: 0.342701
0.7672 --- loss: 0.934842, loss_ss: 0.881845, loss_d: 0.052997
0.8055 --- loss: 1.085271, loss_ss: 0.916495, loss_d: 0.168776
0.8439 --- loss: 0.953520, loss_ss: 0.821950, loss_d: 0.131570
0.8822 --- loss: 1.177826, loss_ss: 1.097719, loss_d: 0.080107
0.9206 --- loss: 1.063929, loss_ss: 0.838165, loss_d: 0.225764
0.9590 --- loss: 0.799243, loss_ss: 0.727905, loss_d: 0.071337
0.9973 --- loss: 1.259791, loss_ss: 1.072763, loss_d: 0.187028
Epoch finished! Loss: 1.035323265194893
Starting epoch 5/10.
0.0000 --- loss: 0.823392, loss_ss: 0.770963, loss_d: 0.052429
0.0384 --- loss: 0.854429, loss_ss: 0.750453, loss_d: 0.103976
0.0767 --- loss: 0.661179, loss_ss: 0.580055, loss_d: 0.081124
0.1151 --- loss: 0.903102, loss_ss: 0.891769, loss_d: 0.011334
0.1534 --- loss: 0.828311, loss_ss: 0.788685, loss_d: 0.039626
0.1918 --- loss: 0.803524, loss_ss: 0.703914, loss_d: 0.099610
0.2301 --- loss: 0.650047, loss_ss: 0.613238, loss_d: 0.036809
0.2685 --- loss: 0.818039, loss_ss: 0.705293, loss_d: 0.112746
0.3069 --- loss: 0.664905, loss_ss: 0.599687, loss_d: 0.065219
0.3452 --- loss: 0.973785, loss_ss: 0.955893, loss_d: 0.017892
0.3836 --- loss: 0.636147, loss_ss: 0.581398, loss_d: 0.054749
0.4219 --- loss: 0.820379, loss_ss: 0.775631, loss_d: 0.044748
0.4603 --- loss: 0.935690, loss_ss: 0.879113, loss_d: 0.056578
0.4987 --- loss: 0.919996, loss_ss: 0.917935, loss_d: 0.002061
0.5370 --- loss: 1.644600, loss_ss: 0.949467, loss_d: 0.695133
0.5754 --- loss: 0.723122, loss_ss: 0.666508, loss_d: 0.056614
0.6137 --- loss: 0.780925, loss_ss: 0.664254, loss_d: 0.116671
0.6521 --- loss: 0.819628, loss_ss: 0.672527, loss_d: 0.147102
0.6904 --- loss: 1.264869, loss_ss: 0.987267, loss_d: 0.277602
0.7288 --- loss: 1.089624, loss_ss: 0.776312, loss_d: 0.313312
0.7672 --- loss: 1.034945, loss_ss: 0.905712, loss_d: 0.129233
0.8055 --- loss: 1.054839, loss_ss: 0.875200, loss_d: 0.179639
0.8439 --- loss: 0.979580, loss_ss: 0.740898, loss_d: 0.238682
0.8822 --- loss: 1.187103, loss_ss: 0.804832, loss_d: 0.382271
0.9206 --- loss: 1.002827, loss_ss: 0.869590, loss_d: 0.133238
0.9590 --- loss: 1.538464, loss_ss: 1.333659, loss_d: 0.204806
0.9973 --- loss: 2.158004, loss_ss: 1.786287, loss_d: 0.371716
Epoch finished! Loss: 0.9784576131747319
Starting epoch 6/10.
0.0000 --- loss: 0.880865, loss_ss: 0.829891, loss_d: 0.050974
0.0384 --- loss: 0.840832, loss_ss: 0.653385, loss_d: 0.187447
0.0767 --- loss: 1.154432, loss_ss: 0.839134, loss_d: 0.315298
0.1151 --- loss: 1.494366, loss_ss: 0.925603, loss_d: 0.568763
0.1534 --- loss: 0.626131, loss_ss: 0.604888, loss_d: 0.021243
0.1918 --- loss: 0.847711, loss_ss: 0.610336, loss_d: 0.237375
0.2301 --- loss: 0.705360, loss_ss: 0.621589, loss_d: 0.083771
0.2685 --- loss: 1.102264, loss_ss: 1.045541, loss_d: 0.056723
0.3069 --- loss: 0.704928, loss_ss: 0.607074, loss_d: 0.097854
0.3452 --- loss: 0.783005, loss_ss: 0.737693, loss_d: 0.045312
0.3836 --- loss: 0.896656, loss_ss: 0.809023, loss_d: 0.087632
0.4219 --- loss: 1.019581, loss_ss: 0.864078, loss_d: 0.155503
0.4603 --- loss: 1.526956, loss_ss: 0.739898, loss_d: 0.787058
0.4987 --- loss: 0.901316, loss_ss: 0.843155, loss_d: 0.058160
0.5370 --- loss: 0.772822, loss_ss: 0.685562, loss_d: 0.087260
0.5754 --- loss: 0.898344, loss_ss: 0.849373, loss_d: 0.048970
0.6137 --- loss: 0.787174, loss_ss: 0.772217, loss_d: 0.014956
0.6521 --- loss: 0.891521, loss_ss: 0.809015, loss_d: 0.082505
0.6904 --- loss: 1.228264, loss_ss: 0.711241, loss_d: 0.517024
0.7288 --- loss: 0.885958, loss_ss: 0.854609, loss_d: 0.031349
0.7672 --- loss: 0.824559, loss_ss: 0.796001, loss_d: 0.028558
0.8055 --- loss: 1.077271, loss_ss: 1.007156, loss_d: 0.070115
0.8439 --- loss: 1.086530, loss_ss: 0.835113, loss_d: 0.251416
0.8822 --- loss: 0.858094, loss_ss: 0.808758, loss_d: 0.049336
0.9206 --- loss: 0.492959, loss_ss: 0.483090, loss_d: 0.009869
0.9590 --- loss: 0.955070, loss_ss: 0.762577, loss_d: 0.192493
0.9973 --- loss: 0.890594, loss_ss: 0.844185, loss_d: 0.046409
Epoch finished! Loss: 0.9276577090987792
Starting epoch 7/10.
0.0000 --- loss: 0.930890, loss_ss: 0.871319, loss_d: 0.059571
0.0384 --- loss: 0.976970, loss_ss: 0.942254, loss_d: 0.034716
0.0767 --- loss: 0.489854, loss_ss: 0.478263, loss_d: 0.011591
0.1151 --- loss: 0.565392, loss_ss: 0.535188, loss_d: 0.030204
0.1534 --- loss: 0.577955, loss_ss: 0.518260, loss_d: 0.059695
0.1918 --- loss: 0.915272, loss_ss: 0.837014, loss_d: 0.078258
0.2301 --- loss: 0.699539, loss_ss: 0.689091, loss_d: 0.010448
0.2685 --- loss: 0.843836, loss_ss: 0.760656, loss_d: 0.083180
0.3069 --- loss: 0.959375, loss_ss: 0.880593, loss_d: 0.078782
0.3452 --- loss: 1.248783, loss_ss: 0.976200, loss_d: 0.272584
0.3836 --- loss: 0.697979, loss_ss: 0.692685, loss_d: 0.005294
0.4219 --- loss: 0.913100, loss_ss: 0.845644, loss_d: 0.067456
0.4603 --- loss: 0.688585, loss_ss: 0.651255, loss_d: 0.037330
0.4987 --- loss: 0.903488, loss_ss: 0.876001, loss_d: 0.027487
0.5370 --- loss: 0.890157, loss_ss: 0.714741, loss_d: 0.175416
0.5754 --- loss: 0.811357, loss_ss: 0.797538, loss_d: 0.013819
0.6137 --- loss: 0.825257, loss_ss: 0.790447, loss_d: 0.034810
0.6521 --- loss: 0.671606, loss_ss: 0.647045, loss_d: 0.024561
0.6904 --- loss: 0.599597, loss_ss: 0.570212, loss_d: 0.029384
0.7288 --- loss: 0.714613, loss_ss: 0.700444, loss_d: 0.014168
0.7672 --- loss: 0.612999, loss_ss: 0.602683, loss_d: 0.010316
0.8055 --- loss: 0.868577, loss_ss: 0.858767, loss_d: 0.009810
0.8439 --- loss: 0.908543, loss_ss: 0.832279, loss_d: 0.076264
0.8822 --- loss: 0.786636, loss_ss: 0.757179, loss_d: 0.029457
0.9206 --- loss: 0.567898, loss_ss: 0.542040, loss_d: 0.025858
0.9590 --- loss: 0.590787, loss_ss: 0.537215, loss_d: 0.053571
0.9973 --- loss: 0.913150, loss_ss: 0.887159, loss_d: 0.025991
Epoch finished! Loss: 0.9008711117964524
Starting epoch 8/10.
0.0000 --- loss: 0.996143, loss_ss: 0.778542, loss_d: 0.217601
0.0384 --- loss: 0.848602, loss_ss: 0.780281, loss_d: 0.068321
0.0767 --- loss: 0.658655, loss_ss: 0.628745, loss_d: 0.029910
0.1151 --- loss: 1.365461, loss_ss: 0.684608, loss_d: 0.680853
0.1534 --- loss: 0.737767, loss_ss: 0.637726, loss_d: 0.100040
0.1918 --- loss: 1.330281, loss_ss: 0.926142, loss_d: 0.404139
0.2301 --- loss: 0.578395, loss_ss: 0.568139, loss_d: 0.010256
0.2685 --- loss: 0.671610, loss_ss: 0.653114, loss_d: 0.018496
0.3069 --- loss: 0.795196, loss_ss: 0.791855, loss_d: 0.003341
0.3452 --- loss: 0.832358, loss_ss: 0.817037, loss_d: 0.015320
0.3836 --- loss: 0.634758, loss_ss: 0.631251, loss_d: 0.003506
0.4219 --- loss: 0.633247, loss_ss: 0.498416, loss_d: 0.134831
0.4603 --- loss: 0.812165, loss_ss: 0.795985, loss_d: 0.016180
0.4987 --- loss: 1.017139, loss_ss: 1.003515, loss_d: 0.013624
0.5370 --- loss: 1.306913, loss_ss: 1.094868, loss_d: 0.212045
0.5754 --- loss: 0.680294, loss_ss: 0.652762, loss_d: 0.027532
0.6137 --- loss: 0.794921, loss_ss: 0.701796, loss_d: 0.093125
0.6521 --- loss: 0.996127, loss_ss: 0.979377, loss_d: 0.016750
0.6904 --- loss: 1.204531, loss_ss: 1.125949, loss_d: 0.078582
0.7288 --- loss: 0.920310, loss_ss: 0.721620, loss_d: 0.198690
0.7672 --- loss: 0.841438, loss_ss: 0.826552, loss_d: 0.014886
0.8055 --- loss: 1.020138, loss_ss: 0.946790, loss_d: 0.073348
0.8439 --- loss: 0.878478, loss_ss: 0.749739, loss_d: 0.128739
0.8822 --- loss: 0.671462, loss_ss: 0.629320, loss_d: 0.042142
0.9206 --- loss: 0.743198, loss_ss: 0.731315, loss_d: 0.011883
0.9590 --- loss: 0.653503, loss_ss: 0.647183, loss_d: 0.006319
0.9973 --- loss: 1.169997, loss_ss: 0.915742, loss_d: 0.254255
Epoch finished! Loss: 0.8635779043802848
Starting epoch 9/10.
0.0000 --- loss: 0.832439, loss_ss: 0.803556, loss_d: 0.028883
0.0384 --- loss: 0.664830, loss_ss: 0.574758, loss_d: 0.090072
0.0767 --- loss: 0.729379, loss_ss: 0.717177, loss_d: 0.012201
0.1151 --- loss: 1.153844, loss_ss: 0.802530, loss_d: 0.351314
0.1534 --- loss: 0.873723, loss_ss: 0.778639, loss_d: 0.095084
0.1918 --- loss: 0.945746, loss_ss: 0.907899, loss_d: 0.037846
0.2301 --- loss: 0.780453, loss_ss: 0.731337, loss_d: 0.049116
0.2685 --- loss: 0.923375, loss_ss: 0.903931, loss_d: 0.019444
0.3069 --- loss: 0.602064, loss_ss: 0.565856, loss_d: 0.036209
0.3452 --- loss: 0.872221, loss_ss: 0.832040, loss_d: 0.040180
0.3836 --- loss: 0.765172, loss_ss: 0.727413, loss_d: 0.037758
0.4219 --- loss: 0.684552, loss_ss: 0.646783, loss_d: 0.037769
0.4603 --- loss: 0.761428, loss_ss: 0.739689, loss_d: 0.021739
0.4987 --- loss: 0.864209, loss_ss: 0.768851, loss_d: 0.095358
0.5370 --- loss: 0.786091, loss_ss: 0.745677, loss_d: 0.040414
0.5754 --- loss: 0.896987, loss_ss: 0.730810, loss_d: 0.166177
0.6137 --- loss: 0.770177, loss_ss: 0.713325, loss_d: 0.056853
0.6521 --- loss: 1.040413, loss_ss: 1.010466, loss_d: 0.029946
0.6904 --- loss: 0.820062, loss_ss: 0.675917, loss_d: 0.144145
0.7288 --- loss: 0.783536, loss_ss: 0.767745, loss_d: 0.015791
0.7672 --- loss: 1.049986, loss_ss: 1.043995, loss_d: 0.005992
0.8055 --- loss: 0.549297, loss_ss: 0.460804, loss_d: 0.088493
0.8439 --- loss: 1.141068, loss_ss: 0.963429, loss_d: 0.177639
0.8822 --- loss: 1.107647, loss_ss: 0.850045, loss_d: 0.257602
0.9206 --- loss: 0.661850, loss_ss: 0.601492, loss_d: 0.060358
0.9590 --- loss: 0.978577, loss_ss: 0.857490, loss_d: 0.121086
0.9973 --- loss: 0.627341, loss_ss: 0.602814, loss_d: 0.024526
Epoch finished! Loss: 0.844357840029093
Starting epoch 10/10.
0.0000 --- loss: 0.743645, loss_ss: 0.649327, loss_d: 0.094318
0.0384 --- loss: 0.759169, loss_ss: 0.738437, loss_d: 0.020732
0.0767 --- loss: 0.640100, loss_ss: 0.624377, loss_d: 0.015723
0.1151 --- loss: 0.874127, loss_ss: 0.864985, loss_d: 0.009142
0.1534 --- loss: 0.878790, loss_ss: 0.875237, loss_d: 0.003553
0.1918 --- loss: 0.997194, loss_ss: 0.908785, loss_d: 0.088410
0.2301 --- loss: 1.118343, loss_ss: 0.709180, loss_d: 0.409163
0.2685 --- loss: 0.789912, loss_ss: 0.784553, loss_d: 0.005359
0.3069 --- loss: 0.619604, loss_ss: 0.481744, loss_d: 0.137860
0.3452 --- loss: 1.181626, loss_ss: 0.980804, loss_d: 0.200822
0.3836 --- loss: 0.735723, loss_ss: 0.728116, loss_d: 0.007606
0.4219 --- loss: 0.867040, loss_ss: 0.866437, loss_d: 0.000603
0.4603 --- loss: 0.427140, loss_ss: 0.416216, loss_d: 0.010924
0.4987 --- loss: 0.625436, loss_ss: 0.617470, loss_d: 0.007967
0.5370 --- loss: 1.544233, loss_ss: 0.790668, loss_d: 0.753565
0.5754 --- loss: 0.785879, loss_ss: 0.777927, loss_d: 0.007952
0.6137 --- loss: 0.690469, loss_ss: 0.688407, loss_d: 0.002062
0.6521 --- loss: 0.871616, loss_ss: 0.869625, loss_d: 0.001991
0.6904 --- loss: 0.741436, loss_ss: 0.730520, loss_d: 0.010915
0.7288 --- loss: 0.828181, loss_ss: 0.770174, loss_d: 0.058007
0.7672 --- loss: 0.712651, loss_ss: 0.665157, loss_d: 0.047494
0.8055 --- loss: 0.617409, loss_ss: 0.614172, loss_d: 0.003237
0.8439 --- loss: 1.122432, loss_ss: 0.568511, loss_d: 0.553922
0.8822 --- loss: 1.106526, loss_ss: 0.723892, loss_d: 0.382634
0.9206 --- loss: 0.636470, loss_ss: 0.636038, loss_d: 0.000432
0.9590 --- loss: 0.591431, loss_ss: 0.581862, loss_d: 0.009569
0.9973 --- loss: 1.044147, loss_ss: 0.834207, loss_d: 0.209940
Epoch finished! Loss: 0.8148367346479343
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8075268817204301
             precision    recall  f1-score   support

        0.0       0.75      1.00      0.85       226
        1.0       0.18      0.24      0.20        55
        2.0       0.91      0.82      0.87       410
        3.0       0.99      0.73      0.84       108
        4.0       0.91      0.73      0.81       131

avg / total       0.84      0.81      0.81       930
 


====== chc016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.72  99.56   89.20  74.75     85.39
1  89.03  23.64   93.14  17.81     20.31
2  88.82  82.44   93.85  91.35     86.67
3  96.77  73.15   99.88  98.75     84.04
4  95.16  73.28   98.75  90.57     81.01
Total accuracy: 80.75%
Average sen: 70.41%
Average spec: 94.96%
Macro f1-score: 71.48%
Diagnosis acc on 15mins: 1.0
[5.79852946e-02 4.30275947e-02 1.40642617e-02 1.50157267e-03
 2.62601506e-02 2.10167235e-03 1.57314539e-02 4.00048727e-03
 1.46109308e-03 1.20731047e-03 3.26520600e-03 1.32966481e-04
 6.18242266e-05 1.80155577e-04 9.84154921e-03 2.14023073e-03
 3.60613409e-03 1.93261856e-03 6.95273140e-03 3.46909277e-02
 3.06329597e-03 6.97599305e-03 2.64625717e-03 4.65140631e-03
 6.59688609e-03 3.00746318e-02 5.91151752e-02 1.80627778e-03
 2.02797959e-03 1.57026807e-03 1.20697115e-02]
pred: 0.011636874766413858, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.392610, loss_ss: 1.750264, loss_d: 0.642346
0.0383 --- loss: 2.128097, loss_ss: 1.568553, loss_d: 0.559544
0.0766 --- loss: 2.647921, loss_ss: 1.548165, loss_d: 1.099756
0.1149 --- loss: 2.500857, loss_ss: 1.530641, loss_d: 0.970216
0.1532 --- loss: 1.999356, loss_ss: 1.526688, loss_d: 0.472668
0.1915 --- loss: 2.228126, loss_ss: 1.445042, loss_d: 0.783084
0.2298 --- loss: 2.148346, loss_ss: 1.573447, loss_d: 0.574900
0.2681 --- loss: 2.048926, loss_ss: 1.436299, loss_d: 0.612627
0.3064 --- loss: 2.201942, loss_ss: 1.625088, loss_d: 0.576854
0.3447 --- loss: 1.946361, loss_ss: 1.388230, loss_d: 0.558132
0.3830 --- loss: 1.869402, loss_ss: 1.497675, loss_d: 0.371727
0.4213 --- loss: 2.017838, loss_ss: 1.371646, loss_d: 0.646191
0.4596 --- loss: 1.977132, loss_ss: 1.468857, loss_d: 0.508275
0.4979 --- loss: 1.773230, loss_ss: 1.362562, loss_d: 0.410667
0.5362 --- loss: 1.838504, loss_ss: 1.317368, loss_d: 0.521136
0.5745 --- loss: 2.002830, loss_ss: 1.273294, loss_d: 0.729535
0.6128 --- loss: 1.846991, loss_ss: 1.389717, loss_d: 0.457274
0.6511 --- loss: 1.838895, loss_ss: 1.377605, loss_d: 0.461290
0.6894 --- loss: 1.949769, loss_ss: 1.313665, loss_d: 0.636104
0.7277 --- loss: 1.601689, loss_ss: 1.146351, loss_d: 0.455338
0.7660 --- loss: 2.147188, loss_ss: 1.299316, loss_d: 0.847871
0.8043 --- loss: 1.533610, loss_ss: 1.214874, loss_d: 0.318737
0.8426 --- loss: 1.483154, loss_ss: 1.177256, loss_d: 0.305898
0.8809 --- loss: 1.502270, loss_ss: 1.197704, loss_d: 0.304566
0.9192 --- loss: 1.461819, loss_ss: 1.269057, loss_d: 0.192762
0.9575 --- loss: 1.499670, loss_ss: 1.208344, loss_d: 0.291326
0.9958 --- loss: 1.417074, loss_ss: 1.248676, loss_d: 0.168398
Epoch finished! Loss: 1.91815953967215
Starting epoch 2/10.
0.0000 --- loss: 1.465093, loss_ss: 1.150532, loss_d: 0.314561
0.0383 --- loss: 1.708190, loss_ss: 1.181831, loss_d: 0.526359
0.0766 --- loss: 1.491201, loss_ss: 1.150051, loss_d: 0.341150
0.1149 --- loss: 1.593644, loss_ss: 1.208890, loss_d: 0.384754
0.1532 --- loss: 1.471998, loss_ss: 1.127362, loss_d: 0.344635
0.1915 --- loss: 1.539697, loss_ss: 1.172162, loss_d: 0.367535
0.2298 --- loss: 1.438883, loss_ss: 1.151103, loss_d: 0.287780
0.2681 --- loss: 1.510623, loss_ss: 1.071244, loss_d: 0.439379
0.3064 --- loss: 1.205069, loss_ss: 0.936666, loss_d: 0.268403
0.3447 --- loss: 1.392725, loss_ss: 1.110408, loss_d: 0.282317
0.3830 --- loss: 1.569159, loss_ss: 1.142692, loss_d: 0.426466
0.4213 --- loss: 1.197502, loss_ss: 1.089493, loss_d: 0.108009
0.4596 --- loss: 1.330112, loss_ss: 1.044574, loss_d: 0.285538
0.4979 --- loss: 1.084755, loss_ss: 0.903997, loss_d: 0.180758
0.5362 --- loss: 1.265062, loss_ss: 1.074286, loss_d: 0.190776
0.5745 --- loss: 1.573403, loss_ss: 0.942457, loss_d: 0.630947
0.6128 --- loss: 1.455715, loss_ss: 1.064219, loss_d: 0.391496
0.6511 --- loss: 1.609983, loss_ss: 1.171787, loss_d: 0.438197
0.6894 --- loss: 1.055859, loss_ss: 0.932860, loss_d: 0.122999
0.7277 --- loss: 1.414808, loss_ss: 1.169140, loss_d: 0.245668
0.7660 --- loss: 1.264791, loss_ss: 1.033077, loss_d: 0.231714
0.8043 --- loss: 1.058542, loss_ss: 0.896259, loss_d: 0.162283
0.8426 --- loss: 1.351753, loss_ss: 0.853658, loss_d: 0.498095
0.8809 --- loss: 1.019696, loss_ss: 0.968293, loss_d: 0.051404
0.9192 --- loss: 1.109976, loss_ss: 1.069495, loss_d: 0.040481
0.9575 --- loss: 1.013474, loss_ss: 0.818436, loss_d: 0.195038
0.9958 --- loss: 2.170345, loss_ss: 0.841213, loss_d: 1.329132
Epoch finished! Loss: 1.386037814662831
Starting epoch 3/10.
0.0000 --- loss: 1.188766, loss_ss: 1.026447, loss_d: 0.162318
0.0383 --- loss: 1.200978, loss_ss: 1.033224, loss_d: 0.167754
0.0766 --- loss: 1.274143, loss_ss: 0.929797, loss_d: 0.344346
0.1149 --- loss: 1.340119, loss_ss: 1.123828, loss_d: 0.216291
0.1532 --- loss: 1.134253, loss_ss: 0.891022, loss_d: 0.243232
0.1915 --- loss: 1.064612, loss_ss: 0.855548, loss_d: 0.209064
0.2298 --- loss: 1.041131, loss_ss: 0.890006, loss_d: 0.151125
0.2681 --- loss: 1.092933, loss_ss: 0.956467, loss_d: 0.136465
0.3064 --- loss: 0.902498, loss_ss: 0.857945, loss_d: 0.044553
0.3447 --- loss: 1.175451, loss_ss: 1.101741, loss_d: 0.073710
0.3830 --- loss: 0.972154, loss_ss: 0.776000, loss_d: 0.196154
0.4213 --- loss: 1.332253, loss_ss: 0.905636, loss_d: 0.426617
0.4596 --- loss: 1.293634, loss_ss: 1.150473, loss_d: 0.143160
0.4979 --- loss: 1.071077, loss_ss: 1.034900, loss_d: 0.036177
0.5362 --- loss: 1.216043, loss_ss: 1.152223, loss_d: 0.063819
0.5745 --- loss: 0.959145, loss_ss: 0.822483, loss_d: 0.136661
0.6128 --- loss: 1.089843, loss_ss: 0.947651, loss_d: 0.142192
0.6511 --- loss: 1.143967, loss_ss: 0.972035, loss_d: 0.171932
0.6894 --- loss: 0.829144, loss_ss: 0.781688, loss_d: 0.047456
0.7277 --- loss: 0.977975, loss_ss: 0.911265, loss_d: 0.066709
0.7660 --- loss: 0.923383, loss_ss: 0.640557, loss_d: 0.282827
0.8043 --- loss: 1.269624, loss_ss: 0.877125, loss_d: 0.392498
0.8426 --- loss: 1.290966, loss_ss: 0.983602, loss_d: 0.307364
0.8809 --- loss: 0.950949, loss_ss: 0.766289, loss_d: 0.184660
0.9192 --- loss: 1.179414, loss_ss: 1.069929, loss_d: 0.109486
0.9575 --- loss: 1.306958, loss_ss: 1.178023, loss_d: 0.128935
0.9958 --- loss: 1.067862, loss_ss: 0.863332, loss_d: 0.204529
Epoch finished! Loss: 1.1728362644312482
Starting epoch 4/10.
0.0000 --- loss: 0.955842, loss_ss: 0.831501, loss_d: 0.124341
0.0383 --- loss: 0.903556, loss_ss: 0.765682, loss_d: 0.137874
0.0766 --- loss: 0.929437, loss_ss: 0.827198, loss_d: 0.102240
0.1149 --- loss: 1.171713, loss_ss: 0.760350, loss_d: 0.411363
0.1532 --- loss: 1.033841, loss_ss: 0.752972, loss_d: 0.280869
0.1915 --- loss: 1.117634, loss_ss: 0.839110, loss_d: 0.278524
0.2298 --- loss: 0.821122, loss_ss: 0.793350, loss_d: 0.027772
0.2681 --- loss: 1.101536, loss_ss: 0.842934, loss_d: 0.258602
0.3064 --- loss: 1.151111, loss_ss: 1.011153, loss_d: 0.139958
0.3447 --- loss: 0.987831, loss_ss: 0.870798, loss_d: 0.117033
0.3830 --- loss: 1.929219, loss_ss: 0.865871, loss_d: 1.063348
0.4213 --- loss: 1.024772, loss_ss: 0.848056, loss_d: 0.176716
0.4596 --- loss: 1.418389, loss_ss: 1.178191, loss_d: 0.240199
0.4979 --- loss: 0.954415, loss_ss: 0.885359, loss_d: 0.069056
0.5362 --- loss: 0.911432, loss_ss: 0.852193, loss_d: 0.059239
0.5745 --- loss: 1.000257, loss_ss: 0.888507, loss_d: 0.111750
0.6128 --- loss: 0.925031, loss_ss: 0.816936, loss_d: 0.108095
0.6511 --- loss: 1.212329, loss_ss: 1.148368, loss_d: 0.063961
0.6894 --- loss: 1.218409, loss_ss: 1.097858, loss_d: 0.120551
0.7277 --- loss: 1.089269, loss_ss: 1.061348, loss_d: 0.027922
0.7660 --- loss: 1.688572, loss_ss: 0.963145, loss_d: 0.725427
0.8043 --- loss: 1.301615, loss_ss: 1.014227, loss_d: 0.287388
0.8426 --- loss: 1.246089, loss_ss: 1.072317, loss_d: 0.173772
0.8809 --- loss: 0.782031, loss_ss: 0.710916, loss_d: 0.071115
0.9192 --- loss: 1.055563, loss_ss: 1.021048, loss_d: 0.034515
0.9575 --- loss: 0.758851, loss_ss: 0.704104, loss_d: 0.054748
0.9958 --- loss: 0.993008, loss_ss: 0.777857, loss_d: 0.215151
Epoch finished! Loss: 1.091798918000583
Starting epoch 5/10.
0.0000 --- loss: 0.830600, loss_ss: 0.698586, loss_d: 0.132014
0.0383 --- loss: 0.858050, loss_ss: 0.689756, loss_d: 0.168294
0.0766 --- loss: 0.834179, loss_ss: 0.677223, loss_d: 0.156957
0.1149 --- loss: 0.789937, loss_ss: 0.741212, loss_d: 0.048725
0.1532 --- loss: 1.024367, loss_ss: 0.876515, loss_d: 0.147852
0.1915 --- loss: 0.988613, loss_ss: 0.941657, loss_d: 0.046956
0.2298 --- loss: 1.286724, loss_ss: 1.001504, loss_d: 0.285219
0.2681 --- loss: 1.466787, loss_ss: 0.922647, loss_d: 0.544140
0.3064 --- loss: 1.378862, loss_ss: 1.232843, loss_d: 0.146020
0.3447 --- loss: 0.973806, loss_ss: 0.745320, loss_d: 0.228486
0.3830 --- loss: 0.855723, loss_ss: 0.657138, loss_d: 0.198584
0.4213 --- loss: 1.155472, loss_ss: 1.036066, loss_d: 0.119405
0.4596 --- loss: 0.903536, loss_ss: 0.838733, loss_d: 0.064803
0.4979 --- loss: 0.920714, loss_ss: 0.906655, loss_d: 0.014059
0.5362 --- loss: 1.031604, loss_ss: 0.718477, loss_d: 0.313128
0.5745 --- loss: 0.922821, loss_ss: 0.849481, loss_d: 0.073339
0.6128 --- loss: 1.633346, loss_ss: 0.870704, loss_d: 0.762642
0.6511 --- loss: 1.317576, loss_ss: 1.025695, loss_d: 0.291881
0.6894 --- loss: 0.869718, loss_ss: 0.716290, loss_d: 0.153427
0.7277 --- loss: 1.224084, loss_ss: 0.958740, loss_d: 0.265344
0.7660 --- loss: 0.737093, loss_ss: 0.699095, loss_d: 0.037997
0.8043 --- loss: 1.047084, loss_ss: 0.764316, loss_d: 0.282768
0.8426 --- loss: 1.041643, loss_ss: 0.913840, loss_d: 0.127802
0.8809 --- loss: 0.745860, loss_ss: 0.703927, loss_d: 0.041932
0.9192 --- loss: 0.640421, loss_ss: 0.530950, loss_d: 0.109471
0.9575 --- loss: 0.787914, loss_ss: 0.597705, loss_d: 0.190210
0.9958 --- loss: 1.324438, loss_ss: 1.003337, loss_d: 0.321100
Epoch finished! Loss: 1.0135659481830523
Starting epoch 6/10.
0.0000 --- loss: 0.940052, loss_ss: 0.758713, loss_d: 0.181338
0.0383 --- loss: 0.835470, loss_ss: 0.819772, loss_d: 0.015699
0.0766 --- loss: 1.088665, loss_ss: 0.873254, loss_d: 0.215411
0.1149 --- loss: 0.878891, loss_ss: 0.861356, loss_d: 0.017535
0.1532 --- loss: 0.874306, loss_ss: 0.783359, loss_d: 0.090946
0.1915 --- loss: 1.032071, loss_ss: 1.007302, loss_d: 0.024769
0.2298 --- loss: 1.247905, loss_ss: 0.737313, loss_d: 0.510593
0.2681 --- loss: 0.895205, loss_ss: 0.871355, loss_d: 0.023851
0.3064 --- loss: 1.105511, loss_ss: 0.811704, loss_d: 0.293807
0.3447 --- loss: 0.884935, loss_ss: 0.872872, loss_d: 0.012064
0.3830 --- loss: 0.850766, loss_ss: 0.728058, loss_d: 0.122708
0.4213 --- loss: 0.760018, loss_ss: 0.742745, loss_d: 0.017274
0.4596 --- loss: 0.928936, loss_ss: 0.783738, loss_d: 0.145198
0.4979 --- loss: 0.952785, loss_ss: 0.890515, loss_d: 0.062271
0.5362 --- loss: 0.795895, loss_ss: 0.766019, loss_d: 0.029876
0.5745 --- loss: 0.892590, loss_ss: 0.679323, loss_d: 0.213267
0.6128 --- loss: 1.315522, loss_ss: 0.997487, loss_d: 0.318036
0.6511 --- loss: 0.827514, loss_ss: 0.663807, loss_d: 0.163708
0.6894 --- loss: 0.937542, loss_ss: 0.912089, loss_d: 0.025453
0.7277 --- loss: 1.203830, loss_ss: 0.910790, loss_d: 0.293040
0.7660 --- loss: 0.793663, loss_ss: 0.763861, loss_d: 0.029803
0.8043 --- loss: 1.004282, loss_ss: 0.801274, loss_d: 0.203008
0.8426 --- loss: 1.000963, loss_ss: 0.984669, loss_d: 0.016294
0.8809 --- loss: 0.875299, loss_ss: 0.856143, loss_d: 0.019156
0.9192 --- loss: 0.712186, loss_ss: 0.643590, loss_d: 0.068595
0.9575 --- loss: 0.715533, loss_ss: 0.664507, loss_d: 0.051026
0.9958 --- loss: 1.347943, loss_ss: 1.012386, loss_d: 0.335557
Epoch finished! Loss: 0.9801634949742606
Starting epoch 7/10.
0.0000 --- loss: 0.782272, loss_ss: 0.682690, loss_d: 0.099582
0.0383 --- loss: 0.809204, loss_ss: 0.738645, loss_d: 0.070559
0.0766 --- loss: 1.114704, loss_ss: 0.989633, loss_d: 0.125072
0.1149 --- loss: 0.794320, loss_ss: 0.550439, loss_d: 0.243881
0.1532 --- loss: 0.866655, loss_ss: 0.757239, loss_d: 0.109415
0.1915 --- loss: 1.219509, loss_ss: 1.205046, loss_d: 0.014463
0.2298 --- loss: 0.732509, loss_ss: 0.708259, loss_d: 0.024250
0.2681 --- loss: 1.086661, loss_ss: 0.814655, loss_d: 0.272006
0.3064 --- loss: 0.826492, loss_ss: 0.696986, loss_d: 0.129507
0.3447 --- loss: 0.653143, loss_ss: 0.461743, loss_d: 0.191399
0.3830 --- loss: 0.909080, loss_ss: 0.885519, loss_d: 0.023560
0.4213 --- loss: 1.151235, loss_ss: 1.119272, loss_d: 0.031962
0.4596 --- loss: 0.847160, loss_ss: 0.699479, loss_d: 0.147681
0.4979 --- loss: 0.987648, loss_ss: 0.893985, loss_d: 0.093663
0.5362 --- loss: 0.871325, loss_ss: 0.682593, loss_d: 0.188732
0.5745 --- loss: 1.045575, loss_ss: 1.022636, loss_d: 0.022939
0.6128 --- loss: 1.275863, loss_ss: 1.240327, loss_d: 0.035536
0.6511 --- loss: 0.782317, loss_ss: 0.704428, loss_d: 0.077889
0.6894 --- loss: 0.991147, loss_ss: 0.829023, loss_d: 0.162124
0.7277 --- loss: 0.757647, loss_ss: 0.641864, loss_d: 0.115783
0.7660 --- loss: 0.754046, loss_ss: 0.626949, loss_d: 0.127097
0.8043 --- loss: 0.714055, loss_ss: 0.659448, loss_d: 0.054607
0.8426 --- loss: 0.784095, loss_ss: 0.756717, loss_d: 0.027378
0.8809 --- loss: 0.741809, loss_ss: 0.690976, loss_d: 0.050833
0.9192 --- loss: 0.823192, loss_ss: 0.799709, loss_d: 0.023483
0.9575 --- loss: 0.779913, loss_ss: 0.775532, loss_d: 0.004381
0.9958 --- loss: 0.657187, loss_ss: 0.650151, loss_d: 0.007036
Epoch finished! Loss: 0.9441514341767263
Starting epoch 8/10.
0.0000 --- loss: 0.927814, loss_ss: 0.800564, loss_d: 0.127249
0.0383 --- loss: 1.159578, loss_ss: 0.905955, loss_d: 0.253622
0.0766 --- loss: 0.797246, loss_ss: 0.682705, loss_d: 0.114540
0.1149 --- loss: 0.838237, loss_ss: 0.675885, loss_d: 0.162351
0.1532 --- loss: 0.813375, loss_ss: 0.653437, loss_d: 0.159939
0.1915 --- loss: 0.814479, loss_ss: 0.651069, loss_d: 0.163410
0.2298 --- loss: 0.797671, loss_ss: 0.765563, loss_d: 0.032108
0.2681 --- loss: 0.879178, loss_ss: 0.596977, loss_d: 0.282202
0.3064 --- loss: 0.647188, loss_ss: 0.600017, loss_d: 0.047171
0.3447 --- loss: 0.783466, loss_ss: 0.750148, loss_d: 0.033318
0.3830 --- loss: 1.031990, loss_ss: 0.964784, loss_d: 0.067206
0.4213 --- loss: 1.137583, loss_ss: 1.091591, loss_d: 0.045992
0.4596 --- loss: 0.769051, loss_ss: 0.702200, loss_d: 0.066851
0.4979 --- loss: 0.666884, loss_ss: 0.635385, loss_d: 0.031499
0.5362 --- loss: 0.752078, loss_ss: 0.738279, loss_d: 0.013799
0.5745 --- loss: 0.660754, loss_ss: 0.581571, loss_d: 0.079184
0.6128 --- loss: 0.654335, loss_ss: 0.635226, loss_d: 0.019108
0.6511 --- loss: 0.933363, loss_ss: 0.819562, loss_d: 0.113801
0.6894 --- loss: 0.794672, loss_ss: 0.776902, loss_d: 0.017770
0.7277 --- loss: 1.064170, loss_ss: 0.911830, loss_d: 0.152339
0.7660 --- loss: 0.893110, loss_ss: 0.849923, loss_d: 0.043187
0.8043 --- loss: 0.831948, loss_ss: 0.687420, loss_d: 0.144528
0.8426 --- loss: 1.285118, loss_ss: 0.974956, loss_d: 0.310162
0.8809 --- loss: 0.897740, loss_ss: 0.841576, loss_d: 0.056164
0.9192 --- loss: 0.777592, loss_ss: 0.535282, loss_d: 0.242309
0.9575 --- loss: 0.935568, loss_ss: 0.872207, loss_d: 0.063361
0.9958 --- loss: 1.145176, loss_ss: 1.003459, loss_d: 0.141717
Epoch finished! Loss: 0.9034767990139709
Starting epoch 9/10.
0.0000 --- loss: 0.872323, loss_ss: 0.796011, loss_d: 0.076312
0.0383 --- loss: 1.212940, loss_ss: 0.996193, loss_d: 0.216747
0.0766 --- loss: 0.600141, loss_ss: 0.574436, loss_d: 0.025705
0.1149 --- loss: 0.814049, loss_ss: 0.693716, loss_d: 0.120333
0.1532 --- loss: 0.801784, loss_ss: 0.790733, loss_d: 0.011051
0.1915 --- loss: 0.628313, loss_ss: 0.614905, loss_d: 0.013407
0.2298 --- loss: 1.115418, loss_ss: 1.102482, loss_d: 0.012936
0.2681 --- loss: 0.807964, loss_ss: 0.782449, loss_d: 0.025515
0.3064 --- loss: 1.000859, loss_ss: 0.798129, loss_d: 0.202730
0.3447 --- loss: 1.193155, loss_ss: 0.978166, loss_d: 0.214989
0.3830 --- loss: 0.653201, loss_ss: 0.629016, loss_d: 0.024185
0.4213 --- loss: 1.132405, loss_ss: 0.918690, loss_d: 0.213714
0.4596 --- loss: 0.921105, loss_ss: 0.780155, loss_d: 0.140950
0.4979 --- loss: 0.700045, loss_ss: 0.672880, loss_d: 0.027165
0.5362 --- loss: 1.104464, loss_ss: 0.663712, loss_d: 0.440752
0.5745 --- loss: 0.684819, loss_ss: 0.673824, loss_d: 0.010996
0.6128 --- loss: 1.397697, loss_ss: 1.050595, loss_d: 0.347101
0.6511 --- loss: 0.893596, loss_ss: 0.559793, loss_d: 0.333803
0.6894 --- loss: 0.891542, loss_ss: 0.744190, loss_d: 0.147351
0.7277 --- loss: 0.986554, loss_ss: 0.946321, loss_d: 0.040233
0.7660 --- loss: 0.812517, loss_ss: 0.803798, loss_d: 0.008719
0.8043 --- loss: 1.053114, loss_ss: 0.806369, loss_d: 0.246745
0.8426 --- loss: 0.769893, loss_ss: 0.723317, loss_d: 0.046576
0.8809 --- loss: 0.829859, loss_ss: 0.807909, loss_d: 0.021949
0.9192 --- loss: 0.915905, loss_ss: 0.778049, loss_d: 0.137856
0.9575 --- loss: 1.002892, loss_ss: 0.924377, loss_d: 0.078515
0.9958 --- loss: 1.335644, loss_ss: 0.551559, loss_d: 0.784085
Epoch finished! Loss: 0.8683768941296471
Starting epoch 10/10.
0.0000 --- loss: 0.949276, loss_ss: 0.942970, loss_d: 0.006306
0.0383 --- loss: 0.925750, loss_ss: 0.848071, loss_d: 0.077679
0.0766 --- loss: 0.862741, loss_ss: 0.851478, loss_d: 0.011263
0.1149 --- loss: 0.935961, loss_ss: 0.908281, loss_d: 0.027681
0.1532 --- loss: 0.831893, loss_ss: 0.810970, loss_d: 0.020923
0.1915 --- loss: 0.813974, loss_ss: 0.767233, loss_d: 0.046741
0.2298 --- loss: 0.682914, loss_ss: 0.673327, loss_d: 0.009587
0.2681 --- loss: 0.763343, loss_ss: 0.703564, loss_d: 0.059779
0.3064 --- loss: 0.922272, loss_ss: 0.888235, loss_d: 0.034037
0.3447 --- loss: 0.669264, loss_ss: 0.666220, loss_d: 0.003044
0.3830 --- loss: 0.503922, loss_ss: 0.502856, loss_d: 0.001066
0.4213 --- loss: 0.472335, loss_ss: 0.429638, loss_d: 0.042697
0.4596 --- loss: 0.791684, loss_ss: 0.788008, loss_d: 0.003676
0.4979 --- loss: 1.018689, loss_ss: 0.996687, loss_d: 0.022002
0.5362 --- loss: 1.018709, loss_ss: 0.977521, loss_d: 0.041188
0.5745 --- loss: 0.774392, loss_ss: 0.765832, loss_d: 0.008560
0.6128 --- loss: 0.837717, loss_ss: 0.566288, loss_d: 0.271429
0.6511 --- loss: 1.005240, loss_ss: 0.976412, loss_d: 0.028828
0.6894 --- loss: 0.640737, loss_ss: 0.634613, loss_d: 0.006125
0.7277 --- loss: 0.672893, loss_ss: 0.663433, loss_d: 0.009460
0.7660 --- loss: 0.679557, loss_ss: 0.503045, loss_d: 0.176512
0.8043 --- loss: 0.722603, loss_ss: 0.672938, loss_d: 0.049665
0.8426 --- loss: 0.843385, loss_ss: 0.839005, loss_d: 0.004380
0.8809 --- loss: 0.963669, loss_ss: 0.949260, loss_d: 0.014410
0.9192 --- loss: 0.962021, loss_ss: 0.958283, loss_d: 0.003738
0.9575 --- loss: 0.944178, loss_ss: 0.868022, loss_d: 0.076156
0.9958 --- loss: 0.556038, loss_ss: 0.538046, loss_d: 0.017993
Epoch finished! Loss: 0.8492540816466013
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8629629629629629
             precision    recall  f1-score   support

        0.0       0.99      0.97      0.98       102
        1.0       0.46      0.40      0.43        15
        2.0       0.90      0.82      0.86       397
        3.0       0.75      0.97      0.85       187
        4.0       0.92      0.79      0.85       109

avg / total       0.87      0.86      0.86       810
 


====== chc022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  99.51  97.06   99.86  99.00     98.02
1  98.02  40.00   99.12  46.15     42.86
2  86.91  82.12   91.53  90.30     86.02
3  91.85  97.33   90.21  74.90     84.65
4  96.30  78.90   99.00  92.47     85.15
Total accuracy: 86.30%
Average sen: 79.08%
Average spec: 95.94%
Macro f1-score: 79.34%
Diagnosis acc on 15mins: 0.7777777777777778
[0.04661383 0.01473936 0.18871021 0.8367784  0.13187987 0.26927277
 0.10238063 0.38889074 0.29515308 0.72124678 0.79858005 0.86320436
 0.1005006  0.17678532 0.15563262 0.4414036  0.14865424 0.64250487
 0.57632625 0.47724327 0.44189754 0.14433277 0.05497265 0.146869
 0.38806936 0.3237755  0.4822621 ]
pred: 0.3466177697258967, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.395882, loss_ss: 1.703556, loss_d: 0.692325
0.0383 --- loss: 2.345843, loss_ss: 1.674912, loss_d: 0.670931
0.0766 --- loss: 2.250759, loss_ss: 1.630311, loss_d: 0.620447
0.1149 --- loss: 2.279967, loss_ss: 1.606942, loss_d: 0.673025
0.1532 --- loss: 2.190310, loss_ss: 1.594807, loss_d: 0.595503
0.1915 --- loss: 2.035824, loss_ss: 1.312032, loss_d: 0.723792
0.2298 --- loss: 1.755630, loss_ss: 1.370997, loss_d: 0.384633
0.2681 --- loss: 1.681219, loss_ss: 1.268439, loss_d: 0.412780
0.3064 --- loss: 1.910446, loss_ss: 1.422092, loss_d: 0.488354
0.3447 --- loss: 1.714288, loss_ss: 1.461235, loss_d: 0.253053
0.3830 --- loss: 1.997303, loss_ss: 1.519521, loss_d: 0.477782
0.4213 --- loss: 1.939525, loss_ss: 1.398841, loss_d: 0.540684
0.4596 --- loss: 2.066209, loss_ss: 1.479357, loss_d: 0.586852
0.4979 --- loss: 1.928626, loss_ss: 1.439899, loss_d: 0.488727
0.5362 --- loss: 1.572035, loss_ss: 1.166861, loss_d: 0.405174
0.5745 --- loss: 1.638850, loss_ss: 1.208132, loss_d: 0.430719
0.6128 --- loss: 1.547364, loss_ss: 1.191544, loss_d: 0.355821
0.6511 --- loss: 1.915440, loss_ss: 1.333425, loss_d: 0.582015
0.6894 --- loss: 1.728425, loss_ss: 1.311485, loss_d: 0.416940
0.7277 --- loss: 1.555971, loss_ss: 1.303654, loss_d: 0.252317
0.7660 --- loss: 1.428080, loss_ss: 1.129391, loss_d: 0.298689
0.8043 --- loss: 1.786263, loss_ss: 1.341913, loss_d: 0.444351
0.8426 --- loss: 1.662001, loss_ss: 1.133330, loss_d: 0.528671
0.8809 --- loss: 1.828246, loss_ss: 1.118718, loss_d: 0.709529
0.9192 --- loss: 1.528118, loss_ss: 1.293459, loss_d: 0.234659
0.9575 --- loss: 1.385232, loss_ss: 1.033116, loss_d: 0.352116
0.9958 --- loss: 1.738633, loss_ss: 1.157594, loss_d: 0.581039
Epoch finished! Loss: 1.8841219414239643
Starting epoch 2/10.
0.0000 --- loss: 1.327005, loss_ss: 1.143917, loss_d: 0.183088
0.0383 --- loss: 1.587950, loss_ss: 1.215995, loss_d: 0.371955
0.0766 --- loss: 1.550786, loss_ss: 1.225769, loss_d: 0.325017
0.1149 --- loss: 1.799544, loss_ss: 1.169932, loss_d: 0.629611
0.1532 --- loss: 1.304136, loss_ss: 0.962761, loss_d: 0.341375
0.1915 --- loss: 1.756642, loss_ss: 1.087667, loss_d: 0.668975
0.2298 --- loss: 1.414754, loss_ss: 1.064875, loss_d: 0.349878
0.2681 --- loss: 1.831431, loss_ss: 1.100740, loss_d: 0.730691
0.3064 --- loss: 1.768386, loss_ss: 1.309798, loss_d: 0.458588
0.3447 --- loss: 1.824290, loss_ss: 1.248335, loss_d: 0.575955
0.3830 --- loss: 1.504111, loss_ss: 1.037562, loss_d: 0.466549
0.4213 --- loss: 1.724919, loss_ss: 0.842704, loss_d: 0.882215
0.4596 --- loss: 1.277981, loss_ss: 1.168983, loss_d: 0.108998
0.4979 --- loss: 1.602765, loss_ss: 1.361627, loss_d: 0.241138
0.5362 --- loss: 1.172666, loss_ss: 1.013009, loss_d: 0.159657
0.5745 --- loss: 1.513390, loss_ss: 0.979066, loss_d: 0.534324
0.6128 --- loss: 1.401241, loss_ss: 0.935233, loss_d: 0.466008
0.6511 --- loss: 1.045290, loss_ss: 0.972206, loss_d: 0.073083
0.6894 --- loss: 1.039048, loss_ss: 0.917120, loss_d: 0.121928
0.7277 --- loss: 1.119334, loss_ss: 1.030290, loss_d: 0.089044
0.7660 --- loss: 1.842458, loss_ss: 1.257169, loss_d: 0.585289
0.8043 --- loss: 1.241193, loss_ss: 0.988251, loss_d: 0.252941
0.8426 --- loss: 1.366650, loss_ss: 1.003053, loss_d: 0.363597
0.8809 --- loss: 1.429534, loss_ss: 0.966032, loss_d: 0.463502
0.9192 --- loss: 1.107648, loss_ss: 0.907845, loss_d: 0.199803
0.9575 --- loss: 1.342314, loss_ss: 0.706248, loss_d: 0.636067
0.9958 --- loss: 0.983342, loss_ss: 0.887133, loss_d: 0.096209
Epoch finished! Loss: 1.39216266030096
Starting epoch 3/10.
0.0000 --- loss: 1.037829, loss_ss: 0.888268, loss_d: 0.149562
0.0383 --- loss: 1.131306, loss_ss: 0.964100, loss_d: 0.167206
0.0766 --- loss: 1.089763, loss_ss: 0.877243, loss_d: 0.212521
0.1149 --- loss: 1.459718, loss_ss: 1.111914, loss_d: 0.347804
0.1532 --- loss: 1.325910, loss_ss: 1.049500, loss_d: 0.276411
0.1915 --- loss: 1.350857, loss_ss: 0.946209, loss_d: 0.404648
0.2298 --- loss: 1.557129, loss_ss: 1.301812, loss_d: 0.255317
0.2681 --- loss: 1.123321, loss_ss: 1.003367, loss_d: 0.119953
0.3064 --- loss: 1.171551, loss_ss: 0.928102, loss_d: 0.243450
0.3447 --- loss: 0.882918, loss_ss: 0.831151, loss_d: 0.051767
0.3830 --- loss: 1.032314, loss_ss: 0.895766, loss_d: 0.136548
0.4213 --- loss: 0.956205, loss_ss: 0.853338, loss_d: 0.102867
0.4596 --- loss: 1.321305, loss_ss: 1.026400, loss_d: 0.294906
0.4979 --- loss: 1.271795, loss_ss: 1.239876, loss_d: 0.031919
0.5362 --- loss: 1.543193, loss_ss: 1.033991, loss_d: 0.509202
0.5745 --- loss: 1.098267, loss_ss: 0.816740, loss_d: 0.281526
0.6128 --- loss: 1.166449, loss_ss: 0.932753, loss_d: 0.233696
0.6511 --- loss: 1.194479, loss_ss: 1.012627, loss_d: 0.181852
0.6894 --- loss: 0.958116, loss_ss: 0.897575, loss_d: 0.060541
0.7277 --- loss: 1.282671, loss_ss: 0.937376, loss_d: 0.345295
0.7660 --- loss: 1.301532, loss_ss: 0.892519, loss_d: 0.409014
0.8043 --- loss: 0.959985, loss_ss: 0.718052, loss_d: 0.241933
0.8426 --- loss: 1.182886, loss_ss: 0.827438, loss_d: 0.355448
0.8809 --- loss: 1.286580, loss_ss: 0.909632, loss_d: 0.376948
0.9192 --- loss: 1.194934, loss_ss: 0.823213, loss_d: 0.371721
0.9575 --- loss: 0.789980, loss_ss: 0.590084, loss_d: 0.199896
0.9958 --- loss: 1.365191, loss_ss: 0.862656, loss_d: 0.502535
Epoch finished! Loss: 1.240753004149002
Starting epoch 4/10.
0.0000 --- loss: 0.687490, loss_ss: 0.630611, loss_d: 0.056879
0.0383 --- loss: 0.991264, loss_ss: 0.884107, loss_d: 0.107157
0.0766 --- loss: 1.822655, loss_ss: 1.449557, loss_d: 0.373098
0.1149 --- loss: 1.118766, loss_ss: 0.990049, loss_d: 0.128716
0.1532 --- loss: 1.577109, loss_ss: 1.213417, loss_d: 0.363692
0.1915 --- loss: 1.419136, loss_ss: 1.055939, loss_d: 0.363198
0.2298 --- loss: 1.055388, loss_ss: 0.983128, loss_d: 0.072260
0.2681 --- loss: 1.048277, loss_ss: 0.950058, loss_d: 0.098220
0.3064 --- loss: 1.041473, loss_ss: 0.732497, loss_d: 0.308976
0.3447 --- loss: 0.865966, loss_ss: 0.771667, loss_d: 0.094299
0.3830 --- loss: 1.263392, loss_ss: 1.045371, loss_d: 0.218021
0.4213 --- loss: 1.013578, loss_ss: 0.975875, loss_d: 0.037703
0.4596 --- loss: 1.005497, loss_ss: 0.907062, loss_d: 0.098435
0.4979 --- loss: 1.459826, loss_ss: 0.979436, loss_d: 0.480390
0.5362 --- loss: 0.904403, loss_ss: 0.840728, loss_d: 0.063675
0.5745 --- loss: 1.301671, loss_ss: 1.126591, loss_d: 0.175079
0.6128 --- loss: 1.075640, loss_ss: 0.895488, loss_d: 0.180152
0.6511 --- loss: 1.328991, loss_ss: 0.950163, loss_d: 0.378828
0.6894 --- loss: 1.033395, loss_ss: 0.922020, loss_d: 0.111375
0.7277 --- loss: 1.149228, loss_ss: 0.941962, loss_d: 0.207266
0.7660 --- loss: 1.077140, loss_ss: 0.969834, loss_d: 0.107306
0.8043 --- loss: 1.387185, loss_ss: 1.174601, loss_d: 0.212584
0.8426 --- loss: 1.139907, loss_ss: 0.775149, loss_d: 0.364758
0.8809 --- loss: 1.441586, loss_ss: 0.743519, loss_d: 0.698067
0.9192 --- loss: 1.104386, loss_ss: 0.796799, loss_d: 0.307588
0.9575 --- loss: 1.033544, loss_ss: 0.849137, loss_d: 0.184407
0.9958 --- loss: 1.193563, loss_ss: 1.068296, loss_d: 0.125267
Epoch finished! Loss: 1.1828466363793588
Starting epoch 5/10.
0.0000 --- loss: 1.044814, loss_ss: 0.803072, loss_d: 0.241743
0.0383 --- loss: 0.985645, loss_ss: 0.775791, loss_d: 0.209854
0.0766 --- loss: 1.234313, loss_ss: 1.157959, loss_d: 0.076354
0.1149 --- loss: 1.158053, loss_ss: 1.000089, loss_d: 0.157964
0.1532 --- loss: 0.991732, loss_ss: 0.896115, loss_d: 0.095617
0.1915 --- loss: 0.779225, loss_ss: 0.619336, loss_d: 0.159890
0.2298 --- loss: 0.844407, loss_ss: 0.803792, loss_d: 0.040615
0.2681 --- loss: 1.088402, loss_ss: 0.886399, loss_d: 0.202003
0.3064 --- loss: 1.564410, loss_ss: 1.047205, loss_d: 0.517205
0.3447 --- loss: 1.381793, loss_ss: 1.048772, loss_d: 0.333021
0.3830 --- loss: 0.760724, loss_ss: 0.721592, loss_d: 0.039132
0.4213 --- loss: 0.768749, loss_ss: 0.737096, loss_d: 0.031652
0.4596 --- loss: 1.268143, loss_ss: 1.028228, loss_d: 0.239915
0.4979 --- loss: 1.010881, loss_ss: 0.972398, loss_d: 0.038482
0.5362 --- loss: 1.727015, loss_ss: 1.260635, loss_d: 0.466380
0.5745 --- loss: 1.180305, loss_ss: 1.011528, loss_d: 0.168776
0.6128 --- loss: 0.978141, loss_ss: 0.845684, loss_d: 0.132456
0.6511 --- loss: 0.752295, loss_ss: 0.677070, loss_d: 0.075225
0.6894 --- loss: 1.483467, loss_ss: 0.996453, loss_d: 0.487015
0.7277 --- loss: 0.977872, loss_ss: 0.932805, loss_d: 0.045067
0.7660 --- loss: 1.426711, loss_ss: 0.792700, loss_d: 0.634011
0.8043 --- loss: 0.968324, loss_ss: 0.956784, loss_d: 0.011540
0.8426 --- loss: 0.895986, loss_ss: 0.883177, loss_d: 0.012809
0.8809 --- loss: 1.270271, loss_ss: 1.055502, loss_d: 0.214769
0.9192 --- loss: 0.942150, loss_ss: 0.726296, loss_d: 0.215854
0.9575 --- loss: 1.262788, loss_ss: 1.064237, loss_d: 0.198551
0.9958 --- loss: 0.834061, loss_ss: 0.801210, loss_d: 0.032851
Epoch finished! Loss: 1.092025730116614
Starting epoch 6/10.
0.0000 --- loss: 0.920536, loss_ss: 0.830254, loss_d: 0.090282
0.0383 --- loss: 2.072514, loss_ss: 0.531307, loss_d: 1.541206
0.0766 --- loss: 1.280892, loss_ss: 0.798184, loss_d: 0.482708
0.1149 --- loss: 0.952157, loss_ss: 0.895881, loss_d: 0.056275
0.1532 --- loss: 0.922127, loss_ss: 0.707537, loss_d: 0.214590
0.1915 --- loss: 1.131432, loss_ss: 1.024714, loss_d: 0.106717
0.2298 --- loss: 0.714908, loss_ss: 0.701196, loss_d: 0.013712
0.2681 --- loss: 0.876589, loss_ss: 0.665701, loss_d: 0.210888
0.3064 --- loss: 0.916840, loss_ss: 0.861583, loss_d: 0.055256
0.3447 --- loss: 1.042934, loss_ss: 1.001327, loss_d: 0.041607
0.3830 --- loss: 1.040633, loss_ss: 1.012132, loss_d: 0.028501
0.4213 --- loss: 0.910493, loss_ss: 0.884425, loss_d: 0.026068
0.4596 --- loss: 1.012450, loss_ss: 0.969518, loss_d: 0.042932
0.4979 --- loss: 1.013481, loss_ss: 0.989092, loss_d: 0.024389
0.5362 --- loss: 0.746747, loss_ss: 0.711591, loss_d: 0.035156
0.5745 --- loss: 1.146330, loss_ss: 1.084332, loss_d: 0.061998
0.6128 --- loss: 0.894054, loss_ss: 0.770722, loss_d: 0.123332
0.6511 --- loss: 1.168693, loss_ss: 1.119302, loss_d: 0.049392
0.6894 --- loss: 1.113437, loss_ss: 0.894923, loss_d: 0.218514
0.7277 --- loss: 0.896532, loss_ss: 0.879526, loss_d: 0.017006
0.7660 --- loss: 1.084845, loss_ss: 1.003118, loss_d: 0.081726
0.8043 --- loss: 0.953749, loss_ss: 0.898234, loss_d: 0.055515
0.8426 --- loss: 1.326385, loss_ss: 1.272776, loss_d: 0.053610
0.8809 --- loss: 1.175667, loss_ss: 1.033107, loss_d: 0.142560
0.9192 --- loss: 1.020853, loss_ss: 0.908206, loss_d: 0.112648
0.9575 --- loss: 0.890936, loss_ss: 0.778112, loss_d: 0.112824
0.9958 --- loss: 1.360820, loss_ss: 0.895806, loss_d: 0.465014
Epoch finished! Loss: 1.0492907059146983
Starting epoch 7/10.
0.0000 --- loss: 1.221062, loss_ss: 1.049750, loss_d: 0.171312
0.0383 --- loss: 0.874230, loss_ss: 0.780391, loss_d: 0.093840
0.0766 --- loss: 0.887154, loss_ss: 0.806894, loss_d: 0.080260
0.1149 --- loss: 1.672179, loss_ss: 0.855380, loss_d: 0.816799
0.1532 --- loss: 1.269363, loss_ss: 1.164018, loss_d: 0.105345
0.1915 --- loss: 0.998394, loss_ss: 0.901665, loss_d: 0.096729
0.2298 --- loss: 0.906202, loss_ss: 0.845355, loss_d: 0.060847
0.2681 --- loss: 1.233596, loss_ss: 1.050169, loss_d: 0.183427
0.3064 --- loss: 0.997719, loss_ss: 0.968201, loss_d: 0.029518
0.3447 --- loss: 0.833897, loss_ss: 0.823575, loss_d: 0.010323
0.3830 --- loss: 0.783104, loss_ss: 0.756339, loss_d: 0.026766
0.4213 --- loss: 0.873683, loss_ss: 0.846327, loss_d: 0.027356
0.4596 --- loss: 0.793901, loss_ss: 0.788598, loss_d: 0.005303
0.4979 --- loss: 0.927464, loss_ss: 0.903241, loss_d: 0.024223
0.5362 --- loss: 0.900726, loss_ss: 0.844729, loss_d: 0.055997
0.5745 --- loss: 0.931723, loss_ss: 0.894417, loss_d: 0.037306
0.6128 --- loss: 1.144438, loss_ss: 1.098108, loss_d: 0.046329
0.6511 --- loss: 0.895203, loss_ss: 0.783653, loss_d: 0.111550
0.6894 --- loss: 0.900265, loss_ss: 0.877674, loss_d: 0.022591
0.7277 --- loss: 0.983064, loss_ss: 0.965758, loss_d: 0.017307
0.7660 --- loss: 0.934420, loss_ss: 0.858927, loss_d: 0.075493
0.8043 --- loss: 0.905867, loss_ss: 0.727087, loss_d: 0.178780
0.8426 --- loss: 1.019387, loss_ss: 0.991665, loss_d: 0.027722
0.8809 --- loss: 1.175195, loss_ss: 1.112345, loss_d: 0.062850
0.9192 --- loss: 0.860620, loss_ss: 0.849168, loss_d: 0.011452
0.9575 --- loss: 0.862111, loss_ss: 0.684334, loss_d: 0.177777
0.9958 --- loss: 0.705602, loss_ss: 0.629726, loss_d: 0.075876
Epoch finished! Loss: 0.9935222304643799
Starting epoch 8/10.
0.0000 --- loss: 0.908154, loss_ss: 0.789636, loss_d: 0.118517
0.0383 --- loss: 0.992993, loss_ss: 0.961416, loss_d: 0.031577
0.0766 --- loss: 0.728282, loss_ss: 0.707360, loss_d: 0.020921
0.1149 --- loss: 0.876132, loss_ss: 0.855467, loss_d: 0.020665
0.1532 --- loss: 0.816609, loss_ss: 0.748048, loss_d: 0.068561
0.1915 --- loss: 0.844590, loss_ss: 0.834346, loss_d: 0.010244
0.2298 --- loss: 0.701504, loss_ss: 0.675892, loss_d: 0.025613
0.2681 --- loss: 0.989109, loss_ss: 0.916096, loss_d: 0.073012
0.3064 --- loss: 0.753160, loss_ss: 0.730257, loss_d: 0.022903
0.3447 --- loss: 1.206700, loss_ss: 0.959103, loss_d: 0.247597
0.3830 --- loss: 1.529968, loss_ss: 0.776481, loss_d: 0.753486
0.4213 --- loss: 0.920571, loss_ss: 0.905617, loss_d: 0.014954
0.4596 --- loss: 0.813481, loss_ss: 0.770808, loss_d: 0.042673
0.4979 --- loss: 0.861005, loss_ss: 0.779629, loss_d: 0.081376
0.5362 --- loss: 1.014092, loss_ss: 0.722088, loss_d: 0.292005
0.5745 --- loss: 0.895199, loss_ss: 0.610275, loss_d: 0.284924
0.6128 --- loss: 1.222081, loss_ss: 0.735031, loss_d: 0.487050
0.6511 --- loss: 1.323460, loss_ss: 1.282500, loss_d: 0.040960
0.6894 --- loss: 0.886845, loss_ss: 0.834124, loss_d: 0.052721
0.7277 --- loss: 0.782900, loss_ss: 0.644603, loss_d: 0.138297
0.7660 --- loss: 1.394739, loss_ss: 0.793803, loss_d: 0.600936
0.8043 --- loss: 0.888039, loss_ss: 0.802881, loss_d: 0.085158
0.8426 --- loss: 1.057880, loss_ss: 0.899696, loss_d: 0.158184
0.8809 --- loss: 0.780247, loss_ss: 0.733873, loss_d: 0.046374
0.9192 --- loss: 0.746309, loss_ss: 0.695215, loss_d: 0.051094
0.9575 --- loss: 0.794118, loss_ss: 0.786417, loss_d: 0.007701
0.9958 --- loss: 1.139268, loss_ss: 1.082793, loss_d: 0.056475
Epoch finished! Loss: 0.9374810934523513
Starting epoch 9/10.
0.0000 --- loss: 0.878362, loss_ss: 0.804370, loss_d: 0.073992
0.0383 --- loss: 0.942092, loss_ss: 0.918279, loss_d: 0.023813
0.0766 --- loss: 1.145639, loss_ss: 0.819431, loss_d: 0.326208
0.1149 --- loss: 1.028049, loss_ss: 0.842426, loss_d: 0.185623
0.1532 --- loss: 0.738526, loss_ss: 0.577989, loss_d: 0.160537
0.1915 --- loss: 1.069770, loss_ss: 0.855120, loss_d: 0.214651
0.2298 --- loss: 0.872648, loss_ss: 0.858015, loss_d: 0.014634
0.2681 --- loss: 0.768049, loss_ss: 0.763227, loss_d: 0.004822
0.3064 --- loss: 0.896398, loss_ss: 0.830665, loss_d: 0.065733
0.3447 --- loss: 0.803265, loss_ss: 0.765790, loss_d: 0.037475
0.3830 --- loss: 0.956253, loss_ss: 0.923226, loss_d: 0.033027
0.4213 --- loss: 0.736398, loss_ss: 0.682506, loss_d: 0.053892
0.4596 --- loss: 0.887241, loss_ss: 0.867969, loss_d: 0.019271
0.4979 --- loss: 0.722353, loss_ss: 0.718763, loss_d: 0.003590
0.5362 --- loss: 0.726295, loss_ss: 0.718258, loss_d: 0.008038
0.5745 --- loss: 0.818608, loss_ss: 0.801789, loss_d: 0.016819
0.6128 --- loss: 0.949812, loss_ss: 0.884262, loss_d: 0.065550
0.6511 --- loss: 0.916805, loss_ss: 0.886796, loss_d: 0.030009
0.6894 --- loss: 0.853616, loss_ss: 0.821699, loss_d: 0.031917
0.7277 --- loss: 0.874849, loss_ss: 0.668805, loss_d: 0.206043
0.7660 --- loss: 0.604571, loss_ss: 0.539256, loss_d: 0.065315
0.8043 --- loss: 0.812044, loss_ss: 0.727791, loss_d: 0.084253
0.8426 --- loss: 1.060544, loss_ss: 1.013221, loss_d: 0.047324
0.8809 --- loss: 1.368304, loss_ss: 1.084497, loss_d: 0.283807
0.9192 --- loss: 0.883654, loss_ss: 0.860286, loss_d: 0.023368
0.9575 --- loss: 1.330993, loss_ss: 1.048688, loss_d: 0.282306
0.9958 --- loss: 0.763626, loss_ss: 0.735278, loss_d: 0.028347
Epoch finished! Loss: 0.9250561476210525
Starting epoch 10/10.
0.0000 --- loss: 0.778964, loss_ss: 0.706817, loss_d: 0.072147
0.0383 --- loss: 0.758389, loss_ss: 0.733778, loss_d: 0.024610
0.0766 --- loss: 0.825610, loss_ss: 0.692569, loss_d: 0.133041
0.1149 --- loss: 0.866051, loss_ss: 0.850571, loss_d: 0.015480
0.1532 --- loss: 0.557159, loss_ss: 0.543843, loss_d: 0.013316
0.1915 --- loss: 1.003810, loss_ss: 0.800090, loss_d: 0.203720
0.2298 --- loss: 0.611300, loss_ss: 0.595581, loss_d: 0.015719
0.2681 --- loss: 0.914237, loss_ss: 0.627909, loss_d: 0.286328
0.3064 --- loss: 1.085179, loss_ss: 1.078833, loss_d: 0.006347
0.3447 --- loss: 0.651388, loss_ss: 0.642157, loss_d: 0.009231
0.3830 --- loss: 0.748404, loss_ss: 0.718216, loss_d: 0.030188
0.4213 --- loss: 1.065151, loss_ss: 1.056877, loss_d: 0.008274
0.4596 --- loss: 1.507209, loss_ss: 1.459231, loss_d: 0.047978
0.4979 --- loss: 0.738836, loss_ss: 0.719321, loss_d: 0.019514
0.5362 --- loss: 0.859589, loss_ss: 0.832300, loss_d: 0.027290
0.5745 --- loss: 0.971605, loss_ss: 0.966865, loss_d: 0.004740
0.6128 --- loss: 0.744569, loss_ss: 0.730382, loss_d: 0.014187
0.6511 --- loss: 0.815469, loss_ss: 0.731847, loss_d: 0.083622
0.6894 --- loss: 1.538427, loss_ss: 0.964896, loss_d: 0.573532
0.7277 --- loss: 0.712789, loss_ss: 0.659188, loss_d: 0.053601
0.7660 --- loss: 0.918871, loss_ss: 0.758761, loss_d: 0.160111
0.8043 --- loss: 0.842927, loss_ss: 0.834437, loss_d: 0.008489
0.8426 --- loss: 0.723494, loss_ss: 0.690935, loss_d: 0.032559
0.8809 --- loss: 0.647216, loss_ss: 0.644333, loss_d: 0.002882
0.9192 --- loss: 0.603321, loss_ss: 0.589121, loss_d: 0.014200
0.9575 --- loss: 1.113056, loss_ss: 0.634998, loss_d: 0.478059
0.9958 --- loss: 0.806893, loss_ss: 0.747931, loss_d: 0.058962
Epoch finished! Loss: 0.8972591734937324
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.591358024691358
             precision    recall  f1-score   support

        0.0       0.12      0.90      0.22        30
        1.0       0.00      0.00      0.00        67
        2.0       0.78      0.73      0.75       427
        3.0       0.98      0.46      0.62       114
        4.0       0.67      0.51      0.58       172

avg / total       0.69      0.59      0.62       810
 


====== chc025-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  76.17  90.00   75.64  12.44     21.86
1  90.86   0.00   99.06   0.00      0.00
2  74.69  73.07   76.50  77.61     75.27
3  92.22  45.61   99.86  98.11     62.28
4  84.32  51.16   93.26  67.18     58.09
Total accuracy: 59.14%
Average sen: 51.97%
Average spec: 88.86%
Macro f1-score: 43.50%
Diagnosis acc on 15mins: 1.0
[9.08056099e-04 2.77115521e-03 6.88019674e-04 1.81296072e-03
 1.46052828e-02 2.90932739e-03 9.02613346e-03 1.20690640e-03
 6.55041076e-05 5.15944674e-04 6.00208470e-04 1.56861697e-05
 1.50792957e-05 4.69767947e-05 1.23585225e-04 4.13848211e-05
 2.10395403e-04 3.51332419e-04 4.83307871e-04 3.02361965e-04
 6.38711848e-04 3.36018653e-04 8.50276483e-05 1.39180789e-04
 7.37175986e-04 2.37804838e-04 1.49034895e-04]
pred: 0.0014452801342486055, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.313273, loss_ss: 1.576128, loss_d: 0.737146
0.0383 --- loss: 2.275694, loss_ss: 1.528670, loss_d: 0.747024
0.0767 --- loss: 2.435236, loss_ss: 1.658961, loss_d: 0.776275
0.1150 --- loss: 1.953180, loss_ss: 1.419843, loss_d: 0.533337
0.1534 --- loss: 1.892349, loss_ss: 1.323198, loss_d: 0.569151
0.1917 --- loss: 2.055881, loss_ss: 1.399190, loss_d: 0.656691
0.2301 --- loss: 1.712602, loss_ss: 1.267896, loss_d: 0.444706
0.2684 --- loss: 1.911361, loss_ss: 1.308094, loss_d: 0.603267
0.3067 --- loss: 1.700837, loss_ss: 1.183169, loss_d: 0.517667
0.3451 --- loss: 1.789687, loss_ss: 1.299386, loss_d: 0.490301
0.3834 --- loss: 1.729434, loss_ss: 1.138765, loss_d: 0.590669
0.4218 --- loss: 1.899279, loss_ss: 1.384726, loss_d: 0.514553
0.4601 --- loss: 2.025558, loss_ss: 1.173408, loss_d: 0.852150
0.4985 --- loss: 1.613394, loss_ss: 1.060506, loss_d: 0.552888
0.5368 --- loss: 1.593757, loss_ss: 1.250487, loss_d: 0.343270
0.5752 --- loss: 1.405993, loss_ss: 1.201379, loss_d: 0.204614
0.6135 --- loss: 1.710083, loss_ss: 1.189373, loss_d: 0.520710
0.6518 --- loss: 1.326422, loss_ss: 0.952965, loss_d: 0.373458
0.6902 --- loss: 1.318009, loss_ss: 0.968978, loss_d: 0.349031
0.7285 --- loss: 1.707432, loss_ss: 1.254696, loss_d: 0.452736
0.7669 --- loss: 1.290761, loss_ss: 1.077441, loss_d: 0.213320
0.8052 --- loss: 1.891234, loss_ss: 1.227105, loss_d: 0.664130
0.8436 --- loss: 1.823568, loss_ss: 1.204626, loss_d: 0.618941
0.8819 --- loss: 2.069468, loss_ss: 1.322175, loss_d: 0.747294
0.9202 --- loss: 1.521840, loss_ss: 1.155188, loss_d: 0.366653
0.9586 --- loss: 1.397287, loss_ss: 1.020304, loss_d: 0.376983
0.9969 --- loss: 1.921795, loss_ss: 1.231166, loss_d: 0.690629
Epoch finished! Loss: 1.7911623963942895
Starting epoch 2/10.
0.0000 --- loss: 1.291443, loss_ss: 0.958055, loss_d: 0.333389
0.0383 --- loss: 1.360504, loss_ss: 1.170582, loss_d: 0.189922
0.0767 --- loss: 1.439341, loss_ss: 1.050039, loss_d: 0.389302
0.1150 --- loss: 1.569173, loss_ss: 1.137102, loss_d: 0.432071
0.1534 --- loss: 1.163644, loss_ss: 0.983050, loss_d: 0.180594
0.1917 --- loss: 1.073628, loss_ss: 0.899275, loss_d: 0.174353
0.2301 --- loss: 2.254413, loss_ss: 1.060072, loss_d: 1.194340
0.2684 --- loss: 1.111398, loss_ss: 0.905127, loss_d: 0.206271
0.3067 --- loss: 1.519087, loss_ss: 1.048998, loss_d: 0.470088
0.3451 --- loss: 1.544095, loss_ss: 1.150563, loss_d: 0.393532
0.3834 --- loss: 1.633038, loss_ss: 1.041672, loss_d: 0.591366
0.4218 --- loss: 1.640426, loss_ss: 0.828800, loss_d: 0.811625
0.4601 --- loss: 1.326938, loss_ss: 0.959019, loss_d: 0.367918
0.4985 --- loss: 1.332134, loss_ss: 1.094363, loss_d: 0.237772
0.5368 --- loss: 1.205658, loss_ss: 0.821200, loss_d: 0.384458
0.5752 --- loss: 1.527709, loss_ss: 1.156377, loss_d: 0.371331
0.6135 --- loss: 1.475388, loss_ss: 1.022504, loss_d: 0.452883
0.6518 --- loss: 1.408264, loss_ss: 0.910401, loss_d: 0.497864
0.6902 --- loss: 1.228531, loss_ss: 0.971462, loss_d: 0.257068
0.7285 --- loss: 1.114003, loss_ss: 0.884789, loss_d: 0.229214
0.7669 --- loss: 1.295051, loss_ss: 1.128643, loss_d: 0.166408
0.8052 --- loss: 1.245654, loss_ss: 0.860684, loss_d: 0.384970
0.8436 --- loss: 1.094141, loss_ss: 0.774766, loss_d: 0.319375
0.8819 --- loss: 1.050785, loss_ss: 0.902131, loss_d: 0.148653
0.9202 --- loss: 0.903592, loss_ss: 0.787072, loss_d: 0.116520
0.9586 --- loss: 1.225954, loss_ss: 0.951791, loss_d: 0.274163
0.9969 --- loss: 1.115582, loss_ss: 1.000468, loss_d: 0.115114
Epoch finished! Loss: 1.3421192948634808
Starting epoch 3/10.
0.0000 --- loss: 0.990101, loss_ss: 0.849386, loss_d: 0.140715
0.0383 --- loss: 1.501767, loss_ss: 1.416815, loss_d: 0.084952
0.0767 --- loss: 1.274240, loss_ss: 1.065833, loss_d: 0.208407
0.1150 --- loss: 0.858459, loss_ss: 0.776770, loss_d: 0.081688
0.1534 --- loss: 1.214769, loss_ss: 0.802917, loss_d: 0.411851
0.1917 --- loss: 1.256938, loss_ss: 0.797619, loss_d: 0.459319
0.2301 --- loss: 0.888457, loss_ss: 0.792896, loss_d: 0.095562
0.2684 --- loss: 0.932739, loss_ss: 0.827743, loss_d: 0.104996
0.3067 --- loss: 1.049581, loss_ss: 0.767087, loss_d: 0.282494
0.3451 --- loss: 1.156537, loss_ss: 0.877251, loss_d: 0.279286
0.3834 --- loss: 1.075595, loss_ss: 0.959648, loss_d: 0.115946
0.4218 --- loss: 0.996557, loss_ss: 0.935040, loss_d: 0.061516
0.4601 --- loss: 0.886528, loss_ss: 0.780677, loss_d: 0.105852
0.4985 --- loss: 0.944870, loss_ss: 0.815570, loss_d: 0.129300
0.5368 --- loss: 1.267893, loss_ss: 0.858405, loss_d: 0.409488
0.5752 --- loss: 0.997442, loss_ss: 0.889912, loss_d: 0.107530
0.6135 --- loss: 0.958512, loss_ss: 0.831709, loss_d: 0.126803
0.6518 --- loss: 1.086589, loss_ss: 0.837031, loss_d: 0.249558
0.6902 --- loss: 1.355295, loss_ss: 1.031883, loss_d: 0.323412
0.7285 --- loss: 0.895954, loss_ss: 0.713684, loss_d: 0.182270
0.7669 --- loss: 1.360138, loss_ss: 1.170151, loss_d: 0.189987
0.8052 --- loss: 1.192744, loss_ss: 0.867372, loss_d: 0.325372
0.8436 --- loss: 1.151683, loss_ss: 0.916824, loss_d: 0.234859
0.8819 --- loss: 1.168027, loss_ss: 0.901505, loss_d: 0.266522
0.9202 --- loss: 0.937217, loss_ss: 0.737911, loss_d: 0.199306
0.9586 --- loss: 1.249472, loss_ss: 0.990923, loss_d: 0.258549
0.9969 --- loss: 0.886961, loss_ss: 0.781311, loss_d: 0.105650
Epoch finished! Loss: 1.190100484398695
Starting epoch 4/10.
0.0000 --- loss: 1.160776, loss_ss: 0.903107, loss_d: 0.257669
0.0383 --- loss: 1.234490, loss_ss: 1.149863, loss_d: 0.084627
0.0767 --- loss: 1.184790, loss_ss: 0.898650, loss_d: 0.286141
0.1150 --- loss: 1.235449, loss_ss: 1.083079, loss_d: 0.152369
0.1534 --- loss: 1.162538, loss_ss: 0.833498, loss_d: 0.329040
0.1917 --- loss: 1.294653, loss_ss: 1.144449, loss_d: 0.150203
0.2301 --- loss: 1.158157, loss_ss: 0.946973, loss_d: 0.211184
0.2684 --- loss: 0.854329, loss_ss: 0.709512, loss_d: 0.144818
0.3067 --- loss: 1.276348, loss_ss: 1.169088, loss_d: 0.107260
0.3451 --- loss: 0.834250, loss_ss: 0.799947, loss_d: 0.034303
0.3834 --- loss: 1.333219, loss_ss: 0.727685, loss_d: 0.605533
0.4218 --- loss: 0.988188, loss_ss: 0.877769, loss_d: 0.110419
0.4601 --- loss: 0.837360, loss_ss: 0.798298, loss_d: 0.039061
0.4985 --- loss: 1.196666, loss_ss: 0.886669, loss_d: 0.309996
0.5368 --- loss: 1.196116, loss_ss: 0.765368, loss_d: 0.430748
0.5752 --- loss: 1.161791, loss_ss: 1.039534, loss_d: 0.122257
0.6135 --- loss: 1.070455, loss_ss: 0.747272, loss_d: 0.323183
0.6518 --- loss: 0.879224, loss_ss: 0.678441, loss_d: 0.200783
0.6902 --- loss: 1.050573, loss_ss: 0.963539, loss_d: 0.087035
0.7285 --- loss: 0.996712, loss_ss: 0.948184, loss_d: 0.048527
0.7669 --- loss: 1.007968, loss_ss: 0.761994, loss_d: 0.245974
0.8052 --- loss: 1.071859, loss_ss: 0.882468, loss_d: 0.189391
0.8436 --- loss: 0.983390, loss_ss: 0.935109, loss_d: 0.048281
0.8819 --- loss: 0.914699, loss_ss: 0.879141, loss_d: 0.035558
0.9202 --- loss: 0.903539, loss_ss: 0.862614, loss_d: 0.040924
0.9586 --- loss: 0.880926, loss_ss: 0.848738, loss_d: 0.032187
0.9969 --- loss: 0.712125, loss_ss: 0.607044, loss_d: 0.105081
Epoch finished! Loss: 1.046783411502838
Starting epoch 5/10.
0.0000 --- loss: 1.404328, loss_ss: 1.285071, loss_d: 0.119256
0.0383 --- loss: 0.768374, loss_ss: 0.669912, loss_d: 0.098462
0.0767 --- loss: 0.953537, loss_ss: 0.875258, loss_d: 0.078278
0.1150 --- loss: 0.981970, loss_ss: 0.854942, loss_d: 0.127028
0.1534 --- loss: 0.853032, loss_ss: 0.812127, loss_d: 0.040905
0.1917 --- loss: 1.980890, loss_ss: 1.429752, loss_d: 0.551138
0.2301 --- loss: 0.943637, loss_ss: 0.730731, loss_d: 0.212906
0.2684 --- loss: 1.144096, loss_ss: 0.961522, loss_d: 0.182575
0.3067 --- loss: 0.890492, loss_ss: 0.705176, loss_d: 0.185316
0.3451 --- loss: 0.981925, loss_ss: 0.834213, loss_d: 0.147713
0.3834 --- loss: 1.094071, loss_ss: 0.822268, loss_d: 0.271804
0.4218 --- loss: 0.913311, loss_ss: 0.753781, loss_d: 0.159530
0.4601 --- loss: 0.733932, loss_ss: 0.628824, loss_d: 0.105108
0.4985 --- loss: 1.270859, loss_ss: 0.754960, loss_d: 0.515899
0.5368 --- loss: 0.792006, loss_ss: 0.748077, loss_d: 0.043929
0.5752 --- loss: 1.245549, loss_ss: 1.003325, loss_d: 0.242224
0.6135 --- loss: 0.718752, loss_ss: 0.705095, loss_d: 0.013657
0.6518 --- loss: 1.481197, loss_ss: 0.682022, loss_d: 0.799176
0.6902 --- loss: 1.873629, loss_ss: 0.757157, loss_d: 1.116472
0.7285 --- loss: 1.038959, loss_ss: 0.725794, loss_d: 0.313164
0.7669 --- loss: 0.626256, loss_ss: 0.591985, loss_d: 0.034272
0.8052 --- loss: 0.528054, loss_ss: 0.467869, loss_d: 0.060185
0.8436 --- loss: 1.068176, loss_ss: 0.665812, loss_d: 0.402364
0.8819 --- loss: 0.709305, loss_ss: 0.656516, loss_d: 0.052788
0.9202 --- loss: 0.889436, loss_ss: 0.708818, loss_d: 0.180618
0.9586 --- loss: 0.885537, loss_ss: 0.750492, loss_d: 0.135045
0.9969 --- loss: 1.087288, loss_ss: 0.817914, loss_d: 0.269374
Epoch finished! Loss: 1.0053688817299329
Starting epoch 6/10.
0.0000 --- loss: 0.854017, loss_ss: 0.714590, loss_d: 0.139426
0.0383 --- loss: 0.762209, loss_ss: 0.735540, loss_d: 0.026669
0.0767 --- loss: 0.999956, loss_ss: 0.832056, loss_d: 0.167900
0.1150 --- loss: 0.634676, loss_ss: 0.615819, loss_d: 0.018857
0.1534 --- loss: 0.754668, loss_ss: 0.696967, loss_d: 0.057702
0.1917 --- loss: 0.871873, loss_ss: 0.777619, loss_d: 0.094254
0.2301 --- loss: 0.764244, loss_ss: 0.669256, loss_d: 0.094988
0.2684 --- loss: 1.062513, loss_ss: 0.567435, loss_d: 0.495078
0.3067 --- loss: 0.646269, loss_ss: 0.639776, loss_d: 0.006493
0.3451 --- loss: 0.950604, loss_ss: 0.894027, loss_d: 0.056577
0.3834 --- loss: 0.825231, loss_ss: 0.727674, loss_d: 0.097557
0.4218 --- loss: 0.730678, loss_ss: 0.571083, loss_d: 0.159596
0.4601 --- loss: 0.660053, loss_ss: 0.618645, loss_d: 0.041408
0.4985 --- loss: 0.965792, loss_ss: 0.945692, loss_d: 0.020100
0.5368 --- loss: 1.025555, loss_ss: 0.592173, loss_d: 0.433382
0.5752 --- loss: 0.685642, loss_ss: 0.610058, loss_d: 0.075584
0.6135 --- loss: 0.742938, loss_ss: 0.702736, loss_d: 0.040202
0.6518 --- loss: 0.960372, loss_ss: 0.843103, loss_d: 0.117269
0.6902 --- loss: 0.796771, loss_ss: 0.754422, loss_d: 0.042349
0.7285 --- loss: 0.773307, loss_ss: 0.759158, loss_d: 0.014149
0.7669 --- loss: 0.622487, loss_ss: 0.526599, loss_d: 0.095887
0.8052 --- loss: 0.922386, loss_ss: 0.898329, loss_d: 0.024056
0.8436 --- loss: 1.301754, loss_ss: 1.209360, loss_d: 0.092393
0.8819 --- loss: 0.530666, loss_ss: 0.508072, loss_d: 0.022594
0.9202 --- loss: 0.865895, loss_ss: 0.828939, loss_d: 0.036957
0.9586 --- loss: 0.647403, loss_ss: 0.562144, loss_d: 0.085259
0.9969 --- loss: 1.539252, loss_ss: 0.818237, loss_d: 0.721015
Epoch finished! Loss: 0.915909780218051
Starting epoch 7/10.
0.0000 --- loss: 0.913433, loss_ss: 0.735212, loss_d: 0.178221
0.0383 --- loss: 0.705707, loss_ss: 0.636809, loss_d: 0.068898
0.0767 --- loss: 1.057580, loss_ss: 0.618725, loss_d: 0.438856
0.1150 --- loss: 1.031543, loss_ss: 0.981928, loss_d: 0.049615
0.1534 --- loss: 0.663019, loss_ss: 0.632002, loss_d: 0.031017
0.1917 --- loss: 1.783947, loss_ss: 1.225259, loss_d: 0.558688
0.2301 --- loss: 0.809041, loss_ss: 0.786688, loss_d: 0.022353
0.2684 --- loss: 0.776644, loss_ss: 0.680968, loss_d: 0.095677
0.3067 --- loss: 0.870208, loss_ss: 0.849199, loss_d: 0.021009
0.3451 --- loss: 1.020341, loss_ss: 1.009257, loss_d: 0.011084
0.3834 --- loss: 0.810917, loss_ss: 0.634735, loss_d: 0.176183
0.4218 --- loss: 1.048257, loss_ss: 1.042104, loss_d: 0.006153
0.4601 --- loss: 0.581334, loss_ss: 0.570890, loss_d: 0.010443
0.4985 --- loss: 1.066286, loss_ss: 1.042972, loss_d: 0.023314
0.5368 --- loss: 0.656487, loss_ss: 0.646734, loss_d: 0.009753
0.5752 --- loss: 0.925970, loss_ss: 0.886101, loss_d: 0.039869
0.6135 --- loss: 0.781137, loss_ss: 0.761854, loss_d: 0.019283
0.6518 --- loss: 0.771448, loss_ss: 0.757251, loss_d: 0.014196
0.6902 --- loss: 0.816400, loss_ss: 0.804579, loss_d: 0.011822
0.7285 --- loss: 0.735162, loss_ss: 0.682118, loss_d: 0.053044
0.7669 --- loss: 0.496611, loss_ss: 0.444924, loss_d: 0.051688
0.8052 --- loss: 0.678187, loss_ss: 0.662868, loss_d: 0.015319
0.8436 --- loss: 0.826114, loss_ss: 0.642800, loss_d: 0.183314
0.8819 --- loss: 0.946157, loss_ss: 0.740548, loss_d: 0.205609
0.9202 --- loss: 0.668128, loss_ss: 0.587964, loss_d: 0.080165
0.9586 --- loss: 0.792646, loss_ss: 0.730398, loss_d: 0.062247
0.9969 --- loss: 0.841312, loss_ss: 0.826705, loss_d: 0.014607
Epoch finished! Loss: 0.8777406542347028
Starting epoch 8/10.
0.0000 --- loss: 0.706279, loss_ss: 0.583258, loss_d: 0.123021
0.0383 --- loss: 1.007767, loss_ss: 0.988012, loss_d: 0.019756
0.0767 --- loss: 1.113283, loss_ss: 0.997389, loss_d: 0.115894
0.1150 --- loss: 0.582598, loss_ss: 0.535035, loss_d: 0.047563
0.1534 --- loss: 0.929579, loss_ss: 0.865644, loss_d: 0.063935
0.1917 --- loss: 0.865729, loss_ss: 0.834275, loss_d: 0.031455
0.2301 --- loss: 0.628308, loss_ss: 0.597244, loss_d: 0.031064
0.2684 --- loss: 0.911646, loss_ss: 0.843397, loss_d: 0.068249
0.3067 --- loss: 0.957545, loss_ss: 0.941128, loss_d: 0.016417
0.3451 --- loss: 0.715324, loss_ss: 0.709128, loss_d: 0.006197
0.3834 --- loss: 0.926366, loss_ss: 0.922833, loss_d: 0.003532
0.4218 --- loss: 0.880476, loss_ss: 0.862825, loss_d: 0.017651
0.4601 --- loss: 0.660523, loss_ss: 0.658937, loss_d: 0.001585
0.4985 --- loss: 0.778278, loss_ss: 0.572490, loss_d: 0.205788
0.5368 --- loss: 0.844342, loss_ss: 0.663355, loss_d: 0.180987
0.5752 --- loss: 1.078860, loss_ss: 0.730270, loss_d: 0.348590
0.6135 --- loss: 0.951169, loss_ss: 0.662816, loss_d: 0.288353
0.6518 --- loss: 0.780448, loss_ss: 0.716458, loss_d: 0.063990
0.6902 --- loss: 0.604013, loss_ss: 0.488638, loss_d: 0.115375
0.7285 --- loss: 0.670725, loss_ss: 0.538905, loss_d: 0.131820
0.7669 --- loss: 0.809503, loss_ss: 0.663529, loss_d: 0.145974
0.8052 --- loss: 1.219997, loss_ss: 0.925332, loss_d: 0.294665
0.8436 --- loss: 0.724145, loss_ss: 0.692468, loss_d: 0.031676
0.8819 --- loss: 0.918472, loss_ss: 0.908818, loss_d: 0.009654
0.9202 --- loss: 0.680516, loss_ss: 0.648985, loss_d: 0.031531
0.9586 --- loss: 0.584456, loss_ss: 0.542806, loss_d: 0.041650
0.9969 --- loss: 0.708646, loss_ss: 0.698083, loss_d: 0.010563
Epoch finished! Loss: 0.8544243948963972
Starting epoch 9/10.
0.0000 --- loss: 0.963585, loss_ss: 0.834712, loss_d: 0.128873
0.0383 --- loss: 0.917985, loss_ss: 0.912985, loss_d: 0.005000
0.0767 --- loss: 1.091900, loss_ss: 1.079474, loss_d: 0.012426
0.1150 --- loss: 0.549250, loss_ss: 0.537420, loss_d: 0.011830
0.1534 --- loss: 0.599186, loss_ss: 0.532380, loss_d: 0.066806
0.1917 --- loss: 0.685557, loss_ss: 0.678722, loss_d: 0.006835
0.2301 --- loss: 0.737973, loss_ss: 0.732775, loss_d: 0.005198
0.2684 --- loss: 0.758031, loss_ss: 0.754523, loss_d: 0.003508
0.3067 --- loss: 0.575159, loss_ss: 0.561999, loss_d: 0.013160
0.3451 --- loss: 0.633387, loss_ss: 0.431951, loss_d: 0.201436
0.3834 --- loss: 0.728461, loss_ss: 0.691507, loss_d: 0.036955
0.4218 --- loss: 1.296647, loss_ss: 1.280456, loss_d: 0.016191
0.4601 --- loss: 0.665670, loss_ss: 0.661412, loss_d: 0.004258
0.4985 --- loss: 1.610793, loss_ss: 1.162428, loss_d: 0.448365
0.5368 --- loss: 1.072147, loss_ss: 0.927594, loss_d: 0.144553
0.5752 --- loss: 0.981173, loss_ss: 0.779561, loss_d: 0.201612
0.6135 --- loss: 0.774726, loss_ss: 0.754757, loss_d: 0.019968
0.6518 --- loss: 0.589265, loss_ss: 0.528484, loss_d: 0.060781
0.6902 --- loss: 0.932181, loss_ss: 0.917995, loss_d: 0.014186
0.7285 --- loss: 0.574404, loss_ss: 0.552193, loss_d: 0.022211
0.7669 --- loss: 0.762778, loss_ss: 0.728792, loss_d: 0.033986
0.8052 --- loss: 0.756675, loss_ss: 0.722674, loss_d: 0.034001
0.8436 --- loss: 0.593101, loss_ss: 0.591951, loss_d: 0.001150
0.8819 --- loss: 0.647999, loss_ss: 0.581599, loss_d: 0.066400
0.9202 --- loss: 0.506872, loss_ss: 0.484367, loss_d: 0.022506
0.9586 --- loss: 0.573840, loss_ss: 0.556850, loss_d: 0.016991
0.9969 --- loss: 0.798367, loss_ss: 0.669722, loss_d: 0.128646
Epoch finished! Loss: 0.8265345424413681
Starting epoch 10/10.
0.0000 --- loss: 0.641214, loss_ss: 0.621594, loss_d: 0.019620
0.0383 --- loss: 0.748237, loss_ss: 0.612644, loss_d: 0.135593
0.0767 --- loss: 0.587364, loss_ss: 0.573980, loss_d: 0.013384
0.1150 --- loss: 0.679633, loss_ss: 0.513877, loss_d: 0.165756
0.1534 --- loss: 0.679290, loss_ss: 0.672520, loss_d: 0.006770
0.1917 --- loss: 0.781725, loss_ss: 0.736550, loss_d: 0.045175
0.2301 --- loss: 0.628527, loss_ss: 0.590464, loss_d: 0.038062
0.2684 --- loss: 0.699845, loss_ss: 0.679936, loss_d: 0.019909
0.3067 --- loss: 0.969491, loss_ss: 0.950844, loss_d: 0.018647
0.3451 --- loss: 0.726069, loss_ss: 0.709341, loss_d: 0.016728
0.3834 --- loss: 0.994383, loss_ss: 0.980976, loss_d: 0.013407
0.4218 --- loss: 1.263819, loss_ss: 1.180064, loss_d: 0.083755
0.4601 --- loss: 0.878735, loss_ss: 0.773726, loss_d: 0.105008
0.4985 --- loss: 0.709706, loss_ss: 0.705770, loss_d: 0.003935
0.5368 --- loss: 0.758724, loss_ss: 0.751798, loss_d: 0.006926
0.5752 --- loss: 0.709658, loss_ss: 0.707250, loss_d: 0.002408
0.6135 --- loss: 0.817265, loss_ss: 0.806705, loss_d: 0.010560
0.6518 --- loss: 0.801859, loss_ss: 0.798426, loss_d: 0.003433
0.6902 --- loss: 0.789829, loss_ss: 0.720094, loss_d: 0.069735
0.7285 --- loss: 0.833683, loss_ss: 0.526480, loss_d: 0.307203
0.7669 --- loss: 0.701409, loss_ss: 0.698642, loss_d: 0.002767
0.8052 --- loss: 0.642548, loss_ss: 0.619751, loss_d: 0.022797
0.8436 --- loss: 0.720405, loss_ss: 0.630568, loss_d: 0.089837
0.8819 --- loss: 0.917224, loss_ss: 0.602828, loss_d: 0.314396
0.9202 --- loss: 0.915944, loss_ss: 0.885602, loss_d: 0.030343
0.9586 --- loss: 0.852882, loss_ss: 0.721178, loss_d: 0.131704
0.9969 --- loss: 0.793840, loss_ss: 0.792400, loss_d: 0.001441
Epoch finished! Loss: 0.804867140031778
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8066666666666666
             precision    recall  f1-score   support

        0.0       0.98      0.62      0.76       277
        1.0       0.32      0.80      0.45        66
        2.0       0.85      0.94      0.89       293
        3.0       1.00      0.83      0.90       189
        4.0       0.90      0.93      0.92        75

avg / total       0.89      0.81      0.82       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.89  61.73   99.52   98.28     75.83
1  85.78  80.30   86.21   31.55     45.30
2  92.78  94.20   92.09   85.19     89.47
3  96.33  82.54  100.00  100.00     90.43
4  98.56  93.33   99.03   89.74     91.50
Total accuracy: 80.67%
Average sen: 82.42%
Average spec: 95.37%
Macro f1-score: 78.51%
Diagnosis acc on 15mins: 0.7333333333333333
[0.084792   0.04576112 0.09051346 0.05884537 0.1056917  0.18439057
 0.271696   0.01565119 0.10387379 0.22736549 0.9899205  0.99208188
 0.94781452 0.00588753 0.62554824 0.26737487 0.92992532 0.04365396
 0.90961069 0.36557728 0.02513685 0.16417244 0.00516169 0.2699604
 0.02258511 0.00981904 0.01000616 0.98261803 0.8967672  0.00486699]
pred: 0.32190231468218067, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.591478, loss_ss: 1.816609, loss_d: 0.774869
0.0383 --- loss: 2.398325, loss_ss: 1.664500, loss_d: 0.733825
0.0767 --- loss: 2.066219, loss_ss: 1.496043, loss_d: 0.570176
0.1150 --- loss: 2.043425, loss_ss: 1.512793, loss_d: 0.530633
0.1533 --- loss: 1.952075, loss_ss: 1.413178, loss_d: 0.538897
0.1916 --- loss: 2.401173, loss_ss: 1.429939, loss_d: 0.971235
0.2300 --- loss: 2.119721, loss_ss: 1.394019, loss_d: 0.725702
0.2683 --- loss: 1.947215, loss_ss: 1.438639, loss_d: 0.508576
0.3066 --- loss: 1.888142, loss_ss: 1.495106, loss_d: 0.393036
0.3450 --- loss: 2.173527, loss_ss: 1.410675, loss_d: 0.762852
0.3833 --- loss: 2.049563, loss_ss: 1.382185, loss_d: 0.667379
0.4216 --- loss: 1.793801, loss_ss: 1.383103, loss_d: 0.410698
0.4599 --- loss: 1.922802, loss_ss: 1.280590, loss_d: 0.642212
0.4983 --- loss: 1.836375, loss_ss: 1.287393, loss_d: 0.548982
0.5366 --- loss: 1.791058, loss_ss: 1.263818, loss_d: 0.527240
0.5749 --- loss: 1.659095, loss_ss: 1.208616, loss_d: 0.450479
0.6133 --- loss: 1.701424, loss_ss: 1.160564, loss_d: 0.540860
0.6516 --- loss: 1.840602, loss_ss: 1.198347, loss_d: 0.642255
0.6899 --- loss: 1.678094, loss_ss: 1.216168, loss_d: 0.461926
0.7282 --- loss: 2.135197, loss_ss: 1.370398, loss_d: 0.764799
0.7666 --- loss: 1.957271, loss_ss: 1.303251, loss_d: 0.654019
0.8049 --- loss: 1.742052, loss_ss: 1.187405, loss_d: 0.554647
0.8432 --- loss: 1.563523, loss_ss: 1.122208, loss_d: 0.441315
0.8816 --- loss: 1.474876, loss_ss: 1.040614, loss_d: 0.434263
0.9199 --- loss: 1.828928, loss_ss: 1.457893, loss_d: 0.371035
0.9582 --- loss: 1.483996, loss_ss: 1.193673, loss_d: 0.290323
0.9966 --- loss: 1.347576, loss_ss: 1.137336, loss_d: 0.210240
Epoch finished! Loss: 1.8762214958667756
Starting epoch 2/10.
0.0000 --- loss: 1.598065, loss_ss: 1.131806, loss_d: 0.466259
0.0383 --- loss: 1.498422, loss_ss: 1.007605, loss_d: 0.490817
0.0767 --- loss: 1.278908, loss_ss: 1.183557, loss_d: 0.095352
0.1150 --- loss: 1.239511, loss_ss: 1.072150, loss_d: 0.167361
0.1533 --- loss: 1.397463, loss_ss: 1.090004, loss_d: 0.307459
0.1916 --- loss: 1.362134, loss_ss: 0.935325, loss_d: 0.426809
0.2300 --- loss: 1.522529, loss_ss: 1.230063, loss_d: 0.292466
0.2683 --- loss: 1.306981, loss_ss: 0.918369, loss_d: 0.388612
0.3066 --- loss: 1.573454, loss_ss: 1.436863, loss_d: 0.136591
0.3450 --- loss: 1.395795, loss_ss: 1.206832, loss_d: 0.188963
0.3833 --- loss: 1.451200, loss_ss: 1.081132, loss_d: 0.370068
0.4216 --- loss: 1.069102, loss_ss: 1.006120, loss_d: 0.062982
0.4599 --- loss: 1.483465, loss_ss: 0.925472, loss_d: 0.557993
0.4983 --- loss: 1.404371, loss_ss: 1.206750, loss_d: 0.197621
0.5366 --- loss: 1.666658, loss_ss: 0.911613, loss_d: 0.755045
0.5749 --- loss: 1.297378, loss_ss: 1.087772, loss_d: 0.209606
0.6133 --- loss: 1.494661, loss_ss: 1.001546, loss_d: 0.493114
0.6516 --- loss: 1.400234, loss_ss: 1.059779, loss_d: 0.340456
0.6899 --- loss: 1.152200, loss_ss: 1.003273, loss_d: 0.148927
0.7282 --- loss: 1.063930, loss_ss: 0.920218, loss_d: 0.143711
0.7666 --- loss: 1.482477, loss_ss: 1.263545, loss_d: 0.218931
0.8049 --- loss: 1.090242, loss_ss: 0.914320, loss_d: 0.175921
0.8432 --- loss: 1.033249, loss_ss: 0.929986, loss_d: 0.103263
0.8816 --- loss: 1.757205, loss_ss: 1.032358, loss_d: 0.724847
0.9199 --- loss: 1.464906, loss_ss: 1.099430, loss_d: 0.365476
0.9582 --- loss: 1.071553, loss_ss: 0.828564, loss_d: 0.242988
0.9966 --- loss: 1.214110, loss_ss: 1.110623, loss_d: 0.103487
Epoch finished! Loss: 1.3922481825718513
Starting epoch 3/10.
0.0000 --- loss: 1.047509, loss_ss: 0.895947, loss_d: 0.151562
0.0383 --- loss: 1.472665, loss_ss: 0.976070, loss_d: 0.496595
0.0767 --- loss: 1.266676, loss_ss: 1.074664, loss_d: 0.192012
0.1150 --- loss: 1.142656, loss_ss: 0.980287, loss_d: 0.162369
0.1533 --- loss: 1.223644, loss_ss: 1.159685, loss_d: 0.063959
0.1916 --- loss: 1.417868, loss_ss: 0.866785, loss_d: 0.551083
0.2300 --- loss: 1.058305, loss_ss: 0.820637, loss_d: 0.237668
0.2683 --- loss: 1.018506, loss_ss: 0.876300, loss_d: 0.142206
0.3066 --- loss: 1.579291, loss_ss: 0.826642, loss_d: 0.752649
0.3450 --- loss: 1.541507, loss_ss: 1.127068, loss_d: 0.414439
0.3833 --- loss: 0.749470, loss_ss: 0.611464, loss_d: 0.138006
0.4216 --- loss: 1.055597, loss_ss: 0.873007, loss_d: 0.182590
0.4599 --- loss: 1.610232, loss_ss: 0.758863, loss_d: 0.851370
0.4983 --- loss: 1.401775, loss_ss: 0.949661, loss_d: 0.452114
0.5366 --- loss: 1.089978, loss_ss: 0.747451, loss_d: 0.342527
0.5749 --- loss: 1.086301, loss_ss: 0.989196, loss_d: 0.097105
0.6133 --- loss: 1.092845, loss_ss: 0.902945, loss_d: 0.189901
0.6516 --- loss: 1.130126, loss_ss: 1.055681, loss_d: 0.074445
0.6899 --- loss: 0.916412, loss_ss: 0.863319, loss_d: 0.053093
0.7282 --- loss: 1.175739, loss_ss: 1.006635, loss_d: 0.169103
0.7666 --- loss: 0.956689, loss_ss: 0.875556, loss_d: 0.081133
0.8049 --- loss: 1.491499, loss_ss: 0.797690, loss_d: 0.693809
0.8432 --- loss: 1.364908, loss_ss: 1.209383, loss_d: 0.155524
0.8816 --- loss: 1.008801, loss_ss: 0.809694, loss_d: 0.199107
0.9199 --- loss: 1.236585, loss_ss: 1.174631, loss_d: 0.061954
0.9582 --- loss: 1.187010, loss_ss: 1.006404, loss_d: 0.180606
0.9966 --- loss: 1.756918, loss_ss: 1.385803, loss_d: 0.371115
Epoch finished! Loss: 1.2257883626681108
Starting epoch 4/10.
0.0000 --- loss: 0.949799, loss_ss: 0.918242, loss_d: 0.031557
0.0383 --- loss: 1.229098, loss_ss: 0.908101, loss_d: 0.320997
0.0767 --- loss: 1.351541, loss_ss: 0.859088, loss_d: 0.492453
0.1150 --- loss: 0.873029, loss_ss: 0.762380, loss_d: 0.110649
0.1533 --- loss: 1.037288, loss_ss: 0.924757, loss_d: 0.112531
0.1916 --- loss: 1.051109, loss_ss: 0.849805, loss_d: 0.201304
0.2300 --- loss: 1.163638, loss_ss: 0.962607, loss_d: 0.201031
0.2683 --- loss: 0.890175, loss_ss: 0.827264, loss_d: 0.062911
0.3066 --- loss: 1.025656, loss_ss: 0.962914, loss_d: 0.062742
0.3450 --- loss: 1.001508, loss_ss: 0.926318, loss_d: 0.075190
0.3833 --- loss: 0.955526, loss_ss: 0.919903, loss_d: 0.035623
0.4216 --- loss: 1.117899, loss_ss: 0.722758, loss_d: 0.395141
0.4599 --- loss: 1.052708, loss_ss: 0.742031, loss_d: 0.310677
0.4983 --- loss: 1.165722, loss_ss: 1.077658, loss_d: 0.088064
0.5366 --- loss: 0.954420, loss_ss: 0.860403, loss_d: 0.094017
0.5749 --- loss: 1.579865, loss_ss: 0.936641, loss_d: 0.643224
0.6133 --- loss: 1.252234, loss_ss: 1.097018, loss_d: 0.155216
0.6516 --- loss: 1.036061, loss_ss: 0.862696, loss_d: 0.173365
0.6899 --- loss: 0.852185, loss_ss: 0.709186, loss_d: 0.142998
0.7282 --- loss: 1.462137, loss_ss: 1.025152, loss_d: 0.436985
0.7666 --- loss: 1.398561, loss_ss: 0.794695, loss_d: 0.603867
0.8049 --- loss: 0.927120, loss_ss: 0.801914, loss_d: 0.125206
0.8432 --- loss: 1.026256, loss_ss: 0.929646, loss_d: 0.096610
0.8816 --- loss: 1.371702, loss_ss: 1.213623, loss_d: 0.158079
0.9199 --- loss: 1.146661, loss_ss: 0.976634, loss_d: 0.170027
0.9582 --- loss: 1.286437, loss_ss: 0.956236, loss_d: 0.330201
0.9966 --- loss: 1.006386, loss_ss: 0.923264, loss_d: 0.083122
Epoch finished! Loss: 1.1253005449588482
Starting epoch 5/10.
0.0000 --- loss: 1.102878, loss_ss: 1.066894, loss_d: 0.035984
0.0383 --- loss: 0.849284, loss_ss: 0.828542, loss_d: 0.020742
0.0767 --- loss: 0.988026, loss_ss: 0.722358, loss_d: 0.265668
0.1150 --- loss: 1.481265, loss_ss: 1.302041, loss_d: 0.179224
0.1533 --- loss: 0.798008, loss_ss: 0.676749, loss_d: 0.121259
0.1916 --- loss: 1.032661, loss_ss: 0.857912, loss_d: 0.174749
0.2300 --- loss: 0.997515, loss_ss: 0.869496, loss_d: 0.128019
0.2683 --- loss: 1.321061, loss_ss: 1.026998, loss_d: 0.294064
0.3066 --- loss: 1.718210, loss_ss: 0.564377, loss_d: 1.153833
0.3450 --- loss: 1.070616, loss_ss: 0.926935, loss_d: 0.143680
0.3833 --- loss: 1.170546, loss_ss: 0.949708, loss_d: 0.220839
0.4216 --- loss: 1.177226, loss_ss: 0.729323, loss_d: 0.447903
0.4599 --- loss: 0.817456, loss_ss: 0.708970, loss_d: 0.108486
0.4983 --- loss: 1.176229, loss_ss: 0.879764, loss_d: 0.296464
0.5366 --- loss: 1.191266, loss_ss: 0.828315, loss_d: 0.362951
0.5749 --- loss: 1.158294, loss_ss: 1.039499, loss_d: 0.118796
0.6133 --- loss: 1.120858, loss_ss: 0.825392, loss_d: 0.295467
0.6516 --- loss: 0.944169, loss_ss: 0.887366, loss_d: 0.056804
0.6899 --- loss: 0.990943, loss_ss: 0.716176, loss_d: 0.274766
0.7282 --- loss: 0.856449, loss_ss: 0.777317, loss_d: 0.079132
0.7666 --- loss: 1.424095, loss_ss: 1.065119, loss_d: 0.358976
0.8049 --- loss: 1.127713, loss_ss: 1.009681, loss_d: 0.118032
0.8432 --- loss: 0.876033, loss_ss: 0.802894, loss_d: 0.073140
0.8816 --- loss: 0.829304, loss_ss: 0.812010, loss_d: 0.017295
0.9199 --- loss: 0.990838, loss_ss: 0.827985, loss_d: 0.162853
0.9582 --- loss: 1.262405, loss_ss: 0.987451, loss_d: 0.274954
0.9966 --- loss: 0.955805, loss_ss: 0.936831, loss_d: 0.018974
Epoch finished! Loss: 1.0472419683749858
Starting epoch 6/10.
0.0000 --- loss: 1.230387, loss_ss: 1.123012, loss_d: 0.107375
0.0383 --- loss: 0.898421, loss_ss: 0.871366, loss_d: 0.027056
0.0767 --- loss: 0.898885, loss_ss: 0.864765, loss_d: 0.034120
0.1150 --- loss: 1.273643, loss_ss: 0.665697, loss_d: 0.607946
0.1533 --- loss: 1.253869, loss_ss: 1.192794, loss_d: 0.061075
0.1916 --- loss: 0.982939, loss_ss: 0.927145, loss_d: 0.055794
0.2300 --- loss: 0.825086, loss_ss: 0.793533, loss_d: 0.031553
0.2683 --- loss: 1.234429, loss_ss: 1.040009, loss_d: 0.194420
0.3066 --- loss: 1.228966, loss_ss: 0.659698, loss_d: 0.569269
0.3450 --- loss: 0.974034, loss_ss: 0.840029, loss_d: 0.134004
0.3833 --- loss: 1.011423, loss_ss: 0.973989, loss_d: 0.037434
0.4216 --- loss: 1.199344, loss_ss: 1.065815, loss_d: 0.133529
0.4599 --- loss: 0.958614, loss_ss: 0.909974, loss_d: 0.048640
0.4983 --- loss: 0.880384, loss_ss: 0.805611, loss_d: 0.074772
0.5366 --- loss: 0.900650, loss_ss: 0.863676, loss_d: 0.036974
0.5749 --- loss: 1.083760, loss_ss: 0.941652, loss_d: 0.142108
0.6133 --- loss: 0.735842, loss_ss: 0.695106, loss_d: 0.040736
0.6516 --- loss: 0.879136, loss_ss: 0.854863, loss_d: 0.024273
0.6899 --- loss: 1.132164, loss_ss: 0.749209, loss_d: 0.382955
0.7282 --- loss: 1.101171, loss_ss: 0.807820, loss_d: 0.293350
0.7666 --- loss: 0.729288, loss_ss: 0.654275, loss_d: 0.075014
0.8049 --- loss: 0.775346, loss_ss: 0.736374, loss_d: 0.038971
0.8432 --- loss: 1.329307, loss_ss: 0.722526, loss_d: 0.606781
0.8816 --- loss: 0.900232, loss_ss: 0.847626, loss_d: 0.052606
0.9199 --- loss: 0.763167, loss_ss: 0.726660, loss_d: 0.036507
0.9582 --- loss: 0.809647, loss_ss: 0.782624, loss_d: 0.027023
0.9966 --- loss: 0.699317, loss_ss: 0.609115, loss_d: 0.090201
Epoch finished! Loss: 0.9694576180898227
Starting epoch 7/10.
0.0000 --- loss: 1.727437, loss_ss: 1.511567, loss_d: 0.215870
0.0383 --- loss: 0.841348, loss_ss: 0.779585, loss_d: 0.061763
0.0767 --- loss: 0.701029, loss_ss: 0.621548, loss_d: 0.079481
0.1150 --- loss: 1.401925, loss_ss: 1.196284, loss_d: 0.205641
0.1533 --- loss: 0.927133, loss_ss: 0.886363, loss_d: 0.040770
0.1916 --- loss: 1.308736, loss_ss: 1.113404, loss_d: 0.195332
0.2300 --- loss: 0.819589, loss_ss: 0.684850, loss_d: 0.134740
0.2683 --- loss: 0.859375, loss_ss: 0.819972, loss_d: 0.039404
0.3066 --- loss: 0.679291, loss_ss: 0.673880, loss_d: 0.005412
0.3450 --- loss: 0.837247, loss_ss: 0.784986, loss_d: 0.052262
0.3833 --- loss: 1.040028, loss_ss: 1.004633, loss_d: 0.035395
0.4216 --- loss: 1.264013, loss_ss: 0.734015, loss_d: 0.529998
0.4599 --- loss: 0.780571, loss_ss: 0.766259, loss_d: 0.014311
0.4983 --- loss: 0.756638, loss_ss: 0.745144, loss_d: 0.011495
0.5366 --- loss: 1.204702, loss_ss: 0.770583, loss_d: 0.434119
0.5749 --- loss: 0.741989, loss_ss: 0.676872, loss_d: 0.065116
0.6133 --- loss: 0.528331, loss_ss: 0.492118, loss_d: 0.036213
0.6516 --- loss: 1.006212, loss_ss: 0.806183, loss_d: 0.200029
0.6899 --- loss: 0.769227, loss_ss: 0.739882, loss_d: 0.029345
0.7282 --- loss: 0.861416, loss_ss: 0.743621, loss_d: 0.117795
0.7666 --- loss: 1.007343, loss_ss: 0.858311, loss_d: 0.149032
0.8049 --- loss: 1.028358, loss_ss: 0.993570, loss_d: 0.034787
0.8432 --- loss: 0.846608, loss_ss: 0.804346, loss_d: 0.042263
0.8816 --- loss: 1.205752, loss_ss: 1.072014, loss_d: 0.133738
0.9199 --- loss: 0.733506, loss_ss: 0.714777, loss_d: 0.018729
0.9582 --- loss: 0.848223, loss_ss: 0.814929, loss_d: 0.033293
0.9966 --- loss: 0.795002, loss_ss: 0.771501, loss_d: 0.023501
Epoch finished! Loss: 0.8995965881989553
Starting epoch 8/10.
0.0000 --- loss: 0.688383, loss_ss: 0.653869, loss_d: 0.034514
0.0383 --- loss: 0.887884, loss_ss: 0.882270, loss_d: 0.005613
0.0767 --- loss: 0.872564, loss_ss: 0.749867, loss_d: 0.122697
0.1150 --- loss: 0.701249, loss_ss: 0.687259, loss_d: 0.013990
0.1533 --- loss: 1.015104, loss_ss: 0.783465, loss_d: 0.231639
0.1916 --- loss: 0.840548, loss_ss: 0.701925, loss_d: 0.138623
0.2300 --- loss: 0.674342, loss_ss: 0.661311, loss_d: 0.013031
0.2683 --- loss: 0.832907, loss_ss: 0.558489, loss_d: 0.274417
0.3066 --- loss: 0.668356, loss_ss: 0.596891, loss_d: 0.071464
0.3450 --- loss: 0.930802, loss_ss: 0.857774, loss_d: 0.073028
0.3833 --- loss: 1.214440, loss_ss: 0.779853, loss_d: 0.434587
0.4216 --- loss: 0.777307, loss_ss: 0.693073, loss_d: 0.084233
0.4599 --- loss: 1.138918, loss_ss: 1.097067, loss_d: 0.041851
0.4983 --- loss: 0.860795, loss_ss: 0.759696, loss_d: 0.101099
0.5366 --- loss: 0.957631, loss_ss: 0.935758, loss_d: 0.021873
0.5749 --- loss: 0.755756, loss_ss: 0.747258, loss_d: 0.008498
0.6133 --- loss: 0.834263, loss_ss: 0.820135, loss_d: 0.014127
0.6516 --- loss: 0.941015, loss_ss: 0.827502, loss_d: 0.113513
0.6899 --- loss: 0.927799, loss_ss: 0.805176, loss_d: 0.122623
0.7282 --- loss: 0.500091, loss_ss: 0.490562, loss_d: 0.009529
0.7666 --- loss: 0.786306, loss_ss: 0.729397, loss_d: 0.056908
0.8049 --- loss: 1.061235, loss_ss: 0.457957, loss_d: 0.603278
0.8432 --- loss: 0.869199, loss_ss: 0.771670, loss_d: 0.097529
0.8816 --- loss: 1.096445, loss_ss: 0.867341, loss_d: 0.229104
0.9199 --- loss: 1.126436, loss_ss: 1.105133, loss_d: 0.021303
0.9582 --- loss: 0.795754, loss_ss: 0.761150, loss_d: 0.034604
0.9966 --- loss: 0.798435, loss_ss: 0.770726, loss_d: 0.027710
Epoch finished! Loss: 0.856925656589178
Starting epoch 9/10.
0.0000 --- loss: 0.633959, loss_ss: 0.525652, loss_d: 0.108306
0.0383 --- loss: 0.963923, loss_ss: 0.949297, loss_d: 0.014626
0.0767 --- loss: 1.087317, loss_ss: 0.757108, loss_d: 0.330210
0.1150 --- loss: 0.787433, loss_ss: 0.688477, loss_d: 0.098956
0.1533 --- loss: 0.730592, loss_ss: 0.700453, loss_d: 0.030140
0.1916 --- loss: 0.818966, loss_ss: 0.808545, loss_d: 0.010421
0.2300 --- loss: 0.809957, loss_ss: 0.802632, loss_d: 0.007325
0.2683 --- loss: 0.951148, loss_ss: 0.863328, loss_d: 0.087820
0.3066 --- loss: 0.935734, loss_ss: 0.910514, loss_d: 0.025220
0.3450 --- loss: 0.927457, loss_ss: 0.893086, loss_d: 0.034371
0.3833 --- loss: 0.741026, loss_ss: 0.679873, loss_d: 0.061154
0.4216 --- loss: 0.885918, loss_ss: 0.695839, loss_d: 0.190079
0.4599 --- loss: 0.395686, loss_ss: 0.389196, loss_d: 0.006490
0.4983 --- loss: 1.268487, loss_ss: 1.145478, loss_d: 0.123010
0.5366 --- loss: 0.497080, loss_ss: 0.476552, loss_d: 0.020528
0.5749 --- loss: 0.936837, loss_ss: 0.909018, loss_d: 0.027819
0.6133 --- loss: 0.611800, loss_ss: 0.478428, loss_d: 0.133371
0.6516 --- loss: 0.589115, loss_ss: 0.582479, loss_d: 0.006635
0.6899 --- loss: 0.887832, loss_ss: 0.646637, loss_d: 0.241194
0.7282 --- loss: 0.864950, loss_ss: 0.589620, loss_d: 0.275330
0.7666 --- loss: 1.161840, loss_ss: 1.025832, loss_d: 0.136008
0.8049 --- loss: 0.847130, loss_ss: 0.808640, loss_d: 0.038490
0.8432 --- loss: 0.754482, loss_ss: 0.687979, loss_d: 0.066503
0.8816 --- loss: 0.685851, loss_ss: 0.682139, loss_d: 0.003712
0.9199 --- loss: 1.125924, loss_ss: 1.112811, loss_d: 0.013113
0.9582 --- loss: 0.705756, loss_ss: 0.662415, loss_d: 0.043341
0.9966 --- loss: 0.849293, loss_ss: 0.838712, loss_d: 0.010581
Epoch finished! Loss: 0.8354537169520672
Starting epoch 10/10.
0.0000 --- loss: 1.022285, loss_ss: 0.972904, loss_d: 0.049380
0.0383 --- loss: 0.445083, loss_ss: 0.435892, loss_d: 0.009190
0.0767 --- loss: 0.459752, loss_ss: 0.446018, loss_d: 0.013734
0.1150 --- loss: 0.677215, loss_ss: 0.545524, loss_d: 0.131691
0.1533 --- loss: 0.533092, loss_ss: 0.515758, loss_d: 0.017335
0.1916 --- loss: 1.007150, loss_ss: 0.766969, loss_d: 0.240181
0.2300 --- loss: 0.790589, loss_ss: 0.775389, loss_d: 0.015199
0.2683 --- loss: 0.624178, loss_ss: 0.601057, loss_d: 0.023122
0.3066 --- loss: 0.692762, loss_ss: 0.635589, loss_d: 0.057173
0.3450 --- loss: 0.839885, loss_ss: 0.775712, loss_d: 0.064173
0.3833 --- loss: 0.772654, loss_ss: 0.756537, loss_d: 0.016117
0.4216 --- loss: 0.621894, loss_ss: 0.605888, loss_d: 0.016006
0.4599 --- loss: 0.709785, loss_ss: 0.599687, loss_d: 0.110098
0.4983 --- loss: 1.084584, loss_ss: 1.068906, loss_d: 0.015678
0.5366 --- loss: 0.765077, loss_ss: 0.737874, loss_d: 0.027203
0.5749 --- loss: 1.233540, loss_ss: 1.054383, loss_d: 0.179157
0.6133 --- loss: 1.025963, loss_ss: 0.948336, loss_d: 0.077626
0.6516 --- loss: 0.699125, loss_ss: 0.604828, loss_d: 0.094296
0.6899 --- loss: 0.684367, loss_ss: 0.674690, loss_d: 0.009677
0.7282 --- loss: 0.750633, loss_ss: 0.632528, loss_d: 0.118105
0.7666 --- loss: 0.756364, loss_ss: 0.719652, loss_d: 0.036712
0.8049 --- loss: 1.056373, loss_ss: 0.773078, loss_d: 0.283295
0.8432 --- loss: 0.887121, loss_ss: 0.881262, loss_d: 0.005859
0.8816 --- loss: 0.670347, loss_ss: 0.661665, loss_d: 0.008682
0.9199 --- loss: 1.137267, loss_ss: 1.093012, loss_d: 0.044255
0.9582 --- loss: 0.875707, loss_ss: 0.871059, loss_d: 0.004649
0.9966 --- loss: 1.841609, loss_ss: 0.857494, loss_d: 0.984115
Epoch finished! Loss: 0.8162163303448604
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7954022988505747
             precision    recall  f1-score   support

        0.0       0.77      0.84      0.80       119
        1.0       0.21      0.40      0.27        53
        2.0       0.92      0.78      0.84       460
        3.0       0.94      0.91      0.93       164
        4.0       0.69      0.85      0.76        74

avg / total       0.84      0.80      0.81       870
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.37  84.03   96.01  76.92     80.32
1  87.24  39.62   90.33  21.00     27.45
2  84.60  77.83   92.20  91.79     84.24
3  97.36  91.46   98.73  94.34     92.88
4  95.52  85.14   96.48  69.23     76.36
Total accuracy: 79.54%
Average sen: 75.62%
Average spec: 94.75%
Macro f1-score: 72.25%
Diagnosis acc on 15mins: 0.2413793103448276
[6.43708587e-01 6.34770036e-01 1.21032909e-01 9.99685764e-01
 9.55967069e-01 9.99540210e-01 9.97696221e-01 9.97374177e-01
 3.41892446e-04 2.32567592e-03 9.64752495e-01 9.96694565e-01
 9.78314996e-01 9.89764571e-01 2.94893563e-01 8.84088814e-01
 3.84031981e-01 9.99991536e-01 9.72636640e-01 9.96480942e-01
 9.21936989e-01 7.90030658e-01 8.08872402e-01 2.20000461e-01
 1.57850015e-03 9.58547771e-01 9.99340236e-01 8.91365826e-01
 9.93089497e-01]
pred: 0.7378915511503221, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.302317, loss_ss: 1.620543, loss_d: 0.681773
0.0383 --- loss: 1.883430, loss_ss: 1.438867, loss_d: 0.444562
0.0767 --- loss: 2.089679, loss_ss: 1.501326, loss_d: 0.588353
0.1150 --- loss: 1.948335, loss_ss: 1.377969, loss_d: 0.570366
0.1533 --- loss: 1.950553, loss_ss: 1.397901, loss_d: 0.552652
0.1916 --- loss: 1.974628, loss_ss: 1.207605, loss_d: 0.767023
0.2300 --- loss: 2.456111, loss_ss: 1.263617, loss_d: 1.192494
0.2683 --- loss: 2.047091, loss_ss: 1.388882, loss_d: 0.658210
0.3066 --- loss: 1.952948, loss_ss: 1.150911, loss_d: 0.802037
0.3450 --- loss: 2.120575, loss_ss: 1.418168, loss_d: 0.702407
0.3833 --- loss: 1.974696, loss_ss: 1.061748, loss_d: 0.912948
0.4216 --- loss: 1.812729, loss_ss: 1.214895, loss_d: 0.597835
0.4599 --- loss: 1.432944, loss_ss: 0.997944, loss_d: 0.435000
0.4983 --- loss: 1.787838, loss_ss: 1.209687, loss_d: 0.578151
0.5366 --- loss: 1.759627, loss_ss: 1.355466, loss_d: 0.404160
0.5749 --- loss: 1.405606, loss_ss: 1.089595, loss_d: 0.316011
0.6133 --- loss: 1.657144, loss_ss: 1.112184, loss_d: 0.544959
0.6516 --- loss: 1.536718, loss_ss: 0.981029, loss_d: 0.555689
0.6899 --- loss: 2.061523, loss_ss: 1.304452, loss_d: 0.757071
0.7282 --- loss: 1.457642, loss_ss: 1.059910, loss_d: 0.397732
0.7666 --- loss: 1.850994, loss_ss: 1.220356, loss_d: 0.630638
0.8049 --- loss: 1.917723, loss_ss: 1.144308, loss_d: 0.773416
0.8432 --- loss: 1.324366, loss_ss: 1.048634, loss_d: 0.275733
0.8816 --- loss: 1.268196, loss_ss: 0.892099, loss_d: 0.376097
0.9199 --- loss: 1.202918, loss_ss: 0.930365, loss_d: 0.272553
0.9582 --- loss: 1.651309, loss_ss: 1.219598, loss_d: 0.431711
0.9966 --- loss: 1.030594, loss_ss: 0.918729, loss_d: 0.111865
Epoch finished! Loss: 1.7624873340129852
Starting epoch 2/10.
0.0000 --- loss: 1.300481, loss_ss: 1.090563, loss_d: 0.209918
0.0383 --- loss: 1.479950, loss_ss: 1.156386, loss_d: 0.323564
0.0767 --- loss: 1.413109, loss_ss: 1.015075, loss_d: 0.398034
0.1150 --- loss: 1.500183, loss_ss: 1.107014, loss_d: 0.393169
0.1533 --- loss: 1.665746, loss_ss: 1.380949, loss_d: 0.284797
0.1916 --- loss: 1.503031, loss_ss: 1.173250, loss_d: 0.329781
0.2300 --- loss: 1.144100, loss_ss: 0.970069, loss_d: 0.174032
0.2683 --- loss: 0.967133, loss_ss: 0.912257, loss_d: 0.054875
0.3066 --- loss: 1.069507, loss_ss: 0.921404, loss_d: 0.148103
0.3450 --- loss: 1.130028, loss_ss: 0.817976, loss_d: 0.312052
0.3833 --- loss: 1.938714, loss_ss: 0.993460, loss_d: 0.945254
0.4216 --- loss: 1.725418, loss_ss: 1.302942, loss_d: 0.422477
0.4599 --- loss: 1.769565, loss_ss: 1.077028, loss_d: 0.692536
0.4983 --- loss: 1.118181, loss_ss: 0.949079, loss_d: 0.169102
0.5366 --- loss: 1.094945, loss_ss: 0.925921, loss_d: 0.169024
0.5749 --- loss: 1.751771, loss_ss: 1.375353, loss_d: 0.376418
0.6133 --- loss: 0.920135, loss_ss: 0.772620, loss_d: 0.147516
0.6516 --- loss: 1.506441, loss_ss: 0.942864, loss_d: 0.563578
0.6899 --- loss: 1.218101, loss_ss: 0.966740, loss_d: 0.251361
0.7282 --- loss: 0.931373, loss_ss: 0.778448, loss_d: 0.152925
0.7666 --- loss: 0.953758, loss_ss: 0.842350, loss_d: 0.111408
0.8049 --- loss: 1.020584, loss_ss: 0.855782, loss_d: 0.164802
0.8432 --- loss: 1.093196, loss_ss: 0.971220, loss_d: 0.121976
0.8816 --- loss: 1.587355, loss_ss: 1.062201, loss_d: 0.525154
0.9199 --- loss: 1.110045, loss_ss: 0.993309, loss_d: 0.116736
0.9582 --- loss: 1.313634, loss_ss: 0.998677, loss_d: 0.314957
0.9966 --- loss: 1.872417, loss_ss: 1.519952, loss_d: 0.352465
Epoch finished! Loss: 1.3453045659340346
Starting epoch 3/10.
0.0000 --- loss: 1.186990, loss_ss: 1.036654, loss_d: 0.150336
0.0383 --- loss: 1.152114, loss_ss: 0.928889, loss_d: 0.223225
0.0767 --- loss: 1.098503, loss_ss: 0.909213, loss_d: 0.189290
0.1150 --- loss: 1.221169, loss_ss: 0.903682, loss_d: 0.317486
0.1533 --- loss: 1.144213, loss_ss: 0.956742, loss_d: 0.187471
0.1916 --- loss: 0.996034, loss_ss: 0.680648, loss_d: 0.315386
0.2300 --- loss: 1.322171, loss_ss: 1.182246, loss_d: 0.139924
0.2683 --- loss: 1.468673, loss_ss: 1.133521, loss_d: 0.335151
0.3066 --- loss: 1.043527, loss_ss: 0.834601, loss_d: 0.208926
0.3450 --- loss: 1.018090, loss_ss: 0.685262, loss_d: 0.332828
0.3833 --- loss: 1.231850, loss_ss: 0.849245, loss_d: 0.382605
0.4216 --- loss: 1.519425, loss_ss: 0.966112, loss_d: 0.553313
0.4599 --- loss: 1.800614, loss_ss: 1.420971, loss_d: 0.379643
0.4983 --- loss: 1.267117, loss_ss: 0.814201, loss_d: 0.452916
0.5366 --- loss: 1.348048, loss_ss: 0.785875, loss_d: 0.562173
0.5749 --- loss: 0.850491, loss_ss: 0.776848, loss_d: 0.073643
0.6133 --- loss: 1.043733, loss_ss: 0.849950, loss_d: 0.193783
0.6516 --- loss: 1.173238, loss_ss: 0.752263, loss_d: 0.420976
0.6899 --- loss: 0.846877, loss_ss: 0.746746, loss_d: 0.100131
0.7282 --- loss: 1.151151, loss_ss: 0.729478, loss_d: 0.421673
0.7666 --- loss: 1.026995, loss_ss: 0.734744, loss_d: 0.292251
0.8049 --- loss: 1.251435, loss_ss: 1.074451, loss_d: 0.176984
0.8432 --- loss: 0.867248, loss_ss: 0.802613, loss_d: 0.064635
0.8816 --- loss: 0.920966, loss_ss: 0.867050, loss_d: 0.053916
0.9199 --- loss: 0.868277, loss_ss: 0.782795, loss_d: 0.085482
0.9582 --- loss: 0.939625, loss_ss: 0.706437, loss_d: 0.233188
0.9966 --- loss: 0.810022, loss_ss: 0.718329, loss_d: 0.091694
Epoch finished! Loss: 1.159569948223921
Starting epoch 4/10.
0.0000 --- loss: 1.164813, loss_ss: 0.807228, loss_d: 0.357585
0.0383 --- loss: 1.275052, loss_ss: 1.078973, loss_d: 0.196078
0.0767 --- loss: 0.892049, loss_ss: 0.798949, loss_d: 0.093100
0.1150 --- loss: 1.238338, loss_ss: 1.070732, loss_d: 0.167606
0.1533 --- loss: 1.645667, loss_ss: 0.943541, loss_d: 0.702125
0.1916 --- loss: 1.155791, loss_ss: 0.777194, loss_d: 0.378598
0.2300 --- loss: 0.828475, loss_ss: 0.711976, loss_d: 0.116498
0.2683 --- loss: 1.479187, loss_ss: 0.855885, loss_d: 0.623302
0.3066 --- loss: 1.213318, loss_ss: 1.065733, loss_d: 0.147585
0.3450 --- loss: 0.847654, loss_ss: 0.733099, loss_d: 0.114554
0.3833 --- loss: 1.208654, loss_ss: 0.879682, loss_d: 0.328971
0.4216 --- loss: 1.120993, loss_ss: 0.806541, loss_d: 0.314452
0.4599 --- loss: 1.005860, loss_ss: 0.755696, loss_d: 0.250165
0.4983 --- loss: 1.032337, loss_ss: 0.781605, loss_d: 0.250732
0.5366 --- loss: 0.835307, loss_ss: 0.665226, loss_d: 0.170081
0.5749 --- loss: 0.965409, loss_ss: 0.766967, loss_d: 0.198443
0.6133 --- loss: 1.152873, loss_ss: 0.859112, loss_d: 0.293760
0.6516 --- loss: 0.809700, loss_ss: 0.734076, loss_d: 0.075624
0.6899 --- loss: 1.142482, loss_ss: 1.063209, loss_d: 0.079273
0.7282 --- loss: 0.879945, loss_ss: 0.824420, loss_d: 0.055525
0.7666 --- loss: 0.840713, loss_ss: 0.736729, loss_d: 0.103984
0.8049 --- loss: 1.061808, loss_ss: 1.018630, loss_d: 0.043178
0.8432 --- loss: 0.928077, loss_ss: 0.871005, loss_d: 0.057072
0.8816 --- loss: 0.999676, loss_ss: 0.892924, loss_d: 0.106752
0.9199 --- loss: 1.258009, loss_ss: 0.957496, loss_d: 0.300513
0.9582 --- loss: 0.818458, loss_ss: 0.752204, loss_d: 0.066254
0.9966 --- loss: 1.593514, loss_ss: 0.823573, loss_d: 0.769941
Epoch finished! Loss: 1.062431892981896
Starting epoch 5/10.
0.0000 --- loss: 1.018480, loss_ss: 0.756064, loss_d: 0.262415
0.0383 --- loss: 0.969745, loss_ss: 0.637659, loss_d: 0.332086
0.0767 --- loss: 1.090396, loss_ss: 0.895197, loss_d: 0.195199
0.1150 --- loss: 1.256371, loss_ss: 0.901324, loss_d: 0.355047
0.1533 --- loss: 1.390822, loss_ss: 1.080057, loss_d: 0.310765
0.1916 --- loss: 0.992392, loss_ss: 0.923410, loss_d: 0.068982
0.2300 --- loss: 1.012365, loss_ss: 0.949535, loss_d: 0.062830
0.2683 --- loss: 0.780925, loss_ss: 0.717230, loss_d: 0.063696
0.3066 --- loss: 0.750801, loss_ss: 0.712713, loss_d: 0.038088
0.3450 --- loss: 0.523460, loss_ss: 0.450725, loss_d: 0.072734
0.3833 --- loss: 1.101612, loss_ss: 0.946580, loss_d: 0.155032
0.4216 --- loss: 1.156436, loss_ss: 0.616488, loss_d: 0.539947
0.4599 --- loss: 0.717171, loss_ss: 0.631334, loss_d: 0.085836
0.4983 --- loss: 0.875484, loss_ss: 0.514543, loss_d: 0.360941
0.5366 --- loss: 0.883996, loss_ss: 0.815360, loss_d: 0.068635
0.5749 --- loss: 1.071719, loss_ss: 0.868403, loss_d: 0.203315
0.6133 --- loss: 0.958681, loss_ss: 0.891815, loss_d: 0.066866
0.6516 --- loss: 1.303739, loss_ss: 1.094605, loss_d: 0.209134
0.6899 --- loss: 1.245838, loss_ss: 0.838737, loss_d: 0.407101
0.7282 --- loss: 0.956953, loss_ss: 0.938761, loss_d: 0.018192
0.7666 --- loss: 0.924667, loss_ss: 0.835813, loss_d: 0.088854
0.8049 --- loss: 0.812487, loss_ss: 0.775773, loss_d: 0.036714
0.8432 --- loss: 0.530748, loss_ss: 0.487026, loss_d: 0.043722
0.8816 --- loss: 0.895895, loss_ss: 0.727554, loss_d: 0.168341
0.9199 --- loss: 1.229978, loss_ss: 0.884572, loss_d: 0.345406
0.9582 --- loss: 0.944162, loss_ss: 0.720016, loss_d: 0.224146
0.9966 --- loss: 0.935992, loss_ss: 0.774901, loss_d: 0.161091
Epoch finished! Loss: 1.0142906383826182
Starting epoch 6/10.
0.0000 --- loss: 0.952033, loss_ss: 0.882412, loss_d: 0.069621
0.0383 --- loss: 1.188174, loss_ss: 0.767727, loss_d: 0.420447
0.0767 --- loss: 0.671549, loss_ss: 0.613026, loss_d: 0.058522
0.1150 --- loss: 0.985915, loss_ss: 0.966962, loss_d: 0.018953
0.1533 --- loss: 0.828178, loss_ss: 0.815373, loss_d: 0.012806
0.1916 --- loss: 0.800010, loss_ss: 0.729295, loss_d: 0.070714
0.2300 --- loss: 0.899324, loss_ss: 0.688978, loss_d: 0.210346
0.2683 --- loss: 0.624399, loss_ss: 0.590255, loss_d: 0.034143
0.3066 --- loss: 1.161455, loss_ss: 1.083360, loss_d: 0.078095
0.3450 --- loss: 0.648380, loss_ss: 0.603451, loss_d: 0.044930
0.3833 --- loss: 1.023314, loss_ss: 0.964347, loss_d: 0.058967
0.4216 --- loss: 0.983555, loss_ss: 0.766037, loss_d: 0.217518
0.4599 --- loss: 0.955337, loss_ss: 0.630079, loss_d: 0.325259
0.4983 --- loss: 0.926995, loss_ss: 0.724510, loss_d: 0.202485
0.5366 --- loss: 0.656181, loss_ss: 0.562933, loss_d: 0.093248
0.5749 --- loss: 0.719967, loss_ss: 0.577198, loss_d: 0.142769
0.6133 --- loss: 0.792553, loss_ss: 0.780759, loss_d: 0.011794
0.6516 --- loss: 0.901274, loss_ss: 0.855655, loss_d: 0.045619
0.6899 --- loss: 1.018942, loss_ss: 0.754001, loss_d: 0.264941
0.7282 --- loss: 1.186028, loss_ss: 0.736475, loss_d: 0.449553
0.7666 --- loss: 0.635108, loss_ss: 0.598605, loss_d: 0.036504
0.8049 --- loss: 0.848062, loss_ss: 0.781716, loss_d: 0.066346
0.8432 --- loss: 0.971769, loss_ss: 0.902745, loss_d: 0.069024
0.8816 --- loss: 0.885846, loss_ss: 0.610373, loss_d: 0.275474
0.9199 --- loss: 0.651916, loss_ss: 0.590924, loss_d: 0.060992
0.9582 --- loss: 0.791854, loss_ss: 0.742247, loss_d: 0.049606
0.9966 --- loss: 0.795421, loss_ss: 0.723252, loss_d: 0.072169
Epoch finished! Loss: 0.9428499575990897
Starting epoch 7/10.
0.0000 --- loss: 0.705703, loss_ss: 0.586103, loss_d: 0.119600
0.0383 --- loss: 1.534620, loss_ss: 0.895949, loss_d: 0.638670
0.0767 --- loss: 0.716158, loss_ss: 0.615626, loss_d: 0.100532
0.1150 --- loss: 0.792050, loss_ss: 0.702896, loss_d: 0.089154
0.1533 --- loss: 0.751597, loss_ss: 0.658969, loss_d: 0.092628
0.1916 --- loss: 0.719617, loss_ss: 0.701506, loss_d: 0.018110
0.2300 --- loss: 1.133986, loss_ss: 0.922782, loss_d: 0.211204
0.2683 --- loss: 1.031927, loss_ss: 0.995038, loss_d: 0.036889
0.3066 --- loss: 0.885965, loss_ss: 0.861458, loss_d: 0.024507
0.3450 --- loss: 0.857606, loss_ss: 0.845469, loss_d: 0.012137
0.3833 --- loss: 0.731482, loss_ss: 0.662350, loss_d: 0.069132
0.4216 --- loss: 0.853993, loss_ss: 0.838749, loss_d: 0.015244
0.4599 --- loss: 0.766034, loss_ss: 0.734260, loss_d: 0.031773
0.4983 --- loss: 0.791766, loss_ss: 0.660911, loss_d: 0.130855
0.5366 --- loss: 0.775681, loss_ss: 0.491758, loss_d: 0.283923
0.5749 --- loss: 0.886313, loss_ss: 0.834352, loss_d: 0.051961
0.6133 --- loss: 0.561085, loss_ss: 0.525100, loss_d: 0.035984
0.6516 --- loss: 0.678515, loss_ss: 0.663384, loss_d: 0.015132
0.6899 --- loss: 0.610379, loss_ss: 0.551201, loss_d: 0.059178
0.7282 --- loss: 0.750710, loss_ss: 0.647294, loss_d: 0.103416
0.7666 --- loss: 0.761940, loss_ss: 0.565152, loss_d: 0.196787
0.8049 --- loss: 0.711363, loss_ss: 0.698079, loss_d: 0.013285
0.8432 --- loss: 0.556272, loss_ss: 0.549650, loss_d: 0.006621
0.8816 --- loss: 0.952806, loss_ss: 0.731618, loss_d: 0.221188
0.9199 --- loss: 0.907563, loss_ss: 0.821421, loss_d: 0.086142
0.9582 --- loss: 0.963890, loss_ss: 0.960397, loss_d: 0.003493
0.9966 --- loss: 0.781815, loss_ss: 0.687773, loss_d: 0.094042
Epoch finished! Loss: 0.9159645553964835
Starting epoch 8/10.
0.0000 --- loss: 0.950272, loss_ss: 0.920848, loss_d: 0.029424
0.0383 --- loss: 1.294820, loss_ss: 0.823321, loss_d: 0.471499
0.0767 --- loss: 0.872862, loss_ss: 0.804685, loss_d: 0.068177
0.1150 --- loss: 0.968897, loss_ss: 0.958079, loss_d: 0.010818
0.1533 --- loss: 0.708100, loss_ss: 0.649070, loss_d: 0.059030
0.1916 --- loss: 0.947197, loss_ss: 0.936987, loss_d: 0.010210
0.2300 --- loss: 0.942430, loss_ss: 0.789911, loss_d: 0.152519
0.2683 --- loss: 0.868691, loss_ss: 0.836073, loss_d: 0.032618
0.3066 --- loss: 1.048465, loss_ss: 0.948593, loss_d: 0.099872
0.3450 --- loss: 1.173849, loss_ss: 0.884837, loss_d: 0.289012
0.3833 --- loss: 0.527620, loss_ss: 0.513707, loss_d: 0.013913
0.4216 --- loss: 0.854144, loss_ss: 0.846758, loss_d: 0.007386
0.4599 --- loss: 0.588720, loss_ss: 0.572152, loss_d: 0.016568
0.4983 --- loss: 0.597189, loss_ss: 0.579608, loss_d: 0.017581
0.5366 --- loss: 0.716144, loss_ss: 0.635717, loss_d: 0.080427
0.5749 --- loss: 0.737995, loss_ss: 0.662268, loss_d: 0.075727
0.6133 --- loss: 0.738189, loss_ss: 0.720164, loss_d: 0.018026
0.6516 --- loss: 1.034477, loss_ss: 0.942997, loss_d: 0.091480
0.6899 --- loss: 1.073493, loss_ss: 0.871629, loss_d: 0.201864
0.7282 --- loss: 1.147304, loss_ss: 0.775698, loss_d: 0.371607
0.7666 --- loss: 0.648446, loss_ss: 0.625720, loss_d: 0.022726
0.8049 --- loss: 0.633608, loss_ss: 0.625774, loss_d: 0.007833
0.8432 --- loss: 0.717177, loss_ss: 0.670321, loss_d: 0.046855
0.8816 --- loss: 1.118763, loss_ss: 0.725159, loss_d: 0.393604
0.9199 --- loss: 0.997222, loss_ss: 0.681728, loss_d: 0.315494
0.9582 --- loss: 1.167878, loss_ss: 0.777683, loss_d: 0.390195
0.9966 --- loss: 1.036131, loss_ss: 1.014911, loss_d: 0.021221
Epoch finished! Loss: 0.8840544867974062
Starting epoch 9/10.
0.0000 --- loss: 0.877269, loss_ss: 0.743594, loss_d: 0.133675
0.0383 --- loss: 1.076138, loss_ss: 1.058658, loss_d: 0.017480
0.0767 --- loss: 0.714833, loss_ss: 0.690956, loss_d: 0.023877
0.1150 --- loss: 0.652500, loss_ss: 0.618166, loss_d: 0.034334
0.1533 --- loss: 1.112588, loss_ss: 1.094817, loss_d: 0.017771
0.1916 --- loss: 1.091950, loss_ss: 1.075075, loss_d: 0.016875
0.2300 --- loss: 0.762072, loss_ss: 0.742850, loss_d: 0.019222
0.2683 --- loss: 1.066421, loss_ss: 0.821467, loss_d: 0.244954
0.3066 --- loss: 1.046033, loss_ss: 0.925683, loss_d: 0.120350
0.3450 --- loss: 0.983265, loss_ss: 0.843046, loss_d: 0.140219
0.3833 --- loss: 1.205421, loss_ss: 0.982412, loss_d: 0.223009
0.4216 --- loss: 0.610775, loss_ss: 0.590417, loss_d: 0.020357
0.4599 --- loss: 0.804762, loss_ss: 0.799731, loss_d: 0.005031
0.4983 --- loss: 0.933753, loss_ss: 0.876680, loss_d: 0.057073
0.5366 --- loss: 0.592100, loss_ss: 0.546218, loss_d: 0.045882
0.5749 --- loss: 0.478242, loss_ss: 0.459159, loss_d: 0.019084
0.6133 --- loss: 1.438229, loss_ss: 1.304947, loss_d: 0.133282
0.6516 --- loss: 0.803675, loss_ss: 0.763083, loss_d: 0.040592
0.6899 --- loss: 0.724571, loss_ss: 0.702451, loss_d: 0.022121
0.7282 --- loss: 1.135108, loss_ss: 0.904326, loss_d: 0.230783
0.7666 --- loss: 0.854711, loss_ss: 0.847645, loss_d: 0.007066
0.8049 --- loss: 1.061519, loss_ss: 0.822263, loss_d: 0.239256
0.8432 --- loss: 0.866114, loss_ss: 0.849303, loss_d: 0.016811
0.8816 --- loss: 0.973211, loss_ss: 0.899302, loss_d: 0.073908
0.9199 --- loss: 0.987553, loss_ss: 0.938071, loss_d: 0.049481
0.9582 --- loss: 0.782768, loss_ss: 0.640153, loss_d: 0.142615
0.9966 --- loss: 0.655150, loss_ss: 0.566798, loss_d: 0.088352
Epoch finished! Loss: 0.8366565126639146
Starting epoch 10/10.
0.0000 --- loss: 0.587500, loss_ss: 0.577264, loss_d: 0.010236
0.0383 --- loss: 1.044324, loss_ss: 0.613163, loss_d: 0.431161
0.0767 --- loss: 0.714068, loss_ss: 0.712909, loss_d: 0.001159
0.1150 --- loss: 0.860097, loss_ss: 0.838051, loss_d: 0.022046
0.1533 --- loss: 0.785409, loss_ss: 0.627915, loss_d: 0.157494
0.1916 --- loss: 0.921646, loss_ss: 0.842656, loss_d: 0.078990
0.2300 --- loss: 0.847107, loss_ss: 0.832043, loss_d: 0.015064
0.2683 --- loss: 0.708280, loss_ss: 0.694110, loss_d: 0.014170
0.3066 --- loss: 0.969399, loss_ss: 0.891228, loss_d: 0.078171
0.3450 --- loss: 1.125370, loss_ss: 0.927486, loss_d: 0.197884
0.3833 --- loss: 0.888104, loss_ss: 0.875786, loss_d: 0.012317
0.4216 --- loss: 0.921548, loss_ss: 0.911429, loss_d: 0.010119
0.4599 --- loss: 0.632897, loss_ss: 0.611818, loss_d: 0.021079
0.4983 --- loss: 1.518276, loss_ss: 1.480748, loss_d: 0.037528
0.5366 --- loss: 1.334813, loss_ss: 0.934487, loss_d: 0.400327
0.5749 --- loss: 1.019226, loss_ss: 0.704023, loss_d: 0.315202
0.6133 --- loss: 1.383798, loss_ss: 1.365103, loss_d: 0.018696
0.6516 --- loss: 1.122958, loss_ss: 0.717521, loss_d: 0.405437
0.6899 --- loss: 1.108407, loss_ss: 1.099628, loss_d: 0.008778
0.7282 --- loss: 0.880953, loss_ss: 0.804395, loss_d: 0.076558
0.7666 --- loss: 0.591978, loss_ss: 0.586497, loss_d: 0.005481
0.8049 --- loss: 1.009629, loss_ss: 0.961276, loss_d: 0.048354
0.8432 --- loss: 0.847526, loss_ss: 0.794933, loss_d: 0.052593
0.8816 --- loss: 0.931520, loss_ss: 0.676087, loss_d: 0.255433
0.9199 --- loss: 0.604479, loss_ss: 0.590675, loss_d: 0.013803
0.9582 --- loss: 0.787913, loss_ss: 0.780150, loss_d: 0.007763
0.9966 --- loss: 1.113166, loss_ss: 1.074094, loss_d: 0.039073
Epoch finished! Loss: 0.8318215467608892
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7425287356321839
             precision    recall  f1-score   support

        0.0       0.93      0.46      0.61        59
        1.0       0.15      0.05      0.07        60
        2.0       0.93      0.70      0.80       389
        3.0       0.96      0.89      0.92       151
        4.0       0.54      1.00      0.70       211

avg / total       0.79      0.74      0.73       870
 


====== chc033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.09  45.76   99.75  93.10     61.36
1  91.49   5.00   97.90  15.00      7.50
2  84.37  69.92   96.05  93.47     80.00
3  97.47  88.74   99.30  96.40     92.41
4  79.08  99.53   72.53  53.71     69.77
Total accuracy: 74.25%
Average sen: 61.79%
Average spec: 93.11%
Macro f1-score: 62.21%
Diagnosis acc on 15mins: 0.4827586206896552
[0.99999261 0.88235909 0.01643986 0.02849149 0.34976912 0.2696749
 0.4215574  0.39295483 0.95437902 0.16725841 0.21318743 0.2665056
 0.66381389 0.66047198 0.95180494 0.973046   0.65086818 0.88057476
 0.37434208 0.13155286 0.23635375 0.83402777 0.99289215 0.99979275
 0.30638099 0.95807725 0.95050263 0.99785161 0.34185371]
pred: 0.5816130014457579, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.352654, loss_ss: 1.740261, loss_d: 0.612393
0.0383 --- loss: 2.058788, loss_ss: 1.565220, loss_d: 0.493568
0.0767 --- loss: 2.127576, loss_ss: 1.590059, loss_d: 0.537517
0.1150 --- loss: 1.920085, loss_ss: 1.586982, loss_d: 0.333104
0.1534 --- loss: 2.107491, loss_ss: 1.470241, loss_d: 0.637250
0.1917 --- loss: 1.999171, loss_ss: 1.417831, loss_d: 0.581341
0.2301 --- loss: 1.641331, loss_ss: 1.346141, loss_d: 0.295189
0.2684 --- loss: 1.905378, loss_ss: 1.398377, loss_d: 0.507001
0.3067 --- loss: 1.993198, loss_ss: 1.331578, loss_d: 0.661620
0.3451 --- loss: 1.764214, loss_ss: 1.247330, loss_d: 0.516884
0.3834 --- loss: 1.953604, loss_ss: 1.262396, loss_d: 0.691208
0.4218 --- loss: 2.109396, loss_ss: 1.244456, loss_d: 0.864940
0.4601 --- loss: 1.760686, loss_ss: 1.113239, loss_d: 0.647447
0.4985 --- loss: 1.756076, loss_ss: 1.263966, loss_d: 0.492110
0.5368 --- loss: 1.766763, loss_ss: 1.260490, loss_d: 0.506273
0.5752 --- loss: 1.883783, loss_ss: 1.168513, loss_d: 0.715270
0.6135 --- loss: 1.693958, loss_ss: 1.172791, loss_d: 0.521167
0.6518 --- loss: 1.861278, loss_ss: 1.160180, loss_d: 0.701099
0.6902 --- loss: 1.558669, loss_ss: 1.240713, loss_d: 0.317955
0.7285 --- loss: 1.547775, loss_ss: 1.047093, loss_d: 0.500682
0.7669 --- loss: 2.106091, loss_ss: 1.298983, loss_d: 0.807108
0.8052 --- loss: 1.976103, loss_ss: 1.325971, loss_d: 0.650132
0.8436 --- loss: 1.959966, loss_ss: 1.271271, loss_d: 0.688696
0.8819 --- loss: 1.781590, loss_ss: 1.224549, loss_d: 0.557040
0.9202 --- loss: 1.473993, loss_ss: 1.041942, loss_d: 0.432052
0.9586 --- loss: 1.385636, loss_ss: 1.001338, loss_d: 0.384298
0.9969 --- loss: 1.489925, loss_ss: 1.016618, loss_d: 0.473307
Epoch finished! Loss: 1.8464573855583484
Starting epoch 2/10.
0.0000 --- loss: 1.466417, loss_ss: 1.129568, loss_d: 0.336850
0.0383 --- loss: 1.345752, loss_ss: 1.115533, loss_d: 0.230219
0.0767 --- loss: 1.621719, loss_ss: 1.237894, loss_d: 0.383825
0.1150 --- loss: 1.487106, loss_ss: 0.995996, loss_d: 0.491110
0.1534 --- loss: 1.427323, loss_ss: 1.072160, loss_d: 0.355163
0.1917 --- loss: 1.440241, loss_ss: 1.130082, loss_d: 0.310160
0.2301 --- loss: 1.439827, loss_ss: 1.100325, loss_d: 0.339501
0.2684 --- loss: 1.196563, loss_ss: 1.107760, loss_d: 0.088803
0.3067 --- loss: 1.459131, loss_ss: 1.294459, loss_d: 0.164671
0.3451 --- loss: 1.213678, loss_ss: 0.880959, loss_d: 0.332719
0.3834 --- loss: 1.180864, loss_ss: 0.938298, loss_d: 0.242566
0.4218 --- loss: 1.763395, loss_ss: 1.296564, loss_d: 0.466831
0.4601 --- loss: 1.022088, loss_ss: 0.754165, loss_d: 0.267923
0.4985 --- loss: 1.504562, loss_ss: 1.000735, loss_d: 0.503827
0.5368 --- loss: 1.136696, loss_ss: 0.963107, loss_d: 0.173589
0.5752 --- loss: 1.308460, loss_ss: 1.114855, loss_d: 0.193606
0.6135 --- loss: 1.291991, loss_ss: 1.084749, loss_d: 0.207242
0.6518 --- loss: 1.682260, loss_ss: 1.028697, loss_d: 0.653563
0.6902 --- loss: 1.478530, loss_ss: 1.281744, loss_d: 0.196787
0.7285 --- loss: 1.406979, loss_ss: 1.071994, loss_d: 0.334985
0.7669 --- loss: 1.283075, loss_ss: 1.055852, loss_d: 0.227223
0.8052 --- loss: 1.078837, loss_ss: 0.997098, loss_d: 0.081739
0.8436 --- loss: 0.807312, loss_ss: 0.714034, loss_d: 0.093278
0.8819 --- loss: 1.042778, loss_ss: 0.865580, loss_d: 0.177199
0.9202 --- loss: 1.369222, loss_ss: 0.933352, loss_d: 0.435870
0.9586 --- loss: 0.954870, loss_ss: 0.774110, loss_d: 0.180760
0.9969 --- loss: 1.374125, loss_ss: 1.092478, loss_d: 0.281647
Epoch finished! Loss: 1.3625782874914316
Starting epoch 3/10.
0.0000 --- loss: 1.196679, loss_ss: 0.878689, loss_d: 0.317990
0.0383 --- loss: 1.203508, loss_ss: 0.925675, loss_d: 0.277834
0.0767 --- loss: 1.314349, loss_ss: 1.071111, loss_d: 0.243237
0.1150 --- loss: 1.091513, loss_ss: 0.904962, loss_d: 0.186551
0.1534 --- loss: 1.054645, loss_ss: 0.785766, loss_d: 0.268879
0.1917 --- loss: 1.058258, loss_ss: 0.859860, loss_d: 0.198398
0.2301 --- loss: 1.424050, loss_ss: 0.754855, loss_d: 0.669195
0.2684 --- loss: 1.002239, loss_ss: 0.822585, loss_d: 0.179654
0.3067 --- loss: 1.063705, loss_ss: 1.004902, loss_d: 0.058803
0.3451 --- loss: 1.439137, loss_ss: 1.176063, loss_d: 0.263074
0.3834 --- loss: 1.306548, loss_ss: 0.940957, loss_d: 0.365591
0.4218 --- loss: 1.467050, loss_ss: 1.019638, loss_d: 0.447412
0.4601 --- loss: 0.987608, loss_ss: 0.784863, loss_d: 0.202745
0.4985 --- loss: 1.454062, loss_ss: 1.101856, loss_d: 0.352207
0.5368 --- loss: 0.828853, loss_ss: 0.759601, loss_d: 0.069252
0.5752 --- loss: 0.986996, loss_ss: 0.794327, loss_d: 0.192669
0.6135 --- loss: 0.940930, loss_ss: 0.722828, loss_d: 0.218103
0.6518 --- loss: 0.862865, loss_ss: 0.731585, loss_d: 0.131279
0.6902 --- loss: 1.068447, loss_ss: 0.953454, loss_d: 0.114994
0.7285 --- loss: 1.051049, loss_ss: 0.990688, loss_d: 0.060361
0.7669 --- loss: 0.942770, loss_ss: 0.866064, loss_d: 0.076706
0.8052 --- loss: 1.240027, loss_ss: 1.115428, loss_d: 0.124599
0.8436 --- loss: 1.004976, loss_ss: 0.961215, loss_d: 0.043761
0.8819 --- loss: 0.806932, loss_ss: 0.738221, loss_d: 0.068711
0.9202 --- loss: 1.065096, loss_ss: 0.897285, loss_d: 0.167811
0.9586 --- loss: 1.157902, loss_ss: 1.094686, loss_d: 0.063216
0.9969 --- loss: 1.548034, loss_ss: 0.766528, loss_d: 0.781505
Epoch finished! Loss: 1.177368806187923
Starting epoch 4/10.
0.0000 --- loss: 1.830359, loss_ss: 1.075552, loss_d: 0.754807
0.0383 --- loss: 0.963199, loss_ss: 0.886727, loss_d: 0.076472
0.0767 --- loss: 1.170296, loss_ss: 0.914988, loss_d: 0.255309
0.1150 --- loss: 1.222289, loss_ss: 0.779079, loss_d: 0.443210
0.1534 --- loss: 1.002140, loss_ss: 0.895890, loss_d: 0.106250
0.1917 --- loss: 0.883530, loss_ss: 0.746219, loss_d: 0.137311
0.2301 --- loss: 1.315971, loss_ss: 1.064808, loss_d: 0.251162
0.2684 --- loss: 1.056303, loss_ss: 0.701470, loss_d: 0.354833
0.3067 --- loss: 1.075293, loss_ss: 0.969798, loss_d: 0.105495
0.3451 --- loss: 1.477200, loss_ss: 1.156221, loss_d: 0.320979
0.3834 --- loss: 1.026605, loss_ss: 0.749379, loss_d: 0.277226
0.4218 --- loss: 0.840247, loss_ss: 0.765355, loss_d: 0.074892
0.4601 --- loss: 1.486915, loss_ss: 0.902727, loss_d: 0.584188
0.4985 --- loss: 1.008753, loss_ss: 0.837322, loss_d: 0.171431
0.5368 --- loss: 0.804618, loss_ss: 0.726552, loss_d: 0.078066
0.5752 --- loss: 1.059631, loss_ss: 0.908244, loss_d: 0.151387
0.6135 --- loss: 0.982922, loss_ss: 0.682855, loss_d: 0.300067
0.6518 --- loss: 1.096113, loss_ss: 0.671191, loss_d: 0.424922
0.6902 --- loss: 1.030977, loss_ss: 0.789909, loss_d: 0.241069
0.7285 --- loss: 0.990108, loss_ss: 0.884129, loss_d: 0.105978
0.7669 --- loss: 0.848943, loss_ss: 0.674460, loss_d: 0.174482
0.8052 --- loss: 0.978148, loss_ss: 0.927038, loss_d: 0.051110
0.8436 --- loss: 0.625902, loss_ss: 0.594779, loss_d: 0.031123
0.8819 --- loss: 1.006997, loss_ss: 0.954905, loss_d: 0.052092
0.9202 --- loss: 1.320312, loss_ss: 1.004215, loss_d: 0.316097
0.9586 --- loss: 1.088961, loss_ss: 1.030751, loss_d: 0.058210
0.9969 --- loss: 1.073201, loss_ss: 0.959359, loss_d: 0.113842
Epoch finished! Loss: 1.0789143961209517
Starting epoch 5/10.
0.0000 --- loss: 0.901662, loss_ss: 0.833642, loss_d: 0.068019
0.0383 --- loss: 0.734776, loss_ss: 0.599163, loss_d: 0.135613
0.0767 --- loss: 0.841025, loss_ss: 0.779144, loss_d: 0.061882
0.1150 --- loss: 0.994598, loss_ss: 0.901262, loss_d: 0.093336
0.1534 --- loss: 0.723692, loss_ss: 0.664832, loss_d: 0.058860
0.1917 --- loss: 0.924820, loss_ss: 0.684701, loss_d: 0.240119
0.2301 --- loss: 1.166230, loss_ss: 0.655455, loss_d: 0.510775
0.2684 --- loss: 0.879877, loss_ss: 0.784764, loss_d: 0.095113
0.3067 --- loss: 1.602844, loss_ss: 0.964743, loss_d: 0.638102
0.3451 --- loss: 1.246960, loss_ss: 1.042486, loss_d: 0.204474
0.3834 --- loss: 0.963803, loss_ss: 0.725929, loss_d: 0.237875
0.4218 --- loss: 1.308872, loss_ss: 1.175480, loss_d: 0.133392
0.4601 --- loss: 0.946271, loss_ss: 0.912985, loss_d: 0.033285
0.4985 --- loss: 0.866111, loss_ss: 0.666845, loss_d: 0.199265
0.5368 --- loss: 0.769479, loss_ss: 0.716322, loss_d: 0.053158
0.5752 --- loss: 1.063370, loss_ss: 0.890499, loss_d: 0.172871
0.6135 --- loss: 1.180145, loss_ss: 1.114605, loss_d: 0.065540
0.6518 --- loss: 1.222635, loss_ss: 1.088668, loss_d: 0.133966
0.6902 --- loss: 1.266349, loss_ss: 1.143091, loss_d: 0.123258
0.7285 --- loss: 0.922429, loss_ss: 0.837175, loss_d: 0.085254
0.7669 --- loss: 1.200585, loss_ss: 1.056853, loss_d: 0.143733
0.8052 --- loss: 0.938727, loss_ss: 0.923536, loss_d: 0.015191
0.8436 --- loss: 0.964430, loss_ss: 0.861527, loss_d: 0.102903
0.8819 --- loss: 1.017704, loss_ss: 0.902451, loss_d: 0.115254
0.9202 --- loss: 0.991063, loss_ss: 0.846890, loss_d: 0.144174
0.9586 --- loss: 1.246209, loss_ss: 0.800682, loss_d: 0.445527
0.9969 --- loss: 1.689459, loss_ss: 1.014152, loss_d: 0.675307
Epoch finished! Loss: 1.010323455815132
Starting epoch 6/10.
0.0000 --- loss: 0.939409, loss_ss: 0.784528, loss_d: 0.154881
0.0383 --- loss: 1.653069, loss_ss: 1.262751, loss_d: 0.390318
0.0767 --- loss: 0.806682, loss_ss: 0.654513, loss_d: 0.152168
0.1150 --- loss: 1.299095, loss_ss: 1.162416, loss_d: 0.136679
0.1534 --- loss: 0.896530, loss_ss: 0.828602, loss_d: 0.067928
0.1917 --- loss: 0.711566, loss_ss: 0.688242, loss_d: 0.023324
0.2301 --- loss: 1.003107, loss_ss: 0.955433, loss_d: 0.047674
0.2684 --- loss: 0.517836, loss_ss: 0.437750, loss_d: 0.080086
0.3067 --- loss: 0.736698, loss_ss: 0.646338, loss_d: 0.090360
0.3451 --- loss: 0.783090, loss_ss: 0.769111, loss_d: 0.013979
0.3834 --- loss: 1.064558, loss_ss: 1.028615, loss_d: 0.035943
0.4218 --- loss: 0.881717, loss_ss: 0.791325, loss_d: 0.090392
0.4601 --- loss: 0.855590, loss_ss: 0.814283, loss_d: 0.041307
0.4985 --- loss: 1.062988, loss_ss: 0.954401, loss_d: 0.108587
0.5368 --- loss: 1.519149, loss_ss: 1.109170, loss_d: 0.409978
0.5752 --- loss: 1.086743, loss_ss: 0.850544, loss_d: 0.236199
0.6135 --- loss: 1.197929, loss_ss: 0.647165, loss_d: 0.550764
0.6518 --- loss: 0.997237, loss_ss: 0.830735, loss_d: 0.166502
0.6902 --- loss: 1.259880, loss_ss: 0.823854, loss_d: 0.436026
0.7285 --- loss: 1.587887, loss_ss: 1.448668, loss_d: 0.139220
0.7669 --- loss: 0.570198, loss_ss: 0.536325, loss_d: 0.033873
0.8052 --- loss: 1.148929, loss_ss: 1.010129, loss_d: 0.138800
0.8436 --- loss: 1.087709, loss_ss: 0.985410, loss_d: 0.102299
0.8819 --- loss: 0.966699, loss_ss: 0.634399, loss_d: 0.332300
0.9202 --- loss: 0.654853, loss_ss: 0.579508, loss_d: 0.075344
0.9586 --- loss: 0.630161, loss_ss: 0.572196, loss_d: 0.057965
0.9969 --- loss: 1.022515, loss_ss: 0.783956, loss_d: 0.238559
Epoch finished! Loss: 0.9747227865916032
Starting epoch 7/10.
0.0000 --- loss: 0.855493, loss_ss: 0.836269, loss_d: 0.019225
0.0383 --- loss: 1.034619, loss_ss: 0.576108, loss_d: 0.458512
0.0767 --- loss: 0.780316, loss_ss: 0.688058, loss_d: 0.092257
0.1150 --- loss: 0.791196, loss_ss: 0.687569, loss_d: 0.103627
0.1534 --- loss: 0.628086, loss_ss: 0.598400, loss_d: 0.029685
0.1917 --- loss: 0.667776, loss_ss: 0.575857, loss_d: 0.091918
0.2301 --- loss: 0.757596, loss_ss: 0.679221, loss_d: 0.078374
0.2684 --- loss: 0.928438, loss_ss: 0.755136, loss_d: 0.173302
0.3067 --- loss: 1.192345, loss_ss: 1.029917, loss_d: 0.162428
0.3451 --- loss: 1.231879, loss_ss: 1.148137, loss_d: 0.083742
0.3834 --- loss: 0.739838, loss_ss: 0.639863, loss_d: 0.099975
0.4218 --- loss: 1.264184, loss_ss: 1.259146, loss_d: 0.005038
0.4601 --- loss: 0.663316, loss_ss: 0.558013, loss_d: 0.105303
0.4985 --- loss: 1.046713, loss_ss: 0.871319, loss_d: 0.175394
0.5368 --- loss: 0.683272, loss_ss: 0.579912, loss_d: 0.103360
0.5752 --- loss: 1.394039, loss_ss: 0.990459, loss_d: 0.403580
0.6135 --- loss: 1.203027, loss_ss: 0.838140, loss_d: 0.364887
0.6518 --- loss: 0.718847, loss_ss: 0.648865, loss_d: 0.069981
0.6902 --- loss: 0.857374, loss_ss: 0.754859, loss_d: 0.102515
0.7285 --- loss: 1.161983, loss_ss: 0.708338, loss_d: 0.453645
0.7669 --- loss: 0.921533, loss_ss: 0.597393, loss_d: 0.324140
0.8052 --- loss: 0.708547, loss_ss: 0.698526, loss_d: 0.010021
0.8436 --- loss: 0.926740, loss_ss: 0.913980, loss_d: 0.012760
0.8819 --- loss: 0.734367, loss_ss: 0.699399, loss_d: 0.034968
0.9202 --- loss: 0.828040, loss_ss: 0.731893, loss_d: 0.096147
0.9586 --- loss: 0.824653, loss_ss: 0.573904, loss_d: 0.250749
0.9969 --- loss: 0.877190, loss_ss: 0.848398, loss_d: 0.028791
Epoch finished! Loss: 0.9210476967004629
Starting epoch 8/10.
0.0000 --- loss: 0.508658, loss_ss: 0.476857, loss_d: 0.031801
0.0383 --- loss: 1.221428, loss_ss: 0.733373, loss_d: 0.488055
0.0767 --- loss: 0.916197, loss_ss: 0.797557, loss_d: 0.118640
0.1150 --- loss: 1.378615, loss_ss: 1.331775, loss_d: 0.046840
0.1534 --- loss: 0.856854, loss_ss: 0.833227, loss_d: 0.023627
0.1917 --- loss: 0.929741, loss_ss: 0.600130, loss_d: 0.329611
0.2301 --- loss: 1.075845, loss_ss: 1.034131, loss_d: 0.041715
0.2684 --- loss: 1.012138, loss_ss: 0.946917, loss_d: 0.065221
0.3067 --- loss: 0.818147, loss_ss: 0.788693, loss_d: 0.029454
0.3451 --- loss: 0.848738, loss_ss: 0.845378, loss_d: 0.003360
0.3834 --- loss: 0.837230, loss_ss: 0.820255, loss_d: 0.016975
0.4218 --- loss: 0.580844, loss_ss: 0.574713, loss_d: 0.006131
0.4601 --- loss: 1.209254, loss_ss: 1.188316, loss_d: 0.020938
0.4985 --- loss: 0.806513, loss_ss: 0.727831, loss_d: 0.078682
0.5368 --- loss: 1.148415, loss_ss: 1.002202, loss_d: 0.146213
0.5752 --- loss: 0.873650, loss_ss: 0.863359, loss_d: 0.010290
0.6135 --- loss: 0.572870, loss_ss: 0.492634, loss_d: 0.080235
0.6518 --- loss: 0.744037, loss_ss: 0.737494, loss_d: 0.006543
0.6902 --- loss: 0.642217, loss_ss: 0.562096, loss_d: 0.080121
0.7285 --- loss: 0.576343, loss_ss: 0.557186, loss_d: 0.019156
0.7669 --- loss: 1.048916, loss_ss: 1.035598, loss_d: 0.013318
0.8052 --- loss: 0.929372, loss_ss: 0.926964, loss_d: 0.002408
0.8436 --- loss: 0.987249, loss_ss: 0.759234, loss_d: 0.228016
0.8819 --- loss: 0.663203, loss_ss: 0.590169, loss_d: 0.073034
0.9202 --- loss: 0.881098, loss_ss: 0.866388, loss_d: 0.014709
0.9586 --- loss: 1.199107, loss_ss: 0.896817, loss_d: 0.302290
0.9969 --- loss: 0.839512, loss_ss: 0.555326, loss_d: 0.284186
Epoch finished! Loss: 0.8687729716300965
Starting epoch 9/10.
0.0000 --- loss: 1.026985, loss_ss: 0.997194, loss_d: 0.029791
0.0383 --- loss: 0.866024, loss_ss: 0.861673, loss_d: 0.004351
0.0767 --- loss: 0.750647, loss_ss: 0.672584, loss_d: 0.078062
0.1150 --- loss: 0.740332, loss_ss: 0.727359, loss_d: 0.012973
0.1534 --- loss: 0.737697, loss_ss: 0.734353, loss_d: 0.003344
0.1917 --- loss: 0.739055, loss_ss: 0.720222, loss_d: 0.018833
0.2301 --- loss: 0.716688, loss_ss: 0.687193, loss_d: 0.029495
0.2684 --- loss: 0.976065, loss_ss: 0.889125, loss_d: 0.086940
0.3067 --- loss: 0.844865, loss_ss: 0.710104, loss_d: 0.134761
0.3451 --- loss: 0.535791, loss_ss: 0.491266, loss_d: 0.044525
0.3834 --- loss: 0.979208, loss_ss: 0.966094, loss_d: 0.013114
0.4218 --- loss: 0.709567, loss_ss: 0.698992, loss_d: 0.010575
0.4601 --- loss: 0.866325, loss_ss: 0.740451, loss_d: 0.125874
0.4985 --- loss: 0.894459, loss_ss: 0.885707, loss_d: 0.008752
0.5368 --- loss: 0.797009, loss_ss: 0.532044, loss_d: 0.264966
0.5752 --- loss: 0.869340, loss_ss: 0.802286, loss_d: 0.067054
0.6135 --- loss: 0.574694, loss_ss: 0.429716, loss_d: 0.144978
0.6518 --- loss: 0.830062, loss_ss: 0.743469, loss_d: 0.086593
0.6902 --- loss: 0.937119, loss_ss: 0.915734, loss_d: 0.021384
0.7285 --- loss: 1.216461, loss_ss: 0.828148, loss_d: 0.388313
0.7669 --- loss: 0.480573, loss_ss: 0.458821, loss_d: 0.021753
0.8052 --- loss: 0.692665, loss_ss: 0.688177, loss_d: 0.004489
0.8436 --- loss: 0.870568, loss_ss: 0.827267, loss_d: 0.043301
0.8819 --- loss: 0.977930, loss_ss: 0.854954, loss_d: 0.122976
0.9202 --- loss: 0.849696, loss_ss: 0.732332, loss_d: 0.117364
0.9586 --- loss: 0.775323, loss_ss: 0.590477, loss_d: 0.184846
0.9969 --- loss: 0.915896, loss_ss: 0.906296, loss_d: 0.009599
Epoch finished! Loss: 0.8602417699419536
Starting epoch 10/10.
0.0000 --- loss: 0.943418, loss_ss: 0.546836, loss_d: 0.396582
0.0383 --- loss: 0.740041, loss_ss: 0.657079, loss_d: 0.082963
0.0767 --- loss: 0.653943, loss_ss: 0.592026, loss_d: 0.061917
0.1150 --- loss: 0.827459, loss_ss: 0.784244, loss_d: 0.043215
0.1534 --- loss: 0.984961, loss_ss: 0.662157, loss_d: 0.322804
0.1917 --- loss: 0.956338, loss_ss: 0.938685, loss_d: 0.017653
0.2301 --- loss: 1.530275, loss_ss: 1.513106, loss_d: 0.017169
0.2684 --- loss: 0.794318, loss_ss: 0.762770, loss_d: 0.031549
0.3067 --- loss: 1.047171, loss_ss: 1.036258, loss_d: 0.010913
0.3451 --- loss: 0.669022, loss_ss: 0.660506, loss_d: 0.008516
0.3834 --- loss: 1.435734, loss_ss: 1.016464, loss_d: 0.419270
0.4218 --- loss: 0.602485, loss_ss: 0.548271, loss_d: 0.054213
0.4601 --- loss: 0.832936, loss_ss: 0.663828, loss_d: 0.169108
0.4985 --- loss: 0.765447, loss_ss: 0.761414, loss_d: 0.004033
0.5368 --- loss: 0.721578, loss_ss: 0.701411, loss_d: 0.020166
0.5752 --- loss: 0.664448, loss_ss: 0.635539, loss_d: 0.028908
0.6135 --- loss: 0.684774, loss_ss: 0.606992, loss_d: 0.077782
0.6518 --- loss: 0.949827, loss_ss: 0.647953, loss_d: 0.301874
0.6902 --- loss: 1.013251, loss_ss: 0.977322, loss_d: 0.035929
0.7285 --- loss: 1.165091, loss_ss: 0.677684, loss_d: 0.487408
0.7669 --- loss: 0.607905, loss_ss: 0.531413, loss_d: 0.076492
0.8052 --- loss: 0.759390, loss_ss: 0.716646, loss_d: 0.042745
0.8436 --- loss: 0.864554, loss_ss: 0.858277, loss_d: 0.006277
0.8819 --- loss: 0.581401, loss_ss: 0.555069, loss_d: 0.026332
0.9202 --- loss: 0.905532, loss_ss: 0.650087, loss_d: 0.255445
0.9586 --- loss: 0.794467, loss_ss: 0.785247, loss_d: 0.009220
0.9969 --- loss: 0.650647, loss_ss: 0.619662, loss_d: 0.030985
Epoch finished! Loss: 0.8545988335059239
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7177777777777777
             precision    recall  f1-score   support

        0.0       0.69      0.86      0.77        29
        1.0       0.71      0.18      0.28        57
        2.0       0.64      0.97      0.77       391
        3.0       1.00      0.52      0.68       250
        4.0       0.81      0.60      0.69       173

avg / total       0.78      0.72      0.70       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  98.33  86.21   98.74   69.44     76.92
1  94.33  17.54   99.53   71.43     28.17
2  74.67  96.68   57.76   63.74     76.83
3  86.67  52.00  100.00  100.00     68.42
4  89.56  59.54   96.70   81.10     68.67
Total accuracy: 71.78%
Average sen: 62.39%
Average spec: 90.54%
Macro f1-score: 63.80%
Diagnosis acc on 15mins: 0.9666666666666667
[0.13648316 0.0613823  0.01065191 0.00794398 0.01627222 0.00642084
 0.05748964 0.09430877 0.04034562 0.05102337 0.0667387  0.33543807
 0.03258548 0.10869901 0.02097053 0.05120151 0.02159357 0.02079177
 0.01754391 0.00710103 0.01736936 0.64960665 0.00786883 0.00237839
 0.00748983 0.00343799 0.00216139 0.00230564 0.00316185 0.02970225]
pred: 0.06301558596702914, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.456103, loss_ss: 1.666017, loss_d: 0.790086
0.0383 --- loss: 1.564190, loss_ss: 1.425305, loss_d: 0.138885
0.0767 --- loss: 2.228380, loss_ss: 1.694329, loss_d: 0.534051
0.1150 --- loss: 2.325979, loss_ss: 1.353092, loss_d: 0.972888
0.1533 --- loss: 1.902404, loss_ss: 1.344876, loss_d: 0.557528
0.1916 --- loss: 2.092534, loss_ss: 1.343631, loss_d: 0.748903
0.2300 --- loss: 2.189449, loss_ss: 1.353089, loss_d: 0.836360
0.2683 --- loss: 1.819089, loss_ss: 1.239426, loss_d: 0.579664
0.3066 --- loss: 1.960643, loss_ss: 1.366389, loss_d: 0.594254
0.3450 --- loss: 1.844839, loss_ss: 1.241146, loss_d: 0.603694
0.3833 --- loss: 1.767880, loss_ss: 1.372634, loss_d: 0.395246
0.4216 --- loss: 1.618576, loss_ss: 1.210173, loss_d: 0.408402
0.4599 --- loss: 1.732845, loss_ss: 1.148292, loss_d: 0.584552
0.4983 --- loss: 1.501504, loss_ss: 1.196619, loss_d: 0.304885
0.5366 --- loss: 1.820070, loss_ss: 1.091959, loss_d: 0.728111
0.5749 --- loss: 1.917491, loss_ss: 1.293018, loss_d: 0.624473
0.6133 --- loss: 1.790788, loss_ss: 1.386361, loss_d: 0.404426
0.6516 --- loss: 1.644261, loss_ss: 1.222272, loss_d: 0.421989
0.6899 --- loss: 1.640333, loss_ss: 1.420510, loss_d: 0.219823
0.7282 --- loss: 1.457318, loss_ss: 1.184324, loss_d: 0.272994
0.7666 --- loss: 1.388621, loss_ss: 1.248500, loss_d: 0.140120
0.8049 --- loss: 1.605686, loss_ss: 1.074585, loss_d: 0.531101
0.8432 --- loss: 1.529429, loss_ss: 1.258276, loss_d: 0.271153
0.8816 --- loss: 1.764688, loss_ss: 1.338571, loss_d: 0.426117
0.9199 --- loss: 1.856622, loss_ss: 1.428431, loss_d: 0.428191
0.9582 --- loss: 1.730985, loss_ss: 1.490200, loss_d: 0.240785
0.9966 --- loss: 1.635210, loss_ss: 1.218607, loss_d: 0.416603
Epoch finished! Loss: 1.8208208721417647
Starting epoch 2/10.
0.0000 --- loss: 1.770259, loss_ss: 1.236156, loss_d: 0.534103
0.0383 --- loss: 1.407310, loss_ss: 1.004872, loss_d: 0.402437
0.0767 --- loss: 1.295116, loss_ss: 1.144020, loss_d: 0.151096
0.1150 --- loss: 1.176925, loss_ss: 1.004219, loss_d: 0.172705
0.1533 --- loss: 1.260379, loss_ss: 1.061609, loss_d: 0.198770
0.1916 --- loss: 1.306161, loss_ss: 0.849592, loss_d: 0.456569
0.2300 --- loss: 1.608013, loss_ss: 1.075129, loss_d: 0.532883
0.2683 --- loss: 1.128119, loss_ss: 0.980474, loss_d: 0.147645
0.3066 --- loss: 1.027254, loss_ss: 0.921744, loss_d: 0.105510
0.3450 --- loss: 1.598048, loss_ss: 0.942427, loss_d: 0.655622
0.3833 --- loss: 1.328478, loss_ss: 1.071122, loss_d: 0.257356
0.4216 --- loss: 0.947020, loss_ss: 0.896578, loss_d: 0.050441
0.4599 --- loss: 1.435025, loss_ss: 1.090500, loss_d: 0.344525
0.4983 --- loss: 1.799052, loss_ss: 1.163453, loss_d: 0.635599
0.5366 --- loss: 1.221739, loss_ss: 1.114455, loss_d: 0.107284
0.5749 --- loss: 1.151029, loss_ss: 0.957776, loss_d: 0.193253
0.6133 --- loss: 1.189317, loss_ss: 0.787680, loss_d: 0.401637
0.6516 --- loss: 1.189872, loss_ss: 0.972355, loss_d: 0.217517
0.6899 --- loss: 1.032547, loss_ss: 0.953471, loss_d: 0.079077
0.7282 --- loss: 1.180603, loss_ss: 0.977155, loss_d: 0.203449
0.7666 --- loss: 1.898932, loss_ss: 1.095527, loss_d: 0.803406
0.8049 --- loss: 1.591930, loss_ss: 1.249786, loss_d: 0.342144
0.8432 --- loss: 1.276032, loss_ss: 0.837632, loss_d: 0.438400
0.8816 --- loss: 0.989452, loss_ss: 0.834323, loss_d: 0.155129
0.9199 --- loss: 1.712107, loss_ss: 1.159712, loss_d: 0.552395
0.9582 --- loss: 1.497676, loss_ss: 1.012813, loss_d: 0.484863
0.9966 --- loss: 1.529928, loss_ss: 1.060428, loss_d: 0.469500
Epoch finished! Loss: 1.3508501598468194
Starting epoch 3/10.
0.0000 --- loss: 1.396372, loss_ss: 0.977153, loss_d: 0.419219
0.0383 --- loss: 1.102864, loss_ss: 0.996958, loss_d: 0.105905
0.0767 --- loss: 1.215932, loss_ss: 0.956882, loss_d: 0.259050
0.1150 --- loss: 1.206244, loss_ss: 0.921738, loss_d: 0.284505
0.1533 --- loss: 1.528445, loss_ss: 1.464895, loss_d: 0.063549
0.1916 --- loss: 0.802317, loss_ss: 0.663143, loss_d: 0.139174
0.2300 --- loss: 1.049449, loss_ss: 0.955687, loss_d: 0.093762
0.2683 --- loss: 1.232753, loss_ss: 1.072331, loss_d: 0.160422
0.3066 --- loss: 1.313695, loss_ss: 0.942508, loss_d: 0.371187
0.3450 --- loss: 1.227427, loss_ss: 0.809880, loss_d: 0.417547
0.3833 --- loss: 1.154991, loss_ss: 0.986675, loss_d: 0.168316
0.4216 --- loss: 1.526314, loss_ss: 1.111652, loss_d: 0.414661
0.4599 --- loss: 0.796951, loss_ss: 0.648419, loss_d: 0.148532
0.4983 --- loss: 0.890929, loss_ss: 0.817558, loss_d: 0.073371
0.5366 --- loss: 1.281043, loss_ss: 0.765098, loss_d: 0.515946
0.5749 --- loss: 1.300685, loss_ss: 0.896578, loss_d: 0.404107
0.6133 --- loss: 1.171514, loss_ss: 0.875387, loss_d: 0.296127
0.6516 --- loss: 1.098749, loss_ss: 0.781391, loss_d: 0.317358
0.6899 --- loss: 0.999436, loss_ss: 0.902880, loss_d: 0.096557
0.7282 --- loss: 1.347749, loss_ss: 0.846678, loss_d: 0.501070
0.7666 --- loss: 1.231868, loss_ss: 1.021098, loss_d: 0.210770
0.8049 --- loss: 1.207688, loss_ss: 1.152902, loss_d: 0.054785
0.8432 --- loss: 0.874765, loss_ss: 0.772565, loss_d: 0.102200
0.8816 --- loss: 0.954155, loss_ss: 0.782671, loss_d: 0.171484
0.9199 --- loss: 0.994011, loss_ss: 0.922414, loss_d: 0.071597
0.9582 --- loss: 0.996361, loss_ss: 0.889046, loss_d: 0.107315
0.9966 --- loss: 0.906963, loss_ss: 0.675392, loss_d: 0.231571
Epoch finished! Loss: 1.1666255148557516
Starting epoch 4/10.
0.0000 --- loss: 0.915248, loss_ss: 0.830490, loss_d: 0.084757
0.0383 --- loss: 0.994253, loss_ss: 0.965051, loss_d: 0.029201
0.0767 --- loss: 0.809181, loss_ss: 0.659487, loss_d: 0.149694
0.1150 --- loss: 0.807969, loss_ss: 0.692602, loss_d: 0.115367
0.1533 --- loss: 0.823401, loss_ss: 0.714865, loss_d: 0.108536
0.1916 --- loss: 0.916013, loss_ss: 0.706150, loss_d: 0.209863
0.2300 --- loss: 1.209937, loss_ss: 1.018231, loss_d: 0.191706
0.2683 --- loss: 1.257058, loss_ss: 0.947998, loss_d: 0.309060
0.3066 --- loss: 1.035395, loss_ss: 0.932920, loss_d: 0.102475
0.3450 --- loss: 1.128253, loss_ss: 0.905144, loss_d: 0.223109
0.3833 --- loss: 0.962761, loss_ss: 0.803950, loss_d: 0.158812
0.4216 --- loss: 1.324538, loss_ss: 0.971403, loss_d: 0.353135
0.4599 --- loss: 1.127508, loss_ss: 0.763116, loss_d: 0.364391
0.4983 --- loss: 0.722664, loss_ss: 0.673510, loss_d: 0.049155
0.5366 --- loss: 1.667743, loss_ss: 0.830158, loss_d: 0.837585
0.5749 --- loss: 0.822357, loss_ss: 0.730040, loss_d: 0.092318
0.6133 --- loss: 1.045162, loss_ss: 0.846895, loss_d: 0.198266
0.6516 --- loss: 0.985164, loss_ss: 0.807590, loss_d: 0.177574
0.6899 --- loss: 0.969883, loss_ss: 0.706846, loss_d: 0.263036
0.7282 --- loss: 1.523793, loss_ss: 1.324396, loss_d: 0.199396
0.7666 --- loss: 0.742229, loss_ss: 0.686571, loss_d: 0.055658
0.8049 --- loss: 1.269864, loss_ss: 0.888152, loss_d: 0.381712
0.8432 --- loss: 1.168916, loss_ss: 0.978729, loss_d: 0.190187
0.8816 --- loss: 1.563031, loss_ss: 0.813805, loss_d: 0.749226
0.9199 --- loss: 1.014014, loss_ss: 0.874062, loss_d: 0.139952
0.9582 --- loss: 1.181910, loss_ss: 1.056126, loss_d: 0.125784
0.9966 --- loss: 0.899983, loss_ss: 0.819122, loss_d: 0.080861
Epoch finished! Loss: 1.0813337433796661
Starting epoch 5/10.
0.0000 --- loss: 0.996987, loss_ss: 0.867941, loss_d: 0.129046
0.0383 --- loss: 0.956627, loss_ss: 0.867742, loss_d: 0.088885
0.0767 --- loss: 1.132411, loss_ss: 1.086552, loss_d: 0.045858
0.1150 --- loss: 0.972668, loss_ss: 0.766898, loss_d: 0.205770
0.1533 --- loss: 0.814805, loss_ss: 0.644551, loss_d: 0.170254
0.1916 --- loss: 0.685728, loss_ss: 0.666292, loss_d: 0.019436
0.2300 --- loss: 1.144027, loss_ss: 1.053840, loss_d: 0.090187
0.2683 --- loss: 0.789201, loss_ss: 0.745177, loss_d: 0.044024
0.3066 --- loss: 0.953692, loss_ss: 0.878097, loss_d: 0.075595
0.3450 --- loss: 0.856006, loss_ss: 0.632255, loss_d: 0.223751
0.3833 --- loss: 0.908426, loss_ss: 0.880262, loss_d: 0.028164
0.4216 --- loss: 1.300989, loss_ss: 0.830072, loss_d: 0.470916
0.4599 --- loss: 0.619233, loss_ss: 0.539641, loss_d: 0.079592
0.4983 --- loss: 0.943365, loss_ss: 0.786855, loss_d: 0.156511
0.5366 --- loss: 0.941775, loss_ss: 0.929155, loss_d: 0.012620
0.5749 --- loss: 0.918166, loss_ss: 0.851020, loss_d: 0.067145
0.6133 --- loss: 1.510253, loss_ss: 0.710554, loss_d: 0.799699
0.6516 --- loss: 0.872416, loss_ss: 0.844049, loss_d: 0.028366
0.6899 --- loss: 1.055359, loss_ss: 1.018191, loss_d: 0.037168
0.7282 --- loss: 0.767797, loss_ss: 0.719586, loss_d: 0.048212
0.7666 --- loss: 1.107364, loss_ss: 0.699084, loss_d: 0.408280
0.8049 --- loss: 0.977347, loss_ss: 0.825636, loss_d: 0.151712
0.8432 --- loss: 0.855226, loss_ss: 0.591436, loss_d: 0.263790
0.8816 --- loss: 0.958736, loss_ss: 0.898623, loss_d: 0.060113
0.9199 --- loss: 0.798178, loss_ss: 0.746656, loss_d: 0.051522
0.9582 --- loss: 1.455330, loss_ss: 1.119618, loss_d: 0.335712
0.9966 --- loss: 0.885040, loss_ss: 0.832161, loss_d: 0.052879
Epoch finished! Loss: 1.0017831712961196
Starting epoch 6/10.
0.0000 --- loss: 0.950660, loss_ss: 0.691467, loss_d: 0.259193
0.0383 --- loss: 0.893008, loss_ss: 0.760976, loss_d: 0.132031
0.0767 --- loss: 1.133176, loss_ss: 1.116091, loss_d: 0.017085
0.1150 --- loss: 0.993653, loss_ss: 0.871020, loss_d: 0.122633
0.1533 --- loss: 0.937704, loss_ss: 0.910371, loss_d: 0.027333
0.1916 --- loss: 1.246727, loss_ss: 0.754823, loss_d: 0.491904
0.2300 --- loss: 0.844884, loss_ss: 0.730632, loss_d: 0.114252
0.2683 --- loss: 1.112022, loss_ss: 1.094295, loss_d: 0.017727
0.3066 --- loss: 0.697503, loss_ss: 0.676812, loss_d: 0.020691
0.3450 --- loss: 0.856874, loss_ss: 0.808960, loss_d: 0.047914
0.3833 --- loss: 1.108555, loss_ss: 0.804318, loss_d: 0.304238
0.4216 --- loss: 1.052904, loss_ss: 0.935833, loss_d: 0.117070
0.4599 --- loss: 0.766934, loss_ss: 0.740888, loss_d: 0.026047
0.4983 --- loss: 1.002906, loss_ss: 0.993657, loss_d: 0.009249
0.5366 --- loss: 0.908973, loss_ss: 0.779497, loss_d: 0.129476
0.5749 --- loss: 0.935438, loss_ss: 0.740516, loss_d: 0.194922
0.6133 --- loss: 0.991615, loss_ss: 0.840499, loss_d: 0.151116
0.6516 --- loss: 1.072323, loss_ss: 0.974912, loss_d: 0.097412
0.6899 --- loss: 0.886328, loss_ss: 0.847638, loss_d: 0.038690
0.7282 --- loss: 0.901685, loss_ss: 0.867431, loss_d: 0.034254
0.7666 --- loss: 0.709047, loss_ss: 0.688034, loss_d: 0.021013
0.8049 --- loss: 1.100954, loss_ss: 1.006271, loss_d: 0.094683
0.8432 --- loss: 0.619287, loss_ss: 0.584342, loss_d: 0.034945
0.8816 --- loss: 1.454605, loss_ss: 0.970942, loss_d: 0.483663
0.9199 --- loss: 1.091729, loss_ss: 0.735360, loss_d: 0.356369
0.9582 --- loss: 1.174095, loss_ss: 1.037180, loss_d: 0.136915
0.9966 --- loss: 0.982429, loss_ss: 0.945644, loss_d: 0.036785
Epoch finished! Loss: 0.9427949696779251
Starting epoch 7/10.
0.0000 --- loss: 0.973185, loss_ss: 0.652781, loss_d: 0.320404
0.0383 --- loss: 0.721214, loss_ss: 0.633675, loss_d: 0.087538
0.0767 --- loss: 1.290816, loss_ss: 0.996684, loss_d: 0.294132
0.1150 --- loss: 1.037113, loss_ss: 0.742300, loss_d: 0.294813
0.1533 --- loss: 0.831589, loss_ss: 0.806073, loss_d: 0.025517
0.1916 --- loss: 1.082546, loss_ss: 1.044515, loss_d: 0.038031
0.2300 --- loss: 0.807512, loss_ss: 0.740002, loss_d: 0.067510
0.2683 --- loss: 1.547081, loss_ss: 1.305083, loss_d: 0.241998
0.3066 --- loss: 0.699081, loss_ss: 0.641426, loss_d: 0.057654
0.3450 --- loss: 0.883907, loss_ss: 0.708641, loss_d: 0.175265
0.3833 --- loss: 0.710072, loss_ss: 0.695895, loss_d: 0.014176
0.4216 --- loss: 1.017497, loss_ss: 0.492468, loss_d: 0.525029
0.4599 --- loss: 1.610508, loss_ss: 0.535485, loss_d: 1.075024
0.4983 --- loss: 0.762416, loss_ss: 0.732345, loss_d: 0.030072
0.5366 --- loss: 0.897784, loss_ss: 0.671236, loss_d: 0.226548
0.5749 --- loss: 0.870354, loss_ss: 0.825499, loss_d: 0.044855
0.6133 --- loss: 0.971633, loss_ss: 0.941907, loss_d: 0.029726
0.6516 --- loss: 0.512987, loss_ss: 0.505156, loss_d: 0.007831
0.6899 --- loss: 1.123380, loss_ss: 1.088063, loss_d: 0.035318
0.7282 --- loss: 1.574243, loss_ss: 1.159018, loss_d: 0.415224
0.7666 --- loss: 0.793353, loss_ss: 0.784002, loss_d: 0.009351
0.8049 --- loss: 1.104357, loss_ss: 0.986475, loss_d: 0.117883
0.8432 --- loss: 0.861397, loss_ss: 0.846069, loss_d: 0.015328
0.8816 --- loss: 1.028196, loss_ss: 0.880104, loss_d: 0.148092
0.9199 --- loss: 1.390646, loss_ss: 1.030523, loss_d: 0.360123
0.9582 --- loss: 0.773671, loss_ss: 0.750350, loss_d: 0.023321
0.9966 --- loss: 0.928452, loss_ss: 0.698228, loss_d: 0.230224
Epoch finished! Loss: 0.9079370201780246
Starting epoch 8/10.
0.0000 --- loss: 1.190743, loss_ss: 1.112983, loss_d: 0.077760
0.0383 --- loss: 0.881052, loss_ss: 0.625325, loss_d: 0.255727
0.0767 --- loss: 0.980085, loss_ss: 0.724955, loss_d: 0.255130
0.1150 --- loss: 0.996129, loss_ss: 0.951067, loss_d: 0.045062
0.1533 --- loss: 0.769997, loss_ss: 0.714138, loss_d: 0.055858
0.1916 --- loss: 0.890249, loss_ss: 0.837949, loss_d: 0.052300
0.2300 --- loss: 0.499483, loss_ss: 0.488256, loss_d: 0.011227
0.2683 --- loss: 1.029243, loss_ss: 0.762935, loss_d: 0.266308
0.3066 --- loss: 0.948275, loss_ss: 0.636572, loss_d: 0.311702
0.3450 --- loss: 0.652846, loss_ss: 0.577498, loss_d: 0.075347
0.3833 --- loss: 0.953792, loss_ss: 0.750384, loss_d: 0.203409
0.4216 --- loss: 0.941693, loss_ss: 0.688762, loss_d: 0.252932
0.4599 --- loss: 0.864797, loss_ss: 0.847133, loss_d: 0.017664
0.4983 --- loss: 0.918796, loss_ss: 0.904287, loss_d: 0.014510
0.5366 --- loss: 0.889778, loss_ss: 0.605765, loss_d: 0.284013
0.5749 --- loss: 0.726214, loss_ss: 0.704997, loss_d: 0.021217
0.6133 --- loss: 1.083274, loss_ss: 0.870315, loss_d: 0.212959
0.6516 --- loss: 1.336945, loss_ss: 1.282822, loss_d: 0.054123
0.6899 --- loss: 0.490942, loss_ss: 0.468307, loss_d: 0.022636
0.7282 --- loss: 0.638177, loss_ss: 0.627670, loss_d: 0.010507
0.7666 --- loss: 0.651012, loss_ss: 0.635413, loss_d: 0.015598
0.8049 --- loss: 0.634814, loss_ss: 0.610674, loss_d: 0.024140
0.8432 --- loss: 1.008134, loss_ss: 0.936063, loss_d: 0.072071
0.8816 --- loss: 1.002778, loss_ss: 0.754283, loss_d: 0.248496
0.9199 --- loss: 0.785558, loss_ss: 0.783679, loss_d: 0.001879
0.9582 --- loss: 0.770983, loss_ss: 0.627505, loss_d: 0.143477
0.9966 --- loss: 1.151537, loss_ss: 1.005633, loss_d: 0.145904
Epoch finished! Loss: 0.8746386003035765
Starting epoch 9/10.
0.0000 --- loss: 0.871138, loss_ss: 0.814514, loss_d: 0.056624
0.0383 --- loss: 0.689147, loss_ss: 0.578045, loss_d: 0.111102
0.0767 --- loss: 0.979647, loss_ss: 0.824563, loss_d: 0.155084
0.1150 --- loss: 0.633135, loss_ss: 0.581940, loss_d: 0.051196
0.1533 --- loss: 1.008340, loss_ss: 0.885193, loss_d: 0.123148
0.1916 --- loss: 0.740393, loss_ss: 0.714936, loss_d: 0.025457
0.2300 --- loss: 0.663875, loss_ss: 0.584449, loss_d: 0.079427
0.2683 --- loss: 0.708107, loss_ss: 0.685078, loss_d: 0.023029
0.3066 --- loss: 0.951951, loss_ss: 0.703195, loss_d: 0.248756
0.3450 --- loss: 0.741340, loss_ss: 0.594843, loss_d: 0.146496
0.3833 --- loss: 0.615775, loss_ss: 0.577177, loss_d: 0.038599
0.4216 --- loss: 0.988749, loss_ss: 0.491239, loss_d: 0.497509
0.4599 --- loss: 0.596322, loss_ss: 0.572912, loss_d: 0.023410
0.4983 --- loss: 0.987564, loss_ss: 0.881189, loss_d: 0.106375
0.5366 --- loss: 1.005609, loss_ss: 0.730186, loss_d: 0.275422
0.5749 --- loss: 0.949616, loss_ss: 0.812951, loss_d: 0.136664
0.6133 --- loss: 0.943009, loss_ss: 0.851843, loss_d: 0.091167
0.6516 --- loss: 0.818954, loss_ss: 0.614283, loss_d: 0.204672
0.6899 --- loss: 0.643232, loss_ss: 0.611788, loss_d: 0.031444
0.7282 --- loss: 0.794670, loss_ss: 0.774106, loss_d: 0.020563
0.7666 --- loss: 1.126665, loss_ss: 1.118538, loss_d: 0.008128
0.8049 --- loss: 0.845217, loss_ss: 0.808945, loss_d: 0.036271
0.8432 --- loss: 0.726932, loss_ss: 0.661469, loss_d: 0.065463
0.8816 --- loss: 0.885106, loss_ss: 0.867048, loss_d: 0.018058
0.9199 --- loss: 0.707479, loss_ss: 0.700752, loss_d: 0.006726
0.9582 --- loss: 0.855424, loss_ss: 0.833893, loss_d: 0.021530
0.9966 --- loss: 0.785392, loss_ss: 0.709225, loss_d: 0.076167
Epoch finished! Loss: 0.8531662809161039
Starting epoch 10/10.
0.0000 --- loss: 0.768351, loss_ss: 0.741276, loss_d: 0.027076
0.0383 --- loss: 0.577463, loss_ss: 0.573857, loss_d: 0.003606
0.0767 --- loss: 0.640690, loss_ss: 0.634603, loss_d: 0.006087
0.1150 --- loss: 0.673717, loss_ss: 0.665674, loss_d: 0.008043
0.1533 --- loss: 0.651045, loss_ss: 0.641377, loss_d: 0.009669
0.1916 --- loss: 0.782516, loss_ss: 0.776657, loss_d: 0.005859
0.2300 --- loss: 1.236176, loss_ss: 0.654692, loss_d: 0.581484
0.2683 --- loss: 0.929162, loss_ss: 0.922933, loss_d: 0.006228
0.3066 --- loss: 0.603341, loss_ss: 0.529786, loss_d: 0.073555
0.3450 --- loss: 0.699785, loss_ss: 0.629192, loss_d: 0.070593
0.3833 --- loss: 0.951342, loss_ss: 0.940739, loss_d: 0.010603
0.4216 --- loss: 0.791210, loss_ss: 0.786445, loss_d: 0.004765
0.4599 --- loss: 0.855523, loss_ss: 0.698218, loss_d: 0.157305
0.4983 --- loss: 0.786071, loss_ss: 0.776826, loss_d: 0.009245
0.5366 --- loss: 0.848355, loss_ss: 0.715584, loss_d: 0.132771
0.5749 --- loss: 0.732466, loss_ss: 0.614574, loss_d: 0.117892
0.6133 --- loss: 0.669090, loss_ss: 0.618034, loss_d: 0.051055
0.6516 --- loss: 0.879414, loss_ss: 0.848200, loss_d: 0.031214
0.6899 --- loss: 0.847040, loss_ss: 0.796087, loss_d: 0.050953
0.7282 --- loss: 1.242554, loss_ss: 0.857856, loss_d: 0.384698
0.7666 --- loss: 0.865088, loss_ss: 0.858610, loss_d: 0.006478
0.8049 --- loss: 1.152785, loss_ss: 1.122216, loss_d: 0.030569
0.8432 --- loss: 0.608437, loss_ss: 0.588774, loss_d: 0.019663
0.8816 --- loss: 0.708981, loss_ss: 0.694383, loss_d: 0.014598
0.9199 --- loss: 1.051305, loss_ss: 0.796931, loss_d: 0.254374
0.9582 --- loss: 0.733113, loss_ss: 0.725376, loss_d: 0.007737
0.9966 --- loss: 0.815129, loss_ss: 0.658731, loss_d: 0.156398
Epoch finished! Loss: 0.8170903094685995
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8793103448275862
             precision    recall  f1-score   support

        0.0       0.85      1.00      0.92       154
        1.0       0.30      0.38      0.33        34
        2.0       0.95      0.84      0.89       307
        3.0       0.94      0.96      0.95       168
        4.0       0.89      0.86      0.87       207

avg / total       0.89      0.88      0.88       870
 


====== chc037-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  96.78  100.00   96.09  84.62     91.67
1  94.02   38.24   96.29  29.55     33.33
2  92.99   84.36   97.69  95.22     89.46
3  98.16   96.43   98.58  94.19     95.29
4  93.91   85.51   96.53  88.50     86.98
Total accuracy: 87.93%
Average sen: 80.91%
Average spec: 97.04%
Macro f1-score: 79.35%
Diagnosis acc on 15mins: 0.3793103448275862
[0.16362524 0.91314018 0.92233002 0.51406592 0.7957955  0.62991661
 0.97769618 0.20197546 0.17880683 0.53711981 0.22578105 0.54243219
 0.10178587 0.91159189 0.67957538 0.7104826  0.83777088 0.06499121
 0.68645841 0.9324457  0.88943136 0.01726239 0.0455867  0.026489
 0.37442559 0.92384225 0.99081928 0.70413381 0.00197575]
pred: 0.5345432089063628, label: 0
Wrong!!! Real Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.579519, loss_ss: 1.774597, loss_d: 0.804922
0.0384 --- loss: 2.203703, loss_ss: 1.530622, loss_d: 0.673080
0.0769 --- loss: 2.537632, loss_ss: 1.676882, loss_d: 0.860750
0.1153 --- loss: 2.430085, loss_ss: 1.682803, loss_d: 0.747282
0.1537 --- loss: 2.265568, loss_ss: 1.397255, loss_d: 0.868313
0.1922 --- loss: 1.903116, loss_ss: 1.379297, loss_d: 0.523819
0.2306 --- loss: 2.233500, loss_ss: 1.640759, loss_d: 0.592740
0.2690 --- loss: 2.173626, loss_ss: 1.639774, loss_d: 0.533852
0.3075 --- loss: 1.596363, loss_ss: 1.347018, loss_d: 0.249345
0.3459 --- loss: 2.038987, loss_ss: 1.428957, loss_d: 0.610030
0.3843 --- loss: 1.932263, loss_ss: 1.394048, loss_d: 0.538215
0.4228 --- loss: 1.998699, loss_ss: 1.334247, loss_d: 0.664452
0.4612 --- loss: 1.808167, loss_ss: 1.270017, loss_d: 0.538149
0.4996 --- loss: 1.892274, loss_ss: 1.413962, loss_d: 0.478313
0.5380 --- loss: 2.135232, loss_ss: 1.507558, loss_d: 0.627674
0.5765 --- loss: 1.906066, loss_ss: 1.378423, loss_d: 0.527643
0.6149 --- loss: 1.868868, loss_ss: 1.453003, loss_d: 0.415865
0.6533 --- loss: 1.788542, loss_ss: 1.285904, loss_d: 0.502638
0.6918 --- loss: 2.153670, loss_ss: 1.142966, loss_d: 1.010704
0.7302 --- loss: 1.702625, loss_ss: 1.349970, loss_d: 0.352654
0.7686 --- loss: 1.878414, loss_ss: 1.159289, loss_d: 0.719124
0.8071 --- loss: 1.634738, loss_ss: 1.186044, loss_d: 0.448693
0.8455 --- loss: 1.935170, loss_ss: 1.173702, loss_d: 0.761468
0.8839 --- loss: 1.774087, loss_ss: 1.295639, loss_d: 0.478448
0.9224 --- loss: 1.575713, loss_ss: 1.209387, loss_d: 0.366326
0.9608 --- loss: 1.586634, loss_ss: 1.164183, loss_d: 0.422451
0.9992 --- loss: 1.215961, loss_ss: 1.015227, loss_d: 0.200733
Epoch finished! Loss: 1.9100670062578642
Starting epoch 2/10.
0.0000 --- loss: 1.470993, loss_ss: 1.187759, loss_d: 0.283234
0.0384 --- loss: 1.389267, loss_ss: 1.140197, loss_d: 0.249070
0.0769 --- loss: 1.287827, loss_ss: 1.070848, loss_d: 0.216980
0.1153 --- loss: 1.349731, loss_ss: 1.104764, loss_d: 0.244967
0.1537 --- loss: 1.276066, loss_ss: 1.107136, loss_d: 0.168930
0.1922 --- loss: 1.631420, loss_ss: 1.289154, loss_d: 0.342266
0.2306 --- loss: 1.348768, loss_ss: 1.147334, loss_d: 0.201434
0.2690 --- loss: 2.173553, loss_ss: 1.386465, loss_d: 0.787088
0.3075 --- loss: 1.251541, loss_ss: 1.143731, loss_d: 0.107811
0.3459 --- loss: 1.400501, loss_ss: 1.242504, loss_d: 0.157997
0.3843 --- loss: 1.353431, loss_ss: 1.053282, loss_d: 0.300148
0.4228 --- loss: 1.290892, loss_ss: 0.967204, loss_d: 0.323688
0.4612 --- loss: 1.667133, loss_ss: 1.060897, loss_d: 0.606236
0.4996 --- loss: 1.680140, loss_ss: 1.170875, loss_d: 0.509265
0.5380 --- loss: 1.156106, loss_ss: 1.045861, loss_d: 0.110245
0.5765 --- loss: 1.286586, loss_ss: 1.104655, loss_d: 0.181931
0.6149 --- loss: 1.624023, loss_ss: 1.032860, loss_d: 0.591163
0.6533 --- loss: 1.352813, loss_ss: 1.060313, loss_d: 0.292500
0.6918 --- loss: 1.518263, loss_ss: 1.432080, loss_d: 0.086184
0.7302 --- loss: 1.424950, loss_ss: 1.172454, loss_d: 0.252496
0.7686 --- loss: 1.294906, loss_ss: 1.012967, loss_d: 0.281939
0.8071 --- loss: 1.187241, loss_ss: 1.031629, loss_d: 0.155612
0.8455 --- loss: 1.447732, loss_ss: 1.108206, loss_d: 0.339525
0.8839 --- loss: 1.203495, loss_ss: 1.064646, loss_d: 0.138849
0.9224 --- loss: 1.479670, loss_ss: 1.083053, loss_d: 0.396617
0.9608 --- loss: 1.534535, loss_ss: 1.174032, loss_d: 0.360503
0.9992 --- loss: 1.929013, loss_ss: 1.207564, loss_d: 0.721449
Epoch finished! Loss: 1.4228063081319515
Starting epoch 3/10.
0.0000 --- loss: 1.247911, loss_ss: 1.025084, loss_d: 0.222827
0.0384 --- loss: 0.918820, loss_ss: 0.774476, loss_d: 0.144343
0.0769 --- loss: 1.230028, loss_ss: 0.967922, loss_d: 0.262106
0.1153 --- loss: 1.322299, loss_ss: 1.131786, loss_d: 0.190514
0.1537 --- loss: 1.222998, loss_ss: 0.916806, loss_d: 0.306193
0.1922 --- loss: 1.033730, loss_ss: 0.946281, loss_d: 0.087449
0.2306 --- loss: 1.165485, loss_ss: 0.986819, loss_d: 0.178667
0.2690 --- loss: 1.131401, loss_ss: 0.977037, loss_d: 0.154363
0.3075 --- loss: 1.034099, loss_ss: 0.947861, loss_d: 0.086238
0.3459 --- loss: 1.610149, loss_ss: 0.982943, loss_d: 0.627206
0.3843 --- loss: 1.368944, loss_ss: 1.127840, loss_d: 0.241105
0.4228 --- loss: 1.238166, loss_ss: 0.963710, loss_d: 0.274457
0.4612 --- loss: 0.917012, loss_ss: 0.846437, loss_d: 0.070575
0.4996 --- loss: 1.176039, loss_ss: 1.098778, loss_d: 0.077260
0.5380 --- loss: 1.126802, loss_ss: 0.908997, loss_d: 0.217804
0.5765 --- loss: 1.089718, loss_ss: 0.998034, loss_d: 0.091683
0.6149 --- loss: 1.257689, loss_ss: 0.934603, loss_d: 0.323085
0.6533 --- loss: 1.190130, loss_ss: 0.942449, loss_d: 0.247681
0.6918 --- loss: 0.777170, loss_ss: 0.718608, loss_d: 0.058563
0.7302 --- loss: 0.788811, loss_ss: 0.694198, loss_d: 0.094613
0.7686 --- loss: 1.257489, loss_ss: 1.156991, loss_d: 0.100498
0.8071 --- loss: 1.159686, loss_ss: 0.880961, loss_d: 0.278725
0.8455 --- loss: 1.222897, loss_ss: 1.017374, loss_d: 0.205523
0.8839 --- loss: 1.580414, loss_ss: 1.093788, loss_d: 0.486626
0.9224 --- loss: 1.283308, loss_ss: 0.938612, loss_d: 0.344697
0.9608 --- loss: 1.036598, loss_ss: 0.941872, loss_d: 0.094726
0.9992 --- loss: 2.289625, loss_ss: 2.262002, loss_d: 0.027623
Epoch finished! Loss: 1.205425819525352
Starting epoch 4/10.
0.0000 --- loss: 1.741510, loss_ss: 1.412978, loss_d: 0.328532
0.0384 --- loss: 1.429502, loss_ss: 1.140002, loss_d: 0.289499
0.0769 --- loss: 1.010957, loss_ss: 0.875694, loss_d: 0.135264
0.1153 --- loss: 0.921881, loss_ss: 0.815081, loss_d: 0.106799
0.1537 --- loss: 1.591208, loss_ss: 1.233917, loss_d: 0.357291
0.1922 --- loss: 1.268154, loss_ss: 0.971290, loss_d: 0.296864
0.2306 --- loss: 1.132914, loss_ss: 1.061739, loss_d: 0.071174
0.2690 --- loss: 0.978909, loss_ss: 0.959744, loss_d: 0.019165
0.3075 --- loss: 0.841979, loss_ss: 0.802017, loss_d: 0.039962
0.3459 --- loss: 1.076029, loss_ss: 0.967313, loss_d: 0.108716
0.3843 --- loss: 0.873755, loss_ss: 0.843751, loss_d: 0.030004
0.4228 --- loss: 0.985280, loss_ss: 0.861776, loss_d: 0.123504
0.4612 --- loss: 0.869074, loss_ss: 0.645258, loss_d: 0.223817
0.4996 --- loss: 1.191791, loss_ss: 0.849723, loss_d: 0.342067
0.5380 --- loss: 0.869951, loss_ss: 0.850191, loss_d: 0.019760
0.5765 --- loss: 1.268860, loss_ss: 1.001044, loss_d: 0.267816
0.6149 --- loss: 1.359113, loss_ss: 1.319538, loss_d: 0.039576
0.6533 --- loss: 0.897051, loss_ss: 0.862021, loss_d: 0.035030
0.6918 --- loss: 1.226240, loss_ss: 1.069849, loss_d: 0.156391
0.7302 --- loss: 1.313102, loss_ss: 1.022317, loss_d: 0.290785
0.7686 --- loss: 0.712157, loss_ss: 0.686443, loss_d: 0.025714
0.8071 --- loss: 1.204710, loss_ss: 1.064036, loss_d: 0.140674
0.8455 --- loss: 1.392692, loss_ss: 0.840194, loss_d: 0.552499
0.8839 --- loss: 0.955392, loss_ss: 0.732893, loss_d: 0.222499
0.9224 --- loss: 0.860199, loss_ss: 0.682377, loss_d: 0.177821
0.9608 --- loss: 1.217202, loss_ss: 0.731565, loss_d: 0.485637
0.9992 --- loss: 0.970660, loss_ss: 0.897887, loss_d: 0.072774
Epoch finished! Loss: 1.0785421000077173
Starting epoch 5/10.
0.0000 --- loss: 0.922658, loss_ss: 0.826760, loss_d: 0.095898
0.0384 --- loss: 1.149779, loss_ss: 0.986680, loss_d: 0.163099
0.0769 --- loss: 1.055949, loss_ss: 0.926216, loss_d: 0.129733
0.1153 --- loss: 0.992471, loss_ss: 0.944320, loss_d: 0.048151
0.1537 --- loss: 0.873206, loss_ss: 0.802645, loss_d: 0.070561
0.1922 --- loss: 1.019574, loss_ss: 0.794331, loss_d: 0.225243
0.2306 --- loss: 1.108761, loss_ss: 0.859433, loss_d: 0.249328
0.2690 --- loss: 1.128790, loss_ss: 1.008567, loss_d: 0.120224
0.3075 --- loss: 0.954807, loss_ss: 0.698950, loss_d: 0.255857
0.3459 --- loss: 1.005990, loss_ss: 0.796276, loss_d: 0.209714
0.3843 --- loss: 1.358614, loss_ss: 0.886216, loss_d: 0.472398
0.4228 --- loss: 0.945761, loss_ss: 0.778806, loss_d: 0.166956
0.4612 --- loss: 1.048166, loss_ss: 1.029897, loss_d: 0.018269
0.4996 --- loss: 0.898356, loss_ss: 0.863977, loss_d: 0.034380
0.5380 --- loss: 1.230380, loss_ss: 0.949725, loss_d: 0.280655
0.5765 --- loss: 0.870889, loss_ss: 0.777966, loss_d: 0.092923
0.6149 --- loss: 1.473227, loss_ss: 1.078677, loss_d: 0.394550
0.6533 --- loss: 1.423978, loss_ss: 1.235593, loss_d: 0.188385
0.6918 --- loss: 0.976451, loss_ss: 0.919918, loss_d: 0.056533
0.7302 --- loss: 1.005758, loss_ss: 0.924136, loss_d: 0.081622
0.7686 --- loss: 1.302202, loss_ss: 0.975545, loss_d: 0.326656
0.8071 --- loss: 1.185760, loss_ss: 0.900933, loss_d: 0.284827
0.8455 --- loss: 0.839196, loss_ss: 0.810015, loss_d: 0.029181
0.8839 --- loss: 0.740455, loss_ss: 0.627906, loss_d: 0.112549
0.9224 --- loss: 1.026705, loss_ss: 1.004665, loss_d: 0.022040
0.9608 --- loss: 0.834156, loss_ss: 0.627571, loss_d: 0.206585
0.9992 --- loss: 1.023656, loss_ss: 1.020768, loss_d: 0.002888
Epoch finished! Loss: 1.0176631356661137
Starting epoch 6/10.
0.0000 --- loss: 1.203809, loss_ss: 1.158661, loss_d: 0.045147
0.0384 --- loss: 0.901556, loss_ss: 0.799304, loss_d: 0.102252
0.0769 --- loss: 0.637512, loss_ss: 0.594012, loss_d: 0.043500
0.1153 --- loss: 0.848808, loss_ss: 0.734298, loss_d: 0.114510
0.1537 --- loss: 0.770993, loss_ss: 0.765243, loss_d: 0.005750
0.1922 --- loss: 1.335379, loss_ss: 1.019804, loss_d: 0.315575
0.2306 --- loss: 1.010191, loss_ss: 0.993265, loss_d: 0.016927
0.2690 --- loss: 0.951321, loss_ss: 0.885050, loss_d: 0.066271
0.3075 --- loss: 0.733488, loss_ss: 0.721681, loss_d: 0.011807
0.3459 --- loss: 1.011958, loss_ss: 0.967763, loss_d: 0.044194
0.3843 --- loss: 0.632767, loss_ss: 0.619079, loss_d: 0.013688
0.4228 --- loss: 0.966650, loss_ss: 0.848710, loss_d: 0.117940
0.4612 --- loss: 0.754985, loss_ss: 0.747455, loss_d: 0.007530
0.4996 --- loss: 0.922360, loss_ss: 0.497643, loss_d: 0.424717
0.5380 --- loss: 0.946847, loss_ss: 0.870620, loss_d: 0.076228
0.5765 --- loss: 1.133261, loss_ss: 1.005078, loss_d: 0.128183
0.6149 --- loss: 1.018889, loss_ss: 0.793819, loss_d: 0.225070
0.6533 --- loss: 0.864164, loss_ss: 0.844455, loss_d: 0.019710
0.6918 --- loss: 0.979242, loss_ss: 0.844442, loss_d: 0.134800
0.7302 --- loss: 1.245112, loss_ss: 1.203981, loss_d: 0.041131
0.7686 --- loss: 0.755199, loss_ss: 0.707363, loss_d: 0.047836
0.8071 --- loss: 1.476123, loss_ss: 1.032855, loss_d: 0.443268
0.8455 --- loss: 0.783470, loss_ss: 0.667887, loss_d: 0.115584
0.8839 --- loss: 0.611470, loss_ss: 0.594265, loss_d: 0.017206
0.9224 --- loss: 0.971827, loss_ss: 0.589543, loss_d: 0.382284
0.9608 --- loss: 0.928639, loss_ss: 0.772308, loss_d: 0.156331
0.9992 --- loss: 2.294162, loss_ss: 1.410366, loss_d: 0.883796
Epoch finished! Loss: 0.9566644785495905
Starting epoch 7/10.
0.0000 --- loss: 1.022465, loss_ss: 0.860606, loss_d: 0.161859
0.0384 --- loss: 0.822914, loss_ss: 0.620526, loss_d: 0.202388
0.0769 --- loss: 0.765033, loss_ss: 0.668205, loss_d: 0.096828
0.1153 --- loss: 1.545056, loss_ss: 1.139449, loss_d: 0.405607
0.1537 --- loss: 0.771615, loss_ss: 0.731745, loss_d: 0.039870
0.1922 --- loss: 0.733526, loss_ss: 0.639242, loss_d: 0.094284
0.2306 --- loss: 1.058199, loss_ss: 0.751140, loss_d: 0.307060
0.2690 --- loss: 0.528062, loss_ss: 0.492495, loss_d: 0.035567
0.3075 --- loss: 1.452302, loss_ss: 1.298670, loss_d: 0.153632
0.3459 --- loss: 1.216162, loss_ss: 1.039573, loss_d: 0.176589
0.3843 --- loss: 1.003837, loss_ss: 0.623019, loss_d: 0.380818
0.4228 --- loss: 0.794498, loss_ss: 0.761856, loss_d: 0.032642
0.4612 --- loss: 1.335340, loss_ss: 1.291010, loss_d: 0.044330
0.4996 --- loss: 0.884378, loss_ss: 0.870732, loss_d: 0.013646
0.5380 --- loss: 0.620392, loss_ss: 0.555835, loss_d: 0.064557
0.5765 --- loss: 0.831144, loss_ss: 0.821742, loss_d: 0.009402
0.6149 --- loss: 0.771611, loss_ss: 0.727473, loss_d: 0.044137
0.6533 --- loss: 0.928926, loss_ss: 0.912129, loss_d: 0.016797
0.6918 --- loss: 0.765855, loss_ss: 0.758316, loss_d: 0.007539
0.7302 --- loss: 0.825791, loss_ss: 0.784478, loss_d: 0.041313
0.7686 --- loss: 0.800276, loss_ss: 0.792324, loss_d: 0.007953
0.8071 --- loss: 0.685256, loss_ss: 0.678355, loss_d: 0.006901
0.8455 --- loss: 1.208667, loss_ss: 1.035832, loss_d: 0.172835
0.8839 --- loss: 0.820276, loss_ss: 0.755628, loss_d: 0.064648
0.9224 --- loss: 0.973892, loss_ss: 0.937172, loss_d: 0.036720
0.9608 --- loss: 1.299374, loss_ss: 1.167757, loss_d: 0.131617
0.9992 --- loss: 0.685394, loss_ss: 0.666845, loss_d: 0.018549
Epoch finished! Loss: 0.9241806871615923
Starting epoch 8/10.
0.0000 --- loss: 1.035329, loss_ss: 0.963643, loss_d: 0.071686
0.0384 --- loss: 0.708349, loss_ss: 0.705564, loss_d: 0.002785
0.0769 --- loss: 1.066622, loss_ss: 0.818444, loss_d: 0.248177
0.1153 --- loss: 0.749644, loss_ss: 0.462022, loss_d: 0.287622
0.1537 --- loss: 0.895305, loss_ss: 0.878419, loss_d: 0.016886
0.1922 --- loss: 0.885909, loss_ss: 0.642185, loss_d: 0.243723
0.2306 --- loss: 0.841221, loss_ss: 0.834165, loss_d: 0.007056
0.2690 --- loss: 0.473531, loss_ss: 0.463375, loss_d: 0.010157
0.3075 --- loss: 0.832528, loss_ss: 0.823147, loss_d: 0.009382
0.3459 --- loss: 0.888335, loss_ss: 0.877609, loss_d: 0.010726
0.3843 --- loss: 0.808096, loss_ss: 0.772574, loss_d: 0.035522
0.4228 --- loss: 0.560848, loss_ss: 0.553058, loss_d: 0.007790
0.4612 --- loss: 0.911205, loss_ss: 0.905132, loss_d: 0.006072
0.4996 --- loss: 1.183103, loss_ss: 0.932367, loss_d: 0.250736
0.5380 --- loss: 0.673886, loss_ss: 0.611013, loss_d: 0.062872
0.5765 --- loss: 0.813375, loss_ss: 0.791612, loss_d: 0.021763
0.6149 --- loss: 0.735432, loss_ss: 0.679242, loss_d: 0.056191
0.6533 --- loss: 0.868143, loss_ss: 0.846465, loss_d: 0.021678
0.6918 --- loss: 0.900429, loss_ss: 0.698610, loss_d: 0.201819
0.7302 --- loss: 0.933176, loss_ss: 0.568720, loss_d: 0.364456
0.7686 --- loss: 0.961741, loss_ss: 0.940809, loss_d: 0.020933
0.8071 --- loss: 0.748060, loss_ss: 0.635695, loss_d: 0.112365
0.8455 --- loss: 0.695133, loss_ss: 0.674104, loss_d: 0.021029
0.8839 --- loss: 0.855937, loss_ss: 0.839169, loss_d: 0.016768
0.9224 --- loss: 0.553829, loss_ss: 0.544697, loss_d: 0.009131
0.9608 --- loss: 0.803613, loss_ss: 0.758403, loss_d: 0.045210
0.9992 --- loss: 1.728350, loss_ss: 1.723564, loss_d: 0.004786
Epoch finished! Loss: 0.8718836176853914
Starting epoch 9/10.
0.0000 --- loss: 0.754177, loss_ss: 0.744030, loss_d: 0.010147
0.0384 --- loss: 0.594575, loss_ss: 0.590943, loss_d: 0.003632
0.0769 --- loss: 0.727809, loss_ss: 0.718311, loss_d: 0.009497
0.1153 --- loss: 1.548416, loss_ss: 1.363339, loss_d: 0.185077
0.1537 --- loss: 1.047434, loss_ss: 1.011254, loss_d: 0.036180
0.1922 --- loss: 0.801826, loss_ss: 0.797229, loss_d: 0.004597
0.2306 --- loss: 0.691540, loss_ss: 0.647089, loss_d: 0.044451
0.2690 --- loss: 0.691958, loss_ss: 0.663525, loss_d: 0.028433
0.3075 --- loss: 0.573054, loss_ss: 0.566967, loss_d: 0.006087
0.3459 --- loss: 1.456627, loss_ss: 0.826211, loss_d: 0.630416
0.3843 --- loss: 1.056614, loss_ss: 0.916572, loss_d: 0.140042
0.4228 --- loss: 1.008083, loss_ss: 0.870345, loss_d: 0.137739
0.4612 --- loss: 0.771137, loss_ss: 0.708539, loss_d: 0.062598
0.4996 --- loss: 0.923080, loss_ss: 0.922233, loss_d: 0.000847
0.5380 --- loss: 1.072299, loss_ss: 1.044245, loss_d: 0.028054
0.5765 --- loss: 0.805145, loss_ss: 0.777711, loss_d: 0.027434
0.6149 --- loss: 0.982757, loss_ss: 0.894794, loss_d: 0.087963
0.6533 --- loss: 1.215430, loss_ss: 0.813403, loss_d: 0.402026
0.6918 --- loss: 0.706512, loss_ss: 0.678798, loss_d: 0.027713
0.7302 --- loss: 0.899434, loss_ss: 0.892434, loss_d: 0.007001
0.7686 --- loss: 0.963378, loss_ss: 0.950094, loss_d: 0.013283
0.8071 --- loss: 0.758569, loss_ss: 0.704729, loss_d: 0.053840
0.8455 --- loss: 0.674802, loss_ss: 0.663068, loss_d: 0.011734
0.8839 --- loss: 1.355266, loss_ss: 0.845850, loss_d: 0.509415
0.9224 --- loss: 1.034784, loss_ss: 0.994103, loss_d: 0.040681
0.9608 --- loss: 0.594596, loss_ss: 0.574530, loss_d: 0.020065
0.9992 --- loss: 6.726674, loss_ss: 1.019350, loss_d: 5.707324
Epoch finished! Loss: 0.9008751576909653
Starting epoch 10/10.
0.0000 --- loss: 0.673930, loss_ss: 0.650761, loss_d: 0.023168
0.0384 --- loss: 1.043919, loss_ss: 0.751715, loss_d: 0.292204
0.0769 --- loss: 0.584396, loss_ss: 0.555084, loss_d: 0.029312
0.1153 --- loss: 0.798521, loss_ss: 0.777701, loss_d: 0.020819
0.1537 --- loss: 0.772170, loss_ss: 0.767915, loss_d: 0.004255
0.1922 --- loss: 0.676570, loss_ss: 0.666875, loss_d: 0.009695
0.2306 --- loss: 1.071813, loss_ss: 1.066399, loss_d: 0.005413
0.2690 --- loss: 0.738390, loss_ss: 0.613304, loss_d: 0.125086
0.3075 --- loss: 0.897719, loss_ss: 0.793046, loss_d: 0.104673
0.3459 --- loss: 0.810035, loss_ss: 0.722874, loss_d: 0.087161
0.3843 --- loss: 1.110555, loss_ss: 1.096299, loss_d: 0.014255
0.4228 --- loss: 0.771727, loss_ss: 0.765459, loss_d: 0.006268
0.4612 --- loss: 0.741006, loss_ss: 0.732396, loss_d: 0.008610
0.4996 --- loss: 0.709336, loss_ss: 0.681564, loss_d: 0.027772
0.5380 --- loss: 0.945367, loss_ss: 0.915367, loss_d: 0.030000
0.5765 --- loss: 0.535874, loss_ss: 0.497521, loss_d: 0.038353
0.6149 --- loss: 1.372510, loss_ss: 0.571211, loss_d: 0.801300
0.6533 --- loss: 0.825627, loss_ss: 0.577006, loss_d: 0.248621
0.6918 --- loss: 0.722982, loss_ss: 0.691014, loss_d: 0.031968
0.7302 --- loss: 0.960506, loss_ss: 0.888067, loss_d: 0.072439
0.7686 --- loss: 1.316076, loss_ss: 1.284739, loss_d: 0.031338
0.8071 --- loss: 0.805855, loss_ss: 0.749072, loss_d: 0.056782
0.8455 --- loss: 0.752732, loss_ss: 0.717156, loss_d: 0.035576
0.8839 --- loss: 0.557547, loss_ss: 0.495171, loss_d: 0.062376
0.9224 --- loss: 0.997370, loss_ss: 0.938356, loss_d: 0.059014
0.9608 --- loss: 1.029829, loss_ss: 1.005445, loss_d: 0.024384
0.9992 --- loss: 6.907052, loss_ss: 0.727652, loss_d: 6.179399
Epoch finished! Loss: 0.8806507161030402
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.687037037037037
             precision    recall  f1-score   support

        0.0       0.94      0.64      0.77       185
        1.0       0.31      0.38      0.34        50
        2.0       0.73      0.78      0.76       483
        3.0       0.99      0.39      0.56       216
        4.0       0.49      0.99      0.65       146

avg / total       0.77      0.69      0.68      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.24  64.32   99.22  94.44     76.53
1  93.15  38.00   95.83  30.65     33.93
2  77.41  77.85   77.05  73.29     75.50
3  87.69  38.89   99.88  98.82     55.81
4  85.93  98.63   83.94  48.98     65.45
Total accuracy: 68.70%
Average sen: 63.54%
Average spec: 91.18%
Macro f1-score: 61.45%
Diagnosis acc on 15mins: 1.0
[0.01161258 0.00612282 0.00240998 0.02323013 0.00091444 0.00155629
 0.00455154 0.0060263  0.36055732 0.22982186 0.0110615  0.09146635
 0.02757121 0.26100251 0.28381473 0.01287092 0.03756548 0.14165415
 0.30846658 0.0301995  0.19521467 0.00928103 0.01922845 0.04784581
 0.00611179 0.00725537 0.01729955 0.01063319 0.04312085 0.01762555
 0.06334019 0.22498749 0.05104485 0.04907357 0.00467874 0.00742693]
pred: 0.07296234035554032, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.208138, loss_ss: 1.532082, loss_d: 0.676056
0.0383 --- loss: 2.221593, loss_ss: 1.534448, loss_d: 0.687145
0.0766 --- loss: 2.144943, loss_ss: 1.436978, loss_d: 0.707965
0.1149 --- loss: 2.496848, loss_ss: 1.420590, loss_d: 1.076259
0.1533 --- loss: 2.022106, loss_ss: 1.404027, loss_d: 0.618079
0.1916 --- loss: 1.811442, loss_ss: 1.221670, loss_d: 0.589772
0.2299 --- loss: 1.609937, loss_ss: 1.150681, loss_d: 0.459255
0.2682 --- loss: 1.939624, loss_ss: 1.311044, loss_d: 0.628580
0.3065 --- loss: 1.567464, loss_ss: 1.344638, loss_d: 0.222826
0.3448 --- loss: 1.696366, loss_ss: 1.172565, loss_d: 0.523801
0.3831 --- loss: 1.749576, loss_ss: 1.066000, loss_d: 0.683576
0.4215 --- loss: 1.658212, loss_ss: 1.158145, loss_d: 0.500067
0.4598 --- loss: 1.605006, loss_ss: 1.070555, loss_d: 0.534451
0.4981 --- loss: 1.717457, loss_ss: 1.206189, loss_d: 0.511268
0.5364 --- loss: 1.880498, loss_ss: 1.404567, loss_d: 0.475931
0.5747 --- loss: 1.469529, loss_ss: 1.290578, loss_d: 0.178951
0.6130 --- loss: 1.510090, loss_ss: 1.127660, loss_d: 0.382431
0.6513 --- loss: 1.482104, loss_ss: 1.110933, loss_d: 0.371171
0.6897 --- loss: 1.610089, loss_ss: 1.294369, loss_d: 0.315720
0.7280 --- loss: 1.499952, loss_ss: 1.070793, loss_d: 0.429159
0.7663 --- loss: 1.414238, loss_ss: 0.980699, loss_d: 0.433539
0.8046 --- loss: 1.354817, loss_ss: 1.086916, loss_d: 0.267901
0.8429 --- loss: 1.331542, loss_ss: 1.085332, loss_d: 0.246210
0.8812 --- loss: 1.478355, loss_ss: 1.079295, loss_d: 0.399061
0.9195 --- loss: 1.226507, loss_ss: 1.050638, loss_d: 0.175868
0.9579 --- loss: 1.518358, loss_ss: 0.980557, loss_d: 0.537800
0.9962 --- loss: 1.337348, loss_ss: 0.885529, loss_d: 0.451819
Epoch finished! Loss: 1.7349972954163184
Starting epoch 2/10.
0.0000 --- loss: 1.559151, loss_ss: 1.156338, loss_d: 0.402814
0.0383 --- loss: 1.227127, loss_ss: 1.067634, loss_d: 0.159493
0.0766 --- loss: 1.434160, loss_ss: 1.035903, loss_d: 0.398257
0.1149 --- loss: 1.954717, loss_ss: 1.631276, loss_d: 0.323440
0.1533 --- loss: 1.086440, loss_ss: 0.925358, loss_d: 0.161082
0.1916 --- loss: 1.248300, loss_ss: 0.941549, loss_d: 0.306751
0.2299 --- loss: 1.535454, loss_ss: 1.073984, loss_d: 0.461470
0.2682 --- loss: 1.276086, loss_ss: 0.827038, loss_d: 0.449048
0.3065 --- loss: 1.350497, loss_ss: 1.013626, loss_d: 0.336871
0.3448 --- loss: 1.220154, loss_ss: 1.116219, loss_d: 0.103935
0.3831 --- loss: 1.109056, loss_ss: 0.971949, loss_d: 0.137108
0.4215 --- loss: 0.947641, loss_ss: 0.867365, loss_d: 0.080276
0.4598 --- loss: 1.134312, loss_ss: 1.018089, loss_d: 0.116223
0.4981 --- loss: 0.969871, loss_ss: 0.767061, loss_d: 0.202810
0.5364 --- loss: 1.159416, loss_ss: 0.842251, loss_d: 0.317165
0.5747 --- loss: 0.822499, loss_ss: 0.763417, loss_d: 0.059082
0.6130 --- loss: 1.330438, loss_ss: 0.889416, loss_d: 0.441022
0.6513 --- loss: 1.260154, loss_ss: 1.124866, loss_d: 0.135288
0.6897 --- loss: 1.103561, loss_ss: 1.013713, loss_d: 0.089848
0.7280 --- loss: 1.167936, loss_ss: 0.809690, loss_d: 0.358246
0.7663 --- loss: 1.500363, loss_ss: 1.388609, loss_d: 0.111755
0.8046 --- loss: 1.258535, loss_ss: 1.225230, loss_d: 0.033305
0.8429 --- loss: 1.342440, loss_ss: 0.921160, loss_d: 0.421280
0.8812 --- loss: 0.876850, loss_ss: 0.765771, loss_d: 0.111079
0.9195 --- loss: 1.258916, loss_ss: 1.148548, loss_d: 0.110367
0.9579 --- loss: 1.544135, loss_ss: 1.065547, loss_d: 0.478587
0.9962 --- loss: 1.143574, loss_ss: 0.995233, loss_d: 0.148341
Epoch finished! Loss: 1.2607691902380722
Starting epoch 3/10.
0.0000 --- loss: 0.823249, loss_ss: 0.768474, loss_d: 0.054775
0.0383 --- loss: 1.880004, loss_ss: 0.878472, loss_d: 1.001533
0.0766 --- loss: 1.058041, loss_ss: 0.722339, loss_d: 0.335703
0.1149 --- loss: 0.959754, loss_ss: 0.831835, loss_d: 0.127919
0.1533 --- loss: 1.106766, loss_ss: 0.854151, loss_d: 0.252614
0.1916 --- loss: 0.978796, loss_ss: 0.787054, loss_d: 0.191742
0.2299 --- loss: 0.869863, loss_ss: 0.785973, loss_d: 0.083890
0.2682 --- loss: 1.152085, loss_ss: 0.901697, loss_d: 0.250388
0.3065 --- loss: 1.299150, loss_ss: 0.997792, loss_d: 0.301358
0.3448 --- loss: 1.672849, loss_ss: 1.057971, loss_d: 0.614878
0.3831 --- loss: 0.948229, loss_ss: 0.853467, loss_d: 0.094762
0.4215 --- loss: 0.829468, loss_ss: 0.709647, loss_d: 0.119822
0.4598 --- loss: 1.133105, loss_ss: 1.026739, loss_d: 0.106366
0.4981 --- loss: 1.008265, loss_ss: 0.733304, loss_d: 0.274961
0.5364 --- loss: 1.515737, loss_ss: 1.127449, loss_d: 0.388287
0.5747 --- loss: 0.990687, loss_ss: 0.821318, loss_d: 0.169369
0.6130 --- loss: 1.396012, loss_ss: 0.979176, loss_d: 0.416836
0.6513 --- loss: 1.094388, loss_ss: 0.816962, loss_d: 0.277426
0.6897 --- loss: 0.967236, loss_ss: 0.814644, loss_d: 0.152591
0.7280 --- loss: 0.816474, loss_ss: 0.660802, loss_d: 0.155672
0.7663 --- loss: 0.917204, loss_ss: 0.885848, loss_d: 0.031356
0.8046 --- loss: 0.864916, loss_ss: 0.809278, loss_d: 0.055638
0.8429 --- loss: 1.071842, loss_ss: 0.883621, loss_d: 0.188221
0.8812 --- loss: 0.976229, loss_ss: 0.955960, loss_d: 0.020269
0.9195 --- loss: 0.895238, loss_ss: 0.784129, loss_d: 0.111109
0.9579 --- loss: 0.722284, loss_ss: 0.628313, loss_d: 0.093971
0.9962 --- loss: 1.029415, loss_ss: 1.007028, loss_d: 0.022387
Epoch finished! Loss: 1.0978407426522327
Starting epoch 4/10.
0.0000 --- loss: 0.810768, loss_ss: 0.796823, loss_d: 0.013944
0.0383 --- loss: 1.372847, loss_ss: 1.339966, loss_d: 0.032881
0.0766 --- loss: 1.314281, loss_ss: 0.999101, loss_d: 0.315180
0.1149 --- loss: 0.795320, loss_ss: 0.754051, loss_d: 0.041269
0.1533 --- loss: 0.810928, loss_ss: 0.704868, loss_d: 0.106060
0.1916 --- loss: 0.873334, loss_ss: 0.728189, loss_d: 0.145144
0.2299 --- loss: 0.598481, loss_ss: 0.587777, loss_d: 0.010703
0.2682 --- loss: 1.405809, loss_ss: 1.103695, loss_d: 0.302114
0.3065 --- loss: 0.702337, loss_ss: 0.597320, loss_d: 0.105017
0.3448 --- loss: 0.877975, loss_ss: 0.812482, loss_d: 0.065492
0.3831 --- loss: 0.781091, loss_ss: 0.729834, loss_d: 0.051256
0.4215 --- loss: 0.639568, loss_ss: 0.610794, loss_d: 0.028775
0.4598 --- loss: 0.845755, loss_ss: 0.802836, loss_d: 0.042918
0.4981 --- loss: 0.856287, loss_ss: 0.818718, loss_d: 0.037569
0.5364 --- loss: 1.138758, loss_ss: 1.119943, loss_d: 0.018815
0.5747 --- loss: 1.144086, loss_ss: 1.082105, loss_d: 0.061981
0.6130 --- loss: 0.868855, loss_ss: 0.815851, loss_d: 0.053004
0.6513 --- loss: 0.748067, loss_ss: 0.680825, loss_d: 0.067242
0.6897 --- loss: 1.271674, loss_ss: 1.154657, loss_d: 0.117016
0.7280 --- loss: 0.843412, loss_ss: 0.779179, loss_d: 0.064233
0.7663 --- loss: 0.943564, loss_ss: 0.912515, loss_d: 0.031048
0.8046 --- loss: 0.705129, loss_ss: 0.656429, loss_d: 0.048700
0.8429 --- loss: 0.839244, loss_ss: 0.742105, loss_d: 0.097139
0.8812 --- loss: 0.798810, loss_ss: 0.779320, loss_d: 0.019490
0.9195 --- loss: 1.424124, loss_ss: 0.861913, loss_d: 0.562210
0.9579 --- loss: 1.211959, loss_ss: 1.050971, loss_d: 0.160988
0.9962 --- loss: 0.737801, loss_ss: 0.665202, loss_d: 0.072599
Epoch finished! Loss: 0.9680394851244413
Starting epoch 5/10.
0.0000 --- loss: 0.801070, loss_ss: 0.775345, loss_d: 0.025725
0.0383 --- loss: 0.741934, loss_ss: 0.719282, loss_d: 0.022652
0.0766 --- loss: 0.809906, loss_ss: 0.702308, loss_d: 0.107598
0.1149 --- loss: 0.561726, loss_ss: 0.464796, loss_d: 0.096930
0.1533 --- loss: 1.261831, loss_ss: 0.799792, loss_d: 0.462039
0.1916 --- loss: 0.992087, loss_ss: 0.943540, loss_d: 0.048547
0.2299 --- loss: 1.136688, loss_ss: 0.797738, loss_d: 0.338950
0.2682 --- loss: 0.832193, loss_ss: 0.787533, loss_d: 0.044660
0.3065 --- loss: 0.777446, loss_ss: 0.729732, loss_d: 0.047715
0.3448 --- loss: 0.941271, loss_ss: 0.876726, loss_d: 0.064545
0.3831 --- loss: 1.014842, loss_ss: 0.834932, loss_d: 0.179910
0.4215 --- loss: 0.853429, loss_ss: 0.821276, loss_d: 0.032153
0.4598 --- loss: 0.792525, loss_ss: 0.787483, loss_d: 0.005042
0.4981 --- loss: 1.025571, loss_ss: 0.732514, loss_d: 0.293056
0.5364 --- loss: 0.823083, loss_ss: 0.797573, loss_d: 0.025510
0.5747 --- loss: 1.057455, loss_ss: 0.867302, loss_d: 0.190153
0.6130 --- loss: 0.707293, loss_ss: 0.632182, loss_d: 0.075110
0.6513 --- loss: 0.789579, loss_ss: 0.727998, loss_d: 0.061580
0.6897 --- loss: 1.080350, loss_ss: 0.673827, loss_d: 0.406523
0.7280 --- loss: 1.081013, loss_ss: 0.970117, loss_d: 0.110896
0.7663 --- loss: 1.062506, loss_ss: 1.004337, loss_d: 0.058169
0.8046 --- loss: 1.080088, loss_ss: 0.651933, loss_d: 0.428155
0.8429 --- loss: 0.991095, loss_ss: 0.784874, loss_d: 0.206221
0.8812 --- loss: 1.239682, loss_ss: 0.859691, loss_d: 0.379991
0.9195 --- loss: 0.843698, loss_ss: 0.794664, loss_d: 0.049034
0.9579 --- loss: 0.850218, loss_ss: 0.781820, loss_d: 0.068398
0.9962 --- loss: 1.131117, loss_ss: 0.767302, loss_d: 0.363815
Epoch finished! Loss: 0.9203217896131369
Starting epoch 6/10.
0.0000 --- loss: 0.926840, loss_ss: 0.678154, loss_d: 0.248686
0.0383 --- loss: 0.894579, loss_ss: 0.860349, loss_d: 0.034230
0.0766 --- loss: 0.853112, loss_ss: 0.718214, loss_d: 0.134898
0.1149 --- loss: 0.619535, loss_ss: 0.585843, loss_d: 0.033692
0.1533 --- loss: 0.860236, loss_ss: 0.664555, loss_d: 0.195681
0.1916 --- loss: 0.624899, loss_ss: 0.578021, loss_d: 0.046878
0.2299 --- loss: 0.649026, loss_ss: 0.630345, loss_d: 0.018681
0.2682 --- loss: 0.765659, loss_ss: 0.741988, loss_d: 0.023672
0.3065 --- loss: 0.852114, loss_ss: 0.699535, loss_d: 0.152579
0.3448 --- loss: 1.103988, loss_ss: 0.953900, loss_d: 0.150088
0.3831 --- loss: 1.015233, loss_ss: 0.979515, loss_d: 0.035718
0.4215 --- loss: 0.867775, loss_ss: 0.813636, loss_d: 0.054139
0.4598 --- loss: 0.944441, loss_ss: 0.836829, loss_d: 0.107612
0.4981 --- loss: 0.789336, loss_ss: 0.673949, loss_d: 0.115387
0.5364 --- loss: 0.662704, loss_ss: 0.644687, loss_d: 0.018018
0.5747 --- loss: 0.876675, loss_ss: 0.868984, loss_d: 0.007691
0.6130 --- loss: 0.697609, loss_ss: 0.686045, loss_d: 0.011564
0.6513 --- loss: 0.657888, loss_ss: 0.634467, loss_d: 0.023421
0.6897 --- loss: 0.843642, loss_ss: 0.840352, loss_d: 0.003290
0.7280 --- loss: 0.828135, loss_ss: 0.826829, loss_d: 0.001306
0.7663 --- loss: 0.680193, loss_ss: 0.677912, loss_d: 0.002281
0.8046 --- loss: 0.766702, loss_ss: 0.722757, loss_d: 0.043945
0.8429 --- loss: 0.886148, loss_ss: 0.632762, loss_d: 0.253386
0.8812 --- loss: 0.849415, loss_ss: 0.813400, loss_d: 0.036015
0.9195 --- loss: 1.010807, loss_ss: 0.736173, loss_d: 0.274634
0.9579 --- loss: 0.688714, loss_ss: 0.661143, loss_d: 0.027571
0.9962 --- loss: 0.571318, loss_ss: 0.507030, loss_d: 0.064288
Epoch finished! Loss: 0.9016139186345614
Starting epoch 7/10.
0.0000 --- loss: 0.679062, loss_ss: 0.662508, loss_d: 0.016554
0.0383 --- loss: 0.855019, loss_ss: 0.674500, loss_d: 0.180519
0.0766 --- loss: 1.288766, loss_ss: 0.904277, loss_d: 0.384490
0.1149 --- loss: 1.024757, loss_ss: 0.947840, loss_d: 0.076917
0.1533 --- loss: 0.725341, loss_ss: 0.718980, loss_d: 0.006361
0.1916 --- loss: 1.159230, loss_ss: 0.954945, loss_d: 0.204285
0.2299 --- loss: 0.622826, loss_ss: 0.611341, loss_d: 0.011484
0.2682 --- loss: 0.609283, loss_ss: 0.598374, loss_d: 0.010909
0.3065 --- loss: 0.704872, loss_ss: 0.673539, loss_d: 0.031333
0.3448 --- loss: 1.054291, loss_ss: 1.050667, loss_d: 0.003624
0.3831 --- loss: 0.700131, loss_ss: 0.683410, loss_d: 0.016721
0.4215 --- loss: 0.951331, loss_ss: 0.684250, loss_d: 0.267081
0.4598 --- loss: 0.770585, loss_ss: 0.768317, loss_d: 0.002269
0.4981 --- loss: 0.997981, loss_ss: 0.993097, loss_d: 0.004884
0.5364 --- loss: 0.797560, loss_ss: 0.612319, loss_d: 0.185241
0.5747 --- loss: 0.766388, loss_ss: 0.750497, loss_d: 0.015891
0.6130 --- loss: 0.635152, loss_ss: 0.584630, loss_d: 0.050523
0.6513 --- loss: 1.350648, loss_ss: 1.318196, loss_d: 0.032452
0.6897 --- loss: 0.827992, loss_ss: 0.671257, loss_d: 0.156735
0.7280 --- loss: 0.588807, loss_ss: 0.543984, loss_d: 0.044822
0.7663 --- loss: 0.967617, loss_ss: 0.937170, loss_d: 0.030448
0.8046 --- loss: 0.686066, loss_ss: 0.666188, loss_d: 0.019878
0.8429 --- loss: 2.091546, loss_ss: 0.529450, loss_d: 1.562096
0.8812 --- loss: 0.505006, loss_ss: 0.384185, loss_d: 0.120821
0.9195 --- loss: 1.391675, loss_ss: 1.297478, loss_d: 0.094196
0.9579 --- loss: 0.616800, loss_ss: 0.573900, loss_d: 0.042900
0.9962 --- loss: 1.105757, loss_ss: 1.078456, loss_d: 0.027301
Epoch finished! Loss: 0.8641021018991104
Starting epoch 8/10.
0.0000 --- loss: 1.054025, loss_ss: 0.925648, loss_d: 0.128377
0.0383 --- loss: 1.418875, loss_ss: 1.370836, loss_d: 0.048039
0.0766 --- loss: 1.121693, loss_ss: 0.834467, loss_d: 0.287226
0.1149 --- loss: 0.823954, loss_ss: 0.785137, loss_d: 0.038816
0.1533 --- loss: 0.734727, loss_ss: 0.673528, loss_d: 0.061199
0.1916 --- loss: 0.780702, loss_ss: 0.721470, loss_d: 0.059232
0.2299 --- loss: 0.659958, loss_ss: 0.609385, loss_d: 0.050574
0.2682 --- loss: 0.678095, loss_ss: 0.673818, loss_d: 0.004276
0.3065 --- loss: 0.985647, loss_ss: 0.852520, loss_d: 0.133128
0.3448 --- loss: 0.746366, loss_ss: 0.741797, loss_d: 0.004569
0.3831 --- loss: 0.896082, loss_ss: 0.655531, loss_d: 0.240552
0.4215 --- loss: 0.594849, loss_ss: 0.520138, loss_d: 0.074711
0.4598 --- loss: 0.749750, loss_ss: 0.709889, loss_d: 0.039861
0.4981 --- loss: 0.665421, loss_ss: 0.538229, loss_d: 0.127192
0.5364 --- loss: 0.679246, loss_ss: 0.611652, loss_d: 0.067594
0.5747 --- loss: 0.774489, loss_ss: 0.755319, loss_d: 0.019170
0.6130 --- loss: 0.812615, loss_ss: 0.739031, loss_d: 0.073584
0.6513 --- loss: 0.748395, loss_ss: 0.740695, loss_d: 0.007700
0.6897 --- loss: 0.868480, loss_ss: 0.851069, loss_d: 0.017411
0.7280 --- loss: 0.906549, loss_ss: 0.875458, loss_d: 0.031092
0.7663 --- loss: 0.905868, loss_ss: 0.885021, loss_d: 0.020847
0.8046 --- loss: 1.529679, loss_ss: 0.572914, loss_d: 0.956765
0.8429 --- loss: 0.906786, loss_ss: 0.815524, loss_d: 0.091263
0.8812 --- loss: 0.894096, loss_ss: 0.539281, loss_d: 0.354815
0.9195 --- loss: 0.950402, loss_ss: 0.936962, loss_d: 0.013440
0.9579 --- loss: 0.616639, loss_ss: 0.531736, loss_d: 0.084903
0.9962 --- loss: 0.742024, loss_ss: 0.738174, loss_d: 0.003850
Epoch finished! Loss: 0.8379322862395874
Starting epoch 9/10.
0.0000 --- loss: 0.756001, loss_ss: 0.711567, loss_d: 0.044434
0.0383 --- loss: 0.876999, loss_ss: 0.857431, loss_d: 0.019568
0.0766 --- loss: 1.114789, loss_ss: 0.775677, loss_d: 0.339111
0.1149 --- loss: 0.906053, loss_ss: 0.890131, loss_d: 0.015922
0.1533 --- loss: 0.572785, loss_ss: 0.555116, loss_d: 0.017669
0.1916 --- loss: 1.011193, loss_ss: 0.554009, loss_d: 0.457184
0.2299 --- loss: 1.135266, loss_ss: 1.070644, loss_d: 0.064622
0.2682 --- loss: 0.953787, loss_ss: 0.927018, loss_d: 0.026769
0.3065 --- loss: 0.819501, loss_ss: 0.807773, loss_d: 0.011729
0.3448 --- loss: 1.030424, loss_ss: 1.000007, loss_d: 0.030418
0.3831 --- loss: 1.007680, loss_ss: 0.998207, loss_d: 0.009473
0.4215 --- loss: 0.701337, loss_ss: 0.688387, loss_d: 0.012949
0.4598 --- loss: 0.819098, loss_ss: 0.812426, loss_d: 0.006672
0.4981 --- loss: 1.056550, loss_ss: 0.772438, loss_d: 0.284112
0.5364 --- loss: 0.726048, loss_ss: 0.663414, loss_d: 0.062634
0.5747 --- loss: 0.925793, loss_ss: 0.886635, loss_d: 0.039158
0.6130 --- loss: 0.612354, loss_ss: 0.540133, loss_d: 0.072221
0.6513 --- loss: 0.972201, loss_ss: 0.962741, loss_d: 0.009460
0.6897 --- loss: 0.924135, loss_ss: 0.914588, loss_d: 0.009547
0.7280 --- loss: 0.493865, loss_ss: 0.426925, loss_d: 0.066940
0.7663 --- loss: 1.089028, loss_ss: 1.006057, loss_d: 0.082971
0.8046 --- loss: 0.869535, loss_ss: 0.845144, loss_d: 0.024391
0.8429 --- loss: 0.454035, loss_ss: 0.446349, loss_d: 0.007686
0.8812 --- loss: 0.636432, loss_ss: 0.593619, loss_d: 0.042813
0.9195 --- loss: 0.633633, loss_ss: 0.623927, loss_d: 0.009706
0.9579 --- loss: 0.696142, loss_ss: 0.688222, loss_d: 0.007920
0.9962 --- loss: 0.550870, loss_ss: 0.527016, loss_d: 0.023854
Epoch finished! Loss: 0.8184965485563644
Starting epoch 10/10.
0.0000 --- loss: 0.848854, loss_ss: 0.715721, loss_d: 0.133133
0.0383 --- loss: 0.797415, loss_ss: 0.791748, loss_d: 0.005667
0.0766 --- loss: 0.717093, loss_ss: 0.715359, loss_d: 0.001734
0.1149 --- loss: 0.799573, loss_ss: 0.668814, loss_d: 0.130759
0.1533 --- loss: 0.727163, loss_ss: 0.720908, loss_d: 0.006256
0.1916 --- loss: 0.650521, loss_ss: 0.643317, loss_d: 0.007204
0.2299 --- loss: 0.651493, loss_ss: 0.606860, loss_d: 0.044634
0.2682 --- loss: 0.926836, loss_ss: 0.925583, loss_d: 0.001253
0.3065 --- loss: 1.026254, loss_ss: 0.733752, loss_d: 0.292502
0.3448 --- loss: 0.664922, loss_ss: 0.657328, loss_d: 0.007594
0.3831 --- loss: 0.982232, loss_ss: 0.979517, loss_d: 0.002715
0.4215 --- loss: 0.755156, loss_ss: 0.596612, loss_d: 0.158543
0.4598 --- loss: 0.903955, loss_ss: 0.901438, loss_d: 0.002517
0.4981 --- loss: 0.766409, loss_ss: 0.763975, loss_d: 0.002434
0.5364 --- loss: 0.613947, loss_ss: 0.609114, loss_d: 0.004833
0.5747 --- loss: 1.007418, loss_ss: 1.004388, loss_d: 0.003031
0.6130 --- loss: 0.631994, loss_ss: 0.628601, loss_d: 0.003394
0.6513 --- loss: 0.942647, loss_ss: 0.933933, loss_d: 0.008714
0.6897 --- loss: 0.894952, loss_ss: 0.886125, loss_d: 0.008827
0.7280 --- loss: 0.986943, loss_ss: 0.852885, loss_d: 0.134058
0.7663 --- loss: 0.729537, loss_ss: 0.721704, loss_d: 0.007833
0.8046 --- loss: 1.048012, loss_ss: 1.026924, loss_d: 0.021087
0.8429 --- loss: 0.539621, loss_ss: 0.517597, loss_d: 0.022024
0.8812 --- loss: 1.243984, loss_ss: 0.490180, loss_d: 0.753804
0.9195 --- loss: 0.566640, loss_ss: 0.558990, loss_d: 0.007650
0.9579 --- loss: 0.540382, loss_ss: 0.528176, loss_d: 0.012206
0.9962 --- loss: 0.815023, loss_ss: 0.801434, loss_d: 0.013589
Epoch finished! Loss: 0.7974244469633469
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.85
             precision    recall  f1-score   support

        0.0       1.00      0.52      0.68        56
        1.0       0.27      0.32      0.29        38
        2.0       0.84      0.95      0.90       416
        3.0       0.98      0.82      0.90       188
        4.0       0.88      0.85      0.86       142

avg / total       0.86      0.85      0.85       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.79  51.79  100.00  100.00     68.24
1  93.10  31.58   96.01   27.27     29.27
2  88.93  95.43   82.55   84.29     89.52
3  95.71  82.45   99.54   98.10     89.60
4  95.48  85.21   97.56   87.68     86.43
Total accuracy: 85.00%
Average sen: 69.29%
Average spec: 95.13%
Macro f1-score: 72.61%
Diagnosis acc on 15mins: 0.9642857142857143
[4.04294726e-04 3.67960660e-04 3.90186044e-03 7.86340330e-03
 1.13168417e-03 1.34710746e-03 1.99812534e-03 6.47685118e-03
 6.43574670e-02 5.62825240e-04 3.10489931e-03 1.51872963e-01
 1.26448721e-02 1.44986855e-02 2.45026895e-03 9.04488144e-04
 5.08286944e-03 5.37989922e-02 4.61668551e-01 9.47925389e-01
 4.50964361e-01 2.50456948e-02 6.35463139e-03 9.89690539e-04
 2.20202666e-04 1.47798366e-03 4.11141402e-04 1.12417946e-03]
pred: 0.07960540867601854, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.488975, loss_ss: 1.792279, loss_d: 0.696696
0.0383 --- loss: 2.119004, loss_ss: 1.659700, loss_d: 0.459303
0.0767 --- loss: 2.238998, loss_ss: 1.567247, loss_d: 0.671751
0.1150 --- loss: 2.120307, loss_ss: 1.518246, loss_d: 0.602062
0.1534 --- loss: 1.820938, loss_ss: 1.370537, loss_d: 0.450400
0.1917 --- loss: 1.868202, loss_ss: 1.394524, loss_d: 0.473678
0.2301 --- loss: 1.849471, loss_ss: 1.375967, loss_d: 0.473504
0.2684 --- loss: 2.011752, loss_ss: 1.433532, loss_d: 0.578220
0.3067 --- loss: 2.379741, loss_ss: 1.718761, loss_d: 0.660980
0.3451 --- loss: 2.128107, loss_ss: 1.731413, loss_d: 0.396694
0.3834 --- loss: 1.804819, loss_ss: 1.188776, loss_d: 0.616044
0.4218 --- loss: 1.908243, loss_ss: 1.449148, loss_d: 0.459095
0.4601 --- loss: 2.121464, loss_ss: 1.490034, loss_d: 0.631430
0.4985 --- loss: 2.107814, loss_ss: 1.327085, loss_d: 0.780730
0.5368 --- loss: 1.763570, loss_ss: 1.434959, loss_d: 0.328610
0.5752 --- loss: 1.721193, loss_ss: 1.218470, loss_d: 0.502723
0.6135 --- loss: 2.104727, loss_ss: 1.340697, loss_d: 0.764030
0.6518 --- loss: 1.978227, loss_ss: 1.233219, loss_d: 0.745008
0.6902 --- loss: 1.972348, loss_ss: 1.194498, loss_d: 0.777850
0.7285 --- loss: 2.027965, loss_ss: 1.502580, loss_d: 0.525385
0.7669 --- loss: 1.725969, loss_ss: 1.311387, loss_d: 0.414582
0.8052 --- loss: 1.670436, loss_ss: 1.379161, loss_d: 0.291275
0.8436 --- loss: 1.577941, loss_ss: 1.321408, loss_d: 0.256533
0.8819 --- loss: 1.699851, loss_ss: 1.251770, loss_d: 0.448081
0.9202 --- loss: 1.921862, loss_ss: 1.524934, loss_d: 0.396928
0.9586 --- loss: 1.710475, loss_ss: 1.336626, loss_d: 0.373849
0.9969 --- loss: 1.490339, loss_ss: 1.253998, loss_d: 0.236342
Epoch finished! Loss: 1.948294611619069
Starting epoch 2/10.
0.0000 --- loss: 1.878779, loss_ss: 1.609365, loss_d: 0.269413
0.0383 --- loss: 1.326292, loss_ss: 1.145955, loss_d: 0.180337
0.0767 --- loss: 1.430075, loss_ss: 1.168714, loss_d: 0.261360
0.1150 --- loss: 1.980048, loss_ss: 1.716575, loss_d: 0.263473
0.1534 --- loss: 1.299881, loss_ss: 1.100031, loss_d: 0.199849
0.1917 --- loss: 1.586980, loss_ss: 1.313324, loss_d: 0.273656
0.2301 --- loss: 1.548365, loss_ss: 1.112155, loss_d: 0.436211
0.2684 --- loss: 1.747115, loss_ss: 1.175908, loss_d: 0.571207
0.3067 --- loss: 1.674005, loss_ss: 1.262058, loss_d: 0.411947
0.3451 --- loss: 1.345749, loss_ss: 1.048858, loss_d: 0.296891
0.3834 --- loss: 2.225728, loss_ss: 1.172760, loss_d: 1.052967
0.4218 --- loss: 1.412241, loss_ss: 0.963840, loss_d: 0.448401
0.4601 --- loss: 2.083401, loss_ss: 1.427160, loss_d: 0.656241
0.4985 --- loss: 1.679602, loss_ss: 0.974677, loss_d: 0.704925
0.5368 --- loss: 1.959924, loss_ss: 1.059013, loss_d: 0.900911
0.5752 --- loss: 1.519537, loss_ss: 1.272016, loss_d: 0.247521
0.6135 --- loss: 1.816295, loss_ss: 1.433679, loss_d: 0.382615
0.6518 --- loss: 1.511418, loss_ss: 1.157735, loss_d: 0.353683
0.6902 --- loss: 1.739493, loss_ss: 1.253265, loss_d: 0.486228
0.7285 --- loss: 1.211393, loss_ss: 0.989081, loss_d: 0.222312
0.7669 --- loss: 1.498912, loss_ss: 1.250412, loss_d: 0.248500
0.8052 --- loss: 1.266486, loss_ss: 0.951840, loss_d: 0.314646
0.8436 --- loss: 1.383894, loss_ss: 1.163491, loss_d: 0.220403
0.8819 --- loss: 1.169695, loss_ss: 0.968699, loss_d: 0.200996
0.9202 --- loss: 1.497434, loss_ss: 1.014936, loss_d: 0.482498
0.9586 --- loss: 1.236109, loss_ss: 0.941443, loss_d: 0.294666
0.9969 --- loss: 1.552330, loss_ss: 1.179573, loss_d: 0.372756
Epoch finished! Loss: 1.5512373181489798
Starting epoch 3/10.
0.0000 --- loss: 1.299457, loss_ss: 0.922831, loss_d: 0.376626
0.0383 --- loss: 1.535497, loss_ss: 1.153020, loss_d: 0.382477
0.0767 --- loss: 1.193648, loss_ss: 0.966078, loss_d: 0.227570
0.1150 --- loss: 1.267927, loss_ss: 0.988808, loss_d: 0.279119
0.1534 --- loss: 1.632779, loss_ss: 0.900286, loss_d: 0.732493
0.1917 --- loss: 1.887247, loss_ss: 0.987352, loss_d: 0.899894
0.2301 --- loss: 1.367438, loss_ss: 1.149116, loss_d: 0.218323
0.2684 --- loss: 1.209769, loss_ss: 0.904632, loss_d: 0.305137
0.3067 --- loss: 1.231004, loss_ss: 0.992766, loss_d: 0.238238
0.3451 --- loss: 1.136196, loss_ss: 0.919960, loss_d: 0.216235
0.3834 --- loss: 1.757873, loss_ss: 1.452923, loss_d: 0.304950
0.4218 --- loss: 1.427432, loss_ss: 1.154056, loss_d: 0.273377
0.4601 --- loss: 1.205241, loss_ss: 0.944205, loss_d: 0.261037
0.4985 --- loss: 1.134366, loss_ss: 0.844581, loss_d: 0.289785
0.5368 --- loss: 1.227674, loss_ss: 0.784157, loss_d: 0.443518
0.5752 --- loss: 1.273774, loss_ss: 0.907256, loss_d: 0.366518
0.6135 --- loss: 1.636917, loss_ss: 1.417837, loss_d: 0.219080
0.6518 --- loss: 1.586177, loss_ss: 1.306818, loss_d: 0.279359
0.6902 --- loss: 1.282615, loss_ss: 0.998032, loss_d: 0.284582
0.7285 --- loss: 1.281430, loss_ss: 1.109172, loss_d: 0.172258
0.7669 --- loss: 1.188696, loss_ss: 1.011936, loss_d: 0.176760
0.8052 --- loss: 1.519168, loss_ss: 1.098516, loss_d: 0.420653
0.8436 --- loss: 1.454888, loss_ss: 1.127459, loss_d: 0.327429
0.8819 --- loss: 1.247996, loss_ss: 1.010600, loss_d: 0.237396
0.9202 --- loss: 1.324634, loss_ss: 1.122294, loss_d: 0.202341
0.9586 --- loss: 0.994501, loss_ss: 0.784000, loss_d: 0.210500
0.9969 --- loss: 1.112394, loss_ss: 0.823417, loss_d: 0.288977
Epoch finished! Loss: 1.3882977597988568
Starting epoch 4/10.
0.0000 --- loss: 1.169541, loss_ss: 0.875336, loss_d: 0.294205
0.0383 --- loss: 1.365978, loss_ss: 1.019131, loss_d: 0.346846
0.0767 --- loss: 1.130597, loss_ss: 0.844782, loss_d: 0.285815
0.1150 --- loss: 1.335711, loss_ss: 1.058288, loss_d: 0.277423
0.1534 --- loss: 1.313066, loss_ss: 1.054674, loss_d: 0.258392
0.1917 --- loss: 1.183567, loss_ss: 0.860482, loss_d: 0.323085
0.2301 --- loss: 1.263280, loss_ss: 1.064417, loss_d: 0.198863
0.2684 --- loss: 0.914919, loss_ss: 0.720751, loss_d: 0.194169
0.3067 --- loss: 1.188006, loss_ss: 1.041507, loss_d: 0.146499
0.3451 --- loss: 1.553542, loss_ss: 1.408655, loss_d: 0.144887
0.3834 --- loss: 1.352280, loss_ss: 1.094403, loss_d: 0.257877
0.4218 --- loss: 1.453642, loss_ss: 1.133486, loss_d: 0.320156
0.4601 --- loss: 1.374408, loss_ss: 1.067241, loss_d: 0.307168
0.4985 --- loss: 1.167077, loss_ss: 0.959030, loss_d: 0.208046
0.5368 --- loss: 1.113655, loss_ss: 0.950041, loss_d: 0.163614
0.5752 --- loss: 1.314931, loss_ss: 1.190961, loss_d: 0.123970
0.6135 --- loss: 1.072632, loss_ss: 0.903475, loss_d: 0.169157
0.6518 --- loss: 1.230022, loss_ss: 1.025521, loss_d: 0.204501
0.6902 --- loss: 1.100196, loss_ss: 0.903545, loss_d: 0.196650
0.7285 --- loss: 1.559631, loss_ss: 1.135110, loss_d: 0.424520
0.7669 --- loss: 1.221297, loss_ss: 0.941836, loss_d: 0.279462
0.8052 --- loss: 1.229062, loss_ss: 0.916327, loss_d: 0.312735
0.8436 --- loss: 1.031213, loss_ss: 0.863587, loss_d: 0.167627
0.8819 --- loss: 1.210222, loss_ss: 0.988669, loss_d: 0.221553
0.9202 --- loss: 1.390458, loss_ss: 0.994059, loss_d: 0.396400
0.9586 --- loss: 1.484030, loss_ss: 1.051449, loss_d: 0.432581
0.9969 --- loss: 1.117831, loss_ss: 0.970603, loss_d: 0.147227
Epoch finished! Loss: 1.2664181062808404
Starting epoch 5/10.
0.0000 --- loss: 1.021427, loss_ss: 0.879373, loss_d: 0.142054
0.0383 --- loss: 1.273008, loss_ss: 0.996360, loss_d: 0.276648
0.0767 --- loss: 1.730221, loss_ss: 1.477905, loss_d: 0.252316
0.1150 --- loss: 1.035729, loss_ss: 0.964648, loss_d: 0.071082
0.1534 --- loss: 1.526697, loss_ss: 1.412008, loss_d: 0.114689
0.1917 --- loss: 1.474178, loss_ss: 1.177508, loss_d: 0.296670
0.2301 --- loss: 1.557150, loss_ss: 0.883858, loss_d: 0.673292
0.2684 --- loss: 1.201143, loss_ss: 0.933425, loss_d: 0.267718
0.3067 --- loss: 1.653326, loss_ss: 0.820753, loss_d: 0.832572
0.3451 --- loss: 1.124469, loss_ss: 0.857452, loss_d: 0.267017
0.3834 --- loss: 1.386748, loss_ss: 0.800977, loss_d: 0.585771
0.4218 --- loss: 1.054555, loss_ss: 1.008597, loss_d: 0.045959
0.4601 --- loss: 1.392533, loss_ss: 1.189346, loss_d: 0.203187
0.4985 --- loss: 1.137643, loss_ss: 1.043526, loss_d: 0.094116
0.5368 --- loss: 0.897955, loss_ss: 0.869520, loss_d: 0.028435
0.5752 --- loss: 1.092003, loss_ss: 0.978435, loss_d: 0.113568
0.6135 --- loss: 1.262081, loss_ss: 1.108610, loss_d: 0.153471
0.6518 --- loss: 0.775529, loss_ss: 0.610312, loss_d: 0.165217
0.6902 --- loss: 1.750997, loss_ss: 1.258339, loss_d: 0.492657
0.7285 --- loss: 1.432028, loss_ss: 1.077926, loss_d: 0.354102
0.7669 --- loss: 0.982898, loss_ss: 0.893305, loss_d: 0.089593
0.8052 --- loss: 1.110983, loss_ss: 0.978298, loss_d: 0.132685
0.8436 --- loss: 0.936065, loss_ss: 0.857761, loss_d: 0.078303
0.8819 --- loss: 0.938681, loss_ss: 0.847445, loss_d: 0.091236
0.9202 --- loss: 1.485055, loss_ss: 0.963809, loss_d: 0.521246
0.9586 --- loss: 1.625757, loss_ss: 1.200718, loss_d: 0.425039
0.9969 --- loss: 0.800036, loss_ss: 0.658986, loss_d: 0.141050
Epoch finished! Loss: 1.1186115794456921
Starting epoch 6/10.
0.0000 --- loss: 1.072911, loss_ss: 0.954528, loss_d: 0.118383
0.0383 --- loss: 0.928913, loss_ss: 0.826324, loss_d: 0.102588
0.0767 --- loss: 0.979309, loss_ss: 0.912767, loss_d: 0.066542
0.1150 --- loss: 1.288647, loss_ss: 1.138171, loss_d: 0.150476
0.1534 --- loss: 0.832914, loss_ss: 0.799008, loss_d: 0.033906
0.1917 --- loss: 1.053033, loss_ss: 0.883767, loss_d: 0.169266
0.2301 --- loss: 1.260528, loss_ss: 0.901675, loss_d: 0.358853
0.2684 --- loss: 0.910705, loss_ss: 0.879955, loss_d: 0.030750
0.3067 --- loss: 0.872065, loss_ss: 0.824850, loss_d: 0.047215
0.3451 --- loss: 1.003541, loss_ss: 0.940898, loss_d: 0.062644
0.3834 --- loss: 1.042387, loss_ss: 0.914749, loss_d: 0.127637
0.4218 --- loss: 1.051813, loss_ss: 0.920496, loss_d: 0.131317
0.4601 --- loss: 0.821037, loss_ss: 0.792411, loss_d: 0.028626
0.4985 --- loss: 1.150301, loss_ss: 0.862894, loss_d: 0.287407
0.5368 --- loss: 0.808268, loss_ss: 0.769307, loss_d: 0.038961
0.5752 --- loss: 0.900053, loss_ss: 0.694869, loss_d: 0.205184
0.6135 --- loss: 0.854295, loss_ss: 0.796902, loss_d: 0.057394
0.6518 --- loss: 1.088899, loss_ss: 1.023880, loss_d: 0.065019
0.6902 --- loss: 0.795341, loss_ss: 0.671143, loss_d: 0.124198
0.7285 --- loss: 0.993570, loss_ss: 0.900655, loss_d: 0.092915
0.7669 --- loss: 0.926273, loss_ss: 0.906776, loss_d: 0.019496
0.8052 --- loss: 1.000964, loss_ss: 0.980832, loss_d: 0.020132
0.8436 --- loss: 1.755383, loss_ss: 0.803651, loss_d: 0.951732
0.8819 --- loss: 0.821641, loss_ss: 0.784770, loss_d: 0.036872
0.9202 --- loss: 1.187498, loss_ss: 1.118985, loss_d: 0.068512
0.9586 --- loss: 0.771501, loss_ss: 0.701989, loss_d: 0.069512
0.9969 --- loss: 0.962552, loss_ss: 0.882356, loss_d: 0.080196
Epoch finished! Loss: 1.0300766924252878
Starting epoch 7/10.
0.0000 --- loss: 0.977899, loss_ss: 0.803757, loss_d: 0.174142
0.0383 --- loss: 1.620049, loss_ss: 1.128651, loss_d: 0.491398
0.0767 --- loss: 0.919956, loss_ss: 0.912353, loss_d: 0.007603
0.1150 --- loss: 1.321738, loss_ss: 1.289589, loss_d: 0.032150
0.1534 --- loss: 0.819998, loss_ss: 0.802292, loss_d: 0.017706
0.1917 --- loss: 0.685050, loss_ss: 0.634643, loss_d: 0.050407
0.2301 --- loss: 0.764200, loss_ss: 0.706941, loss_d: 0.057259
0.2684 --- loss: 0.886627, loss_ss: 0.880327, loss_d: 0.006301
0.3067 --- loss: 0.711639, loss_ss: 0.664040, loss_d: 0.047598
0.3451 --- loss: 0.671380, loss_ss: 0.666566, loss_d: 0.004814
0.3834 --- loss: 0.781310, loss_ss: 0.778076, loss_d: 0.003234
0.4218 --- loss: 1.267431, loss_ss: 0.742109, loss_d: 0.525323
0.4601 --- loss: 1.028939, loss_ss: 1.001251, loss_d: 0.027688
0.4985 --- loss: 0.866074, loss_ss: 0.687416, loss_d: 0.178658
0.5368 --- loss: 1.460407, loss_ss: 1.111001, loss_d: 0.349406
0.5752 --- loss: 0.704686, loss_ss: 0.684140, loss_d: 0.020546
0.6135 --- loss: 0.914901, loss_ss: 0.826251, loss_d: 0.088650
0.6518 --- loss: 1.135205, loss_ss: 0.834594, loss_d: 0.300611
0.6902 --- loss: 1.099809, loss_ss: 0.941372, loss_d: 0.158437
0.7285 --- loss: 0.892785, loss_ss: 0.681717, loss_d: 0.211068
0.7669 --- loss: 0.663005, loss_ss: 0.651534, loss_d: 0.011471
0.8052 --- loss: 1.432453, loss_ss: 1.418178, loss_d: 0.014275
0.8436 --- loss: 1.026031, loss_ss: 1.022925, loss_d: 0.003106
0.8819 --- loss: 1.034568, loss_ss: 0.781233, loss_d: 0.253334
0.9202 --- loss: 1.125025, loss_ss: 0.986787, loss_d: 0.138238
0.9586 --- loss: 0.882990, loss_ss: 0.709735, loss_d: 0.173255
0.9969 --- loss: 1.404193, loss_ss: 0.958717, loss_d: 0.445477
Epoch finished! Loss: 0.9550256227071469
Starting epoch 8/10.
0.0000 --- loss: 1.524784, loss_ss: 1.341860, loss_d: 0.182923
0.0383 --- loss: 1.138203, loss_ss: 1.040891, loss_d: 0.097312
0.0767 --- loss: 0.833742, loss_ss: 0.762987, loss_d: 0.070755
0.1150 --- loss: 0.621932, loss_ss: 0.593703, loss_d: 0.028229
0.1534 --- loss: 0.867891, loss_ss: 0.846353, loss_d: 0.021538
0.1917 --- loss: 1.029054, loss_ss: 0.935791, loss_d: 0.093263
0.2301 --- loss: 1.229223, loss_ss: 1.054791, loss_d: 0.174431
0.2684 --- loss: 0.905641, loss_ss: 0.900852, loss_d: 0.004789
0.3067 --- loss: 0.766575, loss_ss: 0.753269, loss_d: 0.013306
0.3451 --- loss: 1.059587, loss_ss: 1.026290, loss_d: 0.033297
0.3834 --- loss: 1.128636, loss_ss: 0.939229, loss_d: 0.189406
0.4218 --- loss: 0.928096, loss_ss: 0.874225, loss_d: 0.053871
0.4601 --- loss: 1.126530, loss_ss: 1.034088, loss_d: 0.092442
0.4985 --- loss: 0.773504, loss_ss: 0.768117, loss_d: 0.005387
0.5368 --- loss: 0.831348, loss_ss: 0.790401, loss_d: 0.040947
0.5752 --- loss: 0.650222, loss_ss: 0.624012, loss_d: 0.026210
0.6135 --- loss: 1.239106, loss_ss: 1.025916, loss_d: 0.213190
0.6518 --- loss: 0.692620, loss_ss: 0.660576, loss_d: 0.032044
0.6902 --- loss: 0.854919, loss_ss: 0.850035, loss_d: 0.004884
0.7285 --- loss: 0.609185, loss_ss: 0.489876, loss_d: 0.119309
0.7669 --- loss: 0.732305, loss_ss: 0.633477, loss_d: 0.098828
0.8052 --- loss: 1.083282, loss_ss: 0.657161, loss_d: 0.426121
0.8436 --- loss: 0.827496, loss_ss: 0.630224, loss_d: 0.197271
0.8819 --- loss: 1.142661, loss_ss: 1.009906, loss_d: 0.132755
0.9202 --- loss: 0.883219, loss_ss: 0.787697, loss_d: 0.095523
0.9586 --- loss: 0.998210, loss_ss: 0.901530, loss_d: 0.096680
0.9969 --- loss: 0.762018, loss_ss: 0.760356, loss_d: 0.001662
Epoch finished! Loss: 0.9107779356149527
Starting epoch 9/10.
0.0000 --- loss: 1.023418, loss_ss: 1.006157, loss_d: 0.017261
0.0383 --- loss: 0.801440, loss_ss: 0.796254, loss_d: 0.005186
0.0767 --- loss: 1.032027, loss_ss: 1.012643, loss_d: 0.019384
0.1150 --- loss: 0.716080, loss_ss: 0.691115, loss_d: 0.024966
0.1534 --- loss: 1.063886, loss_ss: 1.062113, loss_d: 0.001773
0.1917 --- loss: 0.796692, loss_ss: 0.720184, loss_d: 0.076508
0.2301 --- loss: 0.799598, loss_ss: 0.776570, loss_d: 0.023028
0.2684 --- loss: 0.641056, loss_ss: 0.598531, loss_d: 0.042525
0.3067 --- loss: 0.895302, loss_ss: 0.833692, loss_d: 0.061610
0.3451 --- loss: 1.088474, loss_ss: 0.722565, loss_d: 0.365909
0.3834 --- loss: 1.379678, loss_ss: 1.104402, loss_d: 0.275276
0.4218 --- loss: 0.635094, loss_ss: 0.627506, loss_d: 0.007588
0.4601 --- loss: 1.348316, loss_ss: 1.213935, loss_d: 0.134381
0.4985 --- loss: 0.768846, loss_ss: 0.767410, loss_d: 0.001437
0.5368 --- loss: 0.860482, loss_ss: 0.809528, loss_d: 0.050954
0.5752 --- loss: 0.890639, loss_ss: 0.528818, loss_d: 0.361821
0.6135 --- loss: 0.728210, loss_ss: 0.724940, loss_d: 0.003270
0.6518 --- loss: 0.863855, loss_ss: 0.785955, loss_d: 0.077900
0.6902 --- loss: 1.222242, loss_ss: 0.673764, loss_d: 0.548478
0.7285 --- loss: 1.243618, loss_ss: 0.916076, loss_d: 0.327542
0.7669 --- loss: 0.783780, loss_ss: 0.772644, loss_d: 0.011136
0.8052 --- loss: 0.756256, loss_ss: 0.746247, loss_d: 0.010009
0.8436 --- loss: 0.826189, loss_ss: 0.776070, loss_d: 0.050119
0.8819 --- loss: 0.905645, loss_ss: 0.778884, loss_d: 0.126761
0.9202 --- loss: 0.689567, loss_ss: 0.655302, loss_d: 0.034265
0.9586 --- loss: 0.930000, loss_ss: 0.916954, loss_d: 0.013046
0.9969 --- loss: 1.647067, loss_ss: 1.146177, loss_d: 0.500889
Epoch finished! Loss: 0.8767343117640569
Starting epoch 10/10.
0.0000 --- loss: 1.365171, loss_ss: 0.964227, loss_d: 0.400944
0.0383 --- loss: 0.840129, loss_ss: 0.726729, loss_d: 0.113400
0.0767 --- loss: 0.845878, loss_ss: 0.825090, loss_d: 0.020788
0.1150 --- loss: 1.176623, loss_ss: 0.935141, loss_d: 0.241481
0.1534 --- loss: 0.682811, loss_ss: 0.664674, loss_d: 0.018136
0.1917 --- loss: 1.870575, loss_ss: 1.155479, loss_d: 0.715097
0.2301 --- loss: 0.732124, loss_ss: 0.705619, loss_d: 0.026506
0.2684 --- loss: 1.154764, loss_ss: 1.116670, loss_d: 0.038094
0.3067 --- loss: 0.793729, loss_ss: 0.744065, loss_d: 0.049663
0.3451 --- loss: 0.641882, loss_ss: 0.632036, loss_d: 0.009846
0.3834 --- loss: 0.872991, loss_ss: 0.797096, loss_d: 0.075894
0.4218 --- loss: 1.081017, loss_ss: 1.062280, loss_d: 0.018737
0.4601 --- loss: 0.634639, loss_ss: 0.545209, loss_d: 0.089430
0.4985 --- loss: 0.631768, loss_ss: 0.614831, loss_d: 0.016937
0.5368 --- loss: 0.684574, loss_ss: 0.651487, loss_d: 0.033087
0.5752 --- loss: 0.864626, loss_ss: 0.861534, loss_d: 0.003091
0.6135 --- loss: 0.729345, loss_ss: 0.722514, loss_d: 0.006831
0.6518 --- loss: 0.989706, loss_ss: 0.988766, loss_d: 0.000941
0.6902 --- loss: 1.087616, loss_ss: 1.085122, loss_d: 0.002493
0.7285 --- loss: 0.799801, loss_ss: 0.606157, loss_d: 0.193644
0.7669 --- loss: 0.815989, loss_ss: 0.629392, loss_d: 0.186597
0.8052 --- loss: 0.941555, loss_ss: 0.789936, loss_d: 0.151619
0.8436 --- loss: 1.933565, loss_ss: 0.719152, loss_d: 1.214414
0.8819 --- loss: 0.622589, loss_ss: 0.609016, loss_d: 0.013574
0.9202 --- loss: 0.605015, loss_ss: 0.599473, loss_d: 0.005543
0.9586 --- loss: 0.949011, loss_ss: 0.930560, loss_d: 0.018451
0.9969 --- loss: 1.449218, loss_ss: 0.569438, loss_d: 0.879780
Epoch finished! Loss: 0.8864644809411122
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8255555555555556
             precision    recall  f1-score   support

        0.0       1.00      0.74      0.85       142
        1.0       0.11      0.13      0.12        23
        2.0       0.92      0.84      0.88       466
        3.0       0.91      0.86      0.88       167
        4.0       0.55      0.99      0.71       102

avg / total       0.87      0.83      0.83       900
 


====== chc052-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.89  73.94  100.00  100.00     85.02
1  95.00  13.04   97.15   10.71     11.76
2  87.67  83.69   91.94   91.76     87.54
3  95.78  86.23   97.95   90.57     88.34
4  90.78  99.02   89.72   55.19     70.88
Total accuracy: 82.56%
Average sen: 71.19%
Average spec: 95.35%
Macro f1-score: 68.71%
Diagnosis acc on 15mins: 1.0
[1.06822066e-02 3.54105346e-02 7.30479695e-03 8.70399177e-03
 1.20687706e-03 4.32091692e-05 1.45770115e-04 2.21690275e-02
 4.04782780e-03 3.10830935e-03 3.16941319e-03 1.60846612e-04
 1.71411093e-02 1.22687044e-02 3.22734471e-03 5.59755601e-03
 1.43027841e-03 5.30728546e-04 3.05505004e-04 4.77272959e-04
 5.11772523e-04 2.38817753e-04 3.12253018e-04 1.01852661e-03
 3.41793336e-03 9.93082393e-03 5.08794095e-03 2.43863882e-03
 1.47364952e-03 1.10870972e-02]
pred: 0.005754958791415751, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.453558, loss_ss: 1.733946, loss_d: 0.719613
0.0383 --- loss: 2.051266, loss_ss: 1.559958, loss_d: 0.491308
0.0767 --- loss: 1.906104, loss_ss: 1.544195, loss_d: 0.361909
0.1150 --- loss: 2.393511, loss_ss: 1.589571, loss_d: 0.803940
0.1534 --- loss: 1.907754, loss_ss: 1.446752, loss_d: 0.461002
0.1917 --- loss: 1.969414, loss_ss: 1.448031, loss_d: 0.521383
0.2301 --- loss: 1.958751, loss_ss: 1.276471, loss_d: 0.682280
0.2684 --- loss: 2.110598, loss_ss: 1.550069, loss_d: 0.560529
0.3067 --- loss: 1.860361, loss_ss: 1.514970, loss_d: 0.345391
0.3451 --- loss: 2.253029, loss_ss: 1.561179, loss_d: 0.691850
0.3834 --- loss: 1.925729, loss_ss: 1.387984, loss_d: 0.537745
0.4218 --- loss: 1.646986, loss_ss: 1.306428, loss_d: 0.340558
0.4601 --- loss: 1.542630, loss_ss: 1.192736, loss_d: 0.349895
0.4985 --- loss: 1.751248, loss_ss: 1.237349, loss_d: 0.513899
0.5368 --- loss: 1.687078, loss_ss: 1.111355, loss_d: 0.575724
0.5752 --- loss: 1.965730, loss_ss: 1.423478, loss_d: 0.542252
0.6135 --- loss: 1.915951, loss_ss: 1.363087, loss_d: 0.552864
0.6518 --- loss: 1.729726, loss_ss: 1.360416, loss_d: 0.369310
0.6902 --- loss: 1.442428, loss_ss: 1.044803, loss_d: 0.397625
0.7285 --- loss: 1.499478, loss_ss: 1.105623, loss_d: 0.393854
0.7669 --- loss: 1.864506, loss_ss: 1.438770, loss_d: 0.425736
0.8052 --- loss: 2.015589, loss_ss: 1.373466, loss_d: 0.642123
0.8436 --- loss: 1.342753, loss_ss: 1.117245, loss_d: 0.225507
0.8819 --- loss: 1.227290, loss_ss: 0.985882, loss_d: 0.241407
0.9202 --- loss: 1.601460, loss_ss: 1.053032, loss_d: 0.548428
0.9586 --- loss: 1.672024, loss_ss: 1.151189, loss_d: 0.520835
0.9969 --- loss: 1.245444, loss_ss: 1.087702, loss_d: 0.157742
Epoch finished! Loss: 1.8350831297727732
Starting epoch 2/10.
0.0000 --- loss: 1.515358, loss_ss: 1.327442, loss_d: 0.187915
0.0383 --- loss: 1.319002, loss_ss: 1.066788, loss_d: 0.252214
0.0767 --- loss: 1.313375, loss_ss: 0.908254, loss_d: 0.405122
0.1150 --- loss: 1.435197, loss_ss: 0.979801, loss_d: 0.455395
0.1534 --- loss: 1.547947, loss_ss: 1.209882, loss_d: 0.338065
0.1917 --- loss: 1.683702, loss_ss: 1.212094, loss_d: 0.471608
0.2301 --- loss: 1.809638, loss_ss: 1.022846, loss_d: 0.786792
0.2684 --- loss: 1.261329, loss_ss: 1.162911, loss_d: 0.098418
0.3067 --- loss: 1.196226, loss_ss: 1.037125, loss_d: 0.159101
0.3451 --- loss: 1.499715, loss_ss: 1.211581, loss_d: 0.288134
0.3834 --- loss: 1.397628, loss_ss: 1.073709, loss_d: 0.323919
0.4218 --- loss: 1.353193, loss_ss: 1.136479, loss_d: 0.216714
0.4601 --- loss: 1.329630, loss_ss: 0.892337, loss_d: 0.437294
0.4985 --- loss: 1.328113, loss_ss: 0.937932, loss_d: 0.390181
0.5368 --- loss: 1.243903, loss_ss: 1.049924, loss_d: 0.193978
0.5752 --- loss: 1.196531, loss_ss: 1.015127, loss_d: 0.181403
0.6135 --- loss: 1.100366, loss_ss: 1.046845, loss_d: 0.053522
0.6518 --- loss: 1.531092, loss_ss: 1.125662, loss_d: 0.405431
0.6902 --- loss: 1.240807, loss_ss: 0.895884, loss_d: 0.344922
0.7285 --- loss: 1.384135, loss_ss: 1.070189, loss_d: 0.313945
0.7669 --- loss: 1.087900, loss_ss: 0.972393, loss_d: 0.115506
0.8052 --- loss: 1.430850, loss_ss: 1.103878, loss_d: 0.326972
0.8436 --- loss: 1.143684, loss_ss: 0.882988, loss_d: 0.260696
0.8819 --- loss: 1.371369, loss_ss: 0.785431, loss_d: 0.585938
0.9202 --- loss: 1.267144, loss_ss: 1.043119, loss_d: 0.224025
0.9586 --- loss: 0.983963, loss_ss: 0.794874, loss_d: 0.189089
0.9969 --- loss: 1.223057, loss_ss: 1.117128, loss_d: 0.105929
Epoch finished! Loss: 1.3690235227346421
Starting epoch 3/10.
0.0000 --- loss: 0.956890, loss_ss: 0.857298, loss_d: 0.099592
0.0383 --- loss: 0.815295, loss_ss: 0.719731, loss_d: 0.095564
0.0767 --- loss: 0.931523, loss_ss: 0.799990, loss_d: 0.131533
0.1150 --- loss: 1.504381, loss_ss: 1.390226, loss_d: 0.114156
0.1534 --- loss: 1.440172, loss_ss: 1.237987, loss_d: 0.202185
0.1917 --- loss: 0.923589, loss_ss: 0.806435, loss_d: 0.117154
0.2301 --- loss: 1.186078, loss_ss: 0.956055, loss_d: 0.230023
0.2684 --- loss: 0.991565, loss_ss: 0.741768, loss_d: 0.249797
0.3067 --- loss: 1.610994, loss_ss: 0.898870, loss_d: 0.712125
0.3451 --- loss: 1.485964, loss_ss: 1.034636, loss_d: 0.451328
0.3834 --- loss: 1.075825, loss_ss: 0.978246, loss_d: 0.097579
0.4218 --- loss: 1.073257, loss_ss: 0.957425, loss_d: 0.115833
0.4601 --- loss: 0.778662, loss_ss: 0.636684, loss_d: 0.141977
0.4985 --- loss: 0.954950, loss_ss: 0.762248, loss_d: 0.192702
0.5368 --- loss: 0.986985, loss_ss: 0.880835, loss_d: 0.106150
0.5752 --- loss: 1.621139, loss_ss: 1.107327, loss_d: 0.513812
0.6135 --- loss: 1.388867, loss_ss: 1.183367, loss_d: 0.205501
0.6518 --- loss: 1.761927, loss_ss: 1.432495, loss_d: 0.329431
0.6902 --- loss: 1.319624, loss_ss: 1.078098, loss_d: 0.241526
0.7285 --- loss: 1.386087, loss_ss: 0.894586, loss_d: 0.491501
0.7669 --- loss: 1.071439, loss_ss: 0.667136, loss_d: 0.404303
0.8052 --- loss: 1.536036, loss_ss: 1.131736, loss_d: 0.404300
0.8436 --- loss: 0.945199, loss_ss: 0.812294, loss_d: 0.132904
0.8819 --- loss: 1.344764, loss_ss: 1.271446, loss_d: 0.073318
0.9202 --- loss: 1.397470, loss_ss: 0.873038, loss_d: 0.524432
0.9586 --- loss: 1.417055, loss_ss: 0.757644, loss_d: 0.659411
0.9969 --- loss: 1.028560, loss_ss: 0.785271, loss_d: 0.243289
Epoch finished! Loss: 1.2015111714601516
Starting epoch 4/10.
0.0000 --- loss: 1.103394, loss_ss: 0.648000, loss_d: 0.455394
0.0383 --- loss: 1.342328, loss_ss: 0.934031, loss_d: 0.408297
0.0767 --- loss: 1.102517, loss_ss: 0.957847, loss_d: 0.144670
0.1150 --- loss: 1.724438, loss_ss: 0.835394, loss_d: 0.889044
0.1534 --- loss: 0.714671, loss_ss: 0.661721, loss_d: 0.052950
0.1917 --- loss: 0.724690, loss_ss: 0.586199, loss_d: 0.138491
0.2301 --- loss: 1.025947, loss_ss: 0.622261, loss_d: 0.403685
0.2684 --- loss: 0.731235, loss_ss: 0.669033, loss_d: 0.062202
0.3067 --- loss: 0.952358, loss_ss: 0.824263, loss_d: 0.128095
0.3451 --- loss: 1.096863, loss_ss: 1.057360, loss_d: 0.039503
0.3834 --- loss: 1.267468, loss_ss: 0.975379, loss_d: 0.292089
0.4218 --- loss: 0.945827, loss_ss: 0.732843, loss_d: 0.212984
0.4601 --- loss: 1.047637, loss_ss: 0.824526, loss_d: 0.223111
0.4985 --- loss: 0.821429, loss_ss: 0.683812, loss_d: 0.137618
0.5368 --- loss: 0.810171, loss_ss: 0.728080, loss_d: 0.082092
0.5752 --- loss: 1.032578, loss_ss: 0.862420, loss_d: 0.170158
0.6135 --- loss: 1.476860, loss_ss: 1.008990, loss_d: 0.467870
0.6518 --- loss: 1.336235, loss_ss: 0.867366, loss_d: 0.468869
0.6902 --- loss: 1.051278, loss_ss: 0.779283, loss_d: 0.271995
0.7285 --- loss: 0.981578, loss_ss: 0.689785, loss_d: 0.291793
0.7669 --- loss: 0.916091, loss_ss: 0.871282, loss_d: 0.044809
0.8052 --- loss: 1.828075, loss_ss: 1.056237, loss_d: 0.771838
0.8436 --- loss: 0.754870, loss_ss: 0.566501, loss_d: 0.188369
0.8819 --- loss: 0.902690, loss_ss: 0.804366, loss_d: 0.098324
0.9202 --- loss: 1.017735, loss_ss: 0.764245, loss_d: 0.253489
0.9586 --- loss: 0.741544, loss_ss: 0.661602, loss_d: 0.079941
0.9969 --- loss: 1.157459, loss_ss: 1.088371, loss_d: 0.069088
Epoch finished! Loss: 1.0824173750785682
Starting epoch 5/10.
0.0000 --- loss: 0.816714, loss_ss: 0.773996, loss_d: 0.042717
0.0383 --- loss: 0.912364, loss_ss: 0.788772, loss_d: 0.123591
0.0767 --- loss: 0.916783, loss_ss: 0.815958, loss_d: 0.100825
0.1150 --- loss: 1.611686, loss_ss: 1.363121, loss_d: 0.248564
0.1534 --- loss: 0.710989, loss_ss: 0.648029, loss_d: 0.062960
0.1917 --- loss: 0.991513, loss_ss: 0.662594, loss_d: 0.328918
0.2301 --- loss: 1.068400, loss_ss: 0.963906, loss_d: 0.104495
0.2684 --- loss: 0.754485, loss_ss: 0.646147, loss_d: 0.108338
0.3067 --- loss: 0.782542, loss_ss: 0.664662, loss_d: 0.117879
0.3451 --- loss: 1.349591, loss_ss: 0.807565, loss_d: 0.542026
0.3834 --- loss: 1.003187, loss_ss: 0.984846, loss_d: 0.018341
0.4218 --- loss: 0.877435, loss_ss: 0.861451, loss_d: 0.015984
0.4601 --- loss: 1.069126, loss_ss: 0.935861, loss_d: 0.133264
0.4985 --- loss: 1.174773, loss_ss: 1.073279, loss_d: 0.101494
0.5368 --- loss: 0.728304, loss_ss: 0.665268, loss_d: 0.063035
0.5752 --- loss: 1.314493, loss_ss: 1.277105, loss_d: 0.037388
0.6135 --- loss: 1.263867, loss_ss: 0.736076, loss_d: 0.527791
0.6518 --- loss: 1.056488, loss_ss: 0.916360, loss_d: 0.140128
0.6902 --- loss: 0.799943, loss_ss: 0.661872, loss_d: 0.138071
0.7285 --- loss: 1.367241, loss_ss: 0.712804, loss_d: 0.654437
0.7669 --- loss: 0.591137, loss_ss: 0.510011, loss_d: 0.081126
0.8052 --- loss: 1.369357, loss_ss: 1.051485, loss_d: 0.317872
0.8436 --- loss: 1.146334, loss_ss: 0.924430, loss_d: 0.221904
0.8819 --- loss: 0.924978, loss_ss: 0.864474, loss_d: 0.060504
0.9202 --- loss: 0.741569, loss_ss: 0.679647, loss_d: 0.061922
0.9586 --- loss: 0.961855, loss_ss: 0.935051, loss_d: 0.026804
0.9969 --- loss: 0.701724, loss_ss: 0.675125, loss_d: 0.026600
Epoch finished! Loss: 0.9863844105830559
Starting epoch 6/10.
0.0000 --- loss: 1.336651, loss_ss: 0.717019, loss_d: 0.619632
0.0383 --- loss: 1.000905, loss_ss: 0.977254, loss_d: 0.023652
0.0767 --- loss: 1.052842, loss_ss: 0.909714, loss_d: 0.143127
0.1150 --- loss: 1.191042, loss_ss: 0.771519, loss_d: 0.419523
0.1534 --- loss: 0.947376, loss_ss: 0.863199, loss_d: 0.084177
0.1917 --- loss: 0.679222, loss_ss: 0.653323, loss_d: 0.025899
0.2301 --- loss: 0.791700, loss_ss: 0.758624, loss_d: 0.033076
0.2684 --- loss: 1.065676, loss_ss: 0.805144, loss_d: 0.260532
0.3067 --- loss: 0.977680, loss_ss: 0.748542, loss_d: 0.229137
0.3451 --- loss: 1.300384, loss_ss: 1.077642, loss_d: 0.222742
0.3834 --- loss: 1.652713, loss_ss: 1.500292, loss_d: 0.152421
0.4218 --- loss: 0.828671, loss_ss: 0.704943, loss_d: 0.123728
0.4601 --- loss: 0.749892, loss_ss: 0.688523, loss_d: 0.061369
0.4985 --- loss: 1.033482, loss_ss: 0.935570, loss_d: 0.097913
0.5368 --- loss: 0.821111, loss_ss: 0.785194, loss_d: 0.035917
0.5752 --- loss: 0.872916, loss_ss: 0.748252, loss_d: 0.124664
0.6135 --- loss: 1.025185, loss_ss: 0.873612, loss_d: 0.151573
0.6518 --- loss: 0.717222, loss_ss: 0.651389, loss_d: 0.065833
0.6902 --- loss: 0.968372, loss_ss: 0.819843, loss_d: 0.148529
0.7285 --- loss: 2.002690, loss_ss: 0.961888, loss_d: 1.040802
0.7669 --- loss: 0.897961, loss_ss: 0.844873, loss_d: 0.053088
0.8052 --- loss: 0.722929, loss_ss: 0.420321, loss_d: 0.302607
0.8436 --- loss: 1.246821, loss_ss: 1.034972, loss_d: 0.211849
0.8819 --- loss: 0.633361, loss_ss: 0.606721, loss_d: 0.026640
0.9202 --- loss: 1.059841, loss_ss: 0.963629, loss_d: 0.096212
0.9586 --- loss: 1.008120, loss_ss: 0.740913, loss_d: 0.267207
0.9969 --- loss: 0.832324, loss_ss: 0.794632, loss_d: 0.037692
Epoch finished! Loss: 0.9587862943227474
Starting epoch 7/10.
0.0000 --- loss: 0.656491, loss_ss: 0.640747, loss_d: 0.015744
0.0383 --- loss: 0.959829, loss_ss: 0.759931, loss_d: 0.199898
0.0767 --- loss: 0.640830, loss_ss: 0.620969, loss_d: 0.019861
0.1150 --- loss: 1.024977, loss_ss: 0.983343, loss_d: 0.041634
0.1534 --- loss: 1.039247, loss_ss: 0.914552, loss_d: 0.124695
0.1917 --- loss: 1.174891, loss_ss: 0.913842, loss_d: 0.261049
0.2301 --- loss: 1.046220, loss_ss: 0.858611, loss_d: 0.187609
0.2684 --- loss: 1.033436, loss_ss: 0.910096, loss_d: 0.123340
0.3067 --- loss: 1.234203, loss_ss: 1.020672, loss_d: 0.213531
0.3451 --- loss: 0.693713, loss_ss: 0.588804, loss_d: 0.104908
0.3834 --- loss: 0.980279, loss_ss: 0.805046, loss_d: 0.175232
0.4218 --- loss: 0.777262, loss_ss: 0.713486, loss_d: 0.063776
0.4601 --- loss: 0.812321, loss_ss: 0.757707, loss_d: 0.054614
0.4985 --- loss: 0.713324, loss_ss: 0.694206, loss_d: 0.019118
0.5368 --- loss: 0.655364, loss_ss: 0.531043, loss_d: 0.124321
0.5752 --- loss: 0.969474, loss_ss: 0.957582, loss_d: 0.011891
0.6135 --- loss: 0.971556, loss_ss: 0.849532, loss_d: 0.122024
0.6518 --- loss: 0.666295, loss_ss: 0.613148, loss_d: 0.053146
0.6902 --- loss: 0.846848, loss_ss: 0.669314, loss_d: 0.177534
0.7285 --- loss: 0.887244, loss_ss: 0.868692, loss_d: 0.018551
0.7669 --- loss: 0.664842, loss_ss: 0.632151, loss_d: 0.032691
0.8052 --- loss: 0.735168, loss_ss: 0.566351, loss_d: 0.168817
0.8436 --- loss: 0.418811, loss_ss: 0.373278, loss_d: 0.045533
0.8819 --- loss: 1.027231, loss_ss: 0.692261, loss_d: 0.334970
0.9202 --- loss: 0.977906, loss_ss: 0.852886, loss_d: 0.125020
0.9586 --- loss: 0.624773, loss_ss: 0.557741, loss_d: 0.067031
0.9969 --- loss: 0.755574, loss_ss: 0.743944, loss_d: 0.011630
Epoch finished! Loss: 0.8907196174447353
Starting epoch 8/10.
0.0000 --- loss: 1.123314, loss_ss: 0.772591, loss_d: 0.350723
0.0383 --- loss: 0.810429, loss_ss: 0.655247, loss_d: 0.155181
0.0767 --- loss: 0.679993, loss_ss: 0.636329, loss_d: 0.043664
0.1150 --- loss: 1.279787, loss_ss: 1.260458, loss_d: 0.019329
0.1534 --- loss: 0.829373, loss_ss: 0.760949, loss_d: 0.068424
0.1917 --- loss: 1.197959, loss_ss: 1.191797, loss_d: 0.006163
0.2301 --- loss: 0.894541, loss_ss: 0.838802, loss_d: 0.055740
0.2684 --- loss: 0.849625, loss_ss: 0.817089, loss_d: 0.032536
0.3067 --- loss: 0.821655, loss_ss: 0.587327, loss_d: 0.234329
0.3451 --- loss: 1.373087, loss_ss: 0.928870, loss_d: 0.444217
0.3834 --- loss: 1.379087, loss_ss: 0.723421, loss_d: 0.655665
0.4218 --- loss: 1.208457, loss_ss: 0.568857, loss_d: 0.639601
0.4601 --- loss: 1.112422, loss_ss: 1.104449, loss_d: 0.007973
0.4985 --- loss: 0.636883, loss_ss: 0.621641, loss_d: 0.015242
0.5368 --- loss: 1.713782, loss_ss: 1.086373, loss_d: 0.627409
0.5752 --- loss: 0.756538, loss_ss: 0.691627, loss_d: 0.064910
0.6135 --- loss: 0.851100, loss_ss: 0.638453, loss_d: 0.212647
0.6518 --- loss: 0.662123, loss_ss: 0.551535, loss_d: 0.110588
0.6902 --- loss: 0.567203, loss_ss: 0.522439, loss_d: 0.044764
0.7285 --- loss: 0.509951, loss_ss: 0.486902, loss_d: 0.023048
0.7669 --- loss: 0.687560, loss_ss: 0.619397, loss_d: 0.068162
0.8052 --- loss: 1.177145, loss_ss: 0.742964, loss_d: 0.434181
0.8436 --- loss: 0.973472, loss_ss: 0.954394, loss_d: 0.019077
0.8819 --- loss: 0.889404, loss_ss: 0.815289, loss_d: 0.074115
0.9202 --- loss: 0.791293, loss_ss: 0.744868, loss_d: 0.046425
0.9586 --- loss: 1.043769, loss_ss: 0.998434, loss_d: 0.045335
0.9969 --- loss: 0.628964, loss_ss: 0.618682, loss_d: 0.010282
Epoch finished! Loss: 0.8691433129402307
Starting epoch 9/10.
0.0000 --- loss: 1.412392, loss_ss: 1.358808, loss_d: 0.053584
0.0383 --- loss: 0.706078, loss_ss: 0.687876, loss_d: 0.018201
0.0767 --- loss: 0.829058, loss_ss: 0.806916, loss_d: 0.022142
0.1150 --- loss: 0.988529, loss_ss: 0.791583, loss_d: 0.196946
0.1534 --- loss: 0.672550, loss_ss: 0.649835, loss_d: 0.022715
0.1917 --- loss: 1.491436, loss_ss: 0.872065, loss_d: 0.619371
0.2301 --- loss: 0.882920, loss_ss: 0.789449, loss_d: 0.093471
0.2684 --- loss: 0.524411, loss_ss: 0.505860, loss_d: 0.018552
0.3067 --- loss: 0.867805, loss_ss: 0.826517, loss_d: 0.041288
0.3451 --- loss: 0.817071, loss_ss: 0.799981, loss_d: 0.017090
0.3834 --- loss: 0.664360, loss_ss: 0.629753, loss_d: 0.034607
0.4218 --- loss: 1.068047, loss_ss: 0.660159, loss_d: 0.407888
0.4601 --- loss: 1.081684, loss_ss: 1.030057, loss_d: 0.051626
0.4985 --- loss: 1.135455, loss_ss: 0.990818, loss_d: 0.144637
0.5368 --- loss: 0.749657, loss_ss: 0.735529, loss_d: 0.014128
0.5752 --- loss: 0.777550, loss_ss: 0.751576, loss_d: 0.025973
0.6135 --- loss: 0.997687, loss_ss: 0.955263, loss_d: 0.042423
0.6518 --- loss: 0.774108, loss_ss: 0.760500, loss_d: 0.013609
0.6902 --- loss: 0.710294, loss_ss: 0.675542, loss_d: 0.034752
0.7285 --- loss: 0.759306, loss_ss: 0.758567, loss_d: 0.000739
0.7669 --- loss: 0.713447, loss_ss: 0.626023, loss_d: 0.087423
0.8052 --- loss: 1.197204, loss_ss: 0.841349, loss_d: 0.355854
0.8436 --- loss: 0.883291, loss_ss: 0.690765, loss_d: 0.192526
0.8819 --- loss: 0.602453, loss_ss: 0.521824, loss_d: 0.080629
0.9202 --- loss: 0.920000, loss_ss: 0.811588, loss_d: 0.108412
0.9586 --- loss: 1.020988, loss_ss: 0.902415, loss_d: 0.118573
0.9969 --- loss: 0.874370, loss_ss: 0.678174, loss_d: 0.196196
Epoch finished! Loss: 0.8498606331073321
Starting epoch 10/10.
0.0000 --- loss: 0.861102, loss_ss: 0.853004, loss_d: 0.008098
0.0383 --- loss: 1.492216, loss_ss: 0.813171, loss_d: 0.679045
0.0767 --- loss: 0.942390, loss_ss: 0.540514, loss_d: 0.401876
0.1150 --- loss: 0.846286, loss_ss: 0.800465, loss_d: 0.045821
0.1534 --- loss: 0.959545, loss_ss: 0.917872, loss_d: 0.041673
0.1917 --- loss: 0.754281, loss_ss: 0.745939, loss_d: 0.008342
0.2301 --- loss: 0.687692, loss_ss: 0.686697, loss_d: 0.000995
0.2684 --- loss: 0.865963, loss_ss: 0.846600, loss_d: 0.019363
0.3067 --- loss: 1.123618, loss_ss: 1.106192, loss_d: 0.017427
0.3451 --- loss: 0.635386, loss_ss: 0.630177, loss_d: 0.005209
0.3834 --- loss: 0.624097, loss_ss: 0.576837, loss_d: 0.047261
0.4218 --- loss: 0.742990, loss_ss: 0.708118, loss_d: 0.034873
0.4601 --- loss: 1.199799, loss_ss: 0.924208, loss_d: 0.275591
0.4985 --- loss: 0.556203, loss_ss: 0.538676, loss_d: 0.017527
0.5368 --- loss: 0.612929, loss_ss: 0.598875, loss_d: 0.014054
0.5752 --- loss: 0.573871, loss_ss: 0.544536, loss_d: 0.029335
0.6135 --- loss: 0.941761, loss_ss: 0.917494, loss_d: 0.024267
0.6518 --- loss: 0.788858, loss_ss: 0.785751, loss_d: 0.003107
0.6902 --- loss: 0.881960, loss_ss: 0.868882, loss_d: 0.013078
0.7285 --- loss: 0.768946, loss_ss: 0.742048, loss_d: 0.026898
0.7669 --- loss: 0.624128, loss_ss: 0.612458, loss_d: 0.011670
0.8052 --- loss: 0.591910, loss_ss: 0.425257, loss_d: 0.166653
0.8436 --- loss: 0.743193, loss_ss: 0.741732, loss_d: 0.001460
0.8819 --- loss: 1.023135, loss_ss: 0.687012, loss_d: 0.336123
0.9202 --- loss: 0.646065, loss_ss: 0.628031, loss_d: 0.018033
0.9586 --- loss: 0.808221, loss_ss: 0.773634, loss_d: 0.034586
0.9969 --- loss: 0.945688, loss_ss: 0.899348, loss_d: 0.046341
Epoch finished! Loss: 0.8404050823587638
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7766666666666666
             precision    recall  f1-score   support

        0.0       0.85      0.81      0.83       175
        1.0       0.37      0.62      0.46        86
        2.0       0.82      0.94      0.87       396
        3.0       1.00      0.72      0.84       153
        4.0       0.86      0.27      0.41        90

avg / total       0.82      0.78      0.77       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.44  80.57   96.55   84.94     82.70
1  86.33  61.63   88.94   37.06     46.29
2  88.11  93.69   83.73   81.90     87.40
3  95.22  71.90  100.00  100.00     83.65
4  92.22  26.67   99.51   85.71     40.68
Total accuracy: 77.67%
Average sen: 66.89%
Average spec: 93.75%
Macro f1-score: 68.14%
Diagnosis acc on 15mins: 0.8
[0.00935925 0.00782782 0.03957666 0.03036277 0.00106868 0.00924467
 0.5679937  0.0458374  0.00348978 0.4042511  0.29896218 0.5695551
 0.02228806 0.73314893 0.13553993 0.60649383 0.0483111  0.03350878
 0.30340171 0.22595309 0.01671447 0.00586066 0.52673304 0.18529549
 0.08272218 0.09614865 0.50331175 0.07583311 0.10315191 0.00605991]
pred: 0.18993352382676676, label: 0
Right! Diagnosis: Other
Save 15mins of subject {subject}

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.439555, loss_ss: 1.763594, loss_d: 0.675962
0.0385 --- loss: 2.108995, loss_ss: 1.557774, loss_d: 0.551221
0.0769 --- loss: 2.135824, loss_ss: 1.436843, loss_d: 0.698981
0.1154 --- loss: 2.135705, loss_ss: 1.485720, loss_d: 0.649985
0.1538 --- loss: 2.213175, loss_ss: 1.333854, loss_d: 0.879322
0.1923 --- loss: 1.962692, loss_ss: 1.343201, loss_d: 0.619491
0.2308 --- loss: 2.066047, loss_ss: 1.288865, loss_d: 0.777182
0.2692 --- loss: 2.071515, loss_ss: 1.319335, loss_d: 0.752180
0.3077 --- loss: 1.513262, loss_ss: 1.186984, loss_d: 0.326278
0.3462 --- loss: 2.117546, loss_ss: 1.165080, loss_d: 0.952466
0.3846 --- loss: 1.819574, loss_ss: 1.222525, loss_d: 0.597048
0.4231 --- loss: 2.065254, loss_ss: 1.335659, loss_d: 0.729596
0.4615 --- loss: 1.783783, loss_ss: 1.295728, loss_d: 0.488056
0.5000 --- loss: 1.535278, loss_ss: 1.245355, loss_d: 0.289924
0.5385 --- loss: 1.818311, loss_ss: 1.190426, loss_d: 0.627885
0.5769 --- loss: 1.577682, loss_ss: 1.156986, loss_d: 0.420696
0.6154 --- loss: 1.739311, loss_ss: 1.170305, loss_d: 0.569006
0.6538 --- loss: 1.742501, loss_ss: 1.373209, loss_d: 0.369292
0.6923 --- loss: 1.797627, loss_ss: 1.380626, loss_d: 0.417001
0.7308 --- loss: 1.889134, loss_ss: 1.188579, loss_d: 0.700555
0.7692 --- loss: 2.130177, loss_ss: 1.376644, loss_d: 0.753533
0.8077 --- loss: 1.675873, loss_ss: 1.372531, loss_d: 0.303342
0.8462 --- loss: 1.807217, loss_ss: 1.255899, loss_d: 0.551318
0.8846 --- loss: 1.791253, loss_ss: 1.032237, loss_d: 0.759016
0.9231 --- loss: 1.625169, loss_ss: 1.169004, loss_d: 0.456165
0.9615 --- loss: 1.636421, loss_ss: 1.260868, loss_d: 0.375553
Epoch finished! Loss: 1.8057786971905978
Starting epoch 2/10.
0.0000 --- loss: 1.318112, loss_ss: 1.084854, loss_d: 0.233258
0.0385 --- loss: 1.596228, loss_ss: 1.080505, loss_d: 0.515723
0.0769 --- loss: 1.520603, loss_ss: 1.074470, loss_d: 0.446133
0.1154 --- loss: 1.185637, loss_ss: 0.869792, loss_d: 0.315845
0.1538 --- loss: 1.252022, loss_ss: 1.109017, loss_d: 0.143005
0.1923 --- loss: 1.495715, loss_ss: 1.130195, loss_d: 0.365520
0.2308 --- loss: 1.144013, loss_ss: 0.995123, loss_d: 0.148890
0.2692 --- loss: 1.918663, loss_ss: 1.050025, loss_d: 0.868638
0.3077 --- loss: 1.080835, loss_ss: 0.896428, loss_d: 0.184407
0.3462 --- loss: 1.650780, loss_ss: 1.185476, loss_d: 0.465304
0.3846 --- loss: 1.279545, loss_ss: 1.104539, loss_d: 0.175006
0.4231 --- loss: 1.012811, loss_ss: 0.927205, loss_d: 0.085606
0.4615 --- loss: 2.316796, loss_ss: 1.081494, loss_d: 1.235302
0.5000 --- loss: 1.245501, loss_ss: 0.895531, loss_d: 0.349970
0.5385 --- loss: 1.413165, loss_ss: 0.985289, loss_d: 0.427875
0.5769 --- loss: 1.223367, loss_ss: 0.939853, loss_d: 0.283513
0.6154 --- loss: 1.182637, loss_ss: 0.982774, loss_d: 0.199863
0.6538 --- loss: 1.628452, loss_ss: 0.912197, loss_d: 0.716255
0.6923 --- loss: 1.293410, loss_ss: 1.001046, loss_d: 0.292364
0.7308 --- loss: 1.421698, loss_ss: 1.169582, loss_d: 0.252116
0.7692 --- loss: 1.277224, loss_ss: 0.907285, loss_d: 0.369939
0.8077 --- loss: 1.050583, loss_ss: 0.869463, loss_d: 0.181121
0.8462 --- loss: 1.142323, loss_ss: 0.809507, loss_d: 0.332816
0.8846 --- loss: 1.285602, loss_ss: 1.089716, loss_d: 0.195886
0.9231 --- loss: 1.491882, loss_ss: 1.130852, loss_d: 0.361030
0.9615 --- loss: 1.091846, loss_ss: 1.022872, loss_d: 0.068974
Epoch finished! Loss: 1.373139323414983
Starting epoch 3/10.
0.0000 --- loss: 1.048753, loss_ss: 0.842515, loss_d: 0.206238
0.0385 --- loss: 1.265265, loss_ss: 1.086765, loss_d: 0.178500
0.0769 --- loss: 1.908515, loss_ss: 1.037874, loss_d: 0.870641
0.1154 --- loss: 1.175078, loss_ss: 0.880729, loss_d: 0.294349
0.1538 --- loss: 1.496004, loss_ss: 1.248615, loss_d: 0.247389
0.1923 --- loss: 1.088268, loss_ss: 0.919386, loss_d: 0.168883
0.2308 --- loss: 1.606031, loss_ss: 1.207342, loss_d: 0.398688
0.2692 --- loss: 1.577227, loss_ss: 0.706311, loss_d: 0.870916
0.3077 --- loss: 1.064304, loss_ss: 0.853041, loss_d: 0.211263
0.3462 --- loss: 1.444388, loss_ss: 1.101430, loss_d: 0.342958
0.3846 --- loss: 1.298493, loss_ss: 0.965636, loss_d: 0.332857
0.4231 --- loss: 0.845734, loss_ss: 0.757387, loss_d: 0.088347
0.4615 --- loss: 1.121629, loss_ss: 0.993973, loss_d: 0.127655
0.5000 --- loss: 1.035757, loss_ss: 0.931518, loss_d: 0.104239
0.5385 --- loss: 1.559632, loss_ss: 1.210757, loss_d: 0.348874
0.5769 --- loss: 1.027811, loss_ss: 0.921299, loss_d: 0.106513
0.6154 --- loss: 1.603288, loss_ss: 1.058802, loss_d: 0.544486
0.6538 --- loss: 1.080341, loss_ss: 0.940890, loss_d: 0.139451
0.6923 --- loss: 1.471943, loss_ss: 0.940492, loss_d: 0.531451
0.7308 --- loss: 1.178413, loss_ss: 1.023789, loss_d: 0.154624
0.7692 --- loss: 1.157431, loss_ss: 0.967034, loss_d: 0.190398
0.8077 --- loss: 1.226637, loss_ss: 1.013578, loss_d: 0.213059
0.8462 --- loss: 1.159851, loss_ss: 0.800430, loss_d: 0.359420
0.8846 --- loss: 1.059194, loss_ss: 0.961172, loss_d: 0.098023
0.9231 --- loss: 1.001501, loss_ss: 0.708511, loss_d: 0.292991
0.9615 --- loss: 0.974787, loss_ss: 0.798670, loss_d: 0.176117
Epoch finished! Loss: 1.206972488105067
Starting epoch 4/10.
0.0000 --- loss: 1.112504, loss_ss: 0.914971, loss_d: 0.197534
0.0385 --- loss: 0.892063, loss_ss: 0.731421, loss_d: 0.160642
0.0769 --- loss: 1.310835, loss_ss: 0.765946, loss_d: 0.544889
0.1154 --- loss: 0.707675, loss_ss: 0.629626, loss_d: 0.078049
0.1538 --- loss: 1.383007, loss_ss: 1.323171, loss_d: 0.059836
0.1923 --- loss: 1.568662, loss_ss: 0.777469, loss_d: 0.791192
0.2308 --- loss: 1.320123, loss_ss: 0.977751, loss_d: 0.342372
0.2692 --- loss: 1.162916, loss_ss: 0.975758, loss_d: 0.187157
0.3077 --- loss: 1.205137, loss_ss: 0.814946, loss_d: 0.390191
0.3462 --- loss: 1.227113, loss_ss: 0.879168, loss_d: 0.347945
0.3846 --- loss: 1.095065, loss_ss: 0.882184, loss_d: 0.212881
0.4231 --- loss: 0.787034, loss_ss: 0.764096, loss_d: 0.022938
0.4615 --- loss: 1.287776, loss_ss: 0.923894, loss_d: 0.363882
0.5000 --- loss: 1.003253, loss_ss: 0.675457, loss_d: 0.327796
0.5385 --- loss: 0.734963, loss_ss: 0.690363, loss_d: 0.044600
0.5769 --- loss: 0.957312, loss_ss: 0.779715, loss_d: 0.177597
0.6154 --- loss: 0.931448, loss_ss: 0.818320, loss_d: 0.113128
0.6538 --- loss: 1.352583, loss_ss: 0.823019, loss_d: 0.529564
0.6923 --- loss: 0.967653, loss_ss: 0.750973, loss_d: 0.216680
0.7308 --- loss: 0.792787, loss_ss: 0.606124, loss_d: 0.186663
0.7692 --- loss: 0.850456, loss_ss: 0.701327, loss_d: 0.149129
0.8077 --- loss: 1.253341, loss_ss: 0.618726, loss_d: 0.634615
0.8462 --- loss: 1.334559, loss_ss: 0.867720, loss_d: 0.466839
0.8846 --- loss: 1.079676, loss_ss: 1.008020, loss_d: 0.071657
0.9231 --- loss: 0.744989, loss_ss: 0.664115, loss_d: 0.080874
0.9615 --- loss: 0.913723, loss_ss: 0.721930, loss_d: 0.191793
Epoch finished! Loss: 1.1102599915850577
Starting epoch 5/10.
0.0000 --- loss: 1.064497, loss_ss: 1.011703, loss_d: 0.052794
0.0385 --- loss: 1.231970, loss_ss: 0.665757, loss_d: 0.566212
0.0769 --- loss: 1.008030, loss_ss: 0.974499, loss_d: 0.033531
0.1154 --- loss: 0.917636, loss_ss: 0.752692, loss_d: 0.164945
0.1538 --- loss: 0.942234, loss_ss: 0.838688, loss_d: 0.103545
0.1923 --- loss: 1.028296, loss_ss: 0.871364, loss_d: 0.156933
0.2308 --- loss: 0.952168, loss_ss: 0.866562, loss_d: 0.085607
0.2692 --- loss: 0.981412, loss_ss: 0.810255, loss_d: 0.171157
0.3077 --- loss: 0.955912, loss_ss: 0.650966, loss_d: 0.304946
0.3462 --- loss: 0.734021, loss_ss: 0.642710, loss_d: 0.091310
0.3846 --- loss: 0.951629, loss_ss: 0.719050, loss_d: 0.232579
0.4231 --- loss: 0.928930, loss_ss: 0.667297, loss_d: 0.261633
0.4615 --- loss: 0.984130, loss_ss: 0.900994, loss_d: 0.083136
0.5000 --- loss: 0.803005, loss_ss: 0.749341, loss_d: 0.053665
0.5385 --- loss: 1.315018, loss_ss: 0.728505, loss_d: 0.586513
0.5769 --- loss: 0.838338, loss_ss: 0.718439, loss_d: 0.119899
0.6154 --- loss: 1.245552, loss_ss: 1.209292, loss_d: 0.036260
0.6538 --- loss: 0.840987, loss_ss: 0.697492, loss_d: 0.143495
0.6923 --- loss: 0.985794, loss_ss: 0.791755, loss_d: 0.194039
0.7308 --- loss: 0.865775, loss_ss: 0.799318, loss_d: 0.066457
0.7692 --- loss: 1.232408, loss_ss: 0.817687, loss_d: 0.414721
0.8077 --- loss: 1.441434, loss_ss: 0.716330, loss_d: 0.725105
0.8462 --- loss: 0.813154, loss_ss: 0.763809, loss_d: 0.049345
0.8846 --- loss: 1.057515, loss_ss: 1.037549, loss_d: 0.019966
0.9231 --- loss: 1.033647, loss_ss: 0.905240, loss_d: 0.128407
0.9615 --- loss: 0.839183, loss_ss: 0.733786, loss_d: 0.105398
Epoch finished! Loss: 1.007488446346121
Starting epoch 6/10.
0.0000 --- loss: 0.834763, loss_ss: 0.748154, loss_d: 0.086609
0.0385 --- loss: 0.987497, loss_ss: 0.814038, loss_d: 0.173460
0.0769 --- loss: 1.032112, loss_ss: 0.856772, loss_d: 0.175340
0.1154 --- loss: 1.585705, loss_ss: 0.664118, loss_d: 0.921586
0.1538 --- loss: 0.845700, loss_ss: 0.646990, loss_d: 0.198711
0.1923 --- loss: 1.248535, loss_ss: 1.126063, loss_d: 0.122472
0.2308 --- loss: 1.083793, loss_ss: 0.822254, loss_d: 0.261539
0.2692 --- loss: 0.933806, loss_ss: 0.694740, loss_d: 0.239066
0.3077 --- loss: 0.734953, loss_ss: 0.683945, loss_d: 0.051008
0.3462 --- loss: 0.976368, loss_ss: 0.910618, loss_d: 0.065750
0.3846 --- loss: 0.690160, loss_ss: 0.654153, loss_d: 0.036007
0.4231 --- loss: 1.450425, loss_ss: 1.179846, loss_d: 0.270579
0.4615 --- loss: 1.200818, loss_ss: 0.883401, loss_d: 0.317417
0.5000 --- loss: 1.110139, loss_ss: 1.015785, loss_d: 0.094353
0.5385 --- loss: 0.813673, loss_ss: 0.678139, loss_d: 0.135533
0.5769 --- loss: 0.974114, loss_ss: 0.698737, loss_d: 0.275377
0.6154 --- loss: 1.133814, loss_ss: 0.846981, loss_d: 0.286834
0.6538 --- loss: 1.494097, loss_ss: 1.237525, loss_d: 0.256572
0.6923 --- loss: 1.021622, loss_ss: 0.860612, loss_d: 0.161010
0.7308 --- loss: 1.180995, loss_ss: 1.118048, loss_d: 0.062946
0.7692 --- loss: 0.700415, loss_ss: 0.634529, loss_d: 0.065886
0.8077 --- loss: 0.818964, loss_ss: 0.794796, loss_d: 0.024168
0.8462 --- loss: 0.885168, loss_ss: 0.804438, loss_d: 0.080730
0.8846 --- loss: 0.799270, loss_ss: 0.757810, loss_d: 0.041460
0.9231 --- loss: 0.966334, loss_ss: 0.862132, loss_d: 0.104202
0.9615 --- loss: 0.684937, loss_ss: 0.661737, loss_d: 0.023200
Epoch finished! Loss: 0.9655418096822201
Starting epoch 7/10.
0.0000 --- loss: 1.043480, loss_ss: 1.026717, loss_d: 0.016763
0.0385 --- loss: 1.055566, loss_ss: 0.775612, loss_d: 0.279954
0.0769 --- loss: 0.641811, loss_ss: 0.476443, loss_d: 0.165367
0.1154 --- loss: 1.153314, loss_ss: 0.913473, loss_d: 0.239842
0.1538 --- loss: 0.826349, loss_ss: 0.695084, loss_d: 0.131265
0.1923 --- loss: 0.690166, loss_ss: 0.556828, loss_d: 0.133337
0.2308 --- loss: 1.048679, loss_ss: 0.895596, loss_d: 0.153083
0.2692 --- loss: 0.635561, loss_ss: 0.628781, loss_d: 0.006779
0.3077 --- loss: 0.659808, loss_ss: 0.648032, loss_d: 0.011776
0.3462 --- loss: 1.251171, loss_ss: 0.885709, loss_d: 0.365462
0.3846 --- loss: 0.868211, loss_ss: 0.646307, loss_d: 0.221903
0.4231 --- loss: 0.691493, loss_ss: 0.656772, loss_d: 0.034721
0.4615 --- loss: 1.217122, loss_ss: 0.885495, loss_d: 0.331627
0.5000 --- loss: 0.963085, loss_ss: 0.867304, loss_d: 0.095781
0.5385 --- loss: 1.166703, loss_ss: 0.780344, loss_d: 0.386359
0.5769 --- loss: 0.965920, loss_ss: 0.743114, loss_d: 0.222806
0.6154 --- loss: 0.898114, loss_ss: 0.837676, loss_d: 0.060438
0.6538 --- loss: 1.183127, loss_ss: 0.688034, loss_d: 0.495094
0.6923 --- loss: 0.865325, loss_ss: 0.820617, loss_d: 0.044708
0.7308 --- loss: 0.756550, loss_ss: 0.587566, loss_d: 0.168984
0.7692 --- loss: 0.830361, loss_ss: 0.699043, loss_d: 0.131318
0.8077 --- loss: 1.072615, loss_ss: 0.743357, loss_d: 0.329258
0.8462 --- loss: 0.589898, loss_ss: 0.569181, loss_d: 0.020717
0.8846 --- loss: 1.018402, loss_ss: 0.989096, loss_d: 0.029306
0.9231 --- loss: 0.839769, loss_ss: 0.809759, loss_d: 0.030010
0.9615 --- loss: 0.682228, loss_ss: 0.669728, loss_d: 0.012501
Epoch finished! Loss: 0.9307906363001202
Starting epoch 8/10.
0.0000 --- loss: 0.804062, loss_ss: 0.732418, loss_d: 0.071644
0.0385 --- loss: 0.647514, loss_ss: 0.567346, loss_d: 0.080168
0.0769 --- loss: 0.810525, loss_ss: 0.749600, loss_d: 0.060925
0.1154 --- loss: 0.573436, loss_ss: 0.568064, loss_d: 0.005372
0.1538 --- loss: 0.836221, loss_ss: 0.763723, loss_d: 0.072498
0.1923 --- loss: 1.201462, loss_ss: 0.921321, loss_d: 0.280141
0.2308 --- loss: 0.909732, loss_ss: 0.871501, loss_d: 0.038231
0.2692 --- loss: 0.553963, loss_ss: 0.538744, loss_d: 0.015219
0.3077 --- loss: 0.768034, loss_ss: 0.708560, loss_d: 0.059475
0.3462 --- loss: 0.860307, loss_ss: 0.825126, loss_d: 0.035180
0.3846 --- loss: 0.991189, loss_ss: 0.876158, loss_d: 0.115030
0.4231 --- loss: 0.953146, loss_ss: 0.838302, loss_d: 0.114845
0.4615 --- loss: 0.952512, loss_ss: 0.665933, loss_d: 0.286579
0.5000 --- loss: 0.791057, loss_ss: 0.618960, loss_d: 0.172097
0.5385 --- loss: 0.944243, loss_ss: 0.908918, loss_d: 0.035325
0.5769 --- loss: 1.021459, loss_ss: 0.998344, loss_d: 0.023115
0.6154 --- loss: 1.015893, loss_ss: 0.851057, loss_d: 0.164836
0.6538 --- loss: 0.639673, loss_ss: 0.591862, loss_d: 0.047811
0.6923 --- loss: 0.969205, loss_ss: 0.948981, loss_d: 0.020224
0.7308 --- loss: 1.307905, loss_ss: 1.209955, loss_d: 0.097950
0.7692 --- loss: 0.942440, loss_ss: 0.774800, loss_d: 0.167640
0.8077 --- loss: 1.175176, loss_ss: 0.987671, loss_d: 0.187504
0.8462 --- loss: 1.043811, loss_ss: 0.673959, loss_d: 0.369853
0.8846 --- loss: 1.185400, loss_ss: 1.011358, loss_d: 0.174042
0.9231 --- loss: 1.000170, loss_ss: 0.697603, loss_d: 0.302567
0.9615 --- loss: 0.790729, loss_ss: 0.724804, loss_d: 0.065925
Epoch finished! Loss: 0.9044667921931587
Starting epoch 9/10.
0.0000 --- loss: 0.838072, loss_ss: 0.802745, loss_d: 0.035327
0.0385 --- loss: 0.882315, loss_ss: 0.611836, loss_d: 0.270480
0.0769 --- loss: 0.855329, loss_ss: 0.807595, loss_d: 0.047734
0.1154 --- loss: 0.587526, loss_ss: 0.568497, loss_d: 0.019029
0.1538 --- loss: 0.667801, loss_ss: 0.649300, loss_d: 0.018501
0.1923 --- loss: 0.883647, loss_ss: 0.816752, loss_d: 0.066894
0.2308 --- loss: 0.510173, loss_ss: 0.484145, loss_d: 0.026028
0.2692 --- loss: 0.932852, loss_ss: 0.882449, loss_d: 0.050403
0.3077 --- loss: 1.221046, loss_ss: 0.939553, loss_d: 0.281493
0.3462 --- loss: 0.617515, loss_ss: 0.492538, loss_d: 0.124977
0.3846 --- loss: 0.804885, loss_ss: 0.790576, loss_d: 0.014308
0.4231 --- loss: 0.868393, loss_ss: 0.861668, loss_d: 0.006725
0.4615 --- loss: 1.663479, loss_ss: 1.396633, loss_d: 0.266846
0.5000 --- loss: 1.767908, loss_ss: 0.834129, loss_d: 0.933779
0.5385 --- loss: 0.841762, loss_ss: 0.826488, loss_d: 0.015273
0.5769 --- loss: 0.701343, loss_ss: 0.663148, loss_d: 0.038195
0.6154 --- loss: 0.978181, loss_ss: 0.925500, loss_d: 0.052680
0.6538 --- loss: 0.748355, loss_ss: 0.665352, loss_d: 0.083003
0.6923 --- loss: 0.773638, loss_ss: 0.767505, loss_d: 0.006132
0.7308 --- loss: 1.051468, loss_ss: 0.760793, loss_d: 0.290675
0.7692 --- loss: 1.022337, loss_ss: 0.874591, loss_d: 0.147746
0.8077 --- loss: 0.613195, loss_ss: 0.546642, loss_d: 0.066553
0.8462 --- loss: 0.539003, loss_ss: 0.518545, loss_d: 0.020458
0.8846 --- loss: 0.930442, loss_ss: 0.824715, loss_d: 0.105727
0.9231 --- loss: 0.639499, loss_ss: 0.583501, loss_d: 0.055997
0.9615 --- loss: 0.622187, loss_ss: 0.566320, loss_d: 0.055868
Epoch finished! Loss: 0.8561526744061916
Starting epoch 10/10.
0.0000 --- loss: 0.591902, loss_ss: 0.589824, loss_d: 0.002078
0.0385 --- loss: 0.928467, loss_ss: 0.921693, loss_d: 0.006773
0.0769 --- loss: 0.673247, loss_ss: 0.664827, loss_d: 0.008420
0.1154 --- loss: 0.948804, loss_ss: 0.877129, loss_d: 0.071676
0.1538 --- loss: 0.589781, loss_ss: 0.568156, loss_d: 0.021625
0.1923 --- loss: 0.700365, loss_ss: 0.571659, loss_d: 0.128706
0.2308 --- loss: 0.508988, loss_ss: 0.506439, loss_d: 0.002549
0.2692 --- loss: 0.965090, loss_ss: 0.619791, loss_d: 0.345299
0.3077 --- loss: 0.626931, loss_ss: 0.612553, loss_d: 0.014378
0.3462 --- loss: 0.490934, loss_ss: 0.473948, loss_d: 0.016986
0.3846 --- loss: 0.685612, loss_ss: 0.665210, loss_d: 0.020402
0.4231 --- loss: 1.013962, loss_ss: 0.937306, loss_d: 0.076656
0.4615 --- loss: 0.643832, loss_ss: 0.632614, loss_d: 0.011218
0.5000 --- loss: 0.731414, loss_ss: 0.637709, loss_d: 0.093705
0.5385 --- loss: 0.783689, loss_ss: 0.751686, loss_d: 0.032003
0.5769 --- loss: 0.586419, loss_ss: 0.421639, loss_d: 0.164780
0.6154 --- loss: 0.610564, loss_ss: 0.589078, loss_d: 0.021486
0.6538 --- loss: 0.904602, loss_ss: 0.901410, loss_d: 0.003192
0.6923 --- loss: 0.726613, loss_ss: 0.577530, loss_d: 0.149083
0.7308 --- loss: 0.692940, loss_ss: 0.669764, loss_d: 0.023176
0.7692 --- loss: 0.645760, loss_ss: 0.632674, loss_d: 0.013085
0.8077 --- loss: 1.018970, loss_ss: 0.945726, loss_d: 0.073244
0.8462 --- loss: 1.511662, loss_ss: 1.038551, loss_d: 0.473111
0.8846 --- loss: 0.905112, loss_ss: 0.836210, loss_d: 0.068901
0.9231 --- loss: 0.740321, loss_ss: 0.709341, loss_d: 0.030980
0.9615 --- loss: 0.963497, loss_ss: 0.960961, loss_d: 0.002537
Epoch finished! Loss: 0.8414220768512446
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5964912280701754
             precision    recall  f1-score   support

        0.0       0.52      0.68      0.59        40
        1.0       0.16      0.92      0.27        79
        2.0       0.91      0.60      0.72       553
        3.0       1.00      0.52      0.69        69
        4.0       0.95      0.54      0.68       399

avg / total       0.86      0.60      0.67      1140
 


====== chp001-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.67  67.50   97.73   51.92     58.70
1  65.26  92.41   63.24   15.77     26.94
2  77.54  59.67   94.38   90.91     72.05
3  97.11  52.17  100.00  100.00     68.57
4  82.72  53.63   98.38   94.69     68.48
Total accuracy: 59.65%
Average sen: 65.08%
Average spec: 90.75%
Macro f1-score: 58.95%
Diagnosis acc on 15mins: 1.0
[0.99957007 0.99472815 0.95434123 0.99125659 0.99762386 0.99677998
 0.9993512  0.99922931 0.98225039 0.99963689 0.99955469 0.99888295
 0.99991024 0.9999944  0.99873811 0.99633151 0.99699068 0.99891901
 0.99997354 0.99982387 0.99994898 0.99999106 0.99830925 0.99899691
 0.99990177 0.99525601 0.99889117 0.99969184 0.99999702 0.99999726
 0.99999595 0.99999821 0.99971968 0.99593556 0.99955648 0.9999789
 0.99977225 0.99999797]
pred: 0.9971006042078921, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.258412, loss_ss: 1.591906, loss_d: 0.666506
0.0384 --- loss: 2.109385, loss_ss: 1.577703, loss_d: 0.531682
0.0769 --- loss: 1.798410, loss_ss: 1.381406, loss_d: 0.417004
0.1153 --- loss: 1.909191, loss_ss: 1.331444, loss_d: 0.577747
0.1537 --- loss: 1.917855, loss_ss: 1.353778, loss_d: 0.564076
0.1922 --- loss: 2.139949, loss_ss: 1.358259, loss_d: 0.781691
0.2306 --- loss: 2.196965, loss_ss: 1.332843, loss_d: 0.864122
0.2690 --- loss: 2.124975, loss_ss: 1.335953, loss_d: 0.789022
0.3075 --- loss: 1.734519, loss_ss: 1.240770, loss_d: 0.493749
0.3459 --- loss: 2.076728, loss_ss: 1.232103, loss_d: 0.844625
0.3843 --- loss: 2.252171, loss_ss: 1.335721, loss_d: 0.916449
0.4228 --- loss: 1.886823, loss_ss: 1.316853, loss_d: 0.569971
0.4612 --- loss: 1.749009, loss_ss: 1.224083, loss_d: 0.524926
0.4996 --- loss: 1.650334, loss_ss: 1.155160, loss_d: 0.495173
0.5380 --- loss: 1.862127, loss_ss: 1.280886, loss_d: 0.581240
0.5765 --- loss: 2.008504, loss_ss: 1.474713, loss_d: 0.533791
0.6149 --- loss: 1.502072, loss_ss: 1.180924, loss_d: 0.321147
0.6533 --- loss: 1.661855, loss_ss: 1.221044, loss_d: 0.440811
0.6918 --- loss: 1.412182, loss_ss: 1.101636, loss_d: 0.310546
0.7302 --- loss: 1.451628, loss_ss: 1.131700, loss_d: 0.319927
0.7686 --- loss: 1.520822, loss_ss: 1.066352, loss_d: 0.454470
0.8071 --- loss: 1.166107, loss_ss: 0.977032, loss_d: 0.189074
0.8455 --- loss: 1.359374, loss_ss: 1.074643, loss_d: 0.284731
0.8839 --- loss: 2.158789, loss_ss: 1.163614, loss_d: 0.995176
0.9224 --- loss: 1.676598, loss_ss: 1.146722, loss_d: 0.529875
0.9608 --- loss: 1.588744, loss_ss: 1.161032, loss_d: 0.427711
0.9992 --- loss: 1.166972, loss_ss: 0.947753, loss_d: 0.219219
Epoch finished! Loss: 1.7858888662778414
Starting epoch 2/10.
0.0000 --- loss: 1.604719, loss_ss: 1.455965, loss_d: 0.148754
0.0384 --- loss: 1.515210, loss_ss: 1.116124, loss_d: 0.399086
0.0769 --- loss: 1.116324, loss_ss: 1.068298, loss_d: 0.048026
0.1153 --- loss: 1.763865, loss_ss: 1.364630, loss_d: 0.399235
0.1537 --- loss: 1.859456, loss_ss: 1.467815, loss_d: 0.391641
0.1922 --- loss: 1.468010, loss_ss: 1.012749, loss_d: 0.455261
0.2306 --- loss: 1.487022, loss_ss: 1.021260, loss_d: 0.465761
0.2690 --- loss: 1.948377, loss_ss: 1.190575, loss_d: 0.757803
0.3075 --- loss: 1.689506, loss_ss: 0.961412, loss_d: 0.728094
0.3459 --- loss: 1.484187, loss_ss: 1.088819, loss_d: 0.395368
0.3843 --- loss: 1.563892, loss_ss: 1.018270, loss_d: 0.545622
0.4228 --- loss: 1.828159, loss_ss: 1.119482, loss_d: 0.708677
0.4612 --- loss: 1.032253, loss_ss: 0.815649, loss_d: 0.216604
0.4996 --- loss: 1.125967, loss_ss: 0.967533, loss_d: 0.158434
0.5380 --- loss: 1.027605, loss_ss: 0.912217, loss_d: 0.115388
0.5765 --- loss: 1.457654, loss_ss: 0.997781, loss_d: 0.459873
0.6149 --- loss: 1.472432, loss_ss: 1.052839, loss_d: 0.419593
0.6533 --- loss: 1.303584, loss_ss: 1.050437, loss_d: 0.253147
0.6918 --- loss: 1.658064, loss_ss: 1.013253, loss_d: 0.644811
0.7302 --- loss: 1.239582, loss_ss: 0.943806, loss_d: 0.295775
0.7686 --- loss: 1.228519, loss_ss: 0.920659, loss_d: 0.307860
0.8071 --- loss: 1.202401, loss_ss: 1.050429, loss_d: 0.151972
0.8455 --- loss: 1.451509, loss_ss: 1.198996, loss_d: 0.252513
0.8839 --- loss: 1.392653, loss_ss: 1.029572, loss_d: 0.363082
0.9224 --- loss: 1.314913, loss_ss: 0.839772, loss_d: 0.475141
0.9608 --- loss: 1.223210, loss_ss: 1.080331, loss_d: 0.142879
0.9992 --- loss: 4.283940, loss_ss: 1.095979, loss_d: 3.187962
Epoch finished! Loss: 1.4024540192805803
Starting epoch 3/10.
0.0000 --- loss: 1.398331, loss_ss: 0.931928, loss_d: 0.466403
0.0384 --- loss: 1.322358, loss_ss: 1.210728, loss_d: 0.111630
0.0769 --- loss: 0.983674, loss_ss: 0.799590, loss_d: 0.184084
0.1153 --- loss: 1.240878, loss_ss: 1.017010, loss_d: 0.223868
0.1537 --- loss: 1.337946, loss_ss: 1.144050, loss_d: 0.193896
0.1922 --- loss: 1.478313, loss_ss: 0.993929, loss_d: 0.484384
0.2306 --- loss: 1.269923, loss_ss: 1.040853, loss_d: 0.229071
0.2690 --- loss: 1.278280, loss_ss: 1.088332, loss_d: 0.189948
0.3075 --- loss: 1.453296, loss_ss: 1.197453, loss_d: 0.255843
0.3459 --- loss: 1.393837, loss_ss: 0.941371, loss_d: 0.452466
0.3843 --- loss: 1.529300, loss_ss: 1.103943, loss_d: 0.425357
0.4228 --- loss: 1.231310, loss_ss: 1.149073, loss_d: 0.082237
0.4612 --- loss: 1.344948, loss_ss: 0.851446, loss_d: 0.493502
0.4996 --- loss: 2.042658, loss_ss: 1.501270, loss_d: 0.541388
0.5380 --- loss: 1.136122, loss_ss: 0.955226, loss_d: 0.180896
0.5765 --- loss: 1.088032, loss_ss: 0.863765, loss_d: 0.224267
0.6149 --- loss: 0.972645, loss_ss: 0.900968, loss_d: 0.071677
0.6533 --- loss: 0.895058, loss_ss: 0.654876, loss_d: 0.240182
0.6918 --- loss: 1.234429, loss_ss: 0.863095, loss_d: 0.371335
0.7302 --- loss: 0.837037, loss_ss: 0.760216, loss_d: 0.076821
0.7686 --- loss: 0.893307, loss_ss: 0.790207, loss_d: 0.103100
0.8071 --- loss: 1.385450, loss_ss: 1.044031, loss_d: 0.341419
0.8455 --- loss: 1.486032, loss_ss: 0.988495, loss_d: 0.497538
0.8839 --- loss: 1.341238, loss_ss: 1.001598, loss_d: 0.339639
0.9224 --- loss: 2.038616, loss_ss: 1.163705, loss_d: 0.874911
0.9608 --- loss: 1.192434, loss_ss: 0.975389, loss_d: 0.217044
0.9992 --- loss: 1.134028, loss_ss: 1.069526, loss_d: 0.064501
Epoch finished! Loss: 1.2488526717974588
Starting epoch 4/10.
0.0000 --- loss: 1.111971, loss_ss: 0.819232, loss_d: 0.292739
0.0384 --- loss: 1.462047, loss_ss: 0.797596, loss_d: 0.664450
0.0769 --- loss: 1.070393, loss_ss: 0.865550, loss_d: 0.204844
0.1153 --- loss: 0.993286, loss_ss: 0.795606, loss_d: 0.197680
0.1537 --- loss: 1.355549, loss_ss: 0.887775, loss_d: 0.467774
0.1922 --- loss: 0.895251, loss_ss: 0.828256, loss_d: 0.066994
0.2306 --- loss: 1.908950, loss_ss: 1.120816, loss_d: 0.788134
0.2690 --- loss: 1.138223, loss_ss: 0.948185, loss_d: 0.190038
0.3075 --- loss: 1.397979, loss_ss: 0.955465, loss_d: 0.442514
0.3459 --- loss: 1.334394, loss_ss: 0.863982, loss_d: 0.470412
0.3843 --- loss: 1.491083, loss_ss: 1.473277, loss_d: 0.017806
0.4228 --- loss: 0.941588, loss_ss: 0.781212, loss_d: 0.160376
0.4612 --- loss: 1.162827, loss_ss: 1.016698, loss_d: 0.146129
0.4996 --- loss: 1.420238, loss_ss: 0.951085, loss_d: 0.469153
0.5380 --- loss: 1.185085, loss_ss: 1.040421, loss_d: 0.144664
0.5765 --- loss: 0.847232, loss_ss: 0.771741, loss_d: 0.075491
0.6149 --- loss: 1.119963, loss_ss: 0.953138, loss_d: 0.166824
0.6533 --- loss: 1.098668, loss_ss: 0.922526, loss_d: 0.176143
0.6918 --- loss: 1.710845, loss_ss: 0.869557, loss_d: 0.841288
0.7302 --- loss: 1.310846, loss_ss: 0.927797, loss_d: 0.383049
0.7686 --- loss: 0.820679, loss_ss: 0.754232, loss_d: 0.066446
0.8071 --- loss: 1.105126, loss_ss: 0.736331, loss_d: 0.368795
0.8455 --- loss: 1.278234, loss_ss: 0.725907, loss_d: 0.552327
0.8839 --- loss: 1.274330, loss_ss: 0.902659, loss_d: 0.371672
0.9224 --- loss: 1.120880, loss_ss: 0.870373, loss_d: 0.250507
0.9608 --- loss: 1.113202, loss_ss: 0.938348, loss_d: 0.174854
0.9992 --- loss: 2.483469, loss_ss: 1.284410, loss_d: 1.199059
Epoch finished! Loss: 1.161186915406814
Starting epoch 5/10.
0.0000 --- loss: 1.038298, loss_ss: 0.852032, loss_d: 0.186266
0.0384 --- loss: 1.375907, loss_ss: 1.290047, loss_d: 0.085859
0.0769 --- loss: 0.824685, loss_ss: 0.693328, loss_d: 0.131357
0.1153 --- loss: 0.771979, loss_ss: 0.712678, loss_d: 0.059301
0.1537 --- loss: 0.955966, loss_ss: 0.891270, loss_d: 0.064696
0.1922 --- loss: 1.267215, loss_ss: 0.779843, loss_d: 0.487372
0.2306 --- loss: 1.137508, loss_ss: 1.060382, loss_d: 0.077126
0.2690 --- loss: 1.033553, loss_ss: 0.995332, loss_d: 0.038221
0.3075 --- loss: 1.207086, loss_ss: 0.911796, loss_d: 0.295290
0.3459 --- loss: 1.079789, loss_ss: 0.992537, loss_d: 0.087252
0.3843 --- loss: 0.933585, loss_ss: 0.836309, loss_d: 0.097276
0.4228 --- loss: 1.156501, loss_ss: 0.974535, loss_d: 0.181967
0.4612 --- loss: 1.081582, loss_ss: 1.024214, loss_d: 0.057368
0.4996 --- loss: 1.314300, loss_ss: 0.840143, loss_d: 0.474157
0.5380 --- loss: 1.169824, loss_ss: 0.960286, loss_d: 0.209538
0.5765 --- loss: 1.011934, loss_ss: 0.795538, loss_d: 0.216396
0.6149 --- loss: 1.255057, loss_ss: 0.861583, loss_d: 0.393474
0.6533 --- loss: 1.367316, loss_ss: 0.965267, loss_d: 0.402049
0.6918 --- loss: 1.320545, loss_ss: 0.820089, loss_d: 0.500456
0.7302 --- loss: 1.154612, loss_ss: 0.858225, loss_d: 0.296387
0.7686 --- loss: 0.982008, loss_ss: 0.855671, loss_d: 0.126338
0.8071 --- loss: 1.014846, loss_ss: 0.934072, loss_d: 0.080774
0.8455 --- loss: 0.905661, loss_ss: 0.846794, loss_d: 0.058867
0.8839 --- loss: 1.631073, loss_ss: 1.139403, loss_d: 0.491670
0.9224 --- loss: 1.304052, loss_ss: 1.006874, loss_d: 0.297178
0.9608 --- loss: 1.486191, loss_ss: 1.290620, loss_d: 0.195571
0.9992 --- loss: 1.710462, loss_ss: 1.142466, loss_d: 0.567996
Epoch finished! Loss: 1.0892587384352317
Starting epoch 6/10.
0.0000 --- loss: 1.302608, loss_ss: 1.139288, loss_d: 0.163320
0.0384 --- loss: 0.977416, loss_ss: 0.807885, loss_d: 0.169531
0.0769 --- loss: 1.055503, loss_ss: 0.981827, loss_d: 0.073676
0.1153 --- loss: 0.866683, loss_ss: 0.736304, loss_d: 0.130379
0.1537 --- loss: 1.192570, loss_ss: 0.737506, loss_d: 0.455065
0.1922 --- loss: 0.818127, loss_ss: 0.759796, loss_d: 0.058332
0.2306 --- loss: 1.001012, loss_ss: 0.833338, loss_d: 0.167674
0.2690 --- loss: 0.933827, loss_ss: 0.788963, loss_d: 0.144864
0.3075 --- loss: 0.984495, loss_ss: 0.757211, loss_d: 0.227285
0.3459 --- loss: 0.820941, loss_ss: 0.776749, loss_d: 0.044192
0.3843 --- loss: 0.943764, loss_ss: 0.768386, loss_d: 0.175379
0.4228 --- loss: 1.100513, loss_ss: 0.972394, loss_d: 0.128119
0.4612 --- loss: 1.244269, loss_ss: 1.198254, loss_d: 0.046014
0.4996 --- loss: 0.927575, loss_ss: 0.868877, loss_d: 0.058698
0.5380 --- loss: 1.190745, loss_ss: 1.085979, loss_d: 0.104767
0.5765 --- loss: 1.375973, loss_ss: 1.061451, loss_d: 0.314523
0.6149 --- loss: 0.924059, loss_ss: 0.856017, loss_d: 0.068042
0.6533 --- loss: 0.948194, loss_ss: 0.864083, loss_d: 0.084110
0.6918 --- loss: 0.783692, loss_ss: 0.737460, loss_d: 0.046232
0.7302 --- loss: 0.966773, loss_ss: 0.891008, loss_d: 0.075765
0.7686 --- loss: 0.947246, loss_ss: 0.759445, loss_d: 0.187801
0.8071 --- loss: 0.905411, loss_ss: 0.837955, loss_d: 0.067456
0.8455 --- loss: 0.932598, loss_ss: 0.910203, loss_d: 0.022395
0.8839 --- loss: 0.815463, loss_ss: 0.794831, loss_d: 0.020632
0.9224 --- loss: 0.895507, loss_ss: 0.862196, loss_d: 0.033311
0.9608 --- loss: 1.767351, loss_ss: 1.277928, loss_d: 0.489423
0.9992 --- loss: 0.962119, loss_ss: 0.940968, loss_d: 0.021151
Epoch finished! Loss: 1.037066137102934
Starting epoch 7/10.
0.0000 --- loss: 0.874201, loss_ss: 0.844128, loss_d: 0.030072
0.0384 --- loss: 1.326437, loss_ss: 1.088083, loss_d: 0.238354
0.0769 --- loss: 1.169251, loss_ss: 0.952143, loss_d: 0.217108
0.1153 --- loss: 0.934316, loss_ss: 0.676682, loss_d: 0.257634
0.1537 --- loss: 1.078861, loss_ss: 1.028006, loss_d: 0.050855
0.1922 --- loss: 0.702113, loss_ss: 0.677372, loss_d: 0.024741
0.2306 --- loss: 0.747578, loss_ss: 0.689251, loss_d: 0.058327
0.2690 --- loss: 0.886949, loss_ss: 0.782189, loss_d: 0.104760
0.3075 --- loss: 1.694566, loss_ss: 0.919131, loss_d: 0.775435
0.3459 --- loss: 0.817512, loss_ss: 0.747677, loss_d: 0.069835
0.3843 --- loss: 0.960512, loss_ss: 0.866178, loss_d: 0.094334
0.4228 --- loss: 0.592031, loss_ss: 0.555923, loss_d: 0.036108
0.4612 --- loss: 0.684832, loss_ss: 0.623606, loss_d: 0.061226
0.4996 --- loss: 0.931340, loss_ss: 0.654091, loss_d: 0.277249
0.5380 --- loss: 0.998157, loss_ss: 0.785740, loss_d: 0.212417
0.5765 --- loss: 0.712989, loss_ss: 0.592591, loss_d: 0.120398
0.6149 --- loss: 0.739316, loss_ss: 0.694705, loss_d: 0.044612
0.6533 --- loss: 0.661628, loss_ss: 0.595808, loss_d: 0.065819
0.6918 --- loss: 0.799462, loss_ss: 0.783310, loss_d: 0.016152
0.7302 --- loss: 0.654638, loss_ss: 0.645322, loss_d: 0.009315
0.7686 --- loss: 0.821419, loss_ss: 0.808024, loss_d: 0.013394
0.8071 --- loss: 0.870398, loss_ss: 0.838560, loss_d: 0.031838
0.8455 --- loss: 1.119524, loss_ss: 0.878540, loss_d: 0.240984
0.8839 --- loss: 0.985615, loss_ss: 0.934853, loss_d: 0.050762
0.9224 --- loss: 1.064974, loss_ss: 0.742195, loss_d: 0.322779
0.9608 --- loss: 1.367276, loss_ss: 0.862354, loss_d: 0.504922
0.9992 --- loss: 0.852551, loss_ss: 0.744563, loss_d: 0.107988
Epoch finished! Loss: 0.9614818756396953
Starting epoch 8/10.
0.0000 --- loss: 0.834195, loss_ss: 0.811150, loss_d: 0.023045
0.0384 --- loss: 0.561511, loss_ss: 0.550124, loss_d: 0.011388
0.0769 --- loss: 1.145414, loss_ss: 0.715268, loss_d: 0.430146
0.1153 --- loss: 0.933882, loss_ss: 0.900783, loss_d: 0.033099
0.1537 --- loss: 1.171947, loss_ss: 0.922842, loss_d: 0.249105
0.1922 --- loss: 1.096608, loss_ss: 0.665735, loss_d: 0.430873
0.2306 --- loss: 0.726113, loss_ss: 0.665462, loss_d: 0.060650
0.2690 --- loss: 0.995161, loss_ss: 0.855139, loss_d: 0.140022
0.3075 --- loss: 0.851211, loss_ss: 0.772372, loss_d: 0.078840
0.3459 --- loss: 0.902281, loss_ss: 0.853569, loss_d: 0.048712
0.3843 --- loss: 0.814823, loss_ss: 0.747096, loss_d: 0.067726
0.4228 --- loss: 1.044878, loss_ss: 1.029513, loss_d: 0.015365
0.4612 --- loss: 1.177961, loss_ss: 0.664499, loss_d: 0.513462
0.4996 --- loss: 0.777138, loss_ss: 0.771468, loss_d: 0.005669
0.5380 --- loss: 0.970022, loss_ss: 0.963995, loss_d: 0.006027
0.5765 --- loss: 0.642331, loss_ss: 0.601116, loss_d: 0.041216
0.6149 --- loss: 0.774960, loss_ss: 0.763826, loss_d: 0.011134
0.6533 --- loss: 0.964053, loss_ss: 0.957228, loss_d: 0.006825
0.6918 --- loss: 1.089444, loss_ss: 0.896867, loss_d: 0.192577
0.7302 --- loss: 0.930274, loss_ss: 0.734181, loss_d: 0.196093
0.7686 --- loss: 0.758259, loss_ss: 0.709774, loss_d: 0.048485
0.8071 --- loss: 1.067848, loss_ss: 1.000300, loss_d: 0.067548
0.8455 --- loss: 0.708121, loss_ss: 0.689455, loss_d: 0.018667
0.8839 --- loss: 0.633895, loss_ss: 0.618536, loss_d: 0.015359
0.9224 --- loss: 1.032349, loss_ss: 1.022202, loss_d: 0.010147
0.9608 --- loss: 0.651694, loss_ss: 0.640611, loss_d: 0.011083
0.9992 --- loss: 2.425099, loss_ss: 1.158172, loss_d: 1.266927
Epoch finished! Loss: 0.9086213384683316
Starting epoch 9/10.
0.0000 --- loss: 0.846899, loss_ss: 0.566520, loss_d: 0.280380
0.0384 --- loss: 0.835487, loss_ss: 0.706539, loss_d: 0.128948
0.0769 --- loss: 0.756911, loss_ss: 0.735455, loss_d: 0.021456
0.1153 --- loss: 0.973561, loss_ss: 0.947946, loss_d: 0.025615
0.1537 --- loss: 0.634402, loss_ss: 0.601229, loss_d: 0.033173
0.1922 --- loss: 1.454056, loss_ss: 1.327032, loss_d: 0.127024
0.2306 --- loss: 1.024217, loss_ss: 0.807257, loss_d: 0.216960
0.2690 --- loss: 0.673462, loss_ss: 0.647596, loss_d: 0.025866
0.3075 --- loss: 0.967158, loss_ss: 0.807665, loss_d: 0.159494
0.3459 --- loss: 0.984252, loss_ss: 0.791767, loss_d: 0.192485
0.3843 --- loss: 1.085654, loss_ss: 1.037630, loss_d: 0.048024
0.4228 --- loss: 1.014637, loss_ss: 0.848021, loss_d: 0.166616
0.4612 --- loss: 1.014488, loss_ss: 0.600279, loss_d: 0.414209
0.4996 --- loss: 0.850777, loss_ss: 0.780188, loss_d: 0.070590
0.5380 --- loss: 0.842571, loss_ss: 0.712806, loss_d: 0.129765
0.5765 --- loss: 0.703614, loss_ss: 0.687947, loss_d: 0.015667
0.6149 --- loss: 0.858060, loss_ss: 0.834389, loss_d: 0.023672
0.6533 --- loss: 1.128785, loss_ss: 0.579745, loss_d: 0.549040
0.6918 --- loss: 0.942892, loss_ss: 0.923161, loss_d: 0.019731
0.7302 --- loss: 0.802682, loss_ss: 0.777807, loss_d: 0.024875
0.7686 --- loss: 1.251809, loss_ss: 0.870937, loss_d: 0.380872
0.8071 --- loss: 0.816727, loss_ss: 0.737815, loss_d: 0.078912
0.8455 --- loss: 0.765491, loss_ss: 0.757941, loss_d: 0.007550
0.8839 --- loss: 0.953499, loss_ss: 0.938007, loss_d: 0.015491
0.9224 --- loss: 0.644162, loss_ss: 0.621253, loss_d: 0.022909
0.9608 --- loss: 0.993783, loss_ss: 0.943668, loss_d: 0.050115
0.9992 --- loss: 0.903145, loss_ss: 0.872852, loss_d: 0.030293
Epoch finished! Loss: 0.9320999378195176
Starting epoch 10/10.
0.0000 --- loss: 0.577037, loss_ss: 0.550948, loss_d: 0.026088
0.0384 --- loss: 0.824537, loss_ss: 0.805212, loss_d: 0.019325
0.0769 --- loss: 0.623771, loss_ss: 0.564611, loss_d: 0.059160
0.1153 --- loss: 1.347692, loss_ss: 1.333994, loss_d: 0.013698
0.1537 --- loss: 0.863115, loss_ss: 0.860421, loss_d: 0.002693
0.1922 --- loss: 1.002089, loss_ss: 0.981066, loss_d: 0.021023
0.2306 --- loss: 0.760508, loss_ss: 0.753728, loss_d: 0.006780
0.2690 --- loss: 0.737687, loss_ss: 0.683808, loss_d: 0.053879
0.3075 --- loss: 1.046417, loss_ss: 1.017568, loss_d: 0.028850
0.3459 --- loss: 0.828318, loss_ss: 0.800330, loss_d: 0.027987
0.3843 --- loss: 0.636881, loss_ss: 0.612154, loss_d: 0.024727
0.4228 --- loss: 0.578451, loss_ss: 0.523162, loss_d: 0.055289
0.4612 --- loss: 0.735889, loss_ss: 0.617253, loss_d: 0.118636
0.4996 --- loss: 0.831298, loss_ss: 0.687113, loss_d: 0.144185
0.5380 --- loss: 0.837820, loss_ss: 0.814945, loss_d: 0.022875
0.5765 --- loss: 0.590137, loss_ss: 0.532646, loss_d: 0.057491
0.6149 --- loss: 0.773456, loss_ss: 0.761017, loss_d: 0.012439
0.6533 --- loss: 0.607253, loss_ss: 0.566746, loss_d: 0.040507
0.6918 --- loss: 0.747846, loss_ss: 0.736520, loss_d: 0.011326
0.7302 --- loss: 1.194999, loss_ss: 1.185478, loss_d: 0.009521
0.7686 --- loss: 0.540738, loss_ss: 0.529257, loss_d: 0.011481
0.8071 --- loss: 0.749664, loss_ss: 0.700194, loss_d: 0.049470
0.8455 --- loss: 0.821038, loss_ss: 0.794881, loss_d: 0.026157
0.8839 --- loss: 0.786260, loss_ss: 0.772156, loss_d: 0.014104
0.9224 --- loss: 0.942470, loss_ss: 0.932020, loss_d: 0.010449
0.9608 --- loss: 1.194715, loss_ss: 1.029242, loss_d: 0.165472
0.9992 --- loss: 6.605335, loss_ss: 0.381710, loss_d: 6.223625
Epoch finished! Loss: 0.8810519971526586
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7592592592592593
             precision    recall  f1-score   support

        0.0       0.85      0.51      0.63       260
        1.0       0.62      0.65      0.63       248
        2.0       0.94      0.95      0.94       375
        3.0       1.00      0.92      0.96       169
        4.0       0.13      0.61      0.21        28

avg / total       0.83      0.76      0.78      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.93  50.77   97.07   84.62     63.46
1  82.96  64.52   88.46   62.50     63.49
2  96.02  94.93   96.60   93.68     94.30
3  98.70  91.72  100.00  100.00     95.68
4  88.24  60.71   88.97   12.78     21.12
Total accuracy: 75.93%
Average sen: 72.53%
Average spec: 94.22%
Macro f1-score: 67.61%
Diagnosis acc on 15mins: 1.0
[0.99990499 0.99998689 0.99783534 0.99512321 0.97967738 0.99994171
 0.99999201 0.99998975 0.99999082 0.99998748 0.99998939 0.99995077
 0.99977463 0.99998605 0.99983704 0.99999952 1.         0.99982423
 0.99988627 0.9999702  0.99999881 0.99999833 1.         0.99999988
 0.99999416 0.99999452 0.99999797 0.99999368 0.99999976 0.99999964
 0.9999975  0.99995613 0.99964118 0.99990427 0.99998748 0.99999106]
pred: 0.9991972794135412, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.447636, loss_ss: 1.786494, loss_d: 0.661142
0.0384 --- loss: 2.387296, loss_ss: 1.666900, loss_d: 0.720396
0.0768 --- loss: 2.695414, loss_ss: 1.719875, loss_d: 0.975539
0.1152 --- loss: 2.009417, loss_ss: 1.617950, loss_d: 0.391466
0.1536 --- loss: 2.225252, loss_ss: 1.555216, loss_d: 0.670036
0.1919 --- loss: 1.761262, loss_ss: 1.472098, loss_d: 0.289164
0.2303 --- loss: 1.720623, loss_ss: 1.380060, loss_d: 0.340563
0.2687 --- loss: 2.067695, loss_ss: 1.506748, loss_d: 0.560947
0.3071 --- loss: 2.110013, loss_ss: 1.493481, loss_d: 0.616532
0.3455 --- loss: 1.946429, loss_ss: 1.364704, loss_d: 0.581725
0.3839 --- loss: 2.034729, loss_ss: 1.421256, loss_d: 0.613473
0.4223 --- loss: 1.823892, loss_ss: 1.326399, loss_d: 0.497493
0.4607 --- loss: 2.160175, loss_ss: 1.463391, loss_d: 0.696784
0.4990 --- loss: 1.734534, loss_ss: 1.199401, loss_d: 0.535133
0.5374 --- loss: 1.598577, loss_ss: 1.227110, loss_d: 0.371467
0.5758 --- loss: 1.533319, loss_ss: 1.194897, loss_d: 0.338422
0.6142 --- loss: 2.238799, loss_ss: 1.530777, loss_d: 0.708022
0.6526 --- loss: 2.133775, loss_ss: 1.280332, loss_d: 0.853443
0.6910 --- loss: 1.568408, loss_ss: 1.272811, loss_d: 0.295596
0.7294 --- loss: 1.442511, loss_ss: 1.213841, loss_d: 0.228670
0.7678 --- loss: 1.391502, loss_ss: 1.151294, loss_d: 0.240207
0.8061 --- loss: 1.655443, loss_ss: 1.280747, loss_d: 0.374696
0.8445 --- loss: 1.223487, loss_ss: 1.106817, loss_d: 0.116670
0.8829 --- loss: 1.395736, loss_ss: 1.249591, loss_d: 0.146146
0.9213 --- loss: 2.237320, loss_ss: 1.086161, loss_d: 1.151159
0.9597 --- loss: 1.593226, loss_ss: 1.093991, loss_d: 0.499235
0.9981 --- loss: 1.217973, loss_ss: 0.992705, loss_d: 0.225267
Epoch finished! Loss: 1.893011162372736
Starting epoch 2/10.
0.0000 --- loss: 1.197966, loss_ss: 1.012040, loss_d: 0.185926
0.0384 --- loss: 1.283880, loss_ss: 1.124628, loss_d: 0.159252
0.0768 --- loss: 1.616015, loss_ss: 1.256038, loss_d: 0.359976
0.1152 --- loss: 1.640810, loss_ss: 1.174608, loss_d: 0.466201
0.1536 --- loss: 1.542140, loss_ss: 1.333786, loss_d: 0.208355
0.1919 --- loss: 1.439444, loss_ss: 1.098282, loss_d: 0.341162
0.2303 --- loss: 1.461837, loss_ss: 1.121239, loss_d: 0.340598
0.2687 --- loss: 1.493844, loss_ss: 1.124686, loss_d: 0.369158
0.3071 --- loss: 1.452401, loss_ss: 0.962975, loss_d: 0.489426
0.3455 --- loss: 1.486007, loss_ss: 1.122633, loss_d: 0.363375
0.3839 --- loss: 1.683715, loss_ss: 1.290845, loss_d: 0.392869
0.4223 --- loss: 1.656821, loss_ss: 1.029374, loss_d: 0.627447
0.4607 --- loss: 1.539222, loss_ss: 1.097263, loss_d: 0.441958
0.4990 --- loss: 1.313075, loss_ss: 1.136820, loss_d: 0.176255
0.5374 --- loss: 1.818272, loss_ss: 1.369370, loss_d: 0.448903
0.5758 --- loss: 1.374665, loss_ss: 1.227741, loss_d: 0.146924
0.6142 --- loss: 1.443481, loss_ss: 0.996387, loss_d: 0.447094
0.6526 --- loss: 1.494591, loss_ss: 1.315418, loss_d: 0.179173
0.6910 --- loss: 1.189772, loss_ss: 1.103257, loss_d: 0.086514
0.7294 --- loss: 1.136059, loss_ss: 1.003552, loss_d: 0.132508
0.7678 --- loss: 1.345240, loss_ss: 1.065414, loss_d: 0.279826
0.8061 --- loss: 1.165900, loss_ss: 0.868510, loss_d: 0.297390
0.8445 --- loss: 1.257398, loss_ss: 1.172626, loss_d: 0.084771
0.8829 --- loss: 1.629007, loss_ss: 1.048156, loss_d: 0.580850
0.9213 --- loss: 1.291047, loss_ss: 0.939559, loss_d: 0.351488
0.9597 --- loss: 1.028647, loss_ss: 0.901629, loss_d: 0.127017
0.9981 --- loss: 1.566293, loss_ss: 1.412787, loss_d: 0.153506
Epoch finished! Loss: 1.3910997796517153
Starting epoch 3/10.
0.0000 --- loss: 1.324271, loss_ss: 1.061646, loss_d: 0.262626
0.0384 --- loss: 1.182787, loss_ss: 0.970490, loss_d: 0.212298
0.0768 --- loss: 1.314944, loss_ss: 0.989682, loss_d: 0.325262
0.1152 --- loss: 1.814205, loss_ss: 1.047953, loss_d: 0.766252
0.1536 --- loss: 1.311659, loss_ss: 0.999712, loss_d: 0.311947
0.1919 --- loss: 1.183272, loss_ss: 0.987987, loss_d: 0.195285
0.2303 --- loss: 1.099486, loss_ss: 0.874275, loss_d: 0.225212
0.2687 --- loss: 1.092703, loss_ss: 0.793739, loss_d: 0.298964
0.3071 --- loss: 1.122761, loss_ss: 0.851814, loss_d: 0.270947
0.3455 --- loss: 1.014279, loss_ss: 0.900826, loss_d: 0.113453
0.3839 --- loss: 0.881435, loss_ss: 0.746842, loss_d: 0.134594
0.4223 --- loss: 0.875525, loss_ss: 0.766029, loss_d: 0.109496
0.4607 --- loss: 1.242636, loss_ss: 0.855670, loss_d: 0.386966
0.4990 --- loss: 0.938726, loss_ss: 0.742744, loss_d: 0.195982
0.5374 --- loss: 0.936787, loss_ss: 0.812513, loss_d: 0.124274
0.5758 --- loss: 1.152142, loss_ss: 0.914119, loss_d: 0.238023
0.6142 --- loss: 1.114149, loss_ss: 0.926284, loss_d: 0.187865
0.6526 --- loss: 1.180877, loss_ss: 1.083538, loss_d: 0.097339
0.6910 --- loss: 1.487992, loss_ss: 1.269734, loss_d: 0.218258
0.7294 --- loss: 1.416603, loss_ss: 0.829823, loss_d: 0.586780
0.7678 --- loss: 0.909019, loss_ss: 0.794970, loss_d: 0.114048
0.8061 --- loss: 0.999052, loss_ss: 0.867487, loss_d: 0.131565
0.8445 --- loss: 1.711146, loss_ss: 0.986116, loss_d: 0.725029
0.8829 --- loss: 0.995234, loss_ss: 0.853337, loss_d: 0.141897
0.9213 --- loss: 1.291279, loss_ss: 0.981149, loss_d: 0.310130
0.9597 --- loss: 0.988580, loss_ss: 0.793428, loss_d: 0.195153
0.9981 --- loss: 0.949665, loss_ss: 0.886657, loss_d: 0.063008
Epoch finished! Loss: 1.1757801480018175
Starting epoch 4/10.
0.0000 --- loss: 0.938503, loss_ss: 0.879536, loss_d: 0.058967
0.0384 --- loss: 0.915298, loss_ss: 0.856029, loss_d: 0.059269
0.0768 --- loss: 1.641158, loss_ss: 0.943130, loss_d: 0.698028
0.1152 --- loss: 1.189710, loss_ss: 0.989181, loss_d: 0.200528
0.1536 --- loss: 1.017215, loss_ss: 0.972016, loss_d: 0.045199
0.1919 --- loss: 1.084549, loss_ss: 0.953990, loss_d: 0.130558
0.2303 --- loss: 0.981102, loss_ss: 0.806217, loss_d: 0.174885
0.2687 --- loss: 0.802325, loss_ss: 0.687360, loss_d: 0.114965
0.3071 --- loss: 1.549722, loss_ss: 1.148558, loss_d: 0.401164
0.3455 --- loss: 0.947701, loss_ss: 0.903501, loss_d: 0.044200
0.3839 --- loss: 0.947576, loss_ss: 0.836226, loss_d: 0.111350
0.4223 --- loss: 0.843126, loss_ss: 0.799941, loss_d: 0.043184
0.4607 --- loss: 0.982292, loss_ss: 0.860654, loss_d: 0.121638
0.4990 --- loss: 1.067557, loss_ss: 1.006881, loss_d: 0.060676
0.5374 --- loss: 1.477955, loss_ss: 1.081715, loss_d: 0.396241
0.5758 --- loss: 1.262444, loss_ss: 0.958243, loss_d: 0.304202
0.6142 --- loss: 1.010964, loss_ss: 0.895295, loss_d: 0.115669
0.6526 --- loss: 0.771190, loss_ss: 0.677774, loss_d: 0.093417
0.6910 --- loss: 1.322886, loss_ss: 0.949678, loss_d: 0.373208
0.7294 --- loss: 1.024782, loss_ss: 0.955452, loss_d: 0.069330
0.7678 --- loss: 0.871740, loss_ss: 0.791752, loss_d: 0.079988
0.8061 --- loss: 1.181108, loss_ss: 1.043793, loss_d: 0.137315
0.8445 --- loss: 1.628080, loss_ss: 0.863205, loss_d: 0.764874
0.8829 --- loss: 0.963726, loss_ss: 0.835919, loss_d: 0.127808
0.9213 --- loss: 0.744305, loss_ss: 0.649796, loss_d: 0.094509
0.9597 --- loss: 1.166777, loss_ss: 0.963786, loss_d: 0.202991
0.9981 --- loss: 1.251782, loss_ss: 1.073235, loss_d: 0.178547
Epoch finished! Loss: 1.0891696425584647
Starting epoch 5/10.
0.0000 --- loss: 0.876100, loss_ss: 0.695273, loss_d: 0.180828
0.0384 --- loss: 0.797800, loss_ss: 0.716021, loss_d: 0.081780
0.0768 --- loss: 0.887731, loss_ss: 0.836485, loss_d: 0.051247
0.1152 --- loss: 1.054486, loss_ss: 0.882388, loss_d: 0.172097
0.1536 --- loss: 1.144000, loss_ss: 1.040320, loss_d: 0.103680
0.1919 --- loss: 0.779895, loss_ss: 0.696454, loss_d: 0.083441
0.2303 --- loss: 0.749882, loss_ss: 0.682093, loss_d: 0.067790
0.2687 --- loss: 1.089575, loss_ss: 0.778165, loss_d: 0.311410
0.3071 --- loss: 1.008215, loss_ss: 0.889436, loss_d: 0.118780
0.3455 --- loss: 0.809647, loss_ss: 0.770414, loss_d: 0.039233
0.3839 --- loss: 0.773919, loss_ss: 0.699243, loss_d: 0.074676
0.4223 --- loss: 1.242939, loss_ss: 0.813974, loss_d: 0.428964
0.4607 --- loss: 0.716309, loss_ss: 0.684538, loss_d: 0.031771
0.4990 --- loss: 1.103865, loss_ss: 0.999212, loss_d: 0.104653
0.5374 --- loss: 0.725605, loss_ss: 0.700783, loss_d: 0.024822
0.5758 --- loss: 0.931038, loss_ss: 0.893548, loss_d: 0.037490
0.6142 --- loss: 1.485749, loss_ss: 1.102357, loss_d: 0.383393
0.6526 --- loss: 1.625630, loss_ss: 0.776165, loss_d: 0.849465
0.6910 --- loss: 1.030438, loss_ss: 0.832480, loss_d: 0.197958
0.7294 --- loss: 0.838302, loss_ss: 0.755230, loss_d: 0.083072
0.7678 --- loss: 0.717166, loss_ss: 0.647354, loss_d: 0.069812
0.8061 --- loss: 1.041155, loss_ss: 0.713328, loss_d: 0.327827
0.8445 --- loss: 0.813273, loss_ss: 0.732384, loss_d: 0.080889
0.8829 --- loss: 0.894337, loss_ss: 0.816171, loss_d: 0.078166
0.9213 --- loss: 0.979376, loss_ss: 0.877602, loss_d: 0.101774
0.9597 --- loss: 0.871628, loss_ss: 0.837103, loss_d: 0.034525
0.9981 --- loss: 1.922885, loss_ss: 1.092381, loss_d: 0.830503
Epoch finished! Loss: 0.9983715994999959
Starting epoch 6/10.
0.0000 --- loss: 1.779598, loss_ss: 1.204322, loss_d: 0.575275
0.0384 --- loss: 1.011029, loss_ss: 0.877696, loss_d: 0.133333
0.0768 --- loss: 0.679415, loss_ss: 0.632667, loss_d: 0.046748
0.1152 --- loss: 0.906827, loss_ss: 0.890100, loss_d: 0.016727
0.1536 --- loss: 0.918128, loss_ss: 0.815580, loss_d: 0.102547
0.1919 --- loss: 1.353406, loss_ss: 0.979238, loss_d: 0.374169
0.2303 --- loss: 1.031664, loss_ss: 0.800527, loss_d: 0.231136
0.2687 --- loss: 0.923049, loss_ss: 0.751408, loss_d: 0.171641
0.3071 --- loss: 0.817117, loss_ss: 0.758933, loss_d: 0.058184
0.3455 --- loss: 1.042185, loss_ss: 1.033121, loss_d: 0.009064
0.3839 --- loss: 1.000293, loss_ss: 0.977183, loss_d: 0.023110
0.4223 --- loss: 0.882693, loss_ss: 0.773619, loss_d: 0.109074
0.4607 --- loss: 0.803841, loss_ss: 0.775626, loss_d: 0.028215
0.4990 --- loss: 1.073771, loss_ss: 0.933352, loss_d: 0.140420
0.5374 --- loss: 0.905641, loss_ss: 0.634849, loss_d: 0.270793
0.5758 --- loss: 0.896641, loss_ss: 0.867972, loss_d: 0.028668
0.6142 --- loss: 0.968546, loss_ss: 0.867054, loss_d: 0.101492
0.6526 --- loss: 0.692936, loss_ss: 0.605078, loss_d: 0.087859
0.6910 --- loss: 2.081792, loss_ss: 0.958279, loss_d: 1.123513
0.7294 --- loss: 1.124912, loss_ss: 0.860553, loss_d: 0.264359
0.7678 --- loss: 0.879395, loss_ss: 0.794013, loss_d: 0.085383
0.8061 --- loss: 1.475419, loss_ss: 0.833928, loss_d: 0.641492
0.8445 --- loss: 0.844637, loss_ss: 0.810443, loss_d: 0.034194
0.8829 --- loss: 0.991491, loss_ss: 0.956940, loss_d: 0.034551
0.9213 --- loss: 0.831881, loss_ss: 0.787870, loss_d: 0.044011
0.9597 --- loss: 0.922249, loss_ss: 0.888989, loss_d: 0.033260
0.9981 --- loss: 1.145257, loss_ss: 0.498322, loss_d: 0.646934
Epoch finished! Loss: 1.0120601830574183
Starting epoch 7/10.
0.0000 --- loss: 1.101469, loss_ss: 0.870751, loss_d: 0.230718
0.0384 --- loss: 0.812182, loss_ss: 0.735055, loss_d: 0.077127
0.0768 --- loss: 1.012927, loss_ss: 0.973329, loss_d: 0.039598
0.1152 --- loss: 0.615523, loss_ss: 0.590904, loss_d: 0.024619
0.1536 --- loss: 1.341439, loss_ss: 1.289351, loss_d: 0.052088
0.1919 --- loss: 0.854411, loss_ss: 0.830936, loss_d: 0.023475
0.2303 --- loss: 0.864446, loss_ss: 0.807542, loss_d: 0.056904
0.2687 --- loss: 1.051852, loss_ss: 1.000034, loss_d: 0.051818
0.3071 --- loss: 0.669360, loss_ss: 0.650874, loss_d: 0.018485
0.3455 --- loss: 0.765157, loss_ss: 0.759266, loss_d: 0.005891
0.3839 --- loss: 0.819186, loss_ss: 0.706907, loss_d: 0.112279
0.4223 --- loss: 0.891515, loss_ss: 0.879218, loss_d: 0.012297
0.4607 --- loss: 1.220258, loss_ss: 0.968557, loss_d: 0.251701
0.4990 --- loss: 1.245402, loss_ss: 0.865169, loss_d: 0.380233
0.5374 --- loss: 1.046402, loss_ss: 0.900952, loss_d: 0.145450
0.5758 --- loss: 1.209883, loss_ss: 1.087139, loss_d: 0.122744
0.6142 --- loss: 0.698123, loss_ss: 0.675261, loss_d: 0.022862
0.6526 --- loss: 0.866372, loss_ss: 0.846788, loss_d: 0.019584
0.6910 --- loss: 0.778242, loss_ss: 0.752797, loss_d: 0.025445
0.7294 --- loss: 0.736379, loss_ss: 0.699651, loss_d: 0.036728
0.7678 --- loss: 0.551597, loss_ss: 0.537635, loss_d: 0.013963
0.8061 --- loss: 1.422296, loss_ss: 1.399384, loss_d: 0.022912
0.8445 --- loss: 1.263843, loss_ss: 0.846540, loss_d: 0.417303
0.8829 --- loss: 0.897615, loss_ss: 0.878580, loss_d: 0.019035
0.9213 --- loss: 1.202119, loss_ss: 0.887955, loss_d: 0.314164
0.9597 --- loss: 0.751300, loss_ss: 0.745910, loss_d: 0.005390
0.9981 --- loss: 1.238066, loss_ss: 1.086461, loss_d: 0.151605
Epoch finished! Loss: 0.911529136964908
Starting epoch 8/10.
0.0000 --- loss: 0.919921, loss_ss: 0.874551, loss_d: 0.045370
0.0384 --- loss: 0.873375, loss_ss: 0.847012, loss_d: 0.026363
0.0768 --- loss: 0.825482, loss_ss: 0.789590, loss_d: 0.035893
0.1152 --- loss: 0.981746, loss_ss: 0.921650, loss_d: 0.060096
0.1536 --- loss: 0.813671, loss_ss: 0.802071, loss_d: 0.011600
0.1919 --- loss: 0.740767, loss_ss: 0.720630, loss_d: 0.020137
0.2303 --- loss: 1.256315, loss_ss: 0.858910, loss_d: 0.397406
0.2687 --- loss: 0.963013, loss_ss: 0.902742, loss_d: 0.060271
0.3071 --- loss: 0.640716, loss_ss: 0.604001, loss_d: 0.036715
0.3455 --- loss: 1.020243, loss_ss: 0.943823, loss_d: 0.076421
0.3839 --- loss: 0.721541, loss_ss: 0.659237, loss_d: 0.062304
0.4223 --- loss: 0.781046, loss_ss: 0.731873, loss_d: 0.049173
0.4607 --- loss: 0.906480, loss_ss: 0.890062, loss_d: 0.016418
0.4990 --- loss: 0.614622, loss_ss: 0.469294, loss_d: 0.145327
0.5374 --- loss: 0.784774, loss_ss: 0.767667, loss_d: 0.017108
0.5758 --- loss: 1.105182, loss_ss: 1.071819, loss_d: 0.033362
0.6142 --- loss: 0.631415, loss_ss: 0.621786, loss_d: 0.009630
0.6526 --- loss: 1.074518, loss_ss: 0.734548, loss_d: 0.339969
0.6910 --- loss: 1.260440, loss_ss: 1.126530, loss_d: 0.133910
0.7294 --- loss: 0.689973, loss_ss: 0.679937, loss_d: 0.010036
0.7678 --- loss: 1.195344, loss_ss: 0.781000, loss_d: 0.414344
0.8061 --- loss: 1.386063, loss_ss: 1.227226, loss_d: 0.158837
0.8445 --- loss: 0.738497, loss_ss: 0.732239, loss_d: 0.006258
0.8829 --- loss: 0.868130, loss_ss: 0.670247, loss_d: 0.197883
0.9213 --- loss: 0.742990, loss_ss: 0.715330, loss_d: 0.027660
0.9597 --- loss: 0.906306, loss_ss: 0.857603, loss_d: 0.048703
0.9981 --- loss: 0.801691, loss_ss: 0.787756, loss_d: 0.013935
Epoch finished! Loss: 0.8916825633782607
Starting epoch 9/10.
0.0000 --- loss: 0.747426, loss_ss: 0.741380, loss_d: 0.006046
0.0384 --- loss: 0.903915, loss_ss: 0.716489, loss_d: 0.187426
0.0768 --- loss: 0.884320, loss_ss: 0.778017, loss_d: 0.106304
0.1152 --- loss: 0.821752, loss_ss: 0.815112, loss_d: 0.006640
0.1536 --- loss: 0.959070, loss_ss: 0.893100, loss_d: 0.065970
0.1919 --- loss: 0.801162, loss_ss: 0.788099, loss_d: 0.013064
0.2303 --- loss: 0.735687, loss_ss: 0.657740, loss_d: 0.077947
0.2687 --- loss: 0.946160, loss_ss: 0.916224, loss_d: 0.029936
0.3071 --- loss: 0.558951, loss_ss: 0.528277, loss_d: 0.030674
0.3455 --- loss: 1.158448, loss_ss: 0.727823, loss_d: 0.430625
0.3839 --- loss: 0.669587, loss_ss: 0.616591, loss_d: 0.052996
0.4223 --- loss: 0.636121, loss_ss: 0.585245, loss_d: 0.050876
0.4607 --- loss: 1.142017, loss_ss: 1.113980, loss_d: 0.028037
0.4990 --- loss: 0.849878, loss_ss: 0.802297, loss_d: 0.047582
0.5374 --- loss: 1.042699, loss_ss: 1.036220, loss_d: 0.006479
0.5758 --- loss: 0.726398, loss_ss: 0.722718, loss_d: 0.003680
0.6142 --- loss: 0.954002, loss_ss: 0.946013, loss_d: 0.007989
0.6526 --- loss: 0.947281, loss_ss: 0.892959, loss_d: 0.054322
0.6910 --- loss: 0.865901, loss_ss: 0.857867, loss_d: 0.008034
0.7294 --- loss: 1.011576, loss_ss: 0.859099, loss_d: 0.152477
0.7678 --- loss: 0.737772, loss_ss: 0.669141, loss_d: 0.068631
0.8061 --- loss: 0.947030, loss_ss: 0.813053, loss_d: 0.133976
0.8445 --- loss: 0.704180, loss_ss: 0.688212, loss_d: 0.015968
0.8829 --- loss: 0.646801, loss_ss: 0.637672, loss_d: 0.009129
0.9213 --- loss: 0.707454, loss_ss: 0.699421, loss_d: 0.008033
0.9597 --- loss: 0.774791, loss_ss: 0.739743, loss_d: 0.035048
0.9981 --- loss: 0.792470, loss_ss: 0.781393, loss_d: 0.011077
Epoch finished! Loss: 0.8656958013772964
Starting epoch 10/10.
0.0000 --- loss: 0.735361, loss_ss: 0.728962, loss_d: 0.006399
0.0384 --- loss: 0.741086, loss_ss: 0.737955, loss_d: 0.003130
0.0768 --- loss: 0.728698, loss_ss: 0.712444, loss_d: 0.016254
0.1152 --- loss: 0.695016, loss_ss: 0.586167, loss_d: 0.108849
0.1536 --- loss: 0.978806, loss_ss: 0.945122, loss_d: 0.033684
0.1919 --- loss: 1.283222, loss_ss: 1.064951, loss_d: 0.218271
0.2303 --- loss: 0.732299, loss_ss: 0.626570, loss_d: 0.105729
0.2687 --- loss: 0.702594, loss_ss: 0.674247, loss_d: 0.028347
0.3071 --- loss: 0.957774, loss_ss: 0.936415, loss_d: 0.021360
0.3455 --- loss: 0.776671, loss_ss: 0.771156, loss_d: 0.005515
0.3839 --- loss: 0.723635, loss_ss: 0.676722, loss_d: 0.046914
0.4223 --- loss: 1.077733, loss_ss: 0.976320, loss_d: 0.101413
0.4607 --- loss: 0.844494, loss_ss: 0.599258, loss_d: 0.245236
0.4990 --- loss: 0.879881, loss_ss: 0.878083, loss_d: 0.001798
0.5374 --- loss: 0.794788, loss_ss: 0.670419, loss_d: 0.124369
0.5758 --- loss: 0.909257, loss_ss: 0.874550, loss_d: 0.034707
0.6142 --- loss: 0.677541, loss_ss: 0.640767, loss_d: 0.036775
0.6526 --- loss: 0.744360, loss_ss: 0.636048, loss_d: 0.108312
0.6910 --- loss: 0.983538, loss_ss: 0.785494, loss_d: 0.198044
0.7294 --- loss: 0.847600, loss_ss: 0.837266, loss_d: 0.010333
0.7678 --- loss: 0.860928, loss_ss: 0.788079, loss_d: 0.072848
0.8061 --- loss: 0.878732, loss_ss: 0.837249, loss_d: 0.041483
0.8445 --- loss: 0.996003, loss_ss: 0.918539, loss_d: 0.077464
0.8829 --- loss: 0.870431, loss_ss: 0.750131, loss_d: 0.120300
0.9213 --- loss: 0.829942, loss_ss: 0.638440, loss_d: 0.191501
0.9597 --- loss: 0.683287, loss_ss: 0.675915, loss_d: 0.007372
0.9981 --- loss: 1.172706, loss_ss: 1.158890, loss_d: 0.013815
Epoch finished! Loss: 0.8425679587400876
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5505050505050505
             precision    recall  f1-score   support

        0.0       0.33      0.26      0.29        80
        1.0       0.09      0.89      0.17        38
        2.0       0.85      0.66      0.74       478
        3.0       0.98      0.73      0.84       196
        4.0       0.68      0.16      0.26       198

avg / total       0.77      0.55      0.61       990
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.70  26.25   95.27  32.81     29.17
1  66.46  89.47   65.55   9.39     17.00
2  77.78  65.69   89.06  84.86     74.06
3  94.44  73.47   99.62  97.96     83.97
4  81.72  16.16   98.11  68.09     26.12
Total accuracy: 55.05%
Average sen: 54.21%
Average spec: 89.52%
Macro f1-score: 46.06%
Diagnosis acc on 15mins: 1.0
[0.99972528 0.99494284 0.99651611 0.99899858 0.99825388 0.99774939
 0.9954378  0.98909295 0.95826286 0.90305513 0.99998188 0.99996543
 0.99661082 0.99976557 0.99934596 0.99818558 0.99336511 0.90319532
 0.97618699 0.9917326  0.99999893 0.99971372 0.98075497 0.99982125
 0.99965465 0.9983021  0.99974722 0.99976188 0.95009166 0.98327154
 0.93185169 0.99488407 0.99934322]
pred: 0.9856838475574147, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.376893, loss_ss: 1.693989, loss_d: 0.682903
0.0384 --- loss: 2.243682, loss_ss: 1.644841, loss_d: 0.598841
0.0767 --- loss: 2.195206, loss_ss: 1.445941, loss_d: 0.749265
0.1151 --- loss: 2.194211, loss_ss: 1.517382, loss_d: 0.676828
0.1535 --- loss: 2.257484, loss_ss: 1.555304, loss_d: 0.702179
0.1919 --- loss: 2.406015, loss_ss: 1.441309, loss_d: 0.964706
0.2302 --- loss: 2.032086, loss_ss: 1.429844, loss_d: 0.602242
0.2686 --- loss: 1.935618, loss_ss: 1.474893, loss_d: 0.460725
0.3070 --- loss: 1.976771, loss_ss: 1.524598, loss_d: 0.452173
0.3454 --- loss: 1.927402, loss_ss: 1.391087, loss_d: 0.536315
0.3837 --- loss: 1.682284, loss_ss: 1.379394, loss_d: 0.302890
0.4221 --- loss: 2.211497, loss_ss: 1.300479, loss_d: 0.911017
0.4605 --- loss: 2.014242, loss_ss: 1.453096, loss_d: 0.561145
0.4988 --- loss: 1.609586, loss_ss: 1.292209, loss_d: 0.317377
0.5372 --- loss: 1.757529, loss_ss: 1.343071, loss_d: 0.414459
0.5756 --- loss: 1.825310, loss_ss: 1.422481, loss_d: 0.402830
0.6140 --- loss: 1.878640, loss_ss: 1.141424, loss_d: 0.737216
0.6523 --- loss: 1.369737, loss_ss: 1.055544, loss_d: 0.314193
0.6907 --- loss: 1.673490, loss_ss: 1.196718, loss_d: 0.476772
0.7291 --- loss: 1.708410, loss_ss: 1.153705, loss_d: 0.554705
0.7675 --- loss: 1.694689, loss_ss: 1.362057, loss_d: 0.332631
0.8058 --- loss: 1.319093, loss_ss: 1.218621, loss_d: 0.100472
0.8442 --- loss: 2.032811, loss_ss: 1.648332, loss_d: 0.384480
0.8826 --- loss: 1.512627, loss_ss: 1.188070, loss_d: 0.324558
0.9210 --- loss: 1.881232, loss_ss: 1.635071, loss_d: 0.246161
0.9593 --- loss: 1.450238, loss_ss: 1.138441, loss_d: 0.311797
0.9977 --- loss: 1.850271, loss_ss: 1.091682, loss_d: 0.758589
Epoch finished! Loss: 1.8433559069266685
Starting epoch 2/10.
0.0000 --- loss: 1.939420, loss_ss: 1.355685, loss_d: 0.583735
0.0384 --- loss: 1.488253, loss_ss: 1.049857, loss_d: 0.438395
0.0767 --- loss: 1.242901, loss_ss: 1.120306, loss_d: 0.122594
0.1151 --- loss: 1.343833, loss_ss: 0.946130, loss_d: 0.397703
0.1535 --- loss: 1.429289, loss_ss: 0.987743, loss_d: 0.441546
0.1919 --- loss: 1.351136, loss_ss: 1.107061, loss_d: 0.244075
0.2302 --- loss: 1.564747, loss_ss: 1.285813, loss_d: 0.278934
0.2686 --- loss: 1.992553, loss_ss: 1.119633, loss_d: 0.872921
0.3070 --- loss: 1.416416, loss_ss: 1.178095, loss_d: 0.238321
0.3454 --- loss: 1.448390, loss_ss: 1.017301, loss_d: 0.431089
0.3837 --- loss: 1.429999, loss_ss: 1.149015, loss_d: 0.280984
0.4221 --- loss: 1.272000, loss_ss: 1.179260, loss_d: 0.092740
0.4605 --- loss: 1.967929, loss_ss: 0.975515, loss_d: 0.992414
0.4988 --- loss: 1.385234, loss_ss: 0.909719, loss_d: 0.475515
0.5372 --- loss: 1.086249, loss_ss: 0.845296, loss_d: 0.240953
0.5756 --- loss: 0.963707, loss_ss: 0.848097, loss_d: 0.115610
0.6140 --- loss: 1.270046, loss_ss: 1.069567, loss_d: 0.200479
0.6523 --- loss: 1.420956, loss_ss: 1.054699, loss_d: 0.366256
0.6907 --- loss: 1.913571, loss_ss: 0.876103, loss_d: 1.037468
0.7291 --- loss: 1.457912, loss_ss: 1.150802, loss_d: 0.307111
0.7675 --- loss: 1.186898, loss_ss: 1.006251, loss_d: 0.180647
0.8058 --- loss: 1.094109, loss_ss: 1.012007, loss_d: 0.082102
0.8442 --- loss: 1.868861, loss_ss: 1.688485, loss_d: 0.180377
0.8826 --- loss: 1.269041, loss_ss: 1.165965, loss_d: 0.103076
0.9210 --- loss: 1.434068, loss_ss: 1.014344, loss_d: 0.419724
0.9593 --- loss: 1.474857, loss_ss: 0.929017, loss_d: 0.545840
0.9977 --- loss: 1.585950, loss_ss: 0.913832, loss_d: 0.672118
Epoch finished! Loss: 1.4019017384602472
Starting epoch 3/10.
0.0000 --- loss: 1.815920, loss_ss: 1.377755, loss_d: 0.438165
0.0384 --- loss: 0.903583, loss_ss: 0.721902, loss_d: 0.181681
0.0767 --- loss: 1.197790, loss_ss: 1.073997, loss_d: 0.123793
0.1151 --- loss: 1.461384, loss_ss: 1.138488, loss_d: 0.322896
0.1535 --- loss: 1.635164, loss_ss: 0.952919, loss_d: 0.682246
0.1919 --- loss: 1.098404, loss_ss: 0.929750, loss_d: 0.168654
0.2302 --- loss: 1.550853, loss_ss: 0.878470, loss_d: 0.672383
0.2686 --- loss: 1.240895, loss_ss: 0.740937, loss_d: 0.499957
0.3070 --- loss: 1.037153, loss_ss: 0.955296, loss_d: 0.081858
0.3454 --- loss: 1.603245, loss_ss: 0.953341, loss_d: 0.649904
0.3837 --- loss: 1.258318, loss_ss: 1.028494, loss_d: 0.229824
0.4221 --- loss: 1.606397, loss_ss: 0.773522, loss_d: 0.832875
0.4605 --- loss: 1.134829, loss_ss: 0.846925, loss_d: 0.287905
0.4988 --- loss: 1.175246, loss_ss: 0.874771, loss_d: 0.300475
0.5372 --- loss: 1.284773, loss_ss: 1.102653, loss_d: 0.182120
0.5756 --- loss: 0.963824, loss_ss: 0.890087, loss_d: 0.073737
0.6140 --- loss: 1.091347, loss_ss: 0.818560, loss_d: 0.272787
0.6523 --- loss: 0.901231, loss_ss: 0.768958, loss_d: 0.132273
0.6907 --- loss: 1.148383, loss_ss: 0.770865, loss_d: 0.377517
0.7291 --- loss: 1.903258, loss_ss: 0.869747, loss_d: 1.033511
0.7675 --- loss: 1.072288, loss_ss: 0.800194, loss_d: 0.272094
0.8058 --- loss: 0.921955, loss_ss: 0.812308, loss_d: 0.109647
0.8442 --- loss: 1.124795, loss_ss: 0.826975, loss_d: 0.297821
0.8826 --- loss: 1.057965, loss_ss: 0.978829, loss_d: 0.079137
0.9210 --- loss: 0.892917, loss_ss: 0.798561, loss_d: 0.094356
0.9593 --- loss: 0.812847, loss_ss: 0.659339, loss_d: 0.153508
0.9977 --- loss: 2.682270, loss_ss: 1.459295, loss_d: 1.222975
Epoch finished! Loss: 1.2066253054600495
Starting epoch 4/10.
0.0000 --- loss: 1.318127, loss_ss: 1.149709, loss_d: 0.168419
0.0384 --- loss: 1.238229, loss_ss: 0.956243, loss_d: 0.281986
0.0767 --- loss: 0.833292, loss_ss: 0.699705, loss_d: 0.133587
0.1151 --- loss: 0.987664, loss_ss: 0.859443, loss_d: 0.128221
0.1535 --- loss: 0.786117, loss_ss: 0.715706, loss_d: 0.070411
0.1919 --- loss: 0.959995, loss_ss: 0.759710, loss_d: 0.200286
0.2302 --- loss: 0.985648, loss_ss: 0.802463, loss_d: 0.183184
0.2686 --- loss: 1.002063, loss_ss: 0.802490, loss_d: 0.199573
0.3070 --- loss: 0.896743, loss_ss: 0.727473, loss_d: 0.169270
0.3454 --- loss: 1.026863, loss_ss: 0.904541, loss_d: 0.122322
0.3837 --- loss: 0.895247, loss_ss: 0.849711, loss_d: 0.045536
0.4221 --- loss: 1.050469, loss_ss: 0.973988, loss_d: 0.076481
0.4605 --- loss: 1.091575, loss_ss: 0.930693, loss_d: 0.160882
0.4988 --- loss: 1.062494, loss_ss: 0.976826, loss_d: 0.085668
0.5372 --- loss: 1.264297, loss_ss: 0.710344, loss_d: 0.553953
0.5756 --- loss: 0.949595, loss_ss: 0.896598, loss_d: 0.052998
0.6140 --- loss: 1.682087, loss_ss: 0.902551, loss_d: 0.779536
0.6523 --- loss: 1.228924, loss_ss: 1.095327, loss_d: 0.133597
0.6907 --- loss: 0.923944, loss_ss: 0.787654, loss_d: 0.136290
0.7291 --- loss: 1.188632, loss_ss: 0.726666, loss_d: 0.461967
0.7675 --- loss: 0.724775, loss_ss: 0.635287, loss_d: 0.089487
0.8058 --- loss: 0.862620, loss_ss: 0.692884, loss_d: 0.169736
0.8442 --- loss: 1.416616, loss_ss: 1.339056, loss_d: 0.077561
0.8826 --- loss: 0.913848, loss_ss: 0.883229, loss_d: 0.030619
0.9210 --- loss: 0.846326, loss_ss: 0.742922, loss_d: 0.103404
0.9593 --- loss: 0.941815, loss_ss: 0.821661, loss_d: 0.120154
0.9977 --- loss: 1.015447, loss_ss: 0.898161, loss_d: 0.117286
Epoch finished! Loss: 1.106826379436713
Starting epoch 5/10.
0.0000 --- loss: 1.272747, loss_ss: 0.815403, loss_d: 0.457343
0.0384 --- loss: 1.126461, loss_ss: 0.845796, loss_d: 0.280665
0.0767 --- loss: 0.994041, loss_ss: 0.875396, loss_d: 0.118645
0.1151 --- loss: 0.840616, loss_ss: 0.800360, loss_d: 0.040256
0.1535 --- loss: 0.901416, loss_ss: 0.767500, loss_d: 0.133916
0.1919 --- loss: 0.957867, loss_ss: 0.878716, loss_d: 0.079151
0.2302 --- loss: 1.119631, loss_ss: 1.002650, loss_d: 0.116981
0.2686 --- loss: 0.871754, loss_ss: 0.717170, loss_d: 0.154585
0.3070 --- loss: 1.123931, loss_ss: 0.893684, loss_d: 0.230248
0.3454 --- loss: 1.172639, loss_ss: 0.902877, loss_d: 0.269762
0.3837 --- loss: 0.868127, loss_ss: 0.821645, loss_d: 0.046482
0.4221 --- loss: 1.079016, loss_ss: 0.972147, loss_d: 0.106869
0.4605 --- loss: 1.057660, loss_ss: 0.630026, loss_d: 0.427634
0.4988 --- loss: 0.919874, loss_ss: 0.852136, loss_d: 0.067738
0.5372 --- loss: 1.259665, loss_ss: 1.019370, loss_d: 0.240295
0.5756 --- loss: 0.881936, loss_ss: 0.844615, loss_d: 0.037321
0.6140 --- loss: 1.203507, loss_ss: 0.895113, loss_d: 0.308394
0.6523 --- loss: 1.241394, loss_ss: 0.772147, loss_d: 0.469247
0.6907 --- loss: 1.659683, loss_ss: 1.032901, loss_d: 0.626783
0.7291 --- loss: 1.067902, loss_ss: 1.047004, loss_d: 0.020898
0.7675 --- loss: 0.923028, loss_ss: 0.795056, loss_d: 0.127972
0.8058 --- loss: 0.966657, loss_ss: 0.937594, loss_d: 0.029063
0.8442 --- loss: 0.808979, loss_ss: 0.561962, loss_d: 0.247017
0.8826 --- loss: 0.797435, loss_ss: 0.723598, loss_d: 0.073837
0.9210 --- loss: 1.006117, loss_ss: 0.969473, loss_d: 0.036645
0.9593 --- loss: 1.235644, loss_ss: 1.076845, loss_d: 0.158799
0.9977 --- loss: 0.976124, loss_ss: 0.522487, loss_d: 0.453637
Epoch finished! Loss: 1.035769420174452
Starting epoch 6/10.
0.0000 --- loss: 0.899621, loss_ss: 0.790759, loss_d: 0.108862
0.0384 --- loss: 1.108954, loss_ss: 1.002269, loss_d: 0.106685
0.0767 --- loss: 0.829988, loss_ss: 0.791009, loss_d: 0.038979
0.1151 --- loss: 0.706847, loss_ss: 0.661461, loss_d: 0.045386
0.1535 --- loss: 0.559576, loss_ss: 0.468760, loss_d: 0.090816
0.1919 --- loss: 0.973532, loss_ss: 0.934641, loss_d: 0.038891
0.2302 --- loss: 1.069972, loss_ss: 0.697305, loss_d: 0.372667
0.2686 --- loss: 0.758678, loss_ss: 0.740673, loss_d: 0.018005
0.3070 --- loss: 1.055613, loss_ss: 0.855628, loss_d: 0.199985
0.3454 --- loss: 0.628663, loss_ss: 0.486744, loss_d: 0.141919
0.3837 --- loss: 0.626050, loss_ss: 0.614811, loss_d: 0.011239
0.4221 --- loss: 0.924840, loss_ss: 0.830920, loss_d: 0.093920
0.4605 --- loss: 0.687486, loss_ss: 0.662272, loss_d: 0.025213
0.4988 --- loss: 0.825141, loss_ss: 0.664605, loss_d: 0.160536
0.5372 --- loss: 0.863559, loss_ss: 0.647404, loss_d: 0.216155
0.5756 --- loss: 0.885469, loss_ss: 0.876882, loss_d: 0.008587
0.6140 --- loss: 1.254814, loss_ss: 1.212761, loss_d: 0.042052
0.6523 --- loss: 0.854091, loss_ss: 0.799613, loss_d: 0.054478
0.6907 --- loss: 1.048908, loss_ss: 0.796042, loss_d: 0.252865
0.7291 --- loss: 0.703996, loss_ss: 0.589197, loss_d: 0.114799
0.7675 --- loss: 0.818577, loss_ss: 0.709561, loss_d: 0.109017
0.8058 --- loss: 1.083208, loss_ss: 1.030659, loss_d: 0.052549
0.8442 --- loss: 0.934343, loss_ss: 0.919711, loss_d: 0.014632
0.8826 --- loss: 0.781755, loss_ss: 0.769087, loss_d: 0.012668
0.9210 --- loss: 0.665862, loss_ss: 0.655163, loss_d: 0.010699
0.9593 --- loss: 0.792217, loss_ss: 0.774728, loss_d: 0.017489
0.9977 --- loss: 1.001580, loss_ss: 0.901668, loss_d: 0.099912
Epoch finished! Loss: 0.949259074146931
Starting epoch 7/10.
0.0000 --- loss: 0.758734, loss_ss: 0.676474, loss_d: 0.082261
0.0384 --- loss: 0.782136, loss_ss: 0.759050, loss_d: 0.023085
0.0767 --- loss: 0.616875, loss_ss: 0.542944, loss_d: 0.073931
0.1151 --- loss: 0.927997, loss_ss: 0.660607, loss_d: 0.267389
0.1535 --- loss: 0.782666, loss_ss: 0.745414, loss_d: 0.037252
0.1919 --- loss: 0.828856, loss_ss: 0.675387, loss_d: 0.153469
0.2302 --- loss: 0.798202, loss_ss: 0.739839, loss_d: 0.058363
0.2686 --- loss: 0.907762, loss_ss: 0.855623, loss_d: 0.052139
0.3070 --- loss: 0.800768, loss_ss: 0.736885, loss_d: 0.063883
0.3454 --- loss: 1.083923, loss_ss: 0.724397, loss_d: 0.359526
0.3837 --- loss: 0.942064, loss_ss: 0.835459, loss_d: 0.106605
0.4221 --- loss: 1.013379, loss_ss: 0.853559, loss_d: 0.159820
0.4605 --- loss: 0.911819, loss_ss: 0.884772, loss_d: 0.027047
0.4988 --- loss: 0.984816, loss_ss: 0.794188, loss_d: 0.190629
0.5372 --- loss: 1.151957, loss_ss: 0.719449, loss_d: 0.432508
0.5756 --- loss: 0.824108, loss_ss: 0.788031, loss_d: 0.036077
0.6140 --- loss: 1.068238, loss_ss: 0.520735, loss_d: 0.547503
0.6523 --- loss: 1.027752, loss_ss: 0.634281, loss_d: 0.393471
0.6907 --- loss: 0.970520, loss_ss: 0.772660, loss_d: 0.197860
0.7291 --- loss: 1.379364, loss_ss: 1.292416, loss_d: 0.086948
0.7675 --- loss: 0.736836, loss_ss: 0.696681, loss_d: 0.040155
0.8058 --- loss: 0.991850, loss_ss: 0.956077, loss_d: 0.035772
0.8442 --- loss: 1.009957, loss_ss: 0.881086, loss_d: 0.128871
0.8826 --- loss: 0.933995, loss_ss: 0.725572, loss_d: 0.208423
0.9210 --- loss: 1.059634, loss_ss: 1.032565, loss_d: 0.027069
0.9593 --- loss: 0.696023, loss_ss: 0.676701, loss_d: 0.019322
0.9977 --- loss: 1.024743, loss_ss: 0.666496, loss_d: 0.358247
Epoch finished! Loss: 0.9319995439969576
Starting epoch 8/10.
0.0000 --- loss: 0.865119, loss_ss: 0.826116, loss_d: 0.039002
0.0384 --- loss: 0.937517, loss_ss: 0.734816, loss_d: 0.202701
0.0767 --- loss: 0.844632, loss_ss: 0.733003, loss_d: 0.111629
0.1151 --- loss: 1.155972, loss_ss: 0.989255, loss_d: 0.166718
0.1535 --- loss: 0.900407, loss_ss: 0.746506, loss_d: 0.153901
0.1919 --- loss: 0.810487, loss_ss: 0.790923, loss_d: 0.019565
0.2302 --- loss: 0.944358, loss_ss: 0.698610, loss_d: 0.245749
0.2686 --- loss: 0.885530, loss_ss: 0.592436, loss_d: 0.293094
0.3070 --- loss: 0.612473, loss_ss: 0.605247, loss_d: 0.007226
0.3454 --- loss: 1.598106, loss_ss: 1.579932, loss_d: 0.018174
0.3837 --- loss: 0.744554, loss_ss: 0.620759, loss_d: 0.123796
0.4221 --- loss: 0.753765, loss_ss: 0.752305, loss_d: 0.001459
0.4605 --- loss: 1.332355, loss_ss: 0.687697, loss_d: 0.644658
0.4988 --- loss: 0.891067, loss_ss: 0.845452, loss_d: 0.045615
0.5372 --- loss: 0.825751, loss_ss: 0.612550, loss_d: 0.213201
0.5756 --- loss: 0.709333, loss_ss: 0.658128, loss_d: 0.051205
0.6140 --- loss: 0.759689, loss_ss: 0.679126, loss_d: 0.080563
0.6523 --- loss: 0.767552, loss_ss: 0.734112, loss_d: 0.033440
0.6907 --- loss: 0.447349, loss_ss: 0.427782, loss_d: 0.019567
0.7291 --- loss: 1.359213, loss_ss: 1.003469, loss_d: 0.355744
0.7675 --- loss: 0.925125, loss_ss: 0.865274, loss_d: 0.059852
0.8058 --- loss: 1.489930, loss_ss: 1.135622, loss_d: 0.354308
0.8442 --- loss: 0.949423, loss_ss: 0.829308, loss_d: 0.120115
0.8826 --- loss: 0.922262, loss_ss: 0.854137, loss_d: 0.068126
0.9210 --- loss: 0.761231, loss_ss: 0.742268, loss_d: 0.018963
0.9593 --- loss: 1.035117, loss_ss: 0.524886, loss_d: 0.510231
0.9977 --- loss: 0.569371, loss_ss: 0.536567, loss_d: 0.032803
Epoch finished! Loss: 0.8946449151405922
Starting epoch 9/10.
0.0000 --- loss: 0.805848, loss_ss: 0.747251, loss_d: 0.058597
0.0384 --- loss: 1.116973, loss_ss: 1.081082, loss_d: 0.035891
0.0767 --- loss: 0.433179, loss_ss: 0.415555, loss_d: 0.017624
0.1151 --- loss: 0.795270, loss_ss: 0.760988, loss_d: 0.034282
0.1535 --- loss: 1.753657, loss_ss: 1.617789, loss_d: 0.135867
0.1919 --- loss: 0.760567, loss_ss: 0.753329, loss_d: 0.007238
0.2302 --- loss: 0.985292, loss_ss: 0.685268, loss_d: 0.300024
0.2686 --- loss: 0.667565, loss_ss: 0.479691, loss_d: 0.187874
0.3070 --- loss: 1.514864, loss_ss: 1.204572, loss_d: 0.310292
0.3454 --- loss: 0.851064, loss_ss: 0.820958, loss_d: 0.030107
0.3837 --- loss: 1.029746, loss_ss: 0.903738, loss_d: 0.126008
0.4221 --- loss: 0.876782, loss_ss: 0.869065, loss_d: 0.007717
0.4605 --- loss: 0.791403, loss_ss: 0.662136, loss_d: 0.129267
0.4988 --- loss: 0.550604, loss_ss: 0.533280, loss_d: 0.017323
0.5372 --- loss: 0.641714, loss_ss: 0.613648, loss_d: 0.028065
0.5756 --- loss: 0.669913, loss_ss: 0.522025, loss_d: 0.147888
0.6140 --- loss: 0.745667, loss_ss: 0.632364, loss_d: 0.113303
0.6523 --- loss: 0.896012, loss_ss: 0.889516, loss_d: 0.006496
0.6907 --- loss: 1.277269, loss_ss: 0.987144, loss_d: 0.290125
0.7291 --- loss: 0.842474, loss_ss: 0.819189, loss_d: 0.023285
0.7675 --- loss: 0.862133, loss_ss: 0.743709, loss_d: 0.118424
0.8058 --- loss: 0.833749, loss_ss: 0.827564, loss_d: 0.006185
0.8442 --- loss: 0.776586, loss_ss: 0.773825, loss_d: 0.002762
0.8826 --- loss: 0.904385, loss_ss: 0.873018, loss_d: 0.031368
0.9210 --- loss: 0.759200, loss_ss: 0.752818, loss_d: 0.006382
0.9593 --- loss: 0.569138, loss_ss: 0.564949, loss_d: 0.004189
0.9977 --- loss: 1.151636, loss_ss: 0.921656, loss_d: 0.229981
Epoch finished! Loss: 0.8597284245949525
Starting epoch 10/10.
0.0000 --- loss: 0.674088, loss_ss: 0.663082, loss_d: 0.011007
0.0384 --- loss: 1.084172, loss_ss: 0.829188, loss_d: 0.254985
0.0767 --- loss: 0.617308, loss_ss: 0.613485, loss_d: 0.003824
0.1151 --- loss: 0.524924, loss_ss: 0.516323, loss_d: 0.008601
0.1535 --- loss: 0.766438, loss_ss: 0.742244, loss_d: 0.024194
0.1919 --- loss: 0.720421, loss_ss: 0.692109, loss_d: 0.028311
0.2302 --- loss: 0.736578, loss_ss: 0.707700, loss_d: 0.028879
0.2686 --- loss: 0.692335, loss_ss: 0.454766, loss_d: 0.237569
0.3070 --- loss: 0.701969, loss_ss: 0.694619, loss_d: 0.007350
0.3454 --- loss: 0.486077, loss_ss: 0.422923, loss_d: 0.063154
0.3837 --- loss: 0.548008, loss_ss: 0.545328, loss_d: 0.002680
0.4221 --- loss: 1.157357, loss_ss: 0.485396, loss_d: 0.671962
0.4605 --- loss: 0.797887, loss_ss: 0.793098, loss_d: 0.004789
0.4988 --- loss: 1.414145, loss_ss: 0.955422, loss_d: 0.458723
0.5372 --- loss: 1.243621, loss_ss: 0.834738, loss_d: 0.408883
0.5756 --- loss: 0.781860, loss_ss: 0.774553, loss_d: 0.007307
0.6140 --- loss: 1.025635, loss_ss: 0.938295, loss_d: 0.087340
0.6523 --- loss: 1.558438, loss_ss: 1.278688, loss_d: 0.279749
0.6907 --- loss: 0.795549, loss_ss: 0.768506, loss_d: 0.027043
0.7291 --- loss: 0.825254, loss_ss: 0.793368, loss_d: 0.031886
0.7675 --- loss: 0.739871, loss_ss: 0.708906, loss_d: 0.030965
0.8058 --- loss: 0.989426, loss_ss: 0.974866, loss_d: 0.014560
0.8442 --- loss: 1.385290, loss_ss: 1.142835, loss_d: 0.242455
0.8826 --- loss: 1.133280, loss_ss: 0.544336, loss_d: 0.588944
0.9210 --- loss: 0.586016, loss_ss: 0.576316, loss_d: 0.009700
0.9593 --- loss: 0.526390, loss_ss: 0.513042, loss_d: 0.013348
0.9977 --- loss: 1.147353, loss_ss: 1.136801, loss_d: 0.010552
Epoch finished! Loss: 0.8329686446831777
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6708333333333333
             precision    recall  f1-score   support

        0.0       0.63      0.61      0.62       135
        1.0       0.36      0.62      0.46       141
        2.0       0.79      0.77      0.78       354
        3.0       0.96      0.70      0.81       197
        4.0       0.64      0.49      0.56       133

avg / total       0.72      0.67      0.68       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.38  60.74   94.06  62.60     61.65
1  78.33  61.70   81.20  36.10     45.55
2  84.06  77.12   88.12  79.13     78.11
3  93.23  69.54   99.34  96.48     80.83
4  89.17  48.87   95.65  64.36     55.56
Total accuracy: 67.08%
Average sen: 63.60%
Average spec: 91.67%
Macro f1-score: 64.34%
Diagnosis acc on 15mins: 0.96875
[0.9999994  0.99978799 0.95869696 0.9391703  0.92515039 0.99999845
 0.99999225 0.9985745  0.99957913 1.         0.99999952 0.99996638
 0.99867553 0.99998379 0.99999988 0.99999964 0.99999905 0.99998701
 0.99951887 0.99840516 0.99999869 0.99994469 0.99998713 0.99999547
 1.         0.99968851 0.31844366 0.90104467 0.99999297 0.99999976
 0.99999821 0.99999952]
pred: 0.9698930457234383, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.323555, loss_ss: 1.630753, loss_d: 0.692803
0.0385 --- loss: 2.180536, loss_ss: 1.561681, loss_d: 0.618855
0.0771 --- loss: 2.252548, loss_ss: 1.573167, loss_d: 0.679381
0.1156 --- loss: 2.095106, loss_ss: 1.405651, loss_d: 0.689455
0.1541 --- loss: 2.159605, loss_ss: 1.473149, loss_d: 0.686456
0.1927 --- loss: 1.731442, loss_ss: 1.228357, loss_d: 0.503085
0.2312 --- loss: 2.318082, loss_ss: 1.436960, loss_d: 0.881123
0.2697 --- loss: 1.758502, loss_ss: 1.231102, loss_d: 0.527400
0.3083 --- loss: 1.870412, loss_ss: 1.289824, loss_d: 0.580588
0.3468 --- loss: 1.768267, loss_ss: 1.161409, loss_d: 0.606858
0.3854 --- loss: 1.980069, loss_ss: 1.484015, loss_d: 0.496054
0.4239 --- loss: 1.750948, loss_ss: 1.256119, loss_d: 0.494830
0.4624 --- loss: 2.436758, loss_ss: 1.662304, loss_d: 0.774454
0.5010 --- loss: 1.654645, loss_ss: 1.242821, loss_d: 0.411824
0.5395 --- loss: 1.843770, loss_ss: 1.309643, loss_d: 0.534127
0.5780 --- loss: 1.811183, loss_ss: 1.314686, loss_d: 0.496497
0.6166 --- loss: 1.740239, loss_ss: 1.182429, loss_d: 0.557810
0.6551 --- loss: 1.565420, loss_ss: 1.262847, loss_d: 0.302573
0.6936 --- loss: 1.848839, loss_ss: 1.090532, loss_d: 0.758306
0.7322 --- loss: 2.184238, loss_ss: 1.355100, loss_d: 0.829138
0.7707 --- loss: 1.388239, loss_ss: 0.975275, loss_d: 0.412964
0.8092 --- loss: 1.670142, loss_ss: 1.370646, loss_d: 0.299496
0.8478 --- loss: 1.689420, loss_ss: 1.119998, loss_d: 0.569423
0.8863 --- loss: 1.394627, loss_ss: 1.117061, loss_d: 0.277566
0.9249 --- loss: 1.707199, loss_ss: 0.989106, loss_d: 0.718093
0.9634 --- loss: 1.292798, loss_ss: 0.965163, loss_d: 0.327635
Epoch finished! Loss: 1.8445600667055049
Starting epoch 2/10.
0.0000 --- loss: 1.646262, loss_ss: 1.158711, loss_d: 0.487551
0.0385 --- loss: 1.575413, loss_ss: 0.964081, loss_d: 0.611331
0.0771 --- loss: 1.936736, loss_ss: 1.540839, loss_d: 0.395897
0.1156 --- loss: 1.739159, loss_ss: 1.100435, loss_d: 0.638725
0.1541 --- loss: 1.207171, loss_ss: 0.905332, loss_d: 0.301838
0.1927 --- loss: 1.516528, loss_ss: 1.226081, loss_d: 0.290447
0.2312 --- loss: 1.219266, loss_ss: 1.062962, loss_d: 0.156304
0.2697 --- loss: 1.803752, loss_ss: 1.370075, loss_d: 0.433677
0.3083 --- loss: 1.243495, loss_ss: 0.879482, loss_d: 0.364013
0.3468 --- loss: 1.196764, loss_ss: 1.075253, loss_d: 0.121512
0.3854 --- loss: 1.429283, loss_ss: 1.123118, loss_d: 0.306166
0.4239 --- loss: 1.155740, loss_ss: 0.948812, loss_d: 0.206929
0.4624 --- loss: 1.239598, loss_ss: 1.117445, loss_d: 0.122153
0.5010 --- loss: 1.079362, loss_ss: 0.900721, loss_d: 0.178641
0.5395 --- loss: 0.961868, loss_ss: 0.763247, loss_d: 0.198621
0.5780 --- loss: 1.424699, loss_ss: 0.848273, loss_d: 0.576426
0.6166 --- loss: 1.008856, loss_ss: 0.858208, loss_d: 0.150648
0.6551 --- loss: 1.290257, loss_ss: 0.948899, loss_d: 0.341357
0.6936 --- loss: 1.643425, loss_ss: 0.867420, loss_d: 0.776005
0.7322 --- loss: 1.427138, loss_ss: 0.947335, loss_d: 0.479804
0.7707 --- loss: 1.157066, loss_ss: 0.831217, loss_d: 0.325849
0.8092 --- loss: 1.281468, loss_ss: 1.109902, loss_d: 0.171566
0.8478 --- loss: 1.388826, loss_ss: 0.927620, loss_d: 0.461205
0.8863 --- loss: 1.327457, loss_ss: 1.044595, loss_d: 0.282862
0.9249 --- loss: 1.433668, loss_ss: 0.957640, loss_d: 0.476028
0.9634 --- loss: 1.997948, loss_ss: 1.316493, loss_d: 0.681455
Epoch finished! Loss: 1.3440732171176484
Starting epoch 3/10.
0.0000 --- loss: 0.896708, loss_ss: 0.727917, loss_d: 0.168791
0.0385 --- loss: 1.070183, loss_ss: 0.753332, loss_d: 0.316851
0.0771 --- loss: 1.397584, loss_ss: 1.178705, loss_d: 0.218879
0.1156 --- loss: 1.523725, loss_ss: 0.999684, loss_d: 0.524041
0.1541 --- loss: 1.237036, loss_ss: 0.971539, loss_d: 0.265496
0.1927 --- loss: 1.228757, loss_ss: 0.937153, loss_d: 0.291604
0.2312 --- loss: 0.931916, loss_ss: 0.714505, loss_d: 0.217410
0.2697 --- loss: 1.261740, loss_ss: 0.876285, loss_d: 0.385455
0.3083 --- loss: 1.002940, loss_ss: 0.947484, loss_d: 0.055456
0.3468 --- loss: 1.369105, loss_ss: 0.673235, loss_d: 0.695870
0.3854 --- loss: 1.080209, loss_ss: 0.804132, loss_d: 0.276078
0.4239 --- loss: 1.196986, loss_ss: 0.847874, loss_d: 0.349113
0.4624 --- loss: 1.067565, loss_ss: 0.901106, loss_d: 0.166459
0.5010 --- loss: 1.227408, loss_ss: 0.877364, loss_d: 0.350043
0.5395 --- loss: 0.939168, loss_ss: 0.713578, loss_d: 0.225590
0.5780 --- loss: 0.964867, loss_ss: 0.841619, loss_d: 0.123248
0.6166 --- loss: 1.262623, loss_ss: 0.911193, loss_d: 0.351430
0.6551 --- loss: 0.861416, loss_ss: 0.770939, loss_d: 0.090477
0.6936 --- loss: 0.734128, loss_ss: 0.668710, loss_d: 0.065418
0.7322 --- loss: 0.976689, loss_ss: 0.903946, loss_d: 0.072743
0.7707 --- loss: 0.939819, loss_ss: 0.597388, loss_d: 0.342431
0.8092 --- loss: 0.814048, loss_ss: 0.752186, loss_d: 0.061862
0.8478 --- loss: 1.030062, loss_ss: 0.754836, loss_d: 0.275226
0.8863 --- loss: 1.054485, loss_ss: 0.881757, loss_d: 0.172728
0.9249 --- loss: 1.622070, loss_ss: 0.962929, loss_d: 0.659141
0.9634 --- loss: 0.835602, loss_ss: 0.719125, loss_d: 0.116477
Epoch finished! Loss: 1.1201441207447567
Starting epoch 4/10.
0.0000 --- loss: 1.183854, loss_ss: 0.944596, loss_d: 0.239257
0.0385 --- loss: 1.119613, loss_ss: 0.882314, loss_d: 0.237300
0.0771 --- loss: 0.960086, loss_ss: 0.809320, loss_d: 0.150766
0.1156 --- loss: 1.020952, loss_ss: 0.944171, loss_d: 0.076782
0.1541 --- loss: 1.021189, loss_ss: 0.717327, loss_d: 0.303862
0.1927 --- loss: 1.256212, loss_ss: 1.010810, loss_d: 0.245402
0.2312 --- loss: 1.212422, loss_ss: 0.958446, loss_d: 0.253975
0.2697 --- loss: 0.637176, loss_ss: 0.565691, loss_d: 0.071485
0.3083 --- loss: 0.854569, loss_ss: 0.739403, loss_d: 0.115167
0.3468 --- loss: 0.899640, loss_ss: 0.818435, loss_d: 0.081205
0.3854 --- loss: 0.822564, loss_ss: 0.658217, loss_d: 0.164347
0.4239 --- loss: 0.968188, loss_ss: 0.925498, loss_d: 0.042689
0.4624 --- loss: 0.827449, loss_ss: 0.784326, loss_d: 0.043122
0.5010 --- loss: 1.134710, loss_ss: 0.960636, loss_d: 0.174073
0.5395 --- loss: 1.319514, loss_ss: 1.001724, loss_d: 0.317790
0.5780 --- loss: 0.719726, loss_ss: 0.590463, loss_d: 0.129263
0.6166 --- loss: 0.943197, loss_ss: 0.717105, loss_d: 0.226091
0.6551 --- loss: 1.441891, loss_ss: 0.565456, loss_d: 0.876435
0.6936 --- loss: 0.934654, loss_ss: 0.841857, loss_d: 0.092797
0.7322 --- loss: 0.925687, loss_ss: 0.796858, loss_d: 0.128829
0.7707 --- loss: 1.005042, loss_ss: 0.857416, loss_d: 0.147626
0.8092 --- loss: 1.048963, loss_ss: 0.712100, loss_d: 0.336863
0.8478 --- loss: 1.163548, loss_ss: 0.938580, loss_d: 0.224968
0.8863 --- loss: 0.793762, loss_ss: 0.752545, loss_d: 0.041217
0.9249 --- loss: 1.205917, loss_ss: 0.974699, loss_d: 0.231218
0.9634 --- loss: 1.179268, loss_ss: 1.010738, loss_d: 0.168530
Epoch finished! Loss: 1.0195499980771863
Starting epoch 5/10.
0.0000 --- loss: 0.973718, loss_ss: 0.853605, loss_d: 0.120113
0.0385 --- loss: 1.141163, loss_ss: 0.851950, loss_d: 0.289214
0.0771 --- loss: 0.961359, loss_ss: 0.855065, loss_d: 0.106294
0.1156 --- loss: 0.975884, loss_ss: 0.882894, loss_d: 0.092990
0.1541 --- loss: 0.589751, loss_ss: 0.482510, loss_d: 0.107242
0.1927 --- loss: 1.358076, loss_ss: 0.664754, loss_d: 0.693322
0.2312 --- loss: 1.061151, loss_ss: 0.996567, loss_d: 0.064584
0.2697 --- loss: 1.174798, loss_ss: 0.812636, loss_d: 0.362161
0.3083 --- loss: 0.994184, loss_ss: 0.958131, loss_d: 0.036052
0.3468 --- loss: 0.894037, loss_ss: 0.571547, loss_d: 0.322490
0.3854 --- loss: 0.689167, loss_ss: 0.533501, loss_d: 0.155666
0.4239 --- loss: 0.955145, loss_ss: 0.786711, loss_d: 0.168434
0.4624 --- loss: 1.709819, loss_ss: 0.824738, loss_d: 0.885081
0.5010 --- loss: 0.675739, loss_ss: 0.648103, loss_d: 0.027636
0.5395 --- loss: 0.993034, loss_ss: 0.771972, loss_d: 0.221061
0.5780 --- loss: 1.181069, loss_ss: 1.148580, loss_d: 0.032489
0.6166 --- loss: 0.653603, loss_ss: 0.632662, loss_d: 0.020941
0.6551 --- loss: 0.969508, loss_ss: 0.930915, loss_d: 0.038593
0.6936 --- loss: 0.772215, loss_ss: 0.728189, loss_d: 0.044025
0.7322 --- loss: 1.159724, loss_ss: 1.027973, loss_d: 0.131751
0.7707 --- loss: 0.794365, loss_ss: 0.772624, loss_d: 0.021742
0.8092 --- loss: 0.693848, loss_ss: 0.680254, loss_d: 0.013595
0.8478 --- loss: 0.608099, loss_ss: 0.510263, loss_d: 0.097836
0.8863 --- loss: 0.848952, loss_ss: 0.775820, loss_d: 0.073132
0.9249 --- loss: 1.172643, loss_ss: 0.802313, loss_d: 0.370329
0.9634 --- loss: 0.806352, loss_ss: 0.665381, loss_d: 0.140971
Epoch finished! Loss: 0.9447560089435356
Starting epoch 6/10.
0.0000 --- loss: 0.980310, loss_ss: 0.887659, loss_d: 0.092651
0.0385 --- loss: 0.933011, loss_ss: 0.851142, loss_d: 0.081869
0.0771 --- loss: 0.773448, loss_ss: 0.633901, loss_d: 0.139548
0.1156 --- loss: 0.804629, loss_ss: 0.756190, loss_d: 0.048439
0.1541 --- loss: 0.875021, loss_ss: 0.772646, loss_d: 0.102376
0.1927 --- loss: 0.616327, loss_ss: 0.575737, loss_d: 0.040589
0.2312 --- loss: 1.029907, loss_ss: 1.004626, loss_d: 0.025281
0.2697 --- loss: 0.839203, loss_ss: 0.824014, loss_d: 0.015189
0.3083 --- loss: 0.659720, loss_ss: 0.623192, loss_d: 0.036528
0.3468 --- loss: 1.606823, loss_ss: 0.978177, loss_d: 0.628646
0.3854 --- loss: 1.077319, loss_ss: 0.919246, loss_d: 0.158073
0.4239 --- loss: 0.820162, loss_ss: 0.788314, loss_d: 0.031848
0.4624 --- loss: 1.076035, loss_ss: 0.960434, loss_d: 0.115601
0.5010 --- loss: 0.839596, loss_ss: 0.742085, loss_d: 0.097511
0.5395 --- loss: 0.647897, loss_ss: 0.592266, loss_d: 0.055631
0.5780 --- loss: 1.002460, loss_ss: 0.955719, loss_d: 0.046742
0.6166 --- loss: 1.134678, loss_ss: 0.768990, loss_d: 0.365688
0.6551 --- loss: 1.141096, loss_ss: 0.882978, loss_d: 0.258117
0.6936 --- loss: 0.863840, loss_ss: 0.659359, loss_d: 0.204480
0.7322 --- loss: 0.712422, loss_ss: 0.533644, loss_d: 0.178778
0.7707 --- loss: 0.664024, loss_ss: 0.560338, loss_d: 0.103686
0.8092 --- loss: 0.860598, loss_ss: 0.832815, loss_d: 0.027783
0.8478 --- loss: 1.148735, loss_ss: 1.063105, loss_d: 0.085630
0.8863 --- loss: 0.695338, loss_ss: 0.661125, loss_d: 0.034213
0.9249 --- loss: 0.680249, loss_ss: 0.608711, loss_d: 0.071538
0.9634 --- loss: 0.738732, loss_ss: 0.715814, loss_d: 0.022918
Epoch finished! Loss: 0.9277679450723656
Starting epoch 7/10.
0.0000 --- loss: 1.016026, loss_ss: 0.841897, loss_d: 0.174128
0.0385 --- loss: 0.906217, loss_ss: 0.854377, loss_d: 0.051840
0.0771 --- loss: 0.867860, loss_ss: 0.821792, loss_d: 0.046068
0.1156 --- loss: 0.822564, loss_ss: 0.805789, loss_d: 0.016774
0.1541 --- loss: 0.905922, loss_ss: 0.875622, loss_d: 0.030300
0.1927 --- loss: 0.534271, loss_ss: 0.529439, loss_d: 0.004833
0.2312 --- loss: 0.652366, loss_ss: 0.556039, loss_d: 0.096327
0.2697 --- loss: 0.984115, loss_ss: 0.734211, loss_d: 0.249904
0.3083 --- loss: 1.127529, loss_ss: 0.642400, loss_d: 0.485129
0.3468 --- loss: 0.674415, loss_ss: 0.527997, loss_d: 0.146418
0.3854 --- loss: 1.043782, loss_ss: 0.966174, loss_d: 0.077608
0.4239 --- loss: 1.432985, loss_ss: 0.620019, loss_d: 0.812966
0.4624 --- loss: 0.909736, loss_ss: 0.881295, loss_d: 0.028441
0.5010 --- loss: 0.723555, loss_ss: 0.605392, loss_d: 0.118163
0.5395 --- loss: 0.999936, loss_ss: 0.663565, loss_d: 0.336370
0.5780 --- loss: 0.802101, loss_ss: 0.768061, loss_d: 0.034039
0.6166 --- loss: 0.927873, loss_ss: 0.644159, loss_d: 0.283714
0.6551 --- loss: 0.652551, loss_ss: 0.637942, loss_d: 0.014608
0.6936 --- loss: 0.984091, loss_ss: 0.790031, loss_d: 0.194059
0.7322 --- loss: 0.978047, loss_ss: 0.936483, loss_d: 0.041564
0.7707 --- loss: 0.853911, loss_ss: 0.631706, loss_d: 0.222205
0.8092 --- loss: 0.541131, loss_ss: 0.511411, loss_d: 0.029720
0.8478 --- loss: 0.897534, loss_ss: 0.702400, loss_d: 0.195134
0.8863 --- loss: 0.610831, loss_ss: 0.521381, loss_d: 0.089450
0.9249 --- loss: 1.693870, loss_ss: 1.277699, loss_d: 0.416171
0.9634 --- loss: 0.920703, loss_ss: 0.716519, loss_d: 0.204184
Epoch finished! Loss: 0.8624465165221092
Starting epoch 8/10.
0.0000 --- loss: 0.865230, loss_ss: 0.820738, loss_d: 0.044492
0.0385 --- loss: 0.815623, loss_ss: 0.782759, loss_d: 0.032863
0.0771 --- loss: 0.772288, loss_ss: 0.696396, loss_d: 0.075892
0.1156 --- loss: 0.664538, loss_ss: 0.525339, loss_d: 0.139199
0.1541 --- loss: 0.824945, loss_ss: 0.720496, loss_d: 0.104449
0.1927 --- loss: 0.668761, loss_ss: 0.501380, loss_d: 0.167381
0.2312 --- loss: 0.522928, loss_ss: 0.512365, loss_d: 0.010564
0.2697 --- loss: 0.779776, loss_ss: 0.705750, loss_d: 0.074026
0.3083 --- loss: 0.629938, loss_ss: 0.627440, loss_d: 0.002498
0.3468 --- loss: 0.372296, loss_ss: 0.361758, loss_d: 0.010538
0.3854 --- loss: 0.621401, loss_ss: 0.595896, loss_d: 0.025505
0.4239 --- loss: 0.822303, loss_ss: 0.662963, loss_d: 0.159340
0.4624 --- loss: 0.743810, loss_ss: 0.664998, loss_d: 0.078812
0.5010 --- loss: 1.036657, loss_ss: 0.722762, loss_d: 0.313895
0.5395 --- loss: 1.087719, loss_ss: 0.661323, loss_d: 0.426396
0.5780 --- loss: 0.909888, loss_ss: 0.870862, loss_d: 0.039026
0.6166 --- loss: 0.962270, loss_ss: 0.893289, loss_d: 0.068981
0.6551 --- loss: 0.927571, loss_ss: 0.744370, loss_d: 0.183201
0.6936 --- loss: 1.022654, loss_ss: 0.955916, loss_d: 0.066738
0.7322 --- loss: 1.365105, loss_ss: 0.860615, loss_d: 0.504489
0.7707 --- loss: 0.747496, loss_ss: 0.629856, loss_d: 0.117640
0.8092 --- loss: 1.123426, loss_ss: 0.949280, loss_d: 0.174147
0.8478 --- loss: 0.695976, loss_ss: 0.655851, loss_d: 0.040125
0.8863 --- loss: 0.909074, loss_ss: 0.603565, loss_d: 0.305509
0.9249 --- loss: 0.883255, loss_ss: 0.816788, loss_d: 0.066467
0.9634 --- loss: 0.931219, loss_ss: 0.904672, loss_d: 0.026547
Epoch finished! Loss: 0.8593104677310781
Starting epoch 9/10.
0.0000 --- loss: 0.494372, loss_ss: 0.484402, loss_d: 0.009970
0.0385 --- loss: 0.650418, loss_ss: 0.630366, loss_d: 0.020052
0.0771 --- loss: 1.229686, loss_ss: 0.595919, loss_d: 0.633767
0.1156 --- loss: 0.890261, loss_ss: 0.835602, loss_d: 0.054659
0.1541 --- loss: 0.811308, loss_ss: 0.651484, loss_d: 0.159824
0.1927 --- loss: 0.731069, loss_ss: 0.723415, loss_d: 0.007654
0.2312 --- loss: 0.496702, loss_ss: 0.464485, loss_d: 0.032218
0.2697 --- loss: 0.774838, loss_ss: 0.611664, loss_d: 0.163174
0.3083 --- loss: 0.963230, loss_ss: 0.915978, loss_d: 0.047252
0.3468 --- loss: 0.785419, loss_ss: 0.710115, loss_d: 0.075304
0.3854 --- loss: 0.656619, loss_ss: 0.653788, loss_d: 0.002831
0.4239 --- loss: 1.420206, loss_ss: 1.415180, loss_d: 0.005027
0.4624 --- loss: 0.528593, loss_ss: 0.490246, loss_d: 0.038347
0.5010 --- loss: 0.718024, loss_ss: 0.639530, loss_d: 0.078493
0.5395 --- loss: 0.514340, loss_ss: 0.509446, loss_d: 0.004894
0.5780 --- loss: 0.703546, loss_ss: 0.697429, loss_d: 0.006117
0.6166 --- loss: 0.881234, loss_ss: 0.800868, loss_d: 0.080365
0.6551 --- loss: 1.244394, loss_ss: 0.957388, loss_d: 0.287006
0.6936 --- loss: 0.657353, loss_ss: 0.537003, loss_d: 0.120350
0.7322 --- loss: 1.259864, loss_ss: 1.108647, loss_d: 0.151217
0.7707 --- loss: 0.736406, loss_ss: 0.591216, loss_d: 0.145190
0.8092 --- loss: 1.005213, loss_ss: 0.916039, loss_d: 0.089174
0.8478 --- loss: 0.742872, loss_ss: 0.664116, loss_d: 0.078756
0.8863 --- loss: 1.056750, loss_ss: 1.042411, loss_d: 0.014338
0.9249 --- loss: 0.738904, loss_ss: 0.678837, loss_d: 0.060067
0.9634 --- loss: 1.104872, loss_ss: 0.921558, loss_d: 0.183313
Epoch finished! Loss: 0.825957677539251
Starting epoch 10/10.
0.0000 --- loss: 0.564880, loss_ss: 0.559237, loss_d: 0.005643
0.0385 --- loss: 0.809255, loss_ss: 0.801188, loss_d: 0.008067
0.0771 --- loss: 0.549597, loss_ss: 0.539516, loss_d: 0.010080
0.1156 --- loss: 0.897567, loss_ss: 0.874164, loss_d: 0.023403
0.1541 --- loss: 0.592244, loss_ss: 0.555820, loss_d: 0.036424
0.1927 --- loss: 0.818636, loss_ss: 0.811244, loss_d: 0.007392
0.2312 --- loss: 1.165412, loss_ss: 1.163334, loss_d: 0.002078
0.2697 --- loss: 0.772949, loss_ss: 0.752695, loss_d: 0.020254
0.3083 --- loss: 0.572486, loss_ss: 0.532644, loss_d: 0.039842
0.3468 --- loss: 0.678117, loss_ss: 0.610098, loss_d: 0.068020
0.3854 --- loss: 0.867413, loss_ss: 0.739060, loss_d: 0.128353
0.4239 --- loss: 1.193112, loss_ss: 1.161004, loss_d: 0.032108
0.4624 --- loss: 0.663769, loss_ss: 0.616354, loss_d: 0.047415
0.5010 --- loss: 0.809489, loss_ss: 0.705919, loss_d: 0.103571
0.5395 --- loss: 0.912376, loss_ss: 0.866176, loss_d: 0.046200
0.5780 --- loss: 0.747009, loss_ss: 0.736809, loss_d: 0.010200
0.6166 --- loss: 0.821561, loss_ss: 0.730649, loss_d: 0.090912
0.6551 --- loss: 0.880270, loss_ss: 0.877281, loss_d: 0.002989
0.6936 --- loss: 0.994695, loss_ss: 0.787492, loss_d: 0.207203
0.7322 --- loss: 0.740518, loss_ss: 0.661994, loss_d: 0.078524
0.7707 --- loss: 0.932732, loss_ss: 0.916626, loss_d: 0.016106
0.8092 --- loss: 0.818288, loss_ss: 0.800959, loss_d: 0.017329
0.8478 --- loss: 0.682679, loss_ss: 0.669859, loss_d: 0.012820
0.8863 --- loss: 0.789377, loss_ss: 0.778287, loss_d: 0.011090
0.9249 --- loss: 0.775977, loss_ss: 0.745855, loss_d: 0.030122
0.9634 --- loss: 0.623867, loss_ss: 0.614860, loss_d: 0.009007
Epoch finished! Loss: 0.796789131684653
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.737984496124031
             precision    recall  f1-score   support

        0.0       0.88      0.42      0.57        69
        1.0       0.44      0.89      0.59       238
        2.0       0.90      0.90      0.90       565
        3.0       0.96      0.76      0.85       136
        4.0       0.99      0.35      0.52       282

avg / total       0.84      0.74      0.74      1290
 


====== chp005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.59  42.03   99.67  87.88     56.86
1  76.98  89.50   74.14  43.92     58.92
2  91.01  89.56   92.14  89.88     89.72
3  97.21  76.47   99.65  96.30     85.25
4  85.81  35.46   99.90  99.01     52.22
Total accuracy: 73.80%
Average sen: 66.60%
Average spec: 93.10%
Macro f1-score: 68.59%
Diagnosis acc on 15mins: 1.0
[0.99999154 0.99945647 0.99941742 0.99999058 0.99962354 0.99995267
 0.99997842 0.99964988 0.9999764  0.99990058 0.99994695 0.99993336
 0.99983776 0.99997592 0.99998438 0.99998736 0.99998951 0.99996758
 0.99999976 0.99999917 0.99999785 0.99999964 0.99999988 0.99999511
 0.99998736 0.99999988 0.99999511 0.99999475 0.99999917 0.99999857
 0.9999913  0.99992204 0.99846244 0.99999654 0.99999964 0.99999952
 0.99999988 0.99996233 0.99999809 0.99999809 0.99999452 0.99999988
 0.99999976]
pred: 0.9999035028524177, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.507073, loss_ss: 1.791942, loss_d: 0.715131
0.0384 --- loss: 2.096392, loss_ss: 1.546515, loss_d: 0.549877
0.0769 --- loss: 2.375467, loss_ss: 1.632005, loss_d: 0.743463
0.1153 --- loss: 2.199349, loss_ss: 1.595750, loss_d: 0.603599
0.1537 --- loss: 2.373665, loss_ss: 1.811132, loss_d: 0.562533
0.1922 --- loss: 1.853821, loss_ss: 1.353152, loss_d: 0.500669
0.2306 --- loss: 2.126167, loss_ss: 1.533348, loss_d: 0.592819
0.2690 --- loss: 1.725417, loss_ss: 1.219808, loss_d: 0.505609
0.3075 --- loss: 1.704712, loss_ss: 1.220939, loss_d: 0.483772
0.3459 --- loss: 2.010113, loss_ss: 1.496246, loss_d: 0.513866
0.3843 --- loss: 2.067053, loss_ss: 1.515469, loss_d: 0.551585
0.4228 --- loss: 2.281341, loss_ss: 1.361514, loss_d: 0.919827
0.4612 --- loss: 1.950175, loss_ss: 1.416154, loss_d: 0.534021
0.4996 --- loss: 1.727659, loss_ss: 1.117365, loss_d: 0.610294
0.5380 --- loss: 1.977619, loss_ss: 1.433358, loss_d: 0.544261
0.5765 --- loss: 1.784124, loss_ss: 1.291054, loss_d: 0.493069
0.6149 --- loss: 1.981863, loss_ss: 1.305192, loss_d: 0.676671
0.6533 --- loss: 2.102613, loss_ss: 1.422844, loss_d: 0.679769
0.6918 --- loss: 1.947192, loss_ss: 1.248330, loss_d: 0.698862
0.7302 --- loss: 1.796775, loss_ss: 1.294257, loss_d: 0.502519
0.7686 --- loss: 1.697857, loss_ss: 1.114068, loss_d: 0.583789
0.8071 --- loss: 1.762686, loss_ss: 1.338572, loss_d: 0.424114
0.8455 --- loss: 1.510273, loss_ss: 1.133823, loss_d: 0.376451
0.8839 --- loss: 1.408076, loss_ss: 1.085870, loss_d: 0.322206
0.9224 --- loss: 1.853471, loss_ss: 1.333306, loss_d: 0.520165
0.9608 --- loss: 1.265452, loss_ss: 1.024514, loss_d: 0.240938
0.9992 --- loss: 1.385476, loss_ss: 1.238024, loss_d: 0.147452
Epoch finished! Loss: 1.9104419167225177
Starting epoch 2/10.
0.0000 --- loss: 1.764032, loss_ss: 1.332444, loss_d: 0.431588
0.0384 --- loss: 1.625320, loss_ss: 1.337803, loss_d: 0.287518
0.0769 --- loss: 1.461514, loss_ss: 1.067830, loss_d: 0.393683
0.1153 --- loss: 1.524731, loss_ss: 1.123205, loss_d: 0.401526
0.1537 --- loss: 1.442207, loss_ss: 1.137773, loss_d: 0.304434
0.1922 --- loss: 1.484700, loss_ss: 1.386419, loss_d: 0.098281
0.2306 --- loss: 1.130591, loss_ss: 0.959963, loss_d: 0.170628
0.2690 --- loss: 1.337508, loss_ss: 1.103253, loss_d: 0.234255
0.3075 --- loss: 1.335586, loss_ss: 1.112195, loss_d: 0.223392
0.3459 --- loss: 1.312533, loss_ss: 1.218063, loss_d: 0.094470
0.3843 --- loss: 1.563143, loss_ss: 1.027865, loss_d: 0.535278
0.4228 --- loss: 1.070367, loss_ss: 0.928696, loss_d: 0.141671
0.4612 --- loss: 1.044116, loss_ss: 0.933145, loss_d: 0.110972
0.4996 --- loss: 1.599723, loss_ss: 1.101688, loss_d: 0.498035
0.5380 --- loss: 1.338756, loss_ss: 0.988425, loss_d: 0.350331
0.5765 --- loss: 1.859896, loss_ss: 1.057713, loss_d: 0.802183
0.6149 --- loss: 1.291199, loss_ss: 1.163454, loss_d: 0.127745
0.6533 --- loss: 1.400096, loss_ss: 1.236880, loss_d: 0.163217
0.6918 --- loss: 1.363269, loss_ss: 1.056872, loss_d: 0.306397
0.7302 --- loss: 1.485112, loss_ss: 1.120002, loss_d: 0.365110
0.7686 --- loss: 2.159681, loss_ss: 0.968131, loss_d: 1.191550
0.8071 --- loss: 1.541363, loss_ss: 1.156582, loss_d: 0.384781
0.8455 --- loss: 1.449735, loss_ss: 0.913435, loss_d: 0.536300
0.8839 --- loss: 1.523775, loss_ss: 1.099727, loss_d: 0.424048
0.9224 --- loss: 1.581834, loss_ss: 1.017479, loss_d: 0.564355
0.9608 --- loss: 1.128975, loss_ss: 0.920880, loss_d: 0.208094
0.9992 --- loss: 1.453849, loss_ss: 1.048891, loss_d: 0.404958
Epoch finished! Loss: 1.3836654222928562
Starting epoch 3/10.
0.0000 --- loss: 1.165005, loss_ss: 1.085014, loss_d: 0.079991
0.0384 --- loss: 1.343185, loss_ss: 1.191543, loss_d: 0.151643
0.0769 --- loss: 2.123801, loss_ss: 1.073931, loss_d: 1.049871
0.1153 --- loss: 1.316358, loss_ss: 0.988550, loss_d: 0.327808
0.1537 --- loss: 1.594972, loss_ss: 0.834478, loss_d: 0.760494
0.1922 --- loss: 1.424442, loss_ss: 0.821987, loss_d: 0.602454
0.2306 --- loss: 1.149932, loss_ss: 0.916694, loss_d: 0.233239
0.2690 --- loss: 1.112169, loss_ss: 0.908235, loss_d: 0.203934
0.3075 --- loss: 1.094236, loss_ss: 0.916925, loss_d: 0.177311
0.3459 --- loss: 1.216996, loss_ss: 1.141648, loss_d: 0.075348
0.3843 --- loss: 1.269021, loss_ss: 0.776880, loss_d: 0.492141
0.4228 --- loss: 1.326313, loss_ss: 1.175943, loss_d: 0.150371
0.4612 --- loss: 0.898561, loss_ss: 0.754031, loss_d: 0.144530
0.4996 --- loss: 1.154520, loss_ss: 0.919011, loss_d: 0.235510
0.5380 --- loss: 1.160436, loss_ss: 1.069124, loss_d: 0.091312
0.5765 --- loss: 0.996567, loss_ss: 0.833242, loss_d: 0.163325
0.6149 --- loss: 1.060597, loss_ss: 0.913633, loss_d: 0.146964
0.6533 --- loss: 0.975965, loss_ss: 0.702873, loss_d: 0.273092
0.6918 --- loss: 0.972024, loss_ss: 0.637198, loss_d: 0.334826
0.7302 --- loss: 0.984120, loss_ss: 0.905104, loss_d: 0.079015
0.7686 --- loss: 1.479746, loss_ss: 0.823545, loss_d: 0.656201
0.8071 --- loss: 2.095742, loss_ss: 0.792631, loss_d: 1.303112
0.8455 --- loss: 0.884073, loss_ss: 0.769482, loss_d: 0.114592
0.8839 --- loss: 1.211995, loss_ss: 0.877097, loss_d: 0.334898
0.9224 --- loss: 0.915191, loss_ss: 0.692359, loss_d: 0.222833
0.9608 --- loss: 1.058760, loss_ss: 0.958852, loss_d: 0.099908
0.9992 --- loss: 1.764331, loss_ss: 1.668164, loss_d: 0.096168
Epoch finished! Loss: 1.1664847179101063
Starting epoch 4/10.
0.0000 --- loss: 0.949984, loss_ss: 0.822845, loss_d: 0.127139
0.0384 --- loss: 0.876859, loss_ss: 0.659044, loss_d: 0.217815
0.0769 --- loss: 0.974393, loss_ss: 0.798029, loss_d: 0.176364
0.1153 --- loss: 1.081326, loss_ss: 0.894104, loss_d: 0.187223
0.1537 --- loss: 1.207284, loss_ss: 1.149202, loss_d: 0.058082
0.1922 --- loss: 0.980811, loss_ss: 0.801202, loss_d: 0.179609
0.2306 --- loss: 1.327367, loss_ss: 0.970252, loss_d: 0.357115
0.2690 --- loss: 0.957286, loss_ss: 0.699915, loss_d: 0.257371
0.3075 --- loss: 1.068339, loss_ss: 0.912453, loss_d: 0.155886
0.3459 --- loss: 1.185451, loss_ss: 1.085390, loss_d: 0.100061
0.3843 --- loss: 1.318501, loss_ss: 0.970697, loss_d: 0.347804
0.4228 --- loss: 0.751617, loss_ss: 0.678914, loss_d: 0.072703
0.4612 --- loss: 0.887570, loss_ss: 0.653448, loss_d: 0.234122
0.4996 --- loss: 1.146388, loss_ss: 0.900354, loss_d: 0.246035
0.5380 --- loss: 1.249142, loss_ss: 0.701910, loss_d: 0.547232
0.5765 --- loss: 0.870441, loss_ss: 0.803288, loss_d: 0.067153
0.6149 --- loss: 0.854494, loss_ss: 0.767926, loss_d: 0.086568
0.6533 --- loss: 0.580655, loss_ss: 0.550871, loss_d: 0.029785
0.6918 --- loss: 1.850518, loss_ss: 1.050166, loss_d: 0.800352
0.7302 --- loss: 0.776471, loss_ss: 0.763796, loss_d: 0.012675
0.7686 --- loss: 0.833734, loss_ss: 0.619144, loss_d: 0.214589
0.8071 --- loss: 0.912948, loss_ss: 0.885855, loss_d: 0.027093
0.8455 --- loss: 1.041106, loss_ss: 0.864158, loss_d: 0.176949
0.8839 --- loss: 1.460783, loss_ss: 0.744107, loss_d: 0.716676
0.9224 --- loss: 0.957459, loss_ss: 0.676174, loss_d: 0.281285
0.9608 --- loss: 1.229899, loss_ss: 0.699694, loss_d: 0.530205
0.9992 --- loss: 1.165790, loss_ss: 1.114239, loss_d: 0.051551
Epoch finished! Loss: 1.0736093539458054
Starting epoch 5/10.
0.0000 --- loss: 0.853472, loss_ss: 0.714467, loss_d: 0.139005
0.0384 --- loss: 1.122518, loss_ss: 0.656933, loss_d: 0.465585
0.0769 --- loss: 2.151523, loss_ss: 0.705868, loss_d: 1.445656
0.1153 --- loss: 1.016127, loss_ss: 0.687219, loss_d: 0.328908
0.1537 --- loss: 1.227038, loss_ss: 0.669768, loss_d: 0.557270
0.1922 --- loss: 0.959719, loss_ss: 0.829947, loss_d: 0.129772
0.2306 --- loss: 1.340253, loss_ss: 1.066373, loss_d: 0.273880
0.2690 --- loss: 0.793333, loss_ss: 0.715325, loss_d: 0.078009
0.3075 --- loss: 1.048161, loss_ss: 1.018103, loss_d: 0.030058
0.3459 --- loss: 1.286189, loss_ss: 0.915999, loss_d: 0.370190
0.3843 --- loss: 0.872757, loss_ss: 0.718572, loss_d: 0.154185
0.4228 --- loss: 1.155545, loss_ss: 0.992037, loss_d: 0.163508
0.4612 --- loss: 0.608193, loss_ss: 0.488533, loss_d: 0.119660
0.4996 --- loss: 0.857717, loss_ss: 0.761046, loss_d: 0.096670
0.5380 --- loss: 1.052693, loss_ss: 1.012924, loss_d: 0.039769
0.5765 --- loss: 1.119482, loss_ss: 1.065388, loss_d: 0.054094
0.6149 --- loss: 0.715044, loss_ss: 0.685464, loss_d: 0.029580
0.6533 --- loss: 1.351830, loss_ss: 0.911943, loss_d: 0.439887
0.6918 --- loss: 1.225981, loss_ss: 0.778800, loss_d: 0.447181
0.7302 --- loss: 0.886762, loss_ss: 0.778250, loss_d: 0.108511
0.7686 --- loss: 0.574445, loss_ss: 0.550189, loss_d: 0.024256
0.8071 --- loss: 0.629864, loss_ss: 0.524213, loss_d: 0.105651
0.8455 --- loss: 0.902837, loss_ss: 0.784864, loss_d: 0.117973
0.8839 --- loss: 1.260379, loss_ss: 1.121682, loss_d: 0.138697
0.9224 --- loss: 1.130172, loss_ss: 0.910765, loss_d: 0.219407
0.9608 --- loss: 0.755142, loss_ss: 0.722317, loss_d: 0.032826
0.9992 --- loss: 0.812070, loss_ss: 0.798557, loss_d: 0.013513
Epoch finished! Loss: 0.9785862528360807
Starting epoch 6/10.
0.0000 --- loss: 0.789385, loss_ss: 0.711457, loss_d: 0.077928
0.0384 --- loss: 0.773586, loss_ss: 0.750294, loss_d: 0.023292
0.0769 --- loss: 1.045244, loss_ss: 0.699074, loss_d: 0.346170
0.1153 --- loss: 0.948391, loss_ss: 0.680668, loss_d: 0.267723
0.1537 --- loss: 0.782209, loss_ss: 0.747242, loss_d: 0.034968
0.1922 --- loss: 0.568868, loss_ss: 0.541996, loss_d: 0.026872
0.2306 --- loss: 0.661661, loss_ss: 0.571178, loss_d: 0.090484
0.2690 --- loss: 0.859895, loss_ss: 0.656894, loss_d: 0.203001
0.3075 --- loss: 1.413100, loss_ss: 0.914966, loss_d: 0.498134
0.3459 --- loss: 1.189902, loss_ss: 1.008399, loss_d: 0.181504
0.3843 --- loss: 1.085325, loss_ss: 0.854516, loss_d: 0.230808
0.4228 --- loss: 0.835021, loss_ss: 0.776429, loss_d: 0.058593
0.4612 --- loss: 1.101784, loss_ss: 0.930585, loss_d: 0.171199
0.4996 --- loss: 0.827536, loss_ss: 0.734659, loss_d: 0.092876
0.5380 --- loss: 0.997888, loss_ss: 0.779548, loss_d: 0.218339
0.5765 --- loss: 0.907219, loss_ss: 0.830677, loss_d: 0.076542
0.6149 --- loss: 1.427869, loss_ss: 1.096878, loss_d: 0.330991
0.6533 --- loss: 0.919417, loss_ss: 0.848166, loss_d: 0.071251
0.6918 --- loss: 0.933260, loss_ss: 0.608092, loss_d: 0.325169
0.7302 --- loss: 1.045095, loss_ss: 0.858509, loss_d: 0.186586
0.7686 --- loss: 1.458317, loss_ss: 1.284125, loss_d: 0.174192
0.8071 --- loss: 0.577461, loss_ss: 0.535635, loss_d: 0.041827
0.8455 --- loss: 0.867539, loss_ss: 0.752051, loss_d: 0.115487
0.8839 --- loss: 0.889958, loss_ss: 0.822796, loss_d: 0.067162
0.9224 --- loss: 0.883259, loss_ss: 0.842780, loss_d: 0.040480
0.9608 --- loss: 1.540769, loss_ss: 0.619012, loss_d: 0.921757
0.9992 --- loss: 1.140585, loss_ss: 1.092757, loss_d: 0.047828
Epoch finished! Loss: 0.9543734717827577
Starting epoch 7/10.
0.0000 --- loss: 0.736631, loss_ss: 0.716802, loss_d: 0.019829
0.0384 --- loss: 1.355016, loss_ss: 1.242582, loss_d: 0.112434
0.0769 --- loss: 1.245628, loss_ss: 0.834430, loss_d: 0.411198
0.1153 --- loss: 0.811102, loss_ss: 0.699455, loss_d: 0.111647
0.1537 --- loss: 0.923852, loss_ss: 0.915594, loss_d: 0.008258
0.1922 --- loss: 0.806225, loss_ss: 0.779650, loss_d: 0.026575
0.2306 --- loss: 0.786002, loss_ss: 0.737050, loss_d: 0.048951
0.2690 --- loss: 0.774451, loss_ss: 0.757022, loss_d: 0.017429
0.3075 --- loss: 0.610050, loss_ss: 0.523051, loss_d: 0.086999
0.3459 --- loss: 0.562928, loss_ss: 0.547424, loss_d: 0.015504
0.3843 --- loss: 0.841884, loss_ss: 0.764428, loss_d: 0.077456
0.4228 --- loss: 0.713788, loss_ss: 0.663337, loss_d: 0.050451
0.4612 --- loss: 0.919212, loss_ss: 0.816481, loss_d: 0.102730
0.4996 --- loss: 0.808885, loss_ss: 0.725632, loss_d: 0.083253
0.5380 --- loss: 0.975455, loss_ss: 0.786668, loss_d: 0.188786
0.5765 --- loss: 0.847948, loss_ss: 0.772076, loss_d: 0.075872
0.6149 --- loss: 0.868910, loss_ss: 0.723607, loss_d: 0.145304
0.6533 --- loss: 1.049380, loss_ss: 0.962572, loss_d: 0.086809
0.6918 --- loss: 0.792894, loss_ss: 0.575357, loss_d: 0.217537
0.7302 --- loss: 0.872100, loss_ss: 0.766509, loss_d: 0.105591
0.7686 --- loss: 1.171699, loss_ss: 0.698662, loss_d: 0.473037
0.8071 --- loss: 0.806722, loss_ss: 0.712418, loss_d: 0.094305
0.8455 --- loss: 0.522895, loss_ss: 0.502274, loss_d: 0.020621
0.8839 --- loss: 1.222294, loss_ss: 0.793557, loss_d: 0.428737
0.9224 --- loss: 0.742327, loss_ss: 0.596322, loss_d: 0.146006
0.9608 --- loss: 1.062505, loss_ss: 0.900093, loss_d: 0.162412
0.9992 --- loss: 1.138753, loss_ss: 1.054862, loss_d: 0.083891
Epoch finished! Loss: 0.9283524040992444
Starting epoch 8/10.
0.0000 --- loss: 0.583657, loss_ss: 0.539008, loss_d: 0.044649
0.0384 --- loss: 0.655795, loss_ss: 0.606310, loss_d: 0.049485
0.0769 --- loss: 1.049662, loss_ss: 1.013173, loss_d: 0.036489
0.1153 --- loss: 0.983879, loss_ss: 0.857384, loss_d: 0.126495
0.1537 --- loss: 0.905078, loss_ss: 0.777700, loss_d: 0.127378
0.1922 --- loss: 0.777343, loss_ss: 0.772025, loss_d: 0.005317
0.2306 --- loss: 0.693837, loss_ss: 0.671355, loss_d: 0.022482
0.2690 --- loss: 0.987624, loss_ss: 0.977114, loss_d: 0.010510
0.3075 --- loss: 1.050926, loss_ss: 1.031200, loss_d: 0.019726
0.3459 --- loss: 0.978956, loss_ss: 0.957959, loss_d: 0.020997
0.3843 --- loss: 1.301976, loss_ss: 0.557919, loss_d: 0.744057
0.4228 --- loss: 1.193726, loss_ss: 1.152876, loss_d: 0.040850
0.4612 --- loss: 0.977796, loss_ss: 0.771274, loss_d: 0.206522
0.4996 --- loss: 0.844793, loss_ss: 0.751496, loss_d: 0.093296
0.5380 --- loss: 0.812754, loss_ss: 0.661119, loss_d: 0.151635
0.5765 --- loss: 0.663343, loss_ss: 0.611000, loss_d: 0.052344
0.6149 --- loss: 0.575179, loss_ss: 0.503188, loss_d: 0.071990
0.6533 --- loss: 0.711382, loss_ss: 0.626735, loss_d: 0.084647
0.6918 --- loss: 0.864702, loss_ss: 0.846642, loss_d: 0.018060
0.7302 --- loss: 0.801417, loss_ss: 0.711855, loss_d: 0.089561
0.7686 --- loss: 0.938360, loss_ss: 0.824759, loss_d: 0.113602
0.8071 --- loss: 0.682324, loss_ss: 0.668637, loss_d: 0.013687
0.8455 --- loss: 0.686884, loss_ss: 0.672086, loss_d: 0.014798
0.8839 --- loss: 1.030322, loss_ss: 1.010764, loss_d: 0.019558
0.9224 --- loss: 1.303081, loss_ss: 1.157795, loss_d: 0.145286
0.9608 --- loss: 1.007343, loss_ss: 0.614006, loss_d: 0.393337
0.9992 --- loss: 1.728297, loss_ss: 1.722328, loss_d: 0.005969
Epoch finished! Loss: 0.9000346999901991
Starting epoch 9/10.
0.0000 --- loss: 0.442362, loss_ss: 0.419127, loss_d: 0.023235
0.0384 --- loss: 0.889238, loss_ss: 0.866827, loss_d: 0.022411
0.0769 --- loss: 0.686258, loss_ss: 0.581759, loss_d: 0.104499
0.1153 --- loss: 0.796718, loss_ss: 0.640622, loss_d: 0.156095
0.1537 --- loss: 1.493263, loss_ss: 0.725519, loss_d: 0.767744
0.1922 --- loss: 1.174349, loss_ss: 0.786738, loss_d: 0.387611
0.2306 --- loss: 1.194780, loss_ss: 1.164099, loss_d: 0.030681
0.2690 --- loss: 0.643705, loss_ss: 0.573336, loss_d: 0.070369
0.3075 --- loss: 0.776310, loss_ss: 0.737896, loss_d: 0.038414
0.3459 --- loss: 1.273492, loss_ss: 1.039726, loss_d: 0.233766
0.3843 --- loss: 0.719441, loss_ss: 0.702695, loss_d: 0.016746
0.4228 --- loss: 0.763156, loss_ss: 0.760594, loss_d: 0.002562
0.4612 --- loss: 1.065925, loss_ss: 1.057884, loss_d: 0.008041
0.4996 --- loss: 0.981088, loss_ss: 0.937741, loss_d: 0.043346
0.5380 --- loss: 0.935244, loss_ss: 0.931145, loss_d: 0.004099
0.5765 --- loss: 1.141103, loss_ss: 1.124609, loss_d: 0.016494
0.6149 --- loss: 0.728619, loss_ss: 0.722681, loss_d: 0.005939
0.6533 --- loss: 0.847373, loss_ss: 0.802249, loss_d: 0.045124
0.6918 --- loss: 0.677918, loss_ss: 0.482393, loss_d: 0.195524
0.7302 --- loss: 0.691141, loss_ss: 0.449025, loss_d: 0.242116
0.7686 --- loss: 0.879124, loss_ss: 0.755643, loss_d: 0.123481
0.8071 --- loss: 0.882137, loss_ss: 0.833489, loss_d: 0.048648
0.8455 --- loss: 0.807200, loss_ss: 0.751953, loss_d: 0.055248
0.8839 --- loss: 0.673869, loss_ss: 0.642667, loss_d: 0.031202
0.9224 --- loss: 1.256287, loss_ss: 1.089277, loss_d: 0.167010
0.9608 --- loss: 1.009615, loss_ss: 0.664905, loss_d: 0.344710
0.9992 --- loss: 1.237428, loss_ss: 1.235686, loss_d: 0.001742
Epoch finished! Loss: 0.8848429472400592
Starting epoch 10/10.
0.0000 --- loss: 0.812703, loss_ss: 0.804227, loss_d: 0.008476
0.0384 --- loss: 1.323517, loss_ss: 1.310931, loss_d: 0.012586
0.0769 --- loss: 0.696858, loss_ss: 0.684938, loss_d: 0.011920
0.1153 --- loss: 0.737980, loss_ss: 0.707594, loss_d: 0.030386
0.1537 --- loss: 0.514524, loss_ss: 0.446510, loss_d: 0.068014
0.1922 --- loss: 0.859449, loss_ss: 0.795927, loss_d: 0.063522
0.2306 --- loss: 0.806574, loss_ss: 0.622873, loss_d: 0.183701
0.2690 --- loss: 0.584800, loss_ss: 0.555104, loss_d: 0.029696
0.3075 --- loss: 1.009728, loss_ss: 0.993439, loss_d: 0.016288
0.3459 --- loss: 0.790745, loss_ss: 0.638682, loss_d: 0.152063
0.3843 --- loss: 0.691939, loss_ss: 0.680257, loss_d: 0.011682
0.4228 --- loss: 0.805306, loss_ss: 0.792643, loss_d: 0.012662
0.4612 --- loss: 0.920275, loss_ss: 0.778438, loss_d: 0.141837
0.4996 --- loss: 0.765458, loss_ss: 0.736749, loss_d: 0.028708
0.5380 --- loss: 0.753373, loss_ss: 0.739309, loss_d: 0.014063
0.5765 --- loss: 0.430546, loss_ss: 0.379131, loss_d: 0.051415
0.6149 --- loss: 0.973919, loss_ss: 0.802682, loss_d: 0.171237
0.6533 --- loss: 0.853288, loss_ss: 0.792470, loss_d: 0.060818
0.6918 --- loss: 0.903095, loss_ss: 0.899805, loss_d: 0.003290
0.7302 --- loss: 0.760209, loss_ss: 0.698014, loss_d: 0.062195
0.7686 --- loss: 0.795508, loss_ss: 0.342203, loss_d: 0.453305
0.8071 --- loss: 1.680274, loss_ss: 1.416287, loss_d: 0.263987
0.8455 --- loss: 0.953222, loss_ss: 0.928701, loss_d: 0.024520
0.8839 --- loss: 0.782185, loss_ss: 0.747647, loss_d: 0.034538
0.9224 --- loss: 0.786641, loss_ss: 0.777080, loss_d: 0.009561
0.9608 --- loss: 1.008035, loss_ss: 0.988380, loss_d: 0.019656
0.9992 --- loss: 1.893508, loss_ss: 1.841831, loss_d: 0.051677
Epoch finished! Loss: 0.8489193076124558
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5777777777777777
             precision    recall  f1-score   support

        0.0       0.61      0.47      0.53       120
        1.0       0.49      0.45      0.47       322
        2.0       0.49      0.93      0.64       274
        3.0       1.00      0.73      0.85       224
        4.0       1.00      0.01      0.03       140

avg / total       0.67      0.58      0.54      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  90.74  46.67   96.25   60.87     52.83
1  69.35  45.34   79.55   48.50     46.87
2  73.80  93.43   67.12   49.14     64.40
3  94.44  73.21  100.00  100.00     84.54
4  87.22   1.43  100.00  100.00      2.82
Total accuracy: 57.78%
Average sen: 52.02%
Average spec: 88.58%
Macro f1-score: 50.29%
Diagnosis acc on 15mins: 1.0
[1.         1.         0.99998748 0.99970573 0.99998522 1.
 1.         1.         1.         1.         0.99999988 0.99999988
 1.         1.         0.99999928 1.         1.         1.
 0.99999833 0.99999976 0.99999988 1.         1.         1.
 1.         1.         1.         1.         0.99998021 0.99999988
 1.         1.         1.         1.         1.         1.        ]
pred: 0.999990431798829, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.309372, loss_ss: 1.598050, loss_d: 0.711322
0.0385 --- loss: 2.082616, loss_ss: 1.449742, loss_d: 0.632874
0.0769 --- loss: 2.194892, loss_ss: 1.441011, loss_d: 0.753880
0.1154 --- loss: 2.027712, loss_ss: 1.551154, loss_d: 0.476558
0.1538 --- loss: 1.799980, loss_ss: 1.341787, loss_d: 0.458193
0.1923 --- loss: 2.210551, loss_ss: 1.572587, loss_d: 0.637964
0.2308 --- loss: 1.937851, loss_ss: 1.390354, loss_d: 0.547497
0.2692 --- loss: 2.108340, loss_ss: 1.298694, loss_d: 0.809646
0.3077 --- loss: 1.945144, loss_ss: 1.208717, loss_d: 0.736427
0.3462 --- loss: 1.799952, loss_ss: 1.289257, loss_d: 0.510696
0.3846 --- loss: 1.464035, loss_ss: 1.183385, loss_d: 0.280650
0.4231 --- loss: 1.980763, loss_ss: 1.379853, loss_d: 0.600910
0.4615 --- loss: 1.857048, loss_ss: 1.162323, loss_d: 0.694725
0.5000 --- loss: 2.047567, loss_ss: 1.485941, loss_d: 0.561626
0.5385 --- loss: 1.843714, loss_ss: 1.330918, loss_d: 0.512797
0.5769 --- loss: 1.750587, loss_ss: 1.448147, loss_d: 0.302440
0.6154 --- loss: 1.759810, loss_ss: 1.100834, loss_d: 0.658976
0.6538 --- loss: 1.734600, loss_ss: 1.251247, loss_d: 0.483353
0.6923 --- loss: 1.479381, loss_ss: 1.061430, loss_d: 0.417951
0.7308 --- loss: 1.689350, loss_ss: 0.963762, loss_d: 0.725589
0.7692 --- loss: 1.320261, loss_ss: 1.028597, loss_d: 0.291664
0.8077 --- loss: 1.580802, loss_ss: 1.125994, loss_d: 0.454808
0.8462 --- loss: 2.177181, loss_ss: 1.431440, loss_d: 0.745741
0.8846 --- loss: 1.614012, loss_ss: 1.298468, loss_d: 0.315544
0.9231 --- loss: 1.554646, loss_ss: 1.190585, loss_d: 0.364060
0.9615 --- loss: 1.447970, loss_ss: 1.192594, loss_d: 0.255375
Epoch finished! Loss: 1.838305435125432
Starting epoch 2/10.
0.0000 --- loss: 1.410756, loss_ss: 0.968737, loss_d: 0.442019
0.0385 --- loss: 2.075862, loss_ss: 1.228833, loss_d: 0.847029
0.0769 --- loss: 2.059267, loss_ss: 1.264358, loss_d: 0.794908
0.1154 --- loss: 1.598311, loss_ss: 1.290740, loss_d: 0.307571
0.1538 --- loss: 1.507719, loss_ss: 1.271737, loss_d: 0.235981
0.1923 --- loss: 1.326926, loss_ss: 1.090110, loss_d: 0.236816
0.2308 --- loss: 1.570267, loss_ss: 0.894318, loss_d: 0.675949
0.2692 --- loss: 1.170254, loss_ss: 0.807389, loss_d: 0.362865
0.3077 --- loss: 1.720626, loss_ss: 0.861854, loss_d: 0.858772
0.3462 --- loss: 1.303168, loss_ss: 1.026968, loss_d: 0.276200
0.3846 --- loss: 1.363225, loss_ss: 1.070349, loss_d: 0.292875
0.4231 --- loss: 1.619582, loss_ss: 1.084377, loss_d: 0.535205
0.4615 --- loss: 1.475912, loss_ss: 1.056265, loss_d: 0.419646
0.5000 --- loss: 1.738717, loss_ss: 1.136670, loss_d: 0.602047
0.5385 --- loss: 1.143809, loss_ss: 0.863088, loss_d: 0.280721
0.5769 --- loss: 1.514914, loss_ss: 1.139497, loss_d: 0.375417
0.6154 --- loss: 1.362261, loss_ss: 0.961651, loss_d: 0.400610
0.6538 --- loss: 1.239366, loss_ss: 1.062436, loss_d: 0.176929
0.6923 --- loss: 1.127356, loss_ss: 0.978698, loss_d: 0.148658
0.7308 --- loss: 1.123372, loss_ss: 0.879905, loss_d: 0.243468
0.7692 --- loss: 1.177767, loss_ss: 1.044165, loss_d: 0.133602
0.8077 --- loss: 1.493541, loss_ss: 1.132397, loss_d: 0.361144
0.8462 --- loss: 1.036619, loss_ss: 0.911718, loss_d: 0.124901
0.8846 --- loss: 1.977207, loss_ss: 1.212209, loss_d: 0.764998
0.9231 --- loss: 1.299531, loss_ss: 1.227052, loss_d: 0.072479
0.9615 --- loss: 1.230453, loss_ss: 1.079466, loss_d: 0.150987
Epoch finished! Loss: 1.390823245048523
Starting epoch 3/10.
0.0000 --- loss: 0.960270, loss_ss: 0.824255, loss_d: 0.136014
0.0385 --- loss: 1.262449, loss_ss: 1.180403, loss_d: 0.082046
0.0769 --- loss: 1.826588, loss_ss: 0.987703, loss_d: 0.838885
0.1154 --- loss: 1.293622, loss_ss: 0.775675, loss_d: 0.517947
0.1538 --- loss: 1.237189, loss_ss: 1.085611, loss_d: 0.151578
0.1923 --- loss: 1.348588, loss_ss: 0.958863, loss_d: 0.389726
0.2308 --- loss: 1.578740, loss_ss: 1.189378, loss_d: 0.389362
0.2692 --- loss: 0.955260, loss_ss: 0.699715, loss_d: 0.255544
0.3077 --- loss: 0.885526, loss_ss: 0.818389, loss_d: 0.067137
0.3462 --- loss: 1.072301, loss_ss: 0.894199, loss_d: 0.178102
0.3846 --- loss: 0.984423, loss_ss: 0.717773, loss_d: 0.266650
0.4231 --- loss: 1.504544, loss_ss: 1.186856, loss_d: 0.317687
0.4615 --- loss: 1.029828, loss_ss: 0.908740, loss_d: 0.121088
0.5000 --- loss: 1.414083, loss_ss: 0.994832, loss_d: 0.419250
0.5385 --- loss: 0.964558, loss_ss: 0.823259, loss_d: 0.141300
0.5769 --- loss: 1.114170, loss_ss: 0.753950, loss_d: 0.360220
0.6154 --- loss: 1.486669, loss_ss: 1.290956, loss_d: 0.195713
0.6538 --- loss: 1.446511, loss_ss: 1.029786, loss_d: 0.416725
0.6923 --- loss: 1.309288, loss_ss: 1.181551, loss_d: 0.127737
0.7308 --- loss: 1.034783, loss_ss: 0.973093, loss_d: 0.061690
0.7692 --- loss: 1.140589, loss_ss: 0.955005, loss_d: 0.185584
0.8077 --- loss: 1.665939, loss_ss: 1.378955, loss_d: 0.286984
0.8462 --- loss: 0.997914, loss_ss: 0.844571, loss_d: 0.153343
0.8846 --- loss: 0.967627, loss_ss: 0.927519, loss_d: 0.040107
0.9231 --- loss: 1.057054, loss_ss: 0.802379, loss_d: 0.254676
0.9615 --- loss: 1.091875, loss_ss: 0.959038, loss_d: 0.132837
Epoch finished! Loss: 1.204330962827307
Starting epoch 4/10.
0.0000 --- loss: 1.371132, loss_ss: 1.142356, loss_d: 0.228776
0.0385 --- loss: 1.005183, loss_ss: 0.674464, loss_d: 0.330719
0.0769 --- loss: 1.634168, loss_ss: 1.273341, loss_d: 0.360826
0.1154 --- loss: 1.677526, loss_ss: 0.849231, loss_d: 0.828296
0.1538 --- loss: 0.873526, loss_ss: 0.787473, loss_d: 0.086053
0.1923 --- loss: 1.159051, loss_ss: 1.056706, loss_d: 0.102345
0.2308 --- loss: 0.967204, loss_ss: 0.818148, loss_d: 0.149056
0.2692 --- loss: 1.363622, loss_ss: 0.837475, loss_d: 0.526148
0.3077 --- loss: 1.133078, loss_ss: 0.691215, loss_d: 0.441863
0.3462 --- loss: 1.189972, loss_ss: 0.661200, loss_d: 0.528773
0.3846 --- loss: 1.083737, loss_ss: 0.810314, loss_d: 0.273423
0.4231 --- loss: 0.975142, loss_ss: 0.817217, loss_d: 0.157925
0.4615 --- loss: 0.921063, loss_ss: 0.757783, loss_d: 0.163280
0.5000 --- loss: 1.035584, loss_ss: 0.901390, loss_d: 0.134194
0.5385 --- loss: 0.974409, loss_ss: 0.866157, loss_d: 0.108252
0.5769 --- loss: 0.729904, loss_ss: 0.654112, loss_d: 0.075792
0.6154 --- loss: 1.022369, loss_ss: 0.819107, loss_d: 0.203262
0.6538 --- loss: 1.213355, loss_ss: 1.148491, loss_d: 0.064864
0.6923 --- loss: 1.964908, loss_ss: 0.946372, loss_d: 1.018536
0.7308 --- loss: 0.917911, loss_ss: 0.747095, loss_d: 0.170817
0.7692 --- loss: 0.694165, loss_ss: 0.645138, loss_d: 0.049027
0.8077 --- loss: 1.124866, loss_ss: 1.088258, loss_d: 0.036609
0.8462 --- loss: 0.790914, loss_ss: 0.562526, loss_d: 0.228388
0.8846 --- loss: 0.621029, loss_ss: 0.534319, loss_d: 0.086710
0.9231 --- loss: 0.941167, loss_ss: 0.778562, loss_d: 0.162605
0.9615 --- loss: 1.252840, loss_ss: 1.181226, loss_d: 0.071614
Epoch finished! Loss: 1.076729160938484
Starting epoch 5/10.
0.0000 --- loss: 1.344481, loss_ss: 0.946642, loss_d: 0.397839
0.0385 --- loss: 1.104428, loss_ss: 1.060934, loss_d: 0.043494
0.0769 --- loss: 1.340196, loss_ss: 1.007861, loss_d: 0.332335
0.1154 --- loss: 1.092448, loss_ss: 0.870210, loss_d: 0.222238
0.1538 --- loss: 1.133387, loss_ss: 1.056201, loss_d: 0.077186
0.1923 --- loss: 0.912499, loss_ss: 0.835459, loss_d: 0.077040
0.2308 --- loss: 0.982655, loss_ss: 0.823370, loss_d: 0.159286
0.2692 --- loss: 1.128356, loss_ss: 0.683961, loss_d: 0.444395
0.3077 --- loss: 1.313186, loss_ss: 0.999920, loss_d: 0.313266
0.3462 --- loss: 1.017752, loss_ss: 0.884865, loss_d: 0.132887
0.3846 --- loss: 0.815583, loss_ss: 0.756880, loss_d: 0.058703
0.4231 --- loss: 1.463008, loss_ss: 0.871733, loss_d: 0.591275
0.4615 --- loss: 0.940177, loss_ss: 0.833137, loss_d: 0.107039
0.5000 --- loss: 1.271559, loss_ss: 0.804219, loss_d: 0.467340
0.5385 --- loss: 0.768701, loss_ss: 0.594266, loss_d: 0.174435
0.5769 --- loss: 0.984796, loss_ss: 0.943305, loss_d: 0.041492
0.6154 --- loss: 0.770877, loss_ss: 0.622391, loss_d: 0.148486
0.6538 --- loss: 0.858297, loss_ss: 0.683758, loss_d: 0.174539
0.6923 --- loss: 0.898186, loss_ss: 0.815301, loss_d: 0.082885
0.7308 --- loss: 0.777211, loss_ss: 0.763638, loss_d: 0.013572
0.7692 --- loss: 0.796411, loss_ss: 0.631911, loss_d: 0.164500
0.8077 --- loss: 0.924645, loss_ss: 0.782412, loss_d: 0.142233
0.8462 --- loss: 0.754107, loss_ss: 0.551543, loss_d: 0.202564
0.8846 --- loss: 1.009845, loss_ss: 0.975803, loss_d: 0.034043
0.9231 --- loss: 0.840161, loss_ss: 0.621385, loss_d: 0.218776
0.9615 --- loss: 0.891981, loss_ss: 0.765387, loss_d: 0.126593
Epoch finished! Loss: 1.0161551823947421
Starting epoch 6/10.
0.0000 --- loss: 0.779288, loss_ss: 0.674709, loss_d: 0.104579
0.0385 --- loss: 0.698378, loss_ss: 0.544093, loss_d: 0.154285
0.0769 --- loss: 0.927607, loss_ss: 0.854509, loss_d: 0.073098
0.1154 --- loss: 1.081194, loss_ss: 0.962364, loss_d: 0.118830
0.1538 --- loss: 1.058697, loss_ss: 0.794775, loss_d: 0.263922
0.1923 --- loss: 0.961192, loss_ss: 0.914279, loss_d: 0.046913
0.2308 --- loss: 0.862628, loss_ss: 0.683511, loss_d: 0.179117
0.2692 --- loss: 0.673158, loss_ss: 0.612703, loss_d: 0.060455
0.3077 --- loss: 0.861987, loss_ss: 0.824868, loss_d: 0.037119
0.3462 --- loss: 0.905107, loss_ss: 0.817434, loss_d: 0.087674
0.3846 --- loss: 0.916531, loss_ss: 0.839100, loss_d: 0.077431
0.4231 --- loss: 0.964168, loss_ss: 0.922250, loss_d: 0.041918
0.4615 --- loss: 0.862483, loss_ss: 0.781011, loss_d: 0.081472
0.5000 --- loss: 1.029212, loss_ss: 0.844939, loss_d: 0.184272
0.5385 --- loss: 1.413117, loss_ss: 0.991487, loss_d: 0.421630
0.5769 --- loss: 0.970727, loss_ss: 0.838368, loss_d: 0.132359
0.6154 --- loss: 1.931446, loss_ss: 1.311253, loss_d: 0.620193
0.6538 --- loss: 1.175326, loss_ss: 1.042391, loss_d: 0.132934
0.6923 --- loss: 0.788293, loss_ss: 0.769131, loss_d: 0.019163
0.7308 --- loss: 0.874321, loss_ss: 0.739045, loss_d: 0.135276
0.7692 --- loss: 0.638707, loss_ss: 0.627669, loss_d: 0.011038
0.8077 --- loss: 0.876580, loss_ss: 0.793870, loss_d: 0.082709
0.8462 --- loss: 1.199714, loss_ss: 0.767819, loss_d: 0.431895
0.8846 --- loss: 0.570923, loss_ss: 0.465548, loss_d: 0.105375
0.9231 --- loss: 0.975817, loss_ss: 0.765653, loss_d: 0.210164
0.9615 --- loss: 0.989540, loss_ss: 0.965073, loss_d: 0.024467
Epoch finished! Loss: 0.9499843928344461
Starting epoch 7/10.
0.0000 --- loss: 0.740269, loss_ss: 0.683927, loss_d: 0.056342
0.0385 --- loss: 1.042842, loss_ss: 0.787219, loss_d: 0.255623
0.0769 --- loss: 0.786111, loss_ss: 0.694033, loss_d: 0.092077
0.1154 --- loss: 1.269887, loss_ss: 0.742631, loss_d: 0.527256
0.1538 --- loss: 1.212371, loss_ss: 1.185033, loss_d: 0.027338
0.1923 --- loss: 1.121514, loss_ss: 1.093863, loss_d: 0.027651
0.2308 --- loss: 0.826796, loss_ss: 0.713002, loss_d: 0.113793
0.2692 --- loss: 1.176068, loss_ss: 1.036856, loss_d: 0.139212
0.3077 --- loss: 0.752751, loss_ss: 0.735207, loss_d: 0.017544
0.3462 --- loss: 0.872172, loss_ss: 0.649294, loss_d: 0.222877
0.3846 --- loss: 0.752108, loss_ss: 0.689984, loss_d: 0.062124
0.4231 --- loss: 0.863260, loss_ss: 0.816710, loss_d: 0.046550
0.4615 --- loss: 0.685866, loss_ss: 0.609037, loss_d: 0.076828
0.5000 --- loss: 1.310562, loss_ss: 0.801230, loss_d: 0.509332
0.5385 --- loss: 0.909112, loss_ss: 0.873744, loss_d: 0.035367
0.5769 --- loss: 0.781353, loss_ss: 0.753154, loss_d: 0.028200
0.6154 --- loss: 0.749479, loss_ss: 0.578717, loss_d: 0.170762
0.6538 --- loss: 1.090869, loss_ss: 0.614472, loss_d: 0.476397
0.6923 --- loss: 0.954723, loss_ss: 0.901986, loss_d: 0.052738
0.7308 --- loss: 0.633078, loss_ss: 0.513104, loss_d: 0.119973
0.7692 --- loss: 1.218311, loss_ss: 1.074835, loss_d: 0.143475
0.8077 --- loss: 0.885408, loss_ss: 0.686951, loss_d: 0.198457
0.8462 --- loss: 0.602546, loss_ss: 0.488885, loss_d: 0.113661
0.8846 --- loss: 0.751395, loss_ss: 0.738932, loss_d: 0.012463
0.9231 --- loss: 0.809052, loss_ss: 0.736381, loss_d: 0.072672
0.9615 --- loss: 1.084558, loss_ss: 1.036844, loss_d: 0.047714
Epoch finished! Loss: 0.9428696047845494
Starting epoch 8/10.
0.0000 --- loss: 1.256464, loss_ss: 1.170581, loss_d: 0.085883
0.0385 --- loss: 0.617183, loss_ss: 0.526151, loss_d: 0.091032
0.0769 --- loss: 0.832988, loss_ss: 0.416784, loss_d: 0.416204
0.1154 --- loss: 0.823748, loss_ss: 0.616431, loss_d: 0.207317
0.1538 --- loss: 1.032259, loss_ss: 0.907047, loss_d: 0.125211
0.1923 --- loss: 0.702617, loss_ss: 0.638642, loss_d: 0.063975
0.2308 --- loss: 1.090862, loss_ss: 0.550059, loss_d: 0.540803
0.2692 --- loss: 0.784219, loss_ss: 0.725207, loss_d: 0.059012
0.3077 --- loss: 0.892980, loss_ss: 0.804756, loss_d: 0.088225
0.3462 --- loss: 0.753312, loss_ss: 0.720114, loss_d: 0.033198
0.3846 --- loss: 0.724442, loss_ss: 0.674436, loss_d: 0.050006
0.4231 --- loss: 0.774537, loss_ss: 0.720387, loss_d: 0.054150
0.4615 --- loss: 0.810458, loss_ss: 0.673869, loss_d: 0.136589
0.5000 --- loss: 0.732916, loss_ss: 0.715182, loss_d: 0.017734
0.5385 --- loss: 0.580652, loss_ss: 0.565516, loss_d: 0.015136
0.5769 --- loss: 1.029820, loss_ss: 0.861455, loss_d: 0.168366
0.6154 --- loss: 0.778585, loss_ss: 0.551008, loss_d: 0.227577
0.6538 --- loss: 0.735965, loss_ss: 0.606343, loss_d: 0.129622
0.6923 --- loss: 0.534957, loss_ss: 0.503376, loss_d: 0.031581
0.7308 --- loss: 0.628408, loss_ss: 0.594133, loss_d: 0.034275
0.7692 --- loss: 0.844686, loss_ss: 0.757427, loss_d: 0.087259
0.8077 --- loss: 0.705385, loss_ss: 0.649569, loss_d: 0.055815
0.8462 --- loss: 0.905851, loss_ss: 0.854011, loss_d: 0.051840
0.8846 --- loss: 1.043630, loss_ss: 0.765793, loss_d: 0.277837
0.9231 --- loss: 1.003092, loss_ss: 0.950217, loss_d: 0.052875
0.9615 --- loss: 0.830113, loss_ss: 0.748673, loss_d: 0.081441
Epoch finished! Loss: 0.8732793354159617
Starting epoch 9/10.
0.0000 --- loss: 0.848210, loss_ss: 0.772600, loss_d: 0.075610
0.0385 --- loss: 0.724563, loss_ss: 0.696726, loss_d: 0.027837
0.0769 --- loss: 0.617037, loss_ss: 0.599212, loss_d: 0.017825
0.1154 --- loss: 1.111183, loss_ss: 1.098323, loss_d: 0.012860
0.1538 --- loss: 0.660787, loss_ss: 0.571817, loss_d: 0.088970
0.1923 --- loss: 1.374831, loss_ss: 0.970407, loss_d: 0.404424
0.2308 --- loss: 0.718401, loss_ss: 0.654319, loss_d: 0.064083
0.2692 --- loss: 0.570984, loss_ss: 0.553905, loss_d: 0.017079
0.3077 --- loss: 0.664581, loss_ss: 0.609671, loss_d: 0.054911
0.3462 --- loss: 0.611874, loss_ss: 0.559576, loss_d: 0.052298
0.3846 --- loss: 0.836696, loss_ss: 0.800760, loss_d: 0.035937
0.4231 --- loss: 0.460783, loss_ss: 0.457843, loss_d: 0.002940
0.4615 --- loss: 0.902160, loss_ss: 0.815127, loss_d: 0.087033
0.5000 --- loss: 1.028900, loss_ss: 0.790772, loss_d: 0.238127
0.5385 --- loss: 1.123525, loss_ss: 1.040382, loss_d: 0.083143
0.5769 --- loss: 0.826456, loss_ss: 0.779705, loss_d: 0.046751
0.6154 --- loss: 0.857627, loss_ss: 0.738471, loss_d: 0.119156
0.6538 --- loss: 0.562847, loss_ss: 0.534494, loss_d: 0.028354
0.6923 --- loss: 0.729946, loss_ss: 0.722294, loss_d: 0.007652
0.7308 --- loss: 0.870235, loss_ss: 0.868953, loss_d: 0.001281
0.7692 --- loss: 0.630111, loss_ss: 0.590146, loss_d: 0.039965
0.8077 --- loss: 1.117981, loss_ss: 0.838232, loss_d: 0.279748
0.8462 --- loss: 0.977857, loss_ss: 0.653842, loss_d: 0.324015
0.8846 --- loss: 1.103002, loss_ss: 0.747377, loss_d: 0.355626
0.9231 --- loss: 1.293980, loss_ss: 0.846117, loss_d: 0.447863
0.9615 --- loss: 1.119747, loss_ss: 0.971701, loss_d: 0.148046
Epoch finished! Loss: 0.8496550142074644
Starting epoch 10/10.
0.0000 --- loss: 0.986028, loss_ss: 0.579359, loss_d: 0.406669
0.0385 --- loss: 0.901570, loss_ss: 0.811370, loss_d: 0.090201
0.0769 --- loss: 0.800041, loss_ss: 0.786396, loss_d: 0.013646
0.1154 --- loss: 1.008616, loss_ss: 0.836714, loss_d: 0.171902
0.1538 --- loss: 0.800173, loss_ss: 0.489172, loss_d: 0.311001
0.1923 --- loss: 0.803523, loss_ss: 0.625714, loss_d: 0.177809
0.2308 --- loss: 0.812876, loss_ss: 0.554362, loss_d: 0.258513
0.2692 --- loss: 0.789184, loss_ss: 0.786497, loss_d: 0.002688
0.3077 --- loss: 0.736386, loss_ss: 0.654849, loss_d: 0.081537
0.3462 --- loss: 0.605947, loss_ss: 0.598429, loss_d: 0.007517
0.3846 --- loss: 0.575565, loss_ss: 0.508831, loss_d: 0.066734
0.4231 --- loss: 0.936420, loss_ss: 0.873780, loss_d: 0.062640
0.4615 --- loss: 1.539498, loss_ss: 1.117974, loss_d: 0.421524
0.5000 --- loss: 0.816567, loss_ss: 0.739509, loss_d: 0.077058
0.5385 --- loss: 0.995374, loss_ss: 0.967009, loss_d: 0.028365
0.5769 --- loss: 1.068835, loss_ss: 0.952544, loss_d: 0.116290
0.6154 --- loss: 0.724259, loss_ss: 0.642923, loss_d: 0.081336
0.6538 --- loss: 0.613338, loss_ss: 0.571692, loss_d: 0.041646
0.6923 --- loss: 1.193767, loss_ss: 0.700204, loss_d: 0.493564
0.7308 --- loss: 0.662528, loss_ss: 0.648135, loss_d: 0.014393
0.7692 --- loss: 1.054850, loss_ss: 0.711264, loss_d: 0.343586
0.8077 --- loss: 1.168555, loss_ss: 1.061029, loss_d: 0.107526
0.8462 --- loss: 0.750756, loss_ss: 0.731316, loss_d: 0.019440
0.8846 --- loss: 0.846759, loss_ss: 0.829903, loss_d: 0.016856
0.9231 --- loss: 0.699232, loss_ss: 0.648780, loss_d: 0.050452
0.9615 --- loss: 0.529653, loss_ss: 0.492781, loss_d: 0.036872
Epoch finished! Loss: 0.8353073321944499
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6903508771929825
             precision    recall  f1-score   support

        0.0       0.83      0.67      0.74       166
        1.0       0.17      0.31      0.22        58
        2.0       0.62      0.86      0.72       397
        3.0       0.82      0.96      0.89       165
        4.0       0.99      0.44      0.61       354

avg / total       0.77      0.69      0.69      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.16  66.87   97.64  82.84     74.00
1  88.95  31.03   92.05  17.31     22.22
2  77.11  86.40   72.14  62.36     72.44
3  96.40  96.36   96.41  81.96     88.58
4  82.46  44.07   99.75  98.73     60.94
Total accuracy: 69.04%
Average sen: 64.95%
Average spec: 91.60%
Macro f1-score: 63.64%
Diagnosis acc on 15mins: 1.0
[0.9999913  0.99999976 1.         0.99999905 0.99993992 0.9999522
 0.99999952 0.99999595 0.99176639 0.99998152 0.9999975  0.99999714
 0.99999964 0.99999988 0.99999964 0.99999988 0.99999595 0.99987829
 0.99999428 0.99999809 0.9999994  0.99999273 0.99996412 0.99999821
 0.99999976 0.99999976 0.99999464 0.99996138 0.99999905 0.99999547
 0.99999678 0.99999654 0.99966598 0.9987061  0.99999785 0.99999428
 0.99999726 0.99999952]
pred: 0.9997301242853466, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.305750, loss_ss: 1.530939, loss_d: 0.774811
0.0384 --- loss: 2.129557, loss_ss: 1.468892, loss_d: 0.660665
0.0767 --- loss: 1.992682, loss_ss: 1.421925, loss_d: 0.570757
0.1151 --- loss: 2.376935, loss_ss: 1.460762, loss_d: 0.916173
0.1534 --- loss: 1.978727, loss_ss: 1.395553, loss_d: 0.583174
0.1918 --- loss: 2.043465, loss_ss: 1.436646, loss_d: 0.606820
0.2301 --- loss: 1.550916, loss_ss: 1.309568, loss_d: 0.241348
0.2685 --- loss: 2.097845, loss_ss: 1.305071, loss_d: 0.792773
0.3069 --- loss: 1.873669, loss_ss: 1.253826, loss_d: 0.619843
0.3452 --- loss: 1.886882, loss_ss: 1.177445, loss_d: 0.709437
0.3836 --- loss: 1.619545, loss_ss: 1.125379, loss_d: 0.494166
0.4219 --- loss: 1.875413, loss_ss: 1.330980, loss_d: 0.544433
0.4603 --- loss: 1.483991, loss_ss: 1.155690, loss_d: 0.328301
0.4987 --- loss: 1.887555, loss_ss: 1.218761, loss_d: 0.668795
0.5370 --- loss: 1.808179, loss_ss: 1.302326, loss_d: 0.505852
0.5754 --- loss: 1.444301, loss_ss: 1.154965, loss_d: 0.289337
0.6137 --- loss: 1.918845, loss_ss: 1.314281, loss_d: 0.604564
0.6521 --- loss: 2.056408, loss_ss: 1.359423, loss_d: 0.696985
0.6904 --- loss: 1.639238, loss_ss: 1.294175, loss_d: 0.345063
0.7288 --- loss: 1.675542, loss_ss: 1.301021, loss_d: 0.374521
0.7672 --- loss: 1.695403, loss_ss: 1.260473, loss_d: 0.434930
0.8055 --- loss: 2.057009, loss_ss: 0.938766, loss_d: 1.118243
0.8439 --- loss: 1.715139, loss_ss: 1.194568, loss_d: 0.520571
0.8822 --- loss: 1.685366, loss_ss: 1.407535, loss_d: 0.277830
0.9206 --- loss: 1.206576, loss_ss: 1.060739, loss_d: 0.145836
0.9590 --- loss: 1.368985, loss_ss: 0.970601, loss_d: 0.398384
0.9973 --- loss: 1.249378, loss_ss: 0.964989, loss_d: 0.284388
Epoch finished! Loss: 1.8075136501055498
Starting epoch 2/10.
0.0000 --- loss: 1.245176, loss_ss: 0.940475, loss_d: 0.304701
0.0384 --- loss: 1.244337, loss_ss: 0.984043, loss_d: 0.260294
0.0767 --- loss: 1.579558, loss_ss: 1.006281, loss_d: 0.573277
0.1151 --- loss: 1.326120, loss_ss: 0.989603, loss_d: 0.336517
0.1534 --- loss: 1.410964, loss_ss: 1.066398, loss_d: 0.344565
0.1918 --- loss: 1.725533, loss_ss: 0.824806, loss_d: 0.900726
0.2301 --- loss: 1.331457, loss_ss: 0.979188, loss_d: 0.352268
0.2685 --- loss: 1.340544, loss_ss: 1.052720, loss_d: 0.287824
0.3069 --- loss: 1.405418, loss_ss: 0.950927, loss_d: 0.454491
0.3452 --- loss: 1.463998, loss_ss: 1.190318, loss_d: 0.273680
0.3836 --- loss: 1.579532, loss_ss: 1.112893, loss_d: 0.466638
0.4219 --- loss: 1.127522, loss_ss: 0.957427, loss_d: 0.170095
0.4603 --- loss: 1.452743, loss_ss: 1.239862, loss_d: 0.212881
0.4987 --- loss: 1.214725, loss_ss: 1.076766, loss_d: 0.137959
0.5370 --- loss: 1.446966, loss_ss: 1.283499, loss_d: 0.163467
0.5754 --- loss: 1.210952, loss_ss: 1.008557, loss_d: 0.202395
0.6137 --- loss: 1.195705, loss_ss: 1.158474, loss_d: 0.037231
0.6521 --- loss: 1.784849, loss_ss: 1.149358, loss_d: 0.635491
0.6904 --- loss: 1.136704, loss_ss: 0.886992, loss_d: 0.249712
0.7288 --- loss: 1.152511, loss_ss: 0.845702, loss_d: 0.306809
0.7672 --- loss: 1.338738, loss_ss: 0.995127, loss_d: 0.343612
0.8055 --- loss: 1.158859, loss_ss: 0.971247, loss_d: 0.187611
0.8439 --- loss: 1.136526, loss_ss: 1.044858, loss_d: 0.091668
0.8822 --- loss: 1.165264, loss_ss: 0.849482, loss_d: 0.315782
0.9206 --- loss: 1.645150, loss_ss: 0.939695, loss_d: 0.705456
0.9590 --- loss: 1.231085, loss_ss: 1.046929, loss_d: 0.184156
0.9973 --- loss: 1.444518, loss_ss: 1.348083, loss_d: 0.096435
Epoch finished! Loss: 1.3263304964854168
Starting epoch 3/10.
0.0000 --- loss: 1.325448, loss_ss: 1.000731, loss_d: 0.324716
0.0384 --- loss: 1.170864, loss_ss: 0.809268, loss_d: 0.361596
0.0767 --- loss: 0.955730, loss_ss: 0.768340, loss_d: 0.187390
0.1151 --- loss: 0.823232, loss_ss: 0.764907, loss_d: 0.058325
0.1534 --- loss: 0.895916, loss_ss: 0.722198, loss_d: 0.173718
0.1918 --- loss: 1.009834, loss_ss: 0.668470, loss_d: 0.341365
0.2301 --- loss: 1.135707, loss_ss: 0.953639, loss_d: 0.182068
0.2685 --- loss: 1.349352, loss_ss: 0.963615, loss_d: 0.385737
0.3069 --- loss: 1.518705, loss_ss: 1.444498, loss_d: 0.074208
0.3452 --- loss: 1.227891, loss_ss: 0.994834, loss_d: 0.233057
0.3836 --- loss: 1.230999, loss_ss: 0.893365, loss_d: 0.337634
0.4219 --- loss: 0.982619, loss_ss: 0.808587, loss_d: 0.174032
0.4603 --- loss: 1.110091, loss_ss: 0.877848, loss_d: 0.232243
0.4987 --- loss: 1.391506, loss_ss: 1.126446, loss_d: 0.265060
0.5370 --- loss: 1.042978, loss_ss: 0.886615, loss_d: 0.156363
0.5754 --- loss: 1.164200, loss_ss: 1.070529, loss_d: 0.093671
0.6137 --- loss: 1.539182, loss_ss: 1.096032, loss_d: 0.443151
0.6521 --- loss: 1.240369, loss_ss: 1.137304, loss_d: 0.103065
0.6904 --- loss: 1.154190, loss_ss: 0.939468, loss_d: 0.214721
0.7288 --- loss: 1.417470, loss_ss: 1.162839, loss_d: 0.254631
0.7672 --- loss: 1.171344, loss_ss: 1.103402, loss_d: 0.067942
0.8055 --- loss: 1.274287, loss_ss: 1.137222, loss_d: 0.137064
0.8439 --- loss: 1.529923, loss_ss: 1.331141, loss_d: 0.198781
0.8822 --- loss: 0.954536, loss_ss: 0.859731, loss_d: 0.094805
0.9206 --- loss: 1.407642, loss_ss: 0.934484, loss_d: 0.473158
0.9590 --- loss: 0.819899, loss_ss: 0.653913, loss_d: 0.165986
0.9973 --- loss: 1.116629, loss_ss: 1.058587, loss_d: 0.058042
Epoch finished! Loss: 1.1650812967465474
Starting epoch 4/10.
0.0000 --- loss: 0.771818, loss_ss: 0.683155, loss_d: 0.088663
0.0384 --- loss: 1.160155, loss_ss: 1.062864, loss_d: 0.097290
0.0767 --- loss: 1.521975, loss_ss: 1.369401, loss_d: 0.152574
0.1151 --- loss: 1.332002, loss_ss: 1.150996, loss_d: 0.181006
0.1534 --- loss: 0.814481, loss_ss: 0.686748, loss_d: 0.127734
0.1918 --- loss: 1.367735, loss_ss: 1.106395, loss_d: 0.261340
0.2301 --- loss: 0.806703, loss_ss: 0.758877, loss_d: 0.047826
0.2685 --- loss: 0.983914, loss_ss: 0.867996, loss_d: 0.115918
0.3069 --- loss: 0.762611, loss_ss: 0.682452, loss_d: 0.080158
0.3452 --- loss: 0.944382, loss_ss: 0.835482, loss_d: 0.108900
0.3836 --- loss: 1.062709, loss_ss: 1.031431, loss_d: 0.031278
0.4219 --- loss: 1.706003, loss_ss: 1.143764, loss_d: 0.562239
0.4603 --- loss: 1.275543, loss_ss: 1.055637, loss_d: 0.219907
0.4987 --- loss: 1.029063, loss_ss: 0.948897, loss_d: 0.080166
0.5370 --- loss: 1.516899, loss_ss: 1.342106, loss_d: 0.174794
0.5754 --- loss: 1.455819, loss_ss: 1.124062, loss_d: 0.331757
0.6137 --- loss: 1.090989, loss_ss: 1.026358, loss_d: 0.064631
0.6521 --- loss: 1.313247, loss_ss: 1.286103, loss_d: 0.027144
0.6904 --- loss: 1.242277, loss_ss: 1.072916, loss_d: 0.169361
0.7288 --- loss: 1.009824, loss_ss: 0.672472, loss_d: 0.337352
0.7672 --- loss: 1.200832, loss_ss: 0.873245, loss_d: 0.327586
0.8055 --- loss: 1.238064, loss_ss: 0.867455, loss_d: 0.370609
0.8439 --- loss: 0.786439, loss_ss: 0.717826, loss_d: 0.068613
0.8822 --- loss: 1.167002, loss_ss: 0.873752, loss_d: 0.293250
0.9206 --- loss: 0.925604, loss_ss: 0.788849, loss_d: 0.136756
0.9590 --- loss: 0.978763, loss_ss: 0.927164, loss_d: 0.051599
0.9973 --- loss: 1.052397, loss_ss: 0.917358, loss_d: 0.135039
Epoch finished! Loss: 1.0919191050987977
Starting epoch 5/10.
0.0000 --- loss: 0.829179, loss_ss: 0.742262, loss_d: 0.086916
0.0384 --- loss: 0.920546, loss_ss: 0.861435, loss_d: 0.059111
0.0767 --- loss: 0.963818, loss_ss: 0.719219, loss_d: 0.244599
0.1151 --- loss: 0.768045, loss_ss: 0.725126, loss_d: 0.042920
0.1534 --- loss: 1.860928, loss_ss: 1.041819, loss_d: 0.819109
0.1918 --- loss: 0.859813, loss_ss: 0.766029, loss_d: 0.093784
0.2301 --- loss: 0.820605, loss_ss: 0.769177, loss_d: 0.051429
0.2685 --- loss: 1.190675, loss_ss: 0.735176, loss_d: 0.455498
0.3069 --- loss: 1.060776, loss_ss: 0.969127, loss_d: 0.091649
0.3452 --- loss: 1.106098, loss_ss: 0.943479, loss_d: 0.162620
0.3836 --- loss: 0.955028, loss_ss: 0.894324, loss_d: 0.060704
0.4219 --- loss: 0.878065, loss_ss: 0.592229, loss_d: 0.285836
0.4603 --- loss: 1.100994, loss_ss: 0.772874, loss_d: 0.328120
0.4987 --- loss: 0.858417, loss_ss: 0.823442, loss_d: 0.034975
0.5370 --- loss: 0.909937, loss_ss: 0.899045, loss_d: 0.010893
0.5754 --- loss: 1.359002, loss_ss: 0.971265, loss_d: 0.387738
0.6137 --- loss: 0.793782, loss_ss: 0.763723, loss_d: 0.030059
0.6521 --- loss: 1.068720, loss_ss: 0.886360, loss_d: 0.182360
0.6904 --- loss: 0.990051, loss_ss: 0.764854, loss_d: 0.225197
0.7288 --- loss: 1.070835, loss_ss: 0.890332, loss_d: 0.180502
0.7672 --- loss: 1.076286, loss_ss: 0.990299, loss_d: 0.085986
0.8055 --- loss: 2.007133, loss_ss: 0.904072, loss_d: 1.103061
0.8439 --- loss: 0.926491, loss_ss: 0.707091, loss_d: 0.219400
0.8822 --- loss: 1.184849, loss_ss: 0.931266, loss_d: 0.253583
0.9206 --- loss: 1.132129, loss_ss: 1.119827, loss_d: 0.012303
0.9590 --- loss: 1.197570, loss_ss: 0.625084, loss_d: 0.572486
0.9973 --- loss: 0.873922, loss_ss: 0.831751, loss_d: 0.042171
Epoch finished! Loss: 1.000415848310177
Starting epoch 6/10.
0.0000 --- loss: 1.408735, loss_ss: 0.551276, loss_d: 0.857459
0.0384 --- loss: 1.036014, loss_ss: 0.947614, loss_d: 0.088401
0.0767 --- loss: 0.665568, loss_ss: 0.638331, loss_d: 0.027237
0.1151 --- loss: 0.820043, loss_ss: 0.647489, loss_d: 0.172554
0.1534 --- loss: 1.184115, loss_ss: 1.154192, loss_d: 0.029922
0.1918 --- loss: 0.988396, loss_ss: 0.887763, loss_d: 0.100632
0.2301 --- loss: 0.807011, loss_ss: 0.725802, loss_d: 0.081209
0.2685 --- loss: 0.831333, loss_ss: 0.793091, loss_d: 0.038242
0.3069 --- loss: 0.768456, loss_ss: 0.730756, loss_d: 0.037700
0.3452 --- loss: 1.256673, loss_ss: 0.679273, loss_d: 0.577400
0.3836 --- loss: 0.987787, loss_ss: 0.968737, loss_d: 0.019050
0.4219 --- loss: 0.879321, loss_ss: 0.829027, loss_d: 0.050294
0.4603 --- loss: 1.009313, loss_ss: 0.744649, loss_d: 0.264664
0.4987 --- loss: 0.680925, loss_ss: 0.627427, loss_d: 0.053498
0.5370 --- loss: 0.982380, loss_ss: 0.781595, loss_d: 0.200786
0.5754 --- loss: 1.028570, loss_ss: 0.920833, loss_d: 0.107737
0.6137 --- loss: 1.151878, loss_ss: 1.106831, loss_d: 0.045047
0.6521 --- loss: 0.856761, loss_ss: 0.728763, loss_d: 0.127998
0.6904 --- loss: 0.960017, loss_ss: 0.665380, loss_d: 0.294637
0.7288 --- loss: 1.015611, loss_ss: 0.890356, loss_d: 0.125255
0.7672 --- loss: 0.956289, loss_ss: 0.934516, loss_d: 0.021773
0.8055 --- loss: 0.654699, loss_ss: 0.607999, loss_d: 0.046701
0.8439 --- loss: 0.840119, loss_ss: 0.832407, loss_d: 0.007712
0.8822 --- loss: 0.697281, loss_ss: 0.687903, loss_d: 0.009378
0.9206 --- loss: 1.043423, loss_ss: 0.961736, loss_d: 0.081688
0.9590 --- loss: 0.720808, loss_ss: 0.692960, loss_d: 0.027848
0.9973 --- loss: 1.259422, loss_ss: 0.827528, loss_d: 0.431894
Epoch finished! Loss: 0.9633900133463053
Starting epoch 7/10.
0.0000 --- loss: 0.885812, loss_ss: 0.879515, loss_d: 0.006297
0.0384 --- loss: 1.168941, loss_ss: 0.646497, loss_d: 0.522443
0.0767 --- loss: 0.649803, loss_ss: 0.619736, loss_d: 0.030067
0.1151 --- loss: 0.685113, loss_ss: 0.658683, loss_d: 0.026430
0.1534 --- loss: 0.674119, loss_ss: 0.658307, loss_d: 0.015812
0.1918 --- loss: 0.728140, loss_ss: 0.691019, loss_d: 0.037121
0.2301 --- loss: 0.711386, loss_ss: 0.635465, loss_d: 0.075921
0.2685 --- loss: 0.677584, loss_ss: 0.661312, loss_d: 0.016273
0.3069 --- loss: 1.251202, loss_ss: 0.677841, loss_d: 0.573361
0.3452 --- loss: 0.754089, loss_ss: 0.708511, loss_d: 0.045578
0.3836 --- loss: 0.506803, loss_ss: 0.483419, loss_d: 0.023384
0.4219 --- loss: 0.709307, loss_ss: 0.697561, loss_d: 0.011746
0.4603 --- loss: 2.049915, loss_ss: 0.709342, loss_d: 1.340573
0.4987 --- loss: 0.633917, loss_ss: 0.585142, loss_d: 0.048774
0.5370 --- loss: 0.755483, loss_ss: 0.605864, loss_d: 0.149619
0.5754 --- loss: 1.016564, loss_ss: 0.995036, loss_d: 0.021529
0.6137 --- loss: 1.029512, loss_ss: 0.999136, loss_d: 0.030376
0.6521 --- loss: 0.898009, loss_ss: 0.695236, loss_d: 0.202773
0.6904 --- loss: 0.975196, loss_ss: 0.877916, loss_d: 0.097280
0.7288 --- loss: 0.573078, loss_ss: 0.565604, loss_d: 0.007474
0.7672 --- loss: 0.783997, loss_ss: 0.768069, loss_d: 0.015928
0.8055 --- loss: 0.781759, loss_ss: 0.609626, loss_d: 0.172133
0.8439 --- loss: 1.061434, loss_ss: 1.056776, loss_d: 0.004658
0.8822 --- loss: 0.551036, loss_ss: 0.541775, loss_d: 0.009261
0.9206 --- loss: 0.686512, loss_ss: 0.543906, loss_d: 0.142606
0.9590 --- loss: 1.170857, loss_ss: 1.152021, loss_d: 0.018836
0.9973 --- loss: 0.763759, loss_ss: 0.677071, loss_d: 0.086689
Epoch finished! Loss: 0.8913010848256258
Starting epoch 8/10.
0.0000 --- loss: 1.083588, loss_ss: 1.012776, loss_d: 0.070811
0.0384 --- loss: 0.603995, loss_ss: 0.599497, loss_d: 0.004498
0.0767 --- loss: 0.695859, loss_ss: 0.679594, loss_d: 0.016265
0.1151 --- loss: 0.645331, loss_ss: 0.615166, loss_d: 0.030165
0.1534 --- loss: 0.893421, loss_ss: 0.869784, loss_d: 0.023636
0.1918 --- loss: 1.317266, loss_ss: 1.308727, loss_d: 0.008539
0.2301 --- loss: 0.867307, loss_ss: 0.829731, loss_d: 0.037576
0.2685 --- loss: 0.725444, loss_ss: 0.708751, loss_d: 0.016692
0.3069 --- loss: 0.766420, loss_ss: 0.759266, loss_d: 0.007155
0.3452 --- loss: 0.627588, loss_ss: 0.618649, loss_d: 0.008940
0.3836 --- loss: 0.723161, loss_ss: 0.719137, loss_d: 0.004024
0.4219 --- loss: 0.783672, loss_ss: 0.774688, loss_d: 0.008984
0.4603 --- loss: 0.786388, loss_ss: 0.766404, loss_d: 0.019984
0.4987 --- loss: 0.978442, loss_ss: 0.971516, loss_d: 0.006926
0.5370 --- loss: 0.446692, loss_ss: 0.443934, loss_d: 0.002757
0.5754 --- loss: 0.868332, loss_ss: 0.806386, loss_d: 0.061946
0.6137 --- loss: 0.869311, loss_ss: 0.524323, loss_d: 0.344988
0.6521 --- loss: 0.778446, loss_ss: 0.771357, loss_d: 0.007089
0.6904 --- loss: 1.237477, loss_ss: 0.809098, loss_d: 0.428379
0.7288 --- loss: 0.809404, loss_ss: 0.686932, loss_d: 0.122472
0.7672 --- loss: 0.961338, loss_ss: 0.904296, loss_d: 0.057042
0.8055 --- loss: 0.692560, loss_ss: 0.563851, loss_d: 0.128709
0.8439 --- loss: 0.570577, loss_ss: 0.526868, loss_d: 0.043709
0.8822 --- loss: 0.586928, loss_ss: 0.552878, loss_d: 0.034050
0.9206 --- loss: 0.646984, loss_ss: 0.624842, loss_d: 0.022142
0.9590 --- loss: 0.871189, loss_ss: 0.837011, loss_d: 0.034178
0.9973 --- loss: 1.065447, loss_ss: 0.866099, loss_d: 0.199347
Epoch finished! Loss: 0.8537389430862207
Starting epoch 9/10.
0.0000 --- loss: 0.722382, loss_ss: 0.629140, loss_d: 0.093242
0.0384 --- loss: 0.752033, loss_ss: 0.705006, loss_d: 0.047028
0.0767 --- loss: 0.680069, loss_ss: 0.586075, loss_d: 0.093994
0.1151 --- loss: 0.837628, loss_ss: 0.770986, loss_d: 0.066642
0.1534 --- loss: 0.529386, loss_ss: 0.501882, loss_d: 0.027504
0.1918 --- loss: 0.766081, loss_ss: 0.747986, loss_d: 0.018095
0.2301 --- loss: 1.137342, loss_ss: 1.026797, loss_d: 0.110545
0.2685 --- loss: 0.839220, loss_ss: 0.824715, loss_d: 0.014505
0.3069 --- loss: 0.678018, loss_ss: 0.647765, loss_d: 0.030253
0.3452 --- loss: 0.609706, loss_ss: 0.555853, loss_d: 0.053854
0.3836 --- loss: 0.594940, loss_ss: 0.580323, loss_d: 0.014617
0.4219 --- loss: 0.701435, loss_ss: 0.697049, loss_d: 0.004386
0.4603 --- loss: 0.677653, loss_ss: 0.673835, loss_d: 0.003818
0.4987 --- loss: 0.958128, loss_ss: 0.954393, loss_d: 0.003735
0.5370 --- loss: 0.702067, loss_ss: 0.697206, loss_d: 0.004861
0.5754 --- loss: 0.603945, loss_ss: 0.549610, loss_d: 0.054335
0.6137 --- loss: 0.875660, loss_ss: 0.807218, loss_d: 0.068442
0.6521 --- loss: 0.611108, loss_ss: 0.605072, loss_d: 0.006036
0.6904 --- loss: 0.838139, loss_ss: 0.836875, loss_d: 0.001264
0.7288 --- loss: 0.688940, loss_ss: 0.671938, loss_d: 0.017002
0.7672 --- loss: 0.734074, loss_ss: 0.616114, loss_d: 0.117960
0.8055 --- loss: 0.521406, loss_ss: 0.490649, loss_d: 0.030757
0.8439 --- loss: 0.546014, loss_ss: 0.503306, loss_d: 0.042708
0.8822 --- loss: 0.707044, loss_ss: 0.703865, loss_d: 0.003179
0.9206 --- loss: 0.796670, loss_ss: 0.760286, loss_d: 0.036384
0.9590 --- loss: 0.821902, loss_ss: 0.790358, loss_d: 0.031544
0.9973 --- loss: 1.012625, loss_ss: 0.978288, loss_d: 0.034338
Epoch finished! Loss: 0.8438840949764619
Starting epoch 10/10.
0.0000 --- loss: 1.030851, loss_ss: 1.017062, loss_d: 0.013789
0.0384 --- loss: 1.031326, loss_ss: 0.901114, loss_d: 0.130212
0.0767 --- loss: 1.113767, loss_ss: 1.090250, loss_d: 0.023517
0.1151 --- loss: 0.807532, loss_ss: 0.800824, loss_d: 0.006708
0.1534 --- loss: 0.774979, loss_ss: 0.767207, loss_d: 0.007772
0.1918 --- loss: 0.764429, loss_ss: 0.753564, loss_d: 0.010865
0.2301 --- loss: 0.824287, loss_ss: 0.814142, loss_d: 0.010144
0.2685 --- loss: 0.549697, loss_ss: 0.528134, loss_d: 0.021563
0.3069 --- loss: 1.235254, loss_ss: 1.219053, loss_d: 0.016201
0.3452 --- loss: 1.070004, loss_ss: 1.023218, loss_d: 0.046786
0.3836 --- loss: 0.584326, loss_ss: 0.567419, loss_d: 0.016907
0.4219 --- loss: 0.828404, loss_ss: 0.825969, loss_d: 0.002435
0.4603 --- loss: 0.944444, loss_ss: 0.665538, loss_d: 0.278907
0.4987 --- loss: 0.785013, loss_ss: 0.720646, loss_d: 0.064367
0.5370 --- loss: 0.583093, loss_ss: 0.565776, loss_d: 0.017317
0.5754 --- loss: 0.629390, loss_ss: 0.624025, loss_d: 0.005365
0.6137 --- loss: 0.567839, loss_ss: 0.561964, loss_d: 0.005875
0.6521 --- loss: 0.596500, loss_ss: 0.571572, loss_d: 0.024928
0.6904 --- loss: 0.641709, loss_ss: 0.586519, loss_d: 0.055191
0.7288 --- loss: 0.914460, loss_ss: 0.902006, loss_d: 0.012455
0.7672 --- loss: 0.670309, loss_ss: 0.658078, loss_d: 0.012231
0.8055 --- loss: 0.719081, loss_ss: 0.716070, loss_d: 0.003011
0.8439 --- loss: 0.936650, loss_ss: 0.932754, loss_d: 0.003897
0.8822 --- loss: 0.738068, loss_ss: 0.737550, loss_d: 0.000518
0.9206 --- loss: 1.062963, loss_ss: 0.778514, loss_d: 0.284449
0.9590 --- loss: 0.658248, loss_ss: 0.618568, loss_d: 0.039679
0.9973 --- loss: 0.912077, loss_ss: 0.910328, loss_d: 0.001749
Epoch finished! Loss: 0.8000117955299524
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6720430107526881
             precision    recall  f1-score   support

        0.0       0.66      0.69      0.67       119
        1.0       0.13      0.59      0.21        37
        2.0       0.80      0.48      0.60       387
        3.0       0.83      0.86      0.85       263
        4.0       0.82      0.90      0.85       124

avg / total       0.77      0.67      0.70       930
 


====== chp008-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.51  68.91   94.82  66.13     67.49
1  82.47  59.46   83.43  12.94     21.26
2  73.33  47.55   91.71  80.35     59.74
3  91.18  85.93   93.25  83.39     84.64
4  95.91  89.52   96.90  81.62     85.38
Total accuracy: 67.20%
Average sen: 70.27%
Average spec: 92.02%
Macro f1-score: 63.70%
Diagnosis acc on 15mins: 1.0
[0.99999511 0.99992597 0.99847668 0.99543363 0.99999797 0.99999976
 0.99999976 1.         0.99999988 0.99999702 0.99999797 1.
 1.         0.99979836 0.98957002 0.91091222 0.72739488 0.54988295
 0.99987447 0.99972743 0.99999964 0.99991345 0.99767715 0.99994504
 0.99576509 0.97744113 0.99554044 0.99998069 1.         1.
 1.        ]
pred: 0.9721692492884975, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.286599, loss_ss: 1.604572, loss_d: 0.682027
0.0384 --- loss: 2.142643, loss_ss: 1.467457, loss_d: 0.675186
0.0768 --- loss: 1.897711, loss_ss: 1.334235, loss_d: 0.563476
0.1152 --- loss: 1.892776, loss_ss: 1.315394, loss_d: 0.577382
0.1536 --- loss: 2.001976, loss_ss: 1.345558, loss_d: 0.656417
0.1920 --- loss: 2.009046, loss_ss: 1.410124, loss_d: 0.598922
0.2304 --- loss: 2.357022, loss_ss: 1.300078, loss_d: 1.056944
0.2688 --- loss: 2.159912, loss_ss: 1.490325, loss_d: 0.669587
0.3072 --- loss: 1.859357, loss_ss: 1.234084, loss_d: 0.625273
0.3456 --- loss: 1.990456, loss_ss: 1.448934, loss_d: 0.541522
0.3840 --- loss: 1.709230, loss_ss: 1.228637, loss_d: 0.480593
0.4224 --- loss: 1.765430, loss_ss: 1.242674, loss_d: 0.522757
0.4608 --- loss: 1.962730, loss_ss: 1.456638, loss_d: 0.506092
0.4992 --- loss: 2.242398, loss_ss: 1.231810, loss_d: 1.010588
0.5376 --- loss: 1.644515, loss_ss: 1.183573, loss_d: 0.460943
0.5760 --- loss: 1.764376, loss_ss: 1.390419, loss_d: 0.373957
0.6144 --- loss: 2.144213, loss_ss: 1.125192, loss_d: 1.019021
0.6528 --- loss: 1.857287, loss_ss: 1.329142, loss_d: 0.528146
0.6912 --- loss: 1.436940, loss_ss: 1.100872, loss_d: 0.336069
0.7296 --- loss: 1.779165, loss_ss: 1.180158, loss_d: 0.599007
0.7680 --- loss: 1.648373, loss_ss: 1.198689, loss_d: 0.449684
0.8065 --- loss: 1.769904, loss_ss: 1.305035, loss_d: 0.464868
0.8449 --- loss: 1.560238, loss_ss: 1.118834, loss_d: 0.441404
0.8833 --- loss: 1.522370, loss_ss: 1.212649, loss_d: 0.309720
0.9217 --- loss: 1.457820, loss_ss: 1.214134, loss_d: 0.243686
0.9601 --- loss: 1.416204, loss_ss: 1.064030, loss_d: 0.352174
0.9985 --- loss: 1.460639, loss_ss: 1.169102, loss_d: 0.291537
Epoch finished! Loss: 1.8077802057449635
Starting epoch 2/10.
0.0000 --- loss: 1.596808, loss_ss: 1.150951, loss_d: 0.445857
0.0384 --- loss: 1.481973, loss_ss: 1.006031, loss_d: 0.475942
0.0768 --- loss: 1.093132, loss_ss: 0.925668, loss_d: 0.167464
0.1152 --- loss: 1.100962, loss_ss: 0.980259, loss_d: 0.120704
0.1536 --- loss: 1.217489, loss_ss: 1.045316, loss_d: 0.172173
0.1920 --- loss: 1.685122, loss_ss: 0.985319, loss_d: 0.699803
0.2304 --- loss: 1.401458, loss_ss: 1.129346, loss_d: 0.272112
0.2688 --- loss: 1.129636, loss_ss: 0.900068, loss_d: 0.229568
0.3072 --- loss: 1.100171, loss_ss: 0.912567, loss_d: 0.187604
0.3456 --- loss: 1.065650, loss_ss: 0.959449, loss_d: 0.106201
0.3840 --- loss: 1.541560, loss_ss: 1.098543, loss_d: 0.443016
0.4224 --- loss: 1.533134, loss_ss: 1.118285, loss_d: 0.414849
0.4608 --- loss: 1.215686, loss_ss: 1.020109, loss_d: 0.195577
0.4992 --- loss: 1.765110, loss_ss: 1.590941, loss_d: 0.174169
0.5376 --- loss: 1.355620, loss_ss: 1.029104, loss_d: 0.326516
0.5760 --- loss: 1.367247, loss_ss: 0.877986, loss_d: 0.489260
0.6144 --- loss: 1.669502, loss_ss: 1.040303, loss_d: 0.629200
0.6528 --- loss: 1.583762, loss_ss: 0.922141, loss_d: 0.661620
0.6912 --- loss: 1.155016, loss_ss: 0.942275, loss_d: 0.212741
0.7296 --- loss: 1.269644, loss_ss: 1.112681, loss_d: 0.156963
0.7680 --- loss: 1.223840, loss_ss: 0.902376, loss_d: 0.321464
0.8065 --- loss: 1.507914, loss_ss: 0.823095, loss_d: 0.684818
0.8449 --- loss: 1.180428, loss_ss: 1.129661, loss_d: 0.050766
0.8833 --- loss: 1.356373, loss_ss: 1.044833, loss_d: 0.311540
0.9217 --- loss: 1.058648, loss_ss: 0.808893, loss_d: 0.249756
0.9601 --- loss: 1.081144, loss_ss: 0.901350, loss_d: 0.179794
0.9985 --- loss: 1.678881, loss_ss: 1.273390, loss_d: 0.405490
Epoch finished! Loss: 1.3400999454351572
Starting epoch 3/10.
0.0000 --- loss: 1.526611, loss_ss: 0.909805, loss_d: 0.616805
0.0384 --- loss: 1.521474, loss_ss: 1.022243, loss_d: 0.499232
0.0768 --- loss: 0.960688, loss_ss: 0.775878, loss_d: 0.184810
0.1152 --- loss: 1.014211, loss_ss: 0.963461, loss_d: 0.050750
0.1536 --- loss: 1.047075, loss_ss: 0.788525, loss_d: 0.258550
0.1920 --- loss: 1.075853, loss_ss: 0.931488, loss_d: 0.144365
0.2304 --- loss: 0.992502, loss_ss: 0.821520, loss_d: 0.170981
0.2688 --- loss: 1.746015, loss_ss: 0.949275, loss_d: 0.796740
0.3072 --- loss: 0.818331, loss_ss: 0.756015, loss_d: 0.062317
0.3456 --- loss: 1.106255, loss_ss: 0.957492, loss_d: 0.148763
0.3840 --- loss: 1.761704, loss_ss: 1.519956, loss_d: 0.241748
0.4224 --- loss: 0.819205, loss_ss: 0.694319, loss_d: 0.124885
0.4608 --- loss: 1.089809, loss_ss: 1.036474, loss_d: 0.053335
0.4992 --- loss: 1.836035, loss_ss: 0.964448, loss_d: 0.871587
0.5376 --- loss: 1.076566, loss_ss: 0.766638, loss_d: 0.309929
0.5760 --- loss: 1.279250, loss_ss: 1.093287, loss_d: 0.185963
0.6144 --- loss: 1.137689, loss_ss: 0.895589, loss_d: 0.242101
0.6528 --- loss: 1.291718, loss_ss: 1.142737, loss_d: 0.148981
0.6912 --- loss: 1.105745, loss_ss: 0.871312, loss_d: 0.234433
0.7296 --- loss: 1.017657, loss_ss: 0.754300, loss_d: 0.263358
0.7680 --- loss: 0.952969, loss_ss: 0.881869, loss_d: 0.071100
0.8065 --- loss: 1.019415, loss_ss: 0.855554, loss_d: 0.163861
0.8449 --- loss: 1.634059, loss_ss: 1.613800, loss_d: 0.020259
0.8833 --- loss: 0.940167, loss_ss: 0.858700, loss_d: 0.081467
0.9217 --- loss: 1.221164, loss_ss: 1.000238, loss_d: 0.220926
0.9601 --- loss: 1.005586, loss_ss: 0.897956, loss_d: 0.107630
0.9985 --- loss: 1.914856, loss_ss: 0.905249, loss_d: 1.009607
Epoch finished! Loss: 1.183943244127127
Starting epoch 4/10.
0.0000 --- loss: 0.999322, loss_ss: 0.924593, loss_d: 0.074729
0.0384 --- loss: 1.004408, loss_ss: 0.964468, loss_d: 0.039939
0.0768 --- loss: 1.130946, loss_ss: 0.865313, loss_d: 0.265633
0.1152 --- loss: 1.101424, loss_ss: 0.933049, loss_d: 0.168376
0.1536 --- loss: 0.831149, loss_ss: 0.762659, loss_d: 0.068490
0.1920 --- loss: 1.906239, loss_ss: 1.045201, loss_d: 0.861038
0.2304 --- loss: 1.089789, loss_ss: 0.845876, loss_d: 0.243913
0.2688 --- loss: 0.822255, loss_ss: 0.765330, loss_d: 0.056925
0.3072 --- loss: 0.925017, loss_ss: 0.859270, loss_d: 0.065747
0.3456 --- loss: 0.954950, loss_ss: 0.734182, loss_d: 0.220768
0.3840 --- loss: 1.392525, loss_ss: 0.923836, loss_d: 0.468688
0.4224 --- loss: 0.877631, loss_ss: 0.733312, loss_d: 0.144319
0.4608 --- loss: 1.041456, loss_ss: 0.864356, loss_d: 0.177100
0.4992 --- loss: 1.479262, loss_ss: 1.394488, loss_d: 0.084774
0.5376 --- loss: 0.869289, loss_ss: 0.846937, loss_d: 0.022352
0.5760 --- loss: 0.879736, loss_ss: 0.741970, loss_d: 0.137767
0.6144 --- loss: 0.864421, loss_ss: 0.798752, loss_d: 0.065669
0.6528 --- loss: 1.004456, loss_ss: 0.874219, loss_d: 0.130237
0.6912 --- loss: 1.085153, loss_ss: 0.814829, loss_d: 0.270324
0.7296 --- loss: 1.347320, loss_ss: 0.969018, loss_d: 0.378302
0.7680 --- loss: 1.031601, loss_ss: 1.001159, loss_d: 0.030442
0.8065 --- loss: 0.934528, loss_ss: 0.876047, loss_d: 0.058482
0.8449 --- loss: 1.206315, loss_ss: 0.798764, loss_d: 0.407551
0.8833 --- loss: 0.975893, loss_ss: 0.903829, loss_d: 0.072064
0.9217 --- loss: 1.108217, loss_ss: 0.844238, loss_d: 0.263979
0.9601 --- loss: 0.984564, loss_ss: 0.802878, loss_d: 0.181687
0.9985 --- loss: 1.172995, loss_ss: 1.117273, loss_d: 0.055721
Epoch finished! Loss: 1.110790513570492
Starting epoch 5/10.
0.0000 --- loss: 0.971960, loss_ss: 0.873659, loss_d: 0.098302
0.0384 --- loss: 1.257765, loss_ss: 0.735431, loss_d: 0.522334
0.0768 --- loss: 1.365724, loss_ss: 1.008932, loss_d: 0.356792
0.1152 --- loss: 0.821525, loss_ss: 0.747778, loss_d: 0.073747
0.1536 --- loss: 0.930503, loss_ss: 0.894000, loss_d: 0.036503
0.1920 --- loss: 1.036228, loss_ss: 0.685991, loss_d: 0.350237
0.2304 --- loss: 1.495358, loss_ss: 1.127538, loss_d: 0.367820
0.2688 --- loss: 0.921012, loss_ss: 0.869704, loss_d: 0.051308
0.3072 --- loss: 1.343624, loss_ss: 0.795706, loss_d: 0.547918
0.3456 --- loss: 0.898071, loss_ss: 0.855341, loss_d: 0.042730
0.3840 --- loss: 0.991530, loss_ss: 0.906157, loss_d: 0.085373
0.4224 --- loss: 1.175991, loss_ss: 1.129677, loss_d: 0.046314
0.4608 --- loss: 0.983531, loss_ss: 0.885513, loss_d: 0.098018
0.4992 --- loss: 1.250893, loss_ss: 0.855943, loss_d: 0.394950
0.5376 --- loss: 1.509203, loss_ss: 1.194629, loss_d: 0.314574
0.5760 --- loss: 0.979784, loss_ss: 0.884441, loss_d: 0.095343
0.6144 --- loss: 1.057401, loss_ss: 1.015493, loss_d: 0.041908
0.6528 --- loss: 1.058826, loss_ss: 0.992886, loss_d: 0.065940
0.6912 --- loss: 0.965051, loss_ss: 0.723769, loss_d: 0.241282
0.7296 --- loss: 1.059019, loss_ss: 0.991012, loss_d: 0.068007
0.7680 --- loss: 0.798969, loss_ss: 0.709683, loss_d: 0.089285
0.8065 --- loss: 0.964505, loss_ss: 0.921511, loss_d: 0.042994
0.8449 --- loss: 1.076748, loss_ss: 1.048426, loss_d: 0.028322
0.8833 --- loss: 1.054368, loss_ss: 0.814352, loss_d: 0.240016
0.9217 --- loss: 0.842478, loss_ss: 0.834712, loss_d: 0.007767
0.9601 --- loss: 1.127666, loss_ss: 1.002742, loss_d: 0.124924
0.9985 --- loss: 1.243119, loss_ss: 1.188384, loss_d: 0.054735
Epoch finished! Loss: 1.0555085418316035
Starting epoch 6/10.
0.0000 --- loss: 0.775842, loss_ss: 0.651477, loss_d: 0.124365
0.0384 --- loss: 1.066126, loss_ss: 0.713809, loss_d: 0.352317
0.0768 --- loss: 0.765562, loss_ss: 0.513449, loss_d: 0.252113
0.1152 --- loss: 0.688564, loss_ss: 0.658377, loss_d: 0.030187
0.1536 --- loss: 0.955084, loss_ss: 0.846635, loss_d: 0.108448
0.1920 --- loss: 1.530812, loss_ss: 0.992510, loss_d: 0.538302
0.2304 --- loss: 1.184697, loss_ss: 1.018107, loss_d: 0.166590
0.2688 --- loss: 1.051510, loss_ss: 0.931978, loss_d: 0.119532
0.3072 --- loss: 1.043427, loss_ss: 0.974189, loss_d: 0.069238
0.3456 --- loss: 0.821771, loss_ss: 0.787042, loss_d: 0.034729
0.3840 --- loss: 1.225158, loss_ss: 0.892940, loss_d: 0.332219
0.4224 --- loss: 1.282708, loss_ss: 0.699079, loss_d: 0.583629
0.4608 --- loss: 1.007360, loss_ss: 0.942833, loss_d: 0.064527
0.4992 --- loss: 0.922638, loss_ss: 0.787583, loss_d: 0.135055
0.5376 --- loss: 0.815890, loss_ss: 0.780292, loss_d: 0.035598
0.5760 --- loss: 1.031055, loss_ss: 0.689028, loss_d: 0.342027
0.6144 --- loss: 1.055081, loss_ss: 1.045849, loss_d: 0.009233
0.6528 --- loss: 0.882223, loss_ss: 0.794619, loss_d: 0.087604
0.6912 --- loss: 1.132563, loss_ss: 1.111508, loss_d: 0.021054
0.7296 --- loss: 0.769222, loss_ss: 0.733612, loss_d: 0.035611
0.7680 --- loss: 1.155440, loss_ss: 1.003904, loss_d: 0.151535
0.8065 --- loss: 1.235041, loss_ss: 0.979621, loss_d: 0.255420
0.8449 --- loss: 0.856998, loss_ss: 0.813028, loss_d: 0.043969
0.8833 --- loss: 1.221101, loss_ss: 1.129604, loss_d: 0.091497
0.9217 --- loss: 0.996388, loss_ss: 0.816624, loss_d: 0.179764
0.9601 --- loss: 1.160415, loss_ss: 0.781865, loss_d: 0.378550
0.9985 --- loss: 1.224060, loss_ss: 1.194561, loss_d: 0.029499
Epoch finished! Loss: 1.0057635204150126
Starting epoch 7/10.
0.0000 --- loss: 1.669741, loss_ss: 0.677373, loss_d: 0.992369
0.0384 --- loss: 0.962650, loss_ss: 0.932484, loss_d: 0.030166
0.0768 --- loss: 0.651516, loss_ss: 0.600197, loss_d: 0.051318
0.1152 --- loss: 1.195535, loss_ss: 0.863125, loss_d: 0.332411
0.1536 --- loss: 0.698554, loss_ss: 0.644355, loss_d: 0.054198
0.1920 --- loss: 0.966110, loss_ss: 0.735661, loss_d: 0.230448
0.2304 --- loss: 0.908020, loss_ss: 0.798418, loss_d: 0.109602
0.2688 --- loss: 0.726867, loss_ss: 0.706149, loss_d: 0.020718
0.3072 --- loss: 0.840501, loss_ss: 0.836985, loss_d: 0.003515
0.3456 --- loss: 0.823106, loss_ss: 0.806854, loss_d: 0.016252
0.3840 --- loss: 0.727837, loss_ss: 0.658517, loss_d: 0.069319
0.4224 --- loss: 1.316151, loss_ss: 0.942984, loss_d: 0.373167
0.4608 --- loss: 0.970168, loss_ss: 0.750336, loss_d: 0.219832
0.4992 --- loss: 0.966155, loss_ss: 0.692482, loss_d: 0.273673
0.5376 --- loss: 0.777910, loss_ss: 0.737314, loss_d: 0.040596
0.5760 --- loss: 1.300644, loss_ss: 1.051616, loss_d: 0.249028
0.6144 --- loss: 1.138340, loss_ss: 0.911280, loss_d: 0.227060
0.6528 --- loss: 0.895173, loss_ss: 0.840812, loss_d: 0.054361
0.6912 --- loss: 1.026817, loss_ss: 0.979148, loss_d: 0.047669
0.7296 --- loss: 1.085205, loss_ss: 0.840040, loss_d: 0.245165
0.7680 --- loss: 0.848427, loss_ss: 0.844003, loss_d: 0.004424
0.8065 --- loss: 0.828850, loss_ss: 0.809363, loss_d: 0.019487
0.8449 --- loss: 0.881552, loss_ss: 0.827084, loss_d: 0.054468
0.8833 --- loss: 1.069817, loss_ss: 0.878283, loss_d: 0.191534
0.9217 --- loss: 0.671166, loss_ss: 0.632413, loss_d: 0.038753
0.9601 --- loss: 1.108456, loss_ss: 0.734500, loss_d: 0.373956
0.9985 --- loss: 1.652347, loss_ss: 1.116241, loss_d: 0.536106
Epoch finished! Loss: 0.9710834865386669
Starting epoch 8/10.
0.0000 --- loss: 0.705094, loss_ss: 0.684660, loss_d: 0.020434
0.0384 --- loss: 0.800557, loss_ss: 0.733002, loss_d: 0.067555
0.0768 --- loss: 0.546748, loss_ss: 0.514300, loss_d: 0.032448
0.1152 --- loss: 0.866831, loss_ss: 0.838954, loss_d: 0.027877
0.1536 --- loss: 0.909668, loss_ss: 0.849544, loss_d: 0.060124
0.1920 --- loss: 1.109964, loss_ss: 1.084299, loss_d: 0.025664
0.2304 --- loss: 1.002030, loss_ss: 0.980175, loss_d: 0.021855
0.2688 --- loss: 0.941551, loss_ss: 0.866340, loss_d: 0.075211
0.3072 --- loss: 0.832997, loss_ss: 0.757289, loss_d: 0.075708
0.3456 --- loss: 1.387423, loss_ss: 1.244122, loss_d: 0.143301
0.3840 --- loss: 1.196153, loss_ss: 0.670505, loss_d: 0.525648
0.4224 --- loss: 0.834013, loss_ss: 0.813293, loss_d: 0.020721
0.4608 --- loss: 0.939596, loss_ss: 0.704968, loss_d: 0.234628
0.4992 --- loss: 1.054002, loss_ss: 0.928912, loss_d: 0.125090
0.5376 --- loss: 0.778491, loss_ss: 0.772845, loss_d: 0.005646
0.5760 --- loss: 0.860744, loss_ss: 0.843030, loss_d: 0.017713
0.6144 --- loss: 1.205129, loss_ss: 0.782713, loss_d: 0.422416
0.6528 --- loss: 0.770611, loss_ss: 0.640271, loss_d: 0.130341
0.6912 --- loss: 1.284215, loss_ss: 1.002908, loss_d: 0.281307
0.7296 --- loss: 0.921107, loss_ss: 0.885602, loss_d: 0.035505
0.7680 --- loss: 0.867510, loss_ss: 0.848159, loss_d: 0.019351
0.8065 --- loss: 1.149828, loss_ss: 1.123922, loss_d: 0.025907
0.8449 --- loss: 0.909735, loss_ss: 0.730826, loss_d: 0.178909
0.8833 --- loss: 0.720201, loss_ss: 0.613809, loss_d: 0.106392
0.9217 --- loss: 0.920790, loss_ss: 0.911670, loss_d: 0.009120
0.9601 --- loss: 0.987133, loss_ss: 0.982355, loss_d: 0.004778
0.9985 --- loss: 0.698858, loss_ss: 0.682884, loss_d: 0.015974
Epoch finished! Loss: 0.9614504199761611
Starting epoch 9/10.
0.0000 --- loss: 0.675125, loss_ss: 0.670337, loss_d: 0.004788
0.0384 --- loss: 0.890600, loss_ss: 0.867291, loss_d: 0.023309
0.0768 --- loss: 1.005829, loss_ss: 0.996114, loss_d: 0.009715
0.1152 --- loss: 1.096349, loss_ss: 0.831314, loss_d: 0.265035
0.1536 --- loss: 1.871530, loss_ss: 0.938239, loss_d: 0.933290
0.1920 --- loss: 0.655187, loss_ss: 0.627764, loss_d: 0.027423
0.2304 --- loss: 0.949742, loss_ss: 0.859484, loss_d: 0.090258
0.2688 --- loss: 0.801140, loss_ss: 0.797671, loss_d: 0.003469
0.3072 --- loss: 0.646366, loss_ss: 0.640119, loss_d: 0.006248
0.3456 --- loss: 0.687162, loss_ss: 0.671921, loss_d: 0.015241
0.3840 --- loss: 0.973686, loss_ss: 0.890857, loss_d: 0.082829
0.4224 --- loss: 0.787535, loss_ss: 0.679852, loss_d: 0.107683
0.4608 --- loss: 0.642325, loss_ss: 0.630499, loss_d: 0.011826
0.4992 --- loss: 0.822525, loss_ss: 0.792367, loss_d: 0.030158
0.5376 --- loss: 0.972158, loss_ss: 0.744231, loss_d: 0.227927
0.5760 --- loss: 0.899871, loss_ss: 0.772513, loss_d: 0.127359
0.6144 --- loss: 0.754417, loss_ss: 0.752547, loss_d: 0.001871
0.6528 --- loss: 0.897346, loss_ss: 0.746681, loss_d: 0.150665
0.6912 --- loss: 0.813293, loss_ss: 0.799149, loss_d: 0.014144
0.7296 --- loss: 0.673560, loss_ss: 0.663252, loss_d: 0.010308
0.7680 --- loss: 0.942855, loss_ss: 0.894494, loss_d: 0.048361
0.8065 --- loss: 1.255163, loss_ss: 1.127372, loss_d: 0.127791
0.8449 --- loss: 1.100108, loss_ss: 0.697379, loss_d: 0.402729
0.8833 --- loss: 1.032234, loss_ss: 0.764907, loss_d: 0.267327
0.9217 --- loss: 0.792197, loss_ss: 0.748344, loss_d: 0.043853
0.9601 --- loss: 0.685556, loss_ss: 0.676266, loss_d: 0.009290
0.9985 --- loss: 1.759497, loss_ss: 1.688522, loss_d: 0.070975
Epoch finished! Loss: 0.8863150355907586
Starting epoch 10/10.
0.0000 --- loss: 0.670627, loss_ss: 0.663794, loss_d: 0.006833
0.0384 --- loss: 0.634920, loss_ss: 0.595021, loss_d: 0.039898
0.0768 --- loss: 0.764469, loss_ss: 0.722808, loss_d: 0.041661
0.1152 --- loss: 0.817875, loss_ss: 0.775267, loss_d: 0.042607
0.1536 --- loss: 0.807445, loss_ss: 0.568810, loss_d: 0.238635
0.1920 --- loss: 0.716436, loss_ss: 0.653930, loss_d: 0.062506
0.2304 --- loss: 1.069214, loss_ss: 0.815326, loss_d: 0.253888
0.2688 --- loss: 1.279783, loss_ss: 1.132514, loss_d: 0.147269
0.3072 --- loss: 0.745658, loss_ss: 0.730854, loss_d: 0.014804
0.3456 --- loss: 0.734956, loss_ss: 0.698424, loss_d: 0.036532
0.3840 --- loss: 0.814645, loss_ss: 0.798209, loss_d: 0.016436
0.4224 --- loss: 0.747849, loss_ss: 0.701970, loss_d: 0.045879
0.4608 --- loss: 0.670707, loss_ss: 0.615981, loss_d: 0.054726
0.4992 --- loss: 0.840195, loss_ss: 0.834260, loss_d: 0.005935
0.5376 --- loss: 1.042691, loss_ss: 1.035108, loss_d: 0.007583
0.5760 --- loss: 0.864919, loss_ss: 0.818547, loss_d: 0.046371
0.6144 --- loss: 0.867598, loss_ss: 0.851155, loss_d: 0.016444
0.6528 --- loss: 0.800732, loss_ss: 0.782182, loss_d: 0.018550
0.6912 --- loss: 0.715810, loss_ss: 0.708307, loss_d: 0.007502
0.7296 --- loss: 0.540700, loss_ss: 0.508907, loss_d: 0.031793
0.7680 --- loss: 1.098041, loss_ss: 0.687149, loss_d: 0.410892
0.8065 --- loss: 0.961430, loss_ss: 0.958584, loss_d: 0.002846
0.8449 --- loss: 0.894012, loss_ss: 0.852631, loss_d: 0.041381
0.8833 --- loss: 0.997087, loss_ss: 0.871274, loss_d: 0.125813
0.9217 --- loss: 1.400906, loss_ss: 0.864385, loss_d: 0.536521
0.9601 --- loss: 0.865101, loss_ss: 0.744664, loss_d: 0.120438
0.9985 --- loss: 0.473002, loss_ss: 0.471156, loss_d: 0.001846
Epoch finished! Loss: 0.8665276825428009
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7225490196078431
             precision    recall  f1-score   support

        0.0       0.83      0.42      0.56        96
        1.0       0.39      0.48      0.43       123
        2.0       0.79      0.72      0.75       355
        3.0       1.00      0.78      0.87       209
        4.0       0.66      0.94      0.78       237

avg / total       0.76      0.72      0.72      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.73  41.67   99.13   83.33     55.56
1  84.51  47.97   89.52   38.56     42.75
2  83.33  71.55   89.62   78.64     74.93
3  95.39  77.51  100.00  100.00     87.33
4  87.55  93.67   85.70   66.47     77.76
Total accuracy: 72.25%
Average sen: 66.47%
Average spec: 92.79%
Macro f1-score: 67.67%
Diagnosis acc on 15mins: 1.0
[0.99997187 0.99999702 1.         0.99998689 0.9998343  0.99999905
 0.99999988 0.99999988 1.         1.         0.99999988 1.
 0.99999952 0.99999905 0.99999988 1.         1.         0.99999905
 1.         1.         0.99999046 0.99996424 0.9999702  0.99999368
 0.9999851  0.9999944  0.99999738 0.99999952 0.99999547 0.99971765
 0.99999261 0.99999678 0.99999893 0.9999994 ]
pred: 0.9999818258425769, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.213173, loss_ss: 1.525828, loss_d: 0.687344
0.0384 --- loss: 1.995803, loss_ss: 1.583323, loss_d: 0.412480
0.0767 --- loss: 2.167976, loss_ss: 1.554602, loss_d: 0.613374
0.1151 --- loss: 1.883168, loss_ss: 1.419155, loss_d: 0.464013
0.1535 --- loss: 2.088772, loss_ss: 1.709156, loss_d: 0.379617
0.1919 --- loss: 2.322937, loss_ss: 1.501666, loss_d: 0.821271
0.2302 --- loss: 2.080122, loss_ss: 1.574616, loss_d: 0.505506
0.2686 --- loss: 2.036110, loss_ss: 1.444310, loss_d: 0.591801
0.3070 --- loss: 1.899147, loss_ss: 1.363129, loss_d: 0.536018
0.3454 --- loss: 2.343981, loss_ss: 1.582998, loss_d: 0.760983
0.3837 --- loss: 1.813761, loss_ss: 1.327310, loss_d: 0.486451
0.4221 --- loss: 2.008513, loss_ss: 1.472141, loss_d: 0.536372
0.4605 --- loss: 1.980126, loss_ss: 1.336579, loss_d: 0.643547
0.4988 --- loss: 2.091122, loss_ss: 1.460561, loss_d: 0.630561
0.5372 --- loss: 2.017646, loss_ss: 1.426278, loss_d: 0.591368
0.5756 --- loss: 1.744030, loss_ss: 1.271242, loss_d: 0.472788
0.6140 --- loss: 1.972653, loss_ss: 1.451002, loss_d: 0.521651
0.6523 --- loss: 2.213242, loss_ss: 1.435862, loss_d: 0.777380
0.6907 --- loss: 1.787630, loss_ss: 1.350700, loss_d: 0.436930
0.7291 --- loss: 1.687066, loss_ss: 1.173152, loss_d: 0.513914
0.7675 --- loss: 1.672687, loss_ss: 1.328980, loss_d: 0.343708
0.8058 --- loss: 1.700050, loss_ss: 1.413872, loss_d: 0.286178
0.8442 --- loss: 1.649306, loss_ss: 1.317464, loss_d: 0.331842
0.8826 --- loss: 1.556881, loss_ss: 1.324191, loss_d: 0.232689
0.9210 --- loss: 1.566627, loss_ss: 1.361848, loss_d: 0.204780
0.9593 --- loss: 1.515623, loss_ss: 1.316576, loss_d: 0.199048
0.9977 --- loss: 1.564487, loss_ss: 1.234915, loss_d: 0.329572
Epoch finished! Loss: 1.9557439382259663
Starting epoch 2/10.
0.0000 --- loss: 1.667030, loss_ss: 1.265115, loss_d: 0.401915
0.0384 --- loss: 1.463437, loss_ss: 1.086484, loss_d: 0.376953
0.0767 --- loss: 1.492632, loss_ss: 1.331835, loss_d: 0.160797
0.1151 --- loss: 1.289695, loss_ss: 1.212663, loss_d: 0.077032
0.1535 --- loss: 1.446784, loss_ss: 1.273296, loss_d: 0.173487
0.1919 --- loss: 1.469305, loss_ss: 1.283686, loss_d: 0.185619
0.2302 --- loss: 1.501177, loss_ss: 1.062881, loss_d: 0.438295
0.2686 --- loss: 1.434784, loss_ss: 1.267251, loss_d: 0.167533
0.3070 --- loss: 1.391016, loss_ss: 1.107152, loss_d: 0.283864
0.3454 --- loss: 1.353875, loss_ss: 1.148511, loss_d: 0.205364
0.3837 --- loss: 1.410176, loss_ss: 1.074327, loss_d: 0.335850
0.4221 --- loss: 1.424117, loss_ss: 1.104388, loss_d: 0.319730
0.4605 --- loss: 1.929856, loss_ss: 1.010156, loss_d: 0.919700
0.4988 --- loss: 1.637574, loss_ss: 1.146207, loss_d: 0.491367
0.5372 --- loss: 1.321095, loss_ss: 1.058692, loss_d: 0.262403
0.5756 --- loss: 1.213858, loss_ss: 1.070142, loss_d: 0.143716
0.6140 --- loss: 1.242043, loss_ss: 1.070027, loss_d: 0.172016
0.6523 --- loss: 1.099600, loss_ss: 0.771249, loss_d: 0.328350
0.6907 --- loss: 1.237400, loss_ss: 1.096257, loss_d: 0.141143
0.7291 --- loss: 1.372544, loss_ss: 1.116710, loss_d: 0.255834
0.7675 --- loss: 1.133192, loss_ss: 1.018101, loss_d: 0.115092
0.8058 --- loss: 1.194386, loss_ss: 1.079092, loss_d: 0.115294
0.8442 --- loss: 1.201178, loss_ss: 1.072670, loss_d: 0.128509
0.8826 --- loss: 1.232332, loss_ss: 0.941279, loss_d: 0.291054
0.9210 --- loss: 1.494063, loss_ss: 1.180718, loss_d: 0.313345
0.9593 --- loss: 1.125593, loss_ss: 0.955751, loss_d: 0.169842
0.9977 --- loss: 1.199749, loss_ss: 1.084313, loss_d: 0.115437
Epoch finished! Loss: 1.4452857730480342
Starting epoch 3/10.
0.0000 --- loss: 1.363050, loss_ss: 1.183638, loss_d: 0.179412
0.0384 --- loss: 1.048831, loss_ss: 0.868271, loss_d: 0.180560
0.0767 --- loss: 1.162452, loss_ss: 1.036047, loss_d: 0.126405
0.1151 --- loss: 1.181782, loss_ss: 0.932779, loss_d: 0.249003
0.1535 --- loss: 1.153015, loss_ss: 0.972973, loss_d: 0.180042
0.1919 --- loss: 1.271071, loss_ss: 0.926002, loss_d: 0.345069
0.2302 --- loss: 1.280679, loss_ss: 0.848510, loss_d: 0.432169
0.2686 --- loss: 1.234766, loss_ss: 0.912966, loss_d: 0.321800
0.3070 --- loss: 1.064467, loss_ss: 0.957916, loss_d: 0.106551
0.3454 --- loss: 1.338766, loss_ss: 1.006578, loss_d: 0.332188
0.3837 --- loss: 0.920834, loss_ss: 0.819581, loss_d: 0.101253
0.4221 --- loss: 1.514194, loss_ss: 1.120575, loss_d: 0.393620
0.4605 --- loss: 1.298786, loss_ss: 0.867954, loss_d: 0.430832
0.4988 --- loss: 1.532556, loss_ss: 0.838038, loss_d: 0.694518
0.5372 --- loss: 1.127031, loss_ss: 0.900186, loss_d: 0.226845
0.5756 --- loss: 1.373201, loss_ss: 0.906379, loss_d: 0.466822
0.6140 --- loss: 1.071902, loss_ss: 0.975783, loss_d: 0.096120
0.6523 --- loss: 0.933700, loss_ss: 0.872847, loss_d: 0.060853
0.6907 --- loss: 1.100672, loss_ss: 0.883578, loss_d: 0.217094
0.7291 --- loss: 0.948896, loss_ss: 0.834120, loss_d: 0.114776
0.7675 --- loss: 1.076726, loss_ss: 0.878796, loss_d: 0.197930
0.8058 --- loss: 1.004303, loss_ss: 0.979493, loss_d: 0.024810
0.8442 --- loss: 0.948169, loss_ss: 0.885088, loss_d: 0.063081
0.8826 --- loss: 1.204966, loss_ss: 1.035324, loss_d: 0.169641
0.9210 --- loss: 1.406413, loss_ss: 1.028346, loss_d: 0.378068
0.9593 --- loss: 1.033558, loss_ss: 0.916146, loss_d: 0.117413
0.9977 --- loss: 1.078441, loss_ss: 0.914054, loss_d: 0.164387
Epoch finished! Loss: 1.1833237347694543
Starting epoch 4/10.
0.0000 --- loss: 1.623208, loss_ss: 1.538054, loss_d: 0.085154
0.0384 --- loss: 1.140413, loss_ss: 0.837542, loss_d: 0.302871
0.0767 --- loss: 1.430007, loss_ss: 0.945971, loss_d: 0.484037
0.1151 --- loss: 1.331216, loss_ss: 1.114460, loss_d: 0.216756
0.1535 --- loss: 0.809034, loss_ss: 0.709655, loss_d: 0.099379
0.1919 --- loss: 1.508280, loss_ss: 1.095760, loss_d: 0.412519
0.2302 --- loss: 1.925403, loss_ss: 0.835691, loss_d: 1.089712
0.2686 --- loss: 1.135244, loss_ss: 0.719361, loss_d: 0.415883
0.3070 --- loss: 1.895479, loss_ss: 0.862731, loss_d: 1.032748
0.3454 --- loss: 0.807251, loss_ss: 0.694652, loss_d: 0.112599
0.3837 --- loss: 1.019572, loss_ss: 0.885217, loss_d: 0.134355
0.4221 --- loss: 1.310112, loss_ss: 0.921982, loss_d: 0.388130
0.4605 --- loss: 1.368342, loss_ss: 0.912082, loss_d: 0.456259
0.4988 --- loss: 1.247238, loss_ss: 0.747641, loss_d: 0.499597
0.5372 --- loss: 0.759088, loss_ss: 0.710816, loss_d: 0.048273
0.5756 --- loss: 0.788278, loss_ss: 0.681248, loss_d: 0.107031
0.6140 --- loss: 0.975823, loss_ss: 0.735241, loss_d: 0.240582
0.6523 --- loss: 1.123521, loss_ss: 0.900144, loss_d: 0.223377
0.6907 --- loss: 0.862963, loss_ss: 0.713446, loss_d: 0.149517
0.7291 --- loss: 0.796595, loss_ss: 0.730224, loss_d: 0.066371
0.7675 --- loss: 1.340077, loss_ss: 0.928210, loss_d: 0.411867
0.8058 --- loss: 0.791015, loss_ss: 0.533923, loss_d: 0.257092
0.8442 --- loss: 0.952630, loss_ss: 0.896616, loss_d: 0.056014
0.8826 --- loss: 0.994074, loss_ss: 0.799434, loss_d: 0.194640
0.9210 --- loss: 0.894211, loss_ss: 0.825746, loss_d: 0.068465
0.9593 --- loss: 0.976386, loss_ss: 0.899146, loss_d: 0.077240
0.9977 --- loss: 2.257266, loss_ss: 0.641294, loss_d: 1.615972
Epoch finished! Loss: 1.0857756014053639
Starting epoch 5/10.
0.0000 --- loss: 1.037172, loss_ss: 0.954287, loss_d: 0.082885
0.0384 --- loss: 1.072844, loss_ss: 0.870314, loss_d: 0.202531
0.0767 --- loss: 1.148582, loss_ss: 0.797408, loss_d: 0.351174
0.1151 --- loss: 0.764219, loss_ss: 0.724787, loss_d: 0.039432
0.1535 --- loss: 1.128117, loss_ss: 1.015753, loss_d: 0.112365
0.1919 --- loss: 1.743217, loss_ss: 1.231846, loss_d: 0.511371
0.2302 --- loss: 0.983198, loss_ss: 0.861488, loss_d: 0.121709
0.2686 --- loss: 0.927079, loss_ss: 0.877131, loss_d: 0.049947
0.3070 --- loss: 0.731407, loss_ss: 0.691386, loss_d: 0.040020
0.3454 --- loss: 0.800959, loss_ss: 0.777264, loss_d: 0.023695
0.3837 --- loss: 0.970654, loss_ss: 0.947231, loss_d: 0.023423
0.4221 --- loss: 0.987891, loss_ss: 0.738986, loss_d: 0.248905
0.4605 --- loss: 0.852632, loss_ss: 0.770021, loss_d: 0.082611
0.4988 --- loss: 0.885811, loss_ss: 0.664183, loss_d: 0.221629
0.5372 --- loss: 0.592510, loss_ss: 0.511823, loss_d: 0.080687
0.5756 --- loss: 0.788319, loss_ss: 0.616565, loss_d: 0.171754
0.6140 --- loss: 1.340769, loss_ss: 0.862990, loss_d: 0.477779
0.6523 --- loss: 0.948060, loss_ss: 0.692733, loss_d: 0.255327
0.6907 --- loss: 0.783209, loss_ss: 0.643044, loss_d: 0.140165
0.7291 --- loss: 0.931406, loss_ss: 0.770904, loss_d: 0.160502
0.7675 --- loss: 1.031675, loss_ss: 0.845094, loss_d: 0.186581
0.8058 --- loss: 1.126473, loss_ss: 0.607125, loss_d: 0.519348
0.8442 --- loss: 1.006816, loss_ss: 0.708175, loss_d: 0.298641
0.8826 --- loss: 1.428200, loss_ss: 0.816988, loss_d: 0.611212
0.9210 --- loss: 1.040867, loss_ss: 0.787740, loss_d: 0.253127
0.9593 --- loss: 0.966526, loss_ss: 0.890496, loss_d: 0.076030
0.9977 --- loss: 1.055870, loss_ss: 0.883896, loss_d: 0.171973
Epoch finished! Loss: 1.0083074627014308
Starting epoch 6/10.
0.0000 --- loss: 0.732699, loss_ss: 0.515645, loss_d: 0.217054
0.0384 --- loss: 0.881766, loss_ss: 0.733334, loss_d: 0.148432
0.0767 --- loss: 0.699189, loss_ss: 0.561147, loss_d: 0.138042
0.1151 --- loss: 0.929506, loss_ss: 0.912805, loss_d: 0.016702
0.1535 --- loss: 1.421680, loss_ss: 0.836029, loss_d: 0.585652
0.1919 --- loss: 0.769805, loss_ss: 0.651118, loss_d: 0.118688
0.2302 --- loss: 0.901091, loss_ss: 0.815515, loss_d: 0.085575
0.2686 --- loss: 0.676790, loss_ss: 0.634764, loss_d: 0.042026
0.3070 --- loss: 0.821684, loss_ss: 0.710557, loss_d: 0.111127
0.3454 --- loss: 0.744570, loss_ss: 0.566148, loss_d: 0.178422
0.3837 --- loss: 0.878098, loss_ss: 0.860693, loss_d: 0.017405
0.4221 --- loss: 0.956935, loss_ss: 0.838599, loss_d: 0.118336
0.4605 --- loss: 0.931940, loss_ss: 0.741976, loss_d: 0.189964
0.4988 --- loss: 1.453178, loss_ss: 0.711936, loss_d: 0.741241
0.5372 --- loss: 0.796985, loss_ss: 0.640426, loss_d: 0.156560
0.5756 --- loss: 1.016858, loss_ss: 0.796581, loss_d: 0.220277
0.6140 --- loss: 1.040260, loss_ss: 0.733522, loss_d: 0.306738
0.6523 --- loss: 0.839908, loss_ss: 0.805345, loss_d: 0.034563
0.6907 --- loss: 0.873909, loss_ss: 0.662091, loss_d: 0.211818
0.7291 --- loss: 0.958817, loss_ss: 0.775663, loss_d: 0.183154
0.7675 --- loss: 0.802215, loss_ss: 0.764535, loss_d: 0.037680
0.8058 --- loss: 1.395774, loss_ss: 0.951840, loss_d: 0.443935
0.8442 --- loss: 1.023970, loss_ss: 0.915146, loss_d: 0.108823
0.8826 --- loss: 1.103675, loss_ss: 1.053738, loss_d: 0.049937
0.9210 --- loss: 0.707826, loss_ss: 0.686046, loss_d: 0.021780
0.9593 --- loss: 0.804445, loss_ss: 0.551696, loss_d: 0.252749
0.9977 --- loss: 0.827701, loss_ss: 0.766201, loss_d: 0.061500
Epoch finished! Loss: 0.9361180502634782
Starting epoch 7/10.
0.0000 --- loss: 1.100088, loss_ss: 0.940955, loss_d: 0.159133
0.0384 --- loss: 0.615946, loss_ss: 0.611667, loss_d: 0.004278
0.0767 --- loss: 0.708631, loss_ss: 0.631809, loss_d: 0.076821
0.1151 --- loss: 0.915748, loss_ss: 0.898248, loss_d: 0.017499
0.1535 --- loss: 0.642822, loss_ss: 0.588863, loss_d: 0.053959
0.1919 --- loss: 1.053925, loss_ss: 0.760799, loss_d: 0.293126
0.2302 --- loss: 0.906173, loss_ss: 0.857472, loss_d: 0.048701
0.2686 --- loss: 0.894618, loss_ss: 0.849128, loss_d: 0.045490
0.3070 --- loss: 0.964467, loss_ss: 0.927610, loss_d: 0.036858
0.3454 --- loss: 0.728585, loss_ss: 0.655085, loss_d: 0.073501
0.3837 --- loss: 0.693360, loss_ss: 0.580492, loss_d: 0.112868
0.4221 --- loss: 1.034721, loss_ss: 0.839565, loss_d: 0.195156
0.4605 --- loss: 1.151824, loss_ss: 0.754348, loss_d: 0.397476
0.4988 --- loss: 0.901647, loss_ss: 0.876588, loss_d: 0.025059
0.5372 --- loss: 0.763910, loss_ss: 0.689445, loss_d: 0.074465
0.5756 --- loss: 0.877647, loss_ss: 0.844803, loss_d: 0.032845
0.6140 --- loss: 0.669248, loss_ss: 0.628875, loss_d: 0.040373
0.6523 --- loss: 0.741012, loss_ss: 0.721065, loss_d: 0.019947
0.6907 --- loss: 1.004122, loss_ss: 0.906502, loss_d: 0.097619
0.7291 --- loss: 1.216120, loss_ss: 0.442825, loss_d: 0.773295
0.7675 --- loss: 0.931358, loss_ss: 0.886677, loss_d: 0.044681
0.8058 --- loss: 0.434318, loss_ss: 0.376335, loss_d: 0.057982
0.8442 --- loss: 0.606994, loss_ss: 0.594254, loss_d: 0.012740
0.8826 --- loss: 0.847193, loss_ss: 0.826887, loss_d: 0.020306
0.9210 --- loss: 0.812614, loss_ss: 0.773616, loss_d: 0.038998
0.9593 --- loss: 0.721132, loss_ss: 0.704005, loss_d: 0.017127
0.9977 --- loss: 0.946121, loss_ss: 0.804601, loss_d: 0.141520
Epoch finished! Loss: 0.8995859614931621
Starting epoch 8/10.
0.0000 --- loss: 0.601274, loss_ss: 0.574163, loss_d: 0.027112
0.0384 --- loss: 0.900866, loss_ss: 0.599792, loss_d: 0.301074
0.0767 --- loss: 0.708783, loss_ss: 0.655220, loss_d: 0.053563
0.1151 --- loss: 0.927360, loss_ss: 0.774579, loss_d: 0.152782
0.1535 --- loss: 1.497370, loss_ss: 0.937360, loss_d: 0.560011
0.1919 --- loss: 1.165629, loss_ss: 0.816515, loss_d: 0.349114
0.2302 --- loss: 0.631399, loss_ss: 0.626099, loss_d: 0.005301
0.2686 --- loss: 1.296937, loss_ss: 0.615850, loss_d: 0.681088
0.3070 --- loss: 0.856915, loss_ss: 0.812870, loss_d: 0.044044
0.3454 --- loss: 0.856753, loss_ss: 0.795035, loss_d: 0.061718
0.3837 --- loss: 0.580973, loss_ss: 0.539073, loss_d: 0.041900
0.4221 --- loss: 0.725890, loss_ss: 0.639835, loss_d: 0.086055
0.4605 --- loss: 0.940287, loss_ss: 0.926132, loss_d: 0.014155
0.4988 --- loss: 0.893715, loss_ss: 0.847724, loss_d: 0.045990
0.5372 --- loss: 0.888086, loss_ss: 0.879737, loss_d: 0.008349
0.5756 --- loss: 1.134204, loss_ss: 0.736877, loss_d: 0.397328
0.6140 --- loss: 1.050237, loss_ss: 1.026832, loss_d: 0.023404
0.6523 --- loss: 0.601234, loss_ss: 0.571771, loss_d: 0.029463
0.6907 --- loss: 0.785312, loss_ss: 0.667997, loss_d: 0.117315
0.7291 --- loss: 0.814440, loss_ss: 0.641993, loss_d: 0.172447
0.7675 --- loss: 1.437299, loss_ss: 1.363279, loss_d: 0.074021
0.8058 --- loss: 0.746290, loss_ss: 0.651248, loss_d: 0.095042
0.8442 --- loss: 0.694332, loss_ss: 0.614913, loss_d: 0.079418
0.8826 --- loss: 1.272263, loss_ss: 0.377495, loss_d: 0.894768
0.9210 --- loss: 0.677693, loss_ss: 0.559160, loss_d: 0.118533
0.9593 --- loss: 0.616191, loss_ss: 0.588668, loss_d: 0.027523
0.9977 --- loss: 0.809396, loss_ss: 0.542429, loss_d: 0.266967
Epoch finished! Loss: 0.9008293209167627
Starting epoch 9/10.
0.0000 --- loss: 0.538913, loss_ss: 0.496384, loss_d: 0.042529
0.0384 --- loss: 1.384277, loss_ss: 1.039682, loss_d: 0.344595
0.0767 --- loss: 0.653498, loss_ss: 0.639928, loss_d: 0.013570
0.1151 --- loss: 1.412471, loss_ss: 0.942346, loss_d: 0.470125
0.1535 --- loss: 1.017673, loss_ss: 1.009932, loss_d: 0.007741
0.1919 --- loss: 0.770972, loss_ss: 0.567949, loss_d: 0.203022
0.2302 --- loss: 1.027678, loss_ss: 0.870150, loss_d: 0.157528
0.2686 --- loss: 0.890309, loss_ss: 0.884611, loss_d: 0.005698
0.3070 --- loss: 1.142793, loss_ss: 0.993032, loss_d: 0.149762
0.3454 --- loss: 1.337058, loss_ss: 1.060933, loss_d: 0.276125
0.3837 --- loss: 0.699961, loss_ss: 0.668954, loss_d: 0.031006
0.4221 --- loss: 0.984959, loss_ss: 0.584414, loss_d: 0.400546
0.4605 --- loss: 0.729015, loss_ss: 0.706067, loss_d: 0.022948
0.4988 --- loss: 0.724913, loss_ss: 0.638608, loss_d: 0.086305
0.5372 --- loss: 0.808963, loss_ss: 0.764735, loss_d: 0.044228
0.5756 --- loss: 0.840308, loss_ss: 0.822558, loss_d: 0.017749
0.6140 --- loss: 0.750487, loss_ss: 0.530566, loss_d: 0.219921
0.6523 --- loss: 0.986406, loss_ss: 0.489840, loss_d: 0.496565
0.6907 --- loss: 0.736295, loss_ss: 0.621959, loss_d: 0.114336
0.7291 --- loss: 1.514835, loss_ss: 1.146936, loss_d: 0.367899
0.7675 --- loss: 1.045533, loss_ss: 0.856339, loss_d: 0.189194
0.8058 --- loss: 1.002525, loss_ss: 0.881639, loss_d: 0.120886
0.8442 --- loss: 0.973949, loss_ss: 0.804714, loss_d: 0.169235
0.8826 --- loss: 0.847759, loss_ss: 0.785393, loss_d: 0.062366
0.9210 --- loss: 0.621353, loss_ss: 0.572484, loss_d: 0.048870
0.9593 --- loss: 1.157978, loss_ss: 0.899298, loss_d: 0.258680
0.9977 --- loss: 0.987144, loss_ss: 0.694388, loss_d: 0.292756
Epoch finished! Loss: 0.8674605449804893
Starting epoch 10/10.
0.0000 --- loss: 0.636315, loss_ss: 0.575101, loss_d: 0.061214
0.0384 --- loss: 1.183250, loss_ss: 1.142472, loss_d: 0.040778
0.0767 --- loss: 1.067652, loss_ss: 1.047502, loss_d: 0.020150
0.1151 --- loss: 1.031741, loss_ss: 0.922376, loss_d: 0.109365
0.1535 --- loss: 0.592551, loss_ss: 0.589374, loss_d: 0.003177
0.1919 --- loss: 1.068950, loss_ss: 1.054858, loss_d: 0.014092
0.2302 --- loss: 0.965898, loss_ss: 0.869303, loss_d: 0.096595
0.2686 --- loss: 0.824881, loss_ss: 0.782275, loss_d: 0.042606
0.3070 --- loss: 0.609568, loss_ss: 0.602296, loss_d: 0.007272
0.3454 --- loss: 0.629306, loss_ss: 0.616437, loss_d: 0.012869
0.3837 --- loss: 0.799305, loss_ss: 0.785945, loss_d: 0.013360
0.4221 --- loss: 0.945251, loss_ss: 0.918819, loss_d: 0.026432
0.4605 --- loss: 0.728510, loss_ss: 0.718875, loss_d: 0.009635
0.4988 --- loss: 0.641888, loss_ss: 0.628234, loss_d: 0.013653
0.5372 --- loss: 0.596304, loss_ss: 0.576474, loss_d: 0.019831
0.5756 --- loss: 0.676964, loss_ss: 0.642418, loss_d: 0.034546
0.6140 --- loss: 0.865179, loss_ss: 0.781872, loss_d: 0.083307
0.6523 --- loss: 0.648372, loss_ss: 0.636707, loss_d: 0.011665
0.6907 --- loss: 0.466778, loss_ss: 0.462683, loss_d: 0.004096
0.7291 --- loss: 0.761772, loss_ss: 0.741921, loss_d: 0.019851
0.7675 --- loss: 0.863742, loss_ss: 0.818442, loss_d: 0.045300
0.8058 --- loss: 0.606851, loss_ss: 0.481176, loss_d: 0.125674
0.8442 --- loss: 0.693332, loss_ss: 0.662621, loss_d: 0.030711
0.8826 --- loss: 1.152988, loss_ss: 0.712790, loss_d: 0.440198
0.9210 --- loss: 0.739911, loss_ss: 0.732405, loss_d: 0.007506
0.9593 --- loss: 0.645135, loss_ss: 0.638387, loss_d: 0.006748
0.9977 --- loss: 1.545611, loss_ss: 1.151066, loss_d: 0.394545
Epoch finished! Loss: 0.8350226576511677
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7125
             precision    recall  f1-score   support

        0.0       0.72      0.58      0.64        57
        1.0       0.19      0.82      0.31        60
        2.0       0.96      0.73      0.83       496
        3.0       0.82      0.88      0.85        90
        4.0       0.89      0.63      0.74       257

avg / total       0.87      0.71      0.76       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.15  57.89   98.56  71.74     64.08
1  76.88  81.67   76.56  18.85     30.62
2  84.38  72.98   96.55  95.77     82.84
3  97.08  87.78   98.05  82.29     84.95
4  88.02  62.65   97.30  89.44     73.68
Total accuracy: 71.25%
Average sen: 72.59%
Average spec: 93.40%
Macro f1-score: 67.23%
Diagnosis acc on 15mins: 1.0
[1.         1.         0.99999738 0.99997926 0.99999988 0.9999994
 1.         1.         0.99999964 0.99999988 1.         0.99999869
 0.99999583 1.         0.99999869 0.99999964 0.99999988 0.99999785
 0.99999988 0.99983466 0.99999928 1.         0.99999988 0.99999785
 0.99999833 0.99999905 0.99999833 0.99999988 0.99999988 0.99999988
 1.         1.        ]
pred: 0.9999935291707516, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.343145, loss_ss: 1.609641, loss_d: 0.733504
0.0384 --- loss: 2.071861, loss_ss: 1.518986, loss_d: 0.552875
0.0768 --- loss: 2.163039, loss_ss: 1.446925, loss_d: 0.716114
0.1152 --- loss: 1.951309, loss_ss: 1.412411, loss_d: 0.538897
0.1536 --- loss: 2.019675, loss_ss: 1.439558, loss_d: 0.580118
0.1919 --- loss: 1.981763, loss_ss: 1.524457, loss_d: 0.457306
0.2303 --- loss: 2.059836, loss_ss: 1.252688, loss_d: 0.807149
0.2687 --- loss: 1.802395, loss_ss: 1.239637, loss_d: 0.562758
0.3071 --- loss: 1.783062, loss_ss: 1.217901, loss_d: 0.565162
0.3455 --- loss: 1.868713, loss_ss: 1.212380, loss_d: 0.656333
0.3839 --- loss: 1.868745, loss_ss: 1.220199, loss_d: 0.648546
0.4223 --- loss: 1.733853, loss_ss: 1.346163, loss_d: 0.387689
0.4607 --- loss: 1.912737, loss_ss: 1.160908, loss_d: 0.751829
0.4990 --- loss: 1.913666, loss_ss: 1.316518, loss_d: 0.597148
0.5374 --- loss: 1.598479, loss_ss: 1.147387, loss_d: 0.451092
0.5758 --- loss: 1.749499, loss_ss: 1.166965, loss_d: 0.582534
0.6142 --- loss: 1.565445, loss_ss: 1.217260, loss_d: 0.348184
0.6526 --- loss: 1.531730, loss_ss: 1.117348, loss_d: 0.414381
0.6910 --- loss: 1.417366, loss_ss: 1.164365, loss_d: 0.253001
0.7294 --- loss: 1.785289, loss_ss: 1.057366, loss_d: 0.727922
0.7678 --- loss: 1.475159, loss_ss: 1.192908, loss_d: 0.282251
0.8061 --- loss: 2.086169, loss_ss: 1.218395, loss_d: 0.867774
0.8445 --- loss: 1.393534, loss_ss: 1.141674, loss_d: 0.251860
0.8829 --- loss: 1.657976, loss_ss: 1.274922, loss_d: 0.383054
0.9213 --- loss: 1.403904, loss_ss: 1.092337, loss_d: 0.311567
0.9597 --- loss: 1.319188, loss_ss: 1.026440, loss_d: 0.292748
0.9981 --- loss: 1.755188, loss_ss: 1.368576, loss_d: 0.386611
Epoch finished! Loss: 1.7993486936275775
Starting epoch 2/10.
0.0000 --- loss: 2.073386, loss_ss: 1.392478, loss_d: 0.680909
0.0384 --- loss: 1.576609, loss_ss: 1.120372, loss_d: 0.456236
0.0768 --- loss: 1.314511, loss_ss: 1.029569, loss_d: 0.284942
0.1152 --- loss: 1.615773, loss_ss: 1.053378, loss_d: 0.562396
0.1536 --- loss: 1.586193, loss_ss: 1.252208, loss_d: 0.333985
0.1919 --- loss: 2.011042, loss_ss: 1.047158, loss_d: 0.963884
0.2303 --- loss: 1.348815, loss_ss: 1.057155, loss_d: 0.291660
0.2687 --- loss: 1.894382, loss_ss: 0.986949, loss_d: 0.907432
0.3071 --- loss: 1.855882, loss_ss: 0.980281, loss_d: 0.875601
0.3455 --- loss: 1.447270, loss_ss: 0.974089, loss_d: 0.473181
0.3839 --- loss: 1.261822, loss_ss: 1.152460, loss_d: 0.109362
0.4223 --- loss: 1.179880, loss_ss: 1.016192, loss_d: 0.163688
0.4607 --- loss: 1.430581, loss_ss: 1.023925, loss_d: 0.406656
0.4990 --- loss: 1.942066, loss_ss: 1.528231, loss_d: 0.413835
0.5374 --- loss: 1.397564, loss_ss: 0.977366, loss_d: 0.420197
0.5758 --- loss: 1.404942, loss_ss: 1.056816, loss_d: 0.348126
0.6142 --- loss: 0.934257, loss_ss: 0.778597, loss_d: 0.155660
0.6526 --- loss: 1.266617, loss_ss: 0.979559, loss_d: 0.287058
0.6910 --- loss: 1.134155, loss_ss: 0.868718, loss_d: 0.265437
0.7294 --- loss: 1.281044, loss_ss: 0.756761, loss_d: 0.524283
0.7678 --- loss: 1.440100, loss_ss: 1.335394, loss_d: 0.104706
0.8061 --- loss: 1.392811, loss_ss: 1.037958, loss_d: 0.354853
0.8445 --- loss: 0.992321, loss_ss: 0.903092, loss_d: 0.089229
0.8829 --- loss: 1.478773, loss_ss: 1.276305, loss_d: 0.202468
0.9213 --- loss: 1.366228, loss_ss: 0.908872, loss_d: 0.457356
0.9597 --- loss: 1.407475, loss_ss: 1.114115, loss_d: 0.293361
0.9981 --- loss: 2.166571, loss_ss: 0.847912, loss_d: 1.318659
Epoch finished! Loss: 1.3917976963978547
Starting epoch 3/10.
0.0000 --- loss: 1.585902, loss_ss: 1.406942, loss_d: 0.178960
0.0384 --- loss: 1.066728, loss_ss: 0.761775, loss_d: 0.304953
0.0768 --- loss: 1.223101, loss_ss: 1.100982, loss_d: 0.122119
0.1152 --- loss: 1.451400, loss_ss: 1.066105, loss_d: 0.385295
0.1536 --- loss: 0.994715, loss_ss: 0.902528, loss_d: 0.092188
0.1919 --- loss: 1.088064, loss_ss: 0.920875, loss_d: 0.167189
0.2303 --- loss: 0.988655, loss_ss: 0.858092, loss_d: 0.130563
0.2687 --- loss: 1.449824, loss_ss: 1.284560, loss_d: 0.165264
0.3071 --- loss: 1.406420, loss_ss: 1.061003, loss_d: 0.345417
0.3455 --- loss: 0.986975, loss_ss: 0.787411, loss_d: 0.199564
0.3839 --- loss: 0.863684, loss_ss: 0.745026, loss_d: 0.118658
0.4223 --- loss: 1.471506, loss_ss: 0.987464, loss_d: 0.484042
0.4607 --- loss: 1.100078, loss_ss: 0.948861, loss_d: 0.151217
0.4990 --- loss: 1.351152, loss_ss: 1.030423, loss_d: 0.320729
0.5374 --- loss: 1.467372, loss_ss: 0.731452, loss_d: 0.735920
0.5758 --- loss: 1.119259, loss_ss: 0.864875, loss_d: 0.254384
0.6142 --- loss: 1.072731, loss_ss: 0.948340, loss_d: 0.124391
0.6526 --- loss: 1.489540, loss_ss: 0.736907, loss_d: 0.752634
0.6910 --- loss: 1.121273, loss_ss: 1.040366, loss_d: 0.080906
0.7294 --- loss: 1.082864, loss_ss: 0.952176, loss_d: 0.130688
0.7678 --- loss: 1.140965, loss_ss: 0.769594, loss_d: 0.371371
0.8061 --- loss: 0.924385, loss_ss: 0.757965, loss_d: 0.166420
0.8445 --- loss: 1.027431, loss_ss: 0.769934, loss_d: 0.257496
0.8829 --- loss: 0.836766, loss_ss: 0.637113, loss_d: 0.199653
0.9213 --- loss: 1.068866, loss_ss: 0.823141, loss_d: 0.245726
0.9597 --- loss: 1.184646, loss_ss: 1.004881, loss_d: 0.179765
0.9981 --- loss: 1.278574, loss_ss: 0.944517, loss_d: 0.334057
Epoch finished! Loss: 1.191008332830209
Starting epoch 4/10.
0.0000 --- loss: 1.117119, loss_ss: 0.908577, loss_d: 0.208542
0.0384 --- loss: 0.835080, loss_ss: 0.610133, loss_d: 0.224948
0.0768 --- loss: 1.095185, loss_ss: 0.793455, loss_d: 0.301730
0.1152 --- loss: 1.400240, loss_ss: 0.769704, loss_d: 0.630536
0.1536 --- loss: 1.488771, loss_ss: 1.368080, loss_d: 0.120691
0.1919 --- loss: 1.194808, loss_ss: 1.009963, loss_d: 0.184846
0.2303 --- loss: 0.989516, loss_ss: 0.654630, loss_d: 0.334885
0.2687 --- loss: 0.797463, loss_ss: 0.721382, loss_d: 0.076081
0.3071 --- loss: 0.877160, loss_ss: 0.816132, loss_d: 0.061028
0.3455 --- loss: 0.933558, loss_ss: 0.874378, loss_d: 0.059181
0.3839 --- loss: 0.789353, loss_ss: 0.743941, loss_d: 0.045412
0.4223 --- loss: 1.014525, loss_ss: 0.951658, loss_d: 0.062867
0.4607 --- loss: 0.889216, loss_ss: 0.849920, loss_d: 0.039297
0.4990 --- loss: 0.973697, loss_ss: 0.698582, loss_d: 0.275115
0.5374 --- loss: 0.995821, loss_ss: 0.810078, loss_d: 0.185742
0.5758 --- loss: 1.018495, loss_ss: 0.824453, loss_d: 0.194043
0.6142 --- loss: 0.936480, loss_ss: 0.915810, loss_d: 0.020670
0.6526 --- loss: 0.790495, loss_ss: 0.752765, loss_d: 0.037730
0.6910 --- loss: 1.390231, loss_ss: 0.981507, loss_d: 0.408724
0.7294 --- loss: 1.071152, loss_ss: 0.749757, loss_d: 0.321394
0.7678 --- loss: 1.025486, loss_ss: 0.881444, loss_d: 0.144042
0.8061 --- loss: 1.525231, loss_ss: 1.332587, loss_d: 0.192644
0.8445 --- loss: 0.846265, loss_ss: 0.776751, loss_d: 0.069514
0.8829 --- loss: 1.097003, loss_ss: 1.003870, loss_d: 0.093133
0.9213 --- loss: 1.113214, loss_ss: 0.794999, loss_d: 0.318215
0.9597 --- loss: 0.798007, loss_ss: 0.762282, loss_d: 0.035724
0.9981 --- loss: 1.208867, loss_ss: 1.193873, loss_d: 0.014994
Epoch finished! Loss: 1.0832671701908112
Starting epoch 5/10.
0.0000 --- loss: 1.600943, loss_ss: 0.721161, loss_d: 0.879782
0.0384 --- loss: 0.852458, loss_ss: 0.610638, loss_d: 0.241820
0.0768 --- loss: 0.871858, loss_ss: 0.806953, loss_d: 0.064904
0.1152 --- loss: 1.242599, loss_ss: 1.185473, loss_d: 0.057126
0.1536 --- loss: 1.072797, loss_ss: 0.888962, loss_d: 0.183835
0.1919 --- loss: 1.348353, loss_ss: 0.713493, loss_d: 0.634860
0.2303 --- loss: 0.861449, loss_ss: 0.727561, loss_d: 0.133888
0.2687 --- loss: 0.996519, loss_ss: 0.978065, loss_d: 0.018454
0.3071 --- loss: 0.970502, loss_ss: 0.869680, loss_d: 0.100822
0.3455 --- loss: 1.027203, loss_ss: 0.861106, loss_d: 0.166097
0.3839 --- loss: 1.119261, loss_ss: 0.934151, loss_d: 0.185110
0.4223 --- loss: 0.632493, loss_ss: 0.470808, loss_d: 0.161685
0.4607 --- loss: 0.825262, loss_ss: 0.788835, loss_d: 0.036427
0.4990 --- loss: 0.851451, loss_ss: 0.782410, loss_d: 0.069041
0.5374 --- loss: 0.819056, loss_ss: 0.781125, loss_d: 0.037932
0.5758 --- loss: 1.005929, loss_ss: 0.823036, loss_d: 0.182893
0.6142 --- loss: 0.601604, loss_ss: 0.559055, loss_d: 0.042548
0.6526 --- loss: 0.850129, loss_ss: 0.744254, loss_d: 0.105875
0.6910 --- loss: 0.955831, loss_ss: 0.827529, loss_d: 0.128302
0.7294 --- loss: 0.902403, loss_ss: 0.858922, loss_d: 0.043481
0.7678 --- loss: 1.189469, loss_ss: 0.940538, loss_d: 0.248931
0.8061 --- loss: 1.023915, loss_ss: 0.820318, loss_d: 0.203597
0.8445 --- loss: 0.766304, loss_ss: 0.726353, loss_d: 0.039951
0.8829 --- loss: 0.995114, loss_ss: 0.860198, loss_d: 0.134915
0.9213 --- loss: 1.094930, loss_ss: 1.017161, loss_d: 0.077769
0.9597 --- loss: 0.839871, loss_ss: 0.772003, loss_d: 0.067868
0.9981 --- loss: 0.874701, loss_ss: 0.821358, loss_d: 0.053343
Epoch finished! Loss: 0.9844001724169804
Starting epoch 6/10.
0.0000 --- loss: 0.815891, loss_ss: 0.690777, loss_d: 0.125114
0.0384 --- loss: 1.025357, loss_ss: 0.923151, loss_d: 0.102206
0.0768 --- loss: 0.856127, loss_ss: 0.649157, loss_d: 0.206969
0.1152 --- loss: 1.028374, loss_ss: 0.735358, loss_d: 0.293015
0.1536 --- loss: 1.029058, loss_ss: 0.756800, loss_d: 0.272258
0.1919 --- loss: 1.040443, loss_ss: 0.994218, loss_d: 0.046226
0.2303 --- loss: 1.036370, loss_ss: 0.870069, loss_d: 0.166301
0.2687 --- loss: 1.113128, loss_ss: 1.041057, loss_d: 0.072072
0.3071 --- loss: 0.792796, loss_ss: 0.604232, loss_d: 0.188564
0.3455 --- loss: 1.868387, loss_ss: 1.058542, loss_d: 0.809845
0.3839 --- loss: 0.892978, loss_ss: 0.878647, loss_d: 0.014332
0.4223 --- loss: 0.603459, loss_ss: 0.584197, loss_d: 0.019261
0.4607 --- loss: 0.653083, loss_ss: 0.629027, loss_d: 0.024057
0.4990 --- loss: 1.606449, loss_ss: 1.380563, loss_d: 0.225886
0.5374 --- loss: 0.641969, loss_ss: 0.621244, loss_d: 0.020725
0.5758 --- loss: 0.624920, loss_ss: 0.599090, loss_d: 0.025830
0.6142 --- loss: 1.138448, loss_ss: 1.095345, loss_d: 0.043103
0.6526 --- loss: 0.700105, loss_ss: 0.595915, loss_d: 0.104190
0.6910 --- loss: 0.977291, loss_ss: 0.869798, loss_d: 0.107493
0.7294 --- loss: 0.989605, loss_ss: 0.837694, loss_d: 0.151911
0.7678 --- loss: 0.945000, loss_ss: 0.766289, loss_d: 0.178711
0.8061 --- loss: 0.775737, loss_ss: 0.716665, loss_d: 0.059072
0.8445 --- loss: 1.262880, loss_ss: 0.758083, loss_d: 0.504797
0.8829 --- loss: 0.762237, loss_ss: 0.660522, loss_d: 0.101715
0.9213 --- loss: 1.149595, loss_ss: 1.114691, loss_d: 0.034904
0.9597 --- loss: 1.127452, loss_ss: 1.091360, loss_d: 0.036092
0.9981 --- loss: 2.055871, loss_ss: 1.038002, loss_d: 1.017869
Epoch finished! Loss: 0.9744029531112084
Starting epoch 7/10.
0.0000 --- loss: 0.927448, loss_ss: 0.687357, loss_d: 0.240091
0.0384 --- loss: 0.424030, loss_ss: 0.379410, loss_d: 0.044620
0.0768 --- loss: 1.247487, loss_ss: 1.201698, loss_d: 0.045789
0.1152 --- loss: 0.942310, loss_ss: 0.907990, loss_d: 0.034319
0.1536 --- loss: 0.903252, loss_ss: 0.853808, loss_d: 0.049444
0.1919 --- loss: 1.215929, loss_ss: 0.760362, loss_d: 0.455567
0.2303 --- loss: 1.237144, loss_ss: 0.911717, loss_d: 0.325428
0.2687 --- loss: 0.975028, loss_ss: 0.911099, loss_d: 0.063929
0.3071 --- loss: 0.981451, loss_ss: 0.945828, loss_d: 0.035623
0.3455 --- loss: 0.658635, loss_ss: 0.591474, loss_d: 0.067162
0.3839 --- loss: 1.381729, loss_ss: 0.886016, loss_d: 0.495713
0.4223 --- loss: 0.797479, loss_ss: 0.648593, loss_d: 0.148886
0.4607 --- loss: 0.742636, loss_ss: 0.653479, loss_d: 0.089158
0.4990 --- loss: 0.774598, loss_ss: 0.691768, loss_d: 0.082830
0.5374 --- loss: 0.636452, loss_ss: 0.620810, loss_d: 0.015643
0.5758 --- loss: 1.097290, loss_ss: 1.058416, loss_d: 0.038873
0.6142 --- loss: 0.466154, loss_ss: 0.408542, loss_d: 0.057611
0.6526 --- loss: 1.084722, loss_ss: 1.062135, loss_d: 0.022588
0.6910 --- loss: 0.833423, loss_ss: 0.751868, loss_d: 0.081555
0.7294 --- loss: 0.883153, loss_ss: 0.682076, loss_d: 0.201077
0.7678 --- loss: 0.877084, loss_ss: 0.737946, loss_d: 0.139138
0.8061 --- loss: 0.875717, loss_ss: 0.824437, loss_d: 0.051280
0.8445 --- loss: 0.805137, loss_ss: 0.796667, loss_d: 0.008471
0.8829 --- loss: 0.479307, loss_ss: 0.459322, loss_d: 0.019985
0.9213 --- loss: 0.922406, loss_ss: 0.758493, loss_d: 0.163914
0.9597 --- loss: 0.948240, loss_ss: 0.724207, loss_d: 0.224033
0.9981 --- loss: 1.639702, loss_ss: 1.518931, loss_d: 0.120771
Epoch finished! Loss: 0.8985670915016761
Starting epoch 8/10.
0.0000 --- loss: 0.785485, loss_ss: 0.673952, loss_d: 0.111533
0.0384 --- loss: 0.757773, loss_ss: 0.744590, loss_d: 0.013183
0.0768 --- loss: 0.800602, loss_ss: 0.787452, loss_d: 0.013150
0.1152 --- loss: 0.848137, loss_ss: 0.677317, loss_d: 0.170819
0.1536 --- loss: 0.619217, loss_ss: 0.424702, loss_d: 0.194515
0.1919 --- loss: 1.089072, loss_ss: 0.942542, loss_d: 0.146529
0.2303 --- loss: 0.977442, loss_ss: 0.632952, loss_d: 0.344490
0.2687 --- loss: 0.812910, loss_ss: 0.703905, loss_d: 0.109006
0.3071 --- loss: 0.758960, loss_ss: 0.746278, loss_d: 0.012683
0.3455 --- loss: 0.798901, loss_ss: 0.769386, loss_d: 0.029516
0.3839 --- loss: 1.006763, loss_ss: 0.701160, loss_d: 0.305603
0.4223 --- loss: 0.555174, loss_ss: 0.524980, loss_d: 0.030194
0.4607 --- loss: 0.872309, loss_ss: 0.829884, loss_d: 0.042424
0.4990 --- loss: 1.028689, loss_ss: 0.787402, loss_d: 0.241286
0.5374 --- loss: 0.614314, loss_ss: 0.582867, loss_d: 0.031447
0.5758 --- loss: 0.917348, loss_ss: 0.886253, loss_d: 0.031096
0.6142 --- loss: 0.896521, loss_ss: 0.880075, loss_d: 0.016446
0.6526 --- loss: 0.747837, loss_ss: 0.734503, loss_d: 0.013334
0.6910 --- loss: 1.166990, loss_ss: 0.971116, loss_d: 0.195874
0.7294 --- loss: 0.619931, loss_ss: 0.606638, loss_d: 0.013293
0.7678 --- loss: 0.696860, loss_ss: 0.680083, loss_d: 0.016777
0.8061 --- loss: 0.684419, loss_ss: 0.674416, loss_d: 0.010003
0.8445 --- loss: 0.916206, loss_ss: 0.886795, loss_d: 0.029411
0.8829 --- loss: 0.531365, loss_ss: 0.440602, loss_d: 0.090763
0.9213 --- loss: 0.961519, loss_ss: 0.882733, loss_d: 0.078786
0.9597 --- loss: 0.975074, loss_ss: 0.712929, loss_d: 0.262145
0.9981 --- loss: 0.854238, loss_ss: 0.789057, loss_d: 0.065181
Epoch finished! Loss: 0.8467388808727264
Starting epoch 9/10.
0.0000 --- loss: 0.763237, loss_ss: 0.697754, loss_d: 0.065483
0.0384 --- loss: 0.656361, loss_ss: 0.627422, loss_d: 0.028939
0.0768 --- loss: 0.764459, loss_ss: 0.493181, loss_d: 0.271278
0.1152 --- loss: 0.927215, loss_ss: 0.917436, loss_d: 0.009779
0.1536 --- loss: 0.808727, loss_ss: 0.686455, loss_d: 0.122272
0.1919 --- loss: 0.595096, loss_ss: 0.589895, loss_d: 0.005201
0.2303 --- loss: 0.788969, loss_ss: 0.650607, loss_d: 0.138362
0.2687 --- loss: 1.272009, loss_ss: 1.252309, loss_d: 0.019699
0.3071 --- loss: 0.712733, loss_ss: 0.705246, loss_d: 0.007487
0.3455 --- loss: 0.765075, loss_ss: 0.760582, loss_d: 0.004493
0.3839 --- loss: 0.505440, loss_ss: 0.454240, loss_d: 0.051200
0.4223 --- loss: 1.123137, loss_ss: 0.535232, loss_d: 0.587905
0.4607 --- loss: 0.773813, loss_ss: 0.767888, loss_d: 0.005924
0.4990 --- loss: 0.918862, loss_ss: 0.605706, loss_d: 0.313157
0.5374 --- loss: 0.556836, loss_ss: 0.526728, loss_d: 0.030108
0.5758 --- loss: 0.740570, loss_ss: 0.715602, loss_d: 0.024968
0.6142 --- loss: 0.749640, loss_ss: 0.591050, loss_d: 0.158591
0.6526 --- loss: 0.831249, loss_ss: 0.797984, loss_d: 0.033265
0.6910 --- loss: 0.896797, loss_ss: 0.880954, loss_d: 0.015843
0.7294 --- loss: 0.935288, loss_ss: 0.688307, loss_d: 0.246980
0.7678 --- loss: 1.263099, loss_ss: 1.067547, loss_d: 0.195552
0.8061 --- loss: 0.926760, loss_ss: 0.710356, loss_d: 0.216404
0.8445 --- loss: 0.813930, loss_ss: 0.794821, loss_d: 0.019109
0.8829 --- loss: 0.814445, loss_ss: 0.741790, loss_d: 0.072655
0.9213 --- loss: 0.776371, loss_ss: 0.727889, loss_d: 0.048482
0.9597 --- loss: 0.564298, loss_ss: 0.517389, loss_d: 0.046909
0.9981 --- loss: 1.031774, loss_ss: 1.011824, loss_d: 0.019950
Epoch finished! Loss: 0.8523829554135983
Starting epoch 10/10.
0.0000 --- loss: 1.045565, loss_ss: 0.627575, loss_d: 0.417991
0.0384 --- loss: 0.826276, loss_ss: 0.810241, loss_d: 0.016034
0.0768 --- loss: 0.911540, loss_ss: 0.771927, loss_d: 0.139612
0.1152 --- loss: 0.923615, loss_ss: 0.839955, loss_d: 0.083661
0.1536 --- loss: 0.522843, loss_ss: 0.501959, loss_d: 0.020884
0.1919 --- loss: 0.702302, loss_ss: 0.617269, loss_d: 0.085033
0.2303 --- loss: 0.949108, loss_ss: 0.938941, loss_d: 0.010167
0.2687 --- loss: 0.991665, loss_ss: 0.965700, loss_d: 0.025965
0.3071 --- loss: 0.807668, loss_ss: 0.789729, loss_d: 0.017939
0.3455 --- loss: 0.830955, loss_ss: 0.536083, loss_d: 0.294871
0.3839 --- loss: 1.007340, loss_ss: 0.808709, loss_d: 0.198631
0.4223 --- loss: 0.612300, loss_ss: 0.569164, loss_d: 0.043136
0.4607 --- loss: 0.816146, loss_ss: 0.775843, loss_d: 0.040303
0.4990 --- loss: 0.630427, loss_ss: 0.557362, loss_d: 0.073065
0.5374 --- loss: 1.064106, loss_ss: 1.059382, loss_d: 0.004724
0.5758 --- loss: 0.633710, loss_ss: 0.607541, loss_d: 0.026169
0.6142 --- loss: 0.819625, loss_ss: 0.736351, loss_d: 0.083274
0.6526 --- loss: 0.508671, loss_ss: 0.430944, loss_d: 0.077727
0.6910 --- loss: 0.623593, loss_ss: 0.620862, loss_d: 0.002731
0.7294 --- loss: 0.549726, loss_ss: 0.547440, loss_d: 0.002285
0.7678 --- loss: 0.903465, loss_ss: 0.663989, loss_d: 0.239475
0.8061 --- loss: 0.766820, loss_ss: 0.721105, loss_d: 0.045715
0.8445 --- loss: 0.553028, loss_ss: 0.483393, loss_d: 0.069635
0.8829 --- loss: 0.690048, loss_ss: 0.687207, loss_d: 0.002841
0.9213 --- loss: 0.506446, loss_ss: 0.505064, loss_d: 0.001382
0.9597 --- loss: 0.590158, loss_ss: 0.579682, loss_d: 0.010476
0.9981 --- loss: 0.559460, loss_ss: 0.542078, loss_d: 0.017382
Epoch finished! Loss: 0.8261270825679485
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5878787878787879
             precision    recall  f1-score   support

        0.0       0.80      0.11      0.19       219
        1.0       0.26      0.24      0.25       143
        2.0       0.54      0.84      0.65       221
        3.0       0.98      0.90      0.93       271
        4.0       0.41      0.71      0.52       136

avg / total       0.66      0.59      0.55       990
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  79.70  10.96   99.22  80.00     19.28
1  78.99  23.78   88.31  25.56     24.64
2  80.30  83.71   79.32  53.78     65.49
3  96.57  89.67   99.17  97.59     93.46
4  82.02  70.59   83.84  41.03     51.89
Total accuracy: 58.79%
Average sen: 55.74%
Average spec: 89.97%
Macro f1-score: 50.95%
Diagnosis acc on 15mins: 1.0
[0.99999547 0.99999928 0.9998982  0.99998474 0.9999944  0.99999964
 1.         1.         1.         0.99999475 1.         1.
 0.99999583 0.99995911 0.9999193  0.99999416 1.         1.
 1.         0.99994552 1.         0.99999881 0.99851412 1.
 1.         1.         0.99999988 1.         0.99999988 0.99999249
 0.99998534 0.99999619 0.99999738]
pred: 0.9999443780292164, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.419000, loss_ss: 1.723329, loss_d: 0.695671
0.0384 --- loss: 2.203497, loss_ss: 1.659217, loss_d: 0.544280
0.0769 --- loss: 2.103872, loss_ss: 1.624462, loss_d: 0.479411
0.1153 --- loss: 1.806650, loss_ss: 1.577157, loss_d: 0.229493
0.1538 --- loss: 2.308271, loss_ss: 1.584811, loss_d: 0.723460
0.1922 --- loss: 2.490367, loss_ss: 1.449424, loss_d: 1.040943
0.2307 --- loss: 2.047184, loss_ss: 1.464502, loss_d: 0.582683
0.2691 --- loss: 2.131456, loss_ss: 1.458718, loss_d: 0.672738
0.3076 --- loss: 2.298557, loss_ss: 1.778944, loss_d: 0.519612
0.3460 --- loss: 1.815535, loss_ss: 1.296511, loss_d: 0.519024
0.3845 --- loss: 2.283400, loss_ss: 1.473097, loss_d: 0.810303
0.4229 --- loss: 1.836855, loss_ss: 1.265901, loss_d: 0.570954
0.4614 --- loss: 1.856256, loss_ss: 1.269483, loss_d: 0.586772
0.4998 --- loss: 1.784447, loss_ss: 1.377090, loss_d: 0.407358
0.5383 --- loss: 1.625659, loss_ss: 1.184530, loss_d: 0.441129
0.5767 --- loss: 2.008034, loss_ss: 1.397233, loss_d: 0.610800
0.6151 --- loss: 1.739356, loss_ss: 1.327027, loss_d: 0.412329
0.6536 --- loss: 2.040848, loss_ss: 1.331074, loss_d: 0.709774
0.6920 --- loss: 2.011994, loss_ss: 1.205135, loss_d: 0.806859
0.7305 --- loss: 1.604384, loss_ss: 1.096014, loss_d: 0.508371
0.7689 --- loss: 1.646360, loss_ss: 1.081146, loss_d: 0.565214
0.8074 --- loss: 1.658712, loss_ss: 1.182689, loss_d: 0.476022
0.8458 --- loss: 2.151598, loss_ss: 1.303802, loss_d: 0.847795
0.8843 --- loss: 1.907158, loss_ss: 1.314173, loss_d: 0.592985
0.9227 --- loss: 1.391485, loss_ss: 1.125292, loss_d: 0.266193
0.9612 --- loss: 1.449433, loss_ss: 1.153728, loss_d: 0.295704
0.9996 --- loss: 3.228301, loss_ss: 1.345041, loss_d: 1.883260
Epoch finished! Loss: 1.8827713374908155
Starting epoch 2/10.
0.0000 --- loss: 1.406795, loss_ss: 1.118033, loss_d: 0.288762
0.0384 --- loss: 1.541668, loss_ss: 1.119250, loss_d: 0.422417
0.0769 --- loss: 1.374383, loss_ss: 1.030012, loss_d: 0.344371
0.1153 --- loss: 1.349244, loss_ss: 1.165798, loss_d: 0.183446
0.1538 --- loss: 1.240006, loss_ss: 0.994481, loss_d: 0.245525
0.1922 --- loss: 1.284184, loss_ss: 1.040150, loss_d: 0.244034
0.2307 --- loss: 1.078047, loss_ss: 0.928982, loss_d: 0.149065
0.2691 --- loss: 1.489614, loss_ss: 1.222694, loss_d: 0.266920
0.3076 --- loss: 1.112313, loss_ss: 0.990819, loss_d: 0.121495
0.3460 --- loss: 1.627678, loss_ss: 0.901833, loss_d: 0.725845
0.3845 --- loss: 1.648457, loss_ss: 1.116503, loss_d: 0.531953
0.4229 --- loss: 2.082257, loss_ss: 0.908243, loss_d: 1.174014
0.4614 --- loss: 1.343703, loss_ss: 0.851440, loss_d: 0.492263
0.4998 --- loss: 1.589508, loss_ss: 1.345903, loss_d: 0.243605
0.5383 --- loss: 1.952176, loss_ss: 1.164060, loss_d: 0.788116
0.5767 --- loss: 1.069718, loss_ss: 0.998635, loss_d: 0.071084
0.6151 --- loss: 1.269895, loss_ss: 1.119169, loss_d: 0.150727
0.6536 --- loss: 1.336808, loss_ss: 1.096117, loss_d: 0.240691
0.6920 --- loss: 1.465655, loss_ss: 1.200190, loss_d: 0.265465
0.7305 --- loss: 1.852784, loss_ss: 1.028542, loss_d: 0.824242
0.7689 --- loss: 1.312379, loss_ss: 0.924683, loss_d: 0.387697
0.8074 --- loss: 1.637761, loss_ss: 1.407948, loss_d: 0.229812
0.8458 --- loss: 1.144221, loss_ss: 1.086666, loss_d: 0.057554
0.8843 --- loss: 1.199369, loss_ss: 1.142870, loss_d: 0.056499
0.9227 --- loss: 1.201224, loss_ss: 1.059567, loss_d: 0.141656
0.9612 --- loss: 1.377938, loss_ss: 1.026358, loss_d: 0.351580
0.9996 --- loss: 4.874518, loss_ss: 1.905149, loss_d: 2.969369
Epoch finished! Loss: 1.4268959870705238
Starting epoch 3/10.
0.0000 --- loss: 1.211354, loss_ss: 0.993595, loss_d: 0.217760
0.0384 --- loss: 1.284720, loss_ss: 1.123857, loss_d: 0.160863
0.0769 --- loss: 1.175540, loss_ss: 0.918947, loss_d: 0.256593
0.1153 --- loss: 1.248644, loss_ss: 1.107499, loss_d: 0.141145
0.1538 --- loss: 1.262904, loss_ss: 1.066402, loss_d: 0.196502
0.1922 --- loss: 1.594570, loss_ss: 0.972830, loss_d: 0.621740
0.2307 --- loss: 1.248071, loss_ss: 0.814700, loss_d: 0.433371
0.2691 --- loss: 1.161584, loss_ss: 0.924226, loss_d: 0.237357
0.3076 --- loss: 1.148961, loss_ss: 0.764632, loss_d: 0.384329
0.3460 --- loss: 1.058770, loss_ss: 0.970555, loss_d: 0.088215
0.3845 --- loss: 1.421441, loss_ss: 1.162940, loss_d: 0.258501
0.4229 --- loss: 1.094593, loss_ss: 1.050101, loss_d: 0.044492
0.4614 --- loss: 1.277231, loss_ss: 1.043970, loss_d: 0.233260
0.4998 --- loss: 1.213453, loss_ss: 1.001941, loss_d: 0.211512
0.5383 --- loss: 0.869186, loss_ss: 0.753520, loss_d: 0.115666
0.5767 --- loss: 1.368894, loss_ss: 1.081884, loss_d: 0.287010
0.6151 --- loss: 1.124894, loss_ss: 0.788665, loss_d: 0.336230
0.6536 --- loss: 0.777444, loss_ss: 0.656578, loss_d: 0.120866
0.6920 --- loss: 1.087732, loss_ss: 1.006999, loss_d: 0.080733
0.7305 --- loss: 1.505825, loss_ss: 1.074243, loss_d: 0.431581
0.7689 --- loss: 1.104984, loss_ss: 1.021611, loss_d: 0.083373
0.8074 --- loss: 0.932795, loss_ss: 0.789225, loss_d: 0.143570
0.8458 --- loss: 1.125536, loss_ss: 0.888259, loss_d: 0.237277
0.8843 --- loss: 1.090411, loss_ss: 0.904528, loss_d: 0.185882
0.9227 --- loss: 1.343357, loss_ss: 1.048560, loss_d: 0.294797
0.9612 --- loss: 1.043760, loss_ss: 0.840692, loss_d: 0.203069
0.9996 --- loss: 2.682267, loss_ss: 2.671802, loss_d: 0.010465
Epoch finished! Loss: 1.2120678069499822
Starting epoch 4/10.
0.0000 --- loss: 1.292629, loss_ss: 1.127558, loss_d: 0.165071
0.0384 --- loss: 1.401181, loss_ss: 0.810300, loss_d: 0.590881
0.0769 --- loss: 1.123744, loss_ss: 0.663448, loss_d: 0.460296
0.1153 --- loss: 1.035600, loss_ss: 0.972824, loss_d: 0.062776
0.1538 --- loss: 2.349574, loss_ss: 1.577955, loss_d: 0.771619
0.1922 --- loss: 0.918359, loss_ss: 0.792149, loss_d: 0.126210
0.2307 --- loss: 1.149967, loss_ss: 1.031689, loss_d: 0.118278
0.2691 --- loss: 1.186296, loss_ss: 0.776077, loss_d: 0.410219
0.3076 --- loss: 0.737052, loss_ss: 0.700995, loss_d: 0.036057
0.3460 --- loss: 1.105530, loss_ss: 1.041564, loss_d: 0.063966
0.3845 --- loss: 1.026010, loss_ss: 0.727806, loss_d: 0.298205
0.4229 --- loss: 0.849832, loss_ss: 0.776460, loss_d: 0.073372
0.4614 --- loss: 0.777009, loss_ss: 0.759032, loss_d: 0.017977
0.4998 --- loss: 1.552168, loss_ss: 0.726635, loss_d: 0.825533
0.5383 --- loss: 1.411723, loss_ss: 1.341867, loss_d: 0.069857
0.5767 --- loss: 0.989594, loss_ss: 0.832564, loss_d: 0.157030
0.6151 --- loss: 0.837393, loss_ss: 0.715077, loss_d: 0.122316
0.6536 --- loss: 0.737309, loss_ss: 0.615754, loss_d: 0.121554
0.6920 --- loss: 0.726403, loss_ss: 0.642757, loss_d: 0.083646
0.7305 --- loss: 0.875252, loss_ss: 0.650721, loss_d: 0.224531
0.7689 --- loss: 0.761222, loss_ss: 0.655008, loss_d: 0.106214
0.8074 --- loss: 1.021747, loss_ss: 0.959830, loss_d: 0.061917
0.8458 --- loss: 0.998744, loss_ss: 0.765036, loss_d: 0.233707
0.8843 --- loss: 0.847297, loss_ss: 0.704744, loss_d: 0.142553
0.9227 --- loss: 1.079010, loss_ss: 0.994545, loss_d: 0.084465
0.9612 --- loss: 0.735857, loss_ss: 0.643193, loss_d: 0.092665
0.9996 --- loss: 1.424747, loss_ss: 1.402722, loss_d: 0.022025
Epoch finished! Loss: 1.0736291110515594
Starting epoch 5/10.
0.0000 --- loss: 1.127099, loss_ss: 0.775682, loss_d: 0.351417
0.0384 --- loss: 0.756997, loss_ss: 0.700423, loss_d: 0.056573
0.0769 --- loss: 0.910559, loss_ss: 0.811257, loss_d: 0.099303
0.1153 --- loss: 1.010654, loss_ss: 0.995096, loss_d: 0.015558
0.1538 --- loss: 1.206728, loss_ss: 0.770180, loss_d: 0.436548
0.1922 --- loss: 0.987504, loss_ss: 0.867260, loss_d: 0.120245
0.2307 --- loss: 0.638485, loss_ss: 0.601939, loss_d: 0.036546
0.2691 --- loss: 0.913427, loss_ss: 0.885182, loss_d: 0.028245
0.3076 --- loss: 0.794304, loss_ss: 0.693582, loss_d: 0.100722
0.3460 --- loss: 1.456486, loss_ss: 1.366742, loss_d: 0.089744
0.3845 --- loss: 0.741911, loss_ss: 0.569026, loss_d: 0.172885
0.4229 --- loss: 1.138398, loss_ss: 0.874220, loss_d: 0.264178
0.4614 --- loss: 1.170640, loss_ss: 1.086670, loss_d: 0.083969
0.4998 --- loss: 0.735565, loss_ss: 0.674444, loss_d: 0.061121
0.5383 --- loss: 0.827117, loss_ss: 0.677096, loss_d: 0.150021
0.5767 --- loss: 1.005691, loss_ss: 0.912749, loss_d: 0.092941
0.6151 --- loss: 0.989572, loss_ss: 0.925981, loss_d: 0.063590
0.6536 --- loss: 1.000638, loss_ss: 0.816821, loss_d: 0.183817
0.6920 --- loss: 0.799147, loss_ss: 0.656956, loss_d: 0.142191
0.7305 --- loss: 0.853581, loss_ss: 0.616588, loss_d: 0.236993
0.7689 --- loss: 0.886228, loss_ss: 0.780300, loss_d: 0.105928
0.8074 --- loss: 0.907521, loss_ss: 0.599408, loss_d: 0.308113
0.8458 --- loss: 0.784524, loss_ss: 0.737154, loss_d: 0.047370
0.8843 --- loss: 0.899816, loss_ss: 0.836477, loss_d: 0.063340
0.9227 --- loss: 1.160509, loss_ss: 0.831296, loss_d: 0.329213
0.9612 --- loss: 1.389362, loss_ss: 1.052208, loss_d: 0.337154
0.9996 --- loss: 6.988973, loss_ss: 2.375654, loss_d: 4.613318
Epoch finished! Loss: 1.0218027121745623
Starting epoch 6/10.
0.0000 --- loss: 0.744200, loss_ss: 0.630906, loss_d: 0.113294
0.0384 --- loss: 1.153626, loss_ss: 1.030710, loss_d: 0.122916
0.0769 --- loss: 0.878109, loss_ss: 0.703854, loss_d: 0.174255
0.1153 --- loss: 0.729993, loss_ss: 0.646356, loss_d: 0.083637
0.1538 --- loss: 0.830144, loss_ss: 0.808201, loss_d: 0.021943
0.1922 --- loss: 1.323198, loss_ss: 1.089263, loss_d: 0.233935
0.2307 --- loss: 0.784275, loss_ss: 0.687475, loss_d: 0.096801
0.2691 --- loss: 1.030365, loss_ss: 1.003844, loss_d: 0.026520
0.3076 --- loss: 0.609094, loss_ss: 0.595362, loss_d: 0.013732
0.3460 --- loss: 0.708562, loss_ss: 0.664854, loss_d: 0.043708
0.3845 --- loss: 0.992962, loss_ss: 0.923886, loss_d: 0.069076
0.4229 --- loss: 0.856657, loss_ss: 0.687471, loss_d: 0.169186
0.4614 --- loss: 1.203544, loss_ss: 1.051418, loss_d: 0.152126
0.4998 --- loss: 1.077308, loss_ss: 0.836816, loss_d: 0.240492
0.5383 --- loss: 0.882119, loss_ss: 0.710037, loss_d: 0.172082
0.5767 --- loss: 1.247087, loss_ss: 1.158645, loss_d: 0.088442
0.6151 --- loss: 0.999374, loss_ss: 0.979378, loss_d: 0.019995
0.6536 --- loss: 1.292153, loss_ss: 1.203208, loss_d: 0.088944
0.6920 --- loss: 1.011636, loss_ss: 0.852164, loss_d: 0.159472
0.7305 --- loss: 0.812109, loss_ss: 0.651643, loss_d: 0.160465
0.7689 --- loss: 0.957148, loss_ss: 0.732815, loss_d: 0.224332
0.8074 --- loss: 0.869008, loss_ss: 0.795258, loss_d: 0.073749
0.8458 --- loss: 0.925219, loss_ss: 0.630412, loss_d: 0.294807
0.8843 --- loss: 0.811218, loss_ss: 0.712158, loss_d: 0.099060
0.9227 --- loss: 0.764290, loss_ss: 0.749999, loss_d: 0.014291
0.9612 --- loss: 1.059378, loss_ss: 0.893649, loss_d: 0.165729
0.9996 --- loss: 0.877270, loss_ss: 0.872759, loss_d: 0.004511
Epoch finished! Loss: 0.9548816149051372
Starting epoch 7/10.
0.0000 --- loss: 0.639242, loss_ss: 0.630071, loss_d: 0.009172
0.0384 --- loss: 0.714452, loss_ss: 0.623544, loss_d: 0.090908
0.0769 --- loss: 0.819692, loss_ss: 0.751244, loss_d: 0.068448
0.1153 --- loss: 1.083396, loss_ss: 0.923319, loss_d: 0.160077
0.1538 --- loss: 0.691108, loss_ss: 0.669932, loss_d: 0.021176
0.1922 --- loss: 0.700433, loss_ss: 0.675874, loss_d: 0.024559
0.2307 --- loss: 0.870249, loss_ss: 0.856954, loss_d: 0.013295
0.2691 --- loss: 0.570509, loss_ss: 0.553570, loss_d: 0.016939
0.3076 --- loss: 1.014883, loss_ss: 0.997059, loss_d: 0.017824
0.3460 --- loss: 0.524424, loss_ss: 0.510631, loss_d: 0.013793
0.3845 --- loss: 0.830248, loss_ss: 0.724920, loss_d: 0.105327
0.4229 --- loss: 0.784358, loss_ss: 0.700582, loss_d: 0.083776
0.4614 --- loss: 0.650223, loss_ss: 0.594956, loss_d: 0.055267
0.4998 --- loss: 1.007892, loss_ss: 0.971036, loss_d: 0.036856
0.5383 --- loss: 0.764044, loss_ss: 0.739962, loss_d: 0.024082
0.5767 --- loss: 0.649924, loss_ss: 0.630433, loss_d: 0.019490
0.6151 --- loss: 1.374210, loss_ss: 1.361201, loss_d: 0.013009
0.6536 --- loss: 1.203235, loss_ss: 0.725129, loss_d: 0.478106
0.6920 --- loss: 0.991080, loss_ss: 0.695258, loss_d: 0.295823
0.7305 --- loss: 1.010889, loss_ss: 0.882268, loss_d: 0.128620
0.7689 --- loss: 0.877161, loss_ss: 0.826211, loss_d: 0.050950
0.8074 --- loss: 0.525195, loss_ss: 0.492494, loss_d: 0.032701
0.8458 --- loss: 0.651304, loss_ss: 0.639045, loss_d: 0.012259
0.8843 --- loss: 0.613869, loss_ss: 0.592962, loss_d: 0.020907
0.9227 --- loss: 0.742584, loss_ss: 0.734070, loss_d: 0.008514
0.9612 --- loss: 0.927679, loss_ss: 0.887659, loss_d: 0.040020
0.9996 --- loss: 1.488715, loss_ss: 1.487103, loss_d: 0.001612
Epoch finished! Loss: 0.8967834830284118
Starting epoch 8/10.
0.0000 --- loss: 0.754082, loss_ss: 0.701051, loss_d: 0.053032
0.0384 --- loss: 0.679701, loss_ss: 0.629895, loss_d: 0.049805
0.0769 --- loss: 0.969709, loss_ss: 0.952677, loss_d: 0.017032
0.1153 --- loss: 1.192988, loss_ss: 0.958422, loss_d: 0.234566
0.1538 --- loss: 0.905747, loss_ss: 0.838188, loss_d: 0.067559
0.1922 --- loss: 0.800171, loss_ss: 0.556029, loss_d: 0.244143
0.2307 --- loss: 1.117088, loss_ss: 1.112653, loss_d: 0.004436
0.2691 --- loss: 0.830085, loss_ss: 0.816646, loss_d: 0.013439
0.3076 --- loss: 0.670212, loss_ss: 0.658225, loss_d: 0.011987
0.3460 --- loss: 0.837615, loss_ss: 0.798050, loss_d: 0.039564
0.3845 --- loss: 0.703428, loss_ss: 0.673542, loss_d: 0.029886
0.4229 --- loss: 1.044287, loss_ss: 1.031656, loss_d: 0.012631
0.4614 --- loss: 0.818037, loss_ss: 0.652722, loss_d: 0.165315
0.4998 --- loss: 0.895174, loss_ss: 0.845568, loss_d: 0.049606
0.5383 --- loss: 0.795834, loss_ss: 0.776811, loss_d: 0.019023
0.5767 --- loss: 0.886308, loss_ss: 0.842542, loss_d: 0.043766
0.6151 --- loss: 0.941841, loss_ss: 0.874423, loss_d: 0.067419
0.6536 --- loss: 0.685884, loss_ss: 0.651531, loss_d: 0.034353
0.6920 --- loss: 0.788514, loss_ss: 0.770985, loss_d: 0.017529
0.7305 --- loss: 1.118378, loss_ss: 0.744949, loss_d: 0.373429
0.7689 --- loss: 0.953636, loss_ss: 0.584978, loss_d: 0.368657
0.8074 --- loss: 1.027981, loss_ss: 1.013614, loss_d: 0.014367
0.8458 --- loss: 0.892641, loss_ss: 0.848631, loss_d: 0.044011
0.8843 --- loss: 0.885847, loss_ss: 0.769286, loss_d: 0.116561
0.9227 --- loss: 1.631253, loss_ss: 0.874294, loss_d: 0.756959
0.9612 --- loss: 1.112336, loss_ss: 0.790120, loss_d: 0.322216
0.9996 --- loss: 1.739649, loss_ss: 1.733789, loss_d: 0.005860
Epoch finished! Loss: 0.8729485747905877
Starting epoch 9/10.
0.0000 --- loss: 1.197963, loss_ss: 0.659610, loss_d: 0.538353
0.0384 --- loss: 1.009047, loss_ss: 0.726729, loss_d: 0.282318
0.0769 --- loss: 0.824622, loss_ss: 0.761035, loss_d: 0.063588
0.1153 --- loss: 0.610756, loss_ss: 0.592677, loss_d: 0.018079
0.1538 --- loss: 0.892461, loss_ss: 0.847928, loss_d: 0.044533
0.1922 --- loss: 1.042431, loss_ss: 0.953521, loss_d: 0.088909
0.2307 --- loss: 0.931814, loss_ss: 0.598723, loss_d: 0.333092
0.2691 --- loss: 0.691543, loss_ss: 0.668263, loss_d: 0.023280
0.3076 --- loss: 0.794035, loss_ss: 0.668287, loss_d: 0.125748
0.3460 --- loss: 0.722296, loss_ss: 0.719338, loss_d: 0.002958
0.3845 --- loss: 0.900405, loss_ss: 0.833666, loss_d: 0.066739
0.4229 --- loss: 0.728387, loss_ss: 0.703641, loss_d: 0.024745
0.4614 --- loss: 0.516792, loss_ss: 0.481635, loss_d: 0.035157
0.4998 --- loss: 0.873114, loss_ss: 0.841980, loss_d: 0.031135
0.5383 --- loss: 0.718809, loss_ss: 0.606226, loss_d: 0.112583
0.5767 --- loss: 0.705477, loss_ss: 0.684334, loss_d: 0.021142
0.6151 --- loss: 0.609674, loss_ss: 0.594684, loss_d: 0.014990
0.6536 --- loss: 0.723949, loss_ss: 0.683903, loss_d: 0.040046
0.6920 --- loss: 0.770943, loss_ss: 0.755870, loss_d: 0.015073
0.7305 --- loss: 0.697254, loss_ss: 0.693932, loss_d: 0.003322
0.7689 --- loss: 0.572508, loss_ss: 0.464978, loss_d: 0.107530
0.8074 --- loss: 0.744500, loss_ss: 0.722312, loss_d: 0.022188
0.8458 --- loss: 0.838047, loss_ss: 0.788339, loss_d: 0.049708
0.8843 --- loss: 0.693503, loss_ss: 0.678720, loss_d: 0.014784
0.9227 --- loss: 0.933047, loss_ss: 0.683521, loss_d: 0.249526
0.9612 --- loss: 0.608898, loss_ss: 0.527956, loss_d: 0.080941
0.9996 --- loss: 3.173820, loss_ss: 3.173730, loss_d: 0.000090
Epoch finished! Loss: 0.8491158083081245
Starting epoch 10/10.
0.0000 --- loss: 0.741484, loss_ss: 0.735032, loss_d: 0.006452
0.0384 --- loss: 0.824578, loss_ss: 0.819444, loss_d: 0.005134
0.0769 --- loss: 0.914796, loss_ss: 0.906985, loss_d: 0.007811
0.1153 --- loss: 0.684705, loss_ss: 0.675584, loss_d: 0.009121
0.1538 --- loss: 0.537112, loss_ss: 0.527497, loss_d: 0.009616
0.1922 --- loss: 0.977929, loss_ss: 0.971297, loss_d: 0.006632
0.2307 --- loss: 0.855354, loss_ss: 0.735080, loss_d: 0.120274
0.2691 --- loss: 1.224457, loss_ss: 0.758379, loss_d: 0.466078
0.3076 --- loss: 0.714575, loss_ss: 0.711060, loss_d: 0.003515
0.3460 --- loss: 0.863846, loss_ss: 0.853293, loss_d: 0.010552
0.3845 --- loss: 0.680436, loss_ss: 0.669835, loss_d: 0.010601
0.4229 --- loss: 0.680455, loss_ss: 0.679001, loss_d: 0.001454
0.4614 --- loss: 0.634234, loss_ss: 0.616672, loss_d: 0.017561
0.4998 --- loss: 0.911264, loss_ss: 0.870350, loss_d: 0.040914
0.5383 --- loss: 0.615915, loss_ss: 0.604107, loss_d: 0.011809
0.5767 --- loss: 1.589517, loss_ss: 1.127787, loss_d: 0.461730
0.6151 --- loss: 1.114877, loss_ss: 0.996161, loss_d: 0.118716
0.6536 --- loss: 0.725180, loss_ss: 0.722147, loss_d: 0.003034
0.6920 --- loss: 1.038631, loss_ss: 1.009508, loss_d: 0.029122
0.7305 --- loss: 0.690989, loss_ss: 0.675134, loss_d: 0.015855
0.7689 --- loss: 1.014416, loss_ss: 0.755220, loss_d: 0.259196
0.8074 --- loss: 0.875117, loss_ss: 0.767744, loss_d: 0.107373
0.8458 --- loss: 0.778118, loss_ss: 0.484547, loss_d: 0.293571
0.8843 --- loss: 0.826082, loss_ss: 0.771337, loss_d: 0.054745
0.9227 --- loss: 0.591803, loss_ss: 0.569016, loss_d: 0.022787
0.9612 --- loss: 0.622002, loss_ss: 0.615664, loss_d: 0.006338
0.9996 --- loss: 2.203078, loss_ss: 2.202419, loss_d: 0.000659
Epoch finished! Loss: 0.8304664316085669
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.690990990990991
             precision    recall  f1-score   support

        0.0       0.46      0.57      0.51        23
        1.0       0.40      0.26      0.32       182
        2.0       0.70      0.88      0.78       379
        3.0       1.00      0.48      0.65       203
        4.0       0.71      0.85      0.77       323

avg / total       0.70      0.69      0.67      1110
 


====== chp012-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.75  56.52   98.62   46.43     50.98
1  81.44  26.37   92.24   40.00     31.79
2  83.15  88.13   80.57   70.17     78.13
3  90.54  48.28  100.00  100.00     65.12
4  85.32  84.83   85.51   70.62     77.07
Total accuracy: 69.10%
Average sen: 60.83%
Average spec: 91.39%
Macro f1-score: 60.62%
Diagnosis acc on 15mins: 1.0
[0.99999881 0.99999583 0.99726331 0.9999727  0.99903536 0.99987578
 0.99999666 0.99999821 0.9999994  0.99999976 0.99999368 0.99999976
 0.99999559 0.99999988 0.99999702 0.99999976 1.         0.99999881
 0.99988961 0.99999487 0.99999452 0.9999994  0.99999464 0.99999976
 1.         1.         0.99999285 0.99992049 0.99974674 0.99992168
 0.9998554  0.99999893 1.         1.         0.99999988 0.99999702
 0.99959284]
pred: 0.9998653772714976, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.391831, loss_ss: 1.783322, loss_d: 0.608509
0.0384 --- loss: 2.207895, loss_ss: 1.587374, loss_d: 0.620521
0.0768 --- loss: 2.177753, loss_ss: 1.699718, loss_d: 0.478035
0.1152 --- loss: 2.534931, loss_ss: 1.548240, loss_d: 0.986691
0.1536 --- loss: 2.042213, loss_ss: 1.399118, loss_d: 0.643095
0.1919 --- loss: 2.075002, loss_ss: 1.571058, loss_d: 0.503944
0.2303 --- loss: 1.882062, loss_ss: 1.428149, loss_d: 0.453913
0.2687 --- loss: 2.399127, loss_ss: 1.438540, loss_d: 0.960587
0.3071 --- loss: 2.013781, loss_ss: 1.493102, loss_d: 0.520679
0.3455 --- loss: 2.085414, loss_ss: 1.271814, loss_d: 0.813600
0.3839 --- loss: 1.924076, loss_ss: 1.360230, loss_d: 0.563846
0.4223 --- loss: 1.781639, loss_ss: 1.323815, loss_d: 0.457825
0.4607 --- loss: 1.874081, loss_ss: 1.359895, loss_d: 0.514187
0.4990 --- loss: 1.881566, loss_ss: 1.213517, loss_d: 0.668049
0.5374 --- loss: 1.615129, loss_ss: 1.250819, loss_d: 0.364311
0.5758 --- loss: 1.855151, loss_ss: 1.318929, loss_d: 0.536222
0.6142 --- loss: 1.570151, loss_ss: 1.211805, loss_d: 0.358346
0.6526 --- loss: 1.601189, loss_ss: 1.200427, loss_d: 0.400762
0.6910 --- loss: 1.842502, loss_ss: 1.508053, loss_d: 0.334449
0.7294 --- loss: 1.741377, loss_ss: 1.254142, loss_d: 0.487235
0.7678 --- loss: 2.094158, loss_ss: 1.125824, loss_d: 0.968334
0.8061 --- loss: 1.803603, loss_ss: 1.136932, loss_d: 0.666671
0.8445 --- loss: 1.882216, loss_ss: 1.115775, loss_d: 0.766441
0.8829 --- loss: 1.411595, loss_ss: 0.968224, loss_d: 0.443372
0.9213 --- loss: 1.698895, loss_ss: 1.139281, loss_d: 0.559614
0.9597 --- loss: 1.770636, loss_ss: 1.067605, loss_d: 0.703030
0.9981 --- loss: 1.732207, loss_ss: 1.182205, loss_d: 0.550002
Epoch finished! Loss: 1.899229057935568
Starting epoch 2/10.
0.0000 --- loss: 1.938384, loss_ss: 1.322228, loss_d: 0.616156
0.0384 --- loss: 1.512630, loss_ss: 1.001969, loss_d: 0.510660
0.0768 --- loss: 1.456455, loss_ss: 1.142868, loss_d: 0.313586
0.1152 --- loss: 1.928355, loss_ss: 1.268911, loss_d: 0.659444
0.1536 --- loss: 1.384629, loss_ss: 1.034148, loss_d: 0.350482
0.1919 --- loss: 1.806577, loss_ss: 1.129311, loss_d: 0.677266
0.2303 --- loss: 1.486456, loss_ss: 1.246802, loss_d: 0.239654
0.2687 --- loss: 1.166757, loss_ss: 0.938636, loss_d: 0.228121
0.3071 --- loss: 1.108338, loss_ss: 0.946402, loss_d: 0.161936
0.3455 --- loss: 1.332358, loss_ss: 1.153836, loss_d: 0.178522
0.3839 --- loss: 1.337416, loss_ss: 1.051431, loss_d: 0.285985
0.4223 --- loss: 1.490903, loss_ss: 1.019926, loss_d: 0.470977
0.4607 --- loss: 0.960270, loss_ss: 0.790566, loss_d: 0.169704
0.4990 --- loss: 0.989564, loss_ss: 0.893779, loss_d: 0.095785
0.5374 --- loss: 1.239312, loss_ss: 0.940149, loss_d: 0.299163
0.5758 --- loss: 1.351567, loss_ss: 1.138159, loss_d: 0.213408
0.6142 --- loss: 1.240287, loss_ss: 0.878985, loss_d: 0.361302
0.6526 --- loss: 1.111218, loss_ss: 0.775707, loss_d: 0.335511
0.6910 --- loss: 1.407621, loss_ss: 0.935977, loss_d: 0.471644
0.7294 --- loss: 0.828832, loss_ss: 0.693885, loss_d: 0.134947
0.7678 --- loss: 1.439307, loss_ss: 1.214561, loss_d: 0.224746
0.8061 --- loss: 1.151466, loss_ss: 0.977635, loss_d: 0.173831
0.8445 --- loss: 1.319773, loss_ss: 1.214168, loss_d: 0.105605
0.8829 --- loss: 1.579323, loss_ss: 1.049934, loss_d: 0.529389
0.9213 --- loss: 1.302757, loss_ss: 0.937275, loss_d: 0.365481
0.9597 --- loss: 1.060396, loss_ss: 0.760426, loss_d: 0.299970
0.9981 --- loss: 1.104520, loss_ss: 0.904253, loss_d: 0.200267
Epoch finished! Loss: 1.333652899815486
Starting epoch 3/10.
0.0000 --- loss: 1.231996, loss_ss: 0.810490, loss_d: 0.421505
0.0384 --- loss: 1.055832, loss_ss: 0.777269, loss_d: 0.278563
0.0768 --- loss: 1.180307, loss_ss: 0.995495, loss_d: 0.184812
0.1152 --- loss: 1.054313, loss_ss: 0.834495, loss_d: 0.219817
0.1536 --- loss: 0.706880, loss_ss: 0.623994, loss_d: 0.082886
0.1919 --- loss: 1.171010, loss_ss: 0.996071, loss_d: 0.174939
0.2303 --- loss: 1.191709, loss_ss: 0.887106, loss_d: 0.304603
0.2687 --- loss: 1.053432, loss_ss: 0.886282, loss_d: 0.167151
0.3071 --- loss: 1.327314, loss_ss: 1.177681, loss_d: 0.149633
0.3455 --- loss: 1.028986, loss_ss: 0.747752, loss_d: 0.281233
0.3839 --- loss: 0.937303, loss_ss: 0.822829, loss_d: 0.114473
0.4223 --- loss: 1.250033, loss_ss: 1.070127, loss_d: 0.179906
0.4607 --- loss: 0.973166, loss_ss: 0.884956, loss_d: 0.088210
0.4990 --- loss: 0.946911, loss_ss: 0.818399, loss_d: 0.128511
0.5374 --- loss: 0.938354, loss_ss: 0.844542, loss_d: 0.093813
0.5758 --- loss: 1.725290, loss_ss: 0.822635, loss_d: 0.902656
0.6142 --- loss: 1.549081, loss_ss: 1.110933, loss_d: 0.438148
0.6526 --- loss: 1.195022, loss_ss: 1.093781, loss_d: 0.101241
0.6910 --- loss: 1.036209, loss_ss: 0.792689, loss_d: 0.243520
0.7294 --- loss: 1.308317, loss_ss: 0.806211, loss_d: 0.502106
0.7678 --- loss: 0.842755, loss_ss: 0.708056, loss_d: 0.134699
0.8061 --- loss: 1.342269, loss_ss: 0.996623, loss_d: 0.345646
0.8445 --- loss: 1.072186, loss_ss: 0.911550, loss_d: 0.160636
0.8829 --- loss: 1.149168, loss_ss: 0.847305, loss_d: 0.301863
0.9213 --- loss: 0.977475, loss_ss: 0.848953, loss_d: 0.128522
0.9597 --- loss: 1.376807, loss_ss: 0.962300, loss_d: 0.414507
0.9981 --- loss: 1.509549, loss_ss: 1.160640, loss_d: 0.348909
Epoch finished! Loss: 1.1368945692594234
Starting epoch 4/10.
0.0000 --- loss: 0.790889, loss_ss: 0.708596, loss_d: 0.082293
0.0384 --- loss: 1.030999, loss_ss: 0.820227, loss_d: 0.210772
0.0768 --- loss: 1.015626, loss_ss: 0.823698, loss_d: 0.191928
0.1152 --- loss: 1.372035, loss_ss: 1.329857, loss_d: 0.042178
0.1536 --- loss: 1.092605, loss_ss: 0.956762, loss_d: 0.135843
0.1919 --- loss: 1.171034, loss_ss: 0.951869, loss_d: 0.219165
0.2303 --- loss: 0.935278, loss_ss: 0.826413, loss_d: 0.108865
0.2687 --- loss: 1.179335, loss_ss: 0.837528, loss_d: 0.341807
0.3071 --- loss: 1.025695, loss_ss: 0.918577, loss_d: 0.107118
0.3455 --- loss: 0.751554, loss_ss: 0.660279, loss_d: 0.091275
0.3839 --- loss: 0.814249, loss_ss: 0.763760, loss_d: 0.050489
0.4223 --- loss: 1.068530, loss_ss: 0.796184, loss_d: 0.272347
0.4607 --- loss: 0.692622, loss_ss: 0.654899, loss_d: 0.037723
0.4990 --- loss: 1.080058, loss_ss: 0.836858, loss_d: 0.243200
0.5374 --- loss: 1.136243, loss_ss: 0.839290, loss_d: 0.296953
0.5758 --- loss: 1.185249, loss_ss: 1.071444, loss_d: 0.113806
0.6142 --- loss: 1.449261, loss_ss: 1.262391, loss_d: 0.186871
0.6526 --- loss: 0.875685, loss_ss: 0.759975, loss_d: 0.115710
0.6910 --- loss: 0.901828, loss_ss: 0.710219, loss_d: 0.191609
0.7294 --- loss: 1.497313, loss_ss: 1.282177, loss_d: 0.215136
0.7678 --- loss: 0.941457, loss_ss: 0.781287, loss_d: 0.160170
0.8061 --- loss: 1.092568, loss_ss: 0.753692, loss_d: 0.338877
0.8445 --- loss: 0.927709, loss_ss: 0.563547, loss_d: 0.364161
0.8829 --- loss: 1.148865, loss_ss: 0.847259, loss_d: 0.301606
0.9213 --- loss: 0.730009, loss_ss: 0.684262, loss_d: 0.045747
0.9597 --- loss: 1.132783, loss_ss: 0.942065, loss_d: 0.190719
0.9981 --- loss: 1.526571, loss_ss: 1.092645, loss_d: 0.433926
Epoch finished! Loss: 1.051159391953395
Starting epoch 5/10.
0.0000 --- loss: 0.919970, loss_ss: 0.738799, loss_d: 0.181171
0.0384 --- loss: 0.951240, loss_ss: 0.928774, loss_d: 0.022467
0.0768 --- loss: 0.980832, loss_ss: 0.814202, loss_d: 0.166631
0.1152 --- loss: 0.903476, loss_ss: 0.817851, loss_d: 0.085625
0.1536 --- loss: 1.028025, loss_ss: 0.970942, loss_d: 0.057083
0.1919 --- loss: 1.021511, loss_ss: 0.823408, loss_d: 0.198104
0.2303 --- loss: 0.841253, loss_ss: 0.670373, loss_d: 0.170880
0.2687 --- loss: 1.328864, loss_ss: 1.096611, loss_d: 0.232253
0.3071 --- loss: 0.799170, loss_ss: 0.755230, loss_d: 0.043940
0.3455 --- loss: 0.659277, loss_ss: 0.640149, loss_d: 0.019128
0.3839 --- loss: 0.811855, loss_ss: 0.568544, loss_d: 0.243311
0.4223 --- loss: 0.860657, loss_ss: 0.614142, loss_d: 0.246514
0.4607 --- loss: 1.012927, loss_ss: 0.930259, loss_d: 0.082668
0.4990 --- loss: 1.039423, loss_ss: 0.683032, loss_d: 0.356391
0.5374 --- loss: 0.990464, loss_ss: 0.898263, loss_d: 0.092201
0.5758 --- loss: 1.202189, loss_ss: 1.122330, loss_d: 0.079859
0.6142 --- loss: 0.644233, loss_ss: 0.571087, loss_d: 0.073146
0.6526 --- loss: 0.822882, loss_ss: 0.669238, loss_d: 0.153645
0.6910 --- loss: 0.684916, loss_ss: 0.653925, loss_d: 0.030991
0.7294 --- loss: 0.834220, loss_ss: 0.819850, loss_d: 0.014370
0.7678 --- loss: 1.016690, loss_ss: 0.900729, loss_d: 0.115961
0.8061 --- loss: 1.076015, loss_ss: 1.046165, loss_d: 0.029850
0.8445 --- loss: 0.844243, loss_ss: 0.682775, loss_d: 0.161468
0.8829 --- loss: 1.013250, loss_ss: 0.850328, loss_d: 0.162922
0.9213 --- loss: 0.796271, loss_ss: 0.634798, loss_d: 0.161473
0.9597 --- loss: 0.723593, loss_ss: 0.688713, loss_d: 0.034880
0.9981 --- loss: 0.733842, loss_ss: 0.642847, loss_d: 0.090995
Epoch finished! Loss: 0.9863484061681307
Starting epoch 6/10.
0.0000 --- loss: 1.032531, loss_ss: 0.985500, loss_d: 0.047031
0.0384 --- loss: 0.798213, loss_ss: 0.679705, loss_d: 0.118508
0.0768 --- loss: 0.709612, loss_ss: 0.558986, loss_d: 0.150626
0.1152 --- loss: 0.907068, loss_ss: 0.877669, loss_d: 0.029399
0.1536 --- loss: 0.956619, loss_ss: 0.936374, loss_d: 0.020245
0.1919 --- loss: 0.746246, loss_ss: 0.703765, loss_d: 0.042481
0.2303 --- loss: 1.201411, loss_ss: 1.106222, loss_d: 0.095188
0.2687 --- loss: 1.010041, loss_ss: 0.973900, loss_d: 0.036141
0.3071 --- loss: 0.976002, loss_ss: 0.936906, loss_d: 0.039096
0.3455 --- loss: 0.833541, loss_ss: 0.768738, loss_d: 0.064804
0.3839 --- loss: 0.787643, loss_ss: 0.513125, loss_d: 0.274518
0.4223 --- loss: 0.679426, loss_ss: 0.612140, loss_d: 0.067286
0.4607 --- loss: 0.863201, loss_ss: 0.741775, loss_d: 0.121426
0.4990 --- loss: 0.702909, loss_ss: 0.670955, loss_d: 0.031954
0.5374 --- loss: 1.008774, loss_ss: 0.732240, loss_d: 0.276535
0.5758 --- loss: 0.840157, loss_ss: 0.734209, loss_d: 0.105948
0.6142 --- loss: 0.660219, loss_ss: 0.467222, loss_d: 0.192996
0.6526 --- loss: 0.849846, loss_ss: 0.722465, loss_d: 0.127381
0.6910 --- loss: 1.208601, loss_ss: 1.119717, loss_d: 0.088884
0.7294 --- loss: 0.672103, loss_ss: 0.604988, loss_d: 0.067115
0.7678 --- loss: 0.768317, loss_ss: 0.722709, loss_d: 0.045608
0.8061 --- loss: 0.515990, loss_ss: 0.496883, loss_d: 0.019107
0.8445 --- loss: 0.948728, loss_ss: 0.817347, loss_d: 0.131381
0.8829 --- loss: 0.943590, loss_ss: 0.859098, loss_d: 0.084492
0.9213 --- loss: 0.806951, loss_ss: 0.758671, loss_d: 0.048280
0.9597 --- loss: 1.359707, loss_ss: 0.844897, loss_d: 0.514810
0.9981 --- loss: 0.857926, loss_ss: 0.741903, loss_d: 0.116023
Epoch finished! Loss: 0.9163598053730451
Starting epoch 7/10.
0.0000 --- loss: 0.868008, loss_ss: 0.588774, loss_d: 0.279234
0.0384 --- loss: 1.018499, loss_ss: 0.595295, loss_d: 0.423204
0.0768 --- loss: 0.815202, loss_ss: 0.750417, loss_d: 0.064785
0.1152 --- loss: 0.873626, loss_ss: 0.627401, loss_d: 0.246224
0.1536 --- loss: 1.156358, loss_ss: 0.860847, loss_d: 0.295511
0.1919 --- loss: 0.695300, loss_ss: 0.666697, loss_d: 0.028603
0.2303 --- loss: 0.973775, loss_ss: 0.806799, loss_d: 0.166976
0.2687 --- loss: 0.495245, loss_ss: 0.453067, loss_d: 0.042177
0.3071 --- loss: 0.788496, loss_ss: 0.758586, loss_d: 0.029911
0.3455 --- loss: 0.735795, loss_ss: 0.712939, loss_d: 0.022856
0.3839 --- loss: 0.675269, loss_ss: 0.643788, loss_d: 0.031482
0.4223 --- loss: 0.780005, loss_ss: 0.731448, loss_d: 0.048556
0.4607 --- loss: 0.917855, loss_ss: 0.874083, loss_d: 0.043772
0.4990 --- loss: 0.866048, loss_ss: 0.782389, loss_d: 0.083659
0.5374 --- loss: 0.848054, loss_ss: 0.770318, loss_d: 0.077736
0.5758 --- loss: 0.678096, loss_ss: 0.583124, loss_d: 0.094972
0.6142 --- loss: 0.749364, loss_ss: 0.711028, loss_d: 0.038335
0.6526 --- loss: 0.777739, loss_ss: 0.739174, loss_d: 0.038565
0.6910 --- loss: 1.064314, loss_ss: 1.008811, loss_d: 0.055503
0.7294 --- loss: 0.873114, loss_ss: 0.830863, loss_d: 0.042251
0.7678 --- loss: 0.820129, loss_ss: 0.767742, loss_d: 0.052386
0.8061 --- loss: 1.762598, loss_ss: 1.315302, loss_d: 0.447295
0.8445 --- loss: 0.774954, loss_ss: 0.577555, loss_d: 0.197399
0.8829 --- loss: 0.955561, loss_ss: 0.878621, loss_d: 0.076941
0.9213 --- loss: 0.908016, loss_ss: 0.791722, loss_d: 0.116294
0.9597 --- loss: 0.883134, loss_ss: 0.684385, loss_d: 0.198749
0.9981 --- loss: 0.679086, loss_ss: 0.668925, loss_d: 0.010161
Epoch finished! Loss: 0.9162304385350301
Starting epoch 8/10.
0.0000 --- loss: 0.774923, loss_ss: 0.693444, loss_d: 0.081479
0.0384 --- loss: 0.639423, loss_ss: 0.612509, loss_d: 0.026914
0.0768 --- loss: 0.811880, loss_ss: 0.791399, loss_d: 0.020481
0.1152 --- loss: 0.831338, loss_ss: 0.760592, loss_d: 0.070747
0.1536 --- loss: 0.781318, loss_ss: 0.775921, loss_d: 0.005398
0.1919 --- loss: 1.275659, loss_ss: 1.250661, loss_d: 0.024998
0.2303 --- loss: 1.143856, loss_ss: 0.969277, loss_d: 0.174579
0.2687 --- loss: 0.642042, loss_ss: 0.544219, loss_d: 0.097823
0.3071 --- loss: 0.745719, loss_ss: 0.691332, loss_d: 0.054387
0.3455 --- loss: 0.691257, loss_ss: 0.673505, loss_d: 0.017751
0.3839 --- loss: 0.835897, loss_ss: 0.822155, loss_d: 0.013742
0.4223 --- loss: 0.858874, loss_ss: 0.802037, loss_d: 0.056837
0.4607 --- loss: 0.580410, loss_ss: 0.494707, loss_d: 0.085703
0.4990 --- loss: 1.326723, loss_ss: 0.763644, loss_d: 0.563079
0.5374 --- loss: 0.943233, loss_ss: 0.901814, loss_d: 0.041418
0.5758 --- loss: 0.999594, loss_ss: 0.938274, loss_d: 0.061320
0.6142 --- loss: 0.784930, loss_ss: 0.756529, loss_d: 0.028402
0.6526 --- loss: 0.840811, loss_ss: 0.611936, loss_d: 0.228875
0.6910 --- loss: 1.154886, loss_ss: 0.893725, loss_d: 0.261161
0.7294 --- loss: 1.002405, loss_ss: 0.766692, loss_d: 0.235713
0.7678 --- loss: 0.556747, loss_ss: 0.538740, loss_d: 0.018007
0.8061 --- loss: 0.611459, loss_ss: 0.563111, loss_d: 0.048348
0.8445 --- loss: 0.643902, loss_ss: 0.607694, loss_d: 0.036208
0.8829 --- loss: 0.572512, loss_ss: 0.547057, loss_d: 0.025454
0.9213 --- loss: 0.913486, loss_ss: 0.829955, loss_d: 0.083531
0.9597 --- loss: 0.958876, loss_ss: 0.867056, loss_d: 0.091821
0.9981 --- loss: 0.624377, loss_ss: 0.619160, loss_d: 0.005217
Epoch finished! Loss: 0.8584978683636739
Starting epoch 9/10.
0.0000 --- loss: 0.869807, loss_ss: 0.774286, loss_d: 0.095522
0.0384 --- loss: 0.708359, loss_ss: 0.698849, loss_d: 0.009510
0.0768 --- loss: 0.909616, loss_ss: 0.874972, loss_d: 0.034644
0.1152 --- loss: 1.045983, loss_ss: 0.785794, loss_d: 0.260188
0.1536 --- loss: 0.664416, loss_ss: 0.647936, loss_d: 0.016480
0.1919 --- loss: 0.986379, loss_ss: 0.818535, loss_d: 0.167843
0.2303 --- loss: 0.654442, loss_ss: 0.639930, loss_d: 0.014512
0.2687 --- loss: 0.797182, loss_ss: 0.759728, loss_d: 0.037454
0.3071 --- loss: 0.638598, loss_ss: 0.573154, loss_d: 0.065444
0.3455 --- loss: 0.778936, loss_ss: 0.689557, loss_d: 0.089379
0.3839 --- loss: 0.550823, loss_ss: 0.484050, loss_d: 0.066773
0.4223 --- loss: 0.439867, loss_ss: 0.423362, loss_d: 0.016506
0.4607 --- loss: 0.508282, loss_ss: 0.501198, loss_d: 0.007084
0.4990 --- loss: 0.616601, loss_ss: 0.609222, loss_d: 0.007378
0.5374 --- loss: 0.597619, loss_ss: 0.576590, loss_d: 0.021029
0.5758 --- loss: 0.723505, loss_ss: 0.715685, loss_d: 0.007820
0.6142 --- loss: 0.754008, loss_ss: 0.707122, loss_d: 0.046886
0.6526 --- loss: 1.096822, loss_ss: 0.748172, loss_d: 0.348649
0.6910 --- loss: 1.014653, loss_ss: 0.986777, loss_d: 0.027876
0.7294 --- loss: 0.841619, loss_ss: 0.813216, loss_d: 0.028403
0.7678 --- loss: 1.032391, loss_ss: 0.886502, loss_d: 0.145889
0.8061 --- loss: 0.758656, loss_ss: 0.701840, loss_d: 0.056817
0.8445 --- loss: 0.837203, loss_ss: 0.779944, loss_d: 0.057259
0.8829 --- loss: 0.577692, loss_ss: 0.521902, loss_d: 0.055790
0.9213 --- loss: 0.907703, loss_ss: 0.763333, loss_d: 0.144370
0.9597 --- loss: 0.690072, loss_ss: 0.671318, loss_d: 0.018753
0.9981 --- loss: 0.653401, loss_ss: 0.589171, loss_d: 0.064230
Epoch finished! Loss: 0.8242217703507497
Starting epoch 10/10.
0.0000 --- loss: 0.815166, loss_ss: 0.623918, loss_d: 0.191247
0.0384 --- loss: 1.241161, loss_ss: 0.701244, loss_d: 0.539917
0.0768 --- loss: 0.596739, loss_ss: 0.572159, loss_d: 0.024580
0.1152 --- loss: 0.888136, loss_ss: 0.876849, loss_d: 0.011287
0.1536 --- loss: 0.661009, loss_ss: 0.640225, loss_d: 0.020783
0.1919 --- loss: 0.867809, loss_ss: 0.862258, loss_d: 0.005551
0.2303 --- loss: 0.970489, loss_ss: 0.599764, loss_d: 0.370725
0.2687 --- loss: 0.861840, loss_ss: 0.750454, loss_d: 0.111387
0.3071 --- loss: 1.517498, loss_ss: 1.480628, loss_d: 0.036870
0.3455 --- loss: 0.981042, loss_ss: 0.878611, loss_d: 0.102432
0.3839 --- loss: 0.775460, loss_ss: 0.637688, loss_d: 0.137772
0.4223 --- loss: 1.054521, loss_ss: 0.754910, loss_d: 0.299612
0.4607 --- loss: 0.519482, loss_ss: 0.505519, loss_d: 0.013963
0.4990 --- loss: 1.068278, loss_ss: 1.027368, loss_d: 0.040911
0.5374 --- loss: 0.921292, loss_ss: 0.802581, loss_d: 0.118712
0.5758 --- loss: 0.728945, loss_ss: 0.655858, loss_d: 0.073087
0.6142 --- loss: 0.818674, loss_ss: 0.815984, loss_d: 0.002690
0.6526 --- loss: 1.213806, loss_ss: 0.900236, loss_d: 0.313570
0.6910 --- loss: 1.064943, loss_ss: 0.874001, loss_d: 0.190942
0.7294 --- loss: 0.841988, loss_ss: 0.828563, loss_d: 0.013424
0.7678 --- loss: 0.581868, loss_ss: 0.580632, loss_d: 0.001236
0.8061 --- loss: 1.106878, loss_ss: 0.831281, loss_d: 0.275597
0.8445 --- loss: 0.757763, loss_ss: 0.681828, loss_d: 0.075935
0.8829 --- loss: 0.852396, loss_ss: 0.825367, loss_d: 0.027029
0.9213 --- loss: 1.191548, loss_ss: 1.109037, loss_d: 0.082511
0.9597 --- loss: 0.731640, loss_ss: 0.725818, loss_d: 0.005822
0.9981 --- loss: 0.765749, loss_ss: 0.763277, loss_d: 0.002472
Epoch finished! Loss: 0.809604018009626
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7101010101010101
             precision    recall  f1-score   support

        0.0       0.53      0.76      0.62        33
        1.0       0.40      0.80      0.53       142
        2.0       0.84      0.83      0.83       433
        3.0       0.87      0.77      0.82       189
        4.0       0.92      0.32      0.47       193

avg / total       0.79      0.71      0.71       990
 


====== chp013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.97  75.76   97.70  53.19     62.50
1  79.80  79.58   79.83  39.79     53.05
2  85.66  82.68   87.97  84.24     83.45
3  93.43  77.25   97.25  86.90     81.79
4  86.16  31.61   99.37  92.42     47.10
Total accuracy: 71.01%
Average sen: 69.37%
Average spec: 92.43%
Macro f1-score: 65.58%
Diagnosis acc on 15mins: 1.0
[0.99985719 0.96945089 0.97407305 0.99901748 0.9999994  0.99999535
 0.99952316 0.99999261 0.99995732 0.99999666 0.9999994  0.99999726
 0.99991405 0.99846363 0.99983132 0.99999905 1.         1.
 1.         0.99998569 0.99999964 0.99999952 0.99998105 1.
 1.         1.         0.99997568 0.99959832 0.99921346 0.99997175
 1.         0.99999988 1.        ]
pred: 0.9981452371134902, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.457703, loss_ss: 1.723489, loss_d: 0.734215
0.0384 --- loss: 2.438940, loss_ss: 1.568485, loss_d: 0.870455
0.0768 --- loss: 2.323848, loss_ss: 1.571197, loss_d: 0.752651
0.1152 --- loss: 1.838518, loss_ss: 1.451122, loss_d: 0.387396
0.1536 --- loss: 2.154600, loss_ss: 1.473034, loss_d: 0.681566
0.1919 --- loss: 2.147690, loss_ss: 1.424928, loss_d: 0.722762
0.2303 --- loss: 2.040644, loss_ss: 1.420888, loss_d: 0.619756
0.2687 --- loss: 1.996712, loss_ss: 1.461961, loss_d: 0.534751
0.3071 --- loss: 1.766438, loss_ss: 1.272163, loss_d: 0.494275
0.3455 --- loss: 1.691879, loss_ss: 1.384867, loss_d: 0.307012
0.3839 --- loss: 1.966604, loss_ss: 1.384123, loss_d: 0.582481
0.4223 --- loss: 1.937423, loss_ss: 1.302602, loss_d: 0.634821
0.4607 --- loss: 1.898891, loss_ss: 1.348056, loss_d: 0.550835
0.4990 --- loss: 1.749088, loss_ss: 1.269602, loss_d: 0.479487
0.5374 --- loss: 2.107453, loss_ss: 1.286986, loss_d: 0.820466
0.5758 --- loss: 1.824111, loss_ss: 1.207445, loss_d: 0.616667
0.6142 --- loss: 1.679711, loss_ss: 1.263553, loss_d: 0.416158
0.6526 --- loss: 1.700883, loss_ss: 1.198360, loss_d: 0.502523
0.6910 --- loss: 1.692401, loss_ss: 1.187291, loss_d: 0.505111
0.7294 --- loss: 1.785651, loss_ss: 1.312249, loss_d: 0.473402
0.7678 --- loss: 1.618978, loss_ss: 1.196387, loss_d: 0.422590
0.8061 --- loss: 1.622554, loss_ss: 1.152078, loss_d: 0.470476
0.8445 --- loss: 1.541182, loss_ss: 1.103483, loss_d: 0.437698
0.8829 --- loss: 1.731116, loss_ss: 1.172284, loss_d: 0.558832
0.9213 --- loss: 1.440686, loss_ss: 1.096707, loss_d: 0.343979
0.9597 --- loss: 1.540002, loss_ss: 1.206357, loss_d: 0.333645
0.9981 --- loss: 1.532855, loss_ss: 1.445130, loss_d: 0.087724
Epoch finished! Loss: 1.8561521094578963
Starting epoch 2/10.
0.0000 --- loss: 1.456097, loss_ss: 1.051427, loss_d: 0.404670
0.0384 --- loss: 1.865527, loss_ss: 1.127628, loss_d: 0.737899
0.0768 --- loss: 1.240461, loss_ss: 1.030792, loss_d: 0.209670
0.1152 --- loss: 1.344138, loss_ss: 1.026884, loss_d: 0.317254
0.1536 --- loss: 1.616373, loss_ss: 1.154838, loss_d: 0.461534
0.1919 --- loss: 1.219498, loss_ss: 0.967503, loss_d: 0.251995
0.2303 --- loss: 1.421640, loss_ss: 1.127712, loss_d: 0.293928
0.2687 --- loss: 1.962202, loss_ss: 1.154093, loss_d: 0.808110
0.3071 --- loss: 1.824692, loss_ss: 1.186687, loss_d: 0.638005
0.3455 --- loss: 1.402506, loss_ss: 1.080281, loss_d: 0.322225
0.3839 --- loss: 1.508128, loss_ss: 0.851414, loss_d: 0.656714
0.4223 --- loss: 1.525388, loss_ss: 1.094518, loss_d: 0.430870
0.4607 --- loss: 1.704816, loss_ss: 1.291777, loss_d: 0.413039
0.4990 --- loss: 1.121771, loss_ss: 0.947131, loss_d: 0.174641
0.5374 --- loss: 1.426526, loss_ss: 1.217879, loss_d: 0.208647
0.5758 --- loss: 1.171201, loss_ss: 0.961084, loss_d: 0.210117
0.6142 --- loss: 1.492528, loss_ss: 0.918244, loss_d: 0.574285
0.6526 --- loss: 1.141218, loss_ss: 1.036372, loss_d: 0.104846
0.6910 --- loss: 1.266257, loss_ss: 1.160462, loss_d: 0.105795
0.7294 --- loss: 0.962617, loss_ss: 0.820266, loss_d: 0.142351
0.7678 --- loss: 1.046708, loss_ss: 0.980100, loss_d: 0.066608
0.8061 --- loss: 1.864579, loss_ss: 1.044802, loss_d: 0.819777
0.8445 --- loss: 1.101417, loss_ss: 0.936222, loss_d: 0.165194
0.8829 --- loss: 1.541494, loss_ss: 1.113163, loss_d: 0.428331
0.9213 --- loss: 1.349195, loss_ss: 0.938503, loss_d: 0.410692
0.9597 --- loss: 1.229943, loss_ss: 1.068123, loss_d: 0.161820
0.9981 --- loss: 0.959662, loss_ss: 0.806625, loss_d: 0.153037
Epoch finished! Loss: 1.3432937612900366
Starting epoch 3/10.
0.0000 --- loss: 1.435279, loss_ss: 0.935466, loss_d: 0.499813
0.0384 --- loss: 0.990527, loss_ss: 0.864524, loss_d: 0.126003
0.0768 --- loss: 1.363719, loss_ss: 1.030967, loss_d: 0.332753
0.1152 --- loss: 1.162619, loss_ss: 0.910972, loss_d: 0.251647
0.1536 --- loss: 1.015356, loss_ss: 0.781891, loss_d: 0.233465
0.1919 --- loss: 1.392916, loss_ss: 0.968331, loss_d: 0.424585
0.2303 --- loss: 1.238769, loss_ss: 1.019221, loss_d: 0.219548
0.2687 --- loss: 1.027880, loss_ss: 0.974582, loss_d: 0.053298
0.3071 --- loss: 0.922815, loss_ss: 0.793529, loss_d: 0.129286
0.3455 --- loss: 1.088172, loss_ss: 1.016846, loss_d: 0.071326
0.3839 --- loss: 1.153022, loss_ss: 1.024628, loss_d: 0.128394
0.4223 --- loss: 1.044550, loss_ss: 0.811030, loss_d: 0.233520
0.4607 --- loss: 1.486353, loss_ss: 1.224297, loss_d: 0.262056
0.4990 --- loss: 0.869234, loss_ss: 0.798118, loss_d: 0.071116
0.5374 --- loss: 1.215789, loss_ss: 0.999840, loss_d: 0.215948
0.5758 --- loss: 1.014911, loss_ss: 0.880667, loss_d: 0.134245
0.6142 --- loss: 0.883320, loss_ss: 0.806177, loss_d: 0.077143
0.6526 --- loss: 1.438788, loss_ss: 0.809445, loss_d: 0.629343
0.6910 --- loss: 2.304749, loss_ss: 1.832700, loss_d: 0.472049
0.7294 --- loss: 1.290854, loss_ss: 0.673261, loss_d: 0.617593
0.7678 --- loss: 1.213480, loss_ss: 1.015007, loss_d: 0.198472
0.8061 --- loss: 0.951281, loss_ss: 0.853281, loss_d: 0.098000
0.8445 --- loss: 0.995242, loss_ss: 0.871873, loss_d: 0.123369
0.8829 --- loss: 1.071165, loss_ss: 0.942131, loss_d: 0.129034
0.9213 --- loss: 0.861944, loss_ss: 0.681388, loss_d: 0.180556
0.9597 --- loss: 1.054618, loss_ss: 0.754127, loss_d: 0.300492
0.9981 --- loss: 1.121289, loss_ss: 1.053688, loss_d: 0.067600
Epoch finished! Loss: 1.1750622462767821
Starting epoch 4/10.
0.0000 --- loss: 0.801510, loss_ss: 0.740084, loss_d: 0.061426
0.0384 --- loss: 0.904158, loss_ss: 0.836711, loss_d: 0.067447
0.0768 --- loss: 0.835860, loss_ss: 0.769798, loss_d: 0.066062
0.1152 --- loss: 1.007088, loss_ss: 0.658076, loss_d: 0.349012
0.1536 --- loss: 1.306205, loss_ss: 0.798139, loss_d: 0.508066
0.1919 --- loss: 0.887130, loss_ss: 0.806304, loss_d: 0.080825
0.2303 --- loss: 0.883565, loss_ss: 0.834403, loss_d: 0.049162
0.2687 --- loss: 0.880133, loss_ss: 0.756687, loss_d: 0.123446
0.3071 --- loss: 1.153079, loss_ss: 1.044279, loss_d: 0.108801
0.3455 --- loss: 1.305962, loss_ss: 0.759836, loss_d: 0.546126
0.3839 --- loss: 1.027330, loss_ss: 0.802710, loss_d: 0.224620
0.4223 --- loss: 1.140422, loss_ss: 0.712642, loss_d: 0.427780
0.4607 --- loss: 0.951783, loss_ss: 0.828792, loss_d: 0.122992
0.4990 --- loss: 1.267942, loss_ss: 0.815100, loss_d: 0.452842
0.5374 --- loss: 0.955911, loss_ss: 0.797757, loss_d: 0.158153
0.5758 --- loss: 0.922427, loss_ss: 0.710352, loss_d: 0.212075
0.6142 --- loss: 0.801266, loss_ss: 0.714896, loss_d: 0.086370
0.6526 --- loss: 1.013412, loss_ss: 0.914857, loss_d: 0.098556
0.6910 --- loss: 1.599708, loss_ss: 1.363406, loss_d: 0.236302
0.7294 --- loss: 0.942912, loss_ss: 0.485345, loss_d: 0.457567
0.7678 --- loss: 0.911750, loss_ss: 0.736885, loss_d: 0.174864
0.8061 --- loss: 1.229513, loss_ss: 1.073897, loss_d: 0.155616
0.8445 --- loss: 0.996839, loss_ss: 0.771265, loss_d: 0.225574
0.8829 --- loss: 1.159160, loss_ss: 0.747393, loss_d: 0.411767
0.9213 --- loss: 0.910969, loss_ss: 0.708718, loss_d: 0.202251
0.9597 --- loss: 1.127653, loss_ss: 0.684353, loss_d: 0.443300
0.9981 --- loss: 1.452672, loss_ss: 1.393990, loss_d: 0.058682
Epoch finished! Loss: 1.084276399245629
Starting epoch 5/10.
0.0000 --- loss: 1.422190, loss_ss: 0.669113, loss_d: 0.753077
0.0384 --- loss: 0.828745, loss_ss: 0.592979, loss_d: 0.235766
0.0768 --- loss: 1.107884, loss_ss: 0.796684, loss_d: 0.311200
0.1152 --- loss: 0.786049, loss_ss: 0.733463, loss_d: 0.052587
0.1536 --- loss: 0.969397, loss_ss: 0.733960, loss_d: 0.235437
0.1919 --- loss: 1.101596, loss_ss: 1.050363, loss_d: 0.051233
0.2303 --- loss: 1.025634, loss_ss: 0.857480, loss_d: 0.168154
0.2687 --- loss: 0.828050, loss_ss: 0.811794, loss_d: 0.016256
0.3071 --- loss: 0.895022, loss_ss: 0.846213, loss_d: 0.048809
0.3455 --- loss: 0.701170, loss_ss: 0.641086, loss_d: 0.060085
0.3839 --- loss: 1.165419, loss_ss: 0.855195, loss_d: 0.310224
0.4223 --- loss: 0.820837, loss_ss: 0.710507, loss_d: 0.110330
0.4607 --- loss: 0.951278, loss_ss: 0.695607, loss_d: 0.255671
0.4990 --- loss: 1.073663, loss_ss: 0.700976, loss_d: 0.372688
0.5374 --- loss: 0.778224, loss_ss: 0.617150, loss_d: 0.161075
0.5758 --- loss: 0.971211, loss_ss: 0.919219, loss_d: 0.051992
0.6142 --- loss: 1.010781, loss_ss: 0.767875, loss_d: 0.242906
0.6526 --- loss: 0.921986, loss_ss: 0.879071, loss_d: 0.042915
0.6910 --- loss: 0.689881, loss_ss: 0.676574, loss_d: 0.013308
0.7294 --- loss: 0.956095, loss_ss: 0.843008, loss_d: 0.113087
0.7678 --- loss: 0.796529, loss_ss: 0.704045, loss_d: 0.092484
0.8061 --- loss: 1.304356, loss_ss: 0.794009, loss_d: 0.510347
0.8445 --- loss: 0.942356, loss_ss: 0.794296, loss_d: 0.148060
0.8829 --- loss: 0.684151, loss_ss: 0.607916, loss_d: 0.076235
0.9213 --- loss: 1.241968, loss_ss: 0.569478, loss_d: 0.672490
0.9597 --- loss: 1.115507, loss_ss: 0.865029, loss_d: 0.250478
0.9981 --- loss: 0.852208, loss_ss: 0.829047, loss_d: 0.023161
Epoch finished! Loss: 0.9780372676941065
Starting epoch 6/10.
0.0000 --- loss: 0.835647, loss_ss: 0.790265, loss_d: 0.045381
0.0384 --- loss: 0.842941, loss_ss: 0.772465, loss_d: 0.070476
0.0768 --- loss: 1.179116, loss_ss: 0.992364, loss_d: 0.186752
0.1152 --- loss: 1.185778, loss_ss: 0.741686, loss_d: 0.444092
0.1536 --- loss: 1.578500, loss_ss: 0.823938, loss_d: 0.754561
0.1919 --- loss: 0.898559, loss_ss: 0.755639, loss_d: 0.142920
0.2303 --- loss: 0.927283, loss_ss: 0.784479, loss_d: 0.142803
0.2687 --- loss: 0.635372, loss_ss: 0.577804, loss_d: 0.057567
0.3071 --- loss: 1.181744, loss_ss: 0.964103, loss_d: 0.217640
0.3455 --- loss: 0.948780, loss_ss: 0.808635, loss_d: 0.140145
0.3839 --- loss: 1.279469, loss_ss: 0.848724, loss_d: 0.430745
0.4223 --- loss: 0.921593, loss_ss: 0.854790, loss_d: 0.066802
0.4607 --- loss: 0.856272, loss_ss: 0.821633, loss_d: 0.034639
0.4990 --- loss: 0.840936, loss_ss: 0.715770, loss_d: 0.125166
0.5374 --- loss: 1.209524, loss_ss: 0.850591, loss_d: 0.358933
0.5758 --- loss: 1.327127, loss_ss: 0.730748, loss_d: 0.596379
0.6142 --- loss: 1.019779, loss_ss: 0.907507, loss_d: 0.112273
0.6526 --- loss: 0.876064, loss_ss: 0.760983, loss_d: 0.115081
0.6910 --- loss: 0.916874, loss_ss: 0.846956, loss_d: 0.069918
0.7294 --- loss: 1.137602, loss_ss: 0.706050, loss_d: 0.431552
0.7678 --- loss: 0.608370, loss_ss: 0.532598, loss_d: 0.075772
0.8061 --- loss: 0.907440, loss_ss: 0.603277, loss_d: 0.304163
0.8445 --- loss: 0.950947, loss_ss: 0.828217, loss_d: 0.122730
0.8829 --- loss: 1.024147, loss_ss: 0.869324, loss_d: 0.154824
0.9213 --- loss: 0.883967, loss_ss: 0.529626, loss_d: 0.354341
0.9597 --- loss: 0.855549, loss_ss: 0.638664, loss_d: 0.216885
0.9981 --- loss: 0.916211, loss_ss: 0.895026, loss_d: 0.021186
Epoch finished! Loss: 0.9565724171124972
Starting epoch 7/10.
0.0000 --- loss: 0.766918, loss_ss: 0.732354, loss_d: 0.034565
0.0384 --- loss: 1.388003, loss_ss: 1.156907, loss_d: 0.231096
0.0768 --- loss: 1.152112, loss_ss: 0.918094, loss_d: 0.234018
0.1152 --- loss: 0.947129, loss_ss: 0.738383, loss_d: 0.208746
0.1536 --- loss: 1.296287, loss_ss: 0.636724, loss_d: 0.659563
0.1919 --- loss: 1.085036, loss_ss: 0.639668, loss_d: 0.445368
0.2303 --- loss: 0.828196, loss_ss: 0.734728, loss_d: 0.093469
0.2687 --- loss: 0.957409, loss_ss: 0.865372, loss_d: 0.092037
0.3071 --- loss: 1.239782, loss_ss: 1.098766, loss_d: 0.141015
0.3455 --- loss: 0.720286, loss_ss: 0.687206, loss_d: 0.033080
0.3839 --- loss: 0.784990, loss_ss: 0.574141, loss_d: 0.210849
0.4223 --- loss: 0.899990, loss_ss: 0.676909, loss_d: 0.223081
0.4607 --- loss: 1.107364, loss_ss: 0.955309, loss_d: 0.152055
0.4990 --- loss: 0.694685, loss_ss: 0.624481, loss_d: 0.070203
0.5374 --- loss: 1.183843, loss_ss: 1.049540, loss_d: 0.134303
0.5758 --- loss: 1.047411, loss_ss: 0.986627, loss_d: 0.060784
0.6142 --- loss: 0.829176, loss_ss: 0.664743, loss_d: 0.164433
0.6526 --- loss: 0.817466, loss_ss: 0.811844, loss_d: 0.005622
0.6910 --- loss: 1.008384, loss_ss: 1.005708, loss_d: 0.002676
0.7294 --- loss: 0.965094, loss_ss: 0.943872, loss_d: 0.021222
0.7678 --- loss: 0.881182, loss_ss: 0.802027, loss_d: 0.079156
0.8061 --- loss: 1.001564, loss_ss: 0.918134, loss_d: 0.083429
0.8445 --- loss: 0.936449, loss_ss: 0.911622, loss_d: 0.024828
0.8829 --- loss: 0.815385, loss_ss: 0.764804, loss_d: 0.050580
0.9213 --- loss: 0.679070, loss_ss: 0.635783, loss_d: 0.043286
0.9597 --- loss: 0.961393, loss_ss: 0.848885, loss_d: 0.112508
0.9981 --- loss: 0.904504, loss_ss: 0.891755, loss_d: 0.012748
Epoch finished! Loss: 0.9088044693836799
Starting epoch 8/10.
0.0000 --- loss: 0.847743, loss_ss: 0.776665, loss_d: 0.071078
0.0384 --- loss: 0.789387, loss_ss: 0.685530, loss_d: 0.103857
0.0768 --- loss: 1.311625, loss_ss: 0.685905, loss_d: 0.625720
0.1152 --- loss: 0.903901, loss_ss: 0.835191, loss_d: 0.068709
0.1536 --- loss: 0.845881, loss_ss: 0.836515, loss_d: 0.009366
0.1919 --- loss: 0.685460, loss_ss: 0.667986, loss_d: 0.017474
0.2303 --- loss: 0.842203, loss_ss: 0.808803, loss_d: 0.033400
0.2687 --- loss: 0.893861, loss_ss: 0.685342, loss_d: 0.208519
0.3071 --- loss: 1.154959, loss_ss: 0.815645, loss_d: 0.339314
0.3455 --- loss: 0.955589, loss_ss: 0.765284, loss_d: 0.190305
0.3839 --- loss: 0.972825, loss_ss: 0.933419, loss_d: 0.039405
0.4223 --- loss: 1.125751, loss_ss: 0.836374, loss_d: 0.289377
0.4607 --- loss: 0.650751, loss_ss: 0.646437, loss_d: 0.004314
0.4990 --- loss: 0.817372, loss_ss: 0.795382, loss_d: 0.021990
0.5374 --- loss: 0.924365, loss_ss: 0.787985, loss_d: 0.136380
0.5758 --- loss: 0.499772, loss_ss: 0.488183, loss_d: 0.011589
0.6142 --- loss: 0.690832, loss_ss: 0.630839, loss_d: 0.059994
0.6526 --- loss: 1.334201, loss_ss: 1.065992, loss_d: 0.268209
0.6910 --- loss: 1.076862, loss_ss: 0.993869, loss_d: 0.082994
0.7294 --- loss: 0.857333, loss_ss: 0.836219, loss_d: 0.021114
0.7678 --- loss: 0.967598, loss_ss: 0.957390, loss_d: 0.010208
0.8061 --- loss: 0.707997, loss_ss: 0.382640, loss_d: 0.325357
0.8445 --- loss: 0.951545, loss_ss: 0.921572, loss_d: 0.029972
0.8829 --- loss: 0.733348, loss_ss: 0.607877, loss_d: 0.125471
0.9213 --- loss: 0.864472, loss_ss: 0.660998, loss_d: 0.203474
0.9597 --- loss: 0.909461, loss_ss: 0.853924, loss_d: 0.055538
0.9981 --- loss: 1.165185, loss_ss: 1.145514, loss_d: 0.019671
Epoch finished! Loss: 0.8633883165625426
Starting epoch 9/10.
0.0000 --- loss: 0.723517, loss_ss: 0.514029, loss_d: 0.209489
0.0384 --- loss: 0.676546, loss_ss: 0.663347, loss_d: 0.013199
0.0768 --- loss: 1.370399, loss_ss: 1.288235, loss_d: 0.082164
0.1152 --- loss: 0.592249, loss_ss: 0.557616, loss_d: 0.034633
0.1536 --- loss: 0.538253, loss_ss: 0.500282, loss_d: 0.037970
0.1919 --- loss: 0.606298, loss_ss: 0.596049, loss_d: 0.010249
0.2303 --- loss: 0.893854, loss_ss: 0.860434, loss_d: 0.033420
0.2687 --- loss: 0.740819, loss_ss: 0.707885, loss_d: 0.032934
0.3071 --- loss: 0.969410, loss_ss: 0.968422, loss_d: 0.000988
0.3455 --- loss: 0.829523, loss_ss: 0.816612, loss_d: 0.012911
0.3839 --- loss: 0.810482, loss_ss: 0.762166, loss_d: 0.048316
0.4223 --- loss: 0.789359, loss_ss: 0.780137, loss_d: 0.009222
0.4607 --- loss: 0.928453, loss_ss: 0.683695, loss_d: 0.244758
0.4990 --- loss: 0.898791, loss_ss: 0.888940, loss_d: 0.009851
0.5374 --- loss: 0.836322, loss_ss: 0.631432, loss_d: 0.204890
0.5758 --- loss: 0.769973, loss_ss: 0.736821, loss_d: 0.033152
0.6142 --- loss: 0.580932, loss_ss: 0.571227, loss_d: 0.009705
0.6526 --- loss: 0.794369, loss_ss: 0.772614, loss_d: 0.021755
0.6910 --- loss: 0.612828, loss_ss: 0.611067, loss_d: 0.001761
0.7294 --- loss: 0.839381, loss_ss: 0.829725, loss_d: 0.009656
0.7678 --- loss: 0.454939, loss_ss: 0.425683, loss_d: 0.029256
0.8061 --- loss: 1.422794, loss_ss: 0.882972, loss_d: 0.539822
0.8445 --- loss: 0.690815, loss_ss: 0.418862, loss_d: 0.271953
0.8829 --- loss: 0.665059, loss_ss: 0.570059, loss_d: 0.095000
0.9213 --- loss: 0.884463, loss_ss: 0.631993, loss_d: 0.252471
0.9597 --- loss: 0.903621, loss_ss: 0.855106, loss_d: 0.048515
0.9981 --- loss: 0.463006, loss_ss: 0.448356, loss_d: 0.014650
Epoch finished! Loss: 0.8479901515520536
Starting epoch 10/10.
0.0000 --- loss: 0.667088, loss_ss: 0.654156, loss_d: 0.012932
0.0384 --- loss: 0.835077, loss_ss: 0.809357, loss_d: 0.025720
0.0768 --- loss: 0.702470, loss_ss: 0.693951, loss_d: 0.008519
0.1152 --- loss: 0.837766, loss_ss: 0.793557, loss_d: 0.044209
0.1536 --- loss: 0.932692, loss_ss: 0.660455, loss_d: 0.272236
0.1919 --- loss: 0.628907, loss_ss: 0.618848, loss_d: 0.010059
0.2303 --- loss: 0.927912, loss_ss: 0.867086, loss_d: 0.060826
0.2687 --- loss: 0.693138, loss_ss: 0.692443, loss_d: 0.000695
0.3071 --- loss: 1.392209, loss_ss: 0.856490, loss_d: 0.535719
0.3455 --- loss: 0.926093, loss_ss: 0.823268, loss_d: 0.102825
0.3839 --- loss: 0.503963, loss_ss: 0.482095, loss_d: 0.021868
0.4223 --- loss: 0.674293, loss_ss: 0.640016, loss_d: 0.034277
0.4607 --- loss: 0.672300, loss_ss: 0.620197, loss_d: 0.052103
0.4990 --- loss: 0.689875, loss_ss: 0.498241, loss_d: 0.191634
0.5374 --- loss: 0.662652, loss_ss: 0.658216, loss_d: 0.004436
0.5758 --- loss: 0.715295, loss_ss: 0.671325, loss_d: 0.043970
0.6142 --- loss: 0.559087, loss_ss: 0.528929, loss_d: 0.030158
0.6526 --- loss: 0.892856, loss_ss: 0.883727, loss_d: 0.009129
0.6910 --- loss: 0.795852, loss_ss: 0.642311, loss_d: 0.153541
0.7294 --- loss: 0.780472, loss_ss: 0.759379, loss_d: 0.021093
0.7678 --- loss: 0.782300, loss_ss: 0.653468, loss_d: 0.128832
0.8061 --- loss: 0.926759, loss_ss: 0.884211, loss_d: 0.042548
0.8445 --- loss: 0.645247, loss_ss: 0.639557, loss_d: 0.005690
0.8829 --- loss: 0.688003, loss_ss: 0.661912, loss_d: 0.026091
0.9213 --- loss: 0.923360, loss_ss: 0.819331, loss_d: 0.104028
0.9597 --- loss: 0.692676, loss_ss: 0.668029, loss_d: 0.024648
0.9981 --- loss: 0.752695, loss_ss: 0.640906, loss_d: 0.111789
Epoch finished! Loss: 0.8029171175681628
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.798989898989899
             precision    recall  f1-score   support

        0.0       0.99      0.73      0.84       203
        1.0       0.26      0.69      0.38        68
        2.0       0.89      0.86      0.87       397
        3.0       0.99      0.79      0.88       146
        4.0       0.88      0.78      0.83       176

avg / total       0.88      0.80      0.83       990
 


====== chp014-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.34  73.40   99.75  98.68     84.18
1  84.24  69.12   85.36  25.82     37.60
2  90.10  86.15   92.75  88.83     87.47
3  96.87  79.45   99.88  99.15     88.21
4  94.24  77.84   97.79  88.39     82.78
Total accuracy: 79.90%
Average sen: 77.19%
Average spec: 95.10%
Macro f1-score: 76.05%
Diagnosis acc on 15mins: 1.0
[0.939592   0.99543589 0.97393417 0.92626458 0.86163247 0.9412508
 0.99348843 0.99761105 0.97976935 0.97975343 0.94225228 0.98469573
 0.97659397 0.93258536 0.99491441 0.99644631 0.9956038  0.99627656
 0.99823272 0.9844417  0.99934405 0.99978322 0.99672914 0.98108369
 0.95894355 0.96486193 0.94561654 0.96877778 0.99717218 0.96494496
 0.97111487 0.99878186 0.9964276 ]
pred: 0.9737683751366355, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.417384, loss_ss: 1.746896, loss_d: 0.670488
0.0385 --- loss: 2.095185, loss_ss: 1.544717, loss_d: 0.550468
0.0769 --- loss: 2.077347, loss_ss: 1.386769, loss_d: 0.690578
0.1154 --- loss: 1.846565, loss_ss: 1.399105, loss_d: 0.447460
0.1538 --- loss: 2.067241, loss_ss: 1.398810, loss_d: 0.668431
0.1923 --- loss: 1.983043, loss_ss: 1.315623, loss_d: 0.667421
0.2308 --- loss: 1.889882, loss_ss: 1.238526, loss_d: 0.651356
0.2692 --- loss: 1.773154, loss_ss: 1.183980, loss_d: 0.589174
0.3077 --- loss: 1.859175, loss_ss: 1.169472, loss_d: 0.689703
0.3462 --- loss: 2.040940, loss_ss: 1.615097, loss_d: 0.425843
0.3846 --- loss: 1.744146, loss_ss: 1.223132, loss_d: 0.521015
0.4231 --- loss: 1.669832, loss_ss: 1.287212, loss_d: 0.382620
0.4615 --- loss: 1.712580, loss_ss: 1.295921, loss_d: 0.416660
0.5000 --- loss: 1.708163, loss_ss: 1.169309, loss_d: 0.538854
0.5385 --- loss: 1.918740, loss_ss: 1.158118, loss_d: 0.760622
0.5769 --- loss: 1.741664, loss_ss: 1.232837, loss_d: 0.508827
0.6154 --- loss: 1.832753, loss_ss: 1.348297, loss_d: 0.484456
0.6538 --- loss: 1.613266, loss_ss: 1.135755, loss_d: 0.477511
0.6923 --- loss: 1.837734, loss_ss: 1.229596, loss_d: 0.608138
0.7308 --- loss: 2.030455, loss_ss: 1.092050, loss_d: 0.938405
0.7692 --- loss: 1.629737, loss_ss: 1.291996, loss_d: 0.337741
0.8077 --- loss: 1.749105, loss_ss: 1.393342, loss_d: 0.355763
0.8462 --- loss: 1.906571, loss_ss: 1.073199, loss_d: 0.833372
0.8846 --- loss: 2.246345, loss_ss: 1.528206, loss_d: 0.718139
0.9231 --- loss: 1.553954, loss_ss: 1.134344, loss_d: 0.419610
0.9615 --- loss: 1.696808, loss_ss: 0.954185, loss_d: 0.742623
Epoch finished! Loss: 1.7813614850799089
Starting epoch 2/10.
0.0000 --- loss: 1.400625, loss_ss: 1.117509, loss_d: 0.283116
0.0385 --- loss: 1.480935, loss_ss: 1.106065, loss_d: 0.374871
0.0769 --- loss: 1.473919, loss_ss: 1.105085, loss_d: 0.368834
0.1154 --- loss: 1.268431, loss_ss: 1.081169, loss_d: 0.187262
0.1538 --- loss: 1.401702, loss_ss: 0.888301, loss_d: 0.513402
0.1923 --- loss: 1.121410, loss_ss: 0.902806, loss_d: 0.218604
0.2308 --- loss: 1.238232, loss_ss: 1.058980, loss_d: 0.179252
0.2692 --- loss: 1.374786, loss_ss: 1.131438, loss_d: 0.243348
0.3077 --- loss: 1.289960, loss_ss: 1.087689, loss_d: 0.202271
0.3462 --- loss: 1.480200, loss_ss: 1.158077, loss_d: 0.322123
0.3846 --- loss: 1.344422, loss_ss: 0.992232, loss_d: 0.352190
0.4231 --- loss: 1.367131, loss_ss: 1.167183, loss_d: 0.199947
0.4615 --- loss: 1.500324, loss_ss: 1.072956, loss_d: 0.427368
0.5000 --- loss: 1.443850, loss_ss: 1.243128, loss_d: 0.200722
0.5385 --- loss: 1.518737, loss_ss: 0.962273, loss_d: 0.556464
0.5769 --- loss: 1.342673, loss_ss: 1.239998, loss_d: 0.102675
0.6154 --- loss: 1.399465, loss_ss: 1.147600, loss_d: 0.251865
0.6538 --- loss: 1.079124, loss_ss: 0.894865, loss_d: 0.184259
0.6923 --- loss: 1.132270, loss_ss: 0.989406, loss_d: 0.142864
0.7308 --- loss: 1.795886, loss_ss: 0.919598, loss_d: 0.876289
0.7692 --- loss: 1.441338, loss_ss: 1.010729, loss_d: 0.430609
0.8077 --- loss: 1.187338, loss_ss: 1.040622, loss_d: 0.146716
0.8462 --- loss: 0.897126, loss_ss: 0.712794, loss_d: 0.184332
0.8846 --- loss: 1.333648, loss_ss: 1.148262, loss_d: 0.185386
0.9231 --- loss: 1.287958, loss_ss: 1.028976, loss_d: 0.258982
0.9615 --- loss: 0.943769, loss_ss: 0.805841, loss_d: 0.137928
Epoch finished! Loss: 1.3864654339418447
Starting epoch 3/10.
0.0000 --- loss: 1.059479, loss_ss: 0.932338, loss_d: 0.127142
0.0385 --- loss: 1.254272, loss_ss: 0.822716, loss_d: 0.431556
0.0769 --- loss: 1.088867, loss_ss: 0.895636, loss_d: 0.193231
0.1154 --- loss: 1.177742, loss_ss: 0.831872, loss_d: 0.345871
0.1538 --- loss: 1.187870, loss_ss: 0.926533, loss_d: 0.261337
0.1923 --- loss: 0.953179, loss_ss: 0.869893, loss_d: 0.083286
0.2308 --- loss: 1.296300, loss_ss: 1.152993, loss_d: 0.143307
0.2692 --- loss: 1.307103, loss_ss: 1.216559, loss_d: 0.090543
0.3077 --- loss: 1.434654, loss_ss: 1.292166, loss_d: 0.142488
0.3462 --- loss: 1.361987, loss_ss: 0.964742, loss_d: 0.397246
0.3846 --- loss: 1.200325, loss_ss: 0.942807, loss_d: 0.257518
0.4231 --- loss: 1.222071, loss_ss: 0.874033, loss_d: 0.348038
0.4615 --- loss: 0.897837, loss_ss: 0.789580, loss_d: 0.108258
0.5000 --- loss: 1.037060, loss_ss: 0.836253, loss_d: 0.200807
0.5385 --- loss: 1.031025, loss_ss: 0.971468, loss_d: 0.059557
0.5769 --- loss: 0.801444, loss_ss: 0.714273, loss_d: 0.087171
0.6154 --- loss: 0.833307, loss_ss: 0.675533, loss_d: 0.157774
0.6538 --- loss: 1.185538, loss_ss: 0.878992, loss_d: 0.306546
0.6923 --- loss: 1.040586, loss_ss: 0.863506, loss_d: 0.177080
0.7308 --- loss: 0.934561, loss_ss: 0.802118, loss_d: 0.132443
0.7692 --- loss: 1.319365, loss_ss: 0.736063, loss_d: 0.583302
0.8077 --- loss: 1.344313, loss_ss: 1.145455, loss_d: 0.198859
0.8462 --- loss: 0.961060, loss_ss: 0.887818, loss_d: 0.073242
0.8846 --- loss: 1.204074, loss_ss: 0.912486, loss_d: 0.291588
0.9231 --- loss: 1.129095, loss_ss: 0.924617, loss_d: 0.204479
0.9615 --- loss: 1.358713, loss_ss: 0.638179, loss_d: 0.720534
Epoch finished! Loss: 1.1491972880013661
Starting epoch 4/10.
0.0000 --- loss: 1.222282, loss_ss: 1.135131, loss_d: 0.087152
0.0385 --- loss: 1.033578, loss_ss: 0.785983, loss_d: 0.247595
0.0769 --- loss: 1.118132, loss_ss: 0.998513, loss_d: 0.119620
0.1154 --- loss: 1.158081, loss_ss: 0.900201, loss_d: 0.257880
0.1538 --- loss: 1.132241, loss_ss: 0.876844, loss_d: 0.255397
0.1923 --- loss: 1.189338, loss_ss: 1.001490, loss_d: 0.187849
0.2308 --- loss: 1.238576, loss_ss: 0.923754, loss_d: 0.314822
0.2692 --- loss: 1.123077, loss_ss: 0.913549, loss_d: 0.209528
0.3077 --- loss: 0.918178, loss_ss: 0.851054, loss_d: 0.067123
0.3462 --- loss: 1.004061, loss_ss: 0.814885, loss_d: 0.189177
0.3846 --- loss: 0.908466, loss_ss: 0.855262, loss_d: 0.053204
0.4231 --- loss: 0.872943, loss_ss: 0.832863, loss_d: 0.040079
0.4615 --- loss: 1.148518, loss_ss: 1.015343, loss_d: 0.133175
0.5000 --- loss: 0.845308, loss_ss: 0.818749, loss_d: 0.026559
0.5385 --- loss: 0.998423, loss_ss: 0.795198, loss_d: 0.203225
0.5769 --- loss: 1.159944, loss_ss: 0.992493, loss_d: 0.167452
0.6154 --- loss: 1.024470, loss_ss: 0.824431, loss_d: 0.200039
0.6538 --- loss: 1.234950, loss_ss: 0.792295, loss_d: 0.442655
0.6923 --- loss: 1.254093, loss_ss: 1.128560, loss_d: 0.125533
0.7308 --- loss: 0.719140, loss_ss: 0.595338, loss_d: 0.123802
0.7692 --- loss: 1.129688, loss_ss: 0.882036, loss_d: 0.247653
0.8077 --- loss: 1.011529, loss_ss: 0.879082, loss_d: 0.132448
0.8462 --- loss: 0.908734, loss_ss: 0.719296, loss_d: 0.189439
0.8846 --- loss: 0.849544, loss_ss: 0.735342, loss_d: 0.114202
0.9231 --- loss: 2.442265, loss_ss: 0.594805, loss_d: 1.847460
0.9615 --- loss: 0.778617, loss_ss: 0.658828, loss_d: 0.119789
Epoch finished! Loss: 1.1224889858809217
Starting epoch 5/10.
0.0000 --- loss: 1.185058, loss_ss: 1.077000, loss_d: 0.108057
0.0385 --- loss: 1.386805, loss_ss: 0.954275, loss_d: 0.432530
0.0769 --- loss: 0.957057, loss_ss: 0.857445, loss_d: 0.099612
0.1154 --- loss: 0.793204, loss_ss: 0.660953, loss_d: 0.132251
0.1538 --- loss: 0.937094, loss_ss: 0.892076, loss_d: 0.045018
0.1923 --- loss: 1.145614, loss_ss: 0.868312, loss_d: 0.277302
0.2308 --- loss: 1.185679, loss_ss: 0.784713, loss_d: 0.400966
0.2692 --- loss: 0.912279, loss_ss: 0.881123, loss_d: 0.031155
0.3077 --- loss: 0.700396, loss_ss: 0.669799, loss_d: 0.030597
0.3462 --- loss: 1.008036, loss_ss: 0.936061, loss_d: 0.071975
0.3846 --- loss: 0.932337, loss_ss: 0.718203, loss_d: 0.214135
0.4231 --- loss: 0.921254, loss_ss: 0.706187, loss_d: 0.215067
0.4615 --- loss: 0.838205, loss_ss: 0.751768, loss_d: 0.086437
0.5000 --- loss: 1.216407, loss_ss: 0.880747, loss_d: 0.335660
0.5385 --- loss: 0.942529, loss_ss: 0.694920, loss_d: 0.247609
0.5769 --- loss: 1.377765, loss_ss: 0.927500, loss_d: 0.450266
0.6154 --- loss: 0.770247, loss_ss: 0.751728, loss_d: 0.018518
0.6538 --- loss: 0.592020, loss_ss: 0.567331, loss_d: 0.024689
0.6923 --- loss: 0.664526, loss_ss: 0.648848, loss_d: 0.015679
0.7308 --- loss: 0.832519, loss_ss: 0.770606, loss_d: 0.061913
0.7692 --- loss: 0.917451, loss_ss: 0.835697, loss_d: 0.081755
0.8077 --- loss: 2.095214, loss_ss: 1.898004, loss_d: 0.197211
0.8462 --- loss: 0.856168, loss_ss: 0.753240, loss_d: 0.102928
0.8846 --- loss: 0.718510, loss_ss: 0.701893, loss_d: 0.016618
0.9231 --- loss: 0.729816, loss_ss: 0.680242, loss_d: 0.049574
0.9615 --- loss: 1.097001, loss_ss: 0.919025, loss_d: 0.177976
Epoch finished! Loss: 0.9692313224652559
Starting epoch 6/10.
0.0000 --- loss: 1.343183, loss_ss: 1.050590, loss_d: 0.292593
0.0385 --- loss: 1.235975, loss_ss: 1.214626, loss_d: 0.021349
0.0769 --- loss: 0.948568, loss_ss: 0.936719, loss_d: 0.011849
0.1154 --- loss: 1.072668, loss_ss: 0.796244, loss_d: 0.276423
0.1538 --- loss: 0.536656, loss_ss: 0.443314, loss_d: 0.093342
0.1923 --- loss: 0.775154, loss_ss: 0.737170, loss_d: 0.037984
0.2308 --- loss: 0.846688, loss_ss: 0.792505, loss_d: 0.054183
0.2692 --- loss: 0.838721, loss_ss: 0.820619, loss_d: 0.018102
0.3077 --- loss: 0.773440, loss_ss: 0.634654, loss_d: 0.138786
0.3462 --- loss: 1.239105, loss_ss: 0.796223, loss_d: 0.442882
0.3846 --- loss: 0.622886, loss_ss: 0.606754, loss_d: 0.016132
0.4231 --- loss: 1.018617, loss_ss: 0.593692, loss_d: 0.424925
0.4615 --- loss: 0.768086, loss_ss: 0.748204, loss_d: 0.019881
0.5000 --- loss: 0.686103, loss_ss: 0.660731, loss_d: 0.025372
0.5385 --- loss: 0.952875, loss_ss: 0.817750, loss_d: 0.135125
0.5769 --- loss: 0.919450, loss_ss: 0.631170, loss_d: 0.288279
0.6154 --- loss: 0.859276, loss_ss: 0.647412, loss_d: 0.211864
0.6538 --- loss: 0.844938, loss_ss: 0.719703, loss_d: 0.125235
0.6923 --- loss: 0.760775, loss_ss: 0.697964, loss_d: 0.062811
0.7308 --- loss: 0.752441, loss_ss: 0.714986, loss_d: 0.037456
0.7692 --- loss: 0.671893, loss_ss: 0.650018, loss_d: 0.021876
0.8077 --- loss: 0.719054, loss_ss: 0.667861, loss_d: 0.051193
0.8462 --- loss: 0.881043, loss_ss: 0.866146, loss_d: 0.014897
0.8846 --- loss: 0.816388, loss_ss: 0.768289, loss_d: 0.048099
0.9231 --- loss: 1.062613, loss_ss: 0.797939, loss_d: 0.264673
0.9615 --- loss: 0.959285, loss_ss: 0.619464, loss_d: 0.339820
Epoch finished! Loss: 0.9247031989705148
Starting epoch 7/10.
0.0000 --- loss: 0.661961, loss_ss: 0.490527, loss_d: 0.171434
0.0385 --- loss: 0.780731, loss_ss: 0.739434, loss_d: 0.041298
0.0769 --- loss: 0.819860, loss_ss: 0.774666, loss_d: 0.045194
0.1154 --- loss: 0.937475, loss_ss: 0.862777, loss_d: 0.074697
0.1538 --- loss: 0.804055, loss_ss: 0.791809, loss_d: 0.012247
0.1923 --- loss: 1.140421, loss_ss: 0.834454, loss_d: 0.305968
0.2308 --- loss: 0.883170, loss_ss: 0.854654, loss_d: 0.028516
0.2692 --- loss: 0.760350, loss_ss: 0.712060, loss_d: 0.048290
0.3077 --- loss: 1.169340, loss_ss: 1.070916, loss_d: 0.098425
0.3462 --- loss: 1.209502, loss_ss: 1.169720, loss_d: 0.039782
0.3846 --- loss: 0.623309, loss_ss: 0.602782, loss_d: 0.020526
0.4231 --- loss: 0.806741, loss_ss: 0.802833, loss_d: 0.003908
0.4615 --- loss: 0.931276, loss_ss: 0.912659, loss_d: 0.018617
0.5000 --- loss: 0.677924, loss_ss: 0.614599, loss_d: 0.063325
0.5385 --- loss: 0.831206, loss_ss: 0.819257, loss_d: 0.011949
0.5769 --- loss: 0.733000, loss_ss: 0.640950, loss_d: 0.092050
0.6154 --- loss: 0.816040, loss_ss: 0.690728, loss_d: 0.125311
0.6538 --- loss: 0.786457, loss_ss: 0.756152, loss_d: 0.030305
0.6923 --- loss: 0.822259, loss_ss: 0.808309, loss_d: 0.013950
0.7308 --- loss: 0.941164, loss_ss: 0.823506, loss_d: 0.117658
0.7692 --- loss: 0.765291, loss_ss: 0.753146, loss_d: 0.012145
0.8077 --- loss: 0.740896, loss_ss: 0.731867, loss_d: 0.009028
0.8462 --- loss: 0.859974, loss_ss: 0.818237, loss_d: 0.041737
0.8846 --- loss: 0.766229, loss_ss: 0.658873, loss_d: 0.107356
0.9231 --- loss: 0.996292, loss_ss: 0.824073, loss_d: 0.172219
0.9615 --- loss: 0.959193, loss_ss: 0.866109, loss_d: 0.093084
Epoch finished! Loss: 0.9031981133125924
Starting epoch 8/10.
0.0000 --- loss: 1.300570, loss_ss: 1.088201, loss_d: 0.212369
0.0385 --- loss: 1.053590, loss_ss: 0.561152, loss_d: 0.492437
0.0769 --- loss: 0.807045, loss_ss: 0.762730, loss_d: 0.044315
0.1154 --- loss: 0.812585, loss_ss: 0.724766, loss_d: 0.087819
0.1538 --- loss: 0.724554, loss_ss: 0.708972, loss_d: 0.015582
0.1923 --- loss: 0.889888, loss_ss: 0.887513, loss_d: 0.002375
0.2308 --- loss: 0.779034, loss_ss: 0.759196, loss_d: 0.019838
0.2692 --- loss: 0.812704, loss_ss: 0.804550, loss_d: 0.008154
0.3077 --- loss: 0.763827, loss_ss: 0.386292, loss_d: 0.377536
0.3462 --- loss: 0.711073, loss_ss: 0.643777, loss_d: 0.067296
0.3846 --- loss: 0.680161, loss_ss: 0.538845, loss_d: 0.141315
0.4231 --- loss: 1.228991, loss_ss: 1.222050, loss_d: 0.006941
0.4615 --- loss: 0.684396, loss_ss: 0.675644, loss_d: 0.008752
0.5000 --- loss: 0.852533, loss_ss: 0.816871, loss_d: 0.035662
0.5385 --- loss: 1.094989, loss_ss: 0.990656, loss_d: 0.104333
0.5769 --- loss: 1.130385, loss_ss: 0.583844, loss_d: 0.546541
0.6154 --- loss: 0.824925, loss_ss: 0.682789, loss_d: 0.142136
0.6538 --- loss: 0.629244, loss_ss: 0.609124, loss_d: 0.020120
0.6923 --- loss: 1.256428, loss_ss: 1.208990, loss_d: 0.047438
0.7308 --- loss: 0.786923, loss_ss: 0.691236, loss_d: 0.095687
0.7692 --- loss: 0.645221, loss_ss: 0.643603, loss_d: 0.001618
0.8077 --- loss: 0.618212, loss_ss: 0.614461, loss_d: 0.003751
0.8462 --- loss: 0.788122, loss_ss: 0.776367, loss_d: 0.011755
0.8846 --- loss: 0.876916, loss_ss: 0.824941, loss_d: 0.051975
0.9231 --- loss: 1.035592, loss_ss: 1.006112, loss_d: 0.029480
0.9615 --- loss: 1.007270, loss_ss: 0.995308, loss_d: 0.011962
Epoch finished! Loss: 0.8479629456996918
Starting epoch 9/10.
0.0000 --- loss: 0.891367, loss_ss: 0.754890, loss_d: 0.136476
0.0385 --- loss: 0.987658, loss_ss: 0.710912, loss_d: 0.276746
0.0769 --- loss: 1.384163, loss_ss: 1.133434, loss_d: 0.250729
0.1154 --- loss: 0.659083, loss_ss: 0.619982, loss_d: 0.039101
0.1538 --- loss: 0.930160, loss_ss: 0.768719, loss_d: 0.161441
0.1923 --- loss: 1.306829, loss_ss: 0.847800, loss_d: 0.459029
0.2308 --- loss: 0.739416, loss_ss: 0.668079, loss_d: 0.071337
0.2692 --- loss: 0.594201, loss_ss: 0.584781, loss_d: 0.009420
0.3077 --- loss: 0.552727, loss_ss: 0.511316, loss_d: 0.041410
0.3462 --- loss: 0.920427, loss_ss: 0.907677, loss_d: 0.012750
0.3846 --- loss: 0.796868, loss_ss: 0.763028, loss_d: 0.033840
0.4231 --- loss: 1.065946, loss_ss: 0.961114, loss_d: 0.104832
0.4615 --- loss: 1.204775, loss_ss: 0.526910, loss_d: 0.677866
0.5000 --- loss: 0.871726, loss_ss: 0.746413, loss_d: 0.125313
0.5385 --- loss: 0.943887, loss_ss: 0.911074, loss_d: 0.032814
0.5769 --- loss: 0.812151, loss_ss: 0.697233, loss_d: 0.114918
0.6154 --- loss: 1.039431, loss_ss: 1.032775, loss_d: 0.006657
0.6538 --- loss: 0.571834, loss_ss: 0.525511, loss_d: 0.046322
0.6923 --- loss: 0.549039, loss_ss: 0.528128, loss_d: 0.020911
0.7308 --- loss: 0.921858, loss_ss: 0.764431, loss_d: 0.157427
0.7692 --- loss: 0.730685, loss_ss: 0.722343, loss_d: 0.008342
0.8077 --- loss: 0.690935, loss_ss: 0.652975, loss_d: 0.037960
0.8462 --- loss: 0.616933, loss_ss: 0.598140, loss_d: 0.018794
0.8846 --- loss: 0.894281, loss_ss: 0.817387, loss_d: 0.076893
0.9231 --- loss: 0.630443, loss_ss: 0.608211, loss_d: 0.022232
0.9615 --- loss: 0.764252, loss_ss: 0.524939, loss_d: 0.239314
Epoch finished! Loss: 0.8101720446325177
Starting epoch 10/10.
0.0000 --- loss: 0.995949, loss_ss: 0.957298, loss_d: 0.038651
0.0385 --- loss: 0.801752, loss_ss: 0.748157, loss_d: 0.053595
0.0769 --- loss: 0.845540, loss_ss: 0.832336, loss_d: 0.013204
0.1154 --- loss: 0.940456, loss_ss: 0.896315, loss_d: 0.044142
0.1538 --- loss: 0.785669, loss_ss: 0.744956, loss_d: 0.040713
0.1923 --- loss: 0.747539, loss_ss: 0.734263, loss_d: 0.013277
0.2308 --- loss: 0.731104, loss_ss: 0.714699, loss_d: 0.016406
0.2692 --- loss: 0.742452, loss_ss: 0.569843, loss_d: 0.172609
0.3077 --- loss: 0.877498, loss_ss: 0.866810, loss_d: 0.010688
0.3462 --- loss: 0.559546, loss_ss: 0.550655, loss_d: 0.008891
0.3846 --- loss: 1.021995, loss_ss: 0.691622, loss_d: 0.330372
0.4231 --- loss: 0.528369, loss_ss: 0.498749, loss_d: 0.029620
0.4615 --- loss: 1.339375, loss_ss: 1.017154, loss_d: 0.322221
0.5000 --- loss: 0.748372, loss_ss: 0.733754, loss_d: 0.014618
0.5385 --- loss: 0.871491, loss_ss: 0.821747, loss_d: 0.049745
0.5769 --- loss: 0.772449, loss_ss: 0.731257, loss_d: 0.041192
0.6154 --- loss: 1.077419, loss_ss: 0.775397, loss_d: 0.302022
0.6538 --- loss: 1.000012, loss_ss: 0.745903, loss_d: 0.254109
0.6923 --- loss: 0.946434, loss_ss: 0.857368, loss_d: 0.089066
0.7308 --- loss: 0.965598, loss_ss: 0.909924, loss_d: 0.055674
0.7692 --- loss: 0.863785, loss_ss: 0.772573, loss_d: 0.091211
0.8077 --- loss: 1.011524, loss_ss: 0.915139, loss_d: 0.096384
0.8462 --- loss: 0.743665, loss_ss: 0.543687, loss_d: 0.199978
0.8846 --- loss: 0.607755, loss_ss: 0.596541, loss_d: 0.011215
0.9231 --- loss: 0.510382, loss_ss: 0.504772, loss_d: 0.005611
0.9615 --- loss: 0.736695, loss_ss: 0.649294, loss_d: 0.087401
Epoch finished! Loss: 0.8120404847800502
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.706140350877193
             precision    recall  f1-score   support

        0.0       0.35      0.84      0.49        67
        1.0       0.65      0.36      0.47       281
        2.0       0.74      0.84      0.79       335
        3.0       0.99      0.79      0.88       264
        4.0       0.68      0.81      0.74       193

avg / total       0.74      0.71      0.70      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.91  83.58   90.31  35.00     49.34
1  79.56  36.30   93.71  65.38     46.68
2  86.67  84.18   87.70  74.02     78.77
3  94.82  78.79   99.66  98.58     87.58
4  90.26  81.35   92.08  67.67     73.88
Total accuracy: 70.61%
Average sen: 72.84%
Average spec: 92.69%
Macro f1-score: 67.25%
Diagnosis acc on 15mins: 0.9736842105263158
[0.99692768 0.88952202 0.97509456 0.99670655 0.99626923 0.99374181
 0.99999976 1.         1.         1.         0.99999988 1.
 0.99989629 0.9491322  0.91841561 0.98532307 0.99586111 0.99999988
 1.         0.99944478 0.94274783 0.89738715 0.99997663 0.99939466
 0.99992347 0.99999988 0.94856995 0.94304717 0.60860372 0.99426419
 0.39061117 0.74721867 0.76149076 0.99990606 0.99998951 0.9986456
 0.99999964 0.99444062]
pred: 0.9453302919864655, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.622638, loss_ss: 1.906069, loss_d: 0.716569
0.0385 --- loss: 2.227633, loss_ss: 1.527970, loss_d: 0.699663
0.0770 --- loss: 1.894335, loss_ss: 1.552890, loss_d: 0.341446
0.1156 --- loss: 2.215897, loss_ss: 1.552312, loss_d: 0.663584
0.1541 --- loss: 2.159350, loss_ss: 1.540672, loss_d: 0.618678
0.1926 --- loss: 2.180648, loss_ss: 1.593784, loss_d: 0.586864
0.2311 --- loss: 2.048951, loss_ss: 1.470079, loss_d: 0.578872
0.2696 --- loss: 1.829032, loss_ss: 1.440737, loss_d: 0.388295
0.3082 --- loss: 1.966258, loss_ss: 1.452970, loss_d: 0.513288
0.3467 --- loss: 1.896550, loss_ss: 1.422395, loss_d: 0.474155
0.3852 --- loss: 2.425839, loss_ss: 1.299846, loss_d: 1.125993
0.4237 --- loss: 1.733175, loss_ss: 1.192336, loss_d: 0.540839
0.4622 --- loss: 2.193757, loss_ss: 1.355813, loss_d: 0.837943
0.5008 --- loss: 1.821616, loss_ss: 1.397290, loss_d: 0.424326
0.5393 --- loss: 2.048592, loss_ss: 1.366368, loss_d: 0.682224
0.5778 --- loss: 1.700413, loss_ss: 1.336967, loss_d: 0.363445
0.6163 --- loss: 1.666830, loss_ss: 1.285172, loss_d: 0.381658
0.6549 --- loss: 2.038572, loss_ss: 1.365957, loss_d: 0.672615
0.6934 --- loss: 1.803034, loss_ss: 1.528920, loss_d: 0.274114
0.7319 --- loss: 1.940914, loss_ss: 1.358699, loss_d: 0.582215
0.7704 --- loss: 1.484045, loss_ss: 1.164118, loss_d: 0.319927
0.8089 --- loss: 1.441953, loss_ss: 1.255604, loss_d: 0.186349
0.8475 --- loss: 1.570851, loss_ss: 1.252464, loss_d: 0.318387
0.8860 --- loss: 1.647403, loss_ss: 1.164307, loss_d: 0.483095
0.9245 --- loss: 1.296457, loss_ss: 1.025063, loss_d: 0.271393
0.9630 --- loss: 1.525154, loss_ss: 1.236542, loss_d: 0.288612
Epoch finished! Loss: 1.9301553688454351
Starting epoch 2/10.
0.0000 --- loss: 1.716265, loss_ss: 1.003391, loss_d: 0.712873
0.0385 --- loss: 1.558185, loss_ss: 1.247119, loss_d: 0.311066
0.0770 --- loss: 1.621615, loss_ss: 1.170408, loss_d: 0.451207
0.1156 --- loss: 1.276216, loss_ss: 1.018309, loss_d: 0.257907
0.1541 --- loss: 1.295883, loss_ss: 1.149439, loss_d: 0.146444
0.1926 --- loss: 1.701762, loss_ss: 1.236789, loss_d: 0.464973
0.2311 --- loss: 1.358991, loss_ss: 1.177282, loss_d: 0.181710
0.2696 --- loss: 1.267521, loss_ss: 1.162290, loss_d: 0.105231
0.3082 --- loss: 1.507579, loss_ss: 0.972168, loss_d: 0.535411
0.3467 --- loss: 1.511055, loss_ss: 1.100633, loss_d: 0.410421
0.3852 --- loss: 1.166266, loss_ss: 1.028221, loss_d: 0.138045
0.4237 --- loss: 1.299743, loss_ss: 1.074361, loss_d: 0.225381
0.4622 --- loss: 1.644958, loss_ss: 1.046871, loss_d: 0.598088
0.5008 --- loss: 1.263419, loss_ss: 0.938873, loss_d: 0.324546
0.5393 --- loss: 1.387983, loss_ss: 1.127491, loss_d: 0.260492
0.5778 --- loss: 1.612648, loss_ss: 1.120557, loss_d: 0.492091
0.6163 --- loss: 1.587880, loss_ss: 1.173948, loss_d: 0.413932
0.6549 --- loss: 1.071350, loss_ss: 0.833950, loss_d: 0.237400
0.6934 --- loss: 1.101936, loss_ss: 0.872012, loss_d: 0.229924
0.7319 --- loss: 1.036840, loss_ss: 0.830718, loss_d: 0.206122
0.7704 --- loss: 1.497406, loss_ss: 1.043897, loss_d: 0.453509
0.8089 --- loss: 1.226587, loss_ss: 1.034481, loss_d: 0.192106
0.8475 --- loss: 1.384649, loss_ss: 0.991797, loss_d: 0.392852
0.8860 --- loss: 1.080973, loss_ss: 0.995642, loss_d: 0.085331
0.9245 --- loss: 1.042361, loss_ss: 0.816218, loss_d: 0.226144
0.9630 --- loss: 1.427112, loss_ss: 1.085766, loss_d: 0.341346
Epoch finished! Loss: 1.3386743832739163
Starting epoch 3/10.
0.0000 --- loss: 1.110399, loss_ss: 0.902973, loss_d: 0.207425
0.0385 --- loss: 0.859508, loss_ss: 0.732414, loss_d: 0.127094
0.0770 --- loss: 1.309226, loss_ss: 1.064874, loss_d: 0.244351
0.1156 --- loss: 1.760483, loss_ss: 1.179059, loss_d: 0.581424
0.1541 --- loss: 1.248802, loss_ss: 0.963118, loss_d: 0.285684
0.1926 --- loss: 1.202052, loss_ss: 0.846061, loss_d: 0.355991
0.2311 --- loss: 1.406952, loss_ss: 0.932352, loss_d: 0.474600
0.2696 --- loss: 1.121684, loss_ss: 0.926061, loss_d: 0.195624
0.3082 --- loss: 1.233216, loss_ss: 0.964813, loss_d: 0.268403
0.3467 --- loss: 1.228163, loss_ss: 0.955529, loss_d: 0.272634
0.3852 --- loss: 1.469618, loss_ss: 1.214092, loss_d: 0.255525
0.4237 --- loss: 1.235129, loss_ss: 1.079912, loss_d: 0.155217
0.4622 --- loss: 1.163419, loss_ss: 0.985846, loss_d: 0.177572
0.5008 --- loss: 1.667177, loss_ss: 1.051580, loss_d: 0.615598
0.5393 --- loss: 1.294441, loss_ss: 0.913328, loss_d: 0.381113
0.5778 --- loss: 1.401992, loss_ss: 1.101104, loss_d: 0.300888
0.6163 --- loss: 1.140358, loss_ss: 0.802828, loss_d: 0.337530
0.6549 --- loss: 1.311005, loss_ss: 1.103321, loss_d: 0.207684
0.6934 --- loss: 1.250696, loss_ss: 1.006616, loss_d: 0.244080
0.7319 --- loss: 1.400487, loss_ss: 0.978678, loss_d: 0.421809
0.7704 --- loss: 1.275987, loss_ss: 0.844561, loss_d: 0.431426
0.8089 --- loss: 1.032552, loss_ss: 0.956855, loss_d: 0.075697
0.8475 --- loss: 0.973138, loss_ss: 0.818804, loss_d: 0.154334
0.8860 --- loss: 0.941732, loss_ss: 0.834175, loss_d: 0.107557
0.9245 --- loss: 1.018485, loss_ss: 0.837296, loss_d: 0.181189
0.9630 --- loss: 0.932007, loss_ss: 0.855050, loss_d: 0.076958
Epoch finished! Loss: 1.1759043950371761
Starting epoch 4/10.
0.0000 --- loss: 1.281478, loss_ss: 0.895485, loss_d: 0.385993
0.0385 --- loss: 1.134439, loss_ss: 0.975400, loss_d: 0.159040
0.0770 --- loss: 0.816322, loss_ss: 0.714565, loss_d: 0.101757
0.1156 --- loss: 1.046409, loss_ss: 0.955482, loss_d: 0.090927
0.1541 --- loss: 1.037424, loss_ss: 1.005505, loss_d: 0.031919
0.1926 --- loss: 0.892273, loss_ss: 0.778197, loss_d: 0.114075
0.2311 --- loss: 1.014985, loss_ss: 0.893605, loss_d: 0.121380
0.2696 --- loss: 0.978500, loss_ss: 0.841471, loss_d: 0.137029
0.3082 --- loss: 1.015160, loss_ss: 0.899170, loss_d: 0.115990
0.3467 --- loss: 1.289558, loss_ss: 1.235385, loss_d: 0.054173
0.3852 --- loss: 1.418947, loss_ss: 1.164045, loss_d: 0.254902
0.4237 --- loss: 0.895664, loss_ss: 0.716122, loss_d: 0.179541
0.4622 --- loss: 0.982027, loss_ss: 0.834099, loss_d: 0.147927
0.5008 --- loss: 0.929341, loss_ss: 0.809204, loss_d: 0.120137
0.5393 --- loss: 0.795773, loss_ss: 0.712001, loss_d: 0.083772
0.5778 --- loss: 1.621183, loss_ss: 1.120695, loss_d: 0.500488
0.6163 --- loss: 1.772071, loss_ss: 1.142081, loss_d: 0.629990
0.6549 --- loss: 1.054614, loss_ss: 0.757326, loss_d: 0.297289
0.6934 --- loss: 1.020840, loss_ss: 0.894447, loss_d: 0.126393
0.7319 --- loss: 1.041349, loss_ss: 0.655200, loss_d: 0.386149
0.7704 --- loss: 0.656788, loss_ss: 0.601372, loss_d: 0.055416
0.8089 --- loss: 0.898209, loss_ss: 0.680489, loss_d: 0.217719
0.8475 --- loss: 1.570550, loss_ss: 1.498314, loss_d: 0.072235
0.8860 --- loss: 1.374897, loss_ss: 1.253937, loss_d: 0.120960
0.9245 --- loss: 0.953568, loss_ss: 0.739187, loss_d: 0.214381
0.9630 --- loss: 0.933688, loss_ss: 0.772187, loss_d: 0.161501
Epoch finished! Loss: 1.0815607136741108
Starting epoch 5/10.
0.0000 --- loss: 0.912053, loss_ss: 0.871484, loss_d: 0.040569
0.0385 --- loss: 0.891122, loss_ss: 0.870853, loss_d: 0.020269
0.0770 --- loss: 0.862566, loss_ss: 0.771976, loss_d: 0.090590
0.1156 --- loss: 1.389599, loss_ss: 0.695633, loss_d: 0.693966
0.1541 --- loss: 0.676128, loss_ss: 0.639712, loss_d: 0.036416
0.1926 --- loss: 0.864187, loss_ss: 0.828950, loss_d: 0.035237
0.2311 --- loss: 1.072379, loss_ss: 0.966949, loss_d: 0.105430
0.2696 --- loss: 0.905290, loss_ss: 0.771522, loss_d: 0.133768
0.3082 --- loss: 0.794996, loss_ss: 0.752261, loss_d: 0.042735
0.3467 --- loss: 1.354857, loss_ss: 1.259881, loss_d: 0.094976
0.3852 --- loss: 0.906337, loss_ss: 0.786023, loss_d: 0.120315
0.4237 --- loss: 1.007607, loss_ss: 0.911735, loss_d: 0.095872
0.4622 --- loss: 0.642524, loss_ss: 0.583209, loss_d: 0.059315
0.5008 --- loss: 1.184215, loss_ss: 0.861144, loss_d: 0.323071
0.5393 --- loss: 1.363180, loss_ss: 1.118687, loss_d: 0.244493
0.5778 --- loss: 0.945953, loss_ss: 0.859898, loss_d: 0.086055
0.6163 --- loss: 0.944201, loss_ss: 0.755631, loss_d: 0.188570
0.6549 --- loss: 0.840336, loss_ss: 0.809023, loss_d: 0.031313
0.6934 --- loss: 1.238066, loss_ss: 1.144799, loss_d: 0.093267
0.7319 --- loss: 1.144033, loss_ss: 1.046144, loss_d: 0.097889
0.7704 --- loss: 1.440166, loss_ss: 1.414548, loss_d: 0.025618
0.8089 --- loss: 0.944439, loss_ss: 0.556511, loss_d: 0.387927
0.8475 --- loss: 1.039805, loss_ss: 0.779599, loss_d: 0.260206
0.8860 --- loss: 0.850025, loss_ss: 0.768629, loss_d: 0.081396
0.9245 --- loss: 0.943680, loss_ss: 0.792492, loss_d: 0.151188
0.9630 --- loss: 1.134716, loss_ss: 1.061622, loss_d: 0.073094
Epoch finished! Loss: 0.9966896935779616
Starting epoch 6/10.
0.0000 --- loss: 1.010758, loss_ss: 0.919497, loss_d: 0.091261
0.0385 --- loss: 0.936777, loss_ss: 0.898987, loss_d: 0.037791
0.0770 --- loss: 0.766772, loss_ss: 0.750345, loss_d: 0.016427
0.1156 --- loss: 0.847416, loss_ss: 0.727097, loss_d: 0.120319
0.1541 --- loss: 0.927581, loss_ss: 0.823280, loss_d: 0.104302
0.1926 --- loss: 1.121988, loss_ss: 0.842732, loss_d: 0.279256
0.2311 --- loss: 0.873211, loss_ss: 0.775085, loss_d: 0.098125
0.2696 --- loss: 0.795733, loss_ss: 0.662584, loss_d: 0.133149
0.3082 --- loss: 0.918120, loss_ss: 0.707745, loss_d: 0.210375
0.3467 --- loss: 1.090702, loss_ss: 0.883976, loss_d: 0.206726
0.3852 --- loss: 1.039838, loss_ss: 0.795352, loss_d: 0.244486
0.4237 --- loss: 0.811037, loss_ss: 0.707000, loss_d: 0.104037
0.4622 --- loss: 1.193676, loss_ss: 1.052033, loss_d: 0.141643
0.5008 --- loss: 1.082292, loss_ss: 0.740941, loss_d: 0.341351
0.5393 --- loss: 1.037474, loss_ss: 1.012347, loss_d: 0.025127
0.5778 --- loss: 0.724292, loss_ss: 0.649076, loss_d: 0.075216
0.6163 --- loss: 0.948467, loss_ss: 0.933714, loss_d: 0.014754
0.6549 --- loss: 0.728580, loss_ss: 0.669088, loss_d: 0.059493
0.6934 --- loss: 1.254661, loss_ss: 0.934883, loss_d: 0.319778
0.7319 --- loss: 0.723597, loss_ss: 0.686234, loss_d: 0.037363
0.7704 --- loss: 0.945018, loss_ss: 0.837283, loss_d: 0.107735
0.8089 --- loss: 0.952956, loss_ss: 0.946262, loss_d: 0.006694
0.8475 --- loss: 1.185612, loss_ss: 0.739915, loss_d: 0.445698
0.8860 --- loss: 1.251338, loss_ss: 1.119337, loss_d: 0.132001
0.9245 --- loss: 0.833639, loss_ss: 0.655243, loss_d: 0.178396
0.9630 --- loss: 0.960090, loss_ss: 0.740685, loss_d: 0.219405
Epoch finished! Loss: 0.9428643982382815
Starting epoch 7/10.
0.0000 --- loss: 1.018614, loss_ss: 0.888951, loss_d: 0.129663
0.0385 --- loss: 1.198453, loss_ss: 0.936826, loss_d: 0.261627
0.0770 --- loss: 0.683220, loss_ss: 0.651034, loss_d: 0.032185
0.1156 --- loss: 0.785076, loss_ss: 0.729265, loss_d: 0.055811
0.1541 --- loss: 0.889312, loss_ss: 0.822699, loss_d: 0.066612
0.1926 --- loss: 0.721438, loss_ss: 0.646624, loss_d: 0.074814
0.2311 --- loss: 0.825603, loss_ss: 0.640109, loss_d: 0.185494
0.2696 --- loss: 1.117355, loss_ss: 0.867137, loss_d: 0.250219
0.3082 --- loss: 0.922404, loss_ss: 0.766860, loss_d: 0.155544
0.3467 --- loss: 0.939388, loss_ss: 0.857498, loss_d: 0.081890
0.3852 --- loss: 0.974275, loss_ss: 0.826373, loss_d: 0.147903
0.4237 --- loss: 0.704898, loss_ss: 0.655150, loss_d: 0.049749
0.4622 --- loss: 0.918317, loss_ss: 0.888456, loss_d: 0.029861
0.5008 --- loss: 0.890166, loss_ss: 0.859104, loss_d: 0.031063
0.5393 --- loss: 0.965017, loss_ss: 0.764826, loss_d: 0.200191
0.5778 --- loss: 1.534609, loss_ss: 0.781715, loss_d: 0.752894
0.6163 --- loss: 0.661571, loss_ss: 0.574345, loss_d: 0.087225
0.6549 --- loss: 0.988645, loss_ss: 0.959657, loss_d: 0.028988
0.6934 --- loss: 0.700073, loss_ss: 0.667473, loss_d: 0.032600
0.7319 --- loss: 0.922253, loss_ss: 0.873383, loss_d: 0.048869
0.7704 --- loss: 0.683722, loss_ss: 0.647799, loss_d: 0.035923
0.8089 --- loss: 0.917104, loss_ss: 0.791674, loss_d: 0.125430
0.8475 --- loss: 0.664490, loss_ss: 0.637195, loss_d: 0.027294
0.8860 --- loss: 0.988013, loss_ss: 0.932127, loss_d: 0.055886
0.9245 --- loss: 1.053539, loss_ss: 0.803835, loss_d: 0.249705
0.9630 --- loss: 0.977221, loss_ss: 0.776694, loss_d: 0.200527
Epoch finished! Loss: 0.8950706591477265
Starting epoch 8/10.
0.0000 --- loss: 0.602399, loss_ss: 0.526825, loss_d: 0.075574
0.0385 --- loss: 0.761155, loss_ss: 0.734789, loss_d: 0.026366
0.0770 --- loss: 0.819360, loss_ss: 0.796672, loss_d: 0.022687
0.1156 --- loss: 0.700210, loss_ss: 0.670878, loss_d: 0.029332
0.1541 --- loss: 1.242885, loss_ss: 1.217822, loss_d: 0.025063
0.1926 --- loss: 0.612413, loss_ss: 0.599919, loss_d: 0.012494
0.2311 --- loss: 0.839790, loss_ss: 0.780383, loss_d: 0.059407
0.2696 --- loss: 0.994972, loss_ss: 0.914366, loss_d: 0.080606
0.3082 --- loss: 0.376857, loss_ss: 0.355003, loss_d: 0.021854
0.3467 --- loss: 1.669612, loss_ss: 0.718817, loss_d: 0.950794
0.3852 --- loss: 1.112182, loss_ss: 1.095248, loss_d: 0.016935
0.4237 --- loss: 0.923113, loss_ss: 0.706627, loss_d: 0.216486
0.4622 --- loss: 0.632422, loss_ss: 0.593457, loss_d: 0.038965
0.5008 --- loss: 0.948386, loss_ss: 0.918107, loss_d: 0.030279
0.5393 --- loss: 0.970863, loss_ss: 0.846164, loss_d: 0.124699
0.5778 --- loss: 1.131807, loss_ss: 0.940284, loss_d: 0.191522
0.6163 --- loss: 0.869216, loss_ss: 0.824109, loss_d: 0.045108
0.6549 --- loss: 0.885949, loss_ss: 0.670948, loss_d: 0.215001
0.6934 --- loss: 1.050914, loss_ss: 0.827747, loss_d: 0.223167
0.7319 --- loss: 0.622611, loss_ss: 0.590147, loss_d: 0.032464
0.7704 --- loss: 0.745152, loss_ss: 0.567973, loss_d: 0.177179
0.8089 --- loss: 0.982633, loss_ss: 0.655990, loss_d: 0.326643
0.8475 --- loss: 0.678663, loss_ss: 0.653024, loss_d: 0.025639
0.8860 --- loss: 0.846001, loss_ss: 0.821214, loss_d: 0.024787
0.9245 --- loss: 0.709866, loss_ss: 0.703205, loss_d: 0.006661
0.9630 --- loss: 1.013534, loss_ss: 0.967835, loss_d: 0.045699
Epoch finished! Loss: 0.881630945850063
Starting epoch 9/10.
0.0000 --- loss: 0.913593, loss_ss: 0.879270, loss_d: 0.034323
0.0385 --- loss: 0.971800, loss_ss: 0.771554, loss_d: 0.200245
0.0770 --- loss: 0.895328, loss_ss: 0.888434, loss_d: 0.006895
0.1156 --- loss: 0.906672, loss_ss: 0.702726, loss_d: 0.203946
0.1541 --- loss: 0.627308, loss_ss: 0.608805, loss_d: 0.018503
0.1926 --- loss: 1.016127, loss_ss: 0.814153, loss_d: 0.201974
0.2311 --- loss: 0.620922, loss_ss: 0.588340, loss_d: 0.032582
0.2696 --- loss: 0.907786, loss_ss: 0.813484, loss_d: 0.094303
0.3082 --- loss: 1.430079, loss_ss: 0.762888, loss_d: 0.667190
0.3467 --- loss: 0.816628, loss_ss: 0.698158, loss_d: 0.118470
0.3852 --- loss: 0.755746, loss_ss: 0.640513, loss_d: 0.115234
0.4237 --- loss: 1.064677, loss_ss: 0.674704, loss_d: 0.389973
0.4622 --- loss: 0.511916, loss_ss: 0.498271, loss_d: 0.013645
0.5008 --- loss: 0.965762, loss_ss: 0.804034, loss_d: 0.161729
0.5393 --- loss: 0.896537, loss_ss: 0.885338, loss_d: 0.011199
0.5778 --- loss: 0.888919, loss_ss: 0.839945, loss_d: 0.048974
0.6163 --- loss: 0.674024, loss_ss: 0.668507, loss_d: 0.005516
0.6549 --- loss: 0.780734, loss_ss: 0.758880, loss_d: 0.021854
0.6934 --- loss: 1.080112, loss_ss: 0.936541, loss_d: 0.143571
0.7319 --- loss: 0.967223, loss_ss: 0.556571, loss_d: 0.410651
0.7704 --- loss: 0.661862, loss_ss: 0.640867, loss_d: 0.020994
0.8089 --- loss: 0.852666, loss_ss: 0.824892, loss_d: 0.027774
0.8475 --- loss: 0.841169, loss_ss: 0.748995, loss_d: 0.092174
0.8860 --- loss: 0.984410, loss_ss: 0.774687, loss_d: 0.209723
0.9245 --- loss: 0.886863, loss_ss: 0.833192, loss_d: 0.053672
0.9630 --- loss: 0.742990, loss_ss: 0.653165, loss_d: 0.089826
Epoch finished! Loss: 0.8754101486509831
Starting epoch 10/10.
0.0000 --- loss: 0.969179, loss_ss: 0.578286, loss_d: 0.390893
0.0385 --- loss: 0.843958, loss_ss: 0.767658, loss_d: 0.076300
0.0770 --- loss: 0.682640, loss_ss: 0.528799, loss_d: 0.153842
0.1156 --- loss: 1.112352, loss_ss: 1.018420, loss_d: 0.093933
0.1541 --- loss: 0.637431, loss_ss: 0.555982, loss_d: 0.081448
0.1926 --- loss: 0.942179, loss_ss: 0.925184, loss_d: 0.016995
0.2311 --- loss: 0.836663, loss_ss: 0.717052, loss_d: 0.119611
0.2696 --- loss: 0.699552, loss_ss: 0.628905, loss_d: 0.070647
0.3082 --- loss: 0.602579, loss_ss: 0.593706, loss_d: 0.008873
0.3467 --- loss: 0.777392, loss_ss: 0.741555, loss_d: 0.035837
0.3852 --- loss: 1.341271, loss_ss: 1.122727, loss_d: 0.218544
0.4237 --- loss: 0.744806, loss_ss: 0.737401, loss_d: 0.007406
0.4622 --- loss: 0.711410, loss_ss: 0.686700, loss_d: 0.024710
0.5008 --- loss: 0.898983, loss_ss: 0.870399, loss_d: 0.028584
0.5393 --- loss: 0.843096, loss_ss: 0.773596, loss_d: 0.069499
0.5778 --- loss: 0.765837, loss_ss: 0.741166, loss_d: 0.024671
0.6163 --- loss: 1.157315, loss_ss: 0.626492, loss_d: 0.530822
0.6549 --- loss: 0.667884, loss_ss: 0.635411, loss_d: 0.032473
0.6934 --- loss: 0.842972, loss_ss: 0.830355, loss_d: 0.012616
0.7319 --- loss: 0.763309, loss_ss: 0.562922, loss_d: 0.200387
0.7704 --- loss: 0.941824, loss_ss: 0.702091, loss_d: 0.239733
0.8089 --- loss: 0.857130, loss_ss: 0.849565, loss_d: 0.007564
0.8475 --- loss: 0.599591, loss_ss: 0.594212, loss_d: 0.005379
0.8860 --- loss: 0.746307, loss_ss: 0.713959, loss_d: 0.032348
0.9245 --- loss: 0.685413, loss_ss: 0.570840, loss_d: 0.114573
0.9630 --- loss: 0.955067, loss_ss: 0.662879, loss_d: 0.292188
Epoch finished! Loss: 0.8408748811276263
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8261904761904761
             precision    recall  f1-score   support

        0.0       0.89      0.95      0.92       297
        1.0       0.78      0.56      0.65       289
        2.0       0.75      0.92      0.83       330
        3.0       0.99      0.79      0.88       133
        4.0       0.83      0.91      0.86       211

avg / total       0.83      0.83      0.82      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.11  94.61   96.57  89.49     91.98
1  86.19  55.71   95.26  77.78     64.92
2  90.00  91.82   89.35  75.37     82.79
3  97.70  78.95   99.91  99.06     87.87
4  95.24  90.52   96.19  82.68     86.43
Total accuracy: 82.62%
Average sen: 82.32%
Average spec: 95.46%
Macro f1-score: 82.80%
Diagnosis acc on 15mins: 1.0
[0.99990606 0.9999994  0.99999988 0.99999881 0.99999964 0.99979538
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         0.99999976
 1.         1.         1.         1.         0.9997651  0.99963093
 0.99999857 0.99999881 0.99963164 0.99995279 1.         0.99999583
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         0.99998295 0.99999905]
pred: 0.9999679667609078, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.469794, loss_ss: 1.758414, loss_d: 0.711380
0.0384 --- loss: 2.179290, loss_ss: 1.547312, loss_d: 0.631978
0.0768 --- loss: 1.759620, loss_ss: 1.301448, loss_d: 0.458172
0.1152 --- loss: 2.122100, loss_ss: 1.421351, loss_d: 0.700749
0.1536 --- loss: 1.906083, loss_ss: 1.408228, loss_d: 0.497855
0.1919 --- loss: 2.175975, loss_ss: 1.387708, loss_d: 0.788267
0.2303 --- loss: 1.995673, loss_ss: 1.501243, loss_d: 0.494430
0.2687 --- loss: 2.205087, loss_ss: 1.388730, loss_d: 0.816357
0.3071 --- loss: 1.916738, loss_ss: 1.302463, loss_d: 0.614276
0.3455 --- loss: 1.948213, loss_ss: 1.490690, loss_d: 0.457523
0.3839 --- loss: 1.772922, loss_ss: 1.232243, loss_d: 0.540680
0.4223 --- loss: 1.993748, loss_ss: 1.476404, loss_d: 0.517345
0.4607 --- loss: 1.802831, loss_ss: 1.351125, loss_d: 0.451706
0.4990 --- loss: 1.646812, loss_ss: 1.209548, loss_d: 0.437264
0.5374 --- loss: 1.761921, loss_ss: 1.286331, loss_d: 0.475590
0.5758 --- loss: 2.132397, loss_ss: 1.317914, loss_d: 0.814483
0.6142 --- loss: 1.573653, loss_ss: 1.219944, loss_d: 0.353710
0.6526 --- loss: 1.622771, loss_ss: 1.176563, loss_d: 0.446208
0.6910 --- loss: 1.560116, loss_ss: 1.111570, loss_d: 0.448546
0.7294 --- loss: 1.762964, loss_ss: 1.228710, loss_d: 0.534254
0.7678 --- loss: 2.012120, loss_ss: 1.329494, loss_d: 0.682626
0.8061 --- loss: 1.781280, loss_ss: 1.323206, loss_d: 0.458074
0.8445 --- loss: 1.941717, loss_ss: 1.080868, loss_d: 0.860849
0.8829 --- loss: 1.763514, loss_ss: 1.392096, loss_d: 0.371418
0.9213 --- loss: 1.653114, loss_ss: 1.317500, loss_d: 0.335614
0.9597 --- loss: 1.634945, loss_ss: 1.321509, loss_d: 0.313437
0.9981 --- loss: 1.645829, loss_ss: 1.329208, loss_d: 0.316621
Epoch finished! Loss: 1.8194393625626197
Starting epoch 2/10.
0.0000 --- loss: 1.653347, loss_ss: 1.280555, loss_d: 0.372792
0.0384 --- loss: 1.753583, loss_ss: 1.179659, loss_d: 0.573924
0.0768 --- loss: 1.460845, loss_ss: 1.163122, loss_d: 0.297723
0.1152 --- loss: 1.617899, loss_ss: 1.048729, loss_d: 0.569170
0.1536 --- loss: 1.240964, loss_ss: 0.965286, loss_d: 0.275678
0.1919 --- loss: 1.594471, loss_ss: 0.938293, loss_d: 0.656178
0.2303 --- loss: 1.558518, loss_ss: 1.175767, loss_d: 0.382751
0.2687 --- loss: 1.244110, loss_ss: 1.004282, loss_d: 0.239828
0.3071 --- loss: 1.713978, loss_ss: 1.359107, loss_d: 0.354870
0.3455 --- loss: 1.370313, loss_ss: 1.115992, loss_d: 0.254321
0.3839 --- loss: 1.583123, loss_ss: 1.246448, loss_d: 0.336675
0.4223 --- loss: 1.398046, loss_ss: 1.035267, loss_d: 0.362780
0.4607 --- loss: 1.216662, loss_ss: 0.997289, loss_d: 0.219372
0.4990 --- loss: 1.688417, loss_ss: 1.161030, loss_d: 0.527387
0.5374 --- loss: 1.207001, loss_ss: 0.984025, loss_d: 0.222976
0.5758 --- loss: 1.267429, loss_ss: 0.785936, loss_d: 0.481493
0.6142 --- loss: 0.898809, loss_ss: 0.827613, loss_d: 0.071196
0.6526 --- loss: 1.058502, loss_ss: 0.970501, loss_d: 0.088001
0.6910 --- loss: 1.302869, loss_ss: 1.044331, loss_d: 0.258538
0.7294 --- loss: 1.261202, loss_ss: 0.915566, loss_d: 0.345636
0.7678 --- loss: 1.074021, loss_ss: 0.694401, loss_d: 0.379620
0.8061 --- loss: 1.159361, loss_ss: 0.820562, loss_d: 0.338800
0.8445 --- loss: 1.197522, loss_ss: 1.001357, loss_d: 0.196165
0.8829 --- loss: 1.300992, loss_ss: 0.794441, loss_d: 0.506552
0.9213 --- loss: 1.305412, loss_ss: 1.064109, loss_d: 0.241303
0.9597 --- loss: 1.076514, loss_ss: 0.837816, loss_d: 0.238697
0.9981 --- loss: 1.445946, loss_ss: 1.382259, loss_d: 0.063687
Epoch finished! Loss: 1.3597382488159033
Starting epoch 3/10.
0.0000 --- loss: 1.014848, loss_ss: 0.920593, loss_d: 0.094255
0.0384 --- loss: 0.933706, loss_ss: 0.797738, loss_d: 0.135968
0.0768 --- loss: 1.414823, loss_ss: 1.138843, loss_d: 0.275979
0.1152 --- loss: 1.020699, loss_ss: 0.869310, loss_d: 0.151388
0.1536 --- loss: 1.987126, loss_ss: 1.010566, loss_d: 0.976560
0.1919 --- loss: 0.941430, loss_ss: 0.784217, loss_d: 0.157213
0.2303 --- loss: 1.022418, loss_ss: 0.884696, loss_d: 0.137723
0.2687 --- loss: 0.941418, loss_ss: 0.738840, loss_d: 0.202578
0.3071 --- loss: 1.912461, loss_ss: 0.753803, loss_d: 1.158658
0.3455 --- loss: 1.119917, loss_ss: 0.843699, loss_d: 0.276218
0.3839 --- loss: 0.988484, loss_ss: 0.779252, loss_d: 0.209231
0.4223 --- loss: 1.152873, loss_ss: 0.706520, loss_d: 0.446353
0.4607 --- loss: 1.432715, loss_ss: 0.875853, loss_d: 0.556862
0.4990 --- loss: 1.164328, loss_ss: 0.839975, loss_d: 0.324353
0.5374 --- loss: 1.285609, loss_ss: 1.083033, loss_d: 0.202576
0.5758 --- loss: 0.831919, loss_ss: 0.782055, loss_d: 0.049865
0.6142 --- loss: 0.904842, loss_ss: 0.692221, loss_d: 0.212621
0.6526 --- loss: 1.462611, loss_ss: 1.301054, loss_d: 0.161557
0.6910 --- loss: 1.127978, loss_ss: 0.802097, loss_d: 0.325881
0.7294 --- loss: 0.664177, loss_ss: 0.575047, loss_d: 0.089130
0.7678 --- loss: 2.141237, loss_ss: 0.849099, loss_d: 1.292138
0.8061 --- loss: 1.180326, loss_ss: 0.788909, loss_d: 0.391417
0.8445 --- loss: 1.330513, loss_ss: 0.920795, loss_d: 0.409718
0.8829 --- loss: 0.998890, loss_ss: 0.897202, loss_d: 0.101689
0.9213 --- loss: 1.127721, loss_ss: 0.966183, loss_d: 0.161539
0.9597 --- loss: 1.039744, loss_ss: 0.956818, loss_d: 0.082927
0.9981 --- loss: 1.586975, loss_ss: 0.605013, loss_d: 0.981962
Epoch finished! Loss: 1.1470796763896942
Starting epoch 4/10.
0.0000 --- loss: 0.691317, loss_ss: 0.609766, loss_d: 0.081551
0.0384 --- loss: 0.891900, loss_ss: 0.667362, loss_d: 0.224538
0.0768 --- loss: 0.940527, loss_ss: 0.819219, loss_d: 0.121309
0.1152 --- loss: 1.366560, loss_ss: 0.920145, loss_d: 0.446415
0.1536 --- loss: 0.841417, loss_ss: 0.754613, loss_d: 0.086804
0.1919 --- loss: 1.132931, loss_ss: 0.958324, loss_d: 0.174607
0.2303 --- loss: 0.789777, loss_ss: 0.667242, loss_d: 0.122535
0.2687 --- loss: 1.154998, loss_ss: 0.785786, loss_d: 0.369212
0.3071 --- loss: 1.201703, loss_ss: 1.078257, loss_d: 0.123446
0.3455 --- loss: 1.172342, loss_ss: 1.040320, loss_d: 0.132022
0.3839 --- loss: 1.483488, loss_ss: 1.095683, loss_d: 0.387805
0.4223 --- loss: 1.070734, loss_ss: 0.631538, loss_d: 0.439196
0.4607 --- loss: 0.919351, loss_ss: 0.837783, loss_d: 0.081568
0.4990 --- loss: 1.192461, loss_ss: 0.609584, loss_d: 0.582877
0.5374 --- loss: 1.040886, loss_ss: 0.825324, loss_d: 0.215562
0.5758 --- loss: 0.801854, loss_ss: 0.686711, loss_d: 0.115143
0.6142 --- loss: 1.666280, loss_ss: 1.027519, loss_d: 0.638760
0.6526 --- loss: 1.322223, loss_ss: 0.988733, loss_d: 0.333491
0.6910 --- loss: 1.172705, loss_ss: 0.797246, loss_d: 0.375459
0.7294 --- loss: 1.407949, loss_ss: 0.904433, loss_d: 0.503516
0.7678 --- loss: 0.727905, loss_ss: 0.590137, loss_d: 0.137768
0.8061 --- loss: 1.477199, loss_ss: 0.825967, loss_d: 0.651233
0.8445 --- loss: 1.042920, loss_ss: 0.842673, loss_d: 0.200247
0.8829 --- loss: 1.074108, loss_ss: 1.021966, loss_d: 0.052142
0.9213 --- loss: 0.927157, loss_ss: 0.868515, loss_d: 0.058641
0.9597 --- loss: 0.818227, loss_ss: 0.767947, loss_d: 0.050280
0.9981 --- loss: 0.838211, loss_ss: 0.811915, loss_d: 0.026296
Epoch finished! Loss: 1.0429136459644024
Starting epoch 5/10.
0.0000 --- loss: 1.113332, loss_ss: 0.825975, loss_d: 0.287357
0.0384 --- loss: 0.690929, loss_ss: 0.637040, loss_d: 0.053889
0.0768 --- loss: 0.781039, loss_ss: 0.684791, loss_d: 0.096247
0.1152 --- loss: 0.850144, loss_ss: 0.746080, loss_d: 0.104064
0.1536 --- loss: 0.830995, loss_ss: 0.719798, loss_d: 0.111197
0.1919 --- loss: 1.388602, loss_ss: 0.832780, loss_d: 0.555822
0.2303 --- loss: 0.596997, loss_ss: 0.555974, loss_d: 0.041023
0.2687 --- loss: 0.626830, loss_ss: 0.598289, loss_d: 0.028541
0.3071 --- loss: 0.866190, loss_ss: 0.693379, loss_d: 0.172811
0.3455 --- loss: 1.250346, loss_ss: 1.233560, loss_d: 0.016786
0.3839 --- loss: 1.219528, loss_ss: 1.054531, loss_d: 0.164998
0.4223 --- loss: 1.010081, loss_ss: 0.855152, loss_d: 0.154929
0.4607 --- loss: 0.957967, loss_ss: 0.882874, loss_d: 0.075093
0.4990 --- loss: 0.890607, loss_ss: 0.788271, loss_d: 0.102335
0.5374 --- loss: 0.824807, loss_ss: 0.620875, loss_d: 0.203932
0.5758 --- loss: 0.743394, loss_ss: 0.613701, loss_d: 0.129692
0.6142 --- loss: 1.525392, loss_ss: 1.376577, loss_d: 0.148815
0.6526 --- loss: 1.062565, loss_ss: 0.770535, loss_d: 0.292030
0.6910 --- loss: 1.344129, loss_ss: 1.182215, loss_d: 0.161914
0.7294 --- loss: 1.084535, loss_ss: 0.944874, loss_d: 0.139661
0.7678 --- loss: 0.874446, loss_ss: 0.743085, loss_d: 0.131361
0.8061 --- loss: 0.922416, loss_ss: 0.886895, loss_d: 0.035520
0.8445 --- loss: 1.242478, loss_ss: 0.817366, loss_d: 0.425113
0.8829 --- loss: 1.459708, loss_ss: 0.697130, loss_d: 0.762578
0.9213 --- loss: 0.663330, loss_ss: 0.606363, loss_d: 0.056967
0.9597 --- loss: 0.711604, loss_ss: 0.618262, loss_d: 0.093342
0.9981 --- loss: 0.450738, loss_ss: 0.414035, loss_d: 0.036703
Epoch finished! Loss: 0.9855485551632368
Starting epoch 6/10.
0.0000 --- loss: 0.677830, loss_ss: 0.635779, loss_d: 0.042051
0.0384 --- loss: 0.966181, loss_ss: 0.939438, loss_d: 0.026743
0.0768 --- loss: 0.973991, loss_ss: 0.625198, loss_d: 0.348792
0.1152 --- loss: 0.853888, loss_ss: 0.831169, loss_d: 0.022719
0.1536 --- loss: 0.692759, loss_ss: 0.603046, loss_d: 0.089713
0.1919 --- loss: 0.724142, loss_ss: 0.710346, loss_d: 0.013796
0.2303 --- loss: 0.708133, loss_ss: 0.702267, loss_d: 0.005865
0.2687 --- loss: 0.869185, loss_ss: 0.855711, loss_d: 0.013473
0.3071 --- loss: 0.727207, loss_ss: 0.660345, loss_d: 0.066862
0.3455 --- loss: 0.631118, loss_ss: 0.521568, loss_d: 0.109550
0.3839 --- loss: 1.100830, loss_ss: 1.003131, loss_d: 0.097699
0.4223 --- loss: 1.066154, loss_ss: 0.996442, loss_d: 0.069711
0.4607 --- loss: 0.989646, loss_ss: 0.918739, loss_d: 0.070907
0.4990 --- loss: 0.800971, loss_ss: 0.749170, loss_d: 0.051802
0.5374 --- loss: 1.091479, loss_ss: 0.712931, loss_d: 0.378548
0.5758 --- loss: 0.966653, loss_ss: 0.891210, loss_d: 0.075443
0.6142 --- loss: 0.945778, loss_ss: 0.741318, loss_d: 0.204460
0.6526 --- loss: 1.020562, loss_ss: 0.867477, loss_d: 0.153085
0.6910 --- loss: 1.126470, loss_ss: 0.714810, loss_d: 0.411661
0.7294 --- loss: 0.616442, loss_ss: 0.598207, loss_d: 0.018236
0.7678 --- loss: 1.243761, loss_ss: 0.743862, loss_d: 0.499898
0.8061 --- loss: 0.804202, loss_ss: 0.699698, loss_d: 0.104504
0.8445 --- loss: 1.127526, loss_ss: 1.049562, loss_d: 0.077964
0.8829 --- loss: 0.784475, loss_ss: 0.612357, loss_d: 0.172118
0.9213 --- loss: 0.942108, loss_ss: 0.855904, loss_d: 0.086204
0.9597 --- loss: 1.109961, loss_ss: 1.048061, loss_d: 0.061900
0.9981 --- loss: 0.982373, loss_ss: 0.724431, loss_d: 0.257942
Epoch finished! Loss: 0.9248702695736518
Starting epoch 7/10.
0.0000 --- loss: 0.723641, loss_ss: 0.704265, loss_d: 0.019376
0.0384 --- loss: 0.964160, loss_ss: 0.794997, loss_d: 0.169163
0.0768 --- loss: 0.656389, loss_ss: 0.622800, loss_d: 0.033588
0.1152 --- loss: 0.808425, loss_ss: 0.757990, loss_d: 0.050436
0.1536 --- loss: 1.245012, loss_ss: 1.154573, loss_d: 0.090439
0.1919 --- loss: 0.929033, loss_ss: 0.903843, loss_d: 0.025190
0.2303 --- loss: 0.947400, loss_ss: 0.852020, loss_d: 0.095381
0.2687 --- loss: 0.760040, loss_ss: 0.735680, loss_d: 0.024361
0.3071 --- loss: 1.048625, loss_ss: 1.040610, loss_d: 0.008016
0.3455 --- loss: 0.994656, loss_ss: 0.986713, loss_d: 0.007943
0.3839 --- loss: 0.910831, loss_ss: 0.797142, loss_d: 0.113689
0.4223 --- loss: 0.634831, loss_ss: 0.606816, loss_d: 0.028015
0.4607 --- loss: 1.209934, loss_ss: 0.883604, loss_d: 0.326331
0.4990 --- loss: 1.028892, loss_ss: 0.926261, loss_d: 0.102631
0.5374 --- loss: 0.655497, loss_ss: 0.634457, loss_d: 0.021040
0.5758 --- loss: 1.145083, loss_ss: 0.848215, loss_d: 0.296868
0.6142 --- loss: 0.787003, loss_ss: 0.579423, loss_d: 0.207580
0.6526 --- loss: 1.160529, loss_ss: 1.123696, loss_d: 0.036833
0.6910 --- loss: 0.898901, loss_ss: 0.736392, loss_d: 0.162509
0.7294 --- loss: 0.761605, loss_ss: 0.676880, loss_d: 0.084725
0.7678 --- loss: 1.488892, loss_ss: 1.371655, loss_d: 0.117237
0.8061 --- loss: 0.825882, loss_ss: 0.803460, loss_d: 0.022423
0.8445 --- loss: 1.024252, loss_ss: 0.983545, loss_d: 0.040707
0.8829 --- loss: 0.910668, loss_ss: 0.687824, loss_d: 0.222845
0.9213 --- loss: 0.906296, loss_ss: 0.862496, loss_d: 0.043800
0.9597 --- loss: 0.750454, loss_ss: 0.598611, loss_d: 0.151843
0.9981 --- loss: 0.886236, loss_ss: 0.661659, loss_d: 0.224577
Epoch finished! Loss: 0.8814766462032612
Starting epoch 8/10.
0.0000 --- loss: 0.724621, loss_ss: 0.714142, loss_d: 0.010479
0.0384 --- loss: 0.696355, loss_ss: 0.578374, loss_d: 0.117981
0.0768 --- loss: 0.772371, loss_ss: 0.720042, loss_d: 0.052329
0.1152 --- loss: 0.828560, loss_ss: 0.652691, loss_d: 0.175869
0.1536 --- loss: 0.633724, loss_ss: 0.624084, loss_d: 0.009640
0.1919 --- loss: 0.758110, loss_ss: 0.591783, loss_d: 0.166327
0.2303 --- loss: 0.840447, loss_ss: 0.703614, loss_d: 0.136834
0.2687 --- loss: 0.794618, loss_ss: 0.628272, loss_d: 0.166346
0.3071 --- loss: 0.597460, loss_ss: 0.557698, loss_d: 0.039762
0.3455 --- loss: 0.961722, loss_ss: 0.717267, loss_d: 0.244455
0.3839 --- loss: 1.094774, loss_ss: 1.059899, loss_d: 0.034875
0.4223 --- loss: 0.997278, loss_ss: 0.894000, loss_d: 0.103278
0.4607 --- loss: 0.811005, loss_ss: 0.649951, loss_d: 0.161054
0.4990 --- loss: 0.819235, loss_ss: 0.616520, loss_d: 0.202715
0.5374 --- loss: 0.946380, loss_ss: 0.877143, loss_d: 0.069237
0.5758 --- loss: 0.736492, loss_ss: 0.651408, loss_d: 0.085084
0.6142 --- loss: 0.797508, loss_ss: 0.699837, loss_d: 0.097671
0.6526 --- loss: 0.778438, loss_ss: 0.756233, loss_d: 0.022205
0.6910 --- loss: 0.822974, loss_ss: 0.603587, loss_d: 0.219387
0.7294 --- loss: 0.659269, loss_ss: 0.651586, loss_d: 0.007683
0.7678 --- loss: 1.115433, loss_ss: 1.090231, loss_d: 0.025203
0.8061 --- loss: 0.665099, loss_ss: 0.609913, loss_d: 0.055186
0.8445 --- loss: 0.578728, loss_ss: 0.569874, loss_d: 0.008854
0.8829 --- loss: 1.001142, loss_ss: 0.990468, loss_d: 0.010674
0.9213 --- loss: 0.827454, loss_ss: 0.796764, loss_d: 0.030690
0.9597 --- loss: 0.797524, loss_ss: 0.549394, loss_d: 0.248130
0.9981 --- loss: 1.915726, loss_ss: 0.729641, loss_d: 1.186085
Epoch finished! Loss: 0.8736888573719905
Starting epoch 9/10.
0.0000 --- loss: 0.966686, loss_ss: 0.856667, loss_d: 0.110019
0.0384 --- loss: 0.578854, loss_ss: 0.574113, loss_d: 0.004741
0.0768 --- loss: 0.549938, loss_ss: 0.494818, loss_d: 0.055120
0.1152 --- loss: 1.047416, loss_ss: 1.020830, loss_d: 0.026587
0.1536 --- loss: 0.908523, loss_ss: 0.736616, loss_d: 0.171906
0.1919 --- loss: 0.945611, loss_ss: 0.937595, loss_d: 0.008016
0.2303 --- loss: 0.750950, loss_ss: 0.640973, loss_d: 0.109977
0.2687 --- loss: 0.753928, loss_ss: 0.691730, loss_d: 0.062197
0.3071 --- loss: 1.045326, loss_ss: 0.987136, loss_d: 0.058189
0.3455 --- loss: 0.858189, loss_ss: 0.843819, loss_d: 0.014370
0.3839 --- loss: 0.776440, loss_ss: 0.747382, loss_d: 0.029058
0.4223 --- loss: 0.801098, loss_ss: 0.745593, loss_d: 0.055505
0.4607 --- loss: 0.553862, loss_ss: 0.548254, loss_d: 0.005608
0.4990 --- loss: 1.005682, loss_ss: 0.995584, loss_d: 0.010097
0.5374 --- loss: 1.119359, loss_ss: 0.518331, loss_d: 0.601028
0.5758 --- loss: 1.123407, loss_ss: 0.604094, loss_d: 0.519313
0.6142 --- loss: 0.671691, loss_ss: 0.525998, loss_d: 0.145693
0.6526 --- loss: 1.002181, loss_ss: 0.975979, loss_d: 0.026202
0.6910 --- loss: 0.931835, loss_ss: 0.913843, loss_d: 0.017992
0.7294 --- loss: 1.063659, loss_ss: 0.984250, loss_d: 0.079409
0.7678 --- loss: 0.638384, loss_ss: 0.618792, loss_d: 0.019592
0.8061 --- loss: 0.583108, loss_ss: 0.579256, loss_d: 0.003851
0.8445 --- loss: 0.744479, loss_ss: 0.715423, loss_d: 0.029056
0.8829 --- loss: 0.746136, loss_ss: 0.658896, loss_d: 0.087240
0.9213 --- loss: 0.735930, loss_ss: 0.725710, loss_d: 0.010221
0.9597 --- loss: 0.717334, loss_ss: 0.663196, loss_d: 0.054138
0.9981 --- loss: 0.627610, loss_ss: 0.619662, loss_d: 0.007948
Epoch finished! Loss: 0.8140158234880521
Starting epoch 10/10.
0.0000 --- loss: 0.987010, loss_ss: 0.827242, loss_d: 0.159768
0.0384 --- loss: 0.568979, loss_ss: 0.566432, loss_d: 0.002547
0.0768 --- loss: 0.741270, loss_ss: 0.676984, loss_d: 0.064287
0.1152 --- loss: 0.821712, loss_ss: 0.691421, loss_d: 0.130291
0.1536 --- loss: 0.701508, loss_ss: 0.696100, loss_d: 0.005408
0.1919 --- loss: 0.622121, loss_ss: 0.617192, loss_d: 0.004930
0.2303 --- loss: 0.498974, loss_ss: 0.452845, loss_d: 0.046130
0.2687 --- loss: 0.592290, loss_ss: 0.580496, loss_d: 0.011794
0.3071 --- loss: 0.884986, loss_ss: 0.816083, loss_d: 0.068903
0.3455 --- loss: 0.777009, loss_ss: 0.743483, loss_d: 0.033526
0.3839 --- loss: 0.893277, loss_ss: 0.887250, loss_d: 0.006027
0.4223 --- loss: 0.969776, loss_ss: 0.961326, loss_d: 0.008449
0.4607 --- loss: 0.826857, loss_ss: 0.823882, loss_d: 0.002975
0.4990 --- loss: 0.894589, loss_ss: 0.857916, loss_d: 0.036673
0.5374 --- loss: 0.728216, loss_ss: 0.688631, loss_d: 0.039585
0.5758 --- loss: 0.780623, loss_ss: 0.770306, loss_d: 0.010317
0.6142 --- loss: 0.523919, loss_ss: 0.486754, loss_d: 0.037165
0.6526 --- loss: 0.593979, loss_ss: 0.526130, loss_d: 0.067849
0.6910 --- loss: 0.535440, loss_ss: 0.518176, loss_d: 0.017264
0.7294 --- loss: 0.895139, loss_ss: 0.871865, loss_d: 0.023273
0.7678 --- loss: 0.875792, loss_ss: 0.694321, loss_d: 0.181472
0.8061 --- loss: 0.707741, loss_ss: 0.655727, loss_d: 0.052015
0.8445 --- loss: 0.877737, loss_ss: 0.871885, loss_d: 0.005852
0.8829 --- loss: 0.947546, loss_ss: 0.931512, loss_d: 0.016034
0.9213 --- loss: 0.678027, loss_ss: 0.673046, loss_d: 0.004981
0.9597 --- loss: 0.850211, loss_ss: 0.759257, loss_d: 0.090954
0.9981 --- loss: 0.913344, loss_ss: 0.901066, loss_d: 0.012278
Epoch finished! Loss: 0.8065092924695748
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5616161616161616
             precision    recall  f1-score   support

        0.0       0.55      0.96      0.70       237
        1.0       0.48      0.23      0.31       249
        2.0       0.45      0.61      0.52       210
        3.0       0.98      0.49      0.66       245
        4.0       0.41      0.41      0.41        49

avg / total       0.61      0.56      0.54       990
 


====== chp017-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.61  96.20   75.70  55.47     70.37
1  74.34  23.29   91.50  47.93     31.35
2  75.96  61.43   79.87  45.10     52.02
3  87.27  49.39   99.73  98.37     65.76
4  94.14  40.82   96.92  40.82     40.82
Total accuracy: 56.16%
Average sen: 54.23%
Average spec: 88.74%
Macro f1-score: 52.06%
Diagnosis acc on 15mins: 1.0
[0.91174316 0.96738786 0.92293298 0.99938607 0.97828281 0.90648973
 0.54734367 0.9481613  0.97508186 0.99257469 0.98882151 0.99734575
 0.99288321 0.96701753 0.96194303 0.99999988 0.99999893 1.
 0.99293435 0.96832377 0.98517597 0.9630776  0.97596383 0.93159181
 0.99318063 0.99020737 0.99966812 0.98439711 0.78786093 0.98639005
 0.85448235 0.99381775 0.99581921]
pred: 0.9533419645193851, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.371533, loss_ss: 1.671309, loss_d: 0.700224
0.0384 --- loss: 1.964585, loss_ss: 1.634302, loss_d: 0.330284
0.0769 --- loss: 1.992205, loss_ss: 1.487526, loss_d: 0.504679
0.1153 --- loss: 2.149613, loss_ss: 1.516480, loss_d: 0.633132
0.1538 --- loss: 2.183030, loss_ss: 1.541979, loss_d: 0.641050
0.1922 --- loss: 2.151768, loss_ss: 1.458188, loss_d: 0.693580
0.2307 --- loss: 1.993947, loss_ss: 1.490532, loss_d: 0.503415
0.2691 --- loss: 2.034479, loss_ss: 1.423469, loss_d: 0.611010
0.3076 --- loss: 2.128258, loss_ss: 1.394899, loss_d: 0.733360
0.3460 --- loss: 1.753058, loss_ss: 1.312019, loss_d: 0.441039
0.3845 --- loss: 1.998755, loss_ss: 1.437778, loss_d: 0.560978
0.4229 --- loss: 1.886177, loss_ss: 1.246629, loss_d: 0.639547
0.4614 --- loss: 1.897068, loss_ss: 1.375183, loss_d: 0.521885
0.4998 --- loss: 1.658118, loss_ss: 1.245416, loss_d: 0.412702
0.5383 --- loss: 1.615568, loss_ss: 1.287360, loss_d: 0.328208
0.5767 --- loss: 1.680169, loss_ss: 1.242949, loss_d: 0.437221
0.6151 --- loss: 1.544282, loss_ss: 1.228852, loss_d: 0.315430
0.6536 --- loss: 1.561438, loss_ss: 1.260549, loss_d: 0.300888
0.6920 --- loss: 1.407083, loss_ss: 1.043074, loss_d: 0.364009
0.7305 --- loss: 1.385210, loss_ss: 1.097636, loss_d: 0.287574
0.7689 --- loss: 1.346831, loss_ss: 1.106102, loss_d: 0.240729
0.8074 --- loss: 1.536241, loss_ss: 1.184120, loss_d: 0.352121
0.8458 --- loss: 1.534542, loss_ss: 1.030041, loss_d: 0.504501
0.8843 --- loss: 1.477225, loss_ss: 1.152287, loss_d: 0.324938
0.9227 --- loss: 1.948791, loss_ss: 1.195492, loss_d: 0.753300
0.9612 --- loss: 1.512817, loss_ss: 1.070569, loss_d: 0.442249
0.9996 --- loss: 1.285098, loss_ss: 1.194561, loss_d: 0.090537
Epoch finished! Loss: 1.833843227991691
Starting epoch 2/10.
0.0000 --- loss: 1.378449, loss_ss: 1.091332, loss_d: 0.287116
0.0384 --- loss: 1.518353, loss_ss: 1.197691, loss_d: 0.320662
0.0769 --- loss: 1.581589, loss_ss: 1.142051, loss_d: 0.439539
0.1153 --- loss: 1.338311, loss_ss: 0.974506, loss_d: 0.363805
0.1538 --- loss: 1.454937, loss_ss: 1.048645, loss_d: 0.406291
0.1922 --- loss: 1.532787, loss_ss: 1.279960, loss_d: 0.252827
0.2307 --- loss: 1.581319, loss_ss: 1.104527, loss_d: 0.476792
0.2691 --- loss: 1.404134, loss_ss: 1.190422, loss_d: 0.213712
0.3076 --- loss: 1.599190, loss_ss: 1.018483, loss_d: 0.580707
0.3460 --- loss: 1.808161, loss_ss: 1.263147, loss_d: 0.545014
0.3845 --- loss: 1.698411, loss_ss: 1.241912, loss_d: 0.456499
0.4229 --- loss: 1.515871, loss_ss: 1.109406, loss_d: 0.406465
0.4614 --- loss: 1.160996, loss_ss: 0.892513, loss_d: 0.268483
0.4998 --- loss: 1.116987, loss_ss: 1.021806, loss_d: 0.095181
0.5383 --- loss: 1.615950, loss_ss: 1.205282, loss_d: 0.410668
0.5767 --- loss: 1.271247, loss_ss: 1.005318, loss_d: 0.265929
0.6151 --- loss: 1.215752, loss_ss: 0.959947, loss_d: 0.255805
0.6536 --- loss: 1.713963, loss_ss: 0.769711, loss_d: 0.944252
0.6920 --- loss: 1.289726, loss_ss: 0.916026, loss_d: 0.373699
0.7305 --- loss: 1.026188, loss_ss: 0.790533, loss_d: 0.235656
0.7689 --- loss: 1.256821, loss_ss: 0.912485, loss_d: 0.344336
0.8074 --- loss: 1.119408, loss_ss: 0.931628, loss_d: 0.187780
0.8458 --- loss: 1.243541, loss_ss: 0.899201, loss_d: 0.344339
0.8843 --- loss: 1.290622, loss_ss: 0.868340, loss_d: 0.422283
0.9227 --- loss: 1.344690, loss_ss: 0.851353, loss_d: 0.493337
0.9612 --- loss: 1.214315, loss_ss: 0.988182, loss_d: 0.226133
0.9996 --- loss: 2.075874, loss_ss: 1.972694, loss_d: 0.103180
Epoch finished! Loss: 1.338463540489857
Starting epoch 3/10.
0.0000 --- loss: 1.640333, loss_ss: 1.263966, loss_d: 0.376366
0.0384 --- loss: 1.441881, loss_ss: 0.946734, loss_d: 0.495147
0.0769 --- loss: 1.048292, loss_ss: 0.807136, loss_d: 0.241156
0.1153 --- loss: 0.836832, loss_ss: 0.742362, loss_d: 0.094470
0.1538 --- loss: 1.163882, loss_ss: 0.873806, loss_d: 0.290075
0.1922 --- loss: 1.639860, loss_ss: 1.331416, loss_d: 0.308444
0.2307 --- loss: 1.105961, loss_ss: 0.870947, loss_d: 0.235014
0.2691 --- loss: 1.252398, loss_ss: 1.154326, loss_d: 0.098072
0.3076 --- loss: 1.136773, loss_ss: 0.689853, loss_d: 0.446919
0.3460 --- loss: 1.829414, loss_ss: 1.095565, loss_d: 0.733849
0.3845 --- loss: 1.441940, loss_ss: 0.959820, loss_d: 0.482120
0.4229 --- loss: 1.065340, loss_ss: 0.840887, loss_d: 0.224453
0.4614 --- loss: 1.046854, loss_ss: 0.849907, loss_d: 0.196947
0.4998 --- loss: 1.224705, loss_ss: 1.137276, loss_d: 0.087429
0.5383 --- loss: 1.151628, loss_ss: 0.864062, loss_d: 0.287566
0.5767 --- loss: 1.106894, loss_ss: 0.983791, loss_d: 0.123102
0.6151 --- loss: 1.003910, loss_ss: 0.772893, loss_d: 0.231016
0.6536 --- loss: 1.183064, loss_ss: 0.822600, loss_d: 0.360464
0.6920 --- loss: 1.442074, loss_ss: 0.822879, loss_d: 0.619195
0.7305 --- loss: 1.328817, loss_ss: 1.098938, loss_d: 0.229878
0.7689 --- loss: 1.113398, loss_ss: 1.067426, loss_d: 0.045971
0.8074 --- loss: 0.716657, loss_ss: 0.645274, loss_d: 0.071383
0.8458 --- loss: 0.986050, loss_ss: 0.888792, loss_d: 0.097258
0.8843 --- loss: 1.548089, loss_ss: 0.964276, loss_d: 0.583813
0.9227 --- loss: 0.900044, loss_ss: 0.825801, loss_d: 0.074243
0.9612 --- loss: 1.360880, loss_ss: 1.272280, loss_d: 0.088601
0.9996 --- loss: 0.997815, loss_ss: 0.971076, loss_d: 0.026739
Epoch finished! Loss: 1.1753322220765627
Starting epoch 4/10.
0.0000 --- loss: 1.080991, loss_ss: 0.919009, loss_d: 0.161981
0.0384 --- loss: 1.116016, loss_ss: 1.019086, loss_d: 0.096931
0.0769 --- loss: 1.231438, loss_ss: 1.000071, loss_d: 0.231367
0.1153 --- loss: 1.213869, loss_ss: 0.901177, loss_d: 0.312692
0.1538 --- loss: 1.236787, loss_ss: 0.754536, loss_d: 0.482251
0.1922 --- loss: 1.248014, loss_ss: 1.055991, loss_d: 0.192022
0.2307 --- loss: 0.997178, loss_ss: 0.897836, loss_d: 0.099342
0.2691 --- loss: 1.151078, loss_ss: 0.951936, loss_d: 0.199142
0.3076 --- loss: 1.035481, loss_ss: 0.724428, loss_d: 0.311053
0.3460 --- loss: 0.860188, loss_ss: 0.764244, loss_d: 0.095944
0.3845 --- loss: 1.297706, loss_ss: 1.071228, loss_d: 0.226478
0.4229 --- loss: 0.866065, loss_ss: 0.749881, loss_d: 0.116184
0.4614 --- loss: 1.003320, loss_ss: 0.868678, loss_d: 0.134642
0.4998 --- loss: 0.967026, loss_ss: 0.895476, loss_d: 0.071549
0.5383 --- loss: 0.992226, loss_ss: 0.798296, loss_d: 0.193930
0.5767 --- loss: 1.253095, loss_ss: 0.786419, loss_d: 0.466675
0.6151 --- loss: 1.113122, loss_ss: 0.852276, loss_d: 0.260847
0.6536 --- loss: 1.986374, loss_ss: 0.940400, loss_d: 1.045974
0.6920 --- loss: 1.356142, loss_ss: 0.846699, loss_d: 0.509443
0.7305 --- loss: 0.880462, loss_ss: 0.756077, loss_d: 0.124385
0.7689 --- loss: 0.783140, loss_ss: 0.692172, loss_d: 0.090968
0.8074 --- loss: 1.269736, loss_ss: 1.137685, loss_d: 0.132051
0.8458 --- loss: 0.858127, loss_ss: 0.680310, loss_d: 0.177817
0.8843 --- loss: 0.906265, loss_ss: 0.738043, loss_d: 0.168222
0.9227 --- loss: 0.815025, loss_ss: 0.659356, loss_d: 0.155670
0.9612 --- loss: 1.216769, loss_ss: 0.859274, loss_d: 0.357495
0.9996 --- loss: 3.013481, loss_ss: 3.008045, loss_d: 0.005436
Epoch finished! Loss: 1.0662942680028769
Starting epoch 5/10.
0.0000 --- loss: 0.858603, loss_ss: 0.835043, loss_d: 0.023560
0.0384 --- loss: 0.792623, loss_ss: 0.763912, loss_d: 0.028710
0.0769 --- loss: 1.068717, loss_ss: 1.049481, loss_d: 0.019236
0.1153 --- loss: 0.941972, loss_ss: 0.785925, loss_d: 0.156047
0.1538 --- loss: 0.843443, loss_ss: 0.756918, loss_d: 0.086525
0.1922 --- loss: 1.138730, loss_ss: 0.925802, loss_d: 0.212927
0.2307 --- loss: 0.863347, loss_ss: 0.787397, loss_d: 0.075949
0.2691 --- loss: 0.860747, loss_ss: 0.651335, loss_d: 0.209412
0.3076 --- loss: 0.962330, loss_ss: 0.624771, loss_d: 0.337560
0.3460 --- loss: 0.912744, loss_ss: 0.758973, loss_d: 0.153771
0.3845 --- loss: 0.980217, loss_ss: 0.895440, loss_d: 0.084777
0.4229 --- loss: 0.952658, loss_ss: 0.912807, loss_d: 0.039851
0.4614 --- loss: 0.740871, loss_ss: 0.718331, loss_d: 0.022540
0.4998 --- loss: 0.874404, loss_ss: 0.841595, loss_d: 0.032809
0.5383 --- loss: 0.876749, loss_ss: 0.806459, loss_d: 0.070290
0.5767 --- loss: 0.579833, loss_ss: 0.552505, loss_d: 0.027328
0.6151 --- loss: 1.363346, loss_ss: 0.760844, loss_d: 0.602502
0.6536 --- loss: 1.024423, loss_ss: 0.864183, loss_d: 0.160240
0.6920 --- loss: 0.963200, loss_ss: 0.921049, loss_d: 0.042151
0.7305 --- loss: 0.813803, loss_ss: 0.756376, loss_d: 0.057427
0.7689 --- loss: 1.079938, loss_ss: 0.965567, loss_d: 0.114371
0.8074 --- loss: 0.899991, loss_ss: 0.866258, loss_d: 0.033733
0.8458 --- loss: 1.055024, loss_ss: 0.767482, loss_d: 0.287542
0.8843 --- loss: 1.163979, loss_ss: 1.037933, loss_d: 0.126046
0.9227 --- loss: 1.058737, loss_ss: 0.975265, loss_d: 0.083472
0.9612 --- loss: 1.144207, loss_ss: 0.920910, loss_d: 0.223297
0.9996 --- loss: 6.539738, loss_ss: 1.465572, loss_d: 5.074166
Epoch finished! Loss: 0.9998133400311837
Starting epoch 6/10.
0.0000 --- loss: 0.887853, loss_ss: 0.850119, loss_d: 0.037734
0.0384 --- loss: 1.109389, loss_ss: 0.917647, loss_d: 0.191742
0.0769 --- loss: 1.011987, loss_ss: 0.720975, loss_d: 0.291012
0.1153 --- loss: 0.702442, loss_ss: 0.569861, loss_d: 0.132581
0.1538 --- loss: 0.997865, loss_ss: 0.750712, loss_d: 0.247153
0.1922 --- loss: 0.780415, loss_ss: 0.682166, loss_d: 0.098249
0.2307 --- loss: 1.121279, loss_ss: 0.772250, loss_d: 0.349029
0.2691 --- loss: 1.003903, loss_ss: 0.915886, loss_d: 0.088016
0.3076 --- loss: 0.838476, loss_ss: 0.772911, loss_d: 0.065565
0.3460 --- loss: 1.010437, loss_ss: 0.959661, loss_d: 0.050776
0.3845 --- loss: 0.947042, loss_ss: 0.927890, loss_d: 0.019153
0.4229 --- loss: 0.659406, loss_ss: 0.652564, loss_d: 0.006842
0.4614 --- loss: 0.788796, loss_ss: 0.564213, loss_d: 0.224584
0.4998 --- loss: 1.282363, loss_ss: 0.889596, loss_d: 0.392767
0.5383 --- loss: 1.373424, loss_ss: 0.970782, loss_d: 0.402642
0.5767 --- loss: 0.956781, loss_ss: 0.874551, loss_d: 0.082230
0.6151 --- loss: 1.040598, loss_ss: 1.005010, loss_d: 0.035588
0.6536 --- loss: 0.728193, loss_ss: 0.621049, loss_d: 0.107144
0.6920 --- loss: 0.733918, loss_ss: 0.714619, loss_d: 0.019300
0.7305 --- loss: 0.693376, loss_ss: 0.681554, loss_d: 0.011822
0.7689 --- loss: 0.623092, loss_ss: 0.607029, loss_d: 0.016064
0.8074 --- loss: 1.378955, loss_ss: 1.025257, loss_d: 0.353698
0.8458 --- loss: 1.174685, loss_ss: 0.847756, loss_d: 0.326928
0.8843 --- loss: 0.990752, loss_ss: 0.792792, loss_d: 0.197960
0.9227 --- loss: 0.964363, loss_ss: 0.829392, loss_d: 0.134971
0.9612 --- loss: 0.834340, loss_ss: 0.584599, loss_d: 0.249741
0.9996 --- loss: 2.932723, loss_ss: 2.927503, loss_d: 0.005220
Epoch finished! Loss: 0.9647987654575935
Starting epoch 7/10.
0.0000 --- loss: 0.713620, loss_ss: 0.596398, loss_d: 0.117222
0.0384 --- loss: 1.078145, loss_ss: 1.033216, loss_d: 0.044929
0.0769 --- loss: 0.825726, loss_ss: 0.729985, loss_d: 0.095741
0.1153 --- loss: 1.547821, loss_ss: 1.214616, loss_d: 0.333206
0.1538 --- loss: 0.903221, loss_ss: 0.849113, loss_d: 0.054108
0.1922 --- loss: 0.953744, loss_ss: 0.944632, loss_d: 0.009112
0.2307 --- loss: 1.076661, loss_ss: 1.059611, loss_d: 0.017050
0.2691 --- loss: 0.786017, loss_ss: 0.780436, loss_d: 0.005581
0.3076 --- loss: 0.773952, loss_ss: 0.750393, loss_d: 0.023559
0.3460 --- loss: 0.914720, loss_ss: 0.867981, loss_d: 0.046739
0.3845 --- loss: 1.316512, loss_ss: 0.861580, loss_d: 0.454932
0.4229 --- loss: 0.528855, loss_ss: 0.491220, loss_d: 0.037635
0.4614 --- loss: 0.747918, loss_ss: 0.720217, loss_d: 0.027701
0.4998 --- loss: 1.101617, loss_ss: 0.984514, loss_d: 0.117103
0.5383 --- loss: 1.344327, loss_ss: 0.768284, loss_d: 0.576043
0.5767 --- loss: 1.124523, loss_ss: 0.715142, loss_d: 0.409381
0.6151 --- loss: 0.692902, loss_ss: 0.673126, loss_d: 0.019776
0.6536 --- loss: 1.096104, loss_ss: 0.617325, loss_d: 0.478779
0.6920 --- loss: 0.954396, loss_ss: 0.926555, loss_d: 0.027841
0.7305 --- loss: 0.826585, loss_ss: 0.671223, loss_d: 0.155362
0.7689 --- loss: 0.951261, loss_ss: 0.661001, loss_d: 0.290260
0.8074 --- loss: 1.235391, loss_ss: 0.992259, loss_d: 0.243132
0.8458 --- loss: 0.736180, loss_ss: 0.644479, loss_d: 0.091701
0.8843 --- loss: 1.537617, loss_ss: 1.491409, loss_d: 0.046208
0.9227 --- loss: 0.935631, loss_ss: 0.907617, loss_d: 0.028014
0.9612 --- loss: 1.050697, loss_ss: 0.834389, loss_d: 0.216308
0.9996 --- loss: 1.518196, loss_ss: 1.506814, loss_d: 0.011383
Epoch finished! Loss: 0.8991513946881661
Starting epoch 8/10.
0.0000 --- loss: 1.655519, loss_ss: 1.359954, loss_d: 0.295564
0.0384 --- loss: 1.149910, loss_ss: 1.040801, loss_d: 0.109110
0.0769 --- loss: 1.313483, loss_ss: 0.706629, loss_d: 0.606853
0.1153 --- loss: 1.370173, loss_ss: 1.112829, loss_d: 0.257344
0.1538 --- loss: 0.692158, loss_ss: 0.682631, loss_d: 0.009527
0.1922 --- loss: 0.836376, loss_ss: 0.830445, loss_d: 0.005931
0.2307 --- loss: 1.182983, loss_ss: 0.706939, loss_d: 0.476044
0.2691 --- loss: 0.870722, loss_ss: 0.849985, loss_d: 0.020737
0.3076 --- loss: 0.874533, loss_ss: 0.857891, loss_d: 0.016642
0.3460 --- loss: 0.687324, loss_ss: 0.632122, loss_d: 0.055202
0.3845 --- loss: 0.753910, loss_ss: 0.632522, loss_d: 0.121388
0.4229 --- loss: 1.019441, loss_ss: 0.982028, loss_d: 0.037413
0.4614 --- loss: 1.176106, loss_ss: 0.895289, loss_d: 0.280817
0.4998 --- loss: 0.942782, loss_ss: 0.909918, loss_d: 0.032865
0.5383 --- loss: 0.659259, loss_ss: 0.640873, loss_d: 0.018386
0.5767 --- loss: 0.570708, loss_ss: 0.512325, loss_d: 0.058382
0.6151 --- loss: 0.724861, loss_ss: 0.672607, loss_d: 0.052254
0.6536 --- loss: 0.806845, loss_ss: 0.751631, loss_d: 0.055214
0.6920 --- loss: 0.730550, loss_ss: 0.662476, loss_d: 0.068073
0.7305 --- loss: 0.913854, loss_ss: 0.775012, loss_d: 0.138842
0.7689 --- loss: 0.698946, loss_ss: 0.692662, loss_d: 0.006284
0.8074 --- loss: 0.836206, loss_ss: 0.482983, loss_d: 0.353223
0.8458 --- loss: 0.680963, loss_ss: 0.648422, loss_d: 0.032542
0.8843 --- loss: 1.156663, loss_ss: 0.809226, loss_d: 0.347437
0.9227 --- loss: 0.627611, loss_ss: 0.613823, loss_d: 0.013788
0.9612 --- loss: 0.567789, loss_ss: 0.491028, loss_d: 0.076761
0.9996 --- loss: 2.632247, loss_ss: 2.627553, loss_d: 0.004695
Epoch finished! Loss: 0.8702416160931954
Starting epoch 9/10.
0.0000 --- loss: 1.606971, loss_ss: 0.781065, loss_d: 0.825906
0.0384 --- loss: 0.689142, loss_ss: 0.657889, loss_d: 0.031253
0.0769 --- loss: 0.906561, loss_ss: 0.885209, loss_d: 0.021353
0.1153 --- loss: 1.180042, loss_ss: 1.098652, loss_d: 0.081390
0.1538 --- loss: 0.668019, loss_ss: 0.630857, loss_d: 0.037162
0.1922 --- loss: 0.676408, loss_ss: 0.556028, loss_d: 0.120380
0.2307 --- loss: 1.310916, loss_ss: 1.108145, loss_d: 0.202771
0.2691 --- loss: 0.574573, loss_ss: 0.524176, loss_d: 0.050397
0.3076 --- loss: 0.546041, loss_ss: 0.507282, loss_d: 0.038760
0.3460 --- loss: 1.112644, loss_ss: 0.864397, loss_d: 0.248247
0.3845 --- loss: 0.658101, loss_ss: 0.588998, loss_d: 0.069103
0.4229 --- loss: 0.750140, loss_ss: 0.539337, loss_d: 0.210802
0.4614 --- loss: 0.822193, loss_ss: 0.806508, loss_d: 0.015684
0.4998 --- loss: 0.719155, loss_ss: 0.638685, loss_d: 0.080470
0.5383 --- loss: 0.659783, loss_ss: 0.642854, loss_d: 0.016929
0.5767 --- loss: 1.201458, loss_ss: 0.932132, loss_d: 0.269326
0.6151 --- loss: 0.581523, loss_ss: 0.555701, loss_d: 0.025822
0.6536 --- loss: 0.880763, loss_ss: 0.795605, loss_d: 0.085158
0.6920 --- loss: 0.742413, loss_ss: 0.731408, loss_d: 0.011005
0.7305 --- loss: 0.934048, loss_ss: 0.884976, loss_d: 0.049072
0.7689 --- loss: 0.791145, loss_ss: 0.748393, loss_d: 0.042752
0.8074 --- loss: 0.775106, loss_ss: 0.720189, loss_d: 0.054917
0.8458 --- loss: 0.503557, loss_ss: 0.475489, loss_d: 0.028068
0.8843 --- loss: 0.640982, loss_ss: 0.564584, loss_d: 0.076398
0.9227 --- loss: 0.959616, loss_ss: 0.954325, loss_d: 0.005291
0.9612 --- loss: 0.972893, loss_ss: 0.853020, loss_d: 0.119873
0.9996 --- loss: 1.752403, loss_ss: 1.749664, loss_d: 0.002740
Epoch finished! Loss: 0.849323779459183
Starting epoch 10/10.
0.0000 --- loss: 0.700947, loss_ss: 0.678223, loss_d: 0.022724
0.0384 --- loss: 0.905648, loss_ss: 0.768474, loss_d: 0.137174
0.0769 --- loss: 0.874927, loss_ss: 0.808297, loss_d: 0.066630
0.1153 --- loss: 0.724924, loss_ss: 0.706312, loss_d: 0.018612
0.1538 --- loss: 0.689688, loss_ss: 0.681228, loss_d: 0.008460
0.1922 --- loss: 0.708230, loss_ss: 0.687328, loss_d: 0.020902
0.2307 --- loss: 0.658341, loss_ss: 0.627955, loss_d: 0.030387
0.2691 --- loss: 0.608104, loss_ss: 0.589304, loss_d: 0.018799
0.3076 --- loss: 0.798332, loss_ss: 0.577494, loss_d: 0.220838
0.3460 --- loss: 0.666244, loss_ss: 0.653220, loss_d: 0.013024
0.3845 --- loss: 0.955292, loss_ss: 0.922334, loss_d: 0.032958
0.4229 --- loss: 0.690928, loss_ss: 0.615593, loss_d: 0.075335
0.4614 --- loss: 0.781313, loss_ss: 0.634868, loss_d: 0.146445
0.4998 --- loss: 0.808594, loss_ss: 0.807512, loss_d: 0.001082
0.5383 --- loss: 0.902374, loss_ss: 0.612069, loss_d: 0.290305
0.5767 --- loss: 0.763360, loss_ss: 0.740053, loss_d: 0.023307
0.6151 --- loss: 0.658553, loss_ss: 0.624117, loss_d: 0.034436
0.6536 --- loss: 0.760192, loss_ss: 0.640951, loss_d: 0.119241
0.6920 --- loss: 0.628959, loss_ss: 0.626979, loss_d: 0.001980
0.7305 --- loss: 1.041495, loss_ss: 0.682276, loss_d: 0.359219
0.7689 --- loss: 1.194616, loss_ss: 0.817221, loss_d: 0.377395
0.8074 --- loss: 0.731346, loss_ss: 0.726068, loss_d: 0.005278
0.8458 --- loss: 1.135001, loss_ss: 0.975944, loss_d: 0.159057
0.8843 --- loss: 0.458882, loss_ss: 0.447656, loss_d: 0.011226
0.9227 --- loss: 0.822934, loss_ss: 0.803044, loss_d: 0.019890
0.9612 --- loss: 0.706594, loss_ss: 0.694592, loss_d: 0.012001
0.9996 --- loss: 5.718929, loss_ss: 1.485981, loss_d: 4.232949
Epoch finished! Loss: 0.8356609303217668
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6792792792792792
             precision    recall  f1-score   support

        0.0       0.95      0.63      0.76       138
        1.0       0.20      0.08      0.12       123
        2.0       0.27      0.82      0.41       120
        3.0       0.97      0.81      0.88       363
        4.0       0.88      0.72      0.79       366

avg / total       0.78      0.68      0.70      1110
 


====== chp018-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.95  63.04   99.49  94.57     75.65
1  86.31   8.13   96.05  20.41     11.63
2  74.14  82.50   73.13  27.12     40.82
3  92.97  80.99   98.80  97.03     88.29
4  87.48  72.13   95.03  87.71     79.16
Total accuracy: 67.93%
Average sen: 61.36%
Average spec: 92.50%
Macro f1-score: 59.11%
Diagnosis acc on 15mins: 1.0
[1.         0.99999988 0.99999988 1.         1.         0.99999976
 0.9999994  0.99999988 1.         1.         1.         1.
 1.         1.         0.99999905 1.         1.         0.99999988
 0.99999988 0.99999583 0.99999952 1.         1.         1.
 1.         1.         0.99999952 1.         1.         1.
 1.         0.99999988 1.         0.99999976 0.99999642 0.99999762
 1.        ]
pred: 0.999999626262768, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.448951, loss_ss: 1.701400, loss_d: 0.747552
0.0384 --- loss: 2.335561, loss_ss: 1.676871, loss_d: 0.658690
0.0767 --- loss: 2.145390, loss_ss: 1.498643, loss_d: 0.646748
0.1151 --- loss: 2.284098, loss_ss: 1.435957, loss_d: 0.848141
0.1534 --- loss: 2.319210, loss_ss: 1.491449, loss_d: 0.827761
0.1918 --- loss: 1.911444, loss_ss: 1.391810, loss_d: 0.519634
0.2301 --- loss: 1.913850, loss_ss: 1.332353, loss_d: 0.581497
0.2685 --- loss: 2.061200, loss_ss: 1.320460, loss_d: 0.740739
0.3069 --- loss: 1.770857, loss_ss: 1.373096, loss_d: 0.397761
0.3452 --- loss: 1.918569, loss_ss: 1.305917, loss_d: 0.612652
0.3836 --- loss: 1.844346, loss_ss: 1.277484, loss_d: 0.566862
0.4219 --- loss: 1.889202, loss_ss: 1.381005, loss_d: 0.508197
0.4603 --- loss: 1.761860, loss_ss: 1.261757, loss_d: 0.500104
0.4987 --- loss: 1.750233, loss_ss: 1.343540, loss_d: 0.406693
0.5370 --- loss: 1.681543, loss_ss: 1.265915, loss_d: 0.415627
0.5754 --- loss: 1.841354, loss_ss: 1.194788, loss_d: 0.646566
0.6137 --- loss: 1.678164, loss_ss: 1.300839, loss_d: 0.377324
0.6521 --- loss: 1.710949, loss_ss: 1.224732, loss_d: 0.486217
0.6904 --- loss: 1.605986, loss_ss: 1.158914, loss_d: 0.447072
0.7288 --- loss: 1.456524, loss_ss: 1.121681, loss_d: 0.334843
0.7672 --- loss: 1.973371, loss_ss: 1.100832, loss_d: 0.872539
0.8055 --- loss: 1.703460, loss_ss: 1.078669, loss_d: 0.624791
0.8439 --- loss: 1.510788, loss_ss: 1.208319, loss_d: 0.302469
0.8822 --- loss: 1.606564, loss_ss: 1.144741, loss_d: 0.461823
0.9206 --- loss: 1.528838, loss_ss: 1.224653, loss_d: 0.304185
0.9590 --- loss: 1.420291, loss_ss: 0.967230, loss_d: 0.453061
0.9973 --- loss: 1.512503, loss_ss: 1.107222, loss_d: 0.405281
Epoch finished! Loss: 1.816529026398292
Starting epoch 2/10.
0.0000 --- loss: 1.318230, loss_ss: 0.966526, loss_d: 0.351704
0.0384 --- loss: 1.034899, loss_ss: 0.923755, loss_d: 0.111144
0.0767 --- loss: 1.190972, loss_ss: 0.963576, loss_d: 0.227396
0.1151 --- loss: 1.252717, loss_ss: 0.954422, loss_d: 0.298294
0.1534 --- loss: 1.165098, loss_ss: 0.913251, loss_d: 0.251847
0.1918 --- loss: 2.323840, loss_ss: 1.097306, loss_d: 1.226534
0.2301 --- loss: 1.526636, loss_ss: 1.285043, loss_d: 0.241593
0.2685 --- loss: 1.464654, loss_ss: 1.209001, loss_d: 0.255653
0.3069 --- loss: 1.244025, loss_ss: 1.040636, loss_d: 0.203389
0.3452 --- loss: 1.345367, loss_ss: 1.172430, loss_d: 0.172938
0.3836 --- loss: 1.321122, loss_ss: 1.101736, loss_d: 0.219386
0.4219 --- loss: 1.066479, loss_ss: 0.875722, loss_d: 0.190757
0.4603 --- loss: 1.340714, loss_ss: 0.971826, loss_d: 0.368889
0.4987 --- loss: 1.215305, loss_ss: 0.871259, loss_d: 0.344045
0.5370 --- loss: 1.585129, loss_ss: 1.047364, loss_d: 0.537766
0.5754 --- loss: 1.651548, loss_ss: 0.937016, loss_d: 0.714532
0.6137 --- loss: 1.098618, loss_ss: 0.978144, loss_d: 0.120474
0.6521 --- loss: 1.494815, loss_ss: 0.991289, loss_d: 0.503526
0.6904 --- loss: 1.458277, loss_ss: 0.978232, loss_d: 0.480045
0.7288 --- loss: 1.364409, loss_ss: 1.175070, loss_d: 0.189338
0.7672 --- loss: 1.019226, loss_ss: 0.922249, loss_d: 0.096977
0.8055 --- loss: 1.165454, loss_ss: 0.849495, loss_d: 0.315959
0.8439 --- loss: 1.451201, loss_ss: 1.009544, loss_d: 0.441656
0.8822 --- loss: 1.118484, loss_ss: 1.040593, loss_d: 0.077891
0.9206 --- loss: 1.330591, loss_ss: 0.977867, loss_d: 0.352725
0.9590 --- loss: 1.267379, loss_ss: 0.941012, loss_d: 0.326367
0.9973 --- loss: 1.564536, loss_ss: 1.031856, loss_d: 0.532680
Epoch finished! Loss: 1.3463367487375553
Starting epoch 3/10.
0.0000 --- loss: 1.188536, loss_ss: 0.848832, loss_d: 0.339704
0.0384 --- loss: 1.212219, loss_ss: 0.963442, loss_d: 0.248778
0.0767 --- loss: 1.152850, loss_ss: 1.010100, loss_d: 0.142750
0.1151 --- loss: 1.299278, loss_ss: 1.132529, loss_d: 0.166748
0.1534 --- loss: 1.074698, loss_ss: 0.926343, loss_d: 0.148355
0.1918 --- loss: 1.088555, loss_ss: 0.767634, loss_d: 0.320922
0.2301 --- loss: 1.082273, loss_ss: 0.899657, loss_d: 0.182616
0.2685 --- loss: 1.458504, loss_ss: 1.289064, loss_d: 0.169440
0.3069 --- loss: 1.165095, loss_ss: 0.884128, loss_d: 0.280967
0.3452 --- loss: 1.166201, loss_ss: 0.828924, loss_d: 0.337277
0.3836 --- loss: 0.922927, loss_ss: 0.843234, loss_d: 0.079693
0.4219 --- loss: 1.015941, loss_ss: 0.682055, loss_d: 0.333886
0.4603 --- loss: 1.017198, loss_ss: 0.986062, loss_d: 0.031136
0.4987 --- loss: 1.641332, loss_ss: 0.888683, loss_d: 0.752649
0.5370 --- loss: 1.133808, loss_ss: 0.845207, loss_d: 0.288601
0.5754 --- loss: 0.932133, loss_ss: 0.844590, loss_d: 0.087543
0.6137 --- loss: 1.648014, loss_ss: 0.676658, loss_d: 0.971356
0.6521 --- loss: 1.065965, loss_ss: 0.876885, loss_d: 0.189080
0.6904 --- loss: 0.979256, loss_ss: 0.871130, loss_d: 0.108127
0.7288 --- loss: 1.085481, loss_ss: 0.952650, loss_d: 0.132831
0.7672 --- loss: 1.178421, loss_ss: 0.935147, loss_d: 0.243274
0.8055 --- loss: 1.001753, loss_ss: 0.809177, loss_d: 0.192576
0.8439 --- loss: 1.121525, loss_ss: 0.883232, loss_d: 0.238293
0.8822 --- loss: 1.068093, loss_ss: 0.897187, loss_d: 0.170906
0.9206 --- loss: 1.365284, loss_ss: 1.063859, loss_d: 0.301425
0.9590 --- loss: 0.961651, loss_ss: 0.864865, loss_d: 0.096785
0.9973 --- loss: 1.135255, loss_ss: 0.776040, loss_d: 0.359215
Epoch finished! Loss: 1.1714694619178772
Starting epoch 4/10.
0.0000 --- loss: 1.063249, loss_ss: 0.926034, loss_d: 0.137214
0.0384 --- loss: 0.908644, loss_ss: 0.860735, loss_d: 0.047909
0.0767 --- loss: 0.957474, loss_ss: 0.843338, loss_d: 0.114136
0.1151 --- loss: 1.261833, loss_ss: 0.849067, loss_d: 0.412766
0.1534 --- loss: 1.044143, loss_ss: 0.925884, loss_d: 0.118259
0.1918 --- loss: 1.857359, loss_ss: 1.027372, loss_d: 0.829987
0.2301 --- loss: 1.310968, loss_ss: 0.977351, loss_d: 0.333616
0.2685 --- loss: 0.980727, loss_ss: 0.768894, loss_d: 0.211833
0.3069 --- loss: 0.889187, loss_ss: 0.766168, loss_d: 0.123019
0.3452 --- loss: 1.151922, loss_ss: 0.914238, loss_d: 0.237684
0.3836 --- loss: 0.749595, loss_ss: 0.622008, loss_d: 0.127586
0.4219 --- loss: 0.981877, loss_ss: 0.921603, loss_d: 0.060273
0.4603 --- loss: 1.100859, loss_ss: 0.847898, loss_d: 0.252961
0.4987 --- loss: 0.849348, loss_ss: 0.658582, loss_d: 0.190766
0.5370 --- loss: 1.236444, loss_ss: 1.178226, loss_d: 0.058218
0.5754 --- loss: 0.906996, loss_ss: 0.876545, loss_d: 0.030450
0.6137 --- loss: 0.897393, loss_ss: 0.663051, loss_d: 0.234342
0.6521 --- loss: 1.498523, loss_ss: 0.735641, loss_d: 0.762882
0.6904 --- loss: 1.293904, loss_ss: 0.840451, loss_d: 0.453453
0.7288 --- loss: 1.219141, loss_ss: 0.839610, loss_d: 0.379531
0.7672 --- loss: 1.029862, loss_ss: 0.772740, loss_d: 0.257122
0.8055 --- loss: 0.914291, loss_ss: 0.783321, loss_d: 0.130970
0.8439 --- loss: 0.788397, loss_ss: 0.751477, loss_d: 0.036920
0.8822 --- loss: 1.015771, loss_ss: 0.980244, loss_d: 0.035526
0.9206 --- loss: 0.981547, loss_ss: 0.935698, loss_d: 0.045848
0.9590 --- loss: 0.945923, loss_ss: 0.897507, loss_d: 0.048416
0.9973 --- loss: 2.057033, loss_ss: 1.170546, loss_d: 0.886487
Epoch finished! Loss: 1.0479553406055158
Starting epoch 5/10.
0.0000 --- loss: 0.838037, loss_ss: 0.806937, loss_d: 0.031100
0.0384 --- loss: 1.105238, loss_ss: 1.072405, loss_d: 0.032833
0.0767 --- loss: 0.862549, loss_ss: 0.810451, loss_d: 0.052098
0.1151 --- loss: 1.043635, loss_ss: 0.884717, loss_d: 0.158919
0.1534 --- loss: 0.666323, loss_ss: 0.636595, loss_d: 0.029727
0.1918 --- loss: 0.867963, loss_ss: 0.765976, loss_d: 0.101987
0.2301 --- loss: 0.697492, loss_ss: 0.645750, loss_d: 0.051741
0.2685 --- loss: 1.135789, loss_ss: 1.052469, loss_d: 0.083320
0.3069 --- loss: 1.541553, loss_ss: 0.786088, loss_d: 0.755466
0.3452 --- loss: 1.036942, loss_ss: 0.883942, loss_d: 0.153000
0.3836 --- loss: 0.930694, loss_ss: 0.792507, loss_d: 0.138186
0.4219 --- loss: 1.036525, loss_ss: 0.856102, loss_d: 0.180423
0.4603 --- loss: 1.260831, loss_ss: 0.886346, loss_d: 0.374484
0.4987 --- loss: 0.950338, loss_ss: 0.748170, loss_d: 0.202167
0.5370 --- loss: 0.867619, loss_ss: 0.615608, loss_d: 0.252011
0.5754 --- loss: 0.761520, loss_ss: 0.712308, loss_d: 0.049212
0.6137 --- loss: 1.159450, loss_ss: 1.135610, loss_d: 0.023840
0.6521 --- loss: 0.829165, loss_ss: 0.727593, loss_d: 0.101572
0.6904 --- loss: 0.684768, loss_ss: 0.637730, loss_d: 0.047038
0.7288 --- loss: 1.231199, loss_ss: 0.908333, loss_d: 0.322866
0.7672 --- loss: 1.562336, loss_ss: 1.179121, loss_d: 0.383215
0.8055 --- loss: 1.264894, loss_ss: 1.132086, loss_d: 0.132808
0.8439 --- loss: 0.610033, loss_ss: 0.582133, loss_d: 0.027899
0.8822 --- loss: 0.740844, loss_ss: 0.583939, loss_d: 0.156905
0.9206 --- loss: 0.847296, loss_ss: 0.791598, loss_d: 0.055697
0.9590 --- loss: 0.994161, loss_ss: 0.875932, loss_d: 0.118229
0.9973 --- loss: 1.119011, loss_ss: 0.818595, loss_d: 0.300416
Epoch finished! Loss: 0.996154917203463
Starting epoch 6/10.
0.0000 --- loss: 0.822939, loss_ss: 0.737899, loss_d: 0.085041
0.0384 --- loss: 0.918629, loss_ss: 0.818217, loss_d: 0.100412
0.0767 --- loss: 0.838047, loss_ss: 0.550332, loss_d: 0.287715
0.1151 --- loss: 1.094132, loss_ss: 1.029829, loss_d: 0.064303
0.1534 --- loss: 0.900214, loss_ss: 0.824538, loss_d: 0.075676
0.1918 --- loss: 0.779902, loss_ss: 0.754462, loss_d: 0.025440
0.2301 --- loss: 1.322074, loss_ss: 0.812463, loss_d: 0.509611
0.2685 --- loss: 0.748575, loss_ss: 0.620014, loss_d: 0.128561
0.3069 --- loss: 0.686331, loss_ss: 0.633184, loss_d: 0.053147
0.3452 --- loss: 0.722207, loss_ss: 0.659024, loss_d: 0.063183
0.3836 --- loss: 1.132539, loss_ss: 1.096220, loss_d: 0.036319
0.4219 --- loss: 0.875006, loss_ss: 0.789109, loss_d: 0.085897
0.4603 --- loss: 0.903094, loss_ss: 0.633545, loss_d: 0.269549
0.4987 --- loss: 1.154094, loss_ss: 1.129998, loss_d: 0.024096
0.5370 --- loss: 0.674515, loss_ss: 0.644748, loss_d: 0.029768
0.5754 --- loss: 0.800676, loss_ss: 0.635711, loss_d: 0.164964
0.6137 --- loss: 1.093354, loss_ss: 0.793359, loss_d: 0.299995
0.6521 --- loss: 1.093653, loss_ss: 1.068894, loss_d: 0.024759
0.6904 --- loss: 0.853715, loss_ss: 0.435313, loss_d: 0.418401
0.7288 --- loss: 1.085862, loss_ss: 0.736125, loss_d: 0.349737
0.7672 --- loss: 0.813031, loss_ss: 0.434493, loss_d: 0.378538
0.8055 --- loss: 0.936403, loss_ss: 0.580688, loss_d: 0.355715
0.8439 --- loss: 1.021952, loss_ss: 0.987275, loss_d: 0.034677
0.8822 --- loss: 0.957206, loss_ss: 0.891340, loss_d: 0.065866
0.9206 --- loss: 0.768160, loss_ss: 0.715836, loss_d: 0.052324
0.9590 --- loss: 0.645528, loss_ss: 0.524247, loss_d: 0.121281
0.9973 --- loss: 0.666074, loss_ss: 0.594916, loss_d: 0.071158
Epoch finished! Loss: 0.9316948282030912
Starting epoch 7/10.
0.0000 --- loss: 1.085826, loss_ss: 0.834227, loss_d: 0.251598
0.0384 --- loss: 1.247746, loss_ss: 1.210759, loss_d: 0.036987
0.0767 --- loss: 0.611311, loss_ss: 0.532176, loss_d: 0.079135
0.1151 --- loss: 0.787883, loss_ss: 0.770290, loss_d: 0.017592
0.1534 --- loss: 0.671823, loss_ss: 0.587366, loss_d: 0.084457
0.1918 --- loss: 1.186744, loss_ss: 1.176760, loss_d: 0.009984
0.2301 --- loss: 1.945243, loss_ss: 1.596356, loss_d: 0.348887
0.2685 --- loss: 0.791598, loss_ss: 0.605679, loss_d: 0.185919
0.3069 --- loss: 1.053650, loss_ss: 0.835735, loss_d: 0.217915
0.3452 --- loss: 0.798273, loss_ss: 0.769108, loss_d: 0.029165
0.3836 --- loss: 1.307689, loss_ss: 1.077593, loss_d: 0.230096
0.4219 --- loss: 0.783229, loss_ss: 0.746335, loss_d: 0.036893
0.4603 --- loss: 0.760927, loss_ss: 0.717863, loss_d: 0.043063
0.4987 --- loss: 0.751393, loss_ss: 0.724879, loss_d: 0.026513
0.5370 --- loss: 1.051413, loss_ss: 0.427258, loss_d: 0.624155
0.5754 --- loss: 0.936272, loss_ss: 0.863139, loss_d: 0.073132
0.6137 --- loss: 0.885391, loss_ss: 0.865998, loss_d: 0.019393
0.6521 --- loss: 0.653168, loss_ss: 0.621217, loss_d: 0.031951
0.6904 --- loss: 0.676510, loss_ss: 0.645833, loss_d: 0.030677
0.7288 --- loss: 1.010312, loss_ss: 0.953280, loss_d: 0.057032
0.7672 --- loss: 0.895199, loss_ss: 0.809641, loss_d: 0.085557
0.8055 --- loss: 1.042638, loss_ss: 1.015915, loss_d: 0.026724
0.8439 --- loss: 0.851659, loss_ss: 0.766912, loss_d: 0.084747
0.8822 --- loss: 1.004567, loss_ss: 0.991390, loss_d: 0.013177
0.9206 --- loss: 1.308588, loss_ss: 0.721724, loss_d: 0.586865
0.9590 --- loss: 0.986333, loss_ss: 0.909725, loss_d: 0.076609
0.9973 --- loss: 1.053884, loss_ss: 0.983576, loss_d: 0.070308
Epoch finished! Loss: 0.8979501634836197
Starting epoch 8/10.
0.0000 --- loss: 1.322222, loss_ss: 0.861953, loss_d: 0.460269
0.0384 --- loss: 0.720701, loss_ss: 0.692790, loss_d: 0.027911
0.0767 --- loss: 0.544705, loss_ss: 0.521704, loss_d: 0.023000
0.1151 --- loss: 0.722591, loss_ss: 0.600650, loss_d: 0.121941
0.1534 --- loss: 1.184269, loss_ss: 1.145427, loss_d: 0.038842
0.1918 --- loss: 0.643899, loss_ss: 0.574464, loss_d: 0.069435
0.2301 --- loss: 0.835004, loss_ss: 0.682220, loss_d: 0.152784
0.2685 --- loss: 0.988705, loss_ss: 0.844391, loss_d: 0.144314
0.3069 --- loss: 0.880118, loss_ss: 0.809697, loss_d: 0.070422
0.3452 --- loss: 1.886824, loss_ss: 0.959620, loss_d: 0.927205
0.3836 --- loss: 0.917942, loss_ss: 0.786512, loss_d: 0.131430
0.4219 --- loss: 0.658391, loss_ss: 0.631135, loss_d: 0.027255
0.4603 --- loss: 0.991210, loss_ss: 0.980747, loss_d: 0.010463
0.4987 --- loss: 1.355780, loss_ss: 1.243339, loss_d: 0.112441
0.5370 --- loss: 1.142235, loss_ss: 0.777587, loss_d: 0.364648
0.5754 --- loss: 0.831074, loss_ss: 0.743662, loss_d: 0.087412
0.6137 --- loss: 1.096760, loss_ss: 0.788766, loss_d: 0.307994
0.6521 --- loss: 0.881081, loss_ss: 0.870170, loss_d: 0.010911
0.6904 --- loss: 1.180695, loss_ss: 1.082865, loss_d: 0.097830
0.7288 --- loss: 0.727593, loss_ss: 0.517920, loss_d: 0.209674
0.7672 --- loss: 1.102301, loss_ss: 0.914771, loss_d: 0.187530
0.8055 --- loss: 0.631868, loss_ss: 0.551712, loss_d: 0.080156
0.8439 --- loss: 0.952258, loss_ss: 0.886059, loss_d: 0.066199
0.8822 --- loss: 0.935043, loss_ss: 0.923633, loss_d: 0.011409
0.9206 --- loss: 0.891295, loss_ss: 0.848373, loss_d: 0.042922
0.9590 --- loss: 0.962033, loss_ss: 0.778858, loss_d: 0.183175
0.9973 --- loss: 1.018391, loss_ss: 1.003062, loss_d: 0.015329
Epoch finished! Loss: 0.8715097978711128
Starting epoch 9/10.
0.0000 --- loss: 0.637255, loss_ss: 0.601608, loss_d: 0.035647
0.0384 --- loss: 0.673011, loss_ss: 0.659901, loss_d: 0.013110
0.0767 --- loss: 0.516053, loss_ss: 0.513094, loss_d: 0.002960
0.1151 --- loss: 0.790743, loss_ss: 0.783340, loss_d: 0.007403
0.1534 --- loss: 1.037591, loss_ss: 0.878535, loss_d: 0.159057
0.1918 --- loss: 0.731475, loss_ss: 0.710470, loss_d: 0.021005
0.2301 --- loss: 0.875718, loss_ss: 0.518137, loss_d: 0.357581
0.2685 --- loss: 1.072732, loss_ss: 0.963047, loss_d: 0.109685
0.3069 --- loss: 0.904194, loss_ss: 0.807824, loss_d: 0.096370
0.3452 --- loss: 1.231568, loss_ss: 0.804020, loss_d: 0.427548
0.3836 --- loss: 0.818006, loss_ss: 0.605991, loss_d: 0.212015
0.4219 --- loss: 1.285506, loss_ss: 1.262701, loss_d: 0.022805
0.4603 --- loss: 0.541408, loss_ss: 0.515746, loss_d: 0.025662
0.4987 --- loss: 1.263081, loss_ss: 0.511296, loss_d: 0.751785
0.5370 --- loss: 0.821724, loss_ss: 0.800679, loss_d: 0.021045
0.5754 --- loss: 1.139924, loss_ss: 1.115582, loss_d: 0.024342
0.6137 --- loss: 0.908984, loss_ss: 0.858886, loss_d: 0.050099
0.6521 --- loss: 0.743347, loss_ss: 0.680116, loss_d: 0.063231
0.6904 --- loss: 1.058979, loss_ss: 0.971411, loss_d: 0.087568
0.7288 --- loss: 0.674910, loss_ss: 0.504167, loss_d: 0.170743
0.7672 --- loss: 0.691110, loss_ss: 0.659843, loss_d: 0.031266
0.8055 --- loss: 0.564403, loss_ss: 0.541475, loss_d: 0.022928
0.8439 --- loss: 0.801875, loss_ss: 0.636555, loss_d: 0.165321
0.8822 --- loss: 0.759786, loss_ss: 0.708996, loss_d: 0.050789
0.9206 --- loss: 0.748370, loss_ss: 0.730385, loss_d: 0.017986
0.9590 --- loss: 0.663800, loss_ss: 0.650703, loss_d: 0.013096
0.9973 --- loss: 1.239669, loss_ss: 1.130608, loss_d: 0.109061
Epoch finished! Loss: 0.8566345249231045
Starting epoch 10/10.
0.0000 --- loss: 0.872163, loss_ss: 0.567719, loss_d: 0.304444
0.0384 --- loss: 0.850223, loss_ss: 0.835720, loss_d: 0.014502
0.0767 --- loss: 0.851434, loss_ss: 0.628622, loss_d: 0.222812
0.1151 --- loss: 0.914392, loss_ss: 0.718482, loss_d: 0.195910
0.1534 --- loss: 0.679947, loss_ss: 0.495509, loss_d: 0.184438
0.1918 --- loss: 1.039583, loss_ss: 1.003435, loss_d: 0.036148
0.2301 --- loss: 0.709997, loss_ss: 0.702459, loss_d: 0.007538
0.2685 --- loss: 0.915433, loss_ss: 0.878048, loss_d: 0.037385
0.3069 --- loss: 1.280079, loss_ss: 1.235910, loss_d: 0.044169
0.3452 --- loss: 0.658002, loss_ss: 0.605615, loss_d: 0.052387
0.3836 --- loss: 0.528663, loss_ss: 0.525649, loss_d: 0.003014
0.4219 --- loss: 0.733100, loss_ss: 0.720229, loss_d: 0.012871
0.4603 --- loss: 0.721030, loss_ss: 0.701978, loss_d: 0.019051
0.4987 --- loss: 0.633861, loss_ss: 0.630694, loss_d: 0.003167
0.5370 --- loss: 0.736705, loss_ss: 0.728183, loss_d: 0.008523
0.5754 --- loss: 0.486255, loss_ss: 0.477382, loss_d: 0.008874
0.6137 --- loss: 0.696086, loss_ss: 0.671078, loss_d: 0.025009
0.6521 --- loss: 0.699944, loss_ss: 0.636663, loss_d: 0.063280
0.6904 --- loss: 0.718708, loss_ss: 0.708467, loss_d: 0.010241
0.7288 --- loss: 0.935869, loss_ss: 0.482467, loss_d: 0.453402
0.7672 --- loss: 0.926371, loss_ss: 0.547905, loss_d: 0.378466
0.8055 --- loss: 0.823919, loss_ss: 0.585112, loss_d: 0.238807
0.8439 --- loss: 0.709530, loss_ss: 0.611785, loss_d: 0.097745
0.8822 --- loss: 0.824348, loss_ss: 0.717713, loss_d: 0.106634
0.9206 --- loss: 0.601168, loss_ss: 0.592208, loss_d: 0.008960
0.9590 --- loss: 0.736068, loss_ss: 0.607678, loss_d: 0.128390
0.9973 --- loss: 0.728234, loss_ss: 0.684131, loss_d: 0.044103
Epoch finished! Loss: 0.8198200149031786
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6720430107526881
             precision    recall  f1-score   support

        0.0       0.29      0.58      0.39        36
        1.0       0.36      0.12      0.18       112
        2.0       0.51      0.86      0.64       224
        3.0       0.96      0.88      0.92       226
        4.0       0.84      0.60      0.70       332

avg / total       0.71      0.67      0.66       930
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.90  58.33   94.30  29.17     38.89
1  86.88  11.61   97.19  36.11     17.57
2  76.77  85.71   73.94  51.06     64.00
3  96.34  88.50   98.86  96.15     92.17
4  81.51  59.94   93.48  83.61     69.82
Total accuracy: 67.20%
Average sen: 60.82%
Average spec: 91.55%
Macro f1-score: 56.49%
Diagnosis acc on 15mins: 1.0
[1.         0.99980181 0.92889941 0.99999857 1.         0.99999571
 1.         1.         0.99999964 0.99992025 0.9630022  0.91461837
 0.99519062 0.99999797 0.99999678 0.99999976 0.99723595 0.99999833
 0.99999845 0.99996889 0.99811089 0.99972171 0.99995899 0.9999938
 0.99973196 1.         1.         0.99997389 0.99997067 0.9999944
 0.99921167]
pred: 0.9933964744690926, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.379298, loss_ss: 1.664623, loss_d: 0.714675
0.0385 --- loss: 2.105955, loss_ss: 1.439156, loss_d: 0.666799
0.0769 --- loss: 2.041407, loss_ss: 1.466326, loss_d: 0.575081
0.1154 --- loss: 1.657963, loss_ss: 1.317998, loss_d: 0.339965
0.1538 --- loss: 2.149251, loss_ss: 1.332877, loss_d: 0.816373
0.1923 --- loss: 1.937807, loss_ss: 1.300268, loss_d: 0.637540
0.2308 --- loss: 2.042825, loss_ss: 1.282948, loss_d: 0.759876
0.2692 --- loss: 1.723101, loss_ss: 1.299399, loss_d: 0.423702
0.3077 --- loss: 1.730051, loss_ss: 1.153291, loss_d: 0.576759
0.3462 --- loss: 2.208249, loss_ss: 1.327214, loss_d: 0.881035
0.3846 --- loss: 1.690691, loss_ss: 1.350870, loss_d: 0.339820
0.4231 --- loss: 1.711267, loss_ss: 1.217071, loss_d: 0.494196
0.4615 --- loss: 2.057278, loss_ss: 1.317374, loss_d: 0.739904
0.5000 --- loss: 1.690582, loss_ss: 1.125280, loss_d: 0.565302
0.5385 --- loss: 2.053489, loss_ss: 1.533448, loss_d: 0.520041
0.5769 --- loss: 1.387962, loss_ss: 1.020286, loss_d: 0.367675
0.6154 --- loss: 1.417233, loss_ss: 1.070033, loss_d: 0.347200
0.6538 --- loss: 1.569077, loss_ss: 1.125616, loss_d: 0.443461
0.6923 --- loss: 1.987715, loss_ss: 1.153920, loss_d: 0.833795
0.7308 --- loss: 1.459902, loss_ss: 1.101699, loss_d: 0.358203
0.7692 --- loss: 1.488281, loss_ss: 1.104300, loss_d: 0.383981
0.8077 --- loss: 1.642062, loss_ss: 1.172260, loss_d: 0.469802
0.8462 --- loss: 1.544715, loss_ss: 1.271376, loss_d: 0.273339
0.8846 --- loss: 2.099553, loss_ss: 1.522123, loss_d: 0.577430
0.9231 --- loss: 1.557596, loss_ss: 1.111000, loss_d: 0.446597
0.9615 --- loss: 1.550271, loss_ss: 1.017948, loss_d: 0.532323
Epoch finished! Loss: 1.747135467510886
Starting epoch 2/10.
0.0000 --- loss: 1.646123, loss_ss: 1.240863, loss_d: 0.405259
0.0385 --- loss: 1.300984, loss_ss: 1.000617, loss_d: 0.300368
0.0769 --- loss: 1.513479, loss_ss: 1.417072, loss_d: 0.096407
0.1154 --- loss: 1.071529, loss_ss: 0.907406, loss_d: 0.164123
0.1538 --- loss: 1.541656, loss_ss: 1.109004, loss_d: 0.432652
0.1923 --- loss: 1.137762, loss_ss: 1.010426, loss_d: 0.127336
0.2308 --- loss: 1.670973, loss_ss: 1.054839, loss_d: 0.616134
0.2692 --- loss: 1.357603, loss_ss: 1.063971, loss_d: 0.293632
0.3077 --- loss: 2.282804, loss_ss: 1.276945, loss_d: 1.005858
0.3462 --- loss: 1.559914, loss_ss: 1.388429, loss_d: 0.171486
0.3846 --- loss: 2.246554, loss_ss: 0.972274, loss_d: 1.274280
0.4231 --- loss: 1.485032, loss_ss: 1.241718, loss_d: 0.243314
0.4615 --- loss: 1.756603, loss_ss: 1.036470, loss_d: 0.720133
0.5000 --- loss: 1.306552, loss_ss: 1.126007, loss_d: 0.180545
0.5385 --- loss: 1.774675, loss_ss: 1.237089, loss_d: 0.537585
0.5769 --- loss: 1.161734, loss_ss: 0.959442, loss_d: 0.202292
0.6154 --- loss: 0.996959, loss_ss: 0.839087, loss_d: 0.157872
0.6538 --- loss: 1.224911, loss_ss: 0.872004, loss_d: 0.352907
0.6923 --- loss: 1.502997, loss_ss: 1.212151, loss_d: 0.290846
0.7308 --- loss: 1.035977, loss_ss: 0.939332, loss_d: 0.096645
0.7692 --- loss: 1.534555, loss_ss: 1.218050, loss_d: 0.316505
0.8077 --- loss: 0.783204, loss_ss: 0.686751, loss_d: 0.096453
0.8462 --- loss: 1.222218, loss_ss: 1.097974, loss_d: 0.124243
0.8846 --- loss: 1.369086, loss_ss: 1.140510, loss_d: 0.228576
0.9231 --- loss: 1.341317, loss_ss: 1.024843, loss_d: 0.316474
0.9615 --- loss: 1.308706, loss_ss: 0.896785, loss_d: 0.411922
Epoch finished! Loss: 1.3623726973202237
Starting epoch 3/10.
0.0000 --- loss: 1.545872, loss_ss: 1.200062, loss_d: 0.345809
0.0385 --- loss: 1.206101, loss_ss: 0.915401, loss_d: 0.290701
0.0769 --- loss: 1.231526, loss_ss: 0.919847, loss_d: 0.311679
0.1154 --- loss: 1.329525, loss_ss: 1.224051, loss_d: 0.105474
0.1538 --- loss: 1.067781, loss_ss: 0.997385, loss_d: 0.070395
0.1923 --- loss: 1.042448, loss_ss: 0.841852, loss_d: 0.200596
0.2308 --- loss: 0.965227, loss_ss: 0.901646, loss_d: 0.063581
0.2692 --- loss: 1.454222, loss_ss: 1.241609, loss_d: 0.212613
0.3077 --- loss: 1.097909, loss_ss: 1.007222, loss_d: 0.090687
0.3462 --- loss: 1.151073, loss_ss: 0.974114, loss_d: 0.176959
0.3846 --- loss: 1.217238, loss_ss: 1.048238, loss_d: 0.169000
0.4231 --- loss: 1.620950, loss_ss: 0.836180, loss_d: 0.784769
0.4615 --- loss: 1.389510, loss_ss: 0.944452, loss_d: 0.445058
0.5000 --- loss: 1.573000, loss_ss: 1.186924, loss_d: 0.386076
0.5385 --- loss: 1.050192, loss_ss: 0.859106, loss_d: 0.191086
0.5769 --- loss: 1.136631, loss_ss: 0.927735, loss_d: 0.208896
0.6154 --- loss: 1.234842, loss_ss: 0.884131, loss_d: 0.350711
0.6538 --- loss: 1.634003, loss_ss: 0.863217, loss_d: 0.770786
0.6923 --- loss: 1.371375, loss_ss: 1.262299, loss_d: 0.109077
0.7308 --- loss: 1.210588, loss_ss: 0.904544, loss_d: 0.306044
0.7692 --- loss: 1.355996, loss_ss: 1.059705, loss_d: 0.296291
0.8077 --- loss: 0.837425, loss_ss: 0.672039, loss_d: 0.165386
0.8462 --- loss: 0.901271, loss_ss: 0.764427, loss_d: 0.136844
0.8846 --- loss: 1.073569, loss_ss: 0.666444, loss_d: 0.407125
0.9231 --- loss: 0.993299, loss_ss: 0.898052, loss_d: 0.095247
0.9615 --- loss: 0.937087, loss_ss: 0.715497, loss_d: 0.221590
Epoch finished! Loss: 1.1764910140553035
Starting epoch 4/10.
0.0000 --- loss: 1.335727, loss_ss: 0.835154, loss_d: 0.500574
0.0385 --- loss: 1.109762, loss_ss: 0.864522, loss_d: 0.245240
0.0769 --- loss: 1.051513, loss_ss: 0.782273, loss_d: 0.269240
0.1154 --- loss: 1.079721, loss_ss: 0.906657, loss_d: 0.173064
0.1538 --- loss: 0.978700, loss_ss: 0.918868, loss_d: 0.059832
0.1923 --- loss: 1.419718, loss_ss: 1.100069, loss_d: 0.319649
0.2308 --- loss: 1.095784, loss_ss: 0.666721, loss_d: 0.429064
0.2692 --- loss: 1.787058, loss_ss: 1.203681, loss_d: 0.583377
0.3077 --- loss: 0.942049, loss_ss: 0.869571, loss_d: 0.072478
0.3462 --- loss: 0.894731, loss_ss: 0.792412, loss_d: 0.102319
0.3846 --- loss: 0.963071, loss_ss: 0.746058, loss_d: 0.217012
0.4231 --- loss: 1.196002, loss_ss: 1.127513, loss_d: 0.068489
0.4615 --- loss: 1.052785, loss_ss: 0.905529, loss_d: 0.147256
0.5000 --- loss: 0.869518, loss_ss: 0.816240, loss_d: 0.053278
0.5385 --- loss: 0.644348, loss_ss: 0.590831, loss_d: 0.053517
0.5769 --- loss: 0.923021, loss_ss: 0.723980, loss_d: 0.199041
0.6154 --- loss: 1.443803, loss_ss: 0.944735, loss_d: 0.499068
0.6538 --- loss: 0.672828, loss_ss: 0.644366, loss_d: 0.028462
0.6923 --- loss: 1.233898, loss_ss: 0.690311, loss_d: 0.543587
0.7308 --- loss: 1.018166, loss_ss: 0.928284, loss_d: 0.089881
0.7692 --- loss: 1.266526, loss_ss: 1.123364, loss_d: 0.143163
0.8077 --- loss: 1.160365, loss_ss: 0.850421, loss_d: 0.309945
0.8462 --- loss: 0.980282, loss_ss: 0.761280, loss_d: 0.219002
0.8846 --- loss: 0.939211, loss_ss: 0.890957, loss_d: 0.048254
0.9231 --- loss: 1.043587, loss_ss: 0.784655, loss_d: 0.258932
0.9615 --- loss: 0.965137, loss_ss: 0.775136, loss_d: 0.190001
Epoch finished! Loss: 1.0747631284260841
Starting epoch 5/10.
0.0000 --- loss: 1.057343, loss_ss: 0.797672, loss_d: 0.259671
0.0385 --- loss: 1.031164, loss_ss: 0.972192, loss_d: 0.058972
0.0769 --- loss: 1.172040, loss_ss: 0.933197, loss_d: 0.238843
0.1154 --- loss: 0.988232, loss_ss: 0.906588, loss_d: 0.081644
0.1538 --- loss: 0.918403, loss_ss: 0.824830, loss_d: 0.093573
0.1923 --- loss: 0.975077, loss_ss: 0.934619, loss_d: 0.040458
0.2308 --- loss: 0.904049, loss_ss: 0.866661, loss_d: 0.037388
0.2692 --- loss: 1.109395, loss_ss: 0.816719, loss_d: 0.292675
0.3077 --- loss: 0.930955, loss_ss: 0.821431, loss_d: 0.109524
0.3462 --- loss: 0.872040, loss_ss: 0.793403, loss_d: 0.078636
0.3846 --- loss: 0.952776, loss_ss: 0.841842, loss_d: 0.110935
0.4231 --- loss: 1.261947, loss_ss: 0.769346, loss_d: 0.492601
0.4615 --- loss: 0.853396, loss_ss: 0.788355, loss_d: 0.065041
0.5000 --- loss: 0.819568, loss_ss: 0.689443, loss_d: 0.130125
0.5385 --- loss: 0.646376, loss_ss: 0.570623, loss_d: 0.075753
0.5769 --- loss: 1.347367, loss_ss: 1.008855, loss_d: 0.338512
0.6154 --- loss: 1.058057, loss_ss: 0.792680, loss_d: 0.265377
0.6538 --- loss: 1.369046, loss_ss: 1.351524, loss_d: 0.017522
0.6923 --- loss: 1.178260, loss_ss: 1.018067, loss_d: 0.160193
0.7308 --- loss: 1.520303, loss_ss: 0.839654, loss_d: 0.680649
0.7692 --- loss: 0.750409, loss_ss: 0.709183, loss_d: 0.041226
0.8077 --- loss: 0.818143, loss_ss: 0.732834, loss_d: 0.085308
0.8462 --- loss: 0.873600, loss_ss: 0.822527, loss_d: 0.051073
0.8846 --- loss: 1.287529, loss_ss: 1.167867, loss_d: 0.119662
0.9231 --- loss: 0.893737, loss_ss: 0.690490, loss_d: 0.203247
0.9615 --- loss: 1.066414, loss_ss: 0.857389, loss_d: 0.209025
Epoch finished! Loss: 1.0353596544173693
Starting epoch 6/10.
0.0000 --- loss: 0.908566, loss_ss: 0.839381, loss_d: 0.069184
0.0385 --- loss: 0.969963, loss_ss: 0.798007, loss_d: 0.171956
0.0769 --- loss: 1.257071, loss_ss: 1.045348, loss_d: 0.211723
0.1154 --- loss: 1.617073, loss_ss: 1.063469, loss_d: 0.553604
0.1538 --- loss: 0.782806, loss_ss: 0.757552, loss_d: 0.025254
0.1923 --- loss: 0.827792, loss_ss: 0.753380, loss_d: 0.074413
0.2308 --- loss: 0.910446, loss_ss: 0.798890, loss_d: 0.111555
0.2692 --- loss: 0.823643, loss_ss: 0.801767, loss_d: 0.021876
0.3077 --- loss: 0.823298, loss_ss: 0.682573, loss_d: 0.140724
0.3462 --- loss: 0.637027, loss_ss: 0.538803, loss_d: 0.098223
0.3846 --- loss: 0.970402, loss_ss: 0.898279, loss_d: 0.072123
0.4231 --- loss: 0.911427, loss_ss: 0.894413, loss_d: 0.017015
0.4615 --- loss: 1.027097, loss_ss: 0.785492, loss_d: 0.241605
0.5000 --- loss: 0.764490, loss_ss: 0.754084, loss_d: 0.010406
0.5385 --- loss: 1.014569, loss_ss: 0.981217, loss_d: 0.033351
0.5769 --- loss: 1.020637, loss_ss: 0.821325, loss_d: 0.199312
0.6154 --- loss: 0.800900, loss_ss: 0.683126, loss_d: 0.117774
0.6538 --- loss: 0.834475, loss_ss: 0.790575, loss_d: 0.043900
0.6923 --- loss: 1.014611, loss_ss: 0.908587, loss_d: 0.106024
0.7308 --- loss: 1.093731, loss_ss: 0.786322, loss_d: 0.307409
0.7692 --- loss: 0.766313, loss_ss: 0.691234, loss_d: 0.075079
0.8077 --- loss: 0.703858, loss_ss: 0.657679, loss_d: 0.046179
0.8462 --- loss: 0.703716, loss_ss: 0.646559, loss_d: 0.057156
0.8846 --- loss: 0.995659, loss_ss: 0.965891, loss_d: 0.029769
0.9231 --- loss: 1.430662, loss_ss: 0.934776, loss_d: 0.495886
0.9615 --- loss: 1.021818, loss_ss: 0.721264, loss_d: 0.300555
Epoch finished! Loss: 0.9625299446371071
Starting epoch 7/10.
0.0000 --- loss: 0.961673, loss_ss: 0.893414, loss_d: 0.068258
0.0385 --- loss: 0.810838, loss_ss: 0.752248, loss_d: 0.058590
0.0769 --- loss: 0.663870, loss_ss: 0.534679, loss_d: 0.129191
0.1154 --- loss: 0.723266, loss_ss: 0.655241, loss_d: 0.068026
0.1538 --- loss: 0.924101, loss_ss: 0.862552, loss_d: 0.061549
0.1923 --- loss: 0.740658, loss_ss: 0.695592, loss_d: 0.045065
0.2308 --- loss: 0.672195, loss_ss: 0.644417, loss_d: 0.027778
0.2692 --- loss: 0.842703, loss_ss: 0.778166, loss_d: 0.064537
0.3077 --- loss: 1.157166, loss_ss: 1.130056, loss_d: 0.027110
0.3462 --- loss: 0.882929, loss_ss: 0.838075, loss_d: 0.044854
0.3846 --- loss: 0.912756, loss_ss: 0.771850, loss_d: 0.140906
0.4231 --- loss: 0.554469, loss_ss: 0.506781, loss_d: 0.047688
0.4615 --- loss: 0.919593, loss_ss: 0.824724, loss_d: 0.094869
0.5000 --- loss: 0.940711, loss_ss: 0.934098, loss_d: 0.006613
0.5385 --- loss: 1.061972, loss_ss: 0.798331, loss_d: 0.263641
0.5769 --- loss: 0.766870, loss_ss: 0.671160, loss_d: 0.095710
0.6154 --- loss: 0.740370, loss_ss: 0.494141, loss_d: 0.246229
0.6538 --- loss: 1.192979, loss_ss: 0.729183, loss_d: 0.463795
0.6923 --- loss: 0.758482, loss_ss: 0.655369, loss_d: 0.103113
0.7308 --- loss: 1.116818, loss_ss: 0.941363, loss_d: 0.175455
0.7692 --- loss: 1.000182, loss_ss: 0.972617, loss_d: 0.027566
0.8077 --- loss: 0.888024, loss_ss: 0.836682, loss_d: 0.051342
0.8462 --- loss: 0.787727, loss_ss: 0.698724, loss_d: 0.089003
0.8846 --- loss: 1.138547, loss_ss: 1.022905, loss_d: 0.115642
0.9231 --- loss: 0.670232, loss_ss: 0.611943, loss_d: 0.058289
0.9615 --- loss: 0.969315, loss_ss: 0.884355, loss_d: 0.084960
Epoch finished! Loss: 0.9269766156277601
Starting epoch 8/10.
0.0000 --- loss: 0.731398, loss_ss: 0.672228, loss_d: 0.059170
0.0385 --- loss: 0.833667, loss_ss: 0.808335, loss_d: 0.025331
0.0769 --- loss: 0.586867, loss_ss: 0.548995, loss_d: 0.037872
0.1154 --- loss: 0.730511, loss_ss: 0.713273, loss_d: 0.017238
0.1538 --- loss: 0.857724, loss_ss: 0.772161, loss_d: 0.085564
0.1923 --- loss: 0.995081, loss_ss: 0.622661, loss_d: 0.372420
0.2308 --- loss: 0.816900, loss_ss: 0.703017, loss_d: 0.113883
0.2692 --- loss: 0.544436, loss_ss: 0.537696, loss_d: 0.006740
0.3077 --- loss: 0.900465, loss_ss: 0.852582, loss_d: 0.047883
0.3462 --- loss: 0.979403, loss_ss: 0.948837, loss_d: 0.030566
0.3846 --- loss: 0.960738, loss_ss: 0.925730, loss_d: 0.035009
0.4231 --- loss: 1.144043, loss_ss: 0.947890, loss_d: 0.196153
0.4615 --- loss: 0.907535, loss_ss: 0.774539, loss_d: 0.132996
0.5000 --- loss: 0.599422, loss_ss: 0.566844, loss_d: 0.032578
0.5385 --- loss: 1.050215, loss_ss: 1.040336, loss_d: 0.009879
0.5769 --- loss: 0.749917, loss_ss: 0.713173, loss_d: 0.036744
0.6154 --- loss: 1.202111, loss_ss: 0.758556, loss_d: 0.443555
0.6538 --- loss: 0.786738, loss_ss: 0.668671, loss_d: 0.118067
0.6923 --- loss: 1.480573, loss_ss: 0.805464, loss_d: 0.675110
0.7308 --- loss: 1.353903, loss_ss: 1.318214, loss_d: 0.035689
0.7692 --- loss: 1.110369, loss_ss: 1.097428, loss_d: 0.012942
0.8077 --- loss: 1.689641, loss_ss: 1.113640, loss_d: 0.576001
0.8462 --- loss: 0.850717, loss_ss: 0.780737, loss_d: 0.069980
0.8846 --- loss: 0.860431, loss_ss: 0.822676, loss_d: 0.037755
0.9231 --- loss: 0.713015, loss_ss: 0.704320, loss_d: 0.008695
0.9615 --- loss: 0.842378, loss_ss: 0.704230, loss_d: 0.138148
Epoch finished! Loss: 0.887537763500766
Starting epoch 9/10.
0.0000 --- loss: 1.314177, loss_ss: 1.233823, loss_d: 0.080354
0.0385 --- loss: 0.938341, loss_ss: 0.732635, loss_d: 0.205706
0.0769 --- loss: 0.686161, loss_ss: 0.660450, loss_d: 0.025711
0.1154 --- loss: 0.668934, loss_ss: 0.615388, loss_d: 0.053546
0.1538 --- loss: 0.913508, loss_ss: 0.904935, loss_d: 0.008573
0.1923 --- loss: 0.881368, loss_ss: 0.747999, loss_d: 0.133369
0.2308 --- loss: 1.010514, loss_ss: 0.989560, loss_d: 0.020954
0.2692 --- loss: 0.679173, loss_ss: 0.428487, loss_d: 0.250685
0.3077 --- loss: 0.885425, loss_ss: 0.809623, loss_d: 0.075801
0.3462 --- loss: 0.835860, loss_ss: 0.727915, loss_d: 0.107945
0.3846 --- loss: 1.196514, loss_ss: 0.916214, loss_d: 0.280301
0.4231 --- loss: 0.936605, loss_ss: 0.751852, loss_d: 0.184754
0.4615 --- loss: 0.635158, loss_ss: 0.617721, loss_d: 0.017437
0.5000 --- loss: 0.732727, loss_ss: 0.677001, loss_d: 0.055726
0.5385 --- loss: 1.386307, loss_ss: 1.378911, loss_d: 0.007396
0.5769 --- loss: 0.828281, loss_ss: 0.673622, loss_d: 0.154659
0.6154 --- loss: 1.290905, loss_ss: 1.047896, loss_d: 0.243008
0.6538 --- loss: 0.592773, loss_ss: 0.552387, loss_d: 0.040385
0.6923 --- loss: 0.643460, loss_ss: 0.570625, loss_d: 0.072835
0.7308 --- loss: 0.732964, loss_ss: 0.724666, loss_d: 0.008298
0.7692 --- loss: 0.748294, loss_ss: 0.682340, loss_d: 0.065954
0.8077 --- loss: 0.720439, loss_ss: 0.693332, loss_d: 0.027108
0.8462 --- loss: 0.854740, loss_ss: 0.847101, loss_d: 0.007639
0.8846 --- loss: 1.065621, loss_ss: 0.652691, loss_d: 0.412931
0.9231 --- loss: 1.184542, loss_ss: 1.169792, loss_d: 0.014751
0.9615 --- loss: 0.767755, loss_ss: 0.746744, loss_d: 0.021011
Epoch finished! Loss: 0.8683310518163512
Starting epoch 10/10.
0.0000 --- loss: 0.750912, loss_ss: 0.698628, loss_d: 0.052284
0.0385 --- loss: 0.684974, loss_ss: 0.646459, loss_d: 0.038515
0.0769 --- loss: 0.987683, loss_ss: 0.578641, loss_d: 0.409042
0.1154 --- loss: 0.770835, loss_ss: 0.711653, loss_d: 0.059182
0.1538 --- loss: 0.861195, loss_ss: 0.834935, loss_d: 0.026260
0.1923 --- loss: 0.625919, loss_ss: 0.519099, loss_d: 0.106820
0.2308 --- loss: 1.005369, loss_ss: 0.954096, loss_d: 0.051274
0.2692 --- loss: 0.711734, loss_ss: 0.703350, loss_d: 0.008384
0.3077 --- loss: 1.005417, loss_ss: 0.705025, loss_d: 0.300392
0.3462 --- loss: 0.872365, loss_ss: 0.778055, loss_d: 0.094310
0.3846 --- loss: 1.068896, loss_ss: 0.931951, loss_d: 0.136945
0.4231 --- loss: 0.735321, loss_ss: 0.726412, loss_d: 0.008909
0.4615 --- loss: 1.158468, loss_ss: 0.971185, loss_d: 0.187283
0.5000 --- loss: 0.915108, loss_ss: 0.893975, loss_d: 0.021133
0.5385 --- loss: 0.885556, loss_ss: 0.834584, loss_d: 0.050971
0.5769 --- loss: 0.717514, loss_ss: 0.683511, loss_d: 0.034002
0.6154 --- loss: 0.619184, loss_ss: 0.581954, loss_d: 0.037230
0.6538 --- loss: 1.114948, loss_ss: 0.687574, loss_d: 0.427374
0.6923 --- loss: 0.888238, loss_ss: 0.852979, loss_d: 0.035258
0.7308 --- loss: 1.689438, loss_ss: 0.749162, loss_d: 0.940275
0.7692 --- loss: 0.659441, loss_ss: 0.580110, loss_d: 0.079331
0.8077 --- loss: 0.687331, loss_ss: 0.547766, loss_d: 0.139565
0.8462 --- loss: 0.614731, loss_ss: 0.597967, loss_d: 0.016763
0.8846 --- loss: 0.697273, loss_ss: 0.633906, loss_d: 0.063367
0.9231 --- loss: 1.137686, loss_ss: 0.745876, loss_d: 0.391811
0.9615 --- loss: 0.955685, loss_ss: 0.869457, loss_d: 0.086228
Epoch finished! Loss: 0.8347051881224953
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5824561403508772
             precision    recall  f1-score   support

        0.0       0.94      0.60      0.73       297
        1.0       0.44      0.13      0.20       200
        2.0       0.61      0.96      0.75       354
        3.0       1.00      0.06      0.11       159
        4.0       0.34      0.86      0.49       130

avg / total       0.69      0.58      0.53      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.42  59.60   98.58   93.65     72.84
1  81.84  13.00   96.49   44.07     20.08
2  79.65  96.05   72.26   60.93     74.56
3  86.84   5.66  100.00  100.00     10.71
4  79.74  86.15   78.91   34.46     49.23
Total accuracy: 58.25%
Average sen: 52.09%
Average spec: 89.25%
Macro f1-score: 45.48%
Diagnosis acc on 15mins: 1.0
[0.99882096 0.99872619 0.9982639  0.99995768 0.99999189 0.99849057
 0.99955791 0.9995988  0.9998529  0.99998879 0.99999928 0.9999795
 1.         0.99999809 0.99763179 0.99825734 0.99999499 0.99998581
 0.99999976 1.         1.         0.9999975  0.99987054 0.99766266
 0.96400535 0.9998191  0.99964225 0.99975151 0.99915862 0.99999523
 0.99998665 0.99999988 1.         0.99999702 0.99897671 0.99805236
 0.9998579  0.99978751]
pred: 0.9985699198747936, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.374451, loss_ss: 1.639210, loss_d: 0.735241
0.0385 --- loss: 2.182855, loss_ss: 1.470075, loss_d: 0.712780
0.0770 --- loss: 2.185986, loss_ss: 1.496256, loss_d: 0.689730
0.1156 --- loss: 2.390440, loss_ss: 1.377033, loss_d: 1.013408
0.1541 --- loss: 2.066223, loss_ss: 1.501759, loss_d: 0.564464
0.1926 --- loss: 1.849338, loss_ss: 1.304780, loss_d: 0.544558
0.2311 --- loss: 1.879849, loss_ss: 1.396973, loss_d: 0.482876
0.2696 --- loss: 1.672170, loss_ss: 1.371369, loss_d: 0.300801
0.3082 --- loss: 1.909437, loss_ss: 1.362036, loss_d: 0.547402
0.3467 --- loss: 2.358401, loss_ss: 1.207878, loss_d: 1.150523
0.3852 --- loss: 1.977077, loss_ss: 1.215931, loss_d: 0.761146
0.4237 --- loss: 1.849992, loss_ss: 1.330008, loss_d: 0.519984
0.4622 --- loss: 1.960531, loss_ss: 1.255682, loss_d: 0.704849
0.5008 --- loss: 2.012094, loss_ss: 1.188824, loss_d: 0.823270
0.5393 --- loss: 1.541175, loss_ss: 1.093755, loss_d: 0.447420
0.5778 --- loss: 1.951122, loss_ss: 1.344379, loss_d: 0.606743
0.6163 --- loss: 1.561989, loss_ss: 1.122060, loss_d: 0.439929
0.6549 --- loss: 1.638105, loss_ss: 1.092193, loss_d: 0.545912
0.6934 --- loss: 1.679140, loss_ss: 1.143881, loss_d: 0.535259
0.7319 --- loss: 1.544171, loss_ss: 1.130286, loss_d: 0.413885
0.7704 --- loss: 1.816359, loss_ss: 1.329134, loss_d: 0.487226
0.8089 --- loss: 1.800113, loss_ss: 1.165851, loss_d: 0.634263
0.8475 --- loss: 1.509829, loss_ss: 0.996855, loss_d: 0.512974
0.8860 --- loss: 1.345680, loss_ss: 1.118167, loss_d: 0.227513
0.9245 --- loss: 1.528177, loss_ss: 0.963973, loss_d: 0.564204
0.9630 --- loss: 1.536447, loss_ss: 1.094489, loss_d: 0.441958
Epoch finished! Loss: 1.8137388675829618
Starting epoch 2/10.
0.0000 --- loss: 1.372733, loss_ss: 1.039319, loss_d: 0.333414
0.0385 --- loss: 1.192300, loss_ss: 0.974795, loss_d: 0.217505
0.0770 --- loss: 1.487109, loss_ss: 0.972525, loss_d: 0.514584
0.1156 --- loss: 2.022758, loss_ss: 0.921106, loss_d: 1.101651
0.1541 --- loss: 1.405505, loss_ss: 1.012656, loss_d: 0.392849
0.1926 --- loss: 1.634033, loss_ss: 1.196973, loss_d: 0.437059
0.2311 --- loss: 1.816835, loss_ss: 1.041532, loss_d: 0.775303
0.2696 --- loss: 1.415086, loss_ss: 0.996650, loss_d: 0.418436
0.3082 --- loss: 1.435377, loss_ss: 1.205469, loss_d: 0.229908
0.3467 --- loss: 1.228041, loss_ss: 1.137383, loss_d: 0.090658
0.3852 --- loss: 1.106466, loss_ss: 0.894219, loss_d: 0.212247
0.4237 --- loss: 1.310774, loss_ss: 1.095105, loss_d: 0.215669
0.4622 --- loss: 1.593972, loss_ss: 1.104837, loss_d: 0.489135
0.5008 --- loss: 1.439154, loss_ss: 1.023931, loss_d: 0.415223
0.5393 --- loss: 1.019150, loss_ss: 0.883891, loss_d: 0.135259
0.5778 --- loss: 1.613593, loss_ss: 1.300896, loss_d: 0.312697
0.6163 --- loss: 1.239468, loss_ss: 1.045540, loss_d: 0.193928
0.6549 --- loss: 1.215528, loss_ss: 0.932578, loss_d: 0.282950
0.6934 --- loss: 1.394980, loss_ss: 0.853088, loss_d: 0.541892
0.7319 --- loss: 1.063044, loss_ss: 0.868745, loss_d: 0.194299
0.7704 --- loss: 1.133832, loss_ss: 1.053691, loss_d: 0.080142
0.8089 --- loss: 1.218084, loss_ss: 0.902374, loss_d: 0.315710
0.8475 --- loss: 1.223863, loss_ss: 0.958821, loss_d: 0.265042
0.8860 --- loss: 1.359644, loss_ss: 0.991914, loss_d: 0.367730
0.9245 --- loss: 1.727817, loss_ss: 1.086630, loss_d: 0.641187
0.9630 --- loss: 0.959575, loss_ss: 0.851761, loss_d: 0.107814
Epoch finished! Loss: 1.3530274634195572
Starting epoch 3/10.
0.0000 --- loss: 0.970232, loss_ss: 0.878868, loss_d: 0.091364
0.0385 --- loss: 1.146620, loss_ss: 1.050020, loss_d: 0.096600
0.0770 --- loss: 1.441226, loss_ss: 0.993498, loss_d: 0.447728
0.1156 --- loss: 1.505919, loss_ss: 0.980921, loss_d: 0.524998
0.1541 --- loss: 1.014722, loss_ss: 0.890962, loss_d: 0.123760
0.1926 --- loss: 0.824460, loss_ss: 0.698827, loss_d: 0.125633
0.2311 --- loss: 2.091338, loss_ss: 0.974716, loss_d: 1.116622
0.2696 --- loss: 1.319552, loss_ss: 1.254323, loss_d: 0.065228
0.3082 --- loss: 1.072355, loss_ss: 0.822438, loss_d: 0.249917
0.3467 --- loss: 1.311397, loss_ss: 1.119362, loss_d: 0.192035
0.3852 --- loss: 1.077317, loss_ss: 0.767686, loss_d: 0.309630
0.4237 --- loss: 1.007426, loss_ss: 0.847302, loss_d: 0.160124
0.4622 --- loss: 1.216539, loss_ss: 1.139607, loss_d: 0.076932
0.5008 --- loss: 1.441079, loss_ss: 0.869848, loss_d: 0.571231
0.5393 --- loss: 1.087382, loss_ss: 0.768332, loss_d: 0.319049
0.5778 --- loss: 0.981623, loss_ss: 0.856631, loss_d: 0.124992
0.6163 --- loss: 1.107172, loss_ss: 0.936066, loss_d: 0.171106
0.6549 --- loss: 1.271283, loss_ss: 0.844300, loss_d: 0.426983
0.6934 --- loss: 1.167748, loss_ss: 1.016662, loss_d: 0.151085
0.7319 --- loss: 1.267848, loss_ss: 1.044071, loss_d: 0.223777
0.7704 --- loss: 0.989781, loss_ss: 0.923257, loss_d: 0.066525
0.8089 --- loss: 1.312513, loss_ss: 1.156521, loss_d: 0.155992
0.8475 --- loss: 1.219307, loss_ss: 0.711910, loss_d: 0.507397
0.8860 --- loss: 1.278313, loss_ss: 0.788853, loss_d: 0.489460
0.9245 --- loss: 1.308281, loss_ss: 0.933581, loss_d: 0.374700
0.9630 --- loss: 1.173813, loss_ss: 0.758532, loss_d: 0.415281
Epoch finished! Loss: 1.157250101732011
Starting epoch 4/10.
0.0000 --- loss: 1.042623, loss_ss: 0.796069, loss_d: 0.246554
0.0385 --- loss: 1.077994, loss_ss: 0.936711, loss_d: 0.141283
0.0770 --- loss: 0.724986, loss_ss: 0.696547, loss_d: 0.028439
0.1156 --- loss: 1.228545, loss_ss: 1.106889, loss_d: 0.121656
0.1541 --- loss: 1.455356, loss_ss: 0.797777, loss_d: 0.657579
0.1926 --- loss: 1.074172, loss_ss: 0.668126, loss_d: 0.406045
0.2311 --- loss: 1.038298, loss_ss: 0.930098, loss_d: 0.108200
0.2696 --- loss: 0.904619, loss_ss: 0.830150, loss_d: 0.074469
0.3082 --- loss: 1.696340, loss_ss: 0.971567, loss_d: 0.724773
0.3467 --- loss: 1.240038, loss_ss: 0.889798, loss_d: 0.350241
0.3852 --- loss: 1.153202, loss_ss: 1.060046, loss_d: 0.093156
0.4237 --- loss: 1.860336, loss_ss: 0.607915, loss_d: 1.252421
0.4622 --- loss: 1.381358, loss_ss: 0.745087, loss_d: 0.636271
0.5008 --- loss: 0.836237, loss_ss: 0.780728, loss_d: 0.055510
0.5393 --- loss: 0.919618, loss_ss: 0.839605, loss_d: 0.080013
0.5778 --- loss: 0.771299, loss_ss: 0.631880, loss_d: 0.139419
0.6163 --- loss: 0.841492, loss_ss: 0.792581, loss_d: 0.048911
0.6549 --- loss: 1.069904, loss_ss: 0.898841, loss_d: 0.171063
0.6934 --- loss: 0.857376, loss_ss: 0.738063, loss_d: 0.119313
0.7319 --- loss: 1.131366, loss_ss: 1.079354, loss_d: 0.052012
0.7704 --- loss: 1.244823, loss_ss: 0.831457, loss_d: 0.413366
0.8089 --- loss: 1.023676, loss_ss: 0.831945, loss_d: 0.191731
0.8475 --- loss: 1.351808, loss_ss: 1.001249, loss_d: 0.350559
0.8860 --- loss: 0.934801, loss_ss: 0.720130, loss_d: 0.214671
0.9245 --- loss: 1.148937, loss_ss: 0.859573, loss_d: 0.289363
0.9630 --- loss: 0.997929, loss_ss: 0.874016, loss_d: 0.123913
Epoch finished! Loss: 1.0654471514307855
Starting epoch 5/10.
0.0000 --- loss: 0.926579, loss_ss: 0.873254, loss_d: 0.053325
0.0385 --- loss: 0.878311, loss_ss: 0.758746, loss_d: 0.119565
0.0770 --- loss: 0.860090, loss_ss: 0.827784, loss_d: 0.032306
0.1156 --- loss: 0.874339, loss_ss: 0.805224, loss_d: 0.069115
0.1541 --- loss: 1.323215, loss_ss: 1.130844, loss_d: 0.192370
0.1926 --- loss: 0.960903, loss_ss: 0.904814, loss_d: 0.056089
0.2311 --- loss: 1.224578, loss_ss: 0.858595, loss_d: 0.365983
0.2696 --- loss: 1.020928, loss_ss: 0.799804, loss_d: 0.221124
0.3082 --- loss: 0.782240, loss_ss: 0.654058, loss_d: 0.128181
0.3467 --- loss: 0.868670, loss_ss: 0.571067, loss_d: 0.297603
0.3852 --- loss: 1.015981, loss_ss: 0.990614, loss_d: 0.025367
0.4237 --- loss: 0.892754, loss_ss: 0.839776, loss_d: 0.052978
0.4622 --- loss: 0.914332, loss_ss: 0.615427, loss_d: 0.298904
0.5008 --- loss: 0.754294, loss_ss: 0.688099, loss_d: 0.066194
0.5393 --- loss: 0.914032, loss_ss: 0.718291, loss_d: 0.195741
0.5778 --- loss: 0.918984, loss_ss: 0.683787, loss_d: 0.235197
0.6163 --- loss: 0.839495, loss_ss: 0.764140, loss_d: 0.075355
0.6549 --- loss: 0.961099, loss_ss: 0.740044, loss_d: 0.221055
0.6934 --- loss: 1.035111, loss_ss: 0.690297, loss_d: 0.344814
0.7319 --- loss: 1.015150, loss_ss: 0.785779, loss_d: 0.229370
0.7704 --- loss: 0.576847, loss_ss: 0.518763, loss_d: 0.058085
0.8089 --- loss: 0.934366, loss_ss: 0.794604, loss_d: 0.139761
0.8475 --- loss: 0.673442, loss_ss: 0.614860, loss_d: 0.058582
0.8860 --- loss: 1.156184, loss_ss: 0.869160, loss_d: 0.287024
0.9245 --- loss: 0.666088, loss_ss: 0.652501, loss_d: 0.013587
0.9630 --- loss: 0.880985, loss_ss: 0.705266, loss_d: 0.175719
Epoch finished! Loss: 0.9690384735932221
Starting epoch 6/10.
0.0000 --- loss: 0.748320, loss_ss: 0.706598, loss_d: 0.041722
0.0385 --- loss: 0.898637, loss_ss: 0.597261, loss_d: 0.301376
0.0770 --- loss: 0.860875, loss_ss: 0.842490, loss_d: 0.018386
0.1156 --- loss: 1.205693, loss_ss: 0.591363, loss_d: 0.614330
0.1541 --- loss: 0.690997, loss_ss: 0.627657, loss_d: 0.063340
0.1926 --- loss: 0.761426, loss_ss: 0.733553, loss_d: 0.027873
0.2311 --- loss: 2.005376, loss_ss: 0.583584, loss_d: 1.421792
0.2696 --- loss: 0.928900, loss_ss: 0.905922, loss_d: 0.022978
0.3082 --- loss: 0.856670, loss_ss: 0.819237, loss_d: 0.037433
0.3467 --- loss: 0.887730, loss_ss: 0.848731, loss_d: 0.038999
0.3852 --- loss: 1.219273, loss_ss: 0.901626, loss_d: 0.317647
0.4237 --- loss: 0.847440, loss_ss: 0.826762, loss_d: 0.020678
0.4622 --- loss: 0.693473, loss_ss: 0.655589, loss_d: 0.037884
0.5008 --- loss: 1.058774, loss_ss: 0.868150, loss_d: 0.190624
0.5393 --- loss: 0.555767, loss_ss: 0.535199, loss_d: 0.020568
0.5778 --- loss: 0.817986, loss_ss: 0.724608, loss_d: 0.093378
0.6163 --- loss: 1.014241, loss_ss: 0.778888, loss_d: 0.235354
0.6549 --- loss: 0.797202, loss_ss: 0.767938, loss_d: 0.029264
0.6934 --- loss: 0.991542, loss_ss: 0.890947, loss_d: 0.100595
0.7319 --- loss: 0.720648, loss_ss: 0.700364, loss_d: 0.020284
0.7704 --- loss: 0.773805, loss_ss: 0.670843, loss_d: 0.102962
0.8089 --- loss: 0.770287, loss_ss: 0.640298, loss_d: 0.129989
0.8475 --- loss: 0.644209, loss_ss: 0.627642, loss_d: 0.016567
0.8860 --- loss: 0.799636, loss_ss: 0.777124, loss_d: 0.022512
0.9245 --- loss: 1.169239, loss_ss: 0.727449, loss_d: 0.441789
0.9630 --- loss: 1.179920, loss_ss: 0.992704, loss_d: 0.187216
Epoch finished! Loss: 0.926314570153542
Starting epoch 7/10.
0.0000 --- loss: 1.262196, loss_ss: 1.013193, loss_d: 0.249003
0.0385 --- loss: 0.805321, loss_ss: 0.792085, loss_d: 0.013235
0.0770 --- loss: 0.984717, loss_ss: 0.894381, loss_d: 0.090336
0.1156 --- loss: 1.223022, loss_ss: 1.023942, loss_d: 0.199080
0.1541 --- loss: 0.843709, loss_ss: 0.677947, loss_d: 0.165763
0.1926 --- loss: 0.810230, loss_ss: 0.656440, loss_d: 0.153790
0.2311 --- loss: 0.828022, loss_ss: 0.743051, loss_d: 0.084971
0.2696 --- loss: 0.777465, loss_ss: 0.765108, loss_d: 0.012357
0.3082 --- loss: 0.864052, loss_ss: 0.837261, loss_d: 0.026791
0.3467 --- loss: 0.818011, loss_ss: 0.808889, loss_d: 0.009122
0.3852 --- loss: 0.987659, loss_ss: 0.671015, loss_d: 0.316644
0.4237 --- loss: 0.973153, loss_ss: 0.920574, loss_d: 0.052579
0.4622 --- loss: 0.607980, loss_ss: 0.586657, loss_d: 0.021323
0.5008 --- loss: 0.833919, loss_ss: 0.820549, loss_d: 0.013370
0.5393 --- loss: 1.122465, loss_ss: 0.912241, loss_d: 0.210224
0.5778 --- loss: 1.197690, loss_ss: 0.941096, loss_d: 0.256595
0.6163 --- loss: 1.265615, loss_ss: 0.916238, loss_d: 0.349377
0.6549 --- loss: 0.833700, loss_ss: 0.659576, loss_d: 0.174124
0.6934 --- loss: 0.778799, loss_ss: 0.598917, loss_d: 0.179882
0.7319 --- loss: 0.740033, loss_ss: 0.667813, loss_d: 0.072220
0.7704 --- loss: 0.783156, loss_ss: 0.745479, loss_d: 0.037677
0.8089 --- loss: 1.062506, loss_ss: 0.649615, loss_d: 0.412891
0.8475 --- loss: 0.781415, loss_ss: 0.770799, loss_d: 0.010615
0.8860 --- loss: 0.781605, loss_ss: 0.730164, loss_d: 0.051440
0.9245 --- loss: 1.057996, loss_ss: 0.858955, loss_d: 0.199041
0.9630 --- loss: 0.704749, loss_ss: 0.550648, loss_d: 0.154101
Epoch finished! Loss: 0.9194973716404448
Starting epoch 8/10.
0.0000 --- loss: 1.078724, loss_ss: 1.065192, loss_d: 0.013532
0.0385 --- loss: 0.876238, loss_ss: 0.825794, loss_d: 0.050444
0.0770 --- loss: 0.690053, loss_ss: 0.670609, loss_d: 0.019445
0.1156 --- loss: 0.759686, loss_ss: 0.686949, loss_d: 0.072737
0.1541 --- loss: 0.915016, loss_ss: 0.911363, loss_d: 0.003653
0.1926 --- loss: 1.390930, loss_ss: 0.713207, loss_d: 0.677724
0.2311 --- loss: 1.496133, loss_ss: 0.608475, loss_d: 0.887658
0.2696 --- loss: 1.049904, loss_ss: 0.639765, loss_d: 0.410139
0.3082 --- loss: 1.017586, loss_ss: 0.638731, loss_d: 0.378855
0.3467 --- loss: 1.008859, loss_ss: 0.849458, loss_d: 0.159401
0.3852 --- loss: 0.671654, loss_ss: 0.631077, loss_d: 0.040577
0.4237 --- loss: 0.796040, loss_ss: 0.760729, loss_d: 0.035311
0.4622 --- loss: 1.003830, loss_ss: 0.860862, loss_d: 0.142968
0.5008 --- loss: 0.724448, loss_ss: 0.588034, loss_d: 0.136413
0.5393 --- loss: 0.810833, loss_ss: 0.783605, loss_d: 0.027228
0.5778 --- loss: 0.897059, loss_ss: 0.874411, loss_d: 0.022647
0.6163 --- loss: 1.413139, loss_ss: 1.372067, loss_d: 0.041072
0.6549 --- loss: 0.566473, loss_ss: 0.534753, loss_d: 0.031720
0.6934 --- loss: 1.032869, loss_ss: 1.006301, loss_d: 0.026568
0.7319 --- loss: 0.791865, loss_ss: 0.778619, loss_d: 0.013246
0.7704 --- loss: 0.880698, loss_ss: 0.872845, loss_d: 0.007853
0.8089 --- loss: 0.628063, loss_ss: 0.620227, loss_d: 0.007837
0.8475 --- loss: 1.378185, loss_ss: 0.815578, loss_d: 0.562607
0.8860 --- loss: 1.137052, loss_ss: 0.910560, loss_d: 0.226491
0.9245 --- loss: 1.004011, loss_ss: 0.978165, loss_d: 0.025846
0.9630 --- loss: 0.697203, loss_ss: 0.686324, loss_d: 0.010879
Epoch finished! Loss: 0.8873110133938807
Starting epoch 9/10.
0.0000 --- loss: 0.860703, loss_ss: 0.640362, loss_d: 0.220341
0.0385 --- loss: 0.708870, loss_ss: 0.686254, loss_d: 0.022616
0.0770 --- loss: 0.777076, loss_ss: 0.617932, loss_d: 0.159144
0.1156 --- loss: 0.754526, loss_ss: 0.509847, loss_d: 0.244679
0.1541 --- loss: 0.924800, loss_ss: 0.896016, loss_d: 0.028785
0.1926 --- loss: 0.606555, loss_ss: 0.536244, loss_d: 0.070311
0.2311 --- loss: 0.725751, loss_ss: 0.671612, loss_d: 0.054139
0.2696 --- loss: 0.748658, loss_ss: 0.744344, loss_d: 0.004314
0.3082 --- loss: 0.837821, loss_ss: 0.830643, loss_d: 0.007178
0.3467 --- loss: 0.767299, loss_ss: 0.689831, loss_d: 0.077468
0.3852 --- loss: 1.441623, loss_ss: 0.775029, loss_d: 0.666594
0.4237 --- loss: 0.853669, loss_ss: 0.822803, loss_d: 0.030867
0.4622 --- loss: 0.997583, loss_ss: 0.765965, loss_d: 0.231618
0.5008 --- loss: 0.694760, loss_ss: 0.674010, loss_d: 0.020750
0.5393 --- loss: 0.915543, loss_ss: 0.903828, loss_d: 0.011715
0.5778 --- loss: 0.733667, loss_ss: 0.727432, loss_d: 0.006236
0.6163 --- loss: 0.602508, loss_ss: 0.590786, loss_d: 0.011722
0.6549 --- loss: 0.754027, loss_ss: 0.710139, loss_d: 0.043889
0.6934 --- loss: 0.767097, loss_ss: 0.757573, loss_d: 0.009524
0.7319 --- loss: 0.690375, loss_ss: 0.657043, loss_d: 0.033332
0.7704 --- loss: 0.737604, loss_ss: 0.731348, loss_d: 0.006256
0.8089 --- loss: 0.839362, loss_ss: 0.834828, loss_d: 0.004534
0.8475 --- loss: 0.965064, loss_ss: 0.851223, loss_d: 0.113840
0.8860 --- loss: 1.253463, loss_ss: 0.794172, loss_d: 0.459292
0.9245 --- loss: 1.191390, loss_ss: 1.034967, loss_d: 0.156423
0.9630 --- loss: 0.934321, loss_ss: 0.789186, loss_d: 0.145135
Epoch finished! Loss: 0.849174375699754
Starting epoch 10/10.
0.0000 --- loss: 0.575246, loss_ss: 0.562244, loss_d: 0.013002
0.0385 --- loss: 0.731542, loss_ss: 0.647250, loss_d: 0.084293
0.0770 --- loss: 0.846048, loss_ss: 0.837430, loss_d: 0.008618
0.1156 --- loss: 0.540939, loss_ss: 0.535458, loss_d: 0.005481
0.1541 --- loss: 0.972346, loss_ss: 0.949891, loss_d: 0.022456
0.1926 --- loss: 0.795625, loss_ss: 0.773387, loss_d: 0.022238
0.2311 --- loss: 0.654392, loss_ss: 0.616027, loss_d: 0.038364
0.2696 --- loss: 0.954805, loss_ss: 0.938762, loss_d: 0.016043
0.3082 --- loss: 0.686801, loss_ss: 0.640290, loss_d: 0.046511
0.3467 --- loss: 0.789011, loss_ss: 0.545779, loss_d: 0.243232
0.3852 --- loss: 1.415103, loss_ss: 0.789549, loss_d: 0.625554
0.4237 --- loss: 0.695253, loss_ss: 0.626921, loss_d: 0.068332
0.4622 --- loss: 0.730304, loss_ss: 0.700820, loss_d: 0.029484
0.5008 --- loss: 0.593463, loss_ss: 0.549360, loss_d: 0.044103
0.5393 --- loss: 1.006775, loss_ss: 0.693096, loss_d: 0.313679
0.5778 --- loss: 0.562856, loss_ss: 0.561853, loss_d: 0.001003
0.6163 --- loss: 0.837095, loss_ss: 0.812613, loss_d: 0.024482
0.6549 --- loss: 0.606555, loss_ss: 0.603693, loss_d: 0.002863
0.6934 --- loss: 0.485291, loss_ss: 0.480791, loss_d: 0.004499
0.7319 --- loss: 0.933972, loss_ss: 0.918485, loss_d: 0.015487
0.7704 --- loss: 0.839076, loss_ss: 0.831500, loss_d: 0.007576
0.8089 --- loss: 0.596325, loss_ss: 0.585097, loss_d: 0.011229
0.8475 --- loss: 0.915545, loss_ss: 0.765698, loss_d: 0.149846
0.8860 --- loss: 0.660427, loss_ss: 0.543041, loss_d: 0.117387
0.9245 --- loss: 0.650879, loss_ss: 0.635187, loss_d: 0.015692
0.9630 --- loss: 0.777767, loss_ss: 0.665157, loss_d: 0.112610
Epoch finished! Loss: 0.81869364118484
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.546031746031746
             precision    recall  f1-score   support

        0.0       0.49      0.95      0.65       253
        1.0       0.29      0.18      0.22       293
        2.0       0.82      0.58      0.68       468
        3.0       0.81      0.68      0.74       107
        4.0       0.31      0.37      0.34       139

avg / total       0.57      0.55      0.53      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  79.52  94.86   75.67  49.48     65.04
1  70.32  18.43   86.04  28.57     22.41
2  79.44  57.69   92.30  81.57     67.58
3  95.95  68.22   98.53  81.11     74.11
4  83.97  36.69   89.83  30.91     33.55
Total accuracy: 54.60%
Average sen: 55.18%
Average spec: 88.47%
Macro f1-score: 52.54%
Diagnosis acc on 15mins: 1.0
[0.99999976 0.99999845 0.99999988 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         0.99999988 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.        ]
pred: 0.9999999517486209, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.337094, loss_ss: 1.652194, loss_d: 0.684900
0.0384 --- loss: 2.044779, loss_ss: 1.465995, loss_d: 0.578784
0.0769 --- loss: 2.210109, loss_ss: 1.507954, loss_d: 0.702155
0.1153 --- loss: 2.232569, loss_ss: 1.354315, loss_d: 0.878254
0.1538 --- loss: 2.391826, loss_ss: 1.502288, loss_d: 0.889537
0.1922 --- loss: 2.145653, loss_ss: 1.482718, loss_d: 0.662936
0.2307 --- loss: 2.220583, loss_ss: 1.423897, loss_d: 0.796686
0.2691 --- loss: 1.987273, loss_ss: 1.309933, loss_d: 0.677341
0.3076 --- loss: 1.825557, loss_ss: 1.331113, loss_d: 0.494444
0.3460 --- loss: 1.907921, loss_ss: 1.402689, loss_d: 0.505232
0.3845 --- loss: 1.954584, loss_ss: 1.252968, loss_d: 0.701616
0.4229 --- loss: 1.820321, loss_ss: 1.318535, loss_d: 0.501786
0.4614 --- loss: 1.619691, loss_ss: 1.229407, loss_d: 0.390284
0.4998 --- loss: 1.734777, loss_ss: 1.271424, loss_d: 0.463353
0.5383 --- loss: 1.627737, loss_ss: 1.213842, loss_d: 0.413894
0.5767 --- loss: 1.859624, loss_ss: 1.379749, loss_d: 0.479875
0.6151 --- loss: 1.743414, loss_ss: 1.270230, loss_d: 0.473185
0.6536 --- loss: 1.782959, loss_ss: 1.219653, loss_d: 0.563306
0.6920 --- loss: 1.468303, loss_ss: 1.059259, loss_d: 0.409044
0.7305 --- loss: 1.845369, loss_ss: 1.119416, loss_d: 0.725953
0.7689 --- loss: 1.946930, loss_ss: 1.225884, loss_d: 0.721046
0.8074 --- loss: 1.539139, loss_ss: 1.160743, loss_d: 0.378396
0.8458 --- loss: 1.389776, loss_ss: 1.092764, loss_d: 0.297012
0.8843 --- loss: 1.411856, loss_ss: 1.113747, loss_d: 0.298110
0.9227 --- loss: 1.972014, loss_ss: 1.343472, loss_d: 0.628543
0.9612 --- loss: 1.460923, loss_ss: 1.132807, loss_d: 0.328116
0.9996 --- loss: 3.376991, loss_ss: 1.453607, loss_d: 1.923384
Epoch finished! Loss: 1.8752086621064405
Starting epoch 2/10.
0.0000 --- loss: 1.716406, loss_ss: 1.264944, loss_d: 0.451462
0.0384 --- loss: 1.435287, loss_ss: 0.993002, loss_d: 0.442286
0.0769 --- loss: 1.469304, loss_ss: 0.996268, loss_d: 0.473036
0.1153 --- loss: 1.816293, loss_ss: 1.382465, loss_d: 0.433828
0.1538 --- loss: 1.726857, loss_ss: 1.067237, loss_d: 0.659620
0.1922 --- loss: 1.504237, loss_ss: 0.982180, loss_d: 0.522057
0.2307 --- loss: 2.062635, loss_ss: 0.927104, loss_d: 1.135531
0.2691 --- loss: 1.586875, loss_ss: 1.241849, loss_d: 0.345026
0.3076 --- loss: 1.493623, loss_ss: 1.091579, loss_d: 0.402043
0.3460 --- loss: 1.526323, loss_ss: 1.250116, loss_d: 0.276207
0.3845 --- loss: 1.171292, loss_ss: 1.008098, loss_d: 0.163194
0.4229 --- loss: 1.265061, loss_ss: 1.065659, loss_d: 0.199402
0.4614 --- loss: 1.639003, loss_ss: 1.090126, loss_d: 0.548877
0.4998 --- loss: 1.213393, loss_ss: 1.094548, loss_d: 0.118845
0.5383 --- loss: 1.192636, loss_ss: 1.017295, loss_d: 0.175340
0.5767 --- loss: 1.543406, loss_ss: 1.185319, loss_d: 0.358087
0.6151 --- loss: 1.262859, loss_ss: 0.892814, loss_d: 0.370045
0.6536 --- loss: 1.384527, loss_ss: 1.036627, loss_d: 0.347901
0.6920 --- loss: 1.376524, loss_ss: 1.238850, loss_d: 0.137674
0.7305 --- loss: 1.461272, loss_ss: 1.102552, loss_d: 0.358720
0.7689 --- loss: 1.209302, loss_ss: 0.953498, loss_d: 0.255805
0.8074 --- loss: 1.520732, loss_ss: 1.204857, loss_d: 0.315875
0.8458 --- loss: 1.146337, loss_ss: 0.910257, loss_d: 0.236079
0.8843 --- loss: 1.526762, loss_ss: 1.152307, loss_d: 0.374455
0.9227 --- loss: 1.008408, loss_ss: 0.918942, loss_d: 0.089465
0.9612 --- loss: 1.515899, loss_ss: 1.229001, loss_d: 0.286898
0.9996 --- loss: 4.875974, loss_ss: 1.235456, loss_d: 3.640518
Epoch finished! Loss: 1.4586170237797957
Starting epoch 3/10.
0.0000 --- loss: 1.024753, loss_ss: 0.939914, loss_d: 0.084840
0.0384 --- loss: 1.598980, loss_ss: 1.134720, loss_d: 0.464259
0.0769 --- loss: 1.169709, loss_ss: 1.063929, loss_d: 0.105779
0.1153 --- loss: 1.236936, loss_ss: 1.115951, loss_d: 0.120986
0.1538 --- loss: 1.006372, loss_ss: 0.767228, loss_d: 0.239144
0.1922 --- loss: 1.046097, loss_ss: 0.888535, loss_d: 0.157562
0.2307 --- loss: 1.453685, loss_ss: 1.230254, loss_d: 0.223431
0.2691 --- loss: 1.574334, loss_ss: 1.468935, loss_d: 0.105398
0.3076 --- loss: 1.210629, loss_ss: 1.000762, loss_d: 0.209866
0.3460 --- loss: 1.029412, loss_ss: 0.925039, loss_d: 0.104373
0.3845 --- loss: 1.508620, loss_ss: 0.997862, loss_d: 0.510758
0.4229 --- loss: 0.787698, loss_ss: 0.675361, loss_d: 0.112337
0.4614 --- loss: 1.527385, loss_ss: 1.132054, loss_d: 0.395331
0.4998 --- loss: 1.183698, loss_ss: 0.937349, loss_d: 0.246349
0.5383 --- loss: 1.220782, loss_ss: 1.020542, loss_d: 0.200239
0.5767 --- loss: 1.291837, loss_ss: 1.065666, loss_d: 0.226170
0.6151 --- loss: 1.608582, loss_ss: 1.122891, loss_d: 0.485690
0.6536 --- loss: 1.354852, loss_ss: 1.145312, loss_d: 0.209540
0.6920 --- loss: 1.046963, loss_ss: 0.843866, loss_d: 0.203098
0.7305 --- loss: 3.004514, loss_ss: 0.810231, loss_d: 2.194283
0.7689 --- loss: 1.144622, loss_ss: 0.991548, loss_d: 0.153074
0.8074 --- loss: 1.309037, loss_ss: 1.158239, loss_d: 0.150799
0.8458 --- loss: 1.402312, loss_ss: 1.022081, loss_d: 0.380230
0.8843 --- loss: 1.123489, loss_ss: 0.865594, loss_d: 0.257895
0.9227 --- loss: 0.926554, loss_ss: 0.833102, loss_d: 0.093452
0.9612 --- loss: 1.188940, loss_ss: 1.010060, loss_d: 0.178880
0.9996 --- loss: 1.161600, loss_ss: 1.146602, loss_d: 0.014997
Epoch finished! Loss: 1.2627440012418307
Starting epoch 4/10.
0.0000 --- loss: 1.027456, loss_ss: 0.935657, loss_d: 0.091799
0.0384 --- loss: 1.242617, loss_ss: 1.041731, loss_d: 0.200886
0.0769 --- loss: 1.468254, loss_ss: 1.026718, loss_d: 0.441536
0.1153 --- loss: 1.405687, loss_ss: 0.927116, loss_d: 0.478570
0.1538 --- loss: 1.053276, loss_ss: 0.961312, loss_d: 0.091964
0.1922 --- loss: 1.396689, loss_ss: 0.959530, loss_d: 0.437158
0.2307 --- loss: 1.443083, loss_ss: 1.328518, loss_d: 0.114565
0.2691 --- loss: 1.316295, loss_ss: 0.736958, loss_d: 0.579338
0.3076 --- loss: 0.962511, loss_ss: 0.894057, loss_d: 0.068454
0.3460 --- loss: 1.149988, loss_ss: 0.950412, loss_d: 0.199576
0.3845 --- loss: 0.870158, loss_ss: 0.812840, loss_d: 0.057318
0.4229 --- loss: 1.027153, loss_ss: 0.857313, loss_d: 0.169840
0.4614 --- loss: 1.250387, loss_ss: 1.048448, loss_d: 0.201940
0.4998 --- loss: 1.032283, loss_ss: 0.874772, loss_d: 0.157511
0.5383 --- loss: 1.059733, loss_ss: 0.851108, loss_d: 0.208625
0.5767 --- loss: 1.089037, loss_ss: 0.899636, loss_d: 0.189401
0.6151 --- loss: 1.135686, loss_ss: 0.874508, loss_d: 0.261177
0.6536 --- loss: 1.414610, loss_ss: 0.932868, loss_d: 0.481742
0.6920 --- loss: 1.302991, loss_ss: 0.801109, loss_d: 0.501881
0.7305 --- loss: 1.377993, loss_ss: 1.106706, loss_d: 0.271286
0.7689 --- loss: 1.102643, loss_ss: 0.969683, loss_d: 0.132960
0.8074 --- loss: 1.676840, loss_ss: 1.053190, loss_d: 0.623650
0.8458 --- loss: 1.145539, loss_ss: 0.864970, loss_d: 0.280569
0.8843 --- loss: 1.100463, loss_ss: 0.787415, loss_d: 0.313047
0.9227 --- loss: 1.294235, loss_ss: 1.208692, loss_d: 0.085543
0.9612 --- loss: 1.033612, loss_ss: 0.747762, loss_d: 0.285850
0.9996 --- loss: 2.326668, loss_ss: 2.293549, loss_d: 0.033119
Epoch finished! Loss: 1.1659502648390256
Starting epoch 5/10.
0.0000 --- loss: 1.053400, loss_ss: 0.912505, loss_d: 0.140894
0.0384 --- loss: 1.160540, loss_ss: 0.917209, loss_d: 0.243331
0.0769 --- loss: 1.207375, loss_ss: 0.766739, loss_d: 0.440636
0.1153 --- loss: 0.929284, loss_ss: 0.800942, loss_d: 0.128342
0.1538 --- loss: 0.795433, loss_ss: 0.723215, loss_d: 0.072218
0.1922 --- loss: 1.002451, loss_ss: 0.977194, loss_d: 0.025257
0.2307 --- loss: 0.935127, loss_ss: 0.780671, loss_d: 0.154457
0.2691 --- loss: 0.993219, loss_ss: 0.886711, loss_d: 0.106508
0.3076 --- loss: 1.053274, loss_ss: 0.979624, loss_d: 0.073650
0.3460 --- loss: 0.944159, loss_ss: 0.888845, loss_d: 0.055314
0.3845 --- loss: 0.865178, loss_ss: 0.850274, loss_d: 0.014904
0.4229 --- loss: 0.944054, loss_ss: 0.877076, loss_d: 0.066978
0.4614 --- loss: 0.981772, loss_ss: 0.850483, loss_d: 0.131289
0.4998 --- loss: 1.249190, loss_ss: 0.860647, loss_d: 0.388543
0.5383 --- loss: 1.035858, loss_ss: 1.000000, loss_d: 0.035858
0.5767 --- loss: 0.853359, loss_ss: 0.669383, loss_d: 0.183976
0.6151 --- loss: 0.778590, loss_ss: 0.681111, loss_d: 0.097479
0.6536 --- loss: 0.927271, loss_ss: 0.835142, loss_d: 0.092128
0.6920 --- loss: 1.128118, loss_ss: 0.979043, loss_d: 0.149075
0.7305 --- loss: 0.831244, loss_ss: 0.806942, loss_d: 0.024302
0.7689 --- loss: 1.768487, loss_ss: 1.142403, loss_d: 0.626085
0.8074 --- loss: 0.818772, loss_ss: 0.763536, loss_d: 0.055236
0.8458 --- loss: 1.184696, loss_ss: 1.173608, loss_d: 0.011088
0.8843 --- loss: 1.078817, loss_ss: 1.018244, loss_d: 0.060573
0.9227 --- loss: 0.985488, loss_ss: 0.828932, loss_d: 0.156556
0.9612 --- loss: 0.754190, loss_ss: 0.740150, loss_d: 0.014040
0.9996 --- loss: 6.491766, loss_ss: 2.025113, loss_d: 4.466654
Epoch finished! Loss: 1.0727766905839626
Starting epoch 6/10.
0.0000 --- loss: 0.748199, loss_ss: 0.643562, loss_d: 0.104637
0.0384 --- loss: 0.947829, loss_ss: 0.743521, loss_d: 0.204308
0.0769 --- loss: 1.004611, loss_ss: 0.916409, loss_d: 0.088202
0.1153 --- loss: 0.882338, loss_ss: 0.806304, loss_d: 0.076034
0.1538 --- loss: 0.810139, loss_ss: 0.740362, loss_d: 0.069776
0.1922 --- loss: 0.925810, loss_ss: 0.812301, loss_d: 0.113509
0.2307 --- loss: 0.745625, loss_ss: 0.678551, loss_d: 0.067075
0.2691 --- loss: 0.985862, loss_ss: 0.717665, loss_d: 0.268197
0.3076 --- loss: 1.183901, loss_ss: 0.861429, loss_d: 0.322472
0.3460 --- loss: 0.936056, loss_ss: 0.916141, loss_d: 0.019915
0.3845 --- loss: 0.889235, loss_ss: 0.777866, loss_d: 0.111369
0.4229 --- loss: 1.139429, loss_ss: 0.843519, loss_d: 0.295909
0.4614 --- loss: 1.010394, loss_ss: 0.822461, loss_d: 0.187932
0.4998 --- loss: 0.905577, loss_ss: 0.732861, loss_d: 0.172716
0.5383 --- loss: 0.833043, loss_ss: 0.774420, loss_d: 0.058623
0.5767 --- loss: 1.420655, loss_ss: 0.928404, loss_d: 0.492251
0.6151 --- loss: 0.785911, loss_ss: 0.677535, loss_d: 0.108376
0.6536 --- loss: 0.947502, loss_ss: 0.782604, loss_d: 0.164899
0.6920 --- loss: 0.572020, loss_ss: 0.530554, loss_d: 0.041465
0.7305 --- loss: 0.959056, loss_ss: 0.902102, loss_d: 0.056954
0.7689 --- loss: 0.663878, loss_ss: 0.567320, loss_d: 0.096558
0.8074 --- loss: 1.071036, loss_ss: 0.914532, loss_d: 0.156504
0.8458 --- loss: 0.896907, loss_ss: 0.815190, loss_d: 0.081717
0.8843 --- loss: 0.805952, loss_ss: 0.759055, loss_d: 0.046897
0.9227 --- loss: 0.915560, loss_ss: 0.853014, loss_d: 0.062546
0.9612 --- loss: 0.865278, loss_ss: 0.714193, loss_d: 0.151085
0.9996 --- loss: 3.324284, loss_ss: 3.322252, loss_d: 0.002032
Epoch finished! Loss: 1.0089632673905446
Starting epoch 7/10.
0.0000 --- loss: 1.270840, loss_ss: 1.117202, loss_d: 0.153639
0.0384 --- loss: 0.719962, loss_ss: 0.717051, loss_d: 0.002911
0.0769 --- loss: 0.997253, loss_ss: 0.625629, loss_d: 0.371625
0.1153 --- loss: 1.234348, loss_ss: 0.596019, loss_d: 0.638329
0.1538 --- loss: 1.098313, loss_ss: 0.807711, loss_d: 0.290602
0.1922 --- loss: 1.009246, loss_ss: 0.988409, loss_d: 0.020838
0.2307 --- loss: 0.777720, loss_ss: 0.697350, loss_d: 0.080371
0.2691 --- loss: 0.692372, loss_ss: 0.652398, loss_d: 0.039974
0.3076 --- loss: 1.406641, loss_ss: 0.946997, loss_d: 0.459644
0.3460 --- loss: 0.846279, loss_ss: 0.704149, loss_d: 0.142130
0.3845 --- loss: 0.827403, loss_ss: 0.809516, loss_d: 0.017887
0.4229 --- loss: 0.821146, loss_ss: 0.793208, loss_d: 0.027938
0.4614 --- loss: 0.806449, loss_ss: 0.638899, loss_d: 0.167551
0.4998 --- loss: 1.054852, loss_ss: 0.811764, loss_d: 0.243089
0.5383 --- loss: 1.153554, loss_ss: 0.650611, loss_d: 0.502943
0.5767 --- loss: 0.722175, loss_ss: 0.702294, loss_d: 0.019881
0.6151 --- loss: 0.833188, loss_ss: 0.769785, loss_d: 0.063403
0.6536 --- loss: 1.552635, loss_ss: 1.161819, loss_d: 0.390816
0.6920 --- loss: 0.744396, loss_ss: 0.680937, loss_d: 0.063459
0.7305 --- loss: 0.822625, loss_ss: 0.795033, loss_d: 0.027592
0.7689 --- loss: 0.999817, loss_ss: 0.870009, loss_d: 0.129808
0.8074 --- loss: 0.766050, loss_ss: 0.751379, loss_d: 0.014670
0.8458 --- loss: 0.925544, loss_ss: 0.895090, loss_d: 0.030454
0.8843 --- loss: 0.710002, loss_ss: 0.684874, loss_d: 0.025129
0.9227 --- loss: 1.178609, loss_ss: 0.880335, loss_d: 0.298274
0.9612 --- loss: 0.990333, loss_ss: 0.824561, loss_d: 0.165773
0.9996 --- loss: 2.719604, loss_ss: 2.708414, loss_d: 0.011190
Epoch finished! Loss: 0.9414818305235643
Starting epoch 8/10.
0.0000 --- loss: 0.892338, loss_ss: 0.824019, loss_d: 0.068320
0.0384 --- loss: 1.242444, loss_ss: 1.217102, loss_d: 0.025342
0.0769 --- loss: 0.759813, loss_ss: 0.650339, loss_d: 0.109474
0.1153 --- loss: 0.852151, loss_ss: 0.604964, loss_d: 0.247187
0.1538 --- loss: 1.172011, loss_ss: 0.806938, loss_d: 0.365072
0.1922 --- loss: 0.930534, loss_ss: 0.895564, loss_d: 0.034970
0.2307 --- loss: 0.767702, loss_ss: 0.675784, loss_d: 0.091918
0.2691 --- loss: 0.752513, loss_ss: 0.718558, loss_d: 0.033954
0.3076 --- loss: 0.812335, loss_ss: 0.800783, loss_d: 0.011552
0.3460 --- loss: 1.339938, loss_ss: 0.868056, loss_d: 0.471881
0.3845 --- loss: 1.268040, loss_ss: 1.111665, loss_d: 0.156375
0.4229 --- loss: 0.782735, loss_ss: 0.652745, loss_d: 0.129990
0.4614 --- loss: 0.642602, loss_ss: 0.631570, loss_d: 0.011031
0.4998 --- loss: 1.166938, loss_ss: 0.614774, loss_d: 0.552164
0.5383 --- loss: 0.860818, loss_ss: 0.850029, loss_d: 0.010789
0.5767 --- loss: 1.013340, loss_ss: 0.650806, loss_d: 0.362534
0.6151 --- loss: 0.859479, loss_ss: 0.850916, loss_d: 0.008564
0.6536 --- loss: 0.988415, loss_ss: 0.969618, loss_d: 0.018797
0.6920 --- loss: 1.012902, loss_ss: 0.801350, loss_d: 0.211552
0.7305 --- loss: 0.573873, loss_ss: 0.542403, loss_d: 0.031470
0.7689 --- loss: 0.699701, loss_ss: 0.656966, loss_d: 0.042735
0.8074 --- loss: 0.918168, loss_ss: 0.627537, loss_d: 0.290631
0.8458 --- loss: 0.616733, loss_ss: 0.599971, loss_d: 0.016762
0.8843 --- loss: 0.841994, loss_ss: 0.827495, loss_d: 0.014500
0.9227 --- loss: 0.623377, loss_ss: 0.619648, loss_d: 0.003729
0.9612 --- loss: 0.794209, loss_ss: 0.759415, loss_d: 0.034793
0.9996 --- loss: 1.418092, loss_ss: 1.411684, loss_d: 0.006408
Epoch finished! Loss: 0.9003062413288997
Starting epoch 9/10.
0.0000 --- loss: 1.196634, loss_ss: 1.169915, loss_d: 0.026719
0.0384 --- loss: 1.038696, loss_ss: 0.732228, loss_d: 0.306469
0.0769 --- loss: 0.771909, loss_ss: 0.757207, loss_d: 0.014702
0.1153 --- loss: 0.897978, loss_ss: 0.692276, loss_d: 0.205702
0.1538 --- loss: 1.142764, loss_ss: 1.125702, loss_d: 0.017062
0.1922 --- loss: 0.887989, loss_ss: 0.860003, loss_d: 0.027987
0.2307 --- loss: 0.969839, loss_ss: 0.899733, loss_d: 0.070105
0.2691 --- loss: 0.652968, loss_ss: 0.644606, loss_d: 0.008362
0.3076 --- loss: 0.976456, loss_ss: 0.820315, loss_d: 0.156141
0.3460 --- loss: 0.515866, loss_ss: 0.452448, loss_d: 0.063418
0.3845 --- loss: 0.793467, loss_ss: 0.751344, loss_d: 0.042123
0.4229 --- loss: 0.739428, loss_ss: 0.714190, loss_d: 0.025238
0.4614 --- loss: 0.770621, loss_ss: 0.745509, loss_d: 0.025112
0.4998 --- loss: 0.739954, loss_ss: 0.725947, loss_d: 0.014007
0.5383 --- loss: 0.756982, loss_ss: 0.724455, loss_d: 0.032526
0.5767 --- loss: 0.779566, loss_ss: 0.500434, loss_d: 0.279132
0.6151 --- loss: 0.691900, loss_ss: 0.637504, loss_d: 0.054396
0.6536 --- loss: 0.844653, loss_ss: 0.817360, loss_d: 0.027293
0.6920 --- loss: 1.464598, loss_ss: 0.979860, loss_d: 0.484738
0.7305 --- loss: 1.112752, loss_ss: 1.054590, loss_d: 0.058162
0.7689 --- loss: 0.563614, loss_ss: 0.520065, loss_d: 0.043549
0.8074 --- loss: 0.689673, loss_ss: 0.619846, loss_d: 0.069826
0.8458 --- loss: 0.920502, loss_ss: 0.913985, loss_d: 0.006517
0.8843 --- loss: 0.925098, loss_ss: 0.909360, loss_d: 0.015738
0.9227 --- loss: 1.424955, loss_ss: 1.053666, loss_d: 0.371289
0.9612 --- loss: 0.808177, loss_ss: 0.800734, loss_d: 0.007442
0.9996 --- loss: 6.979772, loss_ss: 1.093665, loss_d: 5.886106
Epoch finished! Loss: 0.8976705975257433
Starting epoch 10/10.
0.0000 --- loss: 0.920528, loss_ss: 0.908309, loss_d: 0.012219
0.0384 --- loss: 1.177983, loss_ss: 0.794491, loss_d: 0.383492
0.0769 --- loss: 0.885948, loss_ss: 0.697267, loss_d: 0.188681
0.1153 --- loss: 1.053598, loss_ss: 1.042133, loss_d: 0.011465
0.1538 --- loss: 0.897961, loss_ss: 0.821100, loss_d: 0.076861
0.1922 --- loss: 1.002290, loss_ss: 0.843599, loss_d: 0.158691
0.2307 --- loss: 0.821885, loss_ss: 0.795444, loss_d: 0.026441
0.2691 --- loss: 0.967034, loss_ss: 0.774414, loss_d: 0.192620
0.3076 --- loss: 0.748365, loss_ss: 0.620667, loss_d: 0.127698
0.3460 --- loss: 0.887770, loss_ss: 0.667066, loss_d: 0.220704
0.3845 --- loss: 0.750890, loss_ss: 0.735345, loss_d: 0.015545
0.4229 --- loss: 1.146061, loss_ss: 1.110005, loss_d: 0.036056
0.4614 --- loss: 0.754597, loss_ss: 0.613510, loss_d: 0.141087
0.4998 --- loss: 1.035997, loss_ss: 1.015334, loss_d: 0.020663
0.5383 --- loss: 0.824312, loss_ss: 0.752952, loss_d: 0.071360
0.5767 --- loss: 0.814395, loss_ss: 0.810031, loss_d: 0.004364
0.6151 --- loss: 0.671688, loss_ss: 0.555999, loss_d: 0.115690
0.6536 --- loss: 1.247725, loss_ss: 0.974603, loss_d: 0.273123
0.6920 --- loss: 1.053021, loss_ss: 0.886936, loss_d: 0.166085
0.7305 --- loss: 2.752348, loss_ss: 0.538779, loss_d: 2.213570
0.7689 --- loss: 0.699199, loss_ss: 0.640341, loss_d: 0.058858
0.8074 --- loss: 0.595241, loss_ss: 0.574043, loss_d: 0.021197
0.8458 --- loss: 1.058140, loss_ss: 1.049838, loss_d: 0.008302
0.8843 --- loss: 0.733686, loss_ss: 0.631798, loss_d: 0.101888
0.9227 --- loss: 0.837954, loss_ss: 0.818725, loss_d: 0.019228
0.9612 --- loss: 0.669948, loss_ss: 0.659556, loss_d: 0.010392
0.9996 --- loss: 1.568976, loss_ss: 1.567782, loss_d: 0.001194
Epoch finished! Loss: 0.8961079066762557
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.590990990990991
             precision    recall  f1-score   support

        0.0       0.72      0.75      0.74       232
        1.0       0.33      0.52      0.40       179
        2.0       0.52      0.51      0.51       246
        3.0       1.00      0.63      0.77       339
        4.0       0.40      0.46      0.42       114

avg / total       0.66      0.59      0.61      1110
 


====== chp024-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.83  75.00   92.48   72.50     73.73
1  74.95  51.96   79.38   32.63     40.09
2  78.56  50.81   86.46   51.65     51.23
3  88.56  62.54  100.00  100.00     76.95
4  87.30  45.61   92.07   39.69     42.45
Total accuracy: 59.10%
Average sen: 57.18%
Average spec: 90.08%
Macro f1-score: 56.89%
Diagnosis acc on 15mins: 1.0
[0.99997509 0.99946553 0.99963641 0.99972707 0.99999547 0.99999774
 0.99999571 0.99994373 0.99998558 0.99990642 0.99996078 0.99999607
 0.99994624 0.9999783  0.9997136  0.99976665 0.99963307 0.99550027
 0.99994659 0.99998558 0.99997389 0.99999893 0.99997866 0.99999928
 0.99998891 0.99999595 0.99843043 0.99993014 0.99956828 0.99509841
 0.99999404 0.99999356 0.9997434  0.99988806 0.99961036 0.99997091
 0.99996662]
pred: 0.9995996146588713, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.469511, loss_ss: 1.756704, loss_d: 0.712807
0.0381 --- loss: 2.395854, loss_ss: 1.541233, loss_d: 0.854621
0.0762 --- loss: 2.269254, loss_ss: 1.599051, loss_d: 0.670203
0.1143 --- loss: 1.806068, loss_ss: 1.327976, loss_d: 0.478091
0.1524 --- loss: 1.817423, loss_ss: 1.390835, loss_d: 0.426588
0.1905 --- loss: 2.100242, loss_ss: 1.427722, loss_d: 0.672520
0.2287 --- loss: 1.834681, loss_ss: 1.316757, loss_d: 0.517924
0.2668 --- loss: 1.806448, loss_ss: 1.205863, loss_d: 0.600584
0.3049 --- loss: 1.982140, loss_ss: 1.287200, loss_d: 0.694940
0.3430 --- loss: 1.889391, loss_ss: 1.364121, loss_d: 0.525271
0.3811 --- loss: 1.954960, loss_ss: 1.214039, loss_d: 0.740920
0.4192 --- loss: 1.940704, loss_ss: 1.214025, loss_d: 0.726680
0.4573 --- loss: 1.770675, loss_ss: 1.351804, loss_d: 0.418871
0.4954 --- loss: 2.131104, loss_ss: 1.453224, loss_d: 0.677880
0.5335 --- loss: 1.526965, loss_ss: 1.155877, loss_d: 0.371088
0.5716 --- loss: 1.560679, loss_ss: 1.208057, loss_d: 0.352622
0.6098 --- loss: 1.778585, loss_ss: 1.160798, loss_d: 0.617787
0.6479 --- loss: 1.437720, loss_ss: 1.111072, loss_d: 0.326648
0.6860 --- loss: 1.604092, loss_ss: 1.316730, loss_d: 0.287362
0.7241 --- loss: 1.925401, loss_ss: 1.479472, loss_d: 0.445929
0.7622 --- loss: 1.710478, loss_ss: 1.430884, loss_d: 0.279594
0.8003 --- loss: 1.799440, loss_ss: 1.189149, loss_d: 0.610291
0.8384 --- loss: 1.499429, loss_ss: 1.221766, loss_d: 0.277663
0.8765 --- loss: 2.101404, loss_ss: 1.094959, loss_d: 1.006445
0.9146 --- loss: 1.672851, loss_ss: 1.189058, loss_d: 0.483793
0.9527 --- loss: 1.502585, loss_ss: 1.139703, loss_d: 0.362881
0.9909 --- loss: 1.639644, loss_ss: 1.088371, loss_d: 0.551274
Epoch finished! Loss: 1.7986524186971533
Starting epoch 2/10.
0.0000 --- loss: 1.285899, loss_ss: 1.036933, loss_d: 0.248966
0.0381 --- loss: 1.509704, loss_ss: 1.169841, loss_d: 0.339864
0.0762 --- loss: 1.086573, loss_ss: 0.894253, loss_d: 0.192320
0.1143 --- loss: 1.141937, loss_ss: 0.944284, loss_d: 0.197653
0.1524 --- loss: 1.645866, loss_ss: 1.146034, loss_d: 0.499832
0.1905 --- loss: 1.101449, loss_ss: 0.982951, loss_d: 0.118498
0.2287 --- loss: 1.553852, loss_ss: 1.021422, loss_d: 0.532430
0.2668 --- loss: 1.003339, loss_ss: 0.882633, loss_d: 0.120707
0.3049 --- loss: 1.160497, loss_ss: 0.975594, loss_d: 0.184903
0.3430 --- loss: 1.067142, loss_ss: 0.978957, loss_d: 0.088185
0.3811 --- loss: 1.441541, loss_ss: 1.113618, loss_d: 0.327923
0.4192 --- loss: 1.060480, loss_ss: 0.845369, loss_d: 0.215111
0.4573 --- loss: 1.203294, loss_ss: 0.868561, loss_d: 0.334733
0.4954 --- loss: 1.410732, loss_ss: 0.983345, loss_d: 0.427387
0.5335 --- loss: 1.649358, loss_ss: 1.096882, loss_d: 0.552476
0.5716 --- loss: 1.351356, loss_ss: 0.892563, loss_d: 0.458793
0.6098 --- loss: 1.450400, loss_ss: 1.261432, loss_d: 0.188968
0.6479 --- loss: 0.953564, loss_ss: 0.794721, loss_d: 0.158843
0.6860 --- loss: 1.366379, loss_ss: 0.903047, loss_d: 0.463332
0.7241 --- loss: 1.361161, loss_ss: 1.171045, loss_d: 0.190116
0.7622 --- loss: 1.485623, loss_ss: 1.089390, loss_d: 0.396233
0.8003 --- loss: 1.442368, loss_ss: 0.878699, loss_d: 0.563669
0.8384 --- loss: 1.125141, loss_ss: 0.919362, loss_d: 0.205780
0.8765 --- loss: 1.455993, loss_ss: 1.139690, loss_d: 0.316303
0.9146 --- loss: 1.349110, loss_ss: 1.194919, loss_d: 0.154191
0.9527 --- loss: 1.713488, loss_ss: 1.042930, loss_d: 0.670559
0.9909 --- loss: 1.428256, loss_ss: 1.154787, loss_d: 0.273469
Epoch finished! Loss: 1.2922629566138026
Starting epoch 3/10.
0.0000 --- loss: 2.374061, loss_ss: 1.190526, loss_d: 1.183536
0.0381 --- loss: 1.122906, loss_ss: 0.785278, loss_d: 0.337628
0.0762 --- loss: 1.461011, loss_ss: 0.937808, loss_d: 0.523203
0.1143 --- loss: 0.976782, loss_ss: 0.814982, loss_d: 0.161799
0.1524 --- loss: 1.092048, loss_ss: 0.801162, loss_d: 0.290886
0.1905 --- loss: 1.215247, loss_ss: 0.859399, loss_d: 0.355848
0.2287 --- loss: 1.554120, loss_ss: 1.397312, loss_d: 0.156807
0.2668 --- loss: 1.113597, loss_ss: 0.870494, loss_d: 0.243103
0.3049 --- loss: 1.153208, loss_ss: 0.993336, loss_d: 0.159872
0.3430 --- loss: 0.855685, loss_ss: 0.812929, loss_d: 0.042756
0.3811 --- loss: 1.117029, loss_ss: 0.972986, loss_d: 0.144044
0.4192 --- loss: 1.073814, loss_ss: 0.987945, loss_d: 0.085869
0.4573 --- loss: 1.284321, loss_ss: 0.916249, loss_d: 0.368072
0.4954 --- loss: 0.982306, loss_ss: 0.902251, loss_d: 0.080055
0.5335 --- loss: 1.124522, loss_ss: 1.084057, loss_d: 0.040465
0.5716 --- loss: 1.346455, loss_ss: 0.904398, loss_d: 0.442057
0.6098 --- loss: 1.227269, loss_ss: 0.992226, loss_d: 0.235043
0.6479 --- loss: 0.725521, loss_ss: 0.696199, loss_d: 0.029322
0.6860 --- loss: 0.896407, loss_ss: 0.688316, loss_d: 0.208091
0.7241 --- loss: 0.726925, loss_ss: 0.560883, loss_d: 0.166042
0.7622 --- loss: 1.244073, loss_ss: 0.853583, loss_d: 0.390490
0.8003 --- loss: 0.852814, loss_ss: 0.763215, loss_d: 0.089599
0.8384 --- loss: 0.756213, loss_ss: 0.639429, loss_d: 0.116784
0.8765 --- loss: 0.762598, loss_ss: 0.624859, loss_d: 0.137740
0.9146 --- loss: 0.881962, loss_ss: 0.681558, loss_d: 0.200404
0.9527 --- loss: 0.835266, loss_ss: 0.700818, loss_d: 0.134448
0.9909 --- loss: 1.144408, loss_ss: 0.958239, loss_d: 0.186170
Epoch finished! Loss: 1.115038030247652
Starting epoch 4/10.
0.0000 --- loss: 0.861614, loss_ss: 0.814584, loss_d: 0.047030
0.0381 --- loss: 1.005013, loss_ss: 0.799740, loss_d: 0.205272
0.0762 --- loss: 0.816542, loss_ss: 0.542952, loss_d: 0.273591
0.1143 --- loss: 1.238355, loss_ss: 1.166825, loss_d: 0.071530
0.1524 --- loss: 1.637744, loss_ss: 0.812526, loss_d: 0.825218
0.1905 --- loss: 0.927982, loss_ss: 0.895714, loss_d: 0.032269
0.2287 --- loss: 0.678543, loss_ss: 0.646736, loss_d: 0.031807
0.2668 --- loss: 0.610856, loss_ss: 0.543496, loss_d: 0.067361
0.3049 --- loss: 0.917158, loss_ss: 0.865919, loss_d: 0.051238
0.3430 --- loss: 0.809233, loss_ss: 0.766521, loss_d: 0.042712
0.3811 --- loss: 0.999412, loss_ss: 0.940687, loss_d: 0.058725
0.4192 --- loss: 1.125813, loss_ss: 0.777047, loss_d: 0.348766
0.4573 --- loss: 0.876494, loss_ss: 0.745712, loss_d: 0.130782
0.4954 --- loss: 0.850588, loss_ss: 0.768960, loss_d: 0.081628
0.5335 --- loss: 0.739770, loss_ss: 0.714612, loss_d: 0.025157
0.5716 --- loss: 0.682609, loss_ss: 0.656262, loss_d: 0.026347
0.6098 --- loss: 0.750828, loss_ss: 0.696359, loss_d: 0.054469
0.6479 --- loss: 1.025653, loss_ss: 0.681960, loss_d: 0.343693
0.6860 --- loss: 0.830430, loss_ss: 0.768017, loss_d: 0.062412
0.7241 --- loss: 0.991734, loss_ss: 0.924114, loss_d: 0.067620
0.7622 --- loss: 1.311641, loss_ss: 0.902614, loss_d: 0.409027
0.8003 --- loss: 1.839449, loss_ss: 0.998601, loss_d: 0.840848
0.8384 --- loss: 1.076778, loss_ss: 0.869311, loss_d: 0.207467
0.8765 --- loss: 0.939841, loss_ss: 0.865845, loss_d: 0.073997
0.9146 --- loss: 0.695270, loss_ss: 0.637145, loss_d: 0.058125
0.9527 --- loss: 1.255404, loss_ss: 1.007361, loss_d: 0.248043
0.9909 --- loss: 0.901944, loss_ss: 0.851031, loss_d: 0.050913
Epoch finished! Loss: 1.0182363345422818
Starting epoch 5/10.
0.0000 --- loss: 1.250506, loss_ss: 1.162292, loss_d: 0.088214
0.0381 --- loss: 0.657807, loss_ss: 0.597460, loss_d: 0.060347
0.0762 --- loss: 1.069595, loss_ss: 0.836702, loss_d: 0.232892
0.1143 --- loss: 0.748352, loss_ss: 0.690270, loss_d: 0.058083
0.1524 --- loss: 1.327396, loss_ss: 0.679552, loss_d: 0.647844
0.1905 --- loss: 0.867648, loss_ss: 0.805579, loss_d: 0.062069
0.2287 --- loss: 0.771307, loss_ss: 0.686331, loss_d: 0.084976
0.2668 --- loss: 0.888170, loss_ss: 0.604009, loss_d: 0.284161
0.3049 --- loss: 0.932934, loss_ss: 0.869153, loss_d: 0.063780
0.3430 --- loss: 0.759735, loss_ss: 0.707218, loss_d: 0.052516
0.3811 --- loss: 0.955119, loss_ss: 0.691272, loss_d: 0.263846
0.4192 --- loss: 1.133516, loss_ss: 1.098672, loss_d: 0.034844
0.4573 --- loss: 1.221776, loss_ss: 0.890292, loss_d: 0.331484
0.4954 --- loss: 0.793275, loss_ss: 0.718313, loss_d: 0.074963
0.5335 --- loss: 0.917805, loss_ss: 0.658964, loss_d: 0.258841
0.5716 --- loss: 1.110481, loss_ss: 1.066202, loss_d: 0.044279
0.6098 --- loss: 1.213939, loss_ss: 1.082305, loss_d: 0.131634
0.6479 --- loss: 1.494701, loss_ss: 0.758862, loss_d: 0.735839
0.6860 --- loss: 0.750099, loss_ss: 0.679505, loss_d: 0.070594
0.7241 --- loss: 0.994601, loss_ss: 0.830785, loss_d: 0.163816
0.7622 --- loss: 0.654041, loss_ss: 0.602979, loss_d: 0.051063
0.8003 --- loss: 1.258579, loss_ss: 0.845671, loss_d: 0.412909
0.8384 --- loss: 0.999226, loss_ss: 0.920130, loss_d: 0.079096
0.8765 --- loss: 0.753099, loss_ss: 0.729836, loss_d: 0.023262
0.9146 --- loss: 0.717957, loss_ss: 0.678134, loss_d: 0.039823
0.9527 --- loss: 1.252381, loss_ss: 0.963327, loss_d: 0.289054
0.9909 --- loss: 0.466422, loss_ss: 0.448721, loss_d: 0.017700
Epoch finished! Loss: 0.9588256397547613
Starting epoch 6/10.
0.0000 --- loss: 1.099414, loss_ss: 0.643057, loss_d: 0.456358
0.0381 --- loss: 0.892020, loss_ss: 0.833502, loss_d: 0.058518
0.0762 --- loss: 0.928607, loss_ss: 0.770176, loss_d: 0.158431
0.1143 --- loss: 0.745362, loss_ss: 0.692666, loss_d: 0.052696
0.1524 --- loss: 0.897268, loss_ss: 0.869266, loss_d: 0.028001
0.1905 --- loss: 1.007753, loss_ss: 0.938111, loss_d: 0.069641
0.2287 --- loss: 0.984196, loss_ss: 0.882107, loss_d: 0.102089
0.2668 --- loss: 0.778358, loss_ss: 0.738523, loss_d: 0.039835
0.3049 --- loss: 1.195355, loss_ss: 0.974827, loss_d: 0.220527
0.3430 --- loss: 0.944226, loss_ss: 0.850579, loss_d: 0.093647
0.3811 --- loss: 1.228989, loss_ss: 0.984036, loss_d: 0.244954
0.4192 --- loss: 0.810068, loss_ss: 0.695872, loss_d: 0.114196
0.4573 --- loss: 0.852064, loss_ss: 0.809624, loss_d: 0.042440
0.4954 --- loss: 1.014717, loss_ss: 0.987358, loss_d: 0.027360
0.5335 --- loss: 0.824867, loss_ss: 0.717825, loss_d: 0.107042
0.5716 --- loss: 0.708663, loss_ss: 0.537192, loss_d: 0.171472
0.6098 --- loss: 0.868700, loss_ss: 0.699790, loss_d: 0.168910
0.6479 --- loss: 0.901562, loss_ss: 0.899613, loss_d: 0.001949
0.6860 --- loss: 1.195999, loss_ss: 0.868324, loss_d: 0.327675
0.7241 --- loss: 0.770856, loss_ss: 0.756029, loss_d: 0.014827
0.7622 --- loss: 0.705437, loss_ss: 0.699545, loss_d: 0.005892
0.8003 --- loss: 0.955538, loss_ss: 0.935686, loss_d: 0.019852
0.8384 --- loss: 0.731681, loss_ss: 0.698439, loss_d: 0.033242
0.8765 --- loss: 0.918916, loss_ss: 0.567253, loss_d: 0.351663
0.9146 --- loss: 0.876547, loss_ss: 0.760177, loss_d: 0.116371
0.9527 --- loss: 0.828043, loss_ss: 0.786364, loss_d: 0.041678
0.9909 --- loss: 0.540970, loss_ss: 0.495912, loss_d: 0.045059
Epoch finished! Loss: 0.9073048603671198
Starting epoch 7/10.
0.0000 --- loss: 1.330333, loss_ss: 1.073894, loss_d: 0.256439
0.0381 --- loss: 0.942588, loss_ss: 0.929790, loss_d: 0.012798
0.0762 --- loss: 0.588327, loss_ss: 0.556999, loss_d: 0.031327
0.1143 --- loss: 0.399317, loss_ss: 0.373794, loss_d: 0.025523
0.1524 --- loss: 0.797641, loss_ss: 0.788473, loss_d: 0.009168
0.1905 --- loss: 1.244357, loss_ss: 0.908338, loss_d: 0.336018
0.2287 --- loss: 0.518850, loss_ss: 0.483962, loss_d: 0.034888
0.2668 --- loss: 0.873088, loss_ss: 0.776879, loss_d: 0.096209
0.3049 --- loss: 0.771079, loss_ss: 0.761141, loss_d: 0.009938
0.3430 --- loss: 1.006385, loss_ss: 0.703879, loss_d: 0.302506
0.3811 --- loss: 0.765545, loss_ss: 0.575349, loss_d: 0.190196
0.4192 --- loss: 1.019830, loss_ss: 0.887316, loss_d: 0.132514
0.4573 --- loss: 1.151369, loss_ss: 1.024838, loss_d: 0.126531
0.4954 --- loss: 0.660810, loss_ss: 0.631867, loss_d: 0.028944
0.5335 --- loss: 0.733583, loss_ss: 0.704612, loss_d: 0.028971
0.5716 --- loss: 0.728168, loss_ss: 0.624536, loss_d: 0.103632
0.6098 --- loss: 0.601104, loss_ss: 0.527265, loss_d: 0.073839
0.6479 --- loss: 1.314844, loss_ss: 1.299108, loss_d: 0.015737
0.6860 --- loss: 0.909318, loss_ss: 0.870877, loss_d: 0.038441
0.7241 --- loss: 0.917031, loss_ss: 0.696914, loss_d: 0.220117
0.7622 --- loss: 0.726706, loss_ss: 0.714578, loss_d: 0.012128
0.8003 --- loss: 0.655436, loss_ss: 0.613509, loss_d: 0.041927
0.8384 --- loss: 0.866367, loss_ss: 0.806480, loss_d: 0.059887
0.8765 --- loss: 0.870102, loss_ss: 0.850471, loss_d: 0.019631
0.9146 --- loss: 0.813064, loss_ss: 0.742716, loss_d: 0.070348
0.9527 --- loss: 1.024888, loss_ss: 0.730898, loss_d: 0.293989
0.9909 --- loss: 0.878540, loss_ss: 0.676728, loss_d: 0.201812
Epoch finished! Loss: 0.8834386626045212
Starting epoch 8/10.
0.0000 --- loss: 0.751795, loss_ss: 0.734242, loss_d: 0.017553
0.0381 --- loss: 1.095572, loss_ss: 0.780171, loss_d: 0.315402
0.0762 --- loss: 0.826975, loss_ss: 0.690897, loss_d: 0.136078
0.1143 --- loss: 0.929784, loss_ss: 0.885287, loss_d: 0.044497
0.1524 --- loss: 1.236096, loss_ss: 0.859197, loss_d: 0.376900
0.1905 --- loss: 0.694530, loss_ss: 0.624715, loss_d: 0.069815
0.2287 --- loss: 0.739241, loss_ss: 0.727629, loss_d: 0.011613
0.2668 --- loss: 0.530574, loss_ss: 0.502775, loss_d: 0.027798
0.3049 --- loss: 0.863569, loss_ss: 0.519998, loss_d: 0.343571
0.3430 --- loss: 0.726493, loss_ss: 0.721102, loss_d: 0.005392
0.3811 --- loss: 0.847150, loss_ss: 0.791594, loss_d: 0.055556
0.4192 --- loss: 0.916460, loss_ss: 0.735884, loss_d: 0.180576
0.4573 --- loss: 0.724920, loss_ss: 0.649831, loss_d: 0.075088
0.4954 --- loss: 0.741894, loss_ss: 0.669206, loss_d: 0.072689
0.5335 --- loss: 0.776977, loss_ss: 0.737359, loss_d: 0.039618
0.5716 --- loss: 0.929847, loss_ss: 0.505651, loss_d: 0.424196
0.6098 --- loss: 1.122787, loss_ss: 1.047841, loss_d: 0.074946
0.6479 --- loss: 0.693841, loss_ss: 0.670301, loss_d: 0.023539
0.6860 --- loss: 0.961585, loss_ss: 0.896894, loss_d: 0.064692
0.7241 --- loss: 0.880098, loss_ss: 0.753600, loss_d: 0.126498
0.7622 --- loss: 0.767898, loss_ss: 0.715696, loss_d: 0.052202
0.8003 --- loss: 1.119794, loss_ss: 0.841987, loss_d: 0.277807
0.8384 --- loss: 0.768064, loss_ss: 0.610094, loss_d: 0.157971
0.8765 --- loss: 0.849970, loss_ss: 0.829906, loss_d: 0.020064
0.9146 --- loss: 0.722337, loss_ss: 0.682711, loss_d: 0.039626
0.9527 --- loss: 0.925809, loss_ss: 0.825899, loss_d: 0.099910
0.9909 --- loss: 0.720723, loss_ss: 0.711167, loss_d: 0.009555
Epoch finished! Loss: 0.8537445663268329
Starting epoch 9/10.
0.0000 --- loss: 0.780788, loss_ss: 0.654590, loss_d: 0.126198
0.0381 --- loss: 0.835085, loss_ss: 0.667136, loss_d: 0.167949
0.0762 --- loss: 0.813952, loss_ss: 0.671645, loss_d: 0.142308
0.1143 --- loss: 0.810413, loss_ss: 0.612008, loss_d: 0.198404
0.1524 --- loss: 0.750210, loss_ss: 0.587676, loss_d: 0.162533
0.1905 --- loss: 0.963816, loss_ss: 0.910666, loss_d: 0.053150
0.2287 --- loss: 0.558387, loss_ss: 0.544718, loss_d: 0.013669
0.2668 --- loss: 0.511201, loss_ss: 0.500410, loss_d: 0.010791
0.3049 --- loss: 0.766662, loss_ss: 0.555320, loss_d: 0.211342
0.3430 --- loss: 0.857897, loss_ss: 0.643927, loss_d: 0.213970
0.3811 --- loss: 1.371793, loss_ss: 0.777593, loss_d: 0.594200
0.4192 --- loss: 1.143227, loss_ss: 1.001968, loss_d: 0.141259
0.4573 --- loss: 0.755518, loss_ss: 0.704825, loss_d: 0.050693
0.4954 --- loss: 0.880501, loss_ss: 0.845498, loss_d: 0.035003
0.5335 --- loss: 0.985574, loss_ss: 0.880057, loss_d: 0.105517
0.5716 --- loss: 0.872316, loss_ss: 0.589574, loss_d: 0.282742
0.6098 --- loss: 0.976465, loss_ss: 0.742128, loss_d: 0.234337
0.6479 --- loss: 0.856028, loss_ss: 0.843088, loss_d: 0.012940
0.6860 --- loss: 1.017012, loss_ss: 0.895240, loss_d: 0.121771
0.7241 --- loss: 0.625957, loss_ss: 0.619622, loss_d: 0.006334
0.7622 --- loss: 0.776445, loss_ss: 0.757891, loss_d: 0.018554
0.8003 --- loss: 0.846300, loss_ss: 0.629330, loss_d: 0.216970
0.8384 --- loss: 0.797859, loss_ss: 0.790699, loss_d: 0.007160
0.8765 --- loss: 1.314456, loss_ss: 0.578614, loss_d: 0.735842
0.9146 --- loss: 0.727101, loss_ss: 0.707469, loss_d: 0.019632
0.9527 --- loss: 0.655069, loss_ss: 0.639536, loss_d: 0.015532
0.9909 --- loss: 0.705448, loss_ss: 0.656391, loss_d: 0.049057
Epoch finished! Loss: 0.8721901494583101
Starting epoch 10/10.
0.0000 --- loss: 0.915633, loss_ss: 0.884032, loss_d: 0.031601
0.0381 --- loss: 0.617330, loss_ss: 0.588114, loss_d: 0.029216
0.0762 --- loss: 0.746458, loss_ss: 0.739370, loss_d: 0.007088
0.1143 --- loss: 0.887047, loss_ss: 0.855820, loss_d: 0.031227
0.1524 --- loss: 0.784049, loss_ss: 0.757765, loss_d: 0.026284
0.1905 --- loss: 0.699229, loss_ss: 0.670140, loss_d: 0.029089
0.2287 --- loss: 0.700047, loss_ss: 0.666388, loss_d: 0.033660
0.2668 --- loss: 0.893532, loss_ss: 0.889027, loss_d: 0.004505
0.3049 --- loss: 0.666743, loss_ss: 0.609192, loss_d: 0.057551
0.3430 --- loss: 0.635513, loss_ss: 0.541472, loss_d: 0.094041
0.3811 --- loss: 0.867475, loss_ss: 0.833828, loss_d: 0.033647
0.4192 --- loss: 0.830996, loss_ss: 0.825487, loss_d: 0.005509
0.4573 --- loss: 1.251614, loss_ss: 1.041257, loss_d: 0.210357
0.4954 --- loss: 0.816198, loss_ss: 0.811565, loss_d: 0.004633
0.5335 --- loss: 0.757120, loss_ss: 0.737681, loss_d: 0.019438
0.5716 --- loss: 1.352958, loss_ss: 0.777595, loss_d: 0.575363
0.6098 --- loss: 1.297669, loss_ss: 1.116256, loss_d: 0.181413
0.6479 --- loss: 0.707568, loss_ss: 0.469508, loss_d: 0.238061
0.6860 --- loss: 0.837821, loss_ss: 0.818420, loss_d: 0.019401
0.7241 --- loss: 0.820937, loss_ss: 0.810888, loss_d: 0.010049
0.7622 --- loss: 0.727597, loss_ss: 0.715093, loss_d: 0.012504
0.8003 --- loss: 1.006057, loss_ss: 0.994014, loss_d: 0.012044
0.8384 --- loss: 0.796121, loss_ss: 0.723567, loss_d: 0.072554
0.8765 --- loss: 0.570177, loss_ss: 0.565510, loss_d: 0.004666
0.9146 --- loss: 1.128614, loss_ss: 1.088270, loss_d: 0.040344
0.9527 --- loss: 0.599291, loss_ss: 0.595342, loss_d: 0.003949
0.9909 --- loss: 0.760642, loss_ss: 0.709773, loss_d: 0.050869
Epoch finished! Loss: 0.8111199669483053
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5
             precision    recall  f1-score   support

        0.0       1.00      0.39      0.57       304
        1.0       0.48      0.56      0.52        25
        2.0       0.62      0.55      0.58        29
        3.0       1.00      0.97      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.94      0.50      0.63       420
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  56.19  39.47  100.00  100.00     56.60
1  93.81  56.00   96.20   48.28     51.85
2  94.52  55.17   97.44   61.54     58.18
3  99.52  96.77  100.00  100.00     98.36
4  55.95    NaN   55.95    0.00       NaN
Total accuracy: 50.00%
Average sen: 61.86%
Average spec: 89.92%
Macro f1-score: 66.25%
Diagnosis acc on 15mins: 1.0
[0.99112481 0.99535191 0.99999976 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.        ]
pred: 0.9990340343543461, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.389016, loss_ss: 1.716714, loss_d: 0.672302
0.0384 --- loss: 2.468902, loss_ss: 1.502044, loss_d: 0.966858
0.0767 --- loss: 2.305388, loss_ss: 1.618684, loss_d: 0.686704
0.1151 --- loss: 2.099796, loss_ss: 1.514404, loss_d: 0.585392
0.1534 --- loss: 2.174284, loss_ss: 1.570305, loss_d: 0.603978
0.1918 --- loss: 2.123132, loss_ss: 1.423168, loss_d: 0.699964
0.2301 --- loss: 2.353557, loss_ss: 1.581760, loss_d: 0.771797
0.2685 --- loss: 1.910326, loss_ss: 1.432840, loss_d: 0.477486
0.3069 --- loss: 2.018713, loss_ss: 1.439001, loss_d: 0.579712
0.3452 --- loss: 1.764093, loss_ss: 1.355434, loss_d: 0.408660
0.3836 --- loss: 2.265637, loss_ss: 1.286198, loss_d: 0.979440
0.4219 --- loss: 1.615210, loss_ss: 1.239308, loss_d: 0.375902
0.4603 --- loss: 2.163704, loss_ss: 1.264743, loss_d: 0.898961
0.4987 --- loss: 1.847539, loss_ss: 1.264093, loss_d: 0.583447
0.5370 --- loss: 1.972204, loss_ss: 1.208517, loss_d: 0.763687
0.5754 --- loss: 1.993145, loss_ss: 1.209855, loss_d: 0.783290
0.6137 --- loss: 1.621208, loss_ss: 1.315202, loss_d: 0.306006
0.6521 --- loss: 1.748830, loss_ss: 1.084645, loss_d: 0.664185
0.6904 --- loss: 1.629179, loss_ss: 1.137407, loss_d: 0.491772
0.7288 --- loss: 1.766098, loss_ss: 1.309826, loss_d: 0.456271
0.7672 --- loss: 1.531192, loss_ss: 1.237570, loss_d: 0.293622
0.8055 --- loss: 1.503027, loss_ss: 1.109284, loss_d: 0.393743
0.8439 --- loss: 1.508638, loss_ss: 1.124455, loss_d: 0.384183
0.8822 --- loss: 1.615457, loss_ss: 0.996180, loss_d: 0.619277
0.9206 --- loss: 1.449607, loss_ss: 1.097408, loss_d: 0.352199
0.9590 --- loss: 1.453933, loss_ss: 1.217658, loss_d: 0.236275
0.9973 --- loss: 1.995643, loss_ss: 1.136145, loss_d: 0.859498
Epoch finished! Loss: 1.8647105093185719
Starting epoch 2/10.
0.0000 --- loss: 1.753809, loss_ss: 1.115500, loss_d: 0.638309
0.0384 --- loss: 1.578459, loss_ss: 1.076531, loss_d: 0.501927
0.0767 --- loss: 1.270895, loss_ss: 1.075254, loss_d: 0.195641
0.1151 --- loss: 1.605515, loss_ss: 1.156520, loss_d: 0.448995
0.1534 --- loss: 1.588333, loss_ss: 0.996089, loss_d: 0.592244
0.1918 --- loss: 1.370542, loss_ss: 0.961202, loss_d: 0.409339
0.2301 --- loss: 1.249254, loss_ss: 0.920524, loss_d: 0.328730
0.2685 --- loss: 1.302995, loss_ss: 1.084822, loss_d: 0.218173
0.3069 --- loss: 1.662367, loss_ss: 1.187371, loss_d: 0.474997
0.3452 --- loss: 1.189536, loss_ss: 0.914339, loss_d: 0.275197
0.3836 --- loss: 1.651870, loss_ss: 1.372403, loss_d: 0.279467
0.4219 --- loss: 1.311453, loss_ss: 0.907515, loss_d: 0.403939
0.4603 --- loss: 1.280312, loss_ss: 1.069232, loss_d: 0.211080
0.4987 --- loss: 1.415825, loss_ss: 1.105293, loss_d: 0.310532
0.5370 --- loss: 1.225258, loss_ss: 1.053046, loss_d: 0.172212
0.5754 --- loss: 1.287484, loss_ss: 0.989276, loss_d: 0.298208
0.6137 --- loss: 1.373729, loss_ss: 1.237215, loss_d: 0.136514
0.6521 --- loss: 1.043614, loss_ss: 0.938719, loss_d: 0.104895
0.6904 --- loss: 1.166233, loss_ss: 0.896583, loss_d: 0.269650
0.7288 --- loss: 0.875960, loss_ss: 0.765406, loss_d: 0.110555
0.7672 --- loss: 1.046917, loss_ss: 0.971265, loss_d: 0.075652
0.8055 --- loss: 1.175717, loss_ss: 0.944985, loss_d: 0.230732
0.8439 --- loss: 1.391987, loss_ss: 1.305704, loss_d: 0.086283
0.8822 --- loss: 1.136394, loss_ss: 0.847991, loss_d: 0.288403
0.9206 --- loss: 1.052039, loss_ss: 0.896410, loss_d: 0.155629
0.9590 --- loss: 1.241310, loss_ss: 0.942313, loss_d: 0.298997
0.9973 --- loss: 1.751452, loss_ss: 1.290808, loss_d: 0.460644
Epoch finished! Loss: 1.3491020697813767
Starting epoch 3/10.
0.0000 --- loss: 1.166872, loss_ss: 0.936547, loss_d: 0.230325
0.0384 --- loss: 0.926135, loss_ss: 0.835831, loss_d: 0.090304
0.0767 --- loss: 1.107494, loss_ss: 1.030991, loss_d: 0.076503
0.1151 --- loss: 1.362690, loss_ss: 0.885865, loss_d: 0.476825
0.1534 --- loss: 0.905343, loss_ss: 0.795846, loss_d: 0.109498
0.1918 --- loss: 0.925809, loss_ss: 0.773537, loss_d: 0.152272
0.2301 --- loss: 1.054926, loss_ss: 0.854077, loss_d: 0.200849
0.2685 --- loss: 0.990640, loss_ss: 0.726956, loss_d: 0.263683
0.3069 --- loss: 1.437553, loss_ss: 0.815710, loss_d: 0.621843
0.3452 --- loss: 1.318569, loss_ss: 0.709229, loss_d: 0.609340
0.3836 --- loss: 1.360498, loss_ss: 1.059759, loss_d: 0.300739
0.4219 --- loss: 1.164553, loss_ss: 0.787977, loss_d: 0.376576
0.4603 --- loss: 1.193812, loss_ss: 0.825424, loss_d: 0.368388
0.4987 --- loss: 1.033792, loss_ss: 0.937102, loss_d: 0.096690
0.5370 --- loss: 1.133893, loss_ss: 0.745180, loss_d: 0.388713
0.5754 --- loss: 0.941952, loss_ss: 0.784882, loss_d: 0.157070
0.6137 --- loss: 1.044498, loss_ss: 0.980928, loss_d: 0.063569
0.6521 --- loss: 0.892154, loss_ss: 0.817781, loss_d: 0.074373
0.6904 --- loss: 1.671659, loss_ss: 1.211519, loss_d: 0.460141
0.7288 --- loss: 0.750636, loss_ss: 0.694889, loss_d: 0.055747
0.7672 --- loss: 1.144520, loss_ss: 0.891897, loss_d: 0.252623
0.8055 --- loss: 1.472959, loss_ss: 0.744233, loss_d: 0.728726
0.8439 --- loss: 1.455487, loss_ss: 0.787363, loss_d: 0.668125
0.8822 --- loss: 1.456234, loss_ss: 0.783875, loss_d: 0.672358
0.9206 --- loss: 0.890965, loss_ss: 0.751361, loss_d: 0.139604
0.9590 --- loss: 0.712790, loss_ss: 0.594148, loss_d: 0.118642
0.9973 --- loss: 1.000504, loss_ss: 0.792063, loss_d: 0.208441
Epoch finished! Loss: 1.1389314397023274
Starting epoch 4/10.
0.0000 --- loss: 0.854311, loss_ss: 0.800032, loss_d: 0.054279
0.0384 --- loss: 1.256756, loss_ss: 1.114173, loss_d: 0.142583
0.0767 --- loss: 0.936738, loss_ss: 0.714575, loss_d: 0.222163
0.1151 --- loss: 0.667156, loss_ss: 0.619962, loss_d: 0.047195
0.1534 --- loss: 1.505570, loss_ss: 1.207211, loss_d: 0.298360
0.1918 --- loss: 1.432478, loss_ss: 1.045054, loss_d: 0.387424
0.2301 --- loss: 0.748155, loss_ss: 0.692660, loss_d: 0.055495
0.2685 --- loss: 1.457427, loss_ss: 0.942165, loss_d: 0.515261
0.3069 --- loss: 1.213934, loss_ss: 0.742374, loss_d: 0.471561
0.3452 --- loss: 0.914764, loss_ss: 0.676859, loss_d: 0.237905
0.3836 --- loss: 1.029841, loss_ss: 0.966475, loss_d: 0.063366
0.4219 --- loss: 0.880851, loss_ss: 0.680889, loss_d: 0.199962
0.4603 --- loss: 0.858453, loss_ss: 0.596352, loss_d: 0.262102
0.4987 --- loss: 1.013912, loss_ss: 0.920563, loss_d: 0.093349
0.5370 --- loss: 1.494912, loss_ss: 1.400035, loss_d: 0.094877
0.5754 --- loss: 0.776543, loss_ss: 0.574428, loss_d: 0.202115
0.6137 --- loss: 0.809920, loss_ss: 0.579777, loss_d: 0.230143
0.6521 --- loss: 1.335308, loss_ss: 0.688202, loss_d: 0.647106
0.6904 --- loss: 1.328773, loss_ss: 1.099215, loss_d: 0.229558
0.7288 --- loss: 1.027983, loss_ss: 0.694111, loss_d: 0.333873
0.7672 --- loss: 1.311241, loss_ss: 0.833216, loss_d: 0.478025
0.8055 --- loss: 0.860651, loss_ss: 0.741665, loss_d: 0.118986
0.8439 --- loss: 0.660513, loss_ss: 0.580523, loss_d: 0.079989
0.8822 --- loss: 1.120963, loss_ss: 1.064236, loss_d: 0.056727
0.9206 --- loss: 0.961019, loss_ss: 0.668040, loss_d: 0.292979
0.9590 --- loss: 1.200118, loss_ss: 0.966213, loss_d: 0.233905
0.9973 --- loss: 1.356447, loss_ss: 1.223626, loss_d: 0.132821
Epoch finished! Loss: 1.0454215372984226
Starting epoch 5/10.
0.0000 --- loss: 1.117071, loss_ss: 0.944075, loss_d: 0.172996
0.0384 --- loss: 1.248925, loss_ss: 0.653388, loss_d: 0.595537
0.0767 --- loss: 1.014449, loss_ss: 0.792101, loss_d: 0.222348
0.1151 --- loss: 0.834451, loss_ss: 0.774287, loss_d: 0.060164
0.1534 --- loss: 0.660686, loss_ss: 0.600714, loss_d: 0.059972
0.1918 --- loss: 1.252663, loss_ss: 1.113719, loss_d: 0.138944
0.2301 --- loss: 0.956411, loss_ss: 0.835418, loss_d: 0.120993
0.2685 --- loss: 0.781564, loss_ss: 0.670738, loss_d: 0.110826
0.3069 --- loss: 0.703784, loss_ss: 0.673928, loss_d: 0.029856
0.3452 --- loss: 0.791028, loss_ss: 0.611133, loss_d: 0.179895
0.3836 --- loss: 1.045671, loss_ss: 0.998365, loss_d: 0.047306
0.4219 --- loss: 1.146910, loss_ss: 0.666630, loss_d: 0.480280
0.4603 --- loss: 0.890844, loss_ss: 0.784934, loss_d: 0.105910
0.4987 --- loss: 0.677713, loss_ss: 0.556404, loss_d: 0.121309
0.5370 --- loss: 1.437003, loss_ss: 0.963452, loss_d: 0.473552
0.5754 --- loss: 0.883799, loss_ss: 0.662805, loss_d: 0.220994
0.6137 --- loss: 1.353362, loss_ss: 1.168757, loss_d: 0.184605
0.6521 --- loss: 0.867837, loss_ss: 0.629137, loss_d: 0.238699
0.6904 --- loss: 0.651958, loss_ss: 0.627864, loss_d: 0.024094
0.7288 --- loss: 1.178677, loss_ss: 0.837626, loss_d: 0.341051
0.7672 --- loss: 0.966294, loss_ss: 0.631820, loss_d: 0.334473
0.8055 --- loss: 0.995202, loss_ss: 0.843539, loss_d: 0.151663
0.8439 --- loss: 0.882505, loss_ss: 0.687734, loss_d: 0.194771
0.8822 --- loss: 1.050555, loss_ss: 0.890222, loss_d: 0.160333
0.9206 --- loss: 1.225395, loss_ss: 0.954838, loss_d: 0.270557
0.9590 --- loss: 1.374967, loss_ss: 1.259262, loss_d: 0.115705
0.9973 --- loss: 1.578770, loss_ss: 1.318234, loss_d: 0.260536
Epoch finished! Loss: 1.0056928121126616
Starting epoch 6/10.
0.0000 --- loss: 0.952826, loss_ss: 0.889309, loss_d: 0.063518
0.0384 --- loss: 0.971856, loss_ss: 0.930723, loss_d: 0.041133
0.0767 --- loss: 1.000104, loss_ss: 0.657480, loss_d: 0.342623
0.1151 --- loss: 0.699325, loss_ss: 0.624267, loss_d: 0.075059
0.1534 --- loss: 0.650990, loss_ss: 0.597583, loss_d: 0.053406
0.1918 --- loss: 1.199591, loss_ss: 0.850389, loss_d: 0.349202
0.2301 --- loss: 0.943907, loss_ss: 0.630482, loss_d: 0.313425
0.2685 --- loss: 1.029255, loss_ss: 0.944074, loss_d: 0.085181
0.3069 --- loss: 1.113233, loss_ss: 1.043015, loss_d: 0.070218
0.3452 --- loss: 0.669251, loss_ss: 0.640238, loss_d: 0.029013
0.3836 --- loss: 1.075336, loss_ss: 0.953916, loss_d: 0.121420
0.4219 --- loss: 1.095597, loss_ss: 0.876472, loss_d: 0.219124
0.4603 --- loss: 1.143787, loss_ss: 0.996275, loss_d: 0.147512
0.4987 --- loss: 1.379041, loss_ss: 1.020293, loss_d: 0.358748
0.5370 --- loss: 1.060212, loss_ss: 0.515791, loss_d: 0.544422
0.5754 --- loss: 0.820213, loss_ss: 0.733752, loss_d: 0.086461
0.6137 --- loss: 0.987764, loss_ss: 0.876333, loss_d: 0.111431
0.6521 --- loss: 0.620318, loss_ss: 0.597247, loss_d: 0.023070
0.6904 --- loss: 1.517231, loss_ss: 1.336564, loss_d: 0.180667
0.7288 --- loss: 0.734742, loss_ss: 0.590088, loss_d: 0.144655
0.7672 --- loss: 0.849375, loss_ss: 0.760988, loss_d: 0.088387
0.8055 --- loss: 0.729034, loss_ss: 0.620635, loss_d: 0.108400
0.8439 --- loss: 0.601064, loss_ss: 0.542898, loss_d: 0.058166
0.8822 --- loss: 0.757291, loss_ss: 0.735003, loss_d: 0.022288
0.9206 --- loss: 0.624829, loss_ss: 0.577149, loss_d: 0.047679
0.9590 --- loss: 0.680386, loss_ss: 0.606399, loss_d: 0.073988
0.9973 --- loss: 0.755439, loss_ss: 0.642776, loss_d: 0.112663
Epoch finished! Loss: 0.9285210469594368
Starting epoch 7/10.
0.0000 --- loss: 0.834934, loss_ss: 0.619695, loss_d: 0.215240
0.0384 --- loss: 0.647560, loss_ss: 0.580278, loss_d: 0.067282
0.0767 --- loss: 0.856120, loss_ss: 0.767585, loss_d: 0.088535
0.1151 --- loss: 0.971233, loss_ss: 0.820207, loss_d: 0.151026
0.1534 --- loss: 0.849249, loss_ss: 0.818186, loss_d: 0.031063
0.1918 --- loss: 0.702314, loss_ss: 0.672261, loss_d: 0.030053
0.2301 --- loss: 1.616602, loss_ss: 0.907539, loss_d: 0.709063
0.2685 --- loss: 0.657357, loss_ss: 0.558225, loss_d: 0.099132
0.3069 --- loss: 1.154427, loss_ss: 0.843545, loss_d: 0.310883
0.3452 --- loss: 0.830543, loss_ss: 0.715788, loss_d: 0.114754
0.3836 --- loss: 0.911893, loss_ss: 0.872824, loss_d: 0.039069
0.4219 --- loss: 0.957164, loss_ss: 0.911730, loss_d: 0.045434
0.4603 --- loss: 1.073311, loss_ss: 0.753149, loss_d: 0.320162
0.4987 --- loss: 0.936663, loss_ss: 0.639526, loss_d: 0.297137
0.5370 --- loss: 0.967748, loss_ss: 0.736683, loss_d: 0.231065
0.5754 --- loss: 1.382398, loss_ss: 0.995975, loss_d: 0.386423
0.6137 --- loss: 1.248368, loss_ss: 0.921050, loss_d: 0.327318
0.6521 --- loss: 1.257216, loss_ss: 1.057794, loss_d: 0.199422
0.6904 --- loss: 1.031156, loss_ss: 0.876389, loss_d: 0.154766
0.7288 --- loss: 1.164067, loss_ss: 0.765904, loss_d: 0.398163
0.7672 --- loss: 0.678232, loss_ss: 0.524800, loss_d: 0.153432
0.8055 --- loss: 0.544105, loss_ss: 0.515002, loss_d: 0.029103
0.8439 --- loss: 1.846074, loss_ss: 0.633129, loss_d: 1.212945
0.8822 --- loss: 0.582088, loss_ss: 0.569368, loss_d: 0.012720
0.9206 --- loss: 1.096412, loss_ss: 0.772367, loss_d: 0.324046
0.9590 --- loss: 0.789769, loss_ss: 0.750140, loss_d: 0.039629
0.9973 --- loss: 0.720438, loss_ss: 0.699628, loss_d: 0.020810
Epoch finished! Loss: 0.9257287454146605
Starting epoch 8/10.
0.0000 --- loss: 0.985328, loss_ss: 0.563115, loss_d: 0.422213
0.0384 --- loss: 0.829791, loss_ss: 0.810810, loss_d: 0.018981
0.0767 --- loss: 1.077918, loss_ss: 1.063673, loss_d: 0.014245
0.1151 --- loss: 0.822450, loss_ss: 0.816815, loss_d: 0.005635
0.1534 --- loss: 0.804039, loss_ss: 0.700429, loss_d: 0.103610
0.1918 --- loss: 1.248531, loss_ss: 1.018503, loss_d: 0.230028
0.2301 --- loss: 0.955149, loss_ss: 0.890098, loss_d: 0.065052
0.2685 --- loss: 0.744781, loss_ss: 0.593386, loss_d: 0.151395
0.3069 --- loss: 0.852542, loss_ss: 0.701908, loss_d: 0.150635
0.3452 --- loss: 1.229925, loss_ss: 1.208018, loss_d: 0.021907
0.3836 --- loss: 0.932999, loss_ss: 0.595464, loss_d: 0.337535
0.4219 --- loss: 0.723614, loss_ss: 0.672531, loss_d: 0.051083
0.4603 --- loss: 0.766591, loss_ss: 0.746970, loss_d: 0.019620
0.4987 --- loss: 0.625429, loss_ss: 0.585885, loss_d: 0.039544
0.5370 --- loss: 0.661093, loss_ss: 0.637466, loss_d: 0.023627
0.5754 --- loss: 0.975756, loss_ss: 0.779105, loss_d: 0.196650
0.6137 --- loss: 0.687716, loss_ss: 0.621833, loss_d: 0.065883
0.6521 --- loss: 0.884407, loss_ss: 0.597370, loss_d: 0.287037
0.6904 --- loss: 0.850784, loss_ss: 0.831666, loss_d: 0.019118
0.7288 --- loss: 0.665975, loss_ss: 0.620745, loss_d: 0.045229
0.7672 --- loss: 0.840205, loss_ss: 0.786880, loss_d: 0.053325
0.8055 --- loss: 0.508264, loss_ss: 0.479175, loss_d: 0.029089
0.8439 --- loss: 1.423085, loss_ss: 1.141953, loss_d: 0.281132
0.8822 --- loss: 0.744793, loss_ss: 0.509603, loss_d: 0.235190
0.9206 --- loss: 0.800829, loss_ss: 0.661390, loss_d: 0.139439
0.9590 --- loss: 1.038310, loss_ss: 0.824928, loss_d: 0.213382
0.9973 --- loss: 1.315841, loss_ss: 1.189816, loss_d: 0.126025
Epoch finished! Loss: 0.8840577251636065
Starting epoch 9/10.
0.0000 --- loss: 0.887333, loss_ss: 0.876719, loss_d: 0.010613
0.0384 --- loss: 1.309085, loss_ss: 0.721543, loss_d: 0.587543
0.0767 --- loss: 0.918975, loss_ss: 0.837124, loss_d: 0.081851
0.1151 --- loss: 0.864151, loss_ss: 0.824161, loss_d: 0.039990
0.1534 --- loss: 0.887895, loss_ss: 0.856408, loss_d: 0.031487
0.1918 --- loss: 0.893732, loss_ss: 0.851086, loss_d: 0.042646
0.2301 --- loss: 0.921785, loss_ss: 0.798054, loss_d: 0.123732
0.2685 --- loss: 0.932378, loss_ss: 0.584607, loss_d: 0.347771
0.3069 --- loss: 0.798904, loss_ss: 0.700790, loss_d: 0.098114
0.3452 --- loss: 2.079926, loss_ss: 0.885377, loss_d: 1.194549
0.3836 --- loss: 0.712667, loss_ss: 0.648799, loss_d: 0.063869
0.4219 --- loss: 0.779135, loss_ss: 0.712495, loss_d: 0.066640
0.4603 --- loss: 0.701562, loss_ss: 0.642459, loss_d: 0.059103
0.4987 --- loss: 0.640495, loss_ss: 0.612006, loss_d: 0.028488
0.5370 --- loss: 1.233326, loss_ss: 0.850580, loss_d: 0.382746
0.5754 --- loss: 0.617651, loss_ss: 0.555093, loss_d: 0.062558
0.6137 --- loss: 0.887597, loss_ss: 0.798488, loss_d: 0.089109
0.6521 --- loss: 0.725656, loss_ss: 0.689912, loss_d: 0.035743
0.6904 --- loss: 1.064187, loss_ss: 0.777430, loss_d: 0.286757
0.7288 --- loss: 1.101535, loss_ss: 1.036442, loss_d: 0.065093
0.7672 --- loss: 0.897215, loss_ss: 0.854297, loss_d: 0.042918
0.8055 --- loss: 0.863215, loss_ss: 0.828995, loss_d: 0.034220
0.8439 --- loss: 0.973466, loss_ss: 0.898155, loss_d: 0.075311
0.8822 --- loss: 0.847345, loss_ss: 0.729079, loss_d: 0.118266
0.9206 --- loss: 0.582804, loss_ss: 0.575863, loss_d: 0.006941
0.9590 --- loss: 0.525147, loss_ss: 0.467884, loss_d: 0.057263
0.9973 --- loss: 0.780005, loss_ss: 0.590828, loss_d: 0.189176
Epoch finished! Loss: 0.8612606339729749
Starting epoch 10/10.
0.0000 --- loss: 0.716217, loss_ss: 0.696727, loss_d: 0.019490
0.0384 --- loss: 0.711039, loss_ss: 0.686118, loss_d: 0.024921
0.0767 --- loss: 0.884311, loss_ss: 0.735105, loss_d: 0.149205
0.1151 --- loss: 0.748110, loss_ss: 0.739924, loss_d: 0.008185
0.1534 --- loss: 0.780970, loss_ss: 0.733069, loss_d: 0.047901
0.1918 --- loss: 0.885970, loss_ss: 0.506138, loss_d: 0.379832
0.2301 --- loss: 0.731008, loss_ss: 0.722455, loss_d: 0.008553
0.2685 --- loss: 0.707062, loss_ss: 0.691660, loss_d: 0.015403
0.3069 --- loss: 0.533334, loss_ss: 0.501517, loss_d: 0.031817
0.3452 --- loss: 0.909724, loss_ss: 0.461514, loss_d: 0.448210
0.3836 --- loss: 0.560751, loss_ss: 0.478232, loss_d: 0.082519
0.4219 --- loss: 0.761187, loss_ss: 0.675166, loss_d: 0.086021
0.4603 --- loss: 0.887752, loss_ss: 0.688812, loss_d: 0.198941
0.4987 --- loss: 0.739369, loss_ss: 0.707770, loss_d: 0.031599
0.5370 --- loss: 0.619112, loss_ss: 0.600749, loss_d: 0.018363
0.5754 --- loss: 0.718393, loss_ss: 0.705827, loss_d: 0.012566
0.6137 --- loss: 0.848454, loss_ss: 0.809747, loss_d: 0.038707
0.6521 --- loss: 0.895846, loss_ss: 0.575550, loss_d: 0.320296
0.6904 --- loss: 1.024964, loss_ss: 0.541255, loss_d: 0.483709
0.7288 --- loss: 0.550268, loss_ss: 0.534234, loss_d: 0.016034
0.7672 --- loss: 0.583832, loss_ss: 0.520501, loss_d: 0.063331
0.8055 --- loss: 0.676541, loss_ss: 0.658174, loss_d: 0.018367
0.8439 --- loss: 0.675903, loss_ss: 0.478973, loss_d: 0.196930
0.8822 --- loss: 0.637324, loss_ss: 0.616847, loss_d: 0.020476
0.9206 --- loss: 0.829252, loss_ss: 0.799250, loss_d: 0.030002
0.9590 --- loss: 0.775850, loss_ss: 0.649319, loss_d: 0.126532
0.9973 --- loss: 0.653505, loss_ss: 0.650515, loss_d: 0.002990
Epoch finished! Loss: 0.8319755119773058
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8139784946236559
             precision    recall  f1-score   support

        0.0       0.79      0.90      0.84        58
        1.0       0.07      0.04      0.05        55
        2.0       0.77      0.93      0.84       412
        3.0       0.93      0.83      0.88       182
        4.0       0.94      0.76      0.84       223

avg / total       0.80      0.81      0.80       930
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.85  89.66   98.39  78.79     83.87
1  91.51   3.64   97.03   7.14      4.82
2  84.84  92.72   78.57  77.48     84.42
3  95.38  82.97   98.40  92.64     87.54
4  93.23  76.23   98.59  94.44     84.37
Total accuracy: 81.40%
Average sen: 69.04%
Average spec: 94.20%
Macro f1-score: 69.00%
Diagnosis acc on 15mins: 0.967741935483871
[0.99999785 0.99953127 0.97753775 0.98376298 0.99995255 0.74155897
 0.53453028 0.47436994 0.9864493  0.95719665 0.9999032  1.
 0.99895656 0.9987191  0.99739206 0.99344784 0.97781599 0.99999189
 0.99729902 0.99705243 0.99814498 0.96775299 0.99227154 0.9891209
 0.9906131  1.         0.99794632 0.98678672 0.99653059 0.99370354
 0.98703426]
pred: 0.9521087292701967, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.393810, loss_ss: 1.682177, loss_d: 0.711633
0.0384 --- loss: 2.246987, loss_ss: 1.601827, loss_d: 0.645160
0.0768 --- loss: 2.237665, loss_ss: 1.630871, loss_d: 0.606794
0.1152 --- loss: 2.339297, loss_ss: 1.499139, loss_d: 0.840158
0.1536 --- loss: 2.017304, loss_ss: 1.490247, loss_d: 0.527058
0.1920 --- loss: 2.184530, loss_ss: 1.523598, loss_d: 0.660932
0.2304 --- loss: 2.067980, loss_ss: 1.287618, loss_d: 0.780362
0.2688 --- loss: 1.818074, loss_ss: 1.396280, loss_d: 0.421794
0.3072 --- loss: 2.087729, loss_ss: 1.295387, loss_d: 0.792342
0.3456 --- loss: 1.919485, loss_ss: 1.331011, loss_d: 0.588475
0.3840 --- loss: 1.817885, loss_ss: 1.278209, loss_d: 0.539675
0.4224 --- loss: 2.324678, loss_ss: 1.282905, loss_d: 1.041773
0.4608 --- loss: 1.842695, loss_ss: 1.283565, loss_d: 0.559129
0.4992 --- loss: 1.972733, loss_ss: 1.320592, loss_d: 0.652141
0.5376 --- loss: 1.834575, loss_ss: 1.212969, loss_d: 0.621606
0.5760 --- loss: 1.815617, loss_ss: 1.235169, loss_d: 0.580448
0.6144 --- loss: 1.894437, loss_ss: 1.225053, loss_d: 0.669384
0.6528 --- loss: 1.837490, loss_ss: 1.378276, loss_d: 0.459214
0.6912 --- loss: 1.641419, loss_ss: 1.147094, loss_d: 0.494325
0.7296 --- loss: 2.308195, loss_ss: 1.391083, loss_d: 0.917112
0.7680 --- loss: 1.846095, loss_ss: 1.200094, loss_d: 0.646001
0.8065 --- loss: 1.560837, loss_ss: 1.178282, loss_d: 0.382555
0.8449 --- loss: 1.396920, loss_ss: 1.080277, loss_d: 0.316643
0.8833 --- loss: 1.653016, loss_ss: 1.043145, loss_d: 0.609871
0.9217 --- loss: 1.296336, loss_ss: 1.052918, loss_d: 0.243418
0.9601 --- loss: 1.189158, loss_ss: 1.022815, loss_d: 0.166343
0.9985 --- loss: 2.701506, loss_ss: 1.085456, loss_d: 1.616051
Epoch finished! Loss: 1.861320660664485
Starting epoch 2/10.
0.0000 --- loss: 1.459286, loss_ss: 1.036812, loss_d: 0.422474
0.0384 --- loss: 1.455436, loss_ss: 1.121796, loss_d: 0.333640
0.0768 --- loss: 1.289870, loss_ss: 1.140675, loss_d: 0.149195
0.1152 --- loss: 1.330081, loss_ss: 1.160905, loss_d: 0.169176
0.1536 --- loss: 1.621885, loss_ss: 1.088585, loss_d: 0.533300
0.1920 --- loss: 1.430118, loss_ss: 1.100448, loss_d: 0.329670
0.2304 --- loss: 1.402162, loss_ss: 1.078161, loss_d: 0.324001
0.2688 --- loss: 1.299127, loss_ss: 1.085334, loss_d: 0.213792
0.3072 --- loss: 1.214859, loss_ss: 1.127654, loss_d: 0.087205
0.3456 --- loss: 1.436878, loss_ss: 1.072832, loss_d: 0.364046
0.3840 --- loss: 1.170745, loss_ss: 0.976800, loss_d: 0.193945
0.4224 --- loss: 1.195153, loss_ss: 1.000438, loss_d: 0.194715
0.4608 --- loss: 0.972748, loss_ss: 0.793340, loss_d: 0.179408
0.4992 --- loss: 1.333620, loss_ss: 0.987466, loss_d: 0.346155
0.5376 --- loss: 1.366057, loss_ss: 1.207604, loss_d: 0.158453
0.5760 --- loss: 1.246523, loss_ss: 1.098077, loss_d: 0.148446
0.6144 --- loss: 1.144200, loss_ss: 0.882027, loss_d: 0.262173
0.6528 --- loss: 1.554186, loss_ss: 1.274966, loss_d: 0.279221
0.6912 --- loss: 1.228493, loss_ss: 0.990929, loss_d: 0.237564
0.7296 --- loss: 1.058490, loss_ss: 0.965154, loss_d: 0.093336
0.7680 --- loss: 1.439546, loss_ss: 0.947910, loss_d: 0.491637
0.8065 --- loss: 1.196657, loss_ss: 0.826502, loss_d: 0.370155
0.8449 --- loss: 1.344179, loss_ss: 0.964174, loss_d: 0.380005
0.8833 --- loss: 1.347493, loss_ss: 1.102711, loss_d: 0.244783
0.9217 --- loss: 1.493597, loss_ss: 1.183242, loss_d: 0.310356
0.9601 --- loss: 1.243692, loss_ss: 0.981692, loss_d: 0.261999
0.9985 --- loss: 2.152907, loss_ss: 1.140706, loss_d: 1.012201
Epoch finished! Loss: 1.3833387601834077
Starting epoch 3/10.
0.0000 --- loss: 1.140483, loss_ss: 0.825930, loss_d: 0.314553
0.0384 --- loss: 1.351893, loss_ss: 0.778156, loss_d: 0.573737
0.0768 --- loss: 1.096412, loss_ss: 0.903785, loss_d: 0.192627
0.1152 --- loss: 0.980397, loss_ss: 0.816048, loss_d: 0.164349
0.1536 --- loss: 1.440214, loss_ss: 1.164664, loss_d: 0.275551
0.1920 --- loss: 1.140285, loss_ss: 0.895634, loss_d: 0.244651
0.2304 --- loss: 1.009043, loss_ss: 0.649662, loss_d: 0.359380
0.2688 --- loss: 1.157588, loss_ss: 1.035737, loss_d: 0.121851
0.3072 --- loss: 1.344894, loss_ss: 0.752083, loss_d: 0.592811
0.3456 --- loss: 1.248005, loss_ss: 0.860362, loss_d: 0.387643
0.3840 --- loss: 1.015146, loss_ss: 0.768011, loss_d: 0.247135
0.4224 --- loss: 1.297760, loss_ss: 0.931933, loss_d: 0.365827
0.4608 --- loss: 1.012431, loss_ss: 0.770354, loss_d: 0.242077
0.4992 --- loss: 1.083911, loss_ss: 0.881793, loss_d: 0.202117
0.5376 --- loss: 0.995082, loss_ss: 0.872540, loss_d: 0.122542
0.5760 --- loss: 0.958430, loss_ss: 0.863898, loss_d: 0.094532
0.6144 --- loss: 0.947327, loss_ss: 0.886025, loss_d: 0.061302
0.6528 --- loss: 1.373039, loss_ss: 1.121554, loss_d: 0.251485
0.6912 --- loss: 1.004594, loss_ss: 0.799070, loss_d: 0.205524
0.7296 --- loss: 1.323018, loss_ss: 0.947782, loss_d: 0.375236
0.7680 --- loss: 1.035944, loss_ss: 0.785768, loss_d: 0.250176
0.8065 --- loss: 1.631601, loss_ss: 0.895699, loss_d: 0.735903
0.8449 --- loss: 1.552931, loss_ss: 1.207157, loss_d: 0.345773
0.8833 --- loss: 1.145727, loss_ss: 0.887347, loss_d: 0.258380
0.9217 --- loss: 1.248893, loss_ss: 0.937600, loss_d: 0.311293
0.9601 --- loss: 0.938905, loss_ss: 0.728029, loss_d: 0.210876
0.9985 --- loss: 1.280962, loss_ss: 1.220224, loss_d: 0.060737
Epoch finished! Loss: 1.1886524551189863
Starting epoch 4/10.
0.0000 --- loss: 1.133078, loss_ss: 0.985806, loss_d: 0.147272
0.0384 --- loss: 1.244842, loss_ss: 0.874381, loss_d: 0.370461
0.0768 --- loss: 0.904609, loss_ss: 0.845809, loss_d: 0.058799
0.1152 --- loss: 1.146154, loss_ss: 0.933406, loss_d: 0.212749
0.1536 --- loss: 1.040118, loss_ss: 0.885693, loss_d: 0.154425
0.1920 --- loss: 1.011920, loss_ss: 0.906269, loss_d: 0.105652
0.2304 --- loss: 1.016764, loss_ss: 0.996681, loss_d: 0.020083
0.2688 --- loss: 1.128792, loss_ss: 0.624377, loss_d: 0.504416
0.3072 --- loss: 1.078224, loss_ss: 0.884568, loss_d: 0.193656
0.3456 --- loss: 0.940703, loss_ss: 0.862700, loss_d: 0.078003
0.3840 --- loss: 1.167117, loss_ss: 0.830896, loss_d: 0.336221
0.4224 --- loss: 1.072815, loss_ss: 0.792332, loss_d: 0.280484
0.4608 --- loss: 0.828127, loss_ss: 0.614355, loss_d: 0.213772
0.4992 --- loss: 1.018264, loss_ss: 0.959494, loss_d: 0.058769
0.5376 --- loss: 1.354975, loss_ss: 1.142863, loss_d: 0.212112
0.5760 --- loss: 0.858822, loss_ss: 0.776397, loss_d: 0.082425
0.6144 --- loss: 1.150480, loss_ss: 0.757128, loss_d: 0.393352
0.6528 --- loss: 1.102823, loss_ss: 1.021081, loss_d: 0.081742
0.6912 --- loss: 1.173676, loss_ss: 0.815431, loss_d: 0.358245
0.7296 --- loss: 0.991438, loss_ss: 0.856758, loss_d: 0.134680
0.7680 --- loss: 1.044239, loss_ss: 0.879476, loss_d: 0.164763
0.8065 --- loss: 1.177363, loss_ss: 0.880788, loss_d: 0.296576
0.8449 --- loss: 0.809615, loss_ss: 0.661309, loss_d: 0.148306
0.8833 --- loss: 1.111992, loss_ss: 0.854887, loss_d: 0.257106
0.9217 --- loss: 0.685136, loss_ss: 0.650928, loss_d: 0.034208
0.9601 --- loss: 0.594850, loss_ss: 0.543121, loss_d: 0.051729
0.9985 --- loss: 1.090376, loss_ss: 1.053724, loss_d: 0.036652
Epoch finished! Loss: 1.0806707116273733
Starting epoch 5/10.
0.0000 --- loss: 1.122930, loss_ss: 0.824635, loss_d: 0.298296
0.0384 --- loss: 0.812876, loss_ss: 0.716891, loss_d: 0.095986
0.0768 --- loss: 1.198658, loss_ss: 0.927261, loss_d: 0.271398
0.1152 --- loss: 0.896888, loss_ss: 0.800310, loss_d: 0.096578
0.1536 --- loss: 0.954009, loss_ss: 0.632202, loss_d: 0.321807
0.1920 --- loss: 1.058799, loss_ss: 0.949975, loss_d: 0.108823
0.2304 --- loss: 1.513871, loss_ss: 0.744429, loss_d: 0.769442
0.2688 --- loss: 1.126467, loss_ss: 1.099779, loss_d: 0.026688
0.3072 --- loss: 0.756400, loss_ss: 0.631324, loss_d: 0.125076
0.3456 --- loss: 1.328929, loss_ss: 0.966641, loss_d: 0.362288
0.3840 --- loss: 0.815827, loss_ss: 0.684120, loss_d: 0.131707
0.4224 --- loss: 0.734316, loss_ss: 0.683187, loss_d: 0.051129
0.4608 --- loss: 1.175913, loss_ss: 0.920466, loss_d: 0.255448
0.4992 --- loss: 0.889439, loss_ss: 0.777507, loss_d: 0.111932
0.5376 --- loss: 1.123773, loss_ss: 0.787994, loss_d: 0.335779
0.5760 --- loss: 1.320718, loss_ss: 1.132530, loss_d: 0.188188
0.6144 --- loss: 0.944798, loss_ss: 0.806874, loss_d: 0.137924
0.6528 --- loss: 1.013347, loss_ss: 0.874349, loss_d: 0.138998
0.6912 --- loss: 0.735821, loss_ss: 0.667607, loss_d: 0.068215
0.7296 --- loss: 0.921283, loss_ss: 0.751029, loss_d: 0.170253
0.7680 --- loss: 0.779421, loss_ss: 0.564066, loss_d: 0.215355
0.8065 --- loss: 1.094783, loss_ss: 0.997697, loss_d: 0.097086
0.8449 --- loss: 2.662798, loss_ss: 0.636034, loss_d: 2.026764
0.8833 --- loss: 1.073551, loss_ss: 0.951137, loss_d: 0.122414
0.9217 --- loss: 0.811960, loss_ss: 0.609342, loss_d: 0.202617
0.9601 --- loss: 0.724462, loss_ss: 0.687262, loss_d: 0.037200
0.9985 --- loss: 1.518723, loss_ss: 1.293967, loss_d: 0.224756
Epoch finished! Loss: 1.0112591915405713
Starting epoch 6/10.
0.0000 --- loss: 0.828133, loss_ss: 0.794878, loss_d: 0.033256
0.0384 --- loss: 0.727428, loss_ss: 0.664020, loss_d: 0.063408
0.0768 --- loss: 0.943346, loss_ss: 0.646536, loss_d: 0.296811
0.1152 --- loss: 1.079952, loss_ss: 0.647621, loss_d: 0.432331
0.1536 --- loss: 0.854408, loss_ss: 0.730323, loss_d: 0.124086
0.1920 --- loss: 0.830965, loss_ss: 0.779696, loss_d: 0.051268
0.2304 --- loss: 0.817373, loss_ss: 0.791692, loss_d: 0.025681
0.2688 --- loss: 0.701366, loss_ss: 0.684942, loss_d: 0.016424
0.3072 --- loss: 0.880561, loss_ss: 0.855382, loss_d: 0.025179
0.3456 --- loss: 1.184430, loss_ss: 0.781879, loss_d: 0.402551
0.3840 --- loss: 1.335242, loss_ss: 1.046169, loss_d: 0.289073
0.4224 --- loss: 0.752269, loss_ss: 0.677535, loss_d: 0.074734
0.4608 --- loss: 1.379665, loss_ss: 1.039438, loss_d: 0.340227
0.4992 --- loss: 0.832059, loss_ss: 0.816487, loss_d: 0.015572
0.5376 --- loss: 0.919504, loss_ss: 0.828736, loss_d: 0.090768
0.5760 --- loss: 0.738372, loss_ss: 0.637093, loss_d: 0.101280
0.6144 --- loss: 1.132694, loss_ss: 1.044691, loss_d: 0.088003
0.6528 --- loss: 0.960737, loss_ss: 0.893329, loss_d: 0.067408
0.6912 --- loss: 1.534914, loss_ss: 0.799446, loss_d: 0.735467
0.7296 --- loss: 0.669419, loss_ss: 0.637325, loss_d: 0.032093
0.7680 --- loss: 1.074886, loss_ss: 0.982673, loss_d: 0.092213
0.8065 --- loss: 0.719190, loss_ss: 0.645914, loss_d: 0.073276
0.8449 --- loss: 1.137207, loss_ss: 0.965629, loss_d: 0.171578
0.8833 --- loss: 0.902530, loss_ss: 0.840666, loss_d: 0.061863
0.9217 --- loss: 0.697854, loss_ss: 0.674286, loss_d: 0.023568
0.9601 --- loss: 0.716387, loss_ss: 0.701502, loss_d: 0.014885
0.9985 --- loss: 0.789348, loss_ss: 0.694443, loss_d: 0.094905
Epoch finished! Loss: 0.9331853210926055
Starting epoch 7/10.
0.0000 --- loss: 0.703310, loss_ss: 0.691417, loss_d: 0.011893
0.0384 --- loss: 0.676961, loss_ss: 0.651382, loss_d: 0.025578
0.0768 --- loss: 0.875994, loss_ss: 0.849439, loss_d: 0.026555
0.1152 --- loss: 1.186682, loss_ss: 0.979688, loss_d: 0.206994
0.1536 --- loss: 0.825148, loss_ss: 0.808031, loss_d: 0.017116
0.1920 --- loss: 0.848628, loss_ss: 0.702208, loss_d: 0.146420
0.2304 --- loss: 1.190180, loss_ss: 1.023498, loss_d: 0.166682
0.2688 --- loss: 1.042587, loss_ss: 0.917426, loss_d: 0.125161
0.3072 --- loss: 0.847663, loss_ss: 0.755877, loss_d: 0.091786
0.3456 --- loss: 0.843213, loss_ss: 0.699085, loss_d: 0.144129
0.3840 --- loss: 1.582172, loss_ss: 1.131287, loss_d: 0.450885
0.4224 --- loss: 1.047642, loss_ss: 0.973262, loss_d: 0.074380
0.4608 --- loss: 0.866156, loss_ss: 0.727812, loss_d: 0.138344
0.4992 --- loss: 0.905416, loss_ss: 0.808075, loss_d: 0.097341
0.5376 --- loss: 0.773892, loss_ss: 0.683288, loss_d: 0.090604
0.5760 --- loss: 1.914744, loss_ss: 0.539991, loss_d: 1.374753
0.6144 --- loss: 0.979074, loss_ss: 0.933302, loss_d: 0.045772
0.6528 --- loss: 1.129049, loss_ss: 1.033339, loss_d: 0.095710
0.6912 --- loss: 1.024030, loss_ss: 0.919288, loss_d: 0.104742
0.7296 --- loss: 0.871551, loss_ss: 0.766878, loss_d: 0.104673
0.7680 --- loss: 0.635072, loss_ss: 0.620513, loss_d: 0.014558
0.8065 --- loss: 0.773786, loss_ss: 0.748311, loss_d: 0.025476
0.8449 --- loss: 0.571465, loss_ss: 0.534847, loss_d: 0.036618
0.8833 --- loss: 0.757293, loss_ss: 0.743577, loss_d: 0.013716
0.9217 --- loss: 0.824766, loss_ss: 0.766511, loss_d: 0.058255
0.9601 --- loss: 0.699917, loss_ss: 0.694276, loss_d: 0.005641
0.9985 --- loss: 0.770506, loss_ss: 0.762289, loss_d: 0.008217
Epoch finished! Loss: 0.9236043325983561
Starting epoch 8/10.
0.0000 --- loss: 0.889222, loss_ss: 0.875455, loss_d: 0.013768
0.0384 --- loss: 0.769640, loss_ss: 0.751583, loss_d: 0.018057
0.0768 --- loss: 0.530750, loss_ss: 0.525286, loss_d: 0.005464
0.1152 --- loss: 1.009629, loss_ss: 0.576963, loss_d: 0.432666
0.1536 --- loss: 0.944906, loss_ss: 0.920182, loss_d: 0.024724
0.1920 --- loss: 1.007177, loss_ss: 0.980687, loss_d: 0.026490
0.2304 --- loss: 0.745547, loss_ss: 0.708691, loss_d: 0.036856
0.2688 --- loss: 0.854056, loss_ss: 0.833382, loss_d: 0.020674
0.3072 --- loss: 0.726698, loss_ss: 0.704244, loss_d: 0.022454
0.3456 --- loss: 0.967767, loss_ss: 0.956051, loss_d: 0.011716
0.3840 --- loss: 0.845705, loss_ss: 0.711606, loss_d: 0.134100
0.4224 --- loss: 0.741697, loss_ss: 0.707768, loss_d: 0.033929
0.4608 --- loss: 0.706516, loss_ss: 0.536925, loss_d: 0.169591
0.4992 --- loss: 0.671375, loss_ss: 0.658514, loss_d: 0.012860
0.5376 --- loss: 1.090224, loss_ss: 0.972422, loss_d: 0.117802
0.5760 --- loss: 0.551236, loss_ss: 0.536997, loss_d: 0.014240
0.6144 --- loss: 0.867834, loss_ss: 0.857134, loss_d: 0.010700
0.6528 --- loss: 0.715359, loss_ss: 0.650185, loss_d: 0.065174
0.6912 --- loss: 0.583875, loss_ss: 0.521631, loss_d: 0.062244
0.7296 --- loss: 0.850436, loss_ss: 0.633535, loss_d: 0.216901
0.7680 --- loss: 0.662103, loss_ss: 0.632774, loss_d: 0.029329
0.8065 --- loss: 0.496455, loss_ss: 0.491512, loss_d: 0.004943
0.8449 --- loss: 0.695893, loss_ss: 0.667653, loss_d: 0.028240
0.8833 --- loss: 0.712727, loss_ss: 0.604838, loss_d: 0.107889
0.9217 --- loss: 0.710263, loss_ss: 0.659058, loss_d: 0.051204
0.9601 --- loss: 0.780064, loss_ss: 0.738592, loss_d: 0.041472
0.9985 --- loss: 0.608415, loss_ss: 0.541133, loss_d: 0.067282
Epoch finished! Loss: 0.8633610971845114
Starting epoch 9/10.
0.0000 --- loss: 0.776102, loss_ss: 0.764934, loss_d: 0.011168
0.0384 --- loss: 0.807078, loss_ss: 0.777208, loss_d: 0.029870
0.0768 --- loss: 0.791596, loss_ss: 0.676832, loss_d: 0.114764
0.1152 --- loss: 1.043888, loss_ss: 0.782891, loss_d: 0.260997
0.1536 --- loss: 0.667472, loss_ss: 0.659645, loss_d: 0.007827
0.1920 --- loss: 0.843111, loss_ss: 0.834036, loss_d: 0.009075
0.2304 --- loss: 0.830018, loss_ss: 0.735227, loss_d: 0.094790
0.2688 --- loss: 0.620246, loss_ss: 0.593418, loss_d: 0.026828
0.3072 --- loss: 0.901536, loss_ss: 0.853103, loss_d: 0.048434
0.3456 --- loss: 0.763102, loss_ss: 0.748860, loss_d: 0.014242
0.3840 --- loss: 0.685459, loss_ss: 0.682327, loss_d: 0.003133
0.4224 --- loss: 0.594038, loss_ss: 0.587325, loss_d: 0.006712
0.4608 --- loss: 0.745499, loss_ss: 0.670405, loss_d: 0.075094
0.4992 --- loss: 0.510339, loss_ss: 0.503819, loss_d: 0.006520
0.5376 --- loss: 0.918414, loss_ss: 0.911083, loss_d: 0.007331
0.5760 --- loss: 1.135608, loss_ss: 0.657696, loss_d: 0.477911
0.6144 --- loss: 1.065994, loss_ss: 0.915844, loss_d: 0.150150
0.6528 --- loss: 0.682127, loss_ss: 0.680202, loss_d: 0.001925
0.6912 --- loss: 0.843212, loss_ss: 0.693749, loss_d: 0.149464
0.7296 --- loss: 0.656138, loss_ss: 0.627269, loss_d: 0.028869
0.7680 --- loss: 0.593419, loss_ss: 0.557278, loss_d: 0.036141
0.8065 --- loss: 1.282973, loss_ss: 0.779986, loss_d: 0.502987
0.8449 --- loss: 0.636257, loss_ss: 0.617475, loss_d: 0.018782
0.8833 --- loss: 0.961238, loss_ss: 0.857040, loss_d: 0.104198
0.9217 --- loss: 0.682642, loss_ss: 0.601936, loss_d: 0.080706
0.9601 --- loss: 0.552163, loss_ss: 0.501413, loss_d: 0.050750
0.9985 --- loss: 1.192662, loss_ss: 1.182159, loss_d: 0.010503
Epoch finished! Loss: 0.8417119239385311
Starting epoch 10/10.
0.0000 --- loss: 0.745811, loss_ss: 0.629519, loss_d: 0.116292
0.0384 --- loss: 0.886670, loss_ss: 0.602682, loss_d: 0.283988
0.0768 --- loss: 0.830152, loss_ss: 0.805099, loss_d: 0.025053
0.1152 --- loss: 1.236520, loss_ss: 0.896645, loss_d: 0.339875
0.1536 --- loss: 0.744280, loss_ss: 0.579349, loss_d: 0.164930
0.1920 --- loss: 1.599298, loss_ss: 0.888554, loss_d: 0.710744
0.2304 --- loss: 0.705285, loss_ss: 0.684009, loss_d: 0.021276
0.2688 --- loss: 0.656898, loss_ss: 0.636712, loss_d: 0.020185
0.3072 --- loss: 0.968019, loss_ss: 0.891337, loss_d: 0.076682
0.3456 --- loss: 0.781499, loss_ss: 0.752446, loss_d: 0.029053
0.3840 --- loss: 0.567820, loss_ss: 0.437898, loss_d: 0.129922
0.4224 --- loss: 0.911757, loss_ss: 0.895471, loss_d: 0.016286
0.4608 --- loss: 0.843354, loss_ss: 0.796933, loss_d: 0.046422
0.4992 --- loss: 0.833980, loss_ss: 0.663081, loss_d: 0.170899
0.5376 --- loss: 0.670545, loss_ss: 0.667295, loss_d: 0.003250
0.5760 --- loss: 0.830042, loss_ss: 0.592408, loss_d: 0.237634
0.6144 --- loss: 1.292378, loss_ss: 0.955160, loss_d: 0.337218
0.6528 --- loss: 1.039541, loss_ss: 0.881779, loss_d: 0.157762
0.6912 --- loss: 0.611124, loss_ss: 0.574180, loss_d: 0.036944
0.7296 --- loss: 0.689282, loss_ss: 0.683045, loss_d: 0.006237
0.7680 --- loss: 1.904861, loss_ss: 0.664962, loss_d: 1.239899
0.8065 --- loss: 0.560789, loss_ss: 0.545783, loss_d: 0.015006
0.8449 --- loss: 0.641021, loss_ss: 0.628450, loss_d: 0.012570
0.8833 --- loss: 0.755753, loss_ss: 0.724303, loss_d: 0.031450
0.9217 --- loss: 0.634904, loss_ss: 0.590823, loss_d: 0.044081
0.9601 --- loss: 0.521040, loss_ss: 0.493567, loss_d: 0.027473
0.9985 --- loss: 1.025570, loss_ss: 1.024909, loss_d: 0.000661
Epoch finished! Loss: 0.8246975089494999
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7644749754661433
             precision    recall  f1-score   support

        0.0       0.92      0.78      0.84       101
        1.0       0.24      0.47      0.32        55
        2.0       0.74      0.83      0.78       382
        3.0       0.82      0.66      0.73       191
        4.0       0.95      0.80      0.87       290

avg / total       0.81      0.76      0.78      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.15  78.22   99.24  91.86     84.49
1  89.01  47.27   91.39  23.85     31.71
2  82.83  82.72   82.89  74.35     78.31
3  90.87  65.97   96.62  81.82     73.04
4  93.03  80.00   98.22  94.69     86.73
Total accuracy: 76.45%
Average sen: 70.84%
Average spec: 93.67%
Macro f1-score: 70.86%
Diagnosis acc on 15mins: 1.0
[0.99999261 0.96398854 0.9983778  0.99999607 0.99999416 0.99992657
 0.99986458 0.99903983 0.99976534 0.99992943 0.99999714 0.99999905
 0.99999928 0.99998772 0.99892622 0.99551374 0.99956018 0.99991345
 0.99977368 0.99996829 0.99997938 0.99968433 0.99995661 0.99906152
 0.99892634 0.99997079 0.99999619 0.99999988 0.99999976 0.99999201
 0.99905246 0.99928218 0.99844557 0.9756881 ]
pred: 0.9977808471988229, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.323509, loss_ss: 1.621325, loss_d: 0.702184
0.0384 --- loss: 2.688608, loss_ss: 1.484463, loss_d: 1.204145
0.0768 --- loss: 2.620354, loss_ss: 1.678053, loss_d: 0.942301
0.1152 --- loss: 2.126792, loss_ss: 1.646112, loss_d: 0.480679
0.1536 --- loss: 1.938851, loss_ss: 1.424317, loss_d: 0.514534
0.1920 --- loss: 2.541623, loss_ss: 1.615821, loss_d: 0.925802
0.2304 --- loss: 1.949971, loss_ss: 1.499046, loss_d: 0.450924
0.2688 --- loss: 1.736174, loss_ss: 1.460894, loss_d: 0.275280
0.3072 --- loss: 1.944110, loss_ss: 1.449857, loss_d: 0.494253
0.3456 --- loss: 2.165596, loss_ss: 1.557236, loss_d: 0.608360
0.3840 --- loss: 1.971780, loss_ss: 1.460943, loss_d: 0.510837
0.4224 --- loss: 2.037166, loss_ss: 1.383956, loss_d: 0.653209
0.4608 --- loss: 1.929812, loss_ss: 1.400958, loss_d: 0.528854
0.4992 --- loss: 1.750848, loss_ss: 1.331491, loss_d: 0.419357
0.5376 --- loss: 2.204144, loss_ss: 1.508660, loss_d: 0.695483
0.5760 --- loss: 2.133430, loss_ss: 1.394069, loss_d: 0.739361
0.6144 --- loss: 1.786596, loss_ss: 1.343999, loss_d: 0.442597
0.6528 --- loss: 2.099376, loss_ss: 1.368685, loss_d: 0.730691
0.6912 --- loss: 1.657579, loss_ss: 1.372346, loss_d: 0.285233
0.7296 --- loss: 1.632941, loss_ss: 1.329382, loss_d: 0.303559
0.7680 --- loss: 1.560698, loss_ss: 1.253574, loss_d: 0.307124
0.8065 --- loss: 1.966035, loss_ss: 1.164322, loss_d: 0.801712
0.8449 --- loss: 1.607045, loss_ss: 1.262309, loss_d: 0.344736
0.8833 --- loss: 1.607087, loss_ss: 1.258419, loss_d: 0.348667
0.9217 --- loss: 2.123581, loss_ss: 1.370903, loss_d: 0.752678
0.9601 --- loss: 1.687654, loss_ss: 1.225018, loss_d: 0.462636
0.9985 --- loss: 2.563886, loss_ss: 1.256520, loss_d: 1.307366
Epoch finished! Loss: 1.9765822713191692
Starting epoch 2/10.
0.0000 --- loss: 1.588669, loss_ss: 1.175313, loss_d: 0.413356
0.0384 --- loss: 1.657211, loss_ss: 1.369693, loss_d: 0.287519
0.0768 --- loss: 1.557542, loss_ss: 1.207003, loss_d: 0.350538
0.1152 --- loss: 1.907641, loss_ss: 1.121982, loss_d: 0.785659
0.1536 --- loss: 1.511871, loss_ss: 1.140334, loss_d: 0.371537
0.1920 --- loss: 1.471654, loss_ss: 1.124027, loss_d: 0.347627
0.2304 --- loss: 1.673026, loss_ss: 1.051924, loss_d: 0.621101
0.2688 --- loss: 1.201604, loss_ss: 1.084603, loss_d: 0.117001
0.3072 --- loss: 1.426611, loss_ss: 0.950190, loss_d: 0.476421
0.3456 --- loss: 1.738274, loss_ss: 1.068053, loss_d: 0.670221
0.3840 --- loss: 1.620464, loss_ss: 1.334223, loss_d: 0.286241
0.4224 --- loss: 1.701987, loss_ss: 1.166249, loss_d: 0.535738
0.4608 --- loss: 1.439606, loss_ss: 1.112615, loss_d: 0.326991
0.4992 --- loss: 1.472322, loss_ss: 1.044290, loss_d: 0.428032
0.5376 --- loss: 1.423000, loss_ss: 1.165879, loss_d: 0.257121
0.5760 --- loss: 1.644846, loss_ss: 0.905540, loss_d: 0.739305
0.6144 --- loss: 1.334649, loss_ss: 1.048914, loss_d: 0.285735
0.6528 --- loss: 1.276161, loss_ss: 0.973879, loss_d: 0.302283
0.6912 --- loss: 1.259119, loss_ss: 1.022700, loss_d: 0.236419
0.7296 --- loss: 1.514443, loss_ss: 1.159790, loss_d: 0.354654
0.7680 --- loss: 1.413416, loss_ss: 1.007314, loss_d: 0.406102
0.8065 --- loss: 1.508058, loss_ss: 1.061573, loss_d: 0.446486
0.8449 --- loss: 0.963029, loss_ss: 0.872957, loss_d: 0.090071
0.8833 --- loss: 1.523644, loss_ss: 1.033266, loss_d: 0.490378
0.9217 --- loss: 1.910941, loss_ss: 0.987057, loss_d: 0.923884
0.9601 --- loss: 1.406552, loss_ss: 1.138881, loss_d: 0.267671
0.9985 --- loss: 1.541542, loss_ss: 1.027209, loss_d: 0.514333
Epoch finished! Loss: 1.4640279510846506
Starting epoch 3/10.
0.0000 --- loss: 1.546786, loss_ss: 0.859871, loss_d: 0.686915
0.0384 --- loss: 1.767303, loss_ss: 0.831124, loss_d: 0.936179
0.0768 --- loss: 1.283796, loss_ss: 1.049473, loss_d: 0.234324
0.1152 --- loss: 1.041645, loss_ss: 0.950030, loss_d: 0.091614
0.1536 --- loss: 1.376617, loss_ss: 1.131719, loss_d: 0.244899
0.1920 --- loss: 1.231266, loss_ss: 1.003533, loss_d: 0.227734
0.2304 --- loss: 1.308860, loss_ss: 1.169269, loss_d: 0.139591
0.2688 --- loss: 1.345265, loss_ss: 1.257620, loss_d: 0.087645
0.3072 --- loss: 1.428780, loss_ss: 1.221062, loss_d: 0.207718
0.3456 --- loss: 1.022117, loss_ss: 0.976228, loss_d: 0.045889
0.3840 --- loss: 1.190469, loss_ss: 0.930071, loss_d: 0.260398
0.4224 --- loss: 1.130750, loss_ss: 0.883169, loss_d: 0.247581
0.4608 --- loss: 1.054429, loss_ss: 0.916947, loss_d: 0.137482
0.4992 --- loss: 1.403851, loss_ss: 1.172533, loss_d: 0.231318
0.5376 --- loss: 1.332773, loss_ss: 0.998526, loss_d: 0.334247
0.5760 --- loss: 1.061603, loss_ss: 0.919135, loss_d: 0.142468
0.6144 --- loss: 1.361916, loss_ss: 1.314215, loss_d: 0.047701
0.6528 --- loss: 1.325090, loss_ss: 1.120344, loss_d: 0.204746
0.6912 --- loss: 1.125010, loss_ss: 1.063243, loss_d: 0.061768
0.7296 --- loss: 1.143309, loss_ss: 0.924181, loss_d: 0.219127
0.7680 --- loss: 0.893628, loss_ss: 0.696276, loss_d: 0.197352
0.8065 --- loss: 1.054959, loss_ss: 0.942554, loss_d: 0.112406
0.8449 --- loss: 1.028634, loss_ss: 0.852001, loss_d: 0.176634
0.8833 --- loss: 1.146320, loss_ss: 0.900628, loss_d: 0.245692
0.9217 --- loss: 1.300949, loss_ss: 1.043686, loss_d: 0.257263
0.9601 --- loss: 1.046393, loss_ss: 0.781097, loss_d: 0.265296
0.9985 --- loss: 2.179893, loss_ss: 0.981127, loss_d: 1.198766
Epoch finished! Loss: 1.2435864929969493
Starting epoch 4/10.
0.0000 --- loss: 1.150564, loss_ss: 0.866413, loss_d: 0.284152
0.0384 --- loss: 0.943405, loss_ss: 0.855549, loss_d: 0.087856
0.0768 --- loss: 1.191499, loss_ss: 0.772309, loss_d: 0.419191
0.1152 --- loss: 0.949177, loss_ss: 0.865048, loss_d: 0.084129
0.1536 --- loss: 0.977787, loss_ss: 0.686342, loss_d: 0.291445
0.1920 --- loss: 1.173003, loss_ss: 1.003458, loss_d: 0.169545
0.2304 --- loss: 1.094251, loss_ss: 0.728918, loss_d: 0.365333
0.2688 --- loss: 0.929206, loss_ss: 0.893028, loss_d: 0.036178
0.3072 --- loss: 0.875185, loss_ss: 0.834382, loss_d: 0.040803
0.3456 --- loss: 1.207163, loss_ss: 1.161010, loss_d: 0.046153
0.3840 --- loss: 1.317635, loss_ss: 0.723146, loss_d: 0.594489
0.4224 --- loss: 1.064823, loss_ss: 0.826378, loss_d: 0.238445
0.4608 --- loss: 1.356168, loss_ss: 0.937286, loss_d: 0.418882
0.4992 --- loss: 1.007180, loss_ss: 0.757091, loss_d: 0.250089
0.5376 --- loss: 1.419230, loss_ss: 0.761236, loss_d: 0.657995
0.5760 --- loss: 0.783669, loss_ss: 0.709638, loss_d: 0.074031
0.6144 --- loss: 0.850066, loss_ss: 0.804021, loss_d: 0.046045
0.6528 --- loss: 1.007156, loss_ss: 0.739304, loss_d: 0.267853
0.6912 --- loss: 1.044447, loss_ss: 0.915632, loss_d: 0.128816
0.7296 --- loss: 0.944813, loss_ss: 0.841268, loss_d: 0.103546
0.7680 --- loss: 0.913842, loss_ss: 0.901911, loss_d: 0.011930
0.8065 --- loss: 0.793744, loss_ss: 0.676211, loss_d: 0.117533
0.8449 --- loss: 0.930648, loss_ss: 0.857625, loss_d: 0.073022
0.8833 --- loss: 1.103188, loss_ss: 0.837793, loss_d: 0.265395
0.9217 --- loss: 1.263884, loss_ss: 1.123768, loss_d: 0.140117
0.9601 --- loss: 0.770176, loss_ss: 0.745692, loss_d: 0.024484
0.9985 --- loss: 1.365928, loss_ss: 0.665668, loss_d: 0.700260
Epoch finished! Loss: 1.1034138574050023
Starting epoch 5/10.
0.0000 --- loss: 1.089777, loss_ss: 0.667018, loss_d: 0.422760
0.0384 --- loss: 1.040534, loss_ss: 0.759941, loss_d: 0.280593
0.0768 --- loss: 1.223061, loss_ss: 0.803879, loss_d: 0.419183
0.1152 --- loss: 1.298006, loss_ss: 0.916176, loss_d: 0.381830
0.1536 --- loss: 1.074479, loss_ss: 0.952104, loss_d: 0.122374
0.1920 --- loss: 0.993594, loss_ss: 0.925931, loss_d: 0.067663
0.2304 --- loss: 0.846560, loss_ss: 0.825276, loss_d: 0.021285
0.2688 --- loss: 1.375093, loss_ss: 0.851254, loss_d: 0.523839
0.3072 --- loss: 1.416612, loss_ss: 0.810428, loss_d: 0.606184
0.3456 --- loss: 1.025246, loss_ss: 0.795979, loss_d: 0.229267
0.3840 --- loss: 0.767162, loss_ss: 0.723178, loss_d: 0.043983
0.4224 --- loss: 0.799139, loss_ss: 0.720220, loss_d: 0.078919
0.4608 --- loss: 1.602326, loss_ss: 1.522687, loss_d: 0.079639
0.4992 --- loss: 0.739788, loss_ss: 0.684518, loss_d: 0.055270
0.5376 --- loss: 1.370568, loss_ss: 0.895472, loss_d: 0.475096
0.5760 --- loss: 0.748729, loss_ss: 0.714504, loss_d: 0.034225
0.6144 --- loss: 1.225177, loss_ss: 1.169401, loss_d: 0.055776
0.6528 --- loss: 0.901033, loss_ss: 0.806294, loss_d: 0.094740
0.6912 --- loss: 0.871744, loss_ss: 0.826875, loss_d: 0.044869
0.7296 --- loss: 1.211874, loss_ss: 0.745827, loss_d: 0.466047
0.7680 --- loss: 1.376616, loss_ss: 1.337113, loss_d: 0.039503
0.8065 --- loss: 1.117382, loss_ss: 0.662153, loss_d: 0.455229
0.8449 --- loss: 0.937161, loss_ss: 0.768486, loss_d: 0.168675
0.8833 --- loss: 0.760797, loss_ss: 0.752315, loss_d: 0.008482
0.9217 --- loss: 0.984474, loss_ss: 0.809354, loss_d: 0.175120
0.9601 --- loss: 1.154078, loss_ss: 1.055966, loss_d: 0.098112
0.9985 --- loss: 1.109677, loss_ss: 0.417576, loss_d: 0.692101
Epoch finished! Loss: 1.0075478253456263
Starting epoch 6/10.
0.0000 --- loss: 1.276805, loss_ss: 1.101222, loss_d: 0.175584
0.0384 --- loss: 1.148559, loss_ss: 0.799703, loss_d: 0.348856
0.0768 --- loss: 0.924167, loss_ss: 0.716018, loss_d: 0.208149
0.1152 --- loss: 0.807337, loss_ss: 0.776532, loss_d: 0.030805
0.1536 --- loss: 0.826017, loss_ss: 0.779759, loss_d: 0.046258
0.1920 --- loss: 0.703627, loss_ss: 0.480171, loss_d: 0.223455
0.2304 --- loss: 1.017733, loss_ss: 0.936432, loss_d: 0.081301
0.2688 --- loss: 1.293731, loss_ss: 0.960223, loss_d: 0.333508
0.3072 --- loss: 0.822986, loss_ss: 0.793535, loss_d: 0.029451
0.3456 --- loss: 0.736916, loss_ss: 0.638117, loss_d: 0.098799
0.3840 --- loss: 0.703233, loss_ss: 0.644165, loss_d: 0.059068
0.4224 --- loss: 0.853546, loss_ss: 0.692843, loss_d: 0.160703
0.4608 --- loss: 1.056570, loss_ss: 0.636235, loss_d: 0.420335
0.4992 --- loss: 0.617972, loss_ss: 0.590386, loss_d: 0.027587
0.5376 --- loss: 0.856408, loss_ss: 0.848909, loss_d: 0.007498
0.5760 --- loss: 0.908165, loss_ss: 0.774770, loss_d: 0.133396
0.6144 --- loss: 0.629814, loss_ss: 0.577903, loss_d: 0.051911
0.6528 --- loss: 0.879901, loss_ss: 0.774544, loss_d: 0.105357
0.6912 --- loss: 0.801600, loss_ss: 0.729205, loss_d: 0.072395
0.7296 --- loss: 0.933195, loss_ss: 0.724447, loss_d: 0.208748
0.7680 --- loss: 1.071496, loss_ss: 0.925493, loss_d: 0.146003
0.8065 --- loss: 1.049028, loss_ss: 0.689912, loss_d: 0.359116
0.8449 --- loss: 1.029017, loss_ss: 0.837430, loss_d: 0.191587
0.8833 --- loss: 0.513336, loss_ss: 0.493379, loss_d: 0.019956
0.9217 --- loss: 0.870920, loss_ss: 0.761107, loss_d: 0.109813
0.9601 --- loss: 0.985461, loss_ss: 0.801259, loss_d: 0.184202
0.9985 --- loss: 2.430348, loss_ss: 0.478639, loss_d: 1.951709
Epoch finished! Loss: 0.9524574692432697
Starting epoch 7/10.
0.0000 --- loss: 1.022761, loss_ss: 0.789717, loss_d: 0.233044
0.0384 --- loss: 1.147651, loss_ss: 0.874820, loss_d: 0.272831
0.0768 --- loss: 0.799807, loss_ss: 0.740034, loss_d: 0.059773
0.1152 --- loss: 0.775253, loss_ss: 0.513489, loss_d: 0.261764
0.1536 --- loss: 1.263627, loss_ss: 0.708260, loss_d: 0.555367
0.1920 --- loss: 0.941964, loss_ss: 0.913240, loss_d: 0.028725
0.2304 --- loss: 1.239563, loss_ss: 1.190940, loss_d: 0.048623
0.2688 --- loss: 0.674197, loss_ss: 0.604788, loss_d: 0.069408
0.3072 --- loss: 0.774885, loss_ss: 0.716824, loss_d: 0.058061
0.3456 --- loss: 0.745097, loss_ss: 0.530497, loss_d: 0.214600
0.3840 --- loss: 1.083293, loss_ss: 1.024174, loss_d: 0.059118
0.4224 --- loss: 0.775397, loss_ss: 0.707583, loss_d: 0.067814
0.4608 --- loss: 0.929949, loss_ss: 0.833470, loss_d: 0.096480
0.4992 --- loss: 0.863969, loss_ss: 0.855128, loss_d: 0.008841
0.5376 --- loss: 0.677085, loss_ss: 0.669528, loss_d: 0.007557
0.5760 --- loss: 1.058495, loss_ss: 1.050482, loss_d: 0.008013
0.6144 --- loss: 0.782222, loss_ss: 0.736181, loss_d: 0.046041
0.6528 --- loss: 0.968549, loss_ss: 0.890430, loss_d: 0.078119
0.6912 --- loss: 0.602316, loss_ss: 0.474848, loss_d: 0.127467
0.7296 --- loss: 1.533553, loss_ss: 1.006053, loss_d: 0.527500
0.7680 --- loss: 0.724944, loss_ss: 0.681972, loss_d: 0.042972
0.8065 --- loss: 1.013810, loss_ss: 0.817543, loss_d: 0.196267
0.8449 --- loss: 1.356644, loss_ss: 1.227097, loss_d: 0.129548
0.8833 --- loss: 1.041791, loss_ss: 0.924607, loss_d: 0.117184
0.9217 --- loss: 0.657454, loss_ss: 0.618524, loss_d: 0.038930
0.9601 --- loss: 0.891370, loss_ss: 0.875257, loss_d: 0.016113
0.9985 --- loss: 0.887947, loss_ss: 0.791214, loss_d: 0.096733
Epoch finished! Loss: 0.9078345130269344
Starting epoch 8/10.
0.0000 --- loss: 0.670171, loss_ss: 0.596931, loss_d: 0.073240
0.0384 --- loss: 1.390032, loss_ss: 1.053515, loss_d: 0.336517
0.0768 --- loss: 0.847524, loss_ss: 0.840054, loss_d: 0.007470
0.1152 --- loss: 0.625758, loss_ss: 0.577492, loss_d: 0.048266
0.1536 --- loss: 1.146017, loss_ss: 0.775453, loss_d: 0.370564
0.1920 --- loss: 1.080420, loss_ss: 0.939652, loss_d: 0.140767
0.2304 --- loss: 0.864308, loss_ss: 0.827159, loss_d: 0.037149
0.2688 --- loss: 0.834792, loss_ss: 0.805359, loss_d: 0.029433
0.3072 --- loss: 1.186248, loss_ss: 1.129664, loss_d: 0.056584
0.3456 --- loss: 0.850261, loss_ss: 0.777046, loss_d: 0.073214
0.3840 --- loss: 1.179929, loss_ss: 0.776914, loss_d: 0.403016
0.4224 --- loss: 0.991304, loss_ss: 0.979021, loss_d: 0.012283
0.4608 --- loss: 1.092979, loss_ss: 1.015687, loss_d: 0.077292
0.4992 --- loss: 1.041123, loss_ss: 1.028105, loss_d: 0.013018
0.5376 --- loss: 0.528777, loss_ss: 0.496369, loss_d: 0.032408
0.5760 --- loss: 0.619228, loss_ss: 0.597111, loss_d: 0.022117
0.6144 --- loss: 0.850364, loss_ss: 0.819858, loss_d: 0.030505
0.6528 --- loss: 0.700608, loss_ss: 0.669774, loss_d: 0.030834
0.6912 --- loss: 0.702826, loss_ss: 0.566031, loss_d: 0.136795
0.7296 --- loss: 0.865326, loss_ss: 0.850922, loss_d: 0.014404
0.7680 --- loss: 0.740112, loss_ss: 0.665499, loss_d: 0.074614
0.8065 --- loss: 0.889980, loss_ss: 0.652984, loss_d: 0.236995
0.8449 --- loss: 0.779090, loss_ss: 0.708212, loss_d: 0.070878
0.8833 --- loss: 1.042321, loss_ss: 0.907194, loss_d: 0.135127
0.9217 --- loss: 1.006961, loss_ss: 0.998417, loss_d: 0.008543
0.9601 --- loss: 0.836739, loss_ss: 0.775909, loss_d: 0.060830
0.9985 --- loss: 0.889478, loss_ss: 0.884934, loss_d: 0.004544
Epoch finished! Loss: 0.8874349019848383
Starting epoch 9/10.
0.0000 --- loss: 0.615302, loss_ss: 0.547935, loss_d: 0.067367
0.0384 --- loss: 0.718416, loss_ss: 0.708470, loss_d: 0.009946
0.0768 --- loss: 0.683612, loss_ss: 0.679110, loss_d: 0.004501
0.1152 --- loss: 0.785916, loss_ss: 0.653446, loss_d: 0.132470
0.1536 --- loss: 0.733712, loss_ss: 0.720968, loss_d: 0.012745
0.1920 --- loss: 0.793869, loss_ss: 0.535675, loss_d: 0.258194
0.2304 --- loss: 0.524448, loss_ss: 0.510014, loss_d: 0.014434
0.2688 --- loss: 1.221628, loss_ss: 1.210997, loss_d: 0.010632
0.3072 --- loss: 0.857229, loss_ss: 0.810327, loss_d: 0.046903
0.3456 --- loss: 1.168015, loss_ss: 0.928185, loss_d: 0.239830
0.3840 --- loss: 1.446429, loss_ss: 0.710420, loss_d: 0.736009
0.4224 --- loss: 1.049092, loss_ss: 0.887927, loss_d: 0.161165
0.4608 --- loss: 0.779341, loss_ss: 0.734453, loss_d: 0.044888
0.4992 --- loss: 1.188653, loss_ss: 0.812107, loss_d: 0.376545
0.5376 --- loss: 0.669263, loss_ss: 0.664507, loss_d: 0.004756
0.5760 --- loss: 0.642258, loss_ss: 0.609275, loss_d: 0.032982
0.6144 --- loss: 0.692891, loss_ss: 0.664041, loss_d: 0.028850
0.6528 --- loss: 0.815943, loss_ss: 0.806037, loss_d: 0.009906
0.6912 --- loss: 0.618972, loss_ss: 0.606431, loss_d: 0.012541
0.7296 --- loss: 0.944495, loss_ss: 0.809399, loss_d: 0.135096
0.7680 --- loss: 0.679348, loss_ss: 0.674482, loss_d: 0.004866
0.8065 --- loss: 0.911439, loss_ss: 0.901231, loss_d: 0.010208
0.8449 --- loss: 0.871331, loss_ss: 0.829387, loss_d: 0.041943
0.8833 --- loss: 0.796186, loss_ss: 0.756381, loss_d: 0.039805
0.9217 --- loss: 0.569440, loss_ss: 0.554289, loss_d: 0.015150
0.9601 --- loss: 0.771115, loss_ss: 0.762880, loss_d: 0.008235
0.9985 --- loss: 0.863481, loss_ss: 0.646314, loss_d: 0.217167
Epoch finished! Loss: 0.8300588181385627
Starting epoch 10/10.
0.0000 --- loss: 1.114642, loss_ss: 1.006356, loss_d: 0.108287
0.0384 --- loss: 0.701755, loss_ss: 0.602580, loss_d: 0.099175
0.0768 --- loss: 0.741141, loss_ss: 0.733954, loss_d: 0.007188
0.1152 --- loss: 0.481104, loss_ss: 0.479295, loss_d: 0.001809
0.1536 --- loss: 0.696452, loss_ss: 0.693458, loss_d: 0.002994
0.1920 --- loss: 0.679185, loss_ss: 0.642503, loss_d: 0.036682
0.2304 --- loss: 0.824990, loss_ss: 0.798866, loss_d: 0.026124
0.2688 --- loss: 0.627668, loss_ss: 0.621235, loss_d: 0.006433
0.3072 --- loss: 0.607198, loss_ss: 0.559454, loss_d: 0.047744
0.3456 --- loss: 0.608669, loss_ss: 0.567335, loss_d: 0.041334
0.3840 --- loss: 0.777901, loss_ss: 0.741554, loss_d: 0.036347
0.4224 --- loss: 0.839855, loss_ss: 0.836261, loss_d: 0.003594
0.4608 --- loss: 0.601897, loss_ss: 0.575893, loss_d: 0.026004
0.4992 --- loss: 0.499352, loss_ss: 0.490329, loss_d: 0.009023
0.5376 --- loss: 0.705029, loss_ss: 0.648517, loss_d: 0.056512
0.5760 --- loss: 0.739932, loss_ss: 0.736236, loss_d: 0.003696
0.6144 --- loss: 1.134271, loss_ss: 1.133181, loss_d: 0.001090
0.6528 --- loss: 1.066676, loss_ss: 0.686567, loss_d: 0.380109
0.6912 --- loss: 0.925963, loss_ss: 0.798685, loss_d: 0.127278
0.7296 --- loss: 0.785864, loss_ss: 0.718577, loss_d: 0.067287
0.7680 --- loss: 0.556577, loss_ss: 0.531777, loss_d: 0.024800
0.8065 --- loss: 0.969670, loss_ss: 0.695693, loss_d: 0.273977
0.8449 --- loss: 0.707895, loss_ss: 0.703409, loss_d: 0.004486
0.8833 --- loss: 0.873978, loss_ss: 0.863854, loss_d: 0.010125
0.9217 --- loss: 0.815673, loss_ss: 0.650969, loss_d: 0.164704
0.9601 --- loss: 0.795664, loss_ss: 0.785393, loss_d: 0.010271
0.9985 --- loss: 2.220318, loss_ss: 0.606908, loss_d: 1.613410
Epoch finished! Loss: 0.8100146056367801
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6519607843137255
             precision    recall  f1-score   support

        0.0       0.76      0.82      0.79        66
        1.0       0.15      0.59      0.24        44
        2.0       0.62      0.67      0.65       406
        3.0       1.00      0.53      0.70       334
        4.0       0.82      0.79      0.80       170

avg / total       0.77      0.65      0.68      1020
 


====== chp029-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.16  81.82   98.22   76.06     78.83
1  84.02  59.09   85.14   15.20     24.19
2  70.88  67.24   73.29   62.47     64.77
3  84.71  53.29  100.00  100.00     69.53
4  93.63  78.82   96.59   82.21     80.48
Total accuracy: 65.20%
Average sen: 68.05%
Average spec: 90.65%
Macro f1-score: 63.56%
Diagnosis acc on 15mins: 1.0
[0.99388677 0.99931908 0.99743146 0.98807341 0.99999678 0.99997759
 0.99992299 0.99567598 0.99470139 0.99999988 0.99999917 0.99966812
 0.99999976 0.99999166 0.99865073 0.99213082 0.99707735 0.9999758
 0.99044144 0.99196941 0.99781883 0.99086833 0.99999738 0.9998492
 0.99998343 0.99924135 0.9937588  0.99998879 0.99999821 0.99999988
 0.99997461 0.99744737 0.95189804 0.97172654]
pred: 0.9953364800004398, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.222899, loss_ss: 1.586175, loss_d: 0.636724
0.0385 --- loss: 2.341365, loss_ss: 1.646174, loss_d: 0.695191
0.0770 --- loss: 2.248386, loss_ss: 1.550658, loss_d: 0.697729
0.1155 --- loss: 2.471964, loss_ss: 1.486225, loss_d: 0.985740
0.1540 --- loss: 2.080586, loss_ss: 1.542947, loss_d: 0.537639
0.1925 --- loss: 2.052007, loss_ss: 1.426124, loss_d: 0.625883
0.2309 --- loss: 1.902825, loss_ss: 1.501388, loss_d: 0.401437
0.2694 --- loss: 2.026443, loss_ss: 1.486945, loss_d: 0.539498
0.3079 --- loss: 2.218494, loss_ss: 1.562316, loss_d: 0.656178
0.3464 --- loss: 2.120405, loss_ss: 1.429010, loss_d: 0.691395
0.3849 --- loss: 2.006168, loss_ss: 1.446898, loss_d: 0.559270
0.4234 --- loss: 1.771004, loss_ss: 1.245316, loss_d: 0.525688
0.4619 --- loss: 1.786294, loss_ss: 1.288099, loss_d: 0.498196
0.5004 --- loss: 2.138486, loss_ss: 1.323531, loss_d: 0.814955
0.5389 --- loss: 2.022173, loss_ss: 1.369330, loss_d: 0.652843
0.5774 --- loss: 1.782730, loss_ss: 1.188219, loss_d: 0.594511
0.6159 --- loss: 1.807021, loss_ss: 1.241026, loss_d: 0.565995
0.6543 --- loss: 2.039794, loss_ss: 1.463859, loss_d: 0.575935
0.6928 --- loss: 2.066946, loss_ss: 1.357503, loss_d: 0.709443
0.7313 --- loss: 1.680430, loss_ss: 1.180136, loss_d: 0.500294
0.7698 --- loss: 1.483708, loss_ss: 1.220788, loss_d: 0.262921
0.8083 --- loss: 1.761228, loss_ss: 1.212554, loss_d: 0.548674
0.8468 --- loss: 1.450285, loss_ss: 1.225377, loss_d: 0.224908
0.8853 --- loss: 1.688422, loss_ss: 1.236062, loss_d: 0.452360
0.9238 --- loss: 1.859527, loss_ss: 1.148547, loss_d: 0.710980
0.9623 --- loss: 1.388055, loss_ss: 1.069146, loss_d: 0.318909
Epoch finished! Loss: 1.8993934121371236
Starting epoch 2/10.
0.0000 --- loss: 1.292981, loss_ss: 0.993181, loss_d: 0.299800
0.0385 --- loss: 1.420229, loss_ss: 1.118507, loss_d: 0.301722
0.0770 --- loss: 1.155971, loss_ss: 1.051870, loss_d: 0.104101
0.1155 --- loss: 1.721867, loss_ss: 0.965236, loss_d: 0.756631
0.1540 --- loss: 1.394588, loss_ss: 1.067803, loss_d: 0.326784
0.1925 --- loss: 1.664202, loss_ss: 1.244521, loss_d: 0.419681
0.2309 --- loss: 1.305146, loss_ss: 1.042417, loss_d: 0.262729
0.2694 --- loss: 1.054947, loss_ss: 0.964989, loss_d: 0.089957
0.3079 --- loss: 1.330658, loss_ss: 1.036800, loss_d: 0.293858
0.3464 --- loss: 1.215343, loss_ss: 1.075757, loss_d: 0.139585
0.3849 --- loss: 1.397971, loss_ss: 1.006133, loss_d: 0.391839
0.4234 --- loss: 1.484521, loss_ss: 1.253130, loss_d: 0.231391
0.4619 --- loss: 1.281929, loss_ss: 0.997601, loss_d: 0.284328
0.5004 --- loss: 1.403981, loss_ss: 1.054711, loss_d: 0.349270
0.5389 --- loss: 1.433834, loss_ss: 1.258471, loss_d: 0.175363
0.5774 --- loss: 2.088714, loss_ss: 1.014834, loss_d: 1.073880
0.6159 --- loss: 1.081299, loss_ss: 0.948903, loss_d: 0.132395
0.6543 --- loss: 1.331445, loss_ss: 0.982395, loss_d: 0.349050
0.6928 --- loss: 1.292670, loss_ss: 0.932148, loss_d: 0.360522
0.7313 --- loss: 1.871193, loss_ss: 0.952382, loss_d: 0.918811
0.7698 --- loss: 1.363255, loss_ss: 1.203648, loss_d: 0.159607
0.8083 --- loss: 1.060355, loss_ss: 0.745669, loss_d: 0.314686
0.8468 --- loss: 1.828982, loss_ss: 0.886774, loss_d: 0.942208
0.8853 --- loss: 1.544060, loss_ss: 1.064267, loss_d: 0.479794
0.9238 --- loss: 1.337920, loss_ss: 1.080777, loss_d: 0.257143
0.9623 --- loss: 0.948432, loss_ss: 0.783983, loss_d: 0.164450
Epoch finished! Loss: 1.3569467613135526
Starting epoch 3/10.
0.0000 --- loss: 0.812026, loss_ss: 0.712496, loss_d: 0.099531
0.0385 --- loss: 1.240276, loss_ss: 0.870953, loss_d: 0.369323
0.0770 --- loss: 1.082289, loss_ss: 0.915377, loss_d: 0.166912
0.1155 --- loss: 1.198820, loss_ss: 1.006689, loss_d: 0.192131
0.1540 --- loss: 0.967643, loss_ss: 0.903101, loss_d: 0.064542
0.1925 --- loss: 1.394901, loss_ss: 1.241793, loss_d: 0.153108
0.2309 --- loss: 1.262381, loss_ss: 1.041507, loss_d: 0.220874
0.2694 --- loss: 1.520538, loss_ss: 0.869607, loss_d: 0.650931
0.3079 --- loss: 0.936471, loss_ss: 0.793334, loss_d: 0.143136
0.3464 --- loss: 1.217635, loss_ss: 1.083184, loss_d: 0.134451
0.3849 --- loss: 0.953169, loss_ss: 0.893596, loss_d: 0.059573
0.4234 --- loss: 1.358556, loss_ss: 1.035677, loss_d: 0.322879
0.4619 --- loss: 1.077277, loss_ss: 0.945567, loss_d: 0.131710
0.5004 --- loss: 1.161751, loss_ss: 1.022386, loss_d: 0.139365
0.5389 --- loss: 1.162237, loss_ss: 0.997978, loss_d: 0.164258
0.5774 --- loss: 1.071143, loss_ss: 0.782832, loss_d: 0.288311
0.6159 --- loss: 1.933718, loss_ss: 0.896977, loss_d: 1.036742
0.6543 --- loss: 1.661639, loss_ss: 1.117632, loss_d: 0.544007
0.6928 --- loss: 1.235923, loss_ss: 0.873184, loss_d: 0.362739
0.7313 --- loss: 0.938098, loss_ss: 0.737271, loss_d: 0.200827
0.7698 --- loss: 1.179035, loss_ss: 1.041164, loss_d: 0.137870
0.8083 --- loss: 0.813525, loss_ss: 0.739258, loss_d: 0.074266
0.8468 --- loss: 1.319919, loss_ss: 1.047224, loss_d: 0.272695
0.8853 --- loss: 1.500468, loss_ss: 1.087958, loss_d: 0.412510
0.9238 --- loss: 1.047766, loss_ss: 1.031754, loss_d: 0.016012
0.9623 --- loss: 1.419413, loss_ss: 1.090198, loss_d: 0.329215
Epoch finished! Loss: 1.1584530666067794
Starting epoch 4/10.
0.0000 --- loss: 1.346748, loss_ss: 0.985239, loss_d: 0.361510
0.0385 --- loss: 1.179354, loss_ss: 1.010066, loss_d: 0.169288
0.0770 --- loss: 0.816642, loss_ss: 0.690319, loss_d: 0.126323
0.1155 --- loss: 0.816463, loss_ss: 0.668874, loss_d: 0.147589
0.1540 --- loss: 1.040258, loss_ss: 0.958164, loss_d: 0.082094
0.1925 --- loss: 1.108602, loss_ss: 0.990492, loss_d: 0.118111
0.2309 --- loss: 0.684098, loss_ss: 0.663886, loss_d: 0.020212
0.2694 --- loss: 0.716968, loss_ss: 0.670554, loss_d: 0.046414
0.3079 --- loss: 0.868119, loss_ss: 0.839305, loss_d: 0.028814
0.3464 --- loss: 0.833480, loss_ss: 0.827432, loss_d: 0.006049
0.3849 --- loss: 1.070249, loss_ss: 0.937982, loss_d: 0.132267
0.4234 --- loss: 0.818561, loss_ss: 0.730601, loss_d: 0.087961
0.4619 --- loss: 1.365593, loss_ss: 0.827982, loss_d: 0.537612
0.5004 --- loss: 1.145506, loss_ss: 0.963363, loss_d: 0.182143
0.5389 --- loss: 0.999361, loss_ss: 0.811196, loss_d: 0.188164
0.5774 --- loss: 1.203407, loss_ss: 0.817166, loss_d: 0.386241
0.6159 --- loss: 0.745561, loss_ss: 0.683133, loss_d: 0.062428
0.6543 --- loss: 0.916447, loss_ss: 0.861004, loss_d: 0.055444
0.6928 --- loss: 1.393702, loss_ss: 1.107570, loss_d: 0.286132
0.7313 --- loss: 1.164084, loss_ss: 0.907788, loss_d: 0.256296
0.7698 --- loss: 0.876049, loss_ss: 0.802284, loss_d: 0.073765
0.8083 --- loss: 1.020858, loss_ss: 0.747556, loss_d: 0.273302
0.8468 --- loss: 0.928827, loss_ss: 0.893584, loss_d: 0.035243
0.8853 --- loss: 1.006380, loss_ss: 0.811251, loss_d: 0.195129
0.9238 --- loss: 1.034528, loss_ss: 0.847686, loss_d: 0.186842
0.9623 --- loss: 0.785395, loss_ss: 0.765620, loss_d: 0.019775
Epoch finished! Loss: 1.047472676024934
Starting epoch 5/10.
0.0000 --- loss: 1.135899, loss_ss: 0.873676, loss_d: 0.262223
0.0385 --- loss: 0.688428, loss_ss: 0.624252, loss_d: 0.064176
0.0770 --- loss: 1.051151, loss_ss: 0.745861, loss_d: 0.305290
0.1155 --- loss: 0.895195, loss_ss: 0.819158, loss_d: 0.076038
0.1540 --- loss: 1.022758, loss_ss: 0.864883, loss_d: 0.157876
0.1925 --- loss: 0.959933, loss_ss: 0.935571, loss_d: 0.024362
0.2309 --- loss: 1.294614, loss_ss: 0.876159, loss_d: 0.418455
0.2694 --- loss: 0.586411, loss_ss: 0.530755, loss_d: 0.055657
0.3079 --- loss: 0.925029, loss_ss: 0.847543, loss_d: 0.077486
0.3464 --- loss: 1.391266, loss_ss: 1.315071, loss_d: 0.076195
0.3849 --- loss: 1.141846, loss_ss: 0.827214, loss_d: 0.314631
0.4234 --- loss: 1.290100, loss_ss: 0.753370, loss_d: 0.536731
0.4619 --- loss: 0.709935, loss_ss: 0.672486, loss_d: 0.037449
0.5004 --- loss: 0.609441, loss_ss: 0.578302, loss_d: 0.031139
0.5389 --- loss: 1.084444, loss_ss: 0.873683, loss_d: 0.210761
0.5774 --- loss: 1.402932, loss_ss: 0.832934, loss_d: 0.569997
0.6159 --- loss: 0.766544, loss_ss: 0.745507, loss_d: 0.021037
0.6543 --- loss: 0.840151, loss_ss: 0.759645, loss_d: 0.080507
0.6928 --- loss: 0.772883, loss_ss: 0.739319, loss_d: 0.033564
0.7313 --- loss: 0.829406, loss_ss: 0.724794, loss_d: 0.104612
0.7698 --- loss: 0.991405, loss_ss: 0.919277, loss_d: 0.072127
0.8083 --- loss: 0.918909, loss_ss: 0.691412, loss_d: 0.227497
0.8468 --- loss: 0.765406, loss_ss: 0.742571, loss_d: 0.022835
0.8853 --- loss: 0.952958, loss_ss: 0.688816, loss_d: 0.264141
0.9238 --- loss: 0.720861, loss_ss: 0.681151, loss_d: 0.039709
0.9623 --- loss: 0.767217, loss_ss: 0.760237, loss_d: 0.006980
Epoch finished! Loss: 0.9840815299726361
Starting epoch 6/10.
0.0000 --- loss: 0.741750, loss_ss: 0.709932, loss_d: 0.031818
0.0385 --- loss: 1.111431, loss_ss: 1.076376, loss_d: 0.035055
0.0770 --- loss: 0.674163, loss_ss: 0.533424, loss_d: 0.140739
0.1155 --- loss: 0.525601, loss_ss: 0.520449, loss_d: 0.005152
0.1540 --- loss: 1.190975, loss_ss: 1.162701, loss_d: 0.028274
0.1925 --- loss: 0.878572, loss_ss: 0.873888, loss_d: 0.004683
0.2309 --- loss: 0.831425, loss_ss: 0.779595, loss_d: 0.051830
0.2694 --- loss: 1.200115, loss_ss: 1.133239, loss_d: 0.066876
0.3079 --- loss: 0.941452, loss_ss: 0.864760, loss_d: 0.076692
0.3464 --- loss: 1.011340, loss_ss: 0.649058, loss_d: 0.362282
0.3849 --- loss: 0.762179, loss_ss: 0.695118, loss_d: 0.067062
0.4234 --- loss: 0.792173, loss_ss: 0.758978, loss_d: 0.033195
0.4619 --- loss: 1.168949, loss_ss: 1.092122, loss_d: 0.076827
0.5004 --- loss: 0.958275, loss_ss: 0.908633, loss_d: 0.049641
0.5389 --- loss: 0.994063, loss_ss: 0.958367, loss_d: 0.035696
0.5774 --- loss: 0.997863, loss_ss: 0.920422, loss_d: 0.077441
0.6159 --- loss: 0.726203, loss_ss: 0.714489, loss_d: 0.011714
0.6543 --- loss: 0.692713, loss_ss: 0.684270, loss_d: 0.008443
0.6928 --- loss: 0.902937, loss_ss: 0.854533, loss_d: 0.048403
0.7313 --- loss: 1.003010, loss_ss: 0.940179, loss_d: 0.062831
0.7698 --- loss: 1.025915, loss_ss: 1.021030, loss_d: 0.004885
0.8083 --- loss: 0.874892, loss_ss: 0.808367, loss_d: 0.066525
0.8468 --- loss: 0.556433, loss_ss: 0.530337, loss_d: 0.026096
0.8853 --- loss: 0.753613, loss_ss: 0.633650, loss_d: 0.119963
0.9238 --- loss: 0.980899, loss_ss: 0.733500, loss_d: 0.247400
0.9623 --- loss: 0.793878, loss_ss: 0.706828, loss_d: 0.087050
Epoch finished! Loss: 0.9136380097580693
Starting epoch 7/10.
0.0000 --- loss: 0.739645, loss_ss: 0.628924, loss_d: 0.110721
0.0385 --- loss: 0.891404, loss_ss: 0.843205, loss_d: 0.048199
0.0770 --- loss: 0.796819, loss_ss: 0.752752, loss_d: 0.044068
0.1155 --- loss: 0.784354, loss_ss: 0.773460, loss_d: 0.010894
0.1540 --- loss: 0.900344, loss_ss: 0.838321, loss_d: 0.062023
0.1925 --- loss: 1.056520, loss_ss: 0.949966, loss_d: 0.106554
0.2309 --- loss: 0.968635, loss_ss: 0.959960, loss_d: 0.008675
0.2694 --- loss: 0.621165, loss_ss: 0.606623, loss_d: 0.014542
0.3079 --- loss: 0.882481, loss_ss: 0.814297, loss_d: 0.068184
0.3464 --- loss: 0.833710, loss_ss: 0.805869, loss_d: 0.027840
0.3849 --- loss: 0.731297, loss_ss: 0.699276, loss_d: 0.032021
0.4234 --- loss: 0.704336, loss_ss: 0.698442, loss_d: 0.005894
0.4619 --- loss: 1.044153, loss_ss: 1.022008, loss_d: 0.022145
0.5004 --- loss: 0.783745, loss_ss: 0.739532, loss_d: 0.044213
0.5389 --- loss: 0.825978, loss_ss: 0.806881, loss_d: 0.019097
0.5774 --- loss: 1.343699, loss_ss: 0.833928, loss_d: 0.509771
0.6159 --- loss: 0.660022, loss_ss: 0.577991, loss_d: 0.082030
0.6543 --- loss: 1.398849, loss_ss: 0.819872, loss_d: 0.578977
0.6928 --- loss: 1.149115, loss_ss: 0.897051, loss_d: 0.252064
0.7313 --- loss: 0.902394, loss_ss: 0.879420, loss_d: 0.022974
0.7698 --- loss: 0.744221, loss_ss: 0.695516, loss_d: 0.048705
0.8083 --- loss: 0.799182, loss_ss: 0.786372, loss_d: 0.012810
0.8468 --- loss: 0.924298, loss_ss: 0.905600, loss_d: 0.018699
0.8853 --- loss: 0.813549, loss_ss: 0.779658, loss_d: 0.033892
0.9238 --- loss: 1.112956, loss_ss: 0.798832, loss_d: 0.314124
0.9623 --- loss: 1.083241, loss_ss: 0.856901, loss_d: 0.226339
Epoch finished! Loss: 0.891262097708507
Starting epoch 8/10.
0.0000 --- loss: 0.523024, loss_ss: 0.514214, loss_d: 0.008810
0.0385 --- loss: 0.556536, loss_ss: 0.526059, loss_d: 0.030478
0.0770 --- loss: 0.591066, loss_ss: 0.580156, loss_d: 0.010911
0.1155 --- loss: 0.760238, loss_ss: 0.743770, loss_d: 0.016467
0.1540 --- loss: 0.962965, loss_ss: 0.960303, loss_d: 0.002662
0.1925 --- loss: 0.920343, loss_ss: 0.900466, loss_d: 0.019876
0.2309 --- loss: 0.954085, loss_ss: 0.937060, loss_d: 0.017025
0.2694 --- loss: 0.716728, loss_ss: 0.667039, loss_d: 0.049690
0.3079 --- loss: 1.104114, loss_ss: 0.889023, loss_d: 0.215092
0.3464 --- loss: 0.710539, loss_ss: 0.679088, loss_d: 0.031451
0.3849 --- loss: 0.849580, loss_ss: 0.829935, loss_d: 0.019645
0.4234 --- loss: 0.842383, loss_ss: 0.832310, loss_d: 0.010073
0.4619 --- loss: 0.683243, loss_ss: 0.556649, loss_d: 0.126594
0.5004 --- loss: 1.266643, loss_ss: 1.178878, loss_d: 0.087765
0.5389 --- loss: 0.719429, loss_ss: 0.702426, loss_d: 0.017003
0.5774 --- loss: 0.747705, loss_ss: 0.738532, loss_d: 0.009173
0.6159 --- loss: 0.811083, loss_ss: 0.740489, loss_d: 0.070595
0.6543 --- loss: 0.697626, loss_ss: 0.681770, loss_d: 0.015856
0.6928 --- loss: 0.813625, loss_ss: 0.789763, loss_d: 0.023862
0.7313 --- loss: 0.817595, loss_ss: 0.801124, loss_d: 0.016471
0.7698 --- loss: 0.993359, loss_ss: 0.985263, loss_d: 0.008095
0.8083 --- loss: 0.929572, loss_ss: 0.698372, loss_d: 0.231200
0.8468 --- loss: 0.702094, loss_ss: 0.645329, loss_d: 0.056765
0.8853 --- loss: 0.879567, loss_ss: 0.847782, loss_d: 0.031785
0.9238 --- loss: 1.118313, loss_ss: 1.039935, loss_d: 0.078378
0.9623 --- loss: 0.893540, loss_ss: 0.878272, loss_d: 0.015269
Epoch finished! Loss: 0.8523994805039586
Starting epoch 9/10.
0.0000 --- loss: 0.793168, loss_ss: 0.780312, loss_d: 0.012856
0.0385 --- loss: 0.753387, loss_ss: 0.746473, loss_d: 0.006914
0.0770 --- loss: 0.789695, loss_ss: 0.737993, loss_d: 0.051702
0.1155 --- loss: 0.697668, loss_ss: 0.602231, loss_d: 0.095437
0.1540 --- loss: 0.734195, loss_ss: 0.718205, loss_d: 0.015990
0.1925 --- loss: 0.785527, loss_ss: 0.779674, loss_d: 0.005853
0.2309 --- loss: 0.784894, loss_ss: 0.782817, loss_d: 0.002077
0.2694 --- loss: 0.849441, loss_ss: 0.848568, loss_d: 0.000874
0.3079 --- loss: 1.273019, loss_ss: 1.072158, loss_d: 0.200861
0.3464 --- loss: 0.532550, loss_ss: 0.499574, loss_d: 0.032976
0.3849 --- loss: 0.707901, loss_ss: 0.682090, loss_d: 0.025810
0.4234 --- loss: 0.719405, loss_ss: 0.717069, loss_d: 0.002336
0.4619 --- loss: 1.111747, loss_ss: 0.661321, loss_d: 0.450426
0.5004 --- loss: 0.891105, loss_ss: 0.800121, loss_d: 0.090984
0.5389 --- loss: 0.897040, loss_ss: 0.890998, loss_d: 0.006042
0.5774 --- loss: 0.821624, loss_ss: 0.820493, loss_d: 0.001131
0.6159 --- loss: 0.704967, loss_ss: 0.627587, loss_d: 0.077380
0.6543 --- loss: 0.473476, loss_ss: 0.468352, loss_d: 0.005124
0.6928 --- loss: 0.811767, loss_ss: 0.805383, loss_d: 0.006384
0.7313 --- loss: 1.315944, loss_ss: 0.662430, loss_d: 0.653513
0.7698 --- loss: 0.784262, loss_ss: 0.764437, loss_d: 0.019825
0.8083 --- loss: 0.701108, loss_ss: 0.689277, loss_d: 0.011830
0.8468 --- loss: 0.570567, loss_ss: 0.557792, loss_d: 0.012775
0.8853 --- loss: 1.325748, loss_ss: 0.991668, loss_d: 0.334080
0.9238 --- loss: 0.659047, loss_ss: 0.643183, loss_d: 0.015864
0.9623 --- loss: 1.015032, loss_ss: 1.013734, loss_d: 0.001298
Epoch finished! Loss: 0.8053932061066499
Starting epoch 10/10.
0.0000 --- loss: 1.464061, loss_ss: 1.086643, loss_d: 0.377418
0.0385 --- loss: 0.688484, loss_ss: 0.590164, loss_d: 0.098321
0.0770 --- loss: 0.812419, loss_ss: 0.806799, loss_d: 0.005620
0.1155 --- loss: 0.644687, loss_ss: 0.607760, loss_d: 0.036927
0.1540 --- loss: 0.949686, loss_ss: 0.930843, loss_d: 0.018844
0.1925 --- loss: 0.499923, loss_ss: 0.458986, loss_d: 0.040937
0.2309 --- loss: 0.816788, loss_ss: 0.712750, loss_d: 0.104038
0.2694 --- loss: 0.786204, loss_ss: 0.650341, loss_d: 0.135863
0.3079 --- loss: 0.744650, loss_ss: 0.731388, loss_d: 0.013262
0.3464 --- loss: 0.904526, loss_ss: 0.784778, loss_d: 0.119748
0.3849 --- loss: 0.882478, loss_ss: 0.879092, loss_d: 0.003386
0.4234 --- loss: 0.568144, loss_ss: 0.562243, loss_d: 0.005900
0.4619 --- loss: 0.758372, loss_ss: 0.753009, loss_d: 0.005363
0.5004 --- loss: 0.783796, loss_ss: 0.776227, loss_d: 0.007569
0.5389 --- loss: 0.517637, loss_ss: 0.508308, loss_d: 0.009329
0.5774 --- loss: 0.673529, loss_ss: 0.670070, loss_d: 0.003459
0.6159 --- loss: 0.867420, loss_ss: 0.842641, loss_d: 0.024779
0.6543 --- loss: 0.799880, loss_ss: 0.787043, loss_d: 0.012837
0.6928 --- loss: 0.802562, loss_ss: 0.801069, loss_d: 0.001493
0.7313 --- loss: 0.931269, loss_ss: 0.930086, loss_d: 0.001183
0.7698 --- loss: 0.766809, loss_ss: 0.708254, loss_d: 0.058555
0.8083 --- loss: 0.948898, loss_ss: 0.947290, loss_d: 0.001608
0.8468 --- loss: 0.898362, loss_ss: 0.896777, loss_d: 0.001585
0.8853 --- loss: 0.959651, loss_ss: 0.906743, loss_d: 0.052908
0.9238 --- loss: 1.533263, loss_ss: 0.859500, loss_d: 0.673763
0.9623 --- loss: 0.827089, loss_ss: 0.538710, loss_d: 0.288379
Epoch finished! Loss: 0.8063373874053071
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5037531276063386
             precision    recall  f1-score   support

        0.0       0.92      0.47      0.63       350
        1.0       0.32      0.64      0.42       204
        2.0       0.53      0.53      0.53       346
        3.0       1.00      0.15      0.25       179
        4.0       0.42      0.83      0.56       120

avg / total       0.67      0.50      0.50      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  83.49  47.43   98.35   92.22     62.64
1  70.39  63.73   71.76   31.63     42.28
2  72.73  52.60   80.89   52.75     52.68
3  87.24  14.53  100.00  100.00     25.37
4  86.91  83.33   87.30   42.19     56.02
Total accuracy: 50.38%
Average sen: 52.32%
Average spec: 87.66%
Macro f1-score: 47.80%
Diagnosis acc on 15mins: 0.975
[0.99861288 0.99994528 0.99987388 0.99859363 0.99777621 0.9981668
 0.99993241 0.9999671  0.09307528 0.97078896 0.99887735 0.97894818
 0.99928939 0.99980742 0.99999356 0.99996936 0.99951279 0.99996424
 0.99993277 0.9999994  0.99985015 0.99986339 0.99999571 0.99999952
 0.99999881 0.99999809 0.99999547 0.99989223 0.99999499 0.99999928
 0.99999809 0.99750036 0.99970108 0.99978751 0.99994528 0.99917233
 0.99914491 0.99984121 0.99988151 0.99997139]
pred: 0.9756889551877975, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.312118, loss_ss: 1.715940, loss_d: 0.596178
0.0384 --- loss: 2.057847, loss_ss: 1.521994, loss_d: 0.535853
0.0769 --- loss: 2.427279, loss_ss: 1.614400, loss_d: 0.812879
0.1153 --- loss: 2.004524, loss_ss: 1.485728, loss_d: 0.518796
0.1538 --- loss: 2.060829, loss_ss: 1.495269, loss_d: 0.565560
0.1922 --- loss: 1.812337, loss_ss: 1.428069, loss_d: 0.384268
0.2307 --- loss: 1.880173, loss_ss: 1.321622, loss_d: 0.558551
0.2691 --- loss: 1.888199, loss_ss: 1.342017, loss_d: 0.546182
0.3076 --- loss: 2.000359, loss_ss: 1.317519, loss_d: 0.682840
0.3460 --- loss: 1.605217, loss_ss: 1.390571, loss_d: 0.214645
0.3845 --- loss: 2.061467, loss_ss: 1.443819, loss_d: 0.617648
0.4229 --- loss: 1.821670, loss_ss: 1.219777, loss_d: 0.601893
0.4614 --- loss: 1.942729, loss_ss: 1.280594, loss_d: 0.662134
0.4998 --- loss: 2.125224, loss_ss: 1.282364, loss_d: 0.842860
0.5383 --- loss: 1.703003, loss_ss: 1.224780, loss_d: 0.478223
0.5767 --- loss: 1.580475, loss_ss: 1.194373, loss_d: 0.386102
0.6151 --- loss: 1.775729, loss_ss: 1.361424, loss_d: 0.414305
0.6536 --- loss: 1.603085, loss_ss: 1.134969, loss_d: 0.468116
0.6920 --- loss: 1.389370, loss_ss: 1.133965, loss_d: 0.255405
0.7305 --- loss: 1.481626, loss_ss: 1.270842, loss_d: 0.210784
0.7689 --- loss: 1.496266, loss_ss: 1.108092, loss_d: 0.388174
0.8074 --- loss: 1.635666, loss_ss: 1.107279, loss_d: 0.528387
0.8458 --- loss: 1.285525, loss_ss: 1.140114, loss_d: 0.145411
0.8843 --- loss: 1.734679, loss_ss: 1.118520, loss_d: 0.616159
0.9227 --- loss: 1.212911, loss_ss: 0.949980, loss_d: 0.262931
0.9612 --- loss: 1.602559, loss_ss: 1.402565, loss_d: 0.199994
0.9996 --- loss: 1.527627, loss_ss: 1.392241, loss_d: 0.135387
Epoch finished! Loss: 1.824726837873459
Starting epoch 2/10.
0.0000 --- loss: 1.403352, loss_ss: 1.119619, loss_d: 0.283732
0.0384 --- loss: 1.494628, loss_ss: 1.032187, loss_d: 0.462441
0.0769 --- loss: 1.467309, loss_ss: 1.130201, loss_d: 0.337107
0.1153 --- loss: 1.243156, loss_ss: 0.946619, loss_d: 0.296537
0.1538 --- loss: 1.515674, loss_ss: 0.933254, loss_d: 0.582419
0.1922 --- loss: 1.465778, loss_ss: 1.317525, loss_d: 0.148253
0.2307 --- loss: 1.093844, loss_ss: 1.012671, loss_d: 0.081173
0.2691 --- loss: 1.271338, loss_ss: 0.874374, loss_d: 0.396964
0.3076 --- loss: 0.986433, loss_ss: 0.814111, loss_d: 0.172322
0.3460 --- loss: 1.149599, loss_ss: 0.959724, loss_d: 0.189875
0.3845 --- loss: 1.132917, loss_ss: 0.878897, loss_d: 0.254020
0.4229 --- loss: 1.687526, loss_ss: 1.189929, loss_d: 0.497596
0.4614 --- loss: 1.144862, loss_ss: 0.955787, loss_d: 0.189075
0.4998 --- loss: 1.239064, loss_ss: 0.949287, loss_d: 0.289776
0.5383 --- loss: 1.009661, loss_ss: 0.913879, loss_d: 0.095782
0.5767 --- loss: 1.370666, loss_ss: 0.935321, loss_d: 0.435345
0.6151 --- loss: 1.058392, loss_ss: 0.823095, loss_d: 0.235297
0.6536 --- loss: 1.178985, loss_ss: 0.896931, loss_d: 0.282053
0.6920 --- loss: 1.032966, loss_ss: 0.817021, loss_d: 0.215945
0.7305 --- loss: 1.929269, loss_ss: 0.793432, loss_d: 1.135837
0.7689 --- loss: 1.192778, loss_ss: 0.883464, loss_d: 0.309314
0.8074 --- loss: 1.495544, loss_ss: 1.177044, loss_d: 0.318499
0.8458 --- loss: 1.548199, loss_ss: 1.090974, loss_d: 0.457225
0.8843 --- loss: 1.026750, loss_ss: 0.846964, loss_d: 0.179786
0.9227 --- loss: 1.206102, loss_ss: 0.812110, loss_d: 0.393993
0.9612 --- loss: 1.289716, loss_ss: 1.132029, loss_d: 0.157687
0.9996 --- loss: 4.647697, loss_ss: 2.021090, loss_d: 2.626607
Epoch finished! Loss: 1.3327685640408442
Starting epoch 3/10.
0.0000 --- loss: 1.660092, loss_ss: 1.365842, loss_d: 0.294251
0.0384 --- loss: 1.215055, loss_ss: 0.879388, loss_d: 0.335667
0.0769 --- loss: 1.206844, loss_ss: 1.021038, loss_d: 0.185805
0.1153 --- loss: 1.057739, loss_ss: 0.943920, loss_d: 0.113819
0.1538 --- loss: 1.024787, loss_ss: 0.786202, loss_d: 0.238586
0.1922 --- loss: 0.994108, loss_ss: 0.927361, loss_d: 0.066747
0.2307 --- loss: 0.914616, loss_ss: 0.855807, loss_d: 0.058809
0.2691 --- loss: 1.217343, loss_ss: 0.847408, loss_d: 0.369935
0.3076 --- loss: 1.071781, loss_ss: 0.825067, loss_d: 0.246715
0.3460 --- loss: 1.133248, loss_ss: 0.972035, loss_d: 0.161213
0.3845 --- loss: 0.991103, loss_ss: 0.819813, loss_d: 0.171291
0.4229 --- loss: 1.040685, loss_ss: 0.829338, loss_d: 0.211347
0.4614 --- loss: 1.112249, loss_ss: 0.896133, loss_d: 0.216117
0.4998 --- loss: 1.580882, loss_ss: 1.042219, loss_d: 0.538663
0.5383 --- loss: 1.493518, loss_ss: 0.757567, loss_d: 0.735951
0.5767 --- loss: 1.075105, loss_ss: 0.899292, loss_d: 0.175813
0.6151 --- loss: 0.954968, loss_ss: 0.852961, loss_d: 0.102007
0.6536 --- loss: 1.259386, loss_ss: 1.106816, loss_d: 0.152570
0.6920 --- loss: 1.172246, loss_ss: 0.991043, loss_d: 0.181202
0.7305 --- loss: 1.187984, loss_ss: 0.805094, loss_d: 0.382890
0.7689 --- loss: 1.237073, loss_ss: 0.720068, loss_d: 0.517005
0.8074 --- loss: 0.970149, loss_ss: 0.805381, loss_d: 0.164768
0.8458 --- loss: 1.047949, loss_ss: 0.969726, loss_d: 0.078224
0.8843 --- loss: 0.984751, loss_ss: 0.863627, loss_d: 0.121124
0.9227 --- loss: 1.000036, loss_ss: 0.936533, loss_d: 0.063503
0.9612 --- loss: 1.097455, loss_ss: 0.787574, loss_d: 0.309881
0.9996 --- loss: 2.483172, loss_ss: 2.474755, loss_d: 0.008417
Epoch finished! Loss: 1.1530880006460043
Starting epoch 4/10.
0.0000 --- loss: 1.983034, loss_ss: 0.896063, loss_d: 1.086971
0.0384 --- loss: 1.225961, loss_ss: 1.010603, loss_d: 0.215357
0.0769 --- loss: 0.818261, loss_ss: 0.629198, loss_d: 0.189063
0.1153 --- loss: 1.052510, loss_ss: 0.918173, loss_d: 0.134337
0.1538 --- loss: 0.983261, loss_ss: 0.778077, loss_d: 0.205184
0.1922 --- loss: 0.911375, loss_ss: 0.698675, loss_d: 0.212701
0.2307 --- loss: 1.083104, loss_ss: 1.042548, loss_d: 0.040556
0.2691 --- loss: 1.125357, loss_ss: 0.815148, loss_d: 0.310209
0.3076 --- loss: 0.775958, loss_ss: 0.712983, loss_d: 0.062975
0.3460 --- loss: 1.089739, loss_ss: 0.839002, loss_d: 0.250736
0.3845 --- loss: 0.743766, loss_ss: 0.676903, loss_d: 0.066863
0.4229 --- loss: 1.091198, loss_ss: 0.963358, loss_d: 0.127840
0.4614 --- loss: 0.827534, loss_ss: 0.762620, loss_d: 0.064915
0.4998 --- loss: 0.698268, loss_ss: 0.675222, loss_d: 0.023046
0.5383 --- loss: 0.960436, loss_ss: 0.843675, loss_d: 0.116761
0.5767 --- loss: 1.246581, loss_ss: 0.761011, loss_d: 0.485570
0.6151 --- loss: 0.788938, loss_ss: 0.646107, loss_d: 0.142830
0.6536 --- loss: 0.722264, loss_ss: 0.612516, loss_d: 0.109748
0.6920 --- loss: 0.783770, loss_ss: 0.734755, loss_d: 0.049015
0.7305 --- loss: 0.929743, loss_ss: 0.543630, loss_d: 0.386112
0.7689 --- loss: 1.298666, loss_ss: 0.996268, loss_d: 0.302398
0.8074 --- loss: 0.959499, loss_ss: 0.620542, loss_d: 0.338957
0.8458 --- loss: 1.046932, loss_ss: 0.997729, loss_d: 0.049203
0.8843 --- loss: 0.832052, loss_ss: 0.799886, loss_d: 0.032166
0.9227 --- loss: 1.076579, loss_ss: 0.984515, loss_d: 0.092064
0.9612 --- loss: 0.930008, loss_ss: 0.890869, loss_d: 0.039140
0.9996 --- loss: 1.636217, loss_ss: 1.613613, loss_d: 0.022604
Epoch finished! Loss: 1.0652183450185335
Starting epoch 5/10.
0.0000 --- loss: 1.343888, loss_ss: 0.793667, loss_d: 0.550221
0.0384 --- loss: 0.918350, loss_ss: 0.788928, loss_d: 0.129422
0.0769 --- loss: 0.870289, loss_ss: 0.696544, loss_d: 0.173745
0.1153 --- loss: 1.318897, loss_ss: 1.000419, loss_d: 0.318477
0.1538 --- loss: 0.907019, loss_ss: 0.678103, loss_d: 0.228916
0.1922 --- loss: 1.590242, loss_ss: 1.039972, loss_d: 0.550270
0.2307 --- loss: 0.921924, loss_ss: 0.714297, loss_d: 0.207627
0.2691 --- loss: 0.668138, loss_ss: 0.584432, loss_d: 0.083707
0.3076 --- loss: 0.879467, loss_ss: 0.580986, loss_d: 0.298480
0.3460 --- loss: 1.177948, loss_ss: 0.850301, loss_d: 0.327647
0.3845 --- loss: 0.905304, loss_ss: 0.801129, loss_d: 0.104176
0.4229 --- loss: 1.263628, loss_ss: 1.161220, loss_d: 0.102408
0.4614 --- loss: 1.189823, loss_ss: 0.671573, loss_d: 0.518250
0.4998 --- loss: 1.175827, loss_ss: 1.152479, loss_d: 0.023348
0.5383 --- loss: 1.052492, loss_ss: 0.771831, loss_d: 0.280661
0.5767 --- loss: 1.116407, loss_ss: 0.985160, loss_d: 0.131247
0.6151 --- loss: 1.022329, loss_ss: 0.956708, loss_d: 0.065620
0.6536 --- loss: 1.199515, loss_ss: 0.765157, loss_d: 0.434359
0.6920 --- loss: 0.804283, loss_ss: 0.574763, loss_d: 0.229520
0.7305 --- loss: 1.271251, loss_ss: 0.811530, loss_d: 0.459722
0.7689 --- loss: 0.903216, loss_ss: 0.726442, loss_d: 0.176774
0.8074 --- loss: 0.868949, loss_ss: 0.753463, loss_d: 0.115486
0.8458 --- loss: 1.562294, loss_ss: 0.946140, loss_d: 0.616154
0.8843 --- loss: 1.387459, loss_ss: 0.803577, loss_d: 0.583882
0.9227 --- loss: 0.954495, loss_ss: 0.651055, loss_d: 0.303441
0.9612 --- loss: 0.780778, loss_ss: 0.725140, loss_d: 0.055638
0.9996 --- loss: 1.477785, loss_ss: 1.474916, loss_d: 0.002869
Epoch finished! Loss: 0.9867805370917687
Starting epoch 6/10.
0.0000 --- loss: 0.752220, loss_ss: 0.693146, loss_d: 0.059075
0.0384 --- loss: 0.702115, loss_ss: 0.599448, loss_d: 0.102666
0.0769 --- loss: 0.743078, loss_ss: 0.722404, loss_d: 0.020674
0.1153 --- loss: 0.973229, loss_ss: 0.956732, loss_d: 0.016497
0.1538 --- loss: 0.873657, loss_ss: 0.858664, loss_d: 0.014993
0.1922 --- loss: 1.023096, loss_ss: 0.836950, loss_d: 0.186147
0.2307 --- loss: 0.616540, loss_ss: 0.579292, loss_d: 0.037248
0.2691 --- loss: 1.240638, loss_ss: 1.207601, loss_d: 0.033037
0.3076 --- loss: 0.866715, loss_ss: 0.503269, loss_d: 0.363446
0.3460 --- loss: 0.994133, loss_ss: 0.892510, loss_d: 0.101623
0.3845 --- loss: 0.955307, loss_ss: 0.688610, loss_d: 0.266697
0.4229 --- loss: 0.759097, loss_ss: 0.747724, loss_d: 0.011373
0.4614 --- loss: 0.888857, loss_ss: 0.694908, loss_d: 0.193949
0.4998 --- loss: 1.354523, loss_ss: 1.095468, loss_d: 0.259055
0.5383 --- loss: 1.225730, loss_ss: 0.815408, loss_d: 0.410322
0.5767 --- loss: 1.037698, loss_ss: 0.879472, loss_d: 0.158226
0.6151 --- loss: 1.072631, loss_ss: 0.628681, loss_d: 0.443951
0.6536 --- loss: 0.820973, loss_ss: 0.798096, loss_d: 0.022877
0.6920 --- loss: 1.344659, loss_ss: 1.203801, loss_d: 0.140858
0.7305 --- loss: 0.916640, loss_ss: 0.801867, loss_d: 0.114773
0.7689 --- loss: 0.756767, loss_ss: 0.698262, loss_d: 0.058505
0.8074 --- loss: 0.960627, loss_ss: 0.822318, loss_d: 0.138309
0.8458 --- loss: 0.975803, loss_ss: 0.813059, loss_d: 0.162744
0.8843 --- loss: 0.776191, loss_ss: 0.681919, loss_d: 0.094273
0.9227 --- loss: 0.838556, loss_ss: 0.821723, loss_d: 0.016832
0.9612 --- loss: 1.293951, loss_ss: 1.102889, loss_d: 0.191061
0.9996 --- loss: 1.392431, loss_ss: 1.388965, loss_d: 0.003467
Epoch finished! Loss: 0.9548966061610442
Starting epoch 7/10.
0.0000 --- loss: 1.277424, loss_ss: 0.773957, loss_d: 0.503467
0.0384 --- loss: 0.887959, loss_ss: 0.628958, loss_d: 0.259001
0.0769 --- loss: 0.842884, loss_ss: 0.707492, loss_d: 0.135391
0.1153 --- loss: 0.682415, loss_ss: 0.591965, loss_d: 0.090450
0.1538 --- loss: 0.880205, loss_ss: 0.806660, loss_d: 0.073545
0.1922 --- loss: 1.037224, loss_ss: 0.695341, loss_d: 0.341883
0.2307 --- loss: 1.138672, loss_ss: 0.808720, loss_d: 0.329952
0.2691 --- loss: 0.712000, loss_ss: 0.644884, loss_d: 0.067116
0.3076 --- loss: 1.064600, loss_ss: 0.865273, loss_d: 0.199326
0.3460 --- loss: 0.972801, loss_ss: 0.805787, loss_d: 0.167014
0.3845 --- loss: 0.865710, loss_ss: 0.573503, loss_d: 0.292207
0.4229 --- loss: 2.213333, loss_ss: 1.234737, loss_d: 0.978596
0.4614 --- loss: 1.254715, loss_ss: 0.656218, loss_d: 0.598498
0.4998 --- loss: 0.902992, loss_ss: 0.745478, loss_d: 0.157514
0.5383 --- loss: 0.732256, loss_ss: 0.634250, loss_d: 0.098006
0.5767 --- loss: 0.809242, loss_ss: 0.652809, loss_d: 0.156433
0.6151 --- loss: 0.667579, loss_ss: 0.616797, loss_d: 0.050783
0.6536 --- loss: 0.900793, loss_ss: 0.861141, loss_d: 0.039652
0.6920 --- loss: 0.923317, loss_ss: 0.721433, loss_d: 0.201883
0.7305 --- loss: 0.907132, loss_ss: 0.500777, loss_d: 0.406355
0.7689 --- loss: 0.518669, loss_ss: 0.482026, loss_d: 0.036642
0.8074 --- loss: 1.154369, loss_ss: 1.058131, loss_d: 0.096238
0.8458 --- loss: 0.782577, loss_ss: 0.771049, loss_d: 0.011528
0.8843 --- loss: 0.927995, loss_ss: 0.535664, loss_d: 0.392331
0.9227 --- loss: 0.729507, loss_ss: 0.568982, loss_d: 0.160525
0.9612 --- loss: 0.775502, loss_ss: 0.620797, loss_d: 0.154705
0.9996 --- loss: 3.290162, loss_ss: 3.286380, loss_d: 0.003782
Epoch finished! Loss: 0.9239819657344085
Starting epoch 8/10.
0.0000 --- loss: 0.856967, loss_ss: 0.805268, loss_d: 0.051699
0.0384 --- loss: 0.703963, loss_ss: 0.584704, loss_d: 0.119259
0.0769 --- loss: 0.622661, loss_ss: 0.580862, loss_d: 0.041799
0.1153 --- loss: 0.742482, loss_ss: 0.655656, loss_d: 0.086825
0.1538 --- loss: 0.776740, loss_ss: 0.763729, loss_d: 0.013012
0.1922 --- loss: 0.613863, loss_ss: 0.601174, loss_d: 0.012689
0.2307 --- loss: 0.968600, loss_ss: 0.960590, loss_d: 0.008010
0.2691 --- loss: 1.048623, loss_ss: 0.787490, loss_d: 0.261133
0.3076 --- loss: 0.660479, loss_ss: 0.645270, loss_d: 0.015209
0.3460 --- loss: 0.906738, loss_ss: 0.798854, loss_d: 0.107884
0.3845 --- loss: 0.933783, loss_ss: 0.610475, loss_d: 0.323308
0.4229 --- loss: 0.675274, loss_ss: 0.570355, loss_d: 0.104919
0.4614 --- loss: 0.888100, loss_ss: 0.858253, loss_d: 0.029847
0.4998 --- loss: 0.685019, loss_ss: 0.603495, loss_d: 0.081524
0.5383 --- loss: 0.802227, loss_ss: 0.752592, loss_d: 0.049635
0.5767 --- loss: 1.035362, loss_ss: 1.014067, loss_d: 0.021294
0.6151 --- loss: 0.640325, loss_ss: 0.560170, loss_d: 0.080155
0.6536 --- loss: 1.264367, loss_ss: 0.624353, loss_d: 0.640014
0.6920 --- loss: 0.684222, loss_ss: 0.631848, loss_d: 0.052375
0.7305 --- loss: 0.692225, loss_ss: 0.609166, loss_d: 0.083059
0.7689 --- loss: 1.272814, loss_ss: 0.555174, loss_d: 0.717639
0.8074 --- loss: 1.173144, loss_ss: 1.155220, loss_d: 0.017925
0.8458 --- loss: 0.760616, loss_ss: 0.715456, loss_d: 0.045159
0.8843 --- loss: 1.074000, loss_ss: 0.801596, loss_d: 0.272404
0.9227 --- loss: 0.820258, loss_ss: 0.773364, loss_d: 0.046894
0.9612 --- loss: 1.063030, loss_ss: 0.910773, loss_d: 0.152258
0.9996 --- loss: 1.045008, loss_ss: 1.044688, loss_d: 0.000321
Epoch finished! Loss: 0.8565255664862119
Starting epoch 9/10.
0.0000 --- loss: 1.583281, loss_ss: 0.632220, loss_d: 0.951061
0.0384 --- loss: 0.704127, loss_ss: 0.671945, loss_d: 0.032182
0.0769 --- loss: 0.694887, loss_ss: 0.649117, loss_d: 0.045770
0.1153 --- loss: 0.816927, loss_ss: 0.774894, loss_d: 0.042033
0.1538 --- loss: 0.644205, loss_ss: 0.582701, loss_d: 0.061504
0.1922 --- loss: 0.813909, loss_ss: 0.709195, loss_d: 0.104714
0.2307 --- loss: 0.750661, loss_ss: 0.693918, loss_d: 0.056743
0.2691 --- loss: 0.611542, loss_ss: 0.596385, loss_d: 0.015157
0.3076 --- loss: 0.532206, loss_ss: 0.452761, loss_d: 0.079446
0.3460 --- loss: 1.292681, loss_ss: 0.894503, loss_d: 0.398178
0.3845 --- loss: 0.997261, loss_ss: 0.879063, loss_d: 0.118198
0.4229 --- loss: 0.689948, loss_ss: 0.667334, loss_d: 0.022614
0.4614 --- loss: 0.679290, loss_ss: 0.637338, loss_d: 0.041953
0.4998 --- loss: 1.086333, loss_ss: 0.556502, loss_d: 0.529830
0.5383 --- loss: 1.709148, loss_ss: 0.830444, loss_d: 0.878704
0.5767 --- loss: 0.820501, loss_ss: 0.739898, loss_d: 0.080603
0.6151 --- loss: 0.803954, loss_ss: 0.669937, loss_d: 0.134017
0.6536 --- loss: 0.767433, loss_ss: 0.728427, loss_d: 0.039005
0.6920 --- loss: 0.796995, loss_ss: 0.653145, loss_d: 0.143851
0.7305 --- loss: 0.899641, loss_ss: 0.769879, loss_d: 0.129762
0.7689 --- loss: 0.680247, loss_ss: 0.644631, loss_d: 0.035616
0.8074 --- loss: 0.977442, loss_ss: 0.933100, loss_d: 0.044343
0.8458 --- loss: 1.006699, loss_ss: 0.892098, loss_d: 0.114601
0.8843 --- loss: 0.655632, loss_ss: 0.483574, loss_d: 0.172058
0.9227 --- loss: 1.094819, loss_ss: 0.789596, loss_d: 0.305224
0.9612 --- loss: 0.687946, loss_ss: 0.644879, loss_d: 0.043067
0.9996 --- loss: 10.852039, loss_ss: 3.490321, loss_d: 7.361718
Epoch finished! Loss: 0.9143188806680532
Starting epoch 10/10.
0.0000 --- loss: 1.620013, loss_ss: 1.381737, loss_d: 0.238276
0.0384 --- loss: 0.646828, loss_ss: 0.532983, loss_d: 0.113845
0.0769 --- loss: 0.793705, loss_ss: 0.728389, loss_d: 0.065315
0.1153 --- loss: 0.950083, loss_ss: 0.925935, loss_d: 0.024148
0.1538 --- loss: 0.741040, loss_ss: 0.686022, loss_d: 0.055018
0.1922 --- loss: 0.737372, loss_ss: 0.471808, loss_d: 0.265564
0.2307 --- loss: 1.489945, loss_ss: 1.469036, loss_d: 0.020908
0.2691 --- loss: 1.169973, loss_ss: 0.834858, loss_d: 0.335115
0.3076 --- loss: 0.904726, loss_ss: 0.675015, loss_d: 0.229711
0.3460 --- loss: 0.593714, loss_ss: 0.465890, loss_d: 0.127823
0.3845 --- loss: 0.746656, loss_ss: 0.697409, loss_d: 0.049247
0.4229 --- loss: 0.746306, loss_ss: 0.737955, loss_d: 0.008352
0.4614 --- loss: 0.883725, loss_ss: 0.841021, loss_d: 0.042704
0.4998 --- loss: 0.787263, loss_ss: 0.765054, loss_d: 0.022208
0.5383 --- loss: 0.801048, loss_ss: 0.771220, loss_d: 0.029828
0.5767 --- loss: 0.920501, loss_ss: 0.618456, loss_d: 0.302046
0.6151 --- loss: 1.198200, loss_ss: 0.640299, loss_d: 0.557901
0.6536 --- loss: 0.789086, loss_ss: 0.718623, loss_d: 0.070462
0.6920 --- loss: 1.544410, loss_ss: 1.132531, loss_d: 0.411880
0.7305 --- loss: 0.847403, loss_ss: 0.831446, loss_d: 0.015956
0.7689 --- loss: 0.624108, loss_ss: 0.590690, loss_d: 0.033418
0.8074 --- loss: 0.573753, loss_ss: 0.559048, loss_d: 0.014705
0.8458 --- loss: 0.873976, loss_ss: 0.863164, loss_d: 0.010812
0.8843 --- loss: 0.834236, loss_ss: 0.788603, loss_d: 0.045633
0.9227 --- loss: 0.704369, loss_ss: 0.616389, loss_d: 0.087980
0.9612 --- loss: 0.620711, loss_ss: 0.600820, loss_d: 0.019891
0.9996 --- loss: 1.164740, loss_ss: 1.161612, loss_d: 0.003128
Epoch finished! Loss: 0.840514699770854
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6873873873873874
             precision    recall  f1-score   support

        0.0       0.22      0.82      0.35        51
        1.0       0.19      0.21      0.20        48
        2.0       0.66      0.88      0.76       309
        3.0       0.98      0.74      0.84       229
        4.0       0.95      0.57      0.71       473

avg / total       0.81      0.69      0.71      1110
 


====== chp031-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.86  82.35   86.02  22.11     34.85
1  92.79  20.83   96.05  19.23     20.00
2  84.14  88.35   82.52  66.10     75.62
3  94.32  73.80   99.66  98.26     84.29
4  80.36  56.87   97.80  95.05     71.16
Total accuracy: 68.74%
Average sen: 64.44%
Average spec: 92.41%
Macro f1-score: 57.19%
Diagnosis acc on 15mins: 1.0
[0.99999845 0.99996901 0.99999058 0.99999416 0.99988973 0.99986124
 0.99993396 0.99994922 0.99958724 0.9998697  0.99995768 0.99992645
 0.99999428 0.9999913  0.99988306 0.99968755 0.99978393 0.99995124
 0.99997091 0.99998271 0.99981135 0.99992871 0.99995136 0.99880326
 0.99994254 0.99998236 0.99999285 0.99989212 0.99995148 0.99996042
 0.99838543 0.99997616 0.99997962 0.99987543 0.99990022 0.99989569
 0.99997807]
pred: 0.999848093535449, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.304987, loss_ss: 1.627001, loss_d: 0.677986
0.0384 --- loss: 2.119968, loss_ss: 1.557739, loss_d: 0.562229
0.0768 --- loss: 2.501796, loss_ss: 1.459560, loss_d: 1.042237
0.1153 --- loss: 2.124197, loss_ss: 1.498482, loss_d: 0.625714
0.1537 --- loss: 2.080720, loss_ss: 1.515550, loss_d: 0.565169
0.1921 --- loss: 2.140168, loss_ss: 1.378562, loss_d: 0.761606
0.2305 --- loss: 2.003861, loss_ss: 1.517595, loss_d: 0.486266
0.2689 --- loss: 1.810956, loss_ss: 1.274811, loss_d: 0.536145
0.3073 --- loss: 2.140615, loss_ss: 1.465445, loss_d: 0.675170
0.3458 --- loss: 2.031067, loss_ss: 1.323936, loss_d: 0.707131
0.3842 --- loss: 1.726899, loss_ss: 1.393221, loss_d: 0.333678
0.4226 --- loss: 1.912086, loss_ss: 1.318526, loss_d: 0.593560
0.4610 --- loss: 1.796035, loss_ss: 1.223823, loss_d: 0.572212
0.4994 --- loss: 1.739604, loss_ss: 1.279504, loss_d: 0.460100
0.5378 --- loss: 2.021852, loss_ss: 1.212724, loss_d: 0.809127
0.5763 --- loss: 1.716789, loss_ss: 1.210731, loss_d: 0.506058
0.6147 --- loss: 1.801172, loss_ss: 1.436015, loss_d: 0.365157
0.6531 --- loss: 1.846228, loss_ss: 1.332042, loss_d: 0.514186
0.6915 --- loss: 1.601892, loss_ss: 1.297477, loss_d: 0.304415
0.7299 --- loss: 1.849408, loss_ss: 1.197122, loss_d: 0.652286
0.7683 --- loss: 1.748329, loss_ss: 1.259646, loss_d: 0.488682
0.8068 --- loss: 1.851767, loss_ss: 1.185518, loss_d: 0.666249
0.8452 --- loss: 1.799234, loss_ss: 1.343967, loss_d: 0.455267
0.8836 --- loss: 1.846634, loss_ss: 1.057949, loss_d: 0.788685
0.9220 --- loss: 1.949943, loss_ss: 1.302479, loss_d: 0.647463
0.9604 --- loss: 1.665543, loss_ss: 1.197893, loss_d: 0.467650
0.9988 --- loss: 1.598223, loss_ss: 1.219299, loss_d: 0.378924
Epoch finished! Loss: 1.8639537870883942
Starting epoch 2/10.
0.0000 --- loss: 1.704367, loss_ss: 1.225624, loss_d: 0.478743
0.0384 --- loss: 1.565785, loss_ss: 1.066814, loss_d: 0.498970
0.0768 --- loss: 1.541719, loss_ss: 1.359015, loss_d: 0.182703
0.1153 --- loss: 1.160758, loss_ss: 1.011610, loss_d: 0.149149
0.1537 --- loss: 1.119020, loss_ss: 0.963913, loss_d: 0.155108
0.1921 --- loss: 1.290714, loss_ss: 1.103244, loss_d: 0.187470
0.2305 --- loss: 1.462512, loss_ss: 1.051947, loss_d: 0.410565
0.2689 --- loss: 1.359458, loss_ss: 1.151884, loss_d: 0.207574
0.3073 --- loss: 1.356345, loss_ss: 0.958213, loss_d: 0.398132
0.3458 --- loss: 1.532946, loss_ss: 1.432735, loss_d: 0.100211
0.3842 --- loss: 1.480781, loss_ss: 1.240072, loss_d: 0.240709
0.4226 --- loss: 1.255374, loss_ss: 1.036082, loss_d: 0.219292
0.4610 --- loss: 1.257396, loss_ss: 1.118885, loss_d: 0.138511
0.4994 --- loss: 1.706156, loss_ss: 1.301070, loss_d: 0.405086
0.5378 --- loss: 0.893467, loss_ss: 0.804242, loss_d: 0.089224
0.5763 --- loss: 1.298727, loss_ss: 0.779243, loss_d: 0.519484
0.6147 --- loss: 1.756962, loss_ss: 1.164028, loss_d: 0.592933
0.6531 --- loss: 1.271744, loss_ss: 0.886533, loss_d: 0.385211
0.6915 --- loss: 1.255060, loss_ss: 1.088492, loss_d: 0.166569
0.7299 --- loss: 1.211528, loss_ss: 1.028656, loss_d: 0.182872
0.7683 --- loss: 0.809655, loss_ss: 0.714274, loss_d: 0.095381
0.8068 --- loss: 1.387323, loss_ss: 1.047163, loss_d: 0.340159
0.8452 --- loss: 1.121462, loss_ss: 0.858158, loss_d: 0.263304
0.8836 --- loss: 1.315928, loss_ss: 1.107163, loss_d: 0.208764
0.9220 --- loss: 1.247889, loss_ss: 0.827631, loss_d: 0.420257
0.9604 --- loss: 1.130445, loss_ss: 0.936908, loss_d: 0.193537
0.9988 --- loss: 1.574286, loss_ss: 1.269724, loss_d: 0.304562
Epoch finished! Loss: 1.367778922044314
Starting epoch 3/10.
0.0000 --- loss: 1.257421, loss_ss: 0.991373, loss_d: 0.266048
0.0384 --- loss: 1.134264, loss_ss: 0.871782, loss_d: 0.262482
0.0768 --- loss: 1.231540, loss_ss: 0.937139, loss_d: 0.294401
0.1153 --- loss: 1.199707, loss_ss: 0.834622, loss_d: 0.365085
0.1537 --- loss: 0.968953, loss_ss: 0.872399, loss_d: 0.096554
0.1921 --- loss: 1.156031, loss_ss: 0.834998, loss_d: 0.321033
0.2305 --- loss: 1.088657, loss_ss: 0.890897, loss_d: 0.197759
0.2689 --- loss: 1.285204, loss_ss: 1.014091, loss_d: 0.271113
0.3073 --- loss: 1.196931, loss_ss: 1.070410, loss_d: 0.126521
0.3458 --- loss: 1.155143, loss_ss: 0.954744, loss_d: 0.200399
0.3842 --- loss: 0.942970, loss_ss: 0.858597, loss_d: 0.084372
0.4226 --- loss: 1.050153, loss_ss: 0.978974, loss_d: 0.071180
0.4610 --- loss: 1.159760, loss_ss: 1.059980, loss_d: 0.099780
0.4994 --- loss: 0.829733, loss_ss: 0.615905, loss_d: 0.213829
0.5378 --- loss: 1.461643, loss_ss: 1.080158, loss_d: 0.381485
0.5763 --- loss: 1.284440, loss_ss: 1.187855, loss_d: 0.096584
0.6147 --- loss: 1.027421, loss_ss: 0.708373, loss_d: 0.319048
0.6531 --- loss: 0.923072, loss_ss: 0.806339, loss_d: 0.116733
0.6915 --- loss: 1.413719, loss_ss: 0.953063, loss_d: 0.460656
0.7299 --- loss: 0.765097, loss_ss: 0.706211, loss_d: 0.058886
0.7683 --- loss: 0.868723, loss_ss: 0.712133, loss_d: 0.156589
0.8068 --- loss: 0.979437, loss_ss: 0.792884, loss_d: 0.186553
0.8452 --- loss: 1.409437, loss_ss: 0.873870, loss_d: 0.535567
0.8836 --- loss: 1.217571, loss_ss: 1.026426, loss_d: 0.191145
0.9220 --- loss: 1.504559, loss_ss: 0.915268, loss_d: 0.589291
0.9604 --- loss: 0.926543, loss_ss: 0.835090, loss_d: 0.091453
0.9988 --- loss: 1.111309, loss_ss: 0.697542, loss_d: 0.413767
Epoch finished! Loss: 1.1677614881442144
Starting epoch 4/10.
0.0000 --- loss: 1.053355, loss_ss: 1.007911, loss_d: 0.045443
0.0384 --- loss: 0.830967, loss_ss: 0.660468, loss_d: 0.170499
0.0768 --- loss: 1.252007, loss_ss: 0.604593, loss_d: 0.647414
0.1153 --- loss: 1.103583, loss_ss: 1.050029, loss_d: 0.053554
0.1537 --- loss: 1.182247, loss_ss: 1.066558, loss_d: 0.115689
0.1921 --- loss: 1.172473, loss_ss: 0.611076, loss_d: 0.561397
0.2305 --- loss: 0.952255, loss_ss: 0.910852, loss_d: 0.041403
0.2689 --- loss: 0.873716, loss_ss: 0.759701, loss_d: 0.114015
0.3073 --- loss: 0.957637, loss_ss: 0.786057, loss_d: 0.171580
0.3458 --- loss: 0.959975, loss_ss: 0.884564, loss_d: 0.075411
0.3842 --- loss: 1.181295, loss_ss: 0.904517, loss_d: 0.276779
0.4226 --- loss: 1.036354, loss_ss: 0.940980, loss_d: 0.095375
0.4610 --- loss: 1.274170, loss_ss: 0.962147, loss_d: 0.312023
0.4994 --- loss: 1.131718, loss_ss: 0.857457, loss_d: 0.274261
0.5378 --- loss: 0.847828, loss_ss: 0.629610, loss_d: 0.218218
0.5763 --- loss: 0.971092, loss_ss: 0.858299, loss_d: 0.112793
0.6147 --- loss: 0.974033, loss_ss: 0.945466, loss_d: 0.028568
0.6531 --- loss: 0.941465, loss_ss: 0.873819, loss_d: 0.067646
0.6915 --- loss: 0.833745, loss_ss: 0.783903, loss_d: 0.049842
0.7299 --- loss: 1.212299, loss_ss: 0.733652, loss_d: 0.478647
0.7683 --- loss: 1.152797, loss_ss: 0.838456, loss_d: 0.314341
0.8068 --- loss: 0.868443, loss_ss: 0.782190, loss_d: 0.086254
0.8452 --- loss: 1.323366, loss_ss: 1.190241, loss_d: 0.133125
0.8836 --- loss: 0.766364, loss_ss: 0.684183, loss_d: 0.082180
0.9220 --- loss: 0.738024, loss_ss: 0.682826, loss_d: 0.055198
0.9604 --- loss: 1.255149, loss_ss: 0.884776, loss_d: 0.370373
0.9988 --- loss: 1.450002, loss_ss: 1.275013, loss_d: 0.174988
Epoch finished! Loss: 1.0476899474859238
Starting epoch 5/10.
0.0000 --- loss: 1.151592, loss_ss: 1.026305, loss_d: 0.125287
0.0384 --- loss: 1.167518, loss_ss: 0.962320, loss_d: 0.205198
0.0768 --- loss: 0.655461, loss_ss: 0.553129, loss_d: 0.102332
0.1153 --- loss: 0.974314, loss_ss: 0.765551, loss_d: 0.208763
0.1537 --- loss: 0.868814, loss_ss: 0.786183, loss_d: 0.082631
0.1921 --- loss: 1.060868, loss_ss: 0.683535, loss_d: 0.377334
0.2305 --- loss: 1.041702, loss_ss: 0.846430, loss_d: 0.195272
0.2689 --- loss: 0.767905, loss_ss: 0.713961, loss_d: 0.053944
0.3073 --- loss: 1.038048, loss_ss: 0.693017, loss_d: 0.345031
0.3458 --- loss: 0.658873, loss_ss: 0.630375, loss_d: 0.028498
0.3842 --- loss: 1.199742, loss_ss: 0.788433, loss_d: 0.411309
0.4226 --- loss: 0.813962, loss_ss: 0.723837, loss_d: 0.090124
0.4610 --- loss: 0.869797, loss_ss: 0.655482, loss_d: 0.214315
0.4994 --- loss: 0.812365, loss_ss: 0.688138, loss_d: 0.124227
0.5378 --- loss: 0.984452, loss_ss: 0.932988, loss_d: 0.051464
0.5763 --- loss: 0.773001, loss_ss: 0.679599, loss_d: 0.093402
0.6147 --- loss: 0.857074, loss_ss: 0.802293, loss_d: 0.054781
0.6531 --- loss: 1.033112, loss_ss: 1.022172, loss_d: 0.010940
0.6915 --- loss: 0.789651, loss_ss: 0.718201, loss_d: 0.071449
0.7299 --- loss: 0.905771, loss_ss: 0.852824, loss_d: 0.052947
0.7683 --- loss: 0.609029, loss_ss: 0.561047, loss_d: 0.047983
0.8068 --- loss: 0.913953, loss_ss: 0.729366, loss_d: 0.184588
0.8452 --- loss: 0.788515, loss_ss: 0.661992, loss_d: 0.126523
0.8836 --- loss: 0.812137, loss_ss: 0.737590, loss_d: 0.074547
0.9220 --- loss: 0.679441, loss_ss: 0.521356, loss_d: 0.158084
0.9604 --- loss: 1.241145, loss_ss: 1.079269, loss_d: 0.161876
0.9988 --- loss: 1.001014, loss_ss: 0.997691, loss_d: 0.003323
Epoch finished! Loss: 0.9720991677962817
Starting epoch 6/10.
0.0000 --- loss: 0.840979, loss_ss: 0.786576, loss_d: 0.054403
0.0384 --- loss: 0.857742, loss_ss: 0.811873, loss_d: 0.045869
0.0768 --- loss: 0.839239, loss_ss: 0.655702, loss_d: 0.183538
0.1153 --- loss: 1.206703, loss_ss: 1.085255, loss_d: 0.121448
0.1537 --- loss: 1.077708, loss_ss: 0.918106, loss_d: 0.159602
0.1921 --- loss: 1.225398, loss_ss: 1.135682, loss_d: 0.089716
0.2305 --- loss: 1.045750, loss_ss: 0.903846, loss_d: 0.141904
0.2689 --- loss: 0.787774, loss_ss: 0.768051, loss_d: 0.019724
0.3073 --- loss: 0.791302, loss_ss: 0.771249, loss_d: 0.020052
0.3458 --- loss: 0.630576, loss_ss: 0.598560, loss_d: 0.032016
0.3842 --- loss: 0.972616, loss_ss: 0.734817, loss_d: 0.237799
0.4226 --- loss: 0.948693, loss_ss: 0.748520, loss_d: 0.200172
0.4610 --- loss: 0.761011, loss_ss: 0.732361, loss_d: 0.028649
0.4994 --- loss: 1.083750, loss_ss: 1.054731, loss_d: 0.029018
0.5378 --- loss: 0.754345, loss_ss: 0.715978, loss_d: 0.038367
0.5763 --- loss: 0.771947, loss_ss: 0.738252, loss_d: 0.033695
0.6147 --- loss: 1.178679, loss_ss: 1.080365, loss_d: 0.098314
0.6531 --- loss: 0.847888, loss_ss: 0.787201, loss_d: 0.060687
0.6915 --- loss: 0.620991, loss_ss: 0.584497, loss_d: 0.036494
0.7299 --- loss: 0.940459, loss_ss: 0.822921, loss_d: 0.117539
0.7683 --- loss: 0.805982, loss_ss: 0.693796, loss_d: 0.112186
0.8068 --- loss: 0.836931, loss_ss: 0.771886, loss_d: 0.065045
0.8452 --- loss: 1.614837, loss_ss: 1.067042, loss_d: 0.547794
0.8836 --- loss: 0.910782, loss_ss: 0.717609, loss_d: 0.193173
0.9220 --- loss: 0.638361, loss_ss: 0.610664, loss_d: 0.027697
0.9604 --- loss: 1.212864, loss_ss: 0.869066, loss_d: 0.343798
0.9988 --- loss: 0.917262, loss_ss: 0.908701, loss_d: 0.008562
Epoch finished! Loss: 0.9327955766366078
Starting epoch 7/10.
0.0000 --- loss: 0.662590, loss_ss: 0.654298, loss_d: 0.008291
0.0384 --- loss: 0.881312, loss_ss: 0.864479, loss_d: 0.016833
0.0768 --- loss: 0.505322, loss_ss: 0.483710, loss_d: 0.021613
0.1153 --- loss: 1.611571, loss_ss: 1.595217, loss_d: 0.016355
0.1537 --- loss: 0.932530, loss_ss: 0.898598, loss_d: 0.033931
0.1921 --- loss: 0.807212, loss_ss: 0.799563, loss_d: 0.007650
0.2305 --- loss: 1.008125, loss_ss: 0.973636, loss_d: 0.034488
0.2689 --- loss: 0.902200, loss_ss: 0.841467, loss_d: 0.060733
0.3073 --- loss: 1.101802, loss_ss: 0.872548, loss_d: 0.229254
0.3458 --- loss: 0.864926, loss_ss: 0.592501, loss_d: 0.272425
0.3842 --- loss: 0.643005, loss_ss: 0.562261, loss_d: 0.080744
0.4226 --- loss: 0.837191, loss_ss: 0.815448, loss_d: 0.021743
0.4610 --- loss: 1.069741, loss_ss: 0.863392, loss_d: 0.206349
0.4994 --- loss: 0.787207, loss_ss: 0.710091, loss_d: 0.077116
0.5378 --- loss: 0.903711, loss_ss: 0.825016, loss_d: 0.078695
0.5763 --- loss: 1.075410, loss_ss: 0.699693, loss_d: 0.375717
0.6147 --- loss: 0.693927, loss_ss: 0.662399, loss_d: 0.031528
0.6531 --- loss: 1.299636, loss_ss: 0.914919, loss_d: 0.384717
0.6915 --- loss: 0.680156, loss_ss: 0.661006, loss_d: 0.019149
0.7299 --- loss: 0.764936, loss_ss: 0.728519, loss_d: 0.036417
0.7683 --- loss: 0.874810, loss_ss: 0.820187, loss_d: 0.054623
0.8068 --- loss: 0.663857, loss_ss: 0.636125, loss_d: 0.027732
0.8452 --- loss: 0.556664, loss_ss: 0.539192, loss_d: 0.017472
0.8836 --- loss: 0.994905, loss_ss: 0.849203, loss_d: 0.145702
0.9220 --- loss: 1.015753, loss_ss: 0.990241, loss_d: 0.025512
0.9604 --- loss: 0.955815, loss_ss: 0.863324, loss_d: 0.092491
0.9988 --- loss: 2.426272, loss_ss: 1.659453, loss_d: 0.766819
Epoch finished! Loss: 0.8967960522725031
Starting epoch 8/10.
0.0000 --- loss: 0.754970, loss_ss: 0.682377, loss_d: 0.072593
0.0384 --- loss: 0.653030, loss_ss: 0.628981, loss_d: 0.024049
0.0768 --- loss: 0.887718, loss_ss: 0.747805, loss_d: 0.139913
0.1153 --- loss: 1.138067, loss_ss: 1.075586, loss_d: 0.062481
0.1537 --- loss: 0.789642, loss_ss: 0.670144, loss_d: 0.119498
0.1921 --- loss: 0.810328, loss_ss: 0.792358, loss_d: 0.017970
0.2305 --- loss: 0.822595, loss_ss: 0.820461, loss_d: 0.002134
0.2689 --- loss: 0.713190, loss_ss: 0.708938, loss_d: 0.004252
0.3073 --- loss: 0.769468, loss_ss: 0.763436, loss_d: 0.006033
0.3458 --- loss: 0.649335, loss_ss: 0.624695, loss_d: 0.024640
0.3842 --- loss: 0.723648, loss_ss: 0.692873, loss_d: 0.030775
0.4226 --- loss: 1.097080, loss_ss: 0.848721, loss_d: 0.248359
0.4610 --- loss: 0.712049, loss_ss: 0.670562, loss_d: 0.041487
0.4994 --- loss: 0.820054, loss_ss: 0.798642, loss_d: 0.021412
0.5378 --- loss: 0.930558, loss_ss: 0.919283, loss_d: 0.011275
0.5763 --- loss: 0.759035, loss_ss: 0.740591, loss_d: 0.018444
0.6147 --- loss: 0.713658, loss_ss: 0.697628, loss_d: 0.016030
0.6531 --- loss: 0.733582, loss_ss: 0.711930, loss_d: 0.021653
0.6915 --- loss: 2.185126, loss_ss: 0.969856, loss_d: 1.215270
0.7299 --- loss: 0.885604, loss_ss: 0.786418, loss_d: 0.099186
0.7683 --- loss: 0.851635, loss_ss: 0.827845, loss_d: 0.023790
0.8068 --- loss: 0.574962, loss_ss: 0.555564, loss_d: 0.019397
0.8452 --- loss: 0.824643, loss_ss: 0.775483, loss_d: 0.049160
0.8836 --- loss: 0.978758, loss_ss: 0.921516, loss_d: 0.057242
0.9220 --- loss: 0.708003, loss_ss: 0.656108, loss_d: 0.051895
0.9604 --- loss: 0.818814, loss_ss: 0.648540, loss_d: 0.170274
0.9988 --- loss: 1.589502, loss_ss: 1.583500, loss_d: 0.006002
Epoch finished! Loss: 0.8726388369615261
Starting epoch 9/10.
0.0000 --- loss: 0.812588, loss_ss: 0.762264, loss_d: 0.050324
0.0384 --- loss: 0.971417, loss_ss: 0.692355, loss_d: 0.279062
0.0768 --- loss: 0.822017, loss_ss: 0.538795, loss_d: 0.283223
0.1153 --- loss: 0.758232, loss_ss: 0.711262, loss_d: 0.046970
0.1537 --- loss: 1.178432, loss_ss: 0.815492, loss_d: 0.362940
0.1921 --- loss: 0.639563, loss_ss: 0.566603, loss_d: 0.072960
0.2305 --- loss: 0.647256, loss_ss: 0.629161, loss_d: 0.018095
0.2689 --- loss: 0.733991, loss_ss: 0.726475, loss_d: 0.007516
0.3073 --- loss: 0.653907, loss_ss: 0.634618, loss_d: 0.019289
0.3458 --- loss: 0.671873, loss_ss: 0.670347, loss_d: 0.001526
0.3842 --- loss: 0.610514, loss_ss: 0.605077, loss_d: 0.005437
0.4226 --- loss: 0.623276, loss_ss: 0.622327, loss_d: 0.000949
0.4610 --- loss: 0.802033, loss_ss: 0.796423, loss_d: 0.005610
0.4994 --- loss: 0.486274, loss_ss: 0.484995, loss_d: 0.001279
0.5378 --- loss: 0.796768, loss_ss: 0.766610, loss_d: 0.030159
0.5763 --- loss: 0.530221, loss_ss: 0.516414, loss_d: 0.013806
0.6147 --- loss: 0.789005, loss_ss: 0.781997, loss_d: 0.007008
0.6531 --- loss: 0.660240, loss_ss: 0.650868, loss_d: 0.009372
0.6915 --- loss: 0.667632, loss_ss: 0.653458, loss_d: 0.014174
0.7299 --- loss: 0.996228, loss_ss: 0.994309, loss_d: 0.001920
0.7683 --- loss: 0.866387, loss_ss: 0.763703, loss_d: 0.102683
0.8068 --- loss: 0.784854, loss_ss: 0.774242, loss_d: 0.010612
0.8452 --- loss: 1.301717, loss_ss: 0.656495, loss_d: 0.645222
0.8836 --- loss: 0.504433, loss_ss: 0.502617, loss_d: 0.001816
0.9220 --- loss: 0.694829, loss_ss: 0.586989, loss_d: 0.107840
0.9604 --- loss: 0.872225, loss_ss: 0.812790, loss_d: 0.059435
0.9988 --- loss: 0.716640, loss_ss: 0.711114, loss_d: 0.005525
Epoch finished! Loss: 0.8228871107101441
Starting epoch 10/10.
0.0000 --- loss: 0.700960, loss_ss: 0.695102, loss_d: 0.005857
0.0384 --- loss: 0.904154, loss_ss: 0.895043, loss_d: 0.009112
0.0768 --- loss: 0.893908, loss_ss: 0.874725, loss_d: 0.019183
0.1153 --- loss: 1.147380, loss_ss: 1.076002, loss_d: 0.071378
0.1537 --- loss: 0.842113, loss_ss: 0.836214, loss_d: 0.005899
0.1921 --- loss: 0.848180, loss_ss: 0.760771, loss_d: 0.087409
0.2305 --- loss: 0.900024, loss_ss: 0.807827, loss_d: 0.092198
0.2689 --- loss: 0.798145, loss_ss: 0.780090, loss_d: 0.018055
0.3073 --- loss: 0.627719, loss_ss: 0.626276, loss_d: 0.001444
0.3458 --- loss: 0.644332, loss_ss: 0.642367, loss_d: 0.001964
0.3842 --- loss: 0.600124, loss_ss: 0.587355, loss_d: 0.012769
0.4226 --- loss: 0.813747, loss_ss: 0.796872, loss_d: 0.016875
0.4610 --- loss: 0.700979, loss_ss: 0.687730, loss_d: 0.013249
0.4994 --- loss: 0.950125, loss_ss: 0.945486, loss_d: 0.004639
0.5378 --- loss: 0.798922, loss_ss: 0.792733, loss_d: 0.006190
0.5763 --- loss: 0.834276, loss_ss: 0.722074, loss_d: 0.112202
0.6147 --- loss: 0.766823, loss_ss: 0.764977, loss_d: 0.001846
0.6531 --- loss: 0.586062, loss_ss: 0.505715, loss_d: 0.080347
0.6915 --- loss: 1.169418, loss_ss: 0.830113, loss_d: 0.339305
0.7299 --- loss: 0.811546, loss_ss: 0.764171, loss_d: 0.047375
0.7683 --- loss: 0.857769, loss_ss: 0.752069, loss_d: 0.105701
0.8068 --- loss: 0.785453, loss_ss: 0.758495, loss_d: 0.026959
0.8452 --- loss: 0.662158, loss_ss: 0.649928, loss_d: 0.012230
0.8836 --- loss: 0.965876, loss_ss: 0.804643, loss_d: 0.161232
0.9220 --- loss: 0.681766, loss_ss: 0.670871, loss_d: 0.010895
0.9604 --- loss: 0.801784, loss_ss: 0.699032, loss_d: 0.102752
0.9988 --- loss: 1.645521, loss_ss: 1.266533, loss_d: 0.378988
Epoch finished! Loss: 0.8031023741914676
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7323809523809524
             precision    recall  f1-score   support

        0.0       0.93      0.87      0.90        47
        1.0       0.40      0.02      0.04       108
        2.0       0.88      0.77      0.82       516
        3.0       1.00      0.69      0.81       150
        4.0       0.51      1.00      0.67       229

avg / total       0.77      0.73      0.71      1050
 


====== chp032-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  99.14  87.23   99.70   93.18     90.11
1  89.62   1.85   99.68   40.00      3.54
2  83.43  76.55   90.07   88.17     81.95
3  95.52  68.67  100.00  100.00     81.42
4  78.76  99.56   72.96   50.67     67.16
Total accuracy: 73.24%
Average sen: 66.77%
Average spec: 92.48%
Macro f1-score: 64.84%
Diagnosis acc on 15mins: 1.0
[0.99539351 0.99999988 0.99997795 0.99998581 0.99999404 0.99998558
 0.99998689 0.99999774 1.         0.99999976 0.99999905 0.99999952
 0.99990201 0.99997485 0.99996853 0.99997556 0.9999336  0.99999249
 0.99999988 0.99999988 1.         1.         1.         0.99999988
 0.9999994  0.9999969  0.99999869 0.99999642 1.         1.
 1.         1.         0.99999988 0.99999988 0.99999976]
pred: 0.9998587812696185, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.224977, loss_ss: 1.543643, loss_d: 0.681334
0.0384 --- loss: 2.162231, loss_ss: 1.628404, loss_d: 0.533827
0.0768 --- loss: 2.148053, loss_ss: 1.532006, loss_d: 0.616047
0.1152 --- loss: 1.960253, loss_ss: 1.584500, loss_d: 0.375753
0.1536 --- loss: 2.012232, loss_ss: 1.404066, loss_d: 0.608166
0.1919 --- loss: 2.302377, loss_ss: 1.443198, loss_d: 0.859178
0.2303 --- loss: 1.821573, loss_ss: 1.343711, loss_d: 0.477862
0.2687 --- loss: 2.202328, loss_ss: 1.560938, loss_d: 0.641390
0.3071 --- loss: 1.861569, loss_ss: 1.403266, loss_d: 0.458303
0.3455 --- loss: 1.888820, loss_ss: 1.397379, loss_d: 0.491441
0.3839 --- loss: 1.770799, loss_ss: 1.324514, loss_d: 0.446285
0.4223 --- loss: 1.886611, loss_ss: 1.294746, loss_d: 0.591865
0.4607 --- loss: 1.810847, loss_ss: 1.362513, loss_d: 0.448334
0.4990 --- loss: 1.960391, loss_ss: 1.431370, loss_d: 0.529020
0.5374 --- loss: 1.701218, loss_ss: 1.371518, loss_d: 0.329700
0.5758 --- loss: 1.860416, loss_ss: 1.216715, loss_d: 0.643700
0.6142 --- loss: 1.896641, loss_ss: 1.268161, loss_d: 0.628480
0.6526 --- loss: 1.776262, loss_ss: 1.295823, loss_d: 0.480439
0.6910 --- loss: 1.786395, loss_ss: 1.061427, loss_d: 0.724968
0.7294 --- loss: 1.841249, loss_ss: 1.288530, loss_d: 0.552719
0.7678 --- loss: 1.887652, loss_ss: 1.178180, loss_d: 0.709472
0.8061 --- loss: 1.591707, loss_ss: 1.185134, loss_d: 0.406573
0.8445 --- loss: 1.443486, loss_ss: 1.097602, loss_d: 0.345885
0.8829 --- loss: 1.778416, loss_ss: 1.192054, loss_d: 0.586361
0.9213 --- loss: 1.418766, loss_ss: 1.208124, loss_d: 0.210641
0.9597 --- loss: 1.326700, loss_ss: 1.074215, loss_d: 0.252486
0.9981 --- loss: 1.363921, loss_ss: 1.120969, loss_d: 0.242952
Epoch finished! Loss: 1.8805683246025673
Starting epoch 2/10.
0.0000 --- loss: 1.516738, loss_ss: 1.121075, loss_d: 0.395663
0.0384 --- loss: 1.597666, loss_ss: 1.086075, loss_d: 0.511591
0.0768 --- loss: 1.773243, loss_ss: 1.234092, loss_d: 0.539151
0.1152 --- loss: 1.479474, loss_ss: 1.166692, loss_d: 0.312783
0.1536 --- loss: 1.447770, loss_ss: 1.173065, loss_d: 0.274706
0.1919 --- loss: 1.047269, loss_ss: 0.880164, loss_d: 0.167105
0.2303 --- loss: 1.252576, loss_ss: 1.043084, loss_d: 0.209492
0.2687 --- loss: 1.575379, loss_ss: 1.429577, loss_d: 0.145801
0.3071 --- loss: 1.227709, loss_ss: 1.114696, loss_d: 0.113014
0.3455 --- loss: 1.222828, loss_ss: 0.959868, loss_d: 0.262959
0.3839 --- loss: 1.527395, loss_ss: 1.226326, loss_d: 0.301070
0.4223 --- loss: 1.421303, loss_ss: 1.013717, loss_d: 0.407586
0.4607 --- loss: 1.160928, loss_ss: 1.042052, loss_d: 0.118876
0.4990 --- loss: 1.703238, loss_ss: 1.348576, loss_d: 0.354662
0.5374 --- loss: 1.128208, loss_ss: 1.016270, loss_d: 0.111937
0.5758 --- loss: 1.884012, loss_ss: 0.982622, loss_d: 0.901390
0.6142 --- loss: 1.182233, loss_ss: 0.920075, loss_d: 0.262158
0.6526 --- loss: 1.346555, loss_ss: 0.992013, loss_d: 0.354542
0.6910 --- loss: 1.599146, loss_ss: 1.226924, loss_d: 0.372222
0.7294 --- loss: 1.336803, loss_ss: 0.842142, loss_d: 0.494661
0.7678 --- loss: 0.956593, loss_ss: 0.880527, loss_d: 0.076066
0.8061 --- loss: 1.064113, loss_ss: 0.962049, loss_d: 0.102064
0.8445 --- loss: 1.099437, loss_ss: 1.026678, loss_d: 0.072759
0.8829 --- loss: 1.085322, loss_ss: 0.787318, loss_d: 0.298003
0.9213 --- loss: 1.130937, loss_ss: 1.019054, loss_d: 0.111884
0.9597 --- loss: 0.967399, loss_ss: 0.879151, loss_d: 0.088248
0.9981 --- loss: 1.154286, loss_ss: 1.042530, loss_d: 0.111756
Epoch finished! Loss: 1.369779934332921
Starting epoch 3/10.
0.0000 --- loss: 1.020408, loss_ss: 0.964052, loss_d: 0.056356
0.0384 --- loss: 1.061970, loss_ss: 0.934192, loss_d: 0.127778
0.0768 --- loss: 0.870641, loss_ss: 0.780393, loss_d: 0.090247
0.1152 --- loss: 1.134028, loss_ss: 0.969589, loss_d: 0.164439
0.1536 --- loss: 1.217210, loss_ss: 1.072097, loss_d: 0.145114
0.1919 --- loss: 0.933356, loss_ss: 0.823923, loss_d: 0.109434
0.2303 --- loss: 0.924335, loss_ss: 0.843559, loss_d: 0.080775
0.2687 --- loss: 0.962450, loss_ss: 0.811637, loss_d: 0.150812
0.3071 --- loss: 1.718992, loss_ss: 0.969041, loss_d: 0.749951
0.3455 --- loss: 1.848731, loss_ss: 1.109041, loss_d: 0.739690
0.3839 --- loss: 1.194790, loss_ss: 1.075628, loss_d: 0.119161
0.4223 --- loss: 0.984092, loss_ss: 0.931820, loss_d: 0.052271
0.4607 --- loss: 1.112000, loss_ss: 0.744867, loss_d: 0.367132
0.4990 --- loss: 0.795791, loss_ss: 0.753965, loss_d: 0.041826
0.5374 --- loss: 1.556047, loss_ss: 0.903728, loss_d: 0.652319
0.5758 --- loss: 0.887467, loss_ss: 0.805831, loss_d: 0.081637
0.6142 --- loss: 1.286345, loss_ss: 0.960250, loss_d: 0.326095
0.6526 --- loss: 1.148305, loss_ss: 0.990880, loss_d: 0.157425
0.6910 --- loss: 1.206311, loss_ss: 1.080458, loss_d: 0.125853
0.7294 --- loss: 1.255844, loss_ss: 0.995712, loss_d: 0.260132
0.7678 --- loss: 0.997216, loss_ss: 0.896801, loss_d: 0.100415
0.8061 --- loss: 1.010941, loss_ss: 0.852852, loss_d: 0.158088
0.8445 --- loss: 1.200029, loss_ss: 0.838694, loss_d: 0.361335
0.8829 --- loss: 1.235682, loss_ss: 0.936444, loss_d: 0.299237
0.9213 --- loss: 0.747615, loss_ss: 0.684659, loss_d: 0.062956
0.9597 --- loss: 1.019158, loss_ss: 0.994963, loss_d: 0.024195
0.9981 --- loss: 1.611506, loss_ss: 0.867821, loss_d: 0.743684
Epoch finished! Loss: 1.1411314512674624
Starting epoch 4/10.
0.0000 --- loss: 0.895184, loss_ss: 0.845171, loss_d: 0.050013
0.0384 --- loss: 1.334817, loss_ss: 1.003453, loss_d: 0.331364
0.0768 --- loss: 0.830634, loss_ss: 0.785724, loss_d: 0.044910
0.1152 --- loss: 1.035709, loss_ss: 1.000092, loss_d: 0.035617
0.1536 --- loss: 1.249445, loss_ss: 1.077623, loss_d: 0.171823
0.1919 --- loss: 0.979551, loss_ss: 0.908750, loss_d: 0.070801
0.2303 --- loss: 1.396513, loss_ss: 0.940141, loss_d: 0.456372
0.2687 --- loss: 1.081285, loss_ss: 0.943985, loss_d: 0.137301
0.3071 --- loss: 0.955572, loss_ss: 0.904789, loss_d: 0.050783
0.3455 --- loss: 1.119192, loss_ss: 1.035303, loss_d: 0.083889
0.3839 --- loss: 0.738004, loss_ss: 0.716632, loss_d: 0.021372
0.4223 --- loss: 1.148091, loss_ss: 0.956131, loss_d: 0.191960
0.4607 --- loss: 1.028840, loss_ss: 1.011909, loss_d: 0.016931
0.4990 --- loss: 0.840265, loss_ss: 0.791640, loss_d: 0.048624
0.5374 --- loss: 1.105433, loss_ss: 1.029453, loss_d: 0.075979
0.5758 --- loss: 0.706303, loss_ss: 0.567220, loss_d: 0.139083
0.6142 --- loss: 0.982496, loss_ss: 0.926373, loss_d: 0.056122
0.6526 --- loss: 0.956743, loss_ss: 0.821035, loss_d: 0.135708
0.6910 --- loss: 1.314772, loss_ss: 0.988578, loss_d: 0.326194
0.7294 --- loss: 1.342967, loss_ss: 1.294212, loss_d: 0.048755
0.7678 --- loss: 1.185553, loss_ss: 1.014648, loss_d: 0.170905
0.8061 --- loss: 0.894737, loss_ss: 0.708307, loss_d: 0.186430
0.8445 --- loss: 0.809612, loss_ss: 0.513637, loss_d: 0.295975
0.8829 --- loss: 0.849505, loss_ss: 0.800367, loss_d: 0.049138
0.9213 --- loss: 0.735650, loss_ss: 0.697523, loss_d: 0.038127
0.9597 --- loss: 0.630769, loss_ss: 0.582660, loss_d: 0.048110
0.9981 --- loss: 1.212170, loss_ss: 0.778528, loss_d: 0.433643
Epoch finished! Loss: 1.0311109547431652
Starting epoch 5/10.
0.0000 --- loss: 0.911659, loss_ss: 0.846282, loss_d: 0.065377
0.0384 --- loss: 0.970740, loss_ss: 0.949888, loss_d: 0.020852
0.0768 --- loss: 1.110483, loss_ss: 0.662123, loss_d: 0.448360
0.1152 --- loss: 0.913120, loss_ss: 0.840026, loss_d: 0.073093
0.1536 --- loss: 1.093935, loss_ss: 0.839484, loss_d: 0.254451
0.1919 --- loss: 0.667364, loss_ss: 0.639876, loss_d: 0.027488
0.2303 --- loss: 1.136779, loss_ss: 0.952555, loss_d: 0.184224
0.2687 --- loss: 1.166891, loss_ss: 0.819722, loss_d: 0.347169
0.3071 --- loss: 1.029006, loss_ss: 0.757158, loss_d: 0.271849
0.3455 --- loss: 1.080046, loss_ss: 0.905685, loss_d: 0.174361
0.3839 --- loss: 1.149029, loss_ss: 0.777868, loss_d: 0.371161
0.4223 --- loss: 0.783664, loss_ss: 0.692942, loss_d: 0.090722
0.4607 --- loss: 0.711215, loss_ss: 0.659686, loss_d: 0.051529
0.4990 --- loss: 0.825366, loss_ss: 0.799430, loss_d: 0.025936
0.5374 --- loss: 1.139516, loss_ss: 0.909642, loss_d: 0.229874
0.5758 --- loss: 0.836928, loss_ss: 0.780867, loss_d: 0.056061
0.6142 --- loss: 0.821030, loss_ss: 0.796635, loss_d: 0.024395
0.6526 --- loss: 1.119086, loss_ss: 0.988339, loss_d: 0.130747
0.6910 --- loss: 1.032418, loss_ss: 0.584139, loss_d: 0.448279
0.7294 --- loss: 1.346213, loss_ss: 1.025998, loss_d: 0.320214
0.7678 --- loss: 1.062460, loss_ss: 0.976277, loss_d: 0.086183
0.8061 --- loss: 0.929370, loss_ss: 0.908031, loss_d: 0.021339
0.8445 --- loss: 0.636807, loss_ss: 0.617449, loss_d: 0.019358
0.8829 --- loss: 1.147679, loss_ss: 0.750887, loss_d: 0.396792
0.9213 --- loss: 0.882141, loss_ss: 0.860727, loss_d: 0.021414
0.9597 --- loss: 0.691405, loss_ss: 0.677264, loss_d: 0.014142
0.9981 --- loss: 1.409107, loss_ss: 1.128483, loss_d: 0.280624
Epoch finished! Loss: 0.9840282793228443
Starting epoch 6/10.
0.0000 --- loss: 0.790401, loss_ss: 0.782781, loss_d: 0.007620
0.0384 --- loss: 0.966338, loss_ss: 0.900713, loss_d: 0.065625
0.0768 --- loss: 0.848881, loss_ss: 0.815568, loss_d: 0.033313
0.1152 --- loss: 0.939398, loss_ss: 0.872100, loss_d: 0.067298
0.1536 --- loss: 0.996302, loss_ss: 0.937835, loss_d: 0.058467
0.1919 --- loss: 0.884480, loss_ss: 0.577249, loss_d: 0.307231
0.2303 --- loss: 0.893925, loss_ss: 0.769575, loss_d: 0.124350
0.2687 --- loss: 0.966990, loss_ss: 0.769133, loss_d: 0.197858
0.3071 --- loss: 1.414003, loss_ss: 1.086072, loss_d: 0.327931
0.3455 --- loss: 0.740693, loss_ss: 0.674359, loss_d: 0.066333
0.3839 --- loss: 0.662120, loss_ss: 0.633727, loss_d: 0.028394
0.4223 --- loss: 0.764366, loss_ss: 0.696262, loss_d: 0.068104
0.4607 --- loss: 0.866319, loss_ss: 0.860529, loss_d: 0.005790
0.4990 --- loss: 0.891376, loss_ss: 0.828990, loss_d: 0.062387
0.5374 --- loss: 0.928910, loss_ss: 0.806289, loss_d: 0.122621
0.5758 --- loss: 0.977370, loss_ss: 0.834715, loss_d: 0.142655
0.6142 --- loss: 1.149994, loss_ss: 0.831814, loss_d: 0.318180
0.6526 --- loss: 1.013095, loss_ss: 0.991555, loss_d: 0.021541
0.6910 --- loss: 0.801528, loss_ss: 0.758572, loss_d: 0.042955
0.7294 --- loss: 1.201413, loss_ss: 1.177341, loss_d: 0.024071
0.7678 --- loss: 1.146907, loss_ss: 0.989994, loss_d: 0.156913
0.8061 --- loss: 0.747838, loss_ss: 0.714639, loss_d: 0.033200
0.8445 --- loss: 0.918972, loss_ss: 0.786943, loss_d: 0.132028
0.8829 --- loss: 1.004539, loss_ss: 0.887027, loss_d: 0.117512
0.9213 --- loss: 0.729362, loss_ss: 0.651835, loss_d: 0.077527
0.9597 --- loss: 0.922780, loss_ss: 0.920793, loss_d: 0.001987
0.9981 --- loss: 0.846286, loss_ss: 0.843024, loss_d: 0.003262
Epoch finished! Loss: 0.9136539340019226
Starting epoch 7/10.
0.0000 --- loss: 0.794391, loss_ss: 0.724440, loss_d: 0.069952
0.0384 --- loss: 1.321779, loss_ss: 0.831340, loss_d: 0.490438
0.0768 --- loss: 1.434035, loss_ss: 0.794585, loss_d: 0.639450
0.1152 --- loss: 1.026644, loss_ss: 0.794269, loss_d: 0.232375
0.1536 --- loss: 1.226854, loss_ss: 0.608409, loss_d: 0.618445
0.1919 --- loss: 1.098862, loss_ss: 0.993285, loss_d: 0.105577
0.2303 --- loss: 0.660468, loss_ss: 0.627767, loss_d: 0.032702
0.2687 --- loss: 0.922098, loss_ss: 0.827395, loss_d: 0.094703
0.3071 --- loss: 0.659357, loss_ss: 0.652968, loss_d: 0.006389
0.3455 --- loss: 0.767039, loss_ss: 0.721465, loss_d: 0.045575
0.3839 --- loss: 1.138805, loss_ss: 1.034383, loss_d: 0.104422
0.4223 --- loss: 0.944729, loss_ss: 0.929821, loss_d: 0.014908
0.4607 --- loss: 0.899511, loss_ss: 0.843770, loss_d: 0.055741
0.4990 --- loss: 0.737716, loss_ss: 0.720347, loss_d: 0.017369
0.5374 --- loss: 0.733758, loss_ss: 0.728398, loss_d: 0.005360
0.5758 --- loss: 0.677079, loss_ss: 0.653165, loss_d: 0.023914
0.6142 --- loss: 0.864211, loss_ss: 0.669147, loss_d: 0.195063
0.6526 --- loss: 1.416126, loss_ss: 1.110292, loss_d: 0.305833
0.6910 --- loss: 0.854368, loss_ss: 0.833636, loss_d: 0.020732
0.7294 --- loss: 1.192550, loss_ss: 0.994436, loss_d: 0.198114
0.7678 --- loss: 0.670703, loss_ss: 0.662025, loss_d: 0.008678
0.8061 --- loss: 0.639705, loss_ss: 0.636412, loss_d: 0.003293
0.8445 --- loss: 0.804206, loss_ss: 0.742771, loss_d: 0.061435
0.8829 --- loss: 1.273631, loss_ss: 1.173495, loss_d: 0.100136
0.9213 --- loss: 0.890945, loss_ss: 0.850955, loss_d: 0.039990
0.9597 --- loss: 1.027727, loss_ss: 0.937480, loss_d: 0.090246
0.9981 --- loss: 0.927111, loss_ss: 0.907514, loss_d: 0.019597
Epoch finished! Loss: 0.8903741875520119
Starting epoch 8/10.
0.0000 --- loss: 0.726196, loss_ss: 0.510626, loss_d: 0.215569
0.0384 --- loss: 0.786856, loss_ss: 0.767965, loss_d: 0.018891
0.0768 --- loss: 0.817463, loss_ss: 0.770457, loss_d: 0.047006
0.1152 --- loss: 0.755135, loss_ss: 0.751139, loss_d: 0.003996
0.1536 --- loss: 1.160580, loss_ss: 1.135154, loss_d: 0.025427
0.1919 --- loss: 0.993211, loss_ss: 0.973197, loss_d: 0.020013
0.2303 --- loss: 0.772344, loss_ss: 0.770730, loss_d: 0.001614
0.2687 --- loss: 0.878619, loss_ss: 0.765047, loss_d: 0.113572
0.3071 --- loss: 0.450165, loss_ss: 0.420382, loss_d: 0.029783
0.3455 --- loss: 0.696749, loss_ss: 0.511967, loss_d: 0.184781
0.3839 --- loss: 0.748331, loss_ss: 0.738923, loss_d: 0.009408
0.4223 --- loss: 0.798741, loss_ss: 0.755113, loss_d: 0.043628
0.4607 --- loss: 0.694294, loss_ss: 0.667886, loss_d: 0.026408
0.4990 --- loss: 0.865221, loss_ss: 0.740281, loss_d: 0.124940
0.5374 --- loss: 0.713106, loss_ss: 0.700850, loss_d: 0.012256
0.5758 --- loss: 0.676618, loss_ss: 0.640904, loss_d: 0.035713
0.6142 --- loss: 0.723858, loss_ss: 0.695053, loss_d: 0.028805
0.6526 --- loss: 0.888954, loss_ss: 0.487710, loss_d: 0.401244
0.6910 --- loss: 0.726761, loss_ss: 0.721538, loss_d: 0.005224
0.7294 --- loss: 0.517634, loss_ss: 0.515204, loss_d: 0.002430
0.7678 --- loss: 1.034226, loss_ss: 1.031546, loss_d: 0.002680
0.8061 --- loss: 0.672281, loss_ss: 0.507534, loss_d: 0.164747
0.8445 --- loss: 0.504882, loss_ss: 0.450639, loss_d: 0.054242
0.8829 --- loss: 0.522851, loss_ss: 0.476704, loss_d: 0.046148
0.9213 --- loss: 1.075875, loss_ss: 0.764191, loss_d: 0.311684
0.9597 --- loss: 0.752007, loss_ss: 0.667812, loss_d: 0.084195
0.9981 --- loss: 0.538209, loss_ss: 0.525346, loss_d: 0.012864
Epoch finished! Loss: 0.857793802022934
Starting epoch 9/10.
0.0000 --- loss: 0.920788, loss_ss: 0.882266, loss_d: 0.038522
0.0384 --- loss: 0.630794, loss_ss: 0.600034, loss_d: 0.030760
0.0768 --- loss: 0.846203, loss_ss: 0.828068, loss_d: 0.018135
0.1152 --- loss: 0.636539, loss_ss: 0.596986, loss_d: 0.039552
0.1536 --- loss: 0.580650, loss_ss: 0.576314, loss_d: 0.004336
0.1919 --- loss: 0.454533, loss_ss: 0.443873, loss_d: 0.010660
0.2303 --- loss: 1.040946, loss_ss: 0.957001, loss_d: 0.083946
0.2687 --- loss: 0.601523, loss_ss: 0.547656, loss_d: 0.053867
0.3071 --- loss: 0.933958, loss_ss: 0.909734, loss_d: 0.024224
0.3455 --- loss: 0.850032, loss_ss: 0.772804, loss_d: 0.077228
0.3839 --- loss: 0.703681, loss_ss: 0.607822, loss_d: 0.095859
0.4223 --- loss: 0.823925, loss_ss: 0.813468, loss_d: 0.010457
0.4607 --- loss: 0.814872, loss_ss: 0.764197, loss_d: 0.050675
0.4990 --- loss: 0.758975, loss_ss: 0.757529, loss_d: 0.001446
0.5374 --- loss: 0.723980, loss_ss: 0.711339, loss_d: 0.012641
0.5758 --- loss: 0.835193, loss_ss: 0.819911, loss_d: 0.015281
0.6142 --- loss: 0.610511, loss_ss: 0.580292, loss_d: 0.030219
0.6526 --- loss: 0.680790, loss_ss: 0.673444, loss_d: 0.007346
0.6910 --- loss: 0.545400, loss_ss: 0.507986, loss_d: 0.037415
0.7294 --- loss: 0.487344, loss_ss: 0.486782, loss_d: 0.000562
0.7678 --- loss: 0.746518, loss_ss: 0.729172, loss_d: 0.017346
0.8061 --- loss: 0.839087, loss_ss: 0.823335, loss_d: 0.015752
0.8445 --- loss: 0.936294, loss_ss: 0.933858, loss_d: 0.002436
0.8829 --- loss: 0.837940, loss_ss: 0.836916, loss_d: 0.001024
0.9213 --- loss: 0.875039, loss_ss: 0.861041, loss_d: 0.013998
0.9597 --- loss: 0.543220, loss_ss: 0.542742, loss_d: 0.000478
0.9981 --- loss: 1.072315, loss_ss: 1.070566, loss_d: 0.001748
Epoch finished! Loss: 0.8171731820473305
Starting epoch 10/10.
0.0000 --- loss: 1.053174, loss_ss: 0.991813, loss_d: 0.061361
0.0384 --- loss: 0.638523, loss_ss: 0.561487, loss_d: 0.077036
0.0768 --- loss: 0.899190, loss_ss: 0.892596, loss_d: 0.006594
0.1152 --- loss: 0.487858, loss_ss: 0.485642, loss_d: 0.002216
0.1536 --- loss: 0.860464, loss_ss: 0.854509, loss_d: 0.005955
0.1919 --- loss: 1.062261, loss_ss: 1.001927, loss_d: 0.060333
0.2303 --- loss: 0.863013, loss_ss: 0.803016, loss_d: 0.059997
0.2687 --- loss: 0.718958, loss_ss: 0.655759, loss_d: 0.063199
0.3071 --- loss: 0.775729, loss_ss: 0.757003, loss_d: 0.018726
0.3455 --- loss: 0.610087, loss_ss: 0.532217, loss_d: 0.077871
0.3839 --- loss: 0.650147, loss_ss: 0.554269, loss_d: 0.095878
0.4223 --- loss: 0.858318, loss_ss: 0.851480, loss_d: 0.006837
0.4607 --- loss: 1.213167, loss_ss: 1.174715, loss_d: 0.038452
0.4990 --- loss: 1.468211, loss_ss: 0.575173, loss_d: 0.893038
0.5374 --- loss: 0.555827, loss_ss: 0.514343, loss_d: 0.041483
0.5758 --- loss: 0.689467, loss_ss: 0.561286, loss_d: 0.128181
0.6142 --- loss: 1.163584, loss_ss: 1.057288, loss_d: 0.106296
0.6526 --- loss: 0.515600, loss_ss: 0.502924, loss_d: 0.012676
0.6910 --- loss: 1.018919, loss_ss: 1.010697, loss_d: 0.008222
0.7294 --- loss: 0.650251, loss_ss: 0.644467, loss_d: 0.005784
0.7678 --- loss: 1.190530, loss_ss: 1.108958, loss_d: 0.081572
0.8061 --- loss: 0.744994, loss_ss: 0.725804, loss_d: 0.019190
0.8445 --- loss: 0.617261, loss_ss: 0.613246, loss_d: 0.004015
0.8829 --- loss: 0.829768, loss_ss: 0.764200, loss_d: 0.065568
0.9213 --- loss: 0.625279, loss_ss: 0.581379, loss_d: 0.043900
0.9597 --- loss: 0.780805, loss_ss: 0.712377, loss_d: 0.068429
0.9981 --- loss: 0.921375, loss_ss: 0.641845, loss_d: 0.279530
Epoch finished! Loss: 0.8438152333864799
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6383838383838384
             precision    recall  f1-score   support

        0.0       0.16      0.84      0.27        32
        1.0       0.61      0.71      0.66       251
        2.0       0.59      0.66      0.63       208
        3.0       1.00      0.79      0.88       254
        4.0       0.94      0.36      0.52       245

avg / total       0.77      0.64      0.66       990
 


====== chp033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.05  84.38   85.07  15.88     26.73
1  81.11  70.92   84.57  60.96     65.56
2  83.43  66.35   87.98  59.48     62.73
3  94.55  79.13   99.86  99.50     88.16
4  83.54  35.92   99.19  93.62     51.92
Total accuracy: 63.84%
Average sen: 67.34%
Average spec: 91.34%
Macro f1-score: 59.02%
Diagnosis acc on 15mins: 1.0
[0.99701786 0.9999212  0.99793869 0.99568236 0.99998271 1.
 1.         1.         1.         0.99999988 0.99998248 0.99993694
 0.99999642 0.99999833 0.99986231 0.97104937 0.93413615 0.99999821
 0.9972356  0.99999988 1.         0.99999988 0.99999905 0.92825389
 0.99999762 0.99988461 0.99998701 0.97602284 0.996117   0.99887413
 0.99980372 0.9999423  0.99978226]
pred: 0.9936788696231265, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.443871, loss_ss: 1.717734, loss_d: 0.726137
0.0384 --- loss: 2.107862, loss_ss: 1.534553, loss_d: 0.573309
0.0768 --- loss: 1.934887, loss_ss: 1.399381, loss_d: 0.535507
0.1152 --- loss: 1.766106, loss_ss: 1.447548, loss_d: 0.318558
0.1536 --- loss: 1.838575, loss_ss: 1.401115, loss_d: 0.437460
0.1920 --- loss: 1.678678, loss_ss: 1.311730, loss_d: 0.366948
0.2304 --- loss: 1.964073, loss_ss: 1.363299, loss_d: 0.600775
0.2688 --- loss: 1.960736, loss_ss: 1.303414, loss_d: 0.657322
0.3072 --- loss: 1.957644, loss_ss: 1.340159, loss_d: 0.617484
0.3456 --- loss: 1.765313, loss_ss: 1.266047, loss_d: 0.499266
0.3840 --- loss: 2.235630, loss_ss: 1.283067, loss_d: 0.952563
0.4224 --- loss: 1.855517, loss_ss: 1.218243, loss_d: 0.637274
0.4608 --- loss: 1.690805, loss_ss: 1.171587, loss_d: 0.519218
0.4992 --- loss: 2.021530, loss_ss: 1.343144, loss_d: 0.678386
0.5376 --- loss: 2.003753, loss_ss: 1.449100, loss_d: 0.554653
0.5760 --- loss: 1.850311, loss_ss: 1.304200, loss_d: 0.546111
0.6144 --- loss: 1.924660, loss_ss: 1.141330, loss_d: 0.783330
0.6528 --- loss: 1.910445, loss_ss: 1.169878, loss_d: 0.740566
0.6912 --- loss: 1.716826, loss_ss: 1.102453, loss_d: 0.614373
0.7296 --- loss: 1.909698, loss_ss: 1.197811, loss_d: 0.711888
0.7680 --- loss: 1.742292, loss_ss: 1.084921, loss_d: 0.657371
0.8065 --- loss: 1.504395, loss_ss: 1.164081, loss_d: 0.340314
0.8449 --- loss: 1.461165, loss_ss: 1.044786, loss_d: 0.416378
0.8833 --- loss: 1.669079, loss_ss: 1.234075, loss_d: 0.435004
0.9217 --- loss: 1.510906, loss_ss: 1.229777, loss_d: 0.281129
0.9601 --- loss: 2.219338, loss_ss: 1.072315, loss_d: 1.147023
0.9985 --- loss: 1.670093, loss_ss: 0.919053, loss_d: 0.751040
Epoch finished! Loss: 1.8099580022004935
Starting epoch 2/10.
0.0000 --- loss: 1.421181, loss_ss: 1.150329, loss_d: 0.270853
0.0384 --- loss: 1.589720, loss_ss: 1.208820, loss_d: 0.380900
0.0768 --- loss: 1.707768, loss_ss: 1.022694, loss_d: 0.685074
0.1152 --- loss: 1.334841, loss_ss: 1.130647, loss_d: 0.204194
0.1536 --- loss: 1.234451, loss_ss: 1.005136, loss_d: 0.229315
0.1920 --- loss: 1.361214, loss_ss: 1.054334, loss_d: 0.306880
0.2304 --- loss: 1.479830, loss_ss: 0.937536, loss_d: 0.542294
0.2688 --- loss: 1.456658, loss_ss: 1.072858, loss_d: 0.383800
0.3072 --- loss: 1.287207, loss_ss: 0.946280, loss_d: 0.340927
0.3456 --- loss: 1.475135, loss_ss: 1.035414, loss_d: 0.439721
0.3840 --- loss: 1.399862, loss_ss: 1.073794, loss_d: 0.326068
0.4224 --- loss: 1.112275, loss_ss: 0.955896, loss_d: 0.156379
0.4608 --- loss: 1.400815, loss_ss: 1.086708, loss_d: 0.314107
0.4992 --- loss: 0.912977, loss_ss: 0.853155, loss_d: 0.059822
0.5376 --- loss: 1.362511, loss_ss: 0.923124, loss_d: 0.439386
0.5760 --- loss: 1.260405, loss_ss: 1.027041, loss_d: 0.233364
0.6144 --- loss: 1.191296, loss_ss: 0.863489, loss_d: 0.327808
0.6528 --- loss: 1.257582, loss_ss: 1.163510, loss_d: 0.094073
0.6912 --- loss: 1.580965, loss_ss: 0.888608, loss_d: 0.692357
0.7296 --- loss: 1.158433, loss_ss: 1.057965, loss_d: 0.100468
0.7680 --- loss: 1.246890, loss_ss: 0.951224, loss_d: 0.295666
0.8065 --- loss: 1.096425, loss_ss: 0.854436, loss_d: 0.241990
0.8449 --- loss: 1.120845, loss_ss: 1.013603, loss_d: 0.107242
0.8833 --- loss: 1.580931, loss_ss: 1.013376, loss_d: 0.567554
0.9217 --- loss: 1.239177, loss_ss: 0.927554, loss_d: 0.311623
0.9601 --- loss: 1.456323, loss_ss: 1.007411, loss_d: 0.448912
0.9985 --- loss: 1.558188, loss_ss: 0.914394, loss_d: 0.643794
Epoch finished! Loss: 1.3896325780795171
Starting epoch 3/10.
0.0000 --- loss: 1.017916, loss_ss: 0.874864, loss_d: 0.143052
0.0384 --- loss: 1.045601, loss_ss: 0.859448, loss_d: 0.186154
0.0768 --- loss: 1.087841, loss_ss: 1.000820, loss_d: 0.087022
0.1152 --- loss: 0.846359, loss_ss: 0.738196, loss_d: 0.108163
0.1536 --- loss: 1.280211, loss_ss: 0.984146, loss_d: 0.296065
0.1920 --- loss: 1.212512, loss_ss: 0.998367, loss_d: 0.214145
0.2304 --- loss: 1.351578, loss_ss: 1.158295, loss_d: 0.193283
0.2688 --- loss: 0.974652, loss_ss: 0.868770, loss_d: 0.105883
0.3072 --- loss: 0.830541, loss_ss: 0.782770, loss_d: 0.047771
0.3456 --- loss: 1.339535, loss_ss: 0.893245, loss_d: 0.446290
0.3840 --- loss: 1.398050, loss_ss: 0.921302, loss_d: 0.476748
0.4224 --- loss: 0.869416, loss_ss: 0.835016, loss_d: 0.034399
0.4608 --- loss: 1.210564, loss_ss: 1.093016, loss_d: 0.117548
0.4992 --- loss: 1.561676, loss_ss: 1.329417, loss_d: 0.232258
0.5376 --- loss: 1.705137, loss_ss: 1.101099, loss_d: 0.604038
0.5760 --- loss: 1.518622, loss_ss: 1.022893, loss_d: 0.495729
0.6144 --- loss: 1.026454, loss_ss: 0.747557, loss_d: 0.278897
0.6528 --- loss: 1.156616, loss_ss: 1.033255, loss_d: 0.123361
0.6912 --- loss: 0.885517, loss_ss: 0.708070, loss_d: 0.177447
0.7296 --- loss: 1.037243, loss_ss: 1.009076, loss_d: 0.028167
0.7680 --- loss: 1.120359, loss_ss: 0.951452, loss_d: 0.168906
0.8065 --- loss: 1.306561, loss_ss: 0.963193, loss_d: 0.343368
0.8449 --- loss: 0.936378, loss_ss: 0.842917, loss_d: 0.093461
0.8833 --- loss: 1.363784, loss_ss: 0.761895, loss_d: 0.601889
0.9217 --- loss: 0.990649, loss_ss: 0.834640, loss_d: 0.156009
0.9601 --- loss: 0.948873, loss_ss: 0.858484, loss_d: 0.090389
0.9985 --- loss: 1.448608, loss_ss: 1.127770, loss_d: 0.320838
Epoch finished! Loss: 1.1846050649881363
Starting epoch 4/10.
0.0000 --- loss: 0.968283, loss_ss: 0.858207, loss_d: 0.110076
0.0384 --- loss: 0.932186, loss_ss: 0.775231, loss_d: 0.156955
0.0768 --- loss: 1.295299, loss_ss: 1.269907, loss_d: 0.025392
0.1152 --- loss: 1.365537, loss_ss: 0.816011, loss_d: 0.549526
0.1536 --- loss: 1.353022, loss_ss: 0.777550, loss_d: 0.575473
0.1920 --- loss: 0.992319, loss_ss: 0.810757, loss_d: 0.181562
0.2304 --- loss: 1.704677, loss_ss: 1.235540, loss_d: 0.469136
0.2688 --- loss: 1.332997, loss_ss: 0.994008, loss_d: 0.338988
0.3072 --- loss: 0.901158, loss_ss: 0.793798, loss_d: 0.107359
0.3456 --- loss: 1.175888, loss_ss: 0.825816, loss_d: 0.350072
0.3840 --- loss: 0.850913, loss_ss: 0.782431, loss_d: 0.068482
0.4224 --- loss: 0.946417, loss_ss: 0.732280, loss_d: 0.214137
0.4608 --- loss: 0.868826, loss_ss: 0.824783, loss_d: 0.044042
0.4992 --- loss: 0.949723, loss_ss: 0.894062, loss_d: 0.055661
0.5376 --- loss: 1.006208, loss_ss: 0.905507, loss_d: 0.100701
0.5760 --- loss: 1.619657, loss_ss: 0.769022, loss_d: 0.850635
0.6144 --- loss: 0.965261, loss_ss: 0.599691, loss_d: 0.365569
0.6528 --- loss: 1.094356, loss_ss: 1.003404, loss_d: 0.090952
0.6912 --- loss: 1.242330, loss_ss: 0.918653, loss_d: 0.323677
0.7296 --- loss: 1.360361, loss_ss: 1.020192, loss_d: 0.340168
0.7680 --- loss: 0.993945, loss_ss: 0.797660, loss_d: 0.196285
0.8065 --- loss: 0.697098, loss_ss: 0.621617, loss_d: 0.075481
0.8449 --- loss: 0.789150, loss_ss: 0.710669, loss_d: 0.078481
0.8833 --- loss: 1.183215, loss_ss: 0.882547, loss_d: 0.300668
0.9217 --- loss: 0.831335, loss_ss: 0.668636, loss_d: 0.162699
0.9601 --- loss: 0.796661, loss_ss: 0.713383, loss_d: 0.083279
0.9985 --- loss: 1.295245, loss_ss: 1.289677, loss_d: 0.005568
Epoch finished! Loss: 1.0749640554189681
Starting epoch 5/10.
0.0000 --- loss: 0.706389, loss_ss: 0.665548, loss_d: 0.040841
0.0384 --- loss: 0.929966, loss_ss: 0.594495, loss_d: 0.335471
0.0768 --- loss: 1.358123, loss_ss: 0.903732, loss_d: 0.454391
0.1152 --- loss: 0.963859, loss_ss: 0.925292, loss_d: 0.038567
0.1536 --- loss: 1.078788, loss_ss: 1.040449, loss_d: 0.038339
0.1920 --- loss: 1.489568, loss_ss: 1.011400, loss_d: 0.478168
0.2304 --- loss: 1.111325, loss_ss: 0.905875, loss_d: 0.205450
0.2688 --- loss: 1.331973, loss_ss: 1.058750, loss_d: 0.273223
0.3072 --- loss: 0.953532, loss_ss: 0.898903, loss_d: 0.054629
0.3456 --- loss: 0.813682, loss_ss: 0.690998, loss_d: 0.122684
0.3840 --- loss: 0.748426, loss_ss: 0.728734, loss_d: 0.019692
0.4224 --- loss: 0.821175, loss_ss: 0.680857, loss_d: 0.140317
0.4608 --- loss: 1.045033, loss_ss: 0.795711, loss_d: 0.249322
0.4992 --- loss: 1.059126, loss_ss: 0.917674, loss_d: 0.141453
0.5376 --- loss: 0.883164, loss_ss: 0.708340, loss_d: 0.174824
0.5760 --- loss: 0.721263, loss_ss: 0.661023, loss_d: 0.060240
0.6144 --- loss: 0.841398, loss_ss: 0.822269, loss_d: 0.019129
0.6528 --- loss: 1.186393, loss_ss: 0.819651, loss_d: 0.366742
0.6912 --- loss: 0.741272, loss_ss: 0.717295, loss_d: 0.023977
0.7296 --- loss: 0.966940, loss_ss: 0.543439, loss_d: 0.423501
0.7680 --- loss: 0.865523, loss_ss: 0.563540, loss_d: 0.301984
0.8065 --- loss: 1.638659, loss_ss: 0.762972, loss_d: 0.875688
0.8449 --- loss: 1.721718, loss_ss: 1.128058, loss_d: 0.593660
0.8833 --- loss: 0.880484, loss_ss: 0.810580, loss_d: 0.069904
0.9217 --- loss: 0.824208, loss_ss: 0.652737, loss_d: 0.171470
0.9601 --- loss: 0.876136, loss_ss: 0.811583, loss_d: 0.064553
0.9985 --- loss: 0.644271, loss_ss: 0.627443, loss_d: 0.016828
Epoch finished! Loss: 1.0144292120750134
Starting epoch 6/10.
0.0000 --- loss: 1.048807, loss_ss: 0.920134, loss_d: 0.128673
0.0384 --- loss: 1.309489, loss_ss: 1.266678, loss_d: 0.042811
0.0768 --- loss: 0.872927, loss_ss: 0.728802, loss_d: 0.144126
0.1152 --- loss: 0.774923, loss_ss: 0.728730, loss_d: 0.046193
0.1536 --- loss: 0.895089, loss_ss: 0.864110, loss_d: 0.030978
0.1920 --- loss: 1.064750, loss_ss: 1.047471, loss_d: 0.017279
0.2304 --- loss: 0.975078, loss_ss: 0.766918, loss_d: 0.208160
0.2688 --- loss: 0.959386, loss_ss: 0.813352, loss_d: 0.146034
0.3072 --- loss: 0.633792, loss_ss: 0.599509, loss_d: 0.034283
0.3456 --- loss: 0.874299, loss_ss: 0.794954, loss_d: 0.079345
0.3840 --- loss: 0.972312, loss_ss: 0.948467, loss_d: 0.023845
0.4224 --- loss: 1.198829, loss_ss: 0.549667, loss_d: 0.649162
0.4608 --- loss: 0.744633, loss_ss: 0.678697, loss_d: 0.065936
0.4992 --- loss: 0.627313, loss_ss: 0.588161, loss_d: 0.039152
0.5376 --- loss: 0.824223, loss_ss: 0.818581, loss_d: 0.005642
0.5760 --- loss: 1.043945, loss_ss: 0.847097, loss_d: 0.196848
0.6144 --- loss: 0.873315, loss_ss: 0.858761, loss_d: 0.014554
0.6528 --- loss: 0.910710, loss_ss: 0.898582, loss_d: 0.012127
0.6912 --- loss: 0.762551, loss_ss: 0.692010, loss_d: 0.070541
0.7296 --- loss: 0.566931, loss_ss: 0.536814, loss_d: 0.030117
0.7680 --- loss: 1.029252, loss_ss: 0.548993, loss_d: 0.480258
0.8065 --- loss: 1.165182, loss_ss: 1.134340, loss_d: 0.030842
0.8449 --- loss: 0.854760, loss_ss: 0.801831, loss_d: 0.052929
0.8833 --- loss: 1.171901, loss_ss: 1.123415, loss_d: 0.048486
0.9217 --- loss: 1.655568, loss_ss: 0.832279, loss_d: 0.823289
0.9601 --- loss: 0.820857, loss_ss: 0.809383, loss_d: 0.011474
0.9985 --- loss: 1.144507, loss_ss: 1.132309, loss_d: 0.012198
Epoch finished! Loss: 0.9432058779092936
Starting epoch 7/10.
0.0000 --- loss: 1.192788, loss_ss: 1.112708, loss_d: 0.080080
0.0384 --- loss: 0.747652, loss_ss: 0.716005, loss_d: 0.031647
0.0768 --- loss: 0.879948, loss_ss: 0.817562, loss_d: 0.062386
0.1152 --- loss: 0.758214, loss_ss: 0.734468, loss_d: 0.023746
0.1536 --- loss: 0.749921, loss_ss: 0.651861, loss_d: 0.098060
0.1920 --- loss: 0.596696, loss_ss: 0.516795, loss_d: 0.079901
0.2304 --- loss: 0.846371, loss_ss: 0.808118, loss_d: 0.038254
0.2688 --- loss: 0.922540, loss_ss: 0.894034, loss_d: 0.028506
0.3072 --- loss: 1.358324, loss_ss: 0.812198, loss_d: 0.546127
0.3456 --- loss: 1.058559, loss_ss: 0.924030, loss_d: 0.134529
0.3840 --- loss: 0.751104, loss_ss: 0.738169, loss_d: 0.012935
0.4224 --- loss: 0.602001, loss_ss: 0.548348, loss_d: 0.053652
0.4608 --- loss: 0.962842, loss_ss: 0.719889, loss_d: 0.242952
0.4992 --- loss: 1.179310, loss_ss: 0.842631, loss_d: 0.336679
0.5376 --- loss: 0.777822, loss_ss: 0.695924, loss_d: 0.081898
0.5760 --- loss: 0.701052, loss_ss: 0.684789, loss_d: 0.016262
0.6144 --- loss: 0.821420, loss_ss: 0.743707, loss_d: 0.077712
0.6528 --- loss: 0.760295, loss_ss: 0.700690, loss_d: 0.059605
0.6912 --- loss: 1.012848, loss_ss: 0.830570, loss_d: 0.182277
0.7296 --- loss: 1.072041, loss_ss: 0.911091, loss_d: 0.160950
0.7680 --- loss: 1.013402, loss_ss: 1.009656, loss_d: 0.003746
0.8065 --- loss: 0.537630, loss_ss: 0.485321, loss_d: 0.052310
0.8449 --- loss: 0.575659, loss_ss: 0.569191, loss_d: 0.006467
0.8833 --- loss: 1.017362, loss_ss: 0.910050, loss_d: 0.107312
0.9217 --- loss: 0.915898, loss_ss: 0.913159, loss_d: 0.002739
0.9601 --- loss: 0.982110, loss_ss: 0.966210, loss_d: 0.015901
0.9985 --- loss: 1.217704, loss_ss: 1.061651, loss_d: 0.156052
Epoch finished! Loss: 0.9155599378622495
Starting epoch 8/10.
0.0000 --- loss: 1.461371, loss_ss: 0.751651, loss_d: 0.709720
0.0384 --- loss: 0.750674, loss_ss: 0.733652, loss_d: 0.017022
0.0768 --- loss: 1.024053, loss_ss: 1.008559, loss_d: 0.015494
0.1152 --- loss: 1.230438, loss_ss: 1.184939, loss_d: 0.045499
0.1536 --- loss: 0.764338, loss_ss: 0.674386, loss_d: 0.089953
0.1920 --- loss: 0.856258, loss_ss: 0.822245, loss_d: 0.034013
0.2304 --- loss: 0.989333, loss_ss: 0.886967, loss_d: 0.102366
0.2688 --- loss: 0.940452, loss_ss: 0.840344, loss_d: 0.100108
0.3072 --- loss: 1.065088, loss_ss: 0.659769, loss_d: 0.405319
0.3456 --- loss: 0.709100, loss_ss: 0.540850, loss_d: 0.168250
0.3840 --- loss: 0.710538, loss_ss: 0.595495, loss_d: 0.115042
0.4224 --- loss: 0.732442, loss_ss: 0.655734, loss_d: 0.076707
0.4608 --- loss: 0.794766, loss_ss: 0.747113, loss_d: 0.047653
0.4992 --- loss: 1.194541, loss_ss: 0.861897, loss_d: 0.332644
0.5376 --- loss: 0.974247, loss_ss: 0.965868, loss_d: 0.008380
0.5760 --- loss: 0.602241, loss_ss: 0.505904, loss_d: 0.096336
0.6144 --- loss: 1.243585, loss_ss: 0.998624, loss_d: 0.244961
0.6528 --- loss: 1.113534, loss_ss: 1.041993, loss_d: 0.071542
0.6912 --- loss: 0.660847, loss_ss: 0.657371, loss_d: 0.003476
0.7296 --- loss: 0.561793, loss_ss: 0.550396, loss_d: 0.011397
0.7680 --- loss: 0.948143, loss_ss: 0.850480, loss_d: 0.097663
0.8065 --- loss: 0.776452, loss_ss: 0.726086, loss_d: 0.050366
0.8449 --- loss: 0.973207, loss_ss: 0.642235, loss_d: 0.330971
0.8833 --- loss: 1.171509, loss_ss: 1.161242, loss_d: 0.010268
0.9217 --- loss: 0.551743, loss_ss: 0.473042, loss_d: 0.078700
0.9601 --- loss: 0.867140, loss_ss: 0.783409, loss_d: 0.083731
0.9985 --- loss: 1.548393, loss_ss: 1.539589, loss_d: 0.008804
Epoch finished! Loss: 0.8951316729187966
Starting epoch 9/10.
0.0000 --- loss: 0.781861, loss_ss: 0.590119, loss_d: 0.191742
0.0384 --- loss: 0.890659, loss_ss: 0.888400, loss_d: 0.002258
0.0768 --- loss: 0.732597, loss_ss: 0.711473, loss_d: 0.021124
0.1152 --- loss: 1.343280, loss_ss: 1.287311, loss_d: 0.055969
0.1536 --- loss: 0.732978, loss_ss: 0.643513, loss_d: 0.089464
0.1920 --- loss: 0.617490, loss_ss: 0.592491, loss_d: 0.025000
0.2304 --- loss: 0.749271, loss_ss: 0.741609, loss_d: 0.007662
0.2688 --- loss: 1.033349, loss_ss: 1.001181, loss_d: 0.032169
0.3072 --- loss: 0.740565, loss_ss: 0.662674, loss_d: 0.077891
0.3456 --- loss: 0.872893, loss_ss: 0.830225, loss_d: 0.042667
0.3840 --- loss: 0.725493, loss_ss: 0.676053, loss_d: 0.049440
0.4224 --- loss: 0.601984, loss_ss: 0.580770, loss_d: 0.021214
0.4608 --- loss: 0.816306, loss_ss: 0.811627, loss_d: 0.004679
0.4992 --- loss: 1.531528, loss_ss: 0.906092, loss_d: 0.625436
0.5376 --- loss: 1.186754, loss_ss: 1.105867, loss_d: 0.080887
0.5760 --- loss: 0.544556, loss_ss: 0.506430, loss_d: 0.038126
0.6144 --- loss: 1.015301, loss_ss: 0.990231, loss_d: 0.025070
0.6528 --- loss: 0.849975, loss_ss: 0.822064, loss_d: 0.027912
0.6912 --- loss: 0.641694, loss_ss: 0.628285, loss_d: 0.013409
0.7296 --- loss: 0.636892, loss_ss: 0.563889, loss_d: 0.073003
0.7680 --- loss: 0.764569, loss_ss: 0.723155, loss_d: 0.041413
0.8065 --- loss: 0.714006, loss_ss: 0.658503, loss_d: 0.055503
0.8449 --- loss: 0.865368, loss_ss: 0.852095, loss_d: 0.013274
0.8833 --- loss: 0.644526, loss_ss: 0.640642, loss_d: 0.003884
0.9217 --- loss: 0.512968, loss_ss: 0.500384, loss_d: 0.012584
0.9601 --- loss: 0.801580, loss_ss: 0.778875, loss_d: 0.022705
0.9985 --- loss: 0.853125, loss_ss: 0.852794, loss_d: 0.000331
Epoch finished! Loss: 0.8356441476024115
Starting epoch 10/10.
0.0000 --- loss: 0.606659, loss_ss: 0.605625, loss_d: 0.001034
0.0384 --- loss: 0.866831, loss_ss: 0.763528, loss_d: 0.103302
0.0768 --- loss: 0.733374, loss_ss: 0.731974, loss_d: 0.001399
0.1152 --- loss: 1.082496, loss_ss: 0.728109, loss_d: 0.354387
0.1536 --- loss: 0.823855, loss_ss: 0.798445, loss_d: 0.025410
0.1920 --- loss: 1.124074, loss_ss: 1.111125, loss_d: 0.012948
0.2304 --- loss: 0.793404, loss_ss: 0.778072, loss_d: 0.015332
0.2688 --- loss: 1.167235, loss_ss: 1.086611, loss_d: 0.080624
0.3072 --- loss: 0.674779, loss_ss: 0.646404, loss_d: 0.028375
0.3456 --- loss: 0.736013, loss_ss: 0.691769, loss_d: 0.044245
0.3840 --- loss: 0.612038, loss_ss: 0.520749, loss_d: 0.091289
0.4224 --- loss: 0.874410, loss_ss: 0.749582, loss_d: 0.124827
0.4608 --- loss: 0.927772, loss_ss: 0.739456, loss_d: 0.188317
0.4992 --- loss: 0.885077, loss_ss: 0.648710, loss_d: 0.236367
0.5376 --- loss: 0.534806, loss_ss: 0.503346, loss_d: 0.031460
0.5760 --- loss: 0.735158, loss_ss: 0.710583, loss_d: 0.024575
0.6144 --- loss: 0.841098, loss_ss: 0.833899, loss_d: 0.007199
0.6528 --- loss: 0.853236, loss_ss: 0.789311, loss_d: 0.063925
0.6912 --- loss: 0.847311, loss_ss: 0.820891, loss_d: 0.026420
0.7296 --- loss: 0.742548, loss_ss: 0.725118, loss_d: 0.017430
0.7680 --- loss: 0.709150, loss_ss: 0.698049, loss_d: 0.011102
0.8065 --- loss: 0.611393, loss_ss: 0.588598, loss_d: 0.022795
0.8449 --- loss: 0.851585, loss_ss: 0.830099, loss_d: 0.021486
0.8833 --- loss: 1.059483, loss_ss: 1.009395, loss_d: 0.050088
0.9217 --- loss: 0.872517, loss_ss: 0.865429, loss_d: 0.007088
0.9601 --- loss: 0.864506, loss_ss: 0.854642, loss_d: 0.009864
0.9985 --- loss: 5.259895, loss_ss: 0.557432, loss_d: 4.702463
Epoch finished! Loss: 0.8605135942880924
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7009803921568627
             precision    recall  f1-score   support

        0.0       0.37      0.76      0.50        17
        1.0       0.22      0.21      0.21        62
        2.0       0.65      0.73      0.69       372
        3.0       0.98      0.65      0.78       337
        4.0       0.70      0.86      0.77       232

avg / total       0.74      0.70      0.70      1020
 


====== chp034-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.45  76.47   97.81  37.14     50.00
1  90.69  20.97   95.20  22.03     21.49
2  75.78  72.85   77.47  64.99     68.69
3  87.84  64.69   99.27  97.76     77.86
4  88.43  86.21   89.09  69.93     77.22
Total accuracy: 70.10%
Average sen: 64.24%
Average spec: 91.77%
Macro f1-score: 59.05%
Diagnosis acc on 15mins: 0.9705882352941176
[0.89392972 0.97331166 0.81767738 0.59431821 0.96436608 0.45216185
 0.95729822 0.97357416 0.84069413 0.99360716 0.99999905 0.89583665
 0.84027892 0.79666555 0.99474549 0.81035727 0.96274954 0.96098959
 0.99188179 0.93871808 0.85882187 0.79076123 0.84465659 0.50727439
 0.99888843 0.97571486 0.90752679 0.93006438 0.99121135 0.75092518
 0.95648307 0.92133868 0.96985763 0.95815593]
pred: 0.8827894382617053, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.328092, loss_ss: 1.725242, loss_d: 0.602849
0.0385 --- loss: 1.861866, loss_ss: 1.489157, loss_d: 0.372709
0.0770 --- loss: 2.302343, loss_ss: 1.559244, loss_d: 0.743099
0.1156 --- loss: 1.889039, loss_ss: 1.585428, loss_d: 0.303610
0.1541 --- loss: 1.977128, loss_ss: 1.443852, loss_d: 0.533276
0.1926 --- loss: 2.549440, loss_ss: 1.637305, loss_d: 0.912136
0.2311 --- loss: 2.104416, loss_ss: 1.298395, loss_d: 0.806021
0.2696 --- loss: 2.083354, loss_ss: 1.370048, loss_d: 0.713307
0.3082 --- loss: 1.994360, loss_ss: 1.255465, loss_d: 0.738895
0.3467 --- loss: 1.854962, loss_ss: 1.154755, loss_d: 0.700206
0.3852 --- loss: 2.040006, loss_ss: 1.164645, loss_d: 0.875360
0.4237 --- loss: 1.983776, loss_ss: 1.463391, loss_d: 0.520385
0.4622 --- loss: 1.595578, loss_ss: 1.338224, loss_d: 0.257354
0.5008 --- loss: 2.042088, loss_ss: 1.244287, loss_d: 0.797801
0.5393 --- loss: 1.931164, loss_ss: 1.212514, loss_d: 0.718650
0.5778 --- loss: 1.748228, loss_ss: 1.238685, loss_d: 0.509543
0.6163 --- loss: 1.750634, loss_ss: 1.270020, loss_d: 0.480614
0.6549 --- loss: 1.855068, loss_ss: 1.166210, loss_d: 0.688857
0.6934 --- loss: 1.592425, loss_ss: 1.102566, loss_d: 0.489860
0.7319 --- loss: 1.977744, loss_ss: 1.503059, loss_d: 0.474686
0.7704 --- loss: 1.920682, loss_ss: 1.096577, loss_d: 0.824105
0.8089 --- loss: 1.584409, loss_ss: 1.109528, loss_d: 0.474881
0.8475 --- loss: 1.690151, loss_ss: 1.188733, loss_d: 0.501418
0.8860 --- loss: 1.575942, loss_ss: 1.270519, loss_d: 0.305423
0.9245 --- loss: 1.573519, loss_ss: 1.386428, loss_d: 0.187091
0.9630 --- loss: 1.167186, loss_ss: 0.966260, loss_d: 0.200926
Epoch finished! Loss: 1.8793864894557644
Starting epoch 2/10.
0.0000 --- loss: 1.769977, loss_ss: 1.330397, loss_d: 0.439581
0.0385 --- loss: 1.180325, loss_ss: 1.027313, loss_d: 0.153012
0.0770 --- loss: 1.846478, loss_ss: 1.287926, loss_d: 0.558552
0.1156 --- loss: 1.450041, loss_ss: 0.956852, loss_d: 0.493189
0.1541 --- loss: 1.458836, loss_ss: 1.160334, loss_d: 0.298502
0.1926 --- loss: 1.352044, loss_ss: 0.917013, loss_d: 0.435031
0.2311 --- loss: 1.398642, loss_ss: 0.964838, loss_d: 0.433805
0.2696 --- loss: 1.369227, loss_ss: 1.092538, loss_d: 0.276689
0.3082 --- loss: 1.493294, loss_ss: 1.039359, loss_d: 0.453936
0.3467 --- loss: 1.045101, loss_ss: 0.920217, loss_d: 0.124884
0.3852 --- loss: 1.553463, loss_ss: 1.197953, loss_d: 0.355510
0.4237 --- loss: 1.426878, loss_ss: 1.049463, loss_d: 0.377415
0.4622 --- loss: 1.242410, loss_ss: 0.970401, loss_d: 0.272009
0.5008 --- loss: 1.202046, loss_ss: 0.942942, loss_d: 0.259105
0.5393 --- loss: 1.383835, loss_ss: 1.056493, loss_d: 0.327342
0.5778 --- loss: 1.023247, loss_ss: 0.883767, loss_d: 0.139480
0.6163 --- loss: 1.111184, loss_ss: 0.875407, loss_d: 0.235777
0.6549 --- loss: 1.360188, loss_ss: 0.891639, loss_d: 0.468549
0.6934 --- loss: 2.460941, loss_ss: 1.507313, loss_d: 0.953629
0.7319 --- loss: 1.324847, loss_ss: 1.220632, loss_d: 0.104215
0.7704 --- loss: 1.519859, loss_ss: 1.192438, loss_d: 0.327420
0.8089 --- loss: 1.264390, loss_ss: 0.956948, loss_d: 0.307442
0.8475 --- loss: 1.402576, loss_ss: 1.115229, loss_d: 0.287347
0.8860 --- loss: 1.015320, loss_ss: 0.905497, loss_d: 0.109824
0.9245 --- loss: 1.178400, loss_ss: 0.875212, loss_d: 0.303189
0.9630 --- loss: 0.997304, loss_ss: 0.881331, loss_d: 0.115973
Epoch finished! Loss: 1.3705394804247557
Starting epoch 3/10.
0.0000 --- loss: 1.243507, loss_ss: 0.916481, loss_d: 0.327026
0.0385 --- loss: 0.999654, loss_ss: 0.885046, loss_d: 0.114608
0.0770 --- loss: 1.547230, loss_ss: 1.033326, loss_d: 0.513905
0.1156 --- loss: 1.375406, loss_ss: 0.909091, loss_d: 0.466315
0.1541 --- loss: 2.338910, loss_ss: 0.881426, loss_d: 1.457484
0.1926 --- loss: 1.242188, loss_ss: 0.960380, loss_d: 0.281808
0.2311 --- loss: 1.028811, loss_ss: 0.739179, loss_d: 0.289632
0.2696 --- loss: 1.156868, loss_ss: 1.011888, loss_d: 0.144980
0.3082 --- loss: 1.193700, loss_ss: 1.102795, loss_d: 0.090905
0.3467 --- loss: 1.006510, loss_ss: 0.964134, loss_d: 0.042376
0.3852 --- loss: 1.632476, loss_ss: 1.034324, loss_d: 0.598153
0.4237 --- loss: 1.309166, loss_ss: 1.050088, loss_d: 0.259077
0.4622 --- loss: 0.887716, loss_ss: 0.795282, loss_d: 0.092435
0.5008 --- loss: 1.172643, loss_ss: 0.943338, loss_d: 0.229305
0.5393 --- loss: 1.437366, loss_ss: 0.762501, loss_d: 0.674866
0.5778 --- loss: 1.018365, loss_ss: 0.942572, loss_d: 0.075793
0.6163 --- loss: 1.175200, loss_ss: 0.909056, loss_d: 0.266145
0.6549 --- loss: 1.103686, loss_ss: 0.781681, loss_d: 0.322005
0.6934 --- loss: 1.279500, loss_ss: 0.803148, loss_d: 0.476353
0.7319 --- loss: 1.182492, loss_ss: 0.954195, loss_d: 0.228296
0.7704 --- loss: 1.005702, loss_ss: 0.850428, loss_d: 0.155274
0.8089 --- loss: 0.894257, loss_ss: 0.833187, loss_d: 0.061071
0.8475 --- loss: 1.185368, loss_ss: 0.800763, loss_d: 0.384604
0.8860 --- loss: 0.903549, loss_ss: 0.765001, loss_d: 0.138548
0.9245 --- loss: 1.400444, loss_ss: 1.263712, loss_d: 0.136732
0.9630 --- loss: 1.405519, loss_ss: 1.194523, loss_d: 0.210996
Epoch finished! Loss: 1.1748521254329607
Starting epoch 4/10.
0.0000 --- loss: 0.870851, loss_ss: 0.789538, loss_d: 0.081313
0.0385 --- loss: 0.797634, loss_ss: 0.753222, loss_d: 0.044412
0.0770 --- loss: 1.246068, loss_ss: 1.014910, loss_d: 0.231158
0.1156 --- loss: 1.339786, loss_ss: 0.934511, loss_d: 0.405275
0.1541 --- loss: 1.187050, loss_ss: 1.049459, loss_d: 0.137591
0.1926 --- loss: 0.752907, loss_ss: 0.714396, loss_d: 0.038511
0.2311 --- loss: 0.788740, loss_ss: 0.591418, loss_d: 0.197322
0.2696 --- loss: 1.180439, loss_ss: 0.968216, loss_d: 0.212222
0.3082 --- loss: 0.973515, loss_ss: 0.744352, loss_d: 0.229164
0.3467 --- loss: 0.818717, loss_ss: 0.725376, loss_d: 0.093341
0.3852 --- loss: 0.823495, loss_ss: 0.777253, loss_d: 0.046242
0.4237 --- loss: 1.052036, loss_ss: 0.915481, loss_d: 0.136555
0.4622 --- loss: 0.853612, loss_ss: 0.767892, loss_d: 0.085720
0.5008 --- loss: 1.234574, loss_ss: 0.814881, loss_d: 0.419693
0.5393 --- loss: 1.112939, loss_ss: 0.893170, loss_d: 0.219769
0.5778 --- loss: 0.947938, loss_ss: 0.838523, loss_d: 0.109415
0.6163 --- loss: 0.827943, loss_ss: 0.752028, loss_d: 0.075914
0.6549 --- loss: 0.958050, loss_ss: 0.832972, loss_d: 0.125078
0.6934 --- loss: 1.232337, loss_ss: 1.075504, loss_d: 0.156833
0.7319 --- loss: 1.048473, loss_ss: 0.726826, loss_d: 0.321647
0.7704 --- loss: 0.817562, loss_ss: 0.779564, loss_d: 0.037998
0.8089 --- loss: 1.096856, loss_ss: 0.913555, loss_d: 0.183301
0.8475 --- loss: 0.949790, loss_ss: 0.929606, loss_d: 0.020184
0.8860 --- loss: 1.434184, loss_ss: 1.030986, loss_d: 0.403198
0.9245 --- loss: 1.244509, loss_ss: 0.964595, loss_d: 0.279913
0.9630 --- loss: 0.914335, loss_ss: 0.735303, loss_d: 0.179032
Epoch finished! Loss: 1.0772593941927877
Starting epoch 5/10.
0.0000 --- loss: 0.728049, loss_ss: 0.521726, loss_d: 0.206322
0.0385 --- loss: 1.036478, loss_ss: 0.877493, loss_d: 0.158984
0.0770 --- loss: 0.708109, loss_ss: 0.631842, loss_d: 0.076267
0.1156 --- loss: 0.937663, loss_ss: 0.909673, loss_d: 0.027990
0.1541 --- loss: 0.978238, loss_ss: 0.748948, loss_d: 0.229289
0.1926 --- loss: 0.876914, loss_ss: 0.811795, loss_d: 0.065119
0.2311 --- loss: 1.500653, loss_ss: 0.817012, loss_d: 0.683641
0.2696 --- loss: 0.713003, loss_ss: 0.689732, loss_d: 0.023271
0.3082 --- loss: 0.776149, loss_ss: 0.567959, loss_d: 0.208190
0.3467 --- loss: 0.889759, loss_ss: 0.750540, loss_d: 0.139219
0.3852 --- loss: 1.540204, loss_ss: 0.630497, loss_d: 0.909707
0.4237 --- loss: 0.834240, loss_ss: 0.735456, loss_d: 0.098784
0.4622 --- loss: 1.043029, loss_ss: 0.778263, loss_d: 0.264767
0.5008 --- loss: 1.223565, loss_ss: 1.072556, loss_d: 0.151009
0.5393 --- loss: 1.019450, loss_ss: 0.828776, loss_d: 0.190673
0.5778 --- loss: 1.182308, loss_ss: 0.748445, loss_d: 0.433863
0.6163 --- loss: 1.111686, loss_ss: 1.037573, loss_d: 0.074114
0.6549 --- loss: 0.758359, loss_ss: 0.687921, loss_d: 0.070438
0.6934 --- loss: 0.765831, loss_ss: 0.731948, loss_d: 0.033882
0.7319 --- loss: 0.914243, loss_ss: 0.857433, loss_d: 0.056811
0.7704 --- loss: 0.830472, loss_ss: 0.672943, loss_d: 0.157529
0.8089 --- loss: 1.686049, loss_ss: 1.379012, loss_d: 0.307037
0.8475 --- loss: 1.172562, loss_ss: 0.819908, loss_d: 0.352654
0.8860 --- loss: 0.777156, loss_ss: 0.731114, loss_d: 0.046042
0.9245 --- loss: 0.717391, loss_ss: 0.604129, loss_d: 0.113262
0.9630 --- loss: 0.987963, loss_ss: 0.860740, loss_d: 0.127223
Epoch finished! Loss: 1.0017457233892906
Starting epoch 6/10.
0.0000 --- loss: 0.630690, loss_ss: 0.507446, loss_d: 0.123243
0.0385 --- loss: 0.818618, loss_ss: 0.672818, loss_d: 0.145801
0.0770 --- loss: 0.960089, loss_ss: 0.840355, loss_d: 0.119733
0.1156 --- loss: 1.143542, loss_ss: 0.790344, loss_d: 0.353198
0.1541 --- loss: 0.696272, loss_ss: 0.646185, loss_d: 0.050087
0.1926 --- loss: 0.853836, loss_ss: 0.762028, loss_d: 0.091808
0.2311 --- loss: 1.137425, loss_ss: 0.831495, loss_d: 0.305930
0.2696 --- loss: 1.155143, loss_ss: 1.050943, loss_d: 0.104200
0.3082 --- loss: 0.619874, loss_ss: 0.581155, loss_d: 0.038719
0.3467 --- loss: 0.970672, loss_ss: 0.874276, loss_d: 0.096396
0.3852 --- loss: 0.700944, loss_ss: 0.654762, loss_d: 0.046182
0.4237 --- loss: 0.820854, loss_ss: 0.765283, loss_d: 0.055571
0.4622 --- loss: 0.879657, loss_ss: 0.664223, loss_d: 0.215434
0.5008 --- loss: 1.116899, loss_ss: 1.097179, loss_d: 0.019720
0.5393 --- loss: 0.836320, loss_ss: 0.681782, loss_d: 0.154538
0.5778 --- loss: 1.275826, loss_ss: 1.183664, loss_d: 0.092162
0.6163 --- loss: 0.685989, loss_ss: 0.609053, loss_d: 0.076936
0.6549 --- loss: 1.023946, loss_ss: 0.844871, loss_d: 0.179076
0.6934 --- loss: 1.406694, loss_ss: 0.956655, loss_d: 0.450039
0.7319 --- loss: 0.871043, loss_ss: 0.858613, loss_d: 0.012430
0.7704 --- loss: 0.931095, loss_ss: 0.786343, loss_d: 0.144752
0.8089 --- loss: 0.608960, loss_ss: 0.567860, loss_d: 0.041100
0.8475 --- loss: 0.932631, loss_ss: 0.775393, loss_d: 0.157238
0.8860 --- loss: 0.970680, loss_ss: 0.950935, loss_d: 0.019744
0.9245 --- loss: 0.975593, loss_ss: 0.583367, loss_d: 0.392226
0.9630 --- loss: 1.180001, loss_ss: 1.115094, loss_d: 0.064907
Epoch finished! Loss: 0.9553477389011604
Starting epoch 7/10.
0.0000 --- loss: 0.947688, loss_ss: 0.767259, loss_d: 0.180430
0.0385 --- loss: 1.023182, loss_ss: 0.807554, loss_d: 0.215627
0.0770 --- loss: 0.851010, loss_ss: 0.814164, loss_d: 0.036846
0.1156 --- loss: 0.935999, loss_ss: 0.798687, loss_d: 0.137312
0.1541 --- loss: 0.818879, loss_ss: 0.804064, loss_d: 0.014815
0.1926 --- loss: 1.164505, loss_ss: 0.880753, loss_d: 0.283752
0.2311 --- loss: 0.951592, loss_ss: 0.909006, loss_d: 0.042586
0.2696 --- loss: 0.859725, loss_ss: 0.830608, loss_d: 0.029117
0.3082 --- loss: 0.931454, loss_ss: 0.891327, loss_d: 0.040127
0.3467 --- loss: 0.648860, loss_ss: 0.629518, loss_d: 0.019341
0.3852 --- loss: 0.762788, loss_ss: 0.657904, loss_d: 0.104884
0.4237 --- loss: 0.970910, loss_ss: 0.940984, loss_d: 0.029925
0.4622 --- loss: 0.774187, loss_ss: 0.721267, loss_d: 0.052921
0.5008 --- loss: 0.581355, loss_ss: 0.571081, loss_d: 0.010274
0.5393 --- loss: 1.018453, loss_ss: 0.990307, loss_d: 0.028146
0.5778 --- loss: 0.725123, loss_ss: 0.718207, loss_d: 0.006917
0.6163 --- loss: 1.105507, loss_ss: 0.832555, loss_d: 0.272952
0.6549 --- loss: 0.889113, loss_ss: 0.882197, loss_d: 0.006916
0.6934 --- loss: 0.932589, loss_ss: 0.874501, loss_d: 0.058088
0.7319 --- loss: 1.261478, loss_ss: 1.033850, loss_d: 0.227628
0.7704 --- loss: 0.604878, loss_ss: 0.597848, loss_d: 0.007030
0.8089 --- loss: 1.022292, loss_ss: 0.892310, loss_d: 0.129982
0.8475 --- loss: 1.117643, loss_ss: 0.895665, loss_d: 0.221977
0.8860 --- loss: 1.094090, loss_ss: 1.060350, loss_d: 0.033740
0.9245 --- loss: 1.161143, loss_ss: 1.091235, loss_d: 0.069908
0.9630 --- loss: 0.924411, loss_ss: 0.711628, loss_d: 0.212783
Epoch finished! Loss: 0.8881773711631658
Starting epoch 8/10.
0.0000 --- loss: 0.494034, loss_ss: 0.475752, loss_d: 0.018282
0.0385 --- loss: 1.019647, loss_ss: 0.981333, loss_d: 0.038313
0.0770 --- loss: 1.548687, loss_ss: 0.963617, loss_d: 0.585070
0.1156 --- loss: 0.613998, loss_ss: 0.584392, loss_d: 0.029606
0.1541 --- loss: 0.835838, loss_ss: 0.787746, loss_d: 0.048092
0.1926 --- loss: 0.703483, loss_ss: 0.573940, loss_d: 0.129543
0.2311 --- loss: 0.637086, loss_ss: 0.552532, loss_d: 0.084553
0.2696 --- loss: 1.153254, loss_ss: 0.970607, loss_d: 0.182647
0.3082 --- loss: 0.819656, loss_ss: 0.753215, loss_d: 0.066441
0.3467 --- loss: 0.813912, loss_ss: 0.784520, loss_d: 0.029392
0.3852 --- loss: 0.770617, loss_ss: 0.738034, loss_d: 0.032583
0.4237 --- loss: 0.766738, loss_ss: 0.740645, loss_d: 0.026093
0.4622 --- loss: 0.643121, loss_ss: 0.635036, loss_d: 0.008085
0.5008 --- loss: 0.663475, loss_ss: 0.659885, loss_d: 0.003591
0.5393 --- loss: 1.292123, loss_ss: 0.904278, loss_d: 0.387845
0.5778 --- loss: 0.814856, loss_ss: 0.672739, loss_d: 0.142116
0.6163 --- loss: 1.206826, loss_ss: 1.130737, loss_d: 0.076089
0.6549 --- loss: 0.988158, loss_ss: 0.849951, loss_d: 0.138206
0.6934 --- loss: 0.840227, loss_ss: 0.704491, loss_d: 0.135736
0.7319 --- loss: 0.984741, loss_ss: 0.924904, loss_d: 0.059838
0.7704 --- loss: 0.750963, loss_ss: 0.581136, loss_d: 0.169827
0.8089 --- loss: 1.307010, loss_ss: 1.107917, loss_d: 0.199093
0.8475 --- loss: 0.672928, loss_ss: 0.665792, loss_d: 0.007136
0.8860 --- loss: 0.937241, loss_ss: 0.715343, loss_d: 0.221898
0.9245 --- loss: 0.545160, loss_ss: 0.536205, loss_d: 0.008956
0.9630 --- loss: 1.180469, loss_ss: 0.901429, loss_d: 0.279041
Epoch finished! Loss: 0.8647516861155227
Starting epoch 9/10.
0.0000 --- loss: 0.737470, loss_ss: 0.635983, loss_d: 0.101486
0.0385 --- loss: 0.755097, loss_ss: 0.691156, loss_d: 0.063941
0.0770 --- loss: 1.053113, loss_ss: 1.019498, loss_d: 0.033615
0.1156 --- loss: 0.740206, loss_ss: 0.511539, loss_d: 0.228666
0.1541 --- loss: 0.772958, loss_ss: 0.667118, loss_d: 0.105840
0.1926 --- loss: 0.721091, loss_ss: 0.567245, loss_d: 0.153846
0.2311 --- loss: 1.092151, loss_ss: 1.055127, loss_d: 0.037024
0.2696 --- loss: 0.915040, loss_ss: 0.761916, loss_d: 0.153124
0.3082 --- loss: 0.648380, loss_ss: 0.584715, loss_d: 0.063665
0.3467 --- loss: 0.584492, loss_ss: 0.548487, loss_d: 0.036005
0.3852 --- loss: 0.844224, loss_ss: 0.725709, loss_d: 0.118515
0.4237 --- loss: 0.694610, loss_ss: 0.674456, loss_d: 0.020154
0.4622 --- loss: 0.682115, loss_ss: 0.663342, loss_d: 0.018773
0.5008 --- loss: 0.624151, loss_ss: 0.623049, loss_d: 0.001102
0.5393 --- loss: 0.667060, loss_ss: 0.659953, loss_d: 0.007108
0.5778 --- loss: 0.818839, loss_ss: 0.695094, loss_d: 0.123745
0.6163 --- loss: 1.045455, loss_ss: 0.758409, loss_d: 0.287046
0.6549 --- loss: 0.742000, loss_ss: 0.724300, loss_d: 0.017700
0.6934 --- loss: 1.112602, loss_ss: 0.779745, loss_d: 0.332857
0.7319 --- loss: 0.713255, loss_ss: 0.648119, loss_d: 0.065137
0.7704 --- loss: 0.914309, loss_ss: 0.674156, loss_d: 0.240153
0.8089 --- loss: 0.997410, loss_ss: 0.645799, loss_d: 0.351611
0.8475 --- loss: 0.705680, loss_ss: 0.689572, loss_d: 0.016108
0.8860 --- loss: 1.166185, loss_ss: 0.660855, loss_d: 0.505330
0.9245 --- loss: 1.137071, loss_ss: 1.115431, loss_d: 0.021639
0.9630 --- loss: 0.880457, loss_ss: 0.850771, loss_d: 0.029686
Epoch finished! Loss: 0.8528097970375224
Starting epoch 10/10.
0.0000 --- loss: 1.208371, loss_ss: 1.190755, loss_d: 0.017616
0.0385 --- loss: 1.114548, loss_ss: 1.095547, loss_d: 0.019001
0.0770 --- loss: 0.577585, loss_ss: 0.541891, loss_d: 0.035694
0.1156 --- loss: 0.743441, loss_ss: 0.737805, loss_d: 0.005636
0.1541 --- loss: 0.733707, loss_ss: 0.715689, loss_d: 0.018017
0.1926 --- loss: 0.648022, loss_ss: 0.585236, loss_d: 0.062786
0.2311 --- loss: 0.721608, loss_ss: 0.716091, loss_d: 0.005516
0.2696 --- loss: 0.639239, loss_ss: 0.630418, loss_d: 0.008821
0.3082 --- loss: 0.802140, loss_ss: 0.796374, loss_d: 0.005766
0.3467 --- loss: 0.801595, loss_ss: 0.799484, loss_d: 0.002111
0.3852 --- loss: 0.869141, loss_ss: 0.793356, loss_d: 0.075785
0.4237 --- loss: 0.883076, loss_ss: 0.838677, loss_d: 0.044399
0.4622 --- loss: 1.138049, loss_ss: 0.661131, loss_d: 0.476917
0.5008 --- loss: 0.743727, loss_ss: 0.710219, loss_d: 0.033508
0.5393 --- loss: 1.078632, loss_ss: 0.668878, loss_d: 0.409755
0.5778 --- loss: 0.934357, loss_ss: 0.798086, loss_d: 0.136271
0.6163 --- loss: 0.485987, loss_ss: 0.445162, loss_d: 0.040826
0.6549 --- loss: 1.796582, loss_ss: 1.647955, loss_d: 0.148628
0.6934 --- loss: 0.652792, loss_ss: 0.637042, loss_d: 0.015750
0.7319 --- loss: 0.963698, loss_ss: 0.808378, loss_d: 0.155321
0.7704 --- loss: 0.797892, loss_ss: 0.778646, loss_d: 0.019246
0.8089 --- loss: 0.749484, loss_ss: 0.738504, loss_d: 0.010980
0.8475 --- loss: 0.760434, loss_ss: 0.712249, loss_d: 0.048185
0.8860 --- loss: 0.645816, loss_ss: 0.592625, loss_d: 0.053191
0.9245 --- loss: 0.872686, loss_ss: 0.797365, loss_d: 0.075321
0.9630 --- loss: 1.292323, loss_ss: 0.901812, loss_d: 0.390510
Epoch finished! Loss: 0.7975757631786081
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7365079365079366
             precision    recall  f1-score   support

        0.0       0.74      0.96      0.84       237
        1.0       0.42      0.80      0.55       167
        2.0       0.96      0.73      0.83       563
        3.0       0.09      0.62      0.16         8
        4.0       0.99      0.53      0.69       285

avg / total       0.85      0.74      0.76      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.94  96.20   92.18  74.03     83.67
1  82.78  80.24   83.17  42.14     55.26
2  86.51  73.00   97.42  95.80     82.86
3  95.95  62.50   96.17   9.43     16.39
4  89.13  52.63   99.79  98.68     68.65
Total accuracy: 73.65%
Average sen: 72.92%
Average spec: 93.74%
Macro f1-score: 61.37%
Diagnosis acc on 15mins: 1.0
[0.99999118 0.99999988 0.99994421 0.99999654 0.99999082 0.99999702
 0.99999762 0.99992812 0.99998569 0.99846894 0.99998403 0.99974936
 0.99781346 0.98367119 0.99961734 0.99972862 0.99930429 0.99747568
 0.99868649 0.99996042 0.99987614 0.99999225 0.99999821 0.99999976
 0.99995601 0.99989104 0.99962437 0.99994349 0.99999285 0.99999738
 0.99785787 0.99998713 0.99999964 0.99999988 0.99994552 0.99988639
 0.99999392 0.99872535 0.99970478 0.99998236 0.99906462 0.99993026]
pred: 0.9992533368723733, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.549533, loss_ss: 1.875896, loss_d: 0.673637
0.0384 --- loss: 2.351704, loss_ss: 1.671252, loss_d: 0.680452
0.0768 --- loss: 1.703441, loss_ss: 1.602499, loss_d: 0.100942
0.1152 --- loss: 2.385376, loss_ss: 1.716855, loss_d: 0.668521
0.1536 --- loss: 2.326930, loss_ss: 1.753583, loss_d: 0.573346
0.1920 --- loss: 2.232239, loss_ss: 1.552031, loss_d: 0.680208
0.2304 --- loss: 1.951784, loss_ss: 1.571902, loss_d: 0.379882
0.2688 --- loss: 2.431684, loss_ss: 1.844308, loss_d: 0.587376
0.3072 --- loss: 2.231816, loss_ss: 1.679077, loss_d: 0.552738
0.3456 --- loss: 2.476189, loss_ss: 1.585022, loss_d: 0.891167
0.3840 --- loss: 2.146481, loss_ss: 1.501852, loss_d: 0.644629
0.4224 --- loss: 1.977662, loss_ss: 1.521221, loss_d: 0.456440
0.4608 --- loss: 2.556569, loss_ss: 1.591211, loss_d: 0.965358
0.4992 --- loss: 1.994859, loss_ss: 1.462268, loss_d: 0.532591
0.5376 --- loss: 2.031430, loss_ss: 1.501206, loss_d: 0.530224
0.5760 --- loss: 1.894460, loss_ss: 1.396180, loss_d: 0.498281
0.6144 --- loss: 1.791373, loss_ss: 1.417999, loss_d: 0.373375
0.6528 --- loss: 1.692576, loss_ss: 1.310939, loss_d: 0.381638
0.6912 --- loss: 1.587273, loss_ss: 1.295754, loss_d: 0.291518
0.7296 --- loss: 1.860863, loss_ss: 1.302459, loss_d: 0.558404
0.7680 --- loss: 2.017164, loss_ss: 1.372365, loss_d: 0.644799
0.8065 --- loss: 1.930010, loss_ss: 1.348145, loss_d: 0.581865
0.8449 --- loss: 1.671644, loss_ss: 1.319773, loss_d: 0.351871
0.8833 --- loss: 1.630282, loss_ss: 1.460352, loss_d: 0.169930
0.9217 --- loss: 1.681133, loss_ss: 1.444690, loss_d: 0.236444
0.9601 --- loss: 1.731910, loss_ss: 1.303332, loss_d: 0.428578
0.9985 --- loss: 1.985818, loss_ss: 1.619343, loss_d: 0.366475
Epoch finished! Loss: 2.0503626126509444
Starting epoch 2/10.
0.0000 --- loss: 1.576247, loss_ss: 1.265098, loss_d: 0.311149
0.0384 --- loss: 1.597975, loss_ss: 1.257434, loss_d: 0.340541
0.0768 --- loss: 1.791032, loss_ss: 1.410442, loss_d: 0.380590
0.1152 --- loss: 1.653708, loss_ss: 1.252042, loss_d: 0.401666
0.1536 --- loss: 1.348387, loss_ss: 1.225458, loss_d: 0.122930
0.1920 --- loss: 1.415638, loss_ss: 1.139421, loss_d: 0.276217
0.2304 --- loss: 1.570941, loss_ss: 1.230421, loss_d: 0.340520
0.2688 --- loss: 1.599902, loss_ss: 1.310852, loss_d: 0.289049
0.3072 --- loss: 1.358974, loss_ss: 1.167630, loss_d: 0.191344
0.3456 --- loss: 1.324618, loss_ss: 1.180811, loss_d: 0.143807
0.3840 --- loss: 1.325272, loss_ss: 1.249144, loss_d: 0.076128
0.4224 --- loss: 1.128631, loss_ss: 0.958866, loss_d: 0.169764
0.4608 --- loss: 1.321511, loss_ss: 1.054285, loss_d: 0.267225
0.4992 --- loss: 1.514565, loss_ss: 1.305253, loss_d: 0.209312
0.5376 --- loss: 1.157257, loss_ss: 1.038741, loss_d: 0.118516
0.5760 --- loss: 1.281334, loss_ss: 0.939708, loss_d: 0.341627
0.6144 --- loss: 1.590452, loss_ss: 0.975131, loss_d: 0.615321
0.6528 --- loss: 1.227242, loss_ss: 0.923824, loss_d: 0.303419
0.6912 --- loss: 1.433281, loss_ss: 0.961281, loss_d: 0.471999
0.7296 --- loss: 1.563476, loss_ss: 1.153116, loss_d: 0.410360
0.7680 --- loss: 1.388289, loss_ss: 0.979717, loss_d: 0.408572
0.8065 --- loss: 1.267460, loss_ss: 0.852868, loss_d: 0.414592
0.8449 --- loss: 1.107397, loss_ss: 0.996168, loss_d: 0.111229
0.8833 --- loss: 1.391970, loss_ss: 1.093877, loss_d: 0.298093
0.9217 --- loss: 1.198555, loss_ss: 1.087467, loss_d: 0.111088
0.9601 --- loss: 1.091510, loss_ss: 1.012760, loss_d: 0.078750
0.9985 --- loss: 1.260317, loss_ss: 1.139834, loss_d: 0.120483
Epoch finished! Loss: 1.4542269018980174
Starting epoch 3/10.
0.0000 --- loss: 1.400475, loss_ss: 1.246661, loss_d: 0.153815
0.0384 --- loss: 0.900221, loss_ss: 0.839832, loss_d: 0.060388
0.0768 --- loss: 0.845490, loss_ss: 0.823793, loss_d: 0.021697
0.1152 --- loss: 0.872760, loss_ss: 0.817837, loss_d: 0.054923
0.1536 --- loss: 1.184249, loss_ss: 1.021222, loss_d: 0.163027
0.1920 --- loss: 1.451996, loss_ss: 0.950982, loss_d: 0.501014
0.2304 --- loss: 1.078135, loss_ss: 0.910979, loss_d: 0.167156
0.2688 --- loss: 1.632344, loss_ss: 0.918698, loss_d: 0.713646
0.3072 --- loss: 0.944954, loss_ss: 0.822293, loss_d: 0.122661
0.3456 --- loss: 1.273756, loss_ss: 1.016320, loss_d: 0.257436
0.3840 --- loss: 1.341373, loss_ss: 0.988338, loss_d: 0.353036
0.4224 --- loss: 0.992452, loss_ss: 0.919579, loss_d: 0.072873
0.4608 --- loss: 1.206291, loss_ss: 1.130394, loss_d: 0.075896
0.4992 --- loss: 1.028230, loss_ss: 0.857863, loss_d: 0.170367
0.5376 --- loss: 1.080610, loss_ss: 0.938177, loss_d: 0.142433
0.5760 --- loss: 1.473936, loss_ss: 1.220624, loss_d: 0.253311
0.6144 --- loss: 1.184260, loss_ss: 0.969737, loss_d: 0.214523
0.6528 --- loss: 1.295643, loss_ss: 1.000132, loss_d: 0.295511
0.6912 --- loss: 1.223113, loss_ss: 0.789331, loss_d: 0.433782
0.7296 --- loss: 2.182061, loss_ss: 0.917259, loss_d: 1.264803
0.7680 --- loss: 1.196926, loss_ss: 1.089556, loss_d: 0.107370
0.8065 --- loss: 1.088452, loss_ss: 0.944327, loss_d: 0.144125
0.8449 --- loss: 1.398076, loss_ss: 1.230186, loss_d: 0.167890
0.8833 --- loss: 0.895694, loss_ss: 0.805582, loss_d: 0.090112
0.9217 --- loss: 0.927849, loss_ss: 0.874613, loss_d: 0.053236
0.9601 --- loss: 0.949815, loss_ss: 0.873603, loss_d: 0.076212
0.9985 --- loss: 0.869494, loss_ss: 0.765730, loss_d: 0.103764
Epoch finished! Loss: 1.164314374098411
Starting epoch 4/10.
0.0000 --- loss: 1.201734, loss_ss: 0.793670, loss_d: 0.408064
0.0384 --- loss: 0.602215, loss_ss: 0.546124, loss_d: 0.056091
0.0768 --- loss: 1.503316, loss_ss: 0.689622, loss_d: 0.813694
0.1152 --- loss: 1.100491, loss_ss: 0.978301, loss_d: 0.122189
0.1536 --- loss: 1.131834, loss_ss: 1.077256, loss_d: 0.054578
0.1920 --- loss: 0.791315, loss_ss: 0.758523, loss_d: 0.032792
0.2304 --- loss: 1.396486, loss_ss: 0.769707, loss_d: 0.626779
0.2688 --- loss: 1.306400, loss_ss: 0.983525, loss_d: 0.322875
0.3072 --- loss: 0.762148, loss_ss: 0.660803, loss_d: 0.101345
0.3456 --- loss: 0.895382, loss_ss: 0.840160, loss_d: 0.055221
0.3840 --- loss: 1.317599, loss_ss: 0.807477, loss_d: 0.510122
0.4224 --- loss: 0.818985, loss_ss: 0.703539, loss_d: 0.115446
0.4608 --- loss: 0.907678, loss_ss: 0.754956, loss_d: 0.152723
0.4992 --- loss: 1.078637, loss_ss: 0.903063, loss_d: 0.175574
0.5376 --- loss: 1.026904, loss_ss: 0.807602, loss_d: 0.219303
0.5760 --- loss: 1.000809, loss_ss: 0.821768, loss_d: 0.179041
0.6144 --- loss: 1.244439, loss_ss: 1.042403, loss_d: 0.202036
0.6528 --- loss: 1.199028, loss_ss: 1.137801, loss_d: 0.061228
0.6912 --- loss: 0.854153, loss_ss: 0.790978, loss_d: 0.063175
0.7296 --- loss: 1.051990, loss_ss: 0.836813, loss_d: 0.215177
0.7680 --- loss: 0.936409, loss_ss: 0.792956, loss_d: 0.143453
0.8065 --- loss: 0.902363, loss_ss: 0.800455, loss_d: 0.101908
0.8449 --- loss: 1.167943, loss_ss: 1.143971, loss_d: 0.023972
0.8833 --- loss: 1.115253, loss_ss: 0.996885, loss_d: 0.118368
0.9217 --- loss: 1.190891, loss_ss: 1.040493, loss_d: 0.150398
0.9601 --- loss: 0.884899, loss_ss: 0.809601, loss_d: 0.075298
0.9985 --- loss: 0.968425, loss_ss: 0.888827, loss_d: 0.079598
Epoch finished! Loss: 1.0773612400660149
Starting epoch 5/10.
0.0000 --- loss: 0.934125, loss_ss: 0.757269, loss_d: 0.176856
0.0384 --- loss: 0.706075, loss_ss: 0.653267, loss_d: 0.052808
0.0768 --- loss: 1.611245, loss_ss: 1.496836, loss_d: 0.114409
0.1152 --- loss: 0.945523, loss_ss: 0.847710, loss_d: 0.097813
0.1536 --- loss: 0.902848, loss_ss: 0.794778, loss_d: 0.108070
0.1920 --- loss: 0.986239, loss_ss: 0.945522, loss_d: 0.040716
0.2304 --- loss: 1.220973, loss_ss: 1.142448, loss_d: 0.078525
0.2688 --- loss: 0.900517, loss_ss: 0.875329, loss_d: 0.025188
0.3072 --- loss: 0.749248, loss_ss: 0.710133, loss_d: 0.039116
0.3456 --- loss: 1.157690, loss_ss: 0.777518, loss_d: 0.380172
0.3840 --- loss: 1.416926, loss_ss: 1.331842, loss_d: 0.085084
0.4224 --- loss: 1.492800, loss_ss: 1.034257, loss_d: 0.458543
0.4608 --- loss: 0.814578, loss_ss: 0.754682, loss_d: 0.059895
0.4992 --- loss: 1.027735, loss_ss: 0.842252, loss_d: 0.185483
0.5376 --- loss: 1.079857, loss_ss: 1.054145, loss_d: 0.025712
0.5760 --- loss: 0.894798, loss_ss: 0.673829, loss_d: 0.220970
0.6144 --- loss: 0.939407, loss_ss: 0.876694, loss_d: 0.062714
0.6528 --- loss: 1.156911, loss_ss: 0.875446, loss_d: 0.281465
0.6912 --- loss: 0.929513, loss_ss: 0.883602, loss_d: 0.045911
0.7296 --- loss: 0.909198, loss_ss: 0.777825, loss_d: 0.131374
0.7680 --- loss: 0.766735, loss_ss: 0.708949, loss_d: 0.057786
0.8065 --- loss: 0.791799, loss_ss: 0.730899, loss_d: 0.060900
0.8449 --- loss: 0.642057, loss_ss: 0.591801, loss_d: 0.050256
0.8833 --- loss: 1.647727, loss_ss: 0.855927, loss_d: 0.791800
0.9217 --- loss: 0.956809, loss_ss: 0.622164, loss_d: 0.334645
0.9601 --- loss: 0.649221, loss_ss: 0.567510, loss_d: 0.081711
0.9985 --- loss: 0.957860, loss_ss: 0.729356, loss_d: 0.228503
Epoch finished! Loss: 0.9877100343887623
Starting epoch 6/10.
0.0000 --- loss: 0.714513, loss_ss: 0.673245, loss_d: 0.041269
0.0384 --- loss: 1.774373, loss_ss: 1.329651, loss_d: 0.444722
0.0768 --- loss: 0.953572, loss_ss: 0.880910, loss_d: 0.072662
0.1152 --- loss: 1.519324, loss_ss: 1.066087, loss_d: 0.453237
0.1536 --- loss: 0.930573, loss_ss: 0.736177, loss_d: 0.194396
0.1920 --- loss: 1.084964, loss_ss: 1.061671, loss_d: 0.023292
0.2304 --- loss: 0.929544, loss_ss: 0.893325, loss_d: 0.036219
0.2688 --- loss: 0.871942, loss_ss: 0.633121, loss_d: 0.238821
0.3072 --- loss: 0.944783, loss_ss: 0.732816, loss_d: 0.211967
0.3456 --- loss: 1.062528, loss_ss: 0.849776, loss_d: 0.212752
0.3840 --- loss: 1.309979, loss_ss: 1.131673, loss_d: 0.178307
0.4224 --- loss: 0.643711, loss_ss: 0.550911, loss_d: 0.092800
0.4608 --- loss: 0.868249, loss_ss: 0.820510, loss_d: 0.047739
0.4992 --- loss: 1.723675, loss_ss: 0.675260, loss_d: 1.048414
0.5376 --- loss: 1.412655, loss_ss: 0.736881, loss_d: 0.675774
0.5760 --- loss: 1.047220, loss_ss: 0.960474, loss_d: 0.086746
0.6144 --- loss: 0.801122, loss_ss: 0.733475, loss_d: 0.067647
0.6528 --- loss: 1.222140, loss_ss: 0.881990, loss_d: 0.340150
0.6912 --- loss: 0.774219, loss_ss: 0.632884, loss_d: 0.141335
0.7296 --- loss: 0.757578, loss_ss: 0.679139, loss_d: 0.078439
0.7680 --- loss: 0.903771, loss_ss: 0.866949, loss_d: 0.036822
0.8065 --- loss: 0.789206, loss_ss: 0.592359, loss_d: 0.196848
0.8449 --- loss: 0.960984, loss_ss: 0.827315, loss_d: 0.133670
0.8833 --- loss: 1.025376, loss_ss: 0.998805, loss_d: 0.026571
0.9217 --- loss: 1.399383, loss_ss: 0.849589, loss_d: 0.549794
0.9601 --- loss: 0.771924, loss_ss: 0.751559, loss_d: 0.020365
0.9985 --- loss: 0.751457, loss_ss: 0.716253, loss_d: 0.035204
Epoch finished! Loss: 0.9484281306083385
Starting epoch 7/10.
0.0000 --- loss: 0.811526, loss_ss: 0.771956, loss_d: 0.039570
0.0384 --- loss: 1.082615, loss_ss: 0.928860, loss_d: 0.153756
0.0768 --- loss: 0.728737, loss_ss: 0.694974, loss_d: 0.033763
0.1152 --- loss: 1.256017, loss_ss: 1.233851, loss_d: 0.022167
0.1536 --- loss: 0.879946, loss_ss: 0.707304, loss_d: 0.172642
0.1920 --- loss: 0.819201, loss_ss: 0.766573, loss_d: 0.052629
0.2304 --- loss: 1.029989, loss_ss: 0.997929, loss_d: 0.032060
0.2688 --- loss: 0.721079, loss_ss: 0.703350, loss_d: 0.017729
0.3072 --- loss: 0.974863, loss_ss: 0.850585, loss_d: 0.124278
0.3456 --- loss: 0.748477, loss_ss: 0.689107, loss_d: 0.059370
0.3840 --- loss: 0.802123, loss_ss: 0.623129, loss_d: 0.178995
0.4224 --- loss: 1.130026, loss_ss: 0.513762, loss_d: 0.616264
0.4608 --- loss: 0.654084, loss_ss: 0.474793, loss_d: 0.179291
0.4992 --- loss: 0.890403, loss_ss: 0.782277, loss_d: 0.108126
0.5376 --- loss: 0.971254, loss_ss: 0.921992, loss_d: 0.049262
0.5760 --- loss: 1.025747, loss_ss: 0.894694, loss_d: 0.131053
0.6144 --- loss: 0.839428, loss_ss: 0.713206, loss_d: 0.126222
0.6528 --- loss: 1.007753, loss_ss: 0.893446, loss_d: 0.114307
0.6912 --- loss: 0.896017, loss_ss: 0.824483, loss_d: 0.071534
0.7296 --- loss: 0.675159, loss_ss: 0.533315, loss_d: 0.141844
0.7680 --- loss: 1.356189, loss_ss: 1.342336, loss_d: 0.013853
0.8065 --- loss: 1.219231, loss_ss: 0.814731, loss_d: 0.404500
0.8449 --- loss: 0.916387, loss_ss: 0.836519, loss_d: 0.079868
0.8833 --- loss: 1.173102, loss_ss: 0.848031, loss_d: 0.325070
0.9217 --- loss: 0.760407, loss_ss: 0.708535, loss_d: 0.051872
0.9601 --- loss: 0.760908, loss_ss: 0.675099, loss_d: 0.085809
0.9985 --- loss: 1.734316, loss_ss: 1.330382, loss_d: 0.403935
Epoch finished! Loss: 0.9433827755542902
Starting epoch 8/10.
0.0000 --- loss: 0.977569, loss_ss: 0.888239, loss_d: 0.089330
0.0384 --- loss: 0.632160, loss_ss: 0.582448, loss_d: 0.049712
0.0768 --- loss: 0.708984, loss_ss: 0.656409, loss_d: 0.052575
0.1152 --- loss: 0.857547, loss_ss: 0.761179, loss_d: 0.096368
0.1536 --- loss: 0.925641, loss_ss: 0.811400, loss_d: 0.114242
0.1920 --- loss: 0.823135, loss_ss: 0.763282, loss_d: 0.059853
0.2304 --- loss: 0.958869, loss_ss: 0.843892, loss_d: 0.114977
0.2688 --- loss: 0.665846, loss_ss: 0.659533, loss_d: 0.006313
0.3072 --- loss: 0.946306, loss_ss: 0.861516, loss_d: 0.084790
0.3456 --- loss: 0.744434, loss_ss: 0.652672, loss_d: 0.091762
0.3840 --- loss: 0.799689, loss_ss: 0.757414, loss_d: 0.042275
0.4224 --- loss: 1.602447, loss_ss: 0.756207, loss_d: 0.846240
0.4608 --- loss: 1.052687, loss_ss: 1.035802, loss_d: 0.016885
0.4992 --- loss: 0.603145, loss_ss: 0.591941, loss_d: 0.011204
0.5376 --- loss: 1.055484, loss_ss: 1.003256, loss_d: 0.052228
0.5760 --- loss: 0.936293, loss_ss: 0.926515, loss_d: 0.009778
0.6144 --- loss: 0.853254, loss_ss: 0.774773, loss_d: 0.078481
0.6528 --- loss: 1.101236, loss_ss: 0.790961, loss_d: 0.310275
0.6912 --- loss: 1.058975, loss_ss: 0.799630, loss_d: 0.259345
0.7296 --- loss: 1.114000, loss_ss: 1.017290, loss_d: 0.096709
0.7680 --- loss: 0.878158, loss_ss: 0.830209, loss_d: 0.047949
0.8065 --- loss: 0.772460, loss_ss: 0.672394, loss_d: 0.100066
0.8449 --- loss: 0.750543, loss_ss: 0.724640, loss_d: 0.025904
0.8833 --- loss: 0.694968, loss_ss: 0.678092, loss_d: 0.016876
0.9217 --- loss: 0.948553, loss_ss: 0.913327, loss_d: 0.035226
0.9601 --- loss: 0.662849, loss_ss: 0.567251, loss_d: 0.095598
0.9985 --- loss: 1.138333, loss_ss: 0.913815, loss_d: 0.224518
Epoch finished! Loss: 0.8755437550636438
Starting epoch 9/10.
0.0000 --- loss: 0.640787, loss_ss: 0.626205, loss_d: 0.014582
0.0384 --- loss: 0.636672, loss_ss: 0.624096, loss_d: 0.012576
0.0768 --- loss: 1.055099, loss_ss: 0.793118, loss_d: 0.261981
0.1152 --- loss: 1.142822, loss_ss: 0.958998, loss_d: 0.183825
0.1536 --- loss: 1.068491, loss_ss: 0.725207, loss_d: 0.343285
0.1920 --- loss: 0.754186, loss_ss: 0.715498, loss_d: 0.038688
0.2304 --- loss: 0.670222, loss_ss: 0.652621, loss_d: 0.017601
0.2688 --- loss: 1.001403, loss_ss: 0.859206, loss_d: 0.142197
0.3072 --- loss: 0.866915, loss_ss: 0.752995, loss_d: 0.113920
0.3456 --- loss: 0.680552, loss_ss: 0.631197, loss_d: 0.049355
0.3840 --- loss: 1.014148, loss_ss: 0.762113, loss_d: 0.252035
0.4224 --- loss: 0.707412, loss_ss: 0.693568, loss_d: 0.013845
0.4608 --- loss: 0.821593, loss_ss: 0.811989, loss_d: 0.009604
0.4992 --- loss: 0.661224, loss_ss: 0.643041, loss_d: 0.018183
0.5376 --- loss: 0.976179, loss_ss: 0.662657, loss_d: 0.313522
0.5760 --- loss: 0.693962, loss_ss: 0.690848, loss_d: 0.003114
0.6144 --- loss: 0.632512, loss_ss: 0.627480, loss_d: 0.005032
0.6528 --- loss: 0.800431, loss_ss: 0.798731, loss_d: 0.001700
0.6912 --- loss: 0.614506, loss_ss: 0.608872, loss_d: 0.005633
0.7296 --- loss: 0.659123, loss_ss: 0.653415, loss_d: 0.005708
0.7680 --- loss: 0.699887, loss_ss: 0.662652, loss_d: 0.037235
0.8065 --- loss: 0.580030, loss_ss: 0.554148, loss_d: 0.025883
0.8449 --- loss: 0.745409, loss_ss: 0.592240, loss_d: 0.153169
0.8833 --- loss: 0.869627, loss_ss: 0.855403, loss_d: 0.014224
0.9217 --- loss: 1.486488, loss_ss: 0.853020, loss_d: 0.633468
0.9601 --- loss: 1.416826, loss_ss: 1.089017, loss_d: 0.327809
0.9985 --- loss: 1.563623, loss_ss: 0.616239, loss_d: 0.947384
Epoch finished! Loss: 0.8481266386233843
Starting epoch 10/10.
0.0000 --- loss: 0.858381, loss_ss: 0.772530, loss_d: 0.085851
0.0384 --- loss: 0.748239, loss_ss: 0.676539, loss_d: 0.071700
0.0768 --- loss: 0.445524, loss_ss: 0.417331, loss_d: 0.028193
0.1152 --- loss: 0.754565, loss_ss: 0.709082, loss_d: 0.045483
0.1536 --- loss: 0.864206, loss_ss: 0.638334, loss_d: 0.225871
0.1920 --- loss: 0.721217, loss_ss: 0.717397, loss_d: 0.003820
0.2304 --- loss: 0.872629, loss_ss: 0.602197, loss_d: 0.270432
0.2688 --- loss: 0.685379, loss_ss: 0.683455, loss_d: 0.001924
0.3072 --- loss: 0.649865, loss_ss: 0.609773, loss_d: 0.040093
0.3456 --- loss: 0.734170, loss_ss: 0.650389, loss_d: 0.083781
0.3840 --- loss: 0.935214, loss_ss: 0.792265, loss_d: 0.142949
0.4224 --- loss: 1.156857, loss_ss: 1.032137, loss_d: 0.124721
0.4608 --- loss: 0.710022, loss_ss: 0.666070, loss_d: 0.043952
0.4992 --- loss: 0.707334, loss_ss: 0.697878, loss_d: 0.009456
0.5376 --- loss: 0.944630, loss_ss: 0.936418, loss_d: 0.008212
0.5760 --- loss: 0.858992, loss_ss: 0.849999, loss_d: 0.008993
0.6144 --- loss: 0.725691, loss_ss: 0.688370, loss_d: 0.037321
0.6528 --- loss: 0.608944, loss_ss: 0.601089, loss_d: 0.007855
0.6912 --- loss: 0.779717, loss_ss: 0.723648, loss_d: 0.056069
0.7296 --- loss: 0.959482, loss_ss: 0.669479, loss_d: 0.290003
0.7680 --- loss: 0.743379, loss_ss: 0.709903, loss_d: 0.033476
0.8065 --- loss: 0.895536, loss_ss: 0.857837, loss_d: 0.037699
0.8449 --- loss: 1.335450, loss_ss: 0.698143, loss_d: 0.637306
0.8833 --- loss: 0.903536, loss_ss: 0.812433, loss_d: 0.091103
0.9217 --- loss: 0.989031, loss_ss: 0.805418, loss_d: 0.183613
0.9601 --- loss: 0.936683, loss_ss: 0.715138, loss_d: 0.221546
0.9985 --- loss: 0.914190, loss_ss: 0.874283, loss_d: 0.039906
Epoch finished! Loss: 0.8479013413190841
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6463654223968566
             precision    recall  f1-score   support

        0.0       0.83      0.69      0.76       197
        1.0       0.43      0.29      0.34       161
        2.0       0.84      0.55      0.67       348
        3.0       1.00      0.87      0.93       208
        4.0       0.30      0.99      0.47       104

avg / total       0.75      0.65      0.67      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.36  69.04   96.71   83.44     75.56
1  82.61  28.57   92.77   42.59     34.20
2  81.14  55.17   94.63   84.21     66.67
3  97.35  87.02  100.00  100.00     93.06
4  76.82  99.04   74.29   30.47     46.61
Total accuracy: 64.64%
Average sen: 67.77%
Average spec: 91.68%
Macro f1-score: 63.22%
Diagnosis acc on 15mins: 1.0
[1.         0.99999034 0.99950814 0.99999225 1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         0.99999368 0.99883574
 0.99999988 0.99999893 1.         1.         0.99999952 1.
 1.         0.99985719 1.         1.         0.99999666 0.9999969
 1.         1.         1.         1.        ]
pred: 0.9999461542157566, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.537026, loss_ss: 1.786610, loss_d: 0.750416
0.0384 --- loss: 2.413152, loss_ss: 1.657392, loss_d: 0.755760
0.0768 --- loss: 2.050538, loss_ss: 1.425988, loss_d: 0.624550
0.1152 --- loss: 2.099355, loss_ss: 1.627035, loss_d: 0.472320
0.1536 --- loss: 1.914064, loss_ss: 1.526847, loss_d: 0.387217
0.1920 --- loss: 1.615993, loss_ss: 1.213440, loss_d: 0.402553
0.2304 --- loss: 1.919718, loss_ss: 1.441953, loss_d: 0.477765
0.2688 --- loss: 1.955616, loss_ss: 1.209682, loss_d: 0.745934
0.3072 --- loss: 1.807981, loss_ss: 1.157840, loss_d: 0.650141
0.3456 --- loss: 1.880608, loss_ss: 1.298051, loss_d: 0.582557
0.3840 --- loss: 1.819435, loss_ss: 1.355563, loss_d: 0.463872
0.4224 --- loss: 1.651601, loss_ss: 1.282677, loss_d: 0.368924
0.4608 --- loss: 1.915863, loss_ss: 1.360679, loss_d: 0.555184
0.4992 --- loss: 1.955612, loss_ss: 1.213555, loss_d: 0.742057
0.5376 --- loss: 1.543672, loss_ss: 1.203210, loss_d: 0.340462
0.5760 --- loss: 1.712365, loss_ss: 1.172931, loss_d: 0.539434
0.6144 --- loss: 1.801359, loss_ss: 1.084352, loss_d: 0.717007
0.6528 --- loss: 1.494511, loss_ss: 1.140482, loss_d: 0.354029
0.6912 --- loss: 2.023772, loss_ss: 1.135391, loss_d: 0.888381
0.7296 --- loss: 1.946042, loss_ss: 1.572003, loss_d: 0.374039
0.7680 --- loss: 1.316830, loss_ss: 1.031174, loss_d: 0.285656
0.8065 --- loss: 1.590110, loss_ss: 1.202746, loss_d: 0.387364
0.8449 --- loss: 1.390660, loss_ss: 1.208822, loss_d: 0.181838
0.8833 --- loss: 1.275903, loss_ss: 1.010809, loss_d: 0.265095
0.9217 --- loss: 1.603020, loss_ss: 1.254140, loss_d: 0.348880
0.9601 --- loss: 1.227767, loss_ss: 1.051747, loss_d: 0.176020
0.9985 --- loss: 1.666932, loss_ss: 1.027312, loss_d: 0.639619
Epoch finished! Loss: 1.7792910429147573
Starting epoch 2/10.
0.0000 --- loss: 1.430684, loss_ss: 1.038958, loss_d: 0.391725
0.0384 --- loss: 1.489134, loss_ss: 1.105232, loss_d: 0.383902
0.0768 --- loss: 1.198014, loss_ss: 1.025308, loss_d: 0.172706
0.1152 --- loss: 1.865817, loss_ss: 1.289836, loss_d: 0.575981
0.1536 --- loss: 1.560768, loss_ss: 0.992856, loss_d: 0.567912
0.1920 --- loss: 1.419930, loss_ss: 1.031236, loss_d: 0.388694
0.2304 --- loss: 1.249743, loss_ss: 0.922695, loss_d: 0.327048
0.2688 --- loss: 1.222061, loss_ss: 0.925322, loss_d: 0.296739
0.3072 --- loss: 1.502414, loss_ss: 1.195114, loss_d: 0.307300
0.3456 --- loss: 2.027031, loss_ss: 1.269194, loss_d: 0.757837
0.3840 --- loss: 1.200264, loss_ss: 0.891780, loss_d: 0.308483
0.4224 --- loss: 1.231068, loss_ss: 0.847522, loss_d: 0.383546
0.4608 --- loss: 0.992029, loss_ss: 0.923179, loss_d: 0.068850
0.4992 --- loss: 1.571272, loss_ss: 1.065450, loss_d: 0.505822
0.5376 --- loss: 1.071034, loss_ss: 0.980823, loss_d: 0.090211
0.5760 --- loss: 1.236152, loss_ss: 1.095711, loss_d: 0.140442
0.6144 --- loss: 1.609118, loss_ss: 0.950612, loss_d: 0.658506
0.6528 --- loss: 0.993639, loss_ss: 0.823065, loss_d: 0.170575
0.6912 --- loss: 0.933422, loss_ss: 0.844971, loss_d: 0.088451
0.7296 --- loss: 1.706649, loss_ss: 1.259522, loss_d: 0.447127
0.7680 --- loss: 1.109752, loss_ss: 0.958380, loss_d: 0.151372
0.8065 --- loss: 1.498418, loss_ss: 0.974764, loss_d: 0.523654
0.8449 --- loss: 1.037272, loss_ss: 0.959702, loss_d: 0.077570
0.8833 --- loss: 1.235472, loss_ss: 1.055520, loss_d: 0.179952
0.9217 --- loss: 1.207577, loss_ss: 1.095874, loss_d: 0.111704
0.9601 --- loss: 1.526591, loss_ss: 0.780233, loss_d: 0.746358
0.9985 --- loss: 1.472856, loss_ss: 0.961180, loss_d: 0.511676
Epoch finished! Loss: 1.288694789317938
Starting epoch 3/10.
0.0000 --- loss: 1.054296, loss_ss: 0.885275, loss_d: 0.169022
0.0384 --- loss: 0.931548, loss_ss: 0.760029, loss_d: 0.171518
0.0768 --- loss: 1.238955, loss_ss: 1.092690, loss_d: 0.146265
0.1152 --- loss: 1.168463, loss_ss: 0.901857, loss_d: 0.266605
0.1536 --- loss: 1.120450, loss_ss: 1.029936, loss_d: 0.090515
0.1920 --- loss: 1.372263, loss_ss: 0.824831, loss_d: 0.547432
0.2304 --- loss: 1.379475, loss_ss: 1.170701, loss_d: 0.208775
0.2688 --- loss: 1.178023, loss_ss: 0.912900, loss_d: 0.265123
0.3072 --- loss: 1.422018, loss_ss: 0.773160, loss_d: 0.648858
0.3456 --- loss: 1.270036, loss_ss: 1.068664, loss_d: 0.201372
0.3840 --- loss: 1.094551, loss_ss: 1.059068, loss_d: 0.035483
0.4224 --- loss: 1.106716, loss_ss: 1.004766, loss_d: 0.101950
0.4608 --- loss: 1.194591, loss_ss: 1.049673, loss_d: 0.144918
0.4992 --- loss: 1.370839, loss_ss: 1.137487, loss_d: 0.233352
0.5376 --- loss: 1.073503, loss_ss: 0.930863, loss_d: 0.142640
0.5760 --- loss: 1.147188, loss_ss: 1.114595, loss_d: 0.032593
0.6144 --- loss: 1.077391, loss_ss: 1.040447, loss_d: 0.036944
0.6528 --- loss: 1.799109, loss_ss: 1.484107, loss_d: 0.315002
0.6912 --- loss: 1.253543, loss_ss: 0.923978, loss_d: 0.329565
0.7296 --- loss: 1.088559, loss_ss: 0.832564, loss_d: 0.255995
0.7680 --- loss: 1.242586, loss_ss: 1.017551, loss_d: 0.225035
0.8065 --- loss: 0.793351, loss_ss: 0.680383, loss_d: 0.112968
0.8449 --- loss: 1.145502, loss_ss: 0.807257, loss_d: 0.338246
0.8833 --- loss: 0.823120, loss_ss: 0.593019, loss_d: 0.230101
0.9217 --- loss: 1.020231, loss_ss: 0.821849, loss_d: 0.198382
0.9601 --- loss: 1.146935, loss_ss: 0.928711, loss_d: 0.218224
0.9985 --- loss: 1.128358, loss_ss: 1.111434, loss_d: 0.016923
Epoch finished! Loss: 1.1143064457636613
Starting epoch 4/10.
0.0000 --- loss: 1.149118, loss_ss: 0.909360, loss_d: 0.239757
0.0384 --- loss: 1.274922, loss_ss: 0.770568, loss_d: 0.504355
0.0768 --- loss: 1.193504, loss_ss: 0.763499, loss_d: 0.430005
0.1152 --- loss: 1.264205, loss_ss: 1.045476, loss_d: 0.218729
0.1536 --- loss: 0.798433, loss_ss: 0.646614, loss_d: 0.151819
0.1920 --- loss: 0.934009, loss_ss: 0.850742, loss_d: 0.083267
0.2304 --- loss: 0.931321, loss_ss: 0.840374, loss_d: 0.090947
0.2688 --- loss: 0.813610, loss_ss: 0.614086, loss_d: 0.199524
0.3072 --- loss: 1.291488, loss_ss: 1.070364, loss_d: 0.221124
0.3456 --- loss: 0.719264, loss_ss: 0.636678, loss_d: 0.082586
0.3840 --- loss: 0.889470, loss_ss: 0.664051, loss_d: 0.225419
0.4224 --- loss: 1.016548, loss_ss: 0.871955, loss_d: 0.144593
0.4608 --- loss: 1.451192, loss_ss: 1.005776, loss_d: 0.445416
0.4992 --- loss: 1.454824, loss_ss: 1.200567, loss_d: 0.254257
0.5376 --- loss: 1.077705, loss_ss: 0.846833, loss_d: 0.230872
0.5760 --- loss: 1.245034, loss_ss: 0.725662, loss_d: 0.519372
0.6144 --- loss: 1.128979, loss_ss: 0.839284, loss_d: 0.289695
0.6528 --- loss: 0.679429, loss_ss: 0.649426, loss_d: 0.030002
0.6912 --- loss: 0.971205, loss_ss: 0.789158, loss_d: 0.182047
0.7296 --- loss: 1.078465, loss_ss: 0.703744, loss_d: 0.374721
0.7680 --- loss: 0.954891, loss_ss: 0.766950, loss_d: 0.187941
0.8065 --- loss: 0.829934, loss_ss: 0.603099, loss_d: 0.226835
0.8449 --- loss: 0.712922, loss_ss: 0.644805, loss_d: 0.068116
0.8833 --- loss: 1.196008, loss_ss: 0.592165, loss_d: 0.603843
0.9217 --- loss: 1.115565, loss_ss: 0.892458, loss_d: 0.223107
0.9601 --- loss: 1.009336, loss_ss: 0.867523, loss_d: 0.141813
0.9985 --- loss: 1.495833, loss_ss: 1.017334, loss_d: 0.478499
Epoch finished! Loss: 1.0457105599916898
Starting epoch 5/10.
0.0000 --- loss: 1.071784, loss_ss: 0.939357, loss_d: 0.132427
0.0384 --- loss: 0.703919, loss_ss: 0.628088, loss_d: 0.075830
0.0768 --- loss: 0.998891, loss_ss: 0.914080, loss_d: 0.084811
0.1152 --- loss: 1.105701, loss_ss: 0.690085, loss_d: 0.415616
0.1536 --- loss: 0.780293, loss_ss: 0.564768, loss_d: 0.215525
0.1920 --- loss: 0.660414, loss_ss: 0.603257, loss_d: 0.057157
0.2304 --- loss: 0.812262, loss_ss: 0.660415, loss_d: 0.151847
0.2688 --- loss: 1.237625, loss_ss: 0.864157, loss_d: 0.373468
0.3072 --- loss: 0.776726, loss_ss: 0.511209, loss_d: 0.265518
0.3456 --- loss: 1.224935, loss_ss: 0.667770, loss_d: 0.557165
0.3840 --- loss: 0.702928, loss_ss: 0.668035, loss_d: 0.034893
0.4224 --- loss: 1.307843, loss_ss: 0.611097, loss_d: 0.696746
0.4608 --- loss: 1.151241, loss_ss: 0.638600, loss_d: 0.512641
0.4992 --- loss: 0.837573, loss_ss: 0.772482, loss_d: 0.065091
0.5376 --- loss: 0.924691, loss_ss: 0.815255, loss_d: 0.109436
0.5760 --- loss: 1.006174, loss_ss: 0.825669, loss_d: 0.180505
0.6144 --- loss: 0.913757, loss_ss: 0.749338, loss_d: 0.164419
0.6528 --- loss: 0.878534, loss_ss: 0.816023, loss_d: 0.062511
0.6912 --- loss: 0.938061, loss_ss: 0.627107, loss_d: 0.310954
0.7296 --- loss: 1.242254, loss_ss: 0.996929, loss_d: 0.245325
0.7680 --- loss: 0.947806, loss_ss: 0.871592, loss_d: 0.076214
0.8065 --- loss: 0.676713, loss_ss: 0.625859, loss_d: 0.050854
0.8449 --- loss: 1.404478, loss_ss: 0.625546, loss_d: 0.778932
0.8833 --- loss: 0.895417, loss_ss: 0.857983, loss_d: 0.037434
0.9217 --- loss: 0.667390, loss_ss: 0.615773, loss_d: 0.051617
0.9601 --- loss: 0.873104, loss_ss: 0.853320, loss_d: 0.019785
0.9985 --- loss: 1.357554, loss_ss: 0.702370, loss_d: 0.655185
Epoch finished! Loss: 0.9795871961575288
Starting epoch 6/10.
0.0000 --- loss: 0.798115, loss_ss: 0.563754, loss_d: 0.234362
0.0384 --- loss: 1.201498, loss_ss: 0.899602, loss_d: 0.301895
0.0768 --- loss: 0.923613, loss_ss: 0.848076, loss_d: 0.075537
0.1152 --- loss: 0.906487, loss_ss: 0.771460, loss_d: 0.135027
0.1536 --- loss: 0.967404, loss_ss: 0.694118, loss_d: 0.273285
0.1920 --- loss: 1.266157, loss_ss: 0.780449, loss_d: 0.485708
0.2304 --- loss: 0.993438, loss_ss: 0.655626, loss_d: 0.337812
0.2688 --- loss: 0.555539, loss_ss: 0.508012, loss_d: 0.047527
0.3072 --- loss: 0.943861, loss_ss: 0.821463, loss_d: 0.122398
0.3456 --- loss: 0.838944, loss_ss: 0.718851, loss_d: 0.120093
0.3840 --- loss: 0.665099, loss_ss: 0.616391, loss_d: 0.048708
0.4224 --- loss: 0.775654, loss_ss: 0.745886, loss_d: 0.029768
0.4608 --- loss: 0.994398, loss_ss: 0.718097, loss_d: 0.276301
0.4992 --- loss: 1.146532, loss_ss: 0.590592, loss_d: 0.555940
0.5376 --- loss: 0.990882, loss_ss: 0.503757, loss_d: 0.487125
0.5760 --- loss: 0.754739, loss_ss: 0.655318, loss_d: 0.099421
0.6144 --- loss: 0.860449, loss_ss: 0.665892, loss_d: 0.194557
0.6528 --- loss: 0.594390, loss_ss: 0.583120, loss_d: 0.011269
0.6912 --- loss: 0.894552, loss_ss: 0.844945, loss_d: 0.049607
0.7296 --- loss: 0.665555, loss_ss: 0.655599, loss_d: 0.009956
0.7680 --- loss: 0.638017, loss_ss: 0.617818, loss_d: 0.020199
0.8065 --- loss: 1.180891, loss_ss: 0.632439, loss_d: 0.548452
0.8449 --- loss: 1.200816, loss_ss: 1.162833, loss_d: 0.037983
0.8833 --- loss: 0.820336, loss_ss: 0.615255, loss_d: 0.205081
0.9217 --- loss: 0.722486, loss_ss: 0.712085, loss_d: 0.010401
0.9601 --- loss: 0.873426, loss_ss: 0.844845, loss_d: 0.028581
0.9985 --- loss: 0.681266, loss_ss: 0.517373, loss_d: 0.163893
Epoch finished! Loss: 0.9198682700212185
Starting epoch 7/10.
0.0000 --- loss: 0.740574, loss_ss: 0.703571, loss_d: 0.037003
0.0384 --- loss: 0.822501, loss_ss: 0.725611, loss_d: 0.096890
0.0768 --- loss: 0.723767, loss_ss: 0.704140, loss_d: 0.019628
0.1152 --- loss: 0.870416, loss_ss: 0.758892, loss_d: 0.111524
0.1536 --- loss: 0.677086, loss_ss: 0.654145, loss_d: 0.022941
0.1920 --- loss: 0.665112, loss_ss: 0.663089, loss_d: 0.002022
0.2304 --- loss: 1.759828, loss_ss: 0.991662, loss_d: 0.768166
0.2688 --- loss: 1.778897, loss_ss: 0.615519, loss_d: 1.163378
0.3072 --- loss: 0.765560, loss_ss: 0.751942, loss_d: 0.013618
0.3456 --- loss: 0.808107, loss_ss: 0.699719, loss_d: 0.108388
0.3840 --- loss: 0.903203, loss_ss: 0.856461, loss_d: 0.046741
0.4224 --- loss: 1.138686, loss_ss: 0.749081, loss_d: 0.389606
0.4608 --- loss: 1.529694, loss_ss: 0.746755, loss_d: 0.782939
0.4992 --- loss: 0.908376, loss_ss: 0.669903, loss_d: 0.238473
0.5376 --- loss: 0.873791, loss_ss: 0.844636, loss_d: 0.029155
0.5760 --- loss: 0.885104, loss_ss: 0.804988, loss_d: 0.080116
0.6144 --- loss: 0.755626, loss_ss: 0.735488, loss_d: 0.020138
0.6528 --- loss: 0.854974, loss_ss: 0.828638, loss_d: 0.026337
0.6912 --- loss: 0.753464, loss_ss: 0.727539, loss_d: 0.025925
0.7296 --- loss: 0.789008, loss_ss: 0.677186, loss_d: 0.111823
0.7680 --- loss: 0.944576, loss_ss: 0.891824, loss_d: 0.052752
0.8065 --- loss: 0.638111, loss_ss: 0.617706, loss_d: 0.020405
0.8449 --- loss: 0.825812, loss_ss: 0.802136, loss_d: 0.023676
0.8833 --- loss: 0.720960, loss_ss: 0.679337, loss_d: 0.041623
0.9217 --- loss: 0.591386, loss_ss: 0.576134, loss_d: 0.015252
0.9601 --- loss: 0.858532, loss_ss: 0.820032, loss_d: 0.038500
0.9985 --- loss: 0.937678, loss_ss: 0.722930, loss_d: 0.214748
Epoch finished! Loss: 0.8968052811347521
Starting epoch 8/10.
0.0000 --- loss: 0.856187, loss_ss: 0.850247, loss_d: 0.005940
0.0384 --- loss: 0.810580, loss_ss: 0.678057, loss_d: 0.132523
0.0768 --- loss: 0.871252, loss_ss: 0.656235, loss_d: 0.215016
0.1152 --- loss: 0.651084, loss_ss: 0.601208, loss_d: 0.049876
0.1536 --- loss: 1.681494, loss_ss: 0.863283, loss_d: 0.818212
0.1920 --- loss: 0.534324, loss_ss: 0.417774, loss_d: 0.116549
0.2304 --- loss: 0.633572, loss_ss: 0.566989, loss_d: 0.066583
0.2688 --- loss: 0.842914, loss_ss: 0.779515, loss_d: 0.063398
0.3072 --- loss: 0.964726, loss_ss: 0.760499, loss_d: 0.204227
0.3456 --- loss: 0.686793, loss_ss: 0.654070, loss_d: 0.032723
0.3840 --- loss: 0.715219, loss_ss: 0.687595, loss_d: 0.027624
0.4224 --- loss: 1.005511, loss_ss: 0.800649, loss_d: 0.204863
0.4608 --- loss: 0.825443, loss_ss: 0.794270, loss_d: 0.031173
0.4992 --- loss: 1.102808, loss_ss: 1.092797, loss_d: 0.010011
0.5376 --- loss: 0.728461, loss_ss: 0.724146, loss_d: 0.004315
0.5760 --- loss: 0.643603, loss_ss: 0.578319, loss_d: 0.065285
0.6144 --- loss: 0.888187, loss_ss: 0.694090, loss_d: 0.194097
0.6528 --- loss: 0.624667, loss_ss: 0.619130, loss_d: 0.005537
0.6912 --- loss: 0.570682, loss_ss: 0.505853, loss_d: 0.064829
0.7296 --- loss: 0.666827, loss_ss: 0.661279, loss_d: 0.005548
0.7680 --- loss: 0.954890, loss_ss: 0.953362, loss_d: 0.001529
0.8065 --- loss: 0.933952, loss_ss: 0.752048, loss_d: 0.181904
0.8449 --- loss: 0.506903, loss_ss: 0.503556, loss_d: 0.003347
0.8833 --- loss: 0.947086, loss_ss: 0.933419, loss_d: 0.013666
0.9217 --- loss: 0.622958, loss_ss: 0.616512, loss_d: 0.006446
0.9601 --- loss: 1.084042, loss_ss: 0.618472, loss_d: 0.465570
0.9985 --- loss: 0.667723, loss_ss: 0.625104, loss_d: 0.042620
Epoch finished! Loss: 0.863053109898017
Starting epoch 9/10.
0.0000 --- loss: 1.353940, loss_ss: 0.753085, loss_d: 0.600855
0.0384 --- loss: 0.818580, loss_ss: 0.770030, loss_d: 0.048549
0.0768 --- loss: 1.398695, loss_ss: 0.620169, loss_d: 0.778526
0.1152 --- loss: 0.852441, loss_ss: 0.828580, loss_d: 0.023861
0.1536 --- loss: 0.728175, loss_ss: 0.655732, loss_d: 0.072444
0.1920 --- loss: 0.675173, loss_ss: 0.651005, loss_d: 0.024167
0.2304 --- loss: 0.617258, loss_ss: 0.392547, loss_d: 0.224712
0.2688 --- loss: 0.766486, loss_ss: 0.743311, loss_d: 0.023175
0.3072 --- loss: 0.810010, loss_ss: 0.779584, loss_d: 0.030426
0.3456 --- loss: 0.838934, loss_ss: 0.715072, loss_d: 0.123862
0.3840 --- loss: 0.676529, loss_ss: 0.491820, loss_d: 0.184709
0.4224 --- loss: 1.148468, loss_ss: 0.776820, loss_d: 0.371648
0.4608 --- loss: 0.692732, loss_ss: 0.629021, loss_d: 0.063711
0.4992 --- loss: 0.812253, loss_ss: 0.761460, loss_d: 0.050793
0.5376 --- loss: 1.226785, loss_ss: 1.151616, loss_d: 0.075170
0.5760 --- loss: 0.993512, loss_ss: 0.972385, loss_d: 0.021127
0.6144 --- loss: 0.557034, loss_ss: 0.529996, loss_d: 0.027038
0.6528 --- loss: 0.803973, loss_ss: 0.795548, loss_d: 0.008426
0.6912 --- loss: 0.848585, loss_ss: 0.807567, loss_d: 0.041019
0.7296 --- loss: 1.325878, loss_ss: 1.191549, loss_d: 0.134329
0.7680 --- loss: 0.776357, loss_ss: 0.773577, loss_d: 0.002781
0.8065 --- loss: 0.773634, loss_ss: 0.769331, loss_d: 0.004303
0.8449 --- loss: 0.558406, loss_ss: 0.543388, loss_d: 0.015018
0.8833 --- loss: 0.805520, loss_ss: 0.795670, loss_d: 0.009850
0.9217 --- loss: 0.842971, loss_ss: 0.817268, loss_d: 0.025703
0.9601 --- loss: 0.607722, loss_ss: 0.584779, loss_d: 0.022943
0.9985 --- loss: 0.972825, loss_ss: 0.965874, loss_d: 0.006952
Epoch finished! Loss: 0.8341897897995435
Starting epoch 10/10.
0.0000 --- loss: 0.818638, loss_ss: 0.816831, loss_d: 0.001807
0.0384 --- loss: 0.632360, loss_ss: 0.612255, loss_d: 0.020105
0.0768 --- loss: 0.817838, loss_ss: 0.664872, loss_d: 0.152966
0.1152 --- loss: 0.911029, loss_ss: 0.894218, loss_d: 0.016811
0.1536 --- loss: 0.692488, loss_ss: 0.684224, loss_d: 0.008264
0.1920 --- loss: 0.775422, loss_ss: 0.770393, loss_d: 0.005029
0.2304 --- loss: 0.908935, loss_ss: 0.888071, loss_d: 0.020864
0.2688 --- loss: 0.493995, loss_ss: 0.489999, loss_d: 0.003996
0.3072 --- loss: 1.156387, loss_ss: 0.827001, loss_d: 0.329386
0.3456 --- loss: 1.129633, loss_ss: 0.773753, loss_d: 0.355880
0.3840 --- loss: 0.943705, loss_ss: 0.799926, loss_d: 0.143779
0.4224 --- loss: 0.935934, loss_ss: 0.760065, loss_d: 0.175868
0.4608 --- loss: 0.714671, loss_ss: 0.686878, loss_d: 0.027793
0.4992 --- loss: 0.869193, loss_ss: 0.831541, loss_d: 0.037652
0.5376 --- loss: 0.499348, loss_ss: 0.495164, loss_d: 0.004184
0.5760 --- loss: 0.391818, loss_ss: 0.370194, loss_d: 0.021624
0.6144 --- loss: 0.781653, loss_ss: 0.774837, loss_d: 0.006816
0.6528 --- loss: 0.801484, loss_ss: 0.757753, loss_d: 0.043731
0.6912 --- loss: 1.313031, loss_ss: 1.309315, loss_d: 0.003716
0.7296 --- loss: 0.810433, loss_ss: 0.809228, loss_d: 0.001205
0.7680 --- loss: 0.988360, loss_ss: 0.977415, loss_d: 0.010944
0.8065 --- loss: 0.670661, loss_ss: 0.667858, loss_d: 0.002803
0.8449 --- loss: 0.845577, loss_ss: 0.610207, loss_d: 0.235369
0.8833 --- loss: 1.152982, loss_ss: 1.114594, loss_d: 0.038388
0.9217 --- loss: 1.460133, loss_ss: 0.836775, loss_d: 0.623359
0.9601 --- loss: 0.893010, loss_ss: 0.761400, loss_d: 0.131610
0.9985 --- loss: 0.853406, loss_ss: 0.844262, loss_d: 0.009144
Epoch finished! Loss: 0.7890184785311039
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6911764705882353
             precision    recall  f1-score   support

        0.0       0.50      0.82      0.63        62
        1.0       0.52      0.20      0.29       178
        2.0       0.70      0.94      0.80       437
        3.0       0.76      0.95      0.85       102
        4.0       0.81      0.46      0.59       241

avg / total       0.69      0.69      0.66      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.02  82.26   94.78  50.50     62.58
1  82.84  19.66   96.20  52.24     28.57
2  80.10  93.82   69.81  69.97     80.16
3  96.57  95.10   96.73  76.38     84.72
4  84.71  46.47   96.53  80.58     58.95
Total accuracy: 69.12%
Average sen: 67.46%
Average spec: 90.81%
Macro f1-score: 62.99%
Diagnosis acc on 15mins: 1.0
[0.99997306 0.99999774 0.99999654 0.99999881 0.99969935 0.99999201
 0.99990761 0.99999464 0.99998105 0.99995792 0.99999893 0.99999368
 0.99999952 0.9999882  0.9999975  0.99942625 0.999892   0.99999535
 0.99998641 0.9999994  0.99999392 0.99999106 0.99999952 0.99996817
 0.99857926 0.99971765 0.9999938  0.99999845 0.99999964 0.99999392
 0.99999464 0.99999821 0.99999869 0.99999833]
pred: 0.9999118009034325, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.313363, loss_ss: 1.640714, loss_d: 0.672648
0.0384 --- loss: 2.128471, loss_ss: 1.546652, loss_d: 0.581819
0.0769 --- loss: 2.071166, loss_ss: 1.541711, loss_d: 0.529455
0.1153 --- loss: 1.992876, loss_ss: 1.456665, loss_d: 0.536210
0.1538 --- loss: 2.162870, loss_ss: 1.317937, loss_d: 0.844933
0.1922 --- loss: 1.824373, loss_ss: 1.351716, loss_d: 0.472657
0.2307 --- loss: 1.925023, loss_ss: 1.279694, loss_d: 0.645329
0.2691 --- loss: 2.200083, loss_ss: 1.342694, loss_d: 0.857388
0.3076 --- loss: 2.333758, loss_ss: 1.301922, loss_d: 1.031836
0.3460 --- loss: 1.981708, loss_ss: 1.289872, loss_d: 0.691836
0.3845 --- loss: 1.745760, loss_ss: 1.351364, loss_d: 0.394396
0.4229 --- loss: 1.861103, loss_ss: 1.184387, loss_d: 0.676717
0.4614 --- loss: 1.777589, loss_ss: 1.198731, loss_d: 0.578858
0.4998 --- loss: 1.742904, loss_ss: 1.215136, loss_d: 0.527768
0.5383 --- loss: 1.608452, loss_ss: 1.104586, loss_d: 0.503866
0.5767 --- loss: 1.966624, loss_ss: 1.307682, loss_d: 0.658942
0.6151 --- loss: 1.707067, loss_ss: 1.194909, loss_d: 0.512158
0.6536 --- loss: 1.887552, loss_ss: 1.147469, loss_d: 0.740083
0.6920 --- loss: 1.679797, loss_ss: 1.278247, loss_d: 0.401551
0.7305 --- loss: 1.346075, loss_ss: 1.074177, loss_d: 0.271898
0.7689 --- loss: 1.473987, loss_ss: 1.070156, loss_d: 0.403831
0.8074 --- loss: 1.826968, loss_ss: 1.158280, loss_d: 0.668687
0.8458 --- loss: 1.521562, loss_ss: 1.061141, loss_d: 0.460421
0.8843 --- loss: 1.666774, loss_ss: 1.165808, loss_d: 0.500966
0.9227 --- loss: 1.664238, loss_ss: 1.117890, loss_d: 0.546347
0.9612 --- loss: 1.567077, loss_ss: 1.280811, loss_d: 0.286266
0.9996 --- loss: 4.230840, loss_ss: 1.224557, loss_d: 3.006283
Epoch finished! Loss: 1.8453474902189695
Starting epoch 2/10.
0.0000 --- loss: 1.260003, loss_ss: 1.058399, loss_d: 0.201605
0.0384 --- loss: 1.516161, loss_ss: 1.226993, loss_d: 0.289168
0.0769 --- loss: 1.894695, loss_ss: 1.348594, loss_d: 0.546101
0.1153 --- loss: 1.116833, loss_ss: 0.949632, loss_d: 0.167201
0.1538 --- loss: 1.368736, loss_ss: 1.152158, loss_d: 0.216578
0.1922 --- loss: 1.827079, loss_ss: 1.312084, loss_d: 0.514995
0.2307 --- loss: 1.618137, loss_ss: 1.169019, loss_d: 0.449118
0.2691 --- loss: 1.200620, loss_ss: 1.055710, loss_d: 0.144910
0.3076 --- loss: 1.365092, loss_ss: 1.002717, loss_d: 0.362375
0.3460 --- loss: 1.555617, loss_ss: 1.121913, loss_d: 0.433704
0.3845 --- loss: 1.811130, loss_ss: 0.937108, loss_d: 0.874022
0.4229 --- loss: 1.224310, loss_ss: 1.016387, loss_d: 0.207922
0.4614 --- loss: 1.295161, loss_ss: 0.951554, loss_d: 0.343608
0.4998 --- loss: 2.049137, loss_ss: 0.925587, loss_d: 1.123549
0.5383 --- loss: 1.615038, loss_ss: 1.166581, loss_d: 0.448457
0.5767 --- loss: 1.392511, loss_ss: 0.939336, loss_d: 0.453175
0.6151 --- loss: 1.149158, loss_ss: 0.898377, loss_d: 0.250781
0.6536 --- loss: 1.215616, loss_ss: 1.084580, loss_d: 0.131036
0.6920 --- loss: 1.252401, loss_ss: 0.897561, loss_d: 0.354841
0.7305 --- loss: 1.919300, loss_ss: 0.899186, loss_d: 1.020115
0.7689 --- loss: 1.030269, loss_ss: 0.771881, loss_d: 0.258388
0.8074 --- loss: 0.999936, loss_ss: 0.893684, loss_d: 0.106253
0.8458 --- loss: 1.288474, loss_ss: 0.831065, loss_d: 0.457409
0.8843 --- loss: 1.196553, loss_ss: 1.010928, loss_d: 0.185626
0.9227 --- loss: 1.136481, loss_ss: 0.980596, loss_d: 0.155885
0.9612 --- loss: 1.153244, loss_ss: 0.995595, loss_d: 0.157649
0.9996 --- loss: 1.121322, loss_ss: 1.059363, loss_d: 0.061960
Epoch finished! Loss: 1.3463683034364993
Starting epoch 3/10.
0.0000 --- loss: 1.275248, loss_ss: 0.738602, loss_d: 0.536646
0.0384 --- loss: 1.673278, loss_ss: 1.156731, loss_d: 0.516547
0.0769 --- loss: 1.146755, loss_ss: 0.916010, loss_d: 0.230746
0.1153 --- loss: 1.166050, loss_ss: 0.782672, loss_d: 0.383378
0.1538 --- loss: 1.319938, loss_ss: 0.815781, loss_d: 0.504157
0.1922 --- loss: 1.760198, loss_ss: 1.037600, loss_d: 0.722598
0.2307 --- loss: 0.937899, loss_ss: 0.829497, loss_d: 0.108401
0.2691 --- loss: 1.018640, loss_ss: 0.908980, loss_d: 0.109659
0.3076 --- loss: 1.078554, loss_ss: 0.918737, loss_d: 0.159817
0.3460 --- loss: 1.073515, loss_ss: 0.948155, loss_d: 0.125360
0.3845 --- loss: 1.096292, loss_ss: 0.931322, loss_d: 0.164969
0.4229 --- loss: 0.762023, loss_ss: 0.680098, loss_d: 0.081925
0.4614 --- loss: 1.156923, loss_ss: 1.011561, loss_d: 0.145362
0.4998 --- loss: 0.972564, loss_ss: 0.734997, loss_d: 0.237567
0.5383 --- loss: 1.149051, loss_ss: 0.996522, loss_d: 0.152529
0.5767 --- loss: 0.957125, loss_ss: 0.793513, loss_d: 0.163612
0.6151 --- loss: 0.842067, loss_ss: 0.727701, loss_d: 0.114366
0.6536 --- loss: 0.853571, loss_ss: 0.616813, loss_d: 0.236758
0.6920 --- loss: 1.373893, loss_ss: 1.137199, loss_d: 0.236695
0.7305 --- loss: 1.157383, loss_ss: 0.911465, loss_d: 0.245917
0.7689 --- loss: 0.817030, loss_ss: 0.669810, loss_d: 0.147220
0.8074 --- loss: 1.139929, loss_ss: 0.908120, loss_d: 0.231809
0.8458 --- loss: 1.110561, loss_ss: 0.980147, loss_d: 0.130414
0.8843 --- loss: 1.232418, loss_ss: 1.089941, loss_d: 0.142477
0.9227 --- loss: 0.959427, loss_ss: 0.850666, loss_d: 0.108761
0.9612 --- loss: 0.989926, loss_ss: 0.952221, loss_d: 0.037706
0.9996 --- loss: 3.153102, loss_ss: 3.005434, loss_d: 0.147668
Epoch finished! Loss: 1.1906093452985471
Starting epoch 4/10.
0.0000 --- loss: 0.950637, loss_ss: 0.731157, loss_d: 0.219479
0.0384 --- loss: 0.979031, loss_ss: 0.788239, loss_d: 0.190792
0.0769 --- loss: 1.028194, loss_ss: 0.672837, loss_d: 0.355358
0.1153 --- loss: 1.199031, loss_ss: 1.057185, loss_d: 0.141846
0.1538 --- loss: 1.172830, loss_ss: 0.840726, loss_d: 0.332103
0.1922 --- loss: 1.414468, loss_ss: 0.972825, loss_d: 0.441643
0.2307 --- loss: 0.993165, loss_ss: 0.883639, loss_d: 0.109526
0.2691 --- loss: 1.108122, loss_ss: 0.794360, loss_d: 0.313762
0.3076 --- loss: 1.116214, loss_ss: 0.849130, loss_d: 0.267083
0.3460 --- loss: 0.917248, loss_ss: 0.871794, loss_d: 0.045453
0.3845 --- loss: 1.044030, loss_ss: 0.816793, loss_d: 0.227237
0.4229 --- loss: 1.417553, loss_ss: 0.925714, loss_d: 0.491839
0.4614 --- loss: 0.972470, loss_ss: 0.749501, loss_d: 0.222969
0.4998 --- loss: 0.978970, loss_ss: 0.797582, loss_d: 0.181388
0.5383 --- loss: 0.881505, loss_ss: 0.825339, loss_d: 0.056166
0.5767 --- loss: 1.045865, loss_ss: 0.953470, loss_d: 0.092395
0.6151 --- loss: 0.822893, loss_ss: 0.769122, loss_d: 0.053771
0.6536 --- loss: 1.128584, loss_ss: 0.841198, loss_d: 0.287386
0.6920 --- loss: 1.064537, loss_ss: 0.846777, loss_d: 0.217761
0.7305 --- loss: 1.236858, loss_ss: 0.849829, loss_d: 0.387028
0.7689 --- loss: 1.006673, loss_ss: 0.956681, loss_d: 0.049991
0.8074 --- loss: 1.184074, loss_ss: 0.984756, loss_d: 0.199318
0.8458 --- loss: 1.033249, loss_ss: 0.964002, loss_d: 0.069248
0.8843 --- loss: 1.459483, loss_ss: 1.158367, loss_d: 0.301116
0.9227 --- loss: 1.132123, loss_ss: 0.780411, loss_d: 0.351713
0.9612 --- loss: 1.060544, loss_ss: 0.782252, loss_d: 0.278292
0.9996 --- loss: 2.014930, loss_ss: 1.875385, loss_d: 0.139544
Epoch finished! Loss: 1.0941306930321915
Starting epoch 5/10.
0.0000 --- loss: 1.127492, loss_ss: 0.846411, loss_d: 0.281081
0.0384 --- loss: 0.789608, loss_ss: 0.711100, loss_d: 0.078508
0.0769 --- loss: 1.092484, loss_ss: 0.729972, loss_d: 0.362512
0.1153 --- loss: 0.989993, loss_ss: 0.923621, loss_d: 0.066372
0.1538 --- loss: 0.801874, loss_ss: 0.780302, loss_d: 0.021571
0.1922 --- loss: 0.847637, loss_ss: 0.752623, loss_d: 0.095014
0.2307 --- loss: 0.919199, loss_ss: 0.890173, loss_d: 0.029026
0.2691 --- loss: 0.723232, loss_ss: 0.686135, loss_d: 0.037097
0.3076 --- loss: 1.797189, loss_ss: 0.790984, loss_d: 1.006204
0.3460 --- loss: 0.729612, loss_ss: 0.654744, loss_d: 0.074869
0.3845 --- loss: 0.827060, loss_ss: 0.791671, loss_d: 0.035389
0.4229 --- loss: 1.260756, loss_ss: 0.932010, loss_d: 0.328746
0.4614 --- loss: 1.010374, loss_ss: 0.851084, loss_d: 0.159291
0.4998 --- loss: 0.666973, loss_ss: 0.588235, loss_d: 0.078738
0.5383 --- loss: 1.072911, loss_ss: 0.770497, loss_d: 0.302413
0.5767 --- loss: 1.122664, loss_ss: 0.955736, loss_d: 0.166928
0.6151 --- loss: 1.023198, loss_ss: 0.864906, loss_d: 0.158292
0.6536 --- loss: 0.783513, loss_ss: 0.606801, loss_d: 0.176712
0.6920 --- loss: 1.140341, loss_ss: 1.058607, loss_d: 0.081734
0.7305 --- loss: 0.841569, loss_ss: 0.793589, loss_d: 0.047980
0.7689 --- loss: 1.383644, loss_ss: 1.347937, loss_d: 0.035707
0.8074 --- loss: 0.856685, loss_ss: 0.806074, loss_d: 0.050611
0.8458 --- loss: 0.913200, loss_ss: 0.847378, loss_d: 0.065822
0.8843 --- loss: 1.482892, loss_ss: 1.357587, loss_d: 0.125305
0.9227 --- loss: 1.006475, loss_ss: 0.803495, loss_d: 0.202980
0.9612 --- loss: 1.299499, loss_ss: 0.677770, loss_d: 0.621728
0.9996 --- loss: 2.747111, loss_ss: 2.734730, loss_d: 0.012382
Epoch finished! Loss: 1.0093607052014424
Starting epoch 6/10.
0.0000 --- loss: 0.907697, loss_ss: 0.543015, loss_d: 0.364681
0.0384 --- loss: 0.722217, loss_ss: 0.575361, loss_d: 0.146856
0.0769 --- loss: 0.578988, loss_ss: 0.523179, loss_d: 0.055809
0.1153 --- loss: 1.184737, loss_ss: 1.052965, loss_d: 0.131772
0.1538 --- loss: 0.814250, loss_ss: 0.785594, loss_d: 0.028655
0.1922 --- loss: 0.974367, loss_ss: 0.809334, loss_d: 0.165033
0.2307 --- loss: 0.917471, loss_ss: 0.747303, loss_d: 0.170168
0.2691 --- loss: 1.127827, loss_ss: 0.750149, loss_d: 0.377678
0.3076 --- loss: 1.145833, loss_ss: 1.118159, loss_d: 0.027674
0.3460 --- loss: 0.875569, loss_ss: 0.744232, loss_d: 0.131337
0.3845 --- loss: 0.887119, loss_ss: 0.841441, loss_d: 0.045678
0.4229 --- loss: 1.032694, loss_ss: 0.806348, loss_d: 0.226345
0.4614 --- loss: 0.595916, loss_ss: 0.529122, loss_d: 0.066794
0.4998 --- loss: 0.792881, loss_ss: 0.628032, loss_d: 0.164850
0.5383 --- loss: 0.928767, loss_ss: 0.568437, loss_d: 0.360330
0.5767 --- loss: 1.390887, loss_ss: 1.366650, loss_d: 0.024237
0.6151 --- loss: 0.953278, loss_ss: 0.827767, loss_d: 0.125511
0.6536 --- loss: 0.823383, loss_ss: 0.686162, loss_d: 0.137222
0.6920 --- loss: 0.868276, loss_ss: 0.666110, loss_d: 0.202166
0.7305 --- loss: 1.045440, loss_ss: 1.008799, loss_d: 0.036642
0.7689 --- loss: 0.951626, loss_ss: 0.902932, loss_d: 0.048694
0.8074 --- loss: 0.669590, loss_ss: 0.628389, loss_d: 0.041200
0.8458 --- loss: 0.808199, loss_ss: 0.695904, loss_d: 0.112295
0.8843 --- loss: 1.053905, loss_ss: 0.684280, loss_d: 0.369625
0.9227 --- loss: 0.761802, loss_ss: 0.701724, loss_d: 0.060078
0.9612 --- loss: 0.909036, loss_ss: 0.857354, loss_d: 0.051682
0.9996 --- loss: 2.620015, loss_ss: 2.525232, loss_d: 0.094783
Epoch finished! Loss: 0.9537699708571801
Starting epoch 7/10.
0.0000 --- loss: 0.919171, loss_ss: 0.862104, loss_d: 0.057067
0.0384 --- loss: 0.706647, loss_ss: 0.692438, loss_d: 0.014210
0.0769 --- loss: 0.800807, loss_ss: 0.770419, loss_d: 0.030388
0.1153 --- loss: 0.787736, loss_ss: 0.695309, loss_d: 0.092428
0.1538 --- loss: 1.134640, loss_ss: 0.640640, loss_d: 0.494000
0.1922 --- loss: 1.110502, loss_ss: 1.033029, loss_d: 0.077472
0.2307 --- loss: 1.052005, loss_ss: 0.617120, loss_d: 0.434885
0.2691 --- loss: 0.681778, loss_ss: 0.614350, loss_d: 0.067428
0.3076 --- loss: 0.837888, loss_ss: 0.763830, loss_d: 0.074058
0.3460 --- loss: 0.938135, loss_ss: 0.897114, loss_d: 0.041021
0.3845 --- loss: 0.990914, loss_ss: 0.733962, loss_d: 0.256952
0.4229 --- loss: 0.622347, loss_ss: 0.527003, loss_d: 0.095344
0.4614 --- loss: 0.955919, loss_ss: 0.953312, loss_d: 0.002607
0.4998 --- loss: 0.729954, loss_ss: 0.727452, loss_d: 0.002502
0.5383 --- loss: 1.739886, loss_ss: 1.367728, loss_d: 0.372158
0.5767 --- loss: 0.897383, loss_ss: 0.881070, loss_d: 0.016312
0.6151 --- loss: 0.622112, loss_ss: 0.610220, loss_d: 0.011892
0.6536 --- loss: 0.782863, loss_ss: 0.741051, loss_d: 0.041811
0.6920 --- loss: 0.555950, loss_ss: 0.530356, loss_d: 0.025594
0.7305 --- loss: 0.898471, loss_ss: 0.752990, loss_d: 0.145481
0.7689 --- loss: 0.891194, loss_ss: 0.828093, loss_d: 0.063101
0.8074 --- loss: 0.839860, loss_ss: 0.683201, loss_d: 0.156660
0.8458 --- loss: 0.783425, loss_ss: 0.702378, loss_d: 0.081047
0.8843 --- loss: 0.701235, loss_ss: 0.671981, loss_d: 0.029254
0.9227 --- loss: 0.685268, loss_ss: 0.618992, loss_d: 0.066276
0.9612 --- loss: 0.923406, loss_ss: 0.819051, loss_d: 0.104355
0.9996 --- loss: 7.078293, loss_ss: 2.877876, loss_d: 4.200418
Epoch finished! Loss: 0.9462096899747848
Starting epoch 8/10.
0.0000 --- loss: 1.035342, loss_ss: 0.985063, loss_d: 0.050279
0.0384 --- loss: 0.871640, loss_ss: 0.638379, loss_d: 0.233261
0.0769 --- loss: 0.997108, loss_ss: 0.838678, loss_d: 0.158429
0.1153 --- loss: 0.802104, loss_ss: 0.745651, loss_d: 0.056453
0.1538 --- loss: 1.013702, loss_ss: 0.941472, loss_d: 0.072230
0.1922 --- loss: 1.271942, loss_ss: 0.666254, loss_d: 0.605688
0.2307 --- loss: 0.831104, loss_ss: 0.802598, loss_d: 0.028507
0.2691 --- loss: 0.833710, loss_ss: 0.744674, loss_d: 0.089036
0.3076 --- loss: 1.066579, loss_ss: 0.939198, loss_d: 0.127381
0.3460 --- loss: 0.846351, loss_ss: 0.735647, loss_d: 0.110704
0.3845 --- loss: 0.929477, loss_ss: 0.798785, loss_d: 0.130692
0.4229 --- loss: 0.910336, loss_ss: 0.581088, loss_d: 0.329248
0.4614 --- loss: 0.785122, loss_ss: 0.752703, loss_d: 0.032419
0.4998 --- loss: 0.587976, loss_ss: 0.501238, loss_d: 0.086738
0.5383 --- loss: 0.934814, loss_ss: 0.930085, loss_d: 0.004729
0.5767 --- loss: 0.723966, loss_ss: 0.543466, loss_d: 0.180500
0.6151 --- loss: 0.891403, loss_ss: 0.869260, loss_d: 0.022143
0.6536 --- loss: 0.616725, loss_ss: 0.556064, loss_d: 0.060662
0.6920 --- loss: 0.863314, loss_ss: 0.845443, loss_d: 0.017871
0.7305 --- loss: 0.638749, loss_ss: 0.628685, loss_d: 0.010064
0.7689 --- loss: 1.013708, loss_ss: 1.001890, loss_d: 0.011818
0.8074 --- loss: 0.740300, loss_ss: 0.698178, loss_d: 0.042121
0.8458 --- loss: 1.071143, loss_ss: 1.040886, loss_d: 0.030256
0.8843 --- loss: 0.696778, loss_ss: 0.669818, loss_d: 0.026960
0.9227 --- loss: 0.681268, loss_ss: 0.673479, loss_d: 0.007788
0.9612 --- loss: 1.122518, loss_ss: 1.100887, loss_d: 0.021631
0.9996 --- loss: 5.190805, loss_ss: 1.164528, loss_d: 4.026277
Epoch finished! Loss: 0.9184847500461798
Starting epoch 9/10.
0.0000 --- loss: 0.703342, loss_ss: 0.487336, loss_d: 0.216006
0.0384 --- loss: 1.066305, loss_ss: 0.864968, loss_d: 0.201337
0.0769 --- loss: 1.373239, loss_ss: 1.028868, loss_d: 0.344370
0.1153 --- loss: 0.950735, loss_ss: 0.907123, loss_d: 0.043612
0.1538 --- loss: 1.296798, loss_ss: 1.233007, loss_d: 0.063791
0.1922 --- loss: 0.864423, loss_ss: 0.541273, loss_d: 0.323149
0.2307 --- loss: 1.067338, loss_ss: 0.953128, loss_d: 0.114211
0.2691 --- loss: 0.858434, loss_ss: 0.746197, loss_d: 0.112237
0.3076 --- loss: 1.380182, loss_ss: 0.942559, loss_d: 0.437622
0.3460 --- loss: 0.609758, loss_ss: 0.559779, loss_d: 0.049979
0.3845 --- loss: 0.857823, loss_ss: 0.783971, loss_d: 0.073852
0.4229 --- loss: 0.847697, loss_ss: 0.813230, loss_d: 0.034467
0.4614 --- loss: 1.248324, loss_ss: 0.937463, loss_d: 0.310860
0.4998 --- loss: 0.665401, loss_ss: 0.637863, loss_d: 0.027538
0.5383 --- loss: 0.784519, loss_ss: 0.546645, loss_d: 0.237875
0.5767 --- loss: 0.778148, loss_ss: 0.663876, loss_d: 0.114272
0.6151 --- loss: 1.401922, loss_ss: 0.685636, loss_d: 0.716287
0.6536 --- loss: 0.859105, loss_ss: 0.790422, loss_d: 0.068682
0.6920 --- loss: 0.676584, loss_ss: 0.655249, loss_d: 0.021335
0.7305 --- loss: 0.694740, loss_ss: 0.675715, loss_d: 0.019026
0.7689 --- loss: 0.683075, loss_ss: 0.658157, loss_d: 0.024918
0.8074 --- loss: 0.972252, loss_ss: 0.617742, loss_d: 0.354510
0.8458 --- loss: 0.699455, loss_ss: 0.682669, loss_d: 0.016785
0.8843 --- loss: 0.712594, loss_ss: 0.704061, loss_d: 0.008533
0.9227 --- loss: 0.807734, loss_ss: 0.715592, loss_d: 0.092142
0.9612 --- loss: 0.770958, loss_ss: 0.761200, loss_d: 0.009758
0.9996 --- loss: 1.231004, loss_ss: 1.229426, loss_d: 0.001579
Epoch finished! Loss: 0.874143877854714
Starting epoch 10/10.
0.0000 --- loss: 0.714171, loss_ss: 0.697038, loss_d: 0.017133
0.0384 --- loss: 0.621378, loss_ss: 0.617335, loss_d: 0.004042
0.0769 --- loss: 0.764297, loss_ss: 0.692447, loss_d: 0.071850
0.1153 --- loss: 0.628491, loss_ss: 0.587861, loss_d: 0.040630
0.1538 --- loss: 1.581602, loss_ss: 0.784501, loss_d: 0.797101
0.1922 --- loss: 0.741804, loss_ss: 0.722873, loss_d: 0.018931
0.2307 --- loss: 0.924943, loss_ss: 0.542134, loss_d: 0.382809
0.2691 --- loss: 0.815272, loss_ss: 0.512730, loss_d: 0.302542
0.3076 --- loss: 0.633772, loss_ss: 0.630268, loss_d: 0.003504
0.3460 --- loss: 0.657332, loss_ss: 0.646242, loss_d: 0.011090
0.3845 --- loss: 0.992054, loss_ss: 0.743337, loss_d: 0.248717
0.4229 --- loss: 0.714819, loss_ss: 0.625438, loss_d: 0.089381
0.4614 --- loss: 0.779157, loss_ss: 0.748041, loss_d: 0.031116
0.4998 --- loss: 0.638439, loss_ss: 0.620998, loss_d: 0.017441
0.5383 --- loss: 0.757054, loss_ss: 0.752352, loss_d: 0.004702
0.5767 --- loss: 0.818764, loss_ss: 0.803877, loss_d: 0.014887
0.6151 --- loss: 1.101091, loss_ss: 0.920685, loss_d: 0.180407
0.6536 --- loss: 0.678773, loss_ss: 0.660791, loss_d: 0.017982
0.6920 --- loss: 0.929730, loss_ss: 0.775475, loss_d: 0.154255
0.7305 --- loss: 0.862981, loss_ss: 0.825792, loss_d: 0.037189
0.7689 --- loss: 0.980983, loss_ss: 0.949803, loss_d: 0.031179
0.8074 --- loss: 1.126428, loss_ss: 1.028024, loss_d: 0.098404
0.8458 --- loss: 1.025368, loss_ss: 0.843131, loss_d: 0.182237
0.8843 --- loss: 0.566922, loss_ss: 0.557813, loss_d: 0.009109
0.9227 --- loss: 0.771409, loss_ss: 0.741384, loss_d: 0.030025
0.9612 --- loss: 0.435371, loss_ss: 0.427438, loss_d: 0.007933
0.9996 --- loss: 1.640223, loss_ss: 1.639632, loss_d: 0.000591
Epoch finished! Loss: 0.8133863380322089
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.618018018018018
             precision    recall  f1-score   support

        0.0       0.14      0.89      0.24        19
        1.0       0.53      0.78      0.63       355
        2.0       0.77      0.57      0.66       376
        3.0       0.96      0.85      0.90       199
        4.0       0.67      0.05      0.09       161

avg / total       0.70      0.62      0.60      1110
 


====== chp039-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.36  89.47   90.38  13.93     24.11
1  70.90  77.75   67.68  53.08     63.09
2  79.82  57.18   91.42  77.34     65.75
3  96.67  85.43   99.12  95.51     90.19
4  85.86   4.97   99.58  66.67      9.25
Total accuracy: 61.80%
Average sen: 62.96%
Average spec: 89.64%
Macro f1-score: 50.48%
Diagnosis acc on 15mins: 1.0
[1.         1.         1.         0.9999994  1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         0.99999976 0.99999964
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ]
pred: 0.9999999677812731, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.472008, loss_ss: 1.757098, loss_d: 0.714910
0.0384 --- loss: 2.269463, loss_ss: 1.569376, loss_d: 0.700087
0.0768 --- loss: 2.087458, loss_ss: 1.497583, loss_d: 0.589875
0.1153 --- loss: 2.090924, loss_ss: 1.515822, loss_d: 0.575102
0.1537 --- loss: 2.132493, loss_ss: 1.378208, loss_d: 0.754285
0.1921 --- loss: 2.019419, loss_ss: 1.438145, loss_d: 0.581274
0.2305 --- loss: 1.840602, loss_ss: 1.297242, loss_d: 0.543360
0.2689 --- loss: 2.038019, loss_ss: 1.478543, loss_d: 0.559476
0.3073 --- loss: 2.016473, loss_ss: 1.408739, loss_d: 0.607734
0.3458 --- loss: 1.703169, loss_ss: 1.351509, loss_d: 0.351660
0.3842 --- loss: 1.938860, loss_ss: 1.423746, loss_d: 0.515114
0.4226 --- loss: 1.748335, loss_ss: 1.330293, loss_d: 0.418042
0.4610 --- loss: 1.748656, loss_ss: 1.335327, loss_d: 0.413329
0.4994 --- loss: 1.742293, loss_ss: 1.263623, loss_d: 0.478670
0.5378 --- loss: 1.853507, loss_ss: 1.280178, loss_d: 0.573329
0.5763 --- loss: 1.526422, loss_ss: 1.261856, loss_d: 0.264566
0.6147 --- loss: 1.774618, loss_ss: 1.359222, loss_d: 0.415395
0.6531 --- loss: 1.902048, loss_ss: 1.415391, loss_d: 0.486657
0.6915 --- loss: 1.920315, loss_ss: 1.326806, loss_d: 0.593509
0.7299 --- loss: 1.664245, loss_ss: 1.235603, loss_d: 0.428642
0.7683 --- loss: 2.055770, loss_ss: 1.217733, loss_d: 0.838038
0.8068 --- loss: 1.592415, loss_ss: 1.316491, loss_d: 0.275924
0.8452 --- loss: 1.334974, loss_ss: 1.147450, loss_d: 0.187523
0.8836 --- loss: 1.923646, loss_ss: 1.317933, loss_d: 0.605713
0.9220 --- loss: 1.574707, loss_ss: 1.366441, loss_d: 0.208266
0.9604 --- loss: 2.026159, loss_ss: 1.402430, loss_d: 0.623729
0.9988 --- loss: 1.962042, loss_ss: 1.473706, loss_d: 0.488336
Epoch finished! Loss: 1.8968649410284482
Starting epoch 2/10.
0.0000 --- loss: 1.797941, loss_ss: 1.198691, loss_d: 0.599250
0.0384 --- loss: 1.661237, loss_ss: 1.343967, loss_d: 0.317270
0.0768 --- loss: 1.300634, loss_ss: 1.095807, loss_d: 0.204828
0.1153 --- loss: 1.661409, loss_ss: 1.321670, loss_d: 0.339740
0.1537 --- loss: 1.594236, loss_ss: 1.191389, loss_d: 0.402847
0.1921 --- loss: 1.796174, loss_ss: 1.287546, loss_d: 0.508628
0.2305 --- loss: 1.334633, loss_ss: 1.066591, loss_d: 0.268042
0.2689 --- loss: 1.611306, loss_ss: 1.353504, loss_d: 0.257802
0.3073 --- loss: 1.675549, loss_ss: 1.183602, loss_d: 0.491946
0.3458 --- loss: 1.490419, loss_ss: 1.166157, loss_d: 0.324261
0.3842 --- loss: 1.379544, loss_ss: 1.149950, loss_d: 0.229594
0.4226 --- loss: 1.271926, loss_ss: 1.041994, loss_d: 0.229932
0.4610 --- loss: 1.536374, loss_ss: 1.200860, loss_d: 0.335515
0.4994 --- loss: 1.689793, loss_ss: 1.328361, loss_d: 0.361432
0.5378 --- loss: 1.404675, loss_ss: 1.163615, loss_d: 0.241060
0.5763 --- loss: 1.279889, loss_ss: 1.118905, loss_d: 0.160984
0.6147 --- loss: 1.645989, loss_ss: 1.008613, loss_d: 0.637376
0.6531 --- loss: 1.223017, loss_ss: 1.072358, loss_d: 0.150659
0.6915 --- loss: 1.195269, loss_ss: 1.075315, loss_d: 0.119954
0.7299 --- loss: 1.328156, loss_ss: 1.028142, loss_d: 0.300014
0.7683 --- loss: 1.210237, loss_ss: 1.021839, loss_d: 0.188398
0.8068 --- loss: 1.397526, loss_ss: 1.361996, loss_d: 0.035530
0.8452 --- loss: 1.378321, loss_ss: 0.976692, loss_d: 0.401629
0.8836 --- loss: 1.380463, loss_ss: 1.038267, loss_d: 0.342195
0.9220 --- loss: 1.253733, loss_ss: 1.126408, loss_d: 0.127324
0.9604 --- loss: 1.302201, loss_ss: 1.009216, loss_d: 0.292985
0.9988 --- loss: 1.120456, loss_ss: 0.800477, loss_d: 0.319979
Epoch finished! Loss: 1.4590923325373577
Starting epoch 3/10.
0.0000 --- loss: 1.501304, loss_ss: 1.193223, loss_d: 0.308081
0.0384 --- loss: 1.142137, loss_ss: 0.990773, loss_d: 0.151364
0.0768 --- loss: 1.006769, loss_ss: 0.957618, loss_d: 0.049151
0.1153 --- loss: 1.568363, loss_ss: 1.405561, loss_d: 0.162803
0.1537 --- loss: 1.181907, loss_ss: 0.964516, loss_d: 0.217391
0.1921 --- loss: 1.662944, loss_ss: 1.543568, loss_d: 0.119376
0.2305 --- loss: 1.712739, loss_ss: 1.212731, loss_d: 0.500008
0.2689 --- loss: 1.562650, loss_ss: 1.083542, loss_d: 0.479108
0.3073 --- loss: 1.439051, loss_ss: 1.242422, loss_d: 0.196629
0.3458 --- loss: 1.464200, loss_ss: 1.042719, loss_d: 0.421481
0.3842 --- loss: 1.040259, loss_ss: 0.945368, loss_d: 0.094891
0.4226 --- loss: 1.529491, loss_ss: 1.283165, loss_d: 0.246327
0.4610 --- loss: 0.944883, loss_ss: 0.802625, loss_d: 0.142258
0.4994 --- loss: 1.316582, loss_ss: 1.037060, loss_d: 0.279522
0.5378 --- loss: 0.984660, loss_ss: 0.940432, loss_d: 0.044228
0.5763 --- loss: 1.149000, loss_ss: 1.106980, loss_d: 0.042020
0.6147 --- loss: 2.072432, loss_ss: 1.280301, loss_d: 0.792131
0.6531 --- loss: 1.370393, loss_ss: 1.206898, loss_d: 0.163495
0.6915 --- loss: 1.252214, loss_ss: 0.941236, loss_d: 0.310979
0.7299 --- loss: 1.268739, loss_ss: 0.800192, loss_d: 0.468547
0.7683 --- loss: 1.151139, loss_ss: 0.703267, loss_d: 0.447872
0.8068 --- loss: 1.146882, loss_ss: 1.018341, loss_d: 0.128541
0.8452 --- loss: 0.953959, loss_ss: 0.783428, loss_d: 0.170532
0.8836 --- loss: 1.207432, loss_ss: 0.954244, loss_d: 0.253188
0.9220 --- loss: 1.287457, loss_ss: 1.057187, loss_d: 0.230270
0.9604 --- loss: 0.957304, loss_ss: 0.831516, loss_d: 0.125788
0.9988 --- loss: 1.849918, loss_ss: 0.923843, loss_d: 0.926074
Epoch finished! Loss: 1.2791613308282999
Starting epoch 4/10.
0.0000 --- loss: 0.813434, loss_ss: 0.764046, loss_d: 0.049388
0.0384 --- loss: 1.163613, loss_ss: 1.086835, loss_d: 0.076777
0.0768 --- loss: 0.918758, loss_ss: 0.851896, loss_d: 0.066863
0.1153 --- loss: 1.073485, loss_ss: 1.014737, loss_d: 0.058748
0.1537 --- loss: 1.386558, loss_ss: 1.297290, loss_d: 0.089268
0.1921 --- loss: 0.982749, loss_ss: 0.960137, loss_d: 0.022612
0.2305 --- loss: 1.365423, loss_ss: 1.018029, loss_d: 0.347394
0.2689 --- loss: 2.037282, loss_ss: 1.349640, loss_d: 0.687643
0.3073 --- loss: 0.971532, loss_ss: 0.793921, loss_d: 0.177611
0.3458 --- loss: 1.377658, loss_ss: 1.009541, loss_d: 0.368117
0.3842 --- loss: 1.048960, loss_ss: 0.982048, loss_d: 0.066912
0.4226 --- loss: 0.912598, loss_ss: 0.775018, loss_d: 0.137580
0.4610 --- loss: 0.879834, loss_ss: 0.840266, loss_d: 0.039568
0.4994 --- loss: 0.938166, loss_ss: 0.870729, loss_d: 0.067436
0.5378 --- loss: 1.535464, loss_ss: 1.011749, loss_d: 0.523715
0.5763 --- loss: 1.406622, loss_ss: 1.277916, loss_d: 0.128706
0.6147 --- loss: 1.450749, loss_ss: 0.734754, loss_d: 0.715995
0.6531 --- loss: 1.204630, loss_ss: 1.085187, loss_d: 0.119443
0.6915 --- loss: 1.138621, loss_ss: 1.038445, loss_d: 0.100176
0.7299 --- loss: 1.042546, loss_ss: 1.001128, loss_d: 0.041418
0.7683 --- loss: 1.146055, loss_ss: 0.861095, loss_d: 0.284960
0.8068 --- loss: 0.870544, loss_ss: 0.742412, loss_d: 0.128132
0.8452 --- loss: 0.978969, loss_ss: 0.746146, loss_d: 0.232823
0.8836 --- loss: 0.855477, loss_ss: 0.765421, loss_d: 0.090056
0.9220 --- loss: 1.029889, loss_ss: 1.005093, loss_d: 0.024796
0.9604 --- loss: 1.182350, loss_ss: 0.799123, loss_d: 0.383227
0.9988 --- loss: 1.281625, loss_ss: 1.274680, loss_d: 0.006945
Epoch finished! Loss: 1.1303483479298078
Starting epoch 5/10.
0.0000 --- loss: 1.718410, loss_ss: 0.819766, loss_d: 0.898644
0.0384 --- loss: 0.903106, loss_ss: 0.841388, loss_d: 0.061719
0.0768 --- loss: 1.371998, loss_ss: 1.186386, loss_d: 0.185612
0.1153 --- loss: 1.081436, loss_ss: 1.051386, loss_d: 0.030050
0.1537 --- loss: 1.250838, loss_ss: 1.232487, loss_d: 0.018351
0.1921 --- loss: 0.964330, loss_ss: 0.932734, loss_d: 0.031596
0.2305 --- loss: 0.880656, loss_ss: 0.854809, loss_d: 0.025847
0.2689 --- loss: 0.986691, loss_ss: 0.925989, loss_d: 0.060702
0.3073 --- loss: 0.620571, loss_ss: 0.575854, loss_d: 0.044717
0.3458 --- loss: 1.026063, loss_ss: 0.867476, loss_d: 0.158587
0.3842 --- loss: 0.740455, loss_ss: 0.702965, loss_d: 0.037490
0.4226 --- loss: 1.457762, loss_ss: 0.933626, loss_d: 0.524136
0.4610 --- loss: 1.027909, loss_ss: 0.850312, loss_d: 0.177597
0.4994 --- loss: 0.776487, loss_ss: 0.734123, loss_d: 0.042364
0.5378 --- loss: 0.800783, loss_ss: 0.701229, loss_d: 0.099554
0.5763 --- loss: 0.948115, loss_ss: 0.834062, loss_d: 0.114053
0.6147 --- loss: 0.916081, loss_ss: 0.843183, loss_d: 0.072898
0.6531 --- loss: 0.754147, loss_ss: 0.722138, loss_d: 0.032009
0.6915 --- loss: 1.051169, loss_ss: 1.004054, loss_d: 0.047116
0.7299 --- loss: 1.148870, loss_ss: 1.079745, loss_d: 0.069125
0.7683 --- loss: 0.747760, loss_ss: 0.703310, loss_d: 0.044449
0.8068 --- loss: 1.042302, loss_ss: 0.930420, loss_d: 0.111882
0.8452 --- loss: 1.260722, loss_ss: 1.106031, loss_d: 0.154691
0.8836 --- loss: 1.271727, loss_ss: 0.927745, loss_d: 0.343982
0.9220 --- loss: 0.769887, loss_ss: 0.700460, loss_d: 0.069426
0.9604 --- loss: 1.607112, loss_ss: 0.961770, loss_d: 0.645342
0.9988 --- loss: 0.685556, loss_ss: 0.671709, loss_d: 0.013848
Epoch finished! Loss: 1.074254024716524
Starting epoch 6/10.
0.0000 --- loss: 0.815221, loss_ss: 0.790123, loss_d: 0.025098
0.0384 --- loss: 0.925957, loss_ss: 0.857689, loss_d: 0.068268
0.0768 --- loss: 1.139544, loss_ss: 1.100752, loss_d: 0.038792
0.1153 --- loss: 1.037935, loss_ss: 1.028484, loss_d: 0.009451
0.1537 --- loss: 1.582613, loss_ss: 1.164813, loss_d: 0.417799
0.1921 --- loss: 0.805236, loss_ss: 0.741479, loss_d: 0.063756
0.2305 --- loss: 0.882750, loss_ss: 0.851279, loss_d: 0.031471
0.2689 --- loss: 0.607541, loss_ss: 0.599142, loss_d: 0.008398
0.3073 --- loss: 0.874559, loss_ss: 0.864568, loss_d: 0.009991
0.3458 --- loss: 0.749263, loss_ss: 0.712797, loss_d: 0.036465
0.3842 --- loss: 0.970294, loss_ss: 0.696323, loss_d: 0.273971
0.4226 --- loss: 1.037944, loss_ss: 0.688292, loss_d: 0.349652
0.4610 --- loss: 0.838095, loss_ss: 0.827470, loss_d: 0.010625
0.4994 --- loss: 1.308838, loss_ss: 1.183392, loss_d: 0.125446
0.5378 --- loss: 0.822775, loss_ss: 0.792219, loss_d: 0.030556
0.5763 --- loss: 1.285631, loss_ss: 0.927139, loss_d: 0.358492
0.6147 --- loss: 0.951441, loss_ss: 0.903458, loss_d: 0.047984
0.6531 --- loss: 1.034309, loss_ss: 0.882203, loss_d: 0.152106
0.6915 --- loss: 1.095283, loss_ss: 0.848632, loss_d: 0.246651
0.7299 --- loss: 1.756680, loss_ss: 1.325008, loss_d: 0.431673
0.7683 --- loss: 1.174544, loss_ss: 0.957388, loss_d: 0.217156
0.8068 --- loss: 0.854083, loss_ss: 0.837616, loss_d: 0.016467
0.8452 --- loss: 0.993655, loss_ss: 0.852626, loss_d: 0.141029
0.8836 --- loss: 1.382474, loss_ss: 0.838208, loss_d: 0.544266
0.9220 --- loss: 0.897991, loss_ss: 0.869351, loss_d: 0.028640
0.9604 --- loss: 0.762770, loss_ss: 0.674759, loss_d: 0.088011
0.9988 --- loss: 1.209707, loss_ss: 1.205301, loss_d: 0.004407
Epoch finished! Loss: 0.975070906831668
Starting epoch 7/10.
0.0000 --- loss: 0.997002, loss_ss: 0.973124, loss_d: 0.023877
0.0384 --- loss: 0.880078, loss_ss: 0.788307, loss_d: 0.091771
0.0768 --- loss: 0.773559, loss_ss: 0.758826, loss_d: 0.014733
0.1153 --- loss: 0.705095, loss_ss: 0.686278, loss_d: 0.018818
0.1537 --- loss: 0.608358, loss_ss: 0.578929, loss_d: 0.029429
0.1921 --- loss: 0.815036, loss_ss: 0.804633, loss_d: 0.010403
0.2305 --- loss: 1.018270, loss_ss: 0.894793, loss_d: 0.123477
0.2689 --- loss: 1.040104, loss_ss: 0.805771, loss_d: 0.234334
0.3073 --- loss: 0.895011, loss_ss: 0.875841, loss_d: 0.019169
0.3458 --- loss: 0.730607, loss_ss: 0.718850, loss_d: 0.011756
0.3842 --- loss: 1.244639, loss_ss: 0.863756, loss_d: 0.380883
0.4226 --- loss: 0.886246, loss_ss: 0.752070, loss_d: 0.134177
0.4610 --- loss: 0.832915, loss_ss: 0.825767, loss_d: 0.007148
0.4994 --- loss: 0.778912, loss_ss: 0.715624, loss_d: 0.063288
0.5378 --- loss: 0.615118, loss_ss: 0.603730, loss_d: 0.011389
0.5763 --- loss: 0.742421, loss_ss: 0.532220, loss_d: 0.210201
0.6147 --- loss: 1.227486, loss_ss: 0.681284, loss_d: 0.546202
0.6531 --- loss: 0.832016, loss_ss: 0.802257, loss_d: 0.029759
0.6915 --- loss: 0.923364, loss_ss: 0.895493, loss_d: 0.027872
0.7299 --- loss: 0.885557, loss_ss: 0.829588, loss_d: 0.055969
0.7683 --- loss: 1.053316, loss_ss: 0.845237, loss_d: 0.208079
0.8068 --- loss: 0.873332, loss_ss: 0.869505, loss_d: 0.003827
0.8452 --- loss: 0.831232, loss_ss: 0.770826, loss_d: 0.060406
0.8836 --- loss: 1.010291, loss_ss: 0.665653, loss_d: 0.344638
0.9220 --- loss: 0.742673, loss_ss: 0.703518, loss_d: 0.039155
0.9604 --- loss: 0.785795, loss_ss: 0.732701, loss_d: 0.053094
0.9988 --- loss: 2.105319, loss_ss: 1.065919, loss_d: 1.039400
Epoch finished! Loss: 0.9332506537437439
Starting epoch 8/10.
0.0000 --- loss: 0.938440, loss_ss: 0.893031, loss_d: 0.045409
0.0384 --- loss: 0.983594, loss_ss: 0.771869, loss_d: 0.211724
0.0768 --- loss: 1.074832, loss_ss: 0.925743, loss_d: 0.149089
0.1153 --- loss: 1.156733, loss_ss: 0.715250, loss_d: 0.441483
0.1537 --- loss: 0.895348, loss_ss: 0.739640, loss_d: 0.155709
0.1921 --- loss: 0.803193, loss_ss: 0.732301, loss_d: 0.070892
0.2305 --- loss: 0.727442, loss_ss: 0.718595, loss_d: 0.008847
0.2689 --- loss: 1.018282, loss_ss: 0.999789, loss_d: 0.018493
0.3073 --- loss: 0.837416, loss_ss: 0.789567, loss_d: 0.047850
0.3458 --- loss: 0.967520, loss_ss: 0.860969, loss_d: 0.106551
0.3842 --- loss: 0.949550, loss_ss: 0.887470, loss_d: 0.062079
0.4226 --- loss: 1.156050, loss_ss: 1.065229, loss_d: 0.090822
0.4610 --- loss: 0.876798, loss_ss: 0.863345, loss_d: 0.013452
0.4994 --- loss: 0.853172, loss_ss: 0.830471, loss_d: 0.022700
0.5378 --- loss: 0.839613, loss_ss: 0.834373, loss_d: 0.005240
0.5763 --- loss: 0.713519, loss_ss: 0.658871, loss_d: 0.054649
0.6147 --- loss: 0.702562, loss_ss: 0.681902, loss_d: 0.020661
0.6531 --- loss: 0.600385, loss_ss: 0.592544, loss_d: 0.007841
0.6915 --- loss: 0.878325, loss_ss: 0.875085, loss_d: 0.003240
0.7299 --- loss: 0.952125, loss_ss: 0.757817, loss_d: 0.194308
0.7683 --- loss: 1.192482, loss_ss: 1.008317, loss_d: 0.184165
0.8068 --- loss: 0.985741, loss_ss: 0.963881, loss_d: 0.021861
0.8452 --- loss: 1.322487, loss_ss: 0.889552, loss_d: 0.432936
0.8836 --- loss: 0.970555, loss_ss: 0.821987, loss_d: 0.148569
0.9220 --- loss: 0.818388, loss_ss: 0.530603, loss_d: 0.287785
0.9604 --- loss: 0.903056, loss_ss: 0.641249, loss_d: 0.261807
0.9988 --- loss: 0.817488, loss_ss: 0.806659, loss_d: 0.010830
Epoch finished! Loss: 0.9004158481955529
Starting epoch 9/10.
0.0000 --- loss: 0.787446, loss_ss: 0.749690, loss_d: 0.037755
0.0384 --- loss: 0.891445, loss_ss: 0.870716, loss_d: 0.020729
0.0768 --- loss: 0.680085, loss_ss: 0.658917, loss_d: 0.021168
0.1153 --- loss: 0.903506, loss_ss: 0.901823, loss_d: 0.001683
0.1537 --- loss: 0.862323, loss_ss: 0.836342, loss_d: 0.025981
0.1921 --- loss: 1.076912, loss_ss: 0.918613, loss_d: 0.158299
0.2305 --- loss: 1.429775, loss_ss: 0.520791, loss_d: 0.908985
0.2689 --- loss: 0.776274, loss_ss: 0.713437, loss_d: 0.062837
0.3073 --- loss: 0.766944, loss_ss: 0.625235, loss_d: 0.141709
0.3458 --- loss: 0.648267, loss_ss: 0.631697, loss_d: 0.016570
0.3842 --- loss: 0.748575, loss_ss: 0.725431, loss_d: 0.023144
0.4226 --- loss: 0.704449, loss_ss: 0.662659, loss_d: 0.041790
0.4610 --- loss: 1.062327, loss_ss: 0.831861, loss_d: 0.230466
0.4994 --- loss: 0.677125, loss_ss: 0.595681, loss_d: 0.081444
0.5378 --- loss: 0.800401, loss_ss: 0.799331, loss_d: 0.001071
0.5763 --- loss: 0.841061, loss_ss: 0.764140, loss_d: 0.076921
0.6147 --- loss: 0.654505, loss_ss: 0.530512, loss_d: 0.123993
0.6531 --- loss: 0.693863, loss_ss: 0.501487, loss_d: 0.192377
0.6915 --- loss: 0.997605, loss_ss: 0.850670, loss_d: 0.146935
0.7299 --- loss: 0.639141, loss_ss: 0.635506, loss_d: 0.003635
0.7683 --- loss: 0.572873, loss_ss: 0.519063, loss_d: 0.053810
0.8068 --- loss: 0.919183, loss_ss: 0.788374, loss_d: 0.130809
0.8452 --- loss: 0.632127, loss_ss: 0.611627, loss_d: 0.020500
0.8836 --- loss: 0.907663, loss_ss: 0.758305, loss_d: 0.149358
0.9220 --- loss: 1.093626, loss_ss: 1.043047, loss_d: 0.050579
0.9604 --- loss: 0.670328, loss_ss: 0.560358, loss_d: 0.109971
0.9988 --- loss: 0.805547, loss_ss: 0.803074, loss_d: 0.002473
Epoch finished! Loss: 0.8486634314060211
Starting epoch 10/10.
0.0000 --- loss: 0.872028, loss_ss: 0.841436, loss_d: 0.030592
0.0384 --- loss: 0.638931, loss_ss: 0.627733, loss_d: 0.011199
0.0768 --- loss: 0.619704, loss_ss: 0.603502, loss_d: 0.016202
0.1153 --- loss: 0.790476, loss_ss: 0.776833, loss_d: 0.013643
0.1537 --- loss: 0.670126, loss_ss: 0.665405, loss_d: 0.004721
0.1921 --- loss: 0.789491, loss_ss: 0.769152, loss_d: 0.020339
0.2305 --- loss: 0.920651, loss_ss: 0.810639, loss_d: 0.110012
0.2689 --- loss: 0.837982, loss_ss: 0.832504, loss_d: 0.005478
0.3073 --- loss: 0.670129, loss_ss: 0.577920, loss_d: 0.092209
0.3458 --- loss: 0.680142, loss_ss: 0.653617, loss_d: 0.026525
0.3842 --- loss: 0.620191, loss_ss: 0.610237, loss_d: 0.009953
0.4226 --- loss: 1.367295, loss_ss: 0.884869, loss_d: 0.482427
0.4610 --- loss: 0.879551, loss_ss: 0.674022, loss_d: 0.205529
0.4994 --- loss: 1.180329, loss_ss: 1.055450, loss_d: 0.124879
0.5378 --- loss: 0.912996, loss_ss: 0.908194, loss_d: 0.004802
0.5763 --- loss: 0.764123, loss_ss: 0.739499, loss_d: 0.024625
0.6147 --- loss: 0.900203, loss_ss: 0.887342, loss_d: 0.012861
0.6531 --- loss: 0.949451, loss_ss: 0.926365, loss_d: 0.023086
0.6915 --- loss: 0.884490, loss_ss: 0.880205, loss_d: 0.004284
0.7299 --- loss: 0.991600, loss_ss: 0.980250, loss_d: 0.011350
0.7683 --- loss: 1.025470, loss_ss: 0.776176, loss_d: 0.249294
0.8068 --- loss: 0.829768, loss_ss: 0.740669, loss_d: 0.089099
0.8452 --- loss: 0.859438, loss_ss: 0.647349, loss_d: 0.212088
0.8836 --- loss: 0.897606, loss_ss: 0.870545, loss_d: 0.027061
0.9220 --- loss: 0.940449, loss_ss: 0.715523, loss_d: 0.224926
0.9604 --- loss: 0.830633, loss_ss: 0.688559, loss_d: 0.142074
0.9988 --- loss: 1.045750, loss_ss: 1.003595, loss_d: 0.042155
Epoch finished! Loss: 0.8511240787231005
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6895238095238095
             precision    recall  f1-score   support

        0.0       0.91      0.74      0.82       163
        1.0       0.35      0.15      0.21       142
        2.0       0.78      0.70      0.74       329
        3.0       0.90      0.75      0.82       200
        4.0       0.51      0.94      0.66       216

avg / total       0.71      0.69      0.68      1050
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.86  74.23   98.65  90.98     81.76
1  84.76  14.79   95.70  35.00     20.79
2  84.38  69.91   90.98  77.97     73.72
3  93.62  75.00   98.00  89.82     81.74
4  80.29  93.52   76.86  51.14     66.12
Total accuracy: 68.95%
Average sen: 65.49%
Average spec: 92.04%
Macro f1-score: 64.83%
Diagnosis acc on 15mins: 1.0
[0.99967349 0.99998617 0.99972469 0.99172008 0.97455263 0.99966836
 0.99996316 0.99990106 0.99999356 0.99998987 0.99999487 0.99787533
 0.99874026 0.99951446 0.99999714 0.99997652 0.99952304 0.9939599
 0.97342706 0.9879337  0.99567503 0.99535549 0.99927264 0.9999851
 0.99996793 0.99032986 0.9948715  0.98904258 0.9924069  0.99582905
 0.99507624 0.9930566  0.9636479  0.99154574 0.99984968]
pred: 0.9946293592453003, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.341511, loss_ss: 1.645501, loss_d: 0.696011
0.0384 --- loss: 2.448070, loss_ss: 1.631870, loss_d: 0.816199
0.0769 --- loss: 2.174472, loss_ss: 1.608556, loss_d: 0.565916
0.1153 --- loss: 2.234807, loss_ss: 1.640801, loss_d: 0.594006
0.1537 --- loss: 2.360039, loss_ss: 1.558732, loss_d: 0.801307
0.1922 --- loss: 2.131787, loss_ss: 1.474393, loss_d: 0.657394
0.2306 --- loss: 2.037959, loss_ss: 1.410968, loss_d: 0.626990
0.2690 --- loss: 2.209075, loss_ss: 1.411141, loss_d: 0.797934
0.3075 --- loss: 2.564545, loss_ss: 1.466950, loss_d: 1.097594
0.3459 --- loss: 2.038448, loss_ss: 1.365740, loss_d: 0.672707
0.3843 --- loss: 1.960131, loss_ss: 1.391269, loss_d: 0.568862
0.4228 --- loss: 1.993706, loss_ss: 1.362215, loss_d: 0.631491
0.4612 --- loss: 1.851097, loss_ss: 1.338372, loss_d: 0.512726
0.4996 --- loss: 2.222871, loss_ss: 1.249399, loss_d: 0.973472
0.5380 --- loss: 2.094309, loss_ss: 1.411853, loss_d: 0.682456
0.5765 --- loss: 1.808000, loss_ss: 1.313459, loss_d: 0.494541
0.6149 --- loss: 1.841992, loss_ss: 1.367766, loss_d: 0.474226
0.6533 --- loss: 1.980338, loss_ss: 1.249134, loss_d: 0.731204
0.6918 --- loss: 2.027230, loss_ss: 1.311771, loss_d: 0.715459
0.7302 --- loss: 1.757221, loss_ss: 1.194701, loss_d: 0.562520
0.7686 --- loss: 1.758903, loss_ss: 1.169580, loss_d: 0.589323
0.8071 --- loss: 1.896973, loss_ss: 1.200078, loss_d: 0.696895
0.8455 --- loss: 1.722114, loss_ss: 1.151791, loss_d: 0.570323
0.8839 --- loss: 1.620677, loss_ss: 1.291995, loss_d: 0.328682
0.9224 --- loss: 1.712225, loss_ss: 1.289417, loss_d: 0.422808
0.9608 --- loss: 1.737076, loss_ss: 1.228522, loss_d: 0.508555
0.9992 --- loss: 1.925314, loss_ss: 1.327143, loss_d: 0.598172
Epoch finished! Loss: 1.9821669986614814
Starting epoch 2/10.
0.0000 --- loss: 1.561798, loss_ss: 1.187297, loss_d: 0.374501
0.0384 --- loss: 1.638961, loss_ss: 1.228039, loss_d: 0.410923
0.0769 --- loss: 1.503216, loss_ss: 1.174317, loss_d: 0.328899
0.1153 --- loss: 1.878757, loss_ss: 1.209520, loss_d: 0.669237
0.1537 --- loss: 1.697338, loss_ss: 1.152254, loss_d: 0.545084
0.1922 --- loss: 1.889547, loss_ss: 1.202180, loss_d: 0.687367
0.2306 --- loss: 1.344981, loss_ss: 1.094950, loss_d: 0.250031
0.2690 --- loss: 1.505674, loss_ss: 1.070941, loss_d: 0.434733
0.3075 --- loss: 1.354103, loss_ss: 1.095162, loss_d: 0.258941
0.3459 --- loss: 1.385042, loss_ss: 1.041334, loss_d: 0.343709
0.3843 --- loss: 1.618725, loss_ss: 1.173347, loss_d: 0.445378
0.4228 --- loss: 1.562432, loss_ss: 1.144190, loss_d: 0.418242
0.4612 --- loss: 1.368889, loss_ss: 1.012619, loss_d: 0.356270
0.4996 --- loss: 1.377488, loss_ss: 1.238200, loss_d: 0.139289
0.5380 --- loss: 1.427316, loss_ss: 1.062948, loss_d: 0.364368
0.5765 --- loss: 1.613750, loss_ss: 1.129887, loss_d: 0.483863
0.6149 --- loss: 1.269194, loss_ss: 1.151677, loss_d: 0.117516
0.6533 --- loss: 1.089316, loss_ss: 0.972740, loss_d: 0.116576
0.6918 --- loss: 1.365277, loss_ss: 1.057019, loss_d: 0.308258
0.7302 --- loss: 1.170078, loss_ss: 1.049466, loss_d: 0.120612
0.7686 --- loss: 1.682623, loss_ss: 1.527287, loss_d: 0.155336
0.8071 --- loss: 1.529184, loss_ss: 0.859934, loss_d: 0.669250
0.8455 --- loss: 1.243284, loss_ss: 0.892556, loss_d: 0.350728
0.8839 --- loss: 1.387486, loss_ss: 1.136634, loss_d: 0.250852
0.9224 --- loss: 1.050950, loss_ss: 0.951574, loss_d: 0.099376
0.9608 --- loss: 1.161825, loss_ss: 0.858638, loss_d: 0.303187
0.9992 --- loss: 1.945607, loss_ss: 1.693969, loss_d: 0.251638
Epoch finished! Loss: 1.4830473163953195
Starting epoch 3/10.
0.0000 --- loss: 1.910720, loss_ss: 1.016115, loss_d: 0.894605
0.0384 --- loss: 1.220078, loss_ss: 1.108938, loss_d: 0.111140
0.0769 --- loss: 1.216517, loss_ss: 1.011390, loss_d: 0.205128
0.1153 --- loss: 1.147097, loss_ss: 1.017170, loss_d: 0.129927
0.1537 --- loss: 1.436617, loss_ss: 1.145223, loss_d: 0.291393
0.1922 --- loss: 1.111079, loss_ss: 0.940083, loss_d: 0.170996
0.2306 --- loss: 0.871910, loss_ss: 0.715250, loss_d: 0.156660
0.2690 --- loss: 1.119808, loss_ss: 1.033780, loss_d: 0.086028
0.3075 --- loss: 1.438980, loss_ss: 1.050170, loss_d: 0.388810
0.3459 --- loss: 1.080055, loss_ss: 0.973351, loss_d: 0.106704
0.3843 --- loss: 1.058484, loss_ss: 0.926371, loss_d: 0.132113
0.4228 --- loss: 0.987512, loss_ss: 0.833173, loss_d: 0.154339
0.4612 --- loss: 1.127141, loss_ss: 0.820012, loss_d: 0.307128
0.4996 --- loss: 1.019773, loss_ss: 0.859960, loss_d: 0.159812
0.5380 --- loss: 0.983555, loss_ss: 0.892224, loss_d: 0.091331
0.5765 --- loss: 1.062717, loss_ss: 0.944833, loss_d: 0.117884
0.6149 --- loss: 1.101040, loss_ss: 0.907570, loss_d: 0.193470
0.6533 --- loss: 1.097648, loss_ss: 0.804810, loss_d: 0.292837
0.6918 --- loss: 1.247624, loss_ss: 0.963832, loss_d: 0.283792
0.7302 --- loss: 1.247240, loss_ss: 1.087465, loss_d: 0.159776
0.7686 --- loss: 1.320456, loss_ss: 1.150508, loss_d: 0.169948
0.8071 --- loss: 1.079507, loss_ss: 0.878696, loss_d: 0.200811
0.8455 --- loss: 1.245261, loss_ss: 0.998470, loss_d: 0.246791
0.8839 --- loss: 1.029493, loss_ss: 0.761685, loss_d: 0.267808
0.9224 --- loss: 1.187179, loss_ss: 1.008161, loss_d: 0.179018
0.9608 --- loss: 1.655096, loss_ss: 0.897514, loss_d: 0.757582
0.9992 --- loss: 1.426511, loss_ss: 1.318638, loss_d: 0.107874
Epoch finished! Loss: 1.234572053184876
Starting epoch 4/10.
0.0000 --- loss: 1.125889, loss_ss: 0.984457, loss_d: 0.141431
0.0384 --- loss: 1.237460, loss_ss: 0.763430, loss_d: 0.474030
0.0769 --- loss: 1.652301, loss_ss: 1.304570, loss_d: 0.347731
0.1153 --- loss: 1.223930, loss_ss: 0.907300, loss_d: 0.316630
0.1537 --- loss: 0.830955, loss_ss: 0.769197, loss_d: 0.061758
0.1922 --- loss: 1.080536, loss_ss: 0.838772, loss_d: 0.241763
0.2306 --- loss: 1.064095, loss_ss: 0.790250, loss_d: 0.273845
0.2690 --- loss: 0.893970, loss_ss: 0.741557, loss_d: 0.152412
0.3075 --- loss: 1.166707, loss_ss: 1.006356, loss_d: 0.160352
0.3459 --- loss: 1.288214, loss_ss: 1.031368, loss_d: 0.256846
0.3843 --- loss: 1.012560, loss_ss: 0.729961, loss_d: 0.282599
0.4228 --- loss: 1.842039, loss_ss: 1.524654, loss_d: 0.317386
0.4612 --- loss: 1.176885, loss_ss: 0.884531, loss_d: 0.292355
0.4996 --- loss: 0.951658, loss_ss: 0.863648, loss_d: 0.088009
0.5380 --- loss: 1.238716, loss_ss: 0.784396, loss_d: 0.454319
0.5765 --- loss: 1.770601, loss_ss: 1.158808, loss_d: 0.611793
0.6149 --- loss: 1.149180, loss_ss: 1.090843, loss_d: 0.058337
0.6533 --- loss: 0.837971, loss_ss: 0.759932, loss_d: 0.078039
0.6918 --- loss: 1.016777, loss_ss: 0.895864, loss_d: 0.120914
0.7302 --- loss: 1.232680, loss_ss: 0.817077, loss_d: 0.415602
0.7686 --- loss: 0.884174, loss_ss: 0.845627, loss_d: 0.038547
0.8071 --- loss: 1.132257, loss_ss: 0.741077, loss_d: 0.391180
0.8455 --- loss: 0.951933, loss_ss: 0.643181, loss_d: 0.308752
0.8839 --- loss: 1.142357, loss_ss: 1.000751, loss_d: 0.141606
0.9224 --- loss: 1.192301, loss_ss: 0.721229, loss_d: 0.471073
0.9608 --- loss: 0.925809, loss_ss: 0.858425, loss_d: 0.067384
0.9992 --- loss: 1.051834, loss_ss: 0.962702, loss_d: 0.089132
Epoch finished! Loss: 1.0984099835157395
Starting epoch 5/10.
0.0000 --- loss: 0.810402, loss_ss: 0.724309, loss_d: 0.086092
0.0384 --- loss: 0.786233, loss_ss: 0.634226, loss_d: 0.152007
0.0769 --- loss: 0.624752, loss_ss: 0.434580, loss_d: 0.190172
0.1153 --- loss: 0.823217, loss_ss: 0.781860, loss_d: 0.041357
0.1537 --- loss: 0.798795, loss_ss: 0.701503, loss_d: 0.097293
0.1922 --- loss: 1.122580, loss_ss: 0.659076, loss_d: 0.463504
0.2306 --- loss: 0.771256, loss_ss: 0.640443, loss_d: 0.130813
0.2690 --- loss: 0.766773, loss_ss: 0.656391, loss_d: 0.110381
0.3075 --- loss: 0.895022, loss_ss: 0.816522, loss_d: 0.078500
0.3459 --- loss: 1.769620, loss_ss: 0.744810, loss_d: 1.024810
0.3843 --- loss: 0.840221, loss_ss: 0.738049, loss_d: 0.102172
0.4228 --- loss: 0.920377, loss_ss: 0.821199, loss_d: 0.099179
0.4612 --- loss: 0.761073, loss_ss: 0.736570, loss_d: 0.024503
0.4996 --- loss: 1.379685, loss_ss: 0.840780, loss_d: 0.538905
0.5380 --- loss: 1.052399, loss_ss: 0.975089, loss_d: 0.077310
0.5765 --- loss: 1.267522, loss_ss: 1.179229, loss_d: 0.088293
0.6149 --- loss: 1.055752, loss_ss: 1.038304, loss_d: 0.017449
0.6533 --- loss: 0.757877, loss_ss: 0.696765, loss_d: 0.061112
0.6918 --- loss: 0.751513, loss_ss: 0.605490, loss_d: 0.146023
0.7302 --- loss: 1.122798, loss_ss: 0.898096, loss_d: 0.224701
0.7686 --- loss: 0.855276, loss_ss: 0.592701, loss_d: 0.262575
0.8071 --- loss: 0.927725, loss_ss: 0.842946, loss_d: 0.084779
0.8455 --- loss: 0.692364, loss_ss: 0.637102, loss_d: 0.055262
0.8839 --- loss: 1.154515, loss_ss: 1.030206, loss_d: 0.124309
0.9224 --- loss: 1.167073, loss_ss: 0.985208, loss_d: 0.181865
0.9608 --- loss: 0.855231, loss_ss: 0.809231, loss_d: 0.046000
0.9992 --- loss: 2.053245, loss_ss: 1.979632, loss_d: 0.073612
Epoch finished! Loss: 1.0063188910484313
Starting epoch 6/10.
0.0000 --- loss: 1.206201, loss_ss: 1.011916, loss_d: 0.194285
0.0384 --- loss: 1.102925, loss_ss: 1.046606, loss_d: 0.056319
0.0769 --- loss: 0.817402, loss_ss: 0.786271, loss_d: 0.031132
0.1153 --- loss: 0.754059, loss_ss: 0.739095, loss_d: 0.014964
0.1537 --- loss: 0.692047, loss_ss: 0.677552, loss_d: 0.014496
0.1922 --- loss: 0.995527, loss_ss: 0.757832, loss_d: 0.237695
0.2306 --- loss: 1.281657, loss_ss: 1.054680, loss_d: 0.226977
0.2690 --- loss: 1.328031, loss_ss: 0.840031, loss_d: 0.488000
0.3075 --- loss: 1.433863, loss_ss: 1.061886, loss_d: 0.371977
0.3459 --- loss: 1.219815, loss_ss: 0.740553, loss_d: 0.479262
0.3843 --- loss: 0.862138, loss_ss: 0.668215, loss_d: 0.193923
0.4228 --- loss: 1.385896, loss_ss: 1.131915, loss_d: 0.253981
0.4612 --- loss: 1.116683, loss_ss: 0.900332, loss_d: 0.216351
0.4996 --- loss: 0.924927, loss_ss: 0.554790, loss_d: 0.370138
0.5380 --- loss: 0.893836, loss_ss: 0.804193, loss_d: 0.089643
0.5765 --- loss: 0.735493, loss_ss: 0.570172, loss_d: 0.165321
0.6149 --- loss: 0.961748, loss_ss: 0.821567, loss_d: 0.140181
0.6533 --- loss: 0.870982, loss_ss: 0.643184, loss_d: 0.227798
0.6918 --- loss: 0.633130, loss_ss: 0.462431, loss_d: 0.170699
0.7302 --- loss: 1.496451, loss_ss: 1.157076, loss_d: 0.339376
0.7686 --- loss: 0.872746, loss_ss: 0.519621, loss_d: 0.353125
0.8071 --- loss: 0.732752, loss_ss: 0.564171, loss_d: 0.168582
0.8455 --- loss: 0.974671, loss_ss: 0.786338, loss_d: 0.188333
0.8839 --- loss: 0.679303, loss_ss: 0.558034, loss_d: 0.121269
0.9224 --- loss: 0.644859, loss_ss: 0.573453, loss_d: 0.071406
0.9608 --- loss: 1.073395, loss_ss: 0.953899, loss_d: 0.119495
0.9992 --- loss: 2.458072, loss_ss: 0.994943, loss_d: 1.463128
Epoch finished! Loss: 0.9580816599038932
Starting epoch 7/10.
0.0000 --- loss: 0.835501, loss_ss: 0.721773, loss_d: 0.113728
0.0384 --- loss: 0.881517, loss_ss: 0.800616, loss_d: 0.080902
0.0769 --- loss: 1.095155, loss_ss: 0.995285, loss_d: 0.099871
0.1153 --- loss: 0.915329, loss_ss: 0.785641, loss_d: 0.129688
0.1537 --- loss: 0.810868, loss_ss: 0.693552, loss_d: 0.117316
0.1922 --- loss: 0.915844, loss_ss: 0.864124, loss_d: 0.051721
0.2306 --- loss: 1.088781, loss_ss: 0.864162, loss_d: 0.224619
0.2690 --- loss: 0.857605, loss_ss: 0.826156, loss_d: 0.031449
0.3075 --- loss: 0.830156, loss_ss: 0.633119, loss_d: 0.197037
0.3459 --- loss: 1.250711, loss_ss: 1.153654, loss_d: 0.097056
0.3843 --- loss: 0.952586, loss_ss: 0.631240, loss_d: 0.321346
0.4228 --- loss: 1.261094, loss_ss: 0.787073, loss_d: 0.474021
0.4612 --- loss: 0.609245, loss_ss: 0.578678, loss_d: 0.030567
0.4996 --- loss: 1.465085, loss_ss: 1.181984, loss_d: 0.283101
0.5380 --- loss: 0.762546, loss_ss: 0.692420, loss_d: 0.070126
0.5765 --- loss: 1.209736, loss_ss: 0.773818, loss_d: 0.435918
0.6149 --- loss: 0.783916, loss_ss: 0.765380, loss_d: 0.018536
0.6533 --- loss: 1.326898, loss_ss: 0.792849, loss_d: 0.534049
0.6918 --- loss: 0.950137, loss_ss: 0.920516, loss_d: 0.029622
0.7302 --- loss: 0.674864, loss_ss: 0.575897, loss_d: 0.098967
0.7686 --- loss: 1.297567, loss_ss: 1.257347, loss_d: 0.040220
0.8071 --- loss: 0.765895, loss_ss: 0.521860, loss_d: 0.244035
0.8455 --- loss: 0.849272, loss_ss: 0.787823, loss_d: 0.061449
0.8839 --- loss: 0.638367, loss_ss: 0.623289, loss_d: 0.015078
0.9224 --- loss: 0.766102, loss_ss: 0.662235, loss_d: 0.103867
0.9608 --- loss: 0.904470, loss_ss: 0.747576, loss_d: 0.156894
0.9992 --- loss: 2.043690, loss_ss: 2.020891, loss_d: 0.022799
Epoch finished! Loss: 0.9187775041048344
Starting epoch 8/10.
0.0000 --- loss: 0.625835, loss_ss: 0.615682, loss_d: 0.010152
0.0384 --- loss: 0.625656, loss_ss: 0.579885, loss_d: 0.045771
0.0769 --- loss: 0.725328, loss_ss: 0.629113, loss_d: 0.096215
0.1153 --- loss: 0.926132, loss_ss: 0.725639, loss_d: 0.200492
0.1537 --- loss: 0.704219, loss_ss: 0.669118, loss_d: 0.035101
0.1922 --- loss: 0.845400, loss_ss: 0.814403, loss_d: 0.030997
0.2306 --- loss: 0.846880, loss_ss: 0.831682, loss_d: 0.015198
0.2690 --- loss: 0.827481, loss_ss: 0.803719, loss_d: 0.023763
0.3075 --- loss: 0.659579, loss_ss: 0.554915, loss_d: 0.104664
0.3459 --- loss: 0.792229, loss_ss: 0.785387, loss_d: 0.006842
0.3843 --- loss: 1.212712, loss_ss: 1.149449, loss_d: 0.063264
0.4228 --- loss: 0.768998, loss_ss: 0.734333, loss_d: 0.034665
0.4612 --- loss: 0.668573, loss_ss: 0.613178, loss_d: 0.055396
0.4996 --- loss: 0.829023, loss_ss: 0.782372, loss_d: 0.046652
0.5380 --- loss: 0.704291, loss_ss: 0.674845, loss_d: 0.029447
0.5765 --- loss: 0.879325, loss_ss: 0.859231, loss_d: 0.020094
0.6149 --- loss: 0.760205, loss_ss: 0.569177, loss_d: 0.191028
0.6533 --- loss: 0.598770, loss_ss: 0.539944, loss_d: 0.058827
0.6918 --- loss: 0.530011, loss_ss: 0.527126, loss_d: 0.002886
0.7302 --- loss: 1.413886, loss_ss: 1.101297, loss_d: 0.312590
0.7686 --- loss: 0.857619, loss_ss: 0.773625, loss_d: 0.083994
0.8071 --- loss: 0.745295, loss_ss: 0.723908, loss_d: 0.021386
0.8455 --- loss: 0.679333, loss_ss: 0.584931, loss_d: 0.094402
0.8839 --- loss: 1.093843, loss_ss: 0.975874, loss_d: 0.117969
0.9224 --- loss: 0.974858, loss_ss: 0.968350, loss_d: 0.006508
0.9608 --- loss: 0.689077, loss_ss: 0.632640, loss_d: 0.056437
0.9992 --- loss: 1.452498, loss_ss: 1.445005, loss_d: 0.007494
Epoch finished! Loss: 0.8803396220390614
Starting epoch 9/10.
0.0000 --- loss: 0.939858, loss_ss: 0.932730, loss_d: 0.007129
0.0384 --- loss: 0.640071, loss_ss: 0.631102, loss_d: 0.008969
0.0769 --- loss: 1.212761, loss_ss: 1.036438, loss_d: 0.176323
0.1153 --- loss: 0.617193, loss_ss: 0.599304, loss_d: 0.017889
0.1537 --- loss: 0.664509, loss_ss: 0.661961, loss_d: 0.002548
0.1922 --- loss: 1.273705, loss_ss: 0.948755, loss_d: 0.324950
0.2306 --- loss: 0.859804, loss_ss: 0.664524, loss_d: 0.195280
0.2690 --- loss: 0.897155, loss_ss: 0.569123, loss_d: 0.328031
0.3075 --- loss: 1.026564, loss_ss: 1.010635, loss_d: 0.015929
0.3459 --- loss: 0.599412, loss_ss: 0.590928, loss_d: 0.008484
0.3843 --- loss: 0.733141, loss_ss: 0.569887, loss_d: 0.163254
0.4228 --- loss: 0.712888, loss_ss: 0.530740, loss_d: 0.182148
0.4612 --- loss: 0.657989, loss_ss: 0.506168, loss_d: 0.151821
0.4996 --- loss: 0.933035, loss_ss: 0.766063, loss_d: 0.166972
0.5380 --- loss: 0.982532, loss_ss: 0.906137, loss_d: 0.076395
0.5765 --- loss: 0.557978, loss_ss: 0.513240, loss_d: 0.044738
0.6149 --- loss: 0.696564, loss_ss: 0.675591, loss_d: 0.020973
0.6533 --- loss: 0.899410, loss_ss: 0.725721, loss_d: 0.173689
0.6918 --- loss: 0.756993, loss_ss: 0.732402, loss_d: 0.024591
0.7302 --- loss: 0.964783, loss_ss: 0.954399, loss_d: 0.010384
0.7686 --- loss: 0.737173, loss_ss: 0.663227, loss_d: 0.073946
0.8071 --- loss: 0.888641, loss_ss: 0.747879, loss_d: 0.140763
0.8455 --- loss: 0.802855, loss_ss: 0.762391, loss_d: 0.040464
0.8839 --- loss: 0.656690, loss_ss: 0.637296, loss_d: 0.019394
0.9224 --- loss: 0.675245, loss_ss: 0.612522, loss_d: 0.062723
0.9608 --- loss: 0.679312, loss_ss: 0.617862, loss_d: 0.061449
0.9992 --- loss: 1.152384, loss_ss: 1.149103, loss_d: 0.003280
Epoch finished! Loss: 0.8745749145746231
Starting epoch 10/10.
0.0000 --- loss: 0.828306, loss_ss: 0.790326, loss_d: 0.037979
0.0384 --- loss: 0.841346, loss_ss: 0.751129, loss_d: 0.090217
0.0769 --- loss: 0.468394, loss_ss: 0.449855, loss_d: 0.018540
0.1153 --- loss: 0.745061, loss_ss: 0.697257, loss_d: 0.047805
0.1537 --- loss: 0.817288, loss_ss: 0.797224, loss_d: 0.020064
0.1922 --- loss: 0.642564, loss_ss: 0.600360, loss_d: 0.042205
0.2306 --- loss: 0.731202, loss_ss: 0.714569, loss_d: 0.016633
0.2690 --- loss: 0.768839, loss_ss: 0.759910, loss_d: 0.008930
0.3075 --- loss: 1.035821, loss_ss: 0.670225, loss_d: 0.365596
0.3459 --- loss: 0.977521, loss_ss: 0.959624, loss_d: 0.017897
0.3843 --- loss: 0.711359, loss_ss: 0.695609, loss_d: 0.015750
0.4228 --- loss: 1.440418, loss_ss: 1.125306, loss_d: 0.315112
0.4612 --- loss: 1.628940, loss_ss: 1.584427, loss_d: 0.044514
0.4996 --- loss: 0.598518, loss_ss: 0.581766, loss_d: 0.016751
0.5380 --- loss: 0.600518, loss_ss: 0.582970, loss_d: 0.017548
0.5765 --- loss: 0.923129, loss_ss: 0.920779, loss_d: 0.002350
0.6149 --- loss: 0.489273, loss_ss: 0.480448, loss_d: 0.008824
0.6533 --- loss: 1.271502, loss_ss: 1.235009, loss_d: 0.036493
0.6918 --- loss: 0.452924, loss_ss: 0.434279, loss_d: 0.018645
0.7302 --- loss: 0.839730, loss_ss: 0.803311, loss_d: 0.036419
0.7686 --- loss: 0.785642, loss_ss: 0.654701, loss_d: 0.130941
0.8071 --- loss: 0.802984, loss_ss: 0.752881, loss_d: 0.050103
0.8455 --- loss: 0.864438, loss_ss: 0.834053, loss_d: 0.030385
0.8839 --- loss: 0.648511, loss_ss: 0.597118, loss_d: 0.051393
0.9224 --- loss: 0.925460, loss_ss: 0.665186, loss_d: 0.260273
0.9608 --- loss: 1.292512, loss_ss: 1.188652, loss_d: 0.103860
0.9992 --- loss: 1.567452, loss_ss: 1.562974, loss_d: 0.004478
Epoch finished! Loss: 0.8230471059679985
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6907407407407408
             precision    recall  f1-score   support

        0.0       0.80      0.82      0.81       196
        1.0       0.15      0.72      0.24        58
        2.0       0.93      0.69      0.79       527
        3.0       0.77      0.52      0.62        33
        4.0       0.91      0.62      0.73       266

avg / total       0.85      0.69      0.75      1080
 


====== chp041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.06  81.63   95.59  80.40     81.01
1  75.74  72.41   75.93  14.58     24.28
2  82.31  68.88   95.12  93.08     79.17
3  98.06  51.52   99.52  77.27     61.82
4  88.98  61.65   97.91  90.61     73.38
Total accuracy: 69.07%
Average sen: 67.22%
Average spec: 92.81%
Macro f1-score: 63.93%
Diagnosis acc on 15mins: 1.0
[0.99999905 0.99999595 0.99999094 0.99999964 0.99999917 0.99991107
 0.99999976 0.99998331 0.9999975  0.99999452 0.99999964 0.99981874
 0.99999785 0.99999952 0.99999189 0.99999917 0.99999833 0.99999964
 0.99999666 0.9999907  0.99987721 0.99999976 0.99999857 0.99986434
 0.99999857 1.         0.99999988 0.99999952 1.         0.9999969
 0.99999571 0.99999988 1.         0.9999994  0.99999928 0.99999869]
pred: 0.9999830772479376, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.286089, loss_ss: 1.587437, loss_d: 0.698652
0.0384 --- loss: 1.930956, loss_ss: 1.615841, loss_d: 0.315115
0.0769 --- loss: 2.102204, loss_ss: 1.474951, loss_d: 0.627253
0.1153 --- loss: 2.001834, loss_ss: 1.523476, loss_d: 0.478358
0.1538 --- loss: 2.182620, loss_ss: 1.297753, loss_d: 0.884867
0.1922 --- loss: 2.135279, loss_ss: 1.533192, loss_d: 0.602086
0.2307 --- loss: 1.942183, loss_ss: 1.342163, loss_d: 0.600020
0.2691 --- loss: 2.046384, loss_ss: 1.370841, loss_d: 0.675544
0.3076 --- loss: 2.072804, loss_ss: 1.467432, loss_d: 0.605372
0.3460 --- loss: 1.857078, loss_ss: 1.263769, loss_d: 0.593309
0.3845 --- loss: 2.356354, loss_ss: 1.290676, loss_d: 1.065678
0.4229 --- loss: 2.156084, loss_ss: 1.538674, loss_d: 0.617410
0.4614 --- loss: 1.898623, loss_ss: 1.270596, loss_d: 0.628027
0.4998 --- loss: 1.949300, loss_ss: 1.260781, loss_d: 0.688518
0.5383 --- loss: 1.490756, loss_ss: 1.183201, loss_d: 0.307555
0.5767 --- loss: 1.571943, loss_ss: 1.157130, loss_d: 0.414813
0.6151 --- loss: 1.910986, loss_ss: 1.188432, loss_d: 0.722554
0.6536 --- loss: 2.147533, loss_ss: 1.183804, loss_d: 0.963730
0.6920 --- loss: 1.653923, loss_ss: 1.183440, loss_d: 0.470483
0.7305 --- loss: 1.936032, loss_ss: 1.334994, loss_d: 0.601038
0.7689 --- loss: 1.523345, loss_ss: 1.143226, loss_d: 0.380119
0.8074 --- loss: 1.547745, loss_ss: 1.162258, loss_d: 0.385487
0.8458 --- loss: 1.424493, loss_ss: 1.067983, loss_d: 0.356510
0.8843 --- loss: 1.640028, loss_ss: 1.097941, loss_d: 0.542087
0.9227 --- loss: 1.641349, loss_ss: 1.121522, loss_d: 0.519827
0.9612 --- loss: 1.368511, loss_ss: 1.049035, loss_d: 0.319476
0.9996 --- loss: 1.847975, loss_ss: 1.749401, loss_d: 0.098574
Epoch finished! Loss: 1.83886431318063
Starting epoch 2/10.
0.0000 --- loss: 1.653052, loss_ss: 1.417917, loss_d: 0.235135
0.0384 --- loss: 1.405627, loss_ss: 1.057729, loss_d: 0.347898
0.0769 --- loss: 1.292362, loss_ss: 0.993015, loss_d: 0.299347
0.1153 --- loss: 1.302562, loss_ss: 1.105228, loss_d: 0.197334
0.1538 --- loss: 1.601080, loss_ss: 1.058917, loss_d: 0.542163
0.1922 --- loss: 1.663477, loss_ss: 1.244657, loss_d: 0.418820
0.2307 --- loss: 1.640498, loss_ss: 1.008115, loss_d: 0.632383
0.2691 --- loss: 1.498520, loss_ss: 1.099275, loss_d: 0.399246
0.3076 --- loss: 1.340493, loss_ss: 1.044944, loss_d: 0.295548
0.3460 --- loss: 1.059187, loss_ss: 0.928892, loss_d: 0.130294
0.3845 --- loss: 1.506497, loss_ss: 1.021480, loss_d: 0.485016
0.4229 --- loss: 1.295376, loss_ss: 0.941242, loss_d: 0.354134
0.4614 --- loss: 1.460804, loss_ss: 1.046481, loss_d: 0.414323
0.4998 --- loss: 1.185217, loss_ss: 0.912808, loss_d: 0.272408
0.5383 --- loss: 1.093776, loss_ss: 0.819979, loss_d: 0.273797
0.5767 --- loss: 1.075761, loss_ss: 0.978981, loss_d: 0.096780
0.6151 --- loss: 1.460122, loss_ss: 0.912761, loss_d: 0.547361
0.6536 --- loss: 1.305978, loss_ss: 0.883916, loss_d: 0.422061
0.6920 --- loss: 1.109892, loss_ss: 0.856851, loss_d: 0.253042
0.7305 --- loss: 1.210512, loss_ss: 0.815440, loss_d: 0.395072
0.7689 --- loss: 1.110964, loss_ss: 0.934350, loss_d: 0.176614
0.8074 --- loss: 1.033810, loss_ss: 0.755303, loss_d: 0.278507
0.8458 --- loss: 1.035624, loss_ss: 0.863725, loss_d: 0.171899
0.8843 --- loss: 1.194028, loss_ss: 0.862513, loss_d: 0.331515
0.9227 --- loss: 1.148390, loss_ss: 0.848454, loss_d: 0.299937
0.9612 --- loss: 1.114819, loss_ss: 0.984123, loss_d: 0.130696
0.9996 --- loss: 1.531941, loss_ss: 1.494918, loss_d: 0.037023
Epoch finished! Loss: 1.3580561342147681
Starting epoch 3/10.
0.0000 --- loss: 1.039263, loss_ss: 0.945935, loss_d: 0.093328
0.0384 --- loss: 0.977764, loss_ss: 0.871207, loss_d: 0.106558
0.0769 --- loss: 0.875178, loss_ss: 0.740232, loss_d: 0.134947
0.1153 --- loss: 1.116113, loss_ss: 0.895653, loss_d: 0.220461
0.1538 --- loss: 1.299634, loss_ss: 1.019613, loss_d: 0.280021
0.1922 --- loss: 0.903595, loss_ss: 0.830920, loss_d: 0.072676
0.2307 --- loss: 1.136774, loss_ss: 0.934973, loss_d: 0.201801
0.2691 --- loss: 1.095122, loss_ss: 0.944466, loss_d: 0.150656
0.3076 --- loss: 0.854201, loss_ss: 0.767100, loss_d: 0.087101
0.3460 --- loss: 1.456730, loss_ss: 0.975003, loss_d: 0.481727
0.3845 --- loss: 0.926995, loss_ss: 0.664630, loss_d: 0.262365
0.4229 --- loss: 1.256347, loss_ss: 0.883411, loss_d: 0.372936
0.4614 --- loss: 1.185112, loss_ss: 0.851754, loss_d: 0.333358
0.4998 --- loss: 1.294221, loss_ss: 0.750254, loss_d: 0.543967
0.5383 --- loss: 1.375237, loss_ss: 1.159696, loss_d: 0.215541
0.5767 --- loss: 1.351918, loss_ss: 1.065757, loss_d: 0.286161
0.6151 --- loss: 1.195663, loss_ss: 0.928542, loss_d: 0.267121
0.6536 --- loss: 1.200000, loss_ss: 1.098321, loss_d: 0.101679
0.6920 --- loss: 1.035158, loss_ss: 0.722582, loss_d: 0.312576
0.7305 --- loss: 1.064798, loss_ss: 0.968945, loss_d: 0.095853
0.7689 --- loss: 1.193573, loss_ss: 0.795200, loss_d: 0.398373
0.8074 --- loss: 0.742685, loss_ss: 0.667349, loss_d: 0.075335
0.8458 --- loss: 0.879008, loss_ss: 0.813529, loss_d: 0.065478
0.8843 --- loss: 1.067852, loss_ss: 0.786403, loss_d: 0.281449
0.9227 --- loss: 1.370377, loss_ss: 1.052364, loss_d: 0.318012
0.9612 --- loss: 0.947252, loss_ss: 0.760115, loss_d: 0.187137
0.9996 --- loss: 2.416865, loss_ss: 2.392876, loss_d: 0.023990
Epoch finished! Loss: 1.1555334375454829
Starting epoch 4/10.
0.0000 --- loss: 1.025005, loss_ss: 0.853815, loss_d: 0.171190
0.0384 --- loss: 1.398148, loss_ss: 1.011051, loss_d: 0.387097
0.0769 --- loss: 0.766189, loss_ss: 0.687078, loss_d: 0.079111
0.1153 --- loss: 0.960502, loss_ss: 0.903856, loss_d: 0.056646
0.1538 --- loss: 0.786483, loss_ss: 0.748953, loss_d: 0.037530
0.1922 --- loss: 1.062229, loss_ss: 0.826041, loss_d: 0.236188
0.2307 --- loss: 0.867069, loss_ss: 0.671939, loss_d: 0.195130
0.2691 --- loss: 1.119925, loss_ss: 0.923620, loss_d: 0.196305
0.3076 --- loss: 1.160889, loss_ss: 0.878648, loss_d: 0.282241
0.3460 --- loss: 1.000479, loss_ss: 0.739911, loss_d: 0.260567
0.3845 --- loss: 1.150967, loss_ss: 0.880702, loss_d: 0.270265
0.4229 --- loss: 1.050271, loss_ss: 0.892109, loss_d: 0.158162
0.4614 --- loss: 1.120554, loss_ss: 0.776528, loss_d: 0.344026
0.4998 --- loss: 0.910482, loss_ss: 0.604716, loss_d: 0.305766
0.5383 --- loss: 1.448958, loss_ss: 0.957835, loss_d: 0.491122
0.5767 --- loss: 0.731630, loss_ss: 0.603669, loss_d: 0.127961
0.6151 --- loss: 1.407801, loss_ss: 1.271750, loss_d: 0.136051
0.6536 --- loss: 0.810693, loss_ss: 0.681964, loss_d: 0.128729
0.6920 --- loss: 0.877179, loss_ss: 0.730441, loss_d: 0.146738
0.7305 --- loss: 0.926217, loss_ss: 0.825506, loss_d: 0.100711
0.7689 --- loss: 0.883334, loss_ss: 0.799215, loss_d: 0.084119
0.8074 --- loss: 0.983981, loss_ss: 0.918340, loss_d: 0.065641
0.8458 --- loss: 0.933407, loss_ss: 0.745953, loss_d: 0.187454
0.8843 --- loss: 0.777243, loss_ss: 0.755202, loss_d: 0.022041
0.9227 --- loss: 1.105857, loss_ss: 0.865724, loss_d: 0.240134
0.9612 --- loss: 0.784303, loss_ss: 0.734425, loss_d: 0.049877
0.9996 --- loss: 1.395034, loss_ss: 1.337821, loss_d: 0.057214
Epoch finished! Loss: 1.082720964230024
Starting epoch 5/10.
0.0000 --- loss: 1.122243, loss_ss: 0.617498, loss_d: 0.504745
0.0384 --- loss: 1.010386, loss_ss: 0.839852, loss_d: 0.170534
0.0769 --- loss: 1.281940, loss_ss: 0.868569, loss_d: 0.413371
0.1153 --- loss: 0.788831, loss_ss: 0.741398, loss_d: 0.047432
0.1538 --- loss: 0.919433, loss_ss: 0.881198, loss_d: 0.038235
0.1922 --- loss: 0.891972, loss_ss: 0.808252, loss_d: 0.083721
0.2307 --- loss: 1.140753, loss_ss: 0.917166, loss_d: 0.223587
0.2691 --- loss: 1.005592, loss_ss: 0.987422, loss_d: 0.018170
0.3076 --- loss: 0.921585, loss_ss: 0.890668, loss_d: 0.030917
0.3460 --- loss: 1.063419, loss_ss: 0.668028, loss_d: 0.395390
0.3845 --- loss: 0.977411, loss_ss: 0.782075, loss_d: 0.195336
0.4229 --- loss: 1.109128, loss_ss: 0.890574, loss_d: 0.218555
0.4614 --- loss: 0.824133, loss_ss: 0.751692, loss_d: 0.072441
0.4998 --- loss: 1.335040, loss_ss: 0.890526, loss_d: 0.444514
0.5383 --- loss: 1.029406, loss_ss: 0.759538, loss_d: 0.269868
0.5767 --- loss: 0.824108, loss_ss: 0.725572, loss_d: 0.098536
0.6151 --- loss: 1.215365, loss_ss: 0.597994, loss_d: 0.617371
0.6536 --- loss: 0.892612, loss_ss: 0.822793, loss_d: 0.069819
0.6920 --- loss: 1.256136, loss_ss: 1.010897, loss_d: 0.245239
0.7305 --- loss: 0.798275, loss_ss: 0.738913, loss_d: 0.059363
0.7689 --- loss: 1.028958, loss_ss: 0.945448, loss_d: 0.083510
0.8074 --- loss: 0.802435, loss_ss: 0.619980, loss_d: 0.182455
0.8458 --- loss: 1.170598, loss_ss: 1.085231, loss_d: 0.085367
0.8843 --- loss: 1.087361, loss_ss: 0.733896, loss_d: 0.353464
0.9227 --- loss: 1.590319, loss_ss: 1.023430, loss_d: 0.566889
0.9612 --- loss: 0.990558, loss_ss: 0.920061, loss_d: 0.070497
0.9996 --- loss: 5.741223, loss_ss: 1.365280, loss_d: 4.375943
Epoch finished! Loss: 1.0499842173778093
Starting epoch 6/10.
0.0000 --- loss: 0.988988, loss_ss: 0.723758, loss_d: 0.265230
0.0384 --- loss: 1.122071, loss_ss: 0.880211, loss_d: 0.241860
0.0769 --- loss: 0.800306, loss_ss: 0.675736, loss_d: 0.124570
0.1153 --- loss: 1.154707, loss_ss: 0.939945, loss_d: 0.214762
0.1538 --- loss: 0.763364, loss_ss: 0.721695, loss_d: 0.041669
0.1922 --- loss: 1.188733, loss_ss: 0.813449, loss_d: 0.375284
0.2307 --- loss: 1.357799, loss_ss: 0.625396, loss_d: 0.732403
0.2691 --- loss: 1.010391, loss_ss: 0.968302, loss_d: 0.042089
0.3076 --- loss: 0.945256, loss_ss: 0.661725, loss_d: 0.283531
0.3460 --- loss: 0.704293, loss_ss: 0.456017, loss_d: 0.248276
0.3845 --- loss: 0.573577, loss_ss: 0.499382, loss_d: 0.074195
0.4229 --- loss: 0.598970, loss_ss: 0.554660, loss_d: 0.044310
0.4614 --- loss: 1.052491, loss_ss: 0.868708, loss_d: 0.183783
0.4998 --- loss: 0.869304, loss_ss: 0.722552, loss_d: 0.146752
0.5383 --- loss: 0.823859, loss_ss: 0.662475, loss_d: 0.161384
0.5767 --- loss: 1.104453, loss_ss: 1.068293, loss_d: 0.036159
0.6151 --- loss: 0.735915, loss_ss: 0.694699, loss_d: 0.041216
0.6536 --- loss: 0.739892, loss_ss: 0.714602, loss_d: 0.025290
0.6920 --- loss: 1.107691, loss_ss: 0.649994, loss_d: 0.457698
0.7305 --- loss: 0.712423, loss_ss: 0.652175, loss_d: 0.060248
0.7689 --- loss: 0.795300, loss_ss: 0.588557, loss_d: 0.206743
0.8074 --- loss: 0.803898, loss_ss: 0.771851, loss_d: 0.032047
0.8458 --- loss: 0.827980, loss_ss: 0.696886, loss_d: 0.131093
0.8843 --- loss: 0.741478, loss_ss: 0.722055, loss_d: 0.019423
0.9227 --- loss: 0.837097, loss_ss: 0.629591, loss_d: 0.207506
0.9612 --- loss: 1.031619, loss_ss: 1.006840, loss_d: 0.024779
0.9996 --- loss: 1.307954, loss_ss: 1.261449, loss_d: 0.046505
Epoch finished! Loss: 0.9864874491324791
Starting epoch 7/10.
0.0000 --- loss: 1.054124, loss_ss: 0.717289, loss_d: 0.336836
0.0384 --- loss: 0.927509, loss_ss: 0.784141, loss_d: 0.143368
0.0769 --- loss: 0.934186, loss_ss: 0.852924, loss_d: 0.081262
0.1153 --- loss: 1.108386, loss_ss: 1.033741, loss_d: 0.074645
0.1538 --- loss: 0.835394, loss_ss: 0.761932, loss_d: 0.073462
0.1922 --- loss: 0.667657, loss_ss: 0.648295, loss_d: 0.019361
0.2307 --- loss: 0.785633, loss_ss: 0.625161, loss_d: 0.160472
0.2691 --- loss: 1.042929, loss_ss: 0.645766, loss_d: 0.397163
0.3076 --- loss: 0.931918, loss_ss: 0.800838, loss_d: 0.131079
0.3460 --- loss: 1.261420, loss_ss: 1.200588, loss_d: 0.060832
0.3845 --- loss: 0.786138, loss_ss: 0.749217, loss_d: 0.036921
0.4229 --- loss: 0.869741, loss_ss: 0.817380, loss_d: 0.052361
0.4614 --- loss: 0.946423, loss_ss: 0.930187, loss_d: 0.016236
0.4998 --- loss: 0.766827, loss_ss: 0.640814, loss_d: 0.126013
0.5383 --- loss: 0.813439, loss_ss: 0.791720, loss_d: 0.021719
0.5767 --- loss: 1.327324, loss_ss: 0.883126, loss_d: 0.444198
0.6151 --- loss: 0.815337, loss_ss: 0.768367, loss_d: 0.046969
0.6536 --- loss: 0.789330, loss_ss: 0.761790, loss_d: 0.027540
0.6920 --- loss: 0.872554, loss_ss: 0.668060, loss_d: 0.204494
0.7305 --- loss: 0.717196, loss_ss: 0.688224, loss_d: 0.028972
0.7689 --- loss: 0.806219, loss_ss: 0.539094, loss_d: 0.267125
0.8074 --- loss: 0.995521, loss_ss: 0.801850, loss_d: 0.193671
0.8458 --- loss: 0.768962, loss_ss: 0.730976, loss_d: 0.037986
0.8843 --- loss: 0.910313, loss_ss: 0.786690, loss_d: 0.123623
0.9227 --- loss: 0.861178, loss_ss: 0.830602, loss_d: 0.030575
0.9612 --- loss: 0.567077, loss_ss: 0.550371, loss_d: 0.016706
0.9996 --- loss: 2.776716, loss_ss: 2.733967, loss_d: 0.042749
Epoch finished! Loss: 0.9454291210724757
Starting epoch 8/10.
0.0000 --- loss: 1.145077, loss_ss: 1.124630, loss_d: 0.020447
0.0384 --- loss: 0.752252, loss_ss: 0.633016, loss_d: 0.119236
0.0769 --- loss: 0.741123, loss_ss: 0.722510, loss_d: 0.018613
0.1153 --- loss: 1.045309, loss_ss: 0.855030, loss_d: 0.190279
0.1538 --- loss: 0.869879, loss_ss: 0.850478, loss_d: 0.019401
0.1922 --- loss: 1.204335, loss_ss: 1.178453, loss_d: 0.025883
0.2307 --- loss: 0.591859, loss_ss: 0.573951, loss_d: 0.017908
0.2691 --- loss: 1.117570, loss_ss: 1.038819, loss_d: 0.078751
0.3076 --- loss: 0.705614, loss_ss: 0.511949, loss_d: 0.193665
0.3460 --- loss: 1.142482, loss_ss: 0.869836, loss_d: 0.272646
0.3845 --- loss: 1.397728, loss_ss: 0.799777, loss_d: 0.597951
0.4229 --- loss: 0.519392, loss_ss: 0.510587, loss_d: 0.008805
0.4614 --- loss: 1.183768, loss_ss: 0.920547, loss_d: 0.263221
0.4998 --- loss: 1.043503, loss_ss: 0.755092, loss_d: 0.288411
0.5383 --- loss: 0.859506, loss_ss: 0.811844, loss_d: 0.047663
0.5767 --- loss: 1.074470, loss_ss: 0.853405, loss_d: 0.221065
0.6151 --- loss: 0.701861, loss_ss: 0.654089, loss_d: 0.047772
0.6536 --- loss: 0.781312, loss_ss: 0.774141, loss_d: 0.007171
0.6920 --- loss: 0.907108, loss_ss: 0.801523, loss_d: 0.105585
0.7305 --- loss: 1.049741, loss_ss: 0.871295, loss_d: 0.178446
0.7689 --- loss: 0.784386, loss_ss: 0.758604, loss_d: 0.025782
0.8074 --- loss: 0.765690, loss_ss: 0.727907, loss_d: 0.037783
0.8458 --- loss: 0.842730, loss_ss: 0.697738, loss_d: 0.144992
0.8843 --- loss: 1.117139, loss_ss: 1.084113, loss_d: 0.033026
0.9227 --- loss: 0.871428, loss_ss: 0.843993, loss_d: 0.027434
0.9612 --- loss: 1.385407, loss_ss: 1.179938, loss_d: 0.205469
0.9996 --- loss: 4.077819, loss_ss: 0.993338, loss_d: 3.084482
Epoch finished! Loss: 0.9300737222799889
Starting epoch 9/10.
0.0000 --- loss: 0.882158, loss_ss: 0.703162, loss_d: 0.178996
0.0384 --- loss: 0.894920, loss_ss: 0.644945, loss_d: 0.249975
0.0769 --- loss: 0.986986, loss_ss: 0.572728, loss_d: 0.414258
0.1153 --- loss: 0.678161, loss_ss: 0.649930, loss_d: 0.028231
0.1538 --- loss: 0.807636, loss_ss: 0.472411, loss_d: 0.335225
0.1922 --- loss: 1.281631, loss_ss: 1.115772, loss_d: 0.165860
0.2307 --- loss: 0.680432, loss_ss: 0.528687, loss_d: 0.151745
0.2691 --- loss: 0.981540, loss_ss: 0.799758, loss_d: 0.181782
0.3076 --- loss: 1.104048, loss_ss: 0.880339, loss_d: 0.223710
0.3460 --- loss: 0.851225, loss_ss: 0.776152, loss_d: 0.075073
0.3845 --- loss: 1.050985, loss_ss: 0.911677, loss_d: 0.139309
0.4229 --- loss: 0.873382, loss_ss: 0.834035, loss_d: 0.039347
0.4614 --- loss: 0.784596, loss_ss: 0.660446, loss_d: 0.124150
0.4998 --- loss: 0.938916, loss_ss: 0.874331, loss_d: 0.064585
0.5383 --- loss: 0.649001, loss_ss: 0.643887, loss_d: 0.005114
0.5767 --- loss: 0.985527, loss_ss: 0.887823, loss_d: 0.097704
0.6151 --- loss: 0.955267, loss_ss: 0.899529, loss_d: 0.055738
0.6536 --- loss: 0.859772, loss_ss: 0.858414, loss_d: 0.001358
0.6920 --- loss: 0.892435, loss_ss: 0.857137, loss_d: 0.035298
0.7305 --- loss: 0.910179, loss_ss: 0.787353, loss_d: 0.122826
0.7689 --- loss: 0.695491, loss_ss: 0.595633, loss_d: 0.099858
0.8074 --- loss: 0.846051, loss_ss: 0.640867, loss_d: 0.205183
0.8458 --- loss: 0.507655, loss_ss: 0.469351, loss_d: 0.038304
0.8843 --- loss: 0.830237, loss_ss: 0.700753, loss_d: 0.129484
0.9227 --- loss: 0.698880, loss_ss: 0.689265, loss_d: 0.009615
0.9612 --- loss: 1.105618, loss_ss: 0.978364, loss_d: 0.127254
0.9996 --- loss: 1.924445, loss_ss: 1.917994, loss_d: 0.006451
Epoch finished! Loss: 0.902551418198989
Starting epoch 10/10.
0.0000 --- loss: 0.689493, loss_ss: 0.661823, loss_d: 0.027670
0.0384 --- loss: 1.028180, loss_ss: 1.014932, loss_d: 0.013248
0.0769 --- loss: 0.707594, loss_ss: 0.607581, loss_d: 0.100013
0.1153 --- loss: 0.615150, loss_ss: 0.600000, loss_d: 0.015150
0.1538 --- loss: 0.830745, loss_ss: 0.741060, loss_d: 0.089685
0.1922 --- loss: 0.739735, loss_ss: 0.725625, loss_d: 0.014110
0.2307 --- loss: 0.819686, loss_ss: 0.816168, loss_d: 0.003518
0.2691 --- loss: 0.915241, loss_ss: 0.899665, loss_d: 0.015576
0.3076 --- loss: 0.791483, loss_ss: 0.761716, loss_d: 0.029767
0.3460 --- loss: 0.837328, loss_ss: 0.832140, loss_d: 0.005188
0.3845 --- loss: 0.794074, loss_ss: 0.793209, loss_d: 0.000865
0.4229 --- loss: 0.500183, loss_ss: 0.464682, loss_d: 0.035501
0.4614 --- loss: 0.851062, loss_ss: 0.598252, loss_d: 0.252809
0.4998 --- loss: 0.704334, loss_ss: 0.698074, loss_d: 0.006260
0.5383 --- loss: 0.760737, loss_ss: 0.752760, loss_d: 0.007977
0.5767 --- loss: 0.756202, loss_ss: 0.653434, loss_d: 0.102768
0.6151 --- loss: 0.783865, loss_ss: 0.769281, loss_d: 0.014585
0.6536 --- loss: 0.925139, loss_ss: 0.465009, loss_d: 0.460129
0.6920 --- loss: 0.977423, loss_ss: 0.971363, loss_d: 0.006060
0.7305 --- loss: 0.548375, loss_ss: 0.542052, loss_d: 0.006323
0.7689 --- loss: 1.044684, loss_ss: 1.018243, loss_d: 0.026441
0.8074 --- loss: 0.574761, loss_ss: 0.561854, loss_d: 0.012907
0.8458 --- loss: 0.913471, loss_ss: 0.871749, loss_d: 0.041722
0.8843 --- loss: 0.548210, loss_ss: 0.535717, loss_d: 0.012493
0.9227 --- loss: 0.972145, loss_ss: 0.948366, loss_d: 0.023779
0.9612 --- loss: 1.316159, loss_ss: 1.233683, loss_d: 0.082476
0.9996 --- loss: 1.057901, loss_ss: 1.056944, loss_d: 0.000957
Epoch finished! Loss: 0.8610913013036434
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6945945945945946
             precision    recall  f1-score   support

        0.0       0.49      0.90      0.64       153
        1.0       0.46      0.12      0.20       232
        2.0       0.86      0.81      0.84       441
        3.0       0.99      0.76      0.86        93
        4.0       0.62      0.93      0.75       191

avg / total       0.70      0.69      0.66      1110
 


====== chp042-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.86  89.54   85.27  49.28     63.57
1  78.65  12.50   96.13  46.03     19.66
2  87.39  80.95   91.63  86.44     83.61
3  97.93  76.34   99.90  98.61     86.06
4  89.10  92.67   88.36  62.32     74.53
Total accuracy: 69.46%
Average sen: 70.40%
Average spec: 92.26%
Macro f1-score: 65.49%
Diagnosis acc on 15mins: 1.0
[0.99999785 0.99999952 0.99996161 0.99999988 1.         1.
 1.         1.         1.         1.         1.         0.99999988
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         0.99987102
 0.99998343 0.99999988 1.         1.         1.         1.
 1.         1.         1.         0.99999964 1.         1.
 1.        ]
pred: 0.9999949384380031, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.300047, loss_ss: 1.621528, loss_d: 0.678519
0.0385 --- loss: 2.080967, loss_ss: 1.502146, loss_d: 0.578822
0.0770 --- loss: 2.195755, loss_ss: 1.649670, loss_d: 0.546085
0.1155 --- loss: 1.925190, loss_ss: 1.461005, loss_d: 0.464185
0.1540 --- loss: 2.046196, loss_ss: 1.391765, loss_d: 0.654431
0.1925 --- loss: 2.071370, loss_ss: 1.517462, loss_d: 0.553908
0.2309 --- loss: 2.160079, loss_ss: 1.495362, loss_d: 0.664717
0.2694 --- loss: 1.967455, loss_ss: 1.369350, loss_d: 0.598105
0.3079 --- loss: 1.903872, loss_ss: 1.277254, loss_d: 0.626618
0.3464 --- loss: 1.870651, loss_ss: 1.302849, loss_d: 0.567802
0.3849 --- loss: 1.740687, loss_ss: 1.313981, loss_d: 0.426706
0.4234 --- loss: 1.827957, loss_ss: 1.258558, loss_d: 0.569399
0.4619 --- loss: 1.977859, loss_ss: 1.333300, loss_d: 0.644559
0.5004 --- loss: 1.854028, loss_ss: 1.366179, loss_d: 0.487848
0.5389 --- loss: 1.750116, loss_ss: 1.366729, loss_d: 0.383387
0.5774 --- loss: 1.709134, loss_ss: 1.238592, loss_d: 0.470543
0.6159 --- loss: 1.760735, loss_ss: 1.184195, loss_d: 0.576539
0.6543 --- loss: 1.863351, loss_ss: 1.152821, loss_d: 0.710530
0.6928 --- loss: 1.619192, loss_ss: 1.115923, loss_d: 0.503269
0.7313 --- loss: 1.812501, loss_ss: 1.423011, loss_d: 0.389491
0.7698 --- loss: 1.777658, loss_ss: 1.111080, loss_d: 0.666579
0.8083 --- loss: 1.848810, loss_ss: 1.160117, loss_d: 0.688693
0.8468 --- loss: 1.776713, loss_ss: 1.312175, loss_d: 0.464539
0.8853 --- loss: 1.688074, loss_ss: 1.305933, loss_d: 0.382140
0.9238 --- loss: 1.694546, loss_ss: 1.108216, loss_d: 0.586330
0.9623 --- loss: 1.641346, loss_ss: 1.264869, loss_d: 0.376477
Epoch finished! Loss: 1.8813659357748436
Starting epoch 2/10.
0.0000 --- loss: 1.492563, loss_ss: 1.090014, loss_d: 0.402550
0.0385 --- loss: 1.272702, loss_ss: 1.009952, loss_d: 0.262751
0.0770 --- loss: 1.314719, loss_ss: 0.950906, loss_d: 0.363814
0.1155 --- loss: 1.610875, loss_ss: 1.111417, loss_d: 0.499458
0.1540 --- loss: 1.415404, loss_ss: 1.110768, loss_d: 0.304636
0.1925 --- loss: 1.130885, loss_ss: 1.043595, loss_d: 0.087289
0.2309 --- loss: 1.211717, loss_ss: 1.084508, loss_d: 0.127209
0.2694 --- loss: 1.222386, loss_ss: 0.971510, loss_d: 0.250876
0.3079 --- loss: 1.295421, loss_ss: 1.087146, loss_d: 0.208275
0.3464 --- loss: 1.308869, loss_ss: 0.922999, loss_d: 0.385870
0.3849 --- loss: 1.511021, loss_ss: 1.261485, loss_d: 0.249536
0.4234 --- loss: 1.439005, loss_ss: 1.182346, loss_d: 0.256659
0.4619 --- loss: 1.161172, loss_ss: 0.978611, loss_d: 0.182561
0.5004 --- loss: 1.205175, loss_ss: 0.953240, loss_d: 0.251935
0.5389 --- loss: 1.265387, loss_ss: 0.799024, loss_d: 0.466362
0.5774 --- loss: 1.273727, loss_ss: 0.968151, loss_d: 0.305576
0.6159 --- loss: 0.995780, loss_ss: 0.804428, loss_d: 0.191352
0.6543 --- loss: 1.184015, loss_ss: 0.823880, loss_d: 0.360135
0.6928 --- loss: 0.971029, loss_ss: 0.910883, loss_d: 0.060146
0.7313 --- loss: 1.169291, loss_ss: 0.967083, loss_d: 0.202208
0.7698 --- loss: 1.648545, loss_ss: 1.204968, loss_d: 0.443577
0.8083 --- loss: 1.182198, loss_ss: 0.900907, loss_d: 0.281291
0.8468 --- loss: 1.095648, loss_ss: 0.801131, loss_d: 0.294517
0.8853 --- loss: 1.265461, loss_ss: 0.968679, loss_d: 0.296783
0.9238 --- loss: 0.983731, loss_ss: 0.933773, loss_d: 0.049958
0.9623 --- loss: 0.942452, loss_ss: 0.796044, loss_d: 0.146407
Epoch finished! Loss: 1.3617375983234539
Starting epoch 3/10.
0.0000 --- loss: 0.955602, loss_ss: 0.830521, loss_d: 0.125080
0.0385 --- loss: 0.936135, loss_ss: 0.781513, loss_d: 0.154622
0.0770 --- loss: 1.126693, loss_ss: 0.846867, loss_d: 0.279825
0.1155 --- loss: 1.385751, loss_ss: 0.847018, loss_d: 0.538733
0.1540 --- loss: 1.289054, loss_ss: 0.962727, loss_d: 0.326327
0.1925 --- loss: 1.071539, loss_ss: 0.847711, loss_d: 0.223829
0.2309 --- loss: 1.329375, loss_ss: 1.170332, loss_d: 0.159043
0.2694 --- loss: 1.295174, loss_ss: 0.863958, loss_d: 0.431216
0.3079 --- loss: 1.210665, loss_ss: 0.908671, loss_d: 0.301994
0.3464 --- loss: 1.062777, loss_ss: 1.005193, loss_d: 0.057583
0.3849 --- loss: 1.297314, loss_ss: 1.022370, loss_d: 0.274944
0.4234 --- loss: 0.939030, loss_ss: 0.791588, loss_d: 0.147442
0.4619 --- loss: 1.136439, loss_ss: 0.904981, loss_d: 0.231458
0.5004 --- loss: 1.272793, loss_ss: 0.963845, loss_d: 0.308948
0.5389 --- loss: 1.173895, loss_ss: 0.923590, loss_d: 0.250305
0.5774 --- loss: 0.875531, loss_ss: 0.683981, loss_d: 0.191550
0.6159 --- loss: 0.933610, loss_ss: 0.740919, loss_d: 0.192691
0.6543 --- loss: 1.055838, loss_ss: 1.005874, loss_d: 0.049964
0.6928 --- loss: 1.168878, loss_ss: 1.123190, loss_d: 0.045688
0.7313 --- loss: 0.875396, loss_ss: 0.711609, loss_d: 0.163787
0.7698 --- loss: 1.234338, loss_ss: 0.768826, loss_d: 0.465511
0.8083 --- loss: 1.312545, loss_ss: 0.673147, loss_d: 0.639398
0.8468 --- loss: 1.595648, loss_ss: 0.927658, loss_d: 0.667990
0.8853 --- loss: 0.818888, loss_ss: 0.728368, loss_d: 0.090520
0.9238 --- loss: 1.022096, loss_ss: 0.625087, loss_d: 0.397010
0.9623 --- loss: 1.219305, loss_ss: 0.875301, loss_d: 0.344004
Epoch finished! Loss: 1.1315376500825625
Starting epoch 4/10.
0.0000 --- loss: 0.799442, loss_ss: 0.718597, loss_d: 0.080844
0.0385 --- loss: 0.768492, loss_ss: 0.731798, loss_d: 0.036694
0.0770 --- loss: 0.967196, loss_ss: 0.842717, loss_d: 0.124479
0.1155 --- loss: 0.941935, loss_ss: 0.881680, loss_d: 0.060255
0.1540 --- loss: 1.143469, loss_ss: 1.063923, loss_d: 0.079546
0.1925 --- loss: 0.858751, loss_ss: 0.704565, loss_d: 0.154185
0.2309 --- loss: 0.861807, loss_ss: 0.810869, loss_d: 0.050938
0.2694 --- loss: 1.404724, loss_ss: 1.199690, loss_d: 0.205034
0.3079 --- loss: 1.128536, loss_ss: 0.940597, loss_d: 0.187939
0.3464 --- loss: 1.529469, loss_ss: 1.213352, loss_d: 0.316117
0.3849 --- loss: 1.423713, loss_ss: 1.278121, loss_d: 0.145592
0.4234 --- loss: 0.955242, loss_ss: 0.666247, loss_d: 0.288995
0.4619 --- loss: 1.021378, loss_ss: 0.694802, loss_d: 0.326576
0.5004 --- loss: 1.432866, loss_ss: 0.831189, loss_d: 0.601677
0.5389 --- loss: 0.856867, loss_ss: 0.817595, loss_d: 0.039272
0.5774 --- loss: 1.070484, loss_ss: 0.840605, loss_d: 0.229880
0.6159 --- loss: 1.091733, loss_ss: 0.921676, loss_d: 0.170057
0.6543 --- loss: 0.977481, loss_ss: 0.936586, loss_d: 0.040895
0.6928 --- loss: 0.816580, loss_ss: 0.772725, loss_d: 0.043856
0.7313 --- loss: 0.953542, loss_ss: 0.905160, loss_d: 0.048382
0.7698 --- loss: 0.863331, loss_ss: 0.702829, loss_d: 0.160502
0.8083 --- loss: 0.978986, loss_ss: 0.798878, loss_d: 0.180107
0.8468 --- loss: 1.131122, loss_ss: 0.918850, loss_d: 0.212271
0.8853 --- loss: 1.862385, loss_ss: 0.552347, loss_d: 1.310039
0.9238 --- loss: 0.754054, loss_ss: 0.634789, loss_d: 0.119265
0.9623 --- loss: 0.778186, loss_ss: 0.664651, loss_d: 0.113535
Epoch finished! Loss: 1.0306984807533648
Starting epoch 5/10.
0.0000 --- loss: 0.816629, loss_ss: 0.718836, loss_d: 0.097793
0.0385 --- loss: 0.689006, loss_ss: 0.486561, loss_d: 0.202445
0.0770 --- loss: 0.877702, loss_ss: 0.734937, loss_d: 0.142765
0.1155 --- loss: 1.050242, loss_ss: 0.873868, loss_d: 0.176375
0.1540 --- loss: 1.516855, loss_ss: 1.331532, loss_d: 0.185324
0.1925 --- loss: 1.697842, loss_ss: 0.692526, loss_d: 1.005316
0.2309 --- loss: 0.823335, loss_ss: 0.769126, loss_d: 0.054210
0.2694 --- loss: 1.106134, loss_ss: 0.894973, loss_d: 0.211161
0.3079 --- loss: 0.871107, loss_ss: 0.754310, loss_d: 0.116796
0.3464 --- loss: 0.722960, loss_ss: 0.640053, loss_d: 0.082907
0.3849 --- loss: 1.028828, loss_ss: 0.972461, loss_d: 0.056367
0.4234 --- loss: 1.121065, loss_ss: 1.036299, loss_d: 0.084766
0.4619 --- loss: 1.620655, loss_ss: 0.929667, loss_d: 0.690988
0.5004 --- loss: 1.049361, loss_ss: 0.773507, loss_d: 0.275854
0.5389 --- loss: 1.351254, loss_ss: 1.121438, loss_d: 0.229816
0.5774 --- loss: 1.070595, loss_ss: 0.916913, loss_d: 0.153681
0.6159 --- loss: 0.996319, loss_ss: 0.837576, loss_d: 0.158743
0.6543 --- loss: 1.167975, loss_ss: 1.094163, loss_d: 0.073812
0.6928 --- loss: 0.928787, loss_ss: 0.874965, loss_d: 0.053822
0.7313 --- loss: 0.763767, loss_ss: 0.658435, loss_d: 0.105332
0.7698 --- loss: 0.841882, loss_ss: 0.609180, loss_d: 0.232702
0.8083 --- loss: 1.008570, loss_ss: 0.691130, loss_d: 0.317440
0.8468 --- loss: 0.959739, loss_ss: 0.861523, loss_d: 0.098216
0.8853 --- loss: 0.777400, loss_ss: 0.755932, loss_d: 0.021468
0.9238 --- loss: 0.733368, loss_ss: 0.694694, loss_d: 0.038673
0.9623 --- loss: 0.830278, loss_ss: 0.783088, loss_d: 0.047189
Epoch finished! Loss: 0.9982199591789467
Starting epoch 6/10.
0.0000 --- loss: 0.837965, loss_ss: 0.782938, loss_d: 0.055027
0.0385 --- loss: 1.098350, loss_ss: 0.648368, loss_d: 0.449982
0.0770 --- loss: 0.684502, loss_ss: 0.639624, loss_d: 0.044878
0.1155 --- loss: 0.910594, loss_ss: 0.749331, loss_d: 0.161263
0.1540 --- loss: 0.771100, loss_ss: 0.740371, loss_d: 0.030729
0.1925 --- loss: 1.084658, loss_ss: 1.069316, loss_d: 0.015342
0.2309 --- loss: 1.019872, loss_ss: 0.978939, loss_d: 0.040933
0.2694 --- loss: 0.988845, loss_ss: 0.905468, loss_d: 0.083378
0.3079 --- loss: 0.867191, loss_ss: 0.672240, loss_d: 0.194951
0.3464 --- loss: 0.653054, loss_ss: 0.646910, loss_d: 0.006144
0.3849 --- loss: 0.767424, loss_ss: 0.691946, loss_d: 0.075478
0.4234 --- loss: 1.200861, loss_ss: 0.909016, loss_d: 0.291845
0.4619 --- loss: 0.742597, loss_ss: 0.698668, loss_d: 0.043929
0.5004 --- loss: 0.718021, loss_ss: 0.644882, loss_d: 0.073139
0.5389 --- loss: 0.833672, loss_ss: 0.749162, loss_d: 0.084511
0.5774 --- loss: 0.901363, loss_ss: 0.796386, loss_d: 0.104978
0.6159 --- loss: 0.634774, loss_ss: 0.535940, loss_d: 0.098834
0.6543 --- loss: 0.697903, loss_ss: 0.691327, loss_d: 0.006576
0.6928 --- loss: 0.944830, loss_ss: 0.799007, loss_d: 0.145823
0.7313 --- loss: 0.785320, loss_ss: 0.733921, loss_d: 0.051399
0.7698 --- loss: 0.650084, loss_ss: 0.590613, loss_d: 0.059471
0.8083 --- loss: 1.315537, loss_ss: 1.103123, loss_d: 0.212413
0.8468 --- loss: 1.163508, loss_ss: 1.149071, loss_d: 0.014437
0.8853 --- loss: 0.691467, loss_ss: 0.673947, loss_d: 0.017520
0.9238 --- loss: 0.923230, loss_ss: 0.742411, loss_d: 0.180820
0.9623 --- loss: 0.991708, loss_ss: 0.584756, loss_d: 0.406952
Epoch finished! Loss: 0.897352769338026
Starting epoch 7/10.
0.0000 --- loss: 1.114275, loss_ss: 0.598310, loss_d: 0.515964
0.0385 --- loss: 0.584212, loss_ss: 0.575611, loss_d: 0.008602
0.0770 --- loss: 1.507660, loss_ss: 0.640992, loss_d: 0.866667
0.1155 --- loss: 0.792408, loss_ss: 0.501079, loss_d: 0.291329
0.1540 --- loss: 0.871401, loss_ss: 0.841499, loss_d: 0.029902
0.1925 --- loss: 1.022485, loss_ss: 1.000638, loss_d: 0.021847
0.2309 --- loss: 1.010847, loss_ss: 0.807441, loss_d: 0.203406
0.2694 --- loss: 0.784640, loss_ss: 0.717583, loss_d: 0.067057
0.3079 --- loss: 0.936392, loss_ss: 0.786859, loss_d: 0.149532
0.3464 --- loss: 0.675020, loss_ss: 0.607743, loss_d: 0.067277
0.3849 --- loss: 0.643248, loss_ss: 0.577451, loss_d: 0.065797
0.4234 --- loss: 0.771616, loss_ss: 0.681525, loss_d: 0.090091
0.4619 --- loss: 0.817858, loss_ss: 0.775289, loss_d: 0.042569
0.5004 --- loss: 0.726928, loss_ss: 0.684898, loss_d: 0.042030
0.5389 --- loss: 0.818353, loss_ss: 0.742567, loss_d: 0.075786
0.5774 --- loss: 0.761662, loss_ss: 0.745799, loss_d: 0.015864
0.6159 --- loss: 0.674633, loss_ss: 0.632144, loss_d: 0.042489
0.6543 --- loss: 0.855436, loss_ss: 0.802863, loss_d: 0.052573
0.6928 --- loss: 0.775212, loss_ss: 0.620917, loss_d: 0.154295
0.7313 --- loss: 0.882622, loss_ss: 0.868700, loss_d: 0.013922
0.7698 --- loss: 0.735606, loss_ss: 0.630693, loss_d: 0.104913
0.8083 --- loss: 0.850108, loss_ss: 0.776299, loss_d: 0.073809
0.8468 --- loss: 0.893206, loss_ss: 0.612354, loss_d: 0.280853
0.8853 --- loss: 0.770123, loss_ss: 0.700792, loss_d: 0.069331
0.9238 --- loss: 1.378193, loss_ss: 0.698819, loss_d: 0.679374
0.9623 --- loss: 1.320030, loss_ss: 1.060595, loss_d: 0.259435
Epoch finished! Loss: 0.8699379579440968
Starting epoch 8/10.
0.0000 --- loss: 0.653617, loss_ss: 0.588442, loss_d: 0.065175
0.0385 --- loss: 0.770293, loss_ss: 0.743100, loss_d: 0.027193
0.0770 --- loss: 0.958928, loss_ss: 0.852558, loss_d: 0.106370
0.1155 --- loss: 1.258508, loss_ss: 0.823241, loss_d: 0.435268
0.1540 --- loss: 1.262899, loss_ss: 0.752566, loss_d: 0.510333
0.1925 --- loss: 1.234642, loss_ss: 0.875355, loss_d: 0.359287
0.2309 --- loss: 1.012362, loss_ss: 0.990835, loss_d: 0.021528
0.2694 --- loss: 1.068069, loss_ss: 1.058671, loss_d: 0.009398
0.3079 --- loss: 0.750059, loss_ss: 0.682944, loss_d: 0.067115
0.3464 --- loss: 0.710906, loss_ss: 0.645032, loss_d: 0.065874
0.3849 --- loss: 1.089924, loss_ss: 1.055689, loss_d: 0.034234
0.4234 --- loss: 0.588530, loss_ss: 0.583667, loss_d: 0.004862
0.4619 --- loss: 0.785496, loss_ss: 0.776089, loss_d: 0.009406
0.5004 --- loss: 0.477668, loss_ss: 0.452294, loss_d: 0.025374
0.5389 --- loss: 0.868558, loss_ss: 0.697492, loss_d: 0.171065
0.5774 --- loss: 0.697164, loss_ss: 0.553782, loss_d: 0.143382
0.6159 --- loss: 1.005228, loss_ss: 0.992693, loss_d: 0.012535
0.6543 --- loss: 0.715968, loss_ss: 0.692494, loss_d: 0.023474
0.6928 --- loss: 0.865740, loss_ss: 0.804057, loss_d: 0.061683
0.7313 --- loss: 1.057393, loss_ss: 0.656456, loss_d: 0.400937
0.7698 --- loss: 1.066062, loss_ss: 0.752461, loss_d: 0.313601
0.8083 --- loss: 1.037114, loss_ss: 0.853307, loss_d: 0.183806
0.8468 --- loss: 0.781259, loss_ss: 0.743579, loss_d: 0.037679
0.8853 --- loss: 0.755905, loss_ss: 0.701103, loss_d: 0.054802
0.9238 --- loss: 0.846886, loss_ss: 0.835382, loss_d: 0.011504
0.9623 --- loss: 0.646002, loss_ss: 0.626398, loss_d: 0.019604
Epoch finished! Loss: 0.8559011584543353
Starting epoch 9/10.
0.0000 --- loss: 0.998478, loss_ss: 0.979587, loss_d: 0.018891
0.0385 --- loss: 0.946285, loss_ss: 0.846869, loss_d: 0.099416
0.0770 --- loss: 0.767440, loss_ss: 0.751815, loss_d: 0.015625
0.1155 --- loss: 0.604266, loss_ss: 0.581193, loss_d: 0.023073
0.1540 --- loss: 0.599225, loss_ss: 0.589148, loss_d: 0.010077
0.1925 --- loss: 0.731450, loss_ss: 0.670713, loss_d: 0.060737
0.2309 --- loss: 0.711032, loss_ss: 0.653876, loss_d: 0.057156
0.2694 --- loss: 0.785023, loss_ss: 0.634817, loss_d: 0.150206
0.3079 --- loss: 0.634835, loss_ss: 0.595108, loss_d: 0.039728
0.3464 --- loss: 0.710849, loss_ss: 0.700397, loss_d: 0.010452
0.3849 --- loss: 0.786893, loss_ss: 0.762007, loss_d: 0.024886
0.4234 --- loss: 0.743110, loss_ss: 0.709117, loss_d: 0.033993
0.4619 --- loss: 1.338975, loss_ss: 1.118108, loss_d: 0.220867
0.5004 --- loss: 0.822877, loss_ss: 0.807142, loss_d: 0.015734
0.5389 --- loss: 0.831099, loss_ss: 0.734973, loss_d: 0.096127
0.5774 --- loss: 0.629474, loss_ss: 0.553314, loss_d: 0.076160
0.6159 --- loss: 0.789517, loss_ss: 0.631607, loss_d: 0.157910
0.6543 --- loss: 0.754048, loss_ss: 0.609497, loss_d: 0.144551
0.6928 --- loss: 0.769296, loss_ss: 0.761136, loss_d: 0.008160
0.7313 --- loss: 0.974089, loss_ss: 0.654549, loss_d: 0.319539
0.7698 --- loss: 1.051290, loss_ss: 0.927105, loss_d: 0.124185
0.8083 --- loss: 0.888992, loss_ss: 0.827658, loss_d: 0.061333
0.8468 --- loss: 0.852285, loss_ss: 0.833025, loss_d: 0.019260
0.8853 --- loss: 1.389252, loss_ss: 0.667752, loss_d: 0.721500
0.9238 --- loss: 0.745091, loss_ss: 0.735894, loss_d: 0.009197
0.9623 --- loss: 0.637340, loss_ss: 0.628445, loss_d: 0.008895
Epoch finished! Loss: 0.8437686081558581
Starting epoch 10/10.
0.0000 --- loss: 0.474215, loss_ss: 0.463484, loss_d: 0.010731
0.0385 --- loss: 0.782696, loss_ss: 0.736717, loss_d: 0.045979
0.0770 --- loss: 0.601683, loss_ss: 0.583578, loss_d: 0.018105
0.1155 --- loss: 1.003471, loss_ss: 0.913658, loss_d: 0.089813
0.1540 --- loss: 0.890482, loss_ss: 0.764183, loss_d: 0.126299
0.1925 --- loss: 0.912883, loss_ss: 0.726214, loss_d: 0.186669
0.2309 --- loss: 0.936786, loss_ss: 0.930124, loss_d: 0.006662
0.2694 --- loss: 0.566635, loss_ss: 0.552858, loss_d: 0.013777
0.3079 --- loss: 0.886002, loss_ss: 0.880771, loss_d: 0.005231
0.3464 --- loss: 1.152769, loss_ss: 1.115402, loss_d: 0.037367
0.3849 --- loss: 0.841423, loss_ss: 0.737204, loss_d: 0.104219
0.4234 --- loss: 0.679798, loss_ss: 0.659404, loss_d: 0.020394
0.4619 --- loss: 0.720429, loss_ss: 0.709910, loss_d: 0.010519
0.5004 --- loss: 0.723500, loss_ss: 0.716912, loss_d: 0.006588
0.5389 --- loss: 0.633493, loss_ss: 0.612612, loss_d: 0.020881
0.5774 --- loss: 0.712016, loss_ss: 0.681286, loss_d: 0.030730
0.6159 --- loss: 0.674055, loss_ss: 0.618373, loss_d: 0.055682
0.6543 --- loss: 0.791123, loss_ss: 0.781740, loss_d: 0.009383
0.6928 --- loss: 1.162891, loss_ss: 0.725572, loss_d: 0.437319
0.7313 --- loss: 0.804533, loss_ss: 0.770917, loss_d: 0.033615
0.7698 --- loss: 0.654389, loss_ss: 0.578792, loss_d: 0.075598
0.8083 --- loss: 0.628320, loss_ss: 0.533649, loss_d: 0.094670
0.8468 --- loss: 0.543870, loss_ss: 0.539718, loss_d: 0.004152
0.8853 --- loss: 1.018693, loss_ss: 0.945668, loss_d: 0.073024
0.9238 --- loss: 1.017540, loss_ss: 0.733704, loss_d: 0.283835
0.9623 --- loss: 0.860340, loss_ss: 0.847613, loss_d: 0.012727
Epoch finished! Loss: 0.8251821939549391
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7333333333333333
             precision    recall  f1-score   support

        0.0       1.00      0.57      0.73       143
        1.0       0.54      0.50      0.52       197
        2.0       0.87      0.80      0.83       506
        3.0       1.00      0.36      0.53        64
        4.0       0.61      0.94      0.74       290

avg / total       0.78      0.73      0.73      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.92  57.34  100.00  100.00     72.89
1  84.67  49.75   91.53   53.55     51.58
2  86.58  79.84   91.50   87.26     83.38
3  96.58  35.94  100.00  100.00     52.87
4  83.92  94.14   80.66   60.80     73.88
Total accuracy: 73.33%
Average sen: 63.40%
Average spec: 92.74%
Macro f1-score: 66.92%
Diagnosis acc on 15mins: 1.0
[0.99933523 0.99976391 0.99996173 0.99716103 0.99835891 0.99997985
 0.9982059  0.98926872 0.99999452 0.99989283 0.99939668 0.99453342
 0.99926406 0.9999994  0.99997807 0.9998939  0.99995351 0.99999094
 0.99998081 0.99974447 0.99968243 0.99997008 0.99999285 0.99998426
 0.99999166 1.         1.         0.9999994  1.         1.
 0.99999905 0.99999785 0.99999964 0.9999795  0.99997115 0.99999976
 1.         1.         0.99994481 0.99997079]
pred: 0.9993535280227661, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.431287, loss_ss: 1.752042, loss_d: 0.679245
0.0384 --- loss: 2.057649, loss_ss: 1.546733, loss_d: 0.510915
0.0768 --- loss: 2.129317, loss_ss: 1.526139, loss_d: 0.603178
0.1153 --- loss: 2.790817, loss_ss: 1.515389, loss_d: 1.275428
0.1537 --- loss: 2.310856, loss_ss: 1.687185, loss_d: 0.623671
0.1921 --- loss: 1.900638, loss_ss: 1.383119, loss_d: 0.517519
0.2305 --- loss: 1.983264, loss_ss: 1.448437, loss_d: 0.534827
0.2689 --- loss: 1.864044, loss_ss: 1.321594, loss_d: 0.542449
0.3073 --- loss: 1.824713, loss_ss: 1.205311, loss_d: 0.619402
0.3458 --- loss: 1.631010, loss_ss: 1.284527, loss_d: 0.346482
0.3842 --- loss: 1.914265, loss_ss: 1.267042, loss_d: 0.647223
0.4226 --- loss: 1.681850, loss_ss: 1.179795, loss_d: 0.502054
0.4610 --- loss: 1.731305, loss_ss: 1.240677, loss_d: 0.490628
0.4994 --- loss: 1.553524, loss_ss: 1.183514, loss_d: 0.370009
0.5378 --- loss: 1.797610, loss_ss: 1.150576, loss_d: 0.647034
0.5763 --- loss: 1.658811, loss_ss: 1.120265, loss_d: 0.538547
0.6147 --- loss: 1.874617, loss_ss: 1.137745, loss_d: 0.736871
0.6531 --- loss: 1.891556, loss_ss: 1.316698, loss_d: 0.574858
0.6915 --- loss: 1.436827, loss_ss: 1.120130, loss_d: 0.316698
0.7299 --- loss: 1.909289, loss_ss: 1.187537, loss_d: 0.721752
0.7683 --- loss: 1.759504, loss_ss: 1.290856, loss_d: 0.468648
0.8068 --- loss: 1.511497, loss_ss: 1.074998, loss_d: 0.436498
0.8452 --- loss: 1.543395, loss_ss: 1.141699, loss_d: 0.401696
0.8836 --- loss: 1.551910, loss_ss: 1.015101, loss_d: 0.536809
0.9220 --- loss: 1.403392, loss_ss: 0.974365, loss_d: 0.429027
0.9604 --- loss: 1.742502, loss_ss: 1.142955, loss_d: 0.599548
0.9988 --- loss: 1.500223, loss_ss: 1.134762, loss_d: 0.365461
Epoch finished! Loss: 1.8333773237008315
Starting epoch 2/10.
0.0000 --- loss: 1.554516, loss_ss: 1.042678, loss_d: 0.511838
0.0384 --- loss: 1.533348, loss_ss: 1.150010, loss_d: 0.383338
0.0768 --- loss: 1.653917, loss_ss: 1.007134, loss_d: 0.646783
0.1153 --- loss: 1.352182, loss_ss: 0.994764, loss_d: 0.357418
0.1537 --- loss: 1.255926, loss_ss: 0.986157, loss_d: 0.269769
0.1921 --- loss: 1.253448, loss_ss: 1.047647, loss_d: 0.205802
0.2305 --- loss: 1.842013, loss_ss: 1.052537, loss_d: 0.789476
0.2689 --- loss: 1.186884, loss_ss: 1.005099, loss_d: 0.181785
0.3073 --- loss: 1.139526, loss_ss: 0.884502, loss_d: 0.255025
0.3458 --- loss: 1.109136, loss_ss: 0.865444, loss_d: 0.243692
0.3842 --- loss: 1.170826, loss_ss: 0.777498, loss_d: 0.393328
0.4226 --- loss: 1.157185, loss_ss: 0.902362, loss_d: 0.254823
0.4610 --- loss: 1.234275, loss_ss: 0.844096, loss_d: 0.390178
0.4994 --- loss: 1.550889, loss_ss: 0.899496, loss_d: 0.651393
0.5378 --- loss: 1.429714, loss_ss: 0.917704, loss_d: 0.512010
0.5763 --- loss: 1.042021, loss_ss: 0.887193, loss_d: 0.154827
0.6147 --- loss: 1.474180, loss_ss: 0.867871, loss_d: 0.606310
0.6531 --- loss: 1.188579, loss_ss: 1.066685, loss_d: 0.121894
0.6915 --- loss: 1.263672, loss_ss: 1.006523, loss_d: 0.257149
0.7299 --- loss: 0.952864, loss_ss: 0.832523, loss_d: 0.120341
0.7683 --- loss: 1.260938, loss_ss: 1.008821, loss_d: 0.252118
0.8068 --- loss: 0.942667, loss_ss: 0.812866, loss_d: 0.129802
0.8452 --- loss: 1.457805, loss_ss: 0.946835, loss_d: 0.510970
0.8836 --- loss: 0.909733, loss_ss: 0.843514, loss_d: 0.066219
0.9220 --- loss: 0.874799, loss_ss: 0.739015, loss_d: 0.135784
0.9604 --- loss: 1.190674, loss_ss: 0.951987, loss_d: 0.238687
0.9988 --- loss: 1.198025, loss_ss: 0.740035, loss_d: 0.457990
Epoch finished! Loss: 1.3305287370314964
Starting epoch 3/10.
0.0000 --- loss: 1.113579, loss_ss: 0.942912, loss_d: 0.170667
0.0384 --- loss: 1.445938, loss_ss: 1.251273, loss_d: 0.194664
0.0768 --- loss: 1.208093, loss_ss: 0.830495, loss_d: 0.377598
0.1153 --- loss: 1.154054, loss_ss: 0.975425, loss_d: 0.178630
0.1537 --- loss: 1.260076, loss_ss: 0.864022, loss_d: 0.396054
0.1921 --- loss: 1.029850, loss_ss: 0.856166, loss_d: 0.173684
0.2305 --- loss: 0.935153, loss_ss: 0.821358, loss_d: 0.113795
0.2689 --- loss: 0.904685, loss_ss: 0.737550, loss_d: 0.167135
0.3073 --- loss: 1.467967, loss_ss: 0.981052, loss_d: 0.486914
0.3458 --- loss: 1.256733, loss_ss: 1.027300, loss_d: 0.229433
0.3842 --- loss: 1.387747, loss_ss: 0.982272, loss_d: 0.405475
0.4226 --- loss: 1.017943, loss_ss: 0.911772, loss_d: 0.106170
0.4610 --- loss: 1.326819, loss_ss: 1.074191, loss_d: 0.252628
0.4994 --- loss: 0.942721, loss_ss: 0.862029, loss_d: 0.080693
0.5378 --- loss: 0.949951, loss_ss: 0.910523, loss_d: 0.039428
0.5763 --- loss: 1.068249, loss_ss: 0.913684, loss_d: 0.154565
0.6147 --- loss: 1.059376, loss_ss: 0.849458, loss_d: 0.209918
0.6531 --- loss: 0.922721, loss_ss: 0.782919, loss_d: 0.139802
0.6915 --- loss: 1.300035, loss_ss: 0.800853, loss_d: 0.499182
0.7299 --- loss: 1.157171, loss_ss: 0.853133, loss_d: 0.304038
0.7683 --- loss: 1.045781, loss_ss: 0.896171, loss_d: 0.149611
0.8068 --- loss: 1.049326, loss_ss: 0.828819, loss_d: 0.220508
0.8452 --- loss: 2.124453, loss_ss: 1.844361, loss_d: 0.280093
0.8836 --- loss: 1.051987, loss_ss: 0.994613, loss_d: 0.057374
0.9220 --- loss: 1.069900, loss_ss: 0.798228, loss_d: 0.271672
0.9604 --- loss: 1.032430, loss_ss: 0.949852, loss_d: 0.082577
0.9988 --- loss: 1.849099, loss_ss: 1.004383, loss_d: 0.844717
Epoch finished! Loss: 1.1310065024174176
Starting epoch 4/10.
0.0000 --- loss: 1.107496, loss_ss: 0.906481, loss_d: 0.201015
0.0384 --- loss: 0.880297, loss_ss: 0.832163, loss_d: 0.048133
0.0768 --- loss: 0.833231, loss_ss: 0.762170, loss_d: 0.071061
0.1153 --- loss: 0.783406, loss_ss: 0.749482, loss_d: 0.033923
0.1537 --- loss: 0.880312, loss_ss: 0.792236, loss_d: 0.088075
0.1921 --- loss: 0.800790, loss_ss: 0.775433, loss_d: 0.025356
0.2305 --- loss: 0.762815, loss_ss: 0.718424, loss_d: 0.044390
0.2689 --- loss: 1.324883, loss_ss: 0.896679, loss_d: 0.428204
0.3073 --- loss: 1.242060, loss_ss: 0.762201, loss_d: 0.479859
0.3458 --- loss: 0.806567, loss_ss: 0.711839, loss_d: 0.094728
0.3842 --- loss: 1.166503, loss_ss: 0.862967, loss_d: 0.303536
0.4226 --- loss: 1.047620, loss_ss: 0.888548, loss_d: 0.159072
0.4610 --- loss: 0.699022, loss_ss: 0.599582, loss_d: 0.099440
0.4994 --- loss: 1.230988, loss_ss: 1.019552, loss_d: 0.211436
0.5378 --- loss: 1.103210, loss_ss: 0.995600, loss_d: 0.107610
0.5763 --- loss: 1.166306, loss_ss: 0.854775, loss_d: 0.311531
0.6147 --- loss: 1.088736, loss_ss: 0.760834, loss_d: 0.327902
0.6531 --- loss: 0.991599, loss_ss: 0.930028, loss_d: 0.061571
0.6915 --- loss: 0.903344, loss_ss: 0.764597, loss_d: 0.138747
0.7299 --- loss: 0.674405, loss_ss: 0.540127, loss_d: 0.134277
0.7683 --- loss: 0.915269, loss_ss: 0.868888, loss_d: 0.046381
0.8068 --- loss: 0.947331, loss_ss: 0.900198, loss_d: 0.047133
0.8452 --- loss: 1.317863, loss_ss: 0.794561, loss_d: 0.523302
0.8836 --- loss: 1.473794, loss_ss: 0.974614, loss_d: 0.499180
0.9220 --- loss: 0.901352, loss_ss: 0.818854, loss_d: 0.082498
0.9604 --- loss: 1.109943, loss_ss: 1.007024, loss_d: 0.102919
0.9988 --- loss: 1.712305, loss_ss: 1.517582, loss_d: 0.194722
Epoch finished! Loss: 1.0352102426382213
Starting epoch 5/10.
0.0000 --- loss: 0.929484, loss_ss: 0.798677, loss_d: 0.130808
0.0384 --- loss: 0.905329, loss_ss: 0.841442, loss_d: 0.063886
0.0768 --- loss: 0.833953, loss_ss: 0.781871, loss_d: 0.052081
0.1153 --- loss: 0.605978, loss_ss: 0.569303, loss_d: 0.036675
0.1537 --- loss: 1.171120, loss_ss: 0.909545, loss_d: 0.261575
0.1921 --- loss: 0.735729, loss_ss: 0.636082, loss_d: 0.099647
0.2305 --- loss: 0.752422, loss_ss: 0.728011, loss_d: 0.024411
0.2689 --- loss: 0.719509, loss_ss: 0.674172, loss_d: 0.045337
0.3073 --- loss: 1.165499, loss_ss: 0.963493, loss_d: 0.202006
0.3458 --- loss: 0.829033, loss_ss: 0.797902, loss_d: 0.031131
0.3842 --- loss: 1.551704, loss_ss: 1.358526, loss_d: 0.193178
0.4226 --- loss: 0.785300, loss_ss: 0.595213, loss_d: 0.190087
0.4610 --- loss: 0.696757, loss_ss: 0.677219, loss_d: 0.019537
0.4994 --- loss: 1.026038, loss_ss: 0.983320, loss_d: 0.042718
0.5378 --- loss: 1.365534, loss_ss: 1.320614, loss_d: 0.044920
0.5763 --- loss: 0.992596, loss_ss: 0.907722, loss_d: 0.084874
0.6147 --- loss: 0.866784, loss_ss: 0.424242, loss_d: 0.442542
0.6531 --- loss: 0.806943, loss_ss: 0.783895, loss_d: 0.023047
0.6915 --- loss: 0.836249, loss_ss: 0.787436, loss_d: 0.048813
0.7299 --- loss: 0.767278, loss_ss: 0.737698, loss_d: 0.029580
0.7683 --- loss: 1.122725, loss_ss: 1.087946, loss_d: 0.034779
0.8068 --- loss: 1.089726, loss_ss: 1.032334, loss_d: 0.057392
0.8452 --- loss: 1.083945, loss_ss: 0.954920, loss_d: 0.129025
0.8836 --- loss: 0.988470, loss_ss: 0.917977, loss_d: 0.070493
0.9220 --- loss: 1.103136, loss_ss: 0.632894, loss_d: 0.470242
0.9604 --- loss: 0.763603, loss_ss: 0.674179, loss_d: 0.089424
0.9988 --- loss: 1.158955, loss_ss: 0.979103, loss_d: 0.179852
Epoch finished! Loss: 0.9742201463534281
Starting epoch 6/10.
0.0000 --- loss: 0.827336, loss_ss: 0.663488, loss_d: 0.163848
0.0384 --- loss: 0.977143, loss_ss: 0.929230, loss_d: 0.047913
0.0768 --- loss: 0.919514, loss_ss: 0.868819, loss_d: 0.050696
0.1153 --- loss: 1.144816, loss_ss: 0.903133, loss_d: 0.241683
0.1537 --- loss: 1.163882, loss_ss: 0.844676, loss_d: 0.319206
0.1921 --- loss: 0.675821, loss_ss: 0.625065, loss_d: 0.050756
0.2305 --- loss: 1.402428, loss_ss: 1.226280, loss_d: 0.176148
0.2689 --- loss: 0.495912, loss_ss: 0.461177, loss_d: 0.034735
0.3073 --- loss: 0.957554, loss_ss: 0.809571, loss_d: 0.147983
0.3458 --- loss: 0.908878, loss_ss: 0.877669, loss_d: 0.031209
0.3842 --- loss: 0.727409, loss_ss: 0.656829, loss_d: 0.070580
0.4226 --- loss: 0.871766, loss_ss: 0.859415, loss_d: 0.012350
0.4610 --- loss: 0.745855, loss_ss: 0.708914, loss_d: 0.036941
0.4994 --- loss: 0.966597, loss_ss: 0.921180, loss_d: 0.045417
0.5378 --- loss: 0.764491, loss_ss: 0.728512, loss_d: 0.035979
0.5763 --- loss: 0.869110, loss_ss: 0.750058, loss_d: 0.119053
0.6147 --- loss: 0.998420, loss_ss: 0.760101, loss_d: 0.238319
0.6531 --- loss: 0.909211, loss_ss: 0.883348, loss_d: 0.025863
0.6915 --- loss: 0.960005, loss_ss: 0.688239, loss_d: 0.271766
0.7299 --- loss: 0.880446, loss_ss: 0.819258, loss_d: 0.061188
0.7683 --- loss: 0.757600, loss_ss: 0.719604, loss_d: 0.037996
0.8068 --- loss: 0.601360, loss_ss: 0.544802, loss_d: 0.056558
0.8452 --- loss: 0.655813, loss_ss: 0.630485, loss_d: 0.025327
0.8836 --- loss: 0.614801, loss_ss: 0.584605, loss_d: 0.030196
0.9220 --- loss: 0.869683, loss_ss: 0.662651, loss_d: 0.207031
0.9604 --- loss: 0.874732, loss_ss: 0.814077, loss_d: 0.060655
0.9988 --- loss: 0.921519, loss_ss: 0.917762, loss_d: 0.003757
Epoch finished! Loss: 0.9299603471389184
Starting epoch 7/10.
0.0000 --- loss: 0.629868, loss_ss: 0.611003, loss_d: 0.018864
0.0384 --- loss: 0.662552, loss_ss: 0.606669, loss_d: 0.055883
0.0768 --- loss: 0.808345, loss_ss: 0.790272, loss_d: 0.018073
0.1153 --- loss: 0.525016, loss_ss: 0.498108, loss_d: 0.026907
0.1537 --- loss: 0.855109, loss_ss: 0.739754, loss_d: 0.115355
0.1921 --- loss: 0.648117, loss_ss: 0.642419, loss_d: 0.005698
0.2305 --- loss: 0.972787, loss_ss: 0.922511, loss_d: 0.050276
0.2689 --- loss: 0.828493, loss_ss: 0.800919, loss_d: 0.027574
0.3073 --- loss: 0.854379, loss_ss: 0.851830, loss_d: 0.002549
0.3458 --- loss: 0.666279, loss_ss: 0.653109, loss_d: 0.013170
0.3842 --- loss: 0.719096, loss_ss: 0.689862, loss_d: 0.029234
0.4226 --- loss: 0.836364, loss_ss: 0.735233, loss_d: 0.101130
0.4610 --- loss: 0.801682, loss_ss: 0.761926, loss_d: 0.039756
0.4994 --- loss: 1.063144, loss_ss: 0.894894, loss_d: 0.168250
0.5378 --- loss: 0.993548, loss_ss: 0.458084, loss_d: 0.535464
0.5763 --- loss: 0.638806, loss_ss: 0.630242, loss_d: 0.008564
0.6147 --- loss: 1.322276, loss_ss: 1.050159, loss_d: 0.272117
0.6531 --- loss: 1.074047, loss_ss: 0.860042, loss_d: 0.214006
0.6915 --- loss: 0.749929, loss_ss: 0.734246, loss_d: 0.015683
0.7299 --- loss: 0.621869, loss_ss: 0.549095, loss_d: 0.072774
0.7683 --- loss: 1.169911, loss_ss: 1.134118, loss_d: 0.035793
0.8068 --- loss: 0.805674, loss_ss: 0.772578, loss_d: 0.033096
0.8452 --- loss: 1.127843, loss_ss: 0.964591, loss_d: 0.163251
0.8836 --- loss: 0.912743, loss_ss: 0.787537, loss_d: 0.125206
0.9220 --- loss: 0.923446, loss_ss: 0.877377, loss_d: 0.046069
0.9604 --- loss: 0.804730, loss_ss: 0.787913, loss_d: 0.016817
0.9988 --- loss: 1.999184, loss_ss: 1.957511, loss_d: 0.041673
Epoch finished! Loss: 0.8911864656668443
Starting epoch 8/10.
0.0000 --- loss: 0.873678, loss_ss: 0.843478, loss_d: 0.030201
0.0384 --- loss: 0.684566, loss_ss: 0.670879, loss_d: 0.013686
0.0768 --- loss: 0.644446, loss_ss: 0.640814, loss_d: 0.003631
0.1153 --- loss: 0.771483, loss_ss: 0.743792, loss_d: 0.027691
0.1537 --- loss: 1.324456, loss_ss: 0.763226, loss_d: 0.561230
0.1921 --- loss: 0.705078, loss_ss: 0.657910, loss_d: 0.047168
0.2305 --- loss: 0.808165, loss_ss: 0.715980, loss_d: 0.092185
0.2689 --- loss: 0.991316, loss_ss: 0.852742, loss_d: 0.138575
0.3073 --- loss: 0.790792, loss_ss: 0.669596, loss_d: 0.121196
0.3458 --- loss: 0.886533, loss_ss: 0.713913, loss_d: 0.172620
0.3842 --- loss: 0.683072, loss_ss: 0.659034, loss_d: 0.024038
0.4226 --- loss: 1.154937, loss_ss: 1.084143, loss_d: 0.070793
0.4610 --- loss: 1.181818, loss_ss: 0.935955, loss_d: 0.245863
0.4994 --- loss: 0.754712, loss_ss: 0.726052, loss_d: 0.028660
0.5378 --- loss: 0.800058, loss_ss: 0.777842, loss_d: 0.022216
0.5763 --- loss: 0.690977, loss_ss: 0.684098, loss_d: 0.006880
0.6147 --- loss: 0.806449, loss_ss: 0.798638, loss_d: 0.007811
0.6531 --- loss: 0.616900, loss_ss: 0.605773, loss_d: 0.011127
0.6915 --- loss: 1.062098, loss_ss: 0.805676, loss_d: 0.256422
0.7299 --- loss: 0.818559, loss_ss: 0.628417, loss_d: 0.190142
0.7683 --- loss: 0.961170, loss_ss: 0.957606, loss_d: 0.003564
0.8068 --- loss: 0.673435, loss_ss: 0.656083, loss_d: 0.017352
0.8452 --- loss: 1.174093, loss_ss: 0.847454, loss_d: 0.326640
0.8836 --- loss: 0.656996, loss_ss: 0.594773, loss_d: 0.062223
0.9220 --- loss: 1.368915, loss_ss: 0.964220, loss_d: 0.404695
0.9604 --- loss: 0.893043, loss_ss: 0.790706, loss_d: 0.102337
0.9988 --- loss: 0.636861, loss_ss: 0.615322, loss_d: 0.021539
Epoch finished! Loss: 0.8655090664441769
Starting epoch 9/10.
0.0000 --- loss: 0.805557, loss_ss: 0.736560, loss_d: 0.068996
0.0384 --- loss: 0.717496, loss_ss: 0.706170, loss_d: 0.011326
0.0768 --- loss: 1.437530, loss_ss: 1.260990, loss_d: 0.176540
0.1153 --- loss: 0.695803, loss_ss: 0.647231, loss_d: 0.048572
0.1537 --- loss: 0.696309, loss_ss: 0.650781, loss_d: 0.045528
0.1921 --- loss: 0.948343, loss_ss: 0.906195, loss_d: 0.042148
0.2305 --- loss: 0.806544, loss_ss: 0.771279, loss_d: 0.035265
0.2689 --- loss: 1.187709, loss_ss: 1.090313, loss_d: 0.097396
0.3073 --- loss: 0.656388, loss_ss: 0.651010, loss_d: 0.005378
0.3458 --- loss: 0.958507, loss_ss: 0.837627, loss_d: 0.120880
0.3842 --- loss: 0.671425, loss_ss: 0.635862, loss_d: 0.035563
0.4226 --- loss: 0.680442, loss_ss: 0.677229, loss_d: 0.003213
0.4610 --- loss: 1.094155, loss_ss: 1.089786, loss_d: 0.004369
0.4994 --- loss: 0.640822, loss_ss: 0.602993, loss_d: 0.037829
0.5378 --- loss: 0.719355, loss_ss: 0.713369, loss_d: 0.005986
0.5763 --- loss: 0.786652, loss_ss: 0.781202, loss_d: 0.005450
0.6147 --- loss: 0.429405, loss_ss: 0.344079, loss_d: 0.085326
0.6531 --- loss: 1.087456, loss_ss: 0.983714, loss_d: 0.103742
0.6915 --- loss: 1.082114, loss_ss: 0.600825, loss_d: 0.481290
0.7299 --- loss: 0.828093, loss_ss: 0.794497, loss_d: 0.033596
0.7683 --- loss: 0.854902, loss_ss: 0.844118, loss_d: 0.010784
0.8068 --- loss: 1.093431, loss_ss: 0.965059, loss_d: 0.128372
0.8452 --- loss: 0.991081, loss_ss: 0.907240, loss_d: 0.083841
0.8836 --- loss: 0.627541, loss_ss: 0.621862, loss_d: 0.005679
0.9220 --- loss: 0.707277, loss_ss: 0.645917, loss_d: 0.061360
0.9604 --- loss: 0.570099, loss_ss: 0.565612, loss_d: 0.004487
0.9988 --- loss: 1.112664, loss_ss: 1.106328, loss_d: 0.006336
Epoch finished! Loss: 0.8496033163024829
Starting epoch 10/10.
0.0000 --- loss: 0.980974, loss_ss: 0.862032, loss_d: 0.118942
0.0384 --- loss: 1.060754, loss_ss: 0.674389, loss_d: 0.386364
0.0768 --- loss: 0.560394, loss_ss: 0.543701, loss_d: 0.016694
0.1153 --- loss: 0.911218, loss_ss: 0.901001, loss_d: 0.010217
0.1537 --- loss: 0.474889, loss_ss: 0.470486, loss_d: 0.004403
0.1921 --- loss: 0.694479, loss_ss: 0.641100, loss_d: 0.053379
0.2305 --- loss: 0.817989, loss_ss: 0.762125, loss_d: 0.055865
0.2689 --- loss: 0.494910, loss_ss: 0.492660, loss_d: 0.002250
0.3073 --- loss: 0.649125, loss_ss: 0.638347, loss_d: 0.010778
0.3458 --- loss: 0.500657, loss_ss: 0.498413, loss_d: 0.002245
0.3842 --- loss: 0.895357, loss_ss: 0.892264, loss_d: 0.003092
0.4226 --- loss: 0.857013, loss_ss: 0.855242, loss_d: 0.001770
0.4610 --- loss: 0.641131, loss_ss: 0.638396, loss_d: 0.002735
0.4994 --- loss: 0.570777, loss_ss: 0.549617, loss_d: 0.021160
0.5378 --- loss: 0.821801, loss_ss: 0.707837, loss_d: 0.113965
0.5763 --- loss: 0.723994, loss_ss: 0.715251, loss_d: 0.008743
0.6147 --- loss: 0.784024, loss_ss: 0.753912, loss_d: 0.030113
0.6531 --- loss: 0.861773, loss_ss: 0.821557, loss_d: 0.040217
0.6915 --- loss: 1.287708, loss_ss: 1.253977, loss_d: 0.033731
0.7299 --- loss: 0.690869, loss_ss: 0.689249, loss_d: 0.001620
0.7683 --- loss: 0.622554, loss_ss: 0.610027, loss_d: 0.012527
0.8068 --- loss: 0.804089, loss_ss: 0.800056, loss_d: 0.004033
0.8452 --- loss: 1.048873, loss_ss: 0.972379, loss_d: 0.076493
0.8836 --- loss: 0.607697, loss_ss: 0.601622, loss_d: 0.006076
0.9220 --- loss: 0.682985, loss_ss: 0.662138, loss_d: 0.020847
0.9604 --- loss: 1.046122, loss_ss: 0.790554, loss_d: 0.255568
0.9988 --- loss: 0.496280, loss_ss: 0.487329, loss_d: 0.008951
Epoch finished! Loss: 0.8118826194451405
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6276190476190476
             precision    recall  f1-score   support

        0.0       0.56      0.76      0.64        25
        1.0       0.23      0.06      0.10        93
        2.0       0.53      0.73      0.61       324
        3.0       0.95      0.62      0.75       484
        4.0       0.43      0.78      0.55       124

avg / total       0.69      0.63      0.63      1050
 


====== chp044-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.00  76.00   98.54  55.88     64.41
1  89.81   6.45   97.91  23.08     10.08
2  71.33  72.53   70.80  52.57     60.96
3  81.24  62.40   97.35  95.27     75.41
4  85.14  78.23   86.07  42.92     55.43
Total accuracy: 62.76%
Average sen: 59.12%
Average spec: 90.13%
Macro f1-score: 53.26%
Diagnosis acc on 15mins: 1.0
[1.         0.9999994  0.99992871 0.99999511 0.99998975 0.9999876
 1.         0.99999952 0.99999976 0.99999988 0.99999964 0.99999988
 0.99998546 0.99999988 1.         0.99998105 0.99996734 0.99997973
 0.99998713 1.         0.99999154 0.99994361 0.99947971 0.99997997
 0.99999964 1.         0.99999964 0.99999297 0.99998307 0.99982387
 0.99997175 0.99999988 0.99999738 0.99999726 0.9999131 ]
pred: 0.9999678066798618, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.406573, loss_ss: 1.688653, loss_d: 0.717919
0.0385 --- loss: 2.526847, loss_ss: 1.510086, loss_d: 1.016761
0.0770 --- loss: 2.038937, loss_ss: 1.564487, loss_d: 0.474450
0.1155 --- loss: 1.843629, loss_ss: 1.449158, loss_d: 0.394471
0.1540 --- loss: 1.988267, loss_ss: 1.411978, loss_d: 0.576288
0.1925 --- loss: 2.182246, loss_ss: 1.389284, loss_d: 0.792962
0.2309 --- loss: 1.696612, loss_ss: 1.293207, loss_d: 0.403405
0.2694 --- loss: 2.108753, loss_ss: 1.381855, loss_d: 0.726898
0.3079 --- loss: 1.880559, loss_ss: 1.332665, loss_d: 0.547894
0.3464 --- loss: 1.992200, loss_ss: 1.243578, loss_d: 0.748622
0.3849 --- loss: 1.881203, loss_ss: 1.396164, loss_d: 0.485040
0.4234 --- loss: 1.944239, loss_ss: 1.389549, loss_d: 0.554690
0.4619 --- loss: 1.560027, loss_ss: 1.248401, loss_d: 0.311625
0.5004 --- loss: 1.938349, loss_ss: 1.241051, loss_d: 0.697297
0.5389 --- loss: 1.607876, loss_ss: 1.223860, loss_d: 0.384016
0.5774 --- loss: 1.755731, loss_ss: 1.290672, loss_d: 0.465059
0.6159 --- loss: 1.863519, loss_ss: 1.232648, loss_d: 0.630871
0.6543 --- loss: 1.982833, loss_ss: 1.224943, loss_d: 0.757889
0.6928 --- loss: 1.779230, loss_ss: 1.208955, loss_d: 0.570275
0.7313 --- loss: 1.634877, loss_ss: 1.124135, loss_d: 0.510742
0.7698 --- loss: 1.627625, loss_ss: 1.186810, loss_d: 0.440815
0.8083 --- loss: 1.335154, loss_ss: 1.092094, loss_d: 0.243060
0.8468 --- loss: 1.466638, loss_ss: 1.122451, loss_d: 0.344188
0.8853 --- loss: 1.431551, loss_ss: 1.112714, loss_d: 0.318837
0.9238 --- loss: 1.421436, loss_ss: 1.120054, loss_d: 0.301382
0.9623 --- loss: 1.444099, loss_ss: 1.251324, loss_d: 0.192776
Epoch finished! Loss: 1.8368043876522757
Starting epoch 2/10.
0.0000 --- loss: 1.487022, loss_ss: 0.968529, loss_d: 0.518493
0.0385 --- loss: 1.447432, loss_ss: 1.108115, loss_d: 0.339317
0.0770 --- loss: 1.353836, loss_ss: 1.188192, loss_d: 0.165644
0.1155 --- loss: 1.533869, loss_ss: 0.872278, loss_d: 0.661591
0.1540 --- loss: 1.569880, loss_ss: 1.148405, loss_d: 0.421475
0.1925 --- loss: 1.498061, loss_ss: 1.009021, loss_d: 0.489041
0.2309 --- loss: 1.332114, loss_ss: 1.143549, loss_d: 0.188565
0.2694 --- loss: 1.435816, loss_ss: 1.028673, loss_d: 0.407143
0.3079 --- loss: 2.222288, loss_ss: 1.050202, loss_d: 1.172086
0.3464 --- loss: 1.462607, loss_ss: 1.027233, loss_d: 0.435374
0.3849 --- loss: 1.377234, loss_ss: 1.134511, loss_d: 0.242723
0.4234 --- loss: 0.999908, loss_ss: 0.898164, loss_d: 0.101743
0.4619 --- loss: 1.010758, loss_ss: 0.874842, loss_d: 0.135916
0.5004 --- loss: 1.519834, loss_ss: 1.140092, loss_d: 0.379742
0.5389 --- loss: 1.166768, loss_ss: 0.992875, loss_d: 0.173893
0.5774 --- loss: 1.319733, loss_ss: 1.077097, loss_d: 0.242635
0.6159 --- loss: 1.577579, loss_ss: 1.161811, loss_d: 0.415768
0.6543 --- loss: 1.311163, loss_ss: 0.876225, loss_d: 0.434938
0.6928 --- loss: 1.223899, loss_ss: 0.997085, loss_d: 0.226814
0.7313 --- loss: 0.994290, loss_ss: 0.827482, loss_d: 0.166808
0.7698 --- loss: 1.246211, loss_ss: 1.159236, loss_d: 0.086975
0.8083 --- loss: 1.443283, loss_ss: 0.926668, loss_d: 0.516615
0.8468 --- loss: 1.029976, loss_ss: 0.851297, loss_d: 0.178679
0.8853 --- loss: 1.056361, loss_ss: 0.795647, loss_d: 0.260714
0.9238 --- loss: 1.568563, loss_ss: 0.725550, loss_d: 0.843013
0.9623 --- loss: 1.153076, loss_ss: 0.863561, loss_d: 0.289514
Epoch finished! Loss: 1.3310975296617014
Starting epoch 3/10.
0.0000 --- loss: 1.241109, loss_ss: 1.024309, loss_d: 0.216801
0.0385 --- loss: 1.478167, loss_ss: 0.930110, loss_d: 0.548056
0.0770 --- loss: 0.868626, loss_ss: 0.793620, loss_d: 0.075006
0.1155 --- loss: 1.129059, loss_ss: 0.864580, loss_d: 0.264479
0.1540 --- loss: 1.872791, loss_ss: 1.060044, loss_d: 0.812747
0.1925 --- loss: 1.416288, loss_ss: 0.804601, loss_d: 0.611687
0.2309 --- loss: 1.135167, loss_ss: 0.959330, loss_d: 0.175838
0.2694 --- loss: 1.072051, loss_ss: 0.797298, loss_d: 0.274752
0.3079 --- loss: 1.454532, loss_ss: 1.178436, loss_d: 0.276095
0.3464 --- loss: 1.183078, loss_ss: 0.841416, loss_d: 0.341662
0.3849 --- loss: 1.131363, loss_ss: 0.748814, loss_d: 0.382549
0.4234 --- loss: 0.967861, loss_ss: 0.807724, loss_d: 0.160137
0.4619 --- loss: 1.048803, loss_ss: 0.861837, loss_d: 0.186966
0.5004 --- loss: 1.329963, loss_ss: 0.846447, loss_d: 0.483516
0.5389 --- loss: 0.860459, loss_ss: 0.773277, loss_d: 0.087182
0.5774 --- loss: 1.068455, loss_ss: 0.972208, loss_d: 0.096247
0.6159 --- loss: 1.032266, loss_ss: 0.830582, loss_d: 0.201685
0.6543 --- loss: 0.873401, loss_ss: 0.694554, loss_d: 0.178847
0.6928 --- loss: 1.041113, loss_ss: 0.816754, loss_d: 0.224359
0.7313 --- loss: 1.165274, loss_ss: 1.021620, loss_d: 0.143654
0.7698 --- loss: 1.045997, loss_ss: 0.902762, loss_d: 0.143235
0.8083 --- loss: 1.033459, loss_ss: 0.785457, loss_d: 0.248002
0.8468 --- loss: 1.114844, loss_ss: 0.901980, loss_d: 0.212863
0.8853 --- loss: 0.832231, loss_ss: 0.628459, loss_d: 0.203772
0.9238 --- loss: 0.777250, loss_ss: 0.698792, loss_d: 0.078458
0.9623 --- loss: 0.685751, loss_ss: 0.545804, loss_d: 0.139947
Epoch finished! Loss: 1.1173567332356134
Starting epoch 4/10.
0.0000 --- loss: 0.997251, loss_ss: 0.906491, loss_d: 0.090761
0.0385 --- loss: 0.880801, loss_ss: 0.836913, loss_d: 0.043889
0.0770 --- loss: 1.064586, loss_ss: 0.784748, loss_d: 0.279838
0.1155 --- loss: 0.967821, loss_ss: 0.848340, loss_d: 0.119481
0.1540 --- loss: 1.157027, loss_ss: 0.935063, loss_d: 0.221964
0.1925 --- loss: 0.678977, loss_ss: 0.418923, loss_d: 0.260055
0.2309 --- loss: 1.158734, loss_ss: 1.006658, loss_d: 0.152076
0.2694 --- loss: 1.251501, loss_ss: 0.862806, loss_d: 0.388695
0.3079 --- loss: 1.080083, loss_ss: 0.764638, loss_d: 0.315445
0.3464 --- loss: 0.770865, loss_ss: 0.709228, loss_d: 0.061637
0.3849 --- loss: 1.198471, loss_ss: 0.666735, loss_d: 0.531735
0.4234 --- loss: 1.091144, loss_ss: 0.831125, loss_d: 0.260019
0.4619 --- loss: 1.001019, loss_ss: 0.626922, loss_d: 0.374097
0.5004 --- loss: 1.056208, loss_ss: 0.995798, loss_d: 0.060410
0.5389 --- loss: 0.793046, loss_ss: 0.759035, loss_d: 0.034011
0.5774 --- loss: 0.825703, loss_ss: 0.777772, loss_d: 0.047931
0.6159 --- loss: 1.292802, loss_ss: 0.725207, loss_d: 0.567596
0.6543 --- loss: 0.815554, loss_ss: 0.795419, loss_d: 0.020135
0.6928 --- loss: 1.096732, loss_ss: 0.858450, loss_d: 0.238282
0.7313 --- loss: 1.275425, loss_ss: 1.125833, loss_d: 0.149592
0.7698 --- loss: 1.226931, loss_ss: 1.128871, loss_d: 0.098060
0.8083 --- loss: 0.904446, loss_ss: 0.856111, loss_d: 0.048335
0.8468 --- loss: 0.917266, loss_ss: 0.851664, loss_d: 0.065602
0.8853 --- loss: 0.839347, loss_ss: 0.782947, loss_d: 0.056400
0.9238 --- loss: 0.823722, loss_ss: 0.734546, loss_d: 0.089177
0.9623 --- loss: 0.725151, loss_ss: 0.693213, loss_d: 0.031938
Epoch finished! Loss: 0.9990296216544957
Starting epoch 5/10.
0.0000 --- loss: 1.149864, loss_ss: 0.794432, loss_d: 0.355433
0.0385 --- loss: 0.938417, loss_ss: 0.879290, loss_d: 0.059127
0.0770 --- loss: 1.045776, loss_ss: 0.940116, loss_d: 0.105660
0.1155 --- loss: 0.925884, loss_ss: 0.802455, loss_d: 0.123429
0.1540 --- loss: 1.261832, loss_ss: 0.797352, loss_d: 0.464481
0.1925 --- loss: 1.195621, loss_ss: 1.057028, loss_d: 0.138592
0.2309 --- loss: 0.857866, loss_ss: 0.809615, loss_d: 0.048251
0.2694 --- loss: 1.223195, loss_ss: 0.803866, loss_d: 0.419329
0.3079 --- loss: 0.790303, loss_ss: 0.691963, loss_d: 0.098340
0.3464 --- loss: 0.906381, loss_ss: 0.670050, loss_d: 0.236331
0.3849 --- loss: 0.869513, loss_ss: 0.812854, loss_d: 0.056658
0.4234 --- loss: 0.921142, loss_ss: 0.696880, loss_d: 0.224262
0.4619 --- loss: 1.024150, loss_ss: 0.908389, loss_d: 0.115761
0.5004 --- loss: 1.169449, loss_ss: 1.084293, loss_d: 0.085156
0.5389 --- loss: 0.868037, loss_ss: 0.848050, loss_d: 0.019987
0.5774 --- loss: 0.641246, loss_ss: 0.482541, loss_d: 0.158704
0.6159 --- loss: 0.729638, loss_ss: 0.571505, loss_d: 0.158134
0.6543 --- loss: 0.804505, loss_ss: 0.760791, loss_d: 0.043715
0.6928 --- loss: 0.863291, loss_ss: 0.770973, loss_d: 0.092318
0.7313 --- loss: 0.754077, loss_ss: 0.573876, loss_d: 0.180201
0.7698 --- loss: 1.623602, loss_ss: 0.880318, loss_d: 0.743284
0.8083 --- loss: 0.735201, loss_ss: 0.617186, loss_d: 0.118015
0.8468 --- loss: 0.778126, loss_ss: 0.651800, loss_d: 0.126325
0.8853 --- loss: 0.873500, loss_ss: 0.813675, loss_d: 0.059824
0.9238 --- loss: 0.774567, loss_ss: 0.757134, loss_d: 0.017433
0.9623 --- loss: 0.860661, loss_ss: 0.640685, loss_d: 0.219976
Epoch finished! Loss: 0.9184332754621174
Starting epoch 6/10.
0.0000 --- loss: 0.984547, loss_ss: 0.774810, loss_d: 0.209737
0.0385 --- loss: 0.959952, loss_ss: 0.938088, loss_d: 0.021864
0.0770 --- loss: 1.245011, loss_ss: 0.709732, loss_d: 0.535279
0.1155 --- loss: 0.673744, loss_ss: 0.513427, loss_d: 0.160317
0.1540 --- loss: 0.726766, loss_ss: 0.694805, loss_d: 0.031961
0.1925 --- loss: 0.712232, loss_ss: 0.702966, loss_d: 0.009266
0.2309 --- loss: 0.946781, loss_ss: 0.626850, loss_d: 0.319931
0.2694 --- loss: 1.134764, loss_ss: 0.920235, loss_d: 0.214529
0.3079 --- loss: 0.529714, loss_ss: 0.524835, loss_d: 0.004878
0.3464 --- loss: 0.795552, loss_ss: 0.760229, loss_d: 0.035323
0.3849 --- loss: 0.809982, loss_ss: 0.540063, loss_d: 0.269919
0.4234 --- loss: 0.779728, loss_ss: 0.584213, loss_d: 0.195515
0.4619 --- loss: 0.947320, loss_ss: 0.898161, loss_d: 0.049159
0.5004 --- loss: 0.951651, loss_ss: 0.948373, loss_d: 0.003278
0.5389 --- loss: 0.653742, loss_ss: 0.633597, loss_d: 0.020146
0.5774 --- loss: 1.040895, loss_ss: 0.760184, loss_d: 0.280711
0.6159 --- loss: 0.949789, loss_ss: 0.935716, loss_d: 0.014074
0.6543 --- loss: 0.806363, loss_ss: 0.695804, loss_d: 0.110559
0.6928 --- loss: 0.658196, loss_ss: 0.646762, loss_d: 0.011434
0.7313 --- loss: 0.747410, loss_ss: 0.691167, loss_d: 0.056243
0.7698 --- loss: 0.638564, loss_ss: 0.545377, loss_d: 0.093187
0.8083 --- loss: 0.951254, loss_ss: 0.650193, loss_d: 0.301061
0.8468 --- loss: 0.624420, loss_ss: 0.592032, loss_d: 0.032388
0.8853 --- loss: 1.204103, loss_ss: 0.556228, loss_d: 0.647875
0.9238 --- loss: 1.246044, loss_ss: 0.806270, loss_d: 0.439774
0.9623 --- loss: 1.046061, loss_ss: 0.882433, loss_d: 0.163628
Epoch finished! Loss: 0.9042788758931473
Starting epoch 7/10.
0.0000 --- loss: 1.175905, loss_ss: 1.025776, loss_d: 0.150129
0.0385 --- loss: 0.714104, loss_ss: 0.620728, loss_d: 0.093377
0.0770 --- loss: 0.694260, loss_ss: 0.676625, loss_d: 0.017635
0.1155 --- loss: 0.902901, loss_ss: 0.758509, loss_d: 0.144392
0.1540 --- loss: 0.769683, loss_ss: 0.758562, loss_d: 0.011121
0.1925 --- loss: 0.739129, loss_ss: 0.593327, loss_d: 0.145802
0.2309 --- loss: 1.029535, loss_ss: 1.017664, loss_d: 0.011871
0.2694 --- loss: 0.736512, loss_ss: 0.655843, loss_d: 0.080669
0.3079 --- loss: 0.787386, loss_ss: 0.755569, loss_d: 0.031818
0.3464 --- loss: 0.631769, loss_ss: 0.610059, loss_d: 0.021710
0.3849 --- loss: 0.775294, loss_ss: 0.769884, loss_d: 0.005410
0.4234 --- loss: 0.815928, loss_ss: 0.808903, loss_d: 0.007025
0.4619 --- loss: 0.812506, loss_ss: 0.709841, loss_d: 0.102665
0.5004 --- loss: 0.979926, loss_ss: 0.849678, loss_d: 0.130248
0.5389 --- loss: 0.785545, loss_ss: 0.638629, loss_d: 0.146916
0.5774 --- loss: 1.576236, loss_ss: 1.182570, loss_d: 0.393666
0.6159 --- loss: 0.881232, loss_ss: 0.872909, loss_d: 0.008323
0.6543 --- loss: 1.287364, loss_ss: 0.833365, loss_d: 0.453999
0.6928 --- loss: 0.773239, loss_ss: 0.769327, loss_d: 0.003912
0.7313 --- loss: 1.117799, loss_ss: 0.705007, loss_d: 0.412792
0.7698 --- loss: 0.835453, loss_ss: 0.556588, loss_d: 0.278865
0.8083 --- loss: 0.634799, loss_ss: 0.509429, loss_d: 0.125370
0.8468 --- loss: 0.614173, loss_ss: 0.569034, loss_d: 0.045139
0.8853 --- loss: 0.916087, loss_ss: 0.854401, loss_d: 0.061687
0.9238 --- loss: 0.961942, loss_ss: 0.961358, loss_d: 0.000584
0.9623 --- loss: 1.023969, loss_ss: 0.993509, loss_d: 0.030460
Epoch finished! Loss: 0.8316171918366406
Starting epoch 8/10.
0.0000 --- loss: 0.792081, loss_ss: 0.668483, loss_d: 0.123598
0.0385 --- loss: 1.258626, loss_ss: 0.690632, loss_d: 0.567994
0.0770 --- loss: 0.709775, loss_ss: 0.658074, loss_d: 0.051701
0.1155 --- loss: 0.713239, loss_ss: 0.675304, loss_d: 0.037935
0.1540 --- loss: 0.741827, loss_ss: 0.736278, loss_d: 0.005549
0.1925 --- loss: 0.504814, loss_ss: 0.451256, loss_d: 0.053557
0.2309 --- loss: 0.798706, loss_ss: 0.788150, loss_d: 0.010556
0.2694 --- loss: 0.676990, loss_ss: 0.663806, loss_d: 0.013184
0.3079 --- loss: 0.814310, loss_ss: 0.612950, loss_d: 0.201360
0.3464 --- loss: 0.724759, loss_ss: 0.711622, loss_d: 0.013137
0.3849 --- loss: 0.698704, loss_ss: 0.616040, loss_d: 0.082664
0.4234 --- loss: 1.077764, loss_ss: 0.998118, loss_d: 0.079646
0.4619 --- loss: 0.764663, loss_ss: 0.762163, loss_d: 0.002500
0.5004 --- loss: 0.890381, loss_ss: 0.870130, loss_d: 0.020251
0.5389 --- loss: 0.697551, loss_ss: 0.692083, loss_d: 0.005468
0.5774 --- loss: 0.571240, loss_ss: 0.535217, loss_d: 0.036023
0.6159 --- loss: 0.640390, loss_ss: 0.634563, loss_d: 0.005826
0.6543 --- loss: 1.013552, loss_ss: 0.758231, loss_d: 0.255321
0.6928 --- loss: 1.000858, loss_ss: 0.681960, loss_d: 0.318898
0.7313 --- loss: 0.880907, loss_ss: 0.778952, loss_d: 0.101955
0.7698 --- loss: 0.875166, loss_ss: 0.872995, loss_d: 0.002172
0.8083 --- loss: 0.896020, loss_ss: 0.693249, loss_d: 0.202771
0.8468 --- loss: 0.689023, loss_ss: 0.686532, loss_d: 0.002491
0.8853 --- loss: 0.635488, loss_ss: 0.630445, loss_d: 0.005043
0.9238 --- loss: 0.833706, loss_ss: 0.821478, loss_d: 0.012228
0.9623 --- loss: 0.719516, loss_ss: 0.708564, loss_d: 0.010952
Epoch finished! Loss: 0.827394590414629
Starting epoch 9/10.
0.0000 --- loss: 0.707147, loss_ss: 0.700239, loss_d: 0.006908
0.0385 --- loss: 0.765616, loss_ss: 0.711381, loss_d: 0.054235
0.0770 --- loss: 0.933948, loss_ss: 0.914388, loss_d: 0.019560
0.1155 --- loss: 0.719070, loss_ss: 0.709385, loss_d: 0.009685
0.1540 --- loss: 0.920377, loss_ss: 0.906295, loss_d: 0.014083
0.1925 --- loss: 0.736886, loss_ss: 0.693995, loss_d: 0.042891
0.2309 --- loss: 1.376451, loss_ss: 0.966596, loss_d: 0.409856
0.2694 --- loss: 0.839659, loss_ss: 0.692262, loss_d: 0.147397
0.3079 --- loss: 0.597715, loss_ss: 0.528527, loss_d: 0.069189
0.3464 --- loss: 0.587171, loss_ss: 0.552123, loss_d: 0.035049
0.3849 --- loss: 0.719559, loss_ss: 0.707487, loss_d: 0.012072
0.4234 --- loss: 0.708586, loss_ss: 0.697997, loss_d: 0.010590
0.4619 --- loss: 0.926034, loss_ss: 0.818473, loss_d: 0.107561
0.5004 --- loss: 1.195255, loss_ss: 0.818839, loss_d: 0.376416
0.5389 --- loss: 0.715450, loss_ss: 0.679057, loss_d: 0.036393
0.5774 --- loss: 0.538685, loss_ss: 0.533492, loss_d: 0.005194
0.6159 --- loss: 1.023907, loss_ss: 0.952106, loss_d: 0.071800
0.6543 --- loss: 0.686396, loss_ss: 0.674470, loss_d: 0.011927
0.6928 --- loss: 0.765275, loss_ss: 0.591165, loss_d: 0.174110
0.7313 --- loss: 0.787648, loss_ss: 0.783719, loss_d: 0.003930
0.7698 --- loss: 0.672371, loss_ss: 0.641869, loss_d: 0.030502
0.8083 --- loss: 0.786315, loss_ss: 0.582776, loss_d: 0.203539
0.8468 --- loss: 0.533460, loss_ss: 0.521634, loss_d: 0.011826
0.8853 --- loss: 0.938614, loss_ss: 0.818701, loss_d: 0.119913
0.9238 --- loss: 1.007775, loss_ss: 0.691818, loss_d: 0.315956
0.9623 --- loss: 0.809895, loss_ss: 0.772953, loss_d: 0.036942
Epoch finished! Loss: 0.801640968180071
Starting epoch 10/10.
0.0000 --- loss: 0.715283, loss_ss: 0.713106, loss_d: 0.002177
0.0385 --- loss: 0.500483, loss_ss: 0.492399, loss_d: 0.008084
0.0770 --- loss: 0.837865, loss_ss: 0.835181, loss_d: 0.002684
0.1155 --- loss: 0.804543, loss_ss: 0.800333, loss_d: 0.004210
0.1540 --- loss: 0.809172, loss_ss: 0.737465, loss_d: 0.071707
0.1925 --- loss: 0.884653, loss_ss: 0.882489, loss_d: 0.002163
0.2309 --- loss: 0.727890, loss_ss: 0.726387, loss_d: 0.001503
0.2694 --- loss: 0.748261, loss_ss: 0.628034, loss_d: 0.120226
0.3079 --- loss: 0.627689, loss_ss: 0.616764, loss_d: 0.010925
0.3464 --- loss: 0.867424, loss_ss: 0.811753, loss_d: 0.055671
0.3849 --- loss: 0.747515, loss_ss: 0.708206, loss_d: 0.039309
0.4234 --- loss: 0.783094, loss_ss: 0.777101, loss_d: 0.005993
0.4619 --- loss: 0.809096, loss_ss: 0.785489, loss_d: 0.023607
0.5004 --- loss: 0.938784, loss_ss: 0.855585, loss_d: 0.083199
0.5389 --- loss: 0.546823, loss_ss: 0.534874, loss_d: 0.011949
0.5774 --- loss: 0.594937, loss_ss: 0.591694, loss_d: 0.003243
0.6159 --- loss: 1.012984, loss_ss: 0.515253, loss_d: 0.497731
0.6543 --- loss: 0.944665, loss_ss: 0.939122, loss_d: 0.005543
0.6928 --- loss: 0.856745, loss_ss: 0.826419, loss_d: 0.030327
0.7313 --- loss: 0.897696, loss_ss: 0.657969, loss_d: 0.239727
0.7698 --- loss: 0.663298, loss_ss: 0.566523, loss_d: 0.096775
0.8083 --- loss: 0.858841, loss_ss: 0.779769, loss_d: 0.079072
0.8468 --- loss: 0.630949, loss_ss: 0.628174, loss_d: 0.002775
0.8853 --- loss: 1.164017, loss_ss: 1.129027, loss_d: 0.034990
0.9238 --- loss: 0.770615, loss_ss: 0.696909, loss_d: 0.073706
0.9623 --- loss: 0.965089, loss_ss: 0.525109, loss_d: 0.439979
Epoch finished! Loss: 0.7919737917576057
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6155129274395329
             precision    recall  f1-score   support

        0.0       0.57      0.69      0.62       151
        1.0       0.33      0.45      0.38       135
        2.0       0.69      0.77      0.73       442
        3.0       0.97      0.51      0.66       221
        4.0       0.55      0.48      0.51       250

avg / total       0.65      0.62      0.62      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.41  68.87   92.37  56.52     62.09
1  83.32  45.19   88.16  32.62     37.89
2  78.98  77.38   79.92  69.23     73.08
3  90.58  50.68   99.59  96.55     66.47
4  80.82  47.60   89.57  54.59     50.85
Total accuracy: 61.55%
Average sen: 57.94%
Average spec: 89.92%
Macro f1-score: 58.08%
Diagnosis acc on 15mins: 1.0
[0.99991238 0.99998546 0.99997926 0.99952865 1.         1.
 0.99999964 0.99999666 0.99999809 1.         1.         1.
 1.         0.99999607 0.99999988 1.         0.99999964 0.99162889
 0.99683553 0.99997222 0.99999762 0.99999976 1.         0.99168253
 1.         0.9999994  0.99999726 0.99999964 0.9999994  0.99999666
 0.99997294 0.99999869 0.99999928 0.99999487 0.99999654 0.99999988
 0.99999797 0.99999893 0.99978381 0.99999976]
pred: 0.9994811832904815, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.452103, loss_ss: 1.760426, loss_d: 0.691677
0.0384 --- loss: 2.340861, loss_ss: 1.583474, loss_d: 0.757387
0.0769 --- loss: 2.087755, loss_ss: 1.578124, loss_d: 0.509631
0.1153 --- loss: 2.167789, loss_ss: 1.475225, loss_d: 0.692564
0.1537 --- loss: 2.090531, loss_ss: 1.489880, loss_d: 0.600651
0.1922 --- loss: 2.287751, loss_ss: 1.523205, loss_d: 0.764546
0.2306 --- loss: 2.054358, loss_ss: 1.416978, loss_d: 0.637380
0.2690 --- loss: 2.028886, loss_ss: 1.441721, loss_d: 0.587166
0.3075 --- loss: 1.917637, loss_ss: 1.291574, loss_d: 0.626063
0.3459 --- loss: 1.964606, loss_ss: 1.273540, loss_d: 0.691066
0.3843 --- loss: 2.127654, loss_ss: 1.314572, loss_d: 0.813082
0.4228 --- loss: 1.923932, loss_ss: 1.209818, loss_d: 0.714115
0.4612 --- loss: 1.716474, loss_ss: 1.366495, loss_d: 0.349978
0.4996 --- loss: 1.667428, loss_ss: 1.302511, loss_d: 0.364917
0.5380 --- loss: 2.069940, loss_ss: 1.293847, loss_d: 0.776093
0.5765 --- loss: 1.863868, loss_ss: 1.267164, loss_d: 0.596704
0.6149 --- loss: 2.067768, loss_ss: 1.499729, loss_d: 0.568039
0.6533 --- loss: 1.947556, loss_ss: 1.231323, loss_d: 0.716232
0.6918 --- loss: 1.622326, loss_ss: 1.292253, loss_d: 0.330073
0.7302 --- loss: 1.802835, loss_ss: 1.406836, loss_d: 0.395999
0.7686 --- loss: 1.618937, loss_ss: 1.295445, loss_d: 0.323492
0.8071 --- loss: 1.886235, loss_ss: 1.338162, loss_d: 0.548073
0.8455 --- loss: 1.906941, loss_ss: 1.052456, loss_d: 0.854486
0.8839 --- loss: 1.860798, loss_ss: 1.305574, loss_d: 0.555224
0.9224 --- loss: 1.573341, loss_ss: 1.144795, loss_d: 0.428545
0.9608 --- loss: 1.907630, loss_ss: 1.020468, loss_d: 0.887162
0.9992 --- loss: 1.453708, loss_ss: 1.256829, loss_d: 0.196878
Epoch finished! Loss: 1.868859835771414
Starting epoch 2/10.
0.0000 --- loss: 1.357639, loss_ss: 1.159640, loss_d: 0.197999
0.0384 --- loss: 1.626757, loss_ss: 1.034616, loss_d: 0.592141
0.0769 --- loss: 1.502266, loss_ss: 1.102857, loss_d: 0.399409
0.1153 --- loss: 1.305141, loss_ss: 1.108670, loss_d: 0.196472
0.1537 --- loss: 1.411252, loss_ss: 1.229743, loss_d: 0.181509
0.1922 --- loss: 1.391742, loss_ss: 1.001768, loss_d: 0.389974
0.2306 --- loss: 1.280846, loss_ss: 0.880361, loss_d: 0.400485
0.2690 --- loss: 1.209927, loss_ss: 0.906908, loss_d: 0.303019
0.3075 --- loss: 1.314940, loss_ss: 1.008400, loss_d: 0.306540
0.3459 --- loss: 1.851618, loss_ss: 1.046882, loss_d: 0.804736
0.3843 --- loss: 1.315680, loss_ss: 1.109871, loss_d: 0.205809
0.4228 --- loss: 0.929375, loss_ss: 0.804021, loss_d: 0.125354
0.4612 --- loss: 1.392264, loss_ss: 1.271016, loss_d: 0.121248
0.4996 --- loss: 1.368976, loss_ss: 0.820492, loss_d: 0.548483
0.5380 --- loss: 1.398908, loss_ss: 1.128382, loss_d: 0.270526
0.5765 --- loss: 1.225342, loss_ss: 1.040576, loss_d: 0.184765
0.6149 --- loss: 0.938997, loss_ss: 0.859632, loss_d: 0.079365
0.6533 --- loss: 1.121637, loss_ss: 0.891700, loss_d: 0.229937
0.6918 --- loss: 0.965185, loss_ss: 0.814976, loss_d: 0.150209
0.7302 --- loss: 1.490145, loss_ss: 1.107760, loss_d: 0.382385
0.7686 --- loss: 1.483284, loss_ss: 1.156064, loss_d: 0.327220
0.8071 --- loss: 1.379054, loss_ss: 1.307832, loss_d: 0.071222
0.8455 --- loss: 1.671789, loss_ss: 1.219002, loss_d: 0.452786
0.8839 --- loss: 1.056440, loss_ss: 0.953831, loss_d: 0.102609
0.9224 --- loss: 1.132196, loss_ss: 0.835532, loss_d: 0.296663
0.9608 --- loss: 0.930244, loss_ss: 0.856030, loss_d: 0.074214
0.9992 --- loss: 1.419634, loss_ss: 1.311897, loss_d: 0.107736
Epoch finished! Loss: 1.3593797222926067
Starting epoch 3/10.
0.0000 --- loss: 1.690162, loss_ss: 0.894608, loss_d: 0.795554
0.0384 --- loss: 0.998984, loss_ss: 0.750663, loss_d: 0.248321
0.0769 --- loss: 1.208133, loss_ss: 1.024692, loss_d: 0.183441
0.1153 --- loss: 1.381747, loss_ss: 0.728997, loss_d: 0.652750
0.1537 --- loss: 1.028908, loss_ss: 0.876527, loss_d: 0.152381
0.1922 --- loss: 1.641440, loss_ss: 1.351160, loss_d: 0.290280
0.2306 --- loss: 1.580668, loss_ss: 1.200781, loss_d: 0.379887
0.2690 --- loss: 1.126635, loss_ss: 0.864616, loss_d: 0.262019
0.3075 --- loss: 1.191488, loss_ss: 0.676583, loss_d: 0.514905
0.3459 --- loss: 1.272239, loss_ss: 1.014923, loss_d: 0.257316
0.3843 --- loss: 0.939241, loss_ss: 0.883266, loss_d: 0.055975
0.4228 --- loss: 1.067524, loss_ss: 0.940556, loss_d: 0.126968
0.4612 --- loss: 0.991306, loss_ss: 0.914810, loss_d: 0.076495
0.4996 --- loss: 0.945052, loss_ss: 0.810952, loss_d: 0.134100
0.5380 --- loss: 1.007624, loss_ss: 0.878104, loss_d: 0.129520
0.5765 --- loss: 0.965712, loss_ss: 0.852351, loss_d: 0.113361
0.6149 --- loss: 1.043159, loss_ss: 1.008388, loss_d: 0.034772
0.6533 --- loss: 1.251838, loss_ss: 1.015311, loss_d: 0.236528
0.6918 --- loss: 1.124703, loss_ss: 0.693199, loss_d: 0.431504
0.7302 --- loss: 1.497524, loss_ss: 0.702034, loss_d: 0.795491
0.7686 --- loss: 1.126540, loss_ss: 0.927649, loss_d: 0.198891
0.8071 --- loss: 0.946029, loss_ss: 0.701248, loss_d: 0.244782
0.8455 --- loss: 1.893101, loss_ss: 1.035829, loss_d: 0.857272
0.8839 --- loss: 1.203498, loss_ss: 0.827716, loss_d: 0.375782
0.9224 --- loss: 1.056614, loss_ss: 0.875041, loss_d: 0.181572
0.9608 --- loss: 1.164348, loss_ss: 0.882133, loss_d: 0.282215
0.9992 --- loss: 1.536676, loss_ss: 1.168356, loss_d: 0.368320
Epoch finished! Loss: 1.1561166777060583
Starting epoch 4/10.
0.0000 --- loss: 1.005994, loss_ss: 0.803641, loss_d: 0.202353
0.0384 --- loss: 0.886146, loss_ss: 0.795829, loss_d: 0.090317
0.0769 --- loss: 1.018315, loss_ss: 0.928839, loss_d: 0.089476
0.1153 --- loss: 1.044039, loss_ss: 0.728391, loss_d: 0.315647
0.1537 --- loss: 0.955823, loss_ss: 0.826582, loss_d: 0.129241
0.1922 --- loss: 0.947593, loss_ss: 0.780012, loss_d: 0.167581
0.2306 --- loss: 1.591367, loss_ss: 1.255256, loss_d: 0.336111
0.2690 --- loss: 1.175792, loss_ss: 1.035699, loss_d: 0.140093
0.3075 --- loss: 0.661168, loss_ss: 0.622309, loss_d: 0.038860
0.3459 --- loss: 1.703097, loss_ss: 1.586328, loss_d: 0.116769
0.3843 --- loss: 0.796721, loss_ss: 0.671972, loss_d: 0.124749
0.4228 --- loss: 1.168700, loss_ss: 0.746972, loss_d: 0.421728
0.4612 --- loss: 1.086475, loss_ss: 0.651944, loss_d: 0.434532
0.4996 --- loss: 1.254613, loss_ss: 0.941644, loss_d: 0.312969
0.5380 --- loss: 1.236212, loss_ss: 0.729500, loss_d: 0.506712
0.5765 --- loss: 1.115399, loss_ss: 0.702715, loss_d: 0.412684
0.6149 --- loss: 0.957599, loss_ss: 0.864364, loss_d: 0.093235
0.6533 --- loss: 1.078578, loss_ss: 0.583102, loss_d: 0.495476
0.6918 --- loss: 0.865280, loss_ss: 0.789026, loss_d: 0.076253
0.7302 --- loss: 0.909862, loss_ss: 0.840406, loss_d: 0.069456
0.7686 --- loss: 0.994419, loss_ss: 0.819109, loss_d: 0.175310
0.8071 --- loss: 0.695993, loss_ss: 0.636841, loss_d: 0.059152
0.8455 --- loss: 0.851479, loss_ss: 0.785023, loss_d: 0.066456
0.8839 --- loss: 0.743255, loss_ss: 0.665707, loss_d: 0.077547
0.9224 --- loss: 1.012322, loss_ss: 0.929243, loss_d: 0.083078
0.9608 --- loss: 0.822866, loss_ss: 0.769260, loss_d: 0.053606
0.9992 --- loss: 1.449306, loss_ss: 1.437409, loss_d: 0.011897
Epoch finished! Loss: 1.0143913645010727
Starting epoch 5/10.
0.0000 --- loss: 0.833493, loss_ss: 0.816673, loss_d: 0.016820
0.0384 --- loss: 0.700820, loss_ss: 0.511914, loss_d: 0.188905
0.0769 --- loss: 0.641083, loss_ss: 0.483180, loss_d: 0.157902
0.1153 --- loss: 1.206684, loss_ss: 1.075754, loss_d: 0.130930
0.1537 --- loss: 0.918477, loss_ss: 0.892546, loss_d: 0.025931
0.1922 --- loss: 1.073238, loss_ss: 1.023176, loss_d: 0.050062
0.2306 --- loss: 1.424986, loss_ss: 0.755394, loss_d: 0.669592
0.2690 --- loss: 0.946706, loss_ss: 0.891804, loss_d: 0.054901
0.3075 --- loss: 1.205825, loss_ss: 0.767284, loss_d: 0.438540
0.3459 --- loss: 0.940974, loss_ss: 0.879324, loss_d: 0.061649
0.3843 --- loss: 1.589169, loss_ss: 1.021190, loss_d: 0.567979
0.4228 --- loss: 0.679856, loss_ss: 0.634602, loss_d: 0.045253
0.4612 --- loss: 1.154515, loss_ss: 0.549809, loss_d: 0.604705
0.4996 --- loss: 0.995250, loss_ss: 0.941650, loss_d: 0.053600
0.5380 --- loss: 0.832528, loss_ss: 0.731468, loss_d: 0.101060
0.5765 --- loss: 1.215788, loss_ss: 0.654530, loss_d: 0.561258
0.6149 --- loss: 1.175173, loss_ss: 0.801120, loss_d: 0.374053
0.6533 --- loss: 1.206828, loss_ss: 0.978293, loss_d: 0.228536
0.6918 --- loss: 1.174027, loss_ss: 0.812212, loss_d: 0.361815
0.7302 --- loss: 0.744851, loss_ss: 0.710002, loss_d: 0.034848
0.7686 --- loss: 1.063664, loss_ss: 0.537823, loss_d: 0.525841
0.8071 --- loss: 0.763044, loss_ss: 0.662663, loss_d: 0.100381
0.8455 --- loss: 0.682510, loss_ss: 0.645740, loss_d: 0.036769
0.8839 --- loss: 0.757743, loss_ss: 0.655461, loss_d: 0.102281
0.9224 --- loss: 0.928527, loss_ss: 0.647493, loss_d: 0.281034
0.9608 --- loss: 0.827122, loss_ss: 0.614785, loss_d: 0.212337
0.9992 --- loss: 1.572919, loss_ss: 1.266762, loss_d: 0.306157
Epoch finished! Loss: 0.9672552450345113
Starting epoch 6/10.
0.0000 --- loss: 1.114853, loss_ss: 0.963073, loss_d: 0.151780
0.0384 --- loss: 0.948556, loss_ss: 0.778703, loss_d: 0.169852
0.0769 --- loss: 0.705097, loss_ss: 0.645748, loss_d: 0.059349
0.1153 --- loss: 0.854414, loss_ss: 0.705631, loss_d: 0.148783
0.1537 --- loss: 1.227440, loss_ss: 0.921292, loss_d: 0.306148
0.1922 --- loss: 0.817819, loss_ss: 0.764458, loss_d: 0.053362
0.2306 --- loss: 0.608398, loss_ss: 0.591681, loss_d: 0.016717
0.2690 --- loss: 1.768668, loss_ss: 0.809787, loss_d: 0.958881
0.3075 --- loss: 0.966795, loss_ss: 0.779804, loss_d: 0.186991
0.3459 --- loss: 0.961431, loss_ss: 0.893604, loss_d: 0.067827
0.3843 --- loss: 0.767068, loss_ss: 0.694317, loss_d: 0.072751
0.4228 --- loss: 0.897899, loss_ss: 0.759175, loss_d: 0.138724
0.4612 --- loss: 0.872783, loss_ss: 0.822913, loss_d: 0.049870
0.4996 --- loss: 1.090077, loss_ss: 0.734761, loss_d: 0.355317
0.5380 --- loss: 1.119422, loss_ss: 0.856203, loss_d: 0.263219
0.5765 --- loss: 0.726621, loss_ss: 0.567254, loss_d: 0.159367
0.6149 --- loss: 0.701168, loss_ss: 0.605112, loss_d: 0.096056
0.6533 --- loss: 0.967713, loss_ss: 0.870745, loss_d: 0.096969
0.6918 --- loss: 0.818831, loss_ss: 0.699047, loss_d: 0.119784
0.7302 --- loss: 1.019738, loss_ss: 0.859287, loss_d: 0.160451
0.7686 --- loss: 0.764557, loss_ss: 0.712811, loss_d: 0.051746
0.8071 --- loss: 0.689172, loss_ss: 0.645486, loss_d: 0.043687
0.8455 --- loss: 0.676979, loss_ss: 0.539837, loss_d: 0.137142
0.8839 --- loss: 0.722977, loss_ss: 0.697739, loss_d: 0.025238
0.9224 --- loss: 0.734651, loss_ss: 0.717207, loss_d: 0.017444
0.9608 --- loss: 0.880012, loss_ss: 0.751768, loss_d: 0.128244
0.9992 --- loss: 1.112163, loss_ss: 0.620977, loss_d: 0.491185
Epoch finished! Loss: 0.9310056006679168
Starting epoch 7/10.
0.0000 --- loss: 1.559250, loss_ss: 1.132642, loss_d: 0.426608
0.0384 --- loss: 1.018416, loss_ss: 0.889307, loss_d: 0.129109
0.0769 --- loss: 0.902864, loss_ss: 0.842144, loss_d: 0.060720
0.1153 --- loss: 1.442902, loss_ss: 0.974614, loss_d: 0.468288
0.1537 --- loss: 0.813503, loss_ss: 0.782539, loss_d: 0.030963
0.1922 --- loss: 0.638903, loss_ss: 0.590478, loss_d: 0.048425
0.2306 --- loss: 1.111313, loss_ss: 0.833238, loss_d: 0.278075
0.2690 --- loss: 0.748895, loss_ss: 0.725996, loss_d: 0.022900
0.3075 --- loss: 0.817413, loss_ss: 0.779300, loss_d: 0.038113
0.3459 --- loss: 0.796789, loss_ss: 0.738320, loss_d: 0.058470
0.3843 --- loss: 0.876697, loss_ss: 0.642699, loss_d: 0.233998
0.4228 --- loss: 1.002277, loss_ss: 0.667076, loss_d: 0.335201
0.4612 --- loss: 0.703558, loss_ss: 0.611135, loss_d: 0.092422
0.4996 --- loss: 0.935437, loss_ss: 0.801678, loss_d: 0.133759
0.5380 --- loss: 0.925503, loss_ss: 0.727474, loss_d: 0.198029
0.5765 --- loss: 0.664681, loss_ss: 0.636377, loss_d: 0.028303
0.6149 --- loss: 0.940880, loss_ss: 0.932239, loss_d: 0.008640
0.6533 --- loss: 1.200316, loss_ss: 1.174252, loss_d: 0.026064
0.6918 --- loss: 0.838350, loss_ss: 0.709421, loss_d: 0.128929
0.7302 --- loss: 1.108613, loss_ss: 1.077146, loss_d: 0.031467
0.7686 --- loss: 0.617128, loss_ss: 0.453905, loss_d: 0.163223
0.8071 --- loss: 0.866970, loss_ss: 0.859563, loss_d: 0.007407
0.8455 --- loss: 1.200597, loss_ss: 1.094732, loss_d: 0.105865
0.8839 --- loss: 0.870944, loss_ss: 0.729927, loss_d: 0.141016
0.9224 --- loss: 0.846943, loss_ss: 0.833084, loss_d: 0.013859
0.9608 --- loss: 1.192411, loss_ss: 0.836688, loss_d: 0.355723
0.9992 --- loss: 0.820707, loss_ss: 0.806030, loss_d: 0.014676
Epoch finished! Loss: 0.8832400413659903
Starting epoch 8/10.
0.0000 --- loss: 0.680285, loss_ss: 0.581375, loss_d: 0.098910
0.0384 --- loss: 0.629381, loss_ss: 0.557490, loss_d: 0.071890
0.0769 --- loss: 0.646838, loss_ss: 0.633325, loss_d: 0.013513
0.1153 --- loss: 0.887307, loss_ss: 0.882961, loss_d: 0.004346
0.1537 --- loss: 1.028334, loss_ss: 1.014588, loss_d: 0.013746
0.1922 --- loss: 1.147318, loss_ss: 0.908918, loss_d: 0.238400
0.2306 --- loss: 0.869817, loss_ss: 0.852357, loss_d: 0.017460
0.2690 --- loss: 0.751453, loss_ss: 0.721322, loss_d: 0.030131
0.3075 --- loss: 0.838022, loss_ss: 0.829992, loss_d: 0.008030
0.3459 --- loss: 0.798285, loss_ss: 0.778063, loss_d: 0.020223
0.3843 --- loss: 0.589144, loss_ss: 0.497168, loss_d: 0.091976
0.4228 --- loss: 1.082564, loss_ss: 0.901580, loss_d: 0.180984
0.4612 --- loss: 0.993254, loss_ss: 0.472878, loss_d: 0.520376
0.4996 --- loss: 0.844444, loss_ss: 0.811585, loss_d: 0.032859
0.5380 --- loss: 0.779260, loss_ss: 0.737885, loss_d: 0.041375
0.5765 --- loss: 0.624094, loss_ss: 0.570302, loss_d: 0.053792
0.6149 --- loss: 0.872565, loss_ss: 0.859337, loss_d: 0.013228
0.6533 --- loss: 0.696331, loss_ss: 0.689937, loss_d: 0.006394
0.6918 --- loss: 0.646541, loss_ss: 0.597984, loss_d: 0.048557
0.7302 --- loss: 0.658982, loss_ss: 0.642131, loss_d: 0.016851
0.7686 --- loss: 0.765454, loss_ss: 0.684477, loss_d: 0.080977
0.8071 --- loss: 0.755134, loss_ss: 0.681183, loss_d: 0.073952
0.8455 --- loss: 0.810615, loss_ss: 0.677291, loss_d: 0.133324
0.8839 --- loss: 0.961288, loss_ss: 0.661278, loss_d: 0.300010
0.9224 --- loss: 1.195241, loss_ss: 1.013548, loss_d: 0.181692
0.9608 --- loss: 0.827249, loss_ss: 0.820275, loss_d: 0.006973
0.9992 --- loss: 0.909227, loss_ss: 0.904591, loss_d: 0.004636
Epoch finished! Loss: 0.8593100890517235
Starting epoch 9/10.
0.0000 --- loss: 0.635426, loss_ss: 0.613986, loss_d: 0.021440
0.0384 --- loss: 0.942901, loss_ss: 0.926295, loss_d: 0.016607
0.0769 --- loss: 1.084682, loss_ss: 1.010002, loss_d: 0.074680
0.1153 --- loss: 0.646418, loss_ss: 0.602734, loss_d: 0.043684
0.1537 --- loss: 0.681738, loss_ss: 0.595993, loss_d: 0.085745
0.1922 --- loss: 0.587724, loss_ss: 0.568562, loss_d: 0.019162
0.2306 --- loss: 0.825844, loss_ss: 0.804740, loss_d: 0.021105
0.2690 --- loss: 0.804299, loss_ss: 0.795221, loss_d: 0.009078
0.3075 --- loss: 0.747084, loss_ss: 0.726304, loss_d: 0.020780
0.3459 --- loss: 0.873429, loss_ss: 0.800003, loss_d: 0.073426
0.3843 --- loss: 0.701113, loss_ss: 0.629033, loss_d: 0.072079
0.4228 --- loss: 0.762146, loss_ss: 0.759792, loss_d: 0.002354
0.4612 --- loss: 0.646385, loss_ss: 0.555287, loss_d: 0.091098
0.4996 --- loss: 0.855639, loss_ss: 0.827709, loss_d: 0.027930
0.5380 --- loss: 0.727180, loss_ss: 0.602357, loss_d: 0.124823
0.5765 --- loss: 0.571730, loss_ss: 0.562132, loss_d: 0.009598
0.6149 --- loss: 0.544950, loss_ss: 0.406290, loss_d: 0.138660
0.6533 --- loss: 0.570698, loss_ss: 0.475149, loss_d: 0.095549
0.6918 --- loss: 0.635570, loss_ss: 0.598602, loss_d: 0.036968
0.7302 --- loss: 0.796074, loss_ss: 0.766707, loss_d: 0.029367
0.7686 --- loss: 0.722236, loss_ss: 0.712044, loss_d: 0.010192
0.8071 --- loss: 0.862456, loss_ss: 0.841954, loss_d: 0.020503
0.8455 --- loss: 0.680711, loss_ss: 0.595079, loss_d: 0.085632
0.8839 --- loss: 0.728877, loss_ss: 0.675063, loss_d: 0.053814
0.9224 --- loss: 0.909793, loss_ss: 0.822427, loss_d: 0.087366
0.9608 --- loss: 0.696538, loss_ss: 0.653409, loss_d: 0.043129
0.9992 --- loss: 2.678349, loss_ss: 0.998532, loss_d: 1.679817
Epoch finished! Loss: 0.8280869151537235
Starting epoch 10/10.
0.0000 --- loss: 0.554981, loss_ss: 0.552457, loss_d: 0.002523
0.0384 --- loss: 0.970955, loss_ss: 0.932340, loss_d: 0.038615
0.0769 --- loss: 1.019928, loss_ss: 0.835248, loss_d: 0.184680
0.1153 --- loss: 0.867579, loss_ss: 0.842071, loss_d: 0.025508
0.1537 --- loss: 0.943382, loss_ss: 0.935653, loss_d: 0.007730
0.1922 --- loss: 0.970533, loss_ss: 0.957117, loss_d: 0.013415
0.2306 --- loss: 0.861497, loss_ss: 0.858193, loss_d: 0.003304
0.2690 --- loss: 0.916972, loss_ss: 0.805530, loss_d: 0.111441
0.3075 --- loss: 0.813649, loss_ss: 0.792591, loss_d: 0.021057
0.3459 --- loss: 0.851284, loss_ss: 0.802408, loss_d: 0.048876
0.3843 --- loss: 0.729137, loss_ss: 0.701791, loss_d: 0.027346
0.4228 --- loss: 1.133356, loss_ss: 1.111263, loss_d: 0.022093
0.4612 --- loss: 0.970052, loss_ss: 0.953207, loss_d: 0.016844
0.4996 --- loss: 1.075406, loss_ss: 1.064639, loss_d: 0.010767
0.5380 --- loss: 0.794608, loss_ss: 0.670506, loss_d: 0.124101
0.5765 --- loss: 0.606518, loss_ss: 0.596539, loss_d: 0.009979
0.6149 --- loss: 0.964357, loss_ss: 0.906304, loss_d: 0.058052
0.6533 --- loss: 0.885933, loss_ss: 0.821498, loss_d: 0.064435
0.6918 --- loss: 0.792137, loss_ss: 0.787971, loss_d: 0.004166
0.7302 --- loss: 0.786842, loss_ss: 0.765514, loss_d: 0.021328
0.7686 --- loss: 1.003560, loss_ss: 0.869356, loss_d: 0.134205
0.8071 --- loss: 1.206232, loss_ss: 0.725793, loss_d: 0.480438
0.8455 --- loss: 0.764686, loss_ss: 0.752602, loss_d: 0.012085
0.8839 --- loss: 0.929387, loss_ss: 0.925086, loss_d: 0.004301
0.9224 --- loss: 0.683400, loss_ss: 0.613223, loss_d: 0.070177
0.9608 --- loss: 0.545451, loss_ss: 0.542688, loss_d: 0.002763
0.9992 --- loss: 0.798692, loss_ss: 0.792042, loss_d: 0.006650
Epoch finished! Loss: 0.8183425748577484
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7046296296296296
             precision    recall  f1-score   support

        0.0       0.96      0.80      0.87       226
        1.0       0.64      0.47      0.54       357
        2.0       0.71      0.80      0.75       192
        3.0       1.00      0.50      0.67         2
        4.0       0.62      0.85      0.72       303

avg / total       0.72      0.70      0.70      1080
 


====== chp046-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.19  80.09   99.18   96.28     87.44
1  73.80  46.78   87.14   64.23     54.13
2  90.74  79.69   93.13   71.50     75.37
3  99.91  50.00  100.00  100.00     66.67
4  81.30  85.48   79.67   62.11     71.94
Total accuracy: 70.46%
Average sen: 68.41%
Average spec: 91.82%
Macro f1-score: 71.11%
Diagnosis acc on 15mins: 1.0
[0.9999603  0.99999452 0.99996185 0.99999523 0.99999857 0.99999952
 0.99999988 0.99995577 0.99999654 0.99999893 0.99999762 0.99994981
 0.99999881 0.99999833 0.99999225 0.99999607 0.99998498 0.9999994
 0.99999881 1.         0.9999969  0.99999726 0.99996841 0.99999857
 0.99999976 0.99999988 0.99999988 0.99999726 0.99999845 0.99999964
 0.99999845 0.9999783  0.9999994  0.99997985 0.99999988 0.9999944 ]
pred: 0.9999912083148956, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.512879, loss_ss: 1.779062, loss_d: 0.733817
0.0383 --- loss: 2.812164, loss_ss: 1.727543, loss_d: 1.084621
0.0767 --- loss: 1.967793, loss_ss: 1.403182, loss_d: 0.564611
0.1150 --- loss: 2.316690, loss_ss: 1.598875, loss_d: 0.717815
0.1533 --- loss: 2.266096, loss_ss: 1.259979, loss_d: 1.006117
0.1916 --- loss: 1.914929, loss_ss: 1.283445, loss_d: 0.631485
0.2300 --- loss: 2.043734, loss_ss: 1.389235, loss_d: 0.654499
0.2683 --- loss: 1.979403, loss_ss: 1.338353, loss_d: 0.641050
0.3066 --- loss: 2.124435, loss_ss: 1.754538, loss_d: 0.369897
0.3450 --- loss: 2.667256, loss_ss: 1.753983, loss_d: 0.913273
0.3833 --- loss: 1.742444, loss_ss: 1.270410, loss_d: 0.472034
0.4216 --- loss: 2.068450, loss_ss: 1.495549, loss_d: 0.572901
0.4599 --- loss: 2.064097, loss_ss: 1.424045, loss_d: 0.640052
0.4983 --- loss: 1.888304, loss_ss: 1.372398, loss_d: 0.515905
0.5366 --- loss: 1.751388, loss_ss: 1.349034, loss_d: 0.402353
0.5749 --- loss: 2.050564, loss_ss: 1.225422, loss_d: 0.825141
0.6133 --- loss: 1.712235, loss_ss: 1.289955, loss_d: 0.422280
0.6516 --- loss: 1.660620, loss_ss: 1.340100, loss_d: 0.320520
0.6899 --- loss: 1.561810, loss_ss: 1.220510, loss_d: 0.341300
0.7282 --- loss: 2.075965, loss_ss: 1.460406, loss_d: 0.615559
0.7666 --- loss: 1.995802, loss_ss: 1.554069, loss_d: 0.441733
0.8049 --- loss: 1.593438, loss_ss: 1.056813, loss_d: 0.536624
0.8432 --- loss: 1.409611, loss_ss: 1.148537, loss_d: 0.261074
0.8816 --- loss: 1.657822, loss_ss: 1.372718, loss_d: 0.285103
0.9199 --- loss: 1.617455, loss_ss: 1.289108, loss_d: 0.328348
0.9582 --- loss: 1.568038, loss_ss: 1.292971, loss_d: 0.275066
0.9966 --- loss: 1.800652, loss_ss: 1.216951, loss_d: 0.583702
Epoch finished! Loss: 1.9466407881333279
Starting epoch 2/10.
0.0000 --- loss: 1.843821, loss_ss: 1.642443, loss_d: 0.201378
0.0383 --- loss: 1.556345, loss_ss: 1.307069, loss_d: 0.249276
0.0767 --- loss: 1.592618, loss_ss: 1.368331, loss_d: 0.224287
0.1150 --- loss: 2.024683, loss_ss: 1.282595, loss_d: 0.742088
0.1533 --- loss: 1.736675, loss_ss: 1.244265, loss_d: 0.492410
0.1916 --- loss: 1.344965, loss_ss: 1.068926, loss_d: 0.276038
0.2300 --- loss: 1.325311, loss_ss: 1.014134, loss_d: 0.311178
0.2683 --- loss: 1.987073, loss_ss: 1.149722, loss_d: 0.837351
0.3066 --- loss: 1.587539, loss_ss: 1.083350, loss_d: 0.504189
0.3450 --- loss: 1.287428, loss_ss: 1.075209, loss_d: 0.212219
0.3833 --- loss: 1.285138, loss_ss: 1.140529, loss_d: 0.144610
0.4216 --- loss: 1.428834, loss_ss: 1.072130, loss_d: 0.356704
0.4599 --- loss: 1.559415, loss_ss: 1.320677, loss_d: 0.238737
0.4983 --- loss: 1.821433, loss_ss: 1.563878, loss_d: 0.257555
0.5366 --- loss: 1.172337, loss_ss: 1.083891, loss_d: 0.088446
0.5749 --- loss: 1.284730, loss_ss: 1.065947, loss_d: 0.218783
0.6133 --- loss: 1.326278, loss_ss: 1.079873, loss_d: 0.246405
0.6516 --- loss: 1.270084, loss_ss: 1.144792, loss_d: 0.125293
0.6899 --- loss: 1.261152, loss_ss: 1.080224, loss_d: 0.180929
0.7282 --- loss: 1.543344, loss_ss: 1.176178, loss_d: 0.367166
0.7666 --- loss: 1.715691, loss_ss: 1.057737, loss_d: 0.657954
0.8049 --- loss: 1.271650, loss_ss: 1.135928, loss_d: 0.135722
0.8432 --- loss: 1.871172, loss_ss: 1.427128, loss_d: 0.444044
0.8816 --- loss: 1.346839, loss_ss: 1.121992, loss_d: 0.224847
0.9199 --- loss: 1.452494, loss_ss: 1.100634, loss_d: 0.351861
0.9582 --- loss: 1.213558, loss_ss: 1.103927, loss_d: 0.109631
0.9966 --- loss: 1.277811, loss_ss: 0.943832, loss_d: 0.333979
Epoch finished! Loss: 1.4810722167675312
Starting epoch 3/10.
0.0000 --- loss: 1.289937, loss_ss: 1.030510, loss_d: 0.259427
0.0383 --- loss: 1.330609, loss_ss: 0.852779, loss_d: 0.477829
0.0767 --- loss: 1.872170, loss_ss: 1.751048, loss_d: 0.121123
0.1150 --- loss: 1.599470, loss_ss: 1.047669, loss_d: 0.551801
0.1533 --- loss: 1.563270, loss_ss: 1.269324, loss_d: 0.293946
0.1916 --- loss: 1.093169, loss_ss: 0.926109, loss_d: 0.167060
0.2300 --- loss: 1.403653, loss_ss: 1.139371, loss_d: 0.264282
0.2683 --- loss: 1.304882, loss_ss: 1.000912, loss_d: 0.303970
0.3066 --- loss: 1.699674, loss_ss: 0.906809, loss_d: 0.792865
0.3450 --- loss: 1.178768, loss_ss: 0.973339, loss_d: 0.205428
0.3833 --- loss: 1.238896, loss_ss: 0.960056, loss_d: 0.278840
0.4216 --- loss: 1.081359, loss_ss: 0.882531, loss_d: 0.198828
0.4599 --- loss: 1.122692, loss_ss: 0.897870, loss_d: 0.224822
0.4983 --- loss: 1.240513, loss_ss: 1.040846, loss_d: 0.199667
0.5366 --- loss: 1.277773, loss_ss: 1.210748, loss_d: 0.067026
0.5749 --- loss: 1.999268, loss_ss: 1.115384, loss_d: 0.883884
0.6133 --- loss: 1.250296, loss_ss: 1.073439, loss_d: 0.176857
0.6516 --- loss: 1.061834, loss_ss: 1.019332, loss_d: 0.042502
0.6899 --- loss: 1.265005, loss_ss: 0.942108, loss_d: 0.322898
0.7282 --- loss: 0.845347, loss_ss: 0.758942, loss_d: 0.086406
0.7666 --- loss: 1.856393, loss_ss: 1.178148, loss_d: 0.678245
0.8049 --- loss: 1.639317, loss_ss: 1.094998, loss_d: 0.544319
0.8432 --- loss: 1.152645, loss_ss: 0.928423, loss_d: 0.224222
0.8816 --- loss: 1.044443, loss_ss: 0.817129, loss_d: 0.227314
0.9199 --- loss: 1.512855, loss_ss: 0.918571, loss_d: 0.594283
0.9582 --- loss: 1.286087, loss_ss: 1.004979, loss_d: 0.281108
0.9966 --- loss: 0.810491, loss_ss: 0.747324, loss_d: 0.063168
Epoch finished! Loss: 1.2823640261705105
Starting epoch 4/10.
0.0000 --- loss: 1.166832, loss_ss: 0.930988, loss_d: 0.235844
0.0383 --- loss: 1.118400, loss_ss: 0.947412, loss_d: 0.170988
0.0767 --- loss: 1.389814, loss_ss: 0.794809, loss_d: 0.595004
0.1150 --- loss: 1.831978, loss_ss: 1.353663, loss_d: 0.478315
0.1533 --- loss: 1.067534, loss_ss: 0.640642, loss_d: 0.426893
0.1916 --- loss: 1.223680, loss_ss: 0.637572, loss_d: 0.586109
0.2300 --- loss: 1.195371, loss_ss: 1.096833, loss_d: 0.098538
0.2683 --- loss: 1.222559, loss_ss: 0.930439, loss_d: 0.292119
0.3066 --- loss: 0.949688, loss_ss: 0.815306, loss_d: 0.134381
0.3450 --- loss: 1.029912, loss_ss: 0.963252, loss_d: 0.066660
0.3833 --- loss: 1.113495, loss_ss: 0.784357, loss_d: 0.329138
0.4216 --- loss: 1.529115, loss_ss: 0.767747, loss_d: 0.761368
0.4599 --- loss: 0.944402, loss_ss: 0.705140, loss_d: 0.239262
0.4983 --- loss: 1.002755, loss_ss: 0.795370, loss_d: 0.207385
0.5366 --- loss: 1.284349, loss_ss: 1.019330, loss_d: 0.265019
0.5749 --- loss: 1.203931, loss_ss: 1.144404, loss_d: 0.059527
0.6133 --- loss: 1.160344, loss_ss: 0.965805, loss_d: 0.194539
0.6516 --- loss: 0.893225, loss_ss: 0.828097, loss_d: 0.065128
0.6899 --- loss: 0.906946, loss_ss: 0.854858, loss_d: 0.052088
0.7282 --- loss: 0.913039, loss_ss: 0.840182, loss_d: 0.072857
0.7666 --- loss: 1.150200, loss_ss: 1.020688, loss_d: 0.129513
0.8049 --- loss: 1.073629, loss_ss: 0.851206, loss_d: 0.222423
0.8432 --- loss: 1.148315, loss_ss: 0.897952, loss_d: 0.250364
0.8816 --- loss: 1.348071, loss_ss: 0.940701, loss_d: 0.407370
0.9199 --- loss: 1.143687, loss_ss: 1.019786, loss_d: 0.123902
0.9582 --- loss: 0.965390, loss_ss: 0.947468, loss_d: 0.017922
0.9966 --- loss: 1.143428, loss_ss: 0.953015, loss_d: 0.190413
Epoch finished! Loss: 1.1575734665760626
Starting epoch 5/10.
0.0000 --- loss: 1.237713, loss_ss: 0.923083, loss_d: 0.314629
0.0383 --- loss: 1.422717, loss_ss: 1.024977, loss_d: 0.397739
0.0767 --- loss: 1.183569, loss_ss: 0.819176, loss_d: 0.364394
0.1150 --- loss: 1.255783, loss_ss: 1.033880, loss_d: 0.221903
0.1533 --- loss: 1.024560, loss_ss: 0.887986, loss_d: 0.136574
0.1916 --- loss: 1.122582, loss_ss: 0.971414, loss_d: 0.151168
0.2300 --- loss: 1.030935, loss_ss: 0.732010, loss_d: 0.298925
0.2683 --- loss: 0.957287, loss_ss: 0.818927, loss_d: 0.138360
0.3066 --- loss: 0.900680, loss_ss: 0.861098, loss_d: 0.039582
0.3450 --- loss: 1.080613, loss_ss: 1.006747, loss_d: 0.073865
0.3833 --- loss: 1.439855, loss_ss: 1.138425, loss_d: 0.301430
0.4216 --- loss: 0.899925, loss_ss: 0.886346, loss_d: 0.013580
0.4599 --- loss: 1.508374, loss_ss: 1.429683, loss_d: 0.078691
0.4983 --- loss: 1.036041, loss_ss: 0.908781, loss_d: 0.127260
0.5366 --- loss: 1.027511, loss_ss: 0.990169, loss_d: 0.037342
0.5749 --- loss: 1.062821, loss_ss: 0.959447, loss_d: 0.103374
0.6133 --- loss: 0.823368, loss_ss: 0.778866, loss_d: 0.044502
0.6516 --- loss: 0.905280, loss_ss: 0.878182, loss_d: 0.027098
0.6899 --- loss: 1.004738, loss_ss: 0.988324, loss_d: 0.016414
0.7282 --- loss: 0.966569, loss_ss: 0.749938, loss_d: 0.216630
0.7666 --- loss: 1.318288, loss_ss: 0.917628, loss_d: 0.400660
0.8049 --- loss: 0.872509, loss_ss: 0.755147, loss_d: 0.117362
0.8432 --- loss: 0.998590, loss_ss: 0.931258, loss_d: 0.067332
0.8816 --- loss: 1.165311, loss_ss: 0.883824, loss_d: 0.281487
0.9199 --- loss: 0.789476, loss_ss: 0.751942, loss_d: 0.037534
0.9582 --- loss: 0.818203, loss_ss: 0.717823, loss_d: 0.100380
0.9966 --- loss: 1.117639, loss_ss: 0.933711, loss_d: 0.183928
Epoch finished! Loss: 1.0869636535644531
Starting epoch 6/10.
0.0000 --- loss: 1.278519, loss_ss: 1.215667, loss_d: 0.062852
0.0383 --- loss: 0.933299, loss_ss: 0.898522, loss_d: 0.034777
0.0767 --- loss: 0.869587, loss_ss: 0.841435, loss_d: 0.028152
0.1150 --- loss: 0.815968, loss_ss: 0.790339, loss_d: 0.025629
0.1533 --- loss: 0.997534, loss_ss: 0.764103, loss_d: 0.233431
0.1916 --- loss: 0.983795, loss_ss: 0.896888, loss_d: 0.086907
0.2300 --- loss: 1.059387, loss_ss: 1.024448, loss_d: 0.034939
0.2683 --- loss: 0.847622, loss_ss: 0.712835, loss_d: 0.134787
0.3066 --- loss: 1.123732, loss_ss: 0.801783, loss_d: 0.321949
0.3450 --- loss: 0.851935, loss_ss: 0.740911, loss_d: 0.111024
0.3833 --- loss: 1.355819, loss_ss: 0.907334, loss_d: 0.448485
0.4216 --- loss: 1.230362, loss_ss: 0.962198, loss_d: 0.268164
0.4599 --- loss: 0.934800, loss_ss: 0.853243, loss_d: 0.081557
0.4983 --- loss: 0.838874, loss_ss: 0.684326, loss_d: 0.154549
0.5366 --- loss: 1.253899, loss_ss: 1.044967, loss_d: 0.208933
0.5749 --- loss: 0.878584, loss_ss: 0.746082, loss_d: 0.132502
0.6133 --- loss: 1.005986, loss_ss: 0.905784, loss_d: 0.100202
0.6516 --- loss: 0.781942, loss_ss: 0.738346, loss_d: 0.043596
0.6899 --- loss: 0.829552, loss_ss: 0.795734, loss_d: 0.033818
0.7282 --- loss: 0.881984, loss_ss: 0.796621, loss_d: 0.085364
0.7666 --- loss: 0.859054, loss_ss: 0.785618, loss_d: 0.073436
0.8049 --- loss: 1.083441, loss_ss: 1.038400, loss_d: 0.045041
0.8432 --- loss: 1.258628, loss_ss: 0.789203, loss_d: 0.469425
0.8816 --- loss: 1.006799, loss_ss: 0.934684, loss_d: 0.072115
0.9199 --- loss: 1.089148, loss_ss: 0.943653, loss_d: 0.145495
0.9582 --- loss: 0.805242, loss_ss: 0.761949, loss_d: 0.043293
0.9966 --- loss: 0.697044, loss_ss: 0.682331, loss_d: 0.014713
Epoch finished! Loss: 0.9919293305048575
Starting epoch 7/10.
0.0000 --- loss: 0.815759, loss_ss: 0.704132, loss_d: 0.111627
0.0383 --- loss: 0.821849, loss_ss: 0.795903, loss_d: 0.025946
0.0767 --- loss: 0.844862, loss_ss: 0.777645, loss_d: 0.067217
0.1150 --- loss: 1.190024, loss_ss: 1.141075, loss_d: 0.048950
0.1533 --- loss: 0.899885, loss_ss: 0.891728, loss_d: 0.008157
0.1916 --- loss: 0.757622, loss_ss: 0.743907, loss_d: 0.013715
0.2300 --- loss: 0.895515, loss_ss: 0.712969, loss_d: 0.182546
0.2683 --- loss: 0.824283, loss_ss: 0.786348, loss_d: 0.037935
0.3066 --- loss: 0.766964, loss_ss: 0.764789, loss_d: 0.002175
0.3450 --- loss: 1.257638, loss_ss: 1.247807, loss_d: 0.009831
0.3833 --- loss: 0.682714, loss_ss: 0.660417, loss_d: 0.022296
0.4216 --- loss: 0.707640, loss_ss: 0.705789, loss_d: 0.001852
0.4599 --- loss: 0.956976, loss_ss: 0.951806, loss_d: 0.005169
0.4983 --- loss: 0.697201, loss_ss: 0.673751, loss_d: 0.023450
0.5366 --- loss: 0.835740, loss_ss: 0.810798, loss_d: 0.024942
0.5749 --- loss: 0.909837, loss_ss: 0.898663, loss_d: 0.011174
0.6133 --- loss: 1.110068, loss_ss: 0.967723, loss_d: 0.142345
0.6516 --- loss: 1.796019, loss_ss: 1.694582, loss_d: 0.101437
0.6899 --- loss: 0.760029, loss_ss: 0.650500, loss_d: 0.109530
0.7282 --- loss: 0.810164, loss_ss: 0.771200, loss_d: 0.038964
0.7666 --- loss: 0.775078, loss_ss: 0.754880, loss_d: 0.020197
0.8049 --- loss: 0.966359, loss_ss: 0.919666, loss_d: 0.046693
0.8432 --- loss: 0.841119, loss_ss: 0.816422, loss_d: 0.024697
0.8816 --- loss: 0.908033, loss_ss: 0.856252, loss_d: 0.051781
0.9199 --- loss: 0.756677, loss_ss: 0.649218, loss_d: 0.107458
0.9582 --- loss: 1.004137, loss_ss: 0.782575, loss_d: 0.221562
0.9966 --- loss: 0.674108, loss_ss: 0.652817, loss_d: 0.021291
Epoch finished! Loss: 0.9392594516277313
Starting epoch 8/10.
0.0000 --- loss: 0.945635, loss_ss: 0.936911, loss_d: 0.008725
0.0383 --- loss: 1.183856, loss_ss: 1.120711, loss_d: 0.063145
0.0767 --- loss: 0.754694, loss_ss: 0.739396, loss_d: 0.015298
0.1150 --- loss: 0.907653, loss_ss: 0.776838, loss_d: 0.130815
0.1533 --- loss: 0.876808, loss_ss: 0.654107, loss_d: 0.222701
0.1916 --- loss: 0.840964, loss_ss: 0.761014, loss_d: 0.079950
0.2300 --- loss: 0.957428, loss_ss: 0.935468, loss_d: 0.021960
0.2683 --- loss: 0.745689, loss_ss: 0.714480, loss_d: 0.031209
0.3066 --- loss: 0.941462, loss_ss: 0.822481, loss_d: 0.118981
0.3450 --- loss: 0.682991, loss_ss: 0.520327, loss_d: 0.162664
0.3833 --- loss: 0.927971, loss_ss: 0.907781, loss_d: 0.020190
0.4216 --- loss: 0.857224, loss_ss: 0.766077, loss_d: 0.091147
0.4599 --- loss: 0.895349, loss_ss: 0.747735, loss_d: 0.147615
0.4983 --- loss: 0.792559, loss_ss: 0.787536, loss_d: 0.005023
0.5366 --- loss: 0.700619, loss_ss: 0.670884, loss_d: 0.029735
0.5749 --- loss: 0.974366, loss_ss: 0.900558, loss_d: 0.073808
0.6133 --- loss: 1.052737, loss_ss: 0.883230, loss_d: 0.169507
0.6516 --- loss: 0.828154, loss_ss: 0.801107, loss_d: 0.027047
0.6899 --- loss: 1.039094, loss_ss: 0.750861, loss_d: 0.288233
0.7282 --- loss: 0.734721, loss_ss: 0.700103, loss_d: 0.034617
0.7666 --- loss: 1.253688, loss_ss: 0.949416, loss_d: 0.304272
0.8049 --- loss: 0.682254, loss_ss: 0.560855, loss_d: 0.121399
0.8432 --- loss: 1.466314, loss_ss: 1.450837, loss_d: 0.015476
0.8816 --- loss: 1.255575, loss_ss: 1.229418, loss_d: 0.026157
0.9199 --- loss: 0.783000, loss_ss: 0.767102, loss_d: 0.015897
0.9582 --- loss: 1.069523, loss_ss: 0.704055, loss_d: 0.365468
0.9966 --- loss: 0.719045, loss_ss: 0.690649, loss_d: 0.028396
Epoch finished! Loss: 0.8945976825860831
Starting epoch 9/10.
0.0000 --- loss: 0.692874, loss_ss: 0.668761, loss_d: 0.024113
0.0383 --- loss: 0.831038, loss_ss: 0.761982, loss_d: 0.069056
0.0767 --- loss: 0.574590, loss_ss: 0.566122, loss_d: 0.008468
0.1150 --- loss: 1.488183, loss_ss: 1.415385, loss_d: 0.072799
0.1533 --- loss: 0.635085, loss_ss: 0.630553, loss_d: 0.004532
0.1916 --- loss: 0.548435, loss_ss: 0.501367, loss_d: 0.047068
0.2300 --- loss: 0.732828, loss_ss: 0.731189, loss_d: 0.001640
0.2683 --- loss: 0.644321, loss_ss: 0.640977, loss_d: 0.003344
0.3066 --- loss: 0.945554, loss_ss: 0.633067, loss_d: 0.312487
0.3450 --- loss: 0.712021, loss_ss: 0.702607, loss_d: 0.009414
0.3833 --- loss: 0.779121, loss_ss: 0.775709, loss_d: 0.003412
0.4216 --- loss: 0.834821, loss_ss: 0.534385, loss_d: 0.300436
0.4599 --- loss: 0.532477, loss_ss: 0.515507, loss_d: 0.016970
0.4983 --- loss: 0.865705, loss_ss: 0.842788, loss_d: 0.022917
0.5366 --- loss: 0.794719, loss_ss: 0.680463, loss_d: 0.114255
0.5749 --- loss: 0.892045, loss_ss: 0.881650, loss_d: 0.010395
0.6133 --- loss: 0.848476, loss_ss: 0.802919, loss_d: 0.045556
0.6516 --- loss: 1.426759, loss_ss: 1.360993, loss_d: 0.065766
0.6899 --- loss: 0.766185, loss_ss: 0.756384, loss_d: 0.009802
0.7282 --- loss: 1.145415, loss_ss: 0.686508, loss_d: 0.458907
0.7666 --- loss: 0.830868, loss_ss: 0.825366, loss_d: 0.005502
0.8049 --- loss: 0.595320, loss_ss: 0.585263, loss_d: 0.010058
0.8432 --- loss: 0.614097, loss_ss: 0.605744, loss_d: 0.008353
0.8816 --- loss: 0.668417, loss_ss: 0.658805, loss_d: 0.009612
0.9199 --- loss: 0.674208, loss_ss: 0.614051, loss_d: 0.060156
0.9582 --- loss: 1.183524, loss_ss: 1.165318, loss_d: 0.018206
0.9966 --- loss: 1.156026, loss_ss: 1.127923, loss_d: 0.028103
Epoch finished! Loss: 0.8592231026062599
Starting epoch 10/10.
0.0000 --- loss: 0.947056, loss_ss: 0.864329, loss_d: 0.082727
0.0383 --- loss: 0.842217, loss_ss: 0.721027, loss_d: 0.121190
0.0767 --- loss: 1.002651, loss_ss: 0.970938, loss_d: 0.031713
0.1150 --- loss: 0.827623, loss_ss: 0.707238, loss_d: 0.120385
0.1533 --- loss: 0.732230, loss_ss: 0.725448, loss_d: 0.006781
0.1916 --- loss: 0.831680, loss_ss: 0.740981, loss_d: 0.090699
0.2300 --- loss: 0.650077, loss_ss: 0.614898, loss_d: 0.035179
0.2683 --- loss: 0.696241, loss_ss: 0.684386, loss_d: 0.011855
0.3066 --- loss: 0.651567, loss_ss: 0.643077, loss_d: 0.008490
0.3450 --- loss: 1.153412, loss_ss: 1.140734, loss_d: 0.012679
0.3833 --- loss: 0.626790, loss_ss: 0.576738, loss_d: 0.050052
0.4216 --- loss: 1.005470, loss_ss: 0.957669, loss_d: 0.047801
0.4599 --- loss: 0.899697, loss_ss: 0.884540, loss_d: 0.015156
0.4983 --- loss: 0.884756, loss_ss: 0.877801, loss_d: 0.006955
0.5366 --- loss: 0.869486, loss_ss: 0.767458, loss_d: 0.102028
0.5749 --- loss: 0.718462, loss_ss: 0.636904, loss_d: 0.081558
0.6133 --- loss: 0.881260, loss_ss: 0.763451, loss_d: 0.117809
0.6516 --- loss: 0.699874, loss_ss: 0.686790, loss_d: 0.013084
0.6899 --- loss: 0.624579, loss_ss: 0.599627, loss_d: 0.024952
0.7282 --- loss: 0.762164, loss_ss: 0.756690, loss_d: 0.005474
0.7666 --- loss: 0.645678, loss_ss: 0.619210, loss_d: 0.026468
0.8049 --- loss: 0.794684, loss_ss: 0.740259, loss_d: 0.054425
0.8432 --- loss: 0.961954, loss_ss: 0.876944, loss_d: 0.085010
0.8816 --- loss: 0.881982, loss_ss: 0.838239, loss_d: 0.043743
0.9199 --- loss: 0.890793, loss_ss: 0.881471, loss_d: 0.009322
0.9582 --- loss: 0.570647, loss_ss: 0.539574, loss_d: 0.031073
0.9966 --- loss: 0.754769, loss_ss: 0.737779, loss_d: 0.016989
Epoch finished! Loss: 0.8343834919425157
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.2988505747126437
             precision    recall  f1-score   support

        0.0       0.64      0.64      0.64       291
        1.0       0.00      0.00      0.00       231
        2.0       0.36      0.04      0.08       233
        3.0       0.00      0.00      0.00        25
        4.0       0.12      0.72      0.21        90

avg / total       0.32      0.30      0.25       870
 


====== chp047-nsrr ======

The f1-score of  1  has ZeroDivisionError.

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  75.63  63.57   81.69  63.57     63.57
1  72.41   0.00   98.59   0.00      0.00
2  72.30   4.29   97.17  35.71      7.66
3  97.13   0.00  100.00   0.00      0.00
4  42.30  72.22   38.85  11.99     20.57
Total accuracy: 29.89%
Average sen: 28.02%
Average spec: 83.26%
Macro f1-score: 18.36%
Diagnosis acc on 15mins: 1.0
[0.99999988 0.99999964 0.99999988 0.99999988 1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         0.99999964 1.
 1.         1.         1.         1.         1.         1.
 0.99999356 0.99999988 1.         0.99999905 0.99999785]
pred: 0.9999996300401359, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.455254, loss_ss: 1.766849, loss_d: 0.688405
0.0384 --- loss: 2.243586, loss_ss: 1.617154, loss_d: 0.626433
0.0768 --- loss: 2.242593, loss_ss: 1.510800, loss_d: 0.731793
0.1152 --- loss: 1.874056, loss_ss: 1.242666, loss_d: 0.631389
0.1536 --- loss: 2.149335, loss_ss: 1.356221, loss_d: 0.793114
0.1920 --- loss: 2.271960, loss_ss: 1.604747, loss_d: 0.667214
0.2304 --- loss: 1.811723, loss_ss: 1.279390, loss_d: 0.532333
0.2688 --- loss: 1.846123, loss_ss: 1.370219, loss_d: 0.475904
0.3072 --- loss: 2.207572, loss_ss: 1.196230, loss_d: 1.011342
0.3456 --- loss: 1.827356, loss_ss: 1.238284, loss_d: 0.589072
0.3840 --- loss: 1.949124, loss_ss: 1.266459, loss_d: 0.682665
0.4224 --- loss: 1.660324, loss_ss: 1.212225, loss_d: 0.448099
0.4608 --- loss: 2.174154, loss_ss: 1.552570, loss_d: 0.621584
0.4992 --- loss: 1.781314, loss_ss: 1.193753, loss_d: 0.587560
0.5376 --- loss: 1.652151, loss_ss: 1.193216, loss_d: 0.458935
0.5760 --- loss: 1.451313, loss_ss: 1.101868, loss_d: 0.349445
0.6144 --- loss: 1.517359, loss_ss: 1.226450, loss_d: 0.290909
0.6528 --- loss: 1.832866, loss_ss: 1.290349, loss_d: 0.542517
0.6912 --- loss: 1.835571, loss_ss: 1.486651, loss_d: 0.348920
0.7296 --- loss: 1.757208, loss_ss: 1.282738, loss_d: 0.474471
0.7680 --- loss: 1.457603, loss_ss: 1.151840, loss_d: 0.305762
0.8065 --- loss: 1.267547, loss_ss: 1.063932, loss_d: 0.203615
0.8449 --- loss: 1.438585, loss_ss: 1.225805, loss_d: 0.212780
0.8833 --- loss: 1.538085, loss_ss: 1.155129, loss_d: 0.382957
0.9217 --- loss: 1.572042, loss_ss: 1.133290, loss_d: 0.438752
0.9601 --- loss: 1.386163, loss_ss: 1.215495, loss_d: 0.170668
0.9985 --- loss: 1.871106, loss_ss: 1.252603, loss_d: 0.618503
Epoch finished! Loss: 1.832312822341919
Starting epoch 2/10.
0.0000 --- loss: 1.580491, loss_ss: 1.338522, loss_d: 0.241969
0.0384 --- loss: 1.577201, loss_ss: 1.137774, loss_d: 0.439427
0.0768 --- loss: 1.359915, loss_ss: 1.197013, loss_d: 0.162902
0.1152 --- loss: 1.611967, loss_ss: 1.149359, loss_d: 0.462608
0.1536 --- loss: 1.204901, loss_ss: 1.091992, loss_d: 0.112910
0.1920 --- loss: 1.568757, loss_ss: 1.070921, loss_d: 0.497836
0.2304 --- loss: 1.443804, loss_ss: 1.252647, loss_d: 0.191157
0.2688 --- loss: 1.665514, loss_ss: 1.222809, loss_d: 0.442705
0.3072 --- loss: 1.290621, loss_ss: 1.061786, loss_d: 0.228835
0.3456 --- loss: 1.293146, loss_ss: 1.102700, loss_d: 0.190447
0.3840 --- loss: 1.308281, loss_ss: 1.230771, loss_d: 0.077510
0.4224 --- loss: 1.246292, loss_ss: 0.991386, loss_d: 0.254907
0.4608 --- loss: 1.210939, loss_ss: 1.108609, loss_d: 0.102329
0.4992 --- loss: 1.868788, loss_ss: 1.118612, loss_d: 0.750175
0.5376 --- loss: 1.549771, loss_ss: 1.388592, loss_d: 0.161179
0.5760 --- loss: 1.203737, loss_ss: 0.995260, loss_d: 0.208477
0.6144 --- loss: 0.968300, loss_ss: 0.796063, loss_d: 0.172236
0.6528 --- loss: 1.116722, loss_ss: 0.963928, loss_d: 0.152794
0.6912 --- loss: 1.137770, loss_ss: 0.975553, loss_d: 0.162217
0.7296 --- loss: 1.282688, loss_ss: 1.054162, loss_d: 0.228527
0.7680 --- loss: 1.030950, loss_ss: 0.854514, loss_d: 0.176436
0.8065 --- loss: 1.151052, loss_ss: 0.955726, loss_d: 0.195326
0.8449 --- loss: 1.508137, loss_ss: 1.026264, loss_d: 0.481873
0.8833 --- loss: 1.065369, loss_ss: 0.961867, loss_d: 0.103503
0.9217 --- loss: 1.017641, loss_ss: 0.839056, loss_d: 0.178585
0.9601 --- loss: 1.134340, loss_ss: 0.949878, loss_d: 0.184462
0.9985 --- loss: 1.252243, loss_ss: 1.097068, loss_d: 0.155175
Epoch finished! Loss: 1.4006796758908493
Starting epoch 3/10.
0.0000 --- loss: 1.048339, loss_ss: 0.800735, loss_d: 0.247604
0.0384 --- loss: 1.178357, loss_ss: 1.147207, loss_d: 0.031150
0.0768 --- loss: 1.124638, loss_ss: 1.007975, loss_d: 0.116664
0.1152 --- loss: 1.076723, loss_ss: 0.929537, loss_d: 0.147187
0.1536 --- loss: 1.199526, loss_ss: 1.075886, loss_d: 0.123639
0.1920 --- loss: 1.256812, loss_ss: 1.140330, loss_d: 0.116482
0.2304 --- loss: 1.704845, loss_ss: 1.651349, loss_d: 0.053496
0.2688 --- loss: 1.323701, loss_ss: 0.987824, loss_d: 0.335877
0.3072 --- loss: 1.132681, loss_ss: 1.060961, loss_d: 0.071721
0.3456 --- loss: 1.350407, loss_ss: 0.937248, loss_d: 0.413159
0.3840 --- loss: 1.216668, loss_ss: 1.021727, loss_d: 0.194941
0.4224 --- loss: 1.705725, loss_ss: 1.002728, loss_d: 0.702997
0.4608 --- loss: 0.916700, loss_ss: 0.877139, loss_d: 0.039561
0.4992 --- loss: 1.133781, loss_ss: 1.075435, loss_d: 0.058346
0.5376 --- loss: 1.307649, loss_ss: 1.002707, loss_d: 0.304942
0.5760 --- loss: 0.930338, loss_ss: 0.826072, loss_d: 0.104266
0.6144 --- loss: 1.064803, loss_ss: 1.013833, loss_d: 0.050970
0.6528 --- loss: 1.125111, loss_ss: 1.016265, loss_d: 0.108846
0.6912 --- loss: 1.126034, loss_ss: 0.925891, loss_d: 0.200143
0.7296 --- loss: 1.241524, loss_ss: 0.899008, loss_d: 0.342516
0.7680 --- loss: 0.994950, loss_ss: 0.834824, loss_d: 0.160126
0.8065 --- loss: 1.328743, loss_ss: 0.730240, loss_d: 0.598504
0.8449 --- loss: 1.631969, loss_ss: 1.276775, loss_d: 0.355194
0.8833 --- loss: 1.098157, loss_ss: 0.753671, loss_d: 0.344485
0.9217 --- loss: 1.375958, loss_ss: 0.943818, loss_d: 0.432140
0.9601 --- loss: 1.397684, loss_ss: 1.273121, loss_d: 0.124563
0.9985 --- loss: 1.208709, loss_ss: 0.813426, loss_d: 0.395283
Epoch finished! Loss: 1.2797514140605926
Starting epoch 4/10.
0.0000 --- loss: 1.054271, loss_ss: 0.967689, loss_d: 0.086582
0.0384 --- loss: 1.124762, loss_ss: 1.013460, loss_d: 0.111302
0.0768 --- loss: 1.456589, loss_ss: 0.801027, loss_d: 0.655561
0.1152 --- loss: 1.318519, loss_ss: 1.033832, loss_d: 0.284687
0.1536 --- loss: 1.610304, loss_ss: 1.249583, loss_d: 0.360721
0.1920 --- loss: 1.381702, loss_ss: 1.227541, loss_d: 0.154161
0.2304 --- loss: 0.983491, loss_ss: 0.797103, loss_d: 0.186389
0.2688 --- loss: 1.463121, loss_ss: 1.235566, loss_d: 0.227556
0.3072 --- loss: 1.039973, loss_ss: 0.979083, loss_d: 0.060890
0.3456 --- loss: 0.948425, loss_ss: 0.724890, loss_d: 0.223535
0.3840 --- loss: 1.056144, loss_ss: 0.906999, loss_d: 0.149146
0.4224 --- loss: 0.956837, loss_ss: 0.838362, loss_d: 0.118475
0.4608 --- loss: 1.223005, loss_ss: 1.011695, loss_d: 0.211310
0.4992 --- loss: 0.959808, loss_ss: 0.838583, loss_d: 0.121225
0.5376 --- loss: 1.082264, loss_ss: 0.828653, loss_d: 0.253611
0.5760 --- loss: 1.664682, loss_ss: 1.256716, loss_d: 0.407966
0.6144 --- loss: 1.409120, loss_ss: 1.061912, loss_d: 0.347208
0.6528 --- loss: 1.031473, loss_ss: 0.867385, loss_d: 0.164088
0.6912 --- loss: 0.820415, loss_ss: 0.735171, loss_d: 0.085244
0.7296 --- loss: 1.002355, loss_ss: 0.969010, loss_d: 0.033345
0.7680 --- loss: 1.140170, loss_ss: 0.982314, loss_d: 0.157855
0.8065 --- loss: 1.191008, loss_ss: 0.821635, loss_d: 0.369373
0.8449 --- loss: 0.896151, loss_ss: 0.809535, loss_d: 0.086617
0.8833 --- loss: 1.055915, loss_ss: 1.001626, loss_d: 0.054289
0.9217 --- loss: 1.121194, loss_ss: 1.107005, loss_d: 0.014189
0.9601 --- loss: 0.952188, loss_ss: 0.902678, loss_d: 0.049511
0.9985 --- loss: 0.683529, loss_ss: 0.674465, loss_d: 0.009064
Epoch finished! Loss: 1.1612877368927002
Starting epoch 5/10.
0.0000 --- loss: 0.944800, loss_ss: 0.809100, loss_d: 0.135701
0.0384 --- loss: 0.959685, loss_ss: 0.818094, loss_d: 0.141591
0.0768 --- loss: 1.271443, loss_ss: 1.250485, loss_d: 0.020958
0.1152 --- loss: 1.028601, loss_ss: 0.939707, loss_d: 0.088894
0.1536 --- loss: 0.792070, loss_ss: 0.776362, loss_d: 0.015708
0.1920 --- loss: 1.446238, loss_ss: 1.344153, loss_d: 0.102086
0.2304 --- loss: 1.217610, loss_ss: 1.172615, loss_d: 0.044995
0.2688 --- loss: 1.250920, loss_ss: 0.911494, loss_d: 0.339426
0.3072 --- loss: 1.104886, loss_ss: 0.811374, loss_d: 0.293512
0.3456 --- loss: 0.903446, loss_ss: 0.797262, loss_d: 0.106184
0.3840 --- loss: 1.216904, loss_ss: 0.751517, loss_d: 0.465387
0.4224 --- loss: 0.958054, loss_ss: 0.804547, loss_d: 0.153507
0.4608 --- loss: 1.090792, loss_ss: 1.070823, loss_d: 0.019969
0.4992 --- loss: 0.954014, loss_ss: 0.870581, loss_d: 0.083433
0.5376 --- loss: 1.066001, loss_ss: 1.045680, loss_d: 0.020321
0.5760 --- loss: 0.914862, loss_ss: 0.841599, loss_d: 0.073264
0.6144 --- loss: 0.847729, loss_ss: 0.722997, loss_d: 0.124731
0.6528 --- loss: 1.173913, loss_ss: 1.068684, loss_d: 0.105229
0.6912 --- loss: 0.959785, loss_ss: 0.860000, loss_d: 0.099786
0.7296 --- loss: 0.854894, loss_ss: 0.781828, loss_d: 0.073066
0.7680 --- loss: 1.163369, loss_ss: 0.741555, loss_d: 0.421814
0.8065 --- loss: 0.918968, loss_ss: 0.806008, loss_d: 0.112960
0.8449 --- loss: 0.665080, loss_ss: 0.573975, loss_d: 0.091105
0.8833 --- loss: 0.965397, loss_ss: 0.857531, loss_d: 0.107866
0.9217 --- loss: 1.141631, loss_ss: 0.896018, loss_d: 0.245613
0.9601 --- loss: 1.028184, loss_ss: 0.875225, loss_d: 0.152960
0.9985 --- loss: 0.696763, loss_ss: 0.676896, loss_d: 0.019866
Epoch finished! Loss: 1.0750341000465247
Starting epoch 6/10.
0.0000 --- loss: 0.742694, loss_ss: 0.675667, loss_d: 0.067027
0.0384 --- loss: 0.864052, loss_ss: 0.813656, loss_d: 0.050395
0.0768 --- loss: 0.967138, loss_ss: 0.868835, loss_d: 0.098303
0.1152 --- loss: 1.444312, loss_ss: 0.899973, loss_d: 0.544339
0.1536 --- loss: 1.027294, loss_ss: 0.783584, loss_d: 0.243709
0.1920 --- loss: 1.037499, loss_ss: 0.701333, loss_d: 0.336166
0.2304 --- loss: 0.937853, loss_ss: 0.906640, loss_d: 0.031213
0.2688 --- loss: 0.811293, loss_ss: 0.746582, loss_d: 0.064711
0.3072 --- loss: 0.967342, loss_ss: 0.812219, loss_d: 0.155123
0.3456 --- loss: 1.124988, loss_ss: 1.102113, loss_d: 0.022875
0.3840 --- loss: 0.822345, loss_ss: 0.767934, loss_d: 0.054411
0.4224 --- loss: 0.740119, loss_ss: 0.698580, loss_d: 0.041539
0.4608 --- loss: 0.899910, loss_ss: 0.883792, loss_d: 0.016118
0.4992 --- loss: 0.914323, loss_ss: 0.899547, loss_d: 0.014775
0.5376 --- loss: 0.650655, loss_ss: 0.574692, loss_d: 0.075964
0.5760 --- loss: 0.972682, loss_ss: 0.885427, loss_d: 0.087255
0.6144 --- loss: 1.014919, loss_ss: 0.961159, loss_d: 0.053760
0.6528 --- loss: 0.573232, loss_ss: 0.563886, loss_d: 0.009346
0.6912 --- loss: 0.935574, loss_ss: 0.860706, loss_d: 0.074869
0.7296 --- loss: 1.287259, loss_ss: 0.909100, loss_d: 0.378159
0.7680 --- loss: 1.167277, loss_ss: 1.030010, loss_d: 0.137267
0.8065 --- loss: 0.999841, loss_ss: 0.953645, loss_d: 0.046196
0.8449 --- loss: 0.752105, loss_ss: 0.636097, loss_d: 0.116009
0.8833 --- loss: 1.066664, loss_ss: 1.005085, loss_d: 0.061579
0.9217 --- loss: 0.971084, loss_ss: 0.940132, loss_d: 0.030952
0.9601 --- loss: 1.537134, loss_ss: 1.255711, loss_d: 0.281423
0.9985 --- loss: 1.006329, loss_ss: 0.977429, loss_d: 0.028900
Epoch finished! Loss: 1.0586500131166898
Starting epoch 7/10.
0.0000 --- loss: 1.207202, loss_ss: 1.125983, loss_d: 0.081219
0.0384 --- loss: 0.889719, loss_ss: 0.711938, loss_d: 0.177780
0.0768 --- loss: 0.798364, loss_ss: 0.779219, loss_d: 0.019145
0.1152 --- loss: 0.936361, loss_ss: 0.812182, loss_d: 0.124179
0.1536 --- loss: 1.048089, loss_ss: 0.703894, loss_d: 0.344195
0.1920 --- loss: 0.874003, loss_ss: 0.837922, loss_d: 0.036081
0.2304 --- loss: 1.073786, loss_ss: 0.963421, loss_d: 0.110364
0.2688 --- loss: 0.920177, loss_ss: 0.795843, loss_d: 0.124334
0.3072 --- loss: 0.888616, loss_ss: 0.869300, loss_d: 0.019316
0.3456 --- loss: 1.264259, loss_ss: 1.092318, loss_d: 0.171942
0.3840 --- loss: 0.891073, loss_ss: 0.872397, loss_d: 0.018676
0.4224 --- loss: 1.014180, loss_ss: 0.980969, loss_d: 0.033211
0.4608 --- loss: 0.702755, loss_ss: 0.660618, loss_d: 0.042137
0.4992 --- loss: 0.826018, loss_ss: 0.759719, loss_d: 0.066299
0.5376 --- loss: 0.755040, loss_ss: 0.730371, loss_d: 0.024669
0.5760 --- loss: 0.789878, loss_ss: 0.710374, loss_d: 0.079503
0.6144 --- loss: 0.770161, loss_ss: 0.767056, loss_d: 0.003106
0.6528 --- loss: 0.879992, loss_ss: 0.874086, loss_d: 0.005905
0.6912 --- loss: 1.442333, loss_ss: 1.061531, loss_d: 0.380802
0.7296 --- loss: 0.897287, loss_ss: 0.875808, loss_d: 0.021479
0.7680 --- loss: 0.809144, loss_ss: 0.704019, loss_d: 0.105125
0.8065 --- loss: 0.988276, loss_ss: 0.907308, loss_d: 0.080968
0.8449 --- loss: 0.904380, loss_ss: 0.890768, loss_d: 0.013611
0.8833 --- loss: 0.809283, loss_ss: 0.699701, loss_d: 0.109581
0.9217 --- loss: 0.717438, loss_ss: 0.656744, loss_d: 0.060694
0.9601 --- loss: 0.748725, loss_ss: 0.643889, loss_d: 0.104836
0.9985 --- loss: 1.247610, loss_ss: 1.236742, loss_d: 0.010868
Epoch finished! Loss: 0.9781746055071171
Starting epoch 8/10.
0.0000 --- loss: 1.322601, loss_ss: 0.948143, loss_d: 0.374458
0.0384 --- loss: 1.037726, loss_ss: 0.921326, loss_d: 0.116400
0.0768 --- loss: 1.250374, loss_ss: 0.812514, loss_d: 0.437860
0.1152 --- loss: 1.108006, loss_ss: 1.102733, loss_d: 0.005272
0.1536 --- loss: 1.069677, loss_ss: 0.695220, loss_d: 0.374457
0.1920 --- loss: 0.992896, loss_ss: 0.981310, loss_d: 0.011586
0.2304 --- loss: 0.978679, loss_ss: 0.912825, loss_d: 0.065854
0.2688 --- loss: 0.870423, loss_ss: 0.843419, loss_d: 0.027005
0.3072 --- loss: 1.011269, loss_ss: 0.826087, loss_d: 0.185182
0.3456 --- loss: 0.836564, loss_ss: 0.828745, loss_d: 0.007819
0.3840 --- loss: 0.679938, loss_ss: 0.654639, loss_d: 0.025299
0.4224 --- loss: 0.878683, loss_ss: 0.857039, loss_d: 0.021645
0.4608 --- loss: 0.680961, loss_ss: 0.610948, loss_d: 0.070013
0.4992 --- loss: 0.789814, loss_ss: 0.785389, loss_d: 0.004425
0.5376 --- loss: 1.403977, loss_ss: 1.380610, loss_d: 0.023368
0.5760 --- loss: 0.552946, loss_ss: 0.548335, loss_d: 0.004610
0.6144 --- loss: 0.728321, loss_ss: 0.697440, loss_d: 0.030881
0.6528 --- loss: 0.787641, loss_ss: 0.769456, loss_d: 0.018185
0.6912 --- loss: 0.971382, loss_ss: 0.859217, loss_d: 0.112165
0.7296 --- loss: 0.756032, loss_ss: 0.637246, loss_d: 0.118786
0.7680 --- loss: 0.863918, loss_ss: 0.639923, loss_d: 0.223996
0.8065 --- loss: 1.113066, loss_ss: 0.870762, loss_d: 0.242305
0.8449 --- loss: 1.093370, loss_ss: 1.084486, loss_d: 0.008884
0.8833 --- loss: 0.860224, loss_ss: 0.778856, loss_d: 0.081368
0.9217 --- loss: 0.721526, loss_ss: 0.702695, loss_d: 0.018831
0.9601 --- loss: 1.060494, loss_ss: 0.958521, loss_d: 0.101974
0.9985 --- loss: 1.107013, loss_ss: 0.865538, loss_d: 0.241475
Epoch finished! Loss: 0.9371526504938419
Starting epoch 9/10.
0.0000 --- loss: 0.908089, loss_ss: 0.861799, loss_d: 0.046291
0.0384 --- loss: 0.808498, loss_ss: 0.788731, loss_d: 0.019766
0.0768 --- loss: 1.084997, loss_ss: 0.861794, loss_d: 0.223202
0.1152 --- loss: 0.919726, loss_ss: 0.892083, loss_d: 0.027643
0.1536 --- loss: 1.033883, loss_ss: 0.782038, loss_d: 0.251845
0.1920 --- loss: 0.763549, loss_ss: 0.674044, loss_d: 0.089504
0.2304 --- loss: 0.750869, loss_ss: 0.748961, loss_d: 0.001908
0.2688 --- loss: 0.825740, loss_ss: 0.651208, loss_d: 0.174532
0.3072 --- loss: 1.756247, loss_ss: 0.963818, loss_d: 0.792429
0.3456 --- loss: 0.802162, loss_ss: 0.796277, loss_d: 0.005885
0.3840 --- loss: 0.943161, loss_ss: 0.933797, loss_d: 0.009364
0.4224 --- loss: 1.220519, loss_ss: 1.167462, loss_d: 0.053056
0.4608 --- loss: 0.629767, loss_ss: 0.611694, loss_d: 0.018073
0.4992 --- loss: 0.808620, loss_ss: 0.786548, loss_d: 0.022072
0.5376 --- loss: 0.968978, loss_ss: 0.774367, loss_d: 0.194611
0.5760 --- loss: 0.822250, loss_ss: 0.809961, loss_d: 0.012289
0.6144 --- loss: 0.703592, loss_ss: 0.700500, loss_d: 0.003091
0.6528 --- loss: 0.708952, loss_ss: 0.688367, loss_d: 0.020585
0.6912 --- loss: 0.962816, loss_ss: 0.881714, loss_d: 0.081102
0.7296 --- loss: 0.919979, loss_ss: 0.914596, loss_d: 0.005384
0.7680 --- loss: 0.718214, loss_ss: 0.712131, loss_d: 0.006082
0.8065 --- loss: 0.770644, loss_ss: 0.758711, loss_d: 0.011933
0.8449 --- loss: 1.469792, loss_ss: 0.964581, loss_d: 0.505211
0.8833 --- loss: 0.805743, loss_ss: 0.737868, loss_d: 0.067874
0.9217 --- loss: 0.925627, loss_ss: 0.808473, loss_d: 0.117154
0.9601 --- loss: 1.746401, loss_ss: 0.859894, loss_d: 0.886506
0.9985 --- loss: 0.930085, loss_ss: 0.830155, loss_d: 0.099930
Epoch finished! Loss: 0.9070831328630448
Starting epoch 10/10.
0.0000 --- loss: 0.791465, loss_ss: 0.755433, loss_d: 0.036032
0.0384 --- loss: 0.675422, loss_ss: 0.666408, loss_d: 0.009014
0.0768 --- loss: 0.636581, loss_ss: 0.624829, loss_d: 0.011752
0.1152 --- loss: 0.902184, loss_ss: 0.893048, loss_d: 0.009136
0.1536 --- loss: 0.999781, loss_ss: 0.795839, loss_d: 0.203942
0.1920 --- loss: 1.166516, loss_ss: 0.645330, loss_d: 0.521186
0.2304 --- loss: 0.738580, loss_ss: 0.699798, loss_d: 0.038782
0.2688 --- loss: 1.098531, loss_ss: 1.072489, loss_d: 0.026043
0.3072 --- loss: 0.866220, loss_ss: 0.864832, loss_d: 0.001388
0.3456 --- loss: 0.937907, loss_ss: 0.838600, loss_d: 0.099307
0.3840 --- loss: 0.781339, loss_ss: 0.771965, loss_d: 0.009373
0.4224 --- loss: 0.894432, loss_ss: 0.836802, loss_d: 0.057630
0.4608 --- loss: 0.651906, loss_ss: 0.643415, loss_d: 0.008491
0.4992 --- loss: 1.081244, loss_ss: 1.080483, loss_d: 0.000761
0.5376 --- loss: 1.079912, loss_ss: 1.074648, loss_d: 0.005264
0.5760 --- loss: 0.809377, loss_ss: 0.783010, loss_d: 0.026367
0.6144 --- loss: 0.480675, loss_ss: 0.454990, loss_d: 0.025685
0.6528 --- loss: 1.057389, loss_ss: 0.946289, loss_d: 0.111100
0.6912 --- loss: 1.046837, loss_ss: 0.985861, loss_d: 0.060976
0.7296 --- loss: 0.932065, loss_ss: 0.774265, loss_d: 0.157800
0.7680 --- loss: 0.799408, loss_ss: 0.789765, loss_d: 0.009643
0.8065 --- loss: 0.690890, loss_ss: 0.674518, loss_d: 0.016373
0.8449 --- loss: 0.882161, loss_ss: 0.833655, loss_d: 0.048506
0.8833 --- loss: 0.563530, loss_ss: 0.560028, loss_d: 0.003501
0.9217 --- loss: 0.896346, loss_ss: 0.876868, loss_d: 0.019478
0.9601 --- loss: 0.866131, loss_ss: 0.696622, loss_d: 0.169509
0.9985 --- loss: 0.480523, loss_ss: 0.452054, loss_d: 0.028469
Epoch finished! Loss: 0.8825686185405804
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6352941176470588
             precision    recall  f1-score   support

        0.0       0.18      0.97      0.31        38
        1.0       0.40      0.15      0.22       144
        2.0       0.85      0.75      0.79       495
        3.0       0.58      0.82      0.68       107
        4.0       0.75      0.56      0.64       236

avg / total       0.71      0.64      0.65      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.82  97.37   83.30  18.41     30.96
1  84.80  15.28   96.23  40.00     22.11
2  81.18  74.55   87.43  84.83     79.35
3  91.86  82.24   92.99  57.89     67.95
4  85.39  55.93   94.26  74.58     63.92
Total accuracy: 63.53%
Average sen: 65.07%
Average spec: 90.84%
Macro f1-score: 52.86%
Diagnosis acc on 15mins: 0.058823529411764705
[1.80983043e-04 1.52517641e-02 2.50608157e-02 4.08910535e-04
 1.90388889e-03 8.20302218e-03 8.78952676e-04 1.51536788e-03
 9.13301930e-02 6.58189412e-03 2.82572641e-04 5.44769398e-04
 4.89198021e-04 4.54463006e-04 6.14549965e-03 1.31182643e-02
 2.72142701e-04 6.91914101e-05 4.21163975e-04 5.01314038e-03
 1.48354226e-03 2.87961900e-01 3.47121388e-01 5.10238577e-03
 3.77219282e-02 8.61023727e-04 1.14166383e-02 4.86739695e-01
 7.82901525e-01 1.57426600e-03 1.48353688e-02 6.14195839e-02
 1.55308440e-01 5.44933140e-01]
pred: 0.08580903010763852, label: 1
Wrong!!! Real Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.366576, loss_ss: 1.647538, loss_d: 0.719038
0.0384 --- loss: 1.899513, loss_ss: 1.587270, loss_d: 0.312243
0.0769 --- loss: 2.170768, loss_ss: 1.543360, loss_d: 0.627409
0.1153 --- loss: 2.043931, loss_ss: 1.474668, loss_d: 0.569263
0.1537 --- loss: 2.875374, loss_ss: 1.478954, loss_d: 1.396420
0.1922 --- loss: 1.994278, loss_ss: 1.576074, loss_d: 0.418204
0.2306 --- loss: 2.211884, loss_ss: 1.483375, loss_d: 0.728509
0.2690 --- loss: 1.931708, loss_ss: 1.409039, loss_d: 0.522669
0.3075 --- loss: 1.971022, loss_ss: 1.396854, loss_d: 0.574168
0.3459 --- loss: 1.835446, loss_ss: 1.320879, loss_d: 0.514566
0.3843 --- loss: 1.826405, loss_ss: 1.409831, loss_d: 0.416574
0.4228 --- loss: 1.943450, loss_ss: 1.336065, loss_d: 0.607385
0.4612 --- loss: 1.709416, loss_ss: 1.329993, loss_d: 0.379423
0.4996 --- loss: 2.091839, loss_ss: 1.462721, loss_d: 0.629118
0.5380 --- loss: 1.642359, loss_ss: 1.330781, loss_d: 0.311578
0.5765 --- loss: 1.945609, loss_ss: 1.373000, loss_d: 0.572610
0.6149 --- loss: 1.707819, loss_ss: 1.301107, loss_d: 0.406712
0.6533 --- loss: 1.838914, loss_ss: 1.343517, loss_d: 0.495397
0.6918 --- loss: 1.856951, loss_ss: 1.523844, loss_d: 0.333107
0.7302 --- loss: 1.527843, loss_ss: 1.152002, loss_d: 0.375842
0.7686 --- loss: 1.851631, loss_ss: 1.370674, loss_d: 0.480957
0.8071 --- loss: 1.887809, loss_ss: 1.241206, loss_d: 0.646603
0.8455 --- loss: 1.799938, loss_ss: 1.187052, loss_d: 0.612886
0.8839 --- loss: 1.606695, loss_ss: 1.224877, loss_d: 0.381818
0.9224 --- loss: 1.474528, loss_ss: 1.189399, loss_d: 0.285129
0.9608 --- loss: 1.713174, loss_ss: 1.289774, loss_d: 0.423399
0.9992 --- loss: 1.343479, loss_ss: 0.925339, loss_d: 0.418140
Epoch finished! Loss: 1.9107112063811376
Starting epoch 2/10.
0.0000 --- loss: 1.649144, loss_ss: 1.149099, loss_d: 0.500044
0.0384 --- loss: 1.558603, loss_ss: 1.122348, loss_d: 0.436255
0.0769 --- loss: 1.402886, loss_ss: 1.235380, loss_d: 0.167506
0.1153 --- loss: 1.452825, loss_ss: 1.050900, loss_d: 0.401926
0.1537 --- loss: 1.302459, loss_ss: 1.063205, loss_d: 0.239253
0.1922 --- loss: 1.524888, loss_ss: 1.224308, loss_d: 0.300580
0.2306 --- loss: 1.836864, loss_ss: 0.934262, loss_d: 0.902602
0.2690 --- loss: 1.339050, loss_ss: 1.029404, loss_d: 0.309646
0.3075 --- loss: 1.502575, loss_ss: 1.029525, loss_d: 0.473050
0.3459 --- loss: 1.352897, loss_ss: 1.070138, loss_d: 0.282759
0.3843 --- loss: 1.203820, loss_ss: 1.051391, loss_d: 0.152429
0.4228 --- loss: 1.208580, loss_ss: 1.049917, loss_d: 0.158664
0.4612 --- loss: 1.098322, loss_ss: 0.994838, loss_d: 0.103484
0.4996 --- loss: 1.070521, loss_ss: 1.022451, loss_d: 0.048070
0.5380 --- loss: 1.382905, loss_ss: 1.001405, loss_d: 0.381500
0.5765 --- loss: 1.342782, loss_ss: 0.994717, loss_d: 0.348065
0.6149 --- loss: 1.257923, loss_ss: 1.179607, loss_d: 0.078317
0.6533 --- loss: 1.293527, loss_ss: 1.004862, loss_d: 0.288664
0.6918 --- loss: 1.488911, loss_ss: 0.985703, loss_d: 0.503208
0.7302 --- loss: 1.426751, loss_ss: 1.107516, loss_d: 0.319235
0.7686 --- loss: 1.356318, loss_ss: 0.928577, loss_d: 0.427741
0.8071 --- loss: 1.241189, loss_ss: 0.984009, loss_d: 0.257180
0.8455 --- loss: 1.127602, loss_ss: 1.057665, loss_d: 0.069937
0.8839 --- loss: 1.250209, loss_ss: 0.941581, loss_d: 0.308629
0.9224 --- loss: 1.152978, loss_ss: 1.075531, loss_d: 0.077447
0.9608 --- loss: 1.262684, loss_ss: 1.114932, loss_d: 0.147753
0.9992 --- loss: 2.208959, loss_ss: 1.968880, loss_d: 0.240079
Epoch finished! Loss: 1.41821980040807
Starting epoch 3/10.
0.0000 --- loss: 1.425849, loss_ss: 1.177650, loss_d: 0.248199
0.0384 --- loss: 1.287573, loss_ss: 1.213549, loss_d: 0.074024
0.0769 --- loss: 1.001311, loss_ss: 0.878920, loss_d: 0.122391
0.1153 --- loss: 1.345197, loss_ss: 1.156232, loss_d: 0.188965
0.1537 --- loss: 1.070244, loss_ss: 0.975442, loss_d: 0.094803
0.1922 --- loss: 1.092498, loss_ss: 0.901935, loss_d: 0.190564
0.2306 --- loss: 1.427099, loss_ss: 1.332359, loss_d: 0.094740
0.2690 --- loss: 1.237122, loss_ss: 1.018003, loss_d: 0.219118
0.3075 --- loss: 1.363063, loss_ss: 1.064961, loss_d: 0.298102
0.3459 --- loss: 1.033760, loss_ss: 0.904503, loss_d: 0.129257
0.3843 --- loss: 1.328803, loss_ss: 1.184226, loss_d: 0.144577
0.4228 --- loss: 0.989759, loss_ss: 0.851780, loss_d: 0.137979
0.4612 --- loss: 1.331271, loss_ss: 0.978994, loss_d: 0.352278
0.4996 --- loss: 1.016143, loss_ss: 0.810885, loss_d: 0.205258
0.5380 --- loss: 1.413044, loss_ss: 0.880221, loss_d: 0.532823
0.5765 --- loss: 1.023237, loss_ss: 0.738737, loss_d: 0.284500
0.6149 --- loss: 1.317634, loss_ss: 0.920027, loss_d: 0.397606
0.6533 --- loss: 0.999380, loss_ss: 0.922302, loss_d: 0.077078
0.6918 --- loss: 1.165668, loss_ss: 1.021570, loss_d: 0.144098
0.7302 --- loss: 1.076168, loss_ss: 0.974892, loss_d: 0.101276
0.7686 --- loss: 1.106681, loss_ss: 0.921266, loss_d: 0.185415
0.8071 --- loss: 1.071700, loss_ss: 0.943276, loss_d: 0.128424
0.8455 --- loss: 1.006474, loss_ss: 0.873494, loss_d: 0.132980
0.8839 --- loss: 1.023114, loss_ss: 0.847318, loss_d: 0.175796
0.9224 --- loss: 0.895078, loss_ss: 0.773240, loss_d: 0.121838
0.9608 --- loss: 0.832993, loss_ss: 0.769478, loss_d: 0.063515
0.9992 --- loss: 1.074769, loss_ss: 1.015550, loss_d: 0.059218
Epoch finished! Loss: 1.2138421439207516
Starting epoch 4/10.
0.0000 --- loss: 0.946912, loss_ss: 0.889523, loss_d: 0.057390
0.0384 --- loss: 0.918219, loss_ss: 0.712463, loss_d: 0.205756
0.0769 --- loss: 0.960683, loss_ss: 0.771741, loss_d: 0.188942
0.1153 --- loss: 0.970339, loss_ss: 0.817566, loss_d: 0.152773
0.1537 --- loss: 1.410411, loss_ss: 0.967592, loss_d: 0.442818
0.1922 --- loss: 1.438031, loss_ss: 0.748455, loss_d: 0.689576
0.2306 --- loss: 1.733424, loss_ss: 1.428288, loss_d: 0.305136
0.2690 --- loss: 1.397038, loss_ss: 1.017093, loss_d: 0.379945
0.3075 --- loss: 1.478921, loss_ss: 1.038574, loss_d: 0.440347
0.3459 --- loss: 1.334363, loss_ss: 1.075199, loss_d: 0.259164
0.3843 --- loss: 1.309087, loss_ss: 0.888116, loss_d: 0.420971
0.4228 --- loss: 0.905188, loss_ss: 0.775985, loss_d: 0.129203
0.4612 --- loss: 1.126615, loss_ss: 0.896218, loss_d: 0.230397
0.4996 --- loss: 2.125093, loss_ss: 0.970935, loss_d: 1.154158
0.5380 --- loss: 1.163897, loss_ss: 0.755103, loss_d: 0.408793
0.5765 --- loss: 1.026736, loss_ss: 0.868945, loss_d: 0.157792
0.6149 --- loss: 1.300983, loss_ss: 0.779846, loss_d: 0.521137
0.6533 --- loss: 1.186868, loss_ss: 1.005620, loss_d: 0.181248
0.6918 --- loss: 1.291333, loss_ss: 1.098468, loss_d: 0.192865
0.7302 --- loss: 1.119948, loss_ss: 1.071276, loss_d: 0.048672
0.7686 --- loss: 0.716850, loss_ss: 0.668813, loss_d: 0.048037
0.8071 --- loss: 1.238414, loss_ss: 1.191993, loss_d: 0.046422
0.8455 --- loss: 1.073481, loss_ss: 0.735147, loss_d: 0.338334
0.8839 --- loss: 0.813811, loss_ss: 0.735686, loss_d: 0.078125
0.9224 --- loss: 1.187408, loss_ss: 0.834359, loss_d: 0.353050
0.9608 --- loss: 1.219298, loss_ss: 1.149215, loss_d: 0.070083
0.9992 --- loss: 1.242656, loss_ss: 1.179053, loss_d: 0.063603
Epoch finished! Loss: 1.1047624856233598
Starting epoch 5/10.
0.0000 --- loss: 0.993796, loss_ss: 0.888526, loss_d: 0.105271
0.0384 --- loss: 0.929505, loss_ss: 0.875554, loss_d: 0.053950
0.0769 --- loss: 0.909883, loss_ss: 0.884292, loss_d: 0.025591
0.1153 --- loss: 0.845234, loss_ss: 0.812098, loss_d: 0.033136
0.1537 --- loss: 0.977992, loss_ss: 0.933853, loss_d: 0.044139
0.1922 --- loss: 0.904664, loss_ss: 0.848915, loss_d: 0.055749
0.2306 --- loss: 0.830212, loss_ss: 0.729202, loss_d: 0.101010
0.2690 --- loss: 1.138571, loss_ss: 0.905513, loss_d: 0.233059
0.3075 --- loss: 0.996499, loss_ss: 0.792109, loss_d: 0.204390
0.3459 --- loss: 1.051201, loss_ss: 0.981762, loss_d: 0.069439
0.3843 --- loss: 0.870882, loss_ss: 0.811094, loss_d: 0.059788
0.4228 --- loss: 0.873327, loss_ss: 0.684242, loss_d: 0.189085
0.4612 --- loss: 0.924957, loss_ss: 0.880633, loss_d: 0.044323
0.4996 --- loss: 0.938883, loss_ss: 0.680163, loss_d: 0.258720
0.5380 --- loss: 1.086163, loss_ss: 0.954374, loss_d: 0.131788
0.5765 --- loss: 1.273484, loss_ss: 0.843165, loss_d: 0.430319
0.6149 --- loss: 1.013151, loss_ss: 0.791688, loss_d: 0.221463
0.6533 --- loss: 0.663180, loss_ss: 0.593003, loss_d: 0.070177
0.6918 --- loss: 1.018944, loss_ss: 0.817178, loss_d: 0.201767
0.7302 --- loss: 0.793594, loss_ss: 0.630340, loss_d: 0.163254
0.7686 --- loss: 0.835990, loss_ss: 0.723320, loss_d: 0.112670
0.8071 --- loss: 1.350420, loss_ss: 0.690923, loss_d: 0.659497
0.8455 --- loss: 0.729781, loss_ss: 0.616051, loss_d: 0.113730
0.8839 --- loss: 1.001996, loss_ss: 0.794929, loss_d: 0.207067
0.9224 --- loss: 0.895032, loss_ss: 0.868114, loss_d: 0.026918
0.9608 --- loss: 0.890939, loss_ss: 0.566641, loss_d: 0.324298
0.9992 --- loss: 1.496571, loss_ss: 1.438671, loss_d: 0.057900
Epoch finished! Loss: 0.9882570537237021
Starting epoch 6/10.
0.0000 --- loss: 0.757905, loss_ss: 0.644831, loss_d: 0.113074
0.0384 --- loss: 0.868480, loss_ss: 0.805446, loss_d: 0.063034
0.0769 --- loss: 0.767746, loss_ss: 0.698218, loss_d: 0.069528
0.1153 --- loss: 0.722959, loss_ss: 0.624941, loss_d: 0.098018
0.1537 --- loss: 0.865999, loss_ss: 0.692855, loss_d: 0.173144
0.1922 --- loss: 0.879800, loss_ss: 0.716222, loss_d: 0.163577
0.2306 --- loss: 0.766810, loss_ss: 0.717694, loss_d: 0.049115
0.2690 --- loss: 1.106103, loss_ss: 0.808443, loss_d: 0.297660
0.3075 --- loss: 0.565625, loss_ss: 0.411036, loss_d: 0.154589
0.3459 --- loss: 0.831105, loss_ss: 0.789183, loss_d: 0.041922
0.3843 --- loss: 0.856660, loss_ss: 0.787291, loss_d: 0.069368
0.4228 --- loss: 0.895402, loss_ss: 0.623013, loss_d: 0.272390
0.4612 --- loss: 0.847886, loss_ss: 0.649323, loss_d: 0.198564
0.4996 --- loss: 0.722387, loss_ss: 0.564785, loss_d: 0.157601
0.5380 --- loss: 0.742010, loss_ss: 0.711018, loss_d: 0.030992
0.5765 --- loss: 0.745367, loss_ss: 0.709317, loss_d: 0.036050
0.6149 --- loss: 1.196786, loss_ss: 0.890739, loss_d: 0.306048
0.6533 --- loss: 1.063016, loss_ss: 0.861345, loss_d: 0.201671
0.6918 --- loss: 1.089574, loss_ss: 1.057148, loss_d: 0.032427
0.7302 --- loss: 0.903491, loss_ss: 0.753960, loss_d: 0.149531
0.7686 --- loss: 0.912979, loss_ss: 0.810840, loss_d: 0.102139
0.8071 --- loss: 0.553061, loss_ss: 0.491322, loss_d: 0.061738
0.8455 --- loss: 0.916300, loss_ss: 0.748644, loss_d: 0.167656
0.8839 --- loss: 1.154052, loss_ss: 0.996523, loss_d: 0.157529
0.9224 --- loss: 1.514428, loss_ss: 1.509441, loss_d: 0.004987
0.9608 --- loss: 1.687377, loss_ss: 1.191495, loss_d: 0.495882
0.9992 --- loss: 1.265505, loss_ss: 1.263480, loss_d: 0.002025
Epoch finished! Loss: 0.9375144442686668
Starting epoch 7/10.
0.0000 --- loss: 0.932898, loss_ss: 0.909485, loss_d: 0.023413
0.0384 --- loss: 0.696622, loss_ss: 0.625279, loss_d: 0.071343
0.0769 --- loss: 0.887056, loss_ss: 0.819647, loss_d: 0.067409
0.1153 --- loss: 0.948915, loss_ss: 0.863323, loss_d: 0.085592
0.1537 --- loss: 0.815799, loss_ss: 0.773392, loss_d: 0.042406
0.1922 --- loss: 1.265289, loss_ss: 0.901703, loss_d: 0.363587
0.2306 --- loss: 0.853719, loss_ss: 0.678943, loss_d: 0.174776
0.2690 --- loss: 0.901502, loss_ss: 0.843941, loss_d: 0.057561
0.3075 --- loss: 0.788696, loss_ss: 0.772084, loss_d: 0.016611
0.3459 --- loss: 0.714425, loss_ss: 0.704354, loss_d: 0.010071
0.3843 --- loss: 1.066632, loss_ss: 1.049986, loss_d: 0.016647
0.4228 --- loss: 0.672941, loss_ss: 0.645432, loss_d: 0.027509
0.4612 --- loss: 0.721178, loss_ss: 0.699607, loss_d: 0.021572
0.4996 --- loss: 0.782741, loss_ss: 0.690312, loss_d: 0.092429
0.5380 --- loss: 0.730476, loss_ss: 0.699285, loss_d: 0.031191
0.5765 --- loss: 1.352314, loss_ss: 0.983977, loss_d: 0.368337
0.6149 --- loss: 0.667461, loss_ss: 0.537112, loss_d: 0.130349
0.6533 --- loss: 0.948428, loss_ss: 0.879068, loss_d: 0.069361
0.6918 --- loss: 0.755226, loss_ss: 0.723047, loss_d: 0.032178
0.7302 --- loss: 0.831620, loss_ss: 0.775044, loss_d: 0.056576
0.7686 --- loss: 0.838038, loss_ss: 0.819663, loss_d: 0.018375
0.8071 --- loss: 0.998892, loss_ss: 0.631340, loss_d: 0.367552
0.8455 --- loss: 0.741726, loss_ss: 0.702381, loss_d: 0.039346
0.8839 --- loss: 0.797657, loss_ss: 0.546197, loss_d: 0.251460
0.9224 --- loss: 0.933037, loss_ss: 0.877270, loss_d: 0.055767
0.9608 --- loss: 0.998670, loss_ss: 0.916250, loss_d: 0.082420
0.9992 --- loss: 1.189143, loss_ss: 1.163847, loss_d: 0.025296
Epoch finished! Loss: 0.9103731196660262
Starting epoch 8/10.
0.0000 --- loss: 0.931636, loss_ss: 0.860735, loss_d: 0.070900
0.0384 --- loss: 0.691430, loss_ss: 0.594151, loss_d: 0.097279
0.0769 --- loss: 0.911782, loss_ss: 0.902621, loss_d: 0.009161
0.1153 --- loss: 0.567885, loss_ss: 0.494819, loss_d: 0.073066
0.1537 --- loss: 1.157052, loss_ss: 0.756331, loss_d: 0.400721
0.1922 --- loss: 1.092210, loss_ss: 0.618965, loss_d: 0.473246
0.2306 --- loss: 0.775399, loss_ss: 0.721940, loss_d: 0.053459
0.2690 --- loss: 0.772720, loss_ss: 0.751368, loss_d: 0.021352
0.3075 --- loss: 1.064168, loss_ss: 0.775823, loss_d: 0.288346
0.3459 --- loss: 0.747997, loss_ss: 0.717517, loss_d: 0.030480
0.3843 --- loss: 1.152151, loss_ss: 0.799026, loss_d: 0.353125
0.4228 --- loss: 1.111716, loss_ss: 1.043471, loss_d: 0.068245
0.4612 --- loss: 0.697769, loss_ss: 0.649309, loss_d: 0.048460
0.4996 --- loss: 0.692275, loss_ss: 0.646954, loss_d: 0.045321
0.5380 --- loss: 1.001611, loss_ss: 0.727590, loss_d: 0.274020
0.5765 --- loss: 0.724818, loss_ss: 0.576020, loss_d: 0.148798
0.6149 --- loss: 0.875891, loss_ss: 0.858677, loss_d: 0.017214
0.6533 --- loss: 0.833814, loss_ss: 0.640773, loss_d: 0.193042
0.6918 --- loss: 0.905357, loss_ss: 0.799598, loss_d: 0.105759
0.7302 --- loss: 0.905904, loss_ss: 0.815273, loss_d: 0.090631
0.7686 --- loss: 0.694676, loss_ss: 0.543299, loss_d: 0.151377
0.8071 --- loss: 0.630189, loss_ss: 0.604370, loss_d: 0.025819
0.8455 --- loss: 0.668616, loss_ss: 0.655647, loss_d: 0.012968
0.8839 --- loss: 0.775549, loss_ss: 0.731454, loss_d: 0.044094
0.9224 --- loss: 1.080989, loss_ss: 0.929466, loss_d: 0.151524
0.9608 --- loss: 0.834830, loss_ss: 0.681108, loss_d: 0.153722
0.9992 --- loss: 1.283176, loss_ss: 1.252820, loss_d: 0.030355
Epoch finished! Loss: 0.8959677718006648
Starting epoch 9/10.
0.0000 --- loss: 0.818555, loss_ss: 0.677884, loss_d: 0.140671
0.0384 --- loss: 0.663579, loss_ss: 0.605602, loss_d: 0.057976
0.0769 --- loss: 0.784738, loss_ss: 0.763147, loss_d: 0.021591
0.1153 --- loss: 0.787970, loss_ss: 0.750915, loss_d: 0.037055
0.1537 --- loss: 0.590627, loss_ss: 0.559517, loss_d: 0.031110
0.1922 --- loss: 0.710679, loss_ss: 0.655989, loss_d: 0.054689
0.2306 --- loss: 0.768391, loss_ss: 0.757533, loss_d: 0.010858
0.2690 --- loss: 0.969728, loss_ss: 0.725924, loss_d: 0.243804
0.3075 --- loss: 0.812170, loss_ss: 0.803799, loss_d: 0.008371
0.3459 --- loss: 0.829595, loss_ss: 0.813009, loss_d: 0.016587
0.3843 --- loss: 0.968972, loss_ss: 0.813047, loss_d: 0.155925
0.4228 --- loss: 0.823645, loss_ss: 0.589644, loss_d: 0.234001
0.4612 --- loss: 0.483687, loss_ss: 0.459238, loss_d: 0.024450
0.4996 --- loss: 1.318171, loss_ss: 0.975236, loss_d: 0.342935
0.5380 --- loss: 0.671564, loss_ss: 0.655467, loss_d: 0.016096
0.5765 --- loss: 0.807869, loss_ss: 0.578836, loss_d: 0.229033
0.6149 --- loss: 0.733947, loss_ss: 0.661809, loss_d: 0.072138
0.6533 --- loss: 0.670810, loss_ss: 0.663543, loss_d: 0.007267
0.6918 --- loss: 0.769254, loss_ss: 0.743059, loss_d: 0.026195
0.7302 --- loss: 1.161052, loss_ss: 1.140870, loss_d: 0.020181
0.7686 --- loss: 0.713219, loss_ss: 0.666211, loss_d: 0.047007
0.8071 --- loss: 0.602265, loss_ss: 0.555926, loss_d: 0.046339
0.8455 --- loss: 0.561491, loss_ss: 0.538945, loss_d: 0.022546
0.8839 --- loss: 0.709787, loss_ss: 0.646685, loss_d: 0.063102
0.9224 --- loss: 0.870777, loss_ss: 0.862220, loss_d: 0.008557
0.9608 --- loss: 0.706278, loss_ss: 0.657721, loss_d: 0.048557
0.9992 --- loss: 1.229575, loss_ss: 1.225425, loss_d: 0.004150
Epoch finished! Loss: 0.850323973596096
Starting epoch 10/10.
0.0000 --- loss: 0.846466, loss_ss: 0.790527, loss_d: 0.055939
0.0384 --- loss: 0.918078, loss_ss: 0.768167, loss_d: 0.149911
0.0769 --- loss: 0.672758, loss_ss: 0.597901, loss_d: 0.074858
0.1153 --- loss: 0.677030, loss_ss: 0.593818, loss_d: 0.083212
0.1537 --- loss: 1.203908, loss_ss: 0.867351, loss_d: 0.336558
0.1922 --- loss: 0.653318, loss_ss: 0.647762, loss_d: 0.005555
0.2306 --- loss: 0.481400, loss_ss: 0.469103, loss_d: 0.012297
0.2690 --- loss: 0.650278, loss_ss: 0.626270, loss_d: 0.024008
0.3075 --- loss: 0.821721, loss_ss: 0.772646, loss_d: 0.049075
0.3459 --- loss: 0.815025, loss_ss: 0.807755, loss_d: 0.007270
0.3843 --- loss: 0.692751, loss_ss: 0.681605, loss_d: 0.011146
0.4228 --- loss: 0.895910, loss_ss: 0.840100, loss_d: 0.055811
0.4612 --- loss: 0.506104, loss_ss: 0.464769, loss_d: 0.041334
0.4996 --- loss: 0.700051, loss_ss: 0.467295, loss_d: 0.232756
0.5380 --- loss: 0.698238, loss_ss: 0.542367, loss_d: 0.155871
0.5765 --- loss: 0.733777, loss_ss: 0.724518, loss_d: 0.009258
0.6149 --- loss: 0.694591, loss_ss: 0.688461, loss_d: 0.006130
0.6533 --- loss: 1.232489, loss_ss: 0.728954, loss_d: 0.503535
0.6918 --- loss: 0.852732, loss_ss: 0.849682, loss_d: 0.003049
0.7302 --- loss: 0.714818, loss_ss: 0.513896, loss_d: 0.200922
0.7686 --- loss: 0.757399, loss_ss: 0.738199, loss_d: 0.019201
0.8071 --- loss: 0.716611, loss_ss: 0.669161, loss_d: 0.047450
0.8455 --- loss: 0.442819, loss_ss: 0.427738, loss_d: 0.015080
0.8839 --- loss: 0.473751, loss_ss: 0.462947, loss_d: 0.010805
0.9224 --- loss: 0.785693, loss_ss: 0.762723, loss_d: 0.022970
0.9608 --- loss: 1.074999, loss_ss: 1.052211, loss_d: 0.022788
0.9992 --- loss: 0.737686, loss_ss: 0.727315, loss_d: 0.010372
Epoch finished! Loss: 0.8108088503663357
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5824074074074074
             precision    recall  f1-score   support

        0.0       0.27      0.71      0.39       108
        1.0       0.58      0.63      0.61       387
        2.0       0.77      0.45      0.57       360
        3.0       0.99      0.82      0.90        95
        4.0       0.79      0.51      0.62       130

avg / total       0.67      0.58      0.60      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  77.87  71.30   78.60  27.02     39.19
1  70.56  63.31   74.60  58.19     60.64
2  77.31  45.28   93.33  77.25     57.09
3  98.33  82.11   99.90  98.73     89.66
4  92.41  50.77   98.11  78.57     61.68
Total accuracy: 58.24%
Average sen: 62.55%
Average spec: 88.91%
Macro f1-score: 61.65%
Diagnosis acc on 15mins: 1.0
[1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         0.99999976 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         0.99999988 1.         1.         1.        ]
pred: 0.9999999900658926, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.560095, loss_ss: 1.862347, loss_d: 0.697747
0.0384 --- loss: 2.478696, loss_ss: 1.830955, loss_d: 0.647741
0.0769 --- loss: 2.501958, loss_ss: 1.928274, loss_d: 0.573684
0.1153 --- loss: 2.232775, loss_ss: 1.713315, loss_d: 0.519460
0.1537 --- loss: 2.466249, loss_ss: 1.570928, loss_d: 0.895322
0.1922 --- loss: 2.298671, loss_ss: 1.705412, loss_d: 0.593260
0.2306 --- loss: 2.201197, loss_ss: 1.684795, loss_d: 0.516402
0.2690 --- loss: 2.473194, loss_ss: 1.641973, loss_d: 0.831221
0.3075 --- loss: 2.347389, loss_ss: 1.565607, loss_d: 0.781782
0.3459 --- loss: 2.124306, loss_ss: 1.464493, loss_d: 0.659812
0.3843 --- loss: 1.958357, loss_ss: 1.319338, loss_d: 0.639018
0.4228 --- loss: 2.091347, loss_ss: 1.443937, loss_d: 0.647410
0.4612 --- loss: 1.746758, loss_ss: 1.463531, loss_d: 0.283226
0.4996 --- loss: 1.948605, loss_ss: 1.445399, loss_d: 0.503206
0.5380 --- loss: 2.028690, loss_ss: 1.600747, loss_d: 0.427943
0.5765 --- loss: 2.399488, loss_ss: 1.554399, loss_d: 0.845089
0.6149 --- loss: 1.762716, loss_ss: 1.279976, loss_d: 0.482740
0.6533 --- loss: 1.836180, loss_ss: 1.306087, loss_d: 0.530093
0.6918 --- loss: 1.611863, loss_ss: 1.333025, loss_d: 0.278838
0.7302 --- loss: 1.998767, loss_ss: 1.467916, loss_d: 0.530851
0.7686 --- loss: 1.667601, loss_ss: 1.383885, loss_d: 0.283716
0.8071 --- loss: 1.913318, loss_ss: 1.437541, loss_d: 0.475777
0.8455 --- loss: 1.775216, loss_ss: 1.426312, loss_d: 0.348904
0.8839 --- loss: 1.565106, loss_ss: 1.355821, loss_d: 0.209286
0.9224 --- loss: 1.946952, loss_ss: 1.502316, loss_d: 0.444636
0.9608 --- loss: 1.683695, loss_ss: 1.336629, loss_d: 0.347066
0.9992 --- loss: 1.878769, loss_ss: 1.555429, loss_d: 0.323340
Epoch finished! Loss: 2.0457468303350304
Starting epoch 2/10.
0.0000 --- loss: 1.775052, loss_ss: 1.112772, loss_d: 0.662280
0.0384 --- loss: 1.625261, loss_ss: 1.192247, loss_d: 0.433014
0.0769 --- loss: 1.608704, loss_ss: 1.307046, loss_d: 0.301659
0.1153 --- loss: 1.312755, loss_ss: 1.160840, loss_d: 0.151915
0.1537 --- loss: 1.471679, loss_ss: 1.268481, loss_d: 0.203198
0.1922 --- loss: 1.484939, loss_ss: 1.154853, loss_d: 0.330086
0.2306 --- loss: 1.506567, loss_ss: 1.358184, loss_d: 0.148384
0.2690 --- loss: 1.328795, loss_ss: 1.176850, loss_d: 0.151945
0.3075 --- loss: 1.565144, loss_ss: 1.103036, loss_d: 0.462108
0.3459 --- loss: 1.461113, loss_ss: 1.129573, loss_d: 0.331541
0.3843 --- loss: 1.354127, loss_ss: 1.107350, loss_d: 0.246776
0.4228 --- loss: 1.588189, loss_ss: 1.180722, loss_d: 0.407467
0.4612 --- loss: 1.196851, loss_ss: 1.141215, loss_d: 0.055635
0.4996 --- loss: 1.267242, loss_ss: 0.946519, loss_d: 0.320723
0.5380 --- loss: 1.111232, loss_ss: 0.966102, loss_d: 0.145130
0.5765 --- loss: 1.473597, loss_ss: 1.179740, loss_d: 0.293858
0.6149 --- loss: 1.338066, loss_ss: 0.893992, loss_d: 0.444074
0.6533 --- loss: 1.765847, loss_ss: 1.306309, loss_d: 0.459539
0.6918 --- loss: 1.050354, loss_ss: 0.906402, loss_d: 0.143952
0.7302 --- loss: 1.200541, loss_ss: 0.945103, loss_d: 0.255438
0.7686 --- loss: 1.427610, loss_ss: 1.081662, loss_d: 0.345948
0.8071 --- loss: 1.488851, loss_ss: 1.173292, loss_d: 0.315558
0.8455 --- loss: 0.944171, loss_ss: 0.843108, loss_d: 0.101064
0.8839 --- loss: 0.887702, loss_ss: 0.788500, loss_d: 0.099202
0.9224 --- loss: 1.078564, loss_ss: 0.925847, loss_d: 0.152716
0.9608 --- loss: 1.188339, loss_ss: 0.944954, loss_d: 0.243384
0.9992 --- loss: 1.362647, loss_ss: 1.322788, loss_d: 0.039859
Epoch finished! Loss: 1.4502485905702298
Starting epoch 3/10.
0.0000 --- loss: 1.092338, loss_ss: 0.874667, loss_d: 0.217671
0.0384 --- loss: 1.014794, loss_ss: 0.915275, loss_d: 0.099519
0.0769 --- loss: 1.688211, loss_ss: 0.927228, loss_d: 0.760983
0.1153 --- loss: 1.337159, loss_ss: 1.001536, loss_d: 0.335624
0.1537 --- loss: 1.240375, loss_ss: 1.142035, loss_d: 0.098340
0.1922 --- loss: 1.039338, loss_ss: 0.875129, loss_d: 0.164209
0.2306 --- loss: 1.461285, loss_ss: 0.790919, loss_d: 0.670366
0.2690 --- loss: 1.273419, loss_ss: 1.228511, loss_d: 0.044908
0.3075 --- loss: 1.442196, loss_ss: 0.968250, loss_d: 0.473946
0.3459 --- loss: 1.587374, loss_ss: 0.742206, loss_d: 0.845168
0.3843 --- loss: 1.131269, loss_ss: 0.930827, loss_d: 0.200442
0.4228 --- loss: 0.978336, loss_ss: 0.872981, loss_d: 0.105355
0.4612 --- loss: 0.930088, loss_ss: 0.708134, loss_d: 0.221954
0.4996 --- loss: 0.948729, loss_ss: 0.829617, loss_d: 0.119112
0.5380 --- loss: 0.883624, loss_ss: 0.747979, loss_d: 0.135645
0.5765 --- loss: 1.106977, loss_ss: 0.973304, loss_d: 0.133674
0.6149 --- loss: 1.202491, loss_ss: 0.812814, loss_d: 0.389677
0.6533 --- loss: 0.974347, loss_ss: 0.838235, loss_d: 0.136112
0.6918 --- loss: 1.111180, loss_ss: 0.992332, loss_d: 0.118848
0.7302 --- loss: 1.171791, loss_ss: 0.833867, loss_d: 0.337924
0.7686 --- loss: 1.039016, loss_ss: 0.937177, loss_d: 0.101840
0.8071 --- loss: 0.785078, loss_ss: 0.717397, loss_d: 0.067681
0.8455 --- loss: 0.996748, loss_ss: 0.907580, loss_d: 0.089168
0.8839 --- loss: 1.421510, loss_ss: 0.972041, loss_d: 0.449469
0.9224 --- loss: 0.950795, loss_ss: 0.902394, loss_d: 0.048401
0.9608 --- loss: 0.926256, loss_ss: 0.873245, loss_d: 0.053011
0.9992 --- loss: 0.961189, loss_ss: 0.926740, loss_d: 0.034449
Epoch finished! Loss: 1.1716877128069216
Starting epoch 4/10.
0.0000 --- loss: 0.961591, loss_ss: 0.727621, loss_d: 0.233970
0.0384 --- loss: 1.363367, loss_ss: 1.024499, loss_d: 0.338868
0.0769 --- loss: 1.172914, loss_ss: 0.874224, loss_d: 0.298689
0.1153 --- loss: 0.878663, loss_ss: 0.724317, loss_d: 0.154345
0.1537 --- loss: 0.778925, loss_ss: 0.614191, loss_d: 0.164734
0.1922 --- loss: 1.292913, loss_ss: 1.123934, loss_d: 0.168979
0.2306 --- loss: 1.120415, loss_ss: 1.065920, loss_d: 0.054495
0.2690 --- loss: 1.608912, loss_ss: 1.071563, loss_d: 0.537350
0.3075 --- loss: 0.736776, loss_ss: 0.674245, loss_d: 0.062531
0.3459 --- loss: 0.967996, loss_ss: 0.756036, loss_d: 0.211960
0.3843 --- loss: 1.012921, loss_ss: 0.915704, loss_d: 0.097217
0.4228 --- loss: 0.856840, loss_ss: 0.762910, loss_d: 0.093931
0.4612 --- loss: 1.551272, loss_ss: 1.130550, loss_d: 0.420722
0.4996 --- loss: 1.442026, loss_ss: 1.053527, loss_d: 0.388499
0.5380 --- loss: 1.152465, loss_ss: 0.999353, loss_d: 0.153111
0.5765 --- loss: 0.846508, loss_ss: 0.732942, loss_d: 0.113566
0.6149 --- loss: 0.969294, loss_ss: 0.842033, loss_d: 0.127261
0.6533 --- loss: 1.003954, loss_ss: 0.962752, loss_d: 0.041201
0.6918 --- loss: 1.073410, loss_ss: 1.018612, loss_d: 0.054798
0.7302 --- loss: 0.613998, loss_ss: 0.561372, loss_d: 0.052626
0.7686 --- loss: 0.641536, loss_ss: 0.600450, loss_d: 0.041085
0.8071 --- loss: 0.853256, loss_ss: 0.715361, loss_d: 0.137895
0.8455 --- loss: 1.066405, loss_ss: 0.973724, loss_d: 0.092682
0.8839 --- loss: 1.451612, loss_ss: 0.793193, loss_d: 0.658419
0.9224 --- loss: 1.144086, loss_ss: 0.873312, loss_d: 0.270774
0.9608 --- loss: 0.766207, loss_ss: 0.709872, loss_d: 0.056335
0.9992 --- loss: 2.049893, loss_ss: 0.956054, loss_d: 1.093839
Epoch finished! Loss: 1.0902188211679458
Starting epoch 5/10.
0.0000 --- loss: 0.979613, loss_ss: 0.861949, loss_d: 0.117664
0.0384 --- loss: 1.876506, loss_ss: 1.284389, loss_d: 0.592117
0.0769 --- loss: 1.099940, loss_ss: 0.883550, loss_d: 0.216389
0.1153 --- loss: 1.296009, loss_ss: 0.714302, loss_d: 0.581707
0.1537 --- loss: 0.855838, loss_ss: 0.786913, loss_d: 0.068924
0.1922 --- loss: 0.958548, loss_ss: 0.896760, loss_d: 0.061789
0.2306 --- loss: 0.960351, loss_ss: 0.794926, loss_d: 0.165425
0.2690 --- loss: 1.096492, loss_ss: 0.898782, loss_d: 0.197711
0.3075 --- loss: 0.852663, loss_ss: 0.815928, loss_d: 0.036735
0.3459 --- loss: 1.254531, loss_ss: 0.907942, loss_d: 0.346589
0.3843 --- loss: 0.814176, loss_ss: 0.677487, loss_d: 0.136689
0.4228 --- loss: 0.627229, loss_ss: 0.592022, loss_d: 0.035206
0.4612 --- loss: 0.984453, loss_ss: 0.922499, loss_d: 0.061953
0.4996 --- loss: 0.769266, loss_ss: 0.735863, loss_d: 0.033403
0.5380 --- loss: 0.690885, loss_ss: 0.613407, loss_d: 0.077478
0.5765 --- loss: 1.163229, loss_ss: 0.859830, loss_d: 0.303399
0.6149 --- loss: 1.278215, loss_ss: 1.009499, loss_d: 0.268716
0.6533 --- loss: 1.564272, loss_ss: 0.734596, loss_d: 0.829675
0.6918 --- loss: 1.265972, loss_ss: 0.861232, loss_d: 0.404740
0.7302 --- loss: 0.997668, loss_ss: 0.825086, loss_d: 0.172582
0.7686 --- loss: 1.012471, loss_ss: 0.833194, loss_d: 0.179277
0.8071 --- loss: 1.150941, loss_ss: 1.003175, loss_d: 0.147766
0.8455 --- loss: 0.927809, loss_ss: 0.870541, loss_d: 0.057268
0.8839 --- loss: 1.032636, loss_ss: 0.700758, loss_d: 0.331878
0.9224 --- loss: 0.608513, loss_ss: 0.516498, loss_d: 0.092015
0.9608 --- loss: 0.637369, loss_ss: 0.584153, loss_d: 0.053216
0.9992 --- loss: 1.110271, loss_ss: 1.070361, loss_d: 0.039910
Epoch finished! Loss: 1.0522071966758142
Starting epoch 6/10.
0.0000 --- loss: 0.861043, loss_ss: 0.807736, loss_d: 0.053307
0.0384 --- loss: 0.949194, loss_ss: 0.897994, loss_d: 0.051200
0.0769 --- loss: 0.617770, loss_ss: 0.511561, loss_d: 0.106209
0.1153 --- loss: 1.034749, loss_ss: 0.857583, loss_d: 0.177165
0.1537 --- loss: 1.220121, loss_ss: 0.803514, loss_d: 0.416606
0.1922 --- loss: 1.089236, loss_ss: 0.801446, loss_d: 0.287790
0.2306 --- loss: 1.510464, loss_ss: 1.241384, loss_d: 0.269080
0.2690 --- loss: 0.772818, loss_ss: 0.617850, loss_d: 0.154968
0.3075 --- loss: 0.677457, loss_ss: 0.630636, loss_d: 0.046821
0.3459 --- loss: 0.773782, loss_ss: 0.622491, loss_d: 0.151291
0.3843 --- loss: 1.170458, loss_ss: 0.985171, loss_d: 0.185287
0.4228 --- loss: 0.968817, loss_ss: 0.891030, loss_d: 0.077787
0.4612 --- loss: 1.037063, loss_ss: 0.948864, loss_d: 0.088199
0.4996 --- loss: 1.300046, loss_ss: 0.679646, loss_d: 0.620401
0.5380 --- loss: 0.986299, loss_ss: 0.949239, loss_d: 0.037060
0.5765 --- loss: 1.086726, loss_ss: 0.942137, loss_d: 0.144589
0.6149 --- loss: 0.609068, loss_ss: 0.588673, loss_d: 0.020395
0.6533 --- loss: 1.103755, loss_ss: 0.724115, loss_d: 0.379640
0.6918 --- loss: 0.754683, loss_ss: 0.640538, loss_d: 0.114145
0.7302 --- loss: 0.799299, loss_ss: 0.746733, loss_d: 0.052566
0.7686 --- loss: 0.978257, loss_ss: 0.964412, loss_d: 0.013845
0.8071 --- loss: 0.652623, loss_ss: 0.535387, loss_d: 0.117236
0.8455 --- loss: 1.018326, loss_ss: 0.940251, loss_d: 0.078075
0.8839 --- loss: 0.827449, loss_ss: 0.781807, loss_d: 0.045642
0.9224 --- loss: 0.720349, loss_ss: 0.653965, loss_d: 0.066384
0.9608 --- loss: 1.041517, loss_ss: 0.730774, loss_d: 0.310743
0.9992 --- loss: 2.398420, loss_ss: 1.147875, loss_d: 1.250545
Epoch finished! Loss: 0.9539429856034426
Starting epoch 7/10.
0.0000 --- loss: 1.213810, loss_ss: 1.063511, loss_d: 0.150300
0.0384 --- loss: 0.746043, loss_ss: 0.691542, loss_d: 0.054501
0.0769 --- loss: 1.057347, loss_ss: 0.735181, loss_d: 0.322166
0.1153 --- loss: 1.033331, loss_ss: 0.844959, loss_d: 0.188372
0.1537 --- loss: 0.836279, loss_ss: 0.794875, loss_d: 0.041404
0.1922 --- loss: 0.836457, loss_ss: 0.781370, loss_d: 0.055087
0.2306 --- loss: 0.801037, loss_ss: 0.688246, loss_d: 0.112792
0.2690 --- loss: 0.895380, loss_ss: 0.736295, loss_d: 0.159085
0.3075 --- loss: 0.708458, loss_ss: 0.695186, loss_d: 0.013272
0.3459 --- loss: 0.812462, loss_ss: 0.760010, loss_d: 0.052452
0.3843 --- loss: 0.893245, loss_ss: 0.876157, loss_d: 0.017088
0.4228 --- loss: 0.986152, loss_ss: 0.838870, loss_d: 0.147282
0.4612 --- loss: 1.541576, loss_ss: 0.955006, loss_d: 0.586570
0.4996 --- loss: 1.022669, loss_ss: 0.819809, loss_d: 0.202860
0.5380 --- loss: 0.703289, loss_ss: 0.647027, loss_d: 0.056262
0.5765 --- loss: 0.819132, loss_ss: 0.773753, loss_d: 0.045379
0.6149 --- loss: 1.088848, loss_ss: 0.895990, loss_d: 0.192858
0.6533 --- loss: 1.248617, loss_ss: 1.232003, loss_d: 0.016614
0.6918 --- loss: 0.829660, loss_ss: 0.793414, loss_d: 0.036246
0.7302 --- loss: 1.459924, loss_ss: 0.690248, loss_d: 0.769676
0.7686 --- loss: 1.132695, loss_ss: 0.996641, loss_d: 0.136055
0.8071 --- loss: 0.675952, loss_ss: 0.643384, loss_d: 0.032568
0.8455 --- loss: 0.837155, loss_ss: 0.643298, loss_d: 0.193856
0.8839 --- loss: 0.781112, loss_ss: 0.659703, loss_d: 0.121409
0.9224 --- loss: 0.635135, loss_ss: 0.590184, loss_d: 0.044951
0.9608 --- loss: 0.913456, loss_ss: 0.803457, loss_d: 0.109999
0.9992 --- loss: 1.823190, loss_ss: 1.731440, loss_d: 0.091750
Epoch finished! Loss: 0.929635308109797
Starting epoch 8/10.
0.0000 --- loss: 0.887671, loss_ss: 0.736553, loss_d: 0.151118
0.0384 --- loss: 0.779896, loss_ss: 0.761144, loss_d: 0.018753
0.0769 --- loss: 0.768300, loss_ss: 0.623736, loss_d: 0.144565
0.1153 --- loss: 1.752594, loss_ss: 1.215875, loss_d: 0.536719
0.1537 --- loss: 0.766102, loss_ss: 0.720876, loss_d: 0.045226
0.1922 --- loss: 0.676756, loss_ss: 0.635646, loss_d: 0.041110
0.2306 --- loss: 1.039401, loss_ss: 0.795756, loss_d: 0.243645
0.2690 --- loss: 0.990552, loss_ss: 0.826782, loss_d: 0.163771
0.3075 --- loss: 0.838421, loss_ss: 0.747710, loss_d: 0.090710
0.3459 --- loss: 0.836523, loss_ss: 0.750223, loss_d: 0.086300
0.3843 --- loss: 0.926128, loss_ss: 0.668240, loss_d: 0.257888
0.4228 --- loss: 0.846672, loss_ss: 0.799901, loss_d: 0.046771
0.4612 --- loss: 1.047774, loss_ss: 0.972272, loss_d: 0.075503
0.4996 --- loss: 0.840359, loss_ss: 0.706511, loss_d: 0.133848
0.5380 --- loss: 0.860308, loss_ss: 0.773573, loss_d: 0.086735
0.5765 --- loss: 0.837942, loss_ss: 0.667139, loss_d: 0.170803
0.6149 --- loss: 1.478325, loss_ss: 1.445318, loss_d: 0.033007
0.6533 --- loss: 0.947347, loss_ss: 0.862614, loss_d: 0.084733
0.6918 --- loss: 0.870259, loss_ss: 0.849188, loss_d: 0.021071
0.7302 --- loss: 0.979251, loss_ss: 0.957417, loss_d: 0.021835
0.7686 --- loss: 0.960239, loss_ss: 0.839901, loss_d: 0.120338
0.8071 --- loss: 0.703658, loss_ss: 0.665964, loss_d: 0.037694
0.8455 --- loss: 0.881137, loss_ss: 0.812313, loss_d: 0.068824
0.8839 --- loss: 0.947157, loss_ss: 0.847164, loss_d: 0.099993
0.9224 --- loss: 1.076613, loss_ss: 1.059311, loss_d: 0.017302
0.9608 --- loss: 0.900546, loss_ss: 0.557059, loss_d: 0.343486
0.9992 --- loss: 1.349202, loss_ss: 1.061105, loss_d: 0.288097
Epoch finished! Loss: 0.8792693802943596
Starting epoch 9/10.
0.0000 --- loss: 0.934437, loss_ss: 0.884321, loss_d: 0.050116
0.0384 --- loss: 1.028361, loss_ss: 0.730817, loss_d: 0.297544
0.0769 --- loss: 0.882740, loss_ss: 0.840679, loss_d: 0.042061
0.1153 --- loss: 1.129212, loss_ss: 1.116889, loss_d: 0.012323
0.1537 --- loss: 0.930502, loss_ss: 0.916486, loss_d: 0.014016
0.1922 --- loss: 0.990435, loss_ss: 0.806341, loss_d: 0.184094
0.2306 --- loss: 0.845287, loss_ss: 0.671155, loss_d: 0.174131
0.2690 --- loss: 0.916022, loss_ss: 0.840495, loss_d: 0.075527
0.3075 --- loss: 0.699881, loss_ss: 0.678689, loss_d: 0.021191
0.3459 --- loss: 0.950625, loss_ss: 0.858507, loss_d: 0.092118
0.3843 --- loss: 0.685913, loss_ss: 0.667368, loss_d: 0.018545
0.4228 --- loss: 0.760189, loss_ss: 0.744395, loss_d: 0.015794
0.4612 --- loss: 1.956445, loss_ss: 0.597073, loss_d: 1.359372
0.4996 --- loss: 0.981459, loss_ss: 0.975307, loss_d: 0.006152
0.5380 --- loss: 1.140175, loss_ss: 0.777035, loss_d: 0.363140
0.5765 --- loss: 1.040566, loss_ss: 0.860578, loss_d: 0.179988
0.6149 --- loss: 0.671396, loss_ss: 0.616804, loss_d: 0.054592
0.6533 --- loss: 0.596467, loss_ss: 0.566960, loss_d: 0.029507
0.6918 --- loss: 0.787125, loss_ss: 0.776262, loss_d: 0.010863
0.7302 --- loss: 0.888822, loss_ss: 0.613674, loss_d: 0.275148
0.7686 --- loss: 0.823148, loss_ss: 0.808815, loss_d: 0.014333
0.8071 --- loss: 0.848386, loss_ss: 0.704745, loss_d: 0.143641
0.8455 --- loss: 0.925138, loss_ss: 0.853637, loss_d: 0.071501
0.8839 --- loss: 0.813997, loss_ss: 0.781783, loss_d: 0.032214
0.9224 --- loss: 0.626852, loss_ss: 0.573684, loss_d: 0.053169
0.9608 --- loss: 0.688045, loss_ss: 0.509979, loss_d: 0.178066
0.9992 --- loss: 0.847410, loss_ss: 0.539096, loss_d: 0.308314
Epoch finished! Loss: 0.8613728409776321
Starting epoch 10/10.
0.0000 --- loss: 0.725539, loss_ss: 0.700527, loss_d: 0.025012
0.0384 --- loss: 0.590249, loss_ss: 0.577684, loss_d: 0.012565
0.0769 --- loss: 0.964070, loss_ss: 0.937851, loss_d: 0.026219
0.1153 --- loss: 1.025877, loss_ss: 0.756686, loss_d: 0.269191
0.1537 --- loss: 0.545495, loss_ss: 0.528515, loss_d: 0.016981
0.1922 --- loss: 0.727185, loss_ss: 0.534295, loss_d: 0.192890
0.2306 --- loss: 0.871067, loss_ss: 0.695435, loss_d: 0.175633
0.2690 --- loss: 1.035105, loss_ss: 0.927284, loss_d: 0.107822
0.3075 --- loss: 1.194767, loss_ss: 0.868990, loss_d: 0.325777
0.3459 --- loss: 1.472963, loss_ss: 1.037519, loss_d: 0.435444
0.3843 --- loss: 0.808764, loss_ss: 0.753869, loss_d: 0.054895
0.4228 --- loss: 0.685916, loss_ss: 0.678137, loss_d: 0.007779
0.4612 --- loss: 0.845532, loss_ss: 0.785764, loss_d: 0.059769
0.4996 --- loss: 0.550184, loss_ss: 0.514591, loss_d: 0.035593
0.5380 --- loss: 0.910808, loss_ss: 0.902908, loss_d: 0.007900
0.5765 --- loss: 0.980864, loss_ss: 0.966330, loss_d: 0.014534
0.6149 --- loss: 0.908234, loss_ss: 0.726926, loss_d: 0.181309
0.6533 --- loss: 0.785691, loss_ss: 0.755008, loss_d: 0.030684
0.6918 --- loss: 0.899106, loss_ss: 0.809668, loss_d: 0.089439
0.7302 --- loss: 1.148456, loss_ss: 1.111337, loss_d: 0.037119
0.7686 --- loss: 0.775271, loss_ss: 0.742044, loss_d: 0.033227
0.8071 --- loss: 0.751772, loss_ss: 0.740721, loss_d: 0.011051
0.8455 --- loss: 0.851595, loss_ss: 0.818132, loss_d: 0.033463
0.8839 --- loss: 0.822124, loss_ss: 0.810192, loss_d: 0.011932
0.9224 --- loss: 0.881147, loss_ss: 0.819500, loss_d: 0.061647
0.9608 --- loss: 0.641751, loss_ss: 0.596554, loss_d: 0.045197
0.9992 --- loss: 1.574324, loss_ss: 1.261177, loss_d: 0.313147
Epoch finished! Loss: 0.8581446699224986
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6555555555555556
             precision    recall  f1-score   support

        0.0       0.24      0.93      0.38        30
        1.0       0.13      0.06      0.08       136
        2.0       0.74      0.57      0.64       404
        3.0       0.91      0.81      0.86       239
        4.0       0.66      0.92      0.77       271

avg / total       0.67      0.66      0.64      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.48  93.33   91.43  23.73     37.84
1  83.33   5.88   94.49  13.33      8.16
2  76.39  56.93   88.02  73.95     64.34
3  93.98  80.75   97.74  91.04     85.59
4  85.93  91.88   83.93  65.70     76.62
Total accuracy: 65.56%
Average sen: 65.76%
Average spec: 91.12%
Macro f1-score: 54.51%
Diagnosis acc on 15mins: 0.8888888888888888
[0.93608564 0.679537   0.72662044 0.93668979 0.94540799 0.7097491
 0.0974657  0.87598401 0.78958523 0.70373237 0.13502873 0.85290873
 0.82381123 0.95508099 0.99585354 0.99983442 0.99964893 0.82756382
 0.92814153 0.99315792 0.87698638 0.99925297 0.705028   0.82286668
 0.99830461 0.9878214  0.85025996 0.99004632 0.94848871 0.19352917
 0.29012147 0.82998896 0.77094913 0.89374185 0.89857399 0.87160534]
pred: 0.8010958907090955, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.247420, loss_ss: 1.611181, loss_d: 0.636238
0.0384 --- loss: 2.341678, loss_ss: 1.638900, loss_d: 0.702778
0.0768 --- loss: 1.818207, loss_ss: 1.463081, loss_d: 0.355126
0.1152 --- loss: 1.907000, loss_ss: 1.440679, loss_d: 0.466321
0.1536 --- loss: 1.921997, loss_ss: 1.384258, loss_d: 0.537739
0.1919 --- loss: 1.764931, loss_ss: 1.364702, loss_d: 0.400229
0.2303 --- loss: 1.910600, loss_ss: 1.296230, loss_d: 0.614370
0.2687 --- loss: 2.475381, loss_ss: 1.582028, loss_d: 0.893354
0.3071 --- loss: 2.039039, loss_ss: 1.500911, loss_d: 0.538128
0.3455 --- loss: 1.990508, loss_ss: 1.478974, loss_d: 0.511533
0.3839 --- loss: 1.686070, loss_ss: 1.477426, loss_d: 0.208645
0.4223 --- loss: 1.880653, loss_ss: 1.138682, loss_d: 0.741971
0.4607 --- loss: 1.908703, loss_ss: 1.257088, loss_d: 0.651615
0.4990 --- loss: 1.960561, loss_ss: 1.585359, loss_d: 0.375202
0.5374 --- loss: 2.163094, loss_ss: 1.462234, loss_d: 0.700859
0.5758 --- loss: 1.949401, loss_ss: 1.308736, loss_d: 0.640664
0.6142 --- loss: 1.628595, loss_ss: 1.250142, loss_d: 0.378453
0.6526 --- loss: 1.798354, loss_ss: 1.084419, loss_d: 0.713935
0.6910 --- loss: 1.783229, loss_ss: 1.326821, loss_d: 0.456408
0.7294 --- loss: 1.661250, loss_ss: 1.262864, loss_d: 0.398386
0.7678 --- loss: 1.541306, loss_ss: 1.136852, loss_d: 0.404454
0.8061 --- loss: 1.385222, loss_ss: 1.002680, loss_d: 0.382542
0.8445 --- loss: 2.028483, loss_ss: 1.035801, loss_d: 0.992682
0.8829 --- loss: 1.719191, loss_ss: 1.004254, loss_d: 0.714937
0.9213 --- loss: 1.387622, loss_ss: 1.167890, loss_d: 0.219732
0.9597 --- loss: 1.689670, loss_ss: 1.310264, loss_d: 0.379406
0.9981 --- loss: 1.820604, loss_ss: 0.861791, loss_d: 0.958813
Epoch finished! Loss: 1.8733471815402691
Starting epoch 2/10.
0.0000 --- loss: 1.691251, loss_ss: 1.007632, loss_d: 0.683618
0.0384 --- loss: 1.388808, loss_ss: 1.133421, loss_d: 0.255387
0.0768 --- loss: 1.345062, loss_ss: 1.069440, loss_d: 0.275621
0.1152 --- loss: 1.426762, loss_ss: 1.102943, loss_d: 0.323819
0.1536 --- loss: 1.456214, loss_ss: 0.983971, loss_d: 0.472243
0.1919 --- loss: 1.231064, loss_ss: 0.867575, loss_d: 0.363489
0.2303 --- loss: 1.116139, loss_ss: 0.928191, loss_d: 0.187948
0.2687 --- loss: 1.313702, loss_ss: 0.999754, loss_d: 0.313948
0.3071 --- loss: 1.791651, loss_ss: 1.231508, loss_d: 0.560143
0.3455 --- loss: 1.319834, loss_ss: 1.168321, loss_d: 0.151513
0.3839 --- loss: 1.421717, loss_ss: 0.990841, loss_d: 0.430876
0.4223 --- loss: 1.458938, loss_ss: 1.018359, loss_d: 0.440578
0.4607 --- loss: 1.455199, loss_ss: 1.203774, loss_d: 0.251424
0.4990 --- loss: 1.236725, loss_ss: 0.977829, loss_d: 0.258896
0.5374 --- loss: 1.046024, loss_ss: 0.869233, loss_d: 0.176791
0.5758 --- loss: 1.619353, loss_ss: 0.986803, loss_d: 0.632550
0.6142 --- loss: 1.282441, loss_ss: 1.077411, loss_d: 0.205030
0.6526 --- loss: 1.079839, loss_ss: 0.968456, loss_d: 0.111383
0.6910 --- loss: 1.260783, loss_ss: 1.031975, loss_d: 0.228808
0.7294 --- loss: 1.311730, loss_ss: 0.954316, loss_d: 0.357413
0.7678 --- loss: 1.298190, loss_ss: 1.060271, loss_d: 0.237919
0.8061 --- loss: 1.564538, loss_ss: 1.288380, loss_d: 0.276159
0.8445 --- loss: 1.347382, loss_ss: 0.970091, loss_d: 0.377291
0.8829 --- loss: 1.195719, loss_ss: 0.933434, loss_d: 0.262285
0.9213 --- loss: 1.450299, loss_ss: 1.145945, loss_d: 0.304355
0.9597 --- loss: 0.977061, loss_ss: 0.926147, loss_d: 0.050913
0.9981 --- loss: 2.010282, loss_ss: 1.429371, loss_d: 0.580911
Epoch finished! Loss: 1.4014265768803083
Starting epoch 3/10.
0.0000 --- loss: 1.237481, loss_ss: 1.148228, loss_d: 0.089253
0.0384 --- loss: 1.070492, loss_ss: 0.783113, loss_d: 0.287379
0.0768 --- loss: 1.056169, loss_ss: 0.862989, loss_d: 0.193180
0.1152 --- loss: 1.206540, loss_ss: 0.982021, loss_d: 0.224519
0.1536 --- loss: 1.338193, loss_ss: 1.137352, loss_d: 0.200841
0.1919 --- loss: 1.110406, loss_ss: 0.769910, loss_d: 0.340496
0.2303 --- loss: 1.243024, loss_ss: 1.007994, loss_d: 0.235030
0.2687 --- loss: 1.148583, loss_ss: 1.009157, loss_d: 0.139426
0.3071 --- loss: 1.166114, loss_ss: 0.857666, loss_d: 0.308448
0.3455 --- loss: 1.504225, loss_ss: 0.890884, loss_d: 0.613342
0.3839 --- loss: 1.120687, loss_ss: 0.960132, loss_d: 0.160556
0.4223 --- loss: 0.985680, loss_ss: 0.828522, loss_d: 0.157158
0.4607 --- loss: 1.342894, loss_ss: 0.978258, loss_d: 0.364636
0.4990 --- loss: 1.044100, loss_ss: 0.906708, loss_d: 0.137392
0.5374 --- loss: 1.131573, loss_ss: 0.893263, loss_d: 0.238310
0.5758 --- loss: 1.333436, loss_ss: 1.040594, loss_d: 0.292842
0.6142 --- loss: 1.151948, loss_ss: 1.061145, loss_d: 0.090802
0.6526 --- loss: 1.230664, loss_ss: 1.017504, loss_d: 0.213160
0.6910 --- loss: 1.266506, loss_ss: 0.910238, loss_d: 0.356268
0.7294 --- loss: 1.139879, loss_ss: 0.968983, loss_d: 0.170896
0.7678 --- loss: 1.898855, loss_ss: 1.206613, loss_d: 0.692242
0.8061 --- loss: 1.842786, loss_ss: 1.265330, loss_d: 0.577456
0.8445 --- loss: 1.043821, loss_ss: 0.835835, loss_d: 0.207985
0.8829 --- loss: 1.073179, loss_ss: 0.874943, loss_d: 0.198236
0.9213 --- loss: 0.802613, loss_ss: 0.675885, loss_d: 0.126727
0.9597 --- loss: 1.033844, loss_ss: 0.839286, loss_d: 0.194558
0.9981 --- loss: 0.939822, loss_ss: 0.846357, loss_d: 0.093465
Epoch finished! Loss: 1.2056122270914225
Starting epoch 4/10.
0.0000 --- loss: 1.087943, loss_ss: 0.959536, loss_d: 0.128407
0.0384 --- loss: 1.434319, loss_ss: 0.675969, loss_d: 0.758350
0.0768 --- loss: 1.294865, loss_ss: 1.039004, loss_d: 0.255861
0.1152 --- loss: 1.163585, loss_ss: 0.915680, loss_d: 0.247905
0.1536 --- loss: 0.921489, loss_ss: 0.818881, loss_d: 0.102609
0.1919 --- loss: 0.907093, loss_ss: 0.801181, loss_d: 0.105912
0.2303 --- loss: 1.060420, loss_ss: 0.956855, loss_d: 0.103565
0.2687 --- loss: 0.913737, loss_ss: 0.800795, loss_d: 0.112942
0.3071 --- loss: 1.501109, loss_ss: 0.814280, loss_d: 0.686829
0.3455 --- loss: 2.078077, loss_ss: 0.874440, loss_d: 1.203637
0.3839 --- loss: 0.976272, loss_ss: 0.673424, loss_d: 0.302848
0.4223 --- loss: 1.038682, loss_ss: 0.915578, loss_d: 0.123104
0.4607 --- loss: 0.957626, loss_ss: 0.799521, loss_d: 0.158105
0.4990 --- loss: 1.380574, loss_ss: 1.050968, loss_d: 0.329606
0.5374 --- loss: 0.998640, loss_ss: 0.643477, loss_d: 0.355163
0.5758 --- loss: 0.850129, loss_ss: 0.811249, loss_d: 0.038880
0.6142 --- loss: 1.095746, loss_ss: 0.933789, loss_d: 0.161956
0.6526 --- loss: 1.329878, loss_ss: 0.709709, loss_d: 0.620169
0.6910 --- loss: 1.139155, loss_ss: 0.871165, loss_d: 0.267990
0.7294 --- loss: 1.033091, loss_ss: 0.685845, loss_d: 0.347246
0.7678 --- loss: 0.924888, loss_ss: 0.715616, loss_d: 0.209272
0.8061 --- loss: 0.872907, loss_ss: 0.800176, loss_d: 0.072732
0.8445 --- loss: 0.944459, loss_ss: 0.887546, loss_d: 0.056913
0.8829 --- loss: 1.061455, loss_ss: 0.799576, loss_d: 0.261880
0.9213 --- loss: 1.001619, loss_ss: 0.849174, loss_d: 0.152445
0.9597 --- loss: 1.154136, loss_ss: 0.913127, loss_d: 0.241009
0.9981 --- loss: 1.106036, loss_ss: 0.954733, loss_d: 0.151303
Epoch finished! Loss: 1.0843522326304362
Starting epoch 5/10.
0.0000 --- loss: 1.115651, loss_ss: 0.743559, loss_d: 0.372092
0.0384 --- loss: 1.291119, loss_ss: 0.890033, loss_d: 0.401086
0.0768 --- loss: 0.886246, loss_ss: 0.724627, loss_d: 0.161619
0.1152 --- loss: 1.371180, loss_ss: 0.928710, loss_d: 0.442469
0.1536 --- loss: 1.258749, loss_ss: 1.136261, loss_d: 0.122488
0.1919 --- loss: 0.894694, loss_ss: 0.792242, loss_d: 0.102451
0.2303 --- loss: 0.784300, loss_ss: 0.736541, loss_d: 0.047758
0.2687 --- loss: 0.876353, loss_ss: 0.772797, loss_d: 0.103556
0.3071 --- loss: 1.030289, loss_ss: 0.869557, loss_d: 0.160733
0.3455 --- loss: 0.923485, loss_ss: 0.631268, loss_d: 0.292217
0.3839 --- loss: 1.277255, loss_ss: 0.991401, loss_d: 0.285855
0.4223 --- loss: 1.225430, loss_ss: 0.990337, loss_d: 0.235092
0.4607 --- loss: 1.168391, loss_ss: 1.005701, loss_d: 0.162691
0.4990 --- loss: 0.782693, loss_ss: 0.713002, loss_d: 0.069691
0.5374 --- loss: 0.751920, loss_ss: 0.701959, loss_d: 0.049960
0.5758 --- loss: 1.211165, loss_ss: 1.157102, loss_d: 0.054064
0.6142 --- loss: 1.147134, loss_ss: 1.110518, loss_d: 0.036616
0.6526 --- loss: 1.355667, loss_ss: 1.323174, loss_d: 0.032492
0.6910 --- loss: 0.956023, loss_ss: 0.783408, loss_d: 0.172616
0.7294 --- loss: 1.755407, loss_ss: 1.316582, loss_d: 0.438825
0.7678 --- loss: 1.133056, loss_ss: 0.851295, loss_d: 0.281761
0.8061 --- loss: 0.711091, loss_ss: 0.693892, loss_d: 0.017199
0.8445 --- loss: 0.993130, loss_ss: 0.780373, loss_d: 0.212757
0.8829 --- loss: 0.806916, loss_ss: 0.715816, loss_d: 0.091100
0.9213 --- loss: 0.773833, loss_ss: 0.460987, loss_d: 0.312846
0.9597 --- loss: 0.851426, loss_ss: 0.745946, loss_d: 0.105480
0.9981 --- loss: 1.096135, loss_ss: 0.639581, loss_d: 0.456554
Epoch finished! Loss: 1.0298485992046502
Starting epoch 6/10.
0.0000 --- loss: 1.278958, loss_ss: 0.773180, loss_d: 0.505778
0.0384 --- loss: 0.739298, loss_ss: 0.732906, loss_d: 0.006392
0.0768 --- loss: 0.937870, loss_ss: 0.903506, loss_d: 0.034364
0.1152 --- loss: 0.896372, loss_ss: 0.701930, loss_d: 0.194442
0.1536 --- loss: 0.709502, loss_ss: 0.659454, loss_d: 0.050049
0.1919 --- loss: 0.972379, loss_ss: 0.760454, loss_d: 0.211926
0.2303 --- loss: 0.937900, loss_ss: 0.838932, loss_d: 0.098969
0.2687 --- loss: 1.443835, loss_ss: 0.850553, loss_d: 0.593283
0.3071 --- loss: 1.006649, loss_ss: 0.664346, loss_d: 0.342303
0.3455 --- loss: 0.721893, loss_ss: 0.610937, loss_d: 0.110956
0.3839 --- loss: 0.892148, loss_ss: 0.587639, loss_d: 0.304510
0.4223 --- loss: 0.844609, loss_ss: 0.760870, loss_d: 0.083739
0.4607 --- loss: 1.012033, loss_ss: 0.971576, loss_d: 0.040457
0.4990 --- loss: 0.761324, loss_ss: 0.577047, loss_d: 0.184277
0.5374 --- loss: 0.873257, loss_ss: 0.651411, loss_d: 0.221847
0.5758 --- loss: 0.989470, loss_ss: 0.887010, loss_d: 0.102461
0.6142 --- loss: 0.678381, loss_ss: 0.603944, loss_d: 0.074437
0.6526 --- loss: 0.667737, loss_ss: 0.614584, loss_d: 0.053154
0.6910 --- loss: 0.612396, loss_ss: 0.549472, loss_d: 0.062924
0.7294 --- loss: 0.665008, loss_ss: 0.584501, loss_d: 0.080507
0.7678 --- loss: 0.807537, loss_ss: 0.772828, loss_d: 0.034708
0.8061 --- loss: 0.952216, loss_ss: 0.915466, loss_d: 0.036750
0.8445 --- loss: 0.986204, loss_ss: 0.786526, loss_d: 0.199678
0.8829 --- loss: 0.978772, loss_ss: 0.848752, loss_d: 0.130020
0.9213 --- loss: 0.716475, loss_ss: 0.691262, loss_d: 0.025213
0.9597 --- loss: 1.221265, loss_ss: 0.990698, loss_d: 0.230567
0.9981 --- loss: 1.376817, loss_ss: 0.430469, loss_d: 0.946348
Epoch finished! Loss: 0.9583773917876757
Starting epoch 7/10.
0.0000 --- loss: 0.791491, loss_ss: 0.727209, loss_d: 0.064282
0.0384 --- loss: 1.435660, loss_ss: 1.370622, loss_d: 0.065038
0.0768 --- loss: 1.200767, loss_ss: 1.115017, loss_d: 0.085750
0.1152 --- loss: 0.935296, loss_ss: 0.865524, loss_d: 0.069773
0.1536 --- loss: 1.121468, loss_ss: 0.940975, loss_d: 0.180494
0.1919 --- loss: 0.781746, loss_ss: 0.739602, loss_d: 0.042144
0.2303 --- loss: 1.141704, loss_ss: 0.598330, loss_d: 0.543374
0.2687 --- loss: 0.818396, loss_ss: 0.652233, loss_d: 0.166163
0.3071 --- loss: 0.783151, loss_ss: 0.640352, loss_d: 0.142800
0.3455 --- loss: 0.807230, loss_ss: 0.725987, loss_d: 0.081243
0.3839 --- loss: 0.986430, loss_ss: 0.823600, loss_d: 0.162830
0.4223 --- loss: 0.748016, loss_ss: 0.693061, loss_d: 0.054955
0.4607 --- loss: 1.157297, loss_ss: 1.129241, loss_d: 0.028056
0.4990 --- loss: 0.654067, loss_ss: 0.618670, loss_d: 0.035397
0.5374 --- loss: 0.875389, loss_ss: 0.736662, loss_d: 0.138727
0.5758 --- loss: 1.211330, loss_ss: 0.835499, loss_d: 0.375831
0.6142 --- loss: 0.691628, loss_ss: 0.508102, loss_d: 0.183526
0.6526 --- loss: 1.075828, loss_ss: 1.014901, loss_d: 0.060926
0.6910 --- loss: 0.768817, loss_ss: 0.702631, loss_d: 0.066186
0.7294 --- loss: 1.102752, loss_ss: 0.702995, loss_d: 0.399758
0.7678 --- loss: 0.681836, loss_ss: 0.664737, loss_d: 0.017099
0.8061 --- loss: 0.922903, loss_ss: 0.878516, loss_d: 0.044388
0.8445 --- loss: 0.930213, loss_ss: 0.916608, loss_d: 0.013605
0.8829 --- loss: 0.874615, loss_ss: 0.829800, loss_d: 0.044815
0.9213 --- loss: 0.959437, loss_ss: 0.881571, loss_d: 0.077866
0.9597 --- loss: 1.142688, loss_ss: 0.694179, loss_d: 0.448509
0.9981 --- loss: 0.900141, loss_ss: 0.783583, loss_d: 0.116558
Epoch finished! Loss: 0.9281262958279023
Starting epoch 8/10.
0.0000 --- loss: 0.717397, loss_ss: 0.618222, loss_d: 0.099175
0.0384 --- loss: 0.742473, loss_ss: 0.661192, loss_d: 0.081281
0.0768 --- loss: 0.843125, loss_ss: 0.536974, loss_d: 0.306151
0.1152 --- loss: 0.631756, loss_ss: 0.541279, loss_d: 0.090477
0.1536 --- loss: 0.738246, loss_ss: 0.654649, loss_d: 0.083597
0.1919 --- loss: 0.857579, loss_ss: 0.797189, loss_d: 0.060390
0.2303 --- loss: 1.112401, loss_ss: 0.681573, loss_d: 0.430828
0.2687 --- loss: 1.026324, loss_ss: 0.874409, loss_d: 0.151915
0.3071 --- loss: 0.760710, loss_ss: 0.745764, loss_d: 0.014946
0.3455 --- loss: 0.872399, loss_ss: 0.594709, loss_d: 0.277690
0.3839 --- loss: 0.874244, loss_ss: 0.850400, loss_d: 0.023844
0.4223 --- loss: 0.716731, loss_ss: 0.669945, loss_d: 0.046786
0.4607 --- loss: 0.777104, loss_ss: 0.617817, loss_d: 0.159287
0.4990 --- loss: 0.692971, loss_ss: 0.662431, loss_d: 0.030541
0.5374 --- loss: 0.635762, loss_ss: 0.607571, loss_d: 0.028192
0.5758 --- loss: 2.846839, loss_ss: 0.538837, loss_d: 2.308002
0.6142 --- loss: 0.768308, loss_ss: 0.728636, loss_d: 0.039671
0.6526 --- loss: 1.094816, loss_ss: 0.979024, loss_d: 0.115793
0.6910 --- loss: 0.713156, loss_ss: 0.578651, loss_d: 0.134504
0.7294 --- loss: 0.966833, loss_ss: 0.676432, loss_d: 0.290401
0.7678 --- loss: 0.578311, loss_ss: 0.492077, loss_d: 0.086234
0.8061 --- loss: 0.941573, loss_ss: 0.882602, loss_d: 0.058971
0.8445 --- loss: 0.660972, loss_ss: 0.584679, loss_d: 0.076293
0.8829 --- loss: 0.685519, loss_ss: 0.676548, loss_d: 0.008970
0.9213 --- loss: 0.595325, loss_ss: 0.568201, loss_d: 0.027124
0.9597 --- loss: 0.845868, loss_ss: 0.840264, loss_d: 0.005604
0.9981 --- loss: 3.597920, loss_ss: 0.451147, loss_d: 3.146774
Epoch finished! Loss: 0.8978272038010451
Starting epoch 9/10.
0.0000 --- loss: 1.086456, loss_ss: 0.540415, loss_d: 0.546041
0.0384 --- loss: 1.044353, loss_ss: 0.839661, loss_d: 0.204692
0.0768 --- loss: 1.162997, loss_ss: 1.070830, loss_d: 0.092167
0.1152 --- loss: 1.005176, loss_ss: 0.977708, loss_d: 0.027468
0.1536 --- loss: 0.919598, loss_ss: 0.726829, loss_d: 0.192769
0.1919 --- loss: 1.147834, loss_ss: 1.106991, loss_d: 0.040842
0.2303 --- loss: 0.835965, loss_ss: 0.760639, loss_d: 0.075326
0.2687 --- loss: 0.744610, loss_ss: 0.652516, loss_d: 0.092095
0.3071 --- loss: 0.654071, loss_ss: 0.558000, loss_d: 0.096071
0.3455 --- loss: 0.746551, loss_ss: 0.729781, loss_d: 0.016770
0.3839 --- loss: 0.608841, loss_ss: 0.594988, loss_d: 0.013852
0.4223 --- loss: 1.083969, loss_ss: 1.046513, loss_d: 0.037456
0.4607 --- loss: 0.972438, loss_ss: 0.449338, loss_d: 0.523100
0.4990 --- loss: 1.088413, loss_ss: 0.927472, loss_d: 0.160941
0.5374 --- loss: 0.802702, loss_ss: 0.495259, loss_d: 0.307443
0.5758 --- loss: 0.610159, loss_ss: 0.583355, loss_d: 0.026805
0.6142 --- loss: 0.603448, loss_ss: 0.600277, loss_d: 0.003171
0.6526 --- loss: 0.913290, loss_ss: 0.749718, loss_d: 0.163572
0.6910 --- loss: 0.651137, loss_ss: 0.642039, loss_d: 0.009098
0.7294 --- loss: 0.570750, loss_ss: 0.519073, loss_d: 0.051677
0.7678 --- loss: 0.807454, loss_ss: 0.690877, loss_d: 0.116577
0.8061 --- loss: 0.942550, loss_ss: 0.765511, loss_d: 0.177038
0.8445 --- loss: 0.790539, loss_ss: 0.769876, loss_d: 0.020663
0.8829 --- loss: 0.900829, loss_ss: 0.839381, loss_d: 0.061449
0.9213 --- loss: 0.647545, loss_ss: 0.608636, loss_d: 0.038909
0.9597 --- loss: 0.748425, loss_ss: 0.634275, loss_d: 0.114149
0.9981 --- loss: 0.894262, loss_ss: 0.460604, loss_d: 0.433658
Epoch finished! Loss: 0.8866599160891313
Starting epoch 10/10.
0.0000 --- loss: 0.834268, loss_ss: 0.824207, loss_d: 0.010061
0.0384 --- loss: 0.776486, loss_ss: 0.713212, loss_d: 0.063274
0.0768 --- loss: 0.728551, loss_ss: 0.698403, loss_d: 0.030148
0.1152 --- loss: 1.429978, loss_ss: 1.093741, loss_d: 0.336238
0.1536 --- loss: 0.865995, loss_ss: 0.780039, loss_d: 0.085956
0.1919 --- loss: 0.952960, loss_ss: 0.806608, loss_d: 0.146352
0.2303 --- loss: 0.849538, loss_ss: 0.601422, loss_d: 0.248115
0.2687 --- loss: 0.688703, loss_ss: 0.669415, loss_d: 0.019288
0.3071 --- loss: 0.676428, loss_ss: 0.672304, loss_d: 0.004125
0.3455 --- loss: 1.104882, loss_ss: 1.030605, loss_d: 0.074277
0.3839 --- loss: 0.552224, loss_ss: 0.547218, loss_d: 0.005007
0.4223 --- loss: 0.944523, loss_ss: 0.901452, loss_d: 0.043071
0.4607 --- loss: 0.831326, loss_ss: 0.665709, loss_d: 0.165617
0.4990 --- loss: 0.498798, loss_ss: 0.474134, loss_d: 0.024664
0.5374 --- loss: 0.730175, loss_ss: 0.630845, loss_d: 0.099330
0.5758 --- loss: 0.789083, loss_ss: 0.711530, loss_d: 0.077553
0.6142 --- loss: 0.831653, loss_ss: 0.755507, loss_d: 0.076146
0.6526 --- loss: 1.021391, loss_ss: 1.008766, loss_d: 0.012625
0.6910 --- loss: 1.327625, loss_ss: 0.772176, loss_d: 0.555449
0.7294 --- loss: 0.924780, loss_ss: 0.921022, loss_d: 0.003757
0.7678 --- loss: 0.602987, loss_ss: 0.570275, loss_d: 0.032712
0.8061 --- loss: 0.813232, loss_ss: 0.774605, loss_d: 0.038628
0.8445 --- loss: 0.653654, loss_ss: 0.652944, loss_d: 0.000710
0.8829 --- loss: 0.708290, loss_ss: 0.699444, loss_d: 0.008847
0.9213 --- loss: 0.789673, loss_ss: 0.787442, loss_d: 0.002231
0.9597 --- loss: 0.934581, loss_ss: 0.890534, loss_d: 0.044047
0.9981 --- loss: 0.738898, loss_ss: 0.708976, loss_d: 0.029922
Epoch finished! Loss: 0.8229555141467314
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8111111111111111
             precision    recall  f1-score   support

        0.0       0.94      0.77      0.84       159
        1.0       0.33      0.06      0.10        87
        2.0       0.86      0.92      0.88       439
        3.0       0.99      0.72      0.83        99
        4.0       0.67      0.99      0.80       206

avg / total       0.80      0.81      0.79       990
 


====== chp052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.45  76.73   99.04  93.85     84.43
1  90.71   5.75   98.89  33.33      9.80
2  89.39  91.57   87.66  85.53     88.45
3  97.07  71.72   99.89  98.61     83.04
4  89.60  98.54   87.24  67.00     79.76
Total accuracy: 81.11%
Average sen: 68.86%
Average spec: 94.54%
Macro f1-score: 69.10%
Diagnosis acc on 15mins: 1.0
[0.99999285 1.         0.99999988 0.99997878 0.99946767 0.96901917
 0.99808782 0.99551094 0.99616253 0.99632663 0.99999976 0.99769419
 0.99992847 0.99896133 0.99948573 0.99542087 0.99942821 0.99857259
 0.99014413 0.99905354 0.99958271 0.99836892 0.9937309  0.99744797
 0.99831247 0.99963915 0.99990904 0.99999952 0.9994235  0.99705052
 0.99226975 0.9958722  0.99937516]
pred: 0.9970974831870107, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.369609, loss_ss: 1.666520, loss_d: 0.703090
0.0384 --- loss: 2.284116, loss_ss: 1.513180, loss_d: 0.770935
0.0769 --- loss: 2.232187, loss_ss: 1.495689, loss_d: 0.736498
0.1153 --- loss: 2.100089, loss_ss: 1.313518, loss_d: 0.786570
0.1537 --- loss: 1.934329, loss_ss: 1.370263, loss_d: 0.564066
0.1922 --- loss: 1.933705, loss_ss: 1.361824, loss_d: 0.571881
0.2306 --- loss: 2.144518, loss_ss: 1.245082, loss_d: 0.899436
0.2690 --- loss: 1.729597, loss_ss: 1.290406, loss_d: 0.439192
0.3075 --- loss: 1.647362, loss_ss: 1.200068, loss_d: 0.447294
0.3459 --- loss: 1.974048, loss_ss: 1.210172, loss_d: 0.763876
0.3843 --- loss: 1.700531, loss_ss: 1.198326, loss_d: 0.502205
0.4228 --- loss: 1.820862, loss_ss: 1.220936, loss_d: 0.599926
0.4612 --- loss: 1.762623, loss_ss: 1.251405, loss_d: 0.511219
0.4996 --- loss: 1.689841, loss_ss: 1.145824, loss_d: 0.544016
0.5380 --- loss: 1.854846, loss_ss: 1.284336, loss_d: 0.570511
0.5765 --- loss: 1.679461, loss_ss: 1.259917, loss_d: 0.419544
0.6149 --- loss: 1.633063, loss_ss: 1.271446, loss_d: 0.361617
0.6533 --- loss: 1.397884, loss_ss: 1.129837, loss_d: 0.268047
0.6918 --- loss: 1.469504, loss_ss: 1.234777, loss_d: 0.234727
0.7302 --- loss: 1.686213, loss_ss: 1.072174, loss_d: 0.614038
0.7686 --- loss: 1.463343, loss_ss: 0.999858, loss_d: 0.463485
0.8071 --- loss: 1.309383, loss_ss: 0.941922, loss_d: 0.367460
0.8455 --- loss: 1.540917, loss_ss: 1.262456, loss_d: 0.278462
0.8839 --- loss: 1.160127, loss_ss: 0.957854, loss_d: 0.202273
0.9224 --- loss: 1.434254, loss_ss: 1.174500, loss_d: 0.259753
0.9608 --- loss: 1.527485, loss_ss: 1.128426, loss_d: 0.399058
0.9992 --- loss: 3.428063, loss_ss: 1.472002, loss_d: 1.956061
Epoch finished! Loss: 1.783154711815027
Starting epoch 2/10.
0.0000 --- loss: 1.702138, loss_ss: 1.114926, loss_d: 0.587212
0.0384 --- loss: 1.252013, loss_ss: 0.907517, loss_d: 0.344496
0.0769 --- loss: 1.254689, loss_ss: 1.063743, loss_d: 0.190947
0.1153 --- loss: 1.276403, loss_ss: 1.093753, loss_d: 0.182650
0.1537 --- loss: 0.957768, loss_ss: 0.886828, loss_d: 0.070940
0.1922 --- loss: 1.274545, loss_ss: 1.156920, loss_d: 0.117625
0.2306 --- loss: 1.329732, loss_ss: 1.023497, loss_d: 0.306235
0.2690 --- loss: 1.261035, loss_ss: 0.932892, loss_d: 0.328143
0.3075 --- loss: 1.690432, loss_ss: 1.220934, loss_d: 0.469498
0.3459 --- loss: 1.436408, loss_ss: 1.120421, loss_d: 0.315987
0.3843 --- loss: 1.270699, loss_ss: 1.148319, loss_d: 0.122380
0.4228 --- loss: 1.414464, loss_ss: 1.021386, loss_d: 0.393078
0.4612 --- loss: 1.428230, loss_ss: 0.887930, loss_d: 0.540299
0.4996 --- loss: 1.526356, loss_ss: 1.229357, loss_d: 0.296999
0.5380 --- loss: 1.134769, loss_ss: 0.958230, loss_d: 0.176539
0.5765 --- loss: 1.321016, loss_ss: 0.922219, loss_d: 0.398798
0.6149 --- loss: 1.035872, loss_ss: 0.888528, loss_d: 0.147344
0.6533 --- loss: 1.302365, loss_ss: 0.958378, loss_d: 0.343987
0.6918 --- loss: 1.654772, loss_ss: 0.860112, loss_d: 0.794660
0.7302 --- loss: 2.086426, loss_ss: 0.983996, loss_d: 1.102430
0.7686 --- loss: 1.119676, loss_ss: 1.010257, loss_d: 0.109420
0.8071 --- loss: 0.956621, loss_ss: 0.797766, loss_d: 0.158856
0.8455 --- loss: 1.024804, loss_ss: 0.936875, loss_d: 0.087930
0.8839 --- loss: 1.287258, loss_ss: 1.136540, loss_d: 0.150718
0.9224 --- loss: 1.330358, loss_ss: 1.101462, loss_d: 0.228896
0.9608 --- loss: 1.427577, loss_ss: 1.193519, loss_d: 0.234058
0.9992 --- loss: 1.315967, loss_ss: 1.202578, loss_d: 0.113389
Epoch finished! Loss: 1.2947058475934543
Starting epoch 3/10.
0.0000 --- loss: 1.000108, loss_ss: 0.773281, loss_d: 0.226827
0.0384 --- loss: 0.801339, loss_ss: 0.723618, loss_d: 0.077721
0.0769 --- loss: 1.084637, loss_ss: 0.733728, loss_d: 0.350909
0.1153 --- loss: 1.288089, loss_ss: 0.904782, loss_d: 0.383307
0.1537 --- loss: 1.118961, loss_ss: 0.948263, loss_d: 0.170698
0.1922 --- loss: 0.926271, loss_ss: 0.742660, loss_d: 0.183610
0.2306 --- loss: 1.165435, loss_ss: 0.674387, loss_d: 0.491048
0.2690 --- loss: 1.121204, loss_ss: 0.751316, loss_d: 0.369888
0.3075 --- loss: 1.128171, loss_ss: 0.793806, loss_d: 0.334365
0.3459 --- loss: 1.448837, loss_ss: 0.840407, loss_d: 0.608430
0.3843 --- loss: 1.467541, loss_ss: 0.805249, loss_d: 0.662293
0.4228 --- loss: 1.038257, loss_ss: 0.857907, loss_d: 0.180351
0.4612 --- loss: 1.166362, loss_ss: 0.975011, loss_d: 0.191350
0.4996 --- loss: 1.300351, loss_ss: 1.112079, loss_d: 0.188272
0.5380 --- loss: 1.123222, loss_ss: 0.983929, loss_d: 0.139293
0.5765 --- loss: 1.000484, loss_ss: 0.843932, loss_d: 0.156552
0.6149 --- loss: 0.969800, loss_ss: 0.850921, loss_d: 0.118879
0.6533 --- loss: 1.404868, loss_ss: 0.708198, loss_d: 0.696670
0.6918 --- loss: 0.932419, loss_ss: 0.836600, loss_d: 0.095819
0.7302 --- loss: 1.179089, loss_ss: 0.896120, loss_d: 0.282969
0.7686 --- loss: 0.927862, loss_ss: 0.859447, loss_d: 0.068414
0.8071 --- loss: 1.126407, loss_ss: 0.937531, loss_d: 0.188876
0.8455 --- loss: 1.179639, loss_ss: 0.702248, loss_d: 0.477391
0.8839 --- loss: 0.954465, loss_ss: 0.895409, loss_d: 0.059056
0.9224 --- loss: 0.792522, loss_ss: 0.566556, loss_d: 0.225966
0.9608 --- loss: 0.961825, loss_ss: 0.802872, loss_d: 0.158953
0.9992 --- loss: 1.192268, loss_ss: 1.095953, loss_d: 0.096316
Epoch finished! Loss: 1.1313255770848347
Starting epoch 4/10.
0.0000 --- loss: 0.936382, loss_ss: 0.822017, loss_d: 0.114365
0.0384 --- loss: 1.205314, loss_ss: 0.894134, loss_d: 0.311180
0.0769 --- loss: 1.241158, loss_ss: 0.954994, loss_d: 0.286164
0.1153 --- loss: 1.824781, loss_ss: 1.133884, loss_d: 0.690898
0.1537 --- loss: 1.811383, loss_ss: 1.128840, loss_d: 0.682543
0.1922 --- loss: 1.025199, loss_ss: 0.798803, loss_d: 0.226396
0.2306 --- loss: 1.189511, loss_ss: 0.863951, loss_d: 0.325560
0.2690 --- loss: 1.280278, loss_ss: 1.089233, loss_d: 0.191045
0.3075 --- loss: 1.298937, loss_ss: 1.034726, loss_d: 0.264211
0.3459 --- loss: 0.691980, loss_ss: 0.635571, loss_d: 0.056410
0.3843 --- loss: 0.905244, loss_ss: 0.756807, loss_d: 0.148437
0.4228 --- loss: 1.085889, loss_ss: 0.649771, loss_d: 0.436117
0.4612 --- loss: 0.843027, loss_ss: 0.777737, loss_d: 0.065289
0.4996 --- loss: 1.461516, loss_ss: 1.216914, loss_d: 0.244602
0.5380 --- loss: 1.026467, loss_ss: 0.760126, loss_d: 0.266340
0.5765 --- loss: 1.234928, loss_ss: 0.987045, loss_d: 0.247882
0.6149 --- loss: 1.453027, loss_ss: 0.791247, loss_d: 0.661780
0.6533 --- loss: 1.422915, loss_ss: 1.330427, loss_d: 0.092487
0.6918 --- loss: 1.216717, loss_ss: 1.066680, loss_d: 0.150037
0.7302 --- loss: 1.115384, loss_ss: 0.959778, loss_d: 0.155606
0.7686 --- loss: 1.350057, loss_ss: 0.929112, loss_d: 0.420945
0.8071 --- loss: 1.255910, loss_ss: 0.866973, loss_d: 0.388937
0.8455 --- loss: 1.119871, loss_ss: 0.790172, loss_d: 0.329700
0.8839 --- loss: 0.749819, loss_ss: 0.583544, loss_d: 0.166275
0.9224 --- loss: 0.808811, loss_ss: 0.741927, loss_d: 0.066884
0.9608 --- loss: 1.153480, loss_ss: 0.997083, loss_d: 0.156397
0.9992 --- loss: 1.292054, loss_ss: 1.264762, loss_d: 0.027292
Epoch finished! Loss: 1.0578131661965298
Starting epoch 5/10.
0.0000 --- loss: 0.624479, loss_ss: 0.531626, loss_d: 0.092853
0.0384 --- loss: 0.942631, loss_ss: 0.688600, loss_d: 0.254031
0.0769 --- loss: 0.806765, loss_ss: 0.599049, loss_d: 0.207716
0.1153 --- loss: 0.859760, loss_ss: 0.771513, loss_d: 0.088247
0.1537 --- loss: 1.139114, loss_ss: 0.892688, loss_d: 0.246426
0.1922 --- loss: 1.176709, loss_ss: 0.825653, loss_d: 0.351056
0.2306 --- loss: 1.647824, loss_ss: 0.855431, loss_d: 0.792392
0.2690 --- loss: 0.830699, loss_ss: 0.642983, loss_d: 0.187716
0.3075 --- loss: 1.514939, loss_ss: 0.826047, loss_d: 0.688892
0.3459 --- loss: 0.803271, loss_ss: 0.706561, loss_d: 0.096709
0.3843 --- loss: 1.140936, loss_ss: 0.963245, loss_d: 0.177691
0.4228 --- loss: 0.925610, loss_ss: 0.770807, loss_d: 0.154803
0.4612 --- loss: 0.771784, loss_ss: 0.628477, loss_d: 0.143307
0.4996 --- loss: 0.808966, loss_ss: 0.711467, loss_d: 0.097499
0.5380 --- loss: 0.797001, loss_ss: 0.740552, loss_d: 0.056448
0.5765 --- loss: 0.887383, loss_ss: 0.714103, loss_d: 0.173280
0.6149 --- loss: 1.075428, loss_ss: 0.682499, loss_d: 0.392930
0.6533 --- loss: 0.739395, loss_ss: 0.698019, loss_d: 0.041376
0.6918 --- loss: 1.259297, loss_ss: 1.127543, loss_d: 0.131754
0.7302 --- loss: 0.681684, loss_ss: 0.648988, loss_d: 0.032696
0.7686 --- loss: 0.763216, loss_ss: 0.688013, loss_d: 0.075203
0.8071 --- loss: 0.872302, loss_ss: 0.648058, loss_d: 0.224245
0.8455 --- loss: 0.895855, loss_ss: 0.874677, loss_d: 0.021178
0.8839 --- loss: 0.750779, loss_ss: 0.687445, loss_d: 0.063334
0.9224 --- loss: 0.685582, loss_ss: 0.653100, loss_d: 0.032482
0.9608 --- loss: 0.605487, loss_ss: 0.579537, loss_d: 0.025950
0.9992 --- loss: 1.420690, loss_ss: 1.269718, loss_d: 0.150972
Epoch finished! Loss: 0.9934017202028862
Starting epoch 6/10.
0.0000 --- loss: 1.082868, loss_ss: 0.885999, loss_d: 0.196869
0.0384 --- loss: 1.067095, loss_ss: 0.901748, loss_d: 0.165347
0.0769 --- loss: 1.066300, loss_ss: 0.953337, loss_d: 0.112963
0.1153 --- loss: 0.852855, loss_ss: 0.694648, loss_d: 0.158207
0.1537 --- loss: 0.765302, loss_ss: 0.735074, loss_d: 0.030228
0.1922 --- loss: 0.784988, loss_ss: 0.772977, loss_d: 0.012011
0.2306 --- loss: 1.042695, loss_ss: 0.754682, loss_d: 0.288013
0.2690 --- loss: 0.758874, loss_ss: 0.729982, loss_d: 0.028892
0.3075 --- loss: 0.829747, loss_ss: 0.797900, loss_d: 0.031847
0.3459 --- loss: 1.363707, loss_ss: 1.048846, loss_d: 0.314861
0.3843 --- loss: 0.731314, loss_ss: 0.643343, loss_d: 0.087972
0.4228 --- loss: 0.591287, loss_ss: 0.558612, loss_d: 0.032675
0.4612 --- loss: 0.929573, loss_ss: 0.703889, loss_d: 0.225684
0.4996 --- loss: 0.796983, loss_ss: 0.688398, loss_d: 0.108585
0.5380 --- loss: 1.034217, loss_ss: 0.983108, loss_d: 0.051109
0.5765 --- loss: 1.128552, loss_ss: 0.809402, loss_d: 0.319150
0.6149 --- loss: 1.264185, loss_ss: 0.852081, loss_d: 0.412104
0.6533 --- loss: 1.191115, loss_ss: 1.027096, loss_d: 0.164019
0.6918 --- loss: 1.030557, loss_ss: 0.809676, loss_d: 0.220880
0.7302 --- loss: 0.858902, loss_ss: 0.708223, loss_d: 0.150679
0.7686 --- loss: 1.164447, loss_ss: 1.082638, loss_d: 0.081808
0.8071 --- loss: 0.907998, loss_ss: 0.844245, loss_d: 0.063753
0.8455 --- loss: 0.941592, loss_ss: 0.741594, loss_d: 0.199997
0.8839 --- loss: 1.220870, loss_ss: 1.054509, loss_d: 0.166361
0.9224 --- loss: 0.876283, loss_ss: 0.754688, loss_d: 0.121595
0.9608 --- loss: 1.140317, loss_ss: 0.684531, loss_d: 0.455786
0.9992 --- loss: 0.828036, loss_ss: 0.809054, loss_d: 0.018982
Epoch finished! Loss: 0.9590707109524653
Starting epoch 7/10.
0.0000 --- loss: 0.777983, loss_ss: 0.753627, loss_d: 0.024356
0.0384 --- loss: 1.094716, loss_ss: 0.957080, loss_d: 0.137636
0.0769 --- loss: 0.931849, loss_ss: 0.913421, loss_d: 0.018428
0.1153 --- loss: 0.950423, loss_ss: 0.935342, loss_d: 0.015081
0.1537 --- loss: 0.724012, loss_ss: 0.684567, loss_d: 0.039445
0.1922 --- loss: 0.909790, loss_ss: 0.873325, loss_d: 0.036465
0.2306 --- loss: 0.687664, loss_ss: 0.666633, loss_d: 0.021031
0.2690 --- loss: 0.987233, loss_ss: 0.796859, loss_d: 0.190374
0.3075 --- loss: 1.206030, loss_ss: 1.123785, loss_d: 0.082245
0.3459 --- loss: 1.065123, loss_ss: 0.948636, loss_d: 0.116487
0.3843 --- loss: 0.921497, loss_ss: 0.854556, loss_d: 0.066942
0.4228 --- loss: 0.828496, loss_ss: 0.720331, loss_d: 0.108166
0.4612 --- loss: 0.788628, loss_ss: 0.737437, loss_d: 0.051192
0.4996 --- loss: 0.655300, loss_ss: 0.636851, loss_d: 0.018449
0.5380 --- loss: 0.790384, loss_ss: 0.703323, loss_d: 0.087061
0.5765 --- loss: 0.605041, loss_ss: 0.569696, loss_d: 0.035345
0.6149 --- loss: 1.123107, loss_ss: 0.501174, loss_d: 0.621933
0.6533 --- loss: 0.990270, loss_ss: 0.738311, loss_d: 0.251959
0.6918 --- loss: 0.780202, loss_ss: 0.773887, loss_d: 0.006314
0.7302 --- loss: 1.055489, loss_ss: 0.983850, loss_d: 0.071639
0.7686 --- loss: 0.574751, loss_ss: 0.535698, loss_d: 0.039054
0.8071 --- loss: 0.568032, loss_ss: 0.454235, loss_d: 0.113797
0.8455 --- loss: 0.660705, loss_ss: 0.575373, loss_d: 0.085332
0.8839 --- loss: 0.753801, loss_ss: 0.727789, loss_d: 0.026012
0.9224 --- loss: 1.120579, loss_ss: 1.093855, loss_d: 0.026723
0.9608 --- loss: 0.827124, loss_ss: 0.770761, loss_d: 0.056363
0.9992 --- loss: 2.047006, loss_ss: 1.996971, loss_d: 0.050035
Epoch finished! Loss: 0.9016609742091253
Starting epoch 8/10.
0.0000 --- loss: 0.918035, loss_ss: 0.846232, loss_d: 0.071802
0.0384 --- loss: 0.993544, loss_ss: 0.890203, loss_d: 0.103340
0.0769 --- loss: 0.585764, loss_ss: 0.457131, loss_d: 0.128633
0.1153 --- loss: 0.816737, loss_ss: 0.784277, loss_d: 0.032460
0.1537 --- loss: 0.720967, loss_ss: 0.672064, loss_d: 0.048903
0.1922 --- loss: 0.849515, loss_ss: 0.808278, loss_d: 0.041237
0.2306 --- loss: 0.694679, loss_ss: 0.666297, loss_d: 0.028382
0.2690 --- loss: 0.755801, loss_ss: 0.740397, loss_d: 0.015404
0.3075 --- loss: 0.885846, loss_ss: 0.867865, loss_d: 0.017981
0.3459 --- loss: 0.652121, loss_ss: 0.647744, loss_d: 0.004377
0.3843 --- loss: 1.084988, loss_ss: 0.836159, loss_d: 0.248829
0.4228 --- loss: 0.678164, loss_ss: 0.625513, loss_d: 0.052651
0.4612 --- loss: 0.766535, loss_ss: 0.740350, loss_d: 0.026185
0.4996 --- loss: 0.770378, loss_ss: 0.763864, loss_d: 0.006514
0.5380 --- loss: 0.561404, loss_ss: 0.534935, loss_d: 0.026469
0.5765 --- loss: 0.933508, loss_ss: 0.717142, loss_d: 0.216366
0.6149 --- loss: 0.888907, loss_ss: 0.839549, loss_d: 0.049358
0.6533 --- loss: 0.819006, loss_ss: 0.755643, loss_d: 0.063363
0.6918 --- loss: 1.133414, loss_ss: 0.853743, loss_d: 0.279671
0.7302 --- loss: 0.439122, loss_ss: 0.394910, loss_d: 0.044211
0.7686 --- loss: 0.842333, loss_ss: 0.793292, loss_d: 0.049041
0.8071 --- loss: 1.489588, loss_ss: 0.569491, loss_d: 0.920097
0.8455 --- loss: 0.750364, loss_ss: 0.668001, loss_d: 0.082363
0.8839 --- loss: 1.015369, loss_ss: 0.641153, loss_d: 0.374216
0.9224 --- loss: 1.169090, loss_ss: 0.807174, loss_d: 0.361916
0.9608 --- loss: 0.683472, loss_ss: 0.656171, loss_d: 0.027301
0.9992 --- loss: 0.823963, loss_ss: 0.728844, loss_d: 0.095120
Epoch finished! Loss: 0.8602641720038194
Starting epoch 9/10.
0.0000 --- loss: 0.548277, loss_ss: 0.533153, loss_d: 0.015123
0.0384 --- loss: 0.849907, loss_ss: 0.747909, loss_d: 0.101998
0.0769 --- loss: 1.052485, loss_ss: 1.040177, loss_d: 0.012308
0.1153 --- loss: 0.698256, loss_ss: 0.641096, loss_d: 0.057160
0.1537 --- loss: 0.839103, loss_ss: 0.791708, loss_d: 0.047394
0.1922 --- loss: 0.794127, loss_ss: 0.704014, loss_d: 0.090112
0.2306 --- loss: 0.693096, loss_ss: 0.625610, loss_d: 0.067486
0.2690 --- loss: 0.716777, loss_ss: 0.703661, loss_d: 0.013116
0.3075 --- loss: 0.794138, loss_ss: 0.790820, loss_d: 0.003318
0.3459 --- loss: 0.599277, loss_ss: 0.575223, loss_d: 0.024054
0.3843 --- loss: 0.708358, loss_ss: 0.672112, loss_d: 0.036245
0.4228 --- loss: 0.985421, loss_ss: 0.622373, loss_d: 0.363048
0.4612 --- loss: 1.188267, loss_ss: 0.741280, loss_d: 0.446987
0.4996 --- loss: 0.624674, loss_ss: 0.585090, loss_d: 0.039583
0.5380 --- loss: 0.900625, loss_ss: 0.698924, loss_d: 0.201702
0.5765 --- loss: 0.811504, loss_ss: 0.755175, loss_d: 0.056329
0.6149 --- loss: 0.861730, loss_ss: 0.812662, loss_d: 0.049068
0.6533 --- loss: 0.747398, loss_ss: 0.669051, loss_d: 0.078347
0.6918 --- loss: 0.865242, loss_ss: 0.857373, loss_d: 0.007869
0.7302 --- loss: 0.975991, loss_ss: 0.835838, loss_d: 0.140153
0.7686 --- loss: 0.903082, loss_ss: 0.681819, loss_d: 0.221264
0.8071 --- loss: 0.649291, loss_ss: 0.616287, loss_d: 0.033003
0.8455 --- loss: 0.978491, loss_ss: 0.659682, loss_d: 0.318809
0.8839 --- loss: 0.716882, loss_ss: 0.646012, loss_d: 0.070870
0.9224 --- loss: 0.886835, loss_ss: 0.881598, loss_d: 0.005237
0.9608 --- loss: 1.194587, loss_ss: 1.176029, loss_d: 0.018558
0.9992 --- loss: 0.923594, loss_ss: 0.914623, loss_d: 0.008971
Epoch finished! Loss: 0.8538430647208141
Starting epoch 10/10.
0.0000 --- loss: 0.667175, loss_ss: 0.647063, loss_d: 0.020112
0.0384 --- loss: 0.722076, loss_ss: 0.718932, loss_d: 0.003143
0.0769 --- loss: 1.291059, loss_ss: 0.911027, loss_d: 0.380032
0.1153 --- loss: 0.730787, loss_ss: 0.705579, loss_d: 0.025209
0.1537 --- loss: 0.913621, loss_ss: 0.646795, loss_d: 0.266826
0.1922 --- loss: 1.112727, loss_ss: 0.696496, loss_d: 0.416231
0.2306 --- loss: 0.655528, loss_ss: 0.633640, loss_d: 0.021889
0.2690 --- loss: 0.962895, loss_ss: 0.819418, loss_d: 0.143478
0.3075 --- loss: 0.674453, loss_ss: 0.643263, loss_d: 0.031190
0.3459 --- loss: 1.335527, loss_ss: 1.294987, loss_d: 0.040540
0.3843 --- loss: 0.647840, loss_ss: 0.591815, loss_d: 0.056025
0.4228 --- loss: 0.602860, loss_ss: 0.540655, loss_d: 0.062205
0.4612 --- loss: 0.520381, loss_ss: 0.451785, loss_d: 0.068596
0.4996 --- loss: 0.985662, loss_ss: 0.963261, loss_d: 0.022401
0.5380 --- loss: 0.793628, loss_ss: 0.779749, loss_d: 0.013878
0.5765 --- loss: 0.839919, loss_ss: 0.814912, loss_d: 0.025008
0.6149 --- loss: 0.574009, loss_ss: 0.546537, loss_d: 0.027473
0.6533 --- loss: 0.761316, loss_ss: 0.749285, loss_d: 0.012031
0.6918 --- loss: 0.528820, loss_ss: 0.525808, loss_d: 0.003012
0.7302 --- loss: 1.128161, loss_ss: 0.932024, loss_d: 0.196137
0.7686 --- loss: 0.621486, loss_ss: 0.618511, loss_d: 0.002975
0.8071 --- loss: 0.798838, loss_ss: 0.794853, loss_d: 0.003985
0.8455 --- loss: 1.049347, loss_ss: 1.047877, loss_d: 0.001470
0.8839 --- loss: 1.009508, loss_ss: 0.999380, loss_d: 0.010128
0.9224 --- loss: 0.810178, loss_ss: 0.796623, loss_d: 0.013555
0.9608 --- loss: 1.243287, loss_ss: 1.228392, loss_d: 0.014895
0.9992 --- loss: 0.458688, loss_ss: 0.457782, loss_d: 0.000906
Epoch finished! Loss: 0.8289199064557369
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6601851851851852
             precision    recall  f1-score   support

        0.0       0.90      0.59      0.71       251
        1.0       0.13      0.03      0.04       147
        2.0       0.77      0.81      0.79       305
        3.0       0.99      0.80      0.88       250
        4.0       0.32      0.91      0.47       127

avg / total       0.71      0.66      0.65      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.89  58.96   97.95  89.70     71.15
1  84.26   2.72   97.11  12.90      4.49
2  87.78  80.98   90.45  76.95     78.91
3  95.19  79.60   99.88  99.50     88.44
4  75.93  90.55   73.98  31.68     46.94
Total accuracy: 66.02%
Average sen: 62.56%
Average spec: 91.87%
Macro f1-score: 57.99%
Diagnosis acc on 15mins: 1.0
[1.         1.         0.99999988 0.99999309 0.99999368 0.99999177
 1.         1.         1.         0.99999988 1.         1.
 1.         1.         1.         0.99999857 0.9999609  0.99999714
 0.99998939 0.99999988 1.         0.99999952 0.99999917 0.99999714
 0.99980003 0.99999905 0.99998832 0.99999785 0.99999654 0.99999905
 0.99999964 0.99999774 0.99985325 0.99999976 0.99999332 1.        ]
pred: 0.9999873489141464, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.194914, loss_ss: 1.591773, loss_d: 0.603141
0.0384 --- loss: 2.372095, loss_ss: 1.717548, loss_d: 0.654546
0.0769 --- loss: 2.254247, loss_ss: 1.587776, loss_d: 0.666472
0.1153 --- loss: 2.444858, loss_ss: 1.814571, loss_d: 0.630287
0.1538 --- loss: 1.956825, loss_ss: 1.580660, loss_d: 0.376165
0.1922 --- loss: 2.240748, loss_ss: 1.610440, loss_d: 0.630308
0.2307 --- loss: 2.072488, loss_ss: 1.483131, loss_d: 0.589357
0.2691 --- loss: 2.098000, loss_ss: 1.523342, loss_d: 0.574658
0.3076 --- loss: 2.055340, loss_ss: 1.707675, loss_d: 0.347664
0.3460 --- loss: 2.011145, loss_ss: 1.640774, loss_d: 0.370370
0.3845 --- loss: 1.962368, loss_ss: 1.452430, loss_d: 0.509938
0.4229 --- loss: 1.862110, loss_ss: 1.403810, loss_d: 0.458300
0.4614 --- loss: 1.975575, loss_ss: 1.520483, loss_d: 0.455092
0.4998 --- loss: 1.784654, loss_ss: 1.370978, loss_d: 0.413676
0.5383 --- loss: 1.842058, loss_ss: 1.459904, loss_d: 0.382154
0.5767 --- loss: 1.852599, loss_ss: 1.299408, loss_d: 0.553191
0.6151 --- loss: 2.111669, loss_ss: 1.540949, loss_d: 0.570720
0.6536 --- loss: 1.978840, loss_ss: 1.399875, loss_d: 0.578965
0.6920 --- loss: 1.811995, loss_ss: 1.213352, loss_d: 0.598643
0.7305 --- loss: 2.098195, loss_ss: 1.362414, loss_d: 0.735781
0.7689 --- loss: 2.004371, loss_ss: 1.438830, loss_d: 0.565541
0.8074 --- loss: 2.019443, loss_ss: 1.374470, loss_d: 0.644973
0.8458 --- loss: 1.764327, loss_ss: 1.380947, loss_d: 0.383380
0.8843 --- loss: 1.778621, loss_ss: 1.257719, loss_d: 0.520902
0.9227 --- loss: 1.599229, loss_ss: 1.227497, loss_d: 0.371731
0.9612 --- loss: 1.676750, loss_ss: 1.216301, loss_d: 0.460449
0.9996 --- loss: 1.978951, loss_ss: 1.858841, loss_d: 0.120111
Epoch finished! Loss: 1.996796235212913
Starting epoch 2/10.
0.0000 --- loss: 1.456864, loss_ss: 1.138001, loss_d: 0.318863
0.0384 --- loss: 1.610993, loss_ss: 1.179654, loss_d: 0.431339
0.0769 --- loss: 1.603231, loss_ss: 1.183537, loss_d: 0.419694
0.1153 --- loss: 1.912326, loss_ss: 1.272882, loss_d: 0.639443
0.1538 --- loss: 1.567979, loss_ss: 1.335735, loss_d: 0.232244
0.1922 --- loss: 1.272057, loss_ss: 0.971794, loss_d: 0.300264
0.2307 --- loss: 1.224132, loss_ss: 1.053839, loss_d: 0.170294
0.2691 --- loss: 2.087536, loss_ss: 1.393282, loss_d: 0.694254
0.3076 --- loss: 1.677098, loss_ss: 1.288090, loss_d: 0.389008
0.3460 --- loss: 1.155970, loss_ss: 0.875180, loss_d: 0.280789
0.3845 --- loss: 1.493564, loss_ss: 1.175189, loss_d: 0.318375
0.4229 --- loss: 1.217735, loss_ss: 1.088399, loss_d: 0.129335
0.4614 --- loss: 1.080795, loss_ss: 0.908671, loss_d: 0.172124
0.4998 --- loss: 1.404003, loss_ss: 1.099658, loss_d: 0.304345
0.5383 --- loss: 1.240117, loss_ss: 1.068701, loss_d: 0.171417
0.5767 --- loss: 1.656174, loss_ss: 0.921052, loss_d: 0.735122
0.6151 --- loss: 1.525053, loss_ss: 1.211829, loss_d: 0.313224
0.6536 --- loss: 1.097940, loss_ss: 0.970364, loss_d: 0.127576
0.6920 --- loss: 1.736339, loss_ss: 1.418901, loss_d: 0.317438
0.7305 --- loss: 1.587172, loss_ss: 1.284646, loss_d: 0.302526
0.7689 --- loss: 1.640736, loss_ss: 1.142977, loss_d: 0.497759
0.8074 --- loss: 1.137119, loss_ss: 1.041621, loss_d: 0.095498
0.8458 --- loss: 2.356898, loss_ss: 1.222836, loss_d: 1.134062
0.8843 --- loss: 1.390621, loss_ss: 1.066494, loss_d: 0.324126
0.9227 --- loss: 1.497540, loss_ss: 0.807331, loss_d: 0.690208
0.9612 --- loss: 1.549917, loss_ss: 1.254316, loss_d: 0.295601
0.9996 --- loss: 1.154091, loss_ss: 1.071421, loss_d: 0.082670
Epoch finished! Loss: 1.415555432668099
Starting epoch 3/10.
0.0000 --- loss: 1.258327, loss_ss: 0.983251, loss_d: 0.275076
0.0384 --- loss: 1.097590, loss_ss: 1.025213, loss_d: 0.072378
0.0769 --- loss: 1.308898, loss_ss: 1.039190, loss_d: 0.269708
0.1153 --- loss: 1.274177, loss_ss: 1.058840, loss_d: 0.215337
0.1538 --- loss: 1.494305, loss_ss: 1.331522, loss_d: 0.162783
0.1922 --- loss: 1.120986, loss_ss: 0.820251, loss_d: 0.300736
0.2307 --- loss: 1.094929, loss_ss: 0.988842, loss_d: 0.106087
0.2691 --- loss: 1.032076, loss_ss: 0.852057, loss_d: 0.180018
0.3076 --- loss: 1.015662, loss_ss: 0.967691, loss_d: 0.047972
0.3460 --- loss: 1.133893, loss_ss: 0.829209, loss_d: 0.304684
0.3845 --- loss: 1.275095, loss_ss: 1.132593, loss_d: 0.142503
0.4229 --- loss: 1.569534, loss_ss: 0.834580, loss_d: 0.734953
0.4614 --- loss: 1.242562, loss_ss: 1.012588, loss_d: 0.229974
0.4998 --- loss: 1.197785, loss_ss: 0.969304, loss_d: 0.228481
0.5383 --- loss: 1.253507, loss_ss: 1.115037, loss_d: 0.138470
0.5767 --- loss: 1.024817, loss_ss: 0.995253, loss_d: 0.029564
0.6151 --- loss: 1.846589, loss_ss: 0.981581, loss_d: 0.865008
0.6536 --- loss: 1.024331, loss_ss: 0.950449, loss_d: 0.073882
0.6920 --- loss: 1.456339, loss_ss: 1.062888, loss_d: 0.393451
0.7305 --- loss: 1.101911, loss_ss: 0.716443, loss_d: 0.385468
0.7689 --- loss: 1.569095, loss_ss: 1.027567, loss_d: 0.541527
0.8074 --- loss: 1.172167, loss_ss: 0.942206, loss_d: 0.229961
0.8458 --- loss: 1.155192, loss_ss: 1.014716, loss_d: 0.140476
0.8843 --- loss: 1.136821, loss_ss: 0.984730, loss_d: 0.152091
0.9227 --- loss: 1.105721, loss_ss: 0.981459, loss_d: 0.124262
0.9612 --- loss: 1.318395, loss_ss: 0.993626, loss_d: 0.324769
0.9996 --- loss: 5.537257, loss_ss: 2.544788, loss_d: 2.992469
Epoch finished! Loss: 1.1926990678677192
Starting epoch 4/10.
0.0000 --- loss: 1.009624, loss_ss: 0.936750, loss_d: 0.072874
0.0384 --- loss: 1.588434, loss_ss: 0.946108, loss_d: 0.642326
0.0769 --- loss: 0.985295, loss_ss: 0.875838, loss_d: 0.109456
0.1153 --- loss: 1.190338, loss_ss: 1.066516, loss_d: 0.123822
0.1538 --- loss: 1.210086, loss_ss: 0.880836, loss_d: 0.329251
0.1922 --- loss: 1.268190, loss_ss: 0.870481, loss_d: 0.397709
0.2307 --- loss: 1.080651, loss_ss: 0.881418, loss_d: 0.199233
0.2691 --- loss: 1.060103, loss_ss: 0.849936, loss_d: 0.210167
0.3076 --- loss: 1.435233, loss_ss: 0.831609, loss_d: 0.603624
0.3460 --- loss: 0.995833, loss_ss: 0.836434, loss_d: 0.159399
0.3845 --- loss: 0.755438, loss_ss: 0.662593, loss_d: 0.092844
0.4229 --- loss: 0.903737, loss_ss: 0.725942, loss_d: 0.177795
0.4614 --- loss: 1.223842, loss_ss: 0.633260, loss_d: 0.590582
0.4998 --- loss: 0.992041, loss_ss: 0.709261, loss_d: 0.282780
0.5383 --- loss: 1.433772, loss_ss: 0.924075, loss_d: 0.509697
0.5767 --- loss: 0.990655, loss_ss: 0.627462, loss_d: 0.363193
0.6151 --- loss: 1.156000, loss_ss: 0.703400, loss_d: 0.452600
0.6536 --- loss: 0.963597, loss_ss: 0.894676, loss_d: 0.068921
0.6920 --- loss: 0.853907, loss_ss: 0.800228, loss_d: 0.053679
0.7305 --- loss: 0.854163, loss_ss: 0.763294, loss_d: 0.090869
0.7689 --- loss: 0.672909, loss_ss: 0.579320, loss_d: 0.093588
0.8074 --- loss: 0.985715, loss_ss: 0.767839, loss_d: 0.217876
0.8458 --- loss: 1.541769, loss_ss: 0.738622, loss_d: 0.803147
0.8843 --- loss: 1.127085, loss_ss: 0.950025, loss_d: 0.177060
0.9227 --- loss: 0.940136, loss_ss: 0.703210, loss_d: 0.236926
0.9612 --- loss: 1.021862, loss_ss: 0.655368, loss_d: 0.366494
0.9996 --- loss: 1.200429, loss_ss: 1.128943, loss_d: 0.071486
Epoch finished! Loss: 1.096499511370292
Starting epoch 5/10.
0.0000 --- loss: 1.430246, loss_ss: 0.866039, loss_d: 0.564207
0.0384 --- loss: 0.918617, loss_ss: 0.833982, loss_d: 0.084635
0.0769 --- loss: 1.084462, loss_ss: 0.834834, loss_d: 0.249628
0.1153 --- loss: 0.964132, loss_ss: 0.849925, loss_d: 0.114207
0.1538 --- loss: 1.240202, loss_ss: 0.747859, loss_d: 0.492343
0.1922 --- loss: 1.034301, loss_ss: 0.703023, loss_d: 0.331278
0.2307 --- loss: 0.939631, loss_ss: 0.862223, loss_d: 0.077408
0.2691 --- loss: 1.296785, loss_ss: 0.759444, loss_d: 0.537341
0.3076 --- loss: 0.924946, loss_ss: 0.641536, loss_d: 0.283410
0.3460 --- loss: 0.839624, loss_ss: 0.756640, loss_d: 0.082984
0.3845 --- loss: 1.135085, loss_ss: 1.088169, loss_d: 0.046917
0.4229 --- loss: 0.862655, loss_ss: 0.797362, loss_d: 0.065293
0.4614 --- loss: 0.804227, loss_ss: 0.753234, loss_d: 0.050993
0.4998 --- loss: 0.947462, loss_ss: 0.912711, loss_d: 0.034751
0.5383 --- loss: 1.269589, loss_ss: 1.039967, loss_d: 0.229622
0.5767 --- loss: 0.896897, loss_ss: 0.874829, loss_d: 0.022068
0.6151 --- loss: 1.018438, loss_ss: 0.973853, loss_d: 0.044584
0.6536 --- loss: 1.209892, loss_ss: 0.721416, loss_d: 0.488476
0.6920 --- loss: 1.097569, loss_ss: 0.900437, loss_d: 0.197132
0.7305 --- loss: 1.501548, loss_ss: 1.244582, loss_d: 0.256967
0.7689 --- loss: 1.200851, loss_ss: 0.974383, loss_d: 0.226468
0.8074 --- loss: 1.223777, loss_ss: 0.937964, loss_d: 0.285813
0.8458 --- loss: 0.877652, loss_ss: 0.802566, loss_d: 0.075087
0.8843 --- loss: 1.114808, loss_ss: 0.843436, loss_d: 0.271372
0.9227 --- loss: 1.370527, loss_ss: 0.740612, loss_d: 0.629916
0.9612 --- loss: 0.741367, loss_ss: 0.694011, loss_d: 0.047356
0.9996 --- loss: 1.363081, loss_ss: 1.362310, loss_d: 0.000771
Epoch finished! Loss: 0.9928893866447303
Starting epoch 6/10.
0.0000 --- loss: 1.072071, loss_ss: 0.721875, loss_d: 0.350196
0.0384 --- loss: 0.663005, loss_ss: 0.644927, loss_d: 0.018078
0.0769 --- loss: 0.993909, loss_ss: 0.953725, loss_d: 0.040184
0.1153 --- loss: 0.719524, loss_ss: 0.692052, loss_d: 0.027472
0.1538 --- loss: 0.949109, loss_ss: 0.843562, loss_d: 0.105547
0.1922 --- loss: 0.862716, loss_ss: 0.765094, loss_d: 0.097622
0.2307 --- loss: 1.181558, loss_ss: 0.938753, loss_d: 0.242805
0.2691 --- loss: 1.096413, loss_ss: 0.922572, loss_d: 0.173841
0.3076 --- loss: 0.586385, loss_ss: 0.554204, loss_d: 0.032181
0.3460 --- loss: 1.039465, loss_ss: 0.993988, loss_d: 0.045477
0.3845 --- loss: 0.832522, loss_ss: 0.704914, loss_d: 0.127609
0.4229 --- loss: 1.070532, loss_ss: 0.979455, loss_d: 0.091076
0.4614 --- loss: 1.033518, loss_ss: 0.830903, loss_d: 0.202616
0.4998 --- loss: 1.064169, loss_ss: 0.933554, loss_d: 0.130615
0.5383 --- loss: 0.720634, loss_ss: 0.633852, loss_d: 0.086782
0.5767 --- loss: 0.777632, loss_ss: 0.703877, loss_d: 0.073755
0.6151 --- loss: 1.136667, loss_ss: 1.026317, loss_d: 0.110349
0.6536 --- loss: 0.777982, loss_ss: 0.761221, loss_d: 0.016761
0.6920 --- loss: 0.864256, loss_ss: 0.791105, loss_d: 0.073150
0.7305 --- loss: 0.869376, loss_ss: 0.848632, loss_d: 0.020745
0.7689 --- loss: 1.744266, loss_ss: 1.563323, loss_d: 0.180943
0.8074 --- loss: 0.749621, loss_ss: 0.714988, loss_d: 0.034633
0.8458 --- loss: 0.956949, loss_ss: 0.922359, loss_d: 0.034590
0.8843 --- loss: 0.720379, loss_ss: 0.581921, loss_d: 0.138457
0.9227 --- loss: 1.018017, loss_ss: 0.859851, loss_d: 0.158166
0.9612 --- loss: 0.762254, loss_ss: 0.740408, loss_d: 0.021846
0.9996 --- loss: 1.713556, loss_ss: 1.678275, loss_d: 0.035281
Epoch finished! Loss: 0.9706765083166269
Starting epoch 7/10.
0.0000 --- loss: 0.657497, loss_ss: 0.605664, loss_d: 0.051832
0.0384 --- loss: 0.716396, loss_ss: 0.659998, loss_d: 0.056399
0.0769 --- loss: 0.714223, loss_ss: 0.705389, loss_d: 0.008834
0.1153 --- loss: 1.259713, loss_ss: 1.159057, loss_d: 0.100656
0.1538 --- loss: 0.728551, loss_ss: 0.679339, loss_d: 0.049212
0.1922 --- loss: 0.875757, loss_ss: 0.568419, loss_d: 0.307338
0.2307 --- loss: 0.707201, loss_ss: 0.679639, loss_d: 0.027561
0.2691 --- loss: 0.799339, loss_ss: 0.750282, loss_d: 0.049057
0.3076 --- loss: 1.477915, loss_ss: 0.639929, loss_d: 0.837987
0.3460 --- loss: 0.650915, loss_ss: 0.614478, loss_d: 0.036436
0.3845 --- loss: 1.370622, loss_ss: 1.135552, loss_d: 0.235070
0.4229 --- loss: 0.738916, loss_ss: 0.668935, loss_d: 0.069980
0.4614 --- loss: 0.746181, loss_ss: 0.733180, loss_d: 0.013001
0.4998 --- loss: 0.723154, loss_ss: 0.700948, loss_d: 0.022206
0.5383 --- loss: 0.955354, loss_ss: 0.835179, loss_d: 0.120175
0.5767 --- loss: 0.916006, loss_ss: 0.898552, loss_d: 0.017454
0.6151 --- loss: 1.438978, loss_ss: 1.404071, loss_d: 0.034907
0.6536 --- loss: 0.542712, loss_ss: 0.516689, loss_d: 0.026023
0.6920 --- loss: 0.918291, loss_ss: 0.907708, loss_d: 0.010583
0.7305 --- loss: 0.761522, loss_ss: 0.727187, loss_d: 0.034336
0.7689 --- loss: 0.836167, loss_ss: 0.796046, loss_d: 0.040121
0.8074 --- loss: 0.700275, loss_ss: 0.555824, loss_d: 0.144452
0.8458 --- loss: 0.914928, loss_ss: 0.810139, loss_d: 0.104789
0.8843 --- loss: 0.745314, loss_ss: 0.689653, loss_d: 0.055661
0.9227 --- loss: 0.704448, loss_ss: 0.671637, loss_d: 0.032811
0.9612 --- loss: 1.248197, loss_ss: 1.039664, loss_d: 0.208533
0.9996 --- loss: 1.267428, loss_ss: 1.244861, loss_d: 0.022568
Epoch finished! Loss: 0.9207069474917192
Starting epoch 8/10.
0.0000 --- loss: 0.682176, loss_ss: 0.594598, loss_d: 0.087579
0.0384 --- loss: 1.077797, loss_ss: 1.051966, loss_d: 0.025831
0.0769 --- loss: 0.568806, loss_ss: 0.507737, loss_d: 0.061069
0.1153 --- loss: 1.097425, loss_ss: 1.038772, loss_d: 0.058653
0.1538 --- loss: 0.631236, loss_ss: 0.598100, loss_d: 0.033136
0.1922 --- loss: 0.863463, loss_ss: 0.848705, loss_d: 0.014759
0.2307 --- loss: 0.889727, loss_ss: 0.851479, loss_d: 0.038247
0.2691 --- loss: 0.626273, loss_ss: 0.603443, loss_d: 0.022830
0.3076 --- loss: 0.768250, loss_ss: 0.759979, loss_d: 0.008271
0.3460 --- loss: 1.341466, loss_ss: 1.212619, loss_d: 0.128847
0.3845 --- loss: 0.987971, loss_ss: 0.534345, loss_d: 0.453626
0.4229 --- loss: 0.904736, loss_ss: 0.802347, loss_d: 0.102389
0.4614 --- loss: 1.004033, loss_ss: 0.705536, loss_d: 0.298497
0.4998 --- loss: 1.056391, loss_ss: 0.930513, loss_d: 0.125877
0.5383 --- loss: 0.925365, loss_ss: 0.873207, loss_d: 0.052158
0.5767 --- loss: 0.743991, loss_ss: 0.717944, loss_d: 0.026047
0.6151 --- loss: 0.826888, loss_ss: 0.667247, loss_d: 0.159641
0.6536 --- loss: 0.770600, loss_ss: 0.718868, loss_d: 0.051732
0.6920 --- loss: 0.578912, loss_ss: 0.537869, loss_d: 0.041042
0.7305 --- loss: 1.304218, loss_ss: 0.687841, loss_d: 0.616377
0.7689 --- loss: 1.000183, loss_ss: 0.877459, loss_d: 0.122725
0.8074 --- loss: 1.002290, loss_ss: 0.795225, loss_d: 0.207065
0.8458 --- loss: 1.308017, loss_ss: 1.067668, loss_d: 0.240350
0.8843 --- loss: 0.567350, loss_ss: 0.488015, loss_d: 0.079336
0.9227 --- loss: 0.818710, loss_ss: 0.803903, loss_d: 0.014807
0.9612 --- loss: 0.661095, loss_ss: 0.651856, loss_d: 0.009239
0.9996 --- loss: 11.328186, loss_ss: 3.487277, loss_d: 7.840909
Epoch finished! Loss: 0.9283106535673141
Starting epoch 9/10.
0.0000 --- loss: 1.011525, loss_ss: 0.975839, loss_d: 0.035686
0.0384 --- loss: 0.754934, loss_ss: 0.709111, loss_d: 0.045823
0.0769 --- loss: 1.172558, loss_ss: 0.974498, loss_d: 0.198060
0.1153 --- loss: 1.266355, loss_ss: 1.157354, loss_d: 0.109001
0.1538 --- loss: 0.695893, loss_ss: 0.684384, loss_d: 0.011509
0.1922 --- loss: 0.711735, loss_ss: 0.670589, loss_d: 0.041146
0.2307 --- loss: 0.655365, loss_ss: 0.617073, loss_d: 0.038292
0.2691 --- loss: 0.821578, loss_ss: 0.817691, loss_d: 0.003888
0.3076 --- loss: 0.716706, loss_ss: 0.686031, loss_d: 0.030674
0.3460 --- loss: 0.580763, loss_ss: 0.572834, loss_d: 0.007929
0.3845 --- loss: 1.408177, loss_ss: 0.703685, loss_d: 0.704492
0.4229 --- loss: 0.972746, loss_ss: 0.963458, loss_d: 0.009288
0.4614 --- loss: 0.849133, loss_ss: 0.727149, loss_d: 0.121983
0.4998 --- loss: 1.065196, loss_ss: 0.709639, loss_d: 0.355556
0.5383 --- loss: 0.799745, loss_ss: 0.716841, loss_d: 0.082904
0.5767 --- loss: 0.788111, loss_ss: 0.754528, loss_d: 0.033583
0.6151 --- loss: 0.554121, loss_ss: 0.549844, loss_d: 0.004277
0.6536 --- loss: 0.789208, loss_ss: 0.734204, loss_d: 0.055004
0.6920 --- loss: 1.041014, loss_ss: 1.010839, loss_d: 0.030175
0.7305 --- loss: 1.069267, loss_ss: 0.774517, loss_d: 0.294750
0.7689 --- loss: 0.566896, loss_ss: 0.498356, loss_d: 0.068540
0.8074 --- loss: 1.054716, loss_ss: 0.618419, loss_d: 0.436297
0.8458 --- loss: 0.963600, loss_ss: 0.701916, loss_d: 0.261684
0.8843 --- loss: 0.686909, loss_ss: 0.672007, loss_d: 0.014902
0.9227 --- loss: 0.946318, loss_ss: 0.890573, loss_d: 0.055745
0.9612 --- loss: 0.794227, loss_ss: 0.548495, loss_d: 0.245732
0.9996 --- loss: 1.319338, loss_ss: 1.298382, loss_d: 0.020956
Epoch finished! Loss: 0.8829202289764698
Starting epoch 10/10.
0.0000 --- loss: 0.718504, loss_ss: 0.710355, loss_d: 0.008149
0.0384 --- loss: 0.930799, loss_ss: 0.925883, loss_d: 0.004916
0.0769 --- loss: 0.696137, loss_ss: 0.685338, loss_d: 0.010799
0.1153 --- loss: 0.889103, loss_ss: 0.871481, loss_d: 0.017622
0.1538 --- loss: 0.620247, loss_ss: 0.596403, loss_d: 0.023844
0.1922 --- loss: 1.016285, loss_ss: 0.693912, loss_d: 0.322373
0.2307 --- loss: 0.749150, loss_ss: 0.740645, loss_d: 0.008505
0.2691 --- loss: 0.697646, loss_ss: 0.667203, loss_d: 0.030443
0.3076 --- loss: 0.828236, loss_ss: 0.816406, loss_d: 0.011830
0.3460 --- loss: 0.748050, loss_ss: 0.729817, loss_d: 0.018233
0.3845 --- loss: 0.662632, loss_ss: 0.632027, loss_d: 0.030605
0.4229 --- loss: 0.624630, loss_ss: 0.613752, loss_d: 0.010878
0.4614 --- loss: 1.152835, loss_ss: 0.826151, loss_d: 0.326683
0.4998 --- loss: 0.991429, loss_ss: 0.825866, loss_d: 0.165563
0.5383 --- loss: 0.864265, loss_ss: 0.731228, loss_d: 0.133037
0.5767 --- loss: 0.751541, loss_ss: 0.744595, loss_d: 0.006946
0.6151 --- loss: 0.994779, loss_ss: 0.844333, loss_d: 0.150445
0.6536 --- loss: 1.106202, loss_ss: 1.097569, loss_d: 0.008633
0.6920 --- loss: 0.997038, loss_ss: 0.976807, loss_d: 0.020231
0.7305 --- loss: 0.738077, loss_ss: 0.728723, loss_d: 0.009355
0.7689 --- loss: 0.861832, loss_ss: 0.662039, loss_d: 0.199792
0.8074 --- loss: 0.707824, loss_ss: 0.691168, loss_d: 0.016656
0.8458 --- loss: 0.907338, loss_ss: 0.892986, loss_d: 0.014352
0.8843 --- loss: 0.640531, loss_ss: 0.634593, loss_d: 0.005939
0.9227 --- loss: 0.833525, loss_ss: 0.466192, loss_d: 0.367333
0.9612 --- loss: 0.757013, loss_ss: 0.647810, loss_d: 0.109202
0.9996 --- loss: 1.474939, loss_ss: 1.472223, loss_d: 0.002716
Epoch finished! Loss: 0.839791655425842
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6099099099099099
             precision    recall  f1-score   support

        0.0       0.94      0.32      0.48       231
        1.0       0.14      0.20      0.16        92
        2.0       0.90      0.61      0.73       472
        3.0       1.00      0.86      0.92        99
        4.0       0.42      0.97      0.59       216

avg / total       0.76      0.61      0.62      1110
 


====== chp054-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.50  32.47   99.43   93.75     48.23
1  83.15  19.57   88.90   13.74     16.14
2  80.72  61.44   94.98   90.06     73.05
3  98.74  85.86  100.00  100.00     92.39
4  73.87  96.76   68.34   42.48     59.04
Total accuracy: 60.99%
Average sen: 59.22%
Average spec: 90.33%
Macro f1-score: 57.77%
Diagnosis acc on 15mins: 1.0
[0.99999845 1.         1.         0.9999752  0.99999714 0.9999994
 0.9999764  0.99995923 0.99990726 0.99969304 0.99996793 0.99998546
 0.9999665  0.99998975 0.99999821 0.99995852 0.99998534 0.99999988
 0.99997771 0.9999969  0.99999976 0.99999988 0.99999475 0.9999584
 0.99999392 0.99940085 0.99991858 0.99987459 0.9999994  0.99999821
 0.99998546 0.99999988 0.99999988 0.99999976 0.9999975  0.9999994
 1.        ]
pred: 0.9999581768706038, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.437557, loss_ss: 1.655890, loss_d: 0.781667
0.0384 --- loss: 2.271256, loss_ss: 1.650586, loss_d: 0.620670
0.0769 --- loss: 2.562382, loss_ss: 1.543658, loss_d: 1.018724
0.1153 --- loss: 2.158215, loss_ss: 1.451175, loss_d: 0.707040
0.1538 --- loss: 1.950204, loss_ss: 1.329143, loss_d: 0.621062
0.1922 --- loss: 1.893907, loss_ss: 1.448887, loss_d: 0.445020
0.2307 --- loss: 2.320417, loss_ss: 1.253901, loss_d: 1.066515
0.2691 --- loss: 2.190358, loss_ss: 1.526541, loss_d: 0.663817
0.3076 --- loss: 1.905956, loss_ss: 1.422624, loss_d: 0.483332
0.3460 --- loss: 1.824401, loss_ss: 1.476259, loss_d: 0.348142
0.3845 --- loss: 1.767816, loss_ss: 1.209566, loss_d: 0.558249
0.4229 --- loss: 1.935398, loss_ss: 1.348877, loss_d: 0.586522
0.4614 --- loss: 1.865244, loss_ss: 1.259980, loss_d: 0.605264
0.4998 --- loss: 1.671976, loss_ss: 1.354815, loss_d: 0.317161
0.5383 --- loss: 1.880445, loss_ss: 1.416598, loss_d: 0.463847
0.5767 --- loss: 1.859195, loss_ss: 1.141521, loss_d: 0.717674
0.6151 --- loss: 2.087325, loss_ss: 1.277086, loss_d: 0.810239
0.6536 --- loss: 1.779440, loss_ss: 1.376373, loss_d: 0.403067
0.6920 --- loss: 1.798087, loss_ss: 1.014418, loss_d: 0.783670
0.7305 --- loss: 1.455001, loss_ss: 1.115269, loss_d: 0.339732
0.7689 --- loss: 1.562295, loss_ss: 1.084326, loss_d: 0.477969
0.8074 --- loss: 1.488864, loss_ss: 1.113387, loss_d: 0.375478
0.8458 --- loss: 1.362872, loss_ss: 1.072413, loss_d: 0.290460
0.8843 --- loss: 1.586252, loss_ss: 1.174002, loss_d: 0.412250
0.9227 --- loss: 1.513644, loss_ss: 1.099027, loss_d: 0.414617
0.9612 --- loss: 1.556602, loss_ss: 1.084992, loss_d: 0.471611
0.9996 --- loss: 1.099654, loss_ss: 0.991537, loss_d: 0.108118
Epoch finished! Loss: 1.7971353805982149
Starting epoch 2/10.
0.0000 --- loss: 1.377338, loss_ss: 0.949676, loss_d: 0.427662
0.0384 --- loss: 1.452967, loss_ss: 0.972158, loss_d: 0.480810
0.0769 --- loss: 1.487701, loss_ss: 1.111051, loss_d: 0.376649
0.1153 --- loss: 1.632850, loss_ss: 1.295230, loss_d: 0.337620
0.1538 --- loss: 1.604325, loss_ss: 1.092523, loss_d: 0.511802
0.1922 --- loss: 1.345036, loss_ss: 0.979722, loss_d: 0.365313
0.2307 --- loss: 1.392493, loss_ss: 1.234337, loss_d: 0.158155
0.2691 --- loss: 1.663156, loss_ss: 1.000305, loss_d: 0.662852
0.3076 --- loss: 1.498352, loss_ss: 1.054422, loss_d: 0.443930
0.3460 --- loss: 1.281007, loss_ss: 0.876663, loss_d: 0.404344
0.3845 --- loss: 1.336437, loss_ss: 0.886991, loss_d: 0.449446
0.4229 --- loss: 1.076279, loss_ss: 1.026462, loss_d: 0.049817
0.4614 --- loss: 1.151772, loss_ss: 1.009078, loss_d: 0.142694
0.4998 --- loss: 1.051647, loss_ss: 0.944139, loss_d: 0.107508
0.5383 --- loss: 1.605026, loss_ss: 0.890498, loss_d: 0.714528
0.5767 --- loss: 0.950785, loss_ss: 0.821272, loss_d: 0.129513
0.6151 --- loss: 1.399862, loss_ss: 0.978489, loss_d: 0.421373
0.6536 --- loss: 0.893002, loss_ss: 0.763768, loss_d: 0.129234
0.6920 --- loss: 1.354825, loss_ss: 1.225705, loss_d: 0.129120
0.7305 --- loss: 1.171842, loss_ss: 1.049731, loss_d: 0.122112
0.7689 --- loss: 1.283566, loss_ss: 1.169714, loss_d: 0.113851
0.8074 --- loss: 0.947375, loss_ss: 0.757134, loss_d: 0.190240
0.8458 --- loss: 1.029202, loss_ss: 0.755948, loss_d: 0.273254
0.8843 --- loss: 1.184896, loss_ss: 0.903826, loss_d: 0.281070
0.9227 --- loss: 0.918424, loss_ss: 0.830438, loss_d: 0.087987
0.9612 --- loss: 1.340895, loss_ss: 1.070412, loss_d: 0.270483
0.9996 --- loss: 1.967826, loss_ss: 1.924251, loss_d: 0.043575
Epoch finished! Loss: 1.3326856532922158
Starting epoch 3/10.
0.0000 --- loss: 1.279804, loss_ss: 1.141557, loss_d: 0.138247
0.0384 --- loss: 1.100122, loss_ss: 0.970617, loss_d: 0.129506
0.0769 --- loss: 1.294015, loss_ss: 1.069623, loss_d: 0.224392
0.1153 --- loss: 2.244156, loss_ss: 0.919066, loss_d: 1.325091
0.1538 --- loss: 1.202531, loss_ss: 0.872396, loss_d: 0.330135
0.1922 --- loss: 1.007523, loss_ss: 0.848396, loss_d: 0.159127
0.2307 --- loss: 1.582524, loss_ss: 0.782862, loss_d: 0.799662
0.2691 --- loss: 0.877598, loss_ss: 0.751394, loss_d: 0.126204
0.3076 --- loss: 0.980139, loss_ss: 0.878519, loss_d: 0.101620
0.3460 --- loss: 0.923430, loss_ss: 0.765772, loss_d: 0.157658
0.3845 --- loss: 1.309485, loss_ss: 1.069502, loss_d: 0.239983
0.4229 --- loss: 1.228354, loss_ss: 0.698958, loss_d: 0.529395
0.4614 --- loss: 1.231098, loss_ss: 1.053839, loss_d: 0.177259
0.4998 --- loss: 1.006260, loss_ss: 0.803725, loss_d: 0.202535
0.5383 --- loss: 1.235486, loss_ss: 0.642746, loss_d: 0.592740
0.5767 --- loss: 1.078352, loss_ss: 0.836478, loss_d: 0.241874
0.6151 --- loss: 1.077949, loss_ss: 0.763781, loss_d: 0.314167
0.6536 --- loss: 1.350733, loss_ss: 0.972566, loss_d: 0.378167
0.6920 --- loss: 1.230951, loss_ss: 0.973891, loss_d: 0.257060
0.7305 --- loss: 1.054453, loss_ss: 0.951431, loss_d: 0.103022
0.7689 --- loss: 1.031169, loss_ss: 0.985833, loss_d: 0.045337
0.8074 --- loss: 0.799925, loss_ss: 0.701554, loss_d: 0.098372
0.8458 --- loss: 1.112255, loss_ss: 0.901764, loss_d: 0.210491
0.8843 --- loss: 1.036439, loss_ss: 0.929758, loss_d: 0.106681
0.9227 --- loss: 0.810535, loss_ss: 0.757230, loss_d: 0.053305
0.9612 --- loss: 0.747363, loss_ss: 0.671919, loss_d: 0.075444
0.9996 --- loss: 4.988579, loss_ss: 0.995002, loss_d: 3.993577
Epoch finished! Loss: 1.1551364953701313
Starting epoch 4/10.
0.0000 --- loss: 1.307631, loss_ss: 0.689722, loss_d: 0.617909
0.0384 --- loss: 0.853725, loss_ss: 0.717180, loss_d: 0.136544
0.0769 --- loss: 0.878793, loss_ss: 0.723774, loss_d: 0.155019
0.1153 --- loss: 1.530518, loss_ss: 1.196742, loss_d: 0.333776
0.1538 --- loss: 0.892045, loss_ss: 0.832456, loss_d: 0.059589
0.1922 --- loss: 0.656406, loss_ss: 0.583537, loss_d: 0.072869
0.2307 --- loss: 0.856961, loss_ss: 0.715735, loss_d: 0.141226
0.2691 --- loss: 0.856930, loss_ss: 0.693877, loss_d: 0.163054
0.3076 --- loss: 1.347895, loss_ss: 0.727644, loss_d: 0.620251
0.3460 --- loss: 0.787778, loss_ss: 0.722423, loss_d: 0.065355
0.3845 --- loss: 1.481128, loss_ss: 0.923769, loss_d: 0.557359
0.4229 --- loss: 0.916292, loss_ss: 0.829126, loss_d: 0.087166
0.4614 --- loss: 0.777481, loss_ss: 0.650033, loss_d: 0.127448
0.4998 --- loss: 1.261530, loss_ss: 1.020941, loss_d: 0.240589
0.5383 --- loss: 1.190761, loss_ss: 0.930964, loss_d: 0.259797
0.5767 --- loss: 1.056395, loss_ss: 0.890604, loss_d: 0.165791
0.6151 --- loss: 1.322520, loss_ss: 1.197907, loss_d: 0.124613
0.6536 --- loss: 1.050354, loss_ss: 0.931516, loss_d: 0.118838
0.6920 --- loss: 0.805794, loss_ss: 0.741739, loss_d: 0.064055
0.7305 --- loss: 0.967497, loss_ss: 0.732651, loss_d: 0.234846
0.7689 --- loss: 1.094085, loss_ss: 0.874307, loss_d: 0.219778
0.8074 --- loss: 1.486487, loss_ss: 0.822545, loss_d: 0.663943
0.8458 --- loss: 0.888476, loss_ss: 0.754178, loss_d: 0.134298
0.8843 --- loss: 1.036584, loss_ss: 0.928628, loss_d: 0.107956
0.9227 --- loss: 2.467750, loss_ss: 0.809722, loss_d: 1.658028
0.9612 --- loss: 0.823252, loss_ss: 0.659871, loss_d: 0.163381
0.9996 --- loss: 1.466412, loss_ss: 1.424784, loss_d: 0.041629
Epoch finished! Loss: 1.067259555367323
Starting epoch 5/10.
0.0000 --- loss: 0.840955, loss_ss: 0.633624, loss_d: 0.207332
0.0384 --- loss: 0.944589, loss_ss: 0.816796, loss_d: 0.127793
0.0769 --- loss: 0.789066, loss_ss: 0.659654, loss_d: 0.129412
0.1153 --- loss: 0.721620, loss_ss: 0.669483, loss_d: 0.052138
0.1538 --- loss: 0.681611, loss_ss: 0.659196, loss_d: 0.022415
0.1922 --- loss: 0.845952, loss_ss: 0.693422, loss_d: 0.152530
0.2307 --- loss: 0.937580, loss_ss: 0.626898, loss_d: 0.310682
0.2691 --- loss: 0.991724, loss_ss: 0.927791, loss_d: 0.063933
0.3076 --- loss: 1.139734, loss_ss: 0.884090, loss_d: 0.255644
0.3460 --- loss: 0.837212, loss_ss: 0.796449, loss_d: 0.040763
0.3845 --- loss: 0.793769, loss_ss: 0.668430, loss_d: 0.125339
0.4229 --- loss: 0.877785, loss_ss: 0.585129, loss_d: 0.292655
0.4614 --- loss: 1.392645, loss_ss: 0.995504, loss_d: 0.397141
0.4998 --- loss: 1.215080, loss_ss: 1.094947, loss_d: 0.120132
0.5383 --- loss: 1.099475, loss_ss: 0.985573, loss_d: 0.113903
0.5767 --- loss: 1.133983, loss_ss: 0.699625, loss_d: 0.434359
0.6151 --- loss: 0.728026, loss_ss: 0.706151, loss_d: 0.021874
0.6536 --- loss: 1.100086, loss_ss: 0.819651, loss_d: 0.280435
0.6920 --- loss: 1.043592, loss_ss: 0.791439, loss_d: 0.252153
0.7305 --- loss: 0.948533, loss_ss: 0.802870, loss_d: 0.145664
0.7689 --- loss: 1.118150, loss_ss: 0.899120, loss_d: 0.219030
0.8074 --- loss: 0.935517, loss_ss: 0.596221, loss_d: 0.339296
0.8458 --- loss: 0.707848, loss_ss: 0.648177, loss_d: 0.059671
0.8843 --- loss: 1.138837, loss_ss: 1.088819, loss_d: 0.050018
0.9227 --- loss: 0.773669, loss_ss: 0.491909, loss_d: 0.281760
0.9612 --- loss: 0.798203, loss_ss: 0.715190, loss_d: 0.083012
0.9996 --- loss: 1.270360, loss_ss: 1.254912, loss_d: 0.015448
Epoch finished! Loss: 1.021864619392615
Starting epoch 6/10.
0.0000 --- loss: 0.693244, loss_ss: 0.643367, loss_d: 0.049877
0.0384 --- loss: 1.020464, loss_ss: 0.808190, loss_d: 0.212273
0.0769 --- loss: 0.701129, loss_ss: 0.667789, loss_d: 0.033340
0.1153 --- loss: 0.991349, loss_ss: 0.974066, loss_d: 0.017282
0.1538 --- loss: 0.826678, loss_ss: 0.512612, loss_d: 0.314065
0.1922 --- loss: 0.952158, loss_ss: 0.679259, loss_d: 0.272899
0.2307 --- loss: 0.666123, loss_ss: 0.598023, loss_d: 0.068100
0.2691 --- loss: 1.099677, loss_ss: 0.787851, loss_d: 0.311826
0.3076 --- loss: 0.991944, loss_ss: 0.841726, loss_d: 0.150218
0.3460 --- loss: 1.098129, loss_ss: 0.925222, loss_d: 0.172907
0.3845 --- loss: 0.871428, loss_ss: 0.640347, loss_d: 0.231081
0.4229 --- loss: 0.871484, loss_ss: 0.709467, loss_d: 0.162016
0.4614 --- loss: 0.741836, loss_ss: 0.647847, loss_d: 0.093989
0.4998 --- loss: 0.876787, loss_ss: 0.863156, loss_d: 0.013631
0.5383 --- loss: 0.573576, loss_ss: 0.545979, loss_d: 0.027597
0.5767 --- loss: 0.821573, loss_ss: 0.788443, loss_d: 0.033130
0.6151 --- loss: 1.135619, loss_ss: 0.902043, loss_d: 0.233576
0.6536 --- loss: 0.567358, loss_ss: 0.549743, loss_d: 0.017615
0.6920 --- loss: 0.758189, loss_ss: 0.732037, loss_d: 0.026151
0.7305 --- loss: 1.663780, loss_ss: 1.070890, loss_d: 0.592890
0.7689 --- loss: 0.673585, loss_ss: 0.541208, loss_d: 0.132376
0.8074 --- loss: 0.722790, loss_ss: 0.608300, loss_d: 0.114489
0.8458 --- loss: 0.641732, loss_ss: 0.623809, loss_d: 0.017923
0.8843 --- loss: 1.123850, loss_ss: 0.704795, loss_d: 0.419055
0.9227 --- loss: 0.768469, loss_ss: 0.746396, loss_d: 0.022073
0.9612 --- loss: 0.730569, loss_ss: 0.678111, loss_d: 0.052458
0.9996 --- loss: 0.793846, loss_ss: 0.791151, loss_d: 0.002694
Epoch finished! Loss: 0.9537798526195379
Starting epoch 7/10.
0.0000 --- loss: 0.884345, loss_ss: 0.842800, loss_d: 0.041545
0.0384 --- loss: 1.022363, loss_ss: 0.911667, loss_d: 0.110696
0.0769 --- loss: 1.090210, loss_ss: 1.046790, loss_d: 0.043420
0.1153 --- loss: 0.682708, loss_ss: 0.671701, loss_d: 0.011007
0.1538 --- loss: 0.838550, loss_ss: 0.823576, loss_d: 0.014974
0.1922 --- loss: 1.138525, loss_ss: 0.770447, loss_d: 0.368078
0.2307 --- loss: 0.956918, loss_ss: 0.843146, loss_d: 0.113772
0.2691 --- loss: 1.018096, loss_ss: 0.953385, loss_d: 0.064711
0.3076 --- loss: 1.289317, loss_ss: 0.650292, loss_d: 0.639026
0.3460 --- loss: 0.733317, loss_ss: 0.692877, loss_d: 0.040441
0.3845 --- loss: 1.264109, loss_ss: 0.846086, loss_d: 0.418022
0.4229 --- loss: 1.482451, loss_ss: 0.990047, loss_d: 0.492404
0.4614 --- loss: 0.877635, loss_ss: 0.658267, loss_d: 0.219368
0.4998 --- loss: 0.803476, loss_ss: 0.755392, loss_d: 0.048085
0.5383 --- loss: 0.794115, loss_ss: 0.680345, loss_d: 0.113771
0.5767 --- loss: 1.112839, loss_ss: 0.682165, loss_d: 0.430675
0.6151 --- loss: 0.910097, loss_ss: 0.792535, loss_d: 0.117562
0.6536 --- loss: 0.573345, loss_ss: 0.514451, loss_d: 0.058893
0.6920 --- loss: 0.913236, loss_ss: 0.901155, loss_d: 0.012081
0.7305 --- loss: 0.953339, loss_ss: 0.822136, loss_d: 0.131203
0.7689 --- loss: 0.982778, loss_ss: 0.830882, loss_d: 0.151896
0.8074 --- loss: 1.152344, loss_ss: 1.113876, loss_d: 0.038468
0.8458 --- loss: 1.011864, loss_ss: 0.653169, loss_d: 0.358696
0.8843 --- loss: 0.915795, loss_ss: 0.909777, loss_d: 0.006018
0.9227 --- loss: 1.058963, loss_ss: 0.702772, loss_d: 0.356190
0.9612 --- loss: 0.875423, loss_ss: 0.837759, loss_d: 0.037664
0.9996 --- loss: 1.336469, loss_ss: 1.335601, loss_d: 0.000868
Epoch finished! Loss: 0.9336083898177514
Starting epoch 8/10.
0.0000 --- loss: 0.778484, loss_ss: 0.661745, loss_d: 0.116739
0.0384 --- loss: 0.675887, loss_ss: 0.636985, loss_d: 0.038903
0.0769 --- loss: 0.873930, loss_ss: 0.832454, loss_d: 0.041476
0.1153 --- loss: 1.168282, loss_ss: 1.007534, loss_d: 0.160748
0.1538 --- loss: 0.763731, loss_ss: 0.709970, loss_d: 0.053761
0.1922 --- loss: 0.582941, loss_ss: 0.544401, loss_d: 0.038540
0.2307 --- loss: 0.856365, loss_ss: 0.837941, loss_d: 0.018424
0.2691 --- loss: 0.805161, loss_ss: 0.750656, loss_d: 0.054505
0.3076 --- loss: 0.715474, loss_ss: 0.684615, loss_d: 0.030859
0.3460 --- loss: 0.732224, loss_ss: 0.565462, loss_d: 0.166762
0.3845 --- loss: 1.060186, loss_ss: 0.893268, loss_d: 0.166918
0.4229 --- loss: 0.685169, loss_ss: 0.623449, loss_d: 0.061720
0.4614 --- loss: 0.524005, loss_ss: 0.483705, loss_d: 0.040300
0.4998 --- loss: 0.924115, loss_ss: 0.893103, loss_d: 0.031011
0.5383 --- loss: 0.663281, loss_ss: 0.560471, loss_d: 0.102810
0.5767 --- loss: 0.964703, loss_ss: 0.936840, loss_d: 0.027863
0.6151 --- loss: 0.561330, loss_ss: 0.532205, loss_d: 0.029125
0.6536 --- loss: 0.744134, loss_ss: 0.737551, loss_d: 0.006583
0.6920 --- loss: 0.719995, loss_ss: 0.655621, loss_d: 0.064374
0.7305 --- loss: 0.586608, loss_ss: 0.545004, loss_d: 0.041604
0.7689 --- loss: 0.801307, loss_ss: 0.749566, loss_d: 0.051741
0.8074 --- loss: 0.805011, loss_ss: 0.749390, loss_d: 0.055622
0.8458 --- loss: 1.442164, loss_ss: 0.858101, loss_d: 0.584064
0.8843 --- loss: 0.896929, loss_ss: 0.864279, loss_d: 0.032650
0.9227 --- loss: 0.584216, loss_ss: 0.558480, loss_d: 0.025736
0.9612 --- loss: 0.419328, loss_ss: 0.394084, loss_d: 0.025243
0.9996 --- loss: 0.742947, loss_ss: 0.739192, loss_d: 0.003755
Epoch finished! Loss: 0.8991702924554165
Starting epoch 9/10.
0.0000 --- loss: 1.327222, loss_ss: 1.138478, loss_d: 0.188744
0.0384 --- loss: 1.218367, loss_ss: 0.929126, loss_d: 0.289241
0.0769 --- loss: 0.756382, loss_ss: 0.724903, loss_d: 0.031480
0.1153 --- loss: 1.664013, loss_ss: 1.092080, loss_d: 0.571933
0.1538 --- loss: 1.185740, loss_ss: 1.106404, loss_d: 0.079336
0.1922 --- loss: 1.215136, loss_ss: 0.745321, loss_d: 0.469815
0.2307 --- loss: 1.181194, loss_ss: 0.939582, loss_d: 0.241612
0.2691 --- loss: 1.051716, loss_ss: 1.020341, loss_d: 0.031376
0.3076 --- loss: 0.944300, loss_ss: 0.786965, loss_d: 0.157335
0.3460 --- loss: 0.572416, loss_ss: 0.557927, loss_d: 0.014489
0.3845 --- loss: 0.731308, loss_ss: 0.720153, loss_d: 0.011155
0.4229 --- loss: 1.010895, loss_ss: 0.579947, loss_d: 0.430947
0.4614 --- loss: 1.152564, loss_ss: 1.121758, loss_d: 0.030806
0.4998 --- loss: 0.918874, loss_ss: 0.827200, loss_d: 0.091674
0.5383 --- loss: 0.785596, loss_ss: 0.717689, loss_d: 0.067907
0.5767 --- loss: 0.722267, loss_ss: 0.639487, loss_d: 0.082780
0.6151 --- loss: 0.660323, loss_ss: 0.647752, loss_d: 0.012571
0.6536 --- loss: 0.853078, loss_ss: 0.764933, loss_d: 0.088145
0.6920 --- loss: 0.676052, loss_ss: 0.547742, loss_d: 0.128310
0.7305 --- loss: 1.018642, loss_ss: 0.835251, loss_d: 0.183391
0.7689 --- loss: 0.986386, loss_ss: 0.796973, loss_d: 0.189413
0.8074 --- loss: 1.053634, loss_ss: 0.771098, loss_d: 0.282535
0.8458 --- loss: 0.887304, loss_ss: 0.825863, loss_d: 0.061440
0.8843 --- loss: 1.069819, loss_ss: 1.053658, loss_d: 0.016160
0.9227 --- loss: 1.287646, loss_ss: 1.130603, loss_d: 0.157043
0.9612 --- loss: 0.829252, loss_ss: 0.814870, loss_d: 0.014382
0.9996 --- loss: 8.168862, loss_ss: 2.518937, loss_d: 5.649926
Epoch finished! Loss: 0.9086162193463398
Starting epoch 10/10.
0.0000 --- loss: 0.739911, loss_ss: 0.686168, loss_d: 0.053743
0.0384 --- loss: 1.447815, loss_ss: 1.123772, loss_d: 0.324044
0.0769 --- loss: 0.639658, loss_ss: 0.531629, loss_d: 0.108029
0.1153 --- loss: 0.722743, loss_ss: 0.642588, loss_d: 0.080154
0.1538 --- loss: 1.024819, loss_ss: 0.983694, loss_d: 0.041124
0.1922 --- loss: 0.895785, loss_ss: 0.869737, loss_d: 0.026048
0.2307 --- loss: 1.026279, loss_ss: 0.638087, loss_d: 0.388193
0.2691 --- loss: 0.769258, loss_ss: 0.684266, loss_d: 0.084992
0.3076 --- loss: 1.459814, loss_ss: 1.043786, loss_d: 0.416029
0.3460 --- loss: 0.730036, loss_ss: 0.700177, loss_d: 0.029860
0.3845 --- loss: 1.203696, loss_ss: 0.599903, loss_d: 0.603793
0.4229 --- loss: 0.839993, loss_ss: 0.792179, loss_d: 0.047815
0.4614 --- loss: 1.113499, loss_ss: 0.744101, loss_d: 0.369398
0.4998 --- loss: 0.649005, loss_ss: 0.542886, loss_d: 0.106119
0.5383 --- loss: 0.525123, loss_ss: 0.432870, loss_d: 0.092254
0.5767 --- loss: 0.721672, loss_ss: 0.678536, loss_d: 0.043136
0.6151 --- loss: 0.925546, loss_ss: 0.871467, loss_d: 0.054079
0.6536 --- loss: 0.762544, loss_ss: 0.743951, loss_d: 0.018592
0.6920 --- loss: 0.970924, loss_ss: 0.904446, loss_d: 0.066478
0.7305 --- loss: 1.073871, loss_ss: 1.020163, loss_d: 0.053707
0.7689 --- loss: 0.640804, loss_ss: 0.620204, loss_d: 0.020600
0.8074 --- loss: 0.692846, loss_ss: 0.652746, loss_d: 0.040100
0.8458 --- loss: 1.140098, loss_ss: 0.992637, loss_d: 0.147461
0.8843 --- loss: 0.620172, loss_ss: 0.549112, loss_d: 0.071061
0.9227 --- loss: 1.052008, loss_ss: 0.798361, loss_d: 0.253648
0.9612 --- loss: 0.627141, loss_ss: 0.623884, loss_d: 0.003257
0.9996 --- loss: 1.567972, loss_ss: 1.567698, loss_d: 0.000274
Epoch finished! Loss: 0.875295058122048
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6405405405405405
             precision    recall  f1-score   support

        0.0       0.96      0.51      0.66       211
        1.0       0.38      0.16      0.23       184
        2.0       0.82      0.84      0.83       408
        3.0       0.87      0.55      0.68       130
        4.0       0.38      0.89      0.53       177

avg / total       0.71      0.64      0.63      1110
 


====== chp055-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.18  50.71   99.44  95.54     66.25
1  81.71  16.30   94.71  37.97     22.81
2  87.66  84.31   89.60  82.49     83.39
3  93.78  55.38   98.88  86.75     67.61
4  74.77  89.27   72.03  37.71     53.02
Total accuracy: 64.05%
Average sen: 59.20%
Average spec: 90.93%
Macro f1-score: 58.62%
Diagnosis acc on 15mins: 1.0
[0.99999845 1.         0.99999762 0.99996364 0.99999988 0.99999988
 1.         0.9999944  0.99744153 0.99997997 0.99999988 1.
 1.         0.99999809 0.99999571 0.99998903 0.99998176 0.99999928
 0.99998331 0.99999583 0.9999665  0.99999785 0.99999988 0.99999905
 0.99991512 0.99923778 0.99078429 0.99889249 0.99999332 0.9999994
 0.99997556 0.99969339 0.99945921 0.99860919 0.99294066 0.992006
 0.99930966]
pred: 0.9991377737071063, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.290381, loss_ss: 1.602870, loss_d: 0.687512
0.0384 --- loss: 1.950194, loss_ss: 1.443962, loss_d: 0.506232
0.0769 --- loss: 2.000182, loss_ss: 1.446285, loss_d: 0.553897
0.1153 --- loss: 1.960607, loss_ss: 1.604531, loss_d: 0.356076
0.1537 --- loss: 1.962289, loss_ss: 1.434262, loss_d: 0.528027
0.1922 --- loss: 1.805189, loss_ss: 1.301068, loss_d: 0.504120
0.2306 --- loss: 1.707880, loss_ss: 1.344366, loss_d: 0.363514
0.2690 --- loss: 2.394789, loss_ss: 1.339025, loss_d: 1.055764
0.3075 --- loss: 1.946166, loss_ss: 1.408956, loss_d: 0.537210
0.3459 --- loss: 2.138853, loss_ss: 1.450045, loss_d: 0.688808
0.3843 --- loss: 1.873214, loss_ss: 1.377088, loss_d: 0.496125
0.4228 --- loss: 1.466542, loss_ss: 1.160360, loss_d: 0.306182
0.4612 --- loss: 1.541932, loss_ss: 1.190215, loss_d: 0.351717
0.4996 --- loss: 1.846781, loss_ss: 1.288707, loss_d: 0.558074
0.5380 --- loss: 1.740616, loss_ss: 1.162565, loss_d: 0.578052
0.5765 --- loss: 1.852403, loss_ss: 1.270606, loss_d: 0.581798
0.6149 --- loss: 1.721686, loss_ss: 1.325675, loss_d: 0.396011
0.6533 --- loss: 2.042589, loss_ss: 1.266621, loss_d: 0.775968
0.6918 --- loss: 1.708771, loss_ss: 1.387356, loss_d: 0.321415
0.7302 --- loss: 1.605212, loss_ss: 1.150976, loss_d: 0.454237
0.7686 --- loss: 1.645940, loss_ss: 1.216526, loss_d: 0.429414
0.8071 --- loss: 1.621539, loss_ss: 1.233301, loss_d: 0.388238
0.8455 --- loss: 1.534517, loss_ss: 1.107806, loss_d: 0.426711
0.8839 --- loss: 1.693835, loss_ss: 0.897581, loss_d: 0.796254
0.9224 --- loss: 1.528308, loss_ss: 1.200063, loss_d: 0.328245
0.9608 --- loss: 1.823086, loss_ss: 1.218951, loss_d: 0.604135
0.9992 --- loss: 4.013897, loss_ss: 1.563726, loss_d: 2.450171
Epoch finished! Loss: 1.8341470094827506
Starting epoch 2/10.
0.0000 --- loss: 1.662061, loss_ss: 1.100498, loss_d: 0.561563
0.0384 --- loss: 1.416776, loss_ss: 1.240614, loss_d: 0.176162
0.0769 --- loss: 1.404400, loss_ss: 1.090861, loss_d: 0.313539
0.1153 --- loss: 1.359034, loss_ss: 1.227248, loss_d: 0.131786
0.1537 --- loss: 1.419065, loss_ss: 1.002114, loss_d: 0.416950
0.1922 --- loss: 1.012643, loss_ss: 0.861922, loss_d: 0.150722
0.2306 --- loss: 1.069420, loss_ss: 0.955057, loss_d: 0.114363
0.2690 --- loss: 1.758961, loss_ss: 1.131704, loss_d: 0.627257
0.3075 --- loss: 1.297542, loss_ss: 0.992274, loss_d: 0.305268
0.3459 --- loss: 1.262311, loss_ss: 1.030983, loss_d: 0.231328
0.3843 --- loss: 0.979497, loss_ss: 0.811161, loss_d: 0.168336
0.4228 --- loss: 1.209115, loss_ss: 1.049801, loss_d: 0.159314
0.4612 --- loss: 1.117488, loss_ss: 0.756730, loss_d: 0.360759
0.4996 --- loss: 1.054417, loss_ss: 0.988987, loss_d: 0.065431
0.5380 --- loss: 1.222967, loss_ss: 0.966545, loss_d: 0.256422
0.5765 --- loss: 1.245938, loss_ss: 1.154119, loss_d: 0.091819
0.6149 --- loss: 1.305600, loss_ss: 0.980200, loss_d: 0.325400
0.6533 --- loss: 1.193197, loss_ss: 0.879893, loss_d: 0.313304
0.6918 --- loss: 1.175713, loss_ss: 0.978675, loss_d: 0.197039
0.7302 --- loss: 1.124807, loss_ss: 0.910870, loss_d: 0.213937
0.7686 --- loss: 1.289295, loss_ss: 1.070021, loss_d: 0.219274
0.8071 --- loss: 1.332069, loss_ss: 1.093058, loss_d: 0.239012
0.8455 --- loss: 1.315386, loss_ss: 1.233583, loss_d: 0.081803
0.8839 --- loss: 1.183471, loss_ss: 1.070929, loss_d: 0.112542
0.9224 --- loss: 1.143668, loss_ss: 0.966684, loss_d: 0.176983
0.9608 --- loss: 1.122864, loss_ss: 0.928350, loss_d: 0.194514
0.9992 --- loss: 1.634296, loss_ss: 1.595682, loss_d: 0.038614
Epoch finished! Loss: 1.3529927272063036
Starting epoch 3/10.
0.0000 --- loss: 1.089342, loss_ss: 0.935211, loss_d: 0.154131
0.0384 --- loss: 1.428376, loss_ss: 0.831690, loss_d: 0.596686
0.0769 --- loss: 1.089595, loss_ss: 0.928368, loss_d: 0.161227
0.1153 --- loss: 1.512095, loss_ss: 1.061358, loss_d: 0.450736
0.1537 --- loss: 1.290918, loss_ss: 0.771786, loss_d: 0.519132
0.1922 --- loss: 0.973384, loss_ss: 0.861132, loss_d: 0.112253
0.2306 --- loss: 1.287337, loss_ss: 1.099007, loss_d: 0.188330
0.2690 --- loss: 1.288977, loss_ss: 1.026716, loss_d: 0.262262
0.3075 --- loss: 1.005901, loss_ss: 0.886445, loss_d: 0.119456
0.3459 --- loss: 1.353041, loss_ss: 0.870082, loss_d: 0.482959
0.3843 --- loss: 1.361231, loss_ss: 1.010886, loss_d: 0.350346
0.4228 --- loss: 1.085706, loss_ss: 1.002272, loss_d: 0.083434
0.4612 --- loss: 1.167680, loss_ss: 0.948035, loss_d: 0.219646
0.4996 --- loss: 1.045239, loss_ss: 0.844728, loss_d: 0.200510
0.5380 --- loss: 1.168501, loss_ss: 0.785213, loss_d: 0.383288
0.5765 --- loss: 1.179804, loss_ss: 0.935844, loss_d: 0.243960
0.6149 --- loss: 1.263362, loss_ss: 0.988216, loss_d: 0.275145
0.6533 --- loss: 1.085904, loss_ss: 0.800485, loss_d: 0.285419
0.6918 --- loss: 1.185412, loss_ss: 1.125710, loss_d: 0.059702
0.7302 --- loss: 1.106767, loss_ss: 0.774742, loss_d: 0.332025
0.7686 --- loss: 1.320087, loss_ss: 0.929358, loss_d: 0.390729
0.8071 --- loss: 0.867714, loss_ss: 0.802014, loss_d: 0.065700
0.8455 --- loss: 1.132845, loss_ss: 0.778846, loss_d: 0.353999
0.8839 --- loss: 0.809567, loss_ss: 0.679780, loss_d: 0.129786
0.9224 --- loss: 0.807342, loss_ss: 0.696714, loss_d: 0.110629
0.9608 --- loss: 1.281744, loss_ss: 0.955453, loss_d: 0.326292
0.9992 --- loss: 1.257438, loss_ss: 1.124562, loss_d: 0.132876
Epoch finished! Loss: 1.206089708667535
Starting epoch 4/10.
0.0000 --- loss: 0.715866, loss_ss: 0.611377, loss_d: 0.104489
0.0384 --- loss: 1.186682, loss_ss: 1.041196, loss_d: 0.145485
0.0769 --- loss: 1.084782, loss_ss: 0.973244, loss_d: 0.111539
0.1153 --- loss: 0.931243, loss_ss: 0.896495, loss_d: 0.034748
0.1537 --- loss: 1.332888, loss_ss: 0.721237, loss_d: 0.611651
0.1922 --- loss: 1.167026, loss_ss: 0.859048, loss_d: 0.307978
0.2306 --- loss: 1.433231, loss_ss: 0.774747, loss_d: 0.658484
0.2690 --- loss: 0.897013, loss_ss: 0.847228, loss_d: 0.049785
0.3075 --- loss: 0.790618, loss_ss: 0.722585, loss_d: 0.068033
0.3459 --- loss: 1.048413, loss_ss: 0.807714, loss_d: 0.240699
0.3843 --- loss: 1.139200, loss_ss: 1.104521, loss_d: 0.034679
0.4228 --- loss: 0.680032, loss_ss: 0.644284, loss_d: 0.035748
0.4612 --- loss: 1.078961, loss_ss: 0.986105, loss_d: 0.092856
0.4996 --- loss: 0.892919, loss_ss: 0.832809, loss_d: 0.060111
0.5380 --- loss: 1.041855, loss_ss: 0.931740, loss_d: 0.110115
0.5765 --- loss: 0.968703, loss_ss: 0.943093, loss_d: 0.025611
0.6149 --- loss: 1.139605, loss_ss: 1.021871, loss_d: 0.117734
0.6533 --- loss: 1.257742, loss_ss: 1.012962, loss_d: 0.244780
0.6918 --- loss: 0.840174, loss_ss: 0.769527, loss_d: 0.070647
0.7302 --- loss: 0.920908, loss_ss: 0.776982, loss_d: 0.143926
0.7686 --- loss: 1.131564, loss_ss: 1.037491, loss_d: 0.094074
0.8071 --- loss: 1.000627, loss_ss: 0.974640, loss_d: 0.025987
0.8455 --- loss: 1.164208, loss_ss: 0.825956, loss_d: 0.338251
0.8839 --- loss: 1.226565, loss_ss: 0.872272, loss_d: 0.354293
0.9224 --- loss: 1.321969, loss_ss: 0.892327, loss_d: 0.429642
0.9608 --- loss: 1.229796, loss_ss: 1.116220, loss_d: 0.113575
0.9992 --- loss: 1.209995, loss_ss: 1.180734, loss_d: 0.029261
Epoch finished! Loss: 1.1127464023920206
Starting epoch 5/10.
0.0000 --- loss: 1.059134, loss_ss: 0.976852, loss_d: 0.082282
0.0384 --- loss: 1.222107, loss_ss: 0.823004, loss_d: 0.399102
0.0769 --- loss: 1.082739, loss_ss: 1.007265, loss_d: 0.075474
0.1153 --- loss: 1.034582, loss_ss: 0.638714, loss_d: 0.395868
0.1537 --- loss: 0.867260, loss_ss: 0.797248, loss_d: 0.070011
0.1922 --- loss: 1.300587, loss_ss: 0.924608, loss_d: 0.375979
0.2306 --- loss: 0.830054, loss_ss: 0.762880, loss_d: 0.067175
0.2690 --- loss: 1.238033, loss_ss: 0.813293, loss_d: 0.424741
0.3075 --- loss: 1.243984, loss_ss: 0.923491, loss_d: 0.320493
0.3459 --- loss: 0.833056, loss_ss: 0.786640, loss_d: 0.046416
0.3843 --- loss: 0.719951, loss_ss: 0.628242, loss_d: 0.091710
0.4228 --- loss: 0.793895, loss_ss: 0.745205, loss_d: 0.048690
0.4612 --- loss: 1.004532, loss_ss: 0.890130, loss_d: 0.114402
0.4996 --- loss: 0.970763, loss_ss: 0.888315, loss_d: 0.082449
0.5380 --- loss: 0.914762, loss_ss: 0.857377, loss_d: 0.057385
0.5765 --- loss: 0.831013, loss_ss: 0.738897, loss_d: 0.092116
0.6149 --- loss: 0.750840, loss_ss: 0.669726, loss_d: 0.081113
0.6533 --- loss: 0.843198, loss_ss: 0.712383, loss_d: 0.130815
0.6918 --- loss: 0.931603, loss_ss: 0.847557, loss_d: 0.084045
0.7302 --- loss: 0.966920, loss_ss: 0.788162, loss_d: 0.178757
0.7686 --- loss: 0.798480, loss_ss: 0.672761, loss_d: 0.125719
0.8071 --- loss: 1.600404, loss_ss: 1.182427, loss_d: 0.417977
0.8455 --- loss: 0.761469, loss_ss: 0.717277, loss_d: 0.044192
0.8839 --- loss: 1.159901, loss_ss: 1.100653, loss_d: 0.059248
0.9224 --- loss: 1.240234, loss_ss: 1.038154, loss_d: 0.202080
0.9608 --- loss: 1.026668, loss_ss: 0.586884, loss_d: 0.439784
0.9992 --- loss: 0.770862, loss_ss: 0.729326, loss_d: 0.041536
Epoch finished! Loss: 1.0470576781492966
Starting epoch 6/10.
0.0000 --- loss: 0.958250, loss_ss: 0.887968, loss_d: 0.070282
0.0384 --- loss: 1.058955, loss_ss: 1.003331, loss_d: 0.055624
0.0769 --- loss: 0.922088, loss_ss: 0.762345, loss_d: 0.159744
0.1153 --- loss: 0.813834, loss_ss: 0.751453, loss_d: 0.062381
0.1537 --- loss: 1.049167, loss_ss: 0.992100, loss_d: 0.057067
0.1922 --- loss: 0.820929, loss_ss: 0.756869, loss_d: 0.064060
0.2306 --- loss: 1.194427, loss_ss: 0.869183, loss_d: 0.325244
0.2690 --- loss: 1.014090, loss_ss: 0.626550, loss_d: 0.387540
0.3075 --- loss: 1.023098, loss_ss: 0.794491, loss_d: 0.228607
0.3459 --- loss: 0.812616, loss_ss: 0.487106, loss_d: 0.325509
0.3843 --- loss: 1.011687, loss_ss: 0.966175, loss_d: 0.045512
0.4228 --- loss: 0.848129, loss_ss: 0.669253, loss_d: 0.178877
0.4612 --- loss: 0.784105, loss_ss: 0.771712, loss_d: 0.012393
0.4996 --- loss: 0.853483, loss_ss: 0.743099, loss_d: 0.110384
0.5380 --- loss: 0.845080, loss_ss: 0.702545, loss_d: 0.142535
0.5765 --- loss: 0.878803, loss_ss: 0.740415, loss_d: 0.138389
0.6149 --- loss: 1.218635, loss_ss: 1.164758, loss_d: 0.053877
0.6533 --- loss: 0.776761, loss_ss: 0.738853, loss_d: 0.037908
0.6918 --- loss: 0.821484, loss_ss: 0.758880, loss_d: 0.062604
0.7302 --- loss: 0.713384, loss_ss: 0.682522, loss_d: 0.030861
0.7686 --- loss: 0.821415, loss_ss: 0.706679, loss_d: 0.114737
0.8071 --- loss: 1.116424, loss_ss: 0.838076, loss_d: 0.278348
0.8455 --- loss: 1.020661, loss_ss: 0.993277, loss_d: 0.027384
0.8839 --- loss: 1.104679, loss_ss: 1.011817, loss_d: 0.092862
0.9224 --- loss: 1.370951, loss_ss: 1.328240, loss_d: 0.042711
0.9608 --- loss: 0.817566, loss_ss: 0.778541, loss_d: 0.039026
0.9992 --- loss: 2.549061, loss_ss: 2.541025, loss_d: 0.008035
Epoch finished! Loss: 0.9793493098937548
Starting epoch 7/10.
0.0000 --- loss: 1.485145, loss_ss: 0.587257, loss_d: 0.897888
0.0384 --- loss: 0.769620, loss_ss: 0.705543, loss_d: 0.064078
0.0769 --- loss: 0.952570, loss_ss: 0.771283, loss_d: 0.181287
0.1153 --- loss: 0.828600, loss_ss: 0.654528, loss_d: 0.174072
0.1537 --- loss: 0.749671, loss_ss: 0.695854, loss_d: 0.053816
0.1922 --- loss: 1.241253, loss_ss: 0.886613, loss_d: 0.354640
0.2306 --- loss: 0.998414, loss_ss: 0.922143, loss_d: 0.076271
0.2690 --- loss: 0.810533, loss_ss: 0.701210, loss_d: 0.109323
0.3075 --- loss: 0.967347, loss_ss: 0.825479, loss_d: 0.141868
0.3459 --- loss: 0.895569, loss_ss: 0.803444, loss_d: 0.092125
0.3843 --- loss: 0.951271, loss_ss: 0.892574, loss_d: 0.058697
0.4228 --- loss: 0.930026, loss_ss: 0.681630, loss_d: 0.248395
0.4612 --- loss: 0.692560, loss_ss: 0.675100, loss_d: 0.017460
0.4996 --- loss: 1.135791, loss_ss: 0.857928, loss_d: 0.277863
0.5380 --- loss: 0.778876, loss_ss: 0.748070, loss_d: 0.030806
0.5765 --- loss: 0.818582, loss_ss: 0.753415, loss_d: 0.065167
0.6149 --- loss: 1.299578, loss_ss: 1.257971, loss_d: 0.041607
0.6533 --- loss: 1.015144, loss_ss: 0.984695, loss_d: 0.030449
0.6918 --- loss: 1.145113, loss_ss: 1.015360, loss_d: 0.129753
0.7302 --- loss: 0.852192, loss_ss: 0.690778, loss_d: 0.161414
0.7686 --- loss: 0.658920, loss_ss: 0.625441, loss_d: 0.033479
0.8071 --- loss: 0.810118, loss_ss: 0.802692, loss_d: 0.007426
0.8455 --- loss: 0.897164, loss_ss: 0.880649, loss_d: 0.016515
0.8839 --- loss: 0.989531, loss_ss: 0.896522, loss_d: 0.093009
0.9224 --- loss: 1.094754, loss_ss: 0.612938, loss_d: 0.481815
0.9608 --- loss: 0.762363, loss_ss: 0.701896, loss_d: 0.060467
0.9992 --- loss: 0.908392, loss_ss: 0.881164, loss_d: 0.027228
Epoch finished! Loss: 0.9627791296977263
Starting epoch 8/10.
0.0000 --- loss: 0.626355, loss_ss: 0.598151, loss_d: 0.028204
0.0384 --- loss: 0.927956, loss_ss: 0.892378, loss_d: 0.035579
0.0769 --- loss: 1.011548, loss_ss: 0.751377, loss_d: 0.260171
0.1153 --- loss: 0.986406, loss_ss: 0.844113, loss_d: 0.142293
0.1537 --- loss: 0.774562, loss_ss: 0.757884, loss_d: 0.016678
0.1922 --- loss: 0.770798, loss_ss: 0.648726, loss_d: 0.122073
0.2306 --- loss: 1.106154, loss_ss: 0.882966, loss_d: 0.223188
0.2690 --- loss: 0.928665, loss_ss: 0.889459, loss_d: 0.039206
0.3075 --- loss: 1.279327, loss_ss: 0.772198, loss_d: 0.507130
0.3459 --- loss: 0.716115, loss_ss: 0.709921, loss_d: 0.006194
0.3843 --- loss: 1.178867, loss_ss: 1.154540, loss_d: 0.024327
0.4228 --- loss: 1.040935, loss_ss: 0.941288, loss_d: 0.099647
0.4612 --- loss: 0.729194, loss_ss: 0.667080, loss_d: 0.062114
0.4996 --- loss: 0.787525, loss_ss: 0.716837, loss_d: 0.070688
0.5380 --- loss: 0.621411, loss_ss: 0.538330, loss_d: 0.083081
0.5765 --- loss: 1.022082, loss_ss: 0.782701, loss_d: 0.239381
0.6149 --- loss: 0.875335, loss_ss: 0.840959, loss_d: 0.034376
0.6533 --- loss: 1.187304, loss_ss: 0.827430, loss_d: 0.359875
0.6918 --- loss: 0.935860, loss_ss: 0.933399, loss_d: 0.002461
0.7302 --- loss: 0.884562, loss_ss: 0.860026, loss_d: 0.024537
0.7686 --- loss: 1.760793, loss_ss: 0.761445, loss_d: 0.999348
0.8071 --- loss: 1.493378, loss_ss: 0.852912, loss_d: 0.640466
0.8455 --- loss: 1.566754, loss_ss: 0.983625, loss_d: 0.583129
0.8839 --- loss: 0.826051, loss_ss: 0.743298, loss_d: 0.082752
0.9224 --- loss: 1.262646, loss_ss: 0.853386, loss_d: 0.409260
0.9608 --- loss: 1.238041, loss_ss: 1.193271, loss_d: 0.044771
0.9992 --- loss: 0.879590, loss_ss: 0.820995, loss_d: 0.058595
Epoch finished! Loss: 0.9180365617458637
Starting epoch 9/10.
0.0000 --- loss: 0.906879, loss_ss: 0.839294, loss_d: 0.067585
0.0384 --- loss: 0.522201, loss_ss: 0.458250, loss_d: 0.063951
0.0769 --- loss: 0.985401, loss_ss: 0.960882, loss_d: 0.024518
0.1153 --- loss: 0.694929, loss_ss: 0.640408, loss_d: 0.054521
0.1537 --- loss: 0.812611, loss_ss: 0.738407, loss_d: 0.074204
0.1922 --- loss: 0.787784, loss_ss: 0.784894, loss_d: 0.002890
0.2306 --- loss: 0.874691, loss_ss: 0.587582, loss_d: 0.287109
0.2690 --- loss: 0.531618, loss_ss: 0.510309, loss_d: 0.021310
0.3075 --- loss: 0.680566, loss_ss: 0.659663, loss_d: 0.020903
0.3459 --- loss: 0.621888, loss_ss: 0.538039, loss_d: 0.083849
0.3843 --- loss: 0.815957, loss_ss: 0.789401, loss_d: 0.026556
0.4228 --- loss: 0.657969, loss_ss: 0.636471, loss_d: 0.021498
0.4612 --- loss: 1.380112, loss_ss: 1.005575, loss_d: 0.374537
0.4996 --- loss: 1.017659, loss_ss: 0.704048, loss_d: 0.313611
0.5380 --- loss: 0.881937, loss_ss: 0.825792, loss_d: 0.056145
0.5765 --- loss: 0.650207, loss_ss: 0.577646, loss_d: 0.072561
0.6149 --- loss: 1.007057, loss_ss: 0.986517, loss_d: 0.020540
0.6533 --- loss: 0.731597, loss_ss: 0.670912, loss_d: 0.060685
0.6918 --- loss: 0.702637, loss_ss: 0.696672, loss_d: 0.005965
0.7302 --- loss: 0.965495, loss_ss: 0.788235, loss_d: 0.177260
0.7686 --- loss: 0.951263, loss_ss: 0.935428, loss_d: 0.015835
0.8071 --- loss: 0.905259, loss_ss: 0.709396, loss_d: 0.195864
0.8455 --- loss: 0.616102, loss_ss: 0.540774, loss_d: 0.075327
0.8839 --- loss: 0.568039, loss_ss: 0.560893, loss_d: 0.007146
0.9224 --- loss: 0.792445, loss_ss: 0.774401, loss_d: 0.018044
0.9608 --- loss: 0.856153, loss_ss: 0.847176, loss_d: 0.008977
0.9992 --- loss: 0.847787, loss_ss: 0.842502, loss_d: 0.005286
Epoch finished! Loss: 0.8748405300653898
Starting epoch 10/10.
0.0000 --- loss: 0.681411, loss_ss: 0.668679, loss_d: 0.012732
0.0384 --- loss: 0.792695, loss_ss: 0.725257, loss_d: 0.067437
0.0769 --- loss: 0.752182, loss_ss: 0.728551, loss_d: 0.023631
0.1153 --- loss: 0.784408, loss_ss: 0.692036, loss_d: 0.092372
0.1537 --- loss: 0.730177, loss_ss: 0.665332, loss_d: 0.064844
0.1922 --- loss: 0.888639, loss_ss: 0.872800, loss_d: 0.015839
0.2306 --- loss: 1.117596, loss_ss: 0.897962, loss_d: 0.219634
0.2690 --- loss: 0.735740, loss_ss: 0.699713, loss_d: 0.036027
0.3075 --- loss: 0.665364, loss_ss: 0.571452, loss_d: 0.093912
0.3459 --- loss: 1.031635, loss_ss: 0.657139, loss_d: 0.374496
0.3843 --- loss: 0.781020, loss_ss: 0.563819, loss_d: 0.217201
0.4228 --- loss: 0.804346, loss_ss: 0.795538, loss_d: 0.008808
0.4612 --- loss: 0.768911, loss_ss: 0.732386, loss_d: 0.036525
0.4996 --- loss: 0.765933, loss_ss: 0.675634, loss_d: 0.090298
0.5380 --- loss: 1.445192, loss_ss: 1.126675, loss_d: 0.318518
0.5765 --- loss: 1.080572, loss_ss: 1.046271, loss_d: 0.034301
0.6149 --- loss: 0.717892, loss_ss: 0.677022, loss_d: 0.040870
0.6533 --- loss: 0.858170, loss_ss: 0.844653, loss_d: 0.013517
0.6918 --- loss: 0.790653, loss_ss: 0.784713, loss_d: 0.005940
0.7302 --- loss: 0.816959, loss_ss: 0.807953, loss_d: 0.009005
0.7686 --- loss: 0.584729, loss_ss: 0.549138, loss_d: 0.035592
0.8071 --- loss: 0.895558, loss_ss: 0.755489, loss_d: 0.140069
0.8455 --- loss: 1.217686, loss_ss: 0.678781, loss_d: 0.538905
0.8839 --- loss: 0.956121, loss_ss: 0.943033, loss_d: 0.013088
0.9224 --- loss: 0.794821, loss_ss: 0.654976, loss_d: 0.139845
0.9608 --- loss: 0.654315, loss_ss: 0.644164, loss_d: 0.010151
0.9992 --- loss: 1.373098, loss_ss: 1.371389, loss_d: 0.001709
Epoch finished! Loss: 0.8855198920919345
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6675925925925926
             precision    recall  f1-score   support

        0.0       0.46      0.68      0.55        78
        1.0       0.61      0.13      0.21       284
        2.0       0.60      0.93      0.73       258
        3.0       0.99      0.92      0.95       185
        4.0       0.66      0.81      0.73       275

avg / total       0.68      0.67      0.62      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.85  67.95   93.71  45.69     54.64
1  74.91  12.68   97.11  61.02     20.99
2  83.61  93.02   80.66  60.15     73.06
3  98.43  91.89   99.78  98.84     95.24
4  84.72  80.73   86.09  66.47     72.91
Total accuracy: 66.76%
Average sen: 69.25%
Average spec: 91.47%
Macro f1-score: 63.37%
Diagnosis acc on 15mins: 1.0
[0.99998164 1.         0.99999118 0.99972159 0.99967551 0.99999952
 0.99999917 0.99999809 0.99999881 1.         1.         0.99999821
 0.99999869 0.99998713 1.         1.         1.         1.
 1.         0.99999928 1.         1.         1.         0.99999988
 0.99995267 0.9997645  0.99946386 0.99997854 0.9999795  0.99999952
 0.99999976 1.         1.         1.         0.99999964 0.99998307]
pred: 0.9999574936098523, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.348239, loss_ss: 1.696535, loss_d: 0.651704
0.0385 --- loss: 2.432893, loss_ss: 1.485898, loss_d: 0.946995
0.0770 --- loss: 2.323482, loss_ss: 1.650216, loss_d: 0.673266
0.1154 --- loss: 2.026105, loss_ss: 1.385592, loss_d: 0.640514
0.1539 --- loss: 2.368629, loss_ss: 1.605641, loss_d: 0.762987
0.1924 --- loss: 2.115275, loss_ss: 1.534491, loss_d: 0.580785
0.2309 --- loss: 2.135787, loss_ss: 1.494677, loss_d: 0.641110
0.2693 --- loss: 2.056662, loss_ss: 1.307725, loss_d: 0.748937
0.3078 --- loss: 1.719751, loss_ss: 1.171344, loss_d: 0.548407
0.3463 --- loss: 2.037156, loss_ss: 1.363275, loss_d: 0.673881
0.3848 --- loss: 2.050450, loss_ss: 1.174559, loss_d: 0.875891
0.4232 --- loss: 1.831184, loss_ss: 1.447369, loss_d: 0.383815
0.4617 --- loss: 1.903627, loss_ss: 1.129389, loss_d: 0.774238
0.5002 --- loss: 1.576982, loss_ss: 1.197863, loss_d: 0.379120
0.5387 --- loss: 1.601267, loss_ss: 1.239055, loss_d: 0.362213
0.5771 --- loss: 1.804871, loss_ss: 1.258099, loss_d: 0.546772
0.6156 --- loss: 1.900105, loss_ss: 1.567993, loss_d: 0.332113
0.6541 --- loss: 1.963742, loss_ss: 1.309851, loss_d: 0.653891
0.6926 --- loss: 2.324957, loss_ss: 1.259681, loss_d: 1.065277
0.7311 --- loss: 1.775810, loss_ss: 1.419514, loss_d: 0.356296
0.7695 --- loss: 1.722443, loss_ss: 1.208236, loss_d: 0.514206
0.8080 --- loss: 1.940842, loss_ss: 1.321875, loss_d: 0.618967
0.8465 --- loss: 1.837041, loss_ss: 1.315204, loss_d: 0.521838
0.8850 --- loss: 1.844197, loss_ss: 1.127886, loss_d: 0.716311
0.9234 --- loss: 1.323262, loss_ss: 0.976989, loss_d: 0.346273
0.9619 --- loss: 1.499734, loss_ss: 1.105252, loss_d: 0.394482
Epoch finished! Loss: 1.8591472941475946
Starting epoch 2/10.
0.0000 --- loss: 1.548355, loss_ss: 1.328215, loss_d: 0.220139
0.0385 --- loss: 1.770237, loss_ss: 1.065384, loss_d: 0.704853
0.0770 --- loss: 1.652701, loss_ss: 1.189930, loss_d: 0.462771
0.1154 --- loss: 1.505678, loss_ss: 1.297599, loss_d: 0.208079
0.1539 --- loss: 1.842869, loss_ss: 1.091023, loss_d: 0.751846
0.1924 --- loss: 1.435034, loss_ss: 1.074638, loss_d: 0.360396
0.2309 --- loss: 1.639553, loss_ss: 1.281870, loss_d: 0.357683
0.2693 --- loss: 1.692748, loss_ss: 1.016044, loss_d: 0.676705
0.3078 --- loss: 1.296386, loss_ss: 1.095730, loss_d: 0.200655
0.3463 --- loss: 1.523706, loss_ss: 1.155523, loss_d: 0.368183
0.3848 --- loss: 1.317021, loss_ss: 0.938076, loss_d: 0.378945
0.4232 --- loss: 1.377111, loss_ss: 0.947132, loss_d: 0.429979
0.4617 --- loss: 1.740569, loss_ss: 1.063233, loss_d: 0.677336
0.5002 --- loss: 1.429232, loss_ss: 1.056912, loss_d: 0.372320
0.5387 --- loss: 1.783041, loss_ss: 1.104039, loss_d: 0.679003
0.5771 --- loss: 1.303096, loss_ss: 1.066334, loss_d: 0.236762
0.6156 --- loss: 1.174940, loss_ss: 0.861247, loss_d: 0.313692
0.6541 --- loss: 1.004490, loss_ss: 0.875012, loss_d: 0.129479
0.6926 --- loss: 1.606870, loss_ss: 1.305351, loss_d: 0.301520
0.7311 --- loss: 1.057279, loss_ss: 0.725287, loss_d: 0.331992
0.7695 --- loss: 0.963267, loss_ss: 0.803466, loss_d: 0.159801
0.8080 --- loss: 1.266292, loss_ss: 1.074052, loss_d: 0.192240
0.8465 --- loss: 1.081166, loss_ss: 0.786371, loss_d: 0.294795
0.8850 --- loss: 1.321687, loss_ss: 0.944500, loss_d: 0.377186
0.9234 --- loss: 1.330772, loss_ss: 1.143948, loss_d: 0.186824
0.9619 --- loss: 1.198799, loss_ss: 0.953647, loss_d: 0.245152
Epoch finished! Loss: 1.3725895184347527
Starting epoch 3/10.
0.0000 --- loss: 1.061798, loss_ss: 0.987826, loss_d: 0.073972
0.0385 --- loss: 1.139761, loss_ss: 0.996984, loss_d: 0.142777
0.0770 --- loss: 0.978967, loss_ss: 0.752225, loss_d: 0.226742
0.1154 --- loss: 1.693646, loss_ss: 0.895572, loss_d: 0.798075
0.1539 --- loss: 1.777755, loss_ss: 1.093585, loss_d: 0.684169
0.1924 --- loss: 1.053363, loss_ss: 0.845816, loss_d: 0.207548
0.2309 --- loss: 0.886194, loss_ss: 0.733544, loss_d: 0.152651
0.2693 --- loss: 1.052726, loss_ss: 0.926467, loss_d: 0.126259
0.3078 --- loss: 1.506091, loss_ss: 0.706935, loss_d: 0.799156
0.3463 --- loss: 0.863411, loss_ss: 0.798883, loss_d: 0.064528
0.3848 --- loss: 1.567299, loss_ss: 1.336902, loss_d: 0.230397
0.4232 --- loss: 1.129321, loss_ss: 0.951580, loss_d: 0.177741
0.4617 --- loss: 1.147830, loss_ss: 0.954982, loss_d: 0.192848
0.5002 --- loss: 1.378785, loss_ss: 0.912099, loss_d: 0.466686
0.5387 --- loss: 0.996923, loss_ss: 0.800053, loss_d: 0.196870
0.5771 --- loss: 1.604921, loss_ss: 1.251731, loss_d: 0.353191
0.6156 --- loss: 1.720433, loss_ss: 0.991423, loss_d: 0.729009
0.6541 --- loss: 1.362053, loss_ss: 0.805945, loss_d: 0.556109
0.6926 --- loss: 1.121178, loss_ss: 0.905274, loss_d: 0.215904
0.7311 --- loss: 1.475874, loss_ss: 0.891839, loss_d: 0.584035
0.7695 --- loss: 1.112196, loss_ss: 0.958715, loss_d: 0.153482
0.8080 --- loss: 1.067432, loss_ss: 0.952804, loss_d: 0.114628
0.8465 --- loss: 1.131248, loss_ss: 0.906657, loss_d: 0.224591
0.8850 --- loss: 1.289468, loss_ss: 1.242573, loss_d: 0.046895
0.9234 --- loss: 1.902062, loss_ss: 1.400297, loss_d: 0.501766
0.9619 --- loss: 1.222695, loss_ss: 1.063200, loss_d: 0.159496
Epoch finished! Loss: 1.185761536870684
Starting epoch 4/10.
0.0000 --- loss: 1.714861, loss_ss: 1.504553, loss_d: 0.210308
0.0385 --- loss: 1.251512, loss_ss: 0.851878, loss_d: 0.399634
0.0770 --- loss: 1.105813, loss_ss: 0.533040, loss_d: 0.572773
0.1154 --- loss: 1.004418, loss_ss: 0.803689, loss_d: 0.200729
0.1539 --- loss: 1.625278, loss_ss: 1.263263, loss_d: 0.362015
0.1924 --- loss: 1.442743, loss_ss: 0.976504, loss_d: 0.466239
0.2309 --- loss: 1.131780, loss_ss: 0.927509, loss_d: 0.204270
0.2693 --- loss: 0.960294, loss_ss: 0.731426, loss_d: 0.228868
0.3078 --- loss: 1.020522, loss_ss: 0.957447, loss_d: 0.063075
0.3463 --- loss: 1.291280, loss_ss: 0.696372, loss_d: 0.594908
0.3848 --- loss: 1.288518, loss_ss: 1.127139, loss_d: 0.161379
0.4232 --- loss: 0.822196, loss_ss: 0.677938, loss_d: 0.144259
0.4617 --- loss: 0.994860, loss_ss: 0.913729, loss_d: 0.081131
0.5002 --- loss: 1.169204, loss_ss: 1.146815, loss_d: 0.022389
0.5387 --- loss: 1.088738, loss_ss: 0.888687, loss_d: 0.200051
0.5771 --- loss: 1.248573, loss_ss: 0.679940, loss_d: 0.568633
0.6156 --- loss: 0.825318, loss_ss: 0.750380, loss_d: 0.074938
0.6541 --- loss: 0.967766, loss_ss: 0.720476, loss_d: 0.247290
0.6926 --- loss: 0.955182, loss_ss: 0.904760, loss_d: 0.050423
0.7311 --- loss: 0.967628, loss_ss: 0.850488, loss_d: 0.117140
0.7695 --- loss: 1.261592, loss_ss: 1.021877, loss_d: 0.239715
0.8080 --- loss: 1.122114, loss_ss: 1.059786, loss_d: 0.062327
0.8465 --- loss: 0.848329, loss_ss: 0.791782, loss_d: 0.056547
0.8850 --- loss: 1.118022, loss_ss: 0.958845, loss_d: 0.159178
0.9234 --- loss: 1.525235, loss_ss: 0.904166, loss_d: 0.621068
0.9619 --- loss: 0.931948, loss_ss: 0.811367, loss_d: 0.120581
Epoch finished! Loss: 1.0884585187241838
Starting epoch 5/10.
0.0000 --- loss: 0.995992, loss_ss: 0.843419, loss_d: 0.152573
0.0385 --- loss: 0.699321, loss_ss: 0.600834, loss_d: 0.098487
0.0770 --- loss: 0.767581, loss_ss: 0.731135, loss_d: 0.036445
0.1154 --- loss: 0.868124, loss_ss: 0.811916, loss_d: 0.056207
0.1539 --- loss: 0.893198, loss_ss: 0.740642, loss_d: 0.152557
0.1924 --- loss: 0.779073, loss_ss: 0.755969, loss_d: 0.023104
0.2309 --- loss: 0.788076, loss_ss: 0.764376, loss_d: 0.023700
0.2693 --- loss: 1.203553, loss_ss: 0.769692, loss_d: 0.433861
0.3078 --- loss: 1.265744, loss_ss: 0.797228, loss_d: 0.468516
0.3463 --- loss: 0.913859, loss_ss: 0.858573, loss_d: 0.055286
0.3848 --- loss: 0.945807, loss_ss: 0.766816, loss_d: 0.178991
0.4232 --- loss: 1.066237, loss_ss: 0.802233, loss_d: 0.264004
0.4617 --- loss: 0.747952, loss_ss: 0.680805, loss_d: 0.067147
0.5002 --- loss: 0.977424, loss_ss: 0.873458, loss_d: 0.103966
0.5387 --- loss: 0.847849, loss_ss: 0.699966, loss_d: 0.147883
0.5771 --- loss: 1.052172, loss_ss: 0.880195, loss_d: 0.171978
0.6156 --- loss: 0.917377, loss_ss: 0.829796, loss_d: 0.087581
0.6541 --- loss: 0.886329, loss_ss: 0.718843, loss_d: 0.167487
0.6926 --- loss: 0.853417, loss_ss: 0.613064, loss_d: 0.240352
0.7311 --- loss: 0.850427, loss_ss: 0.814332, loss_d: 0.036094
0.7695 --- loss: 0.601703, loss_ss: 0.555992, loss_d: 0.045711
0.8080 --- loss: 0.843958, loss_ss: 0.758410, loss_d: 0.085548
0.8465 --- loss: 0.978253, loss_ss: 0.960907, loss_d: 0.017346
0.8850 --- loss: 0.984931, loss_ss: 0.941977, loss_d: 0.042954
0.9234 --- loss: 0.742801, loss_ss: 0.693772, loss_d: 0.049029
0.9619 --- loss: 1.047074, loss_ss: 0.890772, loss_d: 0.156302
Epoch finished! Loss: 0.9867383330254942
Starting epoch 6/10.
0.0000 --- loss: 1.465237, loss_ss: 0.844514, loss_d: 0.620723
0.0385 --- loss: 0.936183, loss_ss: 0.867043, loss_d: 0.069140
0.0770 --- loss: 0.920463, loss_ss: 0.799094, loss_d: 0.121369
0.1154 --- loss: 0.811150, loss_ss: 0.647206, loss_d: 0.163944
0.1539 --- loss: 0.876420, loss_ss: 0.822398, loss_d: 0.054022
0.1924 --- loss: 1.244503, loss_ss: 1.088588, loss_d: 0.155915
0.2309 --- loss: 0.989498, loss_ss: 0.832906, loss_d: 0.156592
0.2693 --- loss: 0.980126, loss_ss: 0.956421, loss_d: 0.023704
0.3078 --- loss: 0.930034, loss_ss: 0.590669, loss_d: 0.339365
0.3463 --- loss: 0.931593, loss_ss: 0.811281, loss_d: 0.120312
0.3848 --- loss: 0.883138, loss_ss: 0.747685, loss_d: 0.135453
0.4232 --- loss: 1.648940, loss_ss: 0.951154, loss_d: 0.697786
0.4617 --- loss: 0.928556, loss_ss: 0.855927, loss_d: 0.072629
0.5002 --- loss: 0.827752, loss_ss: 0.734108, loss_d: 0.093644
0.5387 --- loss: 0.915501, loss_ss: 0.728840, loss_d: 0.186661
0.5771 --- loss: 0.777399, loss_ss: 0.758193, loss_d: 0.019206
0.6156 --- loss: 1.466071, loss_ss: 1.200561, loss_d: 0.265510
0.6541 --- loss: 1.566516, loss_ss: 0.969998, loss_d: 0.596518
0.6926 --- loss: 0.921362, loss_ss: 0.838037, loss_d: 0.083325
0.7311 --- loss: 0.636863, loss_ss: 0.574746, loss_d: 0.062118
0.7695 --- loss: 0.981519, loss_ss: 0.960556, loss_d: 0.020963
0.8080 --- loss: 0.810453, loss_ss: 0.773197, loss_d: 0.037257
0.8465 --- loss: 0.941773, loss_ss: 0.907108, loss_d: 0.034666
0.8850 --- loss: 0.924790, loss_ss: 0.893352, loss_d: 0.031438
0.9234 --- loss: 0.625846, loss_ss: 0.611629, loss_d: 0.014217
0.9619 --- loss: 0.837894, loss_ss: 0.496165, loss_d: 0.341730
Epoch finished! Loss: 0.9544262370547733
Starting epoch 7/10.
0.0000 --- loss: 1.390190, loss_ss: 0.998218, loss_d: 0.391972
0.0385 --- loss: 0.809217, loss_ss: 0.746507, loss_d: 0.062709
0.0770 --- loss: 1.046047, loss_ss: 0.816460, loss_d: 0.229587
0.1154 --- loss: 1.080258, loss_ss: 1.040836, loss_d: 0.039422
0.1539 --- loss: 0.619934, loss_ss: 0.617199, loss_d: 0.002735
0.1924 --- loss: 0.755023, loss_ss: 0.753338, loss_d: 0.001685
0.2309 --- loss: 1.005362, loss_ss: 0.672489, loss_d: 0.332873
0.2693 --- loss: 1.034838, loss_ss: 0.982870, loss_d: 0.051968
0.3078 --- loss: 1.836871, loss_ss: 1.137874, loss_d: 0.698997
0.3463 --- loss: 0.672189, loss_ss: 0.633868, loss_d: 0.038321
0.3848 --- loss: 0.757913, loss_ss: 0.713619, loss_d: 0.044294
0.4232 --- loss: 0.864672, loss_ss: 0.670097, loss_d: 0.194576
0.4617 --- loss: 0.903244, loss_ss: 0.881324, loss_d: 0.021920
0.5002 --- loss: 1.067177, loss_ss: 0.959289, loss_d: 0.107887
0.5387 --- loss: 0.812628, loss_ss: 0.788370, loss_d: 0.024258
0.5771 --- loss: 0.730923, loss_ss: 0.676945, loss_d: 0.053978
0.6156 --- loss: 0.767068, loss_ss: 0.747638, loss_d: 0.019431
0.6541 --- loss: 0.706958, loss_ss: 0.689874, loss_d: 0.017085
0.6926 --- loss: 1.209582, loss_ss: 1.170064, loss_d: 0.039518
0.7311 --- loss: 0.888259, loss_ss: 0.778141, loss_d: 0.110118
0.7695 --- loss: 0.643071, loss_ss: 0.623342, loss_d: 0.019729
0.8080 --- loss: 0.775371, loss_ss: 0.728023, loss_d: 0.047349
0.8465 --- loss: 0.853234, loss_ss: 0.837247, loss_d: 0.015987
0.8850 --- loss: 0.806169, loss_ss: 0.752046, loss_d: 0.054123
0.9234 --- loss: 0.805050, loss_ss: 0.736534, loss_d: 0.068516
0.9619 --- loss: 0.852275, loss_ss: 0.669991, loss_d: 0.182284
Epoch finished! Loss: 0.8840483201516641
Starting epoch 8/10.
0.0000 --- loss: 0.566859, loss_ss: 0.559569, loss_d: 0.007290
0.0385 --- loss: 0.575188, loss_ss: 0.559501, loss_d: 0.015687
0.0770 --- loss: 0.661848, loss_ss: 0.473782, loss_d: 0.188066
0.1154 --- loss: 0.659544, loss_ss: 0.592046, loss_d: 0.067498
0.1539 --- loss: 0.777227, loss_ss: 0.706703, loss_d: 0.070524
0.1924 --- loss: 0.771853, loss_ss: 0.718824, loss_d: 0.053030
0.2309 --- loss: 1.117272, loss_ss: 0.854433, loss_d: 0.262839
0.2693 --- loss: 0.854671, loss_ss: 0.736159, loss_d: 0.118512
0.3078 --- loss: 0.820562, loss_ss: 0.678780, loss_d: 0.141782
0.3463 --- loss: 0.997527, loss_ss: 0.700515, loss_d: 0.297012
0.3848 --- loss: 1.004482, loss_ss: 0.982636, loss_d: 0.021846
0.4232 --- loss: 0.954525, loss_ss: 0.904680, loss_d: 0.049845
0.4617 --- loss: 0.988178, loss_ss: 0.865703, loss_d: 0.122476
0.5002 --- loss: 0.861864, loss_ss: 0.846870, loss_d: 0.014994
0.5387 --- loss: 0.559078, loss_ss: 0.550182, loss_d: 0.008896
0.5771 --- loss: 1.234701, loss_ss: 0.715651, loss_d: 0.519050
0.6156 --- loss: 0.776587, loss_ss: 0.608017, loss_d: 0.168570
0.6541 --- loss: 0.542783, loss_ss: 0.463821, loss_d: 0.078962
0.6926 --- loss: 1.020205, loss_ss: 0.556334, loss_d: 0.463872
0.7311 --- loss: 0.812963, loss_ss: 0.788011, loss_d: 0.024952
0.7695 --- loss: 0.626120, loss_ss: 0.604676, loss_d: 0.021445
0.8080 --- loss: 0.677344, loss_ss: 0.651804, loss_d: 0.025540
0.8465 --- loss: 0.797897, loss_ss: 0.782144, loss_d: 0.015753
0.8850 --- loss: 0.842069, loss_ss: 0.497861, loss_d: 0.344208
0.9234 --- loss: 0.657687, loss_ss: 0.634274, loss_d: 0.023414
0.9619 --- loss: 1.524217, loss_ss: 0.604158, loss_d: 0.920059
Epoch finished! Loss: 0.8534396898332249
Starting epoch 9/10.
0.0000 --- loss: 0.753204, loss_ss: 0.745486, loss_d: 0.007719
0.0385 --- loss: 0.623730, loss_ss: 0.612419, loss_d: 0.011311
0.0770 --- loss: 0.708755, loss_ss: 0.668362, loss_d: 0.040393
0.1154 --- loss: 0.855910, loss_ss: 0.837315, loss_d: 0.018594
0.1539 --- loss: 0.960996, loss_ss: 0.823771, loss_d: 0.137225
0.1924 --- loss: 0.642674, loss_ss: 0.608059, loss_d: 0.034615
0.2309 --- loss: 0.538125, loss_ss: 0.527948, loss_d: 0.010177
0.2693 --- loss: 0.646337, loss_ss: 0.630892, loss_d: 0.015445
0.3078 --- loss: 0.918684, loss_ss: 0.892953, loss_d: 0.025731
0.3463 --- loss: 1.046191, loss_ss: 0.948480, loss_d: 0.097710
0.3848 --- loss: 0.859074, loss_ss: 0.655564, loss_d: 0.203510
0.4232 --- loss: 0.503726, loss_ss: 0.454783, loss_d: 0.048943
0.4617 --- loss: 0.774710, loss_ss: 0.529825, loss_d: 0.244885
0.5002 --- loss: 0.721543, loss_ss: 0.698790, loss_d: 0.022753
0.5387 --- loss: 0.896675, loss_ss: 0.585815, loss_d: 0.310859
0.5771 --- loss: 0.897616, loss_ss: 0.872466, loss_d: 0.025150
0.6156 --- loss: 0.738860, loss_ss: 0.732803, loss_d: 0.006057
0.6541 --- loss: 0.985605, loss_ss: 0.687558, loss_d: 0.298047
0.6926 --- loss: 0.565519, loss_ss: 0.542708, loss_d: 0.022811
0.7311 --- loss: 0.982117, loss_ss: 0.931025, loss_d: 0.051092
0.7695 --- loss: 0.747418, loss_ss: 0.707469, loss_d: 0.039949
0.8080 --- loss: 0.872048, loss_ss: 0.850102, loss_d: 0.021947
0.8465 --- loss: 0.785759, loss_ss: 0.745835, loss_d: 0.039924
0.8850 --- loss: 1.028089, loss_ss: 1.020820, loss_d: 0.007270
0.9234 --- loss: 0.710047, loss_ss: 0.698468, loss_d: 0.011578
0.9619 --- loss: 0.803463, loss_ss: 0.799067, loss_d: 0.004395
Epoch finished! Loss: 0.8263699000406449
Starting epoch 10/10.
0.0000 --- loss: 1.197635, loss_ss: 1.186485, loss_d: 0.011150
0.0385 --- loss: 0.546018, loss_ss: 0.478481, loss_d: 0.067537
0.0770 --- loss: 1.009447, loss_ss: 0.983389, loss_d: 0.026058
0.1154 --- loss: 1.262834, loss_ss: 0.772274, loss_d: 0.490560
0.1539 --- loss: 0.840454, loss_ss: 0.664987, loss_d: 0.175467
0.1924 --- loss: 1.210093, loss_ss: 1.163425, loss_d: 0.046667
0.2309 --- loss: 0.693209, loss_ss: 0.553492, loss_d: 0.139718
0.2693 --- loss: 0.881492, loss_ss: 0.799922, loss_d: 0.081570
0.3078 --- loss: 1.657030, loss_ss: 1.584137, loss_d: 0.072893
0.3463 --- loss: 0.785560, loss_ss: 0.621153, loss_d: 0.164406
0.3848 --- loss: 0.843646, loss_ss: 0.834150, loss_d: 0.009496
0.4232 --- loss: 0.697708, loss_ss: 0.689395, loss_d: 0.008313
0.4617 --- loss: 0.813723, loss_ss: 0.761252, loss_d: 0.052471
0.5002 --- loss: 0.748001, loss_ss: 0.701350, loss_d: 0.046651
0.5387 --- loss: 0.750656, loss_ss: 0.735711, loss_d: 0.014945
0.5771 --- loss: 0.949252, loss_ss: 0.802380, loss_d: 0.146872
0.6156 --- loss: 1.330957, loss_ss: 0.653954, loss_d: 0.677003
0.6541 --- loss: 0.868836, loss_ss: 0.844084, loss_d: 0.024751
0.6926 --- loss: 0.892862, loss_ss: 0.883026, loss_d: 0.009836
0.7311 --- loss: 0.858262, loss_ss: 0.845355, loss_d: 0.012907
0.7695 --- loss: 0.595892, loss_ss: 0.590380, loss_d: 0.005512
0.8080 --- loss: 0.579576, loss_ss: 0.559592, loss_d: 0.019984
0.8465 --- loss: 0.777660, loss_ss: 0.595862, loss_d: 0.181798
0.8850 --- loss: 0.722241, loss_ss: 0.684153, loss_d: 0.038088
0.9234 --- loss: 0.587900, loss_ss: 0.568491, loss_d: 0.019409
0.9619 --- loss: 0.787988, loss_ss: 0.744031, loss_d: 0.043957
Epoch finished! Loss: 0.8413747237225757
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.756201881950385
             precision    recall  f1-score   support

        0.0       0.75      0.81      0.78       267
        1.0       0.40      0.35      0.37       152
        2.0       0.80      0.89      0.84       496
        3.0       0.97      0.42      0.58        74
        4.0       0.86      0.81      0.83       180

avg / total       0.76      0.76      0.75      1169
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.56  80.90   92.13  75.26     77.98
1  84.86  34.87   92.33  40.46     37.46
2  85.54  88.51   83.36  79.67     83.86
3  96.24  41.89   99.91  96.88     58.49
4  95.04  80.56   97.67  86.31     83.33
Total accuracy: 75.62%
Average sen: 65.34%
Average spec: 93.08%
Macro f1-score: 68.22%
Diagnosis acc on 15mins: 1.0
[0.99965799 0.99999607 0.99999976 0.99998355 0.99999928 1.
 1.         1.         1.         1.         1.         0.99999988
 1.         1.         1.         1.         1.         0.99999988
 1.         1.         1.         1.         1.         1.
 0.99999416 0.99996281 0.99998212 0.99999988 1.         1.
 1.         1.         1.         0.99994504 0.99999344 0.99999988
 1.         1.         1.        ]
pred: 0.9999875319309723, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.574986, loss_ss: 1.921176, loss_d: 0.653810
0.0384 --- loss: 2.084751, loss_ss: 1.531577, loss_d: 0.553173
0.0768 --- loss: 2.427824, loss_ss: 1.800055, loss_d: 0.627769
0.1152 --- loss: 2.144054, loss_ss: 1.628482, loss_d: 0.515572
0.1536 --- loss: 2.333190, loss_ss: 1.542157, loss_d: 0.791033
0.1920 --- loss: 2.563414, loss_ss: 1.670708, loss_d: 0.892707
0.2304 --- loss: 2.112129, loss_ss: 1.690627, loss_d: 0.421502
0.2688 --- loss: 2.013901, loss_ss: 1.514082, loss_d: 0.499820
0.3072 --- loss: 2.205618, loss_ss: 1.476506, loss_d: 0.729112
0.3456 --- loss: 1.969399, loss_ss: 1.621859, loss_d: 0.347540
0.3840 --- loss: 1.971820, loss_ss: 1.495130, loss_d: 0.476690
0.4224 --- loss: 1.718519, loss_ss: 1.450585, loss_d: 0.267934
0.4608 --- loss: 2.276417, loss_ss: 1.384891, loss_d: 0.891526
0.4992 --- loss: 1.943153, loss_ss: 1.314759, loss_d: 0.628393
0.5376 --- loss: 1.801699, loss_ss: 1.297066, loss_d: 0.504632
0.5760 --- loss: 1.982325, loss_ss: 1.425327, loss_d: 0.556998
0.6144 --- loss: 1.759459, loss_ss: 1.117561, loss_d: 0.641898
0.6528 --- loss: 2.081012, loss_ss: 1.413657, loss_d: 0.667355
0.6912 --- loss: 1.829479, loss_ss: 1.215495, loss_d: 0.613983
0.7296 --- loss: 1.727459, loss_ss: 1.356513, loss_d: 0.370946
0.7680 --- loss: 1.815186, loss_ss: 1.089040, loss_d: 0.726146
0.8065 --- loss: 1.719322, loss_ss: 1.144931, loss_d: 0.574391
0.8449 --- loss: 1.529871, loss_ss: 1.233750, loss_d: 0.296122
0.8833 --- loss: 1.549012, loss_ss: 1.233452, loss_d: 0.315560
0.9217 --- loss: 1.481543, loss_ss: 1.137009, loss_d: 0.344534
0.9601 --- loss: 1.701224, loss_ss: 1.375271, loss_d: 0.325953
0.9985 --- loss: 1.607717, loss_ss: 1.224189, loss_d: 0.383528
Epoch finished! Loss: 1.9496526589760415
Starting epoch 2/10.
0.0000 --- loss: 1.254872, loss_ss: 1.010226, loss_d: 0.244645
0.0384 --- loss: 1.485557, loss_ss: 1.155431, loss_d: 0.330126
0.0768 --- loss: 1.770181, loss_ss: 1.428817, loss_d: 0.341364
0.1152 --- loss: 1.563865, loss_ss: 1.086557, loss_d: 0.477308
0.1536 --- loss: 1.494692, loss_ss: 1.010709, loss_d: 0.483984
0.1920 --- loss: 1.426782, loss_ss: 1.163949, loss_d: 0.262833
0.2304 --- loss: 1.468480, loss_ss: 1.065237, loss_d: 0.403242
0.2688 --- loss: 1.420437, loss_ss: 0.832663, loss_d: 0.587773
0.3072 --- loss: 1.370589, loss_ss: 1.024342, loss_d: 0.346248
0.3456 --- loss: 1.414212, loss_ss: 1.117352, loss_d: 0.296860
0.3840 --- loss: 1.220091, loss_ss: 0.981925, loss_d: 0.238165
0.4224 --- loss: 1.334970, loss_ss: 0.950092, loss_d: 0.384877
0.4608 --- loss: 1.373930, loss_ss: 1.074650, loss_d: 0.299280
0.4992 --- loss: 1.406227, loss_ss: 1.058292, loss_d: 0.347935
0.5376 --- loss: 1.250224, loss_ss: 1.115864, loss_d: 0.134360
0.5760 --- loss: 1.269292, loss_ss: 0.826031, loss_d: 0.443261
0.6144 --- loss: 1.561950, loss_ss: 1.064656, loss_d: 0.497294
0.6528 --- loss: 1.181935, loss_ss: 1.001290, loss_d: 0.180645
0.6912 --- loss: 1.584133, loss_ss: 0.921122, loss_d: 0.663011
0.7296 --- loss: 1.401446, loss_ss: 1.323227, loss_d: 0.078218
0.7680 --- loss: 1.158388, loss_ss: 0.890665, loss_d: 0.267722
0.8065 --- loss: 1.008218, loss_ss: 0.874443, loss_d: 0.133775
0.8449 --- loss: 1.276430, loss_ss: 1.191350, loss_d: 0.085080
0.8833 --- loss: 1.100873, loss_ss: 0.987910, loss_d: 0.112963
0.9217 --- loss: 1.425525, loss_ss: 1.165889, loss_d: 0.259637
0.9601 --- loss: 1.057049, loss_ss: 0.929971, loss_d: 0.127078
0.9985 --- loss: 1.513811, loss_ss: 1.168118, loss_d: 0.345693
Epoch finished! Loss: 1.385740540119318
Starting epoch 3/10.
0.0000 --- loss: 0.939147, loss_ss: 0.732219, loss_d: 0.206928
0.0384 --- loss: 1.200547, loss_ss: 0.910090, loss_d: 0.290457
0.0768 --- loss: 1.071008, loss_ss: 0.837387, loss_d: 0.233621
0.1152 --- loss: 1.167263, loss_ss: 0.907815, loss_d: 0.259448
0.1536 --- loss: 1.086580, loss_ss: 0.964275, loss_d: 0.122305
0.1920 --- loss: 1.265141, loss_ss: 1.039545, loss_d: 0.225596
0.2304 --- loss: 1.292516, loss_ss: 0.901496, loss_d: 0.391020
0.2688 --- loss: 0.985362, loss_ss: 0.921921, loss_d: 0.063441
0.3072 --- loss: 0.962319, loss_ss: 0.766913, loss_d: 0.195406
0.3456 --- loss: 1.069484, loss_ss: 0.972363, loss_d: 0.097120
0.3840 --- loss: 1.676814, loss_ss: 1.023926, loss_d: 0.652888
0.4224 --- loss: 1.560302, loss_ss: 1.059672, loss_d: 0.500630
0.4608 --- loss: 1.642762, loss_ss: 1.107340, loss_d: 0.535422
0.4992 --- loss: 1.024279, loss_ss: 0.789118, loss_d: 0.235161
0.5376 --- loss: 1.383888, loss_ss: 0.901532, loss_d: 0.482356
0.5760 --- loss: 1.079907, loss_ss: 0.838942, loss_d: 0.240965
0.6144 --- loss: 1.269901, loss_ss: 0.916533, loss_d: 0.353368
0.6528 --- loss: 1.292821, loss_ss: 0.856274, loss_d: 0.436547
0.6912 --- loss: 1.208761, loss_ss: 1.019533, loss_d: 0.189229
0.7296 --- loss: 1.003950, loss_ss: 0.858201, loss_d: 0.145749
0.7680 --- loss: 1.113126, loss_ss: 0.694728, loss_d: 0.418398
0.8065 --- loss: 1.120603, loss_ss: 1.038560, loss_d: 0.082044
0.8449 --- loss: 1.176249, loss_ss: 0.724693, loss_d: 0.451557
0.8833 --- loss: 0.966644, loss_ss: 0.873141, loss_d: 0.093503
0.9217 --- loss: 0.899868, loss_ss: 0.677459, loss_d: 0.222409
0.9601 --- loss: 1.007928, loss_ss: 0.865282, loss_d: 0.142645
0.9985 --- loss: 0.988093, loss_ss: 0.846337, loss_d: 0.141757
Epoch finished! Loss: 1.177374397103603
Starting epoch 4/10.
0.0000 --- loss: 1.460506, loss_ss: 1.148706, loss_d: 0.311799
0.0384 --- loss: 0.913085, loss_ss: 0.751559, loss_d: 0.161526
0.0768 --- loss: 0.867180, loss_ss: 0.725750, loss_d: 0.141430
0.1152 --- loss: 1.236982, loss_ss: 1.202219, loss_d: 0.034763
0.1536 --- loss: 0.709556, loss_ss: 0.654907, loss_d: 0.054649
0.1920 --- loss: 1.281343, loss_ss: 1.140480, loss_d: 0.140863
0.2304 --- loss: 0.770282, loss_ss: 0.669932, loss_d: 0.100349
0.2688 --- loss: 1.068552, loss_ss: 1.011787, loss_d: 0.056766
0.3072 --- loss: 0.893662, loss_ss: 0.788481, loss_d: 0.105180
0.3456 --- loss: 1.370013, loss_ss: 0.826730, loss_d: 0.543283
0.3840 --- loss: 1.172845, loss_ss: 0.963611, loss_d: 0.209233
0.4224 --- loss: 1.225679, loss_ss: 0.838356, loss_d: 0.387323
0.4608 --- loss: 0.774339, loss_ss: 0.706610, loss_d: 0.067729
0.4992 --- loss: 0.730474, loss_ss: 0.628055, loss_d: 0.102419
0.5376 --- loss: 1.084166, loss_ss: 0.759352, loss_d: 0.324815
0.5760 --- loss: 0.880981, loss_ss: 0.731681, loss_d: 0.149300
0.6144 --- loss: 1.451625, loss_ss: 1.113403, loss_d: 0.338222
0.6528 --- loss: 1.120987, loss_ss: 0.856434, loss_d: 0.264553
0.6912 --- loss: 1.098703, loss_ss: 0.990742, loss_d: 0.107961
0.7296 --- loss: 1.039533, loss_ss: 0.775399, loss_d: 0.264135
0.7680 --- loss: 1.293477, loss_ss: 0.946915, loss_d: 0.346562
0.8065 --- loss: 1.216799, loss_ss: 0.887486, loss_d: 0.329313
0.8449 --- loss: 0.737297, loss_ss: 0.651885, loss_d: 0.085412
0.8833 --- loss: 1.101339, loss_ss: 0.879322, loss_d: 0.222016
0.9217 --- loss: 1.047487, loss_ss: 0.719314, loss_d: 0.328174
0.9601 --- loss: 1.293550, loss_ss: 1.161399, loss_d: 0.132151
0.9985 --- loss: 1.484128, loss_ss: 0.942226, loss_d: 0.541903
Epoch finished! Loss: 1.0682914082820598
Starting epoch 5/10.
0.0000 --- loss: 0.912406, loss_ss: 0.828836, loss_d: 0.083570
0.0384 --- loss: 0.990120, loss_ss: 0.894133, loss_d: 0.095988
0.0768 --- loss: 1.120950, loss_ss: 1.065406, loss_d: 0.055545
0.1152 --- loss: 0.843948, loss_ss: 0.708598, loss_d: 0.135350
0.1536 --- loss: 1.119178, loss_ss: 0.821852, loss_d: 0.297326
0.1920 --- loss: 0.767339, loss_ss: 0.669992, loss_d: 0.097348
0.2304 --- loss: 0.778011, loss_ss: 0.739203, loss_d: 0.038808
0.2688 --- loss: 1.547261, loss_ss: 0.796237, loss_d: 0.751024
0.3072 --- loss: 1.563400, loss_ss: 1.113435, loss_d: 0.449965
0.3456 --- loss: 1.207082, loss_ss: 1.170964, loss_d: 0.036118
0.3840 --- loss: 1.002457, loss_ss: 0.879495, loss_d: 0.122962
0.4224 --- loss: 1.009042, loss_ss: 0.804954, loss_d: 0.204088
0.4608 --- loss: 0.972810, loss_ss: 0.857958, loss_d: 0.114851
0.4992 --- loss: 1.225718, loss_ss: 1.068208, loss_d: 0.157510
0.5376 --- loss: 0.733177, loss_ss: 0.654299, loss_d: 0.078877
0.5760 --- loss: 0.924338, loss_ss: 0.712151, loss_d: 0.212187
0.6144 --- loss: 1.174977, loss_ss: 0.801046, loss_d: 0.373931
0.6528 --- loss: 0.974192, loss_ss: 0.827341, loss_d: 0.146851
0.6912 --- loss: 1.405134, loss_ss: 0.862702, loss_d: 0.542433
0.7296 --- loss: 0.716969, loss_ss: 0.691214, loss_d: 0.025754
0.7680 --- loss: 0.899998, loss_ss: 0.879000, loss_d: 0.020997
0.8065 --- loss: 0.900747, loss_ss: 0.862452, loss_d: 0.038295
0.8449 --- loss: 1.007547, loss_ss: 0.700779, loss_d: 0.306769
0.8833 --- loss: 0.834523, loss_ss: 0.746817, loss_d: 0.087706
0.9217 --- loss: 0.681159, loss_ss: 0.611236, loss_d: 0.069922
0.9601 --- loss: 0.859963, loss_ss: 0.774311, loss_d: 0.085652
0.9985 --- loss: 1.983375, loss_ss: 0.839351, loss_d: 1.144024
Epoch finished! Loss: 0.9760796624880571
Starting epoch 6/10.
0.0000 --- loss: 0.930302, loss_ss: 0.636858, loss_d: 0.293444
0.0384 --- loss: 1.126046, loss_ss: 0.824535, loss_d: 0.301510
0.0768 --- loss: 1.176672, loss_ss: 1.029618, loss_d: 0.147055
0.1152 --- loss: 0.949997, loss_ss: 0.731144, loss_d: 0.218852
0.1536 --- loss: 0.963235, loss_ss: 0.781269, loss_d: 0.181966
0.1920 --- loss: 0.887930, loss_ss: 0.819112, loss_d: 0.068818
0.2304 --- loss: 0.912454, loss_ss: 0.823686, loss_d: 0.088768
0.2688 --- loss: 1.214969, loss_ss: 1.074008, loss_d: 0.140961
0.3072 --- loss: 0.961089, loss_ss: 0.928193, loss_d: 0.032896
0.3456 --- loss: 0.535326, loss_ss: 0.495191, loss_d: 0.040136
0.3840 --- loss: 0.902330, loss_ss: 0.849106, loss_d: 0.053225
0.4224 --- loss: 0.845802, loss_ss: 0.740660, loss_d: 0.105142
0.4608 --- loss: 0.817893, loss_ss: 0.784554, loss_d: 0.033339
0.4992 --- loss: 0.945618, loss_ss: 0.731301, loss_d: 0.214318
0.5376 --- loss: 1.225261, loss_ss: 0.914069, loss_d: 0.311192
0.5760 --- loss: 0.909416, loss_ss: 0.565989, loss_d: 0.343427
0.6144 --- loss: 0.765680, loss_ss: 0.660229, loss_d: 0.105451
0.6528 --- loss: 0.813050, loss_ss: 0.787519, loss_d: 0.025531
0.6912 --- loss: 1.005800, loss_ss: 0.661252, loss_d: 0.344548
0.7296 --- loss: 0.703569, loss_ss: 0.580298, loss_d: 0.123271
0.7680 --- loss: 0.740048, loss_ss: 0.706687, loss_d: 0.033361
0.8065 --- loss: 1.066592, loss_ss: 0.907303, loss_d: 0.159289
0.8449 --- loss: 0.888684, loss_ss: 0.765491, loss_d: 0.123193
0.8833 --- loss: 0.626721, loss_ss: 0.549812, loss_d: 0.076910
0.9217 --- loss: 0.634502, loss_ss: 0.600969, loss_d: 0.033533
0.9601 --- loss: 0.849823, loss_ss: 0.758802, loss_d: 0.091021
0.9985 --- loss: 1.119122, loss_ss: 1.095240, loss_d: 0.023883
Epoch finished! Loss: 0.9390150435842001
Starting epoch 7/10.
0.0000 --- loss: 0.855572, loss_ss: 0.709006, loss_d: 0.146566
0.0384 --- loss: 0.671301, loss_ss: 0.565654, loss_d: 0.105646
0.0768 --- loss: 0.909209, loss_ss: 0.855914, loss_d: 0.053295
0.1152 --- loss: 0.751532, loss_ss: 0.678629, loss_d: 0.072904
0.1536 --- loss: 0.757505, loss_ss: 0.693236, loss_d: 0.064269
0.1920 --- loss: 1.434365, loss_ss: 1.112741, loss_d: 0.321624
0.2304 --- loss: 0.933083, loss_ss: 0.772559, loss_d: 0.160524
0.2688 --- loss: 1.032827, loss_ss: 0.978647, loss_d: 0.054180
0.3072 --- loss: 0.697921, loss_ss: 0.582726, loss_d: 0.115195
0.3456 --- loss: 0.826856, loss_ss: 0.775746, loss_d: 0.051110
0.3840 --- loss: 0.587314, loss_ss: 0.579097, loss_d: 0.008217
0.4224 --- loss: 0.754198, loss_ss: 0.540346, loss_d: 0.213852
0.4608 --- loss: 0.720389, loss_ss: 0.591818, loss_d: 0.128570
0.4992 --- loss: 1.088917, loss_ss: 1.072399, loss_d: 0.016517
0.5376 --- loss: 1.248302, loss_ss: 1.154637, loss_d: 0.093664
0.5760 --- loss: 0.687239, loss_ss: 0.557226, loss_d: 0.130013
0.6144 --- loss: 1.045050, loss_ss: 0.590440, loss_d: 0.454610
0.6528 --- loss: 0.776682, loss_ss: 0.684877, loss_d: 0.091805
0.6912 --- loss: 0.733183, loss_ss: 0.672339, loss_d: 0.060844
0.7296 --- loss: 0.759762, loss_ss: 0.729729, loss_d: 0.030034
0.7680 --- loss: 1.188905, loss_ss: 0.817635, loss_d: 0.371270
0.8065 --- loss: 0.703330, loss_ss: 0.613814, loss_d: 0.089516
0.8449 --- loss: 0.875351, loss_ss: 0.487273, loss_d: 0.388078
0.8833 --- loss: 0.831816, loss_ss: 0.550296, loss_d: 0.281519
0.9217 --- loss: 0.717475, loss_ss: 0.671806, loss_d: 0.045669
0.9601 --- loss: 1.452735, loss_ss: 0.801517, loss_d: 0.651218
0.9985 --- loss: 2.004753, loss_ss: 1.525762, loss_d: 0.478990
Epoch finished! Loss: 0.9065062489647132
Starting epoch 8/10.
0.0000 --- loss: 0.678273, loss_ss: 0.657826, loss_d: 0.020447
0.0384 --- loss: 0.859687, loss_ss: 0.729185, loss_d: 0.130502
0.0768 --- loss: 0.765897, loss_ss: 0.599557, loss_d: 0.166340
0.1152 --- loss: 1.080379, loss_ss: 1.070773, loss_d: 0.009606
0.1536 --- loss: 0.859016, loss_ss: 0.843002, loss_d: 0.016014
0.1920 --- loss: 0.891432, loss_ss: 0.857228, loss_d: 0.034204
0.2304 --- loss: 0.962375, loss_ss: 0.950269, loss_d: 0.012106
0.2688 --- loss: 0.990692, loss_ss: 0.555557, loss_d: 0.435134
0.3072 --- loss: 0.579982, loss_ss: 0.479755, loss_d: 0.100227
0.3456 --- loss: 0.708508, loss_ss: 0.639077, loss_d: 0.069431
0.3840 --- loss: 1.306098, loss_ss: 0.820771, loss_d: 0.485326
0.4224 --- loss: 0.693974, loss_ss: 0.676792, loss_d: 0.017183
0.4608 --- loss: 0.560714, loss_ss: 0.552126, loss_d: 0.008588
0.4992 --- loss: 0.582101, loss_ss: 0.562346, loss_d: 0.019755
0.5376 --- loss: 1.017150, loss_ss: 0.954603, loss_d: 0.062547
0.5760 --- loss: 0.688980, loss_ss: 0.684985, loss_d: 0.003995
0.6144 --- loss: 0.611285, loss_ss: 0.594227, loss_d: 0.017058
0.6528 --- loss: 0.828291, loss_ss: 0.759811, loss_d: 0.068480
0.6912 --- loss: 0.767481, loss_ss: 0.687016, loss_d: 0.080465
0.7296 --- loss: 0.799927, loss_ss: 0.775305, loss_d: 0.024623
0.7680 --- loss: 0.998084, loss_ss: 0.956055, loss_d: 0.042028
0.8065 --- loss: 1.409529, loss_ss: 0.823856, loss_d: 0.585673
0.8449 --- loss: 0.774365, loss_ss: 0.590539, loss_d: 0.183826
0.8833 --- loss: 0.660826, loss_ss: 0.650103, loss_d: 0.010723
0.9217 --- loss: 0.891687, loss_ss: 0.841229, loss_d: 0.050458
0.9601 --- loss: 0.665549, loss_ss: 0.620901, loss_d: 0.044648
0.9985 --- loss: 0.802785, loss_ss: 0.695819, loss_d: 0.106966
Epoch finished! Loss: 0.8804765519041281
Starting epoch 9/10.
0.0000 --- loss: 0.724185, loss_ss: 0.705894, loss_d: 0.018292
0.0384 --- loss: 0.638576, loss_ss: 0.550784, loss_d: 0.087792
0.0768 --- loss: 1.145089, loss_ss: 1.067340, loss_d: 0.077749
0.1152 --- loss: 0.873350, loss_ss: 0.868967, loss_d: 0.004383
0.1536 --- loss: 0.847919, loss_ss: 0.805668, loss_d: 0.042251
0.1920 --- loss: 0.834269, loss_ss: 0.782692, loss_d: 0.051577
0.2304 --- loss: 0.943051, loss_ss: 0.936025, loss_d: 0.007026
0.2688 --- loss: 0.558695, loss_ss: 0.525071, loss_d: 0.033624
0.3072 --- loss: 0.713811, loss_ss: 0.692652, loss_d: 0.021159
0.3456 --- loss: 0.688211, loss_ss: 0.663217, loss_d: 0.024994
0.3840 --- loss: 0.883531, loss_ss: 0.881646, loss_d: 0.001885
0.4224 --- loss: 0.819572, loss_ss: 0.763633, loss_d: 0.055939
0.4608 --- loss: 0.619198, loss_ss: 0.610087, loss_d: 0.009112
0.4992 --- loss: 0.837829, loss_ss: 0.770154, loss_d: 0.067675
0.5376 --- loss: 0.855066, loss_ss: 0.679216, loss_d: 0.175849
0.5760 --- loss: 1.277447, loss_ss: 0.997378, loss_d: 0.280070
0.6144 --- loss: 0.749983, loss_ss: 0.741174, loss_d: 0.008809
0.6528 --- loss: 1.074064, loss_ss: 0.902668, loss_d: 0.171397
0.6912 --- loss: 1.321254, loss_ss: 0.841298, loss_d: 0.479957
0.7296 --- loss: 1.267029, loss_ss: 1.118208, loss_d: 0.148822
0.7680 --- loss: 0.928098, loss_ss: 0.788735, loss_d: 0.139364
0.8065 --- loss: 0.850824, loss_ss: 0.844994, loss_d: 0.005829
0.8449 --- loss: 0.578780, loss_ss: 0.567499, loss_d: 0.011281
0.8833 --- loss: 0.802882, loss_ss: 0.608871, loss_d: 0.194011
0.9217 --- loss: 1.007643, loss_ss: 0.991701, loss_d: 0.015943
0.9601 --- loss: 0.930127, loss_ss: 0.910873, loss_d: 0.019254
0.9985 --- loss: 0.480875, loss_ss: 0.456514, loss_d: 0.024361
Epoch finished! Loss: 0.8391097899812918
Starting epoch 10/10.
0.0000 --- loss: 0.757623, loss_ss: 0.728153, loss_d: 0.029470
0.0384 --- loss: 0.770881, loss_ss: 0.753644, loss_d: 0.017237
0.0768 --- loss: 0.486037, loss_ss: 0.413986, loss_d: 0.072051
0.1152 --- loss: 0.694905, loss_ss: 0.671124, loss_d: 0.023781
0.1536 --- loss: 0.992576, loss_ss: 0.948648, loss_d: 0.043928
0.1920 --- loss: 0.789670, loss_ss: 0.711567, loss_d: 0.078103
0.2304 --- loss: 1.129356, loss_ss: 0.715618, loss_d: 0.413738
0.2688 --- loss: 0.839682, loss_ss: 0.771166, loss_d: 0.068517
0.3072 --- loss: 0.487908, loss_ss: 0.480378, loss_d: 0.007530
0.3456 --- loss: 0.767124, loss_ss: 0.730021, loss_d: 0.037103
0.3840 --- loss: 0.627607, loss_ss: 0.602959, loss_d: 0.024648
0.4224 --- loss: 0.650015, loss_ss: 0.579036, loss_d: 0.070980
0.4608 --- loss: 0.635058, loss_ss: 0.508151, loss_d: 0.126906
0.4992 --- loss: 0.545744, loss_ss: 0.543911, loss_d: 0.001834
0.5376 --- loss: 0.794443, loss_ss: 0.658230, loss_d: 0.136213
0.5760 --- loss: 0.874568, loss_ss: 0.819873, loss_d: 0.054695
0.6144 --- loss: 0.815184, loss_ss: 0.783019, loss_d: 0.032165
0.6528 --- loss: 1.061842, loss_ss: 1.045317, loss_d: 0.016525
0.6912 --- loss: 0.841396, loss_ss: 0.812934, loss_d: 0.028461
0.7296 --- loss: 0.770723, loss_ss: 0.763747, loss_d: 0.006976
0.7680 --- loss: 0.488459, loss_ss: 0.485389, loss_d: 0.003070
0.8065 --- loss: 0.561614, loss_ss: 0.551888, loss_d: 0.009726
0.8449 --- loss: 0.715322, loss_ss: 0.683006, loss_d: 0.032317
0.8833 --- loss: 0.812337, loss_ss: 0.787084, loss_d: 0.025253
0.9217 --- loss: 0.970633, loss_ss: 0.958450, loss_d: 0.012183
0.9601 --- loss: 1.021560, loss_ss: 1.001099, loss_d: 0.020461
0.9985 --- loss: 1.674163, loss_ss: 1.670009, loss_d: 0.004154
Epoch finished! Loss: 0.8234987751795695
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6225490196078431
             precision    recall  f1-score   support

        0.0       0.90      0.60      0.72       105
        1.0       0.00      0.00      0.00        44
        2.0       0.51      0.96      0.67       317
        3.0       1.00      0.48      0.65       258
        4.0       0.75      0.49      0.59       296

avg / total       0.72      0.62      0.62      1020
 


====== chp058-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  95.20  60.00   99.23   90.00     72.00
1  91.96   0.00   96.11    0.00      0.00
2  70.20  95.90   58.61   51.09     66.67
3  86.86  48.06  100.00  100.00     64.92
4  80.29  48.65   93.23   74.61     58.90
Total accuracy: 62.25%
Average sen: 50.52%
Average spec: 89.44%
Macro f1-score: 52.50%
Diagnosis acc on 15mins: 1.0
[0.9999969  0.99999964 0.99999952 0.99999642 0.99998415 0.99995077
 0.99946278 0.99999511 0.99999988 1.         0.99999917 0.99997556
 0.99989223 0.99999726 0.99998593 0.99968374 0.99999297 0.9999963
 0.9999963  0.99998605 0.99999976 0.99999988 0.99998069 0.99999857
 0.99998915 0.99988627 0.99993813 0.99991179 0.9999994  0.99999332
 0.99999523 0.99995565 0.99999213 0.99999976]
pred: 0.9999567778671489, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.442542, loss_ss: 1.697003, loss_d: 0.745539
0.0384 --- loss: 2.169816, loss_ss: 1.629361, loss_d: 0.540455
0.0769 --- loss: 2.082276, loss_ss: 1.480239, loss_d: 0.602036
0.1153 --- loss: 2.408589, loss_ss: 1.488281, loss_d: 0.920307
0.1538 --- loss: 1.763448, loss_ss: 1.382675, loss_d: 0.380773
0.1922 --- loss: 2.451219, loss_ss: 1.404561, loss_d: 1.046658
0.2307 --- loss: 1.973362, loss_ss: 1.415477, loss_d: 0.557886
0.2691 --- loss: 1.825341, loss_ss: 1.383134, loss_d: 0.442207
0.3076 --- loss: 1.887467, loss_ss: 1.442155, loss_d: 0.445311
0.3460 --- loss: 2.038074, loss_ss: 1.382137, loss_d: 0.655937
0.3845 --- loss: 1.803704, loss_ss: 1.327008, loss_d: 0.476695
0.4229 --- loss: 1.998001, loss_ss: 1.619669, loss_d: 0.378332
0.4614 --- loss: 2.086792, loss_ss: 1.508194, loss_d: 0.578598
0.4998 --- loss: 1.734207, loss_ss: 1.319765, loss_d: 0.414442
0.5383 --- loss: 2.475283, loss_ss: 1.484580, loss_d: 0.990703
0.5767 --- loss: 1.892468, loss_ss: 1.342082, loss_d: 0.550386
0.6151 --- loss: 1.796532, loss_ss: 1.399207, loss_d: 0.397325
0.6536 --- loss: 1.680524, loss_ss: 1.383323, loss_d: 0.297201
0.6920 --- loss: 1.950299, loss_ss: 1.336445, loss_d: 0.613853
0.7305 --- loss: 1.785020, loss_ss: 1.219459, loss_d: 0.565561
0.7689 --- loss: 1.989936, loss_ss: 1.387256, loss_d: 0.602680
0.8074 --- loss: 1.716412, loss_ss: 1.227735, loss_d: 0.488677
0.8458 --- loss: 1.566033, loss_ss: 1.049954, loss_d: 0.516079
0.8843 --- loss: 1.852954, loss_ss: 1.222143, loss_d: 0.630811
0.9227 --- loss: 1.609443, loss_ss: 1.237305, loss_d: 0.372138
0.9612 --- loss: 1.570291, loss_ss: 1.164494, loss_d: 0.405797
0.9996 --- loss: 1.676939, loss_ss: 1.497435, loss_d: 0.179504
Epoch finished! Loss: 1.9629755932551163
Starting epoch 2/10.
0.0000 --- loss: 1.609249, loss_ss: 1.220865, loss_d: 0.388384
0.0384 --- loss: 1.637513, loss_ss: 1.177037, loss_d: 0.460476
0.0769 --- loss: 1.459623, loss_ss: 1.236148, loss_d: 0.223475
0.1153 --- loss: 1.637556, loss_ss: 1.329760, loss_d: 0.307797
0.1538 --- loss: 1.415304, loss_ss: 0.997622, loss_d: 0.417682
0.1922 --- loss: 1.664487, loss_ss: 1.155147, loss_d: 0.509340
0.2307 --- loss: 1.599218, loss_ss: 1.214317, loss_d: 0.384901
0.2691 --- loss: 1.316314, loss_ss: 1.051956, loss_d: 0.264358
0.3076 --- loss: 1.490942, loss_ss: 1.114746, loss_d: 0.376196
0.3460 --- loss: 1.449481, loss_ss: 1.166700, loss_d: 0.282781
0.3845 --- loss: 1.388335, loss_ss: 1.005391, loss_d: 0.382944
0.4229 --- loss: 1.752073, loss_ss: 1.450979, loss_d: 0.301094
0.4614 --- loss: 1.074418, loss_ss: 0.929110, loss_d: 0.145308
0.4998 --- loss: 1.442481, loss_ss: 1.080666, loss_d: 0.361814
0.5383 --- loss: 1.397572, loss_ss: 1.133248, loss_d: 0.264324
0.5767 --- loss: 1.291322, loss_ss: 1.095075, loss_d: 0.196247
0.6151 --- loss: 1.406820, loss_ss: 0.823035, loss_d: 0.583785
0.6536 --- loss: 1.946797, loss_ss: 1.186715, loss_d: 0.760082
0.6920 --- loss: 1.197590, loss_ss: 1.099687, loss_d: 0.097903
0.7305 --- loss: 1.924832, loss_ss: 1.159016, loss_d: 0.765816
0.7689 --- loss: 1.307389, loss_ss: 1.204032, loss_d: 0.103357
0.8074 --- loss: 1.052528, loss_ss: 0.876059, loss_d: 0.176469
0.8458 --- loss: 1.698831, loss_ss: 1.074377, loss_d: 0.624454
0.8843 --- loss: 1.433095, loss_ss: 1.052760, loss_d: 0.380335
0.9227 --- loss: 0.944869, loss_ss: 0.895532, loss_d: 0.049338
0.9612 --- loss: 1.932935, loss_ss: 1.102359, loss_d: 0.830576
0.9996 --- loss: 1.401546, loss_ss: 1.289741, loss_d: 0.111804
Epoch finished! Loss: 1.4638207045885232
Starting epoch 3/10.
0.0000 --- loss: 1.097851, loss_ss: 0.888449, loss_d: 0.209402
0.0384 --- loss: 1.488292, loss_ss: 1.001147, loss_d: 0.487145
0.0769 --- loss: 1.171405, loss_ss: 0.856713, loss_d: 0.314691
0.1153 --- loss: 1.321919, loss_ss: 1.006704, loss_d: 0.315215
0.1538 --- loss: 1.018920, loss_ss: 0.823387, loss_d: 0.195533
0.1922 --- loss: 1.133161, loss_ss: 1.022225, loss_d: 0.110935
0.2307 --- loss: 1.409655, loss_ss: 0.868763, loss_d: 0.540892
0.2691 --- loss: 1.126118, loss_ss: 0.974554, loss_d: 0.151565
0.3076 --- loss: 1.538365, loss_ss: 1.046210, loss_d: 0.492156
0.3460 --- loss: 1.284735, loss_ss: 1.132965, loss_d: 0.151771
0.3845 --- loss: 1.162299, loss_ss: 0.941809, loss_d: 0.220491
0.4229 --- loss: 1.295005, loss_ss: 0.971575, loss_d: 0.323430
0.4614 --- loss: 0.955475, loss_ss: 0.840291, loss_d: 0.115184
0.4998 --- loss: 0.869736, loss_ss: 0.824299, loss_d: 0.045437
0.5383 --- loss: 0.977592, loss_ss: 0.947118, loss_d: 0.030474
0.5767 --- loss: 0.913495, loss_ss: 0.747527, loss_d: 0.165968
0.6151 --- loss: 1.259992, loss_ss: 0.991394, loss_d: 0.268597
0.6536 --- loss: 1.088243, loss_ss: 0.888024, loss_d: 0.200220
0.6920 --- loss: 1.191653, loss_ss: 1.111936, loss_d: 0.079718
0.7305 --- loss: 1.077027, loss_ss: 0.927307, loss_d: 0.149721
0.7689 --- loss: 1.406263, loss_ss: 1.104660, loss_d: 0.301603
0.8074 --- loss: 1.308407, loss_ss: 0.881283, loss_d: 0.427124
0.8458 --- loss: 0.927301, loss_ss: 0.871636, loss_d: 0.055664
0.8843 --- loss: 1.058969, loss_ss: 0.772423, loss_d: 0.286546
0.9227 --- loss: 1.180740, loss_ss: 0.841253, loss_d: 0.339486
0.9612 --- loss: 1.319191, loss_ss: 1.093712, loss_d: 0.225479
0.9996 --- loss: 1.195088, loss_ss: 1.174455, loss_d: 0.020632
Epoch finished! Loss: 1.1717171728610993
Starting epoch 4/10.
0.0000 --- loss: 1.229085, loss_ss: 0.988668, loss_d: 0.240417
0.0384 --- loss: 1.073132, loss_ss: 0.830011, loss_d: 0.243122
0.0769 --- loss: 1.669882, loss_ss: 0.854830, loss_d: 0.815053
0.1153 --- loss: 0.851944, loss_ss: 0.782112, loss_d: 0.069832
0.1538 --- loss: 1.256772, loss_ss: 0.990300, loss_d: 0.266471
0.1922 --- loss: 1.149305, loss_ss: 1.084957, loss_d: 0.064347
0.2307 --- loss: 0.900822, loss_ss: 0.823561, loss_d: 0.077260
0.2691 --- loss: 1.148220, loss_ss: 0.944760, loss_d: 0.203459
0.3076 --- loss: 0.936202, loss_ss: 0.870736, loss_d: 0.065466
0.3460 --- loss: 1.182797, loss_ss: 1.093336, loss_d: 0.089461
0.3845 --- loss: 1.073428, loss_ss: 0.822221, loss_d: 0.251207
0.4229 --- loss: 0.999539, loss_ss: 0.742033, loss_d: 0.257506
0.4614 --- loss: 1.006942, loss_ss: 0.854945, loss_d: 0.151997
0.4998 --- loss: 0.874317, loss_ss: 0.692360, loss_d: 0.181957
0.5383 --- loss: 1.110116, loss_ss: 0.939597, loss_d: 0.170519
0.5767 --- loss: 1.436782, loss_ss: 1.274796, loss_d: 0.161987
0.6151 --- loss: 1.474740, loss_ss: 1.317784, loss_d: 0.156957
0.6536 --- loss: 1.473425, loss_ss: 1.188767, loss_d: 0.284658
0.6920 --- loss: 1.028434, loss_ss: 0.825060, loss_d: 0.203374
0.7305 --- loss: 0.759561, loss_ss: 0.623796, loss_d: 0.135764
0.7689 --- loss: 1.457365, loss_ss: 1.169190, loss_d: 0.288174
0.8074 --- loss: 1.125113, loss_ss: 0.903200, loss_d: 0.221913
0.8458 --- loss: 0.891699, loss_ss: 0.819235, loss_d: 0.072464
0.8843 --- loss: 1.249239, loss_ss: 0.669113, loss_d: 0.580125
0.9227 --- loss: 1.100673, loss_ss: 0.845272, loss_d: 0.255402
0.9612 --- loss: 0.888564, loss_ss: 0.781440, loss_d: 0.107124
0.9996 --- loss: 2.098612, loss_ss: 2.091265, loss_d: 0.007347
Epoch finished! Loss: 1.0861282059779533
Starting epoch 5/10.
0.0000 --- loss: 0.904805, loss_ss: 0.840180, loss_d: 0.064625
0.0384 --- loss: 0.863718, loss_ss: 0.606585, loss_d: 0.257133
0.0769 --- loss: 0.971681, loss_ss: 0.924328, loss_d: 0.047353
0.1153 --- loss: 1.336993, loss_ss: 1.126801, loss_d: 0.210192
0.1538 --- loss: 0.625165, loss_ss: 0.614688, loss_d: 0.010476
0.1922 --- loss: 1.219471, loss_ss: 1.168500, loss_d: 0.050972
0.2307 --- loss: 0.765548, loss_ss: 0.723621, loss_d: 0.041928
0.2691 --- loss: 0.993983, loss_ss: 0.939899, loss_d: 0.054084
0.3076 --- loss: 1.044953, loss_ss: 0.960137, loss_d: 0.084816
0.3460 --- loss: 0.826330, loss_ss: 0.709731, loss_d: 0.116599
0.3845 --- loss: 1.049587, loss_ss: 0.843923, loss_d: 0.205664
0.4229 --- loss: 1.253088, loss_ss: 0.913851, loss_d: 0.339238
0.4614 --- loss: 0.980644, loss_ss: 0.909616, loss_d: 0.071028
0.4998 --- loss: 0.601749, loss_ss: 0.492848, loss_d: 0.108901
0.5383 --- loss: 1.234700, loss_ss: 0.909509, loss_d: 0.325191
0.5767 --- loss: 0.939393, loss_ss: 0.822694, loss_d: 0.116699
0.6151 --- loss: 1.016439, loss_ss: 0.981740, loss_d: 0.034699
0.6536 --- loss: 1.062510, loss_ss: 0.830810, loss_d: 0.231700
0.6920 --- loss: 0.960011, loss_ss: 0.842107, loss_d: 0.117903
0.7305 --- loss: 1.430596, loss_ss: 0.864017, loss_d: 0.566579
0.7689 --- loss: 0.993020, loss_ss: 0.861344, loss_d: 0.131676
0.8074 --- loss: 0.727542, loss_ss: 0.600102, loss_d: 0.127439
0.8458 --- loss: 1.056882, loss_ss: 0.823442, loss_d: 0.233440
0.8843 --- loss: 0.992055, loss_ss: 0.967714, loss_d: 0.024341
0.9227 --- loss: 0.809803, loss_ss: 0.774119, loss_d: 0.035684
0.9612 --- loss: 1.123269, loss_ss: 0.745563, loss_d: 0.377706
0.9996 --- loss: 1.495158, loss_ss: 1.460824, loss_d: 0.034334
Epoch finished! Loss: 0.9812923706494845
Starting epoch 6/10.
0.0000 --- loss: 1.207092, loss_ss: 0.997455, loss_d: 0.209637
0.0384 --- loss: 0.949516, loss_ss: 0.872195, loss_d: 0.077321
0.0769 --- loss: 0.734172, loss_ss: 0.709808, loss_d: 0.024364
0.1153 --- loss: 0.931555, loss_ss: 0.844572, loss_d: 0.086983
0.1538 --- loss: 0.734681, loss_ss: 0.678724, loss_d: 0.055957
0.1922 --- loss: 0.776185, loss_ss: 0.651823, loss_d: 0.124361
0.2307 --- loss: 0.991158, loss_ss: 0.940377, loss_d: 0.050781
0.2691 --- loss: 0.852648, loss_ss: 0.775643, loss_d: 0.077005
0.3076 --- loss: 1.067410, loss_ss: 0.692116, loss_d: 0.375294
0.3460 --- loss: 1.288380, loss_ss: 1.033920, loss_d: 0.254460
0.3845 --- loss: 0.968483, loss_ss: 0.892213, loss_d: 0.076270
0.4229 --- loss: 1.161343, loss_ss: 0.766631, loss_d: 0.394712
0.4614 --- loss: 0.587558, loss_ss: 0.561518, loss_d: 0.026040
0.4998 --- loss: 1.109107, loss_ss: 0.782950, loss_d: 0.326157
0.5383 --- loss: 0.857845, loss_ss: 0.849381, loss_d: 0.008463
0.5767 --- loss: 1.120347, loss_ss: 1.062787, loss_d: 0.057560
0.6151 --- loss: 0.886428, loss_ss: 0.813598, loss_d: 0.072830
0.6536 --- loss: 0.796679, loss_ss: 0.587180, loss_d: 0.209499
0.6920 --- loss: 1.033357, loss_ss: 0.865336, loss_d: 0.168021
0.7305 --- loss: 0.768328, loss_ss: 0.693978, loss_d: 0.074350
0.7689 --- loss: 1.007758, loss_ss: 0.990421, loss_d: 0.017337
0.8074 --- loss: 0.728027, loss_ss: 0.654990, loss_d: 0.073037
0.8458 --- loss: 0.764072, loss_ss: 0.708373, loss_d: 0.055698
0.8843 --- loss: 0.873632, loss_ss: 0.733830, loss_d: 0.139803
0.9227 --- loss: 1.618737, loss_ss: 0.967082, loss_d: 0.651655
0.9612 --- loss: 1.002727, loss_ss: 0.991769, loss_d: 0.010958
0.9996 --- loss: 5.816154, loss_ss: 3.180048, loss_d: 2.636107
Epoch finished! Loss: 0.9437183813406871
Starting epoch 7/10.
0.0000 --- loss: 1.122060, loss_ss: 0.928825, loss_d: 0.193235
0.0384 --- loss: 1.220645, loss_ss: 0.976915, loss_d: 0.243730
0.0769 --- loss: 1.078089, loss_ss: 0.896944, loss_d: 0.181146
0.1153 --- loss: 0.667953, loss_ss: 0.622651, loss_d: 0.045302
0.1538 --- loss: 1.048633, loss_ss: 0.732807, loss_d: 0.315827
0.1922 --- loss: 0.985580, loss_ss: 0.889339, loss_d: 0.096240
0.2307 --- loss: 1.115902, loss_ss: 0.721584, loss_d: 0.394318
0.2691 --- loss: 0.916883, loss_ss: 0.818063, loss_d: 0.098820
0.3076 --- loss: 0.949434, loss_ss: 0.813134, loss_d: 0.136300
0.3460 --- loss: 1.177101, loss_ss: 1.003600, loss_d: 0.173501
0.3845 --- loss: 0.865909, loss_ss: 0.689808, loss_d: 0.176102
0.4229 --- loss: 0.794160, loss_ss: 0.781237, loss_d: 0.012923
0.4614 --- loss: 0.964932, loss_ss: 0.907039, loss_d: 0.057893
0.4998 --- loss: 0.865522, loss_ss: 0.738612, loss_d: 0.126910
0.5383 --- loss: 1.164810, loss_ss: 0.789421, loss_d: 0.375388
0.5767 --- loss: 0.918568, loss_ss: 0.794193, loss_d: 0.124375
0.6151 --- loss: 0.735450, loss_ss: 0.702862, loss_d: 0.032589
0.6536 --- loss: 1.010216, loss_ss: 0.997667, loss_d: 0.012549
0.6920 --- loss: 0.820041, loss_ss: 0.791447, loss_d: 0.028593
0.7305 --- loss: 0.774195, loss_ss: 0.761541, loss_d: 0.012654
0.7689 --- loss: 0.843101, loss_ss: 0.839003, loss_d: 0.004097
0.8074 --- loss: 0.618081, loss_ss: 0.544356, loss_d: 0.073725
0.8458 --- loss: 0.854014, loss_ss: 0.826333, loss_d: 0.027682
0.8843 --- loss: 0.824563, loss_ss: 0.722276, loss_d: 0.102287
0.9227 --- loss: 1.052152, loss_ss: 0.967338, loss_d: 0.084814
0.9612 --- loss: 0.636601, loss_ss: 0.612543, loss_d: 0.024057
0.9996 --- loss: 1.067260, loss_ss: 1.065991, loss_d: 0.001269
Epoch finished! Loss: 0.910819400044588
Starting epoch 8/10.
0.0000 --- loss: 0.725920, loss_ss: 0.724587, loss_d: 0.001333
0.0384 --- loss: 0.833144, loss_ss: 0.820485, loss_d: 0.012659
0.0769 --- loss: 0.730913, loss_ss: 0.669708, loss_d: 0.061205
0.1153 --- loss: 0.468976, loss_ss: 0.461288, loss_d: 0.007688
0.1538 --- loss: 0.733140, loss_ss: 0.495938, loss_d: 0.237202
0.1922 --- loss: 0.777991, loss_ss: 0.773861, loss_d: 0.004130
0.2307 --- loss: 1.056820, loss_ss: 0.962615, loss_d: 0.094205
0.2691 --- loss: 0.829222, loss_ss: 0.489975, loss_d: 0.339247
0.3076 --- loss: 0.709171, loss_ss: 0.702849, loss_d: 0.006322
0.3460 --- loss: 0.644039, loss_ss: 0.591154, loss_d: 0.052886
0.3845 --- loss: 0.805332, loss_ss: 0.799923, loss_d: 0.005409
0.4229 --- loss: 0.832941, loss_ss: 0.693134, loss_d: 0.139807
0.4614 --- loss: 0.708951, loss_ss: 0.690246, loss_d: 0.018705
0.4998 --- loss: 0.786748, loss_ss: 0.654705, loss_d: 0.132043
0.5383 --- loss: 1.358559, loss_ss: 1.351342, loss_d: 0.007217
0.5767 --- loss: 0.636398, loss_ss: 0.607158, loss_d: 0.029240
0.6151 --- loss: 0.747403, loss_ss: 0.674772, loss_d: 0.072631
0.6536 --- loss: 0.617707, loss_ss: 0.547007, loss_d: 0.070700
0.6920 --- loss: 0.962172, loss_ss: 0.796335, loss_d: 0.165837
0.7305 --- loss: 0.651613, loss_ss: 0.645444, loss_d: 0.006169
0.7689 --- loss: 0.773466, loss_ss: 0.607714, loss_d: 0.165752
0.8074 --- loss: 0.693327, loss_ss: 0.621464, loss_d: 0.071862
0.8458 --- loss: 0.989592, loss_ss: 0.752979, loss_d: 0.236613
0.8843 --- loss: 0.594094, loss_ss: 0.556830, loss_d: 0.037264
0.9227 --- loss: 0.973804, loss_ss: 0.970904, loss_d: 0.002900
0.9612 --- loss: 0.730437, loss_ss: 0.723065, loss_d: 0.007372
0.9996 --- loss: 1.782160, loss_ss: 1.758580, loss_d: 0.023580
Epoch finished! Loss: 0.8543686200792973
Starting epoch 9/10.
0.0000 --- loss: 0.663806, loss_ss: 0.615039, loss_d: 0.048768
0.0384 --- loss: 1.137838, loss_ss: 0.514680, loss_d: 0.623158
0.0769 --- loss: 0.649070, loss_ss: 0.559353, loss_d: 0.089717
0.1153 --- loss: 0.879193, loss_ss: 0.810210, loss_d: 0.068982
0.1538 --- loss: 0.820212, loss_ss: 0.792315, loss_d: 0.027898
0.1922 --- loss: 0.604426, loss_ss: 0.587312, loss_d: 0.017114
0.2307 --- loss: 0.488417, loss_ss: 0.483345, loss_d: 0.005072
0.2691 --- loss: 0.647730, loss_ss: 0.640750, loss_d: 0.006980
0.3076 --- loss: 0.607172, loss_ss: 0.604797, loss_d: 0.002376
0.3460 --- loss: 0.625533, loss_ss: 0.612919, loss_d: 0.012614
0.3845 --- loss: 0.946367, loss_ss: 0.912681, loss_d: 0.033686
0.4229 --- loss: 0.900972, loss_ss: 0.874202, loss_d: 0.026770
0.4614 --- loss: 0.552450, loss_ss: 0.541595, loss_d: 0.010855
0.4998 --- loss: 0.718581, loss_ss: 0.717160, loss_d: 0.001421
0.5383 --- loss: 0.989712, loss_ss: 0.933752, loss_d: 0.055960
0.5767 --- loss: 0.646855, loss_ss: 0.644282, loss_d: 0.002572
0.6151 --- loss: 0.730243, loss_ss: 0.661832, loss_d: 0.068411
0.6536 --- loss: 0.584125, loss_ss: 0.381773, loss_d: 0.202352
0.6920 --- loss: 1.161281, loss_ss: 1.063001, loss_d: 0.098280
0.7305 --- loss: 0.522661, loss_ss: 0.515775, loss_d: 0.006887
0.7689 --- loss: 0.703525, loss_ss: 0.652876, loss_d: 0.050650
0.8074 --- loss: 1.269079, loss_ss: 0.945649, loss_d: 0.323430
0.8458 --- loss: 1.002755, loss_ss: 0.808559, loss_d: 0.194196
0.8843 --- loss: 0.627873, loss_ss: 0.607233, loss_d: 0.020640
0.9227 --- loss: 0.537545, loss_ss: 0.533216, loss_d: 0.004329
0.9612 --- loss: 0.815150, loss_ss: 0.793142, loss_d: 0.022008
0.9996 --- loss: 0.985671, loss_ss: 0.982160, loss_d: 0.003511
Epoch finished! Loss: 0.83884239506263
Starting epoch 10/10.
0.0000 --- loss: 0.562077, loss_ss: 0.547389, loss_d: 0.014688
0.0384 --- loss: 1.163313, loss_ss: 0.980263, loss_d: 0.183050
0.0769 --- loss: 0.530966, loss_ss: 0.515229, loss_d: 0.015737
0.1153 --- loss: 0.644325, loss_ss: 0.624746, loss_d: 0.019579
0.1538 --- loss: 0.580024, loss_ss: 0.537322, loss_d: 0.042702
0.1922 --- loss: 0.971863, loss_ss: 0.953879, loss_d: 0.017984
0.2307 --- loss: 0.577790, loss_ss: 0.572684, loss_d: 0.005106
0.2691 --- loss: 0.662763, loss_ss: 0.655634, loss_d: 0.007129
0.3076 --- loss: 0.860955, loss_ss: 0.849572, loss_d: 0.011384
0.3460 --- loss: 0.779158, loss_ss: 0.756320, loss_d: 0.022838
0.3845 --- loss: 0.749199, loss_ss: 0.724614, loss_d: 0.024585
0.4229 --- loss: 0.862880, loss_ss: 0.857373, loss_d: 0.005506
0.4614 --- loss: 0.963561, loss_ss: 0.796377, loss_d: 0.167184
0.4998 --- loss: 1.009236, loss_ss: 0.967031, loss_d: 0.042204
0.5383 --- loss: 0.988133, loss_ss: 0.986079, loss_d: 0.002054
0.5767 --- loss: 1.175916, loss_ss: 1.089768, loss_d: 0.086148
0.6151 --- loss: 0.639944, loss_ss: 0.634905, loss_d: 0.005040
0.6536 --- loss: 1.080416, loss_ss: 0.771464, loss_d: 0.308952
0.6920 --- loss: 0.773048, loss_ss: 0.661335, loss_d: 0.111713
0.7305 --- loss: 0.609980, loss_ss: 0.600498, loss_d: 0.009482
0.7689 --- loss: 0.648008, loss_ss: 0.641727, loss_d: 0.006281
0.8074 --- loss: 0.889420, loss_ss: 0.601398, loss_d: 0.288022
0.8458 --- loss: 1.123298, loss_ss: 0.940639, loss_d: 0.182659
0.8843 --- loss: 0.759006, loss_ss: 0.745742, loss_d: 0.013264
0.9227 --- loss: 0.758159, loss_ss: 0.683788, loss_d: 0.074371
0.9612 --- loss: 0.561995, loss_ss: 0.529883, loss_d: 0.032112
0.9996 --- loss: 1.554631, loss_ss: 1.552190, loss_d: 0.002441
Epoch finished! Loss: 0.8303719710845213
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6855855855855856
             precision    recall  f1-score   support

        0.0       0.95      0.77      0.85       247
        1.0       0.47      0.71      0.57       254
        2.0       0.70      0.81      0.75       355
        3.0       0.84      0.55      0.67        87
        4.0       0.89      0.35      0.50       167

avg / total       0.74      0.69      0.69      1110
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.87  76.52   98.84  94.97     84.75
1  75.32  70.87   76.64  47.37     56.78
2  82.70  80.56   83.71  69.93     74.87
3  95.68  55.17   99.12  84.21     66.67
4  89.55  34.73   99.26  89.23     50.00
Total accuracy: 68.56%
Average sen: 63.57%
Average spec: 91.51%
Macro f1-score: 66.61%
Diagnosis acc on 15mins: 1.0
[1.         1.         1.         1.         1.         1.
 0.99998713 0.99999797 0.99999988 0.99999964 0.99999964 0.99999964
 1.         1.         1.         0.99999881 1.         1.
 1.         1.         1.         1.         1.         1.
 1.         0.99999475 0.99999988 0.99999976 0.99999976 0.99998569
 0.99999988 0.99999988 1.         0.99999964 0.99999976 0.99999619
 1.        ]
pred: 0.9999988626789402, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.417364, loss_ss: 1.656129, loss_d: 0.761234
0.0385 --- loss: 2.058758, loss_ss: 1.555755, loss_d: 0.503003
0.0770 --- loss: 2.485185, loss_ss: 1.803421, loss_d: 0.681764
0.1156 --- loss: 1.965886, loss_ss: 1.442050, loss_d: 0.523837
0.1541 --- loss: 2.296129, loss_ss: 1.568769, loss_d: 0.727361
0.1926 --- loss: 2.097481, loss_ss: 1.477922, loss_d: 0.619559
0.2311 --- loss: 2.158081, loss_ss: 1.505170, loss_d: 0.652911
0.2696 --- loss: 1.754253, loss_ss: 1.455581, loss_d: 0.298672
0.3082 --- loss: 2.193501, loss_ss: 1.528117, loss_d: 0.665384
0.3467 --- loss: 2.012959, loss_ss: 1.419470, loss_d: 0.593489
0.3852 --- loss: 2.426574, loss_ss: 1.628880, loss_d: 0.797695
0.4237 --- loss: 1.876596, loss_ss: 1.346610, loss_d: 0.529987
0.4622 --- loss: 1.681614, loss_ss: 1.282992, loss_d: 0.398622
0.5008 --- loss: 2.035355, loss_ss: 1.502398, loss_d: 0.532957
0.5393 --- loss: 1.919597, loss_ss: 1.406292, loss_d: 0.513305
0.5778 --- loss: 1.690271, loss_ss: 1.348160, loss_d: 0.342111
0.6163 --- loss: 1.540017, loss_ss: 1.247836, loss_d: 0.292181
0.6549 --- loss: 2.254390, loss_ss: 1.233106, loss_d: 1.021284
0.6934 --- loss: 1.516568, loss_ss: 1.115437, loss_d: 0.401131
0.7319 --- loss: 1.765105, loss_ss: 1.365011, loss_d: 0.400094
0.7704 --- loss: 2.063688, loss_ss: 1.718631, loss_d: 0.345057
0.8089 --- loss: 1.744741, loss_ss: 1.265524, loss_d: 0.479217
0.8475 --- loss: 1.828298, loss_ss: 1.332858, loss_d: 0.495441
0.8860 --- loss: 1.567624, loss_ss: 1.235002, loss_d: 0.332622
0.9245 --- loss: 1.663812, loss_ss: 1.320233, loss_d: 0.343580
0.9630 --- loss: 1.710030, loss_ss: 1.388378, loss_d: 0.321652
Epoch finished! Loss: 1.9768602912490432
Starting epoch 2/10.
0.0000 --- loss: 1.474952, loss_ss: 1.339799, loss_d: 0.135153
0.0385 --- loss: 2.340748, loss_ss: 1.166915, loss_d: 1.173833
0.0770 --- loss: 1.418792, loss_ss: 1.088330, loss_d: 0.330462
0.1156 --- loss: 2.008318, loss_ss: 1.228192, loss_d: 0.780126
0.1541 --- loss: 1.738070, loss_ss: 1.398868, loss_d: 0.339202
0.1926 --- loss: 1.396035, loss_ss: 1.166226, loss_d: 0.229809
0.2311 --- loss: 1.603433, loss_ss: 1.317897, loss_d: 0.285536
0.2696 --- loss: 1.465313, loss_ss: 1.237930, loss_d: 0.227383
0.3082 --- loss: 1.716276, loss_ss: 1.488483, loss_d: 0.227793
0.3467 --- loss: 1.751133, loss_ss: 1.183897, loss_d: 0.567236
0.3852 --- loss: 1.599414, loss_ss: 1.264951, loss_d: 0.334463
0.4237 --- loss: 1.774357, loss_ss: 1.682062, loss_d: 0.092295
0.4622 --- loss: 1.879014, loss_ss: 1.458849, loss_d: 0.420165
0.5008 --- loss: 1.687890, loss_ss: 1.404951, loss_d: 0.282939
0.5393 --- loss: 1.712971, loss_ss: 1.438654, loss_d: 0.274317
0.5778 --- loss: 1.642610, loss_ss: 1.369774, loss_d: 0.272835
0.6163 --- loss: 1.432780, loss_ss: 1.320655, loss_d: 0.112124
0.6549 --- loss: 1.362506, loss_ss: 1.021222, loss_d: 0.341284
0.6934 --- loss: 1.813681, loss_ss: 1.309034, loss_d: 0.504647
0.7319 --- loss: 1.047153, loss_ss: 0.965338, loss_d: 0.081815
0.7704 --- loss: 1.228415, loss_ss: 1.163103, loss_d: 0.065312
0.8089 --- loss: 1.038532, loss_ss: 0.933918, loss_d: 0.104614
0.8475 --- loss: 1.612925, loss_ss: 1.510850, loss_d: 0.102075
0.8860 --- loss: 1.327998, loss_ss: 1.181819, loss_d: 0.146179
0.9245 --- loss: 1.586586, loss_ss: 1.271671, loss_d: 0.314915
0.9630 --- loss: 1.104125, loss_ss: 1.010617, loss_d: 0.093508
Epoch finished! Loss: 1.5161055791331994
Starting epoch 3/10.
0.0000 --- loss: 1.196353, loss_ss: 0.930997, loss_d: 0.265356
0.0385 --- loss: 1.649791, loss_ss: 1.210164, loss_d: 0.439627
0.0770 --- loss: 1.517460, loss_ss: 1.195941, loss_d: 0.321519
0.1156 --- loss: 1.477848, loss_ss: 1.347624, loss_d: 0.130224
0.1541 --- loss: 1.472969, loss_ss: 1.283847, loss_d: 0.189122
0.1926 --- loss: 1.507232, loss_ss: 1.247743, loss_d: 0.259489
0.2311 --- loss: 1.189901, loss_ss: 1.016990, loss_d: 0.172911
0.2696 --- loss: 1.215968, loss_ss: 1.047942, loss_d: 0.168026
0.3082 --- loss: 1.375532, loss_ss: 1.068090, loss_d: 0.307442
0.3467 --- loss: 1.849925, loss_ss: 1.155931, loss_d: 0.693995
0.3852 --- loss: 1.063981, loss_ss: 0.884768, loss_d: 0.179212
0.4237 --- loss: 1.746045, loss_ss: 1.349584, loss_d: 0.396461
0.4622 --- loss: 1.415510, loss_ss: 0.988231, loss_d: 0.427279
0.5008 --- loss: 0.972827, loss_ss: 0.905215, loss_d: 0.067612
0.5393 --- loss: 1.012522, loss_ss: 0.892871, loss_d: 0.119651
0.5778 --- loss: 1.163475, loss_ss: 1.023135, loss_d: 0.140339
0.6163 --- loss: 1.216800, loss_ss: 1.150912, loss_d: 0.065888
0.6549 --- loss: 1.145163, loss_ss: 1.015895, loss_d: 0.129268
0.6934 --- loss: 1.068016, loss_ss: 1.043332, loss_d: 0.024684
0.7319 --- loss: 1.364119, loss_ss: 0.828320, loss_d: 0.535799
0.7704 --- loss: 1.195633, loss_ss: 0.849196, loss_d: 0.346437
0.8089 --- loss: 1.072096, loss_ss: 0.938383, loss_d: 0.133712
0.8475 --- loss: 1.578610, loss_ss: 1.192854, loss_d: 0.385756
0.8860 --- loss: 1.407372, loss_ss: 1.097110, loss_d: 0.310262
0.9245 --- loss: 1.195067, loss_ss: 1.047694, loss_d: 0.147373
0.9630 --- loss: 1.016121, loss_ss: 0.803097, loss_d: 0.213023
Epoch finished! Loss: 1.263902266283293
Starting epoch 4/10.
0.0000 --- loss: 1.043481, loss_ss: 0.945531, loss_d: 0.097949
0.0385 --- loss: 1.204775, loss_ss: 0.882310, loss_d: 0.322464
0.0770 --- loss: 1.116901, loss_ss: 1.009314, loss_d: 0.107587
0.1156 --- loss: 1.177107, loss_ss: 0.873852, loss_d: 0.303255
0.1541 --- loss: 1.038538, loss_ss: 0.979780, loss_d: 0.058758
0.1926 --- loss: 1.338906, loss_ss: 0.939517, loss_d: 0.399388
0.2311 --- loss: 1.358012, loss_ss: 0.968087, loss_d: 0.389924
0.2696 --- loss: 1.017312, loss_ss: 0.857288, loss_d: 0.160025
0.3082 --- loss: 1.058182, loss_ss: 0.724871, loss_d: 0.333311
0.3467 --- loss: 1.231021, loss_ss: 0.670442, loss_d: 0.560580
0.3852 --- loss: 1.299465, loss_ss: 1.102718, loss_d: 0.196747
0.4237 --- loss: 0.900361, loss_ss: 0.682061, loss_d: 0.218300
0.4622 --- loss: 1.088615, loss_ss: 0.955108, loss_d: 0.133507
0.5008 --- loss: 1.114251, loss_ss: 0.863372, loss_d: 0.250879
0.5393 --- loss: 1.175432, loss_ss: 1.142744, loss_d: 0.032688
0.5778 --- loss: 0.871682, loss_ss: 0.801553, loss_d: 0.070129
0.6163 --- loss: 0.932213, loss_ss: 0.786393, loss_d: 0.145819
0.6549 --- loss: 1.219377, loss_ss: 0.891368, loss_d: 0.328009
0.6934 --- loss: 1.272374, loss_ss: 0.543253, loss_d: 0.729121
0.7319 --- loss: 1.579106, loss_ss: 0.749666, loss_d: 0.829440
0.7704 --- loss: 1.304425, loss_ss: 0.734912, loss_d: 0.569514
0.8089 --- loss: 0.683040, loss_ss: 0.601300, loss_d: 0.081740
0.8475 --- loss: 1.359664, loss_ss: 1.019451, loss_d: 0.340213
0.8860 --- loss: 0.793124, loss_ss: 0.768911, loss_d: 0.024213
0.9245 --- loss: 0.913550, loss_ss: 0.825675, loss_d: 0.087875
0.9630 --- loss: 1.225430, loss_ss: 1.029706, loss_d: 0.195725
Epoch finished! Loss: 1.0922089451528425
Starting epoch 5/10.
0.0000 --- loss: 0.687644, loss_ss: 0.553761, loss_d: 0.133884
0.0385 --- loss: 0.908121, loss_ss: 0.702560, loss_d: 0.205561
0.0770 --- loss: 1.176928, loss_ss: 0.968650, loss_d: 0.208278
0.1156 --- loss: 1.235324, loss_ss: 0.996888, loss_d: 0.238436
0.1541 --- loss: 1.835527, loss_ss: 0.594027, loss_d: 1.241500
0.1926 --- loss: 1.776177, loss_ss: 0.738867, loss_d: 1.037310
0.2311 --- loss: 0.862503, loss_ss: 0.793564, loss_d: 0.068940
0.2696 --- loss: 1.080801, loss_ss: 0.689634, loss_d: 0.391167
0.3082 --- loss: 1.037421, loss_ss: 0.920347, loss_d: 0.117075
0.3467 --- loss: 1.543882, loss_ss: 0.924465, loss_d: 0.619417
0.3852 --- loss: 0.710159, loss_ss: 0.589122, loss_d: 0.121036
0.4237 --- loss: 0.998367, loss_ss: 0.781412, loss_d: 0.216955
0.4622 --- loss: 1.083328, loss_ss: 0.854065, loss_d: 0.229263
0.5008 --- loss: 0.936535, loss_ss: 0.903328, loss_d: 0.033207
0.5393 --- loss: 0.874379, loss_ss: 0.758702, loss_d: 0.115677
0.5778 --- loss: 1.174887, loss_ss: 0.895062, loss_d: 0.279825
0.6163 --- loss: 0.845293, loss_ss: 0.678801, loss_d: 0.166492
0.6549 --- loss: 0.698074, loss_ss: 0.659825, loss_d: 0.038250
0.6934 --- loss: 1.129341, loss_ss: 0.734722, loss_d: 0.394619
0.7319 --- loss: 0.898101, loss_ss: 0.777430, loss_d: 0.120671
0.7704 --- loss: 0.758361, loss_ss: 0.692623, loss_d: 0.065738
0.8089 --- loss: 0.736364, loss_ss: 0.702279, loss_d: 0.034085
0.8475 --- loss: 1.206783, loss_ss: 0.907111, loss_d: 0.299672
0.8860 --- loss: 0.752818, loss_ss: 0.688184, loss_d: 0.064633
0.9245 --- loss: 0.678255, loss_ss: 0.570391, loss_d: 0.107864
0.9630 --- loss: 0.930071, loss_ss: 0.848005, loss_d: 0.082066
Epoch finished! Loss: 1.0289905586758175
Starting epoch 6/10.
0.0000 --- loss: 0.979274, loss_ss: 0.711860, loss_d: 0.267414
0.0385 --- loss: 0.912149, loss_ss: 0.830032, loss_d: 0.082118
0.0770 --- loss: 0.825384, loss_ss: 0.783185, loss_d: 0.042199
0.1156 --- loss: 1.100902, loss_ss: 0.703584, loss_d: 0.397318
0.1541 --- loss: 0.818120, loss_ss: 0.742671, loss_d: 0.075449
0.1926 --- loss: 0.955998, loss_ss: 0.828433, loss_d: 0.127566
0.2311 --- loss: 1.032000, loss_ss: 0.925448, loss_d: 0.106553
0.2696 --- loss: 0.739030, loss_ss: 0.532721, loss_d: 0.206310
0.3082 --- loss: 0.608734, loss_ss: 0.566297, loss_d: 0.042437
0.3467 --- loss: 0.745231, loss_ss: 0.628239, loss_d: 0.116992
0.3852 --- loss: 0.896989, loss_ss: 0.805595, loss_d: 0.091394
0.4237 --- loss: 0.773376, loss_ss: 0.613937, loss_d: 0.159439
0.4622 --- loss: 0.830681, loss_ss: 0.596647, loss_d: 0.234034
0.5008 --- loss: 0.886298, loss_ss: 0.860944, loss_d: 0.025355
0.5393 --- loss: 0.978615, loss_ss: 0.876394, loss_d: 0.102220
0.5778 --- loss: 1.281189, loss_ss: 0.815490, loss_d: 0.465699
0.6163 --- loss: 1.213893, loss_ss: 1.046635, loss_d: 0.167258
0.6549 --- loss: 0.952913, loss_ss: 0.845388, loss_d: 0.107526
0.6934 --- loss: 0.667788, loss_ss: 0.588717, loss_d: 0.079071
0.7319 --- loss: 1.104123, loss_ss: 1.062263, loss_d: 0.041860
0.7704 --- loss: 0.590855, loss_ss: 0.568040, loss_d: 0.022816
0.8089 --- loss: 0.812427, loss_ss: 0.750534, loss_d: 0.061893
0.8475 --- loss: 0.731044, loss_ss: 0.669034, loss_d: 0.062009
0.8860 --- loss: 0.781977, loss_ss: 0.761762, loss_d: 0.020215
0.9245 --- loss: 0.758898, loss_ss: 0.674532, loss_d: 0.084367
0.9630 --- loss: 0.824736, loss_ss: 0.754274, loss_d: 0.070462
Epoch finished! Loss: 0.9472849333378339
Starting epoch 7/10.
0.0000 --- loss: 0.718871, loss_ss: 0.665003, loss_d: 0.053868
0.0385 --- loss: 1.000374, loss_ss: 0.795744, loss_d: 0.204630
0.0770 --- loss: 1.265400, loss_ss: 1.036549, loss_d: 0.228851
0.1156 --- loss: 0.711564, loss_ss: 0.681892, loss_d: 0.029673
0.1541 --- loss: 0.968377, loss_ss: 0.796069, loss_d: 0.172308
0.1926 --- loss: 0.683296, loss_ss: 0.623845, loss_d: 0.059451
0.2311 --- loss: 1.174062, loss_ss: 0.741798, loss_d: 0.432264
0.2696 --- loss: 0.548283, loss_ss: 0.446852, loss_d: 0.101431
0.3082 --- loss: 0.787936, loss_ss: 0.759483, loss_d: 0.028454
0.3467 --- loss: 0.622962, loss_ss: 0.570531, loss_d: 0.052431
0.3852 --- loss: 0.873652, loss_ss: 0.794561, loss_d: 0.079091
0.4237 --- loss: 0.709887, loss_ss: 0.528996, loss_d: 0.180891
0.4622 --- loss: 0.810793, loss_ss: 0.785664, loss_d: 0.025129
0.5008 --- loss: 1.104209, loss_ss: 0.799264, loss_d: 0.304945
0.5393 --- loss: 0.561119, loss_ss: 0.524032, loss_d: 0.037087
0.5778 --- loss: 0.737137, loss_ss: 0.683241, loss_d: 0.053895
0.6163 --- loss: 1.547256, loss_ss: 0.832399, loss_d: 0.714857
0.6549 --- loss: 0.857829, loss_ss: 0.680814, loss_d: 0.177014
0.6934 --- loss: 0.840431, loss_ss: 0.673133, loss_d: 0.167298
0.7319 --- loss: 0.838897, loss_ss: 0.798058, loss_d: 0.040839
0.7704 --- loss: 0.565886, loss_ss: 0.549627, loss_d: 0.016259
0.8089 --- loss: 0.576420, loss_ss: 0.532950, loss_d: 0.043470
0.8475 --- loss: 0.951542, loss_ss: 0.762888, loss_d: 0.188654
0.8860 --- loss: 0.888915, loss_ss: 0.859617, loss_d: 0.029299
0.9245 --- loss: 0.941550, loss_ss: 0.885787, loss_d: 0.055764
0.9630 --- loss: 0.835475, loss_ss: 0.807977, loss_d: 0.027498
Epoch finished! Loss: 0.91541016734705
Starting epoch 8/10.
0.0000 --- loss: 0.747118, loss_ss: 0.739024, loss_d: 0.008094
0.0385 --- loss: 0.614136, loss_ss: 0.610151, loss_d: 0.003986
0.0770 --- loss: 1.579646, loss_ss: 0.577342, loss_d: 1.002303
0.1156 --- loss: 0.687292, loss_ss: 0.641056, loss_d: 0.046236
0.1541 --- loss: 0.835781, loss_ss: 0.828455, loss_d: 0.007326
0.1926 --- loss: 0.869527, loss_ss: 0.743793, loss_d: 0.125734
0.2311 --- loss: 0.685036, loss_ss: 0.669793, loss_d: 0.015243
0.2696 --- loss: 0.844398, loss_ss: 0.808327, loss_d: 0.036071
0.3082 --- loss: 0.895523, loss_ss: 0.738139, loss_d: 0.157384
0.3467 --- loss: 1.123255, loss_ss: 0.736235, loss_d: 0.387021
0.3852 --- loss: 0.844412, loss_ss: 0.779349, loss_d: 0.065063
0.4237 --- loss: 0.658733, loss_ss: 0.632125, loss_d: 0.026607
0.4622 --- loss: 0.708031, loss_ss: 0.677393, loss_d: 0.030638
0.5008 --- loss: 0.657806, loss_ss: 0.537422, loss_d: 0.120384
0.5393 --- loss: 0.641378, loss_ss: 0.633278, loss_d: 0.008100
0.5778 --- loss: 1.000077, loss_ss: 0.926334, loss_d: 0.073743
0.6163 --- loss: 1.417068, loss_ss: 1.031856, loss_d: 0.385211
0.6549 --- loss: 0.785638, loss_ss: 0.691396, loss_d: 0.094241
0.6934 --- loss: 1.049721, loss_ss: 0.487726, loss_d: 0.561995
0.7319 --- loss: 0.853378, loss_ss: 0.752154, loss_d: 0.101224
0.7704 --- loss: 0.966734, loss_ss: 0.713818, loss_d: 0.252916
0.8089 --- loss: 1.013862, loss_ss: 0.676683, loss_d: 0.337179
0.8475 --- loss: 1.720184, loss_ss: 1.400896, loss_d: 0.319288
0.8860 --- loss: 0.992596, loss_ss: 0.827422, loss_d: 0.165174
0.9245 --- loss: 0.634462, loss_ss: 0.544149, loss_d: 0.090313
0.9630 --- loss: 0.720695, loss_ss: 0.641369, loss_d: 0.079327
Epoch finished! Loss: 0.8810550921441965
Starting epoch 9/10.
0.0000 --- loss: 0.769859, loss_ss: 0.708052, loss_d: 0.061807
0.0385 --- loss: 1.431213, loss_ss: 1.048313, loss_d: 0.382900
0.0770 --- loss: 0.587027, loss_ss: 0.549908, loss_d: 0.037119
0.1156 --- loss: 0.864341, loss_ss: 0.835384, loss_d: 0.028958
0.1541 --- loss: 1.002972, loss_ss: 0.576683, loss_d: 0.426289
0.1926 --- loss: 0.681486, loss_ss: 0.649243, loss_d: 0.032243
0.2311 --- loss: 0.842057, loss_ss: 0.792776, loss_d: 0.049281
0.2696 --- loss: 0.946251, loss_ss: 0.795278, loss_d: 0.150973
0.3082 --- loss: 1.114655, loss_ss: 0.853898, loss_d: 0.260757
0.3467 --- loss: 0.740652, loss_ss: 0.598585, loss_d: 0.142067
0.3852 --- loss: 0.771055, loss_ss: 0.680970, loss_d: 0.090085
0.4237 --- loss: 0.762253, loss_ss: 0.755977, loss_d: 0.006276
0.4622 --- loss: 0.757296, loss_ss: 0.706898, loss_d: 0.050398
0.5008 --- loss: 0.667775, loss_ss: 0.657421, loss_d: 0.010354
0.5393 --- loss: 0.999389, loss_ss: 0.811025, loss_d: 0.188364
0.5778 --- loss: 0.667958, loss_ss: 0.641758, loss_d: 0.026200
0.6163 --- loss: 0.684759, loss_ss: 0.647833, loss_d: 0.036926
0.6549 --- loss: 0.727421, loss_ss: 0.643452, loss_d: 0.083970
0.6934 --- loss: 1.064312, loss_ss: 0.899461, loss_d: 0.164851
0.7319 --- loss: 0.766120, loss_ss: 0.756963, loss_d: 0.009157
0.7704 --- loss: 1.596146, loss_ss: 0.753884, loss_d: 0.842262
0.8089 --- loss: 0.744308, loss_ss: 0.696723, loss_d: 0.047585
0.8475 --- loss: 0.829865, loss_ss: 0.807967, loss_d: 0.021897
0.8860 --- loss: 1.312179, loss_ss: 1.147593, loss_d: 0.164586
0.9245 --- loss: 0.771575, loss_ss: 0.663265, loss_d: 0.108310
0.9630 --- loss: 1.519539, loss_ss: 1.039871, loss_d: 0.479668
Epoch finished! Loss: 0.8650952329046477
Starting epoch 10/10.
0.0000 --- loss: 0.514456, loss_ss: 0.505768, loss_d: 0.008688
0.0385 --- loss: 0.695700, loss_ss: 0.680736, loss_d: 0.014964
0.0770 --- loss: 1.031737, loss_ss: 0.967896, loss_d: 0.063841
0.1156 --- loss: 0.570185, loss_ss: 0.552349, loss_d: 0.017836
0.1541 --- loss: 0.708166, loss_ss: 0.684272, loss_d: 0.023895
0.1926 --- loss: 1.003043, loss_ss: 0.734314, loss_d: 0.268729
0.2311 --- loss: 0.740547, loss_ss: 0.717595, loss_d: 0.022952
0.2696 --- loss: 0.707594, loss_ss: 0.669138, loss_d: 0.038456
0.3082 --- loss: 0.904572, loss_ss: 0.841593, loss_d: 0.062979
0.3467 --- loss: 0.646329, loss_ss: 0.638444, loss_d: 0.007885
0.3852 --- loss: 0.521116, loss_ss: 0.455583, loss_d: 0.065533
0.4237 --- loss: 1.176781, loss_ss: 0.952256, loss_d: 0.224525
0.4622 --- loss: 0.567655, loss_ss: 0.529512, loss_d: 0.038143
0.5008 --- loss: 0.960442, loss_ss: 0.738446, loss_d: 0.221997
0.5393 --- loss: 0.942840, loss_ss: 0.846568, loss_d: 0.096272
0.5778 --- loss: 0.996467, loss_ss: 0.922511, loss_d: 0.073957
0.6163 --- loss: 1.144148, loss_ss: 0.856379, loss_d: 0.287769
0.6549 --- loss: 0.808411, loss_ss: 0.797317, loss_d: 0.011094
0.6934 --- loss: 0.726683, loss_ss: 0.696075, loss_d: 0.030608
0.7319 --- loss: 0.686912, loss_ss: 0.669464, loss_d: 0.017448
0.7704 --- loss: 0.685169, loss_ss: 0.681544, loss_d: 0.003626
0.8089 --- loss: 0.852683, loss_ss: 0.795014, loss_d: 0.057669
0.8475 --- loss: 0.848251, loss_ss: 0.710123, loss_d: 0.138128
0.8860 --- loss: 1.148949, loss_ss: 0.848427, loss_d: 0.300522
0.9245 --- loss: 0.628481, loss_ss: 0.609221, loss_d: 0.019260
0.9630 --- loss: 0.881669, loss_ss: 0.871328, loss_d: 0.010341
Epoch finished! Loss: 0.8322887984482018
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5626984126984127
             precision    recall  f1-score   support

        0.0       0.96      0.46      0.62       519
        1.0       0.32      0.91      0.47       201
        2.0       0.64      0.53      0.58       228
        3.0       0.97      0.62      0.76       158
        4.0       0.46      0.46      0.46       154

avg / total       0.74      0.56      0.59      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  76.90  45.66   98.79  96.34     61.96
1  67.78  90.55   63.46  31.99     47.27
2  86.03  53.07   93.31  63.68     57.89
3  95.00  62.03   99.73  97.03     75.68
4  86.83  46.10   92.50  46.10     46.10
Total accuracy: 56.27%
Average sen: 59.48%
Average spec: 89.56%
Macro f1-score: 57.78%
Diagnosis acc on 15mins: 1.0
[1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         0.99999976 1.         1.         1.
 1.         1.         1.         1.         1.         0.99999988
 0.99999988 1.         1.         1.         1.         0.99999988
 1.         1.         1.         1.         1.         1.
 1.         0.9999994  0.99999952 0.99999988 1.         1.        ]
pred: 0.9999999574252537, label: 1
Right! Diagnosis: NT1
Save 15mins of subject {subject}

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.72  69.97   95.22  70.20     70.08
1  83.76  41.89   89.84  37.42     39.53
2  82.69  78.07   85.49  76.58     77.32
3  94.05  70.91   98.98  93.65     80.71
4  86.95  69.68   90.77  62.57     65.93
Total accuracy: 69.58%
Average sen: 66.10%
Average spec: 92.06%
Macro f1-score: 66.71%
Diagnosis acc on patients: 0.8974358974358975

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.74  69.57   98.18  94.12      80.0
1  89.74  98.18   69.57  88.52      93.1
Total accuracy: 89.74%
Average sen: 83.87%
Average spec: 83.87%
Macro f1-score: 86.55%
fpr: 0.0, tpr: 0.01818181818181818, threshold: 0.9999999900658926, 
fpr: 0.0, tpr: 0.6727272727272727, threshold: 0.9981452371134902, 
fpr: 0.043478260869565216, tpr: 0.6727272727272727, threshold: 0.99790448612637, 
fpr: 0.043478260869565216, tpr: 0.8909090909090909, threshold: 0.9698930457234383, 
fpr: 0.08695652173913043, tpr: 0.8909090909090909, threshold: 0.9627357692487778, 
fpr: 0.08695652173913043, tpr: 0.9636363636363636, threshold: 0.8827894382617053, 
fpr: 0.13043478260869565, tpr: 0.9636363636363636, threshold: 0.870394736954144, 
fpr: 0.13043478260869565, tpr: 0.9818181818181818, threshold: 0.8010958907090955, 
fpr: 0.6086956521739131, tpr: 0.9818181818181818, threshold: 0.18993352382676676, 
fpr: 0.6086956521739131, tpr: 1.0, threshold: 0.08580903010763852, 
fpr: 1.0, tpr: 1.0, threshold: 0.0014452801342486055, 

=== best_threshold: 0.8827894382617053, best_fpr: 0.08695652173913043, best_tpr: 0.9636363636363636 ===
fpr: 0.0, tpr: 0.0, threshold: 2.0, 
fpr: 0.001455604075691412, tpr: 0.2485904664274731, threshold: 1.0, 
fpr: 0.004366812227074236, tpr: 0.3029215786776012, threshold: 0.9999998807907104, 
fpr: 0.004366812227074236, tpr: 0.32752434648898, threshold: 0.9999997615814209, 
fpr: 0.004366812227074236, tpr: 0.3470015376729882, threshold: 0.9999996423721313, 
fpr: 0.004366812227074236, tpr: 0.3608405945668888, threshold: 0.9999995231628418, 
fpr: 0.004366812227074236, tpr: 0.3751922091235264, threshold: 0.9999994039535522, 
fpr: 0.00727802037845706, tpr: 0.3813429010763711, threshold: 0.9999992847442627, 
fpr: 0.00727802037845706, tpr: 0.38544336237826754, threshold: 0.9999991655349731, 
fpr: 0.00727802037845706, tpr: 0.3956945156330087, threshold: 0.9999990463256836, 
fpr: 0.00727802037845706, tpr: 0.40030753459764223, threshold: 0.999998927116394, 
fpr: 0.00727802037845706, tpr: 0.4064582265504869, threshold: 0.9999988079071045, 
fpr: 0.00727802037845706, tpr: 0.4105586878523834, threshold: 0.9999986886978149, 
fpr: 0.00727802037845706, tpr: 0.42439774474628394, threshold: 0.9999983310699463, 
fpr: 0.00727802037845706, tpr: 0.4300358790363916, threshold: 0.9999982118606567, 
fpr: 0.00727802037845706, tpr: 0.43464889800102513, threshold: 0.9999980926513672, 
fpr: 0.00727802037845706, tpr: 0.4382368016401845, threshold: 0.9999979734420776, 
fpr: 0.00727802037845706, tpr: 0.44387493593029215, threshold: 0.9999978542327881, 
fpr: 0.00727802037845706, tpr: 0.4459251665812404, threshold: 0.9999977350234985, 
fpr: 0.00727802037845706, tpr: 0.45515120451050745, threshold: 0.9999973773956299, 
fpr: 0.00727802037845706, tpr: 0.4592516658124039, threshold: 0.9999972581863403, 
fpr: 0.008733624454148471, tpr: 0.46232701178882624, threshold: 0.9999971389770508, 
fpr: 0.008733624454148471, tpr: 0.46591491542798563, threshold: 0.9999970197677612, 
fpr: 0.008733624454148471, tpr: 0.46899026140440797, threshold: 0.9999969005584717, 
fpr: 0.008733624454148471, tpr: 0.47104049205535625, threshold: 0.9999967813491821, 
fpr: 0.008733624454148471, tpr: 0.4741158380317786, threshold: 0.9999966621398926, 
fpr: 0.008733624454148471, tpr: 0.477703741670938, threshold: 0.999996542930603, 
fpr: 0.010189228529839884, tpr: 0.4797539723218862, threshold: 0.9999964237213135, 
fpr: 0.010189228529839884, tpr: 0.4807790876473603, threshold: 0.9999963045120239, 
fpr: 0.010189228529839884, tpr: 0.4823167606355715, threshold: 0.9999961853027344, 
fpr: 0.010189228529839884, tpr: 0.48744233726294206, threshold: 0.9999959468841553, 
fpr: 0.010189228529839884, tpr: 0.49051768323936445, threshold: 0.9999958276748657, 
fpr: 0.010189228529839884, tpr: 0.49308047155304974, threshold: 0.9999957084655762, 
fpr: 0.010189228529839884, tpr: 0.4935930292157868, threshold: 0.9999955892562866, 
fpr: 0.010189228529839884, tpr: 0.49666837519220913, threshold: 0.9999954700469971, 
fpr: 0.010189228529839884, tpr: 0.49769349051768325, threshold: 0.9999953508377075, 
fpr: 0.010189228529839884, tpr: 0.4992311635058944, threshold: 0.999995231628418, 
fpr: 0.010189228529839884, tpr: 0.5017939518195798, threshold: 0.9999951124191284, 
fpr: 0.010189228529839884, tpr: 0.5028190671450539, threshold: 0.9999949932098389, 
fpr: 0.010189228529839884, tpr: 0.504356740133265, threshold: 0.9999948740005493, 
fpr: 0.011644832605531296, tpr: 0.5064069707842133, threshold: 0.9999947547912598, 
fpr: 0.011644832605531296, tpr: 0.5084572014351615, threshold: 0.9999946355819702, 
fpr: 0.011644832605531296, tpr: 0.5146078933880062, threshold: 0.9999943971633911, 
fpr: 0.011644832605531296, tpr: 0.5161455663762173, threshold: 0.9999942779541016, 
fpr: 0.011644832605531296, tpr: 0.5187083546899026, threshold: 0.999994158744812, 
fpr: 0.011644832605531296, tpr: 0.5197334700153767, threshold: 0.9999940395355225, 
fpr: 0.011644832605531296, tpr: 0.521783700666325, threshold: 0.9999939203262329, 
fpr: 0.011644832605531296, tpr: 0.5228088159917991, threshold: 0.9999938011169434, 
fpr: 0.011644832605531296, tpr: 0.5258841619682214, threshold: 0.9999936819076538, 
fpr: 0.011644832605531296, tpr: 0.5279343926191696, threshold: 0.9999935626983643, 
fpr: 0.011644832605531296, tpr: 0.5284469502819067, threshold: 0.9999934434890747, 
fpr: 0.011644832605531296, tpr: 0.5299846232701179, threshold: 0.9999933242797852, 
fpr: 0.011644832605531296, tpr: 0.5304971809328549, threshold: 0.999993085861206, 
fpr: 0.011644832605531296, tpr: 0.5320348539210661, threshold: 0.9999929666519165, 
fpr: 0.011644832605531296, tpr: 0.5345976422347514, threshold: 0.999992847442627, 
fpr: 0.011644832605531296, tpr: 0.5351101998974884, threshold: 0.9999927282333374, 
fpr: 0.013100436681222707, tpr: 0.5366478728856996, threshold: 0.9999926090240479, 
fpr: 0.013100436681222707, tpr: 0.5376729882111737, threshold: 0.9999924898147583, 
fpr: 0.01455604075691412, tpr: 0.5376729882111737, threshold: 0.9999923706054688, 
fpr: 0.01455604075691412, tpr: 0.5397232188621219, threshold: 0.9999922513961792, 
fpr: 0.01601164483260553, tpr: 0.5402357765248591, threshold: 0.9999921321868896, 
fpr: 0.01601164483260553, tpr: 0.5433111225012814, threshold: 0.9999918937683105, 
fpr: 0.01601164483260553, tpr: 0.5438236801640185, threshold: 0.999991774559021, 
fpr: 0.01601164483260553, tpr: 0.5448487954894926, threshold: 0.9999916553497314, 
fpr: 0.017467248908296942, tpr: 0.5458739108149667, threshold: 0.9999915361404419, 
fpr: 0.017467248908296942, tpr: 0.5474115838031779, threshold: 0.9999912977218628, 
fpr: 0.017467248908296942, tpr: 0.548436699128652, threshold: 0.9999911785125732, 
fpr: 0.017467248908296942, tpr: 0.5499743721168632, threshold: 0.9999910593032837, 
fpr: 0.017467248908296942, tpr: 0.5520246027678114, threshold: 0.9999908208847046, 
fpr: 0.017467248908296942, tpr: 0.5525371604305485, threshold: 0.999990701675415, 
fpr: 0.018922852983988356, tpr: 0.5535622757560226, threshold: 0.9999905824661255, 
fpr: 0.018922852983988356, tpr: 0.5545873910814967, threshold: 0.9999903440475464, 
fpr: 0.020378457059679767, tpr: 0.5545873910814967, threshold: 0.9999899864196777, 
fpr: 0.020378457059679767, tpr: 0.5550999487442337, threshold: 0.9999898672103882, 
fpr: 0.020378457059679767, tpr: 0.5566376217324449, threshold: 0.9999897480010986, 
fpr: 0.020378457059679767, tpr: 0.5586878523833931, threshold: 0.99998939037323, 
fpr: 0.020378457059679767, tpr: 0.5602255253716043, threshold: 0.9999889135360718, 
fpr: 0.020378457059679767, tpr: 0.5612506406970784, threshold: 0.9999887943267822, 
fpr: 0.020378457059679767, tpr: 0.5633008713480266, threshold: 0.9999876022338867, 
fpr: 0.020378457059679767, tpr: 0.5648385443362378, threshold: 0.9999874830245972, 
fpr: 0.020378457059679767, tpr: 0.5658636596617119, threshold: 0.9999873638153076, 
fpr: 0.020378457059679767, tpr: 0.5684264479753972, threshold: 0.9999871253967285, 
fpr: 0.020378457059679767, tpr: 0.5694515633008713, threshold: 0.999987006187439, 
fpr: 0.020378457059679767, tpr: 0.5709892362890825, threshold: 0.9999868869781494, 
fpr: 0.020378457059679767, tpr: 0.5725269092772937, threshold: 0.9999861717224121, 
fpr: 0.020378457059679767, tpr: 0.5735520246027678, threshold: 0.9999860525131226, 
fpr: 0.020378457059679767, tpr: 0.5740645822655048, threshold: 0.999985933303833, 
fpr: 0.020378457059679767, tpr: 0.5750896975909789, threshold: 0.9999858140945435, 
fpr: 0.021834061135371178, tpr: 0.5766273705791901, threshold: 0.9999856948852539, 
fpr: 0.021834061135371178, tpr: 0.5781650435674013, threshold: 0.9999855756759644, 
fpr: 0.021834061135371178, tpr: 0.5802152742183496, threshold: 0.9999854564666748, 
fpr: 0.021834061135371178, tpr: 0.5812403895438237, threshold: 0.9999853372573853, 
fpr: 0.021834061135371178, tpr: 0.5817529472065608, threshold: 0.9999852180480957, 
fpr: 0.021834061135371178, tpr: 0.5827780625320349, threshold: 0.9999850988388062, 
fpr: 0.021834061135371178, tpr: 0.5868785238339314, threshold: 0.999983549118042, 
fpr: 0.021834061135371178, tpr: 0.5899538698103537, threshold: 0.9999830722808838, 
fpr: 0.021834061135371178, tpr: 0.5904664274730907, threshold: 0.9999829530715942, 
fpr: 0.021834061135371178, tpr: 0.5914915427985649, threshold: 0.9999827146530151, 
fpr: 0.021834061135371178, tpr: 0.5920041004613019, threshold: 0.999982476234436, 
fpr: 0.021834061135371178, tpr: 0.593029215786776, threshold: 0.9999823570251465, 
fpr: 0.021834061135371178, tpr: 0.5955920041004613, threshold: 0.9999815225601196, 
fpr: 0.021834061135371178, tpr: 0.5971296770886725, threshold: 0.9999810457229614, 
fpr: 0.021834061135371178, tpr: 0.5976422347514095, threshold: 0.9999808073043823, 
fpr: 0.021834061135371178, tpr: 0.5986673500768837, threshold: 0.9999806880950928, 
fpr: 0.021834061135371178, tpr: 0.5991799077396207, threshold: 0.9999802112579346, 
fpr: 0.023289665211062592, tpr: 0.5991799077396207, threshold: 0.999980092048645, 
fpr: 0.023289665211062592, tpr: 0.6012301383905689, threshold: 0.9999798536300659, 
fpr: 0.023289665211062592, tpr: 0.602255253716043, threshold: 0.9999796152114868, 
fpr: 0.023289665211062592, tpr: 0.6037929267042542, threshold: 0.9999794960021973, 
fpr: 0.023289665211062592, tpr: 0.6043054843669913, threshold: 0.9999793767929077, 
fpr: 0.023289665211062592, tpr: 0.6053305996924654, threshold: 0.9999792575836182, 
fpr: 0.023289665211062592, tpr: 0.6078933880061507, threshold: 0.9999784231185913, 
fpr: 0.023289665211062592, tpr: 0.6099436186570989, threshold: 0.9999780654907227, 
fpr: 0.023289665211062592, tpr: 0.6125064069707842, threshold: 0.9999765157699585, 
fpr: 0.024745269286754003, tpr: 0.6135315222962583, threshold: 0.999976396560669, 
fpr: 0.024745269286754003, tpr: 0.6155817529472065, threshold: 0.9999756813049316, 
fpr: 0.024745269286754003, tpr: 0.6171194259354177, threshold: 0.9999755620956421, 
fpr: 0.024745269286754003, tpr: 0.6191696565863659, threshold: 0.9999746084213257, 
fpr: 0.024745269286754003, tpr: 0.6201947719118401, threshold: 0.9999738931655884, 
fpr: 0.024745269286754003, tpr: 0.6232701178882625, threshold: 0.999971866607666, 
fpr: 0.024745269286754003, tpr: 0.6242952332137366, threshold: 0.9999717473983765, 
fpr: 0.024745269286754003, tpr: 0.6253203485392107, threshold: 0.9999711513519287, 
fpr: 0.024745269286754003, tpr: 0.6273705791901589, threshold: 0.9999707937240601, 
fpr: 0.024745269286754003, tpr: 0.627883136852896, threshold: 0.9999706745147705, 
fpr: 0.024745269286754003, tpr: 0.6289082521783701, threshold: 0.9999701976776123, 
fpr: 0.024745269286754003, tpr: 0.6330087134802665, threshold: 0.9999681711196899, 
fpr: 0.024745269286754003, tpr: 0.6340338288057407, threshold: 0.9999679327011108, 
fpr: 0.024745269286754003, tpr: 0.6360840594566889, threshold: 0.9999666213989258, 
fpr: 0.024745269286754003, tpr: 0.637109174782163, threshold: 0.9999665021896362, 
fpr: 0.026200873362445413, tpr: 0.6376217324449001, threshold: 0.9999663829803467, 
fpr: 0.026200873362445413, tpr: 0.6381342901076371, threshold: 0.9999654293060303, 
fpr: 0.026200873362445413, tpr: 0.6391594054331112, threshold: 0.9999642372131348, 
fpr: 0.026200873362445413, tpr: 0.6447975397232188, threshold: 0.9999607801437378, 
fpr: 0.027656477438136828, tpr: 0.6447975397232188, threshold: 0.9999606609344482, 
fpr: 0.027656477438136828, tpr: 0.645822655048693, threshold: 0.9999604225158691, 
fpr: 0.027656477438136828, tpr: 0.6494105586878524, threshold: 0.9999579191207886, 
fpr: 0.027656477438136828, tpr: 0.6504356740133265, threshold: 0.9999576807022095, 
fpr: 0.027656477438136828, tpr: 0.6509482316760635, threshold: 0.9999573230743408, 
fpr: 0.02911208151382824, tpr: 0.6509482316760635, threshold: 0.9999569654464722, 
fpr: 0.02911208151382824, tpr: 0.6535110199897488, threshold: 0.9999556541442871, 
fpr: 0.03056768558951965, tpr: 0.6535110199897488, threshold: 0.9999550580978394, 
fpr: 0.03056768558951965, tpr: 0.6545361353152229, threshold: 0.9999527931213379, 
fpr: 0.03056768558951965, tpr: 0.655561250640697, threshold: 0.9999526739120483, 
fpr: 0.03056768558951965, tpr: 0.6581240389543823, threshold: 0.9999512434005737, 
fpr: 0.03056768558951965, tpr: 0.6591491542798564, threshold: 0.9999507665634155, 
fpr: 0.03056768558951965, tpr: 0.6622245002562789, threshold: 0.9999462366104126, 
fpr: 0.03056768558951965, tpr: 0.6652998462327012, threshold: 0.9999450445175171, 
fpr: 0.03056768558951965, tpr: 0.6750384418247053, threshold: 0.9999301433563232, 
fpr: 0.03202328966521106, tpr: 0.6750384418247053, threshold: 0.999929666519165, 
fpr: 0.03202328966521106, tpr: 0.6755509994874423, threshold: 0.9999294281005859, 
fpr: 0.03202328966521106, tpr: 0.6765761148129165, threshold: 0.9999287128448486, 
fpr: 0.03202328966521106, tpr: 0.6786263454638647, threshold: 0.9999264478683472, 
fpr: 0.033478893740902474, tpr: 0.6791389031266017, threshold: 0.999925971031189, 
fpr: 0.033478893740902474, tpr: 0.6847770374167094, threshold: 0.9999140501022339, 
fpr: 0.033478893740902474, tpr: 0.6858021527421835, threshold: 0.9999134540557861, 
fpr: 0.033478893740902474, tpr: 0.6868272680676576, threshold: 0.9999123811721802, 
fpr: 0.034934497816593885, tpr: 0.6873398257303946, threshold: 0.9999117851257324, 
fpr: 0.034934497816593885, tpr: 0.6899026140440799, threshold: 0.9999072551727295, 
fpr: 0.036390101892285295, tpr: 0.6899026140440799, threshold: 0.9999068975448608, 
fpr: 0.036390101892285295, tpr: 0.690415171706817, threshold: 0.9999064207077026, 
fpr: 0.036390101892285295, tpr: 0.6914402870322911, threshold: 0.999906063079834, 
fpr: 0.036390101892285295, tpr: 0.6924654023577652, threshold: 0.9999042749404907, 
fpr: 0.03784570596797671, tpr: 0.6924654023577652, threshold: 0.9999035596847534, 
fpr: 0.03784570596797671, tpr: 0.6934905176832393, threshold: 0.9999020099639893, 
fpr: 0.039301310043668124, tpr: 0.6934905176832393, threshold: 0.9999018907546997, 
fpr: 0.039301310043668124, tpr: 0.6981035366478728, threshold: 0.9998928308486938, 
fpr: 0.039301310043668124, tpr: 0.699128651973347, threshold: 0.9998922348022461, 
fpr: 0.039301310043668124, tpr: 0.7016914402870323, threshold: 0.999889612197876, 
fpr: 0.040756914119359534, tpr: 0.7016914402870323, threshold: 0.9998887777328491, 
fpr: 0.040756914119359534, tpr: 0.7027165556125065, threshold: 0.9998863935470581, 
fpr: 0.040756914119359534, tpr: 0.7037416709379806, threshold: 0.9998862743377686, 
fpr: 0.040756914119359534, tpr: 0.7057919015889288, threshold: 0.9998782873153687, 
fpr: 0.042212518195050945, tpr: 0.7057919015889288, threshold: 0.9998773336410522, 
fpr: 0.042212518195050945, tpr: 0.7139928241927217, threshold: 0.9998579025268555, 
fpr: 0.042212518195050945, tpr: 0.7150179395181958, threshold: 0.9998571872711182, 
fpr: 0.042212518195050945, tpr: 0.7180932854946181, threshold: 0.9998492002487183, 
fpr: 0.043668122270742356, tpr: 0.7180932854946181, threshold: 0.9998465776443481, 
fpr: 0.043668122270742356, tpr: 0.7221937467965146, threshold: 0.9998242259025574, 
fpr: 0.043668122270742356, tpr: 0.7232188621219887, threshold: 0.9998238682746887, 
fpr: 0.04512372634643377, tpr: 0.7232188621219887, threshold: 0.9998230338096619, 
fpr: 0.04512372634643377, tpr: 0.725781650435674, threshold: 0.9998074173927307, 
fpr: 0.046579330422125184, tpr: 0.725781650435674, threshold: 0.9998062252998352, 
fpr: 0.046579330422125184, tpr: 0.7283444387493593, threshold: 0.9997953772544861, 
fpr: 0.048034934497816595, tpr: 0.7283444387493593, threshold: 0.999792754650116, 
fpr: 0.048034934497816595, tpr: 0.7288569964120963, threshold: 0.9997879862785339, 
fpr: 0.049490538573508006, tpr: 0.7288569964120963, threshold: 0.9997877478599548, 
fpr: 0.049490538573508006, tpr: 0.7298821117375704, threshold: 0.9997875094413757, 
fpr: 0.049490538573508006, tpr: 0.7319323423885187, threshold: 0.9997822642326355, 
fpr: 0.050946142649199416, tpr: 0.7319323423885187, threshold: 0.9997754693031311, 
fpr: 0.050946142649199416, tpr: 0.7334700153767298, threshold: 0.9997722506523132, 
fpr: 0.05240174672489083, tpr: 0.7334700153767298, threshold: 0.9997676014900208, 
fpr: 0.05240174672489083, tpr: 0.7421834956432599, threshold: 0.9997270703315735, 
fpr: 0.053857350800582245, tpr: 0.7421834956432599, threshold: 0.9997269511222839, 
fpr: 0.053857350800582245, tpr: 0.7447462839569452, threshold: 0.9997196793556213, 
fpr: 0.053857350800582245, tpr: 0.7457713992824193, threshold: 0.999717652797699, 
fpr: 0.053857350800582245, tpr: 0.7467965146078934, threshold: 0.9997135996818542, 
fpr: 0.055312954876273655, tpr: 0.7467965146078934, threshold: 0.999707043170929, 
fpr: 0.055312954876273655, tpr: 0.7478216299333675, threshold: 0.9997047781944275, 
fpr: 0.056768558951965066, tpr: 0.7478216299333675, threshold: 0.9997034668922424, 
fpr: 0.056768558951965066, tpr: 0.7514095335725269, threshold: 0.9996875524520874, 
fpr: 0.05967976710334789, tpr: 0.7514095335725269, threshold: 0.9996857643127441, 
fpr: 0.05967976710334789, tpr: 0.7539723218862122, threshold: 0.9996734857559204, 
fpr: 0.0611353711790393, tpr: 0.7539723218862122, threshold: 0.9996715784072876, 
fpr: 0.0611353711790393, tpr: 0.7544848795489493, threshold: 0.9996683597564697, 
fpr: 0.0611353711790393, tpr: 0.7555099948744234, threshold: 0.9996681213378906, 
fpr: 0.0611353711790393, tpr: 0.770374167093798, threshold: 0.9995546936988831, 
fpr: 0.06550218340611354, tpr: 0.770374167093798, threshold: 0.9995402097702026, 
fpr: 0.06550218340611354, tpr: 0.7754997437211686, threshold: 0.9994797110557556, 
fpr: 0.06695778748180495, tpr: 0.7754997437211686, threshold: 0.9994795918464661, 
fpr: 0.06695778748180495, tpr: 0.7837006663249616, threshold: 0.9993751645088196, 
fpr: 0.07132459970887918, tpr: 0.7837006663249616, threshold: 0.99936443567276, 
fpr: 0.07132459970887918, tpr: 0.7842132239876987, threshold: 0.9993512034416199, 
fpr: 0.07278020378457059, tpr: 0.7842132239876987, threshold: 0.9993506073951721, 
fpr: 0.07278020378457059, tpr: 0.7857508969759098, threshold: 0.99934321641922, 
fpr: 0.07423580786026202, tpr: 0.7857508969759098, threshold: 0.9993402361869812, 
fpr: 0.07423580786026202, tpr: 0.7867760123013839, threshold: 0.9993190765380859, 
fpr: 0.07569141193595343, tpr: 0.7867760123013839, threshold: 0.9993164539337158, 
fpr: 0.07569141193595343, tpr: 0.7929267042542286, threshold: 0.9992116689682007, 
fpr: 0.07714701601164484, tpr: 0.7929267042542286, threshold: 0.999204695224762, 
fpr: 0.07714701601164484, tpr: 0.7949769349051768, threshold: 0.9990646243095398, 
fpr: 0.07860262008733625, tpr: 0.7954894925679139, threshold: 0.9990615248680115, 
fpr: 0.07860262008733625, tpr: 0.7990773962070733, threshold: 0.998996913433075, 
fpr: 0.08005822416302766, tpr: 0.7990773962070733, threshold: 0.9989792108535767, 
fpr: 0.08005822416302766, tpr: 0.8006150691952845, threshold: 0.998956561088562, 
fpr: 0.08151382823871907, tpr: 0.8006150691952845, threshold: 0.9989546537399292, 
fpr: 0.08151382823871907, tpr: 0.8047155304971809, threshold: 0.9988773465156555, 
fpr: 0.08296943231441048, tpr: 0.8047155304971809, threshold: 0.9988756775856018, 
fpr: 0.08296943231441048, tpr: 0.8062532034853921, threshold: 0.998820960521698, 
fpr: 0.08442503639010189, tpr: 0.8062532034853921, threshold: 0.9988064765930176, 
fpr: 0.08442503639010189, tpr: 0.8072783188108662, threshold: 0.9987818598747253, 
fpr: 0.08733624454148471, tpr: 0.8072783188108662, threshold: 0.9987521171569824, 
fpr: 0.08733624454148471, tpr: 0.8098411071245515, threshold: 0.9987190961837769, 
fpr: 0.08879184861717612, tpr: 0.8098411071245515, threshold: 0.9987069368362427, 
fpr: 0.08879184861717612, tpr: 0.8241927216811892, threshold: 0.9983021020889282, 
fpr: 0.09024745269286755, tpr: 0.8241927216811892, threshold: 0.9982715845108032, 
fpr: 0.09024745269286755, tpr: 0.8267555099948745, threshold: 0.9982059001922607, 
fpr: 0.09170305676855896, tpr: 0.8267555099948745, threshold: 0.9981997013092041, 
fpr: 0.09170305676855896, tpr: 0.8288057406458227, threshold: 0.9981108903884888, 
fpr: 0.09315866084425037, tpr: 0.8288057406458227, threshold: 0.9980937838554382, 
fpr: 0.09315866084425037, tpr: 0.8298308559712968, threshold: 0.9980523586273193, 
fpr: 0.09461426491994178, tpr: 0.8298308559712968, threshold: 0.9979584217071533, 
fpr: 0.09461426491994178, tpr: 0.831881086622245, threshold: 0.9978578686714172, 
fpr: 0.09606986899563319, tpr: 0.831881086622245, threshold: 0.9978516101837158, 
fpr: 0.09606986899563319, tpr: 0.8344438749359303, threshold: 0.997749388217926, 
fpr: 0.0975254730713246, tpr: 0.8344438749359303, threshold: 0.9976962208747864, 
fpr: 0.0975254730713246, tpr: 0.8375192209123526, threshold: 0.9976110458374023, 
fpr: 0.09898107714701601, tpr: 0.8375192209123526, threshold: 0.9975318908691406, 
fpr: 0.09898107714701601, tpr: 0.841107124551512, threshold: 0.9973920583724976, 
fpr: 0.10043668122270742, tpr: 0.841107124551512, threshold: 0.9973741769790649, 
fpr: 0.10043668122270742, tpr: 0.8416196822142491, threshold: 0.9973457455635071, 
fpr: 0.10189228529839883, tpr: 0.8416196822142491, threshold: 0.9973430037498474, 
fpr: 0.10189228529839883, tpr: 0.849820604818042, threshold: 0.9967065453529358, 
fpr: 0.10334788937409024, tpr: 0.849820604818042, threshold: 0.9966945648193359, 
fpr: 0.10334788937409024, tpr: 0.8513582778062532, threshold: 0.9965161085128784, 
fpr: 0.10480349344978165, tpr: 0.8513582778062532, threshold: 0.9964809417724609, 
fpr: 0.10480349344978165, tpr: 0.8534085084572014, threshold: 0.9963266253471375, 
fpr: 0.10625909752547306, tpr: 0.8534085084572014, threshold: 0.9963083863258362, 
fpr: 0.10625909752547306, tpr: 0.8739108149666838, threshold: 0.9944406151771545, 
fpr: 0.10771470160116449, tpr: 0.8739108149666838, threshold: 0.9943997263908386, 
fpr: 0.10771470160116449, tpr: 0.8810866222450026, threshold: 0.9931579232215881, 
fpr: 0.1091703056768559, tpr: 0.8810866222450026, threshold: 0.993089497089386, 
fpr: 0.1091703056768559, tpr: 0.8826242952332137, threshold: 0.9929343461990356, 
fpr: 0.11062590975254731, tpr: 0.8826242952332137, threshold: 0.9928921461105347, 
fpr: 0.11062590975254731, tpr: 0.8856996412096361, threshold: 0.9921308159828186, 
fpr: 0.11208151382823872, tpr: 0.8856996412096361, threshold: 0.992081880569458, 
fpr: 0.11208151382823872, tpr: 0.8877498718605843, threshold: 0.9917663931846619, 
fpr: 0.11353711790393013, tpr: 0.8877498718605843, threshold: 0.9917623996734619, 
fpr: 0.11353711790393013, tpr: 0.8923628908252178, threshold: 0.990868330001831, 
fpr: 0.11499272197962154, tpr: 0.8923628908252178, threshold: 0.9908192753791809, 
fpr: 0.11499272197962154, tpr: 0.8959507944643772, threshold: 0.9900463223457336, 
fpr: 0.12081513828238719, tpr: 0.8959507944643772, threshold: 0.9897645711898804, 
fpr: 0.12081513828238719, tpr: 0.8990261404407995, threshold: 0.9888215065002441, 
fpr: 0.1222707423580786, tpr: 0.8990261404407995, threshold: 0.9887513518333435, 
fpr: 0.1222707423580786, tpr: 0.902614044079959, threshold: 0.9863900542259216, 
fpr: 0.12809315866084425, tpr: 0.902614044079959, threshold: 0.9853510856628418, 
fpr: 0.12809315866084425, tpr: 0.9031266017426961, threshold: 0.9853230714797974, 
fpr: 0.12954876273653565, tpr: 0.9031266017426961, threshold: 0.9852184653282166, 
fpr: 0.12954876273653565, tpr: 0.9051768323936443, threshold: 0.9843971133232117, 
fpr: 0.13100436681222707, tpr: 0.9051768323936443, threshold: 0.9842168092727661, 
fpr: 0.13100436681222707, tpr: 0.9067145053818555, threshold: 0.9832715392112732, 
fpr: 0.1324599708879185, tpr: 0.9067145053818555, threshold: 0.9826180338859558, 
fpr: 0.1324599708879185, tpr: 0.9082521783700667, threshold: 0.9807549715042114, 
fpr: 0.13682678311499272, tpr: 0.9082521783700667, threshold: 0.9800651669502258, 
fpr: 0.13682678311499272, tpr: 0.9103024090210149, threshold: 0.978948175907135, 
fpr: 0.14119359534206696, tpr: 0.9103024090210149, threshold: 0.978314995765686, 
fpr: 0.14119359534206696, tpr: 0.911327524346489, threshold: 0.9778159856796265, 
fpr: 0.14264919941775836, tpr: 0.911327524346489, threshold: 0.9776961803436279, 
fpr: 0.14264919941775836, tpr: 0.9169656586365966, threshold: 0.9745526313781738, 
fpr: 0.14410480349344978, tpr: 0.9169656586365966, threshold: 0.9743173122406006, 
fpr: 0.14410480349344978, tpr: 0.9174782162993337, threshold: 0.974073052406311, 
fpr: 0.14556040756914118, tpr: 0.9174782162993337, threshold: 0.973994791507721, 
fpr: 0.14556040756914118, tpr: 0.9195284469502819, threshold: 0.9733116626739502, 
fpr: 0.14847161572052403, tpr: 0.9195284469502819, threshold: 0.9726366400718689, 
fpr: 0.14847161572052403, tpr: 0.9256791389031266, threshold: 0.9670175313949585, 
fpr: 0.15138282387190685, tpr: 0.9256791389031266, threshold: 0.9663641452789307, 
fpr: 0.15138282387190685, tpr: 0.9267042542286007, threshold: 0.9648619294166565, 
fpr: 0.15283842794759825, tpr: 0.9267042542286007, threshold: 0.9647524952888489, 
fpr: 0.15283842794759825, tpr: 0.9272168118913378, threshold: 0.96436607837677, 
fpr: 0.15429403202328967, tpr: 0.9272168118913378, threshold: 0.9640830159187317, 
fpr: 0.15429403202328967, tpr: 0.9282419272168119, threshold: 0.9639885425567627, 
fpr: 0.15574963609898107, tpr: 0.9282419272168119, threshold: 0.9638105630874634, 
fpr: 0.15574963609898107, tpr: 0.9302921578677601, threshold: 0.9627495408058167, 
fpr: 0.1572052401746725, tpr: 0.9302921578677601, threshold: 0.9620800614356995, 
fpr: 0.1572052401746725, tpr: 0.9313172731932342, threshold: 0.9609895944595337, 
fpr: 0.1586608442503639, tpr: 0.9313172731932342, threshold: 0.9599254727363586, 
fpr: 0.1586608442503639, tpr: 0.9323423885187083, threshold: 0.9586969614028931, 
fpr: 0.16011644832605532, tpr: 0.9323423885187083, threshold: 0.9585477709770203, 
fpr: 0.16011644832605532, tpr: 0.9333675038441824, threshold: 0.9581559300422668, 
fpr: 0.1615720524017467, tpr: 0.9333675038441824, threshold: 0.9580772519111633, 
fpr: 0.1615720524017467, tpr: 0.9349051768323936, threshold: 0.9564830660820007, 
fpr: 0.16302765647743814, tpr: 0.9349051768323936, threshold: 0.9559670686721802, 
fpr: 0.16302765647743814, tpr: 0.9354177344951307, threshold: 0.9550809860229492, 
fpr: 0.16593886462882096, tpr: 0.9354177344951307, threshold: 0.9543790221214294, 
fpr: 0.16593886462882096, tpr: 0.9359302921578677, threshold: 0.9543412327766418, 
fpr: 0.16885007278020378, tpr: 0.9359302921578677, threshold: 0.9522216320037842, 
fpr: 0.16885007278020378, tpr: 0.9364428498206048, threshold: 0.9518980383872986, 
fpr: 0.17321688500727803, tpr: 0.9364428498206048, threshold: 0.9505026340484619, 
fpr: 0.17321688500727803, tpr: 0.9374679651460789, threshold: 0.9491322040557861, 
fpr: 0.17758369723435224, tpr: 0.9374679651460789, threshold: 0.9487519860267639, 
fpr: 0.17758369723435224, tpr: 0.93900563813429, threshold: 0.9481613039970398, 
fpr: 0.1804949053857351, tpr: 0.93900563813429, threshold: 0.9478145241737366, 
fpr: 0.1804949053857351, tpr: 0.9420809841107125, threshold: 0.9412508010864258, 
fpr: 0.1819505094614265, tpr: 0.9420809841107125, threshold: 0.9398010969161987, 
fpr: 0.1819505094614265, tpr: 0.9425935417734496, threshold: 0.9395920038223267, 
fpr: 0.18340611353711792, tpr: 0.9425935417734496, threshold: 0.9394664764404297, 
fpr: 0.18340611353711792, tpr: 0.9431060994361866, threshold: 0.9391703009605408, 
fpr: 0.1848617176128093, tpr: 0.9431060994361866, threshold: 0.938864529132843, 
fpr: 0.1848617176128093, tpr: 0.9456688877498719, threshold: 0.9325853586196899, 
fpr: 0.18777292576419213, tpr: 0.9456688877498719, threshold: 0.9324457049369812, 
fpr: 0.18777292576419213, tpr: 0.946181445412609, threshold: 0.9318516850471497, 
fpr: 0.18922852983988356, tpr: 0.946181445412609, threshold: 0.9318424463272095, 
fpr: 0.18922852983988356, tpr: 0.946694003075346, threshold: 0.931591808795929, 
fpr: 0.19068413391557495, tpr: 0.946694003075346, threshold: 0.931138813495636, 
fpr: 0.19068413391557495, tpr: 0.9472065607380831, threshold: 0.9300643801689148, 
fpr: 0.19213973799126638, tpr: 0.9472065607380831, threshold: 0.9299253225326538, 
fpr: 0.19213973799126638, tpr: 0.9487442337262942, threshold: 0.9281415343284607, 
fpr: 0.19359534206695778, tpr: 0.9487442337262942, threshold: 0.9279535412788391, 
fpr: 0.19359534206695778, tpr: 0.9497693490517684, threshold: 0.9251503944396973, 
fpr: 0.1965065502183406, tpr: 0.9497693490517684, threshold: 0.9238422513008118, 
fpr: 0.1965065502183406, tpr: 0.9502819067145054, threshold: 0.9229329824447632, 
fpr: 0.19941775836972345, tpr: 0.9502819067145054, threshold: 0.9219369888305664, 
fpr: 0.19941775836972345, tpr: 0.9507944643772425, threshold: 0.921338677406311, 
fpr: 0.20087336244541484, tpr: 0.9507944643772425, threshold: 0.9198199510574341, 
fpr: 0.20087336244541484, tpr: 0.9518195797027166, threshold: 0.9146183729171753, 
fpr: 0.20232896652110627, tpr: 0.9518195797027166, threshold: 0.9131401777267456, 
fpr: 0.20232896652110627, tpr: 0.9523321373654536, threshold: 0.9117431640625, 
fpr: 0.20378457059679767, tpr: 0.9523321373654536, threshold: 0.9115918874740601, 
fpr: 0.20378457059679767, tpr: 0.9528446950281907, threshold: 0.9109122157096863, 
fpr: 0.2052401746724891, tpr: 0.9528446950281907, threshold: 0.9096106886863708, 
fpr: 0.2052401746724891, tpr: 0.9538698103536648, threshold: 0.9064897298812866, 
fpr: 0.2066957787481805, tpr: 0.9538698103536648, threshold: 0.9055230617523193, 
fpr: 0.2066957787481805, tpr: 0.955920041004613, threshold: 0.8985739946365356, 
fpr: 0.2081513828238719, tpr: 0.955920041004613, threshold: 0.8979470729827881, 
fpr: 0.2081513828238719, tpr: 0.9564325986673501, threshold: 0.8973871469497681, 
fpr: 0.2096069868995633, tpr: 0.9564325986673501, threshold: 0.8967671990394592, 
fpr: 0.2096069868995633, tpr: 0.9569451563300871, threshold: 0.8958366513252258, 
fpr: 0.21106259097525473, tpr: 0.9569451563300871, threshold: 0.8952934741973877, 
fpr: 0.21106259097525473, tpr: 0.9579702716555613, threshold: 0.8937418460845947, 
fpr: 0.21251819505094613, tpr: 0.9579702716555613, threshold: 0.8913658261299133, 
fpr: 0.21251819505094613, tpr: 0.9584828293182983, threshold: 0.8895220160484314, 
fpr: 0.22125181950509462, tpr: 0.9584828293182983, threshold: 0.8795212507247925, 
fpr: 0.22125181950509462, tpr: 0.9595079446437724, threshold: 0.8759840130805969, 
fpr: 0.22416302765647744, tpr: 0.9595079446437724, threshold: 0.873515248298645, 
fpr: 0.22416302765647744, tpr: 0.9600205023065095, threshold: 0.8716053366661072, 
fpr: 0.22852983988355166, tpr: 0.9600205023065095, threshold: 0.8632043600082397, 
fpr: 0.22852983988355166, tpr: 0.9605330599692465, threshold: 0.8616324663162231, 
fpr: 0.22998544395924309, tpr: 0.9605330599692465, threshold: 0.8612679839134216, 
fpr: 0.22998544395924309, tpr: 0.9620707329574577, threshold: 0.852908730506897, 
fpr: 0.2314410480349345, tpr: 0.9620707329574577, threshold: 0.8522019386291504, 
fpr: 0.2314410480349345, tpr: 0.9641209636084059, threshold: 0.8402789235115051, 
fpr: 0.23871906841339155, tpr: 0.9641209636084059, threshold: 0.8314697742462158, 
fpr: 0.23871906841339155, tpr: 0.964633521271143, threshold: 0.829988956451416, 
fpr: 0.24017467248908297, tpr: 0.964633521271143, threshold: 0.828140914440155, 
fpr: 0.24017467248908297, tpr: 0.9661711942593542, threshold: 0.822866678237915, 
fpr: 0.24163027656477437, tpr: 0.9661711942593542, threshold: 0.8195925951004028, 
fpr: 0.24163027656477437, tpr: 0.9666837519220912, threshold: 0.81767737865448, 
fpr: 0.2430858806404658, tpr: 0.9666837519220912, threshold: 0.8166140913963318, 
fpr: 0.2430858806404658, tpr: 0.9671963095848283, threshold: 0.8103572726249695, 
fpr: 0.24745269286754004, tpr: 0.9671963095848283, threshold: 0.7985800504684448, 
fpr: 0.24745269286754004, tpr: 0.9677088672475653, threshold: 0.7966655492782593, 
fpr: 0.24890829694323144, tpr: 0.9677088672475653, threshold: 0.7957955002784729, 
fpr: 0.24890829694323144, tpr: 0.9682214249103024, threshold: 0.7907612323760986, 
fpr: 0.25327510917030566, tpr: 0.9682214249103024, threshold: 0.7898087501525879, 
fpr: 0.25327510917030566, tpr: 0.9692465402357765, threshold: 0.7878609299659729, 
fpr: 0.2561863173216885, tpr: 0.9692465402357765, threshold: 0.7831438183784485, 
fpr: 0.2561863173216885, tpr: 0.9697590978985136, threshold: 0.7829015254974365, 
fpr: 0.2576419213973799, tpr: 0.9697590978985136, threshold: 0.7822796702384949, 
fpr: 0.2576419213973799, tpr: 0.9702716555612506, threshold: 0.770949125289917, 
fpr: 0.2590975254730713, tpr: 0.9702716555612506, threshold: 0.769717276096344, 
fpr: 0.2590975254730713, tpr: 0.9707842132239877, threshold: 0.7614907622337341, 
fpr: 0.26200873362445415, tpr: 0.9707842132239877, threshold: 0.7510573863983154, 
fpr: 0.26200873362445415, tpr: 0.9718093285494618, threshold: 0.747218668460846, 
fpr: 0.26346433770014555, tpr: 0.9718093285494618, threshold: 0.7458822727203369, 
fpr: 0.26346433770014555, tpr: 0.9723218862121988, threshold: 0.7415589690208435, 
fpr: 0.2663755458515284, tpr: 0.9723218862121988, threshold: 0.7322437763214111, 
fpr: 0.2663755458515284, tpr: 0.973347001537673, threshold: 0.7266204357147217, 
fpr: 0.2692867540029112, tpr: 0.973347001537673, threshold: 0.7104825973510742, 
fpr: 0.2692867540029112, tpr: 0.9743721168631471, threshold: 0.7050279974937439, 
fpr: 0.27074235807860264, tpr: 0.9743721168631471, threshold: 0.7041338086128235, 
fpr: 0.27074235807860264, tpr: 0.9748846745258841, threshold: 0.7037323713302612, 
fpr: 0.2794759825327511, tpr: 0.9748846745258841, threshold: 0.6795753836631775, 
fpr: 0.2794759825327511, tpr: 0.9753972321886212, threshold: 0.6795369982719421, 
fpr: 0.2954876273653566, tpr: 0.9753972321886212, threshold: 0.625548243522644, 
fpr: 0.2954876273653566, tpr: 0.9759097898513582, threshold: 0.6086037158966064, 
fpr: 0.29839883551673946, tpr: 0.9759097898513582, threshold: 0.5957858562469482, 
fpr: 0.29839883551673946, tpr: 0.9764223475140953, threshold: 0.5943182110786438, 
fpr: 0.3129548762736536, tpr: 0.9764223475140953, threshold: 0.5561972260475159, 
fpr: 0.3129548762736536, tpr: 0.9779600205023065, threshold: 0.5449331402778625, 
fpr: 0.3158660844250364, tpr: 0.9779600205023065, threshold: 0.5371198058128357, 
fpr: 0.3158660844250364, tpr: 0.9784725781650435, threshold: 0.5345302820205688, 
fpr: 0.32023289665211063, tpr: 0.9784725781650435, threshold: 0.5140659213066101, 
fpr: 0.32023289665211063, tpr: 0.9789851358277806, threshold: 0.5072743892669678, 
fpr: 0.3245997088791849, tpr: 0.9789851358277806, threshold: 0.49410638213157654, 
fpr: 0.3245997088791849, tpr: 0.9794976934905176, threshold: 0.4867396950721741, 
fpr: 0.3289665211062591, tpr: 0.9794976934905176, threshold: 0.4772432744503021, 
fpr: 0.3289665211062591, tpr: 0.9800102511532548, threshold: 0.47436994314193726, 
fpr: 0.33770014556040756, tpr: 0.9800102511532548, threshold: 0.4565143287181854, 
fpr: 0.33770014556040756, tpr: 0.9805228088159919, threshold: 0.45216184854507446, 
fpr: 0.363901018922853, tpr: 0.9805228088159919, threshold: 0.39295482635498047, 
fpr: 0.363901018922853, tpr: 0.9810353664787289, threshold: 0.3906111717224121, 
fpr: 0.37700145560407566, tpr: 0.9810353664787289, threshold: 0.34976911544799805, 
fpr: 0.37700145560407566, tpr: 0.981547924141466, threshold: 0.34712138772010803, 
fpr: 0.388646288209607, tpr: 0.981547924141466, threshold: 0.3200167119503021, 
fpr: 0.388646288209607, tpr: 0.982060481804203, threshold: 0.3184436559677124, 
fpr: 0.40465793304221254, tpr: 0.982060481804203, threshold: 0.2913200855255127, 
fpr: 0.40465793304221254, tpr: 0.9830855971296771, threshold: 0.2879619002342224, 
fpr: 0.4497816593886463, tpr: 0.9830855971296771, threshold: 0.19498611986637115, 
fpr: 0.4497816593886463, tpr: 0.9835981547924142, threshold: 0.1935291737318039, 
fpr: 0.47016011644832606, tpr: 0.9835981547924142, threshold: 0.1556326150894165, 
fpr: 0.47016011644832606, tpr: 0.9841107124551512, threshold: 0.15530844032764435, 
fpr: 0.4890829694323144, tpr: 0.9841107124551512, threshold: 0.1355399340391159, 
fpr: 0.4890829694323144, tpr: 0.9846232701178883, threshold: 0.13502873480319977, 
fpr: 0.5138282387190685, tpr: 0.9846232701178883, threshold: 0.10050059854984283, 
fpr: 0.5138282387190685, tpr: 0.9851358277806254, threshold: 0.09746570140123367, 
fpr: 0.5181950509461426, tpr: 0.9851358277806254, threshold: 0.0943087711930275, 
fpr: 0.5181950509461426, tpr: 0.9856483854433624, threshold: 0.09307527542114258, 
fpr: 0.5211062590975255, tpr: 0.9856483854433624, threshold: 0.09146635234355927, 
fpr: 0.5211062590975255, tpr: 0.9861609431060995, threshold: 0.09133019298315048, 
fpr: 0.5458515283842795, tpr: 0.9861609431060995, threshold: 0.06208222731947899, 
fpr: 0.5458515283842795, tpr: 0.9866735007688365, threshold: 0.06141958385705948, 
fpr: 0.5967976710334789, tpr: 0.9866735007688365, threshold: 0.038589660078287125, 
fpr: 0.5967976710334789, tpr: 0.9871860584315736, threshold: 0.03772192820906639, 
fpr: 0.6273653566229985, tpr: 0.9871860584315736, threshold: 0.025136852636933327, 
fpr: 0.6273653566229985, tpr: 0.9876986160943106, threshold: 0.02506081573665142, 
fpr: 0.6739446870451238, tpr: 0.9876986160943106, threshold: 0.015553632751107216, 
fpr: 0.6739446870451238, tpr: 0.9887237314197848, threshold: 0.01483536884188652, 
fpr: 0.6885007278020379, tpr: 0.9887237314197848, threshold: 0.013175024650990963, 
fpr: 0.6885007278020379, tpr: 0.9892362890825218, threshold: 0.013118264265358448, 
fpr: 0.6986899563318777, tpr: 0.9892362890825218, threshold: 0.01161257829517126, 
fpr: 0.6986899563318777, tpr: 0.9897488467452589, threshold: 0.011416638270020485, 
fpr: 0.7307132459970888, tpr: 0.9897488467452589, threshold: 0.008352404460310936, 
fpr: 0.7307132459970888, tpr: 0.9902614044079959, threshold: 0.008203022181987762, 
fpr: 0.7583697234352256, tpr: 0.9902614044079959, threshold: 0.006596886087208986, 
fpr: 0.7583697234352256, tpr: 0.990773962070733, threshold: 0.006581894122064114, 
fpr: 0.7671033478893741, tpr: 0.990773962070733, threshold: 0.0062103052623569965, 
fpr: 0.7671033478893741, tpr: 0.99128651973347, threshold: 0.006145499646663666, 
fpr: 0.7787481804949054, tpr: 0.99128651973347, threshold: 0.005161687266081572, 
fpr: 0.7787481804949054, tpr: 0.9917990773962071, threshold: 0.005102385766804218, 
fpr: 0.7816593886462883, tpr: 0.9917990773962071, threshold: 0.005082869436591864, 
fpr: 0.7816593886462883, tpr: 0.9923116350589442, threshold: 0.005013140384107828, 
fpr: 0.8558951965065502, tpr: 0.9923116350589442, threshold: 0.0019326185574755073, 
fpr: 0.8558951965065502, tpr: 0.9928241927216812, threshold: 0.0019038888858631253, 
fpr: 0.8646288209606987, tpr: 0.9928241927216812, threshold: 0.0015785001451149583, 
fpr: 0.8646288209606987, tpr: 0.9933367503844183, threshold: 0.0015742660034447908, 
fpr: 0.8675400291120815, tpr: 0.9933367503844183, threshold: 0.001556291477754712, 
fpr: 0.8675400291120815, tpr: 0.9938493080471553, threshold: 0.0015153678832575679, 
fpr: 0.868995633187773, tpr: 0.9938493080471553, threshold: 0.001501572667621076, 
fpr: 0.868995633187773, tpr: 0.9943618657098924, threshold: 0.0014835422625765204, 
fpr: 0.9126637554585153, tpr: 0.9943618657098924, threshold: 0.0009022101876325905, 
fpr: 0.9126637554585153, tpr: 0.9953869810353665, threshold: 0.0008610237273387611, 
fpr: 0.9315866084425036, tpr: 0.9953869810353665, threshold: 0.0005569373024627566, 
fpr: 0.9315866084425036, tpr: 0.9958995386981035, threshold: 0.0005447693984024227, 
fpr: 0.9359534206695779, tpr: 0.9958995386981035, threshold: 0.0005117725231684744, 
fpr: 0.9359534206695779, tpr: 0.9964120963608406, threshold: 0.0004891980206593871, 
fpr: 0.9388646288209607, tpr: 0.9964120963608406, threshold: 0.00047727295896038413, 
fpr: 0.9388646288209607, tpr: 0.9969246540235777, threshold: 0.00045446300646290183, 
fpr: 0.9417758369723436, tpr: 0.9969246540235777, threshold: 0.00043436247506178916, 
fpr: 0.9417758369723436, tpr: 0.9974372116863147, threshold: 0.0004211639752611518, 
fpr: 0.9446870451237264, tpr: 0.9974372116863147, threshold: 0.00041114140185527503, 
fpr: 0.9446870451237264, tpr: 0.9979497693490518, threshold: 0.0004089105350431055, 
fpr: 0.9577874818049491, tpr: 0.9979497693490518, threshold: 0.00030236196471378207, 
fpr: 0.9577874818049491, tpr: 0.9989748846745259, threshold: 0.0002721427008509636, 
fpr: 0.9650655021834061, tpr: 0.9989748846745259, threshold: 0.00021039540297351778, 
fpr: 0.9650655021834061, tpr: 0.9994874423372629, threshold: 0.00018098304281011224, 
fpr: 0.9839883551673945, tpr: 0.9994874423372629, threshold: 8.502764831064269e-05, 
fpr: 0.9839883551673945, tpr: 1.0, threshold: 6.919141014805064e-05, 
fpr: 1.0, tpr: 1.0, threshold: 2.036454560538914e-07, 

=== best_threshold: 0.9900463223457336, best_fpr: 0.11499272197962154, best_tpr: 0.8959507944643772 ===
