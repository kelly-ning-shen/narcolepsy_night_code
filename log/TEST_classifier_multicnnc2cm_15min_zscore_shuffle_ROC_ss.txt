cuda:0
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3605440032893215
Starting epoch 2/10.
Epoch finished! Loss: 1.0221652098542429
Starting epoch 3/10.
Epoch finished! Loss: 0.8714402909479836
Starting epoch 4/10.
Epoch finished! Loss: 0.8029461680015841
Starting epoch 5/10.
Epoch finished! Loss: 0.766518782838551
Starting epoch 6/10.
Epoch finished! Loss: 0.7479190470158369
Starting epoch 7/10.
Epoch finished! Loss: 0.7197276817427741
Starting epoch 8/10.
Epoch finished! Loss: 0.7283432154819883
Starting epoch 9/10.
Epoch finished! Loss: 0.7160445305579467
Starting epoch 10/10.
Epoch finished! Loss: 0.708268577796746
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.9115384615384615
              precision    recall  f1-score   support

         0.0       0.88      0.96      0.92        78
         1.0       0.54      0.14      0.22        50
         2.0       0.94      0.95      0.95       397
         3.0       0.93      0.99      0.96       143
         4.0       0.85      0.99      0.91       112

    accuracy                           0.91       780
   macro avg       0.83      0.81      0.79       780
weighted avg       0.90      0.91      0.89       780
 


====== chc001-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.33  96.15   98.58  88.24     92.02
1  93.72  14.00   99.18  53.85     22.22
2  94.49  94.71   94.26  94.47     94.59
3  98.46  99.30   98.27  92.81     95.95
4  97.31  99.11   97.01  84.73     91.36
Total accuracy: 91.15%
Average sen: 80.65%
Average spec: 97.46%
Macro f1-score: 79.23%

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2672690728536018
Starting epoch 2/10.
Epoch finished! Loss: 0.9964093155585803
Starting epoch 3/10.
Epoch finished! Loss: 0.8832550842028398
Starting epoch 4/10.
Epoch finished! Loss: 0.811394642178829
Starting epoch 5/10.
Epoch finished! Loss: 0.7936710565136029
Starting epoch 6/10.
Epoch finished! Loss: 0.7622255575198393
Starting epoch 7/10.
Epoch finished! Loss: 0.7457589099040398
Starting epoch 8/10.
Epoch finished! Loss: 0.7419146256951186
Starting epoch 9/10.
Epoch finished! Loss: 0.7366473015684348
Starting epoch 10/10.
Epoch finished! Loss: 0.7146291468005914
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.84
              precision    recall  f1-score   support

         0.0       0.87      0.88      0.87        74
         1.0       0.36      0.48      0.41        42
         2.0       0.88      0.84      0.86       515
         3.0       0.87      0.80      0.84       243
         4.0       0.83      0.95      0.89       176

    accuracy                           0.84      1050
   macro avg       0.76      0.79      0.77      1050
weighted avg       0.85      0.84      0.84      1050
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.19  87.84   98.98  86.67     87.25
1  94.57  47.62   96.53  36.36     41.24
2  86.67  84.27   88.97  88.03     86.11
3  92.67  80.25   96.41  87.05     83.51
4  95.90  95.45   96.00  82.76     88.65
Total accuracy: 84.00%
Average sen: 79.09%
Average spec: 95.38%
Macro f1-score: 77.35%

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2386892495247035
Starting epoch 2/10.
Epoch finished! Loss: 0.966755654490911
Starting epoch 3/10.
Epoch finished! Loss: 0.8600866505732903
Starting epoch 4/10.
Epoch finished! Loss: 0.8184544018827952
Starting epoch 5/10.
Epoch finished! Loss: 0.7891989117631546
Starting epoch 6/10.
Epoch finished! Loss: 0.7728095186444429
Starting epoch 7/10.
Epoch finished! Loss: 0.7412910824784866
Starting epoch 8/10.
Epoch finished! Loss: 0.7224382839523829
Starting epoch 9/10.
Epoch finished! Loss: 0.7155440021019716
Starting epoch 10/10.
Epoch finished! Loss: 0.7055380884271402
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8451612903225807
              precision    recall  f1-score   support

         0.0       0.73      1.00      0.85        41
         1.0       0.62      0.15      0.24        33
         2.0       0.91      0.85      0.88       530
         3.0       0.90      0.86      0.88       236
         4.0       0.59      0.92      0.72        90

    accuracy                           0.85       930
   macro avg       0.75      0.76      0.71       930
weighted avg       0.86      0.85      0.84       930
 


====== chc005-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.39  100.00   98.31  73.21     84.54
1  96.67   15.15   99.67  62.50     24.39
2  86.67   85.47   88.25  90.60     87.96
3  94.19   86.44   96.83  90.27     88.31
4  93.12   92.22   93.21  59.29     72.17
Total accuracy: 84.52%
Average sen: 75.86%
Average spec: 95.25%
Macro f1-score: 71.47%

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.352168122927348
Starting epoch 2/10.
Epoch finished! Loss: 0.9881177560579731
Starting epoch 3/10.
Epoch finished! Loss: 0.8816276053359225
Starting epoch 4/10.
Epoch finished! Loss: 0.8154862899889891
Starting epoch 5/10.
Epoch finished! Loss: 0.7812836822193702
Starting epoch 6/10.
Epoch finished! Loss: 0.7481422847943288
Starting epoch 7/10.
Epoch finished! Loss: 0.7264775462534235
Starting epoch 8/10.
Epoch finished! Loss: 0.7388959254113193
Starting epoch 9/10.
Epoch finished! Loss: 0.7069165813968556
Starting epoch 10/10.
Epoch finished! Loss: 0.7047982190760617
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7938271604938272
              precision    recall  f1-score   support

         0.0       0.95      0.83      0.89       158
         1.0       0.65      0.46      0.54       103
         2.0       0.74      0.96      0.84       306
         3.0       1.00      0.51      0.68       133
         4.0       0.76      0.94      0.84       110

    accuracy                           0.79       810
   macro avg       0.82      0.74      0.75       810
weighted avg       0.82      0.79      0.78       810
 


====== chc006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.80  82.91   98.93   94.93     88.51
1  90.00  45.63   96.46   65.28     53.71
2  85.93  96.08   79.76   74.24     83.76
3  91.98  51.13  100.00  100.00     67.66
4  95.06  93.64   95.29   75.74     83.74
Total accuracy: 79.38%
Average sen: 73.88%
Average spec: 94.09%
Macro f1-score: 75.48%

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3054397229964916
Starting epoch 2/10.
Epoch finished! Loss: 1.0148190537324318
Starting epoch 3/10.
Epoch finished! Loss: 0.8626206585994134
Starting epoch 4/10.
Epoch finished! Loss: 0.8043847139065082
Starting epoch 5/10.
Epoch finished! Loss: 0.7707434164790007
Starting epoch 6/10.
Epoch finished! Loss: 0.7628739763910953
Starting epoch 7/10.
Epoch finished! Loss: 0.7394861419613544
Starting epoch 8/10.
Epoch finished! Loss: 0.7235137683840899
Starting epoch 9/10.
Epoch finished! Loss: 0.7154233122101197
Starting epoch 10/10.
Epoch finished! Loss: 0.7008452342106746
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7072916666666667
              precision    recall  f1-score   support

         0.0       0.93      0.95      0.94       144
         1.0       0.46      0.67      0.55        82
         2.0       0.67      0.73      0.70       379
         3.0       1.00      0.43      0.60       227
         4.0       0.62      0.88      0.72       128

    accuracy                           0.71       960
   macro avg       0.74      0.73      0.70       960
weighted avg       0.76      0.71      0.70       960
 


====== chc008-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  98.23  95.14   98.77   93.20     94.16
1  90.52  67.07   92.71   46.22     54.73
2  75.10  73.09   76.42   66.91     69.86
3  86.56  43.17  100.00  100.00     60.31
4  91.04  87.50   91.59   61.54     72.26
Total accuracy: 70.73%
Average sen: 73.19%
Average spec: 91.90%
Macro f1-score: 70.26%

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2909925123819939
Starting epoch 2/10.
Epoch finished! Loss: 0.9685922010586812
Starting epoch 3/10.
Epoch finished! Loss: 0.8494011179758952
Starting epoch 4/10.
Epoch finished! Loss: 0.7953338482058965
Starting epoch 5/10.
Epoch finished! Loss: 0.7639956807860961
Starting epoch 6/10.
Epoch finished! Loss: 0.7428222704392213
Starting epoch 7/10.
Epoch finished! Loss: 0.7371507301926613
Starting epoch 8/10.
Epoch finished! Loss: 0.7255481229378626
Starting epoch 9/10.
Epoch finished! Loss: 0.711164771249661
Starting epoch 10/10.
Epoch finished! Loss: 0.6994452008834252
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8080459770114943
              precision    recall  f1-score   support

         0.0       0.92      0.93      0.92        72
         1.0       0.29      0.46      0.36        46
         2.0       0.94      0.71      0.81       443
         3.0       0.87      0.95      0.91       196
         4.0       0.64      1.00      0.78       113

    accuracy                           0.81       870
   macro avg       0.73      0.81      0.76       870
weighted avg       0.85      0.81      0.81       870
 


====== chc009-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.74   93.06   99.25  91.78     92.41
1  91.26   45.65   93.81  29.17     35.59
2  83.10   71.11   95.55  94.31     81.08
3  95.75   95.41   95.85  86.98     91.00
4  92.76  100.00   91.68  64.20     78.20
Total accuracy: 80.80%
Average sen: 81.04%
Average spec: 95.23%
Macro f1-score: 75.66%

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.220957728074147
Starting epoch 2/10.
Epoch finished! Loss: 0.9669742815769635
Starting epoch 3/10.
Epoch finished! Loss: 0.8523989494030292
Starting epoch 4/10.
Epoch finished! Loss: 0.802198955989801
Starting epoch 5/10.
Epoch finished! Loss: 0.7643583005437484
Starting epoch 6/10.
Epoch finished! Loss: 0.7320905837875146
Starting epoch 7/10.
Epoch finished! Loss: 0.7217896451170628
Starting epoch 8/10.
Epoch finished! Loss: 0.7190337294569382
Starting epoch 9/10.
Epoch finished! Loss: 0.7082715795590327
Starting epoch 10/10.
Epoch finished! Loss: 0.7100584270862432
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7845238095238095
              precision    recall  f1-score   support

         0.0       0.92      0.89      0.91       123
         1.0       0.59      0.47      0.52        43
         2.0       0.72      0.98      0.83       400
         3.0       0.98      0.32      0.48       193
         4.0       0.95      0.91      0.93        81

    accuracy                           0.78       840
   macro avg       0.83      0.71      0.73       840
weighted avg       0.83      0.78      0.76       840
 


====== chc010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.38  89.43   98.74  92.44     90.91
1  95.60  46.51   98.24  58.82     51.95
2  81.07  98.50   65.23  72.03     83.21
3  84.17  31.61   99.85  98.39     47.84
4  98.69  91.36   99.47  94.87     93.08
Total accuracy: 78.45%
Average sen: 71.48%
Average spec: 92.31%
Macro f1-score: 73.40%

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3076544743317824
Starting epoch 2/10.
Epoch finished! Loss: 1.0461724107082073
Starting epoch 3/10.
Epoch finished! Loss: 0.9493833342423805
Starting epoch 4/10.
Epoch finished! Loss: 0.8865336071986418
Starting epoch 5/10.
Epoch finished! Loss: 0.853857412475806
Starting epoch 6/10.
Epoch finished! Loss: 0.8282507330179214
Starting epoch 7/10.
Epoch finished! Loss: 0.7990990795768225
Starting epoch 8/10.
Epoch finished! Loss: 0.7872178634771934
Starting epoch 9/10.
Epoch finished! Loss: 0.7612781641575006
Starting epoch 10/10.
Epoch finished! Loss: 0.7443704914588195
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8377777777777777
              precision    recall  f1-score   support

         0.0       0.88      0.97      0.92        63
         1.0       0.33      0.23      0.27        22
         2.0       0.85      0.91      0.88       541
         3.0       0.99      0.64      0.78       204
         4.0       0.59      0.90      0.72        70

    accuracy                           0.84       900
   macro avg       0.73      0.73      0.71       900
weighted avg       0.85      0.84      0.83       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.89  96.83   99.04  88.41     92.42
1  97.00  22.73   98.86  33.33     27.03
2  85.44  91.31   76.60  85.47     88.29
3  91.78  64.22   99.86  99.24     77.98
4  94.44  90.00   94.82  59.43     71.59
Total accuracy: 83.78%
Average sen: 73.02%
Average spec: 93.84%
Macro f1-score: 71.46%

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2106111769492809
Starting epoch 2/10.
Epoch finished! Loss: 1.002333887723776
Starting epoch 3/10.
Epoch finished! Loss: 0.8926109806849406
Starting epoch 4/10.
Epoch finished! Loss: 0.8099483240109223
Starting epoch 5/10.
Epoch finished! Loss: 0.7835394667891356
Starting epoch 6/10.
Epoch finished! Loss: 0.7471743722374623
Starting epoch 7/10.
Epoch finished! Loss: 0.7170185246146642
Starting epoch 8/10.
Epoch finished! Loss: 0.7171459907522568
Starting epoch 9/10.
Epoch finished! Loss: 0.7051026723705806
Starting epoch 10/10.
Epoch finished! Loss: 0.7044466306383793
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8129032258064516
              precision    recall  f1-score   support

         0.0       1.00      0.61      0.76        69
         1.0       0.34      0.76      0.47        38
         2.0       0.84      0.84      0.84       434
         3.0       1.00      0.77      0.87       228
         4.0       0.74      0.90      0.81       161

    accuracy                           0.81       930
   macro avg       0.79      0.78      0.75       930
weighted avg       0.86      0.81      0.82       930
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.10  60.87  100.00  100.00     75.68
1  92.90  76.32   93.61   33.72     46.77
2  85.38  84.10   86.49   84.49     84.30
3  94.30  76.75  100.00  100.00     86.85
4  92.90  90.06   93.50   74.36     81.46
Total accuracy: 81.29%
Average sen: 77.62%
Average spec: 94.72%
Macro f1-score: 75.01%

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.251567438015571
Starting epoch 2/10.
Epoch finished! Loss: 0.9871679067611694
Starting epoch 3/10.
Epoch finished! Loss: 0.8644349017968544
Starting epoch 4/10.
Epoch finished! Loss: 0.8109203446369905
Starting epoch 5/10.
Epoch finished! Loss: 0.7741668023742162
Starting epoch 6/10.
Epoch finished! Loss: 0.7661487099069816
Starting epoch 7/10.
Epoch finished! Loss: 0.743179141328885
Starting epoch 8/10.
Epoch finished! Loss: 0.7222994875449401
Starting epoch 9/10.
Epoch finished! Loss: 0.7235681107411018
Starting epoch 10/10.
Epoch finished! Loss: 0.7063099963160662
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.9311827956989247
              precision    recall  f1-score   support

         0.0       0.99      1.00      1.00       240
         1.0       0.40      0.33      0.36         6
         2.0       0.94      0.91      0.93       439
         3.0       0.93      0.90      0.91       170
         4.0       0.77      0.93      0.84        75

    accuracy                           0.93       930
   macro avg       0.81      0.82      0.81       930
weighted avg       0.93      0.93      0.93       930
 


====== chc014-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  99.78  100.00   99.71  99.17     99.59
1  99.25   33.33   99.68  40.00     36.36
2  93.12   91.34   94.70  93.91     92.61
3  96.88   90.00   98.42  92.73     91.34
4  97.20   93.33   97.54  76.92     84.34
Total accuracy: 93.12%
Average sen: 81.60%
Average spec: 98.01%
Macro f1-score: 80.85%

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3812210656129398
Starting epoch 2/10.
Epoch finished! Loss: 1.0565417445622958
Starting epoch 3/10.
Epoch finished! Loss: 0.9179987462667318
Starting epoch 4/10.
Epoch finished! Loss: 0.8446988678895511
Starting epoch 5/10.
Epoch finished! Loss: 0.8129341480823663
Starting epoch 6/10.
Epoch finished! Loss: 0.7825706634383935
Starting epoch 7/10.
Epoch finished! Loss: 0.7465178553874676
Starting epoch 8/10.
Epoch finished! Loss: 0.7422294367964452
Starting epoch 9/10.
Epoch finished! Loss: 0.7323359135251779
Starting epoch 10/10.
Epoch finished! Loss: 0.7207826234973393
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8634408602150537
              precision    recall  f1-score   support

         0.0       0.80      0.95      0.87        38
         1.0       0.43      0.42      0.42        83
         2.0       0.91      0.92      0.92       502
         3.0       0.95      0.99      0.97       166
         4.0       0.87      0.74      0.80       141

    accuracy                           0.86       930
   macro avg       0.79      0.80      0.80       930
weighted avg       0.86      0.86      0.86       930
 


====== chc015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.82  94.74   98.99  80.00     86.75
1  89.78  42.17   94.45  42.68     42.42
2  90.75  92.23   89.02  90.78     91.50
3  98.92  98.80   98.95  95.35     97.04
4  94.41  74.47   97.97  86.78     80.15
Total accuracy: 86.34%
Average sen: 80.48%
Average spec: 95.88%
Macro f1-score: 79.57%

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.254865171817633
Starting epoch 2/10.
Epoch finished! Loss: 1.0060414112531222
Starting epoch 3/10.
Epoch finished! Loss: 0.8980807856871531
Starting epoch 4/10.
Epoch finished! Loss: 0.857296380171409
Starting epoch 5/10.
Epoch finished! Loss: 0.820268976688385
Starting epoch 6/10.
Epoch finished! Loss: 0.7906242254834909
Starting epoch 7/10.
Epoch finished! Loss: 0.7793483758201966
Starting epoch 8/10.
Epoch finished! Loss: 0.7577316794257898
Starting epoch 9/10.
Epoch finished! Loss: 0.7412330493330955
Starting epoch 10/10.
Epoch finished! Loss: 0.7225296158056993
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8634408602150537
              precision    recall  f1-score   support

         0.0       0.86      1.00      0.92       226
         1.0       0.27      0.47      0.35        55
         2.0       0.97      0.82      0.89       410
         3.0       0.97      0.93      0.95       108
         4.0       0.92      0.89      0.91       131

    accuracy                           0.86       930
   macro avg       0.80      0.82      0.80       930
weighted avg       0.90      0.86      0.87       930
 


====== chc016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.02  99.56   94.89  86.21     92.40
1  89.46  47.27   92.11  27.37     34.67
2  90.97  81.71   98.27  97.38     88.86
3  98.82  92.59   99.64  97.09     94.79
4  97.42  89.31   98.75  92.13     90.70
Total accuracy: 86.34%
Average sen: 82.09%
Average spec: 96.73%
Macro f1-score: 80.28%

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2388985083934447
Starting epoch 2/10.
Epoch finished! Loss: 0.9692188135965574
Starting epoch 3/10.
Epoch finished! Loss: 0.8654240132291655
Starting epoch 4/10.
Epoch finished! Loss: 0.8237412960136531
Starting epoch 5/10.
Epoch finished! Loss: 0.7712896079167553
Starting epoch 6/10.
Epoch finished! Loss: 0.7710786093012126
Starting epoch 7/10.
Epoch finished! Loss: 0.7482280853379275
Starting epoch 8/10.
Epoch finished! Loss: 0.7317599529735886
Starting epoch 9/10.
Epoch finished! Loss: 0.7040914913703655
Starting epoch 10/10.
Epoch finished! Loss: 0.7019467294444526
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8629629629629629
              precision    recall  f1-score   support

         0.0       0.99      0.97      0.98       102
         1.0       0.50      0.40      0.44        15
         2.0       0.88      0.84      0.86       397
         3.0       0.78      0.92      0.84       187
         4.0       0.89      0.81      0.85       109

    accuracy                           0.86       810
   macro avg       0.81      0.79      0.80       810
weighted avg       0.87      0.86      0.86       810
 


====== chc022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  99.51  97.06   99.86  99.00     98.02
1  98.15  40.00   99.25  50.00     44.44
2  86.79  84.13   89.35  88.36     86.19
3  92.10  91.98   92.13  77.83     84.31
4  96.05  80.73   98.43  88.89     84.62
Total accuracy: 86.30%
Average sen: 78.78%
Average spec: 95.80%
Macro f1-score: 79.52%

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3079269886930327
Starting epoch 2/10.
Epoch finished! Loss: 1.0427348597753094
Starting epoch 3/10.
Epoch finished! Loss: 0.935806179183653
Starting epoch 4/10.
Epoch finished! Loss: 0.8669523662990994
Starting epoch 5/10.
Epoch finished! Loss: 0.7991668166328664
Starting epoch 6/10.
Epoch finished! Loss: 0.7835159944620169
Starting epoch 7/10.
Epoch finished! Loss: 0.7549795549491356
Starting epoch 8/10.
Epoch finished! Loss: 0.7354678980920507
Starting epoch 9/10.
Epoch finished! Loss: 0.7163300110005785
Starting epoch 10/10.
Epoch finished! Loss: 0.7235312935721372
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7320987654320987
              precision    recall  f1-score   support

         0.0       0.31      0.53      0.39        30
         1.0       0.29      0.64      0.40        67
         2.0       0.85      0.83      0.84       427
         3.0       0.99      0.82      0.90       114
         4.0       0.90      0.50      0.64       172

    accuracy                           0.73       810
   macro avg       0.67      0.67      0.63       810
weighted avg       0.81      0.73      0.75       810
 


====== chc025-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.83  53.33   95.38  30.77     39.02
1  83.95  64.18   85.73  28.86     39.81
2  83.09  82.90   83.29  84.69     83.79
3  97.41  82.46   99.86  98.95     89.95
4  88.15  50.00   98.43  89.58     64.18
Total accuracy: 73.21%
Average sen: 66.57%
Average spec: 92.54%
Macro f1-score: 63.35%

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2782898128032685
Starting epoch 2/10.
Epoch finished! Loss: 0.9776622077593436
Starting epoch 3/10.
Epoch finished! Loss: 0.8421488562455544
Starting epoch 4/10.
Epoch finished! Loss: 0.7802966271455472
Starting epoch 5/10.
Epoch finished! Loss: 0.7578175676556734
Starting epoch 6/10.
Epoch finished! Loss: 0.7338021255456484
Starting epoch 7/10.
Epoch finished! Loss: 0.7197466508700298
Starting epoch 8/10.
Epoch finished! Loss: 0.7095699624373363
Starting epoch 9/10.
Epoch finished! Loss: 0.6961676085224519
Starting epoch 10/10.
Epoch finished! Loss: 0.6847377226902889
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8366666666666667
              precision    recall  f1-score   support

         0.0       0.96      0.78      0.86       277
         1.0       0.37      0.64      0.47        66
         2.0       0.83      0.93      0.88       293
         3.0       1.00      0.83      0.91       189
         4.0       0.86      0.88      0.87        75

    accuracy                           0.84       900
   macro avg       0.80      0.81      0.80       900
weighted avg       0.87      0.84      0.85       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.00  77.62   98.39   95.56     85.66
1  89.44  63.64   91.49   37.17     46.93
2  91.67  93.17   90.94   83.23     87.92
3  96.44  83.07  100.00  100.00     90.75
4  97.78  88.00   98.67   85.71     86.84
Total accuracy: 83.67%
Average sen: 81.10%
Average spec: 95.90%
Macro f1-score: 79.62%

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2613410933659628
Starting epoch 2/10.
Epoch finished! Loss: 1.0201013858501728
Starting epoch 3/10.
Epoch finished! Loss: 0.8939017722239861
Starting epoch 4/10.
Epoch finished! Loss: 0.8035070243936319
Starting epoch 5/10.
Epoch finished! Loss: 0.776082349396669
Starting epoch 6/10.
Epoch finished! Loss: 0.7439640370699075
Starting epoch 7/10.
Epoch finished! Loss: 0.7260901195498614
Starting epoch 8/10.
Epoch finished! Loss: 0.7130157762995133
Starting epoch 9/10.
Epoch finished! Loss: 0.7135678627170049
Starting epoch 10/10.
Epoch finished! Loss: 0.692350082557935
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7931034482758621
              precision    recall  f1-score   support

         0.0       0.80      0.85      0.82       119
         1.0       0.23      0.40      0.29        53
         2.0       0.97      0.73      0.83       460
         3.0       0.85      0.99      0.92       164
         4.0       0.61      0.93      0.74        74

    accuracy                           0.79       870
   macro avg       0.69      0.78      0.72       870
weighted avg       0.85      0.79      0.81       870
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.94  84.87   96.54  79.53     82.11
1  88.05  39.62   91.19  22.58     28.77
2  84.71  73.04   97.80  97.39     83.48
3  96.55  99.39   95.89  84.90     91.57
4  94.37  93.24   94.47  61.06     73.80
Total accuracy: 79.31%
Average sen: 78.03%
Average spec: 95.18%
Macro f1-score: 71.95%

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2613976418972015
Starting epoch 2/10.
Epoch finished! Loss: 0.9947461818273251
Starting epoch 3/10.
Epoch finished! Loss: 0.9112969013360831
Starting epoch 4/10.
Epoch finished! Loss: 0.8523225561930583
Starting epoch 5/10.
Epoch finished! Loss: 0.8248363528114099
Starting epoch 6/10.
Epoch finished! Loss: 0.786733991251542
Starting epoch 7/10.
Epoch finished! Loss: 0.7709699586033821
Starting epoch 8/10.
Epoch finished! Loss: 0.747753822688873
Starting epoch 9/10.
Epoch finished! Loss: 0.7359221924956029
Starting epoch 10/10.
Epoch finished! Loss: 0.7146406744535153
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8666666666666667
              precision    recall  f1-score   support

         0.0       0.84      0.86      0.85        59
         1.0       0.61      0.37      0.46        60
         2.0       0.91      0.90      0.90       389
         3.0       0.97      0.89      0.93       151
         4.0       0.79      0.93      0.85       211

    accuracy                           0.87       870
   macro avg       0.82      0.79      0.80       870
weighted avg       0.86      0.87      0.86       870
 


====== chc033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.93  86.44   98.77  83.61     85.00
1  94.02  36.67   98.27  61.11     45.83
2  91.38  89.72   92.72  90.89     90.30
3  97.70  89.40   99.44  97.12     93.10
4  92.30  93.36   91.96  78.80     85.47
Total accuracy: 86.67%
Average sen: 79.12%
Average spec: 96.23%
Macro f1-score: 79.94%

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2550020827696873
Starting epoch 2/10.
Epoch finished! Loss: 1.0443556462342922
Starting epoch 3/10.
Epoch finished! Loss: 0.95323526263237
Starting epoch 4/10.
Epoch finished! Loss: 0.8994259201563322
Starting epoch 5/10.
Epoch finished! Loss: 0.8594600984683404
Starting epoch 6/10.
Epoch finished! Loss: 0.8445843538412681
Starting epoch 7/10.
Epoch finished! Loss: 0.8024890893926987
Starting epoch 8/10.
Epoch finished! Loss: 0.7871479895252448
Starting epoch 9/10.
Epoch finished! Loss: 0.7690971360756801
Starting epoch 10/10.
Epoch finished! Loss: 0.7632465909306819
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8444444444444444
              precision    recall  f1-score   support

         0.0       0.76      0.90      0.83        29
         1.0       0.60      0.16      0.25        57
         2.0       0.82      0.91      0.86       391
         3.0       0.95      0.91      0.93       250
         4.0       0.80      0.83      0.81       173

    accuracy                           0.84       900
   macro avg       0.79      0.74      0.74       900
weighted avg       0.84      0.84      0.83       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.78  89.66   99.08  76.47     82.54
1  94.00  15.79   99.29  60.00     25.00
2  87.22  90.54   84.68  81.94     86.03
3  96.11  91.20   98.00  94.61     92.87
4  92.78  82.66   95.19  80.34     81.48
Total accuracy: 84.44%
Average sen: 73.97%
Average spec: 95.25%
Macro f1-score: 73.58%

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4000502914190291
Starting epoch 2/10.
Epoch finished! Loss: 1.0873627862105002
Starting epoch 3/10.
Epoch finished! Loss: 0.8887854674687752
Starting epoch 4/10.
Epoch finished! Loss: 0.8015823992399069
Starting epoch 5/10.
Epoch finished! Loss: 0.7713413874690349
Starting epoch 6/10.
Epoch finished! Loss: 0.7499440404085013
Starting epoch 7/10.
Epoch finished! Loss: 0.7324934486013193
Starting epoch 8/10.
Epoch finished! Loss: 0.72239388021139
Starting epoch 9/10.
Epoch finished! Loss: 0.7045674017988719
Starting epoch 10/10.
Epoch finished! Loss: 0.7030580179049418
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.9114942528735632
              precision    recall  f1-score   support

         0.0       0.92      1.00      0.96       154
         1.0       0.84      0.47      0.60        34
         2.0       0.88      0.93      0.91       307
         3.0       0.98      0.89      0.93       168
         4.0       0.91      0.90      0.91       207

    accuracy                           0.91       870
   macro avg       0.91      0.84      0.86       870
weighted avg       0.91      0.91      0.91       870
 


====== chc037-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.39  100.00   98.04  91.67     95.65
1  97.59   47.06   99.64  84.21     60.38
2  93.22   93.16   93.25  88.27     90.65
3  97.59   89.29   99.57  98.04     93.46
4  95.52   90.34   97.13  90.78     90.56
Total accuracy: 91.15%
Average sen: 83.97%
Average spec: 97.53%
Macro f1-score: 86.14%

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2192929955629201
Starting epoch 2/10.
Epoch finished! Loss: 0.9691855350366005
Starting epoch 3/10.
Epoch finished! Loss: 0.8508113646736511
Starting epoch 4/10.
Epoch finished! Loss: 0.7887747003481939
Starting epoch 5/10.
Epoch finished! Loss: 0.7751199307350012
Starting epoch 6/10.
Epoch finished! Loss: 0.7399305062798354
Starting epoch 7/10.
Epoch finished! Loss: 0.7375865368888929
Starting epoch 8/10.
Epoch finished! Loss: 0.7146149588318972
Starting epoch 9/10.
Epoch finished! Loss: 0.6913332544840299
Starting epoch 10/10.
Epoch finished! Loss: 0.6947384410179578
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7175925925925926
              precision    recall  f1-score   support

         0.0       0.98      0.65      0.78       185
         1.0       0.43      0.74      0.54        50
         2.0       0.69      0.90      0.78       483
         3.0       1.00      0.20      0.34       216
         4.0       0.69      0.94      0.80       146

    accuracy                           0.72      1080
   macro avg       0.76      0.69      0.65      1080
weighted avg       0.79      0.72      0.69      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.80  65.41   99.66   97.58     78.32
1  94.26  74.00   95.24   43.02     54.41
2  77.87  90.27   67.84   69.43     78.49
3  84.07  20.37  100.00  100.00     33.85
4  93.52  93.84   93.47   69.19     79.65
Total accuracy: 71.76%
Average sen: 68.78%
Average spec: 91.24%
Macro f1-score: 64.94%

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2927127718925475
Starting epoch 2/10.
Epoch finished! Loss: 1.0178790376736568
Starting epoch 3/10.
Epoch finished! Loss: 0.9021115176952802
Starting epoch 4/10.
Epoch finished! Loss: 0.8292634402330105
Starting epoch 5/10.
Epoch finished! Loss: 0.7983218026848939
Starting epoch 6/10.
Epoch finished! Loss: 0.772009399647896
Starting epoch 7/10.
Epoch finished! Loss: 0.7467361112053578
Starting epoch 8/10.
Epoch finished! Loss: 0.7329411058471753
Starting epoch 9/10.
Epoch finished! Loss: 0.7254160097012153
Starting epoch 10/10.
Epoch finished! Loss: 0.7124885467382578
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.794047619047619
              precision    recall  f1-score   support

         0.0       0.54      1.00      0.70        56
         1.0       0.21      0.39      0.27        38
         2.0       0.87      0.88      0.87       416
         3.0       0.99      0.77      0.87       188
         4.0       0.88      0.61      0.72       142

    accuracy                           0.79       840
   macro avg       0.70      0.73      0.69       840
weighted avg       0.85      0.79      0.81       840
 


====== chc041-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  94.40  100.00   94.01  54.37     70.44
1  90.36   39.47   92.77  20.55     27.03
2  87.26   87.50   87.03  86.87     87.19
3  94.76   77.13   99.85  99.32     86.83
4  92.02   61.27   98.28  87.88     72.20
Total accuracy: 79.40%
Average sen: 73.07%
Average spec: 94.39%
Macro f1-score: 68.74%

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.380670621074163
Starting epoch 2/10.
Epoch finished! Loss: 0.9958919836924627
Starting epoch 3/10.
Epoch finished! Loss: 0.8659474945985354
Starting epoch 4/10.
Epoch finished! Loss: 0.808992386666628
Starting epoch 5/10.
Epoch finished! Loss: 0.7829990687278601
Starting epoch 6/10.
Epoch finished! Loss: 0.748279883655218
Starting epoch 7/10.
Epoch finished! Loss: 0.7363798076143632
Starting epoch 8/10.
Epoch finished! Loss: 0.7155594979341213
Starting epoch 9/10.
Epoch finished! Loss: 0.707703542136229
Starting epoch 10/10.
Epoch finished! Loss: 0.7027126821187827
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8688888888888889
              precision    recall  f1-score   support

         0.0       0.92      0.99      0.96       142
         1.0       0.32      0.43      0.37        23
         2.0       0.94      0.82      0.88       466
         3.0       0.91      0.92      0.91       167
         4.0       0.68      0.94      0.79       102

    accuracy                           0.87       900
   macro avg       0.75      0.82      0.78       900
weighted avg       0.89      0.87      0.87       900
 


====== chc052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.56  99.30   98.42  92.16     95.59
1  96.22  43.48   97.61  32.26     37.04
2  88.00  81.76   94.70  94.31     87.59
3  96.78  92.22   97.82  90.59     91.39
4  94.22  94.12   94.24  67.61     78.69
Total accuracy: 86.89%
Average sen: 82.17%
Average spec: 96.56%
Macro f1-score: 78.06%

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2851409391714976
Starting epoch 2/10.
Epoch finished! Loss: 1.0241152105423121
Starting epoch 3/10.
Epoch finished! Loss: 0.9098832442210271
Starting epoch 4/10.
Epoch finished! Loss: 0.8175964541160143
Starting epoch 5/10.
Epoch finished! Loss: 0.7838162504709684
Starting epoch 6/10.
Epoch finished! Loss: 0.7663214170015775
Starting epoch 7/10.
Epoch finished! Loss: 0.7246383490470739
Starting epoch 8/10.
Epoch finished! Loss: 0.7213360666082456
Starting epoch 9/10.
Epoch finished! Loss: 0.7134476978045243
Starting epoch 10/10.
Epoch finished! Loss: 0.6855130084432088
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7766666666666666
              precision    recall  f1-score   support

         0.0       0.73      0.99      0.84       175
         1.0       0.28      0.21      0.24        86
         2.0       0.85      0.79      0.82       396
         3.0       1.00      0.76      0.86       153
         4.0       0.68      0.88      0.77        90

    accuracy                           0.78       900
   macro avg       0.71      0.73      0.71       900
weighted avg       0.78      0.78      0.77       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.89  99.43   91.31   73.42     84.47
1  87.22  20.93   94.23   27.69     23.84
2  84.67  78.79   89.29   85.25     81.89
3  95.89  75.82  100.00  100.00     86.25
4  94.67  87.78   95.43   68.10     76.70
Total accuracy: 77.67%
Average sen: 72.55%
Average spec: 94.05%
Macro f1-score: 70.63%

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2189565358474908
Starting epoch 2/10.
Epoch finished! Loss: 0.9313141050025763
Starting epoch 3/10.
Epoch finished! Loss: 0.8558338309807206
Starting epoch 4/10.
Epoch finished! Loss: 0.7883437031944747
Starting epoch 5/10.
Epoch finished! Loss: 0.7780177206606478
Starting epoch 6/10.
Epoch finished! Loss: 0.7455410424576763
Starting epoch 7/10.
Epoch finished! Loss: 0.7304108260221003
Starting epoch 8/10.
Epoch finished! Loss: 0.7238514452137081
Starting epoch 9/10.
Epoch finished! Loss: 0.7151011658911539
Starting epoch 10/10.
Epoch finished! Loss: 0.7035363804419529
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5543859649122806
              precision    recall  f1-score   support

         0.0       0.21      1.00      0.35        40
         1.0       0.14      0.66      0.23        79
         2.0       0.92      0.69      0.79       553
         3.0       1.00      0.57      0.72        69
         4.0       0.98      0.29      0.45       399

    accuracy                           0.55      1140
   macro avg       0.65      0.64      0.51      1140
weighted avg       0.87      0.55      0.61      1140
 


====== chp001-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  87.02  100.00   86.55   21.28     35.09
1  69.04   65.82   69.27   13.76     22.76
2  82.37   69.44   94.55   92.31     79.26
3  97.37   56.52  100.00  100.00     72.22
4  75.09   29.32   99.73   98.32     45.17
Total accuracy: 55.44%
Average sen: 64.22%
Average spec: 90.02%
Macro f1-score: 50.90%

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.404295808993853
Starting epoch 2/10.
Epoch finished! Loss: 1.0389499636796804
Starting epoch 3/10.
Epoch finished! Loss: 0.9020354717969894
Starting epoch 4/10.
Epoch finished! Loss: 0.8396132120719323
Starting epoch 5/10.
Epoch finished! Loss: 0.7890618673883951
Starting epoch 6/10.
Epoch finished! Loss: 0.7685395100942025
Starting epoch 7/10.
Epoch finished! Loss: 0.746082734144651
Starting epoch 8/10.
Epoch finished! Loss: 0.7499688220711854
Starting epoch 9/10.
Epoch finished! Loss: 0.7360783416491289
Starting epoch 10/10.
Epoch finished! Loss: 0.7032972808067616
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7981481481481482
              precision    recall  f1-score   support

         0.0       0.75      0.82      0.78       260
         1.0       0.69      0.59      0.64       248
         2.0       0.92      0.93      0.93       375
         3.0       1.00      0.85      0.92       169
         4.0       0.14      0.29      0.18        28

    accuracy                           0.80      1080
   macro avg       0.70      0.70      0.69      1080
weighted avg       0.82      0.80      0.81      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  89.07  81.92   91.34   75.00     78.31
1  84.54  59.27   92.07   69.01     63.77
2  94.91  93.33   95.74   92.11     92.72
3  97.69  85.21  100.00  100.00     92.01
4  93.43  28.57   95.15   13.56     18.39
Total accuracy: 79.81%
Average sen: 69.66%
Average spec: 94.86%
Macro f1-score: 69.04%

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3833095793540662
Starting epoch 2/10.
Epoch finished! Loss: 1.0391564988172972
Starting epoch 3/10.
Epoch finished! Loss: 0.8702653612081821
Starting epoch 4/10.
Epoch finished! Loss: 0.7958430111408233
Starting epoch 5/10.
Epoch finished! Loss: 0.7552442277853305
Starting epoch 6/10.
Epoch finished! Loss: 0.7406960809460053
Starting epoch 7/10.
Epoch finished! Loss: 0.7170335883131393
Starting epoch 8/10.
Epoch finished! Loss: 0.7094395264983178
Starting epoch 9/10.
Epoch finished! Loss: 0.6928697160803354
Starting epoch 10/10.
Epoch finished! Loss: 0.6978051628057773
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5383838383838384
              precision    recall  f1-score   support

         0.0       0.41      0.26      0.32        80
         1.0       0.09      0.97      0.16        38
         2.0       0.90      0.53      0.67       478
         3.0       0.98      0.83      0.90       196
         4.0       0.94      0.29      0.45       198

    accuracy                           0.54       990
   macro avg       0.66      0.58      0.50       990
weighted avg       0.85      0.54      0.62       990
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.01  26.25   96.70  41.18     32.06
1  60.40  97.37   58.93   8.64     15.88
2  74.65  53.35   94.53  90.11     67.02
3  96.16  82.65   99.50  97.59     89.50
4  85.45  29.29   99.49  93.55     44.62
Total accuracy: 53.84%
Average sen: 57.78%
Average spec: 89.83%
Macro f1-score: 49.82%

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2004504870909911
Starting epoch 2/10.
Epoch finished! Loss: 0.9457959860563279
Starting epoch 3/10.
Epoch finished! Loss: 0.833845219359948
Starting epoch 4/10.
Epoch finished! Loss: 0.7846894923311013
Starting epoch 5/10.
Epoch finished! Loss: 0.7433295528476055
Starting epoch 6/10.
Epoch finished! Loss: 0.7354287860485224
Starting epoch 7/10.
Epoch finished! Loss: 0.7280373121683414
Starting epoch 8/10.
Epoch finished! Loss: 0.704930801804249
Starting epoch 9/10.
Epoch finished! Loss: 0.6895848769408006
Starting epoch 10/10.
Epoch finished! Loss: 0.6871617196844174
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.640625
              precision    recall  f1-score   support

         0.0       0.47      0.57      0.52       135
         1.0       0.38      0.70      0.49       141
         2.0       0.78      0.74      0.76       354
         3.0       0.92      0.72      0.81       197
         4.0       0.73      0.29      0.41       133

    accuracy                           0.64       960
   macro avg       0.66      0.60      0.60       960
weighted avg       0.70      0.64      0.65       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.00  57.04   89.58  47.24     51.68
1  78.75  69.50   80.34  37.84     49.00
2  82.81  73.73   88.12  78.38     75.98
3  92.92  71.57   98.43  92.16     80.57
4  88.65  28.57   98.31  73.08     41.08
Total accuracy: 64.06%
Average sen: 60.08%
Average spec: 90.95%
Macro f1-score: 59.66%

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3053676439988566
Starting epoch 2/10.
Epoch finished! Loss: 1.0266387876856742
Starting epoch 3/10.
Epoch finished! Loss: 0.8989295163209834
Starting epoch 4/10.
Epoch finished! Loss: 0.8505991398137509
Starting epoch 5/10.
Epoch finished! Loss: 0.8046810826049348
Starting epoch 6/10.
Epoch finished! Loss: 0.7719195811904995
Starting epoch 7/10.
Epoch finished! Loss: 0.7467851596219199
Starting epoch 8/10.
Epoch finished! Loss: 0.7272861312254976
Starting epoch 9/10.
Epoch finished! Loss: 0.7125836785695727
Starting epoch 10/10.
Epoch finished! Loss: 0.7158274392823916
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7596899224806202
              precision    recall  f1-score   support

         0.0       0.49      0.70      0.58        69
         1.0       0.50      0.46      0.48       238
         2.0       0.79      0.97      0.87       565
         3.0       0.94      0.87      0.90       136
         4.0       0.99      0.56      0.71       282

    accuracy                           0.76      1290
   macro avg       0.74      0.71      0.71      1290
weighted avg       0.78      0.76      0.75      1290
 


====== chp005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.57  69.57   95.99  49.48     57.83
1  81.47  46.22   89.45  49.77     47.93
2  87.60  96.81   80.41  79.39     87.24
3  98.06  86.76   99.39  94.40     90.42
4  90.23  55.67   99.90  99.37     71.36
Total accuracy: 75.97%
Average sen: 71.01%
Average spec: 93.03%
Macro f1-score: 70.96%

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2519638657569885
Starting epoch 2/10.
Epoch finished! Loss: 0.9613157726251162
Starting epoch 3/10.
Epoch finished! Loss: 0.8457545005358182
Starting epoch 4/10.
Epoch finished! Loss: 0.7897704360576776
Starting epoch 5/10.
Epoch finished! Loss: 0.7673360464664606
Starting epoch 6/10.
Epoch finished! Loss: 0.7458514460004293
Starting epoch 7/10.
Epoch finished! Loss: 0.7429903992093526
Starting epoch 8/10.
Epoch finished! Loss: 0.7113804829808382
Starting epoch 9/10.
Epoch finished! Loss: 0.7066639601038053
Starting epoch 10/10.
Epoch finished! Loss: 0.6875624816005047
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.774074074074074
              precision    recall  f1-score   support

         0.0       0.85      0.52      0.64       120
         1.0       0.71      0.70      0.71       322
         2.0       0.69      0.89      0.77       274
         3.0       0.99      0.86      0.92       224
         4.0       0.80      0.79      0.80       140

    accuracy                           0.77      1080
   macro avg       0.81      0.75      0.77      1080
weighted avg       0.79      0.77      0.77      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.61  51.67   98.85  84.93     64.25
1  82.69  70.50   87.86  71.16     70.83
2  86.85  89.05   86.10  68.54     77.46
3  96.85  85.71   99.77  98.97     91.87
4  94.81  79.29   97.13  80.43     79.86
Total accuracy: 77.41%
Average sen: 75.24%
Average spec: 93.94%
Macro f1-score: 76.85%

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4652676531706998
Starting epoch 2/10.
Epoch finished! Loss: 1.1013393445825024
Starting epoch 3/10.
Epoch finished! Loss: 0.8843073732144123
Starting epoch 4/10.
Epoch finished! Loss: 0.803737719546874
Starting epoch 5/10.
Epoch finished! Loss: 0.7829540749314209
Starting epoch 6/10.
Epoch finished! Loss: 0.7466819746613963
Starting epoch 7/10.
Epoch finished! Loss: 0.7279990971318543
Starting epoch 8/10.
Epoch finished! Loss: 0.7086956498705742
Starting epoch 9/10.
Epoch finished! Loss: 0.6994189670647434
Starting epoch 10/10.
Epoch finished! Loss: 0.6862666351454598
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6780701754385965
              precision    recall  f1-score   support

         0.0       0.78      0.69      0.73       166
         1.0       0.16      0.64      0.25        58
         2.0       0.73      0.79      0.76       397
         3.0       0.89      0.91      0.90       165
         4.0       0.98      0.45      0.62       354

    accuracy                           0.68      1140
   macro avg       0.71      0.69      0.65      1140
weighted avg       0.81      0.68      0.71      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.63  68.67   96.71  78.08     73.08
1  80.70  63.79   81.61  15.68     25.17
2  82.63  78.59   84.79  73.41     75.91
3  97.02  90.91   98.05  88.76     89.82
4  82.63  45.20   99.49  97.56     61.78
Total accuracy: 67.81%
Average sen: 69.43%
Average spec: 92.13%
Macro f1-score: 65.15%

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2214978362505253
Starting epoch 2/10.
Epoch finished! Loss: 0.9520806000782893
Starting epoch 3/10.
Epoch finished! Loss: 0.8588743317585725
Starting epoch 4/10.
Epoch finished! Loss: 0.8073949083685875
Starting epoch 5/10.
Epoch finished! Loss: 0.7707001949732121
Starting epoch 6/10.
Epoch finished! Loss: 0.763030578998419
Starting epoch 7/10.
Epoch finished! Loss: 0.7290492575902205
Starting epoch 8/10.
Epoch finished! Loss: 0.7159932917127243
Starting epoch 9/10.
Epoch finished! Loss: 0.7074337111069606
Starting epoch 10/10.
Epoch finished! Loss: 0.6823418909540543
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7096774193548387
              precision    recall  f1-score   support

         0.0       0.64      0.87      0.74       119
         1.0       0.22      0.22      0.22        37
         2.0       0.82      0.49      0.62       387
         3.0       0.77      0.90      0.83       263
         4.0       0.63      0.98      0.77       124

    accuracy                           0.71       930
   macro avg       0.62      0.69      0.63       930
weighted avg       0.73      0.71      0.70       930
 


====== chp008-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.04  86.55   92.85  63.98     73.57
1  93.87  21.62   96.86  22.22     21.92
2  74.30  49.35   92.08  81.62     61.51
3  89.57  90.11   89.36  76.95     83.01
4  92.15  97.58   91.32  63.35     76.83
Total accuracy: 70.97%
Average sen: 69.04%
Average spec: 92.49%
Macro f1-score: 63.37%

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.267360696196556
Starting epoch 2/10.
Epoch finished! Loss: 0.9698429779364512
Starting epoch 3/10.
Epoch finished! Loss: 0.8623008353205828
Starting epoch 4/10.
Epoch finished! Loss: 0.8076803640677379
Starting epoch 5/10.
Epoch finished! Loss: 0.7707089529587672
Starting epoch 6/10.
Epoch finished! Loss: 0.7513245506928518
Starting epoch 7/10.
Epoch finished! Loss: 0.7206138207362248
Starting epoch 8/10.
Epoch finished! Loss: 0.7312883401146302
Starting epoch 9/10.
Epoch finished! Loss: 0.7128700800813161
Starting epoch 10/10.
Epoch finished! Loss: 0.6867478410785015
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7568627450980392
              precision    recall  f1-score   support

         0.0       0.93      0.39      0.54        96
         1.0       0.38      0.27      0.31       123
         2.0       0.76      0.85      0.80       355
         3.0       1.00      0.86      0.93       209
         4.0       0.70      0.93      0.80       237

    accuracy                           0.76      1020
   macro avg       0.75      0.66      0.68      1020
weighted avg       0.76      0.76      0.74      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.92  38.54   99.68   92.50     54.41
1  85.78  26.83   93.87   37.50     31.28
2  85.49  85.07   85.71   76.07     80.32
3  97.16  86.12  100.00  100.00     92.54
4  89.02  92.83   87.87   69.84     79.71
Total accuracy: 75.69%
Average sen: 65.88%
Average spec: 93.43%
Macro f1-score: 67.65%

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.372191683604167
Starting epoch 2/10.
Epoch finished! Loss: 1.0337868094444276
Starting epoch 3/10.
Epoch finished! Loss: 0.8889982759952545
Starting epoch 4/10.
Epoch finished! Loss: 0.8155945430581386
Starting epoch 5/10.
Epoch finished! Loss: 0.7828647889769994
Starting epoch 6/10.
Epoch finished! Loss: 0.7570958757629761
Starting epoch 7/10.
Epoch finished! Loss: 0.7437072009994433
Starting epoch 8/10.
Epoch finished! Loss: 0.7154518151512512
Starting epoch 9/10.
Epoch finished! Loss: 0.7231045940747628
Starting epoch 10/10.
Epoch finished! Loss: 0.6942757005874928
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7239583333333334
              precision    recall  f1-score   support

         0.0       0.80      0.75      0.77        57
         1.0       0.21      0.87      0.34        60
         2.0       0.95      0.78      0.86       496
         3.0       0.77      0.89      0.82        90
         4.0       0.90      0.51      0.65       257

    accuracy                           0.72       960
   macro avg       0.73      0.76      0.69       960
weighted avg       0.87      0.72      0.76       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.40  75.44   98.78  79.63     77.48
1  78.75  86.67   78.22  20.97     33.77
2  86.77  78.43   95.69  95.11     85.97
3  96.46  88.89   97.24  76.92     82.47
4  85.42  50.97   98.01  90.34     65.17
Total accuracy: 72.40%
Average sen: 76.08%
Average spec: 93.59%
Macro f1-score: 68.97%

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2510507693657509
Starting epoch 2/10.
Epoch finished! Loss: 0.9735672792563071
Starting epoch 3/10.
Epoch finished! Loss: 0.8559752983542589
Starting epoch 4/10.
Epoch finished! Loss: 0.7908280959496131
Starting epoch 5/10.
Epoch finished! Loss: 0.7633678486713996
Starting epoch 6/10.
Epoch finished! Loss: 0.7501622029221975
Starting epoch 7/10.
Epoch finished! Loss: 0.7151892043077028
Starting epoch 8/10.
Epoch finished! Loss: 0.7256377136478057
Starting epoch 9/10.
Epoch finished! Loss: 0.6963266278688724
Starting epoch 10/10.
Epoch finished! Loss: 0.700554307951377
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.592929292929293
              precision    recall  f1-score   support

         0.0       0.84      0.17      0.28       219
         1.0       0.30      0.64      0.41       143
         2.0       0.62      0.68      0.65       221
         3.0       0.97      0.92      0.94       271
         4.0       0.42      0.43      0.43       136

    accuracy                           0.59       990
   macro avg       0.63      0.57      0.54       990
weighted avg       0.69      0.59      0.58       990
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.91  16.89   99.09  84.09     28.14
1  72.93  64.34   74.38  29.77     40.71
2  83.74  68.33   88.17  62.40     65.23
3  96.97  91.51   99.03  97.25     94.30
4  84.04  43.38   90.52  42.14     42.75
Total accuracy: 59.29%
Average sen: 56.89%
Average spec: 90.24%
Macro f1-score: 54.22%

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2667044912393277
Starting epoch 2/10.
Epoch finished! Loss: 0.9823608256303347
Starting epoch 3/10.
Epoch finished! Loss: 0.8781822566802685
Starting epoch 4/10.
Epoch finished! Loss: 0.8153787209437444
Starting epoch 5/10.
Epoch finished! Loss: 0.7716435796939409
Starting epoch 6/10.
Epoch finished! Loss: 0.7512889025303033
Starting epoch 7/10.
Epoch finished! Loss: 0.7393115952610969
Starting epoch 8/10.
Epoch finished! Loss: 0.7191292871649448
Starting epoch 9/10.
Epoch finished! Loss: 0.7039288753500351
Starting epoch 10/10.
Epoch finished! Loss: 0.7162534354971005
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7252252252252253
              precision    recall  f1-score   support

         0.0       0.35      0.57      0.43        23
         1.0       0.47      0.73      0.57       182
         2.0       0.77      0.83      0.80       379
         3.0       1.00      0.58      0.73       203
         4.0       0.86      0.71      0.78       323

    accuracy                           0.73      1110
   macro avg       0.69      0.68      0.66      1110
weighted avg       0.78      0.73      0.73      1110
 


====== chp012-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.94  56.52   97.79   35.14     43.33
1  82.25  73.08   84.05   47.33     57.45
2  85.50  82.85   86.87   76.59     79.59
3  92.25  57.64  100.00  100.00     73.12
4  88.11  70.59   95.30   86.04     77.55
Total accuracy: 72.52%
Average sen: 68.13%
Average spec: 92.80%
Macro f1-score: 66.21%

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3486999238912876
Starting epoch 2/10.
Epoch finished! Loss: 1.0050059829766933
Starting epoch 3/10.
Epoch finished! Loss: 0.8842300836856548
Starting epoch 4/10.
Epoch finished! Loss: 0.8298330446848503
Starting epoch 5/10.
Epoch finished! Loss: 0.797592809681709
Starting epoch 6/10.
Epoch finished! Loss: 0.758471614237015
Starting epoch 7/10.
Epoch finished! Loss: 0.7432149625741519
Starting epoch 8/10.
Epoch finished! Loss: 0.7366237149788784
Starting epoch 9/10.
Epoch finished! Loss: 0.7115285529540135
Starting epoch 10/10.
Epoch finished! Loss: 0.718391317816881
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7494949494949495
              precision    recall  f1-score   support

         0.0       0.44      0.94      0.60        33
         1.0       0.65      0.17      0.27       142
         2.0       0.79      0.88      0.83       433
         3.0       0.80      0.85      0.83       189
         4.0       0.74      0.75      0.74       193

    accuracy                           0.75       990
   macro avg       0.68      0.72      0.65       990
weighted avg       0.75      0.75      0.72       990
 


====== chp013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.86  93.94   95.92  44.29     60.19
1  86.77  16.90   98.47  64.86     26.82
2  84.24  87.99   81.33  78.56     83.01
3  93.13  85.19   95.01  80.10     82.56
4  89.90  75.13   93.48  73.60     74.36
Total accuracy: 74.95%
Average sen: 71.83%
Average spec: 92.84%
Macro f1-score: 65.39%

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4410662320943979
Starting epoch 2/10.
Epoch finished! Loss: 1.0939578769298701
Starting epoch 3/10.
Epoch finished! Loss: 0.8809240845533518
Starting epoch 4/10.
Epoch finished! Loss: 0.8104600034081019
Starting epoch 5/10.
Epoch finished! Loss: 0.7708684236957477
Starting epoch 6/10.
Epoch finished! Loss: 0.7564413972772085
Starting epoch 7/10.
Epoch finished! Loss: 0.7108661856788855
Starting epoch 8/10.
Epoch finished! Loss: 0.7203790642894231
Starting epoch 9/10.
Epoch finished! Loss: 0.6927371589037088
Starting epoch 10/10.
Epoch finished! Loss: 0.6959165886044503
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7151515151515152
              precision    recall  f1-score   support

         0.0       0.90      0.80      0.85       203
         1.0       0.25      0.49      0.33        68
         2.0       0.71      0.88      0.79       397
         3.0       0.93      0.09      0.16       146
         4.0       0.89      0.84      0.86       176

    accuracy                           0.72       990
   macro avg       0.73      0.62      0.60       990
weighted avg       0.78      0.72      0.69       990
 


====== chp014-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.14  80.30   97.71  90.06     84.90
1  86.57  48.53   89.37  25.19     33.17
2  80.61  88.41   75.38  70.62     78.52
3  86.46   8.90   99.88  92.86     16.25
4  95.25  84.09   97.67  88.62     86.30
Total accuracy: 71.52%
Average sen: 62.05%
Average spec: 92.00%
Macro f1-score: 59.83%

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2691572177364099
Starting epoch 2/10.
Epoch finished! Loss: 0.9850850632291963
Starting epoch 3/10.
Epoch finished! Loss: 0.8491818506745298
Starting epoch 4/10.
Epoch finished! Loss: 0.811824611945502
Starting epoch 5/10.
Epoch finished! Loss: 0.7652793202160868
Starting epoch 6/10.
Epoch finished! Loss: 0.7435068002538792
Starting epoch 7/10.
Epoch finished! Loss: 0.7375148715429785
Starting epoch 8/10.
Epoch finished! Loss: 0.7193334459337949
Starting epoch 9/10.
Epoch finished! Loss: 0.699251138795757
Starting epoch 10/10.
Epoch finished! Loss: 0.6991684727917307
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6885964912280702
              precision    recall  f1-score   support

         0.0       0.33      0.78      0.47        67
         1.0       0.53      0.53      0.53       281
         2.0       0.74      0.89      0.81       335
         3.0       0.99      0.81      0.89       264
         4.0       0.82      0.37      0.51       193

    accuracy                           0.69      1140
   macro avg       0.68      0.68      0.64      1140
weighted avg       0.74      0.69      0.69      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.56  77.61   90.31  33.33     46.64
1  77.02  53.02   84.87  53.41     53.21
2  87.63  88.66   87.20  74.25     80.82
3  95.53  81.44   99.77  99.08     89.40
4  87.98  37.31   98.31  81.82     51.25
Total accuracy: 68.86%
Average sen: 67.61%
Average spec: 92.09%
Macro f1-score: 64.26%

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3164611279274046
Starting epoch 2/10.
Epoch finished! Loss: 0.9537097183433739
Starting epoch 3/10.
Epoch finished! Loss: 0.8460984605159538
Starting epoch 4/10.
Epoch finished! Loss: 0.8011888672946503
Starting epoch 5/10.
Epoch finished! Loss: 0.7538467290088476
Starting epoch 6/10.
Epoch finished! Loss: 0.7319970964004634
Starting epoch 7/10.
Epoch finished! Loss: 0.7294977231375499
Starting epoch 8/10.
Epoch finished! Loss: 0.7188415823065636
Starting epoch 9/10.
Epoch finished! Loss: 0.7064610220290519
Starting epoch 10/10.
Epoch finished! Loss: 0.6901517274527016
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8365079365079365
              precision    recall  f1-score   support

         0.0       0.97      0.93      0.95       297
         1.0       0.69      0.70      0.69       289
         2.0       0.79      0.93      0.85       330
         3.0       0.99      0.83      0.90       133
         4.0       0.86      0.76      0.81       211

    accuracy                           0.84      1260
   macro avg       0.86      0.83      0.84      1260
weighted avg       0.84      0.84      0.84      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.70  92.93   99.17  97.18     95.01
1  85.95  69.55   90.83  69.31     69.43
2  91.59  93.03   91.08  78.72     85.28
3  98.10  82.71   99.91  99.10     90.16
4  93.97  75.83   97.62  86.49     80.81
Total accuracy: 83.65%
Average sen: 82.81%
Average spec: 95.72%
Macro f1-score: 84.14%

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.213625245140149
Starting epoch 2/10.
Epoch finished! Loss: 0.958843660583863
Starting epoch 3/10.
Epoch finished! Loss: 0.8471105757814187
Starting epoch 4/10.
Epoch finished! Loss: 0.775049418096359
Starting epoch 5/10.
Epoch finished! Loss: 0.7536467544161356
Starting epoch 6/10.
Epoch finished! Loss: 0.7417318733838888
Starting epoch 7/10.
Epoch finished! Loss: 0.7125563229505832
Starting epoch 8/10.
Epoch finished! Loss: 0.7028261199593544
Starting epoch 9/10.
Epoch finished! Loss: 0.6933634038154896
Starting epoch 10/10.
Epoch finished! Loss: 0.6925159333990171
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.48787878787878786
              precision    recall  f1-score   support

         0.0       0.73      0.59      0.65       237
         1.0       0.68      0.40      0.51       249
         2.0       0.41      0.45      0.43       210
         3.0       0.97      0.41      0.58       245
         4.0       0.15      0.98      0.26        49

    accuracy                           0.49       990
   macro avg       0.59      0.57      0.49       990
weighted avg       0.68      0.49      0.53       990
 


====== chp017-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.85  58.65   93.09  72.77     64.95
1  80.30  40.16   93.79  68.49     50.63
2  74.55  45.24   82.44  40.95     42.99
3  85.15  41.22   99.60  97.12     57.88
4  72.73  97.96   71.41  15.14     26.23
Total accuracy: 48.79%
Average sen: 56.65%
Average spec: 88.07%
Macro f1-score: 48.54%

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2425034809571045
Starting epoch 2/10.
Epoch finished! Loss: 0.9541975431717359
Starting epoch 3/10.
Epoch finished! Loss: 0.8557477850180406
Starting epoch 4/10.
Epoch finished! Loss: 0.8013398533830276
Starting epoch 5/10.
Epoch finished! Loss: 0.7708877971539131
Starting epoch 6/10.
Epoch finished! Loss: 0.7446528356808882
Starting epoch 7/10.
Epoch finished! Loss: 0.7264102978202013
Starting epoch 8/10.
Epoch finished! Loss: 0.7112162235837717
Starting epoch 9/10.
Epoch finished! Loss: 0.7055983082606242
Starting epoch 10/10.
Epoch finished! Loss: 0.6930840559876882
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6423423423423423
              precision    recall  f1-score   support

         0.0       0.87      0.80      0.83       138
         1.0       0.33      0.21      0.26       123
         2.0       0.25      0.87      0.39       120
         3.0       0.99      0.72      0.84       363
         4.0       0.93      0.57      0.71       366

    accuracy                           0.64      1110
   macro avg       0.68      0.64      0.61      1110
weighted avg       0.80      0.64      0.68      1110
 


====== chp018-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.04  80.43   98.25  86.72     83.46
1  86.58  21.14   94.73  33.33     25.87
2  70.54  86.67   68.59  25.06     38.88
3  90.81  72.45   99.73  99.25     83.76
4  84.50  57.10   97.98  93.30     70.85
Total accuracy: 64.23%
Average sen: 63.56%
Average spec: 91.86%
Macro f1-score: 60.56%

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2153947749963174
Starting epoch 2/10.
Epoch finished! Loss: 0.9945361240552022
Starting epoch 3/10.
Epoch finished! Loss: 0.857653063077193
Starting epoch 4/10.
Epoch finished! Loss: 0.8031900804776412
Starting epoch 5/10.
Epoch finished! Loss: 0.7545946892637473
Starting epoch 6/10.
Epoch finished! Loss: 0.739302315391027
Starting epoch 7/10.
Epoch finished! Loss: 0.719536144229082
Starting epoch 8/10.
Epoch finished! Loss: 0.702117841060345
Starting epoch 9/10.
Epoch finished! Loss: 0.7064299935331712
Starting epoch 10/10.
Epoch finished! Loss: 0.6822386448199932
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7225806451612903
              precision    recall  f1-score   support

         0.0       0.49      0.56      0.52        36
         1.0       0.52      0.12      0.20       112
         2.0       0.64      0.71      0.68       224
         3.0       0.92      0.89      0.91       226
         4.0       0.70      0.83      0.76       332

    accuracy                           0.72       930
   macro avg       0.65      0.62      0.61       930
weighted avg       0.71      0.72      0.70       930
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.02  55.56   97.65  48.78     51.95
1  88.06  12.50   98.41  51.85     20.14
2  83.44  71.43   87.25  64.00     67.51
3  95.59  89.38   97.59  92.24     90.79
4  81.40  83.13   80.43  70.23     76.14
Total accuracy: 72.26%
Average sen: 62.40%
Average spec: 92.27%
Macro f1-score: 61.31%

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2270204608965105
Starting epoch 2/10.
Epoch finished! Loss: 0.9682704010064997
Starting epoch 3/10.
Epoch finished! Loss: 0.8476448424994716
Starting epoch 4/10.
Epoch finished! Loss: 0.7993609577302306
Starting epoch 5/10.
Epoch finished! Loss: 0.7693426927774569
Starting epoch 6/10.
Epoch finished! Loss: 0.7415679161613052
Starting epoch 7/10.
Epoch finished! Loss: 0.7320255151586643
Starting epoch 8/10.
Epoch finished! Loss: 0.7210835121773385
Starting epoch 9/10.
Epoch finished! Loss: 0.703595174440546
Starting epoch 10/10.
Epoch finished! Loss: 0.6940227146314378
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6078947368421053
              precision    recall  f1-score   support

         0.0       0.94      0.49      0.65       297
         1.0       0.46      0.53      0.49       200
         2.0       0.63      0.93      0.75       354
         3.0       1.00      0.03      0.06       159
         4.0       0.48      0.82      0.60       130

    accuracy                           0.61      1140
   macro avg       0.70      0.56      0.51      1140
weighted avg       0.71      0.61      0.56      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  86.05  49.49   98.93   94.23     64.90
1  80.79  52.50   86.81   45.85     48.95
2  80.53  92.94   74.94   62.55     74.77
3  86.49   3.14  100.00  100.00      6.10
4  87.72  82.31   88.42   47.77     60.45
Total accuracy: 60.79%
Average sen: 56.08%
Average spec: 89.82%
Macro f1-score: 51.03%

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.258559647674266
Starting epoch 2/10.
Epoch finished! Loss: 0.997171552945288
Starting epoch 3/10.
Epoch finished! Loss: 0.8410393232084149
Starting epoch 4/10.
Epoch finished! Loss: 0.7812473174457845
Starting epoch 5/10.
Epoch finished! Loss: 0.7509801423457598
Starting epoch 6/10.
Epoch finished! Loss: 0.7254090131940069
Starting epoch 7/10.
Epoch finished! Loss: 0.7195594774480032
Starting epoch 8/10.
Epoch finished! Loss: 0.705906787204006
Starting epoch 9/10.
Epoch finished! Loss: 0.6944352044331982
Starting epoch 10/10.
Epoch finished! Loss: 0.6971726722468741
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6801587301587302
              precision    recall  f1-score   support

         0.0       0.62      0.92      0.74       253
         1.0       0.56      0.56      0.56       293
         2.0       0.84      0.73      0.78       468
         3.0       0.60      0.79      0.69       107
         4.0       0.79      0.24      0.36       139

    accuracy                           0.68      1260
   macro avg       0.68      0.65      0.63      1260
weighted avg       0.70      0.68      0.67      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.06  91.70   85.90  62.03     74.00
1  79.52  56.31   86.56  55.93     56.12
2  84.76  73.08   91.67  83.82     78.08
3  93.81  79.44   95.14  60.28     68.55
4  90.87  23.74   99.20  78.57     36.46
Total accuracy: 68.02%
Average sen: 64.85%
Average spec: 91.69%
Macro f1-score: 62.64%

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.284404100363071
Starting epoch 2/10.
Epoch finished! Loss: 0.9630736506902254
Starting epoch 3/10.
Epoch finished! Loss: 0.8475338903757242
Starting epoch 4/10.
Epoch finished! Loss: 0.8111948546308737
Starting epoch 5/10.
Epoch finished! Loss: 0.7820109276817395
Starting epoch 6/10.
Epoch finished! Loss: 0.7340298917431097
Starting epoch 7/10.
Epoch finished! Loss: 0.7221616961635076
Starting epoch 8/10.
Epoch finished! Loss: 0.7169671433476301
Starting epoch 9/10.
Epoch finished! Loss: 0.7170809963574776
Starting epoch 10/10.
Epoch finished! Loss: 0.6998902363272813
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6063063063063063
              precision    recall  f1-score   support

         0.0       0.77      0.69      0.73       232
         1.0       0.34      0.59      0.43       179
         2.0       0.56      0.53      0.54       246
         3.0       1.00      0.65      0.78       339
         4.0       0.43      0.49      0.46       114

    accuracy                           0.61      1110
   macro avg       0.62      0.59      0.59      1110
weighted avg       0.69      0.61      0.63      1110
 


====== chp024-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.19  69.40   94.42  76.67     72.85
1  74.68  59.22   77.66  33.76     43.00
2  80.18  53.25   87.85  55.51     54.36
3  89.10  64.60   99.87  99.55     78.35
4  88.11  49.12   92.57  43.08     45.90
Total accuracy: 60.63%
Average sen: 59.12%
Average spec: 90.47%
Macro f1-score: 58.89%

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3465668852547652
Starting epoch 2/10.
Epoch finished! Loss: 0.9904951837681631
Starting epoch 3/10.
Epoch finished! Loss: 0.8700911129703959
Starting epoch 4/10.
Epoch finished! Loss: 0.8251012033633603
Starting epoch 5/10.
Epoch finished! Loss: 0.788180673622903
Starting epoch 6/10.
Epoch finished! Loss: 0.7596791054456289
Starting epoch 7/10.
Epoch finished! Loss: 0.7407490427939947
Starting epoch 8/10.
Epoch finished! Loss: 0.7364463413717183
Starting epoch 9/10.
Epoch finished! Loss: 0.7121505414256613
Starting epoch 10/10.
Epoch finished! Loss: 0.69835179907675
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6619047619047619
              precision    recall  f1-score   support

         0.0       1.00      0.60      0.75       304
         1.0       0.75      0.24      0.36        25
         2.0       0.59      1.00      0.74        29
         3.0       1.00      0.97      0.98        62
         4.0       0.00      0.00      0.00         0

    accuracy                           0.66       420
   macro avg       0.67      0.56      0.57       420
weighted avg       0.96      0.66      0.76       420
 


====== chp025-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  71.19   60.20  100.00  100.00     75.15
1  95.00   24.00   99.49   75.00     36.36
2  95.24  100.00   94.88   59.18     74.36
3  99.52   96.77  100.00  100.00     98.36
4  71.43     NaN   71.43    0.00       NaN
Total accuracy: 66.19%
Average sen: 70.24%
Average spec: 93.16%
Macro f1-score: 71.06%

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2444473706758938
Starting epoch 2/10.
Epoch finished! Loss: 0.9532911002635955
Starting epoch 3/10.
Epoch finished! Loss: 0.8485094393675144
Starting epoch 4/10.
Epoch finished! Loss: 0.795543050307494
Starting epoch 5/10.
Epoch finished! Loss: 0.7725016140020811
Starting epoch 6/10.
Epoch finished! Loss: 0.7466563310760718
Starting epoch 7/10.
Epoch finished! Loss: 0.7309068360007727
Starting epoch 8/10.
Epoch finished! Loss: 0.7031504674599721
Starting epoch 9/10.
Epoch finished! Loss: 0.6902582917075891
Starting epoch 10/10.
Epoch finished! Loss: 0.6824885156292182
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7913978494623656
              precision    recall  f1-score   support

         0.0       0.78      0.74      0.76        58
         1.0       0.20      0.29      0.24        55
         2.0       0.80      0.89      0.84       412
         3.0       0.90      0.90      0.90       182
         4.0       0.96      0.67      0.79       223

    accuracy                           0.79       930
   macro avg       0.73      0.70      0.70       930
weighted avg       0.82      0.79      0.80       930
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.10  74.14   98.62  78.18     76.11
1  88.92  29.09   92.69  20.00     23.70
2  84.84  88.59   81.85  79.52     83.81
3  96.02  89.56   97.59  90.06     89.81
4  91.40  66.82   99.15  96.13     78.84
Total accuracy: 79.14%
Average sen: 69.64%
Average spec: 93.98%
Macro f1-score: 70.45%

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.321158586557095
Starting epoch 2/10.
Epoch finished! Loss: 0.977940148802904
Starting epoch 3/10.
Epoch finished! Loss: 0.8683388375318968
Starting epoch 4/10.
Epoch finished! Loss: 0.817818574492748
Starting epoch 5/10.
Epoch finished! Loss: 0.782454056923206
Starting epoch 6/10.
Epoch finished! Loss: 0.7631216383897341
Starting epoch 7/10.
Epoch finished! Loss: 0.7285726768466142
Starting epoch 8/10.
Epoch finished! Loss: 0.7201397815575966
Starting epoch 9/10.
Epoch finished! Loss: 0.7087712041460551
Starting epoch 10/10.
Epoch finished! Loss: 0.707543602012671
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7360157016683022
              precision    recall  f1-score   support

         0.0       0.92      0.89      0.90       101
         1.0       0.21      0.65      0.32        55
         2.0       0.79      0.68      0.73       382
         3.0       0.79      0.68      0.73       191
         4.0       0.93      0.81      0.86       290

    accuracy                           0.74      1019
   macro avg       0.73      0.74      0.71      1019
weighted avg       0.81      0.74      0.76      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.14  89.11   99.13  91.84     90.45
1  84.69  65.45   85.79  20.81     31.58
2  81.06  68.06   88.85  78.55     72.93
3  90.58  68.06   95.77  78.79     73.03
4  92.74  80.69   97.53  92.86     86.35
Total accuracy: 73.60%
Average sen: 74.28%
Average spec: 93.41%
Macro f1-score: 70.87%

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.305139787380512
Starting epoch 2/10.
Epoch finished! Loss: 1.0674375015955704
Starting epoch 3/10.
Epoch finished! Loss: 0.98233806513823
Starting epoch 4/10.
Epoch finished! Loss: 0.9021324212734516
Starting epoch 5/10.
Epoch finished! Loss: 0.8558897793292999
Starting epoch 6/10.
Epoch finished! Loss: 0.819979165150569
Starting epoch 7/10.
Epoch finished! Loss: 0.7983198027198132
Starting epoch 8/10.
Epoch finished! Loss: 0.7805157061952811
Starting epoch 9/10.
Epoch finished! Loss: 0.7580961225124506
Starting epoch 10/10.
Epoch finished! Loss: 0.7522276756855157
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6431372549019608
              precision    recall  f1-score   support

         0.0       0.69      0.65      0.67        66
         1.0       0.12      0.39      0.19        44
         2.0       0.67      0.59      0.62       406
         3.0       1.00      0.60      0.75       334
         4.0       0.60      0.92      0.73       170

    accuracy                           0.64      1020
   macro avg       0.62      0.63      0.59      1020
weighted avg       0.74      0.64      0.67      1020
 


====== chp029-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.88  65.15   98.01  69.35     67.19
1  85.69  38.64   87.81  12.50     18.89
2  71.86  58.87   80.46  66.57     62.48
3  86.76  59.88   99.85  99.50     74.77
4  88.43  92.35   87.65  59.92     72.69
Total accuracy: 64.31%
Average sen: 62.98%
Average spec: 90.75%
Macro f1-score: 59.20%

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2986394360258773
Starting epoch 2/10.
Epoch finished! Loss: 1.0284925248171832
Starting epoch 3/10.
Epoch finished! Loss: 0.8882751729497578
Starting epoch 4/10.
Epoch finished! Loss: 0.8053649835374824
Starting epoch 5/10.
Epoch finished! Loss: 0.7767502537795475
Starting epoch 6/10.
Epoch finished! Loss: 0.7484403220382897
Starting epoch 7/10.
Epoch finished! Loss: 0.7201573135309698
Starting epoch 8/10.
Epoch finished! Loss: 0.7158117328831588
Starting epoch 9/10.
Epoch finished! Loss: 0.7072420949871475
Starting epoch 10/10.
Epoch finished! Loss: 0.6969787529076389
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6205170975813178
              precision    recall  f1-score   support

         0.0       0.90      0.70      0.79       350
         1.0       0.47      0.57      0.52       204
         2.0       0.60      0.68      0.64       346
         3.0       1.00      0.27      0.42       179
         4.0       0.41      0.82      0.55       120

    accuracy                           0.62      1199
   macro avg       0.68      0.61      0.58      1199
weighted avg       0.71      0.62      0.62      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.99  69.71   96.94   90.37     78.71
1  81.65  57.35   86.63   46.80     51.54
2  77.81  68.21   81.71   60.20     63.96
3  89.07  26.82  100.00  100.00     42.29
4  86.57  82.50   87.03   41.42     55.15
Total accuracy: 62.05%
Average sen: 60.92%
Average spec: 90.46%
Macro f1-score: 58.33%

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2431904366383186
Starting epoch 2/10.
Epoch finished! Loss: 0.9749727207880754
Starting epoch 3/10.
Epoch finished! Loss: 0.8770858812790651
Starting epoch 4/10.
Epoch finished! Loss: 0.8170211410293212
Starting epoch 5/10.
Epoch finished! Loss: 0.7591823347485982
Starting epoch 6/10.
Epoch finished! Loss: 0.7500386696595412
Starting epoch 7/10.
Epoch finished! Loss: 0.7320859847160486
Starting epoch 8/10.
Epoch finished! Loss: 0.7277312583648241
Starting epoch 9/10.
Epoch finished! Loss: 0.704839723270673
Starting epoch 10/10.
Epoch finished! Loss: 0.6998299231896034
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6243243243243243
              precision    recall  f1-score   support

         0.0       0.20      0.86      0.32        51
         1.0       0.10      0.27      0.15        48
         2.0       0.76      0.72      0.74       309
         3.0       0.81      0.91      0.86       229
         4.0       0.98      0.43      0.60       473

    accuracy                           0.62      1110
   macro avg       0.57      0.64      0.53      1110
weighted avg       0.81      0.62      0.66      1110
 


====== chp031-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.15  86.27   83.00  19.64     32.00
1  86.67  27.08   89.36  10.32     14.94
2  85.86  72.17   91.14  75.85     73.96
3  93.87  91.27   94.55  81.32     86.01
4  75.32  43.13   99.22  97.61     59.82
Total accuracy: 62.43%
Average sen: 63.98%
Average spec: 91.45%
Macro f1-score: 53.35%

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2729647079339395
Starting epoch 2/10.
Epoch finished! Loss: 1.0433852736766522
Starting epoch 3/10.
Epoch finished! Loss: 0.9543945658665437
Starting epoch 4/10.
Epoch finished! Loss: 0.905298942556748
Starting epoch 5/10.
Epoch finished! Loss: 0.859888303738374
Starting epoch 6/10.
Epoch finished! Loss: 0.8279284740869816
Starting epoch 7/10.
Epoch finished! Loss: 0.8035688575643759
Starting epoch 8/10.
Epoch finished! Loss: 0.7990297326674828
Starting epoch 9/10.
Epoch finished! Loss: 0.7688775550860625
Starting epoch 10/10.
Epoch finished! Loss: 0.7692132978485181
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.679047619047619
              precision    recall  f1-score   support

         0.0       0.41      0.91      0.56        47
         1.0       0.27      0.61      0.37       108
         2.0       0.92      0.71      0.80       516
         3.0       1.00      0.78      0.88       150
         4.0       0.67      0.52      0.58       229

    accuracy                           0.68      1050
   macro avg       0.65      0.71      0.64      1050
weighted avg       0.78      0.68      0.71      1050
 


====== chp032-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.62  91.49   93.72   40.57     56.21
1  78.76  61.11   80.79   26.72     37.18
2  82.67  71.32   93.63   91.54     80.17
3  96.86  78.00  100.00  100.00     87.64
4  83.90  51.97   92.81   66.85     58.48
Total accuracy: 67.90%
Average sen: 70.78%
Average spec: 92.19%
Macro f1-score: 63.94%

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3182459487364842
Starting epoch 2/10.
Epoch finished! Loss: 1.0436763988091395
Starting epoch 3/10.
Epoch finished! Loss: 0.9215793199264086
Starting epoch 4/10.
Epoch finished! Loss: 0.8465317980601237
Starting epoch 5/10.
Epoch finished! Loss: 0.7971093765818156
Starting epoch 6/10.
Epoch finished! Loss: 0.7727427192605458
Starting epoch 7/10.
Epoch finished! Loss: 0.7517919002817227
Starting epoch 8/10.
Epoch finished! Loss: 0.7512707837499105
Starting epoch 9/10.
Epoch finished! Loss: 0.7283303703253086
Starting epoch 10/10.
Epoch finished! Loss: 0.7149526683183817
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7121212121212122
              precision    recall  f1-score   support

         0.0       0.39      0.78      0.52        32
         1.0       0.62      0.50      0.55       251
         2.0       0.58      0.69      0.63       208
         3.0       0.99      0.80      0.89       254
         4.0       0.76      0.85      0.80       245

    accuracy                           0.71       990
   macro avg       0.67      0.72      0.68       990
weighted avg       0.73      0.71      0.72       990
 


====== chp033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.35  78.12   95.93  39.06     52.08
1  79.60  49.80   89.72  62.19     55.31
2  83.13  68.75   86.96  58.37     63.13
3  94.75  80.31   99.73  99.03     88.70
4  89.60  84.90   91.14  75.91     80.15
Total accuracy: 71.21%
Average sen: 72.38%
Average spec: 92.69%
Macro f1-score: 67.88%

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2314133579914386
Starting epoch 2/10.
Epoch finished! Loss: 0.9595602904374783
Starting epoch 3/10.
Epoch finished! Loss: 0.8662871551055175
Starting epoch 4/10.
Epoch finished! Loss: 0.8091580980099164
Starting epoch 5/10.
Epoch finished! Loss: 0.7665153835828488
Starting epoch 6/10.
Epoch finished! Loss: 0.7498921243044047
Starting epoch 7/10.
Epoch finished! Loss: 0.7298791559842916
Starting epoch 8/10.
Epoch finished! Loss: 0.7131872710127097
Starting epoch 9/10.
Epoch finished! Loss: 0.7164879144384311
Starting epoch 10/10.
Epoch finished! Loss: 0.6951680939931136
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7362745098039216
              precision    recall  f1-score   support

         0.0       0.26      0.94      0.41        17
         1.0       0.13      0.08      0.10        62
         2.0       0.67      0.86      0.76       372
         3.0       0.96      0.70      0.81       337
         4.0       0.88      0.74      0.80       232

    accuracy                           0.74      1020
   macro avg       0.58      0.67      0.58      1020
weighted avg       0.78      0.74      0.74      1020
 


====== chp034-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.39  94.12   95.41  25.81     40.51
1  91.08   8.06   96.45  12.82      9.90
2  79.71  86.29   75.93  67.30     75.62
3  89.31  70.33   98.68  96.34     81.30
4  91.76  74.14   96.95  87.76     80.37
Total accuracy: 73.63%
Average sen: 66.59%
Average spec: 92.69%
Macro f1-score: 57.54%

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2328746898754224
Starting epoch 2/10.
Epoch finished! Loss: 0.9515486647263457
Starting epoch 3/10.
Epoch finished! Loss: 0.843712454366868
Starting epoch 4/10.
Epoch finished! Loss: 0.7920651993926427
Starting epoch 5/10.
Epoch finished! Loss: 0.7682992896518192
Starting epoch 6/10.
Epoch finished! Loss: 0.7372083971169004
Starting epoch 7/10.
Epoch finished! Loss: 0.7440213565660719
Starting epoch 8/10.
Epoch finished! Loss: 0.7163704520947224
Starting epoch 9/10.
Epoch finished! Loss: 0.7100646500421767
Starting epoch 10/10.
Epoch finished! Loss: 0.7079810067493483
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7896825396825397
              precision    recall  f1-score   support

         0.0       0.76      0.95      0.84       237
         1.0       0.59      0.37      0.45       167
         2.0       0.90      0.77      0.83       563
         3.0       0.11      0.88      0.20         8
         4.0       0.85      0.95      0.90       285

    accuracy                           0.79      1260
   macro avg       0.64      0.78      0.64      1260
weighted avg       0.82      0.79      0.79      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.25  94.51   92.96  75.68     84.05
1  88.17  36.53   96.07  58.65     45.02
2  85.87  76.55   93.40  90.36     82.88
3  95.56  87.50   95.61  11.29     20.00
4  95.08  95.44   94.97  84.74     89.77
Total accuracy: 78.97%
Average sen: 78.11%
Average spec: 94.60%
Macro f1-score: 64.34%

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3152298342723112
Starting epoch 2/10.
Epoch finished! Loss: 0.9783537454330005
Starting epoch 3/10.
Epoch finished! Loss: 0.8436708786166631
Starting epoch 4/10.
Epoch finished! Loss: 0.8024448389044174
Starting epoch 5/10.
Epoch finished! Loss: 0.7515355738309714
Starting epoch 6/10.
Epoch finished! Loss: 0.7422118754341052
Starting epoch 7/10.
Epoch finished! Loss: 0.7263096016186934
Starting epoch 8/10.
Epoch finished! Loss: 0.703494769334793
Starting epoch 9/10.
Epoch finished! Loss: 0.7003227967482347
Starting epoch 10/10.
Epoch finished! Loss: 0.6884039936157373
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6758349705304518
              precision    recall  f1-score   support

         0.0       0.88      0.62      0.73       197
         1.0       0.39      0.56      0.46       161
         2.0       0.81      0.55      0.66       348
         3.0       1.00      0.88      0.93       208
         4.0       0.44      0.96      0.60       104

    accuracy                           0.68      1018
   macro avg       0.70      0.71      0.68      1018
weighted avg       0.76      0.68      0.69      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.16  62.44   98.05   88.49     73.21
1  79.37  55.90   83.78   39.30     46.15
2  80.26  55.46   93.13   80.75     65.76
3  97.45  87.50  100.00  100.00     93.33
4  86.94  96.15   85.89   43.67     60.06
Total accuracy: 67.58%
Average sen: 71.49%
Average spec: 92.17%
Macro f1-score: 67.70%

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2640665668707627
Starting epoch 2/10.
Epoch finished! Loss: 0.9503470239730981
Starting epoch 3/10.
Epoch finished! Loss: 0.838546561048581
Starting epoch 4/10.
Epoch finished! Loss: 0.7992300448509363
Starting epoch 5/10.
Epoch finished! Loss: 0.7640884157556754
Starting epoch 6/10.
Epoch finished! Loss: 0.7288333247487362
Starting epoch 7/10.
Epoch finished! Loss: 0.7132382928178861
Starting epoch 8/10.
Epoch finished! Loss: 0.7164165908327469
Starting epoch 9/10.
Epoch finished! Loss: 0.6926293569115493
Starting epoch 10/10.
Epoch finished! Loss: 0.6963986083865166
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6813725490196079
              precision    recall  f1-score   support

         0.0       0.31      0.94      0.47        62
         1.0       0.45      0.35      0.39       178
         2.0       0.82      0.88      0.85       437
         3.0       0.84      0.93      0.88       102
         4.0       0.86      0.39      0.54       241

    accuracy                           0.68      1020
   macro avg       0.65      0.70      0.63      1020
weighted avg       0.73      0.68      0.68      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.06  93.55   86.64  31.18     46.77
1  81.08  35.39   90.74  44.68     39.50
2  86.47  87.87   85.42  81.88     84.77
3  97.55  93.14   98.04  84.07     88.37
4  84.12  39.42   97.95  85.59     53.98
Total accuracy: 68.14%
Average sen: 69.87%
Average spec: 91.76%
Macro f1-score: 62.68%

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3254891409323766
Starting epoch 2/10.
Epoch finished! Loss: 1.0185344971143282
Starting epoch 3/10.
Epoch finished! Loss: 0.883031205030588
Starting epoch 4/10.
Epoch finished! Loss: 0.814368026302411
Starting epoch 5/10.
Epoch finished! Loss: 0.8008429905542961
Starting epoch 6/10.
Epoch finished! Loss: 0.7648352463658039
Starting epoch 7/10.
Epoch finished! Loss: 0.7372118134911244
Starting epoch 8/10.
Epoch finished! Loss: 0.7376149863004684
Starting epoch 9/10.
Epoch finished! Loss: 0.72571041480853
Starting epoch 10/10.
Epoch finished! Loss: 0.7064788350692162
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6432432432432432
              precision    recall  f1-score   support

         0.0       0.27      0.74      0.39        19
         1.0       0.53      0.92      0.67       355
         2.0       0.78      0.57      0.66       376
         3.0       1.00      0.70      0.83       199
         4.0       0.69      0.14      0.23       161

    accuracy                           0.64      1110
   macro avg       0.65      0.61      0.56      1110
weighted avg       0.72      0.64      0.62      1110
 


====== chp039-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.13  73.68   96.52   26.92     39.44
1  71.44  91.55   61.99   53.10     67.22
2  79.82  56.65   91.69   77.74     65.54
3  94.68  70.35  100.00  100.00     82.60
4  86.58  13.66   98.95   68.75     22.80
Total accuracy: 64.32%
Average sen: 61.18%
Average spec: 89.83%
Macro f1-score: 55.52%

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2981535109189841
Starting epoch 2/10.
Epoch finished! Loss: 0.9652775365572709
Starting epoch 3/10.
Epoch finished! Loss: 0.857455162016245
Starting epoch 4/10.
Epoch finished! Loss: 0.8074835009299792
Starting epoch 5/10.
Epoch finished! Loss: 0.7912433282687114
Starting epoch 6/10.
Epoch finished! Loss: 0.7483898455133805
Starting epoch 7/10.
Epoch finished! Loss: 0.735020326421811
Starting epoch 8/10.
Epoch finished! Loss: 0.7163826749874995
Starting epoch 9/10.
Epoch finished! Loss: 0.7109445837827829
Starting epoch 10/10.
Epoch finished! Loss: 0.7020204744659937
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6780952380952381
              precision    recall  f1-score   support

         0.0       0.81      0.77      0.79       163
         1.0       0.47      0.19      0.27       142
         2.0       0.70      0.78      0.74       329
         3.0       0.98      0.53      0.69       200
         4.0       0.55      0.91      0.68       216

    accuracy                           0.68      1050
   macro avg       0.70      0.64      0.63      1050
weighted avg       0.71      0.68      0.66      1050
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.52  76.69   96.62  80.65     78.62
1  86.19  19.01   96.70  47.37     27.14
2  82.48  78.12   84.47  69.65     73.64
3  90.86  53.00   99.76  98.15     68.83
4  82.57  91.20   80.34  54.57     68.28
Total accuracy: 67.81%
Average sen: 63.60%
Average spec: 91.58%
Macro f1-score: 63.30%

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3285664180150398
Starting epoch 2/10.
Epoch finished! Loss: 1.051719471353751
Starting epoch 3/10.
Epoch finished! Loss: 0.9597874561181435
Starting epoch 4/10.
Epoch finished! Loss: 0.8940431576508742
Starting epoch 5/10.
Epoch finished! Loss: 0.847116354566354
Starting epoch 6/10.
Epoch finished! Loss: 0.8067366843040172
Starting epoch 7/10.
Epoch finished! Loss: 0.792892484825391
Starting epoch 8/10.
Epoch finished! Loss: 0.7732000948144839
Starting epoch 9/10.
Epoch finished! Loss: 0.7431775777385785
Starting epoch 10/10.
Epoch finished! Loss: 0.7318252044228407
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5916666666666667
              precision    recall  f1-score   support

         0.0       0.88      0.42      0.57       196
         1.0       0.13      0.74      0.22        58
         2.0       0.96      0.60      0.74       527
         3.0       0.28      1.00      0.43        33
         4.0       0.80      0.62      0.70       266

    accuracy                           0.59      1080
   macro avg       0.61      0.68      0.53      1080
weighted avg       0.84      0.59      0.66      1080
 


====== chp041-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  88.52   42.35   98.76  88.30     57.24
1  71.76   74.14   71.62  12.91     21.99
2  79.07   59.58   97.65  96.02     73.54
3  92.04  100.00   91.79  27.73     43.42
4  86.94   62.41   94.96  80.19     70.19
Total accuracy: 59.17%
Average sen: 67.69%
Average spec: 90.96%
Macro f1-score: 53.28%

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3239058632117051
Starting epoch 2/10.
Epoch finished! Loss: 0.999358980013774
Starting epoch 3/10.
Epoch finished! Loss: 0.8560510949446605
Starting epoch 4/10.
Epoch finished! Loss: 0.7831856648509319
Starting epoch 5/10.
Epoch finished! Loss: 0.7544952628704218
Starting epoch 6/10.
Epoch finished! Loss: 0.743625148672324
Starting epoch 7/10.
Epoch finished! Loss: 0.7255695345310065
Starting epoch 8/10.
Epoch finished! Loss: 0.7163575610289207
Starting epoch 9/10.
Epoch finished! Loss: 0.7145754172251775
Starting epoch 10/10.
Epoch finished! Loss: 0.7028587218660575
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7027027027027027
              precision    recall  f1-score   support

         0.0       0.50      0.84      0.62       153
         1.0       0.47      0.52      0.49       232
         2.0       0.90      0.67      0.77       441
         3.0       0.99      0.80      0.88        93
         4.0       0.85      0.85      0.85       191

    accuracy                           0.70      1110
   macro avg       0.74      0.74      0.72      1110
weighted avg       0.75      0.70      0.71      1110
 


====== chp042-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.04  84.31   86.31  49.62     62.47
1  77.57  51.72   84.40  46.69     49.08
2  83.87  66.67   95.22  90.18     76.66
3  98.20  79.57   99.90  98.67     88.10
4  94.86  85.34   96.84  84.90     85.12
Total accuracy: 70.27%
Average sen: 73.52%
Average spec: 92.53%
Macro f1-score: 72.28%

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2266652689937458
Starting epoch 2/10.
Epoch finished! Loss: 0.9527708013545593
Starting epoch 3/10.
Epoch finished! Loss: 0.8497522006163726
Starting epoch 4/10.
Epoch finished! Loss: 0.8020676635637246
Starting epoch 5/10.
Epoch finished! Loss: 0.762607638440077
Starting epoch 6/10.
Epoch finished! Loss: 0.7576665595231369
Starting epoch 7/10.
Epoch finished! Loss: 0.7358136595906438
Starting epoch 8/10.
Epoch finished! Loss: 0.7287127666721933
Starting epoch 9/10.
Epoch finished! Loss: 0.6899834582474241
Starting epoch 10/10.
Epoch finished! Loss: 0.7088273197527558
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7475
              precision    recall  f1-score   support

         0.0       0.91      0.70      0.79       143
         1.0       0.60      0.18      0.28       197
         2.0       0.76      0.95      0.85       506
         3.0       1.00      0.19      0.32        64
         4.0       0.69      0.92      0.79       290

    accuracy                           0.75      1200
   macro avg       0.79      0.59      0.60      1200
weighted avg       0.75      0.75      0.71      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.58  69.93   99.05   90.91     79.05
1  84.58  18.27   97.61   60.00     28.02
2  85.50  95.06   78.53   76.35     84.68
3  95.67  18.75  100.00  100.00     31.58
4  88.17  92.41   86.81   69.07     79.06
Total accuracy: 74.75%
Average sen: 58.89%
Average spec: 92.40%
Macro f1-score: 60.48%

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3534883618354798
Starting epoch 2/10.
Epoch finished! Loss: 1.0699433533044962
Starting epoch 3/10.
Epoch finished! Loss: 0.9782605670965635
Starting epoch 4/10.
Epoch finished! Loss: 0.8900891547019665
Starting epoch 5/10.
Epoch finished! Loss: 0.8401061702233095
Starting epoch 6/10.
Epoch finished! Loss: 0.7912173404143407
Starting epoch 7/10.
Epoch finished! Loss: 0.7796316396731596
Starting epoch 8/10.
Epoch finished! Loss: 0.7568064628885343
Starting epoch 9/10.
Epoch finished! Loss: 0.7283561534606493
Starting epoch 10/10.
Epoch finished! Loss: 0.7235628421490009
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5666666666666667
              precision    recall  f1-score   support

         0.0       0.53      0.64      0.58        25
         1.0       0.22      0.39      0.28        93
         2.0       0.44      0.61      0.51       324
         3.0       1.00      0.52      0.68       484
         4.0       0.58      0.75      0.65       124

    accuracy                           0.57      1050
   macro avg       0.56      0.58      0.54      1050
weighted avg       0.70      0.57      0.59      1050
 


====== chp044-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.81  64.00   98.63   53.33     58.18
1  82.57  38.71   86.83   22.22     28.24
2  64.48  61.11   65.98   44.49     51.50
3  77.90  52.07  100.00  100.00     68.48
4  90.57  75.00   92.66   57.76     65.26
Total accuracy: 56.67%
Average sen: 58.18%
Average spec: 88.82%
Macro f1-score: 54.33%

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2136539740912242
Starting epoch 2/10.
Epoch finished! Loss: 0.9956827633169166
Starting epoch 3/10.
Epoch finished! Loss: 0.8884771836770547
Starting epoch 4/10.
Epoch finished! Loss: 0.8276599216415155
Starting epoch 5/10.
Epoch finished! Loss: 0.7724675484375604
Starting epoch 6/10.
Epoch finished! Loss: 0.740112935484146
Starting epoch 7/10.
Epoch finished! Loss: 0.7247653798016802
Starting epoch 8/10.
Epoch finished! Loss: 0.7075346826816618
Starting epoch 9/10.
Epoch finished! Loss: 0.6965450829750782
Starting epoch 10/10.
Epoch finished! Loss: 0.6751804375970686
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6021684737281068
              precision    recall  f1-score   support

         0.0       0.51      0.68      0.58       151
         1.0       0.26      0.34      0.29       135
         2.0       0.65      0.94      0.77       442
         3.0       0.96      0.45      0.61       221
         4.0       0.78      0.23      0.36       250

    accuracy                           0.60      1199
   macro avg       0.63      0.53      0.52      1199
weighted avg       0.67      0.60      0.58      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.82  67.55   90.74  51.26     58.29
1  81.65  34.07   87.69  25.99     29.49
2  78.82  94.34   69.75  64.55     76.65
3  89.49  44.80   99.59  96.12     61.11
4  82.65  23.20   98.31  78.38     35.80
Total accuracy: 60.22%
Average sen: 52.79%
Average spec: 89.22%
Macro f1-score: 52.27%

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3405997523894677
Starting epoch 2/10.
Epoch finished! Loss: 1.0225111420337971
Starting epoch 3/10.
Epoch finished! Loss: 0.8889604504291828
Starting epoch 4/10.
Epoch finished! Loss: 0.8484768818204219
Starting epoch 5/10.
Epoch finished! Loss: 0.8051386061769266
Starting epoch 6/10.
Epoch finished! Loss: 0.7723395462219532
Starting epoch 7/10.
Epoch finished! Loss: 0.7487488376406523
Starting epoch 8/10.
Epoch finished! Loss: 0.7244801131578592
Starting epoch 9/10.
Epoch finished! Loss: 0.70339440623155
Starting epoch 10/10.
Epoch finished! Loss: 0.7007924052385184
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6509259259259259
              precision    recall  f1-score   support

         0.0       0.87      0.88      0.88       226
         1.0       0.58      0.29      0.39       357
         2.0       0.46      0.90      0.61       192
         3.0       1.00      0.50      0.67         2
         4.0       0.76      0.74      0.75       303

    accuracy                           0.65      1080
   macro avg       0.74      0.66      0.66      1080
weighted avg       0.67      0.65      0.63      1080
 


====== chp046-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.81  88.05   96.60   87.28     87.67
1  69.72  29.41   89.63   58.33     39.11
2  79.44  90.10   77.14   46.01     60.92
3  99.91  50.00  100.00  100.00     66.67
4  86.30  74.26   90.99   76.27     75.25
Total accuracy: 65.09%
Average sen: 66.37%
Average spec: 90.87%
Macro f1-score: 65.92%

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2514898999379231
Starting epoch 2/10.
Epoch finished! Loss: 0.9955161963517849
Starting epoch 3/10.
Epoch finished! Loss: 0.8860433271298042
Starting epoch 4/10.
Epoch finished! Loss: 0.8427782212312405
Starting epoch 5/10.
Epoch finished! Loss: 0.8177765706410774
Starting epoch 6/10.
Epoch finished! Loss: 0.7935864856609931
Starting epoch 7/10.
Epoch finished! Loss: 0.7535225523205904
Starting epoch 8/10.
Epoch finished! Loss: 0.7395255217185387
Starting epoch 9/10.
Epoch finished! Loss: 0.7274359746621205
Starting epoch 10/10.
Epoch finished! Loss: 0.7243108838796616
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.42873563218390803
              precision    recall  f1-score   support

         0.0       0.56      0.87      0.68       291
         1.0       0.21      0.06      0.09       231
         2.0       0.69      0.33      0.44       233
         3.0       0.00      0.00      0.00        25
         4.0       0.13      0.36      0.19        90

    accuracy                           0.43       870
   macro avg       0.32      0.32      0.28       870
weighted avg       0.44      0.43      0.39       870
 


====== chp047-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  72.41  86.60   65.28  55.63     67.74
1  69.31   5.63   92.33  20.97      8.87
2  78.05  32.62   94.66  69.09     44.31
3  97.13   0.00  100.00   0.00      0.00
4  68.85  35.56   72.69  13.06     19.10
Total accuracy: 42.87%
Average sen: 32.08%
Average spec: 84.99%
Macro f1-score: 28.01%

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2263719904881256
Starting epoch 2/10.
Epoch finished! Loss: 1.0034975157334254
Starting epoch 3/10.
Epoch finished! Loss: 0.9215973262603466
Starting epoch 4/10.
Epoch finished! Loss: 0.8654908929879849
Starting epoch 5/10.
Epoch finished! Loss: 0.8362175063445018
Starting epoch 6/10.
Epoch finished! Loss: 0.807775562772384
Starting epoch 7/10.
Epoch finished! Loss: 0.7763550765239275
Starting epoch 8/10.
Epoch finished! Loss: 0.7764733015344694
Starting epoch 9/10.
Epoch finished! Loss: 0.7611541754924334
Starting epoch 10/10.
Epoch finished! Loss: 0.7401920237220251
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6450980392156863
              precision    recall  f1-score   support

         0.0       0.28      1.00      0.44        38
         1.0       0.39      0.68      0.50       144
         2.0       0.81      0.88      0.85       495
         3.0       0.84      0.49      0.62       107
         4.0       0.97      0.14      0.24       236

    accuracy                           0.65      1020
   macro avg       0.66      0.64      0.53      1020
weighted avg       0.77      0.65      0.62      1020
 


====== chp048-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  90.49  100.00   90.12  28.15     43.93
1  80.69   68.06   82.76  39.36     49.87
2  84.31   88.48   80.38  80.96     84.56
3  93.63   48.60   98.90  83.87     61.54
4  79.90   13.56   99.87  96.97     23.79
Total accuracy: 64.51%
Average sen: 63.74%
Average spec: 90.41%
Macro f1-score: 52.74%

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3829427535717305
Starting epoch 2/10.
Epoch finished! Loss: 1.0226336410412422
Starting epoch 3/10.
Epoch finished! Loss: 0.8668511674954341
Starting epoch 4/10.
Epoch finished! Loss: 0.7995212541176723
Starting epoch 5/10.
Epoch finished! Loss: 0.7801223593262526
Starting epoch 6/10.
Epoch finished! Loss: 0.7581948311283038
Starting epoch 7/10.
Epoch finished! Loss: 0.7369043793815833
Starting epoch 8/10.
Epoch finished! Loss: 0.7260332433077005
Starting epoch 9/10.
Epoch finished! Loss: 0.7228711743767445
Starting epoch 10/10.
Epoch finished! Loss: 0.7012832022630251
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5962962962962963
              precision    recall  f1-score   support

         0.0       0.27      0.67      0.39       108
         1.0       0.55      0.63      0.59       387
         2.0       0.85      0.41      0.55       360
         3.0       0.97      0.95      0.96        95
         4.0       0.84      0.72      0.77       130

    accuracy                           0.60      1080
   macro avg       0.70      0.67      0.65      1080
weighted avg       0.69      0.60      0.61      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  79.07  66.67   80.45  27.48     38.92
1  68.24  62.79   71.28  54.98     58.62
2  77.78  40.56   96.39  84.88     54.89
3  99.26  94.74   99.70  96.77     95.74
4  94.91  71.54   98.11  83.78     77.18
Total accuracy: 59.63%
Average sen: 67.26%
Average spec: 89.19%
Macro f1-score: 65.07%

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2678285823418545
Starting epoch 2/10.
Epoch finished! Loss: 0.9727148145437241
Starting epoch 3/10.
Epoch finished! Loss: 0.8441135055743731
Starting epoch 4/10.
Epoch finished! Loss: 0.7919436731017553
Starting epoch 5/10.
Epoch finished! Loss: 0.7508392006158828
Starting epoch 6/10.
Epoch finished! Loss: 0.7334602618446717
Starting epoch 7/10.
Epoch finished! Loss: 0.7259401230857923
Starting epoch 8/10.
Epoch finished! Loss: 0.7116345872099583
Starting epoch 9/10.
Epoch finished! Loss: 0.6936970645418534
Starting epoch 10/10.
Epoch finished! Loss: 0.6936521085409018
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6972222222222222
              precision    recall  f1-score   support

         0.0       0.40      0.83      0.54        30
         1.0       0.33      0.17      0.22       136
         2.0       0.72      0.68      0.70       404
         3.0       0.84      0.86      0.85       239
         4.0       0.70      0.83      0.76       271

    accuracy                           0.70      1080
   macro avg       0.60      0.67      0.61      1080
weighted avg       0.68      0.70      0.68      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.02  83.33   96.38  39.68     53.76
1  85.19  16.91   95.02  32.86     22.33
2  78.15  67.82   84.32  72.11     69.90
3  93.24  86.19   95.24  83.74     84.95
4  86.85  83.03   88.13  70.09     76.01
Total accuracy: 69.72%
Average sen: 67.46%
Average spec: 91.82%
Macro f1-score: 61.39%

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3144751214064085
Starting epoch 2/10.
Epoch finished! Loss: 1.0635791670817596
Starting epoch 3/10.
Epoch finished! Loss: 0.9637516195957477
Starting epoch 4/10.
Epoch finished! Loss: 0.9006344348192215
Starting epoch 5/10.
Epoch finished! Loss: 0.8606758129138213
Starting epoch 6/10.
Epoch finished! Loss: 0.8329626766534952
Starting epoch 7/10.
Epoch finished! Loss: 0.8041955026296469
Starting epoch 8/10.
Epoch finished! Loss: 0.7877403985995513
Starting epoch 9/10.
Epoch finished! Loss: 0.7690144677574818
Starting epoch 10/10.
Epoch finished! Loss: 0.7538446986904511
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8595959595959596
              precision    recall  f1-score   support

         0.0       0.92      0.87      0.90       159
         1.0       0.59      0.41      0.49        87
         2.0       0.86      0.93      0.90       439
         3.0       1.00      0.73      0.84        99
         4.0       0.85      0.94      0.89       206

    accuracy                           0.86       990
   macro avg       0.84      0.78      0.80       990
weighted avg       0.86      0.86      0.85       990
 


====== chp052-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.77  87.42   98.56   92.05     89.68
1  92.32  41.38   97.23   59.02     48.65
2  90.30  93.39   87.84   85.95     89.52
3  97.27  72.73  100.00  100.00     84.21
4  95.25  94.17   95.54   84.72     89.20
Total accuracy: 85.96%
Average sen: 77.82%
Average spec: 95.83%
Macro f1-score: 80.25%

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2554298960245573
Starting epoch 2/10.
Epoch finished! Loss: 0.9841444588624514
Starting epoch 3/10.
Epoch finished! Loss: 0.8586811778637079
Starting epoch 4/10.
Epoch finished! Loss: 0.8053818001196935
Starting epoch 5/10.
Epoch finished! Loss: 0.7598843088516822
Starting epoch 6/10.
Epoch finished! Loss: 0.7315673424647404
Starting epoch 7/10.
Epoch finished! Loss: 0.7154269969234099
Starting epoch 8/10.
Epoch finished! Loss: 0.7020501200969402
Starting epoch 9/10.
Epoch finished! Loss: 0.694229438327826
Starting epoch 10/10.
Epoch finished! Loss: 0.6940908391888325
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7157407407407408
              precision    recall  f1-score   support

         0.0       0.98      0.38      0.55       251
         1.0       0.38      0.65      0.48       147
         2.0       0.80      0.82      0.81       305
         3.0       0.99      0.84      0.91       250
         4.0       0.58      0.94      0.72       127

    accuracy                           0.72      1080
   macro avg       0.75      0.73      0.69      1080
weighted avg       0.80      0.72      0.72      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.37  37.85   99.76  97.94     54.60
1  80.93  65.31   83.39  38.25     48.24
2  89.26  82.30   92.00  80.19     81.23
3  96.20  84.40   99.76  99.06     91.14
4  91.39  94.49   90.98  58.25     72.07
Total accuracy: 71.57%
Average sen: 72.87%
Average spec: 93.18%
Macro f1-score: 69.46%

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2848765164613725
Starting epoch 2/10.
Epoch finished! Loss: 0.9819843399983186
Starting epoch 3/10.
Epoch finished! Loss: 0.8767568776240715
Starting epoch 4/10.
Epoch finished! Loss: 0.8261467076264895
Starting epoch 5/10.
Epoch finished! Loss: 0.7837764762915098
Starting epoch 6/10.
Epoch finished! Loss: 0.7507705381283394
Starting epoch 7/10.
Epoch finished! Loss: 0.7458975378137368
Starting epoch 8/10.
Epoch finished! Loss: 0.7161662283998269
Starting epoch 9/10.
Epoch finished! Loss: 0.7083962332743865
Starting epoch 10/10.
Epoch finished! Loss: 0.7048039513138624
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6612612612612613
              precision    recall  f1-score   support

         0.0       0.91      0.44      0.59       231
         1.0       0.26      0.32      0.28        92
         2.0       0.91      0.64      0.75       472
         3.0       0.91      0.94      0.93        99
         4.0       0.46      0.96      0.62       216

    accuracy                           0.66      1110
   macro avg       0.69      0.66      0.64      1110
weighted avg       0.77      0.66      0.67      1110
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.39  43.72   98.86  90.99     59.06
1  86.85  31.52   91.85  25.89     28.43
2  82.16  64.19   95.45  91.27     75.37
3  98.65  93.94   99.11  91.18     92.54
4  77.21  96.30   72.60  45.92     62.18
Total accuracy: 66.13%
Average sen: 65.94%
Average spec: 91.57%
Macro f1-score: 63.52%

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2160549340339808
Starting epoch 2/10.
Epoch finished! Loss: 1.004341138096956
Starting epoch 3/10.
Epoch finished! Loss: 0.8954194215627816
Starting epoch 4/10.
Epoch finished! Loss: 0.8188381963051282
Starting epoch 5/10.
Epoch finished! Loss: 0.7802240542494334
Starting epoch 6/10.
Epoch finished! Loss: 0.7544247371646075
Starting epoch 7/10.
Epoch finished! Loss: 0.7389357802959589
Starting epoch 8/10.
Epoch finished! Loss: 0.7184974066340006
Starting epoch 9/10.
Epoch finished! Loss: 0.7104985720836199
Starting epoch 10/10.
Epoch finished! Loss: 0.7072803241702227
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7387387387387387
              precision    recall  f1-score   support

         0.0       0.98      0.65      0.78       211
         1.0       0.56      0.59      0.57       184
         2.0       0.83      0.87      0.85       408
         3.0       0.79      0.73      0.76       130
         4.0       0.55      0.69      0.61       177

    accuracy                           0.74      1110
   macro avg       0.74      0.71      0.72      1110
weighted avg       0.76      0.74      0.74      1110
 


====== chp055-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.15  65.40   99.67  97.87     78.41
1  85.41  58.70   90.71  55.67     57.14
2  88.74  87.25   89.60  82.98     85.07
3  94.50  73.08   97.35  78.51     75.70
4  85.95  69.49   89.07  54.67     61.19
Total accuracy: 73.87%
Average sen: 70.78%
Average spec: 93.28%
Macro f1-score: 71.50%

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3518742157862738
Starting epoch 2/10.
Epoch finished! Loss: 0.94825343306248
Starting epoch 3/10.
Epoch finished! Loss: 0.834858138515399
Starting epoch 4/10.
Epoch finished! Loss: 0.7839222887387642
Starting epoch 5/10.
Epoch finished! Loss: 0.7611998459467522
Starting epoch 6/10.
Epoch finished! Loss: 0.7503255636646198
Starting epoch 7/10.
Epoch finished! Loss: 0.7243242941223658
Starting epoch 8/10.
Epoch finished! Loss: 0.7202896802471235
Starting epoch 9/10.
Epoch finished! Loss: 0.6996355336446028
Starting epoch 10/10.
Epoch finished! Loss: 0.6883644138391202
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7398148148148148
              precision    recall  f1-score   support

         0.0       0.62      0.53      0.57        78
         1.0       0.61      0.54      0.57       284
         2.0       0.80      0.82      0.81       258
         3.0       0.91      0.97      0.94       185
         4.0       0.71      0.78      0.74       275

    accuracy                           0.74      1080
   macro avg       0.73      0.73      0.73      1080
weighted avg       0.73      0.74      0.73      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.26  52.56   97.50  62.12     56.94
1  78.98  53.87   87.94  61.45     57.41
2  90.74  81.78   93.55  79.92     80.84
3  97.87  97.30   97.99  90.91     93.99
4  86.11  77.82   88.94  70.63     74.05
Total accuracy: 73.98%
Average sen: 72.67%
Average spec: 93.19%
Macro f1-score: 72.65%

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.241309521281121
Starting epoch 2/10.
Epoch finished! Loss: 0.9363490032413291
Starting epoch 3/10.
Epoch finished! Loss: 0.8383549167612805
Starting epoch 4/10.
Epoch finished! Loss: 0.793466588475069
Starting epoch 5/10.
Epoch finished! Loss: 0.7456292451348544
Starting epoch 6/10.
Epoch finished! Loss: 0.7201259414661805
Starting epoch 7/10.
Epoch finished! Loss: 0.715081547102873
Starting epoch 8/10.
Epoch finished! Loss: 0.7048134364216484
Starting epoch 9/10.
Epoch finished! Loss: 0.7090272404052116
Starting epoch 10/10.
Epoch finished! Loss: 0.6970031480071167
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7929854576561164
              precision    recall  f1-score   support

         0.0       0.92      0.72      0.81       267
         1.0       0.53      0.37      0.44       152
         2.0       0.78      0.96      0.86       496
         3.0       0.91      0.53      0.67        74
         4.0       0.82      0.90      0.86       180

    accuracy                           0.79      1169
   macro avg       0.79      0.70      0.73      1169
weighted avg       0.79      0.79      0.78      1169
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.22  71.91   98.23  92.31     80.84
1  87.60  36.84   95.18  53.33     43.58
2  86.74  96.37   79.64  77.72     86.05
3  96.66  52.70   99.63  90.70     66.67
4  95.38  90.00   96.36  81.82     85.71
Total accuracy: 79.30%
Average sen: 69.57%
Average spec: 93.81%
Macro f1-score: 72.57%

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2797246877963726
Starting epoch 2/10.
Epoch finished! Loss: 0.9869947722324959
Starting epoch 3/10.
Epoch finished! Loss: 0.8696024429339629
Starting epoch 4/10.
Epoch finished! Loss: 0.8107825118761797
Starting epoch 5/10.
Epoch finished! Loss: 0.7768185798938457
Starting epoch 6/10.
Epoch finished! Loss: 0.7365118087484286
Starting epoch 7/10.
Epoch finished! Loss: 0.7262128663750795
Starting epoch 8/10.
Epoch finished! Loss: 0.7173709470492143
Starting epoch 9/10.
Epoch finished! Loss: 0.7069428764856779
Starting epoch 10/10.
Epoch finished! Loss: 0.6976506308867381
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6872549019607843
              precision    recall  f1-score   support

         0.0       0.78      0.74      0.76       105
         1.0       0.12      0.36      0.18        44
         2.0       0.68      0.67      0.67       317
         3.0       0.98      0.68      0.81       258
         4.0       0.74      0.74      0.74       296

    accuracy                           0.69      1020
   macro avg       0.66      0.64      0.63      1020
weighted avg       0.76      0.69      0.71      1020
 


====== chp058-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.20  74.29   97.60  78.00     76.10
1  85.88  36.36   88.11  12.12     18.18
2  79.71  66.88   85.49  67.52     67.19
3  91.67  68.22   99.61  98.32     80.55
4  85.00  73.99   89.50  74.24     74.11
Total accuracy: 68.73%
Average sen: 63.95%
Average spec: 92.06%
Macro f1-score: 63.23%

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2323337224813609
Starting epoch 2/10.
Epoch finished! Loss: 0.9521191897300574
Starting epoch 3/10.
Epoch finished! Loss: 0.8419920451365984
Starting epoch 4/10.
Epoch finished! Loss: 0.7917977124452591
Starting epoch 5/10.
Epoch finished! Loss: 0.7783202838439208
Starting epoch 6/10.
Epoch finished! Loss: 0.7446931536381062
Starting epoch 7/10.
Epoch finished! Loss: 0.7370361646780601
Starting epoch 8/10.
Epoch finished! Loss: 0.7176844766506782
Starting epoch 9/10.
Epoch finished! Loss: 0.7185869317788344
Starting epoch 10/10.
Epoch finished! Loss: 0.6924341643085846
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6738738738738739
              precision    recall  f1-score   support

         0.0       0.97      0.77      0.86       247
         1.0       0.45      0.52      0.48       254
         2.0       0.86      0.54      0.66       355
         3.0       0.70      0.84      0.76        87
         4.0       0.55      0.99      0.71       167

    accuracy                           0.67      1110
   macro avg       0.71      0.73      0.69      1110
weighted avg       0.73      0.67      0.68      1110
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.23  76.52   99.30  96.92     85.52
1  74.59  51.57   81.43  45.17     48.16
2  82.34  53.52   95.89  85.97     65.97
3  95.95  83.91   96.97  70.19     76.44
4  87.66  98.80   85.68  55.00     70.66
Total accuracy: 67.39%
Average sen: 72.86%
Average spec: 91.86%
Macro f1-score: 69.35%

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2350900359595605
Starting epoch 2/10.
Epoch finished! Loss: 0.9596422558585649
Starting epoch 3/10.
Epoch finished! Loss: 0.8619786229372945
Starting epoch 4/10.
Epoch finished! Loss: 0.8075737266236751
Starting epoch 5/10.
Epoch finished! Loss: 0.7793595006106904
Starting epoch 6/10.
Epoch finished! Loss: 0.7495636200122391
Starting epoch 7/10.
Epoch finished! Loss: 0.7221427319362818
Starting epoch 8/10.
Epoch finished! Loss: 0.7204920814074144
Starting epoch 9/10.
Epoch finished! Loss: 0.7000298313652686
Starting epoch 10/10.
Epoch finished! Loss: 0.6916310065731579
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7063492063492064
              precision    recall  f1-score   support

         0.0       0.79      0.88      0.84       519
         1.0       0.42      0.62      0.50       201
         2.0       0.69      0.74      0.71       228
         3.0       0.97      0.64      0.77       158
         4.0       1.00      0.25      0.40       154

    accuracy                           0.71      1260
   macro avg       0.77      0.63      0.64      1260
weighted avg       0.76      0.71      0.70      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.71  88.25   83.94   79.38     83.58
1  80.32  62.19   83.76   42.09     50.20
2  89.21  73.68   92.64   68.85     71.19
3  95.24  63.92   99.73   97.12     77.10
4  90.79  24.68  100.00  100.00     39.58
Total accuracy: 70.63%
Average sen: 62.54%
Average spec: 92.01%
Macro f1-score: 64.33%

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.71  75.21   95.52  72.99     74.08
1  84.30  49.27   89.38  40.24     44.30
2  83.75  79.01   86.63  78.22     78.61
3  94.13  73.23   98.58  91.64     81.41
4  89.11  69.64   93.42  70.09     69.87
Total accuracy: 72.00%
Average sen: 69.27%
Average spec: 92.71%
Macro f1-score: 69.65%
