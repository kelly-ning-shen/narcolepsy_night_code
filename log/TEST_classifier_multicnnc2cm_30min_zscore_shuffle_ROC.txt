cuda:0
Subjects num: 78

30min inputs: chc001-nsrr (13)
30min inputs: chc004-nsrr (17)
30min inputs: chc005-nsrr (15)
30min inputs: chc006-nsrr (13)
30min inputs: chc008-nsrr (16)
30min inputs: chc009-nsrr (14)
30min inputs: chc010-nsrr (14)
30min inputs: chc012-nsrr (15)
30min inputs: chc013-nsrr (15)
30min inputs: chc014-nsrr (15)
30min inputs: chc015-nsrr (15)
30min inputs: chc016-nsrr (15)
30min inputs: chc022-nsrr (13)
30min inputs: chc025-nsrr (13)
30min inputs: chc027-nsrr (15)
30min inputs: chc028-nsrr (14)
30min inputs: chc033-nsrr (14)
30min inputs: chc035-nsrr (15)
30min inputs: chc037-nsrr (14)
30min inputs: chc040-nsrr (18)
30min inputs: chc041-nsrr (14)
30min inputs: chc052-nsrr (15)
30min inputs: chc056-nsrr (15)
30min inputs: chp001-nsrr (19)
30min inputs: chp002-nsrr (18)
30min inputs: chp003-nsrr (16)
30min inputs: chp004-nsrr (16)
30min inputs: chp005-nsrr (21)
30min inputs: chp006-nsrr (18)
30min inputs: chp007-nsrr (19)
30min inputs: chp008-nsrr (15)
30min inputs: chp009-nsrr (17)
30min inputs: chp010-nsrr (16)
30min inputs: chp011-nsrr (16)
30min inputs: chp012-nsrr (18)
30min inputs: chp013-nsrr (16)
30min inputs: chp014-nsrr (16)
30min inputs: chp015-nsrr (19)
30min inputs: chp016-nsrr (21)
30min inputs: chp017-nsrr (16)
30min inputs: chp018-nsrr (18)
30min inputs: chp019-nsrr (15)
30min inputs: chp020-nsrr (19)
30min inputs: chp022-nsrr (21)
30min inputs: chp024-nsrr (18)
30min inputs: chp025-nsrr (7)
30min inputs: chp026-nsrr (15)
30min inputs: chp028-nsrr (17)
30min inputs: chp029-nsrr (17)
30min inputs: chp030-nsrr (20)
30min inputs: chp031-nsrr (18)
30min inputs: chp032-nsrr (17)
30min inputs: chp033-nsrr (16)
30min inputs: chp034-nsrr (17)
30min inputs: chp036-nsrr (21)
30min inputs: chp037-nsrr (17)
30min inputs: chp038-nsrr (17)
30min inputs: chp039-nsrr (18)
30min inputs: chp040-nsrr (17)
30min inputs: chp041-nsrr (18)
30min inputs: chp042-nsrr (18)
30min inputs: chp043-nsrr (20)
30min inputs: chp044-nsrr (17)
30min inputs: chp045-nsrr (20)
30min inputs: chp046-nsrr (18)
30min inputs: chp047-nsrr (14)
30min inputs: chp048-nsrr (17)
30min inputs: chp049-nsrr (18)
30min inputs: chp051-nsrr (18)
30min inputs: chp052-nsrr (16)
30min inputs: chp053-nsrr (18)
30min inputs: chp054-nsrr (18)
30min inputs: chp055-nsrr (18)
30min inputs: chp056-nsrr (18)
30min inputs: chp057-nsrr (19)
30min inputs: chp058-nsrr (17)
30min inputs: chp059-nsrr (18)
30min inputs: chp060-nsrr (21)

=== Test on chc001-nsrr. train_data(1287), test_data(13) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.360154, loss_ss: 1.615760, loss_d: 0.744395
0.0777 --- loss: 2.224247, loss_ss: 1.490283, loss_d: 0.733964
0.1554 --- loss: 2.345638, loss_ss: 1.519687, loss_d: 0.825951
0.2331 --- loss: 2.447763, loss_ss: 1.581957, loss_d: 0.865806
0.3108 --- loss: 1.923402, loss_ss: 1.525161, loss_d: 0.398241
cuda:0
Subjects num: 78

30min inputs: chc001-nsrr (13)
30min inputs: chc004-nsrr (17)
30min inputs: chc005-nsrr (15)
30min inputs: chc006-nsrr (13)
30min inputs: chc008-nsrr (16)
30min inputs: chc009-nsrr (14)
30min inputs: chc010-nsrr (14)
30min inputs: chc012-nsrr (15)
30min inputs: chc013-nsrr (15)
30min inputs: chc014-nsrr (15)
30min inputs: chc015-nsrr (15)
30min inputs: chc016-nsrr (15)
30min inputs: chc022-nsrr (13)
30min inputs: chc025-nsrr (13)
30min inputs: chc027-nsrr (15)
30min inputs: chc028-nsrr (14)
30min inputs: chc033-nsrr (14)
30min inputs: chc035-nsrr (15)
30min inputs: chc037-nsrr (14)
30min inputs: chc040-nsrr (18)
30min inputs: chc041-nsrr (14)
30min inputs: chc052-nsrr (15)
30min inputs: chc056-nsrr (15)
30min inputs: chp001-nsrr (19)
30min inputs: chp002-nsrr (18)
30min inputs: chp003-nsrr (16)
30min inputs: chp004-nsrr (16)
30min inputs: chp005-nsrr (21)
30min inputs: chp006-nsrr (18)
30min inputs: chp007-nsrr (19)
30min inputs: chp008-nsrr (15)
30min inputs: chp009-nsrr (17)
30min inputs: chp010-nsrr (16)
30min inputs: chp011-nsrr (16)
30min inputs: chp012-nsrr (18)
30min inputs: chp013-nsrr (16)
30min inputs: chp014-nsrr (16)
30min inputs: chp015-nsrr (19)
30min inputs: chp016-nsrr (21)
30min inputs: chp017-nsrr (16)
30min inputs: chp018-nsrr (18)
30min inputs: chp019-nsrr (15)
30min inputs: chp020-nsrr (19)
30min inputs: chp022-nsrr (21)
30min inputs: chp024-nsrr (18)
30min inputs: chp025-nsrr (7)
30min inputs: chp026-nsrr (15)
30min inputs: chp028-nsrr (17)
30min inputs: chp029-nsrr (17)
30min inputs: chp030-nsrr (20)
30min inputs: chp031-nsrr (18)
30min inputs: chp032-nsrr (17)
30min inputs: chp033-nsrr (16)
30min inputs: chp034-nsrr (17)
30min inputs: chp036-nsrr (21)
30min inputs: chp037-nsrr (17)
30min inputs: chp038-nsrr (17)
30min inputs: chp039-nsrr (18)
30min inputs: chp040-nsrr (17)
30min inputs: chp041-nsrr (18)
30min inputs: chp042-nsrr (18)
30min inputs: chp043-nsrr (20)
30min inputs: chp044-nsrr (17)
30min inputs: chp045-nsrr (20)
30min inputs: chp046-nsrr (18)
30min inputs: chp047-nsrr (14)
30min inputs: chp048-nsrr (17)
30min inputs: chp049-nsrr (18)
30min inputs: chp051-nsrr (18)
30min inputs: chp052-nsrr (16)
30min inputs: chp053-nsrr (18)
30min inputs: chp054-nsrr (18)
30min inputs: chp055-nsrr (18)
30min inputs: chp056-nsrr (18)
30min inputs: chp057-nsrr (19)
30min inputs: chp058-nsrr (17)
30min inputs: chp059-nsrr (18)
30min inputs: chp060-nsrr (21)

=== Test on chc001-nsrr. train_data(1287), test_data(13) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.524446, loss_ss: 1.852025, loss_d: 0.672420
0.0777 --- loss: 2.397892, loss_ss: 1.686450, loss_d: 0.711442
0.1554 --- loss: 2.409005, loss_ss: 1.626416, loss_d: 0.782589
0.2331 --- loss: 2.079455, loss_ss: 1.486415, loss_d: 0.593040
0.3108 --- loss: 2.248105, loss_ss: 1.601325, loss_d: 0.646780
0.3885 --- loss: 1.958819, loss_ss: 1.556723, loss_d: 0.402096
0.4662 --- loss: 1.878061, loss_ss: 1.540988, loss_d: 0.337073
0.5439 --- loss: 2.292071, loss_ss: 1.495573, loss_d: 0.796498
0.6216 --- loss: 2.152752, loss_ss: 1.448965, loss_d: 0.703787
0.6993 --- loss: 1.720418, loss_ss: 1.426183, loss_d: 0.294235
0.7770 --- loss: 2.043778, loss_ss: 1.339617, loss_d: 0.704160
0.8547 --- loss: 1.750681, loss_ss: 1.262737, loss_d: 0.487944
0.9324 --- loss: 1.566611, loss_ss: 1.234328, loss_d: 0.332282
Epoch finished! Loss: 2.0666855964809656
Starting epoch 2/10.
0.0000 --- loss: 1.802529, loss_ss: 1.252563, loss_d: 0.549966
0.0777 --- loss: 1.635015, loss_ss: 1.261199, loss_d: 0.373816
0.1554 --- loss: 2.142321, loss_ss: 1.505964, loss_d: 0.636357
0.2331 --- loss: 1.675403, loss_ss: 1.327914, loss_d: 0.347489
0.3108 --- loss: 1.558086, loss_ss: 1.172207, loss_d: 0.385879
0.3885 --- loss: 1.773670, loss_ss: 1.187734, loss_d: 0.585936
0.4662 --- loss: 1.534415, loss_ss: 1.217833, loss_d: 0.316582
0.5439 --- loss: 1.265824, loss_ss: 1.147599, loss_d: 0.118224
0.6216 --- loss: 1.224102, loss_ss: 1.073943, loss_d: 0.150159
0.6993 --- loss: 1.453620, loss_ss: 1.165015, loss_d: 0.288605
0.7770 --- loss: 1.589030, loss_ss: 1.047274, loss_d: 0.541756
0.8547 --- loss: 1.445199, loss_ss: 1.263264, loss_d: 0.181935
0.9324 --- loss: 1.177286, loss_ss: 1.030858, loss_d: 0.146427
Epoch finished! Loss: 1.6357447812333703
Starting epoch 3/10.
0.0000 --- loss: 1.818215, loss_ss: 1.148001, loss_d: 0.670214
0.0777 --- loss: 1.452350, loss_ss: 1.199462, loss_d: 0.252888
0.1554 --- loss: 1.172904, loss_ss: 1.033642, loss_d: 0.139262
0.2331 --- loss: 1.228717, loss_ss: 0.949415, loss_d: 0.279302
0.3108 --- loss: 1.612585, loss_ss: 1.441115, loss_d: 0.171470
0.3885 --- loss: 1.431451, loss_ss: 1.051980, loss_d: 0.379472
0.4662 --- loss: 1.225416, loss_ss: 1.033002, loss_d: 0.192414
0.5439 --- loss: 1.183418, loss_ss: 1.051885, loss_d: 0.131534
0.6216 --- loss: 1.394909, loss_ss: 0.925264, loss_d: 0.469645
0.6993 --- loss: 1.289873, loss_ss: 1.237445, loss_d: 0.052428
0.7770 --- loss: 1.133101, loss_ss: 0.953841, loss_d: 0.179261
0.8547 --- loss: 1.062158, loss_ss: 0.921150, loss_d: 0.141008
0.9324 --- loss: 1.300886, loss_ss: 1.126053, loss_d: 0.174833
Epoch finished! Loss: 1.3729991326108575
Starting epoch 4/10.
0.0000 --- loss: 1.127179, loss_ss: 1.045318, loss_d: 0.081861
0.0777 --- loss: 1.163163, loss_ss: 0.959034, loss_d: 0.204129
0.1554 --- loss: 1.210441, loss_ss: 0.985575, loss_d: 0.224866
0.2331 --- loss: 1.182336, loss_ss: 1.073737, loss_d: 0.108599
0.3108 --- loss: 1.068868, loss_ss: 1.017090, loss_d: 0.051778
0.3885 --- loss: 1.051368, loss_ss: 0.928882, loss_d: 0.122486
0.4662 --- loss: 1.290595, loss_ss: 1.070443, loss_d: 0.220152
0.5439 --- loss: 0.890875, loss_ss: 0.854982, loss_d: 0.035892
0.6216 --- loss: 1.050310, loss_ss: 0.963766, loss_d: 0.086544
0.6993 --- loss: 1.018574, loss_ss: 0.877391, loss_d: 0.141183
0.7770 --- loss: 1.436970, loss_ss: 1.112871, loss_d: 0.324099
0.8547 --- loss: 1.121025, loss_ss: 1.075372, loss_d: 0.045653
0.9324 --- loss: 1.211557, loss_ss: 0.874945, loss_d: 0.336612
Epoch finished! Loss: 1.2693678569048643
Starting epoch 5/10.
0.0000 --- loss: 0.881030, loss_ss: 0.786467, loss_d: 0.094562
0.0777 --- loss: 1.212237, loss_ss: 0.871284, loss_d: 0.340953
0.1554 --- loss: 0.885988, loss_ss: 0.849310, loss_d: 0.036678
0.2331 --- loss: 1.394144, loss_ss: 0.762662, loss_d: 0.631481
0.3108 --- loss: 1.336484, loss_ss: 0.960509, loss_d: 0.375974
0.3885 --- loss: 1.255577, loss_ss: 1.087293, loss_d: 0.168284
0.4662 --- loss: 1.183034, loss_ss: 1.153940, loss_d: 0.029094
0.5439 --- loss: 1.005363, loss_ss: 0.918099, loss_d: 0.087264
0.6216 --- loss: 1.037585, loss_ss: 0.994653, loss_d: 0.042931
0.6993 --- loss: 1.201874, loss_ss: 1.094285, loss_d: 0.107589
0.7770 --- loss: 1.323508, loss_ss: 0.986732, loss_d: 0.336776
0.8547 --- loss: 1.168911, loss_ss: 1.072476, loss_d: 0.096436
0.9324 --- loss: 1.074291, loss_ss: 0.788442, loss_d: 0.285850
Epoch finished! Loss: 1.1561016258783638
Starting epoch 6/10.
0.0000 --- loss: 1.117750, loss_ss: 0.935003, loss_d: 0.182747
0.0777 --- loss: 1.560082, loss_ss: 1.327025, loss_d: 0.233057
0.1554 --- loss: 1.184025, loss_ss: 1.163723, loss_d: 0.020302
0.2331 --- loss: 0.998642, loss_ss: 0.974331, loss_d: 0.024311
0.3108 --- loss: 1.097071, loss_ss: 1.024770, loss_d: 0.072301
0.3885 --- loss: 1.245986, loss_ss: 0.828028, loss_d: 0.417959
0.4662 --- loss: 0.935855, loss_ss: 0.897107, loss_d: 0.038748
0.5439 --- loss: 0.961939, loss_ss: 0.941087, loss_d: 0.020852
0.6216 --- loss: 0.913382, loss_ss: 0.763764, loss_d: 0.149618
0.6993 --- loss: 1.502359, loss_ss: 1.189393, loss_d: 0.312966
0.7770 --- loss: 0.939626, loss_ss: 0.807575, loss_d: 0.132051
0.8547 --- loss: 0.928325, loss_ss: 0.893690, loss_d: 0.034636
0.9324 --- loss: 1.030911, loss_ss: 0.828660, loss_d: 0.202250
Epoch finished! Loss: 1.0954215759411454
Starting epoch 7/10.
0.0000 --- loss: 0.990046, loss_ss: 0.946475, loss_d: 0.043571
0.0777 --- loss: 1.065479, loss_ss: 0.997755, loss_d: 0.067725
0.1554 --- loss: 1.011978, loss_ss: 0.915027, loss_d: 0.096951
0.2331 --- loss: 0.887276, loss_ss: 0.860393, loss_d: 0.026883
0.3108 --- loss: 0.970853, loss_ss: 0.957595, loss_d: 0.013258
0.3885 --- loss: 1.298509, loss_ss: 1.082585, loss_d: 0.215925
0.4662 --- loss: 1.219958, loss_ss: 0.935949, loss_d: 0.284009
0.5439 --- loss: 0.984104, loss_ss: 0.847832, loss_d: 0.136272
0.6216 --- loss: 0.792843, loss_ss: 0.714866, loss_d: 0.077977
0.6993 --- loss: 0.796144, loss_ss: 0.709804, loss_d: 0.086340
0.7770 --- loss: 0.964238, loss_ss: 0.958109, loss_d: 0.006129
0.8547 --- loss: 0.775140, loss_ss: 0.768311, loss_d: 0.006829
0.9324 --- loss: 0.831821, loss_ss: 0.789872, loss_d: 0.041949
Epoch finished! Loss: 1.0096220960840583
Starting epoch 8/10.
0.0000 --- loss: 0.896890, loss_ss: 0.876636, loss_d: 0.020254
0.0777 --- loss: 0.842084, loss_ss: 0.802760, loss_d: 0.039323
0.1554 --- loss: 1.123685, loss_ss: 0.837927, loss_d: 0.285757
0.2331 --- loss: 0.919725, loss_ss: 0.862291, loss_d: 0.057434
0.3108 --- loss: 1.026563, loss_ss: 0.951500, loss_d: 0.075063
0.3885 --- loss: 1.121770, loss_ss: 0.982651, loss_d: 0.139118
0.4662 --- loss: 0.708543, loss_ss: 0.701352, loss_d: 0.007191
0.5439 --- loss: 0.975482, loss_ss: 0.973330, loss_d: 0.002152
0.6216 --- loss: 0.860377, loss_ss: 0.844714, loss_d: 0.015662
0.6993 --- loss: 0.952043, loss_ss: 0.716474, loss_d: 0.235569
0.7770 --- loss: 1.145582, loss_ss: 0.956114, loss_d: 0.189468
0.8547 --- loss: 0.835923, loss_ss: 0.820049, loss_d: 0.015874
0.9324 --- loss: 1.048653, loss_ss: 0.918975, loss_d: 0.129679
Epoch finished! Loss: 0.9581924621015787
Starting epoch 9/10.
0.0000 --- loss: 0.771314, loss_ss: 0.721634, loss_d: 0.049680
0.0777 --- loss: 1.014487, loss_ss: 0.975711, loss_d: 0.038776
0.1554 --- loss: 1.256864, loss_ss: 0.770264, loss_d: 0.486600
0.2331 --- loss: 0.724679, loss_ss: 0.706702, loss_d: 0.017977
0.3108 --- loss: 0.885613, loss_ss: 0.859482, loss_d: 0.026131
0.3885 --- loss: 0.914285, loss_ss: 0.907366, loss_d: 0.006919
0.4662 --- loss: 1.039102, loss_ss: 1.022584, loss_d: 0.016519
0.5439 --- loss: 0.858044, loss_ss: 0.790209, loss_d: 0.067835
0.6216 --- loss: 0.821004, loss_ss: 0.818653, loss_d: 0.002351
0.6993 --- loss: 0.976619, loss_ss: 0.956678, loss_d: 0.019941
0.7770 --- loss: 0.903221, loss_ss: 0.894578, loss_d: 0.008644
0.8547 --- loss: 1.036814, loss_ss: 0.965010, loss_d: 0.071804
0.9324 --- loss: 0.782476, loss_ss: 0.779692, loss_d: 0.002784
Epoch finished! Loss: 0.941900487523526
Starting epoch 10/10.
0.0000 --- loss: 0.811128, loss_ss: 0.717917, loss_d: 0.093211
0.0777 --- loss: 0.780883, loss_ss: 0.762814, loss_d: 0.018069
0.1554 --- loss: 1.083228, loss_ss: 1.023635, loss_d: 0.059592
0.2331 --- loss: 1.041109, loss_ss: 1.038219, loss_d: 0.002890
0.3108 --- loss: 0.846975, loss_ss: 0.835316, loss_d: 0.011660
0.3885 --- loss: 0.800334, loss_ss: 0.799727, loss_d: 0.000607
0.4662 --- loss: 1.059753, loss_ss: 1.057545, loss_d: 0.002208
0.5439 --- loss: 1.065709, loss_ss: 0.928497, loss_d: 0.137212
0.6216 --- loss: 1.297471, loss_ss: 0.859508, loss_d: 0.437962
0.6993 --- loss: 0.921695, loss_ss: 0.846061, loss_d: 0.075634
0.7770 --- loss: 1.015831, loss_ss: 0.934677, loss_d: 0.081154
0.8547 --- loss: 0.735834, loss_ss: 0.666935, loss_d: 0.068899
0.9324 --- loss: 1.194895, loss_ss: 0.999915, loss_d: 0.194979
Epoch finished! Loss: 0.9528583409264684
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.841025641025641
             precision    recall  f1-score   support

        0.0       0.59      1.00      0.74        78
        1.0       0.00      0.00      0.00        50
        2.0       0.92      0.90      0.91       397
        3.0       1.00      0.83      0.91       143
        4.0       0.72      0.91      0.80       112

avg / total       0.82      0.84      0.82       780
 


====== chc001-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  93.08  100.00   92.31   59.09     74.29
1  93.59    0.00  100.00    0.00      0.00
2  91.03   89.92   92.17   92.25     91.07
3  96.92   83.22  100.00  100.00     90.84
4  93.59   91.07   94.01   71.83     80.31
Total accuracy: 84.10%
Average sen: 72.84%
Average spec: 95.70%
Macro f1-score: 67.30%
Diagnosis acc on 30mins: 0.8461538461538461
[0.00834852 0.21603021 0.01146396 0.7078675  0.00461292 0.01177097
 0.17646959 0.11936657 0.30778828 0.06537262 0.02083906 0.98247141
 0.43824422]
pred: 0.23620352557358834, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc001-nsrr

=== Test on chc004-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.328407, loss_ss: 1.607362, loss_d: 0.721045
0.0779 --- loss: 2.105756, loss_ss: 1.529018, loss_d: 0.576738
0.1559 --- loss: 2.087942, loss_ss: 1.493269, loss_d: 0.594673
0.2338 --- loss: 1.650830, loss_ss: 1.394890, loss_d: 0.255940
0.3118 --- loss: 1.862529, loss_ss: 1.464288, loss_d: 0.398241
0.3897 --- loss: 1.606026, loss_ss: 1.325546, loss_d: 0.280480
0.4677 --- loss: 1.915336, loss_ss: 1.365765, loss_d: 0.549571
0.5456 --- loss: 1.821017, loss_ss: 1.296625, loss_d: 0.524391
0.6235 --- loss: 1.872441, loss_ss: 1.227214, loss_d: 0.645227
0.7015 --- loss: 2.085852, loss_ss: 1.370122, loss_d: 0.715731
0.7794 --- loss: 1.750791, loss_ss: 1.265333, loss_d: 0.485458
0.8574 --- loss: 1.798498, loss_ss: 1.282230, loss_d: 0.516268
0.9353 --- loss: 1.556012, loss_ss: 1.193868, loss_d: 0.362144
Epoch finished! Loss: 1.9666164480149746
Starting epoch 2/10.
0.0000 --- loss: 1.883027, loss_ss: 1.278747, loss_d: 0.604280
0.0779 --- loss: 1.625739, loss_ss: 1.348918, loss_d: 0.276821
0.1559 --- loss: 1.634949, loss_ss: 1.272294, loss_d: 0.362655
0.2338 --- loss: 1.858817, loss_ss: 1.319893, loss_d: 0.538923
0.3118 --- loss: 1.417386, loss_ss: 1.204435, loss_d: 0.212951
0.3897 --- loss: 1.471191, loss_ss: 1.192168, loss_d: 0.279023
0.4677 --- loss: 1.431951, loss_ss: 1.186791, loss_d: 0.245160
0.5456 --- loss: 1.550574, loss_ss: 1.158718, loss_d: 0.391856
0.6235 --- loss: 1.381423, loss_ss: 1.193182, loss_d: 0.188241
0.7015 --- loss: 1.641070, loss_ss: 1.414934, loss_d: 0.226136
0.7794 --- loss: 1.391128, loss_ss: 1.129843, loss_d: 0.261285
0.8574 --- loss: 1.371803, loss_ss: 1.104950, loss_d: 0.266853
0.9353 --- loss: 1.409780, loss_ss: 1.139650, loss_d: 0.270129
Epoch finished! Loss: 1.6027571577578783
Starting epoch 3/10.
0.0000 --- loss: 1.585798, loss_ss: 1.118592, loss_d: 0.467206
0.0779 --- loss: 1.274154, loss_ss: 0.951894, loss_d: 0.322259
0.1559 --- loss: 1.419185, loss_ss: 1.187111, loss_d: 0.232075
0.2338 --- loss: 1.288227, loss_ss: 1.102020, loss_d: 0.186207
0.3118 --- loss: 1.353608, loss_ss: 1.194648, loss_d: 0.158959
0.3897 --- loss: 1.434109, loss_ss: 1.046153, loss_d: 0.387956
0.4677 --- loss: 1.337756, loss_ss: 1.116648, loss_d: 0.221108
0.5456 --- loss: 1.213546, loss_ss: 1.124246, loss_d: 0.089299
0.6235 --- loss: 1.560037, loss_ss: 1.040851, loss_d: 0.519186
0.7015 --- loss: 1.302625, loss_ss: 1.152402, loss_d: 0.150223
0.7794 --- loss: 1.183292, loss_ss: 1.048995, loss_d: 0.134298
0.8574 --- loss: 1.184469, loss_ss: 0.905128, loss_d: 0.279341
0.9353 --- loss: 1.010382, loss_ss: 0.878905, loss_d: 0.131477
Epoch finished! Loss: 1.4150221971794963
Starting epoch 4/10.
0.0000 --- loss: 1.153043, loss_ss: 1.031262, loss_d: 0.121781
0.0779 --- loss: 1.330095, loss_ss: 1.022878, loss_d: 0.307216
0.1559 --- loss: 1.197274, loss_ss: 0.947459, loss_d: 0.249815
0.2338 --- loss: 1.206212, loss_ss: 0.850730, loss_d: 0.355481
0.3118 --- loss: 1.300902, loss_ss: 1.032286, loss_d: 0.268616
0.3897 --- loss: 1.156934, loss_ss: 0.975577, loss_d: 0.181358
0.4677 --- loss: 1.113084, loss_ss: 0.989717, loss_d: 0.123366
0.5456 --- loss: 0.889246, loss_ss: 0.842332, loss_d: 0.046914
0.6235 --- loss: 1.310244, loss_ss: 0.839905, loss_d: 0.470339
0.7015 --- loss: 1.050824, loss_ss: 0.873839, loss_d: 0.176984
0.7794 --- loss: 1.214326, loss_ss: 0.925998, loss_d: 0.288328
0.8574 --- loss: 1.074708, loss_ss: 0.997673, loss_d: 0.077035
0.9353 --- loss: 1.198798, loss_ss: 1.075210, loss_d: 0.123588
Epoch finished! Loss: 1.249761765357107
Starting epoch 5/10.
0.0000 --- loss: 1.056723, loss_ss: 1.008427, loss_d: 0.048297
0.0779 --- loss: 1.183768, loss_ss: 1.003334, loss_d: 0.180434
0.1559 --- loss: 1.036216, loss_ss: 0.876098, loss_d: 0.160118
0.2338 --- loss: 1.111030, loss_ss: 0.934111, loss_d: 0.176919
0.3118 --- loss: 1.263829, loss_ss: 0.860776, loss_d: 0.403053
0.3897 --- loss: 1.304741, loss_ss: 0.818238, loss_d: 0.486502
0.4677 --- loss: 0.915757, loss_ss: 0.885215, loss_d: 0.030542
0.5456 --- loss: 0.920477, loss_ss: 0.853231, loss_d: 0.067246
0.6235 --- loss: 1.229176, loss_ss: 1.158558, loss_d: 0.070618
0.7015 --- loss: 1.390465, loss_ss: 0.841029, loss_d: 0.549437
0.7794 --- loss: 0.951494, loss_ss: 0.822932, loss_d: 0.128562
0.8574 --- loss: 1.171767, loss_ss: 0.962303, loss_d: 0.209464
0.9353 --- loss: 2.427550, loss_ss: 0.771650, loss_d: 1.655900
Epoch finished! Loss: 1.1689528464339674
Starting epoch 6/10.
0.0000 --- loss: 1.223384, loss_ss: 1.124426, loss_d: 0.098957
0.0779 --- loss: 1.492873, loss_ss: 0.774718, loss_d: 0.718155
0.1559 --- loss: 1.105697, loss_ss: 0.880282, loss_d: 0.225414
0.2338 --- loss: 0.868625, loss_ss: 0.815704, loss_d: 0.052921
0.3118 --- loss: 0.951523, loss_ss: 0.778122, loss_d: 0.173401
0.3897 --- loss: 0.945854, loss_ss: 0.859145, loss_d: 0.086709
0.4677 --- loss: 1.195140, loss_ss: 1.009481, loss_d: 0.185660
0.5456 --- loss: 1.042771, loss_ss: 0.965657, loss_d: 0.077114
0.6235 --- loss: 1.272974, loss_ss: 1.168317, loss_d: 0.104657
0.7015 --- loss: 0.878460, loss_ss: 0.808335, loss_d: 0.070125
0.7794 --- loss: 1.114435, loss_ss: 0.897073, loss_d: 0.217361
0.8574 --- loss: 1.259182, loss_ss: 0.775691, loss_d: 0.483491
0.9353 --- loss: 1.076943, loss_ss: 0.890831, loss_d: 0.186112
Epoch finished! Loss: 1.1087446743622422
Starting epoch 7/10.
0.0000 --- loss: 1.677367, loss_ss: 0.759633, loss_d: 0.917734
0.0779 --- loss: 1.173866, loss_ss: 0.862526, loss_d: 0.311341
0.1559 --- loss: 1.272586, loss_ss: 1.191168, loss_d: 0.081418
0.2338 --- loss: 1.010970, loss_ss: 0.977306, loss_d: 0.033664
0.3118 --- loss: 0.932354, loss_ss: 0.867199, loss_d: 0.065155
0.3897 --- loss: 1.118975, loss_ss: 1.018080, loss_d: 0.100895
0.4677 --- loss: 1.080559, loss_ss: 0.894263, loss_d: 0.186296
0.5456 --- loss: 0.853036, loss_ss: 0.834565, loss_d: 0.018471
0.6235 --- loss: 0.909491, loss_ss: 0.764142, loss_d: 0.145349
0.7015 --- loss: 0.982593, loss_ss: 0.887213, loss_d: 0.095379
0.7794 --- loss: 1.077678, loss_ss: 0.849637, loss_d: 0.228041
0.8574 --- loss: 0.923216, loss_ss: 0.868840, loss_d: 0.054376
0.9353 --- loss: 0.943894, loss_ss: 0.670097, loss_d: 0.273797
Epoch finished! Loss: 1.0351505992002785
Starting epoch 8/10.
0.0000 --- loss: 0.908381, loss_ss: 0.864993, loss_d: 0.043388
0.0779 --- loss: 0.795412, loss_ss: 0.789476, loss_d: 0.005937
0.1559 --- loss: 0.868589, loss_ss: 0.825308, loss_d: 0.043281
0.2338 --- loss: 1.232814, loss_ss: 1.036286, loss_d: 0.196528
0.3118 --- loss: 0.835198, loss_ss: 0.797949, loss_d: 0.037249
0.3897 --- loss: 0.868307, loss_ss: 0.859513, loss_d: 0.008794
0.4677 --- loss: 0.848711, loss_ss: 0.765647, loss_d: 0.083064
0.5456 --- loss: 1.120288, loss_ss: 1.118359, loss_d: 0.001928
0.6235 --- loss: 1.010499, loss_ss: 0.977093, loss_d: 0.033406
0.7015 --- loss: 0.705933, loss_ss: 0.680080, loss_d: 0.025853
0.7794 --- loss: 1.100507, loss_ss: 1.086417, loss_d: 0.014090
0.8574 --- loss: 0.833074, loss_ss: 0.814943, loss_d: 0.018132
0.9353 --- loss: 0.973266, loss_ss: 0.894286, loss_d: 0.078980
Epoch finished! Loss: 0.9419855414889753
Starting epoch 9/10.
0.0000 --- loss: 1.402909, loss_ss: 0.942784, loss_d: 0.460125
0.0779 --- loss: 0.860907, loss_ss: 0.845846, loss_d: 0.015061
0.1559 --- loss: 1.055031, loss_ss: 1.019220, loss_d: 0.035811
0.2338 --- loss: 0.796004, loss_ss: 0.792710, loss_d: 0.003294
0.3118 --- loss: 0.859750, loss_ss: 0.837635, loss_d: 0.022115
0.3897 --- loss: 0.929009, loss_ss: 0.763132, loss_d: 0.165876
0.4677 --- loss: 1.306819, loss_ss: 1.281447, loss_d: 0.025372
0.5456 --- loss: 0.887005, loss_ss: 0.698887, loss_d: 0.188117
0.6235 --- loss: 0.816347, loss_ss: 0.796327, loss_d: 0.020020
0.7015 --- loss: 0.839019, loss_ss: 0.777840, loss_d: 0.061179
0.7794 --- loss: 1.582548, loss_ss: 0.804942, loss_d: 0.777606
0.8574 --- loss: 0.824544, loss_ss: 0.821964, loss_d: 0.002581
0.9353 --- loss: 1.203765, loss_ss: 0.946020, loss_d: 0.257744
Epoch finished! Loss: 0.9521181043237448
Starting epoch 10/10.
0.0000 --- loss: 0.682941, loss_ss: 0.638373, loss_d: 0.044568
0.0779 --- loss: 1.036486, loss_ss: 0.785019, loss_d: 0.251467
0.1559 --- loss: 1.042108, loss_ss: 0.832777, loss_d: 0.209331
0.2338 --- loss: 1.235327, loss_ss: 1.142756, loss_d: 0.092571
0.3118 --- loss: 0.793414, loss_ss: 0.731995, loss_d: 0.061419
0.3897 --- loss: 0.977176, loss_ss: 0.973277, loss_d: 0.003899
0.4677 --- loss: 0.836728, loss_ss: 0.832120, loss_d: 0.004608
0.5456 --- loss: 1.117044, loss_ss: 1.048339, loss_d: 0.068704
0.6235 --- loss: 0.709719, loss_ss: 0.696830, loss_d: 0.012889
0.7015 --- loss: 1.023852, loss_ss: 0.984799, loss_d: 0.039053
0.7794 --- loss: 0.923642, loss_ss: 0.920867, loss_d: 0.002775
0.8574 --- loss: 0.948867, loss_ss: 0.933274, loss_d: 0.015593
0.9353 --- loss: 0.914595, loss_ss: 0.913558, loss_d: 0.001037
Epoch finished! Loss: 0.9012164273299277
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7784313725490196
             precision    recall  f1-score   support

        0.0       0.93      0.72      0.81        74
        1.0       0.39      0.52      0.45        42
        2.0       0.79      0.84      0.82       515
        3.0       0.96      0.58      0.73       243
        4.0       0.68      0.99      0.80       146

avg / total       0.81      0.78      0.78      1020
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.55  71.62   99.58  92.98     80.92
1  94.71  52.38   96.52  39.29     44.90
2  80.88  84.08   77.62  79.30     81.62
3  89.51  58.44   99.23  95.95     72.63
4  93.04  98.63   92.11  67.61     80.22
Total accuracy: 77.84%
Average sen: 73.03%
Average spec: 93.01%
Macro f1-score: 72.06%
Diagnosis acc on 30mins: 0.0
[0.69086617 0.99415708 0.99958438 0.99998641 0.96316087 0.98852366
 0.99527353 0.9999845  0.9993636  0.99917835 0.99999392 0.99979275
 0.99987507 0.9968856  0.99991429 0.9967553  0.99981934]
pred: 0.9778302837820614, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc004-nsrr

=== Test on chc005-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.348454, loss_ss: 1.649460, loss_d: 0.698994
0.0778 --- loss: 2.265396, loss_ss: 1.659870, loss_d: 0.605525
0.1556 --- loss: 2.246191, loss_ss: 1.538933, loss_d: 0.707258
0.2335 --- loss: 1.999584, loss_ss: 1.562044, loss_d: 0.437540
0.3113 --- loss: 2.163999, loss_ss: 1.518428, loss_d: 0.645571
0.3891 --- loss: 2.273647, loss_ss: 1.537422, loss_d: 0.736225
0.4669 --- loss: 1.975016, loss_ss: 1.335916, loss_d: 0.639099
0.5447 --- loss: 1.881308, loss_ss: 1.326704, loss_d: 0.554604
0.6226 --- loss: 2.040259, loss_ss: 1.363744, loss_d: 0.676516
0.7004 --- loss: 2.107667, loss_ss: 1.508003, loss_d: 0.599663
0.7782 --- loss: 1.862944, loss_ss: 1.352645, loss_d: 0.510299
0.8560 --- loss: 1.764175, loss_ss: 1.360939, loss_d: 0.403236
0.9339 --- loss: 1.586614, loss_ss: 1.359271, loss_d: 0.227344
Epoch finished! Loss: 2.067220122553408
Starting epoch 2/10.
0.0000 --- loss: 1.915325, loss_ss: 1.365180, loss_d: 0.550145
0.0778 --- loss: 1.872562, loss_ss: 1.288276, loss_d: 0.584286
0.1556 --- loss: 2.139386, loss_ss: 1.290248, loss_d: 0.849138
0.2335 --- loss: 1.751759, loss_ss: 1.356699, loss_d: 0.395060
0.3113 --- loss: 1.861882, loss_ss: 1.376417, loss_d: 0.485466
0.3891 --- loss: 1.844487, loss_ss: 1.185455, loss_d: 0.659032
0.4669 --- loss: 1.598024, loss_ss: 1.240815, loss_d: 0.357209
0.5447 --- loss: 1.603483, loss_ss: 1.274189, loss_d: 0.329295
0.6226 --- loss: 1.784966, loss_ss: 1.273185, loss_d: 0.511781
0.7004 --- loss: 1.649465, loss_ss: 1.398184, loss_d: 0.251281
0.7782 --- loss: 1.867834, loss_ss: 1.287568, loss_d: 0.580266
0.8560 --- loss: 1.356016, loss_ss: 1.127125, loss_d: 0.228891
0.9339 --- loss: 1.350749, loss_ss: 1.188343, loss_d: 0.162406
Epoch finished! Loss: 1.7228146316483617
Starting epoch 3/10.
0.0000 --- loss: 1.635533, loss_ss: 1.235925, loss_d: 0.399608
0.0778 --- loss: 1.664297, loss_ss: 1.246585, loss_d: 0.417712
0.1556 --- loss: 1.375226, loss_ss: 1.155857, loss_d: 0.219369
0.2335 --- loss: 1.476206, loss_ss: 1.296364, loss_d: 0.179842
0.3113 --- loss: 1.249982, loss_ss: 1.051135, loss_d: 0.198847
0.3891 --- loss: 1.638864, loss_ss: 1.186188, loss_d: 0.452676
0.4669 --- loss: 1.251250, loss_ss: 1.137009, loss_d: 0.114242
0.5447 --- loss: 1.421245, loss_ss: 1.055976, loss_d: 0.365269
0.6226 --- loss: 1.369313, loss_ss: 1.130842, loss_d: 0.238471
0.7004 --- loss: 1.201095, loss_ss: 1.000044, loss_d: 0.201051
0.7782 --- loss: 0.955427, loss_ss: 0.890622, loss_d: 0.064805
0.8560 --- loss: 1.229020, loss_ss: 1.099177, loss_d: 0.129843
0.9339 --- loss: 1.447460, loss_ss: 1.185831, loss_d: 0.261629
Epoch finished! Loss: 1.4414201388135552
Starting epoch 4/10.
0.0000 --- loss: 1.169900, loss_ss: 1.060112, loss_d: 0.109789
0.0778 --- loss: 1.290786, loss_ss: 1.107603, loss_d: 0.183182
0.1556 --- loss: 1.013952, loss_ss: 0.988976, loss_d: 0.024976
0.2335 --- loss: 1.229928, loss_ss: 0.974376, loss_d: 0.255553
0.3113 --- loss: 1.252545, loss_ss: 1.088415, loss_d: 0.164130
0.3891 --- loss: 1.390297, loss_ss: 1.022876, loss_d: 0.367421
0.4669 --- loss: 1.097226, loss_ss: 0.998320, loss_d: 0.098906
0.5447 --- loss: 1.600943, loss_ss: 0.915030, loss_d: 0.685913
0.6226 --- loss: 1.254483, loss_ss: 1.105973, loss_d: 0.148511
0.7004 --- loss: 1.353692, loss_ss: 1.054790, loss_d: 0.298902
0.7782 --- loss: 1.262570, loss_ss: 1.038947, loss_d: 0.223623
0.8560 --- loss: 1.288387, loss_ss: 1.120607, loss_d: 0.167780
0.9339 --- loss: 1.236995, loss_ss: 1.024373, loss_d: 0.212622
Epoch finished! Loss: 1.3011254924349487
Starting epoch 5/10.
0.0000 --- loss: 1.214217, loss_ss: 1.175569, loss_d: 0.038648
0.0778 --- loss: 1.397366, loss_ss: 0.916796, loss_d: 0.480570
0.1556 --- loss: 1.252911, loss_ss: 1.149063, loss_d: 0.103848
0.2335 --- loss: 1.447182, loss_ss: 1.066818, loss_d: 0.380365
0.3113 --- loss: 1.226647, loss_ss: 1.118372, loss_d: 0.108275
0.3891 --- loss: 1.082567, loss_ss: 0.859875, loss_d: 0.222693
0.4669 --- loss: 1.352535, loss_ss: 1.187241, loss_d: 0.165294
0.5447 --- loss: 0.935936, loss_ss: 0.918410, loss_d: 0.017526
0.6226 --- loss: 1.158604, loss_ss: 1.067685, loss_d: 0.090919
0.7004 --- loss: 1.008958, loss_ss: 0.977690, loss_d: 0.031267
0.7782 --- loss: 1.177352, loss_ss: 0.933691, loss_d: 0.243661
0.8560 --- loss: 1.156392, loss_ss: 0.950084, loss_d: 0.206308
0.9339 --- loss: 1.377932, loss_ss: 0.908523, loss_d: 0.469408
Epoch finished! Loss: 1.1698336326517165
Starting epoch 6/10.
0.0000 --- loss: 1.135268, loss_ss: 1.051161, loss_d: 0.084107
0.0778 --- loss: 1.504334, loss_ss: 1.126322, loss_d: 0.378012
0.1556 --- loss: 0.987247, loss_ss: 0.934598, loss_d: 0.052649
0.2335 --- loss: 1.571183, loss_ss: 1.211188, loss_d: 0.359995
0.3113 --- loss: 1.114830, loss_ss: 0.886293, loss_d: 0.228536
0.3891 --- loss: 1.053080, loss_ss: 0.785705, loss_d: 0.267375
0.4669 --- loss: 1.131096, loss_ss: 1.028282, loss_d: 0.102814
0.5447 --- loss: 1.049002, loss_ss: 0.839602, loss_d: 0.209400
0.6226 --- loss: 1.166881, loss_ss: 0.932715, loss_d: 0.234166
0.7004 --- loss: 1.144702, loss_ss: 1.099054, loss_d: 0.045648
0.7782 --- loss: 0.896429, loss_ss: 0.861306, loss_d: 0.035123
0.8560 --- loss: 1.142453, loss_ss: 1.098060, loss_d: 0.044393
0.9339 --- loss: 0.787616, loss_ss: 0.733647, loss_d: 0.053969
Epoch finished! Loss: 1.1422800170257688
Starting epoch 7/10.
0.0000 --- loss: 1.055711, loss_ss: 0.814868, loss_d: 0.240842
0.0778 --- loss: 1.079643, loss_ss: 1.051725, loss_d: 0.027919
0.1556 --- loss: 0.881418, loss_ss: 0.866544, loss_d: 0.014873
0.2335 --- loss: 1.101788, loss_ss: 1.018549, loss_d: 0.083239
0.3113 --- loss: 1.126308, loss_ss: 0.863483, loss_d: 0.262825
0.3891 --- loss: 0.886623, loss_ss: 0.841520, loss_d: 0.045104
0.4669 --- loss: 0.850608, loss_ss: 0.783724, loss_d: 0.066883
0.5447 --- loss: 1.117126, loss_ss: 1.101744, loss_d: 0.015382
0.6226 --- loss: 0.973934, loss_ss: 0.873140, loss_d: 0.100794
0.7004 --- loss: 0.897496, loss_ss: 0.865457, loss_d: 0.032039
0.7782 --- loss: 1.163927, loss_ss: 0.778511, loss_d: 0.385417
0.8560 --- loss: 0.794565, loss_ss: 0.784363, loss_d: 0.010202
0.9339 --- loss: 1.081161, loss_ss: 1.051788, loss_d: 0.029372
Epoch finished! Loss: 1.0102985920384526
Starting epoch 8/10.
0.0000 --- loss: 0.807526, loss_ss: 0.791972, loss_d: 0.015553
0.0778 --- loss: 0.818893, loss_ss: 0.750116, loss_d: 0.068777
0.1556 --- loss: 1.166787, loss_ss: 0.988820, loss_d: 0.177967
0.2335 --- loss: 2.756685, loss_ss: 0.938139, loss_d: 1.818547
0.3113 --- loss: 1.113257, loss_ss: 1.097392, loss_d: 0.015865
0.3891 --- loss: 0.992945, loss_ss: 0.849422, loss_d: 0.143523
0.4669 --- loss: 0.856370, loss_ss: 0.774201, loss_d: 0.082169
0.5447 --- loss: 0.753185, loss_ss: 0.746469, loss_d: 0.006716
0.6226 --- loss: 0.896043, loss_ss: 0.775490, loss_d: 0.120553
0.7004 --- loss: 1.036526, loss_ss: 1.029312, loss_d: 0.007214
0.7782 --- loss: 1.216505, loss_ss: 1.211797, loss_d: 0.004708
0.8560 --- loss: 0.903805, loss_ss: 0.893254, loss_d: 0.010550
0.9339 --- loss: 1.399334, loss_ss: 0.841428, loss_d: 0.557906
Epoch finished! Loss: 0.9845910337753594
Starting epoch 9/10.
0.0000 --- loss: 0.826747, loss_ss: 0.759934, loss_d: 0.066813
0.0778 --- loss: 0.826102, loss_ss: 0.791295, loss_d: 0.034807
0.1556 --- loss: 1.263989, loss_ss: 0.785030, loss_d: 0.478959
0.2335 --- loss: 0.779673, loss_ss: 0.768201, loss_d: 0.011472
0.3113 --- loss: 1.264646, loss_ss: 1.190565, loss_d: 0.074081
0.3891 --- loss: 1.073607, loss_ss: 0.916799, loss_d: 0.156808
0.4669 --- loss: 0.845803, loss_ss: 0.828131, loss_d: 0.017672
0.5447 --- loss: 1.203371, loss_ss: 0.888395, loss_d: 0.314976
0.6226 --- loss: 0.893797, loss_ss: 0.884188, loss_d: 0.009609
0.7004 --- loss: 1.010614, loss_ss: 0.989894, loss_d: 0.020720
0.7782 --- loss: 0.738385, loss_ss: 0.665193, loss_d: 0.073192
0.8560 --- loss: 0.805414, loss_ss: 0.716132, loss_d: 0.089282
0.9339 --- loss: 0.693579, loss_ss: 0.666822, loss_d: 0.026757
Epoch finished! Loss: 0.9739386765286326
Starting epoch 10/10.
0.0000 --- loss: 0.762462, loss_ss: 0.748210, loss_d: 0.014252
0.0778 --- loss: 0.953616, loss_ss: 0.833354, loss_d: 0.120261
0.1556 --- loss: 0.747391, loss_ss: 0.745399, loss_d: 0.001992
0.2335 --- loss: 0.983269, loss_ss: 0.980429, loss_d: 0.002840
0.3113 --- loss: 0.967142, loss_ss: 0.920899, loss_d: 0.046243
0.3891 --- loss: 0.812298, loss_ss: 0.798151, loss_d: 0.014147
0.4669 --- loss: 0.979661, loss_ss: 0.976257, loss_d: 0.003403
0.5447 --- loss: 0.839255, loss_ss: 0.832138, loss_d: 0.007117
0.6226 --- loss: 0.927489, loss_ss: 0.920793, loss_d: 0.006696
0.7004 --- loss: 1.194450, loss_ss: 0.898502, loss_d: 0.295948
0.7782 --- loss: 0.729549, loss_ss: 0.666990, loss_d: 0.062558
0.8560 --- loss: 1.063017, loss_ss: 0.983524, loss_d: 0.079493
0.9339 --- loss: 1.057496, loss_ss: 0.918328, loss_d: 0.139168
Epoch finished! Loss: 0.9393268269486725
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8077777777777778
             precision    recall  f1-score   support

        0.0       0.63      0.97      0.76        40
        1.0       0.55      0.20      0.29        30
        2.0       0.85      0.84      0.85       504
        3.0       0.94      0.72      0.81       236
        4.0       0.59      0.98      0.74        90

avg / total       0.83      0.81      0.81       900
 


====== chc005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.33  97.50   97.33  62.90     76.47
1  96.78  20.00   99.43  54.55     29.27
2  82.89  84.33   81.06  85.00     84.66
3  91.44  71.61   98.49  94.41     81.45
4  93.11  97.78   92.59  59.46     73.95
Total accuracy: 80.78%
Average sen: 74.24%
Average spec: 93.78%
Macro f1-score: 69.16%
Diagnosis acc on 30mins: 0.8666666666666667
[0.00347672 0.01212743 0.20467448 0.14387172 0.00389657 0.00379086
 0.01749587 0.00557342 0.94813967 0.03028388 0.67845494 0.12253043
 0.01113109 0.00456039 0.03852141]
pred: 0.14856859169279535, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc005-nsrr

=== Test on chc006-nsrr. train_data(1287), test_data(13) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.348534, loss_ss: 1.624318, loss_d: 0.724215
0.0777 --- loss: 2.140249, loss_ss: 1.533999, loss_d: 0.606250
0.1554 --- loss: 1.878948, loss_ss: 1.490118, loss_d: 0.388830
0.2331 --- loss: 2.014399, loss_ss: 1.518148, loss_d: 0.496251
0.3108 --- loss: 1.877770, loss_ss: 1.440832, loss_d: 0.436938
0.3885 --- loss: 2.068069, loss_ss: 1.458113, loss_d: 0.609956
0.4662 --- loss: 1.955288, loss_ss: 1.379011, loss_d: 0.576278
0.5439 --- loss: 2.209600, loss_ss: 1.280524, loss_d: 0.929076
0.6216 --- loss: 1.718485, loss_ss: 1.185033, loss_d: 0.533452
0.6993 --- loss: 1.806279, loss_ss: 1.314363, loss_d: 0.491916
0.7770 --- loss: 1.928954, loss_ss: 1.242934, loss_d: 0.686020
0.8547 --- loss: 1.685361, loss_ss: 1.307954, loss_d: 0.377407
0.9324 --- loss: 1.685982, loss_ss: 1.219008, loss_d: 0.466973
Epoch finished! Loss: 1.9796294616535306
Starting epoch 2/10.
0.0000 --- loss: 1.853489, loss_ss: 1.235366, loss_d: 0.618123
0.0777 --- loss: 1.788906, loss_ss: 1.231275, loss_d: 0.557631
0.1554 --- loss: 1.566682, loss_ss: 1.075509, loss_d: 0.491173
0.2331 --- loss: 1.454301, loss_ss: 1.040441, loss_d: 0.413860
0.3108 --- loss: 1.888873, loss_ss: 1.352999, loss_d: 0.535874
0.3885 --- loss: 1.395404, loss_ss: 1.066256, loss_d: 0.329148
0.4662 --- loss: 1.645516, loss_ss: 1.223468, loss_d: 0.422049
0.5439 --- loss: 1.516959, loss_ss: 1.162215, loss_d: 0.354744
0.6216 --- loss: 1.551935, loss_ss: 1.249311, loss_d: 0.302623
0.6993 --- loss: 1.794141, loss_ss: 1.169636, loss_d: 0.624506
0.7770 --- loss: 1.389683, loss_ss: 1.102483, loss_d: 0.287200
0.8547 --- loss: 1.849049, loss_ss: 1.308411, loss_d: 0.540638
0.9324 --- loss: 1.481352, loss_ss: 1.119853, loss_d: 0.361499
Epoch finished! Loss: 1.6522365072742105
Starting epoch 3/10.
0.0000 --- loss: 2.033251, loss_ss: 0.993439, loss_d: 1.039812
0.0777 --- loss: 1.587437, loss_ss: 1.220522, loss_d: 0.366914
0.1554 --- loss: 1.517918, loss_ss: 1.280938, loss_d: 0.236981
0.2331 --- loss: 1.806517, loss_ss: 1.373917, loss_d: 0.432599
0.3108 --- loss: 2.092107, loss_ss: 1.079508, loss_d: 1.012598
0.3885 --- loss: 1.199242, loss_ss: 1.009949, loss_d: 0.189292
0.4662 --- loss: 1.460871, loss_ss: 1.149326, loss_d: 0.311545
0.5439 --- loss: 1.416175, loss_ss: 1.059455, loss_d: 0.356720
0.6216 --- loss: 1.457882, loss_ss: 1.086846, loss_d: 0.371036
0.6993 --- loss: 1.732704, loss_ss: 1.424929, loss_d: 0.307776
0.7770 --- loss: 1.460895, loss_ss: 1.154377, loss_d: 0.306518
0.8547 --- loss: 1.589356, loss_ss: 1.378114, loss_d: 0.211242
0.9324 --- loss: 1.686195, loss_ss: 1.214820, loss_d: 0.471376
Epoch finished! Loss: 1.4798435280099511
Starting epoch 4/10.
0.0000 --- loss: 1.574552, loss_ss: 1.293049, loss_d: 0.281503
0.0777 --- loss: 1.304673, loss_ss: 1.149439, loss_d: 0.155234
0.1554 --- loss: 1.132510, loss_ss: 1.030826, loss_d: 0.101684
0.2331 --- loss: 1.614373, loss_ss: 1.012156, loss_d: 0.602217
0.3108 --- loss: 1.210577, loss_ss: 0.882547, loss_d: 0.328030
0.3885 --- loss: 1.251481, loss_ss: 0.922322, loss_d: 0.329159
0.4662 --- loss: 1.241391, loss_ss: 1.068233, loss_d: 0.173158
0.5439 --- loss: 1.263453, loss_ss: 0.973066, loss_d: 0.290387
0.6216 --- loss: 1.167222, loss_ss: 0.972558, loss_d: 0.194664
0.6993 --- loss: 1.042126, loss_ss: 0.965049, loss_d: 0.077077
0.7770 --- loss: 1.136920, loss_ss: 0.915923, loss_d: 0.220998
0.8547 --- loss: 1.597108, loss_ss: 1.096252, loss_d: 0.500856
0.9324 --- loss: 2.007944, loss_ss: 1.043833, loss_d: 0.964112
Epoch finished! Loss: 1.3267826582305133
Starting epoch 5/10.
0.0000 --- loss: 1.047672, loss_ss: 0.955757, loss_d: 0.091915
0.0777 --- loss: 1.148244, loss_ss: 0.896255, loss_d: 0.251988
0.1554 --- loss: 0.989982, loss_ss: 0.927027, loss_d: 0.062954
0.2331 --- loss: 1.083686, loss_ss: 0.914951, loss_d: 0.168735
0.3108 --- loss: 1.462461, loss_ss: 1.051362, loss_d: 0.411100
0.3885 --- loss: 1.218954, loss_ss: 1.052178, loss_d: 0.166775
0.4662 --- loss: 1.033877, loss_ss: 0.900115, loss_d: 0.133763
0.5439 --- loss: 1.106292, loss_ss: 1.079415, loss_d: 0.026877
0.6216 --- loss: 1.099416, loss_ss: 0.980120, loss_d: 0.119297
0.6993 --- loss: 0.924869, loss_ss: 0.872136, loss_d: 0.052733
0.7770 --- loss: 1.067630, loss_ss: 0.870264, loss_d: 0.197366
0.8547 --- loss: 1.076459, loss_ss: 1.002442, loss_d: 0.074017
0.9324 --- loss: 1.228642, loss_ss: 1.142083, loss_d: 0.086559
Epoch finished! Loss: 1.211147116497159
Starting epoch 6/10.
0.0000 --- loss: 1.018513, loss_ss: 0.984472, loss_d: 0.034041
0.0777 --- loss: 0.802070, loss_ss: 0.769233, loss_d: 0.032837
0.1554 --- loss: 1.142785, loss_ss: 1.088231, loss_d: 0.054555
0.2331 --- loss: 1.234662, loss_ss: 1.095893, loss_d: 0.138769
0.3108 --- loss: 1.019793, loss_ss: 0.962329, loss_d: 0.057464
0.3885 --- loss: 0.884343, loss_ss: 0.839117, loss_d: 0.045226
0.4662 --- loss: 1.223773, loss_ss: 0.965271, loss_d: 0.258502
0.5439 --- loss: 1.129622, loss_ss: 1.071196, loss_d: 0.058426
0.6216 --- loss: 0.995884, loss_ss: 0.858277, loss_d: 0.137607
0.6993 --- loss: 1.094930, loss_ss: 0.919732, loss_d: 0.175197
0.7770 --- loss: 1.514305, loss_ss: 1.462861, loss_d: 0.051444
0.8547 --- loss: 1.045901, loss_ss: 1.038126, loss_d: 0.007775
0.9324 --- loss: 1.393949, loss_ss: 1.224577, loss_d: 0.169372
Epoch finished! Loss: 1.1514594992622733
Starting epoch 7/10.
0.0000 --- loss: 0.998598, loss_ss: 0.845855, loss_d: 0.152743
0.0777 --- loss: 0.930099, loss_ss: 0.874219, loss_d: 0.055881
0.1554 --- loss: 0.949911, loss_ss: 0.945997, loss_d: 0.003914
0.2331 --- loss: 1.607657, loss_ss: 0.842767, loss_d: 0.764891
0.3108 --- loss: 1.156388, loss_ss: 1.120771, loss_d: 0.035617
0.3885 --- loss: 1.372151, loss_ss: 1.008283, loss_d: 0.363868
0.4662 --- loss: 1.839113, loss_ss: 1.177528, loss_d: 0.661585
0.5439 --- loss: 1.026988, loss_ss: 0.746409, loss_d: 0.280579
0.6216 --- loss: 1.009187, loss_ss: 0.914719, loss_d: 0.094468
0.6993 --- loss: 1.173984, loss_ss: 1.161024, loss_d: 0.012959
0.7770 --- loss: 1.058802, loss_ss: 0.907829, loss_d: 0.150973
0.8547 --- loss: 0.871648, loss_ss: 0.844367, loss_d: 0.027281
0.9324 --- loss: 1.263993, loss_ss: 1.223123, loss_d: 0.040870
Epoch finished! Loss: 1.1171688018366694
Starting epoch 8/10.
0.0000 --- loss: 1.031239, loss_ss: 1.009106, loss_d: 0.022133
0.0777 --- loss: 1.130607, loss_ss: 1.110210, loss_d: 0.020396
0.1554 --- loss: 0.890116, loss_ss: 0.886719, loss_d: 0.003397
0.2331 --- loss: 0.858738, loss_ss: 0.845476, loss_d: 0.013262
0.3108 --- loss: 1.523863, loss_ss: 1.198820, loss_d: 0.325043
0.3885 --- loss: 1.011070, loss_ss: 1.005705, loss_d: 0.005365
0.4662 --- loss: 0.801681, loss_ss: 0.736132, loss_d: 0.065549
0.5439 --- loss: 0.908879, loss_ss: 0.891808, loss_d: 0.017071
0.6216 --- loss: 1.246556, loss_ss: 0.836411, loss_d: 0.410144
0.6993 --- loss: 1.106637, loss_ss: 0.977322, loss_d: 0.129315
0.7770 --- loss: 1.108794, loss_ss: 1.085563, loss_d: 0.023231
0.8547 --- loss: 1.346798, loss_ss: 1.003052, loss_d: 0.343746
0.9324 --- loss: 0.861812, loss_ss: 0.845699, loss_d: 0.016113
Epoch finished! Loss: 1.052798209246248
Starting epoch 9/10.
0.0000 --- loss: 0.966621, loss_ss: 0.949769, loss_d: 0.016853
0.0777 --- loss: 0.928192, loss_ss: 0.910850, loss_d: 0.017342
0.1554 --- loss: 1.323918, loss_ss: 0.882612, loss_d: 0.441306
0.2331 --- loss: 1.143533, loss_ss: 0.811328, loss_d: 0.332204
0.3108 --- loss: 0.824000, loss_ss: 0.809817, loss_d: 0.014183
0.3885 --- loss: 1.137331, loss_ss: 1.110867, loss_d: 0.026463
0.4662 --- loss: 1.089627, loss_ss: 1.082193, loss_d: 0.007434
0.5439 --- loss: 1.430543, loss_ss: 1.296886, loss_d: 0.133657
0.6216 --- loss: 0.947729, loss_ss: 0.945307, loss_d: 0.002422
0.6993 --- loss: 0.856306, loss_ss: 0.829786, loss_d: 0.026520
0.7770 --- loss: 0.950021, loss_ss: 0.735234, loss_d: 0.214787
0.8547 --- loss: 1.580761, loss_ss: 0.969476, loss_d: 0.611284
0.9324 --- loss: 1.360152, loss_ss: 0.889324, loss_d: 0.470828
Epoch finished! Loss: 1.028832932934165
Starting epoch 10/10.
0.0000 --- loss: 0.946568, loss_ss: 0.834879, loss_d: 0.111689
0.0777 --- loss: 1.000606, loss_ss: 0.989646, loss_d: 0.010960
0.1554 --- loss: 1.005447, loss_ss: 0.989859, loss_d: 0.015588
0.2331 --- loss: 1.210478, loss_ss: 1.087681, loss_d: 0.122797
0.3108 --- loss: 0.875231, loss_ss: 0.862411, loss_d: 0.012819
0.3885 --- loss: 0.969458, loss_ss: 0.958174, loss_d: 0.011284
0.4662 --- loss: 0.909595, loss_ss: 0.877592, loss_d: 0.032003
0.5439 --- loss: 1.074450, loss_ss: 1.071506, loss_d: 0.002944
0.6216 --- loss: 0.787904, loss_ss: 0.770012, loss_d: 0.017893
0.6993 --- loss: 1.776051, loss_ss: 1.447467, loss_d: 0.328584
0.7770 --- loss: 0.913800, loss_ss: 0.897807, loss_d: 0.015993
0.8547 --- loss: 0.805703, loss_ss: 0.764718, loss_d: 0.040985
0.9324 --- loss: 0.982927, loss_ss: 0.948370, loss_d: 0.034557
Epoch finished! Loss: 1.006171994842589
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6692307692307692
             precision    recall  f1-score   support

        0.0       0.95      0.46      0.62       128
        1.0       0.00      0.00      0.00       103
        2.0       0.59      0.99      0.74       306
        3.0       0.99      0.53      0.69       133
        4.0       0.69      0.83      0.75       110

avg / total       0.65      0.67      0.61       780
 


====== chc006-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  90.77  46.09   99.54  95.16     62.11
1  86.79   0.00  100.00   0.00      0.00
2  72.18  98.69   55.06  58.64     73.57
3  91.79  52.63   99.85  98.59     68.63
4  92.31  82.73   93.88  68.94     75.21
Total accuracy: 66.92%
Average sen: 56.03%
Average spec: 89.67%
Macro f1-score: 55.90%
Diagnosis acc on 30mins: 0.0
[0.99988747 0.99905223 0.99981064 0.99991047 0.99966776 0.99532205
 0.99098879 0.9999367  0.99969864 0.99984622 0.99983013 0.99992156
 0.98950154]
pred: 0.9979518606112554, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc006-nsrr

=== Test on chc008-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.496991, loss_ss: 1.755724, loss_d: 0.741267
0.0779 --- loss: 2.357311, loss_ss: 1.725551, loss_d: 0.631760
0.1558 --- loss: 2.357811, loss_ss: 1.567173, loss_d: 0.790638
0.2336 --- loss: 1.936671, loss_ss: 1.441472, loss_d: 0.495199
0.3115 --- loss: 1.969685, loss_ss: 1.566064, loss_d: 0.403620
0.3894 --- loss: 2.038276, loss_ss: 1.533242, loss_d: 0.505034
0.4673 --- loss: 2.439293, loss_ss: 1.612350, loss_d: 0.826943
0.5452 --- loss: 2.365355, loss_ss: 1.617021, loss_d: 0.748333
0.6231 --- loss: 2.007496, loss_ss: 1.473178, loss_d: 0.534317
0.7009 --- loss: 1.883557, loss_ss: 1.426155, loss_d: 0.457402
0.7788 --- loss: 1.897166, loss_ss: 1.411784, loss_d: 0.485382
0.8567 --- loss: 2.071938, loss_ss: 1.396814, loss_d: 0.675124
0.9346 --- loss: 2.048007, loss_ss: 1.333105, loss_d: 0.714902
Epoch finished! Loss: 2.111739069223404
Starting epoch 2/10.
0.0000 --- loss: 1.934020, loss_ss: 1.356200, loss_d: 0.577820
0.0779 --- loss: 1.718380, loss_ss: 1.277271, loss_d: 0.441109
0.1558 --- loss: 1.726911, loss_ss: 1.296460, loss_d: 0.430451
0.2336 --- loss: 1.542504, loss_ss: 1.342273, loss_d: 0.200231
0.3115 --- loss: 1.764058, loss_ss: 1.324805, loss_d: 0.439253
0.3894 --- loss: 1.559549, loss_ss: 1.277768, loss_d: 0.281781
0.4673 --- loss: 1.781592, loss_ss: 1.260619, loss_d: 0.520973
0.5452 --- loss: 1.583308, loss_ss: 1.256254, loss_d: 0.327054
0.6231 --- loss: 1.632479, loss_ss: 1.254463, loss_d: 0.378016
0.7009 --- loss: 1.769692, loss_ss: 1.385028, loss_d: 0.384664
0.7788 --- loss: 1.637982, loss_ss: 1.317618, loss_d: 0.320364
0.8567 --- loss: 1.641035, loss_ss: 1.395669, loss_d: 0.245366
0.9346 --- loss: 1.611191, loss_ss: 1.320640, loss_d: 0.290551
Epoch finished! Loss: 1.8200458930805326
Starting epoch 3/10.
0.0000 --- loss: 1.352014, loss_ss: 1.130084, loss_d: 0.221930
0.0779 --- loss: 2.397898, loss_ss: 1.262779, loss_d: 1.135119
0.1558 --- loss: 1.818395, loss_ss: 1.164063, loss_d: 0.654332
0.2336 --- loss: 2.070787, loss_ss: 1.322738, loss_d: 0.748050
0.3115 --- loss: 1.502153, loss_ss: 1.377447, loss_d: 0.124706
0.3894 --- loss: 1.482188, loss_ss: 1.302504, loss_d: 0.179684
0.4673 --- loss: 1.381880, loss_ss: 1.063947, loss_d: 0.317933
0.5452 --- loss: 1.380109, loss_ss: 1.241992, loss_d: 0.138117
0.6231 --- loss: 1.450449, loss_ss: 1.201836, loss_d: 0.248613
0.7009 --- loss: 1.289674, loss_ss: 1.179249, loss_d: 0.110425
0.7788 --- loss: 1.402986, loss_ss: 1.152136, loss_d: 0.250851
0.8567 --- loss: 1.328895, loss_ss: 1.182365, loss_d: 0.146530
0.9346 --- loss: 1.742245, loss_ss: 1.042287, loss_d: 0.699958
Epoch finished! Loss: 1.578343297354877
Starting epoch 4/10.
0.0000 --- loss: 1.489792, loss_ss: 1.279815, loss_d: 0.209977
0.0779 --- loss: 1.436675, loss_ss: 1.182569, loss_d: 0.254106
0.1558 --- loss: 1.278549, loss_ss: 1.135521, loss_d: 0.143028
0.2336 --- loss: 1.849772, loss_ss: 1.178704, loss_d: 0.671068
0.3115 --- loss: 1.466174, loss_ss: 1.067541, loss_d: 0.398633
0.3894 --- loss: 1.364629, loss_ss: 1.006166, loss_d: 0.358463
0.4673 --- loss: 2.089986, loss_ss: 0.952425, loss_d: 1.137561
0.5452 --- loss: 1.211200, loss_ss: 0.935775, loss_d: 0.275425
0.6231 --- loss: 1.636367, loss_ss: 1.074929, loss_d: 0.561438
0.7009 --- loss: 1.275177, loss_ss: 1.110501, loss_d: 0.164676
0.7788 --- loss: 1.516094, loss_ss: 1.275265, loss_d: 0.240830
0.8567 --- loss: 1.259996, loss_ss: 1.029655, loss_d: 0.230341
0.9346 --- loss: 1.378149, loss_ss: 1.186355, loss_d: 0.191795
Epoch finished! Loss: 1.3887223489582539
Starting epoch 5/10.
0.0000 --- loss: 1.111523, loss_ss: 1.016456, loss_d: 0.095066
0.0779 --- loss: 1.149943, loss_ss: 1.031868, loss_d: 0.118075
0.1558 --- loss: 1.459979, loss_ss: 1.113119, loss_d: 0.346860
0.2336 --- loss: 1.234308, loss_ss: 1.001388, loss_d: 0.232920
0.3115 --- loss: 1.439951, loss_ss: 1.047989, loss_d: 0.391962
0.3894 --- loss: 1.265299, loss_ss: 1.111791, loss_d: 0.153508
0.4673 --- loss: 1.278836, loss_ss: 1.160957, loss_d: 0.117879
0.5452 --- loss: 1.405729, loss_ss: 1.126039, loss_d: 0.279689
0.6231 --- loss: 1.174624, loss_ss: 1.110755, loss_d: 0.063870
0.7009 --- loss: 1.384216, loss_ss: 1.150364, loss_d: 0.233852
0.7788 --- loss: 1.506787, loss_ss: 1.434009, loss_d: 0.072778
0.8567 --- loss: 1.088513, loss_ss: 0.993500, loss_d: 0.095013
0.9346 --- loss: 1.013956, loss_ss: 0.916883, loss_d: 0.097073
Epoch finished! Loss: 1.2980548827908933
Starting epoch 6/10.
0.0000 --- loss: 1.272525, loss_ss: 1.213822, loss_d: 0.058703
0.0779 --- loss: 1.387687, loss_ss: 1.178456, loss_d: 0.209230
0.1558 --- loss: 1.216630, loss_ss: 0.891912, loss_d: 0.324718
0.2336 --- loss: 1.105339, loss_ss: 0.975281, loss_d: 0.130058
0.3115 --- loss: 1.271405, loss_ss: 1.112722, loss_d: 0.158682
0.3894 --- loss: 1.162847, loss_ss: 0.985979, loss_d: 0.176868
0.4673 --- loss: 1.206276, loss_ss: 1.013542, loss_d: 0.192734
0.5452 --- loss: 0.989893, loss_ss: 0.971136, loss_d: 0.018757
0.6231 --- loss: 1.015528, loss_ss: 0.971332, loss_d: 0.044196
0.7009 --- loss: 0.959512, loss_ss: 0.871955, loss_d: 0.087557
0.7788 --- loss: 0.954175, loss_ss: 0.871838, loss_d: 0.082337
0.8567 --- loss: 1.142473, loss_ss: 0.933553, loss_d: 0.208920
0.9346 --- loss: 1.071278, loss_ss: 0.895418, loss_d: 0.175860
Epoch finished! Loss: 1.1798373004421592
Starting epoch 7/10.
0.0000 --- loss: 1.314579, loss_ss: 1.086504, loss_d: 0.228074
0.0779 --- loss: 1.024666, loss_ss: 0.942734, loss_d: 0.081932
0.1558 --- loss: 0.992054, loss_ss: 0.965986, loss_d: 0.026068
0.2336 --- loss: 1.142366, loss_ss: 1.128052, loss_d: 0.014314
0.3115 --- loss: 1.122494, loss_ss: 1.052627, loss_d: 0.069867
0.3894 --- loss: 1.592714, loss_ss: 1.080924, loss_d: 0.511790
0.4673 --- loss: 1.060350, loss_ss: 0.943175, loss_d: 0.117175
0.5452 --- loss: 0.990932, loss_ss: 0.915770, loss_d: 0.075162
0.6231 --- loss: 1.285181, loss_ss: 1.019810, loss_d: 0.265371
0.7009 --- loss: 0.842687, loss_ss: 0.785516, loss_d: 0.057171
0.7788 --- loss: 1.326711, loss_ss: 1.146317, loss_d: 0.180394
0.8567 --- loss: 0.990754, loss_ss: 0.894348, loss_d: 0.096406
0.9346 --- loss: 0.929069, loss_ss: 0.796084, loss_d: 0.132986
Epoch finished! Loss: 1.1322888750582933
Starting epoch 8/10.
0.0000 --- loss: 1.245788, loss_ss: 1.147613, loss_d: 0.098175
0.0779 --- loss: 1.070351, loss_ss: 0.956992, loss_d: 0.113359
0.1558 --- loss: 1.142031, loss_ss: 1.050884, loss_d: 0.091147
0.2336 --- loss: 1.039420, loss_ss: 1.037095, loss_d: 0.002325
0.3115 --- loss: 1.527020, loss_ss: 1.511991, loss_d: 0.015030
0.3894 --- loss: 1.048611, loss_ss: 0.926083, loss_d: 0.122528
0.4673 --- loss: 0.926721, loss_ss: 0.913452, loss_d: 0.013269
0.5452 --- loss: 0.921454, loss_ss: 0.903372, loss_d: 0.018082
0.6231 --- loss: 1.427861, loss_ss: 0.962733, loss_d: 0.465128
0.7009 --- loss: 1.007520, loss_ss: 0.875675, loss_d: 0.131845
0.7788 --- loss: 0.990273, loss_ss: 0.883940, loss_d: 0.106333
0.8567 --- loss: 2.744084, loss_ss: 0.772355, loss_d: 1.971729
0.9346 --- loss: 0.985040, loss_ss: 0.981515, loss_d: 0.003525
Epoch finished! Loss: 1.0922947498038411
Starting epoch 9/10.
0.0000 --- loss: 1.116954, loss_ss: 1.092980, loss_d: 0.023974
0.0779 --- loss: 0.914988, loss_ss: 0.906033, loss_d: 0.008956
0.1558 --- loss: 1.294810, loss_ss: 1.115387, loss_d: 0.179424
0.2336 --- loss: 0.924423, loss_ss: 0.905720, loss_d: 0.018702
0.3115 --- loss: 1.171710, loss_ss: 0.880816, loss_d: 0.290894
0.3894 --- loss: 1.178734, loss_ss: 1.044134, loss_d: 0.134601
0.4673 --- loss: 0.948282, loss_ss: 0.938305, loss_d: 0.009977
0.5452 --- loss: 1.035104, loss_ss: 1.020945, loss_d: 0.014159
0.6231 --- loss: 1.025283, loss_ss: 0.800368, loss_d: 0.224916
0.7009 --- loss: 1.117810, loss_ss: 1.096082, loss_d: 0.021728
0.7788 --- loss: 0.775638, loss_ss: 0.768591, loss_d: 0.007047
0.8567 --- loss: 0.938405, loss_ss: 0.909123, loss_d: 0.029282
0.9346 --- loss: 0.950244, loss_ss: 0.825576, loss_d: 0.124668
Epoch finished! Loss: 1.0291666369885206
Starting epoch 10/10.
0.0000 --- loss: 0.942203, loss_ss: 0.835304, loss_d: 0.106899
0.0779 --- loss: 0.942870, loss_ss: 0.940394, loss_d: 0.002475
0.1558 --- loss: 0.757650, loss_ss: 0.752052, loss_d: 0.005598
0.2336 --- loss: 0.767776, loss_ss: 0.764164, loss_d: 0.003612
0.3115 --- loss: 0.864825, loss_ss: 0.840570, loss_d: 0.024255
0.3894 --- loss: 0.958814, loss_ss: 0.954291, loss_d: 0.004523
0.4673 --- loss: 0.916319, loss_ss: 0.908019, loss_d: 0.008300
0.5452 --- loss: 0.988192, loss_ss: 0.909789, loss_d: 0.078403
0.6231 --- loss: 0.811152, loss_ss: 0.808958, loss_d: 0.002194
0.7009 --- loss: 0.839512, loss_ss: 0.805039, loss_d: 0.034473
0.7788 --- loss: 1.003010, loss_ss: 0.885221, loss_d: 0.117789
0.8567 --- loss: 0.904476, loss_ss: 0.870211, loss_d: 0.034264
0.9346 --- loss: 0.994976, loss_ss: 0.985542, loss_d: 0.009434
Epoch finished! Loss: 1.0004929876886308
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6760416666666667
             precision    recall  f1-score   support

        0.0       0.86      0.85      0.85       144
        1.0       0.00      0.00      0.00        82
        2.0       0.64      0.82      0.72       379
        3.0       1.00      0.46      0.63       227
        4.0       0.49      0.89      0.64       128

avg / total       0.68      0.68      0.64       960
 


====== chc008-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  95.62  84.72   97.55   85.92     85.31
1  91.46   0.00  100.00    0.00      0.00
2  74.58  81.53   70.05   63.98     71.69
3  87.19  45.81  100.00  100.00     62.84
4  86.35  89.06   85.94   49.35     63.51
Total accuracy: 67.60%
Average sen: 60.23%
Average spec: 90.71%
Macro f1-score: 56.67%
Diagnosis acc on 30mins: 0.5
[0.9999913  0.99991858 0.37991813 0.32138526 0.166732   0.98452616
 0.84994823 0.99542445 0.83721924 0.67922819 0.10829424 0.49400121
 0.40585783 0.01616272 0.79976463 0.00719061]
pred: 0.5653476731677074, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc008-nsrr

=== Test on chc009-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.379267, loss_ss: 1.678667, loss_d: 0.700600
0.0778 --- loss: 2.064500, loss_ss: 1.506471, loss_d: 0.558028
0.1555 --- loss: 2.153785, loss_ss: 1.504835, loss_d: 0.648951
0.2333 --- loss: 1.801919, loss_ss: 1.449635, loss_d: 0.352284
0.3110 --- loss: 1.969101, loss_ss: 1.478680, loss_d: 0.490422
0.3888 --- loss: 2.165109, loss_ss: 1.367015, loss_d: 0.798093
0.4666 --- loss: 1.932246, loss_ss: 1.465797, loss_d: 0.466449
0.5443 --- loss: 1.887968, loss_ss: 1.366253, loss_d: 0.521715
0.6221 --- loss: 1.899688, loss_ss: 1.319939, loss_d: 0.579748
0.6998 --- loss: 1.969053, loss_ss: 1.394203, loss_d: 0.574850
0.7776 --- loss: 1.706013, loss_ss: 1.249923, loss_d: 0.456090
0.8554 --- loss: 1.997501, loss_ss: 1.284819, loss_d: 0.712682
0.9331 --- loss: 1.632920, loss_ss: 1.277190, loss_d: 0.355730
Epoch finished! Loss: 2.000361118465662
Starting epoch 2/10.
0.0000 --- loss: 1.840572, loss_ss: 1.262925, loss_d: 0.577648
0.0778 --- loss: 1.665109, loss_ss: 1.370138, loss_d: 0.294971
0.1555 --- loss: 1.826879, loss_ss: 1.201043, loss_d: 0.625836
0.2333 --- loss: 1.420243, loss_ss: 1.168184, loss_d: 0.252058
0.3110 --- loss: 1.629761, loss_ss: 1.210013, loss_d: 0.419749
0.3888 --- loss: 1.692759, loss_ss: 1.153527, loss_d: 0.539232
0.4666 --- loss: 1.957093, loss_ss: 1.197337, loss_d: 0.759756
0.5443 --- loss: 1.768548, loss_ss: 1.214461, loss_d: 0.554087
0.6221 --- loss: 1.528649, loss_ss: 1.097917, loss_d: 0.430732
0.6998 --- loss: 1.271297, loss_ss: 1.082074, loss_d: 0.189223
0.7776 --- loss: 1.317572, loss_ss: 1.070613, loss_d: 0.246959
0.8554 --- loss: 1.473689, loss_ss: 1.259586, loss_d: 0.214103
0.9331 --- loss: 1.697459, loss_ss: 1.157805, loss_d: 0.539654
Epoch finished! Loss: 1.6580634051933885
Starting epoch 3/10.
0.0000 --- loss: 1.357596, loss_ss: 1.053394, loss_d: 0.304201
0.0778 --- loss: 1.523148, loss_ss: 1.036981, loss_d: 0.486167
0.1555 --- loss: 1.539154, loss_ss: 1.055532, loss_d: 0.483622
0.2333 --- loss: 1.313644, loss_ss: 0.966263, loss_d: 0.347380
0.3110 --- loss: 1.814421, loss_ss: 1.064689, loss_d: 0.749733
0.3888 --- loss: 1.456768, loss_ss: 0.906524, loss_d: 0.550243
0.4666 --- loss: 1.493280, loss_ss: 1.008909, loss_d: 0.484371
0.5443 --- loss: 1.141961, loss_ss: 0.915702, loss_d: 0.226259
0.6221 --- loss: 1.007949, loss_ss: 0.936062, loss_d: 0.071887
0.6998 --- loss: 1.456763, loss_ss: 0.980032, loss_d: 0.476730
0.7776 --- loss: 1.298865, loss_ss: 1.118110, loss_d: 0.180755
0.8554 --- loss: 1.751854, loss_ss: 1.263484, loss_d: 0.488371
0.9331 --- loss: 1.262428, loss_ss: 0.947771, loss_d: 0.314656
Epoch finished! Loss: 1.3762242076918483
Starting epoch 4/10.
0.0000 --- loss: 1.369937, loss_ss: 1.006819, loss_d: 0.363118
0.0778 --- loss: 1.170933, loss_ss: 0.996521, loss_d: 0.174413
0.1555 --- loss: 1.354666, loss_ss: 0.950385, loss_d: 0.404281
0.2333 --- loss: 1.185684, loss_ss: 0.984098, loss_d: 0.201586
0.3110 --- loss: 1.019664, loss_ss: 0.877014, loss_d: 0.142650
0.3888 --- loss: 1.154392, loss_ss: 1.043509, loss_d: 0.110883
0.4666 --- loss: 1.165039, loss_ss: 0.892061, loss_d: 0.272978
0.5443 --- loss: 1.346102, loss_ss: 0.950173, loss_d: 0.395929
0.6221 --- loss: 1.247347, loss_ss: 1.094043, loss_d: 0.153304
0.6998 --- loss: 0.966579, loss_ss: 0.819843, loss_d: 0.146736
0.7776 --- loss: 2.096243, loss_ss: 1.752469, loss_d: 0.343774
0.8554 --- loss: 0.992155, loss_ss: 0.879666, loss_d: 0.112489
0.9331 --- loss: 1.006423, loss_ss: 0.816052, loss_d: 0.190371
Epoch finished! Loss: 1.2392097087576985
Starting epoch 5/10.
0.0000 --- loss: 1.094310, loss_ss: 0.916243, loss_d: 0.178067
0.0778 --- loss: 1.074105, loss_ss: 0.950478, loss_d: 0.123627
0.1555 --- loss: 0.962706, loss_ss: 0.873685, loss_d: 0.089021
0.2333 --- loss: 1.024642, loss_ss: 0.966499, loss_d: 0.058143
0.3110 --- loss: 1.215260, loss_ss: 0.803659, loss_d: 0.411601
0.3888 --- loss: 0.876618, loss_ss: 0.848517, loss_d: 0.028101
0.4666 --- loss: 1.559587, loss_ss: 1.125135, loss_d: 0.434452
0.5443 --- loss: 1.037322, loss_ss: 1.004238, loss_d: 0.033084
0.6221 --- loss: 1.087284, loss_ss: 0.823727, loss_d: 0.263557
0.6998 --- loss: 1.206223, loss_ss: 0.921899, loss_d: 0.284324
0.7776 --- loss: 1.237491, loss_ss: 1.077674, loss_d: 0.159817
0.8554 --- loss: 1.157346, loss_ss: 0.827027, loss_d: 0.330319
0.9331 --- loss: 0.969682, loss_ss: 0.885156, loss_d: 0.084526
Epoch finished! Loss: 1.1106927315704525
Starting epoch 6/10.
0.0000 --- loss: 1.030174, loss_ss: 0.838991, loss_d: 0.191183
0.0778 --- loss: 1.041600, loss_ss: 0.913840, loss_d: 0.127760
0.1555 --- loss: 0.921395, loss_ss: 0.904879, loss_d: 0.016516
0.2333 --- loss: 1.170299, loss_ss: 1.005866, loss_d: 0.164433
0.3110 --- loss: 1.065908, loss_ss: 1.002450, loss_d: 0.063459
0.3888 --- loss: 0.772412, loss_ss: 0.742321, loss_d: 0.030091
0.4666 --- loss: 0.876543, loss_ss: 0.852688, loss_d: 0.023855
0.5443 --- loss: 1.273804, loss_ss: 1.244328, loss_d: 0.029476
0.6221 --- loss: 0.953509, loss_ss: 0.879549, loss_d: 0.073960
0.6998 --- loss: 1.008400, loss_ss: 0.767019, loss_d: 0.241381
0.7776 --- loss: 0.993836, loss_ss: 0.875435, loss_d: 0.118401
0.8554 --- loss: 0.972359, loss_ss: 0.940410, loss_d: 0.031949
0.9331 --- loss: 1.016103, loss_ss: 1.009271, loss_d: 0.006832
Epoch finished! Loss: 1.0358770079910755
Starting epoch 7/10.
0.0000 --- loss: 1.333090, loss_ss: 0.778905, loss_d: 0.554185
0.0778 --- loss: 0.971027, loss_ss: 0.766631, loss_d: 0.204396
0.1555 --- loss: 1.374941, loss_ss: 1.036971, loss_d: 0.337970
0.2333 --- loss: 0.744304, loss_ss: 0.738086, loss_d: 0.006218
0.3110 --- loss: 0.840655, loss_ss: 0.788774, loss_d: 0.051880
0.3888 --- loss: 0.975708, loss_ss: 0.839010, loss_d: 0.136697
0.4666 --- loss: 0.884407, loss_ss: 0.722622, loss_d: 0.161785
0.5443 --- loss: 0.684353, loss_ss: 0.681012, loss_d: 0.003341
0.6221 --- loss: 1.101638, loss_ss: 0.844376, loss_d: 0.257262
0.6998 --- loss: 0.945773, loss_ss: 0.933885, loss_d: 0.011888
0.7776 --- loss: 1.128500, loss_ss: 0.798432, loss_d: 0.330068
0.8554 --- loss: 0.852979, loss_ss: 0.818147, loss_d: 0.034831
0.9331 --- loss: 0.915476, loss_ss: 0.881486, loss_d: 0.033990
Epoch finished! Loss: 1.0094326427206397
Starting epoch 8/10.
0.0000 --- loss: 0.979759, loss_ss: 0.964644, loss_d: 0.015115
0.0778 --- loss: 1.012975, loss_ss: 1.006162, loss_d: 0.006813
0.1555 --- loss: 0.860284, loss_ss: 0.824078, loss_d: 0.036206
0.2333 --- loss: 0.866171, loss_ss: 0.857274, loss_d: 0.008897
0.3110 --- loss: 1.248327, loss_ss: 0.809753, loss_d: 0.438575
0.3888 --- loss: 1.166744, loss_ss: 1.051772, loss_d: 0.114972
0.4666 --- loss: 0.886167, loss_ss: 0.831840, loss_d: 0.054326
0.5443 --- loss: 0.777101, loss_ss: 0.748811, loss_d: 0.028290
0.6221 --- loss: 0.968640, loss_ss: 0.796073, loss_d: 0.172567
0.6998 --- loss: 0.851070, loss_ss: 0.806260, loss_d: 0.044810
0.7776 --- loss: 0.907684, loss_ss: 0.891434, loss_d: 0.016250
0.8554 --- loss: 0.888616, loss_ss: 0.869945, loss_d: 0.018672
0.9331 --- loss: 0.856899, loss_ss: 0.834042, loss_d: 0.022857
Epoch finished! Loss: 0.9622883065603673
Starting epoch 9/10.
0.0000 --- loss: 0.690193, loss_ss: 0.683467, loss_d: 0.006727
0.0778 --- loss: 0.892035, loss_ss: 0.890283, loss_d: 0.001751
0.1555 --- loss: 0.996073, loss_ss: 0.983522, loss_d: 0.012551
0.2333 --- loss: 0.910061, loss_ss: 0.858766, loss_d: 0.051294
0.3110 --- loss: 0.939146, loss_ss: 0.914880, loss_d: 0.024266
0.3888 --- loss: 0.770267, loss_ss: 0.766407, loss_d: 0.003861
0.4666 --- loss: 1.094219, loss_ss: 0.950406, loss_d: 0.143813
0.5443 --- loss: 0.765466, loss_ss: 0.727667, loss_d: 0.037799
0.6221 --- loss: 0.936910, loss_ss: 0.917304, loss_d: 0.019605
0.6998 --- loss: 0.766738, loss_ss: 0.739935, loss_d: 0.026803
0.7776 --- loss: 0.893604, loss_ss: 0.849426, loss_d: 0.044178
0.8554 --- loss: 0.752778, loss_ss: 0.688033, loss_d: 0.064744
0.9331 --- loss: 0.892515, loss_ss: 0.871147, loss_d: 0.021369
Epoch finished! Loss: 0.9170057866722345
Starting epoch 10/10.
0.0000 --- loss: 0.850005, loss_ss: 0.813364, loss_d: 0.036641
0.0778 --- loss: 0.648450, loss_ss: 0.558285, loss_d: 0.090164
0.1555 --- loss: 0.862465, loss_ss: 0.860090, loss_d: 0.002375
0.2333 --- loss: 0.894369, loss_ss: 0.893395, loss_d: 0.000974
0.3110 --- loss: 0.634128, loss_ss: 0.628372, loss_d: 0.005756
0.3888 --- loss: 0.718489, loss_ss: 0.708772, loss_d: 0.009717
0.4666 --- loss: 0.895285, loss_ss: 0.880099, loss_d: 0.015186
0.5443 --- loss: 1.100138, loss_ss: 1.096459, loss_d: 0.003679
0.6221 --- loss: 0.913694, loss_ss: 0.910324, loss_d: 0.003371
0.6998 --- loss: 0.970793, loss_ss: 0.965288, loss_d: 0.005505
0.7776 --- loss: 0.810104, loss_ss: 0.761058, loss_d: 0.049046
0.8554 --- loss: 1.058039, loss_ss: 0.880772, loss_d: 0.177267
0.9331 --- loss: 1.308540, loss_ss: 1.128878, loss_d: 0.179662
Epoch finished! Loss: 0.9002409679815173
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8797619047619047
             precision    recall  f1-score   support

        0.0       0.88      1.00      0.93        57
        1.0       0.50      0.40      0.45        42
        2.0       0.91      0.88      0.89       432
        3.0       0.97      0.90      0.93       196
        4.0       0.76      0.96      0.85       113

avg / total       0.88      0.88      0.88       840
 


====== chc009-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  99.05  100.00   98.98  87.69     93.44
1  95.00   40.48   97.87  50.00     44.74
2  89.40   87.73   91.18  91.33     89.49
3  97.02   90.31   99.07  96.72     93.40
4  95.48   96.46   95.32  76.22     85.16
Total accuracy: 87.98%
Average sen: 82.99%
Average spec: 96.48%
Macro f1-score: 81.25%
Diagnosis acc on 30mins: 0.7857142857142857
[1.58193463e-03 1.27658644e-03 3.64768266e-06 1.00394223e-04
 7.06240594e-01 6.72625552e-04 9.46837068e-01 4.56557959e-01
 4.41420404e-03 5.21140581e-04 6.27965026e-04 2.05950849e-02
 2.12363619e-03 9.78027999e-01]
pred: 0.22282720285391275, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc009-nsrr

=== Test on chc010-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.495071, loss_ss: 1.820558, loss_d: 0.674513
0.0778 --- loss: 2.498768, loss_ss: 1.631734, loss_d: 0.867034
0.1555 --- loss: 2.040524, loss_ss: 1.608669, loss_d: 0.431855
0.2333 --- loss: 2.660063, loss_ss: 1.576588, loss_d: 1.083475
0.3110 --- loss: 2.016865, loss_ss: 1.425943, loss_d: 0.590922
0.3888 --- loss: 2.579722, loss_ss: 1.517024, loss_d: 1.062698
0.4666 --- loss: 2.259939, loss_ss: 1.421328, loss_d: 0.838611
0.5443 --- loss: 2.273361, loss_ss: 1.439272, loss_d: 0.834088
0.6221 --- loss: 2.036702, loss_ss: 1.437826, loss_d: 0.598876
0.6998 --- loss: 1.805467, loss_ss: 1.539744, loss_d: 0.265723
0.7776 --- loss: 2.145374, loss_ss: 1.458950, loss_d: 0.686424
0.8554 --- loss: 1.745568, loss_ss: 1.422046, loss_d: 0.323522
0.9331 --- loss: 2.038539, loss_ss: 1.385066, loss_d: 0.653473
Epoch finished! Loss: 2.0957744093611836
Starting epoch 2/10.
0.0000 --- loss: 2.247303, loss_ss: 1.324259, loss_d: 0.923044
0.0778 --- loss: 1.957951, loss_ss: 1.534422, loss_d: 0.423529
0.1555 --- loss: 1.899676, loss_ss: 1.426273, loss_d: 0.473403
0.2333 --- loss: 1.769320, loss_ss: 1.339152, loss_d: 0.430169
0.3110 --- loss: 1.799713, loss_ss: 1.332637, loss_d: 0.467076
0.3888 --- loss: 1.659026, loss_ss: 1.188905, loss_d: 0.470121
0.4666 --- loss: 1.522068, loss_ss: 1.261358, loss_d: 0.260710
0.5443 --- loss: 2.186324, loss_ss: 1.274401, loss_d: 0.911923
0.6221 --- loss: 1.466932, loss_ss: 1.310184, loss_d: 0.156748
0.6998 --- loss: 1.779912, loss_ss: 1.286660, loss_d: 0.493252
0.7776 --- loss: 1.507738, loss_ss: 1.143997, loss_d: 0.363741
0.8554 --- loss: 1.388600, loss_ss: 1.152680, loss_d: 0.235920
0.9331 --- loss: 1.591823, loss_ss: 1.241543, loss_d: 0.350279
Epoch finished! Loss: 1.765858830884099
Starting epoch 3/10.
0.0000 --- loss: 2.019977, loss_ss: 1.281913, loss_d: 0.738064
0.0778 --- loss: 1.342244, loss_ss: 1.159081, loss_d: 0.183163
0.1555 --- loss: 1.296451, loss_ss: 1.116892, loss_d: 0.179559
0.2333 --- loss: 1.543197, loss_ss: 1.268424, loss_d: 0.274773
0.3110 --- loss: 1.760224, loss_ss: 1.366633, loss_d: 0.393591
0.3888 --- loss: 1.376571, loss_ss: 1.236478, loss_d: 0.140093
0.4666 --- loss: 1.466454, loss_ss: 1.013287, loss_d: 0.453167
0.5443 --- loss: 1.563175, loss_ss: 1.094925, loss_d: 0.468250
0.6221 --- loss: 1.279311, loss_ss: 1.109284, loss_d: 0.170028
0.6998 --- loss: 1.327393, loss_ss: 0.993071, loss_d: 0.334322
0.7776 --- loss: 1.493492, loss_ss: 1.112999, loss_d: 0.380494
0.8554 --- loss: 1.495933, loss_ss: 1.139205, loss_d: 0.356728
0.9331 --- loss: 1.413262, loss_ss: 1.166555, loss_d: 0.246707
Epoch finished! Loss: 1.4932794468477368
Starting epoch 4/10.
0.0000 --- loss: 1.168754, loss_ss: 0.978140, loss_d: 0.190614
0.0778 --- loss: 1.453544, loss_ss: 1.238869, loss_d: 0.214675
0.1555 --- loss: 1.641200, loss_ss: 1.382108, loss_d: 0.259093
0.2333 --- loss: 1.091586, loss_ss: 0.949165, loss_d: 0.142420
0.3110 --- loss: 1.301329, loss_ss: 1.206489, loss_d: 0.094841
0.3888 --- loss: 1.415343, loss_ss: 0.944691, loss_d: 0.470652
0.4666 --- loss: 1.358728, loss_ss: 1.215787, loss_d: 0.142941
0.5443 --- loss: 1.578737, loss_ss: 0.905495, loss_d: 0.673241
0.6221 --- loss: 1.031419, loss_ss: 0.898871, loss_d: 0.132548
0.6998 --- loss: 1.332952, loss_ss: 1.209313, loss_d: 0.123639
0.7776 --- loss: 1.332911, loss_ss: 0.938238, loss_d: 0.394673
0.8554 --- loss: 1.140701, loss_ss: 1.065548, loss_d: 0.075153
0.9331 --- loss: 1.122917, loss_ss: 1.002934, loss_d: 0.119983
Epoch finished! Loss: 1.3396814693696797
Starting epoch 5/10.
0.0000 --- loss: 1.118120, loss_ss: 1.037426, loss_d: 0.080694
0.0778 --- loss: 1.288467, loss_ss: 0.978980, loss_d: 0.309486
0.1555 --- loss: 1.244429, loss_ss: 1.017589, loss_d: 0.226840
0.2333 --- loss: 1.071461, loss_ss: 0.959112, loss_d: 0.112349
0.3110 --- loss: 1.213783, loss_ss: 1.105165, loss_d: 0.108618
0.3888 --- loss: 1.099829, loss_ss: 0.878338, loss_d: 0.221492
0.4666 --- loss: 1.319964, loss_ss: 1.285199, loss_d: 0.034765
0.5443 --- loss: 1.241154, loss_ss: 0.872613, loss_d: 0.368541
0.6221 --- loss: 1.451754, loss_ss: 1.089723, loss_d: 0.362031
0.6998 --- loss: 1.074436, loss_ss: 0.938074, loss_d: 0.136362
0.7776 --- loss: 0.945940, loss_ss: 0.809374, loss_d: 0.136566
0.8554 --- loss: 0.960775, loss_ss: 0.946445, loss_d: 0.014330
0.9331 --- loss: 1.097112, loss_ss: 1.061111, loss_d: 0.036001
Epoch finished! Loss: 1.21812530932948
Starting epoch 6/10.
0.0000 --- loss: 1.189838, loss_ss: 1.081104, loss_d: 0.108735
0.0778 --- loss: 1.142909, loss_ss: 1.129428, loss_d: 0.013481
0.1555 --- loss: 1.393582, loss_ss: 1.121962, loss_d: 0.271620
0.2333 --- loss: 1.351005, loss_ss: 0.836487, loss_d: 0.514518
0.3110 --- loss: 1.078348, loss_ss: 1.022948, loss_d: 0.055400
0.3888 --- loss: 1.341038, loss_ss: 1.047968, loss_d: 0.293070
0.4666 --- loss: 1.472391, loss_ss: 1.030039, loss_d: 0.442352
0.5443 --- loss: 1.007114, loss_ss: 0.960277, loss_d: 0.046837
0.6221 --- loss: 1.048165, loss_ss: 0.923437, loss_d: 0.124729
0.6998 --- loss: 0.973042, loss_ss: 0.959888, loss_d: 0.013154
0.7776 --- loss: 1.243495, loss_ss: 1.114011, loss_d: 0.129484
0.8554 --- loss: 0.882376, loss_ss: 0.873734, loss_d: 0.008642
0.9331 --- loss: 1.112568, loss_ss: 1.047631, loss_d: 0.064936
Epoch finished! Loss: 1.1560958670452237
Starting epoch 7/10.
0.0000 --- loss: 0.982240, loss_ss: 0.951904, loss_d: 0.030336
0.0778 --- loss: 1.005961, loss_ss: 0.922427, loss_d: 0.083535
0.1555 --- loss: 1.199868, loss_ss: 0.885039, loss_d: 0.314829
0.2333 --- loss: 1.163161, loss_ss: 1.152957, loss_d: 0.010204
0.3110 --- loss: 1.116005, loss_ss: 1.013884, loss_d: 0.102121
0.3888 --- loss: 1.042035, loss_ss: 0.909286, loss_d: 0.132749
0.4666 --- loss: 0.980044, loss_ss: 0.900067, loss_d: 0.079977
0.5443 --- loss: 1.061176, loss_ss: 1.011181, loss_d: 0.049995
0.6221 --- loss: 0.885172, loss_ss: 0.787145, loss_d: 0.098027
0.6998 --- loss: 1.535193, loss_ss: 1.314113, loss_d: 0.221080
0.7776 --- loss: 0.983072, loss_ss: 0.976520, loss_d: 0.006553
0.8554 --- loss: 1.122862, loss_ss: 0.954179, loss_d: 0.168682
0.9331 --- loss: 1.012741, loss_ss: 0.997449, loss_d: 0.015292
Epoch finished! Loss: 1.0551855028606951
Starting epoch 8/10.
0.0000 --- loss: 0.872691, loss_ss: 0.859746, loss_d: 0.012944
0.0778 --- loss: 0.972796, loss_ss: 0.895472, loss_d: 0.077324
0.1555 --- loss: 0.909400, loss_ss: 0.844335, loss_d: 0.065065
0.2333 --- loss: 0.878124, loss_ss: 0.857953, loss_d: 0.020171
0.3110 --- loss: 1.252921, loss_ss: 0.821591, loss_d: 0.431329
0.3888 --- loss: 1.200027, loss_ss: 1.163433, loss_d: 0.036594
0.4666 --- loss: 1.302997, loss_ss: 1.041226, loss_d: 0.261771
0.5443 --- loss: 0.956011, loss_ss: 0.894732, loss_d: 0.061279
0.6221 --- loss: 0.999120, loss_ss: 0.989079, loss_d: 0.010042
0.6998 --- loss: 1.173259, loss_ss: 0.785284, loss_d: 0.387975
0.7776 --- loss: 1.318178, loss_ss: 1.222874, loss_d: 0.095303
0.8554 --- loss: 0.954969, loss_ss: 0.943216, loss_d: 0.011753
0.9331 --- loss: 1.098938, loss_ss: 0.898834, loss_d: 0.200104
Epoch finished! Loss: 1.0533217857591808
Starting epoch 9/10.
0.0000 --- loss: 1.251300, loss_ss: 1.248333, loss_d: 0.002966
0.0778 --- loss: 0.800262, loss_ss: 0.793396, loss_d: 0.006866
0.1555 --- loss: 0.810750, loss_ss: 0.757935, loss_d: 0.052814
0.2333 --- loss: 1.268810, loss_ss: 1.164329, loss_d: 0.104481
0.3110 --- loss: 0.901308, loss_ss: 0.833795, loss_d: 0.067513
0.3888 --- loss: 0.815317, loss_ss: 0.794847, loss_d: 0.020470
0.4666 --- loss: 1.234033, loss_ss: 0.853532, loss_d: 0.380501
0.5443 --- loss: 0.918942, loss_ss: 0.902833, loss_d: 0.016109
0.6221 --- loss: 1.527952, loss_ss: 1.044251, loss_d: 0.483702
0.6998 --- loss: 1.357632, loss_ss: 1.045923, loss_d: 0.311709
0.7776 --- loss: 1.059655, loss_ss: 0.984417, loss_d: 0.075238
0.8554 --- loss: 0.994809, loss_ss: 0.971922, loss_d: 0.022887
0.9331 --- loss: 0.763380, loss_ss: 0.747151, loss_d: 0.016229
Epoch finished! Loss: 1.007141309324652
Starting epoch 10/10.
0.0000 --- loss: 1.207695, loss_ss: 0.905309, loss_d: 0.302386
0.0778 --- loss: 1.073069, loss_ss: 1.069967, loss_d: 0.003102
0.1555 --- loss: 0.832998, loss_ss: 0.822614, loss_d: 0.010384
0.2333 --- loss: 0.937523, loss_ss: 0.933154, loss_d: 0.004369
0.3110 --- loss: 1.184893, loss_ss: 0.996112, loss_d: 0.188781
0.3888 --- loss: 0.864195, loss_ss: 0.860866, loss_d: 0.003329
0.4666 --- loss: 0.957866, loss_ss: 0.942371, loss_d: 0.015495
0.5443 --- loss: 0.828109, loss_ss: 0.822477, loss_d: 0.005632
0.6221 --- loss: 1.085743, loss_ss: 1.085221, loss_d: 0.000521
0.6998 --- loss: 0.751237, loss_ss: 0.723576, loss_d: 0.027661
0.7776 --- loss: 1.234305, loss_ss: 1.225266, loss_d: 0.009039
0.8554 --- loss: 0.914956, loss_ss: 0.909365, loss_d: 0.005590
0.9331 --- loss: 0.728218, loss_ss: 0.721428, loss_d: 0.006789
Epoch finished! Loss: 0.9520642971619964
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6785714285714286
             precision    recall  f1-score   support

        0.0       0.90      0.91      0.90       123
        1.0       0.21      0.40      0.28        43
        2.0       0.75      0.79      0.77       400
        3.0       1.00      0.23      0.37       193
        4.0       0.48      1.00      0.65        81

avg / total       0.77      0.68      0.66       840
 


====== chc010-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  97.14   91.06   98.19   89.60     90.32
1  89.40   39.53   92.10   21.25     27.64
2  77.38   79.00   75.91   74.88     76.89
3  82.26   22.80  100.00  100.00     37.13
4  89.52  100.00   88.41   47.93     64.80
Total accuracy: 67.86%
Average sen: 66.48%
Average spec: 90.92%
Macro f1-score: 59.36%
Diagnosis acc on 30mins: 0.21428571428571427
[0.99979764 0.99997246 0.92512941 0.94192934 0.35830617 0.90439993
 0.97700089 0.70845985 0.97318745 0.91940236 0.92480731 0.95041186
 0.19825397 0.42373294]
pred: 0.800342256469386, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc010-nsrr

=== Test on chc012-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.343484, loss_ss: 1.580331, loss_d: 0.763153
0.0778 --- loss: 2.121408, loss_ss: 1.492404, loss_d: 0.629005
0.1556 --- loss: 2.090687, loss_ss: 1.543657, loss_d: 0.547030
0.2335 --- loss: 1.855142, loss_ss: 1.376753, loss_d: 0.478389
0.3113 --- loss: 1.813043, loss_ss: 1.394196, loss_d: 0.418847
0.3891 --- loss: 1.749396, loss_ss: 1.424940, loss_d: 0.324457
0.4669 --- loss: 2.184928, loss_ss: 1.365616, loss_d: 0.819312
0.5447 --- loss: 2.061592, loss_ss: 1.511709, loss_d: 0.549882
0.6226 --- loss: 1.895489, loss_ss: 1.294059, loss_d: 0.601430
0.7004 --- loss: 1.489747, loss_ss: 1.211364, loss_d: 0.278382
0.7782 --- loss: 1.528759, loss_ss: 1.267242, loss_d: 0.261516
0.8560 --- loss: 1.874151, loss_ss: 1.308856, loss_d: 0.565295
0.9339 --- loss: 1.687404, loss_ss: 1.266702, loss_d: 0.420702
Epoch finished! Loss: 2.001683497801423
Starting epoch 2/10.
0.0000 --- loss: 2.019653, loss_ss: 1.270320, loss_d: 0.749333
0.0778 --- loss: 1.772020, loss_ss: 1.283895, loss_d: 0.488126
0.1556 --- loss: 1.517077, loss_ss: 1.204800, loss_d: 0.312277
0.2335 --- loss: 1.482605, loss_ss: 1.222596, loss_d: 0.260008
0.3113 --- loss: 1.381969, loss_ss: 1.129186, loss_d: 0.252783
0.3891 --- loss: 1.839122, loss_ss: 1.127849, loss_d: 0.711273
0.4669 --- loss: 1.744210, loss_ss: 1.331629, loss_d: 0.412581
0.5447 --- loss: 2.062565, loss_ss: 1.170932, loss_d: 0.891633
0.6226 --- loss: 1.847485, loss_ss: 1.212897, loss_d: 0.634588
0.7004 --- loss: 1.664301, loss_ss: 1.109234, loss_d: 0.555067
0.7782 --- loss: 1.541355, loss_ss: 1.200435, loss_d: 0.340920
0.8560 --- loss: 2.210521, loss_ss: 1.055455, loss_d: 1.155066
0.9339 --- loss: 1.429229, loss_ss: 1.203343, loss_d: 0.225886
Epoch finished! Loss: 1.6535208337008953
Starting epoch 3/10.
0.0000 --- loss: 1.287699, loss_ss: 1.134108, loss_d: 0.153591
0.0778 --- loss: 1.315634, loss_ss: 1.067594, loss_d: 0.248040
0.1556 --- loss: 1.298143, loss_ss: 1.086699, loss_d: 0.211444
0.2335 --- loss: 1.632299, loss_ss: 1.449987, loss_d: 0.182312
0.3113 --- loss: 1.384205, loss_ss: 1.086637, loss_d: 0.297568
0.3891 --- loss: 1.380766, loss_ss: 1.084707, loss_d: 0.296060
0.4669 --- loss: 1.632404, loss_ss: 1.196515, loss_d: 0.435889
0.5447 --- loss: 1.283452, loss_ss: 1.141408, loss_d: 0.142044
0.6226 --- loss: 1.681733, loss_ss: 0.984197, loss_d: 0.697535
0.7004 --- loss: 1.279064, loss_ss: 1.086675, loss_d: 0.192389
0.7782 --- loss: 1.136594, loss_ss: 1.028839, loss_d: 0.107755
0.8560 --- loss: 1.249631, loss_ss: 0.990061, loss_d: 0.259571
0.9339 --- loss: 1.428264, loss_ss: 1.307761, loss_d: 0.120503
Epoch finished! Loss: 1.424003285355866
Starting epoch 4/10.
0.0000 --- loss: 1.394121, loss_ss: 0.915734, loss_d: 0.478387
0.0778 --- loss: 1.242152, loss_ss: 1.068762, loss_d: 0.173390
0.1556 --- loss: 0.935935, loss_ss: 0.853766, loss_d: 0.082169
0.2335 --- loss: 1.195449, loss_ss: 0.985417, loss_d: 0.210032
0.3113 --- loss: 1.277954, loss_ss: 1.060207, loss_d: 0.217748
0.3891 --- loss: 1.537336, loss_ss: 0.999302, loss_d: 0.538034
0.4669 --- loss: 1.378194, loss_ss: 1.293348, loss_d: 0.084846
0.5447 --- loss: 1.208393, loss_ss: 0.871161, loss_d: 0.337232
0.6226 --- loss: 1.368290, loss_ss: 1.079438, loss_d: 0.288852
0.7004 --- loss: 1.091597, loss_ss: 0.945149, loss_d: 0.146448
0.7782 --- loss: 1.503633, loss_ss: 1.088382, loss_d: 0.415251
0.8560 --- loss: 1.346474, loss_ss: 1.077490, loss_d: 0.268984
0.9339 --- loss: 1.056524, loss_ss: 0.957723, loss_d: 0.098801
Epoch finished! Loss: 1.3515761084854603
Starting epoch 5/10.
0.0000 --- loss: 1.238774, loss_ss: 0.948526, loss_d: 0.290248
0.0778 --- loss: 1.165106, loss_ss: 0.890863, loss_d: 0.274242
0.1556 --- loss: 1.273981, loss_ss: 1.130034, loss_d: 0.143947
0.2335 --- loss: 1.053140, loss_ss: 0.934281, loss_d: 0.118859
0.3113 --- loss: 1.117523, loss_ss: 0.969736, loss_d: 0.147787
0.3891 --- loss: 1.167844, loss_ss: 0.957736, loss_d: 0.210108
0.4669 --- loss: 1.666326, loss_ss: 0.833629, loss_d: 0.832697
0.5447 --- loss: 1.236598, loss_ss: 1.194049, loss_d: 0.042548
0.6226 --- loss: 1.144213, loss_ss: 1.083474, loss_d: 0.060739
0.7004 --- loss: 1.422601, loss_ss: 1.180596, loss_d: 0.242005
0.7782 --- loss: 1.066077, loss_ss: 0.887531, loss_d: 0.178546
0.8560 --- loss: 1.235882, loss_ss: 1.062373, loss_d: 0.173509
0.9339 --- loss: 1.094602, loss_ss: 0.907105, loss_d: 0.187497
Epoch finished! Loss: 1.1824367879889905
Starting epoch 6/10.
0.0000 --- loss: 0.952412, loss_ss: 0.918362, loss_d: 0.034050
0.0778 --- loss: 0.820150, loss_ss: 0.783975, loss_d: 0.036174
0.1556 --- loss: 0.906943, loss_ss: 0.839960, loss_d: 0.066982
0.2335 --- loss: 1.146407, loss_ss: 0.905574, loss_d: 0.240833
0.3113 --- loss: 1.063464, loss_ss: 0.981090, loss_d: 0.082374
0.3891 --- loss: 0.938093, loss_ss: 0.859390, loss_d: 0.078702
0.4669 --- loss: 1.058906, loss_ss: 0.922213, loss_d: 0.136693
0.5447 --- loss: 0.909853, loss_ss: 0.859530, loss_d: 0.050323
0.6226 --- loss: 1.259687, loss_ss: 1.010683, loss_d: 0.249004
0.7004 --- loss: 1.866504, loss_ss: 1.085068, loss_d: 0.781435
0.7782 --- loss: 0.994933, loss_ss: 0.969722, loss_d: 0.025211
0.8560 --- loss: 1.317415, loss_ss: 1.101453, loss_d: 0.215961
0.9339 --- loss: 0.905706, loss_ss: 0.806873, loss_d: 0.098833
Epoch finished! Loss: 1.1735676331445575
Starting epoch 7/10.
0.0000 --- loss: 1.392813, loss_ss: 1.289321, loss_d: 0.103492
0.0778 --- loss: 0.962707, loss_ss: 0.921493, loss_d: 0.041214
0.1556 --- loss: 1.102325, loss_ss: 0.892034, loss_d: 0.210291
0.2335 --- loss: 1.068727, loss_ss: 1.052468, loss_d: 0.016259
0.3113 --- loss: 1.080694, loss_ss: 1.023962, loss_d: 0.056732
0.3891 --- loss: 1.481125, loss_ss: 0.969442, loss_d: 0.511683
0.4669 --- loss: 0.948139, loss_ss: 0.909021, loss_d: 0.039118
0.5447 --- loss: 0.924189, loss_ss: 0.888907, loss_d: 0.035282
0.6226 --- loss: 0.970954, loss_ss: 0.816300, loss_d: 0.154655
0.7004 --- loss: 0.897403, loss_ss: 0.848592, loss_d: 0.048811
0.7782 --- loss: 1.014677, loss_ss: 0.879534, loss_d: 0.135143
0.8560 --- loss: 1.124234, loss_ss: 0.937484, loss_d: 0.186750
0.9339 --- loss: 0.812616, loss_ss: 0.773929, loss_d: 0.038687
Epoch finished! Loss: 1.0772000127471983
Starting epoch 8/10.
0.0000 --- loss: 1.062983, loss_ss: 1.028500, loss_d: 0.034482
0.0778 --- loss: 1.512237, loss_ss: 0.812111, loss_d: 0.700126
0.1556 --- loss: 0.887330, loss_ss: 0.871773, loss_d: 0.015557
0.2335 --- loss: 0.927751, loss_ss: 0.909368, loss_d: 0.018382
0.3113 --- loss: 1.008892, loss_ss: 0.997076, loss_d: 0.011816
0.3891 --- loss: 0.938267, loss_ss: 0.922064, loss_d: 0.016203
0.4669 --- loss: 1.141702, loss_ss: 1.095990, loss_d: 0.045712
0.5447 --- loss: 1.137289, loss_ss: 0.819469, loss_d: 0.317821
0.6226 --- loss: 1.112257, loss_ss: 0.888600, loss_d: 0.223657
0.7004 --- loss: 1.003085, loss_ss: 0.996975, loss_d: 0.006110
0.7782 --- loss: 0.866857, loss_ss: 0.854824, loss_d: 0.012033
0.8560 --- loss: 0.873701, loss_ss: 0.830266, loss_d: 0.043435
0.9339 --- loss: 1.236208, loss_ss: 0.877096, loss_d: 0.359112
Epoch finished! Loss: 1.0391055685468018
Starting epoch 9/10.
0.0000 --- loss: 1.103393, loss_ss: 1.101278, loss_d: 0.002114
0.0778 --- loss: 1.052736, loss_ss: 1.040280, loss_d: 0.012456
0.1556 --- loss: 1.245177, loss_ss: 1.238004, loss_d: 0.007173
0.2335 --- loss: 1.422680, loss_ss: 1.221156, loss_d: 0.201525
0.3113 --- loss: 0.825096, loss_ss: 0.806583, loss_d: 0.018514
0.3891 --- loss: 1.059627, loss_ss: 1.029290, loss_d: 0.030337
0.4669 --- loss: 0.988960, loss_ss: 0.746955, loss_d: 0.242004
0.5447 --- loss: 0.783536, loss_ss: 0.770674, loss_d: 0.012861
0.6226 --- loss: 1.079672, loss_ss: 0.896323, loss_d: 0.183350
0.7004 --- loss: 1.152996, loss_ss: 0.795210, loss_d: 0.357786
0.7782 --- loss: 1.160899, loss_ss: 1.142198, loss_d: 0.018701
0.8560 --- loss: 0.900283, loss_ss: 0.853379, loss_d: 0.046904
0.9339 --- loss: 0.701896, loss_ss: 0.623078, loss_d: 0.078818
Epoch finished! Loss: 1.0305251684039831
Starting epoch 10/10.
0.0000 --- loss: 0.978126, loss_ss: 0.971762, loss_d: 0.006363
0.0778 --- loss: 0.886888, loss_ss: 0.876853, loss_d: 0.010035
0.1556 --- loss: 0.779234, loss_ss: 0.777609, loss_d: 0.001625
0.2335 --- loss: 0.944545, loss_ss: 0.930848, loss_d: 0.013696
0.3113 --- loss: 0.798543, loss_ss: 0.719328, loss_d: 0.079215
0.3891 --- loss: 0.984478, loss_ss: 0.979655, loss_d: 0.004823
0.4669 --- loss: 0.848811, loss_ss: 0.847537, loss_d: 0.001274
0.5447 --- loss: 0.944644, loss_ss: 0.939366, loss_d: 0.005278
0.6226 --- loss: 0.894322, loss_ss: 0.847826, loss_d: 0.046496
0.7004 --- loss: 1.180619, loss_ss: 1.172464, loss_d: 0.008155
0.7782 --- loss: 0.969132, loss_ss: 0.966922, loss_d: 0.002209
0.8560 --- loss: 0.681936, loss_ss: 0.662927, loss_d: 0.019009
0.9339 --- loss: 1.024942, loss_ss: 1.021111, loss_d: 0.003831
Epoch finished! Loss: 0.9369597537443042
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7655555555555555
             precision    recall  f1-score   support

        0.0       0.86      0.38      0.53        63
        1.0       0.09      0.05      0.06        22
        2.0       0.81      0.92      0.87       541
        3.0       1.00      0.50      0.66       204
        4.0       0.43      0.90      0.58        70

avg / total       0.81      0.77      0.75       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.22  38.10   99.52   85.71     52.75
1  96.56   4.55   98.86    9.09      6.06
2  82.78  92.42   68.25   81.43     86.58
3  88.56  49.51  100.00  100.00     66.23
4  90.00  90.00   90.00   43.15     58.33
Total accuracy: 76.56%
Average sen: 54.91%
Average spec: 91.33%
Macro f1-score: 53.99%
Diagnosis acc on 30mins: 0.2
[0.16128927 0.99914479 0.95369154 0.90518987 0.99995971 0.00897187
 0.74515533 0.96429682 0.9989391  0.99709821 0.99594551 0.99952865
 0.99998057 0.22771256 0.94512349]
pred: 0.7934684864555795, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc012-nsrr

=== Test on chc013-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.508079, loss_ss: 1.796301, loss_d: 0.711778
0.0778 --- loss: 2.272937, loss_ss: 1.565361, loss_d: 0.707576
0.1556 --- loss: 2.345751, loss_ss: 1.567325, loss_d: 0.778426
0.2335 --- loss: 2.041825, loss_ss: 1.627999, loss_d: 0.413826
0.3113 --- loss: 2.200265, loss_ss: 1.499220, loss_d: 0.701046
0.3891 --- loss: 2.155648, loss_ss: 1.450521, loss_d: 0.705126
0.4669 --- loss: 1.798965, loss_ss: 1.406744, loss_d: 0.392221
0.5447 --- loss: 2.208899, loss_ss: 1.349924, loss_d: 0.858975
0.6226 --- loss: 1.807013, loss_ss: 1.408295, loss_d: 0.398719
0.7004 --- loss: 2.026157, loss_ss: 1.426286, loss_d: 0.599871
0.7782 --- loss: 2.029949, loss_ss: 1.413281, loss_d: 0.616669
0.8560 --- loss: 2.024325, loss_ss: 1.325729, loss_d: 0.698596
0.9339 --- loss: 1.855728, loss_ss: 1.359124, loss_d: 0.496604
Epoch finished! Loss: 2.031403868459165
Starting epoch 2/10.
0.0000 --- loss: 1.853509, loss_ss: 1.327145, loss_d: 0.526364
0.0778 --- loss: 1.929981, loss_ss: 1.477543, loss_d: 0.452437
0.1556 --- loss: 1.813564, loss_ss: 1.339295, loss_d: 0.474269
0.2335 --- loss: 1.838775, loss_ss: 1.347858, loss_d: 0.490917
0.3113 --- loss: 1.936026, loss_ss: 1.217006, loss_d: 0.719020
0.3891 --- loss: 1.464571, loss_ss: 1.317964, loss_d: 0.146607
0.4669 --- loss: 1.563375, loss_ss: 1.364640, loss_d: 0.198736
0.5447 --- loss: 1.634036, loss_ss: 1.228562, loss_d: 0.405474
0.6226 --- loss: 1.825060, loss_ss: 1.288830, loss_d: 0.536230
0.7004 --- loss: 1.736281, loss_ss: 1.303159, loss_d: 0.433122
0.7782 --- loss: 1.468989, loss_ss: 1.288821, loss_d: 0.180168
0.8560 --- loss: 1.705386, loss_ss: 1.276532, loss_d: 0.428854
0.9339 --- loss: 1.690293, loss_ss: 1.192609, loss_d: 0.497684
Epoch finished! Loss: 1.6795949498191476
Starting epoch 3/10.
0.0000 --- loss: 1.524544, loss_ss: 1.093510, loss_d: 0.431034
0.0778 --- loss: 1.803311, loss_ss: 1.377594, loss_d: 0.425717
0.1556 --- loss: 2.003540, loss_ss: 1.395513, loss_d: 0.608027
0.2335 --- loss: 1.530697, loss_ss: 1.283728, loss_d: 0.246969
0.3113 --- loss: 1.421909, loss_ss: 1.258866, loss_d: 0.163043
0.3891 --- loss: 1.882071, loss_ss: 1.304521, loss_d: 0.577549
0.4669 --- loss: 1.109663, loss_ss: 1.018198, loss_d: 0.091465
0.5447 --- loss: 1.668780, loss_ss: 1.165411, loss_d: 0.503368
0.6226 --- loss: 1.475446, loss_ss: 1.129694, loss_d: 0.345752
0.7004 --- loss: 1.497987, loss_ss: 1.196081, loss_d: 0.301906
0.7782 --- loss: 1.631485, loss_ss: 1.277276, loss_d: 0.354209
0.8560 --- loss: 1.304072, loss_ss: 1.081765, loss_d: 0.222307
0.9339 --- loss: 1.161575, loss_ss: 0.998534, loss_d: 0.163041
Epoch finished! Loss: 1.5091406991705298
Starting epoch 4/10.
0.0000 --- loss: 1.322997, loss_ss: 1.137467, loss_d: 0.185530
0.0778 --- loss: 1.255646, loss_ss: 1.129396, loss_d: 0.126250
0.1556 --- loss: 1.466740, loss_ss: 1.041599, loss_d: 0.425141
0.2335 --- loss: 1.305173, loss_ss: 1.097710, loss_d: 0.207463
0.3113 --- loss: 1.210227, loss_ss: 1.174727, loss_d: 0.035500
0.3891 --- loss: 1.136027, loss_ss: 1.052684, loss_d: 0.083343
0.4669 --- loss: 1.328563, loss_ss: 1.033605, loss_d: 0.294958
0.5447 --- loss: 1.023250, loss_ss: 0.949827, loss_d: 0.073422
0.6226 --- loss: 1.121768, loss_ss: 1.082623, loss_d: 0.039145
0.7004 --- loss: 1.375687, loss_ss: 1.087771, loss_d: 0.287916
0.7782 --- loss: 1.417077, loss_ss: 1.186118, loss_d: 0.230959
0.8560 --- loss: 1.450096, loss_ss: 0.962429, loss_d: 0.487667
0.9339 --- loss: 1.441119, loss_ss: 1.203747, loss_d: 0.237372
Epoch finished! Loss: 1.3734163222834468
Starting epoch 5/10.
0.0000 --- loss: 1.203210, loss_ss: 1.137669, loss_d: 0.065542
0.0778 --- loss: 1.183467, loss_ss: 1.079340, loss_d: 0.104126
0.1556 --- loss: 1.233297, loss_ss: 1.051387, loss_d: 0.181909
0.2335 --- loss: 1.066161, loss_ss: 0.961785, loss_d: 0.104376
0.3113 --- loss: 1.108783, loss_ss: 0.887288, loss_d: 0.221496
0.3891 --- loss: 1.493327, loss_ss: 1.212915, loss_d: 0.280412
0.4669 --- loss: 1.282706, loss_ss: 0.982017, loss_d: 0.300689
0.5447 --- loss: 1.019952, loss_ss: 0.994539, loss_d: 0.025413
0.6226 --- loss: 1.224600, loss_ss: 1.170303, loss_d: 0.054297
0.7004 --- loss: 1.678476, loss_ss: 1.026999, loss_d: 0.651477
0.7782 --- loss: 1.083457, loss_ss: 0.928101, loss_d: 0.155355
0.8560 --- loss: 1.093063, loss_ss: 1.079725, loss_d: 0.013338
0.9339 --- loss: 1.369500, loss_ss: 0.934421, loss_d: 0.435079
Epoch finished! Loss: 1.2418410233221948
Starting epoch 6/10.
0.0000 --- loss: 1.094436, loss_ss: 1.040990, loss_d: 0.053446
0.0778 --- loss: 0.980578, loss_ss: 0.962321, loss_d: 0.018257
0.1556 --- loss: 1.200218, loss_ss: 1.120364, loss_d: 0.079854
0.2335 --- loss: 0.967899, loss_ss: 0.934434, loss_d: 0.033465
0.3113 --- loss: 1.038616, loss_ss: 1.016544, loss_d: 0.022071
0.3891 --- loss: 1.133917, loss_ss: 1.035507, loss_d: 0.098410
0.4669 --- loss: 0.878364, loss_ss: 0.841393, loss_d: 0.036971
0.5447 --- loss: 1.068351, loss_ss: 0.893904, loss_d: 0.174447
0.6226 --- loss: 1.604144, loss_ss: 1.119169, loss_d: 0.484975
0.7004 --- loss: 1.299637, loss_ss: 1.244527, loss_d: 0.055110
0.7782 --- loss: 1.253967, loss_ss: 1.026074, loss_d: 0.227893
0.8560 --- loss: 1.153218, loss_ss: 1.149078, loss_d: 0.004140
0.9339 --- loss: 0.927765, loss_ss: 0.839878, loss_d: 0.087888
Epoch finished! Loss: 1.126605295110494
Starting epoch 7/10.
0.0000 --- loss: 0.851979, loss_ss: 0.817569, loss_d: 0.034410
0.0778 --- loss: 0.913789, loss_ss: 0.859698, loss_d: 0.054091
0.1556 --- loss: 0.883651, loss_ss: 0.835522, loss_d: 0.048130
0.2335 --- loss: 1.265539, loss_ss: 1.180091, loss_d: 0.085448
0.3113 --- loss: 1.085069, loss_ss: 0.879692, loss_d: 0.205377
0.3891 --- loss: 1.127962, loss_ss: 1.024700, loss_d: 0.103262
0.4669 --- loss: 1.038598, loss_ss: 0.918052, loss_d: 0.120546
0.5447 --- loss: 1.104239, loss_ss: 0.791299, loss_d: 0.312941
0.6226 --- loss: 1.193402, loss_ss: 0.876648, loss_d: 0.316754
0.7004 --- loss: 1.045299, loss_ss: 0.919153, loss_d: 0.126146
0.7782 --- loss: 1.034161, loss_ss: 0.931850, loss_d: 0.102311
0.8560 --- loss: 0.933272, loss_ss: 0.908890, loss_d: 0.024382
0.9339 --- loss: 0.988569, loss_ss: 0.896754, loss_d: 0.091815
Epoch finished! Loss: 1.1008413429372013
Starting epoch 8/10.
0.0000 --- loss: 0.951674, loss_ss: 0.940895, loss_d: 0.010778
0.0778 --- loss: 1.225813, loss_ss: 1.205577, loss_d: 0.020237
0.1556 --- loss: 0.875393, loss_ss: 0.858717, loss_d: 0.016676
0.2335 --- loss: 1.086821, loss_ss: 1.074013, loss_d: 0.012809
0.3113 --- loss: 0.930681, loss_ss: 0.881446, loss_d: 0.049236
0.3891 --- loss: 1.078043, loss_ss: 0.863749, loss_d: 0.214294
0.4669 --- loss: 1.013192, loss_ss: 0.998934, loss_d: 0.014258
0.5447 --- loss: 0.960615, loss_ss: 0.928265, loss_d: 0.032351
0.6226 --- loss: 0.867599, loss_ss: 0.821945, loss_d: 0.045655
0.7004 --- loss: 0.824180, loss_ss: 0.818928, loss_d: 0.005252
0.7782 --- loss: 0.813622, loss_ss: 0.805924, loss_d: 0.007699
0.8560 --- loss: 0.810622, loss_ss: 0.802807, loss_d: 0.007815
0.9339 --- loss: 1.069314, loss_ss: 0.958131, loss_d: 0.111183
Epoch finished! Loss: 0.9898474873043597
Starting epoch 9/10.
0.0000 --- loss: 0.958771, loss_ss: 0.955314, loss_d: 0.003457
0.0778 --- loss: 1.151639, loss_ss: 1.036750, loss_d: 0.114888
0.1556 --- loss: 0.984738, loss_ss: 0.983541, loss_d: 0.001197
0.2335 --- loss: 1.252791, loss_ss: 0.948950, loss_d: 0.303841
0.3113 --- loss: 1.145915, loss_ss: 0.882496, loss_d: 0.263419
0.3891 --- loss: 0.996449, loss_ss: 0.990488, loss_d: 0.005961
0.4669 --- loss: 1.039047, loss_ss: 0.734005, loss_d: 0.305042
0.5447 --- loss: 1.208594, loss_ss: 0.834205, loss_d: 0.374389
0.6226 --- loss: 0.970430, loss_ss: 0.961503, loss_d: 0.008927
0.7004 --- loss: 0.815553, loss_ss: 0.805041, loss_d: 0.010512
0.7782 --- loss: 1.245682, loss_ss: 1.221980, loss_d: 0.023703
0.8560 --- loss: 0.785771, loss_ss: 0.770176, loss_d: 0.015595
0.9339 --- loss: 0.719506, loss_ss: 0.706680, loss_d: 0.012827
Epoch finished! Loss: 0.9787528393790126
Starting epoch 10/10.
0.0000 --- loss: 0.693727, loss_ss: 0.689713, loss_d: 0.004014
0.0778 --- loss: 1.349700, loss_ss: 1.321300, loss_d: 0.028400
0.1556 --- loss: 0.851495, loss_ss: 0.844362, loss_d: 0.007133
0.2335 --- loss: 1.069721, loss_ss: 1.057160, loss_d: 0.012561
0.3113 --- loss: 0.879810, loss_ss: 0.686486, loss_d: 0.193325
0.3891 --- loss: 0.842925, loss_ss: 0.814394, loss_d: 0.028531
0.4669 --- loss: 1.119878, loss_ss: 1.006125, loss_d: 0.113753
0.5447 --- loss: 1.093505, loss_ss: 1.078923, loss_d: 0.014582
0.6226 --- loss: 0.797706, loss_ss: 0.793800, loss_d: 0.003906
0.7004 --- loss: 0.773133, loss_ss: 0.768846, loss_d: 0.004287
0.7782 --- loss: 0.960362, loss_ss: 0.957385, loss_d: 0.002977
0.8560 --- loss: 0.868333, loss_ss: 0.802528, loss_d: 0.065805
0.9339 --- loss: 0.939808, loss_ss: 0.931434, loss_d: 0.008374
Epoch finished! Loss: 0.9608172178268433
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6777777777777778
             precision    recall  f1-score   support

        0.0       0.73      0.77      0.75        69
        1.0       0.25      0.66      0.36        38
        2.0       0.76      0.62      0.68       410
        3.0       1.00      0.62      0.76       228
        4.0       0.54      0.89      0.67       155

avg / total       0.76      0.68      0.69       900
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.00  76.81   97.59   72.60     74.65
1  90.33  65.79   91.42   25.25     36.50
2  73.78  61.71   83.88   76.20     68.19
3  90.33  61.84  100.00  100.00     76.42
4  85.11  89.03   84.30   54.12     67.32
Total accuracy: 67.78%
Average sen: 71.04%
Average spec: 91.44%
Macro f1-score: 64.62%
Diagnosis acc on 30mins: 0.0
[0.79746485 0.9878     0.9994722  0.99625397 0.99579406 0.99106479
 0.81097752 0.99275523 0.99743986 0.99524862 0.9850927  0.99173814
 0.99785691 0.98725688 0.99212897]
pred: 0.967889646689097, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc013-nsrr

=== Test on chc014-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.299717, loss_ss: 1.619677, loss_d: 0.680041
0.0778 --- loss: 2.020173, loss_ss: 1.521706, loss_d: 0.498467
0.1556 --- loss: 1.910484, loss_ss: 1.468369, loss_d: 0.442115
0.2335 --- loss: 2.022776, loss_ss: 1.388070, loss_d: 0.634706
0.3113 --- loss: 1.883557, loss_ss: 1.429299, loss_d: 0.454258
0.3891 --- loss: 1.836814, loss_ss: 1.409505, loss_d: 0.427310
0.4669 --- loss: 1.982176, loss_ss: 1.347314, loss_d: 0.634862
0.5447 --- loss: 1.851634, loss_ss: 1.389758, loss_d: 0.461876
0.6226 --- loss: 1.905448, loss_ss: 1.272113, loss_d: 0.633335
0.7004 --- loss: 1.721832, loss_ss: 1.190743, loss_d: 0.531089
0.7782 --- loss: 1.733633, loss_ss: 1.288217, loss_d: 0.445416
0.8560 --- loss: 1.748342, loss_ss: 1.212228, loss_d: 0.536114
0.9339 --- loss: 1.825370, loss_ss: 1.267190, loss_d: 0.558180
Epoch finished! Loss: 1.957681292667985
Starting epoch 2/10.
0.0000 --- loss: 2.051985, loss_ss: 1.409863, loss_d: 0.642122
0.0778 --- loss: 1.621944, loss_ss: 1.147807, loss_d: 0.474137
0.1556 --- loss: 1.455505, loss_ss: 1.136024, loss_d: 0.319481
0.2335 --- loss: 1.628823, loss_ss: 1.118585, loss_d: 0.510238
0.3113 --- loss: 1.834617, loss_ss: 1.382908, loss_d: 0.451709
0.3891 --- loss: 1.459194, loss_ss: 1.060662, loss_d: 0.398533
0.4669 --- loss: 1.729058, loss_ss: 1.129965, loss_d: 0.599093
0.5447 --- loss: 1.587682, loss_ss: 1.236883, loss_d: 0.350798
0.6226 --- loss: 1.982907, loss_ss: 1.150917, loss_d: 0.831990
0.7004 --- loss: 1.578473, loss_ss: 1.061780, loss_d: 0.516693
0.7782 --- loss: 1.647055, loss_ss: 0.988470, loss_d: 0.658585
0.8560 --- loss: 1.541908, loss_ss: 1.203621, loss_d: 0.338287
0.9339 --- loss: 1.399380, loss_ss: 1.133208, loss_d: 0.266173
Epoch finished! Loss: 1.6528647309169173
Starting epoch 3/10.
0.0000 --- loss: 1.562166, loss_ss: 1.039443, loss_d: 0.522723
0.0778 --- loss: 1.680905, loss_ss: 1.431395, loss_d: 0.249510
0.1556 --- loss: 1.579210, loss_ss: 1.204038, loss_d: 0.375172
0.2335 --- loss: 1.322188, loss_ss: 1.032923, loss_d: 0.289264
0.3113 --- loss: 1.159846, loss_ss: 0.968051, loss_d: 0.191795
0.3891 --- loss: 1.238294, loss_ss: 1.055601, loss_d: 0.182692
0.4669 --- loss: 1.282095, loss_ss: 1.099442, loss_d: 0.182653
0.5447 --- loss: 1.361164, loss_ss: 1.076260, loss_d: 0.284905
0.6226 --- loss: 1.581797, loss_ss: 1.101985, loss_d: 0.479813
0.7004 --- loss: 1.410038, loss_ss: 1.190478, loss_d: 0.219560
0.7782 --- loss: 1.270463, loss_ss: 1.073566, loss_d: 0.196896
0.8560 --- loss: 1.477805, loss_ss: 0.895694, loss_d: 0.582112
0.9339 --- loss: 1.535432, loss_ss: 1.005131, loss_d: 0.530301
Epoch finished! Loss: 1.4136759690009058
Starting epoch 4/10.
0.0000 --- loss: 1.223741, loss_ss: 0.818990, loss_d: 0.404751
0.0778 --- loss: 1.010750, loss_ss: 0.915692, loss_d: 0.095058
0.1556 --- loss: 1.272997, loss_ss: 1.056404, loss_d: 0.216593
0.2335 --- loss: 1.224017, loss_ss: 0.996386, loss_d: 0.227630
0.3113 --- loss: 1.475553, loss_ss: 0.909570, loss_d: 0.565983
0.3891 --- loss: 1.127730, loss_ss: 0.924383, loss_d: 0.203348
0.4669 --- loss: 1.256044, loss_ss: 1.077101, loss_d: 0.178943
0.5447 --- loss: 1.655529, loss_ss: 1.513558, loss_d: 0.141971
0.6226 --- loss: 1.558053, loss_ss: 0.747940, loss_d: 0.810113
0.7004 --- loss: 1.140770, loss_ss: 1.060466, loss_d: 0.080304
0.7782 --- loss: 1.242427, loss_ss: 1.158313, loss_d: 0.084113
0.8560 --- loss: 1.996534, loss_ss: 0.824982, loss_d: 1.171552
0.9339 --- loss: 1.142691, loss_ss: 1.025797, loss_d: 0.116894
Epoch finished! Loss: 1.2538153482601047
Starting epoch 5/10.
0.0000 --- loss: 1.175491, loss_ss: 1.062085, loss_d: 0.113406
0.0778 --- loss: 1.051939, loss_ss: 0.925126, loss_d: 0.126813
0.1556 --- loss: 1.434511, loss_ss: 1.069671, loss_d: 0.364841
0.2335 --- loss: 0.850252, loss_ss: 0.809306, loss_d: 0.040946
0.3113 --- loss: 1.246644, loss_ss: 0.958480, loss_d: 0.288164
0.3891 --- loss: 1.020513, loss_ss: 0.924540, loss_d: 0.095973
0.4669 --- loss: 1.147130, loss_ss: 1.024745, loss_d: 0.122386
0.5447 --- loss: 1.085726, loss_ss: 1.020015, loss_d: 0.065711
0.6226 --- loss: 0.984954, loss_ss: 0.860617, loss_d: 0.124337
0.7004 --- loss: 0.823979, loss_ss: 0.784456, loss_d: 0.039523
0.7782 --- loss: 0.858374, loss_ss: 0.752640, loss_d: 0.105734
0.8560 --- loss: 1.608397, loss_ss: 0.848455, loss_d: 0.759942
0.9339 --- loss: 1.475365, loss_ss: 0.861778, loss_d: 0.613586
Epoch finished! Loss: 1.1298413113690913
Starting epoch 6/10.
0.0000 --- loss: 0.880334, loss_ss: 0.755732, loss_d: 0.124602
0.0778 --- loss: 1.083647, loss_ss: 0.918056, loss_d: 0.165590
0.1556 --- loss: 1.151829, loss_ss: 0.856632, loss_d: 0.295197
0.2335 --- loss: 1.015103, loss_ss: 0.958029, loss_d: 0.057074
0.3113 --- loss: 0.908329, loss_ss: 0.885637, loss_d: 0.022692
0.3891 --- loss: 1.064854, loss_ss: 1.043821, loss_d: 0.021032
0.4669 --- loss: 0.977397, loss_ss: 0.917139, loss_d: 0.060258
0.5447 --- loss: 1.027574, loss_ss: 0.966419, loss_d: 0.061154
0.6226 --- loss: 1.245718, loss_ss: 0.732369, loss_d: 0.513349
0.7004 --- loss: 0.929601, loss_ss: 0.864923, loss_d: 0.064678
0.7782 --- loss: 0.913420, loss_ss: 0.893679, loss_d: 0.019741
0.8560 --- loss: 1.153071, loss_ss: 0.977010, loss_d: 0.176061
0.9339 --- loss: 1.098874, loss_ss: 0.957505, loss_d: 0.141369
Epoch finished! Loss: 1.0632528029382229
Starting epoch 7/10.
0.0000 --- loss: 0.769441, loss_ss: 0.724737, loss_d: 0.044704
0.0778 --- loss: 1.273728, loss_ss: 0.809488, loss_d: 0.464240
0.1556 --- loss: 1.340440, loss_ss: 1.305481, loss_d: 0.034959
0.2335 --- loss: 0.910753, loss_ss: 0.824549, loss_d: 0.086204
0.3113 --- loss: 1.057275, loss_ss: 0.834430, loss_d: 0.222845
0.3891 --- loss: 0.755014, loss_ss: 0.720567, loss_d: 0.034447
0.4669 --- loss: 1.049766, loss_ss: 1.046133, loss_d: 0.003633
0.5447 --- loss: 0.688595, loss_ss: 0.675222, loss_d: 0.013373
0.6226 --- loss: 0.982158, loss_ss: 0.845426, loss_d: 0.136733
0.7004 --- loss: 0.729956, loss_ss: 0.663274, loss_d: 0.066682
0.7782 --- loss: 0.923580, loss_ss: 0.884774, loss_d: 0.038806
0.8560 --- loss: 0.724945, loss_ss: 0.670841, loss_d: 0.054104
0.9339 --- loss: 0.985692, loss_ss: 0.949647, loss_d: 0.036045
Epoch finished! Loss: 0.9759015790186822
Starting epoch 8/10.
0.0000 --- loss: 0.814666, loss_ss: 0.760637, loss_d: 0.054030
0.0778 --- loss: 0.872620, loss_ss: 0.773379, loss_d: 0.099241
0.1556 --- loss: 1.243735, loss_ss: 0.818324, loss_d: 0.425411
0.2335 --- loss: 0.662281, loss_ss: 0.649664, loss_d: 0.012617
0.3113 --- loss: 0.822808, loss_ss: 0.812391, loss_d: 0.010417
0.3891 --- loss: 0.797606, loss_ss: 0.773700, loss_d: 0.023906
0.4669 --- loss: 0.737164, loss_ss: 0.733550, loss_d: 0.003614
0.5447 --- loss: 0.936965, loss_ss: 0.925037, loss_d: 0.011927
0.6226 --- loss: 0.970148, loss_ss: 0.885179, loss_d: 0.084969
0.7004 --- loss: 1.071361, loss_ss: 0.944313, loss_d: 0.127049
0.7782 --- loss: 1.233614, loss_ss: 0.962352, loss_d: 0.271262
0.8560 --- loss: 0.846986, loss_ss: 0.835591, loss_d: 0.011395
0.9339 --- loss: 1.024231, loss_ss: 0.963724, loss_d: 0.060507
Epoch finished! Loss: 0.9627641807310283
Starting epoch 9/10.
0.0000 --- loss: 0.770692, loss_ss: 0.758136, loss_d: 0.012556
0.0778 --- loss: 0.867339, loss_ss: 0.799556, loss_d: 0.067783
0.1556 --- loss: 0.894508, loss_ss: 0.884154, loss_d: 0.010354
0.2335 --- loss: 1.847284, loss_ss: 1.237299, loss_d: 0.609985
0.3113 --- loss: 0.777036, loss_ss: 0.768659, loss_d: 0.008378
0.3891 --- loss: 0.806385, loss_ss: 0.761545, loss_d: 0.044840
0.4669 --- loss: 1.016090, loss_ss: 1.000059, loss_d: 0.016031
0.5447 --- loss: 0.644154, loss_ss: 0.640838, loss_d: 0.003315
0.6226 --- loss: 1.254945, loss_ss: 1.086787, loss_d: 0.168158
0.7004 --- loss: 0.770029, loss_ss: 0.712985, loss_d: 0.057044
0.7782 --- loss: 1.010935, loss_ss: 1.005054, loss_d: 0.005881
0.8560 --- loss: 1.058488, loss_ss: 0.758724, loss_d: 0.299764
0.9339 --- loss: 1.236658, loss_ss: 1.124237, loss_d: 0.112421
Epoch finished! Loss: 0.9496883344836533
Starting epoch 10/10.
0.0000 --- loss: 0.688305, loss_ss: 0.686577, loss_d: 0.001729
0.0778 --- loss: 1.054337, loss_ss: 1.006806, loss_d: 0.047531
0.1556 --- loss: 0.966414, loss_ss: 0.794409, loss_d: 0.172005
0.2335 --- loss: 0.847732, loss_ss: 0.799786, loss_d: 0.047946
0.3113 --- loss: 0.911814, loss_ss: 0.889427, loss_d: 0.022386
0.3891 --- loss: 1.290691, loss_ss: 1.277822, loss_d: 0.012869
0.4669 --- loss: 0.771657, loss_ss: 0.764982, loss_d: 0.006675
0.5447 --- loss: 1.072374, loss_ss: 0.859729, loss_d: 0.212646
0.6226 --- loss: 0.901745, loss_ss: 0.864814, loss_d: 0.036931
0.7004 --- loss: 0.982843, loss_ss: 0.979529, loss_d: 0.003314
0.7782 --- loss: 0.726444, loss_ss: 0.725778, loss_d: 0.000666
0.8560 --- loss: 1.003255, loss_ss: 1.002759, loss_d: 0.000496
0.9339 --- loss: 0.789075, loss_ss: 0.777696, loss_d: 0.011380
Epoch finished! Loss: 0.8939605453051627
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.89
             precision    recall  f1-score   support

        0.0       1.00      1.00      1.00       240
        1.0       0.26      0.83      0.40         6
        2.0       0.91      0.86      0.89       436
        3.0       0.96      0.76      0.84       143
        4.0       0.62      0.97      0.76        75

avg / total       0.91      0.89      0.90       900
 


====== chc014-nsrr ======
    acc %   sen %  spec %   ppr %  f1-score
0  100.00  100.00  100.00  100.00    100.00
1   98.33   83.33   98.43   26.32     40.00
2   89.22   86.01   92.24   91.24     88.55
3   95.56   75.52   99.34   95.58     84.37
4   94.89   97.33   94.67   62.39     76.04
Total accuracy: 89.00%
Average sen: 88.44%
Average spec: 96.94%
Macro f1-score: 77.79%
Diagnosis acc on 30mins: 0.9333333333333333
[0.00112927 0.40912175 0.22920932 0.04515294 0.00497248 0.01762797
 0.00232009 0.11932025 0.00622855 0.00199927 0.01388937 0.00659063
 0.95842266 0.01867058 0.00694414]
pred: 0.12277328507819524, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc014-nsrr

=== Test on chc015-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.401008, loss_ss: 1.642480, loss_d: 0.758527
0.0778 --- loss: 2.173458, loss_ss: 1.559014, loss_d: 0.614444
0.1556 --- loss: 2.153465, loss_ss: 1.477802, loss_d: 0.675663
0.2335 --- loss: 1.983925, loss_ss: 1.435403, loss_d: 0.548523
0.3113 --- loss: 1.912355, loss_ss: 1.400029, loss_d: 0.512326
0.3891 --- loss: 1.904896, loss_ss: 1.434363, loss_d: 0.470533
0.4669 --- loss: 1.606994, loss_ss: 1.342246, loss_d: 0.264748
0.5447 --- loss: 2.046274, loss_ss: 1.434077, loss_d: 0.612196
0.6226 --- loss: 1.989209, loss_ss: 1.258016, loss_d: 0.731192
0.7004 --- loss: 1.960518, loss_ss: 1.398997, loss_d: 0.561521
0.7782 --- loss: 1.858078, loss_ss: 1.277563, loss_d: 0.580516
0.8560 --- loss: 1.729501, loss_ss: 1.222671, loss_d: 0.506830
0.9339 --- loss: 2.158546, loss_ss: 1.337352, loss_d: 0.821194
Epoch finished! Loss: 1.974667251110077
Starting epoch 2/10.
0.0000 --- loss: 1.836275, loss_ss: 1.295663, loss_d: 0.540612
0.0778 --- loss: 2.242617, loss_ss: 1.295822, loss_d: 0.946796
0.1556 --- loss: 1.606131, loss_ss: 1.159426, loss_d: 0.446706
0.2335 --- loss: 1.686051, loss_ss: 1.169306, loss_d: 0.516745
0.3113 --- loss: 1.650193, loss_ss: 1.324173, loss_d: 0.326021
0.3891 --- loss: 1.827449, loss_ss: 1.344170, loss_d: 0.483279
0.4669 --- loss: 1.620280, loss_ss: 1.192019, loss_d: 0.428261
0.5447 --- loss: 1.469355, loss_ss: 1.154426, loss_d: 0.314928
0.6226 --- loss: 1.429120, loss_ss: 1.159473, loss_d: 0.269647
0.7004 --- loss: 1.405160, loss_ss: 1.142069, loss_d: 0.263091
0.7782 --- loss: 1.727819, loss_ss: 1.267198, loss_d: 0.460621
0.8560 --- loss: 1.546693, loss_ss: 1.121441, loss_d: 0.425253
0.9339 --- loss: 1.461316, loss_ss: 1.163745, loss_d: 0.297571
Epoch finished! Loss: 1.6444806000217795
Starting epoch 3/10.
0.0000 --- loss: 1.919388, loss_ss: 1.247203, loss_d: 0.672186
0.0778 --- loss: 1.595185, loss_ss: 1.184098, loss_d: 0.411086
0.1556 --- loss: 1.507398, loss_ss: 1.244454, loss_d: 0.262944
0.2335 --- loss: 1.285912, loss_ss: 1.034333, loss_d: 0.251579
0.3113 --- loss: 1.556355, loss_ss: 0.997178, loss_d: 0.559177
0.3891 --- loss: 1.267036, loss_ss: 1.057574, loss_d: 0.209462
0.4669 --- loss: 1.342103, loss_ss: 1.061376, loss_d: 0.280727
0.5447 --- loss: 1.188171, loss_ss: 1.028723, loss_d: 0.159448
0.6226 --- loss: 1.414069, loss_ss: 1.111109, loss_d: 0.302961
0.7004 --- loss: 1.126902, loss_ss: 0.848591, loss_d: 0.278311
0.7782 --- loss: 1.694697, loss_ss: 1.308816, loss_d: 0.385882
0.8560 --- loss: 1.236493, loss_ss: 1.059876, loss_d: 0.176617
0.9339 --- loss: 1.324660, loss_ss: 0.964991, loss_d: 0.359669
Epoch finished! Loss: 1.4159165369346738
Starting epoch 4/10.
0.0000 --- loss: 1.190049, loss_ss: 0.961029, loss_d: 0.229020
0.0778 --- loss: 1.111371, loss_ss: 1.068460, loss_d: 0.042911
0.1556 --- loss: 1.071258, loss_ss: 0.979212, loss_d: 0.092046
0.2335 --- loss: 1.346205, loss_ss: 1.302855, loss_d: 0.043349
0.3113 --- loss: 1.199466, loss_ss: 0.959609, loss_d: 0.239857
0.3891 --- loss: 1.189774, loss_ss: 0.859269, loss_d: 0.330504
0.4669 --- loss: 1.303558, loss_ss: 0.963370, loss_d: 0.340187
0.5447 --- loss: 1.236766, loss_ss: 1.068015, loss_d: 0.168751
0.6226 --- loss: 1.371445, loss_ss: 1.260688, loss_d: 0.110757
0.7004 --- loss: 1.221201, loss_ss: 1.126941, loss_d: 0.094260
0.7782 --- loss: 1.142129, loss_ss: 1.104487, loss_d: 0.037643
0.8560 --- loss: 0.894584, loss_ss: 0.807392, loss_d: 0.087192
0.9339 --- loss: 1.076808, loss_ss: 0.855487, loss_d: 0.221321
Epoch finished! Loss: 1.2515148622915149
Starting epoch 5/10.
0.0000 --- loss: 1.293431, loss_ss: 0.979638, loss_d: 0.313793
0.0778 --- loss: 0.955359, loss_ss: 0.892474, loss_d: 0.062885
0.1556 --- loss: 0.939398, loss_ss: 0.904792, loss_d: 0.034606
0.2335 --- loss: 1.181619, loss_ss: 1.104563, loss_d: 0.077056
0.3113 --- loss: 1.008524, loss_ss: 0.908720, loss_d: 0.099804
0.3891 --- loss: 1.190546, loss_ss: 1.131919, loss_d: 0.058627
0.4669 --- loss: 0.963571, loss_ss: 0.919301, loss_d: 0.044271
0.5447 --- loss: 1.074658, loss_ss: 0.847913, loss_d: 0.226745
0.6226 --- loss: 0.881364, loss_ss: 0.809543, loss_d: 0.071822
0.7004 --- loss: 0.884135, loss_ss: 0.778786, loss_d: 0.105348
0.7782 --- loss: 1.210257, loss_ss: 0.827334, loss_d: 0.382923
0.8560 --- loss: 1.036226, loss_ss: 0.788353, loss_d: 0.247873
0.9339 --- loss: 0.942829, loss_ss: 0.867218, loss_d: 0.075611
Epoch finished! Loss: 1.1358927618712187
Starting epoch 6/10.
0.0000 --- loss: 1.075861, loss_ss: 1.039765, loss_d: 0.036097
0.0778 --- loss: 1.181607, loss_ss: 0.983323, loss_d: 0.198283
0.1556 --- loss: 0.910191, loss_ss: 0.873246, loss_d: 0.036945
0.2335 --- loss: 1.208171, loss_ss: 0.895911, loss_d: 0.312260
0.3113 --- loss: 1.010310, loss_ss: 0.888296, loss_d: 0.122014
0.3891 --- loss: 0.938855, loss_ss: 0.891226, loss_d: 0.047629
0.4669 --- loss: 1.060384, loss_ss: 0.916134, loss_d: 0.144250
0.5447 --- loss: 0.963514, loss_ss: 0.953818, loss_d: 0.009696
0.6226 --- loss: 0.777940, loss_ss: 0.754856, loss_d: 0.023085
0.7004 --- loss: 0.842855, loss_ss: 0.824409, loss_d: 0.018445
0.7782 --- loss: 0.906879, loss_ss: 0.847757, loss_d: 0.059122
0.8560 --- loss: 1.073877, loss_ss: 0.913095, loss_d: 0.160782
0.9339 --- loss: 1.116512, loss_ss: 0.652907, loss_d: 0.463605
Epoch finished! Loss: 1.070414649322629
Starting epoch 7/10.
0.0000 --- loss: 0.974132, loss_ss: 0.909965, loss_d: 0.064167
0.0778 --- loss: 0.936460, loss_ss: 0.882307, loss_d: 0.054152
0.1556 --- loss: 1.069870, loss_ss: 0.920231, loss_d: 0.149639
0.2335 --- loss: 0.846650, loss_ss: 0.825127, loss_d: 0.021523
0.3113 --- loss: 1.136639, loss_ss: 1.017340, loss_d: 0.119299
0.3891 --- loss: 0.975988, loss_ss: 0.948245, loss_d: 0.027743
0.4669 --- loss: 1.377092, loss_ss: 0.994616, loss_d: 0.382476
0.5447 --- loss: 1.169330, loss_ss: 1.156282, loss_d: 0.013048
0.6226 --- loss: 0.988147, loss_ss: 0.913814, loss_d: 0.074333
0.7004 --- loss: 0.891473, loss_ss: 0.880577, loss_d: 0.010896
0.7782 --- loss: 0.938031, loss_ss: 0.886531, loss_d: 0.051500
0.8560 --- loss: 1.710544, loss_ss: 0.836461, loss_d: 0.874084
0.9339 --- loss: 0.757819, loss_ss: 0.747509, loss_d: 0.010309
Epoch finished! Loss: 1.0529125365428627
Starting epoch 8/10.
0.0000 --- loss: 0.925696, loss_ss: 0.914863, loss_d: 0.010833
0.0778 --- loss: 0.879830, loss_ss: 0.870506, loss_d: 0.009324
0.1556 --- loss: 1.041131, loss_ss: 1.000184, loss_d: 0.040946
0.2335 --- loss: 1.126850, loss_ss: 1.087563, loss_d: 0.039288
0.3113 --- loss: 0.909628, loss_ss: 0.904786, loss_d: 0.004842
0.3891 --- loss: 1.023965, loss_ss: 0.982738, loss_d: 0.041227
0.4669 --- loss: 1.503137, loss_ss: 0.899260, loss_d: 0.603876
0.5447 --- loss: 0.845952, loss_ss: 0.831724, loss_d: 0.014228
0.6226 --- loss: 0.800859, loss_ss: 0.713193, loss_d: 0.087666
0.7004 --- loss: 1.018357, loss_ss: 0.992479, loss_d: 0.025878
0.7782 --- loss: 1.017282, loss_ss: 0.943233, loss_d: 0.074049
0.8560 --- loss: 0.946267, loss_ss: 0.902072, loss_d: 0.044195
0.9339 --- loss: 0.808001, loss_ss: 0.780766, loss_d: 0.027234
Epoch finished! Loss: 0.9892358472570777
Starting epoch 9/10.
0.0000 --- loss: 0.956998, loss_ss: 0.953701, loss_d: 0.003297
0.0778 --- loss: 0.946929, loss_ss: 0.937291, loss_d: 0.009638
0.1556 --- loss: 1.005014, loss_ss: 0.941127, loss_d: 0.063887
0.2335 --- loss: 0.968542, loss_ss: 0.952850, loss_d: 0.015692
0.3113 --- loss: 0.797536, loss_ss: 0.794044, loss_d: 0.003492
0.3891 --- loss: 0.978167, loss_ss: 0.968597, loss_d: 0.009571
0.4669 --- loss: 1.133741, loss_ss: 1.130364, loss_d: 0.003378
0.5447 --- loss: 1.057955, loss_ss: 1.049576, loss_d: 0.008379
0.6226 --- loss: 1.286443, loss_ss: 0.976109, loss_d: 0.310334
0.7004 --- loss: 0.912156, loss_ss: 0.886891, loss_d: 0.025265
0.7782 --- loss: 0.970531, loss_ss: 0.900790, loss_d: 0.069741
0.8560 --- loss: 0.870815, loss_ss: 0.848541, loss_d: 0.022274
0.9339 --- loss: 1.075136, loss_ss: 1.008558, loss_d: 0.066577
Epoch finished! Loss: 0.9815978365950286
Starting epoch 10/10.
0.0000 --- loss: 0.965221, loss_ss: 0.943390, loss_d: 0.021832
0.0778 --- loss: 1.097153, loss_ss: 1.029490, loss_d: 0.067663
0.1556 --- loss: 0.898000, loss_ss: 0.833857, loss_d: 0.064143
0.2335 --- loss: 1.171506, loss_ss: 0.772978, loss_d: 0.398528
0.3113 --- loss: 1.085631, loss_ss: 1.017244, loss_d: 0.068387
0.3891 --- loss: 0.884815, loss_ss: 0.876076, loss_d: 0.008739
0.4669 --- loss: 0.790655, loss_ss: 0.782692, loss_d: 0.007962
0.5447 --- loss: 0.924673, loss_ss: 0.902866, loss_d: 0.021807
0.6226 --- loss: 0.880336, loss_ss: 0.875019, loss_d: 0.005317
0.7004 --- loss: 0.968676, loss_ss: 0.922632, loss_d: 0.046044
0.7782 --- loss: 0.844673, loss_ss: 0.834302, loss_d: 0.010372
0.8560 --- loss: 0.817018, loss_ss: 0.815507, loss_d: 0.001511
0.9339 --- loss: 0.719155, loss_ss: 0.716835, loss_d: 0.002320
Epoch finished! Loss: 0.9168069334700704
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7422222222222222
             precision    recall  f1-score   support

        0.0       0.37      0.92      0.53        37
        1.0       0.20      0.05      0.08        82
        2.0       0.76      0.96      0.84       474
        3.0       1.00      0.58      0.73       166
        4.0       0.86      0.57      0.69       141

avg / total       0.75      0.74      0.72       900
 


====== chc015-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.33  91.89   93.40   37.36     53.12
1  89.56   4.88   98.04   20.00      7.84
2  81.44  95.57   65.73   75.63     84.44
3  92.22  57.83  100.00  100.00     73.28
4  91.89  57.45   98.29   86.17     68.94
Total accuracy: 74.22%
Average sen: 61.52%
Average spec: 91.09%
Macro f1-score: 57.52%
Diagnosis acc on 30mins: 0.0
[0.99987483 0.98233217 0.99999988 1.         0.99999964 0.9999969
 0.99999845 1.         1.         0.99999928 0.99999881 1.
 1.         0.9999994  1.        ]
pred: 0.9988132913907369, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc015-nsrr

=== Test on chc016-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.369122, loss_ss: 1.667967, loss_d: 0.701155
0.0778 --- loss: 2.214368, loss_ss: 1.570615, loss_d: 0.643753
0.1556 --- loss: 2.086139, loss_ss: 1.518701, loss_d: 0.567439
0.2335 --- loss: 2.329183, loss_ss: 1.443677, loss_d: 0.885505
0.3113 --- loss: 2.003119, loss_ss: 1.425316, loss_d: 0.577803
0.3891 --- loss: 1.955393, loss_ss: 1.385299, loss_d: 0.570094
0.4669 --- loss: 2.159264, loss_ss: 1.490252, loss_d: 0.669012
0.5447 --- loss: 1.940515, loss_ss: 1.400196, loss_d: 0.540319
0.6226 --- loss: 2.051113, loss_ss: 1.421821, loss_d: 0.629291
0.7004 --- loss: 1.868725, loss_ss: 1.238035, loss_d: 0.630690
0.7782 --- loss: 2.018753, loss_ss: 1.358340, loss_d: 0.660413
0.8560 --- loss: 1.935788, loss_ss: 1.308360, loss_d: 0.627427
0.9339 --- loss: 1.789769, loss_ss: 1.390340, loss_d: 0.399429
Epoch finished! Loss: 2.017885562032461
Starting epoch 2/10.
0.0000 --- loss: 1.836383, loss_ss: 1.334565, loss_d: 0.501817
0.0778 --- loss: 1.859776, loss_ss: 1.271846, loss_d: 0.587930
0.1556 --- loss: 1.696883, loss_ss: 1.238628, loss_d: 0.458254
0.2335 --- loss: 2.077906, loss_ss: 1.248473, loss_d: 0.829433
0.3113 --- loss: 1.995279, loss_ss: 1.280885, loss_d: 0.714394
0.3891 --- loss: 1.707686, loss_ss: 1.366595, loss_d: 0.341090
0.4669 --- loss: 1.578358, loss_ss: 1.183939, loss_d: 0.394419
0.5447 --- loss: 1.738974, loss_ss: 1.313104, loss_d: 0.425870
0.6226 --- loss: 1.391996, loss_ss: 1.110489, loss_d: 0.281507
0.7004 --- loss: 1.450126, loss_ss: 1.113429, loss_d: 0.336696
0.7782 --- loss: 1.620622, loss_ss: 1.220430, loss_d: 0.400191
0.8560 --- loss: 1.696965, loss_ss: 1.527619, loss_d: 0.169346
0.9339 --- loss: 1.284393, loss_ss: 1.169532, loss_d: 0.114861
Epoch finished! Loss: 1.706043622456491
Starting epoch 3/10.
0.0000 --- loss: 1.398435, loss_ss: 1.136535, loss_d: 0.261899
0.0778 --- loss: 1.409603, loss_ss: 1.125888, loss_d: 0.283715
0.1556 --- loss: 1.254148, loss_ss: 1.037801, loss_d: 0.216347
0.2335 --- loss: 1.601111, loss_ss: 1.286842, loss_d: 0.314269
0.3113 --- loss: 1.596141, loss_ss: 1.237382, loss_d: 0.358758
0.3891 --- loss: 1.973410, loss_ss: 1.027066, loss_d: 0.946344
0.4669 --- loss: 1.130851, loss_ss: 1.061887, loss_d: 0.068964
0.5447 --- loss: 1.380261, loss_ss: 1.249690, loss_d: 0.130572
0.6226 --- loss: 1.247948, loss_ss: 1.154916, loss_d: 0.093032
0.7004 --- loss: 1.414956, loss_ss: 1.159576, loss_d: 0.255380
0.7782 --- loss: 1.207680, loss_ss: 1.031222, loss_d: 0.176458
0.8560 --- loss: 1.702759, loss_ss: 1.110106, loss_d: 0.592652
0.9339 --- loss: 1.394814, loss_ss: 1.319715, loss_d: 0.075099
Epoch finished! Loss: 1.430421425960958
Starting epoch 4/10.
0.0000 --- loss: 1.056253, loss_ss: 1.038028, loss_d: 0.018225
0.0778 --- loss: 1.335224, loss_ss: 1.192438, loss_d: 0.142786
0.1556 --- loss: 1.478946, loss_ss: 1.036908, loss_d: 0.442038
0.2335 --- loss: 1.190759, loss_ss: 1.020641, loss_d: 0.170118
0.3113 --- loss: 1.396926, loss_ss: 1.222325, loss_d: 0.174602
0.3891 --- loss: 1.301079, loss_ss: 1.014036, loss_d: 0.287043
0.4669 --- loss: 1.351694, loss_ss: 1.200271, loss_d: 0.151423
0.5447 --- loss: 1.159832, loss_ss: 1.015072, loss_d: 0.144760
0.6226 --- loss: 1.351934, loss_ss: 1.184622, loss_d: 0.167312
0.7004 --- loss: 1.227541, loss_ss: 1.047640, loss_d: 0.179901
0.7782 --- loss: 1.036251, loss_ss: 0.920536, loss_d: 0.115715
0.8560 --- loss: 1.466897, loss_ss: 1.297541, loss_d: 0.169356
0.9339 --- loss: 1.737400, loss_ss: 1.159409, loss_d: 0.577991
Epoch finished! Loss: 1.3539230818860233
Starting epoch 5/10.
0.0000 --- loss: 1.353664, loss_ss: 0.977369, loss_d: 0.376295
0.0778 --- loss: 1.197476, loss_ss: 1.039491, loss_d: 0.157985
0.1556 --- loss: 1.313498, loss_ss: 1.001261, loss_d: 0.312236
0.2335 --- loss: 1.254449, loss_ss: 0.901231, loss_d: 0.353218
0.3113 --- loss: 1.365383, loss_ss: 1.314517, loss_d: 0.050865
0.3891 --- loss: 1.343035, loss_ss: 1.094900, loss_d: 0.248136
0.4669 --- loss: 1.150191, loss_ss: 1.122108, loss_d: 0.028084
0.5447 --- loss: 1.174941, loss_ss: 1.129724, loss_d: 0.045217
0.6226 --- loss: 1.303056, loss_ss: 1.089161, loss_d: 0.213895
0.7004 --- loss: 1.964803, loss_ss: 1.235388, loss_d: 0.729415
0.7782 --- loss: 1.450091, loss_ss: 0.973735, loss_d: 0.476355
0.8560 --- loss: 1.226189, loss_ss: 1.176295, loss_d: 0.049894
0.9339 --- loss: 1.788268, loss_ss: 0.945879, loss_d: 0.842389
Epoch finished! Loss: 1.2487967484630644
Starting epoch 6/10.
0.0000 --- loss: 1.169254, loss_ss: 1.004137, loss_d: 0.165117
0.0778 --- loss: 1.240838, loss_ss: 1.022708, loss_d: 0.218130
0.1556 --- loss: 1.288644, loss_ss: 1.066441, loss_d: 0.222203
0.2335 --- loss: 1.218701, loss_ss: 0.968033, loss_d: 0.250668
0.3113 --- loss: 0.919115, loss_ss: 0.891958, loss_d: 0.027157
0.3891 --- loss: 1.117438, loss_ss: 1.059620, loss_d: 0.057818
0.4669 --- loss: 0.993874, loss_ss: 0.984222, loss_d: 0.009651
0.5447 --- loss: 1.046045, loss_ss: 1.033196, loss_d: 0.012849
0.6226 --- loss: 1.075227, loss_ss: 1.063570, loss_d: 0.011657
0.7004 --- loss: 1.136255, loss_ss: 1.108724, loss_d: 0.027531
0.7782 --- loss: 1.231292, loss_ss: 1.227889, loss_d: 0.003403
0.8560 --- loss: 1.055119, loss_ss: 1.000545, loss_d: 0.054574
0.9339 --- loss: 0.960593, loss_ss: 0.928265, loss_d: 0.032328
Epoch finished! Loss: 1.1536891753785312
Starting epoch 7/10.
0.0000 --- loss: 0.996084, loss_ss: 0.994007, loss_d: 0.002078
0.0778 --- loss: 0.978697, loss_ss: 0.971271, loss_d: 0.007426
0.1556 --- loss: 0.824427, loss_ss: 0.799635, loss_d: 0.024792
0.2335 --- loss: 0.870476, loss_ss: 0.856804, loss_d: 0.013672
0.3113 --- loss: 1.188260, loss_ss: 1.177133, loss_d: 0.011127
0.3891 --- loss: 0.944648, loss_ss: 0.889435, loss_d: 0.055213
0.4669 --- loss: 1.309269, loss_ss: 1.209115, loss_d: 0.100154
0.5447 --- loss: 0.905922, loss_ss: 0.902426, loss_d: 0.003496
0.6226 --- loss: 1.088635, loss_ss: 1.064279, loss_d: 0.024355
0.7004 --- loss: 1.294853, loss_ss: 1.144904, loss_d: 0.149949
0.7782 --- loss: 0.889038, loss_ss: 0.881487, loss_d: 0.007551
0.8560 --- loss: 0.785955, loss_ss: 0.775837, loss_d: 0.010119
0.9339 --- loss: 0.925305, loss_ss: 0.909332, loss_d: 0.015973
Epoch finished! Loss: 1.0678828405216336
Starting epoch 8/10.
0.0000 --- loss: 1.549038, loss_ss: 1.542488, loss_d: 0.006549
0.0778 --- loss: 1.091615, loss_ss: 0.975331, loss_d: 0.116284
0.1556 --- loss: 1.238703, loss_ss: 0.852759, loss_d: 0.385943
0.2335 --- loss: 1.008925, loss_ss: 0.999486, loss_d: 0.009439
0.3113 --- loss: 1.327794, loss_ss: 1.014252, loss_d: 0.313542
0.3891 --- loss: 0.868162, loss_ss: 0.702025, loss_d: 0.166137
0.4669 --- loss: 1.086987, loss_ss: 0.982304, loss_d: 0.104683
0.5447 --- loss: 0.886259, loss_ss: 0.855522, loss_d: 0.030737
0.6226 --- loss: 1.090484, loss_ss: 1.076892, loss_d: 0.013592
0.7004 --- loss: 1.580699, loss_ss: 0.965238, loss_d: 0.615461
0.7782 --- loss: 1.187444, loss_ss: 0.857995, loss_d: 0.329449
0.8560 --- loss: 1.074085, loss_ss: 0.896764, loss_d: 0.177321
0.9339 --- loss: 0.917228, loss_ss: 0.879278, loss_d: 0.037950
Epoch finished! Loss: 1.0964800245128572
Starting epoch 9/10.
0.0000 --- loss: 1.149102, loss_ss: 0.939144, loss_d: 0.209958
0.0778 --- loss: 0.928722, loss_ss: 0.906114, loss_d: 0.022608
0.1556 --- loss: 0.854551, loss_ss: 0.845094, loss_d: 0.009457
0.2335 --- loss: 1.016826, loss_ss: 1.005418, loss_d: 0.011408
0.3113 --- loss: 1.046641, loss_ss: 0.908964, loss_d: 0.137677
0.3891 --- loss: 0.972765, loss_ss: 0.777864, loss_d: 0.194901
0.4669 --- loss: 0.963579, loss_ss: 0.951696, loss_d: 0.011883
0.5447 --- loss: 0.987562, loss_ss: 0.985680, loss_d: 0.001882
0.6226 --- loss: 0.811657, loss_ss: 0.788336, loss_d: 0.023320
0.7004 --- loss: 0.859169, loss_ss: 0.852667, loss_d: 0.006502
0.7782 --- loss: 0.837112, loss_ss: 0.836634, loss_d: 0.000477
0.8560 --- loss: 0.841948, loss_ss: 0.829577, loss_d: 0.012371
0.9339 --- loss: 1.044581, loss_ss: 1.012836, loss_d: 0.031744
Epoch finished! Loss: 1.0215822872705758
Starting epoch 10/10.
0.0000 --- loss: 0.921654, loss_ss: 0.895409, loss_d: 0.026245
0.0778 --- loss: 0.959794, loss_ss: 0.924044, loss_d: 0.035750
0.1556 --- loss: 0.890493, loss_ss: 0.873335, loss_d: 0.017158
0.2335 --- loss: 0.942070, loss_ss: 0.928807, loss_d: 0.013264
0.3113 --- loss: 1.160355, loss_ss: 1.024244, loss_d: 0.136110
0.3891 --- loss: 1.017936, loss_ss: 1.012896, loss_d: 0.005040
0.4669 --- loss: 0.922869, loss_ss: 0.894573, loss_d: 0.028296
0.5447 --- loss: 1.063704, loss_ss: 1.033960, loss_d: 0.029744
0.6226 --- loss: 1.045427, loss_ss: 0.972821, loss_d: 0.072606
0.7004 --- loss: 1.248621, loss_ss: 0.882757, loss_d: 0.365863
0.7782 --- loss: 1.057129, loss_ss: 0.855910, loss_d: 0.201220
0.8560 --- loss: 1.150398, loss_ss: 0.952663, loss_d: 0.197735
0.9339 --- loss: 1.293618, loss_ss: 1.093229, loss_d: 0.200389
Epoch finished! Loss: 1.0165820843540132
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8255555555555556
             precision    recall  f1-score   support

        0.0       0.76      1.00      0.87       226
        1.0       0.00      0.00      0.00        55
        2.0       0.83      0.92      0.87       410
        3.0       1.00      0.55      0.71       108
        4.0       0.91      0.78      0.84       101

avg / total       0.79      0.83      0.79       900
 


====== chc016-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  92.22  100.00   89.61   76.35     86.59
1  93.89    0.00  100.00    0.00      0.00
2  87.78   92.44   83.88   82.75     87.33
3  94.56   54.63  100.00  100.00     70.66
4  96.67   78.22   99.00   90.80     84.04
Total accuracy: 82.56%
Average sen: 65.06%
Average spec: 94.50%
Macro f1-score: 65.72%
Diagnosis acc on 30mins: 0.8666666666666667
[2.37558316e-03 4.47238308e-05 9.24486592e-02 6.73264340e-02
 9.79037257e-04 2.37662089e-03 1.92934892e-03 1.16246603e-01
 1.54669932e-03 9.40358818e-01 6.29860163e-03 6.42176578e-03
 9.66386735e-01 4.25906032e-02 4.08694237e-01]
pred: 0.17706829807551305, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc016-nsrr

=== Test on chc022-nsrr. train_data(1287), test_data(13) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.532941, loss_ss: 1.844293, loss_d: 0.688648
0.0777 --- loss: 1.957994, loss_ss: 1.553054, loss_d: 0.404940
0.1554 --- loss: 2.082974, loss_ss: 1.490900, loss_d: 0.592075
0.2331 --- loss: 2.155353, loss_ss: 1.546698, loss_d: 0.608655
0.3108 --- loss: 2.097748, loss_ss: 1.535645, loss_d: 0.562102
0.3885 --- loss: 2.379346, loss_ss: 1.515293, loss_d: 0.864053
0.4662 --- loss: 2.046510, loss_ss: 1.561239, loss_d: 0.485271
0.5439 --- loss: 2.180129, loss_ss: 1.333198, loss_d: 0.846932
0.6216 --- loss: 1.921052, loss_ss: 1.354867, loss_d: 0.566185
0.6993 --- loss: 2.006268, loss_ss: 1.459023, loss_d: 0.547244
0.7770 --- loss: 1.990144, loss_ss: 1.398464, loss_d: 0.591679
0.8547 --- loss: 1.878762, loss_ss: 1.361437, loss_d: 0.517324
0.9324 --- loss: 1.879154, loss_ss: 1.271291, loss_d: 0.607864
Epoch finished! Loss: 2.100584052503109
Starting epoch 2/10.
0.0000 --- loss: 1.792434, loss_ss: 1.338937, loss_d: 0.453497
0.0777 --- loss: 1.687514, loss_ss: 1.418483, loss_d: 0.269031
0.1554 --- loss: 1.514131, loss_ss: 1.275151, loss_d: 0.238981
0.2331 --- loss: 1.726683, loss_ss: 1.160735, loss_d: 0.565947
0.3108 --- loss: 1.836904, loss_ss: 1.331559, loss_d: 0.505345
0.3885 --- loss: 1.829617, loss_ss: 1.314227, loss_d: 0.515390
0.4662 --- loss: 1.513869, loss_ss: 1.240911, loss_d: 0.272958
0.5439 --- loss: 1.990239, loss_ss: 1.220184, loss_d: 0.770055
0.6216 --- loss: 1.546960, loss_ss: 1.214082, loss_d: 0.332878
0.6993 --- loss: 1.530095, loss_ss: 1.173759, loss_d: 0.356336
0.7770 --- loss: 1.798248, loss_ss: 1.107904, loss_d: 0.690343
0.8547 --- loss: 1.659875, loss_ss: 1.121367, loss_d: 0.538508
0.9324 --- loss: 1.604339, loss_ss: 1.341201, loss_d: 0.263138
Epoch finished! Loss: 1.7213890254497528
Starting epoch 3/10.
0.0000 --- loss: 1.628667, loss_ss: 1.145853, loss_d: 0.482814
0.0777 --- loss: 1.329095, loss_ss: 1.178644, loss_d: 0.150451
0.1554 --- loss: 1.411374, loss_ss: 1.126735, loss_d: 0.284639
0.2331 --- loss: 1.331979, loss_ss: 1.123927, loss_d: 0.208053
0.3108 --- loss: 1.693061, loss_ss: 1.045686, loss_d: 0.647375
0.3885 --- loss: 1.458943, loss_ss: 1.031047, loss_d: 0.427895
0.4662 --- loss: 1.414990, loss_ss: 1.093558, loss_d: 0.321432
0.5439 --- loss: 1.452929, loss_ss: 1.154121, loss_d: 0.298808
0.6216 --- loss: 1.502338, loss_ss: 1.141129, loss_d: 0.361209
0.6993 --- loss: 1.268118, loss_ss: 1.093821, loss_d: 0.174297
0.7770 --- loss: 1.547058, loss_ss: 1.324771, loss_d: 0.222287
0.8547 --- loss: 1.728077, loss_ss: 1.092280, loss_d: 0.635797
0.9324 --- loss: 1.274971, loss_ss: 0.989635, loss_d: 0.285335
Epoch finished! Loss: 1.4354558726772666
Starting epoch 4/10.
0.0000 --- loss: 1.672593, loss_ss: 0.807529, loss_d: 0.865065
0.0777 --- loss: 1.188302, loss_ss: 0.933435, loss_d: 0.254867
0.1554 --- loss: 1.330758, loss_ss: 1.107268, loss_d: 0.223490
0.2331 --- loss: 1.185871, loss_ss: 1.120921, loss_d: 0.064949
0.3108 --- loss: 1.070304, loss_ss: 0.920215, loss_d: 0.150089
0.3885 --- loss: 1.111004, loss_ss: 1.044056, loss_d: 0.066948
0.4662 --- loss: 1.233608, loss_ss: 0.942345, loss_d: 0.291263
0.5439 --- loss: 1.370248, loss_ss: 0.828804, loss_d: 0.541444
0.6216 --- loss: 1.427754, loss_ss: 0.893760, loss_d: 0.533994
0.6993 --- loss: 1.681171, loss_ss: 1.245676, loss_d: 0.435495
0.7770 --- loss: 1.254714, loss_ss: 1.038914, loss_d: 0.215800
0.8547 --- loss: 1.191236, loss_ss: 0.884824, loss_d: 0.306413
0.9324 --- loss: 1.131532, loss_ss: 0.933190, loss_d: 0.198342
Epoch finished! Loss: 1.2331129745580256
Starting epoch 5/10.
0.0000 --- loss: 1.188786, loss_ss: 1.004261, loss_d: 0.184525
0.0777 --- loss: 0.941162, loss_ss: 0.877732, loss_d: 0.063430
0.1554 --- loss: 1.327378, loss_ss: 1.159591, loss_d: 0.167787
0.2331 --- loss: 1.060196, loss_ss: 1.002931, loss_d: 0.057265
0.3108 --- loss: 1.389628, loss_ss: 0.820906, loss_d: 0.568722
0.3885 --- loss: 1.064747, loss_ss: 0.827390, loss_d: 0.237357
0.4662 --- loss: 1.079605, loss_ss: 1.002675, loss_d: 0.076930
0.5439 --- loss: 0.976705, loss_ss: 0.873897, loss_d: 0.102808
0.6216 --- loss: 1.344951, loss_ss: 1.067326, loss_d: 0.277624
0.6993 --- loss: 0.851815, loss_ss: 0.831051, loss_d: 0.020764
0.7770 --- loss: 2.188598, loss_ss: 1.321903, loss_d: 0.866695
0.8547 --- loss: 1.261038, loss_ss: 0.913641, loss_d: 0.347397
0.9324 --- loss: 1.156542, loss_ss: 1.093416, loss_d: 0.063126
Epoch finished! Loss: 1.1648038676939905
Starting epoch 6/10.
0.0000 --- loss: 0.954477, loss_ss: 0.826009, loss_d: 0.128468
0.0777 --- loss: 1.119296, loss_ss: 1.024954, loss_d: 0.094341
0.1554 --- loss: 1.437977, loss_ss: 1.294132, loss_d: 0.143845
0.2331 --- loss: 1.060536, loss_ss: 0.840937, loss_d: 0.219598
0.3108 --- loss: 1.158948, loss_ss: 1.108152, loss_d: 0.050796
0.3885 --- loss: 0.742644, loss_ss: 0.719741, loss_d: 0.022903
0.4662 --- loss: 0.962885, loss_ss: 0.896483, loss_d: 0.066402
0.5439 --- loss: 1.218772, loss_ss: 1.147606, loss_d: 0.071167
0.6216 --- loss: 0.802163, loss_ss: 0.792845, loss_d: 0.009319
0.6993 --- loss: 0.866006, loss_ss: 0.847055, loss_d: 0.018951
0.7770 --- loss: 1.559548, loss_ss: 0.805830, loss_d: 0.753718
0.8547 --- loss: 0.957331, loss_ss: 0.913368, loss_d: 0.043963
0.9324 --- loss: 0.895033, loss_ss: 0.857208, loss_d: 0.037826
Epoch finished! Loss: 1.05378587404266
Starting epoch 7/10.
0.0000 --- loss: 0.873477, loss_ss: 0.856976, loss_d: 0.016501
0.0777 --- loss: 1.039444, loss_ss: 1.027804, loss_d: 0.011640
0.1554 --- loss: 1.443196, loss_ss: 1.006779, loss_d: 0.436416
0.2331 --- loss: 1.249508, loss_ss: 0.964722, loss_d: 0.284786
0.3108 --- loss: 1.117596, loss_ss: 1.102756, loss_d: 0.014840
0.3885 --- loss: 0.844833, loss_ss: 0.817845, loss_d: 0.026988
0.4662 --- loss: 0.961282, loss_ss: 0.839333, loss_d: 0.121948
0.5439 --- loss: 1.126268, loss_ss: 1.035885, loss_d: 0.090382
0.6216 --- loss: 0.958127, loss_ss: 0.838972, loss_d: 0.119155
0.6993 --- loss: 0.978096, loss_ss: 0.861125, loss_d: 0.116971
0.7770 --- loss: 0.946972, loss_ss: 0.881976, loss_d: 0.064996
0.8547 --- loss: 0.854242, loss_ss: 0.835974, loss_d: 0.018268
0.9324 --- loss: 0.942150, loss_ss: 0.869214, loss_d: 0.072936
Epoch finished! Loss: 1.0393867925740778
Starting epoch 8/10.
0.0000 --- loss: 1.160843, loss_ss: 0.859283, loss_d: 0.301560
0.0777 --- loss: 0.994287, loss_ss: 0.923049, loss_d: 0.071238
0.1554 --- loss: 0.854988, loss_ss: 0.824621, loss_d: 0.030367
0.2331 --- loss: 1.195085, loss_ss: 1.097846, loss_d: 0.097240
0.3108 --- loss: 0.752052, loss_ss: 0.740845, loss_d: 0.011206
0.3885 --- loss: 0.934899, loss_ss: 0.905331, loss_d: 0.029568
0.4662 --- loss: 0.894696, loss_ss: 0.833377, loss_d: 0.061319
0.5439 --- loss: 0.823920, loss_ss: 0.817605, loss_d: 0.006314
0.6216 --- loss: 0.681223, loss_ss: 0.659149, loss_d: 0.022075
0.6993 --- loss: 0.906667, loss_ss: 0.891780, loss_d: 0.014887
0.7770 --- loss: 0.953313, loss_ss: 0.853936, loss_d: 0.099377
0.8547 --- loss: 0.806129, loss_ss: 0.805240, loss_d: 0.000889
0.9324 --- loss: 0.721676, loss_ss: 0.719903, loss_d: 0.001773
Epoch finished! Loss: 0.9259918215684593
Starting epoch 9/10.
0.0000 --- loss: 0.726359, loss_ss: 0.681994, loss_d: 0.044365
0.0777 --- loss: 0.846724, loss_ss: 0.802098, loss_d: 0.044626
0.1554 --- loss: 0.853250, loss_ss: 0.642870, loss_d: 0.210381
0.2331 --- loss: 0.850751, loss_ss: 0.846261, loss_d: 0.004490
0.3108 --- loss: 0.959850, loss_ss: 0.953950, loss_d: 0.005901
0.3885 --- loss: 1.028444, loss_ss: 0.953236, loss_d: 0.075208
0.4662 --- loss: 0.898859, loss_ss: 0.732387, loss_d: 0.166472
0.5439 --- loss: 1.084170, loss_ss: 0.931523, loss_d: 0.152647
0.6216 --- loss: 1.024464, loss_ss: 0.989716, loss_d: 0.034747
0.6993 --- loss: 1.068632, loss_ss: 0.989019, loss_d: 0.079613
0.7770 --- loss: 1.534458, loss_ss: 0.802596, loss_d: 0.731862
0.8547 --- loss: 0.985698, loss_ss: 0.947591, loss_d: 0.038107
0.9324 --- loss: 1.053685, loss_ss: 0.973490, loss_d: 0.080194
Epoch finished! Loss: 0.9478991162031889
Starting epoch 10/10.
0.0000 --- loss: 0.990232, loss_ss: 0.982775, loss_d: 0.007457
0.0777 --- loss: 0.811186, loss_ss: 0.796250, loss_d: 0.014936
0.1554 --- loss: 0.982250, loss_ss: 0.834996, loss_d: 0.147254
0.2331 --- loss: 0.761904, loss_ss: 0.756821, loss_d: 0.005083
0.3108 --- loss: 0.700036, loss_ss: 0.586547, loss_d: 0.113489
0.3885 --- loss: 1.211988, loss_ss: 0.855757, loss_d: 0.356231
0.4662 --- loss: 1.015794, loss_ss: 0.906305, loss_d: 0.109489
0.5439 --- loss: 1.168735, loss_ss: 1.130440, loss_d: 0.038294
0.6216 --- loss: 0.991053, loss_ss: 0.744660, loss_d: 0.246394
0.6993 --- loss: 0.893137, loss_ss: 0.885894, loss_d: 0.007243
0.7770 --- loss: 0.777946, loss_ss: 0.744260, loss_d: 0.033685
0.8547 --- loss: 0.833375, loss_ss: 0.832323, loss_d: 0.001052
0.9324 --- loss: 0.796526, loss_ss: 0.780464, loss_d: 0.016062
Epoch finished! Loss: 0.9059056364931166
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8153846153846154
             precision    recall  f1-score   support

        0.0       0.95      0.89      0.92       102
        1.0       0.33      0.20      0.25        10
        2.0       0.79      0.88      0.83       372
        3.0       0.83      0.88      0.86       187
        4.0       0.75      0.47      0.58       109

avg / total       0.81      0.82      0.81       780
 


====== chc022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.95  89.22   99.26  94.79     91.92
1  98.46  20.00   99.48  33.33     25.00
2  83.33  87.90   79.17  79.37     83.42
3  92.95  88.24   94.44  83.33     85.71
4  90.38  46.79   97.47  75.00     57.63
Total accuracy: 81.54%
Average sen: 66.43%
Average spec: 93.96%
Macro f1-score: 68.74%
Diagnosis acc on 30mins: 1.0
[6.83353702e-03 1.83007661e-02 2.06246594e-04 2.41192552e-04
 7.48441496e-04 1.88810354e-05 2.31101201e-03 1.19890634e-03
 3.99421515e-05 1.63189340e-02 1.89085479e-03 4.54774767e-04
 2.97029945e-03]
pred: 0.0039641375664919345, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc022-nsrr

=== Test on chc025-nsrr. train_data(1287), test_data(13) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.421261, loss_ss: 1.693920, loss_d: 0.727341
0.0777 --- loss: 2.279185, loss_ss: 1.566524, loss_d: 0.712661
0.1554 --- loss: 2.155645, loss_ss: 1.471665, loss_d: 0.683980
0.2331 --- loss: 2.057521, loss_ss: 1.414664, loss_d: 0.642857
0.3108 --- loss: 2.143125, loss_ss: 1.442679, loss_d: 0.700445
0.3885 --- loss: 1.932523, loss_ss: 1.435125, loss_d: 0.497397
0.4662 --- loss: 2.048588, loss_ss: 1.439772, loss_d: 0.608816
0.5439 --- loss: 1.827171, loss_ss: 1.317071, loss_d: 0.510100
0.6216 --- loss: 2.025144, loss_ss: 1.407635, loss_d: 0.617509
0.6993 --- loss: 1.828665, loss_ss: 1.370622, loss_d: 0.458043
0.7770 --- loss: 1.948189, loss_ss: 1.399194, loss_d: 0.548995
0.8547 --- loss: 1.803733, loss_ss: 1.381374, loss_d: 0.422360
0.9324 --- loss: 1.700876, loss_ss: 1.246087, loss_d: 0.454789
Epoch finished! Loss: 1.986147303134203
Starting epoch 2/10.
0.0000 --- loss: 1.775947, loss_ss: 1.368187, loss_d: 0.407759
0.0777 --- loss: 1.959092, loss_ss: 1.371333, loss_d: 0.587759
0.1554 --- loss: 1.758380, loss_ss: 1.277741, loss_d: 0.480639
0.2331 --- loss: 1.828004, loss_ss: 1.390979, loss_d: 0.437025
0.3108 --- loss: 1.833750, loss_ss: 1.283542, loss_d: 0.550208
0.3885 --- loss: 1.638303, loss_ss: 1.364050, loss_d: 0.274253
0.4662 --- loss: 1.805613, loss_ss: 1.365286, loss_d: 0.440327
0.5439 --- loss: 1.627473, loss_ss: 1.260062, loss_d: 0.367410
0.6216 --- loss: 1.699244, loss_ss: 1.021994, loss_d: 0.677250
0.6993 --- loss: 1.286493, loss_ss: 1.058220, loss_d: 0.228273
0.7770 --- loss: 1.313769, loss_ss: 1.149405, loss_d: 0.164363
0.8547 --- loss: 1.556576, loss_ss: 1.203275, loss_d: 0.353301
0.9324 --- loss: 1.600766, loss_ss: 1.027043, loss_d: 0.573722
Epoch finished! Loss: 1.6441268660128117
Starting epoch 3/10.
0.0000 --- loss: 1.385417, loss_ss: 1.060540, loss_d: 0.324877
0.0777 --- loss: 1.564909, loss_ss: 1.183608, loss_d: 0.381300
0.1554 --- loss: 1.167220, loss_ss: 1.009879, loss_d: 0.157341
0.2331 --- loss: 1.269160, loss_ss: 1.008986, loss_d: 0.260174
0.3108 --- loss: 1.428532, loss_ss: 1.192547, loss_d: 0.235984
0.3885 --- loss: 1.294924, loss_ss: 1.158191, loss_d: 0.136733
0.4662 --- loss: 1.184310, loss_ss: 0.947209, loss_d: 0.237100
0.5439 --- loss: 1.435727, loss_ss: 1.048672, loss_d: 0.387055
0.6216 --- loss: 1.182957, loss_ss: 1.056040, loss_d: 0.126917
0.6993 --- loss: 1.187385, loss_ss: 1.017545, loss_d: 0.169840
0.7770 --- loss: 1.337770, loss_ss: 1.031928, loss_d: 0.305842
0.8547 --- loss: 1.330344, loss_ss: 0.992106, loss_d: 0.338238
0.9324 --- loss: 1.374380, loss_ss: 1.152338, loss_d: 0.222042
Epoch finished! Loss: 1.4162058848887682
Starting epoch 4/10.
0.0000 --- loss: 1.151505, loss_ss: 0.902673, loss_d: 0.248832
0.0777 --- loss: 1.316234, loss_ss: 0.960179, loss_d: 0.356056
0.1554 --- loss: 1.467974, loss_ss: 1.155540, loss_d: 0.312434
0.2331 --- loss: 1.202449, loss_ss: 1.104509, loss_d: 0.097940
0.3108 --- loss: 1.137688, loss_ss: 0.870622, loss_d: 0.267066
0.3885 --- loss: 1.072714, loss_ss: 1.048047, loss_d: 0.024668
0.4662 --- loss: 1.296919, loss_ss: 1.180982, loss_d: 0.115937
0.5439 --- loss: 1.083008, loss_ss: 0.923541, loss_d: 0.159467
0.6216 --- loss: 0.842320, loss_ss: 0.775134, loss_d: 0.067186
0.6993 --- loss: 1.323175, loss_ss: 0.992503, loss_d: 0.330672
0.7770 --- loss: 1.460406, loss_ss: 0.948739, loss_d: 0.511667
0.8547 --- loss: 1.152753, loss_ss: 0.954239, loss_d: 0.198514
0.9324 --- loss: 1.166046, loss_ss: 0.730728, loss_d: 0.435318
Epoch finished! Loss: 1.2719694036059082
Starting epoch 5/10.
0.0000 --- loss: 1.197797, loss_ss: 0.973196, loss_d: 0.224602
0.0777 --- loss: 0.983536, loss_ss: 0.715604, loss_d: 0.267932
0.1554 --- loss: 0.987125, loss_ss: 0.863405, loss_d: 0.123720
0.2331 --- loss: 1.522238, loss_ss: 1.086816, loss_d: 0.435422
0.3108 --- loss: 1.252549, loss_ss: 1.181576, loss_d: 0.070972
0.3885 --- loss: 0.862741, loss_ss: 0.758659, loss_d: 0.104083
0.4662 --- loss: 1.252327, loss_ss: 0.860635, loss_d: 0.391693
0.5439 --- loss: 1.520936, loss_ss: 1.087011, loss_d: 0.433925
0.6216 --- loss: 0.936722, loss_ss: 0.900283, loss_d: 0.036439
0.6993 --- loss: 1.088624, loss_ss: 0.848969, loss_d: 0.239655
0.7770 --- loss: 1.090966, loss_ss: 1.031265, loss_d: 0.059701
0.8547 --- loss: 1.693021, loss_ss: 0.907504, loss_d: 0.785517
0.9324 --- loss: 1.208122, loss_ss: 0.927475, loss_d: 0.280647
Epoch finished! Loss: 1.147974640596658
Starting epoch 6/10.
0.0000 --- loss: 1.053431, loss_ss: 1.010105, loss_d: 0.043326
0.0777 --- loss: 0.702591, loss_ss: 0.669480, loss_d: 0.033111
0.1554 --- loss: 0.948026, loss_ss: 0.901509, loss_d: 0.046517
0.2331 --- loss: 0.854858, loss_ss: 0.814607, loss_d: 0.040251
0.3108 --- loss: 0.783456, loss_ss: 0.673360, loss_d: 0.110096
0.3885 --- loss: 1.120146, loss_ss: 1.027376, loss_d: 0.092770
0.4662 --- loss: 0.826059, loss_ss: 0.823882, loss_d: 0.002177
0.5439 --- loss: 1.474263, loss_ss: 1.226647, loss_d: 0.247615
0.6216 --- loss: 0.921065, loss_ss: 0.860940, loss_d: 0.060125
0.6993 --- loss: 1.150757, loss_ss: 0.994026, loss_d: 0.156731
0.7770 --- loss: 1.041151, loss_ss: 0.887022, loss_d: 0.154129
0.8547 --- loss: 0.877604, loss_ss: 0.828950, loss_d: 0.048654
0.9324 --- loss: 0.842882, loss_ss: 0.752793, loss_d: 0.090089
Epoch finished! Loss: 1.0516591225750744
Starting epoch 7/10.
0.0000 --- loss: 1.184577, loss_ss: 1.068428, loss_d: 0.116150
0.0777 --- loss: 0.913819, loss_ss: 0.841667, loss_d: 0.072152
0.1554 --- loss: 0.958750, loss_ss: 0.851997, loss_d: 0.106752
0.2331 --- loss: 0.787344, loss_ss: 0.775121, loss_d: 0.012223
0.3108 --- loss: 1.997930, loss_ss: 1.121501, loss_d: 0.876429
0.3885 --- loss: 0.985371, loss_ss: 0.797272, loss_d: 0.188100
0.4662 --- loss: 1.229678, loss_ss: 0.904398, loss_d: 0.325280
0.5439 --- loss: 1.081994, loss_ss: 0.953456, loss_d: 0.128539
0.6216 --- loss: 0.755487, loss_ss: 0.706945, loss_d: 0.048542
0.6993 --- loss: 0.945638, loss_ss: 0.882291, loss_d: 0.063347
0.7770 --- loss: 0.847368, loss_ss: 0.822484, loss_d: 0.024883
0.8547 --- loss: 1.041679, loss_ss: 1.025386, loss_d: 0.016293
0.9324 --- loss: 0.942380, loss_ss: 0.819973, loss_d: 0.122407
Epoch finished! Loss: 1.0313488557003438
Starting epoch 8/10.
0.0000 --- loss: 0.784454, loss_ss: 0.732826, loss_d: 0.051628
0.0777 --- loss: 0.895306, loss_ss: 0.890083, loss_d: 0.005223
0.1554 --- loss: 1.087086, loss_ss: 1.081639, loss_d: 0.005448
0.2331 --- loss: 0.831796, loss_ss: 0.821780, loss_d: 0.010016
0.3108 --- loss: 1.673774, loss_ss: 1.038427, loss_d: 0.635348
0.3885 --- loss: 0.755093, loss_ss: 0.752930, loss_d: 0.002163
0.4662 --- loss: 1.059222, loss_ss: 0.969330, loss_d: 0.089892
0.5439 --- loss: 1.125661, loss_ss: 0.800917, loss_d: 0.324744
0.6216 --- loss: 0.951276, loss_ss: 0.940679, loss_d: 0.010598
0.6993 --- loss: 1.002605, loss_ss: 0.950007, loss_d: 0.052598
0.7770 --- loss: 0.877213, loss_ss: 0.874067, loss_d: 0.003146
0.8547 --- loss: 0.728889, loss_ss: 0.664841, loss_d: 0.064048
0.9324 --- loss: 1.045863, loss_ss: 1.016000, loss_d: 0.029863
Epoch finished! Loss: 0.9641499109566212
Starting epoch 9/10.
0.0000 --- loss: 1.757016, loss_ss: 1.261727, loss_d: 0.495289
0.0777 --- loss: 0.874718, loss_ss: 0.818179, loss_d: 0.056540
0.1554 --- loss: 0.880248, loss_ss: 0.851542, loss_d: 0.028705
0.2331 --- loss: 0.958722, loss_ss: 0.952472, loss_d: 0.006250
0.3108 --- loss: 0.736377, loss_ss: 0.729771, loss_d: 0.006606
0.3885 --- loss: 1.103535, loss_ss: 0.946073, loss_d: 0.157462
0.4662 --- loss: 1.027257, loss_ss: 0.919582, loss_d: 0.107676
0.5439 --- loss: 0.920301, loss_ss: 0.917643, loss_d: 0.002658
0.6216 --- loss: 0.922695, loss_ss: 0.862129, loss_d: 0.060566
0.6993 --- loss: 0.800180, loss_ss: 0.798475, loss_d: 0.001705
0.7770 --- loss: 0.867895, loss_ss: 0.840286, loss_d: 0.027610
0.8547 --- loss: 1.025708, loss_ss: 1.000937, loss_d: 0.024771
0.9324 --- loss: 1.223270, loss_ss: 0.799148, loss_d: 0.424122
Epoch finished! Loss: 0.9555019964464009
Starting epoch 10/10.
0.0000 --- loss: 0.889041, loss_ss: 0.820169, loss_d: 0.068873
0.0777 --- loss: 0.742822, loss_ss: 0.730751, loss_d: 0.012071
0.1554 --- loss: 0.868854, loss_ss: 0.860782, loss_d: 0.008072
0.2331 --- loss: 1.232444, loss_ss: 0.996677, loss_d: 0.235767
0.3108 --- loss: 1.036018, loss_ss: 1.011653, loss_d: 0.024365
0.3885 --- loss: 0.772909, loss_ss: 0.770328, loss_d: 0.002580
0.4662 --- loss: 0.841063, loss_ss: 0.838618, loss_d: 0.002446
0.5439 --- loss: 0.735667, loss_ss: 0.735209, loss_d: 0.000458
0.6216 --- loss: 1.698499, loss_ss: 0.905086, loss_d: 0.793413
0.6993 --- loss: 0.949916, loss_ss: 0.934608, loss_d: 0.015308
0.7770 --- loss: 0.729363, loss_ss: 0.697849, loss_d: 0.031514
0.8547 --- loss: 0.936995, loss_ss: 0.842397, loss_d: 0.094599
0.9324 --- loss: 0.931118, loss_ss: 0.918374, loss_d: 0.012744
Epoch finished! Loss: 0.9205960906110704
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6525641025641026
             precision    recall  f1-score   support

        0.0       0.18      0.19      0.19        21
        1.0       0.22      0.37      0.28        65
        2.0       0.70      0.82      0.76       408
        3.0       0.98      0.47      0.64       114
        4.0       0.78      0.53      0.63       172

avg / total       0.71      0.65      0.66       780
 


====== chc025-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.51  19.05   97.63  18.18     18.60
1  84.10  36.92   88.39  22.43     27.91
2  72.31  82.35   61.29  70.00     75.68
3  92.18  47.37   99.85  98.18     63.91
4  86.41  52.91   95.89  78.45     63.19
Total accuracy: 65.26%
Average sen: 47.72%
Average spec: 88.61%
Macro f1-score: 49.86%
Diagnosis acc on 30mins: 0.7692307692307693
[3.26313436e-01 9.06124711e-01 2.04810515e-01 8.31177711e-01
 5.78647340e-03 2.99504696e-04 3.33048491e-04 1.98708158e-02
 8.04925745e-04 9.25175031e-04 2.94932106e-04 1.75886527e-01
 8.85365784e-01]
pred: 0.2583071969028634, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc025-nsrr

=== Test on chc027-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.297569, loss_ss: 1.620624, loss_d: 0.676944
0.0778 --- loss: 2.148076, loss_ss: 1.494557, loss_d: 0.653520
0.1556 --- loss: 2.257335, loss_ss: 1.658220, loss_d: 0.599115
0.2335 --- loss: 1.749471, loss_ss: 1.353104, loss_d: 0.396367
0.3113 --- loss: 2.130250, loss_ss: 1.518902, loss_d: 0.611348
0.3891 --- loss: 1.871682, loss_ss: 1.287858, loss_d: 0.583824
0.4669 --- loss: 1.904905, loss_ss: 1.404279, loss_d: 0.500626
0.5447 --- loss: 1.916326, loss_ss: 1.417305, loss_d: 0.499021
0.6226 --- loss: 2.263330, loss_ss: 1.345889, loss_d: 0.917442
0.7004 --- loss: 1.739691, loss_ss: 1.283089, loss_d: 0.456603
0.7782 --- loss: 1.780689, loss_ss: 1.265858, loss_d: 0.514831
0.8560 --- loss: 2.062411, loss_ss: 1.368078, loss_d: 0.694333
0.9339 --- loss: 1.828851, loss_ss: 1.243324, loss_d: 0.585527
Epoch finished! Loss: 2.0098830154165626
Starting epoch 2/10.
0.0000 --- loss: 1.703649, loss_ss: 1.213630, loss_d: 0.490018
0.0778 --- loss: 1.738108, loss_ss: 1.129721, loss_d: 0.608387
0.1556 --- loss: 1.746290, loss_ss: 1.180856, loss_d: 0.565434
0.2335 --- loss: 1.803227, loss_ss: 1.170118, loss_d: 0.633110
0.3113 --- loss: 1.674931, loss_ss: 1.176750, loss_d: 0.498181
0.3891 --- loss: 1.463461, loss_ss: 1.210701, loss_d: 0.252760
0.4669 --- loss: 1.938008, loss_ss: 1.216825, loss_d: 0.721183
0.5447 --- loss: 1.785766, loss_ss: 1.259641, loss_d: 0.526126
0.6226 --- loss: 1.723552, loss_ss: 1.202595, loss_d: 0.520957
0.7004 --- loss: 1.782313, loss_ss: 1.244626, loss_d: 0.537687
0.7782 --- loss: 1.715524, loss_ss: 1.106896, loss_d: 0.608628
0.8560 --- loss: 1.652922, loss_ss: 1.192185, loss_d: 0.460737
0.9339 --- loss: 1.565353, loss_ss: 1.190898, loss_d: 0.374455
Epoch finished! Loss: 1.6662349253892899
Starting epoch 3/10.
0.0000 --- loss: 1.698771, loss_ss: 1.246067, loss_d: 0.452704
0.0778 --- loss: 1.296723, loss_ss: 1.130330, loss_d: 0.166393
0.1556 --- loss: 1.428973, loss_ss: 1.148322, loss_d: 0.280651
0.2335 --- loss: 1.257518, loss_ss: 1.058303, loss_d: 0.199214
0.3113 --- loss: 1.489094, loss_ss: 1.221035, loss_d: 0.268058
0.3891 --- loss: 1.437357, loss_ss: 1.250201, loss_d: 0.187156
0.4669 --- loss: 1.318286, loss_ss: 1.166315, loss_d: 0.151971
0.5447 --- loss: 1.149473, loss_ss: 0.974681, loss_d: 0.174792
0.6226 --- loss: 1.494407, loss_ss: 1.148634, loss_d: 0.345773
0.7004 --- loss: 1.274210, loss_ss: 0.947808, loss_d: 0.326402
0.7782 --- loss: 1.526941, loss_ss: 0.952929, loss_d: 0.574011
0.8560 --- loss: 1.297934, loss_ss: 0.975212, loss_d: 0.322722
0.9339 --- loss: 1.422046, loss_ss: 1.092005, loss_d: 0.330040
Epoch finished! Loss: 1.4098581615835428
Starting epoch 4/10.
0.0000 --- loss: 1.272244, loss_ss: 1.136217, loss_d: 0.136026
0.0778 --- loss: 1.233969, loss_ss: 0.985010, loss_d: 0.248959
0.1556 --- loss: 1.032253, loss_ss: 0.977440, loss_d: 0.054813
0.2335 --- loss: 1.376147, loss_ss: 0.974836, loss_d: 0.401311
0.3113 --- loss: 1.213876, loss_ss: 1.024126, loss_d: 0.189750
0.3891 --- loss: 1.656432, loss_ss: 1.007969, loss_d: 0.648463
0.4669 --- loss: 1.152066, loss_ss: 1.050237, loss_d: 0.101829
0.5447 --- loss: 1.214901, loss_ss: 1.052982, loss_d: 0.161919
0.6226 --- loss: 1.427572, loss_ss: 1.170310, loss_d: 0.257262
0.7004 --- loss: 2.054139, loss_ss: 1.217738, loss_d: 0.836401
0.7782 --- loss: 1.404025, loss_ss: 1.280659, loss_d: 0.123366
0.8560 --- loss: 1.276683, loss_ss: 0.907852, loss_d: 0.368832
0.9339 --- loss: 1.205550, loss_ss: 0.890039, loss_d: 0.315511
Epoch finished! Loss: 1.304596932604909
Starting epoch 5/10.
0.0000 --- loss: 1.226596, loss_ss: 1.155233, loss_d: 0.071363
0.0778 --- loss: 1.071535, loss_ss: 1.028509, loss_d: 0.043026
0.1556 --- loss: 1.124918, loss_ss: 0.972423, loss_d: 0.152495
0.2335 --- loss: 1.101068, loss_ss: 0.863876, loss_d: 0.237192
0.3113 --- loss: 1.011626, loss_ss: 0.942551, loss_d: 0.069075
0.3891 --- loss: 1.309856, loss_ss: 1.256925, loss_d: 0.052931
0.4669 --- loss: 1.186163, loss_ss: 1.002807, loss_d: 0.183356
0.5447 --- loss: 1.210288, loss_ss: 1.148842, loss_d: 0.061446
0.6226 --- loss: 0.983312, loss_ss: 0.930095, loss_d: 0.053217
0.7004 --- loss: 1.300613, loss_ss: 1.200274, loss_d: 0.100339
0.7782 --- loss: 1.074530, loss_ss: 0.939077, loss_d: 0.135453
0.8560 --- loss: 1.433434, loss_ss: 0.856539, loss_d: 0.576895
0.9339 --- loss: 1.321421, loss_ss: 1.131138, loss_d: 0.190283
Epoch finished! Loss: 1.1625696453265846
Starting epoch 6/10.
0.0000 --- loss: 1.165711, loss_ss: 1.001782, loss_d: 0.163929
0.0778 --- loss: 1.206260, loss_ss: 1.117234, loss_d: 0.089026
0.1556 --- loss: 0.850990, loss_ss: 0.758092, loss_d: 0.092898
0.2335 --- loss: 1.523112, loss_ss: 1.250062, loss_d: 0.273050
0.3113 --- loss: 1.277998, loss_ss: 1.077002, loss_d: 0.200996
0.3891 --- loss: 1.037624, loss_ss: 0.830387, loss_d: 0.207237
0.4669 --- loss: 1.460603, loss_ss: 0.767687, loss_d: 0.692916
0.5447 --- loss: 0.980433, loss_ss: 0.888197, loss_d: 0.092236
0.6226 --- loss: 1.163332, loss_ss: 1.121819, loss_d: 0.041513
0.7004 --- loss: 1.147207, loss_ss: 1.001833, loss_d: 0.145374
0.7782 --- loss: 1.050095, loss_ss: 1.035273, loss_d: 0.014822
0.8560 --- loss: 0.898086, loss_ss: 0.865993, loss_d: 0.032093
0.9339 --- loss: 1.283310, loss_ss: 1.153019, loss_d: 0.130291
Epoch finished! Loss: 1.106078791897744
Starting epoch 7/10.
0.0000 --- loss: 1.085755, loss_ss: 0.967838, loss_d: 0.117916
0.0778 --- loss: 1.236971, loss_ss: 1.049374, loss_d: 0.187596
0.1556 --- loss: 1.182255, loss_ss: 1.047829, loss_d: 0.134425
0.2335 --- loss: 1.065232, loss_ss: 1.037044, loss_d: 0.028188
0.3113 --- loss: 1.231630, loss_ss: 0.962905, loss_d: 0.268724
0.3891 --- loss: 1.086599, loss_ss: 0.741373, loss_d: 0.345225
0.4669 --- loss: 0.945154, loss_ss: 0.895567, loss_d: 0.049587
0.5447 --- loss: 0.875320, loss_ss: 0.842648, loss_d: 0.032672
0.6226 --- loss: 0.984922, loss_ss: 0.832727, loss_d: 0.152195
0.7004 --- loss: 0.987283, loss_ss: 0.891422, loss_d: 0.095861
0.7782 --- loss: 0.907104, loss_ss: 0.872410, loss_d: 0.034694
0.8560 --- loss: 0.658327, loss_ss: 0.631131, loss_d: 0.027196
0.9339 --- loss: 1.078688, loss_ss: 1.052036, loss_d: 0.026652
Epoch finished! Loss: 1.0403366573154926
Starting epoch 8/10.
0.0000 --- loss: 1.291583, loss_ss: 1.278331, loss_d: 0.013252
0.0778 --- loss: 1.070663, loss_ss: 1.064647, loss_d: 0.006016
0.1556 --- loss: 0.902160, loss_ss: 0.764105, loss_d: 0.138055
0.2335 --- loss: 0.865887, loss_ss: 0.854218, loss_d: 0.011669
0.3113 --- loss: 1.018935, loss_ss: 1.011091, loss_d: 0.007843
0.3891 --- loss: 0.936758, loss_ss: 0.825003, loss_d: 0.111755
0.4669 --- loss: 0.854264, loss_ss: 0.767712, loss_d: 0.086552
0.5447 --- loss: 0.898634, loss_ss: 0.833062, loss_d: 0.065572
0.6226 --- loss: 1.007135, loss_ss: 0.977388, loss_d: 0.029747
0.7004 --- loss: 1.140848, loss_ss: 1.107556, loss_d: 0.033292
0.7782 --- loss: 1.019440, loss_ss: 0.991183, loss_d: 0.028257
0.8560 --- loss: 1.089852, loss_ss: 0.823480, loss_d: 0.266372
0.9339 --- loss: 0.884802, loss_ss: 0.871337, loss_d: 0.013465
Epoch finished! Loss: 1.0123245888389647
Starting epoch 9/10.
0.0000 --- loss: 0.761653, loss_ss: 0.755107, loss_d: 0.006546
0.0778 --- loss: 0.870864, loss_ss: 0.850061, loss_d: 0.020802
0.1556 --- loss: 1.036142, loss_ss: 1.014918, loss_d: 0.021225
0.2335 --- loss: 0.940476, loss_ss: 0.935892, loss_d: 0.004585
0.3113 --- loss: 0.730533, loss_ss: 0.721715, loss_d: 0.008818
0.3891 --- loss: 1.096926, loss_ss: 1.067710, loss_d: 0.029216
0.4669 --- loss: 1.167245, loss_ss: 0.954110, loss_d: 0.213135
0.5447 --- loss: 0.991303, loss_ss: 0.986399, loss_d: 0.004904
0.6226 --- loss: 1.185457, loss_ss: 1.011271, loss_d: 0.174186
0.7004 --- loss: 0.763249, loss_ss: 0.749908, loss_d: 0.013342
0.7782 --- loss: 0.815471, loss_ss: 0.756741, loss_d: 0.058730
0.8560 --- loss: 1.234926, loss_ss: 0.930417, loss_d: 0.304510
0.9339 --- loss: 0.792890, loss_ss: 0.660689, loss_d: 0.132201
Epoch finished! Loss: 0.9464903664775193
Starting epoch 10/10.
0.0000 --- loss: 0.914911, loss_ss: 0.788493, loss_d: 0.126418
0.0778 --- loss: 0.743779, loss_ss: 0.735891, loss_d: 0.007887
0.1556 --- loss: 0.782861, loss_ss: 0.776147, loss_d: 0.006714
0.2335 --- loss: 0.990680, loss_ss: 0.988298, loss_d: 0.002382
0.3113 --- loss: 0.900365, loss_ss: 0.870718, loss_d: 0.029647
0.3891 --- loss: 0.864038, loss_ss: 0.578603, loss_d: 0.285436
0.4669 --- loss: 0.795852, loss_ss: 0.768654, loss_d: 0.027199
0.5447 --- loss: 1.031290, loss_ss: 1.013263, loss_d: 0.018026
0.6226 --- loss: 0.877652, loss_ss: 0.710550, loss_d: 0.167102
0.7004 --- loss: 1.051155, loss_ss: 0.744049, loss_d: 0.307106
0.7782 --- loss: 0.787719, loss_ss: 0.782430, loss_d: 0.005290
0.8560 --- loss: 1.187366, loss_ss: 1.169037, loss_d: 0.018329
0.9339 --- loss: 0.947743, loss_ss: 0.805037, loss_d: 0.142707
Epoch finished! Loss: 0.9481009957380593
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8222222222222222
             precision    recall  f1-score   support

        0.0       0.85      0.97      0.91       277
        1.0       0.27      0.06      0.10        66
        2.0       0.74      0.95      0.83       293
        3.0       1.00      0.72      0.84       189
        4.0       0.96      0.69      0.81        75

avg / total       0.81      0.82      0.80       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.78  96.75   92.46   85.08     90.54
1  91.89   6.06   98.68   26.67      9.88
2  87.33  95.22   83.53   73.61     83.04
3  94.22  72.49  100.00  100.00     84.05
4  97.22  69.33   99.76   96.30     80.62
Total accuracy: 82.22%
Average sen: 67.97%
Average spec: 94.88%
Macro f1-score: 69.62%
Diagnosis acc on 30mins: 0.6666666666666666
[0.42763171 0.14251728 0.04835811 0.03236393 0.25905827 0.01472298
 0.98480046 0.97828019 0.9799785  0.06264433 0.0716892  0.36391282
 0.14914989 0.59890258 0.6555801 ]
pred: 0.3846393577754498, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc027-nsrr

=== Test on chc028-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.473051, loss_ss: 1.762470, loss_d: 0.710582
0.0778 --- loss: 2.257689, loss_ss: 1.655853, loss_d: 0.601836
0.1555 --- loss: 2.134347, loss_ss: 1.650677, loss_d: 0.483670
0.2333 --- loss: 2.071736, loss_ss: 1.543045, loss_d: 0.528690
0.3110 --- loss: 2.088512, loss_ss: 1.610500, loss_d: 0.478012
0.3888 --- loss: 2.057989, loss_ss: 1.497442, loss_d: 0.560546
0.4666 --- loss: 1.900295, loss_ss: 1.451731, loss_d: 0.448564
0.5443 --- loss: 1.898762, loss_ss: 1.462362, loss_d: 0.436400
0.6221 --- loss: 2.253488, loss_ss: 1.391690, loss_d: 0.861798
0.6998 --- loss: 2.184901, loss_ss: 1.477048, loss_d: 0.707852
0.7776 --- loss: 1.791730, loss_ss: 1.360315, loss_d: 0.431415
0.8554 --- loss: 2.086174, loss_ss: 1.263690, loss_d: 0.822484
0.9331 --- loss: 1.849447, loss_ss: 1.378375, loss_d: 0.471073
Epoch finished! Loss: 2.0877451384440064
Starting epoch 2/10.
0.0000 --- loss: 1.823669, loss_ss: 1.456414, loss_d: 0.367256
0.0778 --- loss: 1.776069, loss_ss: 1.367364, loss_d: 0.408705
0.1555 --- loss: 1.975293, loss_ss: 1.324667, loss_d: 0.650626
0.2333 --- loss: 1.964697, loss_ss: 1.512433, loss_d: 0.452264
0.3110 --- loss: 1.810277, loss_ss: 1.370150, loss_d: 0.440127
0.3888 --- loss: 1.946996, loss_ss: 1.346502, loss_d: 0.600494
0.4666 --- loss: 1.580635, loss_ss: 1.353458, loss_d: 0.227177
0.5443 --- loss: 1.653961, loss_ss: 1.356050, loss_d: 0.297911
0.6221 --- loss: 1.771526, loss_ss: 1.245395, loss_d: 0.526131
0.6998 --- loss: 1.405039, loss_ss: 1.230049, loss_d: 0.174989
0.7776 --- loss: 1.593938, loss_ss: 1.233181, loss_d: 0.360757
0.8554 --- loss: 1.719887, loss_ss: 1.179008, loss_d: 0.540879
0.9331 --- loss: 2.611654, loss_ss: 1.242748, loss_d: 1.368906
Epoch finished! Loss: 1.7521283812820911
Starting epoch 3/10.
0.0000 --- loss: 2.191959, loss_ss: 1.394841, loss_d: 0.797117
0.0778 --- loss: 1.389309, loss_ss: 1.238847, loss_d: 0.150463
0.1555 --- loss: 1.859875, loss_ss: 1.270331, loss_d: 0.589544
0.2333 --- loss: 1.384889, loss_ss: 1.188599, loss_d: 0.196290
0.3110 --- loss: 2.177236, loss_ss: 1.278040, loss_d: 0.899196
0.3888 --- loss: 1.464731, loss_ss: 1.367471, loss_d: 0.097260
0.4666 --- loss: 1.481591, loss_ss: 1.125360, loss_d: 0.356231
0.5443 --- loss: 1.521274, loss_ss: 1.238305, loss_d: 0.282969
0.6221 --- loss: 1.776034, loss_ss: 1.338488, loss_d: 0.437546
0.6998 --- loss: 1.323190, loss_ss: 1.247430, loss_d: 0.075760
0.7776 --- loss: 1.460334, loss_ss: 1.180146, loss_d: 0.280188
0.8554 --- loss: 1.568870, loss_ss: 1.151337, loss_d: 0.417533
0.9331 --- loss: 1.370841, loss_ss: 1.196555, loss_d: 0.174286
Epoch finished! Loss: 1.514494625851512
Starting epoch 4/10.
0.0000 --- loss: 1.295853, loss_ss: 1.199095, loss_d: 0.096758
0.0778 --- loss: 1.186081, loss_ss: 1.120544, loss_d: 0.065538
0.1555 --- loss: 1.583223, loss_ss: 1.263007, loss_d: 0.320216
0.2333 --- loss: 1.302991, loss_ss: 1.208953, loss_d: 0.094037
0.3110 --- loss: 1.245151, loss_ss: 1.077836, loss_d: 0.167315
0.3888 --- loss: 1.265811, loss_ss: 1.130199, loss_d: 0.135612
0.4666 --- loss: 1.001553, loss_ss: 0.967323, loss_d: 0.034230
0.5443 --- loss: 1.191670, loss_ss: 1.139873, loss_d: 0.051797
0.6221 --- loss: 1.211508, loss_ss: 1.015492, loss_d: 0.196015
0.6998 --- loss: 1.196922, loss_ss: 1.080137, loss_d: 0.116786
0.7776 --- loss: 1.865119, loss_ss: 1.082554, loss_d: 0.782566
0.8554 --- loss: 1.220632, loss_ss: 1.009582, loss_d: 0.211050
0.9331 --- loss: 1.612809, loss_ss: 0.951057, loss_d: 0.661752
Epoch finished! Loss: 1.3378855367191136
Starting epoch 5/10.
0.0000 --- loss: 1.536690, loss_ss: 1.345770, loss_d: 0.190920
0.0778 --- loss: 1.133272, loss_ss: 0.972469, loss_d: 0.160802
0.1555 --- loss: 1.408876, loss_ss: 0.919027, loss_d: 0.489849
0.2333 --- loss: 1.336164, loss_ss: 1.053802, loss_d: 0.282361
0.3110 --- loss: 1.327754, loss_ss: 0.964372, loss_d: 0.363382
0.3888 --- loss: 1.217787, loss_ss: 1.172398, loss_d: 0.045389
0.4666 --- loss: 1.159465, loss_ss: 1.100429, loss_d: 0.059036
0.5443 --- loss: 1.174059, loss_ss: 1.001960, loss_d: 0.172099
0.6221 --- loss: 1.115015, loss_ss: 1.081214, loss_d: 0.033801
0.6998 --- loss: 1.024222, loss_ss: 0.984367, loss_d: 0.039855
0.7776 --- loss: 1.283514, loss_ss: 0.955573, loss_d: 0.327941
0.8554 --- loss: 1.510990, loss_ss: 1.209185, loss_d: 0.301805
0.9331 --- loss: 1.045265, loss_ss: 0.975217, loss_d: 0.070047
Epoch finished! Loss: 1.2472666478715837
Starting epoch 6/10.
0.0000 --- loss: 1.224068, loss_ss: 1.066749, loss_d: 0.157319
0.0778 --- loss: 1.077487, loss_ss: 1.023552, loss_d: 0.053935
0.1555 --- loss: 0.926659, loss_ss: 0.863151, loss_d: 0.063507
0.2333 --- loss: 0.969388, loss_ss: 0.955709, loss_d: 0.013679
0.3110 --- loss: 0.922441, loss_ss: 0.908049, loss_d: 0.014393
0.3888 --- loss: 1.104001, loss_ss: 1.045006, loss_d: 0.058995
0.4666 --- loss: 0.897397, loss_ss: 0.882512, loss_d: 0.014885
0.5443 --- loss: 0.969844, loss_ss: 0.928108, loss_d: 0.041736
0.6221 --- loss: 1.303935, loss_ss: 1.086548, loss_d: 0.217387
0.6998 --- loss: 0.936834, loss_ss: 0.874657, loss_d: 0.062177
0.7776 --- loss: 1.123017, loss_ss: 1.091592, loss_d: 0.031424
0.8554 --- loss: 1.672582, loss_ss: 0.878623, loss_d: 0.793959
0.9331 --- loss: 0.791165, loss_ss: 0.771022, loss_d: 0.020143
Epoch finished! Loss: 1.1407306073233485
Starting epoch 7/10.
0.0000 --- loss: 1.051799, loss_ss: 0.978386, loss_d: 0.073412
0.0778 --- loss: 0.972146, loss_ss: 0.932799, loss_d: 0.039348
0.1555 --- loss: 1.038123, loss_ss: 0.775425, loss_d: 0.262698
0.2333 --- loss: 0.867314, loss_ss: 0.855257, loss_d: 0.012057
0.3110 --- loss: 1.150731, loss_ss: 1.102784, loss_d: 0.047947
0.3888 --- loss: 1.056657, loss_ss: 1.011643, loss_d: 0.045015
0.4666 --- loss: 1.142852, loss_ss: 1.119695, loss_d: 0.023158
0.5443 --- loss: 0.925606, loss_ss: 0.864637, loss_d: 0.060969
0.6221 --- loss: 0.870572, loss_ss: 0.767343, loss_d: 0.103228
0.6998 --- loss: 1.822038, loss_ss: 0.890402, loss_d: 0.931636
0.7776 --- loss: 1.114344, loss_ss: 1.051343, loss_d: 0.063001
0.8554 --- loss: 0.949352, loss_ss: 0.775198, loss_d: 0.174154
0.9331 --- loss: 0.934757, loss_ss: 0.887656, loss_d: 0.047101
Epoch finished! Loss: 1.105738011188805
Starting epoch 8/10.
0.0000 --- loss: 0.857869, loss_ss: 0.850805, loss_d: 0.007065
0.0778 --- loss: 0.960752, loss_ss: 0.947024, loss_d: 0.013728
0.1555 --- loss: 0.915509, loss_ss: 0.739694, loss_d: 0.175815
0.2333 --- loss: 0.823932, loss_ss: 0.763176, loss_d: 0.060757
0.3110 --- loss: 1.077798, loss_ss: 1.039004, loss_d: 0.038794
0.3888 --- loss: 1.107262, loss_ss: 1.085050, loss_d: 0.022212
0.4666 --- loss: 0.964719, loss_ss: 0.960175, loss_d: 0.004544
0.5443 --- loss: 0.837136, loss_ss: 0.826687, loss_d: 0.010449
0.6221 --- loss: 1.214747, loss_ss: 1.153207, loss_d: 0.061540
0.6998 --- loss: 1.205819, loss_ss: 1.056761, loss_d: 0.149058
0.7776 --- loss: 1.091063, loss_ss: 1.083633, loss_d: 0.007430
0.8554 --- loss: 0.878033, loss_ss: 0.874824, loss_d: 0.003210
0.9331 --- loss: 0.964201, loss_ss: 0.943602, loss_d: 0.020598
Epoch finished! Loss: 1.026897816453129
Starting epoch 9/10.
0.0000 --- loss: 1.199932, loss_ss: 1.135590, loss_d: 0.064342
0.0778 --- loss: 1.224185, loss_ss: 1.207380, loss_d: 0.016805
0.1555 --- loss: 1.037953, loss_ss: 1.031802, loss_d: 0.006151
0.2333 --- loss: 1.049181, loss_ss: 1.013568, loss_d: 0.035613
0.3110 --- loss: 1.009599, loss_ss: 0.998305, loss_d: 0.011294
0.3888 --- loss: 1.023737, loss_ss: 0.943971, loss_d: 0.079766
0.4666 --- loss: 0.927894, loss_ss: 0.901856, loss_d: 0.026038
0.5443 --- loss: 0.853939, loss_ss: 0.825486, loss_d: 0.028454
0.6221 --- loss: 0.979375, loss_ss: 0.917176, loss_d: 0.062198
0.6998 --- loss: 1.366515, loss_ss: 1.006516, loss_d: 0.359999
0.7776 --- loss: 0.776968, loss_ss: 0.772290, loss_d: 0.004678
0.8554 --- loss: 0.994099, loss_ss: 0.865013, loss_d: 0.129086
0.9331 --- loss: 0.946204, loss_ss: 0.890338, loss_d: 0.055865
Epoch finished! Loss: 0.9900360130704939
Starting epoch 10/10.
0.0000 --- loss: 0.793877, loss_ss: 0.785950, loss_d: 0.007927
0.0778 --- loss: 0.949095, loss_ss: 0.766129, loss_d: 0.182966
0.1555 --- loss: 1.089800, loss_ss: 1.083739, loss_d: 0.006062
0.2333 --- loss: 1.108236, loss_ss: 1.094793, loss_d: 0.013443
0.3110 --- loss: 1.191066, loss_ss: 1.142956, loss_d: 0.048110
0.3888 --- loss: 0.981985, loss_ss: 0.949408, loss_d: 0.032577
0.4666 --- loss: 1.097003, loss_ss: 1.076392, loss_d: 0.020611
0.5443 --- loss: 0.886268, loss_ss: 0.864719, loss_d: 0.021549
0.6221 --- loss: 0.783399, loss_ss: 0.775940, loss_d: 0.007458
0.6998 --- loss: 1.160073, loss_ss: 1.143100, loss_d: 0.016973
0.7776 --- loss: 0.931346, loss_ss: 0.927372, loss_d: 0.003974
0.8554 --- loss: 0.991285, loss_ss: 0.941113, loss_d: 0.050172
0.9331 --- loss: 0.845497, loss_ss: 0.840466, loss_d: 0.005030
Epoch finished! Loss: 1.0076899426057935
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7976190476190477
             precision    recall  f1-score   support

        0.0       0.63      1.00      0.77        98
        1.0       0.29      0.04      0.07        50
        2.0       0.89      0.79      0.84       454
        3.0       0.92      0.89      0.90       164
        4.0       0.56      0.86      0.68        74

avg / total       0.80      0.80      0.78       840
 


====== chc028-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  93.10  100.00   92.18  62.82     77.17
1  93.69    4.00   99.37  28.57      7.02
2  83.69   79.30   88.86  89.33     84.01
3  96.31   89.02   98.08  91.82     90.40
4  92.74   86.49   93.34  55.65     67.72
Total accuracy: 79.76%
Average sen: 71.76%
Average spec: 94.37%
Macro f1-score: 65.26%
Diagnosis acc on 30mins: 0.35714285714285715
[0.01175944 0.03534585 0.99740511 0.20211464 0.65910572 0.97048128
 0.72024298 0.88398486 0.36137781 0.95516145 0.94399357 0.46692145
 0.67876422 0.9295522 ]
pred: 0.6297293267478901, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc028-nsrr

=== Test on chc033-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.599660, loss_ss: 1.855834, loss_d: 0.743826
0.0778 --- loss: 2.591812, loss_ss: 1.558050, loss_d: 1.033762
0.1555 --- loss: 2.274469, loss_ss: 1.572181, loss_d: 0.702288
0.2333 --- loss: 1.932523, loss_ss: 1.557811, loss_d: 0.374712
0.3110 --- loss: 2.524509, loss_ss: 1.515666, loss_d: 1.008842
0.3888 --- loss: 2.012837, loss_ss: 1.437926, loss_d: 0.574912
0.4666 --- loss: 1.791167, loss_ss: 1.382908, loss_d: 0.408259
0.5443 --- loss: 1.833416, loss_ss: 1.353557, loss_d: 0.479859
0.6221 --- loss: 1.978691, loss_ss: 1.468823, loss_d: 0.509868
0.6998 --- loss: 1.852556, loss_ss: 1.372948, loss_d: 0.479608
0.7776 --- loss: 1.774624, loss_ss: 1.533169, loss_d: 0.241455
0.8554 --- loss: 1.822732, loss_ss: 1.374790, loss_d: 0.447942
0.9331 --- loss: 1.668208, loss_ss: 1.287775, loss_d: 0.380433
Epoch finished! Loss: 2.099440425634384
Starting epoch 2/10.
0.0000 --- loss: 2.187694, loss_ss: 1.458262, loss_d: 0.729432
0.0778 --- loss: 1.898100, loss_ss: 1.317515, loss_d: 0.580585
0.1555 --- loss: 1.849839, loss_ss: 1.246079, loss_d: 0.603760
0.2333 --- loss: 1.699687, loss_ss: 1.304675, loss_d: 0.395012
0.3110 --- loss: 1.426668, loss_ss: 1.232880, loss_d: 0.193789
0.3888 --- loss: 1.557151, loss_ss: 1.324579, loss_d: 0.232572
0.4666 --- loss: 1.773877, loss_ss: 1.211132, loss_d: 0.562745
0.5443 --- loss: 1.741036, loss_ss: 1.175331, loss_d: 0.565705
0.6221 --- loss: 1.545941, loss_ss: 1.276403, loss_d: 0.269538
0.6998 --- loss: 1.636522, loss_ss: 1.125324, loss_d: 0.511198
0.7776 --- loss: 1.887291, loss_ss: 1.358233, loss_d: 0.529058
0.8554 --- loss: 1.705305, loss_ss: 1.105636, loss_d: 0.599668
0.9331 --- loss: 1.697851, loss_ss: 1.126940, loss_d: 0.570911
Epoch finished! Loss: 1.7319763898849487
Starting epoch 3/10.
0.0000 --- loss: 1.622055, loss_ss: 1.142770, loss_d: 0.479285
0.0778 --- loss: 1.334700, loss_ss: 1.188105, loss_d: 0.146595
0.1555 --- loss: 1.348189, loss_ss: 1.043867, loss_d: 0.304322
0.2333 --- loss: 1.430773, loss_ss: 1.099392, loss_d: 0.331382
0.3110 --- loss: 1.460010, loss_ss: 1.252585, loss_d: 0.207425
0.3888 --- loss: 1.417621, loss_ss: 1.216912, loss_d: 0.200709
0.4666 --- loss: 1.241720, loss_ss: 1.078019, loss_d: 0.163701
0.5443 --- loss: 1.821502, loss_ss: 1.401731, loss_d: 0.419770
0.6221 --- loss: 1.288020, loss_ss: 1.167723, loss_d: 0.120297
0.6998 --- loss: 1.360328, loss_ss: 1.154876, loss_d: 0.205452
0.7776 --- loss: 1.432347, loss_ss: 1.028432, loss_d: 0.403915
0.8554 --- loss: 1.425855, loss_ss: 1.147048, loss_d: 0.278807
0.9331 --- loss: 1.626752, loss_ss: 1.361337, loss_d: 0.265415
Epoch finished! Loss: 1.4600619398988783
Starting epoch 4/10.
0.0000 --- loss: 1.529380, loss_ss: 1.291637, loss_d: 0.237743
0.0778 --- loss: 1.106076, loss_ss: 0.970001, loss_d: 0.136075
0.1555 --- loss: 1.320051, loss_ss: 0.999611, loss_d: 0.320440
0.2333 --- loss: 1.216754, loss_ss: 1.055974, loss_d: 0.160780
0.3110 --- loss: 1.422977, loss_ss: 0.983178, loss_d: 0.439799
0.3888 --- loss: 1.416482, loss_ss: 0.995042, loss_d: 0.421440
0.4666 --- loss: 1.322459, loss_ss: 1.070878, loss_d: 0.251581
0.5443 --- loss: 1.336002, loss_ss: 0.953026, loss_d: 0.382976
0.6221 --- loss: 1.469136, loss_ss: 1.096846, loss_d: 0.372290
0.6998 --- loss: 1.310512, loss_ss: 1.119609, loss_d: 0.190904
0.7776 --- loss: 1.107069, loss_ss: 0.995260, loss_d: 0.111809
0.8554 --- loss: 1.302638, loss_ss: 1.126743, loss_d: 0.175895
0.9331 --- loss: 1.842193, loss_ss: 0.953578, loss_d: 0.888615
Epoch finished! Loss: 1.3188021248206496
Starting epoch 5/10.
0.0000 --- loss: 1.161846, loss_ss: 0.931775, loss_d: 0.230070
0.0778 --- loss: 1.391719, loss_ss: 1.034258, loss_d: 0.357461
0.1555 --- loss: 1.047802, loss_ss: 0.978417, loss_d: 0.069384
0.2333 --- loss: 1.264780, loss_ss: 1.131002, loss_d: 0.133778
0.3110 --- loss: 1.244924, loss_ss: 0.921647, loss_d: 0.323278
0.3888 --- loss: 1.114556, loss_ss: 0.893607, loss_d: 0.220949
0.4666 --- loss: 0.815403, loss_ss: 0.764214, loss_d: 0.051189
0.5443 --- loss: 1.183192, loss_ss: 1.058861, loss_d: 0.124331
0.6221 --- loss: 1.181040, loss_ss: 1.060218, loss_d: 0.120821
0.6998 --- loss: 1.260062, loss_ss: 0.922164, loss_d: 0.337897
0.7776 --- loss: 1.045856, loss_ss: 0.813110, loss_d: 0.232747
0.8554 --- loss: 1.485658, loss_ss: 0.943837, loss_d: 0.541821
0.9331 --- loss: 1.225556, loss_ss: 1.040789, loss_d: 0.184767
Epoch finished! Loss: 1.1970099550671875
Starting epoch 6/10.
0.0000 --- loss: 1.024469, loss_ss: 0.781638, loss_d: 0.242831
0.0778 --- loss: 1.023541, loss_ss: 1.001587, loss_d: 0.021954
0.1555 --- loss: 1.036828, loss_ss: 0.905622, loss_d: 0.131206
0.2333 --- loss: 1.219079, loss_ss: 0.931810, loss_d: 0.287269
0.3110 --- loss: 1.016574, loss_ss: 0.970098, loss_d: 0.046476
0.3888 --- loss: 0.938366, loss_ss: 0.892768, loss_d: 0.045598
0.4666 --- loss: 0.976703, loss_ss: 0.933094, loss_d: 0.043608
0.5443 --- loss: 1.145945, loss_ss: 0.989116, loss_d: 0.156829
0.6221 --- loss: 1.013682, loss_ss: 0.854422, loss_d: 0.159260
0.6998 --- loss: 1.149460, loss_ss: 1.009954, loss_d: 0.139506
0.7776 --- loss: 1.196004, loss_ss: 1.025144, loss_d: 0.170860
0.8554 --- loss: 0.776234, loss_ss: 0.745510, loss_d: 0.030724
0.9331 --- loss: 1.150904, loss_ss: 1.041669, loss_d: 0.109235
Epoch finished! Loss: 1.108612700831145
Starting epoch 7/10.
0.0000 --- loss: 1.001172, loss_ss: 0.971084, loss_d: 0.030089
0.0778 --- loss: 1.337814, loss_ss: 1.257523, loss_d: 0.080291
0.1555 --- loss: 1.037636, loss_ss: 0.977452, loss_d: 0.060184
0.2333 --- loss: 0.943647, loss_ss: 0.834210, loss_d: 0.109437
0.3110 --- loss: 1.008808, loss_ss: 0.955992, loss_d: 0.052816
0.3888 --- loss: 0.973950, loss_ss: 0.941053, loss_d: 0.032897
0.4666 --- loss: 0.813864, loss_ss: 0.671320, loss_d: 0.142544
0.5443 --- loss: 0.972751, loss_ss: 0.861692, loss_d: 0.111059
0.6221 --- loss: 1.007249, loss_ss: 0.981215, loss_d: 0.026034
0.6998 --- loss: 1.190931, loss_ss: 0.966529, loss_d: 0.224403
0.7776 --- loss: 0.858610, loss_ss: 0.806154, loss_d: 0.052456
0.8554 --- loss: 0.846768, loss_ss: 0.821577, loss_d: 0.025191
0.9331 --- loss: 0.883114, loss_ss: 0.736022, loss_d: 0.147092
Epoch finished! Loss: 1.046919662039727
Starting epoch 8/10.
0.0000 --- loss: 0.950105, loss_ss: 0.898662, loss_d: 0.051443
0.0778 --- loss: 1.335274, loss_ss: 0.977979, loss_d: 0.357295
0.1555 --- loss: 1.006949, loss_ss: 0.971344, loss_d: 0.035604
0.2333 --- loss: 0.913179, loss_ss: 0.867990, loss_d: 0.045189
0.3110 --- loss: 1.182868, loss_ss: 0.903396, loss_d: 0.279471
0.3888 --- loss: 0.910338, loss_ss: 0.870754, loss_d: 0.039584
0.4666 --- loss: 0.887196, loss_ss: 0.883236, loss_d: 0.003961
0.5443 --- loss: 1.152507, loss_ss: 1.128560, loss_d: 0.023948
0.6221 --- loss: 1.017358, loss_ss: 1.002180, loss_d: 0.015178
0.6998 --- loss: 1.153906, loss_ss: 0.723225, loss_d: 0.430681
0.7776 --- loss: 0.806154, loss_ss: 0.724183, loss_d: 0.081971
0.8554 --- loss: 0.947543, loss_ss: 0.840434, loss_d: 0.107108
0.9331 --- loss: 1.285229, loss_ss: 0.844509, loss_d: 0.440720
Epoch finished! Loss: 1.0304898987524211
Starting epoch 9/10.
0.0000 --- loss: 1.477372, loss_ss: 0.710985, loss_d: 0.766387
0.0778 --- loss: 0.941117, loss_ss: 0.928727, loss_d: 0.012390
0.1555 --- loss: 0.918385, loss_ss: 0.904219, loss_d: 0.014166
0.2333 --- loss: 1.003197, loss_ss: 0.964476, loss_d: 0.038721
0.3110 --- loss: 1.001170, loss_ss: 0.861274, loss_d: 0.139895
0.3888 --- loss: 0.897209, loss_ss: 0.886052, loss_d: 0.011157
0.4666 --- loss: 1.311524, loss_ss: 0.949771, loss_d: 0.361753
0.5443 --- loss: 0.900429, loss_ss: 0.788738, loss_d: 0.111691
0.6221 --- loss: 0.952082, loss_ss: 0.909116, loss_d: 0.042966
0.6998 --- loss: 0.777296, loss_ss: 0.733354, loss_d: 0.043942
0.7776 --- loss: 0.983808, loss_ss: 0.827156, loss_d: 0.156652
0.8554 --- loss: 0.754114, loss_ss: 0.747701, loss_d: 0.006413
0.9331 --- loss: 0.849494, loss_ss: 0.804479, loss_d: 0.045015
Epoch finished! Loss: 0.9543356653302908
Starting epoch 10/10.
0.0000 --- loss: 0.994869, loss_ss: 0.986052, loss_d: 0.008816
0.0778 --- loss: 1.103330, loss_ss: 0.762863, loss_d: 0.340467
0.1555 --- loss: 1.035095, loss_ss: 0.989131, loss_d: 0.045964
0.2333 --- loss: 0.937365, loss_ss: 0.890908, loss_d: 0.046456
0.3110 --- loss: 0.754423, loss_ss: 0.747220, loss_d: 0.007203
0.3888 --- loss: 0.866837, loss_ss: 0.826527, loss_d: 0.040310
0.4666 --- loss: 0.760300, loss_ss: 0.754908, loss_d: 0.005392
0.5443 --- loss: 1.028148, loss_ss: 0.894816, loss_d: 0.133332
0.6221 --- loss: 1.030606, loss_ss: 0.935624, loss_d: 0.094982
0.6998 --- loss: 1.180221, loss_ss: 1.176840, loss_d: 0.003381
0.7776 --- loss: 0.853140, loss_ss: 0.671737, loss_d: 0.181404
0.8554 --- loss: 0.778114, loss_ss: 0.743885, loss_d: 0.034229
0.9331 --- loss: 0.875203, loss_ss: 0.861598, loss_d: 0.013605
Epoch finished! Loss: 0.9276779810898006
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7857142857142857
             precision    recall  f1-score   support

        0.0       0.54      0.88      0.67        59
        1.0       0.21      0.18      0.20        60
        2.0       0.90      0.90      0.90       376
        3.0       0.98      0.87      0.92       151
        4.0       0.70      0.65      0.67       194

avg / total       0.79      0.79      0.79       840
 


====== chc033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.81  88.14   94.24  53.61     66.67
1  89.29  18.33   94.74  21.15     19.64
2  91.19  90.43   91.81  89.95     90.19
3  97.38  86.75   99.71  98.50     92.25
4  85.48  64.95   91.64  70.00     67.38
Total accuracy: 78.57%
Average sen: 69.72%
Average spec: 94.43%
Macro f1-score: 67.23%
Diagnosis acc on 30mins: 0.07142857142857142
[0.99853659 0.999798   0.99998271 0.98838848 0.99350846 0.99239326
 0.99958712 0.99990702 0.93795675 0.99687225 0.99936014 0.98936951
 0.99978298 0.27950349]
pred: 0.9410676253693444, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc033-nsrr

=== Test on chc035-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.453594, loss_ss: 1.784973, loss_d: 0.668621
0.0778 --- loss: 2.095712, loss_ss: 1.585523, loss_d: 0.510189
0.1556 --- loss: 2.005078, loss_ss: 1.547359, loss_d: 0.457719
0.2335 --- loss: 1.854860, loss_ss: 1.492132, loss_d: 0.362728
0.3113 --- loss: 2.274628, loss_ss: 1.572343, loss_d: 0.702286
0.3891 --- loss: 2.086018, loss_ss: 1.315879, loss_d: 0.770139
0.4669 --- loss: 1.982079, loss_ss: 1.302952, loss_d: 0.679127
0.5447 --- loss: 2.119411, loss_ss: 1.612571, loss_d: 0.506840
0.6226 --- loss: 1.814397, loss_ss: 1.286781, loss_d: 0.527615
0.7004 --- loss: 2.003895, loss_ss: 1.501129, loss_d: 0.502766
0.7782 --- loss: 1.668266, loss_ss: 1.250165, loss_d: 0.418101
0.8560 --- loss: 2.002166, loss_ss: 1.323195, loss_d: 0.678971
0.9339 --- loss: 1.914603, loss_ss: 1.256795, loss_d: 0.657808
Epoch finished! Loss: 2.0514376927167177
Starting epoch 2/10.
0.0000 --- loss: 1.738631, loss_ss: 1.253107, loss_d: 0.485524
0.0778 --- loss: 1.565759, loss_ss: 1.160799, loss_d: 0.404960
0.1556 --- loss: 1.877645, loss_ss: 1.318152, loss_d: 0.559493
0.2335 --- loss: 1.840814, loss_ss: 1.306160, loss_d: 0.534654
0.3113 --- loss: 1.697497, loss_ss: 1.268536, loss_d: 0.428961
0.3891 --- loss: 1.642727, loss_ss: 1.166868, loss_d: 0.475859
0.4669 --- loss: 1.476093, loss_ss: 1.192457, loss_d: 0.283636
0.5447 --- loss: 1.521221, loss_ss: 1.111787, loss_d: 0.409434
0.6226 --- loss: 1.428671, loss_ss: 1.240036, loss_d: 0.188635
0.7004 --- loss: 1.949172, loss_ss: 1.325695, loss_d: 0.623477
0.7782 --- loss: 1.403810, loss_ss: 1.139613, loss_d: 0.264197
0.8560 --- loss: 1.437294, loss_ss: 1.180698, loss_d: 0.256596
0.9339 --- loss: 1.526191, loss_ss: 1.153836, loss_d: 0.372354
Epoch finished! Loss: 1.7026390107348561
Starting epoch 3/10.
0.0000 --- loss: 1.486432, loss_ss: 1.266771, loss_d: 0.219661
0.0778 --- loss: 1.370427, loss_ss: 0.993963, loss_d: 0.376464
0.1556 --- loss: 1.201732, loss_ss: 0.944787, loss_d: 0.256945
0.2335 --- loss: 1.547583, loss_ss: 1.193295, loss_d: 0.354288
0.3113 --- loss: 1.244360, loss_ss: 1.036467, loss_d: 0.207893
0.3891 --- loss: 1.328343, loss_ss: 1.143498, loss_d: 0.184845
0.4669 --- loss: 1.241763, loss_ss: 1.089180, loss_d: 0.152584
0.5447 --- loss: 1.303789, loss_ss: 1.110248, loss_d: 0.193541
0.6226 --- loss: 1.217409, loss_ss: 1.007132, loss_d: 0.210277
0.7004 --- loss: 1.335958, loss_ss: 1.182922, loss_d: 0.153036
0.7782 --- loss: 1.146739, loss_ss: 1.054615, loss_d: 0.092124
0.8560 --- loss: 1.080448, loss_ss: 1.011804, loss_d: 0.068644
0.9339 --- loss: 1.406628, loss_ss: 1.162976, loss_d: 0.243651
Epoch finished! Loss: 1.4639924392104149
Starting epoch 4/10.
0.0000 --- loss: 1.329465, loss_ss: 1.106158, loss_d: 0.223308
0.0778 --- loss: 1.523754, loss_ss: 1.100371, loss_d: 0.423382
0.1556 --- loss: 1.328110, loss_ss: 1.061916, loss_d: 0.266194
0.2335 --- loss: 1.530037, loss_ss: 1.303119, loss_d: 0.226918
0.3113 --- loss: 1.132363, loss_ss: 0.938089, loss_d: 0.194274
0.3891 --- loss: 1.375817, loss_ss: 1.160264, loss_d: 0.215553
0.4669 --- loss: 1.160136, loss_ss: 1.080370, loss_d: 0.079767
0.5447 --- loss: 2.216098, loss_ss: 0.916833, loss_d: 1.299265
0.6226 --- loss: 1.303986, loss_ss: 1.160492, loss_d: 0.143493
0.7004 --- loss: 1.404782, loss_ss: 1.083360, loss_d: 0.321422
0.7782 --- loss: 1.242520, loss_ss: 0.997023, loss_d: 0.245497
0.8560 --- loss: 1.811221, loss_ss: 1.337750, loss_d: 0.473471
0.9339 --- loss: 1.499461, loss_ss: 1.147854, loss_d: 0.351607
Epoch finished! Loss: 1.3312943964265287
Starting epoch 5/10.
0.0000 --- loss: 1.141110, loss_ss: 1.049147, loss_d: 0.091963
0.0778 --- loss: 1.511486, loss_ss: 1.083982, loss_d: 0.427504
0.1556 --- loss: 1.144611, loss_ss: 1.047034, loss_d: 0.097577
0.2335 --- loss: 1.137556, loss_ss: 1.104041, loss_d: 0.033515
0.3113 --- loss: 1.216216, loss_ss: 1.042058, loss_d: 0.174158
0.3891 --- loss: 1.312973, loss_ss: 1.132126, loss_d: 0.180847
0.4669 --- loss: 1.398528, loss_ss: 1.191384, loss_d: 0.207144
0.5447 --- loss: 1.453184, loss_ss: 1.050087, loss_d: 0.403097
0.6226 --- loss: 1.180792, loss_ss: 0.995633, loss_d: 0.185159
0.7004 --- loss: 0.957888, loss_ss: 0.887123, loss_d: 0.070765
0.7782 --- loss: 1.189335, loss_ss: 1.025987, loss_d: 0.163348
0.8560 --- loss: 0.986249, loss_ss: 0.855314, loss_d: 0.130935
0.9339 --- loss: 1.158938, loss_ss: 1.075347, loss_d: 0.083592
Epoch finished! Loss: 1.2462611300870776
Starting epoch 6/10.
0.0000 --- loss: 1.086997, loss_ss: 1.047231, loss_d: 0.039766
0.0778 --- loss: 1.218585, loss_ss: 1.043141, loss_d: 0.175444
0.1556 --- loss: 1.337294, loss_ss: 1.055025, loss_d: 0.282270
0.2335 --- loss: 1.061479, loss_ss: 0.957561, loss_d: 0.103918
0.3113 --- loss: 1.058560, loss_ss: 0.883365, loss_d: 0.175195
0.3891 --- loss: 0.897593, loss_ss: 0.850165, loss_d: 0.047429
0.4669 --- loss: 0.904981, loss_ss: 0.779793, loss_d: 0.125188
0.5447 --- loss: 1.086219, loss_ss: 1.053941, loss_d: 0.032278
0.6226 --- loss: 1.015471, loss_ss: 0.960460, loss_d: 0.055011
0.7004 --- loss: 1.286945, loss_ss: 1.264138, loss_d: 0.022807
0.7782 --- loss: 1.220610, loss_ss: 1.000424, loss_d: 0.220186
0.8560 --- loss: 1.021805, loss_ss: 0.941859, loss_d: 0.079946
0.9339 --- loss: 1.006900, loss_ss: 0.972262, loss_d: 0.034638
Epoch finished! Loss: 1.1336575294844806
Starting epoch 7/10.
0.0000 --- loss: 1.212126, loss_ss: 1.170484, loss_d: 0.041641
0.0778 --- loss: 1.702162, loss_ss: 1.084318, loss_d: 0.617844
0.1556 --- loss: 0.955246, loss_ss: 0.891155, loss_d: 0.064091
0.2335 --- loss: 1.312737, loss_ss: 1.011499, loss_d: 0.301238
0.3113 --- loss: 1.110076, loss_ss: 0.979274, loss_d: 0.130802
0.3891 --- loss: 0.929956, loss_ss: 0.914621, loss_d: 0.015335
0.4669 --- loss: 0.920480, loss_ss: 0.879915, loss_d: 0.040564
0.5447 --- loss: 1.136938, loss_ss: 1.119354, loss_d: 0.017585
0.6226 --- loss: 1.164613, loss_ss: 1.069648, loss_d: 0.094965
0.7004 --- loss: 1.113675, loss_ss: 1.027784, loss_d: 0.085890
0.7782 --- loss: 0.870661, loss_ss: 0.846448, loss_d: 0.024213
0.8560 --- loss: 0.961703, loss_ss: 0.928131, loss_d: 0.033573
0.9339 --- loss: 0.939084, loss_ss: 0.925883, loss_d: 0.013201
Epoch finished! Loss: 1.0823734453879297
Starting epoch 8/10.
0.0000 --- loss: 0.986311, loss_ss: 0.983250, loss_d: 0.003061
0.0778 --- loss: 0.911646, loss_ss: 0.908258, loss_d: 0.003388
0.1556 --- loss: 1.149476, loss_ss: 0.972383, loss_d: 0.177093
0.2335 --- loss: 1.255951, loss_ss: 1.231032, loss_d: 0.024919
0.3113 --- loss: 0.845639, loss_ss: 0.804133, loss_d: 0.041505
0.3891 --- loss: 1.139641, loss_ss: 1.079194, loss_d: 0.060447
0.4669 --- loss: 1.173561, loss_ss: 1.155671, loss_d: 0.017889
0.5447 --- loss: 0.853951, loss_ss: 0.845604, loss_d: 0.008347
0.6226 --- loss: 1.106220, loss_ss: 1.062828, loss_d: 0.043392
0.7004 --- loss: 1.047720, loss_ss: 0.961349, loss_d: 0.086371
0.7782 --- loss: 0.871205, loss_ss: 0.782250, loss_d: 0.088955
0.8560 --- loss: 0.877361, loss_ss: 0.834228, loss_d: 0.043133
0.9339 --- loss: 0.771017, loss_ss: 0.761310, loss_d: 0.009708
Epoch finished! Loss: 1.0321704517118633
Starting epoch 9/10.
0.0000 --- loss: 0.884925, loss_ss: 0.880044, loss_d: 0.004881
0.0778 --- loss: 0.953803, loss_ss: 0.942149, loss_d: 0.011654
0.1556 --- loss: 1.179039, loss_ss: 1.012639, loss_d: 0.166399
0.2335 --- loss: 1.061920, loss_ss: 1.049769, loss_d: 0.012152
0.3113 --- loss: 1.031392, loss_ss: 1.020471, loss_d: 0.010921
0.3891 --- loss: 0.660005, loss_ss: 0.626216, loss_d: 0.033789
0.4669 --- loss: 1.140972, loss_ss: 1.137422, loss_d: 0.003550
0.5447 --- loss: 1.033427, loss_ss: 1.024276, loss_d: 0.009151
0.6226 --- loss: 1.023124, loss_ss: 0.978704, loss_d: 0.044420
0.7004 --- loss: 0.802404, loss_ss: 0.796775, loss_d: 0.005629
0.7782 --- loss: 0.776059, loss_ss: 0.774334, loss_d: 0.001725
0.8560 --- loss: 0.869805, loss_ss: 0.867317, loss_d: 0.002487
0.9339 --- loss: 1.353017, loss_ss: 1.309821, loss_d: 0.043196
Epoch finished! Loss: 0.9578019003383815
Starting epoch 10/10.
0.0000 --- loss: 0.864510, loss_ss: 0.863580, loss_d: 0.000930
0.0778 --- loss: 0.969961, loss_ss: 0.968633, loss_d: 0.001328
0.1556 --- loss: 1.015815, loss_ss: 0.932176, loss_d: 0.083639
0.2335 --- loss: 0.961596, loss_ss: 0.937592, loss_d: 0.024004
0.3113 --- loss: 0.905779, loss_ss: 0.905181, loss_d: 0.000598
0.3891 --- loss: 1.733834, loss_ss: 1.082424, loss_d: 0.651411
0.4669 --- loss: 0.884947, loss_ss: 0.870386, loss_d: 0.014561
0.5447 --- loss: 1.140656, loss_ss: 0.969037, loss_d: 0.171619
0.6226 --- loss: 0.887921, loss_ss: 0.881512, loss_d: 0.006408
0.7004 --- loss: 0.863071, loss_ss: 0.859962, loss_d: 0.003108
0.7782 --- loss: 1.018573, loss_ss: 1.017450, loss_d: 0.001122
0.8560 --- loss: 1.255296, loss_ss: 1.045029, loss_d: 0.210267
0.9339 --- loss: 1.081729, loss_ss: 1.081020, loss_d: 0.000709
Epoch finished! Loss: 0.9642606643028557
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6077777777777778
             precision    recall  f1-score   support

        0.0       0.49      0.90      0.63        29
        1.0       0.48      0.25      0.33        57
        2.0       0.58      0.82      0.68       391
        3.0       1.00      0.11      0.19       250
        4.0       0.67      0.91      0.77       173

avg / total       0.70      0.61      0.54       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.67  89.66   96.90   49.06     63.41
1  93.56  24.56   98.22   48.28     32.56
2  66.56  82.35   54.42   58.12     68.15
3  75.22  10.80  100.00  100.00     19.49
4  89.56  91.33   89.13   66.67     77.07
Total accuracy: 60.78%
Average sen: 59.74%
Average spec: 87.73%
Macro f1-score: 52.14%
Diagnosis acc on 30mins: 0.8
[3.48602295e-01 5.73735306e-05 1.47891615e-05 1.92169294e-01
 1.82878197e-04 9.57154762e-03 4.07441348e-01 3.48439783e-01
 7.60544240e-01 2.01573421e-04 9.91212070e-01 7.88689077e-01
 6.87649176e-02 1.79809140e-05 2.36136150e-02]
pred: 0.26263485213997534, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc035-nsrr

=== Test on chc037-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.453671, loss_ss: 1.730934, loss_d: 0.722737
0.0778 --- loss: 1.965341, loss_ss: 1.602394, loss_d: 0.362946
0.1555 --- loss: 2.380109, loss_ss: 1.675973, loss_d: 0.704136
0.2333 --- loss: 2.062134, loss_ss: 1.563773, loss_d: 0.498360
0.3110 --- loss: 1.775045, loss_ss: 1.523822, loss_d: 0.251223
0.3888 --- loss: 1.957541, loss_ss: 1.377820, loss_d: 0.579720
0.4666 --- loss: 1.702315, loss_ss: 1.338469, loss_d: 0.363847
0.5443 --- loss: 2.025654, loss_ss: 1.470053, loss_d: 0.555601
0.6221 --- loss: 1.954026, loss_ss: 1.472339, loss_d: 0.481688
0.6998 --- loss: 1.904319, loss_ss: 1.288260, loss_d: 0.616059
0.7776 --- loss: 1.829905, loss_ss: 1.445145, loss_d: 0.384761
0.8554 --- loss: 2.073241, loss_ss: 1.364572, loss_d: 0.708669
0.9331 --- loss: 2.007701, loss_ss: 1.378139, loss_d: 0.629562
Epoch finished! Loss: 2.036749475635588
Starting epoch 2/10.
0.0000 --- loss: 1.705937, loss_ss: 1.204802, loss_d: 0.501135
0.0778 --- loss: 1.769282, loss_ss: 1.407221, loss_d: 0.362061
0.1555 --- loss: 1.924750, loss_ss: 1.185754, loss_d: 0.738996
0.2333 --- loss: 1.845827, loss_ss: 1.160232, loss_d: 0.685595
0.3110 --- loss: 1.471439, loss_ss: 1.143581, loss_d: 0.327858
0.3888 --- loss: 1.460328, loss_ss: 1.167721, loss_d: 0.292607
0.4666 --- loss: 1.659224, loss_ss: 1.315617, loss_d: 0.343606
0.5443 --- loss: 1.732526, loss_ss: 1.255266, loss_d: 0.477260
0.6221 --- loss: 1.553329, loss_ss: 1.275206, loss_d: 0.278123
0.6998 --- loss: 1.424357, loss_ss: 1.073064, loss_d: 0.351293
0.7776 --- loss: 1.675841, loss_ss: 1.181604, loss_d: 0.494237
0.8554 --- loss: 1.647105, loss_ss: 1.148134, loss_d: 0.498971
0.9331 --- loss: 1.730757, loss_ss: 1.132966, loss_d: 0.597790
Epoch finished! Loss: 1.6454319171607494
Starting epoch 3/10.
0.0000 --- loss: 1.440232, loss_ss: 1.138808, loss_d: 0.301424
0.0778 --- loss: 1.253680, loss_ss: 0.981030, loss_d: 0.272650
0.1555 --- loss: 1.411020, loss_ss: 1.135865, loss_d: 0.275155
0.2333 --- loss: 1.358425, loss_ss: 1.038411, loss_d: 0.320015
0.3110 --- loss: 1.063061, loss_ss: 0.949596, loss_d: 0.113465
0.3888 --- loss: 1.462681, loss_ss: 1.050244, loss_d: 0.412436
0.4666 --- loss: 1.162492, loss_ss: 0.941534, loss_d: 0.220957
0.5443 --- loss: 1.407681, loss_ss: 1.040248, loss_d: 0.367433
0.6221 --- loss: 1.430160, loss_ss: 1.062037, loss_d: 0.368123
0.6998 --- loss: 1.569798, loss_ss: 1.052119, loss_d: 0.517679
0.7776 --- loss: 1.173847, loss_ss: 1.091858, loss_d: 0.081989
0.8554 --- loss: 1.466253, loss_ss: 1.077166, loss_d: 0.389087
0.9331 --- loss: 1.205397, loss_ss: 0.965149, loss_d: 0.240247
Epoch finished! Loss: 1.4030427406542003
Starting epoch 4/10.
0.0000 --- loss: 0.988283, loss_ss: 0.906015, loss_d: 0.082268
0.0778 --- loss: 1.136076, loss_ss: 0.925415, loss_d: 0.210661
0.1555 --- loss: 1.309381, loss_ss: 0.954557, loss_d: 0.354824
0.2333 --- loss: 1.472455, loss_ss: 1.019797, loss_d: 0.452658
0.3110 --- loss: 1.089570, loss_ss: 1.010106, loss_d: 0.079464
0.3888 --- loss: 1.556726, loss_ss: 0.999435, loss_d: 0.557291
0.4666 --- loss: 1.521781, loss_ss: 1.194975, loss_d: 0.326806
0.5443 --- loss: 1.133316, loss_ss: 1.071809, loss_d: 0.061507
0.6221 --- loss: 1.451745, loss_ss: 1.153698, loss_d: 0.298047
0.6998 --- loss: 1.294402, loss_ss: 0.871227, loss_d: 0.423175
0.7776 --- loss: 1.335385, loss_ss: 0.904704, loss_d: 0.430681
0.8554 --- loss: 1.435066, loss_ss: 1.022207, loss_d: 0.412860
0.9331 --- loss: 1.158997, loss_ss: 1.087670, loss_d: 0.071327
Epoch finished! Loss: 1.2611282230354846
Starting epoch 5/10.
0.0000 --- loss: 0.910294, loss_ss: 0.884626, loss_d: 0.025667
0.0778 --- loss: 1.011750, loss_ss: 0.856596, loss_d: 0.155155
0.1555 --- loss: 1.050375, loss_ss: 0.945894, loss_d: 0.104481
0.2333 --- loss: 1.398658, loss_ss: 1.005169, loss_d: 0.393489
0.3110 --- loss: 0.895771, loss_ss: 0.852470, loss_d: 0.043302
0.3888 --- loss: 1.475200, loss_ss: 1.008990, loss_d: 0.466210
0.4666 --- loss: 1.072685, loss_ss: 0.883660, loss_d: 0.189026
0.5443 --- loss: 1.084489, loss_ss: 0.965925, loss_d: 0.118564
0.6221 --- loss: 0.815708, loss_ss: 0.773515, loss_d: 0.042193
0.6998 --- loss: 1.481697, loss_ss: 1.224972, loss_d: 0.256725
0.7776 --- loss: 2.149610, loss_ss: 0.914865, loss_d: 1.234744
0.8554 --- loss: 1.124526, loss_ss: 0.918395, loss_d: 0.206131
0.9331 --- loss: 0.846793, loss_ss: 0.805214, loss_d: 0.041579
Epoch finished! Loss: 1.17153891781345
Starting epoch 6/10.
0.0000 --- loss: 1.845199, loss_ss: 0.826158, loss_d: 1.019041
0.0778 --- loss: 1.087372, loss_ss: 1.016172, loss_d: 0.071200
0.1555 --- loss: 0.971266, loss_ss: 0.938340, loss_d: 0.032926
0.2333 --- loss: 0.914081, loss_ss: 0.894432, loss_d: 0.019649
0.3110 --- loss: 1.194449, loss_ss: 0.836372, loss_d: 0.358077
0.3888 --- loss: 1.155874, loss_ss: 0.830167, loss_d: 0.325707
0.4666 --- loss: 1.005000, loss_ss: 0.897848, loss_d: 0.107152
0.5443 --- loss: 1.014556, loss_ss: 0.836108, loss_d: 0.178448
0.6221 --- loss: 1.272469, loss_ss: 0.980214, loss_d: 0.292254
0.6998 --- loss: 1.080379, loss_ss: 0.997729, loss_d: 0.082650
0.7776 --- loss: 0.956383, loss_ss: 0.923441, loss_d: 0.032942
0.8554 --- loss: 0.828802, loss_ss: 0.800540, loss_d: 0.028262
0.9331 --- loss: 1.186333, loss_ss: 0.909562, loss_d: 0.276771
Epoch finished! Loss: 1.1038603303022683
Starting epoch 7/10.
0.0000 --- loss: 1.147139, loss_ss: 1.106210, loss_d: 0.040929
0.0778 --- loss: 0.871515, loss_ss: 0.836682, loss_d: 0.034833
0.1555 --- loss: 1.079648, loss_ss: 0.901075, loss_d: 0.178573
0.2333 --- loss: 0.938414, loss_ss: 0.785420, loss_d: 0.152993
0.3110 --- loss: 0.806434, loss_ss: 0.798826, loss_d: 0.007608
0.3888 --- loss: 1.164512, loss_ss: 1.157459, loss_d: 0.007053
0.4666 --- loss: 0.799615, loss_ss: 0.771420, loss_d: 0.028195
0.5443 --- loss: 0.906540, loss_ss: 0.821812, loss_d: 0.084728
0.6221 --- loss: 0.980684, loss_ss: 0.969967, loss_d: 0.010716
0.6998 --- loss: 0.817673, loss_ss: 0.814245, loss_d: 0.003428
0.7776 --- loss: 1.043360, loss_ss: 1.035446, loss_d: 0.007914
0.8554 --- loss: 0.910022, loss_ss: 0.901889, loss_d: 0.008133
0.9331 --- loss: 1.079793, loss_ss: 0.830540, loss_d: 0.249253
Epoch finished! Loss: 1.012460165657103
Starting epoch 8/10.
0.0000 --- loss: 1.160414, loss_ss: 0.862818, loss_d: 0.297596
0.0778 --- loss: 0.834932, loss_ss: 0.824185, loss_d: 0.010747
0.1555 --- loss: 0.964377, loss_ss: 0.960786, loss_d: 0.003590
0.2333 --- loss: 1.067527, loss_ss: 1.049385, loss_d: 0.018142
0.3110 --- loss: 0.900606, loss_ss: 0.893342, loss_d: 0.007264
0.3888 --- loss: 0.968572, loss_ss: 0.794294, loss_d: 0.174278
0.4666 --- loss: 1.365175, loss_ss: 0.686612, loss_d: 0.678562
0.5443 --- loss: 1.020597, loss_ss: 0.897962, loss_d: 0.122635
0.6221 --- loss: 1.895607, loss_ss: 0.908680, loss_d: 0.986927
0.6998 --- loss: 0.990098, loss_ss: 0.976085, loss_d: 0.014013
0.7776 --- loss: 0.715495, loss_ss: 0.700587, loss_d: 0.014908
0.8554 --- loss: 0.849499, loss_ss: 0.817224, loss_d: 0.032274
0.9331 --- loss: 0.895570, loss_ss: 0.847580, loss_d: 0.047990
Epoch finished! Loss: 0.9857862954959273
Starting epoch 9/10.
0.0000 --- loss: 0.962613, loss_ss: 0.883171, loss_d: 0.079442
0.0778 --- loss: 2.505528, loss_ss: 0.674433, loss_d: 1.831096
0.1555 --- loss: 1.322254, loss_ss: 1.218599, loss_d: 0.103655
0.2333 --- loss: 0.891330, loss_ss: 0.805073, loss_d: 0.086256
0.3110 --- loss: 0.972037, loss_ss: 0.961808, loss_d: 0.010229
0.3888 --- loss: 0.923392, loss_ss: 0.907194, loss_d: 0.016198
0.4666 --- loss: 0.768576, loss_ss: 0.762080, loss_d: 0.006496
0.5443 --- loss: 0.912335, loss_ss: 0.703856, loss_d: 0.208479
0.6221 --- loss: 0.754355, loss_ss: 0.675809, loss_d: 0.078546
0.6998 --- loss: 0.881568, loss_ss: 0.779322, loss_d: 0.102246
0.7776 --- loss: 0.927786, loss_ss: 0.922364, loss_d: 0.005422
0.8554 --- loss: 0.768696, loss_ss: 0.721612, loss_d: 0.047084
0.9331 --- loss: 0.881686, loss_ss: 0.852287, loss_d: 0.029399
Epoch finished! Loss: 0.9483388755470514
Starting epoch 10/10.
0.0000 --- loss: 0.914049, loss_ss: 0.661045, loss_d: 0.253004
0.0778 --- loss: 0.793249, loss_ss: 0.728694, loss_d: 0.064556
0.1555 --- loss: 1.148842, loss_ss: 1.047450, loss_d: 0.101392
0.2333 --- loss: 0.982431, loss_ss: 0.979824, loss_d: 0.002607
0.3110 --- loss: 0.982680, loss_ss: 0.980893, loss_d: 0.001788
0.3888 --- loss: 0.910210, loss_ss: 0.908902, loss_d: 0.001309
0.4666 --- loss: 1.027115, loss_ss: 1.021950, loss_d: 0.005165
0.5443 --- loss: 1.236792, loss_ss: 1.196985, loss_d: 0.039807
0.6221 --- loss: 0.755659, loss_ss: 0.713968, loss_d: 0.041691
0.6998 --- loss: 1.005133, loss_ss: 1.004225, loss_d: 0.000908
0.7776 --- loss: 0.850304, loss_ss: 0.849838, loss_d: 0.000466
0.8554 --- loss: 1.024654, loss_ss: 1.011855, loss_d: 0.012799
0.9331 --- loss: 0.751184, loss_ss: 0.711544, loss_d: 0.039640
Epoch finished! Loss: 0.9267201549373567
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8630952380952381
             precision    recall  f1-score   support

        0.0       0.84      0.99      0.91       154
        1.0       0.23      0.41      0.29        34
        2.0       0.92      0.86      0.89       277
        3.0       0.95      0.93      0.94       168
        4.0       0.94      0.80      0.86       207

avg / total       0.89      0.86      0.87       840
 


====== chc037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.31  98.70   95.77  83.98     90.75
1  91.90  41.18   94.04  22.58     29.17
2  92.86  85.56   96.45  92.22     88.76
3  97.74  93.45   98.81  95.15     94.29
4  93.81  79.71   98.42  94.29     86.39
Total accuracy: 86.31%
Average sen: 79.72%
Average spec: 96.70%
Macro f1-score: 77.87%
Diagnosis acc on 30mins: 0.2857142857142857
[0.3736496  0.99976271 0.99971062 0.99956614 0.02775447 0.87972599
 0.18983048 0.99746287 0.95534325 0.99831581 0.96870351 0.06829824
 0.99608898 0.99911982]
pred: 0.7466666059834617, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc037-nsrr

=== Test on chc040-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.268774, loss_ss: 1.578112, loss_d: 0.690662
0.0780 --- loss: 2.227211, loss_ss: 1.550344, loss_d: 0.676866
0.1560 --- loss: 2.046299, loss_ss: 1.450928, loss_d: 0.595371
0.2340 --- loss: 2.173730, loss_ss: 1.368914, loss_d: 0.804815
0.3120 --- loss: 2.224018, loss_ss: 1.496164, loss_d: 0.727853
0.3900 --- loss: 2.079642, loss_ss: 1.349621, loss_d: 0.730021
0.4680 --- loss: 1.929674, loss_ss: 1.380584, loss_d: 0.549090
0.5460 --- loss: 1.954612, loss_ss: 1.378931, loss_d: 0.575681
0.6240 --- loss: 2.187874, loss_ss: 1.372504, loss_d: 0.815369
0.7020 --- loss: 2.298335, loss_ss: 1.396818, loss_d: 0.901517
0.7800 --- loss: 1.832095, loss_ss: 1.219553, loss_d: 0.612542
0.8580 --- loss: 1.886140, loss_ss: 1.241457, loss_d: 0.644682
0.9360 --- loss: 1.928132, loss_ss: 1.282224, loss_d: 0.645908
Epoch finished! Loss: 1.9919287329539657
Starting epoch 2/10.
0.0000 --- loss: 1.755644, loss_ss: 1.310013, loss_d: 0.445632
0.0780 --- loss: 1.641569, loss_ss: 1.176212, loss_d: 0.465358
0.1560 --- loss: 1.749879, loss_ss: 1.183342, loss_d: 0.566537
0.2340 --- loss: 2.273736, loss_ss: 1.470331, loss_d: 0.803405
0.3120 --- loss: 1.580418, loss_ss: 1.203517, loss_d: 0.376901
0.3900 --- loss: 1.620880, loss_ss: 1.219260, loss_d: 0.401620
0.4680 --- loss: 1.786172, loss_ss: 1.362590, loss_d: 0.423583
0.5460 --- loss: 1.542330, loss_ss: 1.103547, loss_d: 0.438784
0.6240 --- loss: 1.353881, loss_ss: 1.088325, loss_d: 0.265556
0.7020 --- loss: 1.298300, loss_ss: 1.076215, loss_d: 0.222085
0.7800 --- loss: 2.069045, loss_ss: 1.161706, loss_d: 0.907339
0.8580 --- loss: 2.169638, loss_ss: 1.204715, loss_d: 0.964923
0.9360 --- loss: 1.692580, loss_ss: 1.317200, loss_d: 0.375381
Epoch finished! Loss: 1.6654737144708633
Starting epoch 3/10.
0.0000 --- loss: 1.312854, loss_ss: 1.095050, loss_d: 0.217803
0.0780 --- loss: 1.622882, loss_ss: 1.169758, loss_d: 0.453124
0.1560 --- loss: 1.289886, loss_ss: 1.036101, loss_d: 0.253785
0.2340 --- loss: 1.587992, loss_ss: 0.952816, loss_d: 0.635176
0.3120 --- loss: 1.432455, loss_ss: 1.098694, loss_d: 0.333761
0.3900 --- loss: 1.290980, loss_ss: 1.093853, loss_d: 0.197127
0.4680 --- loss: 1.260938, loss_ss: 1.016567, loss_d: 0.244372
0.5460 --- loss: 1.551966, loss_ss: 1.268180, loss_d: 0.283786
0.6240 --- loss: 1.362381, loss_ss: 1.185720, loss_d: 0.176661
0.7020 --- loss: 1.309835, loss_ss: 1.003435, loss_d: 0.306400
0.7800 --- loss: 1.466644, loss_ss: 1.047625, loss_d: 0.419019
0.8580 --- loss: 1.487029, loss_ss: 1.066158, loss_d: 0.420871
0.9360 --- loss: 1.387750, loss_ss: 1.003102, loss_d: 0.384647
Epoch finished! Loss: 1.4414409548044205
Starting epoch 4/10.
0.0000 --- loss: 1.342726, loss_ss: 1.082298, loss_d: 0.260428
0.0780 --- loss: 1.668526, loss_ss: 1.139326, loss_d: 0.529200
0.1560 --- loss: 1.333644, loss_ss: 1.103616, loss_d: 0.230028
0.2340 --- loss: 1.634471, loss_ss: 0.978069, loss_d: 0.656403
0.3120 --- loss: 1.267893, loss_ss: 1.003059, loss_d: 0.264834
0.3900 --- loss: 1.088854, loss_ss: 0.995753, loss_d: 0.093101
0.4680 --- loss: 1.070893, loss_ss: 0.985068, loss_d: 0.085825
0.5460 --- loss: 1.328705, loss_ss: 0.857250, loss_d: 0.471454
0.6240 --- loss: 1.077165, loss_ss: 1.016923, loss_d: 0.060242
0.7020 --- loss: 0.988820, loss_ss: 0.901406, loss_d: 0.087415
0.7800 --- loss: 1.079480, loss_ss: 1.055709, loss_d: 0.023771
0.8580 --- loss: 1.407763, loss_ss: 0.981064, loss_d: 0.426699
0.9360 --- loss: 1.361469, loss_ss: 0.843359, loss_d: 0.518110
Epoch finished! Loss: 1.2969178785569966
Starting epoch 5/10.
0.0000 --- loss: 1.596501, loss_ss: 1.110434, loss_d: 0.486067
0.0780 --- loss: 1.249795, loss_ss: 0.992745, loss_d: 0.257049
0.1560 --- loss: 1.220481, loss_ss: 0.982726, loss_d: 0.237755
0.2340 --- loss: 1.022266, loss_ss: 0.896601, loss_d: 0.125665
0.3120 --- loss: 1.176861, loss_ss: 1.024907, loss_d: 0.151954
0.3900 --- loss: 1.273548, loss_ss: 0.983296, loss_d: 0.290252
0.4680 --- loss: 1.085950, loss_ss: 0.961919, loss_d: 0.124031
0.5460 --- loss: 1.295285, loss_ss: 1.068062, loss_d: 0.227223
0.6240 --- loss: 1.165823, loss_ss: 1.059385, loss_d: 0.106439
0.7020 --- loss: 0.957774, loss_ss: 0.920532, loss_d: 0.037242
0.7800 --- loss: 1.095297, loss_ss: 0.881826, loss_d: 0.213471
0.8580 --- loss: 1.001860, loss_ss: 0.917637, loss_d: 0.084223
0.9360 --- loss: 1.128151, loss_ss: 0.961710, loss_d: 0.166441
Epoch finished! Loss: 1.20030379248783
Starting epoch 6/10.
0.0000 --- loss: 0.953581, loss_ss: 0.925810, loss_d: 0.027771
0.0780 --- loss: 0.960827, loss_ss: 0.932706, loss_d: 0.028121
0.1560 --- loss: 1.151818, loss_ss: 1.051950, loss_d: 0.099869
0.2340 --- loss: 1.070852, loss_ss: 1.043910, loss_d: 0.026942
0.3120 --- loss: 1.043661, loss_ss: 1.007095, loss_d: 0.036566
0.3900 --- loss: 1.080428, loss_ss: 0.873188, loss_d: 0.207240
0.4680 --- loss: 0.974224, loss_ss: 0.957944, loss_d: 0.016280
0.5460 --- loss: 1.046439, loss_ss: 0.896855, loss_d: 0.149584
0.6240 --- loss: 1.370642, loss_ss: 1.222415, loss_d: 0.148227
0.7020 --- loss: 1.066159, loss_ss: 0.928258, loss_d: 0.137901
0.7800 --- loss: 0.785054, loss_ss: 0.759401, loss_d: 0.025654
0.8580 --- loss: 1.434226, loss_ss: 0.948525, loss_d: 0.485701
0.9360 --- loss: 1.128097, loss_ss: 1.018408, loss_d: 0.109689
Epoch finished! Loss: 1.0884879841469228
Starting epoch 7/10.
0.0000 --- loss: 0.830376, loss_ss: 0.812125, loss_d: 0.018250
0.0780 --- loss: 1.066072, loss_ss: 0.963947, loss_d: 0.102126
0.1560 --- loss: 1.140259, loss_ss: 0.839320, loss_d: 0.300939
0.2340 --- loss: 0.955663, loss_ss: 0.876379, loss_d: 0.079284
0.3120 --- loss: 1.083357, loss_ss: 0.981581, loss_d: 0.101776
0.3900 --- loss: 0.997696, loss_ss: 0.957534, loss_d: 0.040162
0.4680 --- loss: 0.847639, loss_ss: 0.801186, loss_d: 0.046453
0.5460 --- loss: 1.362451, loss_ss: 1.027374, loss_d: 0.335077
0.6240 --- loss: 1.095949, loss_ss: 1.026208, loss_d: 0.069740
0.7020 --- loss: 1.277185, loss_ss: 0.979713, loss_d: 0.297472
0.7800 --- loss: 1.184139, loss_ss: 0.995240, loss_d: 0.188898
0.8580 --- loss: 0.859194, loss_ss: 0.807678, loss_d: 0.051516
0.9360 --- loss: 0.987478, loss_ss: 0.799772, loss_d: 0.187706
Epoch finished! Loss: 1.071115321945399
Starting epoch 8/10.
0.0000 --- loss: 1.491957, loss_ss: 1.296729, loss_d: 0.195228
0.0780 --- loss: 0.787738, loss_ss: 0.775858, loss_d: 0.011880
0.1560 --- loss: 0.936138, loss_ss: 0.920644, loss_d: 0.015494
0.2340 --- loss: 1.053712, loss_ss: 0.972902, loss_d: 0.080811
0.3120 --- loss: 0.763863, loss_ss: 0.708551, loss_d: 0.055311
0.3900 --- loss: 1.437800, loss_ss: 1.380476, loss_d: 0.057324
0.4680 --- loss: 0.990936, loss_ss: 0.905847, loss_d: 0.085089
0.5460 --- loss: 0.819752, loss_ss: 0.785888, loss_d: 0.033864
0.6240 --- loss: 0.839283, loss_ss: 0.833400, loss_d: 0.005883
0.7020 --- loss: 0.980618, loss_ss: 0.787695, loss_d: 0.192923
0.7800 --- loss: 0.819625, loss_ss: 0.803000, loss_d: 0.016625
0.8580 --- loss: 0.908528, loss_ss: 0.811002, loss_d: 0.097527
0.9360 --- loss: 1.131585, loss_ss: 0.904112, loss_d: 0.227473
Epoch finished! Loss: 1.020945894997567
Starting epoch 9/10.
0.0000 --- loss: 0.857939, loss_ss: 0.735708, loss_d: 0.122231
0.0780 --- loss: 0.929055, loss_ss: 0.891720, loss_d: 0.037335
0.1560 --- loss: 0.853573, loss_ss: 0.844108, loss_d: 0.009465
0.2340 --- loss: 1.891993, loss_ss: 1.082218, loss_d: 0.809775
0.3120 --- loss: 0.809756, loss_ss: 0.798383, loss_d: 0.011373
0.3900 --- loss: 1.114377, loss_ss: 1.070148, loss_d: 0.044228
0.4680 --- loss: 1.210484, loss_ss: 0.838059, loss_d: 0.372426
0.5460 --- loss: 0.807477, loss_ss: 0.757628, loss_d: 0.049849
0.6240 --- loss: 0.963526, loss_ss: 0.927288, loss_d: 0.036238
0.7020 --- loss: 1.174229, loss_ss: 0.983507, loss_d: 0.190722
0.7800 --- loss: 0.927350, loss_ss: 0.856943, loss_d: 0.070407
0.8580 --- loss: 0.650539, loss_ss: 0.634955, loss_d: 0.015584
0.9360 --- loss: 0.815528, loss_ss: 0.809571, loss_d: 0.005957
Epoch finished! Loss: 0.992983634583652
Starting epoch 10/10.
0.0000 --- loss: 1.017404, loss_ss: 0.984895, loss_d: 0.032510
0.0780 --- loss: 0.854838, loss_ss: 0.793133, loss_d: 0.061704
0.1560 --- loss: 0.874327, loss_ss: 0.751556, loss_d: 0.122772
0.2340 --- loss: 0.622414, loss_ss: 0.573712, loss_d: 0.048702
0.3120 --- loss: 1.257425, loss_ss: 1.210566, loss_d: 0.046859
0.3900 --- loss: 0.864645, loss_ss: 0.849093, loss_d: 0.015552
0.4680 --- loss: 0.765971, loss_ss: 0.734472, loss_d: 0.031499
0.5460 --- loss: 1.208061, loss_ss: 0.901093, loss_d: 0.306967
0.6240 --- loss: 1.266298, loss_ss: 1.081065, loss_d: 0.185233
0.7020 --- loss: 1.134292, loss_ss: 0.913027, loss_d: 0.221265
0.7800 --- loss: 0.954393, loss_ss: 0.944558, loss_d: 0.009835
0.8580 --- loss: 0.805821, loss_ss: 0.767158, loss_d: 0.038663
0.9360 --- loss: 1.304996, loss_ss: 0.843861, loss_d: 0.461135
Epoch finished! Loss: 0.9953837147913873
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6833333333333333
             precision    recall  f1-score   support

        0.0       0.92      0.56      0.70       185
        1.0       0.20      0.04      0.07        50
        2.0       0.62      0.97      0.76       483
        3.0       0.99      0.32      0.48       216
        4.0       0.70      0.65      0.68       146

avg / total       0.74      0.68      0.65      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.67  56.22   98.99  92.04     69.80
1  94.81   4.00   99.22  20.00      6.67
2  72.31  96.89   52.43  62.23     75.79
3  86.30  31.94   99.88  98.57     48.25
4  91.57  65.07   95.72  70.37     67.62
Total accuracy: 68.33%
Average sen: 50.82%
Average spec: 89.25%
Macro f1-score: 53.62%
Diagnosis acc on 30mins: 0.6666666666666666
[0.02901556 0.99976677 0.0019814  0.00311494 0.06923079 0.25020635
 0.4241139  0.03575388 0.80615455 0.98091185 0.02814251 0.58040643
 0.00107122 0.78239936 0.01355547 0.55760342 0.00200017 0.23803644]
pred: 0.3224147220866548, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc040-nsrr

=== Test on chc041-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.230998, loss_ss: 1.530700, loss_d: 0.700298
0.0778 --- loss: 2.228728, loss_ss: 1.458369, loss_d: 0.770360
0.1555 --- loss: 2.151951, loss_ss: 1.515868, loss_d: 0.636082
0.2333 --- loss: 1.998867, loss_ss: 1.425188, loss_d: 0.573679
0.3110 --- loss: 2.187237, loss_ss: 1.354911, loss_d: 0.832325
0.3888 --- loss: 1.809549, loss_ss: 1.298679, loss_d: 0.510870
0.4666 --- loss: 1.853962, loss_ss: 1.281929, loss_d: 0.572033
0.5443 --- loss: 1.938249, loss_ss: 1.397236, loss_d: 0.541013
0.6221 --- loss: 2.115521, loss_ss: 1.414127, loss_d: 0.701394
0.6998 --- loss: 1.979288, loss_ss: 1.285923, loss_d: 0.693365
0.7776 --- loss: 1.724081, loss_ss: 1.368116, loss_d: 0.355965
0.8554 --- loss: 2.013112, loss_ss: 1.353754, loss_d: 0.659358
0.9331 --- loss: 1.488618, loss_ss: 1.228543, loss_d: 0.260074
Epoch finished! Loss: 1.957544395700097
Starting epoch 2/10.
0.0000 --- loss: 1.587235, loss_ss: 1.127738, loss_d: 0.459498
0.0778 --- loss: 1.711877, loss_ss: 1.355877, loss_d: 0.356001
0.1555 --- loss: 1.458680, loss_ss: 1.137887, loss_d: 0.320793
0.2333 --- loss: 1.558036, loss_ss: 1.162464, loss_d: 0.395573
0.3110 --- loss: 1.720900, loss_ss: 1.069373, loss_d: 0.651526
0.3888 --- loss: 1.500211, loss_ss: 1.193840, loss_d: 0.306372
0.4666 --- loss: 1.892606, loss_ss: 1.231233, loss_d: 0.661374
0.5443 --- loss: 1.718722, loss_ss: 1.119027, loss_d: 0.599695
0.6221 --- loss: 1.990330, loss_ss: 1.505635, loss_d: 0.484696
0.6998 --- loss: 1.265113, loss_ss: 1.111246, loss_d: 0.153867
0.7776 --- loss: 1.486946, loss_ss: 1.284707, loss_d: 0.202239
0.8554 --- loss: 2.158637, loss_ss: 1.465741, loss_d: 0.692896
0.9331 --- loss: 1.446309, loss_ss: 1.197974, loss_d: 0.248335
Epoch finished! Loss: 1.615083652548492
Starting epoch 3/10.
0.0000 --- loss: 1.396080, loss_ss: 1.124354, loss_d: 0.271726
0.0778 --- loss: 1.323321, loss_ss: 1.024191, loss_d: 0.299130
0.1555 --- loss: 1.206319, loss_ss: 1.138913, loss_d: 0.067406
0.2333 --- loss: 1.228480, loss_ss: 1.167500, loss_d: 0.060980
0.3110 --- loss: 1.360355, loss_ss: 1.148962, loss_d: 0.211393
0.3888 --- loss: 1.660234, loss_ss: 1.065714, loss_d: 0.594521
0.4666 --- loss: 1.526044, loss_ss: 1.260710, loss_d: 0.265334
0.5443 --- loss: 1.341142, loss_ss: 1.049458, loss_d: 0.291684
0.6221 --- loss: 1.770828, loss_ss: 0.941909, loss_d: 0.828919
0.6998 --- loss: 2.037497, loss_ss: 1.153454, loss_d: 0.884043
0.7776 --- loss: 1.348326, loss_ss: 1.136453, loss_d: 0.211873
0.8554 --- loss: 1.286565, loss_ss: 1.181265, loss_d: 0.105299
0.9331 --- loss: 1.113879, loss_ss: 0.983652, loss_d: 0.130227
Epoch finished! Loss: 1.4198530060239136
Starting epoch 4/10.
0.0000 --- loss: 1.251523, loss_ss: 1.157345, loss_d: 0.094178
0.0778 --- loss: 1.303764, loss_ss: 1.017461, loss_d: 0.286303
0.1555 --- loss: 1.647724, loss_ss: 0.944881, loss_d: 0.702843
0.2333 --- loss: 1.356572, loss_ss: 1.170674, loss_d: 0.185898
0.3110 --- loss: 1.094694, loss_ss: 0.828848, loss_d: 0.265845
0.3888 --- loss: 1.409409, loss_ss: 1.061616, loss_d: 0.347793
0.4666 --- loss: 1.018340, loss_ss: 0.902501, loss_d: 0.115839
0.5443 --- loss: 1.516291, loss_ss: 1.163331, loss_d: 0.352960
0.6221 --- loss: 1.700987, loss_ss: 1.012733, loss_d: 0.688254
0.6998 --- loss: 1.128545, loss_ss: 1.030636, loss_d: 0.097909
0.7776 --- loss: 1.648921, loss_ss: 1.090205, loss_d: 0.558716
0.8554 --- loss: 1.203422, loss_ss: 1.048968, loss_d: 0.154454
0.9331 --- loss: 1.167186, loss_ss: 1.046524, loss_d: 0.120662
Epoch finished! Loss: 1.3100999393500388
Starting epoch 5/10.
0.0000 --- loss: 1.435825, loss_ss: 1.272998, loss_d: 0.162828
0.0778 --- loss: 1.549381, loss_ss: 0.959870, loss_d: 0.589511
0.1555 --- loss: 1.193469, loss_ss: 1.013953, loss_d: 0.179516
0.2333 --- loss: 1.001203, loss_ss: 0.950364, loss_d: 0.050840
0.3110 --- loss: 1.044648, loss_ss: 0.947803, loss_d: 0.096846
0.3888 --- loss: 0.906741, loss_ss: 0.870308, loss_d: 0.036433
0.4666 --- loss: 1.161238, loss_ss: 1.032902, loss_d: 0.128336
0.5443 --- loss: 1.110716, loss_ss: 0.936005, loss_d: 0.174711
0.6221 --- loss: 1.131639, loss_ss: 1.084064, loss_d: 0.047576
0.6998 --- loss: 1.363086, loss_ss: 1.249411, loss_d: 0.113675
0.7776 --- loss: 1.291794, loss_ss: 1.162406, loss_d: 0.129388
0.8554 --- loss: 1.550709, loss_ss: 0.811921, loss_d: 0.738788
0.9331 --- loss: 1.282000, loss_ss: 1.039014, loss_d: 0.242986
Epoch finished! Loss: 1.207557037472725
Starting epoch 6/10.
0.0000 --- loss: 1.476570, loss_ss: 1.112433, loss_d: 0.364137
0.0778 --- loss: 1.008858, loss_ss: 0.828818, loss_d: 0.180041
0.1555 --- loss: 1.521008, loss_ss: 1.071250, loss_d: 0.449758
0.2333 --- loss: 0.867666, loss_ss: 0.801940, loss_d: 0.065725
0.3110 --- loss: 1.063191, loss_ss: 0.992485, loss_d: 0.070705
0.3888 --- loss: 1.121136, loss_ss: 1.015382, loss_d: 0.105754
0.4666 --- loss: 1.252504, loss_ss: 1.004429, loss_d: 0.248075
0.5443 --- loss: 0.944795, loss_ss: 0.886210, loss_d: 0.058586
0.6221 --- loss: 0.915477, loss_ss: 0.856991, loss_d: 0.058486
0.6998 --- loss: 1.243417, loss_ss: 1.146961, loss_d: 0.096456
0.7776 --- loss: 1.289656, loss_ss: 0.926989, loss_d: 0.362668
0.8554 --- loss: 0.950400, loss_ss: 0.819673, loss_d: 0.130728
0.9331 --- loss: 1.451917, loss_ss: 1.109687, loss_d: 0.342230
Epoch finished! Loss: 1.1320071434602141
Starting epoch 7/10.
0.0000 --- loss: 0.864172, loss_ss: 0.850695, loss_d: 0.013477
0.0778 --- loss: 0.894721, loss_ss: 0.852843, loss_d: 0.041878
0.1555 --- loss: 1.035713, loss_ss: 0.975611, loss_d: 0.060102
0.2333 --- loss: 0.819498, loss_ss: 0.804578, loss_d: 0.014920
0.3110 --- loss: 1.320792, loss_ss: 1.212432, loss_d: 0.108360
0.3888 --- loss: 1.000930, loss_ss: 0.797665, loss_d: 0.203265
0.4666 --- loss: 1.152339, loss_ss: 0.876945, loss_d: 0.275394
0.5443 --- loss: 1.194464, loss_ss: 1.091275, loss_d: 0.103190
0.6221 --- loss: 0.987293, loss_ss: 0.949129, loss_d: 0.038164
0.6998 --- loss: 1.041165, loss_ss: 0.819740, loss_d: 0.221424
0.7776 --- loss: 1.110370, loss_ss: 1.048260, loss_d: 0.062110
0.8554 --- loss: 1.203231, loss_ss: 1.186464, loss_d: 0.016768
0.9331 --- loss: 1.342500, loss_ss: 0.811524, loss_d: 0.530976
Epoch finished! Loss: 1.07957516098395
Starting epoch 8/10.
0.0000 --- loss: 0.925975, loss_ss: 0.832837, loss_d: 0.093139
0.0778 --- loss: 0.902289, loss_ss: 0.813112, loss_d: 0.089177
0.1555 --- loss: 0.801009, loss_ss: 0.759931, loss_d: 0.041078
0.2333 --- loss: 1.253550, loss_ss: 0.896663, loss_d: 0.356887
0.3110 --- loss: 1.004113, loss_ss: 0.983454, loss_d: 0.020659
0.3888 --- loss: 1.056071, loss_ss: 1.043915, loss_d: 0.012156
0.4666 --- loss: 0.783731, loss_ss: 0.645725, loss_d: 0.138005
0.5443 --- loss: 0.917471, loss_ss: 0.742133, loss_d: 0.175338
0.6221 --- loss: 0.834367, loss_ss: 0.799840, loss_d: 0.034527
0.6998 --- loss: 1.163347, loss_ss: 1.142172, loss_d: 0.021175
0.7776 --- loss: 0.916866, loss_ss: 0.911572, loss_d: 0.005295
0.8554 --- loss: 0.747828, loss_ss: 0.682320, loss_d: 0.065508
0.9331 --- loss: 0.990674, loss_ss: 0.792774, loss_d: 0.197900
Epoch finished! Loss: 1.022321276832372
Starting epoch 9/10.
0.0000 --- loss: 0.941915, loss_ss: 0.925965, loss_d: 0.015950
0.0778 --- loss: 0.791873, loss_ss: 0.783230, loss_d: 0.008643
0.1555 --- loss: 0.791610, loss_ss: 0.779409, loss_d: 0.012201
0.2333 --- loss: 0.845130, loss_ss: 0.835417, loss_d: 0.009713
0.3110 --- loss: 1.021816, loss_ss: 0.904081, loss_d: 0.117736
0.3888 --- loss: 0.956583, loss_ss: 0.909349, loss_d: 0.047233
0.4666 --- loss: 0.834793, loss_ss: 0.828258, loss_d: 0.006535
0.5443 --- loss: 0.883545, loss_ss: 0.878831, loss_d: 0.004714
0.6221 --- loss: 1.322093, loss_ss: 0.934708, loss_d: 0.387384
0.6998 --- loss: 0.868454, loss_ss: 0.854867, loss_d: 0.013587
0.7776 --- loss: 1.189133, loss_ss: 0.868202, loss_d: 0.320931
0.8554 --- loss: 1.074009, loss_ss: 1.069965, loss_d: 0.004044
0.9331 --- loss: 1.201510, loss_ss: 1.196863, loss_d: 0.004646
Epoch finished! Loss: 0.979701628908515
Starting epoch 10/10.
0.0000 --- loss: 0.782923, loss_ss: 0.780891, loss_d: 0.002032
0.0778 --- loss: 0.888555, loss_ss: 0.769120, loss_d: 0.119435
0.1555 --- loss: 1.325500, loss_ss: 1.309066, loss_d: 0.016434
0.2333 --- loss: 0.973733, loss_ss: 0.969199, loss_d: 0.004535
0.3110 --- loss: 0.662118, loss_ss: 0.641175, loss_d: 0.020943
0.3888 --- loss: 0.987831, loss_ss: 0.973458, loss_d: 0.014372
0.4666 --- loss: 0.899047, loss_ss: 0.896450, loss_d: 0.002597
0.5443 --- loss: 0.851912, loss_ss: 0.848270, loss_d: 0.003642
0.6221 --- loss: 0.909936, loss_ss: 0.870161, loss_d: 0.039775
0.6998 --- loss: 0.999194, loss_ss: 0.731561, loss_d: 0.267633
0.7776 --- loss: 1.208255, loss_ss: 0.763392, loss_d: 0.444863
0.8554 --- loss: 0.782063, loss_ss: 0.768952, loss_d: 0.013111
0.9331 --- loss: 0.970537, loss_ss: 0.966313, loss_d: 0.004224
Epoch finished! Loss: 0.9480464491061866
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.705952380952381
             precision    recall  f1-score   support

        0.0       0.55      0.68      0.61        56
        1.0       0.10      0.39      0.16        38
        2.0       0.82      0.73      0.77       416
        3.0       0.98      0.69      0.81       188
        4.0       0.86      0.75      0.80       142

avg / total       0.81      0.71      0.75       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.17  67.86   96.05  55.07     60.80
1  81.90  39.47   83.92  10.42     16.48
2  78.57  73.08   83.96  81.72     77.16
3  92.86  69.15   99.69  98.48     81.25
4  93.69  74.65   97.56  86.18     80.00
Total accuracy: 70.60%
Average sen: 64.84%
Average spec: 92.24%
Macro f1-score: 63.14%
Diagnosis acc on 30mins: 0.0
[0.99999988 0.99870789 0.98745328 0.99624676 0.99998629 0.99998796
 0.99996376 0.99995875 0.99999976 1.         1.         0.9997986
 0.9902761  0.68613172]
pred: 0.975607910326549, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc041-nsrr

=== Test on chc052-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.374464, loss_ss: 1.698619, loss_d: 0.675845
0.0778 --- loss: 1.847715, loss_ss: 1.572794, loss_d: 0.274921
0.1556 --- loss: 1.979046, loss_ss: 1.466131, loss_d: 0.512915
0.2335 --- loss: 2.021859, loss_ss: 1.504055, loss_d: 0.517804
0.3113 --- loss: 1.718350, loss_ss: 1.304380, loss_d: 0.413970
0.3891 --- loss: 2.066712, loss_ss: 1.367026, loss_d: 0.699686
0.4669 --- loss: 1.605976, loss_ss: 1.277947, loss_d: 0.328029
0.5447 --- loss: 1.653879, loss_ss: 1.306353, loss_d: 0.347526
0.6226 --- loss: 1.917825, loss_ss: 1.290700, loss_d: 0.627125
0.7004 --- loss: 2.188667, loss_ss: 1.301763, loss_d: 0.886904
0.7782 --- loss: 2.022353, loss_ss: 1.262905, loss_d: 0.759448
0.8560 --- loss: 2.042825, loss_ss: 1.229818, loss_d: 0.813007
0.9339 --- loss: 2.047259, loss_ss: 1.391304, loss_d: 0.655955
Epoch finished! Loss: 1.956104644574225
Starting epoch 2/10.
0.0000 --- loss: 1.728788, loss_ss: 1.267216, loss_d: 0.461572
0.0778 --- loss: 1.564792, loss_ss: 1.164567, loss_d: 0.400225
0.1556 --- loss: 1.636436, loss_ss: 1.212257, loss_d: 0.424179
0.2335 --- loss: 1.816519, loss_ss: 1.149692, loss_d: 0.666828
0.3113 --- loss: 1.343315, loss_ss: 1.067087, loss_d: 0.276229
0.3891 --- loss: 1.646666, loss_ss: 1.178308, loss_d: 0.468358
0.4669 --- loss: 1.960267, loss_ss: 1.043553, loss_d: 0.916715
0.5447 --- loss: 1.615952, loss_ss: 1.173184, loss_d: 0.442768
0.6226 --- loss: 1.342258, loss_ss: 1.162973, loss_d: 0.179285
0.7004 --- loss: 1.894812, loss_ss: 1.320897, loss_d: 0.573914
0.7782 --- loss: 1.263420, loss_ss: 1.037212, loss_d: 0.226207
0.8560 --- loss: 1.875482, loss_ss: 0.968364, loss_d: 0.907118
0.9339 --- loss: 1.470203, loss_ss: 1.110422, loss_d: 0.359782
Epoch finished! Loss: 1.6189630897715688
Starting epoch 3/10.
0.0000 --- loss: 1.538528, loss_ss: 1.241340, loss_d: 0.297188
0.0778 --- loss: 1.353761, loss_ss: 1.173080, loss_d: 0.180681
0.1556 --- loss: 1.338226, loss_ss: 1.179603, loss_d: 0.158623
0.2335 --- loss: 1.494306, loss_ss: 1.135494, loss_d: 0.358812
0.3113 --- loss: 1.551813, loss_ss: 1.224328, loss_d: 0.327484
0.3891 --- loss: 1.740748, loss_ss: 1.369805, loss_d: 0.370943
0.4669 --- loss: 1.538353, loss_ss: 1.014881, loss_d: 0.523472
0.5447 --- loss: 1.353052, loss_ss: 1.012114, loss_d: 0.340938
0.6226 --- loss: 1.152407, loss_ss: 0.919035, loss_d: 0.233371
0.7004 --- loss: 1.564706, loss_ss: 0.988559, loss_d: 0.576148
0.7782 --- loss: 1.480382, loss_ss: 1.051857, loss_d: 0.428525
0.8560 --- loss: 1.492950, loss_ss: 0.986544, loss_d: 0.506406
0.9339 --- loss: 1.259295, loss_ss: 1.083396, loss_d: 0.175900
Epoch finished! Loss: 1.4158685803413391
Starting epoch 4/10.
0.0000 --- loss: 1.426080, loss_ss: 1.045096, loss_d: 0.380984
0.0778 --- loss: 1.069841, loss_ss: 0.991117, loss_d: 0.078725
0.1556 --- loss: 1.101374, loss_ss: 0.955956, loss_d: 0.145418
0.2335 --- loss: 1.156257, loss_ss: 1.121137, loss_d: 0.035119
0.3113 --- loss: 1.229334, loss_ss: 1.131150, loss_d: 0.098184
0.3891 --- loss: 1.465996, loss_ss: 1.194101, loss_d: 0.271894
0.4669 --- loss: 1.317568, loss_ss: 1.103795, loss_d: 0.213773
0.5447 --- loss: 1.463959, loss_ss: 1.422570, loss_d: 0.041390
0.6226 --- loss: 1.131403, loss_ss: 1.098922, loss_d: 0.032481
0.7004 --- loss: 1.414293, loss_ss: 0.998083, loss_d: 0.416210
0.7782 --- loss: 1.218267, loss_ss: 1.117330, loss_d: 0.100937
0.8560 --- loss: 1.792290, loss_ss: 1.233906, loss_d: 0.558384
0.9339 --- loss: 1.134957, loss_ss: 0.869299, loss_d: 0.265658
Epoch finished! Loss: 1.2426780676469207
Starting epoch 5/10.
0.0000 --- loss: 1.177988, loss_ss: 0.918933, loss_d: 0.259055
0.0778 --- loss: 1.039438, loss_ss: 0.853867, loss_d: 0.185571
0.1556 --- loss: 1.165689, loss_ss: 0.999382, loss_d: 0.166306
0.2335 --- loss: 1.093230, loss_ss: 1.016938, loss_d: 0.076292
0.3113 --- loss: 1.149584, loss_ss: 1.049526, loss_d: 0.100059
0.3891 --- loss: 1.095484, loss_ss: 0.931620, loss_d: 0.163863
0.4669 --- loss: 1.008728, loss_ss: 0.929147, loss_d: 0.079580
0.5447 --- loss: 1.133862, loss_ss: 0.970996, loss_d: 0.162866
0.6226 --- loss: 1.267044, loss_ss: 1.240020, loss_d: 0.027023
0.7004 --- loss: 0.851384, loss_ss: 0.773264, loss_d: 0.078120
0.7782 --- loss: 1.747203, loss_ss: 0.984769, loss_d: 0.762434
0.8560 --- loss: 1.183796, loss_ss: 0.967103, loss_d: 0.216692
0.9339 --- loss: 1.189434, loss_ss: 1.017606, loss_d: 0.171828
Epoch finished! Loss: 1.1317470259964466
Starting epoch 6/10.
0.0000 --- loss: 1.176984, loss_ss: 1.040661, loss_d: 0.136323
0.0778 --- loss: 1.511317, loss_ss: 0.712126, loss_d: 0.799190
0.1556 --- loss: 0.980891, loss_ss: 0.936080, loss_d: 0.044811
0.2335 --- loss: 1.027242, loss_ss: 0.928082, loss_d: 0.099160
0.3113 --- loss: 1.281462, loss_ss: 1.083034, loss_d: 0.198429
0.3891 --- loss: 1.678360, loss_ss: 1.053188, loss_d: 0.625171
0.4669 --- loss: 1.032811, loss_ss: 0.849858, loss_d: 0.182952
0.5447 --- loss: 1.090652, loss_ss: 0.838820, loss_d: 0.251832
0.6226 --- loss: 1.173324, loss_ss: 0.871966, loss_d: 0.301357
0.7004 --- loss: 1.074378, loss_ss: 0.882222, loss_d: 0.192156
0.7782 --- loss: 1.004483, loss_ss: 0.947737, loss_d: 0.056746
0.8560 --- loss: 1.063376, loss_ss: 1.040991, loss_d: 0.022385
0.9339 --- loss: 1.070089, loss_ss: 0.954757, loss_d: 0.115332
Epoch finished! Loss: 1.0610515214502811
Starting epoch 7/10.
0.0000 --- loss: 0.977940, loss_ss: 0.936641, loss_d: 0.041300
0.0778 --- loss: 0.979289, loss_ss: 0.950764, loss_d: 0.028525
0.1556 --- loss: 1.010403, loss_ss: 0.995590, loss_d: 0.014813
0.2335 --- loss: 1.038577, loss_ss: 1.017905, loss_d: 0.020673
0.3113 --- loss: 0.956213, loss_ss: 0.854834, loss_d: 0.101379
0.3891 --- loss: 1.204563, loss_ss: 1.157131, loss_d: 0.047432
0.4669 --- loss: 1.100317, loss_ss: 1.097506, loss_d: 0.002811
0.5447 --- loss: 1.556101, loss_ss: 0.828230, loss_d: 0.727871
0.6226 --- loss: 0.700988, loss_ss: 0.688730, loss_d: 0.012259
0.7004 --- loss: 0.588084, loss_ss: 0.569441, loss_d: 0.018643
0.7782 --- loss: 1.248150, loss_ss: 0.979504, loss_d: 0.268646
0.8560 --- loss: 0.927549, loss_ss: 0.914195, loss_d: 0.013354
0.9339 --- loss: 0.880646, loss_ss: 0.868617, loss_d: 0.012030
Epoch finished! Loss: 1.0083869057707489
Starting epoch 8/10.
0.0000 --- loss: 1.145162, loss_ss: 0.999189, loss_d: 0.145973
0.0778 --- loss: 0.854164, loss_ss: 0.836831, loss_d: 0.017333
0.1556 --- loss: 0.815025, loss_ss: 0.770350, loss_d: 0.044676
0.2335 --- loss: 0.855019, loss_ss: 0.820068, loss_d: 0.034950
0.3113 --- loss: 0.860689, loss_ss: 0.839175, loss_d: 0.021514
0.3891 --- loss: 0.877349, loss_ss: 0.824023, loss_d: 0.053326
0.4669 --- loss: 0.863916, loss_ss: 0.856822, loss_d: 0.007094
0.5447 --- loss: 0.627077, loss_ss: 0.612082, loss_d: 0.014995
0.6226 --- loss: 1.203367, loss_ss: 1.110771, loss_d: 0.092596
0.7004 --- loss: 1.157161, loss_ss: 0.940125, loss_d: 0.217036
0.7782 --- loss: 1.200966, loss_ss: 1.110016, loss_d: 0.090950
0.8560 --- loss: 0.928989, loss_ss: 0.757203, loss_d: 0.171786
0.9339 --- loss: 1.237796, loss_ss: 1.077044, loss_d: 0.160752
Epoch finished! Loss: 1.0010392083786428
Starting epoch 9/10.
0.0000 --- loss: 0.839892, loss_ss: 0.826498, loss_d: 0.013393
0.0778 --- loss: 0.997340, loss_ss: 0.990564, loss_d: 0.006776
0.1556 --- loss: 0.893613, loss_ss: 0.867793, loss_d: 0.025820
0.2335 --- loss: 0.898153, loss_ss: 0.876229, loss_d: 0.021924
0.3113 --- loss: 1.214619, loss_ss: 0.829510, loss_d: 0.385109
0.3891 --- loss: 1.147074, loss_ss: 0.992159, loss_d: 0.154916
0.4669 --- loss: 0.967645, loss_ss: 0.933953, loss_d: 0.033692
0.5447 --- loss: 1.050333, loss_ss: 1.035677, loss_d: 0.014657
0.6226 --- loss: 1.046002, loss_ss: 1.029464, loss_d: 0.016538
0.7004 --- loss: 0.824073, loss_ss: 0.794997, loss_d: 0.029076
0.7782 --- loss: 1.170489, loss_ss: 0.898321, loss_d: 0.272167
0.8560 --- loss: 1.101882, loss_ss: 0.896813, loss_d: 0.205069
0.9339 --- loss: 0.939262, loss_ss: 0.778479, loss_d: 0.160783
Epoch finished! Loss: 0.9431334189139307
Starting epoch 10/10.
0.0000 --- loss: 0.835202, loss_ss: 0.830620, loss_d: 0.004582
0.0778 --- loss: 0.812115, loss_ss: 0.800655, loss_d: 0.011460
0.1556 --- loss: 0.841465, loss_ss: 0.827086, loss_d: 0.014378
0.2335 --- loss: 0.811619, loss_ss: 0.739918, loss_d: 0.071702
0.3113 --- loss: 1.112797, loss_ss: 1.105884, loss_d: 0.006913
0.3891 --- loss: 0.979849, loss_ss: 0.877096, loss_d: 0.102753
0.4669 --- loss: 1.023201, loss_ss: 1.022420, loss_d: 0.000781
0.5447 --- loss: 0.837141, loss_ss: 0.836068, loss_d: 0.001073
0.6226 --- loss: 0.765593, loss_ss: 0.762084, loss_d: 0.003509
0.7004 --- loss: 0.895525, loss_ss: 0.802257, loss_d: 0.093268
0.7782 --- loss: 0.877687, loss_ss: 0.867127, loss_d: 0.010560
0.8560 --- loss: 1.120181, loss_ss: 1.114515, loss_d: 0.005666
0.9339 --- loss: 1.258248, loss_ss: 1.243737, loss_d: 0.014512
Epoch finished! Loss: 0.9148737927898765
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8155555555555556
             precision    recall  f1-score   support

        0.0       0.96      0.96      0.96       142
        1.0       0.27      0.52      0.36        23
        2.0       0.83      0.85      0.84       466
        3.0       0.96      0.56      0.71       167
        4.0       0.69      0.92      0.79       102

avg / total       0.84      0.82      0.82       900
 


====== chc052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.78  96.48   99.21  95.80     96.14
1  95.22  52.17   96.35  27.27     35.82
2  83.33  85.19   81.34  83.05     84.11
3  91.44  56.29   99.45  95.92     70.94
4  94.33  92.16   94.61  68.61     78.66
Total accuracy: 81.56%
Average sen: 76.46%
Average spec: 94.19%
Macro f1-score: 73.14%
Diagnosis acc on 30mins: 0.7333333333333333
[2.59582212e-05 2.89846212e-05 1.37923732e-02 3.87003981e-02
 1.29816499e-05 3.62992359e-05 1.01933710e-01 5.45447111e-01
 2.18969479e-01 3.90033349e-02 1.66658595e-01 1.29294128e-03
 7.93672740e-01 9.96681511e-01 9.92481709e-01]
pred: 0.2605825418296566, label: 0
Right! Diagnosis: Other
Save 30mins of subject chc052-nsrr

=== Test on chc056-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.307677, loss_ss: 1.619732, loss_d: 0.687944
0.0778 --- loss: 2.005712, loss_ss: 1.526452, loss_d: 0.479259
0.1556 --- loss: 1.999830, loss_ss: 1.443129, loss_d: 0.556701
0.2335 --- loss: 1.989659, loss_ss: 1.461594, loss_d: 0.528065
0.3113 --- loss: 2.116642, loss_ss: 1.392906, loss_d: 0.723736
0.3891 --- loss: 2.117463, loss_ss: 1.424183, loss_d: 0.693279
0.4669 --- loss: 2.065759, loss_ss: 1.384301, loss_d: 0.681458
0.5447 --- loss: 2.180300, loss_ss: 1.398386, loss_d: 0.781914
0.6226 --- loss: 1.947069, loss_ss: 1.392490, loss_d: 0.554579
0.7004 --- loss: 2.089202, loss_ss: 1.228745, loss_d: 0.860457
0.7782 --- loss: 2.320130, loss_ss: 1.519196, loss_d: 0.800934
0.8560 --- loss: 1.845050, loss_ss: 1.254710, loss_d: 0.590339
0.9339 --- loss: 2.281429, loss_ss: 1.178058, loss_d: 1.103372
Epoch finished! Loss: 1.9933382356539369
Starting epoch 2/10.
0.0000 --- loss: 1.760103, loss_ss: 1.164258, loss_d: 0.595844
0.0778 --- loss: 1.692953, loss_ss: 1.195263, loss_d: 0.497690
0.1556 --- loss: 1.813634, loss_ss: 1.213207, loss_d: 0.600428
0.2335 --- loss: 1.591482, loss_ss: 1.188481, loss_d: 0.403000
0.3113 --- loss: 2.104859, loss_ss: 1.427996, loss_d: 0.676863
0.3891 --- loss: 1.693240, loss_ss: 1.236910, loss_d: 0.456330
0.4669 --- loss: 1.647503, loss_ss: 1.162746, loss_d: 0.484757
0.5447 --- loss: 1.299139, loss_ss: 1.101902, loss_d: 0.197237
0.6226 --- loss: 1.813771, loss_ss: 1.366377, loss_d: 0.447394
0.7004 --- loss: 1.634774, loss_ss: 1.200567, loss_d: 0.434207
0.7782 --- loss: 1.530608, loss_ss: 1.223042, loss_d: 0.307566
0.8560 --- loss: 1.277602, loss_ss: 1.095586, loss_d: 0.182016
0.9339 --- loss: 1.601238, loss_ss: 1.110372, loss_d: 0.490865
Epoch finished! Loss: 1.6396450260654092
Starting epoch 3/10.
0.0000 --- loss: 1.398830, loss_ss: 1.138131, loss_d: 0.260699
0.0778 --- loss: 1.303510, loss_ss: 1.132330, loss_d: 0.171180
0.1556 --- loss: 1.184669, loss_ss: 0.980709, loss_d: 0.203960
0.2335 --- loss: 1.592533, loss_ss: 1.014301, loss_d: 0.578233
0.3113 --- loss: 1.313498, loss_ss: 1.154108, loss_d: 0.159390
0.3891 --- loss: 1.522957, loss_ss: 1.290840, loss_d: 0.232117
0.4669 --- loss: 1.363543, loss_ss: 0.944469, loss_d: 0.419074
0.5447 --- loss: 1.159957, loss_ss: 1.037107, loss_d: 0.122850
0.6226 --- loss: 1.729342, loss_ss: 1.257497, loss_d: 0.471844
0.7004 --- loss: 1.481118, loss_ss: 1.240240, loss_d: 0.240878
0.7782 --- loss: 1.396445, loss_ss: 1.051500, loss_d: 0.344945
0.8560 --- loss: 1.431796, loss_ss: 1.128487, loss_d: 0.303309
0.9339 --- loss: 1.312894, loss_ss: 1.227762, loss_d: 0.085132
Epoch finished! Loss: 1.4082901794463396
Starting epoch 4/10.
0.0000 --- loss: 1.218972, loss_ss: 0.868412, loss_d: 0.350560
0.0778 --- loss: 1.164617, loss_ss: 1.003468, loss_d: 0.161149
0.1556 --- loss: 1.160861, loss_ss: 1.078788, loss_d: 0.082073
0.2335 --- loss: 1.039288, loss_ss: 0.887462, loss_d: 0.151826
0.3113 --- loss: 1.093479, loss_ss: 1.011647, loss_d: 0.081832
0.3891 --- loss: 0.981809, loss_ss: 0.952914, loss_d: 0.028896
0.4669 --- loss: 1.375229, loss_ss: 1.053252, loss_d: 0.321977
0.5447 --- loss: 1.375544, loss_ss: 0.946776, loss_d: 0.428769
0.6226 --- loss: 0.992701, loss_ss: 0.881862, loss_d: 0.110839
0.7004 --- loss: 0.997402, loss_ss: 0.972429, loss_d: 0.024972
0.7782 --- loss: 1.107324, loss_ss: 1.006210, loss_d: 0.101114
0.8560 --- loss: 1.709792, loss_ss: 1.236399, loss_d: 0.473393
0.9339 --- loss: 1.118291, loss_ss: 0.972957, loss_d: 0.145334
Epoch finished! Loss: 1.2321575274690986
Starting epoch 5/10.
0.0000 --- loss: 1.170345, loss_ss: 0.940760, loss_d: 0.229585
0.0778 --- loss: 1.162928, loss_ss: 1.003278, loss_d: 0.159649
0.1556 --- loss: 1.316791, loss_ss: 1.165680, loss_d: 0.151111
0.2335 --- loss: 0.956919, loss_ss: 0.944257, loss_d: 0.012662
0.3113 --- loss: 1.053579, loss_ss: 1.015473, loss_d: 0.038107
0.3891 --- loss: 2.048458, loss_ss: 1.502096, loss_d: 0.546362
0.4669 --- loss: 1.146441, loss_ss: 0.941979, loss_d: 0.204462
0.5447 --- loss: 1.324984, loss_ss: 1.038615, loss_d: 0.286369
0.6226 --- loss: 1.539095, loss_ss: 0.727324, loss_d: 0.811771
0.7004 --- loss: 1.095877, loss_ss: 0.946111, loss_d: 0.149766
0.7782 --- loss: 1.094059, loss_ss: 0.995886, loss_d: 0.098173
0.8560 --- loss: 1.348985, loss_ss: 1.209418, loss_d: 0.139567
0.9339 --- loss: 0.975979, loss_ss: 0.934885, loss_d: 0.041094
Epoch finished! Loss: 1.1618982893414795
Starting epoch 6/10.
0.0000 --- loss: 1.156317, loss_ss: 0.901499, loss_d: 0.254819
0.0778 --- loss: 1.086402, loss_ss: 1.018469, loss_d: 0.067933
0.1556 --- loss: 1.059126, loss_ss: 0.999753, loss_d: 0.059372
0.2335 --- loss: 1.007591, loss_ss: 0.952538, loss_d: 0.055053
0.3113 --- loss: 0.909843, loss_ss: 0.899022, loss_d: 0.010822
0.3891 --- loss: 0.844229, loss_ss: 0.772821, loss_d: 0.071407
0.4669 --- loss: 0.875383, loss_ss: 0.868621, loss_d: 0.006762
0.5447 --- loss: 0.768011, loss_ss: 0.751703, loss_d: 0.016308
0.6226 --- loss: 0.929140, loss_ss: 0.905724, loss_d: 0.023416
0.7004 --- loss: 1.185367, loss_ss: 1.111691, loss_d: 0.073676
0.7782 --- loss: 0.961393, loss_ss: 0.921129, loss_d: 0.040264
0.8560 --- loss: 1.231472, loss_ss: 1.092430, loss_d: 0.139041
0.9339 --- loss: 0.999035, loss_ss: 0.866277, loss_d: 0.132758
Epoch finished! Loss: 1.0619083321653306
Starting epoch 7/10.
0.0000 --- loss: 0.933684, loss_ss: 0.925206, loss_d: 0.008478
0.0778 --- loss: 1.112386, loss_ss: 1.004900, loss_d: 0.107486
0.1556 --- loss: 1.012443, loss_ss: 0.809407, loss_d: 0.203036
0.2335 --- loss: 0.994241, loss_ss: 0.904481, loss_d: 0.089760
0.3113 --- loss: 0.985640, loss_ss: 0.957829, loss_d: 0.027811
0.3891 --- loss: 1.182058, loss_ss: 0.909571, loss_d: 0.272486
0.4669 --- loss: 1.075869, loss_ss: 1.066393, loss_d: 0.009476
0.5447 --- loss: 0.959981, loss_ss: 0.924730, loss_d: 0.035250
0.6226 --- loss: 0.939115, loss_ss: 0.897186, loss_d: 0.041929
0.7004 --- loss: 1.423102, loss_ss: 1.156663, loss_d: 0.266439
0.7782 --- loss: 1.164049, loss_ss: 0.829125, loss_d: 0.334924
0.8560 --- loss: 0.772395, loss_ss: 0.728301, loss_d: 0.044093
0.9339 --- loss: 0.969656, loss_ss: 0.941228, loss_d: 0.028428
Epoch finished! Loss: 1.0249370322562754
Starting epoch 8/10.
0.0000 --- loss: 1.065267, loss_ss: 1.047691, loss_d: 0.017576
0.0778 --- loss: 0.933335, loss_ss: 0.878976, loss_d: 0.054359
0.1556 --- loss: 0.879697, loss_ss: 0.705959, loss_d: 0.173739
0.2335 --- loss: 0.812363, loss_ss: 0.788000, loss_d: 0.024363
0.3113 --- loss: 1.138680, loss_ss: 1.072388, loss_d: 0.066292
0.3891 --- loss: 1.154865, loss_ss: 1.044702, loss_d: 0.110163
0.4669 --- loss: 0.761200, loss_ss: 0.711474, loss_d: 0.049726
0.5447 --- loss: 0.806599, loss_ss: 0.794455, loss_d: 0.012144
0.6226 --- loss: 0.871310, loss_ss: 0.854455, loss_d: 0.016855
0.7004 --- loss: 0.996367, loss_ss: 0.984851, loss_d: 0.011515
0.7782 --- loss: 0.966980, loss_ss: 0.937525, loss_d: 0.029455
0.8560 --- loss: 1.058906, loss_ss: 1.052149, loss_d: 0.006757
0.9339 --- loss: 1.070091, loss_ss: 1.066512, loss_d: 0.003579
Epoch finished! Loss: 0.9383222293108702
Starting epoch 9/10.
0.0000 --- loss: 1.117612, loss_ss: 1.073891, loss_d: 0.043721
0.0778 --- loss: 0.992942, loss_ss: 0.720158, loss_d: 0.272785
0.1556 --- loss: 0.823960, loss_ss: 0.699510, loss_d: 0.124450
0.2335 --- loss: 0.716887, loss_ss: 0.689139, loss_d: 0.027748
0.3113 --- loss: 0.972116, loss_ss: 0.662496, loss_d: 0.309620
0.3891 --- loss: 0.893492, loss_ss: 0.882748, loss_d: 0.010744
0.4669 --- loss: 0.867763, loss_ss: 0.811368, loss_d: 0.056395
0.5447 --- loss: 1.116582, loss_ss: 1.072014, loss_d: 0.044568
0.6226 --- loss: 0.830885, loss_ss: 0.783387, loss_d: 0.047498
0.7004 --- loss: 1.205914, loss_ss: 1.145809, loss_d: 0.060105
0.7782 --- loss: 1.025954, loss_ss: 1.006054, loss_d: 0.019900
0.8560 --- loss: 0.872312, loss_ss: 0.866670, loss_d: 0.005642
0.9339 --- loss: 0.995488, loss_ss: 0.890551, loss_d: 0.104937
Epoch finished! Loss: 0.9741323082707822
Starting epoch 10/10.
0.0000 --- loss: 1.087596, loss_ss: 0.873648, loss_d: 0.213948
0.0778 --- loss: 0.982319, loss_ss: 0.962610, loss_d: 0.019710
0.1556 --- loss: 1.006902, loss_ss: 0.845091, loss_d: 0.161811
0.2335 --- loss: 1.152963, loss_ss: 0.717175, loss_d: 0.435788
0.3113 --- loss: 1.241434, loss_ss: 1.230823, loss_d: 0.010610
0.3891 --- loss: 1.408817, loss_ss: 0.701056, loss_d: 0.707761
0.4669 --- loss: 0.736399, loss_ss: 0.734332, loss_d: 0.002068
0.5447 --- loss: 0.905883, loss_ss: 0.895298, loss_d: 0.010584
0.6226 --- loss: 1.062258, loss_ss: 1.056393, loss_d: 0.005865
0.7004 --- loss: 1.147377, loss_ss: 1.090471, loss_d: 0.056905
0.7782 --- loss: 1.086246, loss_ss: 0.882885, loss_d: 0.203361
0.8560 --- loss: 1.104471, loss_ss: 0.964656, loss_d: 0.139815
0.9339 --- loss: 0.886738, loss_ss: 0.824778, loss_d: 0.061959
Epoch finished! Loss: 0.9504750538617373
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6433333333333333
             precision    recall  f1-score   support

        0.0       0.98      0.26      0.41       175
        1.0       0.26      0.60      0.36        86
        2.0       0.69      0.92      0.79       396
        3.0       1.00      0.48      0.65       153
        4.0       0.84      0.47      0.60        90

avg / total       0.77      0.64      0.63       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.56  26.29   99.86   97.87     41.44
1  79.89  60.47   81.94   26.13     36.49
2  78.33  92.42   67.26   68.93     78.96
3  91.11  47.71  100.00  100.00     64.60
4  93.78  46.67   99.01   84.00     60.00
Total accuracy: 64.33%
Average sen: 54.71%
Average spec: 89.62%
Macro f1-score: 56.30%
Diagnosis acc on 30mins: 0.2
[0.99867624 0.99897754 0.99618679 0.99884737 0.97788423 0.77787954
 0.99916112 0.0465686  0.99832636 0.80131841 0.44279674 0.06732959
 0.97923982 0.92781383 0.98923457]
pred: 0.8000160497923692, label: 0
Wrong!!! Real Diagnosis: Other
Save 30mins of subject chc056-nsrr

=== Test on chp001-nsrr. train_data(1281), test_data(19) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.543727, loss_ss: 1.810514, loss_d: 0.733213
0.0781 --- loss: 2.190035, loss_ss: 1.651597, loss_d: 0.538437
0.1561 --- loss: 2.537527, loss_ss: 1.617552, loss_d: 0.919975
0.2342 --- loss: 2.060667, loss_ss: 1.616412, loss_d: 0.444255
0.3123 --- loss: 1.903192, loss_ss: 1.529046, loss_d: 0.374146
0.3903 --- loss: 2.114629, loss_ss: 1.619301, loss_d: 0.495328
0.4684 --- loss: 2.388428, loss_ss: 1.506077, loss_d: 0.882351
0.5464 --- loss: 2.104134, loss_ss: 1.398647, loss_d: 0.705487
0.6245 --- loss: 2.016235, loss_ss: 1.386548, loss_d: 0.629687
0.7026 --- loss: 1.888933, loss_ss: 1.465377, loss_d: 0.423556
0.7806 --- loss: 2.246116, loss_ss: 1.444366, loss_d: 0.801750
0.8587 --- loss: 2.025129, loss_ss: 1.481584, loss_d: 0.543545
0.9368 --- loss: 1.946078, loss_ss: 1.323348, loss_d: 0.622730
Epoch finished! Loss: 2.0975930551066995
Starting epoch 2/10.
0.0000 --- loss: 1.644693, loss_ss: 1.277332, loss_d: 0.367361
0.0781 --- loss: 1.499329, loss_ss: 1.208734, loss_d: 0.290595
0.1561 --- loss: 1.817549, loss_ss: 1.416030, loss_d: 0.401519
0.2342 --- loss: 1.658099, loss_ss: 1.234196, loss_d: 0.423903
0.3123 --- loss: 2.069731, loss_ss: 1.129665, loss_d: 0.940066
0.3903 --- loss: 1.447092, loss_ss: 1.190013, loss_d: 0.257079
0.4684 --- loss: 1.652850, loss_ss: 1.250239, loss_d: 0.402611
0.5464 --- loss: 1.459233, loss_ss: 1.218358, loss_d: 0.240875
0.6245 --- loss: 1.582897, loss_ss: 1.265260, loss_d: 0.317637
0.7026 --- loss: 1.454696, loss_ss: 1.167457, loss_d: 0.287239
0.7806 --- loss: 1.440107, loss_ss: 1.241064, loss_d: 0.199043
0.8587 --- loss: 1.571042, loss_ss: 1.207307, loss_d: 0.363735
0.9368 --- loss: 1.728529, loss_ss: 1.245580, loss_d: 0.482949
Epoch finished! Loss: 1.658945182338357
Starting epoch 3/10.
0.0000 --- loss: 1.309841, loss_ss: 1.047216, loss_d: 0.262625
0.0781 --- loss: 1.412441, loss_ss: 1.166193, loss_d: 0.246248
0.1561 --- loss: 1.688971, loss_ss: 1.176360, loss_d: 0.512611
0.2342 --- loss: 1.485223, loss_ss: 0.999182, loss_d: 0.486041
0.3123 --- loss: 1.718006, loss_ss: 1.361074, loss_d: 0.356932
0.3903 --- loss: 1.559280, loss_ss: 0.992827, loss_d: 0.566453
0.4684 --- loss: 1.327870, loss_ss: 1.058999, loss_d: 0.268871
0.5464 --- loss: 1.636162, loss_ss: 1.129303, loss_d: 0.506859
0.6245 --- loss: 1.316665, loss_ss: 1.049606, loss_d: 0.267059
0.7026 --- loss: 1.170802, loss_ss: 0.994901, loss_d: 0.175901
0.7806 --- loss: 1.340129, loss_ss: 1.035924, loss_d: 0.304205
0.8587 --- loss: 1.419703, loss_ss: 1.028394, loss_d: 0.391310
0.9368 --- loss: 1.135905, loss_ss: 0.912230, loss_d: 0.223675
Epoch finished! Loss: 1.4195602899417281
Starting epoch 4/10.
0.0000 --- loss: 1.135810, loss_ss: 1.085130, loss_d: 0.050680
0.0781 --- loss: 1.134975, loss_ss: 0.896600, loss_d: 0.238375
0.1561 --- loss: 1.364956, loss_ss: 0.961279, loss_d: 0.403677
0.2342 --- loss: 1.185496, loss_ss: 1.050283, loss_d: 0.135213
0.3123 --- loss: 1.226304, loss_ss: 0.978581, loss_d: 0.247723
0.3903 --- loss: 1.649410, loss_ss: 0.977621, loss_d: 0.671789
0.4684 --- loss: 1.567073, loss_ss: 0.908805, loss_d: 0.658269
0.5464 --- loss: 1.351205, loss_ss: 1.165305, loss_d: 0.185900
0.6245 --- loss: 0.999456, loss_ss: 0.921618, loss_d: 0.077838
0.7026 --- loss: 1.250509, loss_ss: 0.968945, loss_d: 0.281564
0.7806 --- loss: 0.914783, loss_ss: 0.878783, loss_d: 0.036000
0.8587 --- loss: 1.389162, loss_ss: 0.853716, loss_d: 0.535447
0.9368 --- loss: 1.899783, loss_ss: 0.936102, loss_d: 0.963682
Epoch finished! Loss: 1.2496294574812055
Starting epoch 5/10.
0.0000 --- loss: 0.985910, loss_ss: 0.944801, loss_d: 0.041110
0.0781 --- loss: 1.014988, loss_ss: 0.805366, loss_d: 0.209622
0.1561 --- loss: 1.484542, loss_ss: 1.029180, loss_d: 0.455362
0.2342 --- loss: 0.971448, loss_ss: 0.925367, loss_d: 0.046082
0.3123 --- loss: 0.974342, loss_ss: 0.912026, loss_d: 0.062316
0.3903 --- loss: 1.218856, loss_ss: 0.967901, loss_d: 0.250955
0.4684 --- loss: 0.943586, loss_ss: 0.892946, loss_d: 0.050640
0.5464 --- loss: 1.230212, loss_ss: 1.133026, loss_d: 0.097186
0.6245 --- loss: 1.141543, loss_ss: 1.101112, loss_d: 0.040431
0.7026 --- loss: 0.966433, loss_ss: 0.933016, loss_d: 0.033417
0.7806 --- loss: 1.855754, loss_ss: 1.061510, loss_d: 0.794244
0.8587 --- loss: 0.962623, loss_ss: 0.898185, loss_d: 0.064438
0.9368 --- loss: 0.828628, loss_ss: 0.764419, loss_d: 0.064209
Epoch finished! Loss: 1.1814603386446834
Starting epoch 6/10.
0.0000 --- loss: 1.082360, loss_ss: 0.958806, loss_d: 0.123553
0.0781 --- loss: 1.025644, loss_ss: 0.998453, loss_d: 0.027191
0.1561 --- loss: 0.845074, loss_ss: 0.822530, loss_d: 0.022544
0.2342 --- loss: 1.064948, loss_ss: 0.884206, loss_d: 0.180742
0.3123 --- loss: 0.918686, loss_ss: 0.851861, loss_d: 0.066824
0.3903 --- loss: 1.029997, loss_ss: 0.851736, loss_d: 0.178261
0.4684 --- loss: 1.370745, loss_ss: 0.836189, loss_d: 0.534557
0.5464 --- loss: 0.873415, loss_ss: 0.823083, loss_d: 0.050332
0.6245 --- loss: 0.914154, loss_ss: 0.874759, loss_d: 0.039394
0.7026 --- loss: 1.172731, loss_ss: 0.989333, loss_d: 0.183398
0.7806 --- loss: 0.878095, loss_ss: 0.815081, loss_d: 0.063014
0.8587 --- loss: 1.029893, loss_ss: 0.891619, loss_d: 0.138274
0.9368 --- loss: 1.467067, loss_ss: 0.891995, loss_d: 0.575072
Epoch finished! Loss: 1.085897991899401
Starting epoch 7/10.
0.0000 --- loss: 0.997575, loss_ss: 0.896097, loss_d: 0.101478
0.0781 --- loss: 1.237363, loss_ss: 0.871059, loss_d: 0.366304
0.1561 --- loss: 1.090857, loss_ss: 1.076523, loss_d: 0.014334
0.2342 --- loss: 0.887529, loss_ss: 0.851440, loss_d: 0.036090
0.3123 --- loss: 0.889407, loss_ss: 0.806991, loss_d: 0.082416
0.3903 --- loss: 0.947874, loss_ss: 0.896289, loss_d: 0.051585
0.4684 --- loss: 0.983011, loss_ss: 0.827143, loss_d: 0.155869
0.5464 --- loss: 1.088844, loss_ss: 1.023532, loss_d: 0.065312
0.6245 --- loss: 0.985831, loss_ss: 0.826157, loss_d: 0.159674
0.7026 --- loss: 1.142622, loss_ss: 1.063453, loss_d: 0.079169
0.7806 --- loss: 0.973816, loss_ss: 0.793836, loss_d: 0.179980
0.8587 --- loss: 1.037887, loss_ss: 0.769349, loss_d: 0.268539
0.9368 --- loss: 0.988537, loss_ss: 0.861939, loss_d: 0.126598
Epoch finished! Loss: 1.0210066200233996
Starting epoch 8/10.
0.0000 --- loss: 0.778428, loss_ss: 0.704812, loss_d: 0.073616
0.0781 --- loss: 1.088884, loss_ss: 0.908176, loss_d: 0.180708
0.1561 --- loss: 1.171461, loss_ss: 0.811404, loss_d: 0.360057
0.2342 --- loss: 1.235787, loss_ss: 0.927610, loss_d: 0.308177
0.3123 --- loss: 0.986174, loss_ss: 0.962669, loss_d: 0.023504
0.3903 --- loss: 0.750807, loss_ss: 0.613105, loss_d: 0.137703
0.4684 --- loss: 1.516298, loss_ss: 1.287226, loss_d: 0.229072
0.5464 --- loss: 0.885210, loss_ss: 0.860310, loss_d: 0.024900
0.6245 --- loss: 0.802796, loss_ss: 0.719350, loss_d: 0.083446
0.7026 --- loss: 0.783102, loss_ss: 0.726679, loss_d: 0.056423
0.7806 --- loss: 1.034812, loss_ss: 0.864529, loss_d: 0.170283
0.8587 --- loss: 0.611256, loss_ss: 0.591980, loss_d: 0.019276
0.9368 --- loss: 1.086792, loss_ss: 0.811433, loss_d: 0.275358
Epoch finished! Loss: 1.0192701653577387
Starting epoch 9/10.
0.0000 --- loss: 0.976608, loss_ss: 0.966148, loss_d: 0.010460
0.0781 --- loss: 0.890838, loss_ss: 0.863101, loss_d: 0.027737
0.1561 --- loss: 1.407721, loss_ss: 1.139371, loss_d: 0.268350
0.2342 --- loss: 1.167424, loss_ss: 1.099659, loss_d: 0.067765
0.3123 --- loss: 1.030135, loss_ss: 0.981377, loss_d: 0.048758
0.3903 --- loss: 0.960115, loss_ss: 0.752652, loss_d: 0.207463
0.4684 --- loss: 1.092798, loss_ss: 0.984282, loss_d: 0.108516
0.5464 --- loss: 0.772714, loss_ss: 0.761365, loss_d: 0.011349
0.6245 --- loss: 0.733832, loss_ss: 0.731944, loss_d: 0.001888
0.7026 --- loss: 1.096710, loss_ss: 1.080317, loss_d: 0.016393
0.7806 --- loss: 0.735379, loss_ss: 0.732578, loss_d: 0.002801
0.8587 --- loss: 0.927388, loss_ss: 0.924308, loss_d: 0.003080
0.9368 --- loss: 0.839422, loss_ss: 0.808120, loss_d: 0.031302
Epoch finished! Loss: 0.9286264963448048
Starting epoch 10/10.
0.0000 --- loss: 0.880852, loss_ss: 0.874457, loss_d: 0.006395
0.0781 --- loss: 0.956097, loss_ss: 0.944273, loss_d: 0.011824
0.1561 --- loss: 0.917885, loss_ss: 0.720368, loss_d: 0.197517
0.2342 --- loss: 0.817040, loss_ss: 0.700033, loss_d: 0.117007
0.3123 --- loss: 0.906401, loss_ss: 0.902947, loss_d: 0.003454
0.3903 --- loss: 0.920508, loss_ss: 0.884151, loss_d: 0.036357
0.4684 --- loss: 0.951506, loss_ss: 0.947389, loss_d: 0.004117
0.5464 --- loss: 0.948052, loss_ss: 0.778341, loss_d: 0.169711
0.6245 --- loss: 0.786529, loss_ss: 0.773714, loss_d: 0.012814
0.7026 --- loss: 0.779238, loss_ss: 0.746372, loss_d: 0.032866
0.7806 --- loss: 0.919982, loss_ss: 0.908131, loss_d: 0.011852
0.8587 --- loss: 0.898623, loss_ss: 0.890418, loss_d: 0.008205
0.9368 --- loss: 0.770502, loss_ss: 0.749976, loss_d: 0.020526
Epoch finished! Loss: 0.9343946417793632
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.49298245614035086
             precision    recall  f1-score   support

        0.0       0.38      0.88      0.53        40
        1.0       0.12      0.77      0.21        79
        2.0       0.78      0.41      0.54       553
        3.0       1.00      0.04      0.08        69
        4.0       0.90      0.60      0.72       399

avg / total       0.78      0.49      0.55      1140
 


====== chp001-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.47  87.50   94.73   37.63     52.63
1  60.53  77.22   59.28   12.37     21.33
2  65.70  40.69   89.27   78.12     53.51
3  94.21   4.35  100.00  100.00      8.33
4  83.68  59.65   96.63   90.49     71.90
Total accuracy: 49.30%
Average sen: 53.88%
Average spec: 87.98%
Macro f1-score: 41.54%
Diagnosis acc on 30mins: 1.0
[1.         0.99999988 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ]
pred: 0.9999999937258268, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp001-nsrr

=== Test on chp002-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.336570, loss_ss: 1.634580, loss_d: 0.701990
0.0780 --- loss: 2.112267, loss_ss: 1.638779, loss_d: 0.473488
0.1560 --- loss: 2.368737, loss_ss: 1.596224, loss_d: 0.772513
0.2340 --- loss: 2.040632, loss_ss: 1.554679, loss_d: 0.485953
0.3120 --- loss: 1.934352, loss_ss: 1.492257, loss_d: 0.442095
0.3900 --- loss: 2.384946, loss_ss: 1.449629, loss_d: 0.935317
0.4680 --- loss: 2.234179, loss_ss: 1.471203, loss_d: 0.762976
0.5460 --- loss: 2.122106, loss_ss: 1.389536, loss_d: 0.732570
0.6240 --- loss: 2.035117, loss_ss: 1.424882, loss_d: 0.610235
0.7020 --- loss: 1.962921, loss_ss: 1.318316, loss_d: 0.644605
0.7800 --- loss: 1.869648, loss_ss: 1.398891, loss_d: 0.470757
0.8580 --- loss: 1.851467, loss_ss: 1.467474, loss_d: 0.383993
0.9360 --- loss: 2.137623, loss_ss: 1.369735, loss_d: 0.767888
Epoch finished! Loss: 2.0652377605438232
Starting epoch 2/10.
0.0000 --- loss: 1.940982, loss_ss: 1.347616, loss_d: 0.593366
0.0780 --- loss: 1.846613, loss_ss: 1.500926, loss_d: 0.345687
0.1560 --- loss: 1.919232, loss_ss: 1.332890, loss_d: 0.586341
0.2340 --- loss: 2.027199, loss_ss: 1.256580, loss_d: 0.770619
0.3120 --- loss: 1.779118, loss_ss: 1.264967, loss_d: 0.514151
0.3900 --- loss: 1.805481, loss_ss: 1.236026, loss_d: 0.569455
0.4680 --- loss: 1.859754, loss_ss: 1.327089, loss_d: 0.532665
0.5460 --- loss: 1.756067, loss_ss: 1.178497, loss_d: 0.577570
0.6240 --- loss: 1.994830, loss_ss: 1.320885, loss_d: 0.673945
0.7020 --- loss: 1.785042, loss_ss: 1.362759, loss_d: 0.422283
0.7800 --- loss: 1.984393, loss_ss: 1.099384, loss_d: 0.885009
0.8580 --- loss: 1.453591, loss_ss: 1.261323, loss_d: 0.192268
0.9360 --- loss: 1.807999, loss_ss: 1.304939, loss_d: 0.503060
Epoch finished! Loss: 1.7740414943546057
Starting epoch 3/10.
0.0000 --- loss: 1.946898, loss_ss: 1.240250, loss_d: 0.706649
0.0780 --- loss: 1.419307, loss_ss: 1.079895, loss_d: 0.339413
0.1560 --- loss: 1.635514, loss_ss: 1.147593, loss_d: 0.487921
0.2340 --- loss: 1.563090, loss_ss: 1.195806, loss_d: 0.367284
0.3120 --- loss: 1.482474, loss_ss: 1.364294, loss_d: 0.118180
0.3900 --- loss: 1.645076, loss_ss: 1.450235, loss_d: 0.194841
0.4680 --- loss: 1.371698, loss_ss: 1.172893, loss_d: 0.198805
0.5460 --- loss: 1.635274, loss_ss: 1.192055, loss_d: 0.443219
0.6240 --- loss: 1.812668, loss_ss: 1.262704, loss_d: 0.549964
0.7020 --- loss: 1.524403, loss_ss: 1.278535, loss_d: 0.245869
0.7800 --- loss: 1.467386, loss_ss: 1.219502, loss_d: 0.247885
0.8580 --- loss: 1.593553, loss_ss: 1.182433, loss_d: 0.411120
0.9360 --- loss: 1.515354, loss_ss: 1.072290, loss_d: 0.443064
Epoch finished! Loss: 1.5129762971773744
Starting epoch 4/10.
0.0000 --- loss: 1.658923, loss_ss: 1.270033, loss_d: 0.388890
0.0780 --- loss: 1.402445, loss_ss: 1.257369, loss_d: 0.145076
0.1560 --- loss: 1.307228, loss_ss: 1.049108, loss_d: 0.258120
0.2340 --- loss: 1.353137, loss_ss: 1.264280, loss_d: 0.088858
0.3120 --- loss: 1.131692, loss_ss: 1.024199, loss_d: 0.107493
0.3900 --- loss: 1.315855, loss_ss: 1.004099, loss_d: 0.311756
0.4680 --- loss: 1.445075, loss_ss: 1.116525, loss_d: 0.328550
0.5460 --- loss: 1.362271, loss_ss: 0.968694, loss_d: 0.393578
0.6240 --- loss: 1.453715, loss_ss: 1.274436, loss_d: 0.179279
0.7020 --- loss: 1.255487, loss_ss: 1.218373, loss_d: 0.037115
0.7800 --- loss: 1.251581, loss_ss: 0.886699, loss_d: 0.364882
0.8580 --- loss: 1.244773, loss_ss: 1.168793, loss_d: 0.075980
0.9360 --- loss: 1.386685, loss_ss: 1.253675, loss_d: 0.133010
Epoch finished! Loss: 1.3338643973693252
Starting epoch 5/10.
0.0000 --- loss: 1.132668, loss_ss: 1.028279, loss_d: 0.104388
0.0780 --- loss: 1.155631, loss_ss: 0.894377, loss_d: 0.261254
0.1560 --- loss: 1.346570, loss_ss: 1.032406, loss_d: 0.314163
0.2340 --- loss: 1.069874, loss_ss: 1.022925, loss_d: 0.046949
0.3120 --- loss: 1.191667, loss_ss: 1.118806, loss_d: 0.072861
0.3900 --- loss: 1.382427, loss_ss: 0.880459, loss_d: 0.501968
0.4680 --- loss: 1.571665, loss_ss: 1.002382, loss_d: 0.569283
0.5460 --- loss: 1.788731, loss_ss: 1.499045, loss_d: 0.289686
0.6240 --- loss: 1.291648, loss_ss: 1.030260, loss_d: 0.261388
0.7020 --- loss: 0.992599, loss_ss: 0.885345, loss_d: 0.107254
0.7800 --- loss: 1.287831, loss_ss: 0.896477, loss_d: 0.391354
0.8580 --- loss: 1.195854, loss_ss: 0.992291, loss_d: 0.203563
0.9360 --- loss: 1.085272, loss_ss: 0.982188, loss_d: 0.103085
Epoch finished! Loss: 1.286041590385139
Starting epoch 6/10.
0.0000 --- loss: 1.048284, loss_ss: 0.974697, loss_d: 0.073587
0.0780 --- loss: 1.125934, loss_ss: 0.993289, loss_d: 0.132645
0.1560 --- loss: 1.125285, loss_ss: 1.041415, loss_d: 0.083870
0.2340 --- loss: 1.337063, loss_ss: 0.977044, loss_d: 0.360019
0.3120 --- loss: 0.899146, loss_ss: 0.801722, loss_d: 0.097424
0.3900 --- loss: 1.413921, loss_ss: 1.367200, loss_d: 0.046722
0.4680 --- loss: 1.401706, loss_ss: 0.930100, loss_d: 0.471606
0.5460 --- loss: 1.225483, loss_ss: 1.092380, loss_d: 0.133103
0.6240 --- loss: 1.071129, loss_ss: 0.911934, loss_d: 0.159194
0.7020 --- loss: 1.267382, loss_ss: 0.942211, loss_d: 0.325170
0.7800 --- loss: 1.022603, loss_ss: 1.011540, loss_d: 0.011063
0.8580 --- loss: 0.989565, loss_ss: 0.924676, loss_d: 0.064890
0.9360 --- loss: 1.367236, loss_ss: 1.118976, loss_d: 0.248259
Epoch finished! Loss: 1.1613476248458028
Starting epoch 7/10.
0.0000 --- loss: 0.795463, loss_ss: 0.757251, loss_d: 0.038211
0.0780 --- loss: 0.864954, loss_ss: 0.792579, loss_d: 0.072376
0.1560 --- loss: 1.154243, loss_ss: 0.994090, loss_d: 0.160153
0.2340 --- loss: 1.052757, loss_ss: 0.909235, loss_d: 0.143522
0.3120 --- loss: 1.038665, loss_ss: 0.980540, loss_d: 0.058125
0.3900 --- loss: 1.233927, loss_ss: 1.201302, loss_d: 0.032625
0.4680 --- loss: 1.140200, loss_ss: 0.819707, loss_d: 0.320493
0.5460 --- loss: 1.052156, loss_ss: 0.934176, loss_d: 0.117980
0.6240 --- loss: 0.853196, loss_ss: 0.806218, loss_d: 0.046978
0.7020 --- loss: 1.137188, loss_ss: 0.901241, loss_d: 0.235946
0.7800 --- loss: 1.112549, loss_ss: 1.056955, loss_d: 0.055595
0.8580 --- loss: 1.229007, loss_ss: 0.885874, loss_d: 0.343134
0.9360 --- loss: 1.121278, loss_ss: 0.973865, loss_d: 0.147413
Epoch finished! Loss: 1.0845133583061397
Starting epoch 8/10.
0.0000 --- loss: 1.026659, loss_ss: 0.811489, loss_d: 0.215170
0.0780 --- loss: 1.013683, loss_ss: 0.820458, loss_d: 0.193225
0.1560 --- loss: 0.799637, loss_ss: 0.716635, loss_d: 0.083002
0.2340 --- loss: 1.054597, loss_ss: 0.949380, loss_d: 0.105217
0.3120 --- loss: 1.035162, loss_ss: 0.892587, loss_d: 0.142575
0.3900 --- loss: 0.982976, loss_ss: 0.943237, loss_d: 0.039739
0.4680 --- loss: 0.790993, loss_ss: 0.769763, loss_d: 0.021230
0.5460 --- loss: 0.999498, loss_ss: 0.961143, loss_d: 0.038355
0.6240 --- loss: 0.866619, loss_ss: 0.859143, loss_d: 0.007476
0.7020 --- loss: 1.063118, loss_ss: 0.859289, loss_d: 0.203829
0.7800 --- loss: 0.938785, loss_ss: 0.926806, loss_d: 0.011979
0.8580 --- loss: 1.026089, loss_ss: 0.914913, loss_d: 0.111176
0.9360 --- loss: 0.786683, loss_ss: 0.696778, loss_d: 0.089905
Epoch finished! Loss: 1.0090748309157789
Starting epoch 9/10.
0.0000 --- loss: 1.022738, loss_ss: 0.968650, loss_d: 0.054088
0.0780 --- loss: 1.006992, loss_ss: 0.911085, loss_d: 0.095907
0.1560 --- loss: 0.863932, loss_ss: 0.841912, loss_d: 0.022021
0.2340 --- loss: 0.924603, loss_ss: 0.865002, loss_d: 0.059601
0.3120 --- loss: 1.351374, loss_ss: 1.003975, loss_d: 0.347399
0.3900 --- loss: 1.208906, loss_ss: 0.988619, loss_d: 0.220287
0.4680 --- loss: 1.046597, loss_ss: 0.999525, loss_d: 0.047073
0.5460 --- loss: 1.026450, loss_ss: 1.003493, loss_d: 0.022957
0.6240 --- loss: 1.630040, loss_ss: 0.857275, loss_d: 0.772765
0.7020 --- loss: 0.806651, loss_ss: 0.791532, loss_d: 0.015119
0.7800 --- loss: 0.948214, loss_ss: 0.908100, loss_d: 0.040115
0.8580 --- loss: 0.905491, loss_ss: 0.809936, loss_d: 0.095554
0.9360 --- loss: 1.152704, loss_ss: 1.140517, loss_d: 0.012187
Epoch finished! Loss: 1.0315421810373664
Starting epoch 10/10.
0.0000 --- loss: 0.833073, loss_ss: 0.797510, loss_d: 0.035563
0.0780 --- loss: 1.379571, loss_ss: 0.860840, loss_d: 0.518731
0.1560 --- loss: 0.874949, loss_ss: 0.868356, loss_d: 0.006593
0.2340 --- loss: 1.125299, loss_ss: 0.830773, loss_d: 0.294526
0.3120 --- loss: 1.326989, loss_ss: 1.237585, loss_d: 0.089403
0.3900 --- loss: 0.818382, loss_ss: 0.796908, loss_d: 0.021474
0.4680 --- loss: 1.183643, loss_ss: 1.134777, loss_d: 0.048866
0.5460 --- loss: 0.888166, loss_ss: 0.884489, loss_d: 0.003677
0.6240 --- loss: 1.320222, loss_ss: 0.702885, loss_d: 0.617336
0.7020 --- loss: 0.971732, loss_ss: 0.919419, loss_d: 0.052312
0.7800 --- loss: 0.999849, loss_ss: 0.996121, loss_d: 0.003728
0.8580 --- loss: 0.910163, loss_ss: 0.783491, loss_d: 0.126672
0.9360 --- loss: 1.018628, loss_ss: 0.972412, loss_d: 0.046216
Epoch finished! Loss: 0.9720359612256289
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6018518518518519
             precision    recall  f1-score   support

        0.0       0.88      0.34      0.49       260
        1.0       0.38      0.12      0.18       248
        2.0       0.92      0.95      0.94       375
        3.0       1.00      0.89      0.94       169
        4.0       0.07      0.93      0.13        28

avg / total       0.78      0.60      0.64      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  83.06  34.23   98.54   88.12     49.31
1  75.19  12.10   93.99   37.50     18.29
2  95.46  94.67   95.89   92.45     93.54
3  98.24  88.76  100.00  100.00     94.04
4  68.43  92.86   67.78    7.12     13.23
Total accuracy: 60.19%
Average sen: 64.52%
Average spec: 91.24%
Macro f1-score: 53.68%
Diagnosis acc on 30mins: 1.0
[0.99999702 0.99998975 0.99999392 0.99998331 0.99961448 0.99680674
 0.99999678 0.9999243  0.99996984 1.         0.99999785 0.99998653
 0.99972588 0.99996758 0.99988973 0.99998701 0.99989283 0.99996543]
pred: 0.999760498603185, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp002-nsrr

=== Test on chp003-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.402459, loss_ss: 1.674257, loss_d: 0.728202
0.0779 --- loss: 2.205328, loss_ss: 1.562390, loss_d: 0.642938
0.1558 --- loss: 1.965139, loss_ss: 1.513215, loss_d: 0.451924
0.2336 --- loss: 2.203317, loss_ss: 1.608581, loss_d: 0.594736
0.3115 --- loss: 2.165331, loss_ss: 1.360631, loss_d: 0.804701
0.3894 --- loss: 1.960485, loss_ss: 1.490708, loss_d: 0.469776
0.4673 --- loss: 2.188841, loss_ss: 1.312886, loss_d: 0.875954
0.5452 --- loss: 1.997187, loss_ss: 1.416000, loss_d: 0.581187
0.6231 --- loss: 2.316241, loss_ss: 1.591014, loss_d: 0.725228
0.7009 --- loss: 2.013887, loss_ss: 1.335508, loss_d: 0.678379
0.7788 --- loss: 1.820245, loss_ss: 1.433541, loss_d: 0.386704
0.8567 --- loss: 1.999736, loss_ss: 1.457323, loss_d: 0.542413
0.9346 --- loss: 1.643525, loss_ss: 1.390145, loss_d: 0.253380
Epoch finished! Loss: 2.035200453363359
Starting epoch 2/10.
0.0000 --- loss: 1.994900, loss_ss: 1.411055, loss_d: 0.583845
0.0779 --- loss: 1.784574, loss_ss: 1.287066, loss_d: 0.497508
0.1558 --- loss: 2.088915, loss_ss: 1.380903, loss_d: 0.708012
0.2336 --- loss: 1.796190, loss_ss: 1.395211, loss_d: 0.400979
0.3115 --- loss: 1.717933, loss_ss: 1.196507, loss_d: 0.521427
0.3894 --- loss: 2.086534, loss_ss: 1.135797, loss_d: 0.950737
0.4673 --- loss: 1.688824, loss_ss: 1.182690, loss_d: 0.506134
0.5452 --- loss: 1.776564, loss_ss: 1.310485, loss_d: 0.466079
0.6231 --- loss: 1.872728, loss_ss: 1.279046, loss_d: 0.593683
0.7009 --- loss: 1.582889, loss_ss: 1.071184, loss_d: 0.511705
0.7788 --- loss: 1.400661, loss_ss: 1.100727, loss_d: 0.299933
0.8567 --- loss: 1.542294, loss_ss: 1.252429, loss_d: 0.289865
0.9346 --- loss: 1.731130, loss_ss: 1.411348, loss_d: 0.319782
Epoch finished! Loss: 1.7739095324650407
Starting epoch 3/10.
0.0000 --- loss: 1.745564, loss_ss: 1.259097, loss_d: 0.486466
0.0779 --- loss: 1.451138, loss_ss: 1.053766, loss_d: 0.397372
0.1558 --- loss: 1.780478, loss_ss: 1.212810, loss_d: 0.567667
0.2336 --- loss: 1.541750, loss_ss: 1.272503, loss_d: 0.269247
0.3115 --- loss: 1.932619, loss_ss: 1.180777, loss_d: 0.751841
0.3894 --- loss: 1.463945, loss_ss: 1.157161, loss_d: 0.306784
0.4673 --- loss: 1.460650, loss_ss: 0.969485, loss_d: 0.491165
0.5452 --- loss: 1.401940, loss_ss: 1.097155, loss_d: 0.304785
0.6231 --- loss: 1.469623, loss_ss: 1.095893, loss_d: 0.373730
0.7009 --- loss: 1.435941, loss_ss: 1.370224, loss_d: 0.065717
0.7788 --- loss: 1.786737, loss_ss: 1.414095, loss_d: 0.372643
0.8567 --- loss: 1.561118, loss_ss: 1.423397, loss_d: 0.137721
0.9346 --- loss: 1.925362, loss_ss: 1.303140, loss_d: 0.622222
Epoch finished! Loss: 1.4982359167188406
Starting epoch 4/10.
0.0000 --- loss: 1.549741, loss_ss: 1.026832, loss_d: 0.522909
0.0779 --- loss: 1.545001, loss_ss: 0.994273, loss_d: 0.550728
0.1558 --- loss: 1.844748, loss_ss: 1.621804, loss_d: 0.222943
0.2336 --- loss: 1.372743, loss_ss: 1.023694, loss_d: 0.349049
0.3115 --- loss: 1.071088, loss_ss: 0.954557, loss_d: 0.116531
0.3894 --- loss: 1.314785, loss_ss: 1.128626, loss_d: 0.186160
0.4673 --- loss: 1.264349, loss_ss: 0.817049, loss_d: 0.447300
0.5452 --- loss: 1.189934, loss_ss: 0.982778, loss_d: 0.207156
0.6231 --- loss: 1.179941, loss_ss: 0.957299, loss_d: 0.222642
0.7009 --- loss: 1.042462, loss_ss: 0.880544, loss_d: 0.161917
0.7788 --- loss: 1.648519, loss_ss: 1.383847, loss_d: 0.264672
0.8567 --- loss: 1.377867, loss_ss: 1.036567, loss_d: 0.341299
0.9346 --- loss: 1.353068, loss_ss: 1.168359, loss_d: 0.184709
Epoch finished! Loss: 1.35844318382442
Starting epoch 5/10.
0.0000 --- loss: 1.156798, loss_ss: 1.026152, loss_d: 0.130647
0.0779 --- loss: 2.297193, loss_ss: 0.995462, loss_d: 1.301731
0.1558 --- loss: 1.020106, loss_ss: 0.949195, loss_d: 0.070911
0.2336 --- loss: 1.196766, loss_ss: 1.047260, loss_d: 0.149506
0.3115 --- loss: 0.915575, loss_ss: 0.845189, loss_d: 0.070385
0.3894 --- loss: 1.190246, loss_ss: 1.112154, loss_d: 0.078093
0.4673 --- loss: 1.072621, loss_ss: 0.893703, loss_d: 0.178918
0.5452 --- loss: 0.915252, loss_ss: 0.865623, loss_d: 0.049630
0.6231 --- loss: 0.997085, loss_ss: 0.936714, loss_d: 0.060371
0.7009 --- loss: 1.224434, loss_ss: 1.142377, loss_d: 0.082057
0.7788 --- loss: 1.216966, loss_ss: 1.009575, loss_d: 0.207392
0.8567 --- loss: 0.988388, loss_ss: 0.961927, loss_d: 0.026461
0.9346 --- loss: 1.244068, loss_ss: 0.953809, loss_d: 0.290258
Epoch finished! Loss: 1.2311233966611326
Starting epoch 6/10.
0.0000 --- loss: 0.937401, loss_ss: 0.888494, loss_d: 0.048907
0.0779 --- loss: 1.296022, loss_ss: 1.046030, loss_d: 0.249992
0.1558 --- loss: 0.972037, loss_ss: 0.926676, loss_d: 0.045361
0.2336 --- loss: 1.274545, loss_ss: 1.039524, loss_d: 0.235021
0.3115 --- loss: 1.223911, loss_ss: 1.207172, loss_d: 0.016739
0.3894 --- loss: 1.311056, loss_ss: 0.963160, loss_d: 0.347896
0.4673 --- loss: 1.157184, loss_ss: 1.105490, loss_d: 0.051694
0.5452 --- loss: 1.123262, loss_ss: 1.084472, loss_d: 0.038790
0.6231 --- loss: 0.961271, loss_ss: 0.837688, loss_d: 0.123582
0.7009 --- loss: 1.169681, loss_ss: 0.841115, loss_d: 0.328566
0.7788 --- loss: 1.015293, loss_ss: 0.972477, loss_d: 0.042816
0.8567 --- loss: 1.389908, loss_ss: 1.274968, loss_d: 0.114940
0.9346 --- loss: 1.463708, loss_ss: 0.867685, loss_d: 0.596023
Epoch finished! Loss: 1.1828813822939992
Starting epoch 7/10.
0.0000 --- loss: 1.248874, loss_ss: 1.182193, loss_d: 0.066681
0.0779 --- loss: 1.008468, loss_ss: 0.950610, loss_d: 0.057858
0.1558 --- loss: 1.080352, loss_ss: 1.042097, loss_d: 0.038254
0.2336 --- loss: 1.377518, loss_ss: 1.362577, loss_d: 0.014941
0.3115 --- loss: 1.071095, loss_ss: 1.047770, loss_d: 0.023325
0.3894 --- loss: 1.131462, loss_ss: 0.784300, loss_d: 0.347162
0.4673 --- loss: 1.030100, loss_ss: 0.897997, loss_d: 0.132103
0.5452 --- loss: 1.038296, loss_ss: 1.002913, loss_d: 0.035383
0.6231 --- loss: 0.907196, loss_ss: 0.863835, loss_d: 0.043361
0.7009 --- loss: 0.782083, loss_ss: 0.710793, loss_d: 0.071290
0.7788 --- loss: 0.863562, loss_ss: 0.836407, loss_d: 0.027155
0.8567 --- loss: 1.033439, loss_ss: 0.968249, loss_d: 0.065190
0.9346 --- loss: 0.917292, loss_ss: 0.832566, loss_d: 0.084727
Epoch finished! Loss: 1.075325551442802
Starting epoch 8/10.
0.0000 --- loss: 0.930848, loss_ss: 0.862438, loss_d: 0.068409
0.0779 --- loss: 1.013045, loss_ss: 1.005190, loss_d: 0.007855
0.1558 --- loss: 1.019720, loss_ss: 0.744100, loss_d: 0.275620
0.2336 --- loss: 1.128653, loss_ss: 1.110848, loss_d: 0.017805
0.3115 --- loss: 1.003755, loss_ss: 0.933486, loss_d: 0.070269
0.3894 --- loss: 0.817873, loss_ss: 0.800944, loss_d: 0.016929
0.4673 --- loss: 1.008399, loss_ss: 0.986610, loss_d: 0.021790
0.5452 --- loss: 0.954270, loss_ss: 0.832005, loss_d: 0.122264
0.6231 --- loss: 0.848842, loss_ss: 0.829085, loss_d: 0.019758
0.7009 --- loss: 1.210260, loss_ss: 1.101220, loss_d: 0.109039
0.7788 --- loss: 1.539291, loss_ss: 1.147412, loss_d: 0.391879
0.8567 --- loss: 1.105083, loss_ss: 0.922603, loss_d: 0.182480
0.9346 --- loss: 0.900228, loss_ss: 0.828573, loss_d: 0.071655
Epoch finished! Loss: 1.0157721024006605
Starting epoch 9/10.
0.0000 --- loss: 0.961070, loss_ss: 0.834720, loss_d: 0.126350
0.0779 --- loss: 1.063403, loss_ss: 1.050636, loss_d: 0.012767
0.1558 --- loss: 0.957511, loss_ss: 0.931734, loss_d: 0.025776
0.2336 --- loss: 0.941900, loss_ss: 0.851798, loss_d: 0.090102
0.3115 --- loss: 0.819702, loss_ss: 0.798487, loss_d: 0.021216
0.3894 --- loss: 1.010178, loss_ss: 1.008359, loss_d: 0.001819
0.4673 --- loss: 1.002753, loss_ss: 0.979818, loss_d: 0.022936
0.5452 --- loss: 1.150644, loss_ss: 1.066978, loss_d: 0.083667
0.6231 --- loss: 1.116563, loss_ss: 1.066095, loss_d: 0.050468
0.7009 --- loss: 0.905352, loss_ss: 0.860781, loss_d: 0.044571
0.7788 --- loss: 0.985631, loss_ss: 0.964344, loss_d: 0.021287
0.8567 --- loss: 0.799933, loss_ss: 0.793132, loss_d: 0.006801
0.9346 --- loss: 0.886981, loss_ss: 0.885269, loss_d: 0.001713
Epoch finished! Loss: 1.0163588016293943
Starting epoch 10/10.
0.0000 --- loss: 0.832864, loss_ss: 0.829692, loss_d: 0.003172
0.0779 --- loss: 1.330976, loss_ss: 0.974028, loss_d: 0.356949
0.1558 --- loss: 0.696479, loss_ss: 0.689153, loss_d: 0.007326
0.2336 --- loss: 1.161302, loss_ss: 1.128629, loss_d: 0.032672
0.3115 --- loss: 0.764807, loss_ss: 0.760592, loss_d: 0.004215
0.3894 --- loss: 0.820750, loss_ss: 0.816419, loss_d: 0.004331
0.4673 --- loss: 0.964061, loss_ss: 0.957469, loss_d: 0.006592
0.5452 --- loss: 0.776366, loss_ss: 0.772420, loss_d: 0.003946
0.6231 --- loss: 0.730002, loss_ss: 0.725769, loss_d: 0.004233
0.7009 --- loss: 0.639056, loss_ss: 0.634923, loss_d: 0.004132
0.7788 --- loss: 0.758780, loss_ss: 0.752116, loss_d: 0.006663
0.8567 --- loss: 0.684441, loss_ss: 0.682911, loss_d: 0.001530
0.9346 --- loss: 0.830208, loss_ss: 0.798887, loss_d: 0.031320
Epoch finished! Loss: 0.9452952896244824
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5052083333333334
             precision    recall  f1-score   support

        0.0       0.21      0.79      0.33        67
        1.0       0.07      0.52      0.13        31
        2.0       0.83      0.59      0.68       468
        3.0       0.98      0.67      0.80       196
        4.0       0.55      0.06      0.10       198

avg / total       0.73      0.51      0.54       960
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  77.19  79.10   77.04  20.54     32.62
1  77.50  51.61   78.36   7.37     12.90
2  73.75  58.55   88.21  82.53     68.50
3  93.02  66.84   99.74  98.50     79.64
4  79.58   5.56   98.82  55.00     10.09
Total accuracy: 50.52%
Average sen: 52.33%
Average spec: 88.44%
Macro f1-score: 40.75%
Diagnosis acc on 30mins: 1.0
[0.99999571 0.9999702  0.99998474 0.99962747 0.99870896 0.99999797
 0.99999964 0.99996591 0.99976677 0.99997723 0.99999785 0.99975771
 0.99999988 0.99988532 0.99986947 0.99997854]
pred: 0.9998427107930183, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp003-nsrr

=== Test on chp004-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.459172, loss_ss: 1.783099, loss_d: 0.676073
0.0779 --- loss: 2.953381, loss_ss: 1.663484, loss_d: 1.289897
0.1558 --- loss: 2.290263, loss_ss: 1.606729, loss_d: 0.683534
0.2336 --- loss: 2.112140, loss_ss: 1.534973, loss_d: 0.577167
0.3115 --- loss: 2.128425, loss_ss: 1.529422, loss_d: 0.599003
0.3894 --- loss: 1.699129, loss_ss: 1.433714, loss_d: 0.265415
0.4673 --- loss: 2.053860, loss_ss: 1.383941, loss_d: 0.669919
0.5452 --- loss: 1.781702, loss_ss: 1.403486, loss_d: 0.378216
0.6231 --- loss: 2.114516, loss_ss: 1.352427, loss_d: 0.762089
0.7009 --- loss: 1.725973, loss_ss: 1.389886, loss_d: 0.336087
0.7788 --- loss: 1.667520, loss_ss: 1.290286, loss_d: 0.377234
0.8567 --- loss: 1.886822, loss_ss: 1.363051, loss_d: 0.523772
0.9346 --- loss: 1.626242, loss_ss: 1.156750, loss_d: 0.469493
Epoch finished! Loss: 2.0975665217265487
Starting epoch 2/10.
0.0000 --- loss: 1.773143, loss_ss: 1.262402, loss_d: 0.510741
0.0779 --- loss: 1.822247, loss_ss: 1.191407, loss_d: 0.630840
0.1558 --- loss: 1.750742, loss_ss: 1.336806, loss_d: 0.413936
0.2336 --- loss: 1.647825, loss_ss: 1.263872, loss_d: 0.383953
0.3115 --- loss: 1.791982, loss_ss: 1.281609, loss_d: 0.510373
0.3894 --- loss: 1.474256, loss_ss: 1.071048, loss_d: 0.403207
0.4673 --- loss: 1.917992, loss_ss: 1.241948, loss_d: 0.676045
0.5452 --- loss: 1.645814, loss_ss: 1.199043, loss_d: 0.446771
0.6231 --- loss: 1.814490, loss_ss: 1.101258, loss_d: 0.713233
0.7009 --- loss: 1.729348, loss_ss: 1.194339, loss_d: 0.535009
0.7788 --- loss: 1.286870, loss_ss: 1.146526, loss_d: 0.140344
0.8567 --- loss: 1.310068, loss_ss: 1.105023, loss_d: 0.205046
0.9346 --- loss: 1.994743, loss_ss: 1.093361, loss_d: 0.901382
Epoch finished! Loss: 1.6774981087073684
Starting epoch 3/10.
0.0000 --- loss: 1.787515, loss_ss: 1.146821, loss_d: 0.640694
0.0779 --- loss: 1.370261, loss_ss: 1.099429, loss_d: 0.270832
0.1558 --- loss: 1.437737, loss_ss: 1.128452, loss_d: 0.309285
0.2336 --- loss: 1.140738, loss_ss: 0.911008, loss_d: 0.229731
0.3115 --- loss: 1.184739, loss_ss: 1.031707, loss_d: 0.153032
0.3894 --- loss: 1.526919, loss_ss: 0.964997, loss_d: 0.561922
0.4673 --- loss: 1.553261, loss_ss: 1.011243, loss_d: 0.542018
0.5452 --- loss: 1.482144, loss_ss: 1.197062, loss_d: 0.285082
0.6231 --- loss: 1.224315, loss_ss: 1.017861, loss_d: 0.206454
0.7009 --- loss: 1.098804, loss_ss: 0.917084, loss_d: 0.181720
0.7788 --- loss: 1.389439, loss_ss: 1.242855, loss_d: 0.146584
0.8567 --- loss: 1.237967, loss_ss: 1.030779, loss_d: 0.207188
0.9346 --- loss: 1.054181, loss_ss: 1.016042, loss_d: 0.038138
Epoch finished! Loss: 1.420798967126757
Starting epoch 4/10.
0.0000 --- loss: 1.598081, loss_ss: 1.262082, loss_d: 0.335999
0.0779 --- loss: 1.501935, loss_ss: 1.216150, loss_d: 0.285784
0.1558 --- loss: 1.532910, loss_ss: 1.088867, loss_d: 0.444043
0.2336 --- loss: 1.199589, loss_ss: 1.052279, loss_d: 0.147309
0.3115 --- loss: 1.156499, loss_ss: 1.055582, loss_d: 0.100917
0.3894 --- loss: 1.152716, loss_ss: 1.042781, loss_d: 0.109935
0.4673 --- loss: 1.202922, loss_ss: 0.916293, loss_d: 0.286629
0.5452 --- loss: 1.332204, loss_ss: 0.859975, loss_d: 0.472229
0.6231 --- loss: 1.219045, loss_ss: 0.938081, loss_d: 0.280964
0.7009 --- loss: 1.187734, loss_ss: 0.913363, loss_d: 0.274370
0.7788 --- loss: 1.392934, loss_ss: 1.244995, loss_d: 0.147939
0.8567 --- loss: 0.945274, loss_ss: 0.831885, loss_d: 0.113389
0.9346 --- loss: 1.191806, loss_ss: 0.930925, loss_d: 0.260881
Epoch finished! Loss: 1.2983050998300314
Starting epoch 5/10.
0.0000 --- loss: 1.247398, loss_ss: 1.013236, loss_d: 0.234162
0.0779 --- loss: 0.837614, loss_ss: 0.723455, loss_d: 0.114159
0.1558 --- loss: 1.012011, loss_ss: 0.853735, loss_d: 0.158276
0.2336 --- loss: 1.129771, loss_ss: 0.930305, loss_d: 0.199466
0.3115 --- loss: 1.009120, loss_ss: 0.908505, loss_d: 0.100615
0.3894 --- loss: 1.241681, loss_ss: 1.180466, loss_d: 0.061215
0.4673 --- loss: 1.044650, loss_ss: 0.829614, loss_d: 0.215036
0.5452 --- loss: 1.057726, loss_ss: 0.917824, loss_d: 0.139902
0.6231 --- loss: 1.342993, loss_ss: 0.787518, loss_d: 0.555475
0.7009 --- loss: 1.051719, loss_ss: 0.997650, loss_d: 0.054069
0.7788 --- loss: 1.234373, loss_ss: 1.105683, loss_d: 0.128690
0.8567 --- loss: 0.948842, loss_ss: 0.934859, loss_d: 0.013983
0.9346 --- loss: 1.107080, loss_ss: 1.033012, loss_d: 0.074068
Epoch finished! Loss: 1.1618329552002251
Starting epoch 6/10.
0.0000 --- loss: 1.080460, loss_ss: 0.852336, loss_d: 0.228124
0.0779 --- loss: 0.965875, loss_ss: 0.939949, loss_d: 0.025926
0.1558 --- loss: 0.818110, loss_ss: 0.727035, loss_d: 0.091075
0.2336 --- loss: 1.254179, loss_ss: 0.993681, loss_d: 0.260499
0.3115 --- loss: 1.060046, loss_ss: 0.921490, loss_d: 0.138556
0.3894 --- loss: 1.073749, loss_ss: 1.047345, loss_d: 0.026404
0.4673 --- loss: 1.133494, loss_ss: 0.689215, loss_d: 0.444278
0.5452 --- loss: 1.506138, loss_ss: 1.101229, loss_d: 0.404909
0.6231 --- loss: 1.099333, loss_ss: 1.077089, loss_d: 0.022244
0.7009 --- loss: 1.080182, loss_ss: 1.039936, loss_d: 0.040246
0.7788 --- loss: 1.147653, loss_ss: 0.941973, loss_d: 0.205680
0.8567 --- loss: 1.212877, loss_ss: 0.991023, loss_d: 0.221854
0.9346 --- loss: 1.126712, loss_ss: 1.064386, loss_d: 0.062326
Epoch finished! Loss: 1.1007666336372495
Starting epoch 7/10.
0.0000 --- loss: 0.976324, loss_ss: 0.933802, loss_d: 0.042522
0.0779 --- loss: 0.856770, loss_ss: 0.842620, loss_d: 0.014151
0.1558 --- loss: 0.903046, loss_ss: 0.852027, loss_d: 0.051019
0.2336 --- loss: 1.369729, loss_ss: 0.742738, loss_d: 0.626991
0.3115 --- loss: 0.853385, loss_ss: 0.842630, loss_d: 0.010755
0.3894 --- loss: 0.930184, loss_ss: 0.739997, loss_d: 0.190187
0.4673 --- loss: 0.905061, loss_ss: 0.885313, loss_d: 0.019748
0.5452 --- loss: 1.608559, loss_ss: 0.766461, loss_d: 0.842098
0.6231 --- loss: 0.992103, loss_ss: 0.806357, loss_d: 0.185745
0.7009 --- loss: 0.841687, loss_ss: 0.812615, loss_d: 0.029071
0.7788 --- loss: 0.998167, loss_ss: 0.821541, loss_d: 0.176626
0.8567 --- loss: 0.870773, loss_ss: 0.819679, loss_d: 0.051094
0.9346 --- loss: 0.845470, loss_ss: 0.837511, loss_d: 0.007959
Epoch finished! Loss: 1.0374627052806318
Starting epoch 8/10.
0.0000 --- loss: 1.159566, loss_ss: 1.107159, loss_d: 0.052407
0.0779 --- loss: 1.126553, loss_ss: 0.826374, loss_d: 0.300179
0.1558 --- loss: 0.713916, loss_ss: 0.702815, loss_d: 0.011102
0.2336 --- loss: 0.828405, loss_ss: 0.799197, loss_d: 0.029208
0.3115 --- loss: 1.117124, loss_ss: 0.902347, loss_d: 0.214777
0.3894 --- loss: 1.157397, loss_ss: 1.072631, loss_d: 0.084766
0.4673 --- loss: 0.641571, loss_ss: 0.601406, loss_d: 0.040165
0.5452 --- loss: 1.036978, loss_ss: 1.023224, loss_d: 0.013754
0.6231 --- loss: 1.010735, loss_ss: 0.988594, loss_d: 0.022140
0.7009 --- loss: 0.890507, loss_ss: 0.883728, loss_d: 0.006779
0.7788 --- loss: 0.810948, loss_ss: 0.622432, loss_d: 0.188517
0.8567 --- loss: 1.108034, loss_ss: 0.825278, loss_d: 0.282756
0.9346 --- loss: 1.116323, loss_ss: 0.794292, loss_d: 0.322031
Epoch finished! Loss: 0.9653942370787263
Starting epoch 9/10.
0.0000 --- loss: 0.826533, loss_ss: 0.731878, loss_d: 0.094656
0.0779 --- loss: 0.748198, loss_ss: 0.743375, loss_d: 0.004822
0.1558 --- loss: 0.891034, loss_ss: 0.884561, loss_d: 0.006473
0.2336 --- loss: 0.955933, loss_ss: 0.937533, loss_d: 0.018399
0.3115 --- loss: 0.901740, loss_ss: 0.877131, loss_d: 0.024609
0.3894 --- loss: 1.015228, loss_ss: 0.967845, loss_d: 0.047383
0.4673 --- loss: 0.825346, loss_ss: 0.748495, loss_d: 0.076852
0.5452 --- loss: 1.023594, loss_ss: 0.895823, loss_d: 0.127771
0.6231 --- loss: 0.793058, loss_ss: 0.773759, loss_d: 0.019299
0.7009 --- loss: 1.049372, loss_ss: 1.037073, loss_d: 0.012299
0.7788 --- loss: 0.712001, loss_ss: 0.610566, loss_d: 0.101435
0.8567 --- loss: 0.885379, loss_ss: 0.881975, loss_d: 0.003403
0.9346 --- loss: 0.937626, loss_ss: 0.932088, loss_d: 0.005538
Epoch finished! Loss: 0.9733760245144367
Starting epoch 10/10.
0.0000 --- loss: 0.786843, loss_ss: 0.776033, loss_d: 0.010810
0.0779 --- loss: 0.773471, loss_ss: 0.743064, loss_d: 0.030407
0.1558 --- loss: 1.018738, loss_ss: 1.010887, loss_d: 0.007851
0.2336 --- loss: 0.875728, loss_ss: 0.824341, loss_d: 0.051386
0.3115 --- loss: 1.239358, loss_ss: 0.885992, loss_d: 0.353366
0.3894 --- loss: 0.848902, loss_ss: 0.843558, loss_d: 0.005344
0.4673 --- loss: 0.794303, loss_ss: 0.779988, loss_d: 0.014316
0.5452 --- loss: 1.163444, loss_ss: 1.148567, loss_d: 0.014877
0.6231 --- loss: 1.005684, loss_ss: 0.896738, loss_d: 0.108946
0.7009 --- loss: 0.849740, loss_ss: 0.827386, loss_d: 0.022354
0.7788 --- loss: 0.961993, loss_ss: 0.601936, loss_d: 0.360057
0.8567 --- loss: 0.705472, loss_ss: 0.694122, loss_d: 0.011351
0.9346 --- loss: 0.776664, loss_ss: 0.770113, loss_d: 0.006551
Epoch finished! Loss: 0.9317244631238282
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6177083333333333
             precision    recall  f1-score   support

        0.0       0.47      0.44      0.45       135
        1.0       0.30      0.26      0.28       141
        2.0       0.69      0.85      0.76       354
        3.0       1.00      0.53      0.70       197
        4.0       0.53      0.68      0.60       133

avg / total       0.64      0.62      0.61       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.21  43.70   92.00   47.20     45.38
1  80.31  26.24   89.62   30.33     28.14
2  80.31  85.31   77.39   68.79     76.17
3  90.42  53.30  100.00  100.00     69.54
4  87.29  67.67   90.45   53.25     59.60
Total accuracy: 61.77%
Average sen: 55.24%
Average spec: 89.89%
Macro f1-score: 55.77%
Diagnosis acc on 30mins: 0.9375
[0.99858934 0.99301106 0.99917763 0.99999392 0.99973279 0.99999797
 0.9798069  0.99999368 0.99993157 0.99872082 0.99997103 0.9999969
 0.99989343 0.05107088 0.99615842 0.99982208]
pred: 0.9384917772840708, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp004-nsrr

=== Test on chp005-nsrr. train_data(1279), test_data(21) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.320069, loss_ss: 1.622585, loss_d: 0.697484
0.0782 --- loss: 2.222487, loss_ss: 1.612437, loss_d: 0.610050
0.1564 --- loss: 2.028885, loss_ss: 1.454222, loss_d: 0.574664
0.2346 --- loss: 2.002791, loss_ss: 1.481503, loss_d: 0.521288
0.3127 --- loss: 1.920142, loss_ss: 1.245255, loss_d: 0.674888
0.3909 --- loss: 2.260442, loss_ss: 1.478454, loss_d: 0.781988
0.4691 --- loss: 1.724992, loss_ss: 1.256390, loss_d: 0.468602
0.5473 --- loss: 1.999394, loss_ss: 1.357673, loss_d: 0.641721
0.6255 --- loss: 2.041173, loss_ss: 1.254950, loss_d: 0.786223
0.7037 --- loss: 1.949666, loss_ss: 1.500238, loss_d: 0.449428
0.7819 --- loss: 1.678468, loss_ss: 1.436236, loss_d: 0.242232
0.8600 --- loss: 1.927890, loss_ss: 1.349012, loss_d: 0.578878
0.9382 --- loss: 1.682150, loss_ss: 1.195753, loss_d: 0.486398
Epoch finished! Loss: 2.037817252902534
Starting epoch 2/10.
0.0000 --- loss: 1.915256, loss_ss: 1.361262, loss_d: 0.553994
0.0782 --- loss: 1.684839, loss_ss: 1.078898, loss_d: 0.605941
0.1564 --- loss: 2.220049, loss_ss: 1.265083, loss_d: 0.954966
0.2346 --- loss: 1.461969, loss_ss: 1.172184, loss_d: 0.289785
0.3127 --- loss: 1.571188, loss_ss: 1.141767, loss_d: 0.429421
0.3909 --- loss: 1.755699, loss_ss: 1.278687, loss_d: 0.477012
0.4691 --- loss: 1.449901, loss_ss: 1.171817, loss_d: 0.278084
0.5473 --- loss: 1.487401, loss_ss: 1.332192, loss_d: 0.155209
0.6255 --- loss: 1.794585, loss_ss: 1.264956, loss_d: 0.529630
0.7037 --- loss: 1.671116, loss_ss: 1.073061, loss_d: 0.598055
0.7819 --- loss: 1.450236, loss_ss: 1.189349, loss_d: 0.260887
0.8600 --- loss: 1.369223, loss_ss: 1.114446, loss_d: 0.254777
0.9382 --- loss: 1.846124, loss_ss: 1.379201, loss_d: 0.466923
Epoch finished! Loss: 1.6972492032163724
Starting epoch 3/10.
0.0000 --- loss: 1.321490, loss_ss: 1.053460, loss_d: 0.268030
0.0782 --- loss: 1.459743, loss_ss: 1.186205, loss_d: 0.273538
0.1564 --- loss: 1.230456, loss_ss: 0.999374, loss_d: 0.231082
0.2346 --- loss: 1.720384, loss_ss: 1.049077, loss_d: 0.671308
0.3127 --- loss: 1.229910, loss_ss: 1.095337, loss_d: 0.134573
0.3909 --- loss: 1.386667, loss_ss: 0.988926, loss_d: 0.397742
0.4691 --- loss: 1.266451, loss_ss: 1.117483, loss_d: 0.148968
0.5473 --- loss: 1.687763, loss_ss: 0.906260, loss_d: 0.781504
0.6255 --- loss: 1.338640, loss_ss: 1.207530, loss_d: 0.131111
0.7037 --- loss: 1.264917, loss_ss: 0.986819, loss_d: 0.278098
0.7819 --- loss: 1.465845, loss_ss: 0.972408, loss_d: 0.493437
0.8600 --- loss: 1.218924, loss_ss: 0.931508, loss_d: 0.287416
0.9382 --- loss: 1.240238, loss_ss: 1.010331, loss_d: 0.229907
Epoch finished! Loss: 1.5023659993344405
Starting epoch 4/10.
0.0000 --- loss: 1.243910, loss_ss: 1.086381, loss_d: 0.157529
0.0782 --- loss: 1.356791, loss_ss: 1.123000, loss_d: 0.233791
0.1564 --- loss: 1.251735, loss_ss: 1.080954, loss_d: 0.170781
0.2346 --- loss: 1.350463, loss_ss: 1.100462, loss_d: 0.250001
0.3127 --- loss: 1.467376, loss_ss: 1.033777, loss_d: 0.433599
0.3909 --- loss: 1.288975, loss_ss: 1.165550, loss_d: 0.123425
0.4691 --- loss: 1.084354, loss_ss: 0.981638, loss_d: 0.102716
0.5473 --- loss: 1.473457, loss_ss: 1.023968, loss_d: 0.449489
0.6255 --- loss: 1.185918, loss_ss: 0.875430, loss_d: 0.310488
0.7037 --- loss: 1.174597, loss_ss: 1.104232, loss_d: 0.070365
0.7819 --- loss: 1.353025, loss_ss: 1.033206, loss_d: 0.319819
0.8600 --- loss: 1.414651, loss_ss: 0.969767, loss_d: 0.444884
0.9382 --- loss: 1.282170, loss_ss: 1.121947, loss_d: 0.160223
Epoch finished! Loss: 1.3418847078413476
Starting epoch 5/10.
0.0000 --- loss: 1.418916, loss_ss: 1.045957, loss_d: 0.372959
0.0782 --- loss: 1.133191, loss_ss: 1.055614, loss_d: 0.077577
0.1564 --- loss: 1.232641, loss_ss: 1.016906, loss_d: 0.215735
0.2346 --- loss: 1.075464, loss_ss: 1.002892, loss_d: 0.072573
0.3127 --- loss: 0.996707, loss_ss: 0.983644, loss_d: 0.013063
0.3909 --- loss: 1.355333, loss_ss: 1.313881, loss_d: 0.041453
0.4691 --- loss: 1.528571, loss_ss: 1.290945, loss_d: 0.237625
0.5473 --- loss: 1.216059, loss_ss: 0.934241, loss_d: 0.281818
0.6255 --- loss: 0.921293, loss_ss: 0.890014, loss_d: 0.031280
0.7037 --- loss: 1.376030, loss_ss: 1.109340, loss_d: 0.266690
0.7819 --- loss: 1.242426, loss_ss: 1.166683, loss_d: 0.075743
0.8600 --- loss: 1.399942, loss_ss: 1.070150, loss_d: 0.329792
0.9382 --- loss: 0.916314, loss_ss: 0.826995, loss_d: 0.089319
Epoch finished! Loss: 1.254685724344779
Starting epoch 6/10.
0.0000 --- loss: 1.372603, loss_ss: 1.105695, loss_d: 0.266908
0.0782 --- loss: 0.874503, loss_ss: 0.858363, loss_d: 0.016140
0.1564 --- loss: 0.998829, loss_ss: 0.885337, loss_d: 0.113492
0.2346 --- loss: 1.128180, loss_ss: 1.039335, loss_d: 0.088845
0.3127 --- loss: 1.611703, loss_ss: 1.129875, loss_d: 0.481828
0.3909 --- loss: 1.440495, loss_ss: 1.001116, loss_d: 0.439379
0.4691 --- loss: 1.324569, loss_ss: 1.251165, loss_d: 0.073404
0.5473 --- loss: 1.431377, loss_ss: 0.891297, loss_d: 0.540080
0.6255 --- loss: 1.489894, loss_ss: 1.178709, loss_d: 0.311185
0.7037 --- loss: 0.878470, loss_ss: 0.856226, loss_d: 0.022244
0.7819 --- loss: 1.292898, loss_ss: 1.248089, loss_d: 0.044809
0.8600 --- loss: 0.972234, loss_ss: 0.941567, loss_d: 0.030668
0.9382 --- loss: 1.138383, loss_ss: 1.094558, loss_d: 0.043825
Epoch finished! Loss: 1.1627995700348082
Starting epoch 7/10.
0.0000 --- loss: 1.232605, loss_ss: 1.093151, loss_d: 0.139454
0.0782 --- loss: 0.929769, loss_ss: 0.835653, loss_d: 0.094116
0.1564 --- loss: 1.045516, loss_ss: 0.996910, loss_d: 0.048606
0.2346 --- loss: 1.116969, loss_ss: 0.810705, loss_d: 0.306264
0.3127 --- loss: 0.938186, loss_ss: 0.862500, loss_d: 0.075686
0.3909 --- loss: 1.154011, loss_ss: 0.998847, loss_d: 0.155164
0.4691 --- loss: 1.094862, loss_ss: 1.093597, loss_d: 0.001265
0.5473 --- loss: 1.084543, loss_ss: 1.080670, loss_d: 0.003873
0.6255 --- loss: 1.289068, loss_ss: 1.253552, loss_d: 0.035517
0.7037 --- loss: 1.012946, loss_ss: 0.864259, loss_d: 0.148687
0.7819 --- loss: 0.935654, loss_ss: 0.868998, loss_d: 0.066656
0.8600 --- loss: 0.888488, loss_ss: 0.879917, loss_d: 0.008570
0.9382 --- loss: 1.792839, loss_ss: 0.883139, loss_d: 0.909700
Epoch finished! Loss: 1.0779739214679387
Starting epoch 8/10.
0.0000 --- loss: 0.963840, loss_ss: 0.937995, loss_d: 0.025845
0.0782 --- loss: 0.831959, loss_ss: 0.785961, loss_d: 0.045998
0.1564 --- loss: 1.307458, loss_ss: 1.152465, loss_d: 0.154993
0.2346 --- loss: 0.898433, loss_ss: 0.854288, loss_d: 0.044144
0.3127 --- loss: 1.007274, loss_ss: 0.985432, loss_d: 0.021842
0.3909 --- loss: 1.043835, loss_ss: 1.028683, loss_d: 0.015152
0.4691 --- loss: 1.066161, loss_ss: 1.051757, loss_d: 0.014404
0.5473 --- loss: 1.016056, loss_ss: 0.956504, loss_d: 0.059552
0.6255 --- loss: 1.039839, loss_ss: 0.767341, loss_d: 0.272498
0.7037 --- loss: 1.000944, loss_ss: 0.995373, loss_d: 0.005571
0.7819 --- loss: 0.908071, loss_ss: 0.871266, loss_d: 0.036805
0.8600 --- loss: 1.017666, loss_ss: 0.908383, loss_d: 0.109282
0.9382 --- loss: 0.975091, loss_ss: 0.826653, loss_d: 0.148438
Epoch finished! Loss: 1.0377692035802706
Starting epoch 9/10.
0.0000 --- loss: 1.043887, loss_ss: 1.014391, loss_d: 0.029496
0.0782 --- loss: 0.879623, loss_ss: 0.654529, loss_d: 0.225094
0.1564 --- loss: 0.871220, loss_ss: 0.863648, loss_d: 0.007572
0.2346 --- loss: 1.031879, loss_ss: 1.000201, loss_d: 0.031678
0.3127 --- loss: 0.875544, loss_ss: 0.872242, loss_d: 0.003302
0.3909 --- loss: 1.182994, loss_ss: 0.996945, loss_d: 0.186049
0.4691 --- loss: 0.861621, loss_ss: 0.858435, loss_d: 0.003186
0.5473 --- loss: 0.742415, loss_ss: 0.703962, loss_d: 0.038453
0.6255 --- loss: 0.977193, loss_ss: 0.967507, loss_d: 0.009686
0.7037 --- loss: 0.781613, loss_ss: 0.771125, loss_d: 0.010488
0.7819 --- loss: 1.248260, loss_ss: 1.203110, loss_d: 0.045150
0.8600 --- loss: 1.267320, loss_ss: 0.958288, loss_d: 0.309032
0.9382 --- loss: 1.002512, loss_ss: 0.880440, loss_d: 0.122071
Epoch finished! Loss: 0.9920891467041857
Starting epoch 10/10.
0.0000 --- loss: 1.121365, loss_ss: 1.110167, loss_d: 0.011198
0.0782 --- loss: 1.131692, loss_ss: 0.993216, loss_d: 0.138476
0.1564 --- loss: 0.895854, loss_ss: 0.884172, loss_d: 0.011682
0.2346 --- loss: 0.985364, loss_ss: 0.977029, loss_d: 0.008335
0.3127 --- loss: 0.804524, loss_ss: 0.721611, loss_d: 0.082912
0.3909 --- loss: 1.076227, loss_ss: 1.074793, loss_d: 0.001434
0.4691 --- loss: 0.969027, loss_ss: 0.786976, loss_d: 0.182051
0.5473 --- loss: 0.859208, loss_ss: 0.846734, loss_d: 0.012475
0.6255 --- loss: 0.913701, loss_ss: 0.908321, loss_d: 0.005380
0.7037 --- loss: 1.042317, loss_ss: 1.034155, loss_d: 0.008162
0.7819 --- loss: 0.927096, loss_ss: 0.796054, loss_d: 0.131042
0.8600 --- loss: 2.056003, loss_ss: 1.002325, loss_d: 1.053678
0.9382 --- loss: 0.740692, loss_ss: 0.736361, loss_d: 0.004330
Epoch finished! Loss: 0.9566316834584935
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6349206349206349
             precision    recall  f1-score   support

        0.0       0.30      0.41      0.35        63
        1.0       0.44      0.03      0.06       235
        2.0       0.70      0.98      0.81       565
        3.0       0.97      0.21      0.34       136
        4.0       0.56      0.70      0.62       261

avg / total       0.63      0.63      0.56      1260
 


====== chp005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.22  41.27   94.90  29.89     34.67
1  81.19   3.40   99.02  44.44      6.32
2  79.92  98.05   65.18  69.60     81.41
3  91.35  20.59   99.91  96.55     33.94
4  82.30  70.50   85.39  55.76     62.27
Total accuracy: 63.49%
Average sen: 46.76%
Average spec: 88.88%
Macro f1-score: 43.72%
Diagnosis acc on 30mins: 1.0
[0.99999917 0.99994779 0.99989593 0.99994898 0.99998546 0.99999332
 0.99999452 0.99999988 0.99999952 0.99999583 0.99997473 0.99999583
 0.99999976 0.99999964 0.99999738 0.99998617 0.99999559 0.99997675
 0.99996662 0.99999845 1.        ]
pred: 0.9999833958489555, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp005-nsrr

=== Test on chp006-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.405550, loss_ss: 1.725909, loss_d: 0.679642
0.0780 --- loss: 2.493472, loss_ss: 1.613991, loss_d: 0.879481
0.1560 --- loss: 2.148285, loss_ss: 1.547431, loss_d: 0.600854
0.2340 --- loss: 1.779259, loss_ss: 1.476733, loss_d: 0.302526
0.3120 --- loss: 2.130150, loss_ss: 1.568213, loss_d: 0.561937
0.3900 --- loss: 1.855115, loss_ss: 1.405315, loss_d: 0.449800
0.4680 --- loss: 2.029849, loss_ss: 1.483517, loss_d: 0.546332
0.5460 --- loss: 2.394097, loss_ss: 1.425256, loss_d: 0.968841
0.6240 --- loss: 2.073519, loss_ss: 1.410223, loss_d: 0.663296
0.7020 --- loss: 2.095505, loss_ss: 1.415815, loss_d: 0.679690
0.7800 --- loss: 1.725894, loss_ss: 1.324014, loss_d: 0.401880
0.8580 --- loss: 1.762923, loss_ss: 1.373625, loss_d: 0.389298
0.9360 --- loss: 1.875202, loss_ss: 1.248964, loss_d: 0.626238
Epoch finished! Loss: 2.0580297289416194
Starting epoch 2/10.
0.0000 --- loss: 2.127326, loss_ss: 1.379981, loss_d: 0.747346
0.0780 --- loss: 1.939958, loss_ss: 1.381986, loss_d: 0.557972
0.1560 --- loss: 1.541884, loss_ss: 1.260605, loss_d: 0.281279
0.2340 --- loss: 1.682307, loss_ss: 1.354134, loss_d: 0.328174
0.3120 --- loss: 1.939126, loss_ss: 1.358195, loss_d: 0.580931
0.3900 --- loss: 1.661377, loss_ss: 1.206925, loss_d: 0.454451
0.4680 --- loss: 1.751596, loss_ss: 1.185450, loss_d: 0.566146
0.5460 --- loss: 1.859953, loss_ss: 1.239206, loss_d: 0.620747
0.6240 --- loss: 1.473803, loss_ss: 1.281679, loss_d: 0.192124
0.7020 --- loss: 1.338680, loss_ss: 1.129293, loss_d: 0.209387
0.7800 --- loss: 1.755496, loss_ss: 1.275709, loss_d: 0.479787
0.8580 --- loss: 1.601014, loss_ss: 1.061968, loss_d: 0.539047
0.9360 --- loss: 1.913023, loss_ss: 1.173910, loss_d: 0.739112
Epoch finished! Loss: 1.72507203835994
Starting epoch 3/10.
0.0000 --- loss: 1.396555, loss_ss: 1.023047, loss_d: 0.373508
0.0780 --- loss: 1.492554, loss_ss: 1.118599, loss_d: 0.373955
0.1560 --- loss: 1.394813, loss_ss: 1.275254, loss_d: 0.119559
0.2340 --- loss: 1.375065, loss_ss: 1.052862, loss_d: 0.322203
0.3120 --- loss: 1.247748, loss_ss: 1.141047, loss_d: 0.106701
0.3900 --- loss: 1.025298, loss_ss: 0.862087, loss_d: 0.163211
0.4680 --- loss: 1.709383, loss_ss: 1.262436, loss_d: 0.446947
0.5460 --- loss: 1.512854, loss_ss: 1.193268, loss_d: 0.319586
0.6240 --- loss: 1.550350, loss_ss: 1.127205, loss_d: 0.423145
0.7020 --- loss: 1.078727, loss_ss: 0.969471, loss_d: 0.109256
0.7800 --- loss: 1.151293, loss_ss: 0.915537, loss_d: 0.235755
0.8580 --- loss: 1.342890, loss_ss: 1.115148, loss_d: 0.227742
0.9360 --- loss: 1.223788, loss_ss: 1.072089, loss_d: 0.151699
Epoch finished! Loss: 1.4446771629154682
Starting epoch 4/10.
0.0000 --- loss: 1.266808, loss_ss: 0.931308, loss_d: 0.335500
0.0780 --- loss: 1.563744, loss_ss: 1.269878, loss_d: 0.293866
0.1560 --- loss: 1.340964, loss_ss: 0.936776, loss_d: 0.404187
0.2340 --- loss: 1.358037, loss_ss: 1.144315, loss_d: 0.213722
0.3120 --- loss: 1.488377, loss_ss: 0.939402, loss_d: 0.548976
0.3900 --- loss: 1.124276, loss_ss: 0.874679, loss_d: 0.249597
0.4680 --- loss: 1.606654, loss_ss: 1.344398, loss_d: 0.262256
0.5460 --- loss: 1.013634, loss_ss: 0.935905, loss_d: 0.077729
0.6240 --- loss: 1.111692, loss_ss: 1.039305, loss_d: 0.072387
0.7020 --- loss: 1.434480, loss_ss: 0.927740, loss_d: 0.506741
0.7800 --- loss: 1.302119, loss_ss: 1.139780, loss_d: 0.162339
0.8580 --- loss: 1.413569, loss_ss: 1.018113, loss_d: 0.395456
0.9360 --- loss: 1.209149, loss_ss: 0.872636, loss_d: 0.336512
Epoch finished! Loss: 1.328703224658966
Starting epoch 5/10.
0.0000 --- loss: 1.187061, loss_ss: 0.948096, loss_d: 0.238966
0.0780 --- loss: 1.733076, loss_ss: 1.316668, loss_d: 0.416408
0.1560 --- loss: 1.067735, loss_ss: 0.908401, loss_d: 0.159334
0.2340 --- loss: 1.171815, loss_ss: 0.861395, loss_d: 0.310420
0.3120 --- loss: 1.249733, loss_ss: 0.931036, loss_d: 0.318697
0.3900 --- loss: 1.183265, loss_ss: 0.995566, loss_d: 0.187699
0.4680 --- loss: 1.268485, loss_ss: 0.865541, loss_d: 0.402943
0.5460 --- loss: 1.053630, loss_ss: 0.808552, loss_d: 0.245078
0.6240 --- loss: 1.031607, loss_ss: 0.882533, loss_d: 0.149074
0.7020 --- loss: 1.465396, loss_ss: 0.926064, loss_d: 0.539331
0.7800 --- loss: 1.400385, loss_ss: 1.199089, loss_d: 0.201296
0.8580 --- loss: 1.061111, loss_ss: 0.945520, loss_d: 0.115591
0.9360 --- loss: 1.366399, loss_ss: 1.028715, loss_d: 0.337684
Epoch finished! Loss: 1.23738953191787
Starting epoch 6/10.
0.0000 --- loss: 1.082150, loss_ss: 0.901361, loss_d: 0.180790
0.0780 --- loss: 1.080214, loss_ss: 0.947341, loss_d: 0.132873
0.1560 --- loss: 1.137926, loss_ss: 1.083617, loss_d: 0.054309
0.2340 --- loss: 1.136050, loss_ss: 0.818006, loss_d: 0.318045
0.3120 --- loss: 1.037873, loss_ss: 0.945886, loss_d: 0.091987
0.3900 --- loss: 1.082538, loss_ss: 0.838059, loss_d: 0.244480
0.4680 --- loss: 1.445985, loss_ss: 0.963772, loss_d: 0.482213
0.5460 --- loss: 1.057292, loss_ss: 0.969214, loss_d: 0.088078
0.6240 --- loss: 1.087316, loss_ss: 0.901537, loss_d: 0.185779
0.7020 --- loss: 1.612153, loss_ss: 0.822046, loss_d: 0.790107
0.7800 --- loss: 1.074242, loss_ss: 1.054849, loss_d: 0.019393
0.8580 --- loss: 1.043461, loss_ss: 0.872419, loss_d: 0.171042
0.9360 --- loss: 0.841645, loss_ss: 0.743917, loss_d: 0.097728
Epoch finished! Loss: 1.0630179848521948
Starting epoch 7/10.
0.0000 --- loss: 1.048373, loss_ss: 1.023188, loss_d: 0.025185
0.0780 --- loss: 0.846342, loss_ss: 0.758657, loss_d: 0.087685
0.1560 --- loss: 0.929842, loss_ss: 0.903889, loss_d: 0.025953
0.2340 --- loss: 0.932900, loss_ss: 0.894773, loss_d: 0.038128
0.3120 --- loss: 1.066560, loss_ss: 1.057995, loss_d: 0.008565
0.3900 --- loss: 0.862258, loss_ss: 0.859582, loss_d: 0.002676
0.4680 --- loss: 0.785452, loss_ss: 0.774737, loss_d: 0.010715
0.5460 --- loss: 1.072670, loss_ss: 0.800967, loss_d: 0.271703
0.6240 --- loss: 1.086599, loss_ss: 1.058056, loss_d: 0.028544
0.7020 --- loss: 1.152323, loss_ss: 1.035358, loss_d: 0.116964
0.7800 --- loss: 1.027193, loss_ss: 0.961483, loss_d: 0.065709
0.8580 --- loss: 0.854014, loss_ss: 0.831988, loss_d: 0.022025
0.9360 --- loss: 1.199365, loss_ss: 0.851982, loss_d: 0.347383
Epoch finished! Loss: 1.0277507179416716
Starting epoch 8/10.
0.0000 --- loss: 0.946669, loss_ss: 0.914859, loss_d: 0.031810
0.0780 --- loss: 1.010614, loss_ss: 0.962543, loss_d: 0.048071
0.1560 --- loss: 0.768698, loss_ss: 0.748202, loss_d: 0.020496
0.2340 --- loss: 1.324799, loss_ss: 1.151685, loss_d: 0.173114
0.3120 --- loss: 0.801626, loss_ss: 0.767097, loss_d: 0.034528
0.3900 --- loss: 1.460672, loss_ss: 0.961981, loss_d: 0.498691
0.4680 --- loss: 0.808831, loss_ss: 0.763779, loss_d: 0.045052
0.5460 --- loss: 1.213534, loss_ss: 0.820764, loss_d: 0.392770
0.6240 --- loss: 1.243386, loss_ss: 0.959456, loss_d: 0.283930
0.7020 --- loss: 0.956641, loss_ss: 0.847895, loss_d: 0.108746
0.7800 --- loss: 0.883328, loss_ss: 0.831195, loss_d: 0.052133
0.8580 --- loss: 1.050382, loss_ss: 1.025575, loss_d: 0.024807
0.9360 --- loss: 1.125456, loss_ss: 0.938387, loss_d: 0.187069
Epoch finished! Loss: 1.013969300314784
Starting epoch 9/10.
0.0000 --- loss: 1.819799, loss_ss: 1.049225, loss_d: 0.770574
0.0780 --- loss: 0.847760, loss_ss: 0.784853, loss_d: 0.062907
0.1560 --- loss: 0.998330, loss_ss: 0.922472, loss_d: 0.075858
0.2340 --- loss: 0.858200, loss_ss: 0.826784, loss_d: 0.031416
0.3120 --- loss: 0.759286, loss_ss: 0.725153, loss_d: 0.034133
0.3900 --- loss: 0.729608, loss_ss: 0.715191, loss_d: 0.014417
0.4680 --- loss: 1.056871, loss_ss: 0.955085, loss_d: 0.101786
0.5460 --- loss: 0.834598, loss_ss: 0.819546, loss_d: 0.015052
0.6240 --- loss: 0.906211, loss_ss: 0.811517, loss_d: 0.094694
0.7020 --- loss: 0.938151, loss_ss: 0.924870, loss_d: 0.013281
0.7800 --- loss: 0.882316, loss_ss: 0.874335, loss_d: 0.007981
0.8580 --- loss: 1.208375, loss_ss: 0.969414, loss_d: 0.238961
0.9360 --- loss: 0.940549, loss_ss: 0.875385, loss_d: 0.065164
Epoch finished! Loss: 0.9695273358374834
Starting epoch 10/10.
0.0000 --- loss: 0.787517, loss_ss: 0.744803, loss_d: 0.042714
0.0780 --- loss: 1.047221, loss_ss: 0.887522, loss_d: 0.159699
0.1560 --- loss: 0.932088, loss_ss: 0.930278, loss_d: 0.001810
0.2340 --- loss: 0.688355, loss_ss: 0.678741, loss_d: 0.009615
0.3120 --- loss: 0.850752, loss_ss: 0.842514, loss_d: 0.008238
0.3900 --- loss: 0.670029, loss_ss: 0.657006, loss_d: 0.013022
0.4680 --- loss: 1.037853, loss_ss: 0.865340, loss_d: 0.172513
0.5460 --- loss: 0.874155, loss_ss: 0.866911, loss_d: 0.007244
0.6240 --- loss: 0.834148, loss_ss: 0.763597, loss_d: 0.070551
0.7020 --- loss: 0.998317, loss_ss: 0.983218, loss_d: 0.015099
0.7800 --- loss: 0.776459, loss_ss: 0.756013, loss_d: 0.020446
0.8580 --- loss: 0.882744, loss_ss: 0.846052, loss_d: 0.036692
0.9360 --- loss: 1.076928, loss_ss: 0.985662, loss_d: 0.091266
Epoch finished! Loss: 0.9429038162343204
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6027777777777777
             precision    recall  f1-score   support

        0.0       0.59      0.69      0.64       120
        1.0       0.60      0.05      0.09       322
        2.0       0.66      0.92      0.77       274
        3.0       1.00      0.77      0.87       224
        4.0       0.35      0.91      0.51       140

avg / total       0.67      0.60      0.54      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.20  69.17   93.96   58.87     63.60
1  70.65   4.66   98.68   60.00      8.65
2  86.11  92.34   84.00   66.23     77.13
3  95.28  77.23  100.00  100.00     87.15
4  77.31  90.71   75.32   35.38     50.90
Total accuracy: 60.28%
Average sen: 66.82%
Average spec: 90.39%
Macro f1-score: 57.49%
Diagnosis acc on 30mins: 1.0
[0.99926704 0.99840766 0.99992061 0.99993229 1.         0.99986541
 0.99986041 0.99995649 0.99990833 0.99968898 0.99999499 0.99996257
 0.99982846 0.99992383 0.99999142 0.99999297 0.99999416 0.99991667]
pred: 0.9998006820678711, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp006-nsrr

=== Test on chp007-nsrr. train_data(1281), test_data(19) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.376937, loss_ss: 1.666357, loss_d: 0.710579
0.0781 --- loss: 2.202287, loss_ss: 1.564449, loss_d: 0.637838
0.1561 --- loss: 1.872839, loss_ss: 1.454721, loss_d: 0.418119
0.2342 --- loss: 2.244817, loss_ss: 1.428758, loss_d: 0.816059
0.3123 --- loss: 1.928004, loss_ss: 1.321671, loss_d: 0.606333
0.3903 --- loss: 1.756414, loss_ss: 1.336519, loss_d: 0.419894
0.4684 --- loss: 1.871086, loss_ss: 1.316373, loss_d: 0.554713
0.5464 --- loss: 2.140594, loss_ss: 1.368108, loss_d: 0.772486
0.6245 --- loss: 2.054202, loss_ss: 1.376436, loss_d: 0.677766
0.7026 --- loss: 1.888096, loss_ss: 1.258958, loss_d: 0.629138
0.7806 --- loss: 1.935009, loss_ss: 1.493993, loss_d: 0.441016
0.8587 --- loss: 2.228470, loss_ss: 1.148621, loss_d: 1.079849
0.9368 --- loss: 1.996320, loss_ss: 1.157855, loss_d: 0.838465
Epoch finished! Loss: 1.9824133096262813
Starting epoch 2/10.
0.0000 --- loss: 2.044838, loss_ss: 1.392909, loss_d: 0.651930
0.0781 --- loss: 1.964333, loss_ss: 1.138114, loss_d: 0.826219
0.1561 --- loss: 1.997092, loss_ss: 1.173206, loss_d: 0.823886
0.2342 --- loss: 1.769382, loss_ss: 1.355400, loss_d: 0.413983
0.3123 --- loss: 1.877478, loss_ss: 1.298282, loss_d: 0.579196
0.3903 --- loss: 1.768220, loss_ss: 1.330773, loss_d: 0.437447
0.4684 --- loss: 1.637518, loss_ss: 1.352205, loss_d: 0.285313
0.5464 --- loss: 1.542233, loss_ss: 1.288247, loss_d: 0.253987
0.6245 --- loss: 1.469636, loss_ss: 1.163050, loss_d: 0.306586
0.7026 --- loss: 1.568123, loss_ss: 1.148302, loss_d: 0.419821
0.7806 --- loss: 1.371180, loss_ss: 1.126374, loss_d: 0.244806
0.8587 --- loss: 1.364112, loss_ss: 1.039989, loss_d: 0.324123
0.9368 --- loss: 1.519509, loss_ss: 1.186771, loss_d: 0.332738
Epoch finished! Loss: 1.682826813776046
Starting epoch 3/10.
0.0000 --- loss: 1.894917, loss_ss: 1.357589, loss_d: 0.537328
0.0781 --- loss: 1.355145, loss_ss: 1.175333, loss_d: 0.179812
0.1561 --- loss: 1.234426, loss_ss: 1.040101, loss_d: 0.194325
0.2342 --- loss: 1.587027, loss_ss: 1.095732, loss_d: 0.491295
0.3123 --- loss: 1.603246, loss_ss: 1.129516, loss_d: 0.473731
0.3903 --- loss: 1.637357, loss_ss: 1.139573, loss_d: 0.497785
0.4684 --- loss: 1.443594, loss_ss: 1.136827, loss_d: 0.306766
0.5464 --- loss: 1.170768, loss_ss: 0.924542, loss_d: 0.246226
0.6245 --- loss: 1.122385, loss_ss: 0.918334, loss_d: 0.204051
0.7026 --- loss: 1.194263, loss_ss: 0.996336, loss_d: 0.197927
0.7806 --- loss: 1.600077, loss_ss: 0.896101, loss_d: 0.703976
0.8587 --- loss: 1.643562, loss_ss: 1.176277, loss_d: 0.467285
0.9368 --- loss: 1.512115, loss_ss: 1.117304, loss_d: 0.394811
Epoch finished! Loss: 1.4550615046173334
Starting epoch 4/10.
0.0000 --- loss: 1.369550, loss_ss: 1.039677, loss_d: 0.329873
0.0781 --- loss: 1.490785, loss_ss: 1.072065, loss_d: 0.418720
0.1561 --- loss: 1.371823, loss_ss: 1.167610, loss_d: 0.204213
0.2342 --- loss: 1.063799, loss_ss: 0.964269, loss_d: 0.099529
0.3123 --- loss: 1.246930, loss_ss: 0.934150, loss_d: 0.312780
0.3903 --- loss: 1.596991, loss_ss: 1.318937, loss_d: 0.278054
0.4684 --- loss: 1.291561, loss_ss: 1.140982, loss_d: 0.150579
0.5464 --- loss: 1.130819, loss_ss: 0.969443, loss_d: 0.161376
0.6245 --- loss: 1.292832, loss_ss: 1.047615, loss_d: 0.245217
0.7026 --- loss: 1.309835, loss_ss: 1.002758, loss_d: 0.307077
0.7806 --- loss: 1.115860, loss_ss: 1.047674, loss_d: 0.068186
0.8587 --- loss: 1.557334, loss_ss: 1.221211, loss_d: 0.336123
0.9368 --- loss: 0.912857, loss_ss: 0.805386, loss_d: 0.107471
Epoch finished! Loss: 1.3312772614881396
Starting epoch 5/10.
0.0000 --- loss: 1.219303, loss_ss: 0.974371, loss_d: 0.244932
0.0781 --- loss: 1.204707, loss_ss: 1.043903, loss_d: 0.160804
0.1561 --- loss: 1.347663, loss_ss: 1.064791, loss_d: 0.282872
0.2342 --- loss: 1.135332, loss_ss: 1.019860, loss_d: 0.115472
0.3123 --- loss: 1.215478, loss_ss: 1.092207, loss_d: 0.123271
0.3903 --- loss: 1.377583, loss_ss: 0.987777, loss_d: 0.389805
0.4684 --- loss: 1.312756, loss_ss: 0.976722, loss_d: 0.336034
0.5464 --- loss: 1.331826, loss_ss: 1.152677, loss_d: 0.179149
0.6245 --- loss: 1.340955, loss_ss: 1.053942, loss_d: 0.287013
0.7026 --- loss: 1.143248, loss_ss: 0.948336, loss_d: 0.194911
0.7806 --- loss: 1.161397, loss_ss: 1.120785, loss_d: 0.040612
0.8587 --- loss: 0.999108, loss_ss: 0.953539, loss_d: 0.045569
0.9368 --- loss: 1.086839, loss_ss: 1.033640, loss_d: 0.053198
Epoch finished! Loss: 1.2506072977557778
Starting epoch 6/10.
0.0000 --- loss: 1.104059, loss_ss: 0.900085, loss_d: 0.203974
0.0781 --- loss: 1.328432, loss_ss: 0.959381, loss_d: 0.369051
0.1561 --- loss: 1.311280, loss_ss: 1.076299, loss_d: 0.234981
0.2342 --- loss: 1.979663, loss_ss: 0.940676, loss_d: 1.038986
0.3123 --- loss: 1.437279, loss_ss: 1.041021, loss_d: 0.396258
0.3903 --- loss: 1.376037, loss_ss: 0.978429, loss_d: 0.397608
0.4684 --- loss: 1.317935, loss_ss: 0.999362, loss_d: 0.318573
0.5464 --- loss: 0.925488, loss_ss: 0.833165, loss_d: 0.092324
0.6245 --- loss: 1.043131, loss_ss: 0.835721, loss_d: 0.207409
0.7026 --- loss: 1.221924, loss_ss: 1.091729, loss_d: 0.130195
0.7806 --- loss: 1.073460, loss_ss: 0.959906, loss_d: 0.113553
0.8587 --- loss: 1.016131, loss_ss: 0.880308, loss_d: 0.135822
0.9368 --- loss: 0.939177, loss_ss: 0.866106, loss_d: 0.073071
Epoch finished! Loss: 1.2286067167297006
Starting epoch 7/10.
0.0000 --- loss: 0.991644, loss_ss: 0.917929, loss_d: 0.073715
0.0781 --- loss: 1.061726, loss_ss: 1.002317, loss_d: 0.059409
0.1561 --- loss: 1.183987, loss_ss: 1.015779, loss_d: 0.168208
0.2342 --- loss: 0.955729, loss_ss: 0.933376, loss_d: 0.022353
0.3123 --- loss: 1.140517, loss_ss: 0.958732, loss_d: 0.181785
0.3903 --- loss: 0.995392, loss_ss: 0.878071, loss_d: 0.117322
0.4684 --- loss: 0.945085, loss_ss: 0.794342, loss_d: 0.150743
0.5464 --- loss: 0.676094, loss_ss: 0.609504, loss_d: 0.066590
0.6245 --- loss: 1.280970, loss_ss: 1.103595, loss_d: 0.177376
0.7026 --- loss: 0.971047, loss_ss: 0.846221, loss_d: 0.124826
0.7806 --- loss: 1.038525, loss_ss: 1.000004, loss_d: 0.038521
0.8587 --- loss: 0.935487, loss_ss: 0.906669, loss_d: 0.028818
0.9368 --- loss: 1.083079, loss_ss: 0.983997, loss_d: 0.099083
Epoch finished! Loss: 1.1123554757796228
Starting epoch 8/10.
0.0000 --- loss: 0.998685, loss_ss: 0.965149, loss_d: 0.033536
0.0781 --- loss: 0.917503, loss_ss: 0.864498, loss_d: 0.053005
0.1561 --- loss: 0.961788, loss_ss: 0.943344, loss_d: 0.018444
0.2342 --- loss: 1.118340, loss_ss: 0.804490, loss_d: 0.313850
0.3123 --- loss: 0.962282, loss_ss: 0.902116, loss_d: 0.060165
0.3903 --- loss: 0.997318, loss_ss: 0.949939, loss_d: 0.047380
0.4684 --- loss: 0.734916, loss_ss: 0.708781, loss_d: 0.026135
0.5464 --- loss: 0.848916, loss_ss: 0.804076, loss_d: 0.044839
0.6245 --- loss: 1.354900, loss_ss: 0.891397, loss_d: 0.463504
0.7026 --- loss: 0.915211, loss_ss: 0.719171, loss_d: 0.196040
0.7806 --- loss: 1.103640, loss_ss: 1.001392, loss_d: 0.102248
0.8587 --- loss: 1.490091, loss_ss: 1.383017, loss_d: 0.107074
0.9368 --- loss: 0.849704, loss_ss: 0.831668, loss_d: 0.018036
Epoch finished! Loss: 1.0489522875286639
Starting epoch 9/10.
0.0000 --- loss: 1.051134, loss_ss: 0.768659, loss_d: 0.282475
0.0781 --- loss: 1.104411, loss_ss: 0.960649, loss_d: 0.143762
0.1561 --- loss: 1.106642, loss_ss: 0.962954, loss_d: 0.143688
0.2342 --- loss: 0.892103, loss_ss: 0.850367, loss_d: 0.041736
0.3123 --- loss: 0.737244, loss_ss: 0.702388, loss_d: 0.034856
0.3903 --- loss: 0.815644, loss_ss: 0.807239, loss_d: 0.008405
0.4684 --- loss: 0.933168, loss_ss: 0.853345, loss_d: 0.079823
0.5464 --- loss: 0.931389, loss_ss: 0.918252, loss_d: 0.013137
0.6245 --- loss: 0.852573, loss_ss: 0.708625, loss_d: 0.143947
0.7026 --- loss: 0.853215, loss_ss: 0.846660, loss_d: 0.006555
0.7806 --- loss: 0.622686, loss_ss: 0.605888, loss_d: 0.016797
0.8587 --- loss: 1.375229, loss_ss: 0.802561, loss_d: 0.572669
0.9368 --- loss: 1.106803, loss_ss: 1.079746, loss_d: 0.027057
Epoch finished! Loss: 0.9843504740856588
Starting epoch 10/10.
0.0000 --- loss: 0.856055, loss_ss: 0.781722, loss_d: 0.074333
0.0781 --- loss: 1.164597, loss_ss: 1.134024, loss_d: 0.030573
0.1561 --- loss: 0.955407, loss_ss: 0.940737, loss_d: 0.014669
0.2342 --- loss: 0.996945, loss_ss: 0.896276, loss_d: 0.100669
0.3123 --- loss: 1.008657, loss_ss: 0.986962, loss_d: 0.021695
0.3903 --- loss: 0.766684, loss_ss: 0.765092, loss_d: 0.001592
0.4684 --- loss: 0.857778, loss_ss: 0.750179, loss_d: 0.107599
0.5464 --- loss: 0.787940, loss_ss: 0.770849, loss_d: 0.017091
0.6245 --- loss: 0.950061, loss_ss: 0.760214, loss_d: 0.189847
0.7026 --- loss: 1.004044, loss_ss: 0.968541, loss_d: 0.035503
0.7806 --- loss: 0.820758, loss_ss: 0.610460, loss_d: 0.210299
0.8587 --- loss: 1.154705, loss_ss: 0.962770, loss_d: 0.191936
0.9368 --- loss: 1.029014, loss_ss: 1.017575, loss_d: 0.011439
Epoch finished! Loss: 0.9577882285229862
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.706140350877193
             precision    recall  f1-score   support

        0.0       0.63      0.87      0.73       166
        1.0       0.50      0.02      0.03        58
        2.0       0.60      0.92      0.73       397
        3.0       0.97      0.83      0.90       165
        4.0       0.98      0.44      0.61       354

avg / total       0.77      0.71      0.68      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.70  87.35   91.27  63.04     73.23
1  94.91   1.72   99.91  50.00      3.33
2  76.05  92.19   67.43  60.20     72.84
3  97.19  83.03   99.59  97.16     89.54
4  82.37  44.07   99.62  98.11     60.82
Total accuracy: 70.61%
Average sen: 61.67%
Average spec: 91.56%
Macro f1-score: 59.95%
Diagnosis acc on 30mins: 1.0
[0.99991477 0.99966908 0.99991262 0.9954555  0.98952079 0.99999845
 0.99998915 0.99984837 0.99952805 0.99999082 0.99995327 0.99954528
 0.99988711 0.99998844 0.99999881 0.9999119  0.99967742 0.99992692
 0.99981886]
pred: 0.9990808210874859, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp007-nsrr

=== Test on chp008-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.451112, loss_ss: 1.781336, loss_d: 0.669775
0.0778 --- loss: 3.200136, loss_ss: 1.641726, loss_d: 1.558410
0.1556 --- loss: 2.375211, loss_ss: 1.739229, loss_d: 0.635981
0.2335 --- loss: 2.388485, loss_ss: 1.565266, loss_d: 0.823219
0.3113 --- loss: 2.051376, loss_ss: 1.528621, loss_d: 0.522755
0.3891 --- loss: 2.362108, loss_ss: 1.688794, loss_d: 0.673314
0.4669 --- loss: 2.374109, loss_ss: 1.556988, loss_d: 0.817121
0.5447 --- loss: 2.169160, loss_ss: 1.583512, loss_d: 0.585648
0.6226 --- loss: 2.092344, loss_ss: 1.415800, loss_d: 0.676544
0.7004 --- loss: 1.956023, loss_ss: 1.378096, loss_d: 0.577926
0.7782 --- loss: 2.091179, loss_ss: 1.523654, loss_d: 0.567525
0.8560 --- loss: 1.900212, loss_ss: 1.444390, loss_d: 0.455823
0.9339 --- loss: 1.874075, loss_ss: 1.394490, loss_d: 0.479585
Epoch finished! Loss: 2.1683282302692533
Starting epoch 2/10.
0.0000 --- loss: 2.027855, loss_ss: 1.538211, loss_d: 0.489643
0.0778 --- loss: 1.979143, loss_ss: 1.401262, loss_d: 0.577881
0.1556 --- loss: 1.871413, loss_ss: 1.522488, loss_d: 0.348925
0.2335 --- loss: 1.901060, loss_ss: 1.368754, loss_d: 0.532306
0.3113 --- loss: 1.646978, loss_ss: 1.360264, loss_d: 0.286714
0.3891 --- loss: 1.516003, loss_ss: 1.313498, loss_d: 0.202505
0.4669 --- loss: 1.591336, loss_ss: 1.319978, loss_d: 0.271358
0.5447 --- loss: 1.865605, loss_ss: 1.353617, loss_d: 0.511988
0.6226 --- loss: 1.567662, loss_ss: 1.316620, loss_d: 0.251042
0.7004 --- loss: 1.676366, loss_ss: 1.358007, loss_d: 0.318359
0.7782 --- loss: 1.904985, loss_ss: 1.314864, loss_d: 0.590121
0.8560 --- loss: 1.620685, loss_ss: 1.343916, loss_d: 0.276769
0.9339 --- loss: 1.835564, loss_ss: 1.222390, loss_d: 0.613174
Epoch finished! Loss: 1.7777464790269732
Starting epoch 3/10.
0.0000 --- loss: 1.542893, loss_ss: 1.294538, loss_d: 0.248355
0.0778 --- loss: 1.945403, loss_ss: 1.282787, loss_d: 0.662616
0.1556 --- loss: 1.650174, loss_ss: 1.412599, loss_d: 0.237575
0.2335 --- loss: 1.350627, loss_ss: 1.079104, loss_d: 0.271523
0.3113 --- loss: 1.374554, loss_ss: 1.094948, loss_d: 0.279605
0.3891 --- loss: 1.619007, loss_ss: 1.284939, loss_d: 0.334068
0.4669 --- loss: 1.310519, loss_ss: 1.107829, loss_d: 0.202690
0.5447 --- loss: 1.378405, loss_ss: 1.163858, loss_d: 0.214548
0.6226 --- loss: 1.808759, loss_ss: 1.021204, loss_d: 0.787555
0.7004 --- loss: 1.502171, loss_ss: 1.162822, loss_d: 0.339349
0.7782 --- loss: 1.106157, loss_ss: 0.986123, loss_d: 0.120035
0.8560 --- loss: 1.697134, loss_ss: 1.083678, loss_d: 0.613457
0.9339 --- loss: 1.699180, loss_ss: 1.153982, loss_d: 0.545198
Epoch finished! Loss: 1.493137733079493
Starting epoch 4/10.
0.0000 --- loss: 1.350601, loss_ss: 1.173347, loss_d: 0.177254
0.0778 --- loss: 1.564542, loss_ss: 1.150816, loss_d: 0.413727
0.1556 --- loss: 1.395497, loss_ss: 1.238847, loss_d: 0.156650
0.2335 --- loss: 1.302239, loss_ss: 1.129364, loss_d: 0.172876
0.3113 --- loss: 1.384533, loss_ss: 1.320895, loss_d: 0.063638
0.3891 --- loss: 1.290074, loss_ss: 1.157744, loss_d: 0.132330
0.4669 --- loss: 1.279072, loss_ss: 1.174530, loss_d: 0.104542
0.5447 --- loss: 1.573544, loss_ss: 1.118496, loss_d: 0.455048
0.6226 --- loss: 1.318959, loss_ss: 0.940593, loss_d: 0.378366
0.7004 --- loss: 1.085627, loss_ss: 0.908976, loss_d: 0.176652
0.7782 --- loss: 1.198753, loss_ss: 1.128948, loss_d: 0.069805
0.8560 --- loss: 1.147766, loss_ss: 1.077339, loss_d: 0.070426
0.9339 --- loss: 1.287655, loss_ss: 1.038170, loss_d: 0.249485
Epoch finished! Loss: 1.3126181038096547
Starting epoch 5/10.
0.0000 --- loss: 1.560163, loss_ss: 1.279725, loss_d: 0.280437
0.0778 --- loss: 0.965180, loss_ss: 0.869773, loss_d: 0.095406
0.1556 --- loss: 1.081335, loss_ss: 0.953570, loss_d: 0.127765
0.2335 --- loss: 1.077590, loss_ss: 0.960546, loss_d: 0.117044
0.3113 --- loss: 1.794906, loss_ss: 1.014050, loss_d: 0.780857
0.3891 --- loss: 1.073444, loss_ss: 0.924045, loss_d: 0.149399
0.4669 --- loss: 1.162723, loss_ss: 0.965231, loss_d: 0.197492
0.5447 --- loss: 1.352970, loss_ss: 1.128584, loss_d: 0.224386
0.6226 --- loss: 1.132731, loss_ss: 1.008581, loss_d: 0.124150
0.7004 --- loss: 1.380341, loss_ss: 1.051185, loss_d: 0.329157
0.7782 --- loss: 1.099551, loss_ss: 1.015707, loss_d: 0.083844
0.8560 --- loss: 1.168365, loss_ss: 1.152169, loss_d: 0.016196
0.9339 --- loss: 1.573809, loss_ss: 1.279262, loss_d: 0.294547
Epoch finished! Loss: 1.205363486893475
Starting epoch 6/10.
0.0000 --- loss: 1.511427, loss_ss: 0.933868, loss_d: 0.577559
0.0778 --- loss: 1.330193, loss_ss: 1.020893, loss_d: 0.309300
0.1556 --- loss: 1.000447, loss_ss: 0.971947, loss_d: 0.028500
0.2335 --- loss: 1.171900, loss_ss: 1.062624, loss_d: 0.109276
0.3113 --- loss: 0.957524, loss_ss: 0.926584, loss_d: 0.030940
0.3891 --- loss: 0.918667, loss_ss: 0.845293, loss_d: 0.073374
0.4669 --- loss: 0.886062, loss_ss: 0.876072, loss_d: 0.009990
0.5447 --- loss: 0.925328, loss_ss: 0.846242, loss_d: 0.079086
0.6226 --- loss: 1.211322, loss_ss: 1.170292, loss_d: 0.041030
0.7004 --- loss: 0.957484, loss_ss: 0.898030, loss_d: 0.059455
0.7782 --- loss: 1.004302, loss_ss: 0.984364, loss_d: 0.019938
0.8560 --- loss: 1.064484, loss_ss: 0.910568, loss_d: 0.153917
0.9339 --- loss: 1.541521, loss_ss: 1.054876, loss_d: 0.486645
Epoch finished! Loss: 1.0880469176918268
Starting epoch 7/10.
0.0000 --- loss: 1.269574, loss_ss: 0.787636, loss_d: 0.481938
0.0778 --- loss: 0.817104, loss_ss: 0.784413, loss_d: 0.032691
0.1556 --- loss: 0.883979, loss_ss: 0.813803, loss_d: 0.070175
0.2335 --- loss: 1.302370, loss_ss: 1.147348, loss_d: 0.155022
0.3113 --- loss: 1.078237, loss_ss: 0.875106, loss_d: 0.203131
0.3891 --- loss: 0.820116, loss_ss: 0.791880, loss_d: 0.028236
0.4669 --- loss: 1.007940, loss_ss: 0.992928, loss_d: 0.015012
0.5447 --- loss: 0.863633, loss_ss: 0.777126, loss_d: 0.086507
0.6226 --- loss: 0.995122, loss_ss: 0.973577, loss_d: 0.021545
0.7004 --- loss: 0.859886, loss_ss: 0.839108, loss_d: 0.020778
0.7782 --- loss: 0.724798, loss_ss: 0.711792, loss_d: 0.013006
0.8560 --- loss: 0.778986, loss_ss: 0.717921, loss_d: 0.061064
0.9339 --- loss: 0.795594, loss_ss: 0.776554, loss_d: 0.019040
Epoch finished! Loss: 1.0414238153025508
Starting epoch 8/10.
0.0000 --- loss: 1.048739, loss_ss: 1.019397, loss_d: 0.029342
0.0778 --- loss: 0.854031, loss_ss: 0.837263, loss_d: 0.016768
0.1556 --- loss: 1.032940, loss_ss: 1.010864, loss_d: 0.022076
0.2335 --- loss: 0.836486, loss_ss: 0.831465, loss_d: 0.005021
0.3113 --- loss: 1.045934, loss_ss: 1.034019, loss_d: 0.011915
0.3891 --- loss: 1.110034, loss_ss: 1.071950, loss_d: 0.038084
0.4669 --- loss: 0.913332, loss_ss: 0.902569, loss_d: 0.010763
0.5447 --- loss: 0.987470, loss_ss: 0.894989, loss_d: 0.092481
0.6226 --- loss: 0.833738, loss_ss: 0.827823, loss_d: 0.005915
0.7004 --- loss: 0.835622, loss_ss: 0.786774, loss_d: 0.048848
0.7782 --- loss: 1.043542, loss_ss: 0.903998, loss_d: 0.139544
0.8560 --- loss: 0.922569, loss_ss: 0.837831, loss_d: 0.084739
0.9339 --- loss: 1.970271, loss_ss: 0.892106, loss_d: 1.078165
Epoch finished! Loss: 0.9960167836397886
Starting epoch 9/10.
0.0000 --- loss: 1.023813, loss_ss: 0.992995, loss_d: 0.030817
0.0778 --- loss: 0.754780, loss_ss: 0.712499, loss_d: 0.042281
0.1556 --- loss: 1.079059, loss_ss: 1.067308, loss_d: 0.011751
0.2335 --- loss: 0.735517, loss_ss: 0.733125, loss_d: 0.002392
0.3113 --- loss: 0.893330, loss_ss: 0.860941, loss_d: 0.032389
0.3891 --- loss: 0.994838, loss_ss: 0.992589, loss_d: 0.002250
0.4669 --- loss: 1.022204, loss_ss: 0.777093, loss_d: 0.245111
0.5447 --- loss: 0.921462, loss_ss: 0.700493, loss_d: 0.220969
0.6226 --- loss: 1.141111, loss_ss: 1.139862, loss_d: 0.001250
0.7004 --- loss: 0.738917, loss_ss: 0.725659, loss_d: 0.013258
0.7782 --- loss: 0.683468, loss_ss: 0.667613, loss_d: 0.015856
0.8560 --- loss: 0.938955, loss_ss: 0.868022, loss_d: 0.070933
0.9339 --- loss: 1.618106, loss_ss: 0.832623, loss_d: 0.785484
Epoch finished! Loss: 0.9579598284326494
Starting epoch 10/10.
0.0000 --- loss: 1.223684, loss_ss: 0.871925, loss_d: 0.351759
0.0778 --- loss: 0.989931, loss_ss: 0.972226, loss_d: 0.017705
0.1556 --- loss: 1.094483, loss_ss: 0.909294, loss_d: 0.185189
0.2335 --- loss: 1.303364, loss_ss: 0.996385, loss_d: 0.306979
0.3113 --- loss: 1.358944, loss_ss: 1.319811, loss_d: 0.039133
0.3891 --- loss: 0.833465, loss_ss: 0.821530, loss_d: 0.011935
0.4669 --- loss: 1.067537, loss_ss: 0.675310, loss_d: 0.392227
0.5447 --- loss: 1.189558, loss_ss: 0.833988, loss_d: 0.355570
0.6226 --- loss: 0.922264, loss_ss: 0.895433, loss_d: 0.026831
0.7004 --- loss: 1.021488, loss_ss: 0.976541, loss_d: 0.044947
0.7782 --- loss: 0.871666, loss_ss: 0.820277, loss_d: 0.051389
0.8560 --- loss: 0.899502, loss_ss: 0.850332, loss_d: 0.049170
0.9339 --- loss: 1.342395, loss_ss: 1.265488, loss_d: 0.076907
Epoch finished! Loss: 0.9698454327881336
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.63
             precision    recall  f1-score   support

        0.0       0.36      0.94      0.52        89
        1.0       0.13      0.11      0.12        37
        2.0       0.78      0.51      0.62       387
        3.0       0.96      0.73      0.83       263
        4.0       0.49      0.73      0.59       124

avg / total       0.72      0.63      0.64       900
 


====== chp008-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.67  94.38   81.38  35.74     51.85
1  93.44  10.81   96.99  13.33     11.94
2  72.78  51.16   89.08  77.95     61.78
3  91.11  72.62   98.74  95.98     82.68
4  86.00  72.58   88.14  49.45     58.82
Total accuracy: 63.00%
Average sen: 60.31%
Average spec: 90.87%
Macro f1-score: 53.42%
Diagnosis acc on 30mins: 1.0
[0.99976176 0.99992049 0.99802184 0.99999213 0.99999928 0.99999833
 0.99818879 0.9984079  0.99935883 0.99975246 0.9999969  0.99999774
 0.9999994  0.99887162 0.99995911]
pred: 0.9994817733764648, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp008-nsrr

=== Test on chp009-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.404070, loss_ss: 1.686534, loss_d: 0.717535
0.0779 --- loss: 2.183999, loss_ss: 1.611164, loss_d: 0.572835
0.1559 --- loss: 1.921291, loss_ss: 1.487837, loss_d: 0.433454
0.2338 --- loss: 2.308405, loss_ss: 1.497427, loss_d: 0.810978
0.3118 --- loss: 1.930767, loss_ss: 1.448706, loss_d: 0.482061
0.3897 --- loss: 1.933038, loss_ss: 1.419382, loss_d: 0.513656
0.4677 --- loss: 1.876166, loss_ss: 1.513213, loss_d: 0.362953
0.5456 --- loss: 2.139754, loss_ss: 1.313928, loss_d: 0.825826
0.6235 --- loss: 1.785274, loss_ss: 1.211779, loss_d: 0.573494
0.7015 --- loss: 1.744342, loss_ss: 1.377349, loss_d: 0.366993
0.7794 --- loss: 1.850708, loss_ss: 1.264045, loss_d: 0.586663
0.8574 --- loss: 1.989617, loss_ss: 1.496518, loss_d: 0.493100
0.9353 --- loss: 1.705853, loss_ss: 1.263363, loss_d: 0.442490
Epoch finished! Loss: 2.0107700480148196
Starting epoch 2/10.
0.0000 --- loss: 1.856878, loss_ss: 1.267230, loss_d: 0.589648
0.0779 --- loss: 1.659548, loss_ss: 1.347368, loss_d: 0.312180
0.1559 --- loss: 1.559701, loss_ss: 1.232672, loss_d: 0.327028
0.2338 --- loss: 2.215952, loss_ss: 1.242324, loss_d: 0.973628
0.3118 --- loss: 1.737239, loss_ss: 1.103730, loss_d: 0.633509
0.3897 --- loss: 1.278179, loss_ss: 1.158670, loss_d: 0.119509
0.4677 --- loss: 1.412206, loss_ss: 1.099696, loss_d: 0.312509
0.5456 --- loss: 1.626773, loss_ss: 1.291751, loss_d: 0.335022
0.6235 --- loss: 1.556842, loss_ss: 1.223500, loss_d: 0.333343
0.7015 --- loss: 1.753404, loss_ss: 1.379115, loss_d: 0.374290
0.7794 --- loss: 1.449780, loss_ss: 1.208334, loss_d: 0.241446
0.8574 --- loss: 1.720924, loss_ss: 1.242182, loss_d: 0.478742
0.9353 --- loss: 1.600865, loss_ss: 1.089356, loss_d: 0.511509
Epoch finished! Loss: 1.6461744569242
Starting epoch 3/10.
0.0000 --- loss: 1.255362, loss_ss: 1.019262, loss_d: 0.236100
0.0779 --- loss: 1.257402, loss_ss: 1.197479, loss_d: 0.059923
0.1559 --- loss: 1.520687, loss_ss: 0.957577, loss_d: 0.563110
0.2338 --- loss: 1.550931, loss_ss: 1.179979, loss_d: 0.370952
0.3118 --- loss: 1.599424, loss_ss: 1.202759, loss_d: 0.396665
0.3897 --- loss: 1.588988, loss_ss: 1.039494, loss_d: 0.549493
0.4677 --- loss: 1.346990, loss_ss: 1.194138, loss_d: 0.152852
0.5456 --- loss: 1.214786, loss_ss: 0.982641, loss_d: 0.232146
0.6235 --- loss: 1.515800, loss_ss: 1.254259, loss_d: 0.261540
0.7015 --- loss: 1.387666, loss_ss: 1.056784, loss_d: 0.330882
0.7794 --- loss: 1.448543, loss_ss: 1.053042, loss_d: 0.395501
0.8574 --- loss: 1.794800, loss_ss: 1.159103, loss_d: 0.635697
0.9353 --- loss: 1.255609, loss_ss: 1.047455, loss_d: 0.208154
Epoch finished! Loss: 1.4399154875427485
Starting epoch 4/10.
0.0000 --- loss: 1.042220, loss_ss: 0.933037, loss_d: 0.109182
0.0779 --- loss: 1.787844, loss_ss: 1.154738, loss_d: 0.633106
0.1559 --- loss: 1.462785, loss_ss: 1.351256, loss_d: 0.111529
0.2338 --- loss: 1.208712, loss_ss: 1.077256, loss_d: 0.131456
0.3118 --- loss: 1.461361, loss_ss: 1.210331, loss_d: 0.251030
0.3897 --- loss: 1.184793, loss_ss: 0.963819, loss_d: 0.220974
0.4677 --- loss: 1.218158, loss_ss: 1.157892, loss_d: 0.060265
0.5456 --- loss: 1.789168, loss_ss: 1.202921, loss_d: 0.586246
0.6235 --- loss: 1.630277, loss_ss: 1.064378, loss_d: 0.565899
0.7015 --- loss: 1.389392, loss_ss: 1.073225, loss_d: 0.316167
0.7794 --- loss: 1.539561, loss_ss: 1.165925, loss_d: 0.373637
0.8574 --- loss: 1.201918, loss_ss: 0.907563, loss_d: 0.294356
0.9353 --- loss: 1.196364, loss_ss: 1.020734, loss_d: 0.175630
Epoch finished! Loss: 1.3167828186415136
Starting epoch 5/10.
0.0000 --- loss: 1.378880, loss_ss: 1.198380, loss_d: 0.180500
0.0779 --- loss: 1.060597, loss_ss: 0.903799, loss_d: 0.156799
0.1559 --- loss: 1.310305, loss_ss: 1.245247, loss_d: 0.065059
0.2338 --- loss: 1.328260, loss_ss: 0.969302, loss_d: 0.358958
0.3118 --- loss: 1.231231, loss_ss: 1.121893, loss_d: 0.109339
0.3897 --- loss: 1.129796, loss_ss: 0.999608, loss_d: 0.130188
0.4677 --- loss: 0.880806, loss_ss: 0.739348, loss_d: 0.141458
0.5456 --- loss: 1.261940, loss_ss: 1.040299, loss_d: 0.221642
0.6235 --- loss: 1.027797, loss_ss: 0.956361, loss_d: 0.071436
0.7015 --- loss: 1.211073, loss_ss: 0.967871, loss_d: 0.243201
0.7794 --- loss: 1.241377, loss_ss: 0.910365, loss_d: 0.331013
0.8574 --- loss: 0.973983, loss_ss: 0.872456, loss_d: 0.101527
0.9353 --- loss: 1.501795, loss_ss: 1.333511, loss_d: 0.168284
Epoch finished! Loss: 1.2320657256059349
Starting epoch 6/10.
0.0000 --- loss: 1.228465, loss_ss: 1.088222, loss_d: 0.140243
0.0779 --- loss: 1.221511, loss_ss: 0.933014, loss_d: 0.288497
0.1559 --- loss: 1.201825, loss_ss: 1.008049, loss_d: 0.193776
0.2338 --- loss: 0.967119, loss_ss: 0.766485, loss_d: 0.200634
0.3118 --- loss: 1.913738, loss_ss: 1.105518, loss_d: 0.808220
0.3897 --- loss: 0.915018, loss_ss: 0.837701, loss_d: 0.077317
0.4677 --- loss: 0.938001, loss_ss: 0.875684, loss_d: 0.062317
0.5456 --- loss: 1.002202, loss_ss: 0.634774, loss_d: 0.367427
0.6235 --- loss: 0.993463, loss_ss: 0.766656, loss_d: 0.226807
0.7015 --- loss: 1.312481, loss_ss: 0.952364, loss_d: 0.360117
0.7794 --- loss: 1.058674, loss_ss: 0.968585, loss_d: 0.090088
0.8574 --- loss: 1.194164, loss_ss: 1.063867, loss_d: 0.130296
0.9353 --- loss: 1.390774, loss_ss: 1.283463, loss_d: 0.107311
Epoch finished! Loss: 1.1350420853123069
Starting epoch 7/10.
0.0000 --- loss: 1.070889, loss_ss: 0.846690, loss_d: 0.224199
0.0779 --- loss: 0.820938, loss_ss: 0.762513, loss_d: 0.058424
0.1559 --- loss: 1.374973, loss_ss: 0.980932, loss_d: 0.394042
0.2338 --- loss: 0.915558, loss_ss: 0.906676, loss_d: 0.008882
0.3118 --- loss: 0.945346, loss_ss: 0.917370, loss_d: 0.027976
0.3897 --- loss: 1.230644, loss_ss: 1.164733, loss_d: 0.065911
0.4677 --- loss: 1.262722, loss_ss: 0.845078, loss_d: 0.417643
0.5456 --- loss: 1.072182, loss_ss: 0.852620, loss_d: 0.219562
0.6235 --- loss: 0.947219, loss_ss: 0.914455, loss_d: 0.032764
0.7015 --- loss: 1.058855, loss_ss: 0.895326, loss_d: 0.163529
0.7794 --- loss: 1.083287, loss_ss: 0.984414, loss_d: 0.098873
0.8574 --- loss: 1.104741, loss_ss: 1.050428, loss_d: 0.054312
0.9353 --- loss: 0.841950, loss_ss: 0.798535, loss_d: 0.043415
Epoch finished! Loss: 1.0488703823648393
Starting epoch 8/10.
0.0000 --- loss: 1.257621, loss_ss: 1.238963, loss_d: 0.018658
0.0779 --- loss: 0.997137, loss_ss: 0.990704, loss_d: 0.006433
0.1559 --- loss: 0.918829, loss_ss: 0.912321, loss_d: 0.006507
0.2338 --- loss: 1.070694, loss_ss: 0.986426, loss_d: 0.084268
0.3118 --- loss: 0.807759, loss_ss: 0.734502, loss_d: 0.073256
0.3897 --- loss: 0.942174, loss_ss: 0.933845, loss_d: 0.008329
0.4677 --- loss: 1.163493, loss_ss: 1.069667, loss_d: 0.093825
0.5456 --- loss: 0.925954, loss_ss: 0.898546, loss_d: 0.027408
0.6235 --- loss: 0.963176, loss_ss: 0.875973, loss_d: 0.087203
0.7015 --- loss: 0.815261, loss_ss: 0.791683, loss_d: 0.023578
0.7794 --- loss: 0.740123, loss_ss: 0.721722, loss_d: 0.018401
0.8574 --- loss: 1.599275, loss_ss: 1.061529, loss_d: 0.537746
0.9353 --- loss: 0.925523, loss_ss: 0.907436, loss_d: 0.018087
Epoch finished! Loss: 0.9996876353397965
Starting epoch 9/10.
0.0000 --- loss: 1.172349, loss_ss: 1.163770, loss_d: 0.008579
0.0779 --- loss: 0.769643, loss_ss: 0.755109, loss_d: 0.014534
0.1559 --- loss: 0.935347, loss_ss: 0.903198, loss_d: 0.032148
0.2338 --- loss: 0.729809, loss_ss: 0.721573, loss_d: 0.008236
0.3118 --- loss: 0.908542, loss_ss: 0.898718, loss_d: 0.009824
0.3897 --- loss: 0.835876, loss_ss: 0.759158, loss_d: 0.076718
0.4677 --- loss: 0.893857, loss_ss: 0.868382, loss_d: 0.025475
0.5456 --- loss: 0.868883, loss_ss: 0.854751, loss_d: 0.014133
0.6235 --- loss: 1.005049, loss_ss: 0.992190, loss_d: 0.012860
0.7015 --- loss: 0.817144, loss_ss: 0.800879, loss_d: 0.016265
0.7794 --- loss: 0.817717, loss_ss: 0.810910, loss_d: 0.006806
0.8574 --- loss: 0.692955, loss_ss: 0.644015, loss_d: 0.048940
0.9353 --- loss: 0.919057, loss_ss: 0.917041, loss_d: 0.002016
Epoch finished! Loss: 0.9272245881147683
Starting epoch 10/10.
0.0000 --- loss: 0.793223, loss_ss: 0.761582, loss_d: 0.031641
0.0779 --- loss: 0.760767, loss_ss: 0.752278, loss_d: 0.008490
0.1559 --- loss: 0.889416, loss_ss: 0.881290, loss_d: 0.008126
0.2338 --- loss: 0.915515, loss_ss: 0.914558, loss_d: 0.000957
0.3118 --- loss: 1.046693, loss_ss: 1.044604, loss_d: 0.002089
0.3897 --- loss: 1.171856, loss_ss: 0.945194, loss_d: 0.226662
0.4677 --- loss: 0.739399, loss_ss: 0.734788, loss_d: 0.004610
0.5456 --- loss: 1.096149, loss_ss: 0.805351, loss_d: 0.290799
0.6235 --- loss: 0.822508, loss_ss: 0.797169, loss_d: 0.025339
0.7015 --- loss: 0.908107, loss_ss: 0.822643, loss_d: 0.085463
0.7794 --- loss: 0.780562, loss_ss: 0.770888, loss_d: 0.009674
0.8574 --- loss: 0.888240, loss_ss: 0.809456, loss_d: 0.078784
0.9353 --- loss: 0.996856, loss_ss: 0.990668, loss_d: 0.006188
Epoch finished! Loss: 0.9289850788190961
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7333333333333333
             precision    recall  f1-score   support

        0.0       0.74      0.73      0.74        96
        1.0       0.29      0.12      0.17       123
        2.0       0.74      0.78      0.76       355
        3.0       1.00      0.77      0.87       209
        4.0       0.67      0.95      0.79       237

avg / total       0.72      0.73      0.71      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.10  72.92   97.40   74.47     73.68
1  85.78  12.20   95.88   28.85     17.14
2  82.65  78.31   84.96   73.54     75.85
3  95.20  76.56  100.00  100.00     86.72
4  87.94  94.94   85.82   66.96     78.53
Total accuracy: 73.33%
Average sen: 66.98%
Average spec: 92.81%
Macro f1-score: 66.39%
Diagnosis acc on 30mins: 1.0
[1.         0.99999833 0.99904329 1.         1.         1.
 1.         1.         1.         1.         0.9948597  0.99998307
 1.         1.         0.99999988 0.99999988 1.        ]
pred: 0.9996402438949136, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp009-nsrr

=== Test on chp010-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.437793, loss_ss: 1.772932, loss_d: 0.664861
0.0779 --- loss: 1.986811, loss_ss: 1.530494, loss_d: 0.456316
0.1558 --- loss: 2.086061, loss_ss: 1.553029, loss_d: 0.533032
0.2336 --- loss: 2.127195, loss_ss: 1.651356, loss_d: 0.475839
0.3115 --- loss: 1.871635, loss_ss: 1.517253, loss_d: 0.354382
0.3894 --- loss: 1.690346, loss_ss: 1.356973, loss_d: 0.333373
0.4673 --- loss: 1.868089, loss_ss: 1.529017, loss_d: 0.339072
0.5452 --- loss: 2.162827, loss_ss: 1.268556, loss_d: 0.894271
0.6231 --- loss: 1.971258, loss_ss: 1.391521, loss_d: 0.579737
0.7009 --- loss: 1.788858, loss_ss: 1.418168, loss_d: 0.370690
0.7788 --- loss: 1.974021, loss_ss: 1.403969, loss_d: 0.570053
0.8567 --- loss: 1.981267, loss_ss: 1.373210, loss_d: 0.608057
0.9346 --- loss: 2.147962, loss_ss: 1.318145, loss_d: 0.829817
Epoch finished! Loss: 2.0399218033999205
Starting epoch 2/10.
0.0000 --- loss: 1.690724, loss_ss: 1.251777, loss_d: 0.438947
0.0779 --- loss: 1.947966, loss_ss: 1.399014, loss_d: 0.548952
0.1558 --- loss: 2.034971, loss_ss: 1.449776, loss_d: 0.585195
0.2336 --- loss: 1.939740, loss_ss: 1.318021, loss_d: 0.621719
0.3115 --- loss: 1.672569, loss_ss: 1.380790, loss_d: 0.291779
0.3894 --- loss: 1.900981, loss_ss: 1.231503, loss_d: 0.669479
0.4673 --- loss: 1.744094, loss_ss: 1.241857, loss_d: 0.502236
0.5452 --- loss: 1.720590, loss_ss: 1.333426, loss_d: 0.387164
0.6231 --- loss: 1.932749, loss_ss: 1.250721, loss_d: 0.682028
0.7009 --- loss: 1.329669, loss_ss: 1.151073, loss_d: 0.178596
0.7788 --- loss: 1.673976, loss_ss: 1.267732, loss_d: 0.406244
0.8567 --- loss: 1.477266, loss_ss: 1.246450, loss_d: 0.230816
0.9346 --- loss: 1.502415, loss_ss: 1.160902, loss_d: 0.341513
Epoch finished! Loss: 1.6641823537647724
Starting epoch 3/10.
0.0000 --- loss: 1.260358, loss_ss: 1.035335, loss_d: 0.225023
0.0779 --- loss: 1.517385, loss_ss: 1.207644, loss_d: 0.309741
0.1558 --- loss: 1.461427, loss_ss: 1.093249, loss_d: 0.368178
0.2336 --- loss: 1.317905, loss_ss: 1.112637, loss_d: 0.205268
0.3115 --- loss: 1.579434, loss_ss: 1.221647, loss_d: 0.357787
0.3894 --- loss: 1.351986, loss_ss: 1.131209, loss_d: 0.220777
0.4673 --- loss: 1.438812, loss_ss: 1.109463, loss_d: 0.329348
0.5452 --- loss: 1.307104, loss_ss: 1.041159, loss_d: 0.265945
0.6231 --- loss: 1.388061, loss_ss: 1.195040, loss_d: 0.193020
0.7009 --- loss: 1.178339, loss_ss: 0.990546, loss_d: 0.187794
0.7788 --- loss: 1.209572, loss_ss: 1.019300, loss_d: 0.190272
0.8567 --- loss: 1.663899, loss_ss: 1.101636, loss_d: 0.562262
0.9346 --- loss: 1.347755, loss_ss: 1.082833, loss_d: 0.264921
Epoch finished! Loss: 1.4040038483217359
Starting epoch 4/10.
0.0000 --- loss: 1.178544, loss_ss: 1.017423, loss_d: 0.161120
0.0779 --- loss: 1.417221, loss_ss: 1.089815, loss_d: 0.327406
0.1558 --- loss: 1.133120, loss_ss: 1.015738, loss_d: 0.117382
0.2336 --- loss: 1.097491, loss_ss: 1.040803, loss_d: 0.056688
0.3115 --- loss: 1.133400, loss_ss: 0.954509, loss_d: 0.178891
0.3894 --- loss: 1.214144, loss_ss: 0.887921, loss_d: 0.326223
0.4673 --- loss: 1.139043, loss_ss: 1.037926, loss_d: 0.101117
0.5452 --- loss: 1.632473, loss_ss: 0.860018, loss_d: 0.772456
0.6231 --- loss: 1.043155, loss_ss: 0.947870, loss_d: 0.095285
0.7009 --- loss: 1.369607, loss_ss: 1.134857, loss_d: 0.234750
0.7788 --- loss: 1.151448, loss_ss: 1.054813, loss_d: 0.096635
0.8567 --- loss: 1.085017, loss_ss: 0.978421, loss_d: 0.106596
0.9346 --- loss: 0.966883, loss_ss: 0.776136, loss_d: 0.190747
Epoch finished! Loss: 1.2408446110785007
Starting epoch 5/10.
0.0000 --- loss: 1.147171, loss_ss: 0.986830, loss_d: 0.160341
0.0779 --- loss: 1.765550, loss_ss: 0.823248, loss_d: 0.942302
0.1558 --- loss: 1.485840, loss_ss: 1.433062, loss_d: 0.052777
0.2336 --- loss: 1.125320, loss_ss: 0.881241, loss_d: 0.244078
0.3115 --- loss: 1.404558, loss_ss: 0.726845, loss_d: 0.677713
0.3894 --- loss: 1.069644, loss_ss: 0.938747, loss_d: 0.130897
0.4673 --- loss: 1.429196, loss_ss: 0.944006, loss_d: 0.485189
0.5452 --- loss: 0.834115, loss_ss: 0.760814, loss_d: 0.073301
0.6231 --- loss: 1.034403, loss_ss: 0.900467, loss_d: 0.133936
0.7009 --- loss: 1.170678, loss_ss: 0.874999, loss_d: 0.295679
0.7788 --- loss: 1.277622, loss_ss: 1.072521, loss_d: 0.205101
0.8567 --- loss: 1.329398, loss_ss: 1.080393, loss_d: 0.249005
0.9346 --- loss: 0.973221, loss_ss: 0.908996, loss_d: 0.064225
Epoch finished! Loss: 1.1829392816871405
Starting epoch 6/10.
0.0000 --- loss: 1.187176, loss_ss: 1.019915, loss_d: 0.167261
0.0779 --- loss: 1.005620, loss_ss: 0.880035, loss_d: 0.125585
0.1558 --- loss: 0.912194, loss_ss: 0.818833, loss_d: 0.093361
0.2336 --- loss: 0.985245, loss_ss: 0.802935, loss_d: 0.182310
0.3115 --- loss: 0.966026, loss_ss: 0.906270, loss_d: 0.059756
0.3894 --- loss: 0.871607, loss_ss: 0.841055, loss_d: 0.030552
0.4673 --- loss: 0.921797, loss_ss: 0.692140, loss_d: 0.229658
0.5452 --- loss: 1.171198, loss_ss: 1.156076, loss_d: 0.015122
0.6231 --- loss: 0.805156, loss_ss: 0.753843, loss_d: 0.051313
0.7009 --- loss: 0.902011, loss_ss: 0.849227, loss_d: 0.052784
0.7788 --- loss: 0.982475, loss_ss: 0.915846, loss_d: 0.066630
0.8567 --- loss: 0.811571, loss_ss: 0.797826, loss_d: 0.013745
0.9346 --- loss: 0.897845, loss_ss: 0.810876, loss_d: 0.086969
Epoch finished! Loss: 1.0678277309052646
Starting epoch 7/10.
0.0000 --- loss: 1.167391, loss_ss: 0.826151, loss_d: 0.341240
0.0779 --- loss: 1.017426, loss_ss: 0.994506, loss_d: 0.022920
0.1558 --- loss: 1.211516, loss_ss: 1.140796, loss_d: 0.070720
0.2336 --- loss: 0.845285, loss_ss: 0.661534, loss_d: 0.183750
0.3115 --- loss: 0.913508, loss_ss: 0.874877, loss_d: 0.038632
0.3894 --- loss: 1.078394, loss_ss: 0.861684, loss_d: 0.216710
0.4673 --- loss: 1.045881, loss_ss: 0.995616, loss_d: 0.050265
0.5452 --- loss: 0.986669, loss_ss: 0.868008, loss_d: 0.118661
0.6231 --- loss: 1.502892, loss_ss: 0.951173, loss_d: 0.551718
0.7009 --- loss: 0.927598, loss_ss: 0.811743, loss_d: 0.115854
0.7788 --- loss: 0.984088, loss_ss: 0.896218, loss_d: 0.087870
0.8567 --- loss: 0.839041, loss_ss: 0.782749, loss_d: 0.056292
0.9346 --- loss: 1.026860, loss_ss: 1.003035, loss_d: 0.023825
Epoch finished! Loss: 1.0390334585681558
Starting epoch 8/10.
0.0000 --- loss: 0.981683, loss_ss: 0.937846, loss_d: 0.043836
0.0779 --- loss: 0.849487, loss_ss: 0.828172, loss_d: 0.021315
0.1558 --- loss: 0.998751, loss_ss: 0.976021, loss_d: 0.022731
0.2336 --- loss: 0.899711, loss_ss: 0.866211, loss_d: 0.033500
0.3115 --- loss: 0.719966, loss_ss: 0.686500, loss_d: 0.033466
0.3894 --- loss: 1.110987, loss_ss: 1.072335, loss_d: 0.038651
0.4673 --- loss: 0.774900, loss_ss: 0.735239, loss_d: 0.039661
0.5452 --- loss: 0.958606, loss_ss: 0.936507, loss_d: 0.022100
0.6231 --- loss: 0.723622, loss_ss: 0.703771, loss_d: 0.019851
0.7009 --- loss: 0.982461, loss_ss: 0.944968, loss_d: 0.037492
0.7788 --- loss: 1.157426, loss_ss: 1.112028, loss_d: 0.045398
0.8567 --- loss: 0.827624, loss_ss: 0.785593, loss_d: 0.042031
0.9346 --- loss: 1.102667, loss_ss: 0.785178, loss_d: 0.317489
Epoch finished! Loss: 0.9819762599654496
Starting epoch 9/10.
0.0000 --- loss: 0.916273, loss_ss: 0.726439, loss_d: 0.189834
0.0779 --- loss: 0.901728, loss_ss: 0.824033, loss_d: 0.077695
0.1558 --- loss: 0.893615, loss_ss: 0.573636, loss_d: 0.319979
0.2336 --- loss: 0.748516, loss_ss: 0.654715, loss_d: 0.093801
0.3115 --- loss: 1.215598, loss_ss: 1.117716, loss_d: 0.097882
0.3894 --- loss: 0.769879, loss_ss: 0.742587, loss_d: 0.027292
0.4673 --- loss: 0.886224, loss_ss: 0.862199, loss_d: 0.024025
0.5452 --- loss: 1.136048, loss_ss: 1.042237, loss_d: 0.093811
0.6231 --- loss: 0.836439, loss_ss: 0.796332, loss_d: 0.040107
0.7009 --- loss: 0.826499, loss_ss: 0.806016, loss_d: 0.020484
0.7788 --- loss: 0.934472, loss_ss: 0.932391, loss_d: 0.002082
0.8567 --- loss: 0.782018, loss_ss: 0.696269, loss_d: 0.085749
0.9346 --- loss: 0.801218, loss_ss: 0.639966, loss_d: 0.161252
Epoch finished! Loss: 0.9556863349862397
Starting epoch 10/10.
0.0000 --- loss: 0.803292, loss_ss: 0.750339, loss_d: 0.052954
0.0779 --- loss: 0.816661, loss_ss: 0.775788, loss_d: 0.040873
0.1558 --- loss: 0.933328, loss_ss: 0.872529, loss_d: 0.060799
0.2336 --- loss: 1.018262, loss_ss: 1.011659, loss_d: 0.006603
0.3115 --- loss: 0.808167, loss_ss: 0.797523, loss_d: 0.010644
0.3894 --- loss: 0.664113, loss_ss: 0.636809, loss_d: 0.027304
0.4673 --- loss: 0.951713, loss_ss: 0.932473, loss_d: 0.019241
0.5452 --- loss: 0.703444, loss_ss: 0.642096, loss_d: 0.061348
0.6231 --- loss: 0.913352, loss_ss: 0.885473, loss_d: 0.027879
0.7009 --- loss: 0.828292, loss_ss: 0.824844, loss_d: 0.003448
0.7788 --- loss: 0.876769, loss_ss: 0.851343, loss_d: 0.025426
0.8567 --- loss: 1.295387, loss_ss: 0.716798, loss_d: 0.578589
0.9346 --- loss: 0.790859, loss_ss: 0.756260, loss_d: 0.034599
Epoch finished! Loss: 0.8918167911469936
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5916666666666667
             precision    recall  f1-score   support

        0.0       0.30      0.88      0.45        57
        1.0       0.14      0.70      0.24        60
        2.0       0.94      0.74      0.83       496
        3.0       0.95      0.77      0.85        90
        4.0       1.00      0.16      0.27       257

avg / total       0.87      0.59      0.62       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.29  87.72   87.26   30.30     45.05
1  72.29  70.00   72.44   14.48     24.00
2  83.96  73.99   94.61   93.62     82.66
3  97.40  76.67   99.54   94.52     84.66
4  77.40  15.56  100.00  100.00     26.94
Total accuracy: 59.17%
Average sen: 64.79%
Average spec: 90.77%
Macro f1-score: 52.66%
Diagnosis acc on 30mins: 1.0
[0.99999917 0.99259347 0.99999642 1.         1.         0.9999994
 0.99810153 0.99999905 0.99999952 0.99968207 0.99999976 1.
 0.99999976 0.99999988 0.99999976 1.        ]
pred: 0.9993981122970581, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp010-nsrr

=== Test on chp011-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.427087, loss_ss: 1.674481, loss_d: 0.752606
0.0779 --- loss: 1.694322, loss_ss: 1.415870, loss_d: 0.278453
0.1558 --- loss: 2.027703, loss_ss: 1.392072, loss_d: 0.635631
0.2336 --- loss: 2.045810, loss_ss: 1.437098, loss_d: 0.608711
0.3115 --- loss: 1.998824, loss_ss: 1.400552, loss_d: 0.598272
0.3894 --- loss: 1.928905, loss_ss: 1.309210, loss_d: 0.619695
0.4673 --- loss: 1.806514, loss_ss: 1.282680, loss_d: 0.523833
0.5452 --- loss: 1.879643, loss_ss: 1.246021, loss_d: 0.633622
0.6231 --- loss: 1.705968, loss_ss: 1.332873, loss_d: 0.373094
0.7009 --- loss: 1.919156, loss_ss: 1.350744, loss_d: 0.568413
0.7788 --- loss: 1.626812, loss_ss: 1.110877, loss_d: 0.515935
0.8567 --- loss: 2.456329, loss_ss: 1.488894, loss_d: 0.967435
0.9346 --- loss: 1.923167, loss_ss: 1.319839, loss_d: 0.603328
Epoch finished! Loss: 1.9391096448525786
Starting epoch 2/10.
0.0000 --- loss: 1.698719, loss_ss: 1.166352, loss_d: 0.532366
0.0779 --- loss: 1.692144, loss_ss: 1.231087, loss_d: 0.461057
0.1558 --- loss: 1.509400, loss_ss: 1.213279, loss_d: 0.296122
0.2336 --- loss: 1.635257, loss_ss: 1.174191, loss_d: 0.461067
0.3115 --- loss: 1.563469, loss_ss: 1.208258, loss_d: 0.355211
0.3894 --- loss: 1.387018, loss_ss: 1.137540, loss_d: 0.249478
0.4673 --- loss: 1.323665, loss_ss: 1.011634, loss_d: 0.312032
0.5452 --- loss: 1.758858, loss_ss: 1.066022, loss_d: 0.692836
0.6231 --- loss: 1.496932, loss_ss: 1.220980, loss_d: 0.275953
0.7009 --- loss: 1.435699, loss_ss: 1.057968, loss_d: 0.377731
0.7788 --- loss: 1.256023, loss_ss: 1.046117, loss_d: 0.209907
0.8567 --- loss: 1.233830, loss_ss: 1.014015, loss_d: 0.219816
0.9346 --- loss: 2.245254, loss_ss: 1.303670, loss_d: 0.941584
Epoch finished! Loss: 1.590976383537054
Starting epoch 3/10.
0.0000 --- loss: 1.355545, loss_ss: 1.016034, loss_d: 0.339511
0.0779 --- loss: 1.376063, loss_ss: 1.025301, loss_d: 0.350763
0.1558 --- loss: 1.034205, loss_ss: 0.975166, loss_d: 0.059039
0.2336 --- loss: 1.134701, loss_ss: 1.020397, loss_d: 0.114305
0.3115 --- loss: 1.345399, loss_ss: 1.042763, loss_d: 0.302635
0.3894 --- loss: 1.533046, loss_ss: 1.085450, loss_d: 0.447596
0.4673 --- loss: 1.355660, loss_ss: 1.168055, loss_d: 0.187605
0.5452 --- loss: 1.134563, loss_ss: 0.955143, loss_d: 0.179420
0.6231 --- loss: 1.324628, loss_ss: 1.073055, loss_d: 0.251573
0.7009 --- loss: 1.102011, loss_ss: 0.931386, loss_d: 0.170625
0.7788 --- loss: 1.090860, loss_ss: 0.931482, loss_d: 0.159378
0.8567 --- loss: 1.068687, loss_ss: 0.991746, loss_d: 0.076941
0.9346 --- loss: 1.479364, loss_ss: 1.014011, loss_d: 0.465353
Epoch finished! Loss: 1.3447663774713874
Starting epoch 4/10.
0.0000 --- loss: 1.219281, loss_ss: 0.961268, loss_d: 0.258013
0.0779 --- loss: 1.265979, loss_ss: 0.865741, loss_d: 0.400238
0.1558 --- loss: 1.504067, loss_ss: 0.988065, loss_d: 0.516002
0.2336 --- loss: 1.536989, loss_ss: 1.270206, loss_d: 0.266782
0.3115 --- loss: 1.219207, loss_ss: 0.930827, loss_d: 0.288379
0.3894 --- loss: 1.251368, loss_ss: 1.019180, loss_d: 0.232188
0.4673 --- loss: 1.259148, loss_ss: 1.017193, loss_d: 0.241955
0.5452 --- loss: 1.132189, loss_ss: 0.907396, loss_d: 0.224793
0.6231 --- loss: 1.059054, loss_ss: 0.965486, loss_d: 0.093568
0.7009 --- loss: 1.139750, loss_ss: 1.017708, loss_d: 0.122042
0.7788 --- loss: 0.965789, loss_ss: 0.938463, loss_d: 0.027325
0.8567 --- loss: 1.207038, loss_ss: 0.939061, loss_d: 0.267977
0.9346 --- loss: 0.835489, loss_ss: 0.757911, loss_d: 0.077578
Epoch finished! Loss: 1.2049852665513754
Starting epoch 5/10.
0.0000 --- loss: 1.005633, loss_ss: 0.852816, loss_d: 0.152817
0.0779 --- loss: 1.235752, loss_ss: 1.018523, loss_d: 0.217228
0.1558 --- loss: 1.056637, loss_ss: 0.964227, loss_d: 0.092410
0.2336 --- loss: 0.937225, loss_ss: 0.881694, loss_d: 0.055531
0.3115 --- loss: 1.065663, loss_ss: 0.871530, loss_d: 0.194134
0.3894 --- loss: 1.128429, loss_ss: 1.092488, loss_d: 0.035941
0.4673 --- loss: 1.197471, loss_ss: 0.981286, loss_d: 0.216185
0.5452 --- loss: 0.973407, loss_ss: 0.903681, loss_d: 0.069726
0.6231 --- loss: 1.154324, loss_ss: 1.058573, loss_d: 0.095750
0.7009 --- loss: 0.946459, loss_ss: 0.840001, loss_d: 0.106458
0.7788 --- loss: 1.244661, loss_ss: 0.874701, loss_d: 0.369960
0.8567 --- loss: 1.203074, loss_ss: 0.971874, loss_d: 0.231199
0.9346 --- loss: 1.101309, loss_ss: 0.866810, loss_d: 0.234500
Epoch finished! Loss: 1.1596887446939945
Starting epoch 6/10.
0.0000 --- loss: 0.919544, loss_ss: 0.859283, loss_d: 0.060261
0.0779 --- loss: 1.023246, loss_ss: 0.928898, loss_d: 0.094348
0.1558 --- loss: 1.395379, loss_ss: 1.163276, loss_d: 0.232103
0.2336 --- loss: 1.299825, loss_ss: 1.181863, loss_d: 0.117962
0.3115 --- loss: 1.216352, loss_ss: 0.947840, loss_d: 0.268512
0.3894 --- loss: 0.777012, loss_ss: 0.733730, loss_d: 0.043282
0.4673 --- loss: 0.704986, loss_ss: 0.637349, loss_d: 0.067637
0.5452 --- loss: 1.046175, loss_ss: 0.993047, loss_d: 0.053127
0.6231 --- loss: 0.819512, loss_ss: 0.776436, loss_d: 0.043076
0.7009 --- loss: 0.988031, loss_ss: 0.922653, loss_d: 0.065378
0.7788 --- loss: 1.139615, loss_ss: 1.059658, loss_d: 0.079957
0.8567 --- loss: 0.869317, loss_ss: 0.809564, loss_d: 0.059753
0.9346 --- loss: 1.025380, loss_ss: 0.973684, loss_d: 0.051695
Epoch finished! Loss: 1.1038598250597715
Starting epoch 7/10.
0.0000 --- loss: 0.956069, loss_ss: 0.935319, loss_d: 0.020750
0.0779 --- loss: 1.216956, loss_ss: 0.970225, loss_d: 0.246731
0.1558 --- loss: 1.141129, loss_ss: 1.124505, loss_d: 0.016624
0.2336 --- loss: 1.081675, loss_ss: 1.057932, loss_d: 0.023742
0.3115 --- loss: 0.804303, loss_ss: 0.783397, loss_d: 0.020907
0.3894 --- loss: 0.876504, loss_ss: 0.812454, loss_d: 0.064050
0.4673 --- loss: 1.090896, loss_ss: 0.936569, loss_d: 0.154328
0.5452 --- loss: 0.761198, loss_ss: 0.719194, loss_d: 0.042004
0.6231 --- loss: 0.819986, loss_ss: 0.811285, loss_d: 0.008700
0.7009 --- loss: 1.252040, loss_ss: 1.213830, loss_d: 0.038210
0.7788 --- loss: 0.884065, loss_ss: 0.861812, loss_d: 0.022252
0.8567 --- loss: 1.296072, loss_ss: 0.851666, loss_d: 0.444406
0.9346 --- loss: 1.035878, loss_ss: 0.897411, loss_d: 0.138467
Epoch finished! Loss: 1.0540275457315147
Starting epoch 8/10.
0.0000 --- loss: 1.038581, loss_ss: 0.923132, loss_d: 0.115448
0.0779 --- loss: 0.766872, loss_ss: 0.739926, loss_d: 0.026947
0.1558 --- loss: 0.873036, loss_ss: 0.780560, loss_d: 0.092476
0.2336 --- loss: 0.834809, loss_ss: 0.823275, loss_d: 0.011534
0.3115 --- loss: 0.866062, loss_ss: 0.814108, loss_d: 0.051954
0.3894 --- loss: 1.146482, loss_ss: 0.993221, loss_d: 0.153261
0.4673 --- loss: 0.830309, loss_ss: 0.742018, loss_d: 0.088291
0.5452 --- loss: 0.954603, loss_ss: 0.948399, loss_d: 0.006204
0.6231 --- loss: 0.834687, loss_ss: 0.822878, loss_d: 0.011809
0.7009 --- loss: 0.926454, loss_ss: 0.913506, loss_d: 0.012948
0.7788 --- loss: 1.458420, loss_ss: 0.605350, loss_d: 0.853070
0.8567 --- loss: 0.813805, loss_ss: 0.808567, loss_d: 0.005238
0.9346 --- loss: 0.702232, loss_ss: 0.628764, loss_d: 0.073468
Epoch finished! Loss: 0.9776660418137908
Starting epoch 9/10.
0.0000 --- loss: 0.685903, loss_ss: 0.677667, loss_d: 0.008236
0.0779 --- loss: 1.130636, loss_ss: 0.808930, loss_d: 0.321706
0.1558 --- loss: 0.907520, loss_ss: 0.833399, loss_d: 0.074121
0.2336 --- loss: 0.805559, loss_ss: 0.787510, loss_d: 0.018049
0.3115 --- loss: 0.800606, loss_ss: 0.779796, loss_d: 0.020810
0.3894 --- loss: 0.797598, loss_ss: 0.778542, loss_d: 0.019055
0.4673 --- loss: 0.921074, loss_ss: 0.901614, loss_d: 0.019460
0.5452 --- loss: 1.287203, loss_ss: 1.265893, loss_d: 0.021310
0.6231 --- loss: 0.916762, loss_ss: 0.792528, loss_d: 0.124234
0.7009 --- loss: 0.888851, loss_ss: 0.860263, loss_d: 0.028588
0.7788 --- loss: 0.693386, loss_ss: 0.682544, loss_d: 0.010842
0.8567 --- loss: 1.132400, loss_ss: 1.065251, loss_d: 0.067149
0.9346 --- loss: 0.828696, loss_ss: 0.772626, loss_d: 0.056070
Epoch finished! Loss: 0.9591412614099681
Starting epoch 10/10.
0.0000 --- loss: 0.854662, loss_ss: 0.848320, loss_d: 0.006341
0.0779 --- loss: 0.875717, loss_ss: 0.845498, loss_d: 0.030220
0.1558 --- loss: 1.057415, loss_ss: 0.826439, loss_d: 0.230976
0.2336 --- loss: 0.890780, loss_ss: 0.854773, loss_d: 0.036007
0.3115 --- loss: 0.741067, loss_ss: 0.731833, loss_d: 0.009234
0.3894 --- loss: 0.969277, loss_ss: 0.962139, loss_d: 0.007138
0.4673 --- loss: 0.937858, loss_ss: 0.931281, loss_d: 0.006577
0.5452 --- loss: 0.855241, loss_ss: 0.847163, loss_d: 0.008078
0.6231 --- loss: 0.834448, loss_ss: 0.791824, loss_d: 0.042624
0.7009 --- loss: 0.804090, loss_ss: 0.757991, loss_d: 0.046099
0.7788 --- loss: 0.751418, loss_ss: 0.743454, loss_d: 0.007964
0.8567 --- loss: 1.274675, loss_ss: 1.257389, loss_d: 0.017287
0.9346 --- loss: 0.781936, loss_ss: 0.777657, loss_d: 0.004279
Epoch finished! Loss: 0.8901230110786855
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6583333333333333
             precision    recall  f1-score   support

        0.0       0.66      0.55      0.60       189
        1.0       0.32      0.22      0.26       143
        2.0       0.51      0.80      0.62       221
        3.0       0.96      0.91      0.94       271
        4.0       0.72      0.54      0.62       136

avg / total       0.67      0.66      0.65       960
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.62  55.03   93.13  66.24     60.12
1  81.46  22.38   91.80  32.32     26.45
2  77.60  79.64   77.00  50.87     62.08
3  96.46  91.14   98.55  96.11     93.56
4  90.52  53.68   96.60  72.28     61.60
Total accuracy: 65.83%
Average sen: 60.37%
Average spec: 91.41%
Macro f1-score: 60.76%
Diagnosis acc on 30mins: 1.0
[0.99996078 0.99832743 0.99998724 1.         1.         1.
 0.99807703 0.99997151 1.         0.99999833 0.99999988 0.99999988
 1.         0.99999988 0.99999964 0.99999893]
pred: 0.9997700341045856, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp011-nsrr

=== Test on chp012-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.372713, loss_ss: 1.661142, loss_d: 0.711571
0.0780 --- loss: 2.062272, loss_ss: 1.499185, loss_d: 0.563087
0.1560 --- loss: 1.749013, loss_ss: 1.432791, loss_d: 0.316222
0.2340 --- loss: 1.974888, loss_ss: 1.357451, loss_d: 0.617436
0.3120 --- loss: 2.045623, loss_ss: 1.431252, loss_d: 0.614372
0.3900 --- loss: 2.062527, loss_ss: 1.348768, loss_d: 0.713759
0.4680 --- loss: 1.904440, loss_ss: 1.362305, loss_d: 0.542134
0.5460 --- loss: 1.660745, loss_ss: 1.140491, loss_d: 0.520254
0.6240 --- loss: 1.842932, loss_ss: 1.303698, loss_d: 0.539234
0.7020 --- loss: 1.677007, loss_ss: 1.148316, loss_d: 0.528691
0.7800 --- loss: 1.475341, loss_ss: 1.205084, loss_d: 0.270257
0.8580 --- loss: 1.978174, loss_ss: 1.390023, loss_d: 0.588152
0.9360 --- loss: 1.778289, loss_ss: 1.160433, loss_d: 0.617856
Epoch finished! Loss: 1.9345653979107738
Starting epoch 2/10.
0.0000 --- loss: 1.609480, loss_ss: 1.203001, loss_d: 0.406479
0.0780 --- loss: 1.683834, loss_ss: 1.211615, loss_d: 0.472219
0.1560 --- loss: 1.497984, loss_ss: 1.100399, loss_d: 0.397584
0.2340 --- loss: 1.493143, loss_ss: 1.058560, loss_d: 0.434583
0.3120 --- loss: 1.621451, loss_ss: 1.134851, loss_d: 0.486600
0.3900 --- loss: 1.620650, loss_ss: 1.163739, loss_d: 0.456911
0.4680 --- loss: 1.458872, loss_ss: 1.087726, loss_d: 0.371147
0.5460 --- loss: 1.597883, loss_ss: 1.125852, loss_d: 0.472031
0.6240 --- loss: 1.553330, loss_ss: 1.060563, loss_d: 0.492767
0.7020 --- loss: 2.113186, loss_ss: 1.200592, loss_d: 0.912594
0.7800 --- loss: 1.524826, loss_ss: 1.133876, loss_d: 0.390950
0.8580 --- loss: 1.298432, loss_ss: 0.983720, loss_d: 0.314712
0.9360 --- loss: 1.536833, loss_ss: 1.075792, loss_d: 0.461040
Epoch finished! Loss: 1.6140849804505706
Starting epoch 3/10.
0.0000 --- loss: 1.527012, loss_ss: 1.180504, loss_d: 0.346508
0.0780 --- loss: 1.407802, loss_ss: 1.089519, loss_d: 0.318283
0.1560 --- loss: 1.358341, loss_ss: 1.188898, loss_d: 0.169442
0.2340 --- loss: 1.400353, loss_ss: 1.258628, loss_d: 0.141725
0.3120 --- loss: 1.280805, loss_ss: 1.008649, loss_d: 0.272156
0.3900 --- loss: 1.616587, loss_ss: 1.275138, loss_d: 0.341449
0.4680 --- loss: 1.248153, loss_ss: 1.042582, loss_d: 0.205571
0.5460 --- loss: 1.513561, loss_ss: 1.046206, loss_d: 0.467355
0.6240 --- loss: 1.355220, loss_ss: 0.989940, loss_d: 0.365280
0.7020 --- loss: 1.382407, loss_ss: 1.166842, loss_d: 0.215564
0.7800 --- loss: 1.384519, loss_ss: 1.118731, loss_d: 0.265788
0.8580 --- loss: 1.143373, loss_ss: 1.012412, loss_d: 0.130960
0.9360 --- loss: 1.077549, loss_ss: 0.992291, loss_d: 0.085259
Epoch finished! Loss: 1.3995092413388193
Starting epoch 4/10.
0.0000 --- loss: 1.156461, loss_ss: 0.989810, loss_d: 0.166650
0.0780 --- loss: 1.663267, loss_ss: 1.544119, loss_d: 0.119148
0.1560 --- loss: 1.544857, loss_ss: 1.132528, loss_d: 0.412329
0.2340 --- loss: 1.309381, loss_ss: 1.134535, loss_d: 0.174846
0.3120 --- loss: 1.085384, loss_ss: 0.991595, loss_d: 0.093789
0.3900 --- loss: 1.096285, loss_ss: 0.966380, loss_d: 0.129904
0.4680 --- loss: 1.160465, loss_ss: 1.026142, loss_d: 0.134322
0.5460 --- loss: 0.988026, loss_ss: 0.855372, loss_d: 0.132654
0.6240 --- loss: 1.594726, loss_ss: 1.338822, loss_d: 0.255904
0.7020 --- loss: 1.077683, loss_ss: 0.998056, loss_d: 0.079627
0.7800 --- loss: 1.417005, loss_ss: 1.105828, loss_d: 0.311177
0.8580 --- loss: 1.182108, loss_ss: 1.070514, loss_d: 0.111594
0.9360 --- loss: 1.160096, loss_ss: 0.901034, loss_d: 0.259062
Epoch finished! Loss: 1.3248871774412692
Starting epoch 5/10.
0.0000 --- loss: 1.115277, loss_ss: 0.959089, loss_d: 0.156188
0.0780 --- loss: 1.092283, loss_ss: 0.945443, loss_d: 0.146840
0.1560 --- loss: 1.270755, loss_ss: 0.989083, loss_d: 0.281672
0.2340 --- loss: 1.003450, loss_ss: 0.886475, loss_d: 0.116975
0.3120 --- loss: 0.998534, loss_ss: 0.931400, loss_d: 0.067134
0.3900 --- loss: 1.204933, loss_ss: 0.856135, loss_d: 0.348799
0.4680 --- loss: 1.073954, loss_ss: 1.027520, loss_d: 0.046434
0.5460 --- loss: 1.130403, loss_ss: 0.926863, loss_d: 0.203540
0.6240 --- loss: 1.134817, loss_ss: 0.976182, loss_d: 0.158635
0.7020 --- loss: 1.293648, loss_ss: 0.988209, loss_d: 0.305439
0.7800 --- loss: 1.127816, loss_ss: 0.977626, loss_d: 0.150190
0.8580 --- loss: 1.184223, loss_ss: 0.798782, loss_d: 0.385441
0.9360 --- loss: 1.432927, loss_ss: 0.946007, loss_d: 0.486919
Epoch finished! Loss: 1.1946680438704789
Starting epoch 6/10.
0.0000 --- loss: 0.964525, loss_ss: 0.884972, loss_d: 0.079553
0.0780 --- loss: 1.022127, loss_ss: 0.938607, loss_d: 0.083520
0.1560 --- loss: 1.023151, loss_ss: 0.786829, loss_d: 0.236322
0.2340 --- loss: 0.915927, loss_ss: 0.819442, loss_d: 0.096485
0.3120 --- loss: 1.296788, loss_ss: 0.869531, loss_d: 0.427257
0.3900 --- loss: 1.304181, loss_ss: 0.947913, loss_d: 0.356268
0.4680 --- loss: 1.470658, loss_ss: 1.134723, loss_d: 0.335935
0.5460 --- loss: 1.394539, loss_ss: 0.885640, loss_d: 0.508899
0.6240 --- loss: 0.791005, loss_ss: 0.782627, loss_d: 0.008379
0.7020 --- loss: 1.004592, loss_ss: 0.883043, loss_d: 0.121549
0.7800 --- loss: 1.013758, loss_ss: 0.960930, loss_d: 0.052828
0.8580 --- loss: 1.053192, loss_ss: 0.902788, loss_d: 0.150404
0.9360 --- loss: 1.654923, loss_ss: 1.094660, loss_d: 0.560263
Epoch finished! Loss: 1.1508400375023484
Starting epoch 7/10.
0.0000 --- loss: 1.405865, loss_ss: 0.986317, loss_d: 0.419548
0.0780 --- loss: 0.982667, loss_ss: 0.823123, loss_d: 0.159544
0.1560 --- loss: 1.191037, loss_ss: 1.104737, loss_d: 0.086299
0.2340 --- loss: 0.953725, loss_ss: 0.930534, loss_d: 0.023190
0.3120 --- loss: 1.501710, loss_ss: 0.867357, loss_d: 0.634353
0.3900 --- loss: 0.875880, loss_ss: 0.855322, loss_d: 0.020558
0.4680 --- loss: 0.937131, loss_ss: 0.836118, loss_d: 0.101014
0.5460 --- loss: 0.759998, loss_ss: 0.749351, loss_d: 0.010648
0.6240 --- loss: 0.970980, loss_ss: 0.920084, loss_d: 0.050896
0.7020 --- loss: 1.093613, loss_ss: 1.076371, loss_d: 0.017242
0.7800 --- loss: 1.081079, loss_ss: 0.913166, loss_d: 0.167913
0.8580 --- loss: 1.066499, loss_ss: 1.048679, loss_d: 0.017820
0.9360 --- loss: 0.980543, loss_ss: 0.786611, loss_d: 0.193931
Epoch finished! Loss: 1.0703387362882495
Starting epoch 8/10.
0.0000 --- loss: 1.182253, loss_ss: 0.800487, loss_d: 0.381766
0.0780 --- loss: 0.883551, loss_ss: 0.855689, loss_d: 0.027862
0.1560 --- loss: 1.086645, loss_ss: 1.077102, loss_d: 0.009543
0.2340 --- loss: 0.883187, loss_ss: 0.863641, loss_d: 0.019546
0.3120 --- loss: 1.244638, loss_ss: 1.035319, loss_d: 0.209319
0.3900 --- loss: 0.848594, loss_ss: 0.818226, loss_d: 0.030368
0.4680 --- loss: 0.942561, loss_ss: 0.915587, loss_d: 0.026974
0.5460 --- loss: 0.723408, loss_ss: 0.719268, loss_d: 0.004140
0.6240 --- loss: 1.015985, loss_ss: 0.838907, loss_d: 0.177078
0.7020 --- loss: 1.042466, loss_ss: 0.982365, loss_d: 0.060102
0.7800 --- loss: 1.005689, loss_ss: 0.960497, loss_d: 0.045192
0.8580 --- loss: 1.070945, loss_ss: 1.003209, loss_d: 0.067736
0.9360 --- loss: 0.831950, loss_ss: 0.797106, loss_d: 0.034844
Epoch finished! Loss: 1.0279233590699732
Starting epoch 9/10.
0.0000 --- loss: 0.940577, loss_ss: 0.924370, loss_d: 0.016207
0.0780 --- loss: 0.765088, loss_ss: 0.748363, loss_d: 0.016725
0.1560 --- loss: 0.873886, loss_ss: 0.796518, loss_d: 0.077368
0.2340 --- loss: 0.999702, loss_ss: 0.949963, loss_d: 0.049739
0.3120 --- loss: 1.288849, loss_ss: 1.115879, loss_d: 0.172971
0.3900 --- loss: 1.028641, loss_ss: 0.665784, loss_d: 0.362857
0.4680 --- loss: 0.833190, loss_ss: 0.784913, loss_d: 0.048277
0.5460 --- loss: 1.028188, loss_ss: 0.811361, loss_d: 0.216827
0.6240 --- loss: 1.086115, loss_ss: 1.040436, loss_d: 0.045679
0.7020 --- loss: 0.962185, loss_ss: 0.952946, loss_d: 0.009239
0.7800 --- loss: 0.942954, loss_ss: 0.925003, loss_d: 0.017951
0.8580 --- loss: 0.880502, loss_ss: 0.859453, loss_d: 0.021049
0.9360 --- loss: 0.759376, loss_ss: 0.753447, loss_d: 0.005929
Epoch finished! Loss: 0.9880066085606813
Starting epoch 10/10.
0.0000 --- loss: 0.821902, loss_ss: 0.804192, loss_d: 0.017710
0.0780 --- loss: 0.892688, loss_ss: 0.887534, loss_d: 0.005154
0.1560 --- loss: 0.800871, loss_ss: 0.792476, loss_d: 0.008395
0.2340 --- loss: 0.838198, loss_ss: 0.784899, loss_d: 0.053300
0.3120 --- loss: 1.040676, loss_ss: 0.916169, loss_d: 0.124507
0.3900 --- loss: 0.842031, loss_ss: 0.802311, loss_d: 0.039719
0.4680 --- loss: 1.226861, loss_ss: 0.927452, loss_d: 0.299409
0.5460 --- loss: 1.326897, loss_ss: 0.872009, loss_d: 0.454888
0.6240 --- loss: 1.104692, loss_ss: 1.033265, loss_d: 0.071427
0.7020 --- loss: 0.770943, loss_ss: 0.766087, loss_d: 0.004856
0.7800 --- loss: 0.794408, loss_ss: 0.785257, loss_d: 0.009152
0.8580 --- loss: 0.979316, loss_ss: 0.975843, loss_d: 0.003473
0.9360 --- loss: 0.985659, loss_ss: 0.951870, loss_d: 0.033789
Epoch finished! Loss: 0.9914717357605696
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6592592592592592
             precision    recall  f1-score   support

        0.0       0.39      0.65      0.49        23
        1.0       0.37      0.57      0.45       178
        2.0       0.74      0.76      0.75       379
        3.0       1.00      0.54      0.70       203
        4.0       0.74      0.67      0.70       297

avg / total       0.72      0.66      0.67      1080
 


====== chp012-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.13  65.22   97.82   39.47     49.18
1  76.85  57.30   80.71   36.96     44.93
2  81.94  75.73   85.31   73.59     74.64
3  91.39  54.19  100.00  100.00     70.29
4  84.54  66.67   91.32   74.44     70.34
Total accuracy: 65.93%
Average sen: 63.82%
Average spec: 91.03%
Macro f1-score: 61.88%
Diagnosis acc on 30mins: 1.0
[0.99999988 0.99977225 0.99784791 0.99998844 0.99999952 0.99999666
 0.99998534 0.99999917 0.99992228 0.99971634 0.99999905 1.
 0.99999809 0.9999882  0.99989331 0.99994457 0.99989593 0.99999487]
pred: 0.9998301002714369, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp012-nsrr

=== Test on chp013-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.216001, loss_ss: 1.548375, loss_d: 0.667626
0.0779 --- loss: 2.190516, loss_ss: 1.530662, loss_d: 0.659854
0.1558 --- loss: 2.012601, loss_ss: 1.309547, loss_d: 0.703054
0.2336 --- loss: 1.946699, loss_ss: 1.391213, loss_d: 0.555486
0.3115 --- loss: 2.045439, loss_ss: 1.354710, loss_d: 0.690729
0.3894 --- loss: 1.981029, loss_ss: 1.343501, loss_d: 0.637528
0.4673 --- loss: 1.760922, loss_ss: 1.245117, loss_d: 0.515805
0.5452 --- loss: 1.808000, loss_ss: 1.265971, loss_d: 0.542029
0.6231 --- loss: 1.862157, loss_ss: 1.201606, loss_d: 0.660551
0.7009 --- loss: 1.547863, loss_ss: 1.364598, loss_d: 0.183264
0.7788 --- loss: 1.923979, loss_ss: 1.263649, loss_d: 0.660330
0.8567 --- loss: 2.037068, loss_ss: 1.191410, loss_d: 0.845658
0.9346 --- loss: 1.622891, loss_ss: 1.139746, loss_d: 0.483145
Epoch finished! Loss: 1.9381489660590887
Starting epoch 2/10.
0.0000 --- loss: 1.911072, loss_ss: 1.209464, loss_d: 0.701608
0.0779 --- loss: 1.641764, loss_ss: 1.308599, loss_d: 0.333165
0.1558 --- loss: 1.563235, loss_ss: 1.160465, loss_d: 0.402770
0.2336 --- loss: 1.623999, loss_ss: 1.123265, loss_d: 0.500734
0.3115 --- loss: 1.755546, loss_ss: 1.229262, loss_d: 0.526284
0.3894 --- loss: 1.629918, loss_ss: 1.205640, loss_d: 0.424278
0.4673 --- loss: 1.531936, loss_ss: 1.168240, loss_d: 0.363696
0.5452 --- loss: 1.480925, loss_ss: 1.264510, loss_d: 0.216415
0.6231 --- loss: 1.629302, loss_ss: 1.154285, loss_d: 0.475017
0.7009 --- loss: 1.716219, loss_ss: 1.238387, loss_d: 0.477833
0.7788 --- loss: 1.511705, loss_ss: 1.137912, loss_d: 0.373793
0.8567 --- loss: 1.625582, loss_ss: 1.168345, loss_d: 0.457237
0.9346 --- loss: 1.559946, loss_ss: 1.090743, loss_d: 0.469203
Epoch finished! Loss: 1.6334225898608565
Starting epoch 3/10.
0.0000 --- loss: 1.374870, loss_ss: 1.081552, loss_d: 0.293319
0.0779 --- loss: 1.359654, loss_ss: 0.989077, loss_d: 0.370577
0.1558 --- loss: 1.645499, loss_ss: 1.321686, loss_d: 0.323813
0.2336 --- loss: 1.791636, loss_ss: 1.081013, loss_d: 0.710622
0.3115 --- loss: 1.541970, loss_ss: 1.214667, loss_d: 0.327303
0.3894 --- loss: 1.148391, loss_ss: 1.032500, loss_d: 0.115891
0.4673 --- loss: 1.135916, loss_ss: 1.022455, loss_d: 0.113462
0.5452 --- loss: 1.304869, loss_ss: 1.028407, loss_d: 0.276462
0.6231 --- loss: 1.364504, loss_ss: 1.182332, loss_d: 0.182172
0.7009 --- loss: 1.724738, loss_ss: 1.108712, loss_d: 0.616026
0.7788 --- loss: 1.401426, loss_ss: 1.045742, loss_d: 0.355684
0.8567 --- loss: 1.586145, loss_ss: 1.069734, loss_d: 0.516411
0.9346 --- loss: 1.540972, loss_ss: 1.092558, loss_d: 0.448414
Epoch finished! Loss: 1.4258187902159989
Starting epoch 4/10.
0.0000 --- loss: 0.998175, loss_ss: 0.913607, loss_d: 0.084568
0.0779 --- loss: 1.340662, loss_ss: 1.119488, loss_d: 0.221174
0.1558 --- loss: 1.234844, loss_ss: 0.974376, loss_d: 0.260468
0.2336 --- loss: 1.061906, loss_ss: 0.947765, loss_d: 0.114141
0.3115 --- loss: 1.218601, loss_ss: 0.886908, loss_d: 0.331693
0.3894 --- loss: 1.133159, loss_ss: 0.903915, loss_d: 0.229245
0.4673 --- loss: 1.486389, loss_ss: 1.068082, loss_d: 0.418307
0.5452 --- loss: 1.258571, loss_ss: 1.120347, loss_d: 0.138224
0.6231 --- loss: 1.024126, loss_ss: 0.919163, loss_d: 0.104963
0.7009 --- loss: 1.094943, loss_ss: 0.839211, loss_d: 0.255732
0.7788 --- loss: 1.565990, loss_ss: 1.274005, loss_d: 0.291985
0.8567 --- loss: 1.072947, loss_ss: 0.873862, loss_d: 0.199085
0.9346 --- loss: 1.191050, loss_ss: 0.812111, loss_d: 0.378939
Epoch finished! Loss: 1.26751389214769
Starting epoch 5/10.
0.0000 --- loss: 0.922276, loss_ss: 0.866795, loss_d: 0.055480
0.0779 --- loss: 0.980918, loss_ss: 0.896126, loss_d: 0.084792
0.1558 --- loss: 1.171716, loss_ss: 0.880299, loss_d: 0.291417
0.2336 --- loss: 1.141740, loss_ss: 0.907210, loss_d: 0.234530
0.3115 --- loss: 1.225010, loss_ss: 0.954322, loss_d: 0.270687
0.3894 --- loss: 1.451734, loss_ss: 1.043278, loss_d: 0.408456
0.4673 --- loss: 0.999831, loss_ss: 0.875087, loss_d: 0.124744
0.5452 --- loss: 1.015641, loss_ss: 0.976594, loss_d: 0.039047
0.6231 --- loss: 1.103335, loss_ss: 0.824635, loss_d: 0.278699
0.7009 --- loss: 0.974507, loss_ss: 0.867366, loss_d: 0.107141
0.7788 --- loss: 1.224003, loss_ss: 0.900183, loss_d: 0.323819
0.8567 --- loss: 1.099508, loss_ss: 0.799104, loss_d: 0.300403
0.9346 --- loss: 1.067733, loss_ss: 0.918878, loss_d: 0.148856
Epoch finished! Loss: 1.1615125192329288
Starting epoch 6/10.
0.0000 --- loss: 0.814878, loss_ss: 0.713784, loss_d: 0.101094
0.0779 --- loss: 1.020821, loss_ss: 0.818917, loss_d: 0.201904
0.1558 --- loss: 1.302842, loss_ss: 0.917054, loss_d: 0.385787
0.2336 --- loss: 1.040804, loss_ss: 0.960212, loss_d: 0.080592
0.3115 --- loss: 1.099959, loss_ss: 0.884255, loss_d: 0.215704
0.3894 --- loss: 1.341458, loss_ss: 0.694685, loss_d: 0.646773
0.4673 --- loss: 1.058700, loss_ss: 1.008081, loss_d: 0.050619
0.5452 --- loss: 1.378926, loss_ss: 0.903601, loss_d: 0.475325
0.6231 --- loss: 0.937505, loss_ss: 0.775339, loss_d: 0.162165
0.7009 --- loss: 0.900106, loss_ss: 0.795109, loss_d: 0.104997
0.7788 --- loss: 1.872977, loss_ss: 0.890343, loss_d: 0.982635
0.8567 --- loss: 1.459363, loss_ss: 1.233789, loss_d: 0.225574
0.9346 --- loss: 0.978210, loss_ss: 0.885337, loss_d: 0.092873
Epoch finished! Loss: 1.0990731716156006
Starting epoch 7/10.
0.0000 --- loss: 0.783247, loss_ss: 0.702268, loss_d: 0.080979
0.0779 --- loss: 1.166630, loss_ss: 1.092747, loss_d: 0.073882
0.1558 --- loss: 0.966750, loss_ss: 0.836283, loss_d: 0.130466
0.2336 --- loss: 0.980953, loss_ss: 0.803770, loss_d: 0.177182
0.3115 --- loss: 1.081929, loss_ss: 1.043991, loss_d: 0.037938
0.3894 --- loss: 1.157933, loss_ss: 0.900283, loss_d: 0.257650
0.4673 --- loss: 0.944523, loss_ss: 0.939734, loss_d: 0.004789
0.5452 --- loss: 1.016177, loss_ss: 0.819886, loss_d: 0.196291
0.6231 --- loss: 0.795013, loss_ss: 0.747951, loss_d: 0.047063
0.7009 --- loss: 0.914486, loss_ss: 0.829856, loss_d: 0.084630
0.7788 --- loss: 0.998536, loss_ss: 0.944082, loss_d: 0.054454
0.8567 --- loss: 0.965945, loss_ss: 0.883777, loss_d: 0.082168
0.9346 --- loss: 0.924513, loss_ss: 0.902208, loss_d: 0.022305
Epoch finished! Loss: 1.0435006450861692
Starting epoch 8/10.
0.0000 --- loss: 0.874772, loss_ss: 0.863527, loss_d: 0.011244
0.0779 --- loss: 0.986668, loss_ss: 0.917306, loss_d: 0.069363
0.1558 --- loss: 0.747743, loss_ss: 0.727932, loss_d: 0.019811
0.2336 --- loss: 0.760340, loss_ss: 0.723139, loss_d: 0.037201
0.3115 --- loss: 1.046838, loss_ss: 0.850574, loss_d: 0.196264
0.3894 --- loss: 0.739258, loss_ss: 0.735952, loss_d: 0.003306
0.4673 --- loss: 0.954353, loss_ss: 0.852147, loss_d: 0.102205
0.5452 --- loss: 1.040333, loss_ss: 0.708997, loss_d: 0.331336
0.6231 --- loss: 0.959150, loss_ss: 0.928384, loss_d: 0.030765
0.7009 --- loss: 0.867582, loss_ss: 0.856958, loss_d: 0.010624
0.7788 --- loss: 1.218023, loss_ss: 1.079937, loss_d: 0.138086
0.8567 --- loss: 0.780153, loss_ss: 0.764803, loss_d: 0.015350
0.9346 --- loss: 1.046800, loss_ss: 1.027212, loss_d: 0.019589
Epoch finished! Loss: 0.9535208255983889
Starting epoch 9/10.
0.0000 --- loss: 0.885443, loss_ss: 0.864943, loss_d: 0.020500
0.0779 --- loss: 0.767681, loss_ss: 0.766595, loss_d: 0.001086
0.1558 --- loss: 0.950911, loss_ss: 0.916391, loss_d: 0.034520
0.2336 --- loss: 0.710310, loss_ss: 0.697547, loss_d: 0.012763
0.3115 --- loss: 1.015798, loss_ss: 0.881109, loss_d: 0.134690
0.3894 --- loss: 0.748252, loss_ss: 0.666552, loss_d: 0.081700
0.4673 --- loss: 1.034143, loss_ss: 0.997699, loss_d: 0.036443
0.5452 --- loss: 1.018388, loss_ss: 1.013739, loss_d: 0.004649
0.6231 --- loss: 0.741148, loss_ss: 0.734358, loss_d: 0.006790
0.7009 --- loss: 0.862107, loss_ss: 0.860381, loss_d: 0.001726
0.7788 --- loss: 0.908968, loss_ss: 0.645119, loss_d: 0.263849
0.8567 --- loss: 0.909445, loss_ss: 0.865419, loss_d: 0.044026
0.9346 --- loss: 1.029499, loss_ss: 0.965678, loss_d: 0.063821
Epoch finished! Loss: 0.9168238844722509
Starting epoch 10/10.
0.0000 --- loss: 0.911225, loss_ss: 0.901791, loss_d: 0.009434
0.0779 --- loss: 0.883863, loss_ss: 0.833975, loss_d: 0.049888
0.1558 --- loss: 0.808500, loss_ss: 0.801246, loss_d: 0.007255
0.2336 --- loss: 0.826418, loss_ss: 0.819629, loss_d: 0.006790
0.3115 --- loss: 0.744153, loss_ss: 0.742360, loss_d: 0.001793
0.3894 --- loss: 0.813178, loss_ss: 0.787093, loss_d: 0.026085
0.4673 --- loss: 0.740424, loss_ss: 0.733787, loss_d: 0.006637
0.5452 --- loss: 0.818498, loss_ss: 0.815436, loss_d: 0.003062
0.6231 --- loss: 1.065416, loss_ss: 0.985160, loss_d: 0.080256
0.7009 --- loss: 0.913786, loss_ss: 0.911692, loss_d: 0.002094
0.7788 --- loss: 0.797738, loss_ss: 0.782326, loss_d: 0.015411
0.8567 --- loss: 1.080858, loss_ss: 0.901256, loss_d: 0.179602
0.9346 --- loss: 0.894652, loss_ss: 0.889127, loss_d: 0.005525
Epoch finished! Loss: 0.9349811472930014
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7322916666666667
             precision    recall  f1-score   support

        0.0       0.62      0.77      0.69        31
        1.0       1.00      0.01      0.02       118
        2.0       0.84      0.80      0.82       433
        3.0       0.85      0.79      0.82       189
        4.0       0.55      0.96      0.70       189

avg / total       0.80      0.73      0.69       960
 


====== chp013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  97.71  77.42   98.39   61.54     68.57
1  87.81   0.85  100.00  100.00      1.68
2  84.06  80.37   87.10   83.65     81.98
3  93.12  78.84   96.63   85.14     81.87
4  83.75  95.77   80.80   55.02     69.88
Total accuracy: 73.23%
Average sen: 66.65%
Average spec: 92.58%
Macro f1-score: 60.80%
Diagnosis acc on 30mins: 1.0
[0.999762   0.8617382  0.99582601 0.9550938  0.99880421 0.99986708
 0.88129222 0.99245584 0.99974519 0.98730403 0.99742162 0.99713624
 0.99999976 0.73172385 0.97498578 0.99943978]
pred: 0.9607872255146503, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp013-nsrr

=== Test on chp014-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.213379, loss_ss: 1.569669, loss_d: 0.643710
0.0779 --- loss: 2.258678, loss_ss: 1.522111, loss_d: 0.736567
0.1558 --- loss: 2.202577, loss_ss: 1.461088, loss_d: 0.741488
0.2336 --- loss: 2.392530, loss_ss: 1.371544, loss_d: 1.020986
0.3115 --- loss: 1.957069, loss_ss: 1.343544, loss_d: 0.613526
0.3894 --- loss: 1.893689, loss_ss: 1.243476, loss_d: 0.650213
0.4673 --- loss: 1.923292, loss_ss: 1.258451, loss_d: 0.664841
0.5452 --- loss: 1.785383, loss_ss: 1.386174, loss_d: 0.399209
0.6231 --- loss: 1.679202, loss_ss: 1.242933, loss_d: 0.436269
0.7009 --- loss: 2.244107, loss_ss: 1.451973, loss_d: 0.792135
0.7788 --- loss: 1.543319, loss_ss: 1.212662, loss_d: 0.330657
0.8567 --- loss: 2.080817, loss_ss: 1.119199, loss_d: 0.961618
0.9346 --- loss: 2.018739, loss_ss: 1.181418, loss_d: 0.837321
Epoch finished! Loss: 1.9596342667937279
Starting epoch 2/10.
0.0000 --- loss: 1.799352, loss_ss: 1.264764, loss_d: 0.534588
0.0779 --- loss: 2.080050, loss_ss: 1.233764, loss_d: 0.846286
0.1558 --- loss: 1.804479, loss_ss: 1.326678, loss_d: 0.477802
0.2336 --- loss: 1.457045, loss_ss: 1.127670, loss_d: 0.329375
0.3115 --- loss: 1.718490, loss_ss: 1.230964, loss_d: 0.487526
0.3894 --- loss: 1.676791, loss_ss: 1.043522, loss_d: 0.633269
0.4673 --- loss: 1.664183, loss_ss: 1.389018, loss_d: 0.275165
0.5452 --- loss: 1.571946, loss_ss: 1.231554, loss_d: 0.340392
0.6231 --- loss: 1.450365, loss_ss: 1.221844, loss_d: 0.228521
0.7009 --- loss: 1.373148, loss_ss: 1.069445, loss_d: 0.303704
0.7788 --- loss: 1.523865, loss_ss: 1.266293, loss_d: 0.257572
0.8567 --- loss: 1.173403, loss_ss: 1.000116, loss_d: 0.173288
0.9346 --- loss: 1.347102, loss_ss: 1.155571, loss_d: 0.191531
Epoch finished! Loss: 1.6434929510578513
Starting epoch 3/10.
0.0000 --- loss: 1.192697, loss_ss: 0.992263, loss_d: 0.200434
0.0779 --- loss: 1.380406, loss_ss: 1.126152, loss_d: 0.254254
0.1558 --- loss: 1.529300, loss_ss: 0.909084, loss_d: 0.620216
0.2336 --- loss: 1.234051, loss_ss: 1.156090, loss_d: 0.077961
0.3115 --- loss: 1.202205, loss_ss: 1.048998, loss_d: 0.153206
0.3894 --- loss: 1.394554, loss_ss: 1.111122, loss_d: 0.283432
0.4673 --- loss: 1.542237, loss_ss: 1.281550, loss_d: 0.260687
0.5452 --- loss: 1.157443, loss_ss: 0.889549, loss_d: 0.267895
0.6231 --- loss: 1.998694, loss_ss: 1.040980, loss_d: 0.957714
0.7009 --- loss: 1.320153, loss_ss: 1.023337, loss_d: 0.296817
0.7788 --- loss: 1.227099, loss_ss: 0.983863, loss_d: 0.243237
0.8567 --- loss: 1.244366, loss_ss: 1.056027, loss_d: 0.188339
0.9346 --- loss: 1.362593, loss_ss: 1.179685, loss_d: 0.182908
Epoch finished! Loss: 1.450154386460781
Starting epoch 4/10.
0.0000 --- loss: 1.152111, loss_ss: 1.077947, loss_d: 0.074164
0.0779 --- loss: 1.077037, loss_ss: 1.013223, loss_d: 0.063814
0.1558 --- loss: 1.154320, loss_ss: 1.026255, loss_d: 0.128065
0.2336 --- loss: 1.768505, loss_ss: 1.113338, loss_d: 0.655167
0.3115 --- loss: 1.089007, loss_ss: 0.999963, loss_d: 0.089044
0.3894 --- loss: 1.145884, loss_ss: 0.880348, loss_d: 0.265535
0.4673 --- loss: 1.149340, loss_ss: 0.967254, loss_d: 0.182086
0.5452 --- loss: 1.387337, loss_ss: 0.860949, loss_d: 0.526388
0.6231 --- loss: 1.381109, loss_ss: 1.019291, loss_d: 0.361818
0.7009 --- loss: 1.535009, loss_ss: 1.204667, loss_d: 0.330341
0.7788 --- loss: 1.488585, loss_ss: 1.304494, loss_d: 0.184091
0.8567 --- loss: 1.237867, loss_ss: 1.201493, loss_d: 0.036374
0.9346 --- loss: 1.701814, loss_ss: 1.200092, loss_d: 0.501722
Epoch finished! Loss: 1.3376203370280564
Starting epoch 5/10.
0.0000 --- loss: 1.567536, loss_ss: 1.301528, loss_d: 0.266008
0.0779 --- loss: 1.408750, loss_ss: 1.291696, loss_d: 0.117053
0.1558 --- loss: 1.090247, loss_ss: 0.909463, loss_d: 0.180784
0.2336 --- loss: 0.973772, loss_ss: 0.913147, loss_d: 0.060626
0.3115 --- loss: 1.311805, loss_ss: 0.971922, loss_d: 0.339883
0.3894 --- loss: 1.146543, loss_ss: 0.874764, loss_d: 0.271779
0.4673 --- loss: 1.098783, loss_ss: 1.006032, loss_d: 0.092751
0.5452 --- loss: 1.658605, loss_ss: 1.605940, loss_d: 0.052665
0.6231 --- loss: 1.463313, loss_ss: 1.400631, loss_d: 0.062681
0.7009 --- loss: 1.602081, loss_ss: 1.516124, loss_d: 0.085957
0.7788 --- loss: 0.934553, loss_ss: 0.885349, loss_d: 0.049204
0.8567 --- loss: 0.905801, loss_ss: 0.856139, loss_d: 0.049662
0.9346 --- loss: 1.302580, loss_ss: 0.847406, loss_d: 0.455174
Epoch finished! Loss: 1.2433005440980196
Starting epoch 6/10.
0.0000 --- loss: 1.274563, loss_ss: 1.085493, loss_d: 0.189071
0.0779 --- loss: 1.168093, loss_ss: 1.011568, loss_d: 0.156525
0.1558 --- loss: 1.270698, loss_ss: 0.998019, loss_d: 0.272680
0.2336 --- loss: 1.216226, loss_ss: 1.179668, loss_d: 0.036558
0.3115 --- loss: 1.323414, loss_ss: 1.274185, loss_d: 0.049229
0.3894 --- loss: 1.168826, loss_ss: 0.788504, loss_d: 0.380322
0.4673 --- loss: 1.268143, loss_ss: 0.947926, loss_d: 0.320217
0.5452 --- loss: 1.623882, loss_ss: 1.207250, loss_d: 0.416632
0.6231 --- loss: 1.784050, loss_ss: 1.213908, loss_d: 0.570142
0.7009 --- loss: 1.375898, loss_ss: 1.040659, loss_d: 0.335238
0.7788 --- loss: 1.160874, loss_ss: 1.005277, loss_d: 0.155597
0.8567 --- loss: 1.297403, loss_ss: 1.258013, loss_d: 0.039390
0.9346 --- loss: 1.075805, loss_ss: 0.955701, loss_d: 0.120103
Epoch finished! Loss: 1.217290399596095
Starting epoch 7/10.
0.0000 --- loss: 1.003306, loss_ss: 0.843826, loss_d: 0.159480
0.0779 --- loss: 0.976188, loss_ss: 0.953704, loss_d: 0.022485
0.1558 --- loss: 0.965697, loss_ss: 0.898355, loss_d: 0.067341
0.2336 --- loss: 1.129481, loss_ss: 0.973786, loss_d: 0.155695
0.3115 --- loss: 1.194652, loss_ss: 1.028853, loss_d: 0.165799
0.3894 --- loss: 0.964120, loss_ss: 0.935901, loss_d: 0.028219
0.4673 --- loss: 1.095227, loss_ss: 1.008802, loss_d: 0.086425
0.5452 --- loss: 0.790729, loss_ss: 0.748259, loss_d: 0.042470
0.6231 --- loss: 0.800041, loss_ss: 0.767132, loss_d: 0.032908
0.7009 --- loss: 2.265311, loss_ss: 0.803854, loss_d: 1.461457
0.7788 --- loss: 1.128262, loss_ss: 1.090972, loss_d: 0.037290
0.8567 --- loss: 0.881843, loss_ss: 0.850584, loss_d: 0.031259
0.9346 --- loss: 1.476670, loss_ss: 1.108549, loss_d: 0.368121
Epoch finished! Loss: 1.103142918087542
Starting epoch 8/10.
0.0000 --- loss: 1.084150, loss_ss: 1.071007, loss_d: 0.013143
0.0779 --- loss: 0.931172, loss_ss: 0.875663, loss_d: 0.055510
0.1558 --- loss: 1.016393, loss_ss: 0.795708, loss_d: 0.220684
0.2336 --- loss: 1.011246, loss_ss: 0.963867, loss_d: 0.047379
0.3115 --- loss: 1.412348, loss_ss: 1.195073, loss_d: 0.217276
0.3894 --- loss: 0.876193, loss_ss: 0.805830, loss_d: 0.070363
0.4673 --- loss: 1.030972, loss_ss: 1.003459, loss_d: 0.027513
0.5452 --- loss: 0.957884, loss_ss: 0.945925, loss_d: 0.011960
0.6231 --- loss: 1.029570, loss_ss: 0.944669, loss_d: 0.084901
0.7009 --- loss: 0.926317, loss_ss: 0.921005, loss_d: 0.005312
0.7788 --- loss: 0.900113, loss_ss: 0.846571, loss_d: 0.053542
0.8567 --- loss: 0.883685, loss_ss: 0.873623, loss_d: 0.010062
0.9346 --- loss: 1.027210, loss_ss: 0.987562, loss_d: 0.039648
Epoch finished! Loss: 1.0716956756077707
Starting epoch 9/10.
0.0000 --- loss: 1.125966, loss_ss: 1.086386, loss_d: 0.039579
0.0779 --- loss: 0.976012, loss_ss: 0.936189, loss_d: 0.039824
0.1558 --- loss: 1.076939, loss_ss: 1.054747, loss_d: 0.022191
0.2336 --- loss: 0.908275, loss_ss: 0.861305, loss_d: 0.046970
0.3115 --- loss: 1.434147, loss_ss: 1.420512, loss_d: 0.013635
0.3894 --- loss: 0.913755, loss_ss: 0.911224, loss_d: 0.002531
0.4673 --- loss: 0.987673, loss_ss: 0.919005, loss_d: 0.068669
0.5452 --- loss: 0.768030, loss_ss: 0.762521, loss_d: 0.005508
0.6231 --- loss: 0.830381, loss_ss: 0.804686, loss_d: 0.025695
0.7009 --- loss: 0.747818, loss_ss: 0.738676, loss_d: 0.009142
0.7788 --- loss: 1.509873, loss_ss: 1.382226, loss_d: 0.127647
0.8567 --- loss: 1.301434, loss_ss: 1.290072, loss_d: 0.011361
0.9346 --- loss: 0.935834, loss_ss: 0.903196, loss_d: 0.032638
Epoch finished! Loss: 1.0231442395597696
Starting epoch 10/10.
0.0000 --- loss: 1.394997, loss_ss: 1.150651, loss_d: 0.244346
0.0779 --- loss: 0.857711, loss_ss: 0.851494, loss_d: 0.006217
0.1558 --- loss: 1.052034, loss_ss: 1.039356, loss_d: 0.012678
0.2336 --- loss: 1.134303, loss_ss: 1.127043, loss_d: 0.007261
0.3115 --- loss: 1.085559, loss_ss: 1.083385, loss_d: 0.002173
0.3894 --- loss: 1.273666, loss_ss: 0.902292, loss_d: 0.371374
0.4673 --- loss: 0.781277, loss_ss: 0.740074, loss_d: 0.041202
0.5452 --- loss: 0.959238, loss_ss: 0.855774, loss_d: 0.103464
0.6231 --- loss: 0.874951, loss_ss: 0.866024, loss_d: 0.008926
0.7009 --- loss: 0.935669, loss_ss: 0.910250, loss_d: 0.025419
0.7788 --- loss: 0.958435, loss_ss: 0.951918, loss_d: 0.006516
0.8567 --- loss: 1.222921, loss_ss: 0.944223, loss_d: 0.278698
0.9346 --- loss: 1.458798, loss_ss: 0.749439, loss_d: 0.709359
Epoch finished! Loss: 1.0215206118300557
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6645833333333333
             precision    recall  f1-score   support

        0.0       0.93      0.79      0.86       188
        1.0       0.15      0.48      0.23        63
        2.0       0.81      0.78      0.79       397
        3.0       1.00      0.53      0.69       146
        4.0       0.50      0.43      0.47       166

avg / total       0.76      0.66      0.70       960
 


====== chp014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.79  79.26   98.58   93.12     85.63
1  79.38  47.62   81.61   15.38     23.26
2  83.12  78.09   86.68   80.52     79.28
3  92.81  52.74  100.00  100.00     69.06
4  82.81  43.37   91.06   50.35     46.60
Total accuracy: 66.46%
Average sen: 60.21%
Average spec: 91.58%
Macro f1-score: 60.77%
Diagnosis acc on 30mins: 1.0
[0.99883693 0.99998415 0.99982482 0.99999928 0.99998271 0.99685919
 0.99998426 0.99995291 0.99997818 0.99996877 0.99992049 0.99818283
 0.99998641 0.99832314 0.99980015 0.99952078]
pred: 0.9994440637528896, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp014-nsrr

=== Test on chp015-nsrr. train_data(1281), test_data(19) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.261260, loss_ss: 1.586075, loss_d: 0.675184
0.0781 --- loss: 2.014184, loss_ss: 1.606732, loss_d: 0.407452
0.1561 --- loss: 2.223791, loss_ss: 1.514877, loss_d: 0.708914
0.2342 --- loss: 2.102919, loss_ss: 1.570725, loss_d: 0.532193
0.3123 --- loss: 2.017973, loss_ss: 1.484323, loss_d: 0.533650
0.3903 --- loss: 2.337035, loss_ss: 1.430287, loss_d: 0.906748
0.4684 --- loss: 2.137533, loss_ss: 1.539353, loss_d: 0.598180
0.5464 --- loss: 2.476142, loss_ss: 1.479178, loss_d: 0.996964
0.6245 --- loss: 2.050814, loss_ss: 1.477594, loss_d: 0.573220
0.7026 --- loss: 2.145870, loss_ss: 1.298061, loss_d: 0.847809
0.7806 --- loss: 2.071616, loss_ss: 1.379973, loss_d: 0.691643
0.8587 --- loss: 2.087730, loss_ss: 1.427526, loss_d: 0.660204
0.9368 --- loss: 2.319142, loss_ss: 1.365177, loss_d: 0.953965
Epoch finished! Loss: 2.0791117269545794
Starting epoch 2/10.
0.0000 --- loss: 1.872036, loss_ss: 1.359975, loss_d: 0.512062
0.0781 --- loss: 1.692930, loss_ss: 1.236767, loss_d: 0.456163
0.1561 --- loss: 2.113348, loss_ss: 1.207953, loss_d: 0.905395
0.2342 --- loss: 1.752365, loss_ss: 1.140773, loss_d: 0.611591
0.3123 --- loss: 1.599730, loss_ss: 1.311555, loss_d: 0.288175
0.3903 --- loss: 1.725021, loss_ss: 1.259496, loss_d: 0.465525
0.4684 --- loss: 1.523540, loss_ss: 1.219146, loss_d: 0.304394
0.5464 --- loss: 1.964685, loss_ss: 1.337440, loss_d: 0.627246
0.6245 --- loss: 1.713720, loss_ss: 1.093414, loss_d: 0.620305
0.7026 --- loss: 1.909300, loss_ss: 1.331486, loss_d: 0.577814
0.7806 --- loss: 1.842759, loss_ss: 1.264375, loss_d: 0.578385
0.8587 --- loss: 1.673344, loss_ss: 1.261341, loss_d: 0.412003
0.9368 --- loss: 1.373574, loss_ss: 1.050983, loss_d: 0.322591
Epoch finished! Loss: 1.751730164512992
Starting epoch 3/10.
0.0000 --- loss: 1.305504, loss_ss: 1.055589, loss_d: 0.249916
0.0781 --- loss: 1.462233, loss_ss: 1.138263, loss_d: 0.323970
0.1561 --- loss: 1.948113, loss_ss: 1.234300, loss_d: 0.713813
0.2342 --- loss: 1.856321, loss_ss: 1.186649, loss_d: 0.669672
0.3123 --- loss: 1.231279, loss_ss: 0.970568, loss_d: 0.260711
0.3903 --- loss: 1.211322, loss_ss: 1.019515, loss_d: 0.191807
0.4684 --- loss: 1.473130, loss_ss: 0.987892, loss_d: 0.485237
0.5464 --- loss: 1.481541, loss_ss: 1.065977, loss_d: 0.415564
0.6245 --- loss: 1.430264, loss_ss: 1.065477, loss_d: 0.364786
0.7026 --- loss: 1.436415, loss_ss: 1.229745, loss_d: 0.206670
0.7806 --- loss: 1.233134, loss_ss: 0.909078, loss_d: 0.324056
0.8587 --- loss: 1.522242, loss_ss: 1.169552, loss_d: 0.352690
0.9368 --- loss: 1.725821, loss_ss: 1.194883, loss_d: 0.530938
Epoch finished! Loss: 1.4678768115118146
Starting epoch 4/10.
0.0000 --- loss: 1.291719, loss_ss: 0.952735, loss_d: 0.338984
0.0781 --- loss: 1.149508, loss_ss: 0.928198, loss_d: 0.221310
0.1561 --- loss: 1.459513, loss_ss: 1.089175, loss_d: 0.370338
0.2342 --- loss: 1.164980, loss_ss: 0.893717, loss_d: 0.271263
0.3123 --- loss: 1.271348, loss_ss: 1.061823, loss_d: 0.209525
0.3903 --- loss: 0.988126, loss_ss: 0.860047, loss_d: 0.128079
0.4684 --- loss: 1.249799, loss_ss: 1.041992, loss_d: 0.207807
0.5464 --- loss: 1.122386, loss_ss: 1.053110, loss_d: 0.069276
0.6245 --- loss: 1.163866, loss_ss: 0.955868, loss_d: 0.207997
0.7026 --- loss: 1.400314, loss_ss: 1.286370, loss_d: 0.113944
0.7806 --- loss: 1.132076, loss_ss: 1.010297, loss_d: 0.121779
0.8587 --- loss: 1.173753, loss_ss: 1.012293, loss_d: 0.161459
0.9368 --- loss: 1.243100, loss_ss: 0.941509, loss_d: 0.301590
Epoch finished! Loss: 1.2822829373180866
Starting epoch 5/10.
0.0000 --- loss: 1.259514, loss_ss: 1.150357, loss_d: 0.109157
0.0781 --- loss: 1.234070, loss_ss: 0.860762, loss_d: 0.373308
0.1561 --- loss: 0.911969, loss_ss: 0.844843, loss_d: 0.067126
0.2342 --- loss: 1.289946, loss_ss: 1.171488, loss_d: 0.118458
0.3123 --- loss: 1.071344, loss_ss: 0.890251, loss_d: 0.181094
0.3903 --- loss: 0.947898, loss_ss: 0.808175, loss_d: 0.139723
0.4684 --- loss: 1.525044, loss_ss: 1.341559, loss_d: 0.183486
0.5464 --- loss: 1.350205, loss_ss: 1.088585, loss_d: 0.261620
0.6245 --- loss: 1.043501, loss_ss: 0.864532, loss_d: 0.178969
0.7026 --- loss: 0.909876, loss_ss: 0.850083, loss_d: 0.059793
0.7806 --- loss: 0.982402, loss_ss: 0.825812, loss_d: 0.156590
0.8587 --- loss: 1.142277, loss_ss: 1.028232, loss_d: 0.114044
0.9368 --- loss: 0.763468, loss_ss: 0.748434, loss_d: 0.015034
Epoch finished! Loss: 1.1432614303193986
Starting epoch 6/10.
0.0000 --- loss: 0.897536, loss_ss: 0.778996, loss_d: 0.118540
0.0781 --- loss: 0.850928, loss_ss: 0.820609, loss_d: 0.030319
0.1561 --- loss: 0.971453, loss_ss: 0.916043, loss_d: 0.055410
0.2342 --- loss: 0.891890, loss_ss: 0.798124, loss_d: 0.093765
0.3123 --- loss: 0.938584, loss_ss: 0.880327, loss_d: 0.058258
0.3903 --- loss: 0.704025, loss_ss: 0.656915, loss_d: 0.047110
0.4684 --- loss: 0.833298, loss_ss: 0.749345, loss_d: 0.083953
0.5464 --- loss: 1.481809, loss_ss: 1.399446, loss_d: 0.082363
0.6245 --- loss: 0.919486, loss_ss: 0.863961, loss_d: 0.055525
0.7026 --- loss: 1.321462, loss_ss: 1.264233, loss_d: 0.057229
0.7806 --- loss: 0.905931, loss_ss: 0.819715, loss_d: 0.086216
0.8587 --- loss: 1.181909, loss_ss: 0.975054, loss_d: 0.206854
0.9368 --- loss: 0.939177, loss_ss: 0.912917, loss_d: 0.026259
Epoch finished! Loss: 1.1381248361431062
Starting epoch 7/10.
0.0000 --- loss: 0.985667, loss_ss: 0.914456, loss_d: 0.071211
0.0781 --- loss: 1.031557, loss_ss: 0.837908, loss_d: 0.193649
0.1561 --- loss: 1.122059, loss_ss: 0.932160, loss_d: 0.189899
0.2342 --- loss: 0.829192, loss_ss: 0.713776, loss_d: 0.115416
0.3123 --- loss: 1.094270, loss_ss: 0.998098, loss_d: 0.096172
0.3903 --- loss: 1.217607, loss_ss: 0.891609, loss_d: 0.325998
0.4684 --- loss: 0.902170, loss_ss: 0.847323, loss_d: 0.054848
0.5464 --- loss: 0.907267, loss_ss: 0.888484, loss_d: 0.018783
0.6245 --- loss: 1.132881, loss_ss: 1.052833, loss_d: 0.080048
0.7026 --- loss: 0.899107, loss_ss: 0.803186, loss_d: 0.095921
0.7806 --- loss: 0.879090, loss_ss: 0.844355, loss_d: 0.034735
0.8587 --- loss: 0.986625, loss_ss: 0.909596, loss_d: 0.077029
0.9368 --- loss: 1.406190, loss_ss: 1.322149, loss_d: 0.084040
Epoch finished! Loss: 1.104244960937649
Starting epoch 8/10.
0.0000 --- loss: 0.847644, loss_ss: 0.759209, loss_d: 0.088435
0.0781 --- loss: 1.224027, loss_ss: 0.955012, loss_d: 0.269015
0.1561 --- loss: 1.332842, loss_ss: 1.168233, loss_d: 0.164609
0.2342 --- loss: 0.885928, loss_ss: 0.855838, loss_d: 0.030091
0.3123 --- loss: 1.245971, loss_ss: 1.042498, loss_d: 0.203473
0.3903 --- loss: 0.956827, loss_ss: 0.911573, loss_d: 0.045254
0.4684 --- loss: 1.098560, loss_ss: 1.038839, loss_d: 0.059722
0.5464 --- loss: 1.721508, loss_ss: 0.787442, loss_d: 0.934066
0.6245 --- loss: 1.296903, loss_ss: 0.829391, loss_d: 0.467512
0.7026 --- loss: 0.935686, loss_ss: 0.906209, loss_d: 0.029477
0.7806 --- loss: 0.992921, loss_ss: 0.871180, loss_d: 0.121742
0.8587 --- loss: 1.166751, loss_ss: 1.068348, loss_d: 0.098403
0.9368 --- loss: 1.227944, loss_ss: 0.804254, loss_d: 0.423691
Epoch finished! Loss: 1.0503531889989972
Starting epoch 9/10.
0.0000 --- loss: 0.865036, loss_ss: 0.798147, loss_d: 0.066889
0.0781 --- loss: 0.788045, loss_ss: 0.778455, loss_d: 0.009590
0.1561 --- loss: 1.062444, loss_ss: 0.779198, loss_d: 0.283246
0.2342 --- loss: 1.411627, loss_ss: 1.275150, loss_d: 0.136477
0.3123 --- loss: 0.838888, loss_ss: 0.829381, loss_d: 0.009508
0.3903 --- loss: 0.850636, loss_ss: 0.838364, loss_d: 0.012272
0.4684 --- loss: 0.937486, loss_ss: 0.914835, loss_d: 0.022651
0.5464 --- loss: 0.961197, loss_ss: 0.720872, loss_d: 0.240325
0.6245 --- loss: 0.914437, loss_ss: 0.883984, loss_d: 0.030453
0.7026 --- loss: 1.062928, loss_ss: 1.047343, loss_d: 0.015585
0.7806 --- loss: 0.843035, loss_ss: 0.803746, loss_d: 0.039290
0.8587 --- loss: 0.850771, loss_ss: 0.845365, loss_d: 0.005406
0.9368 --- loss: 0.859058, loss_ss: 0.836840, loss_d: 0.022218
Epoch finished! Loss: 0.9576618010178208
Starting epoch 10/10.
0.0000 --- loss: 1.084784, loss_ss: 1.081869, loss_d: 0.002915
0.0781 --- loss: 0.765222, loss_ss: 0.762362, loss_d: 0.002861
0.1561 --- loss: 0.801024, loss_ss: 0.797605, loss_d: 0.003419
0.2342 --- loss: 0.840108, loss_ss: 0.808646, loss_d: 0.031462
0.3123 --- loss: 0.680183, loss_ss: 0.637135, loss_d: 0.043048
0.3903 --- loss: 0.725012, loss_ss: 0.712310, loss_d: 0.012702
0.4684 --- loss: 0.810552, loss_ss: 0.800858, loss_d: 0.009694
0.5464 --- loss: 1.122545, loss_ss: 0.877503, loss_d: 0.245042
0.6245 --- loss: 1.306591, loss_ss: 1.164647, loss_d: 0.141944
0.7026 --- loss: 0.831441, loss_ss: 0.825396, loss_d: 0.006045
0.7806 --- loss: 0.784035, loss_ss: 0.769635, loss_d: 0.014400
0.8587 --- loss: 1.014188, loss_ss: 1.013091, loss_d: 0.001097
0.9368 --- loss: 0.630965, loss_ss: 0.627460, loss_d: 0.003506
Epoch finished! Loss: 0.9186284681782126
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.612280701754386
             precision    recall  f1-score   support

        0.0       0.23      0.94      0.37        67
        1.0       0.00      0.00      0.00       281
        2.0       0.67      0.89      0.76       335
        3.0       1.00      0.69      0.82       264
        4.0       0.66      0.80      0.72       193

avg / total       0.55      0.61      0.56      1140
 


====== chp015-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  81.14  94.03   80.34   22.99     36.95
1  75.26   0.00   99.88    0.00      0.00
2  83.60  88.96   81.37   66.52     76.12
3  92.89  69.32  100.00  100.00     81.88
4  89.56  79.79   91.55   65.81     72.13
Total accuracy: 61.23%
Average sen: 66.42%
Average spec: 90.63%
Macro f1-score: 53.42%
Diagnosis acc on 30mins: 0.9473684210526315
[0.99785346 0.9976967  0.99193841 0.99279046 0.99103206 0.99954933
 0.80866319 0.78949839 0.99994504 0.99988115 0.99554139 0.9998498
 0.99986303 0.21874216 0.98087436 0.98346555 0.90526956 0.99981481
 0.99992359]
pred: 0.9290627601899599, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp015-nsrr

=== Test on chp016-nsrr. train_data(1279), test_data(21) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.349932, loss_ss: 1.704950, loss_d: 0.644982
0.0782 --- loss: 2.482105, loss_ss: 1.647969, loss_d: 0.834136
0.1564 --- loss: 1.910031, loss_ss: 1.539364, loss_d: 0.370667
0.2346 --- loss: 2.044443, loss_ss: 1.468551, loss_d: 0.575892
0.3127 --- loss: 2.020484, loss_ss: 1.437364, loss_d: 0.583120
0.3909 --- loss: 1.921841, loss_ss: 1.401308, loss_d: 0.520533
0.4691 --- loss: 1.740801, loss_ss: 1.328743, loss_d: 0.412058
0.5473 --- loss: 1.950430, loss_ss: 1.303760, loss_d: 0.646669
0.6255 --- loss: 1.805124, loss_ss: 1.330999, loss_d: 0.474124
0.7037 --- loss: 2.093021, loss_ss: 1.282174, loss_d: 0.810847
0.7819 --- loss: 1.747128, loss_ss: 1.268131, loss_d: 0.478997
0.8600 --- loss: 1.961273, loss_ss: 1.286494, loss_d: 0.674779
0.9382 --- loss: 1.763366, loss_ss: 1.287489, loss_d: 0.475878
Epoch finished! Loss: 2.0116314700269324
Starting epoch 2/10.
0.0000 --- loss: 1.526383, loss_ss: 1.285484, loss_d: 0.240900
0.0782 --- loss: 1.786800, loss_ss: 1.170616, loss_d: 0.616184
0.1564 --- loss: 1.763247, loss_ss: 1.212057, loss_d: 0.551190
0.2346 --- loss: 1.827857, loss_ss: 1.291357, loss_d: 0.536500
0.3127 --- loss: 1.661600, loss_ss: 1.189679, loss_d: 0.471921
0.3909 --- loss: 1.538730, loss_ss: 1.196691, loss_d: 0.342039
0.4691 --- loss: 1.358486, loss_ss: 1.045475, loss_d: 0.313011
0.5473 --- loss: 1.759387, loss_ss: 1.118122, loss_d: 0.641265
0.6255 --- loss: 1.588342, loss_ss: 1.191649, loss_d: 0.396693
0.7037 --- loss: 1.509758, loss_ss: 1.170806, loss_d: 0.338952
0.7819 --- loss: 1.258482, loss_ss: 1.031529, loss_d: 0.226953
0.8600 --- loss: 1.553818, loss_ss: 1.064412, loss_d: 0.489405
0.9382 --- loss: 1.587263, loss_ss: 1.294550, loss_d: 0.292713
Epoch finished! Loss: 1.6466871725292656
Starting epoch 3/10.
0.0000 --- loss: 1.353792, loss_ss: 1.088435, loss_d: 0.265357
0.0782 --- loss: 1.178496, loss_ss: 1.021101, loss_d: 0.157395
0.1564 --- loss: 1.336072, loss_ss: 1.232202, loss_d: 0.103870
0.2346 --- loss: 1.535960, loss_ss: 1.175146, loss_d: 0.360814
0.3127 --- loss: 1.125094, loss_ss: 0.926177, loss_d: 0.198917
0.3909 --- loss: 1.187497, loss_ss: 1.048130, loss_d: 0.139367
0.4691 --- loss: 1.325620, loss_ss: 1.069960, loss_d: 0.255660
0.5473 --- loss: 1.253839, loss_ss: 0.971247, loss_d: 0.282591
0.6255 --- loss: 1.301803, loss_ss: 1.043533, loss_d: 0.258270
0.7037 --- loss: 1.500421, loss_ss: 1.067205, loss_d: 0.433216
0.7819 --- loss: 1.100627, loss_ss: 0.983316, loss_d: 0.117311
0.8600 --- loss: 1.218077, loss_ss: 1.193141, loss_d: 0.024936
0.9382 --- loss: 0.913448, loss_ss: 0.858307, loss_d: 0.055141
Epoch finished! Loss: 1.34412314619605
Starting epoch 4/10.
0.0000 --- loss: 1.271924, loss_ss: 1.053001, loss_d: 0.218924
0.0782 --- loss: 1.319106, loss_ss: 1.063683, loss_d: 0.255423
0.1564 --- loss: 1.121719, loss_ss: 0.987308, loss_d: 0.134411
0.2346 --- loss: 1.421195, loss_ss: 0.813994, loss_d: 0.607201
0.3127 --- loss: 1.140917, loss_ss: 0.911445, loss_d: 0.229472
0.3909 --- loss: 1.021352, loss_ss: 0.888473, loss_d: 0.132879
0.4691 --- loss: 1.277122, loss_ss: 0.821449, loss_d: 0.455673
0.5473 --- loss: 1.123115, loss_ss: 0.945198, loss_d: 0.177917
0.6255 --- loss: 1.143987, loss_ss: 1.005305, loss_d: 0.138682
0.7037 --- loss: 1.061923, loss_ss: 0.769650, loss_d: 0.292274
0.7819 --- loss: 1.440799, loss_ss: 0.891824, loss_d: 0.548976
0.8600 --- loss: 1.204175, loss_ss: 0.998100, loss_d: 0.206075
0.9382 --- loss: 0.909764, loss_ss: 0.866410, loss_d: 0.043353
Epoch finished! Loss: 1.2381418957484989
Starting epoch 5/10.
0.0000 --- loss: 0.843165, loss_ss: 0.813704, loss_d: 0.029461
0.0782 --- loss: 1.074347, loss_ss: 1.028052, loss_d: 0.046295
0.1564 --- loss: 1.224141, loss_ss: 0.926068, loss_d: 0.298073
0.2346 --- loss: 1.501805, loss_ss: 1.403080, loss_d: 0.098725
0.3127 --- loss: 0.877850, loss_ss: 0.836700, loss_d: 0.041150
0.3909 --- loss: 1.373256, loss_ss: 1.075707, loss_d: 0.297549
0.4691 --- loss: 1.450424, loss_ss: 1.411927, loss_d: 0.038498
0.5473 --- loss: 1.302071, loss_ss: 0.995183, loss_d: 0.306888
0.6255 --- loss: 1.252800, loss_ss: 0.891158, loss_d: 0.361641
0.7037 --- loss: 1.007274, loss_ss: 0.726120, loss_d: 0.281154
0.7819 --- loss: 1.283734, loss_ss: 1.009182, loss_d: 0.274552
0.8600 --- loss: 1.264938, loss_ss: 1.103246, loss_d: 0.161692
0.9382 --- loss: 1.001635, loss_ss: 0.876350, loss_d: 0.125285
Epoch finished! Loss: 1.1205560015881155
Starting epoch 6/10.
0.0000 --- loss: 0.899799, loss_ss: 0.747155, loss_d: 0.152644
0.0782 --- loss: 1.380663, loss_ss: 1.327590, loss_d: 0.053073
0.1564 --- loss: 1.468636, loss_ss: 1.163548, loss_d: 0.305087
0.2346 --- loss: 0.984625, loss_ss: 0.905811, loss_d: 0.078814
0.3127 --- loss: 0.891913, loss_ss: 0.854701, loss_d: 0.037211
0.3909 --- loss: 1.031713, loss_ss: 0.930979, loss_d: 0.100734
0.4691 --- loss: 1.076809, loss_ss: 1.068916, loss_d: 0.007893
0.5473 --- loss: 1.025547, loss_ss: 0.959892, loss_d: 0.065655
0.6255 --- loss: 1.118818, loss_ss: 1.110431, loss_d: 0.008387
0.7037 --- loss: 0.695456, loss_ss: 0.685558, loss_d: 0.009897
0.7819 --- loss: 0.906110, loss_ss: 0.815358, loss_d: 0.090752
0.8600 --- loss: 0.921725, loss_ss: 0.907767, loss_d: 0.013958
0.9382 --- loss: 1.081471, loss_ss: 0.766004, loss_d: 0.315468
Epoch finished! Loss: 1.0692123047948823
Starting epoch 7/10.
0.0000 --- loss: 0.784810, loss_ss: 0.764782, loss_d: 0.020027
0.0782 --- loss: 1.119699, loss_ss: 0.693101, loss_d: 0.426599
0.1564 --- loss: 0.773994, loss_ss: 0.743069, loss_d: 0.030924
0.2346 --- loss: 1.228444, loss_ss: 1.093829, loss_d: 0.134616
0.3127 --- loss: 0.880174, loss_ss: 0.855581, loss_d: 0.024593
0.3909 --- loss: 1.257684, loss_ss: 1.063783, loss_d: 0.193901
0.4691 --- loss: 0.900536, loss_ss: 0.875419, loss_d: 0.025116
0.5473 --- loss: 0.771087, loss_ss: 0.647847, loss_d: 0.123240
0.6255 --- loss: 1.013306, loss_ss: 1.008574, loss_d: 0.004732
0.7037 --- loss: 1.134632, loss_ss: 1.029688, loss_d: 0.104945
0.7819 --- loss: 0.885417, loss_ss: 0.880466, loss_d: 0.004951
0.8600 --- loss: 1.068793, loss_ss: 0.877542, loss_d: 0.191250
0.9382 --- loss: 1.443947, loss_ss: 0.981446, loss_d: 0.462501
Epoch finished! Loss: 0.9996945468459543
Starting epoch 8/10.
0.0000 --- loss: 0.829223, loss_ss: 0.817286, loss_d: 0.011937
0.0782 --- loss: 1.068175, loss_ss: 0.917376, loss_d: 0.150800
0.1564 --- loss: 1.094286, loss_ss: 1.080754, loss_d: 0.013532
0.2346 --- loss: 0.908655, loss_ss: 0.902441, loss_d: 0.006213
0.3127 --- loss: 1.363781, loss_ss: 1.347167, loss_d: 0.016614
0.3909 --- loss: 1.029072, loss_ss: 0.940034, loss_d: 0.089038
0.4691 --- loss: 1.114531, loss_ss: 1.103098, loss_d: 0.011433
0.5473 --- loss: 0.906574, loss_ss: 0.904382, loss_d: 0.002192
0.6255 --- loss: 1.153623, loss_ss: 0.786388, loss_d: 0.367234
0.7037 --- loss: 0.741565, loss_ss: 0.710963, loss_d: 0.030602
0.7819 --- loss: 0.973704, loss_ss: 0.844023, loss_d: 0.129681
0.8600 --- loss: 1.129915, loss_ss: 1.070768, loss_d: 0.059146
0.9382 --- loss: 0.851447, loss_ss: 0.748757, loss_d: 0.102691
Epoch finished! Loss: 0.9807260041161785
Starting epoch 9/10.
0.0000 --- loss: 1.027718, loss_ss: 1.005844, loss_d: 0.021874
0.0782 --- loss: 0.908887, loss_ss: 0.904042, loss_d: 0.004844
0.1564 --- loss: 0.796019, loss_ss: 0.785838, loss_d: 0.010181
0.2346 --- loss: 1.085779, loss_ss: 0.895660, loss_d: 0.190119
0.3127 --- loss: 0.940849, loss_ss: 0.933040, loss_d: 0.007809
0.3909 --- loss: 1.008027, loss_ss: 0.988278, loss_d: 0.019749
0.4691 --- loss: 0.868339, loss_ss: 0.778861, loss_d: 0.089479
0.5473 --- loss: 0.837568, loss_ss: 0.804379, loss_d: 0.033188
0.6255 --- loss: 1.190229, loss_ss: 0.862297, loss_d: 0.327931
0.7037 --- loss: 0.892646, loss_ss: 0.613717, loss_d: 0.278929
0.7819 --- loss: 0.697913, loss_ss: 0.692792, loss_d: 0.005121
0.8600 --- loss: 0.875429, loss_ss: 0.847544, loss_d: 0.027885
0.9382 --- loss: 1.010731, loss_ss: 1.006285, loss_d: 0.004446
Epoch finished! Loss: 0.9627577615535166
Starting epoch 10/10.
0.0000 --- loss: 0.808385, loss_ss: 0.770339, loss_d: 0.038046
0.0782 --- loss: 0.951100, loss_ss: 0.935415, loss_d: 0.015686
0.1564 --- loss: 0.933663, loss_ss: 0.931724, loss_d: 0.001938
0.2346 --- loss: 0.832103, loss_ss: 0.831345, loss_d: 0.000757
0.3127 --- loss: 0.779352, loss_ss: 0.734116, loss_d: 0.045236
0.3909 --- loss: 0.884250, loss_ss: 0.879201, loss_d: 0.005049
0.4691 --- loss: 0.835770, loss_ss: 0.806091, loss_d: 0.029679
0.5473 --- loss: 0.889598, loss_ss: 0.813533, loss_d: 0.076065
0.6255 --- loss: 0.722970, loss_ss: 0.716463, loss_d: 0.006506
0.7037 --- loss: 1.403530, loss_ss: 1.368920, loss_d: 0.034610
0.7819 --- loss: 0.794466, loss_ss: 0.772649, loss_d: 0.021818
0.8600 --- loss: 0.703266, loss_ss: 0.686787, loss_d: 0.016479
0.9382 --- loss: 0.843001, loss_ss: 0.839429, loss_d: 0.003572
Epoch finished! Loss: 0.9251809284442992
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7746031746031746
             precision    recall  f1-score   support

        0.0       0.84      0.97      0.90       297
        1.0       0.83      0.24      0.37       289
        2.0       0.70      0.92      0.80       330
        3.0       0.85      0.97      0.91       133
        4.0       0.75      0.89      0.81       211

avg / total       0.79      0.77      0.74      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.08  97.31   94.39  84.26     90.31
1  81.35  23.53   98.56  82.93     36.66
2  87.62  91.82   86.13  70.14     79.53
3  97.86  96.99   97.96  84.87     90.53
4  93.02  88.63   93.90  74.50     80.95
Total accuracy: 77.46%
Average sen: 79.65%
Average spec: 94.19%
Macro f1-score: 75.60%
Diagnosis acc on 30mins: 1.0
[0.99999022 0.82954508 0.99652427 0.99999928 0.99999213 0.99999118
 0.99999249 0.99998879 0.93298179 0.99997115 0.99999976 0.99999976
 0.99998057 0.99999285 0.9999963  0.99998081 0.99995935 0.99999881
 0.99999797 0.99998891 0.99999988]
pred: 0.9885176845959255, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp016-nsrr

=== Test on chp017-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.409495, loss_ss: 1.749589, loss_d: 0.659906
0.0779 --- loss: 2.198627, loss_ss: 1.531293, loss_d: 0.667333
0.1558 --- loss: 1.955660, loss_ss: 1.518841, loss_d: 0.436819
0.2336 --- loss: 2.012286, loss_ss: 1.499319, loss_d: 0.512967
0.3115 --- loss: 1.848647, loss_ss: 1.379039, loss_d: 0.469608
0.3894 --- loss: 1.866916, loss_ss: 1.378021, loss_d: 0.488895
0.4673 --- loss: 1.835840, loss_ss: 1.402229, loss_d: 0.433611
0.5452 --- loss: 2.096019, loss_ss: 1.347159, loss_d: 0.748860
0.6231 --- loss: 2.108508, loss_ss: 1.290789, loss_d: 0.817719
0.7009 --- loss: 1.768653, loss_ss: 1.233496, loss_d: 0.535157
0.7788 --- loss: 1.926518, loss_ss: 1.235372, loss_d: 0.691146
0.8567 --- loss: 1.848764, loss_ss: 1.325778, loss_d: 0.522986
0.9346 --- loss: 1.764304, loss_ss: 1.137271, loss_d: 0.627034
Epoch finished! Loss: 1.9823386305943131
Starting epoch 2/10.
0.0000 --- loss: 1.571803, loss_ss: 1.180301, loss_d: 0.391502
0.0779 --- loss: 1.842465, loss_ss: 1.436429, loss_d: 0.406036
0.1558 --- loss: 1.530981, loss_ss: 1.150759, loss_d: 0.380223
0.2336 --- loss: 1.791962, loss_ss: 1.133982, loss_d: 0.657981
0.3115 --- loss: 1.477087, loss_ss: 1.174610, loss_d: 0.302477
0.3894 --- loss: 1.408828, loss_ss: 1.183554, loss_d: 0.225274
0.4673 --- loss: 1.699992, loss_ss: 1.104275, loss_d: 0.595717
0.5452 --- loss: 1.471115, loss_ss: 1.089481, loss_d: 0.381635
0.6231 --- loss: 1.490752, loss_ss: 1.098231, loss_d: 0.392521
0.7009 --- loss: 1.788321, loss_ss: 1.069902, loss_d: 0.718419
0.7788 --- loss: 1.502593, loss_ss: 1.153903, loss_d: 0.348690
0.8567 --- loss: 1.457549, loss_ss: 1.066791, loss_d: 0.390759
0.9346 --- loss: 1.567037, loss_ss: 1.187101, loss_d: 0.379936
Epoch finished! Loss: 1.6235645050182939
Starting epoch 3/10.
0.0000 --- loss: 1.536246, loss_ss: 1.229867, loss_d: 0.306379
0.0779 --- loss: 1.239375, loss_ss: 1.098054, loss_d: 0.141321
0.1558 --- loss: 1.323857, loss_ss: 1.034265, loss_d: 0.289592
0.2336 --- loss: 1.495550, loss_ss: 1.060609, loss_d: 0.434941
0.3115 --- loss: 1.976789, loss_ss: 1.188268, loss_d: 0.788521
0.3894 --- loss: 1.186661, loss_ss: 1.056838, loss_d: 0.129823
0.4673 --- loss: 1.198716, loss_ss: 1.007405, loss_d: 0.191311
0.5452 --- loss: 1.284558, loss_ss: 0.959597, loss_d: 0.324961
0.6231 --- loss: 1.222885, loss_ss: 1.054273, loss_d: 0.168612
0.7009 --- loss: 1.264458, loss_ss: 0.980476, loss_d: 0.283982
0.7788 --- loss: 1.172401, loss_ss: 0.970490, loss_d: 0.201911
0.8567 --- loss: 1.136636, loss_ss: 0.928816, loss_d: 0.207820
0.9346 --- loss: 1.547886, loss_ss: 1.196762, loss_d: 0.351124
Epoch finished! Loss: 1.3920278372243047
Starting epoch 4/10.
0.0000 --- loss: 1.233892, loss_ss: 1.058255, loss_d: 0.175637
0.0779 --- loss: 1.078421, loss_ss: 1.015113, loss_d: 0.063308
0.1558 --- loss: 1.170301, loss_ss: 0.876396, loss_d: 0.293904
0.2336 --- loss: 1.298640, loss_ss: 1.172472, loss_d: 0.126169
0.3115 --- loss: 1.086206, loss_ss: 0.883245, loss_d: 0.202961
0.3894 --- loss: 1.012023, loss_ss: 0.948190, loss_d: 0.063833
0.4673 --- loss: 0.988147, loss_ss: 0.943924, loss_d: 0.044223
0.5452 --- loss: 1.020698, loss_ss: 0.913926, loss_d: 0.106772
0.6231 --- loss: 1.121094, loss_ss: 0.876540, loss_d: 0.244554
0.7009 --- loss: 1.509255, loss_ss: 0.925372, loss_d: 0.583883
0.7788 --- loss: 1.092890, loss_ss: 0.965893, loss_d: 0.126997
0.8567 --- loss: 1.078688, loss_ss: 0.802309, loss_d: 0.276379
0.9346 --- loss: 1.339952, loss_ss: 1.229084, loss_d: 0.110869
Epoch finished! Loss: 1.282137593254447
Starting epoch 5/10.
0.0000 --- loss: 1.311607, loss_ss: 0.901549, loss_d: 0.410058
0.0779 --- loss: 1.032896, loss_ss: 0.897082, loss_d: 0.135814
0.1558 --- loss: 1.104259, loss_ss: 1.022986, loss_d: 0.081274
0.2336 --- loss: 1.243127, loss_ss: 1.120265, loss_d: 0.122862
0.3115 --- loss: 1.368833, loss_ss: 1.345509, loss_d: 0.023324
0.3894 --- loss: 1.179257, loss_ss: 0.911663, loss_d: 0.267594
0.4673 --- loss: 0.910239, loss_ss: 0.861587, loss_d: 0.048652
0.5452 --- loss: 1.823093, loss_ss: 1.267158, loss_d: 0.555935
0.6231 --- loss: 0.899042, loss_ss: 0.865404, loss_d: 0.033638
0.7009 --- loss: 1.065108, loss_ss: 0.999776, loss_d: 0.065333
0.7788 --- loss: 1.019164, loss_ss: 0.950511, loss_d: 0.068653
0.8567 --- loss: 1.161072, loss_ss: 0.868029, loss_d: 0.293043
0.9346 --- loss: 1.323335, loss_ss: 1.218622, loss_d: 0.104713
Epoch finished! Loss: 1.1669838782399893
Starting epoch 6/10.
0.0000 --- loss: 0.944908, loss_ss: 0.911709, loss_d: 0.033199
0.0779 --- loss: 0.822433, loss_ss: 0.744917, loss_d: 0.077515
0.1558 --- loss: 0.947523, loss_ss: 0.821264, loss_d: 0.126259
0.2336 --- loss: 0.888207, loss_ss: 0.857530, loss_d: 0.030677
0.3115 --- loss: 1.450696, loss_ss: 0.859914, loss_d: 0.590782
0.3894 --- loss: 1.028898, loss_ss: 0.919628, loss_d: 0.109269
0.4673 --- loss: 1.441912, loss_ss: 0.847593, loss_d: 0.594319
0.5452 --- loss: 1.657662, loss_ss: 1.241971, loss_d: 0.415691
0.6231 --- loss: 0.988607, loss_ss: 0.972523, loss_d: 0.016084
0.7009 --- loss: 1.021668, loss_ss: 0.885699, loss_d: 0.135969
0.7788 --- loss: 0.805469, loss_ss: 0.780591, loss_d: 0.024878
0.8567 --- loss: 0.844681, loss_ss: 0.795218, loss_d: 0.049464
0.9346 --- loss: 0.948638, loss_ss: 0.860934, loss_d: 0.087704
Epoch finished! Loss: 1.1078819604590535
Starting epoch 7/10.
0.0000 --- loss: 0.967026, loss_ss: 0.916881, loss_d: 0.050145
0.0779 --- loss: 1.059611, loss_ss: 0.918657, loss_d: 0.140955
0.1558 --- loss: 0.840274, loss_ss: 0.803341, loss_d: 0.036932
0.2336 --- loss: 0.858007, loss_ss: 0.820328, loss_d: 0.037679
0.3115 --- loss: 1.191144, loss_ss: 1.147202, loss_d: 0.043942
0.3894 --- loss: 0.952095, loss_ss: 0.878361, loss_d: 0.073734
0.4673 --- loss: 0.871582, loss_ss: 0.846668, loss_d: 0.024914
0.5452 --- loss: 0.916234, loss_ss: 0.847538, loss_d: 0.068696
0.6231 --- loss: 0.775930, loss_ss: 0.759513, loss_d: 0.016417
0.7009 --- loss: 0.840336, loss_ss: 0.824094, loss_d: 0.016242
0.7788 --- loss: 0.958066, loss_ss: 0.871837, loss_d: 0.086229
0.8567 --- loss: 1.032489, loss_ss: 0.957603, loss_d: 0.074887
0.9346 --- loss: 0.874226, loss_ss: 0.819323, loss_d: 0.054903
Epoch finished! Loss: 1.0454859398305416
Starting epoch 8/10.
0.0000 --- loss: 0.847235, loss_ss: 0.812170, loss_d: 0.035066
0.0779 --- loss: 0.874407, loss_ss: 0.850197, loss_d: 0.024209
0.1558 --- loss: 1.056481, loss_ss: 1.053387, loss_d: 0.003094
0.2336 --- loss: 0.884574, loss_ss: 0.868162, loss_d: 0.016412
0.3115 --- loss: 0.965209, loss_ss: 0.731656, loss_d: 0.233554
0.3894 --- loss: 1.121748, loss_ss: 1.033753, loss_d: 0.087995
0.4673 --- loss: 0.785422, loss_ss: 0.779979, loss_d: 0.005444
0.5452 --- loss: 0.841507, loss_ss: 0.827797, loss_d: 0.013710
0.6231 --- loss: 1.003644, loss_ss: 0.951070, loss_d: 0.052573
0.7009 --- loss: 1.033792, loss_ss: 0.881507, loss_d: 0.152285
0.7788 --- loss: 0.878291, loss_ss: 0.865666, loss_d: 0.012625
0.8567 --- loss: 1.094161, loss_ss: 1.036512, loss_d: 0.057649
0.9346 --- loss: 0.916662, loss_ss: 0.876447, loss_d: 0.040215
Epoch finished! Loss: 0.975501268170774
Starting epoch 9/10.
0.0000 --- loss: 0.981854, loss_ss: 0.979227, loss_d: 0.002627
0.0779 --- loss: 1.152339, loss_ss: 1.138695, loss_d: 0.013644
0.1558 --- loss: 1.301936, loss_ss: 1.038399, loss_d: 0.263537
0.2336 --- loss: 1.031639, loss_ss: 0.902892, loss_d: 0.128747
0.3115 --- loss: 1.139104, loss_ss: 1.126610, loss_d: 0.012495
0.3894 --- loss: 0.864120, loss_ss: 0.710898, loss_d: 0.153222
0.4673 --- loss: 0.960624, loss_ss: 0.937514, loss_d: 0.023110
0.5452 --- loss: 0.952499, loss_ss: 0.873241, loss_d: 0.079258
0.6231 --- loss: 0.824716, loss_ss: 0.770110, loss_d: 0.054607
0.7009 --- loss: 1.622005, loss_ss: 1.443959, loss_d: 0.178046
0.7788 --- loss: 0.903526, loss_ss: 0.901061, loss_d: 0.002465
0.8567 --- loss: 1.687849, loss_ss: 1.593044, loss_d: 0.094805
0.9346 --- loss: 0.853044, loss_ss: 0.804030, loss_d: 0.049014
Epoch finished! Loss: 0.9971277378499508
Starting epoch 10/10.
0.0000 --- loss: 1.016376, loss_ss: 1.002375, loss_d: 0.014001
0.0779 --- loss: 1.040367, loss_ss: 1.005074, loss_d: 0.035293
0.1558 --- loss: 0.941921, loss_ss: 0.940301, loss_d: 0.001619
0.2336 --- loss: 1.271063, loss_ss: 1.021479, loss_d: 0.249584
0.3115 --- loss: 0.817297, loss_ss: 0.813285, loss_d: 0.004011
0.3894 --- loss: 0.924098, loss_ss: 0.920937, loss_d: 0.003162
0.4673 --- loss: 0.943681, loss_ss: 0.904290, loss_d: 0.039391
0.5452 --- loss: 0.966123, loss_ss: 0.918040, loss_d: 0.048083
0.6231 --- loss: 1.023980, loss_ss: 0.989439, loss_d: 0.034540
0.7009 --- loss: 0.917796, loss_ss: 0.876774, loss_d: 0.041022
0.7788 --- loss: 0.715584, loss_ss: 0.713839, loss_d: 0.001745
0.8567 --- loss: 0.977099, loss_ss: 0.920756, loss_d: 0.056343
0.9346 --- loss: 0.760420, loss_ss: 0.759315, loss_d: 0.001105
Epoch finished! Loss: 0.9135218844749033
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5083333333333333
             precision    recall  f1-score   support

        0.0       0.68      0.91      0.78       237
        1.0       0.48      0.37      0.42       249
        2.0       0.35      0.28      0.31       210
        3.0       1.00      0.36      0.53       215
        4.0       0.21      0.88      0.34        49

avg / total       0.60      0.51      0.50       960
 


====== chp017-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.08  91.14   85.75   67.71     77.70
1  73.33  36.95   86.08   48.17     41.82
2  72.60  28.10   85.07   34.50     30.97
3  85.73  36.28  100.00  100.00     53.24
4  82.92  87.76   82.66   21.39     34.40
Total accuracy: 50.83%
Average sen: 56.04%
Average spec: 87.91%
Macro f1-score: 47.63%
Diagnosis acc on 30mins: 1.0
[0.99998522 0.99999976 0.9998005  0.99989581 0.99998951 0.99964929
 0.9999398  1.         0.99999976 0.99997818 0.99997389 0.98712778
 0.99998415 0.99987066 0.99964523 0.99991   ]
pred: 0.9991093464195728, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp017-nsrr

=== Test on chp018-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.218707, loss_ss: 1.586345, loss_d: 0.632362
0.0780 --- loss: 2.286424, loss_ss: 1.520742, loss_d: 0.765683
0.1560 --- loss: 2.132547, loss_ss: 1.406951, loss_d: 0.725596
0.2340 --- loss: 2.081304, loss_ss: 1.281840, loss_d: 0.799464
0.3120 --- loss: 1.595857, loss_ss: 1.238527, loss_d: 0.357330
0.3900 --- loss: 1.932690, loss_ss: 1.228434, loss_d: 0.704256
0.4680 --- loss: 2.077577, loss_ss: 1.215868, loss_d: 0.861709
0.5460 --- loss: 1.969212, loss_ss: 1.232032, loss_d: 0.737180
0.6240 --- loss: 1.719460, loss_ss: 1.389591, loss_d: 0.329870
0.7020 --- loss: 1.644072, loss_ss: 1.239603, loss_d: 0.404469
0.7800 --- loss: 1.803439, loss_ss: 1.462897, loss_d: 0.340542
0.8580 --- loss: 1.513280, loss_ss: 1.198478, loss_d: 0.314802
0.9360 --- loss: 1.745512, loss_ss: 1.185902, loss_d: 0.559610
Epoch finished! Loss: 1.9174701478332281
Starting epoch 2/10.
0.0000 --- loss: 1.661039, loss_ss: 1.176573, loss_d: 0.484467
0.0780 --- loss: 1.574980, loss_ss: 1.273540, loss_d: 0.301441
0.1560 --- loss: 1.884041, loss_ss: 1.252206, loss_d: 0.631834
0.2340 --- loss: 1.447619, loss_ss: 1.222409, loss_d: 0.225210
0.3120 --- loss: 1.525139, loss_ss: 1.261010, loss_d: 0.264130
0.3900 --- loss: 1.627801, loss_ss: 1.119372, loss_d: 0.508429
0.4680 --- loss: 1.801389, loss_ss: 1.211152, loss_d: 0.590237
0.5460 --- loss: 1.410409, loss_ss: 1.114047, loss_d: 0.296362
0.6240 --- loss: 1.544479, loss_ss: 1.221740, loss_d: 0.322740
0.7020 --- loss: 1.669894, loss_ss: 1.139054, loss_d: 0.530840
0.7800 --- loss: 1.768495, loss_ss: 1.258848, loss_d: 0.509647
0.8580 --- loss: 1.318749, loss_ss: 1.109231, loss_d: 0.209519
0.9360 --- loss: 1.855047, loss_ss: 1.124965, loss_d: 0.730081
Epoch finished! Loss: 1.6316590197384357
Starting epoch 3/10.
0.0000 --- loss: 1.643680, loss_ss: 1.374741, loss_d: 0.268939
0.0780 --- loss: 1.423252, loss_ss: 1.232646, loss_d: 0.190606
0.1560 --- loss: 1.395432, loss_ss: 1.273616, loss_d: 0.121816
0.2340 --- loss: 1.356546, loss_ss: 1.198336, loss_d: 0.158210
0.3120 --- loss: 1.481908, loss_ss: 1.033497, loss_d: 0.448411
0.3900 --- loss: 1.489582, loss_ss: 1.365746, loss_d: 0.123836
0.4680 --- loss: 1.733364, loss_ss: 1.016961, loss_d: 0.716404
0.5460 --- loss: 1.093954, loss_ss: 0.974354, loss_d: 0.119600
0.6240 --- loss: 1.085939, loss_ss: 0.892349, loss_d: 0.193590
0.7020 --- loss: 1.289886, loss_ss: 1.088253, loss_d: 0.201633
0.7800 --- loss: 1.486667, loss_ss: 1.169654, loss_d: 0.317013
0.8580 --- loss: 1.167761, loss_ss: 0.957753, loss_d: 0.210008
0.9360 --- loss: 1.591470, loss_ss: 0.976418, loss_d: 0.615052
Epoch finished! Loss: 1.4195680795237422
Starting epoch 4/10.
0.0000 --- loss: 1.234193, loss_ss: 1.098056, loss_d: 0.136138
0.0780 --- loss: 1.293384, loss_ss: 1.074728, loss_d: 0.218656
0.1560 --- loss: 1.095534, loss_ss: 0.947043, loss_d: 0.148491
0.2340 --- loss: 1.392528, loss_ss: 1.098199, loss_d: 0.294329
0.3120 --- loss: 1.533062, loss_ss: 1.198140, loss_d: 0.334922
0.3900 --- loss: 1.017002, loss_ss: 0.994876, loss_d: 0.022126
0.4680 --- loss: 0.892752, loss_ss: 0.842045, loss_d: 0.050707
0.5460 --- loss: 1.037706, loss_ss: 0.951569, loss_d: 0.086136
0.6240 --- loss: 1.450073, loss_ss: 1.044300, loss_d: 0.405773
0.7020 --- loss: 1.164730, loss_ss: 1.132533, loss_d: 0.032196
0.7800 --- loss: 1.303143, loss_ss: 1.145970, loss_d: 0.157173
0.8580 --- loss: 1.448073, loss_ss: 0.908468, loss_d: 0.539605
0.9360 --- loss: 1.239171, loss_ss: 1.011873, loss_d: 0.227299
Epoch finished! Loss: 1.2522525610402226
Starting epoch 5/10.
0.0000 --- loss: 1.303497, loss_ss: 1.200777, loss_d: 0.102721
0.0780 --- loss: 0.928498, loss_ss: 0.865331, loss_d: 0.063167
0.1560 --- loss: 1.002929, loss_ss: 0.971126, loss_d: 0.031803
0.2340 --- loss: 1.078217, loss_ss: 1.012997, loss_d: 0.065221
0.3120 --- loss: 1.022785, loss_ss: 0.986284, loss_d: 0.036502
0.3900 --- loss: 0.821334, loss_ss: 0.795701, loss_d: 0.025632
0.4680 --- loss: 1.310296, loss_ss: 0.907816, loss_d: 0.402480
0.5460 --- loss: 1.037981, loss_ss: 0.930555, loss_d: 0.107426
0.6240 --- loss: 1.162022, loss_ss: 0.923671, loss_d: 0.238351
0.7020 --- loss: 1.167157, loss_ss: 1.159255, loss_d: 0.007902
0.7800 --- loss: 1.580051, loss_ss: 1.142281, loss_d: 0.437770
0.8580 --- loss: 0.909888, loss_ss: 0.892339, loss_d: 0.017549
0.9360 --- loss: 1.194357, loss_ss: 0.965973, loss_d: 0.228383
Epoch finished! Loss: 1.1583065683953464
Starting epoch 6/10.
0.0000 --- loss: 1.193446, loss_ss: 1.097912, loss_d: 0.095535
0.0780 --- loss: 1.029173, loss_ss: 0.924148, loss_d: 0.105026
0.1560 --- loss: 0.888149, loss_ss: 0.839316, loss_d: 0.048833
0.2340 --- loss: 1.051409, loss_ss: 0.972198, loss_d: 0.079211
0.3120 --- loss: 0.922530, loss_ss: 0.797685, loss_d: 0.124845
0.3900 --- loss: 0.846790, loss_ss: 0.818725, loss_d: 0.028065
0.4680 --- loss: 0.935544, loss_ss: 0.875830, loss_d: 0.059714
0.5460 --- loss: 1.738400, loss_ss: 0.935974, loss_d: 0.802426
0.6240 --- loss: 1.232784, loss_ss: 1.146939, loss_d: 0.085845
0.7020 --- loss: 1.125651, loss_ss: 0.881959, loss_d: 0.243692
0.7800 --- loss: 1.173975, loss_ss: 0.964838, loss_d: 0.209137
0.8580 --- loss: 1.020978, loss_ss: 0.989740, loss_d: 0.031238
0.9360 --- loss: 1.603895, loss_ss: 1.046925, loss_d: 0.556970
Epoch finished! Loss: 1.0942617147229612
Starting epoch 7/10.
0.0000 --- loss: 0.781539, loss_ss: 0.732413, loss_d: 0.049126
0.0780 --- loss: 0.938037, loss_ss: 0.929236, loss_d: 0.008801
0.1560 --- loss: 1.291581, loss_ss: 1.212821, loss_d: 0.078759
0.2340 --- loss: 1.311271, loss_ss: 0.980890, loss_d: 0.330381
0.3120 --- loss: 0.972637, loss_ss: 0.902700, loss_d: 0.069938
0.3900 --- loss: 1.086912, loss_ss: 0.994312, loss_d: 0.092600
0.4680 --- loss: 1.080345, loss_ss: 0.895999, loss_d: 0.184347
0.5460 --- loss: 1.217764, loss_ss: 1.019323, loss_d: 0.198440
0.6240 --- loss: 1.418914, loss_ss: 1.106475, loss_d: 0.312438
0.7020 --- loss: 1.022684, loss_ss: 0.882911, loss_d: 0.139773
0.7800 --- loss: 1.143465, loss_ss: 0.839419, loss_d: 0.304047
0.8580 --- loss: 0.852997, loss_ss: 0.814684, loss_d: 0.038313
0.9360 --- loss: 0.834398, loss_ss: 0.709885, loss_d: 0.124512
Epoch finished! Loss: 1.0881894025951624
Starting epoch 8/10.
0.0000 --- loss: 0.881907, loss_ss: 0.851953, loss_d: 0.029954
0.0780 --- loss: 0.870396, loss_ss: 0.848829, loss_d: 0.021567
0.1560 --- loss: 0.838269, loss_ss: 0.815628, loss_d: 0.022641
0.2340 --- loss: 0.969423, loss_ss: 0.954812, loss_d: 0.014611
0.3120 --- loss: 0.888303, loss_ss: 0.851588, loss_d: 0.036715
0.3900 --- loss: 0.880097, loss_ss: 0.849196, loss_d: 0.030901
0.4680 --- loss: 1.024814, loss_ss: 0.958987, loss_d: 0.065827
0.5460 --- loss: 0.921990, loss_ss: 0.881825, loss_d: 0.040165
0.6240 --- loss: 1.059886, loss_ss: 1.058098, loss_d: 0.001787
0.7020 --- loss: 0.975025, loss_ss: 0.908921, loss_d: 0.066104
0.7800 --- loss: 0.861260, loss_ss: 0.799732, loss_d: 0.061529
0.8580 --- loss: 1.403102, loss_ss: 0.828932, loss_d: 0.574170
0.9360 --- loss: 0.800924, loss_ss: 0.749884, loss_d: 0.051041
Epoch finished! Loss: 1.0567093645222485
Starting epoch 9/10.
0.0000 --- loss: 0.775308, loss_ss: 0.747536, loss_d: 0.027772
0.0780 --- loss: 0.849474, loss_ss: 0.843205, loss_d: 0.006269
0.1560 --- loss: 0.821576, loss_ss: 0.813299, loss_d: 0.008277
0.2340 --- loss: 0.832942, loss_ss: 0.802596, loss_d: 0.030346
0.3120 --- loss: 1.055884, loss_ss: 0.951998, loss_d: 0.103886
0.3900 --- loss: 0.799381, loss_ss: 0.767247, loss_d: 0.032134
0.4680 --- loss: 0.979757, loss_ss: 0.954588, loss_d: 0.025169
0.5460 --- loss: 0.879182, loss_ss: 0.831540, loss_d: 0.047642
0.6240 --- loss: 1.006718, loss_ss: 0.815920, loss_d: 0.190799
0.7020 --- loss: 0.741595, loss_ss: 0.735966, loss_d: 0.005630
0.7800 --- loss: 0.903066, loss_ss: 0.881198, loss_d: 0.021868
0.8580 --- loss: 0.789517, loss_ss: 0.782437, loss_d: 0.007081
0.9360 --- loss: 0.855385, loss_ss: 0.641111, loss_d: 0.214274
Epoch finished! Loss: 0.9466788368299603
Starting epoch 10/10.
0.0000 --- loss: 1.169694, loss_ss: 1.044165, loss_d: 0.125529
0.0780 --- loss: 1.077801, loss_ss: 1.059430, loss_d: 0.018371
0.1560 --- loss: 0.938911, loss_ss: 0.936918, loss_d: 0.001992
0.2340 --- loss: 0.809748, loss_ss: 0.799049, loss_d: 0.010699
0.3120 --- loss: 1.040992, loss_ss: 0.971106, loss_d: 0.069887
0.3900 --- loss: 0.891132, loss_ss: 0.868286, loss_d: 0.022846
0.4680 --- loss: 0.838698, loss_ss: 0.837094, loss_d: 0.001603
0.5460 --- loss: 1.393147, loss_ss: 0.926687, loss_d: 0.466460
0.6240 --- loss: 1.073860, loss_ss: 1.058663, loss_d: 0.015197
0.7020 --- loss: 0.779218, loss_ss: 0.777541, loss_d: 0.001677
0.7800 --- loss: 0.871504, loss_ss: 0.870084, loss_d: 0.001420
0.8580 --- loss: 1.060201, loss_ss: 0.903941, loss_d: 0.156260
0.9360 --- loss: 0.880410, loss_ss: 0.873236, loss_d: 0.007173
Epoch finished! Loss: 0.9346791817806661
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6444444444444445
             precision    recall  f1-score   support

        0.0       0.83      0.70      0.76       138
        1.0       0.22      0.11      0.15       117
        2.0       0.28      0.58      0.38       119
        3.0       1.00      0.63      0.77       363
        4.0       0.68      0.84      0.75       343

avg / total       0.71      0.64      0.65      1080
 


====== chp018-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.35  70.29   97.88   82.91     76.08
1  86.02  11.11   95.12   21.67     14.69
2  78.80  57.98   81.37   27.82     37.60
3  87.50  62.81  100.00  100.00     77.16
4  82.22  84.26   81.28   67.68     75.06
Total accuracy: 64.44%
Average sen: 57.29%
Average spec: 91.13%
Macro f1-score: 56.12%
Diagnosis acc on 30mins: 1.0
[0.99903226 0.99999881 0.98650801 0.97633672 0.99999368 0.99999964
 0.99998951 0.9999851  0.99893671 0.99999583 0.99996424 0.99942076
 0.99851185 0.99999785 0.99999976 0.99998438 0.99962759 0.99987471]
pred: 0.9976754122310214, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp018-nsrr

=== Test on chp019-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.412637, loss_ss: 1.731581, loss_d: 0.681056
0.0778 --- loss: 2.316266, loss_ss: 1.550457, loss_d: 0.765809
0.1556 --- loss: 2.185895, loss_ss: 1.583612, loss_d: 0.602283
0.2335 --- loss: 2.092174, loss_ss: 1.526568, loss_d: 0.565606
0.3113 --- loss: 2.059905, loss_ss: 1.542715, loss_d: 0.517190
0.3891 --- loss: 2.004890, loss_ss: 1.473050, loss_d: 0.531840
0.4669 --- loss: 2.300468, loss_ss: 1.490803, loss_d: 0.809665
0.5447 --- loss: 2.403003, loss_ss: 1.469084, loss_d: 0.933919
0.6226 --- loss: 2.506050, loss_ss: 1.506924, loss_d: 0.999126
0.7004 --- loss: 2.147050, loss_ss: 1.404006, loss_d: 0.743044
0.7782 --- loss: 2.151037, loss_ss: 1.561855, loss_d: 0.589182
0.8560 --- loss: 2.182825, loss_ss: 1.538304, loss_d: 0.644521
0.9339 --- loss: 2.059888, loss_ss: 1.440514, loss_d: 0.619374
Epoch finished! Loss: 2.126388929784298
Starting epoch 2/10.
0.0000 --- loss: 1.823577, loss_ss: 1.412782, loss_d: 0.410795
0.0778 --- loss: 1.740420, loss_ss: 1.363390, loss_d: 0.377029
0.1556 --- loss: 1.679214, loss_ss: 1.386942, loss_d: 0.292272
0.2335 --- loss: 2.112987, loss_ss: 1.342674, loss_d: 0.770312
0.3113 --- loss: 1.741486, loss_ss: 1.309100, loss_d: 0.432385
0.3891 --- loss: 1.723799, loss_ss: 1.252203, loss_d: 0.471597
0.4669 --- loss: 1.823460, loss_ss: 1.299027, loss_d: 0.524434
0.5447 --- loss: 1.640882, loss_ss: 1.247772, loss_d: 0.393111
0.6226 --- loss: 1.762904, loss_ss: 1.325317, loss_d: 0.437587
0.7004 --- loss: 1.814460, loss_ss: 1.179436, loss_d: 0.635024
0.7782 --- loss: 2.418805, loss_ss: 1.286764, loss_d: 1.132041
0.8560 --- loss: 2.079654, loss_ss: 1.261805, loss_d: 0.817849
0.9339 --- loss: 1.761701, loss_ss: 1.336223, loss_d: 0.425477
Epoch finished! Loss: 1.8329498628154397
Starting epoch 3/10.
0.0000 --- loss: 1.507759, loss_ss: 1.244766, loss_d: 0.262992
0.0778 --- loss: 1.583231, loss_ss: 1.213476, loss_d: 0.369754
0.1556 --- loss: 1.560347, loss_ss: 1.250929, loss_d: 0.309418
0.2335 --- loss: 1.994776, loss_ss: 1.250837, loss_d: 0.743939
0.3113 --- loss: 1.369512, loss_ss: 1.227732, loss_d: 0.141781
0.3891 --- loss: 1.595185, loss_ss: 1.232127, loss_d: 0.363058
0.4669 --- loss: 1.561841, loss_ss: 1.304364, loss_d: 0.257477
0.5447 --- loss: 1.953027, loss_ss: 1.112175, loss_d: 0.840852
0.6226 --- loss: 1.486625, loss_ss: 1.180426, loss_d: 0.306199
0.7004 --- loss: 1.634713, loss_ss: 1.078253, loss_d: 0.556460
0.7782 --- loss: 1.632258, loss_ss: 1.252465, loss_d: 0.379793
0.8560 --- loss: 1.719019, loss_ss: 1.429588, loss_d: 0.289431
0.9339 --- loss: 1.337941, loss_ss: 1.082990, loss_d: 0.254952
Epoch finished! Loss: 1.5339403422549367
Starting epoch 4/10.
0.0000 --- loss: 1.349264, loss_ss: 1.166809, loss_d: 0.182455
0.0778 --- loss: 1.263553, loss_ss: 1.167345, loss_d: 0.096207
0.1556 --- loss: 1.487440, loss_ss: 1.129533, loss_d: 0.357907
0.2335 --- loss: 1.126121, loss_ss: 1.072213, loss_d: 0.053908
0.3113 --- loss: 1.470343, loss_ss: 0.975989, loss_d: 0.494354
0.3891 --- loss: 2.076636, loss_ss: 1.558639, loss_d: 0.517998
0.4669 --- loss: 1.448909, loss_ss: 1.214717, loss_d: 0.234192
0.5447 --- loss: 1.309495, loss_ss: 1.013826, loss_d: 0.295670
0.6226 --- loss: 1.185164, loss_ss: 1.034947, loss_d: 0.150217
0.7004 --- loss: 1.519513, loss_ss: 1.131003, loss_d: 0.388510
0.7782 --- loss: 1.056843, loss_ss: 1.006891, loss_d: 0.049953
0.8560 --- loss: 1.180827, loss_ss: 1.057622, loss_d: 0.123206
0.9339 --- loss: 1.066100, loss_ss: 0.906986, loss_d: 0.159114
Epoch finished! Loss: 1.33151611732319
Starting epoch 5/10.
0.0000 --- loss: 1.248583, loss_ss: 1.169411, loss_d: 0.079172
0.0778 --- loss: 1.029302, loss_ss: 0.882151, loss_d: 0.147152
0.1556 --- loss: 1.679011, loss_ss: 0.970039, loss_d: 0.708972
0.2335 --- loss: 1.253046, loss_ss: 1.059811, loss_d: 0.193236
0.3113 --- loss: 1.021267, loss_ss: 0.867090, loss_d: 0.154177
0.3891 --- loss: 1.349845, loss_ss: 0.955805, loss_d: 0.394039
0.4669 --- loss: 1.232252, loss_ss: 0.909918, loss_d: 0.322334
0.5447 --- loss: 1.249437, loss_ss: 1.101888, loss_d: 0.147549
0.6226 --- loss: 1.304156, loss_ss: 0.859869, loss_d: 0.444287
0.7004 --- loss: 1.318508, loss_ss: 0.966713, loss_d: 0.351795
0.7782 --- loss: 1.320334, loss_ss: 0.915285, loss_d: 0.405049
0.8560 --- loss: 1.170512, loss_ss: 1.051857, loss_d: 0.118654
0.9339 --- loss: 1.043183, loss_ss: 0.961280, loss_d: 0.081904
Epoch finished! Loss: 1.2202454200014472
Starting epoch 6/10.
0.0000 --- loss: 1.033762, loss_ss: 0.992566, loss_d: 0.041195
0.0778 --- loss: 1.151108, loss_ss: 1.007516, loss_d: 0.143592
0.1556 --- loss: 0.950537, loss_ss: 0.823848, loss_d: 0.126689
0.2335 --- loss: 1.173182, loss_ss: 1.039712, loss_d: 0.133470
0.3113 --- loss: 0.844670, loss_ss: 0.799167, loss_d: 0.045504
0.3891 --- loss: 1.416137, loss_ss: 1.162210, loss_d: 0.253927
0.4669 --- loss: 0.953117, loss_ss: 0.878791, loss_d: 0.074327
0.5447 --- loss: 0.890112, loss_ss: 0.831972, loss_d: 0.058139
0.6226 --- loss: 1.223286, loss_ss: 0.758661, loss_d: 0.464625
0.7004 --- loss: 1.125312, loss_ss: 1.005870, loss_d: 0.119443
0.7782 --- loss: 0.976636, loss_ss: 0.827186, loss_d: 0.149450
0.8560 --- loss: 0.893811, loss_ss: 0.861212, loss_d: 0.032599
0.9339 --- loss: 1.180705, loss_ss: 1.105834, loss_d: 0.074871
Epoch finished! Loss: 1.1005553877912462
Starting epoch 7/10.
0.0000 --- loss: 0.911719, loss_ss: 0.870486, loss_d: 0.041233
0.0778 --- loss: 1.135354, loss_ss: 0.738316, loss_d: 0.397038
0.1556 --- loss: 0.912413, loss_ss: 0.880466, loss_d: 0.031947
0.2335 --- loss: 0.934703, loss_ss: 0.818444, loss_d: 0.116258
0.3113 --- loss: 0.895899, loss_ss: 0.880661, loss_d: 0.015238
0.3891 --- loss: 0.965263, loss_ss: 0.907458, loss_d: 0.057805
0.4669 --- loss: 1.103847, loss_ss: 1.047518, loss_d: 0.056330
0.5447 --- loss: 0.829697, loss_ss: 0.790101, loss_d: 0.039596
0.6226 --- loss: 0.832909, loss_ss: 0.797962, loss_d: 0.034946
0.7004 --- loss: 0.876148, loss_ss: 0.842849, loss_d: 0.033299
0.7782 --- loss: 0.825095, loss_ss: 0.807138, loss_d: 0.017957
0.8560 --- loss: 0.983451, loss_ss: 0.980897, loss_d: 0.002554
0.9339 --- loss: 1.572845, loss_ss: 1.186958, loss_d: 0.385888
Epoch finished! Loss: 1.041061989031732
Starting epoch 8/10.
0.0000 --- loss: 1.265390, loss_ss: 0.925544, loss_d: 0.339846
0.0778 --- loss: 1.104697, loss_ss: 0.902139, loss_d: 0.202558
0.1556 --- loss: 1.138065, loss_ss: 1.076052, loss_d: 0.062013
0.2335 --- loss: 1.040702, loss_ss: 1.022246, loss_d: 0.018456
0.3113 --- loss: 1.112885, loss_ss: 1.077566, loss_d: 0.035319
0.3891 --- loss: 1.046967, loss_ss: 0.945599, loss_d: 0.101367
0.4669 --- loss: 0.922462, loss_ss: 0.882578, loss_d: 0.039883
0.5447 --- loss: 1.030538, loss_ss: 0.821897, loss_d: 0.208641
0.6226 --- loss: 1.141331, loss_ss: 0.977154, loss_d: 0.164177
0.7004 --- loss: 0.843514, loss_ss: 0.802132, loss_d: 0.041381
0.7782 --- loss: 0.857986, loss_ss: 0.846829, loss_d: 0.011157
0.8560 --- loss: 1.433519, loss_ss: 1.265360, loss_d: 0.168159
0.9339 --- loss: 0.735913, loss_ss: 0.696593, loss_d: 0.039320
Epoch finished! Loss: 1.0056883064098656
Starting epoch 9/10.
0.0000 --- loss: 1.000462, loss_ss: 0.821889, loss_d: 0.178573
0.0778 --- loss: 1.207916, loss_ss: 1.204640, loss_d: 0.003276
0.1556 --- loss: 1.048823, loss_ss: 1.027579, loss_d: 0.021244
0.2335 --- loss: 0.928884, loss_ss: 0.918341, loss_d: 0.010543
0.3113 --- loss: 0.879146, loss_ss: 0.873714, loss_d: 0.005432
0.3891 --- loss: 0.871270, loss_ss: 0.618498, loss_d: 0.252772
0.4669 --- loss: 0.922012, loss_ss: 0.901877, loss_d: 0.020135
0.5447 --- loss: 1.114434, loss_ss: 1.020191, loss_d: 0.094243
0.6226 --- loss: 0.985190, loss_ss: 0.973601, loss_d: 0.011589
0.7004 --- loss: 0.886454, loss_ss: 0.880650, loss_d: 0.005803
0.7782 --- loss: 1.023585, loss_ss: 0.709171, loss_d: 0.314414
0.8560 --- loss: 0.862881, loss_ss: 0.848240, loss_d: 0.014641
0.9339 --- loss: 0.722239, loss_ss: 0.669563, loss_d: 0.052677
Epoch finished! Loss: 0.9701105998829007
Starting epoch 10/10.
0.0000 --- loss: 1.190597, loss_ss: 1.102658, loss_d: 0.087939
0.0778 --- loss: 0.851652, loss_ss: 0.842833, loss_d: 0.008819
0.1556 --- loss: 0.877858, loss_ss: 0.740315, loss_d: 0.137543
0.2335 --- loss: 0.692816, loss_ss: 0.666812, loss_d: 0.026004
0.3113 --- loss: 1.169109, loss_ss: 0.980315, loss_d: 0.188794
0.3891 --- loss: 0.991303, loss_ss: 0.973990, loss_d: 0.017313
0.4669 --- loss: 0.821784, loss_ss: 0.791165, loss_d: 0.030618
0.5447 --- loss: 0.878173, loss_ss: 0.796455, loss_d: 0.081717
0.6226 --- loss: 0.834721, loss_ss: 0.818250, loss_d: 0.016471
0.7004 --- loss: 0.799603, loss_ss: 0.778875, loss_d: 0.020728
0.7782 --- loss: 0.822632, loss_ss: 0.783890, loss_d: 0.038742
0.8560 --- loss: 0.981826, loss_ss: 0.914670, loss_d: 0.067156
0.9339 --- loss: 0.895206, loss_ss: 0.887426, loss_d: 0.007780
Epoch finished! Loss: 0.9668316110037267
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5933333333333334
             precision    recall  f1-score   support

        0.0       0.18      0.67      0.28        36
        1.0       0.30      0.07      0.12       108
        2.0       0.46      0.79      0.58       215
        3.0       0.93      0.89      0.91       223
        4.0       0.85      0.42      0.56       318

avg / total       0.69      0.59      0.59       900
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.22  66.67   87.04  17.65     27.91
1  86.78   7.41   97.60  29.63     11.85
2  73.00  79.07   71.09  46.20     58.32
3  95.67  88.79   97.93  93.40     91.03
4  77.00  42.14   96.05  85.35     56.42
Total accuracy: 59.33%
Average sen: 56.81%
Average spec: 89.94%
Macro f1-score: 49.11%
Diagnosis acc on 30mins: 1.0
[0.99919087 0.92549664 0.99997759 0.99998796 0.99999726 0.99732614
 0.99992931 0.99999106 0.99995291 0.99999142 0.99934131 0.99998641
 0.99999964 0.99999702 0.99999487]
pred: 0.9947440266609192, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp019-nsrr

=== Test on chp020-nsrr. train_data(1281), test_data(19) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.432419, loss_ss: 1.716789, loss_d: 0.715629
0.0781 --- loss: 2.261878, loss_ss: 1.604394, loss_d: 0.657484
0.1561 --- loss: 2.114961, loss_ss: 1.516229, loss_d: 0.598732
0.2342 --- loss: 2.390852, loss_ss: 1.629938, loss_d: 0.760914
0.3123 --- loss: 2.106607, loss_ss: 1.558436, loss_d: 0.548172
0.3903 --- loss: 2.145235, loss_ss: 1.670648, loss_d: 0.474587
0.4684 --- loss: 2.030442, loss_ss: 1.422072, loss_d: 0.608369
0.5464 --- loss: 2.517554, loss_ss: 1.417985, loss_d: 1.099569
0.6245 --- loss: 1.938872, loss_ss: 1.526807, loss_d: 0.412065
0.7026 --- loss: 1.666059, loss_ss: 1.419161, loss_d: 0.246899
0.7806 --- loss: 1.900791, loss_ss: 1.397087, loss_d: 0.503704
0.8587 --- loss: 1.845403, loss_ss: 1.372533, loss_d: 0.472870
0.9368 --- loss: 1.707463, loss_ss: 1.455259, loss_d: 0.252204
Epoch finished! Loss: 2.108335384167731
Starting epoch 2/10.
0.0000 --- loss: 2.149600, loss_ss: 1.399811, loss_d: 0.749788
0.0781 --- loss: 1.846188, loss_ss: 1.369052, loss_d: 0.477136
0.1561 --- loss: 2.166600, loss_ss: 1.274233, loss_d: 0.892367
0.2342 --- loss: 1.614308, loss_ss: 1.298135, loss_d: 0.316173
0.3123 --- loss: 1.703177, loss_ss: 1.247815, loss_d: 0.455362
0.3903 --- loss: 1.434698, loss_ss: 1.266690, loss_d: 0.168008
0.4684 --- loss: 2.018404, loss_ss: 1.235444, loss_d: 0.782960
0.5464 --- loss: 1.408024, loss_ss: 1.255475, loss_d: 0.152549
0.6245 --- loss: 1.577649, loss_ss: 1.169143, loss_d: 0.408506
0.7026 --- loss: 1.528436, loss_ss: 1.264893, loss_d: 0.263542
0.7806 --- loss: 1.398204, loss_ss: 1.173039, loss_d: 0.225165
0.8587 --- loss: 1.619199, loss_ss: 1.224535, loss_d: 0.394664
0.9368 --- loss: 1.252726, loss_ss: 1.098886, loss_d: 0.153840
Epoch finished! Loss: 1.7198619032278657
Starting epoch 3/10.
0.0000 --- loss: 1.463452, loss_ss: 1.290727, loss_d: 0.172725
0.0781 --- loss: 1.375745, loss_ss: 1.257651, loss_d: 0.118094
0.1561 --- loss: 1.577343, loss_ss: 1.315492, loss_d: 0.261850
0.2342 --- loss: 1.381903, loss_ss: 1.128391, loss_d: 0.253512
0.3123 --- loss: 1.557278, loss_ss: 1.352074, loss_d: 0.205204
0.3903 --- loss: 1.545366, loss_ss: 1.099658, loss_d: 0.445708
0.4684 --- loss: 1.185276, loss_ss: 1.096133, loss_d: 0.089143
0.5464 --- loss: 1.317428, loss_ss: 1.128813, loss_d: 0.188615
0.6245 --- loss: 1.249237, loss_ss: 1.096719, loss_d: 0.152518
0.7026 --- loss: 1.297277, loss_ss: 1.145954, loss_d: 0.151322
0.7806 --- loss: 1.780589, loss_ss: 1.248096, loss_d: 0.532493
0.8587 --- loss: 1.798315, loss_ss: 1.329185, loss_d: 0.469130
0.9368 --- loss: 1.278802, loss_ss: 1.150530, loss_d: 0.128272
Epoch finished! Loss: 1.4850198114290833
Starting epoch 4/10.
0.0000 --- loss: 1.165246, loss_ss: 1.015450, loss_d: 0.149796
0.0781 --- loss: 1.665146, loss_ss: 1.244494, loss_d: 0.420652
0.1561 --- loss: 1.440640, loss_ss: 1.219559, loss_d: 0.221080
0.2342 --- loss: 1.517005, loss_ss: 1.383978, loss_d: 0.133027
0.3123 --- loss: 1.790131, loss_ss: 1.108571, loss_d: 0.681560
0.3903 --- loss: 1.326292, loss_ss: 1.054902, loss_d: 0.271390
0.4684 --- loss: 1.251060, loss_ss: 1.045018, loss_d: 0.206042
0.5464 --- loss: 1.219419, loss_ss: 1.101424, loss_d: 0.117996
0.6245 --- loss: 0.941313, loss_ss: 0.858499, loss_d: 0.082815
0.7026 --- loss: 1.569247, loss_ss: 1.098308, loss_d: 0.470939
0.7806 --- loss: 1.140409, loss_ss: 1.059698, loss_d: 0.080711
0.8587 --- loss: 1.131983, loss_ss: 1.077607, loss_d: 0.054376
0.9368 --- loss: 1.170005, loss_ss: 1.111575, loss_d: 0.058430
Epoch finished! Loss: 1.372855889145285
Starting epoch 5/10.
0.0000 --- loss: 1.316037, loss_ss: 1.084487, loss_d: 0.231550
0.0781 --- loss: 1.031949, loss_ss: 0.961763, loss_d: 0.070186
0.1561 --- loss: 1.132687, loss_ss: 1.017289, loss_d: 0.115397
0.2342 --- loss: 0.973280, loss_ss: 0.932922, loss_d: 0.040359
0.3123 --- loss: 1.337946, loss_ss: 0.935824, loss_d: 0.402122
0.3903 --- loss: 0.951918, loss_ss: 0.917510, loss_d: 0.034408
0.4684 --- loss: 1.018177, loss_ss: 1.005523, loss_d: 0.012654
0.5464 --- loss: 1.090237, loss_ss: 1.024138, loss_d: 0.066099
0.6245 --- loss: 1.199832, loss_ss: 0.896251, loss_d: 0.303581
0.7026 --- loss: 1.246154, loss_ss: 1.161409, loss_d: 0.084745
0.7806 --- loss: 1.408733, loss_ss: 0.912641, loss_d: 0.496091
0.8587 --- loss: 1.303771, loss_ss: 1.041934, loss_d: 0.261837
0.9368 --- loss: 1.065436, loss_ss: 0.999695, loss_d: 0.065742
Epoch finished! Loss: 1.2098861932754517
Starting epoch 6/10.
0.0000 --- loss: 1.091911, loss_ss: 1.026677, loss_d: 0.065234
0.0781 --- loss: 0.925769, loss_ss: 0.880562, loss_d: 0.045207
0.1561 --- loss: 1.033940, loss_ss: 1.003939, loss_d: 0.030001
0.2342 --- loss: 1.714990, loss_ss: 1.145538, loss_d: 0.569453
0.3123 --- loss: 1.167717, loss_ss: 1.127320, loss_d: 0.040397
0.3903 --- loss: 0.981116, loss_ss: 0.888408, loss_d: 0.092709
0.4684 --- loss: 0.889437, loss_ss: 0.878160, loss_d: 0.011277
0.5464 --- loss: 1.074198, loss_ss: 0.859524, loss_d: 0.214673
0.6245 --- loss: 1.304629, loss_ss: 0.812901, loss_d: 0.491729
0.7026 --- loss: 0.939358, loss_ss: 0.894335, loss_d: 0.045023
0.7806 --- loss: 1.183348, loss_ss: 1.105740, loss_d: 0.077609
0.8587 --- loss: 1.103840, loss_ss: 1.055015, loss_d: 0.048825
0.9368 --- loss: 0.902289, loss_ss: 0.890165, loss_d: 0.012123
Epoch finished! Loss: 1.1340346671640873
Starting epoch 7/10.
0.0000 --- loss: 1.189550, loss_ss: 0.970546, loss_d: 0.219004
0.0781 --- loss: 0.876678, loss_ss: 0.856257, loss_d: 0.020421
0.1561 --- loss: 1.143057, loss_ss: 0.952863, loss_d: 0.190194
0.2342 --- loss: 0.952159, loss_ss: 0.918233, loss_d: 0.033926
0.3123 --- loss: 1.093946, loss_ss: 1.080832, loss_d: 0.013113
0.3903 --- loss: 0.982616, loss_ss: 0.936270, loss_d: 0.046346
0.4684 --- loss: 0.999453, loss_ss: 0.990068, loss_d: 0.009386
0.5464 --- loss: 0.822131, loss_ss: 0.803824, loss_d: 0.018307
0.6245 --- loss: 0.833090, loss_ss: 0.761863, loss_d: 0.071227
0.7026 --- loss: 0.940402, loss_ss: 0.911951, loss_d: 0.028451
0.7806 --- loss: 1.257060, loss_ss: 1.235025, loss_d: 0.022035
0.8587 --- loss: 0.942949, loss_ss: 0.917206, loss_d: 0.025743
0.9368 --- loss: 0.950985, loss_ss: 0.859008, loss_d: 0.091977
Epoch finished! Loss: 1.0342233297415078
Starting epoch 8/10.
0.0000 --- loss: 0.905618, loss_ss: 0.894788, loss_d: 0.010829
0.0781 --- loss: 0.881170, loss_ss: 0.674568, loss_d: 0.206603
0.1561 --- loss: 0.914355, loss_ss: 0.760829, loss_d: 0.153527
0.2342 --- loss: 1.188153, loss_ss: 1.173362, loss_d: 0.014790
0.3123 --- loss: 0.923232, loss_ss: 0.865453, loss_d: 0.057779
0.3903 --- loss: 0.877031, loss_ss: 0.857372, loss_d: 0.019659
0.4684 --- loss: 0.746770, loss_ss: 0.739164, loss_d: 0.007606
0.5464 --- loss: 0.896490, loss_ss: 0.877756, loss_d: 0.018734
0.6245 --- loss: 1.308087, loss_ss: 1.295658, loss_d: 0.012429
0.7026 --- loss: 1.013313, loss_ss: 0.952242, loss_d: 0.061071
0.7806 --- loss: 1.004074, loss_ss: 0.998841, loss_d: 0.005232
0.8587 --- loss: 0.904387, loss_ss: 0.895845, loss_d: 0.008542
0.9368 --- loss: 1.018041, loss_ss: 0.994491, loss_d: 0.023550
Epoch finished! Loss: 1.0157978753559291
Starting epoch 9/10.
0.0000 --- loss: 0.804292, loss_ss: 0.799135, loss_d: 0.005157
0.0781 --- loss: 0.883764, loss_ss: 0.877970, loss_d: 0.005794
0.1561 --- loss: 0.797338, loss_ss: 0.750422, loss_d: 0.046917
0.2342 --- loss: 1.203985, loss_ss: 1.108985, loss_d: 0.095000
0.3123 --- loss: 0.757491, loss_ss: 0.678418, loss_d: 0.079073
0.3903 --- loss: 0.940958, loss_ss: 0.875162, loss_d: 0.065796
0.4684 --- loss: 1.079066, loss_ss: 1.077680, loss_d: 0.001386
0.5464 --- loss: 1.131378, loss_ss: 1.107475, loss_d: 0.023903
0.6245 --- loss: 1.239674, loss_ss: 0.959378, loss_d: 0.280296
0.7026 --- loss: 1.032199, loss_ss: 0.851652, loss_d: 0.180547
0.7806 --- loss: 0.938354, loss_ss: 0.751215, loss_d: 0.187139
0.8587 --- loss: 1.095496, loss_ss: 1.089161, loss_d: 0.006335
0.9368 --- loss: 0.762309, loss_ss: 0.726751, loss_d: 0.035558
Epoch finished! Loss: 1.0130384266376495
Starting epoch 10/10.
0.0000 --- loss: 0.781960, loss_ss: 0.777562, loss_d: 0.004397
0.0781 --- loss: 1.594628, loss_ss: 0.905775, loss_d: 0.688853
0.1561 --- loss: 0.881766, loss_ss: 0.816672, loss_d: 0.065094
0.2342 --- loss: 1.085156, loss_ss: 0.827941, loss_d: 0.257215
0.3123 --- loss: 1.432244, loss_ss: 1.010761, loss_d: 0.421483
0.3903 --- loss: 0.888675, loss_ss: 0.859016, loss_d: 0.029659
0.4684 --- loss: 0.952537, loss_ss: 0.897749, loss_d: 0.054787
0.5464 --- loss: 1.042790, loss_ss: 1.032359, loss_d: 0.010431
0.6245 --- loss: 1.015382, loss_ss: 0.930904, loss_d: 0.084478
0.7026 --- loss: 1.020311, loss_ss: 1.012597, loss_d: 0.007713
0.7806 --- loss: 0.998555, loss_ss: 0.978182, loss_d: 0.020373
0.8587 --- loss: 0.872885, loss_ss: 0.830538, loss_d: 0.042347
0.9368 --- loss: 0.870207, loss_ss: 0.812118, loss_d: 0.058089
Epoch finished! Loss: 1.0238687205128372
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6280701754385964
             precision    recall  f1-score   support

        0.0       0.98      0.42      0.59       297
        1.0       0.40      0.58      0.48       200
        2.0       0.66      0.98      0.79       354
        3.0       1.00      0.29      0.45       159
        4.0       0.53      0.62      0.57       130

avg / total       0.73      0.63      0.61      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  84.82  42.42   99.76   98.44     59.29
1  77.54  58.00   81.70   40.28     47.54
2  83.77  98.02   77.35   66.10     78.95
3  90.09  28.93  100.00  100.00     44.88
4  89.39  62.31   92.87   52.94     57.24
Total accuracy: 62.81%
Average sen: 57.94%
Average spec: 90.34%
Macro f1-score: 57.58%
Diagnosis acc on 30mins: 1.0
[0.99954212 0.99796838 0.98908585 0.93812817 0.99982673 0.99665868
 0.99977452 0.9986946  0.99996364 0.99999523 0.99976581 0.99984884
 0.99912876 0.99989796 0.99998391 0.99991786 0.99994922 0.99955946
 0.99999177]
pred: 0.9956674481693067, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp020-nsrr

=== Test on chp022-nsrr. train_data(1279), test_data(21) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.112199, loss_ss: 1.490912, loss_d: 0.621287
0.0782 --- loss: 2.122694, loss_ss: 1.506460, loss_d: 0.616233
0.1564 --- loss: 1.905226, loss_ss: 1.330148, loss_d: 0.575079
0.2346 --- loss: 2.172554, loss_ss: 1.518944, loss_d: 0.653611
0.3127 --- loss: 1.959012, loss_ss: 1.385528, loss_d: 0.573484
0.3909 --- loss: 1.786610, loss_ss: 1.289768, loss_d: 0.496842
0.4691 --- loss: 2.022975, loss_ss: 1.314023, loss_d: 0.708952
0.5473 --- loss: 1.741894, loss_ss: 1.327946, loss_d: 0.413948
0.6255 --- loss: 1.829146, loss_ss: 1.349426, loss_d: 0.479720
0.7037 --- loss: 1.850415, loss_ss: 1.476715, loss_d: 0.373700
0.7819 --- loss: 1.986847, loss_ss: 1.415709, loss_d: 0.571137
0.8600 --- loss: 1.712003, loss_ss: 1.346125, loss_d: 0.365878
0.9382 --- loss: 1.714438, loss_ss: 1.152128, loss_d: 0.562311
Epoch finished! Loss: 1.9631364411256444
Starting epoch 2/10.
0.0000 --- loss: 1.874220, loss_ss: 1.234014, loss_d: 0.640206
0.0782 --- loss: 1.716375, loss_ss: 1.417582, loss_d: 0.298793
0.1564 --- loss: 1.592317, loss_ss: 1.131521, loss_d: 0.460796
0.2346 --- loss: 1.736623, loss_ss: 1.237431, loss_d: 0.499192
0.3127 --- loss: 1.524127, loss_ss: 1.079342, loss_d: 0.444785
0.3909 --- loss: 1.726936, loss_ss: 1.271435, loss_d: 0.455500
0.4691 --- loss: 1.460530, loss_ss: 1.200987, loss_d: 0.259543
0.5473 --- loss: 1.769649, loss_ss: 1.293825, loss_d: 0.475824
0.6255 --- loss: 1.530439, loss_ss: 1.282463, loss_d: 0.247976
0.7037 --- loss: 1.581029, loss_ss: 1.134819, loss_d: 0.446209
0.7819 --- loss: 1.812191, loss_ss: 1.148194, loss_d: 0.663996
0.8600 --- loss: 1.470954, loss_ss: 1.238255, loss_d: 0.232699
0.9382 --- loss: 2.181290, loss_ss: 1.218966, loss_d: 0.962324
Epoch finished! Loss: 1.6280293755643949
Starting epoch 3/10.
0.0000 --- loss: 1.397628, loss_ss: 0.984232, loss_d: 0.413396
0.0782 --- loss: 1.360504, loss_ss: 1.041564, loss_d: 0.318940
0.1564 --- loss: 1.254827, loss_ss: 0.997419, loss_d: 0.257408
0.2346 --- loss: 1.215293, loss_ss: 1.020584, loss_d: 0.194709
0.3127 --- loss: 1.497285, loss_ss: 1.135560, loss_d: 0.361725
0.3909 --- loss: 1.303866, loss_ss: 0.985487, loss_d: 0.318379
0.4691 --- loss: 0.947012, loss_ss: 0.858675, loss_d: 0.088337
0.5473 --- loss: 1.344959, loss_ss: 0.991963, loss_d: 0.352996
0.6255 --- loss: 1.354931, loss_ss: 1.212413, loss_d: 0.142518
0.7037 --- loss: 1.255531, loss_ss: 1.162523, loss_d: 0.093009
0.7819 --- loss: 1.166119, loss_ss: 0.905823, loss_d: 0.260296
0.8600 --- loss: 1.496690, loss_ss: 1.273816, loss_d: 0.222874
0.9382 --- loss: 1.313789, loss_ss: 1.113165, loss_d: 0.200624
Epoch finished! Loss: 1.3779866057118093
Starting epoch 4/10.
0.0000 --- loss: 1.564513, loss_ss: 0.951364, loss_d: 0.613149
0.0782 --- loss: 1.236231, loss_ss: 1.064532, loss_d: 0.171699
0.1564 --- loss: 1.034637, loss_ss: 0.939181, loss_d: 0.095457
0.2346 --- loss: 1.527359, loss_ss: 0.969751, loss_d: 0.557608
0.3127 --- loss: 1.718979, loss_ss: 1.250262, loss_d: 0.468716
0.3909 --- loss: 1.022627, loss_ss: 0.903177, loss_d: 0.119449
0.4691 --- loss: 0.977353, loss_ss: 0.909018, loss_d: 0.068335
0.5473 --- loss: 0.901487, loss_ss: 0.835715, loss_d: 0.065772
0.6255 --- loss: 1.678858, loss_ss: 1.089732, loss_d: 0.589126
0.7037 --- loss: 1.340976, loss_ss: 1.117366, loss_d: 0.223610
0.7819 --- loss: 1.100284, loss_ss: 0.998906, loss_d: 0.101378
0.8600 --- loss: 1.114889, loss_ss: 0.903987, loss_d: 0.210901
0.9382 --- loss: 1.021463, loss_ss: 0.887510, loss_d: 0.133952
Epoch finished! Loss: 1.2540412526431046
Starting epoch 5/10.
0.0000 --- loss: 1.025147, loss_ss: 0.770314, loss_d: 0.254833
0.0782 --- loss: 1.166043, loss_ss: 1.032605, loss_d: 0.133438
0.1564 --- loss: 1.466922, loss_ss: 1.429194, loss_d: 0.037728
0.2346 --- loss: 0.987633, loss_ss: 0.914731, loss_d: 0.072902
0.3127 --- loss: 0.890224, loss_ss: 0.853582, loss_d: 0.036642
0.3909 --- loss: 1.032662, loss_ss: 0.959194, loss_d: 0.073468
0.4691 --- loss: 1.005180, loss_ss: 0.841911, loss_d: 0.163268
0.5473 --- loss: 1.090899, loss_ss: 0.819012, loss_d: 0.271886
0.6255 --- loss: 1.157139, loss_ss: 1.015213, loss_d: 0.141926
0.7037 --- loss: 1.073708, loss_ss: 0.967009, loss_d: 0.106699
0.7819 --- loss: 1.021818, loss_ss: 0.813062, loss_d: 0.208756
0.8600 --- loss: 1.224021, loss_ss: 1.097606, loss_d: 0.126415
0.9382 --- loss: 1.280041, loss_ss: 0.836803, loss_d: 0.443238
Epoch finished! Loss: 1.176267454943319
Starting epoch 6/10.
0.0000 --- loss: 1.125928, loss_ss: 1.005243, loss_d: 0.120685
0.0782 --- loss: 0.862576, loss_ss: 0.808055, loss_d: 0.054520
0.1564 --- loss: 0.871869, loss_ss: 0.838652, loss_d: 0.033217
0.2346 --- loss: 1.156057, loss_ss: 1.063943, loss_d: 0.092115
0.3127 --- loss: 1.006203, loss_ss: 0.946358, loss_d: 0.059845
0.3909 --- loss: 1.084815, loss_ss: 1.075004, loss_d: 0.009811
0.4691 --- loss: 0.825255, loss_ss: 0.755408, loss_d: 0.069847
0.5473 --- loss: 1.299254, loss_ss: 1.114106, loss_d: 0.185148
0.6255 --- loss: 0.897106, loss_ss: 0.870114, loss_d: 0.026992
0.7037 --- loss: 0.963805, loss_ss: 0.872023, loss_d: 0.091783
0.7819 --- loss: 1.061636, loss_ss: 0.680395, loss_d: 0.381241
0.8600 --- loss: 0.864717, loss_ss: 0.841236, loss_d: 0.023481
0.9382 --- loss: 0.905737, loss_ss: 0.782480, loss_d: 0.123257
Epoch finished! Loss: 1.0486497658444203
Starting epoch 7/10.
0.0000 --- loss: 0.766261, loss_ss: 0.752476, loss_d: 0.013785
0.0782 --- loss: 1.210454, loss_ss: 1.067807, loss_d: 0.142647
0.1564 --- loss: 0.995547, loss_ss: 0.751222, loss_d: 0.244325
0.2346 --- loss: 0.994916, loss_ss: 0.908156, loss_d: 0.086760
0.3127 --- loss: 1.151688, loss_ss: 1.102333, loss_d: 0.049355
0.3909 --- loss: 0.890524, loss_ss: 0.787547, loss_d: 0.102977
0.4691 --- loss: 0.726258, loss_ss: 0.698715, loss_d: 0.027543
0.5473 --- loss: 0.956272, loss_ss: 0.940758, loss_d: 0.015514
0.6255 --- loss: 1.058437, loss_ss: 0.904717, loss_d: 0.153720
0.7037 --- loss: 0.854870, loss_ss: 0.847141, loss_d: 0.007729
0.7819 --- loss: 0.875939, loss_ss: 0.851210, loss_d: 0.024729
0.8600 --- loss: 0.899599, loss_ss: 0.875117, loss_d: 0.024482
0.9382 --- loss: 1.231489, loss_ss: 0.945165, loss_d: 0.286325
Epoch finished! Loss: 1.0452723695537236
Starting epoch 8/10.
0.0000 --- loss: 0.780789, loss_ss: 0.735410, loss_d: 0.045379
0.0782 --- loss: 0.941266, loss_ss: 0.936615, loss_d: 0.004650
0.1564 --- loss: 1.063391, loss_ss: 1.013958, loss_d: 0.049434
0.2346 --- loss: 1.045435, loss_ss: 1.031843, loss_d: 0.013592
0.3127 --- loss: 1.024518, loss_ss: 1.004349, loss_d: 0.020169
0.3909 --- loss: 0.779951, loss_ss: 0.769166, loss_d: 0.010785
0.4691 --- loss: 0.824029, loss_ss: 0.815229, loss_d: 0.008801
0.5473 --- loss: 0.674206, loss_ss: 0.620737, loss_d: 0.053469
0.6255 --- loss: 1.138920, loss_ss: 0.846960, loss_d: 0.291959
0.7037 --- loss: 1.146329, loss_ss: 0.849187, loss_d: 0.297141
0.7819 --- loss: 0.898311, loss_ss: 0.816071, loss_d: 0.082240
0.8600 --- loss: 0.724646, loss_ss: 0.714317, loss_d: 0.010329
0.9382 --- loss: 0.811024, loss_ss: 0.801019, loss_d: 0.010005
Epoch finished! Loss: 0.9666853035528828
Starting epoch 9/10.
0.0000 --- loss: 1.017801, loss_ss: 1.010584, loss_d: 0.007217
0.0782 --- loss: 0.689949, loss_ss: 0.679801, loss_d: 0.010148
0.1564 --- loss: 1.071340, loss_ss: 1.060592, loss_d: 0.010748
0.2346 --- loss: 0.709549, loss_ss: 0.672417, loss_d: 0.037131
0.3127 --- loss: 1.040517, loss_ss: 0.704941, loss_d: 0.335576
0.3909 --- loss: 1.041205, loss_ss: 0.995117, loss_d: 0.046087
0.4691 --- loss: 0.776502, loss_ss: 0.765016, loss_d: 0.011487
0.5473 --- loss: 0.809419, loss_ss: 0.807390, loss_d: 0.002029
0.6255 --- loss: 0.758933, loss_ss: 0.754023, loss_d: 0.004910
0.7037 --- loss: 1.476823, loss_ss: 0.784406, loss_d: 0.692417
0.7819 --- loss: 0.728833, loss_ss: 0.708571, loss_d: 0.020262
0.8600 --- loss: 0.788109, loss_ss: 0.724480, loss_d: 0.063629
0.9382 --- loss: 1.424759, loss_ss: 1.271014, loss_d: 0.153745
Epoch finished! Loss: 0.9239117263808964
Starting epoch 10/10.
0.0000 --- loss: 0.847103, loss_ss: 0.779317, loss_d: 0.067786
0.0782 --- loss: 0.816694, loss_ss: 0.702906, loss_d: 0.113788
0.1564 --- loss: 1.302480, loss_ss: 0.669518, loss_d: 0.632963
0.2346 --- loss: 0.917808, loss_ss: 0.910238, loss_d: 0.007570
0.3127 --- loss: 1.017321, loss_ss: 0.832830, loss_d: 0.184491
0.3909 --- loss: 1.206451, loss_ss: 1.201481, loss_d: 0.004970
0.4691 --- loss: 0.894573, loss_ss: 0.862379, loss_d: 0.032193
0.5473 --- loss: 0.989425, loss_ss: 0.984269, loss_d: 0.005156
0.6255 --- loss: 0.936652, loss_ss: 0.869900, loss_d: 0.066751
0.7037 --- loss: 0.865598, loss_ss: 0.857540, loss_d: 0.008058
0.7819 --- loss: 0.901572, loss_ss: 0.892432, loss_d: 0.009140
0.8600 --- loss: 1.047888, loss_ss: 0.910234, loss_d: 0.137654
0.9382 --- loss: 0.861135, loss_ss: 0.633107, loss_d: 0.228028
Epoch finished! Loss: 0.9368025665208111
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6404761904761904
             precision    recall  f1-score   support

        0.0       0.61      0.90      0.73       253
        1.0       0.51      0.50      0.51       293
        2.0       0.82      0.72      0.77       468
        3.0       0.55      0.80      0.65       107
        4.0       0.21      0.05      0.08       139

avg / total       0.62      0.64      0.62      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.51  90.12   85.60  61.13     72.84
1  77.38  50.17   85.63  51.40     50.78
2  84.05  72.44   90.91  82.48     77.13
3  92.78  80.37   93.93  55.13     65.40
4  87.38   5.04   97.59  20.59      8.09
Total accuracy: 64.05%
Average sen: 59.63%
Average spec: 90.73%
Macro f1-score: 54.85%
Diagnosis acc on 30mins: 1.0
[0.9998098  0.99994028 0.9999975  0.99999976 0.99999976 0.99999976
 0.99999988 0.99999285 0.9999826  0.9999963  0.99920928 0.99995959
 1.         0.99999976 0.99999797 0.9999007  0.99998379 0.99999845
 0.99992347 0.99857259 0.99557376]
pred: 0.9996589450609117, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp022-nsrr

=== Test on chp024-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.430194, loss_ss: 1.703152, loss_d: 0.727042
0.0780 --- loss: 2.073537, loss_ss: 1.594116, loss_d: 0.479421
0.1560 --- loss: 2.018886, loss_ss: 1.456962, loss_d: 0.561924
0.2340 --- loss: 2.241478, loss_ss: 1.488968, loss_d: 0.752511
0.3120 --- loss: 2.045329, loss_ss: 1.473173, loss_d: 0.572156
0.3900 --- loss: 1.857188, loss_ss: 1.533077, loss_d: 0.324111
0.4680 --- loss: 2.358791, loss_ss: 1.380120, loss_d: 0.978672
0.5460 --- loss: 2.063682, loss_ss: 1.432470, loss_d: 0.631212
0.6240 --- loss: 1.855906, loss_ss: 1.479298, loss_d: 0.376608
0.7020 --- loss: 2.081986, loss_ss: 1.502850, loss_d: 0.579136
0.7800 --- loss: 1.732359, loss_ss: 1.322789, loss_d: 0.409570
0.8580 --- loss: 1.967581, loss_ss: 1.414141, loss_d: 0.553440
0.9360 --- loss: 2.071861, loss_ss: 1.570882, loss_d: 0.500978
Epoch finished! Loss: 2.0653452249243855
Starting epoch 2/10.
0.0000 --- loss: 1.707488, loss_ss: 1.292594, loss_d: 0.414894
0.0780 --- loss: 1.908434, loss_ss: 1.389518, loss_d: 0.518916
0.1560 --- loss: 1.866088, loss_ss: 1.290174, loss_d: 0.575913
0.2340 --- loss: 1.645036, loss_ss: 1.223302, loss_d: 0.421734
0.3120 --- loss: 1.958548, loss_ss: 1.209380, loss_d: 0.749168
0.3900 --- loss: 1.860009, loss_ss: 1.437333, loss_d: 0.422676
0.4680 --- loss: 1.586317, loss_ss: 1.327520, loss_d: 0.258797
0.5460 --- loss: 1.521560, loss_ss: 1.236991, loss_d: 0.284569
0.6240 --- loss: 1.713709, loss_ss: 1.440931, loss_d: 0.272778
0.7020 --- loss: 1.492136, loss_ss: 1.219872, loss_d: 0.272264
0.7800 --- loss: 1.605113, loss_ss: 1.234223, loss_d: 0.370891
0.8580 --- loss: 1.532968, loss_ss: 1.382589, loss_d: 0.150379
0.9360 --- loss: 1.316290, loss_ss: 1.193420, loss_d: 0.122870
Epoch finished! Loss: 1.7567050103098154
Starting epoch 3/10.
0.0000 --- loss: 1.484879, loss_ss: 1.162179, loss_d: 0.322700
0.0780 --- loss: 1.742361, loss_ss: 1.445812, loss_d: 0.296549
0.1560 --- loss: 1.817161, loss_ss: 1.455378, loss_d: 0.361783
0.2340 --- loss: 1.461710, loss_ss: 1.235629, loss_d: 0.226081
0.3120 --- loss: 1.820987, loss_ss: 1.455043, loss_d: 0.365943
0.3900 --- loss: 1.493755, loss_ss: 1.155011, loss_d: 0.338744
0.4680 --- loss: 1.827199, loss_ss: 1.383605, loss_d: 0.443594
0.5460 --- loss: 1.457847, loss_ss: 1.152725, loss_d: 0.305122
0.6240 --- loss: 1.299559, loss_ss: 1.187113, loss_d: 0.112446
0.7020 --- loss: 1.698419, loss_ss: 1.324162, loss_d: 0.374257
0.7800 --- loss: 1.304638, loss_ss: 1.088561, loss_d: 0.216077
0.8580 --- loss: 1.280835, loss_ss: 1.147330, loss_d: 0.133505
0.9360 --- loss: 1.374047, loss_ss: 0.992537, loss_d: 0.381510
Epoch finished! Loss: 1.5162099488079548
Starting epoch 4/10.
0.0000 --- loss: 1.340210, loss_ss: 1.171392, loss_d: 0.168818
0.0780 --- loss: 1.417047, loss_ss: 1.182835, loss_d: 0.234212
0.1560 --- loss: 1.425935, loss_ss: 1.234902, loss_d: 0.191034
0.2340 --- loss: 1.483189, loss_ss: 1.259367, loss_d: 0.223823
0.3120 --- loss: 1.370556, loss_ss: 1.048429, loss_d: 0.322127
0.3900 --- loss: 1.309163, loss_ss: 1.188549, loss_d: 0.120614
0.4680 --- loss: 1.087031, loss_ss: 1.024932, loss_d: 0.062098
0.5460 --- loss: 1.852642, loss_ss: 1.158710, loss_d: 0.693932
0.6240 --- loss: 1.212853, loss_ss: 1.131951, loss_d: 0.080901
0.7020 --- loss: 1.348292, loss_ss: 1.111432, loss_d: 0.236860
0.7800 --- loss: 1.151064, loss_ss: 1.023130, loss_d: 0.127934
0.8580 --- loss: 1.376552, loss_ss: 1.098428, loss_d: 0.278124
0.9360 --- loss: 1.231128, loss_ss: 1.131794, loss_d: 0.099334
Epoch finished! Loss: 1.379424894694239
Starting epoch 5/10.
0.0000 --- loss: 1.364691, loss_ss: 1.084339, loss_d: 0.280352
0.0780 --- loss: 1.115948, loss_ss: 0.915786, loss_d: 0.200162
0.1560 --- loss: 1.212210, loss_ss: 0.921206, loss_d: 0.291004
0.2340 --- loss: 1.092947, loss_ss: 1.051553, loss_d: 0.041395
0.3120 --- loss: 1.512516, loss_ss: 1.125446, loss_d: 0.387070
0.3900 --- loss: 1.027257, loss_ss: 0.936654, loss_d: 0.090603
0.4680 --- loss: 1.079103, loss_ss: 1.004969, loss_d: 0.074134
0.5460 --- loss: 1.133304, loss_ss: 1.057466, loss_d: 0.075838
0.6240 --- loss: 1.331198, loss_ss: 0.853450, loss_d: 0.477749
0.7020 --- loss: 0.925776, loss_ss: 0.848227, loss_d: 0.077549
0.7800 --- loss: 1.207099, loss_ss: 1.164467, loss_d: 0.042633
0.8580 --- loss: 0.999699, loss_ss: 0.977872, loss_d: 0.021827
0.9360 --- loss: 1.368274, loss_ss: 1.200392, loss_d: 0.167882
Epoch finished! Loss: 1.1922213952057064
Starting epoch 6/10.
0.0000 --- loss: 1.312389, loss_ss: 0.955550, loss_d: 0.356839
0.0780 --- loss: 1.084276, loss_ss: 1.059366, loss_d: 0.024910
0.1560 --- loss: 1.380236, loss_ss: 1.152868, loss_d: 0.227368
0.2340 --- loss: 0.969368, loss_ss: 0.932348, loss_d: 0.037020
0.3120 --- loss: 0.927883, loss_ss: 0.869228, loss_d: 0.058655
0.3900 --- loss: 1.318556, loss_ss: 1.221165, loss_d: 0.097391
0.4680 --- loss: 0.976209, loss_ss: 0.953818, loss_d: 0.022391
0.5460 --- loss: 1.094889, loss_ss: 0.786937, loss_d: 0.307952
0.6240 --- loss: 0.877683, loss_ss: 0.768191, loss_d: 0.109493
0.7020 --- loss: 0.977764, loss_ss: 0.941795, loss_d: 0.035969
0.7800 --- loss: 0.913205, loss_ss: 0.803065, loss_d: 0.110139
0.8580 --- loss: 1.095584, loss_ss: 0.836637, loss_d: 0.258947
0.9360 --- loss: 0.937651, loss_ss: 0.762369, loss_d: 0.175282
Epoch finished! Loss: 1.1021940144710243
Starting epoch 7/10.
0.0000 --- loss: 0.853839, loss_ss: 0.831897, loss_d: 0.021943
0.0780 --- loss: 1.155354, loss_ss: 0.967449, loss_d: 0.187905
0.1560 --- loss: 1.334746, loss_ss: 0.974585, loss_d: 0.360161
0.2340 --- loss: 1.187458, loss_ss: 0.802318, loss_d: 0.385141
0.3120 --- loss: 0.864247, loss_ss: 0.846658, loss_d: 0.017589
0.3900 --- loss: 0.991989, loss_ss: 0.985789, loss_d: 0.006200
0.4680 --- loss: 1.036274, loss_ss: 0.970753, loss_d: 0.065520
0.5460 --- loss: 0.891245, loss_ss: 0.865619, loss_d: 0.025626
0.6240 --- loss: 1.179572, loss_ss: 1.171360, loss_d: 0.008211
0.7020 --- loss: 1.285273, loss_ss: 0.846785, loss_d: 0.438487
0.7800 --- loss: 0.980272, loss_ss: 0.792509, loss_d: 0.187763
0.8580 --- loss: 0.961129, loss_ss: 0.953690, loss_d: 0.007438
0.9360 --- loss: 0.783523, loss_ss: 0.711712, loss_d: 0.071811
Epoch finished! Loss: 1.0043663447722793
Starting epoch 8/10.
0.0000 --- loss: 0.846894, loss_ss: 0.671688, loss_d: 0.175206
0.0780 --- loss: 1.439880, loss_ss: 0.979880, loss_d: 0.460001
0.1560 --- loss: 0.996693, loss_ss: 0.930717, loss_d: 0.065976
0.2340 --- loss: 1.039593, loss_ss: 0.832826, loss_d: 0.206767
0.3120 --- loss: 0.943674, loss_ss: 0.890224, loss_d: 0.053449
0.3900 --- loss: 0.673847, loss_ss: 0.661757, loss_d: 0.012091
0.4680 --- loss: 1.057316, loss_ss: 1.049602, loss_d: 0.007714
0.5460 --- loss: 1.060789, loss_ss: 0.927469, loss_d: 0.133321
0.6240 --- loss: 1.079186, loss_ss: 1.071494, loss_d: 0.007692
0.7020 --- loss: 0.900688, loss_ss: 0.793900, loss_d: 0.106788
0.7800 --- loss: 1.022966, loss_ss: 0.771335, loss_d: 0.251631
0.8580 --- loss: 1.261236, loss_ss: 0.734737, loss_d: 0.526499
0.9360 --- loss: 0.988447, loss_ss: 0.958633, loss_d: 0.029814
Epoch finished! Loss: 1.004955000244081
Starting epoch 9/10.
0.0000 --- loss: 0.958051, loss_ss: 0.951564, loss_d: 0.006486
0.0780 --- loss: 0.712453, loss_ss: 0.690544, loss_d: 0.021908
0.1560 --- loss: 0.825655, loss_ss: 0.694531, loss_d: 0.131124
0.2340 --- loss: 0.705007, loss_ss: 0.701423, loss_d: 0.003583
0.3120 --- loss: 0.797328, loss_ss: 0.795884, loss_d: 0.001444
0.3900 --- loss: 0.862770, loss_ss: 0.859312, loss_d: 0.003458
0.4680 --- loss: 0.778383, loss_ss: 0.721097, loss_d: 0.057285
0.5460 --- loss: 0.911538, loss_ss: 0.903363, loss_d: 0.008175
0.6240 --- loss: 0.946910, loss_ss: 0.858583, loss_d: 0.088327
0.7020 --- loss: 0.775894, loss_ss: 0.770426, loss_d: 0.005468
0.7800 --- loss: 0.913836, loss_ss: 0.804306, loss_d: 0.109530
0.8580 --- loss: 1.043969, loss_ss: 0.943466, loss_d: 0.100503
0.9360 --- loss: 0.912314, loss_ss: 0.896295, loss_d: 0.016018
Epoch finished! Loss: 0.9289425071328878
Starting epoch 10/10.
0.0000 --- loss: 0.861608, loss_ss: 0.840722, loss_d: 0.020886
0.0780 --- loss: 0.910889, loss_ss: 0.867068, loss_d: 0.043820
0.1560 --- loss: 0.736026, loss_ss: 0.726811, loss_d: 0.009215
0.2340 --- loss: 0.884840, loss_ss: 0.859116, loss_d: 0.025724
0.3120 --- loss: 0.968621, loss_ss: 0.855376, loss_d: 0.113246
0.3900 --- loss: 0.855405, loss_ss: 0.853434, loss_d: 0.001971
0.4680 --- loss: 0.988326, loss_ss: 0.983683, loss_d: 0.004643
0.5460 --- loss: 0.706299, loss_ss: 0.692326, loss_d: 0.013973
0.6240 --- loss: 1.125689, loss_ss: 0.839866, loss_d: 0.285823
0.7020 --- loss: 0.818755, loss_ss: 0.788610, loss_d: 0.030146
0.7800 --- loss: 1.150632, loss_ss: 0.834806, loss_d: 0.315825
0.8580 --- loss: 0.667219, loss_ss: 0.664437, loss_d: 0.002781
0.9360 --- loss: 0.816184, loss_ss: 0.781814, loss_d: 0.034370
Epoch finished! Loss: 0.9440914932638407
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5574074074074075
             precision    recall  f1-score   support

        0.0       0.79      0.56      0.65       232
        1.0       0.42      0.14      0.21       179
        2.0       0.47      0.68      0.56       216
        3.0       1.00      0.62      0.77       339
        4.0       0.27      0.81      0.41       114

avg / total       0.68      0.56      0.57      1080
 


====== chp024-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.31  55.60   95.99   79.14     65.32
1  82.50  13.97   96.12   41.67     20.92
2  78.43  67.59   81.13   47.25     55.62
3  88.06  61.95  100.00  100.00     76.50
4  75.19  80.70   74.53   27.22     40.71
Total accuracy: 55.74%
Average sen: 55.96%
Average spec: 89.55%
Macro f1-score: 51.81%
Diagnosis acc on 30mins: 1.0
[0.99555063 0.99799937 0.999731   0.99999905 0.99999893 0.99971861
 0.99999428 0.9997949  0.99453533 0.99997652 0.9999572  0.99996686
 0.99999702 0.99842    0.99891913 0.99999809 0.99887174 0.99997008]
pred: 0.999077707529068, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp024-nsrr

=== Test on chp025-nsrr. train_data(1293), test_data(7) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.520155, loss_ss: 1.784176, loss_d: 0.735979
0.0773 --- loss: 2.270796, loss_ss: 1.704889, loss_d: 0.565907
0.1547 --- loss: 2.383791, loss_ss: 1.665555, loss_d: 0.718237
0.2320 --- loss: 2.060364, loss_ss: 1.633642, loss_d: 0.426722
0.3094 --- loss: 2.323254, loss_ss: 1.715918, loss_d: 0.607337
0.3867 --- loss: 2.044152, loss_ss: 1.452721, loss_d: 0.591431
0.4640 --- loss: 2.378741, loss_ss: 1.505415, loss_d: 0.873325
0.5414 --- loss: 2.117057, loss_ss: 1.652207, loss_d: 0.464850
0.6187 --- loss: 2.160046, loss_ss: 1.553070, loss_d: 0.606976
0.6961 --- loss: 1.996202, loss_ss: 1.403183, loss_d: 0.593019
0.7734 --- loss: 2.078050, loss_ss: 1.430516, loss_d: 0.647534
0.8507 --- loss: 1.845572, loss_ss: 1.396192, loss_d: 0.449380
0.9281 --- loss: 2.152429, loss_ss: 1.335071, loss_d: 0.817358
Epoch finished! Loss: 2.1575345706570057
Starting epoch 2/10.
0.0000 --- loss: 1.836348, loss_ss: 1.376351, loss_d: 0.459997
0.0773 --- loss: 1.693499, loss_ss: 1.315031, loss_d: 0.378467
0.1547 --- loss: 1.942665, loss_ss: 1.334053, loss_d: 0.608612
0.2320 --- loss: 1.834127, loss_ss: 1.510113, loss_d: 0.324014
0.3094 --- loss: 1.930708, loss_ss: 1.245879, loss_d: 0.684829
0.3867 --- loss: 1.797773, loss_ss: 1.334681, loss_d: 0.463091
0.4640 --- loss: 1.663869, loss_ss: 1.305879, loss_d: 0.357991
0.5414 --- loss: 1.667256, loss_ss: 1.377608, loss_d: 0.289648
0.6187 --- loss: 1.893336, loss_ss: 1.375243, loss_d: 0.518094
0.6961 --- loss: 1.645808, loss_ss: 1.305242, loss_d: 0.340566
0.7734 --- loss: 1.540350, loss_ss: 1.278199, loss_d: 0.262151
0.8507 --- loss: 1.752918, loss_ss: 1.349532, loss_d: 0.403386
0.9281 --- loss: 1.643334, loss_ss: 1.219343, loss_d: 0.423991
Epoch finished! Loss: 1.8347257930178975
Starting epoch 3/10.
0.0000 --- loss: 1.511796, loss_ss: 1.285876, loss_d: 0.225920
0.0773 --- loss: 1.613264, loss_ss: 1.228672, loss_d: 0.384593
0.1547 --- loss: 1.495005, loss_ss: 1.331454, loss_d: 0.163551
0.2320 --- loss: 1.360255, loss_ss: 1.283703, loss_d: 0.076552
0.3094 --- loss: 1.500523, loss_ss: 1.223748, loss_d: 0.276775
0.3867 --- loss: 1.297279, loss_ss: 1.101428, loss_d: 0.195852
0.4640 --- loss: 1.301040, loss_ss: 1.163599, loss_d: 0.137441
0.5414 --- loss: 1.242590, loss_ss: 1.058097, loss_d: 0.184493
0.6187 --- loss: 1.488996, loss_ss: 1.123929, loss_d: 0.365067
0.6961 --- loss: 1.242045, loss_ss: 1.111911, loss_d: 0.130133
0.7734 --- loss: 1.342398, loss_ss: 1.113561, loss_d: 0.228837
0.8507 --- loss: 1.752148, loss_ss: 1.024758, loss_d: 0.727390
0.9281 --- loss: 1.481956, loss_ss: 1.068527, loss_d: 0.413429
Epoch finished! Loss: 1.49948905512344
Starting epoch 4/10.
0.0000 --- loss: 1.149520, loss_ss: 1.047788, loss_d: 0.101733
0.0773 --- loss: 1.400522, loss_ss: 1.223896, loss_d: 0.176626
0.1547 --- loss: 1.234988, loss_ss: 1.090520, loss_d: 0.144468
0.2320 --- loss: 1.653767, loss_ss: 1.309861, loss_d: 0.343906
0.3094 --- loss: 1.269578, loss_ss: 1.138757, loss_d: 0.130821
0.3867 --- loss: 1.268944, loss_ss: 1.080434, loss_d: 0.188510
0.4640 --- loss: 1.573854, loss_ss: 1.148159, loss_d: 0.425695
0.5414 --- loss: 1.011194, loss_ss: 0.885699, loss_d: 0.125495
0.6187 --- loss: 1.520499, loss_ss: 1.281787, loss_d: 0.238712
0.6961 --- loss: 1.035440, loss_ss: 0.932098, loss_d: 0.103342
0.7734 --- loss: 1.322959, loss_ss: 0.999903, loss_d: 0.323056
0.8507 --- loss: 0.947560, loss_ss: 0.836244, loss_d: 0.111317
0.9281 --- loss: 1.238277, loss_ss: 1.133173, loss_d: 0.105103
Epoch finished! Loss: 1.3030034899711609
Starting epoch 5/10.
0.0000 --- loss: 1.049354, loss_ss: 0.886691, loss_d: 0.162663
0.0773 --- loss: 1.312660, loss_ss: 1.228234, loss_d: 0.084426
0.1547 --- loss: 1.241032, loss_ss: 0.944268, loss_d: 0.296763
0.2320 --- loss: 1.230529, loss_ss: 0.865402, loss_d: 0.365127
0.3094 --- loss: 0.994434, loss_ss: 0.945198, loss_d: 0.049236
0.3867 --- loss: 1.096986, loss_ss: 0.860849, loss_d: 0.236137
0.4640 --- loss: 1.009044, loss_ss: 0.994464, loss_d: 0.014579
0.5414 --- loss: 1.235854, loss_ss: 1.076824, loss_d: 0.159029
0.6187 --- loss: 1.207869, loss_ss: 1.089213, loss_d: 0.118656
0.6961 --- loss: 1.132656, loss_ss: 1.028604, loss_d: 0.104052
0.7734 --- loss: 1.312490, loss_ss: 1.269692, loss_d: 0.042797
0.8507 --- loss: 1.052802, loss_ss: 0.920492, loss_d: 0.132309
0.9281 --- loss: 1.224712, loss_ss: 0.885337, loss_d: 0.339376
Epoch finished! Loss: 1.1537887758986896
Starting epoch 6/10.
0.0000 --- loss: 0.959387, loss_ss: 0.934963, loss_d: 0.024424
0.0773 --- loss: 1.039014, loss_ss: 1.004967, loss_d: 0.034047
0.1547 --- loss: 1.110712, loss_ss: 1.082042, loss_d: 0.028671
0.2320 --- loss: 0.932153, loss_ss: 0.922702, loss_d: 0.009451
0.3094 --- loss: 1.029866, loss_ss: 1.017814, loss_d: 0.012053
0.3867 --- loss: 0.833511, loss_ss: 0.811839, loss_d: 0.021672
0.4640 --- loss: 1.020822, loss_ss: 0.910291, loss_d: 0.110531
0.5414 --- loss: 1.077367, loss_ss: 1.036636, loss_d: 0.040731
0.6187 --- loss: 1.698008, loss_ss: 1.109488, loss_d: 0.588520
0.6961 --- loss: 0.996316, loss_ss: 0.990222, loss_d: 0.006094
0.7734 --- loss: 1.122176, loss_ss: 1.036432, loss_d: 0.085744
0.8507 --- loss: 0.922909, loss_ss: 0.850127, loss_d: 0.072783
0.9281 --- loss: 1.155981, loss_ss: 1.144359, loss_d: 0.011622
Epoch finished! Loss: 1.0776408656623013
Starting epoch 7/10.
0.0000 --- loss: 0.920289, loss_ss: 0.832530, loss_d: 0.087758
0.0773 --- loss: 0.929319, loss_ss: 0.853748, loss_d: 0.075571
0.1547 --- loss: 1.402410, loss_ss: 1.001137, loss_d: 0.401273
0.2320 --- loss: 1.011196, loss_ss: 0.927377, loss_d: 0.083820
0.3094 --- loss: 1.045555, loss_ss: 0.809754, loss_d: 0.235801
0.3867 --- loss: 1.075548, loss_ss: 1.051117, loss_d: 0.024431
0.4640 --- loss: 0.959375, loss_ss: 0.902225, loss_d: 0.057150
0.5414 --- loss: 1.237460, loss_ss: 0.880024, loss_d: 0.357436
0.6187 --- loss: 1.134786, loss_ss: 0.875900, loss_d: 0.258887
0.6961 --- loss: 1.042036, loss_ss: 0.958236, loss_d: 0.083800
0.7734 --- loss: 0.894798, loss_ss: 0.793667, loss_d: 0.101131
0.8507 --- loss: 0.938176, loss_ss: 0.860966, loss_d: 0.077210
0.9281 --- loss: 0.980653, loss_ss: 0.911703, loss_d: 0.068950
Epoch finished! Loss: 1.059514774370563
Starting epoch 8/10.
0.0000 --- loss: 0.745242, loss_ss: 0.736136, loss_d: 0.009106
0.0773 --- loss: 0.879124, loss_ss: 0.875906, loss_d: 0.003218
0.1547 --- loss: 0.803849, loss_ss: 0.800789, loss_d: 0.003060
0.2320 --- loss: 1.040737, loss_ss: 1.015579, loss_d: 0.025158
0.3094 --- loss: 0.668911, loss_ss: 0.659262, loss_d: 0.009649
0.3867 --- loss: 1.008421, loss_ss: 1.001318, loss_d: 0.007103
0.4640 --- loss: 0.956371, loss_ss: 0.953443, loss_d: 0.002928
0.5414 --- loss: 0.921741, loss_ss: 0.916499, loss_d: 0.005241
0.6187 --- loss: 1.236468, loss_ss: 1.210521, loss_d: 0.025947
0.6961 --- loss: 0.853452, loss_ss: 0.816968, loss_d: 0.036484
0.7734 --- loss: 1.033925, loss_ss: 0.917414, loss_d: 0.116512
0.8507 --- loss: 0.972333, loss_ss: 0.774837, loss_d: 0.197496
0.9281 --- loss: 0.706150, loss_ss: 0.664541, loss_d: 0.041609
Epoch finished! Loss: 0.9671649872794632
Starting epoch 9/10.
0.0000 --- loss: 0.983613, loss_ss: 0.929798, loss_d: 0.053815
0.0773 --- loss: 0.887080, loss_ss: 0.861580, loss_d: 0.025500
0.1547 --- loss: 0.902339, loss_ss: 0.884609, loss_d: 0.017730
0.2320 --- loss: 0.766984, loss_ss: 0.748859, loss_d: 0.018125
0.3094 --- loss: 1.018341, loss_ss: 1.007321, loss_d: 0.011020
0.3867 --- loss: 0.913710, loss_ss: 0.911375, loss_d: 0.002335
0.4640 --- loss: 1.012312, loss_ss: 0.998526, loss_d: 0.013786
0.5414 --- loss: 1.078866, loss_ss: 1.078053, loss_d: 0.000813
0.6187 --- loss: 1.206491, loss_ss: 1.179068, loss_d: 0.027423
0.6961 --- loss: 1.124937, loss_ss: 0.983286, loss_d: 0.141651
0.7734 --- loss: 0.855316, loss_ss: 0.835966, loss_d: 0.019350
0.8507 --- loss: 1.073930, loss_ss: 1.063179, loss_d: 0.010751
0.9281 --- loss: 1.058875, loss_ss: 1.056527, loss_d: 0.002348
Epoch finished! Loss: 0.9288339989129887
Starting epoch 10/10.
0.0000 --- loss: 0.710856, loss_ss: 0.707988, loss_d: 0.002867
0.0773 --- loss: 1.265839, loss_ss: 1.086644, loss_d: 0.179195
0.1547 --- loss: 0.795465, loss_ss: 0.775708, loss_d: 0.019757
0.2320 --- loss: 0.924026, loss_ss: 0.910454, loss_d: 0.013572
0.3094 --- loss: 1.012396, loss_ss: 1.001593, loss_d: 0.010804
0.3867 --- loss: 0.959616, loss_ss: 0.946323, loss_d: 0.013293
0.4640 --- loss: 0.800753, loss_ss: 0.796081, loss_d: 0.004671
0.5414 --- loss: 1.182279, loss_ss: 1.059045, loss_d: 0.123234
0.6187 --- loss: 0.922236, loss_ss: 0.839834, loss_d: 0.082402
0.6961 --- loss: 0.706959, loss_ss: 0.698253, loss_d: 0.008706
0.7734 --- loss: 1.115413, loss_ss: 1.109190, loss_d: 0.006223
0.8507 --- loss: 1.005802, loss_ss: 0.992752, loss_d: 0.013051
0.9281 --- loss: 0.814615, loss_ss: 0.811080, loss_d: 0.003535
Epoch finished! Loss: 0.933406928250956
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6833333333333333
             precision    recall  f1-score   support

        0.0       1.00      0.68      0.81       304
        1.0       0.20      0.12      0.15        25
        2.0       0.63      0.59      0.61        29
        3.0       1.00      0.95      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.93      0.68      0.78       420
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  77.14  68.42  100.00  100.00     81.25
1  91.90  12.00   96.96   20.00     15.00
2  94.76  58.62   97.44   62.96     60.71
3  99.29  95.16  100.00  100.00     97.52
4  73.57    NaN   73.57    0.00       NaN
Total accuracy: 68.33%
Average sen: 58.55%
Average spec: 93.60%
Macro f1-score: 63.62%
Diagnosis acc on 30mins: 1.0
[0.99999988 1.         0.99999917 1.         0.99999964 0.99999964
 1.        ]
pred: 0.9999997615814209, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp025-nsrr

=== Test on chp026-nsrr. train_data(1285), test_data(15) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.261963, loss_ss: 1.602123, loss_d: 0.659840
0.0778 --- loss: 2.333441, loss_ss: 1.486665, loss_d: 0.846776
0.1556 --- loss: 2.246877, loss_ss: 1.436036, loss_d: 0.810842
0.2335 --- loss: 1.988855, loss_ss: 1.550070, loss_d: 0.438785
0.3113 --- loss: 1.724973, loss_ss: 1.374928, loss_d: 0.350045
0.3891 --- loss: 1.848779, loss_ss: 1.516125, loss_d: 0.332654
0.4669 --- loss: 1.995843, loss_ss: 1.319433, loss_d: 0.676410
0.5447 --- loss: 2.006322, loss_ss: 1.378441, loss_d: 0.627881
0.6226 --- loss: 1.754484, loss_ss: 1.325444, loss_d: 0.429040
0.7004 --- loss: 2.009495, loss_ss: 1.526178, loss_d: 0.483317
0.7782 --- loss: 1.966603, loss_ss: 1.274342, loss_d: 0.692261
0.8560 --- loss: 2.072230, loss_ss: 1.423069, loss_d: 0.649161
0.9339 --- loss: 1.870455, loss_ss: 1.408737, loss_d: 0.461717
Epoch finished! Loss: 2.043548363260925
Starting epoch 2/10.
0.0000 --- loss: 1.991500, loss_ss: 1.310454, loss_d: 0.681046
0.0778 --- loss: 1.750193, loss_ss: 1.351556, loss_d: 0.398637
0.1556 --- loss: 1.761159, loss_ss: 1.303436, loss_d: 0.457722
0.2335 --- loss: 1.743302, loss_ss: 1.200222, loss_d: 0.543080
0.3113 --- loss: 1.500144, loss_ss: 1.242871, loss_d: 0.257273
0.3891 --- loss: 1.649275, loss_ss: 1.255427, loss_d: 0.393847
0.4669 --- loss: 1.668077, loss_ss: 1.203388, loss_d: 0.464689
0.5447 --- loss: 1.714967, loss_ss: 1.341710, loss_d: 0.373257
0.6226 --- loss: 1.631574, loss_ss: 1.249412, loss_d: 0.382162
0.7004 --- loss: 1.721912, loss_ss: 1.246088, loss_d: 0.475824
0.7782 --- loss: 1.512390, loss_ss: 1.234547, loss_d: 0.277843
0.8560 --- loss: 1.453736, loss_ss: 1.189674, loss_d: 0.264062
0.9339 --- loss: 1.605391, loss_ss: 1.169391, loss_d: 0.436000
Epoch finished! Loss: 1.728645502589643
Starting epoch 3/10.
0.0000 --- loss: 1.590054, loss_ss: 1.226543, loss_d: 0.363511
0.0778 --- loss: 1.588334, loss_ss: 1.094725, loss_d: 0.493609
0.1556 --- loss: 1.402696, loss_ss: 1.169483, loss_d: 0.233213
0.2335 --- loss: 1.338718, loss_ss: 1.021780, loss_d: 0.316938
0.3113 --- loss: 1.744109, loss_ss: 1.066664, loss_d: 0.677445
0.3891 --- loss: 1.421853, loss_ss: 1.032215, loss_d: 0.389638
0.4669 --- loss: 1.445433, loss_ss: 1.148073, loss_d: 0.297361
0.5447 --- loss: 1.302913, loss_ss: 1.158606, loss_d: 0.144306
0.6226 --- loss: 1.573071, loss_ss: 1.171993, loss_d: 0.401078
0.7004 --- loss: 1.781897, loss_ss: 1.356699, loss_d: 0.425197
0.7782 --- loss: 1.235195, loss_ss: 1.066098, loss_d: 0.169097
0.8560 --- loss: 1.541369, loss_ss: 1.134657, loss_d: 0.406712
0.9339 --- loss: 1.096082, loss_ss: 0.916061, loss_d: 0.180021
Epoch finished! Loss: 1.4307008143514395
Starting epoch 4/10.
0.0000 --- loss: 1.177280, loss_ss: 1.138406, loss_d: 0.038874
0.0778 --- loss: 1.335167, loss_ss: 1.242743, loss_d: 0.092424
0.1556 --- loss: 1.313070, loss_ss: 1.226514, loss_d: 0.086556
0.2335 --- loss: 1.174496, loss_ss: 1.116841, loss_d: 0.057655
0.3113 --- loss: 1.255595, loss_ss: 0.970967, loss_d: 0.284628
0.3891 --- loss: 1.065983, loss_ss: 1.001298, loss_d: 0.064685
0.4669 --- loss: 1.240393, loss_ss: 1.017985, loss_d: 0.222408
0.5447 --- loss: 1.095817, loss_ss: 0.935188, loss_d: 0.160629
0.6226 --- loss: 1.126504, loss_ss: 1.073055, loss_d: 0.053449
0.7004 --- loss: 1.538911, loss_ss: 1.105710, loss_d: 0.433202
0.7782 --- loss: 1.210229, loss_ss: 0.941294, loss_d: 0.268935
0.8560 --- loss: 1.790223, loss_ss: 1.288348, loss_d: 0.501875
0.9339 --- loss: 1.064852, loss_ss: 0.926014, loss_d: 0.138838
Epoch finished! Loss: 1.2898686854168773
Starting epoch 5/10.
0.0000 --- loss: 1.275041, loss_ss: 1.142358, loss_d: 0.132684
0.0778 --- loss: 0.985080, loss_ss: 0.852209, loss_d: 0.132871
0.1556 --- loss: 1.077729, loss_ss: 0.947891, loss_d: 0.129838
0.2335 --- loss: 1.288550, loss_ss: 1.140196, loss_d: 0.148355
0.3113 --- loss: 0.956118, loss_ss: 0.934649, loss_d: 0.021469
0.3891 --- loss: 1.066767, loss_ss: 1.051818, loss_d: 0.014950
0.4669 --- loss: 1.040259, loss_ss: 0.933998, loss_d: 0.106262
0.5447 --- loss: 0.926836, loss_ss: 0.909991, loss_d: 0.016845
0.6226 --- loss: 1.022700, loss_ss: 0.964622, loss_d: 0.058078
0.7004 --- loss: 1.182181, loss_ss: 1.089131, loss_d: 0.093050
0.7782 --- loss: 1.164579, loss_ss: 1.121022, loss_d: 0.043558
0.8560 --- loss: 1.097425, loss_ss: 1.009111, loss_d: 0.088314
0.9339 --- loss: 1.117330, loss_ss: 0.959232, loss_d: 0.158098
Epoch finished! Loss: 1.1160238687880337
Starting epoch 6/10.
0.0000 --- loss: 1.049401, loss_ss: 0.833244, loss_d: 0.216158
0.0778 --- loss: 1.002359, loss_ss: 0.826282, loss_d: 0.176078
0.1556 --- loss: 0.978060, loss_ss: 0.792519, loss_d: 0.185541
0.2335 --- loss: 0.970415, loss_ss: 0.924906, loss_d: 0.045510
0.3113 --- loss: 1.167769, loss_ss: 0.930754, loss_d: 0.237015
0.3891 --- loss: 1.168766, loss_ss: 0.877172, loss_d: 0.291594
0.4669 --- loss: 1.082166, loss_ss: 0.834651, loss_d: 0.247515
0.5447 --- loss: 0.916277, loss_ss: 0.908652, loss_d: 0.007625
0.6226 --- loss: 0.748199, loss_ss: 0.737251, loss_d: 0.010949
0.7004 --- loss: 1.085863, loss_ss: 0.983355, loss_d: 0.102508
0.7782 --- loss: 1.329377, loss_ss: 1.113164, loss_d: 0.216213
0.8560 --- loss: 1.326449, loss_ss: 0.929237, loss_d: 0.397212
0.9339 --- loss: 1.019635, loss_ss: 0.964652, loss_d: 0.054982
Epoch finished! Loss: 1.1036802898161113
Starting epoch 7/10.
0.0000 --- loss: 0.747626, loss_ss: 0.736516, loss_d: 0.011110
0.0778 --- loss: 1.382032, loss_ss: 0.980923, loss_d: 0.401108
0.1556 --- loss: 0.994285, loss_ss: 0.862829, loss_d: 0.131456
0.2335 --- loss: 0.989977, loss_ss: 0.954071, loss_d: 0.035906
0.3113 --- loss: 0.766450, loss_ss: 0.719282, loss_d: 0.047168
0.3891 --- loss: 0.968400, loss_ss: 0.929163, loss_d: 0.039237
0.4669 --- loss: 1.110523, loss_ss: 0.967948, loss_d: 0.142575
0.5447 --- loss: 1.176073, loss_ss: 0.953530, loss_d: 0.222542
0.6226 --- loss: 0.963049, loss_ss: 0.939889, loss_d: 0.023161
0.7004 --- loss: 0.854185, loss_ss: 0.849299, loss_d: 0.004886
0.7782 --- loss: 0.900882, loss_ss: 0.745930, loss_d: 0.154952
0.8560 --- loss: 1.051543, loss_ss: 1.045779, loss_d: 0.005764
0.9339 --- loss: 1.173275, loss_ss: 1.142867, loss_d: 0.030408
Epoch finished! Loss: 1.0371291576884687
Starting epoch 8/10.
0.0000 --- loss: 0.828291, loss_ss: 0.827177, loss_d: 0.001114
0.0778 --- loss: 0.971860, loss_ss: 0.962520, loss_d: 0.009341
0.1556 --- loss: 1.068481, loss_ss: 1.067574, loss_d: 0.000907
0.2335 --- loss: 0.937908, loss_ss: 0.822932, loss_d: 0.114976
0.3113 --- loss: 1.202379, loss_ss: 1.162747, loss_d: 0.039632
0.3891 --- loss: 0.940330, loss_ss: 0.937390, loss_d: 0.002940
0.4669 --- loss: 0.933198, loss_ss: 0.925628, loss_d: 0.007569
0.5447 --- loss: 1.230139, loss_ss: 0.974420, loss_d: 0.255718
0.6226 --- loss: 0.724160, loss_ss: 0.678956, loss_d: 0.045203
0.7004 --- loss: 1.143229, loss_ss: 0.857998, loss_d: 0.285231
0.7782 --- loss: 0.779768, loss_ss: 0.757115, loss_d: 0.022654
0.8560 --- loss: 1.156579, loss_ss: 1.130281, loss_d: 0.026298
0.9339 --- loss: 1.247612, loss_ss: 0.796607, loss_d: 0.451005
Epoch finished! Loss: 0.9791585202328861
Starting epoch 9/10.
0.0000 --- loss: 0.782873, loss_ss: 0.773878, loss_d: 0.008995
0.0778 --- loss: 1.228132, loss_ss: 1.218146, loss_d: 0.009986
0.1556 --- loss: 0.704782, loss_ss: 0.699475, loss_d: 0.005307
0.2335 --- loss: 0.997742, loss_ss: 0.992760, loss_d: 0.004982
0.3113 --- loss: 0.797256, loss_ss: 0.769356, loss_d: 0.027900
0.3891 --- loss: 0.849872, loss_ss: 0.787094, loss_d: 0.062778
0.4669 --- loss: 0.681311, loss_ss: 0.656671, loss_d: 0.024640
0.5447 --- loss: 0.775379, loss_ss: 0.752800, loss_d: 0.022578
0.6226 --- loss: 0.685122, loss_ss: 0.678460, loss_d: 0.006662
0.7004 --- loss: 0.893583, loss_ss: 0.890677, loss_d: 0.002907
0.7782 --- loss: 0.747012, loss_ss: 0.728494, loss_d: 0.018517
0.8560 --- loss: 1.096346, loss_ss: 0.952985, loss_d: 0.143361
0.9339 --- loss: 0.875391, loss_ss: 0.854349, loss_d: 0.021043
Epoch finished! Loss: 0.9256996521726251
Starting epoch 10/10.
0.0000 --- loss: 1.129909, loss_ss: 1.107267, loss_d: 0.022642
0.0778 --- loss: 0.728289, loss_ss: 0.717278, loss_d: 0.011011
0.1556 --- loss: 1.256691, loss_ss: 1.151236, loss_d: 0.105455
0.2335 --- loss: 0.914561, loss_ss: 0.811844, loss_d: 0.102717
0.3113 --- loss: 1.008595, loss_ss: 1.005986, loss_d: 0.002610
0.3891 --- loss: 0.744426, loss_ss: 0.741172, loss_d: 0.003254
0.4669 --- loss: 1.061374, loss_ss: 1.057119, loss_d: 0.004254
0.5447 --- loss: 0.927758, loss_ss: 0.917572, loss_d: 0.010187
0.6226 --- loss: 0.806736, loss_ss: 0.803865, loss_d: 0.002871
0.7004 --- loss: 0.953641, loss_ss: 0.953016, loss_d: 0.000625
0.7782 --- loss: 1.239403, loss_ss: 0.696028, loss_d: 0.543375
0.8560 --- loss: 0.768643, loss_ss: 0.738429, loss_d: 0.030213
0.9339 --- loss: 0.860142, loss_ss: 0.837121, loss_d: 0.023020
Epoch finished! Loss: 0.927582239266485
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7833333333333333
             precision    recall  f1-score   support

        0.0       0.95      0.67      0.79        58
        1.0       0.23      0.36      0.28        55
        2.0       0.76      0.95      0.84       386
        3.0       0.95      0.77      0.85       182
        4.0       0.97      0.64      0.77       219

avg / total       0.83      0.78      0.79       900
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.67  67.24   99.76  95.12     78.79
1  88.67  36.36   92.07  22.99     28.17
2  84.89  94.56   77.63  76.04     84.30
3  94.56  76.92   99.03  95.24     85.11
4  90.89  64.38   99.41  97.24     77.47
Total accuracy: 78.33%
Average sen: 67.89%
Average spec: 93.58%
Macro f1-score: 70.77%
Diagnosis acc on 30mins: 1.0
[0.99997783 0.99930584 0.99818498 0.99949002 0.99995518 0.99999833
 0.99995184 0.99701083 0.99997687 0.99982721 0.99570847 0.99998558
 0.99941802 0.99777931 0.99996865]
pred: 0.9991025964419047, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp026-nsrr

=== Test on chp028-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.305033, loss_ss: 1.593435, loss_d: 0.711598
0.0779 --- loss: 2.240335, loss_ss: 1.621798, loss_d: 0.618537
0.1559 --- loss: 2.803678, loss_ss: 1.438146, loss_d: 1.365532
0.2338 --- loss: 1.808697, loss_ss: 1.408447, loss_d: 0.400250
0.3118 --- loss: 1.838219, loss_ss: 1.425616, loss_d: 0.412603
0.3897 --- loss: 2.056425, loss_ss: 1.434398, loss_d: 0.622027
0.4677 --- loss: 1.725466, loss_ss: 1.195422, loss_d: 0.530043
0.5456 --- loss: 1.659070, loss_ss: 1.253343, loss_d: 0.405727
0.6235 --- loss: 2.001220, loss_ss: 1.297614, loss_d: 0.703605
0.7015 --- loss: 1.691186, loss_ss: 1.269059, loss_d: 0.422127
0.7794 --- loss: 1.801207, loss_ss: 1.328663, loss_d: 0.472544
0.8574 --- loss: 1.759355, loss_ss: 1.274370, loss_d: 0.484985
0.9353 --- loss: 1.932393, loss_ss: 1.264451, loss_d: 0.667942
Epoch finished! Loss: 1.9866241198033094
Starting epoch 2/10.
0.0000 --- loss: 2.236510, loss_ss: 1.348258, loss_d: 0.888253
0.0779 --- loss: 1.773669, loss_ss: 1.228029, loss_d: 0.545640
0.1559 --- loss: 1.903776, loss_ss: 1.347665, loss_d: 0.556111
0.2338 --- loss: 1.370773, loss_ss: 1.103344, loss_d: 0.267429
0.3118 --- loss: 2.019324, loss_ss: 1.186623, loss_d: 0.832702
0.3897 --- loss: 1.444227, loss_ss: 1.158635, loss_d: 0.285593
0.4677 --- loss: 1.827430, loss_ss: 1.275450, loss_d: 0.551980
0.5456 --- loss: 1.726167, loss_ss: 1.238805, loss_d: 0.487362
0.6235 --- loss: 1.589374, loss_ss: 1.191588, loss_d: 0.397785
0.7015 --- loss: 1.251587, loss_ss: 1.059250, loss_d: 0.192338
0.7794 --- loss: 1.699148, loss_ss: 1.149730, loss_d: 0.549417
0.8574 --- loss: 1.603994, loss_ss: 1.153700, loss_d: 0.450294
0.9353 --- loss: 1.521724, loss_ss: 1.146335, loss_d: 0.375389
Epoch finished! Loss: 1.6569591471925378
Starting epoch 3/10.
0.0000 --- loss: 1.513506, loss_ss: 1.199304, loss_d: 0.314202
0.0779 --- loss: 1.409730, loss_ss: 1.184739, loss_d: 0.224991
0.1559 --- loss: 1.233089, loss_ss: 0.996149, loss_d: 0.236939
0.2338 --- loss: 1.461120, loss_ss: 1.162230, loss_d: 0.298890
0.3118 --- loss: 1.178534, loss_ss: 1.126192, loss_d: 0.052342
0.3897 --- loss: 1.650545, loss_ss: 0.994117, loss_d: 0.656429
0.4677 --- loss: 1.170484, loss_ss: 0.998283, loss_d: 0.172201
0.5456 --- loss: 1.524763, loss_ss: 1.152868, loss_d: 0.371895
0.6235 --- loss: 1.139728, loss_ss: 0.927170, loss_d: 0.212558
0.7015 --- loss: 1.427452, loss_ss: 1.011498, loss_d: 0.415954
0.7794 --- loss: 1.423273, loss_ss: 0.969560, loss_d: 0.453713
0.8574 --- loss: 1.122360, loss_ss: 0.793426, loss_d: 0.328934
0.9353 --- loss: 1.315136, loss_ss: 0.978706, loss_d: 0.336430
Epoch finished! Loss: 1.3759933756664395
Starting epoch 4/10.
0.0000 --- loss: 1.125335, loss_ss: 1.020174, loss_d: 0.105161
0.0779 --- loss: 1.069803, loss_ss: 0.981995, loss_d: 0.087808
0.1559 --- loss: 1.052886, loss_ss: 0.911391, loss_d: 0.141494
0.2338 --- loss: 0.913244, loss_ss: 0.889373, loss_d: 0.023871
0.3118 --- loss: 2.904383, loss_ss: 0.869172, loss_d: 2.035211
0.3897 --- loss: 1.161220, loss_ss: 0.971490, loss_d: 0.189730
0.4677 --- loss: 1.052712, loss_ss: 0.896487, loss_d: 0.156225
0.5456 --- loss: 1.282766, loss_ss: 1.069576, loss_d: 0.213190
0.6235 --- loss: 1.065609, loss_ss: 0.949177, loss_d: 0.116431
0.7015 --- loss: 0.987434, loss_ss: 0.796128, loss_d: 0.191306
0.7794 --- loss: 0.863474, loss_ss: 0.746611, loss_d: 0.116864
0.8574 --- loss: 1.096574, loss_ss: 1.042211, loss_d: 0.054364
0.9353 --- loss: 0.955900, loss_ss: 0.878157, loss_d: 0.077743
Epoch finished! Loss: 1.2117586815729737
Starting epoch 5/10.
0.0000 --- loss: 1.133091, loss_ss: 0.745037, loss_d: 0.388054
0.0779 --- loss: 0.967062, loss_ss: 0.851833, loss_d: 0.115228
0.1559 --- loss: 1.270518, loss_ss: 0.720089, loss_d: 0.550429
0.2338 --- loss: 1.159418, loss_ss: 0.967533, loss_d: 0.191885
0.3118 --- loss: 0.938634, loss_ss: 0.876043, loss_d: 0.062592
0.3897 --- loss: 1.019126, loss_ss: 0.895129, loss_d: 0.123997
0.4677 --- loss: 1.040790, loss_ss: 0.828276, loss_d: 0.212514
0.5456 --- loss: 1.337923, loss_ss: 1.048846, loss_d: 0.289077
0.6235 --- loss: 1.263106, loss_ss: 0.920428, loss_d: 0.342678
0.7015 --- loss: 1.333340, loss_ss: 1.229448, loss_d: 0.103892
0.7794 --- loss: 0.996606, loss_ss: 0.905527, loss_d: 0.091079
0.8574 --- loss: 1.110400, loss_ss: 1.069803, loss_d: 0.040598
0.9353 --- loss: 1.652288, loss_ss: 1.021081, loss_d: 0.631207
Epoch finished! Loss: 1.1421212325803936
Starting epoch 6/10.
0.0000 --- loss: 0.900264, loss_ss: 0.824396, loss_d: 0.075867
0.0779 --- loss: 1.004062, loss_ss: 0.957302, loss_d: 0.046760
0.1559 --- loss: 1.213170, loss_ss: 1.010684, loss_d: 0.202486
0.2338 --- loss: 1.079678, loss_ss: 0.987911, loss_d: 0.091767
0.3118 --- loss: 0.956149, loss_ss: 0.922738, loss_d: 0.033411
0.3897 --- loss: 1.070334, loss_ss: 0.913427, loss_d: 0.156907
0.4677 --- loss: 0.708560, loss_ss: 0.657034, loss_d: 0.051526
0.5456 --- loss: 1.182124, loss_ss: 1.051256, loss_d: 0.130868
0.6235 --- loss: 1.149020, loss_ss: 0.868364, loss_d: 0.280656
0.7015 --- loss: 1.059620, loss_ss: 0.888807, loss_d: 0.170814
0.7794 --- loss: 1.500303, loss_ss: 1.087083, loss_d: 0.413220
0.8574 --- loss: 1.041683, loss_ss: 0.981365, loss_d: 0.060318
0.9353 --- loss: 0.869215, loss_ss: 0.847205, loss_d: 0.022010
Epoch finished! Loss: 1.0877166488207877
Starting epoch 7/10.
0.0000 --- loss: 0.854005, loss_ss: 0.802024, loss_d: 0.051981
0.0779 --- loss: 1.270027, loss_ss: 0.968331, loss_d: 0.301696
0.1559 --- loss: 1.287680, loss_ss: 1.190251, loss_d: 0.097430
0.2338 --- loss: 1.969637, loss_ss: 0.615023, loss_d: 1.354614
0.3118 --- loss: 0.897576, loss_ss: 0.876541, loss_d: 0.021035
0.3897 --- loss: 1.083467, loss_ss: 0.961853, loss_d: 0.121614
0.4677 --- loss: 0.881633, loss_ss: 0.772185, loss_d: 0.109448
0.5456 --- loss: 0.914454, loss_ss: 0.755645, loss_d: 0.158810
0.6235 --- loss: 1.174374, loss_ss: 0.896745, loss_d: 0.277629
0.7015 --- loss: 1.160594, loss_ss: 1.010428, loss_d: 0.150167
0.7794 --- loss: 1.032034, loss_ss: 0.932822, loss_d: 0.099213
0.8574 --- loss: 0.903294, loss_ss: 0.886305, loss_d: 0.016989
0.9353 --- loss: 0.727943, loss_ss: 0.691541, loss_d: 0.036402
Epoch finished! Loss: 1.005470807198435
Starting epoch 8/10.
0.0000 --- loss: 1.146764, loss_ss: 0.557699, loss_d: 0.589065
0.0779 --- loss: 0.816403, loss_ss: 0.802177, loss_d: 0.014226
0.1559 --- loss: 1.056480, loss_ss: 1.005961, loss_d: 0.050520
0.2338 --- loss: 0.878950, loss_ss: 0.783129, loss_d: 0.095821
0.3118 --- loss: 0.896705, loss_ss: 0.879682, loss_d: 0.017023
0.3897 --- loss: 1.213959, loss_ss: 1.079350, loss_d: 0.134609
0.4677 --- loss: 1.086752, loss_ss: 0.970538, loss_d: 0.116214
0.5456 --- loss: 1.084918, loss_ss: 0.972096, loss_d: 0.112822
0.6235 --- loss: 0.973489, loss_ss: 0.889956, loss_d: 0.083533
0.7015 --- loss: 0.988865, loss_ss: 0.936241, loss_d: 0.052624
0.7794 --- loss: 0.893651, loss_ss: 0.882192, loss_d: 0.011460
0.8574 --- loss: 0.885585, loss_ss: 0.752807, loss_d: 0.132778
0.9353 --- loss: 0.875006, loss_ss: 0.866262, loss_d: 0.008744
Epoch finished! Loss: 0.9839543076232076
Starting epoch 9/10.
0.0000 --- loss: 0.835577, loss_ss: 0.831147, loss_d: 0.004430
0.0779 --- loss: 0.964601, loss_ss: 0.898488, loss_d: 0.066114
0.1559 --- loss: 1.124270, loss_ss: 0.965407, loss_d: 0.158863
0.2338 --- loss: 0.998758, loss_ss: 0.981621, loss_d: 0.017137
0.3118 --- loss: 0.786494, loss_ss: 0.777966, loss_d: 0.008528
0.3897 --- loss: 0.892412, loss_ss: 0.876273, loss_d: 0.016139
0.4677 --- loss: 0.662082, loss_ss: 0.659710, loss_d: 0.002373
0.5456 --- loss: 0.801990, loss_ss: 0.797188, loss_d: 0.004801
0.6235 --- loss: 1.027682, loss_ss: 0.986954, loss_d: 0.040728
0.7015 --- loss: 1.526238, loss_ss: 1.163664, loss_d: 0.362574
0.7794 --- loss: 1.212427, loss_ss: 1.177844, loss_d: 0.034583
0.8574 --- loss: 0.843070, loss_ss: 0.831981, loss_d: 0.011090
0.9353 --- loss: 0.987286, loss_ss: 0.979919, loss_d: 0.007367
Epoch finished! Loss: 0.9223472252488136
Starting epoch 10/10.
0.0000 --- loss: 0.931424, loss_ss: 0.920678, loss_d: 0.010746
0.0779 --- loss: 0.790093, loss_ss: 0.749549, loss_d: 0.040544
0.1559 --- loss: 1.138950, loss_ss: 0.993516, loss_d: 0.145434
0.2338 --- loss: 0.885865, loss_ss: 0.878695, loss_d: 0.007169
0.3118 --- loss: 1.206468, loss_ss: 1.156473, loss_d: 0.049995
0.3897 --- loss: 1.038586, loss_ss: 1.035514, loss_d: 0.003073
0.4677 --- loss: 0.751259, loss_ss: 0.750472, loss_d: 0.000788
0.5456 --- loss: 0.955791, loss_ss: 0.933242, loss_d: 0.022550
0.6235 --- loss: 1.112246, loss_ss: 0.984336, loss_d: 0.127910
0.7015 --- loss: 0.962138, loss_ss: 0.925056, loss_d: 0.037083
0.7794 --- loss: 0.844736, loss_ss: 0.720060, loss_d: 0.124676
0.8574 --- loss: 1.053225, loss_ss: 0.992636, loss_d: 0.060589
0.9353 --- loss: 0.622514, loss_ss: 0.612947, loss_d: 0.009566
Epoch finished! Loss: 0.9707822990603745
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6732090284592738
             precision    recall  f1-score   support

        0.0       0.93      0.66      0.77       101
        1.0       0.12      0.31      0.18        55
        2.0       0.64      0.93      0.76       382
        3.0       0.96      0.26      0.40       191
        4.0       0.95      0.68      0.80       290

avg / total       0.79      0.67      0.67      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.17  66.34   99.46  93.06     77.46
1  84.49  30.91   87.55  12.41     17.71
2  78.12  92.93   69.23  64.43     76.10
3  85.87  25.65   99.76  96.08     40.50
4  89.99  68.28   98.63  95.19     79.52
Total accuracy: 67.32%
Average sen: 56.82%
Average spec: 90.92%
Macro f1-score: 58.26%
Diagnosis acc on 30mins: 1.0
[0.99862301 1.         0.99999845 0.99998236 0.9999994  0.99999976
 0.99999976 0.99979812 0.99999869 0.99999785 0.99999952 0.99993825
 0.99997282 0.99999976 0.99999988 0.9998005  0.99997997]
pred: 0.9998875365537756, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp028-nsrr

=== Test on chp029-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.329565, loss_ss: 1.568370, loss_d: 0.761195
0.0779 --- loss: 2.296707, loss_ss: 1.495171, loss_d: 0.801536
0.1559 --- loss: 2.123799, loss_ss: 1.512844, loss_d: 0.610955
0.2338 --- loss: 2.485212, loss_ss: 1.494960, loss_d: 0.990251
0.3118 --- loss: 2.227516, loss_ss: 1.477346, loss_d: 0.750170
0.3897 --- loss: 2.107394, loss_ss: 1.498314, loss_d: 0.609079
0.4677 --- loss: 1.992915, loss_ss: 1.344395, loss_d: 0.648520
0.5456 --- loss: 2.153610, loss_ss: 1.323175, loss_d: 0.830435
0.6235 --- loss: 2.008636, loss_ss: 1.297915, loss_d: 0.710721
0.7015 --- loss: 1.859452, loss_ss: 1.378306, loss_d: 0.481146
0.7794 --- loss: 1.660520, loss_ss: 1.255512, loss_d: 0.405007
0.8574 --- loss: 1.850640, loss_ss: 1.249125, loss_d: 0.601514
0.9353 --- loss: 1.867620, loss_ss: 1.156911, loss_d: 0.710708
Epoch finished! Loss: 2.0123110124841332
Starting epoch 2/10.
0.0000 --- loss: 1.699644, loss_ss: 1.251834, loss_d: 0.447810
0.0779 --- loss: 1.739109, loss_ss: 1.357673, loss_d: 0.381436
0.1559 --- loss: 1.602720, loss_ss: 1.274720, loss_d: 0.328000
0.2338 --- loss: 1.363444, loss_ss: 1.107840, loss_d: 0.255603
0.3118 --- loss: 1.563425, loss_ss: 1.141671, loss_d: 0.421754
0.3897 --- loss: 1.640029, loss_ss: 1.268727, loss_d: 0.371302
0.4677 --- loss: 1.556623, loss_ss: 1.342441, loss_d: 0.214182
0.5456 --- loss: 1.464904, loss_ss: 1.087468, loss_d: 0.377436
0.6235 --- loss: 1.280690, loss_ss: 1.051879, loss_d: 0.228812
0.7015 --- loss: 1.794820, loss_ss: 1.526896, loss_d: 0.267924
0.7794 --- loss: 1.567547, loss_ss: 1.297154, loss_d: 0.270392
0.8574 --- loss: 1.493210, loss_ss: 1.266314, loss_d: 0.226896
0.9353 --- loss: 1.445642, loss_ss: 1.243474, loss_d: 0.202168
Epoch finished! Loss: 1.664517067372799
Starting epoch 3/10.
0.0000 --- loss: 1.711493, loss_ss: 1.176672, loss_d: 0.534822
0.0779 --- loss: 1.485593, loss_ss: 1.186307, loss_d: 0.299286
0.1559 --- loss: 1.291834, loss_ss: 1.078878, loss_d: 0.212956
0.2338 --- loss: 1.367378, loss_ss: 1.125678, loss_d: 0.241700
0.3118 --- loss: 1.567716, loss_ss: 1.198747, loss_d: 0.368969
0.3897 --- loss: 1.096475, loss_ss: 0.960198, loss_d: 0.136277
0.4677 --- loss: 1.534623, loss_ss: 1.251019, loss_d: 0.283605
0.5456 --- loss: 1.646837, loss_ss: 1.106498, loss_d: 0.540339
0.6235 --- loss: 1.219293, loss_ss: 1.083365, loss_d: 0.135928
0.7015 --- loss: 1.669303, loss_ss: 1.333105, loss_d: 0.336197
0.7794 --- loss: 1.695604, loss_ss: 1.370781, loss_d: 0.324823
0.8574 --- loss: 2.199292, loss_ss: 0.984751, loss_d: 1.214541
0.9353 --- loss: 1.075831, loss_ss: 0.885099, loss_d: 0.190732
Epoch finished! Loss: 1.4760946594178677
Starting epoch 4/10.
0.0000 --- loss: 1.195170, loss_ss: 1.084278, loss_d: 0.110892
0.0779 --- loss: 1.075095, loss_ss: 0.915784, loss_d: 0.159311
0.1559 --- loss: 1.279294, loss_ss: 1.174924, loss_d: 0.104371
0.2338 --- loss: 1.732041, loss_ss: 1.092659, loss_d: 0.639382
0.3118 --- loss: 1.104746, loss_ss: 1.010639, loss_d: 0.094107
0.3897 --- loss: 1.206478, loss_ss: 1.087167, loss_d: 0.119311
0.4677 --- loss: 1.043757, loss_ss: 0.916882, loss_d: 0.126875
0.5456 --- loss: 1.388620, loss_ss: 1.299902, loss_d: 0.088718
0.6235 --- loss: 1.185741, loss_ss: 0.955404, loss_d: 0.230336
0.7015 --- loss: 1.288815, loss_ss: 1.211881, loss_d: 0.076935
0.7794 --- loss: 1.335480, loss_ss: 0.831196, loss_d: 0.504284
0.8574 --- loss: 1.244721, loss_ss: 1.150394, loss_d: 0.094328
0.9353 --- loss: 1.903798, loss_ss: 1.107692, loss_d: 0.796106
Epoch finished! Loss: 1.2935982467606664
Starting epoch 5/10.
0.0000 --- loss: 1.021361, loss_ss: 0.921860, loss_d: 0.099501
0.0779 --- loss: 1.086120, loss_ss: 1.012276, loss_d: 0.073844
0.1559 --- loss: 1.062428, loss_ss: 0.913063, loss_d: 0.149366
0.2338 --- loss: 0.947653, loss_ss: 0.920369, loss_d: 0.027284
0.3118 --- loss: 1.007372, loss_ss: 0.889162, loss_d: 0.118210
0.3897 --- loss: 0.988212, loss_ss: 0.901752, loss_d: 0.086460
0.4677 --- loss: 1.109711, loss_ss: 0.876740, loss_d: 0.232971
0.5456 --- loss: 0.991033, loss_ss: 0.953224, loss_d: 0.037809
0.6235 --- loss: 1.155003, loss_ss: 1.116082, loss_d: 0.038921
0.7015 --- loss: 0.933552, loss_ss: 0.889267, loss_d: 0.044285
0.7794 --- loss: 1.461184, loss_ss: 1.108120, loss_d: 0.353064
0.8574 --- loss: 0.963390, loss_ss: 0.923924, loss_d: 0.039465
0.9353 --- loss: 0.948075, loss_ss: 0.872287, loss_d: 0.075789
Epoch finished! Loss: 1.1922616413794458
Starting epoch 6/10.
0.0000 --- loss: 0.858500, loss_ss: 0.787486, loss_d: 0.071014
0.0779 --- loss: 1.050455, loss_ss: 1.021750, loss_d: 0.028706
0.1559 --- loss: 1.159023, loss_ss: 0.842036, loss_d: 0.316987
0.2338 --- loss: 1.883869, loss_ss: 1.153117, loss_d: 0.730752
0.3118 --- loss: 1.103300, loss_ss: 1.026778, loss_d: 0.076522
0.3897 --- loss: 1.067428, loss_ss: 0.926622, loss_d: 0.140806
0.4677 --- loss: 1.040760, loss_ss: 1.013589, loss_d: 0.027171
0.5456 --- loss: 0.857230, loss_ss: 0.822172, loss_d: 0.035058
0.6235 --- loss: 1.192010, loss_ss: 1.146564, loss_d: 0.045446
0.7015 --- loss: 1.024964, loss_ss: 0.794905, loss_d: 0.230060
0.7794 --- loss: 1.126743, loss_ss: 1.034994, loss_d: 0.091748
0.8574 --- loss: 0.931758, loss_ss: 0.790485, loss_d: 0.141273
0.9353 --- loss: 1.075762, loss_ss: 1.043303, loss_d: 0.032458
Epoch finished! Loss: 1.1203230046667159
Starting epoch 7/10.
0.0000 --- loss: 0.832410, loss_ss: 0.750504, loss_d: 0.081907
0.0779 --- loss: 1.042743, loss_ss: 0.968556, loss_d: 0.074187
0.1559 --- loss: 0.982924, loss_ss: 0.964451, loss_d: 0.018474
0.2338 --- loss: 0.986935, loss_ss: 0.975143, loss_d: 0.011792
0.3118 --- loss: 1.418166, loss_ss: 1.177285, loss_d: 0.240881
0.3897 --- loss: 1.576492, loss_ss: 0.925953, loss_d: 0.650539
0.4677 --- loss: 1.062286, loss_ss: 1.012248, loss_d: 0.050038
0.5456 --- loss: 0.849594, loss_ss: 0.823254, loss_d: 0.026340
0.6235 --- loss: 1.311365, loss_ss: 1.057492, loss_d: 0.253873
0.7015 --- loss: 1.649009, loss_ss: 0.871234, loss_d: 0.777776
0.7794 --- loss: 0.901496, loss_ss: 0.886629, loss_d: 0.014867
0.8574 --- loss: 0.888161, loss_ss: 0.831384, loss_d: 0.056778
0.9353 --- loss: 1.001066, loss_ss: 0.917715, loss_d: 0.083350
Epoch finished! Loss: 1.0316193560138345
Starting epoch 8/10.
0.0000 --- loss: 0.658378, loss_ss: 0.641867, loss_d: 0.016511
0.0779 --- loss: 1.091539, loss_ss: 0.724270, loss_d: 0.367269
0.1559 --- loss: 0.818332, loss_ss: 0.815261, loss_d: 0.003071
0.2338 --- loss: 1.091289, loss_ss: 0.885483, loss_d: 0.205806
0.3118 --- loss: 0.899959, loss_ss: 0.869411, loss_d: 0.030547
0.3897 --- loss: 0.735670, loss_ss: 0.681210, loss_d: 0.054460
0.4677 --- loss: 0.919084, loss_ss: 0.915953, loss_d: 0.003131
0.5456 --- loss: 0.927091, loss_ss: 0.924308, loss_d: 0.002783
0.6235 --- loss: 0.854994, loss_ss: 0.810588, loss_d: 0.044407
0.7015 --- loss: 0.939081, loss_ss: 0.924981, loss_d: 0.014100
0.7794 --- loss: 1.690709, loss_ss: 1.023049, loss_d: 0.667659
0.8574 --- loss: 1.193156, loss_ss: 1.022458, loss_d: 0.170698
0.9353 --- loss: 0.876404, loss_ss: 0.868420, loss_d: 0.007984
Epoch finished! Loss: 1.0049452558159828
Starting epoch 9/10.
0.0000 --- loss: 0.920115, loss_ss: 0.859748, loss_d: 0.060368
0.0779 --- loss: 0.984696, loss_ss: 0.974827, loss_d: 0.009869
0.1559 --- loss: 0.938560, loss_ss: 0.900341, loss_d: 0.038219
0.2338 --- loss: 0.890765, loss_ss: 0.862657, loss_d: 0.028108
0.3118 --- loss: 0.764229, loss_ss: 0.721606, loss_d: 0.042623
0.3897 --- loss: 0.799082, loss_ss: 0.789993, loss_d: 0.009089
0.4677 --- loss: 0.887777, loss_ss: 0.826692, loss_d: 0.061085
0.5456 --- loss: 0.913894, loss_ss: 0.912353, loss_d: 0.001540
0.6235 --- loss: 1.239988, loss_ss: 1.223323, loss_d: 0.016666
0.7015 --- loss: 1.037998, loss_ss: 1.020930, loss_d: 0.017069
0.7794 --- loss: 0.877089, loss_ss: 0.866269, loss_d: 0.010820
0.8574 --- loss: 0.944359, loss_ss: 0.861835, loss_d: 0.082524
0.9353 --- loss: 0.967394, loss_ss: 0.961455, loss_d: 0.005938
Epoch finished! Loss: 0.9681748165749013
Starting epoch 10/10.
0.0000 --- loss: 0.774230, loss_ss: 0.764848, loss_d: 0.009382
0.0779 --- loss: 0.950921, loss_ss: 0.813298, loss_d: 0.137623
0.1559 --- loss: 1.462408, loss_ss: 0.779977, loss_d: 0.682431
0.2338 --- loss: 1.060215, loss_ss: 0.978614, loss_d: 0.081601
0.3118 --- loss: 0.853011, loss_ss: 0.780896, loss_d: 0.072115
0.3897 --- loss: 0.955301, loss_ss: 0.942484, loss_d: 0.012817
0.4677 --- loss: 0.721571, loss_ss: 0.704704, loss_d: 0.016867
0.5456 --- loss: 1.006330, loss_ss: 1.004516, loss_d: 0.001814
0.6235 --- loss: 0.821622, loss_ss: 0.785195, loss_d: 0.036426
0.7015 --- loss: 0.923045, loss_ss: 0.769383, loss_d: 0.153661
0.7794 --- loss: 0.794761, loss_ss: 0.787154, loss_d: 0.007607
0.8574 --- loss: 1.070627, loss_ss: 0.889445, loss_d: 0.181182
0.9353 --- loss: 1.231482, loss_ss: 0.901303, loss_d: 0.330179
Epoch finished! Loss: 0.9683091910555959
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6813725490196079
             precision    recall  f1-score   support

        0.0       0.65      0.88      0.75        66
        1.0       0.13      0.41      0.19        44
        2.0       0.68      0.70      0.69       406
        3.0       0.99      0.64      0.78       334
        4.0       0.77      0.72      0.74       170

avg / total       0.77      0.68      0.71      1020
 


====== chp029-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.18  87.88   96.75  65.17     74.84
1  85.39  40.91   87.40  12.77     19.46
2  75.10  69.95   78.50  68.27     69.10
3  87.94  63.77   99.71  99.07     77.60
4  91.67  71.76   95.65  76.73     74.16
Total accuracy: 68.14%
Average sen: 66.86%
Average spec: 91.60%
Macro f1-score: 63.03%
Diagnosis acc on 30mins: 1.0
[0.9995259  0.99951494 0.99996924 0.99993408 0.99793917 0.99798286
 0.9992035  0.99999487 0.99952757 0.9998185  0.94129056 0.99935037
 0.99986815 0.99895132 0.99589527 0.99903405 0.99214089]
pred: 0.9952906615593854, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp029-nsrr

=== Test on chp030-nsrr. train_data(1280), test_data(20) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.435330, loss_ss: 1.683204, loss_d: 0.752126
0.0781 --- loss: 2.253562, loss_ss: 1.541286, loss_d: 0.712277
0.1562 --- loss: 2.205055, loss_ss: 1.528425, loss_d: 0.676630
0.2344 --- loss: 2.151329, loss_ss: 1.460087, loss_d: 0.691242
0.3125 --- loss: 1.740675, loss_ss: 1.321193, loss_d: 0.419482
0.3906 --- loss: 1.738689, loss_ss: 1.401095, loss_d: 0.337593
0.4688 --- loss: 2.076002, loss_ss: 1.448093, loss_d: 0.627909
0.5469 --- loss: 1.983732, loss_ss: 1.366349, loss_d: 0.617384
0.6250 --- loss: 1.794240, loss_ss: 1.409727, loss_d: 0.384513
0.7031 --- loss: 2.016373, loss_ss: 1.398430, loss_d: 0.617942
0.7812 --- loss: 1.641160, loss_ss: 1.293244, loss_d: 0.347916
0.8594 --- loss: 1.949988, loss_ss: 1.264047, loss_d: 0.685941
0.9375 --- loss: 1.747991, loss_ss: 1.175359, loss_d: 0.572632
Epoch finished! Loss: 2.00881898121571
Starting epoch 2/10.
0.0000 --- loss: 1.686812, loss_ss: 1.353587, loss_d: 0.333225
0.0781 --- loss: 1.764289, loss_ss: 1.315319, loss_d: 0.448970
0.1562 --- loss: 1.791629, loss_ss: 1.322194, loss_d: 0.469434
0.2344 --- loss: 1.692307, loss_ss: 1.262764, loss_d: 0.429543
0.3125 --- loss: 1.770491, loss_ss: 1.259573, loss_d: 0.510918
0.3906 --- loss: 1.681874, loss_ss: 1.120625, loss_d: 0.561249
0.4688 --- loss: 1.691749, loss_ss: 1.222599, loss_d: 0.469150
0.5469 --- loss: 1.445139, loss_ss: 1.098798, loss_d: 0.346341
0.6250 --- loss: 1.665720, loss_ss: 1.187328, loss_d: 0.478392
0.7031 --- loss: 1.581738, loss_ss: 1.197306, loss_d: 0.384432
0.7812 --- loss: 1.637615, loss_ss: 1.323603, loss_d: 0.314012
0.8594 --- loss: 1.882065, loss_ss: 1.124896, loss_d: 0.757168
0.9375 --- loss: 1.664829, loss_ss: 1.306404, loss_d: 0.358425
Epoch finished! Loss: 1.6572971015464601
Starting epoch 3/10.
0.0000 --- loss: 1.463748, loss_ss: 1.148538, loss_d: 0.315210
0.0781 --- loss: 1.743177, loss_ss: 1.031416, loss_d: 0.711761
0.1562 --- loss: 1.404537, loss_ss: 1.039090, loss_d: 0.365447
0.2344 --- loss: 1.617818, loss_ss: 1.241604, loss_d: 0.376214
0.3125 --- loss: 1.224802, loss_ss: 1.020911, loss_d: 0.203891
0.3906 --- loss: 2.453869, loss_ss: 1.033063, loss_d: 1.420806
0.4688 --- loss: 1.090812, loss_ss: 1.010467, loss_d: 0.080345
0.5469 --- loss: 1.184094, loss_ss: 1.061098, loss_d: 0.122996
0.6250 --- loss: 1.265226, loss_ss: 1.080846, loss_d: 0.184380
0.7031 --- loss: 1.078478, loss_ss: 0.963361, loss_d: 0.115117
0.7812 --- loss: 1.526485, loss_ss: 1.121228, loss_d: 0.405257
0.8594 --- loss: 1.318177, loss_ss: 0.987397, loss_d: 0.330780
0.9375 --- loss: 1.378870, loss_ss: 1.104457, loss_d: 0.274413
Epoch finished! Loss: 1.4073830936837384
Starting epoch 4/10.
0.0000 --- loss: 1.149153, loss_ss: 1.033151, loss_d: 0.116002
0.0781 --- loss: 1.279069, loss_ss: 0.920638, loss_d: 0.358431
0.1562 --- loss: 1.654551, loss_ss: 1.117768, loss_d: 0.536784
0.2344 --- loss: 1.204817, loss_ss: 1.101730, loss_d: 0.103087
0.3125 --- loss: 1.581967, loss_ss: 1.216971, loss_d: 0.364997
0.3906 --- loss: 0.998446, loss_ss: 0.913171, loss_d: 0.085275
0.4688 --- loss: 1.096853, loss_ss: 0.944207, loss_d: 0.152646
0.5469 --- loss: 1.353840, loss_ss: 0.982361, loss_d: 0.371478
0.6250 --- loss: 1.316965, loss_ss: 1.119963, loss_d: 0.197002
0.7031 --- loss: 1.958666, loss_ss: 0.969300, loss_d: 0.989365
0.7812 --- loss: 1.241008, loss_ss: 1.067533, loss_d: 0.173475
0.8594 --- loss: 1.399997, loss_ss: 0.918779, loss_d: 0.481218
0.9375 --- loss: 0.996690, loss_ss: 0.806126, loss_d: 0.190564
Epoch finished! Loss: 1.307731238406474
Starting epoch 5/10.
0.0000 --- loss: 1.016459, loss_ss: 0.859240, loss_d: 0.157219
0.0781 --- loss: 0.930144, loss_ss: 0.893770, loss_d: 0.036374
0.1562 --- loss: 1.370872, loss_ss: 0.814958, loss_d: 0.555913
0.2344 --- loss: 1.380816, loss_ss: 0.940401, loss_d: 0.440415
0.3125 --- loss: 1.275900, loss_ss: 0.939903, loss_d: 0.335997
0.3906 --- loss: 1.116714, loss_ss: 1.057841, loss_d: 0.058873
0.4688 --- loss: 1.187367, loss_ss: 0.891725, loss_d: 0.295643
0.5469 --- loss: 1.331340, loss_ss: 1.003041, loss_d: 0.328300
0.6250 --- loss: 1.175798, loss_ss: 1.134717, loss_d: 0.041080
0.7031 --- loss: 0.937446, loss_ss: 0.846846, loss_d: 0.090600
0.7812 --- loss: 1.278291, loss_ss: 1.097930, loss_d: 0.180361
0.8594 --- loss: 1.003761, loss_ss: 0.955710, loss_d: 0.048051
0.9375 --- loss: 1.160887, loss_ss: 0.978148, loss_d: 0.182740
Epoch finished! Loss: 1.1743203655002623
Starting epoch 6/10.
0.0000 --- loss: 1.335429, loss_ss: 1.014466, loss_d: 0.320963
0.0781 --- loss: 0.883109, loss_ss: 0.790892, loss_d: 0.092217
0.1562 --- loss: 0.969596, loss_ss: 0.872833, loss_d: 0.096764
0.2344 --- loss: 1.063765, loss_ss: 0.900597, loss_d: 0.163168
0.3125 --- loss: 1.056430, loss_ss: 0.748754, loss_d: 0.307676
0.3906 --- loss: 1.441911, loss_ss: 0.845816, loss_d: 0.596095
0.4688 --- loss: 1.055346, loss_ss: 0.966956, loss_d: 0.088390
0.5469 --- loss: 1.184247, loss_ss: 0.926960, loss_d: 0.257287
0.6250 --- loss: 1.419673, loss_ss: 1.095088, loss_d: 0.324585
0.7031 --- loss: 1.442526, loss_ss: 0.874801, loss_d: 0.567725
0.7812 --- loss: 0.902013, loss_ss: 0.818768, loss_d: 0.083245
0.8594 --- loss: 0.886673, loss_ss: 0.839222, loss_d: 0.047452
0.9375 --- loss: 1.010286, loss_ss: 0.821092, loss_d: 0.189194
Epoch finished! Loss: 1.1410461908250342
Starting epoch 7/10.
0.0000 --- loss: 1.405266, loss_ss: 0.869222, loss_d: 0.536044
0.0781 --- loss: 1.188343, loss_ss: 1.038900, loss_d: 0.149443
0.1562 --- loss: 0.783143, loss_ss: 0.623226, loss_d: 0.159917
0.2344 --- loss: 0.984211, loss_ss: 0.949668, loss_d: 0.034543
0.3125 --- loss: 0.995090, loss_ss: 0.925993, loss_d: 0.069096
0.3906 --- loss: 0.828983, loss_ss: 0.714395, loss_d: 0.114588
0.4688 --- loss: 0.772744, loss_ss: 0.735145, loss_d: 0.037599
0.5469 --- loss: 1.142638, loss_ss: 0.934812, loss_d: 0.207826
0.6250 --- loss: 0.782609, loss_ss: 0.752831, loss_d: 0.029778
0.7031 --- loss: 1.218681, loss_ss: 0.812851, loss_d: 0.405831
0.7812 --- loss: 1.125097, loss_ss: 0.924322, loss_d: 0.200775
0.8594 --- loss: 0.832024, loss_ss: 0.810455, loss_d: 0.021569
0.9375 --- loss: 1.493196, loss_ss: 0.863857, loss_d: 0.629339
Epoch finished! Loss: 1.031106046804293
Starting epoch 8/10.
0.0000 --- loss: 1.278986, loss_ss: 1.224082, loss_d: 0.054904
0.0781 --- loss: 1.172530, loss_ss: 1.148918, loss_d: 0.023612
0.1562 --- loss: 0.687739, loss_ss: 0.668512, loss_d: 0.019227
0.2344 --- loss: 0.858328, loss_ss: 0.790704, loss_d: 0.067624
0.3125 --- loss: 0.935016, loss_ss: 0.882474, loss_d: 0.052542
0.3906 --- loss: 1.060905, loss_ss: 0.946685, loss_d: 0.114220
0.4688 --- loss: 0.862337, loss_ss: 0.835720, loss_d: 0.026617
0.5469 --- loss: 0.822716, loss_ss: 0.814866, loss_d: 0.007850
0.6250 --- loss: 0.984817, loss_ss: 0.827676, loss_d: 0.157141
0.7031 --- loss: 0.905802, loss_ss: 0.791301, loss_d: 0.114501
0.7812 --- loss: 1.075249, loss_ss: 0.996903, loss_d: 0.078346
0.8594 --- loss: 0.812278, loss_ss: 0.792061, loss_d: 0.020217
0.9375 --- loss: 0.955383, loss_ss: 0.895450, loss_d: 0.059933
Epoch finished! Loss: 0.975783204938483
Starting epoch 9/10.
0.0000 --- loss: 1.330619, loss_ss: 1.070481, loss_d: 0.260138
0.0781 --- loss: 1.061852, loss_ss: 0.943608, loss_d: 0.118244
0.1562 --- loss: 0.843942, loss_ss: 0.842416, loss_d: 0.001526
0.2344 --- loss: 1.222731, loss_ss: 0.983851, loss_d: 0.238880
0.3125 --- loss: 0.921921, loss_ss: 0.901855, loss_d: 0.020065
0.3906 --- loss: 0.707049, loss_ss: 0.641008, loss_d: 0.066041
0.4688 --- loss: 0.957743, loss_ss: 0.917440, loss_d: 0.040303
0.5469 --- loss: 1.041212, loss_ss: 1.022379, loss_d: 0.018833
0.6250 --- loss: 0.852147, loss_ss: 0.827839, loss_d: 0.024308
0.7031 --- loss: 1.227606, loss_ss: 0.876948, loss_d: 0.350658
0.7812 --- loss: 1.361420, loss_ss: 1.056830, loss_d: 0.304591
0.8594 --- loss: 0.918580, loss_ss: 0.791945, loss_d: 0.126634
0.9375 --- loss: 0.929859, loss_ss: 0.905941, loss_d: 0.023918
Epoch finished! Loss: 0.9753289799990617
Starting epoch 10/10.
0.0000 --- loss: 1.020624, loss_ss: 0.989506, loss_d: 0.031118
0.0781 --- loss: 0.806918, loss_ss: 0.783994, loss_d: 0.022924
0.1562 --- loss: 1.060475, loss_ss: 1.050726, loss_d: 0.009749
0.2344 --- loss: 0.768461, loss_ss: 0.735865, loss_d: 0.032596
0.3125 --- loss: 0.992660, loss_ss: 0.910027, loss_d: 0.082633
0.3906 --- loss: 0.770223, loss_ss: 0.765618, loss_d: 0.004606
0.4688 --- loss: 0.794277, loss_ss: 0.719217, loss_d: 0.075060
0.5469 --- loss: 0.937536, loss_ss: 0.925833, loss_d: 0.011703
0.6250 --- loss: 0.770910, loss_ss: 0.733494, loss_d: 0.037416
0.7031 --- loss: 1.404418, loss_ss: 1.217854, loss_d: 0.186565
0.7812 --- loss: 0.759399, loss_ss: 0.740595, loss_d: 0.018804
0.8594 --- loss: 0.990560, loss_ss: 0.915409, loss_d: 0.075151
0.9375 --- loss: 0.899803, loss_ss: 0.868919, loss_d: 0.030884
Epoch finished! Loss: 0.9435178473239808
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.47039199332777315
             precision    recall  f1-score   support

        0.0       0.68      0.77      0.72       350
        1.0       0.37      0.24      0.29       204
        2.0       0.44      0.42      0.43       346
        3.0       0.80      0.02      0.04       179
        4.0       0.29      0.81      0.42       120

avg / total       0.54      0.47      0.43      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.82  77.43   85.04  68.09     72.46
1  80.15  23.53   91.76  36.92     28.74
2  67.81  41.62   78.43  43.90     42.73
3  85.32   2.23   99.90  80.00      4.35
4  77.98  80.83   77.66  28.70     42.36
Total accuracy: 47.04%
Average sen: 45.13%
Average spec: 86.56%
Macro f1-score: 38.13%
Diagnosis acc on 30mins: 1.0
[0.99999917 0.99975175 0.99988115 0.99999726 0.99999404 0.99990511
 0.99961865 0.99999654 0.99990392 0.99980193 0.99994755 0.99990106
 0.99978274 0.99971646 0.99999785 0.99995995 0.99999917 0.99996603
 0.99974161 0.99999988]
pred: 0.9998930901288986, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp030-nsrr

=== Test on chp031-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.269814, loss_ss: 1.549855, loss_d: 0.719959
0.0780 --- loss: 1.964998, loss_ss: 1.491683, loss_d: 0.473315
0.1560 --- loss: 2.019416, loss_ss: 1.510211, loss_d: 0.509205
0.2340 --- loss: 1.931739, loss_ss: 1.547256, loss_d: 0.384483
0.3120 --- loss: 2.261030, loss_ss: 1.512342, loss_d: 0.748688
0.3900 --- loss: 2.132734, loss_ss: 1.517738, loss_d: 0.614995
0.4680 --- loss: 1.719392, loss_ss: 1.305469, loss_d: 0.413923
0.5460 --- loss: 2.159577, loss_ss: 1.423001, loss_d: 0.736576
0.6240 --- loss: 1.936106, loss_ss: 1.446637, loss_d: 0.489470
0.7020 --- loss: 2.205220, loss_ss: 1.319279, loss_d: 0.885941
0.7800 --- loss: 2.028550, loss_ss: 1.387961, loss_d: 0.640589
0.8580 --- loss: 2.060134, loss_ss: 1.433968, loss_d: 0.626166
0.9360 --- loss: 1.851038, loss_ss: 1.351653, loss_d: 0.499385
Epoch finished! Loss: 2.0285044191405177
Starting epoch 2/10.
0.0000 --- loss: 1.714348, loss_ss: 1.237411, loss_d: 0.476937
0.0780 --- loss: 1.583466, loss_ss: 1.340380, loss_d: 0.243085
0.1560 --- loss: 1.851131, loss_ss: 1.291773, loss_d: 0.559358
0.2340 --- loss: 1.685606, loss_ss: 1.282425, loss_d: 0.403181
0.3120 --- loss: 1.822878, loss_ss: 1.197796, loss_d: 0.625083
0.3900 --- loss: 1.459967, loss_ss: 1.216915, loss_d: 0.243053
0.4680 --- loss: 1.871083, loss_ss: 1.315884, loss_d: 0.555200
0.5460 --- loss: 1.786748, loss_ss: 1.300655, loss_d: 0.486093
0.6240 --- loss: 1.755958, loss_ss: 1.356316, loss_d: 0.399642
0.7020 --- loss: 1.805915, loss_ss: 1.491796, loss_d: 0.314119
0.7800 --- loss: 1.433905, loss_ss: 1.197631, loss_d: 0.236274
0.8580 --- loss: 1.803725, loss_ss: 1.189939, loss_d: 0.613786
0.9360 --- loss: 1.531951, loss_ss: 1.316149, loss_d: 0.215802
Epoch finished! Loss: 1.7664059707894921
Starting epoch 3/10.
0.0000 --- loss: 1.785406, loss_ss: 1.303935, loss_d: 0.481470
0.0780 --- loss: 1.441810, loss_ss: 1.152891, loss_d: 0.288920
0.1560 --- loss: 1.712248, loss_ss: 1.147634, loss_d: 0.564614
0.2340 --- loss: 1.306590, loss_ss: 1.204080, loss_d: 0.102510
0.3120 --- loss: 1.689334, loss_ss: 1.290376, loss_d: 0.398958
0.3900 --- loss: 1.378544, loss_ss: 1.184784, loss_d: 0.193761
0.4680 --- loss: 1.314869, loss_ss: 1.235568, loss_d: 0.079301
0.5460 --- loss: 1.389047, loss_ss: 1.232317, loss_d: 0.156730
0.6240 --- loss: 1.477287, loss_ss: 1.133050, loss_d: 0.344237
0.7020 --- loss: 1.397691, loss_ss: 1.122704, loss_d: 0.274987
0.7800 --- loss: 1.538816, loss_ss: 1.082955, loss_d: 0.455861
0.8580 --- loss: 1.457025, loss_ss: 1.212406, loss_d: 0.244619
0.9360 --- loss: 1.189004, loss_ss: 1.122670, loss_d: 0.066333
Epoch finished! Loss: 1.5084530720487237
Starting epoch 4/10.
0.0000 --- loss: 1.459828, loss_ss: 1.108640, loss_d: 0.351188
0.0780 --- loss: 1.722089, loss_ss: 1.031406, loss_d: 0.690683
0.1560 --- loss: 1.449328, loss_ss: 1.233835, loss_d: 0.215492
0.2340 --- loss: 1.546538, loss_ss: 1.207605, loss_d: 0.338932
0.3120 --- loss: 1.241203, loss_ss: 1.199659, loss_d: 0.041544
0.3900 --- loss: 1.204046, loss_ss: 1.104340, loss_d: 0.099705
0.4680 --- loss: 1.313232, loss_ss: 1.112345, loss_d: 0.200887
0.5460 --- loss: 1.226185, loss_ss: 1.156101, loss_d: 0.070084
0.6240 --- loss: 1.190274, loss_ss: 1.050014, loss_d: 0.140260
0.7020 --- loss: 1.382610, loss_ss: 1.028858, loss_d: 0.353752
0.7800 --- loss: 1.489516, loss_ss: 1.118290, loss_d: 0.371226
0.8580 --- loss: 1.287708, loss_ss: 1.202506, loss_d: 0.085202
0.9360 --- loss: 1.246895, loss_ss: 0.974135, loss_d: 0.272759
Epoch finished! Loss: 1.3722036108374596
Starting epoch 5/10.
0.0000 --- loss: 1.463905, loss_ss: 1.187160, loss_d: 0.276745
0.0780 --- loss: 1.469749, loss_ss: 1.171559, loss_d: 0.298190
0.1560 --- loss: 1.206264, loss_ss: 1.107735, loss_d: 0.098529
0.2340 --- loss: 1.226193, loss_ss: 1.087497, loss_d: 0.138696
0.3120 --- loss: 1.016539, loss_ss: 0.910192, loss_d: 0.106347
0.3900 --- loss: 1.224610, loss_ss: 1.054850, loss_d: 0.169760
0.4680 --- loss: 1.159006, loss_ss: 1.052268, loss_d: 0.106738
0.5460 --- loss: 1.229336, loss_ss: 1.124430, loss_d: 0.104906
0.6240 --- loss: 1.082228, loss_ss: 1.043843, loss_d: 0.038385
0.7020 --- loss: 1.293307, loss_ss: 1.080667, loss_d: 0.212640
0.7800 --- loss: 1.514506, loss_ss: 1.060246, loss_d: 0.454261
0.8580 --- loss: 1.040681, loss_ss: 1.015447, loss_d: 0.025234
0.9360 --- loss: 1.708956, loss_ss: 1.005397, loss_d: 0.703559
Epoch finished! Loss: 1.2560738204047084
Starting epoch 6/10.
0.0000 --- loss: 1.098912, loss_ss: 1.018230, loss_d: 0.080681
0.0780 --- loss: 1.363265, loss_ss: 1.298616, loss_d: 0.064649
0.1560 --- loss: 1.190459, loss_ss: 1.143963, loss_d: 0.046496
0.2340 --- loss: 1.121691, loss_ss: 1.063651, loss_d: 0.058039
0.3120 --- loss: 1.660274, loss_ss: 0.837452, loss_d: 0.822821
0.3900 --- loss: 1.903835, loss_ss: 1.514018, loss_d: 0.389817
0.4680 --- loss: 1.513094, loss_ss: 1.115650, loss_d: 0.397444
0.5460 --- loss: 1.033456, loss_ss: 0.893326, loss_d: 0.140130
0.6240 --- loss: 1.023182, loss_ss: 1.002941, loss_d: 0.020241
0.7020 --- loss: 0.990717, loss_ss: 0.837582, loss_d: 0.153134
0.7800 --- loss: 0.910751, loss_ss: 0.822289, loss_d: 0.088461
0.8580 --- loss: 0.912915, loss_ss: 0.907911, loss_d: 0.005005
0.9360 --- loss: 1.078114, loss_ss: 0.936569, loss_d: 0.141544
Epoch finished! Loss: 1.172678990289569
Starting epoch 7/10.
0.0000 --- loss: 1.290346, loss_ss: 0.944875, loss_d: 0.345471
0.0780 --- loss: 0.876875, loss_ss: 0.855634, loss_d: 0.021241
0.1560 --- loss: 1.022893, loss_ss: 1.014975, loss_d: 0.007918
0.2340 --- loss: 0.898162, loss_ss: 0.878516, loss_d: 0.019646
0.3120 --- loss: 1.177292, loss_ss: 1.072741, loss_d: 0.104552
0.3900 --- loss: 0.853129, loss_ss: 0.840958, loss_d: 0.012170
0.4680 --- loss: 1.205721, loss_ss: 1.039199, loss_d: 0.166522
0.5460 --- loss: 0.865024, loss_ss: 0.842135, loss_d: 0.022888
0.6240 --- loss: 1.497346, loss_ss: 1.001914, loss_d: 0.495433
0.7020 --- loss: 0.957254, loss_ss: 0.795397, loss_d: 0.161857
0.7800 --- loss: 1.103176, loss_ss: 1.082147, loss_d: 0.021029
0.8580 --- loss: 1.030042, loss_ss: 0.900515, loss_d: 0.129527
0.9360 --- loss: 1.168761, loss_ss: 1.091296, loss_d: 0.077465
Epoch finished! Loss: 1.1280034128576517
Starting epoch 8/10.
0.0000 --- loss: 0.868711, loss_ss: 0.779251, loss_d: 0.089461
0.0780 --- loss: 0.899876, loss_ss: 0.847280, loss_d: 0.052596
0.1560 --- loss: 1.433664, loss_ss: 1.111278, loss_d: 0.322386
0.2340 --- loss: 0.955864, loss_ss: 0.883723, loss_d: 0.072141
0.3120 --- loss: 1.147605, loss_ss: 0.959300, loss_d: 0.188305
0.3900 --- loss: 0.987747, loss_ss: 0.777142, loss_d: 0.210605
0.4680 --- loss: 0.995712, loss_ss: 0.931970, loss_d: 0.063742
0.5460 --- loss: 1.048225, loss_ss: 0.822279, loss_d: 0.225946
0.6240 --- loss: 0.814243, loss_ss: 0.806485, loss_d: 0.007758
0.7020 --- loss: 1.006029, loss_ss: 0.967663, loss_d: 0.038366
0.7800 --- loss: 1.185968, loss_ss: 1.073272, loss_d: 0.112696
0.8580 --- loss: 0.936827, loss_ss: 0.931575, loss_d: 0.005251
0.9360 --- loss: 1.283827, loss_ss: 1.264497, loss_d: 0.019331
Epoch finished! Loss: 1.0484732049517334
Starting epoch 9/10.
0.0000 --- loss: 2.077483, loss_ss: 0.942768, loss_d: 1.134716
0.0780 --- loss: 1.064222, loss_ss: 1.057095, loss_d: 0.007127
0.1560 --- loss: 1.070643, loss_ss: 0.846642, loss_d: 0.224000
0.2340 --- loss: 1.130243, loss_ss: 0.889129, loss_d: 0.241114
0.3120 --- loss: 0.959375, loss_ss: 0.943422, loss_d: 0.015953
0.3900 --- loss: 0.874868, loss_ss: 0.867370, loss_d: 0.007497
0.4680 --- loss: 1.101001, loss_ss: 1.097281, loss_d: 0.003720
0.5460 --- loss: 1.629972, loss_ss: 1.066075, loss_d: 0.563897
0.6240 --- loss: 1.053556, loss_ss: 0.971401, loss_d: 0.082155
0.7020 --- loss: 0.911348, loss_ss: 0.857017, loss_d: 0.054331
0.7800 --- loss: 1.241560, loss_ss: 1.238187, loss_d: 0.003372
0.8580 --- loss: 1.139972, loss_ss: 1.031726, loss_d: 0.108246
0.9360 --- loss: 0.990176, loss_ss: 0.987525, loss_d: 0.002651
Epoch finished! Loss: 1.0328884022310376
Starting epoch 10/10.
0.0000 --- loss: 1.019770, loss_ss: 1.016164, loss_d: 0.003606
0.0780 --- loss: 0.794296, loss_ss: 0.783646, loss_d: 0.010650
0.1560 --- loss: 1.107259, loss_ss: 0.887400, loss_d: 0.219859
0.2340 --- loss: 0.840501, loss_ss: 0.835037, loss_d: 0.005464
0.3120 --- loss: 0.760293, loss_ss: 0.756782, loss_d: 0.003512
0.3900 --- loss: 1.014455, loss_ss: 1.001657, loss_d: 0.012798
0.4680 --- loss: 1.023713, loss_ss: 0.987883, loss_d: 0.035830
0.5460 --- loss: 0.921481, loss_ss: 0.890052, loss_d: 0.031429
0.6240 --- loss: 0.893050, loss_ss: 0.835964, loss_d: 0.057086
0.7020 --- loss: 0.842365, loss_ss: 0.837975, loss_d: 0.004391
0.7800 --- loss: 0.997121, loss_ss: 0.975376, loss_d: 0.021745
0.8580 --- loss: 0.739000, loss_ss: 0.669988, loss_d: 0.069012
0.9360 --- loss: 0.785648, loss_ss: 0.783208, loss_d: 0.002440
Epoch finished! Loss: 0.9748175353743136
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5564814814814815
             precision    recall  f1-score   support

        0.0       0.25      0.65      0.36        51
        1.0       0.08      0.29      0.12        48
        2.0       0.58      0.83      0.68       309
        3.0       1.00      0.47      0.64       229
        4.0       0.90      0.42      0.58       443

avg / total       0.76      0.56      0.59      1080
 


====== chp031-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.98  64.71   90.18   24.63     35.68
1  81.20  29.17   83.62    7.65     12.12
2  77.87  83.50   75.62   57.85     68.34
3  88.80  47.16  100.00  100.00     64.09
4  74.44  42.44   96.70   89.95     57.67
Total accuracy: 55.65%
Average sen: 53.39%
Average spec: 89.23%
Macro f1-score: 47.58%
Diagnosis acc on 30mins: 1.0
[0.99848855 0.99999166 0.9985078  0.99783009 0.99979395 0.99816328
 0.99976104 0.99963892 0.99817216 0.99995649 0.8871029  0.99941015
 0.99989843 0.99994957 0.99994993 0.99978381 0.98665893 0.99960977]
pred: 0.9923704134093391, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp031-nsrr

=== Test on chp032-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.583723, loss_ss: 1.880976, loss_d: 0.702747
0.0779 --- loss: 2.567924, loss_ss: 1.554806, loss_d: 1.013118
0.1559 --- loss: 2.091243, loss_ss: 1.600784, loss_d: 0.490459
0.2338 --- loss: 1.940452, loss_ss: 1.496866, loss_d: 0.443586
0.3118 --- loss: 2.021825, loss_ss: 1.389480, loss_d: 0.632346
0.3897 --- loss: 1.956155, loss_ss: 1.433471, loss_d: 0.522684
0.4677 --- loss: 2.089531, loss_ss: 1.387606, loss_d: 0.701926
0.5456 --- loss: 2.338145, loss_ss: 1.353663, loss_d: 0.984482
0.6235 --- loss: 2.070491, loss_ss: 1.435160, loss_d: 0.635331
0.7015 --- loss: 1.865695, loss_ss: 1.225563, loss_d: 0.640132
0.7794 --- loss: 2.012303, loss_ss: 1.414191, loss_d: 0.598112
0.8574 --- loss: 2.113701, loss_ss: 1.417372, loss_d: 0.696328
0.9353 --- loss: 1.796866, loss_ss: 1.188472, loss_d: 0.608395
Epoch finished! Loss: 2.0294636972248554
Starting epoch 2/10.
0.0000 --- loss: 1.882257, loss_ss: 1.244137, loss_d: 0.638119
0.0779 --- loss: 1.694207, loss_ss: 1.220820, loss_d: 0.473387
0.1559 --- loss: 1.613518, loss_ss: 1.281030, loss_d: 0.332488
0.2338 --- loss: 1.920167, loss_ss: 1.250848, loss_d: 0.669319
0.3118 --- loss: 1.680714, loss_ss: 1.358295, loss_d: 0.322419
0.3897 --- loss: 1.459016, loss_ss: 1.109260, loss_d: 0.349757
0.4677 --- loss: 1.492243, loss_ss: 1.064882, loss_d: 0.427361
0.5456 --- loss: 2.151726, loss_ss: 1.301346, loss_d: 0.850380
0.6235 --- loss: 1.619146, loss_ss: 1.318378, loss_d: 0.300768
0.7015 --- loss: 1.435729, loss_ss: 1.106018, loss_d: 0.329711
0.7794 --- loss: 1.836381, loss_ss: 1.270691, loss_d: 0.565690
0.8574 --- loss: 1.369005, loss_ss: 1.176637, loss_d: 0.192367
0.9353 --- loss: 1.294451, loss_ss: 1.173925, loss_d: 0.120526
Epoch finished! Loss: 1.672180775552988
Starting epoch 3/10.
0.0000 --- loss: 1.738290, loss_ss: 1.255752, loss_d: 0.482538
0.0779 --- loss: 1.428321, loss_ss: 1.046150, loss_d: 0.382171
0.1559 --- loss: 1.347553, loss_ss: 1.212418, loss_d: 0.135135
0.2338 --- loss: 1.460098, loss_ss: 1.306787, loss_d: 0.153311
0.3118 --- loss: 1.432484, loss_ss: 1.008986, loss_d: 0.423499
0.3897 --- loss: 1.698162, loss_ss: 1.006864, loss_d: 0.691298
0.4677 --- loss: 1.345703, loss_ss: 1.091042, loss_d: 0.254661
0.5456 --- loss: 1.946630, loss_ss: 1.280942, loss_d: 0.665689
0.6235 --- loss: 1.198036, loss_ss: 1.113536, loss_d: 0.084500
0.7015 --- loss: 1.533069, loss_ss: 1.160791, loss_d: 0.372277
0.7794 --- loss: 1.772367, loss_ss: 1.187166, loss_d: 0.585201
0.8574 --- loss: 1.178397, loss_ss: 0.989520, loss_d: 0.188877
0.9353 --- loss: 1.414381, loss_ss: 1.132995, loss_d: 0.281387
Epoch finished! Loss: 1.4776017712429166
Starting epoch 4/10.
0.0000 --- loss: 1.505279, loss_ss: 1.150174, loss_d: 0.355104
0.0779 --- loss: 1.611008, loss_ss: 1.148934, loss_d: 0.462074
0.1559 --- loss: 1.190249, loss_ss: 0.983557, loss_d: 0.206691
0.2338 --- loss: 1.465282, loss_ss: 1.171976, loss_d: 0.293306
0.3118 --- loss: 1.345870, loss_ss: 1.169486, loss_d: 0.176384
0.3897 --- loss: 1.095254, loss_ss: 1.039935, loss_d: 0.055318
0.4677 --- loss: 0.988764, loss_ss: 0.949998, loss_d: 0.038766
0.5456 --- loss: 1.428280, loss_ss: 1.103158, loss_d: 0.325123
0.6235 --- loss: 1.148283, loss_ss: 1.109290, loss_d: 0.038993
0.7015 --- loss: 1.019222, loss_ss: 0.918210, loss_d: 0.101011
0.7794 --- loss: 1.763741, loss_ss: 1.093429, loss_d: 0.670311
0.8574 --- loss: 1.021635, loss_ss: 0.961858, loss_d: 0.059778
0.9353 --- loss: 1.260548, loss_ss: 1.155781, loss_d: 0.104767
Epoch finished! Loss: 1.3275489769876003
Starting epoch 5/10.
0.0000 --- loss: 1.405652, loss_ss: 1.096881, loss_d: 0.308771
0.0779 --- loss: 1.450155, loss_ss: 1.259304, loss_d: 0.190851
0.1559 --- loss: 1.286576, loss_ss: 1.026703, loss_d: 0.259873
0.2338 --- loss: 1.037868, loss_ss: 0.935500, loss_d: 0.102368
0.3118 --- loss: 1.014634, loss_ss: 0.832908, loss_d: 0.181725
0.3897 --- loss: 1.606476, loss_ss: 0.898787, loss_d: 0.707689
0.4677 --- loss: 1.095831, loss_ss: 1.028499, loss_d: 0.067332
0.5456 --- loss: 0.927945, loss_ss: 0.857273, loss_d: 0.070671
0.6235 --- loss: 1.244101, loss_ss: 1.023226, loss_d: 0.220874
0.7015 --- loss: 1.346252, loss_ss: 1.304966, loss_d: 0.041286
0.7794 --- loss: 1.386553, loss_ss: 1.067726, loss_d: 0.318826
0.8574 --- loss: 1.322581, loss_ss: 1.076795, loss_d: 0.245786
0.9353 --- loss: 1.004279, loss_ss: 0.869890, loss_d: 0.134389
Epoch finished! Loss: 1.2273250254802406
Starting epoch 6/10.
0.0000 --- loss: 1.047309, loss_ss: 0.903981, loss_d: 0.143329
0.0779 --- loss: 0.986749, loss_ss: 0.917949, loss_d: 0.068800
0.1559 --- loss: 1.467126, loss_ss: 1.125594, loss_d: 0.341532
0.2338 --- loss: 1.121203, loss_ss: 0.959898, loss_d: 0.161305
0.3118 --- loss: 0.857187, loss_ss: 0.815007, loss_d: 0.042180
0.3897 --- loss: 0.992593, loss_ss: 0.957577, loss_d: 0.035016
0.4677 --- loss: 1.169654, loss_ss: 1.049999, loss_d: 0.119655
0.5456 --- loss: 1.159686, loss_ss: 0.892248, loss_d: 0.267438
0.6235 --- loss: 1.053814, loss_ss: 0.978271, loss_d: 0.075543
0.7015 --- loss: 1.274502, loss_ss: 0.940059, loss_d: 0.334442
0.7794 --- loss: 1.025180, loss_ss: 0.888393, loss_d: 0.136787
0.8574 --- loss: 1.480563, loss_ss: 0.791031, loss_d: 0.689533
0.9353 --- loss: 1.032254, loss_ss: 0.812401, loss_d: 0.219854
Epoch finished! Loss: 1.1987207224592566
Starting epoch 7/10.
0.0000 --- loss: 1.050283, loss_ss: 0.953773, loss_d: 0.096510
0.0779 --- loss: 1.250158, loss_ss: 0.931128, loss_d: 0.319030
0.1559 --- loss: 1.225685, loss_ss: 1.160629, loss_d: 0.065056
0.2338 --- loss: 1.021016, loss_ss: 0.952007, loss_d: 0.069008
0.3118 --- loss: 0.789167, loss_ss: 0.757880, loss_d: 0.031286
0.3897 --- loss: 0.922193, loss_ss: 0.894345, loss_d: 0.027848
0.4677 --- loss: 1.199303, loss_ss: 0.884179, loss_d: 0.315124
0.5456 --- loss: 1.152796, loss_ss: 1.052549, loss_d: 0.100247
0.6235 --- loss: 1.143148, loss_ss: 0.981644, loss_d: 0.161504
0.7015 --- loss: 1.034180, loss_ss: 0.960246, loss_d: 0.073933
0.7794 --- loss: 0.950169, loss_ss: 0.938102, loss_d: 0.012067
0.8574 --- loss: 0.928911, loss_ss: 0.880249, loss_d: 0.048662
0.9353 --- loss: 1.168055, loss_ss: 1.034903, loss_d: 0.133152
Epoch finished! Loss: 1.087490763515234
Starting epoch 8/10.
0.0000 --- loss: 0.794819, loss_ss: 0.773723, loss_d: 0.021095
0.0779 --- loss: 0.900865, loss_ss: 0.827176, loss_d: 0.073689
0.1559 --- loss: 1.016658, loss_ss: 0.893742, loss_d: 0.122916
0.2338 --- loss: 0.849012, loss_ss: 0.805449, loss_d: 0.043563
0.3118 --- loss: 1.038126, loss_ss: 1.014899, loss_d: 0.023227
0.3897 --- loss: 1.085200, loss_ss: 1.080718, loss_d: 0.004481
0.4677 --- loss: 0.863360, loss_ss: 0.814285, loss_d: 0.049076
0.5456 --- loss: 0.762218, loss_ss: 0.729556, loss_d: 0.032662
0.6235 --- loss: 0.907022, loss_ss: 0.882878, loss_d: 0.024144
0.7015 --- loss: 1.041946, loss_ss: 1.009118, loss_d: 0.032827
0.7794 --- loss: 1.255148, loss_ss: 0.997264, loss_d: 0.257884
0.8574 --- loss: 1.051701, loss_ss: 0.987118, loss_d: 0.064583
0.9353 --- loss: 0.815289, loss_ss: 0.718605, loss_d: 0.096684
Epoch finished! Loss: 1.0539199579507113
Starting epoch 9/10.
0.0000 --- loss: 0.973319, loss_ss: 0.934201, loss_d: 0.039119
0.0779 --- loss: 0.906875, loss_ss: 0.899683, loss_d: 0.007192
0.1559 --- loss: 0.932153, loss_ss: 0.919190, loss_d: 0.012963
0.2338 --- loss: 0.833449, loss_ss: 0.765596, loss_d: 0.067854
0.3118 --- loss: 0.781037, loss_ss: 0.774176, loss_d: 0.006860
0.3897 --- loss: 1.069220, loss_ss: 1.022741, loss_d: 0.046479
0.4677 --- loss: 0.882891, loss_ss: 0.877271, loss_d: 0.005620
0.5456 --- loss: 0.721040, loss_ss: 0.716195, loss_d: 0.004845
0.6235 --- loss: 1.239545, loss_ss: 1.063466, loss_d: 0.176079
0.7015 --- loss: 1.158769, loss_ss: 1.147144, loss_d: 0.011625
0.7794 --- loss: 0.851801, loss_ss: 0.850187, loss_d: 0.001614
0.8574 --- loss: 0.877895, loss_ss: 0.874923, loss_d: 0.002973
0.9353 --- loss: 0.798445, loss_ss: 0.652889, loss_d: 0.145556
Epoch finished! Loss: 0.976481856778264
Starting epoch 10/10.
0.0000 --- loss: 1.050505, loss_ss: 1.028086, loss_d: 0.022419
0.0779 --- loss: 1.165586, loss_ss: 1.037680, loss_d: 0.127906
0.1559 --- loss: 1.317399, loss_ss: 0.798958, loss_d: 0.518442
0.2338 --- loss: 0.903731, loss_ss: 0.894007, loss_d: 0.009724
0.3118 --- loss: 0.956876, loss_ss: 0.910249, loss_d: 0.046627
0.3897 --- loss: 1.167067, loss_ss: 1.165200, loss_d: 0.001868
0.4677 --- loss: 0.835744, loss_ss: 0.832379, loss_d: 0.003364
0.5456 --- loss: 1.005609, loss_ss: 0.845387, loss_d: 0.160223
0.6235 --- loss: 1.077428, loss_ss: 1.045070, loss_d: 0.032358
0.7015 --- loss: 0.795336, loss_ss: 0.750063, loss_d: 0.045273
0.7794 --- loss: 0.996234, loss_ss: 0.934745, loss_d: 0.061489
0.8574 --- loss: 0.925314, loss_ss: 0.918971, loss_d: 0.006343
0.9353 --- loss: 0.857365, loss_ss: 0.847285, loss_d: 0.010079
Epoch finished! Loss: 1.013086248189211
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7196078431372549
             precision    recall  f1-score   support

        0.0       0.90      0.38      0.54        47
        1.0       0.28      0.26      0.27       108
        2.0       0.90      0.76      0.82       486
        3.0       1.00      0.73      0.85       150
        4.0       0.55      0.91      0.69       229

avg / total       0.77      0.72      0.72      1020
 


====== chp032-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.96  38.30   99.79   90.00     53.73
1  85.10  25.93   92.11   28.00     26.92
2  84.51  76.13   92.13   89.81     82.41
3  96.08  73.33  100.00  100.00     84.62
4  81.27  90.83   78.51   55.03     68.53
Total accuracy: 71.96%
Average sen: 60.90%
Average spec: 92.51%
Macro f1-score: 63.24%
Diagnosis acc on 30mins: 1.0
[0.91645151 0.91890496 0.9931798  0.52101117 0.99966943 0.96611017
 0.98912209 0.97766066 0.54391468 0.99995434 0.99974316 0.99987245
 0.9965384  0.99625731 0.97581953 0.999964   0.99977189]
pred: 0.9290556206422693, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp032-nsrr

=== Test on chp033-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.332566, loss_ss: 1.639863, loss_d: 0.692703
0.0779 --- loss: 2.162841, loss_ss: 1.533318, loss_d: 0.629523
0.1558 --- loss: 1.909966, loss_ss: 1.519457, loss_d: 0.390510
0.2336 --- loss: 2.418798, loss_ss: 1.525626, loss_d: 0.893171
0.3115 --- loss: 1.910432, loss_ss: 1.518060, loss_d: 0.392372
0.3894 --- loss: 2.158306, loss_ss: 1.429288, loss_d: 0.729018
0.4673 --- loss: 2.263466, loss_ss: 1.439929, loss_d: 0.823537
0.5452 --- loss: 1.954321, loss_ss: 1.444476, loss_d: 0.509845
0.6231 --- loss: 1.771411, loss_ss: 1.392980, loss_d: 0.378431
0.7009 --- loss: 1.881467, loss_ss: 1.383693, loss_d: 0.497773
0.7788 --- loss: 2.392669, loss_ss: 1.275552, loss_d: 1.117117
0.8567 --- loss: 1.735842, loss_ss: 1.295761, loss_d: 0.440082
0.9346 --- loss: 1.860801, loss_ss: 1.258078, loss_d: 0.602723
Epoch finished! Loss: 1.9983210200443864
Starting epoch 2/10.
0.0000 --- loss: 1.656030, loss_ss: 1.240380, loss_d: 0.415650
0.0779 --- loss: 1.625380, loss_ss: 1.199688, loss_d: 0.425692
0.1558 --- loss: 2.000768, loss_ss: 1.217565, loss_d: 0.783203
0.2336 --- loss: 1.653468, loss_ss: 1.223187, loss_d: 0.430280
0.3115 --- loss: 1.711786, loss_ss: 1.283313, loss_d: 0.428472
0.3894 --- loss: 1.707109, loss_ss: 1.034923, loss_d: 0.672187
0.4673 --- loss: 1.555292, loss_ss: 1.280176, loss_d: 0.275116
0.5452 --- loss: 1.741700, loss_ss: 1.110607, loss_d: 0.631093
0.6231 --- loss: 1.692326, loss_ss: 1.186846, loss_d: 0.505480
0.7009 --- loss: 1.852571, loss_ss: 1.047022, loss_d: 0.805549
0.7788 --- loss: 1.439724, loss_ss: 1.135596, loss_d: 0.304129
0.8567 --- loss: 1.574247, loss_ss: 1.248542, loss_d: 0.325705
0.9346 --- loss: 1.495907, loss_ss: 1.208550, loss_d: 0.287357
Epoch finished! Loss: 1.615044241771102
Starting epoch 3/10.
0.0000 --- loss: 1.759659, loss_ss: 1.128963, loss_d: 0.630696
0.0779 --- loss: 1.532647, loss_ss: 1.173593, loss_d: 0.359054
0.1558 --- loss: 1.546747, loss_ss: 1.102528, loss_d: 0.444219
0.2336 --- loss: 1.427631, loss_ss: 1.118961, loss_d: 0.308671
0.3115 --- loss: 1.385861, loss_ss: 1.039162, loss_d: 0.346699
0.3894 --- loss: 1.108473, loss_ss: 0.982614, loss_d: 0.125858
0.4673 --- loss: 1.254632, loss_ss: 0.915772, loss_d: 0.338860
0.5452 --- loss: 1.364576, loss_ss: 1.273222, loss_d: 0.091353
0.6231 --- loss: 1.222759, loss_ss: 0.984187, loss_d: 0.238572
0.7009 --- loss: 1.283764, loss_ss: 1.056471, loss_d: 0.227294
0.7788 --- loss: 1.371733, loss_ss: 1.131576, loss_d: 0.240157
0.8567 --- loss: 1.302379, loss_ss: 1.000921, loss_d: 0.301458
0.9346 --- loss: 1.165088, loss_ss: 1.018687, loss_d: 0.146401
Epoch finished! Loss: 1.3795779766514897
Starting epoch 4/10.
0.0000 --- loss: 1.133421, loss_ss: 0.977464, loss_d: 0.155957
0.0779 --- loss: 1.065258, loss_ss: 0.916452, loss_d: 0.148806
0.1558 --- loss: 1.088306, loss_ss: 0.988491, loss_d: 0.099816
0.2336 --- loss: 1.122921, loss_ss: 0.865763, loss_d: 0.257157
0.3115 --- loss: 1.253185, loss_ss: 0.955347, loss_d: 0.297838
0.3894 --- loss: 1.174664, loss_ss: 0.947403, loss_d: 0.227261
0.4673 --- loss: 2.107562, loss_ss: 0.747473, loss_d: 1.360089
0.5452 --- loss: 1.553079, loss_ss: 1.211095, loss_d: 0.341984
0.6231 --- loss: 1.262298, loss_ss: 0.869479, loss_d: 0.392819
0.7009 --- loss: 1.224163, loss_ss: 1.055875, loss_d: 0.168288
0.7788 --- loss: 1.043135, loss_ss: 0.904677, loss_d: 0.138458
0.8567 --- loss: 1.257019, loss_ss: 0.974692, loss_d: 0.282328
0.9346 --- loss: 1.030340, loss_ss: 0.891114, loss_d: 0.139226
Epoch finished! Loss: 1.2420338713563979
Starting epoch 5/10.
0.0000 --- loss: 1.272808, loss_ss: 1.233916, loss_d: 0.038892
0.0779 --- loss: 1.321659, loss_ss: 0.987258, loss_d: 0.334401
0.1558 --- loss: 1.001004, loss_ss: 0.830258, loss_d: 0.170745
0.2336 --- loss: 0.966051, loss_ss: 0.869816, loss_d: 0.096236
0.3115 --- loss: 1.088204, loss_ss: 0.898585, loss_d: 0.189618
0.3894 --- loss: 1.245052, loss_ss: 1.134448, loss_d: 0.110604
0.4673 --- loss: 1.310153, loss_ss: 0.888529, loss_d: 0.421624
0.5452 --- loss: 1.202172, loss_ss: 0.901727, loss_d: 0.300445
0.6231 --- loss: 1.166568, loss_ss: 0.994684, loss_d: 0.171883
0.7009 --- loss: 1.151847, loss_ss: 0.885062, loss_d: 0.266785
0.7788 --- loss: 1.261998, loss_ss: 1.023839, loss_d: 0.238158
0.8567 --- loss: 0.965469, loss_ss: 0.903932, loss_d: 0.061537
0.9346 --- loss: 0.860783, loss_ss: 0.742200, loss_d: 0.118582
Epoch finished! Loss: 1.155424046330154
Starting epoch 6/10.
0.0000 --- loss: 0.789195, loss_ss: 0.746392, loss_d: 0.042804
0.0779 --- loss: 1.001478, loss_ss: 0.767974, loss_d: 0.233503
0.1558 --- loss: 1.035123, loss_ss: 0.967056, loss_d: 0.068067
0.2336 --- loss: 0.795253, loss_ss: 0.773279, loss_d: 0.021975
0.3115 --- loss: 0.899355, loss_ss: 0.790761, loss_d: 0.108594
0.3894 --- loss: 1.167433, loss_ss: 1.112753, loss_d: 0.054680
0.4673 --- loss: 1.407046, loss_ss: 1.063272, loss_d: 0.343774
0.5452 --- loss: 1.007227, loss_ss: 0.704671, loss_d: 0.302556
0.6231 --- loss: 1.068183, loss_ss: 0.689322, loss_d: 0.378861
0.7009 --- loss: 1.039746, loss_ss: 0.789253, loss_d: 0.250493
0.7788 --- loss: 0.755237, loss_ss: 0.637898, loss_d: 0.117339
0.8567 --- loss: 1.145174, loss_ss: 0.747331, loss_d: 0.397843
0.9346 --- loss: 1.028086, loss_ss: 0.855292, loss_d: 0.172794
Epoch finished! Loss: 1.0997440698556602
Starting epoch 7/10.
0.0000 --- loss: 1.450071, loss_ss: 1.368357, loss_d: 0.081715
0.0779 --- loss: 0.889030, loss_ss: 0.833434, loss_d: 0.055596
0.1558 --- loss: 1.193922, loss_ss: 0.750850, loss_d: 0.443072
0.2336 --- loss: 0.693670, loss_ss: 0.673154, loss_d: 0.020517
0.3115 --- loss: 0.901784, loss_ss: 0.730178, loss_d: 0.171606
0.3894 --- loss: 0.934617, loss_ss: 0.923858, loss_d: 0.010760
0.4673 --- loss: 0.867962, loss_ss: 0.795750, loss_d: 0.072212
0.5452 --- loss: 0.808562, loss_ss: 0.779766, loss_d: 0.028796
0.6231 --- loss: 1.029718, loss_ss: 0.929657, loss_d: 0.100061
0.7009 --- loss: 0.967604, loss_ss: 0.922020, loss_d: 0.045583
0.7788 --- loss: 1.020257, loss_ss: 0.972264, loss_d: 0.047994
0.8567 --- loss: 0.994259, loss_ss: 0.988361, loss_d: 0.005898
0.9346 --- loss: 1.092315, loss_ss: 0.899774, loss_d: 0.192541
Epoch finished! Loss: 0.972026374656707
Starting epoch 8/10.
0.0000 --- loss: 1.085579, loss_ss: 0.975794, loss_d: 0.109785
0.0779 --- loss: 0.743911, loss_ss: 0.639912, loss_d: 0.103999
0.1558 --- loss: 0.934583, loss_ss: 0.924386, loss_d: 0.010196
0.2336 --- loss: 1.394609, loss_ss: 0.956273, loss_d: 0.438337
0.3115 --- loss: 0.870468, loss_ss: 0.829395, loss_d: 0.041073
0.3894 --- loss: 0.940908, loss_ss: 0.841354, loss_d: 0.099553
0.4673 --- loss: 0.979438, loss_ss: 0.963724, loss_d: 0.015714
0.5452 --- loss: 1.036852, loss_ss: 0.814132, loss_d: 0.222720
0.6231 --- loss: 0.902160, loss_ss: 0.653608, loss_d: 0.248552
0.7009 --- loss: 0.972789, loss_ss: 0.950818, loss_d: 0.021971
0.7788 --- loss: 1.158888, loss_ss: 0.678036, loss_d: 0.480853
0.8567 --- loss: 0.871307, loss_ss: 0.860313, loss_d: 0.010994
0.9346 --- loss: 0.805069, loss_ss: 0.794693, loss_d: 0.010376
Epoch finished! Loss: 0.9723365106619895
Starting epoch 9/10.
0.0000 --- loss: 0.832476, loss_ss: 0.824621, loss_d: 0.007856
0.0779 --- loss: 0.881122, loss_ss: 0.706273, loss_d: 0.174849
0.1558 --- loss: 1.223406, loss_ss: 1.184753, loss_d: 0.038653
0.2336 --- loss: 1.033997, loss_ss: 0.877158, loss_d: 0.156839
0.3115 --- loss: 1.008659, loss_ss: 1.000141, loss_d: 0.008518
0.3894 --- loss: 0.903669, loss_ss: 0.777167, loss_d: 0.126502
0.4673 --- loss: 0.748318, loss_ss: 0.743565, loss_d: 0.004753
0.5452 --- loss: 1.141113, loss_ss: 0.922054, loss_d: 0.219060
0.6231 --- loss: 1.155021, loss_ss: 1.135916, loss_d: 0.019105
0.7009 --- loss: 0.701692, loss_ss: 0.663901, loss_d: 0.037792
0.7788 --- loss: 1.033739, loss_ss: 1.001552, loss_d: 0.032187
0.8567 --- loss: 1.496747, loss_ss: 0.919621, loss_d: 0.577126
0.9346 --- loss: 1.158617, loss_ss: 1.004863, loss_d: 0.153755
Epoch finished! Loss: 0.9513807976618409
Starting epoch 10/10.
0.0000 --- loss: 0.728001, loss_ss: 0.713547, loss_d: 0.014454
0.0779 --- loss: 0.765911, loss_ss: 0.738083, loss_d: 0.027828
0.1558 --- loss: 1.086395, loss_ss: 1.065410, loss_d: 0.020984
0.2336 --- loss: 0.893488, loss_ss: 0.879322, loss_d: 0.014166
0.3115 --- loss: 1.093017, loss_ss: 0.842418, loss_d: 0.250599
0.3894 --- loss: 1.379372, loss_ss: 0.926800, loss_d: 0.452572
0.4673 --- loss: 1.088022, loss_ss: 1.069086, loss_d: 0.018936
0.5452 --- loss: 0.919713, loss_ss: 0.881203, loss_d: 0.038510
0.6231 --- loss: 0.878022, loss_ss: 0.872744, loss_d: 0.005277
0.7009 --- loss: 0.869711, loss_ss: 0.853564, loss_d: 0.016146
0.7788 --- loss: 0.913473, loss_ss: 0.901287, loss_d: 0.012186
0.8567 --- loss: 1.017180, loss_ss: 0.973594, loss_d: 0.043587
0.9346 --- loss: 0.781106, loss_ss: 0.778669, loss_d: 0.002436
Epoch finished! Loss: 0.936516092158854
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6416666666666667
             precision    recall  f1-score   support

        0.0       0.28      0.72      0.40        32
        1.0       0.62      0.46      0.53       251
        2.0       0.59      0.74      0.65       208
        3.0       1.00      0.66      0.79       254
        4.0       0.60      0.73      0.66       215

avg / total       0.70      0.64      0.65       960
 


====== chp033-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.81  71.88   93.53   27.71     40.00
1  78.65  45.82   90.27   62.50     52.87
2  83.02  74.04   85.51   58.56     65.39
3  90.94  65.75  100.00  100.00     79.33
4  82.92  73.02   85.77   59.70     65.69
Total accuracy: 64.17%
Average sen: 66.10%
Average spec: 91.02%
Macro f1-score: 60.66%
Diagnosis acc on 30mins: 1.0
[0.99997616 0.99998033 0.99999762 0.99999893 0.9999975  0.99997115
 0.99997163 0.99996769 0.99998307 0.99994314 0.99994051 0.99996924
 0.99999511 0.99999952 0.99985588 0.99998534]
pred: 0.9999708011746407, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp033-nsrr

=== Test on chp034-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.340538, loss_ss: 1.552798, loss_d: 0.787740
0.0779 --- loss: 2.280754, loss_ss: 1.569166, loss_d: 0.711587
0.1559 --- loss: 2.401808, loss_ss: 1.464092, loss_d: 0.937717
0.2338 --- loss: 2.112832, loss_ss: 1.457661, loss_d: 0.655171
0.3118 --- loss: 1.972579, loss_ss: 1.513623, loss_d: 0.458956
0.3897 --- loss: 2.159467, loss_ss: 1.475062, loss_d: 0.684405
0.4677 --- loss: 2.130175, loss_ss: 1.378599, loss_d: 0.751576
0.5456 --- loss: 1.752258, loss_ss: 1.240028, loss_d: 0.512230
0.6235 --- loss: 1.809667, loss_ss: 1.274956, loss_d: 0.534711
0.7015 --- loss: 1.902406, loss_ss: 1.259570, loss_d: 0.642835
0.7794 --- loss: 1.864259, loss_ss: 1.302359, loss_d: 0.561900
0.8574 --- loss: 1.736544, loss_ss: 1.255830, loss_d: 0.480713
0.9353 --- loss: 1.643138, loss_ss: 1.317366, loss_d: 0.325772
Epoch finished! Loss: 1.9581348169595003
Starting epoch 2/10.
0.0000 --- loss: 1.769962, loss_ss: 1.206208, loss_d: 0.563754
0.0779 --- loss: 1.798440, loss_ss: 1.163139, loss_d: 0.635301
0.1559 --- loss: 1.343807, loss_ss: 1.085025, loss_d: 0.258781
0.2338 --- loss: 1.575528, loss_ss: 1.268926, loss_d: 0.306602
0.3118 --- loss: 1.345603, loss_ss: 1.062932, loss_d: 0.282671
0.3897 --- loss: 1.622372, loss_ss: 1.133777, loss_d: 0.488595
0.4677 --- loss: 1.927368, loss_ss: 1.253909, loss_d: 0.673458
0.5456 --- loss: 1.681907, loss_ss: 1.160544, loss_d: 0.521363
0.6235 --- loss: 1.375470, loss_ss: 1.120876, loss_d: 0.254594
0.7015 --- loss: 1.295615, loss_ss: 1.003575, loss_d: 0.292039
0.7794 --- loss: 1.141699, loss_ss: 1.070047, loss_d: 0.071651
0.8574 --- loss: 1.798151, loss_ss: 1.029548, loss_d: 0.768604
0.9353 --- loss: 1.374101, loss_ss: 1.128072, loss_d: 0.246029
Epoch finished! Loss: 1.554977159947157
Starting epoch 3/10.
0.0000 --- loss: 1.306029, loss_ss: 1.041864, loss_d: 0.264165
0.0779 --- loss: 1.144360, loss_ss: 0.995878, loss_d: 0.148481
0.1559 --- loss: 1.600821, loss_ss: 1.160184, loss_d: 0.440637
0.2338 --- loss: 1.287921, loss_ss: 1.077498, loss_d: 0.210424
0.3118 --- loss: 1.334393, loss_ss: 1.045155, loss_d: 0.289237
0.3897 --- loss: 1.223971, loss_ss: 0.954060, loss_d: 0.269912
0.4677 --- loss: 1.194521, loss_ss: 1.043484, loss_d: 0.151036
0.5456 --- loss: 1.408791, loss_ss: 0.901900, loss_d: 0.506891
0.6235 --- loss: 1.844794, loss_ss: 0.866171, loss_d: 0.978623
0.7015 --- loss: 1.454604, loss_ss: 1.135979, loss_d: 0.318625
0.7794 --- loss: 1.091815, loss_ss: 0.905212, loss_d: 0.186603
0.8574 --- loss: 1.899489, loss_ss: 0.946493, loss_d: 0.952996
0.9353 --- loss: 1.210146, loss_ss: 0.912883, loss_d: 0.297262
Epoch finished! Loss: 1.3825849904678762
Starting epoch 4/10.
0.0000 --- loss: 1.224802, loss_ss: 0.976637, loss_d: 0.248166
0.0779 --- loss: 1.178361, loss_ss: 0.954813, loss_d: 0.223548
0.1559 --- loss: 1.312392, loss_ss: 0.932234, loss_d: 0.380158
0.2338 --- loss: 1.244496, loss_ss: 1.067972, loss_d: 0.176524
0.3118 --- loss: 1.592030, loss_ss: 1.368736, loss_d: 0.223294
0.3897 --- loss: 1.217608, loss_ss: 0.842043, loss_d: 0.375565
0.4677 --- loss: 1.212269, loss_ss: 0.903212, loss_d: 0.309057
0.5456 --- loss: 1.147512, loss_ss: 0.910298, loss_d: 0.237213
0.6235 --- loss: 1.448711, loss_ss: 1.135075, loss_d: 0.313636
0.7015 --- loss: 1.711520, loss_ss: 1.113152, loss_d: 0.598368
0.7794 --- loss: 1.218302, loss_ss: 1.119935, loss_d: 0.098367
0.8574 --- loss: 1.132774, loss_ss: 1.018695, loss_d: 0.114079
0.9353 --- loss: 1.350518, loss_ss: 1.050339, loss_d: 0.300178
Epoch finished! Loss: 1.3028765302151442
Starting epoch 5/10.
0.0000 --- loss: 1.162025, loss_ss: 0.955775, loss_d: 0.206250
0.0779 --- loss: 1.025568, loss_ss: 0.955812, loss_d: 0.069756
0.1559 --- loss: 1.205734, loss_ss: 0.998008, loss_d: 0.207727
0.2338 --- loss: 1.266611, loss_ss: 1.121048, loss_d: 0.145563
0.3118 --- loss: 1.191685, loss_ss: 1.106343, loss_d: 0.085342
0.3897 --- loss: 1.030805, loss_ss: 0.960472, loss_d: 0.070332
0.4677 --- loss: 1.128637, loss_ss: 1.029839, loss_d: 0.098798
0.5456 --- loss: 0.769687, loss_ss: 0.745927, loss_d: 0.023760
0.6235 --- loss: 0.893494, loss_ss: 0.778796, loss_d: 0.114697
0.7015 --- loss: 0.993408, loss_ss: 0.931426, loss_d: 0.061982
0.7794 --- loss: 1.217777, loss_ss: 1.060256, loss_d: 0.157521
0.8574 --- loss: 1.614249, loss_ss: 1.215576, loss_d: 0.398673
0.9353 --- loss: 1.172017, loss_ss: 0.954900, loss_d: 0.217117
Epoch finished! Loss: 1.2150891162455082
Starting epoch 6/10.
0.0000 --- loss: 1.109786, loss_ss: 0.856322, loss_d: 0.253463
0.0779 --- loss: 1.034279, loss_ss: 0.903681, loss_d: 0.130597
0.1559 --- loss: 0.975173, loss_ss: 0.907686, loss_d: 0.067487
0.2338 --- loss: 1.230870, loss_ss: 1.101514, loss_d: 0.129356
0.3118 --- loss: 1.303724, loss_ss: 0.750126, loss_d: 0.553598
0.3897 --- loss: 0.896913, loss_ss: 0.856192, loss_d: 0.040721
0.4677 --- loss: 0.946793, loss_ss: 0.925936, loss_d: 0.020857
0.5456 --- loss: 1.242406, loss_ss: 1.199327, loss_d: 0.043078
0.6235 --- loss: 1.076488, loss_ss: 0.999617, loss_d: 0.076871
0.7015 --- loss: 0.909185, loss_ss: 0.844148, loss_d: 0.065038
0.7794 --- loss: 0.916221, loss_ss: 0.809812, loss_d: 0.106409
0.8574 --- loss: 1.091759, loss_ss: 0.933548, loss_d: 0.158211
0.9353 --- loss: 1.419605, loss_ss: 0.936896, loss_d: 0.482708
Epoch finished! Loss: 1.0938404249027371
Starting epoch 7/10.
0.0000 --- loss: 1.133871, loss_ss: 0.970529, loss_d: 0.163342
0.0779 --- loss: 0.929894, loss_ss: 0.889480, loss_d: 0.040413
0.1559 --- loss: 0.925885, loss_ss: 0.848539, loss_d: 0.077346
0.2338 --- loss: 1.215060, loss_ss: 0.800161, loss_d: 0.414900
0.3118 --- loss: 0.946965, loss_ss: 0.803891, loss_d: 0.143074
0.3897 --- loss: 1.055386, loss_ss: 0.968485, loss_d: 0.086901
0.4677 --- loss: 0.919410, loss_ss: 0.895895, loss_d: 0.023515
0.5456 --- loss: 0.995692, loss_ss: 0.940189, loss_d: 0.055503
0.6235 --- loss: 1.044944, loss_ss: 0.977087, loss_d: 0.067857
0.7015 --- loss: 1.069836, loss_ss: 1.020593, loss_d: 0.049244
0.7794 --- loss: 1.163822, loss_ss: 0.875457, loss_d: 0.288365
0.8574 --- loss: 1.143087, loss_ss: 1.104724, loss_d: 0.038363
0.9353 --- loss: 1.170010, loss_ss: 1.119202, loss_d: 0.050808
Epoch finished! Loss: 1.0677645397372544
Starting epoch 8/10.
0.0000 --- loss: 0.837806, loss_ss: 0.813559, loss_d: 0.024246
0.0779 --- loss: 1.282497, loss_ss: 1.225651, loss_d: 0.056846
0.1559 --- loss: 1.243391, loss_ss: 0.858519, loss_d: 0.384872
0.2338 --- loss: 1.126524, loss_ss: 1.074680, loss_d: 0.051844
0.3118 --- loss: 0.894424, loss_ss: 0.715496, loss_d: 0.178928
0.3897 --- loss: 0.955363, loss_ss: 0.940136, loss_d: 0.015228
0.4677 --- loss: 0.934653, loss_ss: 0.905661, loss_d: 0.028992
0.5456 --- loss: 1.039136, loss_ss: 1.008299, loss_d: 0.030837
0.6235 --- loss: 0.842837, loss_ss: 0.825522, loss_d: 0.017315
0.7015 --- loss: 1.065377, loss_ss: 0.736828, loss_d: 0.328549
0.7794 --- loss: 0.916780, loss_ss: 0.871707, loss_d: 0.045073
0.8574 --- loss: 1.026883, loss_ss: 0.969250, loss_d: 0.057633
0.9353 --- loss: 1.181664, loss_ss: 1.023335, loss_d: 0.158329
Epoch finished! Loss: 1.0053591304458678
Starting epoch 9/10.
0.0000 --- loss: 1.071869, loss_ss: 0.897121, loss_d: 0.174748
0.0779 --- loss: 1.408190, loss_ss: 0.856811, loss_d: 0.551379
0.1559 --- loss: 0.846993, loss_ss: 0.826772, loss_d: 0.020221
0.2338 --- loss: 0.756385, loss_ss: 0.735902, loss_d: 0.020482
0.3118 --- loss: 1.081435, loss_ss: 0.765244, loss_d: 0.316191
0.3897 --- loss: 0.946310, loss_ss: 0.876684, loss_d: 0.069627
0.4677 --- loss: 1.708355, loss_ss: 0.995404, loss_d: 0.712951
0.5456 --- loss: 0.958743, loss_ss: 0.943367, loss_d: 0.015376
0.6235 --- loss: 1.038120, loss_ss: 1.024076, loss_d: 0.014044
0.7015 --- loss: 0.959878, loss_ss: 0.872801, loss_d: 0.087077
0.7794 --- loss: 0.866330, loss_ss: 0.812862, loss_d: 0.053468
0.8574 --- loss: 0.787018, loss_ss: 0.776161, loss_d: 0.010856
0.9353 --- loss: 1.263023, loss_ss: 0.972582, loss_d: 0.290441
Epoch finished! Loss: 0.979865881614387
Starting epoch 10/10.
0.0000 --- loss: 0.874193, loss_ss: 0.825189, loss_d: 0.049004
0.0779 --- loss: 0.872627, loss_ss: 0.851648, loss_d: 0.020979
0.1559 --- loss: 0.812880, loss_ss: 0.808969, loss_d: 0.003911
0.2338 --- loss: 1.138541, loss_ss: 0.718503, loss_d: 0.420038
0.3118 --- loss: 0.827258, loss_ss: 0.706802, loss_d: 0.120456
0.3897 --- loss: 1.038401, loss_ss: 1.023851, loss_d: 0.014550
0.4677 --- loss: 0.741111, loss_ss: 0.708853, loss_d: 0.032258
0.5456 --- loss: 0.969458, loss_ss: 0.937002, loss_d: 0.032456
0.6235 --- loss: 0.821631, loss_ss: 0.731849, loss_d: 0.089782
0.7015 --- loss: 1.066712, loss_ss: 1.005970, loss_d: 0.060742
0.7794 --- loss: 1.004963, loss_ss: 0.935098, loss_d: 0.069865
0.8574 --- loss: 0.951792, loss_ss: 0.844601, loss_d: 0.107190
0.9353 --- loss: 0.988475, loss_ss: 0.949417, loss_d: 0.039058
Epoch finished! Loss: 0.9761872082017362
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6901960784313725
             precision    recall  f1-score   support

        0.0       0.19      0.88      0.32        17
        1.0       0.50      0.05      0.09        62
        2.0       0.67      0.72      0.69       372
        3.0       0.98      0.67      0.80       337
        4.0       0.63      0.82      0.71       232

avg / total       0.74      0.69      0.69      1020
 


====== chp034-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.73  88.24   93.82  19.48     31.91
1  93.92   4.84   99.69  50.00      8.82
2  76.67  72.04   79.32  66.67     69.25
3  88.73  67.36   99.27  97.84     79.79
4  85.00  82.33   85.79  63.04     71.40
Total accuracy: 69.02%
Average sen: 62.96%
Average spec: 91.58%
Macro f1-score: 52.24%
Diagnosis acc on 30mins: 0.8823529411764706
[0.98804837 0.90909612 0.81683415 0.95263612 0.99591345 0.99993873
 0.16121028 0.76665187 0.95545191 0.94452882 0.70682329 0.49988189
 0.86911875 0.77630061 0.96917492 0.96402508 0.95773071]
pred: 0.8372567690470639, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp034-nsrr

=== Test on chp036-nsrr. train_data(1279), test_data(21) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.392824, loss_ss: 1.712947, loss_d: 0.679877
0.0782 --- loss: 3.038207, loss_ss: 1.653980, loss_d: 1.384227
0.1564 --- loss: 2.162168, loss_ss: 1.556797, loss_d: 0.605371
0.2346 --- loss: 1.991753, loss_ss: 1.506389, loss_d: 0.485364
0.3127 --- loss: 2.039899, loss_ss: 1.516844, loss_d: 0.523055
0.3909 --- loss: 1.750588, loss_ss: 1.423961, loss_d: 0.326626
0.4691 --- loss: 1.959973, loss_ss: 1.511712, loss_d: 0.448261
0.5473 --- loss: 2.262138, loss_ss: 1.432339, loss_d: 0.829799
0.6255 --- loss: 2.022167, loss_ss: 1.409360, loss_d: 0.612806
0.7037 --- loss: 1.825780, loss_ss: 1.442967, loss_d: 0.382813
0.7819 --- loss: 1.818174, loss_ss: 1.402121, loss_d: 0.416054
0.8600 --- loss: 1.730025, loss_ss: 1.312622, loss_d: 0.417403
0.9382 --- loss: 1.786990, loss_ss: 1.279282, loss_d: 0.507708
Epoch finished! Loss: 2.0603255268156997
Starting epoch 2/10.
0.0000 --- loss: 1.733000, loss_ss: 1.373633, loss_d: 0.359367
0.0782 --- loss: 1.772844, loss_ss: 1.337596, loss_d: 0.435249
0.1564 --- loss: 1.689703, loss_ss: 1.281374, loss_d: 0.408329
0.2346 --- loss: 2.052296, loss_ss: 1.256571, loss_d: 0.795725
0.3127 --- loss: 1.820943, loss_ss: 1.272965, loss_d: 0.547977
0.3909 --- loss: 1.873963, loss_ss: 1.152948, loss_d: 0.721015
0.4691 --- loss: 1.556599, loss_ss: 1.224708, loss_d: 0.331891
0.5473 --- loss: 2.073909, loss_ss: 1.170472, loss_d: 0.903437
0.6255 --- loss: 1.743324, loss_ss: 1.225386, loss_d: 0.517938
0.7037 --- loss: 1.305378, loss_ss: 1.077555, loss_d: 0.227823
0.7819 --- loss: 1.710966, loss_ss: 1.228986, loss_d: 0.481980
0.8600 --- loss: 1.461703, loss_ss: 1.176273, loss_d: 0.285430
0.9382 --- loss: 1.744748, loss_ss: 1.113989, loss_d: 0.630759
Epoch finished! Loss: 1.7070051150059138
Starting epoch 3/10.
0.0000 --- loss: 1.606815, loss_ss: 1.241821, loss_d: 0.364993
0.0782 --- loss: 1.354841, loss_ss: 1.008737, loss_d: 0.346104
0.1564 --- loss: 1.443577, loss_ss: 1.020938, loss_d: 0.422639
0.2346 --- loss: 1.148427, loss_ss: 1.002551, loss_d: 0.145877
0.3127 --- loss: 1.786931, loss_ss: 1.117291, loss_d: 0.669640
0.3909 --- loss: 1.413882, loss_ss: 1.039557, loss_d: 0.374326
0.4691 --- loss: 1.307138, loss_ss: 1.124715, loss_d: 0.182423
0.5473 --- loss: 1.259804, loss_ss: 1.027885, loss_d: 0.231920
0.6255 --- loss: 1.509452, loss_ss: 1.043916, loss_d: 0.465536
0.7037 --- loss: 0.987669, loss_ss: 0.857812, loss_d: 0.129856
0.7819 --- loss: 1.428219, loss_ss: 1.173490, loss_d: 0.254729
0.8600 --- loss: 1.211270, loss_ss: 0.999672, loss_d: 0.211599
0.9382 --- loss: 1.027827, loss_ss: 0.882927, loss_d: 0.144901
Epoch finished! Loss: 1.4191940192162522
Starting epoch 4/10.
0.0000 --- loss: 1.255220, loss_ss: 1.117443, loss_d: 0.137777
0.0782 --- loss: 1.287844, loss_ss: 0.981717, loss_d: 0.306127
0.1564 --- loss: 1.110543, loss_ss: 1.020605, loss_d: 0.089939
0.2346 --- loss: 1.244781, loss_ss: 1.026311, loss_d: 0.218470
0.3127 --- loss: 1.273417, loss_ss: 1.072870, loss_d: 0.200546
0.3909 --- loss: 1.143739, loss_ss: 1.066770, loss_d: 0.076970
0.4691 --- loss: 1.203409, loss_ss: 1.060785, loss_d: 0.142624
0.5473 --- loss: 1.272134, loss_ss: 1.062050, loss_d: 0.210085
0.6255 --- loss: 1.131902, loss_ss: 0.953560, loss_d: 0.178342
0.7037 --- loss: 1.364295, loss_ss: 1.292987, loss_d: 0.071308
0.7819 --- loss: 1.564394, loss_ss: 1.025254, loss_d: 0.539140
0.8600 --- loss: 1.182741, loss_ss: 1.124858, loss_d: 0.057884
0.9382 --- loss: 1.158504, loss_ss: 0.948497, loss_d: 0.210007
Epoch finished! Loss: 1.2629260627303536
Starting epoch 5/10.
0.0000 --- loss: 1.403442, loss_ss: 1.079778, loss_d: 0.323664
0.0782 --- loss: 1.588067, loss_ss: 1.015407, loss_d: 0.572660
0.1564 --- loss: 1.215417, loss_ss: 1.103484, loss_d: 0.111933
0.2346 --- loss: 1.215114, loss_ss: 0.946846, loss_d: 0.268268
0.3127 --- loss: 0.822263, loss_ss: 0.707582, loss_d: 0.114682
0.3909 --- loss: 0.951508, loss_ss: 0.916953, loss_d: 0.034554
0.4691 --- loss: 1.364392, loss_ss: 0.955355, loss_d: 0.409037
0.5473 --- loss: 1.390549, loss_ss: 0.935684, loss_d: 0.454865
0.6255 --- loss: 0.991559, loss_ss: 0.898660, loss_d: 0.092899
0.7037 --- loss: 0.840453, loss_ss: 0.746265, loss_d: 0.094188
0.7819 --- loss: 1.363046, loss_ss: 0.999530, loss_d: 0.363516
0.8600 --- loss: 1.446354, loss_ss: 1.122173, loss_d: 0.324181
0.9382 --- loss: 1.401304, loss_ss: 0.901792, loss_d: 0.499511
Epoch finished! Loss: 1.1886184210852375
Starting epoch 6/10.
0.0000 --- loss: 1.123685, loss_ss: 1.065359, loss_d: 0.058326
0.0782 --- loss: 0.900583, loss_ss: 0.822064, loss_d: 0.078519
0.1564 --- loss: 1.230055, loss_ss: 1.116649, loss_d: 0.113407
0.2346 --- loss: 0.859745, loss_ss: 0.836117, loss_d: 0.023627
0.3127 --- loss: 1.027455, loss_ss: 0.943017, loss_d: 0.084437
0.3909 --- loss: 1.131271, loss_ss: 1.049240, loss_d: 0.082031
0.4691 --- loss: 1.314138, loss_ss: 1.103140, loss_d: 0.210998
0.5473 --- loss: 1.211039, loss_ss: 1.133817, loss_d: 0.077222
0.6255 --- loss: 1.021599, loss_ss: 0.960432, loss_d: 0.061167
0.7037 --- loss: 1.833469, loss_ss: 0.718832, loss_d: 1.114636
0.7819 --- loss: 0.996847, loss_ss: 0.976081, loss_d: 0.020766
0.8600 --- loss: 1.391734, loss_ss: 1.019007, loss_d: 0.372728
0.9382 --- loss: 1.022675, loss_ss: 0.783201, loss_d: 0.239474
Epoch finished! Loss: 1.1032603556715597
Starting epoch 7/10.
0.0000 --- loss: 0.938192, loss_ss: 0.913602, loss_d: 0.024590
0.0782 --- loss: 0.998104, loss_ss: 0.900544, loss_d: 0.097561
0.1564 --- loss: 1.014060, loss_ss: 0.959447, loss_d: 0.054613
0.2346 --- loss: 0.915950, loss_ss: 0.901454, loss_d: 0.014495
0.3127 --- loss: 1.029129, loss_ss: 0.928826, loss_d: 0.100303
0.3909 --- loss: 0.770269, loss_ss: 0.761806, loss_d: 0.008463
0.4691 --- loss: 1.036077, loss_ss: 0.996938, loss_d: 0.039139
0.5473 --- loss: 1.238031, loss_ss: 1.199816, loss_d: 0.038216
0.6255 --- loss: 1.019033, loss_ss: 0.893722, loss_d: 0.125311
0.7037 --- loss: 0.794030, loss_ss: 0.620960, loss_d: 0.173069
0.7819 --- loss: 1.129488, loss_ss: 0.992434, loss_d: 0.137054
0.8600 --- loss: 1.688724, loss_ss: 1.226619, loss_d: 0.462106
0.9382 --- loss: 1.024593, loss_ss: 0.948370, loss_d: 0.076223
Epoch finished! Loss: 1.0505261909304642
Starting epoch 8/10.
0.0000 --- loss: 0.871404, loss_ss: 0.785550, loss_d: 0.085854
0.0782 --- loss: 1.053528, loss_ss: 0.994633, loss_d: 0.058895
0.1564 --- loss: 0.884170, loss_ss: 0.836890, loss_d: 0.047281
0.2346 --- loss: 1.194604, loss_ss: 1.120646, loss_d: 0.073958
0.3127 --- loss: 1.074381, loss_ss: 1.002162, loss_d: 0.072220
0.3909 --- loss: 0.837676, loss_ss: 0.766341, loss_d: 0.071335
0.4691 --- loss: 1.204497, loss_ss: 1.016336, loss_d: 0.188161
0.5473 --- loss: 0.851786, loss_ss: 0.818973, loss_d: 0.032813
0.6255 --- loss: 0.946126, loss_ss: 0.937317, loss_d: 0.008810
0.7037 --- loss: 0.869658, loss_ss: 0.793865, loss_d: 0.075794
0.7819 --- loss: 0.742494, loss_ss: 0.604021, loss_d: 0.138473
0.8600 --- loss: 0.926685, loss_ss: 0.885479, loss_d: 0.041205
0.9382 --- loss: 0.828845, loss_ss: 0.787701, loss_d: 0.041143
Epoch finished! Loss: 0.9817261592609676
Starting epoch 9/10.
0.0000 --- loss: 0.783490, loss_ss: 0.779046, loss_d: 0.004444
0.0782 --- loss: 1.318380, loss_ss: 1.234814, loss_d: 0.083566
0.1564 --- loss: 1.142953, loss_ss: 1.121946, loss_d: 0.021007
0.2346 --- loss: 0.910101, loss_ss: 0.891686, loss_d: 0.018416
0.3127 --- loss: 1.386121, loss_ss: 0.948518, loss_d: 0.437603
0.3909 --- loss: 1.065495, loss_ss: 1.013487, loss_d: 0.052008
0.4691 --- loss: 0.904154, loss_ss: 0.897377, loss_d: 0.006776
0.5473 --- loss: 0.819008, loss_ss: 0.800250, loss_d: 0.018758
0.6255 --- loss: 1.127193, loss_ss: 1.023250, loss_d: 0.103943
0.7037 --- loss: 0.731421, loss_ss: 0.727311, loss_d: 0.004110
0.7819 --- loss: 1.161980, loss_ss: 1.040429, loss_d: 0.121551
0.8600 --- loss: 0.829621, loss_ss: 0.813605, loss_d: 0.016017
0.9382 --- loss: 0.947902, loss_ss: 0.940134, loss_d: 0.007769
Epoch finished! Loss: 0.9691840766921757
Starting epoch 10/10.
0.0000 --- loss: 0.937655, loss_ss: 0.921808, loss_d: 0.015847
0.0782 --- loss: 0.938110, loss_ss: 0.914065, loss_d: 0.024045
0.1564 --- loss: 0.828383, loss_ss: 0.826101, loss_d: 0.002282
0.2346 --- loss: 0.606433, loss_ss: 0.604324, loss_d: 0.002108
0.3127 --- loss: 0.902271, loss_ss: 0.890920, loss_d: 0.011351
0.3909 --- loss: 1.018983, loss_ss: 0.989122, loss_d: 0.029861
0.4691 --- loss: 0.907293, loss_ss: 0.818021, loss_d: 0.089272
0.5473 --- loss: 1.025633, loss_ss: 1.017622, loss_d: 0.008011
0.6255 --- loss: 1.369560, loss_ss: 1.011806, loss_d: 0.357755
0.7037 --- loss: 0.850532, loss_ss: 0.838907, loss_d: 0.011625
0.7819 --- loss: 0.824224, loss_ss: 0.790400, loss_d: 0.033824
0.8600 --- loss: 0.763619, loss_ss: 0.636452, loss_d: 0.127167
0.9382 --- loss: 0.734960, loss_ss: 0.691354, loss_d: 0.043605
Epoch finished! Loss: 0.9597018210906682
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.8396825396825397
             precision    recall  f1-score   support

        0.0       0.84      0.93      0.88       237
        1.0       0.66      0.56      0.61       167
        2.0       0.94      0.85      0.89       563
        3.0       0.11      0.38      0.17         8
        4.0       0.83      0.92      0.87       285

avg / total       0.85      0.84      0.84      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.24  92.83   95.80  83.65     88.00
1  90.40  56.29   95.61  66.20     60.84
2  90.79  85.26   95.27  93.57     89.22
3  97.62  37.50   98.00  10.71     16.67
4  93.89  91.58   94.56  83.12     87.15
Total accuracy: 83.97%
Average sen: 72.69%
Average spec: 95.85%
Macro f1-score: 68.37%
Diagnosis acc on 30mins: 1.0
[0.9999963  0.99996817 0.99999702 0.99973208 0.99998963 0.99859434
 0.99997997 0.99999464 0.99998367 0.99941456 0.99980325 0.99999928
 0.99940574 0.9999882  0.9998548  0.99616843 0.99997449 0.99999821
 0.99991095 0.99995565 0.99999857]
pred: 0.9996527603694371, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp036-nsrr

=== Test on chp037-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.449056, loss_ss: 1.748869, loss_d: 0.700186
0.0779 --- loss: 2.061370, loss_ss: 1.493431, loss_d: 0.567939
0.1559 --- loss: 2.186616, loss_ss: 1.574116, loss_d: 0.612500
0.2338 --- loss: 2.330783, loss_ss: 1.475916, loss_d: 0.854867
0.3118 --- loss: 2.198123, loss_ss: 1.514516, loss_d: 0.683606
0.3897 --- loss: 2.148915, loss_ss: 1.448456, loss_d: 0.700459
0.4677 --- loss: 1.895237, loss_ss: 1.281023, loss_d: 0.614214
0.5456 --- loss: 2.059113, loss_ss: 1.440387, loss_d: 0.618725
0.6235 --- loss: 1.739180, loss_ss: 1.321423, loss_d: 0.417757
0.7015 --- loss: 2.317814, loss_ss: 1.472050, loss_d: 0.845764
0.7794 --- loss: 1.678756, loss_ss: 1.364198, loss_d: 0.314558
0.8574 --- loss: 1.748788, loss_ss: 1.335055, loss_d: 0.413733
0.9353 --- loss: 2.053602, loss_ss: 1.227932, loss_d: 0.825670
Epoch finished! Loss: 2.0350088756531477
Starting epoch 2/10.
0.0000 --- loss: 1.664218, loss_ss: 1.264418, loss_d: 0.399800
0.0779 --- loss: 1.875322, loss_ss: 1.322809, loss_d: 0.552513
0.1559 --- loss: 1.591121, loss_ss: 1.168019, loss_d: 0.423102
0.2338 --- loss: 1.646361, loss_ss: 1.166670, loss_d: 0.479691
0.3118 --- loss: 1.692179, loss_ss: 1.315599, loss_d: 0.376580
0.3897 --- loss: 1.831592, loss_ss: 1.368899, loss_d: 0.462693
0.4677 --- loss: 1.928826, loss_ss: 1.447901, loss_d: 0.480925
0.5456 --- loss: 1.537388, loss_ss: 1.182516, loss_d: 0.354872
0.6235 --- loss: 2.098378, loss_ss: 1.301187, loss_d: 0.797191
0.7015 --- loss: 1.669058, loss_ss: 1.270147, loss_d: 0.398911
0.7794 --- loss: 1.835459, loss_ss: 1.472315, loss_d: 0.363144
0.8574 --- loss: 1.516667, loss_ss: 1.091609, loss_d: 0.425058
0.9353 --- loss: 1.725064, loss_ss: 1.236558, loss_d: 0.488506
Epoch finished! Loss: 1.7245706031098962
Starting epoch 3/10.
0.0000 --- loss: 1.393058, loss_ss: 1.207602, loss_d: 0.185456
0.0779 --- loss: 1.612524, loss_ss: 1.124363, loss_d: 0.488161
0.1559 --- loss: 2.137725, loss_ss: 1.284487, loss_d: 0.853238
0.2338 --- loss: 1.520787, loss_ss: 1.272554, loss_d: 0.248233
0.3118 --- loss: 1.201792, loss_ss: 1.123369, loss_d: 0.078423
0.3897 --- loss: 1.327890, loss_ss: 0.939874, loss_d: 0.388016
0.4677 --- loss: 1.939475, loss_ss: 1.236063, loss_d: 0.703412
0.5456 --- loss: 1.182296, loss_ss: 1.029258, loss_d: 0.153038
0.6235 --- loss: 1.348109, loss_ss: 1.141494, loss_d: 0.206615
0.7015 --- loss: 1.739654, loss_ss: 1.306929, loss_d: 0.432726
0.7794 --- loss: 1.289050, loss_ss: 1.054109, loss_d: 0.234941
0.8574 --- loss: 1.689338, loss_ss: 1.094715, loss_d: 0.594623
0.9353 --- loss: 1.394332, loss_ss: 1.165285, loss_d: 0.229048
Epoch finished! Loss: 1.4905308438465
Starting epoch 4/10.
0.0000 --- loss: 1.267530, loss_ss: 1.093119, loss_d: 0.174412
0.0779 --- loss: 1.278503, loss_ss: 1.083033, loss_d: 0.195470
0.1559 --- loss: 1.159436, loss_ss: 1.054251, loss_d: 0.105185
0.2338 --- loss: 1.084043, loss_ss: 1.013480, loss_d: 0.070564
0.3118 --- loss: 1.435456, loss_ss: 1.018212, loss_d: 0.417244
0.3897 --- loss: 1.296739, loss_ss: 1.113336, loss_d: 0.183402
0.4677 --- loss: 2.125643, loss_ss: 0.952684, loss_d: 1.172959
0.5456 --- loss: 1.377614, loss_ss: 1.019965, loss_d: 0.357649
0.6235 --- loss: 1.600114, loss_ss: 1.296241, loss_d: 0.303874
0.7015 --- loss: 1.217653, loss_ss: 1.064460, loss_d: 0.153193
0.7794 --- loss: 1.256890, loss_ss: 0.987747, loss_d: 0.269143
0.8574 --- loss: 1.053347, loss_ss: 0.989408, loss_d: 0.063940
0.9353 --- loss: 1.414637, loss_ss: 1.216735, loss_d: 0.197902
Epoch finished! Loss: 1.3292898791842163
Starting epoch 5/10.
0.0000 --- loss: 1.384840, loss_ss: 1.032294, loss_d: 0.352546
0.0779 --- loss: 1.651408, loss_ss: 1.179130, loss_d: 0.472277
0.1559 --- loss: 1.629972, loss_ss: 1.269618, loss_d: 0.360354
0.2338 --- loss: 1.060204, loss_ss: 1.044804, loss_d: 0.015400
0.3118 --- loss: 0.880938, loss_ss: 0.801506, loss_d: 0.079432
0.3897 --- loss: 1.286190, loss_ss: 0.938556, loss_d: 0.347634
0.4677 --- loss: 1.414433, loss_ss: 1.023118, loss_d: 0.391315
0.5456 --- loss: 1.287329, loss_ss: 0.794957, loss_d: 0.492372
0.6235 --- loss: 1.374161, loss_ss: 1.175322, loss_d: 0.198839
0.7015 --- loss: 1.271723, loss_ss: 1.147947, loss_d: 0.123776
0.7794 --- loss: 0.913367, loss_ss: 0.883166, loss_d: 0.030201
0.8574 --- loss: 1.128789, loss_ss: 0.931866, loss_d: 0.196923
0.9353 --- loss: 1.129720, loss_ss: 1.057832, loss_d: 0.071889
Epoch finished! Loss: 1.2224710411392152
Starting epoch 6/10.
0.0000 --- loss: 1.207163, loss_ss: 0.987925, loss_d: 0.219238
0.0779 --- loss: 1.154783, loss_ss: 0.880972, loss_d: 0.273811
0.1559 --- loss: 1.304065, loss_ss: 0.891721, loss_d: 0.412344
0.2338 --- loss: 0.916893, loss_ss: 0.889139, loss_d: 0.027754
0.3118 --- loss: 1.254135, loss_ss: 1.197521, loss_d: 0.056614
0.3897 --- loss: 0.991966, loss_ss: 0.920203, loss_d: 0.071763
0.4677 --- loss: 1.211477, loss_ss: 1.190517, loss_d: 0.020961
0.5456 --- loss: 1.045660, loss_ss: 0.936641, loss_d: 0.109019
0.6235 --- loss: 0.979443, loss_ss: 0.883550, loss_d: 0.095894
0.7015 --- loss: 1.196265, loss_ss: 0.835024, loss_d: 0.361241
0.7794 --- loss: 1.209595, loss_ss: 1.165372, loss_d: 0.044222
0.8574 --- loss: 1.281931, loss_ss: 1.153326, loss_d: 0.128605
0.9353 --- loss: 1.101947, loss_ss: 1.062888, loss_d: 0.039059
Epoch finished! Loss: 1.1338838869705796
Starting epoch 7/10.
0.0000 --- loss: 0.897248, loss_ss: 0.882734, loss_d: 0.014514
0.0779 --- loss: 1.192642, loss_ss: 1.105793, loss_d: 0.086849
0.1559 --- loss: 1.109026, loss_ss: 0.968335, loss_d: 0.140690
0.2338 --- loss: 0.912178, loss_ss: 0.843200, loss_d: 0.068978
0.3118 --- loss: 1.542687, loss_ss: 1.203925, loss_d: 0.338762
0.3897 --- loss: 1.138165, loss_ss: 1.005979, loss_d: 0.132186
0.4677 --- loss: 1.176184, loss_ss: 0.957638, loss_d: 0.218546
0.5456 --- loss: 1.155526, loss_ss: 0.967155, loss_d: 0.188370
0.6235 --- loss: 1.108913, loss_ss: 1.048697, loss_d: 0.060216
0.7015 --- loss: 1.391109, loss_ss: 1.147762, loss_d: 0.243346
0.7794 --- loss: 1.503080, loss_ss: 1.111698, loss_d: 0.391382
0.8574 --- loss: 0.967603, loss_ss: 0.880272, loss_d: 0.087331
0.9353 --- loss: 1.176806, loss_ss: 0.872219, loss_d: 0.304587
Epoch finished! Loss: 1.1350440853275359
Starting epoch 8/10.
0.0000 --- loss: 1.132327, loss_ss: 0.845707, loss_d: 0.286619
0.0779 --- loss: 0.849509, loss_ss: 0.807543, loss_d: 0.041967
0.1559 --- loss: 1.693909, loss_ss: 1.030185, loss_d: 0.663723
0.2338 --- loss: 1.107759, loss_ss: 1.057267, loss_d: 0.050492
0.3118 --- loss: 1.087710, loss_ss: 0.911298, loss_d: 0.176412
0.3897 --- loss: 0.781931, loss_ss: 0.698036, loss_d: 0.083895
0.4677 --- loss: 0.765621, loss_ss: 0.752373, loss_d: 0.013248
0.5456 --- loss: 0.876713, loss_ss: 0.782358, loss_d: 0.094355
0.6235 --- loss: 1.016448, loss_ss: 0.906751, loss_d: 0.109698
0.7015 --- loss: 0.817673, loss_ss: 0.787793, loss_d: 0.029881
0.7794 --- loss: 0.975352, loss_ss: 0.959609, loss_d: 0.015743
0.8574 --- loss: 0.964790, loss_ss: 0.943589, loss_d: 0.021201
0.9353 --- loss: 1.318111, loss_ss: 0.935969, loss_d: 0.382142
Epoch finished! Loss: 1.0354666421189904
Starting epoch 9/10.
0.0000 --- loss: 0.845560, loss_ss: 0.801585, loss_d: 0.043975
0.0779 --- loss: 0.900864, loss_ss: 0.813643, loss_d: 0.087221
0.1559 --- loss: 1.755064, loss_ss: 0.979211, loss_d: 0.775853
0.2338 --- loss: 1.334258, loss_ss: 1.296507, loss_d: 0.037752
0.3118 --- loss: 1.095349, loss_ss: 0.945421, loss_d: 0.149927
0.3897 --- loss: 0.870628, loss_ss: 0.853849, loss_d: 0.016779
0.4677 --- loss: 1.045750, loss_ss: 0.942872, loss_d: 0.102878
0.5456 --- loss: 0.822286, loss_ss: 0.735139, loss_d: 0.087147
0.6235 --- loss: 0.767183, loss_ss: 0.755502, loss_d: 0.011681
0.7015 --- loss: 0.922707, loss_ss: 0.895898, loss_d: 0.026809
0.7794 --- loss: 0.967962, loss_ss: 0.961725, loss_d: 0.006238
0.8574 --- loss: 0.994289, loss_ss: 0.916860, loss_d: 0.077429
0.9353 --- loss: 1.064880, loss_ss: 0.910303, loss_d: 0.154577
Epoch finished! Loss: 1.0176992299966514
Starting epoch 10/10.
0.0000 --- loss: 0.790102, loss_ss: 0.768427, loss_d: 0.021674
0.0779 --- loss: 1.054899, loss_ss: 0.850500, loss_d: 0.204399
0.1559 --- loss: 0.795751, loss_ss: 0.791851, loss_d: 0.003900
0.2338 --- loss: 0.961180, loss_ss: 0.914023, loss_d: 0.047158
0.3118 --- loss: 1.055716, loss_ss: 1.028446, loss_d: 0.027270
0.3897 --- loss: 0.898734, loss_ss: 0.859310, loss_d: 0.039424
0.4677 --- loss: 1.053963, loss_ss: 0.990463, loss_d: 0.063500
0.5456 --- loss: 0.914281, loss_ss: 0.913538, loss_d: 0.000743
0.6235 --- loss: 0.965610, loss_ss: 0.944937, loss_d: 0.020673
0.7015 --- loss: 0.864089, loss_ss: 0.847892, loss_d: 0.016197
0.7794 --- loss: 1.021079, loss_ss: 0.995709, loss_d: 0.025369
0.8574 --- loss: 1.023607, loss_ss: 0.937105, loss_d: 0.086502
0.9353 --- loss: 1.112830, loss_ss: 1.108214, loss_d: 0.004615
Epoch finished! Loss: 0.9521124251186848
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.4214145383104126
             precision    recall  f1-score   support

        0.0       0.79      0.10      0.17       197
        1.0       0.20      0.17      0.19       161
        2.0       0.77      0.33      0.46       348
        3.0       1.00      0.81      0.90       208
        4.0       0.18      0.93      0.30       104

avg / total       0.67      0.42      0.44      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  82.02   9.64   99.39   79.17     17.19
1  76.13  17.39   87.16   20.29     18.73
2  73.77  33.33   94.78   76.82     46.49
3  96.17  81.25  100.00  100.00     89.66
4  56.19  93.27   51.97   18.10     30.31
Total accuracy: 42.14%
Average sen: 46.98%
Average spec: 86.66%
Macro f1-score: 40.48%
Diagnosis acc on 30mins: 1.0
[0.99996853 0.99889225 0.999982   0.99956697 0.99997091 0.99997973
 0.99887294 0.99999118 0.9996742  0.9992286  0.9999001  0.99980968
 0.99810249 0.99999678 0.99999774 0.99996507 0.99965191]
pred: 0.9996206514975604, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp037-nsrr

=== Test on chp038-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.436048, loss_ss: 1.746903, loss_d: 0.689146
0.0779 --- loss: 2.120227, loss_ss: 1.485671, loss_d: 0.634556
0.1559 --- loss: 1.926151, loss_ss: 1.432261, loss_d: 0.493890
0.2338 --- loss: 1.942859, loss_ss: 1.481282, loss_d: 0.461577
0.3118 --- loss: 1.980532, loss_ss: 1.351161, loss_d: 0.629371
0.3897 --- loss: 2.026248, loss_ss: 1.394825, loss_d: 0.631423
0.4677 --- loss: 1.946285, loss_ss: 1.450362, loss_d: 0.495923
0.5456 --- loss: 2.276194, loss_ss: 1.345372, loss_d: 0.930822
0.6235 --- loss: 1.945569, loss_ss: 1.402582, loss_d: 0.542987
0.7015 --- loss: 1.965886, loss_ss: 1.385771, loss_d: 0.580115
0.7794 --- loss: 2.005832, loss_ss: 1.273770, loss_d: 0.732062
0.8574 --- loss: 1.897261, loss_ss: 1.257395, loss_d: 0.639866
0.9353 --- loss: 1.773860, loss_ss: 1.320387, loss_d: 0.453473
Epoch finished! Loss: 1.998920926824212
Starting epoch 2/10.
0.0000 --- loss: 2.068418, loss_ss: 1.347482, loss_d: 0.720936
0.0779 --- loss: 1.702824, loss_ss: 1.322886, loss_d: 0.379939
0.1559 --- loss: 1.820587, loss_ss: 1.292458, loss_d: 0.528129
0.2338 --- loss: 1.543465, loss_ss: 1.238380, loss_d: 0.305086
0.3118 --- loss: 1.876271, loss_ss: 1.344270, loss_d: 0.532001
0.3897 --- loss: 1.604822, loss_ss: 1.140313, loss_d: 0.464510
0.4677 --- loss: 1.533560, loss_ss: 1.256866, loss_d: 0.276694
0.5456 --- loss: 1.544025, loss_ss: 1.176936, loss_d: 0.367089
0.6235 --- loss: 1.376599, loss_ss: 1.159958, loss_d: 0.216642
0.7015 --- loss: 1.663457, loss_ss: 1.253647, loss_d: 0.409810
0.7794 --- loss: 1.492786, loss_ss: 1.149361, loss_d: 0.343425
0.8574 --- loss: 1.921364, loss_ss: 1.273571, loss_d: 0.647793
0.9353 --- loss: 1.336093, loss_ss: 1.064408, loss_d: 0.271685
Epoch finished! Loss: 1.6396231278777122
Starting epoch 3/10.
0.0000 --- loss: 1.575412, loss_ss: 1.260145, loss_d: 0.315267
0.0779 --- loss: 1.389797, loss_ss: 1.190150, loss_d: 0.199647
0.1559 --- loss: 1.744936, loss_ss: 1.101695, loss_d: 0.643241
0.2338 --- loss: 1.486718, loss_ss: 1.276467, loss_d: 0.210251
0.3118 --- loss: 1.978404, loss_ss: 1.146402, loss_d: 0.832003
0.3897 --- loss: 1.495269, loss_ss: 1.154084, loss_d: 0.341186
0.4677 --- loss: 1.393878, loss_ss: 1.031233, loss_d: 0.362645
0.5456 --- loss: 1.229355, loss_ss: 1.123591, loss_d: 0.105764
0.6235 --- loss: 1.666069, loss_ss: 1.100306, loss_d: 0.565763
0.7015 --- loss: 1.376349, loss_ss: 1.193088, loss_d: 0.183261
0.7794 --- loss: 1.732447, loss_ss: 1.047127, loss_d: 0.685320
0.8574 --- loss: 1.381590, loss_ss: 1.014059, loss_d: 0.367531
0.9353 --- loss: 1.469364, loss_ss: 1.077490, loss_d: 0.391874
Epoch finished! Loss: 1.411428733728826
Starting epoch 4/10.
0.0000 --- loss: 1.101458, loss_ss: 0.970192, loss_d: 0.131266
0.0779 --- loss: 1.142573, loss_ss: 0.975047, loss_d: 0.167526
0.1559 --- loss: 1.104971, loss_ss: 1.033222, loss_d: 0.071750
0.2338 --- loss: 1.072463, loss_ss: 0.978721, loss_d: 0.093741
0.3118 --- loss: 1.388841, loss_ss: 1.068114, loss_d: 0.320727
0.3897 --- loss: 1.270854, loss_ss: 1.058034, loss_d: 0.212820
0.4677 --- loss: 0.997400, loss_ss: 0.868378, loss_d: 0.129022
0.5456 --- loss: 1.044053, loss_ss: 0.858715, loss_d: 0.185338
0.6235 --- loss: 1.395568, loss_ss: 0.987127, loss_d: 0.408441
0.7015 --- loss: 1.191784, loss_ss: 1.003664, loss_d: 0.188120
0.7794 --- loss: 1.468896, loss_ss: 1.048459, loss_d: 0.420437
0.8574 --- loss: 0.905041, loss_ss: 0.848796, loss_d: 0.056244
0.9353 --- loss: 0.962515, loss_ss: 0.852100, loss_d: 0.110415
Epoch finished! Loss: 1.2319600218906999
Starting epoch 5/10.
0.0000 --- loss: 1.044204, loss_ss: 0.900717, loss_d: 0.143487
0.0779 --- loss: 1.383962, loss_ss: 1.057588, loss_d: 0.326374
0.1559 --- loss: 0.892177, loss_ss: 0.818587, loss_d: 0.073589
0.2338 --- loss: 1.164762, loss_ss: 0.912711, loss_d: 0.252051
0.3118 --- loss: 1.357414, loss_ss: 1.158633, loss_d: 0.198781
0.3897 --- loss: 0.887319, loss_ss: 0.758537, loss_d: 0.128782
0.4677 --- loss: 1.100908, loss_ss: 0.961904, loss_d: 0.139004
0.5456 --- loss: 1.022237, loss_ss: 0.910052, loss_d: 0.112185
0.6235 --- loss: 1.034791, loss_ss: 0.964707, loss_d: 0.070084
0.7015 --- loss: 1.013832, loss_ss: 0.898009, loss_d: 0.115823
0.7794 --- loss: 1.385584, loss_ss: 0.912731, loss_d: 0.472852
0.8574 --- loss: 0.981361, loss_ss: 0.847747, loss_d: 0.133614
0.9353 --- loss: 1.600245, loss_ss: 0.785533, loss_d: 0.814712
Epoch finished! Loss: 1.15801098709926
Starting epoch 6/10.
0.0000 --- loss: 1.134209, loss_ss: 0.968288, loss_d: 0.165921
0.0779 --- loss: 0.889565, loss_ss: 0.794613, loss_d: 0.094952
0.1559 --- loss: 1.022668, loss_ss: 0.976322, loss_d: 0.046347
0.2338 --- loss: 0.958090, loss_ss: 0.879871, loss_d: 0.078219
0.3118 --- loss: 0.945751, loss_ss: 0.818864, loss_d: 0.126887
0.3897 --- loss: 0.924862, loss_ss: 0.914494, loss_d: 0.010368
0.4677 --- loss: 1.125213, loss_ss: 1.058743, loss_d: 0.066470
0.5456 --- loss: 1.482096, loss_ss: 1.429249, loss_d: 0.052847
0.6235 --- loss: 1.313789, loss_ss: 0.942828, loss_d: 0.370962
0.7015 --- loss: 1.082389, loss_ss: 1.033265, loss_d: 0.049123
0.7794 --- loss: 0.859778, loss_ss: 0.740958, loss_d: 0.118820
0.8574 --- loss: 0.846446, loss_ss: 0.805058, loss_d: 0.041388
0.9353 --- loss: 1.201672, loss_ss: 1.123473, loss_d: 0.078199
Epoch finished! Loss: 1.051880025304854
Starting epoch 7/10.
0.0000 --- loss: 0.682115, loss_ss: 0.638078, loss_d: 0.044037
0.0779 --- loss: 1.162488, loss_ss: 1.158209, loss_d: 0.004278
0.1559 --- loss: 1.031807, loss_ss: 0.961514, loss_d: 0.070292
0.2338 --- loss: 0.969964, loss_ss: 0.882869, loss_d: 0.087095
0.3118 --- loss: 0.825355, loss_ss: 0.668069, loss_d: 0.157286
0.3897 --- loss: 1.325578, loss_ss: 0.957430, loss_d: 0.368148
0.4677 --- loss: 1.015444, loss_ss: 0.925694, loss_d: 0.089750
0.5456 --- loss: 0.874577, loss_ss: 0.832836, loss_d: 0.041741
0.6235 --- loss: 1.165636, loss_ss: 0.854862, loss_d: 0.310774
0.7015 --- loss: 1.561695, loss_ss: 1.158748, loss_d: 0.402946
0.7794 --- loss: 0.792702, loss_ss: 0.775867, loss_d: 0.016836
0.8574 --- loss: 0.794447, loss_ss: 0.773262, loss_d: 0.021184
0.9353 --- loss: 0.911534, loss_ss: 0.886920, loss_d: 0.024614
Epoch finished! Loss: 1.0467344564385712
Starting epoch 8/10.
0.0000 --- loss: 1.248626, loss_ss: 1.234677, loss_d: 0.013949
0.0779 --- loss: 0.875836, loss_ss: 0.830749, loss_d: 0.045087
0.1559 --- loss: 1.344338, loss_ss: 1.033426, loss_d: 0.310911
0.2338 --- loss: 0.893996, loss_ss: 0.804778, loss_d: 0.089217
0.3118 --- loss: 0.887397, loss_ss: 0.870845, loss_d: 0.016552
0.3897 --- loss: 1.028632, loss_ss: 0.983287, loss_d: 0.045345
0.4677 --- loss: 1.031376, loss_ss: 0.934978, loss_d: 0.096398
0.5456 --- loss: 0.884530, loss_ss: 0.864480, loss_d: 0.020050
0.6235 --- loss: 1.074251, loss_ss: 1.017387, loss_d: 0.056864
0.7015 --- loss: 1.306505, loss_ss: 0.792593, loss_d: 0.513912
0.7794 --- loss: 0.915439, loss_ss: 0.715311, loss_d: 0.200128
0.8574 --- loss: 1.106424, loss_ss: 0.784915, loss_d: 0.321509
0.9353 --- loss: 0.700188, loss_ss: 0.668573, loss_d: 0.031615
Epoch finished! Loss: 1.0139081850647926
Starting epoch 9/10.
0.0000 --- loss: 0.781148, loss_ss: 0.749048, loss_d: 0.032100
0.0779 --- loss: 0.919474, loss_ss: 0.791908, loss_d: 0.127566
0.1559 --- loss: 0.763289, loss_ss: 0.685264, loss_d: 0.078025
0.2338 --- loss: 0.951733, loss_ss: 0.944305, loss_d: 0.007428
0.3118 --- loss: 1.501850, loss_ss: 0.900784, loss_d: 0.601066
0.3897 --- loss: 0.724766, loss_ss: 0.716549, loss_d: 0.008216
0.4677 --- loss: 1.066419, loss_ss: 0.831446, loss_d: 0.234974
0.5456 --- loss: 0.943369, loss_ss: 0.895562, loss_d: 0.047807
0.6235 --- loss: 1.235857, loss_ss: 1.091358, loss_d: 0.144499
0.7015 --- loss: 1.515049, loss_ss: 1.108245, loss_d: 0.406804
0.7794 --- loss: 0.767229, loss_ss: 0.741674, loss_d: 0.025555
0.8574 --- loss: 0.851140, loss_ss: 0.843389, loss_d: 0.007751
0.9353 --- loss: 1.043677, loss_ss: 0.844081, loss_d: 0.199597
Epoch finished! Loss: 0.9585359343327582
Starting epoch 10/10.
0.0000 --- loss: 0.813996, loss_ss: 0.810967, loss_d: 0.003028
0.0779 --- loss: 0.847992, loss_ss: 0.842035, loss_d: 0.005958
0.1559 --- loss: 1.210103, loss_ss: 1.149338, loss_d: 0.060765
0.2338 --- loss: 0.990898, loss_ss: 0.826769, loss_d: 0.164129
0.3118 --- loss: 0.680200, loss_ss: 0.662777, loss_d: 0.017423
0.3897 --- loss: 0.830869, loss_ss: 0.715683, loss_d: 0.115186
0.4677 --- loss: 0.848342, loss_ss: 0.790729, loss_d: 0.057613
0.5456 --- loss: 1.187349, loss_ss: 1.156884, loss_d: 0.030465
0.6235 --- loss: 0.995869, loss_ss: 0.913378, loss_d: 0.082490
0.7015 --- loss: 1.052079, loss_ss: 1.031741, loss_d: 0.020338
0.7794 --- loss: 0.864597, loss_ss: 0.860887, loss_d: 0.003710
0.8574 --- loss: 1.020778, loss_ss: 0.825213, loss_d: 0.195565
0.9353 --- loss: 1.280648, loss_ss: 1.259563, loss_d: 0.021085
Epoch finished! Loss: 0.897696718107909
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.696078431372549
             precision    recall  f1-score   support

        0.0       0.49      0.77      0.60        62
        1.0       0.40      0.39      0.39       178
        2.0       0.75      0.95      0.84       437
        3.0       0.97      0.81      0.88       102
        4.0       0.90      0.40      0.55       241

avg / total       0.73      0.70      0.68      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.73  77.42   94.78  48.98     60.00
1  78.92  39.33   87.29  39.55     39.44
2  84.02  94.51   76.16  74.82     83.52
3  97.84  81.37   99.67  96.51     88.30
4  84.71  39.83   98.59  89.72     55.17
Total accuracy: 69.61%
Average sen: 66.49%
Average spec: 91.30%
Macro f1-score: 65.29%
Diagnosis acc on 30mins: 1.0
[0.99999917 0.99997842 0.99999988 1.         1.         1.
 1.         0.99900049 0.99999869 0.99999893 0.99999976 0.99999988
 0.9994548  0.99999976 1.         0.99999964 1.        ]
pred: 0.9999076128005981, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp038-nsrr

=== Test on chp039-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.451651, loss_ss: 1.766859, loss_d: 0.684792
0.0780 --- loss: 2.203997, loss_ss: 1.534688, loss_d: 0.669310
0.1560 --- loss: 2.358860, loss_ss: 1.672264, loss_d: 0.686596
0.2340 --- loss: 2.260639, loss_ss: 1.554833, loss_d: 0.705805
0.3120 --- loss: 1.988193, loss_ss: 1.418584, loss_d: 0.569610
0.3900 --- loss: 1.911662, loss_ss: 1.431653, loss_d: 0.480009
0.4680 --- loss: 2.251731, loss_ss: 1.395030, loss_d: 0.856700
0.5460 --- loss: 2.057599, loss_ss: 1.436683, loss_d: 0.620917
0.6240 --- loss: 2.085310, loss_ss: 1.304573, loss_d: 0.780737
0.7020 --- loss: 2.056561, loss_ss: 1.343130, loss_d: 0.713430
0.7800 --- loss: 1.640208, loss_ss: 1.298175, loss_d: 0.342032
0.8580 --- loss: 1.746853, loss_ss: 1.274453, loss_d: 0.472399
0.9360 --- loss: 1.794517, loss_ss: 1.356703, loss_d: 0.437814
Epoch finished! Loss: 2.0519478507339954
Starting epoch 2/10.
0.0000 --- loss: 1.762733, loss_ss: 1.297733, loss_d: 0.464999
0.0780 --- loss: 1.551577, loss_ss: 1.180035, loss_d: 0.371542
0.1560 --- loss: 1.801289, loss_ss: 1.367751, loss_d: 0.433538
0.2340 --- loss: 1.584045, loss_ss: 1.191151, loss_d: 0.392894
0.3120 --- loss: 1.750663, loss_ss: 1.170185, loss_d: 0.580478
0.3900 --- loss: 1.659666, loss_ss: 1.242505, loss_d: 0.417161
0.4680 --- loss: 1.503220, loss_ss: 1.219758, loss_d: 0.283462
0.5460 --- loss: 1.759274, loss_ss: 1.183667, loss_d: 0.575606
0.6240 --- loss: 1.492637, loss_ss: 1.212782, loss_d: 0.279855
0.7020 --- loss: 1.439403, loss_ss: 1.217106, loss_d: 0.222297
0.7800 --- loss: 1.478384, loss_ss: 1.170236, loss_d: 0.308148
0.8580 --- loss: 1.458821, loss_ss: 1.147909, loss_d: 0.310912
0.9360 --- loss: 1.783472, loss_ss: 1.155854, loss_d: 0.627618
Epoch finished! Loss: 1.6804354591295123
Starting epoch 3/10.
0.0000 --- loss: 1.527513, loss_ss: 1.091319, loss_d: 0.436194
0.0780 --- loss: 1.438531, loss_ss: 1.214734, loss_d: 0.223798
0.1560 --- loss: 1.493213, loss_ss: 1.129399, loss_d: 0.363814
0.2340 --- loss: 1.380262, loss_ss: 1.080273, loss_d: 0.299988
0.3120 --- loss: 1.286790, loss_ss: 1.064184, loss_d: 0.222605
0.3900 --- loss: 1.555524, loss_ss: 1.141714, loss_d: 0.413810
0.4680 --- loss: 1.211034, loss_ss: 1.057172, loss_d: 0.153862
0.5460 --- loss: 1.661490, loss_ss: 1.165497, loss_d: 0.495993
0.6240 --- loss: 1.567420, loss_ss: 1.143295, loss_d: 0.424125
0.7020 --- loss: 1.291531, loss_ss: 1.045274, loss_d: 0.246257
0.7800 --- loss: 1.596862, loss_ss: 1.340635, loss_d: 0.256227
0.8580 --- loss: 1.197031, loss_ss: 1.063342, loss_d: 0.133690
0.9360 --- loss: 1.410800, loss_ss: 0.955517, loss_d: 0.455283
Epoch finished! Loss: 1.4681463744491339
Starting epoch 4/10.
0.0000 --- loss: 1.198798, loss_ss: 1.060166, loss_d: 0.138633
0.0780 --- loss: 1.086838, loss_ss: 1.020859, loss_d: 0.065979
0.1560 --- loss: 1.240141, loss_ss: 1.044246, loss_d: 0.195895
0.2340 --- loss: 1.457721, loss_ss: 1.158047, loss_d: 0.299674
0.3120 --- loss: 1.174238, loss_ss: 1.029194, loss_d: 0.145045
0.3900 --- loss: 1.662510, loss_ss: 1.489361, loss_d: 0.173149
0.4680 --- loss: 1.453491, loss_ss: 1.139230, loss_d: 0.314261
0.5460 --- loss: 1.088766, loss_ss: 0.862126, loss_d: 0.226639
0.6240 --- loss: 1.119921, loss_ss: 0.891589, loss_d: 0.228333
0.7020 --- loss: 1.146937, loss_ss: 0.959109, loss_d: 0.187828
0.7800 --- loss: 1.225554, loss_ss: 0.876735, loss_d: 0.348819
0.8580 --- loss: 1.148144, loss_ss: 1.039557, loss_d: 0.108587
0.9360 --- loss: 1.373180, loss_ss: 0.997786, loss_d: 0.375394
Epoch finished! Loss: 1.2989833392202854
Starting epoch 5/10.
0.0000 --- loss: 0.904412, loss_ss: 0.840000, loss_d: 0.064412
0.0780 --- loss: 1.018383, loss_ss: 0.945852, loss_d: 0.072531
0.1560 --- loss: 1.664697, loss_ss: 1.233596, loss_d: 0.431101
0.2340 --- loss: 1.175315, loss_ss: 0.950921, loss_d: 0.224394
0.3120 --- loss: 0.923826, loss_ss: 0.832978, loss_d: 0.090848
0.3900 --- loss: 1.240163, loss_ss: 1.181815, loss_d: 0.058348
0.4680 --- loss: 1.501235, loss_ss: 1.119322, loss_d: 0.381914
0.5460 --- loss: 1.723696, loss_ss: 0.943857, loss_d: 0.779839
0.6240 --- loss: 1.209596, loss_ss: 0.872186, loss_d: 0.337410
0.7020 --- loss: 1.088701, loss_ss: 0.959684, loss_d: 0.129017
0.7800 --- loss: 1.399336, loss_ss: 0.947697, loss_d: 0.451640
0.8580 --- loss: 1.169419, loss_ss: 1.081077, loss_d: 0.088342
0.9360 --- loss: 1.293163, loss_ss: 1.008550, loss_d: 0.284613
Epoch finished! Loss: 1.1767781963571906
Starting epoch 6/10.
0.0000 --- loss: 1.170443, loss_ss: 1.014974, loss_d: 0.155469
0.0780 --- loss: 1.124280, loss_ss: 1.012902, loss_d: 0.111379
0.1560 --- loss: 1.006706, loss_ss: 0.916320, loss_d: 0.090385
0.2340 --- loss: 1.135230, loss_ss: 0.887843, loss_d: 0.247387
0.3120 --- loss: 0.928187, loss_ss: 0.895460, loss_d: 0.032727
0.3900 --- loss: 0.939332, loss_ss: 0.862614, loss_d: 0.076718
0.4680 --- loss: 1.250895, loss_ss: 0.992069, loss_d: 0.258826
0.5460 --- loss: 0.924841, loss_ss: 0.872889, loss_d: 0.051952
0.6240 --- loss: 0.991999, loss_ss: 0.883604, loss_d: 0.108395
0.7020 --- loss: 1.268142, loss_ss: 0.901664, loss_d: 0.366477
0.7800 --- loss: 1.136903, loss_ss: 0.884563, loss_d: 0.252340
0.8580 --- loss: 1.012481, loss_ss: 0.953274, loss_d: 0.059207
0.9360 --- loss: 1.242512, loss_ss: 0.928841, loss_d: 0.313672
Epoch finished! Loss: 1.0605019629001617
Starting epoch 7/10.
0.0000 --- loss: 0.876099, loss_ss: 0.766313, loss_d: 0.109785
0.0780 --- loss: 0.892049, loss_ss: 0.690561, loss_d: 0.201488
0.1560 --- loss: 1.057282, loss_ss: 1.042236, loss_d: 0.015046
0.2340 --- loss: 1.061633, loss_ss: 0.956931, loss_d: 0.104702
0.3120 --- loss: 0.855262, loss_ss: 0.827993, loss_d: 0.027269
0.3900 --- loss: 0.983971, loss_ss: 0.975060, loss_d: 0.008911
0.4680 --- loss: 0.860510, loss_ss: 0.838593, loss_d: 0.021917
0.5460 --- loss: 0.675487, loss_ss: 0.665173, loss_d: 0.010314
0.6240 --- loss: 0.963831, loss_ss: 0.957194, loss_d: 0.006638
0.7020 --- loss: 0.977465, loss_ss: 0.926102, loss_d: 0.051362
0.7800 --- loss: 1.135496, loss_ss: 0.860746, loss_d: 0.274751
0.8580 --- loss: 0.949507, loss_ss: 0.941955, loss_d: 0.007553
0.9360 --- loss: 1.072783, loss_ss: 0.744272, loss_d: 0.328511
Epoch finished! Loss: 1.0112311551347375
Starting epoch 8/10.
0.0000 --- loss: 0.901843, loss_ss: 0.881555, loss_d: 0.020288
0.0780 --- loss: 0.969261, loss_ss: 0.960008, loss_d: 0.009253
0.1560 --- loss: 0.912240, loss_ss: 0.801428, loss_d: 0.110811
0.2340 --- loss: 0.990758, loss_ss: 0.957925, loss_d: 0.032833
0.3120 --- loss: 1.001782, loss_ss: 0.940541, loss_d: 0.061241
0.3900 --- loss: 0.835715, loss_ss: 0.814017, loss_d: 0.021698
0.4680 --- loss: 0.748768, loss_ss: 0.725776, loss_d: 0.022993
0.5460 --- loss: 1.458160, loss_ss: 1.188405, loss_d: 0.269755
0.6240 --- loss: 0.862132, loss_ss: 0.815566, loss_d: 0.046567
0.7020 --- loss: 1.050010, loss_ss: 1.041535, loss_d: 0.008474
0.7800 --- loss: 1.218778, loss_ss: 1.113711, loss_d: 0.105068
0.8580 --- loss: 0.932912, loss_ss: 0.904242, loss_d: 0.028670
0.9360 --- loss: 0.828205, loss_ss: 0.805497, loss_d: 0.022708
Epoch finished! Loss: 1.0119552831165493
Starting epoch 9/10.
0.0000 --- loss: 0.744092, loss_ss: 0.737736, loss_d: 0.006356
0.0780 --- loss: 0.936673, loss_ss: 0.921141, loss_d: 0.015532
0.1560 --- loss: 0.955907, loss_ss: 0.949385, loss_d: 0.006522
0.2340 --- loss: 0.764383, loss_ss: 0.761559, loss_d: 0.002824
0.3120 --- loss: 0.893618, loss_ss: 0.838967, loss_d: 0.054651
0.3900 --- loss: 0.851829, loss_ss: 0.848878, loss_d: 0.002950
0.4680 --- loss: 0.802121, loss_ss: 0.798085, loss_d: 0.004036
0.5460 --- loss: 0.868701, loss_ss: 0.725223, loss_d: 0.143478
0.6240 --- loss: 0.830707, loss_ss: 0.820932, loss_d: 0.009775
0.7020 --- loss: 1.030040, loss_ss: 0.995346, loss_d: 0.034694
0.7800 --- loss: 0.671136, loss_ss: 0.661363, loss_d: 0.009773
0.8580 --- loss: 0.854157, loss_ss: 0.836998, loss_d: 0.017159
0.9360 --- loss: 0.836177, loss_ss: 0.830734, loss_d: 0.005443
Epoch finished! Loss: 0.9416340021416545
Starting epoch 10/10.
0.0000 --- loss: 0.808891, loss_ss: 0.738305, loss_d: 0.070585
0.0780 --- loss: 0.817715, loss_ss: 0.707015, loss_d: 0.110700
0.1560 --- loss: 0.827433, loss_ss: 0.804564, loss_d: 0.022868
0.2340 --- loss: 1.205572, loss_ss: 1.202307, loss_d: 0.003265
0.3120 --- loss: 0.746271, loss_ss: 0.719502, loss_d: 0.026769
0.3900 --- loss: 0.739152, loss_ss: 0.728038, loss_d: 0.011115
0.4680 --- loss: 0.791424, loss_ss: 0.785999, loss_d: 0.005424
0.5460 --- loss: 1.226761, loss_ss: 0.835179, loss_d: 0.391582
0.6240 --- loss: 0.999735, loss_ss: 0.857945, loss_d: 0.141790
0.7020 --- loss: 0.907035, loss_ss: 0.890538, loss_d: 0.016498
0.7800 --- loss: 1.025780, loss_ss: 0.928363, loss_d: 0.097416
0.8580 --- loss: 0.868323, loss_ss: 0.822250, loss_d: 0.046073
0.9360 --- loss: 0.786642, loss_ss: 0.682358, loss_d: 0.104283
Epoch finished! Loss: 0.9444859507493675
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5407407407407407
             precision    recall  f1-score   support

        0.0       0.08      1.00      0.15        19
        1.0       0.54      0.59      0.56       325
        2.0       0.78      0.45      0.57       376
        3.0       1.00      0.75      0.86       199
        4.0       0.48      0.34      0.40       161

avg / total       0.69      0.54      0.59      1080
 


====== chp039-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  79.26  100.00   78.89    7.82     14.50
1  72.41   59.38   78.01   53.76     56.43
2  76.39   44.68   93.32   78.14     56.85
3  95.37   74.87  100.00  100.00     85.63
4  84.72   34.16   93.58   48.25     40.00
Total accuracy: 54.07%
Average sen: 62.62%
Average spec: 88.76%
Macro f1-score: 50.68%
Diagnosis acc on 30mins: 1.0
[0.99999988 0.99980301 0.9999975  1.         1.         1.
 0.9999994  0.99999964 0.99986672 0.99999928 0.99988699 1.
 1.         1.         0.99999952 1.         1.         0.99999917]
pred: 0.9999750620788999, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp039-nsrr

=== Test on chp040-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.170628, loss_ss: 1.465296, loss_d: 0.705332
0.0779 --- loss: 2.238049, loss_ss: 1.640891, loss_d: 0.597158
0.1559 --- loss: 2.236183, loss_ss: 1.501444, loss_d: 0.734739
0.2338 --- loss: 1.993430, loss_ss: 1.431996, loss_d: 0.561433
0.3118 --- loss: 2.192560, loss_ss: 1.410045, loss_d: 0.782515
0.3897 --- loss: 2.143711, loss_ss: 1.428164, loss_d: 0.715547
0.4677 --- loss: 1.862429, loss_ss: 1.462235, loss_d: 0.400194
0.5456 --- loss: 1.847363, loss_ss: 1.414985, loss_d: 0.432378
0.6235 --- loss: 1.885217, loss_ss: 1.273036, loss_d: 0.612180
0.7015 --- loss: 1.968250, loss_ss: 1.284446, loss_d: 0.683803
0.7794 --- loss: 1.872415, loss_ss: 1.232450, loss_d: 0.639965
0.8574 --- loss: 2.018166, loss_ss: 1.334366, loss_d: 0.683800
0.9353 --- loss: 1.673594, loss_ss: 1.202007, loss_d: 0.471586
Epoch finished! Loss: 1.961503691971302
Starting epoch 2/10.
0.0000 --- loss: 1.647555, loss_ss: 1.197154, loss_d: 0.450401
0.0779 --- loss: 1.762992, loss_ss: 1.211388, loss_d: 0.551604
0.1559 --- loss: 1.596189, loss_ss: 1.166310, loss_d: 0.429879
0.2338 --- loss: 1.833846, loss_ss: 1.385473, loss_d: 0.448372
0.3118 --- loss: 1.570109, loss_ss: 1.205045, loss_d: 0.365064
0.3897 --- loss: 1.703944, loss_ss: 1.222716, loss_d: 0.481228
0.4677 --- loss: 1.456616, loss_ss: 1.322146, loss_d: 0.134470
0.5456 --- loss: 1.576516, loss_ss: 1.323259, loss_d: 0.253258
0.6235 --- loss: 1.234015, loss_ss: 1.104205, loss_d: 0.129810
0.7015 --- loss: 1.658838, loss_ss: 1.405895, loss_d: 0.252943
0.7794 --- loss: 1.848268, loss_ss: 1.070099, loss_d: 0.778169
0.8574 --- loss: 1.634779, loss_ss: 1.224414, loss_d: 0.410365
0.9353 --- loss: 1.595795, loss_ss: 1.179709, loss_d: 0.416086
Epoch finished! Loss: 1.7115278085693717
Starting epoch 3/10.
0.0000 --- loss: 1.576833, loss_ss: 1.209709, loss_d: 0.367124
0.0779 --- loss: 1.449236, loss_ss: 1.126319, loss_d: 0.322917
0.1559 --- loss: 1.351219, loss_ss: 1.042886, loss_d: 0.308333
0.2338 --- loss: 1.314571, loss_ss: 1.117472, loss_d: 0.197098
0.3118 --- loss: 1.155738, loss_ss: 1.082087, loss_d: 0.073652
0.3897 --- loss: 1.301710, loss_ss: 1.086614, loss_d: 0.215096
0.4677 --- loss: 1.375799, loss_ss: 1.027025, loss_d: 0.348775
0.5456 --- loss: 1.393027, loss_ss: 1.177409, loss_d: 0.215618
0.6235 --- loss: 1.733816, loss_ss: 1.412170, loss_d: 0.321646
0.7015 --- loss: 1.731943, loss_ss: 1.323297, loss_d: 0.408645
0.7794 --- loss: 1.659301, loss_ss: 1.117859, loss_d: 0.541442
0.8574 --- loss: 1.772564, loss_ss: 1.141076, loss_d: 0.631488
0.9353 --- loss: 1.750082, loss_ss: 1.078342, loss_d: 0.671740
Epoch finished! Loss: 1.4965424910187721
Starting epoch 4/10.
0.0000 --- loss: 1.563059, loss_ss: 1.101097, loss_d: 0.461962
0.0779 --- loss: 1.431037, loss_ss: 1.147462, loss_d: 0.283575
0.1559 --- loss: 1.325855, loss_ss: 1.151182, loss_d: 0.174673
0.2338 --- loss: 1.517162, loss_ss: 1.337122, loss_d: 0.180040
0.3118 --- loss: 1.469290, loss_ss: 1.327507, loss_d: 0.141783
0.3897 --- loss: 1.207623, loss_ss: 1.110639, loss_d: 0.096984
0.4677 --- loss: 1.304306, loss_ss: 1.079356, loss_d: 0.224950
0.5456 --- loss: 1.150583, loss_ss: 0.974136, loss_d: 0.176446
0.6235 --- loss: 1.030272, loss_ss: 0.924028, loss_d: 0.106245
0.7015 --- loss: 1.196578, loss_ss: 1.052782, loss_d: 0.143797
0.7794 --- loss: 1.290288, loss_ss: 0.974828, loss_d: 0.315460
0.8574 --- loss: 1.120971, loss_ss: 0.976375, loss_d: 0.144596
0.9353 --- loss: 1.851376, loss_ss: 1.099529, loss_d: 0.751847
Epoch finished! Loss: 1.2973266462795436
Starting epoch 5/10.
0.0000 --- loss: 1.272036, loss_ss: 1.025145, loss_d: 0.246892
0.0779 --- loss: 1.003915, loss_ss: 0.891750, loss_d: 0.112165
0.1559 --- loss: 1.317586, loss_ss: 1.076539, loss_d: 0.241047
0.2338 --- loss: 1.524109, loss_ss: 1.483318, loss_d: 0.040791
0.3118 --- loss: 0.948291, loss_ss: 0.909893, loss_d: 0.038398
0.3897 --- loss: 1.291043, loss_ss: 1.200713, loss_d: 0.090330
0.4677 --- loss: 1.049093, loss_ss: 0.906210, loss_d: 0.142883
0.5456 --- loss: 1.155228, loss_ss: 0.983121, loss_d: 0.172107
0.6235 --- loss: 0.876698, loss_ss: 0.734476, loss_d: 0.142223
0.7015 --- loss: 0.999689, loss_ss: 0.941354, loss_d: 0.058335
0.7794 --- loss: 1.334599, loss_ss: 0.973709, loss_d: 0.360890
0.8574 --- loss: 1.231135, loss_ss: 1.106703, loss_d: 0.124432
0.9353 --- loss: 1.179643, loss_ss: 0.999819, loss_d: 0.179825
Epoch finished! Loss: 1.1944855912588537
Starting epoch 6/10.
0.0000 --- loss: 1.166979, loss_ss: 1.064781, loss_d: 0.102197
0.0779 --- loss: 1.181346, loss_ss: 1.006938, loss_d: 0.174408
0.1559 --- loss: 1.237800, loss_ss: 1.065505, loss_d: 0.172295
0.2338 --- loss: 0.992358, loss_ss: 0.921289, loss_d: 0.071069
0.3118 --- loss: 1.013615, loss_ss: 0.963207, loss_d: 0.050408
0.3897 --- loss: 0.919418, loss_ss: 0.869898, loss_d: 0.049520
0.4677 --- loss: 1.069220, loss_ss: 0.874319, loss_d: 0.194901
0.5456 --- loss: 0.887462, loss_ss: 0.789323, loss_d: 0.098139
0.6235 --- loss: 0.906342, loss_ss: 0.896689, loss_d: 0.009653
0.7015 --- loss: 0.935518, loss_ss: 0.863233, loss_d: 0.072284
0.7794 --- loss: 1.744991, loss_ss: 0.827567, loss_d: 0.917424
0.8574 --- loss: 1.294812, loss_ss: 0.989389, loss_d: 0.305423
0.9353 --- loss: 1.390739, loss_ss: 0.944245, loss_d: 0.446494
Epoch finished! Loss: 1.1136436727829278
Starting epoch 7/10.
0.0000 --- loss: 0.957499, loss_ss: 0.929150, loss_d: 0.028349
0.0779 --- loss: 0.807279, loss_ss: 0.788404, loss_d: 0.018875
0.1559 --- loss: 0.916377, loss_ss: 0.888575, loss_d: 0.027802
0.2338 --- loss: 0.931948, loss_ss: 0.901332, loss_d: 0.030616
0.3118 --- loss: 0.846726, loss_ss: 0.825301, loss_d: 0.021426
0.3897 --- loss: 0.929626, loss_ss: 0.916442, loss_d: 0.013184
0.4677 --- loss: 0.870024, loss_ss: 0.842726, loss_d: 0.027298
0.5456 --- loss: 0.861029, loss_ss: 0.849954, loss_d: 0.011075
0.6235 --- loss: 1.004460, loss_ss: 0.900979, loss_d: 0.103481
0.7015 --- loss: 0.968744, loss_ss: 0.929274, loss_d: 0.039470
0.7794 --- loss: 1.229884, loss_ss: 1.190449, loss_d: 0.039435
0.8574 --- loss: 0.896898, loss_ss: 0.837386, loss_d: 0.059513
0.9353 --- loss: 0.918735, loss_ss: 0.914994, loss_d: 0.003741
Epoch finished! Loss: 1.0369620900601149
Starting epoch 8/10.
0.0000 --- loss: 1.275157, loss_ss: 0.854188, loss_d: 0.420970
0.0779 --- loss: 1.261928, loss_ss: 1.152943, loss_d: 0.108985
0.1559 --- loss: 1.123047, loss_ss: 1.110011, loss_d: 0.013036
0.2338 --- loss: 0.779659, loss_ss: 0.771226, loss_d: 0.008432
0.3118 --- loss: 0.912598, loss_ss: 0.886355, loss_d: 0.026243
0.3897 --- loss: 0.778616, loss_ss: 0.759958, loss_d: 0.018658
0.4677 --- loss: 0.905111, loss_ss: 0.871510, loss_d: 0.033601
0.5456 --- loss: 1.021582, loss_ss: 0.888050, loss_d: 0.133533
0.6235 --- loss: 0.954002, loss_ss: 0.878673, loss_d: 0.075329
0.7015 --- loss: 0.997902, loss_ss: 0.958748, loss_d: 0.039155
0.7794 --- loss: 0.994386, loss_ss: 0.772615, loss_d: 0.221770
0.8574 --- loss: 1.027853, loss_ss: 0.989041, loss_d: 0.038812
0.9353 --- loss: 0.816790, loss_ss: 0.807389, loss_d: 0.009402
Epoch finished! Loss: 1.0288255088962615
Starting epoch 9/10.
0.0000 --- loss: 0.772917, loss_ss: 0.751573, loss_d: 0.021343
0.0779 --- loss: 0.856503, loss_ss: 0.838795, loss_d: 0.017708
0.1559 --- loss: 0.915846, loss_ss: 0.838697, loss_d: 0.077149
0.2338 --- loss: 0.797084, loss_ss: 0.788475, loss_d: 0.008609
0.3118 --- loss: 0.931112, loss_ss: 0.922904, loss_d: 0.008208
0.3897 --- loss: 0.759089, loss_ss: 0.754695, loss_d: 0.004393
0.4677 --- loss: 0.761976, loss_ss: 0.740835, loss_d: 0.021141
0.5456 --- loss: 1.260841, loss_ss: 0.974654, loss_d: 0.286187
0.6235 --- loss: 1.345348, loss_ss: 1.024044, loss_d: 0.321304
0.7015 --- loss: 0.941994, loss_ss: 0.807621, loss_d: 0.134372
0.7794 --- loss: 1.143492, loss_ss: 0.939225, loss_d: 0.204268
0.8574 --- loss: 1.051527, loss_ss: 1.041543, loss_d: 0.009984
0.9353 --- loss: 1.161397, loss_ss: 0.919504, loss_d: 0.241892
Epoch finished! Loss: 0.9947349261492491
Starting epoch 10/10.
0.0000 --- loss: 1.380177, loss_ss: 1.044842, loss_d: 0.335335
0.0779 --- loss: 0.821958, loss_ss: 0.805028, loss_d: 0.016930
0.1559 --- loss: 0.959136, loss_ss: 0.944733, loss_d: 0.014402
0.2338 --- loss: 1.166247, loss_ss: 1.146890, loss_d: 0.019356
0.3118 --- loss: 0.851666, loss_ss: 0.847299, loss_d: 0.004368
0.3897 --- loss: 0.847907, loss_ss: 0.817771, loss_d: 0.030136
0.4677 --- loss: 0.772756, loss_ss: 0.766759, loss_d: 0.005997
0.5456 --- loss: 1.086854, loss_ss: 1.008470, loss_d: 0.078384
0.6235 --- loss: 1.087554, loss_ss: 1.075593, loss_d: 0.011962
0.7015 --- loss: 1.037600, loss_ss: 1.029046, loss_d: 0.008554
0.7794 --- loss: 0.625013, loss_ss: 0.620539, loss_d: 0.004473
0.8574 --- loss: 1.038929, loss_ss: 0.989380, loss_d: 0.049549
0.9353 --- loss: 0.811465, loss_ss: 0.776568, loss_d: 0.034897
Epoch finished! Loss: 0.9641583417542279
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.703921568627451
             precision    recall  f1-score   support

        0.0       0.92      0.70      0.79       163
        1.0       0.55      0.08      0.15       142
        2.0       0.73      0.83      0.78       307
        3.0       0.95      0.68      0.79       192
        4.0       0.54      0.95      0.69       216

avg / total       0.73      0.70      0.67      1020
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.22  69.94   98.83  91.94     79.44
1  86.27   8.45   98.86  54.55     14.63
2  85.49  83.39   86.40  72.52     77.58
3  93.24  67.71   99.15  94.89     79.03
4  81.57  95.37   77.86  53.65     68.67
Total accuracy: 70.39%
Average sen: 64.97%
Average spec: 92.22%
Macro f1-score: 63.87%
Diagnosis acc on 30mins: 1.0
[0.96496403 0.99999428 0.99992263 0.9988153  0.9890911  0.99986899
 0.99821991 0.99911827 0.99995315 0.99999559 0.99994171 0.99994719
 0.99989474 0.99980599 0.99944371 0.99999607 0.98628205]
pred: 0.9961914525312536, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp040-nsrr

=== Test on chp041-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.447820, loss_ss: 1.818322, loss_d: 0.629498
0.0780 --- loss: 2.361827, loss_ss: 1.669401, loss_d: 0.692427
0.1560 --- loss: 2.285119, loss_ss: 1.585720, loss_d: 0.699399
0.2340 --- loss: 2.336296, loss_ss: 1.585077, loss_d: 0.751219
0.3120 --- loss: 2.104821, loss_ss: 1.581832, loss_d: 0.522989
0.3900 --- loss: 1.968655, loss_ss: 1.567918, loss_d: 0.400737
0.4680 --- loss: 2.027082, loss_ss: 1.437788, loss_d: 0.589294
0.5460 --- loss: 2.193057, loss_ss: 1.459045, loss_d: 0.734012
0.6240 --- loss: 1.725607, loss_ss: 1.387030, loss_d: 0.338577
0.7020 --- loss: 1.996858, loss_ss: 1.398861, loss_d: 0.597997
0.7800 --- loss: 1.681576, loss_ss: 1.379675, loss_d: 0.301901
0.8580 --- loss: 1.730324, loss_ss: 1.356608, loss_d: 0.373716
0.9360 --- loss: 1.871943, loss_ss: 1.369587, loss_d: 0.502356
Epoch finished! Loss: 2.1084900042042136
Starting epoch 2/10.
0.0000 --- loss: 1.813852, loss_ss: 1.351995, loss_d: 0.461857
0.0780 --- loss: 1.756135, loss_ss: 1.342231, loss_d: 0.413904
0.1560 --- loss: 1.678576, loss_ss: 1.380750, loss_d: 0.297826
0.2340 --- loss: 1.549912, loss_ss: 1.229362, loss_d: 0.320550
0.3120 --- loss: 1.706484, loss_ss: 1.131491, loss_d: 0.574993
0.3900 --- loss: 2.026636, loss_ss: 1.297004, loss_d: 0.729633
0.4680 --- loss: 1.716535, loss_ss: 1.268656, loss_d: 0.447879
0.5460 --- loss: 1.457565, loss_ss: 1.194152, loss_d: 0.263412
0.6240 --- loss: 1.510821, loss_ss: 1.130766, loss_d: 0.380055
0.7020 --- loss: 1.927113, loss_ss: 1.262160, loss_d: 0.664953
0.7800 --- loss: 1.496760, loss_ss: 1.309285, loss_d: 0.187475
0.8580 --- loss: 1.747684, loss_ss: 1.284551, loss_d: 0.463132
0.9360 --- loss: 1.424598, loss_ss: 1.175853, loss_d: 0.248745
Epoch finished! Loss: 1.7251665610820055
Starting epoch 3/10.
0.0000 --- loss: 1.615314, loss_ss: 1.201303, loss_d: 0.414011
0.0780 --- loss: 1.604078, loss_ss: 1.149840, loss_d: 0.454238
0.1560 --- loss: 1.647687, loss_ss: 1.064039, loss_d: 0.583648
0.2340 --- loss: 1.491832, loss_ss: 1.236483, loss_d: 0.255349
0.3120 --- loss: 1.374329, loss_ss: 1.108644, loss_d: 0.265685
0.3900 --- loss: 1.713794, loss_ss: 1.161612, loss_d: 0.552182
0.4680 --- loss: 1.538455, loss_ss: 1.282745, loss_d: 0.255710
0.5460 --- loss: 1.494907, loss_ss: 1.006374, loss_d: 0.488533
0.6240 --- loss: 1.187376, loss_ss: 1.064863, loss_d: 0.122513
0.7020 --- loss: 1.574043, loss_ss: 1.204015, loss_d: 0.370027
0.7800 --- loss: 2.174369, loss_ss: 0.944637, loss_d: 1.229732
0.8580 --- loss: 1.287402, loss_ss: 1.045426, loss_d: 0.241976
0.9360 --- loss: 1.139132, loss_ss: 1.032784, loss_d: 0.106347
Epoch finished! Loss: 1.477314612828195
Starting epoch 4/10.
0.0000 --- loss: 1.176886, loss_ss: 1.111990, loss_d: 0.064896
0.0780 --- loss: 1.234914, loss_ss: 0.986665, loss_d: 0.248249
0.1560 --- loss: 1.195930, loss_ss: 0.979223, loss_d: 0.216706
0.2340 --- loss: 1.263994, loss_ss: 0.994053, loss_d: 0.269942
0.3120 --- loss: 1.073541, loss_ss: 0.875477, loss_d: 0.198063
0.3900 --- loss: 1.256907, loss_ss: 0.783330, loss_d: 0.473576
0.4680 --- loss: 1.229327, loss_ss: 0.893814, loss_d: 0.335513
0.5460 --- loss: 0.974357, loss_ss: 0.888274, loss_d: 0.086083
0.6240 --- loss: 0.992808, loss_ss: 0.942893, loss_d: 0.049915
0.7020 --- loss: 1.539317, loss_ss: 1.151443, loss_d: 0.387874
0.7800 --- loss: 1.230999, loss_ss: 0.935090, loss_d: 0.295909
0.8580 --- loss: 1.294413, loss_ss: 1.032457, loss_d: 0.261957
0.9360 --- loss: 1.591882, loss_ss: 1.109779, loss_d: 0.482103
Epoch finished! Loss: 1.3122553462162614
Starting epoch 5/10.
0.0000 --- loss: 1.280476, loss_ss: 1.161748, loss_d: 0.118728
0.0780 --- loss: 1.097750, loss_ss: 0.915730, loss_d: 0.182020
0.1560 --- loss: 0.946412, loss_ss: 0.800038, loss_d: 0.146374
0.2340 --- loss: 1.494658, loss_ss: 1.061805, loss_d: 0.432854
0.3120 --- loss: 1.286212, loss_ss: 0.913722, loss_d: 0.372490
0.3900 --- loss: 1.491563, loss_ss: 1.020804, loss_d: 0.470759
0.4680 --- loss: 0.939624, loss_ss: 0.871961, loss_d: 0.067663
0.5460 --- loss: 1.030638, loss_ss: 0.935098, loss_d: 0.095540
0.6240 --- loss: 1.207601, loss_ss: 0.815525, loss_d: 0.392076
0.7020 --- loss: 1.143311, loss_ss: 1.071503, loss_d: 0.071808
0.7800 --- loss: 0.890078, loss_ss: 0.844290, loss_d: 0.045788
0.8580 --- loss: 1.076664, loss_ss: 1.053265, loss_d: 0.023399
0.9360 --- loss: 1.532837, loss_ss: 1.035449, loss_d: 0.497388
Epoch finished! Loss: 1.1781999911181629
Starting epoch 6/10.
0.0000 --- loss: 1.038348, loss_ss: 1.015488, loss_d: 0.022861
0.0780 --- loss: 0.928037, loss_ss: 0.881699, loss_d: 0.046338
0.1560 --- loss: 1.157243, loss_ss: 1.027835, loss_d: 0.129407
0.2340 --- loss: 1.275090, loss_ss: 1.073213, loss_d: 0.201877
0.3120 --- loss: 0.915577, loss_ss: 0.864830, loss_d: 0.050747
0.3900 --- loss: 1.076817, loss_ss: 0.899310, loss_d: 0.177506
0.4680 --- loss: 1.098646, loss_ss: 0.939253, loss_d: 0.159393
0.5460 --- loss: 0.922927, loss_ss: 0.905494, loss_d: 0.017433
0.6240 --- loss: 0.931978, loss_ss: 0.811410, loss_d: 0.120567
0.7020 --- loss: 1.009820, loss_ss: 0.970717, loss_d: 0.039103
0.7800 --- loss: 0.958081, loss_ss: 0.929036, loss_d: 0.029045
0.8580 --- loss: 0.963270, loss_ss: 0.900162, loss_d: 0.063108
0.9360 --- loss: 1.071086, loss_ss: 0.904550, loss_d: 0.166536
Epoch finished! Loss: 1.1031465665437281
Starting epoch 7/10.
0.0000 --- loss: 1.093674, loss_ss: 1.028466, loss_d: 0.065208
0.0780 --- loss: 0.920522, loss_ss: 0.892491, loss_d: 0.028030
0.1560 --- loss: 1.039623, loss_ss: 0.882835, loss_d: 0.156788
0.2340 --- loss: 1.127622, loss_ss: 0.954761, loss_d: 0.172862
0.3120 --- loss: 0.834683, loss_ss: 0.775858, loss_d: 0.058825
0.3900 --- loss: 1.005429, loss_ss: 0.832133, loss_d: 0.173296
0.4680 --- loss: 0.815131, loss_ss: 0.787128, loss_d: 0.028003
0.5460 --- loss: 0.983994, loss_ss: 0.910232, loss_d: 0.073762
0.6240 --- loss: 0.959814, loss_ss: 0.875948, loss_d: 0.083866
0.7020 --- loss: 1.413673, loss_ss: 1.182301, loss_d: 0.231372
0.7800 --- loss: 1.010622, loss_ss: 0.956551, loss_d: 0.054070
0.8580 --- loss: 1.309377, loss_ss: 0.980332, loss_d: 0.329044
0.9360 --- loss: 1.030034, loss_ss: 0.934416, loss_d: 0.095618
Epoch finished! Loss: 1.041167405899614
Starting epoch 8/10.
0.0000 --- loss: 1.085613, loss_ss: 1.082349, loss_d: 0.003264
0.0780 --- loss: 0.986015, loss_ss: 0.798655, loss_d: 0.187360
0.1560 --- loss: 0.908224, loss_ss: 0.795943, loss_d: 0.112281
0.2340 --- loss: 0.945084, loss_ss: 0.905655, loss_d: 0.039429
0.3120 --- loss: 0.992595, loss_ss: 0.976323, loss_d: 0.016272
0.3900 --- loss: 0.825073, loss_ss: 0.720801, loss_d: 0.104273
0.4680 --- loss: 0.940298, loss_ss: 0.889997, loss_d: 0.050301
0.5460 --- loss: 0.907654, loss_ss: 0.767557, loss_d: 0.140097
0.6240 --- loss: 0.798574, loss_ss: 0.785412, loss_d: 0.013162
0.7020 --- loss: 0.769567, loss_ss: 0.759772, loss_d: 0.009795
0.7800 --- loss: 1.105093, loss_ss: 1.093404, loss_d: 0.011690
0.8580 --- loss: 1.016777, loss_ss: 0.963279, loss_d: 0.053498
0.9360 --- loss: 0.978856, loss_ss: 0.972032, loss_d: 0.006824
Epoch finished! Loss: 1.0235623205080628
Starting epoch 9/10.
0.0000 --- loss: 0.883519, loss_ss: 0.881557, loss_d: 0.001962
0.0780 --- loss: 0.892784, loss_ss: 0.875363, loss_d: 0.017421
0.1560 --- loss: 0.746655, loss_ss: 0.737707, loss_d: 0.008948
0.2340 --- loss: 0.882615, loss_ss: 0.847678, loss_d: 0.034937
0.3120 --- loss: 1.407734, loss_ss: 1.073533, loss_d: 0.334201
0.3900 --- loss: 0.821582, loss_ss: 0.809051, loss_d: 0.012531
0.4680 --- loss: 1.406236, loss_ss: 0.964843, loss_d: 0.441393
0.5460 --- loss: 0.926202, loss_ss: 0.883317, loss_d: 0.042885
0.6240 --- loss: 0.982201, loss_ss: 0.876360, loss_d: 0.105840
0.7020 --- loss: 0.988871, loss_ss: 0.980065, loss_d: 0.008806
0.7800 --- loss: 1.169706, loss_ss: 1.163506, loss_d: 0.006200
0.8580 --- loss: 0.736549, loss_ss: 0.698018, loss_d: 0.038531
0.9360 --- loss: 1.159660, loss_ss: 1.014601, loss_d: 0.145059
Epoch finished! Loss: 1.0245467508211732
Starting epoch 10/10.
0.0000 --- loss: 0.938730, loss_ss: 0.923630, loss_d: 0.015100
0.0780 --- loss: 0.738212, loss_ss: 0.735258, loss_d: 0.002954
0.1560 --- loss: 0.954787, loss_ss: 0.867143, loss_d: 0.087644
0.2340 --- loss: 1.354745, loss_ss: 1.233099, loss_d: 0.121646
0.3120 --- loss: 0.714273, loss_ss: 0.707369, loss_d: 0.006904
0.3900 --- loss: 0.729470, loss_ss: 0.696218, loss_d: 0.033252
0.4680 --- loss: 0.849257, loss_ss: 0.842507, loss_d: 0.006750
0.5460 --- loss: 0.871718, loss_ss: 0.840608, loss_d: 0.031109
0.6240 --- loss: 0.798441, loss_ss: 0.791118, loss_d: 0.007323
0.7020 --- loss: 0.857055, loss_ss: 0.822391, loss_d: 0.034664
0.7800 --- loss: 1.631073, loss_ss: 1.480544, loss_d: 0.150528
0.8580 --- loss: 0.767796, loss_ss: 0.748009, loss_d: 0.019787
0.9360 --- loss: 0.777654, loss_ss: 0.759031, loss_d: 0.018623
Epoch finished! Loss: 0.9430767088197172
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7537037037037037
             precision    recall  f1-score   support

        0.0       0.63      0.83      0.72       196
        1.0       0.15      0.12      0.13        58
        2.0       0.90      0.84      0.87       527
        3.0       0.80      0.48      0.60        33
        4.0       0.71      0.70      0.70       266

avg / total       0.76      0.75      0.75      1080
 


====== chp041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.15  82.65   89.37  63.28     71.68
1  91.48  12.07   95.99  14.58     13.21
2  87.59  83.87   91.14  90.02     86.84
3  98.06  48.48   99.62  80.00     60.38
4  85.46  70.30   90.42  70.57     70.43
Total accuracy: 75.37%
Average sen: 59.48%
Average spec: 93.31%
Macro f1-score: 60.51%
Diagnosis acc on 30mins: 1.0
[0.99997663 0.99995053 0.99982208 0.99999976 0.99999726 0.99998355
 0.99999321 0.99998355 0.99998951 0.99999583 0.99987018 0.99991298
 0.9999007  0.99999905 0.99997914 0.99995959 0.99997115 0.99999976]
pred: 0.999960247013304, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp041-nsrr

=== Test on chp042-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.365802, loss_ss: 1.666464, loss_d: 0.699338
0.0780 --- loss: 2.111495, loss_ss: 1.511560, loss_d: 0.599935
0.1560 --- loss: 2.557473, loss_ss: 1.517527, loss_d: 1.039946
0.2340 --- loss: 2.230862, loss_ss: 1.532096, loss_d: 0.698765
0.3120 --- loss: 1.868777, loss_ss: 1.439959, loss_d: 0.428818
0.3900 --- loss: 2.185520, loss_ss: 1.346478, loss_d: 0.839042
0.4680 --- loss: 1.888530, loss_ss: 1.282063, loss_d: 0.606467
0.5460 --- loss: 2.308638, loss_ss: 1.354639, loss_d: 0.953999
0.6240 --- loss: 1.829866, loss_ss: 1.272211, loss_d: 0.557655
0.7020 --- loss: 2.147661, loss_ss: 1.365373, loss_d: 0.782288
0.7800 --- loss: 1.860359, loss_ss: 1.382768, loss_d: 0.477591
0.8580 --- loss: 1.546653, loss_ss: 1.256420, loss_d: 0.290233
0.9360 --- loss: 1.841472, loss_ss: 1.215883, loss_d: 0.625589
Epoch finished! Loss: 2.0086784856393933
Starting epoch 2/10.
0.0000 --- loss: 1.926965, loss_ss: 1.369443, loss_d: 0.557522
0.0780 --- loss: 1.540653, loss_ss: 1.212668, loss_d: 0.327985
0.1560 --- loss: 1.874783, loss_ss: 1.254747, loss_d: 0.620036
0.2340 --- loss: 1.577772, loss_ss: 1.268124, loss_d: 0.309648
0.3120 --- loss: 1.521620, loss_ss: 1.175895, loss_d: 0.345724
0.3900 --- loss: 1.967916, loss_ss: 1.141890, loss_d: 0.826025
0.4680 --- loss: 2.055100, loss_ss: 1.213058, loss_d: 0.842041
0.5460 --- loss: 1.289679, loss_ss: 1.145262, loss_d: 0.144417
0.6240 --- loss: 1.460972, loss_ss: 1.251402, loss_d: 0.209570
0.7020 --- loss: 1.480204, loss_ss: 1.210684, loss_d: 0.269520
0.7800 --- loss: 2.274769, loss_ss: 1.354507, loss_d: 0.920262
0.8580 --- loss: 1.562224, loss_ss: 1.276985, loss_d: 0.285239
0.9360 --- loss: 1.549355, loss_ss: 0.913477, loss_d: 0.635878
Epoch finished! Loss: 1.6466752775013447
Starting epoch 3/10.
0.0000 --- loss: 1.262797, loss_ss: 1.100061, loss_d: 0.162736
0.0780 --- loss: 2.048770, loss_ss: 1.557812, loss_d: 0.490958
0.1560 --- loss: 1.331245, loss_ss: 1.191669, loss_d: 0.139576
0.2340 --- loss: 1.261884, loss_ss: 1.097586, loss_d: 0.164298
0.3120 --- loss: 1.317917, loss_ss: 1.007179, loss_d: 0.310738
0.3900 --- loss: 1.717867, loss_ss: 1.472650, loss_d: 0.245217
0.4680 --- loss: 1.408765, loss_ss: 1.229327, loss_d: 0.179438
0.5460 --- loss: 1.915294, loss_ss: 1.044401, loss_d: 0.870893
0.6240 --- loss: 1.731952, loss_ss: 1.174203, loss_d: 0.557749
0.7020 --- loss: 1.179039, loss_ss: 0.978922, loss_d: 0.200116
0.7800 --- loss: 1.246957, loss_ss: 1.155665, loss_d: 0.091292
0.8580 --- loss: 1.586760, loss_ss: 1.149854, loss_d: 0.436906
0.9360 --- loss: 1.426180, loss_ss: 1.207992, loss_d: 0.218188
Epoch finished! Loss: 1.4351759906858206
Starting epoch 4/10.
0.0000 --- loss: 1.577222, loss_ss: 1.041092, loss_d: 0.536130
0.0780 --- loss: 1.118740, loss_ss: 1.069103, loss_d: 0.049637
0.1560 --- loss: 1.230720, loss_ss: 0.997789, loss_d: 0.232931
0.2340 --- loss: 1.177537, loss_ss: 1.103772, loss_d: 0.073765
0.3120 --- loss: 1.196017, loss_ss: 1.033637, loss_d: 0.162380
0.3900 --- loss: 1.520118, loss_ss: 1.468265, loss_d: 0.051853
0.4680 --- loss: 1.443096, loss_ss: 1.271330, loss_d: 0.171766
0.5460 --- loss: 1.446508, loss_ss: 0.972629, loss_d: 0.473880
0.6240 --- loss: 1.264762, loss_ss: 1.060972, loss_d: 0.203790
0.7020 --- loss: 1.633422, loss_ss: 1.041984, loss_d: 0.591438
0.7800 --- loss: 0.872059, loss_ss: 0.721962, loss_d: 0.150097
0.8580 --- loss: 1.333432, loss_ss: 1.157902, loss_d: 0.175530
0.9360 --- loss: 1.479615, loss_ss: 1.056724, loss_d: 0.422890
Epoch finished! Loss: 1.3324385420419276
Starting epoch 5/10.
0.0000 --- loss: 1.275000, loss_ss: 1.068762, loss_d: 0.206239
0.0780 --- loss: 1.027243, loss_ss: 0.951343, loss_d: 0.075899
0.1560 --- loss: 1.121000, loss_ss: 0.937779, loss_d: 0.183220
0.2340 --- loss: 1.647861, loss_ss: 1.091745, loss_d: 0.556116
0.3120 --- loss: 1.228439, loss_ss: 1.077784, loss_d: 0.150656
0.3900 --- loss: 1.121042, loss_ss: 0.946054, loss_d: 0.174988
0.4680 --- loss: 1.412167, loss_ss: 1.008281, loss_d: 0.403886
0.5460 --- loss: 1.358184, loss_ss: 0.885779, loss_d: 0.472405
0.6240 --- loss: 1.369478, loss_ss: 0.997988, loss_d: 0.371490
0.7020 --- loss: 1.322465, loss_ss: 1.236729, loss_d: 0.085736
0.7800 --- loss: 1.018174, loss_ss: 0.973482, loss_d: 0.044691
0.8580 --- loss: 1.344829, loss_ss: 1.052281, loss_d: 0.292548
0.9360 --- loss: 1.342170, loss_ss: 1.033824, loss_d: 0.308347
Epoch finished! Loss: 1.2711011478677392
Starting epoch 6/10.
0.0000 --- loss: 1.635323, loss_ss: 1.139902, loss_d: 0.495422
0.0780 --- loss: 0.926510, loss_ss: 0.828723, loss_d: 0.097786
0.1560 --- loss: 1.044973, loss_ss: 0.867204, loss_d: 0.177769
0.2340 --- loss: 1.021177, loss_ss: 0.884924, loss_d: 0.136253
0.3120 --- loss: 1.481314, loss_ss: 1.286445, loss_d: 0.194869
0.3900 --- loss: 1.023868, loss_ss: 0.981397, loss_d: 0.042471
0.4680 --- loss: 0.890884, loss_ss: 0.872360, loss_d: 0.018524
0.5460 --- loss: 1.021749, loss_ss: 0.953812, loss_d: 0.067937
0.6240 --- loss: 1.128122, loss_ss: 1.091940, loss_d: 0.036182
0.7020 --- loss: 0.992512, loss_ss: 0.947329, loss_d: 0.045183
0.7800 --- loss: 1.464278, loss_ss: 1.258209, loss_d: 0.206070
0.8580 --- loss: 1.029399, loss_ss: 0.986604, loss_d: 0.042795
0.9360 --- loss: 1.113221, loss_ss: 0.956359, loss_d: 0.156862
Epoch finished! Loss: 1.1547596976161003
Starting epoch 7/10.
0.0000 --- loss: 1.082497, loss_ss: 0.927587, loss_d: 0.154910
0.0780 --- loss: 0.976228, loss_ss: 0.937342, loss_d: 0.038886
0.1560 --- loss: 0.945515, loss_ss: 0.894838, loss_d: 0.050677
0.2340 --- loss: 0.907865, loss_ss: 0.855440, loss_d: 0.052425
0.3120 --- loss: 0.925781, loss_ss: 0.877010, loss_d: 0.048771
0.3900 --- loss: 0.973249, loss_ss: 0.966998, loss_d: 0.006251
0.4680 --- loss: 0.808091, loss_ss: 0.771520, loss_d: 0.036570
0.5460 --- loss: 0.891125, loss_ss: 0.847453, loss_d: 0.043672
0.6240 --- loss: 0.996058, loss_ss: 0.986894, loss_d: 0.009164
0.7020 --- loss: 1.156788, loss_ss: 1.063116, loss_d: 0.093672
0.7800 --- loss: 1.194609, loss_ss: 1.138706, loss_d: 0.055903
0.8580 --- loss: 1.305866, loss_ss: 1.125553, loss_d: 0.180313
0.9360 --- loss: 0.803847, loss_ss: 0.786711, loss_d: 0.017137
Epoch finished! Loss: 1.065989085007459
Starting epoch 8/10.
0.0000 --- loss: 1.095066, loss_ss: 0.991146, loss_d: 0.103920
0.0780 --- loss: 0.891183, loss_ss: 0.841497, loss_d: 0.049686
0.1560 --- loss: 0.906941, loss_ss: 0.876930, loss_d: 0.030011
0.2340 --- loss: 0.916108, loss_ss: 0.906676, loss_d: 0.009432
0.3120 --- loss: 0.930115, loss_ss: 0.910256, loss_d: 0.019859
0.3900 --- loss: 1.028249, loss_ss: 0.748843, loss_d: 0.279406
0.4680 --- loss: 1.025250, loss_ss: 1.011588, loss_d: 0.013662
0.5460 --- loss: 0.870793, loss_ss: 0.837019, loss_d: 0.033774
0.6240 --- loss: 0.915755, loss_ss: 0.871620, loss_d: 0.044135
0.7020 --- loss: 1.067878, loss_ss: 0.854243, loss_d: 0.213635
0.7800 --- loss: 0.992808, loss_ss: 0.989863, loss_d: 0.002945
0.8580 --- loss: 1.114683, loss_ss: 0.996278, loss_d: 0.118405
0.9360 --- loss: 0.927248, loss_ss: 0.907358, loss_d: 0.019890
Epoch finished! Loss: 1.0120400809682906
Starting epoch 9/10.
0.0000 --- loss: 1.057976, loss_ss: 0.872396, loss_d: 0.185580
0.0780 --- loss: 0.855395, loss_ss: 0.853211, loss_d: 0.002183
0.1560 --- loss: 0.893084, loss_ss: 0.882834, loss_d: 0.010249
0.2340 --- loss: 0.893657, loss_ss: 0.864376, loss_d: 0.029280
0.3120 --- loss: 1.203738, loss_ss: 1.170287, loss_d: 0.033450
0.3900 --- loss: 0.929692, loss_ss: 0.920827, loss_d: 0.008864
0.4680 --- loss: 0.863171, loss_ss: 0.857416, loss_d: 0.005755
0.5460 --- loss: 1.289661, loss_ss: 1.113642, loss_d: 0.176019
0.6240 --- loss: 0.887092, loss_ss: 0.884858, loss_d: 0.002234
0.7020 --- loss: 1.221715, loss_ss: 0.826094, loss_d: 0.395621
0.7800 --- loss: 0.790708, loss_ss: 0.781967, loss_d: 0.008741
0.8580 --- loss: 0.888984, loss_ss: 0.886622, loss_d: 0.002362
0.9360 --- loss: 0.896201, loss_ss: 0.887615, loss_d: 0.008586
Epoch finished! Loss: 0.9781425260007381
Starting epoch 10/10.
0.0000 --- loss: 0.793278, loss_ss: 0.777599, loss_d: 0.015680
0.0780 --- loss: 0.755583, loss_ss: 0.751738, loss_d: 0.003845
0.1560 --- loss: 0.825846, loss_ss: 0.816251, loss_d: 0.009595
0.2340 --- loss: 0.901502, loss_ss: 0.844785, loss_d: 0.056718
0.3120 --- loss: 1.031423, loss_ss: 0.743151, loss_d: 0.288272
0.3900 --- loss: 0.894306, loss_ss: 0.885307, loss_d: 0.008999
0.4680 --- loss: 0.975450, loss_ss: 0.902113, loss_d: 0.073337
0.5460 --- loss: 0.918289, loss_ss: 0.874081, loss_d: 0.044208
0.6240 --- loss: 1.124693, loss_ss: 1.015548, loss_d: 0.109145
0.7020 --- loss: 0.856439, loss_ss: 0.835673, loss_d: 0.020766
0.7800 --- loss: 0.770915, loss_ss: 0.763469, loss_d: 0.007445
0.8580 --- loss: 0.972351, loss_ss: 0.914297, loss_d: 0.058054
0.9360 --- loss: 0.817830, loss_ss: 0.787331, loss_d: 0.030499
Epoch finished! Loss: 0.9785292753949761
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5064814814814815
             precision    recall  f1-score   support

        0.0       0.32      0.86      0.47       152
        1.0       0.20      0.10      0.14       230
        2.0       0.79      0.39      0.52       414
        3.0       1.00      0.61      0.76        93
        4.0       0.59      0.91      0.72       191

avg / total       0.58      0.51      0.49      1080
 


====== chp042-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  72.50  86.18   70.26   32.19     46.87
1  72.13  10.43   88.82   20.17     13.75
2  72.69  39.13   93.54   79.02     52.34
3  96.67  61.29  100.00  100.00     76.00
4  87.31  90.58   86.61   59.25     71.64
Total accuracy: 50.65%
Average sen: 57.52%
Average spec: 87.85%
Macro f1-score: 52.12%
Diagnosis acc on 30mins: 1.0
[0.99995577 0.99796653 0.99999249 0.99999952 0.99999964 0.99995863
 0.99995267 0.99998033 0.99998069 0.99999559 0.99993849 0.99990177
 0.99989998 0.99999809 1.         0.99999523 0.99916852 0.9849363 ]
pred: 0.9989789028962454, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp042-nsrr

=== Test on chp043-nsrr. train_data(1280), test_data(20) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.372775, loss_ss: 1.664681, loss_d: 0.708094
0.0781 --- loss: 2.034312, loss_ss: 1.597095, loss_d: 0.437217
0.1562 --- loss: 1.815977, loss_ss: 1.350868, loss_d: 0.465110
0.2344 --- loss: 2.392549, loss_ss: 1.415843, loss_d: 0.976706
0.3125 --- loss: 2.025506, loss_ss: 1.298783, loss_d: 0.726724
0.3906 --- loss: 1.955230, loss_ss: 1.323736, loss_d: 0.631494
0.4688 --- loss: 1.875455, loss_ss: 1.334401, loss_d: 0.541054
0.5469 --- loss: 1.486042, loss_ss: 1.211967, loss_d: 0.274076
0.6250 --- loss: 1.920207, loss_ss: 1.233967, loss_d: 0.686240
0.7031 --- loss: 1.877155, loss_ss: 1.338966, loss_d: 0.538189
0.7812 --- loss: 1.889295, loss_ss: 1.429791, loss_d: 0.459504
0.8594 --- loss: 1.680365, loss_ss: 1.088037, loss_d: 0.592328
0.9375 --- loss: 1.938829, loss_ss: 1.294814, loss_d: 0.644014
Epoch finished! Loss: 1.9340022060814805
Starting epoch 2/10.
0.0000 --- loss: 1.673519, loss_ss: 1.322260, loss_d: 0.351259
0.0781 --- loss: 2.063686, loss_ss: 1.224789, loss_d: 0.838897
0.1562 --- loss: 1.677589, loss_ss: 1.153056, loss_d: 0.524533
0.2344 --- loss: 1.518666, loss_ss: 1.197086, loss_d: 0.321580
0.3125 --- loss: 1.567312, loss_ss: 1.175015, loss_d: 0.392298
0.3906 --- loss: 1.564756, loss_ss: 1.077599, loss_d: 0.487157
0.4688 --- loss: 1.662436, loss_ss: 1.324515, loss_d: 0.337921
0.5469 --- loss: 1.541000, loss_ss: 1.155188, loss_d: 0.385812
0.6250 --- loss: 1.506526, loss_ss: 1.094482, loss_d: 0.412043
0.7031 --- loss: 1.705535, loss_ss: 1.247109, loss_d: 0.458426
0.7812 --- loss: 1.645408, loss_ss: 1.128728, loss_d: 0.516680
0.8594 --- loss: 1.394459, loss_ss: 1.102216, loss_d: 0.292244
0.9375 --- loss: 1.702246, loss_ss: 1.094037, loss_d: 0.608209
Epoch finished! Loss: 1.6496144185854693
Starting epoch 3/10.
0.0000 --- loss: 1.381082, loss_ss: 1.059733, loss_d: 0.321348
0.0781 --- loss: 1.381988, loss_ss: 1.058490, loss_d: 0.323498
0.1562 --- loss: 1.325385, loss_ss: 1.084490, loss_d: 0.240896
0.2344 --- loss: 1.222678, loss_ss: 1.032352, loss_d: 0.190326
0.3125 --- loss: 1.618398, loss_ss: 1.275340, loss_d: 0.343058
0.3906 --- loss: 1.802325, loss_ss: 1.002967, loss_d: 0.799359
0.4688 --- loss: 1.430221, loss_ss: 1.164017, loss_d: 0.266205
0.5469 --- loss: 1.388617, loss_ss: 1.030024, loss_d: 0.358593
0.6250 --- loss: 1.443527, loss_ss: 1.280240, loss_d: 0.163287
0.7031 --- loss: 1.485096, loss_ss: 1.206664, loss_d: 0.278431
0.7812 --- loss: 1.440430, loss_ss: 1.013905, loss_d: 0.426526
0.8594 --- loss: 1.501746, loss_ss: 0.975903, loss_d: 0.525843
0.9375 --- loss: 1.360663, loss_ss: 1.086881, loss_d: 0.273782
Epoch finished! Loss: 1.4117922121145594
Starting epoch 4/10.
0.0000 --- loss: 1.161068, loss_ss: 0.905596, loss_d: 0.255472
0.0781 --- loss: 1.176876, loss_ss: 1.045559, loss_d: 0.131317
0.1562 --- loss: 1.157817, loss_ss: 1.029334, loss_d: 0.128483
0.2344 --- loss: 1.221000, loss_ss: 1.117357, loss_d: 0.103644
0.3125 --- loss: 1.387715, loss_ss: 0.797216, loss_d: 0.590499
0.3906 --- loss: 1.237465, loss_ss: 1.013884, loss_d: 0.223581
0.4688 --- loss: 1.098743, loss_ss: 0.966584, loss_d: 0.132159
0.5469 --- loss: 1.360358, loss_ss: 1.258311, loss_d: 0.102048
0.6250 --- loss: 1.625849, loss_ss: 1.184154, loss_d: 0.441695
0.7031 --- loss: 1.863304, loss_ss: 1.015612, loss_d: 0.847692
0.7812 --- loss: 1.129607, loss_ss: 0.958867, loss_d: 0.170740
0.8594 --- loss: 1.111360, loss_ss: 0.938926, loss_d: 0.172434
0.9375 --- loss: 1.242804, loss_ss: 1.084924, loss_d: 0.157880
Epoch finished! Loss: 1.2946841787165544
Starting epoch 5/10.
0.0000 --- loss: 1.197117, loss_ss: 1.164250, loss_d: 0.032867
0.0781 --- loss: 0.922206, loss_ss: 0.908885, loss_d: 0.013320
0.1562 --- loss: 1.272907, loss_ss: 0.991192, loss_d: 0.281715
0.2344 --- loss: 1.265830, loss_ss: 0.788838, loss_d: 0.476993
0.3125 --- loss: 1.333716, loss_ss: 0.894543, loss_d: 0.439173
0.3906 --- loss: 1.178777, loss_ss: 0.968984, loss_d: 0.209794
0.4688 --- loss: 1.010071, loss_ss: 0.971491, loss_d: 0.038580
0.5469 --- loss: 1.265096, loss_ss: 1.174286, loss_d: 0.090810
0.6250 --- loss: 1.548312, loss_ss: 0.995467, loss_d: 0.552845
0.7031 --- loss: 0.979244, loss_ss: 0.794773, loss_d: 0.184471
0.7812 --- loss: 1.135994, loss_ss: 1.000774, loss_d: 0.135221
0.8594 --- loss: 0.837929, loss_ss: 0.788553, loss_d: 0.049377
0.9375 --- loss: 1.030174, loss_ss: 0.871625, loss_d: 0.158549
Epoch finished! Loss: 1.146293575369467
Starting epoch 6/10.
0.0000 --- loss: 1.087471, loss_ss: 0.980644, loss_d: 0.106827
0.0781 --- loss: 0.943017, loss_ss: 0.894857, loss_d: 0.048160
0.1562 --- loss: 1.161162, loss_ss: 0.937337, loss_d: 0.223825
0.2344 --- loss: 0.829684, loss_ss: 0.812225, loss_d: 0.017460
0.3125 --- loss: 1.013180, loss_ss: 0.922374, loss_d: 0.090806
0.3906 --- loss: 1.067771, loss_ss: 1.053480, loss_d: 0.014291
0.4688 --- loss: 0.807812, loss_ss: 0.774011, loss_d: 0.033801
0.5469 --- loss: 1.009957, loss_ss: 0.973741, loss_d: 0.036216
0.6250 --- loss: 0.898378, loss_ss: 0.844450, loss_d: 0.053927
0.7031 --- loss: 1.194951, loss_ss: 1.114616, loss_d: 0.080336
0.7812 --- loss: 0.849238, loss_ss: 0.835708, loss_d: 0.013530
0.8594 --- loss: 0.781000, loss_ss: 0.761780, loss_d: 0.019220
0.9375 --- loss: 0.953640, loss_ss: 0.858868, loss_d: 0.094772
Epoch finished! Loss: 1.0882705558003403
Starting epoch 7/10.
0.0000 --- loss: 1.350554, loss_ss: 1.190421, loss_d: 0.160133
0.0781 --- loss: 1.220509, loss_ss: 1.103447, loss_d: 0.117062
0.1562 --- loss: 0.965164, loss_ss: 0.753161, loss_d: 0.212003
0.2344 --- loss: 1.490561, loss_ss: 1.155282, loss_d: 0.335279
0.3125 --- loss: 0.946288, loss_ss: 0.846657, loss_d: 0.099631
0.3906 --- loss: 1.015759, loss_ss: 0.891504, loss_d: 0.124255
0.4688 --- loss: 1.092105, loss_ss: 1.068390, loss_d: 0.023715
0.5469 --- loss: 1.042531, loss_ss: 0.989102, loss_d: 0.053428
0.6250 --- loss: 0.894588, loss_ss: 0.874099, loss_d: 0.020489
0.7031 --- loss: 1.172677, loss_ss: 1.163598, loss_d: 0.009079
0.7812 --- loss: 1.005438, loss_ss: 0.989196, loss_d: 0.016242
0.8594 --- loss: 1.019859, loss_ss: 0.931155, loss_d: 0.088704
0.9375 --- loss: 1.198688, loss_ss: 1.023229, loss_d: 0.175458
Epoch finished! Loss: 1.019732814135514
Starting epoch 8/10.
0.0000 --- loss: 0.799044, loss_ss: 0.770829, loss_d: 0.028215
0.0781 --- loss: 1.573040, loss_ss: 1.242871, loss_d: 0.330169
0.1562 --- loss: 0.919840, loss_ss: 0.894908, loss_d: 0.024931
0.2344 --- loss: 0.897174, loss_ss: 0.890876, loss_d: 0.006297
0.3125 --- loss: 0.758532, loss_ss: 0.729580, loss_d: 0.028952
0.3906 --- loss: 0.912371, loss_ss: 0.708050, loss_d: 0.204322
0.4688 --- loss: 0.886577, loss_ss: 0.749776, loss_d: 0.136800
0.5469 --- loss: 0.878092, loss_ss: 0.839560, loss_d: 0.038532
0.6250 --- loss: 0.761292, loss_ss: 0.746685, loss_d: 0.014606
0.7031 --- loss: 0.946768, loss_ss: 0.930297, loss_d: 0.016471
0.7812 --- loss: 0.798281, loss_ss: 0.758002, loss_d: 0.040279
0.8594 --- loss: 0.949718, loss_ss: 0.835169, loss_d: 0.114549
0.9375 --- loss: 0.887020, loss_ss: 0.879827, loss_d: 0.007193
Epoch finished! Loss: 0.9612573497877346
Starting epoch 9/10.
0.0000 --- loss: 1.292843, loss_ss: 1.188860, loss_d: 0.103983
0.0781 --- loss: 1.119976, loss_ss: 0.731966, loss_d: 0.388010
0.1562 --- loss: 1.058505, loss_ss: 1.021146, loss_d: 0.037359
0.2344 --- loss: 1.046824, loss_ss: 0.994341, loss_d: 0.052483
0.3125 --- loss: 0.905107, loss_ss: 0.858403, loss_d: 0.046705
0.3906 --- loss: 1.202014, loss_ss: 0.974326, loss_d: 0.227688
0.4688 --- loss: 0.771132, loss_ss: 0.756314, loss_d: 0.014819
0.5469 --- loss: 0.850056, loss_ss: 0.825002, loss_d: 0.025054
0.6250 --- loss: 1.058736, loss_ss: 0.861193, loss_d: 0.197543
0.7031 --- loss: 0.756163, loss_ss: 0.746425, loss_d: 0.009738
0.7812 --- loss: 0.894787, loss_ss: 0.889449, loss_d: 0.005338
0.8594 --- loss: 0.747125, loss_ss: 0.724460, loss_d: 0.022665
0.9375 --- loss: 1.201017, loss_ss: 1.006890, loss_d: 0.194127
Epoch finished! Loss: 0.9478528654481483
Starting epoch 10/10.
0.0000 --- loss: 0.840520, loss_ss: 0.770182, loss_d: 0.070337
0.0781 --- loss: 0.837549, loss_ss: 0.765676, loss_d: 0.071873
0.1562 --- loss: 0.995941, loss_ss: 0.880462, loss_d: 0.115479
0.2344 --- loss: 0.857702, loss_ss: 0.854405, loss_d: 0.003296
0.3125 --- loss: 0.833621, loss_ss: 0.768908, loss_d: 0.064713
0.3906 --- loss: 0.644913, loss_ss: 0.630553, loss_d: 0.014359
0.4688 --- loss: 0.817617, loss_ss: 0.811074, loss_d: 0.006543
0.5469 --- loss: 1.050252, loss_ss: 1.036507, loss_d: 0.013744
0.6250 --- loss: 0.835320, loss_ss: 0.828052, loss_d: 0.007268
0.7031 --- loss: 0.861360, loss_ss: 0.855014, loss_d: 0.006345
0.7812 --- loss: 0.757960, loss_ss: 0.751252, loss_d: 0.006708
0.8594 --- loss: 0.950728, loss_ss: 0.871419, loss_d: 0.079309
0.9375 --- loss: 0.843979, loss_ss: 0.838010, loss_d: 0.005969
Epoch finished! Loss: 0.9114273819397753
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.725
             precision    recall  f1-score   support

        0.0       0.94      0.62      0.74       143
        1.0       0.35      0.04      0.06       197
        2.0       0.85      0.90      0.88       506
        3.0       0.97      0.55      0.70        64
        4.0       0.55      0.98      0.70       290

avg / total       0.71      0.72      0.68      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.92  61.54   99.43  93.62     74.26
1  83.08   3.55   98.70  35.00      6.45
2  89.42  90.32   88.76  85.42     87.80
3  97.50  54.69   99.91  97.22     70.00
4  80.08  97.59   74.51  54.95     70.31
Total accuracy: 72.50%
Average sen: 61.54%
Average spec: 92.26%
Macro f1-score: 61.76%
Diagnosis acc on 30mins: 1.0
[0.99999881 0.99999988 0.99999464 0.9999845  0.99999964 0.99999857
 0.99981827 0.99997973 0.99999893 0.99986947 0.99992442 0.99986327
 0.99999726 0.99999857 0.99831796 0.99998522 0.99999976 0.99998963
 0.99999964 0.99992168]
pred: 0.9998819917440415, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp043-nsrr

=== Test on chp044-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.427593, loss_ss: 1.804556, loss_d: 0.623037
0.0779 --- loss: 2.189979, loss_ss: 1.710919, loss_d: 0.479060
0.1559 --- loss: 1.874124, loss_ss: 1.644793, loss_d: 0.229331
0.2338 --- loss: 2.038057, loss_ss: 1.429586, loss_d: 0.608471
0.3118 --- loss: 2.329915, loss_ss: 1.572284, loss_d: 0.757631
0.3897 --- loss: 2.292488, loss_ss: 1.432358, loss_d: 0.860130
0.4677 --- loss: 1.857270, loss_ss: 1.410455, loss_d: 0.446814
0.5456 --- loss: 1.801897, loss_ss: 1.519330, loss_d: 0.282567
0.6235 --- loss: 2.370855, loss_ss: 1.379691, loss_d: 0.991165
0.7015 --- loss: 2.067895, loss_ss: 1.524867, loss_d: 0.543028
0.7794 --- loss: 1.872802, loss_ss: 1.446977, loss_d: 0.425825
0.8574 --- loss: 2.104357, loss_ss: 1.273066, loss_d: 0.831291
0.9353 --- loss: 1.600258, loss_ss: 1.233120, loss_d: 0.367138
Epoch finished! Loss: 2.126708692871034
Starting epoch 2/10.
0.0000 --- loss: 1.996267, loss_ss: 1.544399, loss_d: 0.451869
0.0779 --- loss: 1.781917, loss_ss: 1.291196, loss_d: 0.490722
0.1559 --- loss: 1.808924, loss_ss: 1.354549, loss_d: 0.454375
0.2338 --- loss: 1.693083, loss_ss: 1.335604, loss_d: 0.357479
0.3118 --- loss: 1.575930, loss_ss: 1.222142, loss_d: 0.353788
0.3897 --- loss: 1.668685, loss_ss: 1.324213, loss_d: 0.344472
0.4677 --- loss: 1.910531, loss_ss: 1.368210, loss_d: 0.542321
0.5456 --- loss: 1.882379, loss_ss: 1.476142, loss_d: 0.406237
0.6235 --- loss: 1.965769, loss_ss: 1.281970, loss_d: 0.683800
0.7015 --- loss: 1.670601, loss_ss: 1.350065, loss_d: 0.320536
0.7794 --- loss: 1.756407, loss_ss: 1.223620, loss_d: 0.532788
0.8574 --- loss: 1.638866, loss_ss: 1.350410, loss_d: 0.288456
0.9353 --- loss: 1.956963, loss_ss: 1.333393, loss_d: 0.623570
Epoch finished! Loss: 1.7990459436550736
Starting epoch 3/10.
0.0000 --- loss: 1.438751, loss_ss: 1.228421, loss_d: 0.210330
0.0779 --- loss: 1.326113, loss_ss: 1.184108, loss_d: 0.142005
0.1559 --- loss: 1.484528, loss_ss: 1.250712, loss_d: 0.233816
0.2338 --- loss: 1.600104, loss_ss: 1.254641, loss_d: 0.345463
0.3118 --- loss: 1.306775, loss_ss: 1.204850, loss_d: 0.101925
0.3897 --- loss: 1.353983, loss_ss: 1.052925, loss_d: 0.301058
0.4677 --- loss: 1.250577, loss_ss: 1.054736, loss_d: 0.195841
0.5456 --- loss: 1.220022, loss_ss: 1.066792, loss_d: 0.153230
0.6235 --- loss: 1.273843, loss_ss: 1.091167, loss_d: 0.182676
0.7015 --- loss: 1.523306, loss_ss: 1.264024, loss_d: 0.259282
0.7794 --- loss: 1.229942, loss_ss: 1.094217, loss_d: 0.135725
0.8574 --- loss: 1.783154, loss_ss: 1.153762, loss_d: 0.629392
0.9353 --- loss: 1.441584, loss_ss: 1.151135, loss_d: 0.290449
Epoch finished! Loss: 1.5013389438390732
Starting epoch 4/10.
0.0000 --- loss: 1.134905, loss_ss: 1.035791, loss_d: 0.099114
0.0779 --- loss: 1.345343, loss_ss: 1.077607, loss_d: 0.267736
0.1559 --- loss: 1.271211, loss_ss: 1.022134, loss_d: 0.249077
0.2338 --- loss: 1.178481, loss_ss: 1.000165, loss_d: 0.178317
0.3118 --- loss: 1.350125, loss_ss: 1.076249, loss_d: 0.273876
0.3897 --- loss: 1.509712, loss_ss: 1.148458, loss_d: 0.361254
0.4677 --- loss: 1.251741, loss_ss: 1.116573, loss_d: 0.135168
0.5456 --- loss: 1.190658, loss_ss: 0.931893, loss_d: 0.258765
0.6235 --- loss: 1.292751, loss_ss: 1.161748, loss_d: 0.131003
0.7015 --- loss: 1.541057, loss_ss: 1.108007, loss_d: 0.433050
0.7794 --- loss: 1.608261, loss_ss: 1.474613, loss_d: 0.133648
0.8574 --- loss: 1.268135, loss_ss: 0.977834, loss_d: 0.290302
0.9353 --- loss: 1.389962, loss_ss: 1.146616, loss_d: 0.243346
Epoch finished! Loss: 1.3733172775246203
Starting epoch 5/10.
0.0000 --- loss: 1.282530, loss_ss: 1.017292, loss_d: 0.265238
0.0779 --- loss: 1.061268, loss_ss: 1.002435, loss_d: 0.058833
0.1559 --- loss: 1.151096, loss_ss: 0.894075, loss_d: 0.257021
0.2338 --- loss: 1.202592, loss_ss: 1.035536, loss_d: 0.167056
0.3118 --- loss: 0.967460, loss_ss: 0.911260, loss_d: 0.056200
0.3897 --- loss: 1.357935, loss_ss: 0.864648, loss_d: 0.493287
0.4677 --- loss: 1.163271, loss_ss: 0.887846, loss_d: 0.275425
0.5456 --- loss: 1.803092, loss_ss: 1.315930, loss_d: 0.487162
0.6235 --- loss: 1.265240, loss_ss: 1.006306, loss_d: 0.258934
0.7015 --- loss: 1.231677, loss_ss: 0.913979, loss_d: 0.317697
0.7794 --- loss: 1.061884, loss_ss: 1.009114, loss_d: 0.052770
0.8574 --- loss: 1.126553, loss_ss: 1.057088, loss_d: 0.069465
0.9353 --- loss: 1.197472, loss_ss: 1.137959, loss_d: 0.059513
Epoch finished! Loss: 1.282694143243134
Starting epoch 6/10.
0.0000 --- loss: 1.135966, loss_ss: 0.960889, loss_d: 0.175077
0.0779 --- loss: 1.316529, loss_ss: 1.197208, loss_d: 0.119322
0.1559 --- loss: 1.245882, loss_ss: 1.037547, loss_d: 0.208334
0.2338 --- loss: 1.256536, loss_ss: 1.215151, loss_d: 0.041385
0.3118 --- loss: 1.025072, loss_ss: 0.995937, loss_d: 0.029136
0.3897 --- loss: 1.288473, loss_ss: 1.042901, loss_d: 0.245572
0.4677 --- loss: 1.316753, loss_ss: 1.049894, loss_d: 0.266860
0.5456 --- loss: 1.290227, loss_ss: 0.931442, loss_d: 0.358785
0.6235 --- loss: 1.149381, loss_ss: 1.020558, loss_d: 0.128822
0.7015 --- loss: 1.365680, loss_ss: 1.109003, loss_d: 0.256677
0.7794 --- loss: 1.130983, loss_ss: 0.931855, loss_d: 0.199127
0.8574 --- loss: 1.008692, loss_ss: 0.907183, loss_d: 0.101509
0.9353 --- loss: 1.136841, loss_ss: 0.864718, loss_d: 0.272123
Epoch finished! Loss: 1.1938876574859023
Starting epoch 7/10.
0.0000 --- loss: 2.648412, loss_ss: 0.836479, loss_d: 1.811933
0.0779 --- loss: 1.230970, loss_ss: 1.089291, loss_d: 0.141679
0.1559 --- loss: 1.111082, loss_ss: 1.035761, loss_d: 0.075321
0.2338 --- loss: 0.770999, loss_ss: 0.737015, loss_d: 0.033984
0.3118 --- loss: 1.095546, loss_ss: 0.910993, loss_d: 0.184553
0.3897 --- loss: 1.099642, loss_ss: 1.012133, loss_d: 0.087509
0.4677 --- loss: 1.052260, loss_ss: 1.001222, loss_d: 0.051038
0.5456 --- loss: 0.967296, loss_ss: 0.793562, loss_d: 0.173733
0.6235 --- loss: 0.779061, loss_ss: 0.730996, loss_d: 0.048065
0.7015 --- loss: 1.041691, loss_ss: 1.005853, loss_d: 0.035838
0.7794 --- loss: 1.786767, loss_ss: 1.094261, loss_d: 0.692506
0.8574 --- loss: 1.158410, loss_ss: 0.871283, loss_d: 0.287127
0.9353 --- loss: 0.918012, loss_ss: 0.815760, loss_d: 0.102252
Epoch finished! Loss: 1.101444342173636
Starting epoch 8/10.
0.0000 --- loss: 1.185297, loss_ss: 1.144688, loss_d: 0.040609
0.0779 --- loss: 1.056997, loss_ss: 0.907651, loss_d: 0.149346
0.1559 --- loss: 1.115861, loss_ss: 0.915503, loss_d: 0.200358
0.2338 --- loss: 0.976282, loss_ss: 0.965584, loss_d: 0.010698
0.3118 --- loss: 1.020097, loss_ss: 0.981731, loss_d: 0.038366
0.3897 --- loss: 1.054095, loss_ss: 0.856681, loss_d: 0.197414
0.4677 --- loss: 0.785206, loss_ss: 0.758033, loss_d: 0.027173
0.5456 --- loss: 1.065213, loss_ss: 1.040414, loss_d: 0.024799
0.6235 --- loss: 0.998411, loss_ss: 0.936574, loss_d: 0.061837
0.7015 --- loss: 1.428767, loss_ss: 0.999920, loss_d: 0.428847
0.7794 --- loss: 0.984754, loss_ss: 0.924486, loss_d: 0.060268
0.8574 --- loss: 0.950662, loss_ss: 0.933984, loss_d: 0.016678
0.9353 --- loss: 1.022151, loss_ss: 0.992559, loss_d: 0.029592
Epoch finished! Loss: 1.0448064603842795
Starting epoch 9/10.
0.0000 --- loss: 0.831109, loss_ss: 0.825168, loss_d: 0.005941
0.0779 --- loss: 0.973013, loss_ss: 0.809024, loss_d: 0.163989
0.1559 --- loss: 1.073811, loss_ss: 1.019448, loss_d: 0.054362
0.2338 --- loss: 0.801062, loss_ss: 0.785295, loss_d: 0.015767
0.3118 --- loss: 0.865520, loss_ss: 0.821042, loss_d: 0.044478
0.3897 --- loss: 1.056324, loss_ss: 1.048774, loss_d: 0.007550
0.4677 --- loss: 0.907244, loss_ss: 0.774069, loss_d: 0.133176
0.5456 --- loss: 0.925987, loss_ss: 0.914149, loss_d: 0.011838
0.6235 --- loss: 1.281966, loss_ss: 1.031890, loss_d: 0.250076
0.7015 --- loss: 0.668513, loss_ss: 0.620966, loss_d: 0.047547
0.7794 --- loss: 0.999446, loss_ss: 0.910340, loss_d: 0.089106
0.8574 --- loss: 0.814337, loss_ss: 0.807071, loss_d: 0.007266
0.9353 --- loss: 1.210053, loss_ss: 0.892753, loss_d: 0.317301
Epoch finished! Loss: 0.9939033412374556
Starting epoch 10/10.
0.0000 --- loss: 0.763024, loss_ss: 0.751709, loss_d: 0.011315
0.0779 --- loss: 1.049173, loss_ss: 1.021318, loss_d: 0.027855
0.1559 --- loss: 0.814173, loss_ss: 0.801624, loss_d: 0.012549
0.2338 --- loss: 0.981617, loss_ss: 0.860517, loss_d: 0.121100
0.3118 --- loss: 0.752919, loss_ss: 0.680844, loss_d: 0.072075
0.3897 --- loss: 1.075935, loss_ss: 1.015963, loss_d: 0.059973
0.4677 --- loss: 0.729845, loss_ss: 0.725615, loss_d: 0.004230
0.5456 --- loss: 0.941288, loss_ss: 0.894259, loss_d: 0.047029
0.6235 --- loss: 0.750545, loss_ss: 0.735155, loss_d: 0.015391
0.7015 --- loss: 0.856599, loss_ss: 0.850563, loss_d: 0.006036
0.7794 --- loss: 0.900041, loss_ss: 0.875296, loss_d: 0.024745
0.8574 --- loss: 0.923259, loss_ss: 0.876789, loss_d: 0.046470
0.9353 --- loss: 1.050347, loss_ss: 1.043988, loss_d: 0.006359
Epoch finished! Loss: 0.9633275880478323
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5735294117647058
             precision    recall  f1-score   support

        0.0       0.43      0.80      0.56        25
        1.0       0.45      0.05      0.10        93
        2.0       0.46      0.90      0.60       324
        3.0       1.00      0.42      0.59       454
        4.0       0.60      0.65      0.62       124

avg / total       0.71      0.57      0.55      1020
 


====== chp044-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.86  80.00   97.29   42.55     55.56
1  90.78   5.38   99.35   45.45      9.62
2  62.65  89.81   50.00   45.54     60.44
3  74.02  41.63  100.00  100.00     58.79
4  90.39  64.52   93.97   59.70     62.02
Total accuracy: 57.35%
Average sen: 56.27%
Average spec: 88.12%
Macro f1-score: 49.28%
Diagnosis acc on 30mins: 1.0
[0.99962342 0.99906975 0.99914408 0.99980754 0.99986601 0.99943382
 0.99942088 0.9995603  0.98650253 0.99940324 0.99999237 0.99999142
 0.99987733 0.99998772 0.99998498 0.9999373  0.99997377]
pred: 0.9989162613363827, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp044-nsrr

=== Test on chp045-nsrr. train_data(1280), test_data(20) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.294464, loss_ss: 1.645946, loss_d: 0.648518
0.0781 --- loss: 2.123216, loss_ss: 1.529415, loss_d: 0.593801
0.1562 --- loss: 2.188543, loss_ss: 1.459229, loss_d: 0.729314
0.2344 --- loss: 1.917270, loss_ss: 1.482675, loss_d: 0.434595
0.3125 --- loss: 1.810584, loss_ss: 1.476942, loss_d: 0.333642
0.3906 --- loss: 2.188836, loss_ss: 1.434862, loss_d: 0.753974
0.4688 --- loss: 1.920136, loss_ss: 1.430103, loss_d: 0.490033
0.5469 --- loss: 2.160411, loss_ss: 1.398157, loss_d: 0.762253
0.6250 --- loss: 1.838034, loss_ss: 1.382876, loss_d: 0.455158
0.7031 --- loss: 2.215484, loss_ss: 1.437310, loss_d: 0.778174
0.7812 --- loss: 1.881461, loss_ss: 1.343340, loss_d: 0.538121
0.8594 --- loss: 1.772656, loss_ss: 1.304954, loss_d: 0.467702
0.9375 --- loss: 1.724218, loss_ss: 1.238814, loss_d: 0.485404
Epoch finished! Loss: 2.033495493761198
Starting epoch 2/10.
0.0000 --- loss: 2.332905, loss_ss: 1.320464, loss_d: 1.012441
0.0781 --- loss: 1.806123, loss_ss: 1.378183, loss_d: 0.427940
0.1562 --- loss: 1.576301, loss_ss: 1.267631, loss_d: 0.308671
0.2344 --- loss: 1.535143, loss_ss: 1.233373, loss_d: 0.301770
0.3125 --- loss: 2.558611, loss_ss: 1.383133, loss_d: 1.175478
0.3906 --- loss: 1.474633, loss_ss: 1.246144, loss_d: 0.228489
0.4688 --- loss: 1.723109, loss_ss: 1.295320, loss_d: 0.427789
0.5469 --- loss: 1.507231, loss_ss: 1.247227, loss_d: 0.260004
0.6250 --- loss: 1.561814, loss_ss: 1.197158, loss_d: 0.364655
0.7031 --- loss: 1.642281, loss_ss: 1.104929, loss_d: 0.537352
0.7812 --- loss: 1.542199, loss_ss: 1.395256, loss_d: 0.146942
0.8594 --- loss: 1.267252, loss_ss: 1.113472, loss_d: 0.153780
0.9375 --- loss: 1.750979, loss_ss: 1.357988, loss_d: 0.392991
Epoch finished! Loss: 1.6426547634319997
Starting epoch 3/10.
0.0000 --- loss: 1.348428, loss_ss: 1.038329, loss_d: 0.310099
0.0781 --- loss: 1.434335, loss_ss: 1.180866, loss_d: 0.253469
0.1562 --- loss: 2.031628, loss_ss: 0.963998, loss_d: 1.067630
0.2344 --- loss: 1.645382, loss_ss: 1.025089, loss_d: 0.620293
0.3125 --- loss: 1.674565, loss_ss: 1.201085, loss_d: 0.473480
0.3906 --- loss: 1.798210, loss_ss: 1.044124, loss_d: 0.754087
0.4688 --- loss: 1.732574, loss_ss: 1.185706, loss_d: 0.546868
0.5469 --- loss: 1.907195, loss_ss: 1.110177, loss_d: 0.797019
0.6250 --- loss: 1.566329, loss_ss: 1.264196, loss_d: 0.302133
0.7031 --- loss: 1.184805, loss_ss: 1.007160, loss_d: 0.177645
0.7812 --- loss: 1.166241, loss_ss: 1.057516, loss_d: 0.108725
0.8594 --- loss: 1.213137, loss_ss: 1.088187, loss_d: 0.124950
0.9375 --- loss: 1.164016, loss_ss: 0.985571, loss_d: 0.178446
Epoch finished! Loss: 1.4399379360394216
Starting epoch 4/10.
0.0000 --- loss: 1.078270, loss_ss: 0.872474, loss_d: 0.205797
0.0781 --- loss: 1.149126, loss_ss: 1.053233, loss_d: 0.095893
0.1562 --- loss: 1.202493, loss_ss: 0.978167, loss_d: 0.224327
0.2344 --- loss: 1.520663, loss_ss: 1.031343, loss_d: 0.489320
0.3125 --- loss: 1.193004, loss_ss: 0.925305, loss_d: 0.267699
0.3906 --- loss: 1.253054, loss_ss: 0.929843, loss_d: 0.323211
0.4688 --- loss: 1.150847, loss_ss: 0.945092, loss_d: 0.205755
0.5469 --- loss: 1.258823, loss_ss: 1.038045, loss_d: 0.220778
0.6250 --- loss: 1.068360, loss_ss: 0.888260, loss_d: 0.180100
0.7031 --- loss: 1.532728, loss_ss: 0.938794, loss_d: 0.593934
0.7812 --- loss: 1.446620, loss_ss: 1.188412, loss_d: 0.258207
0.8594 --- loss: 1.030692, loss_ss: 0.865685, loss_d: 0.165008
0.9375 --- loss: 1.244783, loss_ss: 1.094700, loss_d: 0.150083
Epoch finished! Loss: 1.3205090794037646
Starting epoch 5/10.
0.0000 --- loss: 1.668889, loss_ss: 1.271093, loss_d: 0.397796
0.0781 --- loss: 1.082281, loss_ss: 0.891576, loss_d: 0.190705
0.1562 --- loss: 1.064226, loss_ss: 0.986823, loss_d: 0.077402
0.2344 --- loss: 1.386306, loss_ss: 1.066929, loss_d: 0.319377
0.3125 --- loss: 1.084547, loss_ss: 0.973117, loss_d: 0.111430
0.3906 --- loss: 1.857900, loss_ss: 0.968975, loss_d: 0.888925
0.4688 --- loss: 1.270604, loss_ss: 0.954651, loss_d: 0.315952
0.5469 --- loss: 1.872018, loss_ss: 1.014805, loss_d: 0.857212
0.6250 --- loss: 1.268210, loss_ss: 1.015999, loss_d: 0.252211
0.7031 --- loss: 1.089205, loss_ss: 0.973840, loss_d: 0.115365
0.7812 --- loss: 0.938673, loss_ss: 0.864493, loss_d: 0.074180
0.8594 --- loss: 0.849172, loss_ss: 0.797309, loss_d: 0.051862
0.9375 --- loss: 1.057255, loss_ss: 0.954426, loss_d: 0.102829
Epoch finished! Loss: 1.1805581187638712
Starting epoch 6/10.
0.0000 --- loss: 0.979511, loss_ss: 0.861100, loss_d: 0.118411
0.0781 --- loss: 1.058410, loss_ss: 0.870753, loss_d: 0.187657
0.1562 --- loss: 1.086298, loss_ss: 0.803186, loss_d: 0.283112
0.2344 --- loss: 1.555709, loss_ss: 1.013635, loss_d: 0.542074
0.3125 --- loss: 1.038036, loss_ss: 0.928187, loss_d: 0.109849
0.3906 --- loss: 1.450384, loss_ss: 0.796746, loss_d: 0.653638
0.4688 --- loss: 1.081321, loss_ss: 0.937039, loss_d: 0.144282
0.5469 --- loss: 1.069236, loss_ss: 0.995446, loss_d: 0.073791
0.6250 --- loss: 0.970139, loss_ss: 0.843682, loss_d: 0.126457
0.7031 --- loss: 0.917888, loss_ss: 0.823726, loss_d: 0.094162
0.7812 --- loss: 1.037002, loss_ss: 0.963052, loss_d: 0.073950
0.8594 --- loss: 1.049831, loss_ss: 0.951569, loss_d: 0.098262
0.9375 --- loss: 1.134758, loss_ss: 0.988365, loss_d: 0.146392
Epoch finished! Loss: 1.1434758352482413
Starting epoch 7/10.
0.0000 --- loss: 0.866095, loss_ss: 0.666611, loss_d: 0.199484
0.0781 --- loss: 1.068417, loss_ss: 0.890223, loss_d: 0.178194
0.1562 --- loss: 0.987453, loss_ss: 0.883771, loss_d: 0.103683
0.2344 --- loss: 1.074461, loss_ss: 0.918213, loss_d: 0.156248
0.3125 --- loss: 1.233615, loss_ss: 1.012415, loss_d: 0.221199
0.3906 --- loss: 0.972620, loss_ss: 0.932606, loss_d: 0.040014
0.4688 --- loss: 0.848833, loss_ss: 0.841778, loss_d: 0.007055
0.5469 --- loss: 0.900264, loss_ss: 0.808309, loss_d: 0.091955
0.6250 --- loss: 0.851209, loss_ss: 0.815059, loss_d: 0.036150
0.7031 --- loss: 0.995886, loss_ss: 0.879316, loss_d: 0.116570
0.7812 --- loss: 0.913122, loss_ss: 0.842640, loss_d: 0.070482
0.8594 --- loss: 0.900658, loss_ss: 0.817281, loss_d: 0.083378
0.9375 --- loss: 0.810292, loss_ss: 0.759724, loss_d: 0.050568
Epoch finished! Loss: 1.0164051614408418
Starting epoch 8/10.
0.0000 --- loss: 0.962632, loss_ss: 0.952664, loss_d: 0.009969
0.0781 --- loss: 0.784247, loss_ss: 0.763647, loss_d: 0.020600
0.1562 --- loss: 1.109851, loss_ss: 1.054366, loss_d: 0.055485
0.2344 --- loss: 0.981941, loss_ss: 0.853782, loss_d: 0.128159
0.3125 --- loss: 1.143980, loss_ss: 0.847399, loss_d: 0.296582
0.3906 --- loss: 0.952450, loss_ss: 0.803633, loss_d: 0.148816
0.4688 --- loss: 1.184383, loss_ss: 1.077270, loss_d: 0.107112
0.5469 --- loss: 0.880003, loss_ss: 0.779372, loss_d: 0.100631
0.6250 --- loss: 0.851166, loss_ss: 0.781443, loss_d: 0.069723
0.7031 --- loss: 0.807247, loss_ss: 0.794286, loss_d: 0.012961
0.7812 --- loss: 0.998814, loss_ss: 0.993929, loss_d: 0.004884
0.8594 --- loss: 0.968546, loss_ss: 0.741204, loss_d: 0.227343
0.9375 --- loss: 0.828454, loss_ss: 0.820106, loss_d: 0.008348
Epoch finished! Loss: 1.0080265562365374
Starting epoch 9/10.
0.0000 --- loss: 0.828816, loss_ss: 0.798470, loss_d: 0.030346
0.0781 --- loss: 1.376951, loss_ss: 0.732872, loss_d: 0.644078
0.1562 --- loss: 1.567790, loss_ss: 1.062491, loss_d: 0.505299
0.2344 --- loss: 1.080055, loss_ss: 1.019205, loss_d: 0.060850
0.3125 --- loss: 1.482355, loss_ss: 0.959576, loss_d: 0.522779
0.3906 --- loss: 0.696266, loss_ss: 0.675124, loss_d: 0.021141
0.4688 --- loss: 0.941003, loss_ss: 0.933678, loss_d: 0.007325
0.5469 --- loss: 1.313855, loss_ss: 1.280783, loss_d: 0.033071
0.6250 --- loss: 0.956074, loss_ss: 0.899103, loss_d: 0.056972
0.7031 --- loss: 0.731982, loss_ss: 0.700106, loss_d: 0.031876
0.7812 --- loss: 0.768834, loss_ss: 0.751937, loss_d: 0.016897
0.8594 --- loss: 0.685170, loss_ss: 0.670405, loss_d: 0.014764
0.9375 --- loss: 0.730376, loss_ss: 0.704541, loss_d: 0.025835
Epoch finished! Loss: 0.9567288484160356
Starting epoch 10/10.
0.0000 --- loss: 0.641441, loss_ss: 0.632197, loss_d: 0.009244
0.0781 --- loss: 0.855676, loss_ss: 0.849296, loss_d: 0.006380
0.1562 --- loss: 0.738773, loss_ss: 0.720385, loss_d: 0.018389
0.2344 --- loss: 1.012313, loss_ss: 1.006354, loss_d: 0.005960
0.3125 --- loss: 0.661688, loss_ss: 0.653836, loss_d: 0.007852
0.3906 --- loss: 1.108026, loss_ss: 1.101445, loss_d: 0.006581
0.4688 --- loss: 0.775106, loss_ss: 0.770284, loss_d: 0.004822
0.5469 --- loss: 1.160225, loss_ss: 1.011955, loss_d: 0.148270
0.6250 --- loss: 1.194429, loss_ss: 1.193653, loss_d: 0.000776
0.7031 --- loss: 0.841688, loss_ss: 0.771804, loss_d: 0.069884
0.7812 --- loss: 1.000685, loss_ss: 0.711178, loss_d: 0.289507
0.8594 --- loss: 0.813370, loss_ss: 0.606385, loss_d: 0.206985
0.9375 --- loss: 0.835437, loss_ss: 0.829203, loss_d: 0.006234
Epoch finished! Loss: 0.9238515885796134
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6380316930775647
             precision    recall  f1-score   support

        0.0       0.64      0.62      0.63       151
        1.0       0.40      0.03      0.06       135
        2.0       0.61      0.93      0.74       442
        3.0       0.96      0.35      0.51       221
        4.0       0.62      0.72      0.67       250

avg / total       0.66      0.64      0.59      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.74  61.59   94.94  63.70     62.63
1  88.57   2.96   99.44  40.00      5.52
2  75.56  93.21   65.26  61.04     73.77
3  87.74  34.84   99.69  96.25     51.16
4  84.99  71.60   88.51  62.15     66.54
Total accuracy: 63.80%
Average sen: 52.84%
Average spec: 89.57%
Macro f1-score: 51.92%
Diagnosis acc on 30mins: 1.0
[0.99995804 0.99949944 0.99991846 0.99999225 0.99999988 1.
 0.9999783  0.99998927 0.99996161 0.9996112  0.99999952 0.99864429
 0.99999964 0.99995327 0.99978024 0.99901271 0.99987113 0.99999714
 0.99983752 0.99997759]
pred: 0.9997990757226944, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp045-nsrr

=== Test on chp046-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.576552, loss_ss: 1.889374, loss_d: 0.687177
0.0780 --- loss: 2.333135, loss_ss: 1.509394, loss_d: 0.823741
0.1560 --- loss: 2.147026, loss_ss: 1.518949, loss_d: 0.628076
0.2340 --- loss: 2.373840, loss_ss: 1.728142, loss_d: 0.645698
0.3120 --- loss: 2.074633, loss_ss: 1.509044, loss_d: 0.565589
0.3900 --- loss: 2.131876, loss_ss: 1.390194, loss_d: 0.741683
0.4680 --- loss: 1.776878, loss_ss: 1.394914, loss_d: 0.381964
0.5460 --- loss: 1.823698, loss_ss: 1.477272, loss_d: 0.346426
0.6240 --- loss: 1.827463, loss_ss: 1.288211, loss_d: 0.539252
0.7020 --- loss: 1.995927, loss_ss: 1.374607, loss_d: 0.621320
0.7800 --- loss: 1.859639, loss_ss: 1.418886, loss_d: 0.440752
0.8580 --- loss: 1.732107, loss_ss: 1.370203, loss_d: 0.361904
0.9360 --- loss: 1.800104, loss_ss: 1.254124, loss_d: 0.545980
Epoch finished! Loss: 2.079370064660907
Starting epoch 2/10.
0.0000 --- loss: 1.949872, loss_ss: 1.316351, loss_d: 0.633521
0.0780 --- loss: 1.616264, loss_ss: 1.158629, loss_d: 0.457635
0.1560 --- loss: 1.599850, loss_ss: 1.176644, loss_d: 0.423206
0.2340 --- loss: 1.761191, loss_ss: 1.163465, loss_d: 0.597725
0.3120 --- loss: 1.891501, loss_ss: 1.363465, loss_d: 0.528036
0.3900 --- loss: 1.637476, loss_ss: 1.188438, loss_d: 0.449038
0.4680 --- loss: 1.389513, loss_ss: 1.203519, loss_d: 0.185994
0.5460 --- loss: 1.522917, loss_ss: 1.234146, loss_d: 0.288771
0.6240 --- loss: 1.384808, loss_ss: 1.071258, loss_d: 0.313550
0.7020 --- loss: 1.280657, loss_ss: 1.016406, loss_d: 0.264250
0.7800 --- loss: 1.539203, loss_ss: 1.122015, loss_d: 0.417188
0.8580 --- loss: 1.314421, loss_ss: 1.118029, loss_d: 0.196392
0.9360 --- loss: 1.792948, loss_ss: 1.163516, loss_d: 0.629432
Epoch finished! Loss: 1.682947838678956
Starting epoch 3/10.
0.0000 --- loss: 1.480327, loss_ss: 0.979674, loss_d: 0.500653
0.0780 --- loss: 1.402078, loss_ss: 1.092232, loss_d: 0.309846
0.1560 --- loss: 1.250003, loss_ss: 1.110930, loss_d: 0.139074
0.2340 --- loss: 1.581790, loss_ss: 0.897360, loss_d: 0.684429
0.3120 --- loss: 1.429668, loss_ss: 1.192493, loss_d: 0.237175
0.3900 --- loss: 1.292419, loss_ss: 0.947271, loss_d: 0.345148
0.4680 --- loss: 1.633118, loss_ss: 1.027553, loss_d: 0.605565
0.5460 --- loss: 1.480451, loss_ss: 1.121905, loss_d: 0.358546
0.6240 --- loss: 1.492019, loss_ss: 1.083927, loss_d: 0.408092
0.7020 --- loss: 1.261979, loss_ss: 1.056614, loss_d: 0.205365
0.7800 --- loss: 1.466311, loss_ss: 1.159327, loss_d: 0.306984
0.8580 --- loss: 1.328800, loss_ss: 1.072548, loss_d: 0.256252
0.9360 --- loss: 1.434776, loss_ss: 1.293221, loss_d: 0.141555
Epoch finished! Loss: 1.4368616645224392
Starting epoch 4/10.
0.0000 --- loss: 1.760620, loss_ss: 1.149128, loss_d: 0.611491
0.0780 --- loss: 1.246025, loss_ss: 1.135457, loss_d: 0.110568
0.1560 --- loss: 1.134233, loss_ss: 0.953014, loss_d: 0.181219
0.2340 --- loss: 1.125801, loss_ss: 1.019414, loss_d: 0.106387
0.3120 --- loss: 1.273490, loss_ss: 1.144557, loss_d: 0.128933
0.3900 --- loss: 1.057389, loss_ss: 0.938954, loss_d: 0.118435
0.4680 --- loss: 1.557657, loss_ss: 1.309942, loss_d: 0.247715
0.5460 --- loss: 1.959362, loss_ss: 1.043266, loss_d: 0.916096
0.6240 --- loss: 1.310346, loss_ss: 1.248135, loss_d: 0.062211
0.7020 --- loss: 1.308775, loss_ss: 0.889351, loss_d: 0.419424
0.7800 --- loss: 2.159175, loss_ss: 0.863588, loss_d: 1.295587
0.8580 --- loss: 1.414417, loss_ss: 1.000881, loss_d: 0.413537
0.9360 --- loss: 1.257862, loss_ss: 1.106743, loss_d: 0.151119
Epoch finished! Loss: 1.2775184256024659
Starting epoch 5/10.
0.0000 --- loss: 1.139727, loss_ss: 1.025296, loss_d: 0.114431
0.0780 --- loss: 1.420805, loss_ss: 1.056347, loss_d: 0.364458
0.1560 --- loss: 1.011186, loss_ss: 0.934782, loss_d: 0.076405
0.2340 --- loss: 1.310987, loss_ss: 1.134618, loss_d: 0.176369
0.3120 --- loss: 1.209395, loss_ss: 0.913392, loss_d: 0.296003
0.3900 --- loss: 1.771597, loss_ss: 1.221841, loss_d: 0.549756
0.4680 --- loss: 0.965490, loss_ss: 0.843834, loss_d: 0.121657
0.5460 --- loss: 1.105571, loss_ss: 0.883651, loss_d: 0.221920
0.6240 --- loss: 1.090912, loss_ss: 0.982211, loss_d: 0.108701
0.7020 --- loss: 0.968027, loss_ss: 0.871649, loss_d: 0.096377
0.7800 --- loss: 1.082589, loss_ss: 0.980038, loss_d: 0.102550
0.8580 --- loss: 1.299025, loss_ss: 1.114343, loss_d: 0.184682
0.9360 --- loss: 1.132123, loss_ss: 1.119743, loss_d: 0.012380
Epoch finished! Loss: 1.1835287637077272
Starting epoch 6/10.
0.0000 --- loss: 0.850297, loss_ss: 0.784356, loss_d: 0.065942
0.0780 --- loss: 0.982393, loss_ss: 0.938225, loss_d: 0.044168
0.1560 --- loss: 0.925753, loss_ss: 0.833928, loss_d: 0.091826
0.2340 --- loss: 1.120480, loss_ss: 0.960815, loss_d: 0.159666
0.3120 --- loss: 0.862572, loss_ss: 0.836562, loss_d: 0.026010
0.3900 --- loss: 1.117886, loss_ss: 0.956247, loss_d: 0.161639
0.4680 --- loss: 1.369837, loss_ss: 0.969823, loss_d: 0.400014
0.5460 --- loss: 1.118325, loss_ss: 1.019868, loss_d: 0.098457
0.6240 --- loss: 0.871392, loss_ss: 0.839170, loss_d: 0.032222
0.7020 --- loss: 0.966427, loss_ss: 0.881540, loss_d: 0.084887
0.7800 --- loss: 1.056476, loss_ss: 0.920474, loss_d: 0.136002
0.8580 --- loss: 1.007670, loss_ss: 0.961481, loss_d: 0.046188
0.9360 --- loss: 0.872332, loss_ss: 0.796141, loss_d: 0.076190
Epoch finished! Loss: 1.0242025535553694
Starting epoch 7/10.
0.0000 --- loss: 0.809773, loss_ss: 0.778799, loss_d: 0.030974
0.0780 --- loss: 0.904171, loss_ss: 0.884058, loss_d: 0.020113
0.1560 --- loss: 1.332658, loss_ss: 1.275360, loss_d: 0.057298
0.2340 --- loss: 1.549666, loss_ss: 1.046475, loss_d: 0.503191
0.3120 --- loss: 1.150892, loss_ss: 0.926223, loss_d: 0.224670
0.3900 --- loss: 1.415839, loss_ss: 0.974843, loss_d: 0.440995
0.4680 --- loss: 0.830365, loss_ss: 0.823081, loss_d: 0.007284
0.5460 --- loss: 1.037098, loss_ss: 0.985476, loss_d: 0.051622
0.6240 --- loss: 0.826876, loss_ss: 0.775633, loss_d: 0.051244
0.7020 --- loss: 1.023997, loss_ss: 0.792500, loss_d: 0.231497
0.7800 --- loss: 0.841737, loss_ss: 0.829452, loss_d: 0.012284
0.8580 --- loss: 0.981359, loss_ss: 0.809931, loss_d: 0.171427
0.9360 --- loss: 0.863745, loss_ss: 0.536276, loss_d: 0.327469
Epoch finished! Loss: 1.0554646514356136
Starting epoch 8/10.
0.0000 --- loss: 1.036504, loss_ss: 0.776913, loss_d: 0.259591
0.0780 --- loss: 1.017605, loss_ss: 0.941500, loss_d: 0.076105
0.1560 --- loss: 0.673199, loss_ss: 0.617825, loss_d: 0.055374
0.2340 --- loss: 0.996275, loss_ss: 0.923698, loss_d: 0.072578
0.3120 --- loss: 0.964945, loss_ss: 0.837337, loss_d: 0.127607
0.3900 --- loss: 0.837527, loss_ss: 0.827228, loss_d: 0.010299
0.4680 --- loss: 0.991770, loss_ss: 0.914862, loss_d: 0.076908
0.5460 --- loss: 0.950124, loss_ss: 0.903295, loss_d: 0.046829
0.6240 --- loss: 1.176235, loss_ss: 0.719894, loss_d: 0.456342
0.7020 --- loss: 1.037348, loss_ss: 0.928770, loss_d: 0.108578
0.7800 --- loss: 0.851904, loss_ss: 0.838842, loss_d: 0.013061
0.8580 --- loss: 1.068757, loss_ss: 0.827279, loss_d: 0.241479
0.9360 --- loss: 0.934109, loss_ss: 0.829034, loss_d: 0.105075
Epoch finished! Loss: 0.9832438672892749
Starting epoch 9/10.
0.0000 --- loss: 1.212193, loss_ss: 1.137367, loss_d: 0.074826
0.0780 --- loss: 0.937607, loss_ss: 0.919583, loss_d: 0.018024
0.1560 --- loss: 1.323627, loss_ss: 1.321411, loss_d: 0.002216
0.2340 --- loss: 0.988620, loss_ss: 0.920473, loss_d: 0.068147
0.3120 --- loss: 1.017667, loss_ss: 0.998733, loss_d: 0.018934
0.3900 --- loss: 0.822834, loss_ss: 0.795244, loss_d: 0.027590
0.4680 --- loss: 1.790523, loss_ss: 0.943616, loss_d: 0.846907
0.5460 --- loss: 0.964033, loss_ss: 0.874394, loss_d: 0.089640
0.6240 --- loss: 0.750392, loss_ss: 0.729089, loss_d: 0.021304
0.7020 --- loss: 1.714856, loss_ss: 1.507377, loss_d: 0.207479
0.7800 --- loss: 0.786696, loss_ss: 0.754744, loss_d: 0.031952
0.8580 --- loss: 0.666053, loss_ss: 0.660328, loss_d: 0.005725
0.9360 --- loss: 0.995918, loss_ss: 0.746186, loss_d: 0.249732
Epoch finished! Loss: 0.9612836530432105
Starting epoch 10/10.
0.0000 --- loss: 0.735499, loss_ss: 0.715866, loss_d: 0.019633
0.0780 --- loss: 0.928237, loss_ss: 0.760718, loss_d: 0.167519
0.1560 --- loss: 0.775392, loss_ss: 0.772887, loss_d: 0.002505
0.2340 --- loss: 0.730020, loss_ss: 0.717785, loss_d: 0.012236
0.3120 --- loss: 0.866872, loss_ss: 0.865359, loss_d: 0.001513
0.3900 --- loss: 0.792157, loss_ss: 0.791404, loss_d: 0.000753
0.4680 --- loss: 0.854896, loss_ss: 0.847741, loss_d: 0.007154
0.5460 --- loss: 0.903634, loss_ss: 0.876067, loss_d: 0.027567
0.6240 --- loss: 0.903836, loss_ss: 0.899105, loss_d: 0.004730
0.7020 --- loss: 0.812713, loss_ss: 0.809328, loss_d: 0.003385
0.7800 --- loss: 0.956377, loss_ss: 0.949190, loss_d: 0.007187
0.8580 --- loss: 0.810733, loss_ss: 0.781949, loss_d: 0.028784
0.9360 --- loss: 0.855454, loss_ss: 0.835874, loss_d: 0.019581
Epoch finished! Loss: 0.8876982652582228
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6611111111111111
             precision    recall  f1-score   support

        0.0       0.92      0.80      0.85       226
        1.0       0.67      0.35      0.46       357
        2.0       0.81      0.69      0.75       192
        3.0       0.00      0.00      0.00         2
        4.0       0.52      0.91      0.66       303

avg / total       0.70      0.66      0.65      1080
 


====== chp046-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.26  79.65   98.13  91.84     85.31
1  72.87  35.29   91.42  67.02     46.24
2  91.57  69.27   96.40  80.61     74.51
3  99.81   0.00  100.00   0.00      0.00
4  73.70  90.76   67.05  51.79     65.95
Total accuracy: 66.11%
Average sen: 54.99%
Average spec: 90.60%
Macro f1-score: 54.40%
Diagnosis acc on 30mins: 1.0
[0.99999976 0.99999845 0.99999917 1.         0.99999785 0.99999714
 1.         0.99999988 1.         0.9999994  0.99999988 0.9999994
 1.         1.         1.         0.99999642 0.99999797 0.99999976]
pred: 0.9999991721577115, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp046-nsrr

=== Test on chp047-nsrr. train_data(1286), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.121024, loss_ss: 1.490850, loss_d: 0.630174
0.0778 --- loss: 2.177772, loss_ss: 1.691212, loss_d: 0.486560
0.1555 --- loss: 1.899170, loss_ss: 1.505661, loss_d: 0.393509
0.2333 --- loss: 2.240161, loss_ss: 1.578946, loss_d: 0.661214
0.3110 --- loss: 1.934149, loss_ss: 1.482202, loss_d: 0.451947
0.3888 --- loss: 2.221696, loss_ss: 1.559578, loss_d: 0.662118
0.4666 --- loss: 2.166223, loss_ss: 1.564943, loss_d: 0.601280
0.5443 --- loss: 1.926520, loss_ss: 1.420870, loss_d: 0.505650
0.6221 --- loss: 2.008641, loss_ss: 1.461819, loss_d: 0.546822
0.6998 --- loss: 1.979293, loss_ss: 1.513139, loss_d: 0.466153
0.7776 --- loss: 1.893602, loss_ss: 1.467402, loss_d: 0.426200
0.8554 --- loss: 1.765116, loss_ss: 1.383983, loss_d: 0.381133
0.9331 --- loss: 1.898172, loss_ss: 1.368976, loss_d: 0.529196
Epoch finished! Loss: 2.0921436632052064
Starting epoch 2/10.
0.0000 --- loss: 1.847279, loss_ss: 1.305768, loss_d: 0.541511
0.0778 --- loss: 1.941103, loss_ss: 1.435041, loss_d: 0.506062
0.1555 --- loss: 1.866397, loss_ss: 1.307485, loss_d: 0.558912
0.2333 --- loss: 2.047334, loss_ss: 1.313097, loss_d: 0.734237
0.3110 --- loss: 1.792634, loss_ss: 1.320305, loss_d: 0.472329
0.3888 --- loss: 2.022372, loss_ss: 1.251682, loss_d: 0.770691
0.4666 --- loss: 1.665809, loss_ss: 1.206513, loss_d: 0.459296
0.5443 --- loss: 1.564036, loss_ss: 1.281264, loss_d: 0.282772
0.6221 --- loss: 1.774725, loss_ss: 1.428614, loss_d: 0.346111
0.6998 --- loss: 1.729019, loss_ss: 1.286923, loss_d: 0.442096
0.7776 --- loss: 1.737412, loss_ss: 1.336663, loss_d: 0.400749
0.8554 --- loss: 1.680742, loss_ss: 1.254085, loss_d: 0.426657
0.9331 --- loss: 1.892185, loss_ss: 1.278198, loss_d: 0.613988
Epoch finished! Loss: 1.7814705735072494
Starting epoch 3/10.
0.0000 --- loss: 1.737204, loss_ss: 1.368438, loss_d: 0.368766
0.0778 --- loss: 1.800496, loss_ss: 1.313810, loss_d: 0.486686
0.1555 --- loss: 1.533526, loss_ss: 1.317498, loss_d: 0.216028
0.2333 --- loss: 1.396300, loss_ss: 1.229075, loss_d: 0.167224
0.3110 --- loss: 1.416666, loss_ss: 1.179541, loss_d: 0.237125
0.3888 --- loss: 1.132699, loss_ss: 1.057241, loss_d: 0.075457
0.4666 --- loss: 1.380587, loss_ss: 1.236611, loss_d: 0.143976
0.5443 --- loss: 1.393658, loss_ss: 1.002748, loss_d: 0.390910
0.6221 --- loss: 1.799888, loss_ss: 1.233847, loss_d: 0.566041
0.6998 --- loss: 1.526415, loss_ss: 1.186175, loss_d: 0.340240
0.7776 --- loss: 1.196309, loss_ss: 1.002557, loss_d: 0.193752
0.8554 --- loss: 1.340286, loss_ss: 1.048149, loss_d: 0.292138
0.9331 --- loss: 1.734494, loss_ss: 1.293857, loss_d: 0.440637
Epoch finished! Loss: 1.5070996889844537
Starting epoch 4/10.
0.0000 --- loss: 1.420993, loss_ss: 1.009491, loss_d: 0.411502
0.0778 --- loss: 1.555249, loss_ss: 1.085319, loss_d: 0.469930
0.1555 --- loss: 1.203270, loss_ss: 1.069771, loss_d: 0.133498
0.2333 --- loss: 1.917434, loss_ss: 1.059561, loss_d: 0.857872
0.3110 --- loss: 1.213616, loss_ss: 1.105613, loss_d: 0.108003
0.3888 --- loss: 1.225788, loss_ss: 1.034112, loss_d: 0.191676
0.4666 --- loss: 1.236627, loss_ss: 1.128303, loss_d: 0.108324
0.5443 --- loss: 2.203905, loss_ss: 1.146263, loss_d: 1.057642
0.6221 --- loss: 1.018687, loss_ss: 0.915286, loss_d: 0.103401
0.6998 --- loss: 1.147622, loss_ss: 0.895540, loss_d: 0.252081
0.7776 --- loss: 1.116689, loss_ss: 1.075650, loss_d: 0.041039
0.8554 --- loss: 1.312729, loss_ss: 1.094241, loss_d: 0.218489
0.9331 --- loss: 1.339579, loss_ss: 0.908535, loss_d: 0.431044
Epoch finished! Loss: 1.3286420702934265
Starting epoch 5/10.
0.0000 --- loss: 1.723365, loss_ss: 1.141904, loss_d: 0.581462
0.0778 --- loss: 1.123589, loss_ss: 0.972260, loss_d: 0.151329
0.1555 --- loss: 1.306696, loss_ss: 0.983936, loss_d: 0.322760
0.2333 --- loss: 1.123304, loss_ss: 0.942148, loss_d: 0.181156
0.3110 --- loss: 1.299154, loss_ss: 0.947185, loss_d: 0.351969
0.3888 --- loss: 1.038242, loss_ss: 0.943250, loss_d: 0.094992
0.4666 --- loss: 1.205975, loss_ss: 0.900160, loss_d: 0.305815
0.5443 --- loss: 1.683378, loss_ss: 1.102480, loss_d: 0.580898
0.6221 --- loss: 1.158811, loss_ss: 0.846608, loss_d: 0.312203
0.6998 --- loss: 1.230208, loss_ss: 0.922475, loss_d: 0.307733
0.7776 --- loss: 1.390316, loss_ss: 0.950976, loss_d: 0.439341
0.8554 --- loss: 1.101969, loss_ss: 0.826419, loss_d: 0.275550
0.9331 --- loss: 0.910625, loss_ss: 0.835527, loss_d: 0.075098
Epoch finished! Loss: 1.20130524225533
Starting epoch 6/10.
0.0000 --- loss: 0.996049, loss_ss: 0.942977, loss_d: 0.053072
0.0778 --- loss: 1.186733, loss_ss: 0.904557, loss_d: 0.282177
0.1555 --- loss: 1.395280, loss_ss: 0.936748, loss_d: 0.458532
0.2333 --- loss: 1.113827, loss_ss: 1.036696, loss_d: 0.077131
0.3110 --- loss: 1.132172, loss_ss: 0.976882, loss_d: 0.155290
0.3888 --- loss: 1.448067, loss_ss: 0.964606, loss_d: 0.483461
0.4666 --- loss: 1.012344, loss_ss: 0.967047, loss_d: 0.045297
0.5443 --- loss: 1.115269, loss_ss: 1.028057, loss_d: 0.087213
0.6221 --- loss: 0.900218, loss_ss: 0.875680, loss_d: 0.024539
0.6998 --- loss: 1.326657, loss_ss: 1.232140, loss_d: 0.094517
0.7776 --- loss: 1.402398, loss_ss: 0.969727, loss_d: 0.432671
0.8554 --- loss: 0.701705, loss_ss: 0.631064, loss_d: 0.070641
0.9331 --- loss: 1.193832, loss_ss: 1.118159, loss_d: 0.075673
Epoch finished! Loss: 1.1069804928265512
Starting epoch 7/10.
0.0000 --- loss: 0.923226, loss_ss: 0.767093, loss_d: 0.156133
0.0778 --- loss: 0.969866, loss_ss: 0.909090, loss_d: 0.060776
0.1555 --- loss: 0.879258, loss_ss: 0.860966, loss_d: 0.018291
0.2333 --- loss: 1.135383, loss_ss: 1.037460, loss_d: 0.097923
0.3110 --- loss: 0.882538, loss_ss: 0.783859, loss_d: 0.098679
0.3888 --- loss: 0.735319, loss_ss: 0.730375, loss_d: 0.004944
0.4666 --- loss: 0.974654, loss_ss: 0.866676, loss_d: 0.107978
0.5443 --- loss: 1.093736, loss_ss: 0.797154, loss_d: 0.296582
0.6221 --- loss: 1.135596, loss_ss: 0.850158, loss_d: 0.285438
0.6998 --- loss: 0.828618, loss_ss: 0.785487, loss_d: 0.043131
0.7776 --- loss: 0.826074, loss_ss: 0.750982, loss_d: 0.075092
0.8554 --- loss: 1.178600, loss_ss: 0.879603, loss_d: 0.298997
0.9331 --- loss: 1.923792, loss_ss: 1.063989, loss_d: 0.859802
Epoch finished! Loss: 1.0576859381981194
Starting epoch 8/10.
0.0000 --- loss: 1.056219, loss_ss: 0.968435, loss_d: 0.087784
0.0778 --- loss: 0.801634, loss_ss: 0.795124, loss_d: 0.006510
0.1555 --- loss: 0.955482, loss_ss: 0.788542, loss_d: 0.166940
0.2333 --- loss: 0.824664, loss_ss: 0.725848, loss_d: 0.098816
0.3110 --- loss: 0.963789, loss_ss: 0.929263, loss_d: 0.034526
0.3888 --- loss: 0.858597, loss_ss: 0.825889, loss_d: 0.032709
0.4666 --- loss: 1.112885, loss_ss: 1.096565, loss_d: 0.016320
0.5443 --- loss: 0.914655, loss_ss: 0.855688, loss_d: 0.058967
0.6221 --- loss: 1.370678, loss_ss: 1.213425, loss_d: 0.157253
0.6998 --- loss: 0.822893, loss_ss: 0.802658, loss_d: 0.020236
0.7776 --- loss: 0.797484, loss_ss: 0.779797, loss_d: 0.017687
0.8554 --- loss: 0.877141, loss_ss: 0.873560, loss_d: 0.003581
0.9331 --- loss: 0.818408, loss_ss: 0.793330, loss_d: 0.025078
Epoch finished! Loss: 0.9679477117024362
Starting epoch 9/10.
0.0000 --- loss: 0.876876, loss_ss: 0.870330, loss_d: 0.006546
0.0778 --- loss: 0.813884, loss_ss: 0.635929, loss_d: 0.177955
0.1555 --- loss: 0.752141, loss_ss: 0.734312, loss_d: 0.017829
0.2333 --- loss: 0.757499, loss_ss: 0.750409, loss_d: 0.007090
0.3110 --- loss: 0.717133, loss_ss: 0.691608, loss_d: 0.025525
0.3888 --- loss: 0.851286, loss_ss: 0.822031, loss_d: 0.029255
0.4666 --- loss: 0.833732, loss_ss: 0.819965, loss_d: 0.013767
0.5443 --- loss: 0.904015, loss_ss: 0.873320, loss_d: 0.030695
0.6221 --- loss: 0.701745, loss_ss: 0.683259, loss_d: 0.018485
0.6998 --- loss: 1.217796, loss_ss: 1.204214, loss_d: 0.013582
0.7776 --- loss: 0.954476, loss_ss: 0.925684, loss_d: 0.028792
0.8554 --- loss: 0.984265, loss_ss: 0.942579, loss_d: 0.041685
0.9331 --- loss: 0.818983, loss_ss: 0.809141, loss_d: 0.009842
Epoch finished! Loss: 0.9583482574671507
Starting epoch 10/10.
0.0000 --- loss: 0.748956, loss_ss: 0.688992, loss_d: 0.059964
0.0778 --- loss: 0.930424, loss_ss: 0.924720, loss_d: 0.005704
0.1555 --- loss: 0.975183, loss_ss: 0.973188, loss_d: 0.001995
0.2333 --- loss: 0.794597, loss_ss: 0.785604, loss_d: 0.008993
0.3110 --- loss: 0.772591, loss_ss: 0.770339, loss_d: 0.002252
0.3888 --- loss: 0.821451, loss_ss: 0.787821, loss_d: 0.033630
0.4666 --- loss: 1.173539, loss_ss: 0.937376, loss_d: 0.236163
0.5443 --- loss: 0.758904, loss_ss: 0.755782, loss_d: 0.003122
0.6221 --- loss: 0.921360, loss_ss: 0.708836, loss_d: 0.212524
0.6998 --- loss: 0.826953, loss_ss: 0.809942, loss_d: 0.017011
0.7776 --- loss: 0.966302, loss_ss: 0.905966, loss_d: 0.060337
0.8554 --- loss: 0.922774, loss_ss: 0.856351, loss_d: 0.066422
0.9331 --- loss: 0.999550, loss_ss: 0.928239, loss_d: 0.071311
Epoch finished! Loss: 0.9599000462330878
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.37857142857142856
             precision    recall  f1-score   support

        0.0       0.72      0.25      0.37       281
        1.0       0.30      0.58      0.39       213
        2.0       0.68      0.35      0.46       233
        3.0       0.00      0.00      0.00        25
        4.0       0.21      0.50      0.30        88

avg / total       0.53      0.38      0.38       840
 


====== chp047-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  71.55  24.56   95.17  71.88     36.60
1  54.76  58.22   53.59  29.88     39.49
2  77.38  34.76   93.74  68.07     46.02
3  97.02   0.00  100.00   0.00      0.00
4  75.00  50.00   77.93  20.95     29.53
Total accuracy: 37.86%
Average sen: 33.51%
Average spec: 84.08%
Macro f1-score: 30.33%
Diagnosis acc on 30mins: 1.0
[0.99923754 0.99974138 0.99780005 0.99985576 0.99995029 0.99996758
 0.99946314 0.9979704  0.99990225 0.99589843 0.9977532  0.99992311
 0.99995434 0.99995089]
pred: 0.9990977389471871, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp047-nsrr

=== Test on chp048-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.384608, loss_ss: 1.659026, loss_d: 0.725582
0.0779 --- loss: 1.963821, loss_ss: 1.492640, loss_d: 0.471181
0.1559 --- loss: 2.244404, loss_ss: 1.520923, loss_d: 0.723481
0.2338 --- loss: 1.964047, loss_ss: 1.426562, loss_d: 0.537485
0.3118 --- loss: 2.368630, loss_ss: 1.421439, loss_d: 0.947190
0.3897 --- loss: 2.145056, loss_ss: 1.385317, loss_d: 0.759739
0.4677 --- loss: 2.272036, loss_ss: 1.511836, loss_d: 0.760200
0.5456 --- loss: 2.191945, loss_ss: 1.545570, loss_d: 0.646375
0.6235 --- loss: 2.100054, loss_ss: 1.385831, loss_d: 0.714223
0.7015 --- loss: 2.183040, loss_ss: 1.444647, loss_d: 0.738393
0.7794 --- loss: 1.773088, loss_ss: 1.322243, loss_d: 0.450845
0.8574 --- loss: 1.727855, loss_ss: 1.435731, loss_d: 0.292124
0.9353 --- loss: 1.676883, loss_ss: 1.406523, loss_d: 0.270361
Epoch finished! Loss: 2.0410509556531906
Starting epoch 2/10.
0.0000 --- loss: 1.807811, loss_ss: 1.461720, loss_d: 0.346091
0.0779 --- loss: 1.730318, loss_ss: 1.275329, loss_d: 0.454990
0.1559 --- loss: 1.983026, loss_ss: 1.361233, loss_d: 0.621793
0.2338 --- loss: 1.767041, loss_ss: 1.305109, loss_d: 0.461933
0.3118 --- loss: 2.150641, loss_ss: 1.407835, loss_d: 0.742807
0.3897 --- loss: 1.930080, loss_ss: 1.081774, loss_d: 0.848306
0.4677 --- loss: 1.774637, loss_ss: 1.280066, loss_d: 0.494571
0.5456 --- loss: 1.600509, loss_ss: 1.303515, loss_d: 0.296995
0.6235 --- loss: 1.681775, loss_ss: 1.240577, loss_d: 0.441198
0.7015 --- loss: 1.661803, loss_ss: 1.244221, loss_d: 0.417582
0.7794 --- loss: 1.899500, loss_ss: 1.258961, loss_d: 0.640539
0.8574 --- loss: 1.712982, loss_ss: 1.315240, loss_d: 0.397742
0.9353 --- loss: 1.794730, loss_ss: 1.190485, loss_d: 0.604245
Epoch finished! Loss: 1.7557632755488157
Starting epoch 3/10.
0.0000 --- loss: 1.605504, loss_ss: 1.307080, loss_d: 0.298424
0.0779 --- loss: 1.553073, loss_ss: 1.238613, loss_d: 0.314460
0.1559 --- loss: 1.562651, loss_ss: 1.082253, loss_d: 0.480398
0.2338 --- loss: 1.246396, loss_ss: 1.115975, loss_d: 0.130421
0.3118 --- loss: 1.279811, loss_ss: 1.184758, loss_d: 0.095053
0.3897 --- loss: 1.441579, loss_ss: 1.203107, loss_d: 0.238472
0.4677 --- loss: 1.313042, loss_ss: 1.176173, loss_d: 0.136869
0.5456 --- loss: 1.330412, loss_ss: 1.024458, loss_d: 0.305954
0.6235 --- loss: 1.235934, loss_ss: 1.066691, loss_d: 0.169243
0.7015 --- loss: 1.235768, loss_ss: 1.142789, loss_d: 0.092979
0.7794 --- loss: 1.461964, loss_ss: 1.230978, loss_d: 0.230986
0.8574 --- loss: 1.287114, loss_ss: 0.884644, loss_d: 0.402470
0.9353 --- loss: 1.424208, loss_ss: 0.917175, loss_d: 0.507033
Epoch finished! Loss: 1.418629523832351
Starting epoch 4/10.
0.0000 --- loss: 1.417536, loss_ss: 1.350753, loss_d: 0.066783
0.0779 --- loss: 1.786653, loss_ss: 1.094854, loss_d: 0.691799
0.1559 --- loss: 1.558455, loss_ss: 1.204279, loss_d: 0.354176
0.2338 --- loss: 1.431514, loss_ss: 0.980498, loss_d: 0.451017
0.3118 --- loss: 1.128877, loss_ss: 0.932511, loss_d: 0.196367
0.3897 --- loss: 1.304777, loss_ss: 1.112686, loss_d: 0.192091
0.4677 --- loss: 1.345545, loss_ss: 1.065652, loss_d: 0.279893
0.5456 --- loss: 1.199278, loss_ss: 1.131198, loss_d: 0.068080
0.6235 --- loss: 1.135401, loss_ss: 1.095850, loss_d: 0.039551
0.7015 --- loss: 1.059399, loss_ss: 1.009985, loss_d: 0.049413
0.7794 --- loss: 1.421546, loss_ss: 1.051832, loss_d: 0.369714
0.8574 --- loss: 1.160189, loss_ss: 1.066515, loss_d: 0.093674
0.9353 --- loss: 1.577533, loss_ss: 0.978371, loss_d: 0.599162
Epoch finished! Loss: 1.3001070390455425
Starting epoch 5/10.
0.0000 --- loss: 1.400952, loss_ss: 1.200381, loss_d: 0.200571
0.0779 --- loss: 1.339606, loss_ss: 1.209219, loss_d: 0.130388
0.1559 --- loss: 1.275912, loss_ss: 0.996063, loss_d: 0.279850
0.2338 --- loss: 1.146254, loss_ss: 1.104616, loss_d: 0.041638
0.3118 --- loss: 1.032626, loss_ss: 0.845919, loss_d: 0.186707
0.3897 --- loss: 1.342271, loss_ss: 1.029448, loss_d: 0.312822
0.4677 --- loss: 0.978351, loss_ss: 0.955993, loss_d: 0.022358
0.5456 --- loss: 1.122797, loss_ss: 0.975365, loss_d: 0.147433
0.6235 --- loss: 1.099605, loss_ss: 0.825539, loss_d: 0.274066
0.7015 --- loss: 1.151037, loss_ss: 0.896089, loss_d: 0.254948
0.7794 --- loss: 1.183928, loss_ss: 1.137857, loss_d: 0.046072
0.8574 --- loss: 1.021074, loss_ss: 0.943564, loss_d: 0.077510
0.9353 --- loss: 0.857737, loss_ss: 0.799555, loss_d: 0.058182
Epoch finished! Loss: 1.1747574293985963
Starting epoch 6/10.
0.0000 --- loss: 0.899858, loss_ss: 0.883240, loss_d: 0.016618
0.0779 --- loss: 0.993601, loss_ss: 0.946200, loss_d: 0.047401
0.1559 --- loss: 0.793397, loss_ss: 0.744893, loss_d: 0.048503
0.2338 --- loss: 1.059442, loss_ss: 1.017780, loss_d: 0.041662
0.3118 --- loss: 0.845097, loss_ss: 0.795081, loss_d: 0.050017
0.3897 --- loss: 1.420566, loss_ss: 0.866401, loss_d: 0.554165
0.4677 --- loss: 1.121115, loss_ss: 0.872965, loss_d: 0.248150
0.5456 --- loss: 1.038071, loss_ss: 0.924044, loss_d: 0.114027
0.6235 --- loss: 1.021437, loss_ss: 1.006868, loss_d: 0.014569
0.7015 --- loss: 0.749768, loss_ss: 0.743436, loss_d: 0.006331
0.7794 --- loss: 1.180305, loss_ss: 1.038165, loss_d: 0.142139
0.8574 --- loss: 0.993989, loss_ss: 0.986039, loss_d: 0.007950
0.9353 --- loss: 0.922483, loss_ss: 0.824654, loss_d: 0.097829
Epoch finished! Loss: 1.0724538774229586
Starting epoch 7/10.
0.0000 --- loss: 0.905809, loss_ss: 0.893220, loss_d: 0.012589
0.0779 --- loss: 1.060920, loss_ss: 1.049023, loss_d: 0.011897
0.1559 --- loss: 1.075454, loss_ss: 1.025674, loss_d: 0.049781
0.2338 --- loss: 1.182163, loss_ss: 0.977276, loss_d: 0.204887
0.3118 --- loss: 1.032225, loss_ss: 0.908310, loss_d: 0.123915
0.3897 --- loss: 0.925728, loss_ss: 0.840646, loss_d: 0.085082
0.4677 --- loss: 0.971615, loss_ss: 0.866153, loss_d: 0.105461
0.5456 --- loss: 0.966103, loss_ss: 0.753187, loss_d: 0.212916
0.6235 --- loss: 0.966064, loss_ss: 0.954217, loss_d: 0.011847
0.7015 --- loss: 1.445041, loss_ss: 0.887465, loss_d: 0.557576
0.7794 --- loss: 0.961777, loss_ss: 0.869703, loss_d: 0.092074
0.8574 --- loss: 0.852677, loss_ss: 0.769256, loss_d: 0.083421
0.9353 --- loss: 0.814661, loss_ss: 0.742426, loss_d: 0.072235
Epoch finished! Loss: 1.0440860642120242
Starting epoch 8/10.
0.0000 --- loss: 0.857971, loss_ss: 0.844654, loss_d: 0.013318
0.0779 --- loss: 0.879920, loss_ss: 0.754601, loss_d: 0.125320
0.1559 --- loss: 0.980938, loss_ss: 0.843508, loss_d: 0.137429
0.2338 --- loss: 1.014825, loss_ss: 0.945746, loss_d: 0.069078
0.3118 --- loss: 0.732053, loss_ss: 0.628929, loss_d: 0.103124
0.3897 --- loss: 1.260843, loss_ss: 1.080889, loss_d: 0.179954
0.4677 --- loss: 0.975637, loss_ss: 0.885756, loss_d: 0.089881
0.5456 --- loss: 0.787711, loss_ss: 0.775742, loss_d: 0.011969
0.6235 --- loss: 0.877915, loss_ss: 0.813426, loss_d: 0.064489
0.7015 --- loss: 1.023675, loss_ss: 0.987601, loss_d: 0.036074
0.7794 --- loss: 0.894006, loss_ss: 0.888995, loss_d: 0.005011
0.8574 --- loss: 0.842306, loss_ss: 0.814322, loss_d: 0.027984
0.9353 --- loss: 1.079465, loss_ss: 0.981448, loss_d: 0.098017
Epoch finished! Loss: 1.0113253151066601
Starting epoch 9/10.
0.0000 --- loss: 0.901834, loss_ss: 0.813982, loss_d: 0.087853
0.0779 --- loss: 0.816266, loss_ss: 0.786271, loss_d: 0.029995
0.1559 --- loss: 1.428845, loss_ss: 1.231647, loss_d: 0.197198
0.2338 --- loss: 0.978639, loss_ss: 0.966399, loss_d: 0.012240
0.3118 --- loss: 0.971341, loss_ss: 0.837527, loss_d: 0.133814
0.3897 --- loss: 1.014243, loss_ss: 0.902110, loss_d: 0.112133
0.4677 --- loss: 1.035520, loss_ss: 0.813552, loss_d: 0.221969
0.5456 --- loss: 0.811034, loss_ss: 0.791237, loss_d: 0.019797
0.6235 --- loss: 0.960528, loss_ss: 0.934997, loss_d: 0.025531
0.7015 --- loss: 0.929637, loss_ss: 0.886186, loss_d: 0.043451
0.7794 --- loss: 0.788945, loss_ss: 0.737265, loss_d: 0.051680
0.8574 --- loss: 0.956189, loss_ss: 0.730084, loss_d: 0.226105
0.9353 --- loss: 0.826180, loss_ss: 0.670710, loss_d: 0.155469
Epoch finished! Loss: 0.9538145498372614
Starting epoch 10/10.
0.0000 --- loss: 0.681856, loss_ss: 0.667538, loss_d: 0.014318
0.0779 --- loss: 0.709694, loss_ss: 0.668910, loss_d: 0.040783
0.1559 --- loss: 0.846064, loss_ss: 0.838873, loss_d: 0.007191
0.2338 --- loss: 0.880677, loss_ss: 0.775377, loss_d: 0.105300
0.3118 --- loss: 0.735287, loss_ss: 0.732135, loss_d: 0.003152
0.3897 --- loss: 0.687436, loss_ss: 0.677091, loss_d: 0.010345
0.4677 --- loss: 0.879560, loss_ss: 0.874887, loss_d: 0.004674
0.5456 --- loss: 0.896033, loss_ss: 0.885691, loss_d: 0.010342
0.6235 --- loss: 1.230067, loss_ss: 1.218350, loss_d: 0.011717
0.7015 --- loss: 0.878989, loss_ss: 0.817109, loss_d: 0.061880
0.7794 --- loss: 0.723316, loss_ss: 0.717117, loss_d: 0.006199
0.8574 --- loss: 0.921091, loss_ss: 0.802897, loss_d: 0.118193
0.9353 --- loss: 0.909540, loss_ss: 0.888049, loss_d: 0.021491
Epoch finished! Loss: 0.9162639491260052
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6245098039215686
             precision    recall  f1-score   support

        0.0       0.19      0.89      0.31        38
        1.0       0.36      0.25      0.30       144
        2.0       0.75      0.88      0.81       495
        3.0       0.73      0.55      0.63       107
        4.0       0.91      0.31      0.46       236

avg / total       0.71      0.62      0.62      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.29  89.47   85.13  18.89     31.19
1  83.14  25.00   92.69  36.00     29.51
2  80.00  87.88   72.57  75.13     81.01
3  93.14  55.14   97.59  72.84     62.77
4  83.33  30.93   99.11  91.25     46.20
Total accuracy: 62.45%
Average sen: 57.68%
Average spec: 89.42%
Macro f1-score: 50.13%
Diagnosis acc on 30mins: 0.058823529411764705
[7.53581345e-01 2.94265454e-03 8.95475212e-04 6.64110668e-03
 1.30553765e-03 3.41932842e-04 2.28193775e-03 3.36035155e-02
 1.17350610e-04 3.92195396e-03 1.42302543e-01 1.30759150e-01
 2.73671676e-03 2.15015590e-01 1.32616209e-02 6.91353902e-02
 4.70268391e-02]
pred: 0.08387474468712325, label: 1
Wrong!!! Real Diagnosis: NT1
Save 30mins of subject chp048-nsrr

=== Test on chp049-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.362639, loss_ss: 1.670243, loss_d: 0.692396
0.0780 --- loss: 2.473752, loss_ss: 1.670699, loss_d: 0.803053
0.1560 --- loss: 1.964543, loss_ss: 1.570311, loss_d: 0.394232
0.2340 --- loss: 2.176112, loss_ss: 1.597034, loss_d: 0.579078
0.3120 --- loss: 2.044688, loss_ss: 1.503653, loss_d: 0.541036
0.3900 --- loss: 2.220969, loss_ss: 1.601110, loss_d: 0.619859
0.4680 --- loss: 2.446759, loss_ss: 1.599591, loss_d: 0.847168
0.5460 --- loss: 2.387628, loss_ss: 1.576399, loss_d: 0.811229
0.6240 --- loss: 2.274513, loss_ss: 1.424781, loss_d: 0.849732
0.7020 --- loss: 2.039253, loss_ss: 1.435689, loss_d: 0.603564
0.7800 --- loss: 1.837127, loss_ss: 1.398494, loss_d: 0.438633
0.8580 --- loss: 1.868865, loss_ss: 1.343004, loss_d: 0.525861
0.9360 --- loss: 1.847693, loss_ss: 1.435545, loss_d: 0.412147
Epoch finished! Loss: 2.115833361633122
Starting epoch 2/10.
0.0000 --- loss: 2.201459, loss_ss: 1.425941, loss_d: 0.775518
0.0780 --- loss: 1.846728, loss_ss: 1.462795, loss_d: 0.383934
0.1560 --- loss: 1.976596, loss_ss: 1.375975, loss_d: 0.600621
0.2340 --- loss: 1.742066, loss_ss: 1.315571, loss_d: 0.426495
0.3120 --- loss: 1.768576, loss_ss: 1.313475, loss_d: 0.455101
0.3900 --- loss: 2.158963, loss_ss: 1.311565, loss_d: 0.847398
0.4680 --- loss: 2.022318, loss_ss: 1.360165, loss_d: 0.662153
0.5460 --- loss: 1.826750, loss_ss: 1.327109, loss_d: 0.499641
0.6240 --- loss: 1.592628, loss_ss: 1.270130, loss_d: 0.322498
0.7020 --- loss: 1.716835, loss_ss: 1.145312, loss_d: 0.571523
0.7800 --- loss: 1.638058, loss_ss: 1.346598, loss_d: 0.291460
0.8580 --- loss: 1.529018, loss_ss: 1.162592, loss_d: 0.366426
0.9360 --- loss: 1.482235, loss_ss: 1.255358, loss_d: 0.226877
Epoch finished! Loss: 1.7883744798600674
Starting epoch 3/10.
0.0000 --- loss: 1.404927, loss_ss: 1.213280, loss_d: 0.191647
0.0780 --- loss: 1.436905, loss_ss: 1.300435, loss_d: 0.136470
0.1560 --- loss: 1.758946, loss_ss: 1.214693, loss_d: 0.544253
0.2340 --- loss: 1.238249, loss_ss: 1.127462, loss_d: 0.110786
0.3120 --- loss: 1.872829, loss_ss: 1.120598, loss_d: 0.752232
0.3900 --- loss: 1.733562, loss_ss: 1.197974, loss_d: 0.535588
0.4680 --- loss: 1.624098, loss_ss: 1.114154, loss_d: 0.509944
0.5460 --- loss: 1.426975, loss_ss: 1.322471, loss_d: 0.104504
0.6240 --- loss: 1.225161, loss_ss: 1.009968, loss_d: 0.215193
0.7020 --- loss: 1.342349, loss_ss: 1.102533, loss_d: 0.239816
0.7800 --- loss: 1.702378, loss_ss: 1.300836, loss_d: 0.401542
0.8580 --- loss: 1.505557, loss_ss: 1.107463, loss_d: 0.398094
0.9360 --- loss: 1.158204, loss_ss: 0.948182, loss_d: 0.210022
Epoch finished! Loss: 1.4896094789728522
Starting epoch 4/10.
0.0000 --- loss: 1.371172, loss_ss: 1.125122, loss_d: 0.246050
0.0780 --- loss: 1.362773, loss_ss: 1.058594, loss_d: 0.304179
0.1560 --- loss: 1.152245, loss_ss: 1.085541, loss_d: 0.066704
0.2340 --- loss: 1.087086, loss_ss: 1.028877, loss_d: 0.058209
0.3120 --- loss: 1.291025, loss_ss: 1.061517, loss_d: 0.229508
0.3900 --- loss: 1.496683, loss_ss: 0.979186, loss_d: 0.517497
0.4680 --- loss: 1.227533, loss_ss: 1.180427, loss_d: 0.047106
0.5460 --- loss: 1.644331, loss_ss: 1.087612, loss_d: 0.556719
0.6240 --- loss: 1.363928, loss_ss: 0.970076, loss_d: 0.393852
0.7020 --- loss: 1.104018, loss_ss: 0.988837, loss_d: 0.115182
0.7800 --- loss: 1.410969, loss_ss: 1.091412, loss_d: 0.319557
0.8580 --- loss: 1.253935, loss_ss: 1.058696, loss_d: 0.195239
0.9360 --- loss: 1.223809, loss_ss: 1.152893, loss_d: 0.070916
Epoch finished! Loss: 1.291135692037642
Starting epoch 5/10.
0.0000 --- loss: 0.979781, loss_ss: 0.880654, loss_d: 0.099127
0.0780 --- loss: 1.239285, loss_ss: 0.926931, loss_d: 0.312354
0.1560 --- loss: 1.091677, loss_ss: 1.059085, loss_d: 0.032592
0.2340 --- loss: 1.165676, loss_ss: 1.046040, loss_d: 0.119636
0.3120 --- loss: 1.201754, loss_ss: 1.159492, loss_d: 0.042262
0.3900 --- loss: 1.125852, loss_ss: 0.921914, loss_d: 0.203938
0.4680 --- loss: 1.521488, loss_ss: 0.961776, loss_d: 0.559712
0.5460 --- loss: 0.919102, loss_ss: 0.848403, loss_d: 0.070700
0.6240 --- loss: 1.124849, loss_ss: 0.985985, loss_d: 0.138863
0.7020 --- loss: 0.944937, loss_ss: 0.921341, loss_d: 0.023596
0.7800 --- loss: 1.050889, loss_ss: 0.994809, loss_d: 0.056080
0.8580 --- loss: 1.148777, loss_ss: 0.919622, loss_d: 0.229155
0.9360 --- loss: 1.062580, loss_ss: 1.052332, loss_d: 0.010248
Epoch finished! Loss: 1.1642308598384261
Starting epoch 6/10.
0.0000 --- loss: 1.100462, loss_ss: 1.081972, loss_d: 0.018490
0.0780 --- loss: 0.924036, loss_ss: 0.871136, loss_d: 0.052900
0.1560 --- loss: 0.947917, loss_ss: 0.913702, loss_d: 0.034215
0.2340 --- loss: 1.095670, loss_ss: 1.023062, loss_d: 0.072608
0.3120 --- loss: 1.088886, loss_ss: 1.073267, loss_d: 0.015619
0.3900 --- loss: 0.854187, loss_ss: 0.816615, loss_d: 0.037572
0.4680 --- loss: 1.113492, loss_ss: 1.089015, loss_d: 0.024477
0.5460 --- loss: 1.552180, loss_ss: 1.005423, loss_d: 0.546757
0.6240 --- loss: 0.899958, loss_ss: 0.886536, loss_d: 0.013421
0.7020 --- loss: 0.792458, loss_ss: 0.774704, loss_d: 0.017754
0.7800 --- loss: 1.263543, loss_ss: 0.797841, loss_d: 0.465702
0.8580 --- loss: 1.136261, loss_ss: 0.996062, loss_d: 0.140200
0.9360 --- loss: 0.929757, loss_ss: 0.890951, loss_d: 0.038806
Epoch finished! Loss: 1.0854588416405022
Starting epoch 7/10.
0.0000 --- loss: 1.218045, loss_ss: 1.105444, loss_d: 0.112601
0.0780 --- loss: 0.907646, loss_ss: 0.858241, loss_d: 0.049405
0.1560 --- loss: 1.142817, loss_ss: 0.877400, loss_d: 0.265418
0.2340 --- loss: 0.923201, loss_ss: 0.913763, loss_d: 0.009438
0.3120 --- loss: 0.870371, loss_ss: 0.855308, loss_d: 0.015063
0.3900 --- loss: 0.892000, loss_ss: 0.807335, loss_d: 0.084665
0.4680 --- loss: 1.296516, loss_ss: 1.228230, loss_d: 0.068286
0.5460 --- loss: 1.084291, loss_ss: 0.974764, loss_d: 0.109527
0.6240 --- loss: 1.232318, loss_ss: 1.215419, loss_d: 0.016899
0.7020 --- loss: 1.003140, loss_ss: 0.981045, loss_d: 0.022094
0.7800 --- loss: 0.908307, loss_ss: 0.860907, loss_d: 0.047399
0.8580 --- loss: 0.783692, loss_ss: 0.754675, loss_d: 0.029018
0.9360 --- loss: 0.944025, loss_ss: 0.833284, loss_d: 0.110741
Epoch finished! Loss: 1.0728762093931437
Starting epoch 8/10.
0.0000 --- loss: 0.740603, loss_ss: 0.722518, loss_d: 0.018084
0.0780 --- loss: 1.353470, loss_ss: 0.846312, loss_d: 0.507158
0.1560 --- loss: 0.932488, loss_ss: 0.841142, loss_d: 0.091346
0.2340 --- loss: 1.036653, loss_ss: 0.952453, loss_d: 0.084200
0.3120 --- loss: 0.968103, loss_ss: 0.785358, loss_d: 0.182745
0.3900 --- loss: 1.039867, loss_ss: 0.931634, loss_d: 0.108233
0.4680 --- loss: 1.028450, loss_ss: 1.018667, loss_d: 0.009783
0.5460 --- loss: 1.220564, loss_ss: 1.147357, loss_d: 0.073207
0.6240 --- loss: 0.904749, loss_ss: 0.888903, loss_d: 0.015846
0.7020 --- loss: 0.714973, loss_ss: 0.710415, loss_d: 0.004558
0.7800 --- loss: 1.012904, loss_ss: 0.988819, loss_d: 0.024084
0.8580 --- loss: 0.883494, loss_ss: 0.824081, loss_d: 0.059413
0.9360 --- loss: 0.961816, loss_ss: 0.957960, loss_d: 0.003856
Epoch finished! Loss: 0.9969695108011365
Starting epoch 9/10.
0.0000 --- loss: 1.136465, loss_ss: 1.134080, loss_d: 0.002386
0.0780 --- loss: 0.866698, loss_ss: 0.858075, loss_d: 0.008623
0.1560 --- loss: 0.768388, loss_ss: 0.765032, loss_d: 0.003356
0.2340 --- loss: 0.880597, loss_ss: 0.879701, loss_d: 0.000896
0.3120 --- loss: 0.778922, loss_ss: 0.740160, loss_d: 0.038762
0.3900 --- loss: 0.804542, loss_ss: 0.799423, loss_d: 0.005119
0.4680 --- loss: 0.911693, loss_ss: 0.909313, loss_d: 0.002379
0.5460 --- loss: 0.952302, loss_ss: 0.936731, loss_d: 0.015571
0.6240 --- loss: 0.886616, loss_ss: 0.834449, loss_d: 0.052167
0.7020 --- loss: 0.912586, loss_ss: 0.881746, loss_d: 0.030840
0.7800 --- loss: 0.939660, loss_ss: 0.917072, loss_d: 0.022588
0.8580 --- loss: 0.892165, loss_ss: 0.780981, loss_d: 0.111183
0.9360 --- loss: 0.820126, loss_ss: 0.814419, loss_d: 0.005707
Epoch finished! Loss: 0.9285483243875206
Starting epoch 10/10.
0.0000 --- loss: 0.717453, loss_ss: 0.636483, loss_d: 0.080970
0.0780 --- loss: 0.936079, loss_ss: 0.933989, loss_d: 0.002090
0.1560 --- loss: 0.819873, loss_ss: 0.818183, loss_d: 0.001690
0.2340 --- loss: 0.862527, loss_ss: 0.860773, loss_d: 0.001754
0.3120 --- loss: 0.992392, loss_ss: 0.845416, loss_d: 0.146976
0.3900 --- loss: 0.891715, loss_ss: 0.877864, loss_d: 0.013852
0.4680 --- loss: 0.750028, loss_ss: 0.709086, loss_d: 0.040942
0.5460 --- loss: 0.927191, loss_ss: 0.920331, loss_d: 0.006860
0.6240 --- loss: 0.811393, loss_ss: 0.644283, loss_d: 0.167110
0.7020 --- loss: 0.876652, loss_ss: 0.873245, loss_d: 0.003407
0.7800 --- loss: 0.762087, loss_ss: 0.736832, loss_d: 0.025255
0.8580 --- loss: 0.874024, loss_ss: 0.872485, loss_d: 0.001539
0.9360 --- loss: 1.048104, loss_ss: 1.036003, loss_d: 0.012101
Epoch finished! Loss: 0.9644982148893178
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5046296296296297
             precision    recall  f1-score   support

        0.0       0.22      0.68      0.33       108
        1.0       0.60      0.26      0.36       387
        2.0       0.71      0.53      0.61       360
        3.0       0.99      0.83      0.90        95
        4.0       0.43      0.78      0.55       130

avg / total       0.61      0.50      0.51      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  73.15  67.59   73.77  22.26     33.49
1  67.31  26.10   90.33  60.12     36.40
2  77.22  53.06   89.31  71.27     60.83
3  98.43  83.16   99.90  98.75     90.29
4  84.81  77.69   85.79  42.80     55.19
Total accuracy: 50.46%
Average sen: 61.52%
Average spec: 87.82%
Macro f1-score: 55.24%
Diagnosis acc on 30mins: 1.0
[0.99288404 0.99999952 0.9992848  0.99917656 0.99999964 0.99999988
 0.99999976 0.9999975  0.99999821 0.9999851  0.99999869 0.99999988
 0.99999487 0.99904889 0.99998593 0.99997461 0.99213165 0.98449218]
pred: 0.998163984881507, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp049-nsrr

=== Test on chp051-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.523139, loss_ss: 1.815124, loss_d: 0.708015
0.0780 --- loss: 2.447092, loss_ss: 1.602020, loss_d: 0.845072
0.1560 --- loss: 1.917378, loss_ss: 1.574896, loss_d: 0.342482
0.2340 --- loss: 1.698004, loss_ss: 1.465825, loss_d: 0.232179
0.3120 --- loss: 1.924696, loss_ss: 1.482833, loss_d: 0.441863
0.3900 --- loss: 2.129504, loss_ss: 1.467971, loss_d: 0.661533
0.4680 --- loss: 1.863226, loss_ss: 1.313198, loss_d: 0.550028
0.5460 --- loss: 1.880328, loss_ss: 1.428334, loss_d: 0.451994
0.6240 --- loss: 1.838493, loss_ss: 1.325321, loss_d: 0.513172
0.7020 --- loss: 1.904655, loss_ss: 1.374090, loss_d: 0.530564
0.7800 --- loss: 1.776036, loss_ss: 1.354600, loss_d: 0.421436
0.8580 --- loss: 1.696289, loss_ss: 1.371202, loss_d: 0.325086
0.9360 --- loss: 1.718060, loss_ss: 1.336555, loss_d: 0.381506
Epoch finished! Loss: 2.0520446114242077
Starting epoch 2/10.
0.0000 --- loss: 1.659142, loss_ss: 1.307706, loss_d: 0.351435
0.0780 --- loss: 1.829394, loss_ss: 1.392565, loss_d: 0.436829
0.1560 --- loss: 1.693462, loss_ss: 1.200523, loss_d: 0.492939
0.2340 --- loss: 1.588283, loss_ss: 1.334631, loss_d: 0.253652
0.3120 --- loss: 1.713586, loss_ss: 1.142352, loss_d: 0.571234
0.3900 --- loss: 1.929059, loss_ss: 1.277254, loss_d: 0.651804
0.4680 --- loss: 1.857970, loss_ss: 1.376884, loss_d: 0.481087
0.5460 --- loss: 1.703443, loss_ss: 1.139123, loss_d: 0.564320
0.6240 --- loss: 1.468700, loss_ss: 1.253170, loss_d: 0.215529
0.7020 --- loss: 1.620179, loss_ss: 1.077559, loss_d: 0.542620
0.7800 --- loss: 1.598128, loss_ss: 1.225144, loss_d: 0.372983
0.8580 --- loss: 2.013387, loss_ss: 1.062020, loss_d: 0.951367
0.9360 --- loss: 1.730746, loss_ss: 1.107450, loss_d: 0.623295
Epoch finished! Loss: 1.6630445644259453
Starting epoch 3/10.
0.0000 --- loss: 1.297314, loss_ss: 1.028082, loss_d: 0.269232
0.0780 --- loss: 1.342772, loss_ss: 1.043557, loss_d: 0.299215
0.1560 --- loss: 1.399096, loss_ss: 1.091423, loss_d: 0.307673
0.2340 --- loss: 1.596464, loss_ss: 1.264287, loss_d: 0.332176
0.3120 --- loss: 1.646232, loss_ss: 1.040878, loss_d: 0.605354
0.3900 --- loss: 1.322793, loss_ss: 1.055824, loss_d: 0.266969
0.4680 --- loss: 1.122954, loss_ss: 1.030625, loss_d: 0.092329
0.5460 --- loss: 1.504294, loss_ss: 1.071592, loss_d: 0.432702
0.6240 --- loss: 1.070755, loss_ss: 0.962343, loss_d: 0.108412
0.7020 --- loss: 1.028067, loss_ss: 0.932326, loss_d: 0.095740
0.7800 --- loss: 1.502747, loss_ss: 1.006758, loss_d: 0.495988
0.8580 --- loss: 1.325418, loss_ss: 1.194075, loss_d: 0.131343
0.9360 --- loss: 1.694851, loss_ss: 1.459988, loss_d: 0.234863
Epoch finished! Loss: 1.4212639639154077
Starting epoch 4/10.
0.0000 --- loss: 1.368580, loss_ss: 1.197836, loss_d: 0.170745
0.0780 --- loss: 1.785546, loss_ss: 1.111022, loss_d: 0.674524
0.1560 --- loss: 1.073067, loss_ss: 0.934445, loss_d: 0.138621
0.2340 --- loss: 1.077395, loss_ss: 0.998908, loss_d: 0.078486
0.3120 --- loss: 1.114034, loss_ss: 0.988800, loss_d: 0.125234
0.3900 --- loss: 1.466756, loss_ss: 1.005954, loss_d: 0.460802
0.4680 --- loss: 1.279005, loss_ss: 0.953521, loss_d: 0.325484
0.5460 --- loss: 1.170069, loss_ss: 1.006688, loss_d: 0.163380
0.6240 --- loss: 1.392131, loss_ss: 0.830134, loss_d: 0.561997
0.7020 --- loss: 1.205341, loss_ss: 0.848035, loss_d: 0.357306
0.7800 --- loss: 0.954490, loss_ss: 0.799048, loss_d: 0.155443
0.8580 --- loss: 1.092610, loss_ss: 0.968692, loss_d: 0.123919
0.9360 --- loss: 1.078577, loss_ss: 0.969603, loss_d: 0.108973
Epoch finished! Loss: 1.2846495569683611
Starting epoch 5/10.
0.0000 --- loss: 0.966357, loss_ss: 0.887231, loss_d: 0.079126
0.0780 --- loss: 1.309300, loss_ss: 1.011057, loss_d: 0.298242
0.1560 --- loss: 1.136031, loss_ss: 0.780686, loss_d: 0.355346
0.2340 --- loss: 1.111244, loss_ss: 1.080726, loss_d: 0.030518
0.3120 --- loss: 2.365638, loss_ss: 1.017278, loss_d: 1.348359
0.3900 --- loss: 1.283670, loss_ss: 0.970233, loss_d: 0.313437
0.4680 --- loss: 1.107390, loss_ss: 0.833913, loss_d: 0.273477
0.5460 --- loss: 1.071762, loss_ss: 1.002488, loss_d: 0.069273
0.6240 --- loss: 1.160286, loss_ss: 1.013779, loss_d: 0.146507
0.7020 --- loss: 0.992165, loss_ss: 0.824654, loss_d: 0.167511
0.7800 --- loss: 1.379228, loss_ss: 0.894984, loss_d: 0.484244
0.8580 --- loss: 1.183997, loss_ss: 0.871925, loss_d: 0.312072
0.9360 --- loss: 1.562975, loss_ss: 1.188119, loss_d: 0.374856
Epoch finished! Loss: 1.2128167818300426
Starting epoch 6/10.
0.0000 --- loss: 1.251767, loss_ss: 0.947238, loss_d: 0.304529
0.0780 --- loss: 1.019768, loss_ss: 0.823964, loss_d: 0.195804
0.1560 --- loss: 0.921838, loss_ss: 0.877436, loss_d: 0.044402
0.2340 --- loss: 1.174233, loss_ss: 1.149457, loss_d: 0.024777
0.3120 --- loss: 1.004612, loss_ss: 0.951961, loss_d: 0.052650
0.3900 --- loss: 1.189342, loss_ss: 1.022206, loss_d: 0.167136
0.4680 --- loss: 1.209600, loss_ss: 0.860769, loss_d: 0.348831
0.5460 --- loss: 1.435243, loss_ss: 0.943537, loss_d: 0.491706
0.6240 --- loss: 0.975360, loss_ss: 0.946581, loss_d: 0.028779
0.7020 --- loss: 1.457875, loss_ss: 1.006724, loss_d: 0.451151
0.7800 --- loss: 1.140437, loss_ss: 0.937099, loss_d: 0.203338
0.8580 --- loss: 1.217263, loss_ss: 1.035346, loss_d: 0.181917
0.9360 --- loss: 0.937728, loss_ss: 0.870039, loss_d: 0.067690
Epoch finished! Loss: 1.105227641761303
Starting epoch 7/10.
0.0000 --- loss: 1.022678, loss_ss: 0.880466, loss_d: 0.142212
0.0780 --- loss: 1.744601, loss_ss: 0.944554, loss_d: 0.800046
0.1560 --- loss: 0.930861, loss_ss: 0.864645, loss_d: 0.066216
0.2340 --- loss: 0.991609, loss_ss: 0.927399, loss_d: 0.064210
0.3120 --- loss: 1.004594, loss_ss: 0.850231, loss_d: 0.154363
0.3900 --- loss: 0.811975, loss_ss: 0.783524, loss_d: 0.028451
0.4680 --- loss: 0.974656, loss_ss: 0.871734, loss_d: 0.102921
0.5460 --- loss: 1.101820, loss_ss: 0.774787, loss_d: 0.327033
0.6240 --- loss: 1.044019, loss_ss: 1.024747, loss_d: 0.019271
0.7020 --- loss: 1.002573, loss_ss: 0.972399, loss_d: 0.030174
0.7800 --- loss: 0.992853, loss_ss: 0.811992, loss_d: 0.180861
0.8580 --- loss: 1.011512, loss_ss: 0.997565, loss_d: 0.013947
0.9360 --- loss: 1.319719, loss_ss: 1.109318, loss_d: 0.210400
Epoch finished! Loss: 1.0134421554394066
Starting epoch 8/10.
0.0000 --- loss: 0.895510, loss_ss: 0.882524, loss_d: 0.012986
0.0780 --- loss: 0.857894, loss_ss: 0.832029, loss_d: 0.025866
0.1560 --- loss: 0.934382, loss_ss: 0.872870, loss_d: 0.061512
0.2340 --- loss: 1.092233, loss_ss: 1.058716, loss_d: 0.033517
0.3120 --- loss: 0.969730, loss_ss: 0.836362, loss_d: 0.133367
0.3900 --- loss: 1.060295, loss_ss: 1.024399, loss_d: 0.035896
0.4680 --- loss: 0.811219, loss_ss: 0.800142, loss_d: 0.011077
0.5460 --- loss: 0.993286, loss_ss: 0.946192, loss_d: 0.047094
0.6240 --- loss: 1.200179, loss_ss: 0.903297, loss_d: 0.296882
0.7020 --- loss: 0.820201, loss_ss: 0.806325, loss_d: 0.013876
0.7800 --- loss: 0.708275, loss_ss: 0.701412, loss_d: 0.006863
0.8580 --- loss: 1.816106, loss_ss: 0.792854, loss_d: 1.023252
0.9360 --- loss: 0.828098, loss_ss: 0.730705, loss_d: 0.097393
Epoch finished! Loss: 0.9985001757740974
Starting epoch 9/10.
0.0000 --- loss: 0.924746, loss_ss: 0.689871, loss_d: 0.234875
0.0780 --- loss: 1.273147, loss_ss: 0.938560, loss_d: 0.334587
0.1560 --- loss: 1.142756, loss_ss: 1.127198, loss_d: 0.015559
0.2340 --- loss: 1.068125, loss_ss: 1.006675, loss_d: 0.061450
0.3120 --- loss: 0.819747, loss_ss: 0.810714, loss_d: 0.009033
0.3900 --- loss: 0.822773, loss_ss: 0.804055, loss_d: 0.018718
0.4680 --- loss: 0.822378, loss_ss: 0.781161, loss_d: 0.041217
0.5460 --- loss: 0.822225, loss_ss: 0.732530, loss_d: 0.089696
0.6240 --- loss: 0.963763, loss_ss: 0.886870, loss_d: 0.076893
0.7020 --- loss: 0.933284, loss_ss: 0.911464, loss_d: 0.021821
0.7800 --- loss: 0.865072, loss_ss: 0.846436, loss_d: 0.018635
0.8580 --- loss: 0.677891, loss_ss: 0.647178, loss_d: 0.030714
0.9360 --- loss: 0.729859, loss_ss: 0.713070, loss_d: 0.016789
Epoch finished! Loss: 0.9703825237229466
Starting epoch 10/10.
0.0000 --- loss: 1.186969, loss_ss: 1.183398, loss_d: 0.003571
0.0780 --- loss: 0.872140, loss_ss: 0.690668, loss_d: 0.181472
0.1560 --- loss: 0.903604, loss_ss: 0.902509, loss_d: 0.001094
0.2340 --- loss: 0.878828, loss_ss: 0.865112, loss_d: 0.013716
0.3120 --- loss: 0.914837, loss_ss: 0.893600, loss_d: 0.021237
0.3900 --- loss: 0.797928, loss_ss: 0.793507, loss_d: 0.004421
0.4680 --- loss: 0.727426, loss_ss: 0.726150, loss_d: 0.001276
0.5460 --- loss: 1.007819, loss_ss: 1.006065, loss_d: 0.001754
0.6240 --- loss: 0.935314, loss_ss: 0.902263, loss_d: 0.033051
0.7020 --- loss: 0.881527, loss_ss: 0.866760, loss_d: 0.014767
0.7800 --- loss: 0.875973, loss_ss: 0.858576, loss_d: 0.017397
0.8580 --- loss: 0.921537, loss_ss: 0.724305, loss_d: 0.197232
0.9360 --- loss: 0.809132, loss_ss: 0.802594, loss_d: 0.006538
Epoch finished! Loss: 0.9214511476457119
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6398148148148148
             precision    recall  f1-score   support

        0.0       0.21      0.90      0.34        30
        1.0       0.25      0.21      0.23       136
        2.0       0.71      0.61      0.66       404
        3.0       0.96      0.70      0.81       239
        4.0       0.69      0.81      0.75       271

avg / total       0.69      0.64      0.65      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.28  90.00   90.29  20.93     33.96
1  82.41  20.59   91.31  25.45     22.76
2  76.20  61.39   85.06  71.06     65.87
3  92.78  70.29   99.17  96.00     81.16
4  86.30  81.18   88.01  69.40     74.83
Total accuracy: 63.98%
Average sen: 64.69%
Average spec: 90.77%
Macro f1-score: 55.72%
Diagnosis acc on 30mins: 1.0
[0.99996996 0.99983001 0.99999797 0.99999547 0.99998558 0.99999642
 0.99908829 0.99999845 0.99999261 0.99999869 0.99995077 0.99989641
 0.99997056 0.99999917 0.99999118 0.99987483 0.99995077 0.99987185]
pred: 0.9999088313844469, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp051-nsrr

=== Test on chp052-nsrr. train_data(1284), test_data(16) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.373595, loss_ss: 1.654802, loss_d: 0.718793
0.0779 --- loss: 1.999200, loss_ss: 1.463446, loss_d: 0.535754
0.1558 --- loss: 2.062965, loss_ss: 1.435947, loss_d: 0.627017
0.2336 --- loss: 1.831953, loss_ss: 1.381830, loss_d: 0.450123
0.3115 --- loss: 1.948314, loss_ss: 1.365522, loss_d: 0.582792
0.3894 --- loss: 1.744610, loss_ss: 1.292978, loss_d: 0.451632
0.4673 --- loss: 1.656352, loss_ss: 1.248354, loss_d: 0.407998
0.5452 --- loss: 2.003607, loss_ss: 1.327975, loss_d: 0.675632
0.6231 --- loss: 1.680008, loss_ss: 1.277386, loss_d: 0.402622
0.7009 --- loss: 1.824532, loss_ss: 1.339968, loss_d: 0.484565
0.7788 --- loss: 1.486193, loss_ss: 1.255725, loss_d: 0.230468
0.8567 --- loss: 1.962124, loss_ss: 1.370012, loss_d: 0.592112
0.9346 --- loss: 1.503950, loss_ss: 1.156063, loss_d: 0.347887
Epoch finished! Loss: 1.9087669309228659
Starting epoch 2/10.
0.0000 --- loss: 1.757968, loss_ss: 1.254086, loss_d: 0.503882
0.0779 --- loss: 1.943374, loss_ss: 1.174730, loss_d: 0.768645
0.1558 --- loss: 1.292031, loss_ss: 1.132543, loss_d: 0.159488
0.2336 --- loss: 1.484279, loss_ss: 1.186348, loss_d: 0.297932
0.3115 --- loss: 1.533168, loss_ss: 1.163090, loss_d: 0.370078
0.3894 --- loss: 1.747653, loss_ss: 1.165059, loss_d: 0.582594
0.4673 --- loss: 1.968300, loss_ss: 1.184571, loss_d: 0.783729
0.5452 --- loss: 1.521947, loss_ss: 1.377239, loss_d: 0.144709
0.6231 --- loss: 1.608996, loss_ss: 1.153534, loss_d: 0.455462
0.7009 --- loss: 1.653258, loss_ss: 1.220357, loss_d: 0.432901
0.7788 --- loss: 1.245876, loss_ss: 1.046821, loss_d: 0.199055
0.8567 --- loss: 1.364166, loss_ss: 1.077873, loss_d: 0.286293
0.9346 --- loss: 1.619464, loss_ss: 1.127512, loss_d: 0.491951
Epoch finished! Loss: 1.5470409961417317
Starting epoch 3/10.
0.0000 --- loss: 1.311260, loss_ss: 1.117288, loss_d: 0.193972
0.0779 --- loss: 1.198134, loss_ss: 1.035370, loss_d: 0.162765
0.1558 --- loss: 1.329187, loss_ss: 1.064155, loss_d: 0.265032
0.2336 --- loss: 1.135001, loss_ss: 1.009662, loss_d: 0.125339
0.3115 --- loss: 1.111735, loss_ss: 0.934258, loss_d: 0.177476
0.3894 --- loss: 1.817664, loss_ss: 1.018672, loss_d: 0.798992
0.4673 --- loss: 1.514313, loss_ss: 1.082191, loss_d: 0.432122
0.5452 --- loss: 1.313284, loss_ss: 0.930625, loss_d: 0.382658
0.6231 --- loss: 1.180607, loss_ss: 0.943790, loss_d: 0.236817
0.7009 --- loss: 1.211935, loss_ss: 1.021911, loss_d: 0.190025
0.7788 --- loss: 2.001767, loss_ss: 1.038811, loss_d: 0.962956
0.8567 --- loss: 1.236557, loss_ss: 0.913774, loss_d: 0.322783
0.9346 --- loss: 1.265061, loss_ss: 1.120999, loss_d: 0.144062
Epoch finished! Loss: 1.3549998588860035
Starting epoch 4/10.
0.0000 --- loss: 1.066114, loss_ss: 0.890934, loss_d: 0.175180
0.0779 --- loss: 1.210230, loss_ss: 1.036383, loss_d: 0.173847
0.1558 --- loss: 1.168241, loss_ss: 0.927570, loss_d: 0.240671
0.2336 --- loss: 1.331513, loss_ss: 1.004330, loss_d: 0.327183
0.3115 --- loss: 0.982399, loss_ss: 0.811998, loss_d: 0.170401
0.3894 --- loss: 0.963700, loss_ss: 0.898043, loss_d: 0.065657
0.4673 --- loss: 1.070703, loss_ss: 1.029267, loss_d: 0.041435
0.5452 --- loss: 1.288791, loss_ss: 1.048818, loss_d: 0.239973
0.6231 --- loss: 1.070720, loss_ss: 0.944196, loss_d: 0.126524
0.7009 --- loss: 1.149576, loss_ss: 1.127376, loss_d: 0.022200
0.7788 --- loss: 1.291785, loss_ss: 1.178978, loss_d: 0.112807
0.8567 --- loss: 0.961394, loss_ss: 0.864190, loss_d: 0.097205
0.9346 --- loss: 1.240893, loss_ss: 0.981654, loss_d: 0.259239
Epoch finished! Loss: 1.2096138959750533
Starting epoch 5/10.
0.0000 --- loss: 1.017262, loss_ss: 0.848209, loss_d: 0.169054
0.0779 --- loss: 1.271686, loss_ss: 1.010135, loss_d: 0.261551
0.1558 --- loss: 1.208218, loss_ss: 0.923011, loss_d: 0.285207
0.2336 --- loss: 1.267548, loss_ss: 0.985835, loss_d: 0.281713
0.3115 --- loss: 1.354522, loss_ss: 1.006584, loss_d: 0.347937
0.3894 --- loss: 1.051497, loss_ss: 0.894746, loss_d: 0.156751
0.4673 --- loss: 1.254622, loss_ss: 1.174799, loss_d: 0.079823
0.5452 --- loss: 1.011773, loss_ss: 0.974148, loss_d: 0.037624
0.6231 --- loss: 1.081131, loss_ss: 1.047290, loss_d: 0.033841
0.7009 --- loss: 1.156229, loss_ss: 1.090010, loss_d: 0.066219
0.7788 --- loss: 0.929300, loss_ss: 0.799470, loss_d: 0.129830
0.8567 --- loss: 1.031745, loss_ss: 0.886633, loss_d: 0.145111
0.9346 --- loss: 1.001528, loss_ss: 0.924986, loss_d: 0.076542
Epoch finished! Loss: 1.2061807778663933
Starting epoch 6/10.
0.0000 --- loss: 1.261748, loss_ss: 1.198839, loss_d: 0.062909
0.0779 --- loss: 1.123245, loss_ss: 0.882902, loss_d: 0.240343
0.1558 --- loss: 1.029273, loss_ss: 0.933433, loss_d: 0.095840
0.2336 --- loss: 1.085604, loss_ss: 1.058870, loss_d: 0.026733
0.3115 --- loss: 1.007749, loss_ss: 0.954522, loss_d: 0.053227
0.3894 --- loss: 1.229022, loss_ss: 0.968067, loss_d: 0.260955
0.4673 --- loss: 1.133563, loss_ss: 1.042507, loss_d: 0.091056
0.5452 --- loss: 1.026300, loss_ss: 0.997604, loss_d: 0.028697
0.6231 --- loss: 0.946788, loss_ss: 0.929355, loss_d: 0.017433
0.7009 --- loss: 0.982122, loss_ss: 0.950950, loss_d: 0.031171
0.7788 --- loss: 0.873258, loss_ss: 0.864626, loss_d: 0.008632
0.8567 --- loss: 1.087279, loss_ss: 0.967585, loss_d: 0.119694
0.9346 --- loss: 1.281594, loss_ss: 1.261165, loss_d: 0.020429
Epoch finished! Loss: 1.0595764755271375
Starting epoch 7/10.
0.0000 --- loss: 0.876748, loss_ss: 0.857183, loss_d: 0.019565
0.0779 --- loss: 1.080045, loss_ss: 0.920248, loss_d: 0.159796
0.1558 --- loss: 1.148347, loss_ss: 0.989700, loss_d: 0.158647
0.2336 --- loss: 1.003184, loss_ss: 0.933584, loss_d: 0.069600
0.3115 --- loss: 1.118387, loss_ss: 1.043130, loss_d: 0.075258
0.3894 --- loss: 1.255902, loss_ss: 1.032124, loss_d: 0.223778
0.4673 --- loss: 0.923613, loss_ss: 0.885272, loss_d: 0.038341
0.5452 --- loss: 1.407358, loss_ss: 0.953205, loss_d: 0.454153
0.6231 --- loss: 0.957561, loss_ss: 0.900404, loss_d: 0.057157
0.7009 --- loss: 0.889701, loss_ss: 0.847891, loss_d: 0.041810
0.7788 --- loss: 0.912179, loss_ss: 0.781292, loss_d: 0.130888
0.8567 --- loss: 0.953922, loss_ss: 0.849413, loss_d: 0.104508
0.9346 --- loss: 1.101123, loss_ss: 1.065239, loss_d: 0.035884
Epoch finished! Loss: 1.0570574863813818
Starting epoch 8/10.
0.0000 --- loss: 1.036210, loss_ss: 0.975206, loss_d: 0.061004
0.0779 --- loss: 1.250431, loss_ss: 1.196060, loss_d: 0.054371
0.1558 --- loss: 1.225739, loss_ss: 1.222009, loss_d: 0.003730
0.2336 --- loss: 0.889109, loss_ss: 0.833380, loss_d: 0.055729
0.3115 --- loss: 0.894306, loss_ss: 0.846949, loss_d: 0.047356
0.3894 --- loss: 0.962615, loss_ss: 0.940529, loss_d: 0.022086
0.4673 --- loss: 0.999538, loss_ss: 0.834023, loss_d: 0.165516
0.5452 --- loss: 1.115630, loss_ss: 0.901649, loss_d: 0.213981
0.6231 --- loss: 0.955366, loss_ss: 0.950873, loss_d: 0.004493
0.7009 --- loss: 1.443712, loss_ss: 0.800174, loss_d: 0.643537
0.7788 --- loss: 0.809830, loss_ss: 0.796824, loss_d: 0.013006
0.8567 --- loss: 0.989928, loss_ss: 0.972142, loss_d: 0.017786
0.9346 --- loss: 0.803306, loss_ss: 0.785591, loss_d: 0.017715
Epoch finished! Loss: 0.9768780330196023
Starting epoch 9/10.
0.0000 --- loss: 1.024883, loss_ss: 0.841146, loss_d: 0.183737
0.0779 --- loss: 0.915782, loss_ss: 0.908031, loss_d: 0.007751
0.1558 --- loss: 0.957483, loss_ss: 0.913592, loss_d: 0.043891
0.2336 --- loss: 0.825482, loss_ss: 0.821116, loss_d: 0.004366
0.3115 --- loss: 0.762272, loss_ss: 0.756018, loss_d: 0.006254
0.3894 --- loss: 0.854669, loss_ss: 0.757932, loss_d: 0.096737
0.4673 --- loss: 1.037783, loss_ss: 1.029118, loss_d: 0.008665
0.5452 --- loss: 0.984356, loss_ss: 0.891160, loss_d: 0.093197
0.6231 --- loss: 0.736819, loss_ss: 0.608373, loss_d: 0.128447
0.7009 --- loss: 0.788963, loss_ss: 0.710707, loss_d: 0.078256
0.7788 --- loss: 1.000222, loss_ss: 0.997916, loss_d: 0.002305
0.8567 --- loss: 1.061272, loss_ss: 0.974622, loss_d: 0.086650
0.9346 --- loss: 0.989683, loss_ss: 0.946462, loss_d: 0.043221
Epoch finished! Loss: 0.9448054987005889
Starting epoch 10/10.
0.0000 --- loss: 0.956102, loss_ss: 0.953008, loss_d: 0.003094
0.0779 --- loss: 0.966161, loss_ss: 0.858658, loss_d: 0.107503
0.1558 --- loss: 0.830183, loss_ss: 0.825521, loss_d: 0.004662
0.2336 --- loss: 0.924199, loss_ss: 0.898039, loss_d: 0.026160
0.3115 --- loss: 0.758552, loss_ss: 0.755540, loss_d: 0.003013
0.3894 --- loss: 1.107768, loss_ss: 1.102055, loss_d: 0.005713
0.4673 --- loss: 0.737904, loss_ss: 0.735680, loss_d: 0.002224
0.5452 --- loss: 0.711281, loss_ss: 0.709744, loss_d: 0.001537
0.6231 --- loss: 0.848622, loss_ss: 0.846750, loss_d: 0.001872
0.7009 --- loss: 0.903820, loss_ss: 0.893138, loss_d: 0.010682
0.7788 --- loss: 0.583336, loss_ss: 0.565549, loss_d: 0.017787
0.8567 --- loss: 0.910272, loss_ss: 0.871050, loss_d: 0.039222
0.9346 --- loss: 1.127770, loss_ss: 1.105678, loss_d: 0.022092
Epoch finished! Loss: 0.8909367728047073
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.7875
             precision    recall  f1-score   support

        0.0       0.91      0.79      0.84       159
        1.0       0.46      0.18      0.26        87
        2.0       0.81      0.92      0.86       439
        3.0       1.00      0.22      0.36        69
        4.0       0.71      0.96      0.82       206

avg / total       0.79      0.79      0.76       960
 


====== chp052-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.21  78.62   98.50   91.24     84.46
1  90.62  18.39   97.82   45.71     26.23
2  86.56  91.80   82.15   81.25     86.20
3  94.38  21.74  100.00  100.00     35.71
4  90.73  95.63   89.39   71.12     81.57
Total accuracy: 78.75%
Average sen: 61.24%
Average spec: 93.57%
Macro f1-score: 62.84%
Diagnosis acc on 30mins: 0.875
[0.99011266 0.99986815 0.99242812 0.51609099 0.99510181 0.99949479
 0.99994564 0.24059537 0.05582073 0.99865568 0.99996006 0.99990654
 0.99864775 0.99998021 0.99865025 0.99500555]
pred: 0.8612665196415037, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp052-nsrr

=== Test on chp053-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.611712, loss_ss: 1.870802, loss_d: 0.740910
0.0780 --- loss: 2.643562, loss_ss: 1.888551, loss_d: 0.755010
0.1560 --- loss: 2.627650, loss_ss: 1.769055, loss_d: 0.858595
0.2340 --- loss: 2.184772, loss_ss: 1.482600, loss_d: 0.702172
0.3120 --- loss: 1.924342, loss_ss: 1.459373, loss_d: 0.464969
0.3900 --- loss: 2.121798, loss_ss: 1.411020, loss_d: 0.710778
0.4680 --- loss: 2.097457, loss_ss: 1.563027, loss_d: 0.534430
0.5460 --- loss: 1.865075, loss_ss: 1.426558, loss_d: 0.438517
0.6240 --- loss: 1.741491, loss_ss: 1.300156, loss_d: 0.441336
0.7020 --- loss: 2.061223, loss_ss: 1.551308, loss_d: 0.509916
0.7800 --- loss: 1.992782, loss_ss: 1.451727, loss_d: 0.541054
0.8580 --- loss: 2.118952, loss_ss: 1.512228, loss_d: 0.606724
0.9360 --- loss: 2.309303, loss_ss: 1.525739, loss_d: 0.783564
Epoch finished! Loss: 2.19130995683372
Starting epoch 2/10.
0.0000 --- loss: 1.996982, loss_ss: 1.513951, loss_d: 0.483031
0.0780 --- loss: 1.787987, loss_ss: 1.392842, loss_d: 0.395145
0.1560 --- loss: 1.936166, loss_ss: 1.308290, loss_d: 0.627876
0.2340 --- loss: 2.004159, loss_ss: 1.501974, loss_d: 0.502185
0.3120 --- loss: 1.848047, loss_ss: 1.468485, loss_d: 0.379562
0.3900 --- loss: 1.567789, loss_ss: 1.220362, loss_d: 0.347427
0.4680 --- loss: 1.680775, loss_ss: 1.310603, loss_d: 0.370172
0.5460 --- loss: 2.116617, loss_ss: 1.452777, loss_d: 0.663840
0.6240 --- loss: 1.650713, loss_ss: 1.120826, loss_d: 0.529887
0.7020 --- loss: 1.737414, loss_ss: 1.325830, loss_d: 0.411584
0.7800 --- loss: 1.723304, loss_ss: 1.351075, loss_d: 0.372229
0.8580 --- loss: 2.157377, loss_ss: 1.373407, loss_d: 0.783971
0.9360 --- loss: 1.821707, loss_ss: 1.164672, loss_d: 0.657035
Epoch finished! Loss: 1.8579838871955872
Starting epoch 3/10.
0.0000 --- loss: 1.501396, loss_ss: 1.223364, loss_d: 0.278032
0.0780 --- loss: 1.416732, loss_ss: 1.165494, loss_d: 0.251238
0.1560 --- loss: 1.561657, loss_ss: 1.175427, loss_d: 0.386230
0.2340 --- loss: 1.512822, loss_ss: 1.356325, loss_d: 0.156497
0.3120 --- loss: 1.599515, loss_ss: 1.231964, loss_d: 0.367551
0.3900 --- loss: 1.562979, loss_ss: 1.206357, loss_d: 0.356622
0.4680 --- loss: 1.356027, loss_ss: 1.177945, loss_d: 0.178083
0.5460 --- loss: 1.326573, loss_ss: 1.253986, loss_d: 0.072587
0.6240 --- loss: 1.516891, loss_ss: 1.228691, loss_d: 0.288200
0.7020 --- loss: 2.034129, loss_ss: 1.327228, loss_d: 0.706902
0.7800 --- loss: 1.245442, loss_ss: 1.157568, loss_d: 0.087874
0.8580 --- loss: 1.403975, loss_ss: 1.257378, loss_d: 0.146597
0.9360 --- loss: 1.359188, loss_ss: 0.980144, loss_d: 0.379045
Epoch finished! Loss: 1.5193271711468697
Starting epoch 4/10.
0.0000 --- loss: 1.365129, loss_ss: 1.009203, loss_d: 0.355926
0.0780 --- loss: 1.199031, loss_ss: 1.081646, loss_d: 0.117385
0.1560 --- loss: 1.368949, loss_ss: 1.152061, loss_d: 0.216889
0.2340 --- loss: 1.165646, loss_ss: 0.957092, loss_d: 0.208554
0.3120 --- loss: 1.462745, loss_ss: 1.178449, loss_d: 0.284296
0.3900 --- loss: 1.199911, loss_ss: 0.928350, loss_d: 0.271561
0.4680 --- loss: 1.506819, loss_ss: 1.108431, loss_d: 0.398388
0.5460 --- loss: 1.383731, loss_ss: 1.082833, loss_d: 0.300898
0.6240 --- loss: 1.261718, loss_ss: 1.184105, loss_d: 0.077613
0.7020 --- loss: 1.422767, loss_ss: 1.035293, loss_d: 0.387475
0.7800 --- loss: 1.133207, loss_ss: 0.960658, loss_d: 0.172549
0.8580 --- loss: 1.707141, loss_ss: 1.335877, loss_d: 0.371264
0.9360 --- loss: 1.371654, loss_ss: 1.050786, loss_d: 0.320868
Epoch finished! Loss: 1.3738775113597512
Starting epoch 5/10.
0.0000 --- loss: 1.062682, loss_ss: 1.008112, loss_d: 0.054569
0.0780 --- loss: 1.147766, loss_ss: 1.057323, loss_d: 0.090443
0.1560 --- loss: 1.062536, loss_ss: 0.889326, loss_d: 0.173209
0.2340 --- loss: 1.030931, loss_ss: 0.984317, loss_d: 0.046614
0.3120 --- loss: 1.161123, loss_ss: 1.082511, loss_d: 0.078612
0.3900 --- loss: 1.191503, loss_ss: 1.071676, loss_d: 0.119826
0.4680 --- loss: 1.008156, loss_ss: 0.982735, loss_d: 0.025421
0.5460 --- loss: 1.355426, loss_ss: 0.911489, loss_d: 0.443937
0.6240 --- loss: 1.206981, loss_ss: 1.108077, loss_d: 0.098904
0.7020 --- loss: 1.204866, loss_ss: 1.084001, loss_d: 0.120865
0.7800 --- loss: 1.371773, loss_ss: 1.074457, loss_d: 0.297316
0.8580 --- loss: 1.168163, loss_ss: 1.062890, loss_d: 0.105272
0.9360 --- loss: 1.036789, loss_ss: 0.991464, loss_d: 0.045326
Epoch finished! Loss: 1.2022290923632681
Starting epoch 6/10.
0.0000 --- loss: 1.171241, loss_ss: 1.007257, loss_d: 0.163984
0.0780 --- loss: 1.070023, loss_ss: 0.828356, loss_d: 0.241668
0.1560 --- loss: 1.069292, loss_ss: 0.943811, loss_d: 0.125481
0.2340 --- loss: 0.949302, loss_ss: 0.918646, loss_d: 0.030656
0.3120 --- loss: 1.076601, loss_ss: 1.019780, loss_d: 0.056821
0.3900 --- loss: 1.344618, loss_ss: 0.943281, loss_d: 0.401337
0.4680 --- loss: 1.151516, loss_ss: 1.092294, loss_d: 0.059222
0.5460 --- loss: 0.839928, loss_ss: 0.777090, loss_d: 0.062837
0.6240 --- loss: 0.878892, loss_ss: 0.855402, loss_d: 0.023490
0.7020 --- loss: 1.582171, loss_ss: 1.456230, loss_d: 0.125941
0.7800 --- loss: 1.298564, loss_ss: 1.068985, loss_d: 0.229580
0.8580 --- loss: 1.112966, loss_ss: 1.041597, loss_d: 0.071369
0.9360 --- loss: 0.913269, loss_ss: 0.798511, loss_d: 0.114757
Epoch finished! Loss: 1.1080752424895763
Starting epoch 7/10.
0.0000 --- loss: 0.875635, loss_ss: 0.812384, loss_d: 0.063251
0.0780 --- loss: 1.218803, loss_ss: 1.093183, loss_d: 0.125620
0.1560 --- loss: 1.108714, loss_ss: 1.059258, loss_d: 0.049456
0.2340 --- loss: 1.339196, loss_ss: 0.960821, loss_d: 0.378375
0.3120 --- loss: 1.049930, loss_ss: 1.034087, loss_d: 0.015843
0.3900 --- loss: 0.964197, loss_ss: 0.934954, loss_d: 0.029243
0.4680 --- loss: 1.074134, loss_ss: 1.060541, loss_d: 0.013593
0.5460 --- loss: 1.225121, loss_ss: 1.157528, loss_d: 0.067593
0.6240 --- loss: 0.884995, loss_ss: 0.803516, loss_d: 0.081478
0.7020 --- loss: 1.147339, loss_ss: 1.097977, loss_d: 0.049362
0.7800 --- loss: 0.981409, loss_ss: 0.935764, loss_d: 0.045645
0.8580 --- loss: 1.029981, loss_ss: 0.841215, loss_d: 0.188766
0.9360 --- loss: 1.113110, loss_ss: 0.903020, loss_d: 0.210090
Epoch finished! Loss: 1.094208036083728
Starting epoch 8/10.
0.0000 --- loss: 0.828925, loss_ss: 0.797831, loss_d: 0.031094
0.0780 --- loss: 1.215659, loss_ss: 1.076667, loss_d: 0.138993
0.1560 --- loss: 1.031209, loss_ss: 0.888733, loss_d: 0.142476
0.2340 --- loss: 0.754774, loss_ss: 0.747844, loss_d: 0.006930
0.3120 --- loss: 0.977443, loss_ss: 0.947965, loss_d: 0.029478
0.3900 --- loss: 0.800708, loss_ss: 0.783044, loss_d: 0.017664
0.4680 --- loss: 0.940577, loss_ss: 0.809988, loss_d: 0.130589
0.5460 --- loss: 1.042649, loss_ss: 1.022821, loss_d: 0.019828
0.6240 --- loss: 0.974220, loss_ss: 0.965366, loss_d: 0.008854
0.7020 --- loss: 1.052563, loss_ss: 1.018546, loss_d: 0.034017
0.7800 --- loss: 1.345924, loss_ss: 1.298330, loss_d: 0.047594
0.8580 --- loss: 0.969305, loss_ss: 0.910262, loss_d: 0.059043
0.9360 --- loss: 0.928399, loss_ss: 0.913454, loss_d: 0.014946
Epoch finished! Loss: 0.9710204522125423
Starting epoch 9/10.
0.0000 --- loss: 1.013925, loss_ss: 1.002380, loss_d: 0.011546
0.0780 --- loss: 0.803669, loss_ss: 0.791322, loss_d: 0.012347
0.1560 --- loss: 0.828842, loss_ss: 0.820325, loss_d: 0.008518
0.2340 --- loss: 0.875143, loss_ss: 0.854663, loss_d: 0.020480
0.3120 --- loss: 0.934817, loss_ss: 0.900226, loss_d: 0.034591
0.3900 --- loss: 1.168472, loss_ss: 1.158897, loss_d: 0.009576
0.4680 --- loss: 1.000073, loss_ss: 0.995027, loss_d: 0.005047
0.5460 --- loss: 0.968819, loss_ss: 0.819906, loss_d: 0.148913
0.6240 --- loss: 1.008987, loss_ss: 0.932211, loss_d: 0.076776
0.7020 --- loss: 1.049528, loss_ss: 0.972036, loss_d: 0.077492
0.7800 --- loss: 0.996410, loss_ss: 0.878437, loss_d: 0.117973
0.8580 --- loss: 0.937454, loss_ss: 0.933465, loss_d: 0.003990
0.9360 --- loss: 0.911743, loss_ss: 0.872982, loss_d: 0.038761
Epoch finished! Loss: 0.9643406132236123
Starting epoch 10/10.
0.0000 --- loss: 0.868324, loss_ss: 0.802658, loss_d: 0.065666
0.0780 --- loss: 0.929429, loss_ss: 0.856799, loss_d: 0.072630
0.1560 --- loss: 0.971152, loss_ss: 0.965550, loss_d: 0.005602
0.2340 --- loss: 1.160346, loss_ss: 1.023875, loss_d: 0.136470
0.3120 --- loss: 1.114985, loss_ss: 0.991784, loss_d: 0.123202
0.3900 --- loss: 0.994545, loss_ss: 0.978701, loss_d: 0.015844
0.4680 --- loss: 1.215372, loss_ss: 1.006801, loss_d: 0.208571
0.5460 --- loss: 0.828168, loss_ss: 0.819322, loss_d: 0.008845
0.6240 --- loss: 1.057875, loss_ss: 1.046536, loss_d: 0.011339
0.7020 --- loss: 0.993119, loss_ss: 0.856310, loss_d: 0.136808
0.7800 --- loss: 0.817769, loss_ss: 0.771410, loss_d: 0.046359
0.8580 --- loss: 0.796867, loss_ss: 0.781349, loss_d: 0.015518
0.9360 --- loss: 0.894740, loss_ss: 0.800822, loss_d: 0.093917
Epoch finished! Loss: 0.9958269628696144
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5638888888888889
             precision    recall  f1-score   support

        0.0       1.00      0.09      0.16       251
        1.0       0.22      0.40      0.29       147
        2.0       0.75      0.75      0.75       305
        3.0       1.00      0.72      0.84       250
        4.0       0.38      0.92      0.54       127

avg / total       0.75      0.56      0.55      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  78.80   8.76  100.00  100.00     16.12
1  72.96  40.14   78.14   22.43     28.78
2  85.93  75.41   90.06   74.92     75.16
3  93.61  72.40  100.00  100.00     83.99
4  81.48  92.13   80.06   38.11     53.92
Total accuracy: 56.39%
Average sen: 57.77%
Average spec: 89.65%
Macro f1-score: 51.59%
Diagnosis acc on 30mins: 0.8333333333333334
[0.99902892 0.100823   0.98067665 0.99980563 0.99887151 0.99975771
 0.99956495 0.99972779 0.18155432 0.87938476 0.83977765 0.03812077
 0.91617978 0.99959391 0.96602762 0.96167529 0.9127475  0.92570436]
pred: 0.8166123386472464, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp053-nsrr

=== Test on chp054-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.439768, loss_ss: 1.727126, loss_d: 0.712642
0.0780 --- loss: 2.546011, loss_ss: 1.476258, loss_d: 1.069753
0.1560 --- loss: 2.016866, loss_ss: 1.456322, loss_d: 0.560544
0.2340 --- loss: 2.005103, loss_ss: 1.366835, loss_d: 0.638268
0.3120 --- loss: 1.944699, loss_ss: 1.401397, loss_d: 0.543301
0.3900 --- loss: 1.897875, loss_ss: 1.333153, loss_d: 0.564722
0.4680 --- loss: 1.920831, loss_ss: 1.361031, loss_d: 0.559799
0.5460 --- loss: 1.897486, loss_ss: 1.331844, loss_d: 0.565641
0.6240 --- loss: 1.751506, loss_ss: 1.235838, loss_d: 0.515669
0.7020 --- loss: 1.916948, loss_ss: 1.231650, loss_d: 0.685298
0.7800 --- loss: 2.089018, loss_ss: 1.363475, loss_d: 0.725544
0.8580 --- loss: 1.621748, loss_ss: 1.231768, loss_d: 0.389980
0.9360 --- loss: 1.370993, loss_ss: 1.148742, loss_d: 0.222252
Epoch finished! Loss: 1.9601777158677578
Starting epoch 2/10.
0.0000 --- loss: 1.493494, loss_ss: 1.147548, loss_d: 0.345946
0.0780 --- loss: 1.339043, loss_ss: 1.163625, loss_d: 0.175418
0.1560 --- loss: 1.689666, loss_ss: 1.208770, loss_d: 0.480895
0.2340 --- loss: 1.611671, loss_ss: 1.289930, loss_d: 0.321741
0.3120 --- loss: 1.746656, loss_ss: 1.262261, loss_d: 0.484395
0.3900 --- loss: 1.918465, loss_ss: 1.175248, loss_d: 0.743216
0.4680 --- loss: 1.853073, loss_ss: 1.232104, loss_d: 0.620969
0.5460 --- loss: 1.637670, loss_ss: 1.183310, loss_d: 0.454359
0.6240 --- loss: 1.464724, loss_ss: 1.153878, loss_d: 0.310846
0.7020 --- loss: 1.431459, loss_ss: 1.201089, loss_d: 0.230370
0.7800 --- loss: 1.607016, loss_ss: 1.086521, loss_d: 0.520495
0.8580 --- loss: 2.086002, loss_ss: 1.155548, loss_d: 0.930453
0.9360 --- loss: 1.243603, loss_ss: 1.112276, loss_d: 0.131327
Epoch finished! Loss: 1.6260088151320815
Starting epoch 3/10.
0.0000 --- loss: 1.271566, loss_ss: 1.163056, loss_d: 0.108510
0.0780 --- loss: 1.622230, loss_ss: 0.989682, loss_d: 0.632548
0.1560 --- loss: 1.711865, loss_ss: 1.194021, loss_d: 0.517845
0.2340 --- loss: 1.307188, loss_ss: 1.080150, loss_d: 0.227038
0.3120 --- loss: 1.600774, loss_ss: 1.359567, loss_d: 0.241208
0.3900 --- loss: 1.499849, loss_ss: 1.180966, loss_d: 0.318883
0.4680 --- loss: 1.555257, loss_ss: 1.035022, loss_d: 0.520235
0.5460 --- loss: 1.438284, loss_ss: 1.003822, loss_d: 0.434461
0.6240 --- loss: 1.175788, loss_ss: 1.041478, loss_d: 0.134310
0.7020 --- loss: 1.231218, loss_ss: 1.156972, loss_d: 0.074246
0.7800 --- loss: 1.431111, loss_ss: 1.099674, loss_d: 0.331437
0.8580 --- loss: 1.380917, loss_ss: 1.130412, loss_d: 0.250505
0.9360 --- loss: 1.386399, loss_ss: 1.153319, loss_d: 0.233080
Epoch finished! Loss: 1.4229492396116257
Starting epoch 4/10.
0.0000 --- loss: 1.380389, loss_ss: 1.138590, loss_d: 0.241799
0.0780 --- loss: 1.276757, loss_ss: 0.953014, loss_d: 0.323742
0.1560 --- loss: 1.243732, loss_ss: 0.979425, loss_d: 0.264307
0.2340 --- loss: 1.073618, loss_ss: 0.912885, loss_d: 0.160733
0.3120 --- loss: 1.089706, loss_ss: 1.006098, loss_d: 0.083608
0.3900 --- loss: 1.311813, loss_ss: 0.960750, loss_d: 0.351063
0.4680 --- loss: 1.007936, loss_ss: 0.942661, loss_d: 0.065275
0.5460 --- loss: 1.318581, loss_ss: 0.891829, loss_d: 0.426753
0.6240 --- loss: 1.356362, loss_ss: 0.916900, loss_d: 0.439462
0.7020 --- loss: 1.329208, loss_ss: 0.986565, loss_d: 0.342643
0.7800 --- loss: 1.071793, loss_ss: 0.819073, loss_d: 0.252720
0.8580 --- loss: 1.217152, loss_ss: 1.144362, loss_d: 0.072790
0.9360 --- loss: 1.020837, loss_ss: 0.958905, loss_d: 0.061932
Epoch finished! Loss: 1.2611568379215896
Starting epoch 5/10.
0.0000 --- loss: 1.134960, loss_ss: 0.998640, loss_d: 0.136321
0.0780 --- loss: 1.338126, loss_ss: 1.033652, loss_d: 0.304474
0.1560 --- loss: 1.303692, loss_ss: 0.968730, loss_d: 0.334963
0.2340 --- loss: 1.808725, loss_ss: 0.908783, loss_d: 0.899942
0.3120 --- loss: 1.296922, loss_ss: 1.085682, loss_d: 0.211240
0.3900 --- loss: 1.071822, loss_ss: 0.972536, loss_d: 0.099285
0.4680 --- loss: 0.899647, loss_ss: 0.874967, loss_d: 0.024680
0.5460 --- loss: 1.244918, loss_ss: 1.070334, loss_d: 0.174584
0.6240 --- loss: 1.301634, loss_ss: 0.933933, loss_d: 0.367701
0.7020 --- loss: 1.370213, loss_ss: 0.990010, loss_d: 0.380203
0.7800 --- loss: 1.050331, loss_ss: 0.992094, loss_d: 0.058237
0.8580 --- loss: 1.096683, loss_ss: 1.021673, loss_d: 0.075010
0.9360 --- loss: 1.011853, loss_ss: 0.990781, loss_d: 0.021072
Epoch finished! Loss: 1.1756546730175614
Starting epoch 6/10.
0.0000 --- loss: 0.898168, loss_ss: 0.729147, loss_d: 0.169020
0.0780 --- loss: 1.128806, loss_ss: 1.084814, loss_d: 0.043992
0.1560 --- loss: 0.911713, loss_ss: 0.852508, loss_d: 0.059205
0.2340 --- loss: 1.088783, loss_ss: 0.861995, loss_d: 0.226788
0.3120 --- loss: 0.896105, loss_ss: 0.837824, loss_d: 0.058281
0.3900 --- loss: 1.104531, loss_ss: 1.088284, loss_d: 0.016247
0.4680 --- loss: 1.548326, loss_ss: 1.211372, loss_d: 0.336953
0.5460 --- loss: 0.891558, loss_ss: 0.781909, loss_d: 0.109649
0.6240 --- loss: 0.842048, loss_ss: 0.744309, loss_d: 0.097740
0.7020 --- loss: 1.187765, loss_ss: 0.985493, loss_d: 0.202272
0.7800 --- loss: 0.869119, loss_ss: 0.846535, loss_d: 0.022584
0.8580 --- loss: 0.991104, loss_ss: 0.943692, loss_d: 0.047411
0.9360 --- loss: 1.438514, loss_ss: 0.874044, loss_d: 0.564470
Epoch finished! Loss: 1.075239792931825
Starting epoch 7/10.
0.0000 --- loss: 1.185408, loss_ss: 0.848394, loss_d: 0.337014
0.0780 --- loss: 0.888657, loss_ss: 0.878969, loss_d: 0.009687
0.1560 --- loss: 0.847299, loss_ss: 0.824746, loss_d: 0.022553
0.2340 --- loss: 0.903597, loss_ss: 0.895239, loss_d: 0.008358
0.3120 --- loss: 0.827262, loss_ss: 0.816841, loss_d: 0.010421
0.3900 --- loss: 0.994521, loss_ss: 0.934972, loss_d: 0.059549
0.4680 --- loss: 0.969014, loss_ss: 0.949865, loss_d: 0.019149
0.5460 --- loss: 1.115374, loss_ss: 1.087630, loss_d: 0.027744
0.6240 --- loss: 0.949807, loss_ss: 0.915093, loss_d: 0.034714
0.7020 --- loss: 1.131520, loss_ss: 1.085121, loss_d: 0.046399
0.7800 --- loss: 1.356662, loss_ss: 0.986233, loss_d: 0.370430
0.8580 --- loss: 1.477149, loss_ss: 1.260420, loss_d: 0.216730
0.9360 --- loss: 1.007402, loss_ss: 0.824660, loss_d: 0.182742
Epoch finished! Loss: 1.0278054429218173
Starting epoch 8/10.
0.0000 --- loss: 0.849398, loss_ss: 0.791358, loss_d: 0.058041
0.0780 --- loss: 0.966933, loss_ss: 0.943725, loss_d: 0.023207
0.1560 --- loss: 0.794617, loss_ss: 0.671729, loss_d: 0.122888
0.2340 --- loss: 0.957987, loss_ss: 0.852909, loss_d: 0.105078
0.3120 --- loss: 0.828432, loss_ss: 0.819046, loss_d: 0.009386
0.3900 --- loss: 0.797980, loss_ss: 0.793386, loss_d: 0.004594
0.4680 --- loss: 0.847187, loss_ss: 0.824338, loss_d: 0.022849
0.5460 --- loss: 1.016343, loss_ss: 1.000278, loss_d: 0.016065
0.6240 --- loss: 0.943746, loss_ss: 0.914708, loss_d: 0.029037
0.7020 --- loss: 1.049022, loss_ss: 0.998402, loss_d: 0.050620
0.7800 --- loss: 0.877116, loss_ss: 0.844392, loss_d: 0.032724
0.8580 --- loss: 0.901441, loss_ss: 0.863116, loss_d: 0.038325
0.9360 --- loss: 0.830007, loss_ss: 0.717228, loss_d: 0.112779
Epoch finished! Loss: 0.9704487766139209
Starting epoch 9/10.
0.0000 --- loss: 0.740300, loss_ss: 0.717526, loss_d: 0.022774
0.0780 --- loss: 1.322023, loss_ss: 1.254633, loss_d: 0.067389
0.1560 --- loss: 1.054026, loss_ss: 0.850950, loss_d: 0.203076
0.2340 --- loss: 0.771984, loss_ss: 0.741964, loss_d: 0.030020
0.3120 --- loss: 0.726974, loss_ss: 0.679914, loss_d: 0.047060
0.3900 --- loss: 0.811198, loss_ss: 0.806454, loss_d: 0.004744
0.4680 --- loss: 0.935369, loss_ss: 0.902857, loss_d: 0.032512
0.5460 --- loss: 0.586245, loss_ss: 0.579378, loss_d: 0.006867
0.6240 --- loss: 0.674085, loss_ss: 0.657713, loss_d: 0.016373
0.7020 --- loss: 0.743361, loss_ss: 0.695424, loss_d: 0.047938
0.7800 --- loss: 0.790911, loss_ss: 0.675742, loss_d: 0.115170
0.8580 --- loss: 0.968290, loss_ss: 0.933718, loss_d: 0.034573
0.9360 --- loss: 0.846621, loss_ss: 0.794314, loss_d: 0.052307
Epoch finished! Loss: 0.9374560150317848
Starting epoch 10/10.
0.0000 --- loss: 1.183716, loss_ss: 0.981387, loss_d: 0.202329
0.0780 --- loss: 0.993685, loss_ss: 0.841657, loss_d: 0.152028
0.1560 --- loss: 0.917912, loss_ss: 0.846814, loss_d: 0.071098
0.2340 --- loss: 0.912733, loss_ss: 0.901242, loss_d: 0.011491
0.3120 --- loss: 0.938126, loss_ss: 0.923856, loss_d: 0.014270
0.3900 --- loss: 0.753978, loss_ss: 0.749472, loss_d: 0.004506
0.4680 --- loss: 1.336910, loss_ss: 1.099181, loss_d: 0.237729
0.5460 --- loss: 0.985666, loss_ss: 0.977452, loss_d: 0.008214
0.6240 --- loss: 0.936730, loss_ss: 0.908802, loss_d: 0.027928
0.7020 --- loss: 1.297499, loss_ss: 0.792322, loss_d: 0.505177
0.7800 --- loss: 1.087541, loss_ss: 0.751985, loss_d: 0.335556
0.8580 --- loss: 0.914699, loss_ss: 0.892398, loss_d: 0.022300
0.9360 --- loss: 0.811687, loss_ss: 0.754972, loss_d: 0.056716
Epoch finished! Loss: 0.9475551811046898
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6620370370370371
             precision    recall  f1-score   support

        0.0       0.80      0.44      0.57       228
        1.0       0.17      0.41      0.24        86
        2.0       0.81      0.83      0.82       451
        3.0       0.98      0.93      0.95        99
        4.0       0.60      0.51      0.55       216

avg / total       0.73      0.66      0.68      1080
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.83  44.30   96.95  79.53     56.90
1  79.26  40.70   82.60  16.83     23.81
2  84.81  83.37   85.85  80.86     82.10
3  99.17  92.93   99.80  97.87     95.34
4  83.33  51.39   91.32  59.68     55.22
Total accuracy: 66.20%
Average sen: 62.54%
Average spec: 91.30%
Macro f1-score: 62.67%
Diagnosis acc on 30mins: 1.0
[0.99984789 0.99990332 0.99998116 0.98776126 0.99916744 0.99950302
 0.99996042 0.99943823 0.99994612 0.99998438 0.99997044 0.99891186
 0.99554682 0.99896967 0.999632   0.99999905 0.99996388 0.99999583]
pred: 0.9988045990467072, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp054-nsrr

=== Test on chp055-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.397865, loss_ss: 1.669619, loss_d: 0.728246
0.0780 --- loss: 2.241942, loss_ss: 1.587972, loss_d: 0.653970
0.1560 --- loss: 2.134285, loss_ss: 1.493841, loss_d: 0.640444
0.2340 --- loss: 1.809651, loss_ss: 1.363726, loss_d: 0.445925
0.3120 --- loss: 1.731298, loss_ss: 1.393054, loss_d: 0.338244
0.3900 --- loss: 2.193019, loss_ss: 1.649158, loss_d: 0.543862
0.4680 --- loss: 1.833019, loss_ss: 1.377285, loss_d: 0.455734
0.5460 --- loss: 2.051432, loss_ss: 1.421296, loss_d: 0.630136
0.6240 --- loss: 1.675704, loss_ss: 1.246192, loss_d: 0.429512
0.7020 --- loss: 1.810113, loss_ss: 1.422227, loss_d: 0.387886
0.7800 --- loss: 1.752607, loss_ss: 1.326740, loss_d: 0.425867
0.8580 --- loss: 1.918795, loss_ss: 1.495053, loss_d: 0.423743
0.9360 --- loss: 1.707550, loss_ss: 1.183151, loss_d: 0.524398
Epoch finished! Loss: 2.0249227583408356
Starting epoch 2/10.
0.0000 --- loss: 2.003351, loss_ss: 1.413449, loss_d: 0.589903
0.0780 --- loss: 1.875151, loss_ss: 1.286143, loss_d: 0.589008
0.1560 --- loss: 1.814599, loss_ss: 1.335026, loss_d: 0.479574
0.2340 --- loss: 1.442156, loss_ss: 1.093986, loss_d: 0.348169
0.3120 --- loss: 1.543673, loss_ss: 1.243574, loss_d: 0.300100
0.3900 --- loss: 1.704609, loss_ss: 1.342437, loss_d: 0.362172
0.4680 --- loss: 1.345560, loss_ss: 1.082387, loss_d: 0.263173
0.5460 --- loss: 1.497813, loss_ss: 1.256692, loss_d: 0.241121
0.6240 --- loss: 1.570437, loss_ss: 1.234637, loss_d: 0.335800
0.7020 --- loss: 1.645125, loss_ss: 1.342260, loss_d: 0.302865
0.7800 --- loss: 1.964258, loss_ss: 1.249180, loss_d: 0.715078
0.8580 --- loss: 1.936112, loss_ss: 1.285931, loss_d: 0.650181
0.9360 --- loss: 1.721362, loss_ss: 1.307993, loss_d: 0.413369
Epoch finished! Loss: 1.6961479410529137
Starting epoch 3/10.
0.0000 --- loss: 1.361959, loss_ss: 1.123156, loss_d: 0.238803
0.0780 --- loss: 1.237102, loss_ss: 1.074936, loss_d: 0.162166
0.1560 --- loss: 1.454336, loss_ss: 1.200280, loss_d: 0.254055
0.2340 --- loss: 1.729305, loss_ss: 1.306939, loss_d: 0.422366
0.3120 --- loss: 1.192245, loss_ss: 1.002201, loss_d: 0.190045
0.3900 --- loss: 1.209670, loss_ss: 1.054901, loss_d: 0.154769
0.4680 --- loss: 1.189055, loss_ss: 0.993357, loss_d: 0.195697
0.5460 --- loss: 1.250991, loss_ss: 1.054140, loss_d: 0.196851
0.6240 --- loss: 1.383364, loss_ss: 0.872276, loss_d: 0.511088
0.7020 --- loss: 1.658043, loss_ss: 1.264884, loss_d: 0.393159
0.7800 --- loss: 0.961145, loss_ss: 0.826007, loss_d: 0.135138
0.8580 --- loss: 1.448886, loss_ss: 0.933517, loss_d: 0.515368
0.9360 --- loss: 1.289130, loss_ss: 1.108379, loss_d: 0.180751
Epoch finished! Loss: 1.440017506480217
Starting epoch 4/10.
0.0000 --- loss: 1.428544, loss_ss: 1.137549, loss_d: 0.290996
0.0780 --- loss: 1.304727, loss_ss: 1.091523, loss_d: 0.213204
0.1560 --- loss: 1.338390, loss_ss: 1.042888, loss_d: 0.295502
0.2340 --- loss: 1.314896, loss_ss: 1.054951, loss_d: 0.259944
0.3120 --- loss: 1.309545, loss_ss: 0.970592, loss_d: 0.338954
0.3900 --- loss: 1.125937, loss_ss: 1.005005, loss_d: 0.120931
0.4680 --- loss: 1.313615, loss_ss: 1.001399, loss_d: 0.312215
0.5460 --- loss: 1.196207, loss_ss: 1.100602, loss_d: 0.095605
0.6240 --- loss: 1.218579, loss_ss: 1.054861, loss_d: 0.163718
0.7020 --- loss: 1.473086, loss_ss: 1.288180, loss_d: 0.184906
0.7800 --- loss: 1.118353, loss_ss: 0.946832, loss_d: 0.171520
0.8580 --- loss: 1.764428, loss_ss: 1.083921, loss_d: 0.680507
0.9360 --- loss: 1.213437, loss_ss: 1.018561, loss_d: 0.194876
Epoch finished! Loss: 1.3249165546149015
Starting epoch 5/10.
0.0000 --- loss: 1.201516, loss_ss: 1.153562, loss_d: 0.047954
0.0780 --- loss: 1.339626, loss_ss: 1.213672, loss_d: 0.125954
0.1560 --- loss: 1.191859, loss_ss: 1.096818, loss_d: 0.095041
0.2340 --- loss: 1.285454, loss_ss: 0.903434, loss_d: 0.382020
0.3120 --- loss: 1.210178, loss_ss: 1.163250, loss_d: 0.046928
0.3900 --- loss: 1.372902, loss_ss: 0.965647, loss_d: 0.407255
0.4680 --- loss: 0.858336, loss_ss: 0.811929, loss_d: 0.046407
0.5460 --- loss: 1.048526, loss_ss: 1.004820, loss_d: 0.043706
0.6240 --- loss: 1.189122, loss_ss: 0.784117, loss_d: 0.405004
0.7020 --- loss: 0.891390, loss_ss: 0.728756, loss_d: 0.162634
0.7800 --- loss: 1.126439, loss_ss: 0.929357, loss_d: 0.197083
0.8580 --- loss: 1.230826, loss_ss: 0.881401, loss_d: 0.349425
0.9360 --- loss: 1.165726, loss_ss: 0.959698, loss_d: 0.206028
Epoch finished! Loss: 1.2144250958226621
Starting epoch 6/10.
0.0000 --- loss: 1.154518, loss_ss: 1.097908, loss_d: 0.056610
0.0780 --- loss: 1.017339, loss_ss: 0.939507, loss_d: 0.077832
0.1560 --- loss: 1.691128, loss_ss: 0.977249, loss_d: 0.713879
0.2340 --- loss: 0.972206, loss_ss: 0.880018, loss_d: 0.092188
0.3120 --- loss: 1.136006, loss_ss: 0.974472, loss_d: 0.161534
0.3900 --- loss: 0.969255, loss_ss: 0.889672, loss_d: 0.079583
0.4680 --- loss: 1.294529, loss_ss: 1.145367, loss_d: 0.149162
0.5460 --- loss: 0.967313, loss_ss: 0.929814, loss_d: 0.037499
0.6240 --- loss: 1.566808, loss_ss: 1.022213, loss_d: 0.544595
0.7020 --- loss: 1.208002, loss_ss: 0.911147, loss_d: 0.296855
0.7800 --- loss: 1.192082, loss_ss: 1.092640, loss_d: 0.099443
0.8580 --- loss: 0.815262, loss_ss: 0.783650, loss_d: 0.031612
0.9360 --- loss: 0.944016, loss_ss: 0.696111, loss_d: 0.247905
Epoch finished! Loss: 1.1156653864309192
Starting epoch 7/10.
0.0000 --- loss: 1.083582, loss_ss: 0.869578, loss_d: 0.214004
0.0780 --- loss: 1.115851, loss_ss: 0.772686, loss_d: 0.343164
0.1560 --- loss: 0.970177, loss_ss: 0.946296, loss_d: 0.023881
0.2340 --- loss: 0.837935, loss_ss: 0.787741, loss_d: 0.050194
0.3120 --- loss: 1.015421, loss_ss: 0.991272, loss_d: 0.024149
0.3900 --- loss: 1.017652, loss_ss: 0.871718, loss_d: 0.145934
0.4680 --- loss: 0.884185, loss_ss: 0.773219, loss_d: 0.110965
0.5460 --- loss: 1.242373, loss_ss: 1.053958, loss_d: 0.188415
0.6240 --- loss: 1.218373, loss_ss: 1.083796, loss_d: 0.134577
0.7020 --- loss: 1.577626, loss_ss: 1.105404, loss_d: 0.472222
0.7800 --- loss: 1.472757, loss_ss: 0.905053, loss_d: 0.567704
0.8580 --- loss: 1.373025, loss_ss: 1.107460, loss_d: 0.265565
0.9360 --- loss: 0.875299, loss_ss: 0.754459, loss_d: 0.120840
Epoch finished! Loss: 1.1084451233036816
Starting epoch 8/10.
0.0000 --- loss: 1.206886, loss_ss: 1.098784, loss_d: 0.108102
0.0780 --- loss: 0.931797, loss_ss: 0.878965, loss_d: 0.052831
0.1560 --- loss: 1.310285, loss_ss: 0.936060, loss_d: 0.374226
0.2340 --- loss: 0.904178, loss_ss: 0.760111, loss_d: 0.144066
0.3120 --- loss: 0.785045, loss_ss: 0.701122, loss_d: 0.083923
0.3900 --- loss: 1.063769, loss_ss: 0.968671, loss_d: 0.095098
0.4680 --- loss: 0.889259, loss_ss: 0.758938, loss_d: 0.130320
0.5460 --- loss: 1.450766, loss_ss: 0.804256, loss_d: 0.646510
0.6240 --- loss: 0.914723, loss_ss: 0.730151, loss_d: 0.184572
0.7020 --- loss: 1.117575, loss_ss: 1.035152, loss_d: 0.082423
0.7800 --- loss: 0.801148, loss_ss: 0.782129, loss_d: 0.019019
0.8580 --- loss: 1.348245, loss_ss: 1.200584, loss_d: 0.147661
0.9360 --- loss: 1.305836, loss_ss: 0.991690, loss_d: 0.314146
Epoch finished! Loss: 1.0222446392290294
Starting epoch 9/10.
0.0000 --- loss: 1.228624, loss_ss: 1.169751, loss_d: 0.058873
0.0780 --- loss: 0.834497, loss_ss: 0.816309, loss_d: 0.018187
0.1560 --- loss: 0.913383, loss_ss: 0.908576, loss_d: 0.004808
0.2340 --- loss: 1.117826, loss_ss: 0.891048, loss_d: 0.226778
0.3120 --- loss: 1.129681, loss_ss: 1.089323, loss_d: 0.040358
0.3900 --- loss: 1.110322, loss_ss: 0.729165, loss_d: 0.381157
0.4680 --- loss: 1.321318, loss_ss: 1.083014, loss_d: 0.238305
0.5460 --- loss: 0.715524, loss_ss: 0.702691, loss_d: 0.012833
0.6240 --- loss: 0.848432, loss_ss: 0.820175, loss_d: 0.028257
0.7020 --- loss: 0.908457, loss_ss: 0.889234, loss_d: 0.019222
0.7800 --- loss: 0.790663, loss_ss: 0.744994, loss_d: 0.045669
0.8580 --- loss: 1.000124, loss_ss: 0.965107, loss_d: 0.035017
0.9360 --- loss: 0.782838, loss_ss: 0.781345, loss_d: 0.001493
Epoch finished! Loss: 0.9358536782674491
Starting epoch 10/10.
0.0000 --- loss: 1.062077, loss_ss: 1.031464, loss_d: 0.030613
0.0780 --- loss: 0.870198, loss_ss: 0.760119, loss_d: 0.110078
0.1560 --- loss: 1.130718, loss_ss: 0.685623, loss_d: 0.445096
0.2340 --- loss: 1.019437, loss_ss: 1.015434, loss_d: 0.004003
0.3120 --- loss: 0.942854, loss_ss: 0.869799, loss_d: 0.073055
0.3900 --- loss: 0.827659, loss_ss: 0.804292, loss_d: 0.023367
0.4680 --- loss: 0.752333, loss_ss: 0.750335, loss_d: 0.001998
0.5460 --- loss: 0.917512, loss_ss: 0.914388, loss_d: 0.003123
0.6240 --- loss: 0.914547, loss_ss: 0.888277, loss_d: 0.026270
0.7020 --- loss: 0.731869, loss_ss: 0.729870, loss_d: 0.001999
0.7800 --- loss: 0.875628, loss_ss: 0.710187, loss_d: 0.165441
0.8580 --- loss: 1.040105, loss_ss: 1.025138, loss_d: 0.014967
0.9360 --- loss: 0.747963, loss_ss: 0.630926, loss_d: 0.117036
Epoch finished! Loss: 0.9297667765058577
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5453703703703704
             precision    recall  f1-score   support

        0.0       1.00      0.25      0.40       211
        1.0       0.52      0.18      0.26       154
        2.0       0.59      0.98      0.74       408
        3.0       1.00      0.05      0.10       130
        4.0       0.35      0.57      0.44       177

avg / total       0.67      0.55      0.48      1080
 


====== chp055-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.37  25.12  100.00  100.00     40.15
1  85.93  17.53   97.30   51.92     26.21
2  73.24  98.28   58.04   58.71     73.51
3  88.61   5.38  100.00  100.00     10.22
4  75.93  57.06   79.62   35.44     43.72
Total accuracy: 54.54%
Average sen: 40.68%
Average spec: 86.99%
Macro f1-score: 38.76%
Diagnosis acc on 30mins: 1.0
[1.         0.99988651 0.99999547 0.99956042 0.99999678 1.
 0.99999893 0.99999237 0.99999881 0.99999905 0.99999928 1.
 0.99985278 0.99994361 0.99998784 1.         0.99999809 0.99988675]
pred: 0.9999498162004683, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp055-nsrr

=== Test on chp056-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.547439, loss_ss: 1.807836, loss_d: 0.739603
0.0780 --- loss: 2.045930, loss_ss: 1.493777, loss_d: 0.552154
0.1560 --- loss: 2.128042, loss_ss: 1.735484, loss_d: 0.392559
0.2340 --- loss: 2.034231, loss_ss: 1.656180, loss_d: 0.378051
0.3120 --- loss: 2.091620, loss_ss: 1.551787, loss_d: 0.539834
0.3900 --- loss: 1.847699, loss_ss: 1.527969, loss_d: 0.319730
0.4680 --- loss: 2.274495, loss_ss: 1.569437, loss_d: 0.705058
0.5460 --- loss: 2.043782, loss_ss: 1.528194, loss_d: 0.515589
0.6240 --- loss: 2.249895, loss_ss: 1.519017, loss_d: 0.730878
0.7020 --- loss: 2.310390, loss_ss: 1.503772, loss_d: 0.806618
0.7800 --- loss: 2.012258, loss_ss: 1.473917, loss_d: 0.538341
0.8580 --- loss: 1.938740, loss_ss: 1.397778, loss_d: 0.540963
0.9360 --- loss: 2.303570, loss_ss: 1.449472, loss_d: 0.854098
Epoch finished! Loss: 2.131299893371761
Starting epoch 2/10.
0.0000 --- loss: 2.151745, loss_ss: 1.404869, loss_d: 0.746876
0.0780 --- loss: 1.938747, loss_ss: 1.334666, loss_d: 0.604081
0.1560 --- loss: 1.802479, loss_ss: 1.358306, loss_d: 0.444174
0.2340 --- loss: 1.668431, loss_ss: 1.212195, loss_d: 0.456236
0.3120 --- loss: 1.939223, loss_ss: 1.307640, loss_d: 0.631582
0.3900 --- loss: 1.806794, loss_ss: 1.336796, loss_d: 0.469997
0.4680 --- loss: 1.481348, loss_ss: 1.228022, loss_d: 0.253326
0.5460 --- loss: 1.579091, loss_ss: 1.229704, loss_d: 0.349388
0.6240 --- loss: 1.475580, loss_ss: 1.152968, loss_d: 0.322612
0.7020 --- loss: 1.604788, loss_ss: 1.210636, loss_d: 0.394152
0.7800 --- loss: 1.542309, loss_ss: 1.154449, loss_d: 0.387860
0.8580 --- loss: 1.400220, loss_ss: 1.172986, loss_d: 0.227234
0.9360 --- loss: 1.826330, loss_ss: 1.111471, loss_d: 0.714859
Epoch finished! Loss: 1.6713061993941665
Starting epoch 3/10.
0.0000 --- loss: 1.526970, loss_ss: 1.109235, loss_d: 0.417735
0.0780 --- loss: 1.234740, loss_ss: 1.092476, loss_d: 0.142265
0.1560 --- loss: 1.192396, loss_ss: 1.061337, loss_d: 0.131059
0.2340 --- loss: 1.255967, loss_ss: 1.014646, loss_d: 0.241322
0.3120 --- loss: 1.302961, loss_ss: 1.140415, loss_d: 0.162545
0.3900 --- loss: 1.615851, loss_ss: 1.268113, loss_d: 0.347738
0.4680 --- loss: 1.171169, loss_ss: 1.066724, loss_d: 0.104446
0.5460 --- loss: 1.189102, loss_ss: 1.023758, loss_d: 0.165344
0.6240 --- loss: 1.360894, loss_ss: 0.937962, loss_d: 0.422933
0.7020 --- loss: 1.236652, loss_ss: 1.055113, loss_d: 0.181539
0.7800 --- loss: 1.176310, loss_ss: 1.005107, loss_d: 0.171202
0.8580 --- loss: 1.193943, loss_ss: 0.974450, loss_d: 0.219493
0.9360 --- loss: 1.042856, loss_ss: 0.979322, loss_d: 0.063533
Epoch finished! Loss: 1.3949843272566795
Starting epoch 4/10.
0.0000 --- loss: 1.311656, loss_ss: 1.059986, loss_d: 0.251671
0.0780 --- loss: 1.063814, loss_ss: 0.975437, loss_d: 0.088377
0.1560 --- loss: 1.189660, loss_ss: 0.849082, loss_d: 0.340578
0.2340 --- loss: 1.256167, loss_ss: 1.074148, loss_d: 0.182019
0.3120 --- loss: 0.983210, loss_ss: 0.930889, loss_d: 0.052321
0.3900 --- loss: 1.260563, loss_ss: 1.111426, loss_d: 0.149136
0.4680 --- loss: 1.285641, loss_ss: 1.030729, loss_d: 0.254912
0.5460 --- loss: 1.138211, loss_ss: 1.109201, loss_d: 0.029010
0.6240 --- loss: 1.227704, loss_ss: 1.026763, loss_d: 0.200940
0.7020 --- loss: 1.165855, loss_ss: 0.925826, loss_d: 0.240029
0.7800 --- loss: 0.841427, loss_ss: 0.776483, loss_d: 0.064944
0.8580 --- loss: 1.455279, loss_ss: 1.282288, loss_d: 0.172990
0.9360 --- loss: 1.181278, loss_ss: 1.025326, loss_d: 0.155952
Epoch finished! Loss: 1.2841871506534517
Starting epoch 5/10.
0.0000 --- loss: 1.493945, loss_ss: 0.882552, loss_d: 0.611393
0.0780 --- loss: 1.196903, loss_ss: 1.027217, loss_d: 0.169686
0.1560 --- loss: 1.170841, loss_ss: 1.027313, loss_d: 0.143528
0.2340 --- loss: 1.398771, loss_ss: 0.955488, loss_d: 0.443283
0.3120 --- loss: 1.205353, loss_ss: 1.019252, loss_d: 0.186101
0.3900 --- loss: 1.232566, loss_ss: 1.029057, loss_d: 0.203508
0.4680 --- loss: 0.867420, loss_ss: 0.843790, loss_d: 0.023629
0.5460 --- loss: 1.137381, loss_ss: 1.008109, loss_d: 0.129272
0.6240 --- loss: 0.967242, loss_ss: 0.917375, loss_d: 0.049867
0.7020 --- loss: 1.131101, loss_ss: 1.027612, loss_d: 0.103489
0.7800 --- loss: 1.008451, loss_ss: 0.994728, loss_d: 0.013723
0.8580 --- loss: 1.326902, loss_ss: 0.869064, loss_d: 0.457838
0.9360 --- loss: 1.074784, loss_ss: 0.921382, loss_d: 0.153402
Epoch finished! Loss: 1.1507044793106616
Starting epoch 6/10.
0.0000 --- loss: 0.959626, loss_ss: 0.813867, loss_d: 0.145759
0.0780 --- loss: 0.892321, loss_ss: 0.848911, loss_d: 0.043410
0.1560 --- loss: 1.324149, loss_ss: 1.087267, loss_d: 0.236882
0.2340 --- loss: 1.094493, loss_ss: 0.842628, loss_d: 0.251865
0.3120 --- loss: 0.816477, loss_ss: 0.755227, loss_d: 0.061251
0.3900 --- loss: 1.033221, loss_ss: 0.955341, loss_d: 0.077880
0.4680 --- loss: 1.054290, loss_ss: 0.721425, loss_d: 0.332865
0.5460 --- loss: 1.039727, loss_ss: 0.986318, loss_d: 0.053409
0.6240 --- loss: 0.887916, loss_ss: 0.828748, loss_d: 0.059168
0.7020 --- loss: 0.910487, loss_ss: 0.902156, loss_d: 0.008331
0.7800 --- loss: 1.612352, loss_ss: 0.990212, loss_d: 0.622140
0.8580 --- loss: 1.008993, loss_ss: 0.980601, loss_d: 0.028392
0.9360 --- loss: 0.999356, loss_ss: 0.852097, loss_d: 0.147259
Epoch finished! Loss: 1.0918217306025326
Starting epoch 7/10.
0.0000 --- loss: 0.927940, loss_ss: 0.913939, loss_d: 0.014001
0.0780 --- loss: 0.847251, loss_ss: 0.820622, loss_d: 0.026629
0.1560 --- loss: 0.928828, loss_ss: 0.781545, loss_d: 0.147283
0.2340 --- loss: 0.898578, loss_ss: 0.865475, loss_d: 0.033103
0.3120 --- loss: 1.018052, loss_ss: 0.993604, loss_d: 0.024448
0.3900 --- loss: 0.872301, loss_ss: 0.814451, loss_d: 0.057851
0.4680 --- loss: 0.815283, loss_ss: 0.811841, loss_d: 0.003442
0.5460 --- loss: 0.795101, loss_ss: 0.769903, loss_d: 0.025198
0.6240 --- loss: 0.883229, loss_ss: 0.722546, loss_d: 0.160683
0.7020 --- loss: 0.713297, loss_ss: 0.620776, loss_d: 0.092520
0.7800 --- loss: 1.037221, loss_ss: 0.915132, loss_d: 0.122089
0.8580 --- loss: 0.833069, loss_ss: 0.816314, loss_d: 0.016755
0.9360 --- loss: 0.790537, loss_ss: 0.787339, loss_d: 0.003198
Epoch finished! Loss: 1.0179397221654654
Starting epoch 8/10.
0.0000 --- loss: 1.045598, loss_ss: 1.035847, loss_d: 0.009751
0.0780 --- loss: 0.812584, loss_ss: 0.804080, loss_d: 0.008504
0.1560 --- loss: 0.851481, loss_ss: 0.827677, loss_d: 0.023803
0.2340 --- loss: 0.854169, loss_ss: 0.849725, loss_d: 0.004445
0.3120 --- loss: 0.968842, loss_ss: 0.923432, loss_d: 0.045410
0.3900 --- loss: 0.804262, loss_ss: 0.799404, loss_d: 0.004857
0.4680 --- loss: 0.982341, loss_ss: 0.976562, loss_d: 0.005779
0.5460 --- loss: 0.778186, loss_ss: 0.737611, loss_d: 0.040575
0.6240 --- loss: 0.902466, loss_ss: 0.879436, loss_d: 0.023030
0.7020 --- loss: 0.915479, loss_ss: 0.895208, loss_d: 0.020271
0.7800 --- loss: 0.915511, loss_ss: 0.873984, loss_d: 0.041527
0.8580 --- loss: 1.173000, loss_ss: 1.172644, loss_d: 0.000356
0.9360 --- loss: 1.111367, loss_ss: 1.110387, loss_d: 0.000980
Epoch finished! Loss: 0.9597549708560109
Starting epoch 9/10.
0.0000 --- loss: 0.800982, loss_ss: 0.794752, loss_d: 0.006230
0.0780 --- loss: 1.123232, loss_ss: 0.749330, loss_d: 0.373902
0.1560 --- loss: 0.776745, loss_ss: 0.766812, loss_d: 0.009933
0.2340 --- loss: 0.812490, loss_ss: 0.783005, loss_d: 0.029485
0.3120 --- loss: 0.836293, loss_ss: 0.760487, loss_d: 0.075806
0.3900 --- loss: 0.967845, loss_ss: 0.810286, loss_d: 0.157560
0.4680 --- loss: 0.980359, loss_ss: 0.856360, loss_d: 0.123998
0.5460 --- loss: 0.888339, loss_ss: 0.880012, loss_d: 0.008327
0.6240 --- loss: 0.823168, loss_ss: 0.784637, loss_d: 0.038531
0.7020 --- loss: 0.694353, loss_ss: 0.642254, loss_d: 0.052099
0.7800 --- loss: 1.028234, loss_ss: 0.954575, loss_d: 0.073659
0.8580 --- loss: 0.919884, loss_ss: 0.912377, loss_d: 0.007507
0.9360 --- loss: 1.059410, loss_ss: 0.867067, loss_d: 0.192344
Epoch finished! Loss: 0.9649313348345459
Starting epoch 10/10.
0.0000 --- loss: 0.933830, loss_ss: 0.932713, loss_d: 0.001118
0.0780 --- loss: 1.091301, loss_ss: 1.057845, loss_d: 0.033456
0.1560 --- loss: 0.819774, loss_ss: 0.789666, loss_d: 0.030108
0.2340 --- loss: 0.852809, loss_ss: 0.834287, loss_d: 0.018522
0.3120 --- loss: 0.880605, loss_ss: 0.771189, loss_d: 0.109416
0.3900 --- loss: 0.953606, loss_ss: 0.911387, loss_d: 0.042219
0.4680 --- loss: 0.817918, loss_ss: 0.710442, loss_d: 0.107476
0.5460 --- loss: 0.719410, loss_ss: 0.717304, loss_d: 0.002106
0.6240 --- loss: 0.880455, loss_ss: 0.877397, loss_d: 0.003058
0.7020 --- loss: 0.843976, loss_ss: 0.742002, loss_d: 0.101974
0.7800 --- loss: 0.749135, loss_ss: 0.708879, loss_d: 0.040255
0.8580 --- loss: 0.927965, loss_ss: 0.910472, loss_d: 0.017493
0.9360 --- loss: 0.815509, loss_ss: 0.809863, loss_d: 0.005646
Epoch finished! Loss: 0.9527906132861972
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6833333333333333
             precision    recall  f1-score   support

        0.0       0.64      0.41      0.50        78
        1.0       0.54      0.35      0.43       284
        2.0       0.84      0.74      0.79       258
        3.0       0.98      0.91      0.95       185
        4.0       0.55      0.89      0.68       275

avg / total       0.70      0.68      0.67      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.07  41.03   98.20  64.00     50.00
1  75.00  35.21   89.20  53.76     42.55
2  90.46  74.42   95.50  83.84     78.85
3  98.24  91.35   99.66  98.26     94.68
4  78.89  89.09   75.40  55.30     68.25
Total accuracy: 68.33%
Average sen: 66.22%
Average spec: 91.59%
Macro f1-score: 66.87%
Diagnosis acc on 30mins: 1.0
[0.9947719  0.99998903 0.99986005 0.99997103 0.99702412 0.99995518
 0.99995363 0.99939001 0.99979585 0.99942845 0.99996555 0.99997211
 0.99999583 0.99999845 0.99995339 0.99993348 0.99998689 0.99999905]
pred: 0.9994413322872586, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp056-nsrr

=== Test on chp057-nsrr. train_data(1281), test_data(19) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.196435, loss_ss: 1.598597, loss_d: 0.597839
0.0781 --- loss: 2.115830, loss_ss: 1.588143, loss_d: 0.527687
0.1561 --- loss: 2.549527, loss_ss: 1.571162, loss_d: 0.978365
0.2342 --- loss: 2.222558, loss_ss: 1.471570, loss_d: 0.750987
0.3123 --- loss: 2.059546, loss_ss: 1.429571, loss_d: 0.629975
0.3903 --- loss: 2.075253, loss_ss: 1.431487, loss_d: 0.643767
0.4684 --- loss: 2.030975, loss_ss: 1.352305, loss_d: 0.678670
0.5464 --- loss: 1.877987, loss_ss: 1.441589, loss_d: 0.436398
0.6245 --- loss: 1.809835, loss_ss: 1.354093, loss_d: 0.455742
0.7026 --- loss: 2.129746, loss_ss: 1.369824, loss_d: 0.759922
0.7806 --- loss: 1.531581, loss_ss: 1.288532, loss_d: 0.243049
0.8587 --- loss: 1.907938, loss_ss: 1.231588, loss_d: 0.676350
0.9368 --- loss: 1.956011, loss_ss: 1.234701, loss_d: 0.721310
Epoch finished! Loss: 2.0243584411218762
Starting epoch 2/10.
0.0000 --- loss: 1.830788, loss_ss: 1.277135, loss_d: 0.553652
0.0781 --- loss: 1.724274, loss_ss: 1.195473, loss_d: 0.528801
0.1561 --- loss: 1.678062, loss_ss: 1.231448, loss_d: 0.446613
0.2342 --- loss: 1.602723, loss_ss: 1.350320, loss_d: 0.252403
0.3123 --- loss: 1.520185, loss_ss: 1.199271, loss_d: 0.320914
0.3903 --- loss: 1.953584, loss_ss: 1.189906, loss_d: 0.763677
0.4684 --- loss: 1.541969, loss_ss: 1.296192, loss_d: 0.245778
0.5464 --- loss: 1.543333, loss_ss: 1.190745, loss_d: 0.352588
0.6245 --- loss: 1.577734, loss_ss: 1.154541, loss_d: 0.423194
0.7026 --- loss: 1.822732, loss_ss: 1.201264, loss_d: 0.621468
0.7806 --- loss: 1.409439, loss_ss: 1.088127, loss_d: 0.321312
0.8587 --- loss: 1.371566, loss_ss: 1.143520, loss_d: 0.228046
0.9368 --- loss: 1.456801, loss_ss: 1.038244, loss_d: 0.418557
Epoch finished! Loss: 1.672244656831026
Starting epoch 3/10.
0.0000 --- loss: 1.667036, loss_ss: 1.264204, loss_d: 0.402832
0.0781 --- loss: 1.771189, loss_ss: 0.980540, loss_d: 0.790649
0.1561 --- loss: 1.378008, loss_ss: 0.958782, loss_d: 0.419226
0.2342 --- loss: 1.309033, loss_ss: 0.953308, loss_d: 0.355725
0.3123 --- loss: 1.218787, loss_ss: 1.016949, loss_d: 0.201838
0.3903 --- loss: 1.661292, loss_ss: 1.110911, loss_d: 0.550381
0.4684 --- loss: 1.533801, loss_ss: 1.037901, loss_d: 0.495900
0.5464 --- loss: 1.858343, loss_ss: 0.994532, loss_d: 0.863811
0.6245 --- loss: 1.481501, loss_ss: 1.207904, loss_d: 0.273597
0.7026 --- loss: 1.243062, loss_ss: 1.074302, loss_d: 0.168761
0.7806 --- loss: 1.230568, loss_ss: 0.845978, loss_d: 0.384591
0.8587 --- loss: 1.208678, loss_ss: 0.895148, loss_d: 0.313530
0.9368 --- loss: 1.275131, loss_ss: 1.103829, loss_d: 0.171302
Epoch finished! Loss: 1.442179444245994
Starting epoch 4/10.
0.0000 --- loss: 1.470104, loss_ss: 1.076731, loss_d: 0.393374
0.0781 --- loss: 0.968214, loss_ss: 0.877121, loss_d: 0.091093
0.1561 --- loss: 1.650117, loss_ss: 0.947909, loss_d: 0.702208
0.2342 --- loss: 1.278972, loss_ss: 0.999866, loss_d: 0.279106
0.3123 --- loss: 1.124330, loss_ss: 1.004283, loss_d: 0.120047
0.3903 --- loss: 1.367551, loss_ss: 1.053607, loss_d: 0.313944
0.4684 --- loss: 1.188185, loss_ss: 0.999253, loss_d: 0.188932
0.5464 --- loss: 0.930163, loss_ss: 0.825950, loss_d: 0.104214
0.6245 --- loss: 1.143535, loss_ss: 0.940883, loss_d: 0.202651
0.7026 --- loss: 0.935667, loss_ss: 0.879642, loss_d: 0.056025
0.7806 --- loss: 1.231944, loss_ss: 1.109402, loss_d: 0.122543
0.8587 --- loss: 1.484975, loss_ss: 1.042187, loss_d: 0.442788
0.9368 --- loss: 1.578153, loss_ss: 1.060050, loss_d: 0.518102
Epoch finished! Loss: 1.2543319365940988
Starting epoch 5/10.
0.0000 --- loss: 1.446473, loss_ss: 0.904226, loss_d: 0.542247
0.0781 --- loss: 1.020217, loss_ss: 0.879290, loss_d: 0.140927
0.1561 --- loss: 1.148646, loss_ss: 0.957608, loss_d: 0.191038
0.2342 --- loss: 1.435673, loss_ss: 1.098789, loss_d: 0.336884
0.3123 --- loss: 0.907057, loss_ss: 0.861325, loss_d: 0.045732
0.3903 --- loss: 1.394794, loss_ss: 1.164726, loss_d: 0.230068
0.4684 --- loss: 1.128081, loss_ss: 0.935448, loss_d: 0.192633
0.5464 --- loss: 0.898073, loss_ss: 0.790266, loss_d: 0.107807
0.6245 --- loss: 0.882139, loss_ss: 0.789886, loss_d: 0.092253
0.7026 --- loss: 1.184039, loss_ss: 1.015403, loss_d: 0.168635
0.7806 --- loss: 1.649577, loss_ss: 0.881350, loss_d: 0.768227
0.8587 --- loss: 0.883935, loss_ss: 0.781133, loss_d: 0.102802
0.9368 --- loss: 2.350982, loss_ss: 0.952925, loss_d: 1.398057
Epoch finished! Loss: 1.1741181700490415
Starting epoch 6/10.
0.0000 --- loss: 1.234473, loss_ss: 0.694061, loss_d: 0.540412
0.0781 --- loss: 1.304214, loss_ss: 0.888785, loss_d: 0.415429
0.1561 --- loss: 1.081250, loss_ss: 0.819224, loss_d: 0.262026
0.2342 --- loss: 0.932284, loss_ss: 0.861411, loss_d: 0.070872
0.3123 --- loss: 1.317109, loss_ss: 1.200444, loss_d: 0.116665
0.3903 --- loss: 0.792334, loss_ss: 0.750088, loss_d: 0.042246
0.4684 --- loss: 1.036313, loss_ss: 0.964657, loss_d: 0.071655
0.5464 --- loss: 1.429116, loss_ss: 1.115366, loss_d: 0.313750
0.6245 --- loss: 1.313692, loss_ss: 0.825200, loss_d: 0.488492
0.7026 --- loss: 0.851158, loss_ss: 0.762677, loss_d: 0.088481
0.7806 --- loss: 1.041325, loss_ss: 0.861011, loss_d: 0.180314
0.8587 --- loss: 1.095292, loss_ss: 0.799245, loss_d: 0.296048
0.9368 --- loss: 1.302470, loss_ss: 0.956714, loss_d: 0.345755
Epoch finished! Loss: 1.0785146923735738
Starting epoch 7/10.
0.0000 --- loss: 1.017227, loss_ss: 0.985905, loss_d: 0.031322
0.0781 --- loss: 1.472858, loss_ss: 1.458196, loss_d: 0.014662
0.1561 --- loss: 1.229354, loss_ss: 1.214585, loss_d: 0.014769
0.2342 --- loss: 1.387095, loss_ss: 0.909893, loss_d: 0.477202
0.3123 --- loss: 0.844620, loss_ss: 0.835028, loss_d: 0.009592
0.3903 --- loss: 1.227579, loss_ss: 0.872092, loss_d: 0.355487
0.4684 --- loss: 1.005033, loss_ss: 0.955683, loss_d: 0.049350
0.5464 --- loss: 0.870105, loss_ss: 0.783357, loss_d: 0.086748
0.6245 --- loss: 0.840023, loss_ss: 0.799224, loss_d: 0.040800
0.7026 --- loss: 1.055904, loss_ss: 0.825133, loss_d: 0.230771
0.7806 --- loss: 1.203101, loss_ss: 0.848405, loss_d: 0.354697
0.8587 --- loss: 0.943917, loss_ss: 0.870743, loss_d: 0.073175
0.9368 --- loss: 1.003718, loss_ss: 0.974438, loss_d: 0.029279
Epoch finished! Loss: 1.03354875696823
Starting epoch 8/10.
0.0000 --- loss: 1.227582, loss_ss: 1.202791, loss_d: 0.024791
0.0781 --- loss: 0.915426, loss_ss: 0.886489, loss_d: 0.028936
0.1561 --- loss: 0.767308, loss_ss: 0.709817, loss_d: 0.057491
0.2342 --- loss: 0.984376, loss_ss: 0.962986, loss_d: 0.021390
0.3123 --- loss: 0.794378, loss_ss: 0.751972, loss_d: 0.042406
0.3903 --- loss: 0.770119, loss_ss: 0.710208, loss_d: 0.059911
0.4684 --- loss: 1.054147, loss_ss: 0.935718, loss_d: 0.118429
0.5464 --- loss: 1.024457, loss_ss: 0.994524, loss_d: 0.029933
0.6245 --- loss: 0.836849, loss_ss: 0.817110, loss_d: 0.019739
0.7026 --- loss: 0.806017, loss_ss: 0.787095, loss_d: 0.018923
0.7806 --- loss: 0.946288, loss_ss: 0.840279, loss_d: 0.106009
0.8587 --- loss: 1.152979, loss_ss: 1.123864, loss_d: 0.029114
0.9368 --- loss: 0.836220, loss_ss: 0.755488, loss_d: 0.080732
Epoch finished! Loss: 1.010602606460452
Starting epoch 9/10.
0.0000 --- loss: 0.863976, loss_ss: 0.844767, loss_d: 0.019209
0.0781 --- loss: 1.055842, loss_ss: 0.862335, loss_d: 0.193507
0.1561 --- loss: 1.246912, loss_ss: 1.229583, loss_d: 0.017330
0.2342 --- loss: 0.882743, loss_ss: 0.790384, loss_d: 0.092359
0.3123 --- loss: 1.217718, loss_ss: 0.822911, loss_d: 0.394807
0.3903 --- loss: 0.973471, loss_ss: 0.868209, loss_d: 0.105262
0.4684 --- loss: 0.933805, loss_ss: 0.793572, loss_d: 0.140233
0.5464 --- loss: 0.824352, loss_ss: 0.706457, loss_d: 0.117895
0.6245 --- loss: 1.007642, loss_ss: 0.978247, loss_d: 0.029395
0.7026 --- loss: 0.987359, loss_ss: 0.971048, loss_d: 0.016311
0.7806 --- loss: 0.805779, loss_ss: 0.802149, loss_d: 0.003629
0.8587 --- loss: 0.864030, loss_ss: 0.849047, loss_d: 0.014982
0.9368 --- loss: 0.986152, loss_ss: 0.871834, loss_d: 0.114318
Epoch finished! Loss: 0.9807315729558468
Starting epoch 10/10.
0.0000 --- loss: 0.761022, loss_ss: 0.749354, loss_d: 0.011667
0.0781 --- loss: 0.815243, loss_ss: 0.805785, loss_d: 0.009458
0.1561 --- loss: 0.753288, loss_ss: 0.736054, loss_d: 0.017234
0.2342 --- loss: 0.836550, loss_ss: 0.808152, loss_d: 0.028398
0.3123 --- loss: 1.022609, loss_ss: 0.925183, loss_d: 0.097426
0.3903 --- loss: 0.935027, loss_ss: 0.891863, loss_d: 0.043164
0.4684 --- loss: 0.799635, loss_ss: 0.759278, loss_d: 0.040357
0.5464 --- loss: 0.955307, loss_ss: 0.946619, loss_d: 0.008689
0.6245 --- loss: 0.668264, loss_ss: 0.661570, loss_d: 0.006694
0.7026 --- loss: 0.644114, loss_ss: 0.639895, loss_d: 0.004218
0.7806 --- loss: 1.126145, loss_ss: 1.018054, loss_d: 0.108092
0.8587 --- loss: 0.796747, loss_ss: 0.782119, loss_d: 0.014628
0.9368 --- loss: 1.020529, loss_ss: 0.785216, loss_d: 0.235313
Epoch finished! Loss: 0.9475146695040166
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6619841966637401
             precision    recall  f1-score   support

        0.0       0.63      0.82      0.71       266
        1.0       0.27      0.07      0.11       152
        2.0       0.79      0.72      0.75       467
        3.0       0.96      0.32      0.48        74
        4.0       0.55      0.93      0.69       180

avg / total       0.65      0.66      0.63      1139
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.37  81.58   85.22  62.72     70.92
1  85.16   6.58   97.26  27.03     10.58
2  80.60  71.95   86.61  78.87     75.25
3  95.52  32.43   99.91  96.00     48.48
4  86.74  92.78   85.61  54.75     68.87
Total accuracy: 66.20%
Average sen: 57.06%
Average spec: 90.92%
Macro f1-score: 54.82%
Diagnosis acc on 30mins: 1.0
[0.99613297 0.99999738 0.99999988 1.         0.99999785 0.99999762
 1.         1.         0.99992061 1.         0.99999964 0.99997735
 0.99996293 0.99999845 0.99998629 0.99999881 0.9999994  0.99999869
 1.        ]
pred: 0.9997877823679071, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp057-nsrr

=== Test on chp058-nsrr. train_data(1283), test_data(17) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.331466, loss_ss: 1.645566, loss_d: 0.685901
0.0779 --- loss: 1.864699, loss_ss: 1.611572, loss_d: 0.253127
0.1559 --- loss: 2.471741, loss_ss: 1.464977, loss_d: 1.006763
0.2338 --- loss: 2.020345, loss_ss: 1.401572, loss_d: 0.618773
0.3118 --- loss: 1.943974, loss_ss: 1.404692, loss_d: 0.539283
0.3897 --- loss: 2.209528, loss_ss: 1.535630, loss_d: 0.673898
0.4677 --- loss: 2.060400, loss_ss: 1.370292, loss_d: 0.690108
0.5456 --- loss: 1.952327, loss_ss: 1.349281, loss_d: 0.603047
0.6235 --- loss: 1.858759, loss_ss: 1.265754, loss_d: 0.593005
0.7015 --- loss: 1.874248, loss_ss: 1.275603, loss_d: 0.598645
0.7794 --- loss: 1.820822, loss_ss: 1.153676, loss_d: 0.667146
0.8574 --- loss: 2.041683, loss_ss: 1.208482, loss_d: 0.833200
0.9353 --- loss: 1.824291, loss_ss: 1.293283, loss_d: 0.531008
Epoch finished! Loss: 2.0178166907280684
Starting epoch 2/10.
0.0000 --- loss: 1.783960, loss_ss: 1.210648, loss_d: 0.573312
0.0779 --- loss: 1.589006, loss_ss: 1.234924, loss_d: 0.354082
0.1559 --- loss: 2.102944, loss_ss: 1.357514, loss_d: 0.745430
0.2338 --- loss: 2.418092, loss_ss: 1.275575, loss_d: 1.142517
0.3118 --- loss: 1.745617, loss_ss: 1.262669, loss_d: 0.482948
0.3897 --- loss: 1.685702, loss_ss: 1.234598, loss_d: 0.451104
0.4677 --- loss: 1.503670, loss_ss: 1.275847, loss_d: 0.227823
0.5456 --- loss: 1.561428, loss_ss: 1.209001, loss_d: 0.352427
0.6235 --- loss: 1.377257, loss_ss: 1.017764, loss_d: 0.359492
0.7015 --- loss: 1.516917, loss_ss: 1.071979, loss_d: 0.444937
0.7794 --- loss: 1.509706, loss_ss: 1.172635, loss_d: 0.337070
0.8574 --- loss: 1.911150, loss_ss: 1.213984, loss_d: 0.697166
0.9353 --- loss: 2.015103, loss_ss: 1.082307, loss_d: 0.932796
Epoch finished! Loss: 1.7196157947182655
Starting epoch 3/10.
0.0000 --- loss: 1.708643, loss_ss: 1.010291, loss_d: 0.698352
0.0779 --- loss: 1.621869, loss_ss: 1.096237, loss_d: 0.525632
0.1559 --- loss: 1.895940, loss_ss: 1.123473, loss_d: 0.772467
0.2338 --- loss: 1.906446, loss_ss: 1.436816, loss_d: 0.469630
0.3118 --- loss: 1.735042, loss_ss: 1.311339, loss_d: 0.423703
0.3897 --- loss: 1.729936, loss_ss: 1.025833, loss_d: 0.704103
0.4677 --- loss: 1.646588, loss_ss: 1.046382, loss_d: 0.600206
0.5456 --- loss: 1.585443, loss_ss: 1.101270, loss_d: 0.484173
0.6235 --- loss: 1.134096, loss_ss: 0.954551, loss_d: 0.179544
0.7015 --- loss: 1.450861, loss_ss: 0.931191, loss_d: 0.519670
0.7794 --- loss: 1.485606, loss_ss: 1.057770, loss_d: 0.427836
0.8574 --- loss: 1.423411, loss_ss: 1.178084, loss_d: 0.245327
0.9353 --- loss: 1.027765, loss_ss: 0.985511, loss_d: 0.042255
Epoch finished! Loss: 1.4840114191174507
Starting epoch 4/10.
0.0000 --- loss: 1.323125, loss_ss: 1.059014, loss_d: 0.264110
0.0779 --- loss: 1.453269, loss_ss: 1.099551, loss_d: 0.353718
0.1559 --- loss: 1.163817, loss_ss: 0.925584, loss_d: 0.238233
0.2338 --- loss: 1.387251, loss_ss: 1.090418, loss_d: 0.296833
0.3118 --- loss: 1.166773, loss_ss: 1.029816, loss_d: 0.136956
0.3897 --- loss: 1.385585, loss_ss: 1.174411, loss_d: 0.211174
0.4677 --- loss: 1.214622, loss_ss: 1.117001, loss_d: 0.097620
0.5456 --- loss: 1.294057, loss_ss: 1.028138, loss_d: 0.265919
0.6235 --- loss: 1.535197, loss_ss: 1.236354, loss_d: 0.298844
0.7015 --- loss: 1.309507, loss_ss: 1.111490, loss_d: 0.198016
0.7794 --- loss: 1.023592, loss_ss: 0.868896, loss_d: 0.154696
0.8574 --- loss: 1.364507, loss_ss: 1.038124, loss_d: 0.326383
0.9353 --- loss: 1.441743, loss_ss: 1.035606, loss_d: 0.406137
Epoch finished! Loss: 1.34069334436208
Starting epoch 5/10.
0.0000 --- loss: 1.039822, loss_ss: 1.001955, loss_d: 0.037867
0.0779 --- loss: 1.324930, loss_ss: 1.083529, loss_d: 0.241401
0.1559 --- loss: 1.095553, loss_ss: 0.968783, loss_d: 0.126770
0.2338 --- loss: 1.195773, loss_ss: 1.157210, loss_d: 0.038563
0.3118 --- loss: 1.458828, loss_ss: 0.878179, loss_d: 0.580649
0.3897 --- loss: 1.413723, loss_ss: 1.136324, loss_d: 0.277399
0.4677 --- loss: 1.386272, loss_ss: 0.967593, loss_d: 0.418679
0.5456 --- loss: 1.249962, loss_ss: 1.158859, loss_d: 0.091103
0.6235 --- loss: 1.269912, loss_ss: 1.132673, loss_d: 0.137239
0.7015 --- loss: 1.581183, loss_ss: 0.808272, loss_d: 0.772911
0.7794 --- loss: 1.119538, loss_ss: 0.943980, loss_d: 0.175559
0.8574 --- loss: 1.525715, loss_ss: 1.297470, loss_d: 0.228245
0.9353 --- loss: 1.187238, loss_ss: 1.057205, loss_d: 0.130033
Epoch finished! Loss: 1.2559603229165077
Starting epoch 6/10.
0.0000 --- loss: 1.385883, loss_ss: 0.994913, loss_d: 0.390970
0.0779 --- loss: 1.269738, loss_ss: 0.929158, loss_d: 0.340580
0.1559 --- loss: 1.137098, loss_ss: 1.057793, loss_d: 0.079305
0.2338 --- loss: 1.118534, loss_ss: 1.078639, loss_d: 0.039895
0.3118 --- loss: 1.174721, loss_ss: 0.773858, loss_d: 0.400863
0.3897 --- loss: 0.853942, loss_ss: 0.789314, loss_d: 0.064628
0.4677 --- loss: 1.046595, loss_ss: 0.802777, loss_d: 0.243819
0.5456 --- loss: 1.028469, loss_ss: 0.825097, loss_d: 0.203372
0.6235 --- loss: 0.962976, loss_ss: 0.938094, loss_d: 0.024882
0.7015 --- loss: 1.065723, loss_ss: 0.951480, loss_d: 0.114242
0.7794 --- loss: 1.217410, loss_ss: 1.182619, loss_d: 0.034791
0.8574 --- loss: 1.402737, loss_ss: 0.978844, loss_d: 0.423893
0.9353 --- loss: 0.797489, loss_ss: 0.783373, loss_d: 0.014116
Epoch finished! Loss: 1.144524107221514
Starting epoch 7/10.
0.0000 --- loss: 1.068440, loss_ss: 1.023246, loss_d: 0.045194
0.0779 --- loss: 1.224677, loss_ss: 1.021968, loss_d: 0.202709
0.1559 --- loss: 1.205064, loss_ss: 1.092523, loss_d: 0.112541
0.2338 --- loss: 1.207885, loss_ss: 1.099085, loss_d: 0.108800
0.3118 --- loss: 0.811298, loss_ss: 0.746380, loss_d: 0.064918
0.3897 --- loss: 0.877517, loss_ss: 0.848581, loss_d: 0.028935
0.4677 --- loss: 1.333518, loss_ss: 1.038388, loss_d: 0.295130
0.5456 --- loss: 1.087656, loss_ss: 1.027592, loss_d: 0.060065
0.6235 --- loss: 0.970022, loss_ss: 0.936035, loss_d: 0.033986
0.7015 --- loss: 0.969250, loss_ss: 0.939622, loss_d: 0.029628
0.7794 --- loss: 1.138646, loss_ss: 0.867923, loss_d: 0.270723
0.8574 --- loss: 1.386514, loss_ss: 1.060581, loss_d: 0.325934
0.9353 --- loss: 1.179447, loss_ss: 1.040723, loss_d: 0.138724
Epoch finished! Loss: 1.0955147631466389
Starting epoch 8/10.
0.0000 --- loss: 1.015571, loss_ss: 0.959694, loss_d: 0.055876
0.0779 --- loss: 0.905156, loss_ss: 0.730378, loss_d: 0.174778
0.1559 --- loss: 0.908835, loss_ss: 0.883416, loss_d: 0.025419
0.2338 --- loss: 0.822588, loss_ss: 0.779246, loss_d: 0.043341
0.3118 --- loss: 0.939683, loss_ss: 0.889421, loss_d: 0.050262
0.3897 --- loss: 1.115356, loss_ss: 1.108537, loss_d: 0.006819
0.4677 --- loss: 1.190917, loss_ss: 1.171410, loss_d: 0.019507
0.5456 --- loss: 0.895040, loss_ss: 0.876051, loss_d: 0.018989
0.6235 --- loss: 0.937611, loss_ss: 0.875403, loss_d: 0.062208
0.7015 --- loss: 0.864832, loss_ss: 0.792117, loss_d: 0.072715
0.7794 --- loss: 1.106742, loss_ss: 1.032991, loss_d: 0.073751
0.8574 --- loss: 1.064908, loss_ss: 1.033939, loss_d: 0.030969
0.9353 --- loss: 1.017916, loss_ss: 0.978301, loss_d: 0.039615
Epoch finished! Loss: 1.0224016681313515
Starting epoch 9/10.
0.0000 --- loss: 1.497215, loss_ss: 1.243647, loss_d: 0.253568
0.0779 --- loss: 0.983567, loss_ss: 0.948693, loss_d: 0.034875
0.1559 --- loss: 0.746900, loss_ss: 0.739561, loss_d: 0.007340
0.2338 --- loss: 0.748154, loss_ss: 0.707911, loss_d: 0.040243
0.3118 --- loss: 1.329850, loss_ss: 0.841892, loss_d: 0.487959
0.3897 --- loss: 1.250168, loss_ss: 1.078129, loss_d: 0.172039
0.4677 --- loss: 1.009608, loss_ss: 0.984993, loss_d: 0.024615
0.5456 --- loss: 1.088366, loss_ss: 0.784097, loss_d: 0.304269
0.6235 --- loss: 1.201227, loss_ss: 1.026305, loss_d: 0.174923
0.7015 --- loss: 0.979015, loss_ss: 0.952535, loss_d: 0.026480
0.7794 --- loss: 0.798786, loss_ss: 0.781687, loss_d: 0.017099
0.8574 --- loss: 0.852531, loss_ss: 0.843048, loss_d: 0.009483
0.9353 --- loss: 0.867640, loss_ss: 0.806457, loss_d: 0.061183
Epoch finished! Loss: 1.0252662715502083
Starting epoch 10/10.
0.0000 --- loss: 0.981472, loss_ss: 0.954661, loss_d: 0.026810
0.0779 --- loss: 0.949106, loss_ss: 0.891489, loss_d: 0.057617
0.1559 --- loss: 0.841130, loss_ss: 0.827126, loss_d: 0.014004
0.2338 --- loss: 1.026015, loss_ss: 1.018869, loss_d: 0.007147
0.3118 --- loss: 1.107790, loss_ss: 0.956032, loss_d: 0.151758
0.3897 --- loss: 0.848156, loss_ss: 0.839062, loss_d: 0.009094
0.4677 --- loss: 0.946055, loss_ss: 0.930718, loss_d: 0.015337
0.5456 --- loss: 1.157125, loss_ss: 0.870695, loss_d: 0.286430
0.6235 --- loss: 0.891886, loss_ss: 0.887896, loss_d: 0.003990
0.7015 --- loss: 0.900599, loss_ss: 0.853336, loss_d: 0.047264
0.7794 --- loss: 0.923196, loss_ss: 0.909307, loss_d: 0.013889
0.8574 --- loss: 0.867601, loss_ss: 0.862683, loss_d: 0.004918
0.9353 --- loss: 0.741665, loss_ss: 0.738917, loss_d: 0.002748
Epoch finished! Loss: 0.9443098944611847
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.5392156862745098
             precision    recall  f1-score   support

        0.0       0.83      0.59      0.69       105
        1.0       0.12      0.55      0.20        44
        2.0       0.53      0.81      0.64       317
        3.0       1.00      0.31      0.48       258
        4.0       0.69      0.43      0.53       296

avg / total       0.71      0.54      0.55      1020
 


====== chp058-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.51  59.05   98.58   82.67     68.89
1  80.88  54.55   82.07   12.06     19.75
2  71.96  81.07   67.85   53.21     64.25
3  82.65  31.40  100.00  100.00     47.79
4  77.84  42.57   92.27   69.23     52.72
Total accuracy: 53.92%
Average sen: 53.73%
Average spec: 88.15%
Macro f1-score: 50.68%
Diagnosis acc on 30mins: 1.0
[0.99999535 0.99993289 0.99998009 0.99996948 0.99999523 0.99996269
 0.99999332 0.99986041 0.99999976 0.99998915 0.99999428 0.99999881
 0.99999797 1.         1.         0.99995291 0.99989045]
pred: 0.9999713406843298, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp058-nsrr

=== Test on chp059-nsrr. train_data(1282), test_data(18) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.558816, loss_ss: 1.833150, loss_d: 0.725666
0.0780 --- loss: 2.479780, loss_ss: 1.642993, loss_d: 0.836786
0.1560 --- loss: 2.483320, loss_ss: 1.801184, loss_d: 0.682136
0.2340 --- loss: 2.213830, loss_ss: 1.658641, loss_d: 0.555189
0.3120 --- loss: 2.034702, loss_ss: 1.642715, loss_d: 0.391987
0.3900 --- loss: 2.359685, loss_ss: 1.702592, loss_d: 0.657093
0.4680 --- loss: 2.228885, loss_ss: 1.523791, loss_d: 0.705094
0.5460 --- loss: 2.148329, loss_ss: 1.675213, loss_d: 0.473116
0.6240 --- loss: 2.087320, loss_ss: 1.599088, loss_d: 0.488232
0.7020 --- loss: 2.270268, loss_ss: 1.396683, loss_d: 0.873585
0.7800 --- loss: 2.037224, loss_ss: 1.404524, loss_d: 0.632699
0.8580 --- loss: 2.134195, loss_ss: 1.472402, loss_d: 0.661793
0.9360 --- loss: 1.855241, loss_ss: 1.321426, loss_d: 0.533815
Epoch finished! Loss: 2.1507278997451067
Starting epoch 2/10.
0.0000 --- loss: 1.930427, loss_ss: 1.355572, loss_d: 0.574855
0.0780 --- loss: 1.765361, loss_ss: 1.464446, loss_d: 0.300915
0.1560 --- loss: 1.768703, loss_ss: 1.325368, loss_d: 0.443334
0.2340 --- loss: 2.046475, loss_ss: 1.581064, loss_d: 0.465411
0.3120 --- loss: 1.562724, loss_ss: 1.195222, loss_d: 0.367502
0.3900 --- loss: 1.716589, loss_ss: 1.125059, loss_d: 0.591530
0.4680 --- loss: 1.613207, loss_ss: 1.190218, loss_d: 0.422988
0.5460 --- loss: 1.800148, loss_ss: 1.392753, loss_d: 0.407395
0.6240 --- loss: 1.307661, loss_ss: 1.137130, loss_d: 0.170532
0.7020 --- loss: 1.518733, loss_ss: 1.168047, loss_d: 0.350686
0.7800 --- loss: 1.681580, loss_ss: 1.152658, loss_d: 0.528922
0.8580 --- loss: 1.629845, loss_ss: 1.164158, loss_d: 0.465687
0.9360 --- loss: 1.373030, loss_ss: 1.048705, loss_d: 0.324325
Epoch finished! Loss: 1.732350004836917
Starting epoch 3/10.
0.0000 --- loss: 1.396958, loss_ss: 1.043617, loss_d: 0.353340
0.0780 --- loss: 1.528116, loss_ss: 1.167745, loss_d: 0.360370
0.1560 --- loss: 1.443838, loss_ss: 1.170794, loss_d: 0.273044
0.2340 --- loss: 1.291229, loss_ss: 1.096560, loss_d: 0.194669
0.3120 --- loss: 1.937408, loss_ss: 1.097346, loss_d: 0.840062
0.3900 --- loss: 1.383829, loss_ss: 1.083428, loss_d: 0.300401
0.4680 --- loss: 1.239271, loss_ss: 1.075506, loss_d: 0.163765
0.5460 --- loss: 1.425331, loss_ss: 1.010263, loss_d: 0.415068
0.6240 --- loss: 1.565149, loss_ss: 1.132528, loss_d: 0.432621
0.7020 --- loss: 1.637767, loss_ss: 1.005244, loss_d: 0.632523
0.7800 --- loss: 1.302578, loss_ss: 1.015665, loss_d: 0.286913
0.8580 --- loss: 1.966936, loss_ss: 1.242823, loss_d: 0.724114
0.9360 --- loss: 1.465010, loss_ss: 1.077701, loss_d: 0.387309
Epoch finished! Loss: 1.4942960226908326
Starting epoch 4/10.
0.0000 --- loss: 1.104606, loss_ss: 0.927174, loss_d: 0.177432
0.0780 --- loss: 1.422752, loss_ss: 1.296827, loss_d: 0.125926
0.1560 --- loss: 1.303051, loss_ss: 1.140073, loss_d: 0.162979
0.2340 --- loss: 1.816427, loss_ss: 1.505460, loss_d: 0.310966
0.3120 --- loss: 1.364013, loss_ss: 1.037265, loss_d: 0.326748
0.3900 --- loss: 1.639270, loss_ss: 1.428468, loss_d: 0.210802
0.4680 --- loss: 1.270908, loss_ss: 1.072750, loss_d: 0.198158
0.5460 --- loss: 1.098227, loss_ss: 1.050686, loss_d: 0.047541
0.6240 --- loss: 1.235411, loss_ss: 1.114560, loss_d: 0.120851
0.7020 --- loss: 1.594104, loss_ss: 1.188033, loss_d: 0.406070
0.7800 --- loss: 1.440933, loss_ss: 1.080015, loss_d: 0.360917
0.8580 --- loss: 0.954722, loss_ss: 0.741363, loss_d: 0.213359
0.9360 --- loss: 1.032471, loss_ss: 0.916629, loss_d: 0.115842
Epoch finished! Loss: 1.3844709917902946
Starting epoch 5/10.
0.0000 --- loss: 1.189300, loss_ss: 1.024369, loss_d: 0.164931
0.0780 --- loss: 1.269713, loss_ss: 1.080542, loss_d: 0.189170
0.1560 --- loss: 1.194423, loss_ss: 0.896428, loss_d: 0.297995
0.2340 --- loss: 1.249500, loss_ss: 0.996170, loss_d: 0.253330
0.3120 --- loss: 1.033149, loss_ss: 0.956973, loss_d: 0.076176
0.3900 --- loss: 1.090546, loss_ss: 1.046569, loss_d: 0.043978
0.4680 --- loss: 1.210809, loss_ss: 1.122878, loss_d: 0.087931
0.5460 --- loss: 1.173447, loss_ss: 0.929320, loss_d: 0.244127
0.6240 --- loss: 1.721005, loss_ss: 1.171416, loss_d: 0.549589
0.7020 --- loss: 1.379439, loss_ss: 0.981033, loss_d: 0.398406
0.7800 --- loss: 1.139046, loss_ss: 1.016502, loss_d: 0.122544
0.8580 --- loss: 1.639216, loss_ss: 0.974297, loss_d: 0.664919
0.9360 --- loss: 0.817671, loss_ss: 0.675127, loss_d: 0.142544
Epoch finished! Loss: 1.2778827897273004
Starting epoch 6/10.
0.0000 --- loss: 0.811205, loss_ss: 0.742617, loss_d: 0.068588
0.0780 --- loss: 1.101425, loss_ss: 0.996211, loss_d: 0.105214
0.1560 --- loss: 1.007591, loss_ss: 0.919249, loss_d: 0.088341
0.2340 --- loss: 1.267295, loss_ss: 1.192240, loss_d: 0.075055
0.3120 --- loss: 0.995840, loss_ss: 0.856477, loss_d: 0.139364
0.3900 --- loss: 1.481560, loss_ss: 1.081401, loss_d: 0.400159
0.4680 --- loss: 1.525841, loss_ss: 1.418914, loss_d: 0.106927
0.5460 --- loss: 1.055731, loss_ss: 0.987765, loss_d: 0.067966
0.6240 --- loss: 0.925631, loss_ss: 0.879269, loss_d: 0.046362
0.7020 --- loss: 1.490383, loss_ss: 1.081768, loss_d: 0.408615
0.7800 --- loss: 1.276886, loss_ss: 0.993300, loss_d: 0.283585
0.8580 --- loss: 1.505994, loss_ss: 1.178406, loss_d: 0.327589
0.9360 --- loss: 1.073884, loss_ss: 1.004636, loss_d: 0.069247
Epoch finished! Loss: 1.1831664079800248
Starting epoch 7/10.
0.0000 --- loss: 1.466810, loss_ss: 0.963877, loss_d: 0.502933
0.0780 --- loss: 0.950554, loss_ss: 0.819003, loss_d: 0.131551
0.1560 --- loss: 0.914672, loss_ss: 0.848780, loss_d: 0.065892
0.2340 --- loss: 1.162733, loss_ss: 0.864215, loss_d: 0.298518
0.3120 --- loss: 1.123915, loss_ss: 1.000630, loss_d: 0.123285
0.3900 --- loss: 1.555517, loss_ss: 1.294891, loss_d: 0.260626
0.4680 --- loss: 1.120901, loss_ss: 0.947581, loss_d: 0.173320
0.5460 --- loss: 0.930262, loss_ss: 0.900984, loss_d: 0.029278
0.6240 --- loss: 0.781674, loss_ss: 0.771822, loss_d: 0.009852
0.7020 --- loss: 1.183706, loss_ss: 0.907582, loss_d: 0.276125
0.7800 --- loss: 1.444485, loss_ss: 1.318235, loss_d: 0.126250
0.8580 --- loss: 1.073975, loss_ss: 0.878973, loss_d: 0.195002
0.9360 --- loss: 1.542026, loss_ss: 0.920894, loss_d: 0.621132
Epoch finished! Loss: 1.1098326076753438
Starting epoch 8/10.
0.0000 --- loss: 1.037842, loss_ss: 0.917923, loss_d: 0.119920
0.0780 --- loss: 0.863972, loss_ss: 0.845055, loss_d: 0.018916
0.1560 --- loss: 1.136638, loss_ss: 0.917733, loss_d: 0.218905
0.2340 --- loss: 0.811584, loss_ss: 0.783528, loss_d: 0.028056
0.3120 --- loss: 0.827948, loss_ss: 0.667343, loss_d: 0.160605
0.3900 --- loss: 1.001606, loss_ss: 0.780421, loss_d: 0.221185
0.4680 --- loss: 1.262744, loss_ss: 1.220408, loss_d: 0.042336
0.5460 --- loss: 0.631942, loss_ss: 0.604337, loss_d: 0.027605
0.6240 --- loss: 0.906213, loss_ss: 0.852800, loss_d: 0.053414
0.7020 --- loss: 1.133344, loss_ss: 1.050918, loss_d: 0.082426
0.7800 --- loss: 1.173836, loss_ss: 1.020934, loss_d: 0.152902
0.8580 --- loss: 1.064593, loss_ss: 0.779141, loss_d: 0.285453
0.9360 --- loss: 0.914305, loss_ss: 0.736039, loss_d: 0.178266
Epoch finished! Loss: 1.038103312253952
Starting epoch 9/10.
0.0000 --- loss: 0.793764, loss_ss: 0.768365, loss_d: 0.025398
0.0780 --- loss: 0.779218, loss_ss: 0.731058, loss_d: 0.048160
0.1560 --- loss: 1.077618, loss_ss: 0.784281, loss_d: 0.293337
0.2340 --- loss: 1.206135, loss_ss: 1.179870, loss_d: 0.026264
0.3120 --- loss: 1.055107, loss_ss: 0.873319, loss_d: 0.181787
0.3900 --- loss: 0.775030, loss_ss: 0.740818, loss_d: 0.034213
0.4680 --- loss: 1.124709, loss_ss: 0.751416, loss_d: 0.373293
0.5460 --- loss: 1.118014, loss_ss: 0.832007, loss_d: 0.286007
0.6240 --- loss: 0.726049, loss_ss: 0.688425, loss_d: 0.037624
0.7020 --- loss: 0.823130, loss_ss: 0.709022, loss_d: 0.114109
0.7800 --- loss: 0.961676, loss_ss: 0.795187, loss_d: 0.166489
0.8580 --- loss: 0.871745, loss_ss: 0.713184, loss_d: 0.158561
0.9360 --- loss: 0.842006, loss_ss: 0.829244, loss_d: 0.012762
Epoch finished! Loss: 1.0033713295124471
Starting epoch 10/10.
0.0000 --- loss: 0.758504, loss_ss: 0.711402, loss_d: 0.047102
0.0780 --- loss: 0.975086, loss_ss: 0.927133, loss_d: 0.047953
0.1560 --- loss: 0.890512, loss_ss: 0.804546, loss_d: 0.085966
0.2340 --- loss: 0.960475, loss_ss: 0.917255, loss_d: 0.043220
0.3120 --- loss: 0.880068, loss_ss: 0.865651, loss_d: 0.014418
0.3900 --- loss: 0.895558, loss_ss: 0.879241, loss_d: 0.016318
0.4680 --- loss: 0.844947, loss_ss: 0.831032, loss_d: 0.013915
0.5460 --- loss: 0.831443, loss_ss: 0.817929, loss_d: 0.013514
0.6240 --- loss: 1.020833, loss_ss: 0.977289, loss_d: 0.043544
0.7020 --- loss: 0.778102, loss_ss: 0.762929, loss_d: 0.015173
0.7800 --- loss: 0.872714, loss_ss: 0.862236, loss_d: 0.010478
0.8580 --- loss: 0.919770, loss_ss: 0.846238, loss_d: 0.073532
0.9360 --- loss: 1.912456, loss_ss: 0.634335, loss_d: 1.278120
Epoch finished! Loss: 0.9908772590570152
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6611111111111111
             precision    recall  f1-score   support

        0.0       0.98      0.64      0.77       233
        1.0       0.45      0.74      0.56       238
        2.0       0.70      0.74      0.72       355
        3.0       0.84      0.54      0.66        87
        4.0       0.76      0.49      0.60       167

avg / total       0.72      0.66      0.67      1080
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.94  63.95   99.65  98.03     77.40
1  74.26  73.53   74.47  44.87     55.73
2  80.83  73.52   84.41  69.79     71.60
3  95.46  54.02   99.09  83.93     65.73
4  89.72  49.10   97.15  75.93     59.64
Total accuracy: 66.11%
Average sen: 62.82%
Average spec: 90.95%
Macro f1-score: 66.02%
Diagnosis acc on 30mins: 1.0
[0.99212182 0.99894983 0.98504859 0.90363801 0.99956685 0.99868351
 0.9982053  0.78353471 0.94640142 0.97680783 0.99826092 0.98571104
 0.94735676 0.92273706 0.96045983 0.99923372 0.9740321  0.7633695 ]
pred: 0.9518954886330498, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp059-nsrr

=== Test on chp060-nsrr. train_data(1279), test_data(21) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.524869, loss_ss: 1.841995, loss_d: 0.682874
0.0782 --- loss: 2.379865, loss_ss: 1.796240, loss_d: 0.583624
0.1564 --- loss: 2.572890, loss_ss: 1.674897, loss_d: 0.897993
0.2346 --- loss: 2.155619, loss_ss: 1.663780, loss_d: 0.491840
0.3127 --- loss: 2.193348, loss_ss: 1.508218, loss_d: 0.685130
0.3909 --- loss: 2.136119, loss_ss: 1.587810, loss_d: 0.548309
0.4691 --- loss: 1.939806, loss_ss: 1.447079, loss_d: 0.492728
0.5473 --- loss: 1.825881, loss_ss: 1.434525, loss_d: 0.391356
0.6255 --- loss: 1.911100, loss_ss: 1.370536, loss_d: 0.540564
0.7037 --- loss: 1.865455, loss_ss: 1.456354, loss_d: 0.409101
0.7819 --- loss: 1.970242, loss_ss: 1.289320, loss_d: 0.680923
0.8600 --- loss: 2.117612, loss_ss: 1.308375, loss_d: 0.809238
0.9382 --- loss: 2.135709, loss_ss: 1.361637, loss_d: 0.774072
Epoch finished! Loss: 2.0793189035625907
Starting epoch 2/10.
0.0000 --- loss: 1.813950, loss_ss: 1.275302, loss_d: 0.538648
0.0782 --- loss: 1.836761, loss_ss: 1.192614, loss_d: 0.644147
0.1564 --- loss: 1.468811, loss_ss: 1.193839, loss_d: 0.274972
0.2346 --- loss: 1.573092, loss_ss: 1.296333, loss_d: 0.276758
0.3127 --- loss: 1.434237, loss_ss: 1.148353, loss_d: 0.285884
0.3909 --- loss: 1.916240, loss_ss: 1.228087, loss_d: 0.688154
0.4691 --- loss: 1.590908, loss_ss: 1.220699, loss_d: 0.370208
0.5473 --- loss: 1.271569, loss_ss: 1.018730, loss_d: 0.252839
0.6255 --- loss: 1.584692, loss_ss: 1.208574, loss_d: 0.376118
0.7037 --- loss: 1.697506, loss_ss: 1.202595, loss_d: 0.494911
0.7819 --- loss: 1.350896, loss_ss: 1.132234, loss_d: 0.218662
0.8600 --- loss: 1.233851, loss_ss: 1.040610, loss_d: 0.193240
0.9382 --- loss: 1.479108, loss_ss: 1.183691, loss_d: 0.295417
Epoch finished! Loss: 1.6310547158474058
Starting epoch 3/10.
0.0000 --- loss: 1.471276, loss_ss: 1.249532, loss_d: 0.221743
0.0782 --- loss: 1.317866, loss_ss: 1.030666, loss_d: 0.287200
0.1564 --- loss: 1.426805, loss_ss: 1.262797, loss_d: 0.164008
0.2346 --- loss: 1.527717, loss_ss: 1.134291, loss_d: 0.393426
0.3127 --- loss: 1.395580, loss_ss: 0.975267, loss_d: 0.420313
0.3909 --- loss: 1.653833, loss_ss: 1.205774, loss_d: 0.448059
0.4691 --- loss: 1.407536, loss_ss: 1.101164, loss_d: 0.306372
0.5473 --- loss: 1.405285, loss_ss: 1.010752, loss_d: 0.394534
0.6255 --- loss: 1.230345, loss_ss: 1.020233, loss_d: 0.210112
0.7037 --- loss: 1.264438, loss_ss: 1.057224, loss_d: 0.207214
0.7819 --- loss: 1.531436, loss_ss: 1.103937, loss_d: 0.427499
0.8600 --- loss: 1.147915, loss_ss: 0.894336, loss_d: 0.253579
0.9382 --- loss: 1.428227, loss_ss: 1.041871, loss_d: 0.386355
Epoch finished! Loss: 1.4124758393745722
Starting epoch 4/10.
0.0000 --- loss: 1.268043, loss_ss: 1.038991, loss_d: 0.229052
0.0782 --- loss: 1.178051, loss_ss: 1.060185, loss_d: 0.117866
0.1564 --- loss: 0.964368, loss_ss: 0.810132, loss_d: 0.154236
0.2346 --- loss: 1.401893, loss_ss: 1.146941, loss_d: 0.254952
0.3127 --- loss: 1.078825, loss_ss: 0.943759, loss_d: 0.135066
0.3909 --- loss: 1.177235, loss_ss: 0.986901, loss_d: 0.190335
0.4691 --- loss: 1.302169, loss_ss: 1.064566, loss_d: 0.237603
0.5473 --- loss: 1.149784, loss_ss: 0.949412, loss_d: 0.200372
0.6255 --- loss: 1.367680, loss_ss: 0.971928, loss_d: 0.395752
0.7037 --- loss: 0.934069, loss_ss: 0.856958, loss_d: 0.077111
0.7819 --- loss: 1.402420, loss_ss: 1.203306, loss_d: 0.199114
0.8600 --- loss: 0.992493, loss_ss: 0.958498, loss_d: 0.033995
0.9382 --- loss: 1.100821, loss_ss: 0.965515, loss_d: 0.135306
Epoch finished! Loss: 1.3005737850046533
Starting epoch 5/10.
0.0000 --- loss: 1.280669, loss_ss: 1.125796, loss_d: 0.154873
0.0782 --- loss: 1.381282, loss_ss: 1.257843, loss_d: 0.123439
0.1564 --- loss: 1.010042, loss_ss: 0.835386, loss_d: 0.174656
0.2346 --- loss: 0.888072, loss_ss: 0.832979, loss_d: 0.055093
0.3127 --- loss: 0.997656, loss_ss: 0.926071, loss_d: 0.071584
0.3909 --- loss: 0.876170, loss_ss: 0.839538, loss_d: 0.036632
0.4691 --- loss: 1.269257, loss_ss: 1.188024, loss_d: 0.081233
0.5473 --- loss: 0.784754, loss_ss: 0.690304, loss_d: 0.094450
0.6255 --- loss: 1.060843, loss_ss: 0.961163, loss_d: 0.099680
0.7037 --- loss: 1.011528, loss_ss: 0.891619, loss_d: 0.119910
0.7819 --- loss: 1.927904, loss_ss: 1.444745, loss_d: 0.483159
0.8600 --- loss: 1.017351, loss_ss: 0.946568, loss_d: 0.070783
0.9382 --- loss: 0.920278, loss_ss: 0.869580, loss_d: 0.050697
Epoch finished! Loss: 1.1820279064140922
Starting epoch 6/10.
0.0000 --- loss: 0.957645, loss_ss: 0.903859, loss_d: 0.053786
0.0782 --- loss: 1.116594, loss_ss: 1.099462, loss_d: 0.017132
0.1564 --- loss: 1.314916, loss_ss: 0.906630, loss_d: 0.408286
0.2346 --- loss: 1.015196, loss_ss: 0.935359, loss_d: 0.079837
0.3127 --- loss: 1.125376, loss_ss: 0.906388, loss_d: 0.218988
0.3909 --- loss: 1.113964, loss_ss: 0.939640, loss_d: 0.174324
0.4691 --- loss: 0.945849, loss_ss: 0.877589, loss_d: 0.068260
0.5473 --- loss: 0.956912, loss_ss: 0.924399, loss_d: 0.032513
0.6255 --- loss: 0.946800, loss_ss: 0.900727, loss_d: 0.046073
0.7037 --- loss: 0.897224, loss_ss: 0.850335, loss_d: 0.046890
0.7819 --- loss: 0.905903, loss_ss: 0.875361, loss_d: 0.030542
0.8600 --- loss: 1.167365, loss_ss: 0.960257, loss_d: 0.207108
0.9382 --- loss: 0.882180, loss_ss: 0.849472, loss_d: 0.032709
Epoch finished! Loss: 1.155555550977001
Starting epoch 7/10.
0.0000 --- loss: 1.229262, loss_ss: 1.139089, loss_d: 0.090173
0.0782 --- loss: 0.773006, loss_ss: 0.705832, loss_d: 0.067173
0.1564 --- loss: 1.503965, loss_ss: 1.113591, loss_d: 0.390374
0.2346 --- loss: 1.188205, loss_ss: 0.881431, loss_d: 0.306774
0.3127 --- loss: 1.302905, loss_ss: 1.262003, loss_d: 0.040902
0.3909 --- loss: 0.756120, loss_ss: 0.715059, loss_d: 0.041061
0.4691 --- loss: 1.063718, loss_ss: 1.020873, loss_d: 0.042845
0.5473 --- loss: 0.969869, loss_ss: 0.909899, loss_d: 0.059970
0.6255 --- loss: 1.083691, loss_ss: 1.072652, loss_d: 0.011040
0.7037 --- loss: 1.310356, loss_ss: 1.031632, loss_d: 0.278724
0.7819 --- loss: 0.910510, loss_ss: 0.841916, loss_d: 0.068594
0.8600 --- loss: 1.288240, loss_ss: 0.960999, loss_d: 0.327241
0.9382 --- loss: 1.205133, loss_ss: 0.824219, loss_d: 0.380914
Epoch finished! Loss: 1.0605668885501351
Starting epoch 8/10.
0.0000 --- loss: 1.081952, loss_ss: 0.769438, loss_d: 0.312514
0.0782 --- loss: 0.746922, loss_ss: 0.718494, loss_d: 0.028428
0.1564 --- loss: 0.935688, loss_ss: 0.908977, loss_d: 0.026711
0.2346 --- loss: 1.102000, loss_ss: 0.825630, loss_d: 0.276371
0.3127 --- loss: 0.817209, loss_ss: 0.789106, loss_d: 0.028103
0.3909 --- loss: 0.895197, loss_ss: 0.881158, loss_d: 0.014039
0.4691 --- loss: 0.783358, loss_ss: 0.777153, loss_d: 0.006205
0.5473 --- loss: 0.893494, loss_ss: 0.831770, loss_d: 0.061724
0.6255 --- loss: 1.568837, loss_ss: 0.799353, loss_d: 0.769484
0.7037 --- loss: 0.909678, loss_ss: 0.900472, loss_d: 0.009206
0.7819 --- loss: 1.058019, loss_ss: 1.034142, loss_d: 0.023877
0.8600 --- loss: 0.994811, loss_ss: 0.985624, loss_d: 0.009187
0.9382 --- loss: 1.156006, loss_ss: 1.039742, loss_d: 0.116264
Epoch finished! Loss: 1.0050658583641052
Starting epoch 9/10.
0.0000 --- loss: 0.949590, loss_ss: 0.871999, loss_d: 0.077590
0.0782 --- loss: 1.010662, loss_ss: 0.998836, loss_d: 0.011826
0.1564 --- loss: 0.984685, loss_ss: 0.920419, loss_d: 0.064266
0.2346 --- loss: 0.846867, loss_ss: 0.842962, loss_d: 0.003905
0.3127 --- loss: 0.784091, loss_ss: 0.780346, loss_d: 0.003745
0.3909 --- loss: 0.689671, loss_ss: 0.669594, loss_d: 0.020077
0.4691 --- loss: 0.774659, loss_ss: 0.758734, loss_d: 0.015925
0.5473 --- loss: 1.163034, loss_ss: 0.862208, loss_d: 0.300826
0.6255 --- loss: 0.815533, loss_ss: 0.807650, loss_d: 0.007883
0.7037 --- loss: 1.450761, loss_ss: 0.927469, loss_d: 0.523292
0.7819 --- loss: 1.059762, loss_ss: 0.984564, loss_d: 0.075198
0.8600 --- loss: 0.948237, loss_ss: 0.930325, loss_d: 0.017912
0.9382 --- loss: 1.067056, loss_ss: 1.049250, loss_d: 0.017805
Epoch finished! Loss: 0.9715374257620863
Starting epoch 10/10.
0.0000 --- loss: 0.995290, loss_ss: 0.939484, loss_d: 0.055806
0.0782 --- loss: 0.808835, loss_ss: 0.805938, loss_d: 0.002897
0.1564 --- loss: 0.883657, loss_ss: 0.856285, loss_d: 0.027372
0.2346 --- loss: 1.107225, loss_ss: 0.713643, loss_d: 0.393582
0.3127 --- loss: 1.034652, loss_ss: 0.972527, loss_d: 0.062125
0.3909 --- loss: 1.070282, loss_ss: 1.040956, loss_d: 0.029327
0.4691 --- loss: 0.828975, loss_ss: 0.765672, loss_d: 0.063303
0.5473 --- loss: 0.814005, loss_ss: 0.809302, loss_d: 0.004703
0.6255 --- loss: 0.893105, loss_ss: 0.882224, loss_d: 0.010881
0.7037 --- loss: 0.878632, loss_ss: 0.875012, loss_d: 0.003620
0.7819 --- loss: 0.946020, loss_ss: 0.875849, loss_d: 0.070171
0.8600 --- loss: 0.675474, loss_ss: 0.672895, loss_d: 0.002578
0.9382 --- loss: 1.017587, loss_ss: 0.858771, loss_d: 0.158816
Epoch finished! Loss: 0.9575343901716818
Model saved !

==== START TESTING ====
hello
Sleep stage: acc = 0.6023809523809524
             precision    recall  f1-score   support

        0.0       0.93      0.59      0.72       519
        1.0       0.31      0.88      0.46       201
        2.0       0.64      0.61      0.62       228
        3.0       0.95      0.61      0.74       158
        4.0       0.95      0.25      0.40       154

avg / total       0.78      0.60      0.63      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  81.35  59.15   96.90  93.03     72.32
1  67.06  88.06   63.08  31.16     46.03
2  86.67  61.40   92.25  63.64     62.50
3  94.68  60.76   99.55  95.05     74.13
4  90.71  25.32   99.82  95.12     40.00
Total accuracy: 60.24%
Average sen: 58.94%
Average spec: 90.32%
Macro f1-score: 59.00%
Diagnosis acc on 30mins: 1.0
[0.99999785 0.99999309 0.99967492 0.99988365 0.99999595 0.99999869
 0.99799073 0.99940801 0.99999285 0.99989402 0.99999881 0.99999762
 0.99999905 0.99998641 0.99998605 0.99999583 0.99999797 0.99998403
 0.99991429 0.99998534 0.99999917]
pred: 0.9998416332971483, label: 1
Right! Diagnosis: NT1
Save 30mins of subject chp060-nsrr

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.37  68.46   93.87  64.15     66.24
1  83.36  29.02   91.21  32.32     30.58
2  80.72  79.06   81.72  72.48     75.63
3  92.66  61.04   99.43  95.85     74.59
4  85.45  68.98   89.09  58.23     63.15
Total accuracy: 66.28%
Average sen: 61.31%
Average spec: 91.07%
Macro f1-score: 62.04%
Diagnosis acc on patients: 0.8333333333333334

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.33  47.83   98.18  91.67     62.86
1  83.33  98.18   47.83  81.82     89.26
Total accuracy: 83.33%
Average sen: 73.00%
Average spec: 73.00%
Macro f1-score: 76.06%
fpr: 0.0, tpr: 0.01818181818181818, threshold: 0.9999999937258268, 
fpr: 0.0, tpr: 0.6727272727272727, threshold: 0.9989162613363827, 
fpr: 0.043478260869565216, tpr: 0.6727272727272727, threshold: 0.9988132913907369, 
fpr: 0.043478260869565216, tpr: 0.7090909090909091, threshold: 0.998163984881507, 
fpr: 0.08695652173913043, tpr: 0.7090909090909091, threshold: 0.9979518606112554, 
fpr: 0.08695652173913043, tpr: 0.8363636363636363, threshold: 0.9885176845959255, 
fpr: 0.21739130434782608, tpr: 0.8363636363636363, threshold: 0.967889646689097, 
fpr: 0.21739130434782608, tpr: 0.8727272727272727, threshold: 0.9518954886330498, 
fpr: 0.2608695652173913, tpr: 0.8727272727272727, threshold: 0.9410676253693444, 
fpr: 0.2608695652173913, tpr: 0.9818181818181818, threshold: 0.8166123386472464, 
fpr: 0.9565217391304348, tpr: 0.9818181818181818, threshold: 0.12277328507819524, 
fpr: 0.9565217391304348, tpr: 1.0, threshold: 0.08387474468712325, 
fpr: 1.0, tpr: 1.0, threshold: 0.0039641375664919345, 

=== best_threshold: 0.9885176845959255, best_fpr: 0.08695652173913043, best_tpr: 0.8363636363636363 ===
fpr: 0.0, tpr: 0.0, threshold: 2.0, 
fpr: 0.02373887240356083, tpr: 0.08411214953271028, threshold: 1.0, 
fpr: 0.02967359050445104, tpr: 0.11007268951194185, threshold: 0.9999998807907104, 
fpr: 0.032640949554896145, tpr: 0.13707165109034267, threshold: 0.9999997615814209, 
fpr: 0.03560830860534125, tpr: 0.1526479750778816, threshold: 0.9999996423721313, 
fpr: 0.03560830860534125, tpr: 0.16199376947040497, threshold: 0.9999995231628418, 
fpr: 0.03857566765578635, tpr: 0.16926272066458983, threshold: 0.9999994039535522, 
fpr: 0.04154302670623145, tpr: 0.1754932502596054, threshold: 0.9999992847442627, 
fpr: 0.04154302670623145, tpr: 0.18691588785046728, threshold: 0.9999991655349731, 
fpr: 0.04154302670623145, tpr: 0.1952232606438214, threshold: 0.9999990463256836, 
fpr: 0.04154302670623145, tpr: 0.20145379023883697, threshold: 0.999998927116394, 
fpr: 0.04451038575667656, tpr: 0.20976116303219106, threshold: 0.9999988079071045, 
fpr: 0.04451038575667656, tpr: 0.21599169262720663, threshold: 0.9999986886978149, 
fpr: 0.04451038575667656, tpr: 0.21910695742471442, threshold: 0.9999985694885254, 
fpr: 0.04747774480712166, tpr: 0.22741433021806853, threshold: 0.9999984502792358, 
fpr: 0.04747774480712166, tpr: 0.23156801661474558, threshold: 0.9999983310699463, 
fpr: 0.04747774480712166, tpr: 0.2336448598130841, threshold: 0.9999982118606567, 
fpr: 0.04747774480712166, tpr: 0.23779854620976115, threshold: 0.9999980926513672, 
fpr: 0.04747774480712166, tpr: 0.2544132917964694, threshold: 0.9999978542327881, 
fpr: 0.04747774480712166, tpr: 0.2564901349948079, threshold: 0.9999977350234985, 
fpr: 0.04747774480712166, tpr: 0.25960539979231567, threshold: 0.999997615814209, 
fpr: 0.04747774480712166, tpr: 0.26375908618899274, threshold: 0.9999974966049194, 
fpr: 0.04747774480712166, tpr: 0.26583592938733125, threshold: 0.9999973773956299, 
fpr: 0.04747774480712166, tpr: 0.2699896157840083, threshold: 0.9999972581863403, 
fpr: 0.04747774480712166, tpr: 0.2720664589823468, threshold: 0.9999971389770508, 
fpr: 0.04747774480712166, tpr: 0.2762201453790239, threshold: 0.9999970197677612, 
fpr: 0.050445103857566766, tpr: 0.2782969885773624, threshold: 0.9999969005584717, 
fpr: 0.050445103857566766, tpr: 0.2814122533748702, threshold: 0.9999967813491821, 
fpr: 0.050445103857566766, tpr: 0.2834890965732087, threshold: 0.999996542930603, 
fpr: 0.050445103857566766, tpr: 0.2897196261682243, threshold: 0.9999963045120239, 
fpr: 0.050445103857566766, tpr: 0.29179646936656284, threshold: 0.9999959468841553, 
fpr: 0.050445103857566766, tpr: 0.29906542056074764, threshold: 0.9999958276748657, 
fpr: 0.050445103857566766, tpr: 0.3001038421599169, threshold: 0.9999957084655762, 
fpr: 0.050445103857566766, tpr: 0.3032191069574247, threshold: 0.9999955892562866, 
fpr: 0.050445103857566766, tpr: 0.3052959501557632, threshold: 0.9999954700469971, 
fpr: 0.050445103857566766, tpr: 0.3063343717549325, threshold: 0.9999953508377075, 
fpr: 0.050445103857566766, tpr: 0.3094496365524403, threshold: 0.999995231628418, 
fpr: 0.050445103857566766, tpr: 0.3115264797507788, threshold: 0.9999949932098389, 
fpr: 0.050445103857566766, tpr: 0.31568016614745587, threshold: 0.9999948740005493, 
fpr: 0.050445103857566766, tpr: 0.3177570093457944, threshold: 0.9999946355819702, 
fpr: 0.050445103857566766, tpr: 0.31879543094496365, threshold: 0.9999945163726807, 
fpr: 0.050445103857566766, tpr: 0.32191069574247144, threshold: 0.9999942779541016, 
fpr: 0.050445103857566766, tpr: 0.32398753894080995, threshold: 0.9999940395355225, 
fpr: 0.05341246290801187, tpr: 0.3260643821391485, threshold: 0.9999939203262329, 
fpr: 0.05341246290801187, tpr: 0.3302180685358255, threshold: 0.9999933242797852, 
fpr: 0.05341246290801187, tpr: 0.3333333333333333, threshold: 0.9999929666519165, 
fpr: 0.05341246290801187, tpr: 0.3364485981308411, threshold: 0.999992847442627, 
fpr: 0.05341246290801187, tpr: 0.3374870197300104, threshold: 0.9999926090240479, 
fpr: 0.05341246290801187, tpr: 0.34164070612668745, threshold: 0.9999923706054688, 
fpr: 0.05341246290801187, tpr: 0.3426791277258567, threshold: 0.9999922513961792, 
fpr: 0.05341246290801187, tpr: 0.34475597092419524, threshold: 0.9999921321868896, 
fpr: 0.05341246290801187, tpr: 0.34683281412253375, threshold: 0.9999916553497314, 
fpr: 0.05341246290801187, tpr: 0.34994807892004154, threshold: 0.9999914169311523, 
fpr: 0.05637982195845697, tpr: 0.34994807892004154, threshold: 0.9999912977218628, 
fpr: 0.05637982195845697, tpr: 0.3530633437175493, threshold: 0.9999911785125732, 
fpr: 0.05637982195845697, tpr: 0.3572170301142264, threshold: 0.9999897480010986, 
fpr: 0.05637982195845697, tpr: 0.3592938733125649, threshold: 0.9999896287918091, 
fpr: 0.05637982195845697, tpr: 0.3624091381100727, threshold: 0.9999895095825195, 
fpr: 0.05637982195845697, tpr: 0.363447559709242, threshold: 0.9999892711639404, 
fpr: 0.05637982195845697, tpr: 0.3655244029075805, threshold: 0.9999891519546509, 
fpr: 0.05637982195845697, tpr: 0.36863966770508827, threshold: 0.9999887943267822, 
fpr: 0.05637982195845697, tpr: 0.37279335410176534, threshold: 0.9999881982803345, 
fpr: 0.05934718100890208, tpr: 0.37383177570093457, threshold: 0.9999879598617554, 
fpr: 0.05934718100890208, tpr: 0.38006230529595014, threshold: 0.9999865293502808, 
fpr: 0.06231454005934718, tpr: 0.38317757009345793, threshold: 0.9999864101409912, 
fpr: 0.06528189910979229, tpr: 0.3842159916926272, threshold: 0.9999862909317017, 
fpr: 0.06528189910979229, tpr: 0.387331256490135, threshold: 0.999985933303833, 
fpr: 0.06528189910979229, tpr: 0.3894080996884735, threshold: 0.9999855756759644, 
fpr: 0.06528189910979229, tpr: 0.3904465212876428, threshold: 0.9999854564666748, 
fpr: 0.06528189910979229, tpr: 0.3935617860851506, threshold: 0.9999853372573853, 
fpr: 0.06528189910979229, tpr: 0.39771547248182765, threshold: 0.9999850988388062, 
fpr: 0.06528189910979229, tpr: 0.39979231568016615, threshold: 0.9999847412109375, 
fpr: 0.06824925816023739, tpr: 0.40083073727933544, threshold: 0.9999845027923584, 
fpr: 0.06824925816023739, tpr: 0.40290758047767394, threshold: 0.9999843835830688, 
fpr: 0.06824925816023739, tpr: 0.4039460020768432, threshold: 0.9999842643737793, 
fpr: 0.06824925816023739, tpr: 0.40602284527518173, threshold: 0.9999841451644897, 
fpr: 0.06824925816023739, tpr: 0.4101765316718588, threshold: 0.9999836683273315, 
fpr: 0.06824925816023739, tpr: 0.4122533748701973, threshold: 0.999983549118042, 
fpr: 0.06824925816023739, tpr: 0.4132917964693666, threshold: 0.9999833106994629, 
fpr: 0.06824925816023739, tpr: 0.4153686396677051, threshold: 0.9999830722808838, 
fpr: 0.0712166172106825, tpr: 0.4164070612668744, threshold: 0.9999827146530151, 
fpr: 0.0712166172106825, tpr: 0.4226375908618899, threshold: 0.9999806880950928, 
fpr: 0.07418397626112759, tpr: 0.4236760124610592, threshold: 0.9999805688858032, 
fpr: 0.07418397626112759, tpr: 0.4257528556593977, threshold: 0.9999803304672241, 
fpr: 0.07418397626112759, tpr: 0.42782969885773625, threshold: 0.999980092048645, 
fpr: 0.07418397626112759, tpr: 0.43198338525441327, threshold: 0.9999797344207764, 
fpr: 0.07418397626112759, tpr: 0.43613707165109034, threshold: 0.9999783039093018, 
fpr: 0.07418397626112759, tpr: 0.43821391484942884, threshold: 0.9999781847000122, 
fpr: 0.07418397626112759, tpr: 0.4392523364485981, threshold: 0.9999778270721436, 
fpr: 0.07418397626112759, tpr: 0.44132917964693663, threshold: 0.9999775886535645, 
fpr: 0.07418397626112759, tpr: 0.45482866043613707, threshold: 0.9999728202819824, 
fpr: 0.0771513353115727, tpr: 0.45482866043613707, threshold: 0.9999724626541138, 
fpr: 0.0771513353115727, tpr: 0.45794392523364486, threshold: 0.9999715089797974, 
fpr: 0.0771513353115727, tpr: 0.46105919003115264, threshold: 0.9999711513519287, 
fpr: 0.0771513353115727, tpr: 0.46313603322949115, threshold: 0.9999710321426392, 
fpr: 0.0771513353115727, tpr: 0.4714434060228453, threshold: 0.999969482421875, 
fpr: 0.0771513353115727, tpr: 0.4735202492211838, threshold: 0.9999692440032959, 
fpr: 0.0771513353115727, tpr: 0.4787123572170301, threshold: 0.9999676942825317, 
fpr: 0.0771513353115727, tpr: 0.48078920041536866, threshold: 0.9999675750732422, 
fpr: 0.0771513353115727, tpr: 0.49117341640706125, threshold: 0.9999638795852661, 
fpr: 0.08011869436201781, tpr: 0.49117341640706125, threshold: 0.9999637603759766, 
fpr: 0.08011869436201781, tpr: 0.5005192107995846, threshold: 0.9999599456787109, 
fpr: 0.0830860534124629, tpr: 0.5005192107995846, threshold: 0.9999597072601318, 
fpr: 0.0830860534124629, tpr: 0.5025960539979232, threshold: 0.9999595880508423, 
fpr: 0.0830860534124629, tpr: 0.5046728971962616, threshold: 0.9999591112136841, 
fpr: 0.08605341246290801, tpr: 0.5046728971962616, threshold: 0.9999587535858154, 
fpr: 0.08605341246290801, tpr: 0.5077881619937694, threshold: 0.9999572038650513, 
fpr: 0.08605341246290801, tpr: 0.509865005192108, threshold: 0.999956488609314, 
fpr: 0.08605341246290801, tpr: 0.5119418483904465, threshold: 0.9999556541442871, 
fpr: 0.08605341246290801, tpr: 0.5160955347871236, threshold: 0.999954342842102, 
fpr: 0.08605341246290801, tpr: 0.5181723779854621, threshold: 0.9999533891677856, 
fpr: 0.08605341246290801, tpr: 0.5202492211838006, threshold: 0.9999532699584961, 
fpr: 0.08605341246290801, tpr: 0.5212876427829699, threshold: 0.9999531507492065, 
fpr: 0.08605341246290801, tpr: 0.5244029075804777, threshold: 0.9999529123306274, 
fpr: 0.08605341246290801, tpr: 0.5275181723779855, threshold: 0.9999508857727051, 
fpr: 0.08605341246290801, tpr: 0.5295950155763239, threshold: 0.9999507665634155, 
fpr: 0.08605341246290801, tpr: 0.553478712357217, threshold: 0.9999372959136963, 
fpr: 0.08902077151335312, tpr: 0.553478712357217, threshold: 0.9999366998672485, 
fpr: 0.08902077151335312, tpr: 0.5700934579439252, threshold: 0.9999216794967651, 
fpr: 0.09198813056379822, tpr: 0.5700934579439252, threshold: 0.9999215602874756, 
fpr: 0.09198813056379822, tpr: 0.5742471443406023, threshold: 0.9999204874038696, 
fpr: 0.09495548961424333, tpr: 0.5742471443406023, threshold: 0.9999185800552368, 
fpr: 0.09495548961424333, tpr: 0.5784008307372793, threshold: 0.9999147653579712, 
fpr: 0.09792284866468842, tpr: 0.5794392523364486, threshold: 0.999914288520813, 
fpr: 0.09792284866468842, tpr: 0.5835929387331257, threshold: 0.9999109506607056, 
fpr: 0.10089020771513353, tpr: 0.5835929387331257, threshold: 0.9999104738235474, 
fpr: 0.10089020771513353, tpr: 0.5856697819314641, threshold: 0.9999083280563354, 
fpr: 0.10385756676557864, tpr: 0.5856697819314641, threshold: 0.9999070167541504, 
fpr: 0.10385756676557864, tpr: 0.592938733125649, threshold: 0.9999010562896729, 
fpr: 0.10385756676557864, tpr: 0.5950155763239875, threshold: 0.9999006986618042, 
fpr: 0.10385756676557864, tpr: 0.6002076843198338, threshold: 0.9998964071273804, 
fpr: 0.10385756676557864, tpr: 0.6022845275181724, threshold: 0.9998959302902222, 
fpr: 0.10385756676557864, tpr: 0.6105919003115264, threshold: 0.9998897314071655, 
fpr: 0.10682492581602374, tpr: 0.6105919003115264, threshold: 0.9998874664306641, 
fpr: 0.10682492581602374, tpr: 0.616822429906542, threshold: 0.9998836517333984, 
fpr: 0.10682492581602374, tpr: 0.6188992731048806, threshold: 0.9998811483383179, 
fpr: 0.10682492581602374, tpr: 0.6199376947040498, threshold: 0.9998773336410522, 
fpr: 0.10979228486646884, tpr: 0.6199376947040498, threshold: 0.9998750686645508, 
fpr: 0.11275964391691394, tpr: 0.6209761163032191, threshold: 0.9998748302459717, 
fpr: 0.11275964391691394, tpr: 0.6272066458982347, threshold: 0.9998701810836792, 
fpr: 0.11275964391691394, tpr: 0.6292834890965732, threshold: 0.9998694658279419, 
fpr: 0.11275964391691394, tpr: 0.6303219106957425, threshold: 0.9998689889907837, 
fpr: 0.11275964391691394, tpr: 0.632398753894081, threshold: 0.9998681545257568, 
fpr: 0.11275964391691394, tpr: 0.6386292834890965, threshold: 0.9998630285263062, 
fpr: 0.11275964391691394, tpr: 0.6407061266874351, threshold: 0.999860405921936, 
fpr: 0.11275964391691394, tpr: 0.6500519210799585, threshold: 0.9998478889465332, 
fpr: 0.11572700296735905, tpr: 0.6500519210799585, threshold: 0.9998462200164795, 
fpr: 0.11572700296735905, tpr: 0.6510903426791277, threshold: 0.9998375177383423, 
fpr: 0.11869436201780416, tpr: 0.6510903426791277, threshold: 0.9998301267623901, 
fpr: 0.11869436201780416, tpr: 0.656282450674974, threshold: 0.9998248219490051, 
fpr: 0.11869436201780416, tpr: 0.6583592938733126, threshold: 0.9998220801353455, 
fpr: 0.12166172106824925, tpr: 0.6583592938733126, threshold: 0.9998193383216858, 
fpr: 0.12166172106824925, tpr: 0.6625129802699896, threshold: 0.9998148083686829, 
fpr: 0.12462908011869436, tpr: 0.6625129802699896, threshold: 0.9998106360435486, 
fpr: 0.12462908011869436, tpr: 0.6708203530633438, threshold: 0.9998019337654114, 
fpr: 0.12462908011869436, tpr: 0.6728971962616822, threshold: 0.9998005032539368, 
fpr: 0.12462908011869436, tpr: 0.6739356178608515, threshold: 0.9998001456260681, 
fpr: 0.12759643916913946, tpr: 0.6739356178608515, threshold: 0.999798595905304, 
fpr: 0.12759643916913946, tpr: 0.6749740394600208, threshold: 0.9997981190681458, 
fpr: 0.13353115727002968, tpr: 0.6749740394600208, threshold: 0.9997976422309875, 
fpr: 0.13353115727002968, tpr: 0.6780893042575286, threshold: 0.9997939467430115, 
fpr: 0.13649851632047477, tpr: 0.6780893042575286, threshold: 0.999792754650116, 
fpr: 0.13649851632047477, tpr: 0.6791277258566978, threshold: 0.9997838139533997, 
fpr: 0.1394658753709199, tpr: 0.6791277258566978, threshold: 0.9997829794883728, 
fpr: 0.1394658753709199, tpr: 0.6843198338525441, threshold: 0.9997718930244446, 
fpr: 0.142433234421365, tpr: 0.6853582554517134, threshold: 0.9997667670249939, 
fpr: 0.142433234421365, tpr: 0.6863966770508827, threshold: 0.9997658133506775, 
fpr: 0.14540059347181009, tpr: 0.6863966770508827, threshold: 0.9997627139091492, 
fpr: 0.14540059347181009, tpr: 0.6895119418483905, threshold: 0.9997610449790955, 
fpr: 0.14540059347181009, tpr: 0.6915887850467289, threshold: 0.999757707118988, 
fpr: 0.14540059347181009, tpr: 0.7061266874350987, threshold: 0.9997163414955139, 
fpr: 0.1513353115727003, tpr: 0.7061266874350987, threshold: 0.9996986389160156, 
fpr: 0.1513353115727003, tpr: 0.7133956386292835, threshold: 0.999669075012207, 
fpr: 0.1543026706231454, tpr: 0.7133956386292835, threshold: 0.999667763710022, 
fpr: 0.1543026706231454, tpr: 0.726895119418484, threshold: 0.9995939135551453, 
fpr: 0.16023738872403562, tpr: 0.726895119418484, threshold: 0.9995843768119812, 
fpr: 0.16023738872403562, tpr: 0.7289719626168224, threshold: 0.9995668530464172, 
fpr: 0.1632047477744807, tpr: 0.7289719626168224, threshold: 0.9995661377906799, 
fpr: 0.1632047477744807, tpr: 0.7362409138110073, threshold: 0.9995421171188354, 
fpr: 0.1661721068249258, tpr: 0.7362409138110073, threshold: 0.9995286464691162, 
fpr: 0.1661721068249258, tpr: 0.7455867082035307, threshold: 0.9994900226593018, 
fpr: 0.16913946587537093, tpr: 0.7455867082035307, threshold: 0.9994722008705139, 
fpr: 0.16913946587537093, tpr: 0.7622014537902388, threshold: 0.9993900060653687, 
fpr: 0.17507418397626112, tpr: 0.7622014537902388, threshold: 0.9993601441383362, 
fpr: 0.17507418397626112, tpr: 0.77466251298027, threshold: 0.9991908669471741, 
fpr: 0.17804154302670624, tpr: 0.77466251298027, threshold: 0.9991783499717712, 
fpr: 0.17804154302670624, tpr: 0.778816199376947, threshold: 0.9991674423217773, 
fpr: 0.18397626112759644, tpr: 0.778816199376947, threshold: 0.9991447925567627, 
fpr: 0.18397626112759644, tpr: 0.7808930425752856, threshold: 0.9991287589073181, 
fpr: 0.18694362017804153, tpr: 0.7808930425752856, threshold: 0.9991198182106018, 
fpr: 0.18694362017804153, tpr: 0.7840083073727934, threshold: 0.9990697503089905, 
fpr: 0.18991097922848665, tpr: 0.7840083073727934, threshold: 0.9990522265434265, 
fpr: 0.18991097922848665, tpr: 0.7912772585669782, threshold: 0.9990004897117615, 
fpr: 0.19287833827893175, tpr: 0.7912772585669782, threshold: 0.998977541923523, 
fpr: 0.19287833827893175, tpr: 0.794392523364486, threshold: 0.9989498257637024, 
fpr: 0.19584569732937684, tpr: 0.794392523364486, threshold: 0.9989390969276428, 
fpr: 0.19584569732937684, tpr: 0.8026998961578401, threshold: 0.9988715052604675, 
fpr: 0.19881305637982197, tpr: 0.8026998961578401, threshold: 0.9988473653793335, 
fpr: 0.19881305637982197, tpr: 0.8078920041536864, threshold: 0.998708963394165, 
fpr: 0.20178041543026706, tpr: 0.8078920041536864, threshold: 0.9987078905105591, 
fpr: 0.20178041543026706, tpr: 0.8099688473520249, threshold: 0.998683512210846, 
fpr: 0.20474777448071216, tpr: 0.8099688473520249, threshold: 0.9986762404441833, 
fpr: 0.20474777448071216, tpr: 0.818276220145379, threshold: 0.998572587966919, 
fpr: 0.20771513353115728, tpr: 0.818276220145379, threshold: 0.9985365867614746, 
fpr: 0.20771513353115728, tpr: 0.8255451713395638, threshold: 0.9983274340629578, 
fpr: 0.21068249258160238, tpr: 0.8255451713395638, threshold: 0.9983263611793518, 
fpr: 0.21068249258160238, tpr: 0.8276220145379024, threshold: 0.9983179569244385, 
fpr: 0.21364985163204747, tpr: 0.8276220145379024, threshold: 0.9983158111572266, 
fpr: 0.21364985163204747, tpr: 0.8473520249221184, threshold: 0.9979391694068909, 
fpr: 0.2166172106824926, tpr: 0.8473520249221184, threshold: 0.9978569149971008, 
fpr: 0.2166172106824926, tpr: 0.8546209761163032, threshold: 0.9976966977119446, 
fpr: 0.22255192878338279, tpr: 0.8546209761163032, threshold: 0.9974398612976074, 
fpr: 0.22255192878338279, tpr: 0.8556593977154725, threshold: 0.9974216222763062, 
fpr: 0.22551928783382788, tpr: 0.8556593977154725, threshold: 0.9974051117897034, 
fpr: 0.22551928783382788, tpr: 0.857736240913811, threshold: 0.9971362352371216, 
fpr: 0.228486646884273, tpr: 0.857736240913811, threshold: 0.9970982074737549, 
fpr: 0.228486646884273, tpr: 0.8598130841121495, threshold: 0.9970108270645142, 
fpr: 0.2344213649851632, tpr: 0.8598130841121495, threshold: 0.9968722462654114, 
fpr: 0.2344213649851632, tpr: 0.8618899273104881, threshold: 0.9968067407608032, 
fpr: 0.2403560830860534, tpr: 0.8618899273104881, threshold: 0.9966815114021301, 
fpr: 0.2403560830860534, tpr: 0.8660436137071651, threshold: 0.9962573051452637, 
fpr: 0.24925816023738873, tpr: 0.8660436137071651, threshold: 0.9961867928504944, 
fpr: 0.24925816023738873, tpr: 0.8691588785046729, threshold: 0.9961329698562622, 
fpr: 0.2551928783382789, tpr: 0.8691588785046729, threshold: 0.9959455132484436, 
fpr: 0.2551928783382789, tpr: 0.8733125649013499, threshold: 0.995826005935669, 
fpr: 0.258160237388724, tpr: 0.8733125649013499, threshold: 0.9957940578460693, 
fpr: 0.258160237388724, tpr: 0.8795430944963655, threshold: 0.9954555034637451, 
fpr: 0.27002967359050445, tpr: 0.8795430944963655, threshold: 0.9952486157417297, 
fpr: 0.27002967359050445, tpr: 0.8847352024922118, threshold: 0.9945353269577026, 
fpr: 0.27596439169139464, tpr: 0.8847352024922118, threshold: 0.9935084581375122, 
fpr: 0.27596439169139464, tpr: 0.8888888888888888, threshold: 0.9927904605865479, 
fpr: 0.2789317507418398, tpr: 0.8888888888888888, threshold: 0.9927552342414856, 
fpr: 0.2789317507418398, tpr: 0.8899273104880582, threshold: 0.9925934672355652, 
fpr: 0.2818991097922849, tpr: 0.8899273104880582, threshold: 0.9924817085266113, 
fpr: 0.2818991097922849, tpr: 0.8920041536863966, threshold: 0.9924281239509583, 
fpr: 0.28486646884273, tpr: 0.8920041536863966, threshold: 0.9923932552337646, 
fpr: 0.28486646884273, tpr: 0.8940809968847352, threshold: 0.9921316504478455, 
fpr: 0.2878338278931751, tpr: 0.8940809968847352, threshold: 0.9921289682388306, 
fpr: 0.2878338278931751, tpr: 0.8961578400830738, threshold: 0.9919384121894836, 
fpr: 0.29673590504451036, tpr: 0.8961578400830738, threshold: 0.9910647869110107, 
fpr: 0.29673590504451036, tpr: 0.897196261682243, threshold: 0.991032063961029, 
fpr: 0.3026706231454006, tpr: 0.897196261682243, threshold: 0.9902760982513428, 
fpr: 0.3026706231454006, tpr: 0.8992731048805815, threshold: 0.989520788192749, 
fpr: 0.3115727002967359, tpr: 0.8992731048805815, threshold: 0.9892345666885376, 
fpr: 0.3115727002967359, tpr: 0.9023883696780893, threshold: 0.989085853099823, 
fpr: 0.31750741839762614, tpr: 0.9023883696780893, threshold: 0.9883884787559509, 
fpr: 0.31750741839762614, tpr: 0.9034267912772586, threshold: 0.9880483746528625, 
fpr: 0.32047477744807124, tpr: 0.9034267912772586, threshold: 0.9878000020980835, 
fpr: 0.32047477744807124, tpr: 0.9044652128764278, threshold: 0.9877612590789795, 
fpr: 0.32344213649851633, tpr: 0.9044652128764278, threshold: 0.987453281879425, 
fpr: 0.32344213649851633, tpr: 0.9055036344755971, threshold: 0.9873040318489075, 
fpr: 0.3264094955489614, tpr: 0.9055036344755971, threshold: 0.9872568845748901, 
fpr: 0.3264094955489614, tpr: 0.9117341640706127, threshold: 0.9857110381126404, 
fpr: 0.3293768545994065, tpr: 0.9117341640706127, threshold: 0.9850926995277405, 
fpr: 0.3293768545994065, tpr: 0.9138110072689511, threshold: 0.9849362969398499, 
fpr: 0.3353115727002967, tpr: 0.9138110072689511, threshold: 0.9845261573791504, 
fpr: 0.3353115727002967, tpr: 0.9158878504672897, threshold: 0.9834655523300171, 
fpr: 0.34421364985163205, tpr: 0.9158878504672897, threshold: 0.9809118509292603, 
fpr: 0.34421364985163205, tpr: 0.9179646936656283, threshold: 0.9806766510009766, 
fpr: 0.34718100890207715, tpr: 0.9179646936656283, threshold: 0.9799785017967224, 
fpr: 0.34718100890207715, tpr: 0.9190031152647975, threshold: 0.9798069000244141, 
fpr: 0.3590504451038576, tpr: 0.9190031152647975, threshold: 0.9778842329978943, 
fpr: 0.3590504451038576, tpr: 0.9200415368639667, threshold: 0.9776606559753418, 
fpr: 0.3620178041543027, tpr: 0.9200415368639667, threshold: 0.977000892162323, 
fpr: 0.3620178041543027, tpr: 0.9252336448598131, threshold: 0.9740321040153503, 
fpr: 0.36795252225519287, tpr: 0.9252336448598131, threshold: 0.970481276512146, 
fpr: 0.36795252225519287, tpr: 0.9262720664589823, threshold: 0.9691749215126038, 
fpr: 0.37388724035608306, tpr: 0.9262720664589823, threshold: 0.9663867354393005, 
fpr: 0.37388724035608306, tpr: 0.9293873312564901, threshold: 0.9649640321731567, 
fpr: 0.3768545994065282, tpr: 0.9293873312564901, threshold: 0.964296817779541, 
fpr: 0.3768545994065282, tpr: 0.9304257528556594, threshold: 0.96402508020401, 
fpr: 0.3798219584569733, tpr: 0.9304257528556594, threshold: 0.9631608724594116, 
fpr: 0.3798219584569733, tpr: 0.9325025960539979, threshold: 0.96045982837677, 
fpr: 0.3827893175074184, tpr: 0.9325025960539979, threshold: 0.9584226608276367, 
fpr: 0.3827893175074184, tpr: 0.9345794392523364, threshold: 0.9554519057273865, 
fpr: 0.3887240356083086, tpr: 0.9345794392523364, threshold: 0.955161452293396, 
fpr: 0.3887240356083086, tpr: 0.9356178608515057, threshold: 0.9550938010215759, 
fpr: 0.3916913946587537, tpr: 0.9356178608515057, threshold: 0.9536915421485901, 
fpr: 0.3916913946587537, tpr: 0.936656282450675, threshold: 0.9526361227035522, 
fpr: 0.39762611275964393, tpr: 0.936656282450675, threshold: 0.9481396675109863, 
fpr: 0.39762611275964393, tpr: 0.9376947040498442, threshold: 0.9473567605018616, 
fpr: 0.40059347181008903, tpr: 0.9376947040498442, threshold: 0.9468370676040649, 
fpr: 0.40059347181008903, tpr: 0.9387331256490135, threshold: 0.9464014172554016, 
fpr: 0.4035608308605341, tpr: 0.9387331256490135, threshold: 0.9451234936714172, 
fpr: 0.4035608308605341, tpr: 0.9397715472481828, threshold: 0.9445288181304932, 
fpr: 0.4094955489614243, tpr: 0.9397715472481828, threshold: 0.9419293403625488, 
fpr: 0.4094955489614243, tpr: 0.940809968847352, threshold: 0.941290557384491, 
fpr: 0.4124629080118694, tpr: 0.940809968847352, threshold: 0.9403588175773621, 
fpr: 0.4124629080118694, tpr: 0.9418483904465212, threshold: 0.9381281733512878, 
fpr: 0.41543026706231456, tpr: 0.9418483904465212, threshold: 0.9379567503929138, 
fpr: 0.41543026706231456, tpr: 0.9428868120456906, threshold: 0.9329817891120911, 
fpr: 0.42136498516320475, tpr: 0.9428868120456906, threshold: 0.9278138279914856, 
fpr: 0.42136498516320475, tpr: 0.944963655244029, threshold: 0.9254966378211975, 
fpr: 0.42729970326409494, tpr: 0.944963655244029, threshold: 0.9248073101043701, 
fpr: 0.42729970326409494, tpr: 0.9460020768431984, threshold: 0.9227370619773865, 
fpr: 0.43026706231454004, tpr: 0.9460020768431984, threshold: 0.9194023609161377, 
fpr: 0.43026706231454004, tpr: 0.9511941848390446, threshold: 0.9090961217880249, 
fpr: 0.4332344213649852, tpr: 0.9511941848390446, threshold: 0.9061247110366821, 
fpr: 0.4332344213649852, tpr: 0.952232606438214, threshold: 0.9052695631980896, 
fpr: 0.4391691394658754, tpr: 0.952232606438214, threshold: 0.9043999314308167, 
fpr: 0.4391691394658754, tpr: 0.9543094496365524, threshold: 0.8871029019355774, 
fpr: 0.44510385756676557, tpr: 0.9543094496365524, threshold: 0.8839848637580872, 
fpr: 0.44510385756676557, tpr: 0.9553478712357217, threshold: 0.8812922239303589, 
fpr: 0.44807121661721067, tpr: 0.9553478712357217, threshold: 0.879725992679596, 
fpr: 0.44807121661721067, tpr: 0.9584631360332295, threshold: 0.8617382049560547, 
fpr: 0.45103857566765576, tpr: 0.9584631360332295, threshold: 0.8499482274055481, 
fpr: 0.45103857566765576, tpr: 0.9595015576323987, threshold: 0.8397776484489441, 
fpr: 0.456973293768546, tpr: 0.9595015576323987, threshold: 0.8311777114868164, 
fpr: 0.456973293768546, tpr: 0.9615784008307373, threshold: 0.8168341517448425, 
fpr: 0.4599406528189911, tpr: 0.9615784008307373, threshold: 0.8109775185585022, 
fpr: 0.4599406528189911, tpr: 0.9626168224299065, threshold: 0.8086631894111633, 
fpr: 0.47477744807121663, tpr: 0.9626168224299065, threshold: 0.7936727404594421, 
fpr: 0.47477744807121663, tpr: 0.9636552440290758, threshold: 0.7894983887672424, 
fpr: 0.47774480712166173, tpr: 0.9636552440290758, threshold: 0.7886890769004822, 
fpr: 0.47774480712166173, tpr: 0.9646936656282451, threshold: 0.7835347056388855, 
fpr: 0.4836795252225519, tpr: 0.9646936656282451, threshold: 0.777879536151886, 
fpr: 0.4836795252225519, tpr: 0.9678089304257529, threshold: 0.7633695006370544, 
fpr: 0.486646884272997, tpr: 0.9678089304257529, threshold: 0.7605442404747009, 
fpr: 0.486646884272997, tpr: 0.9688473520249221, threshold: 0.7535813450813293, 
fpr: 0.4896142433234421, tpr: 0.9688473520249221, threshold: 0.7451553344726562, 
fpr: 0.4896142433234421, tpr: 0.9698857736240913, threshold: 0.7317238450050354, 
fpr: 0.49851632047477745, tpr: 0.9698857736240913, threshold: 0.7078675031661987, 
fpr: 0.49851632047477745, tpr: 0.9709241952232607, threshold: 0.7068232893943787, 
fpr: 0.5341246290801187, tpr: 0.9709241952232607, threshold: 0.5454471111297607, 
fpr: 0.5341246290801187, tpr: 0.9750778816199377, threshold: 0.49988189339637756, 
fpr: 0.6083086053412463, tpr: 0.9750778816199377, threshold: 0.2502063512802124, 
fpr: 0.6083086053412463, tpr: 0.9761163032191069, threshold: 0.24059537053108215, 
fpr: 0.6201780415430267, tpr: 0.9761163032191069, threshold: 0.21896947920322418, 
fpr: 0.6201780415430267, tpr: 0.9771547248182763, threshold: 0.21874216198921204, 
fpr: 0.6231454005934718, tpr: 0.9771547248182763, threshold: 0.21603021025657654, 
fpr: 0.6231454005934718, tpr: 0.9781931464174455, threshold: 0.21501559019088745, 
fpr: 0.6409495548961425, tpr: 0.9781931464174455, threshold: 0.189830482006073, 
fpr: 0.6409495548961425, tpr: 0.9792315680166147, threshold: 0.18155431747436523, 
fpr: 0.655786350148368, tpr: 0.9792315680166147, threshold: 0.1612892746925354, 
fpr: 0.655786350148368, tpr: 0.980269989615784, threshold: 0.16121028363704681, 
fpr: 0.6646884272997032, tpr: 0.980269989615784, threshold: 0.14251728355884552, 
fpr: 0.6646884272997032, tpr: 0.9823468328141225, threshold: 0.13075914978981018, 
fpr: 0.6824925816023739, tpr: 0.9823468328141225, threshold: 0.10193371027708054, 
fpr: 0.6824925816023739, tpr: 0.9833852544132918, threshold: 0.10082300007343292, 
fpr: 0.6913946587537092, tpr: 0.9833852544132918, threshold: 0.06923079490661621, 
fpr: 0.6913946587537092, tpr: 0.9844236760124611, threshold: 0.0691353902220726, 
fpr: 0.7091988130563798, tpr: 0.9844236760124611, threshold: 0.06264433264732361, 
fpr: 0.7091988130563798, tpr: 0.9865005192107996, threshold: 0.05107088014483452, 
fpr: 0.712166172106825, tpr: 0.9865005192107996, threshold: 0.04835811257362366, 
fpr: 0.712166172106825, tpr: 0.9875389408099688, threshold: 0.04702683910727501, 
fpr: 0.7299703264094956, tpr: 0.9875389408099688, threshold: 0.038521409034729004, 
fpr: 0.7299703264094956, tpr: 0.9885773624091381, threshold: 0.03812077268958092, 
fpr: 0.7359050445103857, tpr: 0.9885773624091381, threshold: 0.03534585237503052, 
fpr: 0.7359050445103857, tpr: 0.9896157840083074, threshold: 0.03360351547598839, 
fpr: 0.7922848664688428, tpr: 0.9896157840083074, threshold: 0.013555465266108513, 
fpr: 0.7922848664688428, tpr: 0.9906542056074766, threshold: 0.01326162088662386, 
fpr: 0.8249258160237388, tpr: 0.9906542056074766, threshold: 0.006833537016063929, 
fpr: 0.8249258160237388, tpr: 0.9916926272066459, threshold: 0.006641106680035591, 
fpr: 0.8545994065281899, tpr: 0.9916926272066459, threshold: 0.00441420404240489, 
fpr: 0.8545994065281899, tpr: 0.9927310488058152, threshold: 0.003921953961253166, 
fpr: 0.8694362017804155, tpr: 0.9927310488058152, threshold: 0.0029702994506806135, 
fpr: 0.8694362017804155, tpr: 0.9948078920041536, threshold: 0.002736716764047742, 
fpr: 0.8813056379821959, tpr: 0.9948078920041536, threshold: 0.0023110120091587305, 
fpr: 0.8813056379821959, tpr: 0.995846313603323, threshold: 0.002281937748193741, 
fpr: 0.9050445103857567, tpr: 0.995846313603323, threshold: 0.00154669932089746, 
fpr: 0.9050445103857567, tpr: 0.9968847352024922, threshold: 0.0013055376475676894, 
fpr: 0.9258160237388724, tpr: 0.9968847352024922, threshold: 0.0009251750307157636, 
fpr: 0.9258160237388724, tpr: 0.9979231568016614, threshold: 0.0008954752120189369, 
fpr: 0.9436201780415431, tpr: 0.9979231568016614, threshold: 0.00045477476669475436, 
fpr: 0.9436201780415431, tpr: 0.9989615784008308, threshold: 0.00034193284227512777, 
fpr: 0.9643916913946587, tpr: 0.9989615784008308, threshold: 0.00018287819693796337, 
fpr: 0.9643916913946587, tpr: 1.0, threshold: 0.00011735060979845002, 
fpr: 1.0, tpr: 1.0, threshold: 3.647682660812279e-06, 

=== best_threshold: 0.9976966977119446, best_fpr: 0.2166172106824926, best_tpr: 0.8546209761163032 ===
