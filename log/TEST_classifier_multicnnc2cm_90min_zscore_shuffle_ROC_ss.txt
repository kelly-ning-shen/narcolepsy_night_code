cuda:0
Subjects num: 78

90min inputs: chc001-nsrr (4)
90min inputs: chc004-nsrr (5)
90min inputs: chc005-nsrr (5)
90min inputs: chc006-nsrr (4)
90min inputs: chc008-nsrr (5)
90min inputs: chc009-nsrr (4)
90min inputs: chc010-nsrr (4)
90min inputs: chc012-nsrr (5)
90min inputs: chc013-nsrr (5)
90min inputs: chc014-nsrr (5)
90min inputs: chc015-nsrr (5)
90min inputs: chc016-nsrr (5)
90min inputs: chc022-nsrr (4)
90min inputs: chc025-nsrr (4)
90min inputs: chc027-nsrr (5)
90min inputs: chc028-nsrr (4)
90min inputs: chc033-nsrr (4)
90min inputs: chc035-nsrr (5)
90min inputs: chc037-nsrr (4)
90min inputs: chc040-nsrr (6)
90min inputs: chc041-nsrr (4)
90min inputs: chc052-nsrr (5)
90min inputs: chc056-nsrr (5)
90min inputs: chp001-nsrr (6)
90min inputs: chp002-nsrr (6)
90min inputs: chp003-nsrr (5)
90min inputs: chp004-nsrr (5)
90min inputs: chp005-nsrr (7)
90min inputs: chp006-nsrr (6)
90min inputs: chp007-nsrr (6)
90min inputs: chp008-nsrr (5)
90min inputs: chp009-nsrr (5)
90min inputs: chp010-nsrr (5)
90min inputs: chp011-nsrr (5)
90min inputs: chp012-nsrr (6)
90min inputs: chp013-nsrr (5)
90min inputs: chp014-nsrr (5)
90min inputs: chp015-nsrr (6)
90min inputs: chp016-nsrr (7)
90min inputs: chp017-nsrr (5)
90min inputs: chp018-nsrr (6)
90min inputs: chp019-nsrr (5)
90min inputs: chp020-nsrr (6)
90min inputs: chp022-nsrr (7)
90min inputs: chp024-nsrr (6)
90min inputs: chp025-nsrr (2)
90min inputs: chp026-nsrr (5)
90min inputs: chp028-nsrr (5)
90min inputs: chp029-nsrr (5)
90min inputs: chp030-nsrr (6)
90min inputs: chp031-nsrr (6)
90min inputs: chp032-nsrr (5)
90min inputs: chp033-nsrr (5)
90min inputs: chp034-nsrr (5)
90min inputs: chp036-nsrr (7)
90min inputs: chp037-nsrr (5)
90min inputs: chp038-nsrr (5)
90min inputs: chp039-nsrr (6)
90min inputs: chp040-nsrr (5)
90min inputs: chp041-nsrr (6)
90min inputs: chp042-nsrr (6)
90min inputs: chp043-nsrr (6)
90min inputs: chp044-nsrr (5)
90min inputs: chp045-nsrr (6)
90min inputs: chp046-nsrr (6)
90min inputs: chp047-nsrr (4)
90min inputs: chp048-nsrr (5)
90min inputs: chp049-nsrr (6)
90min inputs: chp051-nsrr (6)
90min inputs: chp052-nsrr (5)
90min inputs: chp053-nsrr (6)
90min inputs: chp054-nsrr (6)
90min inputs: chp055-nsrr (6)
90min inputs: chp056-nsrr (6)
90min inputs: chp057-nsrr (6)
90min inputs: chp058-nsrr (5)
90min inputs: chp059-nsrr (6)
90min inputs: chp060-nsrr (7)

=== Test on chc001-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5260666817426682
Starting epoch 2/10.
Epoch finished! Loss: 1.376954770088196
Starting epoch 3/10.
Epoch finished! Loss: 1.2813402354717254
Starting epoch 4/10.
Epoch finished! Loss: 1.1696390703320503
Starting epoch 5/10.
Epoch finished! Loss: 1.0889376312494279
Starting epoch 6/10.
Epoch finished! Loss: 1.0033905610442162
Starting epoch 7/10.
Epoch finished! Loss: 0.9399067834019661
Starting epoch 8/10.
Epoch finished! Loss: 0.8957658275961876
Starting epoch 9/10.
Epoch finished! Loss: 0.873411214351654
Starting epoch 10/10.
Epoch finished! Loss: 0.8173553451895714
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8402777777777778
              precision    recall  f1-score   support

         0.0       0.58      1.00      0.74        77
         1.0       0.00      0.00      0.00        48
         2.0       0.89      0.94      0.92       340
         3.0       0.92      0.98      0.95       143
         4.0       0.88      0.61      0.72       112

    accuracy                           0.84       720
   macro avg       0.66      0.71      0.66       720
weighted avg       0.80      0.84      0.81       720
 


====== chc001-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  92.36  100.00   91.45  58.33     73.68
1  93.33    0.00  100.00   0.00      0.00
2  91.81   94.12   89.74  89.14     91.56
3  97.92   97.90   97.92  92.11     94.92
4  92.64   60.71   98.52  88.31     71.96
Total accuracy: 84.03%
Average sen: 70.55%
Average spec: 95.52%
Macro f1-score: 66.42%

=== Test on chc004-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5271662652492524
Starting epoch 2/10.
Epoch finished! Loss: 1.3493514686822892
Starting epoch 3/10.
Epoch finished! Loss: 1.2328122019767762
Starting epoch 4/10.
Epoch finished! Loss: 1.139232325553894
Starting epoch 5/10.
Epoch finished! Loss: 1.0737584114074707
Starting epoch 6/10.
Epoch finished! Loss: 1.0050102040171622
Starting epoch 7/10.
Epoch finished! Loss: 0.9506285056471825
Starting epoch 8/10.
Epoch finished! Loss: 0.912945619225502
Starting epoch 9/10.
Epoch finished! Loss: 0.872946372628212
Starting epoch 10/10.
Epoch finished! Loss: 0.8295564010739327
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7311111111111112
              precision    recall  f1-score   support

         0.0       0.47      1.00      0.64        74
         1.0       0.12      0.20      0.15        41
         2.0       0.84      0.85      0.84       467
         3.0       0.98      0.62      0.76       203
         4.0       0.72      0.48      0.58       115

    accuracy                           0.73       900
   macro avg       0.63      0.63      0.59       900
weighted avg       0.79      0.73      0.74       900
 


====== chc004-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  90.78  100.00   89.95  47.13     64.07
1  90.00   19.51   93.36  12.31     15.09
2  83.33   84.58   81.99  83.51     84.04
3  91.11   62.07   99.57  97.67     75.90
4  91.00   47.83   97.32  72.37     57.59
Total accuracy: 73.11%
Average sen: 62.80%
Average spec: 92.44%
Macro f1-score: 59.34%

=== Test on chc005-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.569566810131073
Starting epoch 2/10.
Epoch finished! Loss: 1.408417448401451
Starting epoch 3/10.
Epoch finished! Loss: 1.252178856730461
Starting epoch 4/10.
Epoch finished! Loss: 1.1483075857162475
Starting epoch 5/10.
Epoch finished! Loss: 1.0787911891937256
Starting epoch 6/10.
Epoch finished! Loss: 1.0142412185668945
Starting epoch 7/10.
Epoch finished! Loss: 0.9859629720449448
Starting epoch 8/10.
Epoch finished! Loss: 0.9273453667759896
Starting epoch 9/10.
Epoch finished! Loss: 0.8962139800190926
Starting epoch 10/10.
Epoch finished! Loss: 0.862368443608284
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8011111111111111
              precision    recall  f1-score   support

         0.0       0.69      1.00      0.82        40
         1.0       0.00      0.00      0.00        30
         2.0       0.78      0.96      0.86       504
         3.0       0.99      0.51      0.68       236
         4.0       0.80      0.82      0.81        90

    accuracy                           0.80       900
   macro avg       0.65      0.66      0.63       900
weighted avg       0.80      0.80      0.78       900
 


====== chc005-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  98.00  100.00   97.91  68.97     81.63
1  96.67    0.00  100.00   0.00      0.00
2  82.33   96.43   64.39  77.51     85.94
3  87.11   51.27   99.85  99.18     67.60
4  96.11   82.22   97.65  79.57     80.87
Total accuracy: 80.11%
Average sen: 65.98%
Average spec: 91.96%
Macro f1-score: 63.21%

=== Test on chc006-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.424827265739441
Starting epoch 2/10.
Epoch finished! Loss: 1.2569706708192825
Starting epoch 3/10.
Epoch finished! Loss: 1.1502595841884613
Starting epoch 4/10.
Epoch finished! Loss: 1.0589735314249993
Starting epoch 5/10.
Epoch finished! Loss: 0.9979526400566101
Starting epoch 6/10.
Epoch finished! Loss: 0.9281346663832665
Starting epoch 7/10.
Epoch finished! Loss: 0.8889689102768898
Starting epoch 8/10.
Epoch finished! Loss: 0.8553525611758233
Starting epoch 9/10.
Epoch finished! Loss: 0.8234674483537674
Starting epoch 10/10.
Epoch finished! Loss: 0.7941132843494415
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6722222222222223
              precision    recall  f1-score   support

         0.0       1.00      0.57      0.73       103
         1.0       0.21      0.03      0.06        87
         2.0       0.59      1.00      0.74       300
         3.0       1.00      0.47      0.64       133
         4.0       0.78      0.62      0.69        97

    accuracy                           0.67       720
   macro avg       0.72      0.54      0.57       720
weighted avg       0.70      0.67      0.63       720
 


====== chc006-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  93.89   57.28  100.00  100.00     72.84
1  86.81    3.45   98.26   21.43      5.94
2  71.11  100.00   50.48   59.06     74.26
3  90.14   46.62  100.00  100.00     63.59
4  92.50   61.86   97.27   77.92     68.97
Total accuracy: 67.22%
Average sen: 53.84%
Average spec: 89.20%
Macro f1-score: 57.12%

=== Test on chc008-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.523758727312088
Starting epoch 2/10.
Epoch finished! Loss: 1.3822993099689485
Starting epoch 3/10.
Epoch finished! Loss: 1.2800278216600418
Starting epoch 4/10.
Epoch finished! Loss: 1.1879566311836243
Starting epoch 5/10.
Epoch finished! Loss: 1.0944146811962128
Starting epoch 6/10.
Epoch finished! Loss: 1.0213770002126694
Starting epoch 7/10.
Epoch finished! Loss: 0.9512472003698349
Starting epoch 8/10.
Epoch finished! Loss: 0.9008601024746895
Starting epoch 9/10.
Epoch finished! Loss: 0.8430384516716003
Starting epoch 10/10.
Epoch finished! Loss: 0.834566330909729
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7377777777777778
              precision    recall  f1-score   support

         0.0       0.63      0.99      0.77       144
         1.0       0.00      0.00      0.00        80
         2.0       0.73      0.85      0.78       344
         3.0       1.00      0.60      0.75       227
         4.0       0.68      0.90      0.78       105

    accuracy                           0.74       900
   macro avg       0.61      0.67      0.62       900
weighted avg       0.71      0.74      0.70       900
 


====== chc008-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  90.67  98.61   89.15   63.39     77.17
1  91.11   0.00  100.00    0.00      0.00
2  81.89  84.59   80.22   72.57     78.12
3  89.89  59.91  100.00  100.00     74.93
4  94.00  90.48   94.47   68.35     77.87
Total accuracy: 73.78%
Average sen: 66.72%
Average spec: 92.77%
Macro f1-score: 61.62%

=== Test on chc009-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4747804969549179
Starting epoch 2/10.
Epoch finished! Loss: 1.3592091143131255
Starting epoch 3/10.
Epoch finished! Loss: 1.2620607167482376
Starting epoch 4/10.
Epoch finished! Loss: 1.1874917030334473
Starting epoch 5/10.
Epoch finished! Loss: 1.1091842904686928
Starting epoch 6/10.
Epoch finished! Loss: 1.0636224433779717
Starting epoch 7/10.
Epoch finished! Loss: 0.9920742452144623
Starting epoch 8/10.
Epoch finished! Loss: 0.9405778720974922
Starting epoch 9/10.
Epoch finished! Loss: 0.9029185846447945
Starting epoch 10/10.
Epoch finished! Loss: 0.8859515979886055
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8097222222222222
              precision    recall  f1-score   support

         0.0       0.93      0.96      0.95        57
         1.0       0.00      0.00      0.00        36
         2.0       0.75      0.99      0.85       376
         3.0       0.99      0.63      0.77       196
         4.0       0.84      0.56      0.67        55

    accuracy                           0.81       720
   macro avg       0.70      0.63      0.65       720
weighted avg       0.80      0.81      0.78       720
 


====== chc009-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  99.17  96.49   99.40  93.22     94.83
1  95.00   0.00  100.00   0.00      0.00
2  82.22  99.47   63.37  74.80     85.39
3  89.72  62.76   99.81  99.19     76.88
4  95.83  56.36   99.10  83.78     67.39
Total accuracy: 80.97%
Average sen: 63.02%
Average spec: 92.34%
Macro f1-score: 64.90%

=== Test on chc010-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5037328094244002
Starting epoch 2/10.
Epoch finished! Loss: 1.3489359796047211
Starting epoch 3/10.
Epoch finished! Loss: 1.244701698422432
Starting epoch 4/10.
Epoch finished! Loss: 1.1559934496879578
Starting epoch 5/10.
Epoch finished! Loss: 1.092063094675541
Starting epoch 6/10.
Epoch finished! Loss: 1.0424975365400315
Starting epoch 7/10.
Epoch finished! Loss: 1.0022444993257522
Starting epoch 8/10.
Epoch finished! Loss: 0.966108313202858
Starting epoch 9/10.
Epoch finished! Loss: 0.9387987777590752
Starting epoch 10/10.
Epoch finished! Loss: 0.9098735317587853
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7111111111111111
              precision    recall  f1-score   support

         0.0       0.88      0.81      0.84       123
         1.0       0.42      0.44      0.43        43
         2.0       0.66      0.92      0.77       324
         3.0       1.00      0.09      0.17       149
         4.0       0.84      1.00      0.91        81

    accuracy                           0.71       720
   macro avg       0.76      0.65      0.63       720
weighted avg       0.77      0.71      0.65       720
 


====== chc010-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  94.86   81.30   97.65   87.72     84.39
1  93.06   44.19   96.16   42.22     43.18
2  75.28   91.98   61.62   66.22     77.00
3  81.25    9.40  100.00  100.00     17.18
4  97.78  100.00   97.50   83.51     91.01
Total accuracy: 71.11%
Average sen: 65.37%
Average spec: 90.59%
Macro f1-score: 62.55%

=== Test on chc012-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5980855524539948
Starting epoch 2/10.
Epoch finished! Loss: 1.4816748380661011
Starting epoch 3/10.
Epoch finished! Loss: 1.4069579780101775
Starting epoch 4/10.
Epoch finished! Loss: 1.2858812838792801
Starting epoch 5/10.
Epoch finished! Loss: 1.1898485243320465
Starting epoch 6/10.
Epoch finished! Loss: 1.0897228986024856
Starting epoch 7/10.
Epoch finished! Loss: 1.0251656830310822
Starting epoch 8/10.
Epoch finished! Loss: 0.9574666753411293
Starting epoch 9/10.
Epoch finished! Loss: 0.8986360907554627
Starting epoch 10/10.
Epoch finished! Loss: 0.8653118968009949
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7777777777777778
              precision    recall  f1-score   support

         0.0       0.92      0.70      0.79        63
         1.0       0.36      0.18      0.24        22
         2.0       0.79      0.94      0.86       541
         3.0       0.99      0.41      0.58       204
         4.0       0.54      0.89      0.67        70

    accuracy                           0.78       900
   macro avg       0.72      0.62      0.63       900
weighted avg       0.81      0.78      0.76       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.44  69.84   99.52  91.67     79.28
1  97.22  18.18   99.20  36.36     24.24
2  81.22  93.72   62.40  78.97     85.71
3  86.44  40.69   99.86  98.81     57.64
4  93.22  88.57   93.61  53.91     67.03
Total accuracy: 77.78%
Average sen: 62.20%
Average spec: 90.92%
Macro f1-score: 62.78%

=== Test on chc013-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4970699697732925
Starting epoch 2/10.
Epoch finished! Loss: 1.3444852024316787
Starting epoch 3/10.
Epoch finished! Loss: 1.2321783423423767
Starting epoch 4/10.
Epoch finished! Loss: 1.1253941342234612
Starting epoch 5/10.
Epoch finished! Loss: 1.036439909040928
Starting epoch 6/10.
Epoch finished! Loss: 0.9617807403206825
Starting epoch 7/10.
Epoch finished! Loss: 0.9064624518156051
Starting epoch 8/10.
Epoch finished! Loss: 0.8750823080539704
Starting epoch 9/10.
Epoch finished! Loss: 0.8366807207465172
Starting epoch 10/10.
Epoch finished! Loss: 0.7993793204426766
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.73
              precision    recall  f1-score   support

         0.0       0.75      0.80      0.77        69
         1.0       0.22      0.50      0.31        38
         2.0       0.77      0.71      0.74       410
         3.0       1.00      0.63      0.77       228
         4.0       0.67      0.95      0.78       155

    accuracy                           0.73       900
   macro avg       0.68      0.72      0.68       900
weighted avg       0.79      0.73      0.74       900
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.44  79.71   97.83   75.34     77.46
1  90.44  50.00   92.23   22.09     30.65
2  77.44  71.22   82.65   77.45     74.21
3  90.67  63.16  100.00  100.00     77.42
4  91.00  94.84   90.20   66.82     78.40
Total accuracy: 73.00%
Average sen: 71.79%
Average spec: 92.58%
Macro f1-score: 67.63%

=== Test on chc014-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.388710129261017
Starting epoch 2/10.
Epoch finished! Loss: 1.238259294629097
Starting epoch 3/10.
Epoch finished! Loss: 1.1469335228204727
Starting epoch 4/10.
Epoch finished! Loss: 1.0713128566741943
Starting epoch 5/10.
Epoch finished! Loss: 1.0272841304540634
Starting epoch 6/10.
Epoch finished! Loss: 0.9815502911806107
Starting epoch 7/10.
Epoch finished! Loss: 0.9451113373041153
Starting epoch 8/10.
Epoch finished! Loss: 0.9486002385616302
Starting epoch 9/10.
Epoch finished! Loss: 0.9084424301981926
Starting epoch 10/10.
Epoch finished! Loss: 0.8944292187690734
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8833333333333333
              precision    recall  f1-score   support

         0.0       0.96      1.00      0.98       240
         1.0       0.00      0.00      0.00         6
         2.0       0.82      0.98      0.90       436
         3.0       0.99      0.63      0.77       143
         4.0       0.90      0.49      0.64        75

    accuracy                           0.88       900
   macro avg       0.74      0.62      0.66       900
weighted avg       0.89      0.88      0.87       900
 


====== chc014-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  99.00  100.00   98.64  96.39     98.16
1  99.33    0.00  100.00   0.00      0.00
2  89.00   98.17   80.39  82.47     89.63
3  94.00   62.94   99.87  98.90     76.92
4  95.33   49.33   99.52  90.24     63.79
Total accuracy: 88.33%
Average sen: 62.09%
Average spec: 95.68%
Macro f1-score: 65.70%

=== Test on chc015-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5575520396232605
Starting epoch 2/10.
Epoch finished! Loss: 1.3926502078771592
Starting epoch 3/10.
Epoch finished! Loss: 1.2751631706953048
Starting epoch 4/10.
Epoch finished! Loss: 1.1825675874948502
Starting epoch 5/10.
Epoch finished! Loss: 1.0870489537715913
Starting epoch 6/10.
Epoch finished! Loss: 1.0255295917391778
Starting epoch 7/10.
Epoch finished! Loss: 0.9792053759098053
Starting epoch 8/10.
Epoch finished! Loss: 0.9200313642621041
Starting epoch 9/10.
Epoch finished! Loss: 0.8982398316264153
Starting epoch 10/10.
Epoch finished! Loss: 0.8779706194996834
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7444444444444445
              precision    recall  f1-score   support

         0.0       0.62      0.76      0.68        37
         1.0       0.00      0.00      0.00        82
         2.0       0.72      0.98      0.83       474
         3.0       0.92      0.50      0.65       166
         4.0       0.79      0.66      0.72       141

    accuracy                           0.74       900
   macro avg       0.61      0.58      0.58       900
weighted avg       0.70      0.74      0.70       900
 


====== chc015-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  97.11  75.68   98.03  62.22     68.29
1  90.89   0.00  100.00   0.00      0.00
2  78.89  98.31   57.28  71.91     83.07
3  90.00  50.00   99.05  92.22     64.84
4  92.00  65.96   96.84  79.49     72.09
Total accuracy: 74.44%
Average sen: 57.99%
Average spec: 90.24%
Macro f1-score: 57.66%

=== Test on chc016-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4973489880561828
Starting epoch 2/10.
Epoch finished! Loss: 1.3277462899684906
Starting epoch 3/10.
Epoch finished! Loss: 1.2248338997364043
Starting epoch 4/10.
Epoch finished! Loss: 1.1280751332640648
Starting epoch 5/10.
Epoch finished! Loss: 1.064255729317665
Starting epoch 6/10.
Epoch finished! Loss: 1.0115856587886811
Starting epoch 7/10.
Epoch finished! Loss: 0.97753327190876
Starting epoch 8/10.
Epoch finished! Loss: 0.9362172946333885
Starting epoch 9/10.
Epoch finished! Loss: 0.9149537727236747
Starting epoch 10/10.
Epoch finished! Loss: 0.8900687098503113
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7544444444444445
              precision    recall  f1-score   support

         0.0       0.84      0.99      0.91       226
         1.0       0.50      0.05      0.10        55
         2.0       0.70      0.98      0.82       410
         3.0       1.00      0.44      0.61       108
         4.0       1.00      0.02      0.04       101

    accuracy                           0.75       900
   macro avg       0.81      0.50      0.49       900
weighted avg       0.79      0.75      0.68       900
 


====== chc016-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.00  99.12   93.62   83.90     90.87
1  93.89   5.45   99.64   50.00      9.84
2  79.78  98.29   64.29   69.72     81.58
3  93.22  43.52  100.00  100.00     60.65
4  89.00   1.98  100.00  100.00      3.88
Total accuracy: 75.44%
Average sen: 49.67%
Average spec: 91.51%
Macro f1-score: 49.36%

=== Test on chc022-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4403647631406784
Starting epoch 2/10.
Epoch finished! Loss: 1.2933998346328734
Starting epoch 3/10.
Epoch finished! Loss: 1.1937931656837464
Starting epoch 4/10.
Epoch finished! Loss: 1.1041933342814445
Starting epoch 5/10.
Epoch finished! Loss: 1.0270536586642265
Starting epoch 6/10.
Epoch finished! Loss: 0.9846588283777237
Starting epoch 7/10.
Epoch finished! Loss: 0.9308144837617874
Starting epoch 8/10.
Epoch finished! Loss: 0.8810285717248917
Starting epoch 9/10.
Epoch finished! Loss: 0.8314811542630196
Starting epoch 10/10.
Epoch finished! Loss: 0.8296200945973397
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8208333333333333
              precision    recall  f1-score   support

         0.0       0.89      1.00      0.94        91
         1.0       0.00      0.00      0.00         5
         2.0       0.74      0.94      0.83       328
         3.0       0.97      0.65      0.78       187
         4.0       0.90      0.63      0.74       109

    accuracy                           0.82       720
   macro avg       0.70      0.65      0.66       720
weighted avg       0.84      0.82      0.81       720
 


====== chc022-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  98.47  100.00   98.25  89.22     94.30
1  99.31    0.00  100.00   0.00      0.00
2  82.64   94.21   72.96  74.46     83.18
3  90.42   65.24   99.25  96.83     77.96
4  93.33   63.30   98.69  89.61     74.19
Total accuracy: 82.08%
Average sen: 64.55%
Average spec: 93.83%
Macro f1-score: 65.93%

=== Test on chc025-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.418793585896492
Starting epoch 2/10.
Epoch finished! Loss: 1.2577071249485017
Starting epoch 3/10.
Epoch finished! Loss: 1.1731049120426178
Starting epoch 4/10.
Epoch finished! Loss: 1.1112333863973618
Starting epoch 5/10.
Epoch finished! Loss: 1.079884724318981
Starting epoch 6/10.
Epoch finished! Loss: 1.03967936784029
Starting epoch 7/10.
Epoch finished! Loss: 1.0084996834397315
Starting epoch 8/10.
Epoch finished! Loss: 0.9862193867564202
Starting epoch 9/10.
Epoch finished! Loss: 0.968570676445961
Starting epoch 10/10.
Epoch finished! Loss: 0.9432850673794746
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6625
              precision    recall  f1-score   support

         0.0       0.10      0.05      0.06        21
         1.0       0.00      0.00      0.00        39
         2.0       0.72      0.78      0.75       382
         3.0       0.98      0.38      0.54       114
         4.0       0.54      0.83      0.65       164

    accuracy                           0.66       720
   macro avg       0.47      0.41      0.40       720
weighted avg       0.66      0.66      0.63       720
 


====== chc025-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  95.97   4.76   98.71  10.00      6.45
1  94.58   0.00  100.00   0.00      0.00
2  71.94  77.75   65.38  71.74     74.62
3  90.00  37.72   99.83  97.73     54.43
4  80.00  82.93   79.14  53.97     65.38
Total accuracy: 66.25%
Average sen: 40.63%
Average spec: 88.61%
Macro f1-score: 40.18%

=== Test on chc027-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.543861636519432
Starting epoch 2/10.
Epoch finished! Loss: 1.3871471166610718
Starting epoch 3/10.
Epoch finished! Loss: 1.2445335805416107
Starting epoch 4/10.
Epoch finished! Loss: 1.1453384160995483
Starting epoch 5/10.
Epoch finished! Loss: 1.0550709649920464
Starting epoch 6/10.
Epoch finished! Loss: 0.9799259781837464
Starting epoch 7/10.
Epoch finished! Loss: 0.9345382273197174
Starting epoch 8/10.
Epoch finished! Loss: 0.8962633863091469
Starting epoch 9/10.
Epoch finished! Loss: 0.8628234088420867
Starting epoch 10/10.
Epoch finished! Loss: 0.8420681267976761
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.75
              precision    recall  f1-score   support

         0.0       0.92      0.77      0.84       277
         1.0       0.31      0.23      0.26        66
         2.0       0.65      0.84      0.74       293
         3.0       1.00      0.67      0.80       189
         4.0       0.63      0.97      0.77        75

    accuracy                           0.75       900
   macro avg       0.70      0.70      0.68       900
weighted avg       0.78      0.75      0.75       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  90.89  77.26   96.95   91.85     83.92
1  90.67  22.73   96.04   31.25     26.32
2  80.33  84.30   78.42   65.34     73.62
3  93.00  66.67  100.00  100.00     80.00
4  95.11  97.33   94.91   63.48     76.84
Total accuracy: 75.00%
Average sen: 69.66%
Average spec: 93.26%
Macro f1-score: 68.14%

=== Test on chc028-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4049509704113006
Starting epoch 2/10.
Epoch finished! Loss: 1.2744361072778703
Starting epoch 3/10.
Epoch finished! Loss: 1.1943471997976303
Starting epoch 4/10.
Epoch finished! Loss: 1.126264549791813
Starting epoch 5/10.
Epoch finished! Loss: 1.0738124236464501
Starting epoch 6/10.
Epoch finished! Loss: 1.047491766512394
Starting epoch 7/10.
Epoch finished! Loss: 1.005692782998085
Starting epoch 8/10.
Epoch finished! Loss: 0.9710854411125183
Starting epoch 9/10.
Epoch finished! Loss: 0.9454429015517235
Starting epoch 10/10.
Epoch finished! Loss: 0.9334189340472221
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7333333333333333
              precision    recall  f1-score   support

         0.0       0.58      1.00      0.73        98
         1.0       0.00      0.00      0.00        44
         2.0       0.88      0.68      0.76       359
         3.0       0.99      0.83      0.90       145
         4.0       0.44      0.91      0.59        74

    accuracy                           0.73       720
   macro avg       0.58      0.68      0.60       720
weighted avg       0.76      0.73      0.72       720
 


====== chc028-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  90.14  100.00   88.59  57.99     73.41
1  93.89    0.00  100.00   0.00      0.00
2  79.17   67.69   90.58  87.73     76.42
3  96.39   82.76   99.83  99.17     90.23
4  87.08   90.54   86.69  43.79     59.03
Total accuracy: 73.33%
Average sen: 68.20%
Average spec: 93.14%
Macro f1-score: 59.82%

=== Test on chc033-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5198464334011077
Starting epoch 2/10.
Epoch finished! Loss: 1.403650137782097
Starting epoch 3/10.
Epoch finished! Loss: 1.3314529061317444
Starting epoch 4/10.
Epoch finished! Loss: 1.2620014399290085
Starting epoch 5/10.
Epoch finished! Loss: 1.2119327127933501
Starting epoch 6/10.
Epoch finished! Loss: 1.1515178814530374
Starting epoch 7/10.
Epoch finished! Loss: 1.121013267338276
Starting epoch 8/10.
Epoch finished! Loss: 1.0732620820403098
Starting epoch 9/10.
Epoch finished! Loss: 1.045214694738388
Starting epoch 10/10.
Epoch finished! Loss: 1.0093548700213433
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7666666666666667
              precision    recall  f1-score   support

         0.0       1.00      0.24      0.38        59
         1.0       0.00      0.00      0.00        56
         2.0       0.94      0.85      0.89       358
         3.0       0.92      0.94      0.93       151
         4.0       0.40      0.94      0.56        96

    accuracy                           0.77       720
   macro avg       0.65      0.59      0.55       720
weighted avg       0.79      0.77      0.75       720
 


====== chc033-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  93.75  23.73  100.00  100.00     38.36
1  92.22   0.00  100.00    0.00      0.00
2  89.86  85.47   94.20   93.58     89.34
3  96.94  94.04   97.72   91.61     92.81
4  80.56  93.75   78.53   40.18     56.25
Total accuracy: 76.67%
Average sen: 59.40%
Average spec: 94.09%
Macro f1-score: 55.35%

=== Test on chc035-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3307088226079942
Starting epoch 2/10.
Epoch finished! Loss: 1.1848425388336181
Starting epoch 3/10.
Epoch finished! Loss: 1.10227822214365
Starting epoch 4/10.
Epoch finished! Loss: 1.0466492027044296
Starting epoch 5/10.
Epoch finished! Loss: 1.0018636003136634
Starting epoch 6/10.
Epoch finished! Loss: 0.9650047436356545
Starting epoch 7/10.
Epoch finished! Loss: 0.9418884068727493
Starting epoch 8/10.
Epoch finished! Loss: 0.9149678617715835
Starting epoch 9/10.
Epoch finished! Loss: 0.8811059609055519
Starting epoch 10/10.
Epoch finished! Loss: 0.8535028502345086
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8033333333333333
              precision    recall  f1-score   support

         0.0       0.64      0.93      0.76        29
         1.0       0.00      0.00      0.00        57
         2.0       0.74      0.95      0.84       391
         3.0       0.98      0.78      0.87       250
         4.0       0.81      0.75      0.78       173

    accuracy                           0.80       900
   macro avg       0.64      0.68      0.65       900
weighted avg       0.77      0.80      0.78       900
 


====== chc035-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  98.11  93.10   98.28  64.29     76.06
1  93.67   0.00  100.00   0.00      0.00
2  83.67  95.14   74.85  74.40     83.50
3  93.44  78.00   99.38  97.99     86.86
4  91.78  74.57   95.87  81.13     77.71
Total accuracy: 80.33%
Average sen: 68.16%
Average spec: 93.68%
Macro f1-score: 64.83%

=== Test on chc037-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5128047108650207
Starting epoch 2/10.
Epoch finished! Loss: 1.4089783370494842
Starting epoch 3/10.
Epoch finished! Loss: 1.3143457472324371
Starting epoch 4/10.
Epoch finished! Loss: 1.209439206123352
Starting epoch 5/10.
Epoch finished! Loss: 1.1044411391019822
Starting epoch 6/10.
Epoch finished! Loss: 1.0149204477667808
Starting epoch 7/10.
Epoch finished! Loss: 0.9534172669053078
Starting epoch 8/10.
Epoch finished! Loss: 0.8974587246775627
Starting epoch 9/10.
Epoch finished! Loss: 0.860756303369999
Starting epoch 10/10.
Epoch finished! Loss: 0.8252716809511185
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8972222222222223
              precision    recall  f1-score   support

         0.0       0.90      1.00      0.94       154
         1.0       0.00      0.00      0.00        30
         2.0       0.91      0.92      0.92       259
         3.0       0.97      0.90      0.93       168
         4.0       0.79      0.94      0.86       109

    accuracy                           0.90       720
   macro avg       0.71      0.75      0.73       720
weighted avg       0.86      0.90      0.88       720
 


====== chc037-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  97.50  100.00   96.82  89.53     94.48
1  95.83    0.00  100.00   0.00      0.00
2  93.89   92.28   94.79  90.87     91.57
3  96.94   89.88   99.09  96.79     93.21
4  95.28   93.58   95.58  79.07     85.71
Total accuracy: 89.72%
Average sen: 75.15%
Average spec: 97.26%
Macro f1-score: 72.99%

=== Test on chc040-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4002219200134278
Starting epoch 2/10.
Epoch finished! Loss: 1.2595003932714461
Starting epoch 3/10.
Epoch finished! Loss: 1.1658747509121894
Starting epoch 4/10.
Epoch finished! Loss: 1.0737561300396918
Starting epoch 5/10.
Epoch finished! Loss: 0.9905603438615799
Starting epoch 6/10.
Epoch finished! Loss: 0.9285159140825272
Starting epoch 7/10.
Epoch finished! Loss: 0.888972119987011
Starting epoch 8/10.
Epoch finished! Loss: 0.8400155141949653
Starting epoch 9/10.
Epoch finished! Loss: 0.8294389307498932
Starting epoch 10/10.
Epoch finished! Loss: 0.7985015049576759
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7333333333333333
              precision    recall  f1-score   support

         0.0       0.91      0.89      0.90       185
         1.0       0.50      0.10      0.17        50
         2.0       0.68      0.92      0.78       483
         3.0       0.98      0.21      0.34       216
         4.0       0.70      0.93      0.80       146

    accuracy                           0.73      1080
   macro avg       0.75      0.61      0.60      1080
weighted avg       0.77      0.73      0.69      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.48  88.65   98.10  90.61     89.62
1  95.37  10.00   99.51  50.00     16.67
2  76.94  91.51   65.16  68.00     78.02
3  84.07  20.83   99.88  97.83     34.35
4  93.80  93.15   93.90  70.47     80.24
Total accuracy: 73.33%
Average sen: 60.83%
Average spec: 91.31%
Macro f1-score: 59.78%

=== Test on chc041-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.420619535446167
Starting epoch 2/10.
Epoch finished! Loss: 1.2241741180419923
Starting epoch 3/10.
Epoch finished! Loss: 1.12216354906559
Starting epoch 4/10.
Epoch finished! Loss: 1.0569925233721733
Starting epoch 5/10.
Epoch finished! Loss: 1.0067082405090333
Starting epoch 6/10.
Epoch finished! Loss: 0.9717086374759674
Starting epoch 7/10.
Epoch finished! Loss: 0.9572196766734123
Starting epoch 8/10.
Epoch finished! Loss: 0.9275719329714776
Starting epoch 9/10.
Epoch finished! Loss: 0.8991584226489067
Starting epoch 10/10.
Epoch finished! Loss: 0.8754380226135254
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6680555555555555
              precision    recall  f1-score   support

         0.0       0.33      0.73      0.46        55
         1.0       0.16      0.57      0.24        35
         2.0       0.86      0.86      0.86       336
         3.0       0.99      0.77      0.87       166
         4.0       1.00      0.02      0.05       128

    accuracy                           0.67       720
   macro avg       0.67      0.59      0.49       720
weighted avg       0.84      0.67      0.66       720
 


====== chc041-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  86.81  72.73   87.97   33.33     45.71
1  82.78  57.14   84.09   15.50     24.39
2  86.81  86.31   87.24   85.55     85.93
3  94.58  77.11   99.82   99.22     86.78
4  82.64   2.34  100.00  100.00      4.58
Total accuracy: 66.81%
Average sen: 59.13%
Average spec: 91.82%
Macro f1-score: 49.48%

=== Test on chc052-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4232279449701308
Starting epoch 2/10.
Epoch finished! Loss: 1.2756070733070373
Starting epoch 3/10.
Epoch finished! Loss: 1.175384446978569
Starting epoch 4/10.
Epoch finished! Loss: 1.1104721441864966
Starting epoch 5/10.
Epoch finished! Loss: 1.0468716830015183
Starting epoch 6/10.
Epoch finished! Loss: 1.007296046614647
Starting epoch 7/10.
Epoch finished! Loss: 0.9673420563340187
Starting epoch 8/10.
Epoch finished! Loss: 0.9490381479263306
Starting epoch 9/10.
Epoch finished! Loss: 0.9040803551673889
Starting epoch 10/10.
Epoch finished! Loss: 0.9079784482717514
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7077777777777777
              precision    recall  f1-score   support

         0.0       0.91      1.00      0.95       142
         1.0       0.19      0.52      0.28        23
         2.0       0.70      0.86      0.78       466
         3.0       1.00      0.02      0.05       167
         4.0       0.74      0.75      0.74       102

    accuracy                           0.71       900
   macro avg       0.71      0.63      0.56       900
weighted avg       0.78      0.71      0.65       900
 


====== chc052-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  98.44  100.00   98.15   91.03     95.30
1  93.11   52.17   94.18   19.05     27.91
2  74.00   86.48   60.60   70.21     77.50
3  81.89    2.40  100.00  100.00      4.68
4  94.11   74.51   96.62   73.79     74.15
Total accuracy: 70.78%
Average sen: 63.11%
Average spec: 89.91%
Macro f1-score: 55.91%

=== Test on chc056-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3907349854707718
Starting epoch 2/10.
Epoch finished! Loss: 1.2312560230493546
Starting epoch 3/10.
Epoch finished! Loss: 1.1293061628937722
Starting epoch 4/10.
Epoch finished! Loss: 1.0461511984467506
Starting epoch 5/10.
Epoch finished! Loss: 0.9655433848500252
Starting epoch 6/10.
Epoch finished! Loss: 0.9192893117666244
Starting epoch 7/10.
Epoch finished! Loss: 0.875166492164135
Starting epoch 8/10.
Epoch finished! Loss: 0.8274370491504669
Starting epoch 9/10.
Epoch finished! Loss: 0.8093850240111351
Starting epoch 10/10.
Epoch finished! Loss: 0.7875426724553108
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.76
              precision    recall  f1-score   support

         0.0       0.87      0.94      0.91       175
         1.0       0.35      0.59      0.44        86
         2.0       0.81      0.78      0.79       396
         3.0       1.00      0.65      0.79       153
         4.0       0.69      0.66      0.67        90

    accuracy                           0.76       900
   macro avg       0.75      0.73      0.72       900
weighted avg       0.80      0.76      0.77       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.22  94.29   96.69   87.30     90.66
1  85.78  59.30   88.57   35.42     44.35
2  82.22  78.03   85.52   80.89     79.43
3  94.11  65.36  100.00  100.00     79.05
4  93.67  65.56   96.79   69.41     67.43
Total accuracy: 76.00%
Average sen: 72.51%
Average spec: 93.51%
Macro f1-score: 72.18%

=== Test on chp001-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4409256517887115
Starting epoch 2/10.
Epoch finished! Loss: 1.2988800197839736
Starting epoch 3/10.
Epoch finished! Loss: 1.2162795901298522
Starting epoch 4/10.
Epoch finished! Loss: 1.1480417370796203
Starting epoch 5/10.
Epoch finished! Loss: 1.078744612634182
Starting epoch 6/10.
Epoch finished! Loss: 1.012911745905876
Starting epoch 7/10.
Epoch finished! Loss: 0.9623619005084038
Starting epoch 8/10.
Epoch finished! Loss: 0.9218153864145279
Starting epoch 9/10.
Epoch finished! Loss: 0.8734642550349235
Starting epoch 10/10.
Epoch finished! Loss: 0.8494780883193016
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.675
              precision    recall  f1-score   support

         0.0       0.15      0.96      0.26        25
         1.0       0.11      0.06      0.08        77
         2.0       0.78      0.91      0.84       553
         3.0       0.00      0.00      0.00        69
         4.0       0.87      0.55      0.68       356

    accuracy                           0.68      1080
   macro avg       0.38      0.50      0.37      1080
weighted avg       0.70      0.68      0.66      1080
 


====== chp001-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  87.22  96.00   87.01  14.91     25.81
1  89.72   6.49   96.11  11.36      8.26
2  81.94  90.96   72.49  77.62     83.76
3  93.61   0.00  100.00   0.00      0.00
4  82.50  55.34   95.86  86.78     67.58
Total accuracy: 67.50%
Average sen: 49.76%
Average spec: 90.29%
Macro f1-score: 37.08%

=== Test on chp002-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4097563415765761
Starting epoch 2/10.
Epoch finished! Loss: 1.2741439402103425
Starting epoch 3/10.
Epoch finished! Loss: 1.1899355947971344
Starting epoch 4/10.
Epoch finished! Loss: 1.1050012290477753
Starting epoch 5/10.
Epoch finished! Loss: 1.0515126824378966
Starting epoch 6/10.
Epoch finished! Loss: 1.0116358667612075
Starting epoch 7/10.
Epoch finished! Loss: 0.9610054820775986
Starting epoch 8/10.
Epoch finished! Loss: 0.9501311093568802
Starting epoch 9/10.
Epoch finished! Loss: 0.9220918908715248
Starting epoch 10/10.
Epoch finished! Loss: 0.8942448809742928
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8194444444444444
              precision    recall  f1-score   support

         0.0       0.78      0.76      0.77       260
         1.0       0.66      0.78      0.72       248
         2.0       0.89      0.93      0.91       375
         3.0       1.00      0.87      0.93       169
         4.0       0.00      0.00      0.00        28

    accuracy                           0.82      1080
   macro avg       0.67      0.67      0.67      1080
weighted avg       0.81      0.82      0.81      1080
 


====== chp002-nsrr ======

The ppr of  4  has ZeroDivisionError.

The f1-score of  4  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  89.07  76.15   93.17   77.95     77.04
1  85.83  77.82   88.22   66.32     71.61
2  93.61  92.53   94.18   89.43     90.96
3  97.96  86.98  100.00  100.00     93.04
4  97.41   0.00  100.00    0.00      0.00
Total accuracy: 81.94%
Average sen: 66.70%
Average spec: 95.12%
Macro f1-score: 66.53%

=== Test on chp003-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.456506359577179
Starting epoch 2/10.
Epoch finished! Loss: 1.2756002783775329
Starting epoch 3/10.
Epoch finished! Loss: 1.1639273092150688
Starting epoch 4/10.
Epoch finished! Loss: 1.0754974320530892
Starting epoch 5/10.
Epoch finished! Loss: 0.985684110224247
Starting epoch 6/10.
Epoch finished! Loss: 0.9169881537556648
Starting epoch 7/10.
Epoch finished! Loss: 0.8627785041928291
Starting epoch 8/10.
Epoch finished! Loss: 0.8448082074522972
Starting epoch 9/10.
Epoch finished! Loss: 0.8361011713743209
Starting epoch 10/10.
Epoch finished! Loss: 0.7856491565704345
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5955555555555555
              precision    recall  f1-score   support

         0.0       0.25      0.80      0.38        59
         1.0       0.00      0.00      0.00        27
         2.0       0.75      0.62      0.68       468
         3.0       1.00      0.48      0.65       196
         4.0       0.46      0.68      0.55       150

    accuracy                           0.60       900
   macro avg       0.49      0.52      0.45       900
weighted avg       0.70      0.60      0.61       900
 


====== chp003-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  82.67  79.66   82.88   24.61     37.60
1  97.00   0.00  100.00    0.00      0.00
2  69.44  62.39   77.08   74.68     67.99
3  88.78  48.47  100.00  100.00     65.29
4  81.22  68.00   83.87   45.74     54.69
Total accuracy: 59.56%
Average sen: 51.70%
Average spec: 88.77%
Macro f1-score: 45.11%

=== Test on chp004-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4397002190351487
Starting epoch 2/10.
Epoch finished! Loss: 1.2742461174726487
Starting epoch 3/10.
Epoch finished! Loss: 1.1858843713998795
Starting epoch 4/10.
Epoch finished! Loss: 1.1014574736356735
Starting epoch 5/10.
Epoch finished! Loss: 1.0301379308104515
Starting epoch 6/10.
Epoch finished! Loss: 0.972577078640461
Starting epoch 7/10.
Epoch finished! Loss: 0.9413480207324028
Starting epoch 8/10.
Epoch finished! Loss: 0.905921621620655
Starting epoch 9/10.
Epoch finished! Loss: 0.8692681267857552
Starting epoch 10/10.
Epoch finished! Loss: 0.8409718602895737
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6188888888888889
              precision    recall  f1-score   support

         0.0       0.86      0.18      0.30       105
         1.0       0.37      0.33      0.34       123
         2.0       0.59      0.93      0.72       354
         3.0       1.00      0.59      0.74       197
         4.0       0.58      0.44      0.50       121

    accuracy                           0.62       900
   macro avg       0.68      0.49      0.52       900
weighted avg       0.68      0.62      0.59       900
 


====== chp004-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  90.11  18.10   99.62   86.36     29.92
1  83.11  32.52   91.12   36.70     34.48
2  71.33  92.94   57.33   58.54     71.83
3  91.00  58.88  100.00  100.00     74.12
4  88.22  43.80   95.12   58.24     50.00
Total accuracy: 61.89%
Average sen: 49.25%
Average spec: 88.64%
Macro f1-score: 52.07%

=== Test on chp005-nsrr. train_data(405), test_data(7) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4952735155820847
Starting epoch 2/10.
Epoch finished! Loss: 1.3500825345516205
Starting epoch 3/10.
Epoch finished! Loss: 1.2597862869501113
Starting epoch 4/10.
Epoch finished! Loss: 1.1990654319524765
Starting epoch 5/10.
Epoch finished! Loss: 1.1299936026334763
Starting epoch 6/10.
Epoch finished! Loss: 1.0851167842745781
Starting epoch 7/10.
Epoch finished! Loss: 1.0558520421385764
Starting epoch 8/10.
Epoch finished! Loss: 1.003209899365902
Starting epoch 9/10.
Epoch finished! Loss: 0.9701074436306953
Starting epoch 10/10.
Epoch finished! Loss: 0.9519599094986916
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5658730158730159
              precision    recall  f1-score   support

         0.0       0.13      0.79      0.22        63
         1.0       0.00      0.00      0.00       235
         2.0       0.74      0.92      0.82       565
         3.0       0.50      0.01      0.01       136
         4.0       0.87      0.54      0.67       261

    accuracy                           0.57      1260
   macro avg       0.45      0.45      0.34      1260
weighted avg       0.57      0.57      0.52      1260
 


====== chp005-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  71.75  79.37   71.35  12.72     21.93
1  81.35   0.00  100.00   0.00      0.00
2  82.14  92.21   73.96  74.22     82.24
3  89.21   0.74   99.91  50.00      1.45
4  88.73  54.02   97.80  86.50     66.51
Total accuracy: 56.59%
Average sen: 45.27%
Average spec: 88.60%
Macro f1-score: 34.43%

=== Test on chp006-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.471406978368759
Starting epoch 2/10.
Epoch finished! Loss: 1.3440379917621612
Starting epoch 3/10.
Epoch finished! Loss: 1.2208755403757094
Starting epoch 4/10.
Epoch finished! Loss: 1.1202237546443938
Starting epoch 5/10.
Epoch finished! Loss: 1.0505446165800094
Starting epoch 6/10.
Epoch finished! Loss: 0.989230515062809
Starting epoch 7/10.
Epoch finished! Loss: 0.9312711283564568
Starting epoch 8/10.
Epoch finished! Loss: 0.888785856962204
Starting epoch 9/10.
Epoch finished! Loss: 0.8456859961152077
Starting epoch 10/10.
Epoch finished! Loss: 0.8257154539227486
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5518518518518518
              precision    recall  f1-score   support

         0.0       0.45      0.68      0.54       120
         1.0       0.00      0.00      0.00       322
         2.0       0.69      0.77      0.73       274
         3.0       1.00      0.74      0.85       224
         4.0       0.32      0.98      0.48       140

    accuracy                           0.55      1080
   macro avg       0.49      0.63      0.52      1080
weighted avg       0.47      0.55      0.48      1080
 


====== chp006-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  87.31  67.50   89.79   45.25     54.18
1  70.19   0.00  100.00    0.00      0.00
2  85.46  77.37   88.21   69.06     72.98
3  94.63  74.11  100.00  100.00     85.13
4  72.78  97.86   69.04   32.01     48.24
Total accuracy: 55.19%
Average sen: 63.37%
Average spec: 89.41%
Macro f1-score: 52.11%

=== Test on chp007-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4885026693344117
Starting epoch 2/10.
Epoch finished! Loss: 1.319133034348488
Starting epoch 3/10.
Epoch finished! Loss: 1.1991328090429305
Starting epoch 4/10.
Epoch finished! Loss: 1.1030376136302948
Starting epoch 5/10.
Epoch finished! Loss: 1.0104508459568025
Starting epoch 6/10.
Epoch finished! Loss: 0.9355745017528534
Starting epoch 7/10.
Epoch finished! Loss: 0.8880733340978623
Starting epoch 8/10.
Epoch finished! Loss: 0.8374825537204742
Starting epoch 9/10.
Epoch finished! Loss: 0.8180098757147789
Starting epoch 10/10.
Epoch finished! Loss: 0.8005032941699028
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7027777777777777
              precision    recall  f1-score   support

         0.0       0.77      0.72      0.74       166
         1.0       0.19      0.59      0.28        58
         2.0       0.71      0.79      0.75       369
         3.0       0.89      0.93      0.91       135
         4.0       0.97      0.54      0.69       352

    accuracy                           0.70      1080
   macro avg       0.71      0.71      0.68      1080
weighted avg       0.80      0.70      0.73      1080
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.31  71.69   96.06  76.77     74.14
1  83.98  58.62   85.42  18.58     28.22
2  81.94  78.59   83.68  71.43     74.84
3  97.78  93.33   98.41  89.36     91.30
4  84.54  53.98   99.31  97.44     69.47
Total accuracy: 70.28%
Average sen: 71.24%
Average spec: 92.58%
Macro f1-score: 67.59%

=== Test on chp008-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4462222188711167
Starting epoch 2/10.
Epoch finished! Loss: 1.3159464240074157
Starting epoch 3/10.
Epoch finished! Loss: 1.2461414992809297
Starting epoch 4/10.
Epoch finished! Loss: 1.1801392197608949
Starting epoch 5/10.
Epoch finished! Loss: 1.077781930565834
Starting epoch 6/10.
Epoch finished! Loss: 0.9886919349431992
Starting epoch 7/10.
Epoch finished! Loss: 0.910877925157547
Starting epoch 8/10.
Epoch finished! Loss: 0.8718697056174278
Starting epoch 9/10.
Epoch finished! Loss: 0.827137254178524
Starting epoch 10/10.
Epoch finished! Loss: 0.7966056957840919
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6955555555555556
              precision    recall  f1-score   support

         0.0       0.56      0.80      0.66        89
         1.0       0.00      0.00      0.00        37
         2.0       0.73      0.68      0.70       387
         3.0       0.99      0.67      0.80       263
         4.0       0.50      0.94      0.66       124

    accuracy                           0.70       900
   macro avg       0.56      0.62      0.56       900
weighted avg       0.73      0.70      0.69       900
 


====== chp008-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  91.89  79.78   93.22  56.35     66.05
1  95.33   0.00   99.42   0.00      0.00
2  75.44  67.70   81.29  73.18     70.34
3  90.11  66.92   99.69  98.88     79.82
4  86.33  94.35   85.05  50.21     65.55
Total accuracy: 69.56%
Average sen: 61.75%
Average spec: 91.73%
Macro f1-score: 56.35%

=== Test on chp009-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3651950478553772
Starting epoch 2/10.
Epoch finished! Loss: 1.2479861825704575
Starting epoch 3/10.
Epoch finished! Loss: 1.1852204769849777
Starting epoch 4/10.
Epoch finished! Loss: 1.1273302838206292
Starting epoch 5/10.
Epoch finished! Loss: 1.0862851664423943
Starting epoch 6/10.
Epoch finished! Loss: 1.0323719769716262
Starting epoch 7/10.
Epoch finished! Loss: 1.0083970487117768
Starting epoch 8/10.
Epoch finished! Loss: 0.9695617467164993
Starting epoch 9/10.
Epoch finished! Loss: 0.941822612285614
Starting epoch 10/10.
Epoch finished! Loss: 0.9294987320899963
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7811111111111111
              precision    recall  f1-score   support

         0.0       0.66      0.81      0.73        96
         1.0       0.00      0.00      0.00        98
         2.0       0.71      0.90      0.80       340
         3.0       1.00      0.88      0.94       192
         4.0       0.82      0.86      0.84       174

    accuracy                           0.78       900
   macro avg       0.64      0.69      0.66       900
weighted avg       0.71      0.78      0.74       900
 


====== chp009-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  93.56  81.25   95.02   66.10     72.90
1  89.11   0.00  100.00    0.00      0.00
2  82.56  90.29   77.86   71.23     79.64
3  97.44  88.02  100.00  100.00     93.63
4  93.56  85.63   95.45   81.87     83.71
Total accuracy: 78.11%
Average sen: 69.04%
Average spec: 93.67%
Macro f1-score: 65.97%

=== Test on chp010-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.43616082072258
Starting epoch 2/10.
Epoch finished! Loss: 1.2660509943962097
Starting epoch 3/10.
Epoch finished! Loss: 1.1594077736139297
Starting epoch 4/10.
Epoch finished! Loss: 1.0737345442175865
Starting epoch 5/10.
Epoch finished! Loss: 1.0013173252344132
Starting epoch 6/10.
Epoch finished! Loss: 0.9429395332932472
Starting epoch 7/10.
Epoch finished! Loss: 0.8994696959853172
Starting epoch 8/10.
Epoch finished! Loss: 0.8672940477728843
Starting epoch 9/10.
Epoch finished! Loss: 0.8448582202196121
Starting epoch 10/10.
Epoch finished! Loss: 0.8240621641278267
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6944444444444444
              precision    recall  f1-score   support

         0.0       0.25      0.96      0.40        54
         1.0       0.00      0.00      0.00        45
         2.0       0.96      0.66      0.78       493
         3.0       0.75      0.89      0.82        90
         4.0       0.68      0.77      0.72       218

    accuracy                           0.69       900
   macro avg       0.53      0.66      0.54       900
weighted avg       0.78      0.69      0.71       900
 


====== chp010-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  82.44  96.30   81.56  25.00     39.69
1  94.89   0.00   99.88   0.00      0.00
2  80.00  66.13   96.81  96.17     78.37
3  96.00  88.89   96.79  75.47     81.63
4  85.56  76.61   88.42  67.89     71.98
Total accuracy: 69.44%
Average sen: 65.58%
Average spec: 92.69%
Macro f1-score: 54.34%

=== Test on chp011-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5826886177062989
Starting epoch 2/10.
Epoch finished! Loss: 1.3935280472040177
Starting epoch 3/10.
Epoch finished! Loss: 1.2687545359134673
Starting epoch 4/10.
Epoch finished! Loss: 1.1704563438892364
Starting epoch 5/10.
Epoch finished! Loss: 1.0764417842030525
Starting epoch 6/10.
Epoch finished! Loss: 1.012024961411953
Starting epoch 7/10.
Epoch finished! Loss: 0.9564640387892723
Starting epoch 8/10.
Epoch finished! Loss: 0.9289894565939903
Starting epoch 9/10.
Epoch finished! Loss: 0.8725376412272453
Starting epoch 10/10.
Epoch finished! Loss: 0.8360160440206528
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6266666666666667
              precision    recall  f1-score   support

         0.0       0.75      0.47      0.58       129
         1.0       0.00      0.00      0.00       143
         2.0       0.43      0.91      0.59       221
         3.0       1.00      0.70      0.82       271
         4.0       0.69      0.82      0.75       136

    accuracy                           0.63       900
   macro avg       0.57      0.58      0.55       900
weighted avg       0.62      0.63      0.59       900
 


====== chp011-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  90.22  47.29   97.41   75.31     58.10
1  84.00   0.00   99.87    0.00      0.00
2  68.56  91.40   61.12   43.35     58.81
3  90.89  69.74  100.00  100.00     82.17
4  91.67  82.35   93.32   68.71     74.92
Total accuracy: 62.67%
Average sen: 58.16%
Average spec: 90.34%
Macro f1-score: 54.80%

=== Test on chp012-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4943133413791656
Starting epoch 2/10.
Epoch finished! Loss: 1.3286928534507751
Starting epoch 3/10.
Epoch finished! Loss: 1.225670874118805
Starting epoch 4/10.
Epoch finished! Loss: 1.132795338332653
Starting epoch 5/10.
Epoch finished! Loss: 1.0752534121274948
Starting epoch 6/10.
Epoch finished! Loss: 1.018587352335453
Starting epoch 7/10.
Epoch finished! Loss: 0.9810840621590614
Starting epoch 8/10.
Epoch finished! Loss: 0.9481940492987633
Starting epoch 9/10.
Epoch finished! Loss: 0.9359502747654915
Starting epoch 10/10.
Epoch finished! Loss: 0.904845142364502
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5685185185185185
              precision    recall  f1-score   support

         0.0       0.37      0.65      0.47        23
         1.0       0.00      0.00      0.00       178
         2.0       0.47      0.99      0.64       379
         3.0       1.00      0.48      0.65       203
         4.0       0.88      0.42      0.57       297

    accuracy                           0.57      1080
   macro avg       0.54      0.51      0.47      1080
weighted avg       0.60      0.57      0.51      1080
 


====== chp012-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  96.85  65.22   97.54   36.59     46.88
1  83.52   0.00  100.00    0.00      0.00
2  60.56  99.21   39.66   47.06     63.84
3  90.28  48.28  100.00  100.00     65.12
4  82.50  42.09   97.83   88.03     56.95
Total accuracy: 56.85%
Average sen: 50.96%
Average spec: 87.01%
Macro f1-score: 46.56%

=== Test on chp013-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4316808432340622
Starting epoch 2/10.
Epoch finished! Loss: 1.2568424463272094
Starting epoch 3/10.
Epoch finished! Loss: 1.1484320998191833
Starting epoch 4/10.
Epoch finished! Loss: 1.0669686853885652
Starting epoch 5/10.
Epoch finished! Loss: 1.0029877245426178
Starting epoch 6/10.
Epoch finished! Loss: 0.9568659514188766
Starting epoch 7/10.
Epoch finished! Loss: 0.916087982058525
Starting epoch 8/10.
Epoch finished! Loss: 0.8810486033558845
Starting epoch 9/10.
Epoch finished! Loss: 0.8588138028979302
Starting epoch 10/10.
Epoch finished! Loss: 0.8392132878303528
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.73
              precision    recall  f1-score   support

         0.0       0.35      0.96      0.51        27
         1.0       0.00      0.00      0.00       107
         2.0       0.73      0.91      0.81       425
         3.0       0.89      0.74      0.81       189
         4.0       0.74      0.69      0.71       152

    accuracy                           0.73       900
   macro avg       0.54      0.66      0.57       900
weighted avg       0.67      0.73      0.69       900
 


====== chp013-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.56  96.30   94.50  35.14     51.49
1  88.11   0.00  100.00   0.00      0.00
2  80.11  91.06   70.32  73.30     81.22
3  92.56  73.54   97.61  89.10     80.58
4  90.67  69.08   95.05  73.94     71.43
Total accuracy: 73.00%
Average sen: 66.00%
Average spec: 91.50%
Macro f1-score: 56.94%

=== Test on chp014-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4593317687511445
Starting epoch 2/10.
Epoch finished! Loss: 1.289217585325241
Starting epoch 3/10.
Epoch finished! Loss: 1.1759526878595352
Starting epoch 4/10.
Epoch finished! Loss: 1.0825716733932496
Starting epoch 5/10.
Epoch finished! Loss: 1.0017965510487556
Starting epoch 6/10.
Epoch finished! Loss: 0.9474309206008911
Starting epoch 7/10.
Epoch finished! Loss: 0.9061041936278343
Starting epoch 8/10.
Epoch finished! Loss: 0.8671152412891387
Starting epoch 9/10.
Epoch finished! Loss: 0.8374936655163765
Starting epoch 10/10.
Epoch finished! Loss: 0.8136659070849419
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7788888888888889
              precision    recall  f1-score   support

         0.0       0.88      0.92      0.90       170
         1.0       0.17      0.02      0.03        55
         2.0       0.78      0.88      0.82       363
         3.0       1.00      0.51      0.67       146
         4.0       0.66      0.92      0.76       166

    accuracy                           0.78       900
   macro avg       0.69      0.65      0.64       900
weighted avg       0.77      0.78      0.75       900
 


====== chp014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  96.00  91.76   96.99   87.64     89.66
1  93.44   1.82   99.41   16.67      3.28
2  84.78  87.60   82.87   77.56     82.28
3  92.00  50.68  100.00  100.00     67.27
4  89.56  91.57   89.10   65.52     76.38
Total accuracy: 77.89%
Average sen: 64.69%
Average spec: 93.67%
Macro f1-score: 63.77%

=== Test on chp015-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4757621169090271
Starting epoch 2/10.
Epoch finished! Loss: 1.3005314886569976
Starting epoch 3/10.
Epoch finished! Loss: 1.1931847989559174
Starting epoch 4/10.
Epoch finished! Loss: 1.1133625403046608
Starting epoch 5/10.
Epoch finished! Loss: 1.0454798221588135
Starting epoch 6/10.
Epoch finished! Loss: 0.9910179868340492
Starting epoch 7/10.
Epoch finished! Loss: 0.9630517363548279
Starting epoch 8/10.
Epoch finished! Loss: 0.9300895720720291
Starting epoch 9/10.
Epoch finished! Loss: 0.8902314394712448
Starting epoch 10/10.
Epoch finished! Loss: 0.8780953511595726
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6944444444444444
              precision    recall  f1-score   support

         0.0       0.49      0.66      0.56        67
         1.0       0.65      0.52      0.58       257
         2.0       0.62      0.79      0.69       304
         3.0       0.99      0.72      0.84       259
         4.0       0.70      0.76      0.73       193

    accuracy                           0.69      1080
   macro avg       0.69      0.69      0.68      1080
weighted avg       0.72      0.69      0.70      1080
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.70  65.67   95.56  49.44     56.41
1  81.94  52.14   91.25  65.05     57.88
2  80.19  78.62   80.80  61.60     69.08
3  93.24  72.20   99.88  99.47     83.67
4  89.81  75.65   92.90  69.86     72.64
Total accuracy: 69.44%
Average sen: 68.86%
Average spec: 92.08%
Macro f1-score: 67.93%

=== Test on chp016-nsrr. train_data(405), test_data(7) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3080850690603256
Starting epoch 2/10.
Epoch finished! Loss: 1.1859844952821732
Starting epoch 3/10.
Epoch finished! Loss: 1.1386372447013855
Starting epoch 4/10.
Epoch finished! Loss: 1.0986345902085304
Starting epoch 5/10.
Epoch finished! Loss: 1.0559165179729462
Starting epoch 6/10.
Epoch finished! Loss: 1.052843165397644
Starting epoch 7/10.
Epoch finished! Loss: 1.0181384444236756
Starting epoch 8/10.
Epoch finished! Loss: 1.0215856567025186
Starting epoch 9/10.
Epoch finished! Loss: 1.0078464478254319
Starting epoch 10/10.
Epoch finished! Loss: 0.9836962595582008
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.45714285714285713
              precision    recall  f1-score   support

         0.0       0.00      0.00      0.00       297
         1.0       0.00      0.00      0.00       289
         2.0       0.52      1.00      0.68       330
         3.0       0.99      0.53      0.69       133
         4.0       0.32      0.83      0.46       211

    accuracy                           0.46      1260
   macro avg       0.36      0.47      0.37      1260
weighted avg       0.29      0.46      0.33      1260
 


====== chp016-nsrr ======

The ppr of  0  has ZeroDivisionError.

The f1-score of  0  has ZeroDivisionError.

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  76.43   0.00  100.00   0.00      0.00
1  77.06   0.00  100.00   0.00      0.00
2  75.48  99.70   66.88  51.65     68.05
3  95.00  53.38   99.91  98.61     69.27
4  67.46  83.41   64.25  31.94     46.19
Total accuracy: 45.71%
Average sen: 47.30%
Average spec: 86.21%
Macro f1-score: 36.70%

=== Test on chp017-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3628613710403443
Starting epoch 2/10.
Epoch finished! Loss: 1.2013671278953553
Starting epoch 3/10.
Epoch finished! Loss: 1.1206852450966835
Starting epoch 4/10.
Epoch finished! Loss: 1.040642151236534
Starting epoch 5/10.
Epoch finished! Loss: 0.9915028169751168
Starting epoch 6/10.
Epoch finished! Loss: 0.9397743672132493
Starting epoch 7/10.
Epoch finished! Loss: 0.9010149419307709
Starting epoch 8/10.
Epoch finished! Loss: 0.85680982619524
Starting epoch 9/10.
Epoch finished! Loss: 0.8390399232506752
Starting epoch 10/10.
Epoch finished! Loss: 0.8105999827384949
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4088888888888889
              precision    recall  f1-score   support

         0.0       0.68      0.79      0.73       232
         1.0       0.00      0.00      0.00       237
         2.0       0.37      0.35      0.36       181
         3.0       1.00      0.36      0.53       201
         4.0       0.13      1.00      0.22        49

    accuracy                           0.41       900
   macro avg       0.44      0.50      0.37       900
weighted avg       0.48      0.41      0.39       900
 


====== chp017-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  85.00   78.88   87.13   68.03     73.05
1  73.67    0.00  100.00    0.00      0.00
2  75.00   34.81   85.12   37.06     35.90
3  85.78   36.32  100.00  100.00     53.28
4  62.33  100.00   60.16   12.63     22.43
Total accuracy: 40.89%
Average sen: 50.00%
Average spec: 86.48%
Macro f1-score: 36.93%

=== Test on chp018-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5059775769710542
Starting epoch 2/10.
Epoch finished! Loss: 1.3361700028181076
Starting epoch 3/10.
Epoch finished! Loss: 1.2082372695207595
Starting epoch 4/10.
Epoch finished! Loss: 1.1227389037609101
Starting epoch 5/10.
Epoch finished! Loss: 1.0248573035001756
Starting epoch 6/10.
Epoch finished! Loss: 0.962875135242939
Starting epoch 7/10.
Epoch finished! Loss: 0.9182311937212944
Starting epoch 8/10.
Epoch finished! Loss: 0.8845174729824066
Starting epoch 9/10.
Epoch finished! Loss: 0.8410324856638909
Starting epoch 10/10.
Epoch finished! Loss: 0.8221151098608971
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5685185185185185
              precision    recall  f1-score   support

         0.0       0.92      0.70      0.80       138
         1.0       0.05      0.03      0.04       117
         2.0       0.23      0.95      0.37       119
         3.0       0.99      0.73      0.84       363
         4.0       0.93      0.40      0.56       343

    accuracy                           0.57      1080
   macro avg       0.62      0.56      0.52      1080
weighted avg       0.77      0.57      0.61      1080
 


====== chp018-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.46  70.29   99.15  92.38     79.84
1  83.15   3.42   92.83   5.48      4.21
2  64.81  94.96   61.08  23.20     37.29
3  90.46  72.73   99.44  98.51     83.68
4  79.81  39.65   98.51  92.52     55.51
Total accuracy: 56.85%
Average sen: 56.21%
Average spec: 90.20%
Macro f1-score: 52.11%

=== Test on chp019-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5604164272546768
Starting epoch 2/10.
Epoch finished! Loss: 1.4347335904836656
Starting epoch 3/10.
Epoch finished! Loss: 1.3389601588249207
Starting epoch 4/10.
Epoch finished! Loss: 1.2458834886550902
Starting epoch 5/10.
Epoch finished! Loss: 1.1754864424467086
Starting epoch 6/10.
Epoch finished! Loss: 1.0832067981362343
Starting epoch 7/10.
Epoch finished! Loss: 1.0067660108208656
Starting epoch 8/10.
Epoch finished! Loss: 0.9337917253375053
Starting epoch 9/10.
Epoch finished! Loss: 0.8866049513220787
Starting epoch 10/10.
Epoch finished! Loss: 0.8367003485560417
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.65
              precision    recall  f1-score   support

         0.0       0.25      0.56      0.34        36
         1.0       0.30      0.40      0.35       108
         2.0       0.70      0.51      0.59       215
         3.0       0.88      0.91      0.89       223
         4.0       0.72      0.66      0.69       318

    accuracy                           0.65       900
   macro avg       0.57      0.61      0.57       900
weighted avg       0.69      0.65      0.66       900
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.56  55.56   93.06  25.00     34.48
1  81.89  39.81   87.63  30.50     34.54
2  83.00  50.70   93.14  69.87     58.76
3  94.67  91.03   95.86  87.88     89.43
4  78.89  66.04   85.91  71.92     68.85
Total accuracy: 65.00%
Average sen: 60.63%
Average spec: 91.12%
Macro f1-score: 57.21%

=== Test on chp020-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5670905888080597
Starting epoch 2/10.
Epoch finished! Loss: 1.4032371103763581
Starting epoch 3/10.
Epoch finished! Loss: 1.2727697640657425
Starting epoch 4/10.
Epoch finished! Loss: 1.1589017376303672
Starting epoch 5/10.
Epoch finished! Loss: 1.0656769543886184
Starting epoch 6/10.
Epoch finished! Loss: 0.9813448399305343
Starting epoch 7/10.
Epoch finished! Loss: 0.940989425778389
Starting epoch 8/10.
Epoch finished! Loss: 0.8763399228453637
Starting epoch 9/10.
Epoch finished! Loss: 0.8403025835752487
Starting epoch 10/10.
Epoch finished! Loss: 0.8162241294980049
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6064814814814815
              precision    recall  f1-score   support

         0.0       0.78      0.56      0.65       237
         1.0       0.46      0.74      0.57       200
         2.0       0.64      0.86      0.74       354
         3.0       1.00      0.01      0.01       159
         4.0       0.60      0.52      0.56       130

    accuracy                           0.61      1080
   macro avg       0.70      0.54      0.51      1080
weighted avg       0.69      0.61      0.56      1080
 


====== chp020-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  86.76  55.70   95.49   77.65     64.86
1  79.17  74.00   80.34   46.11     56.81
2  79.91  86.44   76.72   64.42     73.82
3  85.37   0.63  100.00  100.00      1.25
4  90.09  52.31   95.26   60.18     55.97
Total accuracy: 60.65%
Average sen: 53.81%
Average spec: 89.56%
Macro f1-score: 50.54%

=== Test on chp022-nsrr. train_data(405), test_data(7) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5790972322225572
Starting epoch 2/10.
Epoch finished! Loss: 1.430352321267128
Starting epoch 3/10.
Epoch finished! Loss: 1.3286778599023819
Starting epoch 4/10.
Epoch finished! Loss: 1.2219359755516053
Starting epoch 5/10.
Epoch finished! Loss: 1.1272968649864197
Starting epoch 6/10.
Epoch finished! Loss: 1.0570714175701141
Starting epoch 7/10.
Epoch finished! Loss: 0.978613069653511
Starting epoch 8/10.
Epoch finished! Loss: 0.9402675718069077
Starting epoch 9/10.
Epoch finished! Loss: 0.9050410315394402
Starting epoch 10/10.
Epoch finished! Loss: 0.8524166107177734
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6555555555555556
              precision    recall  f1-score   support

         0.0       0.75      0.86      0.80       253
         1.0       0.00      0.00      0.00       293
         2.0       0.78      0.84      0.81       468
         3.0       0.61      0.83      0.70       107
         4.0       0.40      0.91      0.55       139

    accuracy                           0.66      1260
   macro avg       0.51      0.69      0.57      1260
weighted avg       0.54      0.66      0.58      1260
 


====== chp022-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  91.43  86.17   92.75  74.91     80.15
1  76.75   0.00  100.00   0.00      0.00
2  85.24  83.76   86.11  78.09     80.82
3  93.97  83.18   94.97  60.54     70.08
4  83.73  91.37   82.78  39.69     55.34
Total accuracy: 65.56%
Average sen: 68.89%
Average spec: 91.32%
Macro f1-score: 57.28%

=== Test on chp024-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5538727223873139
Starting epoch 2/10.
Epoch finished! Loss: 1.406085228919983
Starting epoch 3/10.
Epoch finished! Loss: 1.2774333566427232
Starting epoch 4/10.
Epoch finished! Loss: 1.1709979474544525
Starting epoch 5/10.
Epoch finished! Loss: 1.0734443873167039
Starting epoch 6/10.
Epoch finished! Loss: 0.998417466878891
Starting epoch 7/10.
Epoch finished! Loss: 0.9474196135997772
Starting epoch 8/10.
Epoch finished! Loss: 0.9060355126857758
Starting epoch 9/10.
Epoch finished! Loss: 0.8637597158551216
Starting epoch 10/10.
Epoch finished! Loss: 0.8322505101561546
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5203703703703704
              precision    recall  f1-score   support

         0.0       0.85      0.43      0.57       232
         1.0       0.00      0.00      0.00       179
         2.0       0.37      0.98      0.54       216
         3.0       1.00      0.55      0.71       339
         4.0       0.31      0.58      0.41       114

    accuracy                           0.52      1080
   macro avg       0.51      0.51      0.44      1080
weighted avg       0.60      0.52      0.50      1080
 


====== chp024-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  86.02  42.67   97.88   84.62     56.73
1  83.43   0.00  100.00    0.00      0.00
2  66.57  97.69   58.80   37.21     53.90
3  85.83  54.87  100.00  100.00     70.86
4  82.22  57.89   85.09   31.43     40.74
Total accuracy: 52.04%
Average sen: 50.62%
Average spec: 88.35%
Macro f1-score: 44.45%

=== Test on chp025-nsrr. train_data(410), test_data(2) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5336715072393416
Starting epoch 2/10.
Epoch finished! Loss: 1.380864679813385
Starting epoch 3/10.
Epoch finished! Loss: 1.2605360686779021
Starting epoch 4/10.
Epoch finished! Loss: 1.1505526810884477
Starting epoch 5/10.
Epoch finished! Loss: 1.0562889531254769
Starting epoch 6/10.
Epoch finished! Loss: 0.9919114738702774
Starting epoch 7/10.
Epoch finished! Loss: 0.9270984128117561
Starting epoch 8/10.
Epoch finished! Loss: 0.8769735917448997
Starting epoch 9/10.
Epoch finished! Loss: 0.8426279813051224
Starting epoch 10/10.
Epoch finished! Loss: 0.8090555801987648
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7777777777777778
              precision    recall  f1-score   support

         0.0       1.00      0.74      0.85       249
         1.0       0.26      0.50      0.34        20
         2.0       0.62      0.86      0.72        29
         3.0       1.00      0.97      0.98        62
         4.0       0.00      0.00      0.00         0

    accuracy                           0.78       360
   macro avg       0.58      0.61      0.58       360
weighted avg       0.93      0.78      0.84       360
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  82.22  74.30  100.00  100.00     85.25
1  89.44  50.00   91.76   26.32     34.48
2  94.72  86.21   95.47   62.50     72.46
3  99.44  96.77  100.00  100.00     98.36
4  89.72    NaN   89.72    0.00       NaN
Total accuracy: 77.78%
Average sen: 76.82%
Average spec: 95.39%
Macro f1-score: 72.64%

=== Test on chp026-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3750601619482041
Starting epoch 2/10.
Epoch finished! Loss: 1.22781101167202
Starting epoch 3/10.
Epoch finished! Loss: 1.128955602645874
Starting epoch 4/10.
Epoch finished! Loss: 1.0675282165408135
Starting epoch 5/10.
Epoch finished! Loss: 1.042480044066906
Starting epoch 6/10.
Epoch finished! Loss: 1.0045212358236313
Starting epoch 7/10.
Epoch finished! Loss: 0.9656186521053314
Starting epoch 8/10.
Epoch finished! Loss: 0.9450674429535866
Starting epoch 9/10.
Epoch finished! Loss: 0.9270915076136589
Starting epoch 10/10.
Epoch finished! Loss: 0.9249880224466324
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6266666666666667
              precision    recall  f1-score   support

         0.0       0.88      0.78      0.83        58
         1.0       0.00      0.00      0.00        55
         2.0       0.54      0.98      0.70       386
         3.0       0.96      0.77      0.85       182
         4.0       0.00      0.00      0.00       219

    accuracy                           0.63       900
   macro avg       0.48      0.51      0.48       900
weighted avg       0.48      0.63      0.52       900
 


====== chp026-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.

The ppr of  4  has ZeroDivisionError.

The f1-score of  4  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  97.89  77.59   99.29  88.24     82.57
1  93.89   0.00  100.00   0.00      0.00
2  63.22  98.19   36.96  53.91     69.61
3  94.67  76.92   99.16  95.89     85.37
4  75.67   0.00  100.00   0.00      0.00
Total accuracy: 62.67%
Average sen: 50.54%
Average spec: 87.08%
Macro f1-score: 47.51%

=== Test on chp028-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4823152244091033
Starting epoch 2/10.
Epoch finished! Loss: 1.2728395938873291
Starting epoch 3/10.
Epoch finished! Loss: 1.1718923270702362
Starting epoch 4/10.
Epoch finished! Loss: 1.0980814397335052
Starting epoch 5/10.
Epoch finished! Loss: 1.0452789410948753
Starting epoch 6/10.
Epoch finished! Loss: 0.9922533527016639
Starting epoch 7/10.
Epoch finished! Loss: 0.9455254197120666
Starting epoch 8/10.
Epoch finished! Loss: 0.9085246801376343
Starting epoch 9/10.
Epoch finished! Loss: 0.8723424434661865
Starting epoch 10/10.
Epoch finished! Loss: 0.8331008180975914
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7119021134593994
              precision    recall  f1-score   support

         0.0       0.96      0.58      0.73        89
         1.0       0.00      0.00      0.00        53
         2.0       0.65      0.88      0.75       382
         3.0       0.76      0.69      0.72       191
         4.0       0.89      0.64      0.75       184

    accuracy                           0.71       899
   macro avg       0.65      0.56      0.59       899
weighted avg       0.72      0.71      0.70       899
 


====== chp028-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  95.66  58.43   99.75  96.30     72.73
1  92.10   0.00   97.87   0.00      0.00
2  74.75  88.48   64.60  64.88     74.86
3  88.77  69.11   94.07  75.86     72.33
4  91.10  64.13   98.04  89.39     74.68
Total accuracy: 71.19%
Average sen: 56.03%
Average spec: 90.87%
Macro f1-score: 58.92%

=== Test on chp029-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5214483082294463
Starting epoch 2/10.
Epoch finished! Loss: 1.3521661907434464
Starting epoch 3/10.
Epoch finished! Loss: 1.2316207945346833
Starting epoch 4/10.
Epoch finished! Loss: 1.1339845553040504
Starting epoch 5/10.
Epoch finished! Loss: 1.0517412066459655
Starting epoch 6/10.
Epoch finished! Loss: 0.989976741373539
Starting epoch 7/10.
Epoch finished! Loss: 0.9318063750863075
Starting epoch 8/10.
Epoch finished! Loss: 0.8801599815487862
Starting epoch 9/10.
Epoch finished! Loss: 0.8541612535715103
Starting epoch 10/10.
Epoch finished! Loss: 0.8196350678801536
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7288888888888889
              precision    recall  f1-score   support

         0.0       0.77      0.76      0.76        66
         1.0       0.00      0.00      0.00        44
         2.0       0.66      0.90      0.76       374
         3.0       1.00      0.61      0.76       311
         4.0       0.57      0.75      0.65       105

    accuracy                           0.73       900
   macro avg       0.60      0.60      0.59       900
weighted avg       0.74      0.73      0.71       900
 


====== chp029-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  96.56  75.76   98.20   76.92     76.34
1  95.11   0.00  100.00    0.00      0.00
2  76.89  89.84   67.68   66.40     76.36
3  86.67  61.41  100.00  100.00     76.10
4  90.56  75.24   92.58   57.25     65.02
Total accuracy: 72.89%
Average sen: 60.45%
Average spec: 91.69%
Macro f1-score: 58.76%

=== Test on chp030-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4391035437583923
Starting epoch 2/10.
Epoch finished! Loss: 1.279703402519226
Starting epoch 3/10.
Epoch finished! Loss: 1.1881598770618438
Starting epoch 4/10.
Epoch finished! Loss: 1.1102537155151366
Starting epoch 5/10.
Epoch finished! Loss: 1.0390463858842849
Starting epoch 6/10.
Epoch finished! Loss: 0.9838508009910584
Starting epoch 7/10.
Epoch finished! Loss: 0.9300779163837433
Starting epoch 8/10.
Epoch finished! Loss: 0.8963435053825378
Starting epoch 9/10.
Epoch finished! Loss: 0.8563807651400566
Starting epoch 10/10.
Epoch finished! Loss: 0.80415328592062
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5171455050973123
              precision    recall  f1-score   support

         0.0       0.89      0.64      0.74       335
         1.0       0.47      0.04      0.07       200
         2.0       0.42      0.86      0.56       270
         3.0       0.00      0.00      0.00       154
         4.0       0.40      0.87      0.54       120

    accuracy                           0.52      1079
   macro avg       0.43      0.48      0.38      1079
weighted avg       0.51      0.52      0.44      1079
 


====== chp030-nsrr ======

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  86.38  63.88   96.51  89.17     74.43
1  81.37   3.50   99.09  46.67      6.51
2  66.36  86.30   59.70  41.68     56.21
3  85.54   0.00   99.78   0.00      0.00
4  83.78  86.67   83.42  39.54     54.31
Total accuracy: 51.71%
Average sen: 48.07%
Average spec: 87.70%
Macro f1-score: 38.29%

=== Test on chp031-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4242441296577453
Starting epoch 2/10.
Epoch finished! Loss: 1.2983374506235124
Starting epoch 3/10.
Epoch finished! Loss: 1.2111707836389543
Starting epoch 4/10.
Epoch finished! Loss: 1.1400750800967216
Starting epoch 5/10.
Epoch finished! Loss: 1.084805530309677
Starting epoch 6/10.
Epoch finished! Loss: 1.0329634368419647
Starting epoch 7/10.
Epoch finished! Loss: 0.9879590883851052
Starting epoch 8/10.
Epoch finished! Loss: 0.9350821927189827
Starting epoch 9/10.
Epoch finished! Loss: 0.907365383207798
Starting epoch 10/10.
Epoch finished! Loss: 0.8688233166933059
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6472222222222223
              precision    recall  f1-score   support

         0.0       0.20      0.67      0.31        51
         1.0       0.00      0.00      0.00        48
         2.0       0.73      0.52      0.61       309
         3.0       0.99      0.67      0.80       229
         4.0       0.66      0.79      0.72       443

    accuracy                           0.65      1080
   macro avg       0.52      0.53      0.49      1080
weighted avg       0.70      0.65      0.65      1080
 


====== chp031-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  85.83  66.67   86.78  20.00     30.77
1  95.56   0.00  100.00   0.00      0.00
2  80.74  52.10   92.22  72.85     60.75
3  92.87  66.81   99.88  99.35     79.90
4  74.44  79.23   71.11  65.61     71.78
Total accuracy: 64.72%
Average sen: 52.96%
Average spec: 90.00%
Macro f1-score: 48.64%

=== Test on chp032-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.6523216545581818
Starting epoch 2/10.
Epoch finished! Loss: 1.521416848897934
Starting epoch 3/10.
Epoch finished! Loss: 1.414823406934738
Starting epoch 4/10.
Epoch finished! Loss: 1.3081095218658447
Starting epoch 5/10.
Epoch finished! Loss: 1.2102423518896104
Starting epoch 6/10.
Epoch finished! Loss: 1.1007391065359116
Starting epoch 7/10.
Epoch finished! Loss: 1.0148063853383065
Starting epoch 8/10.
Epoch finished! Loss: 0.9393800079822541
Starting epoch 9/10.
Epoch finished! Loss: 0.8837134972214699
Starting epoch 10/10.
Epoch finished! Loss: 0.8418586164712906
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7488888888888889
              precision    recall  f1-score   support

         0.0       0.41      0.64      0.50        14
         1.0       0.15      0.02      0.04        92
         2.0       0.87      0.85      0.86       486
         3.0       1.00      0.68      0.81       150
         4.0       0.51      0.94      0.66       158

    accuracy                           0.75       900
   macro avg       0.59      0.63      0.57       900
weighted avg       0.75      0.75      0.73       900
 


====== chp032-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  98.00  64.29   98.53   40.91     50.00
1  88.78   2.17   98.64   15.38      3.81
2  85.00  84.98   85.02   86.95     85.95
3  94.67  68.00  100.00  100.00     80.95
4  83.33  93.67   81.13   51.39     66.37
Total accuracy: 74.89%
Average sen: 62.62%
Average spec: 92.67%
Macro f1-score: 57.42%

=== Test on chp033-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4717517971992493
Starting epoch 2/10.
Epoch finished! Loss: 1.3108815550804138
Starting epoch 3/10.
Epoch finished! Loss: 1.1886971056461335
Starting epoch 4/10.
Epoch finished! Loss: 1.0860071390867234
Starting epoch 5/10.
Epoch finished! Loss: 1.0095171913504601
Starting epoch 6/10.
Epoch finished! Loss: 0.959457217156887
Starting epoch 7/10.
Epoch finished! Loss: 0.9056974738836289
Starting epoch 8/10.
Epoch finished! Loss: 0.857048100233078
Starting epoch 9/10.
Epoch finished! Loss: 0.8289896503090859
Starting epoch 10/10.
Epoch finished! Loss: 0.817275495827198
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5377777777777778
              precision    recall  f1-score   support

         0.0       0.19      1.00      0.32        32
         1.0       0.00      0.00      0.00       248
         2.0       0.45      0.94      0.61       208
         3.0       1.00      0.73      0.85       254
         4.0       0.65      0.45      0.53       158

    accuracy                           0.54       900
   macro avg       0.46      0.62      0.46       900
weighted avg       0.51      0.54      0.48       900
 


====== chp033-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  84.78  100.00   84.22   18.93     31.84
1  72.44    0.00  100.00    0.00      0.00
2  71.78   93.75   65.17   44.72     60.56
3  92.44   73.23  100.00  100.00     84.55
4  86.11   44.94   94.88   65.14     53.18
Total accuracy: 53.78%
Average sen: 62.38%
Average spec: 88.85%
Macro f1-score: 46.03%

=== Test on chp034-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3693120658397675
Starting epoch 2/10.
Epoch finished! Loss: 1.1967274755239488
Starting epoch 3/10.
Epoch finished! Loss: 1.1141351953148841
Starting epoch 4/10.
Epoch finished! Loss: 1.0373019129037857
Starting epoch 5/10.
Epoch finished! Loss: 0.9815645113587379
Starting epoch 6/10.
Epoch finished! Loss: 0.9403456911444664
Starting epoch 7/10.
Epoch finished! Loss: 0.9051093384623528
Starting epoch 8/10.
Epoch finished! Loss: 0.8870634272694587
Starting epoch 9/10.
Epoch finished! Loss: 0.8664150089025497
Starting epoch 10/10.
Epoch finished! Loss: 0.853534908592701
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7088888888888889
              precision    recall  f1-score   support

         0.0       0.25      0.29      0.27        17
         1.0       0.27      0.32      0.29        62
         2.0       0.70      0.68      0.69       325
         3.0       0.92      0.78      0.84       316
         4.0       0.65      0.81      0.72       180

    accuracy                           0.71       900
   macro avg       0.56      0.58      0.56       900
weighted avg       0.73      0.71      0.72       900
 


====== chp034-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.00  29.41   98.30  25.00     27.03
1  89.22  32.26   93.44  26.67     29.20
2  78.22  68.31   83.83  70.48     69.37
3  89.89  77.85   96.40  92.13     84.39
4  87.44  80.56   89.17  65.02     71.96
Total accuracy: 70.89%
Average sen: 57.68%
Average spec: 92.23%
Macro f1-score: 56.39%

=== Test on chp036-nsrr. train_data(405), test_data(7) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.486954739689827
Starting epoch 2/10.
Epoch finished! Loss: 1.3494838535785676
Starting epoch 3/10.
Epoch finished! Loss: 1.24092156291008
Starting epoch 4/10.
Epoch finished! Loss: 1.1617242604494096
Starting epoch 5/10.
Epoch finished! Loss: 1.0954410418868066
Starting epoch 6/10.
Epoch finished! Loss: 1.0303022995591165
Starting epoch 7/10.
Epoch finished! Loss: 0.9715861096978188
Starting epoch 8/10.
Epoch finished! Loss: 0.9296836480498314
Starting epoch 9/10.
Epoch finished! Loss: 0.8775903150439263
Starting epoch 10/10.
Epoch finished! Loss: 0.8508543267846107
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6976190476190476
              precision    recall  f1-score   support

         0.0       0.57      0.97      0.72       237
         1.0       0.00      0.00      0.00       167
         2.0       0.75      0.92      0.83       563
         3.0       0.15      0.50      0.23         8
         4.0       0.92      0.44      0.59       285

    accuracy                           0.70      1260
   macro avg       0.48      0.57      0.47      1260
weighted avg       0.65      0.70      0.64      1260
 


====== chp036-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  85.79  97.47   83.09  57.18     72.07
1  86.75   0.00  100.00   0.00      0.00
2  82.70  92.18   75.04  74.89     82.64
3  97.86  50.00   98.16  14.81     22.86
4  86.43  43.86   98.87  91.91     59.38
Total accuracy: 69.76%
Average sen: 56.70%
Average spec: 91.03%
Macro f1-score: 47.39%

=== Test on chp037-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.515967234969139
Starting epoch 2/10.
Epoch finished! Loss: 1.3286156922578811
Starting epoch 3/10.
Epoch finished! Loss: 1.1960397750139236
Starting epoch 4/10.
Epoch finished! Loss: 1.0871832758188247
Starting epoch 5/10.
Epoch finished! Loss: 1.0037883162498473
Starting epoch 6/10.
Epoch finished! Loss: 0.9359439760446548
Starting epoch 7/10.
Epoch finished! Loss: 0.889470100402832
Starting epoch 8/10.
Epoch finished! Loss: 0.8677069261670113
Starting epoch 9/10.
Epoch finished! Loss: 0.825211587548256
Starting epoch 10/10.
Epoch finished! Loss: 0.7999505117535591
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6877777777777778
              precision    recall  f1-score   support

         0.0       0.88      0.67      0.76       191
         1.0       0.38      0.43      0.40       143
         2.0       0.77      0.69      0.73       274
         3.0       1.00      0.79      0.88       208
         4.0       0.41      0.93      0.57        84

    accuracy                           0.69       900
   macro avg       0.69      0.70      0.67       900
weighted avg       0.75      0.69      0.70       900
 


====== chp037-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.11  67.02   97.60   88.28     76.19
1  79.89  42.66   86.92   38.12     40.26
2  84.33  68.61   91.21   77.37     72.73
3  95.11  78.85  100.00  100.00     88.17
4  87.11  92.86   86.52   41.49     57.35
Total accuracy: 68.78%
Average sen: 70.00%
Average spec: 92.45%
Macro f1-score: 66.94%

=== Test on chp038-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5108421862125396
Starting epoch 2/10.
Epoch finished! Loss: 1.3103231340646744
Starting epoch 3/10.
Epoch finished! Loss: 1.1890965491533279
Starting epoch 4/10.
Epoch finished! Loss: 1.112609715759754
Starting epoch 5/10.
Epoch finished! Loss: 1.038507702946663
Starting epoch 6/10.
Epoch finished! Loss: 1.0127281606197358
Starting epoch 7/10.
Epoch finished! Loss: 0.9629836812615394
Starting epoch 8/10.
Epoch finished! Loss: 0.9285539150238037
Starting epoch 9/10.
Epoch finished! Loss: 0.9139958068728447
Starting epoch 10/10.
Epoch finished! Loss: 0.8858148932456971
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6266666666666667
              precision    recall  f1-score   support

         0.0       0.37      0.90      0.53        61
         1.0       0.29      0.05      0.08       153
         2.0       0.62      0.98      0.76       373
         3.0       0.97      0.81      0.88       102
         4.0       0.93      0.26      0.41       211

    accuracy                           0.63       900
   macro avg       0.64      0.60      0.53       900
weighted avg       0.66      0.63      0.56       900
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.00  90.16   88.92  37.16     52.63
1  81.89   4.58   97.72  29.17      7.91
2  74.67  97.59   58.44  62.44     76.15
3  97.56  81.37   99.62  96.51     88.30
4  82.22  26.07   99.42  93.22     40.74
Total accuracy: 62.67%
Average sen: 59.95%
Average spec: 88.83%
Macro f1-score: 53.15%

=== Test on chp039-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.6171462535858154
Starting epoch 2/10.
Epoch finished! Loss: 1.4643887162208558
Starting epoch 3/10.
Epoch finished! Loss: 1.3578601956367493
Starting epoch 4/10.
Epoch finished! Loss: 1.262203249335289
Starting epoch 5/10.
Epoch finished! Loss: 1.1665050849318503
Starting epoch 6/10.
Epoch finished! Loss: 1.0892654269933701
Starting epoch 7/10.
Epoch finished! Loss: 1.014750038087368
Starting epoch 8/10.
Epoch finished! Loss: 0.9481792569160461
Starting epoch 9/10.
Epoch finished! Loss: 0.9193650618195534
Starting epoch 10/10.
Epoch finished! Loss: 0.8696887493133545
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4537037037037037
              precision    recall  f1-score   support

         0.0       0.09      0.95      0.17        19
         1.0       1.00      0.00      0.01       325
         2.0       0.80      0.53      0.63       376
         3.0       1.00      0.78      0.88       199
         4.0       0.24      0.73      0.37       161

    accuracy                           0.45      1080
   macro avg       0.63      0.60      0.41      1080
weighted avg       0.80      0.45      0.44      1080
 


====== chp039-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  83.80  94.74   83.60    9.38     17.06
1  70.00   0.31  100.00  100.00      0.61
2  78.89  52.66   92.90   79.84     63.46
3  95.93  77.89  100.00  100.00     87.57
4  62.13  73.29   60.17   24.38     36.59
Total accuracy: 45.37%
Average sen: 59.78%
Average spec: 87.33%
Macro f1-score: 41.06%

=== Test on chp040-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4159686475992204
Starting epoch 2/10.
Epoch finished! Loss: 1.2417042762041093
Starting epoch 3/10.
Epoch finished! Loss: 1.1399123027920723
Starting epoch 4/10.
Epoch finished! Loss: 1.0749711781740188
Starting epoch 5/10.
Epoch finished! Loss: 1.0311790838837624
Starting epoch 6/10.
Epoch finished! Loss: 0.9714963227510452
Starting epoch 7/10.
Epoch finished! Loss: 0.9370740741491318
Starting epoch 8/10.
Epoch finished! Loss: 0.8971612691879273
Starting epoch 9/10.
Epoch finished! Loss: 0.8866240471601486
Starting epoch 10/10.
Epoch finished! Loss: 0.8701580360531807
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5711111111111111
              precision    recall  f1-score   support

         0.0       0.58      0.83      0.69       157
         1.0       0.35      0.06      0.11       124
         2.0       0.49      1.00      0.66       264
         3.0       0.99      0.36      0.53       192
         4.0       0.89      0.26      0.40       163

    accuracy                           0.57       900
   macro avg       0.66      0.50      0.48       900
weighted avg       0.67      0.57      0.51       900
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.78  83.44   87.48  58.48     68.77
1  85.44   6.45   98.07  34.78     10.88
2  69.67  99.62   57.23  49.16     65.83
3  86.33  36.46   99.86  98.59     53.23
4  86.00  25.77   99.32  89.36     40.00
Total accuracy: 57.11%
Average sen: 50.35%
Average spec: 88.39%
Macro f1-score: 47.74%

=== Test on chp041-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.454477658867836
Starting epoch 2/10.
Epoch finished! Loss: 1.3116632342338561
Starting epoch 3/10.
Epoch finished! Loss: 1.2127103239297867
Starting epoch 4/10.
Epoch finished! Loss: 1.1181053593754768
Starting epoch 5/10.
Epoch finished! Loss: 1.0195740714669228
Starting epoch 6/10.
Epoch finished! Loss: 0.958066001534462
Starting epoch 7/10.
Epoch finished! Loss: 0.9071648493409157
Starting epoch 8/10.
Epoch finished! Loss: 0.87753244638443
Starting epoch 9/10.
Epoch finished! Loss: 0.828609861433506
Starting epoch 10/10.
Epoch finished! Loss: 0.8161451250314713
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7675925925925926
              precision    recall  f1-score   support

         0.0       0.72      0.84      0.77       196
         1.0       0.25      0.12      0.16        58
         2.0       0.80      0.92      0.85       527
         3.0       0.00      0.00      0.00        33
         4.0       0.79      0.66      0.72       266

    accuracy                           0.77      1080
   macro avg       0.51      0.51      0.50      1080
weighted avg       0.73      0.77      0.74      1080
 


====== chp041-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  91.11  83.67   92.76  71.93     77.36
1  93.33  12.07   97.95  25.00     16.28
2  84.81  91.65   78.30  80.10     85.49
3  96.94   0.00  100.00   0.00      0.00
4  87.31  65.79   94.35  79.19     71.87
Total accuracy: 76.76%
Average sen: 50.64%
Average spec: 92.67%
Macro f1-score: 50.20%

=== Test on chp042-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4805295914411545
Starting epoch 2/10.
Epoch finished! Loss: 1.349447038769722
Starting epoch 3/10.
Epoch finished! Loss: 1.2566256135702134
Starting epoch 4/10.
Epoch finished! Loss: 1.170376032590866
Starting epoch 5/10.
Epoch finished! Loss: 1.0814660340547562
Starting epoch 6/10.
Epoch finished! Loss: 1.0193693101406098
Starting epoch 7/10.
Epoch finished! Loss: 0.9542098939418793
Starting epoch 8/10.
Epoch finished! Loss: 0.9034771502017975
Starting epoch 9/10.
Epoch finished! Loss: 0.855643455684185
Starting epoch 10/10.
Epoch finished! Loss: 0.8276561319828033
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6527777777777778
              precision    recall  f1-score   support

         0.0       0.44      0.88      0.59       152
         1.0       0.00      0.00      0.00       230
         2.0       0.82      0.83      0.82       414
         3.0       1.00      0.58      0.73        93
         4.0       0.57      0.92      0.70       191

    accuracy                           0.65      1080
   macro avg       0.57      0.64      0.57      1080
weighted avg       0.56      0.65      0.59      1080
 


====== chp042-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  82.69  88.16   81.79   44.22     58.90
1  78.70   0.00  100.00    0.00      0.00
2  86.48  82.61   88.89   82.21     82.41
3  96.39  58.06  100.00  100.00     73.47
4  86.30  91.62   85.15   57.00     70.28
Total accuracy: 65.28%
Average sen: 64.09%
Average spec: 91.17%
Macro f1-score: 57.01%

=== Test on chp043-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.392174842953682
Starting epoch 2/10.
Epoch finished! Loss: 1.241252663731575
Starting epoch 3/10.
Epoch finished! Loss: 1.1459190636873244
Starting epoch 4/10.
Epoch finished! Loss: 1.0671230390667916
Starting epoch 5/10.
Epoch finished! Loss: 0.9966877937316895
Starting epoch 6/10.
Epoch finished! Loss: 0.9478940978646279
Starting epoch 7/10.
Epoch finished! Loss: 0.8834880456328392
Starting epoch 8/10.
Epoch finished! Loss: 0.8532934948801995
Starting epoch 9/10.
Epoch finished! Loss: 0.8289725810289383
Starting epoch 10/10.
Epoch finished! Loss: 0.8101835876703263
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7444444444444445
              precision    recall  f1-score   support

         0.0       0.64      0.96      0.77       136
         1.0       0.00      0.00      0.00       184
         2.0       0.80      0.96      0.88       489
         3.0       1.00      0.08      0.14        39
         4.0       0.69      0.87      0.77       232

    accuracy                           0.74      1080
   macro avg       0.63      0.57      0.51      1080
weighted avg       0.63      0.74      0.66      1080
 


====== chp043-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  92.78  96.32   92.27   64.22     77.06
1  82.96   0.00  100.00    0.00      0.00
2  87.59  95.91   80.71   80.45     87.50
3  96.67   7.69  100.00  100.00     14.29
4  88.89  86.64   89.50   69.31     77.01
Total accuracy: 74.44%
Average sen: 57.31%
Average spec: 92.50%
Macro f1-score: 51.17%

=== Test on chp044-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.433757373690605
Starting epoch 2/10.
Epoch finished! Loss: 1.2586412250995636
Starting epoch 3/10.
Epoch finished! Loss: 1.1513559639453887
Starting epoch 4/10.
Epoch finished! Loss: 1.075720977783203
Starting epoch 5/10.
Epoch finished! Loss: 0.995905515551567
Starting epoch 6/10.
Epoch finished! Loss: 0.9307139992713929
Starting epoch 7/10.
Epoch finished! Loss: 0.8799790278077125
Starting epoch 8/10.
Epoch finished! Loss: 0.8428565979003906
Starting epoch 9/10.
Epoch finished! Loss: 0.8146493807435036
Starting epoch 10/10.
Epoch finished! Loss: 0.7899164542555809
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.54
              precision    recall  f1-score   support

         0.0       0.31      1.00      0.47        15
         1.0       0.22      0.23      0.22        80
         2.0       0.43      0.72      0.54       286
         3.0       1.00      0.42      0.59       417
         4.0       0.63      0.70      0.66       102

    accuracy                           0.54       900
   macro avg       0.52      0.61      0.50       900
weighted avg       0.70      0.54      0.55       900
 


====== chp044-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  96.22  100.00   96.16   30.61     46.87
1  85.89   22.50   92.07   21.69     22.09
2  60.78   72.03   55.54   43.01     53.86
3  73.22   42.21  100.00  100.00     59.36
4  91.89   69.61   94.74   62.83     66.05
Total accuracy: 54.00%
Average sen: 61.27%
Average spec: 87.70%
Macro f1-score: 49.64%

=== Test on chp045-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4536588072776795
Starting epoch 2/10.
Epoch finished! Loss: 1.297868973016739
Starting epoch 3/10.
Epoch finished! Loss: 1.1829189658164978
Starting epoch 4/10.
Epoch finished! Loss: 1.0918478026986123
Starting epoch 5/10.
Epoch finished! Loss: 1.0108351543545724
Starting epoch 6/10.
Epoch finished! Loss: 0.9664023503661155
Starting epoch 7/10.
Epoch finished! Loss: 0.891569010913372
Starting epoch 8/10.
Epoch finished! Loss: 0.8652957320213318
Starting epoch 9/10.
Epoch finished! Loss: 0.816819941997528
Starting epoch 10/10.
Epoch finished! Loss: 0.8001119494438171
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5542168674698795
              precision    recall  f1-score   support

         0.0       0.49      0.68      0.57       138
         1.0       0.15      0.03      0.05       120
         2.0       0.63      0.75      0.68       410
         3.0       0.97      0.33      0.49       212
         4.0       0.41      0.62      0.49       199

    accuracy                           0.55      1079
   macro avg       0.53      0.48      0.46      1079
weighted avg       0.58      0.55      0.53      1079
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.93  68.12   89.69  49.21     57.14
1  87.21   3.33   97.71  15.38      5.48
2  73.59  75.12   72.65  62.73     68.37
3  86.56  32.55   99.77  97.18     48.76
4  76.55  61.81   79.89  41.00     49.30
Total accuracy: 55.42%
Average sen: 48.19%
Average spec: 87.94%
Macro f1-score: 45.81%

=== Test on chp046-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5254868775606156
Starting epoch 2/10.
Epoch finished! Loss: 1.3777546435594559
Starting epoch 3/10.
Epoch finished! Loss: 1.257968920469284
Starting epoch 4/10.
Epoch finished! Loss: 1.1659972801804543
Starting epoch 5/10.
Epoch finished! Loss: 1.1086140155792237
Starting epoch 6/10.
Epoch finished! Loss: 1.0526632472872735
Starting epoch 7/10.
Epoch finished! Loss: 1.010942417383194
Starting epoch 8/10.
Epoch finished! Loss: 0.9678840100765228
Starting epoch 9/10.
Epoch finished! Loss: 0.9294899731874466
Starting epoch 10/10.
Epoch finished! Loss: 0.8848074287176132
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.625
              precision    recall  f1-score   support

         0.0       0.85      0.92      0.88       226
         1.0       0.57      0.15      0.24       357
         2.0       0.57      0.86      0.69       192
         3.0       0.00      0.00      0.00         2
         4.0       0.55      0.82      0.66       303

    accuracy                           0.62      1080
   macro avg       0.51      0.55      0.49      1080
weighted avg       0.62      0.62      0.57      1080
 


====== chp046-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.91  91.59   95.78  85.19     88.27
1  68.15  15.41   94.19  56.70     24.23
2  86.11  85.94   86.15  57.29     68.75
3  99.81   0.00  100.00   0.00      0.00
4  76.02  81.85   73.75  54.87     65.70
Total accuracy: 62.50%
Average sen: 54.96%
Average spec: 89.97%
Macro f1-score: 49.39%

=== Test on chp047-nsrr. train_data(408), test_data(4) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4025263696908952
Starting epoch 2/10.
Epoch finished! Loss: 1.242319568991661
Starting epoch 3/10.
Epoch finished! Loss: 1.1588478192687035
Starting epoch 4/10.
Epoch finished! Loss: 1.092072966694832
Starting epoch 5/10.
Epoch finished! Loss: 1.0255141124129294
Starting epoch 6/10.
Epoch finished! Loss: 0.9939063385128974
Starting epoch 7/10.
Epoch finished! Loss: 0.9571203052997589
Starting epoch 8/10.
Epoch finished! Loss: 0.9195968329906463
Starting epoch 9/10.
Epoch finished! Loss: 0.9219890758395195
Starting epoch 10/10.
Epoch finished! Loss: 0.8966226145625115
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5444444444444444
              precision    recall  f1-score   support

         0.0       0.54      0.88      0.67       224
         1.0       0.27      0.18      0.22       172
         2.0       0.68      0.70      0.68       233
         3.0       1.00      0.08      0.15        25
         4.0       0.00      0.00      0.00        66

    accuracy                           0.54       720
   macro avg       0.50      0.37      0.34       720
weighted avg       0.49      0.54      0.49       720
 


====== chp047-nsrr ======

The ppr of  4  has ZeroDivisionError.

The f1-score of  4  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  73.19  87.95   66.53   54.27     67.12
1  68.75  18.02   84.67   26.96     21.60
2  79.31  69.53   83.98   67.50     68.50
3  96.81   8.00  100.00  100.00     14.81
4  90.83   0.00  100.00    0.00      0.00
Total accuracy: 54.44%
Average sen: 36.70%
Average spec: 87.04%
Macro f1-score: 34.41%

=== Test on chp048-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.503952968120575
Starting epoch 2/10.
Epoch finished! Loss: 1.3717414379119872
Starting epoch 3/10.
Epoch finished! Loss: 1.287332499027252
Starting epoch 4/10.
Epoch finished! Loss: 1.2246378362178802
Starting epoch 5/10.
Epoch finished! Loss: 1.1669877648353577
Starting epoch 6/10.
Epoch finished! Loss: 1.120902816951275
Starting epoch 7/10.
Epoch finished! Loss: 1.091283567249775
Starting epoch 8/10.
Epoch finished! Loss: 1.042795866727829
Starting epoch 9/10.
Epoch finished! Loss: 1.023381568491459
Starting epoch 10/10.
Epoch finished! Loss: 1.0006537050008775
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5877777777777777
              precision    recall  f1-score   support

         0.0       0.19      1.00      0.32        37
         1.0       0.41      0.25      0.31       126
         2.0       0.71      0.85      0.77       441
         3.0       0.00      0.00      0.00       107
         4.0       0.84      0.46      0.59       189

    accuracy                           0.59       900
   macro avg       0.43      0.51      0.40       900
weighted avg       0.59      0.59      0.56       900
 


====== chp048-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  82.67  100.00   81.92  19.17     32.17
1  84.44   25.40   94.06  41.03     31.37
2  75.56   84.58   66.88  71.05     77.23
3  88.11    0.00  100.00   0.00      0.00
4  86.78   46.03   97.61  83.65     59.39
Total accuracy: 58.78%
Average sen: 51.20%
Average spec: 88.09%
Macro f1-score: 40.03%

=== Test on chp049-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4356503069400788
Starting epoch 2/10.
Epoch finished! Loss: 1.258551549911499
Starting epoch 3/10.
Epoch finished! Loss: 1.1619606554508208
Starting epoch 4/10.
Epoch finished! Loss: 1.0872284561395644
Starting epoch 5/10.
Epoch finished! Loss: 1.0229527041316033
Starting epoch 6/10.
Epoch finished! Loss: 0.958717243373394
Starting epoch 7/10.
Epoch finished! Loss: 0.9089669167995453
Starting epoch 8/10.
Epoch finished! Loss: 0.8746445849537849
Starting epoch 9/10.
Epoch finished! Loss: 0.8440441757440567
Starting epoch 10/10.
Epoch finished! Loss: 0.8140183359384536
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4305555555555556
              precision    recall  f1-score   support

         0.0       0.19      0.74      0.30       108
         1.0       0.63      0.23      0.34       387
         2.0       0.56      0.65      0.60       360
         3.0       0.90      0.09      0.17        95
         4.0       0.59      0.41      0.48       130

    accuracy                           0.43      1080
   macro avg       0.57      0.42      0.38      1080
weighted avg       0.58      0.43      0.42      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  66.11  74.07   65.23  19.14     30.42
1  67.50  23.00   92.35  62.68     33.65
2  71.11  65.00   74.17  55.71     60.00
3  91.94   9.47   99.90  90.00     17.14
4  89.44  40.77   96.11  58.89     48.18
Total accuracy: 43.06%
Average sen: 42.46%
Average spec: 85.55%
Macro f1-score: 37.88%

=== Test on chp051-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4537110596895217
Starting epoch 2/10.
Epoch finished! Loss: 1.3043331921100616
Starting epoch 3/10.
Epoch finished! Loss: 1.2095470190048219
Starting epoch 4/10.
Epoch finished! Loss: 1.1271545886993408
Starting epoch 5/10.
Epoch finished! Loss: 1.0663970693945886
Starting epoch 6/10.
Epoch finished! Loss: 1.0157169833779336
Starting epoch 7/10.
Epoch finished! Loss: 0.9815112724900246
Starting epoch 8/10.
Epoch finished! Loss: 0.9590020462870598
Starting epoch 9/10.
Epoch finished! Loss: 0.9399731740355491
Starting epoch 10/10.
Epoch finished! Loss: 0.9075592070817947
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5166666666666667
              precision    recall  f1-score   support

         0.0       0.21      0.93      0.35        30
         1.0       0.20      0.12      0.15       136
         2.0       0.51      0.70      0.59       404
         3.0       1.00      0.09      0.17       239
         4.0       0.73      0.78      0.75       271

    accuracy                           0.52      1080
   macro avg       0.53      0.52      0.40      1080
weighted avg       0.62      0.52      0.47      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  90.19  93.33   90.10   21.21     34.57
1  82.78  11.76   93.01   19.51     14.68
2  63.43  69.55   59.76   50.81     58.73
3  79.91   9.21  100.00  100.00     16.86
4  87.04  77.86   90.11   72.51     75.09
Total accuracy: 51.67%
Average sen: 52.34%
Average spec: 86.60%
Macro f1-score: 39.98%

=== Test on chp052-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4155934542417525
Starting epoch 2/10.
Epoch finished! Loss: 1.277094241976738
Starting epoch 3/10.
Epoch finished! Loss: 1.180531096458435
Starting epoch 4/10.
Epoch finished! Loss: 1.1049238175153733
Starting epoch 5/10.
Epoch finished! Loss: 1.033240707218647
Starting epoch 6/10.
Epoch finished! Loss: 0.9641171246767044
Starting epoch 7/10.
Epoch finished! Loss: 0.9144151359796524
Starting epoch 8/10.
Epoch finished! Loss: 0.8739248648285866
Starting epoch 9/10.
Epoch finished! Loss: 0.8384579911828041
Starting epoch 10/10.
Epoch finished! Loss: 0.8047889545559883
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6755555555555556
              precision    recall  f1-score   support

         0.0       0.46      0.97      0.63       156
         1.0       0.17      0.03      0.05        76
         2.0       0.82      0.90      0.85       397
         3.0       1.00      0.03      0.06        66
         4.0       0.79      0.47      0.59       205

    accuracy                           0.68       900
   macro avg       0.65      0.48      0.43       900
weighted avg       0.71      0.68      0.63       900
 


====== chp052-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  80.00  97.44   76.34   46.34     62.81
1  90.67   2.63   98.79   16.67      4.55
2  86.56  89.67   84.10   81.65     85.47
3  92.89   3.03  100.00  100.00      5.88
4  85.00  46.83   96.26   78.69     58.72
Total accuracy: 67.56%
Average sen: 47.92%
Average spec: 91.10%
Macro f1-score: 43.49%

=== Test on chp053-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.60031860768795
Starting epoch 2/10.
Epoch finished! Loss: 1.4431303560733795
Starting epoch 3/10.
Epoch finished! Loss: 1.3105530828237533
Starting epoch 4/10.
Epoch finished! Loss: 1.1913416683673859
Starting epoch 5/10.
Epoch finished! Loss: 1.0884987995028497
Starting epoch 6/10.
Epoch finished! Loss: 1.0102232679724694
Starting epoch 7/10.
Epoch finished! Loss: 0.9486650466918946
Starting epoch 8/10.
Epoch finished! Loss: 0.8922910556197167
Starting epoch 9/10.
Epoch finished! Loss: 0.8539154753088951
Starting epoch 10/10.
Epoch finished! Loss: 0.8315981402993202
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7166666666666667
              precision    recall  f1-score   support

         0.0       0.82      0.78      0.80       251
         1.0       0.00      0.00      0.00       147
         2.0       0.67      0.92      0.77       305
         3.0       1.00      0.79      0.88       250
         4.0       0.45      0.79      0.57       127

    accuracy                           0.72      1080
   macro avg       0.59      0.66      0.61      1080
weighted avg       0.66      0.72      0.68      1080
 


====== chp053-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  90.83  78.09   94.69   81.67     79.84
1  86.39   0.00  100.00    0.00      0.00
2  84.72  91.80   81.94   66.67     77.24
3  95.19  79.20  100.00  100.00     88.39
4  86.20  78.74   87.20   45.05     57.31
Total accuracy: 71.67%
Average sen: 65.57%
Average spec: 92.77%
Macro f1-score: 60.56%

=== Test on chp054-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.6003202587366103
Starting epoch 2/10.
Epoch finished! Loss: 1.4350781738758087
Starting epoch 3/10.
Epoch finished! Loss: 1.3200365006923676
Starting epoch 4/10.
Epoch finished! Loss: 1.1998568207025528
Starting epoch 5/10.
Epoch finished! Loss: 1.093304692208767
Starting epoch 6/10.
Epoch finished! Loss: 1.0122937381267547
Starting epoch 7/10.
Epoch finished! Loss: 0.93640096783638
Starting epoch 8/10.
Epoch finished! Loss: 0.8866507217288018
Starting epoch 9/10.
Epoch finished! Loss: 0.8436787202954292
Starting epoch 10/10.
Epoch finished! Loss: 0.8158805206418037
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6925925925925925
              precision    recall  f1-score   support

         0.0       0.86      0.45      0.59       228
         1.0       0.13      0.14      0.14        86
         2.0       0.89      0.77      0.83       451
         3.0       0.97      0.95      0.96        99
         4.0       0.50      0.89      0.64       216

    accuracy                           0.69      1080
   macro avg       0.67      0.64      0.63      1080
weighted avg       0.75      0.69      0.70      1080
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.76  44.74   98.00  85.71     58.79
1  85.83  13.95   92.05  13.19     13.56
2  86.67  77.16   93.48  89.46     82.86
3  99.26  94.95   99.69  96.91     95.92
4  80.00  88.89   77.78  50.00     64.00
Total accuracy: 69.26%
Average sen: 63.94%
Average spec: 92.20%
Macro f1-score: 63.02%

=== Test on chp055-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5170454502105712
Starting epoch 2/10.
Epoch finished! Loss: 1.3386569976806642
Starting epoch 3/10.
Epoch finished! Loss: 1.2316062897443771
Starting epoch 4/10.
Epoch finished! Loss: 1.1380418628454207
Starting epoch 5/10.
Epoch finished! Loss: 1.060379369556904
Starting epoch 6/10.
Epoch finished! Loss: 0.9942949086427688
Starting epoch 7/10.
Epoch finished! Loss: 0.9383049756288528
Starting epoch 8/10.
Epoch finished! Loss: 0.9048972517251969
Starting epoch 9/10.
Epoch finished! Loss: 0.8757501721382142
Starting epoch 10/10.
Epoch finished! Loss: 0.8183887958526611
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6537037037037037
              precision    recall  f1-score   support

         0.0       0.93      0.75      0.83       211
         1.0       0.40      0.20      0.27       154
         2.0       0.68      0.91      0.78       408
         3.0       0.00      0.00      0.00       130
         4.0       0.50      0.82      0.62       177

    accuracy                           0.65      1080
   macro avg       0.50      0.54      0.50      1080
weighted avg       0.58      0.65      0.60      1080
 


====== chp055-nsrr ======

The ppr of  3  has ZeroDivisionError.

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.07  74.88   98.73  93.49     83.16
1  84.35  20.13   95.03  40.26     26.84
2  80.65  90.93   74.40  68.32     78.02
3  87.96   0.00  100.00   0.00      0.00
4  83.70  82.49   83.94  50.17     62.39
Total accuracy: 65.37%
Average sen: 53.69%
Average spec: 90.42%
Macro f1-score: 50.08%

=== Test on chp056-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4545287787914276
Starting epoch 2/10.
Epoch finished! Loss: 1.2947763741016387
Starting epoch 3/10.
Epoch finished! Loss: 1.1942231982946396
Starting epoch 4/10.
Epoch finished! Loss: 1.1214499160647393
Starting epoch 5/10.
Epoch finished! Loss: 1.066188521683216
Starting epoch 6/10.
Epoch finished! Loss: 1.0237369120121003
Starting epoch 7/10.
Epoch finished! Loss: 1.0015334472060204
Starting epoch 8/10.
Epoch finished! Loss: 0.9645802736282348
Starting epoch 9/10.
Epoch finished! Loss: 0.9275600641965867
Starting epoch 10/10.
Epoch finished! Loss: 0.9095998093485832
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5527777777777778
              precision    recall  f1-score   support

         0.0       0.49      0.50      0.49        78
         1.0       0.50      0.31      0.38       284
         2.0       0.41      0.95      0.57       258
         3.0       1.00      0.85      0.92       185
         4.0       0.95      0.25      0.40       275

    accuracy                           0.55      1080
   macro avg       0.67      0.57      0.55      1080
weighted avg       0.68      0.55      0.53      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.59  50.00   95.91   48.75     49.37
1  73.61  30.63   88.94   49.71     37.91
2  66.30  94.57   57.42   41.08     57.28
3  97.50  85.41  100.00  100.00     92.13
4  80.56  25.09   99.50   94.52     39.66
Total accuracy: 55.28%
Average sen: 57.14%
Average spec: 88.36%
Macro f1-score: 55.27%

=== Test on chp057-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3930987983942031
Starting epoch 2/10.
Epoch finished! Loss: 1.2540616065263748
Starting epoch 3/10.
Epoch finished! Loss: 1.1669262528419495
Starting epoch 4/10.
Epoch finished! Loss: 1.1182372882962226
Starting epoch 5/10.
Epoch finished! Loss: 1.0648124366998672
Starting epoch 6/10.
Epoch finished! Loss: 1.0227117002010346
Starting epoch 7/10.
Epoch finished! Loss: 1.0112284600734711
Starting epoch 8/10.
Epoch finished! Loss: 0.9845169812440873
Starting epoch 9/10.
Epoch finished! Loss: 0.9723593547940255
Starting epoch 10/10.
Epoch finished! Loss: 0.951608482003212
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.556997219647822
              precision    recall  f1-score   support

         0.0       0.00      0.00      0.00       260
         1.0       0.00      0.00      0.00       142
         2.0       0.72      0.97      0.83       423
         3.0       0.97      0.53      0.68        74
         4.0       0.32      0.85      0.47       180

    accuracy                           0.56      1079
   macro avg       0.40      0.47      0.40      1079
weighted avg       0.40      0.56      0.45      1079
 


====== chp057-nsrr ======

The ppr of  0  has ZeroDivisionError.

The f1-score of  0  has ZeroDivisionError.

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  75.90   0.00  100.00   0.00      0.00
1  86.84   0.00  100.00   0.00      0.00
2  83.97  96.69   75.76  72.01     82.54
3  96.66  52.70   99.90  97.50     68.42
4  68.03  85.00   64.63  32.48     47.00
Total accuracy: 55.70%
Average sen: 46.88%
Average spec: 88.06%
Macro f1-score: 39.59%

=== Test on chp058-nsrr. train_data(407), test_data(5) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.5281871944665908
Starting epoch 2/10.
Epoch finished! Loss: 1.3707551449537276
Starting epoch 3/10.
Epoch finished! Loss: 1.2381222635507583
Starting epoch 4/10.
Epoch finished! Loss: 1.1451071992516517
Starting epoch 5/10.
Epoch finished! Loss: 1.0735120207071305
Starting epoch 6/10.
Epoch finished! Loss: 1.0179379522800445
Starting epoch 7/10.
Epoch finished! Loss: 0.9868991017341614
Starting epoch 8/10.
Epoch finished! Loss: 0.947457592189312
Starting epoch 9/10.
Epoch finished! Loss: 0.9134948030114174
Starting epoch 10/10.
Epoch finished! Loss: 0.8975793048739433
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5344444444444445
              precision    recall  f1-score   support

         0.0       0.83      0.74      0.78       105
         1.0       0.10      0.55      0.17        44
         2.0       0.56      0.70      0.62       290
         3.0       1.00      0.34      0.50       228
         4.0       0.79      0.43      0.56       233

    accuracy                           0.53       900
   macro avg       0.66      0.55      0.53       900
weighted avg       0.74      0.53      0.57       900
 


====== chp058-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  95.22  74.29   97.99   82.98     78.39
1  73.33  54.55   74.30    9.84     16.67
2  72.89  69.66   74.43   56.42     62.35
3  83.22  33.77  100.00  100.00     50.49
4  82.22  42.92   95.95   78.74     55.56
Total accuracy: 53.44%
Average sen: 55.04%
Average spec: 88.53%
Macro f1-score: 52.69%

=== Test on chp059-nsrr. train_data(406), test_data(6) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4282511949539185
Starting epoch 2/10.
Epoch finished! Loss: 1.2717179626226425
Starting epoch 3/10.
Epoch finished! Loss: 1.1805011570453643
Starting epoch 4/10.
Epoch finished! Loss: 1.0938474625349044
Starting epoch 5/10.
Epoch finished! Loss: 1.025082130730152
Starting epoch 6/10.
Epoch finished! Loss: 0.9706923544406891
Starting epoch 7/10.
Epoch finished! Loss: 0.9153838977217674
Starting epoch 8/10.
Epoch finished! Loss: 0.8823814481496811
Starting epoch 9/10.
Epoch finished! Loss: 0.8488469555974006
Starting epoch 10/10.
Epoch finished! Loss: 0.8174132809042931
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7194444444444444
              precision    recall  f1-score   support

         0.0       0.93      0.76      0.83       233
         1.0       0.59      0.50      0.54       238
         2.0       0.70      0.79      0.74       355
         3.0       0.78      0.71      0.75        87
         4.0       0.68      0.84      0.75       167

    accuracy                           0.72      1080
   macro avg       0.73      0.72      0.72      1080
weighted avg       0.73      0.72      0.72      1080
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.52  75.97   98.35  92.67     83.49
1  81.20  49.58   90.14  58.71     53.76
2  81.67  78.59   83.17  69.58     73.81
3  96.11  71.26   98.29  78.48     74.70
4  91.39  84.43   92.66  67.79     75.20
Total accuracy: 71.94%
Average sen: 71.97%
Average spec: 92.52%
Macro f1-score: 72.19%

=== Test on chp060-nsrr. train_data(405), test_data(7) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4513578295707703
Starting epoch 2/10.
Epoch finished! Loss: 1.3036464244127273
Starting epoch 3/10.
Epoch finished! Loss: 1.2041394531726837
Starting epoch 4/10.
Epoch finished! Loss: 1.1189465507864953
Starting epoch 5/10.
Epoch finished! Loss: 1.0549363121390343
Starting epoch 6/10.
Epoch finished! Loss: 0.9802368104457855
Starting epoch 7/10.
Epoch finished! Loss: 0.9477295711636543
Starting epoch 8/10.
Epoch finished! Loss: 0.9145311191678047
Starting epoch 9/10.
Epoch finished! Loss: 0.8774955183267593
Starting epoch 10/10.
Epoch finished! Loss: 0.8573957160115242
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5674603174603174
              precision    recall  f1-score   support

         0.0       0.82      0.85      0.84       519
         1.0       0.11      0.07      0.09       201
         2.0       0.29      0.60      0.39       228
         3.0       0.98      0.40      0.57       158
         4.0       0.91      0.38      0.54       154

    accuracy                           0.57      1260
   macro avg       0.62      0.46      0.48      1260
weighted avg       0.64      0.57      0.57      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.27  85.36   86.91  82.04     83.66
1  76.19   6.97   89.33  11.02      8.54
2  66.67  59.65   68.22  29.31     39.31
3  92.38  39.87   99.91  98.44     56.76
4  91.98  38.31   99.46  90.77     53.88
Total accuracy: 56.75%
Average sen: 46.03%
Average spec: 88.76%
Macro f1-score: 48.43%

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.12  74.39   92.66  62.02     67.64
1  85.76  15.00   96.09  35.90     21.16
2  78.53  84.81   74.67  67.29     75.04
3  91.87  57.52   99.45  95.86     71.90
4  85.93  64.93   90.31  58.27     61.42
Total accuracy: 66.11%
Average sen: 59.33%
Average spec: 90.64%
Macro f1-score: 59.43%
