cuda:0
Subjects num: 78

10min inputs: chc001-nsrr (40)
10min inputs: chc004-nsrr (53)
10min inputs: chc005-nsrr (47)
10min inputs: chc006-nsrr (41)
10min inputs: chc008-nsrr (48)
10min inputs: chc009-nsrr (44)
10min inputs: chc010-nsrr (43)
10min inputs: chc012-nsrr (46)
10min inputs: chc013-nsrr (47)
10min inputs: chc014-nsrr (47)
10min inputs: chc015-nsrr (46)
10min inputs: chc016-nsrr (47)
10min inputs: chc022-nsrr (40)
10min inputs: chc025-nsrr (41)
10min inputs: chc027-nsrr (45)
10min inputs: chc028-nsrr (44)
10min inputs: chc033-nsrr (43)
10min inputs: chc035-nsrr (45)
10min inputs: chc037-nsrr (44)
10min inputs: chc040-nsrr (54)
10min inputs: chc041-nsrr (42)
10min inputs: chc052-nsrr (45)
10min inputs: chc056-nsrr (46)
10min inputs: chp001-nsrr (58)
10min inputs: chp002-nsrr (54)
10min inputs: chp003-nsrr (50)
10min inputs: chp004-nsrr (49)
10min inputs: chp005-nsrr (65)
10min inputs: chp006-nsrr (55)
10min inputs: chp007-nsrr (57)
10min inputs: chp008-nsrr (47)
10min inputs: chp009-nsrr (51)
10min inputs: chp010-nsrr (48)
10min inputs: chp011-nsrr (50)
10min inputs: chp012-nsrr (55)
10min inputs: chp013-nsrr (50)
10min inputs: chp014-nsrr (50)
10min inputs: chp015-nsrr (57)
10min inputs: chp016-nsrr (63)
10min inputs: chp017-nsrr (50)
10min inputs: chp018-nsrr (56)
10min inputs: chp019-nsrr (47)
10min inputs: chp020-nsrr (57)
10min inputs: chp022-nsrr (63)
10min inputs: chp024-nsrr (56)
10min inputs: chp025-nsrr (22)
10min inputs: chp026-nsrr (47)
10min inputs: chp028-nsrr (51)
10min inputs: chp029-nsrr (52)
10min inputs: chp030-nsrr (60)
10min inputs: chp031-nsrr (55)
10min inputs: chp032-nsrr (53)
10min inputs: chp033-nsrr (50)
10min inputs: chp034-nsrr (52)
10min inputs: chp036-nsrr (63)
10min inputs: chp037-nsrr (51)
10min inputs: chp038-nsrr (51)
10min inputs: chp039-nsrr (55)
10min inputs: chp040-nsrr (53)
10min inputs: chp041-nsrr (55)
10min inputs: chp042-nsrr (55)
10min inputs: chp043-nsrr (60)
10min inputs: chp044-nsrr (52)
10min inputs: chp045-nsrr (60)
10min inputs: chp046-nsrr (54)
10min inputs: chp047-nsrr (44)
10min inputs: chp048-nsrr (51)
10min inputs: chp049-nsrr (54)
10min inputs: chp051-nsrr (54)
10min inputs: chp052-nsrr (50)
10min inputs: chp053-nsrr (54)
10min inputs: chp054-nsrr (56)
10min inputs: chp055-nsrr (55)
10min inputs: chp056-nsrr (55)
10min inputs: chp057-nsrr (59)
10min inputs: chp058-nsrr (51)
10min inputs: chp059-nsrr (56)
10min inputs: chp060-nsrr (63)

=== Test on chc001-nsrr. train_data(3939), test_data(40) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2427097173744182
Starting epoch 2/10.
Epoch finished! Loss: 1.030510039426595
Starting epoch 3/10.
Epoch finished! Loss: 0.9541632872804734
Starting epoch 4/10.
Epoch finished! Loss: 0.902176491859305
Starting epoch 5/10.
Epoch finished! Loss: 0.8778514671720015
Starting epoch 6/10.
Epoch finished! Loss: 0.8558699076867285
Starting epoch 7/10.
Epoch finished! Loss: 0.8286231502928503
Starting epoch 8/10.
Epoch finished! Loss: 0.8161829952671934
Starting epoch 9/10.
Epoch finished! Loss: 0.7899741812516715
Starting epoch 10/10.
Epoch finished! Loss: 0.7683185439073402
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.69125
              precision    recall  f1-score   support

         0.0       0.97      0.86      0.91        78
         1.0       0.38      0.06      0.10        50
         2.0       0.85      0.55      0.67       417
         3.0       0.43      1.00      0.61       143
         4.0       0.89      0.98      0.94       112

    accuracy                           0.69       800
   macro avg       0.70      0.69      0.65       800
weighted avg       0.76      0.69      0.68       800
 


====== chc001-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.38   85.90   99.72  97.10     91.16
1  93.50    6.00   99.33  37.50     10.34
2  71.50   55.16   89.30  84.87     66.86
3  76.75  100.00   71.69  43.47     60.59
4  98.12   98.21   98.11  89.43     93.62
Total accuracy: 69.12%
Average sen: 69.05%
Average spec: 91.63%
Macro f1-score: 64.51%

=== Test on chc004-nsrr. train_data(3926), test_data(53) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2291309742295011
Starting epoch 2/10.
Epoch finished! Loss: 1.074315429950247
Starting epoch 3/10.
Epoch finished! Loss: 1.011028720712175
Starting epoch 4/10.
Epoch finished! Loss: 0.9493873984533914
Starting epoch 5/10.
Epoch finished! Loss: 0.9192866617623641
Starting epoch 6/10.
Epoch finished! Loss: 0.8947039619088173
Starting epoch 7/10.
Epoch finished! Loss: 0.8831556737422943
Starting epoch 8/10.
Epoch finished! Loss: 0.8434691189655236
Starting epoch 9/10.
Epoch finished! Loss: 0.8210727557996098
Starting epoch 10/10.
Epoch finished! Loss: 0.7832851617463997
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7971698113207547
              precision    recall  f1-score   support

         0.0       0.82      0.76      0.79        74
         1.0       0.41      0.17      0.24        42
         2.0       0.81      0.85      0.83       519
         3.0       0.91      0.67      0.77       243
         4.0       0.72      0.97      0.83       182

    accuracy                           0.80      1060
   macro avg       0.73      0.68      0.69      1060
weighted avg       0.80      0.80      0.79      1060
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.17  75.68   98.78  82.35     78.87
1  95.75  16.67   99.02  41.18     23.73
2  82.64  84.97   80.41  80.62     82.74
3  90.94  67.49   97.92  90.61     77.36
4  92.92  97.25   92.03  71.66     82.52
Total accuracy: 79.72%
Average sen: 68.41%
Average spec: 93.63%
Macro f1-score: 69.04%

=== Test on chc005-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2797340887193462
Starting epoch 2/10.
Epoch finished! Loss: 1.0803720021369196
Starting epoch 3/10.
Epoch finished! Loss: 1.006481928831445
Starting epoch 4/10.
Epoch finished! Loss: 0.9509382217591652
Starting epoch 5/10.
Epoch finished! Loss: 0.8869934747843948
Starting epoch 6/10.
Epoch finished! Loss: 0.8797856539715337
Starting epoch 7/10.
Epoch finished! Loss: 0.8341082167686094
Starting epoch 8/10.
Epoch finished! Loss: 0.8161164478946278
Starting epoch 9/10.
Epoch finished! Loss: 0.7895817613328686
Starting epoch 10/10.
Epoch finished! Loss: 0.7708085181603905
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8106382978723404
              precision    recall  f1-score   support

         0.0       0.75      0.86      0.80        42
         1.0       0.50      0.03      0.06        33
         2.0       0.92      0.77      0.84       539
         3.0       0.88      0.94      0.91       236
         4.0       0.47      1.00      0.64        90

    accuracy                           0.81       940
   macro avg       0.71      0.72      0.65       940
weighted avg       0.85      0.81      0.81       940
 


====== chc005-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.09   85.71   98.66  75.00     80.00
1  96.49    3.03   99.89  50.00      5.71
2  82.98   76.62   91.52  92.39     83.77
3  95.43   94.07   95.88  88.45     91.17
4  89.15  100.00   88.00  46.88     63.83
Total accuracy: 81.06%
Average sen: 71.89%
Average spec: 94.79%
Macro f1-score: 64.90%

=== Test on chc006-nsrr. train_data(3938), test_data(41) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3501601771240623
Starting epoch 2/10.
Epoch finished! Loss: 1.0259273570912484
Starting epoch 3/10.
Epoch finished! Loss: 0.9433029826360805
Starting epoch 4/10.
Epoch finished! Loss: 0.8939129505448669
Starting epoch 5/10.
Epoch finished! Loss: 0.8647943047318446
Starting epoch 6/10.
Epoch finished! Loss: 0.8564124519133386
Starting epoch 7/10.
Epoch finished! Loss: 0.8326330285794256
Starting epoch 8/10.
Epoch finished! Loss: 0.829180354152927
Starting epoch 9/10.
Epoch finished! Loss: 0.798217422407092
Starting epoch 10/10.
Epoch finished! Loss: 0.7741847846647558
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7048780487804878
              precision    recall  f1-score   support

         0.0       0.90      0.83      0.86       163
         1.0       0.56      0.14      0.22       108
         2.0       0.60      0.88      0.72       306
         3.0       0.87      0.82      0.84       133
         4.0       0.69      0.45      0.54       110

    accuracy                           0.70       820
   macro avg       0.72      0.62      0.64       820
weighted avg       0.71      0.70      0.68       820
 


====== chc006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.76  82.82   97.72  90.00     86.26
1  87.20  13.89   98.31  55.56     22.22
2  74.02  88.24   65.56  60.40     71.71
3  95.12  81.95   97.67  87.20     84.50
4  89.88  44.55   96.90  69.01     54.14
Total accuracy: 70.49%
Average sen: 62.29%
Average spec: 91.23%
Macro f1-score: 63.77%

=== Test on chc008-nsrr. train_data(3931), test_data(48) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3082761700826746
Starting epoch 2/10.
Epoch finished! Loss: 1.0402318189162334
Starting epoch 3/10.
Epoch finished! Loss: 0.9444088553654328
Starting epoch 4/10.
Epoch finished! Loss: 0.8910627518294725
Starting epoch 5/10.
Epoch finished! Loss: 0.8596867436671075
Starting epoch 6/10.
Epoch finished! Loss: 0.8346363823225783
Starting epoch 7/10.
Epoch finished! Loss: 0.8319571697681611
Starting epoch 8/10.
Epoch finished! Loss: 0.8118943954242095
Starting epoch 9/10.
Epoch finished! Loss: 0.7851397350392573
Starting epoch 10/10.
Epoch finished! Loss: 0.7581858626607113
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5510416666666667
              precision    recall  f1-score   support

         0.0       0.46      0.76      0.57       144
         1.0       0.25      0.30      0.27        82
         2.0       0.71      0.56      0.63       379
         3.0       1.00      0.36      0.53       227
         4.0       0.43      0.78      0.55       128

    accuracy                           0.55       960
   macro avg       0.57      0.55      0.51       960
weighted avg       0.66      0.55      0.55       960
 


====== chc008-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  82.81  76.39   83.95   45.64     57.14
1  86.15  30.49   91.34   24.75     27.32
2  73.44  56.20   84.68   70.53     62.56
3  84.79  35.68  100.00  100.00     52.60
4  83.02  78.12   83.77   42.55     55.10
Total accuracy: 55.10%
Average sen: 55.38%
Average spec: 88.75%
Macro f1-score: 50.94%

=== Test on chc009-nsrr. train_data(3935), test_data(44) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3443135365881689
Starting epoch 2/10.
Epoch finished! Loss: 1.025904159964496
Starting epoch 3/10.
Epoch finished! Loss: 0.9364990659494133
Starting epoch 4/10.
Epoch finished! Loss: 0.8874183154591471
Starting epoch 5/10.
Epoch finished! Loss: 0.8460407276796628
Starting epoch 6/10.
Epoch finished! Loss: 0.8333293710652805
Starting epoch 7/10.
Epoch finished! Loss: 0.8251451057483828
Starting epoch 8/10.
Epoch finished! Loss: 0.7952515630776645
Starting epoch 9/10.
Epoch finished! Loss: 0.7744757031818079
Starting epoch 10/10.
Epoch finished! Loss: 0.7505488987945722
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7295454545454545
              precision    recall  f1-score   support

         0.0       0.45      1.00      0.62        72
         1.0       0.05      0.04      0.04        46
         2.0       0.90      0.63      0.74       453
         3.0       0.99      0.88      0.93       196
         4.0       0.60      0.96      0.74       113

    accuracy                           0.73       880
   macro avg       0.60      0.70      0.62       880
weighted avg       0.80      0.73      0.74       880
 


====== chc009-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  90.00  100.00   89.11  45.00     62.07
1  90.23    4.35   94.96   4.55      4.44
2  77.39   63.36   92.27  89.69     74.26
3  97.16   87.76   99.85  99.42     93.22
4  91.14   96.46   90.35  59.56     73.65
Total accuracy: 72.95%
Average sen: 70.38%
Average spec: 93.31%
Macro f1-score: 61.53%

=== Test on chc010-nsrr. train_data(3936), test_data(43) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2391352002857297
Starting epoch 2/10.
Epoch finished! Loss: 1.0346707381668285
Starting epoch 3/10.
Epoch finished! Loss: 0.943105917547192
Starting epoch 4/10.
Epoch finished! Loss: 0.8973373104901108
Starting epoch 5/10.
Epoch finished! Loss: 0.8685895552616993
Starting epoch 6/10.
Epoch finished! Loss: 0.8385709368697256
Starting epoch 7/10.
Epoch finished! Loss: 0.8215437041590838
Starting epoch 8/10.
Epoch finished! Loss: 0.7964545313183587
Starting epoch 9/10.
Epoch finished! Loss: 0.7681051206042748
Starting epoch 10/10.
Epoch finished! Loss: 0.7430346618778529
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7581395348837209
              precision    recall  f1-score   support

         0.0       0.90      0.70      0.79       123
         1.0       0.80      0.09      0.17        43
         2.0       0.72      0.95      0.82       420
         3.0       0.89      0.44      0.59       193
         4.0       0.70      0.98      0.81        81

    accuracy                           0.76       860
   macro avg       0.80      0.63      0.64       860
weighted avg       0.79      0.76      0.73       860
 


====== chc010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.53  69.92   98.64  89.58     78.54
1  95.35   9.30   99.88  80.00     16.67
2  79.77  94.76   65.45  72.36     82.06
3  86.16  44.04   98.35  88.54     58.82
4  95.81  97.53   95.64  69.91     81.44
Total accuracy: 75.81%
Average sen: 63.11%
Average spec: 91.59%
Macro f1-score: 63.51%

=== Test on chc012-nsrr. train_data(3933), test_data(46) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2234511631742384
Starting epoch 2/10.
Epoch finished! Loss: 1.0412715564247306
Starting epoch 3/10.
Epoch finished! Loss: 0.9897722752039669
Starting epoch 4/10.
Epoch finished! Loss: 0.9381657954087391
Starting epoch 5/10.
Epoch finished! Loss: 0.8998924823662707
Starting epoch 6/10.
Epoch finished! Loss: 0.8747655800129014
Starting epoch 7/10.
Epoch finished! Loss: 0.8416413464619004
Starting epoch 8/10.
Epoch finished! Loss: 0.8192118739960454
Starting epoch 9/10.
Epoch finished! Loss: 0.8107251954139341
Starting epoch 10/10.
Epoch finished! Loss: 0.770084935138547
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6858695652173913
              precision    recall  f1-score   support

         0.0       0.56      0.56      0.56        64
         1.0       0.03      0.04      0.04        23
         2.0       0.82      0.72      0.77       559
         3.0       1.00      0.59      0.74       204
         4.0       0.33      1.00      0.49        70

    accuracy                           0.69       920
   macro avg       0.55      0.58      0.52       920
weighted avg       0.79      0.69      0.71       920
 


====== chc012-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  93.91   56.25   96.73   56.25     56.25
1  94.24    4.35   96.54    3.12      3.64
2  73.70   72.09   76.18   82.41     76.91
3  90.98   59.31  100.00  100.00     74.46
4  84.35  100.00   83.06   32.71     49.30
Total accuracy: 68.59%
Average sen: 58.40%
Average spec: 90.50%
Macro f1-score: 52.11%

=== Test on chc013-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2700733524242431
Starting epoch 2/10.
Epoch finished! Loss: 1.0419496109770758
Starting epoch 3/10.
Epoch finished! Loss: 0.941903584027715
Starting epoch 4/10.
Epoch finished! Loss: 0.8959009045256306
Starting epoch 5/10.
Epoch finished! Loss: 0.8819888742218794
Starting epoch 6/10.
Epoch finished! Loss: 0.8418367172167198
Starting epoch 7/10.
Epoch finished! Loss: 0.8286940599519181
Starting epoch 8/10.
Epoch finished! Loss: 0.8086321826351205
Starting epoch 9/10.
Epoch finished! Loss: 0.7705608987019565
Starting epoch 10/10.
Epoch finished! Loss: 0.7680843955536228
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7861702127659574
              precision    recall  f1-score   support

         0.0       0.91      0.84      0.87        69
         1.0       0.37      0.33      0.35        40
         2.0       0.73      0.90      0.81       434
         3.0       0.97      0.50      0.66       228
         4.0       0.86      0.96      0.91       169

    accuracy                           0.79       940
   macro avg       0.77      0.71      0.72       940
weighted avg       0.81      0.79      0.78       940
 


====== chc013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.19  84.06   99.31  90.62     87.22
1  94.79  32.50   97.56  37.14     34.67
2  80.32  90.32   71.74  73.27     80.91
3  87.45  50.00   99.44  96.61     65.90
4  96.49  95.86   96.63  86.17     90.76
Total accuracy: 78.62%
Average sen: 70.55%
Average spec: 92.93%
Macro f1-score: 71.89%

=== Test on chc014-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.220985999695824
Starting epoch 2/10.
Epoch finished! Loss: 1.0249857447529567
Starting epoch 3/10.
Epoch finished! Loss: 0.9486385444345061
Starting epoch 4/10.
Epoch finished! Loss: 0.9103525012504053
Starting epoch 5/10.
Epoch finished! Loss: 0.8814057736603055
Starting epoch 6/10.
Epoch finished! Loss: 0.8460562351247434
Starting epoch 7/10.
Epoch finished! Loss: 0.8247851663418398
Starting epoch 8/10.
Epoch finished! Loss: 0.810019032949103
Starting epoch 9/10.
Epoch finished! Loss: 0.7955077888098079
Starting epoch 10/10.
Epoch finished! Loss: 0.7696965596148075
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.9053191489361702
              precision    recall  f1-score   support

         0.0       1.00      1.00      1.00       240
         1.0       0.29      0.33      0.31         6
         2.0       0.85      0.98      0.91       439
         3.0       0.98      0.85      0.91       180
         4.0       0.89      0.33      0.49        75

    accuracy                           0.91       940
   macro avg       0.80      0.70      0.72       940
weighted avg       0.91      0.91      0.90       940
 


====== chc014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  99.89  99.58  100.00  100.00     99.79
1  99.04  33.33   99.46   28.57     30.77
2  90.96  98.41   84.43   84.71     91.04
3  96.81  85.00   99.61   98.08     91.07
4  94.36  33.33   99.65   89.29     48.54
Total accuracy: 90.53%
Average sen: 69.93%
Average spec: 96.63%
Macro f1-score: 72.24%

=== Test on chc015-nsrr. train_data(3933), test_data(46) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2127776180818184
Starting epoch 2/10.
Epoch finished! Loss: 1.0562169815747793
Starting epoch 3/10.
Epoch finished! Loss: 0.9750413128741218
Starting epoch 4/10.
Epoch finished! Loss: 0.9333566785162035
Starting epoch 5/10.
Epoch finished! Loss: 0.8871371109067029
Starting epoch 6/10.
Epoch finished! Loss: 0.868538387024979
Starting epoch 7/10.
Epoch finished! Loss: 0.8314580901433494
Starting epoch 8/10.
Epoch finished! Loss: 0.806707770542334
Starting epoch 9/10.
Epoch finished! Loss: 0.7753621756120492
Starting epoch 10/10.
Epoch finished! Loss: 0.7586718564118441
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7945652173913044
              precision    recall  f1-score   support

         0.0       0.71      0.81      0.76        37
         1.0       0.67      0.07      0.13        82
         2.0       0.81      0.87      0.84       494
         3.0       0.72      1.00      0.84       166
         4.0       0.88      0.70      0.78       141

    accuracy                           0.79       920
   macro avg       0.76      0.69      0.67       920
weighted avg       0.79      0.79      0.77       920
 


====== chc015-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  97.93   81.08   98.64  71.43     75.95
1  91.41    7.32   99.64  66.67     13.19
2  82.39   87.04   77.00  81.44     84.15
3  93.15  100.00   91.64  72.49     84.05
4  94.02   70.21   98.33  88.39     78.26
Total accuracy: 79.46%
Average sen: 69.13%
Average spec: 93.05%
Macro f1-score: 67.12%

=== Test on chc016-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2594351982342378
Starting epoch 2/10.
Epoch finished! Loss: 1.0884054877982492
Starting epoch 3/10.
Epoch finished! Loss: 1.0193129168211958
Starting epoch 4/10.
Epoch finished! Loss: 0.9984444134107983
Starting epoch 5/10.
Epoch finished! Loss: 0.9428733969462737
Starting epoch 6/10.
Epoch finished! Loss: 0.8999907805112786
Starting epoch 7/10.
Epoch finished! Loss: 0.8684648395191319
Starting epoch 8/10.
Epoch finished! Loss: 0.8310673580369876
Starting epoch 9/10.
Epoch finished! Loss: 0.8056625632839348
Starting epoch 10/10.
Epoch finished! Loss: 0.7865939073586888
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7787234042553192
              precision    recall  f1-score   support

         0.0       0.77      0.94      0.84       226
         1.0       0.50      0.04      0.07        55
         2.0       0.74      0.97      0.84       410
         3.0       0.99      0.64      0.78       108
         4.0       0.98      0.35      0.52       141

    accuracy                           0.78       940
   macro avg       0.79      0.59      0.61       940
weighted avg       0.80      0.78      0.74       940
 


====== chc016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.70  93.81   91.04  76.81     84.46
1  94.15   3.64   99.77  50.00      6.78
2  83.94  97.32   73.58  74.03     84.09
3  95.74  63.89   99.88  98.57     77.53
4  90.21  35.46   99.87  98.04     52.08
Total accuracy: 77.87%
Average sen: 58.82%
Average spec: 92.83%
Macro f1-score: 60.99%

=== Test on chc022-nsrr. train_data(3939), test_data(40) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3377528029847083
Starting epoch 2/10.
Epoch finished! Loss: 1.0960459213220437
Starting epoch 3/10.
Epoch finished! Loss: 0.9706144736316671
Starting epoch 4/10.
Epoch finished! Loss: 0.925877227128007
Starting epoch 5/10.
Epoch finished! Loss: 0.8734472224882237
Starting epoch 6/10.
Epoch finished! Loss: 0.85683700859395
Starting epoch 7/10.
Epoch finished! Loss: 0.8342631723892902
Starting epoch 8/10.
Epoch finished! Loss: 0.8054312688248758
Starting epoch 9/10.
Epoch finished! Loss: 0.7817785585957933
Starting epoch 10/10.
Epoch finished! Loss: 0.7515077862424098
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.69375
              precision    recall  f1-score   support

         0.0       0.89      0.32      0.47       102
         1.0       1.00      0.07      0.12        15
         2.0       0.97      0.59      0.74       387
         3.0       0.66      0.97      0.78       187
         4.0       0.44      1.00      0.61       109

    accuracy                           0.69       800
   macro avg       0.79      0.59      0.55       800
weighted avg       0.82      0.69      0.69       800
 


====== chc022-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  90.88   32.35   99.43   89.19     47.48
1  98.25    6.67  100.00  100.00     12.50
2  79.62   59.43   98.55   97.46     73.84
3  87.50   97.33   84.50   65.70     78.45
4  82.50  100.00   79.74   43.78     60.89
Total accuracy: 69.38%
Average sen: 59.16%
Average spec: 92.44%
Macro f1-score: 54.63%

=== Test on chc025-nsrr. train_data(3938), test_data(41) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2613788439723979
Starting epoch 2/10.
Epoch finished! Loss: 1.0460272350990742
Starting epoch 3/10.
Epoch finished! Loss: 0.9717557346851164
Starting epoch 4/10.
Epoch finished! Loss: 0.9468255604193108
Starting epoch 5/10.
Epoch finished! Loss: 0.9046045740445455
Starting epoch 6/10.
Epoch finished! Loss: 0.8759175842348249
Starting epoch 7/10.
Epoch finished! Loss: 0.8461911197533741
Starting epoch 8/10.
Epoch finished! Loss: 0.8254503823873651
Starting epoch 9/10.
Epoch finished! Loss: 0.8162407068199177
Starting epoch 10/10.
Epoch finished! Loss: 0.7800546453047648
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6195121951219512
              precision    recall  f1-score   support

         0.0       0.12      0.57      0.20        30
         1.0       0.06      0.03      0.04        77
         2.0       0.71      0.89      0.79       427
         3.0       1.00      0.49      0.66       114
         4.0       0.82      0.32      0.46       172

    accuracy                           0.62       820
   macro avg       0.54      0.46      0.43       820
weighted avg       0.69      0.62      0.61       820
 


====== chc025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  83.78  56.67   84.81   12.41     20.36
1  87.32   2.60   96.10    6.45      3.70
2  75.61  88.52   61.58   71.46     79.08
3  92.93  49.12  100.00  100.00     65.88
4  84.27  31.98   98.15   82.09     46.03
Total accuracy: 61.95%
Average sen: 45.78%
Average spec: 88.13%
Macro f1-score: 43.01%

=== Test on chc027-nsrr. train_data(3934), test_data(45) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2635622471950132
Starting epoch 2/10.
Epoch finished! Loss: 1.0333761765453349
Starting epoch 3/10.
Epoch finished! Loss: 0.963911492405957
Starting epoch 4/10.
Epoch finished! Loss: 0.9129321000351553
Starting epoch 5/10.
Epoch finished! Loss: 0.8805553012980153
Starting epoch 6/10.
Epoch finished! Loss: 0.8494934715690807
Starting epoch 7/10.
Epoch finished! Loss: 0.8463629607025903
Starting epoch 8/10.
Epoch finished! Loss: 0.8264124404079738
Starting epoch 9/10.
Epoch finished! Loss: 0.8034021837717401
Starting epoch 10/10.
Epoch finished! Loss: 0.7833962056776342
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8122222222222222
              precision    recall  f1-score   support

         0.0       0.75      0.99      0.85       277
         1.0       0.00      0.00      0.00        66
         2.0       0.78      0.95      0.86       293
         3.0       1.00      0.84      0.91       189
         4.0       1.00      0.29      0.45        75

    accuracy                           0.81       900
   macro avg       0.71      0.61      0.61       900
weighted avg       0.78      0.81      0.77       900
 


====== chc027-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  89.44  98.92   85.23   74.86     85.23
1  92.67   0.00  100.00    0.00      0.00
2  89.67  94.54   87.31   78.25     85.63
3  96.56  83.60  100.00  100.00     91.07
4  94.11  29.33  100.00  100.00     45.36
Total accuracy: 81.22%
Average sen: 61.28%
Average spec: 94.51%
Macro f1-score: 61.46%

=== Test on chc028-nsrr. train_data(3935), test_data(44) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2171641084680727
Starting epoch 2/10.
Epoch finished! Loss: 1.014742048945439
Starting epoch 3/10.
Epoch finished! Loss: 0.933708095520204
Starting epoch 4/10.
Epoch finished! Loss: 0.9067633638855155
Starting epoch 5/10.
Epoch finished! Loss: 0.8563279967574976
Starting epoch 6/10.
Epoch finished! Loss: 0.8286736058521513
Starting epoch 7/10.
Epoch finished! Loss: 0.8050774364677701
Starting epoch 8/10.
Epoch finished! Loss: 0.7936073740323385
Starting epoch 9/10.
Epoch finished! Loss: 0.7778983816087398
Starting epoch 10/10.
Epoch finished! Loss: 0.7554684298032416
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8079545454545455
              precision    recall  f1-score   support

         0.0       0.82      0.72      0.77       129
         1.0       0.11      0.04      0.06        53
         2.0       0.88      0.88      0.88       460
         3.0       0.90      0.96      0.93       164
         4.0       0.48      0.70      0.57        74

    accuracy                           0.81       880
   macro avg       0.64      0.66      0.64       880
weighted avg       0.79      0.81      0.80       880
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.52  72.09   97.20  81.58     76.54
1  92.39   3.77   98.07  11.11      5.63
2  87.27  88.26   86.19  87.50     87.88
3  97.39  96.34   97.63  90.29     93.22
4  91.02  70.27   92.93  47.71     56.83
Total accuracy: 80.80%
Average sen: 66.15%
Average spec: 94.40%
Macro f1-score: 64.02%

=== Test on chc033-nsrr. train_data(3936), test_data(43) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2217488771176521
Starting epoch 2/10.
Epoch finished! Loss: 1.058240451733878
Starting epoch 3/10.
Epoch finished! Loss: 0.9661942309398991
Starting epoch 4/10.
Epoch finished! Loss: 0.9179271002307193
Starting epoch 5/10.
Epoch finished! Loss: 0.890272732378569
Starting epoch 6/10.
Epoch finished! Loss: 0.8677234731557715
Starting epoch 7/10.
Epoch finished! Loss: 0.8456106926042009
Starting epoch 8/10.
Epoch finished! Loss: 0.8095711383200784
Starting epoch 9/10.
Epoch finished! Loss: 0.7952014426238664
Starting epoch 10/10.
Epoch finished! Loss: 0.7832812264220406
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7802325581395348
              precision    recall  f1-score   support

         0.0       0.83      0.25      0.39        59
         1.0       0.00      0.00      0.00        60
         2.0       0.80      0.95      0.87       379
         3.0       0.91      0.95      0.93       151
         4.0       0.65      0.72      0.68       211

    accuracy                           0.78       860
   macro avg       0.64      0.57      0.57       860
weighted avg       0.73      0.78      0.74       860
 


====== chc033-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.53  25.42   99.63  83.33     38.96
1  93.02   0.00  100.00   0.00      0.00
2  87.56  95.25   81.50  80.22     87.09
3  97.33  94.70   97.88  90.51     92.56
4  83.60  72.04   87.37  64.96     68.31
Total accuracy: 78.02%
Average sen: 57.48%
Average spec: 93.27%
Macro f1-score: 57.39%

=== Test on chc035-nsrr. train_data(3934), test_data(45) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2202220695619366
Starting epoch 2/10.
Epoch finished! Loss: 1.0457910140052096
Starting epoch 3/10.
Epoch finished! Loss: 0.9890512297778336
Starting epoch 4/10.
Epoch finished! Loss: 0.9339486151251174
Starting epoch 5/10.
Epoch finished! Loss: 0.9139530713321599
Starting epoch 6/10.
Epoch finished! Loss: 0.8879392153889168
Starting epoch 7/10.
Epoch finished! Loss: 0.857538252386428
Starting epoch 8/10.
Epoch finished! Loss: 0.8431510160897524
Starting epoch 9/10.
Epoch finished! Loss: 0.8156582628194309
Starting epoch 10/10.
Epoch finished! Loss: 0.7804934344522219
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7
              precision    recall  f1-score   support

         0.0       0.15      0.97      0.27        29
         1.0       0.33      0.02      0.03        57
         2.0       0.84      0.79      0.81       391
         3.0       0.96      0.86      0.91       250
         4.0       0.63      0.44      0.52       173

    accuracy                           0.70       900
   macro avg       0.58      0.62      0.51       900
weighted avg       0.78      0.70      0.72       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.89  96.55   82.43  15.47     26.67
1  93.56   1.75   99.76  33.33      3.33
2  84.22  79.03   88.21  83.74     81.32
3  95.11  86.40   98.46  95.58     90.76
4  84.22  43.93   93.81  62.81     51.70
Total accuracy: 70.00%
Average sen: 61.53%
Average spec: 92.54%
Macro f1-score: 50.75%

=== Test on chc037-nsrr. train_data(3935), test_data(44) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2605791563599467
Starting epoch 2/10.
Epoch finished! Loss: 1.0227746767852142
Starting epoch 3/10.
Epoch finished! Loss: 0.9288227272246024
Starting epoch 4/10.
Epoch finished! Loss: 0.8980876814773064
Starting epoch 5/10.
Epoch finished! Loss: 0.8522899177389898
Starting epoch 6/10.
Epoch finished! Loss: 0.8481812192738512
Starting epoch 7/10.
Epoch finished! Loss: 0.8191039236902281
Starting epoch 8/10.
Epoch finished! Loss: 0.8078001913526889
Starting epoch 9/10.
Epoch finished! Loss: 0.7731142092600427
Starting epoch 10/10.
Epoch finished! Loss: 0.767556466446578
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8931818181818182
              precision    recall  f1-score   support

         0.0       0.96      0.97      0.96       154
         1.0       0.58      0.44      0.50        34
         2.0       0.86      0.94      0.90       317
         3.0       0.98      0.94      0.96       168
         4.0       0.87      0.80      0.84       207

    accuracy                           0.89       880
   macro avg       0.85      0.82      0.83       880
weighted avg       0.89      0.89      0.89       880
 


====== chc037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.75  96.75   99.17  96.13     96.44
1  96.59  44.12   98.70  57.69     50.00
2  92.16  94.01   91.12  85.63     89.62
3  98.52  94.05   99.58  98.14     96.05
4  92.61  80.19   96.43  87.37     83.63
Total accuracy: 89.32%
Average sen: 81.82%
Average spec: 97.00%
Macro f1-score: 83.15%

=== Test on chc040-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2735859996506147
Starting epoch 2/10.
Epoch finished! Loss: 1.082439512014389
Starting epoch 3/10.
Epoch finished! Loss: 0.9792338250851145
Starting epoch 4/10.
Epoch finished! Loss: 0.904199519631814
Starting epoch 5/10.
Epoch finished! Loss: 0.8622628999303799
Starting epoch 6/10.
Epoch finished! Loss: 0.8457147127815655
Starting epoch 7/10.
Epoch finished! Loss: 0.8092972754823918
Starting epoch 8/10.
Epoch finished! Loss: 0.7825422492258403
Starting epoch 9/10.
Epoch finished! Loss: 0.7672626041636175
Starting epoch 10/10.
Epoch finished! Loss: 0.7388666621124258
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.712037037037037
              precision    recall  f1-score   support

         0.0       0.94      0.51      0.66       185
         1.0       0.27      0.38      0.32        50
         2.0       0.67      0.95      0.79       483
         3.0       0.91      0.41      0.57       216
         4.0       0.82      0.74      0.78       146

    accuracy                           0.71      1080
   macro avg       0.72      0.60      0.62      1080
weighted avg       0.77      0.71      0.70      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.11  51.35   99.33  94.06     66.43
1  92.41  38.00   95.05  27.14     31.67
2  77.13  94.82   62.81  67.35     78.76
3  87.41  41.20   98.96  90.82     56.69
4  94.35  73.97   97.54  82.44     77.98
Total accuracy: 71.20%
Average sen: 59.87%
Average spec: 90.74%
Macro f1-score: 62.31%

=== Test on chc041-nsrr. train_data(3937), test_data(42) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.1808545418064709
Starting epoch 2/10.
Epoch finished! Loss: 0.9940955141421796
Starting epoch 3/10.
Epoch finished! Loss: 0.9371413884272102
Starting epoch 4/10.
Epoch finished! Loss: 0.9087898276234401
Starting epoch 5/10.
Epoch finished! Loss: 0.8831104627092377
Starting epoch 6/10.
Epoch finished! Loss: 0.8643268288395181
Starting epoch 7/10.
Epoch finished! Loss: 0.8176166175582633
Starting epoch 8/10.
Epoch finished! Loss: 0.7952489245483894
Starting epoch 9/10.
Epoch finished! Loss: 0.7843725487172756
Starting epoch 10/10.
Epoch finished! Loss: 0.7735042211056969
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7892857142857143
              precision    recall  f1-score   support

         0.0       0.39      0.96      0.56        56
         1.0       0.20      0.18      0.19        38
         2.0       0.87      0.86      0.87       416
         3.0       0.94      0.87      0.91       188
         4.0       0.95      0.57      0.71       142

    accuracy                           0.79       840
   macro avg       0.67      0.69      0.65       840
weighted avg       0.84      0.79      0.80       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.88  96.43   89.41  39.42     55.96
1  92.98  18.42   96.51  20.00     19.18
2  86.79  85.82   87.74  87.29     86.55
3  95.95  87.23   98.47  94.25     90.61
4  92.26  57.04   99.43  95.29     71.37
Total accuracy: 78.93%
Average sen: 68.99%
Average spec: 94.31%
Macro f1-score: 64.73%

=== Test on chc052-nsrr. train_data(3934), test_data(45) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2169734057579331
Starting epoch 2/10.
Epoch finished! Loss: 1.0328399300878588
Starting epoch 3/10.
Epoch finished! Loss: 0.9514072623871664
Starting epoch 4/10.
Epoch finished! Loss: 0.9168648547646957
Starting epoch 5/10.
Epoch finished! Loss: 0.883481798508695
Starting epoch 6/10.
Epoch finished! Loss: 0.8641732036309084
Starting epoch 7/10.
Epoch finished! Loss: 0.8358870486115074
Starting epoch 8/10.
Epoch finished! Loss: 0.8224662584051224
Starting epoch 9/10.
Epoch finished! Loss: 0.7980597746432889
Starting epoch 10/10.
Epoch finished! Loss: 0.7859947799726297
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8277777777777777
              precision    recall  f1-score   support

         0.0       0.85      0.97      0.91       142
         1.0       0.07      0.04      0.05        23
         2.0       0.91      0.78      0.84       466
         3.0       0.89      0.86      0.88       167
         4.0       0.61      0.97      0.75       102

    accuracy                           0.83       900
   macro avg       0.67      0.73      0.69       900
weighted avg       0.84      0.83      0.83       900
 


====== chc052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.89  97.18   96.83  85.19     90.79
1  96.00   4.35   98.40   6.67      5.26
2  84.56  77.90   91.71  90.98     83.93
3  95.56  86.23   97.68  89.44     87.80
4  92.56  97.06   91.98  60.74     74.72
Total accuracy: 82.78%
Average sen: 72.54%
Average spec: 95.32%
Macro f1-score: 68.50%

=== Test on chc056-nsrr. train_data(3933), test_data(46) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2667270862419187
Starting epoch 2/10.
Epoch finished! Loss: 1.0427437570258862
Starting epoch 3/10.
Epoch finished! Loss: 0.9574149633181914
Starting epoch 4/10.
Epoch finished! Loss: 0.9069368447966248
Starting epoch 5/10.
Epoch finished! Loss: 0.8712996114756315
Starting epoch 6/10.
Epoch finished! Loss: 0.8410210110455676
Starting epoch 7/10.
Epoch finished! Loss: 0.8270145246697442
Starting epoch 8/10.
Epoch finished! Loss: 0.8112851429834924
Starting epoch 9/10.
Epoch finished! Loss: 0.7884656798293572
Starting epoch 10/10.
Epoch finished! Loss: 0.767026629687569
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.8021739130434783
              precision    recall  f1-score   support

         0.0       0.85      0.81      0.83       191
         1.0       0.58      0.08      0.14        89
         2.0       0.75      0.99      0.85       397
         3.0       1.00      0.68      0.81       153
         4.0       0.84      0.89      0.86        90

    accuracy                           0.80       920
   macro avg       0.80      0.69      0.70       920
weighted avg       0.80      0.80      0.77       920
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.04  81.15   96.16   84.70     82.89
1  90.54   7.87   99.40   58.33     13.86
2  84.89  98.74   74.38   74.52     84.94
3  94.67  67.97  100.00  100.00     80.93
4  97.28  88.89   98.19   84.21     86.49
Total accuracy: 80.22%
Average sen: 68.92%
Average spec: 93.63%
Macro f1-score: 69.82%

=== Test on chp001-nsrr. train_data(3921), test_data(58) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3293152816441594
Starting epoch 2/10.
Epoch finished! Loss: 1.0470432114540313
Starting epoch 3/10.
Epoch finished! Loss: 0.950798114951776
Starting epoch 4/10.
Epoch finished! Loss: 0.9043607915542564
Starting epoch 5/10.
Epoch finished! Loss: 0.8641333199125163
Starting epoch 6/10.
Epoch finished! Loss: 0.8386261167422849
Starting epoch 7/10.
Epoch finished! Loss: 0.810379300874715
Starting epoch 8/10.
Epoch finished! Loss: 0.7928306306807362
Starting epoch 9/10.
Epoch finished! Loss: 0.7739964925817081
Starting epoch 10/10.
Epoch finished! Loss: 0.7714524867431242
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5043103448275862
              precision    recall  f1-score   support

         0.0       0.12      0.93      0.22        55
         1.0       0.08      0.11      0.09        79
         2.0       0.81      0.87      0.84       553
         3.0       0.98      0.61      0.75        69
         4.0       1.00      0.01      0.02       404

    accuracy                           0.50      1160
   macro avg       0.60      0.51      0.38      1160
weighted avg       0.81      0.50      0.47      1160
 


====== chp001-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  68.45  92.73   67.24   12.35     21.79
1  85.09  11.39   90.47    8.04      9.42
2  84.22  86.62   82.04   81.46     83.96
3  97.59  60.87   99.91   97.67     75.00
4  65.52   0.99  100.00  100.00      1.96
Total accuracy: 50.43%
Average sen: 50.52%
Average spec: 87.93%
Macro f1-score: 38.43%

=== Test on chp002-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2179169872281503
Starting epoch 2/10.
Epoch finished! Loss: 1.0143097742479674
Starting epoch 3/10.
Epoch finished! Loss: 0.9430042663399054
Starting epoch 4/10.
Epoch finished! Loss: 0.9069822774249681
Starting epoch 5/10.
Epoch finished! Loss: 0.8705271217896013
Starting epoch 6/10.
Epoch finished! Loss: 0.8503674971205848
Starting epoch 7/10.
Epoch finished! Loss: 0.8185551904750114
Starting epoch 8/10.
Epoch finished! Loss: 0.7991738079153762
Starting epoch 9/10.
Epoch finished! Loss: 0.7948223085579823
Starting epoch 10/10.
Epoch finished! Loss: 0.7616643656273278
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6722222222222223
              precision    recall  f1-score   support

         0.0       0.63      0.50      0.56       260
         1.0       0.84      0.20      0.32       248
         2.0       0.81      0.95      0.88       375
         3.0       0.94      0.98      0.96       169
         4.0       0.11      0.79      0.20        28

    accuracy                           0.67      1080
   macro avg       0.67      0.68      0.58      1080
weighted avg       0.78      0.67      0.67      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.83  50.38   90.49  62.68     55.86
1  80.74  19.76   98.92  84.48     32.03
2  90.74  95.47   88.23  81.18     87.75
3  98.80  98.22   98.90  94.32     96.23
4  83.33  78.57   83.46  11.22     19.64
Total accuracy: 67.22%
Average sen: 68.48%
Average spec: 92.00%
Macro f1-score: 58.30%

=== Test on chp003-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.335094380591597
Starting epoch 2/10.
Epoch finished! Loss: 1.0538051399041195
Starting epoch 3/10.
Epoch finished! Loss: 0.9494536377641619
Starting epoch 4/10.
Epoch finished! Loss: 0.9083604856717343
Starting epoch 5/10.
Epoch finished! Loss: 0.8691037877329758
Starting epoch 6/10.
Epoch finished! Loss: 0.8520121357726808
Starting epoch 7/10.
Epoch finished! Loss: 0.8299051766492882
Starting epoch 8/10.
Epoch finished! Loss: 0.7935161804210167
Starting epoch 9/10.
Epoch finished! Loss: 0.76192105371429
Starting epoch 10/10.
Epoch finished! Loss: 0.7479141638899336
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.645
              precision    recall  f1-score   support

         0.0       0.31      0.68      0.43        90
         1.0       0.17      0.63      0.27        38
         2.0       0.82      0.75      0.78       478
         3.0       1.00      0.70      0.83       196
         4.0       0.70      0.32      0.44       198

    accuracy                           0.65      1000
   macro avg       0.60      0.62      0.55      1000
weighted avg       0.76      0.65      0.67      1000
 


====== chp003-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0   83.8  67.78   85.38   31.44     42.96
1   87.1  63.16   88.05   17.27     27.12
2   80.0  74.90   84.67   81.74     78.17
3   94.2  70.41  100.00  100.00     82.63
4   83.9  32.32   96.63   70.33     44.29
Total accuracy: 64.50%
Average sen: 61.71%
Average spec: 90.95%
Macro f1-score: 55.03%

=== Test on chp004-nsrr. train_data(3930), test_data(49) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2203172509159361
Starting epoch 2/10.
Epoch finished! Loss: 0.9986527174407122
Starting epoch 3/10.
Epoch finished! Loss: 0.9514668894057371
Starting epoch 4/10.
Epoch finished! Loss: 0.8987791577772218
Starting epoch 5/10.
Epoch finished! Loss: 0.8618912968252387
Starting epoch 6/10.
Epoch finished! Loss: 0.8470977416300044
Starting epoch 7/10.
Epoch finished! Loss: 0.8125131254901692
Starting epoch 8/10.
Epoch finished! Loss: 0.7962562254040825
Starting epoch 9/10.
Epoch finished! Loss: 0.784184418162521
Starting epoch 10/10.
Epoch finished! Loss: 0.7644032909705931
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6530612244897959
              precision    recall  f1-score   support

         0.0       0.51      0.67      0.58       135
         1.0       0.41      0.16      0.23       141
         2.0       0.64      0.88      0.74       354
         3.0       0.92      0.73      0.81       197
         4.0       0.70      0.48      0.57       153

    accuracy                           0.65       980
   macro avg       0.64      0.58      0.59       980
weighted avg       0.65      0.65      0.63       980
 


====== chp004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.63  66.67   89.82  51.14     57.88
1  84.59  16.31   96.07  41.07     23.35
2  77.55  87.85   71.73  63.73     73.87
3  93.27  72.59   98.47  92.26     81.25
4  88.57  47.71   96.13  69.52     56.59
Total accuracy: 65.31%
Average sen: 58.23%
Average spec: 90.44%
Macro f1-score: 58.59%

=== Test on chp005-nsrr. train_data(3914), test_data(65) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.292267382449811
Starting epoch 2/10.
Epoch finished! Loss: 1.0524012653724006
Starting epoch 3/10.
Epoch finished! Loss: 0.973000501427809
Starting epoch 4/10.
Epoch finished! Loss: 0.9217158441653337
Starting epoch 5/10.
Epoch finished! Loss: 0.8895925902344687
Starting epoch 6/10.
Epoch finished! Loss: 0.869688124912779
Starting epoch 7/10.
Epoch finished! Loss: 0.8451222268211872
Starting epoch 8/10.
Epoch finished! Loss: 0.8265291540061727
Starting epoch 9/10.
Epoch finished! Loss: 0.8045670506746873
Starting epoch 10/10.
Epoch finished! Loss: 0.7872517674475374
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6615384615384615
              precision    recall  f1-score   support

         0.0       0.27      0.78      0.41        79
         1.0       0.48      0.12      0.19       238
         2.0       0.84      0.75      0.79       565
         3.0       0.57      0.99      0.72       136
         4.0       0.78      0.75      0.76       282

    accuracy                           0.66      1300
   macro avg       0.59      0.68      0.57      1300
weighted avg       0.70      0.66      0.65      1300
 


====== chp005-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.08  78.48   86.57  27.43     40.66
1  81.46  12.18   96.99  47.54     19.40
2  83.00  75.04   89.12  84.13     79.33
3  91.92  98.53   91.15  56.54     71.85
4  89.85  74.82   94.01  77.57     76.17
Total accuracy: 66.15%
Average sen: 67.81%
Average spec: 91.57%
Macro f1-score: 57.48%

=== Test on chp006-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2131198378545898
Starting epoch 2/10.
Epoch finished! Loss: 1.0242191279421047
Starting epoch 3/10.
Epoch finished! Loss: 0.9543153790338915
Starting epoch 4/10.
Epoch finished! Loss: 0.9059121794238383
Starting epoch 5/10.
Epoch finished! Loss: 0.8711535475996076
Starting epoch 6/10.
Epoch finished! Loss: 0.8690739064192285
Starting epoch 7/10.
Epoch finished! Loss: 0.8227404603088389
Starting epoch 8/10.
Epoch finished! Loss: 0.8054486450796224
Starting epoch 9/10.
Epoch finished! Loss: 0.7813417379345212
Starting epoch 10/10.
Epoch finished! Loss: 0.7690645330870638
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6218181818181818
              precision    recall  f1-score   support

         0.0       0.63      0.46      0.53       120
         1.0       0.61      0.33      0.43       329
         2.0       0.49      0.98      0.65       287
         3.0       0.99      0.75      0.85       224
         4.0       0.79      0.51      0.62       140

    accuracy                           0.62      1100
   macro avg       0.70      0.61      0.62      1100
weighted avg       0.68      0.62      0.61      1100
 


====== chp006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.18  45.83   96.73  63.22     53.14
1  73.55  33.13   90.79  60.56     42.83
2  72.82  97.91   63.96  48.95     65.27
3  94.73  74.55   99.89  99.40     85.20
4  92.09  51.43   98.02  79.12     62.34
Total accuracy: 62.18%
Average sen: 60.57%
Average spec: 89.88%
Macro f1-score: 61.76%

=== Test on chp007-nsrr. train_data(3922), test_data(57) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.247362191123622
Starting epoch 2/10.
Epoch finished! Loss: 1.020215310764556
Starting epoch 3/10.
Epoch finished! Loss: 0.9519678554972824
Starting epoch 4/10.
Epoch finished! Loss: 0.9073529757407247
Starting epoch 5/10.
Epoch finished! Loss: 0.866839454870443
Starting epoch 6/10.
Epoch finished! Loss: 0.8535286273275103
Starting epoch 7/10.
Epoch finished! Loss: 0.8359664597985695
Starting epoch 8/10.
Epoch finished! Loss: 0.8149215540259468
Starting epoch 9/10.
Epoch finished! Loss: 0.8175692769641779
Starting epoch 10/10.
Epoch finished! Loss: 0.7699051640775739
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6096491228070176
              precision    recall  f1-score   support

         0.0       0.48      0.78      0.60       166
         1.0       0.04      0.05      0.05        58
         2.0       0.61      0.88      0.72       397
         3.0       0.91      0.88      0.90       165
         4.0       1.00      0.19      0.31       354

    accuracy                           0.61      1140
   macro avg       0.61      0.56      0.52      1140
weighted avg       0.73      0.61      0.57      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  84.65  78.31   85.73   48.33     59.77
1  89.47   5.17   93.99    4.41      4.76
2  75.96  88.16   69.45   60.66     71.87
3  97.11  88.48   98.56   91.25     89.85
4  74.74  18.64  100.00  100.00     31.43
Total accuracy: 60.96%
Average sen: 55.76%
Average spec: 89.55%
Macro f1-score: 51.54%

=== Test on chp008-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2203921997213485
Starting epoch 2/10.
Epoch finished! Loss: 1.052096403433773
Starting epoch 3/10.
Epoch finished! Loss: 0.9690161186623513
Starting epoch 4/10.
Epoch finished! Loss: 0.9101888613239802
Starting epoch 5/10.
Epoch finished! Loss: 0.8825172924510092
Starting epoch 6/10.
Epoch finished! Loss: 0.8521932155728037
Starting epoch 7/10.
Epoch finished! Loss: 0.8249410854192787
Starting epoch 8/10.
Epoch finished! Loss: 0.809524610600702
Starting epoch 9/10.
Epoch finished! Loss: 0.7814594344935041
Starting epoch 10/10.
Epoch finished! Loss: 0.7526053951593452
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6829787234042554
              precision    recall  f1-score   support

         0.0       0.61      0.90      0.73       129
         1.0       0.00      0.00      0.00        37
         2.0       0.87      0.41      0.56       387
         3.0       0.62      0.98      0.76       263
         4.0       0.75      0.88      0.81       124

    accuracy                           0.68       940
   macro avg       0.57      0.63      0.57       940
weighted avg       0.71      0.68      0.65       940
 


====== chp008-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  90.85  89.92   91.00  61.38     72.96
1  95.53   0.00   99.45   0.00      0.00
2  73.19  41.09   95.66  86.89     55.79
3  82.55  98.10   76.51  61.87     75.88
4  94.47  87.90   95.47  74.66     80.74
Total accuracy: 68.30%
Average sen: 63.40%
Average spec: 91.62%
Macro f1-score: 57.07%

=== Test on chp009-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2766180765263888
Starting epoch 2/10.
Epoch finished! Loss: 1.0294173986327892
Starting epoch 3/10.
Epoch finished! Loss: 0.9594997079396734
Starting epoch 4/10.
Epoch finished! Loss: 0.9054567102266817
Starting epoch 5/10.
Epoch finished! Loss: 0.8758512279208825
Starting epoch 6/10.
Epoch finished! Loss: 0.8347416340696568
Starting epoch 7/10.
Epoch finished! Loss: 0.8283737095034852
Starting epoch 8/10.
Epoch finished! Loss: 0.8229487250958171
Starting epoch 9/10.
Epoch finished! Loss: 0.7817235101698613
Starting epoch 10/10.
Epoch finished! Loss: 0.7592306000237562
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.765686274509804
              precision    recall  f1-score   support

         0.0       0.72      0.76      0.74        96
         1.0       0.33      0.03      0.06       123
         2.0       0.79      0.80      0.79       355
         3.0       0.93      0.93      0.93       209
         4.0       0.67      0.95      0.78       237

    accuracy                           0.77      1020
   macro avg       0.69      0.70      0.66      1020
weighted avg       0.73      0.77      0.73      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.00  76.04   96.97  72.28     74.11
1  87.55   3.25   99.11  33.33      5.93
2  85.59  79.72   88.72  79.05     79.38
3  97.16  93.30   98.15  92.86     93.08
4  87.84  95.36   85.57  66.67     78.47
Total accuracy: 76.57%
Average sen: 69.53%
Average spec: 93.70%
Macro f1-score: 66.19%

=== Test on chp010-nsrr. train_data(3931), test_data(48) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2449115093124428
Starting epoch 2/10.
Epoch finished! Loss: 1.0321682156193954
Starting epoch 3/10.
Epoch finished! Loss: 0.9557959231104863
Starting epoch 4/10.
Epoch finished! Loss: 0.9095655383954522
Starting epoch 5/10.
Epoch finished! Loss: 0.8767810360014286
Starting epoch 6/10.
Epoch finished! Loss: 0.8531908893403206
Starting epoch 7/10.
Epoch finished! Loss: 0.8303788809375908
Starting epoch 8/10.
Epoch finished! Loss: 0.7990295997709415
Starting epoch 9/10.
Epoch finished! Loss: 0.7801030682395129
Starting epoch 10/10.
Epoch finished! Loss: 0.7697807861345112
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7375
              precision    recall  f1-score   support

         0.0       0.64      0.49      0.55        57
         1.0       0.37      0.12      0.18        60
         2.0       0.71      0.95      0.81       496
         3.0       0.81      0.90      0.85        90
         4.0       0.91      0.48      0.63       257

    accuracy                           0.74       960
   macro avg       0.69      0.59      0.60       960
weighted avg       0.75      0.74      0.71       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.31  49.12   98.23  63.64     55.45
1  93.23  11.67   98.67  36.84     17.72
2  77.08  94.56   58.41  70.85     81.00
3  97.08  90.00   97.82  81.00     85.26
4  84.79  47.86   98.29  91.11     62.76
Total accuracy: 73.75%
Average sen: 58.64%
Average spec: 90.28%
Macro f1-score: 60.44%

=== Test on chp011-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2384675868919917
Starting epoch 2/10.
Epoch finished! Loss: 1.0226140253397884
Starting epoch 3/10.
Epoch finished! Loss: 0.9576594641014021
Starting epoch 4/10.
Epoch finished! Loss: 0.9016015964503191
Starting epoch 5/10.
Epoch finished! Loss: 0.8762496158632697
Starting epoch 6/10.
Epoch finished! Loss: 0.8271292267861415
Starting epoch 7/10.
Epoch finished! Loss: 0.8172847722105834
Starting epoch 8/10.
Epoch finished! Loss: 0.8047530251954284
Starting epoch 9/10.
Epoch finished! Loss: 0.7693494619155417
Starting epoch 10/10.
Epoch finished! Loss: 0.747521635601107
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.595
              precision    recall  f1-score   support

         0.0       0.91      0.18      0.31       229
         1.0       0.17      0.04      0.07       143
         2.0       0.44      0.83      0.58       221
         3.0       0.89      0.99      0.94       271
         4.0       0.47      0.70      0.57       136

    accuracy                           0.59      1000
   macro avg       0.58      0.55      0.49      1000
weighted avg       0.64      0.59      0.54      1000
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0   80.9  18.34   99.48  91.30     30.55
1   83.3   4.20   96.50  16.67      6.70
2   73.1  83.26   70.22  44.23     57.77
3   96.3  98.89   95.34  88.74     93.54
4   85.4  69.85   87.85  47.50     56.55
Total accuracy: 59.50%
Average sen: 54.91%
Average spec: 89.88%
Macro f1-score: 49.02%

=== Test on chp012-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.469529880856981
Starting epoch 2/10.
Epoch finished! Loss: 1.129859337089013
Starting epoch 3/10.
Epoch finished! Loss: 0.9673515505024365
Starting epoch 4/10.
Epoch finished! Loss: 0.9046504730168654
Starting epoch 5/10.
Epoch finished! Loss: 0.887718740394529
Starting epoch 6/10.
Epoch finished! Loss: 0.8454746077863537
Starting epoch 7/10.
Epoch finished! Loss: 0.8128288177659317
Starting epoch 8/10.
Epoch finished! Loss: 0.8011551214268013
Starting epoch 9/10.
Epoch finished! Loss: 0.7831881955570105
Starting epoch 10/10.
Epoch finished! Loss: 0.765129384033534
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7363636363636363
              precision    recall  f1-score   support

         0.0       0.23      0.61      0.33        23
         1.0       0.40      0.15      0.22       182
         2.0       0.69      0.91      0.79       379
         3.0       0.90      0.99      0.94       203
         4.0       0.89      0.72      0.79       313

    accuracy                           0.74      1100
   macro avg       0.62      0.67      0.61      1100
weighted avg       0.73      0.74      0.71      1100
 


====== chp012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.91  60.87   95.64  22.95     33.33
1  82.27  14.84   95.64  40.30     21.69
2  83.00  91.03   78.78  69.28     78.68
3  97.82  98.52   97.66  90.50     94.34
4  89.27  71.57   96.32  88.54     79.15
Total accuracy: 73.64%
Average sen: 67.36%
Average spec: 92.81%
Macro f1-score: 61.44%

=== Test on chp013-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3424283387709637
Starting epoch 2/10.
Epoch finished! Loss: 1.0222168193787944
Starting epoch 3/10.
Epoch finished! Loss: 0.9439796145473208
Starting epoch 4/10.
Epoch finished! Loss: 0.9035179304833315
Starting epoch 5/10.
Epoch finished! Loss: 0.8855669208023013
Starting epoch 6/10.
Epoch finished! Loss: 0.8518953984793352
Starting epoch 7/10.
Epoch finished! Loss: 0.8277807155890125
Starting epoch 8/10.
Epoch finished! Loss: 0.8134681407590302
Starting epoch 9/10.
Epoch finished! Loss: 0.7928446533576566
Starting epoch 10/10.
Epoch finished! Loss: 0.7743923520403249
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.637
              precision    recall  f1-score   support

         0.0       0.33      1.00      0.50        33
         1.0       0.56      0.06      0.11       142
         2.0       0.79      0.58      0.67       433
         3.0       0.53      0.92      0.67       189
         4.0       0.71      0.85      0.78       203

    accuracy                           0.64      1000
   macro avg       0.59      0.68      0.54      1000
weighted avg       0.68      0.64      0.61      1000
 


====== chp013-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0   93.3  100.00   93.07  33.00     49.62
1   86.0    6.34   99.18  56.25     11.39
2   75.1   57.51   88.54  79.30     66.67
3   83.0   91.53   81.01  52.91     67.05
4   90.0   85.22   91.22  71.19     77.58
Total accuracy: 63.70%
Average sen: 68.12%
Average spec: 90.60%
Macro f1-score: 54.46%

=== Test on chp014-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2597733463863938
Starting epoch 2/10.
Epoch finished! Loss: 1.0253141516325426
Starting epoch 3/10.
Epoch finished! Loss: 0.9500091909145822
Starting epoch 4/10.
Epoch finished! Loss: 0.9183275999159229
Starting epoch 5/10.
Epoch finished! Loss: 0.8751612993679485
Starting epoch 6/10.
Epoch finished! Loss: 0.845054026769132
Starting epoch 7/10.
Epoch finished! Loss: 0.83190929121813
Starting epoch 8/10.
Epoch finished! Loss: 0.789643011226946
Starting epoch 9/10.
Epoch finished! Loss: 0.7749842901771166
Starting epoch 10/10.
Epoch finished! Loss: 0.7580418049985048
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.569
              precision    recall  f1-score   support

         0.0       0.86      0.88      0.87       203
         1.0       0.14      0.49      0.21        68
         2.0       0.62      0.52      0.56       397
         3.0       1.00      0.18      0.31       146
         4.0       0.66      0.68      0.67       186

    accuracy                           0.57      1000
   macro avg       0.65      0.55      0.52      1000
weighted avg       0.70      0.57      0.58      1000
 


====== chp014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0   94.6  87.68   96.36   85.99     86.83
1   75.5  48.53   77.47   13.58     21.22
2   68.1  51.64   78.94   61.75     56.24
3   88.1  18.49  100.00  100.00     31.21
4   87.5  67.74   92.01   65.97     66.84
Total accuracy: 56.90%
Average sen: 54.82%
Average spec: 88.96%
Macro f1-score: 52.47%

=== Test on chp015-nsrr. train_data(3922), test_data(57) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2354533929301768
Starting epoch 2/10.
Epoch finished! Loss: 1.0218500928307066
Starting epoch 3/10.
Epoch finished! Loss: 0.941039423097153
Starting epoch 4/10.
Epoch finished! Loss: 0.8776269201569411
Starting epoch 5/10.
Epoch finished! Loss: 0.8577102656875338
Starting epoch 6/10.
Epoch finished! Loss: 0.8384810310541367
Starting epoch 7/10.
Epoch finished! Loss: 0.8176357020072791
Starting epoch 8/10.
Epoch finished! Loss: 0.7982160597279364
Starting epoch 9/10.
Epoch finished! Loss: 0.7883403669966726
Starting epoch 10/10.
Epoch finished! Loss: 0.7561251083198859
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6263157894736842
              precision    recall  f1-score   support

         0.0       0.19      0.90      0.31        67
         1.0       0.26      0.02      0.04       281
         2.0       0.82      0.81      0.81       335
         3.0       0.98      0.86      0.91       264
         4.0       0.64      0.79      0.71       193

    accuracy                           0.63      1140
   macro avg       0.58      0.67      0.56      1140
weighted avg       0.65      0.63      0.60      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  76.75  89.55   75.96  18.87     31.17
1  74.39   2.14   98.02  26.09      3.95
2  88.95  80.60   92.42  81.57     81.08
3  96.32  85.61   99.54  98.26     91.50
4  88.86  78.76   90.92  63.87     70.53
Total accuracy: 62.63%
Average sen: 67.33%
Average spec: 91.37%
Macro f1-score: 55.65%

=== Test on chp016-nsrr. train_data(3916), test_data(63) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.282380477851614
Starting epoch 2/10.
Epoch finished! Loss: 1.0420882636323914
Starting epoch 3/10.
Epoch finished! Loss: 0.9538604966209977
Starting epoch 4/10.
Epoch finished! Loss: 0.9115823801521146
Starting epoch 5/10.
Epoch finished! Loss: 0.8680863650253666
Starting epoch 6/10.
Epoch finished! Loss: 0.8476634263382543
Starting epoch 7/10.
Epoch finished! Loss: 0.8349220081211051
Starting epoch 8/10.
Epoch finished! Loss: 0.8076911282813762
Starting epoch 9/10.
Epoch finished! Loss: 0.8044558925854276
Starting epoch 10/10.
Epoch finished! Loss: 0.787376134673043
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6936507936507936
              precision    recall  f1-score   support

         0.0       0.94      0.89      0.92       297
         1.0       0.75      0.12      0.21       289
         2.0       0.49      0.96      0.65       330
         3.0       0.89      0.89      0.89       133
         4.0       0.96      0.65      0.77       211

    accuracy                           0.69      1260
   macro avg       0.81      0.70      0.69      1260
weighted avg       0.78      0.69      0.66      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.11  89.23   98.23  93.97     91.54
1  78.97  12.46   98.76  75.00     21.36
2  72.30  96.36   63.76  48.55     64.57
3  97.70  88.72   98.76  89.39     89.06
4  93.65  64.93   99.43  95.80     77.40
Total accuracy: 69.37%
Average sen: 70.34%
Average spec: 91.79%
Macro f1-score: 68.79%

=== Test on chp017-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.1980034835180458
Starting epoch 2/10.
Epoch finished! Loss: 1.0415258874394455
Starting epoch 3/10.
Epoch finished! Loss: 0.9615001654138371
Starting epoch 4/10.
Epoch finished! Loss: 0.9307932424910215
Starting epoch 5/10.
Epoch finished! Loss: 0.8765497288229515
Starting epoch 6/10.
Epoch finished! Loss: 0.8611745591066322
Starting epoch 7/10.
Epoch finished! Loss: 0.8368390372061
Starting epoch 8/10.
Epoch finished! Loss: 0.7943926160128749
Starting epoch 9/10.
Epoch finished! Loss: 0.7725154292978802
Starting epoch 10/10.
Epoch finished! Loss: 0.7632843484835965
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.316
              precision    recall  f1-score   support

         0.0       0.47      0.22      0.30       237
         1.0       0.20      0.01      0.02       249
         2.0       0.47      0.31      0.37       210
         3.0       0.87      0.58      0.70       255
         4.0       0.09      1.00      0.16        49

    accuracy                           0.32      1000
   macro avg       0.42      0.42      0.31      1000
weighted avg       0.49      0.32      0.34      1000
 


====== chp017-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0   75.7   21.52   92.53  47.22     29.57
1   74.5    0.80   98.93  20.00      1.54
2   78.3   30.95   90.89  47.45     37.46
3   87.2   58.43   97.05  87.13     69.95
4   47.5  100.00   44.79   8.54     15.73
Total accuracy: 31.60%
Average sen: 42.34%
Average spec: 84.84%
Macro f1-score: 30.85%

=== Test on chp018-nsrr. train_data(3923), test_data(56) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2429402896336146
Starting epoch 2/10.
Epoch finished! Loss: 1.04898600858085
Starting epoch 3/10.
Epoch finished! Loss: 0.9706289044448307
Starting epoch 4/10.
Epoch finished! Loss: 0.9118389978396649
Starting epoch 5/10.
Epoch finished! Loss: 0.8715315147930262
Starting epoch 6/10.
Epoch finished! Loss: 0.8530975394711202
Starting epoch 7/10.
Epoch finished! Loss: 0.8446237713250578
Starting epoch 8/10.
Epoch finished! Loss: 0.8152407507355116
Starting epoch 9/10.
Epoch finished! Loss: 0.7971454074188155
Starting epoch 10/10.
Epoch finished! Loss: 0.7775844499012645
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7053571428571429
              precision    recall  f1-score   support

         0.0       0.66      0.89      0.76       138
         1.0       0.00      0.00      0.00       123
         2.0       0.43      0.65      0.52       130
         3.0       0.97      0.69      0.81       363
         4.0       0.69      0.90      0.78       366

    accuracy                           0.71      1120
   macro avg       0.55      0.63      0.57      1120
weighted avg       0.67      0.71      0.67      1120
 


====== chp018-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  92.95  89.13   93.48  65.78     75.69
1  88.93   0.00   99.90   0.00      0.00
2  85.98  64.62   88.79  43.08     51.69
3  89.46  69.42   99.08  97.30     81.03
4  83.75  90.44   80.50  69.25     78.44
Total accuracy: 70.54%
Average sen: 62.72%
Average spec: 92.35%
Macro f1-score: 57.37%

=== Test on chp019-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.313118390909588
Starting epoch 2/10.
Epoch finished! Loss: 1.0395982570320594
Starting epoch 3/10.
Epoch finished! Loss: 0.9566983859654298
Starting epoch 4/10.
Epoch finished! Loss: 0.9251605003844691
Starting epoch 5/10.
Epoch finished! Loss: 0.8880163909673084
Starting epoch 6/10.
Epoch finished! Loss: 0.8542786901082094
Starting epoch 7/10.
Epoch finished! Loss: 0.8347766144585064
Starting epoch 8/10.
Epoch finished! Loss: 0.8378510056561186
Starting epoch 9/10.
Epoch finished! Loss: 0.808599281098703
Starting epoch 10/10.
Epoch finished! Loss: 0.7832064201661952
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.49042553191489363
              precision    recall  f1-score   support

         0.0       0.14      0.72      0.24        36
         1.0       0.00      0.00      0.00       112
         2.0       0.31      0.42      0.36       224
         3.0       0.66      0.97      0.79       236
         4.0       0.97      0.34      0.50       332

    accuracy                           0.49       940
   macro avg       0.42      0.49      0.38       940
weighted avg       0.59      0.49      0.47       940
 


====== chp019-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  82.55  72.22   82.96  14.44     24.07
1  88.09   0.00  100.00   0.00      0.00
2  64.26  41.96   71.23  31.33     35.88
3  86.81  96.61   83.52  66.28     78.62
4  76.38  34.04   99.51  97.41     50.45
Total accuracy: 49.04%
Average sen: 48.97%
Average spec: 87.44%
Macro f1-score: 37.80%

=== Test on chp020-nsrr. train_data(3922), test_data(57) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3152842856183344
Starting epoch 2/10.
Epoch finished! Loss: 1.0845624687416213
Starting epoch 3/10.
Epoch finished! Loss: 0.9811788978321212
Starting epoch 4/10.
Epoch finished! Loss: 0.9042471561352817
Starting epoch 5/10.
Epoch finished! Loss: 0.8655556763465307
Starting epoch 6/10.
Epoch finished! Loss: 0.8505873479405228
Starting epoch 7/10.
Epoch finished! Loss: 0.8095524894947909
Starting epoch 8/10.
Epoch finished! Loss: 0.7988335435487786
Starting epoch 9/10.
Epoch finished! Loss: 0.7751644868023542
Starting epoch 10/10.
Epoch finished! Loss: 0.7561673239177588
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6342105263157894
              precision    recall  f1-score   support

         0.0       0.86      0.49      0.62       297
         1.0       0.35      0.26      0.29       200
         2.0       0.55      0.98      0.70       354
         3.0       0.95      0.89      0.92       159
         4.0       0.93      0.28      0.44       130

    accuracy                           0.63      1140
   macro avg       0.73      0.58      0.60      1140
weighted avg       0.69      0.63      0.61      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.56  48.82   97.15  85.80     62.23
1  78.51  25.50   89.79  34.69     29.39
2  74.30  98.31   63.49  54.80     70.37
3  97.89  89.31   99.29  95.30     92.21
4  91.58  28.46   99.70  92.50     43.53
Total accuracy: 63.42%
Average sen: 58.08%
Average spec: 89.88%
Macro f1-score: 59.55%

=== Test on chp022-nsrr. train_data(3916), test_data(63) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2625402831055623
Starting epoch 2/10.
Epoch finished! Loss: 1.0132587809696831
Starting epoch 3/10.
Epoch finished! Loss: 0.9321655615821214
Starting epoch 4/10.
Epoch finished! Loss: 0.8847448033902346
Starting epoch 5/10.
Epoch finished! Loss: 0.8614665259180776
Starting epoch 6/10.
Epoch finished! Loss: 0.8316659003572391
Starting epoch 7/10.
Epoch finished! Loss: 0.7964843138861839
Starting epoch 8/10.
Epoch finished! Loss: 0.783922551385582
Starting epoch 9/10.
Epoch finished! Loss: 0.7665265523411734
Starting epoch 10/10.
Epoch finished! Loss: 0.7513422744963175
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6761904761904762
              precision    recall  f1-score   support

         0.0       0.85      0.66      0.75       253
         1.0       0.54      0.30      0.39       293
         2.0       0.72      0.82      0.77       468
         3.0       0.58      0.93      0.71       107
         4.0       0.58      0.81      0.67       139

    accuracy                           0.68      1260
   macro avg       0.65      0.70      0.66      1260
weighted avg       0.68      0.68      0.66      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.95  66.40   97.12  85.28     74.67
1  77.70  30.03   92.14  53.66     38.51
2  81.67  82.26   81.31  72.23     76.92
3  93.57  92.52   93.67  57.56     70.97
4  91.35  80.58   92.69  57.73     67.27
Total accuracy: 67.62%
Average sen: 70.36%
Average spec: 91.39%
Macro f1-score: 65.67%

=== Test on chp024-nsrr. train_data(3923), test_data(56) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3238574791015412
Starting epoch 2/10.
Epoch finished! Loss: 1.0568222218022054
Starting epoch 3/10.
Epoch finished! Loss: 0.9569069551570075
Starting epoch 4/10.
Epoch finished! Loss: 0.9135535143467844
Starting epoch 5/10.
Epoch finished! Loss: 0.8659648246759054
Starting epoch 6/10.
Epoch finished! Loss: 0.8518916200466302
Starting epoch 7/10.
Epoch finished! Loss: 0.8162296047168118
Starting epoch 8/10.
Epoch finished! Loss: 0.7948548840929051
Starting epoch 9/10.
Epoch finished! Loss: 0.778373508961225
Starting epoch 10/10.
Epoch finished! Loss: 0.7544820948827023
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6035714285714285
              precision    recall  f1-score   support

         0.0       0.86      0.53      0.66       232
         1.0       0.38      0.22      0.28       179
         2.0       0.52      0.94      0.67       256
         3.0       1.00      0.56      0.72       339
         4.0       0.38      0.73      0.50       114

    accuracy                           0.60      1120
   macro avg       0.63      0.60      0.56      1120
weighted avg       0.70      0.60      0.60      1120
 


====== chp024-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  88.57  53.45   97.75   86.11     65.96
1  81.88  21.79   93.30   38.24     27.76
2  78.48  94.14   73.84   51.61     66.67
3  86.61  55.75  100.00  100.00     71.59
4  85.18  72.81   86.58   38.07     50.00
Total accuracy: 60.36%
Average sen: 59.59%
Average spec: 90.30%
Macro f1-score: 56.39%

=== Test on chp025-nsrr. train_data(3957), test_data(22) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2193376302719117
Starting epoch 2/10.
Epoch finished! Loss: 1.0125546016270601
Starting epoch 3/10.
Epoch finished! Loss: 0.9397169337242465
Starting epoch 4/10.
Epoch finished! Loss: 0.8887635321556767
Starting epoch 5/10.
Epoch finished! Loss: 0.8784595107730431
Starting epoch 6/10.
Epoch finished! Loss: 0.8428911407537099
Starting epoch 7/10.
Epoch finished! Loss: 0.8188595284389544
Starting epoch 8/10.
Epoch finished! Loss: 0.808457021698167
Starting epoch 9/10.
Epoch finished! Loss: 0.7929728416702415
Starting epoch 10/10.
Epoch finished! Loss: 0.7703197703331331
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4113636363636364
              precision    recall  f1-score   support

         0.0       0.99      0.25      0.39       304
         1.0       0.19      0.45      0.26        31
         2.0       0.58      0.62      0.60        29
         3.0       1.00      0.97      0.98        62
         4.0       0.07      1.00      0.13        14

    accuracy                           0.41       440
   macro avg       0.56      0.66      0.47       440
weighted avg       0.88      0.41      0.47       440
 


====== chp025-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  47.73   24.67   99.26   98.68     39.47
1  82.27   45.16   85.09   18.67     26.42
2  94.55   62.07   96.84   58.06     60.00
3  99.55   96.77  100.00  100.00     98.36
4  58.18  100.00   56.81    7.07     13.21
Total accuracy: 41.14%
Average sen: 65.74%
Average spec: 87.60%
Macro f1-score: 47.49%

=== Test on chp026-nsrr. train_data(3932), test_data(47) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2511754870111402
Starting epoch 2/10.
Epoch finished! Loss: 1.0247015907564236
Starting epoch 3/10.
Epoch finished! Loss: 0.9403857384019225
Starting epoch 4/10.
Epoch finished! Loss: 0.8954185689526963
Starting epoch 5/10.
Epoch finished! Loss: 0.857692798054552
Starting epoch 6/10.
Epoch finished! Loss: 0.8353386390148532
Starting epoch 7/10.
Epoch finished! Loss: 0.8217827229554416
Starting epoch 8/10.
Epoch finished! Loss: 0.7928536786832883
Starting epoch 9/10.
Epoch finished! Loss: 0.7810344489021156
Starting epoch 10/10.
Epoch finished! Loss: 0.7484052773498701
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.801063829787234
              precision    recall  f1-score   support

         0.0       0.74      0.78      0.76        58
         1.0       0.16      0.09      0.12        55
         2.0       0.77      0.92      0.84       422
         3.0       0.88      0.92      0.90       182
         4.0       0.99      0.65      0.79       223

    accuracy                           0.80       940
   macro avg       0.71      0.67      0.68       940
weighted avg       0.80      0.80      0.79       940
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.91  77.59   98.19  73.77     75.63
1  91.91   9.09   97.06  16.13     11.63
2  83.83  92.18   77.03  76.57     83.66
3  95.96  92.31   96.83  87.50     89.84
4  91.60  65.47   99.72  98.65     78.71
Total accuracy: 80.11%
Average sen: 67.33%
Average spec: 93.77%
Macro f1-score: 67.89%

=== Test on chp028-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2022138047887354
Starting epoch 2/10.
Epoch finished! Loss: 1.057300649887445
Starting epoch 3/10.
Epoch finished! Loss: 0.9936842859095457
Starting epoch 4/10.
Epoch finished! Loss: 0.9389038271441752
Starting epoch 5/10.
Epoch finished! Loss: 0.9142038303674483
Starting epoch 6/10.
Epoch finished! Loss: 0.8832361289889229
Starting epoch 7/10.
Epoch finished! Loss: 0.8491301414917927
Starting epoch 8/10.
Epoch finished! Loss: 0.8362879588135651
Starting epoch 9/10.
Epoch finished! Loss: 0.8128964710904627
Starting epoch 10/10.
Epoch finished! Loss: 0.7851490487857741
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.745829244357213
              precision    recall  f1-score   support

         0.0       0.96      0.50      0.65       101
         1.0       0.23      0.24      0.23        55
         2.0       0.78      0.78      0.78       382
         3.0       0.67      0.84      0.74       191
         4.0       0.83      0.82      0.83       290

    accuracy                           0.75      1019
   macro avg       0.69      0.64      0.65      1019
weighted avg       0.76      0.75      0.74      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.80  49.50   99.78  96.15     65.36
1  91.66  23.64   95.54  23.21     23.42
2  83.42  77.75   86.81  77.95     77.85
3  89.11  84.29   90.22  66.53     74.36
4  90.19  82.41   93.28  82.99     82.70
Total accuracy: 74.58%
Average sen: 63.52%
Average spec: 93.13%
Macro f1-score: 64.74%

=== Test on chp029-nsrr. train_data(3927), test_data(52) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.296527540501283
Starting epoch 2/10.
Epoch finished! Loss: 1.040844244768425
Starting epoch 3/10.
Epoch finished! Loss: 0.9489249480622155
Starting epoch 4/10.
Epoch finished! Loss: 0.8938381944079788
Starting epoch 5/10.
Epoch finished! Loss: 0.871206491349303
Starting epoch 6/10.
Epoch finished! Loss: 0.843389878543664
Starting epoch 7/10.
Epoch finished! Loss: 0.8229379873646765
Starting epoch 8/10.
Epoch finished! Loss: 0.7980301215940592
Starting epoch 9/10.
Epoch finished! Loss: 0.7826175991521807
Starting epoch 10/10.
Epoch finished! Loss: 0.7705798475261854
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6519230769230769
              precision    recall  f1-score   support

         0.0       0.31      0.74      0.44        66
         1.0       0.20      0.17      0.18        48
         2.0       0.77      0.64      0.70       422
         3.0       0.82      0.78      0.80       334
         4.0       0.53      0.54      0.53       170

    accuracy                           0.65      1040
   macro avg       0.52      0.57      0.53      1040
weighted avg       0.69      0.65      0.66      1040
 


====== chp029-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.08  74.24   89.01  31.41     44.14
1  92.98  16.67   96.67  19.51     17.98
2  77.50  64.22   86.57  76.55     69.85
3  87.31  77.54   91.93  81.96     79.69
4  84.52  53.53   90.57  52.60     53.06
Total accuracy: 65.19%
Average sen: 57.24%
Average spec: 90.95%
Macro f1-score: 52.94%

=== Test on chp030-nsrr. train_data(3919), test_data(60) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.3274689065221021
Starting epoch 2/10.
Epoch finished! Loss: 1.0901349499402448
Starting epoch 3/10.
Epoch finished! Loss: 1.0060589395825514
Starting epoch 4/10.
Epoch finished! Loss: 0.9440177820832528
Starting epoch 5/10.
Epoch finished! Loss: 0.9120693854663683
Starting epoch 6/10.
Epoch finished! Loss: 0.8828716299417988
Starting epoch 7/10.
Epoch finished! Loss: 0.8394271028621118
Starting epoch 8/10.
Epoch finished! Loss: 0.821324962560478
Starting epoch 9/10.
Epoch finished! Loss: 0.79239065110531
Starting epoch 10/10.
Epoch finished! Loss: 0.7809875185989663
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4962468723936614
              precision    recall  f1-score   support

         0.0       0.85      0.34      0.49       350
         1.0       0.31      0.49      0.38       204
         2.0       0.64      0.48      0.55       346
         3.0       0.67      0.62      0.65       179
         4.0       0.31      0.82      0.45       120

    accuracy                           0.50      1199
   macro avg       0.56      0.55      0.50      1199
weighted avg       0.62      0.50      0.51      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  78.98  34.29   97.41  84.51     48.78
1  73.23  48.53   78.29  31.43     38.15
2  77.23  47.98   89.10  64.09     54.88
3  89.82  62.01   94.71  67.27     64.53
4  79.98  82.50   79.70  31.13     45.21
Total accuracy: 49.62%
Average sen: 55.06%
Average spec: 87.84%
Macro f1-score: 50.31%

=== Test on chp031-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2155221314454565
Starting epoch 2/10.
Epoch finished! Loss: 1.0187071564854409
Starting epoch 3/10.
Epoch finished! Loss: 0.957845679199209
Starting epoch 4/10.
Epoch finished! Loss: 0.9184373078145542
Starting epoch 5/10.
Epoch finished! Loss: 0.9057058976316938
Starting epoch 6/10.
Epoch finished! Loss: 0.8682911677324042
Starting epoch 7/10.
Epoch finished! Loss: 0.8462747165134975
Starting epoch 8/10.
Epoch finished! Loss: 0.8211401190076556
Starting epoch 9/10.
Epoch finished! Loss: 0.7949665992387703
Starting epoch 10/10.
Epoch finished! Loss: 0.7791828237169859
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5481818181818182
              precision    recall  f1-score   support

         0.0       0.26      0.33      0.29        51
         1.0       0.06      0.04      0.05        48
         2.0       0.38      0.35      0.36       309
         3.0       0.51      0.98      0.67       229
         4.0       0.92      0.54      0.68       463

    accuracy                           0.55      1100
   macro avg       0.43      0.45      0.41      1100
weighted avg       0.62      0.55      0.54      1100
 


====== chp031-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.55  33.33   95.42  26.15     29.31
1  92.73   4.17   96.77   5.56      4.76
2  65.64  34.63   77.75  37.81     36.15
3  79.82  98.25   74.97  50.79     66.96
4  78.91  54.43   96.70  92.31     68.48
Total accuracy: 54.82%
Average sen: 44.96%
Average spec: 88.32%
Macro f1-score: 41.13%

=== Test on chp032-nsrr. train_data(3926), test_data(53) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2391401886635898
Starting epoch 2/10.
Epoch finished! Loss: 1.0074957154539166
Starting epoch 3/10.
Epoch finished! Loss: 0.9354555977850544
Starting epoch 4/10.
Epoch finished! Loss: 0.8960902981308042
Starting epoch 5/10.
Epoch finished! Loss: 0.868033559650791
Starting epoch 6/10.
Epoch finished! Loss: 0.8457264669087469
Starting epoch 7/10.
Epoch finished! Loss: 0.8150414550790981
Starting epoch 8/10.
Epoch finished! Loss: 0.7989114370121031
Starting epoch 9/10.
Epoch finished! Loss: 0.7705742700063453
Starting epoch 10/10.
Epoch finished! Loss: 0.7598807334291692
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7254716981132076
              precision    recall  f1-score   support

         0.0       0.96      0.49      0.65        47
         1.0       0.00      0.00      0.00       108
         2.0       0.68      0.96      0.80       526
         3.0       0.96      0.83      0.89       150
         4.0       0.71      0.50      0.58       229

    accuracy                           0.73      1060
   macro avg       0.66      0.56      0.58      1060
weighted avg       0.67      0.73      0.68      1060
 


====== chp032-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  97.64  48.94   99.90  95.83     64.79
1  89.72   0.00   99.89   0.00      0.00
2  75.85  96.39   55.62  68.15     79.84
3  97.17  83.33   99.45  96.15     89.29
4  84.72  49.78   94.34  70.81     58.46
Total accuracy: 72.55%
Average sen: 55.69%
Average spec: 89.84%
Macro f1-score: 58.48%

=== Test on chp033-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.230496600878482
Starting epoch 2/10.
Epoch finished! Loss: 1.0860430298715222
Starting epoch 3/10.
Epoch finished! Loss: 1.032010174679513
Starting epoch 4/10.
Epoch finished! Loss: 0.9743946380152995
Starting epoch 5/10.
Epoch finished! Loss: 0.9201383171032886
Starting epoch 6/10.
Epoch finished! Loss: 0.89211338066629
Starting epoch 7/10.
Epoch finished! Loss: 0.8420405473027911
Starting epoch 8/10.
Epoch finished! Loss: 0.8275902402036044
Starting epoch 9/10.
Epoch finished! Loss: 0.8029769550324702
Starting epoch 10/10.
Epoch finished! Loss: 0.7788689612429969
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.632
              precision    recall  f1-score   support

         0.0       0.45      0.84      0.59        32
         1.0       1.00      0.02      0.04       251
         2.0       0.37      0.86      0.52       208
         3.0       0.91      0.96      0.93       254
         4.0       0.94      0.69      0.80       255

    accuracy                           0.63      1000
   macro avg       0.73      0.68      0.58      1000
weighted avg       0.81      0.63      0.58      1000
 


====== chp033-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0   96.2  84.38   96.59   45.00     58.70
1   75.4   1.99  100.00  100.00      3.91
2   67.2  86.06   62.25   37.45     52.19
3   96.6  96.06   96.78   91.04     93.49
4   91.0  69.41   98.39   93.65     79.73
Total accuracy: 63.20%
Average sen: 67.58%
Average spec: 90.80%
Macro f1-score: 57.60%

=== Test on chp034-nsrr. train_data(3927), test_data(52) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2811743417868808
Starting epoch 2/10.
Epoch finished! Loss: 1.0258637809631777
Starting epoch 3/10.
Epoch finished! Loss: 0.948282930011652
Starting epoch 4/10.
Epoch finished! Loss: 0.9112718257368827
Starting epoch 5/10.
Epoch finished! Loss: 0.8798337980192534
Starting epoch 6/10.
Epoch finished! Loss: 0.8498202493908454
Starting epoch 7/10.
Epoch finished! Loss: 0.845369355030814
Starting epoch 8/10.
Epoch finished! Loss: 0.8215384217245238
Starting epoch 9/10.
Epoch finished! Loss: 0.7902919559606484
Starting epoch 10/10.
Epoch finished! Loss: 0.7729635970781044
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7019230769230769
              precision    recall  f1-score   support

         0.0       0.00      0.00      0.00        20
         1.0       0.00      0.00      0.00        68
         2.0       0.61      0.88      0.72       375
         3.0       0.98      0.63      0.77       345
         4.0       0.72      0.79      0.75       232

    accuracy                           0.70      1040
   macro avg       0.46      0.46      0.45      1040
weighted avg       0.70      0.70      0.68      1040
 


====== chp034-nsrr ======

The f1-score of  0  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  96.35   0.00   98.24   0.00      0.00
1  92.98   0.00   99.49   0.00      0.00
2  75.48  87.73   68.57  61.15     72.07
3  87.21  62.90   99.28  97.75     76.54
4  88.37  79.31   90.97  71.60     75.26
Total accuracy: 70.19%
Average sen: 45.99%
Average spec: 91.31%
Macro f1-score: 44.77%

=== Test on chp036-nsrr. train_data(3916), test_data(63) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.4091644537113512
Starting epoch 2/10.
Epoch finished! Loss: 1.0891533074781412
Starting epoch 3/10.
Epoch finished! Loss: 0.9652802999062307
Starting epoch 4/10.
Epoch finished! Loss: 0.9166364265829706
Starting epoch 5/10.
Epoch finished! Loss: 0.8769891632487402
Starting epoch 6/10.
Epoch finished! Loss: 0.8460770358362466
Starting epoch 7/10.
Epoch finished! Loss: 0.8185521146982832
Starting epoch 8/10.
Epoch finished! Loss: 0.7954802084761812
Starting epoch 9/10.
Epoch finished! Loss: 0.7611577042075984
Starting epoch 10/10.
Epoch finished! Loss: 0.753911290784626
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.719047619047619
              precision    recall  f1-score   support

         0.0       0.67      0.92      0.78       237
         1.0       0.57      0.21      0.31       167
         2.0       0.79      0.77      0.78       563
         3.0       0.08      0.88      0.14         8
         4.0       0.91      0.74      0.82       285

    accuracy                           0.72      1260
   macro avg       0.60      0.70      0.56      1260
weighted avg       0.76      0.72      0.72      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.92  92.41   89.35  66.77     77.52
1  87.46  20.96   97.62  57.38     30.70
2  80.40  76.91   83.21  78.73     77.81
3  93.41  87.50   93.45   7.87     14.43
4  92.62  74.39   97.95  91.38     82.01
Total accuracy: 71.90%
Average sen: 70.43%
Average spec: 92.32%
Macro f1-score: 56.50%

=== Test on chp037-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2261544650002403
Starting epoch 2/10.
Epoch finished! Loss: 1.0129971508773006
Starting epoch 3/10.
Epoch finished! Loss: 0.9595441488283021
Starting epoch 4/10.
Epoch finished! Loss: 0.9232162859062759
Starting epoch 5/10.
Epoch finished! Loss: 0.8776215001636621
Starting epoch 6/10.
Epoch finished! Loss: 0.8551181331276894
Starting epoch 7/10.
Epoch finished! Loss: 0.8271365506308419
Starting epoch 8/10.
Epoch finished! Loss: 0.8137022827808954
Starting epoch 9/10.
Epoch finished! Loss: 0.7829852555783428
Starting epoch 10/10.
Epoch finished! Loss: 0.7696487082510578
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5962671905697446
              precision    recall  f1-score   support

         0.0       0.66      0.70      0.68       197
         1.0       0.27      0.13      0.18       161
         2.0       0.77      0.48      0.59       348
         3.0       1.00      0.85      0.92       208
         4.0       0.31      1.00      0.47       104

    accuracy                           0.60      1018
   macro avg       0.60      0.63      0.57      1018
weighted avg       0.67      0.60      0.60      1018
 


====== chp037-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  87.13   70.05   91.23   65.71     67.81
1  80.65   13.04   93.35   26.92     17.57
2  77.41   48.28   92.54   77.06     59.36
3  96.86   84.62  100.00  100.00     91.67
4  77.21  100.00   74.62   30.95     47.27
Total accuracy: 59.63%
Average sen: 63.20%
Average spec: 90.35%
Macro f1-score: 56.74%

=== Test on chp038-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2439638429454394
Starting epoch 2/10.
Epoch finished! Loss: 0.9924418325630986
Starting epoch 3/10.
Epoch finished! Loss: 0.9192803524890725
Starting epoch 4/10.
Epoch finished! Loss: 0.8781634166228528
Starting epoch 5/10.
Epoch finished! Loss: 0.8508711959026298
Starting epoch 6/10.
Epoch finished! Loss: 0.8298452815078959
Starting epoch 7/10.
Epoch finished! Loss: 0.8115498325502386
Starting epoch 8/10.
Epoch finished! Loss: 0.7847854896467559
Starting epoch 9/10.
Epoch finished! Loss: 0.7647686326230059
Starting epoch 10/10.
Epoch finished! Loss: 0.7481423834604877
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.596078431372549
              precision    recall  f1-score   support

         0.0       0.37      0.40      0.38        62
         1.0       0.75      0.02      0.03       178
         2.0       0.63      0.74      0.68       437
         3.0       0.41      0.99      0.58       102
         4.0       0.81      0.65      0.72       241

    accuracy                           0.60      1020
   macro avg       0.59      0.56      0.48      1020
weighted avg       0.66      0.60      0.55      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.16  40.32   95.51  36.76     38.46
1  82.75   1.69   99.88  75.00      3.30
2  70.49  73.68   68.10  63.39     68.15
3  85.69  99.02   84.20  41.06     58.05
4  88.14  65.15   95.25  80.93     72.18
Total accuracy: 59.61%
Average sen: 55.97%
Average spec: 88.59%
Macro f1-score: 48.03%

=== Test on chp039-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.313625297680193
Starting epoch 2/10.
Epoch finished! Loss: 1.0047267479251842
Starting epoch 3/10.
Epoch finished! Loss: 0.9392053719077792
Starting epoch 4/10.
Epoch finished! Loss: 0.8948356132118069
Starting epoch 5/10.
Epoch finished! Loss: 0.8693042253049053
Starting epoch 6/10.
Epoch finished! Loss: 0.848974701397273
Starting epoch 7/10.
Epoch finished! Loss: 0.8267645551537981
Starting epoch 8/10.
Epoch finished! Loss: 0.8083075118460217
Starting epoch 9/10.
Epoch finished! Loss: 0.7907771188385633
Starting epoch 10/10.
Epoch finished! Loss: 0.7726977160390542
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.519090909090909
              precision    recall  f1-score   support

         0.0       0.07      0.89      0.13        19
         1.0       0.53      0.46      0.49       345
         2.0       0.76      0.55      0.64       376
         3.0       1.00      0.69      0.82       199
         4.0       0.33      0.30      0.32       161

    accuracy                           0.52      1100
   macro avg       0.54      0.58      0.48      1100
weighted avg       0.65      0.52      0.57      1100
 


====== chp039-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  79.91  89.47   79.74    7.20     13.33
1  70.18  46.38   81.06   52.81     49.38
2  78.64  55.32   90.75   75.64     63.90
3  94.36  68.84  100.00  100.00     81.55
4  80.73  30.43   89.35   32.89     31.61
Total accuracy: 51.91%
Average sen: 58.09%
Average spec: 88.18%
Macro f1-score: 47.96%

=== Test on chp040-nsrr. train_data(3926), test_data(53) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2683615967327235
Starting epoch 2/10.
Epoch finished! Loss: 1.0710534407776229
Starting epoch 3/10.
Epoch finished! Loss: 0.9946650318345245
Starting epoch 4/10.
Epoch finished! Loss: 0.9572706178438907
Starting epoch 5/10.
Epoch finished! Loss: 0.9065886228060236
Starting epoch 6/10.
Epoch finished! Loss: 0.8750993814699504
Starting epoch 7/10.
Epoch finished! Loss: 0.8535306233988733
Starting epoch 8/10.
Epoch finished! Loss: 0.8253210189999366
Starting epoch 9/10.
Epoch finished! Loss: 0.7894405463368309
Starting epoch 10/10.
Epoch finished! Loss: 0.7781794533437613
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7386792452830189
              precision    recall  f1-score   support

         0.0       1.00      0.61      0.76       171
         1.0       0.54      0.14      0.22       142
         2.0       0.69      0.93      0.79       330
         3.0       0.94      0.77      0.85       201
         4.0       0.64      0.91      0.75       216

    accuracy                           0.74      1060
   macro avg       0.76      0.67      0.67      1060
weighted avg       0.76      0.74      0.71      1060
 


====== chp040-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.68  60.82  100.00  100.00     75.64
1  86.89  14.08   98.15   54.05     22.35
2  84.62  93.33   80.68   68.60     79.08
3  94.72  77.11   98.84   93.94     84.70
4  87.83  90.74   87.09   64.26     75.24
Total accuracy: 73.87%
Average sen: 67.22%
Average spec: 92.95%
Macro f1-score: 67.40%

=== Test on chp041-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2932262495160103
Starting epoch 2/10.
Epoch finished! Loss: 1.1419366970658302
Starting epoch 3/10.
Epoch finished! Loss: 1.0700491604452231
Starting epoch 4/10.
Epoch finished! Loss: 0.9979979321360588
Starting epoch 5/10.
Epoch finished! Loss: 0.9587514859681227
Starting epoch 6/10.
Epoch finished! Loss: 0.9210132579414212
Starting epoch 7/10.
Epoch finished! Loss: 0.8813727759585088
Starting epoch 8/10.
Epoch finished! Loss: 0.8429164133813917
Starting epoch 9/10.
Epoch finished! Loss: 0.830317784785008
Starting epoch 10/10.
Epoch finished! Loss: 0.8029038231743841
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6690909090909091
              precision    recall  f1-score   support

         0.0       0.85      0.24      0.37       216
         1.0       0.11      0.10      0.11        58
         2.0       0.75      0.85      0.80       527
         3.0       0.37      1.00      0.54        33
         4.0       0.66      0.75      0.70       266

    accuracy                           0.67      1100
   macro avg       0.55      0.59      0.50      1100
weighted avg       0.70      0.67      0.65      1100
 


====== chp041-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  84.18   23.61   98.98  85.00     36.96
1  90.91   10.34   95.39  11.11     10.71
2  79.09   84.63   74.00  74.96     79.50
3  94.91  100.00   94.75  37.08     54.10
4  84.73   75.19   87.77  66.23     70.42
Total accuracy: 66.91%
Average sen: 58.75%
Average spec: 90.18%
Macro f1-score: 50.34%

=== Test on chp042-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2398056696568216
Starting epoch 2/10.
Epoch finished! Loss: 1.0534886678262634
Starting epoch 3/10.
Epoch finished! Loss: 0.9800325239799461
Starting epoch 4/10.
Epoch finished! Loss: 0.9227304073924921
Starting epoch 5/10.
Epoch finished! Loss: 0.8886248104426325
Starting epoch 6/10.
Epoch finished! Loss: 0.8565069561710164
Starting epoch 7/10.
Epoch finished! Loss: 0.8227042776285386
Starting epoch 8/10.
Epoch finished! Loss: 0.8129837039325919
Starting epoch 9/10.
Epoch finished! Loss: 0.7772533076302129
Starting epoch 10/10.
Epoch finished! Loss: 0.7496171977599057
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.4572727272727273
              precision    recall  f1-score   support

         0.0       0.27      0.88      0.41       152
         1.0       0.32      0.11      0.17       232
         2.0       0.97      0.26      0.41       432
         3.0       0.43      1.00      0.60        93
         4.0       0.71      0.73      0.72       191

    accuracy                           0.46      1100
   macro avg       0.54      0.59      0.46      1100
weighted avg       0.64      0.46      0.43      1100
 


====== chp042-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  65.82   87.50   62.34  27.14     41.43
1  76.18   11.21   93.55  31.71     16.56
2  70.55   25.93   99.40  96.55     40.88
3  88.82  100.00   87.79  43.06     60.19
4  90.09   72.77   93.73  70.92     71.83
Total accuracy: 45.73%
Average sen: 59.48%
Average spec: 87.36%
Macro f1-score: 46.18%

=== Test on chp043-nsrr. train_data(3919), test_data(60) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2318412685943076
Starting epoch 2/10.
Epoch finished! Loss: 1.0144417828611096
Starting epoch 3/10.
Epoch finished! Loss: 0.9314815228247582
Starting epoch 4/10.
Epoch finished! Loss: 0.8928485919752389
Starting epoch 5/10.
Epoch finished! Loss: 0.8633058916424852
Starting epoch 6/10.
Epoch finished! Loss: 0.8200831734920706
Starting epoch 7/10.
Epoch finished! Loss: 0.803588927401911
Starting epoch 8/10.
Epoch finished! Loss: 0.7700356500380484
Starting epoch 9/10.
Epoch finished! Loss: 0.7585922520788734
Starting epoch 10/10.
Epoch finished! Loss: 0.7382728925446416
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6783333333333333
              precision    recall  f1-score   support

         0.0       0.86      0.59      0.70       143
         1.0       0.23      0.02      0.03       197
         2.0       0.85      0.78      0.81       506
         3.0       0.88      0.81      0.85        64
         4.0       0.50      0.96      0.65       290

    accuracy                           0.68      1200
   macro avg       0.66      0.63      0.61      1200
weighted avg       0.66      0.68      0.63      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.00  59.44   98.68  85.86     70.25
1  83.00   1.52   99.00  23.08      2.86
2  84.83  78.06   89.77  84.76     81.28
3  98.42  81.25   99.38  88.14     84.55
4  75.42  96.21   68.79  49.56     65.42
Total accuracy: 67.83%
Average sen: 63.30%
Average spec: 91.12%
Macro f1-score: 60.87%

=== Test on chp044-nsrr. train_data(3927), test_data(52) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.284376469953936
Starting epoch 2/10.
Epoch finished! Loss: 1.0247120790335598
Starting epoch 3/10.
Epoch finished! Loss: 0.9248118579995875
Starting epoch 4/10.
Epoch finished! Loss: 0.8876118193931726
Starting epoch 5/10.
Epoch finished! Loss: 0.8630699694004594
Starting epoch 6/10.
Epoch finished! Loss: 0.8298212216824902
Starting epoch 7/10.
Epoch finished! Loss: 0.820700369015032
Starting epoch 8/10.
Epoch finished! Loss: 0.790945999856506
Starting epoch 9/10.
Epoch finished! Loss: 0.7762671327408479
Starting epoch 10/10.
Epoch finished! Loss: 0.7532340662972051
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6567307692307692
              precision    recall  f1-score   support

         0.0       0.40      0.92      0.56        25
         1.0       0.23      0.17      0.20        93
         2.0       0.53      0.83      0.65       324
         3.0       0.98      0.64      0.77       474
         4.0       0.78      0.58      0.67       124

    accuracy                           0.66      1040
   macro avg       0.58      0.63      0.57      1040
weighted avg       0.73      0.66      0.66      1040
 


====== chp044-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.54  92.00   96.65  40.35     56.10
1  87.31  17.20   94.19  22.54     19.51
2  71.54  83.02   66.34  52.75     64.51
3  82.88  63.92   98.76  97.74     77.30
4  93.08  58.06   97.82  78.26     66.67
Total accuracy: 65.67%
Average sen: 62.84%
Average spec: 90.75%
Macro f1-score: 56.82%

=== Test on chp045-nsrr. train_data(3919), test_data(60) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2197980685612124
Starting epoch 2/10.
Epoch finished! Loss: 1.0040367402688926
Starting epoch 3/10.
Epoch finished! Loss: 0.9473106292507533
Starting epoch 4/10.
Epoch finished! Loss: 0.8863885559694237
Starting epoch 5/10.
Epoch finished! Loss: 0.8566121387359736
Starting epoch 6/10.
Epoch finished! Loss: 0.8310800460750795
Starting epoch 7/10.
Epoch finished! Loss: 0.8235240830179981
Starting epoch 8/10.
Epoch finished! Loss: 0.7933908534019499
Starting epoch 9/10.
Epoch finished! Loss: 0.7795216560058886
Starting epoch 10/10.
Epoch finished! Loss: 0.751721286712705
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6213511259382819
              precision    recall  f1-score   support

         0.0       0.42      0.83      0.56       151
         1.0       0.55      0.09      0.15       135
         2.0       0.76      0.71      0.73       442
         3.0       0.89      0.65      0.75       221
         4.0       0.49      0.60      0.54       250

    accuracy                           0.62      1199
   macro avg       0.62      0.57      0.55      1199
weighted avg       0.66      0.62      0.61      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.65  82.78   83.78  42.37     56.05
1  88.91   8.89   99.06  54.55     15.29
2  80.98  71.49   86.53  75.60     73.49
3  92.08  64.71   98.26  89.38     75.07
4  78.65  59.60   83.67  49.01     53.79
Total accuracy: 62.14%
Average sen: 57.49%
Average spec: 90.26%
Macro f1-score: 54.74%

=== Test on chp046-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.25829428267114
Starting epoch 2/10.
Epoch finished! Loss: 1.0487838337311939
Starting epoch 3/10.
Epoch finished! Loss: 0.9314936910356794
Starting epoch 4/10.
Epoch finished! Loss: 0.8799113555222141
Starting epoch 5/10.
Epoch finished! Loss: 0.8534222689210152
Starting epoch 6/10.
Epoch finished! Loss: 0.8167481260488227
Starting epoch 7/10.
Epoch finished! Loss: 0.791832942819717
Starting epoch 8/10.
Epoch finished! Loss: 0.7692502607040259
Starting epoch 9/10.
Epoch finished! Loss: 0.7526529110511955
Starting epoch 10/10.
Epoch finished! Loss: 0.7274018989837899
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5546296296296296
              precision    recall  f1-score   support

         0.0       0.88      0.88      0.88       226
         1.0       0.53      0.08      0.13       357
         2.0       0.32      0.66      0.43       192
         3.0       0.04      1.00      0.07         2
         4.0       0.68      0.81      0.74       303

    accuracy                           0.55      1080
   macro avg       0.49      0.68      0.45      1080
weighted avg       0.61      0.55      0.51      1080
 


====== chp046-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  95.00   88.05   96.84  88.05     88.05
1  67.22    7.56   96.68  52.94     13.24
2  69.44   65.62   70.27  32.31     43.30
3  95.09  100.00   95.08   3.64      7.02
4  84.17   80.86   85.46  68.44     74.13
Total accuracy: 55.46%
Average sen: 68.42%
Average spec: 88.87%
Macro f1-score: 45.15%

=== Test on chp047-nsrr. train_data(3935), test_data(44) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2736365688969464
Starting epoch 2/10.
Epoch finished! Loss: 1.0326190173777612
Starting epoch 3/10.
Epoch finished! Loss: 0.9599148543129744
Starting epoch 4/10.
Epoch finished! Loss: 0.9106330891298581
Starting epoch 5/10.
Epoch finished! Loss: 0.864387675399392
Starting epoch 6/10.
Epoch finished! Loss: 0.8424151748342975
Starting epoch 7/10.
Epoch finished! Loss: 0.8305235416379594
Starting epoch 8/10.
Epoch finished! Loss: 0.7947799112960583
Starting epoch 9/10.
Epoch finished! Loss: 0.7888477280849718
Starting epoch 10/10.
Epoch finished! Loss: 0.7624816400100863
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.3386363636363636
              precision    recall  f1-score   support

         0.0       0.68      0.33      0.44       301
         1.0       0.28      0.04      0.07       231
         2.0       0.60      0.42      0.49       233
         3.0       0.52      0.44      0.48        25
         4.0       0.16      0.92      0.27        90

    accuracy                           0.34       880
   macro avg       0.45      0.43      0.35       880
weighted avg       0.49      0.34      0.34       880
 


====== chp047-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  71.59  32.56   91.88  67.59     43.95
1  72.16   3.90   96.46  28.12      6.84
2  77.05  41.63   89.80  59.51     48.99
3  97.27  44.00   98.83  52.38     47.83
4  49.66  92.22   44.81  15.99     27.26
Total accuracy: 33.86%
Average sen: 42.86%
Average spec: 84.36%
Macro f1-score: 34.97%

=== Test on chp048-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.1985173445879196
Starting epoch 2/10.
Epoch finished! Loss: 1.0293282641440022
Starting epoch 3/10.
Epoch finished! Loss: 0.961314007183727
Starting epoch 4/10.
Epoch finished! Loss: 0.9252894736674367
Starting epoch 5/10.
Epoch finished! Loss: 0.8824264297679979
Starting epoch 6/10.
Epoch finished! Loss: 0.8628079648680833
Starting epoch 7/10.
Epoch finished! Loss: 0.833601927346721
Starting epoch 8/10.
Epoch finished! Loss: 0.8244320028746615
Starting epoch 9/10.
Epoch finished! Loss: 0.8011794224837605
Starting epoch 10/10.
Epoch finished! Loss: 0.7742276622780732
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7147058823529412
              precision    recall  f1-score   support

         0.0       0.41      0.74      0.53        38
         1.0       0.44      0.10      0.16       144
         2.0       0.81      0.81      0.81       495
         3.0       0.61      0.71      0.66       107
         4.0       0.70      0.88      0.78       236

    accuracy                           0.71      1020
   macro avg       0.59      0.65      0.59      1020
weighted avg       0.70      0.71      0.69      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.10  73.68   95.93  41.18     52.83
1  85.49   9.72   97.95  43.75     15.91
2  81.86  81.41   82.29  81.25     81.33
3  92.16  71.03   94.63  60.80     65.52
4  88.33  88.14   88.39  69.57     77.76
Total accuracy: 71.47%
Average sen: 64.80%
Average spec: 91.84%
Macro f1-score: 58.67%

=== Test on chp049-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2757215779654834
Starting epoch 2/10.
Epoch finished! Loss: 1.0177229296187966
Starting epoch 3/10.
Epoch finished! Loss: 0.9392737505995498
Starting epoch 4/10.
Epoch finished! Loss: 0.8925981749685443
Starting epoch 5/10.
Epoch finished! Loss: 0.870089300052852
Starting epoch 6/10.
Epoch finished! Loss: 0.8414448608397221
Starting epoch 7/10.
Epoch finished! Loss: 0.8182281686031089
Starting epoch 8/10.
Epoch finished! Loss: 0.7926161163011376
Starting epoch 9/10.
Epoch finished! Loss: 0.7851010113954544
Starting epoch 10/10.
Epoch finished! Loss: 0.7556762769818306
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.5537037037037037
              precision    recall  f1-score   support

         0.0       0.70      0.59      0.64       108
         1.0       0.74      0.06      0.12       387
         2.0       0.47      0.88      0.62       360
         3.0       0.53      0.89      0.67        95
         4.0       0.85      0.82      0.83       130

    accuracy                           0.55      1080
   macro avg       0.66      0.65      0.58      1080
weighted avg       0.64      0.55      0.47      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.43  59.26   97.22  70.33     64.32
1  65.65   6.46   98.70  73.53     11.88
2  63.52  88.33   51.11  47.46     61.75
3  92.13  89.47   92.39  53.12     66.67
4  96.02  81.54   98.00  84.80     83.14
Total accuracy: 55.37%
Average sen: 65.01%
Average spec: 87.48%
Macro f1-score: 57.55%

=== Test on chp051-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.225442794208624
Starting epoch 2/10.
Epoch finished! Loss: 1.102392930461436
Starting epoch 3/10.
Epoch finished! Loss: 1.025580317086103
Starting epoch 4/10.
Epoch finished! Loss: 0.9674152546391195
Starting epoch 5/10.
Epoch finished! Loss: 0.9221810634647097
Starting epoch 6/10.
Epoch finished! Loss: 0.884230204990932
Starting epoch 7/10.
Epoch finished! Loss: 0.837080506797956
Starting epoch 8/10.
Epoch finished! Loss: 0.8238621085730135
Starting epoch 9/10.
Epoch finished! Loss: 0.783592306001454
Starting epoch 10/10.
Epoch finished! Loss: 0.7728527024084207
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6712962962962963
              precision    recall  f1-score   support

         0.0       0.25      0.93      0.40        30
         1.0       0.50      0.01      0.01       136
         2.0       0.65      0.67      0.66       404
         3.0       0.75      0.86      0.80       239
         4.0       0.80      0.80      0.80       271

    accuracy                           0.67      1080
   macro avg       0.59      0.66      0.53      1080
weighted avg       0.68      0.67      0.64      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.13  93.33   92.10  25.23     39.72
1  87.41   0.74   99.89  50.00      1.45
2  74.35  67.33   78.55  65.23     66.26
3  90.46  86.19   91.68  74.64     80.00
4  89.91  80.44   93.08  79.56     80.00
Total accuracy: 67.13%
Average sen: 65.61%
Average spec: 91.06%
Macro f1-score: 53.49%

=== Test on chp052-nsrr. train_data(3929), test_data(50) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.281385453379884
Starting epoch 2/10.
Epoch finished! Loss: 1.0572717942449512
Starting epoch 3/10.
Epoch finished! Loss: 0.9658422994674468
Starting epoch 4/10.
Epoch finished! Loss: 0.9123526787271306
Starting epoch 5/10.
Epoch finished! Loss: 0.8846693879031405
Starting epoch 6/10.
Epoch finished! Loss: 0.8413443498465479
Starting epoch 7/10.
Epoch finished! Loss: 0.8226925741348948
Starting epoch 8/10.
Epoch finished! Loss: 0.8152764322502273
Starting epoch 9/10.
Epoch finished! Loss: 0.796093543649328
Starting epoch 10/10.
Epoch finished! Loss: 0.7569834575513188
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.67
              precision    recall  f1-score   support

         0.0       0.77      0.92      0.84       159
         1.0       0.30      0.15      0.20        87
         2.0       0.85      0.53      0.65       439
         3.0       0.37      1.00      0.54       109
         4.0       0.86      0.82      0.84       206

    accuracy                           0.67      1000
   macro avg       0.63      0.68      0.61      1000
weighted avg       0.74      0.67      0.67      1000
 


====== chp052-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0   94.4   91.82   94.89  77.25     83.91
1   89.5   14.94   96.60  29.55     19.85
2   75.2   53.08   92.51  84.73     65.27
3   81.4  100.00   79.12  36.95     53.96
4   93.5   82.04   96.47  85.79     83.87
Total accuracy: 67.00%
Average sen: 68.38%
Average spec: 91.92%
Macro f1-score: 61.37%

=== Test on chp053-nsrr. train_data(3925), test_data(54) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2563005450124642
Starting epoch 2/10.
Epoch finished! Loss: 1.0751562445443503
Starting epoch 3/10.
Epoch finished! Loss: 0.9769331257866354
Starting epoch 4/10.
Epoch finished! Loss: 0.9084765163003182
Starting epoch 5/10.
Epoch finished! Loss: 0.8626252367940485
Starting epoch 6/10.
Epoch finished! Loss: 0.8497172194171925
Starting epoch 7/10.
Epoch finished! Loss: 0.8230786025524139
Starting epoch 8/10.
Epoch finished! Loss: 0.7927012308215609
Starting epoch 9/10.
Epoch finished! Loss: 0.7681691243636365
Starting epoch 10/10.
Epoch finished! Loss: 0.7591526839045846
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7092592592592593
              precision    recall  f1-score   support

         0.0       0.91      0.59      0.72       251
         1.0       0.25      0.04      0.07       147
         2.0       0.58      0.89      0.70       305
         3.0       0.95      0.90      0.92       250
         4.0       0.60      0.91      0.73       127

    accuracy                           0.71      1080
   macro avg       0.66      0.67      0.63      1080
weighted avg       0.70      0.71      0.67      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.17  59.36   98.19  90.85     71.81
1  85.28   4.08   98.07  25.00      7.02
2  78.98  88.52   75.23  58.44     70.40
3  96.57  90.00   98.55  94.94     92.40
4  91.85  91.34   91.92  60.10     72.50
Total accuracy: 70.93%
Average sen: 66.66%
Average spec: 92.39%
Macro f1-score: 62.83%

=== Test on chp054-nsrr. train_data(3923), test_data(56) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2342067953883384
Starting epoch 2/10.
Epoch finished! Loss: 1.0562963692509397
Starting epoch 3/10.
Epoch finished! Loss: 0.9775040418821939
Starting epoch 4/10.
Epoch finished! Loss: 0.9358430234905408
Starting epoch 5/10.
Epoch finished! Loss: 0.9005019217729568
Starting epoch 6/10.
Epoch finished! Loss: 0.8805822856268104
Starting epoch 7/10.
Epoch finished! Loss: 0.8432822742176299
Starting epoch 8/10.
Epoch finished! Loss: 0.8168755533287719
Starting epoch 9/10.
Epoch finished! Loss: 0.8061123939649183
Starting epoch 10/10.
Epoch finished! Loss: 0.787973591335574
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6821428571428572
              precision    recall  f1-score   support

         0.0       0.84      0.51      0.64       232
         1.0       0.20      0.09      0.12        98
         2.0       0.87      0.69      0.77       475
         3.0       0.82      0.99      0.90        99
         4.0       0.48      0.97      0.65       216

    accuracy                           0.68      1120
   macro avg       0.64      0.65      0.61      1120
weighted avg       0.72      0.68      0.67      1120
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.86  51.29   97.41  83.80     63.64
1  88.75   9.18   96.38  19.57     12.50
2  82.41  69.05   92.25  86.77     76.91
3  98.04  98.99   97.94  82.35     89.91
4  79.38  97.22   75.11  48.28     64.52
Total accuracy: 68.21%
Average sen: 65.15%
Average spec: 91.82%
Macro f1-score: 61.49%

=== Test on chp055-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2705649973786608
Starting epoch 2/10.
Epoch finished! Loss: 1.0113640179743573
Starting epoch 3/10.
Epoch finished! Loss: 0.9354408536942638
Starting epoch 4/10.
Epoch finished! Loss: 0.8992074790353678
Starting epoch 5/10.
Epoch finished! Loss: 0.8623371390359742
Starting epoch 6/10.
Epoch finished! Loss: 0.8256460057989675
Starting epoch 7/10.
Epoch finished! Loss: 0.8057186348857929
Starting epoch 8/10.
Epoch finished! Loss: 0.7972349713043291
Starting epoch 9/10.
Epoch finished! Loss: 0.767182972662303
Starting epoch 10/10.
Epoch finished! Loss: 0.756933620617706
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6518181818181819
              precision    recall  f1-score   support

         0.0       0.90      0.46      0.61       211
         1.0       0.56      0.08      0.14       174
         2.0       0.73      0.86      0.79       408
         3.0       0.75      0.92      0.83       130
         4.0       0.42      0.76      0.54       177

    accuracy                           0.65      1100
   macro avg       0.67      0.62      0.58      1100
weighted avg       0.69      0.65      0.62      1100
 


====== chp055-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.64  45.97   98.76  89.81     60.82
1  84.45   8.05   98.81  56.00     14.07
2  82.73  86.03   80.78  72.52     78.70
3  95.45  92.31   95.88  75.00     82.76
4  79.09  76.27   79.63  41.80     54.00
Total accuracy: 65.18%
Average sen: 61.73%
Average spec: 90.77%
Macro f1-score: 58.07%

=== Test on chp056-nsrr. train_data(3924), test_data(55) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2762555657904975
Starting epoch 2/10.
Epoch finished! Loss: 1.0335861331954295
Starting epoch 3/10.
Epoch finished! Loss: 0.9569110533564674
Starting epoch 4/10.
Epoch finished! Loss: 0.9017678229328321
Starting epoch 5/10.
Epoch finished! Loss: 0.8715091156868302
Starting epoch 6/10.
Epoch finished! Loss: 0.8376727021318309
Starting epoch 7/10.
Epoch finished! Loss: 0.8215521723031998
Starting epoch 8/10.
Epoch finished! Loss: 0.8026382946694384
Starting epoch 9/10.
Epoch finished! Loss: 0.7797020924638729
Starting epoch 10/10.
Epoch finished! Loss: 0.7638749352523259
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6
              precision    recall  f1-score   support

         0.0       0.28      0.78      0.41        78
         1.0       0.33      0.00      0.01       284
         2.0       0.79      0.53      0.64       258
         3.0       0.69      0.99      0.81       185
         4.0       0.63      0.94      0.76       295

    accuracy                           0.60      1100
   macro avg       0.54      0.65      0.52      1100
weighted avg       0.58      0.60      0.52      1100
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.09  78.21   84.54  27.85     41.08
1  74.09   0.35   99.75  33.33      0.70
2  85.73  53.49   95.61  78.86     63.74
3  92.27  99.46   90.82  68.66     81.24
4  83.82  93.56   80.25  63.45     75.62
Total accuracy: 60.00%
Average sen: 65.01%
Average spec: 90.19%
Macro f1-score: 52.47%

=== Test on chp057-nsrr. train_data(3920), test_data(59) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2602909521373642
Starting epoch 2/10.
Epoch finished! Loss: 1.0621820389462249
Starting epoch 3/10.
Epoch finished! Loss: 0.9766957128749174
Starting epoch 4/10.
Epoch finished! Loss: 0.9308596687853489
Starting epoch 5/10.
Epoch finished! Loss: 0.8946389400440714
Starting epoch 6/10.
Epoch finished! Loss: 0.8649030700516518
Starting epoch 7/10.
Epoch finished! Loss: 0.8471960986361784
Starting epoch 8/10.
Epoch finished! Loss: 0.8230808466444235
Starting epoch 9/10.
Epoch finished! Loss: 0.789046188678278
Starting epoch 10/10.
Epoch finished! Loss: 0.762603868075344
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.6395250212044106
              precision    recall  f1-score   support

         0.0       0.80      0.77      0.78       269
         1.0       0.34      0.15      0.21       157
         2.0       0.83      0.58      0.68       499
         3.0       0.62      0.81      0.71        74
         4.0       0.43      0.96      0.59       180

    accuracy                           0.64      1179
   macro avg       0.60      0.66      0.60      1179
weighted avg       0.68      0.64      0.63      1179
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.33  76.95   94.29  79.92     78.41
1  84.73  15.29   95.40  33.80     21.05
2  77.35  58.12   91.47  83.33     68.48
3  95.76  81.08   96.74  62.50     70.59
4  79.73  96.11   76.78  42.72     59.15
Total accuracy: 63.95%
Average sen: 65.51%
Average spec: 90.94%
Macro f1-score: 59.53%

=== Test on chp058-nsrr. train_data(3928), test_data(51) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2716926456410058
Starting epoch 2/10.
Epoch finished! Loss: 1.0394708217710864
Starting epoch 3/10.
Epoch finished! Loss: 0.9386734095763187
Starting epoch 4/10.
Epoch finished! Loss: 0.8972517042895969
Starting epoch 5/10.
Epoch finished! Loss: 0.8585523836010572
Starting epoch 6/10.
Epoch finished! Loss: 0.849121881838964
Starting epoch 7/10.
Epoch finished! Loss: 0.8111690811204667
Starting epoch 8/10.
Epoch finished! Loss: 0.8019955834107739
Starting epoch 9/10.
Epoch finished! Loss: 0.7927593369873203
Starting epoch 10/10.
Epoch finished! Loss: 0.7623419497846341
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.638235294117647
              precision    recall  f1-score   support

         0.0       0.89      0.62      0.73       105
         1.0       0.21      0.07      0.10        44
         2.0       0.48      0.95      0.64       317
         3.0       0.98      0.75      0.85       258
         4.0       0.80      0.29      0.43       296

    accuracy                           0.64      1020
   macro avg       0.67      0.54      0.55      1020
weighted avg       0.73      0.64      0.62      1020
 


====== chp058-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.29  61.90   99.13  89.04     73.03
1  94.90   6.82   98.87  21.43     10.34
2  66.76  95.27   53.91  48.24     64.05
3  93.33  75.19   99.48  97.98     85.09
4  77.35  29.39   96.96  79.82     42.96
Total accuracy: 63.82%
Average sen: 53.72%
Average spec: 89.67%
Macro f1-score: 55.10%

=== Test on chp059-nsrr. train_data(3923), test_data(56) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2845812896076514
Starting epoch 2/10.
Epoch finished! Loss: 1.0229970841687552
Starting epoch 3/10.
Epoch finished! Loss: 0.9393468780481086
Starting epoch 4/10.
Epoch finished! Loss: 0.8815887099778166
Starting epoch 5/10.
Epoch finished! Loss: 0.8583171350159207
Starting epoch 6/10.
Epoch finished! Loss: 0.8327547341433107
Starting epoch 7/10.
Epoch finished! Loss: 0.8071568122475731
Starting epoch 8/10.
Epoch finished! Loss: 0.7895124143331634
Starting epoch 9/10.
Epoch finished! Loss: 0.762869265234592
Starting epoch 10/10.
Epoch finished! Loss: 0.735467152936118
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.7098214285714286
              precision    recall  f1-score   support

         0.0       0.84      0.82      0.83       257
         1.0       0.58      0.48      0.53       254
         2.0       0.71      0.84      0.77       355
         3.0       1.00      0.34      0.51        87
         4.0       0.64      0.80      0.71       167

    accuracy                           0.71      1120
   macro avg       0.75      0.66      0.67      1120
weighted avg       0.72      0.71      0.70      1120
 


====== chp059-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.23  81.71   95.37   84.00     82.84
1  80.45  48.43   89.84   58.29     52.90
2  84.02  83.94   84.05   70.95     76.90
3  94.91  34.48  100.00  100.00     51.28
4  90.36  80.24   92.13   64.11     71.28
Total accuracy: 70.98%
Average sen: 65.76%
Average spec: 92.28%
Macro f1-score: 67.04%

=== Test on chp060-nsrr. train_data(3916), test_data(63) ===
==== START TRAINING ====
load model to cuda:0
Starting epoch 1/10.
Epoch finished! Loss: 1.2759931903056172
Starting epoch 2/10.
Epoch finished! Loss: 1.0706350978683024
Starting epoch 3/10.
Epoch finished! Loss: 0.9887326882623345
Starting epoch 4/10.
Epoch finished! Loss: 0.9357670621798776
Starting epoch 5/10.
Epoch finished! Loss: 0.9061197561528677
Starting epoch 6/10.
Epoch finished! Loss: 0.8669420651462681
Starting epoch 7/10.
Epoch finished! Loss: 0.8421355790037024
Starting epoch 8/10.
Epoch finished! Loss: 0.8253867397527865
Starting epoch 9/10.
Epoch finished! Loss: 0.7990381501977096
Starting epoch 10/10.
Epoch finished! Loss: 0.7722349965663822
Model saved !

==== START TESTING ====
Sleep stage: acc = 0.546031746031746
              precision    recall  f1-score   support

         0.0       0.64      0.58      0.61       519
         1.0       0.35      0.56      0.43       201
         2.0       0.79      0.23      0.36       228
         3.0       0.93      0.79      0.86       158
         4.0       0.36      0.63      0.46       154

    accuracy                           0.55      1260
   macro avg       0.61      0.56      0.54      1260
weighted avg       0.62      0.55      0.55      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  69.13  58.00   76.92  63.77     60.75
1  76.43  55.72   80.36  35.00     42.99
2  85.00  23.25   98.64  79.10     35.93
3  96.67  79.11   99.18  93.28     85.62
4  81.98  62.99   84.63  36.33     46.08
Total accuracy: 54.60%
Average sen: 55.81%
Average spec: 87.95%
Macro f1-score: 54.27%

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.18  65.85   92.96  60.27     62.93
1  85.81  15.10   96.05  35.59     21.20
2  78.97  76.95   80.19  70.20     73.42
3  92.73  78.99   95.65  79.39     79.19
4  86.04  68.26   89.98  60.14     63.94
Total accuracy: 66.36%
Average sen: 61.03%
Average spec: 90.96%
Macro f1-score: 60.14%
