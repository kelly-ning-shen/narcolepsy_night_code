cuda:1
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.358182, loss_ss: 1.676399, loss_d: 0.681783
0.0383 --- loss: 2.384816, loss_ss: 1.645495, loss_d: 0.739321
0.0766 --- loss: 2.230295, loss_ss: 1.644017, loss_d: 0.586278
0.1149 --- loss: 2.196337, loss_ss: 1.547274, loss_d: 0.649063
0.1531 --- loss: 1.987262, loss_ss: 1.500483, loss_d: 0.486780
0.1914 --- loss: 2.010249, loss_ss: 1.563474, loss_d: 0.446775
0.2297 --- loss: 2.439604, loss_ss: 1.542353, loss_d: 0.897250
0.2680 --- loss: 2.159896, loss_ss: 1.624022, loss_d: 0.535874
0.3063 --- loss: 1.969024, loss_ss: 1.590254, loss_d: 0.378770
0.3446 --- loss: 1.834847, loss_ss: 1.530908, loss_d: 0.303938
0.3828 --- loss: 2.261789, loss_ss: 1.523904, loss_d: 0.737884
0.4211 --- loss: 2.167280, loss_ss: 1.618705, loss_d: 0.548575
0.4594 --- loss: 2.209078, loss_ss: 1.508797, loss_d: 0.700281
0.4977 --- loss: 1.996956, loss_ss: 1.452819, loss_d: 0.544137
0.5360 --- loss: 2.278567, loss_ss: 1.485746, loss_d: 0.792820
0.5743 --- loss: 1.917873, loss_ss: 1.550926, loss_d: 0.366947
0.6126 --- loss: 1.922006, loss_ss: 1.639231, loss_d: 0.282775
0.6508 --- loss: 1.876125, loss_ss: 1.576769, loss_d: 0.299357
0.6891 --- loss: 2.076436, loss_ss: 1.605725, loss_d: 0.470711
0.7274 --- loss: 2.083129, loss_ss: 1.587069, loss_d: 0.496060
0.7657 --- loss: 1.903371, loss_ss: 1.434798, loss_d: 0.468573
0.8040 --- loss: 2.157797, loss_ss: 1.509137, loss_d: 0.648659
0.8423 --- loss: 2.104536, loss_ss: 1.625855, loss_d: 0.478681
0.8806 --- loss: 2.202373, loss_ss: 1.718818, loss_d: 0.483556
0.9188 --- loss: 1.853087, loss_ss: 1.497108, loss_d: 0.355979
0.9571 --- loss: 2.256171, loss_ss: 1.697492, loss_d: 0.558678
0.9954 --- loss: 1.792454, loss_ss: 1.439708, loss_d: 0.352745
Epoch finished! Loss: 2.113433565216503
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.064703, loss_ss: 1.559168, loss_d: 0.505536
0.0383 --- loss: 1.984683, loss_ss: 1.577866, loss_d: 0.406817
0.0766 --- loss: 1.936511, loss_ss: 1.551762, loss_d: 0.384749
0.1149 --- loss: 1.948672, loss_ss: 1.473376, loss_d: 0.475296
0.1531 --- loss: 2.040012, loss_ss: 1.428091, loss_d: 0.611921
0.1914 --- loss: 2.349809, loss_ss: 1.603065, loss_d: 0.746745
0.2297 --- loss: 2.136021, loss_ss: 1.525375, loss_d: 0.610645
0.2680 --- loss: 1.849788, loss_ss: 1.445623, loss_d: 0.404165
0.3063 --- loss: 1.891189, loss_ss: 1.471562, loss_d: 0.419627
0.3446 --- loss: 1.535954, loss_ss: 1.215570, loss_d: 0.320384
0.3828 --- loss: 1.831471, loss_ss: 1.324118, loss_d: 0.507354
0.4211 --- loss: 2.009382, loss_ss: 1.482769, loss_d: 0.526613
0.4594 --- loss: 1.936857, loss_ss: 1.600529, loss_d: 0.336328
0.4977 --- loss: 1.821722, loss_ss: 1.436096, loss_d: 0.385627
0.5360 --- loss: 1.718083, loss_ss: 1.349838, loss_d: 0.368245
0.5743 --- loss: 1.916859, loss_ss: 1.544357, loss_d: 0.372502
0.6126 --- loss: 1.828588, loss_ss: 1.408332, loss_d: 0.420256
0.6508 --- loss: 1.696677, loss_ss: 1.309215, loss_d: 0.387462
0.6891 --- loss: 2.308793, loss_ss: 1.578165, loss_d: 0.730628
0.7274 --- loss: 2.287738, loss_ss: 1.809252, loss_d: 0.478486
0.7657 --- loss: 1.696687, loss_ss: 1.377760, loss_d: 0.318927
0.8040 --- loss: 2.230073, loss_ss: 1.571139, loss_d: 0.658933
0.8423 --- loss: 1.889437, loss_ss: 1.477722, loss_d: 0.411715
0.8806 --- loss: 1.944638, loss_ss: 1.411827, loss_d: 0.532812
0.9188 --- loss: 1.851994, loss_ss: 1.261123, loss_d: 0.590872
0.9571 --- loss: 2.048982, loss_ss: 1.534809, loss_d: 0.514173
0.9954 --- loss: 2.118171, loss_ss: 1.431051, loss_d: 0.687120
Epoch finished! Loss: 2.0038724740346274
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.001077, loss_ss: 1.537030, loss_d: 0.464047
0.0383 --- loss: 2.011413, loss_ss: 1.475418, loss_d: 0.535995
0.0766 --- loss: 1.918560, loss_ss: 1.477131, loss_d: 0.441429
0.1149 --- loss: 2.303503, loss_ss: 1.497972, loss_d: 0.805531
0.1531 --- loss: 2.062334, loss_ss: 1.527031, loss_d: 0.535303
0.1914 --- loss: 1.966182, loss_ss: 1.418999, loss_d: 0.547183
0.2297 --- loss: 2.241106, loss_ss: 1.614383, loss_d: 0.626724
0.2680 --- loss: 1.775392, loss_ss: 1.247419, loss_d: 0.527973
0.3063 --- loss: 2.193469, loss_ss: 1.663105, loss_d: 0.530364
0.3446 --- loss: 2.037866, loss_ss: 1.458826, loss_d: 0.579040
0.3828 --- loss: 1.652461, loss_ss: 1.260914, loss_d: 0.391547
0.4211 --- loss: 1.830655, loss_ss: 1.546471, loss_d: 0.284185
0.4594 --- loss: 1.751034, loss_ss: 1.485883, loss_d: 0.265151
0.4977 --- loss: 1.834466, loss_ss: 1.309487, loss_d: 0.524979
0.5360 --- loss: 2.209615, loss_ss: 1.311515, loss_d: 0.898100
0.5743 --- loss: 1.995946, loss_ss: 1.568345, loss_d: 0.427601
0.6126 --- loss: 2.084568, loss_ss: 1.782660, loss_d: 0.301907
0.6508 --- loss: 1.631134, loss_ss: 1.273226, loss_d: 0.357908
0.6891 --- loss: 1.639580, loss_ss: 1.396017, loss_d: 0.243563
0.7274 --- loss: 1.717150, loss_ss: 1.331229, loss_d: 0.385921
0.7657 --- loss: 1.856077, loss_ss: 1.396799, loss_d: 0.459278
0.8040 --- loss: 1.892642, loss_ss: 1.330447, loss_d: 0.562195
0.8423 --- loss: 2.416579, loss_ss: 1.503321, loss_d: 0.913258
0.8806 --- loss: 2.175305, loss_ss: 1.556004, loss_d: 0.619301
0.9188 --- loss: 2.474758, loss_ss: 1.648262, loss_d: 0.826496
0.9571 --- loss: 1.995690, loss_ss: 1.508716, loss_d: 0.486974
0.9954 --- loss: 1.836209, loss_ss: 1.504921, loss_d: 0.331288
Epoch finished! Loss: 1.9829874911070784
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.854736, loss_ss: 1.467039, loss_d: 0.387697
0.0383 --- loss: 1.705745, loss_ss: 1.331659, loss_d: 0.374086
0.0766 --- loss: 1.621087, loss_ss: 1.250691, loss_d: 0.370396
0.1149 --- loss: 1.855113, loss_ss: 1.508515, loss_d: 0.346598
0.1531 --- loss: 1.866243, loss_ss: 1.501672, loss_d: 0.364570
0.1914 --- loss: 1.629287, loss_ss: 1.332137, loss_d: 0.297150
0.2297 --- loss: 1.786599, loss_ss: 1.435966, loss_d: 0.350633
0.2680 --- loss: 1.733017, loss_ss: 1.350410, loss_d: 0.382607
0.3063 --- loss: 2.032931, loss_ss: 1.437529, loss_d: 0.595402
0.3446 --- loss: 1.899094, loss_ss: 1.412229, loss_d: 0.486865
0.3828 --- loss: 2.121257, loss_ss: 1.728615, loss_d: 0.392642
0.4211 --- loss: 1.767261, loss_ss: 1.351055, loss_d: 0.416206
0.4594 --- loss: 1.880914, loss_ss: 1.228098, loss_d: 0.652816
0.4977 --- loss: 1.887600, loss_ss: 1.579497, loss_d: 0.308103
0.5360 --- loss: 1.771117, loss_ss: 1.412239, loss_d: 0.358878
0.5743 --- loss: 2.047696, loss_ss: 1.553152, loss_d: 0.494544
0.6126 --- loss: 1.665967, loss_ss: 1.397452, loss_d: 0.268515
0.6508 --- loss: 1.836454, loss_ss: 1.484218, loss_d: 0.352235
0.6891 --- loss: 2.085846, loss_ss: 1.752856, loss_d: 0.332990
0.7274 --- loss: 1.957629, loss_ss: 1.372086, loss_d: 0.585543
0.7657 --- loss: 1.749623, loss_ss: 1.325922, loss_d: 0.423701
0.8040 --- loss: 2.121852, loss_ss: 1.449814, loss_d: 0.672038
0.8423 --- loss: 1.897832, loss_ss: 1.607983, loss_d: 0.289848
0.8806 --- loss: 1.920034, loss_ss: 1.485540, loss_d: 0.434494
0.9188 --- loss: 1.612191, loss_ss: 1.317857, loss_d: 0.294334
0.9571 --- loss: 2.105841, loss_ss: 1.450302, loss_d: 0.655539
0.9954 --- loss: 1.808489, loss_ss: 1.210483, loss_d: 0.598006
Epoch finished! Loss: 1.9097552007185545
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.714454, loss_ss: 1.271535, loss_d: 0.442920
0.0383 --- loss: 2.813443, loss_ss: 1.331025, loss_d: 1.482418
0.0766 --- loss: 2.149933, loss_ss: 1.601779, loss_d: 0.548155
0.1149 --- loss: 1.628020, loss_ss: 1.264541, loss_d: 0.363479
0.1531 --- loss: 1.785239, loss_ss: 1.382432, loss_d: 0.402807
0.1914 --- loss: 1.779476, loss_ss: 1.484342, loss_d: 0.295134
0.2297 --- loss: 1.698931, loss_ss: 1.260795, loss_d: 0.438136
0.2680 --- loss: 2.384771, loss_ss: 1.465839, loss_d: 0.918933
0.3063 --- loss: 2.022057, loss_ss: 1.434584, loss_d: 0.587473
0.3446 --- loss: 1.602591, loss_ss: 1.232428, loss_d: 0.370163
0.3828 --- loss: 1.944175, loss_ss: 1.253746, loss_d: 0.690429
0.4211 --- loss: 1.610470, loss_ss: 1.318812, loss_d: 0.291657
0.4594 --- loss: 1.870596, loss_ss: 1.364725, loss_d: 0.505871
0.4977 --- loss: 1.920086, loss_ss: 1.491675, loss_d: 0.428411
0.5360 --- loss: 1.754702, loss_ss: 1.365323, loss_d: 0.389379
0.5743 --- loss: 1.985027, loss_ss: 1.318088, loss_d: 0.666939
0.6126 --- loss: 1.581730, loss_ss: 1.191289, loss_d: 0.390441
0.6508 --- loss: 1.635155, loss_ss: 1.251056, loss_d: 0.384099
0.6891 --- loss: 1.589340, loss_ss: 1.207220, loss_d: 0.382120
0.7274 --- loss: 2.019310, loss_ss: 1.319619, loss_d: 0.699691
0.7657 --- loss: 1.631760, loss_ss: 1.261664, loss_d: 0.370097
0.8040 --- loss: 1.653573, loss_ss: 1.316125, loss_d: 0.337448
0.8423 --- loss: 1.519508, loss_ss: 1.134958, loss_d: 0.384550
0.8806 --- loss: 1.523103, loss_ss: 1.141622, loss_d: 0.381480
0.9188 --- loss: 1.673119, loss_ss: 1.196703, loss_d: 0.476416
0.9571 --- loss: 1.480862, loss_ss: 1.164895, loss_d: 0.315968
0.9954 --- loss: 2.538601, loss_ss: 1.346222, loss_d: 1.192379
Epoch finished! Loss: 1.8117096976758877
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.783290, loss_ss: 1.313487, loss_d: 0.469802
0.0383 --- loss: 1.962363, loss_ss: 1.483144, loss_d: 0.479219
0.0766 --- loss: 1.451042, loss_ss: 1.016070, loss_d: 0.434972
0.1149 --- loss: 1.859909, loss_ss: 1.537707, loss_d: 0.322202
0.1531 --- loss: 1.518328, loss_ss: 1.177690, loss_d: 0.340638
0.1914 --- loss: 1.507520, loss_ss: 1.218045, loss_d: 0.289474
0.2297 --- loss: 1.561480, loss_ss: 1.270888, loss_d: 0.290592
0.2680 --- loss: 1.762711, loss_ss: 1.024232, loss_d: 0.738479
0.3063 --- loss: 1.441309, loss_ss: 1.198772, loss_d: 0.242537
0.3446 --- loss: 1.452406, loss_ss: 1.137383, loss_d: 0.315024
0.3828 --- loss: 1.382977, loss_ss: 1.137283, loss_d: 0.245694
0.4211 --- loss: 1.504468, loss_ss: 1.104744, loss_d: 0.399724
0.4594 --- loss: 1.550287, loss_ss: 0.960233, loss_d: 0.590054
0.4977 --- loss: 1.315448, loss_ss: 1.025348, loss_d: 0.290100
0.5360 --- loss: 1.714393, loss_ss: 1.323354, loss_d: 0.391039
0.5743 --- loss: 1.441650, loss_ss: 1.027302, loss_d: 0.414348
0.6126 --- loss: 1.550931, loss_ss: 1.189258, loss_d: 0.361673
0.6508 --- loss: 1.786414, loss_ss: 1.291182, loss_d: 0.495232
0.6891 --- loss: 1.572005, loss_ss: 1.169586, loss_d: 0.402419
0.7274 --- loss: 1.472951, loss_ss: 1.026816, loss_d: 0.446135
0.7657 --- loss: 1.419596, loss_ss: 1.094628, loss_d: 0.324969
0.8040 --- loss: 2.176294, loss_ss: 1.420206, loss_d: 0.756088
0.8423 --- loss: 1.517112, loss_ss: 1.258883, loss_d: 0.258229
0.8806 --- loss: 2.137329, loss_ss: 1.377743, loss_d: 0.759585
0.9188 --- loss: 1.530435, loss_ss: 1.188480, loss_d: 0.341955
0.9571 --- loss: 1.555340, loss_ss: 1.246887, loss_d: 0.308453
0.9954 --- loss: 2.170969, loss_ss: 1.302283, loss_d: 0.868686
Epoch finished! Loss: 1.686727452095441
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.794916, loss_ss: 1.054054, loss_d: 0.740862
0.0383 --- loss: 1.516677, loss_ss: 1.007399, loss_d: 0.509278
0.0766 --- loss: 1.512418, loss_ss: 1.285714, loss_d: 0.226704
0.1149 --- loss: 1.441444, loss_ss: 0.910647, loss_d: 0.530797
0.1531 --- loss: 1.602509, loss_ss: 1.104235, loss_d: 0.498275
0.1914 --- loss: 1.416853, loss_ss: 1.017331, loss_d: 0.399522
0.2297 --- loss: 1.739076, loss_ss: 1.385834, loss_d: 0.353242
0.2680 --- loss: 1.591805, loss_ss: 1.078771, loss_d: 0.513033
0.3063 --- loss: 1.540448, loss_ss: 1.213238, loss_d: 0.327210
0.3446 --- loss: 1.456500, loss_ss: 1.042720, loss_d: 0.413780
0.3828 --- loss: 1.998390, loss_ss: 1.311941, loss_d: 0.686449
0.4211 --- loss: 2.263877, loss_ss: 1.578363, loss_d: 0.685515
0.4594 --- loss: 1.644396, loss_ss: 1.277322, loss_d: 0.367074
0.4977 --- loss: 1.377915, loss_ss: 1.076977, loss_d: 0.300938
0.5360 --- loss: 1.407051, loss_ss: 1.000502, loss_d: 0.406549
0.5743 --- loss: 1.852666, loss_ss: 1.472454, loss_d: 0.380212
0.6126 --- loss: 1.537193, loss_ss: 1.224839, loss_d: 0.312354
0.6508 --- loss: 1.932590, loss_ss: 1.446973, loss_d: 0.485617
0.6891 --- loss: 1.187872, loss_ss: 0.866256, loss_d: 0.321616
0.7274 --- loss: 1.785837, loss_ss: 1.269660, loss_d: 0.516177
0.7657 --- loss: 1.576056, loss_ss: 1.147545, loss_d: 0.428510
0.8040 --- loss: 1.625078, loss_ss: 1.264407, loss_d: 0.360671
0.8423 --- loss: 1.380831, loss_ss: 1.010521, loss_d: 0.370310
0.8806 --- loss: 1.831684, loss_ss: 1.307426, loss_d: 0.524258
0.9188 --- loss: 2.627754, loss_ss: 1.177733, loss_d: 1.450021
0.9571 --- loss: 1.883839, loss_ss: 1.556225, loss_d: 0.327614
0.9954 --- loss: 1.706941, loss_ss: 1.190431, loss_d: 0.516510
Epoch finished! Loss: 1.6284264495089593
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.623763, loss_ss: 1.294910, loss_d: 0.328853
0.0383 --- loss: 1.591701, loss_ss: 1.000881, loss_d: 0.590819
0.0766 --- loss: 1.783599, loss_ss: 1.054772, loss_d: 0.728827
0.1149 --- loss: 1.427594, loss_ss: 0.976044, loss_d: 0.451551
0.1531 --- loss: 1.654102, loss_ss: 1.341474, loss_d: 0.312628
0.1914 --- loss: 1.555479, loss_ss: 1.223602, loss_d: 0.331877
0.2297 --- loss: 1.733819, loss_ss: 0.956136, loss_d: 0.777683
0.2680 --- loss: 2.047830, loss_ss: 1.074214, loss_d: 0.973616
0.3063 --- loss: 1.328098, loss_ss: 0.855384, loss_d: 0.472714
0.3446 --- loss: 1.661987, loss_ss: 1.058598, loss_d: 0.603389
0.3828 --- loss: 1.393146, loss_ss: 1.066079, loss_d: 0.327067
0.4211 --- loss: 1.510346, loss_ss: 1.130275, loss_d: 0.380070
0.4594 --- loss: 1.984322, loss_ss: 1.549120, loss_d: 0.435202
0.4977 --- loss: 1.548494, loss_ss: 1.109176, loss_d: 0.439318
0.5360 --- loss: 1.684338, loss_ss: 1.426459, loss_d: 0.257878
0.5743 --- loss: 1.619970, loss_ss: 1.196790, loss_d: 0.423180
0.6126 --- loss: 1.202405, loss_ss: 0.968181, loss_d: 0.234224
0.6508 --- loss: 1.390476, loss_ss: 1.080542, loss_d: 0.309934
0.6891 --- loss: 1.555089, loss_ss: 1.112756, loss_d: 0.442332
0.7274 --- loss: 1.539713, loss_ss: 1.067299, loss_d: 0.472414
0.7657 --- loss: 1.488410, loss_ss: 1.200387, loss_d: 0.288023
0.8040 --- loss: 2.022406, loss_ss: 1.363881, loss_d: 0.658526
0.8423 --- loss: 1.470520, loss_ss: 0.950912, loss_d: 0.519608
0.8806 --- loss: 1.661583, loss_ss: 1.074199, loss_d: 0.587384
0.9188 --- loss: 1.337287, loss_ss: 0.926424, loss_d: 0.410863
0.9571 --- loss: 1.580411, loss_ss: 1.248974, loss_d: 0.331437
0.9954 --- loss: 1.209220, loss_ss: 0.884920, loss_d: 0.324301
Epoch finished! Loss: 1.5618984626170775
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.390788, loss_ss: 1.031367, loss_d: 0.359422
0.0383 --- loss: 1.703991, loss_ss: 1.309873, loss_d: 0.394118
0.0766 --- loss: 1.506251, loss_ss: 0.901232, loss_d: 0.605019
0.1149 --- loss: 2.019066, loss_ss: 0.968597, loss_d: 1.050469
0.1531 --- loss: 1.365342, loss_ss: 1.022462, loss_d: 0.342881
0.1914 --- loss: 1.155586, loss_ss: 0.871152, loss_d: 0.284435
0.2297 --- loss: 1.790269, loss_ss: 1.359074, loss_d: 0.431195
0.2680 --- loss: 1.433164, loss_ss: 1.091455, loss_d: 0.341709
0.3063 --- loss: 1.437230, loss_ss: 1.121896, loss_d: 0.315334
0.3446 --- loss: 1.918622, loss_ss: 1.022309, loss_d: 0.896314
0.3828 --- loss: 1.363832, loss_ss: 1.067280, loss_d: 0.296552
0.4211 --- loss: 2.205167, loss_ss: 0.937708, loss_d: 1.267459
0.4594 --- loss: 1.477370, loss_ss: 1.173976, loss_d: 0.303394
0.4977 --- loss: 1.844183, loss_ss: 1.346838, loss_d: 0.497345
0.5360 --- loss: 1.483451, loss_ss: 1.132573, loss_d: 0.350878
0.5743 --- loss: 1.611952, loss_ss: 1.305124, loss_d: 0.306828
0.6126 --- loss: 1.474546, loss_ss: 1.083850, loss_d: 0.390696
0.6508 --- loss: 1.412012, loss_ss: 1.119766, loss_d: 0.292246
0.6891 --- loss: 1.178235, loss_ss: 0.950620, loss_d: 0.227616
0.7274 --- loss: 1.649204, loss_ss: 1.109710, loss_d: 0.539494
0.7657 --- loss: 1.807275, loss_ss: 0.803887, loss_d: 1.003388
0.8040 --- loss: 1.209377, loss_ss: 0.998674, loss_d: 0.210703
0.8423 --- loss: 1.222404, loss_ss: 0.954992, loss_d: 0.267412
0.8806 --- loss: 1.724913, loss_ss: 1.212740, loss_d: 0.512173
0.9188 --- loss: 1.613516, loss_ss: 0.836447, loss_d: 0.777069
0.9571 --- loss: 1.325400, loss_ss: 1.020274, loss_d: 0.305127
0.9954 --- loss: 1.382176, loss_ss: 0.983704, loss_d: 0.398472
Epoch finished! Loss: 1.5200623301253922
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.506842, loss_ss: 1.213660, loss_d: 0.293182
0.0383 --- loss: 1.326222, loss_ss: 0.812923, loss_d: 0.513299
0.0766 --- loss: 1.611478, loss_ss: 1.198633, loss_d: 0.412845
0.1149 --- loss: 1.477326, loss_ss: 1.148568, loss_d: 0.328758
0.1531 --- loss: 1.433645, loss_ss: 1.028943, loss_d: 0.404702
0.1914 --- loss: 2.073686, loss_ss: 1.217975, loss_d: 0.855711
0.2297 --- loss: 1.758182, loss_ss: 1.068419, loss_d: 0.689763
0.2680 --- loss: 1.522946, loss_ss: 1.016787, loss_d: 0.506159
0.3063 --- loss: 1.539677, loss_ss: 1.197906, loss_d: 0.341770
0.3446 --- loss: 1.384619, loss_ss: 1.039656, loss_d: 0.344963
0.3828 --- loss: 1.568725, loss_ss: 1.003384, loss_d: 0.565341
0.4211 --- loss: 1.506253, loss_ss: 1.210921, loss_d: 0.295332
0.4594 --- loss: 1.440107, loss_ss: 0.959321, loss_d: 0.480786
0.4977 --- loss: 1.452853, loss_ss: 0.908546, loss_d: 0.544307
0.5360 --- loss: 1.558269, loss_ss: 1.205815, loss_d: 0.352454
0.5743 --- loss: 1.494827, loss_ss: 1.132971, loss_d: 0.361855
0.6126 --- loss: 1.172172, loss_ss: 0.987431, loss_d: 0.184740
0.6508 --- loss: 1.573371, loss_ss: 1.195655, loss_d: 0.377716
0.6891 --- loss: 1.478018, loss_ss: 1.187099, loss_d: 0.290918
0.7274 --- loss: 1.290780, loss_ss: 0.825574, loss_d: 0.465207
0.7657 --- loss: 1.593985, loss_ss: 1.045769, loss_d: 0.548216
0.8040 --- loss: 1.411260, loss_ss: 1.229790, loss_d: 0.181470
0.8423 --- loss: 1.478859, loss_ss: 0.909839, loss_d: 0.569020
0.8806 --- loss: 1.724053, loss_ss: 1.299577, loss_d: 0.424476
0.9188 --- loss: 1.431339, loss_ss: 1.091663, loss_d: 0.339676
0.9571 --- loss: 1.488928, loss_ss: 1.088725, loss_d: 0.400203
0.9954 --- loss: 1.406831, loss_ss: 1.072886, loss_d: 0.333945
Epoch finished! Loss: 1.521319766610975
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.3576923076923077
             precision    recall  f1-score   support

        0.0       0.15      0.99      0.26        78
        1.0       0.00      0.00      0.00        50
        2.0       0.82      0.22      0.35       397
        3.0       0.67      0.78      0.72       143
        4.0       1.00      0.01      0.02       112

avg / total       0.70      0.36      0.34       780
 


====== chc001-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  45.13  98.72   39.17   15.28     26.46
1  93.59   0.00  100.00    0.00      0.00
2  58.08  22.42   95.04   82.41     35.25
3  88.97  78.32   91.37   67.07     72.26
4  85.77   0.89  100.00  100.00      1.77
Total accuracy: 35.77%
Average sen: 40.07%
Average spec: 85.12%
Macro f1-score: 27.15%
[0.99399757 0.99088669 0.99303025 0.99252909 0.99018389 0.9765389
 0.96110469 0.97916234 0.98828775 0.97740185 0.98353392 0.98211676
 0.96817905 0.9665736  0.98552793 0.988913   0.98341089 0.97038978
 0.98355973 0.98365235 0.99645609 0.9962483  0.98736817 0.96816081
 0.99023753 0.98469049]
pred: 0.9831592853252704, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 1.932698, loss_ss: 1.284540, loss_d: 0.648158
0.0384 --- loss: 2.128913, loss_ss: 1.667183, loss_d: 0.461730
0.0768 --- loss: 2.151021, loss_ss: 1.649714, loss_d: 0.501308
0.1153 --- loss: 1.869036, loss_ss: 1.583006, loss_d: 0.286030
0.1537 --- loss: 2.331817, loss_ss: 1.584790, loss_d: 0.747027
0.1921 --- loss: 2.269504, loss_ss: 1.633515, loss_d: 0.635989
0.2305 --- loss: 2.229381, loss_ss: 1.497141, loss_d: 0.732239
0.2689 --- loss: 2.109443, loss_ss: 1.473408, loss_d: 0.636035
0.3073 --- loss: 2.948788, loss_ss: 1.839900, loss_d: 1.108889
0.3458 --- loss: 2.012070, loss_ss: 1.543507, loss_d: 0.468563
0.3842 --- loss: 2.061587, loss_ss: 1.726375, loss_d: 0.335212
0.4226 --- loss: 2.541385, loss_ss: 1.693394, loss_d: 0.847992
0.4610 --- loss: 2.052077, loss_ss: 1.632026, loss_d: 0.420052
0.4994 --- loss: 2.163710, loss_ss: 1.543090, loss_d: 0.620620
0.5378 --- loss: 1.770712, loss_ss: 1.459207, loss_d: 0.311505
0.5763 --- loss: 2.301162, loss_ss: 1.516919, loss_d: 0.784244
0.6147 --- loss: 2.038204, loss_ss: 1.462280, loss_d: 0.575924
0.6531 --- loss: 2.026119, loss_ss: 1.582813, loss_d: 0.443306
0.6915 --- loss: 2.056307, loss_ss: 1.470394, loss_d: 0.585912
0.7299 --- loss: 2.298530, loss_ss: 1.762925, loss_d: 0.535605
0.7683 --- loss: 2.303294, loss_ss: 1.491341, loss_d: 0.811953
0.8068 --- loss: 2.075503, loss_ss: 1.719189, loss_d: 0.356315
0.8452 --- loss: 2.201099, loss_ss: 1.473474, loss_d: 0.727625
0.8836 --- loss: 2.008869, loss_ss: 1.493541, loss_d: 0.515329
0.9220 --- loss: 1.885285, loss_ss: 1.534550, loss_d: 0.350735
0.9604 --- loss: 1.975882, loss_ss: 1.524796, loss_d: 0.451086
0.9988 --- loss: 1.873973, loss_ss: 1.555880, loss_d: 0.318092
Epoch finished! Loss: 2.0810882449150085
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.221425, loss_ss: 1.633318, loss_d: 0.588107
0.0384 --- loss: 2.001516, loss_ss: 1.393830, loss_d: 0.607687
0.0768 --- loss: 2.028517, loss_ss: 1.476783, loss_d: 0.551734
0.1153 --- loss: 1.987206, loss_ss: 1.635176, loss_d: 0.352031
0.1537 --- loss: 1.978597, loss_ss: 1.574892, loss_d: 0.403705
0.1921 --- loss: 2.058188, loss_ss: 1.534350, loss_d: 0.523838
0.2305 --- loss: 2.298376, loss_ss: 1.581929, loss_d: 0.716447
0.2689 --- loss: 2.108281, loss_ss: 1.670870, loss_d: 0.437410
0.3073 --- loss: 2.028926, loss_ss: 1.331859, loss_d: 0.697067
0.3458 --- loss: 2.163690, loss_ss: 1.681570, loss_d: 0.482120
0.3842 --- loss: 1.890864, loss_ss: 1.405599, loss_d: 0.485265
0.4226 --- loss: 1.981743, loss_ss: 1.611035, loss_d: 0.370708
0.4610 --- loss: 1.938905, loss_ss: 1.474563, loss_d: 0.464342
0.4994 --- loss: 2.306435, loss_ss: 1.607501, loss_d: 0.698933
0.5378 --- loss: 2.082347, loss_ss: 1.480406, loss_d: 0.601941
0.5763 --- loss: 1.873850, loss_ss: 1.584345, loss_d: 0.289504
0.6147 --- loss: 1.656712, loss_ss: 1.295976, loss_d: 0.360736
0.6531 --- loss: 1.968126, loss_ss: 1.499684, loss_d: 0.468442
0.6915 --- loss: 1.958375, loss_ss: 1.325665, loss_d: 0.632710
0.7299 --- loss: 1.973808, loss_ss: 1.564788, loss_d: 0.409021
0.7683 --- loss: 1.915109, loss_ss: 1.463908, loss_d: 0.451201
0.8068 --- loss: 2.242177, loss_ss: 1.273691, loss_d: 0.968486
0.8452 --- loss: 1.941487, loss_ss: 1.511634, loss_d: 0.429853
0.8836 --- loss: 1.926384, loss_ss: 1.322861, loss_d: 0.603522
0.9220 --- loss: 1.853291, loss_ss: 1.350750, loss_d: 0.502541
0.9604 --- loss: 1.879936, loss_ss: 1.420707, loss_d: 0.459228
0.9988 --- loss: 1.729681, loss_ss: 1.214245, loss_d: 0.515436
Epoch finished! Loss: 1.992930584687453
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.717205, loss_ss: 1.264718, loss_d: 0.452487
0.0384 --- loss: 2.187874, loss_ss: 1.556929, loss_d: 0.630944
0.0768 --- loss: 1.701628, loss_ss: 1.228969, loss_d: 0.472659
0.1153 --- loss: 1.719352, loss_ss: 1.368544, loss_d: 0.350808
0.1537 --- loss: 1.890323, loss_ss: 1.404453, loss_d: 0.485871
0.1921 --- loss: 2.134385, loss_ss: 1.459671, loss_d: 0.674714
0.2305 --- loss: 1.692547, loss_ss: 1.253477, loss_d: 0.439070
0.2689 --- loss: 1.886087, loss_ss: 1.498514, loss_d: 0.387573
0.3073 --- loss: 1.853563, loss_ss: 1.353231, loss_d: 0.500333
0.3458 --- loss: 1.570094, loss_ss: 1.157483, loss_d: 0.412611
0.3842 --- loss: 1.757028, loss_ss: 1.287400, loss_d: 0.469628
0.4226 --- loss: 1.576382, loss_ss: 1.068969, loss_d: 0.507412
0.4610 --- loss: 1.757181, loss_ss: 1.261419, loss_d: 0.495762
0.4994 --- loss: 1.770683, loss_ss: 1.362819, loss_d: 0.407864
0.5378 --- loss: 1.878356, loss_ss: 1.265160, loss_d: 0.613196
0.5763 --- loss: 2.597806, loss_ss: 1.831317, loss_d: 0.766489
0.6147 --- loss: 2.002052, loss_ss: 1.286083, loss_d: 0.715969
0.6531 --- loss: 1.940442, loss_ss: 1.466185, loss_d: 0.474257
0.6915 --- loss: 1.622803, loss_ss: 1.093229, loss_d: 0.529574
0.7299 --- loss: 2.098997, loss_ss: 1.302825, loss_d: 0.796171
0.7683 --- loss: 1.661789, loss_ss: 1.251227, loss_d: 0.410561
0.8068 --- loss: 1.695788, loss_ss: 1.252186, loss_d: 0.443602
0.8452 --- loss: 1.552923, loss_ss: 1.295069, loss_d: 0.257853
0.8836 --- loss: 1.689117, loss_ss: 1.428991, loss_d: 0.260125
0.9220 --- loss: 1.957511, loss_ss: 1.292263, loss_d: 0.665248
0.9604 --- loss: 1.888183, loss_ss: 1.349045, loss_d: 0.539138
0.9988 --- loss: 1.898725, loss_ss: 1.591394, loss_d: 0.307332
Epoch finished! Loss: 1.846030534689243
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.831928, loss_ss: 1.268806, loss_d: 0.563122
0.0384 --- loss: 2.440118, loss_ss: 1.395455, loss_d: 1.044664
0.0768 --- loss: 1.767933, loss_ss: 1.369077, loss_d: 0.398856
0.1153 --- loss: 1.974238, loss_ss: 1.244672, loss_d: 0.729566
0.1537 --- loss: 1.839395, loss_ss: 1.218510, loss_d: 0.620886
0.1921 --- loss: 1.608961, loss_ss: 1.249748, loss_d: 0.359213
0.2305 --- loss: 1.721086, loss_ss: 1.445003, loss_d: 0.276083
0.2689 --- loss: 1.442391, loss_ss: 1.076689, loss_d: 0.365702
0.3073 --- loss: 1.857777, loss_ss: 1.362963, loss_d: 0.494814
0.3458 --- loss: 2.302379, loss_ss: 1.523134, loss_d: 0.779245
0.3842 --- loss: 1.750319, loss_ss: 1.117671, loss_d: 0.632648
0.4226 --- loss: 1.363777, loss_ss: 1.071576, loss_d: 0.292200
0.4610 --- loss: 1.675641, loss_ss: 1.110183, loss_d: 0.565458
0.4994 --- loss: 1.820091, loss_ss: 1.421758, loss_d: 0.398332
0.5378 --- loss: 1.892374, loss_ss: 1.413830, loss_d: 0.478544
0.5763 --- loss: 1.462947, loss_ss: 1.050403, loss_d: 0.412544
0.6147 --- loss: 2.488810, loss_ss: 1.346112, loss_d: 1.142698
0.6531 --- loss: 1.716763, loss_ss: 1.220561, loss_d: 0.496202
0.6915 --- loss: 1.911174, loss_ss: 1.054018, loss_d: 0.857156
0.7299 --- loss: 1.588357, loss_ss: 1.135572, loss_d: 0.452785
0.7683 --- loss: 1.481241, loss_ss: 1.172810, loss_d: 0.308431
0.8068 --- loss: 1.883950, loss_ss: 1.410768, loss_d: 0.473181
0.8452 --- loss: 1.744080, loss_ss: 0.947322, loss_d: 0.796758
0.8836 --- loss: 1.505228, loss_ss: 1.119329, loss_d: 0.385900
0.9220 --- loss: 1.307515, loss_ss: 1.003282, loss_d: 0.304232
0.9604 --- loss: 1.305142, loss_ss: 1.007483, loss_d: 0.297660
0.9988 --- loss: 1.988104, loss_ss: 1.619404, loss_d: 0.368700
Epoch finished! Loss: 1.738937519146846
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.430328, loss_ss: 1.147781, loss_d: 0.282546
0.0384 --- loss: 1.296751, loss_ss: 0.898613, loss_d: 0.398137
0.0768 --- loss: 1.578412, loss_ss: 1.268971, loss_d: 0.309441
0.1153 --- loss: 1.357928, loss_ss: 1.056705, loss_d: 0.301222
0.1537 --- loss: 2.230296, loss_ss: 1.125644, loss_d: 1.104651
0.1921 --- loss: 2.197772, loss_ss: 1.702446, loss_d: 0.495326
0.2305 --- loss: 1.699223, loss_ss: 1.145959, loss_d: 0.553264
0.2689 --- loss: 1.862258, loss_ss: 1.256667, loss_d: 0.605591
0.3073 --- loss: 1.519242, loss_ss: 1.137563, loss_d: 0.381679
0.3458 --- loss: 1.485710, loss_ss: 1.202756, loss_d: 0.282954
0.3842 --- loss: 2.007218, loss_ss: 1.326730, loss_d: 0.680488
0.4226 --- loss: 1.441465, loss_ss: 1.226380, loss_d: 0.215085
0.4610 --- loss: 1.872205, loss_ss: 1.300467, loss_d: 0.571739
0.4994 --- loss: 1.447282, loss_ss: 1.109911, loss_d: 0.337371
0.5378 --- loss: 1.774110, loss_ss: 1.339298, loss_d: 0.434812
0.5763 --- loss: 1.580535, loss_ss: 1.263109, loss_d: 0.317426
0.6147 --- loss: 1.475588, loss_ss: 1.124124, loss_d: 0.351464
0.6531 --- loss: 1.616758, loss_ss: 1.217897, loss_d: 0.398860
0.6915 --- loss: 1.603915, loss_ss: 1.219703, loss_d: 0.384212
0.7299 --- loss: 1.559608, loss_ss: 1.267654, loss_d: 0.291954
0.7683 --- loss: 1.626567, loss_ss: 1.166577, loss_d: 0.459990
0.8068 --- loss: 1.598340, loss_ss: 1.052559, loss_d: 0.545780
0.8452 --- loss: 1.782981, loss_ss: 1.153783, loss_d: 0.629198
0.8836 --- loss: 1.436072, loss_ss: 0.972314, loss_d: 0.463758
0.9220 --- loss: 1.872001, loss_ss: 1.345516, loss_d: 0.526485
0.9604 --- loss: 1.783908, loss_ss: 1.212605, loss_d: 0.571303
0.9988 --- loss: 1.373722, loss_ss: 1.039479, loss_d: 0.334243
Epoch finished! Loss: 1.6896551274336302
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.377059, loss_ss: 0.988815, loss_d: 0.388245
0.0384 --- loss: 1.487570, loss_ss: 1.128087, loss_d: 0.359483
0.0768 --- loss: 1.374227, loss_ss: 1.084707, loss_d: 0.289520
0.1153 --- loss: 1.456751, loss_ss: 0.968187, loss_d: 0.488564
0.1537 --- loss: 1.899026, loss_ss: 1.386732, loss_d: 0.512294
0.1921 --- loss: 1.604671, loss_ss: 1.181015, loss_d: 0.423656
0.2305 --- loss: 1.352774, loss_ss: 0.896043, loss_d: 0.456730
0.2689 --- loss: 1.655886, loss_ss: 0.978284, loss_d: 0.677602
0.3073 --- loss: 1.471388, loss_ss: 1.059091, loss_d: 0.412297
0.3458 --- loss: 1.468533, loss_ss: 1.215387, loss_d: 0.253147
0.3842 --- loss: 1.790580, loss_ss: 1.440539, loss_d: 0.350041
0.4226 --- loss: 1.989898, loss_ss: 1.231253, loss_d: 0.758646
0.4610 --- loss: 1.827085, loss_ss: 1.255599, loss_d: 0.571485
0.4994 --- loss: 1.385322, loss_ss: 1.013994, loss_d: 0.371327
0.5378 --- loss: 2.087611, loss_ss: 1.086995, loss_d: 1.000616
0.5763 --- loss: 1.824581, loss_ss: 1.314673, loss_d: 0.509908
0.6147 --- loss: 1.976053, loss_ss: 1.556240, loss_d: 0.419813
0.6531 --- loss: 1.604171, loss_ss: 1.126966, loss_d: 0.477205
0.6915 --- loss: 1.827211, loss_ss: 1.251502, loss_d: 0.575709
0.7299 --- loss: 1.218490, loss_ss: 0.888185, loss_d: 0.330305
0.7683 --- loss: 1.620005, loss_ss: 1.058880, loss_d: 0.561124
0.8068 --- loss: 1.882960, loss_ss: 1.228648, loss_d: 0.654312
0.8452 --- loss: 1.510999, loss_ss: 1.179786, loss_d: 0.331213
0.8836 --- loss: 1.930993, loss_ss: 1.285267, loss_d: 0.645726
0.9220 --- loss: 1.812043, loss_ss: 1.285264, loss_d: 0.526779
0.9604 --- loss: 1.723463, loss_ss: 1.263875, loss_d: 0.459588
0.9988 --- loss: 1.941461, loss_ss: 1.095171, loss_d: 0.846290
Epoch finished! Loss: 1.6533556883151714
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.065243, loss_ss: 1.170466, loss_d: 0.894777
0.0384 --- loss: 1.394675, loss_ss: 1.071555, loss_d: 0.323119
0.0768 --- loss: 1.788891, loss_ss: 1.380821, loss_d: 0.408070
0.1153 --- loss: 1.469031, loss_ss: 0.989502, loss_d: 0.479529
0.1537 --- loss: 1.714458, loss_ss: 1.017806, loss_d: 0.696653
0.1921 --- loss: 1.490005, loss_ss: 1.058064, loss_d: 0.431942
0.2305 --- loss: 1.411566, loss_ss: 0.926965, loss_d: 0.484601
0.2689 --- loss: 1.779817, loss_ss: 0.971561, loss_d: 0.808256
0.3073 --- loss: 1.531973, loss_ss: 1.117707, loss_d: 0.414266
0.3458 --- loss: 1.936063, loss_ss: 1.289497, loss_d: 0.646565
0.3842 --- loss: 1.533381, loss_ss: 0.899301, loss_d: 0.634080
0.4226 --- loss: 1.536714, loss_ss: 1.157114, loss_d: 0.379600
0.4610 --- loss: 1.594404, loss_ss: 1.186206, loss_d: 0.408198
0.4994 --- loss: 1.664977, loss_ss: 1.331774, loss_d: 0.333204
0.5378 --- loss: 1.330962, loss_ss: 1.093502, loss_d: 0.237460
0.5763 --- loss: 1.420377, loss_ss: 1.111815, loss_d: 0.308562
0.6147 --- loss: 1.838026, loss_ss: 1.183615, loss_d: 0.654411
0.6531 --- loss: 1.747380, loss_ss: 1.245764, loss_d: 0.501615
0.6915 --- loss: 1.889623, loss_ss: 1.464629, loss_d: 0.424994
0.7299 --- loss: 1.397035, loss_ss: 0.991278, loss_d: 0.405756
0.7683 --- loss: 1.518431, loss_ss: 1.139022, loss_d: 0.379410
0.8068 --- loss: 1.771600, loss_ss: 1.144755, loss_d: 0.626845
0.8452 --- loss: 2.034043, loss_ss: 1.096897, loss_d: 0.937147
0.8836 --- loss: 1.319127, loss_ss: 0.930373, loss_d: 0.388754
0.9220 --- loss: 1.908163, loss_ss: 1.106337, loss_d: 0.801827
0.9604 --- loss: 1.658365, loss_ss: 1.286984, loss_d: 0.371380
0.9988 --- loss: 1.218158, loss_ss: 0.912536, loss_d: 0.305622
Epoch finished! Loss: 1.6041578833873456
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.789546, loss_ss: 0.985905, loss_d: 0.803641
0.0384 --- loss: 1.322138, loss_ss: 1.041897, loss_d: 0.280241
0.0768 --- loss: 1.315995, loss_ss: 1.053446, loss_d: 0.262549
0.1153 --- loss: 1.462959, loss_ss: 1.163337, loss_d: 0.299621
0.1537 --- loss: 1.279616, loss_ss: 0.881296, loss_d: 0.398320
0.1921 --- loss: 1.621628, loss_ss: 1.230761, loss_d: 0.390867
0.2305 --- loss: 1.267182, loss_ss: 0.945640, loss_d: 0.321542
0.2689 --- loss: 1.168155, loss_ss: 0.863366, loss_d: 0.304789
0.3073 --- loss: 1.301558, loss_ss: 0.903983, loss_d: 0.397575
0.3458 --- loss: 1.582319, loss_ss: 1.109974, loss_d: 0.472345
0.3842 --- loss: 1.450982, loss_ss: 1.060286, loss_d: 0.390696
0.4226 --- loss: 1.466615, loss_ss: 0.997895, loss_d: 0.468720
0.4610 --- loss: 2.581513, loss_ss: 1.002216, loss_d: 1.579297
0.4994 --- loss: 1.819520, loss_ss: 1.290014, loss_d: 0.529506
0.5378 --- loss: 1.271297, loss_ss: 0.988347, loss_d: 0.282950
0.5763 --- loss: 1.715458, loss_ss: 1.107547, loss_d: 0.607911
0.6147 --- loss: 2.046476, loss_ss: 1.338759, loss_d: 0.707717
0.6531 --- loss: 1.683379, loss_ss: 1.282861, loss_d: 0.400517
0.6915 --- loss: 1.311802, loss_ss: 1.112792, loss_d: 0.199010
0.7299 --- loss: 1.014802, loss_ss: 0.752410, loss_d: 0.262392
0.7683 --- loss: 1.620122, loss_ss: 1.033827, loss_d: 0.586294
0.8068 --- loss: 1.984348, loss_ss: 1.207342, loss_d: 0.777006
0.8452 --- loss: 1.459648, loss_ss: 1.146952, loss_d: 0.312697
0.8836 --- loss: 1.573729, loss_ss: 1.302225, loss_d: 0.271504
0.9220 --- loss: 1.554942, loss_ss: 1.175370, loss_d: 0.379572
0.9604 --- loss: 1.511778, loss_ss: 1.033299, loss_d: 0.478479
0.9988 --- loss: 1.406480, loss_ss: 1.124118, loss_d: 0.282363
Epoch finished! Loss: 1.574198010793099
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.343479, loss_ss: 1.006298, loss_d: 0.337181
0.0384 --- loss: 1.497161, loss_ss: 0.952588, loss_d: 0.544573
0.0768 --- loss: 1.608395, loss_ss: 1.272570, loss_d: 0.335825
0.1153 --- loss: 1.368820, loss_ss: 1.022516, loss_d: 0.346304
0.1537 --- loss: 1.529275, loss_ss: 1.203710, loss_d: 0.325565
0.1921 --- loss: 1.571039, loss_ss: 1.305624, loss_d: 0.265415
0.2305 --- loss: 1.266916, loss_ss: 1.072806, loss_d: 0.194110
0.2689 --- loss: 1.186573, loss_ss: 0.993141, loss_d: 0.193432
0.3073 --- loss: 1.270830, loss_ss: 0.876834, loss_d: 0.393996
0.3458 --- loss: 1.405342, loss_ss: 0.919204, loss_d: 0.486138
0.3842 --- loss: 1.439592, loss_ss: 0.991258, loss_d: 0.448334
0.4226 --- loss: 1.550761, loss_ss: 0.923268, loss_d: 0.627493
0.4610 --- loss: 1.489356, loss_ss: 1.050645, loss_d: 0.438711
0.4994 --- loss: 1.627823, loss_ss: 1.264030, loss_d: 0.363793
0.5378 --- loss: 1.391390, loss_ss: 1.000986, loss_d: 0.390404
0.5763 --- loss: 1.639117, loss_ss: 1.047834, loss_d: 0.591283
0.6147 --- loss: 1.349973, loss_ss: 0.819700, loss_d: 0.530272
0.6531 --- loss: 1.608889, loss_ss: 1.280392, loss_d: 0.328496
0.6915 --- loss: 1.158529, loss_ss: 0.855185, loss_d: 0.303345
0.7299 --- loss: 1.416639, loss_ss: 0.943216, loss_d: 0.473423
0.7683 --- loss: 1.130205, loss_ss: 0.852408, loss_d: 0.277798
0.8068 --- loss: 1.499404, loss_ss: 1.000307, loss_d: 0.499097
0.8452 --- loss: 1.591658, loss_ss: 0.936786, loss_d: 0.654872
0.8836 --- loss: 1.517023, loss_ss: 1.206040, loss_d: 0.310984
0.9220 --- loss: 2.146360, loss_ss: 1.288779, loss_d: 0.857581
0.9604 --- loss: 1.370672, loss_ss: 1.080263, loss_d: 0.290408
0.9988 --- loss: 2.247102, loss_ss: 1.440775, loss_d: 0.806327
Epoch finished! Loss: 1.5446473190417656
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.382406, loss_ss: 1.131513, loss_d: 0.250894
0.0384 --- loss: 1.308709, loss_ss: 1.060003, loss_d: 0.248706
0.0768 --- loss: 1.400389, loss_ss: 0.877211, loss_d: 0.523178
0.1153 --- loss: 1.314164, loss_ss: 0.981100, loss_d: 0.333064
0.1537 --- loss: 1.356989, loss_ss: 1.076634, loss_d: 0.280355
0.1921 --- loss: 1.413055, loss_ss: 0.920308, loss_d: 0.492747
0.2305 --- loss: 1.149543, loss_ss: 0.835427, loss_d: 0.314115
0.2689 --- loss: 1.901076, loss_ss: 1.225830, loss_d: 0.675247
0.3073 --- loss: 1.382347, loss_ss: 1.190346, loss_d: 0.192001
0.3458 --- loss: 1.917429, loss_ss: 0.973750, loss_d: 0.943679
0.3842 --- loss: 1.768156, loss_ss: 1.226151, loss_d: 0.542005
0.4226 --- loss: 1.654114, loss_ss: 1.044923, loss_d: 0.609191
0.4610 --- loss: 1.290604, loss_ss: 0.934405, loss_d: 0.356200
0.4994 --- loss: 1.956112, loss_ss: 1.226352, loss_d: 0.729760
0.5378 --- loss: 1.238032, loss_ss: 0.798497, loss_d: 0.439535
0.5763 --- loss: 1.845951, loss_ss: 1.104711, loss_d: 0.741239
0.6147 --- loss: 2.056252, loss_ss: 1.356958, loss_d: 0.699294
0.6531 --- loss: 1.829620, loss_ss: 1.276679, loss_d: 0.552941
0.6915 --- loss: 1.543278, loss_ss: 1.004692, loss_d: 0.538587
0.7299 --- loss: 1.444221, loss_ss: 0.980471, loss_d: 0.463749
0.7683 --- loss: 1.365026, loss_ss: 0.825764, loss_d: 0.539261
0.8068 --- loss: 1.441516, loss_ss: 1.060250, loss_d: 0.381265
0.8452 --- loss: 1.236350, loss_ss: 0.947101, loss_d: 0.289249
0.8836 --- loss: 1.560171, loss_ss: 1.110693, loss_d: 0.449477
0.9220 --- loss: 1.767545, loss_ss: 1.175097, loss_d: 0.592448
0.9604 --- loss: 1.301744, loss_ss: 0.761973, loss_d: 0.539772
0.9988 --- loss: 1.737850, loss_ss: 1.405461, loss_d: 0.332389
Epoch finished! Loss: 1.5464786731279814
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.700952380952381
             precision    recall  f1-score   support

        0.0       0.40      0.27      0.32        74
        1.0       0.00      0.00      0.00        42
        2.0       0.69      0.91      0.78       515
        3.0       0.81      0.81      0.81       243
        4.0       0.68      0.30      0.41       176

avg / total       0.67      0.70      0.66      1050
 


====== chc004-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  92.00  27.03   96.93  40.00     32.26
1  96.00   0.00  100.00   0.00      0.00
2  75.05  90.87   59.81  68.52     78.13
3  91.24  80.66   94.42  81.33     80.99
4  85.90  29.55   97.25  68.42     41.27
Total accuracy: 70.10%
Average sen: 45.62%
Average spec: 89.68%
Macro f1-score: 46.53%
[0.99955982 0.99897408 0.99594635 0.99250507 0.99023646 0.98407876
 0.98867935 0.98545372 0.99096984 0.99397624 0.9929629  0.99289787
 0.99456316 0.9909634  0.99335772 0.99086225 0.9922691  0.99155301
 0.99813408 0.9972108  0.98937255 0.99253935 0.99116325 0.99570125
 0.99340677 0.99225193 0.99894458 0.99284345 0.99176019 0.99247181
 0.99308962 0.99447507 0.99008662 0.99941623 0.99959999]
pred: 0.993207904270717, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.368872, loss_ss: 1.647139, loss_d: 0.721733
0.0384 --- loss: 2.221514, loss_ss: 1.566865, loss_d: 0.654649
0.0767 --- loss: 2.046447, loss_ss: 1.562966, loss_d: 0.483481
0.1151 --- loss: 2.208132, loss_ss: 1.645397, loss_d: 0.562735
0.1534 --- loss: 2.271527, loss_ss: 1.559279, loss_d: 0.712248
0.1918 --- loss: 1.797421, loss_ss: 1.443166, loss_d: 0.354255
0.2301 --- loss: 2.259430, loss_ss: 1.588727, loss_d: 0.670703
0.2685 --- loss: 1.927507, loss_ss: 1.479704, loss_d: 0.447803
0.3069 --- loss: 1.958422, loss_ss: 1.568022, loss_d: 0.390400
0.3452 --- loss: 1.721106, loss_ss: 1.482892, loss_d: 0.238214
0.3836 --- loss: 1.844850, loss_ss: 1.518307, loss_d: 0.326544
0.4219 --- loss: 2.124053, loss_ss: 1.588224, loss_d: 0.535829
0.4603 --- loss: 2.106591, loss_ss: 1.499084, loss_d: 0.607507
0.4987 --- loss: 2.411805, loss_ss: 1.538080, loss_d: 0.873725
0.5370 --- loss: 2.112948, loss_ss: 1.527468, loss_d: 0.585480
0.5754 --- loss: 2.351149, loss_ss: 1.613273, loss_d: 0.737875
0.6137 --- loss: 1.970315, loss_ss: 1.457465, loss_d: 0.512849
0.6521 --- loss: 1.913235, loss_ss: 1.453029, loss_d: 0.460206
0.6904 --- loss: 1.872030, loss_ss: 1.445337, loss_d: 0.426693
0.7288 --- loss: 1.863830, loss_ss: 1.529311, loss_d: 0.334519
0.7672 --- loss: 1.800868, loss_ss: 1.507828, loss_d: 0.293039
0.8055 --- loss: 2.097991, loss_ss: 1.518683, loss_d: 0.579308
0.8439 --- loss: 1.908330, loss_ss: 1.314656, loss_d: 0.593674
0.8822 --- loss: 1.987136, loss_ss: 1.444874, loss_d: 0.542262
0.9206 --- loss: 1.951679, loss_ss: 1.398170, loss_d: 0.553509
0.9590 --- loss: 2.100979, loss_ss: 1.675391, loss_d: 0.425589
0.9973 --- loss: 2.092880, loss_ss: 1.536785, loss_d: 0.556095
Epoch finished! Loss: 2.079902106982011
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.014003, loss_ss: 1.537548, loss_d: 0.476455
0.0384 --- loss: 1.889525, loss_ss: 1.514521, loss_d: 0.375004
0.0767 --- loss: 1.724085, loss_ss: 1.285707, loss_d: 0.438379
0.1151 --- loss: 2.381838, loss_ss: 1.347419, loss_d: 1.034419
0.1534 --- loss: 1.994620, loss_ss: 1.452393, loss_d: 0.542227
0.1918 --- loss: 2.098041, loss_ss: 1.389181, loss_d: 0.708859
0.2301 --- loss: 1.944903, loss_ss: 1.513195, loss_d: 0.431707
0.2685 --- loss: 2.176236, loss_ss: 1.543614, loss_d: 0.632622
0.3069 --- loss: 1.657553, loss_ss: 1.283565, loss_d: 0.373988
0.3452 --- loss: 2.001293, loss_ss: 1.686091, loss_d: 0.315202
0.3836 --- loss: 2.512323, loss_ss: 1.335359, loss_d: 1.176963
0.4219 --- loss: 1.852568, loss_ss: 1.445201, loss_d: 0.407367
0.4603 --- loss: 2.113973, loss_ss: 1.530488, loss_d: 0.583485
0.4987 --- loss: 1.998811, loss_ss: 1.409507, loss_d: 0.589304
0.5370 --- loss: 2.110638, loss_ss: 1.657834, loss_d: 0.452804
0.5754 --- loss: 2.059672, loss_ss: 1.554379, loss_d: 0.505293
0.6137 --- loss: 2.452488, loss_ss: 1.467089, loss_d: 0.985399
0.6521 --- loss: 1.978100, loss_ss: 1.604428, loss_d: 0.373672
0.6904 --- loss: 2.051569, loss_ss: 1.512077, loss_d: 0.539493
0.7288 --- loss: 2.081862, loss_ss: 1.421436, loss_d: 0.660426
0.7672 --- loss: 1.864689, loss_ss: 1.365710, loss_d: 0.498978
0.8055 --- loss: 1.841404, loss_ss: 1.341223, loss_d: 0.500181
0.8439 --- loss: 1.857206, loss_ss: 1.287104, loss_d: 0.570102
0.8822 --- loss: 1.636168, loss_ss: 1.151936, loss_d: 0.484232
0.9206 --- loss: 1.833950, loss_ss: 1.415291, loss_d: 0.418659
0.9590 --- loss: 1.951291, loss_ss: 1.493847, loss_d: 0.457444
0.9973 --- loss: 1.637978, loss_ss: 1.287474, loss_d: 0.350504
Epoch finished! Loss: 1.9543794613618117
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.898436, loss_ss: 1.484695, loss_d: 0.413741
0.0384 --- loss: 1.617315, loss_ss: 1.297489, loss_d: 0.319826
0.0767 --- loss: 2.725905, loss_ss: 1.360263, loss_d: 1.365642
0.1151 --- loss: 1.892596, loss_ss: 1.306874, loss_d: 0.585722
0.1534 --- loss: 1.965979, loss_ss: 1.503041, loss_d: 0.462938
0.1918 --- loss: 1.817567, loss_ss: 1.499004, loss_d: 0.318564
0.2301 --- loss: 2.079361, loss_ss: 1.302209, loss_d: 0.777152
0.2685 --- loss: 1.574345, loss_ss: 1.243423, loss_d: 0.330923
0.3069 --- loss: 1.832406, loss_ss: 1.386788, loss_d: 0.445618
0.3452 --- loss: 1.854790, loss_ss: 1.405895, loss_d: 0.448895
0.3836 --- loss: 2.211820, loss_ss: 1.532885, loss_d: 0.678935
0.4219 --- loss: 1.923581, loss_ss: 1.137771, loss_d: 0.785809
0.4603 --- loss: 2.039837, loss_ss: 1.198210, loss_d: 0.841627
0.4987 --- loss: 1.864243, loss_ss: 1.412828, loss_d: 0.451415
0.5370 --- loss: 1.818941, loss_ss: 1.407011, loss_d: 0.411930
0.5754 --- loss: 1.525690, loss_ss: 1.165054, loss_d: 0.360636
0.6137 --- loss: 1.523489, loss_ss: 1.203153, loss_d: 0.320335
0.6521 --- loss: 1.572469, loss_ss: 1.127990, loss_d: 0.444479
0.6904 --- loss: 1.461010, loss_ss: 1.153988, loss_d: 0.307022
0.7288 --- loss: 1.647414, loss_ss: 1.302500, loss_d: 0.344913
0.7672 --- loss: 1.580008, loss_ss: 1.280326, loss_d: 0.299682
0.8055 --- loss: 2.289757, loss_ss: 1.368761, loss_d: 0.920997
0.8439 --- loss: 1.654562, loss_ss: 1.259751, loss_d: 0.394811
0.8822 --- loss: 2.190110, loss_ss: 1.706080, loss_d: 0.484031
0.9206 --- loss: 1.509943, loss_ss: 1.109926, loss_d: 0.400017
0.9590 --- loss: 1.548090, loss_ss: 1.223521, loss_d: 0.324569
0.9973 --- loss: 1.646808, loss_ss: 1.243255, loss_d: 0.403553
Epoch finished! Loss: 1.8184271431886232
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.747225, loss_ss: 1.190181, loss_d: 0.557044
0.0384 --- loss: 1.627816, loss_ss: 1.068093, loss_d: 0.559724
0.0767 --- loss: 1.719882, loss_ss: 1.311059, loss_d: 0.408823
0.1151 --- loss: 1.561734, loss_ss: 1.213438, loss_d: 0.348296
0.1534 --- loss: 1.767096, loss_ss: 1.247325, loss_d: 0.519770
0.1918 --- loss: 1.625434, loss_ss: 1.214758, loss_d: 0.410676
0.2301 --- loss: 1.829455, loss_ss: 1.371464, loss_d: 0.457991
0.2685 --- loss: 1.614326, loss_ss: 1.094683, loss_d: 0.519644
0.3069 --- loss: 1.485662, loss_ss: 1.100554, loss_d: 0.385108
0.3452 --- loss: 1.490660, loss_ss: 1.107673, loss_d: 0.382987
0.3836 --- loss: 1.512775, loss_ss: 1.189949, loss_d: 0.322826
0.4219 --- loss: 1.493048, loss_ss: 1.175949, loss_d: 0.317099
0.4603 --- loss: 1.662741, loss_ss: 1.230630, loss_d: 0.432111
0.4987 --- loss: 1.768384, loss_ss: 1.269369, loss_d: 0.499015
0.5370 --- loss: 1.639742, loss_ss: 0.956120, loss_d: 0.683622
0.5754 --- loss: 1.626907, loss_ss: 1.275418, loss_d: 0.351489
0.6137 --- loss: 1.567184, loss_ss: 0.986357, loss_d: 0.580827
0.6521 --- loss: 2.064754, loss_ss: 1.554483, loss_d: 0.510272
0.6904 --- loss: 1.731546, loss_ss: 1.242327, loss_d: 0.489219
0.7288 --- loss: 1.426097, loss_ss: 1.093994, loss_d: 0.332103
0.7672 --- loss: 1.319573, loss_ss: 0.937354, loss_d: 0.382219
0.8055 --- loss: 1.422679, loss_ss: 1.097052, loss_d: 0.325627
0.8439 --- loss: 1.511676, loss_ss: 0.965168, loss_d: 0.546508
0.8822 --- loss: 1.525088, loss_ss: 1.115981, loss_d: 0.409107
0.9206 --- loss: 1.465160, loss_ss: 1.133126, loss_d: 0.332034
0.9590 --- loss: 1.742047, loss_ss: 1.171674, loss_d: 0.570373
0.9973 --- loss: 2.216296, loss_ss: 1.233252, loss_d: 0.983045
Epoch finished! Loss: 1.6810369945489443
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.022445, loss_ss: 1.348860, loss_d: 0.673586
0.0384 --- loss: 1.611691, loss_ss: 1.069635, loss_d: 0.542055
0.0767 --- loss: 1.588060, loss_ss: 1.143077, loss_d: 0.444983
0.1151 --- loss: 1.727132, loss_ss: 1.122015, loss_d: 0.605117
0.1534 --- loss: 1.605401, loss_ss: 1.225219, loss_d: 0.380181
0.1918 --- loss: 2.729918, loss_ss: 1.222682, loss_d: 1.507237
0.2301 --- loss: 1.710134, loss_ss: 1.267609, loss_d: 0.442525
0.2685 --- loss: 1.788615, loss_ss: 1.274496, loss_d: 0.514119
0.3069 --- loss: 1.845045, loss_ss: 1.233021, loss_d: 0.612024
0.3452 --- loss: 1.736223, loss_ss: 1.242363, loss_d: 0.493860
0.3836 --- loss: 1.961699, loss_ss: 1.336172, loss_d: 0.625528
0.4219 --- loss: 1.972928, loss_ss: 1.299250, loss_d: 0.673678
0.4603 --- loss: 1.877204, loss_ss: 1.322258, loss_d: 0.554946
0.4987 --- loss: 1.792397, loss_ss: 1.534508, loss_d: 0.257889
0.5370 --- loss: 1.156911, loss_ss: 0.933059, loss_d: 0.223852
0.5754 --- loss: 1.437063, loss_ss: 0.997866, loss_d: 0.439196
0.6137 --- loss: 1.651195, loss_ss: 1.161469, loss_d: 0.489726
0.6521 --- loss: 1.611587, loss_ss: 1.125258, loss_d: 0.486329
0.6904 --- loss: 1.733522, loss_ss: 1.299674, loss_d: 0.433848
0.7288 --- loss: 2.275543, loss_ss: 1.394599, loss_d: 0.880944
0.7672 --- loss: 1.587204, loss_ss: 1.303869, loss_d: 0.283334
0.8055 --- loss: 2.035065, loss_ss: 1.182420, loss_d: 0.852644
0.8439 --- loss: 1.971628, loss_ss: 1.533135, loss_d: 0.438493
0.8822 --- loss: 1.600801, loss_ss: 0.963531, loss_d: 0.637269
0.9206 --- loss: 1.937718, loss_ss: 1.306043, loss_d: 0.631676
0.9590 --- loss: 1.257556, loss_ss: 0.925664, loss_d: 0.331892
0.9973 --- loss: 1.291444, loss_ss: 0.813100, loss_d: 0.478344
Epoch finished! Loss: 1.6347737199985064
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.713383, loss_ss: 1.138446, loss_d: 0.574937
0.0384 --- loss: 1.667377, loss_ss: 1.209139, loss_d: 0.458237
0.0767 --- loss: 1.424462, loss_ss: 1.048977, loss_d: 0.375485
0.1151 --- loss: 1.526994, loss_ss: 1.045499, loss_d: 0.481495
0.1534 --- loss: 1.640705, loss_ss: 1.230973, loss_d: 0.409732
0.1918 --- loss: 1.227220, loss_ss: 0.856809, loss_d: 0.370411
0.2301 --- loss: 1.392281, loss_ss: 1.027352, loss_d: 0.364929
0.2685 --- loss: 1.303893, loss_ss: 0.933814, loss_d: 0.370079
0.3069 --- loss: 1.588123, loss_ss: 1.100577, loss_d: 0.487546
0.3452 --- loss: 1.779187, loss_ss: 1.150533, loss_d: 0.628654
0.3836 --- loss: 1.478092, loss_ss: 1.058294, loss_d: 0.419799
0.4219 --- loss: 1.558123, loss_ss: 1.249504, loss_d: 0.308620
0.4603 --- loss: 1.504165, loss_ss: 0.862688, loss_d: 0.641477
0.4987 --- loss: 1.898048, loss_ss: 1.331874, loss_d: 0.566175
0.5370 --- loss: 1.652559, loss_ss: 1.082896, loss_d: 0.569663
0.5754 --- loss: 1.924435, loss_ss: 1.339107, loss_d: 0.585328
0.6137 --- loss: 1.557999, loss_ss: 0.955098, loss_d: 0.602902
0.6521 --- loss: 1.709766, loss_ss: 1.236005, loss_d: 0.473761
0.6904 --- loss: 1.560295, loss_ss: 0.902219, loss_d: 0.658076
0.7288 --- loss: 1.501724, loss_ss: 0.933404, loss_d: 0.568320
0.7672 --- loss: 1.346846, loss_ss: 0.989246, loss_d: 0.357601
0.8055 --- loss: 1.463900, loss_ss: 0.978171, loss_d: 0.485729
0.8439 --- loss: 1.807073, loss_ss: 1.308679, loss_d: 0.498393
0.8822 --- loss: 1.477453, loss_ss: 1.005841, loss_d: 0.471612
0.9206 --- loss: 1.592568, loss_ss: 1.074467, loss_d: 0.518100
0.9590 --- loss: 1.496062, loss_ss: 1.087926, loss_d: 0.408136
0.9973 --- loss: 1.940474, loss_ss: 1.467312, loss_d: 0.473162
Epoch finished! Loss: 1.5906593767496255
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.577882, loss_ss: 1.204223, loss_d: 0.373660
0.0384 --- loss: 1.161738, loss_ss: 0.764475, loss_d: 0.397263
0.0767 --- loss: 1.522511, loss_ss: 0.983388, loss_d: 0.539123
0.1151 --- loss: 1.186841, loss_ss: 0.842936, loss_d: 0.343905
0.1534 --- loss: 1.102555, loss_ss: 0.763188, loss_d: 0.339367
0.1918 --- loss: 1.333080, loss_ss: 1.034580, loss_d: 0.298500
0.2301 --- loss: 1.421380, loss_ss: 1.081400, loss_d: 0.339980
0.2685 --- loss: 1.730796, loss_ss: 0.979211, loss_d: 0.751585
0.3069 --- loss: 2.105641, loss_ss: 1.566285, loss_d: 0.539356
0.3452 --- loss: 1.836818, loss_ss: 1.203531, loss_d: 0.633286
0.3836 --- loss: 1.529698, loss_ss: 1.083981, loss_d: 0.445717
0.4219 --- loss: 1.305997, loss_ss: 0.833367, loss_d: 0.472630
0.4603 --- loss: 1.242859, loss_ss: 0.936219, loss_d: 0.306640
0.4987 --- loss: 1.262057, loss_ss: 0.965945, loss_d: 0.296112
0.5370 --- loss: 1.819192, loss_ss: 1.363606, loss_d: 0.455586
0.5754 --- loss: 1.479179, loss_ss: 1.200918, loss_d: 0.278261
0.6137 --- loss: 1.732805, loss_ss: 1.152475, loss_d: 0.580331
0.6521 --- loss: 2.060286, loss_ss: 1.382775, loss_d: 0.677511
0.6904 --- loss: 1.635240, loss_ss: 1.114892, loss_d: 0.520348
0.7288 --- loss: 1.749395, loss_ss: 1.333789, loss_d: 0.415606
0.7672 --- loss: 1.616269, loss_ss: 1.284034, loss_d: 0.332235
0.8055 --- loss: 1.794586, loss_ss: 1.258839, loss_d: 0.535748
0.8439 --- loss: 1.418624, loss_ss: 1.065172, loss_d: 0.353452
0.8822 --- loss: 1.575562, loss_ss: 1.383351, loss_d: 0.192211
0.9206 --- loss: 1.122414, loss_ss: 0.838493, loss_d: 0.283922
0.9590 --- loss: 1.547264, loss_ss: 1.024303, loss_d: 0.522961
0.9973 --- loss: 1.383764, loss_ss: 0.991487, loss_d: 0.392276
Epoch finished! Loss: 1.5631093135246863
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.466101, loss_ss: 1.187254, loss_d: 0.278847
0.0384 --- loss: 1.247357, loss_ss: 0.969248, loss_d: 0.278109
0.0767 --- loss: 1.675056, loss_ss: 1.229693, loss_d: 0.445364
0.1151 --- loss: 1.468782, loss_ss: 1.031782, loss_d: 0.437000
0.1534 --- loss: 1.623676, loss_ss: 1.373735, loss_d: 0.249942
0.1918 --- loss: 1.605627, loss_ss: 1.217382, loss_d: 0.388245
0.2301 --- loss: 1.310515, loss_ss: 0.921223, loss_d: 0.389292
0.2685 --- loss: 1.450764, loss_ss: 1.160391, loss_d: 0.290373
0.3069 --- loss: 1.254229, loss_ss: 0.807029, loss_d: 0.447200
0.3452 --- loss: 1.495998, loss_ss: 1.184530, loss_d: 0.311469
0.3836 --- loss: 1.487911, loss_ss: 0.829593, loss_d: 0.658318
0.4219 --- loss: 1.399965, loss_ss: 1.073760, loss_d: 0.326205
0.4603 --- loss: 1.718851, loss_ss: 0.861596, loss_d: 0.857255
0.4987 --- loss: 1.524281, loss_ss: 1.084232, loss_d: 0.440049
0.5370 --- loss: 1.539173, loss_ss: 1.191326, loss_d: 0.347847
0.5754 --- loss: 1.519381, loss_ss: 0.943224, loss_d: 0.576157
0.6137 --- loss: 1.589304, loss_ss: 0.923183, loss_d: 0.666122
0.6521 --- loss: 1.484802, loss_ss: 0.987178, loss_d: 0.497623
0.6904 --- loss: 1.444958, loss_ss: 1.101891, loss_d: 0.343067
0.7288 --- loss: 1.378817, loss_ss: 1.071083, loss_d: 0.307733
0.7672 --- loss: 1.389406, loss_ss: 0.881836, loss_d: 0.507570
0.8055 --- loss: 1.737710, loss_ss: 1.109181, loss_d: 0.628529
0.8439 --- loss: 1.582801, loss_ss: 1.092891, loss_d: 0.489910
0.8822 --- loss: 1.453789, loss_ss: 1.101343, loss_d: 0.352445
0.9206 --- loss: 1.612806, loss_ss: 1.247862, loss_d: 0.364944
0.9590 --- loss: 1.847255, loss_ss: 0.957158, loss_d: 0.890097
0.9973 --- loss: 1.501267, loss_ss: 1.096190, loss_d: 0.405077
Epoch finished! Loss: 1.5278383864806249
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.742406, loss_ss: 1.483765, loss_d: 0.258641
0.0384 --- loss: 1.702426, loss_ss: 1.141739, loss_d: 0.560687
0.0767 --- loss: 1.276105, loss_ss: 0.876693, loss_d: 0.399412
0.1151 --- loss: 1.666183, loss_ss: 1.316068, loss_d: 0.350114
0.1534 --- loss: 1.277668, loss_ss: 1.025571, loss_d: 0.252097
0.1918 --- loss: 1.291664, loss_ss: 0.995652, loss_d: 0.296012
0.2301 --- loss: 1.271841, loss_ss: 0.961367, loss_d: 0.310474
0.2685 --- loss: 1.357918, loss_ss: 0.836024, loss_d: 0.521894
0.3069 --- loss: 1.895562, loss_ss: 1.431160, loss_d: 0.464402
0.3452 --- loss: 2.744518, loss_ss: 1.441305, loss_d: 1.303213
0.3836 --- loss: 1.857631, loss_ss: 1.230835, loss_d: 0.626796
0.4219 --- loss: 1.557236, loss_ss: 0.854225, loss_d: 0.703011
0.4603 --- loss: 1.244891, loss_ss: 0.879180, loss_d: 0.365712
0.4987 --- loss: 1.533019, loss_ss: 1.193308, loss_d: 0.339711
0.5370 --- loss: 1.659309, loss_ss: 1.278957, loss_d: 0.380352
0.5754 --- loss: 1.307743, loss_ss: 0.849755, loss_d: 0.457988
0.6137 --- loss: 1.534706, loss_ss: 0.931484, loss_d: 0.603222
0.6521 --- loss: 1.499042, loss_ss: 0.918254, loss_d: 0.580789
0.6904 --- loss: 1.667718, loss_ss: 1.039661, loss_d: 0.628057
0.7288 --- loss: 1.671259, loss_ss: 0.931202, loss_d: 0.740057
0.7672 --- loss: 1.882169, loss_ss: 1.281146, loss_d: 0.601023
0.8055 --- loss: 1.717245, loss_ss: 1.163828, loss_d: 0.553418
0.8439 --- loss: 2.003932, loss_ss: 1.581176, loss_d: 0.422756
0.8822 --- loss: 1.710292, loss_ss: 1.212368, loss_d: 0.497924
0.9206 --- loss: 1.582521, loss_ss: 1.008264, loss_d: 0.574257
0.9590 --- loss: 1.440225, loss_ss: 0.938402, loss_d: 0.501823
0.9973 --- loss: 1.495870, loss_ss: 1.074038, loss_d: 0.421832
Epoch finished! Loss: 1.524537054162759
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.475818, loss_ss: 0.938973, loss_d: 0.536845
0.0384 --- loss: 1.606691, loss_ss: 1.051265, loss_d: 0.555426
0.0767 --- loss: 1.735850, loss_ss: 1.332482, loss_d: 0.403369
0.1151 --- loss: 1.450644, loss_ss: 1.073215, loss_d: 0.377429
0.1534 --- loss: 1.451880, loss_ss: 1.137597, loss_d: 0.314283
0.1918 --- loss: 1.182920, loss_ss: 0.840692, loss_d: 0.342228
0.2301 --- loss: 1.248093, loss_ss: 0.950570, loss_d: 0.297524
0.2685 --- loss: 1.393475, loss_ss: 0.992973, loss_d: 0.400501
0.3069 --- loss: 1.520125, loss_ss: 1.098531, loss_d: 0.421595
0.3452 --- loss: 1.080560, loss_ss: 0.857843, loss_d: 0.222718
0.3836 --- loss: 1.132327, loss_ss: 0.878773, loss_d: 0.253554
0.4219 --- loss: 1.450164, loss_ss: 0.987823, loss_d: 0.462340
0.4603 --- loss: 1.239080, loss_ss: 0.753945, loss_d: 0.485135
0.4987 --- loss: 1.590269, loss_ss: 0.880660, loss_d: 0.709609
0.5370 --- loss: 1.514615, loss_ss: 1.075797, loss_d: 0.438818
0.5754 --- loss: 1.734285, loss_ss: 1.008846, loss_d: 0.725439
0.6137 --- loss: 1.469272, loss_ss: 1.183138, loss_d: 0.286134
0.6521 --- loss: 1.399881, loss_ss: 1.109245, loss_d: 0.290636
0.6904 --- loss: 1.538881, loss_ss: 1.110675, loss_d: 0.428206
0.7288 --- loss: 1.461885, loss_ss: 0.858254, loss_d: 0.603631
0.7672 --- loss: 1.668902, loss_ss: 1.193737, loss_d: 0.475165
0.8055 --- loss: 1.506620, loss_ss: 1.067842, loss_d: 0.438778
0.8439 --- loss: 2.182763, loss_ss: 1.038490, loss_d: 1.144273
0.8822 --- loss: 1.731617, loss_ss: 1.136221, loss_d: 0.595396
0.9206 --- loss: 2.016824, loss_ss: 1.240305, loss_d: 0.776519
0.9590 --- loss: 1.454293, loss_ss: 1.157495, loss_d: 0.296798
0.9973 --- loss: 1.422160, loss_ss: 0.973309, loss_d: 0.448851
Epoch finished! Loss: 1.5166723686915178
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7677419354838709
             precision    recall  f1-score   support

        0.0       0.20      0.10      0.13        41
        1.0       0.00      0.00      0.00        33
        2.0       0.82      0.92      0.87       530
        3.0       0.90      0.75      0.82       236
        4.0       0.38      0.51      0.44        90

avg / total       0.74      0.77      0.75       930
 


====== chc005-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.30   9.76   98.20  20.00     13.11
1  96.45   0.00  100.00   0.00      0.00
2  84.09  91.89   73.75  82.26     86.81
3  91.51  75.00   97.12  89.85     81.76
4  87.20  51.11   91.07  38.02     43.60
Total accuracy: 76.77%
Average sen: 45.55%
Average spec: 92.03%
Macro f1-score: 45.06%
[0.75274318 0.73476225 0.90024799 0.67521179 0.66224277 0.85191548
 0.78742659 0.88727939 0.66191429 0.64479524 0.86892647 0.84215939
 0.85766882 0.8059082  0.78279543 0.46816665 0.6376009  0.770311
 0.87811345 0.76473796 0.7219249  0.71366751 0.56720167 0.51117152
 0.61619675 0.83989167 0.90113014 0.72261119 0.58854568 0.60644299
 0.60071176]
pred: 0.7298200976464057, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.428308, loss_ss: 1.713386, loss_d: 0.714922
0.0383 --- loss: 2.042160, loss_ss: 1.505738, loss_d: 0.536423
0.0766 --- loss: 2.217192, loss_ss: 1.599075, loss_d: 0.618117
0.1149 --- loss: 1.913184, loss_ss: 1.490768, loss_d: 0.422416
0.1532 --- loss: 2.225293, loss_ss: 1.550994, loss_d: 0.674299
0.1915 --- loss: 1.852318, loss_ss: 1.557329, loss_d: 0.294988
0.2298 --- loss: 1.836930, loss_ss: 1.466581, loss_d: 0.370348
0.2681 --- loss: 1.894939, loss_ss: 1.531841, loss_d: 0.363098
0.3064 --- loss: 2.096365, loss_ss: 1.528981, loss_d: 0.567384
0.3447 --- loss: 1.949354, loss_ss: 1.508789, loss_d: 0.440565
0.3830 --- loss: 2.178227, loss_ss: 1.628778, loss_d: 0.549449
0.4213 --- loss: 2.356707, loss_ss: 1.608999, loss_d: 0.747707
0.4596 --- loss: 2.028956, loss_ss: 1.445070, loss_d: 0.583886
0.4979 --- loss: 1.886574, loss_ss: 1.435281, loss_d: 0.451293
0.5362 --- loss: 1.823114, loss_ss: 1.482360, loss_d: 0.340754
0.5745 --- loss: 1.993486, loss_ss: 1.656593, loss_d: 0.336893
0.6128 --- loss: 1.857782, loss_ss: 1.418306, loss_d: 0.439476
0.6511 --- loss: 1.957408, loss_ss: 1.526034, loss_d: 0.431374
0.6894 --- loss: 2.117522, loss_ss: 1.552233, loss_d: 0.565290
0.7277 --- loss: 2.022791, loss_ss: 1.656388, loss_d: 0.366403
0.7660 --- loss: 1.773771, loss_ss: 1.445112, loss_d: 0.328659
0.8043 --- loss: 2.050374, loss_ss: 1.758763, loss_d: 0.291611
0.8426 --- loss: 2.193568, loss_ss: 1.560460, loss_d: 0.633107
0.8809 --- loss: 2.274338, loss_ss: 1.602419, loss_d: 0.671919
0.9192 --- loss: 2.139263, loss_ss: 1.623712, loss_d: 0.515551
0.9575 --- loss: 1.743626, loss_ss: 1.369910, loss_d: 0.373716
0.9958 --- loss: 2.019195, loss_ss: 1.510979, loss_d: 0.508216
Epoch finished! Loss: 2.0823696207726137
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.969041, loss_ss: 1.470352, loss_d: 0.498689
0.0383 --- loss: 1.999394, loss_ss: 1.480992, loss_d: 0.518402
0.0766 --- loss: 1.980458, loss_ss: 1.277406, loss_d: 0.703052
0.1149 --- loss: 1.776435, loss_ss: 1.419051, loss_d: 0.357384
0.1532 --- loss: 2.211715, loss_ss: 1.497953, loss_d: 0.713761
0.1915 --- loss: 2.125981, loss_ss: 1.277616, loss_d: 0.848365
0.2298 --- loss: 1.971069, loss_ss: 1.527506, loss_d: 0.443564
0.2681 --- loss: 1.899677, loss_ss: 1.432607, loss_d: 0.467070
0.3064 --- loss: 1.813631, loss_ss: 1.519659, loss_d: 0.293971
0.3447 --- loss: 2.391409, loss_ss: 1.533239, loss_d: 0.858170
0.3830 --- loss: 1.858112, loss_ss: 1.406340, loss_d: 0.451772
0.4213 --- loss: 2.201035, loss_ss: 1.477911, loss_d: 0.723124
0.4596 --- loss: 2.341953, loss_ss: 1.676258, loss_d: 0.665694
0.4979 --- loss: 1.810180, loss_ss: 1.348582, loss_d: 0.461598
0.5362 --- loss: 1.990094, loss_ss: 1.400106, loss_d: 0.589987
0.5745 --- loss: 1.984611, loss_ss: 1.286195, loss_d: 0.698416
0.6128 --- loss: 1.905513, loss_ss: 1.468921, loss_d: 0.436592
0.6511 --- loss: 2.009961, loss_ss: 1.346437, loss_d: 0.663524
0.6894 --- loss: 1.822915, loss_ss: 1.410646, loss_d: 0.412268
0.7277 --- loss: 2.237286, loss_ss: 1.431058, loss_d: 0.806228
0.7660 --- loss: 2.126828, loss_ss: 1.324649, loss_d: 0.802179
0.8043 --- loss: 1.588345, loss_ss: 1.289935, loss_d: 0.298410
0.8426 --- loss: 2.154413, loss_ss: 1.537962, loss_d: 0.616451
0.8809 --- loss: 2.099427, loss_ss: 1.390512, loss_d: 0.708915
0.9192 --- loss: 1.996740, loss_ss: 1.495107, loss_d: 0.501633
0.9575 --- loss: 2.334834, loss_ss: 1.381240, loss_d: 0.953594
0.9958 --- loss: 2.066059, loss_ss: 1.500790, loss_d: 0.565270
Epoch finished! Loss: 2.0227869269491614
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.816978, loss_ss: 1.294898, loss_d: 0.522080
0.0383 --- loss: 1.915355, loss_ss: 1.437267, loss_d: 0.478088
0.0766 --- loss: 1.970756, loss_ss: 1.366447, loss_d: 0.604308
0.1149 --- loss: 2.038989, loss_ss: 1.546694, loss_d: 0.492296
0.1532 --- loss: 2.105370, loss_ss: 1.624307, loss_d: 0.481063
0.1915 --- loss: 2.042899, loss_ss: 1.673471, loss_d: 0.369429
0.2298 --- loss: 1.915994, loss_ss: 1.442773, loss_d: 0.473222
0.2681 --- loss: 2.010443, loss_ss: 1.416691, loss_d: 0.593753
0.3064 --- loss: 1.871819, loss_ss: 1.373495, loss_d: 0.498325
0.3447 --- loss: 1.726620, loss_ss: 1.408734, loss_d: 0.317886
0.3830 --- loss: 1.631673, loss_ss: 1.307747, loss_d: 0.323926
0.4213 --- loss: 2.201301, loss_ss: 1.533198, loss_d: 0.668103
0.4596 --- loss: 1.915861, loss_ss: 1.555720, loss_d: 0.360141
0.4979 --- loss: 1.894034, loss_ss: 1.386504, loss_d: 0.507530
0.5362 --- loss: 1.964879, loss_ss: 1.502287, loss_d: 0.462592
0.5745 --- loss: 1.656803, loss_ss: 1.264152, loss_d: 0.392651
0.6128 --- loss: 1.973306, loss_ss: 1.619173, loss_d: 0.354133
0.6511 --- loss: 2.232000, loss_ss: 1.489837, loss_d: 0.742163
0.6894 --- loss: 2.320987, loss_ss: 1.412612, loss_d: 0.908375
0.7277 --- loss: 1.856514, loss_ss: 1.460975, loss_d: 0.395540
0.7660 --- loss: 1.891057, loss_ss: 1.336947, loss_d: 0.554110
0.8043 --- loss: 2.517398, loss_ss: 1.431040, loss_d: 1.086359
0.8426 --- loss: 2.011436, loss_ss: 1.497492, loss_d: 0.513944
0.8809 --- loss: 2.128601, loss_ss: 1.558494, loss_d: 0.570106
0.9192 --- loss: 1.887232, loss_ss: 1.398433, loss_d: 0.488799
0.9575 --- loss: 1.813158, loss_ss: 1.383113, loss_d: 0.430045
0.9958 --- loss: 2.371052, loss_ss: 1.336944, loss_d: 1.034109
Epoch finished! Loss: 1.9858693957785536
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.766628, loss_ss: 1.413822, loss_d: 0.352806
0.0383 --- loss: 1.786218, loss_ss: 1.216579, loss_d: 0.569639
0.0766 --- loss: 1.951443, loss_ss: 1.432995, loss_d: 0.518448
0.1149 --- loss: 1.903613, loss_ss: 1.544730, loss_d: 0.358882
0.1532 --- loss: 2.220577, loss_ss: 1.437622, loss_d: 0.782955
0.1915 --- loss: 2.042067, loss_ss: 1.621607, loss_d: 0.420460
0.2298 --- loss: 1.895997, loss_ss: 1.546367, loss_d: 0.349630
0.2681 --- loss: 1.788805, loss_ss: 1.354239, loss_d: 0.434566
0.3064 --- loss: 1.594124, loss_ss: 1.275530, loss_d: 0.318594
0.3447 --- loss: 1.712223, loss_ss: 1.280668, loss_d: 0.431555
0.3830 --- loss: 1.947040, loss_ss: 1.419146, loss_d: 0.527894
0.4213 --- loss: 2.403647, loss_ss: 1.495884, loss_d: 0.907763
0.4596 --- loss: 1.801287, loss_ss: 1.400903, loss_d: 0.400383
0.4979 --- loss: 2.050099, loss_ss: 1.342821, loss_d: 0.707278
0.5362 --- loss: 2.095413, loss_ss: 1.370315, loss_d: 0.725098
0.5745 --- loss: 2.070369, loss_ss: 1.440967, loss_d: 0.629402
0.6128 --- loss: 2.691539, loss_ss: 1.366839, loss_d: 1.324700
0.6511 --- loss: 2.346739, loss_ss: 1.546244, loss_d: 0.800495
0.6894 --- loss: 1.953750, loss_ss: 1.395353, loss_d: 0.558397
0.7277 --- loss: 1.936572, loss_ss: 1.414640, loss_d: 0.521932
0.7660 --- loss: 2.093684, loss_ss: 1.657295, loss_d: 0.436389
0.8043 --- loss: 1.775414, loss_ss: 1.416417, loss_d: 0.358997
0.8426 --- loss: 2.127839, loss_ss: 1.333525, loss_d: 0.794314
0.8809 --- loss: 1.864538, loss_ss: 1.313393, loss_d: 0.551145
0.9192 --- loss: 1.921888, loss_ss: 1.289757, loss_d: 0.632132
0.9575 --- loss: 1.892706, loss_ss: 1.367737, loss_d: 0.524969
0.9958 --- loss: 2.721987, loss_ss: 1.332833, loss_d: 1.389154
Epoch finished! Loss: 1.9463149523826395
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.694322, loss_ss: 1.244932, loss_d: 0.449390
0.0383 --- loss: 1.861373, loss_ss: 1.267355, loss_d: 0.594018
0.0766 --- loss: 1.721401, loss_ss: 1.105506, loss_d: 0.615895
0.1149 --- loss: 2.119061, loss_ss: 1.356102, loss_d: 0.762959
0.1532 --- loss: 1.872227, loss_ss: 1.250760, loss_d: 0.621467
0.1915 --- loss: 2.516648, loss_ss: 1.399745, loss_d: 1.116902
0.2298 --- loss: 1.870460, loss_ss: 1.179801, loss_d: 0.690658
0.2681 --- loss: 1.674945, loss_ss: 1.186290, loss_d: 0.488655
0.3064 --- loss: 1.859804, loss_ss: 1.397207, loss_d: 0.462596
0.3447 --- loss: 1.923391, loss_ss: 1.528605, loss_d: 0.394785
0.3830 --- loss: 1.898891, loss_ss: 1.319815, loss_d: 0.579077
0.4213 --- loss: 1.804196, loss_ss: 1.423936, loss_d: 0.380259
0.4596 --- loss: 1.929168, loss_ss: 1.425322, loss_d: 0.503845
0.4979 --- loss: 1.742912, loss_ss: 1.320758, loss_d: 0.422154
0.5362 --- loss: 2.746794, loss_ss: 1.439035, loss_d: 1.307759
0.5745 --- loss: 1.750393, loss_ss: 1.179446, loss_d: 0.570947
0.6128 --- loss: 1.559304, loss_ss: 1.043796, loss_d: 0.515508
0.6511 --- loss: 1.796196, loss_ss: 1.350808, loss_d: 0.445388
0.6894 --- loss: 1.637595, loss_ss: 1.145335, loss_d: 0.492260
0.7277 --- loss: 2.215367, loss_ss: 1.360720, loss_d: 0.854647
0.7660 --- loss: 2.076627, loss_ss: 1.483291, loss_d: 0.593337
0.8043 --- loss: 1.808394, loss_ss: 1.355618, loss_d: 0.452776
0.8426 --- loss: 2.024529, loss_ss: 1.600704, loss_d: 0.423825
0.8809 --- loss: 1.907616, loss_ss: 1.537488, loss_d: 0.370128
0.9192 --- loss: 3.021922, loss_ss: 1.492120, loss_d: 1.529802
0.9575 --- loss: 1.529909, loss_ss: 1.290516, loss_d: 0.239393
0.9958 --- loss: 1.873123, loss_ss: 1.522020, loss_d: 0.351103
Epoch finished! Loss: 1.835275752791043
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.622330, loss_ss: 1.110519, loss_d: 0.511811
0.0383 --- loss: 1.681929, loss_ss: 1.360600, loss_d: 0.321328
0.0766 --- loss: 2.775944, loss_ss: 1.147831, loss_d: 1.628113
0.1149 --- loss: 2.047760, loss_ss: 1.156716, loss_d: 0.891044
0.1532 --- loss: 1.625047, loss_ss: 1.260191, loss_d: 0.364856
0.1915 --- loss: 2.026176, loss_ss: 1.205111, loss_d: 0.821065
0.2298 --- loss: 1.675191, loss_ss: 1.167149, loss_d: 0.508042
0.2681 --- loss: 1.865274, loss_ss: 1.525057, loss_d: 0.340217
0.3064 --- loss: 1.660354, loss_ss: 1.197724, loss_d: 0.462630
0.3447 --- loss: 1.832562, loss_ss: 1.313213, loss_d: 0.519349
0.3830 --- loss: 1.659796, loss_ss: 1.311312, loss_d: 0.348484
0.4213 --- loss: 1.788039, loss_ss: 1.291803, loss_d: 0.496236
0.4596 --- loss: 1.966774, loss_ss: 1.558758, loss_d: 0.408016
0.4979 --- loss: 1.657308, loss_ss: 1.263960, loss_d: 0.393348
0.5362 --- loss: 1.621989, loss_ss: 1.069669, loss_d: 0.552321
0.5745 --- loss: 2.123357, loss_ss: 1.130919, loss_d: 0.992438
0.6128 --- loss: 1.700462, loss_ss: 1.191398, loss_d: 0.509064
0.6511 --- loss: 1.436884, loss_ss: 1.073380, loss_d: 0.363504
0.6894 --- loss: 1.681122, loss_ss: 1.005138, loss_d: 0.675985
0.7277 --- loss: 1.785440, loss_ss: 1.272653, loss_d: 0.512787
0.7660 --- loss: 1.488488, loss_ss: 1.103233, loss_d: 0.385255
0.8043 --- loss: 1.538317, loss_ss: 1.100358, loss_d: 0.437959
0.8426 --- loss: 1.988125, loss_ss: 1.213048, loss_d: 0.775077
0.8809 --- loss: 1.437164, loss_ss: 1.086491, loss_d: 0.350674
0.9192 --- loss: 1.519567, loss_ss: 1.026713, loss_d: 0.492854
0.9575 --- loss: 1.721779, loss_ss: 1.244281, loss_d: 0.477498
0.9958 --- loss: 1.810198, loss_ss: 1.179739, loss_d: 0.630459
Epoch finished! Loss: 1.7143308531735593
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.808072, loss_ss: 1.212696, loss_d: 0.595376
0.0383 --- loss: 1.753986, loss_ss: 1.163204, loss_d: 0.590781
0.0766 --- loss: 1.527916, loss_ss: 1.085374, loss_d: 0.442541
0.1149 --- loss: 1.499543, loss_ss: 1.029118, loss_d: 0.470425
0.1532 --- loss: 1.632367, loss_ss: 1.124053, loss_d: 0.508314
0.1915 --- loss: 1.869815, loss_ss: 1.121457, loss_d: 0.748358
0.2298 --- loss: 1.556493, loss_ss: 1.156287, loss_d: 0.400206
0.2681 --- loss: 1.784408, loss_ss: 1.194988, loss_d: 0.589420
0.3064 --- loss: 1.712263, loss_ss: 1.333855, loss_d: 0.378408
0.3447 --- loss: 1.381623, loss_ss: 1.043966, loss_d: 0.337657
0.3830 --- loss: 1.184352, loss_ss: 0.950210, loss_d: 0.234142
0.4213 --- loss: 1.570496, loss_ss: 1.010020, loss_d: 0.560476
0.4596 --- loss: 1.962161, loss_ss: 1.683524, loss_d: 0.278638
0.4979 --- loss: 1.502090, loss_ss: 1.112198, loss_d: 0.389892
0.5362 --- loss: 1.738010, loss_ss: 1.212085, loss_d: 0.525925
0.5745 --- loss: 1.820951, loss_ss: 1.455353, loss_d: 0.365598
0.6128 --- loss: 1.692567, loss_ss: 1.210318, loss_d: 0.482249
0.6511 --- loss: 1.688989, loss_ss: 1.189662, loss_d: 0.499327
0.6894 --- loss: 1.441286, loss_ss: 1.133044, loss_d: 0.308242
0.7277 --- loss: 1.281923, loss_ss: 0.977030, loss_d: 0.304893
0.7660 --- loss: 1.525034, loss_ss: 1.277835, loss_d: 0.247199
0.8043 --- loss: 1.848417, loss_ss: 1.281211, loss_d: 0.567206
0.8426 --- loss: 1.445652, loss_ss: 1.156920, loss_d: 0.288732
0.8809 --- loss: 1.587843, loss_ss: 1.174988, loss_d: 0.412855
0.9192 --- loss: 1.336647, loss_ss: 1.045398, loss_d: 0.291249
0.9575 --- loss: 2.089547, loss_ss: 1.251754, loss_d: 0.837793
0.9958 --- loss: 1.633463, loss_ss: 1.215554, loss_d: 0.417909
Epoch finished! Loss: 1.6587980446687602
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.677688, loss_ss: 1.220399, loss_d: 0.457289
0.0383 --- loss: 1.401400, loss_ss: 0.975916, loss_d: 0.425483
0.0766 --- loss: 1.390634, loss_ss: 1.168700, loss_d: 0.221934
0.1149 --- loss: 1.491523, loss_ss: 0.863638, loss_d: 0.627885
0.1532 --- loss: 1.702142, loss_ss: 1.197204, loss_d: 0.504938
0.1915 --- loss: 1.968425, loss_ss: 1.472021, loss_d: 0.496404
0.2298 --- loss: 1.450276, loss_ss: 1.070045, loss_d: 0.380231
0.2681 --- loss: 1.532981, loss_ss: 1.155824, loss_d: 0.377157
0.3064 --- loss: 1.602578, loss_ss: 1.241236, loss_d: 0.361343
0.3447 --- loss: 1.768362, loss_ss: 1.463259, loss_d: 0.305104
0.3830 --- loss: 1.366487, loss_ss: 1.051036, loss_d: 0.315452
0.4213 --- loss: 1.278772, loss_ss: 1.029267, loss_d: 0.249505
0.4596 --- loss: 2.436461, loss_ss: 1.254782, loss_d: 1.181680
0.4979 --- loss: 1.591141, loss_ss: 1.139076, loss_d: 0.452065
0.5362 --- loss: 1.360992, loss_ss: 1.086770, loss_d: 0.274222
0.5745 --- loss: 1.556965, loss_ss: 1.071380, loss_d: 0.485585
0.6128 --- loss: 1.273806, loss_ss: 1.054683, loss_d: 0.219124
0.6511 --- loss: 1.931450, loss_ss: 1.628795, loss_d: 0.302655
0.6894 --- loss: 1.584876, loss_ss: 0.997689, loss_d: 0.587187
0.7277 --- loss: 1.617649, loss_ss: 1.247990, loss_d: 0.369658
0.7660 --- loss: 1.570986, loss_ss: 1.272330, loss_d: 0.298656
0.8043 --- loss: 1.558413, loss_ss: 1.219211, loss_d: 0.339202
0.8426 --- loss: 1.435390, loss_ss: 0.984166, loss_d: 0.451224
0.8809 --- loss: 1.331082, loss_ss: 1.075489, loss_d: 0.255593
0.9192 --- loss: 1.499103, loss_ss: 1.232143, loss_d: 0.266960
0.9575 --- loss: 1.723276, loss_ss: 1.322629, loss_d: 0.400647
0.9958 --- loss: 1.324392, loss_ss: 0.929728, loss_d: 0.394664
Epoch finished! Loss: 1.6035669987229095
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.952905, loss_ss: 1.492891, loss_d: 0.460014
0.0383 --- loss: 1.711511, loss_ss: 1.367274, loss_d: 0.344237
0.0766 --- loss: 1.414886, loss_ss: 1.062422, loss_d: 0.352464
0.1149 --- loss: 1.346030, loss_ss: 1.050339, loss_d: 0.295691
0.1532 --- loss: 1.212740, loss_ss: 0.924040, loss_d: 0.288700
0.1915 --- loss: 1.648897, loss_ss: 0.986345, loss_d: 0.662553
0.2298 --- loss: 1.444815, loss_ss: 1.144254, loss_d: 0.300561
0.2681 --- loss: 1.538238, loss_ss: 1.284976, loss_d: 0.253261
0.3064 --- loss: 1.984630, loss_ss: 1.312868, loss_d: 0.671762
0.3447 --- loss: 1.993839, loss_ss: 1.183473, loss_d: 0.810367
0.3830 --- loss: 1.569690, loss_ss: 1.284296, loss_d: 0.285395
0.4213 --- loss: 1.641275, loss_ss: 1.150575, loss_d: 0.490700
0.4596 --- loss: 1.281514, loss_ss: 0.849931, loss_d: 0.431583
0.4979 --- loss: 1.580709, loss_ss: 1.130046, loss_d: 0.450662
0.5362 --- loss: 1.858837, loss_ss: 1.302185, loss_d: 0.556652
0.5745 --- loss: 1.551171, loss_ss: 1.044455, loss_d: 0.506716
0.6128 --- loss: 1.183010, loss_ss: 0.919420, loss_d: 0.263590
0.6511 --- loss: 1.555294, loss_ss: 1.036395, loss_d: 0.518898
0.6894 --- loss: 1.010180, loss_ss: 0.761001, loss_d: 0.249179
0.7277 --- loss: 1.349428, loss_ss: 1.070261, loss_d: 0.279167
0.7660 --- loss: 1.928785, loss_ss: 1.451990, loss_d: 0.476796
0.8043 --- loss: 1.590970, loss_ss: 1.232282, loss_d: 0.358689
0.8426 --- loss: 1.795643, loss_ss: 1.278398, loss_d: 0.517245
0.8809 --- loss: 1.494312, loss_ss: 1.075086, loss_d: 0.419226
0.9192 --- loss: 1.769773, loss_ss: 1.115014, loss_d: 0.654759
0.9575 --- loss: 1.755582, loss_ss: 1.436754, loss_d: 0.318828
0.9958 --- loss: 1.664326, loss_ss: 1.045895, loss_d: 0.618431
Epoch finished! Loss: 1.5880339287249978
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.050714, loss_ss: 1.515027, loss_d: 0.535687
0.0383 --- loss: 1.286977, loss_ss: 0.964157, loss_d: 0.322820
0.0766 --- loss: 1.645457, loss_ss: 1.311752, loss_d: 0.333705
0.1149 --- loss: 1.526366, loss_ss: 1.143897, loss_d: 0.382470
0.1532 --- loss: 1.555652, loss_ss: 1.165507, loss_d: 0.390145
0.1915 --- loss: 1.844582, loss_ss: 1.206462, loss_d: 0.638120
0.2298 --- loss: 1.837667, loss_ss: 1.156995, loss_d: 0.680672
0.2681 --- loss: 1.752948, loss_ss: 1.101790, loss_d: 0.651157
0.3064 --- loss: 1.411000, loss_ss: 1.076750, loss_d: 0.334250
0.3447 --- loss: 1.458300, loss_ss: 1.062264, loss_d: 0.396037
0.3830 --- loss: 1.104385, loss_ss: 0.785329, loss_d: 0.319055
0.4213 --- loss: 1.989614, loss_ss: 1.290793, loss_d: 0.698821
0.4596 --- loss: 1.307397, loss_ss: 0.949537, loss_d: 0.357860
0.4979 --- loss: 1.462113, loss_ss: 1.095824, loss_d: 0.366289
0.5362 --- loss: 1.678828, loss_ss: 1.284077, loss_d: 0.394751
0.5745 --- loss: 1.460616, loss_ss: 1.025673, loss_d: 0.434943
0.6128 --- loss: 1.855593, loss_ss: 1.095285, loss_d: 0.760308
0.6511 --- loss: 1.472358, loss_ss: 1.064755, loss_d: 0.407603
0.6894 --- loss: 1.516279, loss_ss: 1.112892, loss_d: 0.403387
0.7277 --- loss: 1.389685, loss_ss: 1.001066, loss_d: 0.388618
0.7660 --- loss: 1.440943, loss_ss: 1.045017, loss_d: 0.395925
0.8043 --- loss: 1.361739, loss_ss: 0.958860, loss_d: 0.402879
0.8426 --- loss: 1.538766, loss_ss: 1.153310, loss_d: 0.385455
0.8809 --- loss: 1.556422, loss_ss: 1.088186, loss_d: 0.468236
0.9192 --- loss: 1.523188, loss_ss: 1.093472, loss_d: 0.429716
0.9575 --- loss: 1.375690, loss_ss: 1.039711, loss_d: 0.335980
0.9958 --- loss: 1.460178, loss_ss: 1.015920, loss_d: 0.444258
Epoch finished! Loss: 1.5436193513687544
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.49876543209876545
             precision    recall  f1-score   support

        0.0       0.36      0.37      0.37       158
        1.0       0.00      0.00      0.00       103
        2.0       0.51      0.73      0.60       306
        3.0       0.81      0.59      0.69       133
        4.0       0.38      0.41      0.39       110

avg / total       0.45      0.50      0.46       810
 


====== chc006-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  75.19  36.71   84.51  36.48     36.59
1  87.28   0.00  100.00   0.00      0.00
2  63.33  72.55   57.74  51.03     59.92
3  91.11  59.40   97.34  81.44     68.70
4  82.84  40.91   89.43  37.82     39.30
Total accuracy: 49.88%
Average sen: 41.91%
Average spec: 85.80%
Macro f1-score: 40.90%
[0.97604036 0.83729458 0.83983243 0.89276403 0.82556891 0.82169878
 0.80702728 0.9164381  0.97898817 0.96762687 0.96234924 0.9609527
 0.98224652 0.98035872 0.93528837 0.91855377 0.85568571 0.84726655
 0.83820283 0.96346408 0.96362579 0.89843607 0.86688727 0.83594286
 0.94189572 0.97490805 0.9795292 ]
pred: 0.9099582588231122, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.244795, loss_ss: 1.542442, loss_d: 0.702353
0.0384 --- loss: 3.207638, loss_ss: 1.549765, loss_d: 1.657874
0.0767 --- loss: 2.282134, loss_ss: 1.436896, loss_d: 0.845238
0.1151 --- loss: 2.175080, loss_ss: 1.553036, loss_d: 0.622044
0.1535 --- loss: 2.254414, loss_ss: 1.581427, loss_d: 0.672987
0.1919 --- loss: 1.972836, loss_ss: 1.613280, loss_d: 0.359555
0.2302 --- loss: 2.162324, loss_ss: 1.465926, loss_d: 0.696398
0.2686 --- loss: 2.021120, loss_ss: 1.577481, loss_d: 0.443639
0.3070 --- loss: 1.825046, loss_ss: 1.450283, loss_d: 0.374764
0.3454 --- loss: 1.954934, loss_ss: 1.565727, loss_d: 0.389207
0.3837 --- loss: 2.355913, loss_ss: 1.463159, loss_d: 0.892753
0.4221 --- loss: 2.006745, loss_ss: 1.442698, loss_d: 0.564047
0.4605 --- loss: 1.924086, loss_ss: 1.518119, loss_d: 0.405967
0.4988 --- loss: 2.048182, loss_ss: 1.626514, loss_d: 0.421668
0.5372 --- loss: 2.286265, loss_ss: 1.464421, loss_d: 0.821844
0.5756 --- loss: 2.462622, loss_ss: 1.397435, loss_d: 1.065187
0.6140 --- loss: 1.911966, loss_ss: 1.410165, loss_d: 0.501801
0.6523 --- loss: 1.778549, loss_ss: 1.461318, loss_d: 0.317231
0.6907 --- loss: 2.173513, loss_ss: 1.613484, loss_d: 0.560029
0.7291 --- loss: 2.268526, loss_ss: 1.532365, loss_d: 0.736161
0.7675 --- loss: 2.026352, loss_ss: 1.458133, loss_d: 0.568219
0.8058 --- loss: 2.045899, loss_ss: 1.438718, loss_d: 0.607181
0.8442 --- loss: 1.963319, loss_ss: 1.418008, loss_d: 0.545311
0.8826 --- loss: 2.000615, loss_ss: 1.592823, loss_d: 0.407792
0.9210 --- loss: 1.838001, loss_ss: 1.388190, loss_d: 0.449811
0.9593 --- loss: 1.807434, loss_ss: 1.487917, loss_d: 0.319517
0.9977 --- loss: 2.143877, loss_ss: 1.480538, loss_d: 0.663340
Epoch finished! Loss: 2.0728175323743088
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.242415, loss_ss: 1.683249, loss_d: 0.559166
0.0384 --- loss: 2.001507, loss_ss: 1.497945, loss_d: 0.503562
0.0767 --- loss: 1.788178, loss_ss: 1.489511, loss_d: 0.298666
0.1151 --- loss: 1.809705, loss_ss: 1.305872, loss_d: 0.503833
0.1535 --- loss: 1.910508, loss_ss: 1.470839, loss_d: 0.439670
0.1919 --- loss: 2.555826, loss_ss: 1.392207, loss_d: 1.163619
0.2302 --- loss: 2.025529, loss_ss: 1.650245, loss_d: 0.375284
0.2686 --- loss: 2.220520, loss_ss: 1.478033, loss_d: 0.742486
0.3070 --- loss: 1.652858, loss_ss: 1.284134, loss_d: 0.368725
0.3454 --- loss: 1.645125, loss_ss: 1.296368, loss_d: 0.348757
0.3837 --- loss: 2.177339, loss_ss: 1.606462, loss_d: 0.570877
0.4221 --- loss: 1.778241, loss_ss: 1.316304, loss_d: 0.461937
0.4605 --- loss: 1.953605, loss_ss: 1.531390, loss_d: 0.422215
0.4988 --- loss: 2.068031, loss_ss: 1.352540, loss_d: 0.715491
0.5372 --- loss: 1.643092, loss_ss: 1.327900, loss_d: 0.315192
0.5756 --- loss: 2.574625, loss_ss: 1.718314, loss_d: 0.856311
0.6140 --- loss: 1.984067, loss_ss: 1.417767, loss_d: 0.566301
0.6523 --- loss: 1.733444, loss_ss: 1.384206, loss_d: 0.349237
0.6907 --- loss: 1.632090, loss_ss: 1.298752, loss_d: 0.333338
0.7291 --- loss: 1.872267, loss_ss: 1.423003, loss_d: 0.449264
0.7675 --- loss: 1.670784, loss_ss: 1.316535, loss_d: 0.354249
0.8058 --- loss: 1.848777, loss_ss: 1.278391, loss_d: 0.570386
0.8442 --- loss: 1.953735, loss_ss: 1.273050, loss_d: 0.680685
0.8826 --- loss: 1.912844, loss_ss: 1.349943, loss_d: 0.562901
0.9210 --- loss: 2.137253, loss_ss: 1.717899, loss_d: 0.419354
0.9593 --- loss: 1.923979, loss_ss: 1.420084, loss_d: 0.503895
0.9977 --- loss: 1.735234, loss_ss: 1.238326, loss_d: 0.496908
Epoch finished! Loss: 1.9784007095373595
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.628422, loss_ss: 1.230191, loss_d: 0.398231
0.0384 --- loss: 2.057762, loss_ss: 1.338521, loss_d: 0.719242
0.0767 --- loss: 1.966312, loss_ss: 1.376698, loss_d: 0.589614
0.1151 --- loss: 1.820884, loss_ss: 1.481285, loss_d: 0.339598
0.1535 --- loss: 2.086009, loss_ss: 1.316846, loss_d: 0.769163
0.1919 --- loss: 1.867347, loss_ss: 1.512340, loss_d: 0.355007
0.2302 --- loss: 1.832926, loss_ss: 1.505040, loss_d: 0.327886
0.2686 --- loss: 2.001002, loss_ss: 1.344245, loss_d: 0.656757
0.3070 --- loss: 1.474988, loss_ss: 1.150675, loss_d: 0.324312
0.3454 --- loss: 1.858127, loss_ss: 1.234101, loss_d: 0.624026
0.3837 --- loss: 1.895138, loss_ss: 1.403771, loss_d: 0.491367
0.4221 --- loss: 1.830976, loss_ss: 1.467002, loss_d: 0.363975
0.4605 --- loss: 1.813496, loss_ss: 1.349867, loss_d: 0.463629
0.4988 --- loss: 1.959103, loss_ss: 1.481135, loss_d: 0.477968
0.5372 --- loss: 2.015881, loss_ss: 1.604101, loss_d: 0.411780
0.5756 --- loss: 1.815591, loss_ss: 1.219859, loss_d: 0.595732
0.6140 --- loss: 1.607938, loss_ss: 1.254521, loss_d: 0.353417
0.6523 --- loss: 1.685598, loss_ss: 1.162709, loss_d: 0.522889
0.6907 --- loss: 1.499976, loss_ss: 1.079924, loss_d: 0.420052
0.7291 --- loss: 1.661604, loss_ss: 1.246030, loss_d: 0.415574
0.7675 --- loss: 1.631137, loss_ss: 1.174267, loss_d: 0.456870
0.8058 --- loss: 1.894735, loss_ss: 1.505048, loss_d: 0.389688
0.8442 --- loss: 1.722719, loss_ss: 1.280476, loss_d: 0.442243
0.8826 --- loss: 2.218697, loss_ss: 1.159875, loss_d: 1.058822
0.9210 --- loss: 1.783890, loss_ss: 1.347000, loss_d: 0.436889
0.9593 --- loss: 1.867469, loss_ss: 1.235376, loss_d: 0.632093
0.9977 --- loss: 1.634519, loss_ss: 1.265193, loss_d: 0.369325
Epoch finished! Loss: 1.854950761795044
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.791734, loss_ss: 1.298849, loss_d: 0.492885
0.0384 --- loss: 1.609794, loss_ss: 1.223386, loss_d: 0.386408
0.0767 --- loss: 1.707414, loss_ss: 1.415018, loss_d: 0.292396
0.1151 --- loss: 2.002902, loss_ss: 1.144838, loss_d: 0.858064
0.1535 --- loss: 1.718807, loss_ss: 1.414987, loss_d: 0.303819
0.1919 --- loss: 1.958722, loss_ss: 1.370466, loss_d: 0.588256
0.2302 --- loss: 1.897722, loss_ss: 1.285289, loss_d: 0.612432
0.2686 --- loss: 1.770260, loss_ss: 1.162835, loss_d: 0.607426
0.3070 --- loss: 1.562464, loss_ss: 1.091915, loss_d: 0.470549
0.3454 --- loss: 1.605672, loss_ss: 1.210339, loss_d: 0.395333
0.3837 --- loss: 1.520597, loss_ss: 1.155467, loss_d: 0.365131
0.4221 --- loss: 1.629650, loss_ss: 1.303892, loss_d: 0.325759
0.4605 --- loss: 1.614832, loss_ss: 1.283039, loss_d: 0.331792
0.4988 --- loss: 1.600851, loss_ss: 1.187537, loss_d: 0.413314
0.5372 --- loss: 1.712525, loss_ss: 1.128844, loss_d: 0.583680
0.5756 --- loss: 1.665195, loss_ss: 1.197650, loss_d: 0.467545
0.6140 --- loss: 1.579474, loss_ss: 1.166367, loss_d: 0.413107
0.6523 --- loss: 1.681402, loss_ss: 1.235749, loss_d: 0.445653
0.6907 --- loss: 1.841173, loss_ss: 1.348895, loss_d: 0.492278
0.7291 --- loss: 1.739357, loss_ss: 1.149359, loss_d: 0.589998
0.7675 --- loss: 2.515771, loss_ss: 1.298184, loss_d: 1.217587
0.8058 --- loss: 1.442134, loss_ss: 1.000986, loss_d: 0.441148
0.8442 --- loss: 1.581418, loss_ss: 0.946787, loss_d: 0.634632
0.8826 --- loss: 2.131471, loss_ss: 1.377576, loss_d: 0.753896
0.9210 --- loss: 1.594165, loss_ss: 1.110319, loss_d: 0.483846
0.9593 --- loss: 1.579255, loss_ss: 1.217844, loss_d: 0.361411
0.9977 --- loss: 1.591491, loss_ss: 1.023246, loss_d: 0.568245
Epoch finished! Loss: 1.7074300500062796
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.433762, loss_ss: 1.152663, loss_d: 0.281099
0.0384 --- loss: 1.489148, loss_ss: 1.078509, loss_d: 0.410639
0.0767 --- loss: 1.406781, loss_ss: 0.814292, loss_d: 0.592489
0.1151 --- loss: 1.665894, loss_ss: 1.270858, loss_d: 0.395036
0.1535 --- loss: 1.909250, loss_ss: 1.013653, loss_d: 0.895597
0.1919 --- loss: 1.499694, loss_ss: 1.075119, loss_d: 0.424575
0.2302 --- loss: 1.643218, loss_ss: 0.939986, loss_d: 0.703232
0.2686 --- loss: 2.028343, loss_ss: 1.262108, loss_d: 0.766236
0.3070 --- loss: 1.681616, loss_ss: 1.106826, loss_d: 0.574790
0.3454 --- loss: 1.667033, loss_ss: 1.231063, loss_d: 0.435970
0.3837 --- loss: 1.575452, loss_ss: 1.126825, loss_d: 0.448627
0.4221 --- loss: 1.551537, loss_ss: 1.166292, loss_d: 0.385245
0.4605 --- loss: 1.864804, loss_ss: 0.980016, loss_d: 0.884787
0.4988 --- loss: 1.594495, loss_ss: 1.291817, loss_d: 0.302678
0.5372 --- loss: 1.906524, loss_ss: 1.180732, loss_d: 0.725792
0.5756 --- loss: 1.497451, loss_ss: 1.195993, loss_d: 0.301459
0.6140 --- loss: 1.569469, loss_ss: 1.262833, loss_d: 0.306636
0.6523 --- loss: 1.838464, loss_ss: 1.169888, loss_d: 0.668576
0.6907 --- loss: 1.227342, loss_ss: 0.874054, loss_d: 0.353288
0.7291 --- loss: 1.376137, loss_ss: 1.012945, loss_d: 0.363192
0.7675 --- loss: 1.690051, loss_ss: 1.100991, loss_d: 0.589059
0.8058 --- loss: 1.579868, loss_ss: 1.018754, loss_d: 0.561114
0.8442 --- loss: 2.014554, loss_ss: 1.231846, loss_d: 0.782708
0.8826 --- loss: 1.619383, loss_ss: 0.957616, loss_d: 0.661767
0.9210 --- loss: 1.434169, loss_ss: 1.101283, loss_d: 0.332886
0.9593 --- loss: 2.294440, loss_ss: 1.255024, loss_d: 1.039417
0.9977 --- loss: 1.217921, loss_ss: 0.975326, loss_d: 0.242596
Epoch finished! Loss: 1.637857875915674
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.584811, loss_ss: 1.244716, loss_d: 0.340095
0.0384 --- loss: 1.383030, loss_ss: 1.003307, loss_d: 0.379724
0.0767 --- loss: 2.047666, loss_ss: 1.413972, loss_d: 0.633694
0.1151 --- loss: 1.909003, loss_ss: 1.090885, loss_d: 0.818117
0.1535 --- loss: 1.541651, loss_ss: 1.132937, loss_d: 0.408713
0.1919 --- loss: 1.364049, loss_ss: 1.013980, loss_d: 0.350070
0.2302 --- loss: 1.486364, loss_ss: 1.052056, loss_d: 0.434308
0.2686 --- loss: 1.530087, loss_ss: 1.166067, loss_d: 0.364020
0.3070 --- loss: 1.355883, loss_ss: 0.964231, loss_d: 0.391652
0.3454 --- loss: 1.842095, loss_ss: 1.156381, loss_d: 0.685714
0.3837 --- loss: 1.467431, loss_ss: 1.054134, loss_d: 0.413297
0.4221 --- loss: 1.948473, loss_ss: 1.389267, loss_d: 0.559206
0.4605 --- loss: 1.238424, loss_ss: 0.808172, loss_d: 0.430253
0.4988 --- loss: 1.669387, loss_ss: 1.266926, loss_d: 0.402460
0.5372 --- loss: 1.447986, loss_ss: 1.163098, loss_d: 0.284887
0.5756 --- loss: 1.487094, loss_ss: 1.092803, loss_d: 0.394292
0.6140 --- loss: 2.387804, loss_ss: 1.726638, loss_d: 0.661166
0.6523 --- loss: 1.774992, loss_ss: 1.225567, loss_d: 0.549425
0.6907 --- loss: 1.700600, loss_ss: 1.283415, loss_d: 0.417185
0.7291 --- loss: 1.362662, loss_ss: 1.015887, loss_d: 0.346775
0.7675 --- loss: 1.393470, loss_ss: 1.064410, loss_d: 0.329060
0.8058 --- loss: 1.786348, loss_ss: 1.126631, loss_d: 0.659717
0.8442 --- loss: 1.687574, loss_ss: 1.217831, loss_d: 0.469742
0.8826 --- loss: 1.914732, loss_ss: 1.392220, loss_d: 0.522512
0.9210 --- loss: 1.669352, loss_ss: 1.325395, loss_d: 0.343957
0.9593 --- loss: 1.772879, loss_ss: 1.038150, loss_d: 0.734729
0.9977 --- loss: 1.946745, loss_ss: 1.239248, loss_d: 0.707497
Epoch finished! Loss: 1.62817806326426
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.504393, loss_ss: 0.983761, loss_d: 0.520632
0.0384 --- loss: 1.749001, loss_ss: 1.220249, loss_d: 0.528752
0.0767 --- loss: 1.544604, loss_ss: 1.120586, loss_d: 0.424018
0.1151 --- loss: 1.502635, loss_ss: 1.071759, loss_d: 0.430876
0.1535 --- loss: 1.828271, loss_ss: 1.388168, loss_d: 0.440103
0.1919 --- loss: 1.442230, loss_ss: 1.052930, loss_d: 0.389300
0.2302 --- loss: 1.462706, loss_ss: 1.130033, loss_d: 0.332673
0.2686 --- loss: 1.391541, loss_ss: 1.083152, loss_d: 0.308389
0.3070 --- loss: 1.330509, loss_ss: 0.985223, loss_d: 0.345287
0.3454 --- loss: 1.885586, loss_ss: 1.447267, loss_d: 0.438318
0.3837 --- loss: 1.523361, loss_ss: 1.097316, loss_d: 0.426045
0.4221 --- loss: 1.641322, loss_ss: 1.323195, loss_d: 0.318127
0.4605 --- loss: 2.680659, loss_ss: 1.957530, loss_d: 0.723129
0.4988 --- loss: 1.255442, loss_ss: 0.926405, loss_d: 0.329037
0.5372 --- loss: 1.665642, loss_ss: 1.062611, loss_d: 0.603031
0.5756 --- loss: 1.333258, loss_ss: 0.950770, loss_d: 0.382488
0.6140 --- loss: 1.826148, loss_ss: 1.544582, loss_d: 0.281566
0.6523 --- loss: 1.719047, loss_ss: 1.225631, loss_d: 0.493416
0.6907 --- loss: 1.624693, loss_ss: 0.950814, loss_d: 0.673878
0.7291 --- loss: 1.355618, loss_ss: 0.825351, loss_d: 0.530267
0.7675 --- loss: 1.521831, loss_ss: 1.116159, loss_d: 0.405672
0.8058 --- loss: 1.684855, loss_ss: 1.261042, loss_d: 0.423813
0.8442 --- loss: 1.784810, loss_ss: 1.299417, loss_d: 0.485392
0.8826 --- loss: 1.754616, loss_ss: 1.352301, loss_d: 0.402314
0.9210 --- loss: 1.532023, loss_ss: 0.954030, loss_d: 0.577993
0.9593 --- loss: 1.646386, loss_ss: 1.068617, loss_d: 0.577769
0.9977 --- loss: 1.573170, loss_ss: 1.197107, loss_d: 0.376063
Epoch finished! Loss: 1.595181268453598
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.423601, loss_ss: 1.069375, loss_d: 0.354226
0.0384 --- loss: 1.472036, loss_ss: 1.062225, loss_d: 0.409811
0.0767 --- loss: 1.519545, loss_ss: 1.070958, loss_d: 0.448587
0.1151 --- loss: 1.924061, loss_ss: 1.468539, loss_d: 0.455522
0.1535 --- loss: 1.404017, loss_ss: 1.005019, loss_d: 0.398998
0.1919 --- loss: 1.519107, loss_ss: 1.178573, loss_d: 0.340535
0.2302 --- loss: 1.660697, loss_ss: 1.141295, loss_d: 0.519402
0.2686 --- loss: 1.512835, loss_ss: 1.157240, loss_d: 0.355595
0.3070 --- loss: 1.749607, loss_ss: 0.924296, loss_d: 0.825311
0.3454 --- loss: 1.783548, loss_ss: 1.222578, loss_d: 0.560970
0.3837 --- loss: 1.476014, loss_ss: 1.073963, loss_d: 0.402051
0.4221 --- loss: 1.161422, loss_ss: 0.896220, loss_d: 0.265203
0.4605 --- loss: 1.456031, loss_ss: 1.058359, loss_d: 0.397672
0.4988 --- loss: 1.090706, loss_ss: 0.819013, loss_d: 0.271693
0.5372 --- loss: 1.875462, loss_ss: 1.223017, loss_d: 0.652445
0.5756 --- loss: 1.245606, loss_ss: 0.959628, loss_d: 0.285979
0.6140 --- loss: 1.570058, loss_ss: 1.290934, loss_d: 0.279124
0.6523 --- loss: 1.226363, loss_ss: 0.964395, loss_d: 0.261968
0.6907 --- loss: 1.518764, loss_ss: 1.194006, loss_d: 0.324759
0.7291 --- loss: 1.077799, loss_ss: 0.895828, loss_d: 0.181971
0.7675 --- loss: 1.934207, loss_ss: 1.272780, loss_d: 0.661427
0.8058 --- loss: 1.198664, loss_ss: 0.701082, loss_d: 0.497582
0.8442 --- loss: 1.287022, loss_ss: 1.018560, loss_d: 0.268462
0.8826 --- loss: 1.334352, loss_ss: 1.042853, loss_d: 0.291499
0.9210 --- loss: 1.250319, loss_ss: 0.921108, loss_d: 0.329211
0.9593 --- loss: 1.062895, loss_ss: 0.784376, loss_d: 0.278520
0.9977 --- loss: 2.048921, loss_ss: 0.766076, loss_d: 1.282844
Epoch finished! Loss: 1.5346656217024877
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.605171, loss_ss: 1.064888, loss_d: 0.540283
0.0384 --- loss: 1.678025, loss_ss: 1.078840, loss_d: 0.599185
0.0767 --- loss: 1.424409, loss_ss: 1.024250, loss_d: 0.400160
0.1151 --- loss: 2.078871, loss_ss: 0.987978, loss_d: 1.090893
0.1535 --- loss: 1.550743, loss_ss: 1.279619, loss_d: 0.271124
0.1919 --- loss: 1.694803, loss_ss: 1.000671, loss_d: 0.694132
0.2302 --- loss: 1.660841, loss_ss: 1.320601, loss_d: 0.340240
0.2686 --- loss: 1.361429, loss_ss: 1.045082, loss_d: 0.316347
0.3070 --- loss: 2.187786, loss_ss: 1.522052, loss_d: 0.665734
0.3454 --- loss: 1.323778, loss_ss: 0.984676, loss_d: 0.339102
0.3837 --- loss: 1.887145, loss_ss: 0.875797, loss_d: 1.011348
0.4221 --- loss: 1.363256, loss_ss: 1.050865, loss_d: 0.312391
0.4605 --- loss: 1.832140, loss_ss: 0.977518, loss_d: 0.854623
0.4988 --- loss: 1.492735, loss_ss: 0.944215, loss_d: 0.548520
0.5372 --- loss: 1.388020, loss_ss: 0.840638, loss_d: 0.547382
0.5756 --- loss: 1.702273, loss_ss: 1.387933, loss_d: 0.314340
0.6140 --- loss: 1.188116, loss_ss: 0.881390, loss_d: 0.306726
0.6523 --- loss: 1.992661, loss_ss: 1.290226, loss_d: 0.702435
0.6907 --- loss: 1.142708, loss_ss: 0.843242, loss_d: 0.299466
0.7291 --- loss: 2.014501, loss_ss: 1.034836, loss_d: 0.979664
0.7675 --- loss: 1.460662, loss_ss: 1.200574, loss_d: 0.260089
0.8058 --- loss: 1.336373, loss_ss: 1.063424, loss_d: 0.272949
0.8442 --- loss: 1.268018, loss_ss: 0.863480, loss_d: 0.404538
0.8826 --- loss: 1.230747, loss_ss: 0.946717, loss_d: 0.284030
0.9210 --- loss: 1.550316, loss_ss: 1.239314, loss_d: 0.311002
0.9593 --- loss: 1.475367, loss_ss: 0.992504, loss_d: 0.482863
0.9977 --- loss: 1.443284, loss_ss: 0.808841, loss_d: 0.634443
Epoch finished! Loss: 1.5396624945677244
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.802492, loss_ss: 1.474198, loss_d: 0.328294
0.0384 --- loss: 1.833994, loss_ss: 1.009874, loss_d: 0.824121
0.0767 --- loss: 1.421935, loss_ss: 1.085408, loss_d: 0.336527
0.1151 --- loss: 1.836397, loss_ss: 1.155405, loss_d: 0.680992
0.1535 --- loss: 2.137703, loss_ss: 1.036620, loss_d: 1.101084
0.1919 --- loss: 1.107309, loss_ss: 0.845079, loss_d: 0.262229
0.2302 --- loss: 1.363712, loss_ss: 1.118004, loss_d: 0.245708
0.2686 --- loss: 1.545274, loss_ss: 0.972415, loss_d: 0.572859
0.3070 --- loss: 1.712267, loss_ss: 1.412353, loss_d: 0.299913
0.3454 --- loss: 1.388148, loss_ss: 1.063667, loss_d: 0.324481
0.3837 --- loss: 1.338291, loss_ss: 0.920738, loss_d: 0.417553
0.4221 --- loss: 1.360426, loss_ss: 1.076920, loss_d: 0.283506
0.4605 --- loss: 1.493426, loss_ss: 1.177329, loss_d: 0.316097
0.4988 --- loss: 1.965702, loss_ss: 1.221473, loss_d: 0.744229
0.5372 --- loss: 1.276577, loss_ss: 0.899141, loss_d: 0.377436
0.5756 --- loss: 1.838228, loss_ss: 1.126679, loss_d: 0.711549
0.6140 --- loss: 1.293883, loss_ss: 0.868389, loss_d: 0.425493
0.6523 --- loss: 1.579356, loss_ss: 1.179723, loss_d: 0.399633
0.6907 --- loss: 1.550160, loss_ss: 1.067097, loss_d: 0.483062
0.7291 --- loss: 1.378508, loss_ss: 1.046169, loss_d: 0.332339
0.7675 --- loss: 1.351406, loss_ss: 1.035206, loss_d: 0.316200
0.8058 --- loss: 1.446890, loss_ss: 1.062122, loss_d: 0.384768
0.8442 --- loss: 1.557659, loss_ss: 1.284590, loss_d: 0.273068
0.8826 --- loss: 1.500848, loss_ss: 0.968555, loss_d: 0.532293
0.9210 --- loss: 1.366888, loss_ss: 1.065265, loss_d: 0.301623
0.9593 --- loss: 1.678103, loss_ss: 1.221035, loss_d: 0.457068
0.9977 --- loss: 1.585142, loss_ss: 0.949113, loss_d: 0.636028
Epoch finished! Loss: 1.509544885158539
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.446875
             precision    recall  f1-score   support

        0.0       1.00      0.12      0.22       144
        1.0       0.00      0.00      0.00        82
        2.0       0.56      0.49      0.52       379
        3.0       0.37      1.00      0.54       227
        4.0       0.00      0.00      0.00       128

avg / total       0.46      0.45      0.37       960
 


====== chc008-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  86.88  12.50  100.00  100.00     22.22
1  91.46   0.00  100.00    0.00      0.00
2  64.38  48.81   74.53   55.56     51.97
3  60.00  99.56   47.75   37.11     54.07
4  86.67   0.00  100.00    0.00      0.00
Total accuracy: 44.69%
Average sen: 32.17%
Average spec: 84.46%
Macro f1-score: 25.65%
[0.28339341 0.26601246 0.27328914 0.28026924 0.30333683 0.30348989
 0.30683449 0.2580148  0.16347426 0.30018374 0.31174082 0.29477215
 0.21463397 0.19925143 0.15116757 0.27409166 0.31713679 0.30428806
 0.30062619 0.31165716 0.29240528 0.29568252 0.2821492  0.27529019
 0.28088993 0.25447109 0.32195514 0.30189008 0.2742562  0.25494286
 0.29662099 0.31156176]
pred: 0.2768681035377085, label: 0
Right! Diagnosis: Other

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.024842, loss_ss: 1.347258, loss_d: 0.677584
0.0383 --- loss: 2.463610, loss_ss: 1.861309, loss_d: 0.602301
0.0767 --- loss: 2.179827, loss_ss: 1.663562, loss_d: 0.516265
0.1150 --- loss: 1.935944, loss_ss: 1.560237, loss_d: 0.375707
0.1533 --- loss: 2.237411, loss_ss: 1.566570, loss_d: 0.670840
0.1916 --- loss: 2.202910, loss_ss: 1.495510, loss_d: 0.707400
0.2300 --- loss: 1.984702, loss_ss: 1.516196, loss_d: 0.468506
0.2683 --- loss: 1.899179, loss_ss: 1.650882, loss_d: 0.248297
0.3066 --- loss: 2.031310, loss_ss: 1.372466, loss_d: 0.658844
0.3450 --- loss: 2.026962, loss_ss: 1.463219, loss_d: 0.563743
0.3833 --- loss: 1.763334, loss_ss: 1.293370, loss_d: 0.469964
0.4216 --- loss: 2.208011, loss_ss: 1.738417, loss_d: 0.469594
0.4599 --- loss: 2.111128, loss_ss: 1.468890, loss_d: 0.642238
0.4983 --- loss: 1.810417, loss_ss: 1.476896, loss_d: 0.333521
0.5366 --- loss: 1.999331, loss_ss: 1.518853, loss_d: 0.480478
0.5749 --- loss: 2.354346, loss_ss: 1.668391, loss_d: 0.685955
0.6133 --- loss: 1.788017, loss_ss: 1.510478, loss_d: 0.277539
0.6516 --- loss: 1.973965, loss_ss: 1.533410, loss_d: 0.440555
0.6899 --- loss: 1.811858, loss_ss: 1.431311, loss_d: 0.380547
0.7282 --- loss: 1.800900, loss_ss: 1.499456, loss_d: 0.301445
0.7666 --- loss: 2.023341, loss_ss: 1.402475, loss_d: 0.620865
0.8049 --- loss: 2.044098, loss_ss: 1.518185, loss_d: 0.525913
0.8432 --- loss: 1.631892, loss_ss: 1.203216, loss_d: 0.428676
0.8816 --- loss: 1.580461, loss_ss: 1.212536, loss_d: 0.367925
0.9199 --- loss: 2.324087, loss_ss: 1.370586, loss_d: 0.953501
0.9582 --- loss: 2.014689, loss_ss: 1.492082, loss_d: 0.522607
0.9966 --- loss: 1.651621, loss_ss: 1.198721, loss_d: 0.452900
Epoch finished! Loss: 2.022833056174792
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.875620, loss_ss: 1.443491, loss_d: 0.432128
0.0383 --- loss: 1.938085, loss_ss: 1.571805, loss_d: 0.366280
0.0767 --- loss: 1.602929, loss_ss: 1.234572, loss_d: 0.368357
0.1150 --- loss: 1.809905, loss_ss: 1.429008, loss_d: 0.380897
0.1533 --- loss: 1.717705, loss_ss: 1.251065, loss_d: 0.466640
0.1916 --- loss: 1.617706, loss_ss: 1.132209, loss_d: 0.485497
0.2300 --- loss: 1.620253, loss_ss: 1.257497, loss_d: 0.362756
0.2683 --- loss: 1.877280, loss_ss: 1.317305, loss_d: 0.559975
0.3066 --- loss: 1.988667, loss_ss: 1.538718, loss_d: 0.449948
0.3450 --- loss: 1.898308, loss_ss: 1.303292, loss_d: 0.595016
0.3833 --- loss: 2.163318, loss_ss: 1.486540, loss_d: 0.676778
0.4216 --- loss: 1.599332, loss_ss: 1.233345, loss_d: 0.365987
0.4599 --- loss: 1.648068, loss_ss: 1.286408, loss_d: 0.361661
0.4983 --- loss: 1.870574, loss_ss: 1.384906, loss_d: 0.485669
0.5366 --- loss: 1.685254, loss_ss: 1.309970, loss_d: 0.375284
0.5749 --- loss: 2.146859, loss_ss: 1.446864, loss_d: 0.699995
0.6133 --- loss: 2.004035, loss_ss: 1.303380, loss_d: 0.700655
0.6516 --- loss: 1.650636, loss_ss: 1.290487, loss_d: 0.360149
0.6899 --- loss: 1.880761, loss_ss: 1.076068, loss_d: 0.804693
0.7282 --- loss: 1.734624, loss_ss: 1.249309, loss_d: 0.485316
0.7666 --- loss: 1.847191, loss_ss: 1.331359, loss_d: 0.515832
0.8049 --- loss: 1.773326, loss_ss: 1.163699, loss_d: 0.609628
0.8432 --- loss: 1.719090, loss_ss: 1.134834, loss_d: 0.584256
0.8816 --- loss: 1.748217, loss_ss: 1.366570, loss_d: 0.381647
0.9199 --- loss: 1.724067, loss_ss: 1.276482, loss_d: 0.447585
0.9582 --- loss: 1.856100, loss_ss: 1.333847, loss_d: 0.522253
0.9966 --- loss: 1.750641, loss_ss: 1.197871, loss_d: 0.552770
Epoch finished! Loss: 1.804188607289241
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.903152, loss_ss: 1.238171, loss_d: 0.664982
0.0383 --- loss: 2.136586, loss_ss: 1.268975, loss_d: 0.867611
0.0767 --- loss: 2.013065, loss_ss: 1.556713, loss_d: 0.456353
0.1150 --- loss: 1.716992, loss_ss: 1.092803, loss_d: 0.624189
0.1533 --- loss: 1.929500, loss_ss: 1.246924, loss_d: 0.682577
0.1916 --- loss: 1.657412, loss_ss: 1.378241, loss_d: 0.279170
0.2300 --- loss: 1.434026, loss_ss: 1.074541, loss_d: 0.359485
0.2683 --- loss: 1.923053, loss_ss: 1.218501, loss_d: 0.704552
0.3066 --- loss: 1.920198, loss_ss: 1.330806, loss_d: 0.589392
0.3450 --- loss: 1.809174, loss_ss: 1.210512, loss_d: 0.598662
0.3833 --- loss: 1.645133, loss_ss: 1.127927, loss_d: 0.517205
0.4216 --- loss: 2.022257, loss_ss: 1.591643, loss_d: 0.430614
0.4599 --- loss: 1.391938, loss_ss: 1.055608, loss_d: 0.336330
0.4983 --- loss: 1.694457, loss_ss: 0.996023, loss_d: 0.698434
0.5366 --- loss: 2.444356, loss_ss: 1.296446, loss_d: 1.147910
0.5749 --- loss: 1.821637, loss_ss: 1.318332, loss_d: 0.503305
0.6133 --- loss: 1.785679, loss_ss: 1.300879, loss_d: 0.484800
0.6516 --- loss: 1.672933, loss_ss: 1.136454, loss_d: 0.536479
0.6899 --- loss: 1.599559, loss_ss: 1.171941, loss_d: 0.427618
0.7282 --- loss: 1.562580, loss_ss: 0.872527, loss_d: 0.690053
0.7666 --- loss: 1.403539, loss_ss: 0.977464, loss_d: 0.426075
0.8049 --- loss: 1.258900, loss_ss: 0.945536, loss_d: 0.313364
0.8432 --- loss: 2.025911, loss_ss: 1.590675, loss_d: 0.435236
0.8816 --- loss: 1.513289, loss_ss: 1.158648, loss_d: 0.354641
0.9199 --- loss: 2.591815, loss_ss: 1.321840, loss_d: 1.269974
0.9582 --- loss: 1.937996, loss_ss: 1.102297, loss_d: 0.835698
0.9966 --- loss: 1.582911, loss_ss: 1.145038, loss_d: 0.437873
Epoch finished! Loss: 1.7200025760210478
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.575779, loss_ss: 1.231634, loss_d: 0.344144
0.0383 --- loss: 1.437732, loss_ss: 1.073554, loss_d: 0.364178
0.0767 --- loss: 1.523943, loss_ss: 0.906157, loss_d: 0.617786
0.1150 --- loss: 1.450674, loss_ss: 1.060822, loss_d: 0.389852
0.1533 --- loss: 1.630828, loss_ss: 1.181155, loss_d: 0.449673
0.1916 --- loss: 1.523176, loss_ss: 0.946745, loss_d: 0.576432
0.2300 --- loss: 1.634326, loss_ss: 0.886605, loss_d: 0.747721
0.2683 --- loss: 1.444710, loss_ss: 1.078616, loss_d: 0.366094
0.3066 --- loss: 1.639658, loss_ss: 1.119343, loss_d: 0.520316
0.3450 --- loss: 1.511425, loss_ss: 1.068706, loss_d: 0.442719
0.3833 --- loss: 1.861465, loss_ss: 1.157632, loss_d: 0.703833
0.4216 --- loss: 1.742541, loss_ss: 1.210472, loss_d: 0.532069
0.4599 --- loss: 1.494148, loss_ss: 0.991657, loss_d: 0.502491
0.4983 --- loss: 1.841909, loss_ss: 1.409546, loss_d: 0.432363
0.5366 --- loss: 1.759342, loss_ss: 1.418079, loss_d: 0.341263
0.5749 --- loss: 1.802668, loss_ss: 1.499791, loss_d: 0.302878
0.6133 --- loss: 1.377611, loss_ss: 1.099698, loss_d: 0.277913
0.6516 --- loss: 1.512988, loss_ss: 1.246964, loss_d: 0.266025
0.6899 --- loss: 1.792202, loss_ss: 1.394706, loss_d: 0.397495
0.7282 --- loss: 1.773122, loss_ss: 1.132790, loss_d: 0.640332
0.7666 --- loss: 1.567773, loss_ss: 1.010009, loss_d: 0.557764
0.8049 --- loss: 1.321771, loss_ss: 0.896143, loss_d: 0.425628
0.8432 --- loss: 1.269113, loss_ss: 0.956591, loss_d: 0.312522
0.8816 --- loss: 1.517580, loss_ss: 0.868485, loss_d: 0.649095
0.9199 --- loss: 1.224810, loss_ss: 0.886595, loss_d: 0.338215
0.9582 --- loss: 1.559027, loss_ss: 1.018257, loss_d: 0.540769
0.9966 --- loss: 1.780086, loss_ss: 1.372731, loss_d: 0.407355
Epoch finished! Loss: 1.6247575035462012
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.865805, loss_ss: 1.362713, loss_d: 0.503092
0.0383 --- loss: 1.396676, loss_ss: 1.020045, loss_d: 0.376631
0.0767 --- loss: 1.667481, loss_ss: 1.231653, loss_d: 0.435828
0.1150 --- loss: 1.607174, loss_ss: 1.137723, loss_d: 0.469451
0.1533 --- loss: 2.364446, loss_ss: 1.390458, loss_d: 0.973989
0.1916 --- loss: 1.841554, loss_ss: 1.510179, loss_d: 0.331375
0.2300 --- loss: 1.429492, loss_ss: 1.031870, loss_d: 0.397622
0.2683 --- loss: 1.643474, loss_ss: 1.132589, loss_d: 0.510884
0.3066 --- loss: 1.654599, loss_ss: 1.194077, loss_d: 0.460522
0.3450 --- loss: 1.664882, loss_ss: 1.243920, loss_d: 0.420962
0.3833 --- loss: 1.619155, loss_ss: 1.234051, loss_d: 0.385104
0.4216 --- loss: 1.757754, loss_ss: 1.279911, loss_d: 0.477843
0.4599 --- loss: 1.462083, loss_ss: 1.087635, loss_d: 0.374448
0.4983 --- loss: 1.653019, loss_ss: 1.183863, loss_d: 0.469156
0.5366 --- loss: 1.565133, loss_ss: 1.058782, loss_d: 0.506351
0.5749 --- loss: 1.387415, loss_ss: 0.945996, loss_d: 0.441418
0.6133 --- loss: 1.547117, loss_ss: 1.047980, loss_d: 0.499137
0.6516 --- loss: 1.721568, loss_ss: 0.955163, loss_d: 0.766404
0.6899 --- loss: 1.743566, loss_ss: 1.089587, loss_d: 0.653979
0.7282 --- loss: 1.486526, loss_ss: 1.173145, loss_d: 0.313380
0.7666 --- loss: 1.303118, loss_ss: 0.909541, loss_d: 0.393577
0.8049 --- loss: 1.307263, loss_ss: 0.960272, loss_d: 0.346991
0.8432 --- loss: 1.351677, loss_ss: 0.838673, loss_d: 0.513003
0.8816 --- loss: 1.485604, loss_ss: 1.159755, loss_d: 0.325849
0.9199 --- loss: 2.075667, loss_ss: 1.507846, loss_d: 0.567820
0.9582 --- loss: 1.513859, loss_ss: 1.041830, loss_d: 0.472029
0.9966 --- loss: 1.583448, loss_ss: 0.914597, loss_d: 0.668851
Epoch finished! Loss: 1.6164634319452138
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.603801, loss_ss: 1.171037, loss_d: 0.432765
0.0383 --- loss: 1.787879, loss_ss: 1.200093, loss_d: 0.587786
0.0767 --- loss: 1.450199, loss_ss: 1.137592, loss_d: 0.312607
0.1150 --- loss: 1.769849, loss_ss: 1.186079, loss_d: 0.583770
0.1533 --- loss: 1.744636, loss_ss: 1.085585, loss_d: 0.659052
0.1916 --- loss: 1.461132, loss_ss: 1.017166, loss_d: 0.443966
0.2300 --- loss: 1.508656, loss_ss: 1.191552, loss_d: 0.317104
0.2683 --- loss: 1.525847, loss_ss: 0.915723, loss_d: 0.610124
0.3066 --- loss: 1.546188, loss_ss: 0.952819, loss_d: 0.593369
0.3450 --- loss: 1.578213, loss_ss: 1.148876, loss_d: 0.429337
0.3833 --- loss: 1.570560, loss_ss: 1.097350, loss_d: 0.473210
0.4216 --- loss: 1.704364, loss_ss: 1.162506, loss_d: 0.541858
0.4599 --- loss: 1.782069, loss_ss: 1.242588, loss_d: 0.539480
0.4983 --- loss: 1.416796, loss_ss: 0.973253, loss_d: 0.443542
0.5366 --- loss: 1.531916, loss_ss: 1.080157, loss_d: 0.451759
0.5749 --- loss: 1.191103, loss_ss: 0.740182, loss_d: 0.450920
0.6133 --- loss: 1.757349, loss_ss: 1.290355, loss_d: 0.466994
0.6516 --- loss: 1.762110, loss_ss: 1.134502, loss_d: 0.627608
0.6899 --- loss: 1.727388, loss_ss: 1.223303, loss_d: 0.504085
0.7282 --- loss: 1.215466, loss_ss: 0.845409, loss_d: 0.370057
0.7666 --- loss: 1.433693, loss_ss: 1.130780, loss_d: 0.302914
0.8049 --- loss: 1.633403, loss_ss: 1.290951, loss_d: 0.342453
0.8432 --- loss: 1.421674, loss_ss: 1.045436, loss_d: 0.376237
0.8816 --- loss: 1.537966, loss_ss: 1.162053, loss_d: 0.375913
0.9199 --- loss: 1.443683, loss_ss: 1.031667, loss_d: 0.412016
0.9582 --- loss: 1.269156, loss_ss: 0.854765, loss_d: 0.414391
0.9966 --- loss: 1.375941, loss_ss: 1.023615, loss_d: 0.352326
Epoch finished! Loss: 1.576679983964333
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.696875, loss_ss: 1.162085, loss_d: 0.534790
0.0383 --- loss: 1.413668, loss_ss: 1.055570, loss_d: 0.358098
0.0767 --- loss: 1.417831, loss_ss: 1.113692, loss_d: 0.304139
0.1150 --- loss: 1.324285, loss_ss: 0.949457, loss_d: 0.374828
0.1533 --- loss: 1.707344, loss_ss: 1.465585, loss_d: 0.241760
0.1916 --- loss: 1.694220, loss_ss: 1.222578, loss_d: 0.471642
0.2300 --- loss: 1.459797, loss_ss: 1.130330, loss_d: 0.329467
0.2683 --- loss: 1.399672, loss_ss: 0.949307, loss_d: 0.450365
0.3066 --- loss: 2.228668, loss_ss: 1.162126, loss_d: 1.066542
0.3450 --- loss: 1.637921, loss_ss: 1.163311, loss_d: 0.474610
0.3833 --- loss: 1.410002, loss_ss: 1.120317, loss_d: 0.289685
0.4216 --- loss: 1.967789, loss_ss: 1.672810, loss_d: 0.294979
0.4599 --- loss: 1.106104, loss_ss: 0.837399, loss_d: 0.268705
0.4983 --- loss: 1.643681, loss_ss: 1.095983, loss_d: 0.547698
0.5366 --- loss: 1.501505, loss_ss: 1.176371, loss_d: 0.325133
0.5749 --- loss: 1.610691, loss_ss: 1.010136, loss_d: 0.600555
0.6133 --- loss: 1.237961, loss_ss: 0.916584, loss_d: 0.321378
0.6516 --- loss: 2.108090, loss_ss: 1.354513, loss_d: 0.753577
0.6899 --- loss: 1.132272, loss_ss: 0.791665, loss_d: 0.340607
0.7282 --- loss: 1.400898, loss_ss: 0.970459, loss_d: 0.430440
0.7666 --- loss: 1.420535, loss_ss: 0.877101, loss_d: 0.543434
0.8049 --- loss: 1.770478, loss_ss: 1.000004, loss_d: 0.770474
0.8432 --- loss: 1.660572, loss_ss: 1.207080, loss_d: 0.453492
0.8816 --- loss: 1.634789, loss_ss: 1.214933, loss_d: 0.419855
0.9199 --- loss: 1.465436, loss_ss: 1.020816, loss_d: 0.444621
0.9582 --- loss: 1.310567, loss_ss: 0.958892, loss_d: 0.351675
0.9966 --- loss: 1.678772, loss_ss: 1.229371, loss_d: 0.449401
Epoch finished! Loss: 1.5801856646170982
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.541705, loss_ss: 1.735667, loss_d: 0.806038
0.0383 --- loss: 1.353469, loss_ss: 0.997409, loss_d: 0.356060
0.0767 --- loss: 1.918186, loss_ss: 1.590539, loss_d: 0.327647
0.1150 --- loss: 1.352405, loss_ss: 1.008195, loss_d: 0.344210
0.1533 --- loss: 1.431474, loss_ss: 0.960112, loss_d: 0.471362
0.1916 --- loss: 1.675601, loss_ss: 1.168005, loss_d: 0.507596
0.2300 --- loss: 1.642454, loss_ss: 1.022635, loss_d: 0.619819
0.2683 --- loss: 1.479223, loss_ss: 0.917671, loss_d: 0.561552
0.3066 --- loss: 1.096331, loss_ss: 0.725977, loss_d: 0.370354
0.3450 --- loss: 1.450901, loss_ss: 1.056851, loss_d: 0.394049
0.3833 --- loss: 1.613442, loss_ss: 1.021071, loss_d: 0.592371
0.4216 --- loss: 1.552058, loss_ss: 1.136056, loss_d: 0.416002
0.4599 --- loss: 1.920108, loss_ss: 1.008123, loss_d: 0.911985
0.4983 --- loss: 1.671141, loss_ss: 1.011368, loss_d: 0.659773
0.5366 --- loss: 1.643728, loss_ss: 1.002256, loss_d: 0.641473
0.5749 --- loss: 1.640787, loss_ss: 1.150663, loss_d: 0.490123
0.6133 --- loss: 1.646018, loss_ss: 1.255298, loss_d: 0.390720
0.6516 --- loss: 1.477363, loss_ss: 0.927169, loss_d: 0.550194
0.6899 --- loss: 1.276390, loss_ss: 0.900200, loss_d: 0.376191
0.7282 --- loss: 1.307344, loss_ss: 0.984272, loss_d: 0.323072
0.7666 --- loss: 1.301239, loss_ss: 0.890400, loss_d: 0.410839
0.8049 --- loss: 1.369635, loss_ss: 0.968412, loss_d: 0.401224
0.8432 --- loss: 1.244498, loss_ss: 0.892249, loss_d: 0.352250
0.8816 --- loss: 1.303032, loss_ss: 0.833050, loss_d: 0.469982
0.9199 --- loss: 1.864195, loss_ss: 1.482035, loss_d: 0.382160
0.9582 --- loss: 1.933040, loss_ss: 1.296768, loss_d: 0.636272
0.9966 --- loss: 1.590037, loss_ss: 1.163375, loss_d: 0.426662
Epoch finished! Loss: 1.5598769884843093
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.258261, loss_ss: 0.986446, loss_d: 0.271815
0.0383 --- loss: 1.691460, loss_ss: 1.095024, loss_d: 0.596436
0.0767 --- loss: 1.233160, loss_ss: 0.874983, loss_d: 0.358177
0.1150 --- loss: 1.357695, loss_ss: 1.080637, loss_d: 0.277058
0.1533 --- loss: 1.337049, loss_ss: 0.949588, loss_d: 0.387461
0.1916 --- loss: 1.629183, loss_ss: 1.317829, loss_d: 0.311354
0.2300 --- loss: 1.412195, loss_ss: 1.026685, loss_d: 0.385510
0.2683 --- loss: 1.551672, loss_ss: 1.239534, loss_d: 0.312138
0.3066 --- loss: 1.571381, loss_ss: 0.983714, loss_d: 0.587667
0.3450 --- loss: 1.600411, loss_ss: 1.264931, loss_d: 0.335479
0.3833 --- loss: 1.425838, loss_ss: 0.987361, loss_d: 0.438477
0.4216 --- loss: 1.174592, loss_ss: 0.753905, loss_d: 0.420686
0.4599 --- loss: 1.279855, loss_ss: 0.971489, loss_d: 0.308366
0.4983 --- loss: 1.440983, loss_ss: 1.021924, loss_d: 0.419058
0.5366 --- loss: 1.551512, loss_ss: 1.004293, loss_d: 0.547219
0.5749 --- loss: 1.522894, loss_ss: 1.158446, loss_d: 0.364448
0.6133 --- loss: 1.370188, loss_ss: 1.049805, loss_d: 0.320383
0.6516 --- loss: 1.981761, loss_ss: 1.145740, loss_d: 0.836021
0.6899 --- loss: 1.637859, loss_ss: 1.055432, loss_d: 0.582428
0.7282 --- loss: 1.298308, loss_ss: 0.868258, loss_d: 0.430050
0.7666 --- loss: 1.594895, loss_ss: 0.984878, loss_d: 0.610017
0.8049 --- loss: 1.357834, loss_ss: 1.059178, loss_d: 0.298655
0.8432 --- loss: 1.554820, loss_ss: 1.023453, loss_d: 0.531367
0.8816 --- loss: 1.715456, loss_ss: 0.932042, loss_d: 0.783414
0.9199 --- loss: 1.647945, loss_ss: 1.100376, loss_d: 0.547569
0.9582 --- loss: 1.684554, loss_ss: 1.377574, loss_d: 0.306980
0.9966 --- loss: 1.364508, loss_ss: 0.828529, loss_d: 0.535980
Epoch finished! Loss: 1.5159751048454873
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.469756, loss_ss: 1.177942, loss_d: 0.291814
0.0383 --- loss: 1.432009, loss_ss: 1.009699, loss_d: 0.422310
0.0767 --- loss: 1.883432, loss_ss: 1.385092, loss_d: 0.498341
0.1150 --- loss: 1.183549, loss_ss: 0.898489, loss_d: 0.285059
0.1533 --- loss: 1.899161, loss_ss: 1.235340, loss_d: 0.663821
0.1916 --- loss: 1.594209, loss_ss: 0.955183, loss_d: 0.639025
0.2300 --- loss: 1.224821, loss_ss: 0.892505, loss_d: 0.332316
0.2683 --- loss: 1.535269, loss_ss: 0.962686, loss_d: 0.572583
0.3066 --- loss: 1.339922, loss_ss: 1.046732, loss_d: 0.293190
0.3450 --- loss: 1.322845, loss_ss: 0.863831, loss_d: 0.459015
0.3833 --- loss: 1.291963, loss_ss: 0.883911, loss_d: 0.408053
0.4216 --- loss: 1.774130, loss_ss: 0.940028, loss_d: 0.834102
0.4599 --- loss: 1.213452, loss_ss: 0.891719, loss_d: 0.321733
0.4983 --- loss: 1.731355, loss_ss: 1.364409, loss_d: 0.366946
0.5366 --- loss: 1.818229, loss_ss: 1.352691, loss_d: 0.465538
0.5749 --- loss: 1.483558, loss_ss: 1.059982, loss_d: 0.423576
0.6133 --- loss: 1.722275, loss_ss: 1.108124, loss_d: 0.614150
0.6516 --- loss: 1.382809, loss_ss: 1.035776, loss_d: 0.347033
0.6899 --- loss: 1.851731, loss_ss: 1.433526, loss_d: 0.418206
0.7282 --- loss: 2.014384, loss_ss: 0.865035, loss_d: 1.149349
0.7666 --- loss: 1.492494, loss_ss: 0.850232, loss_d: 0.642262
0.8049 --- loss: 1.164602, loss_ss: 0.849110, loss_d: 0.315493
0.8432 --- loss: 1.600636, loss_ss: 0.984807, loss_d: 0.615828
0.8816 --- loss: 1.390148, loss_ss: 0.894213, loss_d: 0.495934
0.9199 --- loss: 1.301786, loss_ss: 0.987067, loss_d: 0.314719
0.9582 --- loss: 1.790651, loss_ss: 1.359355, loss_d: 0.431296
0.9966 --- loss: 1.483583, loss_ss: 1.158882, loss_d: 0.324701
Epoch finished! Loss: 1.527723367856099
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.08275862068965517
             precision    recall  f1-score   support

        0.0       0.08      1.00      0.15        72
        1.0       0.00      0.00      0.00        46
        2.0       0.00      0.00      0.00       443
        3.0       0.00      0.00      0.00       196
        4.0       0.00      0.00      0.00       113

avg / total       0.01      0.08      0.01       870
 


====== chc009-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0   8.28  100.0     0.0   8.28     15.29
1  94.71    0.0   100.0   0.00      0.00
2  49.08    0.0   100.0   0.00      0.00
3  77.47    0.0   100.0   0.00      0.00
4  87.01    0.0   100.0   0.00      0.00
Total accuracy: 8.28%
Average sen: 20.00%
Average spec: 80.00%
Macro f1-score: 3.06%
pred: 0.513475239276886, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.394705, loss_ss: 1.678313, loss_d: 0.716392
0.0383 --- loss: 2.457510, loss_ss: 1.565708, loss_d: 0.891803
0.0766 --- loss: 2.230178, loss_ss: 1.681513, loss_d: 0.548665
0.1149 --- loss: 1.906706, loss_ss: 1.592628, loss_d: 0.314078
0.1533 --- loss: 1.992452, loss_ss: 1.584746, loss_d: 0.407706
0.1916 --- loss: 2.107523, loss_ss: 1.568746, loss_d: 0.538777
0.2299 --- loss: 2.005760, loss_ss: 1.580676, loss_d: 0.425084
0.2682 --- loss: 2.267538, loss_ss: 1.514119, loss_d: 0.753419
0.3065 --- loss: 2.193603, loss_ss: 1.659262, loss_d: 0.534341
0.3448 --- loss: 1.978118, loss_ss: 1.493400, loss_d: 0.484718
0.3831 --- loss: 2.155118, loss_ss: 1.494019, loss_d: 0.661099
0.4215 --- loss: 1.710257, loss_ss: 1.416660, loss_d: 0.293597
0.4598 --- loss: 2.131649, loss_ss: 1.496372, loss_d: 0.635277
0.4981 --- loss: 1.938792, loss_ss: 1.522271, loss_d: 0.416521
0.5364 --- loss: 2.083183, loss_ss: 1.384337, loss_d: 0.698846
0.5747 --- loss: 1.954780, loss_ss: 1.448349, loss_d: 0.506431
0.6130 --- loss: 2.142451, loss_ss: 1.579625, loss_d: 0.562825
0.6513 --- loss: 1.950050, loss_ss: 1.470955, loss_d: 0.479095
0.6897 --- loss: 2.356007, loss_ss: 1.450524, loss_d: 0.905484
0.7280 --- loss: 1.976197, loss_ss: 1.517748, loss_d: 0.458449
0.7663 --- loss: 2.154041, loss_ss: 1.515033, loss_d: 0.639008
0.8046 --- loss: 2.025144, loss_ss: 1.591780, loss_d: 0.433364
0.8429 --- loss: 1.900331, loss_ss: 1.446880, loss_d: 0.453451
0.8812 --- loss: 1.807045, loss_ss: 1.438117, loss_d: 0.368928
0.9195 --- loss: 1.944350, loss_ss: 1.452550, loss_d: 0.491800
0.9579 --- loss: 2.222964, loss_ss: 1.569068, loss_d: 0.653896
0.9962 --- loss: 1.740805, loss_ss: 1.460713, loss_d: 0.280092
Epoch finished! Loss: 2.083180573811898
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.960280, loss_ss: 1.503956, loss_d: 0.456325
0.0383 --- loss: 1.730102, loss_ss: 1.425406, loss_d: 0.304696
0.0766 --- loss: 1.986680, loss_ss: 1.477336, loss_d: 0.509344
0.1149 --- loss: 1.837165, loss_ss: 1.420468, loss_d: 0.416697
0.1533 --- loss: 2.219358, loss_ss: 1.598225, loss_d: 0.621133
0.1916 --- loss: 2.065689, loss_ss: 1.545102, loss_d: 0.520586
0.2299 --- loss: 1.970955, loss_ss: 1.445181, loss_d: 0.525774
0.2682 --- loss: 1.912945, loss_ss: 1.604520, loss_d: 0.308425
0.3065 --- loss: 1.800702, loss_ss: 1.402396, loss_d: 0.398306
0.3448 --- loss: 1.969432, loss_ss: 1.587639, loss_d: 0.381793
0.3831 --- loss: 1.794061, loss_ss: 1.416372, loss_d: 0.377689
0.4215 --- loss: 2.163011, loss_ss: 1.526141, loss_d: 0.636869
0.4598 --- loss: 1.833247, loss_ss: 1.430995, loss_d: 0.402252
0.4981 --- loss: 1.879707, loss_ss: 1.224755, loss_d: 0.654952
0.5364 --- loss: 1.816036, loss_ss: 1.254721, loss_d: 0.561315
0.5747 --- loss: 2.060007, loss_ss: 1.543868, loss_d: 0.516139
0.6130 --- loss: 2.011568, loss_ss: 1.318234, loss_d: 0.693334
0.6513 --- loss: 1.819527, loss_ss: 1.394058, loss_d: 0.425469
0.6897 --- loss: 1.790022, loss_ss: 1.415270, loss_d: 0.374752
0.7280 --- loss: 2.019509, loss_ss: 1.548910, loss_d: 0.470599
0.7663 --- loss: 2.195189, loss_ss: 1.733409, loss_d: 0.461779
0.8046 --- loss: 2.004717, loss_ss: 1.383921, loss_d: 0.620796
0.8429 --- loss: 2.034209, loss_ss: 1.407122, loss_d: 0.627086
0.8812 --- loss: 1.556516, loss_ss: 1.256339, loss_d: 0.300177
0.9195 --- loss: 1.622391, loss_ss: 1.378414, loss_d: 0.243976
0.9579 --- loss: 1.824411, loss_ss: 1.406025, loss_d: 0.418387
0.9962 --- loss: 1.830030, loss_ss: 1.557720, loss_d: 0.272310
Epoch finished! Loss: 1.979404014807481
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.182428, loss_ss: 1.606172, loss_d: 0.576255
0.0383 --- loss: 1.998882, loss_ss: 1.423902, loss_d: 0.574980
0.0766 --- loss: 2.001981, loss_ss: 1.415311, loss_d: 0.586670
0.1149 --- loss: 1.839393, loss_ss: 1.433229, loss_d: 0.406164
0.1533 --- loss: 2.989004, loss_ss: 1.698659, loss_d: 1.290345
0.1916 --- loss: 2.067303, loss_ss: 1.434989, loss_d: 0.632314
0.2299 --- loss: 1.825726, loss_ss: 1.411106, loss_d: 0.414619
0.2682 --- loss: 1.773860, loss_ss: 1.291145, loss_d: 0.482715
0.3065 --- loss: 1.975033, loss_ss: 1.403534, loss_d: 0.571499
0.3448 --- loss: 2.126897, loss_ss: 1.646478, loss_d: 0.480418
0.3831 --- loss: 1.705467, loss_ss: 1.369235, loss_d: 0.336232
0.4215 --- loss: 2.151013, loss_ss: 1.645851, loss_d: 0.505161
0.4598 --- loss: 2.032995, loss_ss: 1.489819, loss_d: 0.543176
0.4981 --- loss: 1.858129, loss_ss: 1.250465, loss_d: 0.607664
0.5364 --- loss: 1.986311, loss_ss: 1.296816, loss_d: 0.689494
0.5747 --- loss: 2.293160, loss_ss: 1.552313, loss_d: 0.740847
0.6130 --- loss: 2.072015, loss_ss: 1.465682, loss_d: 0.606333
0.6513 --- loss: 1.917939, loss_ss: 1.307678, loss_d: 0.610261
0.6897 --- loss: 1.785048, loss_ss: 1.304901, loss_d: 0.480147
0.7280 --- loss: 1.862507, loss_ss: 1.304018, loss_d: 0.558489
0.7663 --- loss: 1.788572, loss_ss: 1.339315, loss_d: 0.449257
0.8046 --- loss: 1.970410, loss_ss: 1.309590, loss_d: 0.660819
0.8429 --- loss: 1.478884, loss_ss: 1.221958, loss_d: 0.256925
0.8812 --- loss: 1.891058, loss_ss: 1.466613, loss_d: 0.424446
0.9195 --- loss: 1.856773, loss_ss: 1.348192, loss_d: 0.508581
0.9579 --- loss: 2.015756, loss_ss: 1.462561, loss_d: 0.553195
0.9962 --- loss: 1.735110, loss_ss: 1.336515, loss_d: 0.398594
Epoch finished! Loss: 1.9243964690428514
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.825253, loss_ss: 1.303128, loss_d: 0.522125
0.0383 --- loss: 1.993632, loss_ss: 1.241139, loss_d: 0.752493
0.0766 --- loss: 1.913896, loss_ss: 1.455248, loss_d: 0.458649
0.1149 --- loss: 2.556111, loss_ss: 1.557753, loss_d: 0.998357
0.1533 --- loss: 2.086654, loss_ss: 1.236390, loss_d: 0.850264
0.1916 --- loss: 1.636758, loss_ss: 1.301995, loss_d: 0.334763
0.2299 --- loss: 1.987660, loss_ss: 1.419252, loss_d: 0.568408
0.2682 --- loss: 1.446404, loss_ss: 1.112000, loss_d: 0.334403
0.3065 --- loss: 1.576859, loss_ss: 1.194852, loss_d: 0.382007
0.3448 --- loss: 1.797623, loss_ss: 1.249307, loss_d: 0.548316
0.3831 --- loss: 1.440919, loss_ss: 0.998638, loss_d: 0.442281
0.4215 --- loss: 2.030276, loss_ss: 1.369734, loss_d: 0.660542
0.4598 --- loss: 1.632678, loss_ss: 1.284177, loss_d: 0.348501
0.4981 --- loss: 1.710766, loss_ss: 1.284963, loss_d: 0.425803
0.5364 --- loss: 1.815696, loss_ss: 1.329356, loss_d: 0.486341
0.5747 --- loss: 1.767909, loss_ss: 1.331388, loss_d: 0.436521
0.6130 --- loss: 1.855219, loss_ss: 1.540125, loss_d: 0.315094
0.6513 --- loss: 1.659743, loss_ss: 1.217853, loss_d: 0.441890
0.6897 --- loss: 1.783965, loss_ss: 1.267961, loss_d: 0.516003
0.7280 --- loss: 1.720193, loss_ss: 1.068633, loss_d: 0.651560
0.7663 --- loss: 1.686822, loss_ss: 1.366063, loss_d: 0.320759
0.8046 --- loss: 2.090187, loss_ss: 1.159038, loss_d: 0.931149
0.8429 --- loss: 1.922082, loss_ss: 1.509475, loss_d: 0.412607
0.8812 --- loss: 1.222733, loss_ss: 1.041121, loss_d: 0.181612
0.9195 --- loss: 1.902846, loss_ss: 1.341031, loss_d: 0.561815
0.9579 --- loss: 1.822171, loss_ss: 1.263675, loss_d: 0.558496
0.9962 --- loss: 2.125712, loss_ss: 1.342231, loss_d: 0.783482
Epoch finished! Loss: 1.786166840333205
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.566027, loss_ss: 1.083965, loss_d: 0.482063
0.0383 --- loss: 1.784557, loss_ss: 1.160885, loss_d: 0.623673
0.0766 --- loss: 2.194140, loss_ss: 1.303844, loss_d: 0.890296
0.1149 --- loss: 1.672880, loss_ss: 0.958917, loss_d: 0.713963
0.1533 --- loss: 1.266632, loss_ss: 0.963882, loss_d: 0.302750
0.1916 --- loss: 2.217307, loss_ss: 1.276400, loss_d: 0.940907
0.2299 --- loss: 1.669317, loss_ss: 1.129010, loss_d: 0.540307
0.2682 --- loss: 1.703231, loss_ss: 1.240391, loss_d: 0.462840
0.3065 --- loss: 1.437554, loss_ss: 1.042226, loss_d: 0.395327
0.3448 --- loss: 1.564977, loss_ss: 1.001688, loss_d: 0.563290
0.3831 --- loss: 1.377464, loss_ss: 1.067973, loss_d: 0.309491
0.4215 --- loss: 1.677998, loss_ss: 1.257448, loss_d: 0.420550
0.4598 --- loss: 1.540380, loss_ss: 0.974199, loss_d: 0.566181
0.4981 --- loss: 2.163679, loss_ss: 1.336851, loss_d: 0.826828
0.5364 --- loss: 1.557616, loss_ss: 1.126727, loss_d: 0.430889
0.5747 --- loss: 1.674151, loss_ss: 1.276727, loss_d: 0.397424
0.6130 --- loss: 1.742287, loss_ss: 1.400078, loss_d: 0.342209
0.6513 --- loss: 1.446965, loss_ss: 1.153068, loss_d: 0.293897
0.6897 --- loss: 1.525188, loss_ss: 1.035477, loss_d: 0.489711
0.7280 --- loss: 1.926572, loss_ss: 1.359708, loss_d: 0.566864
0.7663 --- loss: 1.572853, loss_ss: 1.090227, loss_d: 0.482625
0.8046 --- loss: 1.475550, loss_ss: 1.154977, loss_d: 0.320573
0.8429 --- loss: 1.505956, loss_ss: 1.146264, loss_d: 0.359692
0.8812 --- loss: 1.562832, loss_ss: 1.158216, loss_d: 0.404616
0.9195 --- loss: 1.582734, loss_ss: 1.324157, loss_d: 0.258578
0.9579 --- loss: 1.392602, loss_ss: 1.142574, loss_d: 0.250028
0.9962 --- loss: 1.416289, loss_ss: 1.182877, loss_d: 0.233412
Epoch finished! Loss: 1.663863661656013
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 2.318970, loss_ss: 0.840716, loss_d: 1.478254
0.0383 --- loss: 1.619222, loss_ss: 1.244075, loss_d: 0.375147
0.0766 --- loss: 1.776108, loss_ss: 1.312070, loss_d: 0.464038
0.1149 --- loss: 1.615578, loss_ss: 1.245226, loss_d: 0.370352
0.1533 --- loss: 1.536782, loss_ss: 1.190283, loss_d: 0.346499
0.1916 --- loss: 1.339701, loss_ss: 1.031478, loss_d: 0.308223
0.2299 --- loss: 1.492771, loss_ss: 1.128186, loss_d: 0.364585
0.2682 --- loss: 1.459981, loss_ss: 1.041902, loss_d: 0.418079
0.3065 --- loss: 1.471424, loss_ss: 1.164161, loss_d: 0.307263
0.3448 --- loss: 1.599530, loss_ss: 1.257613, loss_d: 0.341917
0.3831 --- loss: 1.410843, loss_ss: 0.985192, loss_d: 0.425651
0.4215 --- loss: 1.713615, loss_ss: 1.304260, loss_d: 0.409355
0.4598 --- loss: 1.381984, loss_ss: 0.942236, loss_d: 0.439748
0.4981 --- loss: 1.956673, loss_ss: 1.436407, loss_d: 0.520266
0.5364 --- loss: 1.729199, loss_ss: 1.316934, loss_d: 0.412265
0.5747 --- loss: 1.504622, loss_ss: 1.219669, loss_d: 0.284953
0.6130 --- loss: 1.459880, loss_ss: 1.233253, loss_d: 0.226627
0.6513 --- loss: 1.490305, loss_ss: 1.043714, loss_d: 0.446591
0.6897 --- loss: 1.592505, loss_ss: 1.345267, loss_d: 0.247237
0.7280 --- loss: 1.284822, loss_ss: 0.937858, loss_d: 0.346964
0.7663 --- loss: 1.668841, loss_ss: 0.958763, loss_d: 0.710078
0.8046 --- loss: 1.331515, loss_ss: 1.057469, loss_d: 0.274046
0.8429 --- loss: 1.842516, loss_ss: 1.219773, loss_d: 0.622743
0.8812 --- loss: 1.647382, loss_ss: 1.238024, loss_d: 0.409358
0.9195 --- loss: 1.805046, loss_ss: 1.238072, loss_d: 0.566974
0.9579 --- loss: 1.622705, loss_ss: 1.297359, loss_d: 0.325346
0.9962 --- loss: 1.559220, loss_ss: 1.128619, loss_d: 0.430601
Epoch finished! Loss: 1.60618809232345
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.536715, loss_ss: 1.289064, loss_d: 0.247651
0.0383 --- loss: 1.591289, loss_ss: 1.351643, loss_d: 0.239646
0.0766 --- loss: 1.213093, loss_ss: 0.918983, loss_d: 0.294110
0.1149 --- loss: 1.322087, loss_ss: 0.978730, loss_d: 0.343357
0.1533 --- loss: 1.519833, loss_ss: 1.259546, loss_d: 0.260287
0.1916 --- loss: 1.620781, loss_ss: 0.984425, loss_d: 0.636356
0.2299 --- loss: 1.963432, loss_ss: 1.177707, loss_d: 0.785724
0.2682 --- loss: 1.268710, loss_ss: 0.993132, loss_d: 0.275578
0.3065 --- loss: 2.244652, loss_ss: 1.129189, loss_d: 1.115463
0.3448 --- loss: 1.590129, loss_ss: 0.930903, loss_d: 0.659227
0.3831 --- loss: 1.371083, loss_ss: 1.046285, loss_d: 0.324798
0.4215 --- loss: 1.764587, loss_ss: 1.097668, loss_d: 0.666918
0.4598 --- loss: 1.429013, loss_ss: 1.140846, loss_d: 0.288167
0.4981 --- loss: 1.797348, loss_ss: 1.102199, loss_d: 0.695149
0.5364 --- loss: 1.944740, loss_ss: 1.552315, loss_d: 0.392425
0.5747 --- loss: 1.669012, loss_ss: 1.088214, loss_d: 0.580798
0.6130 --- loss: 1.616707, loss_ss: 1.268663, loss_d: 0.348043
0.6513 --- loss: 1.239753, loss_ss: 0.929501, loss_d: 0.310252
0.6897 --- loss: 1.323057, loss_ss: 0.943357, loss_d: 0.379700
0.7280 --- loss: 1.639898, loss_ss: 1.011983, loss_d: 0.627915
0.7663 --- loss: 1.741872, loss_ss: 1.368258, loss_d: 0.373613
0.8046 --- loss: 1.526579, loss_ss: 1.170037, loss_d: 0.356542
0.8429 --- loss: 1.764696, loss_ss: 0.948798, loss_d: 0.815898
0.8812 --- loss: 1.657112, loss_ss: 1.158443, loss_d: 0.498669
0.9195 --- loss: 1.465719, loss_ss: 1.049792, loss_d: 0.415927
0.9579 --- loss: 1.874470, loss_ss: 1.041310, loss_d: 0.833160
0.9962 --- loss: 1.524958, loss_ss: 1.110134, loss_d: 0.414824
Epoch finished! Loss: 1.5535648685235244
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.763762, loss_ss: 1.465899, loss_d: 0.297863
0.0383 --- loss: 1.111245, loss_ss: 0.931262, loss_d: 0.179982
0.0766 --- loss: 1.569699, loss_ss: 1.269719, loss_d: 0.299980
0.1149 --- loss: 2.219568, loss_ss: 1.345539, loss_d: 0.874029
0.1533 --- loss: 1.220142, loss_ss: 0.925665, loss_d: 0.294478
0.1916 --- loss: 1.366490, loss_ss: 1.022733, loss_d: 0.343757
0.2299 --- loss: 1.498550, loss_ss: 1.287839, loss_d: 0.210711
0.2682 --- loss: 2.081555, loss_ss: 1.378025, loss_d: 0.703530
0.3065 --- loss: 1.900952, loss_ss: 1.134668, loss_d: 0.766284
0.3448 --- loss: 1.312327, loss_ss: 0.957812, loss_d: 0.354515
0.3831 --- loss: 1.253174, loss_ss: 0.950647, loss_d: 0.302526
0.4215 --- loss: 1.457650, loss_ss: 1.153067, loss_d: 0.304583
0.4598 --- loss: 1.401720, loss_ss: 1.143466, loss_d: 0.258254
0.4981 --- loss: 1.654606, loss_ss: 1.154720, loss_d: 0.499886
0.5364 --- loss: 1.376533, loss_ss: 1.095205, loss_d: 0.281327
0.5747 --- loss: 1.386792, loss_ss: 1.132552, loss_d: 0.254241
0.6130 --- loss: 1.690984, loss_ss: 1.030334, loss_d: 0.660650
0.6513 --- loss: 1.532387, loss_ss: 1.075143, loss_d: 0.457245
0.6897 --- loss: 1.544245, loss_ss: 0.983820, loss_d: 0.560425
0.7280 --- loss: 1.486459, loss_ss: 0.926554, loss_d: 0.559905
0.7663 --- loss: 1.579573, loss_ss: 1.250689, loss_d: 0.328884
0.8046 --- loss: 1.982995, loss_ss: 1.588513, loss_d: 0.394482
0.8429 --- loss: 1.818942, loss_ss: 1.026996, loss_d: 0.791946
0.8812 --- loss: 1.231937, loss_ss: 0.902219, loss_d: 0.329718
0.9195 --- loss: 1.647021, loss_ss: 1.239847, loss_d: 0.407174
0.9579 --- loss: 1.657423, loss_ss: 1.242262, loss_d: 0.415161
0.9962 --- loss: 1.399207, loss_ss: 1.159449, loss_d: 0.239757
Epoch finished! Loss: 1.5203146292613103
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.827109, loss_ss: 1.444923, loss_d: 0.382186
0.0383 --- loss: 1.395888, loss_ss: 1.083838, loss_d: 0.312050
0.0766 --- loss: 1.433514, loss_ss: 0.992171, loss_d: 0.441343
0.1149 --- loss: 1.416433, loss_ss: 0.935641, loss_d: 0.480793
0.1533 --- loss: 1.274679, loss_ss: 0.870282, loss_d: 0.404397
0.1916 --- loss: 1.492428, loss_ss: 1.188581, loss_d: 0.303848
0.2299 --- loss: 1.440525, loss_ss: 1.130436, loss_d: 0.310089
0.2682 --- loss: 1.357131, loss_ss: 0.956864, loss_d: 0.400267
0.3065 --- loss: 1.822468, loss_ss: 1.154034, loss_d: 0.668434
0.3448 --- loss: 1.562640, loss_ss: 1.275548, loss_d: 0.287091
0.3831 --- loss: 1.222571, loss_ss: 0.908482, loss_d: 0.314089
0.4215 --- loss: 1.241789, loss_ss: 0.918341, loss_d: 0.323449
0.4598 --- loss: 1.336967, loss_ss: 1.097571, loss_d: 0.239396
0.4981 --- loss: 1.207287, loss_ss: 1.017945, loss_d: 0.189342
0.5364 --- loss: 1.520993, loss_ss: 1.311589, loss_d: 0.209404
0.5747 --- loss: 1.504922, loss_ss: 1.160088, loss_d: 0.344834
0.6130 --- loss: 1.236101, loss_ss: 0.896048, loss_d: 0.340053
0.6513 --- loss: 1.569664, loss_ss: 1.080661, loss_d: 0.489003
0.6897 --- loss: 1.287908, loss_ss: 1.021229, loss_d: 0.266679
0.7280 --- loss: 1.220040, loss_ss: 0.870917, loss_d: 0.349123
0.7663 --- loss: 1.721310, loss_ss: 1.426771, loss_d: 0.294539
0.8046 --- loss: 1.834839, loss_ss: 1.459702, loss_d: 0.375137
0.8429 --- loss: 1.282890, loss_ss: 0.906466, loss_d: 0.376423
0.8812 --- loss: 1.534185, loss_ss: 0.919220, loss_d: 0.614965
0.9195 --- loss: 1.279800, loss_ss: 0.926035, loss_d: 0.353765
0.9579 --- loss: 1.669453, loss_ss: 1.427926, loss_d: 0.241527
0.9962 --- loss: 1.463279, loss_ss: 1.124716, loss_d: 0.338563
Epoch finished! Loss: 1.4864622923044057
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.017702, loss_ss: 0.811900, loss_d: 0.205802
0.0383 --- loss: 1.355903, loss_ss: 1.150548, loss_d: 0.205354
0.0766 --- loss: 1.290080, loss_ss: 0.992942, loss_d: 0.297138
0.1149 --- loss: 1.348357, loss_ss: 1.025289, loss_d: 0.323068
0.1533 --- loss: 1.753712, loss_ss: 1.259627, loss_d: 0.494085
0.1916 --- loss: 1.373806, loss_ss: 0.914870, loss_d: 0.458936
0.2299 --- loss: 1.136819, loss_ss: 0.837789, loss_d: 0.299030
0.2682 --- loss: 1.434177, loss_ss: 0.810120, loss_d: 0.624057
0.3065 --- loss: 1.805928, loss_ss: 0.966234, loss_d: 0.839694
0.3448 --- loss: 1.496472, loss_ss: 1.199974, loss_d: 0.296498
0.3831 --- loss: 1.504483, loss_ss: 1.035588, loss_d: 0.468894
0.4215 --- loss: 1.827169, loss_ss: 1.203537, loss_d: 0.623632
0.4598 --- loss: 1.784540, loss_ss: 1.231156, loss_d: 0.553383
0.4981 --- loss: 1.564531, loss_ss: 0.892165, loss_d: 0.672366
0.5364 --- loss: 1.461768, loss_ss: 1.136428, loss_d: 0.325340
0.5747 --- loss: 1.117075, loss_ss: 0.973085, loss_d: 0.143990
0.6130 --- loss: 1.465756, loss_ss: 1.141680, loss_d: 0.324075
0.6513 --- loss: 1.719880, loss_ss: 0.991043, loss_d: 0.728837
0.6897 --- loss: 1.419608, loss_ss: 1.089746, loss_d: 0.329863
0.7280 --- loss: 1.401788, loss_ss: 1.014021, loss_d: 0.387767
0.7663 --- loss: 1.408004, loss_ss: 1.025482, loss_d: 0.382522
0.8046 --- loss: 1.527943, loss_ss: 1.084484, loss_d: 0.443458
0.8429 --- loss: 1.077556, loss_ss: 0.897259, loss_d: 0.180296
0.8812 --- loss: 1.146772, loss_ss: 0.926042, loss_d: 0.220730
0.9195 --- loss: 1.860565, loss_ss: 1.360710, loss_d: 0.499855
0.9579 --- loss: 1.319528, loss_ss: 1.040838, loss_d: 0.278689
0.9962 --- loss: 1.562362, loss_ss: 1.203790, loss_d: 0.358572
Epoch finished! Loss: 1.4704798056529118
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6976190476190476
             precision    recall  f1-score   support

        0.0       0.52      0.66      0.58       123
        1.0       0.00      0.00      0.00        43
        2.0       0.73      0.94      0.82       400
        3.0       0.84      0.35      0.49       193
        4.0       0.69      0.78      0.73        81

avg / total       0.68      0.70      0.66       840
 


====== chc010-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  85.95  65.85   89.40  51.59     57.86
1  94.88   0.00  100.00   0.00      0.00
2  80.71  93.75   68.86  73.24     82.24
3  83.45  34.72   97.99  83.75     49.08
4  94.52  77.78   96.31  69.23     73.26
Total accuracy: 69.76%
Average sen: 54.42%
Average spec: 90.51%
Macro f1-score: 52.49%
[0.33630413 0.62138963 0.58937949 0.35683352 0.78886503 0.67164165
 0.64390373 0.76861507 0.75583816 0.72623086 0.89365739 0.78261507
 0.71017331 0.68030083 0.57566106 0.68328243 0.85870647 0.75477415
 0.75413591 0.72426468 0.72286433 0.71801782 0.91372842 0.74466896
 0.74252993 0.70455992 0.74090433 0.76762056]
pred: 0.7046952439205987, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.382202, loss_ss: 1.742245, loss_d: 0.639956
0.0383 --- loss: 2.123075, loss_ss: 1.570908, loss_d: 0.552168
0.0767 --- loss: 2.332103, loss_ss: 1.660221, loss_d: 0.671882
0.1150 --- loss: 2.299226, loss_ss: 1.756059, loss_d: 0.543167
0.1534 --- loss: 2.410452, loss_ss: 1.584079, loss_d: 0.826373
0.1917 --- loss: 2.216052, loss_ss: 1.733576, loss_d: 0.482476
0.2301 --- loss: 2.222734, loss_ss: 1.557289, loss_d: 0.665445
0.2684 --- loss: 1.964951, loss_ss: 1.549096, loss_d: 0.415856
0.3067 --- loss: 2.588313, loss_ss: 1.640741, loss_d: 0.947572
0.3451 --- loss: 2.020034, loss_ss: 1.602941, loss_d: 0.417093
0.3834 --- loss: 2.333727, loss_ss: 1.658950, loss_d: 0.674778
0.4218 --- loss: 1.942467, loss_ss: 1.510972, loss_d: 0.431495
0.4601 --- loss: 2.020374, loss_ss: 1.502230, loss_d: 0.518144
0.4985 --- loss: 2.440954, loss_ss: 1.697659, loss_d: 0.743295
0.5368 --- loss: 2.190183, loss_ss: 1.520692, loss_d: 0.669490
0.5752 --- loss: 2.079442, loss_ss: 1.494452, loss_d: 0.584990
0.6135 --- loss: 2.074543, loss_ss: 1.503536, loss_d: 0.571007
0.6518 --- loss: 1.995737, loss_ss: 1.497043, loss_d: 0.498694
0.6902 --- loss: 1.994722, loss_ss: 1.515896, loss_d: 0.478826
0.7285 --- loss: 1.952660, loss_ss: 1.496275, loss_d: 0.456385
0.7669 --- loss: 2.145131, loss_ss: 1.460936, loss_d: 0.684195
0.8052 --- loss: 1.949377, loss_ss: 1.332400, loss_d: 0.616977
0.8436 --- loss: 1.763436, loss_ss: 1.366658, loss_d: 0.396778
0.8819 --- loss: 2.076412, loss_ss: 1.460193, loss_d: 0.616220
0.9202 --- loss: 1.875892, loss_ss: 1.459762, loss_d: 0.416129
0.9586 --- loss: 2.103336, loss_ss: 1.622789, loss_d: 0.480547
0.9969 --- loss: 2.330243, loss_ss: 1.453729, loss_d: 0.876514
Epoch finished! Loss: 2.121444362401962
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.954674, loss_ss: 1.581622, loss_d: 0.373053
0.0383 --- loss: 1.961284, loss_ss: 1.531399, loss_d: 0.429884
0.0767 --- loss: 1.889271, loss_ss: 1.432782, loss_d: 0.456489
0.1150 --- loss: 1.837492, loss_ss: 1.456106, loss_d: 0.381387
0.1534 --- loss: 1.688266, loss_ss: 1.299076, loss_d: 0.389190
0.1917 --- loss: 1.581008, loss_ss: 1.302071, loss_d: 0.278937
0.2301 --- loss: 2.356298, loss_ss: 1.349224, loss_d: 1.007074
0.2684 --- loss: 1.850491, loss_ss: 1.392558, loss_d: 0.457933
0.3067 --- loss: 1.960105, loss_ss: 1.350398, loss_d: 0.609707
0.3451 --- loss: 2.086009, loss_ss: 1.516879, loss_d: 0.569130
0.3834 --- loss: 1.993915, loss_ss: 1.594493, loss_d: 0.399422
0.4218 --- loss: 1.918406, loss_ss: 1.552035, loss_d: 0.366371
0.4601 --- loss: 1.912410, loss_ss: 1.535378, loss_d: 0.377032
0.4985 --- loss: 2.547720, loss_ss: 1.589784, loss_d: 0.957936
0.5368 --- loss: 1.752399, loss_ss: 1.262769, loss_d: 0.489630
0.5752 --- loss: 1.962432, loss_ss: 1.232627, loss_d: 0.729805
0.6135 --- loss: 2.032977, loss_ss: 1.423104, loss_d: 0.609873
0.6518 --- loss: 1.928409, loss_ss: 1.470133, loss_d: 0.458277
0.6902 --- loss: 2.063107, loss_ss: 1.534524, loss_d: 0.528582
0.7285 --- loss: 2.215865, loss_ss: 1.644257, loss_d: 0.571608
0.7669 --- loss: 1.892873, loss_ss: 1.267105, loss_d: 0.625768
0.8052 --- loss: 1.991134, loss_ss: 1.590451, loss_d: 0.400683
0.8436 --- loss: 1.744299, loss_ss: 1.390991, loss_d: 0.353308
0.8819 --- loss: 2.709327, loss_ss: 1.729720, loss_d: 0.979607
0.9202 --- loss: 2.312241, loss_ss: 1.544185, loss_d: 0.768055
0.9586 --- loss: 1.975461, loss_ss: 1.545659, loss_d: 0.429801
0.9969 --- loss: 1.975797, loss_ss: 1.389313, loss_d: 0.586484
Epoch finished! Loss: 1.9773771946246808
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.011857, loss_ss: 1.565323, loss_d: 0.446534
0.0383 --- loss: 2.148325, loss_ss: 1.711559, loss_d: 0.436766
0.0767 --- loss: 2.005272, loss_ss: 1.422809, loss_d: 0.582463
0.1150 --- loss: 1.660845, loss_ss: 1.316279, loss_d: 0.344566
0.1534 --- loss: 1.848832, loss_ss: 1.492690, loss_d: 0.356142
0.1917 --- loss: 1.749786, loss_ss: 1.402314, loss_d: 0.347472
0.2301 --- loss: 1.943362, loss_ss: 1.520045, loss_d: 0.423317
0.2684 --- loss: 2.059199, loss_ss: 1.414542, loss_d: 0.644657
0.3067 --- loss: 1.836670, loss_ss: 1.316921, loss_d: 0.519749
0.3451 --- loss: 2.204655, loss_ss: 1.248239, loss_d: 0.956416
0.3834 --- loss: 2.132368, loss_ss: 1.579602, loss_d: 0.552766
0.4218 --- loss: 1.931932, loss_ss: 1.372450, loss_d: 0.559482
0.4601 --- loss: 2.416908, loss_ss: 1.232244, loss_d: 1.184663
0.4985 --- loss: 1.507080, loss_ss: 1.171603, loss_d: 0.335478
0.5368 --- loss: 1.817723, loss_ss: 1.487899, loss_d: 0.329824
0.5752 --- loss: 1.996127, loss_ss: 1.612468, loss_d: 0.383659
0.6135 --- loss: 1.800155, loss_ss: 1.278200, loss_d: 0.521955
0.6518 --- loss: 2.130392, loss_ss: 1.377915, loss_d: 0.752476
0.6902 --- loss: 1.990964, loss_ss: 1.492123, loss_d: 0.498840
0.7285 --- loss: 1.661975, loss_ss: 1.299555, loss_d: 0.362419
0.7669 --- loss: 1.772106, loss_ss: 1.343929, loss_d: 0.428177
0.8052 --- loss: 2.406687, loss_ss: 1.546445, loss_d: 0.860242
0.8436 --- loss: 2.023927, loss_ss: 1.496731, loss_d: 0.527196
0.8819 --- loss: 1.857264, loss_ss: 1.343706, loss_d: 0.513558
0.9202 --- loss: 1.798779, loss_ss: 1.262457, loss_d: 0.536322
0.9586 --- loss: 1.816077, loss_ss: 1.487906, loss_d: 0.328171
0.9969 --- loss: 1.838369, loss_ss: 1.472882, loss_d: 0.365487
Epoch finished! Loss: 1.9365619466854975
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.036204, loss_ss: 1.683924, loss_d: 0.352280
0.0383 --- loss: 1.796927, loss_ss: 1.453827, loss_d: 0.343099
0.0767 --- loss: 1.684627, loss_ss: 1.350302, loss_d: 0.334325
0.1150 --- loss: 1.830342, loss_ss: 1.391534, loss_d: 0.438807
0.1534 --- loss: 1.916759, loss_ss: 1.453703, loss_d: 0.463056
0.1917 --- loss: 1.981444, loss_ss: 1.496389, loss_d: 0.485055
0.2301 --- loss: 2.127173, loss_ss: 1.513431, loss_d: 0.613742
0.2684 --- loss: 1.794345, loss_ss: 1.401833, loss_d: 0.392513
0.3067 --- loss: 1.899521, loss_ss: 1.471956, loss_d: 0.427566
0.3451 --- loss: 1.593592, loss_ss: 1.251217, loss_d: 0.342375
0.3834 --- loss: 1.841436, loss_ss: 1.504576, loss_d: 0.336860
0.4218 --- loss: 1.560311, loss_ss: 1.168772, loss_d: 0.391539
0.4601 --- loss: 1.871128, loss_ss: 1.480887, loss_d: 0.390241
0.4985 --- loss: 1.663749, loss_ss: 1.337516, loss_d: 0.326233
0.5368 --- loss: 1.799410, loss_ss: 1.327411, loss_d: 0.471999
0.5752 --- loss: 1.997226, loss_ss: 1.476675, loss_d: 0.520550
0.6135 --- loss: 1.588201, loss_ss: 1.154380, loss_d: 0.433820
0.6518 --- loss: 2.481856, loss_ss: 1.723090, loss_d: 0.758766
0.6902 --- loss: 1.761178, loss_ss: 1.137389, loss_d: 0.623789
0.7285 --- loss: 1.885293, loss_ss: 1.249663, loss_d: 0.635630
0.7669 --- loss: 1.552511, loss_ss: 1.126384, loss_d: 0.426126
0.8052 --- loss: 2.024982, loss_ss: 1.331728, loss_d: 0.693254
0.8436 --- loss: 1.882850, loss_ss: 1.495747, loss_d: 0.387103
0.8819 --- loss: 1.716604, loss_ss: 1.430018, loss_d: 0.286586
0.9202 --- loss: 1.655997, loss_ss: 1.353327, loss_d: 0.302671
0.9586 --- loss: 1.870950, loss_ss: 1.148979, loss_d: 0.721970
0.9969 --- loss: 2.019536, loss_ss: 1.457383, loss_d: 0.562154
Epoch finished! Loss: 1.8812240403432112
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.128340, loss_ss: 1.392037, loss_d: 0.736303
0.0383 --- loss: 1.858953, loss_ss: 1.253284, loss_d: 0.605669
0.0767 --- loss: 1.790695, loss_ss: 1.430351, loss_d: 0.360344
0.1150 --- loss: 1.767824, loss_ss: 1.462792, loss_d: 0.305032
0.1534 --- loss: 2.274077, loss_ss: 1.445933, loss_d: 0.828144
0.1917 --- loss: 1.907733, loss_ss: 1.319473, loss_d: 0.588260
0.2301 --- loss: 1.321162, loss_ss: 1.033080, loss_d: 0.288081
0.2684 --- loss: 1.607462, loss_ss: 1.168719, loss_d: 0.438743
0.3067 --- loss: 1.755062, loss_ss: 1.314556, loss_d: 0.440506
0.3451 --- loss: 1.886836, loss_ss: 1.428808, loss_d: 0.458027
0.3834 --- loss: 1.665529, loss_ss: 1.233444, loss_d: 0.432085
0.4218 --- loss: 2.353682, loss_ss: 1.375741, loss_d: 0.977941
0.4601 --- loss: 1.796498, loss_ss: 1.388916, loss_d: 0.407582
0.4985 --- loss: 1.859045, loss_ss: 1.322507, loss_d: 0.536539
0.5368 --- loss: 1.658819, loss_ss: 1.278977, loss_d: 0.379841
0.5752 --- loss: 2.070019, loss_ss: 1.313987, loss_d: 0.756031
0.6135 --- loss: 1.879059, loss_ss: 1.391180, loss_d: 0.487879
0.6518 --- loss: 1.928100, loss_ss: 1.509522, loss_d: 0.418578
0.6902 --- loss: 1.728472, loss_ss: 1.305589, loss_d: 0.422882
0.7285 --- loss: 1.741654, loss_ss: 1.395862, loss_d: 0.345792
0.7669 --- loss: 1.560666, loss_ss: 1.230853, loss_d: 0.329813
0.8052 --- loss: 1.861195, loss_ss: 1.379280, loss_d: 0.481915
0.8436 --- loss: 1.945316, loss_ss: 1.237141, loss_d: 0.708174
0.8819 --- loss: 1.525426, loss_ss: 1.159242, loss_d: 0.366185
0.9202 --- loss: 1.607578, loss_ss: 1.168882, loss_d: 0.438696
0.9586 --- loss: 1.934620, loss_ss: 1.491043, loss_d: 0.443577
0.9969 --- loss: 1.483451, loss_ss: 1.083289, loss_d: 0.400162
Epoch finished! Loss: 1.7892002422076005
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.785398, loss_ss: 1.119656, loss_d: 0.665743
0.0383 --- loss: 1.624674, loss_ss: 1.099579, loss_d: 0.525095
0.0767 --- loss: 1.821096, loss_ss: 1.103102, loss_d: 0.717995
0.1150 --- loss: 1.858810, loss_ss: 1.448422, loss_d: 0.410388
0.1534 --- loss: 1.590676, loss_ss: 1.066758, loss_d: 0.523918
0.1917 --- loss: 1.533138, loss_ss: 1.161583, loss_d: 0.371554
0.2301 --- loss: 1.753623, loss_ss: 1.107728, loss_d: 0.645895
0.2684 --- loss: 1.617983, loss_ss: 1.254697, loss_d: 0.363286
0.3067 --- loss: 1.629295, loss_ss: 1.267090, loss_d: 0.362205
0.3451 --- loss: 1.512522, loss_ss: 1.078280, loss_d: 0.434242
0.3834 --- loss: 1.407296, loss_ss: 1.098266, loss_d: 0.309030
0.4218 --- loss: 1.940700, loss_ss: 1.522601, loss_d: 0.418099
0.4601 --- loss: 1.567840, loss_ss: 1.144225, loss_d: 0.423615
0.4985 --- loss: 1.852010, loss_ss: 1.136342, loss_d: 0.715668
0.5368 --- loss: 1.643959, loss_ss: 0.899859, loss_d: 0.744100
0.5752 --- loss: 1.183249, loss_ss: 0.823825, loss_d: 0.359425
0.6135 --- loss: 1.664190, loss_ss: 1.260994, loss_d: 0.403196
0.6518 --- loss: 1.532223, loss_ss: 1.118318, loss_d: 0.413904
0.6902 --- loss: 1.711525, loss_ss: 1.373017, loss_d: 0.338509
0.7285 --- loss: 1.933825, loss_ss: 1.206792, loss_d: 0.727033
0.7669 --- loss: 1.388770, loss_ss: 1.010651, loss_d: 0.378119
0.8052 --- loss: 1.561427, loss_ss: 1.032202, loss_d: 0.529224
0.8436 --- loss: 1.563514, loss_ss: 1.193991, loss_d: 0.369524
0.8819 --- loss: 1.483770, loss_ss: 1.159558, loss_d: 0.324212
0.9202 --- loss: 1.904494, loss_ss: 1.287364, loss_d: 0.617130
0.9586 --- loss: 1.492164, loss_ss: 0.989059, loss_d: 0.503106
0.9969 --- loss: 1.562751, loss_ss: 1.244570, loss_d: 0.318181
Epoch finished! Loss: 1.6835317886792696
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.211959, loss_ss: 0.906053, loss_d: 0.305905
0.0383 --- loss: 1.536334, loss_ss: 1.185843, loss_d: 0.350491
0.0767 --- loss: 1.777572, loss_ss: 1.113098, loss_d: 0.664474
0.1150 --- loss: 1.420170, loss_ss: 1.081889, loss_d: 0.338281
0.1534 --- loss: 1.540013, loss_ss: 1.173674, loss_d: 0.366339
0.1917 --- loss: 1.837635, loss_ss: 1.271678, loss_d: 0.565957
0.2301 --- loss: 1.540407, loss_ss: 1.160779, loss_d: 0.379628
0.2684 --- loss: 1.495223, loss_ss: 0.929019, loss_d: 0.566204
0.3067 --- loss: 1.220656, loss_ss: 0.947358, loss_d: 0.273298
0.3451 --- loss: 1.782170, loss_ss: 1.173621, loss_d: 0.608548
0.3834 --- loss: 1.616467, loss_ss: 1.139449, loss_d: 0.477018
0.4218 --- loss: 1.631045, loss_ss: 1.207220, loss_d: 0.423825
0.4601 --- loss: 1.396120, loss_ss: 1.000551, loss_d: 0.395570
0.4985 --- loss: 1.506363, loss_ss: 0.978276, loss_d: 0.528087
0.5368 --- loss: 1.844104, loss_ss: 1.433950, loss_d: 0.410154
0.5752 --- loss: 1.486651, loss_ss: 1.179327, loss_d: 0.307323
0.6135 --- loss: 1.301009, loss_ss: 1.012414, loss_d: 0.288595
0.6518 --- loss: 1.937227, loss_ss: 1.118488, loss_d: 0.818739
0.6902 --- loss: 1.615360, loss_ss: 1.170913, loss_d: 0.444446
0.7285 --- loss: 1.622355, loss_ss: 1.114409, loss_d: 0.507946
0.7669 --- loss: 1.412325, loss_ss: 1.084192, loss_d: 0.328132
0.8052 --- loss: 1.442559, loss_ss: 1.113109, loss_d: 0.329450
0.8436 --- loss: 1.882809, loss_ss: 1.259402, loss_d: 0.623407
0.8819 --- loss: 2.079941, loss_ss: 1.275017, loss_d: 0.804924
0.9202 --- loss: 1.632818, loss_ss: 0.996509, loss_d: 0.636309
0.9586 --- loss: 1.314491, loss_ss: 0.927775, loss_d: 0.386716
0.9969 --- loss: 1.331699, loss_ss: 0.904152, loss_d: 0.427547
Epoch finished! Loss: 1.6289205532807571
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.039852, loss_ss: 1.555420, loss_d: 0.484432
0.0383 --- loss: 1.606014, loss_ss: 1.143774, loss_d: 0.462240
0.0767 --- loss: 1.543215, loss_ss: 0.891471, loss_d: 0.651744
0.1150 --- loss: 1.591755, loss_ss: 1.227861, loss_d: 0.363894
0.1534 --- loss: 1.437487, loss_ss: 0.991796, loss_d: 0.445690
0.1917 --- loss: 1.762425, loss_ss: 1.371089, loss_d: 0.391335
0.2301 --- loss: 1.201551, loss_ss: 0.799547, loss_d: 0.402005
0.2684 --- loss: 2.046446, loss_ss: 1.496341, loss_d: 0.550105
0.3067 --- loss: 1.944101, loss_ss: 1.086550, loss_d: 0.857552
0.3451 --- loss: 1.384876, loss_ss: 0.944055, loss_d: 0.440821
0.3834 --- loss: 1.328148, loss_ss: 1.016951, loss_d: 0.311197
0.4218 --- loss: 1.455192, loss_ss: 1.132502, loss_d: 0.322690
0.4601 --- loss: 1.485664, loss_ss: 1.028913, loss_d: 0.456751
0.4985 --- loss: 1.648861, loss_ss: 1.128433, loss_d: 0.520428
0.5368 --- loss: 1.867123, loss_ss: 1.333937, loss_d: 0.533186
0.5752 --- loss: 1.673084, loss_ss: 1.245686, loss_d: 0.427398
0.6135 --- loss: 2.158938, loss_ss: 1.054814, loss_d: 1.104124
0.6518 --- loss: 1.401859, loss_ss: 1.095511, loss_d: 0.306348
0.6902 --- loss: 1.556659, loss_ss: 1.247136, loss_d: 0.309522
0.7285 --- loss: 1.572946, loss_ss: 1.131855, loss_d: 0.441091
0.7669 --- loss: 1.537573, loss_ss: 1.109336, loss_d: 0.428236
0.8052 --- loss: 1.798992, loss_ss: 1.005894, loss_d: 0.793098
0.8436 --- loss: 1.290534, loss_ss: 0.877713, loss_d: 0.412821
0.8819 --- loss: 1.484423, loss_ss: 1.105684, loss_d: 0.378739
0.9202 --- loss: 1.583510, loss_ss: 1.036677, loss_d: 0.546833
0.9586 --- loss: 1.783978, loss_ss: 1.298681, loss_d: 0.485297
0.9969 --- loss: 1.288134, loss_ss: 0.951025, loss_d: 0.337109
Epoch finished! Loss: 1.5881305552445926
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.454121, loss_ss: 1.042099, loss_d: 0.412022
0.0383 --- loss: 1.477000, loss_ss: 1.142504, loss_d: 0.334496
0.0767 --- loss: 1.697602, loss_ss: 1.154632, loss_d: 0.542970
0.1150 --- loss: 1.448009, loss_ss: 1.117545, loss_d: 0.330464
0.1534 --- loss: 1.925618, loss_ss: 1.552066, loss_d: 0.373552
0.1917 --- loss: 1.510190, loss_ss: 1.006411, loss_d: 0.503779
0.2301 --- loss: 1.542828, loss_ss: 1.069767, loss_d: 0.473061
0.2684 --- loss: 1.369444, loss_ss: 0.885207, loss_d: 0.484237
0.3067 --- loss: 1.590586, loss_ss: 1.126841, loss_d: 0.463745
0.3451 --- loss: 1.390773, loss_ss: 1.061274, loss_d: 0.329499
0.3834 --- loss: 1.485034, loss_ss: 1.133391, loss_d: 0.351643
0.4218 --- loss: 1.416276, loss_ss: 1.018543, loss_d: 0.397733
0.4601 --- loss: 1.849617, loss_ss: 1.453376, loss_d: 0.396240
0.4985 --- loss: 1.397321, loss_ss: 1.053134, loss_d: 0.344188
0.5368 --- loss: 1.481785, loss_ss: 1.129752, loss_d: 0.352033
0.5752 --- loss: 1.464583, loss_ss: 0.981463, loss_d: 0.483120
0.6135 --- loss: 1.792729, loss_ss: 1.478087, loss_d: 0.314643
0.6518 --- loss: 1.621391, loss_ss: 1.145655, loss_d: 0.475737
0.6902 --- loss: 1.663813, loss_ss: 1.248325, loss_d: 0.415488
0.7285 --- loss: 1.975568, loss_ss: 1.200459, loss_d: 0.775108
0.7669 --- loss: 1.249195, loss_ss: 0.908189, loss_d: 0.341006
0.8052 --- loss: 1.407885, loss_ss: 1.073599, loss_d: 0.334285
0.8436 --- loss: 1.697037, loss_ss: 1.335095, loss_d: 0.361941
0.8819 --- loss: 1.287106, loss_ss: 0.921814, loss_d: 0.365292
0.9202 --- loss: 1.631827, loss_ss: 1.270861, loss_d: 0.360965
0.9586 --- loss: 1.433223, loss_ss: 1.036055, loss_d: 0.397168
0.9969 --- loss: 1.253035, loss_ss: 0.891101, loss_d: 0.361934
Epoch finished! Loss: 1.5715479575670683
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.362537, loss_ss: 0.831427, loss_d: 0.531110
0.0383 --- loss: 1.706666, loss_ss: 1.288777, loss_d: 0.417888
0.0767 --- loss: 1.680711, loss_ss: 1.123949, loss_d: 0.556761
0.1150 --- loss: 1.620616, loss_ss: 1.205485, loss_d: 0.415131
0.1534 --- loss: 1.370774, loss_ss: 0.836679, loss_d: 0.534096
0.1917 --- loss: 1.439837, loss_ss: 1.070264, loss_d: 0.369573
0.2301 --- loss: 1.271412, loss_ss: 0.954863, loss_d: 0.316548
0.2684 --- loss: 1.455193, loss_ss: 1.146852, loss_d: 0.308341
0.3067 --- loss: 1.624924, loss_ss: 1.103132, loss_d: 0.521792
0.3451 --- loss: 1.540250, loss_ss: 1.102247, loss_d: 0.438003
0.3834 --- loss: 1.432760, loss_ss: 0.962165, loss_d: 0.470595
0.4218 --- loss: 1.702312, loss_ss: 1.001590, loss_d: 0.700723
0.4601 --- loss: 1.690150, loss_ss: 1.229213, loss_d: 0.460937
0.4985 --- loss: 1.470472, loss_ss: 0.900781, loss_d: 0.569692
0.5368 --- loss: 1.198868, loss_ss: 0.932001, loss_d: 0.266866
0.5752 --- loss: 1.551462, loss_ss: 1.170644, loss_d: 0.380818
0.6135 --- loss: 1.429229, loss_ss: 1.097844, loss_d: 0.331385
0.6518 --- loss: 1.420882, loss_ss: 0.982063, loss_d: 0.438819
0.6902 --- loss: 1.413311, loss_ss: 1.102687, loss_d: 0.310623
0.7285 --- loss: 1.598220, loss_ss: 1.085790, loss_d: 0.512430
0.7669 --- loss: 1.292827, loss_ss: 1.011234, loss_d: 0.281593
0.8052 --- loss: 1.786700, loss_ss: 1.238266, loss_d: 0.548434
0.8436 --- loss: 1.410023, loss_ss: 1.124089, loss_d: 0.285934
0.8819 --- loss: 1.417834, loss_ss: 0.970816, loss_d: 0.447018
0.9202 --- loss: 1.572464, loss_ss: 1.144421, loss_d: 0.428043
0.9586 --- loss: 1.560874, loss_ss: 1.005663, loss_d: 0.555210
0.9969 --- loss: 1.338203, loss_ss: 1.021823, loss_d: 0.316379
Epoch finished! Loss: 1.537491966669376
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.23333333333333334
             precision    recall  f1-score   support

        0.0       0.18      0.10      0.12        63
        1.0       0.00      0.00      0.00        22
        2.0       0.00      0.00      0.00       541
        3.0       0.24      1.00      0.38       204
        4.0       0.00      0.00      0.00        70

avg / total       0.07      0.23      0.10       900
 


====== chc012-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  90.67    9.52   96.77  18.18      12.5
1  97.56    0.00  100.00   0.00       0.0
2  39.89    0.00  100.00   0.00       0.0
3  26.33  100.00    4.74  23.53      38.1
4  92.22    0.00  100.00   0.00       0.0
Total accuracy: 23.33%
Average sen: 21.90%
Average spec: 80.30%
Macro f1-score: 10.12%
[0.52471274 0.52471274 0.52471274 0.52757138 0.52471274 0.52471274
 0.54048544 0.53736115 0.52471274 0.52471274 0.52471274 0.52471274
 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274
 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274
 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274 0.52471274]
pred: 0.5257553994655609, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.435991, loss_ss: 1.754214, loss_d: 0.681777
0.0384 --- loss: 2.202358, loss_ss: 1.648516, loss_d: 0.553842
0.0767 --- loss: 1.885531, loss_ss: 1.554599, loss_d: 0.330932
0.1151 --- loss: 2.034760, loss_ss: 1.568911, loss_d: 0.465849
0.1534 --- loss: 1.836141, loss_ss: 1.484980, loss_d: 0.351161
0.1918 --- loss: 1.868627, loss_ss: 1.613892, loss_d: 0.254735
0.2301 --- loss: 2.058765, loss_ss: 1.524619, loss_d: 0.534146
0.2685 --- loss: 1.927466, loss_ss: 1.497664, loss_d: 0.429802
0.3069 --- loss: 1.857401, loss_ss: 1.522954, loss_d: 0.334447
0.3452 --- loss: 1.719312, loss_ss: 1.488510, loss_d: 0.230802
0.3836 --- loss: 2.132805, loss_ss: 1.501580, loss_d: 0.631225
0.4219 --- loss: 2.053955, loss_ss: 1.396323, loss_d: 0.657632
0.4603 --- loss: 1.989434, loss_ss: 1.492210, loss_d: 0.497225
0.4987 --- loss: 2.236711, loss_ss: 1.486798, loss_d: 0.749913
0.5370 --- loss: 1.941621, loss_ss: 1.436576, loss_d: 0.505045
0.5754 --- loss: 1.784172, loss_ss: 1.414408, loss_d: 0.369764
0.6137 --- loss: 2.010131, loss_ss: 1.661207, loss_d: 0.348925
0.6521 --- loss: 1.958564, loss_ss: 1.438142, loss_d: 0.520422
0.6904 --- loss: 2.201367, loss_ss: 1.645499, loss_d: 0.555868
0.7288 --- loss: 2.051977, loss_ss: 1.661205, loss_d: 0.390772
0.7672 --- loss: 1.935220, loss_ss: 1.579078, loss_d: 0.356143
0.8055 --- loss: 2.309395, loss_ss: 1.499981, loss_d: 0.809414
0.8439 --- loss: 2.220549, loss_ss: 1.607124, loss_d: 0.613425
0.8822 --- loss: 2.135567, loss_ss: 1.554200, loss_d: 0.581367
0.9206 --- loss: 2.184482, loss_ss: 1.631353, loss_d: 0.553130
0.9590 --- loss: 2.347082, loss_ss: 1.680281, loss_d: 0.666802
0.9973 --- loss: 2.000719, loss_ss: 1.557333, loss_d: 0.443386
Epoch finished! Loss: 2.0976331527416523
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.898978, loss_ss: 1.450996, loss_d: 0.447982
0.0384 --- loss: 1.813953, loss_ss: 1.483518, loss_d: 0.330435
0.0767 --- loss: 2.260000, loss_ss: 1.351449, loss_d: 0.908551
0.1151 --- loss: 2.001256, loss_ss: 1.592771, loss_d: 0.408484
0.1534 --- loss: 1.895139, loss_ss: 1.367339, loss_d: 0.527800
0.1918 --- loss: 1.893553, loss_ss: 1.503958, loss_d: 0.389595
0.2301 --- loss: 2.140362, loss_ss: 1.564762, loss_d: 0.575600
0.2685 --- loss: 2.052962, loss_ss: 1.430000, loss_d: 0.622962
0.3069 --- loss: 2.108019, loss_ss: 1.489119, loss_d: 0.618900
0.3452 --- loss: 1.787056, loss_ss: 1.323082, loss_d: 0.463974
0.3836 --- loss: 1.727443, loss_ss: 1.320802, loss_d: 0.406641
0.4219 --- loss: 1.900425, loss_ss: 1.427955, loss_d: 0.472470
0.4603 --- loss: 2.586638, loss_ss: 1.697919, loss_d: 0.888719
0.4987 --- loss: 2.214537, loss_ss: 1.539471, loss_d: 0.675065
0.5370 --- loss: 2.551590, loss_ss: 1.493778, loss_d: 1.057812
0.5754 --- loss: 1.978891, loss_ss: 1.506660, loss_d: 0.472231
0.6137 --- loss: 1.423651, loss_ss: 1.103131, loss_d: 0.320520
0.6521 --- loss: 1.765004, loss_ss: 1.242846, loss_d: 0.522158
0.6904 --- loss: 1.876266, loss_ss: 1.285782, loss_d: 0.590484
0.7288 --- loss: 1.930636, loss_ss: 1.479476, loss_d: 0.451161
0.7672 --- loss: 2.676377, loss_ss: 1.505764, loss_d: 1.170613
0.8055 --- loss: 1.976692, loss_ss: 1.286970, loss_d: 0.689722
0.8439 --- loss: 2.109484, loss_ss: 1.550729, loss_d: 0.558755
0.8822 --- loss: 1.669538, loss_ss: 1.185895, loss_d: 0.483643
0.9206 --- loss: 1.803998, loss_ss: 1.396418, loss_d: 0.407580
0.9590 --- loss: 1.985167, loss_ss: 1.368750, loss_d: 0.616417
0.9973 --- loss: 1.797592, loss_ss: 1.515091, loss_d: 0.282501
Epoch finished! Loss: 1.989659156707617
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.702682, loss_ss: 1.458036, loss_d: 0.244646
0.0384 --- loss: 1.954418, loss_ss: 1.360135, loss_d: 0.594283
0.0767 --- loss: 1.807852, loss_ss: 1.416809, loss_d: 0.391042
0.1151 --- loss: 2.361290, loss_ss: 1.675039, loss_d: 0.686251
0.1534 --- loss: 1.744855, loss_ss: 1.258672, loss_d: 0.486183
0.1918 --- loss: 1.862290, loss_ss: 1.199534, loss_d: 0.662757
0.2301 --- loss: 2.109977, loss_ss: 1.496667, loss_d: 0.613310
0.2685 --- loss: 1.985757, loss_ss: 1.569611, loss_d: 0.416146
0.3069 --- loss: 1.906240, loss_ss: 1.430985, loss_d: 0.475254
0.3452 --- loss: 1.707136, loss_ss: 1.299955, loss_d: 0.407181
0.3836 --- loss: 1.660988, loss_ss: 1.222731, loss_d: 0.438258
0.4219 --- loss: 1.634461, loss_ss: 1.230574, loss_d: 0.403887
0.4603 --- loss: 2.105412, loss_ss: 1.392564, loss_d: 0.712848
0.4987 --- loss: 1.782796, loss_ss: 1.411553, loss_d: 0.371243
0.5370 --- loss: 1.759590, loss_ss: 1.302856, loss_d: 0.456734
0.5754 --- loss: 1.676047, loss_ss: 1.327522, loss_d: 0.348525
0.6137 --- loss: 1.943436, loss_ss: 1.541804, loss_d: 0.401632
0.6521 --- loss: 2.245497, loss_ss: 1.450693, loss_d: 0.794805
0.6904 --- loss: 1.857376, loss_ss: 1.397762, loss_d: 0.459614
0.7288 --- loss: 2.530075, loss_ss: 1.628032, loss_d: 0.902043
0.7672 --- loss: 1.612180, loss_ss: 1.290297, loss_d: 0.321882
0.8055 --- loss: 1.766459, loss_ss: 1.207536, loss_d: 0.558924
0.8439 --- loss: 1.794489, loss_ss: 1.238689, loss_d: 0.555801
0.8822 --- loss: 1.947806, loss_ss: 1.237676, loss_d: 0.710130
0.9206 --- loss: 1.869288, loss_ss: 1.380285, loss_d: 0.489003
0.9590 --- loss: 1.719326, loss_ss: 1.320701, loss_d: 0.398625
0.9973 --- loss: 1.787717, loss_ss: 1.304049, loss_d: 0.483668
Epoch finished! Loss: 1.8660104242654947
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.691688, loss_ss: 1.303209, loss_d: 0.388478
0.0384 --- loss: 1.536589, loss_ss: 1.233642, loss_d: 0.302946
0.0767 --- loss: 1.546405, loss_ss: 1.155755, loss_d: 0.390651
0.1151 --- loss: 1.790557, loss_ss: 1.342190, loss_d: 0.448367
0.1534 --- loss: 1.596893, loss_ss: 1.199127, loss_d: 0.397766
0.1918 --- loss: 1.910182, loss_ss: 1.475609, loss_d: 0.434572
0.2301 --- loss: 1.612261, loss_ss: 1.156703, loss_d: 0.455559
0.2685 --- loss: 2.171556, loss_ss: 1.210682, loss_d: 0.960874
0.3069 --- loss: 1.542550, loss_ss: 1.183273, loss_d: 0.359277
0.3452 --- loss: 1.861017, loss_ss: 1.117195, loss_d: 0.743822
0.3836 --- loss: 1.840178, loss_ss: 1.211439, loss_d: 0.628738
0.4219 --- loss: 1.728146, loss_ss: 1.268715, loss_d: 0.459431
0.4603 --- loss: 1.721682, loss_ss: 1.220990, loss_d: 0.500692
0.4987 --- loss: 1.755744, loss_ss: 1.268468, loss_d: 0.487277
0.5370 --- loss: 1.300997, loss_ss: 1.023280, loss_d: 0.277716
0.5754 --- loss: 2.087649, loss_ss: 1.438576, loss_d: 0.649074
0.6137 --- loss: 1.897250, loss_ss: 1.284559, loss_d: 0.612691
0.6521 --- loss: 1.751014, loss_ss: 1.337671, loss_d: 0.413343
0.6904 --- loss: 1.461341, loss_ss: 0.926365, loss_d: 0.534976
0.7288 --- loss: 1.571066, loss_ss: 1.190306, loss_d: 0.380760
0.7672 --- loss: 1.842512, loss_ss: 1.299926, loss_d: 0.542586
0.8055 --- loss: 1.480165, loss_ss: 1.039847, loss_d: 0.440318
0.8439 --- loss: 1.406151, loss_ss: 1.025805, loss_d: 0.380347
0.8822 --- loss: 1.656604, loss_ss: 1.243323, loss_d: 0.413281
0.9206 --- loss: 1.896764, loss_ss: 1.339336, loss_d: 0.557428
0.9590 --- loss: 1.633672, loss_ss: 1.263708, loss_d: 0.369963
0.9973 --- loss: 1.920479, loss_ss: 1.161658, loss_d: 0.758821
Epoch finished! Loss: 1.7414184909600479
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.730021, loss_ss: 1.197989, loss_d: 0.532033
0.0384 --- loss: 1.447669, loss_ss: 0.985653, loss_d: 0.462016
0.0767 --- loss: 1.812364, loss_ss: 1.124837, loss_d: 0.687528
0.1151 --- loss: 2.020491, loss_ss: 1.239614, loss_d: 0.780877
0.1534 --- loss: 1.338182, loss_ss: 1.069522, loss_d: 0.268661
0.1918 --- loss: 1.435760, loss_ss: 1.004499, loss_d: 0.431261
0.2301 --- loss: 1.334418, loss_ss: 0.899672, loss_d: 0.434745
0.2685 --- loss: 1.545302, loss_ss: 1.258103, loss_d: 0.287199
0.3069 --- loss: 1.928336, loss_ss: 1.299307, loss_d: 0.629029
0.3452 --- loss: 1.365617, loss_ss: 1.096821, loss_d: 0.268797
0.3836 --- loss: 1.890843, loss_ss: 1.390102, loss_d: 0.500741
0.4219 --- loss: 1.173839, loss_ss: 0.903321, loss_d: 0.270519
0.4603 --- loss: 1.734872, loss_ss: 1.261757, loss_d: 0.473116
0.4987 --- loss: 1.564293, loss_ss: 1.011766, loss_d: 0.552527
0.5370 --- loss: 1.517192, loss_ss: 0.898294, loss_d: 0.618898
0.5754 --- loss: 1.798093, loss_ss: 1.340332, loss_d: 0.457761
0.6137 --- loss: 1.490439, loss_ss: 1.202991, loss_d: 0.287448
0.6521 --- loss: 1.267082, loss_ss: 0.989727, loss_d: 0.277355
0.6904 --- loss: 1.384001, loss_ss: 1.023692, loss_d: 0.360308
0.7288 --- loss: 1.804144, loss_ss: 1.269585, loss_d: 0.534559
0.7672 --- loss: 1.547945, loss_ss: 1.017273, loss_d: 0.530672
0.8055 --- loss: 2.051264, loss_ss: 1.098392, loss_d: 0.952872
0.8439 --- loss: 1.663859, loss_ss: 1.322577, loss_d: 0.341282
0.8822 --- loss: 1.215832, loss_ss: 1.075603, loss_d: 0.140230
0.9206 --- loss: 1.827507, loss_ss: 0.976798, loss_d: 0.850710
0.9590 --- loss: 1.467249, loss_ss: 1.058275, loss_d: 0.408974
0.9973 --- loss: 1.880374, loss_ss: 1.458571, loss_d: 0.421803
Epoch finished! Loss: 1.64402277469635
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.538629, loss_ss: 1.190307, loss_d: 0.348322
0.0384 --- loss: 1.791774, loss_ss: 1.059358, loss_d: 0.732416
0.0767 --- loss: 1.623368, loss_ss: 1.064390, loss_d: 0.558977
0.1151 --- loss: 1.713913, loss_ss: 1.061817, loss_d: 0.652096
0.1534 --- loss: 1.662851, loss_ss: 1.179250, loss_d: 0.483602
0.1918 --- loss: 1.893794, loss_ss: 1.455132, loss_d: 0.438662
0.2301 --- loss: 1.441539, loss_ss: 1.135642, loss_d: 0.305897
0.2685 --- loss: 1.468209, loss_ss: 1.133591, loss_d: 0.334617
0.3069 --- loss: 1.745518, loss_ss: 1.160220, loss_d: 0.585297
0.3452 --- loss: 1.778977, loss_ss: 1.237020, loss_d: 0.541957
0.3836 --- loss: 1.722293, loss_ss: 1.272127, loss_d: 0.450166
0.4219 --- loss: 1.637159, loss_ss: 1.116169, loss_d: 0.520990
0.4603 --- loss: 1.839142, loss_ss: 1.070278, loss_d: 0.768864
0.4987 --- loss: 1.259104, loss_ss: 0.858065, loss_d: 0.401039
0.5370 --- loss: 1.413128, loss_ss: 1.029400, loss_d: 0.383728
0.5754 --- loss: 1.214729, loss_ss: 0.897198, loss_d: 0.317531
0.6137 --- loss: 1.395820, loss_ss: 1.080975, loss_d: 0.314845
0.6521 --- loss: 1.560288, loss_ss: 1.016374, loss_d: 0.543914
0.6904 --- loss: 1.817739, loss_ss: 1.173781, loss_d: 0.643958
0.7288 --- loss: 1.585662, loss_ss: 0.999567, loss_d: 0.586095
0.7672 --- loss: 1.320575, loss_ss: 0.937321, loss_d: 0.383254
0.8055 --- loss: 1.648281, loss_ss: 1.203615, loss_d: 0.444666
0.8439 --- loss: 1.775896, loss_ss: 1.490613, loss_d: 0.285282
0.8822 --- loss: 1.345527, loss_ss: 1.056080, loss_d: 0.289447
0.9206 --- loss: 1.548427, loss_ss: 1.053805, loss_d: 0.494623
0.9590 --- loss: 1.262440, loss_ss: 0.908859, loss_d: 0.353582
0.9973 --- loss: 1.973262, loss_ss: 1.337828, loss_d: 0.635434
Epoch finished! Loss: 1.6104829710263473
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.672987, loss_ss: 1.176488, loss_d: 0.496499
0.0384 --- loss: 1.823149, loss_ss: 1.146177, loss_d: 0.676973
0.0767 --- loss: 1.746792, loss_ss: 1.311575, loss_d: 0.435217
0.1151 --- loss: 1.488049, loss_ss: 1.106036, loss_d: 0.382013
0.1534 --- loss: 1.365120, loss_ss: 1.036909, loss_d: 0.328212
0.1918 --- loss: 1.675775, loss_ss: 1.397077, loss_d: 0.278698
0.2301 --- loss: 1.482235, loss_ss: 1.035775, loss_d: 0.446460
0.2685 --- loss: 1.442039, loss_ss: 1.050233, loss_d: 0.391807
0.3069 --- loss: 2.030517, loss_ss: 1.182008, loss_d: 0.848509
0.3452 --- loss: 1.392128, loss_ss: 1.133889, loss_d: 0.258239
0.3836 --- loss: 1.269532, loss_ss: 0.935858, loss_d: 0.333674
0.4219 --- loss: 1.570949, loss_ss: 1.139567, loss_d: 0.431382
0.4603 --- loss: 1.436037, loss_ss: 1.249231, loss_d: 0.186807
0.4987 --- loss: 1.967652, loss_ss: 1.752963, loss_d: 0.214689
0.5370 --- loss: 1.206809, loss_ss: 0.840165, loss_d: 0.366643
0.5754 --- loss: 1.607889, loss_ss: 1.128316, loss_d: 0.479573
0.6137 --- loss: 2.152455, loss_ss: 1.099431, loss_d: 1.053024
0.6521 --- loss: 1.203675, loss_ss: 0.830924, loss_d: 0.372752
0.6904 --- loss: 1.497719, loss_ss: 1.223424, loss_d: 0.274295
0.7288 --- loss: 1.796521, loss_ss: 1.132079, loss_d: 0.664441
0.7672 --- loss: 1.360717, loss_ss: 0.854048, loss_d: 0.506668
0.8055 --- loss: 1.364601, loss_ss: 1.056247, loss_d: 0.308354
0.8439 --- loss: 2.325710, loss_ss: 1.304243, loss_d: 1.021467
0.8822 --- loss: 2.239442, loss_ss: 1.105220, loss_d: 1.134222
0.9206 --- loss: 1.256786, loss_ss: 0.959501, loss_d: 0.297285
0.9590 --- loss: 1.319704, loss_ss: 0.883666, loss_d: 0.436038
0.9973 --- loss: 1.884106, loss_ss: 1.145131, loss_d: 0.738975
Epoch finished! Loss: 1.555362657400278
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.682951, loss_ss: 1.223818, loss_d: 0.459133
0.0384 --- loss: 1.243534, loss_ss: 0.944693, loss_d: 0.298841
0.0767 --- loss: 1.176230, loss_ss: 0.943239, loss_d: 0.232991
0.1151 --- loss: 1.923748, loss_ss: 1.133315, loss_d: 0.790433
0.1534 --- loss: 1.725461, loss_ss: 1.274160, loss_d: 0.451302
0.1918 --- loss: 1.486750, loss_ss: 0.882447, loss_d: 0.604303
0.2301 --- loss: 2.027510, loss_ss: 1.565601, loss_d: 0.461909
0.2685 --- loss: 1.419641, loss_ss: 1.026494, loss_d: 0.393148
0.3069 --- loss: 1.662554, loss_ss: 1.255950, loss_d: 0.406604
0.3452 --- loss: 1.772343, loss_ss: 1.175873, loss_d: 0.596470
0.3836 --- loss: 1.442679, loss_ss: 1.016084, loss_d: 0.426595
0.4219 --- loss: 1.298835, loss_ss: 1.026864, loss_d: 0.271971
0.4603 --- loss: 1.090193, loss_ss: 0.873313, loss_d: 0.216880
0.4987 --- loss: 1.472927, loss_ss: 1.219337, loss_d: 0.253590
0.5370 --- loss: 1.215917, loss_ss: 0.885381, loss_d: 0.330536
0.5754 --- loss: 1.709876, loss_ss: 1.208693, loss_d: 0.501183
0.6137 --- loss: 1.446527, loss_ss: 1.268887, loss_d: 0.177640
0.6521 --- loss: 1.410998, loss_ss: 1.141030, loss_d: 0.269968
0.6904 --- loss: 1.466273, loss_ss: 1.200214, loss_d: 0.266060
0.7288 --- loss: 1.658790, loss_ss: 1.446481, loss_d: 0.212309
0.7672 --- loss: 1.141888, loss_ss: 0.848617, loss_d: 0.293271
0.8055 --- loss: 1.603100, loss_ss: 1.097916, loss_d: 0.505184
0.8439 --- loss: 1.432988, loss_ss: 1.028896, loss_d: 0.404092
0.8822 --- loss: 1.123060, loss_ss: 0.911719, loss_d: 0.211341
0.9206 --- loss: 2.190106, loss_ss: 1.125410, loss_d: 1.064696
0.9590 --- loss: 1.702999, loss_ss: 1.456732, loss_d: 0.246267
0.9973 --- loss: 1.408829, loss_ss: 1.114136, loss_d: 0.294694
Epoch finished! Loss: 1.560158253633059
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.591451, loss_ss: 1.016448, loss_d: 0.575003
0.0384 --- loss: 1.671554, loss_ss: 1.163502, loss_d: 0.508052
0.0767 --- loss: 1.210574, loss_ss: 1.019213, loss_d: 0.191360
0.1151 --- loss: 1.371968, loss_ss: 0.979213, loss_d: 0.392755
0.1534 --- loss: 1.830295, loss_ss: 1.128821, loss_d: 0.701475
0.1918 --- loss: 1.306874, loss_ss: 1.003607, loss_d: 0.303267
0.2301 --- loss: 1.067078, loss_ss: 0.877784, loss_d: 0.189294
0.2685 --- loss: 1.554272, loss_ss: 1.117709, loss_d: 0.436563
0.3069 --- loss: 1.518484, loss_ss: 1.131371, loss_d: 0.387113
0.3452 --- loss: 1.261215, loss_ss: 0.844719, loss_d: 0.416496
0.3836 --- loss: 1.597077, loss_ss: 0.940014, loss_d: 0.657063
0.4219 --- loss: 1.350049, loss_ss: 1.050246, loss_d: 0.299803
0.4603 --- loss: 1.527530, loss_ss: 1.254135, loss_d: 0.273394
0.4987 --- loss: 1.335197, loss_ss: 1.051908, loss_d: 0.283289
0.5370 --- loss: 1.314364, loss_ss: 1.002622, loss_d: 0.311742
0.5754 --- loss: 1.578688, loss_ss: 1.088900, loss_d: 0.489788
0.6137 --- loss: 1.484918, loss_ss: 1.280046, loss_d: 0.204872
0.6521 --- loss: 1.324797, loss_ss: 0.915543, loss_d: 0.409254
0.6904 --- loss: 1.337325, loss_ss: 0.975206, loss_d: 0.362119
0.7288 --- loss: 1.447935, loss_ss: 1.228798, loss_d: 0.219137
0.7672 --- loss: 1.366233, loss_ss: 1.058388, loss_d: 0.307845
0.8055 --- loss: 1.642280, loss_ss: 1.409655, loss_d: 0.232625
0.8439 --- loss: 1.722339, loss_ss: 1.199521, loss_d: 0.522818
0.8822 --- loss: 1.626061, loss_ss: 1.217463, loss_d: 0.408597
0.9206 --- loss: 1.479135, loss_ss: 1.158924, loss_d: 0.320210
0.9590 --- loss: 1.434874, loss_ss: 0.896905, loss_d: 0.537969
0.9973 --- loss: 1.725295, loss_ss: 1.086667, loss_d: 0.638628
Epoch finished! Loss: 1.514286065560121
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.412712, loss_ss: 1.078179, loss_d: 0.334533
0.0384 --- loss: 1.680109, loss_ss: 0.982630, loss_d: 0.697478
0.0767 --- loss: 1.581152, loss_ss: 1.023006, loss_d: 0.558146
0.1151 --- loss: 1.885730, loss_ss: 1.183728, loss_d: 0.702002
0.1534 --- loss: 1.568944, loss_ss: 1.246295, loss_d: 0.322648
0.1918 --- loss: 1.842471, loss_ss: 0.980376, loss_d: 0.862095
0.2301 --- loss: 1.422455, loss_ss: 1.085585, loss_d: 0.336869
0.2685 --- loss: 1.290190, loss_ss: 0.986747, loss_d: 0.303444
0.3069 --- loss: 1.636894, loss_ss: 1.256529, loss_d: 0.380365
0.3452 --- loss: 1.206025, loss_ss: 0.926191, loss_d: 0.279834
0.3836 --- loss: 1.853316, loss_ss: 1.297638, loss_d: 0.555679
0.4219 --- loss: 1.243531, loss_ss: 0.918058, loss_d: 0.325472
0.4603 --- loss: 1.412120, loss_ss: 0.954735, loss_d: 0.457385
0.4987 --- loss: 1.669470, loss_ss: 1.302924, loss_d: 0.366546
0.5370 --- loss: 1.392200, loss_ss: 1.072501, loss_d: 0.319699
0.5754 --- loss: 1.539381, loss_ss: 1.257234, loss_d: 0.282147
0.6137 --- loss: 1.629417, loss_ss: 1.098657, loss_d: 0.530761
0.6521 --- loss: 1.975315, loss_ss: 1.476008, loss_d: 0.499307
0.6904 --- loss: 1.649377, loss_ss: 1.172583, loss_d: 0.476794
0.7288 --- loss: 1.657845, loss_ss: 1.060175, loss_d: 0.597670
0.7672 --- loss: 1.466955, loss_ss: 1.051035, loss_d: 0.415920
0.8055 --- loss: 1.385319, loss_ss: 0.962713, loss_d: 0.422606
0.8439 --- loss: 1.378373, loss_ss: 1.027989, loss_d: 0.350384
0.8822 --- loss: 1.423034, loss_ss: 1.049434, loss_d: 0.373600
0.9206 --- loss: 1.429750, loss_ss: 1.116756, loss_d: 0.312994
0.9590 --- loss: 1.195860, loss_ss: 0.905307, loss_d: 0.290552
0.9973 --- loss: 1.622536, loss_ss: 1.065127, loss_d: 0.557409
Epoch finished! Loss: 1.489406571479944
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5408602150537635
             precision    recall  f1-score   support

        0.0       0.21      0.62      0.32        69
        1.0       0.14      0.11      0.12        38
        2.0       0.62      0.91      0.74       434
        3.0       1.00      0.26      0.41       228
        4.0       0.00      0.00      0.00       161

avg / total       0.56      0.54      0.47       930
 


====== chc013-nsrr ======

The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  80.11  62.32   81.53   21.29     31.73
1  93.66  10.53   97.20   13.79     11.94
2  69.89  91.47   51.01   62.03     73.93
3  81.83  25.88  100.00  100.00     41.11
4  82.69   0.00  100.00    0.00      0.00
Total accuracy: 54.09%
Average sen: 38.04%
Average spec: 85.95%
Macro f1-score: 31.74%
[0.99999332 0.99999273 0.99998713 0.99998903 0.99998534 0.99998462
 0.99998891 0.99999487 0.99998903 0.99998844 0.99998701 0.99998474
 0.9999876  0.99998724 0.99998748 0.99998832 0.99998868 0.99999595
 0.99999237 0.99999356 0.99998963 0.999982   0.99998713 0.99998856
 0.99998987 0.99999118 0.99998474 0.99998677 0.99998426 0.9999876
 0.99998665]
pred: 0.9999885405263593, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.390080, loss_ss: 1.684998, loss_d: 0.705082
0.0384 --- loss: 2.070151, loss_ss: 1.486995, loss_d: 0.583156
0.0767 --- loss: 2.181226, loss_ss: 1.630304, loss_d: 0.550922
0.1151 --- loss: 2.081728, loss_ss: 1.603463, loss_d: 0.478264
0.1534 --- loss: 1.891979, loss_ss: 1.495560, loss_d: 0.396419
0.1918 --- loss: 1.929993, loss_ss: 1.617362, loss_d: 0.312631
0.2301 --- loss: 1.968359, loss_ss: 1.498048, loss_d: 0.470311
0.2685 --- loss: 2.035683, loss_ss: 1.721189, loss_d: 0.314495
0.3069 --- loss: 2.381057, loss_ss: 1.445042, loss_d: 0.936016
0.3452 --- loss: 2.171851, loss_ss: 1.663773, loss_d: 0.508078
0.3836 --- loss: 1.909749, loss_ss: 1.449667, loss_d: 0.460082
0.4219 --- loss: 1.784060, loss_ss: 1.543255, loss_d: 0.240805
0.4603 --- loss: 2.018492, loss_ss: 1.564350, loss_d: 0.454143
0.4987 --- loss: 2.187352, loss_ss: 1.596140, loss_d: 0.591213
0.5370 --- loss: 2.223137, loss_ss: 1.788135, loss_d: 0.435002
0.5754 --- loss: 2.191818, loss_ss: 1.610826, loss_d: 0.580993
0.6137 --- loss: 1.950798, loss_ss: 1.572899, loss_d: 0.377899
0.6521 --- loss: 2.479396, loss_ss: 1.689797, loss_d: 0.789600
0.6904 --- loss: 2.033426, loss_ss: 1.597610, loss_d: 0.435816
0.7288 --- loss: 1.746449, loss_ss: 1.366374, loss_d: 0.380076
0.7672 --- loss: 1.937282, loss_ss: 1.435717, loss_d: 0.501565
0.8055 --- loss: 2.318655, loss_ss: 1.377233, loss_d: 0.941422
0.8439 --- loss: 1.997245, loss_ss: 1.410571, loss_d: 0.586674
0.8822 --- loss: 1.732249, loss_ss: 1.309121, loss_d: 0.423129
0.9206 --- loss: 2.259629, loss_ss: 1.641776, loss_d: 0.617853
0.9590 --- loss: 2.172805, loss_ss: 1.731069, loss_d: 0.441736
0.9973 --- loss: 1.998147, loss_ss: 1.490550, loss_d: 0.507597
Epoch finished! Loss: 2.1041525716965017
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.114315, loss_ss: 1.448134, loss_d: 0.666181
0.0384 --- loss: 2.327412, loss_ss: 1.619021, loss_d: 0.708391
0.0767 --- loss: 1.991408, loss_ss: 1.536021, loss_d: 0.455387
0.1151 --- loss: 2.182168, loss_ss: 1.484878, loss_d: 0.697290
0.1534 --- loss: 1.974197, loss_ss: 1.287948, loss_d: 0.686249
0.1918 --- loss: 1.665240, loss_ss: 1.390998, loss_d: 0.274241
0.2301 --- loss: 2.050089, loss_ss: 1.568472, loss_d: 0.481617
0.2685 --- loss: 1.939114, loss_ss: 1.374732, loss_d: 0.564382
0.3069 --- loss: 1.803661, loss_ss: 1.430555, loss_d: 0.373105
0.3452 --- loss: 2.402172, loss_ss: 1.736073, loss_d: 0.666099
0.3836 --- loss: 2.011550, loss_ss: 1.566263, loss_d: 0.445288
0.4219 --- loss: 1.862683, loss_ss: 1.454722, loss_d: 0.407961
0.4603 --- loss: 1.758497, loss_ss: 1.416940, loss_d: 0.341557
0.4987 --- loss: 2.047457, loss_ss: 1.491251, loss_d: 0.556205
0.5370 --- loss: 2.123385, loss_ss: 1.698778, loss_d: 0.424608
0.5754 --- loss: 1.771188, loss_ss: 1.414672, loss_d: 0.356516
0.6137 --- loss: 2.207300, loss_ss: 1.772570, loss_d: 0.434730
0.6521 --- loss: 1.641343, loss_ss: 1.317705, loss_d: 0.323638
0.6904 --- loss: 2.009250, loss_ss: 1.521382, loss_d: 0.487868
0.7288 --- loss: 2.061558, loss_ss: 1.611765, loss_d: 0.449793
0.7672 --- loss: 1.725538, loss_ss: 1.332105, loss_d: 0.393432
0.8055 --- loss: 1.839698, loss_ss: 1.266653, loss_d: 0.573046
0.8439 --- loss: 1.821448, loss_ss: 1.363186, loss_d: 0.458261
0.8822 --- loss: 1.934049, loss_ss: 1.459132, loss_d: 0.474917
0.9206 --- loss: 1.797076, loss_ss: 1.250838, loss_d: 0.546239
0.9590 --- loss: 2.033239, loss_ss: 1.521169, loss_d: 0.512070
0.9973 --- loss: 1.760863, loss_ss: 1.342514, loss_d: 0.418349
Epoch finished! Loss: 1.9399511053011969
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.910418, loss_ss: 1.272464, loss_d: 0.637955
0.0384 --- loss: 2.038985, loss_ss: 1.442394, loss_d: 0.596591
0.0767 --- loss: 1.786552, loss_ss: 1.271008, loss_d: 0.515544
0.1151 --- loss: 2.054616, loss_ss: 1.474886, loss_d: 0.579730
0.1534 --- loss: 1.668983, loss_ss: 1.296679, loss_d: 0.372304
0.1918 --- loss: 1.758854, loss_ss: 1.186828, loss_d: 0.572025
0.2301 --- loss: 1.768396, loss_ss: 1.258011, loss_d: 0.510385
0.2685 --- loss: 1.951190, loss_ss: 1.445039, loss_d: 0.506151
0.3069 --- loss: 1.923798, loss_ss: 1.356114, loss_d: 0.567684
0.3452 --- loss: 1.336765, loss_ss: 1.088390, loss_d: 0.248375
0.3836 --- loss: 1.698252, loss_ss: 1.423836, loss_d: 0.274416
0.4219 --- loss: 2.030821, loss_ss: 1.527296, loss_d: 0.503526
0.4603 --- loss: 2.019438, loss_ss: 1.456932, loss_d: 0.562506
0.4987 --- loss: 2.058066, loss_ss: 1.468782, loss_d: 0.589284
0.5370 --- loss: 1.805498, loss_ss: 1.413889, loss_d: 0.391609
0.5754 --- loss: 1.800698, loss_ss: 1.300688, loss_d: 0.500010
0.6137 --- loss: 1.630503, loss_ss: 1.247539, loss_d: 0.382964
0.6521 --- loss: 1.765309, loss_ss: 1.089017, loss_d: 0.676292
0.6904 --- loss: 1.650745, loss_ss: 1.340377, loss_d: 0.310367
0.7288 --- loss: 1.950911, loss_ss: 1.453971, loss_d: 0.496940
0.7672 --- loss: 1.468336, loss_ss: 1.058592, loss_d: 0.409744
0.8055 --- loss: 1.862993, loss_ss: 1.224314, loss_d: 0.638679
0.8439 --- loss: 1.551606, loss_ss: 1.118367, loss_d: 0.433239
0.8822 --- loss: 1.906294, loss_ss: 1.309772, loss_d: 0.596522
0.9206 --- loss: 1.463388, loss_ss: 1.085022, loss_d: 0.378366
0.9590 --- loss: 1.595999, loss_ss: 1.077227, loss_d: 0.518773
0.9973 --- loss: 1.487032, loss_ss: 1.220520, loss_d: 0.266512
Epoch finished! Loss: 1.8008200177779565
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.770669, loss_ss: 1.059290, loss_d: 0.711379
0.0384 --- loss: 1.681788, loss_ss: 1.310379, loss_d: 0.371409
0.0767 --- loss: 1.592172, loss_ss: 1.251478, loss_d: 0.340694
0.1151 --- loss: 2.118912, loss_ss: 1.452377, loss_d: 0.666535
0.1534 --- loss: 1.804821, loss_ss: 1.183402, loss_d: 0.621420
0.1918 --- loss: 1.419306, loss_ss: 1.042161, loss_d: 0.377145
0.2301 --- loss: 1.526956, loss_ss: 1.095808, loss_d: 0.431149
0.2685 --- loss: 1.624070, loss_ss: 1.197613, loss_d: 0.426457
0.3069 --- loss: 1.993343, loss_ss: 1.477983, loss_d: 0.515360
0.3452 --- loss: 1.853792, loss_ss: 1.196913, loss_d: 0.656879
0.3836 --- loss: 1.543097, loss_ss: 1.191972, loss_d: 0.351125
0.4219 --- loss: 1.863724, loss_ss: 1.523423, loss_d: 0.340301
0.4603 --- loss: 1.653905, loss_ss: 1.162253, loss_d: 0.491652
0.4987 --- loss: 1.580104, loss_ss: 1.090487, loss_d: 0.489617
0.5370 --- loss: 1.568511, loss_ss: 1.030465, loss_d: 0.538046
0.5754 --- loss: 2.053734, loss_ss: 1.475391, loss_d: 0.578344
0.6137 --- loss: 1.905429, loss_ss: 1.579166, loss_d: 0.326263
0.6521 --- loss: 2.047837, loss_ss: 1.338566, loss_d: 0.709270
0.6904 --- loss: 1.573748, loss_ss: 1.159527, loss_d: 0.414221
0.7288 --- loss: 1.587970, loss_ss: 1.188516, loss_d: 0.399453
0.7672 --- loss: 1.961674, loss_ss: 1.347097, loss_d: 0.614577
0.8055 --- loss: 1.547036, loss_ss: 1.078038, loss_d: 0.468998
0.8439 --- loss: 1.731647, loss_ss: 1.285813, loss_d: 0.445834
0.8822 --- loss: 2.049669, loss_ss: 1.334898, loss_d: 0.714771
0.9206 --- loss: 1.341881, loss_ss: 1.013507, loss_d: 0.328374
0.9590 --- loss: 1.606501, loss_ss: 1.158993, loss_d: 0.447508
0.9973 --- loss: 1.393988, loss_ss: 1.121823, loss_d: 0.272165
Epoch finished! Loss: 1.6889127190296467
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.446966, loss_ss: 0.999473, loss_d: 0.447493
0.0384 --- loss: 1.572623, loss_ss: 1.199653, loss_d: 0.372970
0.0767 --- loss: 1.725274, loss_ss: 1.309119, loss_d: 0.416155
0.1151 --- loss: 1.579879, loss_ss: 1.213118, loss_d: 0.366760
0.1534 --- loss: 1.596987, loss_ss: 0.972396, loss_d: 0.624592
0.1918 --- loss: 1.581834, loss_ss: 1.043537, loss_d: 0.538296
0.2301 --- loss: 1.630079, loss_ss: 1.120709, loss_d: 0.509370
0.2685 --- loss: 1.441952, loss_ss: 1.013216, loss_d: 0.428736
0.3069 --- loss: 1.812708, loss_ss: 0.952879, loss_d: 0.859829
0.3452 --- loss: 1.605606, loss_ss: 1.200689, loss_d: 0.404917
0.3836 --- loss: 1.496318, loss_ss: 0.913889, loss_d: 0.582429
0.4219 --- loss: 1.554360, loss_ss: 1.134179, loss_d: 0.420181
0.4603 --- loss: 1.476218, loss_ss: 1.154131, loss_d: 0.322087
0.4987 --- loss: 1.604459, loss_ss: 1.227286, loss_d: 0.377173
0.5370 --- loss: 1.622674, loss_ss: 1.159621, loss_d: 0.463053
0.5754 --- loss: 2.210878, loss_ss: 1.394513, loss_d: 0.816365
0.6137 --- loss: 1.509438, loss_ss: 1.053526, loss_d: 0.455912
0.6521 --- loss: 1.549189, loss_ss: 1.084628, loss_d: 0.464561
0.6904 --- loss: 1.432080, loss_ss: 1.091537, loss_d: 0.340543
0.7288 --- loss: 1.719658, loss_ss: 1.441631, loss_d: 0.278028
0.7672 --- loss: 2.248722, loss_ss: 1.219503, loss_d: 1.029219
0.8055 --- loss: 1.580946, loss_ss: 1.208301, loss_d: 0.372646
0.8439 --- loss: 1.513439, loss_ss: 1.080734, loss_d: 0.432705
0.8822 --- loss: 1.632199, loss_ss: 1.128505, loss_d: 0.503694
0.9206 --- loss: 1.577842, loss_ss: 1.208630, loss_d: 0.369213
0.9590 --- loss: 1.631544, loss_ss: 1.089437, loss_d: 0.542107
0.9973 --- loss: 1.413616, loss_ss: 0.959613, loss_d: 0.454004
Epoch finished! Loss: 1.6282143299396221
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.692708, loss_ss: 1.246521, loss_d: 0.446186
0.0384 --- loss: 2.483820, loss_ss: 1.093361, loss_d: 1.390459
0.0767 --- loss: 1.715734, loss_ss: 1.274514, loss_d: 0.441220
0.1151 --- loss: 1.443168, loss_ss: 1.033931, loss_d: 0.409237
0.1534 --- loss: 1.581600, loss_ss: 1.125473, loss_d: 0.456126
0.1918 --- loss: 1.774168, loss_ss: 1.242921, loss_d: 0.531248
0.2301 --- loss: 1.714939, loss_ss: 1.281477, loss_d: 0.433462
0.2685 --- loss: 2.124498, loss_ss: 1.133641, loss_d: 0.990857
0.3069 --- loss: 1.138603, loss_ss: 0.816588, loss_d: 0.322015
0.3452 --- loss: 1.441343, loss_ss: 1.082819, loss_d: 0.358524
0.3836 --- loss: 1.736284, loss_ss: 1.087625, loss_d: 0.648659
0.4219 --- loss: 1.576364, loss_ss: 1.157531, loss_d: 0.418833
0.4603 --- loss: 1.572712, loss_ss: 1.122944, loss_d: 0.449768
0.4987 --- loss: 1.395948, loss_ss: 0.905986, loss_d: 0.489962
0.5370 --- loss: 2.073309, loss_ss: 1.198073, loss_d: 0.875235
0.5754 --- loss: 1.636100, loss_ss: 1.217028, loss_d: 0.419073
0.6137 --- loss: 1.423758, loss_ss: 1.016024, loss_d: 0.407734
0.6521 --- loss: 1.570274, loss_ss: 1.056519, loss_d: 0.513754
0.6904 --- loss: 1.658146, loss_ss: 1.064664, loss_d: 0.593482
0.7288 --- loss: 1.786414, loss_ss: 1.318656, loss_d: 0.467758
0.7672 --- loss: 1.403951, loss_ss: 1.124072, loss_d: 0.279879
0.8055 --- loss: 1.412410, loss_ss: 1.048407, loss_d: 0.364002
0.8439 --- loss: 1.390746, loss_ss: 0.980687, loss_d: 0.410059
0.8822 --- loss: 1.779258, loss_ss: 1.371219, loss_d: 0.408038
0.9206 --- loss: 1.580861, loss_ss: 1.247999, loss_d: 0.332862
0.9590 --- loss: 1.653831, loss_ss: 0.968831, loss_d: 0.685000
0.9973 --- loss: 1.167903, loss_ss: 0.823660, loss_d: 0.344243
Epoch finished! Loss: 1.5929201538746174
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.839179, loss_ss: 1.476751, loss_d: 0.362428
0.0384 --- loss: 1.481393, loss_ss: 1.178682, loss_d: 0.302711
0.0767 --- loss: 1.585603, loss_ss: 1.315682, loss_d: 0.269921
0.1151 --- loss: 1.623472, loss_ss: 1.272447, loss_d: 0.351025
0.1534 --- loss: 1.607095, loss_ss: 1.094665, loss_d: 0.512430
0.1918 --- loss: 1.466103, loss_ss: 0.914323, loss_d: 0.551780
0.2301 --- loss: 1.391634, loss_ss: 1.001001, loss_d: 0.390632
0.2685 --- loss: 1.187953, loss_ss: 0.941584, loss_d: 0.246369
0.3069 --- loss: 1.966294, loss_ss: 1.154086, loss_d: 0.812208
0.3452 --- loss: 1.704321, loss_ss: 1.258436, loss_d: 0.445885
0.3836 --- loss: 1.450161, loss_ss: 1.133442, loss_d: 0.316719
0.4219 --- loss: 1.177074, loss_ss: 0.867017, loss_d: 0.310057
0.4603 --- loss: 1.568603, loss_ss: 1.162102, loss_d: 0.406501
0.4987 --- loss: 1.223718, loss_ss: 0.835516, loss_d: 0.388202
0.5370 --- loss: 1.550185, loss_ss: 1.080252, loss_d: 0.469933
0.5754 --- loss: 1.247774, loss_ss: 0.951073, loss_d: 0.296702
0.6137 --- loss: 1.209837, loss_ss: 0.868112, loss_d: 0.341725
0.6521 --- loss: 1.832404, loss_ss: 0.894239, loss_d: 0.938166
0.6904 --- loss: 1.614128, loss_ss: 1.285676, loss_d: 0.328452
0.7288 --- loss: 1.634317, loss_ss: 1.205021, loss_d: 0.429296
0.7672 --- loss: 1.478194, loss_ss: 1.013174, loss_d: 0.465020
0.8055 --- loss: 1.838841, loss_ss: 0.935600, loss_d: 0.903242
0.8439 --- loss: 1.473315, loss_ss: 1.128778, loss_d: 0.344536
0.8822 --- loss: 1.807179, loss_ss: 1.160924, loss_d: 0.646255
0.9206 --- loss: 1.601439, loss_ss: 1.318787, loss_d: 0.282652
0.9590 --- loss: 1.919240, loss_ss: 1.561146, loss_d: 0.358094
0.9973 --- loss: 1.488473, loss_ss: 1.135705, loss_d: 0.352768
Epoch finished! Loss: 1.564363308594777
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.786811, loss_ss: 1.297232, loss_d: 0.489579
0.0384 --- loss: 1.491930, loss_ss: 1.129216, loss_d: 0.362713
0.0767 --- loss: 1.355934, loss_ss: 1.071270, loss_d: 0.284664
0.1151 --- loss: 1.457979, loss_ss: 0.967142, loss_d: 0.490837
0.1534 --- loss: 1.120706, loss_ss: 0.840075, loss_d: 0.280631
0.1918 --- loss: 1.585030, loss_ss: 1.039682, loss_d: 0.545348
0.2301 --- loss: 1.114796, loss_ss: 0.852586, loss_d: 0.262210
0.2685 --- loss: 1.682575, loss_ss: 1.114231, loss_d: 0.568344
0.3069 --- loss: 1.396980, loss_ss: 0.976201, loss_d: 0.420778
0.3452 --- loss: 1.429125, loss_ss: 1.089279, loss_d: 0.339846
0.3836 --- loss: 1.603974, loss_ss: 1.139027, loss_d: 0.464947
0.4219 --- loss: 1.426919, loss_ss: 1.077034, loss_d: 0.349884
0.4603 --- loss: 1.281316, loss_ss: 0.890480, loss_d: 0.390835
0.4987 --- loss: 1.585673, loss_ss: 1.170627, loss_d: 0.415046
0.5370 --- loss: 1.391714, loss_ss: 1.056642, loss_d: 0.335071
0.5754 --- loss: 1.746383, loss_ss: 1.449681, loss_d: 0.296702
0.6137 --- loss: 1.271241, loss_ss: 0.972394, loss_d: 0.298847
0.6521 --- loss: 1.505628, loss_ss: 1.049643, loss_d: 0.455985
0.6904 --- loss: 1.401260, loss_ss: 0.969965, loss_d: 0.431295
0.7288 --- loss: 1.598755, loss_ss: 1.066182, loss_d: 0.532573
0.7672 --- loss: 1.667263, loss_ss: 0.909427, loss_d: 0.757835
0.8055 --- loss: 1.115600, loss_ss: 0.871638, loss_d: 0.243962
0.8439 --- loss: 1.290691, loss_ss: 0.926724, loss_d: 0.363968
0.8822 --- loss: 1.760884, loss_ss: 1.379333, loss_d: 0.381551
0.9206 --- loss: 1.352041, loss_ss: 0.963841, loss_d: 0.388200
0.9590 --- loss: 1.285360, loss_ss: 0.995986, loss_d: 0.289374
0.9973 --- loss: 1.263570, loss_ss: 0.934489, loss_d: 0.329081
Epoch finished! Loss: 1.5318479345395015
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.581557, loss_ss: 1.192991, loss_d: 0.388566
0.0384 --- loss: 1.581740, loss_ss: 1.145431, loss_d: 0.436309
0.0767 --- loss: 1.372503, loss_ss: 1.030729, loss_d: 0.341774
0.1151 --- loss: 1.174316, loss_ss: 0.936924, loss_d: 0.237393
0.1534 --- loss: 1.631555, loss_ss: 0.930352, loss_d: 0.701202
0.1918 --- loss: 1.831692, loss_ss: 0.864765, loss_d: 0.966927
0.2301 --- loss: 1.505607, loss_ss: 1.173378, loss_d: 0.332228
0.2685 --- loss: 1.418320, loss_ss: 1.115546, loss_d: 0.302774
0.3069 --- loss: 1.473182, loss_ss: 1.094807, loss_d: 0.378376
0.3452 --- loss: 1.378761, loss_ss: 0.886792, loss_d: 0.491969
0.3836 --- loss: 1.204258, loss_ss: 0.927372, loss_d: 0.276886
0.4219 --- loss: 1.593231, loss_ss: 1.010297, loss_d: 0.582934
0.4603 --- loss: 1.438393, loss_ss: 1.056730, loss_d: 0.381663
0.4987 --- loss: 1.467795, loss_ss: 1.093374, loss_d: 0.374422
0.5370 --- loss: 1.521127, loss_ss: 1.144066, loss_d: 0.377061
0.5754 --- loss: 1.462773, loss_ss: 0.977571, loss_d: 0.485202
0.6137 --- loss: 1.411244, loss_ss: 1.140955, loss_d: 0.270289
0.6521 --- loss: 1.337520, loss_ss: 1.114526, loss_d: 0.222994
0.6904 --- loss: 1.612893, loss_ss: 1.259095, loss_d: 0.353797
0.7288 --- loss: 1.410851, loss_ss: 1.104796, loss_d: 0.306055
0.7672 --- loss: 1.189798, loss_ss: 0.896209, loss_d: 0.293589
0.8055 --- loss: 1.498833, loss_ss: 0.930234, loss_d: 0.568599
0.8439 --- loss: 1.271970, loss_ss: 1.015655, loss_d: 0.256315
0.8822 --- loss: 1.662289, loss_ss: 1.251266, loss_d: 0.411023
0.9206 --- loss: 1.180865, loss_ss: 0.923108, loss_d: 0.257757
0.9590 --- loss: 1.575004, loss_ss: 1.230142, loss_d: 0.344863
0.9973 --- loss: 1.133654, loss_ss: 0.764630, loss_d: 0.369024
Epoch finished! Loss: 1.5142889087016767
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.627070, loss_ss: 1.098398, loss_d: 0.528672
0.0384 --- loss: 1.605455, loss_ss: 1.151515, loss_d: 0.453939
0.0767 --- loss: 1.456329, loss_ss: 1.134464, loss_d: 0.321866
0.1151 --- loss: 1.162517, loss_ss: 0.874833, loss_d: 0.287684
0.1534 --- loss: 1.503629, loss_ss: 1.184206, loss_d: 0.319423
0.1918 --- loss: 1.174214, loss_ss: 0.904725, loss_d: 0.269489
0.2301 --- loss: 1.202464, loss_ss: 0.937249, loss_d: 0.265215
0.2685 --- loss: 1.453018, loss_ss: 1.163955, loss_d: 0.289063
0.3069 --- loss: 1.896216, loss_ss: 0.894362, loss_d: 1.001854
0.3452 --- loss: 1.432918, loss_ss: 0.907413, loss_d: 0.525505
0.3836 --- loss: 1.117507, loss_ss: 0.819602, loss_d: 0.297906
0.4219 --- loss: 1.895527, loss_ss: 1.428335, loss_d: 0.467192
0.4603 --- loss: 1.733941, loss_ss: 1.155638, loss_d: 0.578303
0.4987 --- loss: 1.736488, loss_ss: 1.197545, loss_d: 0.538943
0.5370 --- loss: 1.115202, loss_ss: 0.769727, loss_d: 0.345475
0.5754 --- loss: 1.867252, loss_ss: 1.306541, loss_d: 0.560712
0.6137 --- loss: 1.289026, loss_ss: 0.876623, loss_d: 0.412403
0.6521 --- loss: 1.295106, loss_ss: 0.985819, loss_d: 0.309287
0.6904 --- loss: 1.347301, loss_ss: 0.874050, loss_d: 0.473250
0.7288 --- loss: 1.244007, loss_ss: 1.031282, loss_d: 0.212724
0.7672 --- loss: 2.058704, loss_ss: 0.974388, loss_d: 1.084315
0.8055 --- loss: 1.467869, loss_ss: 1.037232, loss_d: 0.430637
0.8439 --- loss: 1.270349, loss_ss: 0.994403, loss_d: 0.275946
0.8822 --- loss: 1.150834, loss_ss: 0.825561, loss_d: 0.325273
0.9206 --- loss: 1.165263, loss_ss: 0.952285, loss_d: 0.212978
0.9590 --- loss: 1.324754, loss_ss: 0.881174, loss_d: 0.443580
0.9973 --- loss: 1.368992, loss_ss: 0.924599, loss_d: 0.444392
Epoch finished! Loss: 1.4875707149505615
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8
             precision    recall  f1-score   support

        0.0       1.00      0.69      0.81       240
        1.0       0.00      0.00      0.00         6
        2.0       0.85      0.91      0.88       439
        3.0       0.79      0.84      0.81       170
        4.0       0.32      0.47      0.38        75

avg / total       0.83      0.80      0.80       930
 


====== chc014-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  91.94  68.75  100.00  100.00     81.48
1  99.35   0.00  100.00    0.00      0.00
2  88.17  91.34   85.34   84.78     87.94
3  92.90  84.12   94.87   78.57     81.25
4  87.63  46.67   91.23   31.82     37.84
Total accuracy: 80.00%
Average sen: 58.18%
Average spec: 94.29%
Macro f1-score: 57.70%
[0.42497212 0.29415891 0.30296671 0.30728921 0.47536185 0.27364808
 0.37326333 0.45733207 0.54890227 0.76520997 0.77091271 0.74928278
 0.6258499  0.48438397 0.6776616  0.67508173 0.57115716 0.52069849
 0.47382441 0.39504537 0.50414735 0.73398876 0.59880799 0.7093395
 0.63423681 0.56995553 0.41367885 0.40528446 0.43770695 0.49267074
 0.68827331]
pred: 0.5275836423520119, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.490608, loss_ss: 1.808020, loss_d: 0.682588
0.0384 --- loss: 2.220072, loss_ss: 1.771082, loss_d: 0.448990
0.0767 --- loss: 2.149987, loss_ss: 1.626237, loss_d: 0.523750
0.1151 --- loss: 2.303302, loss_ss: 1.680585, loss_d: 0.622717
0.1534 --- loss: 2.509655, loss_ss: 1.634695, loss_d: 0.874960
0.1918 --- loss: 1.862092, loss_ss: 1.582465, loss_d: 0.279627
0.2301 --- loss: 2.027154, loss_ss: 1.631685, loss_d: 0.395469
0.2685 --- loss: 2.164217, loss_ss: 1.685843, loss_d: 0.478375
0.3069 --- loss: 1.989810, loss_ss: 1.483937, loss_d: 0.505874
0.3452 --- loss: 1.974936, loss_ss: 1.486056, loss_d: 0.488880
0.3836 --- loss: 1.886120, loss_ss: 1.498696, loss_d: 0.387424
0.4219 --- loss: 2.237358, loss_ss: 1.555470, loss_d: 0.681889
0.4603 --- loss: 2.130566, loss_ss: 1.519598, loss_d: 0.610969
0.4987 --- loss: 2.134410, loss_ss: 1.615884, loss_d: 0.518526
0.5370 --- loss: 1.983023, loss_ss: 1.491085, loss_d: 0.491938
0.5754 --- loss: 1.799250, loss_ss: 1.408496, loss_d: 0.390753
0.6137 --- loss: 2.224816, loss_ss: 1.674373, loss_d: 0.550443
0.6521 --- loss: 2.089379, loss_ss: 1.587250, loss_d: 0.502129
0.6904 --- loss: 1.910574, loss_ss: 1.618580, loss_d: 0.291994
0.7288 --- loss: 1.955494, loss_ss: 1.485448, loss_d: 0.470046
0.7672 --- loss: 2.222261, loss_ss: 1.585777, loss_d: 0.636485
0.8055 --- loss: 1.935508, loss_ss: 1.425679, loss_d: 0.509829
0.8439 --- loss: 2.179220, loss_ss: 1.596005, loss_d: 0.583215
0.8822 --- loss: 2.077332, loss_ss: 1.613715, loss_d: 0.463617
0.9206 --- loss: 1.842690, loss_ss: 1.504717, loss_d: 0.337972
0.9590 --- loss: 1.881355, loss_ss: 1.555579, loss_d: 0.325776
0.9973 --- loss: 2.367439, loss_ss: 1.602697, loss_d: 0.764743
Epoch finished! Loss: 2.1479175916084876
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.769399, loss_ss: 1.528891, loss_d: 0.240509
0.0384 --- loss: 1.894050, loss_ss: 1.405926, loss_d: 0.488123
0.0767 --- loss: 1.970326, loss_ss: 1.462604, loss_d: 0.507722
0.1151 --- loss: 2.083435, loss_ss: 1.374158, loss_d: 0.709278
0.1534 --- loss: 1.820925, loss_ss: 1.389797, loss_d: 0.431128
0.1918 --- loss: 1.937937, loss_ss: 1.412988, loss_d: 0.524949
0.2301 --- loss: 1.657122, loss_ss: 1.422005, loss_d: 0.235117
0.2685 --- loss: 2.090876, loss_ss: 1.448786, loss_d: 0.642089
0.3069 --- loss: 2.268605, loss_ss: 1.694405, loss_d: 0.574200
0.3452 --- loss: 2.158073, loss_ss: 1.455890, loss_d: 0.702184
0.3836 --- loss: 1.905023, loss_ss: 1.419673, loss_d: 0.485350
0.4219 --- loss: 2.129903, loss_ss: 1.481548, loss_d: 0.648355
0.4603 --- loss: 1.707186, loss_ss: 1.399857, loss_d: 0.307329
0.4987 --- loss: 1.708575, loss_ss: 1.376054, loss_d: 0.332521
0.5370 --- loss: 1.762867, loss_ss: 1.425248, loss_d: 0.337619
0.5754 --- loss: 1.991608, loss_ss: 1.471931, loss_d: 0.519677
0.6137 --- loss: 2.071312, loss_ss: 1.604550, loss_d: 0.466762
0.6521 --- loss: 1.864156, loss_ss: 1.465644, loss_d: 0.398512
0.6904 --- loss: 1.957834, loss_ss: 1.489763, loss_d: 0.468071
0.7288 --- loss: 1.872676, loss_ss: 1.374407, loss_d: 0.498270
0.7672 --- loss: 2.176402, loss_ss: 1.444337, loss_d: 0.732065
0.8055 --- loss: 1.719061, loss_ss: 1.295657, loss_d: 0.423404
0.8439 --- loss: 1.953495, loss_ss: 1.370270, loss_d: 0.583225
0.8822 --- loss: 1.837264, loss_ss: 1.476615, loss_d: 0.360649
0.9206 --- loss: 2.959704, loss_ss: 1.608509, loss_d: 1.351195
0.9590 --- loss: 2.158341, loss_ss: 1.490942, loss_d: 0.667399
0.9973 --- loss: 2.124887, loss_ss: 1.540026, loss_d: 0.584861
Epoch finished! Loss: 1.9855588981738457
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.931252, loss_ss: 1.237509, loss_d: 0.693743
0.0384 --- loss: 2.310465, loss_ss: 1.637674, loss_d: 0.672791
0.0767 --- loss: 2.110770, loss_ss: 1.528342, loss_d: 0.582428
0.1151 --- loss: 1.818055, loss_ss: 1.372725, loss_d: 0.445329
0.1534 --- loss: 1.881031, loss_ss: 1.520900, loss_d: 0.360132
0.1918 --- loss: 1.917648, loss_ss: 1.612379, loss_d: 0.305269
0.2301 --- loss: 2.206770, loss_ss: 1.371470, loss_d: 0.835300
0.2685 --- loss: 1.851062, loss_ss: 1.367193, loss_d: 0.483868
0.3069 --- loss: 2.224996, loss_ss: 1.752514, loss_d: 0.472483
0.3452 --- loss: 1.750129, loss_ss: 1.239347, loss_d: 0.510782
0.3836 --- loss: 1.776716, loss_ss: 1.425457, loss_d: 0.351259
0.4219 --- loss: 2.018631, loss_ss: 1.286055, loss_d: 0.732576
0.4603 --- loss: 1.990854, loss_ss: 1.528434, loss_d: 0.462419
0.4987 --- loss: 1.742821, loss_ss: 1.318637, loss_d: 0.424185
0.5370 --- loss: 2.026029, loss_ss: 1.470155, loss_d: 0.555874
0.5754 --- loss: 1.737755, loss_ss: 1.351514, loss_d: 0.386241
0.6137 --- loss: 2.068899, loss_ss: 1.252339, loss_d: 0.816560
0.6521 --- loss: 1.824488, loss_ss: 1.411282, loss_d: 0.413206
0.6904 --- loss: 1.950738, loss_ss: 1.471146, loss_d: 0.479593
0.7288 --- loss: 1.808339, loss_ss: 1.128079, loss_d: 0.680260
0.7672 --- loss: 1.541612, loss_ss: 1.140574, loss_d: 0.401038
0.8055 --- loss: 1.741165, loss_ss: 1.257205, loss_d: 0.483959
0.8439 --- loss: 1.725585, loss_ss: 1.389135, loss_d: 0.336450
0.8822 --- loss: 1.812616, loss_ss: 1.215851, loss_d: 0.596765
0.9206 --- loss: 1.958274, loss_ss: 1.403427, loss_d: 0.554847
0.9590 --- loss: 1.780898, loss_ss: 1.360493, loss_d: 0.420405
0.9973 --- loss: 1.768074, loss_ss: 1.475451, loss_d: 0.292623
Epoch finished! Loss: 1.9333280755923345
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.010586, loss_ss: 1.292042, loss_d: 0.718544
0.0384 --- loss: 1.697202, loss_ss: 1.392189, loss_d: 0.305013
0.0767 --- loss: 1.780264, loss_ss: 1.324411, loss_d: 0.455853
0.1151 --- loss: 1.808228, loss_ss: 1.490286, loss_d: 0.317943
0.1534 --- loss: 2.149251, loss_ss: 1.435381, loss_d: 0.713870
0.1918 --- loss: 1.735789, loss_ss: 1.407095, loss_d: 0.328694
0.2301 --- loss: 1.611763, loss_ss: 1.314463, loss_d: 0.297300
0.2685 --- loss: 1.572533, loss_ss: 1.224058, loss_d: 0.348475
0.3069 --- loss: 1.992567, loss_ss: 1.423978, loss_d: 0.568589
0.3452 --- loss: 1.932308, loss_ss: 1.467499, loss_d: 0.464809
0.3836 --- loss: 1.814837, loss_ss: 1.235790, loss_d: 0.579046
0.4219 --- loss: 1.612093, loss_ss: 1.308645, loss_d: 0.303448
0.4603 --- loss: 2.109111, loss_ss: 1.443496, loss_d: 0.665615
0.4987 --- loss: 1.715944, loss_ss: 1.206769, loss_d: 0.509174
0.5370 --- loss: 1.753028, loss_ss: 1.265614, loss_d: 0.487415
0.5754 --- loss: 1.807255, loss_ss: 1.311605, loss_d: 0.495650
0.6137 --- loss: 1.466784, loss_ss: 1.086457, loss_d: 0.380328
0.6521 --- loss: 1.512888, loss_ss: 1.051507, loss_d: 0.461381
0.6904 --- loss: 2.019542, loss_ss: 1.258086, loss_d: 0.761455
0.7288 --- loss: 1.804122, loss_ss: 1.446477, loss_d: 0.357646
0.7672 --- loss: 1.533007, loss_ss: 1.082015, loss_d: 0.450992
0.8055 --- loss: 1.620194, loss_ss: 1.370428, loss_d: 0.249766
0.8439 --- loss: 2.000636, loss_ss: 1.235968, loss_d: 0.764669
0.8822 --- loss: 2.191146, loss_ss: 1.273780, loss_d: 0.917366
0.9206 --- loss: 1.391629, loss_ss: 0.985240, loss_d: 0.406389
0.9590 --- loss: 1.647176, loss_ss: 1.169150, loss_d: 0.478026
0.9973 --- loss: 1.460680, loss_ss: 1.056637, loss_d: 0.404043
Epoch finished! Loss: 1.799931829709273
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.817903, loss_ss: 1.366272, loss_d: 0.451631
0.0384 --- loss: 1.519547, loss_ss: 1.174036, loss_d: 0.345511
0.0767 --- loss: 1.528192, loss_ss: 1.005483, loss_d: 0.522709
0.1151 --- loss: 1.645434, loss_ss: 1.352553, loss_d: 0.292881
0.1534 --- loss: 1.618750, loss_ss: 1.275362, loss_d: 0.343389
0.1918 --- loss: 1.539335, loss_ss: 1.105895, loss_d: 0.433440
0.2301 --- loss: 1.365536, loss_ss: 1.005812, loss_d: 0.359724
0.2685 --- loss: 1.507314, loss_ss: 1.018373, loss_d: 0.488940
0.3069 --- loss: 1.511998, loss_ss: 1.126837, loss_d: 0.385162
0.3452 --- loss: 1.792117, loss_ss: 1.310507, loss_d: 0.481610
0.3836 --- loss: 1.638327, loss_ss: 1.201907, loss_d: 0.436420
0.4219 --- loss: 1.583935, loss_ss: 1.184615, loss_d: 0.399320
0.4603 --- loss: 1.646529, loss_ss: 1.184986, loss_d: 0.461543
0.4987 --- loss: 1.711802, loss_ss: 1.285627, loss_d: 0.426175
0.5370 --- loss: 1.838267, loss_ss: 1.219205, loss_d: 0.619062
0.5754 --- loss: 1.717845, loss_ss: 1.024706, loss_d: 0.693139
0.6137 --- loss: 1.540215, loss_ss: 0.984951, loss_d: 0.555264
0.6521 --- loss: 1.668252, loss_ss: 1.028316, loss_d: 0.639936
0.6904 --- loss: 1.697268, loss_ss: 1.290972, loss_d: 0.406296
0.7288 --- loss: 1.650082, loss_ss: 1.203339, loss_d: 0.446743
0.7672 --- loss: 1.387255, loss_ss: 1.114518, loss_d: 0.272737
0.8055 --- loss: 1.801469, loss_ss: 1.314807, loss_d: 0.486662
0.8439 --- loss: 2.042632, loss_ss: 1.564415, loss_d: 0.478217
0.8822 --- loss: 1.843288, loss_ss: 1.307314, loss_d: 0.535974
0.9206 --- loss: 1.784161, loss_ss: 1.259946, loss_d: 0.524214
0.9590 --- loss: 1.846132, loss_ss: 1.207743, loss_d: 0.638390
0.9973 --- loss: 1.786540, loss_ss: 1.423305, loss_d: 0.363235
Epoch finished! Loss: 1.7045176033790295
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 2.452289, loss_ss: 1.194394, loss_d: 1.257895
0.0384 --- loss: 1.573609, loss_ss: 1.119155, loss_d: 0.454454
0.0767 --- loss: 1.421586, loss_ss: 1.029339, loss_d: 0.392247
0.1151 --- loss: 1.522474, loss_ss: 1.161505, loss_d: 0.360970
0.1534 --- loss: 1.306200, loss_ss: 0.948262, loss_d: 0.357938
0.1918 --- loss: 1.557371, loss_ss: 1.032289, loss_d: 0.525083
0.2301 --- loss: 2.032091, loss_ss: 1.307525, loss_d: 0.724566
0.2685 --- loss: 1.834501, loss_ss: 1.411263, loss_d: 0.423238
0.3069 --- loss: 1.635504, loss_ss: 1.183226, loss_d: 0.452277
0.3452 --- loss: 1.668829, loss_ss: 1.329066, loss_d: 0.339763
0.3836 --- loss: 1.717640, loss_ss: 0.966990, loss_d: 0.750650
0.4219 --- loss: 1.531173, loss_ss: 1.158732, loss_d: 0.372441
0.4603 --- loss: 1.621716, loss_ss: 1.264402, loss_d: 0.357314
0.4987 --- loss: 1.453808, loss_ss: 1.116497, loss_d: 0.337311
0.5370 --- loss: 1.555771, loss_ss: 1.162798, loss_d: 0.392974
0.5754 --- loss: 1.408916, loss_ss: 1.052463, loss_d: 0.356453
0.6137 --- loss: 1.784383, loss_ss: 1.389562, loss_d: 0.394821
0.6521 --- loss: 1.598137, loss_ss: 1.177225, loss_d: 0.420912
0.6904 --- loss: 1.974885, loss_ss: 1.031233, loss_d: 0.943651
0.7288 --- loss: 1.578730, loss_ss: 0.920658, loss_d: 0.658071
0.7672 --- loss: 1.454795, loss_ss: 1.104059, loss_d: 0.350735
0.8055 --- loss: 1.571692, loss_ss: 1.116676, loss_d: 0.455016
0.8439 --- loss: 1.508044, loss_ss: 1.191663, loss_d: 0.316381
0.8822 --- loss: 1.385946, loss_ss: 1.091901, loss_d: 0.294045
0.9206 --- loss: 1.603363, loss_ss: 1.234156, loss_d: 0.369207
0.9590 --- loss: 1.437180, loss_ss: 1.105598, loss_d: 0.331582
0.9973 --- loss: 1.704026, loss_ss: 1.388845, loss_d: 0.315180
Epoch finished! Loss: 1.6235737731823554
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.547282, loss_ss: 1.156597, loss_d: 0.390684
0.0384 --- loss: 1.550019, loss_ss: 0.966040, loss_d: 0.583979
0.0767 --- loss: 1.746993, loss_ss: 1.039066, loss_d: 0.707927
0.1151 --- loss: 1.725286, loss_ss: 1.298665, loss_d: 0.426622
0.1534 --- loss: 1.560120, loss_ss: 1.117883, loss_d: 0.442237
0.1918 --- loss: 1.576394, loss_ss: 1.164116, loss_d: 0.412278
0.2301 --- loss: 1.527480, loss_ss: 1.178867, loss_d: 0.348613
0.2685 --- loss: 1.510951, loss_ss: 1.089824, loss_d: 0.421127
0.3069 --- loss: 1.360253, loss_ss: 0.859276, loss_d: 0.500977
0.3452 --- loss: 1.189691, loss_ss: 0.875686, loss_d: 0.314005
0.3836 --- loss: 1.881078, loss_ss: 1.587152, loss_d: 0.293926
0.4219 --- loss: 1.571158, loss_ss: 1.077968, loss_d: 0.493190
0.4603 --- loss: 1.178204, loss_ss: 0.815848, loss_d: 0.362356
0.4987 --- loss: 1.311711, loss_ss: 0.918393, loss_d: 0.393318
0.5370 --- loss: 1.523049, loss_ss: 1.205121, loss_d: 0.317928
0.5754 --- loss: 1.563557, loss_ss: 1.150194, loss_d: 0.413363
0.6137 --- loss: 1.496604, loss_ss: 1.131084, loss_d: 0.365520
0.6521 --- loss: 1.481750, loss_ss: 1.023361, loss_d: 0.458389
0.6904 --- loss: 1.895129, loss_ss: 1.157874, loss_d: 0.737255
0.7288 --- loss: 1.680601, loss_ss: 1.104264, loss_d: 0.576336
0.7672 --- loss: 1.181466, loss_ss: 0.901588, loss_d: 0.279878
0.8055 --- loss: 1.408286, loss_ss: 1.013418, loss_d: 0.394868
0.8439 --- loss: 1.323309, loss_ss: 1.101011, loss_d: 0.222299
0.8822 --- loss: 1.368388, loss_ss: 1.011045, loss_d: 0.357344
0.9206 --- loss: 1.680247, loss_ss: 1.281343, loss_d: 0.398904
0.9590 --- loss: 1.678550, loss_ss: 1.356863, loss_d: 0.321688
0.9973 --- loss: 2.908555, loss_ss: 1.112118, loss_d: 1.796436
Epoch finished! Loss: 1.587846748645489
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.791655, loss_ss: 1.074139, loss_d: 0.717516
0.0384 --- loss: 1.841484, loss_ss: 1.535533, loss_d: 0.305951
0.0767 --- loss: 1.557506, loss_ss: 1.086119, loss_d: 0.471387
0.1151 --- loss: 1.782173, loss_ss: 1.143144, loss_d: 0.639029
0.1534 --- loss: 1.583262, loss_ss: 1.075964, loss_d: 0.507297
0.1918 --- loss: 2.151145, loss_ss: 1.212996, loss_d: 0.938149
0.2301 --- loss: 1.710858, loss_ss: 1.059770, loss_d: 0.651088
0.2685 --- loss: 1.815736, loss_ss: 1.133064, loss_d: 0.682672
0.3069 --- loss: 1.412089, loss_ss: 1.067217, loss_d: 0.344871
0.3452 --- loss: 1.163258, loss_ss: 0.895239, loss_d: 0.268019
0.3836 --- loss: 1.444883, loss_ss: 0.968912, loss_d: 0.475971
0.4219 --- loss: 1.634099, loss_ss: 1.138610, loss_d: 0.495489
0.4603 --- loss: 2.012650, loss_ss: 1.224987, loss_d: 0.787662
0.4987 --- loss: 1.644089, loss_ss: 1.253193, loss_d: 0.390896
0.5370 --- loss: 1.656649, loss_ss: 1.134509, loss_d: 0.522139
0.5754 --- loss: 1.359770, loss_ss: 0.934555, loss_d: 0.425216
0.6137 --- loss: 1.760285, loss_ss: 1.423337, loss_d: 0.336948
0.6521 --- loss: 1.784807, loss_ss: 1.239650, loss_d: 0.545157
0.6904 --- loss: 1.247284, loss_ss: 0.933616, loss_d: 0.313667
0.7288 --- loss: 1.804155, loss_ss: 1.279657, loss_d: 0.524499
0.7672 --- loss: 1.478759, loss_ss: 1.022056, loss_d: 0.456703
0.8055 --- loss: 2.291163, loss_ss: 1.199313, loss_d: 1.091850
0.8439 --- loss: 1.308821, loss_ss: 0.907723, loss_d: 0.401097
0.8822 --- loss: 1.376281, loss_ss: 1.046290, loss_d: 0.329991
0.9206 --- loss: 1.430183, loss_ss: 1.022152, loss_d: 0.408031
0.9590 --- loss: 1.642570, loss_ss: 1.278558, loss_d: 0.364013
0.9973 --- loss: 1.623475, loss_ss: 0.828081, loss_d: 0.795394
Epoch finished! Loss: 1.555846816301346
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.296222, loss_ss: 1.054375, loss_d: 0.241847
0.0384 --- loss: 1.297978, loss_ss: 0.957494, loss_d: 0.340484
0.0767 --- loss: 1.512369, loss_ss: 1.096343, loss_d: 0.416026
0.1151 --- loss: 1.311353, loss_ss: 1.019014, loss_d: 0.292338
0.1534 --- loss: 2.210170, loss_ss: 1.194599, loss_d: 1.015571
0.1918 --- loss: 1.552675, loss_ss: 1.195084, loss_d: 0.357591
0.2301 --- loss: 1.363884, loss_ss: 1.037892, loss_d: 0.325992
0.2685 --- loss: 1.088811, loss_ss: 0.791098, loss_d: 0.297713
0.3069 --- loss: 1.076126, loss_ss: 0.838846, loss_d: 0.237280
0.3452 --- loss: 1.489398, loss_ss: 1.275273, loss_d: 0.214126
0.3836 --- loss: 1.436447, loss_ss: 1.216679, loss_d: 0.219768
0.4219 --- loss: 2.065106, loss_ss: 1.210063, loss_d: 0.855043
0.4603 --- loss: 1.561169, loss_ss: 1.008472, loss_d: 0.552697
0.4987 --- loss: 1.310897, loss_ss: 0.935757, loss_d: 0.375140
0.5370 --- loss: 1.838576, loss_ss: 1.390877, loss_d: 0.447698
0.5754 --- loss: 1.396711, loss_ss: 1.154955, loss_d: 0.241756
0.6137 --- loss: 1.159600, loss_ss: 0.995271, loss_d: 0.164329
0.6521 --- loss: 1.169814, loss_ss: 0.926331, loss_d: 0.243483
0.6904 --- loss: 2.126653, loss_ss: 1.258028, loss_d: 0.868625
0.7288 --- loss: 1.511304, loss_ss: 1.134128, loss_d: 0.377176
0.7672 --- loss: 1.436480, loss_ss: 1.122811, loss_d: 0.313669
0.8055 --- loss: 1.594413, loss_ss: 1.165606, loss_d: 0.428807
0.8439 --- loss: 1.661960, loss_ss: 0.987026, loss_d: 0.674934
0.8822 --- loss: 1.778963, loss_ss: 1.134643, loss_d: 0.644320
0.9206 --- loss: 1.256927, loss_ss: 0.947169, loss_d: 0.309758
0.9590 --- loss: 1.983954, loss_ss: 1.521820, loss_d: 0.462133
0.9973 --- loss: 1.792777, loss_ss: 1.211546, loss_d: 0.581231
Epoch finished! Loss: 1.52604725085772
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.513076, loss_ss: 1.112239, loss_d: 0.400837
0.0384 --- loss: 1.438354, loss_ss: 1.039780, loss_d: 0.398573
0.0767 --- loss: 1.248329, loss_ss: 0.832012, loss_d: 0.416317
0.1151 --- loss: 1.574511, loss_ss: 1.079751, loss_d: 0.494761
0.1534 --- loss: 1.686528, loss_ss: 0.961423, loss_d: 0.725105
0.1918 --- loss: 1.203426, loss_ss: 0.902173, loss_d: 0.301254
0.2301 --- loss: 1.173985, loss_ss: 0.873665, loss_d: 0.300320
0.2685 --- loss: 1.398430, loss_ss: 0.954438, loss_d: 0.443992
0.3069 --- loss: 1.738360, loss_ss: 1.020621, loss_d: 0.717739
0.3452 --- loss: 1.528273, loss_ss: 1.187816, loss_d: 0.340457
0.3836 --- loss: 1.931692, loss_ss: 1.136497, loss_d: 0.795195
0.4219 --- loss: 1.910153, loss_ss: 1.141346, loss_d: 0.768807
0.4603 --- loss: 1.746018, loss_ss: 1.070701, loss_d: 0.675316
0.4987 --- loss: 1.631213, loss_ss: 0.984041, loss_d: 0.647173
0.5370 --- loss: 1.647345, loss_ss: 1.117640, loss_d: 0.529705
0.5754 --- loss: 1.475790, loss_ss: 1.111586, loss_d: 0.364204
0.6137 --- loss: 1.206241, loss_ss: 0.877409, loss_d: 0.328832
0.6521 --- loss: 1.267342, loss_ss: 0.913141, loss_d: 0.354201
0.6904 --- loss: 2.098349, loss_ss: 1.523905, loss_d: 0.574444
0.7288 --- loss: 1.436730, loss_ss: 1.137814, loss_d: 0.298916
0.7672 --- loss: 1.606226, loss_ss: 1.231245, loss_d: 0.374981
0.8055 --- loss: 1.685813, loss_ss: 1.446638, loss_d: 0.239175
0.8439 --- loss: 1.256403, loss_ss: 1.041276, loss_d: 0.215127
0.8822 --- loss: 1.523532, loss_ss: 1.017740, loss_d: 0.505792
0.9206 --- loss: 1.964120, loss_ss: 1.113907, loss_d: 0.850213
0.9590 --- loss: 1.532042, loss_ss: 1.100757, loss_d: 0.431286
0.9973 --- loss: 1.901133, loss_ss: 1.572521, loss_d: 0.328612
Epoch finished! Loss: 1.5262246870077574
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.14516129032258066
             precision    recall  f1-score   support

        0.0       0.12      0.97      0.21        38
        1.0       0.00      0.00      0.00        83
        2.0       0.00      0.00      0.00       502
        3.0       0.16      0.59      0.25       166
        4.0       0.00      0.00      0.00       141

avg / total       0.03      0.15      0.05       930
 


====== chc015-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  69.68  97.37   68.50  11.64     20.79
1  91.08   0.00  100.00   0.00      0.00
2  46.02   0.00  100.00   0.00      0.00
3  37.42  59.04   32.72  16.01     25.19
4  84.84   0.00  100.00   0.00      0.00
Total accuracy: 14.52%
Average sen: 31.28%
Average spec: 80.24%
Macro f1-score: 9.20%
[0.99671042 0.99805641 0.99973696 0.99982172 0.97789085 0.62902033
 0.90766156 0.99298227 0.99357283 0.99984443 0.96072173 0.95600235
 0.98421383 0.88307774 0.97468966 0.99806756 0.99960929 0.99765211
 0.73689932 0.72862351 0.94233131 0.98608506 0.9883008  0.84516793
 0.7823112  0.99676585 0.99855655 0.97887635 0.97997838 0.90979218
 0.98138255]
pred: 0.9388517122114858, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.641181, loss_ss: 1.894060, loss_d: 0.747121
0.0384 --- loss: 2.333680, loss_ss: 1.872699, loss_d: 0.460981
0.0767 --- loss: 2.390306, loss_ss: 1.926627, loss_d: 0.463680
0.1151 --- loss: 2.364336, loss_ss: 1.935353, loss_d: 0.428984
0.1534 --- loss: 2.231897, loss_ss: 1.665383, loss_d: 0.566514
0.1918 --- loss: 2.062140, loss_ss: 1.694938, loss_d: 0.367203
0.2301 --- loss: 2.358256, loss_ss: 1.747043, loss_d: 0.611213
0.2685 --- loss: 2.343973, loss_ss: 1.843747, loss_d: 0.500226
0.3069 --- loss: 2.306429, loss_ss: 1.852154, loss_d: 0.454275
0.3452 --- loss: 2.376868, loss_ss: 1.751824, loss_d: 0.625044
0.3836 --- loss: 2.026917, loss_ss: 1.640088, loss_d: 0.386828
0.4219 --- loss: 1.947801, loss_ss: 1.612573, loss_d: 0.335228
0.4603 --- loss: 2.125602, loss_ss: 1.660691, loss_d: 0.464911
0.4987 --- loss: 1.912673, loss_ss: 1.563780, loss_d: 0.348893
0.5370 --- loss: 2.265810, loss_ss: 1.688567, loss_d: 0.577243
0.5754 --- loss: 2.183467, loss_ss: 1.647211, loss_d: 0.536256
0.6137 --- loss: 2.156110, loss_ss: 1.678033, loss_d: 0.478077
0.6521 --- loss: 2.237716, loss_ss: 1.718415, loss_d: 0.519302
0.6904 --- loss: 2.142723, loss_ss: 1.686534, loss_d: 0.456189
0.7288 --- loss: 2.074682, loss_ss: 1.612799, loss_d: 0.461883
0.7672 --- loss: 2.480088, loss_ss: 1.568395, loss_d: 0.911693
0.8055 --- loss: 2.114458, loss_ss: 1.567870, loss_d: 0.546587
0.8439 --- loss: 1.879644, loss_ss: 1.499932, loss_d: 0.379712
0.8822 --- loss: 1.880596, loss_ss: 1.554535, loss_d: 0.326061
0.9206 --- loss: 1.805133, loss_ss: 1.513251, loss_d: 0.291881
0.9590 --- loss: 1.959494, loss_ss: 1.580097, loss_d: 0.379397
0.9973 --- loss: 2.041556, loss_ss: 1.486265, loss_d: 0.555291
Epoch finished! Loss: 2.2131969759097467
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.254918, loss_ss: 1.442022, loss_d: 0.812896
0.0384 --- loss: 2.208336, loss_ss: 1.530222, loss_d: 0.678114
0.0767 --- loss: 2.154815, loss_ss: 1.516142, loss_d: 0.638673
0.1151 --- loss: 2.353532, loss_ss: 1.541527, loss_d: 0.812005
0.1534 --- loss: 2.240483, loss_ss: 1.565784, loss_d: 0.674699
0.1918 --- loss: 2.397427, loss_ss: 1.590093, loss_d: 0.807333
0.2301 --- loss: 1.955219, loss_ss: 1.456810, loss_d: 0.498409
0.2685 --- loss: 1.718458, loss_ss: 1.361824, loss_d: 0.356634
0.3069 --- loss: 1.711258, loss_ss: 1.327641, loss_d: 0.383617
0.3452 --- loss: 2.405532, loss_ss: 1.364647, loss_d: 1.040885
0.3836 --- loss: 1.748622, loss_ss: 1.275610, loss_d: 0.473011
0.4219 --- loss: 1.826478, loss_ss: 1.327141, loss_d: 0.499338
0.4603 --- loss: 1.892583, loss_ss: 1.348457, loss_d: 0.544126
0.4987 --- loss: 1.757266, loss_ss: 1.347711, loss_d: 0.409555
0.5370 --- loss: 1.763191, loss_ss: 1.520975, loss_d: 0.242216
0.5754 --- loss: 1.728657, loss_ss: 1.356636, loss_d: 0.372022
0.6137 --- loss: 1.850795, loss_ss: 1.503928, loss_d: 0.346867
0.6521 --- loss: 1.981017, loss_ss: 1.400829, loss_d: 0.580188
0.6904 --- loss: 1.657366, loss_ss: 1.190668, loss_d: 0.466698
0.7288 --- loss: 1.964301, loss_ss: 1.418610, loss_d: 0.545691
0.7672 --- loss: 1.683747, loss_ss: 1.332366, loss_d: 0.351382
0.8055 --- loss: 1.908213, loss_ss: 1.401090, loss_d: 0.507123
0.8439 --- loss: 1.749894, loss_ss: 1.285437, loss_d: 0.464458
0.8822 --- loss: 1.849002, loss_ss: 1.462332, loss_d: 0.386670
0.9206 --- loss: 1.963503, loss_ss: 1.269087, loss_d: 0.694416
0.9590 --- loss: 2.384911, loss_ss: 1.379685, loss_d: 1.005226
0.9973 --- loss: 1.712770, loss_ss: 1.373620, loss_d: 0.339150
Epoch finished! Loss: 1.9379991921094748
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.811827, loss_ss: 1.323763, loss_d: 0.488064
0.0384 --- loss: 2.091731, loss_ss: 1.296857, loss_d: 0.794874
0.0767 --- loss: 1.576101, loss_ss: 1.188978, loss_d: 0.387122
0.1151 --- loss: 1.692488, loss_ss: 1.207702, loss_d: 0.484786
0.1534 --- loss: 2.064725, loss_ss: 1.582383, loss_d: 0.482342
0.1918 --- loss: 2.131504, loss_ss: 1.589739, loss_d: 0.541765
0.2301 --- loss: 1.446715, loss_ss: 1.097072, loss_d: 0.349643
0.2685 --- loss: 1.939359, loss_ss: 1.344654, loss_d: 0.594705
0.3069 --- loss: 1.712722, loss_ss: 1.282627, loss_d: 0.430095
0.3452 --- loss: 1.617694, loss_ss: 1.378927, loss_d: 0.238767
0.3836 --- loss: 1.707281, loss_ss: 1.373158, loss_d: 0.334123
0.4219 --- loss: 1.761650, loss_ss: 1.329297, loss_d: 0.432352
0.4603 --- loss: 1.853079, loss_ss: 1.405557, loss_d: 0.447522
0.4987 --- loss: 2.091641, loss_ss: 1.253637, loss_d: 0.838004
0.5370 --- loss: 1.543665, loss_ss: 1.133168, loss_d: 0.410497
0.5754 --- loss: 2.048332, loss_ss: 1.313926, loss_d: 0.734406
0.6137 --- loss: 2.020594, loss_ss: 1.530697, loss_d: 0.489897
0.6521 --- loss: 2.217571, loss_ss: 1.148558, loss_d: 1.069013
0.6904 --- loss: 2.029725, loss_ss: 1.397903, loss_d: 0.631821
0.7288 --- loss: 2.063838, loss_ss: 1.415021, loss_d: 0.648817
0.7672 --- loss: 1.581090, loss_ss: 1.118277, loss_d: 0.462813
0.8055 --- loss: 1.645236, loss_ss: 1.277537, loss_d: 0.367700
0.8439 --- loss: 1.886556, loss_ss: 1.395017, loss_d: 0.491539
0.8822 --- loss: 1.551757, loss_ss: 1.203049, loss_d: 0.348709
0.9206 --- loss: 2.153036, loss_ss: 1.113397, loss_d: 1.039639
0.9590 --- loss: 1.815275, loss_ss: 1.371033, loss_d: 0.444242
0.9973 --- loss: 2.072608, loss_ss: 1.429712, loss_d: 0.642896
Epoch finished! Loss: 1.8258278998044821
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.529423, loss_ss: 1.150874, loss_d: 0.378548
0.0384 --- loss: 1.600381, loss_ss: 1.057621, loss_d: 0.542760
0.0767 --- loss: 1.990806, loss_ss: 1.444481, loss_d: 0.546325
0.1151 --- loss: 1.698241, loss_ss: 1.211555, loss_d: 0.486685
0.1534 --- loss: 1.575960, loss_ss: 1.188755, loss_d: 0.387205
0.1918 --- loss: 1.902918, loss_ss: 1.096710, loss_d: 0.806208
0.2301 --- loss: 1.703017, loss_ss: 1.089063, loss_d: 0.613954
0.2685 --- loss: 1.525573, loss_ss: 1.191324, loss_d: 0.334249
0.3069 --- loss: 1.978048, loss_ss: 1.604598, loss_d: 0.373450
0.3452 --- loss: 1.670539, loss_ss: 1.167600, loss_d: 0.502939
0.3836 --- loss: 1.688378, loss_ss: 1.401073, loss_d: 0.287305
0.4219 --- loss: 1.678673, loss_ss: 1.276557, loss_d: 0.402115
0.4603 --- loss: 1.800241, loss_ss: 1.372193, loss_d: 0.428048
0.4987 --- loss: 1.825800, loss_ss: 1.356298, loss_d: 0.469503
0.5370 --- loss: 1.730242, loss_ss: 1.250662, loss_d: 0.479580
0.5754 --- loss: 1.721808, loss_ss: 1.211710, loss_d: 0.510098
0.6137 --- loss: 1.783171, loss_ss: 1.019410, loss_d: 0.763762
0.6521 --- loss: 1.739424, loss_ss: 1.145054, loss_d: 0.594370
0.6904 --- loss: 1.590601, loss_ss: 1.271766, loss_d: 0.318835
0.7288 --- loss: 1.424073, loss_ss: 1.061221, loss_d: 0.362852
0.7672 --- loss: 1.446591, loss_ss: 1.112247, loss_d: 0.334344
0.8055 --- loss: 1.377111, loss_ss: 1.092020, loss_d: 0.285091
0.8439 --- loss: 1.624812, loss_ss: 1.294558, loss_d: 0.330254
0.8822 --- loss: 1.734339, loss_ss: 1.077792, loss_d: 0.656547
0.9206 --- loss: 1.777003, loss_ss: 1.198388, loss_d: 0.578614
0.9590 --- loss: 1.821621, loss_ss: 1.373792, loss_d: 0.447829
0.9973 --- loss: 1.508872, loss_ss: 1.152058, loss_d: 0.356814
Epoch finished! Loss: 1.691924591247852
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.456859, loss_ss: 0.953913, loss_d: 0.502947
0.0384 --- loss: 1.431751, loss_ss: 1.120186, loss_d: 0.311564
0.0767 --- loss: 1.685519, loss_ss: 0.885327, loss_d: 0.800191
0.1151 --- loss: 1.456734, loss_ss: 1.185529, loss_d: 0.271205
0.1534 --- loss: 1.397391, loss_ss: 0.944892, loss_d: 0.452498
0.1918 --- loss: 1.643973, loss_ss: 1.051431, loss_d: 0.592542
0.2301 --- loss: 1.748286, loss_ss: 1.041478, loss_d: 0.706808
0.2685 --- loss: 1.341056, loss_ss: 0.926776, loss_d: 0.414281
0.3069 --- loss: 1.385023, loss_ss: 1.107274, loss_d: 0.277749
0.3452 --- loss: 1.637599, loss_ss: 1.144575, loss_d: 0.493024
0.3836 --- loss: 1.670400, loss_ss: 1.101251, loss_d: 0.569148
0.4219 --- loss: 1.608036, loss_ss: 1.172110, loss_d: 0.435926
0.4603 --- loss: 1.950461, loss_ss: 1.293521, loss_d: 0.656940
0.4987 --- loss: 1.442112, loss_ss: 1.089299, loss_d: 0.352813
0.5370 --- loss: 1.461257, loss_ss: 0.969140, loss_d: 0.492117
0.5754 --- loss: 1.833971, loss_ss: 1.417568, loss_d: 0.416403
0.6137 --- loss: 1.816534, loss_ss: 1.285254, loss_d: 0.531280
0.6521 --- loss: 1.513625, loss_ss: 1.157104, loss_d: 0.356520
0.6904 --- loss: 1.480240, loss_ss: 1.170182, loss_d: 0.310058
0.7288 --- loss: 1.802527, loss_ss: 1.349141, loss_d: 0.453386
0.7672 --- loss: 1.554464, loss_ss: 1.142366, loss_d: 0.412098
0.8055 --- loss: 1.160654, loss_ss: 0.930363, loss_d: 0.230291
0.8439 --- loss: 1.342518, loss_ss: 0.900086, loss_d: 0.442432
0.8822 --- loss: 1.287258, loss_ss: 0.910369, loss_d: 0.376889
0.9206 --- loss: 1.394013, loss_ss: 0.869514, loss_d: 0.524499
0.9590 --- loss: 1.595566, loss_ss: 1.267870, loss_d: 0.327696
0.9973 --- loss: 1.615253, loss_ss: 1.130174, loss_d: 0.485080
Epoch finished! Loss: 1.6098837655324203
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.599142, loss_ss: 1.048995, loss_d: 0.550147
0.0384 --- loss: 1.590599, loss_ss: 0.947039, loss_d: 0.643560
0.0767 --- loss: 1.488660, loss_ss: 1.091626, loss_d: 0.397034
0.1151 --- loss: 2.007899, loss_ss: 1.106934, loss_d: 0.900965
0.1534 --- loss: 1.701333, loss_ss: 0.985702, loss_d: 0.715631
0.1918 --- loss: 1.264495, loss_ss: 0.935459, loss_d: 0.329036
0.2301 --- loss: 1.628860, loss_ss: 1.352050, loss_d: 0.276809
0.2685 --- loss: 2.301868, loss_ss: 1.602204, loss_d: 0.699665
0.3069 --- loss: 1.332510, loss_ss: 1.042972, loss_d: 0.289538
0.3452 --- loss: 1.313351, loss_ss: 0.988102, loss_d: 0.325249
0.3836 --- loss: 1.289531, loss_ss: 1.032663, loss_d: 0.256869
0.4219 --- loss: 1.475217, loss_ss: 1.023414, loss_d: 0.451802
0.4603 --- loss: 1.641876, loss_ss: 1.125242, loss_d: 0.516633
0.4987 --- loss: 1.649746, loss_ss: 0.877912, loss_d: 0.771834
0.5370 --- loss: 1.777372, loss_ss: 1.341184, loss_d: 0.436188
0.5754 --- loss: 1.772788, loss_ss: 1.434804, loss_d: 0.337984
0.6137 --- loss: 1.467472, loss_ss: 0.985961, loss_d: 0.481511
0.6521 --- loss: 1.758924, loss_ss: 1.250203, loss_d: 0.508721
0.6904 --- loss: 1.356648, loss_ss: 0.980981, loss_d: 0.375667
0.7288 --- loss: 1.222072, loss_ss: 0.870829, loss_d: 0.351243
0.7672 --- loss: 1.513341, loss_ss: 0.963141, loss_d: 0.550199
0.8055 --- loss: 1.569144, loss_ss: 1.206617, loss_d: 0.362527
0.8439 --- loss: 1.555259, loss_ss: 1.263440, loss_d: 0.291820
0.8822 --- loss: 1.530954, loss_ss: 1.145983, loss_d: 0.384971
0.9206 --- loss: 1.534061, loss_ss: 0.881148, loss_d: 0.652913
0.9590 --- loss: 1.757527, loss_ss: 1.406250, loss_d: 0.351277
0.9973 --- loss: 1.232156, loss_ss: 0.884454, loss_d: 0.347703
Epoch finished! Loss: 1.5870281659639798
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.815701, loss_ss: 1.409831, loss_d: 0.405870
0.0384 --- loss: 1.501036, loss_ss: 1.062264, loss_d: 0.438772
0.0767 --- loss: 1.233863, loss_ss: 0.954901, loss_d: 0.278961
0.1151 --- loss: 1.497413, loss_ss: 1.151516, loss_d: 0.345897
0.1534 --- loss: 1.530461, loss_ss: 1.214110, loss_d: 0.316351
0.1918 --- loss: 1.477794, loss_ss: 1.044872, loss_d: 0.432922
0.2301 --- loss: 1.421038, loss_ss: 1.007695, loss_d: 0.413344
0.2685 --- loss: 1.910622, loss_ss: 1.108077, loss_d: 0.802545
0.3069 --- loss: 1.432844, loss_ss: 1.052375, loss_d: 0.380470
0.3452 --- loss: 1.704502, loss_ss: 1.180279, loss_d: 0.524223
0.3836 --- loss: 2.185402, loss_ss: 1.334288, loss_d: 0.851114
0.4219 --- loss: 1.434981, loss_ss: 0.967775, loss_d: 0.467206
0.4603 --- loss: 1.606399, loss_ss: 1.091326, loss_d: 0.515073
0.4987 --- loss: 1.576078, loss_ss: 1.188152, loss_d: 0.387926
0.5370 --- loss: 1.596390, loss_ss: 1.266387, loss_d: 0.330003
0.5754 --- loss: 1.267252, loss_ss: 0.836047, loss_d: 0.431205
0.6137 --- loss: 1.588646, loss_ss: 1.185890, loss_d: 0.402756
0.6521 --- loss: 1.263382, loss_ss: 0.858921, loss_d: 0.404461
0.6904 --- loss: 2.073061, loss_ss: 1.593757, loss_d: 0.479304
0.7288 --- loss: 1.774142, loss_ss: 1.280448, loss_d: 0.493694
0.7672 --- loss: 1.460529, loss_ss: 0.914339, loss_d: 0.546190
0.8055 --- loss: 1.554260, loss_ss: 1.163599, loss_d: 0.390661
0.8439 --- loss: 1.421576, loss_ss: 1.114700, loss_d: 0.306876
0.8822 --- loss: 1.706013, loss_ss: 1.334435, loss_d: 0.371579
0.9206 --- loss: 1.603449, loss_ss: 1.129512, loss_d: 0.473937
0.9590 --- loss: 1.409738, loss_ss: 0.951487, loss_d: 0.458251
0.9973 --- loss: 1.377972, loss_ss: 1.030450, loss_d: 0.347522
Epoch finished! Loss: 1.5711296714269198
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.595567, loss_ss: 1.264499, loss_d: 0.331068
0.0384 --- loss: 1.481200, loss_ss: 1.088082, loss_d: 0.393118
0.0767 --- loss: 1.231826, loss_ss: 0.931780, loss_d: 0.300047
0.1151 --- loss: 1.512094, loss_ss: 1.193432, loss_d: 0.318662
0.1534 --- loss: 1.391411, loss_ss: 1.075584, loss_d: 0.315827
0.1918 --- loss: 1.428217, loss_ss: 1.144719, loss_d: 0.283497
0.2301 --- loss: 1.621918, loss_ss: 1.120433, loss_d: 0.501486
0.2685 --- loss: 1.373939, loss_ss: 1.109794, loss_d: 0.264145
0.3069 --- loss: 1.493474, loss_ss: 1.164449, loss_d: 0.329024
0.3452 --- loss: 1.563706, loss_ss: 1.184718, loss_d: 0.378988
0.3836 --- loss: 1.628998, loss_ss: 1.281500, loss_d: 0.347498
0.4219 --- loss: 1.292613, loss_ss: 0.909024, loss_d: 0.383588
0.4603 --- loss: 1.401917, loss_ss: 0.919445, loss_d: 0.482471
0.4987 --- loss: 1.476273, loss_ss: 1.064979, loss_d: 0.411294
0.5370 --- loss: 1.489204, loss_ss: 1.021963, loss_d: 0.467241
0.5754 --- loss: 1.727064, loss_ss: 1.166913, loss_d: 0.560151
0.6137 --- loss: 1.462212, loss_ss: 0.822956, loss_d: 0.639255
0.6521 --- loss: 1.768478, loss_ss: 1.305013, loss_d: 0.463465
0.6904 --- loss: 1.895520, loss_ss: 1.214244, loss_d: 0.681277
0.7288 --- loss: 1.992903, loss_ss: 1.600309, loss_d: 0.392594
0.7672 --- loss: 1.409250, loss_ss: 1.125127, loss_d: 0.284122
0.8055 --- loss: 1.353386, loss_ss: 0.863759, loss_d: 0.489627
0.8439 --- loss: 1.282309, loss_ss: 0.997602, loss_d: 0.284707
0.8822 --- loss: 2.166196, loss_ss: 1.080203, loss_d: 1.085993
0.9206 --- loss: 1.262219, loss_ss: 0.965600, loss_d: 0.296619
0.9590 --- loss: 1.546700, loss_ss: 1.089640, loss_d: 0.457060
0.9973 --- loss: 1.559052, loss_ss: 1.283103, loss_d: 0.275949
Epoch finished! Loss: 1.535301404274427
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.412675, loss_ss: 0.912439, loss_d: 0.500236
0.0384 --- loss: 1.717417, loss_ss: 1.103598, loss_d: 0.613819
0.0767 --- loss: 1.560686, loss_ss: 1.081480, loss_d: 0.479206
0.1151 --- loss: 1.453157, loss_ss: 1.088774, loss_d: 0.364383
0.1534 --- loss: 1.334376, loss_ss: 1.063031, loss_d: 0.271345
0.1918 --- loss: 1.314194, loss_ss: 1.115971, loss_d: 0.198223
0.2301 --- loss: 1.359621, loss_ss: 0.979544, loss_d: 0.380076
0.2685 --- loss: 1.280723, loss_ss: 0.963651, loss_d: 0.317073
0.3069 --- loss: 1.237669, loss_ss: 0.964225, loss_d: 0.273444
0.3452 --- loss: 1.424994, loss_ss: 1.046759, loss_d: 0.378236
0.3836 --- loss: 1.321961, loss_ss: 0.967706, loss_d: 0.354255
0.4219 --- loss: 1.842374, loss_ss: 1.036474, loss_d: 0.805901
0.4603 --- loss: 1.334934, loss_ss: 1.063817, loss_d: 0.271117
0.4987 --- loss: 1.413455, loss_ss: 1.112163, loss_d: 0.301292
0.5370 --- loss: 1.632308, loss_ss: 1.299109, loss_d: 0.333199
0.5754 --- loss: 1.172175, loss_ss: 0.865259, loss_d: 0.306916
0.6137 --- loss: 1.302128, loss_ss: 1.011082, loss_d: 0.291047
0.6521 --- loss: 1.650860, loss_ss: 1.304013, loss_d: 0.346847
0.6904 --- loss: 1.914997, loss_ss: 1.389019, loss_d: 0.525978
0.7288 --- loss: 1.574265, loss_ss: 1.222070, loss_d: 0.352195
0.7672 --- loss: 1.455914, loss_ss: 1.004297, loss_d: 0.451617
0.8055 --- loss: 1.536880, loss_ss: 1.183002, loss_d: 0.353878
0.8439 --- loss: 1.223908, loss_ss: 0.920364, loss_d: 0.303544
0.8822 --- loss: 1.183255, loss_ss: 0.838745, loss_d: 0.344510
0.9206 --- loss: 1.220564, loss_ss: 0.897915, loss_d: 0.322649
0.9590 --- loss: 1.901344, loss_ss: 1.253161, loss_d: 0.648183
0.9973 --- loss: 2.263891, loss_ss: 1.861938, loss_d: 0.401953
Epoch finished! Loss: 1.4996855699099028
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.650416, loss_ss: 1.289244, loss_d: 0.361172
0.0384 --- loss: 1.370239, loss_ss: 0.933760, loss_d: 0.436479
0.0767 --- loss: 1.180107, loss_ss: 0.900534, loss_d: 0.279573
0.1151 --- loss: 1.770432, loss_ss: 1.330296, loss_d: 0.440136
0.1534 --- loss: 1.630489, loss_ss: 1.219320, loss_d: 0.411168
0.1918 --- loss: 1.297926, loss_ss: 1.003172, loss_d: 0.294754
0.2301 --- loss: 1.423619, loss_ss: 0.952085, loss_d: 0.471534
0.2685 --- loss: 1.386807, loss_ss: 1.004229, loss_d: 0.382578
0.3069 --- loss: 1.614986, loss_ss: 1.103887, loss_d: 0.511099
0.3452 --- loss: 1.338703, loss_ss: 1.082326, loss_d: 0.256377
0.3836 --- loss: 1.611216, loss_ss: 1.143558, loss_d: 0.467659
0.4219 --- loss: 1.180492, loss_ss: 0.843370, loss_d: 0.337122
0.4603 --- loss: 1.295753, loss_ss: 1.026202, loss_d: 0.269552
0.4987 --- loss: 1.297081, loss_ss: 0.933981, loss_d: 0.363100
0.5370 --- loss: 1.258269, loss_ss: 0.943444, loss_d: 0.314825
0.5754 --- loss: 1.063332, loss_ss: 0.746097, loss_d: 0.317235
0.6137 --- loss: 1.730007, loss_ss: 0.927595, loss_d: 0.802412
0.6521 --- loss: 1.319261, loss_ss: 0.919448, loss_d: 0.399813
0.6904 --- loss: 1.345148, loss_ss: 0.940247, loss_d: 0.404901
0.7288 --- loss: 1.417487, loss_ss: 1.103283, loss_d: 0.314204
0.7672 --- loss: 1.446874, loss_ss: 1.148024, loss_d: 0.298850
0.8055 --- loss: 1.344895, loss_ss: 1.063434, loss_d: 0.281461
0.8439 --- loss: 1.455756, loss_ss: 0.938499, loss_d: 0.517257
0.8822 --- loss: 1.286233, loss_ss: 1.039042, loss_d: 0.247190
0.9206 --- loss: 1.309181, loss_ss: 0.877794, loss_d: 0.431387
0.9590 --- loss: 2.152997, loss_ss: 0.991429, loss_d: 1.161568
0.9973 --- loss: 1.721961, loss_ss: 1.268766, loss_d: 0.453195
Epoch finished! Loss: 1.5042393010396224
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5032258064516129
             precision    recall  f1-score   support

        0.0       1.00      0.04      0.08       226
        1.0       0.22      0.16      0.19        55
        2.0       0.71      0.83      0.77       410
        3.0       0.00      0.00      0.00       108
        4.0       0.27      0.82      0.41       131

avg / total       0.61      0.50      0.43       930
 


====== chc016-nsrr ======

The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  76.67   3.98  100.00  100.00      7.66
1  91.61  16.36   96.34   21.95     18.75
2  77.96  83.41   73.65   71.40     76.94
3  88.39   0.00  100.00    0.00      0.00
4  66.02  82.44   63.33   26.93     40.60
Total accuracy: 50.32%
Average sen: 37.24%
Average spec: 86.67%
Macro f1-score: 28.79%
[0.9873116  0.99484009 0.9955188  0.99218518 0.98793519 0.99216157
 0.98892599 0.97357768 0.98924839 0.99143726 0.98874146 0.99096668
 0.99169075 0.99206382 0.9874599  0.98636985 0.98543733 0.99008334
 0.98835397 0.99178714 0.9877159  0.97376472 0.96750313 0.9847157
 0.99087006 0.98610604 0.98965293 0.98630792 0.98205698 0.98986632
 0.99280471]
pred: 0.9876600119375414, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.231824, loss_ss: 1.516409, loss_d: 0.715415
0.0383 --- loss: 2.412420, loss_ss: 1.859431, loss_d: 0.552989
0.0766 --- loss: 2.074984, loss_ss: 1.545825, loss_d: 0.529158
0.1149 --- loss: 2.451571, loss_ss: 1.743457, loss_d: 0.708114
0.1532 --- loss: 2.816181, loss_ss: 1.455488, loss_d: 1.360693
0.1915 --- loss: 2.263484, loss_ss: 1.580372, loss_d: 0.683112
0.2298 --- loss: 2.178518, loss_ss: 1.522997, loss_d: 0.655521
0.2681 --- loss: 1.967432, loss_ss: 1.561552, loss_d: 0.405880
0.3064 --- loss: 2.314945, loss_ss: 1.793275, loss_d: 0.521670
0.3447 --- loss: 2.030258, loss_ss: 1.439356, loss_d: 0.590902
0.3830 --- loss: 2.013794, loss_ss: 1.551340, loss_d: 0.462455
0.4213 --- loss: 1.912252, loss_ss: 1.499244, loss_d: 0.413007
0.4596 --- loss: 2.216568, loss_ss: 1.562536, loss_d: 0.654032
0.4979 --- loss: 1.951466, loss_ss: 1.699871, loss_d: 0.251595
0.5362 --- loss: 2.374808, loss_ss: 1.517786, loss_d: 0.857022
0.5745 --- loss: 2.382577, loss_ss: 1.768445, loss_d: 0.614131
0.6128 --- loss: 2.069071, loss_ss: 1.545112, loss_d: 0.523959
0.6511 --- loss: 1.919648, loss_ss: 1.451051, loss_d: 0.468598
0.6894 --- loss: 2.192943, loss_ss: 1.656031, loss_d: 0.536911
0.7277 --- loss: 2.105650, loss_ss: 1.538371, loss_d: 0.567279
0.7660 --- loss: 2.178151, loss_ss: 1.769345, loss_d: 0.408806
0.8043 --- loss: 1.841335, loss_ss: 1.358759, loss_d: 0.482576
0.8426 --- loss: 2.072049, loss_ss: 1.483793, loss_d: 0.588256
0.8809 --- loss: 1.973440, loss_ss: 1.543550, loss_d: 0.429890
0.9192 --- loss: 1.804911, loss_ss: 1.410546, loss_d: 0.394365
0.9575 --- loss: 1.927288, loss_ss: 1.519463, loss_d: 0.407825
0.9958 --- loss: 2.675688, loss_ss: 1.441944, loss_d: 1.233745
Epoch finished! Loss: 2.1277492366074604
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.991179, loss_ss: 1.602579, loss_d: 0.388599
0.0383 --- loss: 1.948640, loss_ss: 1.437602, loss_d: 0.511038
0.0766 --- loss: 1.785116, loss_ss: 1.489292, loss_d: 0.295825
0.1149 --- loss: 1.895366, loss_ss: 1.405591, loss_d: 0.489775
0.1532 --- loss: 2.252743, loss_ss: 1.487097, loss_d: 0.765645
0.1915 --- loss: 1.930541, loss_ss: 1.515296, loss_d: 0.415245
0.2298 --- loss: 2.072886, loss_ss: 1.562613, loss_d: 0.510273
0.2681 --- loss: 1.873541, loss_ss: 1.428779, loss_d: 0.444762
0.3064 --- loss: 2.096711, loss_ss: 1.630311, loss_d: 0.466401
0.3447 --- loss: 1.892104, loss_ss: 1.415377, loss_d: 0.476727
0.3830 --- loss: 1.833967, loss_ss: 1.442937, loss_d: 0.391030
0.4213 --- loss: 1.703093, loss_ss: 1.449522, loss_d: 0.253571
0.4596 --- loss: 2.105427, loss_ss: 1.472842, loss_d: 0.632585
0.4979 --- loss: 2.508672, loss_ss: 1.684016, loss_d: 0.824656
0.5362 --- loss: 2.317532, loss_ss: 1.560583, loss_d: 0.756950
0.5745 --- loss: 2.494025, loss_ss: 1.797202, loss_d: 0.696824
0.6128 --- loss: 1.808571, loss_ss: 1.387125, loss_d: 0.421446
0.6511 --- loss: 2.083991, loss_ss: 1.527909, loss_d: 0.556082
0.6894 --- loss: 1.846751, loss_ss: 1.417507, loss_d: 0.429244
0.7277 --- loss: 1.917910, loss_ss: 1.421579, loss_d: 0.496330
0.7660 --- loss: 1.798338, loss_ss: 1.449358, loss_d: 0.348981
0.8043 --- loss: 2.097690, loss_ss: 1.524637, loss_d: 0.573054
0.8426 --- loss: 2.315765, loss_ss: 1.561944, loss_d: 0.753821
0.8809 --- loss: 1.956241, loss_ss: 1.617663, loss_d: 0.338578
0.9192 --- loss: 2.011889, loss_ss: 1.614124, loss_d: 0.397764
0.9575 --- loss: 2.173979, loss_ss: 1.505476, loss_d: 0.668503
0.9958 --- loss: 1.814164, loss_ss: 1.375213, loss_d: 0.438951
Epoch finished! Loss: 2.0084872930899436
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.972463, loss_ss: 1.437361, loss_d: 0.535102
0.0383 --- loss: 2.122807, loss_ss: 1.653648, loss_d: 0.469159
0.0766 --- loss: 1.799798, loss_ss: 1.381993, loss_d: 0.417805
0.1149 --- loss: 2.153936, loss_ss: 1.583890, loss_d: 0.570047
0.1532 --- loss: 1.877232, loss_ss: 1.464090, loss_d: 0.413141
0.1915 --- loss: 1.725586, loss_ss: 1.249928, loss_d: 0.475658
0.2298 --- loss: 1.983433, loss_ss: 1.332636, loss_d: 0.650797
0.2681 --- loss: 1.623549, loss_ss: 1.276109, loss_d: 0.347439
0.3064 --- loss: 1.734585, loss_ss: 1.248301, loss_d: 0.486283
0.3447 --- loss: 1.892596, loss_ss: 1.472571, loss_d: 0.420025
0.3830 --- loss: 1.633288, loss_ss: 1.289263, loss_d: 0.344025
0.4213 --- loss: 2.152399, loss_ss: 1.470086, loss_d: 0.682313
0.4596 --- loss: 1.802552, loss_ss: 1.382666, loss_d: 0.419886
0.4979 --- loss: 1.761137, loss_ss: 1.417098, loss_d: 0.344039
0.5362 --- loss: 2.446610, loss_ss: 1.640198, loss_d: 0.806412
0.5745 --- loss: 1.718603, loss_ss: 1.447748, loss_d: 0.270855
0.6128 --- loss: 1.998341, loss_ss: 1.453509, loss_d: 0.544832
0.6511 --- loss: 1.725417, loss_ss: 1.409274, loss_d: 0.316143
0.6894 --- loss: 1.972260, loss_ss: 1.351527, loss_d: 0.620733
0.7277 --- loss: 1.925756, loss_ss: 1.458883, loss_d: 0.466873
0.7660 --- loss: 1.718668, loss_ss: 1.400790, loss_d: 0.317878
0.8043 --- loss: 1.969365, loss_ss: 1.252768, loss_d: 0.716596
0.8426 --- loss: 1.978756, loss_ss: 1.389394, loss_d: 0.589362
0.8809 --- loss: 1.744193, loss_ss: 1.319524, loss_d: 0.424669
0.9192 --- loss: 2.021537, loss_ss: 1.326052, loss_d: 0.695484
0.9575 --- loss: 2.346011, loss_ss: 1.433769, loss_d: 0.912242
0.9958 --- loss: 1.875926, loss_ss: 1.502411, loss_d: 0.373515
Epoch finished! Loss: 1.9164432638906428
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.100283, loss_ss: 1.205900, loss_d: 0.894383
0.0383 --- loss: 2.048460, loss_ss: 1.495916, loss_d: 0.552544
0.0766 --- loss: 2.134235, loss_ss: 1.454453, loss_d: 0.679781
0.1149 --- loss: 2.059827, loss_ss: 1.376126, loss_d: 0.683701
0.1532 --- loss: 1.733274, loss_ss: 1.411355, loss_d: 0.321918
0.1915 --- loss: 1.830240, loss_ss: 1.488148, loss_d: 0.342091
0.2298 --- loss: 1.334993, loss_ss: 1.044393, loss_d: 0.290600
0.2681 --- loss: 1.775717, loss_ss: 1.420290, loss_d: 0.355427
0.3064 --- loss: 1.883486, loss_ss: 1.265211, loss_d: 0.618275
0.3447 --- loss: 1.629960, loss_ss: 1.172050, loss_d: 0.457910
0.3830 --- loss: 1.711063, loss_ss: 1.236025, loss_d: 0.475038
0.4213 --- loss: 1.548232, loss_ss: 1.080563, loss_d: 0.467669
0.4596 --- loss: 1.716821, loss_ss: 1.341493, loss_d: 0.375328
0.4979 --- loss: 1.613806, loss_ss: 1.143370, loss_d: 0.470436
0.5362 --- loss: 1.625511, loss_ss: 1.297830, loss_d: 0.327681
0.5745 --- loss: 1.702327, loss_ss: 1.329976, loss_d: 0.372352
0.6128 --- loss: 1.698071, loss_ss: 1.185449, loss_d: 0.512621
0.6511 --- loss: 1.702053, loss_ss: 1.413937, loss_d: 0.288116
0.6894 --- loss: 2.023317, loss_ss: 1.523076, loss_d: 0.500241
0.7277 --- loss: 1.735851, loss_ss: 1.516244, loss_d: 0.219607
0.7660 --- loss: 2.106916, loss_ss: 1.514758, loss_d: 0.592158
0.8043 --- loss: 1.821969, loss_ss: 1.315365, loss_d: 0.506604
0.8426 --- loss: 1.716826, loss_ss: 1.217455, loss_d: 0.499371
0.8809 --- loss: 1.775002, loss_ss: 1.281132, loss_d: 0.493871
0.9192 --- loss: 1.870822, loss_ss: 1.398780, loss_d: 0.472043
0.9575 --- loss: 1.830146, loss_ss: 1.300419, loss_d: 0.529727
0.9958 --- loss: 1.880290, loss_ss: 1.169297, loss_d: 0.710994
Epoch finished! Loss: 1.8104682649232418
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.680684, loss_ss: 1.120607, loss_d: 0.560077
0.0383 --- loss: 1.567188, loss_ss: 1.236169, loss_d: 0.331019
0.0766 --- loss: 1.578985, loss_ss: 1.130525, loss_d: 0.448460
0.1149 --- loss: 1.495311, loss_ss: 1.195213, loss_d: 0.300097
0.1532 --- loss: 1.452513, loss_ss: 1.155247, loss_d: 0.297266
0.1915 --- loss: 1.645173, loss_ss: 1.259340, loss_d: 0.385832
0.2298 --- loss: 1.406143, loss_ss: 1.079795, loss_d: 0.326348
0.2681 --- loss: 1.586276, loss_ss: 1.126989, loss_d: 0.459287
0.3064 --- loss: 1.319292, loss_ss: 1.043147, loss_d: 0.276144
0.3447 --- loss: 1.594155, loss_ss: 1.268550, loss_d: 0.325605
0.3830 --- loss: 1.639578, loss_ss: 1.292713, loss_d: 0.346865
0.4213 --- loss: 1.568564, loss_ss: 1.109922, loss_d: 0.458642
0.4596 --- loss: 1.627396, loss_ss: 1.181195, loss_d: 0.446201
0.4979 --- loss: 1.617962, loss_ss: 1.193567, loss_d: 0.424395
0.5362 --- loss: 1.280126, loss_ss: 0.915999, loss_d: 0.364127
0.5745 --- loss: 1.770727, loss_ss: 1.192667, loss_d: 0.578060
0.6128 --- loss: 1.411951, loss_ss: 1.116683, loss_d: 0.295268
0.6511 --- loss: 1.349215, loss_ss: 1.038712, loss_d: 0.310503
0.6894 --- loss: 1.334103, loss_ss: 0.959973, loss_d: 0.374130
0.7277 --- loss: 2.033798, loss_ss: 1.368246, loss_d: 0.665552
0.7660 --- loss: 1.493877, loss_ss: 1.022849, loss_d: 0.471028
0.8043 --- loss: 1.720859, loss_ss: 1.091859, loss_d: 0.629000
0.8426 --- loss: 1.673792, loss_ss: 1.178573, loss_d: 0.495219
0.8809 --- loss: 1.438198, loss_ss: 1.176422, loss_d: 0.261775
0.9192 --- loss: 1.737617, loss_ss: 1.400255, loss_d: 0.337362
0.9575 --- loss: 1.783947, loss_ss: 1.444356, loss_d: 0.339591
0.9958 --- loss: 1.867882, loss_ss: 1.362294, loss_d: 0.505588
Epoch finished! Loss: 1.6689899698527837
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.428366, loss_ss: 1.093563, loss_d: 0.334803
0.0383 --- loss: 1.478273, loss_ss: 1.095058, loss_d: 0.383216
0.0766 --- loss: 1.535973, loss_ss: 1.191052, loss_d: 0.344921
0.1149 --- loss: 1.984892, loss_ss: 1.038457, loss_d: 0.946435
0.1532 --- loss: 1.334815, loss_ss: 0.971086, loss_d: 0.363729
0.1915 --- loss: 1.532381, loss_ss: 1.161706, loss_d: 0.370675
0.2298 --- loss: 1.440377, loss_ss: 1.068367, loss_d: 0.372010
0.2681 --- loss: 1.642984, loss_ss: 1.281628, loss_d: 0.361356
0.3064 --- loss: 1.610954, loss_ss: 1.150373, loss_d: 0.460582
0.3447 --- loss: 1.237514, loss_ss: 0.946150, loss_d: 0.291365
0.3830 --- loss: 1.798408, loss_ss: 1.044227, loss_d: 0.754181
0.4213 --- loss: 1.672951, loss_ss: 1.324121, loss_d: 0.348829
0.4596 --- loss: 1.555619, loss_ss: 1.023018, loss_d: 0.532601
0.4979 --- loss: 1.795989, loss_ss: 1.558063, loss_d: 0.237927
0.5362 --- loss: 1.247580, loss_ss: 0.970664, loss_d: 0.276916
0.5745 --- loss: 1.360543, loss_ss: 1.043141, loss_d: 0.317402
0.6128 --- loss: 1.531639, loss_ss: 1.206091, loss_d: 0.325548
0.6511 --- loss: 1.618702, loss_ss: 1.193877, loss_d: 0.424825
0.6894 --- loss: 1.408219, loss_ss: 1.084944, loss_d: 0.323274
0.7277 --- loss: 1.705050, loss_ss: 0.938290, loss_d: 0.766760
0.7660 --- loss: 1.961623, loss_ss: 1.357656, loss_d: 0.603968
0.8043 --- loss: 1.332841, loss_ss: 1.016412, loss_d: 0.316429
0.8426 --- loss: 1.348654, loss_ss: 1.051147, loss_d: 0.297507
0.8809 --- loss: 1.458322, loss_ss: 0.977501, loss_d: 0.480821
0.9192 --- loss: 2.047200, loss_ss: 1.104126, loss_d: 0.943074
0.9575 --- loss: 2.120741, loss_ss: 1.070068, loss_d: 1.050673
0.9958 --- loss: 1.595139, loss_ss: 1.213477, loss_d: 0.381663
Epoch finished! Loss: 1.6047518828819538
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.535149, loss_ss: 1.049460, loss_d: 0.485689
0.0383 --- loss: 1.304218, loss_ss: 0.979696, loss_d: 0.324522
0.0766 --- loss: 1.644832, loss_ss: 1.366811, loss_d: 0.278021
0.1149 --- loss: 1.545975, loss_ss: 1.097334, loss_d: 0.448641
0.1532 --- loss: 1.492681, loss_ss: 0.991689, loss_d: 0.500992
0.1915 --- loss: 1.581285, loss_ss: 1.319747, loss_d: 0.261538
0.2298 --- loss: 1.280854, loss_ss: 1.084392, loss_d: 0.196462
0.2681 --- loss: 1.691775, loss_ss: 1.333388, loss_d: 0.358387
0.3064 --- loss: 1.424741, loss_ss: 1.095992, loss_d: 0.328748
0.3447 --- loss: 1.459765, loss_ss: 0.977986, loss_d: 0.481779
0.3830 --- loss: 2.222589, loss_ss: 1.021374, loss_d: 1.201214
0.4213 --- loss: 1.640601, loss_ss: 1.111712, loss_d: 0.528889
0.4596 --- loss: 1.416208, loss_ss: 1.036023, loss_d: 0.380185
0.4979 --- loss: 1.195247, loss_ss: 0.801422, loss_d: 0.393825
0.5362 --- loss: 1.287806, loss_ss: 0.916746, loss_d: 0.371060
0.5745 --- loss: 1.433021, loss_ss: 1.120323, loss_d: 0.312698
0.6128 --- loss: 1.446627, loss_ss: 1.134129, loss_d: 0.312498
0.6511 --- loss: 1.152516, loss_ss: 0.943552, loss_d: 0.208964
0.6894 --- loss: 1.587153, loss_ss: 1.315278, loss_d: 0.271874
0.7277 --- loss: 1.450986, loss_ss: 0.998394, loss_d: 0.452593
0.7660 --- loss: 2.114549, loss_ss: 1.609806, loss_d: 0.504743
0.8043 --- loss: 1.611980, loss_ss: 1.284403, loss_d: 0.327577
0.8426 --- loss: 1.561550, loss_ss: 1.163993, loss_d: 0.397557
0.8809 --- loss: 1.241257, loss_ss: 0.789621, loss_d: 0.451636
0.9192 --- loss: 1.416207, loss_ss: 0.942313, loss_d: 0.473894
0.9575 --- loss: 1.742254, loss_ss: 1.306015, loss_d: 0.436239
0.9958 --- loss: 1.823338, loss_ss: 1.311898, loss_d: 0.511440
Epoch finished! Loss: 1.583904125224585
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.046474, loss_ss: 1.302794, loss_d: 0.743680
0.0383 --- loss: 1.257959, loss_ss: 0.992476, loss_d: 0.265483
0.0766 --- loss: 1.637019, loss_ss: 1.218681, loss_d: 0.418338
0.1149 --- loss: 1.344479, loss_ss: 1.134727, loss_d: 0.209752
0.1532 --- loss: 1.692627, loss_ss: 1.322681, loss_d: 0.369946
0.1915 --- loss: 1.630224, loss_ss: 1.385488, loss_d: 0.244735
0.2298 --- loss: 1.944644, loss_ss: 1.471435, loss_d: 0.473209
0.2681 --- loss: 1.725623, loss_ss: 1.220434, loss_d: 0.505188
0.3064 --- loss: 1.814172, loss_ss: 1.460565, loss_d: 0.353606
0.3447 --- loss: 1.591548, loss_ss: 1.091005, loss_d: 0.500543
0.3830 --- loss: 1.588919, loss_ss: 1.172626, loss_d: 0.416293
0.4213 --- loss: 1.143997, loss_ss: 0.917328, loss_d: 0.226669
0.4596 --- loss: 2.449019, loss_ss: 1.822450, loss_d: 0.626569
0.4979 --- loss: 1.129311, loss_ss: 0.926489, loss_d: 0.202823
0.5362 --- loss: 1.394847, loss_ss: 1.136412, loss_d: 0.258435
0.5745 --- loss: 1.682904, loss_ss: 1.102842, loss_d: 0.580062
0.6128 --- loss: 2.127851, loss_ss: 1.008229, loss_d: 1.119622
0.6511 --- loss: 1.456952, loss_ss: 1.162695, loss_d: 0.294257
0.6894 --- loss: 2.366136, loss_ss: 1.126831, loss_d: 1.239304
0.7277 --- loss: 1.631973, loss_ss: 1.219737, loss_d: 0.412236
0.7660 --- loss: 1.382760, loss_ss: 1.078343, loss_d: 0.304418
0.8043 --- loss: 1.659257, loss_ss: 1.361271, loss_d: 0.297986
0.8426 --- loss: 1.419671, loss_ss: 1.159994, loss_d: 0.259677
0.8809 --- loss: 1.590235, loss_ss: 1.225761, loss_d: 0.364474
0.9192 --- loss: 1.518900, loss_ss: 1.234377, loss_d: 0.284523
0.9575 --- loss: 1.628498, loss_ss: 1.169647, loss_d: 0.458851
0.9958 --- loss: 1.265065, loss_ss: 1.020143, loss_d: 0.244922
Epoch finished! Loss: 1.5560184488808058
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.684898, loss_ss: 1.276612, loss_d: 0.408285
0.0383 --- loss: 1.695147, loss_ss: 1.174927, loss_d: 0.520220
0.0766 --- loss: 1.758590, loss_ss: 1.407471, loss_d: 0.351119
0.1149 --- loss: 1.363775, loss_ss: 0.993422, loss_d: 0.370353
0.1532 --- loss: 1.610096, loss_ss: 1.168543, loss_d: 0.441552
0.1915 --- loss: 1.527159, loss_ss: 0.995810, loss_d: 0.531350
0.2298 --- loss: 1.584287, loss_ss: 1.082329, loss_d: 0.501957
0.2681 --- loss: 1.698771, loss_ss: 1.281416, loss_d: 0.417355
0.3064 --- loss: 1.234882, loss_ss: 0.917221, loss_d: 0.317661
0.3447 --- loss: 1.468744, loss_ss: 1.054991, loss_d: 0.413752
0.3830 --- loss: 1.658207, loss_ss: 1.372971, loss_d: 0.285236
0.4213 --- loss: 1.510617, loss_ss: 1.086143, loss_d: 0.424474
0.4596 --- loss: 1.692920, loss_ss: 1.160660, loss_d: 0.532260
0.4979 --- loss: 1.814905, loss_ss: 1.171829, loss_d: 0.643076
0.5362 --- loss: 1.275666, loss_ss: 1.027179, loss_d: 0.248487
0.5745 --- loss: 1.980676, loss_ss: 1.064698, loss_d: 0.915979
0.6128 --- loss: 1.467149, loss_ss: 0.994853, loss_d: 0.472296
0.6511 --- loss: 1.587612, loss_ss: 1.296949, loss_d: 0.290663
0.6894 --- loss: 1.330399, loss_ss: 1.045970, loss_d: 0.284429
0.7277 --- loss: 1.399915, loss_ss: 1.078674, loss_d: 0.321240
0.7660 --- loss: 1.220602, loss_ss: 0.913696, loss_d: 0.306906
0.8043 --- loss: 1.489776, loss_ss: 1.054148, loss_d: 0.435629
0.8426 --- loss: 1.806435, loss_ss: 1.263094, loss_d: 0.543341
0.8809 --- loss: 1.584441, loss_ss: 1.315525, loss_d: 0.268916
0.9192 --- loss: 1.667894, loss_ss: 1.158575, loss_d: 0.509319
0.9575 --- loss: 1.349258, loss_ss: 0.848675, loss_d: 0.500583
0.9958 --- loss: 1.265551, loss_ss: 0.971492, loss_d: 0.294059
Epoch finished! Loss: 1.5448603771655496
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.469923, loss_ss: 1.132616, loss_d: 0.337307
0.0383 --- loss: 1.804318, loss_ss: 1.025740, loss_d: 0.778578
0.0766 --- loss: 2.060473, loss_ss: 1.296295, loss_d: 0.764178
0.1149 --- loss: 1.259131, loss_ss: 0.926910, loss_d: 0.332221
0.1532 --- loss: 1.226637, loss_ss: 0.851015, loss_d: 0.375622
0.1915 --- loss: 1.286604, loss_ss: 0.937274, loss_d: 0.349330
0.2298 --- loss: 1.602663, loss_ss: 1.207841, loss_d: 0.394823
0.2681 --- loss: 1.585968, loss_ss: 1.238084, loss_d: 0.347884
0.3064 --- loss: 1.580319, loss_ss: 1.039683, loss_d: 0.540636
0.3447 --- loss: 1.405888, loss_ss: 1.017201, loss_d: 0.388687
0.3830 --- loss: 1.546551, loss_ss: 1.010975, loss_d: 0.535576
0.4213 --- loss: 1.429531, loss_ss: 1.171818, loss_d: 0.257713
0.4596 --- loss: 1.639656, loss_ss: 1.258022, loss_d: 0.381634
0.4979 --- loss: 2.029899, loss_ss: 1.632438, loss_d: 0.397461
0.5362 --- loss: 1.541355, loss_ss: 1.021074, loss_d: 0.520280
0.5745 --- loss: 1.476456, loss_ss: 1.019921, loss_d: 0.456534
0.6128 --- loss: 1.524395, loss_ss: 0.982355, loss_d: 0.542039
0.6511 --- loss: 1.661516, loss_ss: 1.053094, loss_d: 0.608423
0.6894 --- loss: 1.523303, loss_ss: 1.195959, loss_d: 0.327344
0.7277 --- loss: 1.192770, loss_ss: 0.946043, loss_d: 0.246727
0.7660 --- loss: 1.500781, loss_ss: 1.170315, loss_d: 0.330466
0.8043 --- loss: 1.153999, loss_ss: 0.788074, loss_d: 0.365926
0.8426 --- loss: 1.230069, loss_ss: 0.892935, loss_d: 0.337134
0.8809 --- loss: 1.396065, loss_ss: 0.943165, loss_d: 0.452900
0.9192 --- loss: 1.405454, loss_ss: 1.148649, loss_d: 0.256805
0.9575 --- loss: 1.300572, loss_ss: 0.952207, loss_d: 0.348365
0.9958 --- loss: 1.359798, loss_ss: 0.989476, loss_d: 0.370322
Epoch finished! Loss: 1.5180163954409602
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.15925925925925927
             precision    recall  f1-score   support

        0.0       0.10      0.17      0.13       102
        1.0       0.00      0.00      0.00        15
        2.0       0.09      0.01      0.01       397
        3.0       0.00      0.00      0.00       187
        4.0       0.18      1.00      0.30       109

avg / total       0.08      0.16      0.06       810
 


====== chc022-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  70.99   16.67   78.81  10.18     12.64
1  98.15    0.00  100.00   0.00      0.00
2  47.65    0.76   92.74   9.09      1.40
3  76.91    0.00  100.00   0.00      0.00
4  38.15  100.00   28.53  17.87     30.32
Total accuracy: 15.93%
Average sen: 23.48%
Average spec: 80.02%
Macro f1-score: 8.87%
[0.86192179 0.69463533 0.69117296 0.6675874  0.62433392 0.51788098
 0.64283681 0.66984195 0.54015493 0.54499871 0.6533069  0.65424401
 0.56443304 0.69278991 0.67439479 0.67033464 0.67067152 0.65798116
 0.56197053 0.58652472 0.66726363 0.79272568 0.67024434 0.67247373
 0.67076093 0.68827462 0.67105085]
pred: 0.6546225834775854, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.216927, loss_ss: 1.503631, loss_d: 0.713296
0.0383 --- loss: 1.971592, loss_ss: 1.615661, loss_d: 0.355931
0.0766 --- loss: 2.057271, loss_ss: 1.438690, loss_d: 0.618581
0.1149 --- loss: 1.938187, loss_ss: 1.468121, loss_d: 0.470066
0.1532 --- loss: 2.013066, loss_ss: 1.611057, loss_d: 0.402008
0.1915 --- loss: 1.970144, loss_ss: 1.513409, loss_d: 0.456735
0.2298 --- loss: 1.967468, loss_ss: 1.647999, loss_d: 0.319469
0.2681 --- loss: 2.052683, loss_ss: 1.554088, loss_d: 0.498595
0.3064 --- loss: 2.335126, loss_ss: 1.585513, loss_d: 0.749613
0.3447 --- loss: 2.070120, loss_ss: 1.376493, loss_d: 0.693627
0.3830 --- loss: 1.838907, loss_ss: 1.478613, loss_d: 0.360294
0.4213 --- loss: 2.168444, loss_ss: 1.407102, loss_d: 0.761343
0.4596 --- loss: 2.024734, loss_ss: 1.548808, loss_d: 0.475926
0.4979 --- loss: 2.125147, loss_ss: 1.525953, loss_d: 0.599194
0.5362 --- loss: 2.068520, loss_ss: 1.639461, loss_d: 0.429059
0.5745 --- loss: 1.997232, loss_ss: 1.624582, loss_d: 0.372650
0.6128 --- loss: 1.840892, loss_ss: 1.373378, loss_d: 0.467515
0.6511 --- loss: 1.882547, loss_ss: 1.407698, loss_d: 0.474849
0.6894 --- loss: 1.878405, loss_ss: 1.332632, loss_d: 0.545773
0.7277 --- loss: 1.810957, loss_ss: 1.536311, loss_d: 0.274647
0.7660 --- loss: 1.717355, loss_ss: 1.335798, loss_d: 0.381557
0.8043 --- loss: 1.937002, loss_ss: 1.479432, loss_d: 0.457570
0.8426 --- loss: 2.283661, loss_ss: 1.647504, loss_d: 0.636157
0.8809 --- loss: 2.341877, loss_ss: 1.575445, loss_d: 0.766432
0.9192 --- loss: 1.737356, loss_ss: 1.384783, loss_d: 0.352574
0.9575 --- loss: 1.940066, loss_ss: 1.485659, loss_d: 0.454408
0.9958 --- loss: 1.999629, loss_ss: 1.407065, loss_d: 0.592564
Epoch finished! Loss: 2.0760470190267455
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.983940, loss_ss: 1.531543, loss_d: 0.452397
0.0383 --- loss: 1.930002, loss_ss: 1.489929, loss_d: 0.440074
0.0766 --- loss: 2.238755, loss_ss: 1.402634, loss_d: 0.836120
0.1149 --- loss: 1.800405, loss_ss: 1.405020, loss_d: 0.395385
0.1532 --- loss: 2.398214, loss_ss: 1.722643, loss_d: 0.675570
0.1915 --- loss: 2.272760, loss_ss: 1.647906, loss_d: 0.624854
0.2298 --- loss: 1.924561, loss_ss: 1.578102, loss_d: 0.346460
0.2681 --- loss: 2.187690, loss_ss: 1.416918, loss_d: 0.770772
0.3064 --- loss: 1.852746, loss_ss: 1.401564, loss_d: 0.451182
0.3447 --- loss: 1.899991, loss_ss: 1.348604, loss_d: 0.551387
0.3830 --- loss: 1.778839, loss_ss: 1.449695, loss_d: 0.329144
0.4213 --- loss: 1.793927, loss_ss: 1.371834, loss_d: 0.422094
0.4596 --- loss: 1.913361, loss_ss: 1.396652, loss_d: 0.516710
0.4979 --- loss: 2.066145, loss_ss: 1.376384, loss_d: 0.689761
0.5362 --- loss: 1.869990, loss_ss: 1.372533, loss_d: 0.497457
0.5745 --- loss: 1.861395, loss_ss: 1.397766, loss_d: 0.463629
0.6128 --- loss: 2.518658, loss_ss: 1.592183, loss_d: 0.926475
0.6511 --- loss: 1.665776, loss_ss: 1.311496, loss_d: 0.354280
0.6894 --- loss: 1.719651, loss_ss: 1.397716, loss_d: 0.321935
0.7277 --- loss: 1.728362, loss_ss: 1.403404, loss_d: 0.324958
0.7660 --- loss: 1.681332, loss_ss: 1.384153, loss_d: 0.297180
0.8043 --- loss: 1.903093, loss_ss: 1.487115, loss_d: 0.415978
0.8426 --- loss: 2.092158, loss_ss: 1.467341, loss_d: 0.624818
0.8809 --- loss: 1.737327, loss_ss: 1.357786, loss_d: 0.379541
0.9192 --- loss: 2.844244, loss_ss: 1.461777, loss_d: 1.382467
0.9575 --- loss: 1.836990, loss_ss: 1.268432, loss_d: 0.568557
0.9958 --- loss: 2.148890, loss_ss: 1.470294, loss_d: 0.678596
Epoch finished! Loss: 1.972225196060093
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.914761, loss_ss: 1.564904, loss_d: 0.349857
0.0383 --- loss: 1.637373, loss_ss: 1.258177, loss_d: 0.379196
0.0766 --- loss: 2.052278, loss_ss: 1.510399, loss_d: 0.541879
0.1149 --- loss: 1.906169, loss_ss: 1.487416, loss_d: 0.418753
0.1532 --- loss: 1.898584, loss_ss: 1.489640, loss_d: 0.408944
0.1915 --- loss: 1.739921, loss_ss: 1.433754, loss_d: 0.306167
0.2298 --- loss: 2.107728, loss_ss: 1.354809, loss_d: 0.752919
0.2681 --- loss: 2.008274, loss_ss: 1.437021, loss_d: 0.571253
0.3064 --- loss: 2.061613, loss_ss: 1.621028, loss_d: 0.440585
0.3447 --- loss: 1.720990, loss_ss: 1.213305, loss_d: 0.507685
0.3830 --- loss: 1.971415, loss_ss: 1.412995, loss_d: 0.558421
0.4213 --- loss: 2.094980, loss_ss: 1.508697, loss_d: 0.586283
0.4596 --- loss: 1.640749, loss_ss: 1.321286, loss_d: 0.319463
0.4979 --- loss: 1.601802, loss_ss: 1.341879, loss_d: 0.259922
0.5362 --- loss: 1.861041, loss_ss: 1.266681, loss_d: 0.594360
0.5745 --- loss: 1.922665, loss_ss: 1.455217, loss_d: 0.467448
0.6128 --- loss: 1.697935, loss_ss: 1.307157, loss_d: 0.390778
0.6511 --- loss: 1.912952, loss_ss: 1.536116, loss_d: 0.376837
0.6894 --- loss: 2.031686, loss_ss: 1.568179, loss_d: 0.463506
0.7277 --- loss: 2.172369, loss_ss: 1.459386, loss_d: 0.712983
0.7660 --- loss: 1.852911, loss_ss: 1.423739, loss_d: 0.429172
0.8043 --- loss: 1.729002, loss_ss: 1.331663, loss_d: 0.397339
0.8426 --- loss: 1.774802, loss_ss: 1.332579, loss_d: 0.442223
0.8809 --- loss: 2.013159, loss_ss: 1.427012, loss_d: 0.586147
0.9192 --- loss: 2.175201, loss_ss: 1.648729, loss_d: 0.526472
0.9575 --- loss: 2.060097, loss_ss: 1.482262, loss_d: 0.577835
0.9958 --- loss: 1.522167, loss_ss: 1.056029, loss_d: 0.466138
Epoch finished! Loss: 1.9259850997120942
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.042005, loss_ss: 1.514436, loss_d: 0.527568
0.0383 --- loss: 1.633376, loss_ss: 1.102029, loss_d: 0.531347
0.0766 --- loss: 1.656005, loss_ss: 1.244836, loss_d: 0.411168
0.1149 --- loss: 1.721580, loss_ss: 1.351207, loss_d: 0.370373
0.1532 --- loss: 2.034799, loss_ss: 1.503374, loss_d: 0.531425
0.1915 --- loss: 1.785145, loss_ss: 1.402586, loss_d: 0.382559
0.2298 --- loss: 1.921817, loss_ss: 1.443066, loss_d: 0.478751
0.2681 --- loss: 2.014286, loss_ss: 1.374648, loss_d: 0.639638
0.3064 --- loss: 1.663034, loss_ss: 1.363867, loss_d: 0.299167
0.3447 --- loss: 1.921008, loss_ss: 1.374434, loss_d: 0.546575
0.3830 --- loss: 1.556048, loss_ss: 1.075485, loss_d: 0.480563
0.4213 --- loss: 1.713447, loss_ss: 1.275678, loss_d: 0.437769
0.4596 --- loss: 1.537121, loss_ss: 1.028985, loss_d: 0.508136
0.4979 --- loss: 1.736268, loss_ss: 1.108539, loss_d: 0.627729
0.5362 --- loss: 1.616217, loss_ss: 1.237727, loss_d: 0.378491
0.5745 --- loss: 1.903183, loss_ss: 1.548043, loss_d: 0.355139
0.6128 --- loss: 1.860065, loss_ss: 0.981972, loss_d: 0.878092
0.6511 --- loss: 1.593782, loss_ss: 1.181023, loss_d: 0.412759
0.6894 --- loss: 1.600555, loss_ss: 1.240204, loss_d: 0.360350
0.7277 --- loss: 1.733911, loss_ss: 1.202622, loss_d: 0.531289
0.7660 --- loss: 1.546162, loss_ss: 1.106802, loss_d: 0.439360
0.8043 --- loss: 2.014121, loss_ss: 1.721017, loss_d: 0.293105
0.8426 --- loss: 1.761225, loss_ss: 1.088559, loss_d: 0.672666
0.8809 --- loss: 1.838779, loss_ss: 1.397475, loss_d: 0.441303
0.9192 --- loss: 2.022729, loss_ss: 1.597386, loss_d: 0.425343
0.9575 --- loss: 1.984871, loss_ss: 1.240690, loss_d: 0.744181
0.9958 --- loss: 1.914958, loss_ss: 1.350357, loss_d: 0.564601
Epoch finished! Loss: 1.7956637710447056
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.147879, loss_ss: 1.315673, loss_d: 0.832206
0.0383 --- loss: 1.959115, loss_ss: 1.538571, loss_d: 0.420543
0.0766 --- loss: 1.472799, loss_ss: 1.154004, loss_d: 0.318795
0.1149 --- loss: 1.888337, loss_ss: 1.133329, loss_d: 0.755008
0.1532 --- loss: 1.801732, loss_ss: 1.223552, loss_d: 0.578179
0.1915 --- loss: 2.021743, loss_ss: 1.476706, loss_d: 0.545037
0.2298 --- loss: 1.845193, loss_ss: 1.323880, loss_d: 0.521313
0.2681 --- loss: 1.597867, loss_ss: 1.184183, loss_d: 0.413684
0.3064 --- loss: 1.683587, loss_ss: 1.317674, loss_d: 0.365913
0.3447 --- loss: 1.523602, loss_ss: 1.184733, loss_d: 0.338869
0.3830 --- loss: 1.667685, loss_ss: 1.331289, loss_d: 0.336396
0.4213 --- loss: 2.425848, loss_ss: 1.073998, loss_d: 1.351849
0.4596 --- loss: 1.408737, loss_ss: 1.093922, loss_d: 0.314815
0.4979 --- loss: 1.317319, loss_ss: 0.963305, loss_d: 0.354014
0.5362 --- loss: 1.693345, loss_ss: 1.288473, loss_d: 0.404872
0.5745 --- loss: 1.562725, loss_ss: 1.117018, loss_d: 0.445707
0.6128 --- loss: 1.539261, loss_ss: 1.184880, loss_d: 0.354381
0.6511 --- loss: 1.543163, loss_ss: 1.281914, loss_d: 0.261249
0.6894 --- loss: 1.665764, loss_ss: 1.099751, loss_d: 0.566014
0.7277 --- loss: 1.380931, loss_ss: 0.927904, loss_d: 0.453026
0.7660 --- loss: 1.902538, loss_ss: 1.216896, loss_d: 0.685642
0.8043 --- loss: 1.448341, loss_ss: 1.093641, loss_d: 0.354700
0.8426 --- loss: 1.641031, loss_ss: 1.147732, loss_d: 0.493299
0.8809 --- loss: 1.993985, loss_ss: 1.614248, loss_d: 0.379737
0.9192 --- loss: 1.557477, loss_ss: 1.046824, loss_d: 0.510653
0.9575 --- loss: 1.829865, loss_ss: 1.078672, loss_d: 0.751193
0.9958 --- loss: 1.897675, loss_ss: 1.321606, loss_d: 0.576068
Epoch finished! Loss: 1.7295960713163647
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.819910, loss_ss: 1.167068, loss_d: 0.652842
0.0383 --- loss: 1.757664, loss_ss: 1.278939, loss_d: 0.478725
0.0766 --- loss: 1.480273, loss_ss: 0.945275, loss_d: 0.534998
0.1149 --- loss: 1.677255, loss_ss: 1.214089, loss_d: 0.463166
0.1532 --- loss: 1.644308, loss_ss: 1.181333, loss_d: 0.462976
0.1915 --- loss: 1.695319, loss_ss: 1.228890, loss_d: 0.466429
0.2298 --- loss: 1.808285, loss_ss: 1.273674, loss_d: 0.534611
0.2681 --- loss: 2.150952, loss_ss: 1.333404, loss_d: 0.817548
0.3064 --- loss: 1.886950, loss_ss: 0.871489, loss_d: 1.015460
0.3447 --- loss: 1.387740, loss_ss: 1.024603, loss_d: 0.363138
0.3830 --- loss: 2.145012, loss_ss: 1.685171, loss_d: 0.459841
0.4213 --- loss: 1.326317, loss_ss: 0.969165, loss_d: 0.357153
0.4596 --- loss: 1.693802, loss_ss: 1.364106, loss_d: 0.329696
0.4979 --- loss: 1.468334, loss_ss: 1.099606, loss_d: 0.368727
0.5362 --- loss: 1.806517, loss_ss: 0.980876, loss_d: 0.825641
0.5745 --- loss: 1.744095, loss_ss: 1.170493, loss_d: 0.573601
0.6128 --- loss: 1.614527, loss_ss: 1.305638, loss_d: 0.308888
0.6511 --- loss: 1.984252, loss_ss: 1.250679, loss_d: 0.733572
0.6894 --- loss: 1.507754, loss_ss: 1.193432, loss_d: 0.314322
0.7277 --- loss: 1.545435, loss_ss: 1.172525, loss_d: 0.372911
0.7660 --- loss: 1.632252, loss_ss: 1.120022, loss_d: 0.512230
0.8043 --- loss: 1.709932, loss_ss: 1.309524, loss_d: 0.400408
0.8426 --- loss: 1.350764, loss_ss: 0.932993, loss_d: 0.417771
0.8809 --- loss: 2.044278, loss_ss: 1.093724, loss_d: 0.950554
0.9192 --- loss: 1.380887, loss_ss: 1.074176, loss_d: 0.306711
0.9575 --- loss: 2.039875, loss_ss: 1.228859, loss_d: 0.811016
0.9958 --- loss: 1.441740, loss_ss: 1.038457, loss_d: 0.403282
Epoch finished! Loss: 1.6264399710286166
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.544489, loss_ss: 1.212201, loss_d: 0.332288
0.0383 --- loss: 1.946736, loss_ss: 0.917031, loss_d: 1.029706
0.0766 --- loss: 1.512661, loss_ss: 1.133488, loss_d: 0.379173
0.1149 --- loss: 1.400297, loss_ss: 0.973203, loss_d: 0.427094
0.1532 --- loss: 1.504715, loss_ss: 1.171117, loss_d: 0.333598
0.1915 --- loss: 1.656311, loss_ss: 1.324465, loss_d: 0.331845
0.2298 --- loss: 1.618920, loss_ss: 1.267918, loss_d: 0.351002
0.2681 --- loss: 2.056828, loss_ss: 1.323262, loss_d: 0.733567
0.3064 --- loss: 1.552945, loss_ss: 0.923221, loss_d: 0.629724
0.3447 --- loss: 1.746760, loss_ss: 1.258124, loss_d: 0.488636
0.3830 --- loss: 1.379577, loss_ss: 1.013622, loss_d: 0.365955
0.4213 --- loss: 1.621241, loss_ss: 0.965974, loss_d: 0.655266
0.4596 --- loss: 1.898677, loss_ss: 1.527476, loss_d: 0.371201
0.4979 --- loss: 1.359572, loss_ss: 0.957993, loss_d: 0.401579
0.5362 --- loss: 1.805560, loss_ss: 1.006988, loss_d: 0.798571
0.5745 --- loss: 1.572671, loss_ss: 1.148944, loss_d: 0.423727
0.6128 --- loss: 1.818097, loss_ss: 1.215499, loss_d: 0.602598
0.6511 --- loss: 1.443603, loss_ss: 1.029924, loss_d: 0.413679
0.6894 --- loss: 1.457476, loss_ss: 1.089768, loss_d: 0.367708
0.7277 --- loss: 1.816437, loss_ss: 1.314115, loss_d: 0.502323
0.7660 --- loss: 1.694233, loss_ss: 1.024367, loss_d: 0.669867
0.8043 --- loss: 1.661440, loss_ss: 1.291007, loss_d: 0.370433
0.8426 --- loss: 1.340424, loss_ss: 1.000692, loss_d: 0.339732
0.8809 --- loss: 1.622340, loss_ss: 1.169585, loss_d: 0.452755
0.9192 --- loss: 1.343850, loss_ss: 0.991506, loss_d: 0.352343
0.9575 --- loss: 1.426576, loss_ss: 0.973442, loss_d: 0.453134
0.9958 --- loss: 1.675181, loss_ss: 1.249732, loss_d: 0.425448
Epoch finished! Loss: 1.5960063938893578
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.874180, loss_ss: 1.389757, loss_d: 0.484423
0.0383 --- loss: 1.382407, loss_ss: 0.918286, loss_d: 0.464121
0.0766 --- loss: 1.461458, loss_ss: 1.011236, loss_d: 0.450222
0.1149 --- loss: 1.661020, loss_ss: 1.338938, loss_d: 0.322082
0.1532 --- loss: 1.311534, loss_ss: 0.815034, loss_d: 0.496500
0.1915 --- loss: 1.424845, loss_ss: 1.118327, loss_d: 0.306518
0.2298 --- loss: 1.498828, loss_ss: 1.154414, loss_d: 0.344413
0.2681 --- loss: 1.720073, loss_ss: 1.126696, loss_d: 0.593377
0.3064 --- loss: 1.683382, loss_ss: 1.380942, loss_d: 0.302440
0.3447 --- loss: 1.372762, loss_ss: 1.011161, loss_d: 0.361601
0.3830 --- loss: 1.372734, loss_ss: 1.042750, loss_d: 0.329984
0.4213 --- loss: 1.597593, loss_ss: 1.234959, loss_d: 0.362634
0.4596 --- loss: 1.637803, loss_ss: 1.133370, loss_d: 0.504434
0.4979 --- loss: 1.293336, loss_ss: 1.043424, loss_d: 0.249912
0.5362 --- loss: 2.282113, loss_ss: 1.406830, loss_d: 0.875283
0.5745 --- loss: 1.330327, loss_ss: 1.031052, loss_d: 0.299275
0.6128 --- loss: 1.428778, loss_ss: 1.018904, loss_d: 0.409874
0.6511 --- loss: 1.413960, loss_ss: 1.106162, loss_d: 0.307798
0.6894 --- loss: 1.284680, loss_ss: 0.887989, loss_d: 0.396692
0.7277 --- loss: 1.819729, loss_ss: 1.199629, loss_d: 0.620100
0.7660 --- loss: 1.658878, loss_ss: 1.256655, loss_d: 0.402223
0.8043 --- loss: 1.705693, loss_ss: 1.084217, loss_d: 0.621476
0.8426 --- loss: 1.358346, loss_ss: 1.055113, loss_d: 0.303233
0.8809 --- loss: 1.685241, loss_ss: 1.139764, loss_d: 0.545476
0.9192 --- loss: 1.363071, loss_ss: 0.984512, loss_d: 0.378559
0.9575 --- loss: 1.481078, loss_ss: 0.956415, loss_d: 0.524662
0.9958 --- loss: 1.193438, loss_ss: 0.837420, loss_d: 0.356018
Epoch finished! Loss: 1.5748315451245656
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.585020, loss_ss: 1.202658, loss_d: 0.382362
0.0383 --- loss: 1.270875, loss_ss: 0.930035, loss_d: 0.340840
0.0766 --- loss: 2.056860, loss_ss: 1.000443, loss_d: 1.056417
0.1149 --- loss: 2.034863, loss_ss: 1.232152, loss_d: 0.802711
0.1532 --- loss: 1.978480, loss_ss: 1.290985, loss_d: 0.687494
0.1915 --- loss: 1.428624, loss_ss: 0.985401, loss_d: 0.443223
0.2298 --- loss: 1.570167, loss_ss: 1.052606, loss_d: 0.517561
0.2681 --- loss: 1.422256, loss_ss: 0.872357, loss_d: 0.549899
0.3064 --- loss: 1.501867, loss_ss: 1.171482, loss_d: 0.330385
0.3447 --- loss: 1.429819, loss_ss: 1.091441, loss_d: 0.338378
0.3830 --- loss: 1.462513, loss_ss: 1.168939, loss_d: 0.293574
0.4213 --- loss: 1.237549, loss_ss: 0.989761, loss_d: 0.247788
0.4596 --- loss: 2.036375, loss_ss: 1.426509, loss_d: 0.609866
0.4979 --- loss: 1.382929, loss_ss: 0.915030, loss_d: 0.467899
0.5362 --- loss: 1.371419, loss_ss: 1.072968, loss_d: 0.298452
0.5745 --- loss: 1.189118, loss_ss: 0.825094, loss_d: 0.364024
0.6128 --- loss: 1.633513, loss_ss: 1.275973, loss_d: 0.357540
0.6511 --- loss: 1.381835, loss_ss: 1.031825, loss_d: 0.350010
0.6894 --- loss: 1.568355, loss_ss: 1.066921, loss_d: 0.501434
0.7277 --- loss: 1.372752, loss_ss: 0.989903, loss_d: 0.382849
0.7660 --- loss: 1.647680, loss_ss: 1.201010, loss_d: 0.446670
0.8043 --- loss: 1.554105, loss_ss: 0.946791, loss_d: 0.607314
0.8426 --- loss: 1.327079, loss_ss: 1.021568, loss_d: 0.305511
0.8809 --- loss: 1.492449, loss_ss: 1.040607, loss_d: 0.451842
0.9192 --- loss: 1.463913, loss_ss: 1.108116, loss_d: 0.355797
0.9575 --- loss: 1.342845, loss_ss: 0.952218, loss_d: 0.390628
0.9958 --- loss: 1.218969, loss_ss: 0.865800, loss_d: 0.353169
Epoch finished! Loss: 1.54931027633477
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.663719, loss_ss: 0.990680, loss_d: 0.673039
0.0383 --- loss: 1.321511, loss_ss: 1.052905, loss_d: 0.268605
0.0766 --- loss: 1.522085, loss_ss: 1.089232, loss_d: 0.432853
0.1149 --- loss: 1.527914, loss_ss: 1.203738, loss_d: 0.324176
0.1532 --- loss: 1.628981, loss_ss: 0.843497, loss_d: 0.785484
0.1915 --- loss: 1.281733, loss_ss: 0.950094, loss_d: 0.331639
0.2298 --- loss: 2.236525, loss_ss: 1.221110, loss_d: 1.015415
0.2681 --- loss: 1.430389, loss_ss: 1.083610, loss_d: 0.346778
0.3064 --- loss: 1.301922, loss_ss: 0.829480, loss_d: 0.472443
0.3447 --- loss: 1.272258, loss_ss: 0.953772, loss_d: 0.318486
0.3830 --- loss: 1.699142, loss_ss: 1.319767, loss_d: 0.379375
0.4213 --- loss: 2.232193, loss_ss: 1.573778, loss_d: 0.658415
0.4596 --- loss: 1.605682, loss_ss: 1.199034, loss_d: 0.406648
0.4979 --- loss: 1.456657, loss_ss: 1.150720, loss_d: 0.305937
0.5362 --- loss: 1.566667, loss_ss: 1.105223, loss_d: 0.461444
0.5745 --- loss: 1.522893, loss_ss: 0.906239, loss_d: 0.616654
0.6128 --- loss: 1.518459, loss_ss: 1.102051, loss_d: 0.416408
0.6511 --- loss: 1.393652, loss_ss: 0.976724, loss_d: 0.416928
0.6894 --- loss: 1.554333, loss_ss: 0.988441, loss_d: 0.565892
0.7277 --- loss: 1.256724, loss_ss: 0.844424, loss_d: 0.412300
0.7660 --- loss: 1.858741, loss_ss: 1.533319, loss_d: 0.325421
0.8043 --- loss: 1.455780, loss_ss: 1.047343, loss_d: 0.408437
0.8426 --- loss: 1.568310, loss_ss: 1.239187, loss_d: 0.329123
0.8809 --- loss: 1.484127, loss_ss: 0.975351, loss_d: 0.508776
0.9192 --- loss: 1.647408, loss_ss: 1.212430, loss_d: 0.434978
0.9575 --- loss: 1.466006, loss_ss: 1.098004, loss_d: 0.368002
0.9958 --- loss: 1.454378, loss_ss: 1.155492, loss_d: 0.298886
Epoch finished! Loss: 1.5585459050547574
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.20123456790123456
             precision    recall  f1-score   support

        0.0       0.12      0.63      0.20        30
        1.0       0.00      0.00      0.00        67
        2.0       0.14      0.01      0.02       427
        3.0       0.00      0.00      0.00       114
        4.0       0.23      0.81      0.36       172

avg / total       0.12      0.20      0.09       810
 


====== chc025-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  80.74  63.33   81.41  11.59     19.59
1  91.73   0.00  100.00   0.00      0.00
2  43.95   1.17   91.64  13.51      2.16
3  85.93   0.00  100.00   0.00      0.00
4  37.90  80.81   26.33  22.82     35.60
Total accuracy: 20.12%
Average sen: 29.06%
Average spec: 79.88%
Macro f1-score: 11.47%
[0.93160868 0.93865758 0.91894311 0.92721367 0.93757749 0.90808672
 0.94122875 0.94277823 0.80681926 0.91772306 0.83962601 0.92713666
 0.8170709  0.9154712  0.90185159 0.92558372 0.8892023  0.79732013
 0.91233885 0.87473059 0.88823098 0.83877903 0.85412079 0.94865566
 0.87129593 0.78295398 0.93533081]
pred: 0.8922346543382715, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.421073, loss_ss: 1.738933, loss_d: 0.682141
0.0383 --- loss: 1.996212, loss_ss: 1.689921, loss_d: 0.306291
0.0767 --- loss: 2.631335, loss_ss: 1.868522, loss_d: 0.762813
0.1150 --- loss: 2.233212, loss_ss: 1.817317, loss_d: 0.415895
0.1534 --- loss: 2.247570, loss_ss: 1.820447, loss_d: 0.427123
0.1917 --- loss: 2.045519, loss_ss: 1.662326, loss_d: 0.383193
0.2301 --- loss: 1.956211, loss_ss: 1.605760, loss_d: 0.350451
0.2684 --- loss: 2.014272, loss_ss: 1.607826, loss_d: 0.406446
0.3067 --- loss: 2.838468, loss_ss: 1.848208, loss_d: 0.990260
0.3451 --- loss: 2.145176, loss_ss: 1.715522, loss_d: 0.429654
0.3834 --- loss: 2.087079, loss_ss: 1.763356, loss_d: 0.323723
0.4218 --- loss: 2.191139, loss_ss: 1.650423, loss_d: 0.540716
0.4601 --- loss: 2.267428, loss_ss: 1.727165, loss_d: 0.540263
0.4985 --- loss: 2.054575, loss_ss: 1.588323, loss_d: 0.466252
0.5368 --- loss: 2.215135, loss_ss: 1.659268, loss_d: 0.555867
0.5752 --- loss: 2.273423, loss_ss: 1.634550, loss_d: 0.638873
0.6135 --- loss: 2.144698, loss_ss: 1.691311, loss_d: 0.453387
0.6518 --- loss: 2.206912, loss_ss: 1.693065, loss_d: 0.513847
0.6902 --- loss: 2.006999, loss_ss: 1.582919, loss_d: 0.424080
0.7285 --- loss: 1.979466, loss_ss: 1.586947, loss_d: 0.392519
0.7669 --- loss: 1.966399, loss_ss: 1.614215, loss_d: 0.352184
0.8052 --- loss: 1.877662, loss_ss: 1.580273, loss_d: 0.297389
0.8436 --- loss: 2.247040, loss_ss: 1.610459, loss_d: 0.636581
0.8819 --- loss: 1.909125, loss_ss: 1.602912, loss_d: 0.306213
0.9202 --- loss: 1.839585, loss_ss: 1.550264, loss_d: 0.289320
0.9586 --- loss: 2.015335, loss_ss: 1.566383, loss_d: 0.448951
0.9969 --- loss: 2.107588, loss_ss: 1.562750, loss_d: 0.544838
Epoch finished! Loss: 2.2368866769167095
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.924877, loss_ss: 1.541317, loss_d: 0.383560
0.0383 --- loss: 2.064334, loss_ss: 1.517882, loss_d: 0.546453
0.0767 --- loss: 2.089778, loss_ss: 1.595188, loss_d: 0.494591
0.1150 --- loss: 1.833246, loss_ss: 1.468507, loss_d: 0.364739
0.1534 --- loss: 1.818579, loss_ss: 1.426311, loss_d: 0.392268
0.1917 --- loss: 1.950843, loss_ss: 1.609314, loss_d: 0.341530
0.2301 --- loss: 2.116798, loss_ss: 1.552492, loss_d: 0.564306
0.2684 --- loss: 1.782136, loss_ss: 1.488735, loss_d: 0.293401
0.3067 --- loss: 2.358772, loss_ss: 1.437652, loss_d: 0.921120
0.3451 --- loss: 1.961094, loss_ss: 1.478163, loss_d: 0.482931
0.3834 --- loss: 1.994016, loss_ss: 1.562911, loss_d: 0.431105
0.4218 --- loss: 1.889159, loss_ss: 1.504828, loss_d: 0.384331
0.4601 --- loss: 1.957419, loss_ss: 1.576457, loss_d: 0.380961
0.4985 --- loss: 1.826563, loss_ss: 1.501443, loss_d: 0.325120
0.5368 --- loss: 1.813496, loss_ss: 1.456098, loss_d: 0.357398
0.5752 --- loss: 2.079714, loss_ss: 1.381612, loss_d: 0.698102
0.6135 --- loss: 1.827017, loss_ss: 1.483105, loss_d: 0.343911
0.6518 --- loss: 1.783672, loss_ss: 1.441458, loss_d: 0.342214
0.6902 --- loss: 2.420753, loss_ss: 1.688773, loss_d: 0.731980
0.7285 --- loss: 1.900331, loss_ss: 1.479254, loss_d: 0.421077
0.7669 --- loss: 1.884137, loss_ss: 1.543565, loss_d: 0.340571
0.8052 --- loss: 1.904523, loss_ss: 1.494433, loss_d: 0.410090
0.8436 --- loss: 1.846238, loss_ss: 1.494941, loss_d: 0.351297
0.8819 --- loss: 1.861801, loss_ss: 1.465197, loss_d: 0.396604
0.9202 --- loss: 1.892847, loss_ss: 1.513989, loss_d: 0.378858
0.9586 --- loss: 2.125399, loss_ss: 1.555273, loss_d: 0.570126
0.9969 --- loss: 2.035637, loss_ss: 1.435410, loss_d: 0.600228
Epoch finished! Loss: 1.9899009250677548
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.001136, loss_ss: 1.414765, loss_d: 0.586371
0.0383 --- loss: 2.222809, loss_ss: 1.503168, loss_d: 0.719641
0.0767 --- loss: 1.895243, loss_ss: 1.424490, loss_d: 0.470753
0.1150 --- loss: 1.845365, loss_ss: 1.553295, loss_d: 0.292070
0.1534 --- loss: 1.938322, loss_ss: 1.313467, loss_d: 0.624855
0.1917 --- loss: 1.945915, loss_ss: 1.513808, loss_d: 0.432107
0.2301 --- loss: 2.005640, loss_ss: 1.482529, loss_d: 0.523111
0.2684 --- loss: 2.028272, loss_ss: 1.559378, loss_d: 0.468895
0.3067 --- loss: 1.728668, loss_ss: 1.418616, loss_d: 0.310053
0.3451 --- loss: 2.066165, loss_ss: 1.264343, loss_d: 0.801822
0.3834 --- loss: 2.014131, loss_ss: 1.467016, loss_d: 0.547115
0.4218 --- loss: 1.887112, loss_ss: 1.459184, loss_d: 0.427928
0.4601 --- loss: 1.722888, loss_ss: 1.358262, loss_d: 0.364626
0.4985 --- loss: 1.757808, loss_ss: 1.294133, loss_d: 0.463676
0.5368 --- loss: 1.769137, loss_ss: 1.449236, loss_d: 0.319901
0.5752 --- loss: 2.085342, loss_ss: 1.662543, loss_d: 0.422799
0.6135 --- loss: 1.929984, loss_ss: 1.408727, loss_d: 0.521257
0.6518 --- loss: 1.560601, loss_ss: 1.224947, loss_d: 0.335654
0.6902 --- loss: 2.013667, loss_ss: 1.653668, loss_d: 0.359998
0.7285 --- loss: 1.863032, loss_ss: 1.501994, loss_d: 0.361039
0.7669 --- loss: 1.555805, loss_ss: 1.215689, loss_d: 0.340116
0.8052 --- loss: 1.595348, loss_ss: 1.176601, loss_d: 0.418747
0.8436 --- loss: 2.101019, loss_ss: 1.544217, loss_d: 0.556802
0.8819 --- loss: 1.715001, loss_ss: 1.123039, loss_d: 0.591963
0.9202 --- loss: 1.692535, loss_ss: 1.272948, loss_d: 0.419587
0.9586 --- loss: 1.915056, loss_ss: 1.400127, loss_d: 0.514929
0.9969 --- loss: 1.837158, loss_ss: 1.320903, loss_d: 0.516255
Epoch finished! Loss: 1.908892148733139
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.849963, loss_ss: 1.468709, loss_d: 0.381254
0.0383 --- loss: 1.469660, loss_ss: 1.098034, loss_d: 0.371627
0.0767 --- loss: 1.759540, loss_ss: 1.438473, loss_d: 0.321067
0.1150 --- loss: 1.702065, loss_ss: 1.275154, loss_d: 0.426911
0.1534 --- loss: 1.953689, loss_ss: 1.278260, loss_d: 0.675429
0.1917 --- loss: 2.181033, loss_ss: 1.312326, loss_d: 0.868707
0.2301 --- loss: 1.963964, loss_ss: 1.242924, loss_d: 0.721040
0.2684 --- loss: 1.885094, loss_ss: 1.350042, loss_d: 0.535052
0.3067 --- loss: 1.624106, loss_ss: 1.230856, loss_d: 0.393250
0.3451 --- loss: 1.722335, loss_ss: 1.294469, loss_d: 0.427865
0.3834 --- loss: 1.948923, loss_ss: 1.473227, loss_d: 0.475696
0.4218 --- loss: 2.640443, loss_ss: 1.522273, loss_d: 1.118169
0.4601 --- loss: 1.755908, loss_ss: 1.293122, loss_d: 0.462786
0.4985 --- loss: 1.771966, loss_ss: 1.252341, loss_d: 0.519625
0.5368 --- loss: 1.828590, loss_ss: 1.415640, loss_d: 0.412950
0.5752 --- loss: 1.731793, loss_ss: 1.409410, loss_d: 0.322383
0.6135 --- loss: 1.741384, loss_ss: 1.368792, loss_d: 0.372592
0.6518 --- loss: 1.723708, loss_ss: 1.237021, loss_d: 0.486687
0.6902 --- loss: 1.796906, loss_ss: 1.171282, loss_d: 0.625624
0.7285 --- loss: 1.531886, loss_ss: 1.219502, loss_d: 0.312385
0.7669 --- loss: 1.967723, loss_ss: 1.504207, loss_d: 0.463516
0.8052 --- loss: 1.510766, loss_ss: 1.172126, loss_d: 0.338640
0.8436 --- loss: 1.693118, loss_ss: 1.221052, loss_d: 0.472066
0.8819 --- loss: 1.757549, loss_ss: 1.392393, loss_d: 0.365156
0.9202 --- loss: 1.598630, loss_ss: 1.229649, loss_d: 0.368980
0.9586 --- loss: 1.744306, loss_ss: 1.039119, loss_d: 0.705187
0.9969 --- loss: 1.470927, loss_ss: 1.020547, loss_d: 0.450380
Epoch finished! Loss: 1.7922593809091127
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.884014, loss_ss: 1.139799, loss_d: 0.744215
0.0383 --- loss: 1.918911, loss_ss: 1.337946, loss_d: 0.580966
0.0767 --- loss: 1.572859, loss_ss: 1.208005, loss_d: 0.364854
0.1150 --- loss: 1.770969, loss_ss: 1.373213, loss_d: 0.397756
0.1534 --- loss: 1.692439, loss_ss: 1.287233, loss_d: 0.405207
0.1917 --- loss: 2.203427, loss_ss: 1.311547, loss_d: 0.891880
0.2301 --- loss: 1.875342, loss_ss: 1.381269, loss_d: 0.494072
0.2684 --- loss: 1.588129, loss_ss: 1.052088, loss_d: 0.536041
0.3067 --- loss: 1.528336, loss_ss: 1.184814, loss_d: 0.343521
0.3451 --- loss: 1.713957, loss_ss: 1.283109, loss_d: 0.430847
0.3834 --- loss: 1.575675, loss_ss: 1.224893, loss_d: 0.350782
0.4218 --- loss: 1.405452, loss_ss: 1.059096, loss_d: 0.346356
0.4601 --- loss: 2.031648, loss_ss: 1.458728, loss_d: 0.572920
0.4985 --- loss: 1.591513, loss_ss: 1.222226, loss_d: 0.369287
0.5368 --- loss: 1.506049, loss_ss: 1.156253, loss_d: 0.349796
0.5752 --- loss: 1.950191, loss_ss: 1.473064, loss_d: 0.477128
0.6135 --- loss: 1.588309, loss_ss: 1.106004, loss_d: 0.482305
0.6518 --- loss: 1.695674, loss_ss: 1.182045, loss_d: 0.513629
0.6902 --- loss: 1.683583, loss_ss: 1.311115, loss_d: 0.372468
0.7285 --- loss: 1.908021, loss_ss: 1.333271, loss_d: 0.574751
0.7669 --- loss: 1.782959, loss_ss: 1.294749, loss_d: 0.488210
0.8052 --- loss: 1.881228, loss_ss: 1.294887, loss_d: 0.586342
0.8436 --- loss: 1.535869, loss_ss: 1.002859, loss_d: 0.533010
0.8819 --- loss: 1.377525, loss_ss: 1.016014, loss_d: 0.361511
0.9202 --- loss: 1.674686, loss_ss: 1.070614, loss_d: 0.604072
0.9586 --- loss: 1.823719, loss_ss: 1.421105, loss_d: 0.402615
0.9969 --- loss: 1.401479, loss_ss: 0.879289, loss_d: 0.522190
Epoch finished! Loss: 1.700216271327092
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.938434, loss_ss: 1.438785, loss_d: 0.499649
0.0383 --- loss: 1.759264, loss_ss: 1.294377, loss_d: 0.464888
0.0767 --- loss: 1.252470, loss_ss: 0.822428, loss_d: 0.430042
0.1150 --- loss: 1.549094, loss_ss: 1.168301, loss_d: 0.380793
0.1534 --- loss: 1.652242, loss_ss: 1.232893, loss_d: 0.419349
0.1917 --- loss: 1.472245, loss_ss: 1.060894, loss_d: 0.411352
0.2301 --- loss: 1.733045, loss_ss: 1.379834, loss_d: 0.353211
0.2684 --- loss: 1.464976, loss_ss: 1.120439, loss_d: 0.344538
0.3067 --- loss: 1.767796, loss_ss: 1.397037, loss_d: 0.370759
0.3451 --- loss: 1.738699, loss_ss: 1.080014, loss_d: 0.658685
0.3834 --- loss: 1.600798, loss_ss: 1.126627, loss_d: 0.474171
0.4218 --- loss: 1.950422, loss_ss: 1.129276, loss_d: 0.821147
0.4601 --- loss: 1.439323, loss_ss: 0.980631, loss_d: 0.458692
0.4985 --- loss: 2.367112, loss_ss: 1.299405, loss_d: 1.067706
0.5368 --- loss: 2.028576, loss_ss: 1.203826, loss_d: 0.824750
0.5752 --- loss: 1.734485, loss_ss: 1.315354, loss_d: 0.419131
0.6135 --- loss: 1.323710, loss_ss: 0.920875, loss_d: 0.402835
0.6518 --- loss: 1.765325, loss_ss: 1.151976, loss_d: 0.613349
0.6902 --- loss: 1.424036, loss_ss: 1.092993, loss_d: 0.331043
0.7285 --- loss: 1.735770, loss_ss: 1.096747, loss_d: 0.639023
0.7669 --- loss: 1.292109, loss_ss: 0.908303, loss_d: 0.383805
0.8052 --- loss: 1.381518, loss_ss: 1.090912, loss_d: 0.290607
0.8436 --- loss: 1.924350, loss_ss: 1.122661, loss_d: 0.801689
0.8819 --- loss: 1.484918, loss_ss: 0.985363, loss_d: 0.499555
0.9202 --- loss: 1.634401, loss_ss: 1.227279, loss_d: 0.407122
0.9586 --- loss: 1.339330, loss_ss: 0.971858, loss_d: 0.367472
0.9969 --- loss: 1.991200, loss_ss: 1.290519, loss_d: 0.700681
Epoch finished! Loss: 1.6259479192587045
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.613521, loss_ss: 1.253032, loss_d: 0.360488
0.0383 --- loss: 1.352058, loss_ss: 1.024038, loss_d: 0.328020
0.0767 --- loss: 1.290328, loss_ss: 0.916280, loss_d: 0.374048
0.1150 --- loss: 1.239986, loss_ss: 0.895645, loss_d: 0.344341
0.1534 --- loss: 1.504071, loss_ss: 1.181719, loss_d: 0.322353
0.1917 --- loss: 1.473944, loss_ss: 1.136462, loss_d: 0.337482
0.2301 --- loss: 1.444107, loss_ss: 1.160071, loss_d: 0.284036
0.2684 --- loss: 1.254931, loss_ss: 0.994399, loss_d: 0.260532
0.3067 --- loss: 1.335517, loss_ss: 0.785033, loss_d: 0.550484
0.3451 --- loss: 1.583356, loss_ss: 0.887894, loss_d: 0.695462
0.3834 --- loss: 1.705647, loss_ss: 1.348293, loss_d: 0.357354
0.4218 --- loss: 1.467683, loss_ss: 1.037232, loss_d: 0.430451
0.4601 --- loss: 1.294009, loss_ss: 0.992139, loss_d: 0.301870
0.4985 --- loss: 1.870790, loss_ss: 0.975846, loss_d: 0.894944
0.5368 --- loss: 2.012811, loss_ss: 1.220734, loss_d: 0.792077
0.5752 --- loss: 1.748554, loss_ss: 1.326298, loss_d: 0.422256
0.6135 --- loss: 1.940435, loss_ss: 1.377598, loss_d: 0.562837
0.6518 --- loss: 1.753838, loss_ss: 1.028402, loss_d: 0.725436
0.6902 --- loss: 1.439250, loss_ss: 1.183875, loss_d: 0.255374
0.7285 --- loss: 1.565504, loss_ss: 0.932704, loss_d: 0.632800
0.7669 --- loss: 1.992367, loss_ss: 1.108268, loss_d: 0.884099
0.8052 --- loss: 1.613299, loss_ss: 1.107485, loss_d: 0.505813
0.8436 --- loss: 1.330733, loss_ss: 0.966816, loss_d: 0.363917
0.8819 --- loss: 1.597637, loss_ss: 1.220911, loss_d: 0.376726
0.9202 --- loss: 1.349637, loss_ss: 0.956059, loss_d: 0.393578
0.9586 --- loss: 1.497741, loss_ss: 1.136235, loss_d: 0.361506
0.9969 --- loss: 1.436026, loss_ss: 0.943193, loss_d: 0.492833
Epoch finished! Loss: 1.578541250870778
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.756460, loss_ss: 1.290920, loss_d: 0.465540
0.0383 --- loss: 1.891076, loss_ss: 1.574809, loss_d: 0.316267
0.0767 --- loss: 1.592827, loss_ss: 1.249154, loss_d: 0.343673
0.1150 --- loss: 1.550279, loss_ss: 1.206433, loss_d: 0.343846
0.1534 --- loss: 1.308634, loss_ss: 1.002950, loss_d: 0.305684
0.1917 --- loss: 1.614298, loss_ss: 0.854774, loss_d: 0.759524
0.2301 --- loss: 1.450068, loss_ss: 0.808304, loss_d: 0.641764
0.2684 --- loss: 1.633761, loss_ss: 1.239803, loss_d: 0.393958
0.3067 --- loss: 1.620616, loss_ss: 1.064976, loss_d: 0.555640
0.3451 --- loss: 1.262840, loss_ss: 0.898133, loss_d: 0.364707
0.3834 --- loss: 1.306966, loss_ss: 1.003479, loss_d: 0.303487
0.4218 --- loss: 1.592554, loss_ss: 1.163325, loss_d: 0.429230
0.4601 --- loss: 1.379109, loss_ss: 0.914096, loss_d: 0.465013
0.4985 --- loss: 1.688058, loss_ss: 1.166792, loss_d: 0.521266
0.5368 --- loss: 1.324964, loss_ss: 1.030542, loss_d: 0.294422
0.5752 --- loss: 1.466776, loss_ss: 1.148201, loss_d: 0.318575
0.6135 --- loss: 1.394061, loss_ss: 1.058030, loss_d: 0.336031
0.6518 --- loss: 1.497072, loss_ss: 0.980927, loss_d: 0.516144
0.6902 --- loss: 2.188752, loss_ss: 1.238371, loss_d: 0.950380
0.7285 --- loss: 2.001658, loss_ss: 1.480694, loss_d: 0.520964
0.7669 --- loss: 1.556010, loss_ss: 1.114611, loss_d: 0.441399
0.8052 --- loss: 2.007084, loss_ss: 1.160180, loss_d: 0.846904
0.8436 --- loss: 1.454911, loss_ss: 0.949903, loss_d: 0.505007
0.8819 --- loss: 1.575498, loss_ss: 1.069536, loss_d: 0.505961
0.9202 --- loss: 1.437419, loss_ss: 0.895847, loss_d: 0.541572
0.9586 --- loss: 1.231461, loss_ss: 0.887926, loss_d: 0.343535
0.9969 --- loss: 1.172638, loss_ss: 0.839783, loss_d: 0.332855
Epoch finished! Loss: 1.536197892519144
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.773280, loss_ss: 1.422891, loss_d: 0.350389
0.0383 --- loss: 1.423300, loss_ss: 1.136510, loss_d: 0.286789
0.0767 --- loss: 1.045678, loss_ss: 0.763671, loss_d: 0.282007
0.1150 --- loss: 1.610949, loss_ss: 1.097678, loss_d: 0.513271
0.1534 --- loss: 1.712072, loss_ss: 1.253055, loss_d: 0.459016
0.1917 --- loss: 1.846129, loss_ss: 1.122136, loss_d: 0.723993
0.2301 --- loss: 2.425628, loss_ss: 1.415476, loss_d: 1.010152
0.2684 --- loss: 1.475364, loss_ss: 1.082888, loss_d: 0.392476
0.3067 --- loss: 1.320045, loss_ss: 0.960268, loss_d: 0.359778
0.3451 --- loss: 1.282797, loss_ss: 0.919568, loss_d: 0.363229
0.3834 --- loss: 1.432821, loss_ss: 1.159026, loss_d: 0.273794
0.4218 --- loss: 1.766694, loss_ss: 1.420884, loss_d: 0.345810
0.4601 --- loss: 1.422742, loss_ss: 1.126361, loss_d: 0.296381
0.4985 --- loss: 1.575931, loss_ss: 1.085767, loss_d: 0.490164
0.5368 --- loss: 1.870306, loss_ss: 1.288202, loss_d: 0.582104
0.5752 --- loss: 1.746845, loss_ss: 1.243170, loss_d: 0.503675
0.6135 --- loss: 1.575759, loss_ss: 1.081469, loss_d: 0.494290
0.6518 --- loss: 1.312796, loss_ss: 0.962628, loss_d: 0.350168
0.6902 --- loss: 1.601325, loss_ss: 1.074942, loss_d: 0.526383
0.7285 --- loss: 1.328604, loss_ss: 0.883453, loss_d: 0.445151
0.7669 --- loss: 1.204716, loss_ss: 0.891557, loss_d: 0.313160
0.8052 --- loss: 1.407377, loss_ss: 0.999959, loss_d: 0.407418
0.8436 --- loss: 1.392097, loss_ss: 1.110607, loss_d: 0.281490
0.8819 --- loss: 1.752096, loss_ss: 1.276808, loss_d: 0.475288
0.9202 --- loss: 1.465673, loss_ss: 1.091031, loss_d: 0.374641
0.9586 --- loss: 1.107011, loss_ss: 0.808491, loss_d: 0.298520
0.9969 --- loss: 1.518934, loss_ss: 1.241007, loss_d: 0.277927
Epoch finished! Loss: 1.536472252699045
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.762163, loss_ss: 1.381587, loss_d: 0.380576
0.0383 --- loss: 1.941413, loss_ss: 1.272801, loss_d: 0.668612
0.0767 --- loss: 1.495757, loss_ss: 1.056724, loss_d: 0.439033
0.1150 --- loss: 1.268174, loss_ss: 0.886184, loss_d: 0.381990
0.1534 --- loss: 1.607977, loss_ss: 1.071365, loss_d: 0.536612
0.1917 --- loss: 1.406512, loss_ss: 1.014535, loss_d: 0.391977
0.2301 --- loss: 1.490593, loss_ss: 1.101044, loss_d: 0.389549
0.2684 --- loss: 1.659501, loss_ss: 1.375682, loss_d: 0.283819
0.3067 --- loss: 1.721522, loss_ss: 1.074079, loss_d: 0.647443
0.3451 --- loss: 1.971020, loss_ss: 1.377296, loss_d: 0.593723
0.3834 --- loss: 1.422360, loss_ss: 1.062361, loss_d: 0.360000
0.4218 --- loss: 1.260754, loss_ss: 0.876085, loss_d: 0.384669
0.4601 --- loss: 1.457222, loss_ss: 1.110954, loss_d: 0.346268
0.4985 --- loss: 1.483151, loss_ss: 1.050912, loss_d: 0.432239
0.5368 --- loss: 1.164932, loss_ss: 0.821385, loss_d: 0.343546
0.5752 --- loss: 1.974809, loss_ss: 0.929525, loss_d: 1.045285
0.6135 --- loss: 1.589076, loss_ss: 0.960722, loss_d: 0.628353
0.6518 --- loss: 1.525130, loss_ss: 0.863135, loss_d: 0.661995
0.6902 --- loss: 1.711690, loss_ss: 1.386554, loss_d: 0.325136
0.7285 --- loss: 1.637358, loss_ss: 0.923280, loss_d: 0.714078
0.7669 --- loss: 1.413189, loss_ss: 1.028693, loss_d: 0.384496
0.8052 --- loss: 1.388735, loss_ss: 0.766500, loss_d: 0.622236
0.8436 --- loss: 1.946487, loss_ss: 1.308029, loss_d: 0.638457
0.8819 --- loss: 1.394392, loss_ss: 1.012609, loss_d: 0.381783
0.9202 --- loss: 1.331345, loss_ss: 0.986705, loss_d: 0.344640
0.9586 --- loss: 1.610536, loss_ss: 1.048340, loss_d: 0.562196
0.9969 --- loss: 2.256231, loss_ss: 1.525432, loss_d: 0.730799
Epoch finished! Loss: 1.5338318082002493
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.10555555555555556
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00       277
        1.0       0.00      0.00      0.00        66
        2.0       0.10      0.08      0.09       293
        3.0       0.00      0.00      0.00       189
        4.0       0.11      0.97      0.19        75

avg / total       0.04      0.11      0.04       900
 


====== chc027-nsrr ======

The ppr of  0  has ZeroDivisionError.


The f1-score of  0  has ZeroDivisionError.


The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  69.22   0.00  100.00   0.00      0.00
1  92.67   0.00  100.00   0.00      0.00
2  48.00   7.51   67.55  10.05      8.59
3  79.00   0.00  100.00   0.00      0.00
4  32.22  97.33   26.30  10.72     19.31
Total accuracy: 10.56%
Average sen: 20.97%
Average spec: 78.77%
Macro f1-score: 5.58%
[0.62017721 0.5612576  0.61211938 0.52878255 0.66359115 0.52878255
 0.52878255 0.52878255 0.52878255 0.63236976 0.85012347 0.85002148
 0.84252238 0.52878255 0.52895248 0.52934468 0.52878255 0.52878255
 0.59326464 0.52878255 0.52878255 0.79683381 0.52878255 0.52878255
 0.52878255 0.52878255 0.52878255 0.83721298 0.76564801 0.52878255]
pred: 0.6047986586888631, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.242527, loss_ss: 1.629091, loss_d: 0.613436
0.0383 --- loss: 2.737194, loss_ss: 1.708393, loss_d: 1.028801
0.0767 --- loss: 1.986475, loss_ss: 1.513902, loss_d: 0.472573
0.1150 --- loss: 1.870922, loss_ss: 1.592319, loss_d: 0.278603
0.1533 --- loss: 2.136252, loss_ss: 1.519243, loss_d: 0.617009
0.1916 --- loss: 2.076649, loss_ss: 1.654001, loss_d: 0.422649
0.2300 --- loss: 2.086242, loss_ss: 1.627223, loss_d: 0.459019
0.2683 --- loss: 2.287331, loss_ss: 1.684510, loss_d: 0.602821
0.3066 --- loss: 2.009607, loss_ss: 1.506446, loss_d: 0.503161
0.3450 --- loss: 2.021695, loss_ss: 1.469944, loss_d: 0.551751
0.3833 --- loss: 2.273261, loss_ss: 1.506329, loss_d: 0.766933
0.4216 --- loss: 1.988236, loss_ss: 1.545043, loss_d: 0.443193
0.4599 --- loss: 1.926635, loss_ss: 1.539325, loss_d: 0.387310
0.4983 --- loss: 1.920183, loss_ss: 1.462768, loss_d: 0.457414
0.5366 --- loss: 2.161436, loss_ss: 1.678909, loss_d: 0.482527
0.5749 --- loss: 1.670429, loss_ss: 1.371433, loss_d: 0.298996
0.6133 --- loss: 2.448909, loss_ss: 1.577669, loss_d: 0.871240
0.6516 --- loss: 1.909024, loss_ss: 1.381070, loss_d: 0.527954
0.6899 --- loss: 1.945097, loss_ss: 1.387165, loss_d: 0.557932
0.7282 --- loss: 1.883759, loss_ss: 1.511597, loss_d: 0.372162
0.7666 --- loss: 1.968337, loss_ss: 1.470824, loss_d: 0.497512
0.8049 --- loss: 2.132202, loss_ss: 1.563513, loss_d: 0.568689
0.8432 --- loss: 1.932533, loss_ss: 1.331814, loss_d: 0.600719
0.8816 --- loss: 1.904618, loss_ss: 1.401579, loss_d: 0.503038
0.9199 --- loss: 2.163797, loss_ss: 1.418202, loss_d: 0.745595
0.9582 --- loss: 1.813678, loss_ss: 1.442801, loss_d: 0.370877
0.9966 --- loss: 1.793388, loss_ss: 1.459930, loss_d: 0.333458
Epoch finished! Loss: 2.0433443427085876
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.194328, loss_ss: 1.442178, loss_d: 0.752150
0.0383 --- loss: 1.884725, loss_ss: 1.272377, loss_d: 0.612348
0.0767 --- loss: 2.083016, loss_ss: 1.550429, loss_d: 0.532588
0.1150 --- loss: 1.878653, loss_ss: 1.221109, loss_d: 0.657544
0.1533 --- loss: 1.969127, loss_ss: 1.397932, loss_d: 0.571195
0.1916 --- loss: 1.633149, loss_ss: 1.312418, loss_d: 0.320732
0.2300 --- loss: 1.854580, loss_ss: 1.407737, loss_d: 0.446843
0.2683 --- loss: 2.254709, loss_ss: 1.389179, loss_d: 0.865531
0.3066 --- loss: 1.703329, loss_ss: 1.349537, loss_d: 0.353792
0.3450 --- loss: 1.852071, loss_ss: 1.251159, loss_d: 0.600912
0.3833 --- loss: 1.676856, loss_ss: 1.236503, loss_d: 0.440354
0.4216 --- loss: 1.565254, loss_ss: 1.217955, loss_d: 0.347298
0.4599 --- loss: 1.743937, loss_ss: 1.275689, loss_d: 0.468249
0.4983 --- loss: 1.674429, loss_ss: 1.253547, loss_d: 0.420883
0.5366 --- loss: 1.677787, loss_ss: 1.255035, loss_d: 0.422752
0.5749 --- loss: 1.835643, loss_ss: 1.249732, loss_d: 0.585911
0.6133 --- loss: 1.797242, loss_ss: 1.196075, loss_d: 0.601167
0.6516 --- loss: 1.709533, loss_ss: 1.131703, loss_d: 0.577831
0.6899 --- loss: 1.696030, loss_ss: 1.316396, loss_d: 0.379634
0.7282 --- loss: 2.185730, loss_ss: 1.516557, loss_d: 0.669173
0.7666 --- loss: 1.612086, loss_ss: 1.055812, loss_d: 0.556275
0.8049 --- loss: 1.699739, loss_ss: 1.331160, loss_d: 0.368579
0.8432 --- loss: 1.834568, loss_ss: 1.127161, loss_d: 0.707406
0.8816 --- loss: 1.849814, loss_ss: 1.221301, loss_d: 0.628513
0.9199 --- loss: 1.717799, loss_ss: 1.206158, loss_d: 0.511642
0.9582 --- loss: 1.515056, loss_ss: 1.159117, loss_d: 0.355938
0.9966 --- loss: 1.657505, loss_ss: 1.299742, loss_d: 0.357763
Epoch finished! Loss: 1.8302416448409742
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.619423, loss_ss: 1.143767, loss_d: 0.475656
0.0383 --- loss: 1.726131, loss_ss: 1.198069, loss_d: 0.528063
0.0767 --- loss: 1.983570, loss_ss: 1.273859, loss_d: 0.709712
0.1150 --- loss: 1.669645, loss_ss: 1.109738, loss_d: 0.559907
0.1533 --- loss: 1.762499, loss_ss: 1.178036, loss_d: 0.584463
0.1916 --- loss: 1.601480, loss_ss: 1.106045, loss_d: 0.495435
0.2300 --- loss: 1.613032, loss_ss: 1.281517, loss_d: 0.331515
0.2683 --- loss: 1.538863, loss_ss: 1.137028, loss_d: 0.401835
0.3066 --- loss: 1.565225, loss_ss: 1.210131, loss_d: 0.355094
0.3450 --- loss: 1.648519, loss_ss: 1.326415, loss_d: 0.322105
0.3833 --- loss: 1.714801, loss_ss: 1.216513, loss_d: 0.498288
0.4216 --- loss: 1.798422, loss_ss: 1.482137, loss_d: 0.316285
0.4599 --- loss: 1.687470, loss_ss: 1.314714, loss_d: 0.372755
0.4983 --- loss: 1.960279, loss_ss: 1.244165, loss_d: 0.716113
0.5366 --- loss: 1.501267, loss_ss: 1.192042, loss_d: 0.309225
0.5749 --- loss: 1.661564, loss_ss: 1.293249, loss_d: 0.368315
0.6133 --- loss: 1.474641, loss_ss: 1.121355, loss_d: 0.353286
0.6516 --- loss: 1.499311, loss_ss: 1.056664, loss_d: 0.442647
0.6899 --- loss: 1.615911, loss_ss: 1.132919, loss_d: 0.482992
0.7282 --- loss: 1.648459, loss_ss: 1.176192, loss_d: 0.472266
0.7666 --- loss: 2.097080, loss_ss: 1.707312, loss_d: 0.389767
0.8049 --- loss: 1.602297, loss_ss: 1.171954, loss_d: 0.430343
0.8432 --- loss: 1.777950, loss_ss: 1.346401, loss_d: 0.431549
0.8816 --- loss: 1.756415, loss_ss: 1.180293, loss_d: 0.576122
0.9199 --- loss: 1.788732, loss_ss: 1.228081, loss_d: 0.560652
0.9582 --- loss: 2.270038, loss_ss: 1.257144, loss_d: 1.012895
0.9966 --- loss: 1.752859, loss_ss: 1.211083, loss_d: 0.541776
Epoch finished! Loss: 1.705802734540059
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.575997, loss_ss: 1.171177, loss_d: 0.404821
0.0383 --- loss: 1.729406, loss_ss: 1.277545, loss_d: 0.451861
0.0767 --- loss: 1.892272, loss_ss: 1.130854, loss_d: 0.761418
0.1150 --- loss: 1.710727, loss_ss: 1.399563, loss_d: 0.311164
0.1533 --- loss: 1.665289, loss_ss: 1.223948, loss_d: 0.441341
0.1916 --- loss: 1.766065, loss_ss: 1.085668, loss_d: 0.680397
0.2300 --- loss: 1.303517, loss_ss: 1.001212, loss_d: 0.302306
0.2683 --- loss: 1.617440, loss_ss: 1.185222, loss_d: 0.432219
0.3066 --- loss: 1.713053, loss_ss: 0.979604, loss_d: 0.733449
0.3450 --- loss: 1.884008, loss_ss: 1.264274, loss_d: 0.619734
0.3833 --- loss: 1.510111, loss_ss: 1.065499, loss_d: 0.444612
0.4216 --- loss: 1.313345, loss_ss: 0.928681, loss_d: 0.384664
0.4599 --- loss: 1.575814, loss_ss: 1.175343, loss_d: 0.400471
0.4983 --- loss: 1.564436, loss_ss: 1.103695, loss_d: 0.460741
0.5366 --- loss: 1.710449, loss_ss: 1.064008, loss_d: 0.646441
0.5749 --- loss: 1.714885, loss_ss: 0.982405, loss_d: 0.732480
0.6133 --- loss: 1.428883, loss_ss: 0.880849, loss_d: 0.548034
0.6516 --- loss: 1.689123, loss_ss: 1.181223, loss_d: 0.507900
0.6899 --- loss: 1.531313, loss_ss: 1.048531, loss_d: 0.482782
0.7282 --- loss: 2.038324, loss_ss: 1.450894, loss_d: 0.587430
0.7666 --- loss: 1.510991, loss_ss: 1.107885, loss_d: 0.403106
0.8049 --- loss: 1.697703, loss_ss: 1.335030, loss_d: 0.362673
0.8432 --- loss: 1.446648, loss_ss: 1.097311, loss_d: 0.349336
0.8816 --- loss: 1.509779, loss_ss: 1.183075, loss_d: 0.326704
0.9199 --- loss: 1.499598, loss_ss: 0.944401, loss_d: 0.555196
0.9582 --- loss: 1.725121, loss_ss: 1.312833, loss_d: 0.412288
0.9966 --- loss: 1.922272, loss_ss: 1.413836, loss_d: 0.508436
Epoch finished! Loss: 1.6360697879241064
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.766537, loss_ss: 1.000405, loss_d: 0.766132
0.0383 --- loss: 1.346049, loss_ss: 0.983828, loss_d: 0.362222
0.0767 --- loss: 1.747603, loss_ss: 1.052109, loss_d: 0.695494
0.1150 --- loss: 1.342303, loss_ss: 0.946094, loss_d: 0.396209
0.1533 --- loss: 1.855908, loss_ss: 1.386207, loss_d: 0.469700
0.1916 --- loss: 1.917299, loss_ss: 1.047675, loss_d: 0.869624
0.2300 --- loss: 1.978292, loss_ss: 1.007879, loss_d: 0.970414
0.2683 --- loss: 1.393075, loss_ss: 1.062105, loss_d: 0.330970
0.3066 --- loss: 1.803729, loss_ss: 1.125229, loss_d: 0.678500
0.3450 --- loss: 1.547592, loss_ss: 1.181946, loss_d: 0.365646
0.3833 --- loss: 1.545890, loss_ss: 0.869961, loss_d: 0.675929
0.4216 --- loss: 1.397828, loss_ss: 1.061535, loss_d: 0.336293
0.4599 --- loss: 1.628997, loss_ss: 1.198716, loss_d: 0.430281
0.4983 --- loss: 1.331077, loss_ss: 0.930941, loss_d: 0.400136
0.5366 --- loss: 1.308488, loss_ss: 0.968990, loss_d: 0.339498
0.5749 --- loss: 2.332460, loss_ss: 1.186638, loss_d: 1.145822
0.6133 --- loss: 1.485902, loss_ss: 1.113497, loss_d: 0.372405
0.6516 --- loss: 1.760484, loss_ss: 1.377400, loss_d: 0.383084
0.6899 --- loss: 1.697668, loss_ss: 1.058445, loss_d: 0.639224
0.7282 --- loss: 1.719911, loss_ss: 1.156702, loss_d: 0.563208
0.7666 --- loss: 1.395205, loss_ss: 1.000373, loss_d: 0.394832
0.8049 --- loss: 1.600119, loss_ss: 1.148623, loss_d: 0.451496
0.8432 --- loss: 1.651588, loss_ss: 1.171286, loss_d: 0.480302
0.8816 --- loss: 1.481686, loss_ss: 1.036789, loss_d: 0.444897
0.9199 --- loss: 1.384387, loss_ss: 0.991820, loss_d: 0.392567
0.9582 --- loss: 1.781653, loss_ss: 1.441640, loss_d: 0.340014
0.9966 --- loss: 3.200750, loss_ss: 1.110156, loss_d: 2.090595
Epoch finished! Loss: 1.611666211256614
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.484379, loss_ss: 0.846475, loss_d: 0.637904
0.0383 --- loss: 1.363994, loss_ss: 1.099668, loss_d: 0.264326
0.0767 --- loss: 1.865959, loss_ss: 1.318881, loss_d: 0.547078
0.1150 --- loss: 1.880379, loss_ss: 1.385185, loss_d: 0.495194
0.1533 --- loss: 1.471025, loss_ss: 1.117666, loss_d: 0.353359
0.1916 --- loss: 1.243488, loss_ss: 0.836506, loss_d: 0.406982
0.2300 --- loss: 1.518002, loss_ss: 1.097835, loss_d: 0.420167
0.2683 --- loss: 1.356441, loss_ss: 1.048970, loss_d: 0.307471
0.3066 --- loss: 1.232497, loss_ss: 0.884641, loss_d: 0.347857
0.3450 --- loss: 1.818229, loss_ss: 1.195685, loss_d: 0.622544
0.3833 --- loss: 1.731929, loss_ss: 1.236141, loss_d: 0.495788
0.4216 --- loss: 1.291163, loss_ss: 0.952390, loss_d: 0.338773
0.4599 --- loss: 1.683750, loss_ss: 0.970323, loss_d: 0.713427
0.4983 --- loss: 1.220238, loss_ss: 0.900351, loss_d: 0.319888
0.5366 --- loss: 1.946798, loss_ss: 1.481123, loss_d: 0.465674
0.5749 --- loss: 1.478734, loss_ss: 1.135866, loss_d: 0.342869
0.6133 --- loss: 1.863823, loss_ss: 1.123141, loss_d: 0.740682
0.6516 --- loss: 1.558922, loss_ss: 1.158062, loss_d: 0.400860
0.6899 --- loss: 1.501585, loss_ss: 0.911183, loss_d: 0.590401
0.7282 --- loss: 1.667874, loss_ss: 1.116023, loss_d: 0.551851
0.7666 --- loss: 1.675508, loss_ss: 1.172552, loss_d: 0.502957
0.8049 --- loss: 2.293309, loss_ss: 1.121865, loss_d: 1.171444
0.8432 --- loss: 1.969838, loss_ss: 1.226487, loss_d: 0.743351
0.8816 --- loss: 1.497923, loss_ss: 1.090600, loss_d: 0.407323
0.9199 --- loss: 1.303176, loss_ss: 0.978376, loss_d: 0.324799
0.9582 --- loss: 1.627360, loss_ss: 1.121227, loss_d: 0.506132
0.9966 --- loss: 1.291212, loss_ss: 0.983793, loss_d: 0.307418
Epoch finished! Loss: 1.5827758110486545
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.642324, loss_ss: 0.922906, loss_d: 0.719418
0.0383 --- loss: 1.232169, loss_ss: 0.846776, loss_d: 0.385393
0.0767 --- loss: 2.039157, loss_ss: 1.168610, loss_d: 0.870547
0.1150 --- loss: 1.628825, loss_ss: 1.170646, loss_d: 0.458179
0.1533 --- loss: 1.299279, loss_ss: 0.980835, loss_d: 0.318444
0.1916 --- loss: 1.372186, loss_ss: 0.884840, loss_d: 0.487346
0.2300 --- loss: 1.512064, loss_ss: 0.921849, loss_d: 0.590215
0.2683 --- loss: 1.918021, loss_ss: 1.249410, loss_d: 0.668611
0.3066 --- loss: 1.289572, loss_ss: 0.853741, loss_d: 0.435832
0.3450 --- loss: 1.375386, loss_ss: 0.893805, loss_d: 0.481581
0.3833 --- loss: 1.591754, loss_ss: 1.170017, loss_d: 0.421737
0.4216 --- loss: 1.605467, loss_ss: 1.217751, loss_d: 0.387717
0.4599 --- loss: 1.281891, loss_ss: 0.985073, loss_d: 0.296817
0.4983 --- loss: 1.352785, loss_ss: 1.034452, loss_d: 0.318333
0.5366 --- loss: 1.259559, loss_ss: 0.820222, loss_d: 0.439337
0.5749 --- loss: 1.307322, loss_ss: 0.993570, loss_d: 0.313751
0.6133 --- loss: 1.511781, loss_ss: 1.121846, loss_d: 0.389935
0.6516 --- loss: 1.565272, loss_ss: 1.263847, loss_d: 0.301426
0.6899 --- loss: 1.584921, loss_ss: 1.131532, loss_d: 0.453389
0.7282 --- loss: 1.229909, loss_ss: 0.893064, loss_d: 0.336845
0.7666 --- loss: 2.319038, loss_ss: 1.416583, loss_d: 0.902455
0.8049 --- loss: 1.512826, loss_ss: 0.965617, loss_d: 0.547209
0.8432 --- loss: 1.866656, loss_ss: 1.016787, loss_d: 0.849868
0.8816 --- loss: 2.487576, loss_ss: 1.728098, loss_d: 0.759477
0.9199 --- loss: 1.290405, loss_ss: 0.928046, loss_d: 0.362359
0.9582 --- loss: 1.983728, loss_ss: 1.268983, loss_d: 0.714745
0.9966 --- loss: 1.417604, loss_ss: 0.976196, loss_d: 0.441409
Epoch finished! Loss: 1.5697346091270448
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.626522, loss_ss: 1.199332, loss_d: 0.427190
0.0383 --- loss: 1.574973, loss_ss: 1.266890, loss_d: 0.308083
0.0767 --- loss: 1.661497, loss_ss: 1.035972, loss_d: 0.625525
0.1150 --- loss: 1.380045, loss_ss: 1.024969, loss_d: 0.355077
0.1533 --- loss: 1.418061, loss_ss: 1.122233, loss_d: 0.295828
0.1916 --- loss: 1.299972, loss_ss: 0.931942, loss_d: 0.368030
0.2300 --- loss: 1.775760, loss_ss: 1.150827, loss_d: 0.624934
0.2683 --- loss: 1.531652, loss_ss: 0.811690, loss_d: 0.719962
0.3066 --- loss: 1.400448, loss_ss: 1.005588, loss_d: 0.394860
0.3450 --- loss: 1.640013, loss_ss: 1.095701, loss_d: 0.544312
0.3833 --- loss: 2.071198, loss_ss: 1.294342, loss_d: 0.776856
0.4216 --- loss: 1.792015, loss_ss: 1.436374, loss_d: 0.355642
0.4599 --- loss: 1.428648, loss_ss: 1.074118, loss_d: 0.354529
0.4983 --- loss: 1.480920, loss_ss: 1.050395, loss_d: 0.430525
0.5366 --- loss: 1.487255, loss_ss: 1.107009, loss_d: 0.380247
0.5749 --- loss: 1.737527, loss_ss: 1.103251, loss_d: 0.634275
0.6133 --- loss: 1.196788, loss_ss: 0.810482, loss_d: 0.386306
0.6516 --- loss: 1.174471, loss_ss: 0.806872, loss_d: 0.367599
0.6899 --- loss: 1.710387, loss_ss: 1.227030, loss_d: 0.483357
0.7282 --- loss: 1.245866, loss_ss: 0.926085, loss_d: 0.319782
0.7666 --- loss: 1.342373, loss_ss: 1.004833, loss_d: 0.337540
0.8049 --- loss: 1.309916, loss_ss: 0.958015, loss_d: 0.351900
0.8432 --- loss: 1.598339, loss_ss: 1.005648, loss_d: 0.592691
0.8816 --- loss: 1.800133, loss_ss: 1.275369, loss_d: 0.524765
0.9199 --- loss: 1.641794, loss_ss: 1.210271, loss_d: 0.431523
0.9582 --- loss: 1.494712, loss_ss: 1.140731, loss_d: 0.353981
0.9966 --- loss: 1.502612, loss_ss: 1.167463, loss_d: 0.335149
Epoch finished! Loss: 1.5415252217879662
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.647970, loss_ss: 1.353211, loss_d: 0.294759
0.0383 --- loss: 2.183234, loss_ss: 1.460162, loss_d: 0.723072
0.0767 --- loss: 1.603853, loss_ss: 1.101763, loss_d: 0.502090
0.1150 --- loss: 1.471197, loss_ss: 1.109008, loss_d: 0.362189
0.1533 --- loss: 1.267970, loss_ss: 0.939896, loss_d: 0.328073
0.1916 --- loss: 1.581424, loss_ss: 1.139298, loss_d: 0.442126
0.2300 --- loss: 1.493668, loss_ss: 1.158118, loss_d: 0.335550
0.2683 --- loss: 1.370131, loss_ss: 0.948938, loss_d: 0.421193
0.3066 --- loss: 1.481452, loss_ss: 1.179291, loss_d: 0.302161
0.3450 --- loss: 1.329842, loss_ss: 0.902595, loss_d: 0.427247
0.3833 --- loss: 1.445206, loss_ss: 0.917987, loss_d: 0.527219
0.4216 --- loss: 1.391533, loss_ss: 1.026116, loss_d: 0.365416
0.4599 --- loss: 1.654694, loss_ss: 1.156294, loss_d: 0.498401
0.4983 --- loss: 1.990065, loss_ss: 1.544890, loss_d: 0.445175
0.5366 --- loss: 1.560096, loss_ss: 0.914921, loss_d: 0.645175
0.5749 --- loss: 1.696728, loss_ss: 1.311923, loss_d: 0.384805
0.6133 --- loss: 1.457344, loss_ss: 0.995237, loss_d: 0.462107
0.6516 --- loss: 1.372975, loss_ss: 1.050716, loss_d: 0.322259
0.6899 --- loss: 1.557665, loss_ss: 1.130570, loss_d: 0.427095
0.7282 --- loss: 1.402300, loss_ss: 1.023628, loss_d: 0.378672
0.7666 --- loss: 1.283020, loss_ss: 0.952229, loss_d: 0.330791
0.8049 --- loss: 1.401409, loss_ss: 0.853330, loss_d: 0.548079
0.8432 --- loss: 1.528586, loss_ss: 1.185319, loss_d: 0.343267
0.8816 --- loss: 1.425290, loss_ss: 0.945364, loss_d: 0.479926
0.9199 --- loss: 1.390076, loss_ss: 1.095325, loss_d: 0.294751
0.9582 --- loss: 1.562072, loss_ss: 1.025390, loss_d: 0.536682
0.9966 --- loss: 1.106024, loss_ss: 0.761886, loss_d: 0.344138
Epoch finished! Loss: 1.5128742080468398
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.394069, loss_ss: 1.098290, loss_d: 0.295779
0.0383 --- loss: 1.507615, loss_ss: 1.003513, loss_d: 0.504102
0.0767 --- loss: 1.391477, loss_ss: 1.132572, loss_d: 0.258904
0.1150 --- loss: 1.638574, loss_ss: 1.241929, loss_d: 0.396646
0.1533 --- loss: 1.485490, loss_ss: 1.025627, loss_d: 0.459863
0.1916 --- loss: 1.360057, loss_ss: 0.919866, loss_d: 0.440192
0.2300 --- loss: 1.525571, loss_ss: 0.961092, loss_d: 0.564479
0.2683 --- loss: 1.332152, loss_ss: 1.028215, loss_d: 0.303937
0.3066 --- loss: 1.993804, loss_ss: 1.659709, loss_d: 0.334095
0.3450 --- loss: 1.239702, loss_ss: 0.883581, loss_d: 0.356121
0.3833 --- loss: 1.510102, loss_ss: 1.215442, loss_d: 0.294660
0.4216 --- loss: 1.796003, loss_ss: 1.485496, loss_d: 0.310507
0.4599 --- loss: 1.526927, loss_ss: 1.143221, loss_d: 0.383707
0.4983 --- loss: 1.259210, loss_ss: 0.972560, loss_d: 0.286649
0.5366 --- loss: 1.360018, loss_ss: 0.898755, loss_d: 0.461262
0.5749 --- loss: 1.251559, loss_ss: 0.829979, loss_d: 0.421579
0.6133 --- loss: 1.542970, loss_ss: 1.200641, loss_d: 0.342329
0.6516 --- loss: 1.282777, loss_ss: 1.028589, loss_d: 0.254189
0.6899 --- loss: 1.978298, loss_ss: 1.217496, loss_d: 0.760802
0.7282 --- loss: 1.701321, loss_ss: 0.936933, loss_d: 0.764388
0.7666 --- loss: 1.992092, loss_ss: 1.617597, loss_d: 0.374495
0.8049 --- loss: 1.549393, loss_ss: 1.222152, loss_d: 0.327241
0.8432 --- loss: 1.749635, loss_ss: 0.735812, loss_d: 1.013823
0.8816 --- loss: 1.144728, loss_ss: 0.833748, loss_d: 0.310980
0.9199 --- loss: 1.677844, loss_ss: 1.088238, loss_d: 0.589606
0.9582 --- loss: 1.999996, loss_ss: 1.388548, loss_d: 0.611448
0.9966 --- loss: 1.629455, loss_ss: 1.163447, loss_d: 0.466008
Epoch finished! Loss: 1.528458411876972
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.46551724137931033
             precision    recall  f1-score   support

        0.0       1.00      0.06      0.11       119
        1.0       0.00      0.00      0.00        53
        2.0       0.60      0.78      0.68       460
        3.0       0.00      0.00      0.00       164
        4.0       0.14      0.50      0.22        74

avg / total       0.47      0.47      0.39       870
 


====== chc028-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  87.13   5.88  100.00  100.00     11.11
1  93.91   0.00  100.00    0.00      0.00
2  61.15  78.48   41.71   60.17     68.11
3  81.15   0.00  100.00    0.00      0.00
4  69.77  50.00   71.61   14.07     21.96
Total accuracy: 46.55%
Average sen: 26.87%
Average spec: 82.66%
Macro f1-score: 20.24%
[0.50766706 0.50595731 0.50775284 0.50698876 0.50803208 0.50736731
 0.50690466 0.50752246 0.50781983 0.50807005 0.50718439 0.50688326
 0.50759548 0.50748646 0.50798261 0.50608885 0.50777805 0.50606525
 0.50801241 0.50768995 0.50712734 0.5080511  0.50763363 0.50807029
 0.50778389 0.50776756 0.50747645 0.50800031 0.50789911]
pred: 0.5074709921047605, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.369869, loss_ss: 1.619507, loss_d: 0.750362
0.0383 --- loss: 2.336952, loss_ss: 1.685478, loss_d: 0.651474
0.0767 --- loss: 2.278868, loss_ss: 1.756211, loss_d: 0.522657
0.1150 --- loss: 2.114834, loss_ss: 1.651071, loss_d: 0.463763
0.1533 --- loss: 1.984505, loss_ss: 1.687633, loss_d: 0.296872
0.1916 --- loss: 2.108491, loss_ss: 1.606383, loss_d: 0.502108
0.2300 --- loss: 2.302593, loss_ss: 1.679174, loss_d: 0.623418
0.2683 --- loss: 2.409359, loss_ss: 1.598866, loss_d: 0.810494
0.3066 --- loss: 2.010143, loss_ss: 1.620908, loss_d: 0.389235
0.3450 --- loss: 2.258389, loss_ss: 1.601610, loss_d: 0.656778
0.3833 --- loss: 2.042999, loss_ss: 1.584929, loss_d: 0.458070
0.4216 --- loss: 2.051764, loss_ss: 1.515275, loss_d: 0.536489
0.4599 --- loss: 2.165788, loss_ss: 1.603203, loss_d: 0.562584
0.4983 --- loss: 2.167535, loss_ss: 1.517127, loss_d: 0.650408
0.5366 --- loss: 2.150449, loss_ss: 1.591699, loss_d: 0.558749
0.5749 --- loss: 2.170211, loss_ss: 1.532961, loss_d: 0.637250
0.6133 --- loss: 2.251431, loss_ss: 1.492754, loss_d: 0.758677
0.6516 --- loss: 1.998886, loss_ss: 1.393673, loss_d: 0.605213
0.6899 --- loss: 2.190594, loss_ss: 1.582697, loss_d: 0.607898
0.7282 --- loss: 1.935516, loss_ss: 1.449036, loss_d: 0.486480
0.7666 --- loss: 1.786964, loss_ss: 1.410849, loss_d: 0.376115
0.8049 --- loss: 1.901752, loss_ss: 1.546116, loss_d: 0.355636
0.8432 --- loss: 2.013356, loss_ss: 1.576312, loss_d: 0.437044
0.8816 --- loss: 2.364723, loss_ss: 1.477557, loss_d: 0.887166
0.9199 --- loss: 1.993090, loss_ss: 1.679751, loss_d: 0.313339
0.9582 --- loss: 2.083032, loss_ss: 1.646301, loss_d: 0.436731
0.9966 --- loss: 2.189814, loss_ss: 1.535416, loss_d: 0.654398
Epoch finished! Loss: 2.13035068328564
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.986116, loss_ss: 1.558756, loss_d: 0.427360
0.0383 --- loss: 1.896387, loss_ss: 1.464666, loss_d: 0.431720
0.0767 --- loss: 1.957581, loss_ss: 1.561466, loss_d: 0.396116
0.1150 --- loss: 2.053441, loss_ss: 1.606133, loss_d: 0.447308
0.1533 --- loss: 1.757453, loss_ss: 1.457023, loss_d: 0.300430
0.1916 --- loss: 1.865273, loss_ss: 1.460439, loss_d: 0.404834
0.2300 --- loss: 1.839064, loss_ss: 1.457947, loss_d: 0.381117
0.2683 --- loss: 1.695033, loss_ss: 1.363348, loss_d: 0.331685
0.3066 --- loss: 1.809603, loss_ss: 1.377061, loss_d: 0.432542
0.3450 --- loss: 2.004143, loss_ss: 1.582811, loss_d: 0.421332
0.3833 --- loss: 2.321927, loss_ss: 1.385769, loss_d: 0.936158
0.4216 --- loss: 1.960595, loss_ss: 1.405412, loss_d: 0.555183
0.4599 --- loss: 1.878222, loss_ss: 1.459990, loss_d: 0.418232
0.4983 --- loss: 1.704931, loss_ss: 1.300157, loss_d: 0.404774
0.5366 --- loss: 1.885973, loss_ss: 1.581883, loss_d: 0.304090
0.5749 --- loss: 1.897419, loss_ss: 1.509392, loss_d: 0.388027
0.6133 --- loss: 2.470941, loss_ss: 1.383941, loss_d: 1.086999
0.6516 --- loss: 1.953922, loss_ss: 1.569291, loss_d: 0.384631
0.6899 --- loss: 2.151308, loss_ss: 1.680671, loss_d: 0.470636
0.7282 --- loss: 1.955421, loss_ss: 1.605363, loss_d: 0.350058
0.7666 --- loss: 1.878300, loss_ss: 1.488242, loss_d: 0.390058
0.8049 --- loss: 1.741045, loss_ss: 1.297628, loss_d: 0.443417
0.8432 --- loss: 1.717758, loss_ss: 1.340310, loss_d: 0.377448
0.8816 --- loss: 2.081454, loss_ss: 1.561856, loss_d: 0.519598
0.9199 --- loss: 1.864912, loss_ss: 1.308684, loss_d: 0.556228
0.9582 --- loss: 2.020680, loss_ss: 1.475624, loss_d: 0.545057
0.9966 --- loss: 1.813045, loss_ss: 1.321849, loss_d: 0.491196
Epoch finished! Loss: 1.9881174899064578
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.924642, loss_ss: 1.364539, loss_d: 0.560103
0.0383 --- loss: 1.822178, loss_ss: 1.426790, loss_d: 0.395388
0.0767 --- loss: 1.673200, loss_ss: 1.188765, loss_d: 0.484436
0.1150 --- loss: 2.023891, loss_ss: 1.448913, loss_d: 0.574978
0.1533 --- loss: 1.872422, loss_ss: 1.381958, loss_d: 0.490464
0.1916 --- loss: 2.046522, loss_ss: 1.630169, loss_d: 0.416353
0.2300 --- loss: 2.028711, loss_ss: 1.459248, loss_d: 0.569462
0.2683 --- loss: 1.468750, loss_ss: 1.091791, loss_d: 0.376959
0.3066 --- loss: 1.951236, loss_ss: 1.401442, loss_d: 0.549794
0.3450 --- loss: 1.643280, loss_ss: 1.318812, loss_d: 0.324467
0.3833 --- loss: 1.937161, loss_ss: 1.432327, loss_d: 0.504834
0.4216 --- loss: 2.067682, loss_ss: 1.321366, loss_d: 0.746316
0.4599 --- loss: 1.610957, loss_ss: 1.295578, loss_d: 0.315379
0.4983 --- loss: 1.866339, loss_ss: 1.318882, loss_d: 0.547458
0.5366 --- loss: 1.767591, loss_ss: 1.520483, loss_d: 0.247108
0.5749 --- loss: 2.210713, loss_ss: 1.520948, loss_d: 0.689765
0.6133 --- loss: 2.271045, loss_ss: 1.503132, loss_d: 0.767914
0.6516 --- loss: 1.749998, loss_ss: 1.451532, loss_d: 0.298465
0.6899 --- loss: 1.829637, loss_ss: 1.427230, loss_d: 0.402407
0.7282 --- loss: 1.832324, loss_ss: 1.353459, loss_d: 0.478865
0.7666 --- loss: 1.931671, loss_ss: 1.516742, loss_d: 0.414929
0.8049 --- loss: 1.807641, loss_ss: 1.391733, loss_d: 0.415909
0.8432 --- loss: 1.550421, loss_ss: 1.203439, loss_d: 0.346982
0.8816 --- loss: 2.077897, loss_ss: 1.434500, loss_d: 0.643398
0.9199 --- loss: 1.809612, loss_ss: 1.344709, loss_d: 0.464903
0.9582 --- loss: 2.049769, loss_ss: 1.449499, loss_d: 0.600270
0.9966 --- loss: 1.826751, loss_ss: 1.388697, loss_d: 0.438055
Epoch finished! Loss: 1.9245654683846694
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.806996, loss_ss: 1.405731, loss_d: 0.401265
0.0383 --- loss: 1.705318, loss_ss: 1.312110, loss_d: 0.393208
0.0767 --- loss: 1.966605, loss_ss: 1.539535, loss_d: 0.427070
0.1150 --- loss: 1.859313, loss_ss: 1.430394, loss_d: 0.428919
0.1533 --- loss: 1.846996, loss_ss: 1.485444, loss_d: 0.361552
0.1916 --- loss: 1.741747, loss_ss: 1.418604, loss_d: 0.323143
0.2300 --- loss: 2.482352, loss_ss: 1.432211, loss_d: 1.050141
0.2683 --- loss: 2.197199, loss_ss: 1.567386, loss_d: 0.629813
0.3066 --- loss: 1.682127, loss_ss: 1.296972, loss_d: 0.385155
0.3450 --- loss: 1.959058, loss_ss: 1.400487, loss_d: 0.558571
0.3833 --- loss: 2.023421, loss_ss: 1.579292, loss_d: 0.444129
0.4216 --- loss: 1.883478, loss_ss: 1.408356, loss_d: 0.475122
0.4599 --- loss: 1.854813, loss_ss: 1.597109, loss_d: 0.257704
0.4983 --- loss: 1.873966, loss_ss: 1.499925, loss_d: 0.374041
0.5366 --- loss: 2.026723, loss_ss: 1.328428, loss_d: 0.698295
0.5749 --- loss: 2.142031, loss_ss: 1.415518, loss_d: 0.726513
0.6133 --- loss: 1.743295, loss_ss: 1.320911, loss_d: 0.422383
0.6516 --- loss: 1.981022, loss_ss: 1.357823, loss_d: 0.623198
0.6899 --- loss: 1.920177, loss_ss: 1.318953, loss_d: 0.601224
0.7282 --- loss: 2.008777, loss_ss: 1.530433, loss_d: 0.478344
0.7666 --- loss: 1.744970, loss_ss: 1.353342, loss_d: 0.391629
0.8049 --- loss: 1.823934, loss_ss: 1.459110, loss_d: 0.364824
0.8432 --- loss: 1.855166, loss_ss: 1.507618, loss_d: 0.347548
0.8816 --- loss: 1.680279, loss_ss: 1.183789, loss_d: 0.496490
0.9199 --- loss: 1.945422, loss_ss: 1.289863, loss_d: 0.655559
0.9582 --- loss: 1.550934, loss_ss: 1.159652, loss_d: 0.391283
0.9966 --- loss: 1.920514, loss_ss: 1.425182, loss_d: 0.495332
Epoch finished! Loss: 1.8901982449568235
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.073067, loss_ss: 1.624748, loss_d: 0.448319
0.0383 --- loss: 2.020046, loss_ss: 1.621629, loss_d: 0.398417
0.0767 --- loss: 1.834032, loss_ss: 1.304129, loss_d: 0.529904
0.1150 --- loss: 1.667971, loss_ss: 1.422991, loss_d: 0.244980
0.1533 --- loss: 1.514746, loss_ss: 1.176580, loss_d: 0.338166
0.1916 --- loss: 2.131639, loss_ss: 1.588379, loss_d: 0.543260
0.2300 --- loss: 1.874954, loss_ss: 1.432815, loss_d: 0.442139
0.2683 --- loss: 1.853240, loss_ss: 1.370016, loss_d: 0.483225
0.3066 --- loss: 1.946821, loss_ss: 1.555286, loss_d: 0.391535
0.3450 --- loss: 1.535419, loss_ss: 1.170552, loss_d: 0.364867
0.3833 --- loss: 1.784443, loss_ss: 1.387946, loss_d: 0.396497
0.4216 --- loss: 1.734981, loss_ss: 1.499130, loss_d: 0.235851
0.4599 --- loss: 1.723475, loss_ss: 1.385149, loss_d: 0.338325
0.4983 --- loss: 1.917578, loss_ss: 1.340496, loss_d: 0.577082
0.5366 --- loss: 1.784493, loss_ss: 1.484076, loss_d: 0.300417
0.5749 --- loss: 1.806834, loss_ss: 1.186975, loss_d: 0.619859
0.6133 --- loss: 1.980476, loss_ss: 1.250690, loss_d: 0.729786
0.6516 --- loss: 1.749297, loss_ss: 1.298994, loss_d: 0.450304
0.6899 --- loss: 1.599746, loss_ss: 1.134697, loss_d: 0.465049
0.7282 --- loss: 2.151324, loss_ss: 1.366543, loss_d: 0.784781
0.7666 --- loss: 1.774523, loss_ss: 1.401881, loss_d: 0.372641
0.8049 --- loss: 2.230197, loss_ss: 1.575385, loss_d: 0.654812
0.8432 --- loss: 1.891925, loss_ss: 1.371732, loss_d: 0.520193
0.8816 --- loss: 2.488545, loss_ss: 1.459041, loss_d: 1.029505
0.9199 --- loss: 1.684365, loss_ss: 1.273647, loss_d: 0.410717
0.9582 --- loss: 1.682744, loss_ss: 1.350339, loss_d: 0.332405
0.9966 --- loss: 1.708278, loss_ss: 1.127940, loss_d: 0.580339
Epoch finished! Loss: 1.7968400455438174
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.727116, loss_ss: 1.181700, loss_d: 0.545416
0.0383 --- loss: 1.681099, loss_ss: 1.326828, loss_d: 0.354271
0.0767 --- loss: 1.435537, loss_ss: 1.061390, loss_d: 0.374146
0.1150 --- loss: 1.590177, loss_ss: 1.062569, loss_d: 0.527608
0.1533 --- loss: 1.607653, loss_ss: 0.993372, loss_d: 0.614281
0.1916 --- loss: 1.842700, loss_ss: 1.353475, loss_d: 0.489224
0.2300 --- loss: 1.654240, loss_ss: 1.228394, loss_d: 0.425846
0.2683 --- loss: 2.075695, loss_ss: 1.754208, loss_d: 0.321486
0.3066 --- loss: 1.650591, loss_ss: 1.358495, loss_d: 0.292096
0.3450 --- loss: 1.756802, loss_ss: 1.278977, loss_d: 0.477825
0.3833 --- loss: 1.993202, loss_ss: 1.180393, loss_d: 0.812809
0.4216 --- loss: 2.127476, loss_ss: 1.151583, loss_d: 0.975893
0.4599 --- loss: 1.724050, loss_ss: 1.198723, loss_d: 0.525327
0.4983 --- loss: 1.432961, loss_ss: 1.112580, loss_d: 0.320381
0.5366 --- loss: 1.850222, loss_ss: 1.136344, loss_d: 0.713878
0.5749 --- loss: 1.661482, loss_ss: 1.158194, loss_d: 0.503288
0.6133 --- loss: 1.711139, loss_ss: 1.268007, loss_d: 0.443132
0.6516 --- loss: 1.480562, loss_ss: 1.154339, loss_d: 0.326223
0.6899 --- loss: 1.493201, loss_ss: 1.123079, loss_d: 0.370121
0.7282 --- loss: 1.753680, loss_ss: 1.179438, loss_d: 0.574242
0.7666 --- loss: 1.345390, loss_ss: 1.024712, loss_d: 0.320678
0.8049 --- loss: 1.649559, loss_ss: 1.312660, loss_d: 0.336899
0.8432 --- loss: 1.582624, loss_ss: 1.260002, loss_d: 0.322622
0.8816 --- loss: 1.710899, loss_ss: 1.338871, loss_d: 0.372029
0.9199 --- loss: 1.357618, loss_ss: 1.095914, loss_d: 0.261704
0.9582 --- loss: 2.094246, loss_ss: 1.067919, loss_d: 1.026327
0.9966 --- loss: 1.661084, loss_ss: 1.173902, loss_d: 0.487183
Epoch finished! Loss: 1.704991229222371
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.910046, loss_ss: 1.237917, loss_d: 0.672129
0.0383 --- loss: 1.652668, loss_ss: 1.280081, loss_d: 0.372587
0.0767 --- loss: 1.974369, loss_ss: 1.284530, loss_d: 0.689839
0.1150 --- loss: 1.638419, loss_ss: 1.336313, loss_d: 0.302106
0.1533 --- loss: 1.464039, loss_ss: 1.163329, loss_d: 0.300709
0.1916 --- loss: 1.626030, loss_ss: 1.113348, loss_d: 0.512682
0.2300 --- loss: 1.621414, loss_ss: 1.235359, loss_d: 0.386054
0.2683 --- loss: 1.597251, loss_ss: 1.077829, loss_d: 0.519422
0.3066 --- loss: 1.431465, loss_ss: 1.080980, loss_d: 0.350485
0.3450 --- loss: 1.860784, loss_ss: 1.295708, loss_d: 0.565076
0.3833 --- loss: 1.683868, loss_ss: 1.337647, loss_d: 0.346220
0.4216 --- loss: 1.638352, loss_ss: 1.191532, loss_d: 0.446820
0.4599 --- loss: 1.483749, loss_ss: 1.109149, loss_d: 0.374600
0.4983 --- loss: 1.296656, loss_ss: 0.991682, loss_d: 0.304975
0.5366 --- loss: 1.328346, loss_ss: 1.014275, loss_d: 0.314070
0.5749 --- loss: 1.952354, loss_ss: 1.226964, loss_d: 0.725389
0.6133 --- loss: 1.867664, loss_ss: 1.291704, loss_d: 0.575960
0.6516 --- loss: 1.756646, loss_ss: 1.363097, loss_d: 0.393549
0.6899 --- loss: 1.715334, loss_ss: 1.334542, loss_d: 0.380792
0.7282 --- loss: 1.545520, loss_ss: 1.155679, loss_d: 0.389840
0.7666 --- loss: 1.523149, loss_ss: 1.173757, loss_d: 0.349391
0.8049 --- loss: 1.713472, loss_ss: 1.008010, loss_d: 0.705461
0.8432 --- loss: 1.598341, loss_ss: 1.206821, loss_d: 0.391520
0.8816 --- loss: 1.580628, loss_ss: 1.177469, loss_d: 0.403159
0.9199 --- loss: 1.387025, loss_ss: 1.051777, loss_d: 0.335249
0.9582 --- loss: 1.743879, loss_ss: 0.956662, loss_d: 0.787217
0.9966 --- loss: 1.464829, loss_ss: 1.169045, loss_d: 0.295784
Epoch finished! Loss: 1.6202495226493248
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.654742, loss_ss: 1.293013, loss_d: 0.361729
0.0383 --- loss: 1.807778, loss_ss: 1.291694, loss_d: 0.516084
0.0767 --- loss: 1.712516, loss_ss: 1.196547, loss_d: 0.515969
0.1150 --- loss: 1.984867, loss_ss: 1.000207, loss_d: 0.984661
0.1533 --- loss: 1.428020, loss_ss: 1.123260, loss_d: 0.304760
0.1916 --- loss: 1.701725, loss_ss: 1.191912, loss_d: 0.509813
0.2300 --- loss: 1.620364, loss_ss: 1.070235, loss_d: 0.550129
0.2683 --- loss: 1.394584, loss_ss: 1.075921, loss_d: 0.318662
0.3066 --- loss: 2.139096, loss_ss: 1.131217, loss_d: 1.007879
0.3450 --- loss: 2.242761, loss_ss: 1.276534, loss_d: 0.966227
0.3833 --- loss: 1.642555, loss_ss: 1.191942, loss_d: 0.450613
0.4216 --- loss: 1.793407, loss_ss: 1.152134, loss_d: 0.641273
0.4599 --- loss: 1.625139, loss_ss: 1.078316, loss_d: 0.546823
0.4983 --- loss: 1.862170, loss_ss: 1.124534, loss_d: 0.737636
0.5366 --- loss: 1.503873, loss_ss: 1.071108, loss_d: 0.432765
0.5749 --- loss: 1.652736, loss_ss: 1.146154, loss_d: 0.506583
0.6133 --- loss: 1.476616, loss_ss: 1.111662, loss_d: 0.364954
0.6516 --- loss: 1.456759, loss_ss: 1.040497, loss_d: 0.416262
0.6899 --- loss: 1.605269, loss_ss: 1.151338, loss_d: 0.453931
0.7282 --- loss: 1.507227, loss_ss: 1.079378, loss_d: 0.427849
0.7666 --- loss: 1.258138, loss_ss: 0.940997, loss_d: 0.317141
0.8049 --- loss: 2.173232, loss_ss: 1.153110, loss_d: 1.020121
0.8432 --- loss: 1.427887, loss_ss: 1.023556, loss_d: 0.404331
0.8816 --- loss: 1.500445, loss_ss: 1.035433, loss_d: 0.465012
0.9199 --- loss: 1.180106, loss_ss: 0.869653, loss_d: 0.310454
0.9582 --- loss: 1.365076, loss_ss: 0.995467, loss_d: 0.369609
0.9966 --- loss: 1.470826, loss_ss: 1.160688, loss_d: 0.310138
Epoch finished! Loss: 1.5856281725259929
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.784095, loss_ss: 1.135696, loss_d: 0.648399
0.0383 --- loss: 1.286128, loss_ss: 0.912749, loss_d: 0.373379
0.0767 --- loss: 1.619738, loss_ss: 1.372293, loss_d: 0.247446
0.1150 --- loss: 1.565618, loss_ss: 1.364139, loss_d: 0.201479
0.1533 --- loss: 1.180286, loss_ss: 0.963663, loss_d: 0.216623
0.1916 --- loss: 1.436904, loss_ss: 1.060786, loss_d: 0.376119
0.2300 --- loss: 1.685865, loss_ss: 1.155475, loss_d: 0.530390
0.2683 --- loss: 1.396304, loss_ss: 0.946858, loss_d: 0.449446
0.3066 --- loss: 1.641917, loss_ss: 1.089807, loss_d: 0.552110
0.3450 --- loss: 1.370067, loss_ss: 1.004862, loss_d: 0.365205
0.3833 --- loss: 1.292833, loss_ss: 0.893692, loss_d: 0.399141
0.4216 --- loss: 1.304239, loss_ss: 0.995307, loss_d: 0.308932
0.4599 --- loss: 1.295078, loss_ss: 0.970965, loss_d: 0.324113
0.4983 --- loss: 1.502981, loss_ss: 1.185588, loss_d: 0.317393
0.5366 --- loss: 1.655828, loss_ss: 1.093359, loss_d: 0.562470
0.5749 --- loss: 1.768757, loss_ss: 1.395049, loss_d: 0.373709
0.6133 --- loss: 1.604799, loss_ss: 1.178687, loss_d: 0.426112
0.6516 --- loss: 1.752848, loss_ss: 1.374184, loss_d: 0.378665
0.6899 --- loss: 1.707297, loss_ss: 0.993807, loss_d: 0.713489
0.7282 --- loss: 1.453634, loss_ss: 1.130625, loss_d: 0.323008
0.7666 --- loss: 1.714110, loss_ss: 1.379306, loss_d: 0.334804
0.8049 --- loss: 1.305776, loss_ss: 1.010913, loss_d: 0.294864
0.8432 --- loss: 1.302122, loss_ss: 0.929623, loss_d: 0.372500
0.8816 --- loss: 1.439003, loss_ss: 1.216548, loss_d: 0.222455
0.9199 --- loss: 1.581251, loss_ss: 1.222545, loss_d: 0.358706
0.9582 --- loss: 1.311460, loss_ss: 0.886613, loss_d: 0.424848
0.9966 --- loss: 1.467211, loss_ss: 1.061089, loss_d: 0.406122
Epoch finished! Loss: 1.5545037627220153
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.787647, loss_ss: 1.283186, loss_d: 0.504461
0.0383 --- loss: 1.176597, loss_ss: 0.861157, loss_d: 0.315440
0.0767 --- loss: 1.529560, loss_ss: 0.995669, loss_d: 0.533890
0.1150 --- loss: 1.966199, loss_ss: 1.425066, loss_d: 0.541133
0.1533 --- loss: 1.408821, loss_ss: 1.007750, loss_d: 0.401071
0.1916 --- loss: 1.618170, loss_ss: 1.233454, loss_d: 0.384716
0.2300 --- loss: 1.383947, loss_ss: 0.956413, loss_d: 0.427534
0.2683 --- loss: 1.357416, loss_ss: 1.018403, loss_d: 0.339012
0.3066 --- loss: 1.288237, loss_ss: 0.905875, loss_d: 0.382362
0.3450 --- loss: 1.336576, loss_ss: 0.990850, loss_d: 0.345726
0.3833 --- loss: 1.784881, loss_ss: 1.465456, loss_d: 0.319425
0.4216 --- loss: 1.521951, loss_ss: 1.214584, loss_d: 0.307367
0.4599 --- loss: 1.190269, loss_ss: 0.813078, loss_d: 0.377191
0.4983 --- loss: 1.409012, loss_ss: 1.064465, loss_d: 0.344548
0.5366 --- loss: 1.396282, loss_ss: 1.176632, loss_d: 0.219650
0.5749 --- loss: 1.373878, loss_ss: 1.071592, loss_d: 0.302285
0.6133 --- loss: 1.256073, loss_ss: 0.897586, loss_d: 0.358488
0.6516 --- loss: 1.543592, loss_ss: 1.044118, loss_d: 0.499475
0.6899 --- loss: 1.464407, loss_ss: 1.164415, loss_d: 0.299992
0.7282 --- loss: 1.208660, loss_ss: 0.975809, loss_d: 0.232851
0.7666 --- loss: 1.380088, loss_ss: 1.042203, loss_d: 0.337885
0.8049 --- loss: 1.230649, loss_ss: 0.875515, loss_d: 0.355134
0.8432 --- loss: 1.193140, loss_ss: 0.872248, loss_d: 0.320891
0.8816 --- loss: 1.386990, loss_ss: 1.110413, loss_d: 0.276577
0.9199 --- loss: 1.440581, loss_ss: 0.846602, loss_d: 0.593979
0.9582 --- loss: 1.297643, loss_ss: 1.060473, loss_d: 0.237171
0.9966 --- loss: 2.120749, loss_ss: 1.290306, loss_d: 0.830443
Epoch finished! Loss: 1.504825748847081
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6195402298850575
             precision    recall  f1-score   support

        0.0       0.30      0.34      0.32        59
        1.0       0.00      0.00      0.00        60
        2.0       0.60      0.99      0.75       389
        3.0       0.94      0.64      0.76       151
        4.0       0.65      0.17      0.27       211

avg / total       0.61      0.62      0.55       870
 


====== chc033-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  90.23  33.90   94.33  30.30     32.00
1  93.10   0.00  100.00   0.00      0.00
2  69.89  99.49   45.95  59.81     74.71
3  92.99  63.58   99.17  94.12     75.89
4  77.70  17.06   97.12  65.45     27.07
Total accuracy: 61.95%
Average sen: 42.80%
Average spec: 87.31%
Macro f1-score: 41.93%
[0.77116644 0.66406572 0.39851254 0.35509583 0.55815578 0.40370977
 0.61269623 0.73977596 0.73610008 0.66964608 0.37647569 0.32249174
 0.66174829 0.51271313 0.48302954 0.73540276 0.76633066 0.77526498
 0.73795658 0.74340594 0.52122486 0.5725044  0.29808956 0.80243915
 0.73988765 0.74731362 0.64647949 0.49681783 0.77295822]
pred: 0.6076365010491733, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.440029, loss_ss: 1.722286, loss_d: 0.717743
0.0383 --- loss: 2.407135, loss_ss: 1.731413, loss_d: 0.675722
0.0767 --- loss: 2.360540, loss_ss: 1.681615, loss_d: 0.678925
0.1150 --- loss: 2.293127, loss_ss: 1.723791, loss_d: 0.569335
0.1534 --- loss: 2.196380, loss_ss: 1.738523, loss_d: 0.457858
0.1917 --- loss: 2.496457, loss_ss: 1.685836, loss_d: 0.810621
0.2301 --- loss: 2.243516, loss_ss: 1.635491, loss_d: 0.608025
0.2684 --- loss: 2.420903, loss_ss: 1.680772, loss_d: 0.740132
0.3067 --- loss: 2.071629, loss_ss: 1.641312, loss_d: 0.430317
0.3451 --- loss: 2.052563, loss_ss: 1.650097, loss_d: 0.402466
0.3834 --- loss: 2.309897, loss_ss: 1.611895, loss_d: 0.698003
0.4218 --- loss: 2.035422, loss_ss: 1.657607, loss_d: 0.377815
0.4601 --- loss: 1.870209, loss_ss: 1.542672, loss_d: 0.327537
0.4985 --- loss: 2.153641, loss_ss: 1.657205, loss_d: 0.496437
0.5368 --- loss: 2.064105, loss_ss: 1.729436, loss_d: 0.334669
0.5752 --- loss: 2.267252, loss_ss: 1.493898, loss_d: 0.773354
0.6135 --- loss: 1.893704, loss_ss: 1.546369, loss_d: 0.347334
0.6518 --- loss: 2.120604, loss_ss: 1.601676, loss_d: 0.518927
0.6902 --- loss: 2.220532, loss_ss: 1.601797, loss_d: 0.618735
0.7285 --- loss: 2.391913, loss_ss: 1.542797, loss_d: 0.849116
0.7669 --- loss: 2.051899, loss_ss: 1.432513, loss_d: 0.619385
0.8052 --- loss: 2.076029, loss_ss: 1.529061, loss_d: 0.546968
0.8436 --- loss: 2.088932, loss_ss: 1.614710, loss_d: 0.474222
0.8819 --- loss: 2.097057, loss_ss: 1.599941, loss_d: 0.497116
0.9202 --- loss: 2.221818, loss_ss: 1.531942, loss_d: 0.689876
0.9586 --- loss: 1.951745, loss_ss: 1.555174, loss_d: 0.396570
0.9969 --- loss: 1.893634, loss_ss: 1.396558, loss_d: 0.497075
Epoch finished! Loss: 2.1565053481322067
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.932697, loss_ss: 1.632662, loss_d: 0.300035
0.0383 --- loss: 2.227569, loss_ss: 1.488076, loss_d: 0.739493
0.0767 --- loss: 1.786035, loss_ss: 1.535087, loss_d: 0.250948
0.1150 --- loss: 2.239264, loss_ss: 1.547926, loss_d: 0.691338
0.1534 --- loss: 1.903189, loss_ss: 1.386850, loss_d: 0.516340
0.1917 --- loss: 2.014919, loss_ss: 1.684301, loss_d: 0.330618
0.2301 --- loss: 1.929696, loss_ss: 1.400839, loss_d: 0.528857
0.2684 --- loss: 2.015560, loss_ss: 1.554374, loss_d: 0.461185
0.3067 --- loss: 2.204361, loss_ss: 1.649031, loss_d: 0.555330
0.3451 --- loss: 1.851242, loss_ss: 1.477280, loss_d: 0.373962
0.3834 --- loss: 2.134125, loss_ss: 1.520248, loss_d: 0.613877
0.4218 --- loss: 1.752939, loss_ss: 1.304072, loss_d: 0.448867
0.4601 --- loss: 2.292674, loss_ss: 1.808324, loss_d: 0.484350
0.4985 --- loss: 1.927462, loss_ss: 1.583076, loss_d: 0.344386
0.5368 --- loss: 2.185330, loss_ss: 1.575032, loss_d: 0.610298
0.5752 --- loss: 1.784544, loss_ss: 1.425849, loss_d: 0.358695
0.6135 --- loss: 2.287170, loss_ss: 1.472313, loss_d: 0.814856
0.6518 --- loss: 2.267887, loss_ss: 1.652432, loss_d: 0.615455
0.6902 --- loss: 1.864174, loss_ss: 1.492271, loss_d: 0.371903
0.7285 --- loss: 2.070561, loss_ss: 1.428481, loss_d: 0.642080
0.7669 --- loss: 2.126688, loss_ss: 1.597142, loss_d: 0.529546
0.8052 --- loss: 1.691635, loss_ss: 1.430643, loss_d: 0.260992
0.8436 --- loss: 1.811050, loss_ss: 1.425400, loss_d: 0.385651
0.8819 --- loss: 1.894661, loss_ss: 1.533213, loss_d: 0.361447
0.9202 --- loss: 2.203274, loss_ss: 1.603489, loss_d: 0.599785
0.9586 --- loss: 1.673916, loss_ss: 1.460621, loss_d: 0.213296
0.9969 --- loss: 2.063812, loss_ss: 1.404700, loss_d: 0.659112
Epoch finished! Loss: 2.023851208961927
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.997088, loss_ss: 1.411811, loss_d: 0.585277
0.0383 --- loss: 2.110587, loss_ss: 1.560694, loss_d: 0.549893
0.0767 --- loss: 2.342483, loss_ss: 1.489782, loss_d: 0.852701
0.1150 --- loss: 2.226316, loss_ss: 1.471706, loss_d: 0.754610
0.1534 --- loss: 2.226399, loss_ss: 1.490153, loss_d: 0.736246
0.1917 --- loss: 1.969638, loss_ss: 1.628597, loss_d: 0.341040
0.2301 --- loss: 1.798342, loss_ss: 1.414568, loss_d: 0.383774
0.2684 --- loss: 1.981280, loss_ss: 1.347236, loss_d: 0.634044
0.3067 --- loss: 2.098744, loss_ss: 1.409829, loss_d: 0.688915
0.3451 --- loss: 1.967342, loss_ss: 1.552270, loss_d: 0.415072
0.3834 --- loss: 1.711508, loss_ss: 1.354829, loss_d: 0.356679
0.4218 --- loss: 1.883544, loss_ss: 1.554125, loss_d: 0.329418
0.4601 --- loss: 1.792701, loss_ss: 1.341234, loss_d: 0.451467
0.4985 --- loss: 1.826024, loss_ss: 1.473738, loss_d: 0.352286
0.5368 --- loss: 1.673520, loss_ss: 1.229689, loss_d: 0.443831
0.5752 --- loss: 1.977227, loss_ss: 1.393606, loss_d: 0.583621
0.6135 --- loss: 1.949883, loss_ss: 1.467891, loss_d: 0.481992
0.6518 --- loss: 2.523031, loss_ss: 1.746533, loss_d: 0.776498
0.6902 --- loss: 2.021979, loss_ss: 1.421533, loss_d: 0.600446
0.7285 --- loss: 1.789705, loss_ss: 1.369057, loss_d: 0.420648
0.7669 --- loss: 1.680087, loss_ss: 1.345610, loss_d: 0.334477
0.8052 --- loss: 1.734342, loss_ss: 1.275210, loss_d: 0.459131
0.8436 --- loss: 1.949747, loss_ss: 1.680784, loss_d: 0.268964
0.8819 --- loss: 1.691090, loss_ss: 1.223182, loss_d: 0.467907
0.9202 --- loss: 1.824471, loss_ss: 1.462688, loss_d: 0.361783
0.9586 --- loss: 1.793800, loss_ss: 1.493743, loss_d: 0.300057
0.9969 --- loss: 2.156109, loss_ss: 1.568962, loss_d: 0.587147
Epoch finished! Loss: 1.9289112554146692
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.106294, loss_ss: 1.340208, loss_d: 0.766087
0.0383 --- loss: 1.694455, loss_ss: 1.325991, loss_d: 0.368464
0.0767 --- loss: 1.625863, loss_ss: 1.274147, loss_d: 0.351717
0.1150 --- loss: 2.151947, loss_ss: 1.250221, loss_d: 0.901726
0.1534 --- loss: 1.761895, loss_ss: 1.364746, loss_d: 0.397149
0.1917 --- loss: 2.083373, loss_ss: 1.601714, loss_d: 0.481659
0.2301 --- loss: 1.734807, loss_ss: 1.206387, loss_d: 0.528420
0.2684 --- loss: 2.005163, loss_ss: 1.673350, loss_d: 0.331813
0.3067 --- loss: 2.506780, loss_ss: 1.234165, loss_d: 1.272615
0.3451 --- loss: 1.657300, loss_ss: 1.328555, loss_d: 0.328745
0.3834 --- loss: 2.042853, loss_ss: 1.467826, loss_d: 0.575027
0.4218 --- loss: 1.757082, loss_ss: 1.404753, loss_d: 0.352329
0.4601 --- loss: 1.783619, loss_ss: 1.255098, loss_d: 0.528522
0.4985 --- loss: 2.023343, loss_ss: 1.439996, loss_d: 0.583347
0.5368 --- loss: 2.056768, loss_ss: 1.390007, loss_d: 0.666760
0.5752 --- loss: 1.536383, loss_ss: 1.220901, loss_d: 0.315482
0.6135 --- loss: 2.051638, loss_ss: 1.328891, loss_d: 0.722747
0.6518 --- loss: 1.655107, loss_ss: 1.335226, loss_d: 0.319881
0.6902 --- loss: 1.779560, loss_ss: 1.341614, loss_d: 0.437947
0.7285 --- loss: 1.793458, loss_ss: 1.461524, loss_d: 0.331935
0.7669 --- loss: 1.984647, loss_ss: 1.520943, loss_d: 0.463704
0.8052 --- loss: 1.761252, loss_ss: 1.324395, loss_d: 0.436856
0.8436 --- loss: 1.910941, loss_ss: 1.261816, loss_d: 0.649126
0.8819 --- loss: 1.932919, loss_ss: 1.309216, loss_d: 0.623703
0.9202 --- loss: 1.688162, loss_ss: 1.275829, loss_d: 0.412333
0.9586 --- loss: 1.681196, loss_ss: 1.306661, loss_d: 0.374535
0.9969 --- loss: 2.061700, loss_ss: 1.368687, loss_d: 0.693013
Epoch finished! Loss: 1.8099426136567043
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.677890, loss_ss: 1.306691, loss_d: 0.371199
0.0383 --- loss: 1.609197, loss_ss: 1.018810, loss_d: 0.590387
0.0767 --- loss: 1.670635, loss_ss: 1.181713, loss_d: 0.488922
0.1150 --- loss: 1.625493, loss_ss: 1.173388, loss_d: 0.452105
0.1534 --- loss: 1.513332, loss_ss: 1.250543, loss_d: 0.262789
0.1917 --- loss: 1.586706, loss_ss: 1.162479, loss_d: 0.424227
0.2301 --- loss: 1.536918, loss_ss: 1.154361, loss_d: 0.382557
0.2684 --- loss: 1.476097, loss_ss: 1.036863, loss_d: 0.439234
0.3067 --- loss: 1.722056, loss_ss: 1.191527, loss_d: 0.530529
0.3451 --- loss: 1.990884, loss_ss: 1.226058, loss_d: 0.764825
0.3834 --- loss: 1.408278, loss_ss: 1.088243, loss_d: 0.320035
0.4218 --- loss: 2.141677, loss_ss: 1.427794, loss_d: 0.713883
0.4601 --- loss: 1.750067, loss_ss: 1.209590, loss_d: 0.540477
0.4985 --- loss: 1.610381, loss_ss: 1.243119, loss_d: 0.367263
0.5368 --- loss: 1.549553, loss_ss: 1.211088, loss_d: 0.338465
0.5752 --- loss: 1.374278, loss_ss: 1.033314, loss_d: 0.340964
0.6135 --- loss: 1.454779, loss_ss: 1.080281, loss_d: 0.374498
0.6518 --- loss: 1.673633, loss_ss: 1.069202, loss_d: 0.604431
0.6902 --- loss: 1.449214, loss_ss: 1.111506, loss_d: 0.337709
0.7285 --- loss: 1.435205, loss_ss: 1.029024, loss_d: 0.406180
0.7669 --- loss: 1.357579, loss_ss: 1.090796, loss_d: 0.266783
0.8052 --- loss: 1.493770, loss_ss: 1.231215, loss_d: 0.262555
0.8436 --- loss: 2.348795, loss_ss: 1.010191, loss_d: 1.338604
0.8819 --- loss: 1.551008, loss_ss: 1.254402, loss_d: 0.296606
0.9202 --- loss: 1.404855, loss_ss: 1.085947, loss_d: 0.318908
0.9586 --- loss: 1.558659, loss_ss: 0.946344, loss_d: 0.612315
0.9969 --- loss: 1.616235, loss_ss: 1.253253, loss_d: 0.362981
Epoch finished! Loss: 1.6852101990809807
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.644157, loss_ss: 1.169919, loss_d: 0.474238
0.0383 --- loss: 1.265301, loss_ss: 0.959456, loss_d: 0.305845
0.0767 --- loss: 2.087918, loss_ss: 0.993277, loss_d: 1.094641
0.1150 --- loss: 1.298447, loss_ss: 1.023542, loss_d: 0.274905
0.1534 --- loss: 1.856052, loss_ss: 1.325541, loss_d: 0.530512
0.1917 --- loss: 1.694785, loss_ss: 1.362100, loss_d: 0.332685
0.2301 --- loss: 1.256178, loss_ss: 0.964523, loss_d: 0.291655
0.2684 --- loss: 1.486866, loss_ss: 0.987929, loss_d: 0.498937
0.3067 --- loss: 1.521441, loss_ss: 1.210424, loss_d: 0.311017
0.3451 --- loss: 1.397322, loss_ss: 1.185949, loss_d: 0.211373
0.3834 --- loss: 2.025754, loss_ss: 1.408441, loss_d: 0.617313
0.4218 --- loss: 1.516634, loss_ss: 1.012248, loss_d: 0.504387
0.4601 --- loss: 1.789434, loss_ss: 1.269861, loss_d: 0.519573
0.4985 --- loss: 2.038480, loss_ss: 1.526880, loss_d: 0.511600
0.5368 --- loss: 1.293404, loss_ss: 0.949667, loss_d: 0.343736
0.5752 --- loss: 1.428023, loss_ss: 1.145934, loss_d: 0.282089
0.6135 --- loss: 1.498072, loss_ss: 1.108429, loss_d: 0.389643
0.6518 --- loss: 2.001700, loss_ss: 1.230998, loss_d: 0.770701
0.6902 --- loss: 2.072988, loss_ss: 1.204186, loss_d: 0.868802
0.7285 --- loss: 1.517519, loss_ss: 1.040317, loss_d: 0.477202
0.7669 --- loss: 1.455442, loss_ss: 1.146636, loss_d: 0.308806
0.8052 --- loss: 1.600395, loss_ss: 1.184922, loss_d: 0.415472
0.8436 --- loss: 1.810106, loss_ss: 1.185760, loss_d: 0.624346
0.8819 --- loss: 1.352253, loss_ss: 1.033283, loss_d: 0.318969
0.9202 --- loss: 1.802926, loss_ss: 1.240513, loss_d: 0.562413
0.9586 --- loss: 1.274155, loss_ss: 0.847848, loss_d: 0.426308
0.9969 --- loss: 1.529514, loss_ss: 1.038716, loss_d: 0.490798
Epoch finished! Loss: 1.6350538336313687
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.822755, loss_ss: 0.905046, loss_d: 0.917709
0.0383 --- loss: 1.352804, loss_ss: 1.033831, loss_d: 0.318972
0.0767 --- loss: 1.572135, loss_ss: 1.156943, loss_d: 0.415193
0.1150 --- loss: 1.502545, loss_ss: 1.123052, loss_d: 0.379493
0.1534 --- loss: 1.395911, loss_ss: 1.084881, loss_d: 0.311030
0.1917 --- loss: 1.512452, loss_ss: 1.130054, loss_d: 0.382398
0.2301 --- loss: 1.576629, loss_ss: 1.130319, loss_d: 0.446310
0.2684 --- loss: 1.625302, loss_ss: 1.283091, loss_d: 0.342211
0.3067 --- loss: 1.717769, loss_ss: 1.179077, loss_d: 0.538692
0.3451 --- loss: 1.795250, loss_ss: 1.030046, loss_d: 0.765204
0.3834 --- loss: 1.500507, loss_ss: 1.258640, loss_d: 0.241867
0.4218 --- loss: 1.712037, loss_ss: 0.951517, loss_d: 0.760520
0.4601 --- loss: 1.504346, loss_ss: 1.026042, loss_d: 0.478303
0.4985 --- loss: 1.649465, loss_ss: 1.151636, loss_d: 0.497829
0.5368 --- loss: 1.432472, loss_ss: 1.156171, loss_d: 0.276301
0.5752 --- loss: 1.515261, loss_ss: 1.104814, loss_d: 0.410447
0.6135 --- loss: 1.281260, loss_ss: 0.878311, loss_d: 0.402949
0.6518 --- loss: 1.628755, loss_ss: 1.170909, loss_d: 0.457846
0.6902 --- loss: 1.443038, loss_ss: 0.980523, loss_d: 0.462515
0.7285 --- loss: 1.646032, loss_ss: 0.978605, loss_d: 0.667427
0.7669 --- loss: 1.414796, loss_ss: 1.052372, loss_d: 0.362424
0.8052 --- loss: 1.386661, loss_ss: 0.923210, loss_d: 0.463451
0.8436 --- loss: 1.478919, loss_ss: 0.987616, loss_d: 0.491304
0.8819 --- loss: 1.630799, loss_ss: 1.217776, loss_d: 0.413023
0.9202 --- loss: 1.511615, loss_ss: 1.094605, loss_d: 0.417010
0.9586 --- loss: 1.840249, loss_ss: 1.512864, loss_d: 0.327385
0.9969 --- loss: 1.831548, loss_ss: 1.097541, loss_d: 0.734008
Epoch finished! Loss: 1.6014390028440035
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.508668, loss_ss: 1.138659, loss_d: 0.370009
0.0383 --- loss: 1.866365, loss_ss: 1.173018, loss_d: 0.693346
0.0767 --- loss: 1.427809, loss_ss: 1.085619, loss_d: 0.342190
0.1150 --- loss: 1.321623, loss_ss: 0.857989, loss_d: 0.463634
0.1534 --- loss: 1.761120, loss_ss: 1.443219, loss_d: 0.317901
0.1917 --- loss: 1.348866, loss_ss: 0.993390, loss_d: 0.355476
0.2301 --- loss: 1.519195, loss_ss: 1.308932, loss_d: 0.210263
0.2684 --- loss: 1.601242, loss_ss: 0.906821, loss_d: 0.694421
0.3067 --- loss: 1.634664, loss_ss: 1.336834, loss_d: 0.297830
0.3451 --- loss: 1.282247, loss_ss: 0.901313, loss_d: 0.380934
0.3834 --- loss: 1.230360, loss_ss: 0.990424, loss_d: 0.239936
0.4218 --- loss: 1.388018, loss_ss: 1.021465, loss_d: 0.366553
0.4601 --- loss: 1.572125, loss_ss: 1.349526, loss_d: 0.222599
0.4985 --- loss: 1.390696, loss_ss: 1.140242, loss_d: 0.250453
0.5368 --- loss: 1.150878, loss_ss: 0.929446, loss_d: 0.221432
0.5752 --- loss: 1.931806, loss_ss: 1.087006, loss_d: 0.844800
0.6135 --- loss: 1.425625, loss_ss: 1.057319, loss_d: 0.368307
0.6518 --- loss: 1.367498, loss_ss: 1.022847, loss_d: 0.344651
0.6902 --- loss: 1.296599, loss_ss: 0.803903, loss_d: 0.492696
0.7285 --- loss: 1.424470, loss_ss: 1.071464, loss_d: 0.353006
0.7669 --- loss: 1.250098, loss_ss: 1.023468, loss_d: 0.226631
0.8052 --- loss: 1.456720, loss_ss: 1.153183, loss_d: 0.303537
0.8436 --- loss: 1.784086, loss_ss: 1.218493, loss_d: 0.565593
0.8819 --- loss: 1.286821, loss_ss: 1.017528, loss_d: 0.269293
0.9202 --- loss: 1.746987, loss_ss: 0.891379, loss_d: 0.855608
0.9586 --- loss: 1.538508, loss_ss: 0.875257, loss_d: 0.663251
0.9969 --- loss: 1.624664, loss_ss: 1.137904, loss_d: 0.486760
Epoch finished! Loss: 1.564755789591716
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.441445, loss_ss: 1.218305, loss_d: 0.223140
0.0383 --- loss: 1.636035, loss_ss: 1.068580, loss_d: 0.567455
0.0767 --- loss: 1.609584, loss_ss: 1.157098, loss_d: 0.452486
0.1150 --- loss: 1.604612, loss_ss: 1.234524, loss_d: 0.370088
0.1534 --- loss: 1.680921, loss_ss: 1.136211, loss_d: 0.544710
0.1917 --- loss: 1.251149, loss_ss: 1.021094, loss_d: 0.230055
0.2301 --- loss: 1.675293, loss_ss: 1.217300, loss_d: 0.457993
0.2684 --- loss: 1.351342, loss_ss: 0.994712, loss_d: 0.356630
0.3067 --- loss: 1.323249, loss_ss: 0.839895, loss_d: 0.483353
0.3451 --- loss: 1.623690, loss_ss: 1.242472, loss_d: 0.381218
0.3834 --- loss: 1.596787, loss_ss: 1.134758, loss_d: 0.462030
0.4218 --- loss: 1.369467, loss_ss: 1.072663, loss_d: 0.296804
0.4601 --- loss: 1.221544, loss_ss: 0.776059, loss_d: 0.445486
0.4985 --- loss: 1.196768, loss_ss: 0.942002, loss_d: 0.254766
0.5368 --- loss: 1.375143, loss_ss: 1.110583, loss_d: 0.264559
0.5752 --- loss: 1.111448, loss_ss: 0.837695, loss_d: 0.273753
0.6135 --- loss: 1.461256, loss_ss: 1.173949, loss_d: 0.287307
0.6518 --- loss: 1.407182, loss_ss: 1.102338, loss_d: 0.304843
0.6902 --- loss: 1.608448, loss_ss: 1.245142, loss_d: 0.363306
0.7285 --- loss: 1.347487, loss_ss: 1.101843, loss_d: 0.245644
0.7669 --- loss: 1.295041, loss_ss: 1.073442, loss_d: 0.221598
0.8052 --- loss: 1.312949, loss_ss: 1.098409, loss_d: 0.214540
0.8436 --- loss: 2.105204, loss_ss: 1.371325, loss_d: 0.733879
0.8819 --- loss: 1.500072, loss_ss: 1.069789, loss_d: 0.430284
0.9202 --- loss: 1.804064, loss_ss: 1.075211, loss_d: 0.728853
0.9586 --- loss: 1.415546, loss_ss: 1.063107, loss_d: 0.352439
0.9969 --- loss: 1.354109, loss_ss: 0.860840, loss_d: 0.493269
Epoch finished! Loss: 1.540449064053022
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.589660, loss_ss: 1.187728, loss_d: 0.401932
0.0383 --- loss: 1.715970, loss_ss: 1.277798, loss_d: 0.438172
0.0767 --- loss: 1.413848, loss_ss: 1.126904, loss_d: 0.286944
0.1150 --- loss: 1.184917, loss_ss: 0.908060, loss_d: 0.276856
0.1534 --- loss: 1.792048, loss_ss: 1.389511, loss_d: 0.402537
0.1917 --- loss: 2.027024, loss_ss: 1.319646, loss_d: 0.707378
0.2301 --- loss: 1.771391, loss_ss: 1.366815, loss_d: 0.404576
0.2684 --- loss: 1.239055, loss_ss: 0.731609, loss_d: 0.507447
0.3067 --- loss: 1.641124, loss_ss: 1.298610, loss_d: 0.342514
0.3451 --- loss: 1.234657, loss_ss: 1.003602, loss_d: 0.231055
0.3834 --- loss: 1.390095, loss_ss: 1.117890, loss_d: 0.272206
0.4218 --- loss: 1.823600, loss_ss: 1.259873, loss_d: 0.563726
0.4601 --- loss: 1.675264, loss_ss: 1.132784, loss_d: 0.542479
0.4985 --- loss: 1.489946, loss_ss: 1.016346, loss_d: 0.473600
0.5368 --- loss: 1.701219, loss_ss: 1.023927, loss_d: 0.677292
0.5752 --- loss: 1.459349, loss_ss: 1.057789, loss_d: 0.401560
0.6135 --- loss: 1.847958, loss_ss: 1.386028, loss_d: 0.461930
0.6518 --- loss: 1.512041, loss_ss: 1.218300, loss_d: 0.293741
0.6902 --- loss: 1.387846, loss_ss: 1.004872, loss_d: 0.382974
0.7285 --- loss: 1.581063, loss_ss: 1.046823, loss_d: 0.534241
0.7669 --- loss: 1.263299, loss_ss: 0.990366, loss_d: 0.272933
0.8052 --- loss: 1.350909, loss_ss: 1.050889, loss_d: 0.300020
0.8436 --- loss: 1.332178, loss_ss: 0.951964, loss_d: 0.380215
0.8819 --- loss: 1.482008, loss_ss: 1.249676, loss_d: 0.232333
0.9202 --- loss: 1.186524, loss_ss: 0.960935, loss_d: 0.225588
0.9586 --- loss: 1.351027, loss_ss: 0.993559, loss_d: 0.357468
0.9969 --- loss: 1.573600, loss_ss: 0.983818, loss_d: 0.589782
Epoch finished! Loss: 1.5323987589432644
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4177777777777778
             precision    recall  f1-score   support

        0.0       0.08      0.83      0.14        29
        1.0       0.00      0.00      0.00        57
        2.0       0.67      0.64      0.66       391
        3.0       1.00      0.05      0.09       250
        4.0       0.43      0.51      0.46       173

avg / total       0.65      0.42      0.40       900
 


====== chc035-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  68.33  82.76   67.85    7.89     14.41
1  93.67   0.00  100.00    0.00      0.00
2  70.56  64.45   75.25   66.67     65.54
3  73.56   4.80  100.00  100.00      9.16
4  77.44  50.87   83.77   42.72     46.44
Total accuracy: 41.78%
Average sen: 40.58%
Average spec: 85.37%
Macro f1-score: 27.11%
[0.34768263 0.43473011 0.54635382 0.61699396 0.68337673 0.60474002
 0.36805055 0.37767413 0.43189621 0.50570178 0.48664707 0.36227587
 0.37892166 0.37540382 0.35679033 0.42497581 0.38498291 0.43672597
 0.40736815 0.42948666 0.40174264 0.3451823  0.38771772 0.36135861
 0.37359235 0.38098407 0.41078299 0.42292354 0.3968724  0.38212606]
pred: 0.42746869623661043, label: 0
Right! Diagnosis: Other

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.620344, loss_ss: 1.783551, loss_d: 0.836794
0.0383 --- loss: 2.463871, loss_ss: 1.676606, loss_d: 0.787265
0.0767 --- loss: 2.243438, loss_ss: 1.771209, loss_d: 0.472229
0.1150 --- loss: 2.172072, loss_ss: 1.633564, loss_d: 0.538508
0.1533 --- loss: 2.132822, loss_ss: 1.720516, loss_d: 0.412305
0.1916 --- loss: 2.300685, loss_ss: 1.625656, loss_d: 0.675029
0.2300 --- loss: 2.177459, loss_ss: 1.643826, loss_d: 0.533633
0.2683 --- loss: 2.090171, loss_ss: 1.722792, loss_d: 0.367379
0.3066 --- loss: 2.120148, loss_ss: 1.677759, loss_d: 0.442389
0.3450 --- loss: 1.861401, loss_ss: 1.621124, loss_d: 0.240277
0.3833 --- loss: 3.175133, loss_ss: 1.679952, loss_d: 1.495180
0.4216 --- loss: 2.176131, loss_ss: 1.698526, loss_d: 0.477605
0.4599 --- loss: 2.124202, loss_ss: 1.497078, loss_d: 0.627124
0.4983 --- loss: 2.025002, loss_ss: 1.544320, loss_d: 0.480682
0.5366 --- loss: 1.957482, loss_ss: 1.529793, loss_d: 0.427689
0.5749 --- loss: 2.232700, loss_ss: 1.692567, loss_d: 0.540134
0.6133 --- loss: 1.911432, loss_ss: 1.503077, loss_d: 0.408355
0.6516 --- loss: 2.396719, loss_ss: 1.459599, loss_d: 0.937120
0.6899 --- loss: 2.184544, loss_ss: 1.672646, loss_d: 0.511898
0.7282 --- loss: 1.820462, loss_ss: 1.429339, loss_d: 0.391124
0.7666 --- loss: 1.897941, loss_ss: 1.488177, loss_d: 0.409764
0.8049 --- loss: 2.260629, loss_ss: 1.684160, loss_d: 0.576468
0.8432 --- loss: 2.153452, loss_ss: 1.548107, loss_d: 0.605346
0.8816 --- loss: 1.854698, loss_ss: 1.459218, loss_d: 0.395480
0.9199 --- loss: 1.678131, loss_ss: 1.314129, loss_d: 0.364002
0.9582 --- loss: 2.096262, loss_ss: 1.609346, loss_d: 0.486916
0.9966 --- loss: 1.868476, loss_ss: 1.413894, loss_d: 0.454582
Epoch finished! Loss: 2.1369742398078624
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.927415, loss_ss: 1.535943, loss_d: 0.391472
0.0383 --- loss: 1.861923, loss_ss: 1.398319, loss_d: 0.463604
0.0767 --- loss: 1.952252, loss_ss: 1.470002, loss_d: 0.482251
0.1150 --- loss: 2.087855, loss_ss: 1.561657, loss_d: 0.526197
0.1533 --- loss: 2.157908, loss_ss: 1.681588, loss_d: 0.476320
0.1916 --- loss: 1.923958, loss_ss: 1.576505, loss_d: 0.347453
0.2300 --- loss: 1.826409, loss_ss: 1.440539, loss_d: 0.385870
0.2683 --- loss: 1.820868, loss_ss: 1.419109, loss_d: 0.401759
0.3066 --- loss: 1.936471, loss_ss: 1.524692, loss_d: 0.411779
0.3450 --- loss: 2.129064, loss_ss: 1.458773, loss_d: 0.670291
0.3833 --- loss: 1.800977, loss_ss: 1.422088, loss_d: 0.378890
0.4216 --- loss: 2.293185, loss_ss: 1.634279, loss_d: 0.658905
0.4599 --- loss: 1.789825, loss_ss: 1.291054, loss_d: 0.498771
0.4983 --- loss: 1.998407, loss_ss: 1.492280, loss_d: 0.506127
0.5366 --- loss: 2.485574, loss_ss: 1.566660, loss_d: 0.918913
0.5749 --- loss: 1.617977, loss_ss: 1.372500, loss_d: 0.245477
0.6133 --- loss: 2.344085, loss_ss: 1.353368, loss_d: 0.990718
0.6516 --- loss: 2.083858, loss_ss: 1.706563, loss_d: 0.377295
0.6899 --- loss: 1.769174, loss_ss: 1.306639, loss_d: 0.462535
0.7282 --- loss: 1.865898, loss_ss: 1.457413, loss_d: 0.408484
0.7666 --- loss: 1.821443, loss_ss: 1.529681, loss_d: 0.291763
0.8049 --- loss: 1.989026, loss_ss: 1.453291, loss_d: 0.535736
0.8432 --- loss: 1.935917, loss_ss: 1.499115, loss_d: 0.436801
0.8816 --- loss: 2.093549, loss_ss: 1.610077, loss_d: 0.483472
0.9199 --- loss: 1.978403, loss_ss: 1.534548, loss_d: 0.443855
0.9582 --- loss: 1.886868, loss_ss: 1.424349, loss_d: 0.462519
0.9966 --- loss: 1.967578, loss_ss: 1.455303, loss_d: 0.512275
Epoch finished! Loss: 1.9664348148382627
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.452838, loss_ss: 1.733001, loss_d: 0.719837
0.0383 --- loss: 1.686116, loss_ss: 1.344013, loss_d: 0.342103
0.0767 --- loss: 1.688522, loss_ss: 1.309897, loss_d: 0.378625
0.1150 --- loss: 1.626597, loss_ss: 1.198705, loss_d: 0.427892
0.1533 --- loss: 1.718365, loss_ss: 1.384930, loss_d: 0.333435
0.1916 --- loss: 1.603790, loss_ss: 1.310245, loss_d: 0.293545
0.2300 --- loss: 1.548705, loss_ss: 1.254220, loss_d: 0.294485
0.2683 --- loss: 1.868110, loss_ss: 1.453919, loss_d: 0.414192
0.3066 --- loss: 1.602805, loss_ss: 1.202322, loss_d: 0.400484
0.3450 --- loss: 1.800189, loss_ss: 1.437991, loss_d: 0.362198
0.3833 --- loss: 1.612648, loss_ss: 1.235618, loss_d: 0.377031
0.4216 --- loss: 1.815315, loss_ss: 1.452645, loss_d: 0.362670
0.4599 --- loss: 1.606067, loss_ss: 1.152637, loss_d: 0.453430
0.4983 --- loss: 2.059874, loss_ss: 1.431927, loss_d: 0.627947
0.5366 --- loss: 1.833253, loss_ss: 1.267994, loss_d: 0.565258
0.5749 --- loss: 1.868415, loss_ss: 1.237762, loss_d: 0.630653
0.6133 --- loss: 1.719604, loss_ss: 1.177663, loss_d: 0.541941
0.6516 --- loss: 1.422373, loss_ss: 1.152116, loss_d: 0.270256
0.6899 --- loss: 1.672287, loss_ss: 1.205817, loss_d: 0.466470
0.7282 --- loss: 1.788293, loss_ss: 1.085263, loss_d: 0.703030
0.7666 --- loss: 1.602610, loss_ss: 1.110993, loss_d: 0.491618
0.8049 --- loss: 1.516225, loss_ss: 1.077922, loss_d: 0.438303
0.8432 --- loss: 1.790065, loss_ss: 1.343068, loss_d: 0.446997
0.8816 --- loss: 1.963588, loss_ss: 1.348397, loss_d: 0.615191
0.9199 --- loss: 1.616997, loss_ss: 1.305729, loss_d: 0.311268
0.9582 --- loss: 1.735151, loss_ss: 1.243471, loss_d: 0.491680
0.9966 --- loss: 2.029147, loss_ss: 1.187777, loss_d: 0.841370
Epoch finished! Loss: 1.8006321031313677
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.983619, loss_ss: 1.401059, loss_d: 0.582560
0.0383 --- loss: 1.594028, loss_ss: 1.149764, loss_d: 0.444264
0.0767 --- loss: 1.788405, loss_ss: 1.331404, loss_d: 0.457001
0.1150 --- loss: 1.514005, loss_ss: 1.243609, loss_d: 0.270396
0.1533 --- loss: 1.841575, loss_ss: 1.201582, loss_d: 0.639993
0.1916 --- loss: 1.717456, loss_ss: 1.259748, loss_d: 0.457707
0.2300 --- loss: 1.930008, loss_ss: 1.128502, loss_d: 0.801507
0.2683 --- loss: 1.561860, loss_ss: 1.082870, loss_d: 0.478990
0.3066 --- loss: 1.753211, loss_ss: 1.313875, loss_d: 0.439336
0.3450 --- loss: 1.794426, loss_ss: 1.456267, loss_d: 0.338160
0.3833 --- loss: 1.703379, loss_ss: 1.436461, loss_d: 0.266918
0.4216 --- loss: 1.404050, loss_ss: 1.053648, loss_d: 0.350402
0.4599 --- loss: 1.867293, loss_ss: 1.333641, loss_d: 0.533652
0.4983 --- loss: 1.665627, loss_ss: 1.087957, loss_d: 0.577670
0.5366 --- loss: 1.528953, loss_ss: 1.130066, loss_d: 0.398887
0.5749 --- loss: 2.097180, loss_ss: 1.655542, loss_d: 0.441638
0.6133 --- loss: 1.698320, loss_ss: 1.036809, loss_d: 0.661511
0.6516 --- loss: 1.821994, loss_ss: 1.344422, loss_d: 0.477571
0.6899 --- loss: 1.669001, loss_ss: 1.143600, loss_d: 0.525401
0.7282 --- loss: 1.669323, loss_ss: 1.051433, loss_d: 0.617890
0.7666 --- loss: 1.462151, loss_ss: 1.150606, loss_d: 0.311545
0.8049 --- loss: 2.212653, loss_ss: 1.451441, loss_d: 0.761212
0.8432 --- loss: 1.737275, loss_ss: 1.304364, loss_d: 0.432911
0.8816 --- loss: 1.671943, loss_ss: 1.112453, loss_d: 0.559490
0.9199 --- loss: 1.751257, loss_ss: 1.068702, loss_d: 0.682556
0.9582 --- loss: 1.659838, loss_ss: 1.350320, loss_d: 0.309517
0.9966 --- loss: 1.986061, loss_ss: 1.000192, loss_d: 0.985869
Epoch finished! Loss: 1.703498020538917
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.528641, loss_ss: 1.264780, loss_d: 0.263862
0.0383 --- loss: 1.470556, loss_ss: 1.025970, loss_d: 0.444586
0.0767 --- loss: 1.777797, loss_ss: 1.085784, loss_d: 0.692014
0.1150 --- loss: 1.242079, loss_ss: 0.910538, loss_d: 0.331541
0.1533 --- loss: 1.464274, loss_ss: 1.017455, loss_d: 0.446819
0.1916 --- loss: 1.907487, loss_ss: 1.166042, loss_d: 0.741445
0.2300 --- loss: 1.695735, loss_ss: 1.157553, loss_d: 0.538182
0.2683 --- loss: 1.669901, loss_ss: 0.986954, loss_d: 0.682947
0.3066 --- loss: 1.350386, loss_ss: 1.125959, loss_d: 0.224427
0.3450 --- loss: 1.861259, loss_ss: 1.333548, loss_d: 0.527712
0.3833 --- loss: 2.089765, loss_ss: 1.255228, loss_d: 0.834537
0.4216 --- loss: 1.612209, loss_ss: 1.200248, loss_d: 0.411960
0.4599 --- loss: 1.652521, loss_ss: 1.015933, loss_d: 0.636587
0.4983 --- loss: 1.591358, loss_ss: 1.038046, loss_d: 0.553312
0.5366 --- loss: 1.364226, loss_ss: 1.044626, loss_d: 0.319600
0.5749 --- loss: 1.986400, loss_ss: 1.523492, loss_d: 0.462908
0.6133 --- loss: 1.691372, loss_ss: 1.093683, loss_d: 0.597690
0.6516 --- loss: 1.796325, loss_ss: 1.304721, loss_d: 0.491604
0.6899 --- loss: 1.481941, loss_ss: 1.059068, loss_d: 0.422873
0.7282 --- loss: 1.876114, loss_ss: 1.269886, loss_d: 0.606228
0.7666 --- loss: 1.508271, loss_ss: 1.123116, loss_d: 0.385156
0.8049 --- loss: 1.349518, loss_ss: 1.003225, loss_d: 0.346293
0.8432 --- loss: 1.626688, loss_ss: 1.160835, loss_d: 0.465853
0.8816 --- loss: 1.686652, loss_ss: 1.060645, loss_d: 0.626006
0.9199 --- loss: 1.353308, loss_ss: 0.954089, loss_d: 0.399220
0.9582 --- loss: 1.976217, loss_ss: 1.573092, loss_d: 0.403125
0.9966 --- loss: 1.728041, loss_ss: 1.275461, loss_d: 0.452580
Epoch finished! Loss: 1.6350402978750376
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.862098, loss_ss: 1.108988, loss_d: 0.753110
0.0383 --- loss: 1.606214, loss_ss: 1.015092, loss_d: 0.591122
0.0767 --- loss: 1.589377, loss_ss: 1.064178, loss_d: 0.525199
0.1150 --- loss: 1.625171, loss_ss: 1.241639, loss_d: 0.383532
0.1533 --- loss: 1.633582, loss_ss: 1.002055, loss_d: 0.631528
0.1916 --- loss: 1.453438, loss_ss: 0.981649, loss_d: 0.471789
0.2300 --- loss: 1.482512, loss_ss: 1.218771, loss_d: 0.263741
0.2683 --- loss: 1.703813, loss_ss: 1.281450, loss_d: 0.422363
0.3066 --- loss: 1.832724, loss_ss: 1.143765, loss_d: 0.688958
0.3450 --- loss: 1.408280, loss_ss: 0.975638, loss_d: 0.432642
0.3833 --- loss: 1.769760, loss_ss: 1.227398, loss_d: 0.542361
0.4216 --- loss: 1.450769, loss_ss: 1.148648, loss_d: 0.302121
0.4599 --- loss: 1.363857, loss_ss: 0.816606, loss_d: 0.547252
0.4983 --- loss: 1.306861, loss_ss: 1.046514, loss_d: 0.260347
0.5366 --- loss: 1.621979, loss_ss: 1.099244, loss_d: 0.522735
0.5749 --- loss: 1.680446, loss_ss: 1.109439, loss_d: 0.571006
0.6133 --- loss: 1.490445, loss_ss: 1.222536, loss_d: 0.267909
0.6516 --- loss: 1.494166, loss_ss: 1.061459, loss_d: 0.432707
0.6899 --- loss: 1.993940, loss_ss: 0.996478, loss_d: 0.997462
0.7282 --- loss: 1.457479, loss_ss: 1.134834, loss_d: 0.322645
0.7666 --- loss: 1.716946, loss_ss: 1.303783, loss_d: 0.413163
0.8049 --- loss: 1.582147, loss_ss: 0.983566, loss_d: 0.598581
0.8432 --- loss: 1.741371, loss_ss: 1.158645, loss_d: 0.582726
0.8816 --- loss: 1.725411, loss_ss: 1.352726, loss_d: 0.372686
0.9199 --- loss: 1.536689, loss_ss: 1.185255, loss_d: 0.351434
0.9582 --- loss: 1.949739, loss_ss: 1.366226, loss_d: 0.583513
0.9966 --- loss: 1.816266, loss_ss: 1.525908, loss_d: 0.290358
Epoch finished! Loss: 1.58621522463285
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.353065, loss_ss: 1.013954, loss_d: 0.339111
0.0383 --- loss: 1.400855, loss_ss: 0.956189, loss_d: 0.444666
0.0767 --- loss: 1.284919, loss_ss: 0.946503, loss_d: 0.338416
0.1150 --- loss: 1.465717, loss_ss: 0.963884, loss_d: 0.501833
0.1533 --- loss: 1.459972, loss_ss: 0.962300, loss_d: 0.497673
0.1916 --- loss: 1.556122, loss_ss: 1.111917, loss_d: 0.444205
0.2300 --- loss: 1.562580, loss_ss: 0.938018, loss_d: 0.624562
0.2683 --- loss: 1.478758, loss_ss: 1.092408, loss_d: 0.386350
0.3066 --- loss: 1.797997, loss_ss: 1.395985, loss_d: 0.402012
0.3450 --- loss: 1.260049, loss_ss: 1.006522, loss_d: 0.253527
0.3833 --- loss: 1.501069, loss_ss: 1.187837, loss_d: 0.313232
0.4216 --- loss: 2.327580, loss_ss: 1.104234, loss_d: 1.223347
0.4599 --- loss: 1.520198, loss_ss: 1.182315, loss_d: 0.337883
0.4983 --- loss: 1.424530, loss_ss: 1.141880, loss_d: 0.282650
0.5366 --- loss: 1.601044, loss_ss: 0.923708, loss_d: 0.677336
0.5749 --- loss: 1.500808, loss_ss: 1.269490, loss_d: 0.231318
0.6133 --- loss: 1.284734, loss_ss: 0.940469, loss_d: 0.344265
0.6516 --- loss: 1.455489, loss_ss: 1.121421, loss_d: 0.334068
0.6899 --- loss: 1.529482, loss_ss: 0.987039, loss_d: 0.542443
0.7282 --- loss: 1.737498, loss_ss: 1.270489, loss_d: 0.467009
0.7666 --- loss: 1.234489, loss_ss: 0.978688, loss_d: 0.255801
0.8049 --- loss: 1.714861, loss_ss: 1.020244, loss_d: 0.694617
0.8432 --- loss: 1.110746, loss_ss: 0.785782, loss_d: 0.324964
0.8816 --- loss: 1.683055, loss_ss: 1.345078, loss_d: 0.337977
0.9199 --- loss: 1.400483, loss_ss: 1.180827, loss_d: 0.219656
0.9582 --- loss: 1.780081, loss_ss: 1.398501, loss_d: 0.381579
0.9966 --- loss: 1.662233, loss_ss: 1.182291, loss_d: 0.479941
Epoch finished! Loss: 1.557009461751351
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.609911, loss_ss: 1.047177, loss_d: 0.562734
0.0383 --- loss: 1.605769, loss_ss: 1.163125, loss_d: 0.442643
0.0767 --- loss: 1.194941, loss_ss: 0.817633, loss_d: 0.377308
0.1150 --- loss: 1.344841, loss_ss: 0.880638, loss_d: 0.464203
0.1533 --- loss: 1.306434, loss_ss: 1.046922, loss_d: 0.259511
0.1916 --- loss: 1.184749, loss_ss: 0.828548, loss_d: 0.356201
0.2300 --- loss: 1.553897, loss_ss: 1.091562, loss_d: 0.462335
0.2683 --- loss: 1.614427, loss_ss: 1.059359, loss_d: 0.555068
0.3066 --- loss: 2.030975, loss_ss: 1.530894, loss_d: 0.500081
0.3450 --- loss: 1.681264, loss_ss: 1.195900, loss_d: 0.485364
0.3833 --- loss: 1.341195, loss_ss: 1.041712, loss_d: 0.299483
0.4216 --- loss: 1.468282, loss_ss: 0.810747, loss_d: 0.657535
0.4599 --- loss: 1.568169, loss_ss: 1.166329, loss_d: 0.401841
0.4983 --- loss: 1.954519, loss_ss: 0.934561, loss_d: 1.019958
0.5366 --- loss: 1.309247, loss_ss: 0.971999, loss_d: 0.337248
0.5749 --- loss: 1.135603, loss_ss: 0.818315, loss_d: 0.317287
0.6133 --- loss: 1.388878, loss_ss: 1.085032, loss_d: 0.303846
0.6516 --- loss: 1.993094, loss_ss: 1.075371, loss_d: 0.917723
0.6899 --- loss: 1.540803, loss_ss: 1.088483, loss_d: 0.452321
0.7282 --- loss: 1.596200, loss_ss: 1.145469, loss_d: 0.450731
0.7666 --- loss: 2.144558, loss_ss: 1.387914, loss_d: 0.756645
0.8049 --- loss: 1.919237, loss_ss: 1.292700, loss_d: 0.626537
0.8432 --- loss: 1.650824, loss_ss: 1.114084, loss_d: 0.536740
0.8816 --- loss: 1.824180, loss_ss: 1.358474, loss_d: 0.465706
0.9199 --- loss: 1.258189, loss_ss: 0.887294, loss_d: 0.370894
0.9582 --- loss: 1.293031, loss_ss: 1.023911, loss_d: 0.269120
0.9966 --- loss: 1.396653, loss_ss: 1.032473, loss_d: 0.364180
Epoch finished! Loss: 1.5443446636199951
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.620613, loss_ss: 0.992036, loss_d: 0.628578
0.0383 --- loss: 1.471994, loss_ss: 1.029858, loss_d: 0.442136
0.0767 --- loss: 1.757083, loss_ss: 1.346764, loss_d: 0.410318
0.1150 --- loss: 1.909763, loss_ss: 1.233588, loss_d: 0.676176
0.1533 --- loss: 1.402492, loss_ss: 1.026976, loss_d: 0.375515
0.1916 --- loss: 1.955869, loss_ss: 1.351842, loss_d: 0.604027
0.2300 --- loss: 1.673706, loss_ss: 0.965410, loss_d: 0.708296
0.2683 --- loss: 1.490793, loss_ss: 1.001575, loss_d: 0.489218
0.3066 --- loss: 1.440453, loss_ss: 1.087216, loss_d: 0.353237
0.3450 --- loss: 1.514889, loss_ss: 0.970373, loss_d: 0.544516
0.3833 --- loss: 1.116887, loss_ss: 0.920681, loss_d: 0.196206
0.4216 --- loss: 1.444587, loss_ss: 1.139876, loss_d: 0.304711
0.4599 --- loss: 1.184608, loss_ss: 0.846866, loss_d: 0.337743
0.4983 --- loss: 1.329903, loss_ss: 0.962292, loss_d: 0.367611
0.5366 --- loss: 1.637155, loss_ss: 1.167269, loss_d: 0.469886
0.5749 --- loss: 1.642779, loss_ss: 1.141978, loss_d: 0.500801
0.6133 --- loss: 1.866031, loss_ss: 1.240816, loss_d: 0.625214
0.6516 --- loss: 1.356102, loss_ss: 0.978500, loss_d: 0.377602
0.6899 --- loss: 1.330648, loss_ss: 0.976285, loss_d: 0.354363
0.7282 --- loss: 1.627168, loss_ss: 1.365146, loss_d: 0.262022
0.7666 --- loss: 1.507535, loss_ss: 0.866314, loss_d: 0.641220
0.8049 --- loss: 1.147064, loss_ss: 0.835204, loss_d: 0.311860
0.8432 --- loss: 2.062438, loss_ss: 1.657215, loss_d: 0.405223
0.8816 --- loss: 1.127032, loss_ss: 0.880975, loss_d: 0.246057
0.9199 --- loss: 1.502036, loss_ss: 0.939272, loss_d: 0.562763
0.9582 --- loss: 1.507750, loss_ss: 1.153019, loss_d: 0.354730
0.9966 --- loss: 1.362193, loss_ss: 1.052832, loss_d: 0.309361
Epoch finished! Loss: 1.521275215424024
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.191903, loss_ss: 1.015477, loss_d: 0.176426
0.0383 --- loss: 1.623767, loss_ss: 1.354510, loss_d: 0.269257
0.0767 --- loss: 1.449420, loss_ss: 0.995861, loss_d: 0.453559
0.1150 --- loss: 1.398969, loss_ss: 0.799539, loss_d: 0.599430
0.1533 --- loss: 1.952717, loss_ss: 1.493818, loss_d: 0.458899
0.1916 --- loss: 1.239547, loss_ss: 1.040777, loss_d: 0.198770
0.2300 --- loss: 1.545530, loss_ss: 1.156046, loss_d: 0.389484
0.2683 --- loss: 1.644532, loss_ss: 1.101267, loss_d: 0.543265
0.3066 --- loss: 1.467681, loss_ss: 1.048734, loss_d: 0.418947
0.3450 --- loss: 1.367358, loss_ss: 0.869977, loss_d: 0.497381
0.3833 --- loss: 1.500131, loss_ss: 1.161181, loss_d: 0.338950
0.4216 --- loss: 1.329211, loss_ss: 1.005637, loss_d: 0.323575
0.4599 --- loss: 1.320468, loss_ss: 1.072402, loss_d: 0.248067
0.4983 --- loss: 1.445523, loss_ss: 1.090980, loss_d: 0.354544
0.5366 --- loss: 1.730447, loss_ss: 1.125580, loss_d: 0.604867
0.5749 --- loss: 1.175994, loss_ss: 0.957537, loss_d: 0.218457
0.6133 --- loss: 1.489954, loss_ss: 1.169159, loss_d: 0.320795
0.6516 --- loss: 1.482958, loss_ss: 1.079673, loss_d: 0.403285
0.6899 --- loss: 1.629489, loss_ss: 1.006745, loss_d: 0.622744
0.7282 --- loss: 1.587712, loss_ss: 1.187469, loss_d: 0.400243
0.7666 --- loss: 1.524038, loss_ss: 1.277302, loss_d: 0.246736
0.8049 --- loss: 1.638897, loss_ss: 1.337032, loss_d: 0.301865
0.8432 --- loss: 1.513146, loss_ss: 1.159882, loss_d: 0.353264
0.8816 --- loss: 1.269626, loss_ss: 0.941402, loss_d: 0.328224
0.9199 --- loss: 1.282415, loss_ss: 1.014958, loss_d: 0.267457
0.9582 --- loss: 1.938458, loss_ss: 1.286137, loss_d: 0.652321
0.9966 --- loss: 1.687435, loss_ss: 1.186567, loss_d: 0.500868
Epoch finished! Loss: 1.4922566675222837
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.34597701149425286
             precision    recall  f1-score   support

        0.0       0.42      0.10      0.16       154
        1.0       0.00      0.00      0.00        34
        2.0       0.35      0.32      0.33       307
        3.0       0.00      0.00      0.00       168
        4.0       0.34      0.91      0.50       207

avg / total       0.28      0.35      0.26       870
 


====== chc037-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  81.61   9.74   97.07  41.67     15.79
1  96.09   0.00  100.00   0.00      0.00
2  55.06  31.60   67.85  34.89     33.16
3  80.69   0.00  100.00   0.00      0.00
4  55.75  91.30   44.65  33.99     49.54
Total accuracy: 34.60%
Average sen: 26.53%
Average spec: 81.91%
Macro f1-score: 19.70%
[0.22666226 0.22051618 0.20235796 0.19735689 0.23212615 0.19984858
 0.21086289 0.14342481 0.12439293 0.14559294 0.22747605 0.21688804
 0.16528423 0.12883152 0.11490422 0.14584641 0.18974255 0.18170013
 0.24081181 0.27666777 0.24648552 0.23007353 0.20934261 0.15689278
 0.23896646 0.24941118 0.25205076 0.24590905 0.21876493]
pred: 0.20135141857739153, label: 0
Right! Diagnosis: Other

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.300184, loss_ss: 1.656709, loss_d: 0.643475
0.0384 --- loss: 2.607929, loss_ss: 1.685138, loss_d: 0.922792
0.0769 --- loss: 2.099310, loss_ss: 1.546077, loss_d: 0.553233
0.1153 --- loss: 2.525624, loss_ss: 1.697476, loss_d: 0.828148
0.1537 --- loss: 2.024101, loss_ss: 1.493968, loss_d: 0.530133
0.1922 --- loss: 2.137285, loss_ss: 1.571124, loss_d: 0.566162
0.2306 --- loss: 2.193972, loss_ss: 1.684397, loss_d: 0.509576
0.2690 --- loss: 2.116612, loss_ss: 1.650153, loss_d: 0.466459
0.3075 --- loss: 2.517126, loss_ss: 1.549430, loss_d: 0.967696
0.3459 --- loss: 2.068087, loss_ss: 1.557655, loss_d: 0.510431
0.3843 --- loss: 2.151189, loss_ss: 1.468444, loss_d: 0.682744
0.4228 --- loss: 1.851156, loss_ss: 1.450709, loss_d: 0.400447
0.4612 --- loss: 2.124556, loss_ss: 1.510134, loss_d: 0.614422
0.4996 --- loss: 2.078355, loss_ss: 1.496487, loss_d: 0.581868
0.5380 --- loss: 2.036539, loss_ss: 1.406427, loss_d: 0.630113
0.5765 --- loss: 2.091522, loss_ss: 1.467577, loss_d: 0.623945
0.6149 --- loss: 1.905730, loss_ss: 1.577121, loss_d: 0.328610
0.6533 --- loss: 1.832463, loss_ss: 1.528009, loss_d: 0.304453
0.6918 --- loss: 2.212650, loss_ss: 1.531574, loss_d: 0.681076
0.7302 --- loss: 1.915593, loss_ss: 1.452509, loss_d: 0.463084
0.7686 --- loss: 2.009867, loss_ss: 1.406827, loss_d: 0.603040
0.8071 --- loss: 2.169339, loss_ss: 1.424471, loss_d: 0.744868
0.8455 --- loss: 1.795881, loss_ss: 1.325917, loss_d: 0.469964
0.8839 --- loss: 1.755417, loss_ss: 1.374919, loss_d: 0.380498
0.9224 --- loss: 1.872423, loss_ss: 1.530070, loss_d: 0.342353
0.9608 --- loss: 1.961392, loss_ss: 1.491233, loss_d: 0.470158
0.9992 --- loss: 1.629722, loss_ss: 1.320739, loss_d: 0.308984
Epoch finished! Loss: 2.0913962295422186
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.835473, loss_ss: 1.575890, loss_d: 0.259583
0.0384 --- loss: 2.308367, loss_ss: 1.603295, loss_d: 0.705072
0.0769 --- loss: 1.886254, loss_ss: 1.561084, loss_d: 0.325170
0.1153 --- loss: 1.865721, loss_ss: 1.444942, loss_d: 0.420779
0.1537 --- loss: 1.693775, loss_ss: 1.291449, loss_d: 0.402326
0.1922 --- loss: 2.154389, loss_ss: 1.533867, loss_d: 0.620522
0.2306 --- loss: 2.227366, loss_ss: 1.675676, loss_d: 0.551690
0.2690 --- loss: 1.990222, loss_ss: 1.435016, loss_d: 0.555207
0.3075 --- loss: 2.183115, loss_ss: 1.302381, loss_d: 0.880733
0.3459 --- loss: 1.963713, loss_ss: 1.516934, loss_d: 0.446779
0.3843 --- loss: 2.101725, loss_ss: 1.561318, loss_d: 0.540407
0.4228 --- loss: 1.918412, loss_ss: 1.545448, loss_d: 0.372964
0.4612 --- loss: 1.988062, loss_ss: 1.582297, loss_d: 0.405765
0.4996 --- loss: 2.023877, loss_ss: 1.383108, loss_d: 0.640770
0.5380 --- loss: 1.911671, loss_ss: 1.392190, loss_d: 0.519482
0.5765 --- loss: 1.923547, loss_ss: 1.353273, loss_d: 0.570275
0.6149 --- loss: 1.735149, loss_ss: 1.234045, loss_d: 0.501104
0.6533 --- loss: 1.897744, loss_ss: 1.297565, loss_d: 0.600179
0.6918 --- loss: 1.958378, loss_ss: 1.387393, loss_d: 0.570986
0.7302 --- loss: 2.183996, loss_ss: 1.559613, loss_d: 0.624384
0.7686 --- loss: 1.741117, loss_ss: 1.481693, loss_d: 0.259423
0.8071 --- loss: 2.122448, loss_ss: 1.414075, loss_d: 0.708374
0.8455 --- loss: 2.163594, loss_ss: 1.289317, loss_d: 0.874277
0.8839 --- loss: 1.630054, loss_ss: 1.187585, loss_d: 0.442469
0.9224 --- loss: 1.968567, loss_ss: 1.380973, loss_d: 0.587593
0.9608 --- loss: 1.902974, loss_ss: 1.557383, loss_d: 0.345591
0.9992 --- loss: 1.743133, loss_ss: 1.332991, loss_d: 0.410142
Epoch finished! Loss: 1.9605335235595702
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.617762, loss_ss: 1.189275, loss_d: 0.428487
0.0384 --- loss: 2.057542, loss_ss: 1.387722, loss_d: 0.669820
0.0769 --- loss: 1.891499, loss_ss: 1.507347, loss_d: 0.384152
0.1153 --- loss: 1.952028, loss_ss: 1.439089, loss_d: 0.512939
0.1537 --- loss: 1.795113, loss_ss: 1.155345, loss_d: 0.639768
0.1922 --- loss: 1.811919, loss_ss: 1.401861, loss_d: 0.410058
0.2306 --- loss: 1.899345, loss_ss: 1.533803, loss_d: 0.365542
0.2690 --- loss: 1.924048, loss_ss: 1.520936, loss_d: 0.403112
0.3075 --- loss: 1.836232, loss_ss: 1.221119, loss_d: 0.615113
0.3459 --- loss: 1.555824, loss_ss: 1.280275, loss_d: 0.275549
0.3843 --- loss: 2.092883, loss_ss: 1.555346, loss_d: 0.537537
0.4228 --- loss: 2.053900, loss_ss: 1.587240, loss_d: 0.466660
0.4612 --- loss: 1.918250, loss_ss: 1.575589, loss_d: 0.342661
0.4996 --- loss: 1.691058, loss_ss: 1.336546, loss_d: 0.354511
0.5380 --- loss: 1.627302, loss_ss: 1.122852, loss_d: 0.504451
0.5765 --- loss: 2.147524, loss_ss: 1.444162, loss_d: 0.703362
0.6149 --- loss: 1.748289, loss_ss: 1.241949, loss_d: 0.506340
0.6533 --- loss: 1.735330, loss_ss: 1.287540, loss_d: 0.447790
0.6918 --- loss: 1.850495, loss_ss: 1.284146, loss_d: 0.566349
0.7302 --- loss: 1.594450, loss_ss: 1.208714, loss_d: 0.385736
0.7686 --- loss: 1.685733, loss_ss: 1.229373, loss_d: 0.456360
0.8071 --- loss: 1.624815, loss_ss: 1.217100, loss_d: 0.407715
0.8455 --- loss: 1.600006, loss_ss: 1.327952, loss_d: 0.272053
0.8839 --- loss: 1.464292, loss_ss: 1.217598, loss_d: 0.246694
0.9224 --- loss: 1.843247, loss_ss: 1.383837, loss_d: 0.459410
0.9608 --- loss: 1.824833, loss_ss: 1.577775, loss_d: 0.247058
0.9992 --- loss: 1.510931, loss_ss: 1.196305, loss_d: 0.314626
Epoch finished! Loss: 1.8591089748419247
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.783675, loss_ss: 1.497373, loss_d: 0.286302
0.0384 --- loss: 1.829993, loss_ss: 1.324147, loss_d: 0.505846
0.0769 --- loss: 1.995227, loss_ss: 1.405751, loss_d: 0.589476
0.1153 --- loss: 1.612037, loss_ss: 1.239643, loss_d: 0.372394
0.1537 --- loss: 1.671390, loss_ss: 1.267543, loss_d: 0.403847
0.1922 --- loss: 2.190642, loss_ss: 1.377225, loss_d: 0.813418
0.2306 --- loss: 2.006423, loss_ss: 1.424193, loss_d: 0.582230
0.2690 --- loss: 1.640419, loss_ss: 1.195123, loss_d: 0.445296
0.3075 --- loss: 1.758309, loss_ss: 1.298405, loss_d: 0.459903
0.3459 --- loss: 1.813576, loss_ss: 1.343374, loss_d: 0.470202
0.3843 --- loss: 1.440595, loss_ss: 1.105571, loss_d: 0.335024
0.4228 --- loss: 1.694652, loss_ss: 1.396270, loss_d: 0.298383
0.4612 --- loss: 1.556614, loss_ss: 1.164580, loss_d: 0.392035
0.4996 --- loss: 1.637782, loss_ss: 1.246714, loss_d: 0.391068
0.5380 --- loss: 1.802612, loss_ss: 1.188143, loss_d: 0.614469
0.5765 --- loss: 1.714926, loss_ss: 1.176778, loss_d: 0.538148
0.6149 --- loss: 2.506168, loss_ss: 1.255762, loss_d: 1.250407
0.6533 --- loss: 1.900078, loss_ss: 1.346764, loss_d: 0.553314
0.6918 --- loss: 2.123320, loss_ss: 1.278491, loss_d: 0.844830
0.7302 --- loss: 1.549784, loss_ss: 1.133661, loss_d: 0.416122
0.7686 --- loss: 2.259231, loss_ss: 1.789865, loss_d: 0.469365
0.8071 --- loss: 1.403645, loss_ss: 1.112580, loss_d: 0.291065
0.8455 --- loss: 1.980758, loss_ss: 1.522843, loss_d: 0.457915
0.8839 --- loss: 1.769918, loss_ss: 1.323507, loss_d: 0.446411
0.9224 --- loss: 1.823783, loss_ss: 1.350360, loss_d: 0.473423
0.9608 --- loss: 1.661568, loss_ss: 1.405670, loss_d: 0.255898
0.9992 --- loss: 2.205435, loss_ss: 1.810714, loss_d: 0.394721
Epoch finished! Loss: 1.7656759495918568
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.587937, loss_ss: 1.167890, loss_d: 0.420047
0.0384 --- loss: 1.861161, loss_ss: 1.476412, loss_d: 0.384749
0.0769 --- loss: 1.886216, loss_ss: 1.143507, loss_d: 0.742710
0.1153 --- loss: 1.557699, loss_ss: 1.204770, loss_d: 0.352929
0.1537 --- loss: 1.714837, loss_ss: 1.126519, loss_d: 0.588318
0.1922 --- loss: 1.441504, loss_ss: 1.032675, loss_d: 0.408829
0.2306 --- loss: 1.796642, loss_ss: 1.453655, loss_d: 0.342986
0.2690 --- loss: 1.300850, loss_ss: 0.984142, loss_d: 0.316709
0.3075 --- loss: 1.299982, loss_ss: 0.894656, loss_d: 0.405325
0.3459 --- loss: 1.575330, loss_ss: 1.187520, loss_d: 0.387810
0.3843 --- loss: 1.617531, loss_ss: 1.139566, loss_d: 0.477966
0.4228 --- loss: 2.356270, loss_ss: 1.599799, loss_d: 0.756471
0.4612 --- loss: 1.990755, loss_ss: 1.135578, loss_d: 0.855177
0.4996 --- loss: 1.672486, loss_ss: 1.010213, loss_d: 0.662273
0.5380 --- loss: 1.838738, loss_ss: 1.455637, loss_d: 0.383100
0.5765 --- loss: 1.494748, loss_ss: 1.098895, loss_d: 0.395853
0.6149 --- loss: 1.814147, loss_ss: 1.408167, loss_d: 0.405980
0.6533 --- loss: 1.509735, loss_ss: 1.203002, loss_d: 0.306733
0.6918 --- loss: 1.569131, loss_ss: 1.202167, loss_d: 0.366964
0.7302 --- loss: 1.793507, loss_ss: 1.056482, loss_d: 0.737025
0.7686 --- loss: 2.061272, loss_ss: 1.363976, loss_d: 0.697296
0.8071 --- loss: 1.304280, loss_ss: 0.979199, loss_d: 0.325081
0.8455 --- loss: 1.367632, loss_ss: 1.052333, loss_d: 0.315298
0.8839 --- loss: 1.795565, loss_ss: 1.189655, loss_d: 0.605910
0.9224 --- loss: 1.467784, loss_ss: 0.988009, loss_d: 0.479775
0.9608 --- loss: 1.546353, loss_ss: 1.080621, loss_d: 0.465732
0.9992 --- loss: 3.483411, loss_ss: 1.293970, loss_d: 2.189441
Epoch finished! Loss: 1.683919353210009
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.507342, loss_ss: 0.994927, loss_d: 0.512415
0.0384 --- loss: 1.748633, loss_ss: 1.107890, loss_d: 0.640743
0.0769 --- loss: 1.451974, loss_ss: 1.072351, loss_d: 0.379624
0.1153 --- loss: 1.423511, loss_ss: 1.074369, loss_d: 0.349142
0.1537 --- loss: 1.929503, loss_ss: 1.366723, loss_d: 0.562780
0.1922 --- loss: 1.892217, loss_ss: 1.327248, loss_d: 0.564969
0.2306 --- loss: 1.715636, loss_ss: 1.175897, loss_d: 0.539739
0.2690 --- loss: 1.627882, loss_ss: 1.155351, loss_d: 0.472530
0.3075 --- loss: 1.592357, loss_ss: 1.213356, loss_d: 0.379001
0.3459 --- loss: 1.393255, loss_ss: 0.979279, loss_d: 0.413977
0.3843 --- loss: 1.916118, loss_ss: 1.210731, loss_d: 0.705387
0.4228 --- loss: 1.696326, loss_ss: 1.283576, loss_d: 0.412749
0.4612 --- loss: 1.671957, loss_ss: 1.055198, loss_d: 0.616759
0.4996 --- loss: 1.729899, loss_ss: 1.174844, loss_d: 0.555056
0.5380 --- loss: 1.481841, loss_ss: 0.988583, loss_d: 0.493258
0.5765 --- loss: 1.597647, loss_ss: 1.038495, loss_d: 0.559152
0.6149 --- loss: 1.545381, loss_ss: 1.061871, loss_d: 0.483510
0.6533 --- loss: 1.723254, loss_ss: 1.123449, loss_d: 0.599805
0.6918 --- loss: 2.119278, loss_ss: 1.148846, loss_d: 0.970433
0.7302 --- loss: 1.238060, loss_ss: 0.892905, loss_d: 0.345155
0.7686 --- loss: 1.544267, loss_ss: 1.226132, loss_d: 0.318135
0.8071 --- loss: 1.417238, loss_ss: 0.925422, loss_d: 0.491816
0.8455 --- loss: 2.132276, loss_ss: 1.168584, loss_d: 0.963692
0.8839 --- loss: 1.497793, loss_ss: 1.025834, loss_d: 0.471959
0.9224 --- loss: 1.503255, loss_ss: 1.117387, loss_d: 0.385868
0.9608 --- loss: 1.668791, loss_ss: 1.265760, loss_d: 0.403031
0.9992 --- loss: 1.414292, loss_ss: 0.976465, loss_d: 0.437827
Epoch finished! Loss: 1.63971857382701
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.637189, loss_ss: 1.165293, loss_d: 0.471897
0.0384 --- loss: 1.612320, loss_ss: 1.159233, loss_d: 0.453087
0.0769 --- loss: 1.350034, loss_ss: 1.023985, loss_d: 0.326049
0.1153 --- loss: 1.551667, loss_ss: 1.104825, loss_d: 0.446842
0.1537 --- loss: 1.322126, loss_ss: 0.952538, loss_d: 0.369587
0.1922 --- loss: 2.668284, loss_ss: 1.403854, loss_d: 1.264430
0.2306 --- loss: 1.637557, loss_ss: 1.019352, loss_d: 0.618205
0.2690 --- loss: 1.532272, loss_ss: 1.081788, loss_d: 0.450484
0.3075 --- loss: 1.310639, loss_ss: 1.035270, loss_d: 0.275369
0.3459 --- loss: 1.565753, loss_ss: 1.155400, loss_d: 0.410353
0.3843 --- loss: 1.640731, loss_ss: 1.140380, loss_d: 0.500351
0.4228 --- loss: 1.740688, loss_ss: 1.140098, loss_d: 0.600590
0.4612 --- loss: 1.640082, loss_ss: 1.277929, loss_d: 0.362152
0.4996 --- loss: 1.775543, loss_ss: 1.165236, loss_d: 0.610307
0.5380 --- loss: 1.483845, loss_ss: 0.915323, loss_d: 0.568522
0.5765 --- loss: 1.418624, loss_ss: 1.040448, loss_d: 0.378176
0.6149 --- loss: 1.584851, loss_ss: 1.076621, loss_d: 0.508230
0.6533 --- loss: 1.993539, loss_ss: 1.061011, loss_d: 0.932528
0.6918 --- loss: 1.249867, loss_ss: 0.956320, loss_d: 0.293547
0.7302 --- loss: 1.798020, loss_ss: 1.482457, loss_d: 0.315563
0.7686 --- loss: 1.685911, loss_ss: 1.018609, loss_d: 0.667303
0.8071 --- loss: 1.718598, loss_ss: 1.336737, loss_d: 0.381861
0.8455 --- loss: 1.764398, loss_ss: 1.038007, loss_d: 0.726391
0.8839 --- loss: 1.548601, loss_ss: 1.133062, loss_d: 0.415540
0.9224 --- loss: 2.172771, loss_ss: 1.386189, loss_d: 0.786581
0.9608 --- loss: 1.366849, loss_ss: 1.023915, loss_d: 0.342934
0.9992 --- loss: 1.479072, loss_ss: 1.082289, loss_d: 0.396783
Epoch finished! Loss: 1.569048635317729
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.819932, loss_ss: 1.030225, loss_d: 0.789706
0.0384 --- loss: 1.871747, loss_ss: 1.150736, loss_d: 0.721011
0.0769 --- loss: 1.326474, loss_ss: 0.856666, loss_d: 0.469808
0.1153 --- loss: 1.526858, loss_ss: 1.080511, loss_d: 0.446347
0.1537 --- loss: 1.366240, loss_ss: 1.017063, loss_d: 0.349177
0.1922 --- loss: 1.236649, loss_ss: 0.861422, loss_d: 0.375227
0.2306 --- loss: 1.270510, loss_ss: 0.866510, loss_d: 0.404000
0.2690 --- loss: 2.260851, loss_ss: 1.627036, loss_d: 0.633815
0.3075 --- loss: 1.608714, loss_ss: 1.230176, loss_d: 0.378538
0.3459 --- loss: 1.459062, loss_ss: 1.016605, loss_d: 0.442457
0.3843 --- loss: 1.511688, loss_ss: 0.921342, loss_d: 0.590346
0.4228 --- loss: 1.589192, loss_ss: 1.125779, loss_d: 0.463413
0.4612 --- loss: 1.637816, loss_ss: 1.142149, loss_d: 0.495667
0.4996 --- loss: 1.752660, loss_ss: 1.133895, loss_d: 0.618765
0.5380 --- loss: 1.668248, loss_ss: 1.318634, loss_d: 0.349613
0.5765 --- loss: 1.515962, loss_ss: 1.200141, loss_d: 0.315822
0.6149 --- loss: 1.510768, loss_ss: 0.981732, loss_d: 0.529036
0.6533 --- loss: 1.470413, loss_ss: 1.065555, loss_d: 0.404858
0.6918 --- loss: 1.228356, loss_ss: 0.692914, loss_d: 0.535441
0.7302 --- loss: 1.628614, loss_ss: 1.280783, loss_d: 0.347831
0.7686 --- loss: 1.062979, loss_ss: 0.727439, loss_d: 0.335540
0.8071 --- loss: 0.994411, loss_ss: 0.659712, loss_d: 0.334700
0.8455 --- loss: 1.424996, loss_ss: 0.956514, loss_d: 0.468482
0.8839 --- loss: 1.479271, loss_ss: 1.017315, loss_d: 0.461956
0.9224 --- loss: 1.341627, loss_ss: 0.965557, loss_d: 0.376070
0.9608 --- loss: 2.249614, loss_ss: 1.310870, loss_d: 0.938743
0.9992 --- loss: 3.705220, loss_ss: 1.496581, loss_d: 2.208640
Epoch finished! Loss: 1.5827616593012444
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.718333, loss_ss: 1.378416, loss_d: 0.339916
0.0384 --- loss: 1.452173, loss_ss: 1.105305, loss_d: 0.346868
0.0769 --- loss: 1.540399, loss_ss: 1.217187, loss_d: 0.323212
0.1153 --- loss: 1.609348, loss_ss: 1.317449, loss_d: 0.291899
0.1537 --- loss: 1.563410, loss_ss: 0.983986, loss_d: 0.579423
0.1922 --- loss: 1.331919, loss_ss: 1.026196, loss_d: 0.305724
0.2306 --- loss: 1.260040, loss_ss: 0.896809, loss_d: 0.363231
0.2690 --- loss: 2.022159, loss_ss: 1.331897, loss_d: 0.690262
0.3075 --- loss: 1.749072, loss_ss: 1.169474, loss_d: 0.579598
0.3459 --- loss: 1.306832, loss_ss: 0.935433, loss_d: 0.371399
0.3843 --- loss: 1.980959, loss_ss: 1.353759, loss_d: 0.627200
0.4228 --- loss: 1.362014, loss_ss: 0.949983, loss_d: 0.412031
0.4612 --- loss: 1.846596, loss_ss: 1.446590, loss_d: 0.400006
0.4996 --- loss: 1.797357, loss_ss: 1.138089, loss_d: 0.659267
0.5380 --- loss: 1.330726, loss_ss: 0.997276, loss_d: 0.333450
0.5765 --- loss: 2.097434, loss_ss: 1.468899, loss_d: 0.628535
0.6149 --- loss: 1.584262, loss_ss: 1.272613, loss_d: 0.311649
0.6533 --- loss: 1.999348, loss_ss: 1.413414, loss_d: 0.585934
0.6918 --- loss: 1.227106, loss_ss: 0.919545, loss_d: 0.307560
0.7302 --- loss: 1.645257, loss_ss: 0.995031, loss_d: 0.650226
0.7686 --- loss: 1.168761, loss_ss: 0.822201, loss_d: 0.346560
0.8071 --- loss: 1.473647, loss_ss: 1.060263, loss_d: 0.413384
0.8455 --- loss: 1.469255, loss_ss: 1.083375, loss_d: 0.385880
0.8839 --- loss: 1.377277, loss_ss: 1.040168, loss_d: 0.337108
0.9224 --- loss: 1.580845, loss_ss: 1.191374, loss_d: 0.389471
0.9608 --- loss: 1.363947, loss_ss: 0.999111, loss_d: 0.364835
0.9992 --- loss: 2.593552, loss_ss: 2.204184, loss_d: 0.389368
Epoch finished! Loss: 1.5432859223622541
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.278183, loss_ss: 0.905312, loss_d: 0.372872
0.0384 --- loss: 1.322769, loss_ss: 1.014172, loss_d: 0.308596
0.0769 --- loss: 1.360076, loss_ss: 1.044382, loss_d: 0.315694
0.1153 --- loss: 1.580419, loss_ss: 1.360084, loss_d: 0.220336
0.1537 --- loss: 1.323871, loss_ss: 0.865688, loss_d: 0.458183
0.1922 --- loss: 1.600955, loss_ss: 1.210310, loss_d: 0.390645
0.2306 --- loss: 1.543281, loss_ss: 1.148399, loss_d: 0.394881
0.2690 --- loss: 1.446822, loss_ss: 1.147119, loss_d: 0.299702
0.3075 --- loss: 1.568853, loss_ss: 1.236038, loss_d: 0.332816
0.3459 --- loss: 1.651345, loss_ss: 1.233874, loss_d: 0.417471
0.3843 --- loss: 1.447634, loss_ss: 0.969381, loss_d: 0.478253
0.4228 --- loss: 1.455842, loss_ss: 1.038112, loss_d: 0.417730
0.4612 --- loss: 1.297094, loss_ss: 1.009336, loss_d: 0.287758
0.4996 --- loss: 1.711589, loss_ss: 1.197159, loss_d: 0.514430
0.5380 --- loss: 1.354405, loss_ss: 1.016174, loss_d: 0.338231
0.5765 --- loss: 1.506316, loss_ss: 1.158627, loss_d: 0.347689
0.6149 --- loss: 1.661116, loss_ss: 1.027583, loss_d: 0.633533
0.6533 --- loss: 1.320681, loss_ss: 1.043630, loss_d: 0.277051
0.6918 --- loss: 1.441874, loss_ss: 0.766968, loss_d: 0.674906
0.7302 --- loss: 2.049046, loss_ss: 1.680759, loss_d: 0.368287
0.7686 --- loss: 1.521726, loss_ss: 1.057086, loss_d: 0.464639
0.8071 --- loss: 1.460272, loss_ss: 1.143024, loss_d: 0.317248
0.8455 --- loss: 1.572343, loss_ss: 1.036386, loss_d: 0.535956
0.8839 --- loss: 1.602187, loss_ss: 1.082081, loss_d: 0.520106
0.9224 --- loss: 1.297404, loss_ss: 1.052559, loss_d: 0.244844
0.9608 --- loss: 1.405558, loss_ss: 1.089578, loss_d: 0.315980
0.9992 --- loss: 2.051020, loss_ss: 1.668211, loss_d: 0.382809
Epoch finished! Loss: 1.5051252094598917
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.15925925925925927
             precision    recall  f1-score   support

        0.0       0.23      0.25      0.24       185
        1.0       0.00      0.00      0.00        50
        2.0       0.00      0.00      0.00       483
        3.0       0.00      0.00      0.00       216
        4.0       0.14      0.86      0.25       146

avg / total       0.06      0.16      0.07      1080
 


====== chc040-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  72.59  24.86   82.46  22.66     23.71
1  95.37   0.00  100.00   0.00      0.00
2  55.28   0.00  100.00   0.00      0.00
3  80.00   0.00  100.00   0.00      0.00
4  28.61  86.30   19.59  14.37     24.63
Total accuracy: 15.93%
Average sen: 22.23%
Average spec: 80.41%
Macro f1-score: 9.67%
[0.85522163 0.8343519  0.86624014 0.90851915 0.83510655 0.86229247
 0.85021484 0.87054002 0.87590778 0.88188004 0.83328998 0.86152089
 0.89233619 0.89478314 0.86054277 0.86453837 0.85972106 0.85580349
 0.87516594 0.84932661 0.83410496 0.8359471  0.83963996 0.83731043
 0.85075307 0.85008299 0.890549   0.83884788 0.86402196 0.87259877
 0.86604995 0.87510711 0.84517986 0.85606176 0.82440478 0.82348186]
pred: 0.858095677362548, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.361593, loss_ss: 1.651346, loss_d: 0.710248
0.0383 --- loss: 2.087093, loss_ss: 1.621968, loss_d: 0.465125
0.0766 --- loss: 2.195071, loss_ss: 1.630156, loss_d: 0.564915
0.1149 --- loss: 2.093359, loss_ss: 1.749367, loss_d: 0.343993
0.1533 --- loss: 2.405875, loss_ss: 1.626874, loss_d: 0.779001
0.1916 --- loss: 2.402183, loss_ss: 1.605690, loss_d: 0.796493
0.2299 --- loss: 2.168056, loss_ss: 1.565588, loss_d: 0.602468
0.2682 --- loss: 2.101068, loss_ss: 1.664007, loss_d: 0.437061
0.3065 --- loss: 2.251178, loss_ss: 1.641561, loss_d: 0.609617
0.3448 --- loss: 2.143364, loss_ss: 1.511913, loss_d: 0.631452
0.3831 --- loss: 1.867067, loss_ss: 1.440764, loss_d: 0.426304
0.4215 --- loss: 2.065730, loss_ss: 1.482366, loss_d: 0.583364
0.4598 --- loss: 2.797545, loss_ss: 1.461743, loss_d: 1.335802
0.4981 --- loss: 2.225294, loss_ss: 1.567660, loss_d: 0.657634
0.5364 --- loss: 2.480235, loss_ss: 1.688479, loss_d: 0.791756
0.5747 --- loss: 2.155306, loss_ss: 1.493967, loss_d: 0.661339
0.6130 --- loss: 2.056001, loss_ss: 1.632871, loss_d: 0.423130
0.6513 --- loss: 1.988774, loss_ss: 1.412174, loss_d: 0.576600
0.6897 --- loss: 1.971118, loss_ss: 1.452119, loss_d: 0.518999
0.7280 --- loss: 2.025295, loss_ss: 1.568181, loss_d: 0.457114
0.7663 --- loss: 1.984489, loss_ss: 1.544265, loss_d: 0.440223
0.8046 --- loss: 1.956714, loss_ss: 1.635385, loss_d: 0.321329
0.8429 --- loss: 1.768267, loss_ss: 1.271360, loss_d: 0.496908
0.8812 --- loss: 1.952658, loss_ss: 1.340831, loss_d: 0.611827
0.9195 --- loss: 2.128527, loss_ss: 1.359184, loss_d: 0.769344
0.9579 --- loss: 2.072578, loss_ss: 1.368380, loss_d: 0.704198
0.9962 --- loss: 1.748086, loss_ss: 1.391083, loss_d: 0.357002
Epoch finished! Loss: 2.1125126779079437
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.634155, loss_ss: 1.288069, loss_d: 0.346086
0.0383 --- loss: 1.963799, loss_ss: 1.633619, loss_d: 0.330180
0.0766 --- loss: 2.197031, loss_ss: 1.238637, loss_d: 0.958393
0.1149 --- loss: 1.921531, loss_ss: 1.524709, loss_d: 0.396822
0.1533 --- loss: 1.711095, loss_ss: 1.332173, loss_d: 0.378922
0.1916 --- loss: 2.501845, loss_ss: 1.341524, loss_d: 1.160321
0.2299 --- loss: 2.122227, loss_ss: 1.554196, loss_d: 0.568031
0.2682 --- loss: 1.504271, loss_ss: 1.015723, loss_d: 0.488548
0.3065 --- loss: 1.765162, loss_ss: 1.196854, loss_d: 0.568308
0.3448 --- loss: 1.902858, loss_ss: 1.464229, loss_d: 0.438629
0.3831 --- loss: 1.895708, loss_ss: 1.341169, loss_d: 0.554539
0.4215 --- loss: 1.812690, loss_ss: 1.434617, loss_d: 0.378073
0.4598 --- loss: 1.852107, loss_ss: 1.350696, loss_d: 0.501411
0.4981 --- loss: 1.991703, loss_ss: 1.338763, loss_d: 0.652940
0.5364 --- loss: 2.003561, loss_ss: 1.241098, loss_d: 0.762463
0.5747 --- loss: 1.913549, loss_ss: 1.409985, loss_d: 0.503564
0.6130 --- loss: 1.906065, loss_ss: 1.306919, loss_d: 0.599146
0.6513 --- loss: 1.777324, loss_ss: 1.377944, loss_d: 0.399380
0.6897 --- loss: 1.575314, loss_ss: 1.095300, loss_d: 0.480015
0.7280 --- loss: 1.724077, loss_ss: 1.276339, loss_d: 0.447738
0.7663 --- loss: 1.679290, loss_ss: 1.234991, loss_d: 0.444298
0.8046 --- loss: 2.110591, loss_ss: 1.375424, loss_d: 0.735166
0.8429 --- loss: 1.554253, loss_ss: 1.241210, loss_d: 0.313043
0.8812 --- loss: 1.987988, loss_ss: 1.484390, loss_d: 0.503598
0.9195 --- loss: 1.769034, loss_ss: 1.291240, loss_d: 0.477795
0.9579 --- loss: 1.840464, loss_ss: 1.213390, loss_d: 0.627074
0.9962 --- loss: 1.918523, loss_ss: 1.322826, loss_d: 0.595697
Epoch finished! Loss: 1.8564896455177895
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.998142, loss_ss: 1.346448, loss_d: 0.651694
0.0383 --- loss: 1.707309, loss_ss: 1.270122, loss_d: 0.437187
0.0766 --- loss: 1.841068, loss_ss: 1.403956, loss_d: 0.437112
0.1149 --- loss: 1.754024, loss_ss: 1.198088, loss_d: 0.555936
0.1533 --- loss: 1.715769, loss_ss: 1.184737, loss_d: 0.531032
0.1916 --- loss: 1.573683, loss_ss: 1.195555, loss_d: 0.378128
0.2299 --- loss: 1.483208, loss_ss: 1.230704, loss_d: 0.252504
0.2682 --- loss: 2.054213, loss_ss: 1.250775, loss_d: 0.803438
0.3065 --- loss: 1.955367, loss_ss: 1.489234, loss_d: 0.466132
0.3448 --- loss: 1.499128, loss_ss: 1.071570, loss_d: 0.427558
0.3831 --- loss: 1.870433, loss_ss: 1.269897, loss_d: 0.600536
0.4215 --- loss: 1.604323, loss_ss: 1.205724, loss_d: 0.398600
0.4598 --- loss: 1.863620, loss_ss: 1.236822, loss_d: 0.626798
0.4981 --- loss: 1.544366, loss_ss: 1.151181, loss_d: 0.393185
0.5364 --- loss: 1.696690, loss_ss: 1.298217, loss_d: 0.398473
0.5747 --- loss: 1.584019, loss_ss: 1.134195, loss_d: 0.449823
0.6130 --- loss: 1.705456, loss_ss: 1.436824, loss_d: 0.268631
0.6513 --- loss: 1.455986, loss_ss: 1.170712, loss_d: 0.285274
0.6897 --- loss: 1.688761, loss_ss: 1.033465, loss_d: 0.655297
0.7280 --- loss: 1.985850, loss_ss: 1.206319, loss_d: 0.779531
0.7663 --- loss: 1.791803, loss_ss: 1.189319, loss_d: 0.602483
0.8046 --- loss: 1.502575, loss_ss: 1.054938, loss_d: 0.447638
0.8429 --- loss: 1.721859, loss_ss: 1.265905, loss_d: 0.455954
0.8812 --- loss: 1.775799, loss_ss: 1.189769, loss_d: 0.586030
0.9195 --- loss: 1.462760, loss_ss: 1.179011, loss_d: 0.283749
0.9579 --- loss: 1.609450, loss_ss: 1.192941, loss_d: 0.416509
0.9962 --- loss: 1.747308, loss_ss: 1.263830, loss_d: 0.483478
Epoch finished! Loss: 1.7369430629106668
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.009448, loss_ss: 1.326192, loss_d: 0.683255
0.0383 --- loss: 1.601358, loss_ss: 1.128970, loss_d: 0.472388
0.0766 --- loss: 1.648702, loss_ss: 1.016093, loss_d: 0.632610
0.1149 --- loss: 1.564291, loss_ss: 1.058484, loss_d: 0.505807
0.1533 --- loss: 1.464045, loss_ss: 1.120025, loss_d: 0.344021
0.1916 --- loss: 1.685499, loss_ss: 1.314075, loss_d: 0.371423
0.2299 --- loss: 1.479838, loss_ss: 1.264367, loss_d: 0.215471
0.2682 --- loss: 1.771836, loss_ss: 1.306556, loss_d: 0.465279
0.3065 --- loss: 1.356786, loss_ss: 0.996334, loss_d: 0.360452
0.3448 --- loss: 1.594949, loss_ss: 1.188676, loss_d: 0.406273
0.3831 --- loss: 2.285489, loss_ss: 1.107569, loss_d: 1.177921
0.4215 --- loss: 1.468851, loss_ss: 1.157572, loss_d: 0.311279
0.4598 --- loss: 2.298131, loss_ss: 1.273261, loss_d: 1.024870
0.4981 --- loss: 1.827184, loss_ss: 1.274629, loss_d: 0.552555
0.5364 --- loss: 1.540485, loss_ss: 1.104959, loss_d: 0.435526
0.5747 --- loss: 1.475666, loss_ss: 1.218011, loss_d: 0.257655
0.6130 --- loss: 1.508529, loss_ss: 1.057262, loss_d: 0.451266
0.6513 --- loss: 1.714954, loss_ss: 1.154974, loss_d: 0.559980
0.6897 --- loss: 1.848727, loss_ss: 1.298111, loss_d: 0.550617
0.7280 --- loss: 1.836569, loss_ss: 1.241362, loss_d: 0.595206
0.7663 --- loss: 1.824443, loss_ss: 1.385141, loss_d: 0.439303
0.8046 --- loss: 1.599233, loss_ss: 1.237690, loss_d: 0.361543
0.8429 --- loss: 1.679299, loss_ss: 1.126796, loss_d: 0.552503
0.8812 --- loss: 1.717969, loss_ss: 1.147847, loss_d: 0.570122
0.9195 --- loss: 1.751442, loss_ss: 0.980851, loss_d: 0.770591
0.9579 --- loss: 1.690377, loss_ss: 1.268117, loss_d: 0.422260
0.9962 --- loss: 1.386075, loss_ss: 1.008152, loss_d: 0.377922
Epoch finished! Loss: 1.6774486284989578
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.461483, loss_ss: 1.131491, loss_d: 0.329992
0.0383 --- loss: 1.847947, loss_ss: 1.174150, loss_d: 0.673796
0.0766 --- loss: 1.760607, loss_ss: 1.349347, loss_d: 0.411260
0.1149 --- loss: 1.712757, loss_ss: 1.194459, loss_d: 0.518298
0.1533 --- loss: 1.504622, loss_ss: 1.034875, loss_d: 0.469748
0.1916 --- loss: 1.247613, loss_ss: 0.868164, loss_d: 0.379449
0.2299 --- loss: 1.607931, loss_ss: 1.093451, loss_d: 0.514479
0.2682 --- loss: 1.269808, loss_ss: 1.074161, loss_d: 0.195647
0.3065 --- loss: 1.584307, loss_ss: 0.970657, loss_d: 0.613650
0.3448 --- loss: 1.629106, loss_ss: 1.217259, loss_d: 0.411847
0.3831 --- loss: 1.897774, loss_ss: 1.363567, loss_d: 0.534206
0.4215 --- loss: 1.456538, loss_ss: 0.999804, loss_d: 0.456734
0.4598 --- loss: 1.405960, loss_ss: 1.077075, loss_d: 0.328885
0.4981 --- loss: 1.421399, loss_ss: 1.000335, loss_d: 0.421064
0.5364 --- loss: 1.384599, loss_ss: 1.046224, loss_d: 0.338375
0.5747 --- loss: 1.992207, loss_ss: 1.451760, loss_d: 0.540447
0.6130 --- loss: 1.421878, loss_ss: 0.985949, loss_d: 0.435929
0.6513 --- loss: 1.769440, loss_ss: 1.036517, loss_d: 0.732923
0.6897 --- loss: 1.958324, loss_ss: 1.548717, loss_d: 0.409607
0.7280 --- loss: 1.802731, loss_ss: 1.407850, loss_d: 0.394881
0.7663 --- loss: 1.718171, loss_ss: 1.362290, loss_d: 0.355882
0.8046 --- loss: 1.529493, loss_ss: 1.147263, loss_d: 0.382230
0.8429 --- loss: 1.408756, loss_ss: 0.945708, loss_d: 0.463048
0.8812 --- loss: 1.533967, loss_ss: 0.978314, loss_d: 0.555652
0.9195 --- loss: 2.054995, loss_ss: 1.678470, loss_d: 0.376525
0.9579 --- loss: 1.389247, loss_ss: 0.999190, loss_d: 0.390057
0.9962 --- loss: 1.526550, loss_ss: 1.012397, loss_d: 0.514153
Epoch finished! Loss: 1.6511515250572792
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.421452, loss_ss: 1.087471, loss_d: 0.333981
0.0383 --- loss: 1.880130, loss_ss: 1.141432, loss_d: 0.738699
0.0766 --- loss: 2.053010, loss_ss: 1.213447, loss_d: 0.839563
0.1149 --- loss: 1.689489, loss_ss: 1.065704, loss_d: 0.623785
0.1533 --- loss: 1.977139, loss_ss: 1.418924, loss_d: 0.558215
0.1916 --- loss: 1.642528, loss_ss: 1.293008, loss_d: 0.349520
0.2299 --- loss: 1.497759, loss_ss: 0.970742, loss_d: 0.527017
0.2682 --- loss: 2.016396, loss_ss: 1.472838, loss_d: 0.543558
0.3065 --- loss: 2.088144, loss_ss: 1.709915, loss_d: 0.378229
0.3448 --- loss: 1.639036, loss_ss: 1.005229, loss_d: 0.633807
0.3831 --- loss: 1.433998, loss_ss: 1.154001, loss_d: 0.279996
0.4215 --- loss: 1.410602, loss_ss: 0.977466, loss_d: 0.433136
0.4598 --- loss: 1.821399, loss_ss: 1.417138, loss_d: 0.404261
0.4981 --- loss: 1.429792, loss_ss: 1.145115, loss_d: 0.284677
0.5364 --- loss: 1.752612, loss_ss: 0.949478, loss_d: 0.803134
0.5747 --- loss: 1.487463, loss_ss: 1.115382, loss_d: 0.372081
0.6130 --- loss: 1.400055, loss_ss: 1.003213, loss_d: 0.396843
0.6513 --- loss: 1.507401, loss_ss: 1.248021, loss_d: 0.259379
0.6897 --- loss: 1.529526, loss_ss: 1.255779, loss_d: 0.273747
0.7280 --- loss: 1.359497, loss_ss: 0.980645, loss_d: 0.378853
0.7663 --- loss: 1.448441, loss_ss: 1.138537, loss_d: 0.309904
0.8046 --- loss: 1.107307, loss_ss: 0.786162, loss_d: 0.321144
0.8429 --- loss: 1.339942, loss_ss: 0.892751, loss_d: 0.447192
0.8812 --- loss: 1.382181, loss_ss: 1.088160, loss_d: 0.294021
0.9195 --- loss: 1.893647, loss_ss: 1.131539, loss_d: 0.762107
0.9579 --- loss: 1.677488, loss_ss: 1.234969, loss_d: 0.442519
0.9962 --- loss: 1.710011, loss_ss: 0.853530, loss_d: 0.856481
Epoch finished! Loss: 1.59286057811517
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.657150, loss_ss: 1.398997, loss_d: 0.258153
0.0383 --- loss: 1.259769, loss_ss: 0.813105, loss_d: 0.446664
0.0766 --- loss: 1.783044, loss_ss: 1.106460, loss_d: 0.676584
0.1149 --- loss: 1.512487, loss_ss: 1.112653, loss_d: 0.399834
0.1533 --- loss: 1.356101, loss_ss: 1.053963, loss_d: 0.302138
0.1916 --- loss: 1.463934, loss_ss: 1.181199, loss_d: 0.282735
0.2299 --- loss: 1.459974, loss_ss: 1.243161, loss_d: 0.216813
0.2682 --- loss: 1.756758, loss_ss: 1.169982, loss_d: 0.586777
0.3065 --- loss: 1.217878, loss_ss: 0.914366, loss_d: 0.303511
0.3448 --- loss: 1.430417, loss_ss: 1.142022, loss_d: 0.288395
0.3831 --- loss: 1.504324, loss_ss: 1.120233, loss_d: 0.384091
0.4215 --- loss: 1.326867, loss_ss: 0.971042, loss_d: 0.355825
0.4598 --- loss: 1.602502, loss_ss: 1.269229, loss_d: 0.333273
0.4981 --- loss: 2.035714, loss_ss: 0.900500, loss_d: 1.135214
0.5364 --- loss: 1.230100, loss_ss: 0.936118, loss_d: 0.293981
0.5747 --- loss: 1.227876, loss_ss: 0.882657, loss_d: 0.345219
0.6130 --- loss: 1.613707, loss_ss: 1.220320, loss_d: 0.393387
0.6513 --- loss: 1.542472, loss_ss: 1.241936, loss_d: 0.300536
0.6897 --- loss: 1.296484, loss_ss: 0.979542, loss_d: 0.316941
0.7280 --- loss: 1.397828, loss_ss: 1.044666, loss_d: 0.353162
0.7663 --- loss: 1.289706, loss_ss: 1.069832, loss_d: 0.219873
0.8046 --- loss: 2.354414, loss_ss: 1.309176, loss_d: 1.045239
0.8429 --- loss: 1.365178, loss_ss: 1.141597, loss_d: 0.223581
0.8812 --- loss: 1.485716, loss_ss: 1.198246, loss_d: 0.287470
0.9195 --- loss: 1.525098, loss_ss: 1.047539, loss_d: 0.477560
0.9579 --- loss: 1.249333, loss_ss: 1.007107, loss_d: 0.242226
0.9962 --- loss: 1.184617, loss_ss: 0.826557, loss_d: 0.358060
Epoch finished! Loss: 1.54857688500331
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.380954, loss_ss: 1.139162, loss_d: 0.241792
0.0383 --- loss: 1.738807, loss_ss: 0.902145, loss_d: 0.836662
0.0766 --- loss: 1.463786, loss_ss: 1.082158, loss_d: 0.381628
0.1149 --- loss: 1.775664, loss_ss: 1.134748, loss_d: 0.640916
0.1533 --- loss: 1.358909, loss_ss: 1.065923, loss_d: 0.292985
0.1916 --- loss: 1.857298, loss_ss: 1.173247, loss_d: 0.684050
0.2299 --- loss: 1.541152, loss_ss: 1.082931, loss_d: 0.458221
0.2682 --- loss: 1.730717, loss_ss: 1.456973, loss_d: 0.273744
0.3065 --- loss: 1.768975, loss_ss: 1.484864, loss_d: 0.284111
0.3448 --- loss: 2.059870, loss_ss: 1.017175, loss_d: 1.042695
0.3831 --- loss: 1.281618, loss_ss: 1.060525, loss_d: 0.221094
0.4215 --- loss: 1.572031, loss_ss: 1.000353, loss_d: 0.571678
0.4598 --- loss: 1.778970, loss_ss: 1.343958, loss_d: 0.435013
0.4981 --- loss: 1.388489, loss_ss: 1.000360, loss_d: 0.388130
0.5364 --- loss: 1.762853, loss_ss: 1.261450, loss_d: 0.501403
0.5747 --- loss: 1.182235, loss_ss: 0.987657, loss_d: 0.194578
0.6130 --- loss: 1.522423, loss_ss: 1.141424, loss_d: 0.380998
0.6513 --- loss: 1.173252, loss_ss: 0.935081, loss_d: 0.238172
0.6897 --- loss: 1.172913, loss_ss: 0.817217, loss_d: 0.355696
0.7280 --- loss: 1.352997, loss_ss: 0.913614, loss_d: 0.439384
0.7663 --- loss: 1.635989, loss_ss: 0.889481, loss_d: 0.746508
0.8046 --- loss: 1.313723, loss_ss: 1.013303, loss_d: 0.300419
0.8429 --- loss: 1.672112, loss_ss: 1.109051, loss_d: 0.563061
0.8812 --- loss: 1.322438, loss_ss: 0.929780, loss_d: 0.392658
0.9195 --- loss: 1.564714, loss_ss: 0.860347, loss_d: 0.704367
0.9579 --- loss: 1.643964, loss_ss: 0.952564, loss_d: 0.691400
0.9962 --- loss: 1.696667, loss_ss: 1.124598, loss_d: 0.572070
Epoch finished! Loss: 1.5477819103461046
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.454955, loss_ss: 0.871302, loss_d: 0.583653
0.0383 --- loss: 1.376936, loss_ss: 1.068099, loss_d: 0.308837
0.0766 --- loss: 1.676611, loss_ss: 1.235662, loss_d: 0.440949
0.1149 --- loss: 1.790634, loss_ss: 1.380214, loss_d: 0.410420
0.1533 --- loss: 1.193083, loss_ss: 0.935476, loss_d: 0.257607
0.1916 --- loss: 1.533011, loss_ss: 1.200925, loss_d: 0.332086
0.2299 --- loss: 1.828676, loss_ss: 1.158487, loss_d: 0.670189
0.2682 --- loss: 1.692982, loss_ss: 1.272026, loss_d: 0.420956
0.3065 --- loss: 1.852721, loss_ss: 1.309781, loss_d: 0.542940
0.3448 --- loss: 1.688546, loss_ss: 1.240704, loss_d: 0.447842
0.3831 --- loss: 1.488592, loss_ss: 1.145478, loss_d: 0.343114
0.4215 --- loss: 1.411400, loss_ss: 1.111377, loss_d: 0.300023
0.4598 --- loss: 1.967514, loss_ss: 1.464736, loss_d: 0.502778
0.4981 --- loss: 1.443845, loss_ss: 1.100548, loss_d: 0.343297
0.5364 --- loss: 1.760523, loss_ss: 1.376475, loss_d: 0.384047
0.5747 --- loss: 1.324391, loss_ss: 0.931647, loss_d: 0.392745
0.6130 --- loss: 1.522711, loss_ss: 1.171217, loss_d: 0.351494
0.6513 --- loss: 1.592926, loss_ss: 1.242804, loss_d: 0.350122
0.6897 --- loss: 1.709070, loss_ss: 1.279657, loss_d: 0.429413
0.7280 --- loss: 1.360291, loss_ss: 1.081547, loss_d: 0.278744
0.7663 --- loss: 1.236061, loss_ss: 0.921979, loss_d: 0.314082
0.8046 --- loss: 1.837920, loss_ss: 0.954700, loss_d: 0.883221
0.8429 --- loss: 1.451471, loss_ss: 1.159589, loss_d: 0.291882
0.8812 --- loss: 1.768486, loss_ss: 1.089308, loss_d: 0.679178
0.9195 --- loss: 1.911326, loss_ss: 1.202253, loss_d: 0.709074
0.9579 --- loss: 1.796585, loss_ss: 1.320930, loss_d: 0.475655
0.9962 --- loss: 1.431782, loss_ss: 1.042089, loss_d: 0.389693
Epoch finished! Loss: 1.5243975637050775
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.662084, loss_ss: 1.220270, loss_d: 0.441814
0.0383 --- loss: 1.327749, loss_ss: 1.051202, loss_d: 0.276547
0.0766 --- loss: 1.440718, loss_ss: 1.047638, loss_d: 0.393079
0.1149 --- loss: 1.866427, loss_ss: 1.281607, loss_d: 0.584821
0.1533 --- loss: 1.047262, loss_ss: 0.800173, loss_d: 0.247089
0.1916 --- loss: 1.540783, loss_ss: 1.099870, loss_d: 0.440913
0.2299 --- loss: 1.752398, loss_ss: 1.090192, loss_d: 0.662206
0.2682 --- loss: 1.529602, loss_ss: 1.186536, loss_d: 0.343065
0.3065 --- loss: 1.762348, loss_ss: 1.265821, loss_d: 0.496527
0.3448 --- loss: 1.327085, loss_ss: 1.003080, loss_d: 0.324004
0.3831 --- loss: 1.504923, loss_ss: 1.041730, loss_d: 0.463193
0.4215 --- loss: 1.580424, loss_ss: 1.025463, loss_d: 0.554961
0.4598 --- loss: 1.288616, loss_ss: 0.968194, loss_d: 0.320422
0.4981 --- loss: 1.228187, loss_ss: 0.872811, loss_d: 0.355376
0.5364 --- loss: 2.089580, loss_ss: 1.365757, loss_d: 0.723823
0.5747 --- loss: 1.628052, loss_ss: 1.113265, loss_d: 0.514788
0.6130 --- loss: 1.807090, loss_ss: 1.467764, loss_d: 0.339326
0.6513 --- loss: 1.321344, loss_ss: 0.977372, loss_d: 0.343972
0.6897 --- loss: 1.824236, loss_ss: 1.315843, loss_d: 0.508393
0.7280 --- loss: 1.336698, loss_ss: 1.076776, loss_d: 0.259923
0.7663 --- loss: 1.108826, loss_ss: 0.865693, loss_d: 0.243133
0.8046 --- loss: 1.474377, loss_ss: 1.190082, loss_d: 0.284295
0.8429 --- loss: 1.471584, loss_ss: 0.858763, loss_d: 0.612822
0.8812 --- loss: 1.591724, loss_ss: 1.033913, loss_d: 0.557811
0.9195 --- loss: 1.603916, loss_ss: 1.218241, loss_d: 0.385675
0.9579 --- loss: 1.365082, loss_ss: 1.004589, loss_d: 0.360493
0.9962 --- loss: 1.421298, loss_ss: 1.125423, loss_d: 0.295875
Epoch finished! Loss: 1.563958865404129
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.42857142857142855
             precision    recall  f1-score   support

        0.0       0.43      0.43      0.43        56
        1.0       0.00      0.00      0.00        38
        2.0       0.54      0.20      0.30       416
        3.0       0.98      0.60      0.75       188
        4.0       0.27      0.97      0.42       142

avg / total       0.56      0.43      0.41       840
 


====== chc041-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  92.38  42.86   95.92  42.86     42.86
1  95.48   0.00  100.00   0.00      0.00
2  51.90  20.43   82.78  53.80     29.62
3  90.83  60.11   99.69  98.26     74.59
4  55.12  97.18   46.56  27.01     42.27
Total accuracy: 42.86%
Average sen: 44.12%
Average spec: 84.99%
Macro f1-score: 37.87%
[0.98818737 0.98472321 0.96484983 0.99001348 0.9691813  0.96375096
 0.96497136 0.96077132 0.96087301 0.97635287 0.95818555 0.96334946
 0.9592585  0.95972186 0.96114945 0.96324003 0.98061931 0.95907897
 0.95909166 0.96646523 0.98844868 0.9743703  0.96247405 0.96645141
 0.957901   0.95945489 0.9610616  0.95857972]
pred: 0.9672348712171827, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.356120, loss_ss: 1.651550, loss_d: 0.704570
0.0383 --- loss: 2.096945, loss_ss: 1.467721, loss_d: 0.629224
0.0767 --- loss: 2.096353, loss_ss: 1.522240, loss_d: 0.574113
0.1150 --- loss: 2.367311, loss_ss: 1.616786, loss_d: 0.750525
0.1534 --- loss: 1.823893, loss_ss: 1.498673, loss_d: 0.325221
0.1917 --- loss: 2.165800, loss_ss: 1.738062, loss_d: 0.427738
0.2301 --- loss: 1.868940, loss_ss: 1.462442, loss_d: 0.406498
0.2684 --- loss: 2.196932, loss_ss: 1.617051, loss_d: 0.579881
0.3067 --- loss: 2.469124, loss_ss: 1.820219, loss_d: 0.648905
0.3451 --- loss: 1.884742, loss_ss: 1.303324, loss_d: 0.581417
0.3834 --- loss: 1.819443, loss_ss: 1.428035, loss_d: 0.391409
0.4218 --- loss: 1.773906, loss_ss: 1.457445, loss_d: 0.316461
0.4601 --- loss: 2.005286, loss_ss: 1.396426, loss_d: 0.608860
0.4985 --- loss: 1.823421, loss_ss: 1.485469, loss_d: 0.337952
0.5368 --- loss: 1.965836, loss_ss: 1.566874, loss_d: 0.398962
0.5752 --- loss: 1.846785, loss_ss: 1.252607, loss_d: 0.594178
0.6135 --- loss: 1.984960, loss_ss: 1.440388, loss_d: 0.544572
0.6518 --- loss: 2.258521, loss_ss: 1.603855, loss_d: 0.654666
0.6902 --- loss: 2.037781, loss_ss: 1.612420, loss_d: 0.425361
0.7285 --- loss: 2.135634, loss_ss: 1.701270, loss_d: 0.434364
0.7669 --- loss: 1.855413, loss_ss: 1.494862, loss_d: 0.360552
0.8052 --- loss: 2.002143, loss_ss: 1.609471, loss_d: 0.392673
0.8436 --- loss: 1.985990, loss_ss: 1.369090, loss_d: 0.616900
0.8819 --- loss: 2.078436, loss_ss: 1.615892, loss_d: 0.462543
0.9202 --- loss: 2.639366, loss_ss: 1.527882, loss_d: 1.111484
0.9586 --- loss: 2.052585, loss_ss: 1.444463, loss_d: 0.608123
0.9969 --- loss: 2.149560, loss_ss: 1.468936, loss_d: 0.680624
Epoch finished! Loss: 2.0605115537460033
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.958516, loss_ss: 1.503219, loss_d: 0.455298
0.0383 --- loss: 2.217201, loss_ss: 1.674248, loss_d: 0.542953
0.0767 --- loss: 1.978107, loss_ss: 1.372082, loss_d: 0.606025
0.1150 --- loss: 2.033098, loss_ss: 1.544238, loss_d: 0.488860
0.1534 --- loss: 2.162804, loss_ss: 1.571634, loss_d: 0.591170
0.1917 --- loss: 1.988464, loss_ss: 1.421925, loss_d: 0.566539
0.2301 --- loss: 1.691156, loss_ss: 1.362816, loss_d: 0.328340
0.2684 --- loss: 1.868960, loss_ss: 1.576014, loss_d: 0.292946
0.3067 --- loss: 1.768946, loss_ss: 1.434685, loss_d: 0.334261
0.3451 --- loss: 1.822699, loss_ss: 1.443207, loss_d: 0.379492
0.3834 --- loss: 1.861107, loss_ss: 1.419578, loss_d: 0.441529
0.4218 --- loss: 2.061161, loss_ss: 1.550255, loss_d: 0.510906
0.4601 --- loss: 2.017759, loss_ss: 1.479798, loss_d: 0.537960
0.4985 --- loss: 1.919491, loss_ss: 1.392281, loss_d: 0.527210
0.5368 --- loss: 1.883126, loss_ss: 1.320843, loss_d: 0.562283
0.5752 --- loss: 1.931059, loss_ss: 1.452057, loss_d: 0.479002
0.6135 --- loss: 2.070970, loss_ss: 1.410442, loss_d: 0.660528
0.6518 --- loss: 2.002829, loss_ss: 1.451457, loss_d: 0.551372
0.6902 --- loss: 2.242751, loss_ss: 1.550582, loss_d: 0.692169
0.7285 --- loss: 1.765183, loss_ss: 1.378011, loss_d: 0.387172
0.7669 --- loss: 2.018381, loss_ss: 1.549149, loss_d: 0.469232
0.8052 --- loss: 2.577062, loss_ss: 1.627015, loss_d: 0.950047
0.8436 --- loss: 1.844974, loss_ss: 1.515036, loss_d: 0.329938
0.8819 --- loss: 2.125877, loss_ss: 1.502330, loss_d: 0.623548
0.9202 --- loss: 1.851700, loss_ss: 1.501784, loss_d: 0.349915
0.9586 --- loss: 1.843106, loss_ss: 1.335505, loss_d: 0.507600
0.9969 --- loss: 1.777611, loss_ss: 1.345431, loss_d: 0.432180
Epoch finished! Loss: 1.9779759370363676
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.661160, loss_ss: 1.230829, loss_d: 0.430332
0.0383 --- loss: 1.845009, loss_ss: 1.480246, loss_d: 0.364763
0.0767 --- loss: 2.021117, loss_ss: 1.441649, loss_d: 0.579468
0.1150 --- loss: 1.875248, loss_ss: 1.495142, loss_d: 0.380106
0.1534 --- loss: 2.065113, loss_ss: 1.583116, loss_d: 0.481996
0.1917 --- loss: 1.888198, loss_ss: 1.329561, loss_d: 0.558636
0.2301 --- loss: 1.858078, loss_ss: 1.501559, loss_d: 0.356519
0.2684 --- loss: 1.718460, loss_ss: 1.421167, loss_d: 0.297293
0.3067 --- loss: 2.150464, loss_ss: 1.381730, loss_d: 0.768734
0.3451 --- loss: 1.806561, loss_ss: 1.355716, loss_d: 0.450845
0.3834 --- loss: 1.808885, loss_ss: 1.456746, loss_d: 0.352139
0.4218 --- loss: 1.838641, loss_ss: 1.511132, loss_d: 0.327510
0.4601 --- loss: 2.172213, loss_ss: 1.467781, loss_d: 0.704431
0.4985 --- loss: 1.707325, loss_ss: 1.246726, loss_d: 0.460599
0.5368 --- loss: 2.248223, loss_ss: 1.259103, loss_d: 0.989120
0.5752 --- loss: 1.796717, loss_ss: 1.407335, loss_d: 0.389383
0.6135 --- loss: 1.762368, loss_ss: 1.383836, loss_d: 0.378531
0.6518 --- loss: 1.941939, loss_ss: 1.458865, loss_d: 0.483075
0.6902 --- loss: 2.027135, loss_ss: 1.373195, loss_d: 0.653940
0.7285 --- loss: 1.954733, loss_ss: 1.389465, loss_d: 0.565268
0.7669 --- loss: 1.720130, loss_ss: 1.248984, loss_d: 0.471146
0.8052 --- loss: 1.821210, loss_ss: 1.245583, loss_d: 0.575627
0.8436 --- loss: 2.341431, loss_ss: 1.561715, loss_d: 0.779716
0.8819 --- loss: 2.021085, loss_ss: 1.644422, loss_d: 0.376662
0.9202 --- loss: 1.823004, loss_ss: 1.236385, loss_d: 0.586619
0.9586 --- loss: 2.070324, loss_ss: 1.446819, loss_d: 0.623505
0.9969 --- loss: 1.966738, loss_ss: 1.339232, loss_d: 0.627506
Epoch finished! Loss: 1.9013700031317198
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.359714, loss_ss: 1.532951, loss_d: 0.826763
0.0383 --- loss: 2.016402, loss_ss: 1.676137, loss_d: 0.340265
0.0767 --- loss: 1.855163, loss_ss: 1.383442, loss_d: 0.471721
0.1150 --- loss: 1.669834, loss_ss: 1.255262, loss_d: 0.414571
0.1534 --- loss: 1.797851, loss_ss: 1.457039, loss_d: 0.340813
0.1917 --- loss: 1.748020, loss_ss: 1.368336, loss_d: 0.379684
0.2301 --- loss: 1.825338, loss_ss: 1.541306, loss_d: 0.284032
0.2684 --- loss: 1.523748, loss_ss: 1.202641, loss_d: 0.321107
0.3067 --- loss: 1.724562, loss_ss: 1.272127, loss_d: 0.452435
0.3451 --- loss: 1.758009, loss_ss: 1.262887, loss_d: 0.495122
0.3834 --- loss: 1.920810, loss_ss: 1.168233, loss_d: 0.752577
0.4218 --- loss: 1.775489, loss_ss: 1.231854, loss_d: 0.543635
0.4601 --- loss: 1.951465, loss_ss: 1.435935, loss_d: 0.515530
0.4985 --- loss: 2.168710, loss_ss: 1.250868, loss_d: 0.917842
0.5368 --- loss: 1.652286, loss_ss: 1.315608, loss_d: 0.336678
0.5752 --- loss: 1.771538, loss_ss: 1.299960, loss_d: 0.471577
0.6135 --- loss: 2.048274, loss_ss: 1.264680, loss_d: 0.783593
0.6518 --- loss: 1.755360, loss_ss: 1.343063, loss_d: 0.412297
0.6902 --- loss: 1.790513, loss_ss: 1.085660, loss_d: 0.704853
0.7285 --- loss: 1.753942, loss_ss: 1.316512, loss_d: 0.437430
0.7669 --- loss: 1.827632, loss_ss: 1.348104, loss_d: 0.479528
0.8052 --- loss: 1.947968, loss_ss: 1.433100, loss_d: 0.514868
0.8436 --- loss: 1.508357, loss_ss: 1.219209, loss_d: 0.289148
0.8819 --- loss: 1.681848, loss_ss: 1.235505, loss_d: 0.446343
0.9202 --- loss: 1.688712, loss_ss: 1.203295, loss_d: 0.485416
0.9586 --- loss: 1.719028, loss_ss: 1.229672, loss_d: 0.489355
0.9969 --- loss: 1.867102, loss_ss: 1.066608, loss_d: 0.800494
Epoch finished! Loss: 1.8137930196065168
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.586335, loss_ss: 1.286256, loss_d: 0.300079
0.0383 --- loss: 1.570801, loss_ss: 1.065489, loss_d: 0.505312
0.0767 --- loss: 1.610149, loss_ss: 1.072719, loss_d: 0.537429
0.1150 --- loss: 1.612304, loss_ss: 1.090241, loss_d: 0.522064
0.1534 --- loss: 1.845228, loss_ss: 1.129618, loss_d: 0.715611
0.1917 --- loss: 1.642530, loss_ss: 1.198804, loss_d: 0.443726
0.2301 --- loss: 1.797493, loss_ss: 1.411962, loss_d: 0.385531
0.2684 --- loss: 1.902295, loss_ss: 1.229266, loss_d: 0.673029
0.3067 --- loss: 1.440579, loss_ss: 1.167941, loss_d: 0.272637
0.3451 --- loss: 1.693136, loss_ss: 1.212131, loss_d: 0.481005
0.3834 --- loss: 1.957278, loss_ss: 1.614031, loss_d: 0.343247
0.4218 --- loss: 1.847678, loss_ss: 1.139726, loss_d: 0.707952
0.4601 --- loss: 1.668428, loss_ss: 1.189239, loss_d: 0.479189
0.4985 --- loss: 1.647288, loss_ss: 1.184938, loss_d: 0.462350
0.5368 --- loss: 1.609897, loss_ss: 1.095697, loss_d: 0.514201
0.5752 --- loss: 1.660777, loss_ss: 1.139545, loss_d: 0.521233
0.6135 --- loss: 1.639893, loss_ss: 1.322325, loss_d: 0.317568
0.6518 --- loss: 1.301389, loss_ss: 1.006152, loss_d: 0.295237
0.6902 --- loss: 1.731355, loss_ss: 1.359463, loss_d: 0.371892
0.7285 --- loss: 2.218389, loss_ss: 1.169027, loss_d: 1.049361
0.7669 --- loss: 1.810293, loss_ss: 1.496396, loss_d: 0.313897
0.8052 --- loss: 1.790313, loss_ss: 1.248577, loss_d: 0.541736
0.8436 --- loss: 1.450320, loss_ss: 1.159073, loss_d: 0.291247
0.8819 --- loss: 1.678517, loss_ss: 1.071293, loss_d: 0.607224
0.9202 --- loss: 1.822252, loss_ss: 1.051011, loss_d: 0.771241
0.9586 --- loss: 1.908405, loss_ss: 1.544061, loss_d: 0.364344
0.9969 --- loss: 1.666418, loss_ss: 1.206406, loss_d: 0.460012
Epoch finished! Loss: 1.70463426892574
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.229074, loss_ss: 0.871778, loss_d: 0.357296
0.0383 --- loss: 1.682843, loss_ss: 1.200062, loss_d: 0.482781
0.0767 --- loss: 1.523214, loss_ss: 1.157758, loss_d: 0.365456
0.1150 --- loss: 1.424869, loss_ss: 1.092045, loss_d: 0.332824
0.1534 --- loss: 1.240157, loss_ss: 0.921502, loss_d: 0.318654
0.1917 --- loss: 1.593279, loss_ss: 1.187988, loss_d: 0.405291
0.2301 --- loss: 1.642721, loss_ss: 1.220064, loss_d: 0.422657
0.2684 --- loss: 1.245331, loss_ss: 0.984820, loss_d: 0.260511
0.3067 --- loss: 1.452400, loss_ss: 1.123560, loss_d: 0.328840
0.3451 --- loss: 2.099836, loss_ss: 1.526844, loss_d: 0.572992
0.3834 --- loss: 1.800405, loss_ss: 1.283544, loss_d: 0.516861
0.4218 --- loss: 1.832954, loss_ss: 1.420053, loss_d: 0.412901
0.4601 --- loss: 1.732823, loss_ss: 1.256533, loss_d: 0.476289
0.4985 --- loss: 1.787808, loss_ss: 1.263759, loss_d: 0.524049
0.5368 --- loss: 1.810287, loss_ss: 1.175658, loss_d: 0.634629
0.5752 --- loss: 1.793032, loss_ss: 1.428151, loss_d: 0.364880
0.6135 --- loss: 1.431417, loss_ss: 1.049804, loss_d: 0.381613
0.6518 --- loss: 1.763860, loss_ss: 1.422698, loss_d: 0.341162
0.6902 --- loss: 1.560330, loss_ss: 1.204801, loss_d: 0.355529
0.7285 --- loss: 1.787534, loss_ss: 1.255103, loss_d: 0.532430
0.7669 --- loss: 1.900961, loss_ss: 1.561990, loss_d: 0.338971
0.8052 --- loss: 1.529146, loss_ss: 1.050861, loss_d: 0.478285
0.8436 --- loss: 1.763671, loss_ss: 1.333436, loss_d: 0.430236
0.8819 --- loss: 1.419219, loss_ss: 1.037913, loss_d: 0.381306
0.9202 --- loss: 1.427925, loss_ss: 1.025496, loss_d: 0.402429
0.9586 --- loss: 1.478636, loss_ss: 1.077770, loss_d: 0.400866
0.9969 --- loss: 1.850569, loss_ss: 1.380269, loss_d: 0.470300
Epoch finished! Loss: 1.6229796065733983
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.680976, loss_ss: 1.411530, loss_d: 0.269446
0.0383 --- loss: 1.691427, loss_ss: 1.379241, loss_d: 0.312186
0.0767 --- loss: 1.515334, loss_ss: 1.183438, loss_d: 0.331897
0.1150 --- loss: 1.483185, loss_ss: 1.215266, loss_d: 0.267919
0.1534 --- loss: 1.145570, loss_ss: 0.812219, loss_d: 0.333350
0.1917 --- loss: 1.737099, loss_ss: 1.419942, loss_d: 0.317157
0.2301 --- loss: 1.607735, loss_ss: 1.139941, loss_d: 0.467794
0.2684 --- loss: 1.531561, loss_ss: 1.210272, loss_d: 0.321289
0.3067 --- loss: 1.431828, loss_ss: 1.085310, loss_d: 0.346518
0.3451 --- loss: 1.405204, loss_ss: 1.076990, loss_d: 0.328214
0.3834 --- loss: 1.520480, loss_ss: 0.885206, loss_d: 0.635274
0.4218 --- loss: 1.647823, loss_ss: 1.085712, loss_d: 0.562112
0.4601 --- loss: 1.646727, loss_ss: 1.199695, loss_d: 0.447032
0.4985 --- loss: 1.545979, loss_ss: 1.119933, loss_d: 0.426046
0.5368 --- loss: 1.478306, loss_ss: 1.168209, loss_d: 0.310097
0.5752 --- loss: 1.367658, loss_ss: 1.060796, loss_d: 0.306862
0.6135 --- loss: 1.848911, loss_ss: 1.378656, loss_d: 0.470255
0.6518 --- loss: 1.475662, loss_ss: 1.036270, loss_d: 0.439392
0.6902 --- loss: 1.784319, loss_ss: 1.459051, loss_d: 0.325268
0.7285 --- loss: 1.582165, loss_ss: 1.076983, loss_d: 0.505182
0.7669 --- loss: 1.361015, loss_ss: 0.863567, loss_d: 0.497449
0.8052 --- loss: 1.205450, loss_ss: 0.839096, loss_d: 0.366354
0.8436 --- loss: 1.481786, loss_ss: 1.081527, loss_d: 0.400259
0.8819 --- loss: 1.545899, loss_ss: 1.052381, loss_d: 0.493518
0.9202 --- loss: 1.665751, loss_ss: 1.065029, loss_d: 0.600721
0.9586 --- loss: 1.561166, loss_ss: 1.258949, loss_d: 0.302217
0.9969 --- loss: 1.921228, loss_ss: 1.061928, loss_d: 0.859300
Epoch finished! Loss: 1.5927233361280881
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.792594, loss_ss: 1.123344, loss_d: 0.669250
0.0383 --- loss: 1.466530, loss_ss: 1.023303, loss_d: 0.443228
0.0767 --- loss: 1.506936, loss_ss: 1.107719, loss_d: 0.399217
0.1150 --- loss: 1.476521, loss_ss: 1.142363, loss_d: 0.334158
0.1534 --- loss: 1.772039, loss_ss: 1.049273, loss_d: 0.722766
0.1917 --- loss: 1.603260, loss_ss: 1.339488, loss_d: 0.263772
0.2301 --- loss: 1.284817, loss_ss: 1.018788, loss_d: 0.266029
0.2684 --- loss: 1.648718, loss_ss: 1.076459, loss_d: 0.572259
0.3067 --- loss: 2.275013, loss_ss: 1.087455, loss_d: 1.187558
0.3451 --- loss: 1.996068, loss_ss: 1.315570, loss_d: 0.680499
0.3834 --- loss: 1.126958, loss_ss: 0.763149, loss_d: 0.363809
0.4218 --- loss: 1.716490, loss_ss: 1.148063, loss_d: 0.568427
0.4601 --- loss: 1.536878, loss_ss: 1.175983, loss_d: 0.360894
0.4985 --- loss: 1.660687, loss_ss: 1.209618, loss_d: 0.451069
0.5368 --- loss: 1.682060, loss_ss: 1.360193, loss_d: 0.321867
0.5752 --- loss: 1.975978, loss_ss: 1.138856, loss_d: 0.837122
0.6135 --- loss: 1.647236, loss_ss: 1.197203, loss_d: 0.450032
0.6518 --- loss: 1.516178, loss_ss: 1.131282, loss_d: 0.384896
0.6902 --- loss: 1.129148, loss_ss: 0.747681, loss_d: 0.381467
0.7285 --- loss: 1.475712, loss_ss: 1.144437, loss_d: 0.331274
0.7669 --- loss: 1.455279, loss_ss: 1.091839, loss_d: 0.363440
0.8052 --- loss: 1.517382, loss_ss: 1.252165, loss_d: 0.265217
0.8436 --- loss: 1.467211, loss_ss: 1.113621, loss_d: 0.353589
0.8819 --- loss: 1.288449, loss_ss: 1.038888, loss_d: 0.249561
0.9202 --- loss: 1.383604, loss_ss: 1.135157, loss_d: 0.248447
0.9586 --- loss: 1.451169, loss_ss: 0.899381, loss_d: 0.551788
0.9969 --- loss: 1.342364, loss_ss: 0.913571, loss_d: 0.428793
Epoch finished! Loss: 1.5737806728252999
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.466340, loss_ss: 1.071293, loss_d: 0.395048
0.0383 --- loss: 1.480759, loss_ss: 1.133188, loss_d: 0.347571
0.0767 --- loss: 1.368022, loss_ss: 1.088732, loss_d: 0.279290
0.1150 --- loss: 1.576156, loss_ss: 1.155833, loss_d: 0.420324
0.1534 --- loss: 1.342034, loss_ss: 1.074053, loss_d: 0.267981
0.1917 --- loss: 1.444837, loss_ss: 1.200390, loss_d: 0.244448
0.2301 --- loss: 1.489698, loss_ss: 0.968650, loss_d: 0.521047
0.2684 --- loss: 1.671253, loss_ss: 1.355904, loss_d: 0.315349
0.3067 --- loss: 1.629082, loss_ss: 1.090472, loss_d: 0.538610
0.3451 --- loss: 1.398009, loss_ss: 0.956668, loss_d: 0.441342
0.3834 --- loss: 1.409537, loss_ss: 0.979973, loss_d: 0.429565
0.4218 --- loss: 1.531237, loss_ss: 1.112771, loss_d: 0.418466
0.4601 --- loss: 1.188410, loss_ss: 0.813116, loss_d: 0.375294
0.4985 --- loss: 1.167284, loss_ss: 0.800358, loss_d: 0.366926
0.5368 --- loss: 1.559022, loss_ss: 1.177194, loss_d: 0.381828
0.5752 --- loss: 2.002191, loss_ss: 1.658489, loss_d: 0.343701
0.6135 --- loss: 1.464711, loss_ss: 1.059554, loss_d: 0.405157
0.6518 --- loss: 1.566781, loss_ss: 1.225927, loss_d: 0.340854
0.6902 --- loss: 1.854102, loss_ss: 1.553660, loss_d: 0.300442
0.7285 --- loss: 2.084356, loss_ss: 1.169572, loss_d: 0.914784
0.7669 --- loss: 1.440832, loss_ss: 0.926211, loss_d: 0.514621
0.8052 --- loss: 1.590556, loss_ss: 1.133424, loss_d: 0.457131
0.8436 --- loss: 1.973603, loss_ss: 1.337518, loss_d: 0.636085
0.8819 --- loss: 1.563909, loss_ss: 1.247846, loss_d: 0.316063
0.9202 --- loss: 1.490565, loss_ss: 1.104419, loss_d: 0.386146
0.9586 --- loss: 1.262425, loss_ss: 0.945998, loss_d: 0.316426
0.9969 --- loss: 1.242410, loss_ss: 0.888286, loss_d: 0.354124
Epoch finished! Loss: 1.541147302205746
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.538072, loss_ss: 1.248592, loss_d: 0.289479
0.0383 --- loss: 1.787620, loss_ss: 1.348648, loss_d: 0.438972
0.0767 --- loss: 1.626921, loss_ss: 1.285681, loss_d: 0.341241
0.1150 --- loss: 2.387534, loss_ss: 1.487547, loss_d: 0.899987
0.1534 --- loss: 1.410117, loss_ss: 1.026264, loss_d: 0.383853
0.1917 --- loss: 1.436187, loss_ss: 1.129936, loss_d: 0.306251
0.2301 --- loss: 1.617573, loss_ss: 1.279492, loss_d: 0.338080
0.2684 --- loss: 1.755738, loss_ss: 1.138865, loss_d: 0.616873
0.3067 --- loss: 1.821661, loss_ss: 1.366378, loss_d: 0.455283
0.3451 --- loss: 1.484653, loss_ss: 1.199176, loss_d: 0.285476
0.3834 --- loss: 1.505297, loss_ss: 1.126941, loss_d: 0.378356
0.4218 --- loss: 1.361683, loss_ss: 0.890879, loss_d: 0.470805
0.4601 --- loss: 1.604208, loss_ss: 1.177095, loss_d: 0.427114
0.4985 --- loss: 1.188617, loss_ss: 0.913965, loss_d: 0.274652
0.5368 --- loss: 1.461886, loss_ss: 1.197716, loss_d: 0.264170
0.5752 --- loss: 1.521865, loss_ss: 1.315622, loss_d: 0.206244
0.6135 --- loss: 1.790318, loss_ss: 1.108697, loss_d: 0.681621
0.6518 --- loss: 1.423177, loss_ss: 0.949070, loss_d: 0.474108
0.6902 --- loss: 1.358181, loss_ss: 1.055160, loss_d: 0.303021
0.7285 --- loss: 1.267193, loss_ss: 0.896629, loss_d: 0.370563
0.7669 --- loss: 1.333722, loss_ss: 0.949866, loss_d: 0.383857
0.8052 --- loss: 1.612611, loss_ss: 1.087643, loss_d: 0.524968
0.8436 --- loss: 1.486429, loss_ss: 1.112483, loss_d: 0.373945
0.8819 --- loss: 1.510215, loss_ss: 0.955674, loss_d: 0.554541
0.9202 --- loss: 1.327913, loss_ss: 0.906378, loss_d: 0.421535
0.9586 --- loss: 1.797921, loss_ss: 1.157812, loss_d: 0.640109
0.9969 --- loss: 1.727061, loss_ss: 1.404114, loss_d: 0.322947
Epoch finished! Loss: 1.521410301556954
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5255555555555556
             precision    recall  f1-score   support

        0.0       1.00      0.01      0.01       142
        1.0       0.00      0.00      0.00        23
        2.0       0.52      1.00      0.69       466
        3.0       0.64      0.04      0.08       167
        4.0       0.00      0.00      0.00       102

avg / total       0.55      0.53      0.37       900
 


====== chc052-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  84.33   0.70  100.00  100.00      1.40
1  97.44   0.00  100.00    0.00      0.00
2  52.89  99.79    2.53   52.36     68.69
3  81.78   4.19   99.45   63.64      7.87
4  88.67   0.00  100.00    0.00      0.00
Total accuracy: 52.56%
Average sen: 20.94%
Average spec: 80.40%
Macro f1-score: 15.59%
pred: 0.491855263710022, label: 0
Right! Diagnosis: Other

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.468162, loss_ss: 1.782504, loss_d: 0.685658
0.0383 --- loss: 2.019020, loss_ss: 1.604233, loss_d: 0.414787
0.0767 --- loss: 2.705089, loss_ss: 1.641641, loss_d: 1.063448
0.1150 --- loss: 2.344305, loss_ss: 1.636316, loss_d: 0.707989
0.1534 --- loss: 1.817140, loss_ss: 1.564201, loss_d: 0.252940
0.1917 --- loss: 2.222779, loss_ss: 1.654994, loss_d: 0.567784
0.2301 --- loss: 1.918039, loss_ss: 1.496552, loss_d: 0.421487
0.2684 --- loss: 1.956010, loss_ss: 1.490614, loss_d: 0.465396
0.3067 --- loss: 2.250937, loss_ss: 1.497662, loss_d: 0.753275
0.3451 --- loss: 2.086275, loss_ss: 1.692590, loss_d: 0.393685
0.3834 --- loss: 2.241289, loss_ss: 1.499857, loss_d: 0.741432
0.4218 --- loss: 2.004822, loss_ss: 1.457618, loss_d: 0.547204
0.4601 --- loss: 1.680060, loss_ss: 1.328530, loss_d: 0.351530
0.4985 --- loss: 2.014198, loss_ss: 1.686107, loss_d: 0.328091
0.5368 --- loss: 1.890119, loss_ss: 1.496927, loss_d: 0.393192
0.5752 --- loss: 2.189391, loss_ss: 1.586366, loss_d: 0.603025
0.6135 --- loss: 1.905086, loss_ss: 1.460871, loss_d: 0.444215
0.6518 --- loss: 1.929657, loss_ss: 1.394537, loss_d: 0.535120
0.6902 --- loss: 2.113539, loss_ss: 1.535869, loss_d: 0.577670
0.7285 --- loss: 2.176523, loss_ss: 1.658415, loss_d: 0.518108
0.7669 --- loss: 1.849625, loss_ss: 1.553429, loss_d: 0.296196
0.8052 --- loss: 1.958397, loss_ss: 1.342704, loss_d: 0.615693
0.8436 --- loss: 2.037342, loss_ss: 1.575176, loss_d: 0.462166
0.8819 --- loss: 2.047866, loss_ss: 1.577300, loss_d: 0.470567
0.9202 --- loss: 1.868050, loss_ss: 1.517458, loss_d: 0.350592
0.9586 --- loss: 1.873559, loss_ss: 1.504145, loss_d: 0.369414
0.9969 --- loss: 2.388373, loss_ss: 1.428140, loss_d: 0.960233
Epoch finished! Loss: 2.069949129453072
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.984939, loss_ss: 1.406782, loss_d: 0.578157
0.0383 --- loss: 1.965615, loss_ss: 1.628748, loss_d: 0.336866
0.0767 --- loss: 2.031593, loss_ss: 1.381559, loss_d: 0.650034
0.1150 --- loss: 2.085035, loss_ss: 1.678621, loss_d: 0.406413
0.1534 --- loss: 2.005300, loss_ss: 1.558308, loss_d: 0.446992
0.1917 --- loss: 2.036350, loss_ss: 1.543032, loss_d: 0.493318
0.2301 --- loss: 2.398553, loss_ss: 1.732612, loss_d: 0.665941
0.2684 --- loss: 1.940554, loss_ss: 1.418298, loss_d: 0.522257
0.3067 --- loss: 1.817279, loss_ss: 1.473991, loss_d: 0.343288
0.3451 --- loss: 2.142973, loss_ss: 1.411563, loss_d: 0.731410
0.3834 --- loss: 2.022974, loss_ss: 1.435496, loss_d: 0.587478
0.4218 --- loss: 2.707318, loss_ss: 1.420230, loss_d: 1.287088
0.4601 --- loss: 2.301718, loss_ss: 1.612812, loss_d: 0.688906
0.4985 --- loss: 1.779766, loss_ss: 1.342357, loss_d: 0.437409
0.5368 --- loss: 1.829122, loss_ss: 1.411509, loss_d: 0.417613
0.5752 --- loss: 1.947357, loss_ss: 1.521506, loss_d: 0.425851
0.6135 --- loss: 2.219635, loss_ss: 1.482485, loss_d: 0.737150
0.6518 --- loss: 2.196966, loss_ss: 1.558387, loss_d: 0.638579
0.6902 --- loss: 1.893129, loss_ss: 1.466653, loss_d: 0.426476
0.7285 --- loss: 1.961316, loss_ss: 1.483786, loss_d: 0.477529
0.7669 --- loss: 2.041567, loss_ss: 1.657737, loss_d: 0.383830
0.8052 --- loss: 1.932929, loss_ss: 1.435745, loss_d: 0.497184
0.8436 --- loss: 1.711552, loss_ss: 1.387385, loss_d: 0.324167
0.8819 --- loss: 2.016862, loss_ss: 1.346449, loss_d: 0.670413
0.9202 --- loss: 1.971441, loss_ss: 1.552061, loss_d: 0.419379
0.9586 --- loss: 2.048259, loss_ss: 1.490442, loss_d: 0.557816
0.9969 --- loss: 2.013354, loss_ss: 1.637661, loss_d: 0.375693
Epoch finished! Loss: 2.0220989850851208
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.791430, loss_ss: 1.497236, loss_d: 0.294194
0.0383 --- loss: 1.874152, loss_ss: 1.549852, loss_d: 0.324301
0.0767 --- loss: 1.963780, loss_ss: 1.705648, loss_d: 0.258132
0.1150 --- loss: 1.729057, loss_ss: 1.371504, loss_d: 0.357554
0.1534 --- loss: 1.968018, loss_ss: 1.537561, loss_d: 0.430456
0.1917 --- loss: 1.665932, loss_ss: 1.406785, loss_d: 0.259147
0.2301 --- loss: 2.067365, loss_ss: 1.657803, loss_d: 0.409562
0.2684 --- loss: 1.874971, loss_ss: 1.606005, loss_d: 0.268965
0.3067 --- loss: 2.035793, loss_ss: 1.663482, loss_d: 0.372311
0.3451 --- loss: 2.204077, loss_ss: 1.686387, loss_d: 0.517689
0.3834 --- loss: 2.356635, loss_ss: 1.578802, loss_d: 0.777833
0.4218 --- loss: 2.378979, loss_ss: 1.607349, loss_d: 0.771630
0.4601 --- loss: 1.879882, loss_ss: 1.445111, loss_d: 0.434771
0.4985 --- loss: 2.308445, loss_ss: 1.507494, loss_d: 0.800951
0.5368 --- loss: 2.112437, loss_ss: 1.597164, loss_d: 0.515274
0.5752 --- loss: 1.833033, loss_ss: 1.490285, loss_d: 0.342748
0.6135 --- loss: 2.037790, loss_ss: 1.467578, loss_d: 0.570212
0.6518 --- loss: 1.863373, loss_ss: 1.352602, loss_d: 0.510771
0.6902 --- loss: 2.362310, loss_ss: 1.481375, loss_d: 0.880935
0.7285 --- loss: 1.862214, loss_ss: 1.446587, loss_d: 0.415627
0.7669 --- loss: 1.782367, loss_ss: 1.244377, loss_d: 0.537990
0.8052 --- loss: 1.955358, loss_ss: 1.420011, loss_d: 0.535347
0.8436 --- loss: 1.909991, loss_ss: 1.591004, loss_d: 0.318987
0.8819 --- loss: 1.910539, loss_ss: 1.580744, loss_d: 0.329795
0.9202 --- loss: 2.171881, loss_ss: 1.450051, loss_d: 0.721829
0.9586 --- loss: 2.249531, loss_ss: 1.513121, loss_d: 0.736410
0.9969 --- loss: 2.161805, loss_ss: 1.344260, loss_d: 0.817545
Epoch finished! Loss: 1.9911731944634363
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.039364, loss_ss: 1.540207, loss_d: 0.499157
0.0383 --- loss: 2.203269, loss_ss: 1.859616, loss_d: 0.343654
0.0767 --- loss: 1.933864, loss_ss: 1.575600, loss_d: 0.358264
0.1150 --- loss: 1.995968, loss_ss: 1.461501, loss_d: 0.534467
0.1534 --- loss: 2.070524, loss_ss: 1.457625, loss_d: 0.612899
0.1917 --- loss: 2.225534, loss_ss: 1.553391, loss_d: 0.672143
0.2301 --- loss: 1.818923, loss_ss: 1.475225, loss_d: 0.343698
0.2684 --- loss: 1.819602, loss_ss: 1.462598, loss_d: 0.357004
0.3067 --- loss: 2.293126, loss_ss: 1.550502, loss_d: 0.742624
0.3451 --- loss: 1.715292, loss_ss: 1.333572, loss_d: 0.381721
0.3834 --- loss: 1.773532, loss_ss: 1.339653, loss_d: 0.433879
0.4218 --- loss: 2.095044, loss_ss: 1.452200, loss_d: 0.642844
0.4601 --- loss: 1.835269, loss_ss: 1.251292, loss_d: 0.583977
0.4985 --- loss: 2.023885, loss_ss: 1.316562, loss_d: 0.707322
0.5368 --- loss: 1.831446, loss_ss: 1.338514, loss_d: 0.492932
0.5752 --- loss: 2.136096, loss_ss: 1.468340, loss_d: 0.667756
0.6135 --- loss: 1.737611, loss_ss: 1.102067, loss_d: 0.635544
0.6518 --- loss: 1.751515, loss_ss: 1.371063, loss_d: 0.380453
0.6902 --- loss: 1.712631, loss_ss: 1.380141, loss_d: 0.332491
0.7285 --- loss: 2.235394, loss_ss: 1.833284, loss_d: 0.402110
0.7669 --- loss: 1.930916, loss_ss: 1.433605, loss_d: 0.497311
0.8052 --- loss: 1.739835, loss_ss: 1.455862, loss_d: 0.283973
0.8436 --- loss: 1.903628, loss_ss: 1.449481, loss_d: 0.454148
0.8819 --- loss: 1.939645, loss_ss: 1.585143, loss_d: 0.354502
0.9202 --- loss: 2.020246, loss_ss: 1.488819, loss_d: 0.531427
0.9586 --- loss: 2.205930, loss_ss: 1.518734, loss_d: 0.687195
0.9969 --- loss: 1.741005, loss_ss: 1.413048, loss_d: 0.327957
Epoch finished! Loss: 1.9584741000945751
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.734793, loss_ss: 1.360518, loss_d: 0.374275
0.0383 --- loss: 2.041642, loss_ss: 1.671333, loss_d: 0.370309
0.0767 --- loss: 1.767863, loss_ss: 1.312952, loss_d: 0.454911
0.1150 --- loss: 1.846286, loss_ss: 1.408900, loss_d: 0.437386
0.1534 --- loss: 2.079211, loss_ss: 1.427509, loss_d: 0.651702
0.1917 --- loss: 1.842510, loss_ss: 1.535480, loss_d: 0.307030
0.2301 --- loss: 1.799465, loss_ss: 1.444339, loss_d: 0.355127
0.2684 --- loss: 1.828540, loss_ss: 1.290684, loss_d: 0.537855
0.3067 --- loss: 2.087216, loss_ss: 1.495990, loss_d: 0.591227
0.3451 --- loss: 1.878541, loss_ss: 1.549101, loss_d: 0.329440
0.3834 --- loss: 1.889519, loss_ss: 1.440431, loss_d: 0.449088
0.4218 --- loss: 1.617578, loss_ss: 1.275152, loss_d: 0.342425
0.4601 --- loss: 1.866472, loss_ss: 1.398983, loss_d: 0.467489
0.4985 --- loss: 2.037424, loss_ss: 1.427854, loss_d: 0.609569
0.5368 --- loss: 1.842614, loss_ss: 1.490300, loss_d: 0.352314
0.5752 --- loss: 1.895781, loss_ss: 1.438726, loss_d: 0.457055
0.6135 --- loss: 2.125940, loss_ss: 1.597238, loss_d: 0.528703
0.6518 --- loss: 1.495193, loss_ss: 1.280669, loss_d: 0.214525
0.6902 --- loss: 1.931141, loss_ss: 1.357451, loss_d: 0.573690
0.7285 --- loss: 1.696766, loss_ss: 1.293290, loss_d: 0.403476
0.7669 --- loss: 1.686430, loss_ss: 1.360607, loss_d: 0.325822
0.8052 --- loss: 1.740275, loss_ss: 1.428051, loss_d: 0.312224
0.8436 --- loss: 1.956169, loss_ss: 1.594087, loss_d: 0.362082
0.8819 --- loss: 2.134368, loss_ss: 1.578168, loss_d: 0.556200
0.9202 --- loss: 2.063602, loss_ss: 1.171684, loss_d: 0.891918
0.9586 --- loss: 1.883833, loss_ss: 1.410990, loss_d: 0.472842
0.9969 --- loss: 1.957395, loss_ss: 1.354960, loss_d: 0.602435
Epoch finished! Loss: 1.899665688092892
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.747308, loss_ss: 1.390751, loss_d: 0.356557
0.0383 --- loss: 1.931104, loss_ss: 1.404926, loss_d: 0.526178
0.0767 --- loss: 1.858359, loss_ss: 1.412615, loss_d: 0.445744
0.1150 --- loss: 2.008080, loss_ss: 1.308951, loss_d: 0.699130
0.1534 --- loss: 1.717891, loss_ss: 1.214501, loss_d: 0.503390
0.1917 --- loss: 1.709143, loss_ss: 1.308585, loss_d: 0.400557
0.2301 --- loss: 1.822698, loss_ss: 1.315681, loss_d: 0.507018
0.2684 --- loss: 1.465500, loss_ss: 1.185755, loss_d: 0.279745
0.3067 --- loss: 1.673792, loss_ss: 1.281046, loss_d: 0.392746
0.3451 --- loss: 1.846110, loss_ss: 1.587220, loss_d: 0.258890
0.3834 --- loss: 1.715711, loss_ss: 1.183042, loss_d: 0.532669
0.4218 --- loss: 1.767419, loss_ss: 1.294664, loss_d: 0.472755
0.4601 --- loss: 2.052447, loss_ss: 1.409596, loss_d: 0.642851
0.4985 --- loss: 2.068893, loss_ss: 1.395848, loss_d: 0.673045
0.5368 --- loss: 1.929626, loss_ss: 1.208921, loss_d: 0.720706
0.5752 --- loss: 1.701290, loss_ss: 1.320997, loss_d: 0.380293
0.6135 --- loss: 1.394230, loss_ss: 1.139308, loss_d: 0.254922
0.6518 --- loss: 1.693892, loss_ss: 1.338114, loss_d: 0.355778
0.6902 --- loss: 1.429330, loss_ss: 1.126646, loss_d: 0.302684
0.7285 --- loss: 1.730282, loss_ss: 1.265014, loss_d: 0.465267
0.7669 --- loss: 1.610272, loss_ss: 0.946732, loss_d: 0.663540
0.8052 --- loss: 1.564498, loss_ss: 1.120646, loss_d: 0.443852
0.8436 --- loss: 1.830931, loss_ss: 1.278715, loss_d: 0.552216
0.8819 --- loss: 1.791487, loss_ss: 1.388545, loss_d: 0.402942
0.9202 --- loss: 1.713877, loss_ss: 1.196276, loss_d: 0.517601
0.9586 --- loss: 1.977174, loss_ss: 1.276176, loss_d: 0.700998
0.9969 --- loss: 1.857733, loss_ss: 1.534893, loss_d: 0.322840
Epoch finished! Loss: 1.7636525585101201
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.633667, loss_ss: 1.017214, loss_d: 0.616454
0.0383 --- loss: 1.415463, loss_ss: 1.082023, loss_d: 0.333440
0.0767 --- loss: 1.745887, loss_ss: 1.405281, loss_d: 0.340605
0.1150 --- loss: 1.714339, loss_ss: 1.310063, loss_d: 0.404275
0.1534 --- loss: 1.562328, loss_ss: 1.112249, loss_d: 0.450078
0.1917 --- loss: 1.798862, loss_ss: 1.457138, loss_d: 0.341724
0.2301 --- loss: 1.722747, loss_ss: 1.212983, loss_d: 0.509764
0.2684 --- loss: 1.570368, loss_ss: 1.253886, loss_d: 0.316482
0.3067 --- loss: 1.229293, loss_ss: 0.928050, loss_d: 0.301243
0.3451 --- loss: 1.283644, loss_ss: 0.980798, loss_d: 0.302845
0.3834 --- loss: 1.335528, loss_ss: 0.995336, loss_d: 0.340192
0.4218 --- loss: 2.056181, loss_ss: 1.492659, loss_d: 0.563522
0.4601 --- loss: 1.658975, loss_ss: 1.207929, loss_d: 0.451046
0.4985 --- loss: 1.200801, loss_ss: 0.894093, loss_d: 0.306709
0.5368 --- loss: 1.337355, loss_ss: 1.058164, loss_d: 0.279192
0.5752 --- loss: 1.416231, loss_ss: 1.181413, loss_d: 0.234817
0.6135 --- loss: 1.550632, loss_ss: 1.256522, loss_d: 0.294111
0.6518 --- loss: 2.231259, loss_ss: 1.200950, loss_d: 1.030309
0.6902 --- loss: 1.757898, loss_ss: 1.414482, loss_d: 0.343416
0.7285 --- loss: 1.502592, loss_ss: 1.113622, loss_d: 0.388970
0.7669 --- loss: 1.636808, loss_ss: 1.103881, loss_d: 0.532926
0.8052 --- loss: 1.491440, loss_ss: 1.093685, loss_d: 0.397755
0.8436 --- loss: 1.558042, loss_ss: 1.161183, loss_d: 0.396859
0.8819 --- loss: 1.775360, loss_ss: 1.461551, loss_d: 0.313809
0.9202 --- loss: 1.626956, loss_ss: 1.188510, loss_d: 0.438446
0.9586 --- loss: 1.648573, loss_ss: 1.136989, loss_d: 0.511584
0.9969 --- loss: 1.669502, loss_ss: 1.191463, loss_d: 0.478038
Epoch finished! Loss: 1.6837978078768803
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.441618, loss_ss: 1.145805, loss_d: 0.295814
0.0383 --- loss: 1.251605, loss_ss: 0.961840, loss_d: 0.289765
0.0767 --- loss: 1.443605, loss_ss: 1.206986, loss_d: 0.236619
0.1150 --- loss: 1.496136, loss_ss: 1.232889, loss_d: 0.263247
0.1534 --- loss: 1.195006, loss_ss: 0.977633, loss_d: 0.217373
0.1917 --- loss: 1.623278, loss_ss: 1.213290, loss_d: 0.409987
0.2301 --- loss: 1.379613, loss_ss: 1.032538, loss_d: 0.347075
0.2684 --- loss: 1.295548, loss_ss: 0.994846, loss_d: 0.300702
0.3067 --- loss: 1.673093, loss_ss: 1.228583, loss_d: 0.444510
0.3451 --- loss: 1.750981, loss_ss: 1.209435, loss_d: 0.541546
0.3834 --- loss: 1.337544, loss_ss: 0.894190, loss_d: 0.443354
0.4218 --- loss: 1.505918, loss_ss: 1.249181, loss_d: 0.256737
0.4601 --- loss: 1.391154, loss_ss: 1.106536, loss_d: 0.284618
0.4985 --- loss: 1.701510, loss_ss: 1.402047, loss_d: 0.299463
0.5368 --- loss: 1.359010, loss_ss: 0.904061, loss_d: 0.454949
0.5752 --- loss: 1.431911, loss_ss: 0.992514, loss_d: 0.439397
0.6135 --- loss: 1.448444, loss_ss: 1.061130, loss_d: 0.387315
0.6518 --- loss: 1.746129, loss_ss: 1.163552, loss_d: 0.582577
0.6902 --- loss: 1.358773, loss_ss: 1.048271, loss_d: 0.310502
0.7285 --- loss: 1.598606, loss_ss: 1.246381, loss_d: 0.352225
0.7669 --- loss: 1.512127, loss_ss: 0.939126, loss_d: 0.573001
0.8052 --- loss: 1.334358, loss_ss: 1.020597, loss_d: 0.313761
0.8436 --- loss: 1.797139, loss_ss: 1.058499, loss_d: 0.738640
0.8819 --- loss: 1.651514, loss_ss: 0.982146, loss_d: 0.669368
0.9202 --- loss: 1.584822, loss_ss: 1.119971, loss_d: 0.464852
0.9586 --- loss: 1.565223, loss_ss: 1.140427, loss_d: 0.424796
0.9969 --- loss: 1.652223, loss_ss: 1.138788, loss_d: 0.513435
Epoch finished! Loss: 1.6244988271823295
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.433285, loss_ss: 1.015378, loss_d: 0.417907
0.0383 --- loss: 1.874464, loss_ss: 1.340664, loss_d: 0.533800
0.0767 --- loss: 1.440668, loss_ss: 1.047668, loss_d: 0.393000
0.1150 --- loss: 1.626867, loss_ss: 1.038897, loss_d: 0.587970
0.1534 --- loss: 1.695987, loss_ss: 1.199177, loss_d: 0.496810
0.1917 --- loss: 1.629840, loss_ss: 1.161773, loss_d: 0.468067
0.2301 --- loss: 1.582861, loss_ss: 1.146581, loss_d: 0.436280
0.2684 --- loss: 1.319888, loss_ss: 0.994649, loss_d: 0.325238
0.3067 --- loss: 1.535067, loss_ss: 1.025250, loss_d: 0.509817
0.3451 --- loss: 1.889240, loss_ss: 1.159084, loss_d: 0.730156
0.3834 --- loss: 1.422059, loss_ss: 1.051543, loss_d: 0.370516
0.4218 --- loss: 1.503993, loss_ss: 1.272888, loss_d: 0.231105
0.4601 --- loss: 1.700225, loss_ss: 1.037960, loss_d: 0.662265
0.4985 --- loss: 1.514452, loss_ss: 1.043103, loss_d: 0.471350
0.5368 --- loss: 1.719318, loss_ss: 1.280063, loss_d: 0.439256
0.5752 --- loss: 1.422266, loss_ss: 1.164847, loss_d: 0.257419
0.6135 --- loss: 1.439998, loss_ss: 1.110145, loss_d: 0.329853
0.6518 --- loss: 1.693448, loss_ss: 1.142137, loss_d: 0.551311
0.6902 --- loss: 1.400541, loss_ss: 1.115129, loss_d: 0.285412
0.7285 --- loss: 1.580078, loss_ss: 1.001591, loss_d: 0.578487
0.7669 --- loss: 1.525354, loss_ss: 1.059013, loss_d: 0.466341
0.8052 --- loss: 1.192687, loss_ss: 0.850285, loss_d: 0.342402
0.8436 --- loss: 1.620853, loss_ss: 0.873503, loss_d: 0.747350
0.8819 --- loss: 1.406889, loss_ss: 1.040358, loss_d: 0.366531
0.9202 --- loss: 1.355683, loss_ss: 0.945917, loss_d: 0.409766
0.9586 --- loss: 1.597713, loss_ss: 1.211567, loss_d: 0.386146
0.9969 --- loss: 1.825635, loss_ss: 1.205645, loss_d: 0.619990
Epoch finished! Loss: 1.5623186386548555
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.153094, loss_ss: 0.857482, loss_d: 0.295612
0.0383 --- loss: 2.138540, loss_ss: 1.559864, loss_d: 0.578677
0.0767 --- loss: 2.369962, loss_ss: 2.032620, loss_d: 0.337342
0.1150 --- loss: 1.956076, loss_ss: 1.121751, loss_d: 0.834325
0.1534 --- loss: 1.237944, loss_ss: 0.894399, loss_d: 0.343545
0.1917 --- loss: 1.681594, loss_ss: 1.206701, loss_d: 0.474893
0.2301 --- loss: 1.360612, loss_ss: 1.083826, loss_d: 0.276786
0.2684 --- loss: 1.569573, loss_ss: 1.181004, loss_d: 0.388569
0.3067 --- loss: 1.606488, loss_ss: 1.297823, loss_d: 0.308665
0.3451 --- loss: 1.354238, loss_ss: 0.985778, loss_d: 0.368460
0.3834 --- loss: 1.789200, loss_ss: 1.072868, loss_d: 0.716332
0.4218 --- loss: 1.595039, loss_ss: 1.058623, loss_d: 0.536416
0.4601 --- loss: 1.766944, loss_ss: 1.409123, loss_d: 0.357821
0.4985 --- loss: 1.431481, loss_ss: 1.011566, loss_d: 0.419915
0.5368 --- loss: 1.524507, loss_ss: 1.266146, loss_d: 0.258362
0.5752 --- loss: 1.296365, loss_ss: 1.090007, loss_d: 0.206358
0.6135 --- loss: 1.670238, loss_ss: 0.861519, loss_d: 0.808719
0.6518 --- loss: 1.311018, loss_ss: 1.016587, loss_d: 0.294431
0.6902 --- loss: 1.617412, loss_ss: 1.238226, loss_d: 0.379186
0.7285 --- loss: 1.276841, loss_ss: 0.908207, loss_d: 0.368633
0.7669 --- loss: 1.284069, loss_ss: 0.886201, loss_d: 0.397868
0.8052 --- loss: 1.697889, loss_ss: 0.905845, loss_d: 0.792044
0.8436 --- loss: 1.754453, loss_ss: 1.482596, loss_d: 0.271858
0.8819 --- loss: 1.507201, loss_ss: 1.169221, loss_d: 0.337980
0.9202 --- loss: 1.435233, loss_ss: 1.138786, loss_d: 0.296447
0.9586 --- loss: 1.213458, loss_ss: 0.884875, loss_d: 0.328583
0.9969 --- loss: 1.346848, loss_ss: 1.033446, loss_d: 0.313402
Epoch finished! Loss: 1.547241769845669
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.14888888888888888
             precision    recall  f1-score   support

        0.0       0.44      0.23      0.30       175
        1.0       0.00      0.00      0.00        86
        2.0       0.75      0.02      0.04       396
        3.0       0.00      0.00      0.00       153
        4.0       0.11      0.94      0.19        90

avg / total       0.43      0.15      0.10       900
 


====== chc056-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  79.33  22.86   92.97  43.96     30.08
1  90.44   0.00  100.00   0.00      0.00
2  56.67   2.27   99.40  75.00      4.41
3  83.00   0.00  100.00   0.00      0.00
4  20.33  94.44   12.10  10.66     19.17
Total accuracy: 14.89%
Average sen: 23.91%
Average spec: 80.89%
Macro f1-score: 10.73%
[0.85293692 0.76872075 0.62910199 0.65656441 0.63477391 0.75282878
 0.74120289 0.66623306 0.60829031 0.61068177 0.70475572 0.62424618
 0.6190266  0.69362319 0.64388776 0.79258627 0.77999032 0.68329251
 0.60683739 0.65603882 0.61497444 0.60752511 0.77661115 0.66324759
 0.6057952  0.61188453 0.60564274 0.61672688 0.61535436 0.60959846]
pred: 0.6684326668580373, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.179712, loss_ss: 1.503125, loss_d: 0.676587
0.0385 --- loss: 2.735025, loss_ss: 1.467971, loss_d: 1.267054
0.0769 --- loss: 2.220048, loss_ss: 1.714720, loss_d: 0.505328
0.1154 --- loss: 2.160291, loss_ss: 1.696504, loss_d: 0.463787
0.1538 --- loss: 2.291731, loss_ss: 1.515582, loss_d: 0.776149
0.1923 --- loss: 2.236068, loss_ss: 1.448955, loss_d: 0.787113
0.2308 --- loss: 2.084173, loss_ss: 1.750031, loss_d: 0.334141
0.2692 --- loss: 2.054735, loss_ss: 1.624217, loss_d: 0.430518
0.3077 --- loss: 2.053556, loss_ss: 1.413238, loss_d: 0.640318
0.3462 --- loss: 2.299996, loss_ss: 1.552873, loss_d: 0.747123
0.3846 --- loss: 2.336727, loss_ss: 1.470595, loss_d: 0.866132
0.4231 --- loss: 1.970354, loss_ss: 1.479995, loss_d: 0.490359
0.4615 --- loss: 1.955632, loss_ss: 1.526615, loss_d: 0.429018
0.5000 --- loss: 2.084408, loss_ss: 1.493533, loss_d: 0.590875
0.5385 --- loss: 2.107260, loss_ss: 1.411456, loss_d: 0.695803
0.5769 --- loss: 2.210261, loss_ss: 1.579780, loss_d: 0.630481
0.6154 --- loss: 1.860650, loss_ss: 1.251771, loss_d: 0.608879
0.6538 --- loss: 2.283223, loss_ss: 1.440478, loss_d: 0.842745
0.6923 --- loss: 2.283801, loss_ss: 1.750660, loss_d: 0.533142
0.7308 --- loss: 2.409345, loss_ss: 1.621613, loss_d: 0.787732
0.7692 --- loss: 2.554223, loss_ss: 1.741545, loss_d: 0.812678
0.8077 --- loss: 1.796079, loss_ss: 1.356069, loss_d: 0.440010
0.8462 --- loss: 1.943860, loss_ss: 1.570428, loss_d: 0.373432
0.8846 --- loss: 2.132499, loss_ss: 1.506615, loss_d: 0.625883
0.9231 --- loss: 1.938580, loss_ss: 1.527647, loss_d: 0.410933
0.9615 --- loss: 2.050387, loss_ss: 1.371934, loss_d: 0.678453
Epoch finished! Loss: 2.1006051343380254
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.089443, loss_ss: 1.732131, loss_d: 0.357311
0.0385 --- loss: 1.839550, loss_ss: 1.365733, loss_d: 0.473817
0.0769 --- loss: 1.966318, loss_ss: 1.351960, loss_d: 0.614358
0.1154 --- loss: 2.325406, loss_ss: 1.505957, loss_d: 0.819449
0.1538 --- loss: 1.996251, loss_ss: 1.612396, loss_d: 0.383854
0.1923 --- loss: 2.031647, loss_ss: 1.448218, loss_d: 0.583430
0.2308 --- loss: 1.703325, loss_ss: 1.372655, loss_d: 0.330670
0.2692 --- loss: 1.763881, loss_ss: 1.423842, loss_d: 0.340039
0.3077 --- loss: 1.718027, loss_ss: 1.284796, loss_d: 0.433231
0.3462 --- loss: 2.055990, loss_ss: 1.376066, loss_d: 0.679923
0.3846 --- loss: 2.115259, loss_ss: 1.572278, loss_d: 0.542981
0.4231 --- loss: 1.931485, loss_ss: 1.390407, loss_d: 0.541077
0.4615 --- loss: 1.878664, loss_ss: 1.358095, loss_d: 0.520569
0.5000 --- loss: 1.861934, loss_ss: 1.402194, loss_d: 0.459740
0.5385 --- loss: 1.916411, loss_ss: 1.432349, loss_d: 0.484062
0.5769 --- loss: 2.197979, loss_ss: 1.738469, loss_d: 0.459510
0.6154 --- loss: 1.909479, loss_ss: 1.455627, loss_d: 0.453852
0.6538 --- loss: 1.988240, loss_ss: 1.412716, loss_d: 0.575524
0.6923 --- loss: 2.059319, loss_ss: 1.193013, loss_d: 0.866305
0.7308 --- loss: 1.833811, loss_ss: 1.453807, loss_d: 0.380004
0.7692 --- loss: 1.788566, loss_ss: 1.322247, loss_d: 0.466319
0.8077 --- loss: 1.880633, loss_ss: 1.369052, loss_d: 0.511581
0.8462 --- loss: 1.981596, loss_ss: 1.566180, loss_d: 0.415417
0.8846 --- loss: 1.949800, loss_ss: 1.337853, loss_d: 0.611947
0.9231 --- loss: 2.447257, loss_ss: 1.702440, loss_d: 0.744816
0.9615 --- loss: 1.952248, loss_ss: 1.436015, loss_d: 0.516234
Epoch finished! Loss: 1.9771906827867722
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.023512, loss_ss: 1.513616, loss_d: 0.509895
0.0385 --- loss: 1.983635, loss_ss: 1.511965, loss_d: 0.471670
0.0769 --- loss: 1.622038, loss_ss: 1.253389, loss_d: 0.368649
0.1154 --- loss: 1.904243, loss_ss: 1.313406, loss_d: 0.590838
0.1538 --- loss: 1.878098, loss_ss: 1.454355, loss_d: 0.423743
0.1923 --- loss: 1.947344, loss_ss: 1.485876, loss_d: 0.461469
0.2308 --- loss: 2.095842, loss_ss: 1.361417, loss_d: 0.734425
0.2692 --- loss: 1.894583, loss_ss: 1.532028, loss_d: 0.362555
0.3077 --- loss: 2.044149, loss_ss: 1.476015, loss_d: 0.568134
0.3462 --- loss: 2.008090, loss_ss: 1.602260, loss_d: 0.405830
0.3846 --- loss: 1.913697, loss_ss: 1.332833, loss_d: 0.580864
0.4231 --- loss: 1.880392, loss_ss: 1.264036, loss_d: 0.616356
0.4615 --- loss: 1.874489, loss_ss: 1.287235, loss_d: 0.587254
0.5000 --- loss: 2.070731, loss_ss: 1.544214, loss_d: 0.526517
0.5385 --- loss: 1.900855, loss_ss: 1.231121, loss_d: 0.669734
0.5769 --- loss: 2.087222, loss_ss: 1.569649, loss_d: 0.517573
0.6154 --- loss: 1.896015, loss_ss: 1.408790, loss_d: 0.487225
0.6538 --- loss: 1.985557, loss_ss: 1.416820, loss_d: 0.568737
0.6923 --- loss: 1.689623, loss_ss: 1.133193, loss_d: 0.556429
0.7308 --- loss: 2.096413, loss_ss: 1.404840, loss_d: 0.691573
0.7692 --- loss: 2.249351, loss_ss: 1.626969, loss_d: 0.622383
0.8077 --- loss: 1.726165, loss_ss: 1.107426, loss_d: 0.618739
0.8462 --- loss: 1.710361, loss_ss: 1.351749, loss_d: 0.358612
0.8846 --- loss: 2.068356, loss_ss: 1.529223, loss_d: 0.539133
0.9231 --- loss: 2.043640, loss_ss: 1.253491, loss_d: 0.790149
0.9615 --- loss: 1.521142, loss_ss: 1.128265, loss_d: 0.392878
Epoch finished! Loss: 1.8897713431980618
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.568911, loss_ss: 1.108014, loss_d: 0.460898
0.0385 --- loss: 1.615964, loss_ss: 1.157122, loss_d: 0.458842
0.0769 --- loss: 1.999654, loss_ss: 1.551452, loss_d: 0.448202
0.1154 --- loss: 1.974819, loss_ss: 1.430219, loss_d: 0.544600
0.1538 --- loss: 2.033126, loss_ss: 1.406546, loss_d: 0.626579
0.1923 --- loss: 1.912614, loss_ss: 1.411198, loss_d: 0.501416
0.2308 --- loss: 1.543744, loss_ss: 1.145425, loss_d: 0.398319
0.2692 --- loss: 2.126517, loss_ss: 1.307415, loss_d: 0.819102
0.3077 --- loss: 1.711437, loss_ss: 1.168476, loss_d: 0.542961
0.3462 --- loss: 1.942610, loss_ss: 1.428587, loss_d: 0.514023
0.3846 --- loss: 1.440212, loss_ss: 1.090771, loss_d: 0.349442
0.4231 --- loss: 1.994385, loss_ss: 1.321921, loss_d: 0.672465
0.4615 --- loss: 1.853192, loss_ss: 1.268187, loss_d: 0.585005
0.5000 --- loss: 1.669771, loss_ss: 1.260783, loss_d: 0.408989
0.5385 --- loss: 1.527612, loss_ss: 1.162819, loss_d: 0.364793
0.5769 --- loss: 1.924333, loss_ss: 1.428523, loss_d: 0.495810
0.6154 --- loss: 2.036626, loss_ss: 1.492791, loss_d: 0.543835
0.6538 --- loss: 1.913247, loss_ss: 1.442865, loss_d: 0.470382
0.6923 --- loss: 1.664319, loss_ss: 1.144205, loss_d: 0.520114
0.7308 --- loss: 1.786105, loss_ss: 1.480809, loss_d: 0.305296
0.7692 --- loss: 1.561300, loss_ss: 1.080602, loss_d: 0.480698
0.8077 --- loss: 1.562063, loss_ss: 1.204563, loss_d: 0.357500
0.8462 --- loss: 1.391044, loss_ss: 1.087318, loss_d: 0.303725
0.8846 --- loss: 1.959761, loss_ss: 1.332461, loss_d: 0.627300
0.9231 --- loss: 1.499784, loss_ss: 1.218023, loss_d: 0.281761
0.9615 --- loss: 1.641072, loss_ss: 1.095377, loss_d: 0.545695
Epoch finished! Loss: 1.7471797641179736
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.612269, loss_ss: 1.022036, loss_d: 0.590233
0.0385 --- loss: 1.317904, loss_ss: 1.011522, loss_d: 0.306382
0.0769 --- loss: 1.787051, loss_ss: 1.151944, loss_d: 0.635107
0.1154 --- loss: 1.875276, loss_ss: 1.053999, loss_d: 0.821277
0.1538 --- loss: 1.835878, loss_ss: 1.306608, loss_d: 0.529269
0.1923 --- loss: 2.054153, loss_ss: 1.431350, loss_d: 0.622804
0.2308 --- loss: 1.584061, loss_ss: 1.053295, loss_d: 0.530766
0.2692 --- loss: 1.563479, loss_ss: 1.224176, loss_d: 0.339304
0.3077 --- loss: 1.891016, loss_ss: 1.250017, loss_d: 0.640999
0.3462 --- loss: 1.345920, loss_ss: 0.947163, loss_d: 0.398757
0.3846 --- loss: 1.695935, loss_ss: 1.257462, loss_d: 0.438473
0.4231 --- loss: 1.803707, loss_ss: 1.336206, loss_d: 0.467501
0.4615 --- loss: 1.500564, loss_ss: 1.240810, loss_d: 0.259754
0.5000 --- loss: 1.501677, loss_ss: 1.177514, loss_d: 0.324163
0.5385 --- loss: 2.231092, loss_ss: 1.092987, loss_d: 1.138106
0.5769 --- loss: 1.603794, loss_ss: 1.234773, loss_d: 0.369021
0.6154 --- loss: 1.577510, loss_ss: 1.031374, loss_d: 0.546136
0.6538 --- loss: 1.475334, loss_ss: 1.077963, loss_d: 0.397372
0.6923 --- loss: 1.583778, loss_ss: 1.132980, loss_d: 0.450797
0.7308 --- loss: 1.415745, loss_ss: 1.089455, loss_d: 0.326289
0.7692 --- loss: 1.744947, loss_ss: 1.196300, loss_d: 0.548647
0.8077 --- loss: 1.540491, loss_ss: 0.884421, loss_d: 0.656070
0.8462 --- loss: 2.204899, loss_ss: 0.974453, loss_d: 1.230446
0.8846 --- loss: 2.260287, loss_ss: 1.400870, loss_d: 0.859417
0.9231 --- loss: 1.476098, loss_ss: 1.093230, loss_d: 0.382867
0.9615 --- loss: 1.462405, loss_ss: 1.130641, loss_d: 0.331765
Epoch finished! Loss: 1.6672198689582265
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.804694, loss_ss: 1.245479, loss_d: 0.559215
0.0385 --- loss: 1.598634, loss_ss: 1.161977, loss_d: 0.436656
0.0769 --- loss: 1.391762, loss_ss: 0.986319, loss_d: 0.405443
0.1154 --- loss: 1.790948, loss_ss: 1.218207, loss_d: 0.572741
0.1538 --- loss: 1.409839, loss_ss: 1.186378, loss_d: 0.223460
0.1923 --- loss: 1.970410, loss_ss: 1.595622, loss_d: 0.374788
0.2308 --- loss: 1.241245, loss_ss: 0.928490, loss_d: 0.312755
0.2692 --- loss: 1.548031, loss_ss: 1.175961, loss_d: 0.372070
0.3077 --- loss: 1.539176, loss_ss: 1.238243, loss_d: 0.300934
0.3462 --- loss: 1.620234, loss_ss: 1.199546, loss_d: 0.420689
0.3846 --- loss: 1.742794, loss_ss: 1.075237, loss_d: 0.667556
0.4231 --- loss: 1.833215, loss_ss: 0.834767, loss_d: 0.998448
0.4615 --- loss: 1.763445, loss_ss: 1.339979, loss_d: 0.423466
0.5000 --- loss: 1.545327, loss_ss: 1.123495, loss_d: 0.421832
0.5385 --- loss: 1.560293, loss_ss: 1.201674, loss_d: 0.358619
0.5769 --- loss: 1.991210, loss_ss: 1.345432, loss_d: 0.645778
0.6154 --- loss: 1.462683, loss_ss: 1.151887, loss_d: 0.310796
0.6538 --- loss: 1.393058, loss_ss: 1.090891, loss_d: 0.302167
0.6923 --- loss: 1.541739, loss_ss: 1.275832, loss_d: 0.265907
0.7308 --- loss: 1.484489, loss_ss: 1.058191, loss_d: 0.426299
0.7692 --- loss: 1.595075, loss_ss: 1.033837, loss_d: 0.561238
0.8077 --- loss: 1.509162, loss_ss: 0.863251, loss_d: 0.645911
0.8462 --- loss: 1.587094, loss_ss: 0.995877, loss_d: 0.591217
0.8846 --- loss: 1.492754, loss_ss: 1.086814, loss_d: 0.405940
0.9231 --- loss: 1.294901, loss_ss: 0.955189, loss_d: 0.339712
0.9615 --- loss: 1.926998, loss_ss: 1.274011, loss_d: 0.652987
Epoch finished! Loss: 1.600644825047968
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.677056, loss_ss: 1.058765, loss_d: 0.618291
0.0385 --- loss: 1.617794, loss_ss: 1.237264, loss_d: 0.380530
0.0769 --- loss: 1.169987, loss_ss: 0.843512, loss_d: 0.326475
0.1154 --- loss: 1.600760, loss_ss: 1.109590, loss_d: 0.491171
0.1538 --- loss: 1.874219, loss_ss: 1.142796, loss_d: 0.731423
0.1923 --- loss: 1.521202, loss_ss: 1.207304, loss_d: 0.313898
0.2308 --- loss: 1.092531, loss_ss: 0.892331, loss_d: 0.200199
0.2692 --- loss: 1.573219, loss_ss: 1.355681, loss_d: 0.217538
0.3077 --- loss: 1.784572, loss_ss: 1.371838, loss_d: 0.412734
0.3462 --- loss: 1.645623, loss_ss: 1.257662, loss_d: 0.387961
0.3846 --- loss: 1.833952, loss_ss: 1.082137, loss_d: 0.751815
0.4231 --- loss: 1.741901, loss_ss: 1.195176, loss_d: 0.546724
0.4615 --- loss: 1.371037, loss_ss: 1.043849, loss_d: 0.327188
0.5000 --- loss: 1.412411, loss_ss: 0.967229, loss_d: 0.445182
0.5385 --- loss: 1.475865, loss_ss: 1.093404, loss_d: 0.382461
0.5769 --- loss: 1.334374, loss_ss: 0.992931, loss_d: 0.341443
0.6154 --- loss: 1.530378, loss_ss: 1.009237, loss_d: 0.521141
0.6538 --- loss: 1.502653, loss_ss: 1.104593, loss_d: 0.398060
0.6923 --- loss: 1.635851, loss_ss: 1.075830, loss_d: 0.560021
0.7308 --- loss: 1.362827, loss_ss: 0.786559, loss_d: 0.576268
0.7692 --- loss: 1.354701, loss_ss: 1.040788, loss_d: 0.313913
0.8077 --- loss: 1.715117, loss_ss: 1.397828, loss_d: 0.317288
0.8462 --- loss: 1.145996, loss_ss: 0.909016, loss_d: 0.236980
0.8846 --- loss: 1.191644, loss_ss: 0.940118, loss_d: 0.251527
0.9231 --- loss: 1.437044, loss_ss: 1.101649, loss_d: 0.335395
0.9615 --- loss: 1.791465, loss_ss: 1.107400, loss_d: 0.684064
Epoch finished! Loss: 1.5621878797022992
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.999629, loss_ss: 0.927963, loss_d: 1.071666
0.0385 --- loss: 1.342525, loss_ss: 0.963417, loss_d: 0.379107
0.0769 --- loss: 1.550413, loss_ss: 0.954291, loss_d: 0.596122
0.1154 --- loss: 1.947812, loss_ss: 1.514491, loss_d: 0.433321
0.1538 --- loss: 1.819555, loss_ss: 1.141907, loss_d: 0.677648
0.1923 --- loss: 1.693079, loss_ss: 1.047072, loss_d: 0.646007
0.2308 --- loss: 1.635042, loss_ss: 1.277409, loss_d: 0.357633
0.2692 --- loss: 1.906540, loss_ss: 1.269941, loss_d: 0.636599
0.3077 --- loss: 2.246458, loss_ss: 1.131389, loss_d: 1.115069
0.3462 --- loss: 1.540249, loss_ss: 1.120790, loss_d: 0.419459
0.3846 --- loss: 1.507269, loss_ss: 1.124048, loss_d: 0.383221
0.4231 --- loss: 1.571984, loss_ss: 1.011555, loss_d: 0.560429
0.4615 --- loss: 1.291120, loss_ss: 1.061626, loss_d: 0.229494
0.5000 --- loss: 1.255273, loss_ss: 1.006516, loss_d: 0.248757
0.5385 --- loss: 1.477125, loss_ss: 1.052976, loss_d: 0.424148
0.5769 --- loss: 1.684108, loss_ss: 1.396505, loss_d: 0.287604
0.6154 --- loss: 2.052341, loss_ss: 1.398699, loss_d: 0.653642
0.6538 --- loss: 1.586869, loss_ss: 1.159750, loss_d: 0.427119
0.6923 --- loss: 1.610533, loss_ss: 1.406816, loss_d: 0.203717
0.7308 --- loss: 1.865423, loss_ss: 1.250718, loss_d: 0.614705
0.7692 --- loss: 1.526877, loss_ss: 1.263789, loss_d: 0.263088
0.8077 --- loss: 1.283076, loss_ss: 0.998031, loss_d: 0.285045
0.8462 --- loss: 2.004078, loss_ss: 1.176055, loss_d: 0.828024
0.8846 --- loss: 1.182011, loss_ss: 0.964850, loss_d: 0.217161
0.9231 --- loss: 1.623905, loss_ss: 1.268803, loss_d: 0.355102
0.9615 --- loss: 1.467634, loss_ss: 1.228191, loss_d: 0.239443
Epoch finished! Loss: 1.526290193027511
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.587611, loss_ss: 1.039481, loss_d: 0.548130
0.0385 --- loss: 1.539060, loss_ss: 1.110468, loss_d: 0.428592
0.0769 --- loss: 1.575672, loss_ss: 1.307462, loss_d: 0.268211
0.1154 --- loss: 1.510235, loss_ss: 1.119829, loss_d: 0.390406
0.1538 --- loss: 1.341210, loss_ss: 1.074998, loss_d: 0.266211
0.1923 --- loss: 1.284461, loss_ss: 0.932842, loss_d: 0.351619
0.2308 --- loss: 1.596082, loss_ss: 1.095236, loss_d: 0.500845
0.2692 --- loss: 1.447477, loss_ss: 1.117144, loss_d: 0.330334
0.3077 --- loss: 1.234152, loss_ss: 1.007376, loss_d: 0.226776
0.3462 --- loss: 1.805020, loss_ss: 1.159704, loss_d: 0.645316
0.3846 --- loss: 1.527679, loss_ss: 0.930269, loss_d: 0.597410
0.4231 --- loss: 1.650988, loss_ss: 1.331201, loss_d: 0.319787
0.4615 --- loss: 1.749256, loss_ss: 1.378964, loss_d: 0.370292
0.5000 --- loss: 1.968763, loss_ss: 1.047723, loss_d: 0.921041
0.5385 --- loss: 1.675590, loss_ss: 1.277456, loss_d: 0.398133
0.5769 --- loss: 1.470562, loss_ss: 0.983980, loss_d: 0.486582
0.6154 --- loss: 1.676099, loss_ss: 1.156759, loss_d: 0.519340
0.6538 --- loss: 1.326792, loss_ss: 0.921653, loss_d: 0.405138
0.6923 --- loss: 1.701948, loss_ss: 1.271482, loss_d: 0.430467
0.7308 --- loss: 1.455538, loss_ss: 1.003083, loss_d: 0.452455
0.7692 --- loss: 1.530301, loss_ss: 1.141037, loss_d: 0.389265
0.8077 --- loss: 1.282598, loss_ss: 0.960133, loss_d: 0.322465
0.8462 --- loss: 1.344214, loss_ss: 1.024076, loss_d: 0.320139
0.8846 --- loss: 1.901625, loss_ss: 1.204204, loss_d: 0.697420
0.9231 --- loss: 1.515969, loss_ss: 1.042392, loss_d: 0.473578
0.9615 --- loss: 1.521595, loss_ss: 1.008617, loss_d: 0.512978
Epoch finished! Loss: 1.5384111510280476
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.609328, loss_ss: 1.021662, loss_d: 0.587666
0.0385 --- loss: 1.633644, loss_ss: 1.258811, loss_d: 0.374833
0.0769 --- loss: 1.441210, loss_ss: 0.931327, loss_d: 0.509882
0.1154 --- loss: 1.340726, loss_ss: 1.051923, loss_d: 0.288804
0.1538 --- loss: 1.567891, loss_ss: 1.105198, loss_d: 0.462693
0.1923 --- loss: 1.383511, loss_ss: 1.074817, loss_d: 0.308694
0.2308 --- loss: 1.242581, loss_ss: 0.969290, loss_d: 0.273291
0.2692 --- loss: 1.116297, loss_ss: 0.799281, loss_d: 0.317016
0.3077 --- loss: 1.439342, loss_ss: 1.046803, loss_d: 0.392539
0.3462 --- loss: 1.759083, loss_ss: 1.473116, loss_d: 0.285967
0.3846 --- loss: 1.498950, loss_ss: 1.067601, loss_d: 0.431349
0.4231 --- loss: 1.801718, loss_ss: 1.147745, loss_d: 0.653973
0.4615 --- loss: 1.552927, loss_ss: 1.276929, loss_d: 0.275997
0.5000 --- loss: 1.214796, loss_ss: 0.967543, loss_d: 0.247253
0.5385 --- loss: 1.406263, loss_ss: 1.027744, loss_d: 0.378519
0.5769 --- loss: 1.385629, loss_ss: 0.963896, loss_d: 0.421732
0.6154 --- loss: 1.821995, loss_ss: 1.264304, loss_d: 0.557691
0.6538 --- loss: 1.140409, loss_ss: 0.839707, loss_d: 0.300703
0.6923 --- loss: 1.255380, loss_ss: 0.947251, loss_d: 0.308128
0.7308 --- loss: 1.221867, loss_ss: 0.923052, loss_d: 0.298815
0.7692 --- loss: 1.600853, loss_ss: 1.014615, loss_d: 0.586238
0.8077 --- loss: 1.602938, loss_ss: 1.174940, loss_d: 0.427999
0.8462 --- loss: 1.927199, loss_ss: 1.251193, loss_d: 0.676006
0.8846 --- loss: 1.388011, loss_ss: 1.008675, loss_d: 0.379336
0.9231 --- loss: 0.941783, loss_ss: 0.723531, loss_d: 0.218252
0.9615 --- loss: 2.031092, loss_ss: 1.253557, loss_d: 0.777536
Epoch finished! Loss: 1.4771469481663355
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.18947368421052632
             precision    recall  f1-score   support

        0.0       0.05      1.00      0.09        40
        1.0       0.00      0.00      0.00        79
        2.0       0.88      0.04      0.08       553
        3.0       0.53      0.77      0.63        69
        4.0       0.53      0.25      0.34       399

avg / total       0.65      0.19      0.20      1140
 


====== chp001-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  31.14  100.00   28.64   4.85      9.25
1  93.07    0.00  100.00   0.00      0.00
2  53.16    3.98   99.49  88.00      7.61
3  94.47   76.81   95.61  53.00     62.72
4  66.05   25.31   87.99  53.16     34.30
Total accuracy: 18.95%
Average sen: 41.22%
Average spec: 82.35%
Macro f1-score: 22.78%
[0.61387265 0.10496237 0.10751908 0.89496863 0.87530601 0.61670899
 0.71216124 0.81809092 0.73979563 0.89508867 0.78798509 0.9119072
 0.87685651 0.60774672 0.54089797 0.51295799 0.34730548 0.3119342
 0.7411781  0.49995685 0.53711885 0.71216601 0.7930063  0.80132282
 0.81848198 0.22973421 0.20170012 0.13550943 0.69056708 0.63683331
 0.73344779 0.46302176 0.27765629 0.22407715 0.25338599 0.87311482
 0.86993849 0.73118109]
pred: 0.5920911515621763, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.549868, loss_ss: 1.726602, loss_d: 0.823266
0.0384 --- loss: 2.357405, loss_ss: 1.764341, loss_d: 0.593063
0.0769 --- loss: 2.374427, loss_ss: 1.762320, loss_d: 0.612106
0.1153 --- loss: 2.461437, loss_ss: 1.715740, loss_d: 0.745697
0.1537 --- loss: 2.544177, loss_ss: 1.757559, loss_d: 0.786617
0.1922 --- loss: 2.354210, loss_ss: 1.619933, loss_d: 0.734277
0.2306 --- loss: 2.032484, loss_ss: 1.564774, loss_d: 0.467710
0.2690 --- loss: 2.246819, loss_ss: 1.700577, loss_d: 0.546243
0.3075 --- loss: 2.503335, loss_ss: 1.600857, loss_d: 0.902478
0.3459 --- loss: 2.175848, loss_ss: 1.687516, loss_d: 0.488331
0.3843 --- loss: 2.386172, loss_ss: 1.611144, loss_d: 0.775028
0.4228 --- loss: 2.130546, loss_ss: 1.626441, loss_d: 0.504105
0.4612 --- loss: 1.955992, loss_ss: 1.581676, loss_d: 0.374317
0.4996 --- loss: 2.211706, loss_ss: 1.642522, loss_d: 0.569184
0.5380 --- loss: 1.985453, loss_ss: 1.591018, loss_d: 0.394435
0.5765 --- loss: 2.247195, loss_ss: 1.603654, loss_d: 0.643542
0.6149 --- loss: 2.306401, loss_ss: 1.620750, loss_d: 0.685652
0.6533 --- loss: 1.977431, loss_ss: 1.629618, loss_d: 0.347814
0.6918 --- loss: 2.115084, loss_ss: 1.603072, loss_d: 0.512012
0.7302 --- loss: 2.127607, loss_ss: 1.406800, loss_d: 0.720807
0.7686 --- loss: 2.028624, loss_ss: 1.581566, loss_d: 0.447057
0.8071 --- loss: 2.226562, loss_ss: 1.691728, loss_d: 0.534834
0.8455 --- loss: 2.064267, loss_ss: 1.555580, loss_d: 0.508687
0.8839 --- loss: 2.012856, loss_ss: 1.409404, loss_d: 0.603451
0.9224 --- loss: 1.861669, loss_ss: 1.539569, loss_d: 0.322100
0.9608 --- loss: 1.973995, loss_ss: 1.643667, loss_d: 0.330328
0.9992 --- loss: 1.801232, loss_ss: 1.474191, loss_d: 0.327040
Epoch finished! Loss: 2.1765612583893996
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.113219, loss_ss: 1.467319, loss_d: 0.645900
0.0384 --- loss: 2.332121, loss_ss: 1.518882, loss_d: 0.813239
0.0769 --- loss: 2.010675, loss_ss: 1.520003, loss_d: 0.490672
0.1153 --- loss: 1.879418, loss_ss: 1.475376, loss_d: 0.404042
0.1537 --- loss: 2.003228, loss_ss: 1.450085, loss_d: 0.553144
0.1922 --- loss: 1.912652, loss_ss: 1.473293, loss_d: 0.439359
0.2306 --- loss: 2.283750, loss_ss: 1.507648, loss_d: 0.776102
0.2690 --- loss: 1.866583, loss_ss: 1.493816, loss_d: 0.372768
0.3075 --- loss: 2.190765, loss_ss: 1.395033, loss_d: 0.795733
0.3459 --- loss: 1.921387, loss_ss: 1.513076, loss_d: 0.408311
0.3843 --- loss: 2.174923, loss_ss: 1.743717, loss_d: 0.431207
0.4228 --- loss: 1.953356, loss_ss: 1.448416, loss_d: 0.504939
0.4612 --- loss: 2.042271, loss_ss: 1.505871, loss_d: 0.536400
0.4996 --- loss: 1.954184, loss_ss: 1.484961, loss_d: 0.469223
0.5380 --- loss: 1.940243, loss_ss: 1.490244, loss_d: 0.449999
0.5765 --- loss: 1.866796, loss_ss: 1.473579, loss_d: 0.393217
0.6149 --- loss: 1.963375, loss_ss: 1.461293, loss_d: 0.502083
0.6533 --- loss: 1.827623, loss_ss: 1.437245, loss_d: 0.390378
0.6918 --- loss: 2.144771, loss_ss: 1.510419, loss_d: 0.634352
0.7302 --- loss: 1.991327, loss_ss: 1.397374, loss_d: 0.593953
0.7686 --- loss: 1.814150, loss_ss: 1.322853, loss_d: 0.491296
0.8071 --- loss: 1.651304, loss_ss: 1.399395, loss_d: 0.251908
0.8455 --- loss: 1.800430, loss_ss: 1.486959, loss_d: 0.313471
0.8839 --- loss: 1.816830, loss_ss: 1.450390, loss_d: 0.366440
0.9224 --- loss: 1.954165, loss_ss: 1.607593, loss_d: 0.346572
0.9608 --- loss: 1.909057, loss_ss: 1.514920, loss_d: 0.394138
0.9992 --- loss: 1.564200, loss_ss: 1.206707, loss_d: 0.357493
Epoch finished! Loss: 2.0382831449692067
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.011658, loss_ss: 1.658236, loss_d: 0.353423
0.0384 --- loss: 2.269548, loss_ss: 1.811286, loss_d: 0.458262
0.0769 --- loss: 1.863895, loss_ss: 1.420934, loss_d: 0.442960
0.1153 --- loss: 1.839757, loss_ss: 1.369024, loss_d: 0.470733
0.1537 --- loss: 1.852754, loss_ss: 1.467530, loss_d: 0.385224
0.1922 --- loss: 1.967908, loss_ss: 1.580845, loss_d: 0.387063
0.2306 --- loss: 2.006105, loss_ss: 1.655411, loss_d: 0.350695
0.2690 --- loss: 2.532179, loss_ss: 1.281086, loss_d: 1.251093
0.3075 --- loss: 2.175865, loss_ss: 1.580032, loss_d: 0.595834
0.3459 --- loss: 1.975719, loss_ss: 1.526477, loss_d: 0.449242
0.3843 --- loss: 2.070681, loss_ss: 1.475827, loss_d: 0.594854
0.4228 --- loss: 1.933794, loss_ss: 1.349463, loss_d: 0.584331
0.4612 --- loss: 1.937759, loss_ss: 1.451094, loss_d: 0.486664
0.4996 --- loss: 1.800041, loss_ss: 1.370640, loss_d: 0.429401
0.5380 --- loss: 1.977722, loss_ss: 1.550503, loss_d: 0.427219
0.5765 --- loss: 2.041597, loss_ss: 1.605479, loss_d: 0.436118
0.6149 --- loss: 1.942275, loss_ss: 1.522967, loss_d: 0.419308
0.6533 --- loss: 2.056275, loss_ss: 1.514040, loss_d: 0.542235
0.6918 --- loss: 2.099636, loss_ss: 1.405662, loss_d: 0.693974
0.7302 --- loss: 1.832828, loss_ss: 1.486097, loss_d: 0.346730
0.7686 --- loss: 2.024442, loss_ss: 1.547884, loss_d: 0.476557
0.8071 --- loss: 1.981076, loss_ss: 1.455373, loss_d: 0.525703
0.8455 --- loss: 1.952150, loss_ss: 1.437827, loss_d: 0.514323
0.8839 --- loss: 1.972598, loss_ss: 1.611884, loss_d: 0.360714
0.9224 --- loss: 2.018378, loss_ss: 1.438089, loss_d: 0.580289
0.9608 --- loss: 1.872381, loss_ss: 1.216628, loss_d: 0.655753
0.9992 --- loss: 1.762058, loss_ss: 1.380569, loss_d: 0.381488
Epoch finished! Loss: 1.957092081124966
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.739405, loss_ss: 1.268668, loss_d: 0.470737
0.0384 --- loss: 2.122413, loss_ss: 1.622798, loss_d: 0.499615
0.0769 --- loss: 1.785875, loss_ss: 1.329982, loss_d: 0.455892
0.1153 --- loss: 2.236671, loss_ss: 1.647814, loss_d: 0.588857
0.1537 --- loss: 1.767505, loss_ss: 1.146072, loss_d: 0.621434
0.1922 --- loss: 1.902552, loss_ss: 1.303218, loss_d: 0.599334
0.2306 --- loss: 1.646522, loss_ss: 1.240713, loss_d: 0.405809
0.2690 --- loss: 1.918843, loss_ss: 1.372366, loss_d: 0.546477
0.3075 --- loss: 1.769503, loss_ss: 1.368744, loss_d: 0.400759
0.3459 --- loss: 1.555693, loss_ss: 1.155760, loss_d: 0.399934
0.3843 --- loss: 1.777427, loss_ss: 1.351023, loss_d: 0.426405
0.4228 --- loss: 1.686182, loss_ss: 1.228376, loss_d: 0.457806
0.4612 --- loss: 1.738138, loss_ss: 1.326968, loss_d: 0.411170
0.4996 --- loss: 1.633766, loss_ss: 1.228798, loss_d: 0.404968
0.5380 --- loss: 2.340771, loss_ss: 1.249376, loss_d: 1.091395
0.5765 --- loss: 1.665674, loss_ss: 1.070799, loss_d: 0.594875
0.6149 --- loss: 1.921538, loss_ss: 1.440139, loss_d: 0.481399
0.6533 --- loss: 1.907497, loss_ss: 1.275605, loss_d: 0.631892
0.6918 --- loss: 1.564821, loss_ss: 1.131052, loss_d: 0.433769
0.7302 --- loss: 1.513703, loss_ss: 1.236949, loss_d: 0.276753
0.7686 --- loss: 1.928771, loss_ss: 1.301872, loss_d: 0.626899
0.8071 --- loss: 1.936599, loss_ss: 1.084939, loss_d: 0.851660
0.8455 --- loss: 1.773464, loss_ss: 1.337282, loss_d: 0.436182
0.8839 --- loss: 2.020008, loss_ss: 1.196344, loss_d: 0.823664
0.9224 --- loss: 1.568069, loss_ss: 1.184752, loss_d: 0.383317
0.9608 --- loss: 1.593792, loss_ss: 1.109593, loss_d: 0.484199
0.9992 --- loss: 1.638969, loss_ss: 1.342289, loss_d: 0.296680
Epoch finished! Loss: 1.8434658862077273
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.797175, loss_ss: 1.222868, loss_d: 0.574307
0.0384 --- loss: 1.974920, loss_ss: 1.562328, loss_d: 0.412593
0.0769 --- loss: 1.602654, loss_ss: 1.060821, loss_d: 0.541833
0.1153 --- loss: 1.970238, loss_ss: 1.476234, loss_d: 0.494004
0.1537 --- loss: 1.590793, loss_ss: 1.131460, loss_d: 0.459333
0.1922 --- loss: 1.835271, loss_ss: 1.283274, loss_d: 0.551997
0.2306 --- loss: 1.684106, loss_ss: 1.151281, loss_d: 0.532825
0.2690 --- loss: 1.749586, loss_ss: 1.311903, loss_d: 0.437683
0.3075 --- loss: 1.717235, loss_ss: 1.398892, loss_d: 0.318343
0.3459 --- loss: 1.902879, loss_ss: 1.448729, loss_d: 0.454150
0.3843 --- loss: 1.692514, loss_ss: 1.308511, loss_d: 0.384003
0.4228 --- loss: 1.877477, loss_ss: 1.187525, loss_d: 0.689952
0.4612 --- loss: 1.636132, loss_ss: 1.197468, loss_d: 0.438664
0.4996 --- loss: 1.750617, loss_ss: 1.217268, loss_d: 0.533349
0.5380 --- loss: 1.845901, loss_ss: 1.120307, loss_d: 0.725594
0.5765 --- loss: 1.915635, loss_ss: 1.463272, loss_d: 0.452363
0.6149 --- loss: 1.661333, loss_ss: 1.149829, loss_d: 0.511504
0.6533 --- loss: 2.034614, loss_ss: 1.570196, loss_d: 0.464418
0.6918 --- loss: 1.702965, loss_ss: 1.388022, loss_d: 0.314942
0.7302 --- loss: 1.595481, loss_ss: 1.130249, loss_d: 0.465232
0.7686 --- loss: 1.634209, loss_ss: 1.117792, loss_d: 0.516417
0.8071 --- loss: 1.971663, loss_ss: 1.685630, loss_d: 0.286034
0.8455 --- loss: 1.771292, loss_ss: 1.267452, loss_d: 0.503840
0.8839 --- loss: 1.564842, loss_ss: 1.229319, loss_d: 0.335523
0.9224 --- loss: 1.544224, loss_ss: 1.255877, loss_d: 0.288346
0.9608 --- loss: 1.449595, loss_ss: 1.109279, loss_d: 0.340316
0.9992 --- loss: 1.979069, loss_ss: 1.615638, loss_d: 0.363430
Epoch finished! Loss: 1.7308782811348256
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.902755, loss_ss: 1.392523, loss_d: 0.510232
0.0384 --- loss: 1.477845, loss_ss: 0.976845, loss_d: 0.501000
0.0769 --- loss: 1.436085, loss_ss: 1.143546, loss_d: 0.292539
0.1153 --- loss: 2.260158, loss_ss: 1.367123, loss_d: 0.893035
0.1537 --- loss: 1.573410, loss_ss: 1.091240, loss_d: 0.482171
0.1922 --- loss: 1.750064, loss_ss: 1.245051, loss_d: 0.505013
0.2306 --- loss: 1.630642, loss_ss: 1.194572, loss_d: 0.436070
0.2690 --- loss: 1.605891, loss_ss: 0.922189, loss_d: 0.683701
0.3075 --- loss: 1.264637, loss_ss: 0.932597, loss_d: 0.332040
0.3459 --- loss: 1.410914, loss_ss: 0.877150, loss_d: 0.533765
0.3843 --- loss: 1.592108, loss_ss: 1.188741, loss_d: 0.403368
0.4228 --- loss: 1.497236, loss_ss: 1.115105, loss_d: 0.382131
0.4612 --- loss: 1.809512, loss_ss: 1.260365, loss_d: 0.549147
0.4996 --- loss: 1.572775, loss_ss: 1.228279, loss_d: 0.344495
0.5380 --- loss: 1.566653, loss_ss: 1.137465, loss_d: 0.429187
0.5765 --- loss: 1.828919, loss_ss: 1.109655, loss_d: 0.719263
0.6149 --- loss: 1.813671, loss_ss: 1.009076, loss_d: 0.804595
0.6533 --- loss: 1.672809, loss_ss: 1.153115, loss_d: 0.519694
0.6918 --- loss: 1.667452, loss_ss: 1.191157, loss_d: 0.476295
0.7302 --- loss: 1.547044, loss_ss: 1.018271, loss_d: 0.528774
0.7686 --- loss: 1.526593, loss_ss: 1.129549, loss_d: 0.397044
0.8071 --- loss: 1.402880, loss_ss: 0.927576, loss_d: 0.475304
0.8455 --- loss: 1.721125, loss_ss: 1.173199, loss_d: 0.547926
0.8839 --- loss: 1.489053, loss_ss: 1.051625, loss_d: 0.437428
0.9224 --- loss: 1.456226, loss_ss: 1.103503, loss_d: 0.352722
0.9608 --- loss: 1.645227, loss_ss: 1.138222, loss_d: 0.507005
0.9992 --- loss: 2.563855, loss_ss: 2.209287, loss_d: 0.354568
Epoch finished! Loss: 1.6932071186028994
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.636566, loss_ss: 1.284628, loss_d: 0.351938
0.0384 --- loss: 1.850893, loss_ss: 1.366337, loss_d: 0.484556
0.0769 --- loss: 1.524702, loss_ss: 1.091773, loss_d: 0.432929
0.1153 --- loss: 1.331368, loss_ss: 0.999516, loss_d: 0.331852
0.1537 --- loss: 1.618956, loss_ss: 1.178764, loss_d: 0.440191
0.1922 --- loss: 1.376673, loss_ss: 0.960719, loss_d: 0.415955
0.2306 --- loss: 1.469242, loss_ss: 1.086765, loss_d: 0.382477
0.2690 --- loss: 1.626820, loss_ss: 1.244959, loss_d: 0.381861
0.3075 --- loss: 1.696867, loss_ss: 1.074360, loss_d: 0.622507
0.3459 --- loss: 1.539824, loss_ss: 1.151188, loss_d: 0.388636
0.3843 --- loss: 1.436114, loss_ss: 1.068361, loss_d: 0.367754
0.4228 --- loss: 1.678463, loss_ss: 1.213181, loss_d: 0.465282
0.4612 --- loss: 1.518209, loss_ss: 1.140938, loss_d: 0.377270
0.4996 --- loss: 1.345407, loss_ss: 1.047464, loss_d: 0.297943
0.5380 --- loss: 1.839695, loss_ss: 1.489262, loss_d: 0.350433
0.5765 --- loss: 1.521816, loss_ss: 1.119840, loss_d: 0.401976
0.6149 --- loss: 1.792727, loss_ss: 1.150307, loss_d: 0.642420
0.6533 --- loss: 1.502574, loss_ss: 1.142712, loss_d: 0.359862
0.6918 --- loss: 1.405208, loss_ss: 1.056324, loss_d: 0.348883
0.7302 --- loss: 1.811149, loss_ss: 1.145225, loss_d: 0.665924
0.7686 --- loss: 1.970725, loss_ss: 1.206065, loss_d: 0.764659
0.8071 --- loss: 1.932057, loss_ss: 1.201260, loss_d: 0.730797
0.8455 --- loss: 1.663342, loss_ss: 1.149670, loss_d: 0.513672
0.8839 --- loss: 1.324302, loss_ss: 0.980109, loss_d: 0.344193
0.9224 --- loss: 1.359597, loss_ss: 1.023411, loss_d: 0.336186
0.9608 --- loss: 1.965994, loss_ss: 1.468466, loss_d: 0.497528
0.9992 --- loss: 1.622147, loss_ss: 1.303829, loss_d: 0.318317
Epoch finished! Loss: 1.6443548252949347
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.755628, loss_ss: 1.118823, loss_d: 0.636805
0.0384 --- loss: 1.677665, loss_ss: 1.281932, loss_d: 0.395733
0.0769 --- loss: 1.406225, loss_ss: 0.971815, loss_d: 0.434410
0.1153 --- loss: 1.690976, loss_ss: 1.079211, loss_d: 0.611765
0.1537 --- loss: 1.464133, loss_ss: 1.093625, loss_d: 0.370507
0.1922 --- loss: 1.632366, loss_ss: 1.213201, loss_d: 0.419165
0.2306 --- loss: 1.892410, loss_ss: 1.377200, loss_d: 0.515210
0.2690 --- loss: 1.500093, loss_ss: 1.114566, loss_d: 0.385528
0.3075 --- loss: 1.696214, loss_ss: 1.147627, loss_d: 0.548587
0.3459 --- loss: 1.447424, loss_ss: 1.078400, loss_d: 0.369024
0.3843 --- loss: 1.530332, loss_ss: 0.959545, loss_d: 0.570787
0.4228 --- loss: 1.757701, loss_ss: 1.179533, loss_d: 0.578168
0.4612 --- loss: 1.593454, loss_ss: 1.006521, loss_d: 0.586933
0.4996 --- loss: 1.729182, loss_ss: 1.331822, loss_d: 0.397360
0.5380 --- loss: 1.331230, loss_ss: 0.965068, loss_d: 0.366163
0.5765 --- loss: 1.805251, loss_ss: 1.460562, loss_d: 0.344690
0.6149 --- loss: 1.381444, loss_ss: 0.970772, loss_d: 0.410672
0.6533 --- loss: 1.480831, loss_ss: 1.011405, loss_d: 0.469425
0.6918 --- loss: 1.381895, loss_ss: 1.077620, loss_d: 0.304275
0.7302 --- loss: 1.641614, loss_ss: 1.336641, loss_d: 0.304973
0.7686 --- loss: 1.636733, loss_ss: 1.160544, loss_d: 0.476190
0.8071 --- loss: 1.674880, loss_ss: 1.244053, loss_d: 0.430827
0.8455 --- loss: 1.690159, loss_ss: 1.248005, loss_d: 0.442154
0.8839 --- loss: 1.275922, loss_ss: 0.895642, loss_d: 0.380280
0.9224 --- loss: 1.693254, loss_ss: 1.080784, loss_d: 0.612471
0.9608 --- loss: 1.620117, loss_ss: 1.061967, loss_d: 0.558150
0.9992 --- loss: 1.203077, loss_ss: 0.817695, loss_d: 0.385382
Epoch finished! Loss: 1.6215846699017744
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.613349, loss_ss: 1.255555, loss_d: 0.357794
0.0384 --- loss: 1.352008, loss_ss: 0.993141, loss_d: 0.358866
0.0769 --- loss: 1.453315, loss_ss: 1.227922, loss_d: 0.225393
0.1153 --- loss: 1.307878, loss_ss: 0.914291, loss_d: 0.393587
0.1537 --- loss: 1.399866, loss_ss: 0.952290, loss_d: 0.447576
0.1922 --- loss: 1.735430, loss_ss: 1.352458, loss_d: 0.382972
0.2306 --- loss: 2.115588, loss_ss: 1.305147, loss_d: 0.810441
0.2690 --- loss: 1.660855, loss_ss: 1.293306, loss_d: 0.367550
0.3075 --- loss: 1.410874, loss_ss: 1.058809, loss_d: 0.352065
0.3459 --- loss: 1.671846, loss_ss: 1.116794, loss_d: 0.555052
0.3843 --- loss: 1.325320, loss_ss: 1.033087, loss_d: 0.292233
0.4228 --- loss: 1.774001, loss_ss: 1.404078, loss_d: 0.369924
0.4612 --- loss: 1.528875, loss_ss: 1.021207, loss_d: 0.507668
0.4996 --- loss: 1.798800, loss_ss: 1.207087, loss_d: 0.591713
0.5380 --- loss: 1.430415, loss_ss: 0.944336, loss_d: 0.486079
0.5765 --- loss: 1.769624, loss_ss: 1.184649, loss_d: 0.584975
0.6149 --- loss: 1.804850, loss_ss: 1.221460, loss_d: 0.583390
0.6533 --- loss: 1.664907, loss_ss: 1.245042, loss_d: 0.419866
0.6918 --- loss: 1.513626, loss_ss: 1.126370, loss_d: 0.387255
0.7302 --- loss: 1.435878, loss_ss: 1.030051, loss_d: 0.405827
0.7686 --- loss: 1.267433, loss_ss: 0.976391, loss_d: 0.291043
0.8071 --- loss: 1.720480, loss_ss: 1.229822, loss_d: 0.490658
0.8455 --- loss: 1.514709, loss_ss: 1.172237, loss_d: 0.342472
0.8839 --- loss: 1.334558, loss_ss: 0.848301, loss_d: 0.486257
0.9224 --- loss: 1.452365, loss_ss: 1.104017, loss_d: 0.348348
0.9608 --- loss: 1.702306, loss_ss: 1.241271, loss_d: 0.461035
0.9992 --- loss: 2.510699, loss_ss: 2.175251, loss_d: 0.335448
Epoch finished! Loss: 1.5847857984212728
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.271240, loss_ss: 1.128013, loss_d: 1.143227
0.0384 --- loss: 1.489361, loss_ss: 1.184660, loss_d: 0.304701
0.0769 --- loss: 1.834828, loss_ss: 1.189482, loss_d: 0.645346
0.1153 --- loss: 1.502339, loss_ss: 0.963867, loss_d: 0.538472
0.1537 --- loss: 1.532857, loss_ss: 0.939870, loss_d: 0.592987
0.1922 --- loss: 1.492692, loss_ss: 1.189145, loss_d: 0.303547
0.2306 --- loss: 1.692218, loss_ss: 0.841642, loss_d: 0.850575
0.2690 --- loss: 1.284234, loss_ss: 0.913059, loss_d: 0.371175
0.3075 --- loss: 2.140857, loss_ss: 1.071513, loss_d: 1.069344
0.3459 --- loss: 1.505489, loss_ss: 1.084132, loss_d: 0.421358
0.3843 --- loss: 1.885873, loss_ss: 1.188349, loss_d: 0.697524
0.4228 --- loss: 1.719648, loss_ss: 1.091456, loss_d: 0.628192
0.4612 --- loss: 1.803415, loss_ss: 1.025276, loss_d: 0.778140
0.4996 --- loss: 1.673745, loss_ss: 0.989972, loss_d: 0.683773
0.5380 --- loss: 1.942884, loss_ss: 1.175065, loss_d: 0.767818
0.5765 --- loss: 1.548749, loss_ss: 1.074489, loss_d: 0.474260
0.6149 --- loss: 1.473288, loss_ss: 1.155225, loss_d: 0.318062
0.6533 --- loss: 1.254968, loss_ss: 0.863643, loss_d: 0.391325
0.6918 --- loss: 1.409330, loss_ss: 1.068386, loss_d: 0.340944
0.7302 --- loss: 1.536383, loss_ss: 1.216383, loss_d: 0.320000
0.7686 --- loss: 1.457426, loss_ss: 1.040316, loss_d: 0.417110
0.8071 --- loss: 1.547050, loss_ss: 1.008983, loss_d: 0.538067
0.8455 --- loss: 1.758566, loss_ss: 1.415421, loss_d: 0.343145
0.8839 --- loss: 2.413516, loss_ss: 1.938095, loss_d: 0.475421
0.9224 --- loss: 1.403054, loss_ss: 1.000390, loss_d: 0.402663
0.9608 --- loss: 1.986351, loss_ss: 1.434759, loss_d: 0.551592
0.9992 --- loss: 1.996859, loss_ss: 1.117369, loss_d: 0.879490
Epoch finished! Loss: 1.5539228205497448
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.37777777777777777
             precision    recall  f1-score   support

        0.0       1.00      0.10      0.18       260
        1.0       0.00      0.00      0.00       248
        2.0       0.37      1.00      0.54       375
        3.0       0.83      0.03      0.06       169
        4.0       0.07      0.07      0.07        28

avg / total       0.50      0.38      0.24      1080
 


====== chp002-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %   ppr %  f1-score
0  78.33   10.00  100.00  100.00     18.18
1  77.04    0.00  100.00    0.00      0.00
2  40.19  100.00    8.37   36.73     53.72
3  84.72    2.96   99.89   83.33      5.71
4  95.28    7.14   97.62    7.41      7.27
Total accuracy: 37.78%
Average sen: 24.02%
Average spec: 81.18%
Macro f1-score: 16.98%
[0.47571263 0.5028246  0.53176665 0.52764028 0.52667952 0.52061743
 0.50517964 0.50270218 0.49946156 0.5139997  0.50701594 0.50590235
 0.47984621 0.48934326 0.50284851 0.49623621 0.51970339 0.52348995
 0.52831733 0.52030879 0.47327915 0.4912841  0.49539518 0.51269644
 0.51375902 0.50032121 0.49114791 0.51013023 0.51691175 0.52314544
 0.490731   0.47982803 0.45486808 0.50126505 0.51443356 0.51540536]
pred: 0.5045610451036029, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.257158, loss_ss: 1.588352, loss_d: 0.668805
0.0384 --- loss: 1.816937, loss_ss: 1.481721, loss_d: 0.335216
0.0768 --- loss: 2.004953, loss_ss: 1.499534, loss_d: 0.505419
0.1152 --- loss: 2.297152, loss_ss: 1.795609, loss_d: 0.501543
0.1536 --- loss: 2.515251, loss_ss: 1.474379, loss_d: 1.040872
0.1919 --- loss: 1.871463, loss_ss: 1.284673, loss_d: 0.586790
0.2303 --- loss: 2.373762, loss_ss: 1.577501, loss_d: 0.796260
0.2687 --- loss: 2.317390, loss_ss: 1.713828, loss_d: 0.603562
0.3071 --- loss: 2.104844, loss_ss: 1.392765, loss_d: 0.712079
0.3455 --- loss: 2.058086, loss_ss: 1.267774, loss_d: 0.790312
0.3839 --- loss: 2.316246, loss_ss: 1.511470, loss_d: 0.804776
0.4223 --- loss: 2.130337, loss_ss: 1.764084, loss_d: 0.366252
0.4607 --- loss: 1.915513, loss_ss: 1.418049, loss_d: 0.497464
0.4990 --- loss: 2.051211, loss_ss: 1.413878, loss_d: 0.637332
0.5374 --- loss: 1.921423, loss_ss: 1.371718, loss_d: 0.549705
0.5758 --- loss: 2.405296, loss_ss: 1.785324, loss_d: 0.619972
0.6142 --- loss: 2.240485, loss_ss: 1.605882, loss_d: 0.634603
0.6526 --- loss: 2.151332, loss_ss: 1.529499, loss_d: 0.621833
0.6910 --- loss: 2.018544, loss_ss: 1.503009, loss_d: 0.515535
0.7294 --- loss: 1.772604, loss_ss: 1.241266, loss_d: 0.531338
0.7678 --- loss: 2.063786, loss_ss: 1.626209, loss_d: 0.437578
0.8061 --- loss: 2.109907, loss_ss: 1.361059, loss_d: 0.748848
0.8445 --- loss: 1.747720, loss_ss: 1.410770, loss_d: 0.336950
0.8829 --- loss: 1.845370, loss_ss: 1.481568, loss_d: 0.363802
0.9213 --- loss: 1.825406, loss_ss: 1.391354, loss_d: 0.434052
0.9597 --- loss: 2.148357, loss_ss: 1.566384, loss_d: 0.581973
0.9981 --- loss: 2.067826, loss_ss: 1.507434, loss_d: 0.560392
Epoch finished! Loss: 2.0957270938616532
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.095703, loss_ss: 1.517537, loss_d: 0.578166
0.0384 --- loss: 1.996949, loss_ss: 1.475789, loss_d: 0.521161
0.0768 --- loss: 2.004995, loss_ss: 1.478094, loss_d: 0.526901
0.1152 --- loss: 2.005367, loss_ss: 1.376537, loss_d: 0.628829
0.1536 --- loss: 2.336346, loss_ss: 1.670422, loss_d: 0.665924
0.1919 --- loss: 1.675795, loss_ss: 1.292485, loss_d: 0.383311
0.2303 --- loss: 2.178483, loss_ss: 1.476533, loss_d: 0.701950
0.2687 --- loss: 1.798523, loss_ss: 1.282349, loss_d: 0.516174
0.3071 --- loss: 1.928777, loss_ss: 1.466912, loss_d: 0.461865
0.3455 --- loss: 2.145494, loss_ss: 1.286760, loss_d: 0.858734
0.3839 --- loss: 1.946385, loss_ss: 1.414920, loss_d: 0.531465
0.4223 --- loss: 1.918508, loss_ss: 1.578434, loss_d: 0.340073
0.4607 --- loss: 1.835999, loss_ss: 1.451520, loss_d: 0.384479
0.4990 --- loss: 2.134938, loss_ss: 1.494525, loss_d: 0.640413
0.5374 --- loss: 1.626054, loss_ss: 1.163189, loss_d: 0.462864
0.5758 --- loss: 1.714939, loss_ss: 1.373169, loss_d: 0.341770
0.6142 --- loss: 2.001444, loss_ss: 1.349875, loss_d: 0.651569
0.6526 --- loss: 2.137922, loss_ss: 1.440673, loss_d: 0.697249
0.6910 --- loss: 2.101956, loss_ss: 1.300434, loss_d: 0.801522
0.7294 --- loss: 1.780929, loss_ss: 1.267590, loss_d: 0.513339
0.7678 --- loss: 1.767709, loss_ss: 1.341152, loss_d: 0.426558
0.8061 --- loss: 1.871579, loss_ss: 1.381847, loss_d: 0.489732
0.8445 --- loss: 1.924862, loss_ss: 1.305157, loss_d: 0.619705
0.8829 --- loss: 1.702808, loss_ss: 1.287159, loss_d: 0.415649
0.9213 --- loss: 1.709399, loss_ss: 1.067524, loss_d: 0.641875
0.9597 --- loss: 1.519606, loss_ss: 1.199049, loss_d: 0.320557
0.9981 --- loss: 2.906289, loss_ss: 1.122801, loss_d: 1.783487
Epoch finished! Loss: 1.9247997971681448
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.016723, loss_ss: 1.554963, loss_d: 0.461760
0.0384 --- loss: 1.675338, loss_ss: 1.182614, loss_d: 0.492723
0.0768 --- loss: 1.694973, loss_ss: 1.187338, loss_d: 0.507635
0.1152 --- loss: 1.711546, loss_ss: 1.248094, loss_d: 0.463452
0.1536 --- loss: 1.721314, loss_ss: 1.194544, loss_d: 0.526770
0.1919 --- loss: 1.824740, loss_ss: 1.310577, loss_d: 0.514163
0.2303 --- loss: 1.632461, loss_ss: 1.251312, loss_d: 0.381149
0.2687 --- loss: 1.653639, loss_ss: 1.281930, loss_d: 0.371710
0.3071 --- loss: 1.676975, loss_ss: 1.142344, loss_d: 0.534632
0.3455 --- loss: 1.877683, loss_ss: 1.343951, loss_d: 0.533731
0.3839 --- loss: 1.635502, loss_ss: 1.201295, loss_d: 0.434207
0.4223 --- loss: 1.926744, loss_ss: 1.349889, loss_d: 0.576855
0.4607 --- loss: 1.493566, loss_ss: 1.145574, loss_d: 0.347992
0.4990 --- loss: 1.568674, loss_ss: 1.184288, loss_d: 0.384386
0.5374 --- loss: 1.857525, loss_ss: 1.326857, loss_d: 0.530667
0.5758 --- loss: 1.969642, loss_ss: 1.535914, loss_d: 0.433729
0.6142 --- loss: 2.873180, loss_ss: 1.236126, loss_d: 1.637053
0.6526 --- loss: 2.095499, loss_ss: 1.604182, loss_d: 0.491317
0.6910 --- loss: 2.024832, loss_ss: 1.374639, loss_d: 0.650193
0.7294 --- loss: 1.691916, loss_ss: 1.283371, loss_d: 0.408545
0.7678 --- loss: 1.624464, loss_ss: 1.266724, loss_d: 0.357741
0.8061 --- loss: 2.187291, loss_ss: 1.666382, loss_d: 0.520909
0.8445 --- loss: 1.579078, loss_ss: 1.223948, loss_d: 0.355130
0.8829 --- loss: 1.491828, loss_ss: 1.048993, loss_d: 0.442835
0.9213 --- loss: 2.310299, loss_ss: 1.427751, loss_d: 0.882549
0.9597 --- loss: 1.624007, loss_ss: 1.187234, loss_d: 0.436774
0.9981 --- loss: 1.440376, loss_ss: 1.116416, loss_d: 0.323960
Epoch finished! Loss: 1.7799080083003411
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.695991, loss_ss: 1.149578, loss_d: 0.546413
0.0384 --- loss: 1.568046, loss_ss: 1.202657, loss_d: 0.365389
0.0768 --- loss: 1.729162, loss_ss: 1.219695, loss_d: 0.509467
0.1152 --- loss: 1.879274, loss_ss: 1.407545, loss_d: 0.471729
0.1536 --- loss: 1.621289, loss_ss: 1.257752, loss_d: 0.363537
0.1919 --- loss: 1.439576, loss_ss: 1.070356, loss_d: 0.369220
0.2303 --- loss: 1.626024, loss_ss: 1.191048, loss_d: 0.434977
0.2687 --- loss: 1.765895, loss_ss: 1.387213, loss_d: 0.378682
0.3071 --- loss: 1.802268, loss_ss: 1.268683, loss_d: 0.533585
0.3455 --- loss: 2.522544, loss_ss: 1.270261, loss_d: 1.252283
0.3839 --- loss: 2.108047, loss_ss: 1.410604, loss_d: 0.697443
0.4223 --- loss: 1.474841, loss_ss: 1.014469, loss_d: 0.460372
0.4607 --- loss: 1.711009, loss_ss: 1.181260, loss_d: 0.529749
0.4990 --- loss: 1.641575, loss_ss: 1.206917, loss_d: 0.434657
0.5374 --- loss: 1.571141, loss_ss: 1.128548, loss_d: 0.442593
0.5758 --- loss: 1.645273, loss_ss: 1.194739, loss_d: 0.450535
0.6142 --- loss: 1.481496, loss_ss: 1.129948, loss_d: 0.351548
0.6526 --- loss: 1.584217, loss_ss: 1.166828, loss_d: 0.417389
0.6910 --- loss: 2.177540, loss_ss: 1.338109, loss_d: 0.839431
0.7294 --- loss: 1.912364, loss_ss: 1.177787, loss_d: 0.734576
0.7678 --- loss: 1.547941, loss_ss: 1.205208, loss_d: 0.342732
0.8061 --- loss: 1.225904, loss_ss: 0.919463, loss_d: 0.306441
0.8445 --- loss: 1.744295, loss_ss: 1.196988, loss_d: 0.547307
0.8829 --- loss: 1.754185, loss_ss: 1.334511, loss_d: 0.419675
0.9213 --- loss: 1.464326, loss_ss: 1.110513, loss_d: 0.353813
0.9597 --- loss: 1.865580, loss_ss: 1.442398, loss_d: 0.423182
0.9981 --- loss: 1.270478, loss_ss: 0.954787, loss_d: 0.315691
Epoch finished! Loss: 1.6765501201152802
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.888918, loss_ss: 1.364570, loss_d: 0.524348
0.0384 --- loss: 1.732436, loss_ss: 1.248299, loss_d: 0.484136
0.0768 --- loss: 1.911218, loss_ss: 1.242519, loss_d: 0.668699
0.1152 --- loss: 1.497468, loss_ss: 1.076030, loss_d: 0.421438
0.1536 --- loss: 1.368320, loss_ss: 1.038828, loss_d: 0.329493
0.1919 --- loss: 1.851566, loss_ss: 1.446352, loss_d: 0.405214
0.2303 --- loss: 1.258283, loss_ss: 0.792933, loss_d: 0.465350
0.2687 --- loss: 1.384095, loss_ss: 1.014765, loss_d: 0.369330
0.3071 --- loss: 1.405738, loss_ss: 1.025628, loss_d: 0.380110
0.3455 --- loss: 1.722879, loss_ss: 1.304828, loss_d: 0.418051
0.3839 --- loss: 1.832226, loss_ss: 1.324208, loss_d: 0.508017
0.4223 --- loss: 1.564214, loss_ss: 1.171759, loss_d: 0.392455
0.4607 --- loss: 1.899263, loss_ss: 0.919089, loss_d: 0.980174
0.4990 --- loss: 1.905666, loss_ss: 1.391006, loss_d: 0.514660
0.5374 --- loss: 1.713365, loss_ss: 1.000072, loss_d: 0.713293
0.5758 --- loss: 1.458882, loss_ss: 1.118337, loss_d: 0.340544
0.6142 --- loss: 1.491598, loss_ss: 1.178460, loss_d: 0.313138
0.6526 --- loss: 1.267427, loss_ss: 0.979369, loss_d: 0.288059
0.6910 --- loss: 1.653147, loss_ss: 1.134557, loss_d: 0.518590
0.7294 --- loss: 1.366641, loss_ss: 1.099140, loss_d: 0.267501
0.7678 --- loss: 1.596506, loss_ss: 0.810570, loss_d: 0.785936
0.8061 --- loss: 1.319511, loss_ss: 0.900322, loss_d: 0.419189
0.8445 --- loss: 1.555259, loss_ss: 1.094368, loss_d: 0.460891
0.8829 --- loss: 1.555143, loss_ss: 1.128847, loss_d: 0.426296
0.9213 --- loss: 1.512183, loss_ss: 1.220892, loss_d: 0.291291
0.9597 --- loss: 1.657470, loss_ss: 1.294446, loss_d: 0.363024
0.9981 --- loss: 1.704751, loss_ss: 1.054749, loss_d: 0.650002
Epoch finished! Loss: 1.611139975144313
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.813889, loss_ss: 1.141558, loss_d: 0.672331
0.0384 --- loss: 1.281411, loss_ss: 0.910281, loss_d: 0.371129
0.0768 --- loss: 1.336819, loss_ss: 1.007437, loss_d: 0.329382
0.1152 --- loss: 1.199470, loss_ss: 0.926885, loss_d: 0.272585
0.1536 --- loss: 1.944405, loss_ss: 1.287292, loss_d: 0.657113
0.1919 --- loss: 1.581062, loss_ss: 0.877263, loss_d: 0.703798
0.2303 --- loss: 1.354791, loss_ss: 1.070556, loss_d: 0.284235
0.2687 --- loss: 1.598709, loss_ss: 1.053338, loss_d: 0.545372
0.3071 --- loss: 1.342063, loss_ss: 1.041650, loss_d: 0.300412
0.3455 --- loss: 1.916369, loss_ss: 1.208023, loss_d: 0.708347
0.3839 --- loss: 1.357096, loss_ss: 0.998041, loss_d: 0.359056
0.4223 --- loss: 1.608289, loss_ss: 1.296619, loss_d: 0.311670
0.4607 --- loss: 1.892548, loss_ss: 0.999592, loss_d: 0.892956
0.4990 --- loss: 1.653862, loss_ss: 0.947059, loss_d: 0.706803
0.5374 --- loss: 1.828563, loss_ss: 1.087160, loss_d: 0.741403
0.5758 --- loss: 1.629123, loss_ss: 1.014235, loss_d: 0.614888
0.6142 --- loss: 1.298344, loss_ss: 0.999866, loss_d: 0.298478
0.6526 --- loss: 1.438525, loss_ss: 1.069809, loss_d: 0.368716
0.6910 --- loss: 2.291897, loss_ss: 1.123938, loss_d: 1.167959
0.7294 --- loss: 1.442872, loss_ss: 1.075399, loss_d: 0.367472
0.7678 --- loss: 1.459583, loss_ss: 0.966360, loss_d: 0.493223
0.8061 --- loss: 1.254335, loss_ss: 0.759775, loss_d: 0.494560
0.8445 --- loss: 1.590113, loss_ss: 1.189391, loss_d: 0.400721
0.8829 --- loss: 1.912434, loss_ss: 1.345873, loss_d: 0.566560
0.9213 --- loss: 1.417146, loss_ss: 1.150319, loss_d: 0.266827
0.9597 --- loss: 1.488453, loss_ss: 0.989295, loss_d: 0.499158
0.9981 --- loss: 1.257763, loss_ss: 0.989883, loss_d: 0.267880
Epoch finished! Loss: 1.5646957924732796
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.311247, loss_ss: 0.990365, loss_d: 0.320882
0.0384 --- loss: 1.516532, loss_ss: 1.058063, loss_d: 0.458469
0.0768 --- loss: 1.584258, loss_ss: 1.143341, loss_d: 0.440917
0.1152 --- loss: 1.591271, loss_ss: 1.129423, loss_d: 0.461848
0.1536 --- loss: 1.566060, loss_ss: 1.074782, loss_d: 0.491278
0.1919 --- loss: 1.908974, loss_ss: 1.585396, loss_d: 0.323578
0.2303 --- loss: 1.522256, loss_ss: 1.156840, loss_d: 0.365416
0.2687 --- loss: 1.198014, loss_ss: 0.888263, loss_d: 0.309751
0.3071 --- loss: 1.172381, loss_ss: 0.928719, loss_d: 0.243662
0.3455 --- loss: 1.546130, loss_ss: 1.080188, loss_d: 0.465942
0.3839 --- loss: 1.467167, loss_ss: 1.092097, loss_d: 0.375071
0.4223 --- loss: 1.708410, loss_ss: 1.225105, loss_d: 0.483305
0.4607 --- loss: 1.534972, loss_ss: 1.189005, loss_d: 0.345967
0.4990 --- loss: 1.503921, loss_ss: 0.863123, loss_d: 0.640798
0.5374 --- loss: 1.684896, loss_ss: 1.475667, loss_d: 0.209229
0.5758 --- loss: 1.818871, loss_ss: 1.468533, loss_d: 0.350338
0.6142 --- loss: 1.507112, loss_ss: 1.152721, loss_d: 0.354391
0.6526 --- loss: 1.685347, loss_ss: 1.099839, loss_d: 0.585508
0.6910 --- loss: 1.732712, loss_ss: 0.952038, loss_d: 0.780674
0.7294 --- loss: 1.543660, loss_ss: 1.032198, loss_d: 0.511461
0.7678 --- loss: 1.612099, loss_ss: 1.281737, loss_d: 0.330362
0.8061 --- loss: 1.832509, loss_ss: 1.200285, loss_d: 0.632225
0.8445 --- loss: 1.125372, loss_ss: 0.900978, loss_d: 0.224393
0.8829 --- loss: 1.623938, loss_ss: 1.266588, loss_d: 0.357350
0.9213 --- loss: 1.501325, loss_ss: 1.239138, loss_d: 0.262187
0.9597 --- loss: 1.385304, loss_ss: 0.868829, loss_d: 0.516476
0.9981 --- loss: 1.489070, loss_ss: 1.042368, loss_d: 0.446702
Epoch finished! Loss: 1.5416173315965211
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.469485, loss_ss: 0.992902, loss_d: 0.476583
0.0384 --- loss: 1.406806, loss_ss: 0.982948, loss_d: 0.423858
0.0768 --- loss: 1.203603, loss_ss: 0.937070, loss_d: 0.266532
0.1152 --- loss: 1.579837, loss_ss: 0.855333, loss_d: 0.724504
0.1536 --- loss: 1.238083, loss_ss: 0.909993, loss_d: 0.328090
0.1919 --- loss: 1.345771, loss_ss: 1.031818, loss_d: 0.313953
0.2303 --- loss: 1.774046, loss_ss: 1.515026, loss_d: 0.259020
0.2687 --- loss: 1.903094, loss_ss: 1.182531, loss_d: 0.720564
0.3071 --- loss: 1.703267, loss_ss: 1.087034, loss_d: 0.616234
0.3455 --- loss: 1.176415, loss_ss: 0.892112, loss_d: 0.284303
0.3839 --- loss: 1.466764, loss_ss: 1.157289, loss_d: 0.309475
0.4223 --- loss: 1.586177, loss_ss: 0.986449, loss_d: 0.599729
0.4607 --- loss: 1.688540, loss_ss: 1.359934, loss_d: 0.328606
0.4990 --- loss: 1.503358, loss_ss: 0.899000, loss_d: 0.604358
0.5374 --- loss: 1.444955, loss_ss: 1.009462, loss_d: 0.435493
0.5758 --- loss: 1.280062, loss_ss: 0.932727, loss_d: 0.347335
0.6142 --- loss: 1.909052, loss_ss: 0.956417, loss_d: 0.952635
0.6526 --- loss: 1.345473, loss_ss: 0.901865, loss_d: 0.443609
0.6910 --- loss: 1.516357, loss_ss: 1.068464, loss_d: 0.447893
0.7294 --- loss: 1.478673, loss_ss: 0.888091, loss_d: 0.590582
0.7678 --- loss: 1.364645, loss_ss: 1.088581, loss_d: 0.276064
0.8061 --- loss: 1.418076, loss_ss: 1.190305, loss_d: 0.227771
0.8445 --- loss: 1.871170, loss_ss: 0.899509, loss_d: 0.971661
0.8829 --- loss: 1.948091, loss_ss: 0.925981, loss_d: 1.022110
0.9213 --- loss: 1.502432, loss_ss: 1.160048, loss_d: 0.342384
0.9597 --- loss: 1.459908, loss_ss: 0.914605, loss_d: 0.545303
0.9981 --- loss: 1.983456, loss_ss: 1.614272, loss_d: 0.369184
Epoch finished! Loss: 1.5378235330948462
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.679324, loss_ss: 0.920790, loss_d: 0.758534
0.0384 --- loss: 1.923217, loss_ss: 1.112854, loss_d: 0.810363
0.0768 --- loss: 1.109278, loss_ss: 0.769210, loss_d: 0.340068
0.1152 --- loss: 1.391534, loss_ss: 1.121405, loss_d: 0.270129
0.1536 --- loss: 1.696981, loss_ss: 1.259789, loss_d: 0.437192
0.1919 --- loss: 1.504333, loss_ss: 0.898200, loss_d: 0.606133
0.2303 --- loss: 1.130539, loss_ss: 0.779328, loss_d: 0.351210
0.2687 --- loss: 1.941555, loss_ss: 0.888573, loss_d: 1.052982
0.3071 --- loss: 1.908602, loss_ss: 1.170170, loss_d: 0.738433
0.3455 --- loss: 1.309676, loss_ss: 1.058861, loss_d: 0.250814
0.3839 --- loss: 1.201258, loss_ss: 0.889540, loss_d: 0.311718
0.4223 --- loss: 1.911910, loss_ss: 1.164237, loss_d: 0.747673
0.4607 --- loss: 1.459773, loss_ss: 0.996084, loss_d: 0.463689
0.4990 --- loss: 1.203857, loss_ss: 0.900496, loss_d: 0.303361
0.5374 --- loss: 1.378171, loss_ss: 0.959341, loss_d: 0.418830
0.5758 --- loss: 1.543190, loss_ss: 1.116943, loss_d: 0.426246
0.6142 --- loss: 1.293207, loss_ss: 1.007043, loss_d: 0.286165
0.6526 --- loss: 2.307859, loss_ss: 1.453497, loss_d: 0.854363
0.6910 --- loss: 1.500453, loss_ss: 1.170816, loss_d: 0.329638
0.7294 --- loss: 1.187129, loss_ss: 0.965900, loss_d: 0.221228
0.7678 --- loss: 1.544788, loss_ss: 1.037922, loss_d: 0.506867
0.8061 --- loss: 1.293411, loss_ss: 1.020017, loss_d: 0.273394
0.8445 --- loss: 1.678123, loss_ss: 1.194764, loss_d: 0.483359
0.8829 --- loss: 2.032316, loss_ss: 1.096740, loss_d: 0.935576
0.9213 --- loss: 1.302521, loss_ss: 1.119759, loss_d: 0.182762
0.9597 --- loss: 1.486715, loss_ss: 1.098699, loss_d: 0.388015
0.9981 --- loss: 1.282198, loss_ss: 0.954594, loss_d: 0.327604
Epoch finished! Loss: 1.5009414503207574
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.084477, loss_ss: 0.972614, loss_d: 1.111862
0.0384 --- loss: 1.800181, loss_ss: 1.545741, loss_d: 0.254441
0.0768 --- loss: 1.431695, loss_ss: 0.986077, loss_d: 0.445618
0.1152 --- loss: 1.297184, loss_ss: 1.122172, loss_d: 0.175012
0.1536 --- loss: 1.249190, loss_ss: 1.058168, loss_d: 0.191022
0.1919 --- loss: 1.101560, loss_ss: 0.890098, loss_d: 0.211462
0.2303 --- loss: 1.217060, loss_ss: 0.967414, loss_d: 0.249646
0.2687 --- loss: 1.937564, loss_ss: 1.402183, loss_d: 0.535381
0.3071 --- loss: 1.419793, loss_ss: 1.164464, loss_d: 0.255329
0.3455 --- loss: 1.422097, loss_ss: 0.927462, loss_d: 0.494636
0.3839 --- loss: 2.157141, loss_ss: 1.525010, loss_d: 0.632132
0.4223 --- loss: 1.871267, loss_ss: 1.466295, loss_d: 0.404972
0.4607 --- loss: 1.190886, loss_ss: 0.871459, loss_d: 0.319427
0.4990 --- loss: 1.638286, loss_ss: 1.079270, loss_d: 0.559016
0.5374 --- loss: 1.248641, loss_ss: 0.826664, loss_d: 0.421977
0.5758 --- loss: 2.124657, loss_ss: 1.039214, loss_d: 1.085443
0.6142 --- loss: 1.442467, loss_ss: 1.081645, loss_d: 0.360821
0.6526 --- loss: 1.238281, loss_ss: 0.932297, loss_d: 0.305984
0.6910 --- loss: 1.302567, loss_ss: 0.793935, loss_d: 0.508633
0.7294 --- loss: 1.348184, loss_ss: 1.129110, loss_d: 0.219074
0.7678 --- loss: 1.840901, loss_ss: 1.289772, loss_d: 0.551129
0.8061 --- loss: 1.692845, loss_ss: 0.942869, loss_d: 0.749977
0.8445 --- loss: 1.254087, loss_ss: 1.004419, loss_d: 0.249667
0.8829 --- loss: 1.159883, loss_ss: 0.780808, loss_d: 0.379076
0.9213 --- loss: 1.345128, loss_ss: 1.028733, loss_d: 0.316394
0.9597 --- loss: 2.072182, loss_ss: 1.645181, loss_d: 0.427001
0.9981 --- loss: 1.164348, loss_ss: 0.764841, loss_d: 0.399508
Epoch finished! Loss: 1.502488463658553
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5888888888888889
             precision    recall  f1-score   support

        0.0       1.00      0.07      0.14        80
        1.0       0.00      0.00      0.00        38
        2.0       0.68      0.80      0.73       478
        3.0       0.46      0.99      0.63       196
        4.0       0.00      0.00      0.00       198

avg / total       0.50      0.59      0.49       990
 


====== chp003-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  92.53   7.50  100.00  100.00     13.95
1  96.16   0.00  100.00    0.00      0.00
2  72.02  80.13   64.45   67.79     73.44
3  77.07  98.98   71.66   46.30     63.09
4  80.00   0.00  100.00    0.00      0.00
Total accuracy: 58.89%
Average sen: 37.32%
Average spec: 87.22%
Macro f1-score: 30.10%
[0.27987233 0.32177377 0.31443828 0.30111757 0.30163714 0.29215607
 0.29747462 0.29164031 0.27359399 0.32239354 0.32387838 0.32457125
 0.29948375 0.31715062 0.31010497 0.28388759 0.28052673 0.31578246
 0.28422013 0.31796154 0.3290087  0.27649862 0.31112456 0.30730972
 0.31061202 0.29446882 0.29436341 0.28454846 0.26952794 0.29015192
 0.218474   0.29420108 0.27483714]
pred: 0.2972361039031636, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.171936, loss_ss: 1.564409, loss_d: 0.607527
0.0384 --- loss: 2.541416, loss_ss: 1.562288, loss_d: 0.979129
0.0767 --- loss: 1.984625, loss_ss: 1.527618, loss_d: 0.457007
0.1151 --- loss: 2.069623, loss_ss: 1.486445, loss_d: 0.583178
0.1535 --- loss: 2.010146, loss_ss: 1.501527, loss_d: 0.508619
0.1919 --- loss: 1.980993, loss_ss: 1.621412, loss_d: 0.359580
0.2302 --- loss: 2.258598, loss_ss: 1.603441, loss_d: 0.655157
0.2686 --- loss: 1.964465, loss_ss: 1.498486, loss_d: 0.465980
0.3070 --- loss: 1.880963, loss_ss: 1.469247, loss_d: 0.411716
0.3454 --- loss: 2.091643, loss_ss: 1.512256, loss_d: 0.579388
0.3837 --- loss: 2.529909, loss_ss: 1.636597, loss_d: 0.893312
0.4221 --- loss: 2.113015, loss_ss: 1.605678, loss_d: 0.507337
0.4605 --- loss: 2.001276, loss_ss: 1.591343, loss_d: 0.409933
0.4988 --- loss: 1.754632, loss_ss: 1.408729, loss_d: 0.345903
0.5372 --- loss: 1.910328, loss_ss: 1.563482, loss_d: 0.346846
0.5756 --- loss: 2.147245, loss_ss: 1.611455, loss_d: 0.535791
0.6140 --- loss: 2.258339, loss_ss: 1.700414, loss_d: 0.557925
0.6523 --- loss: 2.193155, loss_ss: 1.513470, loss_d: 0.679685
0.6907 --- loss: 2.122942, loss_ss: 1.475135, loss_d: 0.647808
0.7291 --- loss: 2.108703, loss_ss: 1.449517, loss_d: 0.659186
0.7675 --- loss: 2.139232, loss_ss: 1.598833, loss_d: 0.540399
0.8058 --- loss: 1.736121, loss_ss: 1.424332, loss_d: 0.311789
0.8442 --- loss: 2.104379, loss_ss: 1.411500, loss_d: 0.692879
0.8826 --- loss: 1.962448, loss_ss: 1.372436, loss_d: 0.590012
0.9210 --- loss: 2.093493, loss_ss: 1.566834, loss_d: 0.526659
0.9593 --- loss: 1.951874, loss_ss: 1.456730, loss_d: 0.495144
0.9977 --- loss: 2.254975, loss_ss: 1.369206, loss_d: 0.885769
Epoch finished! Loss: 2.123428298876836
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.229160, loss_ss: 1.399642, loss_d: 0.829518
0.0384 --- loss: 1.959306, loss_ss: 1.415862, loss_d: 0.543444
0.0767 --- loss: 1.869822, loss_ss: 1.443294, loss_d: 0.426528
0.1151 --- loss: 1.904291, loss_ss: 1.363499, loss_d: 0.540792
0.1535 --- loss: 2.412201, loss_ss: 1.539563, loss_d: 0.872639
0.1919 --- loss: 1.894184, loss_ss: 1.437042, loss_d: 0.457142
0.2302 --- loss: 2.114302, loss_ss: 1.450510, loss_d: 0.663792
0.2686 --- loss: 2.010255, loss_ss: 1.375859, loss_d: 0.634396
0.3070 --- loss: 2.097044, loss_ss: 1.462582, loss_d: 0.634461
0.3454 --- loss: 1.821750, loss_ss: 1.429860, loss_d: 0.391891
0.3837 --- loss: 2.171076, loss_ss: 1.746137, loss_d: 0.424939
0.4221 --- loss: 2.147355, loss_ss: 1.624457, loss_d: 0.522898
0.4605 --- loss: 1.843463, loss_ss: 1.394261, loss_d: 0.449201
0.4988 --- loss: 2.196899, loss_ss: 1.417775, loss_d: 0.779124
0.5372 --- loss: 1.911329, loss_ss: 1.324328, loss_d: 0.587001
0.5756 --- loss: 2.376836, loss_ss: 1.477985, loss_d: 0.898851
0.6140 --- loss: 2.100006, loss_ss: 1.552094, loss_d: 0.547912
0.6523 --- loss: 1.959404, loss_ss: 1.388689, loss_d: 0.570714
0.6907 --- loss: 2.143487, loss_ss: 1.359682, loss_d: 0.783805
0.7291 --- loss: 1.795420, loss_ss: 1.223437, loss_d: 0.571984
0.7675 --- loss: 1.562788, loss_ss: 1.206975, loss_d: 0.355813
0.8058 --- loss: 1.915069, loss_ss: 1.375682, loss_d: 0.539387
0.8442 --- loss: 2.511282, loss_ss: 1.797445, loss_d: 0.713837
0.8826 --- loss: 1.845414, loss_ss: 1.411413, loss_d: 0.434002
0.9210 --- loss: 1.900978, loss_ss: 1.567903, loss_d: 0.333075
0.9593 --- loss: 2.444866, loss_ss: 1.421814, loss_d: 1.023052
0.9977 --- loss: 1.882850, loss_ss: 1.317772, loss_d: 0.565078
Epoch finished! Loss: 2.0021711638340585
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.760611, loss_ss: 1.428579, loss_d: 0.332032
0.0384 --- loss: 2.014468, loss_ss: 1.523292, loss_d: 0.491176
0.0767 --- loss: 1.919878, loss_ss: 1.453259, loss_d: 0.466619
0.1151 --- loss: 1.568258, loss_ss: 1.203162, loss_d: 0.365096
0.1535 --- loss: 1.878669, loss_ss: 1.350631, loss_d: 0.528038
0.1919 --- loss: 2.011757, loss_ss: 1.484254, loss_d: 0.527502
0.2302 --- loss: 1.523175, loss_ss: 1.264110, loss_d: 0.259065
0.2686 --- loss: 2.032113, loss_ss: 1.419292, loss_d: 0.612820
0.3070 --- loss: 2.067387, loss_ss: 1.447222, loss_d: 0.620165
0.3454 --- loss: 2.117609, loss_ss: 1.331213, loss_d: 0.786396
0.3837 --- loss: 2.483581, loss_ss: 1.257912, loss_d: 1.225669
0.4221 --- loss: 2.238973, loss_ss: 1.314046, loss_d: 0.924927
0.4605 --- loss: 1.852361, loss_ss: 1.402365, loss_d: 0.449996
0.4988 --- loss: 2.104405, loss_ss: 1.641226, loss_d: 0.463179
0.5372 --- loss: 1.915239, loss_ss: 1.440194, loss_d: 0.475045
0.5756 --- loss: 2.100879, loss_ss: 1.650561, loss_d: 0.450318
0.6140 --- loss: 2.011167, loss_ss: 1.544610, loss_d: 0.466557
0.6523 --- loss: 1.987470, loss_ss: 1.508341, loss_d: 0.479129
0.6907 --- loss: 2.032952, loss_ss: 1.370549, loss_d: 0.662403
0.7291 --- loss: 1.727670, loss_ss: 1.402781, loss_d: 0.324889
0.7675 --- loss: 1.576704, loss_ss: 1.237373, loss_d: 0.339331
0.8058 --- loss: 2.090239, loss_ss: 1.292921, loss_d: 0.797319
0.8442 --- loss: 1.867488, loss_ss: 1.322125, loss_d: 0.545363
0.8826 --- loss: 1.931383, loss_ss: 1.273126, loss_d: 0.658257
0.9210 --- loss: 1.780798, loss_ss: 1.435674, loss_d: 0.345124
0.9593 --- loss: 1.887044, loss_ss: 1.171638, loss_d: 0.715406
0.9977 --- loss: 2.054970, loss_ss: 1.634568, loss_d: 0.420402
Epoch finished! Loss: 1.930372572862185
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.589555, loss_ss: 1.235734, loss_d: 0.353821
0.0384 --- loss: 1.736769, loss_ss: 1.327117, loss_d: 0.409652
0.0767 --- loss: 1.901124, loss_ss: 1.291966, loss_d: 0.609158
0.1151 --- loss: 1.727202, loss_ss: 1.315370, loss_d: 0.411831
0.1535 --- loss: 1.555485, loss_ss: 1.119809, loss_d: 0.435676
0.1919 --- loss: 1.911156, loss_ss: 1.505449, loss_d: 0.405707
0.2302 --- loss: 1.666786, loss_ss: 1.162744, loss_d: 0.504042
0.2686 --- loss: 1.805895, loss_ss: 1.331995, loss_d: 0.473900
0.3070 --- loss: 1.612988, loss_ss: 1.103120, loss_d: 0.509868
0.3454 --- loss: 1.830661, loss_ss: 1.146422, loss_d: 0.684240
0.3837 --- loss: 1.817225, loss_ss: 1.407315, loss_d: 0.409910
0.4221 --- loss: 1.884004, loss_ss: 1.574512, loss_d: 0.309492
0.4605 --- loss: 1.713314, loss_ss: 1.346041, loss_d: 0.367273
0.4988 --- loss: 2.024770, loss_ss: 1.458031, loss_d: 0.566739
0.5372 --- loss: 1.652942, loss_ss: 1.328511, loss_d: 0.324431
0.5756 --- loss: 2.183055, loss_ss: 1.434972, loss_d: 0.748083
0.6140 --- loss: 2.356160, loss_ss: 1.311076, loss_d: 1.045084
0.6523 --- loss: 1.655735, loss_ss: 1.273594, loss_d: 0.382141
0.6907 --- loss: 1.837281, loss_ss: 1.324288, loss_d: 0.512993
0.7291 --- loss: 2.018401, loss_ss: 1.340541, loss_d: 0.677860
0.7675 --- loss: 1.828457, loss_ss: 1.258559, loss_d: 0.569898
0.8058 --- loss: 1.599494, loss_ss: 1.196062, loss_d: 0.403433
0.8442 --- loss: 1.823466, loss_ss: 1.270836, loss_d: 0.552630
0.8826 --- loss: 1.596087, loss_ss: 1.297966, loss_d: 0.298120
0.9210 --- loss: 1.396981, loss_ss: 1.050565, loss_d: 0.346416
0.9593 --- loss: 2.215920, loss_ss: 1.239449, loss_d: 0.976471
0.9977 --- loss: 1.578707, loss_ss: 1.280714, loss_d: 0.297993
Epoch finished! Loss: 1.827912977567086
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.860449, loss_ss: 1.137547, loss_d: 0.722902
0.0384 --- loss: 1.760886, loss_ss: 1.268955, loss_d: 0.491931
0.0767 --- loss: 1.726392, loss_ss: 1.307160, loss_d: 0.419232
0.1151 --- loss: 1.454931, loss_ss: 0.988737, loss_d: 0.466194
0.1535 --- loss: 1.874608, loss_ss: 1.518440, loss_d: 0.356169
0.1919 --- loss: 1.551685, loss_ss: 1.162488, loss_d: 0.389197
0.2302 --- loss: 1.686028, loss_ss: 1.376788, loss_d: 0.309239
0.2686 --- loss: 1.369889, loss_ss: 1.026646, loss_d: 0.343242
0.3070 --- loss: 1.598628, loss_ss: 1.312177, loss_d: 0.286451
0.3454 --- loss: 1.179959, loss_ss: 0.970601, loss_d: 0.209358
0.3837 --- loss: 1.454652, loss_ss: 1.235235, loss_d: 0.219416
0.4221 --- loss: 1.528398, loss_ss: 1.202331, loss_d: 0.326067
0.4605 --- loss: 2.065144, loss_ss: 1.093962, loss_d: 0.971181
0.4988 --- loss: 1.352968, loss_ss: 0.982216, loss_d: 0.370752
0.5372 --- loss: 1.608185, loss_ss: 1.224265, loss_d: 0.383920
0.5756 --- loss: 1.608835, loss_ss: 1.094916, loss_d: 0.513919
0.6140 --- loss: 2.221676, loss_ss: 1.314110, loss_d: 0.907566
0.6523 --- loss: 1.421900, loss_ss: 1.092089, loss_d: 0.329811
0.6907 --- loss: 2.069007, loss_ss: 1.617711, loss_d: 0.451296
0.7291 --- loss: 1.827058, loss_ss: 1.148742, loss_d: 0.678316
0.7675 --- loss: 1.887259, loss_ss: 1.562422, loss_d: 0.324837
0.8058 --- loss: 1.522348, loss_ss: 0.991166, loss_d: 0.531183
0.8442 --- loss: 1.669819, loss_ss: 1.150714, loss_d: 0.519105
0.8826 --- loss: 1.437495, loss_ss: 1.031386, loss_d: 0.406110
0.9210 --- loss: 1.888977, loss_ss: 1.176311, loss_d: 0.712666
0.9593 --- loss: 1.978919, loss_ss: 1.415857, loss_d: 0.563063
0.9977 --- loss: 1.836268, loss_ss: 1.083400, loss_d: 0.752868
Epoch finished! Loss: 1.708319026690263
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.994344, loss_ss: 1.433558, loss_d: 0.560786
0.0384 --- loss: 1.793814, loss_ss: 1.273974, loss_d: 0.519840
0.0767 --- loss: 1.748204, loss_ss: 1.041293, loss_d: 0.706911
0.1151 --- loss: 1.805847, loss_ss: 1.135651, loss_d: 0.670196
0.1535 --- loss: 2.093229, loss_ss: 1.537261, loss_d: 0.555968
0.1919 --- loss: 1.287365, loss_ss: 0.931908, loss_d: 0.355457
0.2302 --- loss: 2.063571, loss_ss: 1.475212, loss_d: 0.588359
0.2686 --- loss: 1.365799, loss_ss: 1.070103, loss_d: 0.295696
0.3070 --- loss: 1.423180, loss_ss: 1.057922, loss_d: 0.365258
0.3454 --- loss: 1.422257, loss_ss: 1.186894, loss_d: 0.235363
0.3837 --- loss: 1.347338, loss_ss: 1.073711, loss_d: 0.273627
0.4221 --- loss: 1.734100, loss_ss: 1.397499, loss_d: 0.336601
0.4605 --- loss: 1.752105, loss_ss: 1.380356, loss_d: 0.371748
0.4988 --- loss: 1.639577, loss_ss: 1.270131, loss_d: 0.369447
0.5372 --- loss: 1.579128, loss_ss: 1.130727, loss_d: 0.448401
0.5756 --- loss: 1.548020, loss_ss: 1.179215, loss_d: 0.368805
0.6140 --- loss: 1.592549, loss_ss: 1.176794, loss_d: 0.415755
0.6523 --- loss: 1.556410, loss_ss: 1.212800, loss_d: 0.343610
0.6907 --- loss: 1.744621, loss_ss: 1.040674, loss_d: 0.703947
0.7291 --- loss: 1.416800, loss_ss: 1.072853, loss_d: 0.343947
0.7675 --- loss: 1.478521, loss_ss: 1.183771, loss_d: 0.294750
0.8058 --- loss: 1.412664, loss_ss: 1.164209, loss_d: 0.248455
0.8442 --- loss: 1.690007, loss_ss: 1.170547, loss_d: 0.519459
0.8826 --- loss: 1.604082, loss_ss: 1.178253, loss_d: 0.425829
0.9210 --- loss: 1.496436, loss_ss: 1.026061, loss_d: 0.470375
0.9593 --- loss: 1.484078, loss_ss: 0.963559, loss_d: 0.520519
0.9977 --- loss: 1.998724, loss_ss: 0.966678, loss_d: 1.032047
Epoch finished! Loss: 1.6366733161302713
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.306732, loss_ss: 1.017501, loss_d: 0.289232
0.0384 --- loss: 1.157834, loss_ss: 0.907876, loss_d: 0.249959
0.0767 --- loss: 2.210146, loss_ss: 1.057782, loss_d: 1.152364
0.1151 --- loss: 1.140450, loss_ss: 0.797466, loss_d: 0.342983
0.1535 --- loss: 1.762217, loss_ss: 1.079223, loss_d: 0.682995
0.1919 --- loss: 1.370112, loss_ss: 1.101146, loss_d: 0.268966
0.2302 --- loss: 1.599778, loss_ss: 1.183802, loss_d: 0.415976
0.2686 --- loss: 1.468503, loss_ss: 1.140217, loss_d: 0.328286
0.3070 --- loss: 1.975414, loss_ss: 1.361785, loss_d: 0.613629
0.3454 --- loss: 1.484076, loss_ss: 1.050968, loss_d: 0.433109
0.3837 --- loss: 1.499886, loss_ss: 1.140445, loss_d: 0.359441
0.4221 --- loss: 1.181374, loss_ss: 0.908361, loss_d: 0.273013
0.4605 --- loss: 1.260052, loss_ss: 1.011652, loss_d: 0.248400
0.4988 --- loss: 1.266196, loss_ss: 0.919303, loss_d: 0.346893
0.5372 --- loss: 1.298618, loss_ss: 1.005002, loss_d: 0.293615
0.5756 --- loss: 1.475864, loss_ss: 1.053327, loss_d: 0.422537
0.6140 --- loss: 1.242548, loss_ss: 0.958094, loss_d: 0.284453
0.6523 --- loss: 1.444433, loss_ss: 0.970392, loss_d: 0.474041
0.6907 --- loss: 1.445717, loss_ss: 1.017031, loss_d: 0.428686
0.7291 --- loss: 1.669111, loss_ss: 1.178841, loss_d: 0.490270
0.7675 --- loss: 1.531003, loss_ss: 1.000676, loss_d: 0.530327
0.8058 --- loss: 2.429368, loss_ss: 1.043110, loss_d: 1.386258
0.8442 --- loss: 1.565588, loss_ss: 0.909292, loss_d: 0.656296
0.8826 --- loss: 1.522987, loss_ss: 1.044673, loss_d: 0.478313
0.9210 --- loss: 1.738593, loss_ss: 1.170467, loss_d: 0.568126
0.9593 --- loss: 1.692712, loss_ss: 0.943287, loss_d: 0.749425
0.9977 --- loss: 1.577083, loss_ss: 1.163109, loss_d: 0.413975
Epoch finished! Loss: 1.5702888250350953
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.193650, loss_ss: 0.789266, loss_d: 0.404384
0.0384 --- loss: 1.208259, loss_ss: 0.693664, loss_d: 0.514595
0.0767 --- loss: 1.540553, loss_ss: 0.889719, loss_d: 0.650834
0.1151 --- loss: 1.753386, loss_ss: 0.953210, loss_d: 0.800176
0.1535 --- loss: 2.122413, loss_ss: 1.152740, loss_d: 0.969673
0.1919 --- loss: 1.782973, loss_ss: 1.489788, loss_d: 0.293185
0.2302 --- loss: 1.931479, loss_ss: 1.467678, loss_d: 0.463801
0.2686 --- loss: 1.213812, loss_ss: 0.864461, loss_d: 0.349350
0.3070 --- loss: 1.704353, loss_ss: 0.911718, loss_d: 0.792635
0.3454 --- loss: 1.246486, loss_ss: 0.919881, loss_d: 0.326605
0.3837 --- loss: 1.276936, loss_ss: 0.896781, loss_d: 0.380154
0.4221 --- loss: 1.717906, loss_ss: 1.287429, loss_d: 0.430477
0.4605 --- loss: 1.656703, loss_ss: 1.303766, loss_d: 0.352937
0.4988 --- loss: 1.800819, loss_ss: 1.010833, loss_d: 0.789986
0.5372 --- loss: 1.533746, loss_ss: 1.302757, loss_d: 0.230990
0.5756 --- loss: 1.590404, loss_ss: 1.307369, loss_d: 0.283035
0.6140 --- loss: 1.828325, loss_ss: 1.549832, loss_d: 0.278494
0.6523 --- loss: 1.501325, loss_ss: 1.145135, loss_d: 0.356190
0.6907 --- loss: 1.805528, loss_ss: 1.069428, loss_d: 0.736100
0.7291 --- loss: 1.725033, loss_ss: 1.226066, loss_d: 0.498968
0.7675 --- loss: 1.514832, loss_ss: 0.990969, loss_d: 0.523863
0.8058 --- loss: 1.418692, loss_ss: 1.086138, loss_d: 0.332554
0.8442 --- loss: 2.112877, loss_ss: 1.593860, loss_d: 0.519018
0.8826 --- loss: 1.529637, loss_ss: 1.111616, loss_d: 0.418020
0.9210 --- loss: 2.281270, loss_ss: 1.369659, loss_d: 0.911611
0.9593 --- loss: 1.279579, loss_ss: 1.005966, loss_d: 0.273614
0.9977 --- loss: 1.274692, loss_ss: 1.069501, loss_d: 0.205191
Epoch finished! Loss: 1.5437241467145772
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.258570, loss_ss: 0.918859, loss_d: 0.339711
0.0384 --- loss: 1.231274, loss_ss: 0.820926, loss_d: 0.410348
0.0767 --- loss: 1.502127, loss_ss: 1.158990, loss_d: 0.343138
0.1151 --- loss: 1.163474, loss_ss: 0.821135, loss_d: 0.342339
0.1535 --- loss: 1.896550, loss_ss: 1.322123, loss_d: 0.574426
0.1919 --- loss: 1.422647, loss_ss: 0.994858, loss_d: 0.427789
0.2302 --- loss: 1.595989, loss_ss: 1.157047, loss_d: 0.438942
0.2686 --- loss: 1.350331, loss_ss: 1.081149, loss_d: 0.269182
0.3070 --- loss: 1.410876, loss_ss: 1.169198, loss_d: 0.241678
0.3454 --- loss: 1.821102, loss_ss: 1.537835, loss_d: 0.283267
0.3837 --- loss: 1.239451, loss_ss: 0.877293, loss_d: 0.362158
0.4221 --- loss: 1.243808, loss_ss: 1.048018, loss_d: 0.195790
0.4605 --- loss: 1.543964, loss_ss: 1.048604, loss_d: 0.495360
0.4988 --- loss: 1.636883, loss_ss: 0.969739, loss_d: 0.667144
0.5372 --- loss: 1.659693, loss_ss: 1.326030, loss_d: 0.333664
0.5756 --- loss: 1.493709, loss_ss: 1.182457, loss_d: 0.311252
0.6140 --- loss: 1.369845, loss_ss: 1.084349, loss_d: 0.285496
0.6523 --- loss: 2.210436, loss_ss: 1.917138, loss_d: 0.293297
0.6907 --- loss: 1.926349, loss_ss: 0.985021, loss_d: 0.941328
0.7291 --- loss: 1.231831, loss_ss: 0.960097, loss_d: 0.271734
0.7675 --- loss: 2.007904, loss_ss: 1.359529, loss_d: 0.648374
0.8058 --- loss: 1.252532, loss_ss: 0.987387, loss_d: 0.265145
0.8442 --- loss: 1.303825, loss_ss: 0.947475, loss_d: 0.356349
0.8826 --- loss: 1.231981, loss_ss: 1.007551, loss_d: 0.224430
0.9210 --- loss: 1.702467, loss_ss: 1.079183, loss_d: 0.623284
0.9593 --- loss: 1.306168, loss_ss: 0.837687, loss_d: 0.468482
0.9977 --- loss: 1.469016, loss_ss: 1.187151, loss_d: 0.281865
Epoch finished! Loss: 1.4905505593006427
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.603501, loss_ss: 1.168748, loss_d: 0.434753
0.0384 --- loss: 1.526637, loss_ss: 1.079850, loss_d: 0.446787
0.0767 --- loss: 1.880166, loss_ss: 1.270577, loss_d: 0.609589
0.1151 --- loss: 1.157952, loss_ss: 0.884935, loss_d: 0.273017
0.1535 --- loss: 1.667981, loss_ss: 0.897185, loss_d: 0.770797
0.1919 --- loss: 1.333445, loss_ss: 0.910999, loss_d: 0.422446
0.2302 --- loss: 2.677736, loss_ss: 1.289216, loss_d: 1.388520
0.2686 --- loss: 1.535957, loss_ss: 1.256028, loss_d: 0.279929
0.3070 --- loss: 1.301881, loss_ss: 0.929078, loss_d: 0.372802
0.3454 --- loss: 1.404587, loss_ss: 1.138665, loss_d: 0.265922
0.3837 --- loss: 1.431189, loss_ss: 1.082552, loss_d: 0.348637
0.4221 --- loss: 1.900617, loss_ss: 1.392803, loss_d: 0.507814
0.4605 --- loss: 1.578724, loss_ss: 1.153949, loss_d: 0.424775
0.4988 --- loss: 1.370982, loss_ss: 1.078762, loss_d: 0.292220
0.5372 --- loss: 1.478524, loss_ss: 1.102219, loss_d: 0.376305
0.5756 --- loss: 1.552852, loss_ss: 1.062764, loss_d: 0.490088
0.6140 --- loss: 1.336966, loss_ss: 1.049408, loss_d: 0.287558
0.6523 --- loss: 1.618610, loss_ss: 0.992990, loss_d: 0.625620
0.6907 --- loss: 1.834571, loss_ss: 1.466764, loss_d: 0.367807
0.7291 --- loss: 1.620636, loss_ss: 1.150897, loss_d: 0.469739
0.7675 --- loss: 1.402370, loss_ss: 1.156491, loss_d: 0.245879
0.8058 --- loss: 1.848143, loss_ss: 1.534549, loss_d: 0.313593
0.8442 --- loss: 1.806276, loss_ss: 1.105113, loss_d: 0.701163
0.8826 --- loss: 1.751094, loss_ss: 1.259418, loss_d: 0.491676
0.9210 --- loss: 1.617543, loss_ss: 0.960142, loss_d: 0.657400
0.9593 --- loss: 1.781251, loss_ss: 1.393696, loss_d: 0.387555
0.9977 --- loss: 1.485866, loss_ss: 1.167544, loss_d: 0.318323
Epoch finished! Loss: 1.5094683518776526
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.234375
             precision    recall  f1-score   support

        0.0       0.91      0.16      0.27       135
        1.0       0.00      0.00      0.00       141
        2.0       0.06      0.02      0.03       354
        3.0       0.24      1.00      0.38       197
        4.0       0.00      0.00      0.00       133

avg / total       0.20      0.23      0.13       960
 


====== chp004-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  87.92   15.56   99.76  91.30     26.58
1  85.31    0.00  100.00   0.00      0.00
2  53.23    1.98   83.17   6.42      3.02
3  34.27  100.00   17.30  23.79     38.44
4  86.15    0.00  100.00   0.00      0.00
Total accuracy: 23.44%
Average sen: 23.51%
Average spec: 80.05%
Macro f1-score: 13.61%
[0.18250436 0.17155153 0.18372175 0.19887938 0.17459823 0.17724562
 0.17290224 0.17323132 0.17969595 0.17831314 0.17039926 0.17498252
 0.20056161 0.17250574 0.17785847 0.17267755 0.17108586 0.16808064
 0.17961763 0.17580387 0.17289425 0.17971273 0.17351975 0.16621482
 0.17509386 0.17777202 0.181109   0.19311775 0.17218715 0.1897233
 0.17250298 0.16915877]
pred: 0.17747571971267462, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.620507, loss_ss: 1.940331, loss_d: 0.680176
0.0385 --- loss: 2.287317, loss_ss: 1.746351, loss_d: 0.540966
0.0771 --- loss: 2.244752, loss_ss: 1.823905, loss_d: 0.420847
0.1156 --- loss: 2.688649, loss_ss: 1.692946, loss_d: 0.995703
0.1541 --- loss: 2.399126, loss_ss: 1.798901, loss_d: 0.600225
0.1927 --- loss: 2.297981, loss_ss: 1.594554, loss_d: 0.703427
0.2312 --- loss: 2.692401, loss_ss: 1.738699, loss_d: 0.953702
0.2697 --- loss: 2.561396, loss_ss: 1.729644, loss_d: 0.831752
0.3083 --- loss: 2.266898, loss_ss: 1.659761, loss_d: 0.607136
0.3468 --- loss: 1.987908, loss_ss: 1.610695, loss_d: 0.377213
0.3854 --- loss: 2.639502, loss_ss: 1.565034, loss_d: 1.074468
0.4239 --- loss: 2.477305, loss_ss: 1.705984, loss_d: 0.771321
0.4624 --- loss: 2.047940, loss_ss: 1.684127, loss_d: 0.363813
0.5010 --- loss: 2.242110, loss_ss: 1.538737, loss_d: 0.703373
0.5395 --- loss: 2.102926, loss_ss: 1.554157, loss_d: 0.548769
0.5780 --- loss: 2.133318, loss_ss: 1.634005, loss_d: 0.499313
0.6166 --- loss: 2.100582, loss_ss: 1.549700, loss_d: 0.550882
0.6551 --- loss: 2.088579, loss_ss: 1.666427, loss_d: 0.422152
0.6936 --- loss: 2.004134, loss_ss: 1.592204, loss_d: 0.411930
0.7322 --- loss: 2.089022, loss_ss: 1.575775, loss_d: 0.513247
0.7707 --- loss: 1.847314, loss_ss: 1.404344, loss_d: 0.442970
0.8092 --- loss: 2.037313, loss_ss: 1.497155, loss_d: 0.540157
0.8478 --- loss: 2.334119, loss_ss: 1.655441, loss_d: 0.678679
0.8863 --- loss: 2.079889, loss_ss: 1.576860, loss_d: 0.503029
0.9249 --- loss: 2.061260, loss_ss: 1.445068, loss_d: 0.616191
0.9634 --- loss: 1.816723, loss_ss: 1.395114, loss_d: 0.421608
Epoch finished! Loss: 2.179586839491796
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.404768, loss_ss: 1.641818, loss_d: 0.762949
0.0385 --- loss: 2.219030, loss_ss: 1.507150, loss_d: 0.711880
0.0771 --- loss: 2.078920, loss_ss: 1.442537, loss_d: 0.636384
0.1156 --- loss: 2.197402, loss_ss: 1.479192, loss_d: 0.718210
0.1541 --- loss: 1.823801, loss_ss: 1.426285, loss_d: 0.397516
0.1927 --- loss: 2.369009, loss_ss: 1.422598, loss_d: 0.946412
0.2312 --- loss: 2.008297, loss_ss: 1.476438, loss_d: 0.531859
0.2697 --- loss: 1.988707, loss_ss: 1.494570, loss_d: 0.494137
0.3083 --- loss: 2.027409, loss_ss: 1.453737, loss_d: 0.573672
0.3468 --- loss: 1.619642, loss_ss: 1.397481, loss_d: 0.222161
0.3854 --- loss: 1.941505, loss_ss: 1.381428, loss_d: 0.560077
0.4239 --- loss: 2.044990, loss_ss: 1.565063, loss_d: 0.479926
0.4624 --- loss: 2.127563, loss_ss: 1.440169, loss_d: 0.687395
0.5010 --- loss: 2.314769, loss_ss: 1.504432, loss_d: 0.810337
0.5395 --- loss: 2.017349, loss_ss: 1.482035, loss_d: 0.535314
0.5780 --- loss: 1.849927, loss_ss: 1.357297, loss_d: 0.492630
0.6166 --- loss: 1.692469, loss_ss: 1.333002, loss_d: 0.359466
0.6551 --- loss: 2.358178, loss_ss: 1.604294, loss_d: 0.753884
0.6936 --- loss: 1.732006, loss_ss: 1.345899, loss_d: 0.386107
0.7322 --- loss: 1.907472, loss_ss: 1.424120, loss_d: 0.483352
0.7707 --- loss: 2.259706, loss_ss: 1.383075, loss_d: 0.876632
0.8092 --- loss: 1.818818, loss_ss: 1.462728, loss_d: 0.356090
0.8478 --- loss: 1.680913, loss_ss: 1.348297, loss_d: 0.332616
0.8863 --- loss: 2.530077, loss_ss: 1.458372, loss_d: 1.071705
0.9249 --- loss: 1.966149, loss_ss: 1.358521, loss_d: 0.607629
0.9634 --- loss: 1.910423, loss_ss: 1.356524, loss_d: 0.553899
Epoch finished! Loss: 2.0365449507724365
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.668642, loss_ss: 1.277481, loss_d: 0.391161
0.0385 --- loss: 1.973864, loss_ss: 1.171401, loss_d: 0.802463
0.0771 --- loss: 1.685369, loss_ss: 1.323529, loss_d: 0.361840
0.1156 --- loss: 1.590628, loss_ss: 1.092476, loss_d: 0.498152
0.1541 --- loss: 1.917156, loss_ss: 1.347642, loss_d: 0.569513
0.1927 --- loss: 1.680005, loss_ss: 1.178625, loss_d: 0.501380
0.2312 --- loss: 1.661974, loss_ss: 1.291991, loss_d: 0.369983
0.2697 --- loss: 1.871929, loss_ss: 1.370031, loss_d: 0.501898
0.3083 --- loss: 2.235917, loss_ss: 1.391481, loss_d: 0.844436
0.3468 --- loss: 2.099680, loss_ss: 1.463555, loss_d: 0.636124
0.3854 --- loss: 1.968294, loss_ss: 1.522342, loss_d: 0.445952
0.4239 --- loss: 2.089161, loss_ss: 1.442541, loss_d: 0.646620
0.4624 --- loss: 2.186697, loss_ss: 1.377578, loss_d: 0.809119
0.5010 --- loss: 1.851675, loss_ss: 1.230848, loss_d: 0.620827
0.5395 --- loss: 1.992698, loss_ss: 1.259528, loss_d: 0.733170
0.5780 --- loss: 1.511221, loss_ss: 1.163439, loss_d: 0.347782
0.6166 --- loss: 1.964854, loss_ss: 1.440160, loss_d: 0.524695
0.6551 --- loss: 2.123426, loss_ss: 1.144912, loss_d: 0.978514
0.6936 --- loss: 2.109484, loss_ss: 1.344943, loss_d: 0.764541
0.7322 --- loss: 1.844352, loss_ss: 1.356684, loss_d: 0.487668
0.7707 --- loss: 1.677108, loss_ss: 1.166224, loss_d: 0.510884
0.8092 --- loss: 1.444912, loss_ss: 1.123763, loss_d: 0.321149
0.8478 --- loss: 1.607778, loss_ss: 1.273237, loss_d: 0.334541
0.8863 --- loss: 1.728090, loss_ss: 1.320161, loss_d: 0.407929
0.9249 --- loss: 1.702851, loss_ss: 1.320391, loss_d: 0.382460
0.9634 --- loss: 1.655398, loss_ss: 1.234865, loss_d: 0.420534
Epoch finished! Loss: 1.88372456152927
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.828668, loss_ss: 1.190634, loss_d: 0.638034
0.0385 --- loss: 1.681216, loss_ss: 1.290934, loss_d: 0.390282
0.0771 --- loss: 1.978920, loss_ss: 1.225692, loss_d: 0.753228
0.1156 --- loss: 1.876971, loss_ss: 1.410132, loss_d: 0.466839
0.1541 --- loss: 1.877963, loss_ss: 1.520445, loss_d: 0.357518
0.1927 --- loss: 1.580998, loss_ss: 1.226298, loss_d: 0.354701
0.2312 --- loss: 2.221619, loss_ss: 1.387735, loss_d: 0.833883
0.2697 --- loss: 1.708797, loss_ss: 1.192841, loss_d: 0.515956
0.3083 --- loss: 1.589442, loss_ss: 1.227072, loss_d: 0.362370
0.3468 --- loss: 1.540948, loss_ss: 1.170788, loss_d: 0.370160
0.3854 --- loss: 1.860408, loss_ss: 1.368615, loss_d: 0.491793
0.4239 --- loss: 1.761071, loss_ss: 1.173955, loss_d: 0.587116
0.4624 --- loss: 1.678649, loss_ss: 0.994607, loss_d: 0.684042
0.5010 --- loss: 1.509644, loss_ss: 1.048922, loss_d: 0.460722
0.5395 --- loss: 1.827109, loss_ss: 1.261848, loss_d: 0.565261
0.5780 --- loss: 1.974057, loss_ss: 1.259681, loss_d: 0.714376
0.6166 --- loss: 1.680271, loss_ss: 1.320059, loss_d: 0.360212
0.6551 --- loss: 1.611290, loss_ss: 1.258847, loss_d: 0.352443
0.6936 --- loss: 2.002307, loss_ss: 1.107803, loss_d: 0.894504
0.7322 --- loss: 1.781338, loss_ss: 1.339306, loss_d: 0.442032
0.7707 --- loss: 1.712596, loss_ss: 1.194157, loss_d: 0.518439
0.8092 --- loss: 1.729939, loss_ss: 1.205482, loss_d: 0.524456
0.8478 --- loss: 1.461760, loss_ss: 1.073185, loss_d: 0.388575
0.8863 --- loss: 1.956650, loss_ss: 1.484530, loss_d: 0.472120
0.9249 --- loss: 1.415888, loss_ss: 1.151227, loss_d: 0.264661
0.9634 --- loss: 1.775492, loss_ss: 1.337939, loss_d: 0.437553
Epoch finished! Loss: 1.7227985062654414
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.428155, loss_ss: 1.080143, loss_d: 0.348012
0.0385 --- loss: 1.938411, loss_ss: 1.013974, loss_d: 0.924438
0.0771 --- loss: 1.528252, loss_ss: 1.066902, loss_d: 0.461351
0.1156 --- loss: 1.633013, loss_ss: 1.165168, loss_d: 0.467845
0.1541 --- loss: 1.596214, loss_ss: 1.276160, loss_d: 0.320054
0.1927 --- loss: 1.751146, loss_ss: 1.083890, loss_d: 0.667255
0.2312 --- loss: 1.537471, loss_ss: 1.188160, loss_d: 0.349311
0.2697 --- loss: 1.366932, loss_ss: 0.989376, loss_d: 0.377556
0.3083 --- loss: 1.845571, loss_ss: 1.329736, loss_d: 0.515835
0.3468 --- loss: 2.099640, loss_ss: 1.187476, loss_d: 0.912163
0.3854 --- loss: 1.767872, loss_ss: 1.310132, loss_d: 0.457740
0.4239 --- loss: 1.633308, loss_ss: 1.006486, loss_d: 0.626821
0.4624 --- loss: 1.624607, loss_ss: 1.100650, loss_d: 0.523958
0.5010 --- loss: 1.796709, loss_ss: 1.368229, loss_d: 0.428480
0.5395 --- loss: 1.692112, loss_ss: 0.999073, loss_d: 0.693039
0.5780 --- loss: 1.465509, loss_ss: 1.092794, loss_d: 0.372715
0.6166 --- loss: 1.935543, loss_ss: 1.006389, loss_d: 0.929154
0.6551 --- loss: 1.637637, loss_ss: 1.132082, loss_d: 0.505556
0.6936 --- loss: 1.276676, loss_ss: 0.874814, loss_d: 0.401862
0.7322 --- loss: 1.650241, loss_ss: 1.156716, loss_d: 0.493526
0.7707 --- loss: 2.024178, loss_ss: 1.240199, loss_d: 0.783979
0.8092 --- loss: 1.655399, loss_ss: 0.999436, loss_d: 0.655963
0.8478 --- loss: 1.726847, loss_ss: 1.217403, loss_d: 0.509443
0.8863 --- loss: 1.270422, loss_ss: 1.023769, loss_d: 0.246653
0.9249 --- loss: 1.627075, loss_ss: 1.235848, loss_d: 0.391227
0.9634 --- loss: 1.490594, loss_ss: 1.151483, loss_d: 0.339111
Epoch finished! Loss: 1.637331359174721
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.476926, loss_ss: 1.150016, loss_d: 0.326910
0.0385 --- loss: 1.854922, loss_ss: 1.346015, loss_d: 0.508906
0.0771 --- loss: 1.645930, loss_ss: 0.967390, loss_d: 0.678539
0.1156 --- loss: 1.984607, loss_ss: 1.323126, loss_d: 0.661481
0.1541 --- loss: 1.623663, loss_ss: 1.184541, loss_d: 0.439122
0.1927 --- loss: 1.462954, loss_ss: 0.905631, loss_d: 0.557324
0.2312 --- loss: 1.531534, loss_ss: 0.994864, loss_d: 0.536671
0.2697 --- loss: 1.805628, loss_ss: 1.414558, loss_d: 0.391070
0.3083 --- loss: 1.879157, loss_ss: 1.122401, loss_d: 0.756755
0.3468 --- loss: 1.265178, loss_ss: 1.028366, loss_d: 0.236812
0.3854 --- loss: 1.373064, loss_ss: 0.890296, loss_d: 0.482768
0.4239 --- loss: 1.845862, loss_ss: 1.029438, loss_d: 0.816423
0.4624 --- loss: 1.748362, loss_ss: 1.084690, loss_d: 0.663672
0.5010 --- loss: 1.602612, loss_ss: 1.244384, loss_d: 0.358229
0.5395 --- loss: 1.587326, loss_ss: 1.225484, loss_d: 0.361842
0.5780 --- loss: 1.321004, loss_ss: 1.033591, loss_d: 0.287413
0.6166 --- loss: 1.338002, loss_ss: 0.909044, loss_d: 0.428958
0.6551 --- loss: 1.707120, loss_ss: 1.128699, loss_d: 0.578421
0.6936 --- loss: 2.316821, loss_ss: 1.150293, loss_d: 1.166528
0.7322 --- loss: 1.581405, loss_ss: 1.146160, loss_d: 0.435245
0.7707 --- loss: 1.471040, loss_ss: 1.145194, loss_d: 0.325845
0.8092 --- loss: 1.418155, loss_ss: 1.069963, loss_d: 0.348192
0.8478 --- loss: 1.712903, loss_ss: 0.921302, loss_d: 0.791601
0.8863 --- loss: 1.525432, loss_ss: 1.081792, loss_d: 0.443640
0.9249 --- loss: 1.185450, loss_ss: 0.911900, loss_d: 0.273551
0.9634 --- loss: 1.891433, loss_ss: 1.549595, loss_d: 0.341838
Epoch finished! Loss: 1.5914208281454432
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.451411, loss_ss: 1.000942, loss_d: 0.450469
0.0385 --- loss: 1.065204, loss_ss: 0.828484, loss_d: 0.236721
0.0771 --- loss: 2.031822, loss_ss: 1.161654, loss_d: 0.870168
0.1156 --- loss: 1.451092, loss_ss: 1.090145, loss_d: 0.360947
0.1541 --- loss: 1.297006, loss_ss: 1.025307, loss_d: 0.271699
0.1927 --- loss: 2.019387, loss_ss: 1.412002, loss_d: 0.607385
0.2312 --- loss: 1.264247, loss_ss: 0.948875, loss_d: 0.315372
0.2697 --- loss: 1.585172, loss_ss: 1.185638, loss_d: 0.399534
0.3083 --- loss: 1.471644, loss_ss: 1.067307, loss_d: 0.404336
0.3468 --- loss: 1.238995, loss_ss: 0.911007, loss_d: 0.327988
0.3854 --- loss: 1.589966, loss_ss: 1.184181, loss_d: 0.405785
0.4239 --- loss: 1.324089, loss_ss: 1.017057, loss_d: 0.307032
0.4624 --- loss: 1.524778, loss_ss: 1.307541, loss_d: 0.217237
0.5010 --- loss: 1.664948, loss_ss: 1.123149, loss_d: 0.541798
0.5395 --- loss: 1.548480, loss_ss: 1.145801, loss_d: 0.402679
0.5780 --- loss: 1.482839, loss_ss: 1.164286, loss_d: 0.318554
0.6166 --- loss: 1.326133, loss_ss: 1.060918, loss_d: 0.265215
0.6551 --- loss: 1.409508, loss_ss: 1.075375, loss_d: 0.334133
0.6936 --- loss: 1.964795, loss_ss: 1.286072, loss_d: 0.678723
0.7322 --- loss: 2.029531, loss_ss: 1.176339, loss_d: 0.853192
0.7707 --- loss: 1.294636, loss_ss: 0.947316, loss_d: 0.347320
0.8092 --- loss: 1.669312, loss_ss: 1.052459, loss_d: 0.616853
0.8478 --- loss: 1.574203, loss_ss: 1.158054, loss_d: 0.416148
0.8863 --- loss: 1.263832, loss_ss: 0.935167, loss_d: 0.328665
0.9249 --- loss: 1.752060, loss_ss: 1.182103, loss_d: 0.569957
0.9634 --- loss: 1.957120, loss_ss: 1.038638, loss_d: 0.918481
Epoch finished! Loss: 1.545968609426933
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.691857, loss_ss: 1.229558, loss_d: 0.462299
0.0385 --- loss: 1.562305, loss_ss: 1.158140, loss_d: 0.404165
0.0771 --- loss: 1.603884, loss_ss: 1.190174, loss_d: 0.413710
0.1156 --- loss: 1.688110, loss_ss: 1.248140, loss_d: 0.439970
0.1541 --- loss: 1.713997, loss_ss: 1.102722, loss_d: 0.611275
0.1927 --- loss: 1.766486, loss_ss: 0.972634, loss_d: 0.793852
0.2312 --- loss: 1.560976, loss_ss: 1.283737, loss_d: 0.277239
0.2697 --- loss: 1.195329, loss_ss: 0.860310, loss_d: 0.335020
0.3083 --- loss: 1.309389, loss_ss: 1.003435, loss_d: 0.305954
0.3468 --- loss: 1.359980, loss_ss: 1.123494, loss_d: 0.236486
0.3854 --- loss: 1.607148, loss_ss: 1.159578, loss_d: 0.447570
0.4239 --- loss: 1.657753, loss_ss: 1.058575, loss_d: 0.599178
0.4624 --- loss: 1.632915, loss_ss: 1.236901, loss_d: 0.396014
0.5010 --- loss: 1.833062, loss_ss: 0.972934, loss_d: 0.860128
0.5395 --- loss: 1.262994, loss_ss: 0.868898, loss_d: 0.394096
0.5780 --- loss: 1.827477, loss_ss: 1.165987, loss_d: 0.661491
0.6166 --- loss: 1.355734, loss_ss: 0.972040, loss_d: 0.383694
0.6551 --- loss: 1.637772, loss_ss: 1.221394, loss_d: 0.416378
0.6936 --- loss: 1.475599, loss_ss: 0.819200, loss_d: 0.656399
0.7322 --- loss: 1.535062, loss_ss: 0.985357, loss_d: 0.549705
0.7707 --- loss: 1.314983, loss_ss: 0.960315, loss_d: 0.354668
0.8092 --- loss: 1.572537, loss_ss: 0.948956, loss_d: 0.623581
0.8478 --- loss: 1.645279, loss_ss: 1.424060, loss_d: 0.221219
0.8863 --- loss: 1.476716, loss_ss: 1.135967, loss_d: 0.340749
0.9249 --- loss: 1.358055, loss_ss: 0.973807, loss_d: 0.384248
0.9634 --- loss: 1.329843, loss_ss: 1.090791, loss_d: 0.239052
Epoch finished! Loss: 1.5212240555111505
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 2.282910, loss_ss: 0.947688, loss_d: 1.335223
0.0385 --- loss: 1.261768, loss_ss: 0.990856, loss_d: 0.270912
0.0771 --- loss: 1.472375, loss_ss: 1.049946, loss_d: 0.422429
0.1156 --- loss: 1.422223, loss_ss: 1.135965, loss_d: 0.286259
0.1541 --- loss: 1.488069, loss_ss: 1.108797, loss_d: 0.379272
0.1927 --- loss: 1.318785, loss_ss: 1.052843, loss_d: 0.265942
0.2312 --- loss: 1.457795, loss_ss: 0.998363, loss_d: 0.459432
0.2697 --- loss: 1.532750, loss_ss: 1.211423, loss_d: 0.321327
0.3083 --- loss: 1.345141, loss_ss: 0.877406, loss_d: 0.467735
0.3468 --- loss: 1.442914, loss_ss: 1.221619, loss_d: 0.221295
0.3854 --- loss: 1.641303, loss_ss: 1.335340, loss_d: 0.305963
0.4239 --- loss: 1.744912, loss_ss: 1.172168, loss_d: 0.572744
0.4624 --- loss: 1.585668, loss_ss: 1.163162, loss_d: 0.422505
0.5010 --- loss: 0.988979, loss_ss: 0.681115, loss_d: 0.307864
0.5395 --- loss: 1.502033, loss_ss: 1.064215, loss_d: 0.437818
0.5780 --- loss: 1.282416, loss_ss: 0.971678, loss_d: 0.310739
0.6166 --- loss: 1.527289, loss_ss: 0.915866, loss_d: 0.611423
0.6551 --- loss: 1.166481, loss_ss: 0.851601, loss_d: 0.314881
0.6936 --- loss: 1.447313, loss_ss: 1.090779, loss_d: 0.356534
0.7322 --- loss: 1.677617, loss_ss: 0.919224, loss_d: 0.758393
0.7707 --- loss: 1.450961, loss_ss: 1.045671, loss_d: 0.405290
0.8092 --- loss: 1.426086, loss_ss: 0.964292, loss_d: 0.461794
0.8478 --- loss: 1.346201, loss_ss: 0.987516, loss_d: 0.358685
0.8863 --- loss: 1.927387, loss_ss: 1.544421, loss_d: 0.382965
0.9249 --- loss: 1.135093, loss_ss: 0.853949, loss_d: 0.281144
0.9634 --- loss: 1.397077, loss_ss: 1.061952, loss_d: 0.335125
Epoch finished! Loss: 1.5285573944622024
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.095197, loss_ss: 1.728834, loss_d: 0.366362
0.0385 --- loss: 1.797521, loss_ss: 1.369001, loss_d: 0.428520
0.0771 --- loss: 2.270170, loss_ss: 1.158293, loss_d: 1.111876
0.1156 --- loss: 1.219257, loss_ss: 0.937098, loss_d: 0.282159
0.1541 --- loss: 1.378298, loss_ss: 0.851243, loss_d: 0.527055
0.1927 --- loss: 1.484873, loss_ss: 1.114810, loss_d: 0.370063
0.2312 --- loss: 1.534770, loss_ss: 1.186608, loss_d: 0.348163
0.2697 --- loss: 1.669387, loss_ss: 1.272032, loss_d: 0.397355
0.3083 --- loss: 1.246820, loss_ss: 0.970472, loss_d: 0.276348
0.3468 --- loss: 1.321448, loss_ss: 1.067979, loss_d: 0.253469
0.3854 --- loss: 1.523953, loss_ss: 0.906813, loss_d: 0.617141
0.4239 --- loss: 1.170238, loss_ss: 0.847710, loss_d: 0.322528
0.4624 --- loss: 1.818086, loss_ss: 1.031521, loss_d: 0.786565
0.5010 --- loss: 1.608010, loss_ss: 1.107569, loss_d: 0.500441
0.5395 --- loss: 1.292230, loss_ss: 0.895681, loss_d: 0.396549
0.5780 --- loss: 1.279845, loss_ss: 0.857444, loss_d: 0.422400
0.6166 --- loss: 1.474077, loss_ss: 1.133579, loss_d: 0.340498
0.6551 --- loss: 1.962186, loss_ss: 0.906045, loss_d: 1.056141
0.6936 --- loss: 1.319620, loss_ss: 0.928135, loss_d: 0.391485
0.7322 --- loss: 1.495848, loss_ss: 1.223784, loss_d: 0.272064
0.7707 --- loss: 1.389611, loss_ss: 0.998775, loss_d: 0.390837
0.8092 --- loss: 1.532973, loss_ss: 1.189922, loss_d: 0.343051
0.8478 --- loss: 1.287599, loss_ss: 0.956011, loss_d: 0.331589
0.8863 --- loss: 1.598979, loss_ss: 1.314413, loss_d: 0.284567
0.9249 --- loss: 1.016118, loss_ss: 0.816671, loss_d: 0.199447
0.9634 --- loss: 1.191110, loss_ss: 0.999702, loss_d: 0.191408
Epoch finished! Loss: 1.5020417660819978
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4511627906976744
             precision    recall  f1-score   support

        0.0       0.54      0.19      0.28        69
        1.0       0.00      0.00      0.00       238
        2.0       0.53      0.90      0.67       565
        3.0       0.19      0.43      0.26       136
        4.0       0.00      0.00      0.00       282

avg / total       0.28      0.45      0.34      1290
 


====== chp005-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.81  18.84   99.10  54.17     27.96
1  81.55   0.00  100.00   0.00      0.00
2  60.93  90.44   37.93  53.17     66.97
3  74.81  42.65   78.60  19.02     26.30
4  78.14   0.00  100.00   0.00      0.00
Total accuracy: 45.12%
Average sen: 30.39%
Average spec: 83.13%
Macro f1-score: 24.25%
[0.65781754 0.43665212 0.49086753 0.61455214 0.67229235 0.68031746
 0.66175681 0.61083651 0.66787571 0.66695577 0.63256878 0.56049889
 0.69333673 0.70580351 0.65111071 0.69260073 0.67574912 0.67122167
 0.66554374 0.71109194 0.72280085 0.7281189  0.75023568 0.73619288
 0.72773272 0.66007799 0.58430493 0.6283294  0.73707235 0.78054172
 0.75252175 0.73951352 0.72453076 0.72549325 0.69633394 0.75492895
 0.72914308 0.71229666 0.69028473 0.64233398 0.66472441 0.66792911
 0.74068141]
pred: 0.677106342343397, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.126943, loss_ss: 1.458640, loss_d: 0.668303
0.0384 --- loss: 1.998115, loss_ss: 1.543131, loss_d: 0.454984
0.0769 --- loss: 2.120880, loss_ss: 1.586525, loss_d: 0.534354
0.1153 --- loss: 2.439136, loss_ss: 1.669497, loss_d: 0.769639
0.1537 --- loss: 2.181133, loss_ss: 1.608399, loss_d: 0.572735
0.1922 --- loss: 1.794456, loss_ss: 1.469766, loss_d: 0.324690
0.2306 --- loss: 1.834656, loss_ss: 1.513704, loss_d: 0.320951
0.2690 --- loss: 1.999839, loss_ss: 1.544697, loss_d: 0.455142
0.3075 --- loss: 2.090726, loss_ss: 1.681970, loss_d: 0.408756
0.3459 --- loss: 1.731936, loss_ss: 1.403680, loss_d: 0.328256
0.3843 --- loss: 2.449998, loss_ss: 1.519432, loss_d: 0.930566
0.4228 --- loss: 2.131947, loss_ss: 1.501124, loss_d: 0.630822
0.4612 --- loss: 2.085503, loss_ss: 1.529690, loss_d: 0.555813
0.4996 --- loss: 2.860391, loss_ss: 1.493629, loss_d: 1.366762
0.5380 --- loss: 1.981689, loss_ss: 1.569303, loss_d: 0.412386
0.5765 --- loss: 2.235486, loss_ss: 1.516830, loss_d: 0.718656
0.6149 --- loss: 1.936050, loss_ss: 1.467432, loss_d: 0.468618
0.6533 --- loss: 1.747383, loss_ss: 1.404561, loss_d: 0.342822
0.6918 --- loss: 2.164866, loss_ss: 1.632442, loss_d: 0.532424
0.7302 --- loss: 2.118591, loss_ss: 1.579286, loss_d: 0.539305
0.7686 --- loss: 2.423719, loss_ss: 1.353190, loss_d: 1.070529
0.8071 --- loss: 1.735927, loss_ss: 1.371873, loss_d: 0.364053
0.8455 --- loss: 2.250979, loss_ss: 1.548455, loss_d: 0.702525
0.8839 --- loss: 2.183969, loss_ss: 1.645851, loss_d: 0.538118
0.9224 --- loss: 1.832471, loss_ss: 1.278813, loss_d: 0.553658
0.9608 --- loss: 2.327859, loss_ss: 1.709901, loss_d: 0.617958
0.9992 --- loss: 1.982635, loss_ss: 1.749963, loss_d: 0.232672
Epoch finished! Loss: 2.1091544082531564
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.113548, loss_ss: 1.489702, loss_d: 0.623846
0.0384 --- loss: 2.154874, loss_ss: 1.457557, loss_d: 0.697317
0.0769 --- loss: 2.498538, loss_ss: 1.298788, loss_d: 1.199750
0.1153 --- loss: 1.841153, loss_ss: 1.432311, loss_d: 0.408842
0.1537 --- loss: 1.934553, loss_ss: 1.434327, loss_d: 0.500226
0.1922 --- loss: 1.847868, loss_ss: 1.397359, loss_d: 0.450509
0.2306 --- loss: 1.867226, loss_ss: 1.292921, loss_d: 0.574304
0.2690 --- loss: 1.841604, loss_ss: 1.444757, loss_d: 0.396847
0.3075 --- loss: 1.772785, loss_ss: 1.463834, loss_d: 0.308951
0.3459 --- loss: 1.833394, loss_ss: 1.422640, loss_d: 0.410754
0.3843 --- loss: 2.084356, loss_ss: 1.577973, loss_d: 0.506383
0.4228 --- loss: 1.966560, loss_ss: 1.423970, loss_d: 0.542590
0.4612 --- loss: 2.084999, loss_ss: 1.582773, loss_d: 0.502226
0.4996 --- loss: 2.019251, loss_ss: 1.388042, loss_d: 0.631208
0.5380 --- loss: 2.006791, loss_ss: 1.495448, loss_d: 0.511343
0.5765 --- loss: 1.852509, loss_ss: 1.301389, loss_d: 0.551121
0.6149 --- loss: 2.020565, loss_ss: 1.462343, loss_d: 0.558222
0.6533 --- loss: 1.928341, loss_ss: 1.451651, loss_d: 0.476691
0.6918 --- loss: 1.962319, loss_ss: 1.721127, loss_d: 0.241192
0.7302 --- loss: 1.878111, loss_ss: 1.402878, loss_d: 0.475233
0.7686 --- loss: 1.900087, loss_ss: 1.567954, loss_d: 0.332133
0.8071 --- loss: 1.961758, loss_ss: 1.511497, loss_d: 0.450261
0.8455 --- loss: 1.837195, loss_ss: 1.485600, loss_d: 0.351595
0.8839 --- loss: 1.961390, loss_ss: 1.496027, loss_d: 0.465363
0.9224 --- loss: 1.787372, loss_ss: 1.352328, loss_d: 0.435044
0.9608 --- loss: 1.912627, loss_ss: 1.563468, loss_d: 0.349159
0.9992 --- loss: 3.739601, loss_ss: 2.007625, loss_d: 1.731976
Epoch finished! Loss: 2.0194572563354787
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.828071, loss_ss: 1.507282, loss_d: 0.320789
0.0384 --- loss: 2.149970, loss_ss: 1.547785, loss_d: 0.602184
0.0769 --- loss: 1.942436, loss_ss: 1.441470, loss_d: 0.500966
0.1153 --- loss: 1.666839, loss_ss: 1.388376, loss_d: 0.278463
0.1537 --- loss: 2.402437, loss_ss: 1.561115, loss_d: 0.841322
0.1922 --- loss: 2.119555, loss_ss: 1.392447, loss_d: 0.727109
0.2306 --- loss: 1.745442, loss_ss: 1.307333, loss_d: 0.438109
0.2690 --- loss: 1.863811, loss_ss: 1.471202, loss_d: 0.392609
0.3075 --- loss: 1.852422, loss_ss: 1.538138, loss_d: 0.314284
0.3459 --- loss: 1.880880, loss_ss: 1.463283, loss_d: 0.417597
0.3843 --- loss: 2.001947, loss_ss: 1.369292, loss_d: 0.632655
0.4228 --- loss: 1.973127, loss_ss: 1.649369, loss_d: 0.323759
0.4612 --- loss: 1.961728, loss_ss: 1.433086, loss_d: 0.528642
0.4996 --- loss: 1.966336, loss_ss: 1.567388, loss_d: 0.398949
0.5380 --- loss: 1.872770, loss_ss: 1.405734, loss_d: 0.467035
0.5765 --- loss: 1.707477, loss_ss: 1.244980, loss_d: 0.462497
0.6149 --- loss: 1.734267, loss_ss: 1.271425, loss_d: 0.462842
0.6533 --- loss: 1.513145, loss_ss: 1.183544, loss_d: 0.329601
0.6918 --- loss: 2.176726, loss_ss: 1.766482, loss_d: 0.410245
0.7302 --- loss: 2.045908, loss_ss: 1.412418, loss_d: 0.633490
0.7686 --- loss: 1.916792, loss_ss: 1.273856, loss_d: 0.642936
0.8071 --- loss: 1.837594, loss_ss: 1.448461, loss_d: 0.389133
0.8455 --- loss: 1.882932, loss_ss: 1.428741, loss_d: 0.454192
0.8839 --- loss: 2.030472, loss_ss: 1.526889, loss_d: 0.503583
0.9224 --- loss: 1.882042, loss_ss: 1.452465, loss_d: 0.429577
0.9608 --- loss: 1.814037, loss_ss: 1.326107, loss_d: 0.487930
0.9992 --- loss: 2.200754, loss_ss: 1.965169, loss_d: 0.235586
Epoch finished! Loss: 1.9406761600421025
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.085887, loss_ss: 1.422556, loss_d: 0.663330
0.0384 --- loss: 2.251986, loss_ss: 1.442620, loss_d: 0.809366
0.0769 --- loss: 2.099583, loss_ss: 1.465979, loss_d: 0.633604
0.1153 --- loss: 2.008193, loss_ss: 1.491231, loss_d: 0.516962
0.1537 --- loss: 1.882060, loss_ss: 1.228860, loss_d: 0.653200
0.1922 --- loss: 1.855451, loss_ss: 1.393154, loss_d: 0.462297
0.2306 --- loss: 2.030633, loss_ss: 1.488403, loss_d: 0.542231
0.2690 --- loss: 1.592727, loss_ss: 1.198444, loss_d: 0.394283
0.3075 --- loss: 1.898988, loss_ss: 1.624848, loss_d: 0.274140
0.3459 --- loss: 1.774585, loss_ss: 1.415693, loss_d: 0.358892
0.3843 --- loss: 2.218731, loss_ss: 1.626070, loss_d: 0.592661
0.4228 --- loss: 1.924838, loss_ss: 1.539513, loss_d: 0.385325
0.4612 --- loss: 1.757049, loss_ss: 1.236654, loss_d: 0.520395
0.4996 --- loss: 1.873449, loss_ss: 1.275338, loss_d: 0.598111
0.5380 --- loss: 2.034698, loss_ss: 1.507696, loss_d: 0.527002
0.5765 --- loss: 1.974064, loss_ss: 1.472043, loss_d: 0.502021
0.6149 --- loss: 1.890127, loss_ss: 1.375336, loss_d: 0.514791
0.6533 --- loss: 1.779510, loss_ss: 1.435991, loss_d: 0.343520
0.6918 --- loss: 1.923524, loss_ss: 1.596469, loss_d: 0.327056
0.7302 --- loss: 1.824650, loss_ss: 1.531915, loss_d: 0.292735
0.7686 --- loss: 1.995624, loss_ss: 1.450716, loss_d: 0.544908
0.8071 --- loss: 1.881801, loss_ss: 1.418672, loss_d: 0.463130
0.8455 --- loss: 1.995733, loss_ss: 1.389298, loss_d: 0.606435
0.8839 --- loss: 1.926237, loss_ss: 1.476681, loss_d: 0.449556
0.9224 --- loss: 1.923841, loss_ss: 1.534225, loss_d: 0.389615
0.9608 --- loss: 2.014840, loss_ss: 1.517071, loss_d: 0.497769
0.9992 --- loss: 2.008318, loss_ss: 1.475717, loss_d: 0.532601
Epoch finished! Loss: 1.9129286179175744
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.016521, loss_ss: 1.629642, loss_d: 0.386879
0.0384 --- loss: 1.949458, loss_ss: 1.363262, loss_d: 0.586196
0.0769 --- loss: 1.749504, loss_ss: 1.306137, loss_d: 0.443367
0.1153 --- loss: 1.676070, loss_ss: 1.269414, loss_d: 0.406656
0.1537 --- loss: 1.707591, loss_ss: 1.383986, loss_d: 0.323605
0.1922 --- loss: 1.953141, loss_ss: 1.623763, loss_d: 0.329378
0.2306 --- loss: 1.764538, loss_ss: 1.415529, loss_d: 0.349010
0.2690 --- loss: 1.833868, loss_ss: 1.387745, loss_d: 0.446123
0.3075 --- loss: 1.961000, loss_ss: 1.551347, loss_d: 0.409653
0.3459 --- loss: 2.152392, loss_ss: 1.511521, loss_d: 0.640872
0.3843 --- loss: 1.674998, loss_ss: 1.237152, loss_d: 0.437846
0.4228 --- loss: 1.671202, loss_ss: 1.259010, loss_d: 0.412192
0.4612 --- loss: 1.944401, loss_ss: 1.400588, loss_d: 0.543813
0.4996 --- loss: 2.180661, loss_ss: 1.682369, loss_d: 0.498292
0.5380 --- loss: 1.721038, loss_ss: 1.302316, loss_d: 0.418722
0.5765 --- loss: 1.908931, loss_ss: 1.316366, loss_d: 0.592565
0.6149 --- loss: 1.668792, loss_ss: 1.167191, loss_d: 0.501602
0.6533 --- loss: 2.669091, loss_ss: 1.235941, loss_d: 1.433150
0.6918 --- loss: 1.942639, loss_ss: 1.601587, loss_d: 0.341052
0.7302 --- loss: 1.877955, loss_ss: 1.491748, loss_d: 0.386207
0.7686 --- loss: 1.585367, loss_ss: 1.189587, loss_d: 0.395781
0.8071 --- loss: 1.582059, loss_ss: 1.243904, loss_d: 0.338155
0.8455 --- loss: 1.984873, loss_ss: 1.319205, loss_d: 0.665669
0.8839 --- loss: 1.480925, loss_ss: 1.093167, loss_d: 0.387757
0.9224 --- loss: 1.675125, loss_ss: 1.180056, loss_d: 0.495069
0.9608 --- loss: 1.488009, loss_ss: 1.170637, loss_d: 0.317372
0.9992 --- loss: 1.867032, loss_ss: 1.564242, loss_d: 0.302789
Epoch finished! Loss: 1.8343493906351236
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 2.031298, loss_ss: 1.427917, loss_d: 0.603381
0.0384 --- loss: 1.885016, loss_ss: 1.503240, loss_d: 0.381776
0.0769 --- loss: 1.509493, loss_ss: 1.087970, loss_d: 0.421523
0.1153 --- loss: 1.647073, loss_ss: 1.223810, loss_d: 0.423263
0.1537 --- loss: 1.945323, loss_ss: 1.402387, loss_d: 0.542936
0.1922 --- loss: 1.986077, loss_ss: 1.224506, loss_d: 0.761570
0.2306 --- loss: 1.642962, loss_ss: 1.264768, loss_d: 0.378194
0.2690 --- loss: 1.346908, loss_ss: 1.066145, loss_d: 0.280762
0.3075 --- loss: 1.569027, loss_ss: 1.242467, loss_d: 0.326560
0.3459 --- loss: 2.036540, loss_ss: 1.516453, loss_d: 0.520087
0.3843 --- loss: 1.719521, loss_ss: 1.414972, loss_d: 0.304549
0.4228 --- loss: 1.632445, loss_ss: 1.249256, loss_d: 0.383190
0.4612 --- loss: 1.535291, loss_ss: 1.168938, loss_d: 0.366353
0.4996 --- loss: 2.026670, loss_ss: 1.548528, loss_d: 0.478143
0.5380 --- loss: 1.549177, loss_ss: 1.189520, loss_d: 0.359657
0.5765 --- loss: 1.811105, loss_ss: 1.295892, loss_d: 0.515213
0.6149 --- loss: 1.605054, loss_ss: 1.284727, loss_d: 0.320327
0.6533 --- loss: 1.546456, loss_ss: 0.987915, loss_d: 0.558541
0.6918 --- loss: 1.592652, loss_ss: 1.133543, loss_d: 0.459109
0.7302 --- loss: 1.720198, loss_ss: 1.278013, loss_d: 0.442185
0.7686 --- loss: 1.605696, loss_ss: 1.292522, loss_d: 0.313175
0.8071 --- loss: 1.481966, loss_ss: 0.989434, loss_d: 0.492532
0.8455 --- loss: 1.603573, loss_ss: 1.349835, loss_d: 0.253737
0.8839 --- loss: 1.851671, loss_ss: 1.146114, loss_d: 0.705556
0.9224 --- loss: 2.572050, loss_ss: 1.308949, loss_d: 1.263100
0.9608 --- loss: 1.492957, loss_ss: 1.172022, loss_d: 0.320935
0.9992 --- loss: 2.557344, loss_ss: 2.279170, loss_d: 0.278174
Epoch finished! Loss: 1.73061524950541
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.736722, loss_ss: 1.195140, loss_d: 0.541582
0.0384 --- loss: 1.376563, loss_ss: 1.048706, loss_d: 0.327857
0.0769 --- loss: 1.877868, loss_ss: 1.474706, loss_d: 0.403162
0.1153 --- loss: 1.515484, loss_ss: 1.203720, loss_d: 0.311763
0.1537 --- loss: 1.465143, loss_ss: 1.109160, loss_d: 0.355984
0.1922 --- loss: 1.611496, loss_ss: 1.312963, loss_d: 0.298533
0.2306 --- loss: 1.677459, loss_ss: 1.284161, loss_d: 0.393297
0.2690 --- loss: 1.764231, loss_ss: 1.220640, loss_d: 0.543591
0.3075 --- loss: 1.558353, loss_ss: 1.120807, loss_d: 0.437546
0.3459 --- loss: 1.972455, loss_ss: 1.367773, loss_d: 0.604682
0.3843 --- loss: 1.764164, loss_ss: 1.108620, loss_d: 0.655545
0.4228 --- loss: 1.631111, loss_ss: 1.079873, loss_d: 0.551238
0.4612 --- loss: 1.722085, loss_ss: 1.228134, loss_d: 0.493952
0.4996 --- loss: 1.619280, loss_ss: 1.343192, loss_d: 0.276087
0.5380 --- loss: 2.067402, loss_ss: 1.420105, loss_d: 0.647296
0.5765 --- loss: 1.906268, loss_ss: 1.454107, loss_d: 0.452161
0.6149 --- loss: 1.607122, loss_ss: 1.293770, loss_d: 0.313352
0.6533 --- loss: 1.827347, loss_ss: 1.172582, loss_d: 0.654764
0.6918 --- loss: 1.761863, loss_ss: 1.135827, loss_d: 0.626036
0.7302 --- loss: 1.808961, loss_ss: 1.364423, loss_d: 0.444539
0.7686 --- loss: 1.739647, loss_ss: 1.053836, loss_d: 0.685811
0.8071 --- loss: 1.669652, loss_ss: 1.196681, loss_d: 0.472971
0.8455 --- loss: 1.399693, loss_ss: 1.112968, loss_d: 0.286725
0.8839 --- loss: 1.633632, loss_ss: 1.315353, loss_d: 0.318279
0.9224 --- loss: 1.345575, loss_ss: 1.072772, loss_d: 0.272803
0.9608 --- loss: 1.305100, loss_ss: 0.972900, loss_d: 0.332200
0.9992 --- loss: 1.719985, loss_ss: 1.329557, loss_d: 0.390428
Epoch finished! Loss: 1.6615607500076295
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.616958, loss_ss: 1.332311, loss_d: 0.284647
0.0384 --- loss: 1.618159, loss_ss: 1.311070, loss_d: 0.307089
0.0769 --- loss: 1.332327, loss_ss: 1.066337, loss_d: 0.265990
0.1153 --- loss: 1.420809, loss_ss: 0.965831, loss_d: 0.454979
0.1537 --- loss: 1.853478, loss_ss: 1.283769, loss_d: 0.569709
0.1922 --- loss: 1.374667, loss_ss: 0.958527, loss_d: 0.416140
0.2306 --- loss: 1.521000, loss_ss: 1.193084, loss_d: 0.327917
0.2690 --- loss: 1.498049, loss_ss: 1.135148, loss_d: 0.362901
0.3075 --- loss: 1.558077, loss_ss: 1.251064, loss_d: 0.307013
0.3459 --- loss: 1.079687, loss_ss: 0.828831, loss_d: 0.250856
0.3843 --- loss: 1.194552, loss_ss: 0.997409, loss_d: 0.197143
0.4228 --- loss: 1.633751, loss_ss: 1.343198, loss_d: 0.290553
0.4612 --- loss: 1.811370, loss_ss: 1.547409, loss_d: 0.263961
0.4996 --- loss: 1.663625, loss_ss: 1.304466, loss_d: 0.359159
0.5380 --- loss: 1.363699, loss_ss: 1.063338, loss_d: 0.300361
0.5765 --- loss: 2.214321, loss_ss: 1.101959, loss_d: 1.112361
0.6149 --- loss: 1.280856, loss_ss: 0.927386, loss_d: 0.353469
0.6533 --- loss: 1.939903, loss_ss: 1.211156, loss_d: 0.728747
0.6918 --- loss: 1.603462, loss_ss: 1.287674, loss_d: 0.315788
0.7302 --- loss: 1.392912, loss_ss: 1.053478, loss_d: 0.339434
0.7686 --- loss: 1.525516, loss_ss: 1.142547, loss_d: 0.382969
0.8071 --- loss: 1.590486, loss_ss: 1.180964, loss_d: 0.409522
0.8455 --- loss: 1.432214, loss_ss: 1.101315, loss_d: 0.330899
0.8839 --- loss: 1.851558, loss_ss: 1.303903, loss_d: 0.547655
0.9224 --- loss: 1.737194, loss_ss: 1.046598, loss_d: 0.690596
0.9608 --- loss: 1.719381, loss_ss: 1.272993, loss_d: 0.446388
0.9992 --- loss: 2.012197, loss_ss: 1.718446, loss_d: 0.293750
Epoch finished! Loss: 1.5980757053081807
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.393558, loss_ss: 0.903805, loss_d: 0.489754
0.0384 --- loss: 1.708651, loss_ss: 1.166145, loss_d: 0.542506
0.0769 --- loss: 1.642426, loss_ss: 1.424604, loss_d: 0.217822
0.1153 --- loss: 1.529106, loss_ss: 1.240026, loss_d: 0.289079
0.1537 --- loss: 1.360147, loss_ss: 1.027077, loss_d: 0.333070
0.1922 --- loss: 1.781391, loss_ss: 0.920190, loss_d: 0.861201
0.2306 --- loss: 1.200864, loss_ss: 0.910935, loss_d: 0.289929
0.2690 --- loss: 1.529410, loss_ss: 1.067303, loss_d: 0.462107
0.3075 --- loss: 1.749863, loss_ss: 1.117631, loss_d: 0.632232
0.3459 --- loss: 2.642330, loss_ss: 1.667562, loss_d: 0.974768
0.3843 --- loss: 1.857072, loss_ss: 1.512510, loss_d: 0.344563
0.4228 --- loss: 1.523854, loss_ss: 1.056415, loss_d: 0.467440
0.4612 --- loss: 1.331136, loss_ss: 0.812722, loss_d: 0.518414
0.4996 --- loss: 1.317540, loss_ss: 1.051788, loss_d: 0.265752
0.5380 --- loss: 1.537752, loss_ss: 1.191428, loss_d: 0.346324
0.5765 --- loss: 1.637690, loss_ss: 1.107987, loss_d: 0.529703
0.6149 --- loss: 1.389279, loss_ss: 0.936657, loss_d: 0.452622
0.6533 --- loss: 1.463146, loss_ss: 1.045265, loss_d: 0.417881
0.6918 --- loss: 1.680764, loss_ss: 1.060555, loss_d: 0.620209
0.7302 --- loss: 1.412036, loss_ss: 0.899595, loss_d: 0.512442
0.7686 --- loss: 1.304577, loss_ss: 1.092603, loss_d: 0.211974
0.8071 --- loss: 1.352806, loss_ss: 1.090314, loss_d: 0.262493
0.8455 --- loss: 1.779184, loss_ss: 1.352817, loss_d: 0.426367
0.8839 --- loss: 1.062849, loss_ss: 0.838694, loss_d: 0.224155
0.9224 --- loss: 1.406119, loss_ss: 0.947631, loss_d: 0.458488
0.9608 --- loss: 1.704864, loss_ss: 1.088060, loss_d: 0.616804
0.9992 --- loss: 1.679820, loss_ss: 1.261941, loss_d: 0.417879
Epoch finished! Loss: 1.5737165927886962
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.406818, loss_ss: 1.024894, loss_d: 0.381924
0.0384 --- loss: 1.593562, loss_ss: 1.113211, loss_d: 0.480351
0.0769 --- loss: 1.184534, loss_ss: 0.900751, loss_d: 0.283783
0.1153 --- loss: 2.024707, loss_ss: 1.604613, loss_d: 0.420094
0.1537 --- loss: 2.158574, loss_ss: 0.928319, loss_d: 1.230255
0.1922 --- loss: 1.411466, loss_ss: 1.019899, loss_d: 0.391567
0.2306 --- loss: 1.845226, loss_ss: 1.135146, loss_d: 0.710080
0.2690 --- loss: 1.542838, loss_ss: 1.067199, loss_d: 0.475639
0.3075 --- loss: 1.492444, loss_ss: 0.940605, loss_d: 0.551840
0.3459 --- loss: 1.292671, loss_ss: 1.006732, loss_d: 0.285938
0.3843 --- loss: 1.393289, loss_ss: 1.117488, loss_d: 0.275801
0.4228 --- loss: 1.811600, loss_ss: 1.280731, loss_d: 0.530868
0.4612 --- loss: 1.298839, loss_ss: 1.046891, loss_d: 0.251948
0.4996 --- loss: 1.381143, loss_ss: 1.000389, loss_d: 0.380754
0.5380 --- loss: 1.409184, loss_ss: 1.025732, loss_d: 0.383452
0.5765 --- loss: 1.276869, loss_ss: 0.894675, loss_d: 0.382194
0.6149 --- loss: 1.418747, loss_ss: 0.917920, loss_d: 0.500827
0.6533 --- loss: 2.207862, loss_ss: 1.075505, loss_d: 1.132358
0.6918 --- loss: 1.683629, loss_ss: 1.027165, loss_d: 0.656463
0.7302 --- loss: 1.463253, loss_ss: 1.090886, loss_d: 0.372367
0.7686 --- loss: 1.651588, loss_ss: 1.233223, loss_d: 0.418365
0.8071 --- loss: 1.440118, loss_ss: 0.997438, loss_d: 0.442680
0.8455 --- loss: 1.854369, loss_ss: 1.035620, loss_d: 0.818749
0.8839 --- loss: 1.579214, loss_ss: 1.025574, loss_d: 0.553640
0.9224 --- loss: 2.058699, loss_ss: 1.188733, loss_d: 0.869966
0.9608 --- loss: 1.543098, loss_ss: 1.242784, loss_d: 0.300314
0.9992 --- loss: 1.333412, loss_ss: 1.020940, loss_d: 0.312471
Epoch finished! Loss: 1.5385643656437213
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.2638888888888889
             precision    recall  f1-score   support

        0.0       0.45      0.40      0.42       120
        1.0       0.00      0.00      0.00       322
        2.0       0.08      0.05      0.06       274
        3.0       0.28      1.00      0.43       224
        4.0       0.00      0.00      0.00       140

avg / total       0.13      0.26      0.15      1080
 


====== chp006-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  87.87   40.00   93.85  44.86     42.29
1  70.19    0.00  100.00   0.00      0.00
2  61.85    4.74   81.27   7.93      5.94
3  45.83  100.00   31.66  27.69     43.37
4  87.04    0.00  100.00   0.00      0.00
Total accuracy: 26.39%
Average sen: 28.95%
Average spec: 81.36%
Macro f1-score: 18.32%
[0.9980824  0.99946481 0.99987257 0.99991798 0.99980944 0.99892491
 0.99863392 0.99829847 0.99960452 0.99848038 0.99829215 0.99920744
 0.99858606 0.99970108 0.99991226 0.99972636 0.99804783 0.99828571
 0.9986614  0.99764317 0.99850982 0.9980399  0.99806803 0.99823308
 0.99908376 0.99828726 0.99935466 0.99973112 0.9999032  0.99800593
 0.99766976 0.99786997 0.99844486 0.99771047 0.99787307 0.99905556]
pred: 0.9987498140997357, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.331788, loss_ss: 1.667671, loss_d: 0.664117
0.0385 --- loss: 2.303061, loss_ss: 1.668239, loss_d: 0.634822
0.0769 --- loss: 2.235372, loss_ss: 1.644139, loss_d: 0.591233
0.1154 --- loss: 2.335169, loss_ss: 1.688380, loss_d: 0.646789
0.1538 --- loss: 2.090594, loss_ss: 1.636397, loss_d: 0.454197
0.1923 --- loss: 1.920171, loss_ss: 1.362924, loss_d: 0.557246
0.2308 --- loss: 2.844760, loss_ss: 1.686946, loss_d: 1.157814
0.2692 --- loss: 2.109538, loss_ss: 1.466391, loss_d: 0.643147
0.3077 --- loss: 1.915721, loss_ss: 1.428059, loss_d: 0.487662
0.3462 --- loss: 2.494577, loss_ss: 1.345178, loss_d: 1.149399
0.3846 --- loss: 2.490985, loss_ss: 1.657830, loss_d: 0.833155
0.4231 --- loss: 1.968038, loss_ss: 1.527626, loss_d: 0.440412
0.4615 --- loss: 2.286908, loss_ss: 1.825484, loss_d: 0.461425
0.5000 --- loss: 2.086826, loss_ss: 1.617317, loss_d: 0.469510
0.5385 --- loss: 2.111543, loss_ss: 1.636464, loss_d: 0.475079
0.5769 --- loss: 1.810186, loss_ss: 1.434336, loss_d: 0.375850
0.6154 --- loss: 2.432630, loss_ss: 1.604183, loss_d: 0.828447
0.6538 --- loss: 2.147614, loss_ss: 1.563493, loss_d: 0.584121
0.6923 --- loss: 1.894232, loss_ss: 1.317689, loss_d: 0.576543
0.7308 --- loss: 2.131761, loss_ss: 1.773998, loss_d: 0.357764
0.7692 --- loss: 2.169571, loss_ss: 1.500224, loss_d: 0.669347
0.8077 --- loss: 2.170457, loss_ss: 1.584530, loss_d: 0.585927
0.8462 --- loss: 1.993045, loss_ss: 1.522630, loss_d: 0.470416
0.8846 --- loss: 2.030390, loss_ss: 1.372552, loss_d: 0.657838
0.9231 --- loss: 2.148801, loss_ss: 1.414494, loss_d: 0.734306
0.9615 --- loss: 2.136332, loss_ss: 1.544973, loss_d: 0.591359
Epoch finished! Loss: 2.119954355895289
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.933478, loss_ss: 1.483610, loss_d: 0.449868
0.0385 --- loss: 2.234563, loss_ss: 1.618242, loss_d: 0.616321
0.0769 --- loss: 2.165995, loss_ss: 1.174624, loss_d: 0.991371
0.1154 --- loss: 1.968356, loss_ss: 1.558833, loss_d: 0.409523
0.1538 --- loss: 2.020353, loss_ss: 1.551245, loss_d: 0.469108
0.1923 --- loss: 1.728352, loss_ss: 1.380688, loss_d: 0.347664
0.2308 --- loss: 1.789451, loss_ss: 1.370885, loss_d: 0.418566
0.2692 --- loss: 2.029919, loss_ss: 1.326464, loss_d: 0.703454
0.3077 --- loss: 2.022752, loss_ss: 1.567555, loss_d: 0.455197
0.3462 --- loss: 2.238219, loss_ss: 1.581497, loss_d: 0.656721
0.3846 --- loss: 1.945146, loss_ss: 1.500538, loss_d: 0.444609
0.4231 --- loss: 1.983104, loss_ss: 1.593096, loss_d: 0.390008
0.4615 --- loss: 1.817288, loss_ss: 1.395508, loss_d: 0.421780
0.5000 --- loss: 1.814093, loss_ss: 1.454543, loss_d: 0.359550
0.5385 --- loss: 2.439364, loss_ss: 1.530839, loss_d: 0.908525
0.5769 --- loss: 1.844850, loss_ss: 1.424870, loss_d: 0.419980
0.6154 --- loss: 1.990309, loss_ss: 1.487349, loss_d: 0.502960
0.6538 --- loss: 1.861693, loss_ss: 1.436101, loss_d: 0.425591
0.6923 --- loss: 1.703635, loss_ss: 1.240269, loss_d: 0.463366
0.7308 --- loss: 2.271010, loss_ss: 1.420878, loss_d: 0.850132
0.7692 --- loss: 1.919141, loss_ss: 1.517927, loss_d: 0.401214
0.8077 --- loss: 1.944316, loss_ss: 1.475412, loss_d: 0.468904
0.8462 --- loss: 1.713843, loss_ss: 1.314923, loss_d: 0.398920
0.8846 --- loss: 1.828141, loss_ss: 1.433787, loss_d: 0.394354
0.9231 --- loss: 1.677715, loss_ss: 1.418615, loss_d: 0.259100
0.9615 --- loss: 2.327926, loss_ss: 1.523798, loss_d: 0.804129
Epoch finished! Loss: 1.9936953437834632
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.979410, loss_ss: 1.365892, loss_d: 0.613518
0.0385 --- loss: 2.265718, loss_ss: 1.660846, loss_d: 0.604871
0.0769 --- loss: 2.532026, loss_ss: 1.567678, loss_d: 0.964348
0.1154 --- loss: 2.231796, loss_ss: 1.649656, loss_d: 0.582140
0.1538 --- loss: 2.241125, loss_ss: 1.322091, loss_d: 0.919034
0.1923 --- loss: 2.007513, loss_ss: 1.326675, loss_d: 0.680839
0.2308 --- loss: 1.724641, loss_ss: 1.289698, loss_d: 0.434943
0.2692 --- loss: 2.310489, loss_ss: 1.481664, loss_d: 0.828825
0.3077 --- loss: 1.748054, loss_ss: 1.317409, loss_d: 0.430645
0.3462 --- loss: 1.814021, loss_ss: 1.196362, loss_d: 0.617659
0.3846 --- loss: 1.690444, loss_ss: 1.367653, loss_d: 0.322790
0.4231 --- loss: 1.625733, loss_ss: 1.299104, loss_d: 0.326629
0.4615 --- loss: 2.082726, loss_ss: 1.493111, loss_d: 0.589615
0.5000 --- loss: 1.776898, loss_ss: 1.462364, loss_d: 0.314534
0.5385 --- loss: 2.321902, loss_ss: 1.835010, loss_d: 0.486892
0.5769 --- loss: 1.847383, loss_ss: 1.406195, loss_d: 0.441187
0.6154 --- loss: 1.975439, loss_ss: 1.288244, loss_d: 0.687195
0.6538 --- loss: 1.779756, loss_ss: 1.369655, loss_d: 0.410100
0.6923 --- loss: 1.761311, loss_ss: 1.269716, loss_d: 0.491595
0.7308 --- loss: 1.956933, loss_ss: 1.186542, loss_d: 0.770391
0.7692 --- loss: 1.879693, loss_ss: 1.479513, loss_d: 0.400179
0.8077 --- loss: 1.818361, loss_ss: 1.499560, loss_d: 0.318801
0.8462 --- loss: 2.016758, loss_ss: 1.393330, loss_d: 0.623428
0.8846 --- loss: 1.655713, loss_ss: 1.313882, loss_d: 0.341831
0.9231 --- loss: 2.055860, loss_ss: 1.515182, loss_d: 0.540678
0.9615 --- loss: 1.617905, loss_ss: 1.234215, loss_d: 0.383690
Epoch finished! Loss: 1.8656742328842635
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.736655, loss_ss: 1.343476, loss_d: 0.393179
0.0385 --- loss: 1.731331, loss_ss: 1.232174, loss_d: 0.499156
0.0769 --- loss: 1.556191, loss_ss: 1.274095, loss_d: 0.282096
0.1154 --- loss: 1.703715, loss_ss: 1.380632, loss_d: 0.323083
0.1538 --- loss: 1.797506, loss_ss: 1.192587, loss_d: 0.604919
0.1923 --- loss: 1.972826, loss_ss: 1.372911, loss_d: 0.599916
0.2308 --- loss: 1.931033, loss_ss: 1.138664, loss_d: 0.792369
0.2692 --- loss: 1.733922, loss_ss: 1.229819, loss_d: 0.504103
0.3077 --- loss: 1.802006, loss_ss: 1.287022, loss_d: 0.514984
0.3462 --- loss: 1.620144, loss_ss: 1.042634, loss_d: 0.577510
0.3846 --- loss: 1.780697, loss_ss: 1.290616, loss_d: 0.490082
0.4231 --- loss: 1.707066, loss_ss: 1.088758, loss_d: 0.618308
0.4615 --- loss: 1.764896, loss_ss: 1.268675, loss_d: 0.496221
0.5000 --- loss: 1.778901, loss_ss: 1.184002, loss_d: 0.594899
0.5385 --- loss: 1.638590, loss_ss: 1.262541, loss_d: 0.376049
0.5769 --- loss: 1.774501, loss_ss: 1.426262, loss_d: 0.348240
0.6154 --- loss: 1.469559, loss_ss: 1.136862, loss_d: 0.332697
0.6538 --- loss: 1.924060, loss_ss: 1.516713, loss_d: 0.407347
0.6923 --- loss: 1.622867, loss_ss: 1.244350, loss_d: 0.378518
0.7308 --- loss: 1.758367, loss_ss: 1.254085, loss_d: 0.504281
0.7692 --- loss: 1.689590, loss_ss: 1.197291, loss_d: 0.492299
0.8077 --- loss: 1.974898, loss_ss: 1.459985, loss_d: 0.514913
0.8462 --- loss: 1.559871, loss_ss: 1.143211, loss_d: 0.416660
0.8846 --- loss: 1.738033, loss_ss: 1.311672, loss_d: 0.426361
0.9231 --- loss: 1.578504, loss_ss: 1.093825, loss_d: 0.484679
0.9615 --- loss: 1.658164, loss_ss: 1.287941, loss_d: 0.370222
Epoch finished! Loss: 1.7721855847531764
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.566611, loss_ss: 1.286053, loss_d: 1.280559
0.0385 --- loss: 1.750199, loss_ss: 1.449506, loss_d: 0.300693
0.0769 --- loss: 1.403519, loss_ss: 1.055696, loss_d: 0.347823
0.1154 --- loss: 1.556710, loss_ss: 1.153714, loss_d: 0.402995
0.1538 --- loss: 1.696753, loss_ss: 1.243241, loss_d: 0.453512
0.1923 --- loss: 1.708383, loss_ss: 1.220926, loss_d: 0.487457
0.2308 --- loss: 1.773477, loss_ss: 1.376543, loss_d: 0.396933
0.2692 --- loss: 1.585189, loss_ss: 1.088407, loss_d: 0.496782
0.3077 --- loss: 2.525905, loss_ss: 1.921506, loss_d: 0.604399
0.3462 --- loss: 2.141120, loss_ss: 1.497824, loss_d: 0.643296
0.3846 --- loss: 1.592295, loss_ss: 1.092583, loss_d: 0.499711
0.4231 --- loss: 1.685720, loss_ss: 1.025159, loss_d: 0.660562
0.4615 --- loss: 1.978597, loss_ss: 1.199761, loss_d: 0.778836
0.5000 --- loss: 1.426624, loss_ss: 1.090116, loss_d: 0.336508
0.5385 --- loss: 1.790688, loss_ss: 1.311875, loss_d: 0.478813
0.5769 --- loss: 1.832794, loss_ss: 1.097982, loss_d: 0.734812
0.6154 --- loss: 1.672904, loss_ss: 1.248377, loss_d: 0.424527
0.6538 --- loss: 1.563738, loss_ss: 1.222364, loss_d: 0.341374
0.6923 --- loss: 1.606416, loss_ss: 1.037810, loss_d: 0.568606
0.7308 --- loss: 1.515515, loss_ss: 1.084696, loss_d: 0.430819
0.7692 --- loss: 1.832954, loss_ss: 1.371079, loss_d: 0.461876
0.8077 --- loss: 1.752441, loss_ss: 1.272949, loss_d: 0.479492
0.8462 --- loss: 1.924981, loss_ss: 1.269626, loss_d: 0.655355
0.8846 --- loss: 1.644588, loss_ss: 1.142764, loss_d: 0.501825
0.9231 --- loss: 1.615204, loss_ss: 1.225909, loss_d: 0.389295
0.9615 --- loss: 1.576273, loss_ss: 1.202442, loss_d: 0.373831
Epoch finished! Loss: 1.7127209897207016
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.791059, loss_ss: 1.374241, loss_d: 0.416818
0.0385 --- loss: 1.388794, loss_ss: 1.029797, loss_d: 0.358996
0.0769 --- loss: 1.462176, loss_ss: 1.114473, loss_d: 0.347703
0.1154 --- loss: 1.908902, loss_ss: 0.987097, loss_d: 0.921805
0.1538 --- loss: 1.499061, loss_ss: 1.207084, loss_d: 0.291977
0.1923 --- loss: 1.714001, loss_ss: 1.231942, loss_d: 0.482058
0.2308 --- loss: 1.599698, loss_ss: 1.141039, loss_d: 0.458659
0.2692 --- loss: 1.674751, loss_ss: 1.269860, loss_d: 0.404892
0.3077 --- loss: 1.430249, loss_ss: 1.031375, loss_d: 0.398874
0.3462 --- loss: 2.194527, loss_ss: 1.169387, loss_d: 1.025140
0.3846 --- loss: 1.848717, loss_ss: 1.199242, loss_d: 0.649475
0.4231 --- loss: 1.838428, loss_ss: 1.151922, loss_d: 0.686506
0.4615 --- loss: 1.757862, loss_ss: 1.080402, loss_d: 0.677460
0.5000 --- loss: 1.318583, loss_ss: 0.848950, loss_d: 0.469633
0.5385 --- loss: 1.838761, loss_ss: 1.109624, loss_d: 0.729137
0.5769 --- loss: 1.727824, loss_ss: 1.414694, loss_d: 0.313130
0.6154 --- loss: 1.627255, loss_ss: 1.274385, loss_d: 0.352870
0.6538 --- loss: 1.583701, loss_ss: 1.201866, loss_d: 0.381836
0.6923 --- loss: 1.178201, loss_ss: 0.914508, loss_d: 0.263692
0.7308 --- loss: 2.118586, loss_ss: 1.244443, loss_d: 0.874144
0.7692 --- loss: 1.605536, loss_ss: 1.077512, loss_d: 0.528024
0.8077 --- loss: 1.863275, loss_ss: 1.293124, loss_d: 0.570150
0.8462 --- loss: 1.507454, loss_ss: 1.050018, loss_d: 0.457436
0.8846 --- loss: 1.854603, loss_ss: 1.209548, loss_d: 0.645055
0.9231 --- loss: 1.259316, loss_ss: 0.955918, loss_d: 0.303398
0.9615 --- loss: 1.672265, loss_ss: 1.315338, loss_d: 0.356926
Epoch finished! Loss: 1.6486131371678532
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.583027, loss_ss: 1.044676, loss_d: 0.538351
0.0385 --- loss: 1.580612, loss_ss: 1.253800, loss_d: 0.326812
0.0769 --- loss: 1.396224, loss_ss: 1.024262, loss_d: 0.371962
0.1154 --- loss: 1.891091, loss_ss: 1.466815, loss_d: 0.424276
0.1538 --- loss: 1.498100, loss_ss: 1.059952, loss_d: 0.438147
0.1923 --- loss: 1.462273, loss_ss: 0.994181, loss_d: 0.468091
0.2308 --- loss: 1.521549, loss_ss: 0.822062, loss_d: 0.699487
0.2692 --- loss: 1.467638, loss_ss: 0.992168, loss_d: 0.475470
0.3077 --- loss: 1.734798, loss_ss: 1.438362, loss_d: 0.296435
0.3462 --- loss: 1.607123, loss_ss: 1.188431, loss_d: 0.418692
0.3846 --- loss: 2.005889, loss_ss: 1.359133, loss_d: 0.646756
0.4231 --- loss: 1.509151, loss_ss: 1.117163, loss_d: 0.391988
0.4615 --- loss: 2.075934, loss_ss: 0.991767, loss_d: 1.084167
0.5000 --- loss: 2.026624, loss_ss: 1.613770, loss_d: 0.412854
0.5385 --- loss: 1.503121, loss_ss: 1.072381, loss_d: 0.430740
0.5769 --- loss: 1.567804, loss_ss: 1.186797, loss_d: 0.381007
0.6154 --- loss: 1.354104, loss_ss: 1.017179, loss_d: 0.336924
0.6538 --- loss: 1.595835, loss_ss: 1.317007, loss_d: 0.278828
0.6923 --- loss: 1.801633, loss_ss: 1.452247, loss_d: 0.349386
0.7308 --- loss: 1.666682, loss_ss: 1.177509, loss_d: 0.489173
0.7692 --- loss: 1.583850, loss_ss: 1.176512, loss_d: 0.407338
0.8077 --- loss: 1.304997, loss_ss: 0.928097, loss_d: 0.376900
0.8462 --- loss: 1.768065, loss_ss: 1.225029, loss_d: 0.543036
0.8846 --- loss: 2.376489, loss_ss: 1.404125, loss_d: 0.972364
0.9231 --- loss: 1.318304, loss_ss: 0.897270, loss_d: 0.421034
0.9615 --- loss: 1.442395, loss_ss: 1.112972, loss_d: 0.329423
Epoch finished! Loss: 1.6388648347965078
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.232203, loss_ss: 0.895734, loss_d: 0.336469
0.0385 --- loss: 2.004441, loss_ss: 1.191121, loss_d: 0.813320
0.0769 --- loss: 1.553857, loss_ss: 1.083601, loss_d: 0.470257
0.1154 --- loss: 1.871913, loss_ss: 1.130769, loss_d: 0.741144
0.1538 --- loss: 1.701510, loss_ss: 0.959954, loss_d: 0.741557
0.1923 --- loss: 1.306411, loss_ss: 0.953559, loss_d: 0.352852
0.2308 --- loss: 1.472684, loss_ss: 1.092160, loss_d: 0.380524
0.2692 --- loss: 1.845239, loss_ss: 1.353765, loss_d: 0.491473
0.3077 --- loss: 1.868009, loss_ss: 1.409824, loss_d: 0.458184
0.3462 --- loss: 1.572460, loss_ss: 0.937726, loss_d: 0.634735
0.3846 --- loss: 1.633614, loss_ss: 1.285865, loss_d: 0.347749
0.4231 --- loss: 1.332679, loss_ss: 0.978347, loss_d: 0.354332
0.4615 --- loss: 2.180262, loss_ss: 1.075207, loss_d: 1.105055
0.5000 --- loss: 1.897879, loss_ss: 0.982754, loss_d: 0.915126
0.5385 --- loss: 1.335361, loss_ss: 0.956509, loss_d: 0.378852
0.5769 --- loss: 1.401473, loss_ss: 1.009697, loss_d: 0.391776
0.6154 --- loss: 1.712220, loss_ss: 1.175102, loss_d: 0.537118
0.6538 --- loss: 1.586295, loss_ss: 1.041436, loss_d: 0.544858
0.6923 --- loss: 1.454143, loss_ss: 1.043192, loss_d: 0.410951
0.7308 --- loss: 1.263951, loss_ss: 0.869165, loss_d: 0.394787
0.7692 --- loss: 1.671613, loss_ss: 1.228464, loss_d: 0.443150
0.8077 --- loss: 1.444777, loss_ss: 1.172791, loss_d: 0.271986
0.8462 --- loss: 2.098635, loss_ss: 1.569630, loss_d: 0.529006
0.8846 --- loss: 1.364215, loss_ss: 0.957678, loss_d: 0.406537
0.9231 --- loss: 1.341767, loss_ss: 1.079122, loss_d: 0.262645
0.9615 --- loss: 1.902862, loss_ss: 1.445845, loss_d: 0.457017
Epoch finished! Loss: 1.5911483331996963
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.616114, loss_ss: 0.912210, loss_d: 0.703903
0.0385 --- loss: 1.501957, loss_ss: 1.004825, loss_d: 0.497131
0.0769 --- loss: 1.967233, loss_ss: 1.203035, loss_d: 0.764198
0.1154 --- loss: 1.780415, loss_ss: 1.508687, loss_d: 0.271728
0.1538 --- loss: 1.375845, loss_ss: 1.028492, loss_d: 0.347353
0.1923 --- loss: 1.289947, loss_ss: 0.881601, loss_d: 0.408346
0.2308 --- loss: 1.342487, loss_ss: 0.963199, loss_d: 0.379288
0.2692 --- loss: 1.307288, loss_ss: 0.961745, loss_d: 0.345543
0.3077 --- loss: 1.552558, loss_ss: 1.094423, loss_d: 0.458134
0.3462 --- loss: 1.225925, loss_ss: 0.955265, loss_d: 0.270660
0.3846 --- loss: 1.783615, loss_ss: 1.300994, loss_d: 0.482621
0.4231 --- loss: 2.128346, loss_ss: 1.650526, loss_d: 0.477820
0.4615 --- loss: 1.441141, loss_ss: 1.006147, loss_d: 0.434995
0.5000 --- loss: 1.238419, loss_ss: 0.867123, loss_d: 0.371296
0.5385 --- loss: 1.668665, loss_ss: 1.232344, loss_d: 0.436321
0.5769 --- loss: 1.687665, loss_ss: 1.278822, loss_d: 0.408842
0.6154 --- loss: 1.567824, loss_ss: 1.126739, loss_d: 0.441084
0.6538 --- loss: 1.497584, loss_ss: 1.072845, loss_d: 0.424739
0.6923 --- loss: 1.358493, loss_ss: 0.947264, loss_d: 0.411229
0.7308 --- loss: 1.647194, loss_ss: 0.996706, loss_d: 0.650488
0.7692 --- loss: 1.327550, loss_ss: 1.016366, loss_d: 0.311184
0.8077 --- loss: 1.548624, loss_ss: 0.933288, loss_d: 0.615336
0.8462 --- loss: 1.438468, loss_ss: 1.077156, loss_d: 0.361311
0.8846 --- loss: 1.765941, loss_ss: 1.226750, loss_d: 0.539191
0.9231 --- loss: 1.804147, loss_ss: 1.150358, loss_d: 0.653789
0.9615 --- loss: 1.711064, loss_ss: 1.319781, loss_d: 0.391283
Epoch finished! Loss: 1.5730963963799496
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.701497, loss_ss: 1.295297, loss_d: 0.406200
0.0385 --- loss: 1.589072, loss_ss: 1.326714, loss_d: 0.262358
0.0769 --- loss: 2.047423, loss_ss: 1.560688, loss_d: 0.486735
0.1154 --- loss: 1.383394, loss_ss: 1.041986, loss_d: 0.341408
0.1538 --- loss: 1.614817, loss_ss: 1.230631, loss_d: 0.384186
0.1923 --- loss: 1.631438, loss_ss: 1.177214, loss_d: 0.454224
0.2308 --- loss: 1.845524, loss_ss: 0.992366, loss_d: 0.853158
0.2692 --- loss: 1.557209, loss_ss: 1.239856, loss_d: 0.317353
0.3077 --- loss: 1.402234, loss_ss: 1.005510, loss_d: 0.396724
0.3462 --- loss: 1.384278, loss_ss: 0.998838, loss_d: 0.385439
0.3846 --- loss: 1.594624, loss_ss: 1.124980, loss_d: 0.469644
0.4231 --- loss: 1.791428, loss_ss: 1.318671, loss_d: 0.472757
0.4615 --- loss: 1.902609, loss_ss: 1.261231, loss_d: 0.641378
0.5000 --- loss: 1.257372, loss_ss: 0.757993, loss_d: 0.499379
0.5385 --- loss: 1.542061, loss_ss: 1.226848, loss_d: 0.315213
0.5769 --- loss: 1.572318, loss_ss: 1.194909, loss_d: 0.377409
0.6154 --- loss: 1.381168, loss_ss: 1.001166, loss_d: 0.380002
0.6538 --- loss: 1.564202, loss_ss: 1.247801, loss_d: 0.316401
0.6923 --- loss: 1.328540, loss_ss: 1.055546, loss_d: 0.272994
0.7308 --- loss: 1.526837, loss_ss: 1.118333, loss_d: 0.408504
0.7692 --- loss: 1.554111, loss_ss: 1.146578, loss_d: 0.407533
0.8077 --- loss: 1.363565, loss_ss: 1.032701, loss_d: 0.330864
0.8462 --- loss: 1.807682, loss_ss: 0.836528, loss_d: 0.971154
0.8846 --- loss: 1.236771, loss_ss: 0.927694, loss_d: 0.309076
0.9231 --- loss: 1.602012, loss_ss: 1.127198, loss_d: 0.474815
0.9615 --- loss: 1.424629, loss_ss: 0.860795, loss_d: 0.563834
Epoch finished! Loss: 1.5437257188627618
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4666666666666667
             precision    recall  f1-score   support

        0.0       0.29      0.95      0.44       166
        1.0       0.00      0.00      0.00        58
        2.0       0.00      0.00      0.00       397
        3.0       0.57      0.96      0.72       165
        4.0       0.68      0.61      0.64       354

avg / total       0.34      0.47      0.37      1140
 


====== chp007-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  65.18  95.18   60.06  28.88     44.32
1  94.91   0.00  100.00   0.00      0.00
2  65.18   0.00  100.00   0.00      0.00
3  89.04  96.36   87.79  57.19     71.78
4  79.04  60.73   87.28  68.25     64.28
Total accuracy: 46.67%
Average sen: 50.46%
Average spec: 87.03%
Macro f1-score: 36.08%
[0.58587611 0.27666476 0.29226977 0.45378736 0.81411487 0.31856811
 0.64088434 0.93980742 0.84608853 0.89380962 0.57991898 0.29612213
 0.32381788 0.16936366 0.29753426 0.34905404 0.89700723 0.810013
 0.34935063 0.17996833 0.39134464 0.47132444 0.36065534 0.30840281
 0.20325956 0.38788393 0.31501472 0.62238461 0.65967864 0.20350735
 0.6216433  0.2648463  0.86738646 0.88868636 0.59374303 0.69515079
 0.17006704 0.26035741]
pred: 0.48945678221551997, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.317083, loss_ss: 1.670249, loss_d: 0.646834
0.0384 --- loss: 2.392550, loss_ss: 1.625283, loss_d: 0.767267
0.0767 --- loss: 2.147539, loss_ss: 1.735090, loss_d: 0.412449
0.1151 --- loss: 2.266466, loss_ss: 1.717697, loss_d: 0.548769
0.1534 --- loss: 2.093257, loss_ss: 1.574883, loss_d: 0.518374
0.1918 --- loss: 1.936561, loss_ss: 1.612633, loss_d: 0.323927
0.2301 --- loss: 2.471095, loss_ss: 1.605375, loss_d: 0.865720
0.2685 --- loss: 2.000542, loss_ss: 1.679657, loss_d: 0.320885
0.3069 --- loss: 1.956559, loss_ss: 1.555290, loss_d: 0.401268
0.3452 --- loss: 2.056268, loss_ss: 1.670649, loss_d: 0.385619
0.3836 --- loss: 2.289393, loss_ss: 1.478616, loss_d: 0.810776
0.4219 --- loss: 2.155005, loss_ss: 1.557728, loss_d: 0.597278
0.4603 --- loss: 1.890545, loss_ss: 1.566812, loss_d: 0.323733
0.4987 --- loss: 2.110118, loss_ss: 1.589449, loss_d: 0.520670
0.5370 --- loss: 1.857329, loss_ss: 1.462018, loss_d: 0.395310
0.5754 --- loss: 2.045083, loss_ss: 1.657228, loss_d: 0.387855
0.6137 --- loss: 2.107267, loss_ss: 1.663841, loss_d: 0.443426
0.6521 --- loss: 2.204623, loss_ss: 1.516222, loss_d: 0.688401
0.6904 --- loss: 2.098599, loss_ss: 1.596675, loss_d: 0.501924
0.7288 --- loss: 2.019489, loss_ss: 1.638989, loss_d: 0.380500
0.7672 --- loss: 2.127724, loss_ss: 1.650896, loss_d: 0.476828
0.8055 --- loss: 2.272344, loss_ss: 1.543773, loss_d: 0.728570
0.8439 --- loss: 2.006816, loss_ss: 1.557870, loss_d: 0.448946
0.8822 --- loss: 2.101182, loss_ss: 1.500969, loss_d: 0.600213
0.9206 --- loss: 1.913180, loss_ss: 1.449491, loss_d: 0.463689
0.9590 --- loss: 2.080349, loss_ss: 1.576638, loss_d: 0.503711
0.9973 --- loss: 1.848332, loss_ss: 1.402878, loss_d: 0.445454
Epoch finished! Loss: 2.147702213434073
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.144022, loss_ss: 1.573709, loss_d: 0.570313
0.0384 --- loss: 2.104953, loss_ss: 1.702728, loss_d: 0.402225
0.0767 --- loss: 2.128349, loss_ss: 1.580916, loss_d: 0.547433
0.1151 --- loss: 1.901547, loss_ss: 1.451359, loss_d: 0.450187
0.1534 --- loss: 2.224558, loss_ss: 1.432619, loss_d: 0.791940
0.1918 --- loss: 2.133202, loss_ss: 1.701601, loss_d: 0.431601
0.2301 --- loss: 2.132501, loss_ss: 1.553943, loss_d: 0.578558
0.2685 --- loss: 1.757695, loss_ss: 1.435943, loss_d: 0.321752
0.3069 --- loss: 1.950721, loss_ss: 1.575778, loss_d: 0.374943
0.3452 --- loss: 2.085129, loss_ss: 1.734530, loss_d: 0.350599
0.3836 --- loss: 1.983068, loss_ss: 1.566953, loss_d: 0.416115
0.4219 --- loss: 2.555019, loss_ss: 1.620528, loss_d: 0.934491
0.4603 --- loss: 2.243830, loss_ss: 1.655597, loss_d: 0.588233
0.4987 --- loss: 1.700155, loss_ss: 1.356803, loss_d: 0.343351
0.5370 --- loss: 2.092563, loss_ss: 1.501110, loss_d: 0.591454
0.5754 --- loss: 2.383527, loss_ss: 1.720733, loss_d: 0.662793
0.6137 --- loss: 2.106516, loss_ss: 1.514190, loss_d: 0.592326
0.6521 --- loss: 2.182406, loss_ss: 1.563434, loss_d: 0.618973
0.6904 --- loss: 1.923106, loss_ss: 1.584913, loss_d: 0.338192
0.7288 --- loss: 2.329031, loss_ss: 1.374786, loss_d: 0.954245
0.7672 --- loss: 2.089372, loss_ss: 1.453740, loss_d: 0.635632
0.8055 --- loss: 2.171598, loss_ss: 1.556710, loss_d: 0.614887
0.8439 --- loss: 1.780239, loss_ss: 1.439442, loss_d: 0.340797
0.8822 --- loss: 1.793387, loss_ss: 1.365169, loss_d: 0.428218
0.9206 --- loss: 1.723103, loss_ss: 1.393687, loss_d: 0.329416
0.9590 --- loss: 1.795669, loss_ss: 1.400861, loss_d: 0.394808
0.9973 --- loss: 1.951852, loss_ss: 1.596025, loss_d: 0.355826
Epoch finished! Loss: 2.047464586221255
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.974620, loss_ss: 1.365661, loss_d: 0.608959
0.0384 --- loss: 2.118040, loss_ss: 1.485665, loss_d: 0.632375
0.0767 --- loss: 1.869757, loss_ss: 1.448796, loss_d: 0.420961
0.1151 --- loss: 1.887815, loss_ss: 1.598001, loss_d: 0.289814
0.1534 --- loss: 2.179609, loss_ss: 1.634230, loss_d: 0.545379
0.1918 --- loss: 2.071318, loss_ss: 1.484638, loss_d: 0.586679
0.2301 --- loss: 1.970219, loss_ss: 1.508919, loss_d: 0.461300
0.2685 --- loss: 2.186590, loss_ss: 1.508440, loss_d: 0.678149
0.3069 --- loss: 1.846731, loss_ss: 1.389081, loss_d: 0.457651
0.3452 --- loss: 1.868747, loss_ss: 1.476915, loss_d: 0.391831
0.3836 --- loss: 1.848073, loss_ss: 1.470976, loss_d: 0.377097
0.4219 --- loss: 2.376115, loss_ss: 1.378028, loss_d: 0.998087
0.4603 --- loss: 2.033879, loss_ss: 1.459538, loss_d: 0.574342
0.4987 --- loss: 2.240932, loss_ss: 1.575973, loss_d: 0.664959
0.5370 --- loss: 1.726440, loss_ss: 1.353355, loss_d: 0.373085
0.5754 --- loss: 1.887672, loss_ss: 1.511056, loss_d: 0.376617
0.6137 --- loss: 2.196805, loss_ss: 1.671590, loss_d: 0.525215
0.6521 --- loss: 2.085758, loss_ss: 1.634498, loss_d: 0.451259
0.6904 --- loss: 1.982787, loss_ss: 1.568971, loss_d: 0.413817
0.7288 --- loss: 1.996779, loss_ss: 1.604067, loss_d: 0.392712
0.7672 --- loss: 2.364230, loss_ss: 1.662490, loss_d: 0.701740
0.8055 --- loss: 1.843877, loss_ss: 1.492717, loss_d: 0.351160
0.8439 --- loss: 2.439260, loss_ss: 1.362828, loss_d: 1.076433
0.8822 --- loss: 2.073238, loss_ss: 1.479564, loss_d: 0.593674
0.9206 --- loss: 1.824052, loss_ss: 1.300646, loss_d: 0.523406
0.9590 --- loss: 1.826789, loss_ss: 1.472480, loss_d: 0.354309
0.9973 --- loss: 2.031951, loss_ss: 1.587350, loss_d: 0.444602
Epoch finished! Loss: 1.969129477097438
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.996965, loss_ss: 1.711908, loss_d: 0.285057
0.0384 --- loss: 1.712856, loss_ss: 1.207939, loss_d: 0.504916
0.0767 --- loss: 1.898448, loss_ss: 1.521348, loss_d: 0.377100
0.1151 --- loss: 1.919518, loss_ss: 1.225314, loss_d: 0.694204
0.1534 --- loss: 1.555377, loss_ss: 1.227938, loss_d: 0.327438
0.1918 --- loss: 1.922600, loss_ss: 1.357548, loss_d: 0.565052
0.2301 --- loss: 1.643459, loss_ss: 1.305158, loss_d: 0.338301
0.2685 --- loss: 1.636682, loss_ss: 1.287430, loss_d: 0.349252
0.3069 --- loss: 1.919755, loss_ss: 1.536687, loss_d: 0.383068
0.3452 --- loss: 1.855095, loss_ss: 1.362690, loss_d: 0.492406
0.3836 --- loss: 1.994333, loss_ss: 1.453393, loss_d: 0.540940
0.4219 --- loss: 1.900497, loss_ss: 1.565628, loss_d: 0.334869
0.4603 --- loss: 1.915830, loss_ss: 1.404712, loss_d: 0.511118
0.4987 --- loss: 1.993250, loss_ss: 1.509275, loss_d: 0.483975
0.5370 --- loss: 1.746654, loss_ss: 1.260613, loss_d: 0.486041
0.5754 --- loss: 2.001030, loss_ss: 1.506201, loss_d: 0.494829
0.6137 --- loss: 2.121170, loss_ss: 1.549849, loss_d: 0.571320
0.6521 --- loss: 1.618492, loss_ss: 1.350098, loss_d: 0.268393
0.6904 --- loss: 2.011833, loss_ss: 1.495979, loss_d: 0.515854
0.7288 --- loss: 1.852280, loss_ss: 1.382010, loss_d: 0.470270
0.7672 --- loss: 1.907662, loss_ss: 1.464252, loss_d: 0.443410
0.8055 --- loss: 1.767397, loss_ss: 1.374613, loss_d: 0.392784
0.8439 --- loss: 1.807602, loss_ss: 1.419734, loss_d: 0.387868
0.8822 --- loss: 1.960248, loss_ss: 1.555637, loss_d: 0.404611
0.9206 --- loss: 2.118607, loss_ss: 1.739555, loss_d: 0.379052
0.9590 --- loss: 1.918133, loss_ss: 1.268247, loss_d: 0.649886
0.9973 --- loss: 1.910676, loss_ss: 1.443599, loss_d: 0.467077
Epoch finished! Loss: 1.9324795406598312
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.999892, loss_ss: 1.523118, loss_d: 0.476774
0.0384 --- loss: 1.781313, loss_ss: 1.256598, loss_d: 0.524715
0.0767 --- loss: 1.845274, loss_ss: 1.497482, loss_d: 0.347792
0.1151 --- loss: 2.653921, loss_ss: 1.666695, loss_d: 0.987225
0.1534 --- loss: 1.655422, loss_ss: 1.360021, loss_d: 0.295401
0.1918 --- loss: 1.943961, loss_ss: 1.393610, loss_d: 0.550351
0.2301 --- loss: 1.804671, loss_ss: 1.194919, loss_d: 0.609752
0.2685 --- loss: 1.871145, loss_ss: 1.566847, loss_d: 0.304298
0.3069 --- loss: 1.627427, loss_ss: 1.341804, loss_d: 0.285623
0.3452 --- loss: 1.816185, loss_ss: 1.336516, loss_d: 0.479669
0.3836 --- loss: 2.157012, loss_ss: 1.623750, loss_d: 0.533262
0.4219 --- loss: 1.758282, loss_ss: 1.348613, loss_d: 0.409669
0.4603 --- loss: 1.790067, loss_ss: 1.422109, loss_d: 0.367957
0.4987 --- loss: 2.010331, loss_ss: 1.519048, loss_d: 0.491282
0.5370 --- loss: 2.114589, loss_ss: 1.447426, loss_d: 0.667164
0.5754 --- loss: 1.985950, loss_ss: 1.558396, loss_d: 0.427554
0.6137 --- loss: 2.070047, loss_ss: 1.560940, loss_d: 0.509107
0.6521 --- loss: 1.741564, loss_ss: 1.372596, loss_d: 0.368968
0.6904 --- loss: 1.609054, loss_ss: 1.092283, loss_d: 0.516770
0.7288 --- loss: 1.679194, loss_ss: 1.208073, loss_d: 0.471121
0.7672 --- loss: 2.036020, loss_ss: 1.505283, loss_d: 0.530738
0.8055 --- loss: 1.824366, loss_ss: 1.460046, loss_d: 0.364320
0.8439 --- loss: 1.730945, loss_ss: 1.331533, loss_d: 0.399412
0.8822 --- loss: 1.688226, loss_ss: 1.344618, loss_d: 0.343608
0.9206 --- loss: 1.953377, loss_ss: 1.420584, loss_d: 0.532793
0.9590 --- loss: 1.805655, loss_ss: 1.411600, loss_d: 0.394056
0.9973 --- loss: 1.899009, loss_ss: 1.536195, loss_d: 0.362814
Epoch finished! Loss: 1.8958001104684976
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.705330, loss_ss: 1.258671, loss_d: 0.446660
0.0384 --- loss: 1.763421, loss_ss: 1.297592, loss_d: 0.465829
0.0767 --- loss: 1.736576, loss_ss: 1.338134, loss_d: 0.398441
0.1151 --- loss: 1.907615, loss_ss: 1.520883, loss_d: 0.386732
0.1534 --- loss: 2.120128, loss_ss: 1.592590, loss_d: 0.527538
0.1918 --- loss: 1.813620, loss_ss: 1.411408, loss_d: 0.402211
0.2301 --- loss: 1.852800, loss_ss: 1.193697, loss_d: 0.659103
0.2685 --- loss: 2.038188, loss_ss: 1.479524, loss_d: 0.558664
0.3069 --- loss: 1.824239, loss_ss: 1.503246, loss_d: 0.320993
0.3452 --- loss: 1.879521, loss_ss: 1.183453, loss_d: 0.696068
0.3836 --- loss: 1.713329, loss_ss: 1.281183, loss_d: 0.432146
0.4219 --- loss: 2.125693, loss_ss: 1.389583, loss_d: 0.736111
0.4603 --- loss: 1.839958, loss_ss: 1.327633, loss_d: 0.512325
0.4987 --- loss: 1.877517, loss_ss: 1.258851, loss_d: 0.618666
0.5370 --- loss: 1.839901, loss_ss: 1.470109, loss_d: 0.369792
0.5754 --- loss: 1.775878, loss_ss: 1.286905, loss_d: 0.488973
0.6137 --- loss: 1.629670, loss_ss: 1.199997, loss_d: 0.429673
0.6521 --- loss: 1.700374, loss_ss: 1.325997, loss_d: 0.374377
0.6904 --- loss: 1.760183, loss_ss: 1.082424, loss_d: 0.677759
0.7288 --- loss: 1.893428, loss_ss: 1.433259, loss_d: 0.460169
0.7672 --- loss: 1.968654, loss_ss: 1.530883, loss_d: 0.437771
0.8055 --- loss: 1.767890, loss_ss: 1.393344, loss_d: 0.374546
0.8439 --- loss: 1.756889, loss_ss: 1.310254, loss_d: 0.446635
0.8822 --- loss: 1.820526, loss_ss: 1.409633, loss_d: 0.410892
0.9206 --- loss: 1.404640, loss_ss: 1.148111, loss_d: 0.256529
0.9590 --- loss: 1.972756, loss_ss: 1.268357, loss_d: 0.704400
0.9973 --- loss: 1.638620, loss_ss: 1.148787, loss_d: 0.489832
Epoch finished! Loss: 1.8298440612279452
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.499522, loss_ss: 1.009646, loss_d: 0.489876
0.0384 --- loss: 1.794220, loss_ss: 1.418697, loss_d: 0.375523
0.0767 --- loss: 1.641783, loss_ss: 1.177122, loss_d: 0.464661
0.1151 --- loss: 1.673416, loss_ss: 1.252007, loss_d: 0.421410
0.1534 --- loss: 1.821189, loss_ss: 1.204966, loss_d: 0.616222
0.1918 --- loss: 1.503597, loss_ss: 1.000060, loss_d: 0.503537
0.2301 --- loss: 1.794030, loss_ss: 1.318183, loss_d: 0.475847
0.2685 --- loss: 1.557251, loss_ss: 1.185595, loss_d: 0.371656
0.3069 --- loss: 1.693718, loss_ss: 1.283424, loss_d: 0.410293
0.3452 --- loss: 1.487396, loss_ss: 1.058161, loss_d: 0.429235
0.3836 --- loss: 1.927409, loss_ss: 1.362193, loss_d: 0.565217
0.4219 --- loss: 1.587608, loss_ss: 1.166293, loss_d: 0.421315
0.4603 --- loss: 1.664754, loss_ss: 1.296063, loss_d: 0.368691
0.4987 --- loss: 2.068518, loss_ss: 1.497886, loss_d: 0.570632
0.5370 --- loss: 1.872350, loss_ss: 1.384146, loss_d: 0.488204
0.5754 --- loss: 1.397033, loss_ss: 1.007383, loss_d: 0.389650
0.6137 --- loss: 1.448594, loss_ss: 1.029633, loss_d: 0.418960
0.6521 --- loss: 1.778396, loss_ss: 1.201339, loss_d: 0.577056
0.6904 --- loss: 1.684136, loss_ss: 1.076190, loss_d: 0.607946
0.7288 --- loss: 1.720845, loss_ss: 1.305986, loss_d: 0.414859
0.7672 --- loss: 1.757518, loss_ss: 1.229483, loss_d: 0.528034
0.8055 --- loss: 1.723250, loss_ss: 1.337536, loss_d: 0.385714
0.8439 --- loss: 1.431928, loss_ss: 0.969458, loss_d: 0.462470
0.8822 --- loss: 1.499881, loss_ss: 1.040759, loss_d: 0.459122
0.9206 --- loss: 1.479652, loss_ss: 1.196303, loss_d: 0.283349
0.9590 --- loss: 1.462582, loss_ss: 1.259773, loss_d: 0.202809
0.9973 --- loss: 1.636959, loss_ss: 1.439072, loss_d: 0.197887
Epoch finished! Loss: 1.7172208584271944
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.698174, loss_ss: 1.218478, loss_d: 0.479696
0.0384 --- loss: 1.376227, loss_ss: 1.016720, loss_d: 0.359508
0.0767 --- loss: 1.450157, loss_ss: 1.166055, loss_d: 0.284102
0.1151 --- loss: 1.548781, loss_ss: 1.069155, loss_d: 0.479627
0.1534 --- loss: 1.654440, loss_ss: 1.269356, loss_d: 0.385084
0.1918 --- loss: 1.576796, loss_ss: 1.223640, loss_d: 0.353156
0.2301 --- loss: 1.315964, loss_ss: 1.041232, loss_d: 0.274732
0.2685 --- loss: 1.501358, loss_ss: 1.130357, loss_d: 0.371001
0.3069 --- loss: 1.992070, loss_ss: 1.491633, loss_d: 0.500437
0.3452 --- loss: 1.391523, loss_ss: 0.960140, loss_d: 0.431383
0.3836 --- loss: 1.607957, loss_ss: 1.182773, loss_d: 0.425184
0.4219 --- loss: 1.605631, loss_ss: 1.318531, loss_d: 0.287100
0.4603 --- loss: 1.587810, loss_ss: 1.164801, loss_d: 0.423009
0.4987 --- loss: 1.680221, loss_ss: 1.287602, loss_d: 0.392619
0.5370 --- loss: 1.563359, loss_ss: 1.273097, loss_d: 0.290262
0.5754 --- loss: 1.791748, loss_ss: 1.283501, loss_d: 0.508247
0.6137 --- loss: 1.597078, loss_ss: 1.194379, loss_d: 0.402699
0.6521 --- loss: 1.503027, loss_ss: 1.306857, loss_d: 0.196170
0.6904 --- loss: 1.743211, loss_ss: 1.178455, loss_d: 0.564756
0.7288 --- loss: 1.484402, loss_ss: 1.077925, loss_d: 0.406477
0.7672 --- loss: 1.562492, loss_ss: 1.194881, loss_d: 0.367611
0.8055 --- loss: 1.890381, loss_ss: 1.275576, loss_d: 0.614805
0.8439 --- loss: 1.651096, loss_ss: 1.284415, loss_d: 0.366680
0.8822 --- loss: 1.681530, loss_ss: 1.366594, loss_d: 0.314936
0.9206 --- loss: 1.874738, loss_ss: 1.022478, loss_d: 0.852260
0.9590 --- loss: 1.749371, loss_ss: 1.410958, loss_d: 0.338413
0.9973 --- loss: 2.208622, loss_ss: 1.201858, loss_d: 1.006764
Epoch finished! Loss: 1.6532597028292142
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.341227, loss_ss: 0.929633, loss_d: 0.411594
0.0384 --- loss: 1.562555, loss_ss: 1.146404, loss_d: 0.416151
0.0767 --- loss: 1.643105, loss_ss: 1.143839, loss_d: 0.499266
0.1151 --- loss: 1.699682, loss_ss: 1.299995, loss_d: 0.399687
0.1534 --- loss: 2.076561, loss_ss: 1.539967, loss_d: 0.536594
0.1918 --- loss: 1.586781, loss_ss: 1.147173, loss_d: 0.439608
0.2301 --- loss: 1.699832, loss_ss: 1.048477, loss_d: 0.651355
0.2685 --- loss: 1.243121, loss_ss: 0.888275, loss_d: 0.354847
0.3069 --- loss: 1.578697, loss_ss: 1.017299, loss_d: 0.561399
0.3452 --- loss: 1.451695, loss_ss: 1.066101, loss_d: 0.385594
0.3836 --- loss: 1.608672, loss_ss: 1.152265, loss_d: 0.456407
0.4219 --- loss: 1.435537, loss_ss: 1.023934, loss_d: 0.411603
0.4603 --- loss: 1.372649, loss_ss: 0.960115, loss_d: 0.412534
0.4987 --- loss: 1.498621, loss_ss: 1.161620, loss_d: 0.337001
0.5370 --- loss: 1.443601, loss_ss: 1.085400, loss_d: 0.358201
0.5754 --- loss: 1.550638, loss_ss: 1.228336, loss_d: 0.322302
0.6137 --- loss: 1.233156, loss_ss: 0.875195, loss_d: 0.357961
0.6521 --- loss: 1.239864, loss_ss: 0.998292, loss_d: 0.241572
0.6904 --- loss: 1.874315, loss_ss: 1.512774, loss_d: 0.361541
0.7288 --- loss: 1.634791, loss_ss: 1.304512, loss_d: 0.330279
0.7672 --- loss: 1.621790, loss_ss: 1.246071, loss_d: 0.375718
0.8055 --- loss: 1.868420, loss_ss: 1.415275, loss_d: 0.453144
0.8439 --- loss: 1.610075, loss_ss: 1.219104, loss_d: 0.390970
0.8822 --- loss: 1.649749, loss_ss: 1.028248, loss_d: 0.621501
0.9206 --- loss: 1.769781, loss_ss: 1.144902, loss_d: 0.624879
0.9590 --- loss: 1.346371, loss_ss: 1.036824, loss_d: 0.309547
0.9973 --- loss: 1.644847, loss_ss: 1.368294, loss_d: 0.276553
Epoch finished! Loss: 1.6141973041571103
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.884017, loss_ss: 1.074877, loss_d: 0.809140
0.0384 --- loss: 1.645120, loss_ss: 1.240072, loss_d: 0.405049
0.0767 --- loss: 1.278891, loss_ss: 0.908003, loss_d: 0.370888
0.1151 --- loss: 1.247557, loss_ss: 0.829405, loss_d: 0.418152
0.1534 --- loss: 1.330581, loss_ss: 1.015208, loss_d: 0.315374
0.1918 --- loss: 1.467021, loss_ss: 1.104990, loss_d: 0.362031
0.2301 --- loss: 1.599527, loss_ss: 0.965288, loss_d: 0.634239
0.2685 --- loss: 1.619839, loss_ss: 0.881008, loss_d: 0.738831
0.3069 --- loss: 1.603125, loss_ss: 1.150681, loss_d: 0.452444
0.3452 --- loss: 1.598845, loss_ss: 0.984795, loss_d: 0.614050
0.3836 --- loss: 1.064826, loss_ss: 0.832709, loss_d: 0.232117
0.4219 --- loss: 1.266356, loss_ss: 0.946542, loss_d: 0.319814
0.4603 --- loss: 1.385033, loss_ss: 1.201566, loss_d: 0.183467
0.4987 --- loss: 1.349783, loss_ss: 0.936726, loss_d: 0.413058
0.5370 --- loss: 1.424713, loss_ss: 1.126761, loss_d: 0.297952
0.5754 --- loss: 2.272465, loss_ss: 1.315332, loss_d: 0.957132
0.6137 --- loss: 1.597820, loss_ss: 1.277432, loss_d: 0.320388
0.6521 --- loss: 1.668601, loss_ss: 1.019943, loss_d: 0.648658
0.6904 --- loss: 1.484661, loss_ss: 1.152144, loss_d: 0.332517
0.7288 --- loss: 1.434135, loss_ss: 1.022012, loss_d: 0.412123
0.7672 --- loss: 1.732905, loss_ss: 1.250895, loss_d: 0.482010
0.8055 --- loss: 1.468024, loss_ss: 1.188019, loss_d: 0.280005
0.8439 --- loss: 1.917424, loss_ss: 1.270243, loss_d: 0.647182
0.8822 --- loss: 1.783813, loss_ss: 1.359205, loss_d: 0.424608
0.9206 --- loss: 1.920048, loss_ss: 1.044447, loss_d: 0.875600
0.9590 --- loss: 1.895291, loss_ss: 1.581465, loss_d: 0.313826
0.9973 --- loss: 2.562237, loss_ss: 1.489208, loss_d: 1.073029
Epoch finished! Loss: 1.580367007622352
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.32688172043010755
             precision    recall  f1-score   support

        0.0       0.51      0.34      0.41       119
        1.0       0.00      0.00      0.00        37
        2.0       0.00      0.00      0.00       387
        3.0       0.31      1.00      0.47       263
        4.0       0.00      0.00      0.00       124

avg / total       0.15      0.33      0.19       930
 


====== chp008-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  87.31   34.45   95.07  50.62      41.0
1  96.02    0.00  100.00   0.00       0.0
2  58.39    0.00  100.00   0.00       0.0
3  36.99  100.00   12.14  30.98      47.3
4  86.67    0.00  100.00   0.00       0.0
Total accuracy: 32.69%
Average sen: 26.89%
Average spec: 81.44%
Macro f1-score: 17.66%
[0.086918   0.19407623 0.19705305 0.35552469 0.16621879 0.1013431
 0.14262961 0.13938616 0.16189781 0.20798664 0.17081051 0.06298953
 0.08500604 0.14429033 0.13611187 0.15645377 0.27809    0.30955353
 0.13592611 0.17986631 0.10830736 0.16408636 0.15081467 0.16784827
 0.16577509 0.18171653 0.16295633 0.09598865 0.09734466 0.16557249
 0.17394967]
pred: 0.16279006965698734, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.178583, loss_ss: 1.488727, loss_d: 0.689856
0.0384 --- loss: 1.992229, loss_ss: 1.453985, loss_d: 0.538244
0.0768 --- loss: 1.970690, loss_ss: 1.417207, loss_d: 0.553484
0.1152 --- loss: 2.022078, loss_ss: 1.514174, loss_d: 0.507903
0.1536 --- loss: 2.194364, loss_ss: 1.446995, loss_d: 0.747369
0.1920 --- loss: 2.125115, loss_ss: 1.530146, loss_d: 0.594969
0.2304 --- loss: 2.178689, loss_ss: 1.537396, loss_d: 0.641293
0.2688 --- loss: 2.106787, loss_ss: 1.575188, loss_d: 0.531599
0.3072 --- loss: 1.980221, loss_ss: 1.475807, loss_d: 0.504414
0.3456 --- loss: 2.198247, loss_ss: 1.689085, loss_d: 0.509161
0.3840 --- loss: 2.188806, loss_ss: 1.479801, loss_d: 0.709005
0.4224 --- loss: 2.031950, loss_ss: 1.689084, loss_d: 0.342866
0.4608 --- loss: 2.071115, loss_ss: 1.677046, loss_d: 0.394069
0.4992 --- loss: 1.943352, loss_ss: 1.558607, loss_d: 0.384745
0.5376 --- loss: 2.447796, loss_ss: 1.646788, loss_d: 0.801008
0.5760 --- loss: 2.172636, loss_ss: 1.426253, loss_d: 0.746383
0.6144 --- loss: 2.142330, loss_ss: 1.507040, loss_d: 0.635290
0.6528 --- loss: 2.220316, loss_ss: 1.568254, loss_d: 0.652061
0.6912 --- loss: 2.214269, loss_ss: 1.626119, loss_d: 0.588150
0.7296 --- loss: 2.372050, loss_ss: 1.652056, loss_d: 0.719994
0.7680 --- loss: 2.327296, loss_ss: 1.574491, loss_d: 0.752805
0.8065 --- loss: 2.139151, loss_ss: 1.643947, loss_d: 0.495204
0.8449 --- loss: 2.338808, loss_ss: 1.566248, loss_d: 0.772559
0.8833 --- loss: 2.057677, loss_ss: 1.506572, loss_d: 0.551105
0.9217 --- loss: 1.920633, loss_ss: 1.330167, loss_d: 0.590466
0.9601 --- loss: 2.132177, loss_ss: 1.614314, loss_d: 0.517863
0.9985 --- loss: 2.267969, loss_ss: 1.493768, loss_d: 0.774201
Epoch finished! Loss: 2.114559920476033
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.938421, loss_ss: 1.461161, loss_d: 0.477259
0.0384 --- loss: 1.922771, loss_ss: 1.452471, loss_d: 0.470301
0.0768 --- loss: 2.140969, loss_ss: 1.548172, loss_d: 0.592797
0.1152 --- loss: 2.153580, loss_ss: 1.526149, loss_d: 0.627431
0.1536 --- loss: 1.862187, loss_ss: 1.292155, loss_d: 0.570032
0.1920 --- loss: 1.936485, loss_ss: 1.356094, loss_d: 0.580391
0.2304 --- loss: 1.868508, loss_ss: 1.453825, loss_d: 0.414682
0.2688 --- loss: 1.768014, loss_ss: 1.346091, loss_d: 0.421923
0.3072 --- loss: 1.929839, loss_ss: 1.500405, loss_d: 0.429434
0.3456 --- loss: 1.885861, loss_ss: 1.484877, loss_d: 0.400984
0.3840 --- loss: 1.913290, loss_ss: 1.221275, loss_d: 0.692015
0.4224 --- loss: 1.964599, loss_ss: 1.475769, loss_d: 0.488831
0.4608 --- loss: 1.831573, loss_ss: 1.441128, loss_d: 0.390444
0.4992 --- loss: 2.216601, loss_ss: 1.471113, loss_d: 0.745488
0.5376 --- loss: 1.775890, loss_ss: 1.388474, loss_d: 0.387416
0.5760 --- loss: 1.988782, loss_ss: 1.373749, loss_d: 0.615033
0.6144 --- loss: 2.230783, loss_ss: 1.636016, loss_d: 0.594767
0.6528 --- loss: 2.213032, loss_ss: 1.429459, loss_d: 0.783573
0.6912 --- loss: 1.916333, loss_ss: 1.581537, loss_d: 0.334796
0.7296 --- loss: 1.967840, loss_ss: 1.472567, loss_d: 0.495273
0.7680 --- loss: 2.112973, loss_ss: 1.394578, loss_d: 0.718395
0.8065 --- loss: 1.582274, loss_ss: 1.158187, loss_d: 0.424087
0.8449 --- loss: 1.795824, loss_ss: 1.357714, loss_d: 0.438110
0.8833 --- loss: 2.117863, loss_ss: 1.651756, loss_d: 0.466107
0.9217 --- loss: 2.129005, loss_ss: 1.549797, loss_d: 0.579209
0.9601 --- loss: 2.192309, loss_ss: 1.463356, loss_d: 0.728954
0.9985 --- loss: 2.093870, loss_ss: 1.508986, loss_d: 0.584884
Epoch finished! Loss: 2.0240564139989705
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.993658, loss_ss: 1.353134, loss_d: 0.640524
0.0384 --- loss: 1.992399, loss_ss: 1.398883, loss_d: 0.593516
0.0768 --- loss: 2.024591, loss_ss: 1.432566, loss_d: 0.592025
0.1152 --- loss: 1.869097, loss_ss: 1.392977, loss_d: 0.476120
0.1536 --- loss: 2.373709, loss_ss: 1.382223, loss_d: 0.991486
0.1920 --- loss: 1.879435, loss_ss: 1.288664, loss_d: 0.590771
0.2304 --- loss: 1.981221, loss_ss: 1.556939, loss_d: 0.424282
0.2688 --- loss: 1.846473, loss_ss: 1.355675, loss_d: 0.490799
0.3072 --- loss: 2.092989, loss_ss: 1.457895, loss_d: 0.635095
0.3456 --- loss: 2.128110, loss_ss: 1.534147, loss_d: 0.593963
0.3840 --- loss: 2.412516, loss_ss: 1.479438, loss_d: 0.933078
0.4224 --- loss: 1.990269, loss_ss: 1.530793, loss_d: 0.459476
0.4608 --- loss: 1.886467, loss_ss: 1.531565, loss_d: 0.354901
0.4992 --- loss: 2.019678, loss_ss: 1.351605, loss_d: 0.668073
0.5376 --- loss: 2.140959, loss_ss: 1.593876, loss_d: 0.547083
0.5760 --- loss: 2.085175, loss_ss: 1.219141, loss_d: 0.866034
0.6144 --- loss: 1.690669, loss_ss: 1.262993, loss_d: 0.427676
0.6528 --- loss: 1.962760, loss_ss: 1.296738, loss_d: 0.666022
0.6912 --- loss: 1.888653, loss_ss: 1.287488, loss_d: 0.601164
0.7296 --- loss: 2.237456, loss_ss: 1.475174, loss_d: 0.762282
0.7680 --- loss: 1.790320, loss_ss: 1.405812, loss_d: 0.384507
0.8065 --- loss: 2.004151, loss_ss: 1.535441, loss_d: 0.468710
0.8449 --- loss: 1.916554, loss_ss: 1.308747, loss_d: 0.607808
0.8833 --- loss: 1.892436, loss_ss: 1.458714, loss_d: 0.433722
0.9217 --- loss: 1.972529, loss_ss: 1.556656, loss_d: 0.415873
0.9601 --- loss: 1.731485, loss_ss: 1.326589, loss_d: 0.404896
0.9985 --- loss: 2.297887, loss_ss: 1.691870, loss_d: 0.606017
Epoch finished! Loss: 1.9302693082736089
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.970310, loss_ss: 1.438865, loss_d: 0.531445
0.0384 --- loss: 2.129560, loss_ss: 1.458406, loss_d: 0.671154
0.0768 --- loss: 1.601368, loss_ss: 1.219137, loss_d: 0.382231
0.1152 --- loss: 2.119870, loss_ss: 1.311515, loss_d: 0.808355
0.1536 --- loss: 1.706680, loss_ss: 1.324479, loss_d: 0.382200
0.1920 --- loss: 1.819673, loss_ss: 1.220593, loss_d: 0.599079
0.2304 --- loss: 2.001865, loss_ss: 1.496722, loss_d: 0.505143
0.2688 --- loss: 1.918011, loss_ss: 1.505572, loss_d: 0.412439
0.3072 --- loss: 1.827166, loss_ss: 1.401845, loss_d: 0.425321
0.3456 --- loss: 1.570789, loss_ss: 1.214257, loss_d: 0.356532
0.3840 --- loss: 1.662234, loss_ss: 1.355288, loss_d: 0.306946
0.4224 --- loss: 1.755580, loss_ss: 1.283472, loss_d: 0.472108
0.4608 --- loss: 1.937282, loss_ss: 1.117815, loss_d: 0.819467
0.4992 --- loss: 1.687380, loss_ss: 1.338021, loss_d: 0.349360
0.5376 --- loss: 2.234684, loss_ss: 1.284183, loss_d: 0.950500
0.5760 --- loss: 1.896592, loss_ss: 1.497410, loss_d: 0.399182
0.6144 --- loss: 1.765525, loss_ss: 1.340088, loss_d: 0.425437
0.6528 --- loss: 1.911092, loss_ss: 1.524959, loss_d: 0.386134
0.6912 --- loss: 1.644958, loss_ss: 1.178703, loss_d: 0.466255
0.7296 --- loss: 1.814041, loss_ss: 1.397590, loss_d: 0.416451
0.7680 --- loss: 1.887542, loss_ss: 1.432982, loss_d: 0.454560
0.8065 --- loss: 2.177306, loss_ss: 1.543936, loss_d: 0.633371
0.8449 --- loss: 1.709433, loss_ss: 1.273665, loss_d: 0.435768
0.8833 --- loss: 1.568118, loss_ss: 1.212898, loss_d: 0.355220
0.9217 --- loss: 1.693050, loss_ss: 1.309333, loss_d: 0.383717
0.9601 --- loss: 1.714918, loss_ss: 1.370301, loss_d: 0.344617
0.9985 --- loss: 1.542384, loss_ss: 1.284973, loss_d: 0.257410
Epoch finished! Loss: 1.8404803349421575
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.632516, loss_ss: 1.148536, loss_d: 0.483980
0.0384 --- loss: 2.197171, loss_ss: 1.251130, loss_d: 0.946041
0.0768 --- loss: 1.901832, loss_ss: 1.345415, loss_d: 0.556417
0.1152 --- loss: 1.667643, loss_ss: 1.230541, loss_d: 0.437101
0.1536 --- loss: 1.972171, loss_ss: 1.639206, loss_d: 0.332965
0.1920 --- loss: 1.763757, loss_ss: 1.288946, loss_d: 0.474811
0.2304 --- loss: 1.800936, loss_ss: 1.421456, loss_d: 0.379479
0.2688 --- loss: 1.847048, loss_ss: 1.275020, loss_d: 0.572028
0.3072 --- loss: 1.719717, loss_ss: 1.260073, loss_d: 0.459644
0.3456 --- loss: 1.494771, loss_ss: 1.122393, loss_d: 0.372378
0.3840 --- loss: 2.551756, loss_ss: 1.370776, loss_d: 1.180980
0.4224 --- loss: 1.861708, loss_ss: 1.181982, loss_d: 0.679726
0.4608 --- loss: 1.903875, loss_ss: 1.419287, loss_d: 0.484588
0.4992 --- loss: 1.723960, loss_ss: 1.310716, loss_d: 0.413244
0.5376 --- loss: 1.876686, loss_ss: 1.481281, loss_d: 0.395405
0.5760 --- loss: 1.614781, loss_ss: 1.287576, loss_d: 0.327205
0.6144 --- loss: 1.193878, loss_ss: 0.876175, loss_d: 0.317704
0.6528 --- loss: 1.558619, loss_ss: 1.109021, loss_d: 0.449599
0.6912 --- loss: 1.495662, loss_ss: 1.056996, loss_d: 0.438666
0.7296 --- loss: 1.783416, loss_ss: 1.276184, loss_d: 0.507232
0.7680 --- loss: 1.355118, loss_ss: 1.059858, loss_d: 0.295260
0.8065 --- loss: 1.788209, loss_ss: 1.103429, loss_d: 0.684780
0.8449 --- loss: 1.423756, loss_ss: 0.876023, loss_d: 0.547733
0.8833 --- loss: 1.329301, loss_ss: 1.017743, loss_d: 0.311559
0.9217 --- loss: 2.016243, loss_ss: 1.729900, loss_d: 0.286344
0.9601 --- loss: 2.192435, loss_ss: 1.237332, loss_d: 0.955103
0.9985 --- loss: 1.940612, loss_ss: 1.059272, loss_d: 0.881340
Epoch finished! Loss: 1.7417808587734516
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.863407, loss_ss: 1.376162, loss_d: 0.487245
0.0384 --- loss: 1.847635, loss_ss: 1.515568, loss_d: 0.332067
0.0768 --- loss: 1.652045, loss_ss: 1.082277, loss_d: 0.569768
0.1152 --- loss: 1.651587, loss_ss: 1.009007, loss_d: 0.642580
0.1536 --- loss: 1.618667, loss_ss: 1.162912, loss_d: 0.455755
0.1920 --- loss: 1.691502, loss_ss: 1.278528, loss_d: 0.412974
0.2304 --- loss: 1.528829, loss_ss: 1.169928, loss_d: 0.358901
0.2688 --- loss: 1.494418, loss_ss: 1.051172, loss_d: 0.443245
0.3072 --- loss: 1.985427, loss_ss: 1.388857, loss_d: 0.596570
0.3456 --- loss: 1.531333, loss_ss: 0.995636, loss_d: 0.535697
0.3840 --- loss: 1.843334, loss_ss: 1.445729, loss_d: 0.397606
0.4224 --- loss: 1.457764, loss_ss: 1.059303, loss_d: 0.398461
0.4608 --- loss: 1.714494, loss_ss: 1.153990, loss_d: 0.560504
0.4992 --- loss: 1.572997, loss_ss: 1.203202, loss_d: 0.369795
0.5376 --- loss: 1.965113, loss_ss: 1.366531, loss_d: 0.598582
0.5760 --- loss: 1.609331, loss_ss: 1.179375, loss_d: 0.429956
0.6144 --- loss: 1.689596, loss_ss: 1.133711, loss_d: 0.555885
0.6528 --- loss: 1.520668, loss_ss: 1.076410, loss_d: 0.444258
0.6912 --- loss: 1.354311, loss_ss: 0.938842, loss_d: 0.415469
0.7296 --- loss: 1.687348, loss_ss: 1.241320, loss_d: 0.446028
0.7680 --- loss: 1.395906, loss_ss: 0.933913, loss_d: 0.461994
0.8065 --- loss: 1.415356, loss_ss: 1.028636, loss_d: 0.386721
0.8449 --- loss: 1.468565, loss_ss: 1.027749, loss_d: 0.440816
0.8833 --- loss: 1.308587, loss_ss: 0.922609, loss_d: 0.385978
0.9217 --- loss: 1.557524, loss_ss: 1.130261, loss_d: 0.427263
0.9601 --- loss: 1.538357, loss_ss: 1.091229, loss_d: 0.447128
0.9985 --- loss: 1.459157, loss_ss: 0.999097, loss_d: 0.460059
Epoch finished! Loss: 1.6400790503391853
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.385766, loss_ss: 0.990696, loss_d: 0.395071
0.0384 --- loss: 1.415642, loss_ss: 0.971016, loss_d: 0.444626
0.0768 --- loss: 1.608438, loss_ss: 1.091390, loss_d: 0.517049
0.1152 --- loss: 1.708032, loss_ss: 1.218454, loss_d: 0.489578
0.1536 --- loss: 2.007721, loss_ss: 1.154451, loss_d: 0.853270
0.1920 --- loss: 1.541371, loss_ss: 1.000688, loss_d: 0.540683
0.2304 --- loss: 1.446563, loss_ss: 1.022738, loss_d: 0.423825
0.2688 --- loss: 1.396704, loss_ss: 0.934234, loss_d: 0.462469
0.3072 --- loss: 1.670324, loss_ss: 1.306011, loss_d: 0.364313
0.3456 --- loss: 1.549363, loss_ss: 1.168907, loss_d: 0.380456
0.3840 --- loss: 1.507685, loss_ss: 1.172842, loss_d: 0.334843
0.4224 --- loss: 1.425881, loss_ss: 0.996101, loss_d: 0.429780
0.4608 --- loss: 1.534200, loss_ss: 0.759199, loss_d: 0.775001
0.4992 --- loss: 1.774171, loss_ss: 1.345263, loss_d: 0.428909
0.5376 --- loss: 1.547035, loss_ss: 1.127839, loss_d: 0.419197
0.5760 --- loss: 1.516115, loss_ss: 1.083191, loss_d: 0.432924
0.6144 --- loss: 1.647941, loss_ss: 0.964162, loss_d: 0.683779
0.6528 --- loss: 1.233612, loss_ss: 0.964863, loss_d: 0.268748
0.6912 --- loss: 1.570668, loss_ss: 1.193758, loss_d: 0.376910
0.7296 --- loss: 2.243881, loss_ss: 1.309264, loss_d: 0.934617
0.7680 --- loss: 1.515183, loss_ss: 1.040927, loss_d: 0.474256
0.8065 --- loss: 1.833033, loss_ss: 1.399465, loss_d: 0.433568
0.8449 --- loss: 1.239327, loss_ss: 0.853764, loss_d: 0.385563
0.8833 --- loss: 1.473881, loss_ss: 1.003629, loss_d: 0.470252
0.9217 --- loss: 1.766581, loss_ss: 1.121534, loss_d: 0.645047
0.9601 --- loss: 1.475669, loss_ss: 1.061490, loss_d: 0.414179
0.9985 --- loss: 1.459278, loss_ss: 1.098064, loss_d: 0.361213
Epoch finished! Loss: 1.6202345641759726
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.838886, loss_ss: 0.890717, loss_d: 0.948169
0.0384 --- loss: 1.327150, loss_ss: 0.928913, loss_d: 0.398237
0.0768 --- loss: 1.366337, loss_ss: 0.877918, loss_d: 0.488418
0.1152 --- loss: 1.564263, loss_ss: 0.993495, loss_d: 0.570768
0.1536 --- loss: 1.652156, loss_ss: 1.269585, loss_d: 0.382571
0.1920 --- loss: 1.597327, loss_ss: 1.174909, loss_d: 0.422417
0.2304 --- loss: 1.777352, loss_ss: 1.269504, loss_d: 0.507848
0.2688 --- loss: 1.418291, loss_ss: 1.003103, loss_d: 0.415188
0.3072 --- loss: 1.480299, loss_ss: 1.096422, loss_d: 0.383878
0.3456 --- loss: 1.874349, loss_ss: 0.950011, loss_d: 0.924338
0.3840 --- loss: 1.801337, loss_ss: 1.344392, loss_d: 0.456945
0.4224 --- loss: 1.410866, loss_ss: 1.022214, loss_d: 0.388652
0.4608 --- loss: 1.617679, loss_ss: 1.165024, loss_d: 0.452656
0.4992 --- loss: 1.426178, loss_ss: 0.963499, loss_d: 0.462679
0.5376 --- loss: 1.206468, loss_ss: 0.856820, loss_d: 0.349649
0.5760 --- loss: 1.724975, loss_ss: 1.046920, loss_d: 0.678055
0.6144 --- loss: 1.279646, loss_ss: 0.908090, loss_d: 0.371555
0.6528 --- loss: 1.714038, loss_ss: 1.165297, loss_d: 0.548741
0.6912 --- loss: 1.811733, loss_ss: 1.162756, loss_d: 0.648978
0.7296 --- loss: 1.405763, loss_ss: 0.968013, loss_d: 0.437751
0.7680 --- loss: 1.820597, loss_ss: 1.447225, loss_d: 0.373372
0.8065 --- loss: 1.380554, loss_ss: 0.931766, loss_d: 0.448788
0.8449 --- loss: 1.459329, loss_ss: 1.079815, loss_d: 0.379514
0.8833 --- loss: 1.604838, loss_ss: 0.900992, loss_d: 0.703846
0.9217 --- loss: 1.543639, loss_ss: 1.106175, loss_d: 0.437464
0.9601 --- loss: 1.931821, loss_ss: 1.350556, loss_d: 0.581265
0.9985 --- loss: 1.815564, loss_ss: 1.544710, loss_d: 0.270854
Epoch finished! Loss: 1.5882860600948334
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.848805, loss_ss: 1.338349, loss_d: 0.510456
0.0384 --- loss: 1.790359, loss_ss: 1.329245, loss_d: 0.461114
0.0768 --- loss: 1.853044, loss_ss: 1.127822, loss_d: 0.725221
0.1152 --- loss: 1.686299, loss_ss: 1.227535, loss_d: 0.458764
0.1536 --- loss: 1.646422, loss_ss: 1.016397, loss_d: 0.630026
0.1920 --- loss: 1.373732, loss_ss: 0.806194, loss_d: 0.567538
0.2304 --- loss: 1.849075, loss_ss: 1.427173, loss_d: 0.421902
0.2688 --- loss: 1.504715, loss_ss: 0.869756, loss_d: 0.634959
0.3072 --- loss: 1.436668, loss_ss: 1.133503, loss_d: 0.303165
0.3456 --- loss: 1.583783, loss_ss: 1.184489, loss_d: 0.399294
0.3840 --- loss: 1.767681, loss_ss: 1.208680, loss_d: 0.559001
0.4224 --- loss: 1.669209, loss_ss: 1.295150, loss_d: 0.374059
0.4608 --- loss: 1.489205, loss_ss: 1.036547, loss_d: 0.452658
0.4992 --- loss: 1.442608, loss_ss: 1.080526, loss_d: 0.362083
0.5376 --- loss: 1.479268, loss_ss: 0.997359, loss_d: 0.481910
0.5760 --- loss: 1.332368, loss_ss: 0.914692, loss_d: 0.417676
0.6144 --- loss: 1.325027, loss_ss: 1.029843, loss_d: 0.295183
0.6528 --- loss: 1.466426, loss_ss: 1.118178, loss_d: 0.348247
0.6912 --- loss: 1.528926, loss_ss: 1.107263, loss_d: 0.421664
0.7296 --- loss: 1.226893, loss_ss: 0.935240, loss_d: 0.291652
0.7680 --- loss: 1.666531, loss_ss: 1.354305, loss_d: 0.312226
0.8065 --- loss: 1.703298, loss_ss: 1.211003, loss_d: 0.492295
0.8449 --- loss: 2.149886, loss_ss: 1.683251, loss_d: 0.466635
0.8833 --- loss: 1.448111, loss_ss: 1.066334, loss_d: 0.381776
0.9217 --- loss: 1.539024, loss_ss: 1.110650, loss_d: 0.428374
0.9601 --- loss: 1.507150, loss_ss: 1.133517, loss_d: 0.373633
0.9985 --- loss: 2.338265, loss_ss: 1.111936, loss_d: 1.226329
Epoch finished! Loss: 1.5771996814471025
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.603956, loss_ss: 1.188741, loss_d: 0.415214
0.0384 --- loss: 1.394612, loss_ss: 0.845655, loss_d: 0.548957
0.0768 --- loss: 1.734824, loss_ss: 0.997998, loss_d: 0.736827
0.1152 --- loss: 1.606182, loss_ss: 1.197066, loss_d: 0.409116
0.1536 --- loss: 1.701670, loss_ss: 0.973167, loss_d: 0.728503
0.1920 --- loss: 1.687472, loss_ss: 1.354236, loss_d: 0.333236
0.2304 --- loss: 1.302781, loss_ss: 0.801461, loss_d: 0.501320
0.2688 --- loss: 1.274728, loss_ss: 0.946243, loss_d: 0.328485
0.3072 --- loss: 1.451413, loss_ss: 1.016544, loss_d: 0.434869
0.3456 --- loss: 2.005002, loss_ss: 1.507645, loss_d: 0.497357
0.3840 --- loss: 1.410716, loss_ss: 0.922412, loss_d: 0.488304
0.4224 --- loss: 1.574793, loss_ss: 1.170321, loss_d: 0.404471
0.4608 --- loss: 1.622971, loss_ss: 0.999777, loss_d: 0.623194
0.4992 --- loss: 1.501575, loss_ss: 0.943977, loss_d: 0.557598
0.5376 --- loss: 1.287349, loss_ss: 0.925221, loss_d: 0.362127
0.5760 --- loss: 1.542235, loss_ss: 1.069234, loss_d: 0.473002
0.6144 --- loss: 1.439944, loss_ss: 0.905276, loss_d: 0.534668
0.6528 --- loss: 1.628000, loss_ss: 1.098675, loss_d: 0.529325
0.6912 --- loss: 1.640963, loss_ss: 1.067166, loss_d: 0.573797
0.7296 --- loss: 1.573941, loss_ss: 1.226939, loss_d: 0.347002
0.7680 --- loss: 1.369068, loss_ss: 0.975416, loss_d: 0.393651
0.8065 --- loss: 1.550147, loss_ss: 0.986439, loss_d: 0.563708
0.8449 --- loss: 1.444100, loss_ss: 1.074098, loss_d: 0.370002
0.8833 --- loss: 1.691965, loss_ss: 1.311901, loss_d: 0.380063
0.9217 --- loss: 1.617345, loss_ss: 1.172359, loss_d: 0.444986
0.9601 --- loss: 1.345772, loss_ss: 0.991101, loss_d: 0.354671
0.9985 --- loss: 1.422283, loss_ss: 1.019182, loss_d: 0.403101
Epoch finished! Loss: 1.5324830814049795
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.40784313725490196
             precision    recall  f1-score   support

        0.0       0.41      0.55      0.47        96
        1.0       0.00      0.00      0.00       123
        2.0       0.00      0.00      0.00       355
        3.0       1.00      0.64      0.78       209
        4.0       0.30      0.97      0.46       237

avg / total       0.31      0.41      0.31      1020
 


====== chp009-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  88.33  55.21   91.77   41.09     47.11
1  87.94   0.00  100.00    0.00      0.00
2  65.20   0.00  100.00    0.00      0.00
3  92.65  64.11  100.00  100.00     78.13
4  47.45  96.62   32.57   30.25     46.08
Total accuracy: 40.78%
Average sen: 43.19%
Average spec: 84.87%
Macro f1-score: 34.26%
[0.72319943 0.80054206 0.82796144 0.67683482 0.52419186 0.55901957
 0.82781273 0.82109416 0.83709371 0.83546716 0.83141583 0.83255708
 0.81316471 0.80351454 0.81295872 0.79936498 0.77089965 0.79768568
 0.75466216 0.80519533 0.63832235 0.55872935 0.52293348 0.81243134
 0.82874382 0.77910054 0.80903912 0.82643747 0.80885828 0.78612596
 0.80131149 0.80872327 0.83127135 0.80142403]
pred: 0.7667084546650157, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.347728, loss_ss: 1.673566, loss_d: 0.674162
0.0384 --- loss: 2.530715, loss_ss: 1.796712, loss_d: 0.734003
0.0767 --- loss: 2.013428, loss_ss: 1.640479, loss_d: 0.372949
0.1151 --- loss: 2.251042, loss_ss: 1.713327, loss_d: 0.537715
0.1535 --- loss: 2.523405, loss_ss: 1.704118, loss_d: 0.819287
0.1919 --- loss: 2.526988, loss_ss: 1.844842, loss_d: 0.682145
0.2302 --- loss: 2.218642, loss_ss: 1.608310, loss_d: 0.610332
0.2686 --- loss: 1.946864, loss_ss: 1.665567, loss_d: 0.281298
0.3070 --- loss: 2.229250, loss_ss: 1.773885, loss_d: 0.455365
0.3454 --- loss: 2.343938, loss_ss: 1.639503, loss_d: 0.704435
0.3837 --- loss: 2.101984, loss_ss: 1.609540, loss_d: 0.492444
0.4221 --- loss: 2.121715, loss_ss: 1.654464, loss_d: 0.467250
0.4605 --- loss: 2.346146, loss_ss: 1.558267, loss_d: 0.787879
0.4988 --- loss: 2.037304, loss_ss: 1.599295, loss_d: 0.438008
0.5372 --- loss: 2.011251, loss_ss: 1.629412, loss_d: 0.381839
0.5756 --- loss: 1.962124, loss_ss: 1.503127, loss_d: 0.458998
0.6140 --- loss: 2.322037, loss_ss: 1.592356, loss_d: 0.729681
0.6523 --- loss: 2.087723, loss_ss: 1.635600, loss_d: 0.452123
0.6907 --- loss: 2.411383, loss_ss: 1.570641, loss_d: 0.840741
0.7291 --- loss: 2.002387, loss_ss: 1.602103, loss_d: 0.400283
0.7675 --- loss: 1.859892, loss_ss: 1.443716, loss_d: 0.416176
0.8058 --- loss: 2.043264, loss_ss: 1.668059, loss_d: 0.375205
0.8442 --- loss: 2.063428, loss_ss: 1.549344, loss_d: 0.514084
0.8826 --- loss: 2.063446, loss_ss: 1.608909, loss_d: 0.454537
0.9210 --- loss: 2.105765, loss_ss: 1.536801, loss_d: 0.568964
0.9593 --- loss: 2.101874, loss_ss: 1.631073, loss_d: 0.470801
0.9977 --- loss: 2.237169, loss_ss: 1.461003, loss_d: 0.776166
Epoch finished! Loss: 2.1635016028697676
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.967001, loss_ss: 1.520463, loss_d: 0.446538
0.0384 --- loss: 1.935757, loss_ss: 1.519166, loss_d: 0.416591
0.0767 --- loss: 1.911189, loss_ss: 1.550439, loss_d: 0.360750
0.1151 --- loss: 2.210623, loss_ss: 1.471797, loss_d: 0.738825
0.1535 --- loss: 2.016541, loss_ss: 1.758741, loss_d: 0.257800
0.1919 --- loss: 1.881887, loss_ss: 1.469823, loss_d: 0.412064
0.2302 --- loss: 2.050413, loss_ss: 1.459815, loss_d: 0.590598
0.2686 --- loss: 2.108385, loss_ss: 1.365967, loss_d: 0.742418
0.3070 --- loss: 1.908793, loss_ss: 1.527100, loss_d: 0.381694
0.3454 --- loss: 1.829155, loss_ss: 1.501047, loss_d: 0.328108
0.3837 --- loss: 2.368734, loss_ss: 1.396581, loss_d: 0.972153
0.4221 --- loss: 1.738202, loss_ss: 1.387386, loss_d: 0.350816
0.4605 --- loss: 1.905714, loss_ss: 1.568416, loss_d: 0.337298
0.4988 --- loss: 2.057508, loss_ss: 1.557498, loss_d: 0.500010
0.5372 --- loss: 2.273715, loss_ss: 1.445932, loss_d: 0.827783
0.5756 --- loss: 1.891758, loss_ss: 1.547386, loss_d: 0.344372
0.6140 --- loss: 1.973149, loss_ss: 1.597951, loss_d: 0.375198
0.6523 --- loss: 1.922386, loss_ss: 1.475131, loss_d: 0.447255
0.6907 --- loss: 1.887323, loss_ss: 1.564847, loss_d: 0.322476
0.7291 --- loss: 2.167661, loss_ss: 1.423699, loss_d: 0.743962
0.7675 --- loss: 1.835488, loss_ss: 1.194205, loss_d: 0.641283
0.8058 --- loss: 1.811344, loss_ss: 1.380902, loss_d: 0.430442
0.8442 --- loss: 1.740439, loss_ss: 1.345721, loss_d: 0.394718
0.8826 --- loss: 2.251745, loss_ss: 1.760216, loss_d: 0.491529
0.9210 --- loss: 2.012553, loss_ss: 1.581559, loss_d: 0.430994
0.9593 --- loss: 1.735260, loss_ss: 1.355704, loss_d: 0.379556
0.9977 --- loss: 1.682506, loss_ss: 1.354470, loss_d: 0.328037
Epoch finished! Loss: 2.0058081374718593
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.741640, loss_ss: 1.296392, loss_d: 0.445248
0.0384 --- loss: 1.701270, loss_ss: 1.293269, loss_d: 0.408001
0.0767 --- loss: 2.182908, loss_ss: 1.414875, loss_d: 0.768033
0.1151 --- loss: 1.974649, loss_ss: 1.300220, loss_d: 0.674429
0.1535 --- loss: 1.701440, loss_ss: 1.311918, loss_d: 0.389523
0.1919 --- loss: 1.923903, loss_ss: 1.369469, loss_d: 0.554434
0.2302 --- loss: 1.723585, loss_ss: 1.354468, loss_d: 0.369117
0.2686 --- loss: 1.883427, loss_ss: 1.325426, loss_d: 0.558001
0.3070 --- loss: 1.885642, loss_ss: 1.497318, loss_d: 0.388324
0.3454 --- loss: 1.857874, loss_ss: 1.542421, loss_d: 0.315453
0.3837 --- loss: 1.624928, loss_ss: 1.218832, loss_d: 0.406097
0.4221 --- loss: 1.631745, loss_ss: 1.303377, loss_d: 0.328369
0.4605 --- loss: 1.750631, loss_ss: 1.305539, loss_d: 0.445092
0.4988 --- loss: 1.626383, loss_ss: 1.155208, loss_d: 0.471175
0.5372 --- loss: 1.886456, loss_ss: 1.411204, loss_d: 0.475252
0.5756 --- loss: 1.597742, loss_ss: 1.274697, loss_d: 0.323045
0.6140 --- loss: 1.765157, loss_ss: 1.317549, loss_d: 0.447608
0.6523 --- loss: 2.619323, loss_ss: 1.448244, loss_d: 1.171079
0.6907 --- loss: 2.029519, loss_ss: 1.542962, loss_d: 0.486557
0.7291 --- loss: 2.324511, loss_ss: 1.533195, loss_d: 0.791316
0.7675 --- loss: 1.760368, loss_ss: 1.319484, loss_d: 0.440885
0.8058 --- loss: 1.844524, loss_ss: 1.409725, loss_d: 0.434799
0.8442 --- loss: 1.770025, loss_ss: 1.311048, loss_d: 0.458977
0.8826 --- loss: 1.750802, loss_ss: 1.333453, loss_d: 0.417349
0.9210 --- loss: 1.867460, loss_ss: 1.345159, loss_d: 0.522301
0.9593 --- loss: 1.936742, loss_ss: 1.354960, loss_d: 0.581782
0.9977 --- loss: 1.786416, loss_ss: 1.377235, loss_d: 0.409181
Epoch finished! Loss: 1.8991570215958815
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.000763, loss_ss: 1.480523, loss_d: 0.520241
0.0384 --- loss: 1.730404, loss_ss: 1.259740, loss_d: 0.470663
0.0767 --- loss: 1.772398, loss_ss: 1.369158, loss_d: 0.403240
0.1151 --- loss: 1.645564, loss_ss: 1.228393, loss_d: 0.417171
0.1535 --- loss: 1.792973, loss_ss: 1.489520, loss_d: 0.303454
0.1919 --- loss: 1.778481, loss_ss: 1.235430, loss_d: 0.543051
0.2302 --- loss: 1.694307, loss_ss: 1.247712, loss_d: 0.446596
0.2686 --- loss: 2.260907, loss_ss: 1.404201, loss_d: 0.856705
0.3070 --- loss: 1.872870, loss_ss: 1.253480, loss_d: 0.619389
0.3454 --- loss: 1.651685, loss_ss: 1.301716, loss_d: 0.349969
0.3837 --- loss: 1.855170, loss_ss: 1.456125, loss_d: 0.399045
0.4221 --- loss: 1.629038, loss_ss: 1.196713, loss_d: 0.432325
0.4605 --- loss: 1.785068, loss_ss: 1.323403, loss_d: 0.461665
0.4988 --- loss: 2.027725, loss_ss: 1.462307, loss_d: 0.565417
0.5372 --- loss: 1.719643, loss_ss: 1.176755, loss_d: 0.542888
0.5756 --- loss: 1.673160, loss_ss: 1.340631, loss_d: 0.332529
0.6140 --- loss: 1.758309, loss_ss: 1.280962, loss_d: 0.477346
0.6523 --- loss: 1.681139, loss_ss: 1.176071, loss_d: 0.505068
0.6907 --- loss: 1.967662, loss_ss: 1.321162, loss_d: 0.646500
0.7291 --- loss: 1.887217, loss_ss: 1.394529, loss_d: 0.492689
0.7675 --- loss: 2.243713, loss_ss: 1.487256, loss_d: 0.756457
0.8058 --- loss: 1.441032, loss_ss: 1.071026, loss_d: 0.370006
0.8442 --- loss: 1.880491, loss_ss: 1.286218, loss_d: 0.594273
0.8826 --- loss: 1.584539, loss_ss: 1.191894, loss_d: 0.392645
0.9210 --- loss: 1.383094, loss_ss: 1.071243, loss_d: 0.311851
0.9593 --- loss: 1.841571, loss_ss: 1.305072, loss_d: 0.536498
0.9977 --- loss: 1.373428, loss_ss: 1.033363, loss_d: 0.340065
Epoch finished! Loss: 1.8122202731095827
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.736079, loss_ss: 1.220599, loss_d: 0.515481
0.0384 --- loss: 1.616544, loss_ss: 1.192438, loss_d: 0.424106
0.0767 --- loss: 1.460996, loss_ss: 1.168087, loss_d: 0.292908
0.1151 --- loss: 1.766494, loss_ss: 1.306568, loss_d: 0.459925
0.1535 --- loss: 1.893501, loss_ss: 1.425941, loss_d: 0.467560
0.1919 --- loss: 1.711556, loss_ss: 1.234127, loss_d: 0.477428
0.2302 --- loss: 2.294180, loss_ss: 1.238119, loss_d: 1.056061
0.2686 --- loss: 2.099472, loss_ss: 1.580835, loss_d: 0.518637
0.3070 --- loss: 1.770043, loss_ss: 1.244213, loss_d: 0.525830
0.3454 --- loss: 1.637993, loss_ss: 1.209860, loss_d: 0.428133
0.3837 --- loss: 1.784139, loss_ss: 0.982210, loss_d: 0.801929
0.4221 --- loss: 2.007259, loss_ss: 1.690659, loss_d: 0.316600
0.4605 --- loss: 2.300876, loss_ss: 1.830137, loss_d: 0.470739
0.4988 --- loss: 1.721746, loss_ss: 1.195614, loss_d: 0.526132
0.5372 --- loss: 1.536891, loss_ss: 1.133608, loss_d: 0.403283
0.5756 --- loss: 1.369909, loss_ss: 0.992735, loss_d: 0.377174
0.6140 --- loss: 1.488307, loss_ss: 1.149431, loss_d: 0.338876
0.6523 --- loss: 1.968782, loss_ss: 1.198984, loss_d: 0.769798
0.6907 --- loss: 1.859759, loss_ss: 1.324687, loss_d: 0.535072
0.7291 --- loss: 1.619680, loss_ss: 1.048212, loss_d: 0.571468
0.7675 --- loss: 1.421679, loss_ss: 1.057280, loss_d: 0.364399
0.8058 --- loss: 1.833206, loss_ss: 1.554507, loss_d: 0.278699
0.8442 --- loss: 2.333767, loss_ss: 1.329725, loss_d: 1.004042
0.8826 --- loss: 2.009331, loss_ss: 1.449143, loss_d: 0.560188
0.9210 --- loss: 1.590276, loss_ss: 1.150699, loss_d: 0.439578
0.9593 --- loss: 1.473920, loss_ss: 1.108811, loss_d: 0.365109
0.9977 --- loss: 1.330305, loss_ss: 1.016417, loss_d: 0.313888
Epoch finished! Loss: 1.7167691858915182
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.774184, loss_ss: 1.206288, loss_d: 0.567896
0.0384 --- loss: 1.523414, loss_ss: 1.124861, loss_d: 0.398553
0.0767 --- loss: 1.645416, loss_ss: 1.019351, loss_d: 0.626065
0.1151 --- loss: 1.566001, loss_ss: 1.145952, loss_d: 0.420048
0.1535 --- loss: 1.530653, loss_ss: 1.018341, loss_d: 0.512312
0.1919 --- loss: 2.622552, loss_ss: 1.210708, loss_d: 1.411844
0.2302 --- loss: 1.507445, loss_ss: 1.150890, loss_d: 0.356556
0.2686 --- loss: 1.514385, loss_ss: 1.044804, loss_d: 0.469581
0.3070 --- loss: 1.608439, loss_ss: 1.114256, loss_d: 0.494183
0.3454 --- loss: 1.737445, loss_ss: 1.123546, loss_d: 0.613900
0.3837 --- loss: 1.897384, loss_ss: 1.558098, loss_d: 0.339285
0.4221 --- loss: 1.574751, loss_ss: 1.091798, loss_d: 0.482954
0.4605 --- loss: 1.883096, loss_ss: 1.183997, loss_d: 0.699099
0.4988 --- loss: 1.613587, loss_ss: 1.036614, loss_d: 0.576973
0.5372 --- loss: 1.675806, loss_ss: 1.277588, loss_d: 0.398217
0.5756 --- loss: 1.740996, loss_ss: 1.006678, loss_d: 0.734318
0.6140 --- loss: 1.715177, loss_ss: 1.058986, loss_d: 0.656191
0.6523 --- loss: 1.560252, loss_ss: 1.172986, loss_d: 0.387267
0.6907 --- loss: 1.505496, loss_ss: 1.051985, loss_d: 0.453511
0.7291 --- loss: 1.398082, loss_ss: 0.961408, loss_d: 0.436674
0.7675 --- loss: 1.614453, loss_ss: 1.090199, loss_d: 0.524254
0.8058 --- loss: 1.514263, loss_ss: 1.011160, loss_d: 0.503103
0.8442 --- loss: 1.392148, loss_ss: 1.032083, loss_d: 0.360065
0.8826 --- loss: 1.556261, loss_ss: 1.031839, loss_d: 0.524422
0.9210 --- loss: 1.833427, loss_ss: 1.364090, loss_d: 0.469338
0.9593 --- loss: 1.631332, loss_ss: 1.111335, loss_d: 0.519997
0.9977 --- loss: 1.592802, loss_ss: 1.283871, loss_d: 0.308931
Epoch finished! Loss: 1.6610612745468434
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.672646, loss_ss: 1.365332, loss_d: 0.307314
0.0384 --- loss: 1.536787, loss_ss: 1.128501, loss_d: 0.408286
0.0767 --- loss: 1.691965, loss_ss: 1.252808, loss_d: 0.439157
0.1151 --- loss: 1.886145, loss_ss: 1.441065, loss_d: 0.445080
0.1535 --- loss: 1.507841, loss_ss: 1.115887, loss_d: 0.391954
0.1919 --- loss: 1.986423, loss_ss: 1.610809, loss_d: 0.375614
0.2302 --- loss: 1.868426, loss_ss: 0.961436, loss_d: 0.906991
0.2686 --- loss: 1.678513, loss_ss: 1.110779, loss_d: 0.567734
0.3070 --- loss: 1.449332, loss_ss: 1.068361, loss_d: 0.380971
0.3454 --- loss: 1.608743, loss_ss: 1.189841, loss_d: 0.418902
0.3837 --- loss: 1.554316, loss_ss: 1.020619, loss_d: 0.533698
0.4221 --- loss: 2.078273, loss_ss: 1.432646, loss_d: 0.645627
0.4605 --- loss: 1.277673, loss_ss: 0.908596, loss_d: 0.369077
0.4988 --- loss: 1.560919, loss_ss: 1.022710, loss_d: 0.538209
0.5372 --- loss: 1.470402, loss_ss: 1.042819, loss_d: 0.427582
0.5756 --- loss: 1.576581, loss_ss: 1.093288, loss_d: 0.483293
0.6140 --- loss: 1.592323, loss_ss: 0.894178, loss_d: 0.698145
0.6523 --- loss: 1.317257, loss_ss: 0.845284, loss_d: 0.471972
0.6907 --- loss: 1.556671, loss_ss: 1.212055, loss_d: 0.344616
0.7291 --- loss: 2.128579, loss_ss: 1.111139, loss_d: 1.017439
0.7675 --- loss: 2.257425, loss_ss: 0.981971, loss_d: 1.275454
0.8058 --- loss: 1.730656, loss_ss: 1.120288, loss_d: 0.610367
0.8442 --- loss: 1.469490, loss_ss: 1.034129, loss_d: 0.435361
0.8826 --- loss: 2.071527, loss_ss: 1.523970, loss_d: 0.547557
0.9210 --- loss: 1.463029, loss_ss: 1.144860, loss_d: 0.318169
0.9593 --- loss: 1.652934, loss_ss: 1.369499, loss_d: 0.283436
0.9977 --- loss: 1.444922, loss_ss: 1.159567, loss_d: 0.285355
Epoch finished! Loss: 1.6135319205430838
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.256567, loss_ss: 0.935570, loss_d: 0.320997
0.0384 --- loss: 2.782298, loss_ss: 1.104273, loss_d: 1.678025
0.0767 --- loss: 1.464473, loss_ss: 0.976485, loss_d: 0.487988
0.1151 --- loss: 1.482014, loss_ss: 0.974697, loss_d: 0.507317
0.1535 --- loss: 1.229245, loss_ss: 0.860670, loss_d: 0.368575
0.1919 --- loss: 1.325149, loss_ss: 1.009761, loss_d: 0.315388
0.2302 --- loss: 1.357097, loss_ss: 0.980161, loss_d: 0.376936
0.2686 --- loss: 1.567643, loss_ss: 1.003420, loss_d: 0.564223
0.3070 --- loss: 1.283591, loss_ss: 0.956491, loss_d: 0.327100
0.3454 --- loss: 1.490767, loss_ss: 1.100113, loss_d: 0.390654
0.3837 --- loss: 1.212536, loss_ss: 0.832143, loss_d: 0.380393
0.4221 --- loss: 1.641888, loss_ss: 1.274704, loss_d: 0.367185
0.4605 --- loss: 1.698945, loss_ss: 1.108172, loss_d: 0.590773
0.4988 --- loss: 1.751633, loss_ss: 1.378567, loss_d: 0.373066
0.5372 --- loss: 1.462085, loss_ss: 1.119795, loss_d: 0.342290
0.5756 --- loss: 1.320359, loss_ss: 0.961144, loss_d: 0.359215
0.6140 --- loss: 1.266377, loss_ss: 0.986543, loss_d: 0.279835
0.6523 --- loss: 1.411508, loss_ss: 1.098738, loss_d: 0.312771
0.6907 --- loss: 1.319683, loss_ss: 0.926112, loss_d: 0.393570
0.7291 --- loss: 1.454114, loss_ss: 1.103679, loss_d: 0.350436
0.7675 --- loss: 1.521514, loss_ss: 1.251924, loss_d: 0.269589
0.8058 --- loss: 1.505488, loss_ss: 1.194280, loss_d: 0.311208
0.8442 --- loss: 1.586998, loss_ss: 1.210619, loss_d: 0.376378
0.8826 --- loss: 1.551470, loss_ss: 1.194672, loss_d: 0.356798
0.9210 --- loss: 1.481906, loss_ss: 1.101750, loss_d: 0.380156
0.9593 --- loss: 1.373600, loss_ss: 1.068874, loss_d: 0.304727
0.9977 --- loss: 1.773311, loss_ss: 1.291134, loss_d: 0.482177
Epoch finished! Loss: 1.5976335796026082
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.436097, loss_ss: 1.082808, loss_d: 0.353289
0.0384 --- loss: 1.343048, loss_ss: 0.909162, loss_d: 0.433886
0.0767 --- loss: 1.736404, loss_ss: 1.375488, loss_d: 0.360916
0.1151 --- loss: 1.377254, loss_ss: 0.950925, loss_d: 0.426328
0.1535 --- loss: 1.466651, loss_ss: 1.061105, loss_d: 0.405546
0.1919 --- loss: 1.894941, loss_ss: 1.165704, loss_d: 0.729237
0.2302 --- loss: 1.429517, loss_ss: 0.966848, loss_d: 0.462669
0.2686 --- loss: 1.229416, loss_ss: 0.873362, loss_d: 0.356053
0.3070 --- loss: 1.523076, loss_ss: 1.162205, loss_d: 0.360871
0.3454 --- loss: 1.954711, loss_ss: 1.643739, loss_d: 0.310972
0.3837 --- loss: 1.692680, loss_ss: 1.257863, loss_d: 0.434817
0.4221 --- loss: 1.562743, loss_ss: 1.178240, loss_d: 0.384502
0.4605 --- loss: 1.556903, loss_ss: 1.154076, loss_d: 0.402827
0.4988 --- loss: 1.429916, loss_ss: 0.916349, loss_d: 0.513568
0.5372 --- loss: 1.732973, loss_ss: 1.263473, loss_d: 0.469499
0.5756 --- loss: 1.785833, loss_ss: 1.392410, loss_d: 0.393424
0.6140 --- loss: 1.503566, loss_ss: 1.133754, loss_d: 0.369812
0.6523 --- loss: 1.891477, loss_ss: 1.305950, loss_d: 0.585527
0.6907 --- loss: 1.155880, loss_ss: 0.755539, loss_d: 0.400341
0.7291 --- loss: 1.390500, loss_ss: 0.902177, loss_d: 0.488322
0.7675 --- loss: 1.407326, loss_ss: 0.995084, loss_d: 0.412243
0.8058 --- loss: 1.420141, loss_ss: 1.064824, loss_d: 0.355317
0.8442 --- loss: 1.200114, loss_ss: 0.961124, loss_d: 0.238990
0.8826 --- loss: 1.540584, loss_ss: 1.239495, loss_d: 0.301090
0.9210 --- loss: 1.652637, loss_ss: 1.062095, loss_d: 0.590541
0.9593 --- loss: 1.555272, loss_ss: 1.041821, loss_d: 0.513451
0.9977 --- loss: 1.540048, loss_ss: 1.177802, loss_d: 0.362246
Epoch finished! Loss: 1.5743707941128657
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.449749, loss_ss: 0.944400, loss_d: 0.505348
0.0384 --- loss: 1.345526, loss_ss: 1.006858, loss_d: 0.338668
0.0767 --- loss: 1.752684, loss_ss: 1.337583, loss_d: 0.415100
0.1151 --- loss: 1.672074, loss_ss: 0.829893, loss_d: 0.842181
0.1535 --- loss: 1.043982, loss_ss: 0.773709, loss_d: 0.270273
0.1919 --- loss: 1.598497, loss_ss: 1.167296, loss_d: 0.431201
0.2302 --- loss: 1.634778, loss_ss: 1.177533, loss_d: 0.457245
0.2686 --- loss: 1.400165, loss_ss: 0.898224, loss_d: 0.501941
0.3070 --- loss: 1.332779, loss_ss: 1.055331, loss_d: 0.277449
0.3454 --- loss: 1.458583, loss_ss: 0.981528, loss_d: 0.477054
0.3837 --- loss: 1.289408, loss_ss: 0.971334, loss_d: 0.318074
0.4221 --- loss: 1.815337, loss_ss: 1.172390, loss_d: 0.642946
0.4605 --- loss: 1.443681, loss_ss: 1.100372, loss_d: 0.343309
0.4988 --- loss: 1.909057, loss_ss: 1.116628, loss_d: 0.792430
0.5372 --- loss: 1.360786, loss_ss: 0.875605, loss_d: 0.485182
0.5756 --- loss: 1.486185, loss_ss: 1.087152, loss_d: 0.399033
0.6140 --- loss: 1.989887, loss_ss: 1.604957, loss_d: 0.384930
0.6523 --- loss: 1.525344, loss_ss: 1.100109, loss_d: 0.425235
0.6907 --- loss: 1.188748, loss_ss: 0.985711, loss_d: 0.203037
0.7291 --- loss: 2.090054, loss_ss: 1.220923, loss_d: 0.869131
0.7675 --- loss: 1.690109, loss_ss: 1.206897, loss_d: 0.483212
0.8058 --- loss: 1.270185, loss_ss: 0.907668, loss_d: 0.362517
0.8442 --- loss: 1.367131, loss_ss: 1.001651, loss_d: 0.365480
0.8826 --- loss: 1.422463, loss_ss: 1.025392, loss_d: 0.397070
0.9210 --- loss: 1.441885, loss_ss: 1.046918, loss_d: 0.394967
0.9593 --- loss: 1.743679, loss_ss: 1.123073, loss_d: 0.620606
0.9977 --- loss: 1.802480, loss_ss: 1.446261, loss_d: 0.356219
Epoch finished! Loss: 1.531341339303897
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5520833333333334
             precision    recall  f1-score   support

        0.0       1.00      0.09      0.16        57
        1.0       0.00      0.00      0.00        60
        2.0       0.59      0.96      0.73       496
        3.0       0.32      0.56      0.41        90
        4.0       0.00      0.00      0.00       257

avg / total       0.40      0.55      0.43       960
 


====== chp010-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  94.58   8.77  100.00  100.00     16.13
1  93.75   0.00  100.00    0.00      0.00
2  63.85  95.77   29.74   59.30     73.25
3  85.00  55.56   88.05   32.47     40.98
4  73.23   0.00  100.00    0.00      0.00
Total accuracy: 55.21%
Average sen: 32.02%
Average spec: 83.56%
Macro f1-score: 26.07%
[0.49893963 0.44479629 0.4575505  0.43311206 0.43348017 0.41583732
 0.43878686 0.44780958 0.46948501 0.42643467 0.40773034 0.43639544
 0.41753936 0.48686105 0.47862932 0.48426339 0.41279924 0.45130184
 0.42044452 0.40795249 0.47161296 0.46786186 0.44404233 0.46865335
 0.43443099 0.43276319 0.42562848 0.41665465 0.52061659 0.44736508
 0.47262922 0.43724808]
pred: 0.44717674516141415, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.634040, loss_ss: 1.934425, loss_d: 0.699615
0.0384 --- loss: 2.628757, loss_ss: 1.801685, loss_d: 0.827072
0.0768 --- loss: 2.221835, loss_ss: 1.723450, loss_d: 0.498386
0.1152 --- loss: 2.284692, loss_ss: 1.762283, loss_d: 0.522409
0.1536 --- loss: 2.438808, loss_ss: 1.809482, loss_d: 0.629326
0.1919 --- loss: 2.417724, loss_ss: 1.772040, loss_d: 0.645684
0.2303 --- loss: 2.435872, loss_ss: 1.678036, loss_d: 0.757836
0.2687 --- loss: 2.074404, loss_ss: 1.632704, loss_d: 0.441700
0.3071 --- loss: 2.243772, loss_ss: 1.657698, loss_d: 0.586074
0.3455 --- loss: 2.396966, loss_ss: 1.661269, loss_d: 0.735696
0.3839 --- loss: 2.321352, loss_ss: 1.732568, loss_d: 0.588784
0.4223 --- loss: 2.013344, loss_ss: 1.608386, loss_d: 0.404958
0.4607 --- loss: 2.027153, loss_ss: 1.511721, loss_d: 0.515432
0.4990 --- loss: 2.085553, loss_ss: 1.599435, loss_d: 0.486118
0.5374 --- loss: 2.033735, loss_ss: 1.613979, loss_d: 0.419757
0.5758 --- loss: 2.104494, loss_ss: 1.641521, loss_d: 0.462973
0.6142 --- loss: 2.431804, loss_ss: 1.542039, loss_d: 0.889766
0.6526 --- loss: 1.959242, loss_ss: 1.657401, loss_d: 0.301841
0.6910 --- loss: 2.136965, loss_ss: 1.556313, loss_d: 0.580652
0.7294 --- loss: 2.005060, loss_ss: 1.627627, loss_d: 0.377434
0.7678 --- loss: 1.870396, loss_ss: 1.548914, loss_d: 0.321482
0.8061 --- loss: 2.046754, loss_ss: 1.502948, loss_d: 0.543807
0.8445 --- loss: 2.310277, loss_ss: 1.511986, loss_d: 0.798291
0.8829 --- loss: 2.144610, loss_ss: 1.469621, loss_d: 0.674990
0.9213 --- loss: 1.854085, loss_ss: 1.504532, loss_d: 0.349554
0.9597 --- loss: 1.891938, loss_ss: 1.540387, loss_d: 0.351551
0.9981 --- loss: 2.101003, loss_ss: 1.568609, loss_d: 0.532394
Epoch finished! Loss: 2.2012508071385897
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.854112, loss_ss: 1.498315, loss_d: 0.355797
0.0384 --- loss: 1.895807, loss_ss: 1.522124, loss_d: 0.373683
0.0768 --- loss: 1.992018, loss_ss: 1.456537, loss_d: 0.535481
0.1152 --- loss: 1.897226, loss_ss: 1.528738, loss_d: 0.368488
0.1536 --- loss: 1.867000, loss_ss: 1.432512, loss_d: 0.434488
0.1919 --- loss: 2.170908, loss_ss: 1.514163, loss_d: 0.656745
0.2303 --- loss: 2.192819, loss_ss: 1.557849, loss_d: 0.634971
0.2687 --- loss: 2.021165, loss_ss: 1.485699, loss_d: 0.535467
0.3071 --- loss: 2.017208, loss_ss: 1.609014, loss_d: 0.408194
0.3455 --- loss: 2.402431, loss_ss: 1.612192, loss_d: 0.790240
0.3839 --- loss: 2.095437, loss_ss: 1.509605, loss_d: 0.585832
0.4223 --- loss: 1.915091, loss_ss: 1.363183, loss_d: 0.551908
0.4607 --- loss: 2.120103, loss_ss: 1.553511, loss_d: 0.566593
0.4990 --- loss: 1.977054, loss_ss: 1.368352, loss_d: 0.608703
0.5374 --- loss: 1.808206, loss_ss: 1.342842, loss_d: 0.465364
0.5758 --- loss: 2.659908, loss_ss: 1.440168, loss_d: 1.219740
0.6142 --- loss: 1.759527, loss_ss: 1.315380, loss_d: 0.444147
0.6526 --- loss: 1.911533, loss_ss: 1.506977, loss_d: 0.404556
0.6910 --- loss: 1.891171, loss_ss: 1.523857, loss_d: 0.367315
0.7294 --- loss: 1.862178, loss_ss: 1.539119, loss_d: 0.323059
0.7678 --- loss: 1.640557, loss_ss: 1.210352, loss_d: 0.430204
0.8061 --- loss: 2.081059, loss_ss: 1.344839, loss_d: 0.736221
0.8445 --- loss: 1.673485, loss_ss: 1.178844, loss_d: 0.494640
0.8829 --- loss: 1.826323, loss_ss: 1.388832, loss_d: 0.437490
0.9213 --- loss: 2.189667, loss_ss: 1.224033, loss_d: 0.965634
0.9597 --- loss: 1.926857, loss_ss: 1.213542, loss_d: 0.713314
0.9981 --- loss: 1.658251, loss_ss: 1.153206, loss_d: 0.505045
Epoch finished! Loss: 1.9725343181536747
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.829049, loss_ss: 1.248270, loss_d: 0.580779
0.0384 --- loss: 2.093804, loss_ss: 1.374422, loss_d: 0.719382
0.0768 --- loss: 1.962331, loss_ss: 1.460599, loss_d: 0.501732
0.1152 --- loss: 2.183722, loss_ss: 1.617793, loss_d: 0.565930
0.1536 --- loss: 1.965118, loss_ss: 1.199761, loss_d: 0.765357
0.1919 --- loss: 1.940024, loss_ss: 1.486798, loss_d: 0.453226
0.2303 --- loss: 1.649877, loss_ss: 1.310797, loss_d: 0.339080
0.2687 --- loss: 1.780333, loss_ss: 1.160457, loss_d: 0.619875
0.3071 --- loss: 2.036611, loss_ss: 1.429303, loss_d: 0.607308
0.3455 --- loss: 1.783911, loss_ss: 1.310246, loss_d: 0.473666
0.3839 --- loss: 1.602213, loss_ss: 1.210181, loss_d: 0.392032
0.4223 --- loss: 2.268517, loss_ss: 1.498345, loss_d: 0.770173
0.4607 --- loss: 1.807034, loss_ss: 1.365871, loss_d: 0.441162
0.4990 --- loss: 1.693453, loss_ss: 1.285611, loss_d: 0.407842
0.5374 --- loss: 1.699969, loss_ss: 1.210304, loss_d: 0.489664
0.5758 --- loss: 1.671396, loss_ss: 1.172278, loss_d: 0.499117
0.6142 --- loss: 1.536920, loss_ss: 1.217252, loss_d: 0.319668
0.6526 --- loss: 1.466637, loss_ss: 1.186127, loss_d: 0.280510
0.6910 --- loss: 1.756950, loss_ss: 1.332613, loss_d: 0.424337
0.7294 --- loss: 1.790534, loss_ss: 1.313101, loss_d: 0.477433
0.7678 --- loss: 2.332294, loss_ss: 1.380285, loss_d: 0.952010
0.8061 --- loss: 1.864662, loss_ss: 1.348640, loss_d: 0.516021
0.8445 --- loss: 1.842770, loss_ss: 1.248332, loss_d: 0.594438
0.8829 --- loss: 1.637006, loss_ss: 1.165984, loss_d: 0.471022
0.9213 --- loss: 1.813686, loss_ss: 1.152556, loss_d: 0.661130
0.9597 --- loss: 1.568207, loss_ss: 1.050023, loss_d: 0.518183
0.9981 --- loss: 2.100500, loss_ss: 1.495821, loss_d: 0.604680
Epoch finished! Loss: 1.8246151240972373
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.831292, loss_ss: 1.233678, loss_d: 0.597614
0.0384 --- loss: 1.522380, loss_ss: 1.041296, loss_d: 0.481083
0.0768 --- loss: 2.402768, loss_ss: 1.335862, loss_d: 1.066906
0.1152 --- loss: 1.945525, loss_ss: 1.187206, loss_d: 0.758319
0.1536 --- loss: 1.436662, loss_ss: 1.067874, loss_d: 0.368788
0.1919 --- loss: 1.919662, loss_ss: 1.127213, loss_d: 0.792449
0.2303 --- loss: 1.611822, loss_ss: 1.209063, loss_d: 0.402758
0.2687 --- loss: 1.586252, loss_ss: 1.233164, loss_d: 0.353088
0.3071 --- loss: 1.634285, loss_ss: 1.349147, loss_d: 0.285138
0.3455 --- loss: 1.293630, loss_ss: 1.015851, loss_d: 0.277779
0.3839 --- loss: 1.524036, loss_ss: 1.211080, loss_d: 0.312956
0.4223 --- loss: 1.831751, loss_ss: 1.484647, loss_d: 0.347104
0.4607 --- loss: 1.572767, loss_ss: 1.169726, loss_d: 0.403042
0.4990 --- loss: 1.738374, loss_ss: 1.220296, loss_d: 0.518078
0.5374 --- loss: 1.878472, loss_ss: 1.300306, loss_d: 0.578166
0.5758 --- loss: 1.482643, loss_ss: 0.996548, loss_d: 0.486095
0.6142 --- loss: 1.705596, loss_ss: 1.289073, loss_d: 0.416523
0.6526 --- loss: 2.027519, loss_ss: 1.552521, loss_d: 0.474998
0.6910 --- loss: 1.428128, loss_ss: 0.955517, loss_d: 0.472612
0.7294 --- loss: 1.430395, loss_ss: 0.960917, loss_d: 0.469479
0.7678 --- loss: 2.069836, loss_ss: 1.622068, loss_d: 0.447767
0.8061 --- loss: 1.406061, loss_ss: 1.002852, loss_d: 0.403209
0.8445 --- loss: 1.526270, loss_ss: 1.023134, loss_d: 0.503136
0.8829 --- loss: 1.594325, loss_ss: 1.010484, loss_d: 0.583841
0.9213 --- loss: 1.349573, loss_ss: 0.961335, loss_d: 0.388238
0.9597 --- loss: 1.700749, loss_ss: 1.159511, loss_d: 0.541238
0.9981 --- loss: 2.465799, loss_ss: 1.533646, loss_d: 0.932153
Epoch finished! Loss: 1.6981834306166723
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.475490, loss_ss: 1.064535, loss_d: 0.410955
0.0384 --- loss: 1.520680, loss_ss: 1.066495, loss_d: 0.454186
0.0768 --- loss: 1.335761, loss_ss: 1.019368, loss_d: 0.316393
0.1152 --- loss: 1.682095, loss_ss: 1.181653, loss_d: 0.500441
0.1536 --- loss: 1.545871, loss_ss: 1.112658, loss_d: 0.433213
0.1919 --- loss: 1.632943, loss_ss: 1.194542, loss_d: 0.438401
0.2303 --- loss: 1.777180, loss_ss: 1.089001, loss_d: 0.688179
0.2687 --- loss: 1.807590, loss_ss: 1.071955, loss_d: 0.735636
0.3071 --- loss: 1.642915, loss_ss: 1.304778, loss_d: 0.338136
0.3455 --- loss: 1.521556, loss_ss: 1.077384, loss_d: 0.444172
0.3839 --- loss: 1.611199, loss_ss: 1.169297, loss_d: 0.441902
0.4223 --- loss: 1.740169, loss_ss: 1.205099, loss_d: 0.535071
0.4607 --- loss: 1.566880, loss_ss: 1.224236, loss_d: 0.342645
0.4990 --- loss: 1.419374, loss_ss: 1.028071, loss_d: 0.391304
0.5374 --- loss: 1.816561, loss_ss: 1.460868, loss_d: 0.355692
0.5758 --- loss: 1.572746, loss_ss: 1.097186, loss_d: 0.475560
0.6142 --- loss: 1.517178, loss_ss: 1.089355, loss_d: 0.427823
0.6526 --- loss: 1.864069, loss_ss: 1.212683, loss_d: 0.651386
0.6910 --- loss: 1.607725, loss_ss: 1.210899, loss_d: 0.396826
0.7294 --- loss: 1.724819, loss_ss: 1.350347, loss_d: 0.374472
0.7678 --- loss: 1.746639, loss_ss: 1.106523, loss_d: 0.640116
0.8061 --- loss: 1.599168, loss_ss: 1.079920, loss_d: 0.519248
0.8445 --- loss: 1.824160, loss_ss: 1.291802, loss_d: 0.532358
0.8829 --- loss: 1.557195, loss_ss: 1.088166, loss_d: 0.469029
0.9213 --- loss: 1.784578, loss_ss: 1.328566, loss_d: 0.456012
0.9597 --- loss: 1.515119, loss_ss: 1.079939, loss_d: 0.435180
0.9981 --- loss: 1.453273, loss_ss: 1.148480, loss_d: 0.304793
Epoch finished! Loss: 1.6401793466164516
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.599271, loss_ss: 1.250129, loss_d: 0.349142
0.0384 --- loss: 1.667710, loss_ss: 1.274837, loss_d: 0.392873
0.0768 --- loss: 1.683697, loss_ss: 1.210203, loss_d: 0.473494
0.1152 --- loss: 1.379725, loss_ss: 0.935140, loss_d: 0.444585
0.1536 --- loss: 1.597714, loss_ss: 1.240268, loss_d: 0.357447
0.1919 --- loss: 1.379130, loss_ss: 0.851195, loss_d: 0.527935
0.2303 --- loss: 1.548702, loss_ss: 1.159160, loss_d: 0.389542
0.2687 --- loss: 1.731692, loss_ss: 1.240434, loss_d: 0.491257
0.3071 --- loss: 1.293807, loss_ss: 0.968643, loss_d: 0.325165
0.3455 --- loss: 1.572396, loss_ss: 1.110660, loss_d: 0.461736
0.3839 --- loss: 1.308134, loss_ss: 0.931909, loss_d: 0.376225
0.4223 --- loss: 1.938737, loss_ss: 1.496052, loss_d: 0.442685
0.4607 --- loss: 1.691338, loss_ss: 1.112159, loss_d: 0.579179
0.4990 --- loss: 2.058153, loss_ss: 0.967929, loss_d: 1.090224
0.5374 --- loss: 1.250409, loss_ss: 0.870673, loss_d: 0.379737
0.5758 --- loss: 1.713309, loss_ss: 1.112572, loss_d: 0.600737
0.6142 --- loss: 1.530889, loss_ss: 1.094991, loss_d: 0.435898
0.6526 --- loss: 1.275796, loss_ss: 0.820728, loss_d: 0.455069
0.6910 --- loss: 1.392083, loss_ss: 1.045953, loss_d: 0.346130
0.7294 --- loss: 1.345983, loss_ss: 0.845605, loss_d: 0.500377
0.7678 --- loss: 1.319514, loss_ss: 0.916959, loss_d: 0.402555
0.8061 --- loss: 1.741083, loss_ss: 1.468369, loss_d: 0.272715
0.8445 --- loss: 1.411221, loss_ss: 0.884825, loss_d: 0.526396
0.8829 --- loss: 1.791488, loss_ss: 1.178647, loss_d: 0.612841
0.9213 --- loss: 1.606632, loss_ss: 1.083304, loss_d: 0.523327
0.9597 --- loss: 1.355893, loss_ss: 0.957340, loss_d: 0.398552
0.9981 --- loss: 1.524253, loss_ss: 1.243798, loss_d: 0.280455
Epoch finished! Loss: 1.6105424179480625
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.505396, loss_ss: 1.088919, loss_d: 0.416478
0.0384 --- loss: 1.487846, loss_ss: 1.037658, loss_d: 0.450187
0.0768 --- loss: 1.425767, loss_ss: 1.037416, loss_d: 0.388350
0.1152 --- loss: 1.582428, loss_ss: 1.175089, loss_d: 0.407340
0.1536 --- loss: 1.487132, loss_ss: 1.190768, loss_d: 0.296364
0.1919 --- loss: 1.253288, loss_ss: 0.841512, loss_d: 0.411776
0.2303 --- loss: 1.493941, loss_ss: 1.109004, loss_d: 0.384938
0.2687 --- loss: 1.700299, loss_ss: 1.279885, loss_d: 0.420414
0.3071 --- loss: 1.606930, loss_ss: 1.153523, loss_d: 0.453407
0.3455 --- loss: 2.045769, loss_ss: 1.417137, loss_d: 0.628632
0.3839 --- loss: 1.552556, loss_ss: 1.091105, loss_d: 0.461451
0.4223 --- loss: 1.522025, loss_ss: 1.089408, loss_d: 0.432617
0.4607 --- loss: 1.268069, loss_ss: 0.822477, loss_d: 0.445591
0.4990 --- loss: 1.621832, loss_ss: 1.191511, loss_d: 0.430321
0.5374 --- loss: 1.614817, loss_ss: 1.239693, loss_d: 0.375124
0.5758 --- loss: 1.415727, loss_ss: 1.026315, loss_d: 0.389412
0.6142 --- loss: 1.331697, loss_ss: 0.976227, loss_d: 0.355471
0.6526 --- loss: 1.824465, loss_ss: 1.186663, loss_d: 0.637803
0.6910 --- loss: 1.328045, loss_ss: 0.895708, loss_d: 0.432337
0.7294 --- loss: 1.364305, loss_ss: 1.065426, loss_d: 0.298879
0.7678 --- loss: 1.758337, loss_ss: 1.412344, loss_d: 0.345992
0.8061 --- loss: 2.267026, loss_ss: 1.895088, loss_d: 0.371938
0.8445 --- loss: 1.803091, loss_ss: 1.204738, loss_d: 0.598354
0.8829 --- loss: 1.449556, loss_ss: 0.964821, loss_d: 0.484735
0.9213 --- loss: 1.267269, loss_ss: 0.940780, loss_d: 0.326489
0.9597 --- loss: 1.539998, loss_ss: 1.166408, loss_d: 0.373590
0.9981 --- loss: 1.841812, loss_ss: 1.246040, loss_d: 0.595772
Epoch finished! Loss: 1.5956700036158928
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.838409, loss_ss: 1.047069, loss_d: 0.791340
0.0384 --- loss: 1.828176, loss_ss: 1.434185, loss_d: 0.393991
0.0768 --- loss: 1.972412, loss_ss: 1.226565, loss_d: 0.745847
0.1152 --- loss: 1.303470, loss_ss: 0.962243, loss_d: 0.341226
0.1536 --- loss: 1.717692, loss_ss: 1.400884, loss_d: 0.316808
0.1919 --- loss: 1.488422, loss_ss: 1.050177, loss_d: 0.438245
0.2303 --- loss: 1.379956, loss_ss: 0.988272, loss_d: 0.391684
0.2687 --- loss: 1.709801, loss_ss: 1.002335, loss_d: 0.707466
0.3071 --- loss: 1.240705, loss_ss: 0.904572, loss_d: 0.336133
0.3455 --- loss: 1.534229, loss_ss: 1.193330, loss_d: 0.340900
0.3839 --- loss: 1.656814, loss_ss: 1.160970, loss_d: 0.495844
0.4223 --- loss: 1.423542, loss_ss: 0.901123, loss_d: 0.522418
0.4607 --- loss: 1.694859, loss_ss: 1.065269, loss_d: 0.629589
0.4990 --- loss: 1.129135, loss_ss: 0.741251, loss_d: 0.387884
0.5374 --- loss: 2.096410, loss_ss: 1.446469, loss_d: 0.649941
0.5758 --- loss: 1.659600, loss_ss: 1.126480, loss_d: 0.533120
0.6142 --- loss: 1.609594, loss_ss: 1.189716, loss_d: 0.419878
0.6526 --- loss: 1.623264, loss_ss: 1.165165, loss_d: 0.458100
0.6910 --- loss: 1.357903, loss_ss: 1.035629, loss_d: 0.322274
0.7294 --- loss: 1.460284, loss_ss: 1.040951, loss_d: 0.419333
0.7678 --- loss: 1.369509, loss_ss: 1.077322, loss_d: 0.292187
0.8061 --- loss: 1.507740, loss_ss: 1.084325, loss_d: 0.423415
0.8445 --- loss: 1.657309, loss_ss: 1.017743, loss_d: 0.639566
0.8829 --- loss: 1.464674, loss_ss: 1.052536, loss_d: 0.412138
0.9213 --- loss: 1.509636, loss_ss: 1.086536, loss_d: 0.423100
0.9597 --- loss: 1.406420, loss_ss: 1.040804, loss_d: 0.365616
0.9981 --- loss: 1.611233, loss_ss: 1.083457, loss_d: 0.527776
Epoch finished! Loss: 1.5658603480229012
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.380133, loss_ss: 0.935856, loss_d: 0.444276
0.0384 --- loss: 1.797973, loss_ss: 1.407722, loss_d: 0.390251
0.0768 --- loss: 2.057000, loss_ss: 0.957932, loss_d: 1.099069
0.1152 --- loss: 1.270838, loss_ss: 0.837471, loss_d: 0.433367
0.1536 --- loss: 1.308607, loss_ss: 0.957783, loss_d: 0.350824
0.1919 --- loss: 1.365013, loss_ss: 1.001787, loss_d: 0.363226
0.2303 --- loss: 1.406202, loss_ss: 1.134016, loss_d: 0.272186
0.2687 --- loss: 1.436856, loss_ss: 1.051352, loss_d: 0.385503
0.3071 --- loss: 1.657656, loss_ss: 1.311567, loss_d: 0.346089
0.3455 --- loss: 1.371735, loss_ss: 1.054117, loss_d: 0.317618
0.3839 --- loss: 1.339065, loss_ss: 1.049159, loss_d: 0.289907
0.4223 --- loss: 1.560573, loss_ss: 1.173237, loss_d: 0.387335
0.4607 --- loss: 1.410327, loss_ss: 1.007221, loss_d: 0.403106
0.4990 --- loss: 1.467139, loss_ss: 0.880730, loss_d: 0.586409
0.5374 --- loss: 1.730403, loss_ss: 1.126337, loss_d: 0.604065
0.5758 --- loss: 1.543408, loss_ss: 1.180067, loss_d: 0.363342
0.6142 --- loss: 1.531574, loss_ss: 1.082886, loss_d: 0.448689
0.6526 --- loss: 1.146569, loss_ss: 0.749230, loss_d: 0.397339
0.6910 --- loss: 1.582871, loss_ss: 1.112363, loss_d: 0.470508
0.7294 --- loss: 1.567415, loss_ss: 1.103632, loss_d: 0.463782
0.7678 --- loss: 1.199151, loss_ss: 0.823010, loss_d: 0.376141
0.8061 --- loss: 1.213968, loss_ss: 0.910389, loss_d: 0.303579
0.8445 --- loss: 1.266006, loss_ss: 0.849724, loss_d: 0.416282
0.8829 --- loss: 1.434319, loss_ss: 1.085854, loss_d: 0.348465
0.9213 --- loss: 2.343153, loss_ss: 1.045116, loss_d: 1.298037
0.9597 --- loss: 1.357204, loss_ss: 1.020981, loss_d: 0.336223
0.9981 --- loss: 2.099770, loss_ss: 1.208824, loss_d: 0.890946
Epoch finished! Loss: 1.5606231620678535
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.517558, loss_ss: 1.089119, loss_d: 0.428439
0.0384 --- loss: 1.591757, loss_ss: 1.146274, loss_d: 0.445483
0.0768 --- loss: 1.366267, loss_ss: 1.003759, loss_d: 0.362508
0.1152 --- loss: 1.369679, loss_ss: 1.043092, loss_d: 0.326587
0.1536 --- loss: 1.822491, loss_ss: 1.369691, loss_d: 0.452799
0.1919 --- loss: 1.342447, loss_ss: 0.959498, loss_d: 0.382949
0.2303 --- loss: 1.302928, loss_ss: 0.938211, loss_d: 0.364717
0.2687 --- loss: 1.365891, loss_ss: 1.027906, loss_d: 0.337985
0.3071 --- loss: 1.553134, loss_ss: 1.271380, loss_d: 0.281754
0.3455 --- loss: 1.340909, loss_ss: 1.059580, loss_d: 0.281329
0.3839 --- loss: 1.538978, loss_ss: 1.201836, loss_d: 0.337142
0.4223 --- loss: 1.699260, loss_ss: 1.069900, loss_d: 0.629360
0.4607 --- loss: 1.432796, loss_ss: 0.915707, loss_d: 0.517088
0.4990 --- loss: 1.704601, loss_ss: 1.064042, loss_d: 0.640559
0.5374 --- loss: 1.886894, loss_ss: 1.346324, loss_d: 0.540570
0.5758 --- loss: 1.370856, loss_ss: 1.035308, loss_d: 0.335547
0.6142 --- loss: 1.594382, loss_ss: 0.978534, loss_d: 0.615848
0.6526 --- loss: 1.937731, loss_ss: 1.229936, loss_d: 0.707795
0.6910 --- loss: 1.730435, loss_ss: 1.393393, loss_d: 0.337042
0.7294 --- loss: 1.391111, loss_ss: 0.839687, loss_d: 0.551424
0.7678 --- loss: 1.381697, loss_ss: 0.935709, loss_d: 0.445988
0.8061 --- loss: 1.353178, loss_ss: 1.032045, loss_d: 0.321132
0.8445 --- loss: 1.870746, loss_ss: 1.270418, loss_d: 0.600328
0.8829 --- loss: 1.352588, loss_ss: 0.948044, loss_d: 0.404543
0.9213 --- loss: 1.490195, loss_ss: 1.158058, loss_d: 0.332136
0.9597 --- loss: 1.632959, loss_ss: 1.042511, loss_d: 0.590448
0.9981 --- loss: 1.544932, loss_ss: 1.174360, loss_d: 0.370572
Epoch finished! Loss: 1.53943996154345
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.592929292929293
             precision    recall  f1-score   support

        0.0       0.79      0.25      0.38       219
        1.0       0.00      0.00      0.00       143
        2.0       0.56      0.75      0.64       221
        3.0       0.99      0.87      0.92       271
        4.0       0.34      0.97      0.51       136

avg / total       0.62      0.59      0.55       990
 


====== chp011-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  81.92  25.11   98.05  78.57     38.06
1  85.56   0.00  100.00   0.00      0.00
2  81.01  74.66   82.83  55.56     63.71
3  96.06  86.72   99.58  98.74     92.34
4  74.04  97.06   70.37  34.29     50.67
Total accuracy: 59.29%
Average sen: 56.71%
Average spec: 90.17%
Macro f1-score: 48.96%
[0.59828937 0.52196205 0.55051154 0.52196205 0.52196205 0.58457869
 0.61715394 0.56887907 0.58000678 0.61034501 0.55917883 0.56364286
 0.52196205 0.52196205 0.60409969 0.60752636 0.60822326 0.61011809
 0.5840534  0.56461871 0.55702668 0.56779456 0.52196205 0.56954497
 0.59650558 0.6038931  0.58909446 0.58120483 0.57916087 0.59134459
 0.5461368  0.52196205 0.54485548]
pred: 0.5694400559772145, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.298729, loss_ss: 1.621111, loss_d: 0.677618
0.0384 --- loss: 2.000924, loss_ss: 1.640663, loss_d: 0.360261
0.0769 --- loss: 2.101756, loss_ss: 1.710177, loss_d: 0.391580
0.1153 --- loss: 2.235171, loss_ss: 1.747473, loss_d: 0.487697
0.1538 --- loss: 2.244879, loss_ss: 1.648031, loss_d: 0.596848
0.1922 --- loss: 2.010448, loss_ss: 1.527000, loss_d: 0.483448
0.2307 --- loss: 2.001184, loss_ss: 1.524775, loss_d: 0.476410
0.2691 --- loss: 2.183492, loss_ss: 1.631095, loss_d: 0.552397
0.3076 --- loss: 2.008124, loss_ss: 1.513881, loss_d: 0.494243
0.3460 --- loss: 1.927055, loss_ss: 1.379721, loss_d: 0.547334
0.3845 --- loss: 2.020968, loss_ss: 1.491050, loss_d: 0.529918
0.4229 --- loss: 2.053859, loss_ss: 1.545746, loss_d: 0.508112
0.4614 --- loss: 2.097385, loss_ss: 1.590625, loss_d: 0.506760
0.4998 --- loss: 2.122670, loss_ss: 1.583854, loss_d: 0.538816
0.5383 --- loss: 2.091324, loss_ss: 1.590102, loss_d: 0.501222
0.5767 --- loss: 2.239069, loss_ss: 1.563836, loss_d: 0.675234
0.6151 --- loss: 1.983569, loss_ss: 1.661234, loss_d: 0.322335
0.6536 --- loss: 1.818562, loss_ss: 1.454072, loss_d: 0.364490
0.6920 --- loss: 2.247784, loss_ss: 1.370763, loss_d: 0.877021
0.7305 --- loss: 1.849109, loss_ss: 1.501831, loss_d: 0.347278
0.7689 --- loss: 1.793827, loss_ss: 1.372284, loss_d: 0.421542
0.8074 --- loss: 2.031653, loss_ss: 1.416775, loss_d: 0.614878
0.8458 --- loss: 1.933846, loss_ss: 1.544017, loss_d: 0.389829
0.8843 --- loss: 1.923041, loss_ss: 1.522231, loss_d: 0.400810
0.9227 --- loss: 1.997286, loss_ss: 1.588238, loss_d: 0.409048
0.9612 --- loss: 1.667912, loss_ss: 1.361329, loss_d: 0.306583
0.9996 --- loss: 1.650832, loss_ss: 1.353244, loss_d: 0.297588
Epoch finished! Loss: 2.0934510721610144
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.011875, loss_ss: 1.483679, loss_d: 0.528197
0.0384 --- loss: 1.917225, loss_ss: 1.510135, loss_d: 0.407090
0.0769 --- loss: 2.228878, loss_ss: 1.373510, loss_d: 0.855368
0.1153 --- loss: 1.828467, loss_ss: 1.469554, loss_d: 0.358913
0.1538 --- loss: 1.953726, loss_ss: 1.543182, loss_d: 0.410544
0.1922 --- loss: 2.083802, loss_ss: 1.451256, loss_d: 0.632546
0.2307 --- loss: 1.796456, loss_ss: 1.421468, loss_d: 0.374988
0.2691 --- loss: 2.193844, loss_ss: 1.360555, loss_d: 0.833288
0.3076 --- loss: 2.126436, loss_ss: 1.332045, loss_d: 0.794390
0.3460 --- loss: 2.015757, loss_ss: 1.508171, loss_d: 0.507586
0.3845 --- loss: 1.930207, loss_ss: 1.423213, loss_d: 0.506993
0.4229 --- loss: 1.671050, loss_ss: 1.163622, loss_d: 0.507427
0.4614 --- loss: 1.934017, loss_ss: 1.604252, loss_d: 0.329765
0.4998 --- loss: 1.698293, loss_ss: 1.362105, loss_d: 0.336188
0.5383 --- loss: 2.194483, loss_ss: 1.373687, loss_d: 0.820796
0.5767 --- loss: 1.876629, loss_ss: 1.370485, loss_d: 0.506144
0.6151 --- loss: 1.537703, loss_ss: 1.155347, loss_d: 0.382356
0.6536 --- loss: 2.293464, loss_ss: 1.454295, loss_d: 0.839169
0.6920 --- loss: 1.906072, loss_ss: 1.257210, loss_d: 0.648862
0.7305 --- loss: 1.908573, loss_ss: 1.309063, loss_d: 0.599510
0.7689 --- loss: 1.510626, loss_ss: 1.166429, loss_d: 0.344198
0.8074 --- loss: 1.947863, loss_ss: 1.386057, loss_d: 0.561807
0.8458 --- loss: 1.942901, loss_ss: 1.410825, loss_d: 0.532076
0.8843 --- loss: 1.820069, loss_ss: 1.314137, loss_d: 0.505931
0.9227 --- loss: 1.797559, loss_ss: 1.314103, loss_d: 0.483456
0.9612 --- loss: 1.618005, loss_ss: 1.265179, loss_d: 0.352826
0.9996 --- loss: 3.378478, loss_ss: 1.188301, loss_d: 2.190177
Epoch finished! Loss: 1.9186110290197225
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.842844, loss_ss: 1.337405, loss_d: 0.505439
0.0384 --- loss: 2.242051, loss_ss: 1.533155, loss_d: 0.708896
0.0769 --- loss: 1.676092, loss_ss: 1.325499, loss_d: 0.350593
0.1153 --- loss: 2.064188, loss_ss: 1.340800, loss_d: 0.723387
0.1538 --- loss: 1.508986, loss_ss: 1.084026, loss_d: 0.424960
0.1922 --- loss: 2.001055, loss_ss: 1.233982, loss_d: 0.767074
0.2307 --- loss: 1.950655, loss_ss: 1.496857, loss_d: 0.453798
0.2691 --- loss: 1.630958, loss_ss: 1.141018, loss_d: 0.489940
0.3076 --- loss: 1.577602, loss_ss: 1.175602, loss_d: 0.402000
0.3460 --- loss: 1.744140, loss_ss: 1.411422, loss_d: 0.332718
0.3845 --- loss: 1.900259, loss_ss: 1.224036, loss_d: 0.676223
0.4229 --- loss: 1.535771, loss_ss: 1.167454, loss_d: 0.368317
0.4614 --- loss: 1.687460, loss_ss: 1.272081, loss_d: 0.415379
0.4998 --- loss: 1.796656, loss_ss: 1.313443, loss_d: 0.483213
0.5383 --- loss: 2.428574, loss_ss: 1.190493, loss_d: 1.238081
0.5767 --- loss: 1.651956, loss_ss: 1.316524, loss_d: 0.335432
0.6151 --- loss: 1.462835, loss_ss: 1.131385, loss_d: 0.331450
0.6536 --- loss: 2.165246, loss_ss: 1.109287, loss_d: 1.055959
0.6920 --- loss: 1.564634, loss_ss: 1.168543, loss_d: 0.396091
0.7305 --- loss: 1.606206, loss_ss: 1.115158, loss_d: 0.491049
0.7689 --- loss: 1.615313, loss_ss: 1.201850, loss_d: 0.413463
0.8074 --- loss: 1.553977, loss_ss: 1.067413, loss_d: 0.486564
0.8458 --- loss: 1.893723, loss_ss: 1.137364, loss_d: 0.756360
0.8843 --- loss: 1.768122, loss_ss: 1.162757, loss_d: 0.605365
0.9227 --- loss: 1.579890, loss_ss: 1.231783, loss_d: 0.348107
0.9612 --- loss: 2.186620, loss_ss: 1.301663, loss_d: 0.884957
0.9996 --- loss: 1.577566, loss_ss: 1.299163, loss_d: 0.278402
Epoch finished! Loss: 1.7663389989962945
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.677488, loss_ss: 1.267231, loss_d: 0.410258
0.0384 --- loss: 1.284266, loss_ss: 1.021269, loss_d: 0.262997
0.0769 --- loss: 1.634475, loss_ss: 1.250782, loss_d: 0.383693
0.1153 --- loss: 1.535549, loss_ss: 1.113424, loss_d: 0.422125
0.1538 --- loss: 1.858338, loss_ss: 1.334858, loss_d: 0.523480
0.1922 --- loss: 1.562588, loss_ss: 0.987310, loss_d: 0.575278
0.2307 --- loss: 1.649314, loss_ss: 1.162926, loss_d: 0.486388
0.2691 --- loss: 1.402568, loss_ss: 0.954851, loss_d: 0.447717
0.3076 --- loss: 1.574910, loss_ss: 1.114233, loss_d: 0.460677
0.3460 --- loss: 2.067265, loss_ss: 1.168440, loss_d: 0.898825
0.3845 --- loss: 1.494008, loss_ss: 1.158717, loss_d: 0.335291
0.4229 --- loss: 1.553730, loss_ss: 1.182173, loss_d: 0.371558
0.4614 --- loss: 1.785091, loss_ss: 1.309021, loss_d: 0.476071
0.4998 --- loss: 1.582799, loss_ss: 0.973011, loss_d: 0.609788
0.5383 --- loss: 1.825121, loss_ss: 1.384897, loss_d: 0.440224
0.5767 --- loss: 1.553047, loss_ss: 1.170825, loss_d: 0.382222
0.6151 --- loss: 1.608530, loss_ss: 1.303022, loss_d: 0.305508
0.6536 --- loss: 1.602602, loss_ss: 1.187604, loss_d: 0.414997
0.6920 --- loss: 1.668079, loss_ss: 1.250781, loss_d: 0.417299
0.7305 --- loss: 1.623699, loss_ss: 1.028797, loss_d: 0.594902
0.7689 --- loss: 1.615048, loss_ss: 1.231565, loss_d: 0.383483
0.8074 --- loss: 1.704234, loss_ss: 1.253128, loss_d: 0.451106
0.8458 --- loss: 1.572819, loss_ss: 0.973218, loss_d: 0.599601
0.8843 --- loss: 1.748729, loss_ss: 1.321974, loss_d: 0.426755
0.9227 --- loss: 1.560052, loss_ss: 1.164364, loss_d: 0.395687
0.9612 --- loss: 1.690551, loss_ss: 1.224256, loss_d: 0.466295
0.9996 --- loss: 2.252395, loss_ss: 1.905491, loss_d: 0.346904
Epoch finished! Loss: 1.6802301874527565
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.719304, loss_ss: 1.221481, loss_d: 0.497823
0.0384 --- loss: 2.179688, loss_ss: 1.293222, loss_d: 0.886466
0.0769 --- loss: 1.512349, loss_ss: 1.077896, loss_d: 0.434452
0.1153 --- loss: 1.965620, loss_ss: 1.149604, loss_d: 0.816016
0.1538 --- loss: 1.745012, loss_ss: 1.374827, loss_d: 0.370185
0.1922 --- loss: 1.674656, loss_ss: 1.106562, loss_d: 0.568094
0.2307 --- loss: 1.468675, loss_ss: 1.030030, loss_d: 0.438646
0.2691 --- loss: 1.438300, loss_ss: 1.029729, loss_d: 0.408571
0.3076 --- loss: 1.911025, loss_ss: 1.358556, loss_d: 0.552469
0.3460 --- loss: 1.410793, loss_ss: 1.042090, loss_d: 0.368703
0.3845 --- loss: 1.432140, loss_ss: 1.093071, loss_d: 0.339069
0.4229 --- loss: 1.683458, loss_ss: 1.023844, loss_d: 0.659614
0.4614 --- loss: 1.672292, loss_ss: 1.318652, loss_d: 0.353640
0.4998 --- loss: 2.102431, loss_ss: 1.425757, loss_d: 0.676674
0.5383 --- loss: 1.675650, loss_ss: 1.047303, loss_d: 0.628347
0.5767 --- loss: 1.681545, loss_ss: 1.051726, loss_d: 0.629819
0.6151 --- loss: 1.796473, loss_ss: 1.288174, loss_d: 0.508299
0.6536 --- loss: 1.608601, loss_ss: 1.050910, loss_d: 0.557691
0.6920 --- loss: 1.585219, loss_ss: 1.164036, loss_d: 0.421183
0.7305 --- loss: 1.532399, loss_ss: 1.092602, loss_d: 0.439797
0.7689 --- loss: 1.532371, loss_ss: 1.052400, loss_d: 0.479971
0.8074 --- loss: 1.411212, loss_ss: 0.971397, loss_d: 0.439815
0.8458 --- loss: 1.420475, loss_ss: 0.889335, loss_d: 0.531140
0.8843 --- loss: 1.671209, loss_ss: 1.221456, loss_d: 0.449753
0.9227 --- loss: 1.654420, loss_ss: 1.236887, loss_d: 0.417533
0.9612 --- loss: 1.395576, loss_ss: 0.792421, loss_d: 0.603154
0.9996 --- loss: 1.343965, loss_ss: 1.095523, loss_d: 0.248441
Epoch finished! Loss: 1.6407966673374177
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.717746, loss_ss: 1.275860, loss_d: 0.441886
0.0384 --- loss: 1.616349, loss_ss: 1.240856, loss_d: 0.375492
0.0769 --- loss: 1.415522, loss_ss: 1.010941, loss_d: 0.404582
0.1153 --- loss: 1.839243, loss_ss: 0.855665, loss_d: 0.983578
0.1538 --- loss: 2.023835, loss_ss: 1.200831, loss_d: 0.823004
0.1922 --- loss: 1.720480, loss_ss: 1.214917, loss_d: 0.505563
0.2307 --- loss: 1.212221, loss_ss: 0.880781, loss_d: 0.331440
0.2691 --- loss: 1.370456, loss_ss: 0.878128, loss_d: 0.492329
0.3076 --- loss: 2.393331, loss_ss: 1.220651, loss_d: 1.172680
0.3460 --- loss: 1.338535, loss_ss: 0.897705, loss_d: 0.440830
0.3845 --- loss: 1.975654, loss_ss: 1.312715, loss_d: 0.662939
0.4229 --- loss: 1.610954, loss_ss: 1.148117, loss_d: 0.462837
0.4614 --- loss: 1.750381, loss_ss: 1.150529, loss_d: 0.599852
0.4998 --- loss: 1.410462, loss_ss: 1.101760, loss_d: 0.308702
0.5383 --- loss: 1.344398, loss_ss: 0.904593, loss_d: 0.439805
0.5767 --- loss: 1.260958, loss_ss: 1.008984, loss_d: 0.251974
0.6151 --- loss: 2.289511, loss_ss: 1.321330, loss_d: 0.968181
0.6536 --- loss: 2.236247, loss_ss: 0.993876, loss_d: 1.242371
0.6920 --- loss: 1.393133, loss_ss: 1.005945, loss_d: 0.387188
0.7305 --- loss: 1.433326, loss_ss: 1.057760, loss_d: 0.375566
0.7689 --- loss: 1.576427, loss_ss: 1.014208, loss_d: 0.562219
0.8074 --- loss: 1.564108, loss_ss: 1.130097, loss_d: 0.434010
0.8458 --- loss: 1.391064, loss_ss: 1.018428, loss_d: 0.372636
0.8843 --- loss: 1.452396, loss_ss: 1.115172, loss_d: 0.337224
0.9227 --- loss: 1.222273, loss_ss: 0.840327, loss_d: 0.381945
0.9612 --- loss: 1.519399, loss_ss: 1.164893, loss_d: 0.354506
0.9996 --- loss: 2.718688, loss_ss: 0.933624, loss_d: 1.785064
Epoch finished! Loss: 1.5951327878695267
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.214568, loss_ss: 0.933657, loss_d: 0.280911
0.0384 --- loss: 1.522283, loss_ss: 1.162319, loss_d: 0.359964
0.0769 --- loss: 1.514925, loss_ss: 0.879089, loss_d: 0.635836
0.1153 --- loss: 1.805292, loss_ss: 1.292596, loss_d: 0.512696
0.1538 --- loss: 1.464563, loss_ss: 1.031481, loss_d: 0.433081
0.1922 --- loss: 1.197322, loss_ss: 0.830818, loss_d: 0.366504
0.2307 --- loss: 1.770570, loss_ss: 1.254248, loss_d: 0.516322
0.2691 --- loss: 1.939820, loss_ss: 1.487908, loss_d: 0.451911
0.3076 --- loss: 1.686413, loss_ss: 1.302423, loss_d: 0.383991
0.3460 --- loss: 1.241829, loss_ss: 0.852552, loss_d: 0.389277
0.3845 --- loss: 1.480494, loss_ss: 1.132696, loss_d: 0.347798
0.4229 --- loss: 1.492620, loss_ss: 1.164935, loss_d: 0.327684
0.4614 --- loss: 1.594223, loss_ss: 1.043479, loss_d: 0.550744
0.4998 --- loss: 1.716575, loss_ss: 1.111167, loss_d: 0.605408
0.5383 --- loss: 1.621320, loss_ss: 0.966243, loss_d: 0.655077
0.5767 --- loss: 1.495855, loss_ss: 0.972163, loss_d: 0.523692
0.6151 --- loss: 1.516000, loss_ss: 1.131747, loss_d: 0.384253
0.6536 --- loss: 1.444741, loss_ss: 1.110023, loss_d: 0.334718
0.6920 --- loss: 1.329454, loss_ss: 0.960705, loss_d: 0.368749
0.7305 --- loss: 1.952576, loss_ss: 1.282854, loss_d: 0.669721
0.7689 --- loss: 1.468290, loss_ss: 1.059935, loss_d: 0.408355
0.8074 --- loss: 1.430207, loss_ss: 1.060518, loss_d: 0.369690
0.8458 --- loss: 1.445652, loss_ss: 1.109550, loss_d: 0.336102
0.8843 --- loss: 1.362944, loss_ss: 1.015665, loss_d: 0.347279
0.9227 --- loss: 1.288485, loss_ss: 0.929798, loss_d: 0.358687
0.9612 --- loss: 2.095819, loss_ss: 1.004014, loss_d: 1.091805
0.9996 --- loss: 2.361402, loss_ss: 2.023629, loss_d: 0.337773
Epoch finished! Loss: 1.5971474564992465
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.536302, loss_ss: 1.022440, loss_d: 0.513861
0.0384 --- loss: 1.499830, loss_ss: 1.128713, loss_d: 0.371117
0.0769 --- loss: 1.465301, loss_ss: 1.179710, loss_d: 0.285591
0.1153 --- loss: 1.507186, loss_ss: 1.125455, loss_d: 0.381732
0.1538 --- loss: 1.231917, loss_ss: 0.912174, loss_d: 0.319743
0.1922 --- loss: 1.751878, loss_ss: 1.417993, loss_d: 0.333884
0.2307 --- loss: 1.428534, loss_ss: 1.104448, loss_d: 0.324086
0.2691 --- loss: 1.367206, loss_ss: 0.706854, loss_d: 0.660352
0.3076 --- loss: 1.261451, loss_ss: 1.005339, loss_d: 0.256112
0.3460 --- loss: 1.680667, loss_ss: 1.351874, loss_d: 0.328794
0.3845 --- loss: 1.386708, loss_ss: 1.075537, loss_d: 0.311171
0.4229 --- loss: 1.535118, loss_ss: 1.245777, loss_d: 0.289341
0.4614 --- loss: 1.374042, loss_ss: 0.998542, loss_d: 0.375500
0.4998 --- loss: 1.692503, loss_ss: 0.898257, loss_d: 0.794246
0.5383 --- loss: 1.781994, loss_ss: 1.236103, loss_d: 0.545891
0.5767 --- loss: 1.441565, loss_ss: 1.150298, loss_d: 0.291267
0.6151 --- loss: 1.529300, loss_ss: 1.052537, loss_d: 0.476763
0.6536 --- loss: 1.260321, loss_ss: 0.961317, loss_d: 0.299003
0.6920 --- loss: 1.922525, loss_ss: 1.521096, loss_d: 0.401429
0.7305 --- loss: 1.468810, loss_ss: 1.106651, loss_d: 0.362159
0.7689 --- loss: 1.937546, loss_ss: 1.522940, loss_d: 0.414605
0.8074 --- loss: 1.234085, loss_ss: 0.907896, loss_d: 0.326189
0.8458 --- loss: 1.494605, loss_ss: 1.150722, loss_d: 0.343883
0.8843 --- loss: 2.074450, loss_ss: 1.021357, loss_d: 1.053094
0.9227 --- loss: 1.346492, loss_ss: 1.081867, loss_d: 0.264626
0.9612 --- loss: 1.972946, loss_ss: 1.082355, loss_d: 0.890590
0.9996 --- loss: 1.409891, loss_ss: 1.189404, loss_d: 0.220486
Epoch finished! Loss: 1.5389608951715323
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.806886, loss_ss: 1.367063, loss_d: 0.439823
0.0384 --- loss: 1.400478, loss_ss: 1.003184, loss_d: 0.397294
0.0769 --- loss: 1.893846, loss_ss: 1.307696, loss_d: 0.586150
0.1153 --- loss: 1.238800, loss_ss: 1.037173, loss_d: 0.201627
0.1538 --- loss: 1.295339, loss_ss: 0.930161, loss_d: 0.365178
0.1922 --- loss: 1.368021, loss_ss: 1.005414, loss_d: 0.362607
0.2307 --- loss: 1.606987, loss_ss: 1.328356, loss_d: 0.278631
0.2691 --- loss: 2.156458, loss_ss: 1.101421, loss_d: 1.055037
0.3076 --- loss: 1.219546, loss_ss: 0.896615, loss_d: 0.322931
0.3460 --- loss: 1.604905, loss_ss: 1.339024, loss_d: 0.265880
0.3845 --- loss: 1.616004, loss_ss: 1.242492, loss_d: 0.373512
0.4229 --- loss: 1.733244, loss_ss: 1.327191, loss_d: 0.406054
0.4614 --- loss: 1.335657, loss_ss: 1.052679, loss_d: 0.282977
0.4998 --- loss: 2.005936, loss_ss: 0.994978, loss_d: 1.010958
0.5383 --- loss: 1.736616, loss_ss: 0.935959, loss_d: 0.800657
0.5767 --- loss: 1.341714, loss_ss: 0.925206, loss_d: 0.416508
0.6151 --- loss: 1.341206, loss_ss: 0.959091, loss_d: 0.382115
0.6536 --- loss: 1.244506, loss_ss: 0.816288, loss_d: 0.428218
0.6920 --- loss: 1.244240, loss_ss: 0.844674, loss_d: 0.399566
0.7305 --- loss: 1.392806, loss_ss: 0.822769, loss_d: 0.570037
0.7689 --- loss: 1.539331, loss_ss: 1.000162, loss_d: 0.539169
0.8074 --- loss: 1.091406, loss_ss: 0.779793, loss_d: 0.311612
0.8458 --- loss: 1.429485, loss_ss: 1.028783, loss_d: 0.400702
0.8843 --- loss: 1.918143, loss_ss: 0.982866, loss_d: 0.935277
0.9227 --- loss: 1.811182, loss_ss: 1.030809, loss_d: 0.780373
0.9612 --- loss: 1.384347, loss_ss: 1.013156, loss_d: 0.371191
0.9996 --- loss: 2.112732, loss_ss: 1.958431, loss_d: 0.154301
Epoch finished! Loss: 1.5124991957957927
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.338840, loss_ss: 0.954343, loss_d: 0.384497
0.0384 --- loss: 1.915987, loss_ss: 1.116459, loss_d: 0.799528
0.0769 --- loss: 1.347448, loss_ss: 0.904657, loss_d: 0.442792
0.1153 --- loss: 1.634596, loss_ss: 1.285501, loss_d: 0.349095
0.1538 --- loss: 1.516157, loss_ss: 1.084580, loss_d: 0.431577
0.1922 --- loss: 1.417842, loss_ss: 0.962996, loss_d: 0.454847
0.2307 --- loss: 1.471247, loss_ss: 1.185612, loss_d: 0.285635
0.2691 --- loss: 1.252528, loss_ss: 0.939764, loss_d: 0.312764
0.3076 --- loss: 1.313487, loss_ss: 0.883559, loss_d: 0.429928
0.3460 --- loss: 1.557028, loss_ss: 0.935560, loss_d: 0.621468
0.3845 --- loss: 1.478432, loss_ss: 0.993660, loss_d: 0.484772
0.4229 --- loss: 1.888814, loss_ss: 0.950592, loss_d: 0.938222
0.4614 --- loss: 1.354683, loss_ss: 1.049968, loss_d: 0.304715
0.4998 --- loss: 1.462464, loss_ss: 1.124349, loss_d: 0.338115
0.5383 --- loss: 1.284010, loss_ss: 0.954098, loss_d: 0.329912
0.5767 --- loss: 1.327139, loss_ss: 0.923383, loss_d: 0.403756
0.6151 --- loss: 1.567092, loss_ss: 1.051549, loss_d: 0.515543
0.6536 --- loss: 1.203506, loss_ss: 0.725652, loss_d: 0.477855
0.6920 --- loss: 1.633542, loss_ss: 1.060213, loss_d: 0.573329
0.7305 --- loss: 1.266678, loss_ss: 1.039485, loss_d: 0.227194
0.7689 --- loss: 1.654106, loss_ss: 1.215743, loss_d: 0.438363
0.8074 --- loss: 1.474639, loss_ss: 0.812880, loss_d: 0.661759
0.8458 --- loss: 1.175747, loss_ss: 0.917598, loss_d: 0.258149
0.8843 --- loss: 1.307514, loss_ss: 0.790117, loss_d: 0.517397
0.9227 --- loss: 1.430601, loss_ss: 0.963768, loss_d: 0.466833
0.9612 --- loss: 1.254186, loss_ss: 0.953420, loss_d: 0.300766
0.9996 --- loss: 1.283775, loss_ss: 1.210250, loss_d: 0.073524
Epoch finished! Loss: 1.486768176463934
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7072072072072072
             precision    recall  f1-score   support

        0.0       0.27      0.48      0.34        23
        1.0       0.00      0.00      0.00       182
        2.0       0.71      0.86      0.78       379
        3.0       0.97      0.76      0.85       203
        4.0       0.65      0.91      0.76       323

avg / total       0.61      0.71      0.65      1110
 


====== chp012-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  96.22  47.83   97.24  26.83     34.38
1  83.60   0.00  100.00   0.00      0.00
2  83.15  86.28   81.53  70.78     77.76
3  95.14  75.86   99.45  96.86     85.08
4  83.33  90.71   80.30  65.40     76.01
Total accuracy: 70.72%
Average sen: 60.14%
Average spec: 91.71%
Macro f1-score: 54.65%
[0.99998319 0.99998224 0.99997652 0.99998367 0.99995697 0.99989104
 0.99997604 0.99999022 0.99998939 0.99998736 0.99998319 0.99999058
 0.9999851  0.99998844 0.9999882  0.99997735 0.99999046 0.99998796
 0.99998128 0.99999034 0.99998403 0.99998152 0.99998057 0.99998128
 0.9999913  0.9999876  0.9999758  0.99998224 0.99997294 0.99999499
 0.99997556 0.99997377 0.99998784 0.9999938  0.99998105 0.99997759
 0.99998474]
pred: 0.9999807074263289, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.410395, loss_ss: 1.710634, loss_d: 0.699762
0.0384 --- loss: 2.062981, loss_ss: 1.555730, loss_d: 0.507250
0.0768 --- loss: 2.264646, loss_ss: 1.756076, loss_d: 0.508570
0.1152 --- loss: 2.355704, loss_ss: 1.724511, loss_d: 0.631193
0.1536 --- loss: 2.287644, loss_ss: 1.712346, loss_d: 0.575299
0.1919 --- loss: 2.241028, loss_ss: 1.741863, loss_d: 0.499165
0.2303 --- loss: 2.089251, loss_ss: 1.668541, loss_d: 0.420710
0.2687 --- loss: 2.314359, loss_ss: 1.699020, loss_d: 0.615340
0.3071 --- loss: 2.193064, loss_ss: 1.690317, loss_d: 0.502747
0.3455 --- loss: 2.302386, loss_ss: 1.692021, loss_d: 0.610365
0.3839 --- loss: 2.119491, loss_ss: 1.639959, loss_d: 0.479532
0.4223 --- loss: 1.906085, loss_ss: 1.596271, loss_d: 0.309813
0.4607 --- loss: 2.255623, loss_ss: 1.589905, loss_d: 0.665718
0.4990 --- loss: 1.952629, loss_ss: 1.548246, loss_d: 0.404383
0.5374 --- loss: 2.131018, loss_ss: 1.636493, loss_d: 0.494525
0.5758 --- loss: 1.942011, loss_ss: 1.634249, loss_d: 0.307762
0.6142 --- loss: 2.117452, loss_ss: 1.555929, loss_d: 0.561524
0.6526 --- loss: 2.566270, loss_ss: 1.582985, loss_d: 0.983285
0.6910 --- loss: 2.591471, loss_ss: 1.610815, loss_d: 0.980656
0.7294 --- loss: 2.228777, loss_ss: 1.538153, loss_d: 0.690624
0.7678 --- loss: 2.096089, loss_ss: 1.558934, loss_d: 0.537155
0.8061 --- loss: 1.930593, loss_ss: 1.556314, loss_d: 0.374279
0.8445 --- loss: 2.102718, loss_ss: 1.590997, loss_d: 0.511721
0.8829 --- loss: 2.113989, loss_ss: 1.571547, loss_d: 0.542442
0.9213 --- loss: 1.973586, loss_ss: 1.600075, loss_d: 0.373511
0.9597 --- loss: 1.971669, loss_ss: 1.522120, loss_d: 0.449549
0.9981 --- loss: 1.972921, loss_ss: 1.610776, loss_d: 0.362145
Epoch finished! Loss: 2.1874887654414543
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.841078, loss_ss: 1.588010, loss_d: 0.253068
0.0384 --- loss: 1.956614, loss_ss: 1.495638, loss_d: 0.460976
0.0768 --- loss: 2.701843, loss_ss: 1.469855, loss_d: 1.231988
0.1152 --- loss: 2.044778, loss_ss: 1.480060, loss_d: 0.564718
0.1536 --- loss: 2.065876, loss_ss: 1.565716, loss_d: 0.500161
0.1919 --- loss: 2.083725, loss_ss: 1.535383, loss_d: 0.548342
0.2303 --- loss: 2.116518, loss_ss: 1.448523, loss_d: 0.667995
0.2687 --- loss: 2.153456, loss_ss: 1.570992, loss_d: 0.582464
0.3071 --- loss: 1.923077, loss_ss: 1.410775, loss_d: 0.512302
0.3455 --- loss: 1.858853, loss_ss: 1.411949, loss_d: 0.446904
0.3839 --- loss: 2.426259, loss_ss: 1.476676, loss_d: 0.949582
0.4223 --- loss: 2.119182, loss_ss: 1.543711, loss_d: 0.575472
0.4607 --- loss: 2.276476, loss_ss: 1.333958, loss_d: 0.942518
0.4990 --- loss: 2.009906, loss_ss: 1.469462, loss_d: 0.540444
0.5374 --- loss: 1.871252, loss_ss: 1.423254, loss_d: 0.447997
0.5758 --- loss: 2.248214, loss_ss: 1.650466, loss_d: 0.597748
0.6142 --- loss: 2.683151, loss_ss: 1.564071, loss_d: 1.119080
0.6526 --- loss: 2.061564, loss_ss: 1.608260, loss_d: 0.453304
0.6910 --- loss: 1.806240, loss_ss: 1.351660, loss_d: 0.454580
0.7294 --- loss: 2.012556, loss_ss: 1.484697, loss_d: 0.527859
0.7678 --- loss: 2.043806, loss_ss: 1.493304, loss_d: 0.550501
0.8061 --- loss: 1.946008, loss_ss: 1.532363, loss_d: 0.413645
0.8445 --- loss: 2.038791, loss_ss: 1.585596, loss_d: 0.453195
0.8829 --- loss: 1.978850, loss_ss: 1.493882, loss_d: 0.484968
0.9213 --- loss: 2.068163, loss_ss: 1.605568, loss_d: 0.462595
0.9597 --- loss: 2.060266, loss_ss: 1.547981, loss_d: 0.512285
0.9981 --- loss: 1.565709, loss_ss: 1.192629, loss_d: 0.373080
Epoch finished! Loss: 2.0492473579370056
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.280332, loss_ss: 1.598354, loss_d: 0.681978
0.0384 --- loss: 1.879716, loss_ss: 1.483281, loss_d: 0.396435
0.0768 --- loss: 1.737546, loss_ss: 1.427081, loss_d: 0.310465
0.1152 --- loss: 1.963744, loss_ss: 1.390639, loss_d: 0.573105
0.1536 --- loss: 2.272871, loss_ss: 1.666912, loss_d: 0.605959
0.1919 --- loss: 1.984096, loss_ss: 1.543816, loss_d: 0.440280
0.2303 --- loss: 2.146817, loss_ss: 1.654397, loss_d: 0.492419
0.2687 --- loss: 1.859663, loss_ss: 1.402066, loss_d: 0.457597
0.3071 --- loss: 1.841550, loss_ss: 1.425845, loss_d: 0.415705
0.3455 --- loss: 1.731733, loss_ss: 1.406340, loss_d: 0.325394
0.3839 --- loss: 2.404734, loss_ss: 1.724927, loss_d: 0.679807
0.4223 --- loss: 2.400130, loss_ss: 1.607830, loss_d: 0.792300
0.4607 --- loss: 1.818678, loss_ss: 1.426841, loss_d: 0.391836
0.4990 --- loss: 1.708182, loss_ss: 1.342276, loss_d: 0.365906
0.5374 --- loss: 1.819120, loss_ss: 1.487443, loss_d: 0.331676
0.5758 --- loss: 1.833787, loss_ss: 1.557470, loss_d: 0.276317
0.6142 --- loss: 1.857978, loss_ss: 1.366157, loss_d: 0.491820
0.6526 --- loss: 1.976445, loss_ss: 1.556114, loss_d: 0.420331
0.6910 --- loss: 1.935920, loss_ss: 1.527245, loss_d: 0.408674
0.7294 --- loss: 1.719676, loss_ss: 1.354228, loss_d: 0.365448
0.7678 --- loss: 1.961279, loss_ss: 1.344864, loss_d: 0.616416
0.8061 --- loss: 1.754310, loss_ss: 1.404787, loss_d: 0.349524
0.8445 --- loss: 1.862234, loss_ss: 1.473625, loss_d: 0.388609
0.8829 --- loss: 1.789897, loss_ss: 1.429756, loss_d: 0.360141
0.9213 --- loss: 1.989138, loss_ss: 1.301242, loss_d: 0.687897
0.9597 --- loss: 1.863151, loss_ss: 1.442554, loss_d: 0.420597
0.9981 --- loss: 1.786699, loss_ss: 1.477550, loss_d: 0.309150
Epoch finished! Loss: 1.9733852771612315
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.755329, loss_ss: 1.450117, loss_d: 0.305211
0.0384 --- loss: 1.952817, loss_ss: 1.528358, loss_d: 0.424459
0.0768 --- loss: 1.794662, loss_ss: 1.501134, loss_d: 0.293528
0.1152 --- loss: 1.933197, loss_ss: 1.496243, loss_d: 0.436954
0.1536 --- loss: 1.862206, loss_ss: 1.193312, loss_d: 0.668894
0.1919 --- loss: 1.849472, loss_ss: 1.532038, loss_d: 0.317433
0.2303 --- loss: 2.327016, loss_ss: 1.216080, loss_d: 1.110936
0.2687 --- loss: 1.771688, loss_ss: 1.436014, loss_d: 0.335673
0.3071 --- loss: 1.722229, loss_ss: 1.374450, loss_d: 0.347778
0.3455 --- loss: 1.600311, loss_ss: 1.196741, loss_d: 0.403569
0.3839 --- loss: 1.981632, loss_ss: 1.499599, loss_d: 0.482033
0.4223 --- loss: 2.000695, loss_ss: 1.553104, loss_d: 0.447591
0.4607 --- loss: 2.038125, loss_ss: 1.661905, loss_d: 0.376220
0.4990 --- loss: 1.911996, loss_ss: 1.507675, loss_d: 0.404321
0.5374 --- loss: 1.661946, loss_ss: 1.208172, loss_d: 0.453774
0.5758 --- loss: 1.690822, loss_ss: 1.347728, loss_d: 0.343094
0.6142 --- loss: 1.742043, loss_ss: 1.377841, loss_d: 0.364203
0.6526 --- loss: 1.824762, loss_ss: 1.353705, loss_d: 0.471058
0.6910 --- loss: 2.278648, loss_ss: 1.630669, loss_d: 0.647979
0.7294 --- loss: 1.814850, loss_ss: 1.449419, loss_d: 0.365431
0.7678 --- loss: 1.766866, loss_ss: 1.415646, loss_d: 0.351220
0.8061 --- loss: 1.804551, loss_ss: 1.387028, loss_d: 0.417522
0.8445 --- loss: 1.752073, loss_ss: 1.299741, loss_d: 0.452332
0.8829 --- loss: 1.734755, loss_ss: 1.443944, loss_d: 0.290811
0.9213 --- loss: 1.761992, loss_ss: 1.327688, loss_d: 0.434304
0.9597 --- loss: 2.089558, loss_ss: 1.357891, loss_d: 0.731667
0.9981 --- loss: 1.718437, loss_ss: 1.376085, loss_d: 0.342352
Epoch finished! Loss: 1.936384321634586
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.058120, loss_ss: 1.514536, loss_d: 0.543584
0.0384 --- loss: 2.281266, loss_ss: 1.793288, loss_d: 0.487978
0.0768 --- loss: 1.927207, loss_ss: 1.407275, loss_d: 0.519933
0.1152 --- loss: 2.256671, loss_ss: 1.504132, loss_d: 0.752539
0.1536 --- loss: 1.878361, loss_ss: 1.487773, loss_d: 0.390588
0.1919 --- loss: 1.788249, loss_ss: 1.419527, loss_d: 0.368722
0.2303 --- loss: 1.699774, loss_ss: 1.409679, loss_d: 0.290095
0.2687 --- loss: 1.721467, loss_ss: 1.445016, loss_d: 0.276451
0.3071 --- loss: 2.013592, loss_ss: 1.442702, loss_d: 0.570890
0.3455 --- loss: 1.945632, loss_ss: 1.552158, loss_d: 0.393474
0.3839 --- loss: 2.156076, loss_ss: 1.522614, loss_d: 0.633462
0.4223 --- loss: 2.167883, loss_ss: 1.293076, loss_d: 0.874808
0.4607 --- loss: 1.831216, loss_ss: 1.395833, loss_d: 0.435383
0.4990 --- loss: 1.562522, loss_ss: 1.258757, loss_d: 0.303764
0.5374 --- loss: 1.633974, loss_ss: 1.173157, loss_d: 0.460817
0.5758 --- loss: 1.871086, loss_ss: 1.406350, loss_d: 0.464736
0.6142 --- loss: 2.058505, loss_ss: 1.602636, loss_d: 0.455869
0.6526 --- loss: 1.772903, loss_ss: 1.494669, loss_d: 0.278234
0.6910 --- loss: 2.064666, loss_ss: 1.506886, loss_d: 0.557779
0.7294 --- loss: 1.551484, loss_ss: 1.136536, loss_d: 0.414948
0.7678 --- loss: 1.911444, loss_ss: 1.497838, loss_d: 0.413606
0.8061 --- loss: 1.877058, loss_ss: 1.525592, loss_d: 0.351466
0.8445 --- loss: 1.510813, loss_ss: 1.221718, loss_d: 0.289095
0.8829 --- loss: 1.729313, loss_ss: 1.356827, loss_d: 0.372486
0.9213 --- loss: 2.024777, loss_ss: 1.547758, loss_d: 0.477019
0.9597 --- loss: 1.848992, loss_ss: 1.456412, loss_d: 0.392580
0.9981 --- loss: 1.724919, loss_ss: 1.115042, loss_d: 0.609877
Epoch finished! Loss: 1.9070975147760831
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.630510, loss_ss: 1.276193, loss_d: 0.354317
0.0384 --- loss: 1.768053, loss_ss: 1.460415, loss_d: 0.307638
0.0768 --- loss: 1.811026, loss_ss: 1.318175, loss_d: 0.492851
0.1152 --- loss: 1.732925, loss_ss: 1.425546, loss_d: 0.307379
0.1536 --- loss: 1.664198, loss_ss: 1.366150, loss_d: 0.298047
0.1919 --- loss: 1.587232, loss_ss: 1.093636, loss_d: 0.493596
0.2303 --- loss: 1.991112, loss_ss: 1.593427, loss_d: 0.397685
0.2687 --- loss: 1.539168, loss_ss: 1.140755, loss_d: 0.398413
0.3071 --- loss: 1.784628, loss_ss: 1.488057, loss_d: 0.296571
0.3455 --- loss: 1.833071, loss_ss: 1.451126, loss_d: 0.381944
0.3839 --- loss: 1.834223, loss_ss: 1.508017, loss_d: 0.326206
0.4223 --- loss: 2.091495, loss_ss: 1.459365, loss_d: 0.632130
0.4607 --- loss: 1.997492, loss_ss: 1.323667, loss_d: 0.673825
0.4990 --- loss: 1.736492, loss_ss: 1.307295, loss_d: 0.429197
0.5374 --- loss: 1.558274, loss_ss: 1.249701, loss_d: 0.308573
0.5758 --- loss: 2.009251, loss_ss: 1.482450, loss_d: 0.526802
0.6142 --- loss: 1.774906, loss_ss: 1.399216, loss_d: 0.375690
0.6526 --- loss: 1.593022, loss_ss: 1.298143, loss_d: 0.294879
0.6910 --- loss: 1.614578, loss_ss: 1.231921, loss_d: 0.382657
0.7294 --- loss: 1.608686, loss_ss: 1.311560, loss_d: 0.297126
0.7678 --- loss: 1.912452, loss_ss: 1.336856, loss_d: 0.575596
0.8061 --- loss: 1.550199, loss_ss: 1.227019, loss_d: 0.323180
0.8445 --- loss: 1.501249, loss_ss: 1.096259, loss_d: 0.404990
0.8829 --- loss: 1.891386, loss_ss: 1.496323, loss_d: 0.395062
0.9213 --- loss: 1.430298, loss_ss: 1.122915, loss_d: 0.307383
0.9597 --- loss: 1.894257, loss_ss: 1.361585, loss_d: 0.532671
0.9981 --- loss: 1.660129, loss_ss: 1.374666, loss_d: 0.285464
Epoch finished! Loss: 1.814045403095392
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.137688, loss_ss: 1.456654, loss_d: 0.681033
0.0384 --- loss: 1.853009, loss_ss: 1.398810, loss_d: 0.454199
0.0768 --- loss: 2.006547, loss_ss: 1.163337, loss_d: 0.843210
0.1152 --- loss: 1.542775, loss_ss: 1.168343, loss_d: 0.374432
0.1536 --- loss: 1.500326, loss_ss: 1.203311, loss_d: 0.297015
0.1919 --- loss: 2.463871, loss_ss: 1.296112, loss_d: 1.167759
0.2303 --- loss: 1.565897, loss_ss: 1.247031, loss_d: 0.318866
0.2687 --- loss: 1.989408, loss_ss: 1.604590, loss_d: 0.384818
0.3071 --- loss: 1.882034, loss_ss: 1.346183, loss_d: 0.535851
0.3455 --- loss: 1.495607, loss_ss: 1.180844, loss_d: 0.314763
0.3839 --- loss: 1.646389, loss_ss: 1.241860, loss_d: 0.404529
0.4223 --- loss: 1.563011, loss_ss: 1.132926, loss_d: 0.430086
0.4607 --- loss: 1.541678, loss_ss: 1.124652, loss_d: 0.417026
0.4990 --- loss: 1.819933, loss_ss: 1.457980, loss_d: 0.361953
0.5374 --- loss: 1.588242, loss_ss: 1.195117, loss_d: 0.393126
0.5758 --- loss: 1.920641, loss_ss: 1.569587, loss_d: 0.351054
0.6142 --- loss: 2.417544, loss_ss: 1.126988, loss_d: 1.290557
0.6526 --- loss: 1.748713, loss_ss: 1.214683, loss_d: 0.534030
0.6910 --- loss: 1.971071, loss_ss: 1.247208, loss_d: 0.723863
0.7294 --- loss: 2.419656, loss_ss: 1.793496, loss_d: 0.626160
0.7678 --- loss: 1.605083, loss_ss: 1.240404, loss_d: 0.364679
0.8061 --- loss: 1.894537, loss_ss: 1.512866, loss_d: 0.381671
0.8445 --- loss: 1.690345, loss_ss: 1.136365, loss_d: 0.553980
0.8829 --- loss: 1.436835, loss_ss: 1.093671, loss_d: 0.343164
0.9213 --- loss: 1.667291, loss_ss: 1.340600, loss_d: 0.326691
0.9597 --- loss: 1.643944, loss_ss: 1.109949, loss_d: 0.533996
0.9981 --- loss: 2.307672, loss_ss: 0.896969, loss_d: 1.410703
Epoch finished! Loss: 1.699877242400096
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.505219, loss_ss: 1.211088, loss_d: 0.294131
0.0384 --- loss: 1.670705, loss_ss: 1.164391, loss_d: 0.506314
0.0768 --- loss: 1.469477, loss_ss: 1.022977, loss_d: 0.446500
0.1152 --- loss: 1.464651, loss_ss: 1.151557, loss_d: 0.313093
0.1536 --- loss: 1.345126, loss_ss: 1.038881, loss_d: 0.306245
0.1919 --- loss: 1.454413, loss_ss: 1.167990, loss_d: 0.286423
0.2303 --- loss: 2.512175, loss_ss: 1.385454, loss_d: 1.126720
0.2687 --- loss: 1.795809, loss_ss: 1.195776, loss_d: 0.600034
0.3071 --- loss: 1.729614, loss_ss: 1.324103, loss_d: 0.405511
0.3455 --- loss: 1.508325, loss_ss: 1.100073, loss_d: 0.408253
0.3839 --- loss: 1.774556, loss_ss: 1.340502, loss_d: 0.434054
0.4223 --- loss: 1.487993, loss_ss: 1.186597, loss_d: 0.301397
0.4607 --- loss: 1.726877, loss_ss: 1.302331, loss_d: 0.424546
0.4990 --- loss: 1.717698, loss_ss: 1.347543, loss_d: 0.370155
0.5374 --- loss: 2.273466, loss_ss: 1.164514, loss_d: 1.108952
0.5758 --- loss: 1.713854, loss_ss: 1.196532, loss_d: 0.517323
0.6142 --- loss: 1.506015, loss_ss: 1.002658, loss_d: 0.503357
0.6526 --- loss: 1.671234, loss_ss: 1.137838, loss_d: 0.533395
0.6910 --- loss: 1.232568, loss_ss: 0.968523, loss_d: 0.264045
0.7294 --- loss: 2.113436, loss_ss: 1.056409, loss_d: 1.057027
0.7678 --- loss: 1.293558, loss_ss: 0.891882, loss_d: 0.401676
0.8061 --- loss: 1.557333, loss_ss: 1.294846, loss_d: 0.262487
0.8445 --- loss: 1.455878, loss_ss: 1.207831, loss_d: 0.248047
0.8829 --- loss: 1.723337, loss_ss: 1.074117, loss_d: 0.649220
0.9213 --- loss: 1.670082, loss_ss: 1.037629, loss_d: 0.632453
0.9597 --- loss: 1.765697, loss_ss: 1.449487, loss_d: 0.316210
0.9981 --- loss: 2.818889, loss_ss: 1.638468, loss_d: 1.180421
Epoch finished! Loss: 1.6116335144409766
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.396013, loss_ss: 1.129011, loss_d: 0.267003
0.0384 --- loss: 1.705600, loss_ss: 1.170540, loss_d: 0.535060
0.0768 --- loss: 1.402593, loss_ss: 0.961604, loss_d: 0.440989
0.1152 --- loss: 1.587962, loss_ss: 1.220554, loss_d: 0.367408
0.1536 --- loss: 1.721893, loss_ss: 1.154681, loss_d: 0.567212
0.1919 --- loss: 1.949501, loss_ss: 1.377857, loss_d: 0.571644
0.2303 --- loss: 1.755808, loss_ss: 1.381928, loss_d: 0.373881
0.2687 --- loss: 1.322095, loss_ss: 0.922269, loss_d: 0.399825
0.3071 --- loss: 2.010088, loss_ss: 1.656832, loss_d: 0.353256
0.3455 --- loss: 1.241507, loss_ss: 0.967439, loss_d: 0.274068
0.3839 --- loss: 1.549780, loss_ss: 1.036414, loss_d: 0.513366
0.4223 --- loss: 2.653775, loss_ss: 1.145726, loss_d: 1.508049
0.4607 --- loss: 1.457835, loss_ss: 1.197303, loss_d: 0.260532
0.4990 --- loss: 1.589447, loss_ss: 1.302171, loss_d: 0.287277
0.5374 --- loss: 1.664955, loss_ss: 1.264061, loss_d: 0.400894
0.5758 --- loss: 1.872179, loss_ss: 1.428057, loss_d: 0.444122
0.6142 --- loss: 1.675401, loss_ss: 1.309256, loss_d: 0.366145
0.6526 --- loss: 1.527247, loss_ss: 1.131798, loss_d: 0.395450
0.6910 --- loss: 1.570234, loss_ss: 1.054172, loss_d: 0.516062
0.7294 --- loss: 1.573920, loss_ss: 1.141221, loss_d: 0.432698
0.7678 --- loss: 1.612531, loss_ss: 1.017051, loss_d: 0.595481
0.8061 --- loss: 1.291890, loss_ss: 0.905222, loss_d: 0.386668
0.8445 --- loss: 1.386028, loss_ss: 1.094788, loss_d: 0.291240
0.8829 --- loss: 1.357503, loss_ss: 1.124541, loss_d: 0.232962
0.9213 --- loss: 1.355875, loss_ss: 0.957834, loss_d: 0.398041
0.9597 --- loss: 1.612989, loss_ss: 1.130188, loss_d: 0.482800
0.9981 --- loss: 2.767194, loss_ss: 1.901162, loss_d: 0.866032
Epoch finished! Loss: 1.587818253498811
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.512600, loss_ss: 1.101934, loss_d: 0.410666
0.0384 --- loss: 1.715311, loss_ss: 1.298448, loss_d: 0.416863
0.0768 --- loss: 1.940622, loss_ss: 1.123098, loss_d: 0.817524
0.1152 --- loss: 1.474519, loss_ss: 1.227497, loss_d: 0.247023
0.1536 --- loss: 1.708833, loss_ss: 1.273926, loss_d: 0.434908
0.1919 --- loss: 1.331578, loss_ss: 0.849442, loss_d: 0.482136
0.2303 --- loss: 1.377998, loss_ss: 1.045483, loss_d: 0.332514
0.2687 --- loss: 2.327001, loss_ss: 1.099790, loss_d: 1.227211
0.3071 --- loss: 1.651203, loss_ss: 1.072370, loss_d: 0.578833
0.3455 --- loss: 1.302721, loss_ss: 0.988269, loss_d: 0.314452
0.3839 --- loss: 1.041771, loss_ss: 0.813813, loss_d: 0.227957
0.4223 --- loss: 1.346023, loss_ss: 1.044561, loss_d: 0.301462
0.4607 --- loss: 1.981734, loss_ss: 1.279738, loss_d: 0.701996
0.4990 --- loss: 1.346050, loss_ss: 1.040057, loss_d: 0.305993
0.5374 --- loss: 1.480560, loss_ss: 1.185161, loss_d: 0.295399
0.5758 --- loss: 1.600351, loss_ss: 1.155840, loss_d: 0.444511
0.6142 --- loss: 2.197692, loss_ss: 1.029024, loss_d: 1.168669
0.6526 --- loss: 1.213706, loss_ss: 0.898993, loss_d: 0.314713
0.6910 --- loss: 1.711213, loss_ss: 1.262628, loss_d: 0.448585
0.7294 --- loss: 1.244772, loss_ss: 0.932138, loss_d: 0.312634
0.7678 --- loss: 1.340962, loss_ss: 0.990302, loss_d: 0.350660
0.8061 --- loss: 1.422581, loss_ss: 1.049826, loss_d: 0.372755
0.8445 --- loss: 1.094890, loss_ss: 0.912126, loss_d: 0.182764
0.8829 --- loss: 1.200871, loss_ss: 1.024842, loss_d: 0.176029
0.9213 --- loss: 1.760070, loss_ss: 0.977054, loss_d: 0.783016
0.9597 --- loss: 1.650458, loss_ss: 1.334059, loss_d: 0.316399
0.9981 --- loss: 1.260000, loss_ss: 1.015373, loss_d: 0.244627
Epoch finished! Loss: 1.525491813512949
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.2686868686868687
             precision    recall  f1-score   support

        0.0       0.13      0.70      0.22        33
        1.0       0.00      0.00      0.00       142
        2.0       0.40      0.03      0.05       433
        3.0       0.91      0.39      0.54       189
        4.0       0.23      0.82      0.35       193

avg / total       0.40      0.27      0.20       990
 


====== chp013-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  83.13  69.70   83.59  12.78     21.60
1  85.66   0.00  100.00   0.00      0.00
2  55.66   2.77   96.77  40.00      5.18
3  87.58  38.62   99.13  91.25     54.28
4  41.72  81.87   31.99  22.57     35.39
Total accuracy: 26.87%
Average sen: 38.59%
Average spec: 82.30%
Macro f1-score: 23.29%
[0.26024741 0.22548096 0.19295551 0.27685443 0.60981083 0.58591807
 0.39945334 0.42397714 0.56922621 0.57127988 0.60044056 0.60693026
 0.65188915 0.5092023  0.59648997 0.57806545 0.57249337 0.59350264
 0.54813087 0.57884514 0.59482592 0.51783878 0.58942795 0.50128442
 0.56303924 0.58551985 0.57537544 0.63861734 0.63130414 0.51218271
 0.53109831 0.5770483  0.59630764]
pred: 0.5262140460086592, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.377788, loss_ss: 1.636035, loss_d: 0.741752
0.0384 --- loss: 1.972099, loss_ss: 1.464787, loss_d: 0.507312
0.0768 --- loss: 2.335425, loss_ss: 1.530121, loss_d: 0.805304
0.1152 --- loss: 1.941080, loss_ss: 1.440603, loss_d: 0.500477
0.1536 --- loss: 2.232020, loss_ss: 1.638409, loss_d: 0.593611
0.1919 --- loss: 2.081671, loss_ss: 1.508741, loss_d: 0.572930
0.2303 --- loss: 2.046854, loss_ss: 1.681752, loss_d: 0.365102
0.2687 --- loss: 1.841891, loss_ss: 1.438461, loss_d: 0.403430
0.3071 --- loss: 1.953717, loss_ss: 1.536711, loss_d: 0.417006
0.3455 --- loss: 2.503678, loss_ss: 1.511749, loss_d: 0.991929
0.3839 --- loss: 2.700272, loss_ss: 1.501275, loss_d: 1.198997
0.4223 --- loss: 2.316967, loss_ss: 1.488721, loss_d: 0.828247
0.4607 --- loss: 2.026047, loss_ss: 1.524358, loss_d: 0.501689
0.4990 --- loss: 1.926856, loss_ss: 1.513992, loss_d: 0.412864
0.5374 --- loss: 2.034035, loss_ss: 1.479246, loss_d: 0.554790
0.5758 --- loss: 2.025309, loss_ss: 1.530757, loss_d: 0.494552
0.6142 --- loss: 1.904004, loss_ss: 1.482734, loss_d: 0.421270
0.6526 --- loss: 2.048133, loss_ss: 1.541208, loss_d: 0.506925
0.6910 --- loss: 1.946997, loss_ss: 1.478007, loss_d: 0.468990
0.7294 --- loss: 2.592323, loss_ss: 1.505981, loss_d: 1.086342
0.7678 --- loss: 2.019325, loss_ss: 1.407712, loss_d: 0.611613
0.8061 --- loss: 2.179972, loss_ss: 1.623832, loss_d: 0.556140
0.8445 --- loss: 2.078252, loss_ss: 1.532767, loss_d: 0.545485
0.8829 --- loss: 1.844322, loss_ss: 1.395623, loss_d: 0.448699
0.9213 --- loss: 2.078757, loss_ss: 1.698996, loss_d: 0.379761
0.9597 --- loss: 1.992982, loss_ss: 1.437668, loss_d: 0.555314
0.9981 --- loss: 2.014630, loss_ss: 1.496879, loss_d: 0.517751
Epoch finished! Loss: 2.1067676104032076
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.905534, loss_ss: 1.469046, loss_d: 0.436488
0.0384 --- loss: 2.036340, loss_ss: 1.637991, loss_d: 0.398349
0.0768 --- loss: 2.017748, loss_ss: 1.490864, loss_d: 0.526884
0.1152 --- loss: 2.319542, loss_ss: 1.863016, loss_d: 0.456525
0.1536 --- loss: 1.808246, loss_ss: 1.509886, loss_d: 0.298360
0.1919 --- loss: 2.176891, loss_ss: 1.474115, loss_d: 0.702776
0.2303 --- loss: 1.960945, loss_ss: 1.518021, loss_d: 0.442923
0.2687 --- loss: 2.147875, loss_ss: 1.560482, loss_d: 0.587393
0.3071 --- loss: 2.136337, loss_ss: 1.591151, loss_d: 0.545186
0.3455 --- loss: 1.890212, loss_ss: 1.361173, loss_d: 0.529039
0.3839 --- loss: 2.253876, loss_ss: 1.599273, loss_d: 0.654603
0.4223 --- loss: 2.083067, loss_ss: 1.524750, loss_d: 0.558317
0.4607 --- loss: 1.925814, loss_ss: 1.422967, loss_d: 0.502847
0.4990 --- loss: 2.047859, loss_ss: 1.646667, loss_d: 0.401193
0.5374 --- loss: 1.981831, loss_ss: 1.324495, loss_d: 0.657336
0.5758 --- loss: 1.980785, loss_ss: 1.534136, loss_d: 0.446649
0.6142 --- loss: 1.928728, loss_ss: 1.524048, loss_d: 0.404680
0.6526 --- loss: 1.907427, loss_ss: 1.529018, loss_d: 0.378409
0.6910 --- loss: 2.019874, loss_ss: 1.673319, loss_d: 0.346556
0.7294 --- loss: 1.930502, loss_ss: 1.544557, loss_d: 0.385945
0.7678 --- loss: 2.511021, loss_ss: 1.712646, loss_d: 0.798375
0.8061 --- loss: 1.969457, loss_ss: 1.518685, loss_d: 0.450772
0.8445 --- loss: 1.889013, loss_ss: 1.485987, loss_d: 0.403026
0.8829 --- loss: 1.852262, loss_ss: 1.528541, loss_d: 0.323720
0.9213 --- loss: 1.995312, loss_ss: 1.480173, loss_d: 0.515139
0.9597 --- loss: 2.504502, loss_ss: 1.650895, loss_d: 0.853608
0.9981 --- loss: 1.922918, loss_ss: 1.571877, loss_d: 0.351041
Epoch finished! Loss: 2.023125460973153
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.113969, loss_ss: 1.376717, loss_d: 0.737252
0.0384 --- loss: 1.928959, loss_ss: 1.413971, loss_d: 0.514988
0.0768 --- loss: 2.201471, loss_ss: 1.711962, loss_d: 0.489509
0.1152 --- loss: 2.044290, loss_ss: 1.541222, loss_d: 0.503068
0.1536 --- loss: 1.868364, loss_ss: 1.419583, loss_d: 0.448781
0.1919 --- loss: 2.691047, loss_ss: 1.555560, loss_d: 1.135487
0.2303 --- loss: 1.928604, loss_ss: 1.558605, loss_d: 0.369999
0.2687 --- loss: 1.865011, loss_ss: 1.541185, loss_d: 0.323827
0.3071 --- loss: 1.686731, loss_ss: 1.368789, loss_d: 0.317942
0.3455 --- loss: 1.838256, loss_ss: 1.304452, loss_d: 0.533804
0.3839 --- loss: 2.168635, loss_ss: 1.424073, loss_d: 0.744562
0.4223 --- loss: 2.020552, loss_ss: 1.516596, loss_d: 0.503956
0.4607 --- loss: 2.104144, loss_ss: 1.569123, loss_d: 0.535020
0.4990 --- loss: 1.947540, loss_ss: 1.497889, loss_d: 0.449651
0.5374 --- loss: 1.923118, loss_ss: 1.472203, loss_d: 0.450915
0.5758 --- loss: 2.236174, loss_ss: 1.553983, loss_d: 0.682191
0.6142 --- loss: 2.588475, loss_ss: 1.485254, loss_d: 1.103221
0.6526 --- loss: 1.926962, loss_ss: 1.493447, loss_d: 0.433515
0.6910 --- loss: 1.655318, loss_ss: 1.376876, loss_d: 0.278442
0.7294 --- loss: 1.927225, loss_ss: 1.524693, loss_d: 0.402532
0.7678 --- loss: 1.871035, loss_ss: 1.410395, loss_d: 0.460640
0.8061 --- loss: 2.093934, loss_ss: 1.607045, loss_d: 0.486889
0.8445 --- loss: 2.032120, loss_ss: 1.521471, loss_d: 0.510649
0.8829 --- loss: 1.976131, loss_ss: 1.590329, loss_d: 0.385802
0.9213 --- loss: 1.886901, loss_ss: 1.451532, loss_d: 0.435369
0.9597 --- loss: 1.940006, loss_ss: 1.516903, loss_d: 0.423103
0.9981 --- loss: 1.916326, loss_ss: 1.558864, loss_d: 0.357461
Epoch finished! Loss: 2.0224798784806177
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.103117, loss_ss: 1.633810, loss_d: 0.469307
0.0384 --- loss: 1.581242, loss_ss: 1.207064, loss_d: 0.374178
0.0768 --- loss: 2.235615, loss_ss: 1.524246, loss_d: 0.711369
0.1152 --- loss: 2.152583, loss_ss: 1.467412, loss_d: 0.685170
0.1536 --- loss: 2.006184, loss_ss: 1.518202, loss_d: 0.487982
0.1919 --- loss: 1.926914, loss_ss: 1.559899, loss_d: 0.367014
0.2303 --- loss: 2.288821, loss_ss: 1.321796, loss_d: 0.967024
0.2687 --- loss: 2.261009, loss_ss: 1.456902, loss_d: 0.804107
0.3071 --- loss: 2.535934, loss_ss: 1.575216, loss_d: 0.960718
0.3455 --- loss: 1.933738, loss_ss: 1.373311, loss_d: 0.560427
0.3839 --- loss: 1.937924, loss_ss: 1.506197, loss_d: 0.431727
0.4223 --- loss: 1.864736, loss_ss: 1.529395, loss_d: 0.335341
0.4607 --- loss: 1.646469, loss_ss: 1.300761, loss_d: 0.345709
0.4990 --- loss: 1.754634, loss_ss: 1.317972, loss_d: 0.436661
0.5374 --- loss: 2.268025, loss_ss: 1.375913, loss_d: 0.892112
0.5758 --- loss: 2.054218, loss_ss: 1.619961, loss_d: 0.434257
0.6142 --- loss: 1.941054, loss_ss: 1.512268, loss_d: 0.428786
0.6526 --- loss: 1.994676, loss_ss: 1.644657, loss_d: 0.350020
0.6910 --- loss: 1.597849, loss_ss: 1.274910, loss_d: 0.322939
0.7294 --- loss: 1.721489, loss_ss: 1.351326, loss_d: 0.370163
0.7678 --- loss: 1.861911, loss_ss: 1.526315, loss_d: 0.335596
0.8061 --- loss: 2.012242, loss_ss: 1.460509, loss_d: 0.551733
0.8445 --- loss: 1.999472, loss_ss: 1.466594, loss_d: 0.532878
0.8829 --- loss: 2.068488, loss_ss: 1.544725, loss_d: 0.523763
0.9213 --- loss: 1.869121, loss_ss: 1.593109, loss_d: 0.276012
0.9597 --- loss: 1.631059, loss_ss: 1.253798, loss_d: 0.377260
0.9981 --- loss: 1.772256, loss_ss: 1.307955, loss_d: 0.464301
Epoch finished! Loss: 1.9616555869579315
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.973494, loss_ss: 1.230145, loss_d: 0.743349
0.0384 --- loss: 2.031269, loss_ss: 1.499581, loss_d: 0.531687
0.0768 --- loss: 1.839725, loss_ss: 1.466252, loss_d: 0.373472
0.1152 --- loss: 1.659593, loss_ss: 1.273782, loss_d: 0.385811
0.1536 --- loss: 1.802618, loss_ss: 1.445346, loss_d: 0.357273
0.1919 --- loss: 1.892099, loss_ss: 1.359763, loss_d: 0.532336
0.2303 --- loss: 2.499948, loss_ss: 1.502666, loss_d: 0.997281
0.2687 --- loss: 1.758850, loss_ss: 1.330138, loss_d: 0.428711
0.3071 --- loss: 2.296666, loss_ss: 1.278729, loss_d: 1.017937
0.3455 --- loss: 2.027622, loss_ss: 1.523157, loss_d: 0.504465
0.3839 --- loss: 2.318956, loss_ss: 1.389330, loss_d: 0.929626
0.4223 --- loss: 1.934323, loss_ss: 1.435112, loss_d: 0.499211
0.4607 --- loss: 2.058837, loss_ss: 1.508515, loss_d: 0.550322
0.4990 --- loss: 1.596292, loss_ss: 1.245491, loss_d: 0.350800
0.5374 --- loss: 1.951290, loss_ss: 1.642370, loss_d: 0.308920
0.5758 --- loss: 1.515773, loss_ss: 1.241325, loss_d: 0.274448
0.6142 --- loss: 1.962164, loss_ss: 1.303861, loss_d: 0.658303
0.6526 --- loss: 1.862240, loss_ss: 1.565259, loss_d: 0.296981
0.6910 --- loss: 1.979396, loss_ss: 1.604096, loss_d: 0.375300
0.7294 --- loss: 1.887876, loss_ss: 1.315851, loss_d: 0.572025
0.7678 --- loss: 1.893292, loss_ss: 1.510666, loss_d: 0.382626
0.8061 --- loss: 1.807019, loss_ss: 1.204872, loss_d: 0.602147
0.8445 --- loss: 1.971344, loss_ss: 1.322165, loss_d: 0.649179
0.8829 --- loss: 1.979127, loss_ss: 1.219825, loss_d: 0.759302
0.9213 --- loss: 2.000582, loss_ss: 1.344271, loss_d: 0.656311
0.9597 --- loss: 1.715835, loss_ss: 1.233826, loss_d: 0.482009
0.9981 --- loss: 2.166869, loss_ss: 1.730760, loss_d: 0.436109
Epoch finished! Loss: 1.908199109022434
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.884560, loss_ss: 1.455539, loss_d: 0.429021
0.0384 --- loss: 2.052909, loss_ss: 1.280123, loss_d: 0.772786
0.0768 --- loss: 1.785268, loss_ss: 1.422000, loss_d: 0.363268
0.1152 --- loss: 1.634613, loss_ss: 1.288533, loss_d: 0.346080
0.1536 --- loss: 1.843730, loss_ss: 1.373803, loss_d: 0.469926
0.1919 --- loss: 1.688803, loss_ss: 1.271082, loss_d: 0.417721
0.2303 --- loss: 1.882904, loss_ss: 1.466115, loss_d: 0.416788
0.2687 --- loss: 1.704495, loss_ss: 1.280441, loss_d: 0.424054
0.3071 --- loss: 2.150948, loss_ss: 1.297458, loss_d: 0.853490
0.3455 --- loss: 1.981490, loss_ss: 1.413606, loss_d: 0.567885
0.3839 --- loss: 1.562201, loss_ss: 1.206227, loss_d: 0.355974
0.4223 --- loss: 1.971682, loss_ss: 1.465969, loss_d: 0.505713
0.4607 --- loss: 1.940932, loss_ss: 1.485518, loss_d: 0.455413
0.4990 --- loss: 1.707047, loss_ss: 1.277295, loss_d: 0.429752
0.5374 --- loss: 1.518140, loss_ss: 1.241432, loss_d: 0.276707
0.5758 --- loss: 1.908982, loss_ss: 1.679254, loss_d: 0.229728
0.6142 --- loss: 1.547588, loss_ss: 1.190674, loss_d: 0.356914
0.6526 --- loss: 1.857182, loss_ss: 1.375558, loss_d: 0.481625
0.6910 --- loss: 1.709420, loss_ss: 1.251726, loss_d: 0.457694
0.7294 --- loss: 1.754707, loss_ss: 1.357992, loss_d: 0.396715
0.7678 --- loss: 1.379727, loss_ss: 1.078656, loss_d: 0.301071
0.8061 --- loss: 2.037986, loss_ss: 1.419550, loss_d: 0.618435
0.8445 --- loss: 1.748368, loss_ss: 1.127604, loss_d: 0.620763
0.8829 --- loss: 1.666310, loss_ss: 1.395259, loss_d: 0.271051
0.9213 --- loss: 1.664292, loss_ss: 1.248867, loss_d: 0.415425
0.9597 --- loss: 1.793146, loss_ss: 1.184268, loss_d: 0.608878
0.9981 --- loss: 2.192961, loss_ss: 1.590241, loss_d: 0.602720
Epoch finished! Loss: 1.8074776264337393
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.607367, loss_ss: 1.161505, loss_d: 0.445862
0.0384 --- loss: 1.565984, loss_ss: 1.045470, loss_d: 0.520514
0.0768 --- loss: 1.566491, loss_ss: 1.149276, loss_d: 0.417214
0.1152 --- loss: 1.473308, loss_ss: 1.175711, loss_d: 0.297597
0.1536 --- loss: 1.721370, loss_ss: 1.285020, loss_d: 0.436350
0.1919 --- loss: 1.509625, loss_ss: 0.907823, loss_d: 0.601802
0.2303 --- loss: 1.651277, loss_ss: 1.211854, loss_d: 0.439422
0.2687 --- loss: 1.588022, loss_ss: 1.222466, loss_d: 0.365555
0.3071 --- loss: 1.856754, loss_ss: 1.284276, loss_d: 0.572478
0.3455 --- loss: 1.841022, loss_ss: 1.393029, loss_d: 0.447993
0.3839 --- loss: 1.566365, loss_ss: 1.261501, loss_d: 0.304863
0.4223 --- loss: 1.755823, loss_ss: 1.134568, loss_d: 0.621255
0.4607 --- loss: 1.814107, loss_ss: 1.395724, loss_d: 0.418383
0.4990 --- loss: 1.600791, loss_ss: 1.262915, loss_d: 0.337876
0.5374 --- loss: 1.896547, loss_ss: 1.403700, loss_d: 0.492847
0.5758 --- loss: 1.914986, loss_ss: 1.332705, loss_d: 0.582280
0.6142 --- loss: 1.393572, loss_ss: 1.030416, loss_d: 0.363156
0.6526 --- loss: 1.823780, loss_ss: 1.098975, loss_d: 0.724806
0.6910 --- loss: 1.476037, loss_ss: 1.113966, loss_d: 0.362071
0.7294 --- loss: 1.666268, loss_ss: 1.334915, loss_d: 0.331353
0.7678 --- loss: 1.477852, loss_ss: 1.296513, loss_d: 0.181340
0.8061 --- loss: 1.833437, loss_ss: 1.210738, loss_d: 0.622699
0.8445 --- loss: 1.598585, loss_ss: 1.248928, loss_d: 0.349658
0.8829 --- loss: 1.467590, loss_ss: 1.014003, loss_d: 0.453586
0.9213 --- loss: 1.500594, loss_ss: 1.174485, loss_d: 0.326109
0.9597 --- loss: 1.910485, loss_ss: 1.054611, loss_d: 0.855874
0.9981 --- loss: 1.911234, loss_ss: 1.411114, loss_d: 0.500119
Epoch finished! Loss: 1.7014023579083957
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.785183, loss_ss: 1.347342, loss_d: 0.437841
0.0384 --- loss: 1.581185, loss_ss: 1.139254, loss_d: 0.441931
0.0768 --- loss: 1.690788, loss_ss: 1.172534, loss_d: 0.518254
0.1152 --- loss: 1.703389, loss_ss: 1.294256, loss_d: 0.409134
0.1536 --- loss: 1.626990, loss_ss: 1.192689, loss_d: 0.434300
0.1919 --- loss: 1.362414, loss_ss: 1.017487, loss_d: 0.344927
0.2303 --- loss: 1.809258, loss_ss: 1.377470, loss_d: 0.431789
0.2687 --- loss: 1.663571, loss_ss: 1.424996, loss_d: 0.238576
0.3071 --- loss: 1.665351, loss_ss: 1.312353, loss_d: 0.352997
0.3455 --- loss: 1.842470, loss_ss: 1.210206, loss_d: 0.632265
0.3839 --- loss: 1.694279, loss_ss: 0.998298, loss_d: 0.695981
0.4223 --- loss: 1.799857, loss_ss: 1.449881, loss_d: 0.349976
0.4607 --- loss: 1.869801, loss_ss: 1.156690, loss_d: 0.713112
0.4990 --- loss: 1.536771, loss_ss: 1.054261, loss_d: 0.482511
0.5374 --- loss: 1.320030, loss_ss: 1.036566, loss_d: 0.283464
0.5758 --- loss: 1.794961, loss_ss: 1.141045, loss_d: 0.653917
0.6142 --- loss: 1.456443, loss_ss: 1.101183, loss_d: 0.355260
0.6526 --- loss: 1.611773, loss_ss: 1.169584, loss_d: 0.442189
0.6910 --- loss: 1.553205, loss_ss: 1.200387, loss_d: 0.352818
0.7294 --- loss: 1.550578, loss_ss: 1.248783, loss_d: 0.301795
0.7678 --- loss: 1.561092, loss_ss: 1.093699, loss_d: 0.467393
0.8061 --- loss: 1.906941, loss_ss: 1.117440, loss_d: 0.789501
0.8445 --- loss: 1.176103, loss_ss: 0.803600, loss_d: 0.372503
0.8829 --- loss: 1.939595, loss_ss: 1.268805, loss_d: 0.670790
0.9213 --- loss: 1.417556, loss_ss: 1.136773, loss_d: 0.280783
0.9597 --- loss: 2.150880, loss_ss: 1.123767, loss_d: 1.027114
0.9981 --- loss: 1.480954, loss_ss: 1.177031, loss_d: 0.303924
Epoch finished! Loss: 1.6206931215066176
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.910695, loss_ss: 1.514294, loss_d: 0.396401
0.0384 --- loss: 1.692215, loss_ss: 1.240062, loss_d: 0.452153
0.0768 --- loss: 1.480588, loss_ss: 1.143837, loss_d: 0.336750
0.1152 --- loss: 1.413553, loss_ss: 0.966366, loss_d: 0.447187
0.1536 --- loss: 1.540717, loss_ss: 1.201658, loss_d: 0.339059
0.1919 --- loss: 1.712711, loss_ss: 1.451831, loss_d: 0.260880
0.2303 --- loss: 1.551933, loss_ss: 1.244786, loss_d: 0.307148
0.2687 --- loss: 1.396118, loss_ss: 1.093872, loss_d: 0.302246
0.3071 --- loss: 1.270728, loss_ss: 0.925969, loss_d: 0.344758
0.3455 --- loss: 1.604266, loss_ss: 1.305611, loss_d: 0.298654
0.3839 --- loss: 1.926855, loss_ss: 1.211917, loss_d: 0.714937
0.4223 --- loss: 1.771244, loss_ss: 1.367117, loss_d: 0.404128
0.4607 --- loss: 1.454492, loss_ss: 1.223886, loss_d: 0.230606
0.4990 --- loss: 1.596656, loss_ss: 1.273691, loss_d: 0.322965
0.5374 --- loss: 1.294009, loss_ss: 0.939719, loss_d: 0.354290
0.5758 --- loss: 1.903871, loss_ss: 1.358038, loss_d: 0.545833
0.6142 --- loss: 1.324941, loss_ss: 0.872896, loss_d: 0.452045
0.6526 --- loss: 1.780677, loss_ss: 1.363131, loss_d: 0.417546
0.6910 --- loss: 1.715509, loss_ss: 1.375318, loss_d: 0.340191
0.7294 --- loss: 1.525790, loss_ss: 1.214530, loss_d: 0.311260
0.7678 --- loss: 2.001689, loss_ss: 1.010590, loss_d: 0.991098
0.8061 --- loss: 1.674630, loss_ss: 1.061755, loss_d: 0.612876
0.8445 --- loss: 1.423168, loss_ss: 0.993289, loss_d: 0.429880
0.8829 --- loss: 1.748566, loss_ss: 1.355548, loss_d: 0.393018
0.9213 --- loss: 1.470223, loss_ss: 1.033714, loss_d: 0.436509
0.9597 --- loss: 1.414689, loss_ss: 1.029764, loss_d: 0.384925
0.9981 --- loss: 1.272981, loss_ss: 1.024536, loss_d: 0.248446
Epoch finished! Loss: 1.5732799048607167
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.234580, loss_ss: 1.070722, loss_d: 1.163858
0.0384 --- loss: 1.531931, loss_ss: 1.126886, loss_d: 0.405045
0.0768 --- loss: 1.554953, loss_ss: 0.993147, loss_d: 0.561806
0.1152 --- loss: 1.411912, loss_ss: 1.028817, loss_d: 0.383095
0.1536 --- loss: 1.567885, loss_ss: 1.138417, loss_d: 0.429468
0.1919 --- loss: 1.412720, loss_ss: 1.054090, loss_d: 0.358629
0.2303 --- loss: 1.296975, loss_ss: 1.036738, loss_d: 0.260237
0.2687 --- loss: 1.544304, loss_ss: 1.147932, loss_d: 0.396372
0.3071 --- loss: 1.733513, loss_ss: 1.131511, loss_d: 0.602002
0.3455 --- loss: 1.547874, loss_ss: 1.161361, loss_d: 0.386514
0.3839 --- loss: 1.492827, loss_ss: 1.168961, loss_d: 0.323866
0.4223 --- loss: 1.442664, loss_ss: 1.045643, loss_d: 0.397021
0.4607 --- loss: 1.995418, loss_ss: 1.242266, loss_d: 0.753152
0.4990 --- loss: 1.675113, loss_ss: 1.162671, loss_d: 0.512442
0.5374 --- loss: 1.550749, loss_ss: 1.033374, loss_d: 0.517375
0.5758 --- loss: 1.486205, loss_ss: 0.965471, loss_d: 0.520734
0.6142 --- loss: 1.275730, loss_ss: 0.938633, loss_d: 0.337097
0.6526 --- loss: 1.179425, loss_ss: 0.910238, loss_d: 0.269187
0.6910 --- loss: 1.371673, loss_ss: 0.955599, loss_d: 0.416074
0.7294 --- loss: 1.386894, loss_ss: 0.997160, loss_d: 0.389734
0.7678 --- loss: 1.310514, loss_ss: 0.963338, loss_d: 0.347176
0.8061 --- loss: 1.455891, loss_ss: 0.964133, loss_d: 0.491758
0.8445 --- loss: 1.161941, loss_ss: 0.813454, loss_d: 0.348487
0.8829 --- loss: 1.864270, loss_ss: 1.540124, loss_d: 0.324146
0.9213 --- loss: 1.813167, loss_ss: 1.427628, loss_d: 0.385539
0.9597 --- loss: 1.545319, loss_ss: 1.073333, loss_d: 0.471986
0.9981 --- loss: 2.140732, loss_ss: 1.164021, loss_d: 0.976711
Epoch finished! Loss: 1.5709284154268413
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7383838383838384
             precision    recall  f1-score   support

        0.0       0.75      0.84      0.79       203
        1.0       0.00      0.00      0.00        68
        2.0       0.83      0.78      0.81       397
        3.0       0.83      0.99      0.90       146
        4.0       0.49      0.60      0.54       176

avg / total       0.70      0.74      0.71       990
 


====== chp014-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  91.01  84.24   92.76  75.00     79.35
1  93.13   0.00  100.00   0.00      0.00
2  84.85  78.09   89.38  83.11     80.52
3  96.87  98.63   96.56  83.24     90.28
4  81.82  60.23   86.49  49.07     54.08
Total accuracy: 73.84%
Average sen: 64.24%
Average spec: 93.04%
Macro f1-score: 60.85%
[0.88994759 0.53413838 0.60052651 0.76734978 0.92261547 0.93292576
 0.94037253 0.98086011 0.55487156 0.5944252  0.89172822 0.52069181
 0.51751202 0.60090649 0.83836281 0.96152747 0.71951073 0.57158041
 0.96793681 0.5172978  0.95535856 0.99073714 0.9928565  0.68210912
 0.51659644 0.61760032 0.6585604  0.86781561 0.87491196 0.51697516
 0.59593558 0.9364146  0.97148961]
pred: 0.7576499545212948, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.582874, loss_ss: 1.894308, loss_d: 0.688565
0.0385 --- loss: 2.409310, loss_ss: 1.772364, loss_d: 0.636946
0.0769 --- loss: 2.523851, loss_ss: 1.967977, loss_d: 0.555875
0.1154 --- loss: 2.351323, loss_ss: 1.686239, loss_d: 0.665084
0.1538 --- loss: 2.150800, loss_ss: 1.762699, loss_d: 0.388101
0.1923 --- loss: 1.960990, loss_ss: 1.574525, loss_d: 0.386465
0.2308 --- loss: 2.004610, loss_ss: 1.706443, loss_d: 0.298166
0.2692 --- loss: 2.498567, loss_ss: 1.809665, loss_d: 0.688902
0.3077 --- loss: 2.280923, loss_ss: 1.640408, loss_d: 0.640516
0.3462 --- loss: 2.296540, loss_ss: 1.719766, loss_d: 0.576774
0.3846 --- loss: 2.498247, loss_ss: 1.864865, loss_d: 0.633382
0.4231 --- loss: 2.914228, loss_ss: 1.800178, loss_d: 1.114050
0.4615 --- loss: 2.364017, loss_ss: 1.753075, loss_d: 0.610941
0.5000 --- loss: 2.451553, loss_ss: 1.620554, loss_d: 0.830999
0.5385 --- loss: 1.986018, loss_ss: 1.633497, loss_d: 0.352521
0.5769 --- loss: 2.442052, loss_ss: 1.570003, loss_d: 0.872049
0.6154 --- loss: 2.074754, loss_ss: 1.537135, loss_d: 0.537619
0.6538 --- loss: 2.406167, loss_ss: 1.570226, loss_d: 0.835941
0.6923 --- loss: 1.974947, loss_ss: 1.534932, loss_d: 0.440015
0.7308 --- loss: 2.212270, loss_ss: 1.649485, loss_d: 0.562785
0.7692 --- loss: 2.191547, loss_ss: 1.670664, loss_d: 0.520882
0.8077 --- loss: 2.194393, loss_ss: 1.609064, loss_d: 0.585330
0.8462 --- loss: 1.962363, loss_ss: 1.536018, loss_d: 0.426345
0.8846 --- loss: 2.160141, loss_ss: 1.586788, loss_d: 0.573352
0.9231 --- loss: 2.022290, loss_ss: 1.551196, loss_d: 0.471094
0.9615 --- loss: 1.888083, loss_ss: 1.345784, loss_d: 0.542299
Epoch finished! Loss: 2.2418154620756052
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.038191, loss_ss: 1.593731, loss_d: 0.444459
0.0385 --- loss: 2.005790, loss_ss: 1.498527, loss_d: 0.507263
0.0769 --- loss: 2.196512, loss_ss: 1.779215, loss_d: 0.417297
0.1154 --- loss: 1.964000, loss_ss: 1.576776, loss_d: 0.387224
0.1538 --- loss: 2.587650, loss_ss: 1.512942, loss_d: 1.074707
0.1923 --- loss: 2.329538, loss_ss: 1.570919, loss_d: 0.758619
0.2308 --- loss: 2.221876, loss_ss: 1.487774, loss_d: 0.734102
0.2692 --- loss: 2.091776, loss_ss: 1.576524, loss_d: 0.515252
0.3077 --- loss: 1.885019, loss_ss: 1.480148, loss_d: 0.404871
0.3462 --- loss: 1.745928, loss_ss: 1.395074, loss_d: 0.350855
0.3846 --- loss: 1.707589, loss_ss: 1.431889, loss_d: 0.275700
0.4231 --- loss: 1.839176, loss_ss: 1.386805, loss_d: 0.452371
0.4615 --- loss: 2.026123, loss_ss: 1.574459, loss_d: 0.451663
0.5000 --- loss: 2.013102, loss_ss: 1.571655, loss_d: 0.441447
0.5385 --- loss: 1.943769, loss_ss: 1.499188, loss_d: 0.444581
0.5769 --- loss: 2.019501, loss_ss: 1.482558, loss_d: 0.536943
0.6154 --- loss: 1.797891, loss_ss: 1.401670, loss_d: 0.396221
0.6538 --- loss: 1.579571, loss_ss: 1.297191, loss_d: 0.282380
0.6923 --- loss: 2.455559, loss_ss: 1.557074, loss_d: 0.898485
0.7308 --- loss: 1.990415, loss_ss: 1.393877, loss_d: 0.596538
0.7692 --- loss: 2.262434, loss_ss: 1.389224, loss_d: 0.873210
0.8077 --- loss: 1.879888, loss_ss: 1.430043, loss_d: 0.449845
0.8462 --- loss: 1.745358, loss_ss: 1.394884, loss_d: 0.350474
0.8846 --- loss: 2.438800, loss_ss: 1.373982, loss_d: 1.064818
0.9231 --- loss: 2.160612, loss_ss: 1.599134, loss_d: 0.561478
0.9615 --- loss: 1.805898, loss_ss: 1.252301, loss_d: 0.553597
Epoch finished! Loss: 2.0201203459478254
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.929993, loss_ss: 1.414923, loss_d: 0.515070
0.0385 --- loss: 2.187001, loss_ss: 1.393556, loss_d: 0.793445
0.0769 --- loss: 2.380061, loss_ss: 1.503479, loss_d: 0.876581
0.1154 --- loss: 2.040591, loss_ss: 1.483051, loss_d: 0.557540
0.1538 --- loss: 2.115130, loss_ss: 1.538496, loss_d: 0.576633
0.1923 --- loss: 1.734056, loss_ss: 1.247202, loss_d: 0.486854
0.2308 --- loss: 1.681080, loss_ss: 1.226908, loss_d: 0.454172
0.2692 --- loss: 1.946925, loss_ss: 1.597847, loss_d: 0.349078
0.3077 --- loss: 1.893523, loss_ss: 1.535457, loss_d: 0.358067
0.3462 --- loss: 2.135953, loss_ss: 1.591112, loss_d: 0.544841
0.3846 --- loss: 1.739138, loss_ss: 1.416584, loss_d: 0.322554
0.4231 --- loss: 2.238665, loss_ss: 1.523476, loss_d: 0.715189
0.4615 --- loss: 1.728449, loss_ss: 1.229584, loss_d: 0.498865
0.5000 --- loss: 2.076653, loss_ss: 1.293144, loss_d: 0.783508
0.5385 --- loss: 1.898223, loss_ss: 1.403632, loss_d: 0.494591
0.5769 --- loss: 2.272121, loss_ss: 1.379027, loss_d: 0.893094
0.6154 --- loss: 2.486625, loss_ss: 1.347429, loss_d: 1.139196
0.6538 --- loss: 1.762922, loss_ss: 1.353507, loss_d: 0.409415
0.6923 --- loss: 1.727896, loss_ss: 1.279167, loss_d: 0.448730
0.7308 --- loss: 1.664856, loss_ss: 1.243936, loss_d: 0.420920
0.7692 --- loss: 1.691151, loss_ss: 1.187627, loss_d: 0.503524
0.8077 --- loss: 1.741530, loss_ss: 1.310654, loss_d: 0.430876
0.8462 --- loss: 1.694426, loss_ss: 1.362291, loss_d: 0.332136
0.8846 --- loss: 1.666194, loss_ss: 1.202338, loss_d: 0.463856
0.9231 --- loss: 1.792534, loss_ss: 1.448286, loss_d: 0.344249
0.9615 --- loss: 1.903537, loss_ss: 1.389296, loss_d: 0.514241
Epoch finished! Loss: 1.913285080990736
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.136801, loss_ss: 1.399067, loss_d: 0.737734
0.0385 --- loss: 1.794316, loss_ss: 1.309284, loss_d: 0.485032
0.0769 --- loss: 1.806752, loss_ss: 1.343227, loss_d: 0.463526
0.1154 --- loss: 1.671675, loss_ss: 1.215358, loss_d: 0.456317
0.1538 --- loss: 1.888317, loss_ss: 1.340488, loss_d: 0.547829
0.1923 --- loss: 1.868926, loss_ss: 1.292009, loss_d: 0.576917
0.2308 --- loss: 2.279436, loss_ss: 1.276711, loss_d: 1.002725
0.2692 --- loss: 1.936475, loss_ss: 1.487375, loss_d: 0.449100
0.3077 --- loss: 1.870725, loss_ss: 1.198131, loss_d: 0.672594
0.3462 --- loss: 1.839044, loss_ss: 1.341016, loss_d: 0.498028
0.3846 --- loss: 1.737700, loss_ss: 1.375605, loss_d: 0.362094
0.4231 --- loss: 1.711763, loss_ss: 1.384135, loss_d: 0.327628
0.4615 --- loss: 1.857785, loss_ss: 1.413838, loss_d: 0.443947
0.5000 --- loss: 1.718478, loss_ss: 1.389557, loss_d: 0.328922
0.5385 --- loss: 1.726186, loss_ss: 1.321932, loss_d: 0.404254
0.5769 --- loss: 2.338523, loss_ss: 1.213886, loss_d: 1.124637
0.6154 --- loss: 1.610095, loss_ss: 1.199503, loss_d: 0.410592
0.6538 --- loss: 1.466915, loss_ss: 1.079400, loss_d: 0.387515
0.6923 --- loss: 1.646257, loss_ss: 1.257139, loss_d: 0.389118
0.7308 --- loss: 1.890124, loss_ss: 1.189673, loss_d: 0.700451
0.7692 --- loss: 1.606774, loss_ss: 1.166707, loss_d: 0.440068
0.8077 --- loss: 1.933346, loss_ss: 1.394183, loss_d: 0.539163
0.8462 --- loss: 1.703928, loss_ss: 1.193604, loss_d: 0.510324
0.8846 --- loss: 1.624388, loss_ss: 1.148635, loss_d: 0.475753
0.9231 --- loss: 1.677727, loss_ss: 1.197618, loss_d: 0.480108
0.9615 --- loss: 1.775772, loss_ss: 1.290791, loss_d: 0.484982
Epoch finished! Loss: 1.775222379728634
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.853018, loss_ss: 1.286759, loss_d: 0.566259
0.0385 --- loss: 1.693317, loss_ss: 1.038729, loss_d: 0.654588
0.0769 --- loss: 1.620112, loss_ss: 1.086493, loss_d: 0.533620
0.1154 --- loss: 1.729406, loss_ss: 1.225516, loss_d: 0.503890
0.1538 --- loss: 1.386977, loss_ss: 1.102781, loss_d: 0.284197
0.1923 --- loss: 1.381523, loss_ss: 1.058250, loss_d: 0.323273
0.2308 --- loss: 1.893053, loss_ss: 1.191378, loss_d: 0.701674
0.2692 --- loss: 1.553594, loss_ss: 1.204229, loss_d: 0.349365
0.3077 --- loss: 1.656234, loss_ss: 1.065866, loss_d: 0.590368
0.3462 --- loss: 1.737552, loss_ss: 1.199234, loss_d: 0.538318
0.3846 --- loss: 1.638535, loss_ss: 1.034203, loss_d: 0.604332
0.4231 --- loss: 1.731913, loss_ss: 1.222172, loss_d: 0.509741
0.4615 --- loss: 1.378411, loss_ss: 1.062359, loss_d: 0.316052
0.5000 --- loss: 1.696242, loss_ss: 1.216330, loss_d: 0.479912
0.5385 --- loss: 1.804867, loss_ss: 1.211813, loss_d: 0.593054
0.5769 --- loss: 1.671536, loss_ss: 1.206308, loss_d: 0.465228
0.6154 --- loss: 1.641323, loss_ss: 0.936331, loss_d: 0.704992
0.6538 --- loss: 1.675521, loss_ss: 1.038931, loss_d: 0.636590
0.6923 --- loss: 1.549031, loss_ss: 1.008979, loss_d: 0.540052
0.7308 --- loss: 1.800926, loss_ss: 1.414080, loss_d: 0.386846
0.7692 --- loss: 1.733499, loss_ss: 1.235142, loss_d: 0.498357
0.8077 --- loss: 1.506409, loss_ss: 1.044595, loss_d: 0.461813
0.8462 --- loss: 1.517076, loss_ss: 1.162590, loss_d: 0.354486
0.8846 --- loss: 1.603411, loss_ss: 1.292899, loss_d: 0.310512
0.9231 --- loss: 1.785730, loss_ss: 1.050346, loss_d: 0.735384
0.9615 --- loss: 2.026990, loss_ss: 1.541232, loss_d: 0.485758
Epoch finished! Loss: 1.6772007076896756
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.708833, loss_ss: 0.997796, loss_d: 0.711037
0.0385 --- loss: 1.749040, loss_ss: 1.350006, loss_d: 0.399034
0.0769 --- loss: 1.566281, loss_ss: 1.191601, loss_d: 0.374681
0.1154 --- loss: 1.843084, loss_ss: 1.445323, loss_d: 0.397761
0.1538 --- loss: 1.635823, loss_ss: 1.104691, loss_d: 0.531132
0.1923 --- loss: 1.645853, loss_ss: 1.264902, loss_d: 0.380951
0.2308 --- loss: 1.916525, loss_ss: 1.467919, loss_d: 0.448606
0.2692 --- loss: 1.307794, loss_ss: 0.961612, loss_d: 0.346181
0.3077 --- loss: 1.659469, loss_ss: 1.116519, loss_d: 0.542950
0.3462 --- loss: 1.654527, loss_ss: 1.152653, loss_d: 0.501874
0.3846 --- loss: 1.335693, loss_ss: 1.020068, loss_d: 0.315625
0.4231 --- loss: 1.695297, loss_ss: 1.403680, loss_d: 0.291618
0.4615 --- loss: 1.841721, loss_ss: 1.262985, loss_d: 0.578735
0.5000 --- loss: 1.549502, loss_ss: 1.233827, loss_d: 0.315675
0.5385 --- loss: 1.663333, loss_ss: 1.125118, loss_d: 0.538215
0.5769 --- loss: 1.443976, loss_ss: 1.000194, loss_d: 0.443782
0.6154 --- loss: 1.474096, loss_ss: 1.024581, loss_d: 0.449514
0.6538 --- loss: 1.630440, loss_ss: 1.141604, loss_d: 0.488835
0.6923 --- loss: 1.591281, loss_ss: 1.051886, loss_d: 0.539395
0.7308 --- loss: 1.348078, loss_ss: 0.905895, loss_d: 0.442182
0.7692 --- loss: 1.743319, loss_ss: 1.058555, loss_d: 0.684764
0.8077 --- loss: 1.572420, loss_ss: 1.234900, loss_d: 0.337520
0.8462 --- loss: 1.676286, loss_ss: 1.259570, loss_d: 0.416717
0.8846 --- loss: 1.571902, loss_ss: 1.236653, loss_d: 0.335249
0.9231 --- loss: 1.791418, loss_ss: 1.193714, loss_d: 0.597703
0.9615 --- loss: 1.765960, loss_ss: 1.141295, loss_d: 0.624665
Epoch finished! Loss: 1.6586979167341727
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.564694, loss_ss: 0.978481, loss_d: 0.586213
0.0385 --- loss: 1.630207, loss_ss: 1.204511, loss_d: 0.425696
0.0769 --- loss: 2.397875, loss_ss: 1.564621, loss_d: 0.833254
0.1154 --- loss: 1.362117, loss_ss: 0.909033, loss_d: 0.453084
0.1538 --- loss: 1.485632, loss_ss: 1.088789, loss_d: 0.396842
0.1923 --- loss: 1.464439, loss_ss: 1.117725, loss_d: 0.346713
0.2308 --- loss: 1.643996, loss_ss: 1.027899, loss_d: 0.616097
0.2692 --- loss: 1.838400, loss_ss: 1.368107, loss_d: 0.470294
0.3077 --- loss: 1.404099, loss_ss: 1.015350, loss_d: 0.388749
0.3462 --- loss: 2.000040, loss_ss: 1.311361, loss_d: 0.688679
0.3846 --- loss: 1.634525, loss_ss: 1.319866, loss_d: 0.314660
0.4231 --- loss: 2.036574, loss_ss: 1.638203, loss_d: 0.398371
0.4615 --- loss: 2.090454, loss_ss: 1.109488, loss_d: 0.980966
0.5000 --- loss: 2.104846, loss_ss: 1.382260, loss_d: 0.722586
0.5385 --- loss: 1.385712, loss_ss: 1.092331, loss_d: 0.293381
0.5769 --- loss: 1.536817, loss_ss: 1.243544, loss_d: 0.293272
0.6154 --- loss: 1.505257, loss_ss: 0.994722, loss_d: 0.510535
0.6538 --- loss: 1.290102, loss_ss: 0.987909, loss_d: 0.302193
0.6923 --- loss: 1.513105, loss_ss: 1.228798, loss_d: 0.284307
0.7308 --- loss: 2.587697, loss_ss: 1.395842, loss_d: 1.191854
0.7692 --- loss: 1.451582, loss_ss: 1.091833, loss_d: 0.359749
0.8077 --- loss: 1.811745, loss_ss: 1.298806, loss_d: 0.512939
0.8462 --- loss: 1.722331, loss_ss: 1.180777, loss_d: 0.541554
0.8846 --- loss: 1.558484, loss_ss: 1.206280, loss_d: 0.352204
0.9231 --- loss: 1.540620, loss_ss: 1.120933, loss_d: 0.419687
0.9615 --- loss: 1.811989, loss_ss: 1.444884, loss_d: 0.367105
Epoch finished! Loss: 1.627960510695763
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.063498, loss_ss: 1.270759, loss_d: 0.792739
0.0385 --- loss: 1.682101, loss_ss: 1.151187, loss_d: 0.530915
0.0769 --- loss: 1.417538, loss_ss: 1.027836, loss_d: 0.389702
0.1154 --- loss: 1.288289, loss_ss: 0.936957, loss_d: 0.351332
0.1538 --- loss: 1.217978, loss_ss: 0.837556, loss_d: 0.380423
0.1923 --- loss: 1.351730, loss_ss: 1.030000, loss_d: 0.321730
0.2308 --- loss: 1.750688, loss_ss: 1.070271, loss_d: 0.680417
0.2692 --- loss: 1.550952, loss_ss: 1.082107, loss_d: 0.468845
0.3077 --- loss: 1.635437, loss_ss: 1.310976, loss_d: 0.324461
0.3462 --- loss: 2.742234, loss_ss: 1.310506, loss_d: 1.431728
0.3846 --- loss: 2.057624, loss_ss: 1.515890, loss_d: 0.541734
0.4231 --- loss: 1.572427, loss_ss: 1.128456, loss_d: 0.443971
0.4615 --- loss: 1.810678, loss_ss: 1.343480, loss_d: 0.467198
0.5000 --- loss: 1.483181, loss_ss: 1.125270, loss_d: 0.357911
0.5385 --- loss: 1.567092, loss_ss: 0.907559, loss_d: 0.659533
0.5769 --- loss: 1.583484, loss_ss: 1.138792, loss_d: 0.444692
0.6154 --- loss: 1.431236, loss_ss: 0.922550, loss_d: 0.508686
0.6538 --- loss: 1.459010, loss_ss: 1.103691, loss_d: 0.355320
0.6923 --- loss: 1.455231, loss_ss: 1.081469, loss_d: 0.373762
0.7308 --- loss: 1.290090, loss_ss: 0.937736, loss_d: 0.352354
0.7692 --- loss: 1.494196, loss_ss: 1.133774, loss_d: 0.360423
0.8077 --- loss: 2.025728, loss_ss: 1.262673, loss_d: 0.763055
0.8462 --- loss: 1.463075, loss_ss: 1.050476, loss_d: 0.412599
0.8846 --- loss: 1.749507, loss_ss: 1.260566, loss_d: 0.488941
0.9231 --- loss: 1.188556, loss_ss: 0.795803, loss_d: 0.392753
0.9615 --- loss: 1.432623, loss_ss: 0.822486, loss_d: 0.610137
Epoch finished! Loss: 1.6009476907464988
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.818417, loss_ss: 1.060224, loss_d: 0.758193
0.0385 --- loss: 1.250731, loss_ss: 0.873395, loss_d: 0.377336
0.0769 --- loss: 1.545216, loss_ss: 1.118727, loss_d: 0.426489
0.1154 --- loss: 1.775121, loss_ss: 0.985810, loss_d: 0.789311
0.1538 --- loss: 1.453404, loss_ss: 0.866028, loss_d: 0.587376
0.1923 --- loss: 1.607916, loss_ss: 1.196951, loss_d: 0.410965
0.2308 --- loss: 1.656432, loss_ss: 0.981896, loss_d: 0.674537
0.2692 --- loss: 1.422962, loss_ss: 1.078476, loss_d: 0.344486
0.3077 --- loss: 1.555368, loss_ss: 1.118161, loss_d: 0.437207
0.3462 --- loss: 1.403944, loss_ss: 1.107389, loss_d: 0.296555
0.3846 --- loss: 1.504247, loss_ss: 1.226744, loss_d: 0.277503
0.4231 --- loss: 1.574807, loss_ss: 1.070234, loss_d: 0.504573
0.4615 --- loss: 1.518824, loss_ss: 1.048518, loss_d: 0.470306
0.5000 --- loss: 1.927155, loss_ss: 1.221042, loss_d: 0.706114
0.5385 --- loss: 1.667245, loss_ss: 0.995610, loss_d: 0.671635
0.5769 --- loss: 1.438230, loss_ss: 1.079336, loss_d: 0.358894
0.6154 --- loss: 2.230916, loss_ss: 1.320337, loss_d: 0.910578
0.6538 --- loss: 1.612860, loss_ss: 1.020397, loss_d: 0.592463
0.6923 --- loss: 1.326555, loss_ss: 0.887752, loss_d: 0.438804
0.7308 --- loss: 1.831556, loss_ss: 1.162977, loss_d: 0.668579
0.7692 --- loss: 1.623152, loss_ss: 1.159019, loss_d: 0.464133
0.8077 --- loss: 1.733062, loss_ss: 1.059417, loss_d: 0.673645
0.8462 --- loss: 1.560434, loss_ss: 1.185734, loss_d: 0.374700
0.8846 --- loss: 1.536130, loss_ss: 1.072388, loss_d: 0.463742
0.9231 --- loss: 1.329625, loss_ss: 0.945153, loss_d: 0.384473
0.9615 --- loss: 1.347180, loss_ss: 0.960519, loss_d: 0.386660
Epoch finished! Loss: 1.5790070069802773
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.178892, loss_ss: 0.841148, loss_d: 0.337744
0.0385 --- loss: 1.174622, loss_ss: 0.841682, loss_d: 0.332939
0.0769 --- loss: 1.276326, loss_ss: 0.982474, loss_d: 0.293851
0.1154 --- loss: 1.453542, loss_ss: 1.146431, loss_d: 0.307112
0.1538 --- loss: 1.367364, loss_ss: 1.051392, loss_d: 0.315972
0.1923 --- loss: 1.857228, loss_ss: 1.237667, loss_d: 0.619561
0.2308 --- loss: 1.455792, loss_ss: 0.997832, loss_d: 0.457959
0.2692 --- loss: 1.541280, loss_ss: 1.166716, loss_d: 0.374564
0.3077 --- loss: 2.165470, loss_ss: 1.534412, loss_d: 0.631058
0.3462 --- loss: 1.346404, loss_ss: 0.803194, loss_d: 0.543210
0.3846 --- loss: 2.299455, loss_ss: 1.343769, loss_d: 0.955685
0.4231 --- loss: 1.771683, loss_ss: 1.062251, loss_d: 0.709432
0.4615 --- loss: 1.536225, loss_ss: 1.182703, loss_d: 0.353522
0.5000 --- loss: 1.419096, loss_ss: 1.028368, loss_d: 0.390727
0.5385 --- loss: 1.185037, loss_ss: 0.805057, loss_d: 0.379980
0.5769 --- loss: 1.238261, loss_ss: 0.945750, loss_d: 0.292511
0.6154 --- loss: 1.344857, loss_ss: 0.927883, loss_d: 0.416974
0.6538 --- loss: 1.456036, loss_ss: 0.968424, loss_d: 0.487612
0.6923 --- loss: 1.491957, loss_ss: 1.178873, loss_d: 0.313084
0.7308 --- loss: 1.530265, loss_ss: 1.084085, loss_d: 0.446180
0.7692 --- loss: 2.482164, loss_ss: 1.086561, loss_d: 1.395603
0.8077 --- loss: 1.453035, loss_ss: 1.086190, loss_d: 0.366845
0.8462 --- loss: 1.711907, loss_ss: 0.901269, loss_d: 0.810638
0.8846 --- loss: 1.965685, loss_ss: 1.221795, loss_d: 0.743890
0.9231 --- loss: 1.306415, loss_ss: 0.919201, loss_d: 0.387214
0.9615 --- loss: 1.520208, loss_ss: 1.117982, loss_d: 0.402225
Epoch finished! Loss: 1.5459441802676581
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.624561403508772
             precision    recall  f1-score   support

        0.0       0.47      0.30      0.36        67
        1.0       0.00      0.00      0.00       281
        2.0       0.60      0.92      0.73       335
        3.0       0.99      0.88      0.93       264
        4.0       0.43      0.79      0.56       193

avg / total       0.51      0.62      0.55      1140
 


====== chp015-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  93.86  29.85   97.86  46.51     36.36
1  75.35   0.00  100.00   0.00      0.00
2  79.91  92.24   74.78  60.35     72.96
3  96.93  87.50   99.77  99.14     92.96
4  78.86  78.76   78.88  43.18     55.78
Total accuracy: 62.46%
Average sen: 57.67%
Average spec: 90.26%
Macro f1-score: 51.61%
[0.99288964 0.99544334 0.99577051 0.9953934  0.99525118 0.99609751
 0.98788118 0.9901607  0.98836017 0.99049395 0.99239796 0.99188846
 0.9936713  0.99325836 0.99515414 0.9947601  0.994111   0.99024534
 0.9868412  0.99154949 0.99488539 0.99583638 0.99307513 0.98775929
 0.9905172  0.99091303 0.99606931 0.99574727 0.99555629 0.989829
 0.995193   0.99597895 0.99615943 0.99522746 0.98678768 0.99331206
 0.99341488 0.99613732]
pred: 0.9930004744153273, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.453067, loss_ss: 1.741812, loss_d: 0.711255
0.0385 --- loss: 2.221647, loss_ss: 1.660271, loss_d: 0.561376
0.0770 --- loss: 2.076696, loss_ss: 1.619090, loss_d: 0.457606
0.1156 --- loss: 2.225906, loss_ss: 1.558649, loss_d: 0.667257
0.1541 --- loss: 2.359142, loss_ss: 1.574915, loss_d: 0.784226
0.1926 --- loss: 2.223452, loss_ss: 1.642032, loss_d: 0.581420
0.2311 --- loss: 2.258631, loss_ss: 1.667790, loss_d: 0.590841
0.2696 --- loss: 2.066318, loss_ss: 1.539155, loss_d: 0.527162
0.3082 --- loss: 1.886818, loss_ss: 1.572280, loss_d: 0.314538
0.3467 --- loss: 2.206775, loss_ss: 1.547589, loss_d: 0.659186
0.3852 --- loss: 1.871588, loss_ss: 1.458582, loss_d: 0.413006
0.4237 --- loss: 1.728621, loss_ss: 1.470017, loss_d: 0.258603
0.4622 --- loss: 2.406375, loss_ss: 1.541993, loss_d: 0.864382
0.5008 --- loss: 2.300415, loss_ss: 1.569807, loss_d: 0.730608
0.5393 --- loss: 2.049081, loss_ss: 1.618501, loss_d: 0.430580
0.5778 --- loss: 2.139631, loss_ss: 1.476120, loss_d: 0.663512
0.6163 --- loss: 2.519567, loss_ss: 1.398183, loss_d: 1.121384
0.6549 --- loss: 1.985968, loss_ss: 1.612657, loss_d: 0.373311
0.6934 --- loss: 1.954369, loss_ss: 1.554221, loss_d: 0.400148
0.7319 --- loss: 2.077051, loss_ss: 1.555640, loss_d: 0.521411
0.7704 --- loss: 2.187409, loss_ss: 1.714056, loss_d: 0.473352
0.8089 --- loss: 1.971446, loss_ss: 1.536311, loss_d: 0.435135
0.8475 --- loss: 2.085300, loss_ss: 1.557411, loss_d: 0.527889
0.8860 --- loss: 2.065186, loss_ss: 1.469633, loss_d: 0.595553
0.9245 --- loss: 2.009263, loss_ss: 1.520835, loss_d: 0.488428
0.9630 --- loss: 2.369654, loss_ss: 1.586206, loss_d: 0.783448
Epoch finished! Loss: 2.131855253547315
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.748317, loss_ss: 1.394824, loss_d: 0.353492
0.0385 --- loss: 2.152317, loss_ss: 1.480666, loss_d: 0.671651
0.0770 --- loss: 1.640048, loss_ss: 1.308349, loss_d: 0.331698
0.1156 --- loss: 2.216634, loss_ss: 1.541390, loss_d: 0.675243
0.1541 --- loss: 2.030282, loss_ss: 1.530358, loss_d: 0.499923
0.1926 --- loss: 2.065890, loss_ss: 1.520661, loss_d: 0.545229
0.2311 --- loss: 1.889137, loss_ss: 1.416541, loss_d: 0.472596
0.2696 --- loss: 1.981049, loss_ss: 1.446638, loss_d: 0.534411
0.3082 --- loss: 1.940192, loss_ss: 1.489252, loss_d: 0.450940
0.3467 --- loss: 2.128021, loss_ss: 1.381657, loss_d: 0.746363
0.3852 --- loss: 1.701414, loss_ss: 1.361850, loss_d: 0.339564
0.4237 --- loss: 1.899469, loss_ss: 1.372414, loss_d: 0.527054
0.4622 --- loss: 1.787725, loss_ss: 1.439291, loss_d: 0.348433
0.5008 --- loss: 1.902943, loss_ss: 1.444684, loss_d: 0.458259
0.5393 --- loss: 1.911542, loss_ss: 1.481315, loss_d: 0.430227
0.5778 --- loss: 2.148809, loss_ss: 1.759163, loss_d: 0.389646
0.6163 --- loss: 1.931460, loss_ss: 1.493084, loss_d: 0.438376
0.6549 --- loss: 2.571736, loss_ss: 1.630125, loss_d: 0.941612
0.6934 --- loss: 1.924118, loss_ss: 1.536412, loss_d: 0.387706
0.7319 --- loss: 1.784443, loss_ss: 1.369149, loss_d: 0.415293
0.7704 --- loss: 2.007958, loss_ss: 1.484677, loss_d: 0.523281
0.8089 --- loss: 1.930215, loss_ss: 1.565314, loss_d: 0.364901
0.8475 --- loss: 1.705270, loss_ss: 1.412456, loss_d: 0.292814
0.8860 --- loss: 1.892503, loss_ss: 1.444098, loss_d: 0.448405
0.9245 --- loss: 1.894137, loss_ss: 1.362207, loss_d: 0.531930
0.9630 --- loss: 2.005778, loss_ss: 1.665017, loss_d: 0.340760
Epoch finished! Loss: 2.011917951944712
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.255724, loss_ss: 1.379237, loss_d: 0.876487
0.0385 --- loss: 1.929808, loss_ss: 1.625710, loss_d: 0.304098
0.0770 --- loss: 1.835116, loss_ss: 1.393102, loss_d: 0.442015
0.1156 --- loss: 1.958022, loss_ss: 1.524202, loss_d: 0.433820
0.1541 --- loss: 1.901275, loss_ss: 1.470379, loss_d: 0.430896
0.1926 --- loss: 1.947263, loss_ss: 1.408570, loss_d: 0.538693
0.2311 --- loss: 2.054892, loss_ss: 1.501907, loss_d: 0.552985
0.2696 --- loss: 1.755915, loss_ss: 1.207926, loss_d: 0.547989
0.3082 --- loss: 2.065139, loss_ss: 1.525896, loss_d: 0.539243
0.3467 --- loss: 1.834564, loss_ss: 1.380250, loss_d: 0.454314
0.3852 --- loss: 1.909206, loss_ss: 1.551682, loss_d: 0.357525
0.4237 --- loss: 2.068182, loss_ss: 1.597237, loss_d: 0.470945
0.4622 --- loss: 1.681344, loss_ss: 1.334658, loss_d: 0.346686
0.5008 --- loss: 1.962071, loss_ss: 1.532310, loss_d: 0.429762
0.5393 --- loss: 2.058664, loss_ss: 1.595883, loss_d: 0.462781
0.5778 --- loss: 2.406908, loss_ss: 1.823745, loss_d: 0.583163
0.6163 --- loss: 2.056224, loss_ss: 1.678919, loss_d: 0.377305
0.6549 --- loss: 1.897850, loss_ss: 1.477414, loss_d: 0.420436
0.6934 --- loss: 1.634816, loss_ss: 1.140261, loss_d: 0.494555
0.7319 --- loss: 1.801698, loss_ss: 1.379332, loss_d: 0.422366
0.7704 --- loss: 1.753612, loss_ss: 1.368127, loss_d: 0.385485
0.8089 --- loss: 2.049085, loss_ss: 1.555505, loss_d: 0.493580
0.8475 --- loss: 1.871984, loss_ss: 1.469278, loss_d: 0.402706
0.8860 --- loss: 1.841132, loss_ss: 1.228153, loss_d: 0.612979
0.9245 --- loss: 1.990893, loss_ss: 1.225981, loss_d: 0.764912
0.9630 --- loss: 2.535100, loss_ss: 1.773321, loss_d: 0.761779
Epoch finished! Loss: 1.9464371669246423
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.797739, loss_ss: 1.185822, loss_d: 0.611917
0.0385 --- loss: 1.851079, loss_ss: 1.458794, loss_d: 0.392285
0.0770 --- loss: 2.531156, loss_ss: 1.436136, loss_d: 1.095020
0.1156 --- loss: 2.059711, loss_ss: 1.325180, loss_d: 0.734531
0.1541 --- loss: 1.970905, loss_ss: 1.635986, loss_d: 0.334919
0.1926 --- loss: 1.810575, loss_ss: 1.458133, loss_d: 0.352442
0.2311 --- loss: 1.954230, loss_ss: 1.571303, loss_d: 0.382927
0.2696 --- loss: 1.996238, loss_ss: 1.556138, loss_d: 0.440100
0.3082 --- loss: 2.173118, loss_ss: 1.406202, loss_d: 0.766916
0.3467 --- loss: 1.851777, loss_ss: 1.438897, loss_d: 0.412880
0.3852 --- loss: 1.613454, loss_ss: 1.356325, loss_d: 0.257129
0.4237 --- loss: 2.147658, loss_ss: 1.763750, loss_d: 0.383908
0.4622 --- loss: 1.538898, loss_ss: 1.136992, loss_d: 0.401906
0.5008 --- loss: 1.695854, loss_ss: 1.382484, loss_d: 0.313370
0.5393 --- loss: 1.580981, loss_ss: 1.236732, loss_d: 0.344249
0.5778 --- loss: 2.087522, loss_ss: 1.506435, loss_d: 0.581087
0.6163 --- loss: 1.737931, loss_ss: 1.206146, loss_d: 0.531785
0.6549 --- loss: 1.924590, loss_ss: 1.310990, loss_d: 0.613600
0.6934 --- loss: 2.210766, loss_ss: 1.395144, loss_d: 0.815623
0.7319 --- loss: 1.976376, loss_ss: 1.281752, loss_d: 0.694623
0.7704 --- loss: 1.973153, loss_ss: 1.545436, loss_d: 0.427718
0.8089 --- loss: 1.805197, loss_ss: 1.283309, loss_d: 0.521888
0.8475 --- loss: 2.051120, loss_ss: 1.267796, loss_d: 0.783324
0.8860 --- loss: 1.716775, loss_ss: 1.376591, loss_d: 0.340184
0.9245 --- loss: 1.842020, loss_ss: 1.459512, loss_d: 0.382508
0.9630 --- loss: 1.695014, loss_ss: 1.290352, loss_d: 0.404662
Epoch finished! Loss: 1.921400563597219
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.898047, loss_ss: 1.144686, loss_d: 0.753361
0.0385 --- loss: 1.629128, loss_ss: 1.160945, loss_d: 0.468183
0.0770 --- loss: 1.782314, loss_ss: 1.394315, loss_d: 0.387998
0.1156 --- loss: 1.937181, loss_ss: 1.525953, loss_d: 0.411228
0.1541 --- loss: 2.082925, loss_ss: 1.437739, loss_d: 0.645186
0.1926 --- loss: 2.052659, loss_ss: 1.576013, loss_d: 0.476646
0.2311 --- loss: 1.936647, loss_ss: 1.455725, loss_d: 0.480921
0.2696 --- loss: 1.764641, loss_ss: 1.278404, loss_d: 0.486238
0.3082 --- loss: 2.172864, loss_ss: 1.383431, loss_d: 0.789433
0.3467 --- loss: 1.683276, loss_ss: 1.283536, loss_d: 0.399740
0.3852 --- loss: 1.857900, loss_ss: 1.451609, loss_d: 0.406290
0.4237 --- loss: 1.741472, loss_ss: 1.419018, loss_d: 0.322454
0.4622 --- loss: 1.503177, loss_ss: 1.141041, loss_d: 0.362136
0.5008 --- loss: 1.430596, loss_ss: 1.101674, loss_d: 0.328923
0.5393 --- loss: 1.950025, loss_ss: 1.565355, loss_d: 0.384670
0.5778 --- loss: 1.780511, loss_ss: 1.345933, loss_d: 0.434578
0.6163 --- loss: 1.757775, loss_ss: 1.196501, loss_d: 0.561274
0.6549 --- loss: 1.749407, loss_ss: 1.411401, loss_d: 0.338006
0.6934 --- loss: 1.641915, loss_ss: 1.269673, loss_d: 0.372242
0.7319 --- loss: 1.751376, loss_ss: 1.357470, loss_d: 0.393906
0.7704 --- loss: 2.353135, loss_ss: 1.453589, loss_d: 0.899546
0.8089 --- loss: 1.856695, loss_ss: 1.403625, loss_d: 0.453069
0.8475 --- loss: 1.798143, loss_ss: 1.397602, loss_d: 0.400541
0.8860 --- loss: 1.740273, loss_ss: 1.275887, loss_d: 0.464386
0.9245 --- loss: 2.475636, loss_ss: 1.575308, loss_d: 0.900328
0.9630 --- loss: 2.055591, loss_ss: 1.233230, loss_d: 0.822361
Epoch finished! Loss: 1.8883054905416423
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.775830, loss_ss: 1.367665, loss_d: 0.408165
0.0385 --- loss: 1.694815, loss_ss: 1.374889, loss_d: 0.319925
0.0770 --- loss: 1.693963, loss_ss: 1.211689, loss_d: 0.482274
0.1156 --- loss: 1.909377, loss_ss: 1.463477, loss_d: 0.445900
0.1541 --- loss: 1.582816, loss_ss: 1.222319, loss_d: 0.360498
0.1926 --- loss: 1.778813, loss_ss: 1.443480, loss_d: 0.335333
0.2311 --- loss: 1.861452, loss_ss: 1.361755, loss_d: 0.499697
0.2696 --- loss: 1.601180, loss_ss: 1.245944, loss_d: 0.355236
0.3082 --- loss: 2.831010, loss_ss: 1.607884, loss_d: 1.223125
0.3467 --- loss: 1.868719, loss_ss: 1.296455, loss_d: 0.572265
0.3852 --- loss: 1.887819, loss_ss: 1.421259, loss_d: 0.466559
0.4237 --- loss: 1.619514, loss_ss: 1.276762, loss_d: 0.342753
0.4622 --- loss: 1.804710, loss_ss: 1.503496, loss_d: 0.301214
0.5008 --- loss: 1.876942, loss_ss: 1.195795, loss_d: 0.681147
0.5393 --- loss: 1.729419, loss_ss: 1.344498, loss_d: 0.384921
0.5778 --- loss: 1.757892, loss_ss: 1.150824, loss_d: 0.607068
0.6163 --- loss: 1.547149, loss_ss: 1.168095, loss_d: 0.379055
0.6549 --- loss: 1.858494, loss_ss: 1.508440, loss_d: 0.350054
0.6934 --- loss: 1.579347, loss_ss: 1.252869, loss_d: 0.326478
0.7319 --- loss: 1.812929, loss_ss: 1.399242, loss_d: 0.413687
0.7704 --- loss: 1.646053, loss_ss: 1.270627, loss_d: 0.375427
0.8089 --- loss: 1.680574, loss_ss: 1.116659, loss_d: 0.563915
0.8475 --- loss: 1.898409, loss_ss: 1.388488, loss_d: 0.509921
0.8860 --- loss: 1.836817, loss_ss: 1.548419, loss_d: 0.288399
0.9245 --- loss: 2.010096, loss_ss: 1.316221, loss_d: 0.693874
0.9630 --- loss: 1.690333, loss_ss: 1.248889, loss_d: 0.441444
Epoch finished! Loss: 1.8385052713187966
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.816533, loss_ss: 1.340067, loss_d: 0.476466
0.0385 --- loss: 1.806357, loss_ss: 1.221410, loss_d: 0.584948
0.0770 --- loss: 2.233260, loss_ss: 1.412670, loss_d: 0.820590
0.1156 --- loss: 1.881089, loss_ss: 1.475032, loss_d: 0.406057
0.1541 --- loss: 1.836340, loss_ss: 1.391882, loss_d: 0.444458
0.1926 --- loss: 2.112504, loss_ss: 1.336758, loss_d: 0.775746
0.2311 --- loss: 1.711992, loss_ss: 1.420891, loss_d: 0.291101
0.2696 --- loss: 1.856034, loss_ss: 1.100803, loss_d: 0.755231
0.3082 --- loss: 1.587481, loss_ss: 1.232501, loss_d: 0.354980
0.3467 --- loss: 1.466976, loss_ss: 1.041544, loss_d: 0.425432
0.3852 --- loss: 1.590964, loss_ss: 1.167244, loss_d: 0.423720
0.4237 --- loss: 1.723564, loss_ss: 1.304224, loss_d: 0.419340
0.4622 --- loss: 1.671416, loss_ss: 1.318485, loss_d: 0.352931
0.5008 --- loss: 1.629032, loss_ss: 1.112287, loss_d: 0.516745
0.5393 --- loss: 1.718654, loss_ss: 1.436007, loss_d: 0.282647
0.5778 --- loss: 1.647312, loss_ss: 1.306327, loss_d: 0.340985
0.6163 --- loss: 1.634489, loss_ss: 1.267620, loss_d: 0.366869
0.6549 --- loss: 1.469495, loss_ss: 1.111916, loss_d: 0.357579
0.6934 --- loss: 1.630290, loss_ss: 1.268053, loss_d: 0.362237
0.7319 --- loss: 1.552313, loss_ss: 1.092523, loss_d: 0.459790
0.7704 --- loss: 1.655136, loss_ss: 1.065775, loss_d: 0.589361
0.8089 --- loss: 2.096634, loss_ss: 1.248165, loss_d: 0.848470
0.8475 --- loss: 2.022313, loss_ss: 1.150888, loss_d: 0.871424
0.8860 --- loss: 1.289786, loss_ss: 0.915649, loss_d: 0.374138
0.9245 --- loss: 1.673807, loss_ss: 1.100370, loss_d: 0.573437
0.9630 --- loss: 1.646044, loss_ss: 1.255015, loss_d: 0.391028
Epoch finished! Loss: 1.7398421497418612
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.253796, loss_ss: 1.673217, loss_d: 0.580579
0.0385 --- loss: 1.744452, loss_ss: 1.218785, loss_d: 0.525667
0.0770 --- loss: 1.625755, loss_ss: 1.151684, loss_d: 0.474072
0.1156 --- loss: 1.731759, loss_ss: 1.176419, loss_d: 0.555340
0.1541 --- loss: 2.100177, loss_ss: 1.195154, loss_d: 0.905023
0.1926 --- loss: 1.600850, loss_ss: 1.085054, loss_d: 0.515795
0.2311 --- loss: 1.444303, loss_ss: 1.081010, loss_d: 0.363292
0.2696 --- loss: 1.712470, loss_ss: 1.226302, loss_d: 0.486168
0.3082 --- loss: 1.316235, loss_ss: 1.050676, loss_d: 0.265559
0.3467 --- loss: 1.658763, loss_ss: 1.212814, loss_d: 0.445948
0.3852 --- loss: 1.662679, loss_ss: 1.326119, loss_d: 0.336560
0.4237 --- loss: 1.293744, loss_ss: 0.994143, loss_d: 0.299601
0.4622 --- loss: 1.512818, loss_ss: 1.176665, loss_d: 0.336154
0.5008 --- loss: 1.825354, loss_ss: 1.308329, loss_d: 0.517025
0.5393 --- loss: 1.755453, loss_ss: 1.159003, loss_d: 0.596450
0.5778 --- loss: 1.808708, loss_ss: 1.285819, loss_d: 0.522889
0.6163 --- loss: 1.372065, loss_ss: 1.005540, loss_d: 0.366525
0.6549 --- loss: 1.553011, loss_ss: 1.123598, loss_d: 0.429413
0.6934 --- loss: 1.364778, loss_ss: 0.969203, loss_d: 0.395576
0.7319 --- loss: 1.180413, loss_ss: 0.854727, loss_d: 0.325685
0.7704 --- loss: 1.571607, loss_ss: 1.205266, loss_d: 0.366341
0.8089 --- loss: 1.395579, loss_ss: 1.080375, loss_d: 0.315204
0.8475 --- loss: 1.538689, loss_ss: 1.195678, loss_d: 0.343011
0.8860 --- loss: 1.942469, loss_ss: 1.374523, loss_d: 0.567947
0.9245 --- loss: 1.748288, loss_ss: 0.994886, loss_d: 0.753402
0.9630 --- loss: 1.293469, loss_ss: 0.992950, loss_d: 0.300519
Epoch finished! Loss: 1.6518359386782848
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.521244, loss_ss: 1.103273, loss_d: 0.417971
0.0385 --- loss: 2.144190, loss_ss: 1.330178, loss_d: 0.814012
0.0770 --- loss: 1.433634, loss_ss: 1.103477, loss_d: 0.330157
0.1156 --- loss: 1.453802, loss_ss: 1.161849, loss_d: 0.291953
0.1541 --- loss: 1.766764, loss_ss: 1.115832, loss_d: 0.650932
0.1926 --- loss: 1.691564, loss_ss: 1.265830, loss_d: 0.425734
0.2311 --- loss: 1.608505, loss_ss: 1.306837, loss_d: 0.301668
0.2696 --- loss: 1.413892, loss_ss: 1.038818, loss_d: 0.375074
0.3082 --- loss: 1.578211, loss_ss: 1.236614, loss_d: 0.341597
0.3467 --- loss: 1.634110, loss_ss: 1.150459, loss_d: 0.483651
0.3852 --- loss: 2.079772, loss_ss: 1.336757, loss_d: 0.743015
0.4237 --- loss: 1.972036, loss_ss: 1.606205, loss_d: 0.365831
0.4622 --- loss: 1.270749, loss_ss: 1.036992, loss_d: 0.233757
0.5008 --- loss: 1.773743, loss_ss: 1.257480, loss_d: 0.516263
0.5393 --- loss: 1.128974, loss_ss: 0.819840, loss_d: 0.309134
0.5778 --- loss: 1.816732, loss_ss: 1.184760, loss_d: 0.631972
0.6163 --- loss: 1.403979, loss_ss: 1.029807, loss_d: 0.374172
0.6549 --- loss: 1.494177, loss_ss: 1.113251, loss_d: 0.380926
0.6934 --- loss: 1.473615, loss_ss: 1.163743, loss_d: 0.309871
0.7319 --- loss: 1.287159, loss_ss: 0.907445, loss_d: 0.379714
0.7704 --- loss: 1.262181, loss_ss: 0.935434, loss_d: 0.326746
0.8089 --- loss: 1.403037, loss_ss: 0.983654, loss_d: 0.419383
0.8475 --- loss: 1.566026, loss_ss: 1.187182, loss_d: 0.378844
0.8860 --- loss: 1.293812, loss_ss: 1.047811, loss_d: 0.246002
0.9245 --- loss: 2.046202, loss_ss: 1.471828, loss_d: 0.574374
0.9630 --- loss: 1.658958, loss_ss: 1.303558, loss_d: 0.355400
Epoch finished! Loss: 1.612016056955551
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.477935, loss_ss: 1.168595, loss_d: 0.309341
0.0385 --- loss: 1.661411, loss_ss: 1.118667, loss_d: 0.542744
0.0770 --- loss: 1.770331, loss_ss: 0.921731, loss_d: 0.848600
0.1156 --- loss: 1.250410, loss_ss: 0.924069, loss_d: 0.326341
0.1541 --- loss: 1.341090, loss_ss: 1.022233, loss_d: 0.318857
0.1926 --- loss: 1.448755, loss_ss: 1.156990, loss_d: 0.291765
0.2311 --- loss: 1.542373, loss_ss: 1.206933, loss_d: 0.335440
0.2696 --- loss: 1.508687, loss_ss: 1.252112, loss_d: 0.256575
0.3082 --- loss: 1.232105, loss_ss: 0.955425, loss_d: 0.276680
0.3467 --- loss: 2.211064, loss_ss: 1.256419, loss_d: 0.954645
0.3852 --- loss: 1.844693, loss_ss: 1.292266, loss_d: 0.552427
0.4237 --- loss: 1.275675, loss_ss: 0.981049, loss_d: 0.294627
0.4622 --- loss: 1.350113, loss_ss: 0.891971, loss_d: 0.458142
0.5008 --- loss: 1.613358, loss_ss: 1.315371, loss_d: 0.297987
0.5393 --- loss: 1.621326, loss_ss: 1.096906, loss_d: 0.524420
0.5778 --- loss: 1.564791, loss_ss: 1.049648, loss_d: 0.515143
0.6163 --- loss: 1.584594, loss_ss: 1.220109, loss_d: 0.364485
0.6549 --- loss: 1.771670, loss_ss: 1.423035, loss_d: 0.348635
0.6934 --- loss: 1.433470, loss_ss: 0.907795, loss_d: 0.525675
0.7319 --- loss: 1.656308, loss_ss: 1.152858, loss_d: 0.503450
0.7704 --- loss: 1.542649, loss_ss: 0.990858, loss_d: 0.551790
0.8089 --- loss: 1.513631, loss_ss: 1.302995, loss_d: 0.210636
0.8475 --- loss: 1.706941, loss_ss: 1.462280, loss_d: 0.244661
0.8860 --- loss: 1.502426, loss_ss: 1.085860, loss_d: 0.416566
0.9245 --- loss: 1.460245, loss_ss: 0.829887, loss_d: 0.630358
0.9630 --- loss: 1.919298, loss_ss: 1.420336, loss_d: 0.498961
Epoch finished! Loss: 1.5558011706731494
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4238095238095238
             precision    recall  f1-score   support

        0.0       0.97      0.35      0.51       297
        1.0       0.00      0.00      0.00       289
        2.0       0.46      0.93      0.62       330
        3.0       0.25      0.92      0.40       133
        4.0       0.00      0.00      0.00       211

avg / total       0.38      0.42      0.32      1260
 


====== chp016-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  84.44  35.02   99.69  97.20     51.49
1  77.06   0.00  100.00   0.00      0.00
2  69.84  93.03   61.61  46.23     61.77
3  70.16  92.48   67.52  25.15     39.55
4  83.25   0.00  100.00   0.00      0.00
Total accuracy: 42.38%
Average sen: 44.11%
Average spec: 85.77%
Macro f1-score: 30.56%
[0.56560105 0.40080261 0.27164456 0.28555909 0.31278306 0.81785971
 0.34985763 0.30946675 0.27083686 0.30674461 0.28896689 0.29473427
 0.33011463 0.34688732 0.27573285 0.28091913 0.27506381 0.28293046
 0.28872392 0.28097618 0.27513129 0.38083357 0.62003648 0.75009757
 0.58089799 0.72536319 0.7588284  0.65298092 0.4347603  0.43836835
 0.26216999 0.26219046 0.2663956  0.27733201 0.29863158 0.28869405
 0.29747307 0.26375145 0.26365539 0.26442751 0.48031703 0.52552438]
pred: 0.385811094726835, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.384871, loss_ss: 1.705664, loss_d: 0.679207
0.0384 --- loss: 2.261060, loss_ss: 1.691833, loss_d: 0.569227
0.0768 --- loss: 2.197625, loss_ss: 1.615122, loss_d: 0.582503
0.1152 --- loss: 2.377712, loss_ss: 1.678792, loss_d: 0.698919
0.1536 --- loss: 2.064806, loss_ss: 1.602419, loss_d: 0.462387
0.1919 --- loss: 2.208613, loss_ss: 1.553879, loss_d: 0.654734
0.2303 --- loss: 2.129213, loss_ss: 1.535915, loss_d: 0.593299
0.2687 --- loss: 2.093516, loss_ss: 1.642011, loss_d: 0.451506
0.3071 --- loss: 2.050512, loss_ss: 1.629073, loss_d: 0.421439
0.3455 --- loss: 1.962254, loss_ss: 1.596783, loss_d: 0.365471
0.3839 --- loss: 1.967648, loss_ss: 1.582425, loss_d: 0.385223
0.4223 --- loss: 2.238046, loss_ss: 1.441108, loss_d: 0.796939
0.4607 --- loss: 2.203495, loss_ss: 1.529110, loss_d: 0.674385
0.4990 --- loss: 1.923478, loss_ss: 1.567405, loss_d: 0.356073
0.5374 --- loss: 2.219438, loss_ss: 1.636480, loss_d: 0.582958
0.5758 --- loss: 1.931621, loss_ss: 1.464525, loss_d: 0.467096
0.6142 --- loss: 2.089927, loss_ss: 1.583779, loss_d: 0.506148
0.6526 --- loss: 2.214724, loss_ss: 1.531164, loss_d: 0.683560
0.6910 --- loss: 2.435782, loss_ss: 1.540842, loss_d: 0.894940
0.7294 --- loss: 2.259873, loss_ss: 1.522431, loss_d: 0.737442
0.7678 --- loss: 1.883539, loss_ss: 1.575626, loss_d: 0.307913
0.8061 --- loss: 2.436465, loss_ss: 1.619159, loss_d: 0.817306
0.8445 --- loss: 1.790224, loss_ss: 1.449720, loss_d: 0.340504
0.8829 --- loss: 2.122617, loss_ss: 1.561494, loss_d: 0.561123
0.9213 --- loss: 1.819274, loss_ss: 1.582891, loss_d: 0.236383
0.9597 --- loss: 2.087097, loss_ss: 1.560182, loss_d: 0.526915
0.9981 --- loss: 1.906561, loss_ss: 1.521100, loss_d: 0.385461
Epoch finished! Loss: 2.128118008375168
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.750675, loss_ss: 1.360434, loss_d: 0.390241
0.0384 --- loss: 2.210175, loss_ss: 1.598861, loss_d: 0.611314
0.0768 --- loss: 2.049490, loss_ss: 1.512257, loss_d: 0.537233
0.1152 --- loss: 1.881503, loss_ss: 1.474791, loss_d: 0.406712
0.1536 --- loss: 2.016085, loss_ss: 1.529643, loss_d: 0.486442
0.1919 --- loss: 1.931576, loss_ss: 1.491618, loss_d: 0.439958
0.2303 --- loss: 2.028102, loss_ss: 1.577275, loss_d: 0.450826
0.2687 --- loss: 1.966853, loss_ss: 1.500423, loss_d: 0.466430
0.3071 --- loss: 1.928390, loss_ss: 1.570876, loss_d: 0.357514
0.3455 --- loss: 2.184906, loss_ss: 1.552882, loss_d: 0.632023
0.3839 --- loss: 1.657355, loss_ss: 1.370717, loss_d: 0.286638
0.4223 --- loss: 1.903534, loss_ss: 1.324396, loss_d: 0.579138
0.4607 --- loss: 1.806726, loss_ss: 1.443104, loss_d: 0.363621
0.4990 --- loss: 1.989542, loss_ss: 1.517726, loss_d: 0.471817
0.5374 --- loss: 1.909177, loss_ss: 1.289168, loss_d: 0.620009
0.5758 --- loss: 2.109045, loss_ss: 1.516120, loss_d: 0.592926
0.6142 --- loss: 2.001638, loss_ss: 1.446282, loss_d: 0.555355
0.6526 --- loss: 1.743227, loss_ss: 1.426040, loss_d: 0.317187
0.6910 --- loss: 2.486972, loss_ss: 1.590467, loss_d: 0.896504
0.7294 --- loss: 1.828867, loss_ss: 1.466925, loss_d: 0.361942
0.7678 --- loss: 1.791329, loss_ss: 1.418335, loss_d: 0.372994
0.8061 --- loss: 2.253651, loss_ss: 1.544272, loss_d: 0.709378
0.8445 --- loss: 1.979424, loss_ss: 1.271624, loss_d: 0.707800
0.8829 --- loss: 1.874036, loss_ss: 1.445793, loss_d: 0.428243
0.9213 --- loss: 1.959557, loss_ss: 1.476469, loss_d: 0.483088
0.9597 --- loss: 2.030523, loss_ss: 1.418401, loss_d: 0.612122
0.9981 --- loss: 1.529635, loss_ss: 1.232552, loss_d: 0.297083
Epoch finished! Loss: 2.0036417039541097
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.031577, loss_ss: 1.525163, loss_d: 0.506414
0.0384 --- loss: 2.033691, loss_ss: 1.633575, loss_d: 0.400116
0.0768 --- loss: 2.193712, loss_ss: 1.395722, loss_d: 0.797990
0.1152 --- loss: 1.846620, loss_ss: 1.549385, loss_d: 0.297236
0.1536 --- loss: 1.865059, loss_ss: 1.523988, loss_d: 0.341071
0.1919 --- loss: 2.041973, loss_ss: 1.384538, loss_d: 0.657436
0.2303 --- loss: 2.003911, loss_ss: 1.375540, loss_d: 0.628370
0.2687 --- loss: 2.168096, loss_ss: 1.689975, loss_d: 0.478121
0.3071 --- loss: 1.869660, loss_ss: 1.487875, loss_d: 0.381785
0.3455 --- loss: 1.858657, loss_ss: 1.295398, loss_d: 0.563260
0.3839 --- loss: 1.796251, loss_ss: 1.364279, loss_d: 0.431972
0.4223 --- loss: 2.274133, loss_ss: 1.779154, loss_d: 0.494979
0.4607 --- loss: 1.829177, loss_ss: 1.395415, loss_d: 0.433763
0.4990 --- loss: 1.809455, loss_ss: 1.439876, loss_d: 0.369578
0.5374 --- loss: 2.527241, loss_ss: 1.514154, loss_d: 1.013087
0.5758 --- loss: 1.776083, loss_ss: 1.339054, loss_d: 0.437030
0.6142 --- loss: 2.314136, loss_ss: 1.672709, loss_d: 0.641428
0.6526 --- loss: 1.628181, loss_ss: 1.218018, loss_d: 0.410163
0.6910 --- loss: 1.627237, loss_ss: 1.272196, loss_d: 0.355040
0.7294 --- loss: 2.353143, loss_ss: 1.603070, loss_d: 0.750073
0.7678 --- loss: 1.690203, loss_ss: 1.278987, loss_d: 0.411216
0.8061 --- loss: 1.835951, loss_ss: 1.394111, loss_d: 0.441840
0.8445 --- loss: 2.348498, loss_ss: 1.458225, loss_d: 0.890273
0.8829 --- loss: 2.001693, loss_ss: 1.417057, loss_d: 0.584636
0.9213 --- loss: 1.902679, loss_ss: 1.384137, loss_d: 0.518542
0.9597 --- loss: 2.433866, loss_ss: 1.465154, loss_d: 0.968712
0.9981 --- loss: 1.672207, loss_ss: 1.253434, loss_d: 0.418773
Epoch finished! Loss: 1.938939915712063
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.898783, loss_ss: 1.555182, loss_d: 0.343601
0.0384 --- loss: 1.774767, loss_ss: 1.375710, loss_d: 0.399057
0.0768 --- loss: 1.757908, loss_ss: 1.389289, loss_d: 0.368619
0.1152 --- loss: 1.837221, loss_ss: 1.555650, loss_d: 0.281571
0.1536 --- loss: 2.070089, loss_ss: 1.655760, loss_d: 0.414329
0.1919 --- loss: 2.076648, loss_ss: 1.639893, loss_d: 0.436754
0.2303 --- loss: 1.596842, loss_ss: 1.168750, loss_d: 0.428092
0.2687 --- loss: 1.788722, loss_ss: 1.358683, loss_d: 0.430038
0.3071 --- loss: 1.859392, loss_ss: 1.476677, loss_d: 0.382716
0.3455 --- loss: 1.806531, loss_ss: 1.395829, loss_d: 0.410702
0.3839 --- loss: 1.586914, loss_ss: 1.140415, loss_d: 0.446499
0.4223 --- loss: 1.741829, loss_ss: 1.372772, loss_d: 0.369058
0.4607 --- loss: 1.913427, loss_ss: 1.506892, loss_d: 0.406535
0.4990 --- loss: 1.878505, loss_ss: 1.487937, loss_d: 0.390568
0.5374 --- loss: 1.768443, loss_ss: 1.179587, loss_d: 0.588856
0.5758 --- loss: 1.400606, loss_ss: 0.986863, loss_d: 0.413743
0.6142 --- loss: 1.934965, loss_ss: 1.363915, loss_d: 0.571050
0.6526 --- loss: 1.613526, loss_ss: 1.181517, loss_d: 0.432009
0.6910 --- loss: 1.623061, loss_ss: 1.206754, loss_d: 0.416308
0.7294 --- loss: 2.033537, loss_ss: 1.475929, loss_d: 0.557608
0.7678 --- loss: 2.090211, loss_ss: 1.469989, loss_d: 0.620222
0.8061 --- loss: 1.619228, loss_ss: 1.191090, loss_d: 0.428139
0.8445 --- loss: 1.567497, loss_ss: 1.235106, loss_d: 0.332391
0.8829 --- loss: 1.534803, loss_ss: 1.104571, loss_d: 0.430232
0.9213 --- loss: 1.413935, loss_ss: 1.084062, loss_d: 0.329873
0.9597 --- loss: 2.328927, loss_ss: 1.191278, loss_d: 1.137650
0.9981 --- loss: 1.592227, loss_ss: 1.207623, loss_d: 0.384604
Epoch finished! Loss: 1.8316447413884676
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.611503, loss_ss: 1.135504, loss_d: 0.475999
0.0384 --- loss: 2.065648, loss_ss: 1.310742, loss_d: 0.754906
0.0768 --- loss: 1.672286, loss_ss: 1.271671, loss_d: 0.400615
0.1152 --- loss: 1.664405, loss_ss: 1.316134, loss_d: 0.348271
0.1536 --- loss: 1.390628, loss_ss: 1.079272, loss_d: 0.311356
0.1919 --- loss: 1.758486, loss_ss: 1.209567, loss_d: 0.548919
0.2303 --- loss: 1.777681, loss_ss: 1.226027, loss_d: 0.551654
0.2687 --- loss: 1.819254, loss_ss: 1.363816, loss_d: 0.455438
0.3071 --- loss: 2.084522, loss_ss: 1.159534, loss_d: 0.924988
0.3455 --- loss: 1.750186, loss_ss: 1.353288, loss_d: 0.396898
0.3839 --- loss: 1.945166, loss_ss: 1.030561, loss_d: 0.914604
0.4223 --- loss: 2.125033, loss_ss: 1.430514, loss_d: 0.694519
0.4607 --- loss: 1.733572, loss_ss: 1.265493, loss_d: 0.468080
0.4990 --- loss: 1.582659, loss_ss: 1.196575, loss_d: 0.386084
0.5374 --- loss: 1.728074, loss_ss: 1.279223, loss_d: 0.448851
0.5758 --- loss: 1.544736, loss_ss: 1.150259, loss_d: 0.394478
0.6142 --- loss: 1.734133, loss_ss: 1.188472, loss_d: 0.545661
0.6526 --- loss: 1.518615, loss_ss: 1.058503, loss_d: 0.460112
0.6910 --- loss: 1.344161, loss_ss: 0.942403, loss_d: 0.401758
0.7294 --- loss: 1.618655, loss_ss: 1.132620, loss_d: 0.486035
0.7678 --- loss: 1.672642, loss_ss: 1.217241, loss_d: 0.455402
0.8061 --- loss: 2.095018, loss_ss: 1.549712, loss_d: 0.545306
0.8445 --- loss: 2.122595, loss_ss: 1.619898, loss_d: 0.502697
0.8829 --- loss: 1.837595, loss_ss: 1.358143, loss_d: 0.479452
0.9213 --- loss: 1.381035, loss_ss: 1.040351, loss_d: 0.340684
0.9597 --- loss: 1.754312, loss_ss: 1.396260, loss_d: 0.358052
0.9981 --- loss: 1.604573, loss_ss: 1.250455, loss_d: 0.354119
Epoch finished! Loss: 1.7284785862152392
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.627857, loss_ss: 1.286132, loss_d: 0.341725
0.0384 --- loss: 1.753470, loss_ss: 1.020553, loss_d: 0.732917
0.0768 --- loss: 1.498932, loss_ss: 1.196913, loss_d: 0.302019
0.1152 --- loss: 1.414822, loss_ss: 1.073459, loss_d: 0.341363
0.1536 --- loss: 1.503762, loss_ss: 1.026435, loss_d: 0.477328
0.1919 --- loss: 2.040262, loss_ss: 1.085234, loss_d: 0.955028
0.2303 --- loss: 1.770325, loss_ss: 1.354198, loss_d: 0.416127
0.2687 --- loss: 1.839614, loss_ss: 0.993763, loss_d: 0.845851
0.3071 --- loss: 1.873125, loss_ss: 1.450359, loss_d: 0.422766
0.3455 --- loss: 1.589779, loss_ss: 1.239821, loss_d: 0.349958
0.3839 --- loss: 2.048488, loss_ss: 1.350014, loss_d: 0.698474
0.4223 --- loss: 1.530253, loss_ss: 1.169815, loss_d: 0.360437
0.4607 --- loss: 1.599570, loss_ss: 1.204175, loss_d: 0.395396
0.4990 --- loss: 1.733932, loss_ss: 1.053841, loss_d: 0.680091
0.5374 --- loss: 1.620268, loss_ss: 1.228220, loss_d: 0.392049
0.5758 --- loss: 1.412984, loss_ss: 1.082926, loss_d: 0.330058
0.6142 --- loss: 1.343556, loss_ss: 1.006851, loss_d: 0.336705
0.6526 --- loss: 1.600371, loss_ss: 1.128079, loss_d: 0.472292
0.6910 --- loss: 1.612529, loss_ss: 1.175112, loss_d: 0.437416
0.7294 --- loss: 1.533530, loss_ss: 1.224965, loss_d: 0.308565
0.7678 --- loss: 1.827638, loss_ss: 1.232299, loss_d: 0.595339
0.8061 --- loss: 1.472152, loss_ss: 1.054392, loss_d: 0.417759
0.8445 --- loss: 1.691956, loss_ss: 1.203419, loss_d: 0.488537
0.8829 --- loss: 1.464655, loss_ss: 1.047190, loss_d: 0.417465
0.9213 --- loss: 1.447928, loss_ss: 1.156882, loss_d: 0.291046
0.9597 --- loss: 1.359122, loss_ss: 0.983778, loss_d: 0.375344
0.9981 --- loss: 1.428779, loss_ss: 1.029234, loss_d: 0.399545
Epoch finished! Loss: 1.6604255066468165
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.373556, loss_ss: 1.252325, loss_d: 1.121231
0.0384 --- loss: 1.535673, loss_ss: 1.179716, loss_d: 0.355957
0.0768 --- loss: 1.672154, loss_ss: 1.303337, loss_d: 0.368817
0.1152 --- loss: 1.535368, loss_ss: 1.257246, loss_d: 0.278122
0.1536 --- loss: 1.918320, loss_ss: 1.376721, loss_d: 0.541599
0.1919 --- loss: 1.770059, loss_ss: 1.112716, loss_d: 0.657343
0.2303 --- loss: 1.813133, loss_ss: 1.242554, loss_d: 0.570579
0.2687 --- loss: 1.530207, loss_ss: 1.056820, loss_d: 0.473387
0.3071 --- loss: 1.626234, loss_ss: 0.970528, loss_d: 0.655706
0.3455 --- loss: 2.388155, loss_ss: 1.595213, loss_d: 0.792942
0.3839 --- loss: 1.637044, loss_ss: 1.146269, loss_d: 0.490775
0.4223 --- loss: 1.578351, loss_ss: 0.956967, loss_d: 0.621383
0.4607 --- loss: 1.666702, loss_ss: 1.353432, loss_d: 0.313269
0.4990 --- loss: 1.451346, loss_ss: 1.139002, loss_d: 0.312344
0.5374 --- loss: 1.440217, loss_ss: 1.030127, loss_d: 0.410091
0.5758 --- loss: 1.824149, loss_ss: 1.267622, loss_d: 0.556527
0.6142 --- loss: 1.745673, loss_ss: 1.157270, loss_d: 0.588404
0.6526 --- loss: 1.632616, loss_ss: 1.211885, loss_d: 0.420731
0.6910 --- loss: 1.435282, loss_ss: 1.045616, loss_d: 0.389666
0.7294 --- loss: 1.655639, loss_ss: 1.326109, loss_d: 0.329530
0.7678 --- loss: 1.777143, loss_ss: 1.353410, loss_d: 0.423733
0.8061 --- loss: 1.614672, loss_ss: 1.350230, loss_d: 0.264442
0.8445 --- loss: 1.551789, loss_ss: 1.128923, loss_d: 0.422866
0.8829 --- loss: 1.708476, loss_ss: 1.119690, loss_d: 0.588786
0.9213 --- loss: 1.568615, loss_ss: 1.109979, loss_d: 0.458636
0.9597 --- loss: 1.768494, loss_ss: 1.047115, loss_d: 0.721380
0.9981 --- loss: 1.335870, loss_ss: 1.033595, loss_d: 0.302275
Epoch finished! Loss: 1.6170896901534153
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.313832, loss_ss: 0.990608, loss_d: 0.323224
0.0384 --- loss: 1.659093, loss_ss: 1.339051, loss_d: 0.320043
0.0768 --- loss: 1.426420, loss_ss: 1.118581, loss_d: 0.307840
0.1152 --- loss: 1.666535, loss_ss: 1.303100, loss_d: 0.363435
0.1536 --- loss: 2.391470, loss_ss: 1.640833, loss_d: 0.750637
0.1919 --- loss: 1.525154, loss_ss: 0.977959, loss_d: 0.547195
0.2303 --- loss: 1.817623, loss_ss: 1.073970, loss_d: 0.743653
0.2687 --- loss: 1.343198, loss_ss: 0.999479, loss_d: 0.343719
0.3071 --- loss: 1.624396, loss_ss: 1.165692, loss_d: 0.458705
0.3455 --- loss: 1.174538, loss_ss: 0.874302, loss_d: 0.300236
0.3839 --- loss: 1.470858, loss_ss: 1.075840, loss_d: 0.395019
0.4223 --- loss: 1.275742, loss_ss: 0.897810, loss_d: 0.377932
0.4607 --- loss: 1.475825, loss_ss: 1.202820, loss_d: 0.273005
0.4990 --- loss: 1.755330, loss_ss: 1.177248, loss_d: 0.578082
0.5374 --- loss: 1.402430, loss_ss: 1.026749, loss_d: 0.375682
0.5758 --- loss: 1.165239, loss_ss: 0.808058, loss_d: 0.357181
0.6142 --- loss: 1.668032, loss_ss: 1.227305, loss_d: 0.440727
0.6526 --- loss: 1.403094, loss_ss: 1.076811, loss_d: 0.326284
0.6910 --- loss: 1.707537, loss_ss: 1.031946, loss_d: 0.675591
0.7294 --- loss: 1.330018, loss_ss: 0.921445, loss_d: 0.408573
0.7678 --- loss: 1.971956, loss_ss: 1.648745, loss_d: 0.323212
0.8061 --- loss: 1.514432, loss_ss: 1.049405, loss_d: 0.465027
0.8445 --- loss: 1.299987, loss_ss: 0.769240, loss_d: 0.530747
0.8829 --- loss: 1.307716, loss_ss: 0.808846, loss_d: 0.498870
0.9213 --- loss: 1.457246, loss_ss: 1.177895, loss_d: 0.279351
0.9597 --- loss: 1.636135, loss_ss: 1.077857, loss_d: 0.558279
0.9981 --- loss: 2.017480, loss_ss: 1.256403, loss_d: 0.761077
Epoch finished! Loss: 1.5867872288593878
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.504485, loss_ss: 1.139896, loss_d: 0.364589
0.0384 --- loss: 1.761927, loss_ss: 1.218442, loss_d: 0.543485
0.0768 --- loss: 1.159205, loss_ss: 0.871856, loss_d: 0.287350
0.1152 --- loss: 1.494150, loss_ss: 0.976052, loss_d: 0.518098
0.1536 --- loss: 1.518825, loss_ss: 1.237801, loss_d: 0.281024
0.1919 --- loss: 1.266252, loss_ss: 0.958555, loss_d: 0.307697
0.2303 --- loss: 1.509702, loss_ss: 1.108531, loss_d: 0.401171
0.2687 --- loss: 1.905781, loss_ss: 1.426161, loss_d: 0.479620
0.3071 --- loss: 1.402114, loss_ss: 1.096600, loss_d: 0.305514
0.3455 --- loss: 1.568299, loss_ss: 1.171664, loss_d: 0.396635
0.3839 --- loss: 1.881034, loss_ss: 1.474491, loss_d: 0.406543
0.4223 --- loss: 1.467266, loss_ss: 0.993998, loss_d: 0.473268
0.4607 --- loss: 1.363044, loss_ss: 1.076142, loss_d: 0.286902
0.4990 --- loss: 1.827391, loss_ss: 1.253452, loss_d: 0.573938
0.5374 --- loss: 1.390643, loss_ss: 1.166450, loss_d: 0.224193
0.5758 --- loss: 1.722924, loss_ss: 0.972544, loss_d: 0.750380
0.6142 --- loss: 1.962490, loss_ss: 1.011369, loss_d: 0.951121
0.6526 --- loss: 1.459967, loss_ss: 1.032969, loss_d: 0.426999
0.6910 --- loss: 1.395513, loss_ss: 0.983829, loss_d: 0.411684
0.7294 --- loss: 1.395357, loss_ss: 1.051308, loss_d: 0.344049
0.7678 --- loss: 1.404205, loss_ss: 1.063109, loss_d: 0.341096
0.8061 --- loss: 1.523435, loss_ss: 0.951031, loss_d: 0.572405
0.8445 --- loss: 1.579479, loss_ss: 1.195399, loss_d: 0.384079
0.8829 --- loss: 1.491086, loss_ss: 1.042733, loss_d: 0.448354
0.9213 --- loss: 1.760654, loss_ss: 1.304536, loss_d: 0.456117
0.9597 --- loss: 1.561077, loss_ss: 1.061117, loss_d: 0.499960
0.9981 --- loss: 2.886986, loss_ss: 1.021336, loss_d: 1.865649
Epoch finished! Loss: 1.5524479095752424
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.302003, loss_ss: 1.020113, loss_d: 0.281890
0.0384 --- loss: 1.731685, loss_ss: 1.203085, loss_d: 0.528601
0.0768 --- loss: 1.207916, loss_ss: 0.871985, loss_d: 0.335931
0.1152 --- loss: 1.370563, loss_ss: 0.980530, loss_d: 0.390033
0.1536 --- loss: 2.540995, loss_ss: 1.154111, loss_d: 1.386884
0.1919 --- loss: 1.583921, loss_ss: 1.206013, loss_d: 0.377909
0.2303 --- loss: 1.966852, loss_ss: 1.148340, loss_d: 0.818512
0.2687 --- loss: 1.229157, loss_ss: 0.841331, loss_d: 0.387826
0.3071 --- loss: 1.324415, loss_ss: 0.866112, loss_d: 0.458303
0.3455 --- loss: 1.295814, loss_ss: 0.913507, loss_d: 0.382306
0.3839 --- loss: 1.447486, loss_ss: 1.090900, loss_d: 0.356586
0.4223 --- loss: 2.617225, loss_ss: 1.141999, loss_d: 1.475226
0.4607 --- loss: 1.393489, loss_ss: 1.031759, loss_d: 0.361730
0.4990 --- loss: 1.745535, loss_ss: 1.036010, loss_d: 0.709524
0.5374 --- loss: 1.714101, loss_ss: 1.243543, loss_d: 0.470558
0.5758 --- loss: 1.841974, loss_ss: 1.403811, loss_d: 0.438163
0.6142 --- loss: 1.496185, loss_ss: 1.142616, loss_d: 0.353569
0.6526 --- loss: 1.425437, loss_ss: 0.899765, loss_d: 0.525672
0.6910 --- loss: 1.409041, loss_ss: 0.988295, loss_d: 0.420746
0.7294 --- loss: 1.775537, loss_ss: 1.346974, loss_d: 0.428564
0.7678 --- loss: 1.610031, loss_ss: 1.259205, loss_d: 0.350826
0.8061 --- loss: 1.288164, loss_ss: 0.995669, loss_d: 0.292495
0.8445 --- loss: 2.670639, loss_ss: 1.467777, loss_d: 1.202862
0.8829 --- loss: 1.824339, loss_ss: 1.408792, loss_d: 0.415547
0.9213 --- loss: 1.558526, loss_ss: 1.198619, loss_d: 0.359906
0.9597 --- loss: 1.234782, loss_ss: 1.044271, loss_d: 0.190511
0.9981 --- loss: 2.104073, loss_ss: 1.727668, loss_d: 0.376404
Epoch finished! Loss: 1.5188960600357788
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.502020202020202
             precision    recall  f1-score   support

        0.0       0.65      0.78      0.71       237
        1.0       0.00      0.00      0.00       249
        2.0       0.40      0.66      0.50       210
        3.0       0.81      0.53      0.64       245
        4.0       0.22      0.88      0.35        49

avg / total       0.45      0.50      0.45       990
 


====== chp017-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  84.65  78.48   86.59  64.81     70.99
1  74.85   0.00  100.00   0.00      0.00
2  72.02  66.19   73.59  40.29     50.09
3  85.15  52.65   95.84  80.62     63.70
4  83.74  87.76   83.53  21.72     34.82
Total accuracy: 50.20%
Average sen: 57.02%
Average spec: 87.91%
Macro f1-score: 43.92%
[0.9969393  0.99467224 0.99624121 0.99629635 0.99626786 0.99690008
 0.99858642 0.99681038 0.99477226 0.99367046 0.99252069 0.99265033
 0.99362189 0.9939732  0.99374676 0.99361426 0.98931736 0.9957273
 0.99302614 0.9916746  0.99517906 0.99609876 0.99414057 0.99756348
 0.99513173 0.99401665 0.9933269  0.99398649 0.99644655 0.99522555
 0.99660218 0.99398828 0.99309206]
pred: 0.9947220394105623, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.318361, loss_ss: 1.645368, loss_d: 0.672993
0.0384 --- loss: 1.908875, loss_ss: 1.506717, loss_d: 0.402158
0.0769 --- loss: 2.223166, loss_ss: 1.702856, loss_d: 0.520309
0.1153 --- loss: 2.260029, loss_ss: 1.708251, loss_d: 0.551779
0.1538 --- loss: 2.182957, loss_ss: 1.713670, loss_d: 0.469287
0.1922 --- loss: 2.096883, loss_ss: 1.538500, loss_d: 0.558382
0.2307 --- loss: 1.868683, loss_ss: 1.466235, loss_d: 0.402447
0.2691 --- loss: 1.977629, loss_ss: 1.623477, loss_d: 0.354153
0.3076 --- loss: 2.241606, loss_ss: 1.660483, loss_d: 0.581123
0.3460 --- loss: 2.383534, loss_ss: 1.710386, loss_d: 0.673148
0.3845 --- loss: 2.364519, loss_ss: 1.657962, loss_d: 0.706557
0.4229 --- loss: 2.038634, loss_ss: 1.409003, loss_d: 0.629631
0.4614 --- loss: 2.041928, loss_ss: 1.523686, loss_d: 0.518242
0.4998 --- loss: 1.950694, loss_ss: 1.443520, loss_d: 0.507174
0.5383 --- loss: 1.882776, loss_ss: 1.351650, loss_d: 0.531126
0.5767 --- loss: 2.126645, loss_ss: 1.618318, loss_d: 0.508327
0.6151 --- loss: 1.979187, loss_ss: 1.570266, loss_d: 0.408921
0.6536 --- loss: 1.981699, loss_ss: 1.528162, loss_d: 0.453537
0.6920 --- loss: 2.061560, loss_ss: 1.455037, loss_d: 0.606522
0.7305 --- loss: 2.629814, loss_ss: 1.732173, loss_d: 0.897641
0.7689 --- loss: 1.987316, loss_ss: 1.351914, loss_d: 0.635401
0.8074 --- loss: 1.684976, loss_ss: 1.349563, loss_d: 0.335413
0.8458 --- loss: 1.818348, loss_ss: 1.441395, loss_d: 0.376953
0.8843 --- loss: 1.839632, loss_ss: 1.449914, loss_d: 0.389718
0.9227 --- loss: 1.786595, loss_ss: 1.406570, loss_d: 0.380026
0.9612 --- loss: 2.110783, loss_ss: 1.521487, loss_d: 0.589296
0.9996 --- loss: 1.194735, loss_ss: 1.067826, loss_d: 0.126909
Epoch finished! Loss: 2.087024712562561
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.865496, loss_ss: 1.511582, loss_d: 0.353914
0.0384 --- loss: 1.691791, loss_ss: 1.337495, loss_d: 0.354296
0.0769 --- loss: 1.959327, loss_ss: 1.432811, loss_d: 0.526516
0.1153 --- loss: 1.816824, loss_ss: 1.390815, loss_d: 0.426009
0.1538 --- loss: 2.135324, loss_ss: 1.336681, loss_d: 0.798643
0.1922 --- loss: 1.894744, loss_ss: 1.383251, loss_d: 0.511493
0.2307 --- loss: 1.940404, loss_ss: 1.439558, loss_d: 0.500846
0.2691 --- loss: 2.235257, loss_ss: 1.603063, loss_d: 0.632195
0.3076 --- loss: 2.021224, loss_ss: 1.397977, loss_d: 0.623246
0.3460 --- loss: 1.807822, loss_ss: 1.277884, loss_d: 0.529938
0.3845 --- loss: 2.150997, loss_ss: 1.327885, loss_d: 0.823111
0.4229 --- loss: 1.768791, loss_ss: 1.349377, loss_d: 0.419414
0.4614 --- loss: 1.808071, loss_ss: 1.400080, loss_d: 0.407990
0.4998 --- loss: 1.846006, loss_ss: 1.419997, loss_d: 0.426009
0.5383 --- loss: 1.718017, loss_ss: 1.282370, loss_d: 0.435647
0.5767 --- loss: 2.090279, loss_ss: 1.553102, loss_d: 0.537177
0.6151 --- loss: 2.193324, loss_ss: 1.497938, loss_d: 0.695386
0.6536 --- loss: 1.927043, loss_ss: 1.278412, loss_d: 0.648631
0.6920 --- loss: 2.520337, loss_ss: 1.816898, loss_d: 0.703439
0.7305 --- loss: 1.767821, loss_ss: 1.241876, loss_d: 0.525945
0.7689 --- loss: 2.137534, loss_ss: 1.570876, loss_d: 0.566658
0.8074 --- loss: 1.918313, loss_ss: 1.441816, loss_d: 0.476497
0.8458 --- loss: 1.767631, loss_ss: 1.419708, loss_d: 0.347923
0.8843 --- loss: 1.937268, loss_ss: 1.527467, loss_d: 0.409801
0.9227 --- loss: 1.773690, loss_ss: 1.114345, loss_d: 0.659344
0.9612 --- loss: 1.863784, loss_ss: 1.456419, loss_d: 0.407365
0.9996 --- loss: 2.718380, loss_ss: 1.365269, loss_d: 1.353111
Epoch finished! Loss: 1.9806714039582474
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.841116, loss_ss: 1.412248, loss_d: 0.428868
0.0384 --- loss: 1.937235, loss_ss: 1.383720, loss_d: 0.553514
0.0769 --- loss: 1.919953, loss_ss: 1.322291, loss_d: 0.597662
0.1153 --- loss: 2.365805, loss_ss: 1.694755, loss_d: 0.671050
0.1538 --- loss: 1.709036, loss_ss: 1.172181, loss_d: 0.536854
0.1922 --- loss: 1.719779, loss_ss: 1.149767, loss_d: 0.570012
0.2307 --- loss: 1.766842, loss_ss: 1.315469, loss_d: 0.451373
0.2691 --- loss: 1.567878, loss_ss: 1.140500, loss_d: 0.427377
0.3076 --- loss: 2.332892, loss_ss: 1.383255, loss_d: 0.949637
0.3460 --- loss: 1.915444, loss_ss: 1.296304, loss_d: 0.619139
0.3845 --- loss: 1.883020, loss_ss: 1.257743, loss_d: 0.625277
0.4229 --- loss: 2.004756, loss_ss: 1.548962, loss_d: 0.455794
0.4614 --- loss: 2.209474, loss_ss: 1.493762, loss_d: 0.715712
0.4998 --- loss: 1.889700, loss_ss: 1.057751, loss_d: 0.831949
0.5383 --- loss: 1.654911, loss_ss: 1.121475, loss_d: 0.533436
0.5767 --- loss: 1.795102, loss_ss: 1.400931, loss_d: 0.394172
0.6151 --- loss: 1.505327, loss_ss: 1.127023, loss_d: 0.378303
0.6536 --- loss: 1.642299, loss_ss: 1.247108, loss_d: 0.395191
0.6920 --- loss: 1.739304, loss_ss: 1.255894, loss_d: 0.483410
0.7305 --- loss: 1.651265, loss_ss: 1.250723, loss_d: 0.400542
0.7689 --- loss: 1.681802, loss_ss: 1.146701, loss_d: 0.535102
0.8074 --- loss: 1.703996, loss_ss: 1.236061, loss_d: 0.467935
0.8458 --- loss: 2.112063, loss_ss: 1.503446, loss_d: 0.608617
0.8843 --- loss: 1.825190, loss_ss: 1.309505, loss_d: 0.515685
0.9227 --- loss: 1.650729, loss_ss: 1.249776, loss_d: 0.400954
0.9612 --- loss: 1.917491, loss_ss: 1.313474, loss_d: 0.604017
0.9996 --- loss: 3.238913, loss_ss: 1.097823, loss_d: 2.141090
Epoch finished! Loss: 1.873072754419767
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.548417, loss_ss: 1.216409, loss_d: 0.332008
0.0384 --- loss: 1.807476, loss_ss: 1.346086, loss_d: 0.461391
0.0769 --- loss: 1.798837, loss_ss: 1.335309, loss_d: 0.463528
0.1153 --- loss: 1.925473, loss_ss: 1.411191, loss_d: 0.514281
0.1538 --- loss: 1.454169, loss_ss: 1.175420, loss_d: 0.278750
0.1922 --- loss: 1.885664, loss_ss: 1.505859, loss_d: 0.379805
0.2307 --- loss: 1.683816, loss_ss: 1.336049, loss_d: 0.347767
0.2691 --- loss: 1.583699, loss_ss: 1.252429, loss_d: 0.331270
0.3076 --- loss: 1.808342, loss_ss: 1.154031, loss_d: 0.654311
0.3460 --- loss: 1.839982, loss_ss: 1.181436, loss_d: 0.658546
0.3845 --- loss: 1.640065, loss_ss: 1.208476, loss_d: 0.431589
0.4229 --- loss: 1.622612, loss_ss: 1.224072, loss_d: 0.398540
0.4614 --- loss: 1.585896, loss_ss: 1.054981, loss_d: 0.530915
0.4998 --- loss: 1.674972, loss_ss: 1.251776, loss_d: 0.423196
0.5383 --- loss: 1.510210, loss_ss: 1.221648, loss_d: 0.288562
0.5767 --- loss: 1.578435, loss_ss: 1.176798, loss_d: 0.401637
0.6151 --- loss: 1.560640, loss_ss: 1.297927, loss_d: 0.262713
0.6536 --- loss: 1.681389, loss_ss: 1.280523, loss_d: 0.400865
0.6920 --- loss: 1.852309, loss_ss: 1.337459, loss_d: 0.514849
0.7305 --- loss: 1.848693, loss_ss: 1.286790, loss_d: 0.561904
0.7689 --- loss: 1.816461, loss_ss: 1.250657, loss_d: 0.565804
0.8074 --- loss: 1.756257, loss_ss: 1.301191, loss_d: 0.455066
0.8458 --- loss: 1.546092, loss_ss: 1.166462, loss_d: 0.379630
0.8843 --- loss: 1.848711, loss_ss: 1.262320, loss_d: 0.586390
0.9227 --- loss: 1.763881, loss_ss: 1.199823, loss_d: 0.564058
0.9612 --- loss: 1.860784, loss_ss: 1.217614, loss_d: 0.643170
0.9996 --- loss: 2.724864, loss_ss: 1.090408, loss_d: 1.634455
Epoch finished! Loss: 1.75238435956148
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.592464, loss_ss: 1.157125, loss_d: 0.435339
0.0384 --- loss: 1.944942, loss_ss: 1.325308, loss_d: 0.619635
0.0769 --- loss: 1.434148, loss_ss: 1.091809, loss_d: 0.342339
0.1153 --- loss: 1.784823, loss_ss: 1.200090, loss_d: 0.584733
0.1538 --- loss: 1.972588, loss_ss: 1.202405, loss_d: 0.770183
0.1922 --- loss: 1.569303, loss_ss: 1.185458, loss_d: 0.383846
0.2307 --- loss: 1.660365, loss_ss: 1.201540, loss_d: 0.458826
0.2691 --- loss: 1.423560, loss_ss: 0.985275, loss_d: 0.438285
0.3076 --- loss: 1.296157, loss_ss: 1.008004, loss_d: 0.288154
0.3460 --- loss: 1.824612, loss_ss: 1.438082, loss_d: 0.386530
0.3845 --- loss: 1.662143, loss_ss: 1.306891, loss_d: 0.355252
0.4229 --- loss: 1.469595, loss_ss: 0.880738, loss_d: 0.588857
0.4614 --- loss: 1.703289, loss_ss: 1.295435, loss_d: 0.407854
0.4998 --- loss: 1.617636, loss_ss: 1.084048, loss_d: 0.533588
0.5383 --- loss: 1.884823, loss_ss: 1.107487, loss_d: 0.777336
0.5767 --- loss: 1.338310, loss_ss: 1.033964, loss_d: 0.304346
0.6151 --- loss: 1.838447, loss_ss: 1.366651, loss_d: 0.471796
0.6536 --- loss: 1.586585, loss_ss: 1.236003, loss_d: 0.350582
0.6920 --- loss: 1.420787, loss_ss: 1.065925, loss_d: 0.354863
0.7305 --- loss: 1.783498, loss_ss: 1.272438, loss_d: 0.511059
0.7689 --- loss: 1.797432, loss_ss: 1.421592, loss_d: 0.375840
0.8074 --- loss: 1.693751, loss_ss: 1.343737, loss_d: 0.350014
0.8458 --- loss: 1.369200, loss_ss: 1.030519, loss_d: 0.338681
0.8843 --- loss: 1.403605, loss_ss: 1.046888, loss_d: 0.356716
0.9227 --- loss: 1.608313, loss_ss: 1.139684, loss_d: 0.468629
0.9612 --- loss: 1.886196, loss_ss: 1.329065, loss_d: 0.557131
0.9996 --- loss: 1.472051, loss_ss: 1.151000, loss_d: 0.321051
Epoch finished! Loss: 1.6590235572594862
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.693239, loss_ss: 1.264892, loss_d: 0.428348
0.0384 --- loss: 1.464576, loss_ss: 1.039499, loss_d: 0.425076
0.0769 --- loss: 1.777921, loss_ss: 1.219021, loss_d: 0.558900
0.1153 --- loss: 1.842083, loss_ss: 1.360142, loss_d: 0.481942
0.1538 --- loss: 1.423854, loss_ss: 1.093364, loss_d: 0.330489
0.1922 --- loss: 1.458858, loss_ss: 1.055735, loss_d: 0.403122
0.2307 --- loss: 1.410344, loss_ss: 1.013750, loss_d: 0.396594
0.2691 --- loss: 1.673824, loss_ss: 1.006145, loss_d: 0.667680
0.3076 --- loss: 2.039194, loss_ss: 1.069491, loss_d: 0.969703
0.3460 --- loss: 1.687888, loss_ss: 1.073195, loss_d: 0.614692
0.3845 --- loss: 1.595316, loss_ss: 1.075382, loss_d: 0.519934
0.4229 --- loss: 1.522630, loss_ss: 1.045583, loss_d: 0.477047
0.4614 --- loss: 1.378028, loss_ss: 1.100546, loss_d: 0.277481
0.4998 --- loss: 1.343444, loss_ss: 0.933206, loss_d: 0.410238
0.5383 --- loss: 1.660677, loss_ss: 1.319347, loss_d: 0.341330
0.5767 --- loss: 1.753004, loss_ss: 1.055544, loss_d: 0.697459
0.6151 --- loss: 1.761733, loss_ss: 0.985213, loss_d: 0.776521
0.6536 --- loss: 1.574304, loss_ss: 1.246395, loss_d: 0.327909
0.6920 --- loss: 1.480192, loss_ss: 1.045627, loss_d: 0.434565
0.7305 --- loss: 1.484311, loss_ss: 1.157527, loss_d: 0.326783
0.7689 --- loss: 1.613293, loss_ss: 1.248835, loss_d: 0.364458
0.8074 --- loss: 1.569941, loss_ss: 1.012988, loss_d: 0.556953
0.8458 --- loss: 1.656366, loss_ss: 0.960332, loss_d: 0.696035
0.8843 --- loss: 1.930587, loss_ss: 1.507272, loss_d: 0.423315
0.9227 --- loss: 1.345480, loss_ss: 0.967491, loss_d: 0.377989
0.9612 --- loss: 1.308368, loss_ss: 1.007086, loss_d: 0.301282
0.9996 --- loss: 2.683446, loss_ss: 2.476104, loss_d: 0.207343
Epoch finished! Loss: 1.62489619576014
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.948131, loss_ss: 1.331190, loss_d: 0.616941
0.0384 --- loss: 2.020835, loss_ss: 1.123818, loss_d: 0.897017
0.0769 --- loss: 1.423036, loss_ss: 1.048444, loss_d: 0.374592
0.1153 --- loss: 1.348160, loss_ss: 0.987353, loss_d: 0.360806
0.1538 --- loss: 1.449699, loss_ss: 0.997614, loss_d: 0.452085
0.1922 --- loss: 1.530267, loss_ss: 1.153271, loss_d: 0.376996
0.2307 --- loss: 1.522109, loss_ss: 1.165864, loss_d: 0.356245
0.2691 --- loss: 1.306919, loss_ss: 0.843502, loss_d: 0.463417
0.3076 --- loss: 1.434281, loss_ss: 0.977984, loss_d: 0.456297
0.3460 --- loss: 1.180308, loss_ss: 0.809543, loss_d: 0.370764
0.3845 --- loss: 1.361641, loss_ss: 1.004597, loss_d: 0.357044
0.4229 --- loss: 1.293228, loss_ss: 0.951716, loss_d: 0.341512
0.4614 --- loss: 1.457148, loss_ss: 0.924486, loss_d: 0.532662
0.4998 --- loss: 1.646457, loss_ss: 1.178639, loss_d: 0.467819
0.5383 --- loss: 1.440652, loss_ss: 1.101362, loss_d: 0.339290
0.5767 --- loss: 1.523493, loss_ss: 1.084384, loss_d: 0.439109
0.6151 --- loss: 1.849393, loss_ss: 1.294218, loss_d: 0.555175
0.6536 --- loss: 1.759395, loss_ss: 1.086190, loss_d: 0.673205
0.6920 --- loss: 2.084118, loss_ss: 1.304495, loss_d: 0.779622
0.7305 --- loss: 1.584890, loss_ss: 1.092586, loss_d: 0.492305
0.7689 --- loss: 1.173510, loss_ss: 0.856786, loss_d: 0.316724
0.8074 --- loss: 1.995649, loss_ss: 1.223241, loss_d: 0.772408
0.8458 --- loss: 1.442941, loss_ss: 1.166321, loss_d: 0.276620
0.8843 --- loss: 1.529848, loss_ss: 1.211699, loss_d: 0.318149
0.9227 --- loss: 1.286685, loss_ss: 1.017337, loss_d: 0.269349
0.9612 --- loss: 1.069449, loss_ss: 0.851464, loss_d: 0.217985
0.9996 --- loss: 3.949270, loss_ss: 1.454767, loss_d: 2.494503
Epoch finished! Loss: 1.583872422346702
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.482538, loss_ss: 1.056194, loss_d: 0.426344
0.0384 --- loss: 1.456760, loss_ss: 1.177186, loss_d: 0.279574
0.0769 --- loss: 1.370476, loss_ss: 1.110104, loss_d: 0.260372
0.1153 --- loss: 1.669751, loss_ss: 1.284620, loss_d: 0.385131
0.1538 --- loss: 1.361953, loss_ss: 1.086821, loss_d: 0.275132
0.1922 --- loss: 1.293212, loss_ss: 0.929647, loss_d: 0.363565
0.2307 --- loss: 1.896066, loss_ss: 1.214294, loss_d: 0.681771
0.2691 --- loss: 1.523503, loss_ss: 1.071875, loss_d: 0.451628
0.3076 --- loss: 1.263606, loss_ss: 0.904318, loss_d: 0.359288
0.3460 --- loss: 1.686453, loss_ss: 1.460371, loss_d: 0.226082
0.3845 --- loss: 1.307193, loss_ss: 0.953870, loss_d: 0.353324
0.4229 --- loss: 1.142175, loss_ss: 0.897156, loss_d: 0.245018
0.4614 --- loss: 1.462409, loss_ss: 1.074966, loss_d: 0.387443
0.4998 --- loss: 1.364340, loss_ss: 1.029352, loss_d: 0.334988
0.5383 --- loss: 1.540654, loss_ss: 1.293754, loss_d: 0.246900
0.5767 --- loss: 2.106237, loss_ss: 1.561388, loss_d: 0.544849
0.6151 --- loss: 1.358413, loss_ss: 0.892909, loss_d: 0.465504
0.6536 --- loss: 1.510351, loss_ss: 1.116655, loss_d: 0.393696
0.6920 --- loss: 1.900343, loss_ss: 1.239069, loss_d: 0.661274
0.7305 --- loss: 1.263204, loss_ss: 0.930089, loss_d: 0.333116
0.7689 --- loss: 1.813745, loss_ss: 1.218086, loss_d: 0.595659
0.8074 --- loss: 1.844729, loss_ss: 1.216088, loss_d: 0.628641
0.8458 --- loss: 1.726070, loss_ss: 0.986075, loss_d: 0.739995
0.8843 --- loss: 1.499533, loss_ss: 1.101250, loss_d: 0.398284
0.9227 --- loss: 1.221860, loss_ss: 0.910423, loss_d: 0.311437
0.9612 --- loss: 1.437941, loss_ss: 1.014729, loss_d: 0.423212
0.9996 --- loss: 1.332094, loss_ss: 1.185259, loss_d: 0.146835
Epoch finished! Loss: 1.5676948909576123
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.621234, loss_ss: 1.221685, loss_d: 0.399549
0.0384 --- loss: 1.316672, loss_ss: 0.963564, loss_d: 0.353108
0.0769 --- loss: 1.343991, loss_ss: 1.046790, loss_d: 0.297200
0.1153 --- loss: 1.685801, loss_ss: 1.408017, loss_d: 0.277784
0.1538 --- loss: 1.625108, loss_ss: 1.423928, loss_d: 0.201180
0.1922 --- loss: 1.784039, loss_ss: 1.118649, loss_d: 0.665389
0.2307 --- loss: 1.279660, loss_ss: 0.865557, loss_d: 0.414103
0.2691 --- loss: 1.461687, loss_ss: 1.052718, loss_d: 0.408969
0.3076 --- loss: 1.520067, loss_ss: 1.128359, loss_d: 0.391708
0.3460 --- loss: 1.659248, loss_ss: 0.930341, loss_d: 0.728907
0.3845 --- loss: 1.754473, loss_ss: 1.214178, loss_d: 0.540295
0.4229 --- loss: 1.531565, loss_ss: 1.181824, loss_d: 0.349741
0.4614 --- loss: 1.509758, loss_ss: 1.112563, loss_d: 0.397194
0.4998 --- loss: 1.775165, loss_ss: 1.193193, loss_d: 0.581972
0.5383 --- loss: 1.429173, loss_ss: 1.107794, loss_d: 0.321379
0.5767 --- loss: 1.814284, loss_ss: 1.010166, loss_d: 0.804118
0.6151 --- loss: 1.144314, loss_ss: 0.747069, loss_d: 0.397245
0.6536 --- loss: 1.277573, loss_ss: 0.898807, loss_d: 0.378766
0.6920 --- loss: 1.406839, loss_ss: 1.066892, loss_d: 0.339947
0.7305 --- loss: 1.892428, loss_ss: 1.059389, loss_d: 0.833039
0.7689 --- loss: 1.484692, loss_ss: 1.062896, loss_d: 0.421796
0.8074 --- loss: 2.011266, loss_ss: 1.349547, loss_d: 0.661719
0.8458 --- loss: 1.297135, loss_ss: 0.897185, loss_d: 0.399950
0.8843 --- loss: 1.647790, loss_ss: 1.042526, loss_d: 0.605264
0.9227 --- loss: 1.386903, loss_ss: 0.949818, loss_d: 0.437085
0.9612 --- loss: 1.172464, loss_ss: 0.929169, loss_d: 0.243295
0.9996 --- loss: 2.433165, loss_ss: 2.349427, loss_d: 0.083738
Epoch finished! Loss: 1.5452394114090846
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.669547, loss_ss: 1.110385, loss_d: 0.559163
0.0384 --- loss: 1.778814, loss_ss: 1.382994, loss_d: 0.395820
0.0769 --- loss: 1.274317, loss_ss: 1.020264, loss_d: 0.254053
0.1153 --- loss: 1.257548, loss_ss: 0.988405, loss_d: 0.269143
0.1538 --- loss: 1.551250, loss_ss: 1.099642, loss_d: 0.451608
0.1922 --- loss: 1.754408, loss_ss: 1.198837, loss_d: 0.555572
0.2307 --- loss: 1.372450, loss_ss: 0.917918, loss_d: 0.454532
0.2691 --- loss: 1.187593, loss_ss: 0.946904, loss_d: 0.240689
0.3076 --- loss: 1.575136, loss_ss: 0.915857, loss_d: 0.659279
0.3460 --- loss: 2.029997, loss_ss: 0.841935, loss_d: 1.188062
0.3845 --- loss: 1.713137, loss_ss: 1.277128, loss_d: 0.436010
0.4229 --- loss: 1.858680, loss_ss: 1.216780, loss_d: 0.641899
0.4614 --- loss: 1.709170, loss_ss: 1.240125, loss_d: 0.469044
0.4998 --- loss: 1.316938, loss_ss: 1.049842, loss_d: 0.267095
0.5383 --- loss: 1.394932, loss_ss: 1.030547, loss_d: 0.364385
0.5767 --- loss: 1.543907, loss_ss: 1.177008, loss_d: 0.366899
0.6151 --- loss: 1.965509, loss_ss: 1.609667, loss_d: 0.355842
0.6536 --- loss: 1.558959, loss_ss: 1.226295, loss_d: 0.332664
0.6920 --- loss: 1.154439, loss_ss: 0.880594, loss_d: 0.273845
0.7305 --- loss: 1.320464, loss_ss: 0.976888, loss_d: 0.343576
0.7689 --- loss: 1.387705, loss_ss: 1.029057, loss_d: 0.358649
0.8074 --- loss: 1.300406, loss_ss: 0.919513, loss_d: 0.380893
0.8458 --- loss: 1.256477, loss_ss: 1.012879, loss_d: 0.243597
0.8843 --- loss: 1.809208, loss_ss: 0.998212, loss_d: 0.810996
0.9227 --- loss: 1.776032, loss_ss: 1.077640, loss_d: 0.698392
0.9612 --- loss: 1.359877, loss_ss: 0.843288, loss_d: 0.516588
0.9996 --- loss: 1.272317, loss_ss: 1.128840, loss_d: 0.143477
Epoch finished! Loss: 1.5361284962067236
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5837837837837838
             precision    recall  f1-score   support

        0.0       0.54      0.69      0.61       138
        1.0       0.00      0.00      0.00       123
        2.0       0.22      0.69      0.34       120
        3.0       0.90      0.92      0.91       363
        4.0       0.71      0.37      0.49       366

avg / total       0.62      0.58      0.57      1110
 


====== chp018-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  88.83  68.84   91.67  53.98     60.51
1  88.92   0.00  100.00   0.00      0.00
2  70.63  69.17   70.81  22.31     33.74
3  94.14  92.29   95.05  90.05     91.16
4  74.23  36.89   92.61  71.05     48.56
Total accuracy: 58.38%
Average sen: 53.44%
Average spec: 90.03%
Macro f1-score: 46.79%
[0.90403873 0.89870262 0.89996511 0.90232348 0.90391141 0.89759624
 0.89478153 0.8942101  0.90562159 0.90519398 0.90350437 0.90439135
 0.90560603 0.90074438 0.90497148 0.90485775 0.90303534 0.90622103
 0.90537125 0.89932668 0.90824687 0.90770298 0.90162247 0.90077037
 0.89621919 0.90489548 0.90264642 0.90066427 0.90567559 0.90768307
 0.90782863 0.90053171 0.9032706  0.90342641 0.89861745 0.90235907
 0.90177107]
pred: 0.902656922469268, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.482896, loss_ss: 1.716233, loss_d: 0.766663
0.0384 --- loss: 2.520943, loss_ss: 1.556233, loss_d: 0.964709
0.0767 --- loss: 2.216351, loss_ss: 1.641525, loss_d: 0.574826
0.1151 --- loss: 2.422342, loss_ss: 1.814482, loss_d: 0.607860
0.1534 --- loss: 1.938323, loss_ss: 1.404565, loss_d: 0.533758
0.1918 --- loss: 2.035617, loss_ss: 1.673829, loss_d: 0.361788
0.2301 --- loss: 1.895065, loss_ss: 1.555691, loss_d: 0.339374
0.2685 --- loss: 2.097373, loss_ss: 1.598782, loss_d: 0.498591
0.3069 --- loss: 2.112840, loss_ss: 1.588026, loss_d: 0.524814
0.3452 --- loss: 2.180849, loss_ss: 1.520230, loss_d: 0.660619
0.3836 --- loss: 2.017475, loss_ss: 1.500105, loss_d: 0.517371
0.4219 --- loss: 2.132408, loss_ss: 1.573667, loss_d: 0.558741
0.4603 --- loss: 2.219954, loss_ss: 1.479173, loss_d: 0.740781
0.4987 --- loss: 1.994756, loss_ss: 1.507761, loss_d: 0.486994
0.5370 --- loss: 2.003398, loss_ss: 1.615915, loss_d: 0.387483
0.5754 --- loss: 1.966493, loss_ss: 1.679601, loss_d: 0.286892
0.6137 --- loss: 2.029465, loss_ss: 1.438523, loss_d: 0.590943
0.6521 --- loss: 1.991534, loss_ss: 1.504532, loss_d: 0.487002
0.6904 --- loss: 2.087989, loss_ss: 1.583623, loss_d: 0.504366
0.7288 --- loss: 2.154283, loss_ss: 1.575361, loss_d: 0.578922
0.7672 --- loss: 1.842066, loss_ss: 1.457152, loss_d: 0.384914
0.8055 --- loss: 2.001746, loss_ss: 1.486115, loss_d: 0.515631
0.8439 --- loss: 2.004736, loss_ss: 1.548199, loss_d: 0.456537
0.8822 --- loss: 1.829480, loss_ss: 1.528320, loss_d: 0.301160
0.9206 --- loss: 2.382912, loss_ss: 1.529657, loss_d: 0.853255
0.9590 --- loss: 2.080011, loss_ss: 1.482162, loss_d: 0.597849
0.9973 --- loss: 2.221041, loss_ss: 1.456895, loss_d: 0.764146
Epoch finished! Loss: 2.0939469057780045
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.829091, loss_ss: 1.367431, loss_d: 0.461660
0.0384 --- loss: 1.833919, loss_ss: 1.373447, loss_d: 0.460471
0.0767 --- loss: 1.863812, loss_ss: 1.483421, loss_d: 0.380391
0.1151 --- loss: 1.926526, loss_ss: 1.468988, loss_d: 0.457539
0.1534 --- loss: 2.143035, loss_ss: 1.731182, loss_d: 0.411853
0.1918 --- loss: 1.750107, loss_ss: 1.364343, loss_d: 0.385764
0.2301 --- loss: 1.888542, loss_ss: 1.391395, loss_d: 0.497147
0.2685 --- loss: 1.827734, loss_ss: 1.375532, loss_d: 0.452202
0.3069 --- loss: 1.993147, loss_ss: 1.379454, loss_d: 0.613694
0.3452 --- loss: 1.912670, loss_ss: 1.415279, loss_d: 0.497391
0.3836 --- loss: 2.341022, loss_ss: 1.705884, loss_d: 0.635137
0.4219 --- loss: 1.783585, loss_ss: 1.439856, loss_d: 0.343729
0.4603 --- loss: 1.755292, loss_ss: 1.375177, loss_d: 0.380114
0.4987 --- loss: 2.119224, loss_ss: 1.385458, loss_d: 0.733766
0.5370 --- loss: 1.985504, loss_ss: 1.583263, loss_d: 0.402241
0.5754 --- loss: 2.133825, loss_ss: 1.551270, loss_d: 0.582555
0.6137 --- loss: 2.039395, loss_ss: 1.488131, loss_d: 0.551264
0.6521 --- loss: 2.012805, loss_ss: 1.641576, loss_d: 0.371229
0.6904 --- loss: 2.614336, loss_ss: 1.544983, loss_d: 1.069354
0.7288 --- loss: 1.796779, loss_ss: 1.487185, loss_d: 0.309594
0.7672 --- loss: 2.134188, loss_ss: 1.654483, loss_d: 0.479705
0.8055 --- loss: 1.808079, loss_ss: 1.407411, loss_d: 0.400669
0.8439 --- loss: 2.082112, loss_ss: 1.427244, loss_d: 0.654868
0.8822 --- loss: 2.003318, loss_ss: 1.562176, loss_d: 0.441142
0.9206 --- loss: 2.035200, loss_ss: 1.674976, loss_d: 0.360224
0.9590 --- loss: 1.981608, loss_ss: 1.508212, loss_d: 0.473396
0.9973 --- loss: 2.233002, loss_ss: 1.504881, loss_d: 0.728121
Epoch finished! Loss: 1.9800409243657038
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.827734, loss_ss: 1.503891, loss_d: 0.323843
0.0384 --- loss: 1.803531, loss_ss: 1.244746, loss_d: 0.558785
0.0767 --- loss: 1.881660, loss_ss: 1.441621, loss_d: 0.440039
0.1151 --- loss: 1.722658, loss_ss: 1.236328, loss_d: 0.486330
0.1534 --- loss: 2.022382, loss_ss: 1.668206, loss_d: 0.354176
0.1918 --- loss: 1.777296, loss_ss: 1.457794, loss_d: 0.319502
0.2301 --- loss: 2.003309, loss_ss: 1.417050, loss_d: 0.586259
0.2685 --- loss: 2.074630, loss_ss: 1.457272, loss_d: 0.617357
0.3069 --- loss: 1.583718, loss_ss: 1.218803, loss_d: 0.364915
0.3452 --- loss: 2.696746, loss_ss: 1.607236, loss_d: 1.089510
0.3836 --- loss: 1.825269, loss_ss: 1.209898, loss_d: 0.615372
0.4219 --- loss: 1.989686, loss_ss: 1.517729, loss_d: 0.471958
0.4603 --- loss: 1.927326, loss_ss: 1.381956, loss_d: 0.545371
0.4987 --- loss: 2.294828, loss_ss: 1.557882, loss_d: 0.736946
0.5370 --- loss: 1.655415, loss_ss: 1.322491, loss_d: 0.332925
0.5754 --- loss: 1.995002, loss_ss: 1.326769, loss_d: 0.668232
0.6137 --- loss: 1.819773, loss_ss: 1.370289, loss_d: 0.449484
0.6521 --- loss: 1.615460, loss_ss: 1.242977, loss_d: 0.372483
0.6904 --- loss: 1.860001, loss_ss: 1.471923, loss_d: 0.388078
0.7288 --- loss: 1.781048, loss_ss: 1.145574, loss_d: 0.635474
0.7672 --- loss: 1.984471, loss_ss: 1.509361, loss_d: 0.475110
0.8055 --- loss: 1.908836, loss_ss: 1.379377, loss_d: 0.529459
0.8439 --- loss: 1.784929, loss_ss: 1.467085, loss_d: 0.317844
0.8822 --- loss: 1.720827, loss_ss: 1.284000, loss_d: 0.436827
0.9206 --- loss: 1.856924, loss_ss: 1.456402, loss_d: 0.400523
0.9590 --- loss: 2.038083, loss_ss: 1.294711, loss_d: 0.743372
0.9973 --- loss: 1.618174, loss_ss: 1.314046, loss_d: 0.304128
Epoch finished! Loss: 1.9170424355910374
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.701795, loss_ss: 1.352277, loss_d: 0.349517
0.0384 --- loss: 2.124664, loss_ss: 1.554000, loss_d: 0.570664
0.0767 --- loss: 2.026004, loss_ss: 1.333990, loss_d: 0.692015
0.1151 --- loss: 2.176855, loss_ss: 1.406896, loss_d: 0.769959
0.1534 --- loss: 1.729772, loss_ss: 1.260008, loss_d: 0.469764
0.1918 --- loss: 1.615926, loss_ss: 1.266301, loss_d: 0.349625
0.2301 --- loss: 1.778708, loss_ss: 1.418353, loss_d: 0.360355
0.2685 --- loss: 1.780130, loss_ss: 1.372739, loss_d: 0.407390
0.3069 --- loss: 1.801674, loss_ss: 1.440999, loss_d: 0.360675
0.3452 --- loss: 2.067870, loss_ss: 1.411053, loss_d: 0.656817
0.3836 --- loss: 2.025110, loss_ss: 1.385484, loss_d: 0.639625
0.4219 --- loss: 2.151906, loss_ss: 1.598433, loss_d: 0.553474
0.4603 --- loss: 2.272655, loss_ss: 1.304946, loss_d: 0.967709
0.4987 --- loss: 1.752188, loss_ss: 1.172578, loss_d: 0.579610
0.5370 --- loss: 1.847482, loss_ss: 1.401533, loss_d: 0.445949
0.5754 --- loss: 1.947413, loss_ss: 1.370906, loss_d: 0.576508
0.6137 --- loss: 1.675716, loss_ss: 1.334385, loss_d: 0.341331
0.6521 --- loss: 1.543677, loss_ss: 1.158095, loss_d: 0.385582
0.6904 --- loss: 1.966041, loss_ss: 1.442571, loss_d: 0.523471
0.7288 --- loss: 2.119869, loss_ss: 1.423998, loss_d: 0.695872
0.7672 --- loss: 1.781106, loss_ss: 1.245505, loss_d: 0.535601
0.8055 --- loss: 2.064410, loss_ss: 1.483742, loss_d: 0.580668
0.8439 --- loss: 1.703202, loss_ss: 1.208995, loss_d: 0.494207
0.8822 --- loss: 1.798337, loss_ss: 1.397134, loss_d: 0.401204
0.9206 --- loss: 1.968163, loss_ss: 1.585938, loss_d: 0.382225
0.9590 --- loss: 2.367713, loss_ss: 1.391260, loss_d: 0.976453
0.9973 --- loss: 1.947170, loss_ss: 1.434415, loss_d: 0.512755
Epoch finished! Loss: 1.9077298521995545
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.540081, loss_ss: 1.217117, loss_d: 0.322964
0.0384 --- loss: 1.943928, loss_ss: 1.446996, loss_d: 0.496932
0.0767 --- loss: 1.820146, loss_ss: 1.359071, loss_d: 0.461076
0.1151 --- loss: 1.856002, loss_ss: 1.498719, loss_d: 0.357283
0.1534 --- loss: 1.779903, loss_ss: 1.287375, loss_d: 0.492528
0.1918 --- loss: 1.871307, loss_ss: 1.308754, loss_d: 0.562552
0.2301 --- loss: 2.193877, loss_ss: 1.612470, loss_d: 0.581407
0.2685 --- loss: 1.757227, loss_ss: 1.376726, loss_d: 0.380501
0.3069 --- loss: 2.061646, loss_ss: 1.430588, loss_d: 0.631057
0.3452 --- loss: 1.783254, loss_ss: 1.336101, loss_d: 0.447153
0.3836 --- loss: 1.731615, loss_ss: 1.260778, loss_d: 0.470837
0.4219 --- loss: 1.898358, loss_ss: 1.403001, loss_d: 0.495356
0.4603 --- loss: 1.898456, loss_ss: 1.255511, loss_d: 0.642945
0.4987 --- loss: 2.375453, loss_ss: 1.574954, loss_d: 0.800500
0.5370 --- loss: 1.913674, loss_ss: 1.297979, loss_d: 0.615695
0.5754 --- loss: 1.645296, loss_ss: 1.212733, loss_d: 0.432564
0.6137 --- loss: 1.739611, loss_ss: 1.351320, loss_d: 0.388291
0.6521 --- loss: 1.787171, loss_ss: 1.243369, loss_d: 0.543802
0.6904 --- loss: 1.962447, loss_ss: 1.618640, loss_d: 0.343807
0.7288 --- loss: 1.644119, loss_ss: 1.235749, loss_d: 0.408370
0.7672 --- loss: 1.862181, loss_ss: 1.540577, loss_d: 0.321604
0.8055 --- loss: 1.835990, loss_ss: 1.502301, loss_d: 0.333689
0.8439 --- loss: 1.821990, loss_ss: 1.239548, loss_d: 0.582443
0.8822 --- loss: 1.866867, loss_ss: 1.294440, loss_d: 0.572427
0.9206 --- loss: 1.751458, loss_ss: 1.373933, loss_d: 0.377525
0.9590 --- loss: 1.544384, loss_ss: 1.243325, loss_d: 0.301058
0.9973 --- loss: 1.865787, loss_ss: 1.616265, loss_d: 0.249522
Epoch finished! Loss: 1.8713362904695363
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.722004, loss_ss: 1.277970, loss_d: 0.444034
0.0384 --- loss: 2.081333, loss_ss: 1.192469, loss_d: 0.888864
0.0767 --- loss: 1.955230, loss_ss: 1.506203, loss_d: 0.449027
0.1151 --- loss: 1.990402, loss_ss: 1.429800, loss_d: 0.560602
0.1534 --- loss: 1.639278, loss_ss: 1.156862, loss_d: 0.482416
0.1918 --- loss: 2.048619, loss_ss: 1.262054, loss_d: 0.786565
0.2301 --- loss: 1.672567, loss_ss: 1.417570, loss_d: 0.254997
0.2685 --- loss: 1.616580, loss_ss: 1.146708, loss_d: 0.469871
0.3069 --- loss: 1.830191, loss_ss: 1.364192, loss_d: 0.465999
0.3452 --- loss: 1.383325, loss_ss: 1.064929, loss_d: 0.318397
0.3836 --- loss: 1.659600, loss_ss: 1.368028, loss_d: 0.291571
0.4219 --- loss: 2.138956, loss_ss: 1.338512, loss_d: 0.800444
0.4603 --- loss: 1.754627, loss_ss: 1.355136, loss_d: 0.399491
0.4987 --- loss: 1.640570, loss_ss: 1.348695, loss_d: 0.291875
0.5370 --- loss: 1.708483, loss_ss: 1.234613, loss_d: 0.473870
0.5754 --- loss: 1.722800, loss_ss: 1.291762, loss_d: 0.431038
0.6137 --- loss: 1.829193, loss_ss: 1.131870, loss_d: 0.697324
0.6521 --- loss: 2.019093, loss_ss: 1.337845, loss_d: 0.681247
0.6904 --- loss: 1.822735, loss_ss: 1.375092, loss_d: 0.447643
0.7288 --- loss: 1.948162, loss_ss: 1.302860, loss_d: 0.645303
0.7672 --- loss: 1.406184, loss_ss: 1.098244, loss_d: 0.307940
0.8055 --- loss: 1.772037, loss_ss: 1.229967, loss_d: 0.542070
0.8439 --- loss: 1.838047, loss_ss: 1.361460, loss_d: 0.476587
0.8822 --- loss: 1.656211, loss_ss: 1.198286, loss_d: 0.457925
0.9206 --- loss: 1.597047, loss_ss: 1.298375, loss_d: 0.298672
0.9590 --- loss: 1.649802, loss_ss: 0.887945, loss_d: 0.761857
0.9973 --- loss: 2.003472, loss_ss: 0.990169, loss_d: 1.013303
Epoch finished! Loss: 1.7682173183331122
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.727919, loss_ss: 1.146774, loss_d: 0.581144
0.0384 --- loss: 1.900418, loss_ss: 1.272253, loss_d: 0.628165
0.0767 --- loss: 2.177571, loss_ss: 1.584439, loss_d: 0.593132
0.1151 --- loss: 1.522298, loss_ss: 1.028154, loss_d: 0.494144
0.1534 --- loss: 1.801180, loss_ss: 1.416232, loss_d: 0.384948
0.1918 --- loss: 1.658341, loss_ss: 1.248192, loss_d: 0.410150
0.2301 --- loss: 1.882290, loss_ss: 1.388108, loss_d: 0.494182
0.2685 --- loss: 1.412638, loss_ss: 1.096897, loss_d: 0.315741
0.3069 --- loss: 1.331597, loss_ss: 1.016909, loss_d: 0.314688
0.3452 --- loss: 1.650468, loss_ss: 1.372184, loss_d: 0.278284
0.3836 --- loss: 1.626310, loss_ss: 1.145810, loss_d: 0.480500
0.4219 --- loss: 1.440003, loss_ss: 1.138504, loss_d: 0.301499
0.4603 --- loss: 1.878743, loss_ss: 1.206724, loss_d: 0.672019
0.4987 --- loss: 1.768522, loss_ss: 1.266104, loss_d: 0.502418
0.5370 --- loss: 1.498665, loss_ss: 1.011799, loss_d: 0.486867
0.5754 --- loss: 1.588059, loss_ss: 1.073558, loss_d: 0.514502
0.6137 --- loss: 1.883263, loss_ss: 1.377741, loss_d: 0.505521
0.6521 --- loss: 1.654123, loss_ss: 1.007015, loss_d: 0.647108
0.6904 --- loss: 1.560402, loss_ss: 1.054777, loss_d: 0.505625
0.7288 --- loss: 1.441041, loss_ss: 1.121156, loss_d: 0.319885
0.7672 --- loss: 1.542293, loss_ss: 1.286065, loss_d: 0.256229
0.8055 --- loss: 1.502999, loss_ss: 1.197931, loss_d: 0.305068
0.8439 --- loss: 1.610799, loss_ss: 1.220677, loss_d: 0.390122
0.8822 --- loss: 1.928344, loss_ss: 1.267777, loss_d: 0.660567
0.9206 --- loss: 2.045326, loss_ss: 1.254748, loss_d: 0.790578
0.9590 --- loss: 1.881576, loss_ss: 1.272387, loss_d: 0.609189
0.9973 --- loss: 2.687491, loss_ss: 1.192125, loss_d: 1.495366
Epoch finished! Loss: 1.654835648720081
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.857729, loss_ss: 1.247111, loss_d: 0.610618
0.0384 --- loss: 1.555537, loss_ss: 1.163399, loss_d: 0.392138
0.0767 --- loss: 1.883069, loss_ss: 1.112054, loss_d: 0.771015
0.1151 --- loss: 1.622346, loss_ss: 1.226987, loss_d: 0.395359
0.1534 --- loss: 1.384035, loss_ss: 1.059535, loss_d: 0.324500
0.1918 --- loss: 1.641931, loss_ss: 1.002958, loss_d: 0.638973
0.2301 --- loss: 1.830531, loss_ss: 1.267493, loss_d: 0.563038
0.2685 --- loss: 1.623839, loss_ss: 1.002952, loss_d: 0.620887
0.3069 --- loss: 1.282179, loss_ss: 0.901611, loss_d: 0.380568
0.3452 --- loss: 1.374371, loss_ss: 1.083803, loss_d: 0.290568
0.3836 --- loss: 1.549145, loss_ss: 0.989445, loss_d: 0.559700
0.4219 --- loss: 1.569440, loss_ss: 1.168399, loss_d: 0.401042
0.4603 --- loss: 1.400539, loss_ss: 0.865018, loss_d: 0.535521
0.4987 --- loss: 1.597947, loss_ss: 1.142659, loss_d: 0.455288
0.5370 --- loss: 1.544502, loss_ss: 1.004490, loss_d: 0.540013
0.5754 --- loss: 1.599215, loss_ss: 1.171288, loss_d: 0.427927
0.6137 --- loss: 1.496895, loss_ss: 1.151130, loss_d: 0.345765
0.6521 --- loss: 2.292007, loss_ss: 1.440414, loss_d: 0.851593
0.6904 --- loss: 1.470542, loss_ss: 1.067183, loss_d: 0.403359
0.7288 --- loss: 1.429622, loss_ss: 0.936106, loss_d: 0.493515
0.7672 --- loss: 1.603796, loss_ss: 1.196206, loss_d: 0.407591
0.8055 --- loss: 1.691176, loss_ss: 1.277956, loss_d: 0.413219
0.8439 --- loss: 1.772715, loss_ss: 1.463476, loss_d: 0.309239
0.8822 --- loss: 1.182282, loss_ss: 0.935807, loss_d: 0.246475
0.9206 --- loss: 1.322490, loss_ss: 1.035459, loss_d: 0.287032
0.9590 --- loss: 1.289052, loss_ss: 0.952168, loss_d: 0.336884
0.9973 --- loss: 1.974682, loss_ss: 0.951956, loss_d: 1.022726
Epoch finished! Loss: 1.5866017580032348
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 2.039774, loss_ss: 1.224592, loss_d: 0.815182
0.0384 --- loss: 1.517830, loss_ss: 0.972508, loss_d: 0.545322
0.0767 --- loss: 1.711903, loss_ss: 1.070288, loss_d: 0.641616
0.1151 --- loss: 1.725600, loss_ss: 0.918414, loss_d: 0.807186
0.1534 --- loss: 1.462775, loss_ss: 0.970324, loss_d: 0.492451
0.1918 --- loss: 1.208900, loss_ss: 0.933794, loss_d: 0.275106
0.2301 --- loss: 1.193474, loss_ss: 0.888756, loss_d: 0.304718
0.2685 --- loss: 1.602512, loss_ss: 1.231320, loss_d: 0.371192
0.3069 --- loss: 1.410846, loss_ss: 1.151718, loss_d: 0.259127
0.3452 --- loss: 1.509708, loss_ss: 1.065449, loss_d: 0.444259
0.3836 --- loss: 1.849882, loss_ss: 1.325729, loss_d: 0.524153
0.4219 --- loss: 1.740357, loss_ss: 1.218185, loss_d: 0.522172
0.4603 --- loss: 1.619408, loss_ss: 1.150768, loss_d: 0.468640
0.4987 --- loss: 1.319302, loss_ss: 0.827275, loss_d: 0.492027
0.5370 --- loss: 1.563651, loss_ss: 1.010951, loss_d: 0.552700
0.5754 --- loss: 1.633763, loss_ss: 0.963752, loss_d: 0.670011
0.6137 --- loss: 1.292211, loss_ss: 0.943100, loss_d: 0.349111
0.6521 --- loss: 1.506272, loss_ss: 1.053613, loss_d: 0.452659
0.6904 --- loss: 1.419923, loss_ss: 1.005614, loss_d: 0.414310
0.7288 --- loss: 1.404496, loss_ss: 1.035472, loss_d: 0.369024
0.7672 --- loss: 2.048206, loss_ss: 1.182361, loss_d: 0.865845
0.8055 --- loss: 1.493025, loss_ss: 1.057466, loss_d: 0.435560
0.8439 --- loss: 1.609593, loss_ss: 1.119244, loss_d: 0.490349
0.8822 --- loss: 1.359228, loss_ss: 1.010913, loss_d: 0.348315
0.9206 --- loss: 1.684823, loss_ss: 1.230738, loss_d: 0.454085
0.9590 --- loss: 1.484230, loss_ss: 0.882252, loss_d: 0.601978
0.9973 --- loss: 1.198175, loss_ss: 0.891924, loss_d: 0.306251
Epoch finished! Loss: 1.5743530676915096
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.951742, loss_ss: 1.467075, loss_d: 0.484667
0.0384 --- loss: 1.571585, loss_ss: 1.263967, loss_d: 0.307618
0.0767 --- loss: 1.670109, loss_ss: 1.285966, loss_d: 0.384143
0.1151 --- loss: 1.509974, loss_ss: 1.093864, loss_d: 0.416110
0.1534 --- loss: 1.470822, loss_ss: 1.004812, loss_d: 0.466011
0.1918 --- loss: 1.347339, loss_ss: 0.846367, loss_d: 0.500972
0.2301 --- loss: 1.860139, loss_ss: 1.369783, loss_d: 0.490356
0.2685 --- loss: 1.499843, loss_ss: 1.160771, loss_d: 0.339073
0.3069 --- loss: 1.214092, loss_ss: 0.787840, loss_d: 0.426253
0.3452 --- loss: 1.303335, loss_ss: 1.080456, loss_d: 0.222879
0.3836 --- loss: 1.685220, loss_ss: 1.095631, loss_d: 0.589589
0.4219 --- loss: 1.352325, loss_ss: 0.967344, loss_d: 0.384982
0.4603 --- loss: 1.588892, loss_ss: 1.210001, loss_d: 0.378891
0.4987 --- loss: 1.204830, loss_ss: 0.916106, loss_d: 0.288725
0.5370 --- loss: 1.366134, loss_ss: 0.904473, loss_d: 0.461661
0.5754 --- loss: 1.266443, loss_ss: 0.995491, loss_d: 0.270952
0.6137 --- loss: 1.365731, loss_ss: 0.993932, loss_d: 0.371800
0.6521 --- loss: 1.350224, loss_ss: 1.001230, loss_d: 0.348995
0.6904 --- loss: 1.685304, loss_ss: 1.194552, loss_d: 0.490752
0.7288 --- loss: 1.445832, loss_ss: 1.017500, loss_d: 0.428332
0.7672 --- loss: 1.306523, loss_ss: 0.841641, loss_d: 0.464882
0.8055 --- loss: 1.587347, loss_ss: 1.176959, loss_d: 0.410387
0.8439 --- loss: 1.266444, loss_ss: 0.890663, loss_d: 0.375780
0.8822 --- loss: 2.109977, loss_ss: 1.378921, loss_d: 0.731056
0.9206 --- loss: 1.336779, loss_ss: 1.036796, loss_d: 0.299983
0.9590 --- loss: 1.459751, loss_ss: 1.150377, loss_d: 0.309374
0.9973 --- loss: 1.276671, loss_ss: 1.108750, loss_d: 0.167921
Epoch finished! Loss: 1.537494837320768
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4344086021505376
             precision    recall  f1-score   support

        0.0       0.11      0.92      0.20        36
        1.0       0.00      0.00      0.00       112
        2.0       0.76      0.24      0.36       224
        3.0       0.93      0.84      0.88       226
        4.0       0.35      0.39      0.37       332

avg / total       0.54      0.43      0.44       930
 


====== chp019-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  72.04  91.67   71.25  11.38     20.25
1  87.96   0.00  100.00   0.00      0.00
2  79.78  23.66   97.59  75.71     36.05
3  94.52  84.07   97.87  92.68     88.17
4  52.58  38.55   60.37  35.07     36.73
Total accuracy: 43.44%
Average sen: 47.59%
Average spec: 85.42%
Macro f1-score: 36.24%
[0.98843271 0.97965288 0.96696913 0.98153424 0.9903779  0.98634952
 0.98750025 0.98711616 0.98758054 0.97933733 0.96832484 0.96956885
 0.98445165 0.98370218 0.98872608 0.9860664  0.98304647 0.9847551
 0.98319095 0.97675061 0.9685517  0.98495263 0.98854619 0.98605657
 0.98301584 0.98289943 0.98104203 0.98220003 0.99125481 0.98499358
 0.98352921]
pred: 0.9825959936265023, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.441454, loss_ss: 1.701488, loss_d: 0.739966
0.0385 --- loss: 2.471021, loss_ss: 1.977853, loss_d: 0.493169
0.0769 --- loss: 2.454636, loss_ss: 1.925729, loss_d: 0.528907
0.1154 --- loss: 2.389473, loss_ss: 1.821797, loss_d: 0.567676
0.1538 --- loss: 2.577793, loss_ss: 1.654517, loss_d: 0.923276
0.1923 --- loss: 2.180027, loss_ss: 1.704460, loss_d: 0.475568
0.2308 --- loss: 2.128202, loss_ss: 1.587991, loss_d: 0.540210
0.2692 --- loss: 2.160372, loss_ss: 1.673004, loss_d: 0.487368
0.3077 --- loss: 1.982590, loss_ss: 1.521368, loss_d: 0.461222
0.3462 --- loss: 1.985318, loss_ss: 1.589082, loss_d: 0.396236
0.3846 --- loss: 2.182827, loss_ss: 1.684527, loss_d: 0.498300
0.4231 --- loss: 2.156023, loss_ss: 1.697834, loss_d: 0.458189
0.4615 --- loss: 1.971242, loss_ss: 1.515282, loss_d: 0.455960
0.5000 --- loss: 2.792403, loss_ss: 1.605088, loss_d: 1.187315
0.5385 --- loss: 2.207427, loss_ss: 1.566381, loss_d: 0.641046
0.5769 --- loss: 1.837291, loss_ss: 1.456857, loss_d: 0.380434
0.6154 --- loss: 2.259318, loss_ss: 1.607625, loss_d: 0.651693
0.6538 --- loss: 2.306208, loss_ss: 1.523234, loss_d: 0.782974
0.6923 --- loss: 1.926290, loss_ss: 1.485739, loss_d: 0.440551
0.7308 --- loss: 2.098394, loss_ss: 1.548805, loss_d: 0.549589
0.7692 --- loss: 1.948485, loss_ss: 1.642358, loss_d: 0.306127
0.8077 --- loss: 2.011769, loss_ss: 1.375601, loss_d: 0.636168
0.8462 --- loss: 1.816887, loss_ss: 1.479390, loss_d: 0.337498
0.8846 --- loss: 2.182006, loss_ss: 1.577879, loss_d: 0.604127
0.9231 --- loss: 2.050513, loss_ss: 1.444471, loss_d: 0.606041
0.9615 --- loss: 1.895586, loss_ss: 1.403429, loss_d: 0.492157
Epoch finished! Loss: 2.1478175187202955
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.027887, loss_ss: 1.584246, loss_d: 0.443641
0.0385 --- loss: 2.060907, loss_ss: 1.677478, loss_d: 0.383428
0.0769 --- loss: 2.119212, loss_ss: 1.548997, loss_d: 0.570215
0.1154 --- loss: 2.856907, loss_ss: 1.604485, loss_d: 1.252422
0.1538 --- loss: 1.912604, loss_ss: 1.517432, loss_d: 0.395172
0.1923 --- loss: 1.993914, loss_ss: 1.385400, loss_d: 0.608514
0.2308 --- loss: 2.036554, loss_ss: 1.417692, loss_d: 0.618862
0.2692 --- loss: 1.956826, loss_ss: 1.524250, loss_d: 0.432576
0.3077 --- loss: 2.011493, loss_ss: 1.400090, loss_d: 0.611403
0.3462 --- loss: 1.931600, loss_ss: 1.497377, loss_d: 0.434223
0.3846 --- loss: 2.131230, loss_ss: 1.472087, loss_d: 0.659143
0.4231 --- loss: 2.052094, loss_ss: 1.695338, loss_d: 0.356757
0.4615 --- loss: 2.166923, loss_ss: 1.593709, loss_d: 0.573213
0.5000 --- loss: 1.958612, loss_ss: 1.478625, loss_d: 0.479987
0.5385 --- loss: 2.072544, loss_ss: 1.575756, loss_d: 0.496788
0.5769 --- loss: 2.084349, loss_ss: 1.365622, loss_d: 0.718727
0.6154 --- loss: 2.009467, loss_ss: 1.412735, loss_d: 0.596732
0.6538 --- loss: 2.311159, loss_ss: 1.398919, loss_d: 0.912240
0.6923 --- loss: 2.010081, loss_ss: 1.419533, loss_d: 0.590548
0.7308 --- loss: 1.736177, loss_ss: 1.253561, loss_d: 0.482616
0.7692 --- loss: 1.683186, loss_ss: 1.240192, loss_d: 0.442994
0.8077 --- loss: 1.942314, loss_ss: 1.480801, loss_d: 0.461513
0.8462 --- loss: 2.113247, loss_ss: 1.644023, loss_d: 0.469224
0.8846 --- loss: 1.867661, loss_ss: 1.561823, loss_d: 0.305837
0.9231 --- loss: 1.933353, loss_ss: 1.475596, loss_d: 0.457757
0.9615 --- loss: 1.795662, loss_ss: 1.472908, loss_d: 0.322754
Epoch finished! Loss: 1.9896699489313663
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.191179, loss_ss: 1.630372, loss_d: 0.560807
0.0385 --- loss: 1.868656, loss_ss: 1.522665, loss_d: 0.345991
0.0769 --- loss: 1.887630, loss_ss: 1.451267, loss_d: 0.436363
0.1154 --- loss: 2.224685, loss_ss: 1.364483, loss_d: 0.860202
0.1538 --- loss: 2.019774, loss_ss: 1.510287, loss_d: 0.509487
0.1923 --- loss: 1.936606, loss_ss: 1.386930, loss_d: 0.549676
0.2308 --- loss: 1.873835, loss_ss: 1.518858, loss_d: 0.354977
0.2692 --- loss: 1.736935, loss_ss: 1.398020, loss_d: 0.338916
0.3077 --- loss: 1.904620, loss_ss: 1.384819, loss_d: 0.519801
0.3462 --- loss: 1.839129, loss_ss: 1.306406, loss_d: 0.532723
0.3846 --- loss: 1.840432, loss_ss: 1.386500, loss_d: 0.453933
0.4231 --- loss: 2.173615, loss_ss: 1.517384, loss_d: 0.656230
0.4615 --- loss: 1.777123, loss_ss: 1.424637, loss_d: 0.352486
0.5000 --- loss: 1.970964, loss_ss: 1.492893, loss_d: 0.478072
0.5385 --- loss: 1.902090, loss_ss: 1.389919, loss_d: 0.512171
0.5769 --- loss: 1.814564, loss_ss: 1.172115, loss_d: 0.642449
0.6154 --- loss: 1.930101, loss_ss: 1.403214, loss_d: 0.526888
0.6538 --- loss: 1.666317, loss_ss: 1.216475, loss_d: 0.449842
0.6923 --- loss: 2.007034, loss_ss: 1.310803, loss_d: 0.696231
0.7308 --- loss: 1.912443, loss_ss: 1.504192, loss_d: 0.408251
0.7692 --- loss: 1.725132, loss_ss: 1.132569, loss_d: 0.592563
0.8077 --- loss: 1.739766, loss_ss: 1.285432, loss_d: 0.454334
0.8462 --- loss: 1.645552, loss_ss: 1.278414, loss_d: 0.367139
0.8846 --- loss: 1.740038, loss_ss: 1.303367, loss_d: 0.436671
0.9231 --- loss: 1.881416, loss_ss: 1.486094, loss_d: 0.395322
0.9615 --- loss: 1.888804, loss_ss: 1.322330, loss_d: 0.566474
Epoch finished! Loss: 1.9276434436267869
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.893206, loss_ss: 1.309165, loss_d: 0.584041
0.0385 --- loss: 1.631334, loss_ss: 1.274655, loss_d: 0.356679
0.0769 --- loss: 1.807888, loss_ss: 1.418174, loss_d: 0.389714
0.1154 --- loss: 2.134024, loss_ss: 1.409261, loss_d: 0.724764
0.1538 --- loss: 2.039882, loss_ss: 1.639768, loss_d: 0.400114
0.1923 --- loss: 1.645352, loss_ss: 1.285165, loss_d: 0.360188
0.2308 --- loss: 1.789005, loss_ss: 1.486052, loss_d: 0.302953
0.2692 --- loss: 1.889349, loss_ss: 1.226378, loss_d: 0.662971
0.3077 --- loss: 2.091759, loss_ss: 1.362155, loss_d: 0.729604
0.3462 --- loss: 1.709349, loss_ss: 1.300847, loss_d: 0.408502
0.3846 --- loss: 1.729604, loss_ss: 1.229829, loss_d: 0.499775
0.4231 --- loss: 2.101075, loss_ss: 1.490417, loss_d: 0.610658
0.4615 --- loss: 1.627453, loss_ss: 1.270788, loss_d: 0.356664
0.5000 --- loss: 2.213315, loss_ss: 1.333497, loss_d: 0.879818
0.5385 --- loss: 1.913598, loss_ss: 1.324930, loss_d: 0.588668
0.5769 --- loss: 1.985667, loss_ss: 1.612547, loss_d: 0.373120
0.6154 --- loss: 1.763211, loss_ss: 1.384451, loss_d: 0.378760
0.6538 --- loss: 1.838886, loss_ss: 1.440114, loss_d: 0.398772
0.6923 --- loss: 1.947790, loss_ss: 1.506731, loss_d: 0.441059
0.7308 --- loss: 1.626036, loss_ss: 1.288027, loss_d: 0.338009
0.7692 --- loss: 2.163160, loss_ss: 1.385613, loss_d: 0.777547
0.8077 --- loss: 1.975242, loss_ss: 1.596031, loss_d: 0.379211
0.8462 --- loss: 1.668093, loss_ss: 1.301632, loss_d: 0.366461
0.8846 --- loss: 1.950706, loss_ss: 1.489361, loss_d: 0.461345
0.9231 --- loss: 1.660124, loss_ss: 1.276612, loss_d: 0.383512
0.9615 --- loss: 1.826284, loss_ss: 1.371485, loss_d: 0.454799
Epoch finished! Loss: 1.89252693634696
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.366805, loss_ss: 1.598523, loss_d: 0.768283
0.0385 --- loss: 2.012921, loss_ss: 1.254453, loss_d: 0.758468
0.0769 --- loss: 1.635830, loss_ss: 1.324242, loss_d: 0.311588
0.1154 --- loss: 1.987869, loss_ss: 1.545752, loss_d: 0.442117
0.1538 --- loss: 2.240296, loss_ss: 1.373135, loss_d: 0.867161
0.1923 --- loss: 1.627159, loss_ss: 1.256086, loss_d: 0.371073
0.2308 --- loss: 1.609511, loss_ss: 1.273934, loss_d: 0.335577
0.2692 --- loss: 2.071223, loss_ss: 1.434898, loss_d: 0.636325
0.3077 --- loss: 2.145547, loss_ss: 1.308443, loss_d: 0.837103
0.3462 --- loss: 1.790572, loss_ss: 1.385021, loss_d: 0.405550
0.3846 --- loss: 2.114542, loss_ss: 1.500590, loss_d: 0.613952
0.4231 --- loss: 1.944935, loss_ss: 1.462533, loss_d: 0.482403
0.4615 --- loss: 1.988602, loss_ss: 1.425401, loss_d: 0.563201
0.5000 --- loss: 1.960354, loss_ss: 1.544058, loss_d: 0.416295
0.5385 --- loss: 1.606031, loss_ss: 1.219418, loss_d: 0.386613
0.5769 --- loss: 1.757484, loss_ss: 1.364474, loss_d: 0.393010
0.6154 --- loss: 2.010509, loss_ss: 1.427790, loss_d: 0.582719
0.6538 --- loss: 1.822065, loss_ss: 1.333247, loss_d: 0.488817
0.6923 --- loss: 1.641616, loss_ss: 1.321754, loss_d: 0.319862
0.7308 --- loss: 1.855347, loss_ss: 1.295720, loss_d: 0.559627
0.7692 --- loss: 1.501915, loss_ss: 1.187390, loss_d: 0.314525
0.8077 --- loss: 1.775336, loss_ss: 1.382684, loss_d: 0.392652
0.8462 --- loss: 1.663310, loss_ss: 1.182814, loss_d: 0.480496
0.8846 --- loss: 1.655113, loss_ss: 1.208332, loss_d: 0.446781
0.9231 --- loss: 1.740845, loss_ss: 1.317448, loss_d: 0.423398
0.9615 --- loss: 1.534488, loss_ss: 1.123577, loss_d: 0.410911
Epoch finished! Loss: 1.8391036237068619
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.813667, loss_ss: 1.214192, loss_d: 0.599475
0.0385 --- loss: 1.880457, loss_ss: 1.316649, loss_d: 0.563808
0.0769 --- loss: 1.876898, loss_ss: 1.361635, loss_d: 0.515263
0.1154 --- loss: 1.736832, loss_ss: 1.315152, loss_d: 0.421680
0.1538 --- loss: 1.744851, loss_ss: 1.150367, loss_d: 0.594484
0.1923 --- loss: 1.592373, loss_ss: 1.266319, loss_d: 0.326055
0.2308 --- loss: 1.394746, loss_ss: 1.134250, loss_d: 0.260495
0.2692 --- loss: 1.950321, loss_ss: 1.299947, loss_d: 0.650374
0.3077 --- loss: 1.730635, loss_ss: 1.438891, loss_d: 0.291744
0.3462 --- loss: 1.780743, loss_ss: 1.269671, loss_d: 0.511072
0.3846 --- loss: 1.539128, loss_ss: 1.118397, loss_d: 0.420730
0.4231 --- loss: 2.014077, loss_ss: 1.700888, loss_d: 0.313189
0.4615 --- loss: 1.832747, loss_ss: 1.010615, loss_d: 0.822133
0.5000 --- loss: 1.361743, loss_ss: 1.062905, loss_d: 0.298838
0.5385 --- loss: 1.572938, loss_ss: 1.319796, loss_d: 0.253142
0.5769 --- loss: 1.686224, loss_ss: 1.222445, loss_d: 0.463779
0.6154 --- loss: 1.441360, loss_ss: 1.011045, loss_d: 0.430316
0.6538 --- loss: 1.512560, loss_ss: 1.068072, loss_d: 0.444488
0.6923 --- loss: 1.594656, loss_ss: 1.151634, loss_d: 0.443022
0.7308 --- loss: 1.728222, loss_ss: 1.355838, loss_d: 0.372384
0.7692 --- loss: 2.796157, loss_ss: 1.879385, loss_d: 0.916773
0.8077 --- loss: 1.760350, loss_ss: 1.215067, loss_d: 0.545284
0.8462 --- loss: 1.525608, loss_ss: 1.232298, loss_d: 0.293310
0.8846 --- loss: 1.771894, loss_ss: 1.246670, loss_d: 0.525224
0.9231 --- loss: 1.858288, loss_ss: 1.458700, loss_d: 0.399587
0.9615 --- loss: 1.628207, loss_ss: 1.042277, loss_d: 0.585930
Epoch finished! Loss: 1.7251357512124257
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.593510, loss_ss: 1.148580, loss_d: 0.444930
0.0385 --- loss: 1.825684, loss_ss: 1.474627, loss_d: 0.351056
0.0769 --- loss: 1.536411, loss_ss: 1.176087, loss_d: 0.360324
0.1154 --- loss: 1.560252, loss_ss: 1.080337, loss_d: 0.479915
0.1538 --- loss: 1.776158, loss_ss: 1.101809, loss_d: 0.674349
0.1923 --- loss: 1.572627, loss_ss: 1.168532, loss_d: 0.404095
0.2308 --- loss: 1.767064, loss_ss: 1.114061, loss_d: 0.653003
0.2692 --- loss: 1.587345, loss_ss: 1.173532, loss_d: 0.413813
0.3077 --- loss: 1.796522, loss_ss: 1.361132, loss_d: 0.435391
0.3462 --- loss: 1.706802, loss_ss: 1.437257, loss_d: 0.269545
0.3846 --- loss: 2.196946, loss_ss: 1.354391, loss_d: 0.842555
0.4231 --- loss: 1.455895, loss_ss: 1.154784, loss_d: 0.301111
0.4615 --- loss: 1.553587, loss_ss: 1.077807, loss_d: 0.475780
0.5000 --- loss: 1.555443, loss_ss: 1.118798, loss_d: 0.436645
0.5385 --- loss: 1.412356, loss_ss: 0.941927, loss_d: 0.470429
0.5769 --- loss: 1.638359, loss_ss: 1.267363, loss_d: 0.370996
0.6154 --- loss: 1.327122, loss_ss: 1.013250, loss_d: 0.313872
0.6538 --- loss: 1.893777, loss_ss: 1.591838, loss_d: 0.301939
0.6923 --- loss: 1.687311, loss_ss: 1.206393, loss_d: 0.480918
0.7308 --- loss: 1.521183, loss_ss: 1.184729, loss_d: 0.336454
0.7692 --- loss: 1.583488, loss_ss: 1.215812, loss_d: 0.367676
0.8077 --- loss: 1.611831, loss_ss: 1.322594, loss_d: 0.289237
0.8462 --- loss: 1.324657, loss_ss: 0.962458, loss_d: 0.362199
0.8846 --- loss: 1.684005, loss_ss: 1.363697, loss_d: 0.320308
0.9231 --- loss: 1.596061, loss_ss: 1.289434, loss_d: 0.306627
0.9615 --- loss: 1.441582, loss_ss: 1.108989, loss_d: 0.332593
Epoch finished! Loss: 1.6250895293983254
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.703258, loss_ss: 1.389241, loss_d: 0.314017
0.0385 --- loss: 1.309600, loss_ss: 1.115006, loss_d: 0.194594
0.0769 --- loss: 1.465150, loss_ss: 1.254113, loss_d: 0.211037
0.1154 --- loss: 1.321966, loss_ss: 1.034562, loss_d: 0.287404
0.1538 --- loss: 1.988678, loss_ss: 1.098722, loss_d: 0.889956
0.1923 --- loss: 1.474615, loss_ss: 1.079621, loss_d: 0.394994
0.2308 --- loss: 1.509481, loss_ss: 1.088101, loss_d: 0.421381
0.2692 --- loss: 1.472051, loss_ss: 0.972498, loss_d: 0.499553
0.3077 --- loss: 1.468380, loss_ss: 1.170383, loss_d: 0.297998
0.3462 --- loss: 1.364710, loss_ss: 0.982371, loss_d: 0.382338
0.3846 --- loss: 1.250129, loss_ss: 0.811888, loss_d: 0.438241
0.4231 --- loss: 1.778398, loss_ss: 1.323957, loss_d: 0.454441
0.4615 --- loss: 1.825475, loss_ss: 1.582915, loss_d: 0.242560
0.5000 --- loss: 1.973346, loss_ss: 1.350239, loss_d: 0.623107
0.5385 --- loss: 1.464549, loss_ss: 1.068898, loss_d: 0.395651
0.5769 --- loss: 1.428347, loss_ss: 1.154211, loss_d: 0.274137
0.6154 --- loss: 1.421942, loss_ss: 1.074984, loss_d: 0.346958
0.6538 --- loss: 1.846676, loss_ss: 0.991236, loss_d: 0.855440
0.6923 --- loss: 1.493084, loss_ss: 1.007147, loss_d: 0.485937
0.7308 --- loss: 1.560777, loss_ss: 1.167298, loss_d: 0.393479
0.7692 --- loss: 1.350717, loss_ss: 1.040049, loss_d: 0.310667
0.8077 --- loss: 1.793806, loss_ss: 0.835028, loss_d: 0.958778
0.8462 --- loss: 2.087891, loss_ss: 1.549137, loss_d: 0.538753
0.8846 --- loss: 1.652387, loss_ss: 1.282206, loss_d: 0.370181
0.9231 --- loss: 1.394526, loss_ss: 0.901038, loss_d: 0.493488
0.9615 --- loss: 2.086599, loss_ss: 1.483338, loss_d: 0.603261
Epoch finished! Loss: 1.5644109267525692
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.516864, loss_ss: 1.236757, loss_d: 0.280107
0.0385 --- loss: 1.536399, loss_ss: 1.146434, loss_d: 0.389965
0.0769 --- loss: 1.887272, loss_ss: 1.221606, loss_d: 0.665666
0.1154 --- loss: 1.712062, loss_ss: 1.282731, loss_d: 0.429330
0.1538 --- loss: 1.525512, loss_ss: 1.186139, loss_d: 0.339373
0.1923 --- loss: 1.748029, loss_ss: 1.110384, loss_d: 0.637646
0.2308 --- loss: 1.715726, loss_ss: 1.149677, loss_d: 0.566049
0.2692 --- loss: 1.669801, loss_ss: 1.396989, loss_d: 0.272812
0.3077 --- loss: 1.738657, loss_ss: 1.006604, loss_d: 0.732053
0.3462 --- loss: 1.417600, loss_ss: 1.045644, loss_d: 0.371956
0.3846 --- loss: 1.441508, loss_ss: 1.138950, loss_d: 0.302558
0.4231 --- loss: 1.232084, loss_ss: 1.041370, loss_d: 0.190714
0.4615 --- loss: 1.546317, loss_ss: 1.042855, loss_d: 0.503462
0.5000 --- loss: 1.517609, loss_ss: 0.977118, loss_d: 0.540491
0.5385 --- loss: 1.589542, loss_ss: 1.313996, loss_d: 0.275546
0.5769 --- loss: 1.337333, loss_ss: 0.981187, loss_d: 0.356146
0.6154 --- loss: 1.768241, loss_ss: 1.034723, loss_d: 0.733518
0.6538 --- loss: 1.749789, loss_ss: 1.133908, loss_d: 0.615881
0.6923 --- loss: 1.772250, loss_ss: 1.375680, loss_d: 0.396570
0.7308 --- loss: 1.756744, loss_ss: 1.212278, loss_d: 0.544466
0.7692 --- loss: 1.408152, loss_ss: 1.122771, loss_d: 0.285381
0.8077 --- loss: 1.546850, loss_ss: 0.893010, loss_d: 0.653841
0.8462 --- loss: 1.504602, loss_ss: 1.182562, loss_d: 0.322040
0.8846 --- loss: 1.316465, loss_ss: 1.039209, loss_d: 0.277256
0.9231 --- loss: 1.682953, loss_ss: 1.283911, loss_d: 0.399042
0.9615 --- loss: 1.737720, loss_ss: 1.485820, loss_d: 0.251900
Epoch finished! Loss: 1.561720194963875
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.172737, loss_ss: 0.868038, loss_d: 0.304699
0.0385 --- loss: 1.640383, loss_ss: 0.884617, loss_d: 0.755766
0.0769 --- loss: 1.139638, loss_ss: 0.842957, loss_d: 0.296681
0.1154 --- loss: 1.157076, loss_ss: 0.927088, loss_d: 0.229988
0.1538 --- loss: 1.577347, loss_ss: 1.153470, loss_d: 0.423877
0.1923 --- loss: 1.286708, loss_ss: 1.071152, loss_d: 0.215556
0.2308 --- loss: 1.458001, loss_ss: 1.003831, loss_d: 0.454169
0.2692 --- loss: 1.351692, loss_ss: 0.982160, loss_d: 0.369532
0.3077 --- loss: 1.316241, loss_ss: 1.032760, loss_d: 0.283481
0.3462 --- loss: 1.289743, loss_ss: 1.078200, loss_d: 0.211544
0.3846 --- loss: 1.245163, loss_ss: 0.978474, loss_d: 0.266689
0.4231 --- loss: 1.660803, loss_ss: 1.066029, loss_d: 0.594773
0.4615 --- loss: 1.327999, loss_ss: 0.907975, loss_d: 0.420023
0.5000 --- loss: 1.599372, loss_ss: 1.295840, loss_d: 0.303532
0.5385 --- loss: 1.289179, loss_ss: 1.006652, loss_d: 0.282527
0.5769 --- loss: 1.281977, loss_ss: 1.061398, loss_d: 0.220579
0.6154 --- loss: 1.366502, loss_ss: 0.864604, loss_d: 0.501898
0.6538 --- loss: 1.760209, loss_ss: 1.143816, loss_d: 0.616393
0.6923 --- loss: 1.583895, loss_ss: 1.118010, loss_d: 0.465884
0.7308 --- loss: 1.587007, loss_ss: 1.304608, loss_d: 0.282398
0.7692 --- loss: 1.349757, loss_ss: 0.986120, loss_d: 0.363637
0.8077 --- loss: 1.467940, loss_ss: 1.030048, loss_d: 0.437891
0.8462 --- loss: 1.353386, loss_ss: 0.980788, loss_d: 0.372598
0.8846 --- loss: 1.457855, loss_ss: 1.083365, loss_d: 0.374490
0.9231 --- loss: 1.436571, loss_ss: 0.972029, loss_d: 0.464542
0.9615 --- loss: 1.521595, loss_ss: 1.060083, loss_d: 0.461512
Epoch finished! Loss: 1.509094338619571
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.2692982456140351
             precision    recall  f1-score   support

        0.0       0.52      0.63      0.57       297
        1.0       0.00      0.00      0.00       200
        2.0       0.00      0.00      0.00       354
        3.0       0.00      0.00      0.00       159
        4.0       0.16      0.93      0.27       130

avg / total       0.15      0.27      0.18      1140
 


====== chp020-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  75.09  62.63   79.48  51.81     56.71
1  82.46   0.00  100.00   0.00      0.00
2  68.86   0.00   99.87   0.00      0.00
3  86.05   0.00  100.00   0.00      0.00
4  41.40  93.08   34.75  15.51     26.59
Total accuracy: 26.93%
Average sen: 31.14%
Average spec: 82.82%
Macro f1-score: 16.66%
[1.         1.         0.99999988 0.99999988 0.99999988 0.99999988
 0.99999988 0.99999988 0.99999988 0.99999988 0.99999988 0.99999988
 0.99999988 0.99999988 0.99999988 1.         1.         0.99999988
 0.99999988 0.99999988 0.99999988 0.99999988 0.99999988 1.
 0.99999988 0.99999988 0.99999988 1.         0.99999988 0.99999988
 0.99999988 0.99999988 0.99999988 0.99999988 1.         1.
 1.         1.        ]
pred: 0.9999999121615761, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.222202, loss_ss: 1.538956, loss_d: 0.683246
0.0385 --- loss: 2.371565, loss_ss: 1.691301, loss_d: 0.680264
0.0770 --- loss: 2.306931, loss_ss: 1.567003, loss_d: 0.739928
0.1156 --- loss: 2.035865, loss_ss: 1.654548, loss_d: 0.381317
0.1541 --- loss: 2.787004, loss_ss: 1.683135, loss_d: 1.103869
0.1926 --- loss: 2.088221, loss_ss: 1.580922, loss_d: 0.507298
0.2311 --- loss: 2.397965, loss_ss: 1.728452, loss_d: 0.669513
0.2696 --- loss: 1.938559, loss_ss: 1.354073, loss_d: 0.584486
0.3082 --- loss: 2.012418, loss_ss: 1.570109, loss_d: 0.442310
0.3467 --- loss: 2.104031, loss_ss: 1.545290, loss_d: 0.558741
0.3852 --- loss: 2.064219, loss_ss: 1.496148, loss_d: 0.568071
0.4237 --- loss: 2.159864, loss_ss: 1.527053, loss_d: 0.632812
0.4622 --- loss: 2.120741, loss_ss: 1.693188, loss_d: 0.427553
0.5008 --- loss: 1.914469, loss_ss: 1.453471, loss_d: 0.460998
0.5393 --- loss: 1.949382, loss_ss: 1.497795, loss_d: 0.451587
0.5778 --- loss: 1.812541, loss_ss: 1.406917, loss_d: 0.405624
0.6163 --- loss: 1.933851, loss_ss: 1.582524, loss_d: 0.351327
0.6549 --- loss: 1.805235, loss_ss: 1.317227, loss_d: 0.488008
0.6934 --- loss: 2.071989, loss_ss: 1.483351, loss_d: 0.588638
0.7319 --- loss: 2.080801, loss_ss: 1.600854, loss_d: 0.479947
0.7704 --- loss: 2.031177, loss_ss: 1.554614, loss_d: 0.476562
0.8089 --- loss: 1.814701, loss_ss: 1.460112, loss_d: 0.354589
0.8475 --- loss: 2.241053, loss_ss: 1.482398, loss_d: 0.758655
0.8860 --- loss: 2.114969, loss_ss: 1.593810, loss_d: 0.521159
0.9245 --- loss: 2.175745, loss_ss: 1.707113, loss_d: 0.468632
0.9630 --- loss: 1.870125, loss_ss: 1.489385, loss_d: 0.380740
Epoch finished! Loss: 2.072953339709278
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.670286, loss_ss: 1.384269, loss_d: 0.286017
0.0385 --- loss: 1.655730, loss_ss: 1.284504, loss_d: 0.371225
0.0770 --- loss: 1.914022, loss_ss: 1.411686, loss_d: 0.502335
0.1156 --- loss: 1.964346, loss_ss: 1.413798, loss_d: 0.550548
0.1541 --- loss: 1.759954, loss_ss: 1.335040, loss_d: 0.424914
0.1926 --- loss: 1.794301, loss_ss: 1.346120, loss_d: 0.448181
0.2311 --- loss: 2.087572, loss_ss: 1.615741, loss_d: 0.471831
0.2696 --- loss: 1.870830, loss_ss: 1.230014, loss_d: 0.640816
0.3082 --- loss: 1.894175, loss_ss: 1.460511, loss_d: 0.433664
0.3467 --- loss: 1.818134, loss_ss: 1.332690, loss_d: 0.485444
0.3852 --- loss: 1.862874, loss_ss: 1.519401, loss_d: 0.343473
0.4237 --- loss: 1.988439, loss_ss: 1.609610, loss_d: 0.378829
0.4622 --- loss: 2.245727, loss_ss: 1.513059, loss_d: 0.732668
0.5008 --- loss: 1.683599, loss_ss: 1.346238, loss_d: 0.337361
0.5393 --- loss: 1.906456, loss_ss: 1.529474, loss_d: 0.376982
0.5778 --- loss: 2.283585, loss_ss: 1.549314, loss_d: 0.734270
0.6163 --- loss: 1.978141, loss_ss: 1.448807, loss_d: 0.529333
0.6549 --- loss: 2.246007, loss_ss: 1.563614, loss_d: 0.682393
0.6934 --- loss: 2.162003, loss_ss: 1.601595, loss_d: 0.560408
0.7319 --- loss: 1.911341, loss_ss: 1.422107, loss_d: 0.489233
0.7704 --- loss: 1.962941, loss_ss: 1.218620, loss_d: 0.744321
0.8089 --- loss: 2.064454, loss_ss: 1.465940, loss_d: 0.598513
0.8475 --- loss: 1.934432, loss_ss: 1.469895, loss_d: 0.464537
0.8860 --- loss: 1.764513, loss_ss: 1.291356, loss_d: 0.473157
0.9245 --- loss: 1.931122, loss_ss: 1.503180, loss_d: 0.427943
0.9630 --- loss: 1.851504, loss_ss: 1.389068, loss_d: 0.462436
Epoch finished! Loss: 1.9853364643443046
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.000207, loss_ss: 1.315032, loss_d: 0.685175
0.0385 --- loss: 2.085085, loss_ss: 1.308018, loss_d: 0.777067
0.0770 --- loss: 1.898413, loss_ss: 1.555415, loss_d: 0.342998
0.1156 --- loss: 1.935467, loss_ss: 1.393900, loss_d: 0.541567
0.1541 --- loss: 1.899544, loss_ss: 1.539460, loss_d: 0.360084
0.1926 --- loss: 1.827483, loss_ss: 1.398768, loss_d: 0.428715
0.2311 --- loss: 2.177560, loss_ss: 1.567197, loss_d: 0.610363
0.2696 --- loss: 2.210218, loss_ss: 1.677464, loss_d: 0.532754
0.3082 --- loss: 1.990506, loss_ss: 1.553403, loss_d: 0.437103
0.3467 --- loss: 1.911478, loss_ss: 1.414673, loss_d: 0.496805
0.3852 --- loss: 2.071771, loss_ss: 1.590962, loss_d: 0.480810
0.4237 --- loss: 1.742458, loss_ss: 1.330872, loss_d: 0.411586
0.4622 --- loss: 1.887599, loss_ss: 1.291186, loss_d: 0.596413
0.5008 --- loss: 1.957626, loss_ss: 1.317236, loss_d: 0.640390
0.5393 --- loss: 1.787338, loss_ss: 1.360162, loss_d: 0.427176
0.5778 --- loss: 1.887190, loss_ss: 1.354920, loss_d: 0.532270
0.6163 --- loss: 1.745596, loss_ss: 1.308573, loss_d: 0.437024
0.6549 --- loss: 1.971865, loss_ss: 1.475774, loss_d: 0.496091
0.6934 --- loss: 1.610798, loss_ss: 1.306162, loss_d: 0.304636
0.7319 --- loss: 1.926870, loss_ss: 1.600076, loss_d: 0.326794
0.7704 --- loss: 2.178844, loss_ss: 1.405423, loss_d: 0.773421
0.8089 --- loss: 2.003969, loss_ss: 1.572531, loss_d: 0.431438
0.8475 --- loss: 1.671569, loss_ss: 1.302478, loss_d: 0.369092
0.8860 --- loss: 1.919078, loss_ss: 1.492567, loss_d: 0.426512
0.9245 --- loss: 1.908923, loss_ss: 1.533370, loss_d: 0.375553
0.9630 --- loss: 1.971616, loss_ss: 1.468601, loss_d: 0.503016
Epoch finished! Loss: 1.941483020322203
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.950989, loss_ss: 1.476885, loss_d: 0.474104
0.0385 --- loss: 1.875563, loss_ss: 1.436168, loss_d: 0.439395
0.0770 --- loss: 1.841784, loss_ss: 1.405541, loss_d: 0.436242
0.1156 --- loss: 1.803963, loss_ss: 1.547793, loss_d: 0.256170
0.1541 --- loss: 1.926441, loss_ss: 1.483254, loss_d: 0.443187
0.1926 --- loss: 2.330746, loss_ss: 1.505666, loss_d: 0.825080
0.2311 --- loss: 1.825982, loss_ss: 1.534229, loss_d: 0.291753
0.2696 --- loss: 1.653957, loss_ss: 1.223261, loss_d: 0.430696
0.3082 --- loss: 1.554643, loss_ss: 1.298352, loss_d: 0.256290
0.3467 --- loss: 1.631019, loss_ss: 1.310947, loss_d: 0.320071
0.3852 --- loss: 1.780163, loss_ss: 1.471439, loss_d: 0.308724
0.4237 --- loss: 2.003973, loss_ss: 1.371427, loss_d: 0.632545
0.4622 --- loss: 1.673907, loss_ss: 1.197159, loss_d: 0.476748
0.5008 --- loss: 1.698812, loss_ss: 1.264355, loss_d: 0.434457
0.5393 --- loss: 1.813994, loss_ss: 1.340776, loss_d: 0.473218
0.5778 --- loss: 2.276800, loss_ss: 1.570332, loss_d: 0.706469
0.6163 --- loss: 1.907479, loss_ss: 1.470156, loss_d: 0.437322
0.6549 --- loss: 1.772095, loss_ss: 1.412735, loss_d: 0.359361
0.6934 --- loss: 1.885063, loss_ss: 1.421385, loss_d: 0.463678
0.7319 --- loss: 1.895199, loss_ss: 1.553038, loss_d: 0.342160
0.7704 --- loss: 1.792047, loss_ss: 1.470287, loss_d: 0.321760
0.8089 --- loss: 1.782612, loss_ss: 1.352255, loss_d: 0.430357
0.8475 --- loss: 1.668508, loss_ss: 1.201341, loss_d: 0.467167
0.8860 --- loss: 1.999158, loss_ss: 1.247093, loss_d: 0.752065
0.9245 --- loss: 2.611925, loss_ss: 1.314388, loss_d: 1.297538
0.9630 --- loss: 1.811516, loss_ss: 1.272749, loss_d: 0.538767
Epoch finished! Loss: 1.909016888114016
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.885451, loss_ss: 1.399172, loss_d: 0.486279
0.0385 --- loss: 1.472320, loss_ss: 1.114442, loss_d: 0.357878
0.0770 --- loss: 2.279934, loss_ss: 1.571275, loss_d: 0.708659
0.1156 --- loss: 1.596616, loss_ss: 1.254658, loss_d: 0.341958
0.1541 --- loss: 1.786321, loss_ss: 1.368574, loss_d: 0.417748
0.1926 --- loss: 1.709823, loss_ss: 1.429055, loss_d: 0.280768
0.2311 --- loss: 1.860920, loss_ss: 1.510559, loss_d: 0.350361
0.2696 --- loss: 1.616813, loss_ss: 1.341131, loss_d: 0.275682
0.3082 --- loss: 1.623034, loss_ss: 1.337435, loss_d: 0.285600
0.3467 --- loss: 2.010566, loss_ss: 1.561839, loss_d: 0.448727
0.3852 --- loss: 1.811141, loss_ss: 1.489439, loss_d: 0.321702
0.4237 --- loss: 1.688985, loss_ss: 1.449499, loss_d: 0.239486
0.4622 --- loss: 1.927528, loss_ss: 1.351805, loss_d: 0.575724
0.5008 --- loss: 1.977802, loss_ss: 1.459146, loss_d: 0.518656
0.5393 --- loss: 1.566974, loss_ss: 1.275292, loss_d: 0.291682
0.5778 --- loss: 1.754612, loss_ss: 1.424115, loss_d: 0.330497
0.6163 --- loss: 2.089703, loss_ss: 1.465549, loss_d: 0.624154
0.6549 --- loss: 2.201185, loss_ss: 1.538558, loss_d: 0.662627
0.6934 --- loss: 1.928756, loss_ss: 1.440386, loss_d: 0.488370
0.7319 --- loss: 1.840167, loss_ss: 1.348288, loss_d: 0.491879
0.7704 --- loss: 1.801994, loss_ss: 1.408681, loss_d: 0.393313
0.8089 --- loss: 1.516958, loss_ss: 1.260869, loss_d: 0.256089
0.8475 --- loss: 1.811360, loss_ss: 1.409572, loss_d: 0.401787
0.8860 --- loss: 2.106838, loss_ss: 1.519262, loss_d: 0.587576
0.9245 --- loss: 1.752784, loss_ss: 1.368045, loss_d: 0.384739
0.9630 --- loss: 2.130578, loss_ss: 1.367080, loss_d: 0.763498
Epoch finished! Loss: 1.8713948464301562
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.789955, loss_ss: 1.496026, loss_d: 0.293928
0.0385 --- loss: 2.101470, loss_ss: 1.457716, loss_d: 0.643755
0.0770 --- loss: 1.953529, loss_ss: 1.562130, loss_d: 0.391399
0.1156 --- loss: 2.066364, loss_ss: 1.637722, loss_d: 0.428642
0.1541 --- loss: 1.632668, loss_ss: 1.262893, loss_d: 0.369775
0.1926 --- loss: 1.840139, loss_ss: 1.451466, loss_d: 0.388673
0.2311 --- loss: 1.811397, loss_ss: 1.375205, loss_d: 0.436192
0.2696 --- loss: 1.974406, loss_ss: 1.583836, loss_d: 0.390571
0.3082 --- loss: 1.612356, loss_ss: 1.290670, loss_d: 0.321686
0.3467 --- loss: 1.813606, loss_ss: 1.525513, loss_d: 0.288093
0.3852 --- loss: 1.920850, loss_ss: 1.593040, loss_d: 0.327810
0.4237 --- loss: 1.531533, loss_ss: 1.248553, loss_d: 0.282980
0.4622 --- loss: 1.762457, loss_ss: 1.318298, loss_d: 0.444159
0.5008 --- loss: 1.554011, loss_ss: 1.203282, loss_d: 0.350729
0.5393 --- loss: 1.773414, loss_ss: 1.278923, loss_d: 0.494490
0.5778 --- loss: 2.206176, loss_ss: 1.258938, loss_d: 0.947238
0.6163 --- loss: 1.893417, loss_ss: 1.404411, loss_d: 0.489006
0.6549 --- loss: 1.683957, loss_ss: 1.364180, loss_d: 0.319777
0.6934 --- loss: 1.882205, loss_ss: 1.530928, loss_d: 0.351277
0.7319 --- loss: 1.997686, loss_ss: 1.303363, loss_d: 0.694323
0.7704 --- loss: 1.664498, loss_ss: 1.386890, loss_d: 0.277608
0.8089 --- loss: 1.931421, loss_ss: 1.505081, loss_d: 0.426340
0.8475 --- loss: 1.569136, loss_ss: 1.117530, loss_d: 0.451606
0.8860 --- loss: 1.716819, loss_ss: 1.287365, loss_d: 0.429454
0.9245 --- loss: 1.509499, loss_ss: 1.173090, loss_d: 0.336410
0.9630 --- loss: 2.088724, loss_ss: 1.615458, loss_d: 0.473266
Epoch finished! Loss: 1.857337314189631
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.856342, loss_ss: 1.414951, loss_d: 0.441391
0.0385 --- loss: 2.510632, loss_ss: 1.702392, loss_d: 0.808240
0.0770 --- loss: 1.950730, loss_ss: 1.282706, loss_d: 0.668024
0.1156 --- loss: 1.674156, loss_ss: 1.272237, loss_d: 0.401919
0.1541 --- loss: 1.922166, loss_ss: 1.393454, loss_d: 0.528712
0.1926 --- loss: 2.687063, loss_ss: 1.535025, loss_d: 1.152038
0.2311 --- loss: 1.717400, loss_ss: 1.442793, loss_d: 0.274607
0.2696 --- loss: 1.765972, loss_ss: 1.447071, loss_d: 0.318901
0.3082 --- loss: 1.938945, loss_ss: 1.333784, loss_d: 0.605161
0.3467 --- loss: 1.997983, loss_ss: 1.647662, loss_d: 0.350320
0.3852 --- loss: 1.990358, loss_ss: 1.243508, loss_d: 0.746850
0.4237 --- loss: 1.840200, loss_ss: 1.501493, loss_d: 0.338707
0.4622 --- loss: 1.794451, loss_ss: 1.282752, loss_d: 0.511699
0.5008 --- loss: 1.826623, loss_ss: 1.493052, loss_d: 0.333571
0.5393 --- loss: 1.507746, loss_ss: 1.121656, loss_d: 0.386090
0.5778 --- loss: 2.368183, loss_ss: 1.310659, loss_d: 1.057524
0.6163 --- loss: 1.698482, loss_ss: 1.411295, loss_d: 0.287187
0.6549 --- loss: 1.790485, loss_ss: 1.431403, loss_d: 0.359082
0.6934 --- loss: 1.453386, loss_ss: 1.171817, loss_d: 0.281569
0.7319 --- loss: 1.659423, loss_ss: 1.322706, loss_d: 0.336717
0.7704 --- loss: 1.653028, loss_ss: 1.293621, loss_d: 0.359407
0.8089 --- loss: 1.670259, loss_ss: 1.259459, loss_d: 0.410800
0.8475 --- loss: 1.899759, loss_ss: 1.600467, loss_d: 0.299292
0.8860 --- loss: 1.510124, loss_ss: 1.161181, loss_d: 0.348943
0.9245 --- loss: 1.455153, loss_ss: 1.186514, loss_d: 0.268639
0.9630 --- loss: 1.794513, loss_ss: 1.132025, loss_d: 0.662488
Epoch finished! Loss: 1.8388017231893354
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.968379, loss_ss: 1.398539, loss_d: 0.569840
0.0385 --- loss: 2.327873, loss_ss: 1.322093, loss_d: 1.005780
0.0770 --- loss: 1.706619, loss_ss: 1.260105, loss_d: 0.446514
0.1156 --- loss: 1.734602, loss_ss: 1.304966, loss_d: 0.429636
0.1541 --- loss: 1.508440, loss_ss: 1.173124, loss_d: 0.335315
0.1926 --- loss: 2.157568, loss_ss: 1.453761, loss_d: 0.703807
0.2311 --- loss: 1.695874, loss_ss: 1.200319, loss_d: 0.495555
0.2696 --- loss: 1.743338, loss_ss: 1.380573, loss_d: 0.362765
0.3082 --- loss: 2.056911, loss_ss: 1.281180, loss_d: 0.775731
0.3467 --- loss: 2.063036, loss_ss: 1.579790, loss_d: 0.483246
0.3852 --- loss: 1.773937, loss_ss: 1.392314, loss_d: 0.381623
0.4237 --- loss: 1.480901, loss_ss: 1.203164, loss_d: 0.277738
0.4622 --- loss: 2.391927, loss_ss: 1.529783, loss_d: 0.862143
0.5008 --- loss: 1.384073, loss_ss: 1.048334, loss_d: 0.335738
0.5393 --- loss: 1.700926, loss_ss: 1.234154, loss_d: 0.466772
0.5778 --- loss: 1.684504, loss_ss: 1.280555, loss_d: 0.403949
0.6163 --- loss: 1.683977, loss_ss: 1.069564, loss_d: 0.614413
0.6549 --- loss: 2.033676, loss_ss: 1.469019, loss_d: 0.564657
0.6934 --- loss: 1.666297, loss_ss: 1.341828, loss_d: 0.324470
0.7319 --- loss: 1.479381, loss_ss: 1.003776, loss_d: 0.475605
0.7704 --- loss: 1.752867, loss_ss: 1.461584, loss_d: 0.291283
0.8089 --- loss: 1.939411, loss_ss: 1.515999, loss_d: 0.423412
0.8475 --- loss: 1.914289, loss_ss: 1.543052, loss_d: 0.371237
0.8860 --- loss: 1.876548, loss_ss: 1.166902, loss_d: 0.709646
0.9245 --- loss: 1.896197, loss_ss: 1.491599, loss_d: 0.404598
0.9630 --- loss: 1.974762, loss_ss: 1.606252, loss_d: 0.368510
Epoch finished! Loss: 1.7999480447253666
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.644838, loss_ss: 1.271707, loss_d: 0.373131
0.0385 --- loss: 1.738294, loss_ss: 1.144583, loss_d: 0.593711
0.0770 --- loss: 1.498527, loss_ss: 1.096692, loss_d: 0.401835
0.1156 --- loss: 1.453732, loss_ss: 1.141577, loss_d: 0.312154
0.1541 --- loss: 1.468533, loss_ss: 1.177907, loss_d: 0.290625
0.1926 --- loss: 1.623589, loss_ss: 1.181419, loss_d: 0.442170
0.2311 --- loss: 1.414403, loss_ss: 1.022100, loss_d: 0.392303
0.2696 --- loss: 1.738788, loss_ss: 1.346366, loss_d: 0.392422
0.3082 --- loss: 1.835372, loss_ss: 1.144649, loss_d: 0.690723
0.3467 --- loss: 1.993098, loss_ss: 1.690136, loss_d: 0.302962
0.3852 --- loss: 1.421447, loss_ss: 1.131040, loss_d: 0.290407
0.4237 --- loss: 1.830165, loss_ss: 1.297692, loss_d: 0.532474
0.4622 --- loss: 1.674365, loss_ss: 1.203649, loss_d: 0.470716
0.5008 --- loss: 1.484611, loss_ss: 1.107870, loss_d: 0.376740
0.5393 --- loss: 1.792481, loss_ss: 1.283996, loss_d: 0.508484
0.5778 --- loss: 1.486611, loss_ss: 1.240082, loss_d: 0.246530
0.6163 --- loss: 1.792909, loss_ss: 1.371162, loss_d: 0.421746
0.6549 --- loss: 1.816123, loss_ss: 1.209637, loss_d: 0.606485
0.6934 --- loss: 1.620295, loss_ss: 1.007998, loss_d: 0.612297
0.7319 --- loss: 1.503409, loss_ss: 1.162523, loss_d: 0.340886
0.7704 --- loss: 1.401703, loss_ss: 1.108390, loss_d: 0.293313
0.8089 --- loss: 1.561955, loss_ss: 1.149774, loss_d: 0.412181
0.8475 --- loss: 1.555367, loss_ss: 1.228452, loss_d: 0.326915
0.8860 --- loss: 1.389101, loss_ss: 1.158148, loss_d: 0.230953
0.9245 --- loss: 1.812632, loss_ss: 1.175344, loss_d: 0.637289
0.9630 --- loss: 1.488750, loss_ss: 1.159481, loss_d: 0.329270
Epoch finished! Loss: 1.672841858219456
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.419120, loss_ss: 1.121457, loss_d: 0.297664
0.0385 --- loss: 1.480823, loss_ss: 1.075163, loss_d: 0.405660
0.0770 --- loss: 1.571822, loss_ss: 1.112731, loss_d: 0.459092
0.1156 --- loss: 1.508147, loss_ss: 1.201387, loss_d: 0.306760
0.1541 --- loss: 1.757568, loss_ss: 1.310005, loss_d: 0.447563
0.1926 --- loss: 1.833691, loss_ss: 1.581317, loss_d: 0.252375
0.2311 --- loss: 1.645832, loss_ss: 1.180877, loss_d: 0.464955
0.2696 --- loss: 1.734529, loss_ss: 1.410750, loss_d: 0.323780
0.3082 --- loss: 1.465626, loss_ss: 0.962148, loss_d: 0.503478
0.3467 --- loss: 1.681917, loss_ss: 1.239247, loss_d: 0.442671
0.3852 --- loss: 1.842075, loss_ss: 1.583994, loss_d: 0.258082
0.4237 --- loss: 1.597045, loss_ss: 1.055699, loss_d: 0.541347
0.4622 --- loss: 1.369201, loss_ss: 1.037032, loss_d: 0.332169
0.5008 --- loss: 1.845283, loss_ss: 1.404818, loss_d: 0.440466
0.5393 --- loss: 1.633426, loss_ss: 1.256949, loss_d: 0.376477
0.5778 --- loss: 1.315619, loss_ss: 0.997923, loss_d: 0.317696
0.6163 --- loss: 1.314005, loss_ss: 1.016540, loss_d: 0.297465
0.6549 --- loss: 1.299418, loss_ss: 0.930137, loss_d: 0.369282
0.6934 --- loss: 1.276694, loss_ss: 0.978140, loss_d: 0.298554
0.7319 --- loss: 1.546899, loss_ss: 1.111079, loss_d: 0.435820
0.7704 --- loss: 1.267799, loss_ss: 0.977858, loss_d: 0.289941
0.8089 --- loss: 1.782744, loss_ss: 1.397722, loss_d: 0.385022
0.8475 --- loss: 1.451850, loss_ss: 1.030776, loss_d: 0.421074
0.8860 --- loss: 1.391401, loss_ss: 0.883746, loss_d: 0.507654
0.9245 --- loss: 1.352936, loss_ss: 1.057290, loss_d: 0.295646
0.9630 --- loss: 1.651812, loss_ss: 1.202136, loss_d: 0.449676
Epoch finished! Loss: 1.5702822751520222
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.09285714285714286
             precision    recall  f1-score   support

        0.0       1.00      0.04      0.08       253
        1.0       0.00      0.00      0.00       293
        2.0       0.00      0.00      0.00       468
        3.0       0.09      1.00      0.16       107
        4.0       0.00      0.00      0.00       139

avg / total       0.21      0.09      0.03      1260
 


====== chp022-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %   ppr %  f1-score
0  80.71    3.95  100.00  100.00      7.60
1  76.75    0.00  100.00    0.00      0.00
2  62.86    0.00  100.00    0.00      0.00
3   9.29  100.00    0.87    8.56     15.77
4  88.97    0.00  100.00    0.00      0.00
Total accuracy: 9.29%
Average sen: 20.79%
Average spec: 80.17%
Macro f1-score: 4.67%
[0.24012254 0.28837195 0.27841365 0.24743843 0.26351964 0.21827684
 0.21475059 0.22523828 0.2421014  0.23158605 0.21878    0.21470492
 0.21783391 0.21363141 0.21934493 0.21998696 0.21447171 0.21979775
 0.20663783 0.21437994 0.23264799 0.21644425 0.24006201 0.20769614
 0.22519305 0.23200324 0.22477166 0.227057   0.22466841 0.23607157
 0.22932637 0.24531101 0.20665433 0.20266208 0.20898932 0.21572375
 0.28911957 0.28279388 0.23597819 0.21368718 0.22257239 0.22675833]
pred: 0.22989477252676374, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.456169, loss_ss: 1.761162, loss_d: 0.695008
0.0384 --- loss: 2.381323, loss_ss: 1.772170, loss_d: 0.609153
0.0769 --- loss: 2.118740, loss_ss: 1.756498, loss_d: 0.362241
0.1153 --- loss: 2.136028, loss_ss: 1.680668, loss_d: 0.455361
0.1538 --- loss: 2.165654, loss_ss: 1.610571, loss_d: 0.555083
0.1922 --- loss: 2.483293, loss_ss: 1.869606, loss_d: 0.613687
0.2307 --- loss: 2.356815, loss_ss: 1.749910, loss_d: 0.606905
0.2691 --- loss: 2.318772, loss_ss: 1.682166, loss_d: 0.636606
0.3076 --- loss: 2.014041, loss_ss: 1.571038, loss_d: 0.443004
0.3460 --- loss: 2.372792, loss_ss: 1.551226, loss_d: 0.821566
0.3845 --- loss: 2.263445, loss_ss: 1.541604, loss_d: 0.721841
0.4229 --- loss: 1.978204, loss_ss: 1.618366, loss_d: 0.359838
0.4614 --- loss: 2.027091, loss_ss: 1.576470, loss_d: 0.450621
0.4998 --- loss: 2.413790, loss_ss: 1.573341, loss_d: 0.840449
0.5383 --- loss: 2.624442, loss_ss: 1.572234, loss_d: 1.052208
0.5767 --- loss: 2.067364, loss_ss: 1.592133, loss_d: 0.475231
0.6151 --- loss: 2.043071, loss_ss: 1.553838, loss_d: 0.489233
0.6536 --- loss: 1.859905, loss_ss: 1.667880, loss_d: 0.192025
0.6920 --- loss: 1.738399, loss_ss: 1.568040, loss_d: 0.170359
0.7305 --- loss: 2.100666, loss_ss: 1.565060, loss_d: 0.535606
0.7689 --- loss: 2.207316, loss_ss: 1.592136, loss_d: 0.615181
0.8074 --- loss: 2.317790, loss_ss: 1.568104, loss_d: 0.749686
0.8458 --- loss: 2.041326, loss_ss: 1.592348, loss_d: 0.448978
0.8843 --- loss: 2.169434, loss_ss: 1.569855, loss_d: 0.599579
0.9227 --- loss: 2.165159, loss_ss: 1.509007, loss_d: 0.656152
0.9612 --- loss: 1.871439, loss_ss: 1.455033, loss_d: 0.416406
0.9996 --- loss: 1.809577, loss_ss: 1.546962, loss_d: 0.262615
Epoch finished! Loss: 2.1712146777373094
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.663954, loss_ss: 1.536390, loss_d: 1.127564
0.0384 --- loss: 1.933886, loss_ss: 1.431087, loss_d: 0.502799
0.0769 --- loss: 1.975556, loss_ss: 1.371128, loss_d: 0.604428
0.1153 --- loss: 1.837845, loss_ss: 1.415453, loss_d: 0.422392
0.1538 --- loss: 2.079024, loss_ss: 1.290132, loss_d: 0.788892
0.1922 --- loss: 1.898183, loss_ss: 1.488870, loss_d: 0.409313
0.2307 --- loss: 1.873923, loss_ss: 1.559557, loss_d: 0.314366
0.2691 --- loss: 2.110016, loss_ss: 1.446027, loss_d: 0.663988
0.3076 --- loss: 1.872522, loss_ss: 1.322211, loss_d: 0.550311
0.3460 --- loss: 1.953003, loss_ss: 1.647474, loss_d: 0.305529
0.3845 --- loss: 2.116731, loss_ss: 1.439822, loss_d: 0.676909
0.4229 --- loss: 2.267031, loss_ss: 1.522068, loss_d: 0.744963
0.4614 --- loss: 2.207534, loss_ss: 1.466678, loss_d: 0.740857
0.4998 --- loss: 1.888065, loss_ss: 1.495183, loss_d: 0.392883
0.5383 --- loss: 1.789607, loss_ss: 1.330470, loss_d: 0.459137
0.5767 --- loss: 1.474744, loss_ss: 1.181670, loss_d: 0.293075
0.6151 --- loss: 1.675817, loss_ss: 1.259984, loss_d: 0.415833
0.6536 --- loss: 1.678481, loss_ss: 1.343601, loss_d: 0.334880
0.6920 --- loss: 2.227945, loss_ss: 1.318155, loss_d: 0.909790
0.7305 --- loss: 1.725606, loss_ss: 1.218470, loss_d: 0.507136
0.7689 --- loss: 1.912654, loss_ss: 1.449564, loss_d: 0.463090
0.8074 --- loss: 1.849629, loss_ss: 1.432425, loss_d: 0.417204
0.8458 --- loss: 1.668522, loss_ss: 1.392856, loss_d: 0.275666
0.8843 --- loss: 1.572737, loss_ss: 1.329915, loss_d: 0.242821
0.9227 --- loss: 1.870828, loss_ss: 1.117705, loss_d: 0.753123
0.9612 --- loss: 1.824385, loss_ss: 1.288839, loss_d: 0.535546
0.9996 --- loss: 3.259493, loss_ss: 2.084739, loss_d: 1.174754
Epoch finished! Loss: 1.955837775193728
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.911588, loss_ss: 1.304626, loss_d: 0.606962
0.0384 --- loss: 1.769878, loss_ss: 1.262870, loss_d: 0.507008
0.0769 --- loss: 1.736460, loss_ss: 1.117516, loss_d: 0.618944
0.1153 --- loss: 1.838362, loss_ss: 1.597988, loss_d: 0.240374
0.1538 --- loss: 2.379476, loss_ss: 1.389689, loss_d: 0.989786
0.1922 --- loss: 1.708691, loss_ss: 1.305162, loss_d: 0.403529
0.2307 --- loss: 1.739737, loss_ss: 1.181060, loss_d: 0.558677
0.2691 --- loss: 2.205556, loss_ss: 1.400326, loss_d: 0.805229
0.3076 --- loss: 1.646982, loss_ss: 1.048041, loss_d: 0.598942
0.3460 --- loss: 2.059069, loss_ss: 1.479868, loss_d: 0.579201
0.3845 --- loss: 1.974686, loss_ss: 1.593771, loss_d: 0.380915
0.4229 --- loss: 1.660942, loss_ss: 1.306813, loss_d: 0.354129
0.4614 --- loss: 1.415955, loss_ss: 1.156339, loss_d: 0.259616
0.4998 --- loss: 1.509560, loss_ss: 1.214809, loss_d: 0.294751
0.5383 --- loss: 1.819620, loss_ss: 1.223449, loss_d: 0.596171
0.5767 --- loss: 1.876821, loss_ss: 1.325341, loss_d: 0.551480
0.6151 --- loss: 1.862521, loss_ss: 1.068672, loss_d: 0.793849
0.6536 --- loss: 1.912347, loss_ss: 1.537719, loss_d: 0.374628
0.6920 --- loss: 1.827176, loss_ss: 1.435089, loss_d: 0.392087
0.7305 --- loss: 1.691653, loss_ss: 1.138744, loss_d: 0.552910
0.7689 --- loss: 1.826389, loss_ss: 0.987931, loss_d: 0.838458
0.8074 --- loss: 1.911601, loss_ss: 1.368648, loss_d: 0.542952
0.8458 --- loss: 1.599459, loss_ss: 1.067405, loss_d: 0.532054
0.8843 --- loss: 1.843409, loss_ss: 1.238664, loss_d: 0.604745
0.9227 --- loss: 1.505698, loss_ss: 0.974387, loss_d: 0.531311
0.9612 --- loss: 1.861020, loss_ss: 1.358792, loss_d: 0.502227
0.9996 --- loss: 2.681477, loss_ss: 1.063482, loss_d: 1.617995
Epoch finished! Loss: 1.78760141822008
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.637244, loss_ss: 1.089704, loss_d: 0.547539
0.0384 --- loss: 1.953841, loss_ss: 1.376825, loss_d: 0.577016
0.0769 --- loss: 1.493698, loss_ss: 0.987120, loss_d: 0.506578
0.1153 --- loss: 1.537993, loss_ss: 1.114444, loss_d: 0.423549
0.1538 --- loss: 1.737269, loss_ss: 1.219773, loss_d: 0.517496
0.1922 --- loss: 1.402124, loss_ss: 1.064216, loss_d: 0.337908
0.2307 --- loss: 1.851121, loss_ss: 1.419650, loss_d: 0.431471
0.2691 --- loss: 1.618778, loss_ss: 1.191375, loss_d: 0.427403
0.3076 --- loss: 1.728714, loss_ss: 1.040054, loss_d: 0.688661
0.3460 --- loss: 1.655470, loss_ss: 1.277764, loss_d: 0.377706
0.3845 --- loss: 1.797638, loss_ss: 1.431234, loss_d: 0.366405
0.4229 --- loss: 2.132264, loss_ss: 1.589047, loss_d: 0.543217
0.4614 --- loss: 1.460031, loss_ss: 1.120404, loss_d: 0.339627
0.4998 --- loss: 1.611197, loss_ss: 1.241387, loss_d: 0.369809
0.5383 --- loss: 1.942427, loss_ss: 1.459309, loss_d: 0.483117
0.5767 --- loss: 1.715678, loss_ss: 1.269433, loss_d: 0.446246
0.6151 --- loss: 1.438280, loss_ss: 1.079596, loss_d: 0.358684
0.6536 --- loss: 2.392277, loss_ss: 1.214239, loss_d: 1.178038
0.6920 --- loss: 2.230635, loss_ss: 1.064984, loss_d: 1.165651
0.7305 --- loss: 1.520672, loss_ss: 1.020712, loss_d: 0.499960
0.7689 --- loss: 1.581401, loss_ss: 1.111459, loss_d: 0.469942
0.8074 --- loss: 1.393090, loss_ss: 1.059533, loss_d: 0.333557
0.8458 --- loss: 1.886707, loss_ss: 1.427763, loss_d: 0.458944
0.8843 --- loss: 1.577267, loss_ss: 1.100915, loss_d: 0.476352
0.9227 --- loss: 1.421723, loss_ss: 0.970870, loss_d: 0.450853
0.9612 --- loss: 1.412144, loss_ss: 0.995854, loss_d: 0.416290
0.9996 --- loss: 2.655529, loss_ss: 2.572296, loss_d: 0.083233
Epoch finished! Loss: 1.6779120926673596
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.256549, loss_ss: 1.045359, loss_d: 0.211190
0.0384 --- loss: 1.341127, loss_ss: 1.090850, loss_d: 0.250277
0.0769 --- loss: 1.638978, loss_ss: 1.105609, loss_d: 0.533369
0.1153 --- loss: 1.635407, loss_ss: 1.218522, loss_d: 0.416885
0.1538 --- loss: 1.408476, loss_ss: 1.027333, loss_d: 0.381143
0.1922 --- loss: 1.592042, loss_ss: 1.163046, loss_d: 0.428996
0.2307 --- loss: 1.756188, loss_ss: 1.193880, loss_d: 0.562308
0.2691 --- loss: 1.552655, loss_ss: 1.236320, loss_d: 0.316335
0.3076 --- loss: 1.665989, loss_ss: 1.330343, loss_d: 0.335646
0.3460 --- loss: 1.681463, loss_ss: 1.024316, loss_d: 0.657147
0.3845 --- loss: 2.045599, loss_ss: 1.046198, loss_d: 0.999402
0.4229 --- loss: 1.448087, loss_ss: 1.016608, loss_d: 0.431479
0.4614 --- loss: 1.449970, loss_ss: 1.083877, loss_d: 0.366094
0.4998 --- loss: 1.705625, loss_ss: 1.253244, loss_d: 0.452381
0.5383 --- loss: 1.686107, loss_ss: 1.298196, loss_d: 0.387911
0.5767 --- loss: 1.638238, loss_ss: 1.127247, loss_d: 0.510991
0.6151 --- loss: 1.280694, loss_ss: 0.942595, loss_d: 0.338099
0.6536 --- loss: 1.607116, loss_ss: 1.280816, loss_d: 0.326300
0.6920 --- loss: 1.655792, loss_ss: 1.298069, loss_d: 0.357723
0.7305 --- loss: 1.492212, loss_ss: 1.026408, loss_d: 0.465805
0.7689 --- loss: 1.592148, loss_ss: 1.174539, loss_d: 0.417610
0.8074 --- loss: 1.521641, loss_ss: 1.149152, loss_d: 0.372488
0.8458 --- loss: 1.638796, loss_ss: 0.957091, loss_d: 0.681705
0.8843 --- loss: 1.554903, loss_ss: 1.097857, loss_d: 0.457046
0.9227 --- loss: 1.984837, loss_ss: 1.559024, loss_d: 0.425813
0.9612 --- loss: 1.567298, loss_ss: 1.201680, loss_d: 0.365619
0.9996 --- loss: 1.444420, loss_ss: 1.180024, loss_d: 0.264397
Epoch finished! Loss: 1.6423064722464635
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.484480, loss_ss: 1.107842, loss_d: 0.376638
0.0384 --- loss: 1.769036, loss_ss: 0.997398, loss_d: 0.771639
0.0769 --- loss: 1.477062, loss_ss: 1.048513, loss_d: 0.428549
0.1153 --- loss: 1.414559, loss_ss: 1.065267, loss_d: 0.349291
0.1538 --- loss: 1.481987, loss_ss: 1.082119, loss_d: 0.399868
0.1922 --- loss: 1.390984, loss_ss: 1.043446, loss_d: 0.347538
0.2307 --- loss: 1.444847, loss_ss: 0.862407, loss_d: 0.582440
0.2691 --- loss: 2.097020, loss_ss: 1.248035, loss_d: 0.848985
0.3076 --- loss: 1.546507, loss_ss: 1.146359, loss_d: 0.400148
0.3460 --- loss: 1.459166, loss_ss: 1.087730, loss_d: 0.371436
0.3845 --- loss: 1.549090, loss_ss: 0.959266, loss_d: 0.589824
0.4229 --- loss: 1.244130, loss_ss: 0.905411, loss_d: 0.338719
0.4614 --- loss: 2.025599, loss_ss: 1.065673, loss_d: 0.959926
0.4998 --- loss: 1.641801, loss_ss: 1.084256, loss_d: 0.557545
0.5383 --- loss: 1.485442, loss_ss: 1.055191, loss_d: 0.430251
0.5767 --- loss: 1.834867, loss_ss: 1.308004, loss_d: 0.526863
0.6151 --- loss: 1.551565, loss_ss: 1.226748, loss_d: 0.324818
0.6536 --- loss: 1.511017, loss_ss: 1.107487, loss_d: 0.403530
0.6920 --- loss: 1.580216, loss_ss: 1.166707, loss_d: 0.413509
0.7305 --- loss: 1.554620, loss_ss: 1.121907, loss_d: 0.432712
0.7689 --- loss: 1.294649, loss_ss: 0.932412, loss_d: 0.362237
0.8074 --- loss: 1.267690, loss_ss: 0.944243, loss_d: 0.323448
0.8458 --- loss: 1.160579, loss_ss: 0.953255, loss_d: 0.207324
0.8843 --- loss: 1.632910, loss_ss: 1.140233, loss_d: 0.492677
0.9227 --- loss: 1.680605, loss_ss: 1.061693, loss_d: 0.618913
0.9612 --- loss: 1.645486, loss_ss: 1.175953, loss_d: 0.469533
0.9996 --- loss: 2.537357, loss_ss: 2.398929, loss_d: 0.138428
Epoch finished! Loss: 1.586419840500905
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.498279, loss_ss: 1.066921, loss_d: 0.431359
0.0384 --- loss: 1.491623, loss_ss: 0.965359, loss_d: 0.526263
0.0769 --- loss: 1.551742, loss_ss: 1.147928, loss_d: 0.403814
0.1153 --- loss: 1.962653, loss_ss: 1.324659, loss_d: 0.637994
0.1538 --- loss: 1.546670, loss_ss: 0.990162, loss_d: 0.556508
0.1922 --- loss: 1.393374, loss_ss: 0.935807, loss_d: 0.457566
0.2307 --- loss: 1.405195, loss_ss: 1.008425, loss_d: 0.396770
0.2691 --- loss: 1.616412, loss_ss: 1.234012, loss_d: 0.382400
0.3076 --- loss: 1.399157, loss_ss: 1.134595, loss_d: 0.264562
0.3460 --- loss: 1.698588, loss_ss: 1.043230, loss_d: 0.655358
0.3845 --- loss: 1.402908, loss_ss: 0.906390, loss_d: 0.496518
0.4229 --- loss: 2.085433, loss_ss: 1.093477, loss_d: 0.991955
0.4614 --- loss: 1.135248, loss_ss: 0.898111, loss_d: 0.237137
0.4998 --- loss: 1.318269, loss_ss: 0.805094, loss_d: 0.513175
0.5383 --- loss: 1.478317, loss_ss: 1.151347, loss_d: 0.326970
0.5767 --- loss: 2.010845, loss_ss: 1.522578, loss_d: 0.488267
0.6151 --- loss: 1.602484, loss_ss: 1.034368, loss_d: 0.568116
0.6536 --- loss: 1.419356, loss_ss: 0.954991, loss_d: 0.464365
0.6920 --- loss: 1.620455, loss_ss: 1.100034, loss_d: 0.520420
0.7305 --- loss: 1.543324, loss_ss: 1.149871, loss_d: 0.393453
0.7689 --- loss: 1.267989, loss_ss: 0.969762, loss_d: 0.298226
0.8074 --- loss: 1.491699, loss_ss: 1.055768, loss_d: 0.435930
0.8458 --- loss: 1.728889, loss_ss: 0.970164, loss_d: 0.758725
0.8843 --- loss: 1.434572, loss_ss: 1.146215, loss_d: 0.288357
0.9227 --- loss: 1.433518, loss_ss: 1.191837, loss_d: 0.241681
0.9612 --- loss: 1.477563, loss_ss: 1.085674, loss_d: 0.391889
0.9996 --- loss: 2.788531, loss_ss: 1.147290, loss_d: 1.641241
Epoch finished! Loss: 1.5812611002188461
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.232720, loss_ss: 0.960460, loss_d: 0.272260
0.0384 --- loss: 2.272013, loss_ss: 1.488410, loss_d: 0.783604
0.0769 --- loss: 1.481820, loss_ss: 1.103546, loss_d: 0.378274
0.1153 --- loss: 1.323314, loss_ss: 0.916446, loss_d: 0.406868
0.1538 --- loss: 1.381437, loss_ss: 1.060859, loss_d: 0.320578
0.1922 --- loss: 1.654137, loss_ss: 1.351882, loss_d: 0.302255
0.2307 --- loss: 1.245248, loss_ss: 0.880500, loss_d: 0.364748
0.2691 --- loss: 1.706058, loss_ss: 1.264639, loss_d: 0.441419
0.3076 --- loss: 1.320867, loss_ss: 0.991990, loss_d: 0.328877
0.3460 --- loss: 2.117647, loss_ss: 1.430991, loss_d: 0.686656
0.3845 --- loss: 1.674346, loss_ss: 0.962200, loss_d: 0.712146
0.4229 --- loss: 1.521731, loss_ss: 1.122920, loss_d: 0.398811
0.4614 --- loss: 1.856707, loss_ss: 1.163054, loss_d: 0.693653
0.4998 --- loss: 1.510663, loss_ss: 0.998391, loss_d: 0.512272
0.5383 --- loss: 1.342351, loss_ss: 0.970652, loss_d: 0.371699
0.5767 --- loss: 1.401531, loss_ss: 1.060699, loss_d: 0.340832
0.6151 --- loss: 1.957464, loss_ss: 1.405766, loss_d: 0.551698
0.6536 --- loss: 1.463670, loss_ss: 0.962712, loss_d: 0.500958
0.6920 --- loss: 1.962086, loss_ss: 1.202796, loss_d: 0.759290
0.7305 --- loss: 1.213357, loss_ss: 0.863230, loss_d: 0.350126
0.7689 --- loss: 1.538734, loss_ss: 1.041577, loss_d: 0.497157
0.8074 --- loss: 1.530192, loss_ss: 1.196186, loss_d: 0.334005
0.8458 --- loss: 1.724405, loss_ss: 1.332831, loss_d: 0.391574
0.8843 --- loss: 1.256449, loss_ss: 1.099977, loss_d: 0.156473
0.9227 --- loss: 1.720633, loss_ss: 1.098241, loss_d: 0.622393
0.9612 --- loss: 1.223778, loss_ss: 0.972990, loss_d: 0.250789
0.9996 --- loss: 1.449846, loss_ss: 1.156067, loss_d: 0.293778
Epoch finished! Loss: 1.574152204165092
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 2.232237, loss_ss: 1.140185, loss_d: 1.092051
0.0384 --- loss: 1.396412, loss_ss: 1.013564, loss_d: 0.382847
0.0769 --- loss: 2.231952, loss_ss: 1.641553, loss_d: 0.590398
0.1153 --- loss: 1.578978, loss_ss: 1.124905, loss_d: 0.454073
0.1538 --- loss: 1.816985, loss_ss: 1.200878, loss_d: 0.616107
0.1922 --- loss: 1.794309, loss_ss: 1.072195, loss_d: 0.722114
0.2307 --- loss: 1.552599, loss_ss: 1.177686, loss_d: 0.374913
0.2691 --- loss: 1.279710, loss_ss: 1.002102, loss_d: 0.277609
0.3076 --- loss: 1.234952, loss_ss: 0.980777, loss_d: 0.254174
0.3460 --- loss: 1.702629, loss_ss: 1.417115, loss_d: 0.285514
0.3845 --- loss: 1.829636, loss_ss: 1.243898, loss_d: 0.585738
0.4229 --- loss: 1.349574, loss_ss: 0.914548, loss_d: 0.435025
0.4614 --- loss: 1.944025, loss_ss: 1.211307, loss_d: 0.732717
0.4998 --- loss: 1.666819, loss_ss: 0.974660, loss_d: 0.692158
0.5383 --- loss: 1.425476, loss_ss: 1.039928, loss_d: 0.385548
0.5767 --- loss: 1.792732, loss_ss: 1.397017, loss_d: 0.395716
0.6151 --- loss: 1.709561, loss_ss: 1.200547, loss_d: 0.509014
0.6536 --- loss: 1.307112, loss_ss: 0.982339, loss_d: 0.324773
0.6920 --- loss: 1.260619, loss_ss: 0.889299, loss_d: 0.371320
0.7305 --- loss: 1.924949, loss_ss: 1.265154, loss_d: 0.659795
0.7689 --- loss: 1.477136, loss_ss: 0.907504, loss_d: 0.569632
0.8074 --- loss: 1.501556, loss_ss: 1.061638, loss_d: 0.439918
0.8458 --- loss: 1.351005, loss_ss: 0.997564, loss_d: 0.353442
0.8843 --- loss: 1.396124, loss_ss: 0.986899, loss_d: 0.409225
0.9227 --- loss: 1.571613, loss_ss: 0.841214, loss_d: 0.730399
0.9612 --- loss: 1.295372, loss_ss: 0.757854, loss_d: 0.537518
0.9996 --- loss: 4.877839, loss_ss: 2.951413, loss_d: 1.926426
Epoch finished! Loss: 1.5546671349268693
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.319038, loss_ss: 1.366241, loss_d: 0.952798
0.0384 --- loss: 1.512352, loss_ss: 0.894053, loss_d: 0.618298
0.0769 --- loss: 1.246497, loss_ss: 0.851746, loss_d: 0.394751
0.1153 --- loss: 1.271863, loss_ss: 0.977194, loss_d: 0.294669
0.1538 --- loss: 1.512068, loss_ss: 1.058848, loss_d: 0.453220
0.1922 --- loss: 1.414790, loss_ss: 0.935331, loss_d: 0.479459
0.2307 --- loss: 1.348085, loss_ss: 0.975929, loss_d: 0.372156
0.2691 --- loss: 1.314904, loss_ss: 1.070683, loss_d: 0.244221
0.3076 --- loss: 1.298959, loss_ss: 0.928996, loss_d: 0.369963
0.3460 --- loss: 1.296673, loss_ss: 0.985442, loss_d: 0.311231
0.3845 --- loss: 1.595309, loss_ss: 1.116297, loss_d: 0.479012
0.4229 --- loss: 1.258371, loss_ss: 0.974402, loss_d: 0.283970
0.4614 --- loss: 1.325316, loss_ss: 1.113084, loss_d: 0.212233
0.4998 --- loss: 2.456539, loss_ss: 1.583401, loss_d: 0.873138
0.5383 --- loss: 1.744937, loss_ss: 1.469398, loss_d: 0.275539
0.5767 --- loss: 1.107122, loss_ss: 0.858863, loss_d: 0.248259
0.6151 --- loss: 1.456374, loss_ss: 0.998004, loss_d: 0.458370
0.6536 --- loss: 1.803334, loss_ss: 1.450759, loss_d: 0.352575
0.6920 --- loss: 1.526652, loss_ss: 0.856843, loss_d: 0.669809
0.7305 --- loss: 1.429630, loss_ss: 0.960730, loss_d: 0.468899
0.7689 --- loss: 2.403546, loss_ss: 1.089909, loss_d: 1.313637
0.8074 --- loss: 1.357430, loss_ss: 0.902599, loss_d: 0.454830
0.8458 --- loss: 1.403802, loss_ss: 1.094318, loss_d: 0.309485
0.8843 --- loss: 1.420728, loss_ss: 1.092902, loss_d: 0.327826
0.9227 --- loss: 1.526973, loss_ss: 1.259209, loss_d: 0.267764
0.9612 --- loss: 1.136185, loss_ss: 0.903560, loss_d: 0.232625
0.9996 --- loss: 1.970834, loss_ss: 1.742470, loss_d: 0.228364
Epoch finished! Loss: 1.5031897141383244
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5081081081081081
             precision    recall  f1-score   support

        0.0       0.58      0.89      0.70       232
        1.0       0.00      0.00      0.00       179
        2.0       0.68      0.10      0.18       246
        3.0       0.98      0.75      0.85       339
        4.0       0.17      0.69      0.28       114

avg / total       0.59      0.51      0.47      1110
 


====== chp024-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  84.05  89.22   82.69  57.66     70.05
1  83.87   0.00  100.00   0.00      0.00
2  79.01  10.16   98.61  67.57     17.67
3  91.80  74.63   99.35  98.06     84.76
4  62.88  69.30   62.15  17.32     27.72
Total accuracy: 50.81%
Average sen: 48.66%
Average spec: 88.56%
Macro f1-score: 40.04%
[0.99543387 0.99547821 0.99853241 0.99192941 0.99869978 0.99917859
 0.99825579 0.99201798 0.99852234 0.99258053 0.9984647  0.99876273
 0.9970907  0.99567986 0.99921536 0.9946689  0.99875224 0.99826354
 0.99700886 0.99885499 0.99917513 0.9985286  0.99850744 0.99868459
 0.99782419 0.99884641 0.9987458  0.98969436 0.99624038 0.99716634
 0.99763513 0.9992187  0.99769908 0.99916589 0.99926752 0.99862134
 0.99907804]
pred: 0.9973375603959367, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.376596, loss_ss: 1.685361, loss_d: 0.691236
0.0381 --- loss: 2.884885, loss_ss: 1.668308, loss_d: 1.216576
0.0762 --- loss: 2.047079, loss_ss: 1.632015, loss_d: 0.415065
0.1143 --- loss: 2.173234, loss_ss: 1.604232, loss_d: 0.569001
0.1524 --- loss: 2.416363, loss_ss: 1.658560, loss_d: 0.757803
0.1905 --- loss: 2.244958, loss_ss: 1.595748, loss_d: 0.649210
0.2287 --- loss: 2.371123, loss_ss: 1.696049, loss_d: 0.675073
0.2668 --- loss: 2.362710, loss_ss: 1.742017, loss_d: 0.620693
0.3049 --- loss: 2.345710, loss_ss: 1.704120, loss_d: 0.641590
0.3430 --- loss: 2.156800, loss_ss: 1.671638, loss_d: 0.485162
0.3811 --- loss: 2.034344, loss_ss: 1.639074, loss_d: 0.395270
0.4192 --- loss: 1.914888, loss_ss: 1.619136, loss_d: 0.295752
0.4573 --- loss: 2.266265, loss_ss: 1.596102, loss_d: 0.670163
0.4954 --- loss: 2.068466, loss_ss: 1.633149, loss_d: 0.435317
0.5335 --- loss: 2.285316, loss_ss: 1.606803, loss_d: 0.678514
0.5716 --- loss: 2.166463, loss_ss: 1.528879, loss_d: 0.637584
0.6098 --- loss: 2.234950, loss_ss: 1.545447, loss_d: 0.689503
0.6479 --- loss: 2.100850, loss_ss: 1.577306, loss_d: 0.523544
0.6860 --- loss: 2.209696, loss_ss: 1.521971, loss_d: 0.687724
0.7241 --- loss: 2.122438, loss_ss: 1.671248, loss_d: 0.451189
0.7622 --- loss: 2.069580, loss_ss: 1.503516, loss_d: 0.566064
0.8003 --- loss: 2.190763, loss_ss: 1.577131, loss_d: 0.613632
0.8384 --- loss: 2.182237, loss_ss: 1.532265, loss_d: 0.649972
0.8765 --- loss: 1.986960, loss_ss: 1.485815, loss_d: 0.501145
0.9146 --- loss: 2.661127, loss_ss: 1.488979, loss_d: 1.172148
0.9527 --- loss: 2.180907, loss_ss: 1.513162, loss_d: 0.667745
0.9909 --- loss: 1.954080, loss_ss: 1.344859, loss_d: 0.609221
Epoch finished! Loss: 2.1480159318174117
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.079438, loss_ss: 1.537849, loss_d: 0.541589
0.0381 --- loss: 2.115035, loss_ss: 1.622624, loss_d: 0.492411
0.0762 --- loss: 2.213766, loss_ss: 1.560633, loss_d: 0.653133
0.1143 --- loss: 2.357486, loss_ss: 1.496058, loss_d: 0.861428
0.1524 --- loss: 2.088148, loss_ss: 1.541865, loss_d: 0.546283
0.1905 --- loss: 2.032856, loss_ss: 1.484724, loss_d: 0.548133
0.2287 --- loss: 1.798923, loss_ss: 1.337408, loss_d: 0.461516
0.2668 --- loss: 1.939481, loss_ss: 1.431578, loss_d: 0.507903
0.3049 --- loss: 1.914972, loss_ss: 1.494585, loss_d: 0.420387
0.3430 --- loss: 1.989147, loss_ss: 1.507219, loss_d: 0.481928
0.3811 --- loss: 2.008608, loss_ss: 1.520053, loss_d: 0.488555
0.4192 --- loss: 2.071178, loss_ss: 1.656272, loss_d: 0.414905
0.4573 --- loss: 1.870678, loss_ss: 1.527769, loss_d: 0.342909
0.4954 --- loss: 2.026729, loss_ss: 1.454501, loss_d: 0.572228
0.5335 --- loss: 1.721916, loss_ss: 1.401573, loss_d: 0.320343
0.5716 --- loss: 1.914331, loss_ss: 1.625222, loss_d: 0.289109
0.6098 --- loss: 1.876838, loss_ss: 1.359807, loss_d: 0.517031
0.6479 --- loss: 1.956497, loss_ss: 1.389127, loss_d: 0.567371
0.6860 --- loss: 2.078334, loss_ss: 1.533664, loss_d: 0.544670
0.7241 --- loss: 2.102846, loss_ss: 1.405427, loss_d: 0.697418
0.7622 --- loss: 1.905445, loss_ss: 1.417407, loss_d: 0.488037
0.8003 --- loss: 2.023819, loss_ss: 1.438064, loss_d: 0.585756
0.8384 --- loss: 1.977393, loss_ss: 1.505786, loss_d: 0.471607
0.8765 --- loss: 1.788764, loss_ss: 1.320640, loss_d: 0.468124
0.9146 --- loss: 1.848904, loss_ss: 1.465635, loss_d: 0.383268
0.9527 --- loss: 1.858957, loss_ss: 1.402211, loss_d: 0.456746
0.9909 --- loss: 1.905003, loss_ss: 1.414261, loss_d: 0.490742
Epoch finished! Loss: 2.041682879433377
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.987326, loss_ss: 1.536088, loss_d: 0.451238
0.0381 --- loss: 1.967736, loss_ss: 1.439950, loss_d: 0.527787
0.0762 --- loss: 1.782911, loss_ss: 1.340388, loss_d: 0.442523
0.1143 --- loss: 2.137834, loss_ss: 1.642339, loss_d: 0.495494
0.1524 --- loss: 1.841468, loss_ss: 1.455318, loss_d: 0.386149
0.1905 --- loss: 1.982633, loss_ss: 1.276499, loss_d: 0.706135
0.2287 --- loss: 2.079224, loss_ss: 1.658611, loss_d: 0.420613
0.2668 --- loss: 1.980007, loss_ss: 1.593654, loss_d: 0.386353
0.3049 --- loss: 1.996754, loss_ss: 1.414752, loss_d: 0.582002
0.3430 --- loss: 1.707222, loss_ss: 1.241618, loss_d: 0.465603
0.3811 --- loss: 1.845299, loss_ss: 1.396365, loss_d: 0.448934
0.4192 --- loss: 1.998389, loss_ss: 1.576824, loss_d: 0.421565
0.4573 --- loss: 1.850534, loss_ss: 1.451015, loss_d: 0.399519
0.4954 --- loss: 1.801863, loss_ss: 1.284591, loss_d: 0.517271
0.5335 --- loss: 1.862239, loss_ss: 1.530297, loss_d: 0.331942
0.5716 --- loss: 1.785362, loss_ss: 1.455975, loss_d: 0.329387
0.6098 --- loss: 1.876696, loss_ss: 1.407935, loss_d: 0.468761
0.6479 --- loss: 1.908406, loss_ss: 1.406563, loss_d: 0.501842
0.6860 --- loss: 1.809459, loss_ss: 1.447672, loss_d: 0.361788
0.7241 --- loss: 1.810875, loss_ss: 1.475751, loss_d: 0.335124
0.7622 --- loss: 2.206363, loss_ss: 1.713626, loss_d: 0.492737
0.8003 --- loss: 2.507193, loss_ss: 1.495832, loss_d: 1.011361
0.8384 --- loss: 1.651649, loss_ss: 1.294736, loss_d: 0.356912
0.8765 --- loss: 1.693461, loss_ss: 1.258634, loss_d: 0.434827
0.9146 --- loss: 2.280512, loss_ss: 1.703102, loss_d: 0.577410
0.9527 --- loss: 2.175268, loss_ss: 1.397171, loss_d: 0.778096
0.9909 --- loss: 2.147547, loss_ss: 1.470067, loss_d: 0.677480
Epoch finished! Loss: 1.9866599094776707
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.943990, loss_ss: 1.259625, loss_d: 0.684366
0.0381 --- loss: 1.812510, loss_ss: 1.156986, loss_d: 0.655525
0.0762 --- loss: 1.813793, loss_ss: 1.313093, loss_d: 0.500701
0.1143 --- loss: 1.767876, loss_ss: 1.439151, loss_d: 0.328725
0.1524 --- loss: 1.737114, loss_ss: 1.402180, loss_d: 0.334933
0.1905 --- loss: 1.774556, loss_ss: 1.384300, loss_d: 0.390255
0.2287 --- loss: 1.891151, loss_ss: 1.540865, loss_d: 0.350286
0.2668 --- loss: 2.621337, loss_ss: 1.467687, loss_d: 1.153650
0.3049 --- loss: 1.848534, loss_ss: 1.278053, loss_d: 0.570481
0.3430 --- loss: 1.943050, loss_ss: 1.545911, loss_d: 0.397139
0.3811 --- loss: 1.956686, loss_ss: 1.564849, loss_d: 0.391838
0.4192 --- loss: 1.980175, loss_ss: 1.341932, loss_d: 0.638243
0.4573 --- loss: 2.074268, loss_ss: 1.570060, loss_d: 0.504207
0.4954 --- loss: 1.894563, loss_ss: 1.455871, loss_d: 0.438693
0.5335 --- loss: 1.817759, loss_ss: 1.384709, loss_d: 0.433050
0.5716 --- loss: 1.773670, loss_ss: 1.436137, loss_d: 0.337533
0.6098 --- loss: 1.904086, loss_ss: 1.369541, loss_d: 0.534545
0.6479 --- loss: 1.803400, loss_ss: 1.462985, loss_d: 0.340415
0.6860 --- loss: 1.842159, loss_ss: 1.248864, loss_d: 0.593295
0.7241 --- loss: 1.858034, loss_ss: 1.397613, loss_d: 0.460422
0.7622 --- loss: 1.866738, loss_ss: 1.441944, loss_d: 0.424794
0.8003 --- loss: 1.976157, loss_ss: 1.485703, loss_d: 0.490453
0.8384 --- loss: 1.822329, loss_ss: 1.432646, loss_d: 0.389683
0.8765 --- loss: 2.013624, loss_ss: 1.457043, loss_d: 0.556581
0.9146 --- loss: 1.786974, loss_ss: 1.431138, loss_d: 0.355836
0.9527 --- loss: 1.917379, loss_ss: 1.505662, loss_d: 0.411717
0.9909 --- loss: 1.714718, loss_ss: 1.279022, loss_d: 0.435696
Epoch finished! Loss: 1.921851371535818
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.866743, loss_ss: 1.321965, loss_d: 0.544778
0.0381 --- loss: 2.034363, loss_ss: 1.595573, loss_d: 0.438790
0.0762 --- loss: 2.177619, loss_ss: 1.467972, loss_d: 0.709647
0.1143 --- loss: 1.817553, loss_ss: 1.381284, loss_d: 0.436269
0.1524 --- loss: 1.633840, loss_ss: 1.317588, loss_d: 0.316252
0.1905 --- loss: 1.707439, loss_ss: 1.308146, loss_d: 0.399294
0.2287 --- loss: 2.108937, loss_ss: 1.366338, loss_d: 0.742599
0.2668 --- loss: 1.846225, loss_ss: 1.343361, loss_d: 0.502864
0.3049 --- loss: 1.902738, loss_ss: 1.275114, loss_d: 0.627625
0.3430 --- loss: 1.934439, loss_ss: 1.281554, loss_d: 0.652885
0.3811 --- loss: 1.826935, loss_ss: 1.407568, loss_d: 0.419367
0.4192 --- loss: 2.174177, loss_ss: 1.338980, loss_d: 0.835197
0.4573 --- loss: 1.767621, loss_ss: 1.428545, loss_d: 0.339076
0.4954 --- loss: 1.632608, loss_ss: 1.168717, loss_d: 0.463892
0.5335 --- loss: 1.752100, loss_ss: 1.336640, loss_d: 0.415460
0.5716 --- loss: 2.036737, loss_ss: 1.608339, loss_d: 0.428398
0.6098 --- loss: 1.708791, loss_ss: 1.338740, loss_d: 0.370051
0.6479 --- loss: 1.718880, loss_ss: 1.160542, loss_d: 0.558339
0.6860 --- loss: 1.902377, loss_ss: 1.524688, loss_d: 0.377689
0.7241 --- loss: 1.736860, loss_ss: 1.290201, loss_d: 0.446659
0.7622 --- loss: 1.648739, loss_ss: 1.265993, loss_d: 0.382745
0.8003 --- loss: 1.987518, loss_ss: 1.411037, loss_d: 0.576481
0.8384 --- loss: 1.644917, loss_ss: 1.300653, loss_d: 0.344265
0.8765 --- loss: 1.864508, loss_ss: 1.465931, loss_d: 0.398577
0.9146 --- loss: 1.967628, loss_ss: 1.306823, loss_d: 0.660804
0.9527 --- loss: 1.543145, loss_ss: 1.138422, loss_d: 0.404723
0.9909 --- loss: 1.825364, loss_ss: 1.181067, loss_d: 0.644297
Epoch finished! Loss: 1.8084631407533893
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.814192, loss_ss: 1.346443, loss_d: 0.467749
0.0381 --- loss: 1.581539, loss_ss: 1.242072, loss_d: 0.339468
0.0762 --- loss: 1.832653, loss_ss: 1.351427, loss_d: 0.481226
0.1143 --- loss: 1.698382, loss_ss: 1.341084, loss_d: 0.357298
0.1524 --- loss: 1.450782, loss_ss: 1.048898, loss_d: 0.401883
0.1905 --- loss: 1.606678, loss_ss: 1.209874, loss_d: 0.396804
0.2287 --- loss: 1.832491, loss_ss: 1.372487, loss_d: 0.460004
0.2668 --- loss: 1.736381, loss_ss: 1.330893, loss_d: 0.405488
0.3049 --- loss: 1.463433, loss_ss: 1.064376, loss_d: 0.399057
0.3430 --- loss: 2.162958, loss_ss: 1.314074, loss_d: 0.848884
0.3811 --- loss: 1.843041, loss_ss: 1.379057, loss_d: 0.463983
0.4192 --- loss: 1.846201, loss_ss: 1.125772, loss_d: 0.720429
0.4573 --- loss: 1.525882, loss_ss: 1.130527, loss_d: 0.395354
0.4954 --- loss: 1.634376, loss_ss: 1.294352, loss_d: 0.340024
0.5335 --- loss: 1.943601, loss_ss: 1.348275, loss_d: 0.595326
0.5716 --- loss: 1.249165, loss_ss: 0.970100, loss_d: 0.279065
0.6098 --- loss: 1.303402, loss_ss: 1.013583, loss_d: 0.289818
0.6479 --- loss: 1.624609, loss_ss: 1.108935, loss_d: 0.515674
0.6860 --- loss: 2.015559, loss_ss: 1.397946, loss_d: 0.617613
0.7241 --- loss: 1.672044, loss_ss: 1.232714, loss_d: 0.439330
0.7622 --- loss: 1.975832, loss_ss: 1.303398, loss_d: 0.672433
0.8003 --- loss: 1.392940, loss_ss: 1.031515, loss_d: 0.361424
0.8384 --- loss: 1.571564, loss_ss: 1.267886, loss_d: 0.303678
0.8765 --- loss: 1.482104, loss_ss: 1.222035, loss_d: 0.260069
0.9146 --- loss: 1.887823, loss_ss: 1.536149, loss_d: 0.351674
0.9527 --- loss: 1.869140, loss_ss: 1.195246, loss_d: 0.673895
0.9909 --- loss: 1.564840, loss_ss: 1.142835, loss_d: 0.422005
Epoch finished! Loss: 1.7055382683076932
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.877823, loss_ss: 1.159883, loss_d: 0.717940
0.0381 --- loss: 2.502684, loss_ss: 1.142284, loss_d: 1.360399
0.0762 --- loss: 1.448718, loss_ss: 1.001890, loss_d: 0.446828
0.1143 --- loss: 1.435626, loss_ss: 0.984163, loss_d: 0.451463
0.1524 --- loss: 1.457787, loss_ss: 1.129779, loss_d: 0.328008
0.1905 --- loss: 1.361911, loss_ss: 1.024406, loss_d: 0.337505
0.2287 --- loss: 1.532284, loss_ss: 0.980928, loss_d: 0.551356
0.2668 --- loss: 1.790097, loss_ss: 1.304588, loss_d: 0.485509
0.3049 --- loss: 1.655624, loss_ss: 1.309527, loss_d: 0.346097
0.3430 --- loss: 1.792654, loss_ss: 1.143523, loss_d: 0.649131
0.3811 --- loss: 1.601324, loss_ss: 1.168523, loss_d: 0.432801
0.4192 --- loss: 1.649806, loss_ss: 1.112683, loss_d: 0.537123
0.4573 --- loss: 1.898095, loss_ss: 1.225049, loss_d: 0.673046
0.4954 --- loss: 1.690296, loss_ss: 1.158408, loss_d: 0.531888
0.5335 --- loss: 1.839949, loss_ss: 1.190069, loss_d: 0.649880
0.5716 --- loss: 1.843073, loss_ss: 1.076288, loss_d: 0.766785
0.6098 --- loss: 1.484455, loss_ss: 1.051254, loss_d: 0.433202
0.6479 --- loss: 1.546715, loss_ss: 1.211926, loss_d: 0.334789
0.6860 --- loss: 1.673637, loss_ss: 0.933072, loss_d: 0.740565
0.7241 --- loss: 1.553668, loss_ss: 1.143441, loss_d: 0.410226
0.7622 --- loss: 1.526299, loss_ss: 1.117922, loss_d: 0.408377
0.8003 --- loss: 1.267626, loss_ss: 0.851675, loss_d: 0.415951
0.8384 --- loss: 1.677805, loss_ss: 1.283471, loss_d: 0.394334
0.8765 --- loss: 2.290521, loss_ss: 1.784153, loss_d: 0.506367
0.9146 --- loss: 1.571414, loss_ss: 1.223263, loss_d: 0.348151
0.9527 --- loss: 1.465488, loss_ss: 1.103801, loss_d: 0.361687
0.9909 --- loss: 1.773343, loss_ss: 1.396824, loss_d: 0.376520
Epoch finished! Loss: 1.63576017672779
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.067073, loss_ss: 1.276315, loss_d: 0.790758
0.0381 --- loss: 1.342806, loss_ss: 0.995892, loss_d: 0.346914
0.0762 --- loss: 1.744731, loss_ss: 1.043619, loss_d: 0.701111
0.1143 --- loss: 2.143454, loss_ss: 0.872616, loss_d: 1.270838
0.1524 --- loss: 1.917828, loss_ss: 1.212768, loss_d: 0.705059
0.1905 --- loss: 1.456779, loss_ss: 0.981418, loss_d: 0.475361
0.2287 --- loss: 1.805057, loss_ss: 0.909188, loss_d: 0.895869
0.2668 --- loss: 2.099922, loss_ss: 1.390665, loss_d: 0.709257
0.3049 --- loss: 2.020745, loss_ss: 1.489335, loss_d: 0.531410
0.3430 --- loss: 1.680943, loss_ss: 0.920526, loss_d: 0.760417
0.3811 --- loss: 1.612307, loss_ss: 1.150900, loss_d: 0.461407
0.4192 --- loss: 1.477258, loss_ss: 1.099230, loss_d: 0.378028
0.4573 --- loss: 1.371679, loss_ss: 0.986863, loss_d: 0.384815
0.4954 --- loss: 1.163415, loss_ss: 0.870824, loss_d: 0.292590
0.5335 --- loss: 1.337526, loss_ss: 1.042545, loss_d: 0.294981
0.5716 --- loss: 1.692827, loss_ss: 1.103062, loss_d: 0.589765
0.6098 --- loss: 1.887447, loss_ss: 1.508136, loss_d: 0.379312
0.6479 --- loss: 1.716636, loss_ss: 1.296343, loss_d: 0.420293
0.6860 --- loss: 1.771737, loss_ss: 1.281268, loss_d: 0.490470
0.7241 --- loss: 1.706578, loss_ss: 1.187112, loss_d: 0.519466
0.7622 --- loss: 1.749999, loss_ss: 1.348307, loss_d: 0.401692
0.8003 --- loss: 1.621159, loss_ss: 1.129208, loss_d: 0.491951
0.8384 --- loss: 2.292739, loss_ss: 1.423563, loss_d: 0.869176
0.8765 --- loss: 1.595750, loss_ss: 1.283461, loss_d: 0.312289
0.9146 --- loss: 1.541646, loss_ss: 1.047067, loss_d: 0.494579
0.9527 --- loss: 1.571211, loss_ss: 0.989184, loss_d: 0.582027
0.9909 --- loss: 1.258909, loss_ss: 0.913542, loss_d: 0.345367
Epoch finished! Loss: 1.5890392424496076
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.271567, loss_ss: 0.962453, loss_d: 0.309114
0.0381 --- loss: 1.690291, loss_ss: 1.269400, loss_d: 0.420890
0.0762 --- loss: 1.743851, loss_ss: 1.346872, loss_d: 0.396979
0.1143 --- loss: 1.383325, loss_ss: 1.010323, loss_d: 0.373002
0.1524 --- loss: 1.644810, loss_ss: 1.216766, loss_d: 0.428044
0.1905 --- loss: 1.242467, loss_ss: 0.907878, loss_d: 0.334589
0.2287 --- loss: 1.793764, loss_ss: 1.377553, loss_d: 0.416210
0.2668 --- loss: 1.563122, loss_ss: 1.062675, loss_d: 0.500447
0.3049 --- loss: 1.674184, loss_ss: 1.196398, loss_d: 0.477787
0.3430 --- loss: 1.558676, loss_ss: 1.215525, loss_d: 0.343151
0.3811 --- loss: 1.700812, loss_ss: 0.962225, loss_d: 0.738586
0.4192 --- loss: 2.269062, loss_ss: 1.188018, loss_d: 1.081044
0.4573 --- loss: 1.350915, loss_ss: 1.003114, loss_d: 0.347801
0.4954 --- loss: 1.471925, loss_ss: 1.018301, loss_d: 0.453624
0.5335 --- loss: 1.378034, loss_ss: 0.984358, loss_d: 0.393676
0.5716 --- loss: 1.326634, loss_ss: 0.874248, loss_d: 0.452386
0.6098 --- loss: 1.779990, loss_ss: 1.341828, loss_d: 0.438163
0.6479 --- loss: 1.348881, loss_ss: 1.009529, loss_d: 0.339352
0.6860 --- loss: 1.307226, loss_ss: 1.007524, loss_d: 0.299701
0.7241 --- loss: 1.237576, loss_ss: 0.891124, loss_d: 0.346452
0.7622 --- loss: 1.617066, loss_ss: 1.047757, loss_d: 0.569309
0.8003 --- loss: 1.827784, loss_ss: 1.451552, loss_d: 0.376233
0.8384 --- loss: 1.361494, loss_ss: 1.000727, loss_d: 0.360767
0.8765 --- loss: 1.515984, loss_ss: 0.984232, loss_d: 0.531752
0.9146 --- loss: 1.514500, loss_ss: 1.131992, loss_d: 0.382508
0.9527 --- loss: 1.552392, loss_ss: 1.162412, loss_d: 0.389980
0.9909 --- loss: 1.642420, loss_ss: 1.231230, loss_d: 0.411189
Epoch finished! Loss: 1.574415822520511
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.986061, loss_ss: 1.193460, loss_d: 0.792601
0.0381 --- loss: 1.501586, loss_ss: 1.205644, loss_d: 0.295943
0.0762 --- loss: 1.750554, loss_ss: 1.194543, loss_d: 0.556012
0.1143 --- loss: 1.480838, loss_ss: 1.159876, loss_d: 0.320962
0.1524 --- loss: 1.274451, loss_ss: 0.881377, loss_d: 0.393074
0.1905 --- loss: 1.373970, loss_ss: 0.937231, loss_d: 0.436739
0.2287 --- loss: 1.478888, loss_ss: 1.137969, loss_d: 0.340918
0.2668 --- loss: 1.396934, loss_ss: 1.065643, loss_d: 0.331291
0.3049 --- loss: 1.354481, loss_ss: 1.033743, loss_d: 0.320738
0.3430 --- loss: 1.801875, loss_ss: 0.946483, loss_d: 0.855392
0.3811 --- loss: 1.459845, loss_ss: 1.118215, loss_d: 0.341629
0.4192 --- loss: 1.513977, loss_ss: 1.052680, loss_d: 0.461296
0.4573 --- loss: 1.298936, loss_ss: 0.945298, loss_d: 0.353637
0.4954 --- loss: 1.440704, loss_ss: 1.033796, loss_d: 0.406908
0.5335 --- loss: 1.212453, loss_ss: 0.690962, loss_d: 0.521491
0.5716 --- loss: 1.519444, loss_ss: 1.173151, loss_d: 0.346293
0.6098 --- loss: 1.319687, loss_ss: 0.981060, loss_d: 0.338628
0.6479 --- loss: 1.471266, loss_ss: 0.976347, loss_d: 0.494919
0.6860 --- loss: 1.697850, loss_ss: 1.145795, loss_d: 0.552055
0.7241 --- loss: 1.158756, loss_ss: 0.794588, loss_d: 0.364167
0.7622 --- loss: 1.462721, loss_ss: 1.144913, loss_d: 0.317808
0.8003 --- loss: 1.375139, loss_ss: 0.963268, loss_d: 0.411871
0.8384 --- loss: 1.527618, loss_ss: 1.134885, loss_d: 0.392733
0.8765 --- loss: 1.306829, loss_ss: 0.966811, loss_d: 0.340018
0.9146 --- loss: 1.904494, loss_ss: 1.372288, loss_d: 0.532206
0.9527 --- loss: 1.590261, loss_ss: 1.232797, loss_d: 0.357464
0.9909 --- loss: 1.314244, loss_ss: 0.919001, loss_d: 0.395243
Epoch finished! Loss: 1.5517297459922674
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.23333333333333334
             precision    recall  f1-score   support

        0.0       0.97      0.12      0.22       304
        1.0       0.00      0.00      0.00        25
        2.0       0.00      0.00      0.00        29
        3.0       1.00      0.97      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.85      0.23      0.31       420
 


====== chp025-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  36.43  12.50   99.14   97.44     22.16
1  94.05   0.00  100.00    0.00      0.00
2  93.10   0.00  100.00    0.00      0.00
3  99.52  96.77  100.00  100.00     98.36
4  23.57    NaN   23.57    0.00       NaN
Total accuracy: 23.33%
Average sen: 27.32%
Average spec: 84.54%
Macro f1-score: 30.13%
[0.87994057 0.890607   0.91374147 0.90732491 0.92295027 0.92157716
 0.92127484 0.9091363  0.90629113 0.94597954 0.91332728 0.91441667
 0.92574072 0.91502368]
pred: 0.9133808229650769, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.457339, loss_ss: 1.719426, loss_d: 0.737912
0.0384 --- loss: 2.388749, loss_ss: 1.635242, loss_d: 0.753507
0.0767 --- loss: 1.937875, loss_ss: 1.538007, loss_d: 0.399868
0.1151 --- loss: 2.215892, loss_ss: 1.588537, loss_d: 0.627356
0.1534 --- loss: 2.232617, loss_ss: 1.583661, loss_d: 0.648956
0.1918 --- loss: 2.324521, loss_ss: 1.691048, loss_d: 0.633473
0.2301 --- loss: 1.963098, loss_ss: 1.578352, loss_d: 0.384746
0.2685 --- loss: 2.091472, loss_ss: 1.622130, loss_d: 0.469342
0.3069 --- loss: 2.025759, loss_ss: 1.515697, loss_d: 0.510062
0.3452 --- loss: 1.937741, loss_ss: 1.417881, loss_d: 0.519860
0.3836 --- loss: 2.181349, loss_ss: 1.579373, loss_d: 0.601976
0.4219 --- loss: 2.033597, loss_ss: 1.553214, loss_d: 0.480384
0.4603 --- loss: 1.820522, loss_ss: 1.552772, loss_d: 0.267750
0.4987 --- loss: 2.544734, loss_ss: 1.449437, loss_d: 1.095297
0.5370 --- loss: 1.856778, loss_ss: 1.471419, loss_d: 0.385359
0.5754 --- loss: 2.130222, loss_ss: 1.530481, loss_d: 0.599741
0.6137 --- loss: 2.089667, loss_ss: 1.462082, loss_d: 0.627585
0.6521 --- loss: 1.823516, loss_ss: 1.442466, loss_d: 0.381049
0.6904 --- loss: 2.069480, loss_ss: 1.600814, loss_d: 0.468667
0.7288 --- loss: 1.790747, loss_ss: 1.448155, loss_d: 0.342593
0.7672 --- loss: 2.007574, loss_ss: 1.628783, loss_d: 0.378791
0.8055 --- loss: 1.926512, loss_ss: 1.622484, loss_d: 0.304028
0.8439 --- loss: 1.852228, loss_ss: 1.481040, loss_d: 0.371188
0.8822 --- loss: 1.987886, loss_ss: 1.490194, loss_d: 0.497691
0.9206 --- loss: 2.092452, loss_ss: 1.444883, loss_d: 0.647570
0.9590 --- loss: 2.124789, loss_ss: 1.552142, loss_d: 0.572646
0.9973 --- loss: 1.756094, loss_ss: 1.267543, loss_d: 0.488551
Epoch finished! Loss: 2.0946829782082483
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.920300, loss_ss: 1.325684, loss_d: 0.594616
0.0384 --- loss: 1.696088, loss_ss: 1.395339, loss_d: 0.300749
0.0767 --- loss: 2.434712, loss_ss: 1.583014, loss_d: 0.851698
0.1151 --- loss: 2.052304, loss_ss: 1.455638, loss_d: 0.596666
0.1534 --- loss: 1.727768, loss_ss: 1.347493, loss_d: 0.380275
0.1918 --- loss: 1.917717, loss_ss: 1.382111, loss_d: 0.535606
0.2301 --- loss: 1.837408, loss_ss: 1.380563, loss_d: 0.456845
0.2685 --- loss: 1.801553, loss_ss: 1.494531, loss_d: 0.307021
0.3069 --- loss: 2.257117, loss_ss: 1.600821, loss_d: 0.656296
0.3452 --- loss: 2.148031, loss_ss: 1.412307, loss_d: 0.735724
0.3836 --- loss: 2.044353, loss_ss: 1.436240, loss_d: 0.608112
0.4219 --- loss: 1.956182, loss_ss: 1.559376, loss_d: 0.396806
0.4603 --- loss: 2.426435, loss_ss: 1.688275, loss_d: 0.738160
0.4987 --- loss: 2.238787, loss_ss: 1.402543, loss_d: 0.836245
0.5370 --- loss: 1.843409, loss_ss: 1.403386, loss_d: 0.440023
0.5754 --- loss: 1.945268, loss_ss: 1.411592, loss_d: 0.533676
0.6137 --- loss: 2.083753, loss_ss: 1.353649, loss_d: 0.730104
0.6521 --- loss: 2.711165, loss_ss: 1.541522, loss_d: 1.169644
0.6904 --- loss: 2.264769, loss_ss: 1.312841, loss_d: 0.951928
0.7288 --- loss: 1.896840, loss_ss: 1.427828, loss_d: 0.469012
0.7672 --- loss: 1.602306, loss_ss: 1.154491, loss_d: 0.447816
0.8055 --- loss: 1.813516, loss_ss: 1.075794, loss_d: 0.737722
0.8439 --- loss: 1.901313, loss_ss: 1.433445, loss_d: 0.467868
0.8822 --- loss: 2.012901, loss_ss: 1.521006, loss_d: 0.491895
0.9206 --- loss: 1.728202, loss_ss: 1.257800, loss_d: 0.470402
0.9590 --- loss: 1.789625, loss_ss: 1.363794, loss_d: 0.425832
0.9973 --- loss: 1.634514, loss_ss: 1.182589, loss_d: 0.451925
Epoch finished! Loss: 1.9555900555390577
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.996719, loss_ss: 1.418347, loss_d: 0.578373
0.0384 --- loss: 1.907583, loss_ss: 1.329224, loss_d: 0.578358
0.0767 --- loss: 2.035403, loss_ss: 1.234214, loss_d: 0.801189
0.1151 --- loss: 1.988846, loss_ss: 1.314517, loss_d: 0.674329
0.1534 --- loss: 1.927880, loss_ss: 1.365417, loss_d: 0.562463
0.1918 --- loss: 1.727934, loss_ss: 1.265855, loss_d: 0.462078
0.2301 --- loss: 1.868572, loss_ss: 1.302181, loss_d: 0.566390
0.2685 --- loss: 1.686150, loss_ss: 1.244620, loss_d: 0.441529
0.3069 --- loss: 1.641542, loss_ss: 1.277396, loss_d: 0.364145
0.3452 --- loss: 1.904406, loss_ss: 1.276030, loss_d: 0.628376
0.3836 --- loss: 2.158391, loss_ss: 1.363280, loss_d: 0.795111
0.4219 --- loss: 1.563326, loss_ss: 1.195969, loss_d: 0.367357
0.4603 --- loss: 1.907760, loss_ss: 1.576943, loss_d: 0.330817
0.4987 --- loss: 1.930109, loss_ss: 1.355147, loss_d: 0.574962
0.5370 --- loss: 1.646711, loss_ss: 1.244705, loss_d: 0.402006
0.5754 --- loss: 1.708685, loss_ss: 1.261469, loss_d: 0.447217
0.6137 --- loss: 1.696414, loss_ss: 1.281276, loss_d: 0.415138
0.6521 --- loss: 2.175636, loss_ss: 1.480783, loss_d: 0.694853
0.6904 --- loss: 1.757339, loss_ss: 1.239718, loss_d: 0.517621
0.7288 --- loss: 1.590133, loss_ss: 1.198401, loss_d: 0.391732
0.7672 --- loss: 1.532696, loss_ss: 1.171728, loss_d: 0.360969
0.8055 --- loss: 1.598822, loss_ss: 0.884962, loss_d: 0.713861
0.8439 --- loss: 1.514517, loss_ss: 1.062581, loss_d: 0.451936
0.8822 --- loss: 1.847479, loss_ss: 1.403658, loss_d: 0.443821
0.9206 --- loss: 1.677847, loss_ss: 1.092620, loss_d: 0.585227
0.9590 --- loss: 1.606634, loss_ss: 1.267226, loss_d: 0.339409
0.9973 --- loss: 1.452250, loss_ss: 1.127098, loss_d: 0.325152
Epoch finished! Loss: 1.8190502230937664
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.483831, loss_ss: 1.125617, loss_d: 0.358214
0.0384 --- loss: 2.039629, loss_ss: 1.342792, loss_d: 0.696837
0.0767 --- loss: 1.618202, loss_ss: 1.271014, loss_d: 0.347188
0.1151 --- loss: 1.556564, loss_ss: 1.191692, loss_d: 0.364872
0.1534 --- loss: 1.685116, loss_ss: 1.047023, loss_d: 0.638093
0.1918 --- loss: 1.630779, loss_ss: 1.117381, loss_d: 0.513398
0.2301 --- loss: 2.417867, loss_ss: 1.349976, loss_d: 1.067891
0.2685 --- loss: 1.750827, loss_ss: 1.117511, loss_d: 0.633316
0.3069 --- loss: 1.554582, loss_ss: 1.138599, loss_d: 0.415983
0.3452 --- loss: 2.277381, loss_ss: 1.670564, loss_d: 0.606817
0.3836 --- loss: 1.691986, loss_ss: 1.285191, loss_d: 0.406794
0.4219 --- loss: 1.338301, loss_ss: 1.028174, loss_d: 0.310127
0.4603 --- loss: 1.813807, loss_ss: 1.326117, loss_d: 0.487690
0.4987 --- loss: 1.833838, loss_ss: 1.275114, loss_d: 0.558724
0.5370 --- loss: 1.682204, loss_ss: 1.229672, loss_d: 0.452532
0.5754 --- loss: 1.306722, loss_ss: 0.917082, loss_d: 0.389641
0.6137 --- loss: 1.529090, loss_ss: 1.187451, loss_d: 0.341640
0.6521 --- loss: 2.457255, loss_ss: 1.665858, loss_d: 0.791397
0.6904 --- loss: 2.129249, loss_ss: 1.334069, loss_d: 0.795179
0.7288 --- loss: 1.752813, loss_ss: 0.980966, loss_d: 0.771848
0.7672 --- loss: 1.977301, loss_ss: 1.485679, loss_d: 0.491621
0.8055 --- loss: 1.704634, loss_ss: 1.273877, loss_d: 0.430757
0.8439 --- loss: 1.773376, loss_ss: 1.375462, loss_d: 0.397915
0.8822 --- loss: 1.604387, loss_ss: 1.188183, loss_d: 0.416205
0.9206 --- loss: 1.744028, loss_ss: 1.154704, loss_d: 0.589324
0.9590 --- loss: 1.503091, loss_ss: 1.116772, loss_d: 0.386319
0.9973 --- loss: 1.696310, loss_ss: 1.343116, loss_d: 0.353195
Epoch finished! Loss: 1.7146008633650267
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.053663, loss_ss: 1.429311, loss_d: 0.624353
0.0384 --- loss: 1.609715, loss_ss: 1.161676, loss_d: 0.448039
0.0767 --- loss: 1.489695, loss_ss: 1.183869, loss_d: 0.305826
0.1151 --- loss: 1.428034, loss_ss: 1.088409, loss_d: 0.339625
0.1534 --- loss: 1.602123, loss_ss: 1.070438, loss_d: 0.531685
0.1918 --- loss: 1.459655, loss_ss: 1.028804, loss_d: 0.430850
0.2301 --- loss: 1.453410, loss_ss: 1.038021, loss_d: 0.415389
0.2685 --- loss: 1.522007, loss_ss: 1.165579, loss_d: 0.356428
0.3069 --- loss: 1.719024, loss_ss: 1.144095, loss_d: 0.574929
0.3452 --- loss: 1.570121, loss_ss: 1.147485, loss_d: 0.422636
0.3836 --- loss: 1.914331, loss_ss: 1.407478, loss_d: 0.506853
0.4219 --- loss: 1.555346, loss_ss: 1.029092, loss_d: 0.526254
0.4603 --- loss: 1.654451, loss_ss: 1.218825, loss_d: 0.435626
0.4987 --- loss: 1.532501, loss_ss: 1.111468, loss_d: 0.421033
0.5370 --- loss: 1.376245, loss_ss: 1.072991, loss_d: 0.303254
0.5754 --- loss: 1.462962, loss_ss: 1.105431, loss_d: 0.357531
0.6137 --- loss: 1.509390, loss_ss: 1.131575, loss_d: 0.377815
0.6521 --- loss: 1.449282, loss_ss: 1.130052, loss_d: 0.319230
0.6904 --- loss: 2.074010, loss_ss: 1.726596, loss_d: 0.347415
0.7288 --- loss: 1.561797, loss_ss: 1.107872, loss_d: 0.453925
0.7672 --- loss: 1.760419, loss_ss: 1.372982, loss_d: 0.387437
0.8055 --- loss: 1.298411, loss_ss: 0.940994, loss_d: 0.357417
0.8439 --- loss: 1.368752, loss_ss: 1.039171, loss_d: 0.329581
0.8822 --- loss: 1.546367, loss_ss: 1.278087, loss_d: 0.268280
0.9206 --- loss: 1.633450, loss_ss: 1.275095, loss_d: 0.358355
0.9590 --- loss: 2.176195, loss_ss: 1.039009, loss_d: 1.137187
0.9973 --- loss: 1.348310, loss_ss: 0.840921, loss_d: 0.507389
Epoch finished! Loss: 1.655890007660939
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.718721, loss_ss: 1.146087, loss_d: 0.572635
0.0384 --- loss: 1.562514, loss_ss: 1.091601, loss_d: 0.470913
0.0767 --- loss: 1.646179, loss_ss: 1.257759, loss_d: 0.388420
0.1151 --- loss: 1.680194, loss_ss: 1.299064, loss_d: 0.381129
0.1534 --- loss: 1.493585, loss_ss: 1.079526, loss_d: 0.414059
0.1918 --- loss: 1.961279, loss_ss: 1.278240, loss_d: 0.683039
0.2301 --- loss: 1.526764, loss_ss: 1.094213, loss_d: 0.432551
0.2685 --- loss: 1.704947, loss_ss: 1.301309, loss_d: 0.403638
0.3069 --- loss: 1.562816, loss_ss: 1.187911, loss_d: 0.374905
0.3452 --- loss: 1.383091, loss_ss: 1.056542, loss_d: 0.326549
0.3836 --- loss: 1.413668, loss_ss: 1.029298, loss_d: 0.384370
0.4219 --- loss: 1.612051, loss_ss: 1.094545, loss_d: 0.517506
0.4603 --- loss: 1.591086, loss_ss: 1.182701, loss_d: 0.408385
0.4987 --- loss: 1.596861, loss_ss: 1.148404, loss_d: 0.448458
0.5370 --- loss: 1.326434, loss_ss: 0.897938, loss_d: 0.428496
0.5754 --- loss: 1.726682, loss_ss: 1.366774, loss_d: 0.359909
0.6137 --- loss: 1.582020, loss_ss: 0.991543, loss_d: 0.590476
0.6521 --- loss: 1.762226, loss_ss: 1.020379, loss_d: 0.741847
0.6904 --- loss: 1.785228, loss_ss: 1.316984, loss_d: 0.468244
0.7288 --- loss: 1.552887, loss_ss: 1.162692, loss_d: 0.390194
0.7672 --- loss: 1.623186, loss_ss: 1.046172, loss_d: 0.577014
0.8055 --- loss: 1.584522, loss_ss: 1.140997, loss_d: 0.443525
0.8439 --- loss: 1.300563, loss_ss: 0.970954, loss_d: 0.329608
0.8822 --- loss: 1.562779, loss_ss: 0.847940, loss_d: 0.714839
0.9206 --- loss: 1.279127, loss_ss: 0.935024, loss_d: 0.344103
0.9590 --- loss: 1.419727, loss_ss: 0.998558, loss_d: 0.421169
0.9973 --- loss: 1.622610, loss_ss: 1.190351, loss_d: 0.432260
Epoch finished! Loss: 1.6224697805367982
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.291641, loss_ss: 0.978637, loss_d: 0.313004
0.0384 --- loss: 1.499102, loss_ss: 0.928107, loss_d: 0.570995
0.0767 --- loss: 1.514899, loss_ss: 1.105376, loss_d: 0.409523
0.1151 --- loss: 1.535025, loss_ss: 1.107397, loss_d: 0.427628
0.1534 --- loss: 1.610982, loss_ss: 1.269550, loss_d: 0.341432
0.1918 --- loss: 1.404157, loss_ss: 0.954620, loss_d: 0.449537
0.2301 --- loss: 1.410093, loss_ss: 1.042612, loss_d: 0.367481
0.2685 --- loss: 1.237700, loss_ss: 0.836814, loss_d: 0.400886
0.3069 --- loss: 1.519756, loss_ss: 1.104786, loss_d: 0.414970
0.3452 --- loss: 1.510986, loss_ss: 1.078894, loss_d: 0.432092
0.3836 --- loss: 1.303343, loss_ss: 0.918473, loss_d: 0.384870
0.4219 --- loss: 1.470200, loss_ss: 1.040763, loss_d: 0.429437
0.4603 --- loss: 1.604332, loss_ss: 1.254696, loss_d: 0.349637
0.4987 --- loss: 1.470514, loss_ss: 1.075696, loss_d: 0.394818
0.5370 --- loss: 1.773314, loss_ss: 1.226788, loss_d: 0.546527
0.5754 --- loss: 1.327742, loss_ss: 0.924054, loss_d: 0.403688
0.6137 --- loss: 1.509101, loss_ss: 1.092378, loss_d: 0.416723
0.6521 --- loss: 1.784999, loss_ss: 1.444458, loss_d: 0.340541
0.6904 --- loss: 1.488091, loss_ss: 1.144129, loss_d: 0.343961
0.7288 --- loss: 1.630536, loss_ss: 1.071792, loss_d: 0.558744
0.7672 --- loss: 1.748376, loss_ss: 1.062519, loss_d: 0.685856
0.8055 --- loss: 1.646878, loss_ss: 1.280439, loss_d: 0.366439
0.8439 --- loss: 1.520011, loss_ss: 1.050438, loss_d: 0.469573
0.8822 --- loss: 1.588225, loss_ss: 1.127340, loss_d: 0.460884
0.9206 --- loss: 2.050806, loss_ss: 1.534966, loss_d: 0.515839
0.9590 --- loss: 1.273363, loss_ss: 0.930353, loss_d: 0.343009
0.9973 --- loss: 1.950469, loss_ss: 1.416218, loss_d: 0.534251
Epoch finished! Loss: 1.5874150624642005
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.610891, loss_ss: 1.259342, loss_d: 0.351550
0.0384 --- loss: 1.335367, loss_ss: 1.017073, loss_d: 0.318295
0.0767 --- loss: 1.793262, loss_ss: 1.448747, loss_d: 0.344515
0.1151 --- loss: 1.352028, loss_ss: 0.952160, loss_d: 0.399868
0.1534 --- loss: 2.448999, loss_ss: 1.051643, loss_d: 1.397356
0.1918 --- loss: 1.667705, loss_ss: 1.170198, loss_d: 0.497507
0.2301 --- loss: 1.647530, loss_ss: 1.063016, loss_d: 0.584514
0.2685 --- loss: 1.823722, loss_ss: 1.073583, loss_d: 0.750139
0.3069 --- loss: 1.632334, loss_ss: 1.149011, loss_d: 0.483323
0.3452 --- loss: 1.584134, loss_ss: 1.178481, loss_d: 0.405653
0.3836 --- loss: 2.267764, loss_ss: 0.895292, loss_d: 1.372472
0.4219 --- loss: 1.585334, loss_ss: 1.212964, loss_d: 0.372371
0.4603 --- loss: 1.564031, loss_ss: 1.196979, loss_d: 0.367051
0.4987 --- loss: 1.543126, loss_ss: 1.020008, loss_d: 0.523118
0.5370 --- loss: 1.877453, loss_ss: 1.346016, loss_d: 0.531437
0.5754 --- loss: 1.362297, loss_ss: 0.953386, loss_d: 0.408911
0.6137 --- loss: 2.430591, loss_ss: 1.005369, loss_d: 1.425223
0.6521 --- loss: 1.508193, loss_ss: 1.022164, loss_d: 0.486029
0.6904 --- loss: 1.478493, loss_ss: 1.094511, loss_d: 0.383982
0.7288 --- loss: 1.810750, loss_ss: 1.135941, loss_d: 0.674809
0.7672 --- loss: 1.346681, loss_ss: 0.887041, loss_d: 0.459641
0.8055 --- loss: 1.499335, loss_ss: 1.096827, loss_d: 0.402507
0.8439 --- loss: 1.532038, loss_ss: 1.137035, loss_d: 0.395003
0.8822 --- loss: 1.877164, loss_ss: 1.258089, loss_d: 0.619075
0.9206 --- loss: 1.524586, loss_ss: 1.099303, loss_d: 0.425283
0.9590 --- loss: 1.423700, loss_ss: 1.063575, loss_d: 0.360125
0.9973 --- loss: 1.700861, loss_ss: 1.126541, loss_d: 0.574320
Epoch finished! Loss: 1.6011950745032384
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.393459, loss_ss: 0.989117, loss_d: 0.404342
0.0384 --- loss: 1.329051, loss_ss: 0.970652, loss_d: 0.358398
0.0767 --- loss: 1.399864, loss_ss: 1.039966, loss_d: 0.359898
0.1151 --- loss: 1.392081, loss_ss: 1.029425, loss_d: 0.362656
0.1534 --- loss: 1.683837, loss_ss: 1.300524, loss_d: 0.383312
0.1918 --- loss: 1.430727, loss_ss: 1.101776, loss_d: 0.328951
0.2301 --- loss: 1.659908, loss_ss: 1.327418, loss_d: 0.332490
0.2685 --- loss: 1.792987, loss_ss: 1.160643, loss_d: 0.632344
0.3069 --- loss: 1.689849, loss_ss: 1.193842, loss_d: 0.496007
0.3452 --- loss: 1.595837, loss_ss: 1.118277, loss_d: 0.477560
0.3836 --- loss: 1.682923, loss_ss: 1.210615, loss_d: 0.472309
0.4219 --- loss: 1.165244, loss_ss: 0.780951, loss_d: 0.384293
0.4603 --- loss: 1.633010, loss_ss: 1.282850, loss_d: 0.350160
0.4987 --- loss: 1.558641, loss_ss: 1.182521, loss_d: 0.376120
0.5370 --- loss: 1.584387, loss_ss: 1.059709, loss_d: 0.524678
0.5754 --- loss: 1.518570, loss_ss: 1.247400, loss_d: 0.271170
0.6137 --- loss: 1.392597, loss_ss: 0.946637, loss_d: 0.445960
0.6521 --- loss: 2.187162, loss_ss: 1.162387, loss_d: 1.024775
0.6904 --- loss: 1.522261, loss_ss: 1.027650, loss_d: 0.494611
0.7288 --- loss: 1.421713, loss_ss: 0.919683, loss_d: 0.502029
0.7672 --- loss: 1.826590, loss_ss: 1.217433, loss_d: 0.609157
0.8055 --- loss: 1.338305, loss_ss: 0.977238, loss_d: 0.361066
0.8439 --- loss: 1.671658, loss_ss: 0.982809, loss_d: 0.688848
0.8822 --- loss: 1.402894, loss_ss: 0.996918, loss_d: 0.405977
0.9206 --- loss: 1.537675, loss_ss: 1.116189, loss_d: 0.421486
0.9590 --- loss: 1.331942, loss_ss: 1.030665, loss_d: 0.301277
0.9973 --- loss: 1.339259, loss_ss: 1.016617, loss_d: 0.322642
Epoch finished! Loss: 1.5429830972964946
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.262935, loss_ss: 0.964489, loss_d: 0.298447
0.0384 --- loss: 1.662272, loss_ss: 0.808750, loss_d: 0.853522
0.0767 --- loss: 1.631033, loss_ss: 1.028559, loss_d: 0.602474
0.1151 --- loss: 1.150714, loss_ss: 0.781696, loss_d: 0.369018
0.1534 --- loss: 1.601060, loss_ss: 1.219489, loss_d: 0.381571
0.1918 --- loss: 1.356412, loss_ss: 1.006453, loss_d: 0.349958
0.2301 --- loss: 1.980726, loss_ss: 0.778581, loss_d: 1.202146
0.2685 --- loss: 2.024987, loss_ss: 1.496381, loss_d: 0.528606
0.3069 --- loss: 1.441183, loss_ss: 1.100786, loss_d: 0.340397
0.3452 --- loss: 1.440089, loss_ss: 1.088205, loss_d: 0.351884
0.3836 --- loss: 1.193581, loss_ss: 0.958837, loss_d: 0.234745
0.4219 --- loss: 1.384017, loss_ss: 0.819570, loss_d: 0.564447
0.4603 --- loss: 1.710620, loss_ss: 1.099020, loss_d: 0.611600
0.4987 --- loss: 1.361603, loss_ss: 0.962696, loss_d: 0.398908
0.5370 --- loss: 1.787815, loss_ss: 1.367849, loss_d: 0.419967
0.5754 --- loss: 1.616127, loss_ss: 1.069216, loss_d: 0.546910
0.6137 --- loss: 2.106643, loss_ss: 1.224104, loss_d: 0.882540
0.6521 --- loss: 1.221654, loss_ss: 0.920122, loss_d: 0.301532
0.6904 --- loss: 1.394446, loss_ss: 0.996929, loss_d: 0.397518
0.7288 --- loss: 1.301567, loss_ss: 0.849151, loss_d: 0.452416
0.7672 --- loss: 1.327827, loss_ss: 1.082453, loss_d: 0.245374
0.8055 --- loss: 1.715182, loss_ss: 1.459397, loss_d: 0.255785
0.8439 --- loss: 1.445537, loss_ss: 1.080705, loss_d: 0.364831
0.8822 --- loss: 1.765064, loss_ss: 0.920133, loss_d: 0.844931
0.9206 --- loss: 1.346462, loss_ss: 1.056124, loss_d: 0.290338
0.9590 --- loss: 1.670817, loss_ss: 1.375688, loss_d: 0.295129
0.9973 --- loss: 1.475635, loss_ss: 0.880661, loss_d: 0.594974
Epoch finished! Loss: 1.5270134719518516
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.44731182795698926
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00        58
        1.0       0.00      0.00      0.00        55
        2.0       0.46      0.99      0.63       412
        3.0       0.20      0.04      0.06       182
        4.0       0.00      0.00      0.00       223

avg / total       0.24      0.45      0.29       930
 


====== chp026-nsrr ======

The ppr of  0  has ZeroDivisionError.


The f1-score of  0  has ZeroDivisionError.


The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  93.76   0.00  100.00    0.0      0.00
1  94.09   0.00  100.00    0.0      0.00
2  47.42  99.27    6.18   45.7     62.59
3  78.17   3.85   96.26   20.0      6.45
4  76.02   0.00  100.00    0.0      0.00
Total accuracy: 44.73%
Average sen: 20.62%
Average spec: 80.49%
Macro f1-score: 13.81%
[0.11565644 0.07048728 0.06035046 0.06253356 0.06155449 0.05170886
 0.0516052  0.05548284 0.08647279 0.06591411 0.06802716 0.06185736
 0.06066133 0.06158202 0.05809213 0.07021096 0.06593991 0.06433785
 0.06007622 0.05817931 0.06435074 0.07175279 0.07195188 0.07158927
 0.06403189 0.07688872 0.06476872 0.05533216 0.07027795 0.06711093
 0.06537146]
pred: 0.06626312314502654, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.410396, loss_ss: 1.757605, loss_d: 0.652791
0.0384 --- loss: 2.453549, loss_ss: 1.622702, loss_d: 0.830847
0.0768 --- loss: 2.403953, loss_ss: 1.750445, loss_d: 0.653509
0.1152 --- loss: 2.488173, loss_ss: 1.777481, loss_d: 0.710692
0.1536 --- loss: 2.060653, loss_ss: 1.563217, loss_d: 0.497436
0.1920 --- loss: 2.173608, loss_ss: 1.672817, loss_d: 0.500791
0.2304 --- loss: 2.511436, loss_ss: 1.704125, loss_d: 0.807311
0.2688 --- loss: 1.934699, loss_ss: 1.517002, loss_d: 0.417697
0.3072 --- loss: 2.392301, loss_ss: 1.758085, loss_d: 0.634216
0.3456 --- loss: 2.272839, loss_ss: 1.786069, loss_d: 0.486769
0.3840 --- loss: 1.899201, loss_ss: 1.669680, loss_d: 0.229522
0.4224 --- loss: 1.947898, loss_ss: 1.673735, loss_d: 0.274163
0.4608 --- loss: 2.143944, loss_ss: 1.498211, loss_d: 0.645733
0.4992 --- loss: 2.005387, loss_ss: 1.381543, loss_d: 0.623844
0.5376 --- loss: 2.112776, loss_ss: 1.598078, loss_d: 0.514698
0.5760 --- loss: 2.311179, loss_ss: 1.661031, loss_d: 0.650148
0.6144 --- loss: 2.235869, loss_ss: 1.610628, loss_d: 0.625241
0.6528 --- loss: 1.945810, loss_ss: 1.309796, loss_d: 0.636014
0.6912 --- loss: 2.209567, loss_ss: 1.516957, loss_d: 0.692609
0.7296 --- loss: 2.076285, loss_ss: 1.532524, loss_d: 0.543760
0.7680 --- loss: 2.050752, loss_ss: 1.624843, loss_d: 0.425909
0.8065 --- loss: 1.800408, loss_ss: 1.348937, loss_d: 0.451471
0.8449 --- loss: 1.896969, loss_ss: 1.479077, loss_d: 0.417892
0.8833 --- loss: 1.858618, loss_ss: 1.431911, loss_d: 0.426707
0.9217 --- loss: 2.126335, loss_ss: 1.471371, loss_d: 0.654963
0.9601 --- loss: 1.925945, loss_ss: 1.475249, loss_d: 0.450697
0.9985 --- loss: 1.921853, loss_ss: 1.195793, loss_d: 0.726060
Epoch finished! Loss: 2.09277353149194
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.118239, loss_ss: 1.306449, loss_d: 0.811790
0.0384 --- loss: 2.012058, loss_ss: 1.393550, loss_d: 0.618508
0.0768 --- loss: 2.041597, loss_ss: 1.357831, loss_d: 0.683766
0.1152 --- loss: 2.153358, loss_ss: 1.476070, loss_d: 0.677287
0.1536 --- loss: 1.976537, loss_ss: 1.459986, loss_d: 0.516550
0.1920 --- loss: 1.923699, loss_ss: 1.351706, loss_d: 0.571992
0.2304 --- loss: 1.786238, loss_ss: 1.259202, loss_d: 0.527036
0.2688 --- loss: 1.915037, loss_ss: 1.473614, loss_d: 0.441423
0.3072 --- loss: 1.641862, loss_ss: 1.261380, loss_d: 0.380482
0.3456 --- loss: 2.253019, loss_ss: 1.098743, loss_d: 1.154275
0.3840 --- loss: 1.837359, loss_ss: 1.538168, loss_d: 0.299191
0.4224 --- loss: 1.784848, loss_ss: 1.376093, loss_d: 0.408754
0.4608 --- loss: 1.950110, loss_ss: 1.371827, loss_d: 0.578282
0.4992 --- loss: 1.787413, loss_ss: 1.210067, loss_d: 0.577346
0.5376 --- loss: 2.111870, loss_ss: 1.475042, loss_d: 0.636828
0.5760 --- loss: 1.752728, loss_ss: 1.265734, loss_d: 0.486995
0.6144 --- loss: 1.773629, loss_ss: 1.154571, loss_d: 0.619058
0.6528 --- loss: 1.821530, loss_ss: 1.417498, loss_d: 0.404032
0.6912 --- loss: 1.833904, loss_ss: 1.307337, loss_d: 0.526567
0.7296 --- loss: 1.568832, loss_ss: 1.172142, loss_d: 0.396690
0.7680 --- loss: 1.812392, loss_ss: 1.316160, loss_d: 0.496232
0.8065 --- loss: 1.794503, loss_ss: 1.234847, loss_d: 0.559656
0.8449 --- loss: 1.810092, loss_ss: 1.192101, loss_d: 0.617990
0.8833 --- loss: 1.975425, loss_ss: 1.447422, loss_d: 0.528004
0.9217 --- loss: 1.584088, loss_ss: 1.159102, loss_d: 0.424987
0.9601 --- loss: 1.642475, loss_ss: 1.291442, loss_d: 0.351033
0.9985 --- loss: 1.575268, loss_ss: 1.248223, loss_d: 0.327045
Epoch finished! Loss: 1.898184890471972
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.677589, loss_ss: 1.353449, loss_d: 0.324141
0.0384 --- loss: 1.573893, loss_ss: 1.101924, loss_d: 0.471969
0.0768 --- loss: 1.672545, loss_ss: 1.217871, loss_d: 0.454675
0.1152 --- loss: 1.449662, loss_ss: 1.133678, loss_d: 0.315984
0.1536 --- loss: 1.756615, loss_ss: 1.094227, loss_d: 0.662389
0.1920 --- loss: 1.873974, loss_ss: 1.435598, loss_d: 0.438377
0.2304 --- loss: 1.595633, loss_ss: 1.109259, loss_d: 0.486374
0.2688 --- loss: 1.684368, loss_ss: 1.138498, loss_d: 0.545870
0.3072 --- loss: 2.050594, loss_ss: 1.090144, loss_d: 0.960450
0.3456 --- loss: 2.177256, loss_ss: 1.263025, loss_d: 0.914231
0.3840 --- loss: 1.557588, loss_ss: 1.112363, loss_d: 0.445225
0.4224 --- loss: 1.567938, loss_ss: 1.115515, loss_d: 0.452423
0.4608 --- loss: 1.737122, loss_ss: 1.317130, loss_d: 0.419992
0.4992 --- loss: 1.630815, loss_ss: 1.217437, loss_d: 0.413378
0.5376 --- loss: 1.864233, loss_ss: 1.341059, loss_d: 0.523175
0.5760 --- loss: 1.778703, loss_ss: 1.341172, loss_d: 0.437531
0.6144 --- loss: 1.790937, loss_ss: 1.287619, loss_d: 0.503318
0.6528 --- loss: 1.529910, loss_ss: 1.180699, loss_d: 0.349211
0.6912 --- loss: 2.255225, loss_ss: 1.054208, loss_d: 1.201017
0.7296 --- loss: 2.023700, loss_ss: 1.135107, loss_d: 0.888593
0.7680 --- loss: 1.994179, loss_ss: 1.520818, loss_d: 0.473361
0.8065 --- loss: 1.824398, loss_ss: 1.215056, loss_d: 0.609342
0.8449 --- loss: 1.770725, loss_ss: 1.382092, loss_d: 0.388633
0.8833 --- loss: 1.949234, loss_ss: 1.300204, loss_d: 0.649031
0.9217 --- loss: 1.656804, loss_ss: 1.146622, loss_d: 0.510182
0.9601 --- loss: 1.723689, loss_ss: 1.217852, loss_d: 0.505837
0.9985 --- loss: 2.166553, loss_ss: 1.801322, loss_d: 0.365231
Epoch finished! Loss: 1.7234163343906403
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.568350, loss_ss: 0.979331, loss_d: 0.589018
0.0384 --- loss: 1.721879, loss_ss: 1.250602, loss_d: 0.471277
0.0768 --- loss: 1.460273, loss_ss: 0.950733, loss_d: 0.509540
0.1152 --- loss: 1.519987, loss_ss: 1.087212, loss_d: 0.432774
0.1536 --- loss: 1.423801, loss_ss: 1.095348, loss_d: 0.328453
0.1920 --- loss: 1.432357, loss_ss: 0.977284, loss_d: 0.455073
0.2304 --- loss: 1.808605, loss_ss: 0.997511, loss_d: 0.811095
0.2688 --- loss: 1.666819, loss_ss: 1.194409, loss_d: 0.472410
0.3072 --- loss: 1.694592, loss_ss: 1.036556, loss_d: 0.658037
0.3456 --- loss: 1.634459, loss_ss: 1.192372, loss_d: 0.442086
0.3840 --- loss: 1.707825, loss_ss: 1.267951, loss_d: 0.439873
0.4224 --- loss: 1.358374, loss_ss: 1.021177, loss_d: 0.337197
0.4608 --- loss: 1.753247, loss_ss: 1.345814, loss_d: 0.407433
0.4992 --- loss: 1.710949, loss_ss: 1.310646, loss_d: 0.400304
0.5376 --- loss: 1.498440, loss_ss: 1.099945, loss_d: 0.398495
0.5760 --- loss: 1.865681, loss_ss: 1.316981, loss_d: 0.548700
0.6144 --- loss: 1.402996, loss_ss: 1.081565, loss_d: 0.321430
0.6528 --- loss: 1.397262, loss_ss: 1.035644, loss_d: 0.361618
0.6912 --- loss: 1.530852, loss_ss: 1.168802, loss_d: 0.362050
0.7296 --- loss: 1.529706, loss_ss: 1.082993, loss_d: 0.446712
0.7680 --- loss: 1.692584, loss_ss: 1.222678, loss_d: 0.469905
0.8065 --- loss: 1.415243, loss_ss: 0.989058, loss_d: 0.426185
0.8449 --- loss: 2.244762, loss_ss: 1.138070, loss_d: 1.106692
0.8833 --- loss: 1.559228, loss_ss: 1.245146, loss_d: 0.314082
0.9217 --- loss: 1.875990, loss_ss: 1.132425, loss_d: 0.743565
0.9601 --- loss: 1.354083, loss_ss: 0.955140, loss_d: 0.398943
0.9985 --- loss: 2.062110, loss_ss: 1.427759, loss_d: 0.634351
Epoch finished! Loss: 1.6603301731439737
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.462712, loss_ss: 1.106491, loss_d: 0.356221
0.0384 --- loss: 1.446002, loss_ss: 1.048665, loss_d: 0.397337
0.0768 --- loss: 1.779312, loss_ss: 1.026229, loss_d: 0.753084
0.1152 --- loss: 1.662381, loss_ss: 1.112872, loss_d: 0.549509
0.1536 --- loss: 1.878928, loss_ss: 1.474506, loss_d: 0.404422
0.1920 --- loss: 1.299782, loss_ss: 0.916622, loss_d: 0.383160
0.2304 --- loss: 1.274808, loss_ss: 0.932231, loss_d: 0.342577
0.2688 --- loss: 1.471316, loss_ss: 1.022594, loss_d: 0.448722
0.3072 --- loss: 1.320059, loss_ss: 1.028073, loss_d: 0.291986
0.3456 --- loss: 1.588153, loss_ss: 1.037349, loss_d: 0.550804
0.3840 --- loss: 1.371338, loss_ss: 1.074059, loss_d: 0.297279
0.4224 --- loss: 1.545687, loss_ss: 1.039698, loss_d: 0.505989
0.4608 --- loss: 1.417366, loss_ss: 0.835865, loss_d: 0.581501
0.4992 --- loss: 2.004798, loss_ss: 1.374259, loss_d: 0.630540
0.5376 --- loss: 1.479171, loss_ss: 1.131189, loss_d: 0.347982
0.5760 --- loss: 1.701526, loss_ss: 1.131935, loss_d: 0.569591
0.6144 --- loss: 1.524150, loss_ss: 1.216777, loss_d: 0.307373
0.6528 --- loss: 1.344317, loss_ss: 1.038489, loss_d: 0.305828
0.6912 --- loss: 1.630923, loss_ss: 1.077187, loss_d: 0.553735
0.7296 --- loss: 1.228403, loss_ss: 0.874499, loss_d: 0.353905
0.7680 --- loss: 1.786160, loss_ss: 1.290088, loss_d: 0.496072
0.8065 --- loss: 1.520077, loss_ss: 1.095564, loss_d: 0.424513
0.8449 --- loss: 1.355850, loss_ss: 0.946330, loss_d: 0.409520
0.8833 --- loss: 1.526728, loss_ss: 1.186227, loss_d: 0.340501
0.9217 --- loss: 1.464564, loss_ss: 1.127721, loss_d: 0.336843
0.9601 --- loss: 1.457094, loss_ss: 1.110503, loss_d: 0.346591
0.9985 --- loss: 2.510746, loss_ss: 1.356162, loss_d: 1.154584
Epoch finished! Loss: 1.6254105146114644
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.584931, loss_ss: 1.163310, loss_d: 0.421621
0.0384 --- loss: 1.628277, loss_ss: 1.283287, loss_d: 0.344990
0.0768 --- loss: 1.632613, loss_ss: 1.294530, loss_d: 0.338082
0.1152 --- loss: 1.353673, loss_ss: 0.922518, loss_d: 0.431155
0.1536 --- loss: 1.581317, loss_ss: 1.181789, loss_d: 0.399528
0.1920 --- loss: 1.953019, loss_ss: 1.620035, loss_d: 0.332984
0.2304 --- loss: 1.378960, loss_ss: 1.092723, loss_d: 0.286237
0.2688 --- loss: 1.736629, loss_ss: 1.421916, loss_d: 0.314713
0.3072 --- loss: 1.198218, loss_ss: 0.868058, loss_d: 0.330160
0.3456 --- loss: 1.465299, loss_ss: 1.033265, loss_d: 0.432035
0.3840 --- loss: 1.487023, loss_ss: 1.155433, loss_d: 0.331590
0.4224 --- loss: 1.729480, loss_ss: 1.089974, loss_d: 0.639506
0.4608 --- loss: 1.321756, loss_ss: 0.948308, loss_d: 0.373448
0.4992 --- loss: 1.495710, loss_ss: 0.994258, loss_d: 0.501452
0.5376 --- loss: 1.509079, loss_ss: 1.072495, loss_d: 0.436584
0.5760 --- loss: 1.577103, loss_ss: 1.020856, loss_d: 0.556246
0.6144 --- loss: 1.712960, loss_ss: 0.956324, loss_d: 0.756636
0.6528 --- loss: 1.573202, loss_ss: 1.264603, loss_d: 0.308599
0.6912 --- loss: 1.530052, loss_ss: 1.095795, loss_d: 0.434257
0.7296 --- loss: 1.854129, loss_ss: 0.943068, loss_d: 0.911061
0.7680 --- loss: 1.410301, loss_ss: 1.041348, loss_d: 0.368952
0.8065 --- loss: 1.807589, loss_ss: 1.403957, loss_d: 0.403631
0.8449 --- loss: 1.305193, loss_ss: 0.870739, loss_d: 0.434454
0.8833 --- loss: 1.533840, loss_ss: 1.214800, loss_d: 0.319040
0.9217 --- loss: 1.332695, loss_ss: 0.961364, loss_d: 0.371331
0.9601 --- loss: 1.361222, loss_ss: 0.980398, loss_d: 0.380824
0.9985 --- loss: 2.118362, loss_ss: 1.806916, loss_d: 0.311447
Epoch finished! Loss: 1.582796739614927
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.722786, loss_ss: 1.108037, loss_d: 0.614748
0.0384 --- loss: 1.609126, loss_ss: 1.171203, loss_d: 0.437923
0.0768 --- loss: 1.472823, loss_ss: 1.122600, loss_d: 0.350223
0.1152 --- loss: 1.684740, loss_ss: 1.417434, loss_d: 0.267306
0.1536 --- loss: 1.427020, loss_ss: 1.080616, loss_d: 0.346404
0.1920 --- loss: 1.405819, loss_ss: 1.068212, loss_d: 0.337608
0.2304 --- loss: 1.468475, loss_ss: 0.769520, loss_d: 0.698955
0.2688 --- loss: 1.444904, loss_ss: 0.943299, loss_d: 0.501605
0.3072 --- loss: 1.510427, loss_ss: 1.317571, loss_d: 0.192856
0.3456 --- loss: 1.346225, loss_ss: 0.950277, loss_d: 0.395948
0.3840 --- loss: 1.161342, loss_ss: 0.849006, loss_d: 0.312336
0.4224 --- loss: 1.479727, loss_ss: 1.050679, loss_d: 0.429048
0.4608 --- loss: 1.505496, loss_ss: 0.993288, loss_d: 0.512209
0.4992 --- loss: 1.485836, loss_ss: 0.800336, loss_d: 0.685500
0.5376 --- loss: 1.572241, loss_ss: 1.032939, loss_d: 0.539302
0.5760 --- loss: 1.574349, loss_ss: 1.227429, loss_d: 0.346920
0.6144 --- loss: 1.782456, loss_ss: 1.130346, loss_d: 0.652109
0.6528 --- loss: 1.621920, loss_ss: 1.256903, loss_d: 0.365017
0.6912 --- loss: 2.012434, loss_ss: 1.606328, loss_d: 0.406106
0.7296 --- loss: 1.692024, loss_ss: 1.246290, loss_d: 0.445734
0.7680 --- loss: 1.534886, loss_ss: 1.154155, loss_d: 0.380731
0.8065 --- loss: 1.516610, loss_ss: 1.019610, loss_d: 0.497001
0.8449 --- loss: 1.904973, loss_ss: 0.839474, loss_d: 1.065498
0.8833 --- loss: 1.732802, loss_ss: 1.374812, loss_d: 0.357990
0.9217 --- loss: 1.419619, loss_ss: 0.640512, loss_d: 0.779107
0.9601 --- loss: 1.745525, loss_ss: 1.330505, loss_d: 0.415020
0.9985 --- loss: 2.288142, loss_ss: 1.380556, loss_d: 0.907585
Epoch finished! Loss: 1.5759226303834182
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.657800, loss_ss: 1.222950, loss_d: 0.434850
0.0384 --- loss: 1.666629, loss_ss: 1.326572, loss_d: 0.340057
0.0768 --- loss: 1.450967, loss_ss: 1.101815, loss_d: 0.349152
0.1152 --- loss: 1.774647, loss_ss: 1.061818, loss_d: 0.712829
0.1536 --- loss: 1.582527, loss_ss: 1.095971, loss_d: 0.486556
0.1920 --- loss: 1.214233, loss_ss: 0.960716, loss_d: 0.253517
0.2304 --- loss: 1.198597, loss_ss: 0.851757, loss_d: 0.346840
0.2688 --- loss: 1.240783, loss_ss: 0.863727, loss_d: 0.377055
0.3072 --- loss: 1.424836, loss_ss: 1.049366, loss_d: 0.375470
0.3456 --- loss: 1.393948, loss_ss: 1.141515, loss_d: 0.252433
0.3840 --- loss: 1.423030, loss_ss: 1.133896, loss_d: 0.289133
0.4224 --- loss: 1.358740, loss_ss: 0.963694, loss_d: 0.395046
0.4608 --- loss: 1.534505, loss_ss: 1.136273, loss_d: 0.398232
0.4992 --- loss: 1.277812, loss_ss: 0.965890, loss_d: 0.311921
0.5376 --- loss: 1.165651, loss_ss: 0.905745, loss_d: 0.259906
0.5760 --- loss: 1.901670, loss_ss: 1.497522, loss_d: 0.404148
0.6144 --- loss: 1.746143, loss_ss: 1.146828, loss_d: 0.599315
0.6528 --- loss: 1.266873, loss_ss: 0.849605, loss_d: 0.417268
0.6912 --- loss: 1.734715, loss_ss: 1.107568, loss_d: 0.627147
0.7296 --- loss: 1.684293, loss_ss: 1.218346, loss_d: 0.465947
0.7680 --- loss: 1.076496, loss_ss: 0.791245, loss_d: 0.285250
0.8065 --- loss: 1.737203, loss_ss: 1.292519, loss_d: 0.444684
0.8449 --- loss: 1.600421, loss_ss: 1.191358, loss_d: 0.409063
0.8833 --- loss: 1.392884, loss_ss: 0.880069, loss_d: 0.512814
0.9217 --- loss: 1.919587, loss_ss: 1.226115, loss_d: 0.693473
0.9601 --- loss: 1.450859, loss_ss: 1.104605, loss_d: 0.346254
0.9985 --- loss: 1.469966, loss_ss: 1.060122, loss_d: 0.409844
Epoch finished! Loss: 1.5625447433728439
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.505603, loss_ss: 1.068711, loss_d: 0.436892
0.0384 --- loss: 1.380537, loss_ss: 1.104802, loss_d: 0.275735
0.0768 --- loss: 1.381846, loss_ss: 1.026586, loss_d: 0.355260
0.1152 --- loss: 1.172804, loss_ss: 0.849421, loss_d: 0.323382
0.1536 --- loss: 1.798547, loss_ss: 1.029554, loss_d: 0.768993
0.1920 --- loss: 1.456499, loss_ss: 1.149947, loss_d: 0.306552
0.2304 --- loss: 1.541631, loss_ss: 0.910457, loss_d: 0.631174
0.2688 --- loss: 2.263404, loss_ss: 1.361747, loss_d: 0.901658
0.3072 --- loss: 1.387803, loss_ss: 1.053719, loss_d: 0.334084
0.3456 --- loss: 1.543336, loss_ss: 1.107225, loss_d: 0.436111
0.3840 --- loss: 2.027139, loss_ss: 1.495481, loss_d: 0.531658
0.4224 --- loss: 1.771230, loss_ss: 1.367825, loss_d: 0.403405
0.4608 --- loss: 1.463200, loss_ss: 0.950395, loss_d: 0.512805
0.4992 --- loss: 1.395551, loss_ss: 1.162985, loss_d: 0.232566
0.5376 --- loss: 1.993086, loss_ss: 1.177845, loss_d: 0.815241
0.5760 --- loss: 1.454548, loss_ss: 1.049581, loss_d: 0.404967
0.6144 --- loss: 1.598872, loss_ss: 1.126609, loss_d: 0.472264
0.6528 --- loss: 1.599171, loss_ss: 1.070621, loss_d: 0.528550
0.6912 --- loss: 1.115382, loss_ss: 0.852167, loss_d: 0.263215
0.7296 --- loss: 1.729154, loss_ss: 1.336910, loss_d: 0.392244
0.7680 --- loss: 1.248775, loss_ss: 0.935483, loss_d: 0.313292
0.8065 --- loss: 1.251214, loss_ss: 1.005886, loss_d: 0.245328
0.8449 --- loss: 2.289662, loss_ss: 1.262240, loss_d: 1.027422
0.8833 --- loss: 1.888901, loss_ss: 1.206733, loss_d: 0.682168
0.9217 --- loss: 1.598116, loss_ss: 1.098380, loss_d: 0.499736
0.9601 --- loss: 1.284329, loss_ss: 0.998204, loss_d: 0.286125
0.9985 --- loss: 1.698330, loss_ss: 1.355711, loss_d: 0.342619
Epoch finished! Loss: 1.517641173876249
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.481286, loss_ss: 0.923776, loss_d: 0.557510
0.0384 --- loss: 1.712849, loss_ss: 1.355498, loss_d: 0.357350
0.0768 --- loss: 1.347147, loss_ss: 1.025488, loss_d: 0.321660
0.1152 --- loss: 1.475006, loss_ss: 1.152803, loss_d: 0.322202
0.1536 --- loss: 1.291658, loss_ss: 0.882200, loss_d: 0.409458
0.1920 --- loss: 1.368344, loss_ss: 0.863044, loss_d: 0.505300
0.2304 --- loss: 1.218029, loss_ss: 0.968400, loss_d: 0.249629
0.2688 --- loss: 1.808363, loss_ss: 1.031215, loss_d: 0.777148
0.3072 --- loss: 1.630649, loss_ss: 1.190081, loss_d: 0.440568
0.3456 --- loss: 1.723207, loss_ss: 1.167171, loss_d: 0.556035
0.3840 --- loss: 1.351936, loss_ss: 0.979327, loss_d: 0.372608
0.4224 --- loss: 1.405923, loss_ss: 1.036702, loss_d: 0.369221
0.4608 --- loss: 1.189087, loss_ss: 0.873602, loss_d: 0.315485
0.4992 --- loss: 2.232208, loss_ss: 1.014481, loss_d: 1.217727
0.5376 --- loss: 0.976472, loss_ss: 0.715421, loss_d: 0.261051
0.5760 --- loss: 1.520458, loss_ss: 1.045874, loss_d: 0.474584
0.6144 --- loss: 2.034632, loss_ss: 1.229121, loss_d: 0.805511
0.6528 --- loss: 1.338231, loss_ss: 0.974142, loss_d: 0.364089
0.6912 --- loss: 1.509227, loss_ss: 1.124540, loss_d: 0.384687
0.7296 --- loss: 1.351484, loss_ss: 0.969833, loss_d: 0.381651
0.7680 --- loss: 1.711058, loss_ss: 1.326761, loss_d: 0.384297
0.8065 --- loss: 1.744510, loss_ss: 1.255377, loss_d: 0.489133
0.8449 --- loss: 1.450599, loss_ss: 0.862191, loss_d: 0.588408
0.8833 --- loss: 1.307064, loss_ss: 1.016197, loss_d: 0.290867
0.9217 --- loss: 1.661022, loss_ss: 1.470489, loss_d: 0.190533
0.9601 --- loss: 1.534155, loss_ss: 1.151437, loss_d: 0.382718
0.9985 --- loss: 3.278742, loss_ss: 1.222744, loss_d: 2.055998
Epoch finished! Loss: 1.5018286267152199
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.20019627085377822
             precision    recall  f1-score   support

        0.0       1.00      0.13      0.23       101
        1.0       0.00      0.00      0.00        55
        2.0       0.00      0.00      0.00       382
        3.0       0.19      1.00      0.32       191
        4.0       0.00      0.00      0.00       290

avg / total       0.13      0.20      0.08      1019
 


====== chp028-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %   ppr %  f1-score
0  91.36   12.87  100.00  100.00     22.81
1  94.60    0.00  100.00    0.00      0.00
2  62.51    0.00  100.00    0.00      0.00
3  20.02  100.00    1.57   18.99     31.91
4  71.54    0.00  100.00    0.00      0.00
Total accuracy: 20.02%
Average sen: 22.57%
Average spec: 80.31%
Macro f1-score: 10.94%
[0.34689036 0.2575056  0.26127326 0.36015144 0.36075088 0.34907618
 0.29779589 0.33963978 0.34096435 0.34878179 0.35573527 0.36138028
 0.36303192 0.34989867 0.34350613 0.35273001 0.33615947 0.33875453
 0.34350193 0.3396346  0.34799024 0.34827796 0.34032661 0.35097957
 0.34300202 0.33186975 0.33998263 0.35654297 0.36128503 0.34168193
 0.34165037 0.35134506 0.34312111 0.34250373]
pred: 0.34081533288254456, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.503565, loss_ss: 1.806990, loss_d: 0.696575
0.0384 --- loss: 2.071706, loss_ss: 1.473743, loss_d: 0.597963
0.0768 --- loss: 1.928952, loss_ss: 1.579675, loss_d: 0.349277
0.1152 --- loss: 2.337947, loss_ss: 1.521641, loss_d: 0.816306
0.1536 --- loss: 2.248593, loss_ss: 1.648189, loss_d: 0.600404
0.1920 --- loss: 2.239889, loss_ss: 1.568671, loss_d: 0.671218
0.2304 --- loss: 2.222711, loss_ss: 1.580421, loss_d: 0.642290
0.2688 --- loss: 2.108515, loss_ss: 1.639497, loss_d: 0.469018
0.3072 --- loss: 2.297620, loss_ss: 1.606739, loss_d: 0.690881
0.3456 --- loss: 1.967506, loss_ss: 1.457176, loss_d: 0.510330
0.3840 --- loss: 2.288231, loss_ss: 1.660580, loss_d: 0.627651
0.4224 --- loss: 1.900534, loss_ss: 1.372855, loss_d: 0.527679
0.4608 --- loss: 2.028239, loss_ss: 1.608750, loss_d: 0.419489
0.4992 --- loss: 2.101480, loss_ss: 1.535043, loss_d: 0.566436
0.5376 --- loss: 2.239464, loss_ss: 1.513877, loss_d: 0.725587
0.5760 --- loss: 2.228032, loss_ss: 1.639097, loss_d: 0.588935
0.6144 --- loss: 2.569682, loss_ss: 1.564837, loss_d: 1.004845
0.6528 --- loss: 2.100145, loss_ss: 1.583539, loss_d: 0.516606
0.6912 --- loss: 2.260419, loss_ss: 1.540845, loss_d: 0.719573
0.7296 --- loss: 1.682261, loss_ss: 1.325645, loss_d: 0.356616
0.7680 --- loss: 2.266996, loss_ss: 1.462397, loss_d: 0.804599
0.8065 --- loss: 2.029891, loss_ss: 1.560042, loss_d: 0.469850
0.8449 --- loss: 1.917365, loss_ss: 1.366540, loss_d: 0.550825
0.8833 --- loss: 2.398820, loss_ss: 1.417908, loss_d: 0.980912
0.9217 --- loss: 2.141188, loss_ss: 1.531902, loss_d: 0.609286
0.9601 --- loss: 2.007171, loss_ss: 1.372902, loss_d: 0.634268
0.9985 --- loss: 1.941737, loss_ss: 1.464778, loss_d: 0.476959
Epoch finished! Loss: 2.115702469990804
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.931052, loss_ss: 1.395685, loss_d: 0.535367
0.0384 --- loss: 2.174826, loss_ss: 1.446955, loss_d: 0.727871
0.0768 --- loss: 2.079495, loss_ss: 1.374853, loss_d: 0.704642
0.1152 --- loss: 1.846670, loss_ss: 1.330365, loss_d: 0.516305
0.1536 --- loss: 2.020643, loss_ss: 1.495580, loss_d: 0.525063
0.1920 --- loss: 1.941978, loss_ss: 1.324310, loss_d: 0.617668
0.2304 --- loss: 1.755623, loss_ss: 1.281259, loss_d: 0.474364
0.2688 --- loss: 1.919811, loss_ss: 1.462960, loss_d: 0.456850
0.3072 --- loss: 1.831378, loss_ss: 1.473326, loss_d: 0.358052
0.3456 --- loss: 1.891378, loss_ss: 1.427177, loss_d: 0.464201
0.3840 --- loss: 1.809570, loss_ss: 1.370492, loss_d: 0.439077
0.4224 --- loss: 1.899282, loss_ss: 1.360329, loss_d: 0.538953
0.4608 --- loss: 1.740831, loss_ss: 1.261727, loss_d: 0.479104
0.4992 --- loss: 1.799735, loss_ss: 1.393133, loss_d: 0.406602
0.5376 --- loss: 2.012084, loss_ss: 1.397173, loss_d: 0.614911
0.5760 --- loss: 1.902219, loss_ss: 1.416455, loss_d: 0.485764
0.6144 --- loss: 1.944907, loss_ss: 1.354061, loss_d: 0.590846
0.6528 --- loss: 2.096292, loss_ss: 1.570902, loss_d: 0.525390
0.6912 --- loss: 1.761580, loss_ss: 1.335667, loss_d: 0.425912
0.7296 --- loss: 1.609691, loss_ss: 1.088500, loss_d: 0.521191
0.7680 --- loss: 1.907012, loss_ss: 1.513986, loss_d: 0.393027
0.8065 --- loss: 1.878803, loss_ss: 1.423833, loss_d: 0.454971
0.8449 --- loss: 1.774732, loss_ss: 1.131154, loss_d: 0.643578
0.8833 --- loss: 3.075799, loss_ss: 1.430289, loss_d: 1.645511
0.9217 --- loss: 2.049326, loss_ss: 1.380830, loss_d: 0.668496
0.9601 --- loss: 2.063948, loss_ss: 1.421785, loss_d: 0.642164
0.9985 --- loss: 1.704294, loss_ss: 1.394305, loss_d: 0.309989
Epoch finished! Loss: 1.9438135449702922
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.833952, loss_ss: 1.358306, loss_d: 0.475646
0.0384 --- loss: 2.017148, loss_ss: 1.363992, loss_d: 0.653156
0.0768 --- loss: 1.910592, loss_ss: 1.481218, loss_d: 0.429374
0.1152 --- loss: 2.142597, loss_ss: 1.434978, loss_d: 0.707619
0.1536 --- loss: 1.928554, loss_ss: 1.284787, loss_d: 0.643767
0.1920 --- loss: 1.617947, loss_ss: 1.114051, loss_d: 0.503896
0.2304 --- loss: 1.956120, loss_ss: 1.119708, loss_d: 0.836411
0.2688 --- loss: 1.779557, loss_ss: 1.179647, loss_d: 0.599910
0.3072 --- loss: 1.669879, loss_ss: 1.188537, loss_d: 0.481342
0.3456 --- loss: 1.862393, loss_ss: 1.338797, loss_d: 0.523596
0.3840 --- loss: 1.558544, loss_ss: 1.231999, loss_d: 0.326545
0.4224 --- loss: 1.884223, loss_ss: 1.223716, loss_d: 0.660507
0.4608 --- loss: 1.824400, loss_ss: 1.457040, loss_d: 0.367360
0.4992 --- loss: 1.617915, loss_ss: 1.182898, loss_d: 0.435017
0.5376 --- loss: 1.787776, loss_ss: 1.390181, loss_d: 0.397595
0.5760 --- loss: 2.348086, loss_ss: 1.892327, loss_d: 0.455759
0.6144 --- loss: 1.616097, loss_ss: 1.163192, loss_d: 0.452905
0.6528 --- loss: 1.387486, loss_ss: 1.085394, loss_d: 0.302092
0.6912 --- loss: 1.926644, loss_ss: 1.419782, loss_d: 0.506863
0.7296 --- loss: 1.732374, loss_ss: 1.224556, loss_d: 0.507818
0.7680 --- loss: 1.582615, loss_ss: 1.167780, loss_d: 0.414835
0.8065 --- loss: 1.614857, loss_ss: 1.190911, loss_d: 0.423946
0.8449 --- loss: 1.578807, loss_ss: 1.221266, loss_d: 0.357542
0.8833 --- loss: 2.400723, loss_ss: 1.472093, loss_d: 0.928630
0.9217 --- loss: 1.845448, loss_ss: 1.287368, loss_d: 0.558079
0.9601 --- loss: 1.626413, loss_ss: 1.135478, loss_d: 0.490934
0.9985 --- loss: 1.690279, loss_ss: 1.328538, loss_d: 0.361741
Epoch finished! Loss: 1.841384921165613
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.617860, loss_ss: 1.177196, loss_d: 0.440664
0.0384 --- loss: 1.968715, loss_ss: 1.302302, loss_d: 0.666413
0.0768 --- loss: 1.811462, loss_ss: 1.439116, loss_d: 0.372346
0.1152 --- loss: 1.503744, loss_ss: 1.205797, loss_d: 0.297947
0.1536 --- loss: 1.434718, loss_ss: 0.983031, loss_d: 0.451687
0.1920 --- loss: 2.085665, loss_ss: 1.194959, loss_d: 0.890706
0.2304 --- loss: 1.396508, loss_ss: 1.001675, loss_d: 0.394833
0.2688 --- loss: 1.833817, loss_ss: 1.459934, loss_d: 0.373882
0.3072 --- loss: 1.560485, loss_ss: 1.192535, loss_d: 0.367950
0.3456 --- loss: 1.742876, loss_ss: 1.221084, loss_d: 0.521792
0.3840 --- loss: 1.961039, loss_ss: 1.211096, loss_d: 0.749943
0.4224 --- loss: 1.672589, loss_ss: 1.258295, loss_d: 0.414294
0.4608 --- loss: 1.838796, loss_ss: 1.433172, loss_d: 0.405623
0.4992 --- loss: 1.605490, loss_ss: 1.152621, loss_d: 0.452868
0.5376 --- loss: 1.239090, loss_ss: 0.963597, loss_d: 0.275493
0.5760 --- loss: 1.772357, loss_ss: 1.346627, loss_d: 0.425730
0.6144 --- loss: 1.567856, loss_ss: 1.076558, loss_d: 0.491299
0.6528 --- loss: 1.774786, loss_ss: 1.113441, loss_d: 0.661345
0.6912 --- loss: 2.005447, loss_ss: 1.280247, loss_d: 0.725201
0.7296 --- loss: 1.498267, loss_ss: 0.975322, loss_d: 0.522945
0.7680 --- loss: 2.135786, loss_ss: 1.280394, loss_d: 0.855392
0.8065 --- loss: 2.237860, loss_ss: 1.824041, loss_d: 0.413819
0.8449 --- loss: 1.657442, loss_ss: 1.148000, loss_d: 0.509443
0.8833 --- loss: 1.418031, loss_ss: 0.939396, loss_d: 0.478636
0.9217 --- loss: 1.437787, loss_ss: 1.071285, loss_d: 0.366502
0.9601 --- loss: 1.480314, loss_ss: 1.086103, loss_d: 0.394212
0.9985 --- loss: 2.673412, loss_ss: 1.663318, loss_d: 1.010094
Epoch finished! Loss: 1.7022102346787087
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.367735, loss_ss: 0.970002, loss_d: 0.397733
0.0384 --- loss: 1.526249, loss_ss: 1.219364, loss_d: 0.306885
0.0768 --- loss: 1.530112, loss_ss: 1.145999, loss_d: 0.384113
0.1152 --- loss: 1.767327, loss_ss: 1.155068, loss_d: 0.612259
0.1536 --- loss: 1.465207, loss_ss: 1.164162, loss_d: 0.301045
0.1920 --- loss: 1.297227, loss_ss: 0.981845, loss_d: 0.315383
0.2304 --- loss: 1.971849, loss_ss: 1.208317, loss_d: 0.763532
0.2688 --- loss: 1.747572, loss_ss: 1.357845, loss_d: 0.389727
0.3072 --- loss: 1.628685, loss_ss: 1.176873, loss_d: 0.451811
0.3456 --- loss: 1.709588, loss_ss: 1.207451, loss_d: 0.502137
0.3840 --- loss: 1.413411, loss_ss: 1.093261, loss_d: 0.320150
0.4224 --- loss: 1.503754, loss_ss: 1.143013, loss_d: 0.360741
0.4608 --- loss: 1.312358, loss_ss: 1.001118, loss_d: 0.311240
0.4992 --- loss: 1.329112, loss_ss: 1.035126, loss_d: 0.293985
0.5376 --- loss: 1.586178, loss_ss: 1.110951, loss_d: 0.475227
0.5760 --- loss: 1.516332, loss_ss: 1.265804, loss_d: 0.250529
0.6144 --- loss: 1.446717, loss_ss: 0.968059, loss_d: 0.478658
0.6528 --- loss: 1.253052, loss_ss: 0.898376, loss_d: 0.354676
0.6912 --- loss: 1.567578, loss_ss: 1.158433, loss_d: 0.409145
0.7296 --- loss: 1.479176, loss_ss: 1.128790, loss_d: 0.350386
0.7680 --- loss: 1.776322, loss_ss: 1.174857, loss_d: 0.601465
0.8065 --- loss: 1.402144, loss_ss: 0.980393, loss_d: 0.421751
0.8449 --- loss: 1.486722, loss_ss: 1.015828, loss_d: 0.470894
0.8833 --- loss: 1.717335, loss_ss: 1.374723, loss_d: 0.342612
0.9217 --- loss: 1.653063, loss_ss: 0.979787, loss_d: 0.673276
0.9601 --- loss: 1.756460, loss_ss: 1.053243, loss_d: 0.703217
0.9985 --- loss: 1.723205, loss_ss: 0.813088, loss_d: 0.910117
Epoch finished! Loss: 1.6275351900320787
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.519022, loss_ss: 1.133941, loss_d: 0.385082
0.0384 --- loss: 1.886913, loss_ss: 1.156465, loss_d: 0.730448
0.0768 --- loss: 1.557240, loss_ss: 0.994762, loss_d: 0.562479
0.1152 --- loss: 1.842795, loss_ss: 1.380438, loss_d: 0.462357
0.1536 --- loss: 1.851357, loss_ss: 1.184661, loss_d: 0.666696
0.1920 --- loss: 1.779975, loss_ss: 1.361879, loss_d: 0.418095
0.2304 --- loss: 1.304213, loss_ss: 0.878890, loss_d: 0.425322
0.2688 --- loss: 1.890745, loss_ss: 0.919479, loss_d: 0.971266
0.3072 --- loss: 1.744136, loss_ss: 1.101696, loss_d: 0.642440
0.3456 --- loss: 1.370470, loss_ss: 1.037719, loss_d: 0.332751
0.3840 --- loss: 1.619741, loss_ss: 1.092090, loss_d: 0.527651
0.4224 --- loss: 1.307993, loss_ss: 0.999657, loss_d: 0.308336
0.4608 --- loss: 1.604617, loss_ss: 1.090628, loss_d: 0.513989
0.4992 --- loss: 1.599334, loss_ss: 1.141323, loss_d: 0.458012
0.5376 --- loss: 1.267543, loss_ss: 1.036096, loss_d: 0.231447
0.5760 --- loss: 1.636325, loss_ss: 1.149340, loss_d: 0.486985
0.6144 --- loss: 1.442480, loss_ss: 1.030177, loss_d: 0.412303
0.6528 --- loss: 1.801231, loss_ss: 1.108333, loss_d: 0.692897
0.6912 --- loss: 1.310692, loss_ss: 0.935988, loss_d: 0.374704
0.7296 --- loss: 1.377195, loss_ss: 0.846724, loss_d: 0.530472
0.7680 --- loss: 1.652641, loss_ss: 1.249575, loss_d: 0.403066
0.8065 --- loss: 1.373320, loss_ss: 0.921279, loss_d: 0.452040
0.8449 --- loss: 1.744876, loss_ss: 1.312779, loss_d: 0.432097
0.8833 --- loss: 1.454704, loss_ss: 1.091004, loss_d: 0.363701
0.9217 --- loss: 1.707800, loss_ss: 1.227098, loss_d: 0.480702
0.9601 --- loss: 1.839522, loss_ss: 1.152763, loss_d: 0.686758
0.9985 --- loss: 1.684065, loss_ss: 1.303159, loss_d: 0.380907
Epoch finished! Loss: 1.581992734854038
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.902099, loss_ss: 1.150942, loss_d: 0.751157
0.0384 --- loss: 1.639664, loss_ss: 1.254733, loss_d: 0.384931
0.0768 --- loss: 1.719184, loss_ss: 1.060870, loss_d: 0.658314
0.1152 --- loss: 1.883141, loss_ss: 1.360247, loss_d: 0.522894
0.1536 --- loss: 1.555412, loss_ss: 1.127885, loss_d: 0.427527
0.1920 --- loss: 1.657959, loss_ss: 1.029224, loss_d: 0.628735
0.2304 --- loss: 1.906353, loss_ss: 1.257457, loss_d: 0.648896
0.2688 --- loss: 1.496971, loss_ss: 1.174560, loss_d: 0.322411
0.3072 --- loss: 1.575744, loss_ss: 1.170631, loss_d: 0.405113
0.3456 --- loss: 1.361303, loss_ss: 0.952968, loss_d: 0.408335
0.3840 --- loss: 1.215093, loss_ss: 0.920044, loss_d: 0.295049
0.4224 --- loss: 2.400418, loss_ss: 1.343980, loss_d: 1.056438
0.4608 --- loss: 1.360543, loss_ss: 0.976730, loss_d: 0.383814
0.4992 --- loss: 1.432790, loss_ss: 1.113010, loss_d: 0.319780
0.5376 --- loss: 1.534953, loss_ss: 0.975799, loss_d: 0.559153
0.5760 --- loss: 1.197772, loss_ss: 0.885332, loss_d: 0.312440
0.6144 --- loss: 1.162744, loss_ss: 0.812591, loss_d: 0.350153
0.6528 --- loss: 1.330901, loss_ss: 1.011805, loss_d: 0.319095
0.6912 --- loss: 1.683853, loss_ss: 1.028677, loss_d: 0.655176
0.7296 --- loss: 1.449064, loss_ss: 1.168715, loss_d: 0.280349
0.7680 --- loss: 1.442131, loss_ss: 1.105517, loss_d: 0.336614
0.8065 --- loss: 1.809974, loss_ss: 1.143443, loss_d: 0.666531
0.8449 --- loss: 2.085718, loss_ss: 1.581145, loss_d: 0.504573
0.8833 --- loss: 1.447727, loss_ss: 1.083022, loss_d: 0.364705
0.9217 --- loss: 1.398792, loss_ss: 1.146557, loss_d: 0.252235
0.9601 --- loss: 1.476215, loss_ss: 1.184574, loss_d: 0.291642
0.9985 --- loss: 1.969380, loss_ss: 0.926173, loss_d: 1.043206
Epoch finished! Loss: 1.5666547995347244
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.330307, loss_ss: 0.970261, loss_d: 0.360046
0.0384 --- loss: 1.630583, loss_ss: 1.193462, loss_d: 0.437121
0.0768 --- loss: 1.338449, loss_ss: 0.979602, loss_d: 0.358847
0.1152 --- loss: 1.419259, loss_ss: 1.027265, loss_d: 0.391994
0.1536 --- loss: 1.469035, loss_ss: 1.237833, loss_d: 0.231203
0.1920 --- loss: 1.297733, loss_ss: 1.082163, loss_d: 0.215570
0.2304 --- loss: 1.844463, loss_ss: 1.325937, loss_d: 0.518526
0.2688 --- loss: 1.284371, loss_ss: 1.080382, loss_d: 0.203989
0.3072 --- loss: 1.272512, loss_ss: 0.969262, loss_d: 0.303250
0.3456 --- loss: 2.029703, loss_ss: 1.364172, loss_d: 0.665531
0.3840 --- loss: 1.704495, loss_ss: 1.128719, loss_d: 0.575776
0.4224 --- loss: 2.002766, loss_ss: 1.337648, loss_d: 0.665118
0.4608 --- loss: 1.459769, loss_ss: 1.086815, loss_d: 0.372953
0.4992 --- loss: 1.844586, loss_ss: 1.101683, loss_d: 0.742904
0.5376 --- loss: 1.343300, loss_ss: 1.046912, loss_d: 0.296388
0.5760 --- loss: 1.184290, loss_ss: 0.987194, loss_d: 0.197095
0.6144 --- loss: 1.192662, loss_ss: 0.935093, loss_d: 0.257569
0.6528 --- loss: 1.316014, loss_ss: 1.044704, loss_d: 0.271311
0.6912 --- loss: 1.943326, loss_ss: 1.254428, loss_d: 0.688897
0.7296 --- loss: 1.585278, loss_ss: 1.141468, loss_d: 0.443810
0.7680 --- loss: 1.866424, loss_ss: 0.956017, loss_d: 0.910407
0.8065 --- loss: 1.939325, loss_ss: 1.558616, loss_d: 0.380710
0.8449 --- loss: 1.671920, loss_ss: 1.278985, loss_d: 0.392934
0.8833 --- loss: 1.239502, loss_ss: 0.937498, loss_d: 0.302004
0.9217 --- loss: 1.321478, loss_ss: 1.017004, loss_d: 0.304474
0.9601 --- loss: 1.251179, loss_ss: 0.940318, loss_d: 0.310861
0.9985 --- loss: 1.415114, loss_ss: 1.013608, loss_d: 0.401506
Epoch finished! Loss: 1.5349587527605204
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.257638, loss_ss: 0.910886, loss_d: 0.346752
0.0384 --- loss: 1.402846, loss_ss: 1.144006, loss_d: 0.258840
0.0768 --- loss: 1.226006, loss_ss: 1.012123, loss_d: 0.213884
0.1152 --- loss: 1.321502, loss_ss: 1.064909, loss_d: 0.256593
0.1536 --- loss: 1.231702, loss_ss: 0.918378, loss_d: 0.313324
0.1920 --- loss: 1.646852, loss_ss: 1.003546, loss_d: 0.643306
0.2304 --- loss: 1.298942, loss_ss: 0.859338, loss_d: 0.439604
0.2688 --- loss: 1.346858, loss_ss: 0.859359, loss_d: 0.487499
0.3072 --- loss: 1.419236, loss_ss: 1.184523, loss_d: 0.234714
0.3456 --- loss: 1.931822, loss_ss: 1.075838, loss_d: 0.855984
0.3840 --- loss: 1.781075, loss_ss: 1.214700, loss_d: 0.566376
0.4224 --- loss: 1.436960, loss_ss: 0.896608, loss_d: 0.540352
0.4608 --- loss: 1.547467, loss_ss: 1.163391, loss_d: 0.384076
0.4992 --- loss: 1.238591, loss_ss: 1.015040, loss_d: 0.223551
0.5376 --- loss: 1.594449, loss_ss: 1.151926, loss_d: 0.442523
0.5760 --- loss: 1.531135, loss_ss: 1.221284, loss_d: 0.309851
0.6144 --- loss: 1.246378, loss_ss: 0.808308, loss_d: 0.438070
0.6528 --- loss: 1.784797, loss_ss: 1.430487, loss_d: 0.354310
0.6912 --- loss: 1.750000, loss_ss: 1.205441, loss_d: 0.544559
0.7296 --- loss: 1.627800, loss_ss: 1.097941, loss_d: 0.529860
0.7680 --- loss: 1.222027, loss_ss: 0.917120, loss_d: 0.304907
0.8065 --- loss: 2.013683, loss_ss: 1.135288, loss_d: 0.878396
0.8449 --- loss: 1.540131, loss_ss: 1.208712, loss_d: 0.331418
0.8833 --- loss: 1.613990, loss_ss: 1.334801, loss_d: 0.279188
0.9217 --- loss: 1.305522, loss_ss: 0.834455, loss_d: 0.471067
0.9601 --- loss: 1.564021, loss_ss: 1.137144, loss_d: 0.426876
0.9985 --- loss: 2.179355, loss_ss: 1.359226, loss_d: 0.820129
Epoch finished! Loss: 1.5238542680556957
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.930613, loss_ss: 1.273717, loss_d: 0.656895
0.0384 --- loss: 1.297894, loss_ss: 0.978939, loss_d: 0.318955
0.0768 --- loss: 1.411934, loss_ss: 1.172631, loss_d: 0.239303
0.1152 --- loss: 1.159830, loss_ss: 0.846957, loss_d: 0.312873
0.1536 --- loss: 1.093050, loss_ss: 0.679289, loss_d: 0.413761
0.1920 --- loss: 1.198871, loss_ss: 0.874600, loss_d: 0.324270
0.2304 --- loss: 1.403237, loss_ss: 0.984349, loss_d: 0.418888
0.2688 --- loss: 1.611739, loss_ss: 1.048735, loss_d: 0.563003
0.3072 --- loss: 1.509117, loss_ss: 1.120455, loss_d: 0.388662
0.3456 --- loss: 1.423182, loss_ss: 1.136303, loss_d: 0.286879
0.3840 --- loss: 1.586634, loss_ss: 1.156057, loss_d: 0.430576
0.4224 --- loss: 1.267927, loss_ss: 0.979401, loss_d: 0.288526
0.4608 --- loss: 1.361947, loss_ss: 0.971421, loss_d: 0.390526
0.4992 --- loss: 1.470359, loss_ss: 1.116232, loss_d: 0.354127
0.5376 --- loss: 1.234913, loss_ss: 0.930602, loss_d: 0.304312
0.5760 --- loss: 1.657371, loss_ss: 1.348450, loss_d: 0.308921
0.6144 --- loss: 1.651286, loss_ss: 1.106193, loss_d: 0.545093
0.6528 --- loss: 1.576854, loss_ss: 1.274647, loss_d: 0.302206
0.6912 --- loss: 1.485538, loss_ss: 1.149353, loss_d: 0.336185
0.7296 --- loss: 1.361733, loss_ss: 1.149088, loss_d: 0.212645
0.7680 --- loss: 1.773923, loss_ss: 1.132737, loss_d: 0.641186
0.8065 --- loss: 1.601689, loss_ss: 1.194383, loss_d: 0.407306
0.8449 --- loss: 1.432357, loss_ss: 1.105524, loss_d: 0.326833
0.8833 --- loss: 1.217326, loss_ss: 0.920691, loss_d: 0.296635
0.9217 --- loss: 1.145965, loss_ss: 0.882780, loss_d: 0.263186
0.9601 --- loss: 1.784378, loss_ss: 1.322573, loss_d: 0.461805
0.9985 --- loss: 1.728796, loss_ss: 1.574598, loss_d: 0.154197
Epoch finished! Loss: 1.5002062747111686
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.35
             precision    recall  f1-score   support

        0.0       0.67      0.36      0.47        66
        1.0       0.00      0.00      0.00        44
        2.0       0.00      0.00      0.00       406
        3.0       0.34      1.00      0.51       334
        4.0       0.00      0.00      0.00       170

avg / total       0.15      0.35      0.20      1020
 


====== chp029-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.71  36.36   98.74  66.67     47.06
1  95.69   0.00  100.00   0.00      0.00
2  60.20   0.00  100.00   0.00      0.00
3  36.08  99.70    5.10  33.84     50.53
4  83.33   0.00  100.00   0.00      0.00
Total accuracy: 35.00%
Average sen: 27.21%
Average spec: 80.77%
Macro f1-score: 19.52%
[0.31098849 0.53389674 0.66912597 0.49091509 0.36749151 0.31774274
 0.1298683  0.06681408 0.32176641 0.39865959 0.25043756 0.56148505
 0.3385011  0.25371775 0.11063211 0.10806788 0.4273673  0.43313846
 0.53064656 0.62269634 0.31546918 0.22102663 0.34226608 0.38253841
 0.40368518 0.0901015  0.29036936 0.4271076  0.42848632 0.42411208
 0.31549776 0.02379662 0.08962642 0.41255865]
pred: 0.3356059058295453, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.277741, loss_ss: 1.631754, loss_d: 0.645987
0.0385 --- loss: 2.396153, loss_ss: 1.904991, loss_d: 0.491163
0.0770 --- loss: 2.790658, loss_ss: 2.107355, loss_d: 0.683303
0.1155 --- loss: 2.298798, loss_ss: 1.683741, loss_d: 0.615056
0.1540 --- loss: 2.250155, loss_ss: 1.753928, loss_d: 0.496227
0.1925 --- loss: 2.213416, loss_ss: 1.953906, loss_d: 0.259510
0.2309 --- loss: 2.184290, loss_ss: 1.689728, loss_d: 0.494561
0.2694 --- loss: 2.310615, loss_ss: 1.621554, loss_d: 0.689062
0.3079 --- loss: 2.182282, loss_ss: 1.624450, loss_d: 0.557832
0.3464 --- loss: 2.202950, loss_ss: 1.611099, loss_d: 0.591851
0.3849 --- loss: 2.058233, loss_ss: 1.555270, loss_d: 0.502963
0.4234 --- loss: 2.380931, loss_ss: 1.741631, loss_d: 0.639300
0.4619 --- loss: 2.094614, loss_ss: 1.602523, loss_d: 0.492091
0.5004 --- loss: 2.652874, loss_ss: 1.632794, loss_d: 1.020079
0.5389 --- loss: 2.058147, loss_ss: 1.529639, loss_d: 0.528508
0.5774 --- loss: 2.240443, loss_ss: 1.702025, loss_d: 0.538418
0.6159 --- loss: 1.966608, loss_ss: 1.417360, loss_d: 0.549248
0.6543 --- loss: 2.216553, loss_ss: 1.721925, loss_d: 0.494628
0.6928 --- loss: 1.878587, loss_ss: 1.579493, loss_d: 0.299094
0.7313 --- loss: 2.328287, loss_ss: 1.613754, loss_d: 0.714533
0.7698 --- loss: 2.110109, loss_ss: 1.610560, loss_d: 0.499549
0.8083 --- loss: 1.814633, loss_ss: 1.575786, loss_d: 0.238847
0.8468 --- loss: 1.951511, loss_ss: 1.671513, loss_d: 0.279998
0.8853 --- loss: 2.003306, loss_ss: 1.455104, loss_d: 0.548202
0.9238 --- loss: 2.040861, loss_ss: 1.705961, loss_d: 0.334899
0.9623 --- loss: 1.871483, loss_ss: 1.556954, loss_d: 0.314528
Epoch finished! Loss: 2.228962823691055
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.071398, loss_ss: 1.646826, loss_d: 0.424571
0.0385 --- loss: 1.970225, loss_ss: 1.566341, loss_d: 0.403884
0.0770 --- loss: 2.154484, loss_ss: 1.496607, loss_d: 0.657876
0.1155 --- loss: 1.883063, loss_ss: 1.496009, loss_d: 0.387054
0.1540 --- loss: 1.917512, loss_ss: 1.458742, loss_d: 0.458770
0.1925 --- loss: 2.244724, loss_ss: 1.547246, loss_d: 0.697478
0.2309 --- loss: 1.770950, loss_ss: 1.498810, loss_d: 0.272140
0.2694 --- loss: 2.013939, loss_ss: 1.454072, loss_d: 0.559867
0.3079 --- loss: 2.123489, loss_ss: 1.659025, loss_d: 0.464464
0.3464 --- loss: 1.842834, loss_ss: 1.368361, loss_d: 0.474472
0.3849 --- loss: 1.968620, loss_ss: 1.551272, loss_d: 0.417347
0.4234 --- loss: 2.008833, loss_ss: 1.598793, loss_d: 0.410041
0.4619 --- loss: 2.088301, loss_ss: 1.575351, loss_d: 0.512950
0.5004 --- loss: 2.044154, loss_ss: 1.412672, loss_d: 0.631482
0.5389 --- loss: 2.268461, loss_ss: 1.576457, loss_d: 0.692005
0.5774 --- loss: 2.751244, loss_ss: 1.609692, loss_d: 1.141552
0.6159 --- loss: 2.189061, loss_ss: 1.645929, loss_d: 0.543132
0.6543 --- loss: 2.049616, loss_ss: 1.471566, loss_d: 0.578050
0.6928 --- loss: 2.049032, loss_ss: 1.422457, loss_d: 0.626576
0.7313 --- loss: 2.157331, loss_ss: 1.603320, loss_d: 0.554012
0.7698 --- loss: 2.002549, loss_ss: 1.586143, loss_d: 0.416406
0.8083 --- loss: 2.470588, loss_ss: 1.489898, loss_d: 0.980690
0.8468 --- loss: 1.946577, loss_ss: 1.578808, loss_d: 0.367769
0.8853 --- loss: 1.906279, loss_ss: 1.476128, loss_d: 0.430151
0.9238 --- loss: 2.072976, loss_ss: 1.511933, loss_d: 0.561043
0.9623 --- loss: 1.944906, loss_ss: 1.492245, loss_d: 0.452660
Epoch finished! Loss: 2.07011138794505
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.202566, loss_ss: 1.558419, loss_d: 0.644148
0.0385 --- loss: 1.949679, loss_ss: 1.499346, loss_d: 0.450332
0.0770 --- loss: 1.940813, loss_ss: 1.500963, loss_d: 0.439850
0.1155 --- loss: 1.769372, loss_ss: 1.459920, loss_d: 0.309451
0.1540 --- loss: 1.949933, loss_ss: 1.518011, loss_d: 0.431922
0.1925 --- loss: 1.981621, loss_ss: 1.392538, loss_d: 0.589083
0.2309 --- loss: 2.175550, loss_ss: 1.315006, loss_d: 0.860545
0.2694 --- loss: 2.214272, loss_ss: 1.566802, loss_d: 0.647470
0.3079 --- loss: 2.176423, loss_ss: 1.627414, loss_d: 0.549008
0.3464 --- loss: 1.879506, loss_ss: 1.544327, loss_d: 0.335179
0.3849 --- loss: 1.979522, loss_ss: 1.560238, loss_d: 0.419284
0.4234 --- loss: 1.904699, loss_ss: 1.387022, loss_d: 0.517677
0.4619 --- loss: 2.055295, loss_ss: 1.369848, loss_d: 0.685447
0.5004 --- loss: 1.752186, loss_ss: 1.341212, loss_d: 0.410974
0.5389 --- loss: 1.680181, loss_ss: 1.244621, loss_d: 0.435559
0.5774 --- loss: 2.080651, loss_ss: 1.348775, loss_d: 0.731876
0.6159 --- loss: 2.059497, loss_ss: 1.515146, loss_d: 0.544352
0.6543 --- loss: 1.820595, loss_ss: 1.376116, loss_d: 0.444479
0.6928 --- loss: 2.199578, loss_ss: 1.616070, loss_d: 0.583508
0.7313 --- loss: 1.932724, loss_ss: 1.507690, loss_d: 0.425034
0.7698 --- loss: 1.766716, loss_ss: 1.286010, loss_d: 0.480706
0.8083 --- loss: 2.269639, loss_ss: 1.241780, loss_d: 1.027859
0.8468 --- loss: 1.693603, loss_ss: 1.225416, loss_d: 0.468187
0.8853 --- loss: 1.811530, loss_ss: 1.393987, loss_d: 0.417543
0.9238 --- loss: 1.916689, loss_ss: 1.420727, loss_d: 0.495963
0.9623 --- loss: 1.720489, loss_ss: 1.379210, loss_d: 0.341279
Epoch finished! Loss: 1.9779292483127255
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.591785, loss_ss: 1.215796, loss_d: 0.375989
0.0385 --- loss: 1.906631, loss_ss: 1.509141, loss_d: 0.397490
0.0770 --- loss: 1.753068, loss_ss: 1.402286, loss_d: 0.350782
0.1155 --- loss: 1.860835, loss_ss: 1.111229, loss_d: 0.749606
0.1540 --- loss: 1.951447, loss_ss: 1.533939, loss_d: 0.417508
0.1925 --- loss: 1.946443, loss_ss: 1.323229, loss_d: 0.623214
0.2309 --- loss: 2.387971, loss_ss: 1.479999, loss_d: 0.907972
0.2694 --- loss: 1.518392, loss_ss: 1.179070, loss_d: 0.339322
0.3079 --- loss: 1.754535, loss_ss: 1.392571, loss_d: 0.361964
0.3464 --- loss: 2.079813, loss_ss: 1.396184, loss_d: 0.683630
0.3849 --- loss: 2.510420, loss_ss: 1.125998, loss_d: 1.384422
0.4234 --- loss: 1.817487, loss_ss: 1.258272, loss_d: 0.559215
0.4619 --- loss: 1.934739, loss_ss: 1.442162, loss_d: 0.492577
0.5004 --- loss: 1.817412, loss_ss: 1.453383, loss_d: 0.364029
0.5389 --- loss: 1.574945, loss_ss: 1.133773, loss_d: 0.441172
0.5774 --- loss: 2.641639, loss_ss: 1.231332, loss_d: 1.410307
0.6159 --- loss: 1.932574, loss_ss: 1.442727, loss_d: 0.489847
0.6543 --- loss: 1.877294, loss_ss: 1.418843, loss_d: 0.458452
0.6928 --- loss: 1.710544, loss_ss: 1.135927, loss_d: 0.574617
0.7313 --- loss: 1.843378, loss_ss: 1.482880, loss_d: 0.360498
0.7698 --- loss: 2.005680, loss_ss: 1.490202, loss_d: 0.515478
0.8083 --- loss: 2.222527, loss_ss: 1.204172, loss_d: 1.018354
0.8468 --- loss: 1.794717, loss_ss: 1.338354, loss_d: 0.456363
0.8853 --- loss: 1.762988, loss_ss: 1.341693, loss_d: 0.421295
0.9238 --- loss: 1.723657, loss_ss: 1.338387, loss_d: 0.385270
0.9623 --- loss: 1.588831, loss_ss: 1.176208, loss_d: 0.412623
Epoch finished! Loss: 1.86979295158018
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.756289, loss_ss: 1.381709, loss_d: 0.374580
0.0385 --- loss: 2.306758, loss_ss: 1.761187, loss_d: 0.545572
0.0770 --- loss: 2.076931, loss_ss: 1.373018, loss_d: 0.703913
0.1155 --- loss: 2.442752, loss_ss: 1.364193, loss_d: 1.078559
0.1540 --- loss: 1.776291, loss_ss: 1.354851, loss_d: 0.421439
0.1925 --- loss: 1.659073, loss_ss: 1.120445, loss_d: 0.538628
0.2309 --- loss: 1.660733, loss_ss: 1.115431, loss_d: 0.545302
0.2694 --- loss: 1.816150, loss_ss: 1.314825, loss_d: 0.501325
0.3079 --- loss: 1.513789, loss_ss: 1.122371, loss_d: 0.391417
0.3464 --- loss: 1.913092, loss_ss: 1.541603, loss_d: 0.371490
0.3849 --- loss: 1.853596, loss_ss: 1.415334, loss_d: 0.438262
0.4234 --- loss: 1.756468, loss_ss: 1.248576, loss_d: 0.507893
0.4619 --- loss: 1.520360, loss_ss: 1.045208, loss_d: 0.475152
0.5004 --- loss: 1.732854, loss_ss: 1.450337, loss_d: 0.282517
0.5389 --- loss: 1.508743, loss_ss: 1.113704, loss_d: 0.395039
0.5774 --- loss: 1.702049, loss_ss: 1.384081, loss_d: 0.317968
0.6159 --- loss: 2.522934, loss_ss: 1.595398, loss_d: 0.927536
0.6543 --- loss: 1.550294, loss_ss: 1.180757, loss_d: 0.369537
0.6928 --- loss: 1.638744, loss_ss: 1.177347, loss_d: 0.461397
0.7313 --- loss: 1.902496, loss_ss: 1.312068, loss_d: 0.590427
0.7698 --- loss: 1.804435, loss_ss: 1.080829, loss_d: 0.723606
0.8083 --- loss: 2.011944, loss_ss: 1.196851, loss_d: 0.815094
0.8468 --- loss: 1.541662, loss_ss: 1.160668, loss_d: 0.380993
0.8853 --- loss: 1.551581, loss_ss: 1.216092, loss_d: 0.335488
0.9238 --- loss: 1.493666, loss_ss: 1.177974, loss_d: 0.315692
0.9623 --- loss: 2.234090, loss_ss: 1.527522, loss_d: 0.706568
Epoch finished! Loss: 1.7573764904125317
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.805073, loss_ss: 1.435694, loss_d: 0.369379
0.0385 --- loss: 1.621540, loss_ss: 1.280492, loss_d: 0.341048
0.0770 --- loss: 1.730312, loss_ss: 1.367169, loss_d: 0.363143
0.1155 --- loss: 1.718976, loss_ss: 1.283385, loss_d: 0.435591
0.1540 --- loss: 1.784291, loss_ss: 1.470912, loss_d: 0.313378
0.1925 --- loss: 1.857246, loss_ss: 1.240200, loss_d: 0.617046
0.2309 --- loss: 1.922335, loss_ss: 1.479117, loss_d: 0.443218
0.2694 --- loss: 1.445931, loss_ss: 1.021210, loss_d: 0.424721
0.3079 --- loss: 1.409416, loss_ss: 1.099750, loss_d: 0.309666
0.3464 --- loss: 1.737294, loss_ss: 1.281533, loss_d: 0.455761
0.3849 --- loss: 1.612396, loss_ss: 1.032853, loss_d: 0.579543
0.4234 --- loss: 2.061118, loss_ss: 1.249197, loss_d: 0.811922
0.4619 --- loss: 1.490191, loss_ss: 1.014183, loss_d: 0.476009
0.5004 --- loss: 1.674706, loss_ss: 1.252579, loss_d: 0.422127
0.5389 --- loss: 1.523136, loss_ss: 1.064253, loss_d: 0.458884
0.5774 --- loss: 1.864148, loss_ss: 1.291146, loss_d: 0.573002
0.6159 --- loss: 1.622347, loss_ss: 1.248497, loss_d: 0.373850
0.6543 --- loss: 1.781996, loss_ss: 1.259776, loss_d: 0.522220
0.6928 --- loss: 1.467165, loss_ss: 1.108066, loss_d: 0.359099
0.7313 --- loss: 1.696589, loss_ss: 1.094052, loss_d: 0.602536
0.7698 --- loss: 1.493080, loss_ss: 1.044388, loss_d: 0.448693
0.8083 --- loss: 1.424466, loss_ss: 0.960828, loss_d: 0.463637
0.8468 --- loss: 1.522260, loss_ss: 1.188534, loss_d: 0.333727
0.8853 --- loss: 1.599431, loss_ss: 1.153324, loss_d: 0.446107
0.9238 --- loss: 1.753101, loss_ss: 1.247607, loss_d: 0.505494
0.9623 --- loss: 2.018407, loss_ss: 1.389876, loss_d: 0.628531
Epoch finished! Loss: 1.6779363413114805
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.390443, loss_ss: 1.005170, loss_d: 0.385273
0.0385 --- loss: 1.609717, loss_ss: 1.252553, loss_d: 0.357164
0.0770 --- loss: 2.256872, loss_ss: 1.230273, loss_d: 1.026599
0.1155 --- loss: 1.732901, loss_ss: 1.417891, loss_d: 0.315010
0.1540 --- loss: 1.966721, loss_ss: 1.137092, loss_d: 0.829629
0.1925 --- loss: 1.769874, loss_ss: 1.139413, loss_d: 0.630461
0.2309 --- loss: 1.411525, loss_ss: 1.071861, loss_d: 0.339664
0.2694 --- loss: 1.671547, loss_ss: 1.309704, loss_d: 0.361843
0.3079 --- loss: 1.452735, loss_ss: 1.139064, loss_d: 0.313671
0.3464 --- loss: 1.833110, loss_ss: 1.086223, loss_d: 0.746887
0.3849 --- loss: 1.882450, loss_ss: 1.583257, loss_d: 0.299194
0.4234 --- loss: 1.348737, loss_ss: 1.057750, loss_d: 0.290988
0.4619 --- loss: 1.525777, loss_ss: 1.041283, loss_d: 0.484494
0.5004 --- loss: 1.790710, loss_ss: 1.129901, loss_d: 0.660809
0.5389 --- loss: 1.625415, loss_ss: 1.281895, loss_d: 0.343520
0.5774 --- loss: 1.433635, loss_ss: 0.975041, loss_d: 0.458595
0.6159 --- loss: 1.669173, loss_ss: 1.203969, loss_d: 0.465204
0.6543 --- loss: 1.421553, loss_ss: 0.955620, loss_d: 0.465933
0.6928 --- loss: 1.490559, loss_ss: 1.065273, loss_d: 0.425285
0.7313 --- loss: 1.314775, loss_ss: 0.968848, loss_d: 0.345927
0.7698 --- loss: 2.151887, loss_ss: 1.170225, loss_d: 0.981662
0.8083 --- loss: 1.408992, loss_ss: 0.911148, loss_d: 0.497844
0.8468 --- loss: 1.685214, loss_ss: 1.209008, loss_d: 0.476207
0.8853 --- loss: 1.789204, loss_ss: 1.404743, loss_d: 0.384461
0.9238 --- loss: 1.293645, loss_ss: 0.917535, loss_d: 0.376111
0.9623 --- loss: 1.730098, loss_ss: 1.159721, loss_d: 0.570377
Epoch finished! Loss: 1.614295321081596
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.620725, loss_ss: 1.048719, loss_d: 0.572005
0.0385 --- loss: 1.828834, loss_ss: 1.395861, loss_d: 0.432973
0.0770 --- loss: 1.604945, loss_ss: 1.144671, loss_d: 0.460273
0.1155 --- loss: 1.368129, loss_ss: 0.994402, loss_d: 0.373726
0.1540 --- loss: 1.652714, loss_ss: 1.101210, loss_d: 0.551504
0.1925 --- loss: 1.342231, loss_ss: 0.959478, loss_d: 0.382754
0.2309 --- loss: 1.721287, loss_ss: 1.065553, loss_d: 0.655734
0.2694 --- loss: 1.478024, loss_ss: 1.107481, loss_d: 0.370543
0.3079 --- loss: 1.435967, loss_ss: 1.022641, loss_d: 0.413326
0.3464 --- loss: 1.401637, loss_ss: 1.109184, loss_d: 0.292453
0.3849 --- loss: 1.290820, loss_ss: 0.939109, loss_d: 0.351712
0.4234 --- loss: 1.793718, loss_ss: 1.147163, loss_d: 0.646555
0.4619 --- loss: 1.581290, loss_ss: 1.041717, loss_d: 0.539573
0.5004 --- loss: 1.407243, loss_ss: 1.006325, loss_d: 0.400918
0.5389 --- loss: 1.332077, loss_ss: 1.009305, loss_d: 0.322772
0.5774 --- loss: 1.326904, loss_ss: 0.947408, loss_d: 0.379497
0.6159 --- loss: 1.556582, loss_ss: 1.168397, loss_d: 0.388185
0.6543 --- loss: 1.604067, loss_ss: 1.222325, loss_d: 0.381741
0.6928 --- loss: 1.416840, loss_ss: 1.060761, loss_d: 0.356079
0.7313 --- loss: 1.434962, loss_ss: 1.014883, loss_d: 0.420079
0.7698 --- loss: 1.407218, loss_ss: 1.087575, loss_d: 0.319643
0.8083 --- loss: 1.556152, loss_ss: 0.993100, loss_d: 0.563051
0.8468 --- loss: 1.457672, loss_ss: 1.118294, loss_d: 0.339378
0.8853 --- loss: 1.313063, loss_ss: 0.989415, loss_d: 0.323648
0.9238 --- loss: 1.452735, loss_ss: 1.137694, loss_d: 0.315040
0.9623 --- loss: 1.722820, loss_ss: 1.321811, loss_d: 0.401009
Epoch finished! Loss: 1.568349250034936
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.253502, loss_ss: 0.848482, loss_d: 0.405020
0.0385 --- loss: 1.697071, loss_ss: 1.016781, loss_d: 0.680290
0.0770 --- loss: 1.471094, loss_ss: 1.207138, loss_d: 0.263956
0.1155 --- loss: 1.455274, loss_ss: 1.146252, loss_d: 0.309021
0.1540 --- loss: 1.397494, loss_ss: 0.937899, loss_d: 0.459595
0.1925 --- loss: 1.672787, loss_ss: 1.267615, loss_d: 0.405171
0.2309 --- loss: 1.578314, loss_ss: 1.163483, loss_d: 0.414831
0.2694 --- loss: 1.246314, loss_ss: 0.991771, loss_d: 0.254543
0.3079 --- loss: 1.298033, loss_ss: 0.886233, loss_d: 0.411801
0.3464 --- loss: 1.342070, loss_ss: 1.045492, loss_d: 0.296578
0.3849 --- loss: 1.721393, loss_ss: 1.072963, loss_d: 0.648430
0.4234 --- loss: 1.390349, loss_ss: 0.914453, loss_d: 0.475896
0.4619 --- loss: 1.328405, loss_ss: 0.939076, loss_d: 0.389329
0.5004 --- loss: 1.945083, loss_ss: 1.389184, loss_d: 0.555899
0.5389 --- loss: 1.114494, loss_ss: 0.883880, loss_d: 0.230614
0.5774 --- loss: 1.729215, loss_ss: 1.248180, loss_d: 0.481035
0.6159 --- loss: 1.333655, loss_ss: 0.964223, loss_d: 0.369432
0.6543 --- loss: 1.305536, loss_ss: 1.009722, loss_d: 0.295814
0.6928 --- loss: 1.399052, loss_ss: 0.940685, loss_d: 0.458367
0.7313 --- loss: 1.547924, loss_ss: 0.930142, loss_d: 0.617782
0.7698 --- loss: 1.591545, loss_ss: 0.835940, loss_d: 0.755605
0.8083 --- loss: 1.872529, loss_ss: 1.127389, loss_d: 0.745140
0.8468 --- loss: 1.293165, loss_ss: 0.929138, loss_d: 0.364026
0.8853 --- loss: 1.697751, loss_ss: 0.874635, loss_d: 0.823115
0.9238 --- loss: 1.743931, loss_ss: 1.155576, loss_d: 0.588355
0.9623 --- loss: 1.285833, loss_ss: 1.004087, loss_d: 0.281746
Epoch finished! Loss: 1.524776874822079
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.039492, loss_ss: 1.116497, loss_d: 0.922995
0.0385 --- loss: 1.695117, loss_ss: 1.011442, loss_d: 0.683675
0.0770 --- loss: 1.709801, loss_ss: 1.056163, loss_d: 0.653638
0.1155 --- loss: 1.492167, loss_ss: 0.817865, loss_d: 0.674302
0.1540 --- loss: 1.389909, loss_ss: 0.948630, loss_d: 0.441280
0.1925 --- loss: 1.380052, loss_ss: 1.013438, loss_d: 0.366614
0.2309 --- loss: 1.177819, loss_ss: 0.937196, loss_d: 0.240623
0.2694 --- loss: 1.600808, loss_ss: 1.040537, loss_d: 0.560271
0.3079 --- loss: 1.650416, loss_ss: 1.130732, loss_d: 0.519684
0.3464 --- loss: 1.845886, loss_ss: 1.169865, loss_d: 0.676020
0.3849 --- loss: 1.470013, loss_ss: 1.087548, loss_d: 0.382466
0.4234 --- loss: 1.386448, loss_ss: 0.951866, loss_d: 0.434582
0.4619 --- loss: 1.737802, loss_ss: 1.122676, loss_d: 0.615125
0.5004 --- loss: 1.382229, loss_ss: 1.007108, loss_d: 0.375120
0.5389 --- loss: 1.431559, loss_ss: 1.106347, loss_d: 0.325212
0.5774 --- loss: 1.736195, loss_ss: 0.919830, loss_d: 0.816365
0.6159 --- loss: 1.690774, loss_ss: 1.072206, loss_d: 0.618568
0.6543 --- loss: 1.375254, loss_ss: 1.009504, loss_d: 0.365750
0.6928 --- loss: 1.336191, loss_ss: 1.048265, loss_d: 0.287926
0.7313 --- loss: 1.940375, loss_ss: 1.267021, loss_d: 0.673354
0.7698 --- loss: 1.438505, loss_ss: 0.973221, loss_d: 0.465284
0.8083 --- loss: 1.492687, loss_ss: 1.155081, loss_d: 0.337606
0.8468 --- loss: 1.617557, loss_ss: 0.948042, loss_d: 0.669515
0.8853 --- loss: 1.367214, loss_ss: 0.998933, loss_d: 0.368281
0.9238 --- loss: 1.287265, loss_ss: 0.986852, loss_d: 0.300413
0.9623 --- loss: 1.782333, loss_ss: 1.023516, loss_d: 0.758817
Epoch finished! Loss: 1.52295771206668
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5045871559633027
             precision    recall  f1-score   support

        0.0       0.68      0.60      0.64       350
        1.0       1.00      0.00      0.01       204
        2.0       0.43      0.94      0.59       346
        3.0       0.49      0.36      0.42       179
        4.0       0.83      0.04      0.08       120

avg / total       0.65      0.50      0.43      1199
 


====== chp030-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  80.07  59.71   88.46   68.08     63.62
1  83.07   0.49  100.00  100.00      0.98
2  62.55  93.93   49.82   43.16     59.14
3  84.90  36.31   93.43   49.24     41.80
4  90.33   4.17   99.91   83.33      7.94
Total accuracy: 50.46%
Average sen: 38.92%
Average spec: 86.32%
Macro f1-score: 34.70%
[0.89922053 0.90120471 0.95625585 0.84620219 0.93365133 0.95742595
 0.96322942 0.96009737 0.69204801 0.85786659 0.97413445 0.80984706
 0.80890232 0.87656784 0.95514721 0.88337618 0.85461807 0.9120152
 0.83495212 0.92264092 0.90316302 0.92920953 0.94702369 0.80206531
 0.8302331  0.83767343 0.90501672 0.94589591 0.97138244 0.93194205
 0.9679693  0.77816385 0.96629423 0.91750121 0.9609099  0.92141449
 0.79153275 0.91242367 0.88670671 0.96440822]
pred: 0.89675832092762, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.573194, loss_ss: 1.869351, loss_d: 0.703843
0.0384 --- loss: 2.188750, loss_ss: 1.717173, loss_d: 0.471577
0.0769 --- loss: 2.212402, loss_ss: 1.719804, loss_d: 0.492597
0.1153 --- loss: 2.811899, loss_ss: 1.802130, loss_d: 1.009769
0.1538 --- loss: 2.121274, loss_ss: 1.647871, loss_d: 0.473403
0.1922 --- loss: 2.227330, loss_ss: 1.645896, loss_d: 0.581434
0.2307 --- loss: 2.169307, loss_ss: 1.575242, loss_d: 0.594065
0.2691 --- loss: 2.156965, loss_ss: 1.691833, loss_d: 0.465132
0.3076 --- loss: 1.891388, loss_ss: 1.441261, loss_d: 0.450127
0.3460 --- loss: 2.221238, loss_ss: 1.496952, loss_d: 0.724286
0.3845 --- loss: 2.271996, loss_ss: 1.647825, loss_d: 0.624170
0.4229 --- loss: 2.287148, loss_ss: 1.705659, loss_d: 0.581488
0.4614 --- loss: 2.172898, loss_ss: 1.618812, loss_d: 0.554087
0.4998 --- loss: 2.142709, loss_ss: 1.515015, loss_d: 0.627694
0.5383 --- loss: 2.109772, loss_ss: 1.588170, loss_d: 0.521601
0.5767 --- loss: 2.053624, loss_ss: 1.613869, loss_d: 0.439755
0.6151 --- loss: 1.875531, loss_ss: 1.563247, loss_d: 0.312285
0.6536 --- loss: 1.914802, loss_ss: 1.633488, loss_d: 0.281314
0.6920 --- loss: 2.207797, loss_ss: 1.622832, loss_d: 0.584964
0.7305 --- loss: 2.047628, loss_ss: 1.632088, loss_d: 0.415539
0.7689 --- loss: 2.283570, loss_ss: 1.611311, loss_d: 0.672259
0.8074 --- loss: 2.101366, loss_ss: 1.614061, loss_d: 0.487305
0.8458 --- loss: 2.032137, loss_ss: 1.435144, loss_d: 0.596993
0.8843 --- loss: 2.928549, loss_ss: 1.607662, loss_d: 1.320887
0.9227 --- loss: 1.961381, loss_ss: 1.502151, loss_d: 0.459230
0.9612 --- loss: 1.950714, loss_ss: 1.604908, loss_d: 0.345805
0.9996 --- loss: 1.878987, loss_ss: 1.634547, loss_d: 0.244440
Epoch finished! Loss: 2.1645715851050156
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.923980, loss_ss: 1.514100, loss_d: 0.409880
0.0384 --- loss: 2.255164, loss_ss: 1.430860, loss_d: 0.824303
0.0769 --- loss: 1.731444, loss_ss: 1.443805, loss_d: 0.287639
0.1153 --- loss: 2.054327, loss_ss: 1.451938, loss_d: 0.602389
0.1538 --- loss: 1.847127, loss_ss: 1.475938, loss_d: 0.371189
0.1922 --- loss: 1.987193, loss_ss: 1.432101, loss_d: 0.555093
0.2307 --- loss: 1.942340, loss_ss: 1.475645, loss_d: 0.466695
0.2691 --- loss: 1.835097, loss_ss: 1.389825, loss_d: 0.445272
0.3076 --- loss: 2.109722, loss_ss: 1.537983, loss_d: 0.571739
0.3460 --- loss: 2.548593, loss_ss: 1.665149, loss_d: 0.883443
0.3845 --- loss: 2.145814, loss_ss: 1.445649, loss_d: 0.700165
0.4229 --- loss: 1.855368, loss_ss: 1.381436, loss_d: 0.473933
0.4614 --- loss: 1.989036, loss_ss: 1.449347, loss_d: 0.539689
0.4998 --- loss: 1.865551, loss_ss: 1.429665, loss_d: 0.435886
0.5383 --- loss: 1.718709, loss_ss: 1.445247, loss_d: 0.273461
0.5767 --- loss: 2.244447, loss_ss: 1.284129, loss_d: 0.960317
0.6151 --- loss: 1.937949, loss_ss: 1.498382, loss_d: 0.439567
0.6536 --- loss: 1.852549, loss_ss: 1.395310, loss_d: 0.457239
0.6920 --- loss: 1.869238, loss_ss: 1.401516, loss_d: 0.467722
0.7305 --- loss: 2.120543, loss_ss: 1.423059, loss_d: 0.697484
0.7689 --- loss: 2.100214, loss_ss: 1.561886, loss_d: 0.538329
0.8074 --- loss: 1.911723, loss_ss: 1.421204, loss_d: 0.490518
0.8458 --- loss: 1.923851, loss_ss: 1.287395, loss_d: 0.636456
0.8843 --- loss: 1.948195, loss_ss: 1.425961, loss_d: 0.522234
0.9227 --- loss: 1.796578, loss_ss: 1.340359, loss_d: 0.456219
0.9612 --- loss: 1.711364, loss_ss: 1.289591, loss_d: 0.421772
0.9996 --- loss: 2.086483, loss_ss: 1.870575, loss_d: 0.215907
Epoch finished! Loss: 1.9599871163184825
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.486562, loss_ss: 1.448552, loss_d: 1.038010
0.0384 --- loss: 1.641043, loss_ss: 1.319507, loss_d: 0.321536
0.0769 --- loss: 1.677423, loss_ss: 1.272034, loss_d: 0.405389
0.1153 --- loss: 1.926399, loss_ss: 1.337826, loss_d: 0.588573
0.1538 --- loss: 2.085227, loss_ss: 1.243068, loss_d: 0.842159
0.1922 --- loss: 1.716828, loss_ss: 1.297909, loss_d: 0.418920
0.2307 --- loss: 1.976591, loss_ss: 1.370777, loss_d: 0.605814
0.2691 --- loss: 1.862991, loss_ss: 1.329919, loss_d: 0.533072
0.3076 --- loss: 1.846080, loss_ss: 1.362502, loss_d: 0.483579
0.3460 --- loss: 2.013537, loss_ss: 1.318285, loss_d: 0.695252
0.3845 --- loss: 1.684831, loss_ss: 1.275007, loss_d: 0.409824
0.4229 --- loss: 1.800987, loss_ss: 1.289539, loss_d: 0.511448
0.4614 --- loss: 1.534967, loss_ss: 1.199516, loss_d: 0.335451
0.4998 --- loss: 1.938942, loss_ss: 1.310661, loss_d: 0.628281
0.5383 --- loss: 2.065963, loss_ss: 1.645884, loss_d: 0.420078
0.5767 --- loss: 1.753581, loss_ss: 1.222649, loss_d: 0.530932
0.6151 --- loss: 1.547305, loss_ss: 1.093125, loss_d: 0.454180
0.6536 --- loss: 1.797756, loss_ss: 1.259544, loss_d: 0.538212
0.6920 --- loss: 1.744070, loss_ss: 1.241133, loss_d: 0.502937
0.7305 --- loss: 1.724711, loss_ss: 1.151157, loss_d: 0.573554
0.7689 --- loss: 1.719163, loss_ss: 1.121797, loss_d: 0.597366
0.8074 --- loss: 1.642384, loss_ss: 1.322140, loss_d: 0.320243
0.8458 --- loss: 1.658001, loss_ss: 1.193306, loss_d: 0.464695
0.8843 --- loss: 2.244510, loss_ss: 1.083320, loss_d: 1.161189
0.9227 --- loss: 1.528028, loss_ss: 1.183141, loss_d: 0.344888
0.9612 --- loss: 2.052911, loss_ss: 1.218494, loss_d: 0.834417
0.9996 --- loss: 1.275065, loss_ss: 1.094760, loss_d: 0.180304
Epoch finished! Loss: 1.8123098180844233
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.766660, loss_ss: 1.388426, loss_d: 0.378234
0.0384 --- loss: 1.690015, loss_ss: 1.337367, loss_d: 0.352648
0.0769 --- loss: 1.521931, loss_ss: 1.206644, loss_d: 0.315286
0.1153 --- loss: 1.630723, loss_ss: 1.341226, loss_d: 0.289497
0.1538 --- loss: 1.588541, loss_ss: 1.131407, loss_d: 0.457134
0.1922 --- loss: 1.682683, loss_ss: 1.235644, loss_d: 0.447039
0.2307 --- loss: 1.706220, loss_ss: 1.244957, loss_d: 0.461262
0.2691 --- loss: 1.659137, loss_ss: 1.199877, loss_d: 0.459260
0.3076 --- loss: 1.345207, loss_ss: 0.973534, loss_d: 0.371674
0.3460 --- loss: 1.855293, loss_ss: 1.162201, loss_d: 0.693092
0.3845 --- loss: 1.766722, loss_ss: 1.352384, loss_d: 0.414338
0.4229 --- loss: 1.791448, loss_ss: 1.076525, loss_d: 0.714923
0.4614 --- loss: 1.861227, loss_ss: 1.425434, loss_d: 0.435793
0.4998 --- loss: 1.538689, loss_ss: 1.184356, loss_d: 0.354333
0.5383 --- loss: 1.496719, loss_ss: 1.051578, loss_d: 0.445141
0.5767 --- loss: 1.878829, loss_ss: 1.149354, loss_d: 0.729475
0.6151 --- loss: 1.676103, loss_ss: 1.339755, loss_d: 0.336348
0.6536 --- loss: 2.065315, loss_ss: 1.268549, loss_d: 0.796766
0.6920 --- loss: 1.356454, loss_ss: 1.046757, loss_d: 0.309698
0.7305 --- loss: 1.896230, loss_ss: 1.340097, loss_d: 0.556133
0.7689 --- loss: 1.693624, loss_ss: 1.187036, loss_d: 0.506588
0.8074 --- loss: 1.838676, loss_ss: 1.458733, loss_d: 0.379943
0.8458 --- loss: 1.665271, loss_ss: 1.249297, loss_d: 0.415973
0.8843 --- loss: 1.591780, loss_ss: 1.216083, loss_d: 0.375696
0.9227 --- loss: 1.626448, loss_ss: 1.195082, loss_d: 0.431365
0.9612 --- loss: 1.473648, loss_ss: 1.108307, loss_d: 0.365341
0.9996 --- loss: 3.424387, loss_ss: 1.599701, loss_d: 1.824687
Epoch finished! Loss: 1.729528076832111
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.275476, loss_ss: 1.635179, loss_d: 0.640296
0.0384 --- loss: 2.001224, loss_ss: 1.144592, loss_d: 0.856632
0.0769 --- loss: 1.731227, loss_ss: 1.224237, loss_d: 0.506990
0.1153 --- loss: 1.720711, loss_ss: 1.322617, loss_d: 0.398094
0.1538 --- loss: 1.553024, loss_ss: 1.116747, loss_d: 0.436277
0.1922 --- loss: 1.709053, loss_ss: 1.282839, loss_d: 0.426214
0.2307 --- loss: 1.442252, loss_ss: 1.139699, loss_d: 0.302553
0.2691 --- loss: 1.383096, loss_ss: 0.914853, loss_d: 0.468243
0.3076 --- loss: 1.477583, loss_ss: 1.193617, loss_d: 0.283966
0.3460 --- loss: 1.412073, loss_ss: 1.112332, loss_d: 0.299741
0.3845 --- loss: 1.469429, loss_ss: 0.860542, loss_d: 0.608887
0.4229 --- loss: 1.499233, loss_ss: 1.034320, loss_d: 0.464913
0.4614 --- loss: 1.681300, loss_ss: 1.140569, loss_d: 0.540731
0.4998 --- loss: 2.320561, loss_ss: 0.991110, loss_d: 1.329451
0.5383 --- loss: 1.535421, loss_ss: 1.094702, loss_d: 0.440719
0.5767 --- loss: 1.735722, loss_ss: 1.316010, loss_d: 0.419712
0.6151 --- loss: 1.749381, loss_ss: 1.151973, loss_d: 0.597408
0.6536 --- loss: 1.613878, loss_ss: 1.287529, loss_d: 0.326349
0.6920 --- loss: 1.673280, loss_ss: 1.356919, loss_d: 0.316361
0.7305 --- loss: 1.689047, loss_ss: 1.420404, loss_d: 0.268644
0.7689 --- loss: 1.530604, loss_ss: 1.129155, loss_d: 0.401449
0.8074 --- loss: 1.472242, loss_ss: 1.107440, loss_d: 0.364802
0.8458 --- loss: 1.576902, loss_ss: 1.033293, loss_d: 0.543609
0.8843 --- loss: 1.847032, loss_ss: 1.430561, loss_d: 0.416471
0.9227 --- loss: 1.784462, loss_ss: 1.305359, loss_d: 0.479103
0.9612 --- loss: 1.596800, loss_ss: 1.049915, loss_d: 0.546885
0.9996 --- loss: 2.457255, loss_ss: 2.260162, loss_d: 0.197094
Epoch finished! Loss: 1.6613243378125704
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.509226, loss_ss: 1.084717, loss_d: 0.424509
0.0384 --- loss: 1.806691, loss_ss: 1.278233, loss_d: 0.528458
0.0769 --- loss: 1.863859, loss_ss: 1.447474, loss_d: 0.416385
0.1153 --- loss: 1.565932, loss_ss: 1.192486, loss_d: 0.373445
0.1538 --- loss: 1.522119, loss_ss: 0.984386, loss_d: 0.537733
0.1922 --- loss: 1.325344, loss_ss: 0.832255, loss_d: 0.493088
0.2307 --- loss: 1.568773, loss_ss: 0.938697, loss_d: 0.630076
0.2691 --- loss: 1.621910, loss_ss: 1.217815, loss_d: 0.404096
0.3076 --- loss: 1.916054, loss_ss: 1.168255, loss_d: 0.747798
0.3460 --- loss: 1.394708, loss_ss: 1.033543, loss_d: 0.361165
0.3845 --- loss: 1.768374, loss_ss: 1.105585, loss_d: 0.662789
0.4229 --- loss: 1.459066, loss_ss: 1.099888, loss_d: 0.359178
0.4614 --- loss: 1.693320, loss_ss: 1.221246, loss_d: 0.472074
0.4998 --- loss: 1.587387, loss_ss: 1.102019, loss_d: 0.485368
0.5383 --- loss: 1.854388, loss_ss: 1.285140, loss_d: 0.569247
0.5767 --- loss: 1.651647, loss_ss: 1.020580, loss_d: 0.631067
0.6151 --- loss: 1.888566, loss_ss: 1.103916, loss_d: 0.784650
0.6536 --- loss: 1.534497, loss_ss: 1.053746, loss_d: 0.480751
0.6920 --- loss: 1.824628, loss_ss: 1.268703, loss_d: 0.555925
0.7305 --- loss: 1.524765, loss_ss: 1.133206, loss_d: 0.391558
0.7689 --- loss: 1.912214, loss_ss: 1.380511, loss_d: 0.531703
0.8074 --- loss: 1.442841, loss_ss: 1.108785, loss_d: 0.334056
0.8458 --- loss: 1.170539, loss_ss: 0.833719, loss_d: 0.336820
0.8843 --- loss: 1.458968, loss_ss: 0.932718, loss_d: 0.526250
0.9227 --- loss: 1.668123, loss_ss: 1.117733, loss_d: 0.550389
0.9612 --- loss: 1.407755, loss_ss: 1.010690, loss_d: 0.397065
0.9996 --- loss: 4.144170, loss_ss: 2.228624, loss_d: 1.915546
Epoch finished! Loss: 1.6212657955976633
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.460132, loss_ss: 1.134476, loss_d: 0.325656
0.0384 --- loss: 1.751299, loss_ss: 1.351528, loss_d: 0.399771
0.0769 --- loss: 1.753397, loss_ss: 1.049931, loss_d: 0.703467
0.1153 --- loss: 1.442748, loss_ss: 1.060320, loss_d: 0.382428
0.1538 --- loss: 1.059205, loss_ss: 0.742105, loss_d: 0.317100
0.1922 --- loss: 1.242923, loss_ss: 0.938492, loss_d: 0.304430
0.2307 --- loss: 1.432696, loss_ss: 0.976962, loss_d: 0.455735
0.2691 --- loss: 1.539792, loss_ss: 1.226800, loss_d: 0.312992
0.3076 --- loss: 1.193549, loss_ss: 0.713959, loss_d: 0.479590
0.3460 --- loss: 1.825823, loss_ss: 1.349254, loss_d: 0.476569
0.3845 --- loss: 1.359952, loss_ss: 0.820366, loss_d: 0.539586
0.4229 --- loss: 1.509708, loss_ss: 0.909552, loss_d: 0.600156
0.4614 --- loss: 1.386216, loss_ss: 1.019163, loss_d: 0.367052
0.4998 --- loss: 1.515328, loss_ss: 1.183622, loss_d: 0.331706
0.5383 --- loss: 1.432246, loss_ss: 0.975768, loss_d: 0.456478
0.5767 --- loss: 2.015783, loss_ss: 0.937160, loss_d: 1.078623
0.6151 --- loss: 1.633479, loss_ss: 1.178160, loss_d: 0.455319
0.6536 --- loss: 1.485142, loss_ss: 0.989900, loss_d: 0.495242
0.6920 --- loss: 1.754331, loss_ss: 1.324751, loss_d: 0.429580
0.7305 --- loss: 1.563295, loss_ss: 0.975658, loss_d: 0.587638
0.7689 --- loss: 1.761631, loss_ss: 1.153233, loss_d: 0.608398
0.8074 --- loss: 1.591971, loss_ss: 0.996702, loss_d: 0.595269
0.8458 --- loss: 1.454548, loss_ss: 1.070466, loss_d: 0.384082
0.8843 --- loss: 1.388745, loss_ss: 0.991942, loss_d: 0.396803
0.9227 --- loss: 1.633393, loss_ss: 1.237404, loss_d: 0.395989
0.9612 --- loss: 1.466375, loss_ss: 1.062433, loss_d: 0.403942
0.9996 --- loss: 3.626537, loss_ss: 2.086478, loss_d: 1.540059
Epoch finished! Loss: 1.5849249798517961
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.030432, loss_ss: 1.433651, loss_d: 0.596781
0.0384 --- loss: 1.319451, loss_ss: 0.921871, loss_d: 0.397580
0.0769 --- loss: 1.393335, loss_ss: 0.989800, loss_d: 0.403534
0.1153 --- loss: 1.612109, loss_ss: 1.152029, loss_d: 0.460080
0.1538 --- loss: 1.521552, loss_ss: 1.124016, loss_d: 0.397536
0.1922 --- loss: 1.444391, loss_ss: 1.078750, loss_d: 0.365642
0.2307 --- loss: 1.560460, loss_ss: 1.197344, loss_d: 0.363116
0.2691 --- loss: 1.377666, loss_ss: 0.990620, loss_d: 0.387046
0.3076 --- loss: 1.231275, loss_ss: 0.845345, loss_d: 0.385929
0.3460 --- loss: 1.445246, loss_ss: 1.004422, loss_d: 0.440824
0.3845 --- loss: 1.261146, loss_ss: 0.820550, loss_d: 0.440596
0.4229 --- loss: 1.530740, loss_ss: 0.959632, loss_d: 0.571108
0.4614 --- loss: 1.453607, loss_ss: 1.115978, loss_d: 0.337628
0.4998 --- loss: 1.497468, loss_ss: 0.962518, loss_d: 0.534950
0.5383 --- loss: 1.304426, loss_ss: 0.975575, loss_d: 0.328851
0.5767 --- loss: 1.991365, loss_ss: 1.394605, loss_d: 0.596760
0.6151 --- loss: 1.647324, loss_ss: 1.233766, loss_d: 0.413558
0.6536 --- loss: 1.436197, loss_ss: 0.971090, loss_d: 0.465107
0.6920 --- loss: 1.774597, loss_ss: 1.140485, loss_d: 0.634112
0.7305 --- loss: 1.555521, loss_ss: 0.968417, loss_d: 0.587104
0.7689 --- loss: 1.500349, loss_ss: 1.096009, loss_d: 0.404340
0.8074 --- loss: 1.534399, loss_ss: 1.071156, loss_d: 0.463243
0.8458 --- loss: 1.522861, loss_ss: 1.094147, loss_d: 0.428714
0.8843 --- loss: 1.503927, loss_ss: 0.992496, loss_d: 0.511430
0.9227 --- loss: 1.486068, loss_ss: 1.095637, loss_d: 0.390431
0.9612 --- loss: 1.863726, loss_ss: 1.250979, loss_d: 0.612747
0.9996 --- loss: 1.334240, loss_ss: 1.171633, loss_d: 0.162606
Epoch finished! Loss: 1.5731154379936365
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.438129, loss_ss: 1.085258, loss_d: 0.352871
0.0384 --- loss: 1.972431, loss_ss: 1.613516, loss_d: 0.358915
0.0769 --- loss: 1.286901, loss_ss: 0.973443, loss_d: 0.313458
0.1153 --- loss: 1.364283, loss_ss: 0.785533, loss_d: 0.578751
0.1538 --- loss: 1.355030, loss_ss: 0.989667, loss_d: 0.365363
0.1922 --- loss: 1.544482, loss_ss: 1.082273, loss_d: 0.462209
0.2307 --- loss: 1.315884, loss_ss: 1.011209, loss_d: 0.304675
0.2691 --- loss: 1.391907, loss_ss: 1.118719, loss_d: 0.273188
0.3076 --- loss: 1.287314, loss_ss: 0.959129, loss_d: 0.328185
0.3460 --- loss: 1.531726, loss_ss: 0.986417, loss_d: 0.545309
0.3845 --- loss: 1.480028, loss_ss: 1.132601, loss_d: 0.347426
0.4229 --- loss: 1.531324, loss_ss: 1.212931, loss_d: 0.318393
0.4614 --- loss: 1.247156, loss_ss: 0.973829, loss_d: 0.273327
0.4998 --- loss: 1.678720, loss_ss: 0.982000, loss_d: 0.696720
0.5383 --- loss: 1.874233, loss_ss: 1.114385, loss_d: 0.759847
0.5767 --- loss: 1.585577, loss_ss: 1.235442, loss_d: 0.350135
0.6151 --- loss: 1.409106, loss_ss: 1.075202, loss_d: 0.333905
0.6536 --- loss: 1.537702, loss_ss: 1.245322, loss_d: 0.292380
0.6920 --- loss: 1.366526, loss_ss: 1.028776, loss_d: 0.337751
0.7305 --- loss: 1.744969, loss_ss: 1.364806, loss_d: 0.380163
0.7689 --- loss: 1.682885, loss_ss: 1.140739, loss_d: 0.542147
0.8074 --- loss: 1.417945, loss_ss: 1.002006, loss_d: 0.415939
0.8458 --- loss: 1.580759, loss_ss: 1.177292, loss_d: 0.403467
0.8843 --- loss: 1.596302, loss_ss: 1.289097, loss_d: 0.307205
0.9227 --- loss: 1.724772, loss_ss: 0.770370, loss_d: 0.954402
0.9612 --- loss: 1.440261, loss_ss: 1.057491, loss_d: 0.382770
0.9996 --- loss: 4.695519, loss_ss: 2.915759, loss_d: 1.779760
Epoch finished! Loss: 1.5715796177203838
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.546267, loss_ss: 1.174988, loss_d: 0.371278
0.0384 --- loss: 2.610544, loss_ss: 1.719195, loss_d: 0.891350
0.0769 --- loss: 1.527903, loss_ss: 1.154486, loss_d: 0.373417
0.1153 --- loss: 1.467602, loss_ss: 1.153092, loss_d: 0.314510
0.1538 --- loss: 2.248184, loss_ss: 1.166379, loss_d: 1.081805
0.1922 --- loss: 1.436689, loss_ss: 1.059935, loss_d: 0.376754
0.2307 --- loss: 1.394268, loss_ss: 0.866069, loss_d: 0.528200
0.2691 --- loss: 1.851690, loss_ss: 1.317231, loss_d: 0.534459
0.3076 --- loss: 1.432548, loss_ss: 1.080334, loss_d: 0.352213
0.3460 --- loss: 1.532529, loss_ss: 1.189220, loss_d: 0.343309
0.3845 --- loss: 1.473624, loss_ss: 1.160675, loss_d: 0.312949
0.4229 --- loss: 1.412397, loss_ss: 1.025215, loss_d: 0.387182
0.4614 --- loss: 1.450476, loss_ss: 1.167636, loss_d: 0.282840
0.4998 --- loss: 1.265652, loss_ss: 0.952366, loss_d: 0.313286
0.5383 --- loss: 1.782923, loss_ss: 0.970501, loss_d: 0.812422
0.5767 --- loss: 1.358419, loss_ss: 1.029975, loss_d: 0.328443
0.6151 --- loss: 1.704467, loss_ss: 1.127678, loss_d: 0.576789
0.6536 --- loss: 1.501016, loss_ss: 1.093579, loss_d: 0.407437
0.6920 --- loss: 1.310924, loss_ss: 0.802582, loss_d: 0.508342
0.7305 --- loss: 1.716185, loss_ss: 1.209867, loss_d: 0.506318
0.7689 --- loss: 1.291516, loss_ss: 0.891562, loss_d: 0.399954
0.8074 --- loss: 1.137878, loss_ss: 0.866680, loss_d: 0.271197
0.8458 --- loss: 1.419125, loss_ss: 1.051236, loss_d: 0.367889
0.8843 --- loss: 2.297245, loss_ss: 1.202167, loss_d: 1.095078
0.9227 --- loss: 1.273244, loss_ss: 0.913347, loss_d: 0.359898
0.9612 --- loss: 1.362661, loss_ss: 1.042354, loss_d: 0.320307
0.9996 --- loss: 1.284053, loss_ss: 1.194435, loss_d: 0.089618
Epoch finished! Loss: 1.528440802372419
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4063063063063063
             precision    recall  f1-score   support

        0.0       0.50      0.06      0.11        51
        1.0       0.00      0.00      0.00        48
        2.0       0.34      0.95      0.50       309
        3.0       0.67      0.68      0.68       229
        4.0       0.00      0.00      0.00       473

avg / total       0.26      0.41      0.28      1110
 


====== chp031-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  95.41   5.88   99.72  50.00     10.53
1  95.68   0.00  100.00   0.00      0.00
2  46.22  94.82   27.47  33.52     49.54
3  86.58  67.69   91.49  67.39     67.54
4  57.39   0.00  100.00   0.00      0.00
Total accuracy: 40.63%
Average sen: 33.68%
Average spec: 83.73%
Macro f1-score: 25.52%
[0.50038809 0.49735722 0.49904791 0.50128955 0.49699184 0.49981982
 0.49791747 0.49795076 0.50061727 0.50232285 0.50243622 0.49920768
 0.499603   0.50208813 0.50242507 0.5023883  0.50016135 0.49814409
 0.50019079 0.50025433 0.50173044 0.50178438 0.49981153 0.50111133
 0.49756348 0.49788114 0.49883565 0.49942178 0.49984443 0.50041866
 0.49855793 0.49799907 0.49908382 0.50138462 0.49919075 0.50055635
 0.49922279]
pred: 0.49986486177186706, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.519475, loss_ss: 1.891466, loss_d: 0.628008
0.0384 --- loss: 2.267724, loss_ss: 1.669131, loss_d: 0.598593
0.0768 --- loss: 2.305478, loss_ss: 1.821926, loss_d: 0.483552
0.1153 --- loss: 2.305137, loss_ss: 1.639594, loss_d: 0.665543
0.1537 --- loss: 2.105244, loss_ss: 1.636455, loss_d: 0.468789
0.1921 --- loss: 2.276909, loss_ss: 1.655679, loss_d: 0.621230
0.2305 --- loss: 2.167850, loss_ss: 1.752389, loss_d: 0.415460
0.2689 --- loss: 2.097708, loss_ss: 1.436465, loss_d: 0.661243
0.3073 --- loss: 1.916310, loss_ss: 1.400412, loss_d: 0.515898
0.3458 --- loss: 2.108986, loss_ss: 1.614982, loss_d: 0.494004
0.3842 --- loss: 2.176119, loss_ss: 1.523443, loss_d: 0.652676
0.4226 --- loss: 1.869354, loss_ss: 1.456221, loss_d: 0.413132
0.4610 --- loss: 2.116514, loss_ss: 1.532825, loss_d: 0.583689
0.4994 --- loss: 1.897642, loss_ss: 1.520592, loss_d: 0.377049
0.5378 --- loss: 1.934089, loss_ss: 1.545799, loss_d: 0.388290
0.5763 --- loss: 1.883349, loss_ss: 1.515152, loss_d: 0.368196
0.6147 --- loss: 2.115739, loss_ss: 1.570259, loss_d: 0.545480
0.6531 --- loss: 1.807305, loss_ss: 1.471991, loss_d: 0.335313
0.6915 --- loss: 2.128554, loss_ss: 1.696863, loss_d: 0.431691
0.7299 --- loss: 1.962821, loss_ss: 1.505266, loss_d: 0.457554
0.7683 --- loss: 1.742788, loss_ss: 1.363331, loss_d: 0.379456
0.8068 --- loss: 2.011762, loss_ss: 1.543862, loss_d: 0.467901
0.8452 --- loss: 2.067387, loss_ss: 1.516880, loss_d: 0.550507
0.8836 --- loss: 1.785289, loss_ss: 1.354450, loss_d: 0.430840
0.9220 --- loss: 2.192743, loss_ss: 1.499909, loss_d: 0.692835
0.9604 --- loss: 1.831116, loss_ss: 1.419130, loss_d: 0.411986
0.9988 --- loss: 2.172482, loss_ss: 1.644015, loss_d: 0.528467
Epoch finished! Loss: 2.1088791851813977
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.820835, loss_ss: 1.470954, loss_d: 0.349882
0.0384 --- loss: 1.823907, loss_ss: 1.530638, loss_d: 0.293269
0.0768 --- loss: 1.984190, loss_ss: 1.510378, loss_d: 0.473812
0.1153 --- loss: 2.140692, loss_ss: 1.468444, loss_d: 0.672247
0.1537 --- loss: 2.035844, loss_ss: 1.540447, loss_d: 0.495398
0.1921 --- loss: 2.236001, loss_ss: 1.575399, loss_d: 0.660602
0.2305 --- loss: 2.228409, loss_ss: 1.742356, loss_d: 0.486053
0.2689 --- loss: 1.985186, loss_ss: 1.527061, loss_d: 0.458125
0.3073 --- loss: 2.170907, loss_ss: 1.457765, loss_d: 0.713142
0.3458 --- loss: 1.929310, loss_ss: 1.548408, loss_d: 0.380902
0.3842 --- loss: 2.196669, loss_ss: 1.473843, loss_d: 0.722826
0.4226 --- loss: 2.279580, loss_ss: 1.551232, loss_d: 0.728348
0.4610 --- loss: 2.257992, loss_ss: 1.762329, loss_d: 0.495663
0.4994 --- loss: 2.326192, loss_ss: 1.677573, loss_d: 0.648619
0.5378 --- loss: 1.926451, loss_ss: 1.466051, loss_d: 0.460400
0.5763 --- loss: 1.692558, loss_ss: 1.315941, loss_d: 0.376617
0.6147 --- loss: 1.651537, loss_ss: 1.274613, loss_d: 0.376925
0.6531 --- loss: 2.018388, loss_ss: 1.225968, loss_d: 0.792419
0.6915 --- loss: 1.844340, loss_ss: 1.336896, loss_d: 0.507444
0.7299 --- loss: 1.942191, loss_ss: 1.360144, loss_d: 0.582046
0.7683 --- loss: 1.679361, loss_ss: 1.283676, loss_d: 0.395685
0.8068 --- loss: 2.051103, loss_ss: 1.399095, loss_d: 0.652008
0.8452 --- loss: 2.134063, loss_ss: 1.638415, loss_d: 0.495648
0.8836 --- loss: 1.872249, loss_ss: 1.340754, loss_d: 0.531496
0.9220 --- loss: 1.668382, loss_ss: 1.330471, loss_d: 0.337911
0.9604 --- loss: 1.844129, loss_ss: 1.417736, loss_d: 0.426393
0.9988 --- loss: 1.657830, loss_ss: 1.276351, loss_d: 0.381479
Epoch finished! Loss: 2.0212703901987807
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.928674, loss_ss: 1.483061, loss_d: 0.445613
0.0384 --- loss: 2.057610, loss_ss: 1.541005, loss_d: 0.516604
0.0768 --- loss: 1.975848, loss_ss: 1.629212, loss_d: 0.346636
0.1153 --- loss: 2.029832, loss_ss: 1.514106, loss_d: 0.515726
0.1537 --- loss: 1.979211, loss_ss: 1.595455, loss_d: 0.383756
0.1921 --- loss: 1.719791, loss_ss: 1.401510, loss_d: 0.318281
0.2305 --- loss: 1.796560, loss_ss: 1.401094, loss_d: 0.395465
0.2689 --- loss: 2.049910, loss_ss: 1.574808, loss_d: 0.475102
0.3073 --- loss: 1.827101, loss_ss: 1.456352, loss_d: 0.370749
0.3458 --- loss: 1.966738, loss_ss: 1.294666, loss_d: 0.672073
0.3842 --- loss: 1.947675, loss_ss: 1.309694, loss_d: 0.637981
0.4226 --- loss: 1.705703, loss_ss: 1.224172, loss_d: 0.481531
0.4610 --- loss: 1.809325, loss_ss: 1.410516, loss_d: 0.398809
0.4994 --- loss: 1.774753, loss_ss: 1.300824, loss_d: 0.473928
0.5378 --- loss: 1.907012, loss_ss: 1.350356, loss_d: 0.556656
0.5763 --- loss: 1.767247, loss_ss: 1.376248, loss_d: 0.390999
0.6147 --- loss: 1.774725, loss_ss: 1.416098, loss_d: 0.358627
0.6531 --- loss: 1.949208, loss_ss: 1.555645, loss_d: 0.393564
0.6915 --- loss: 2.075795, loss_ss: 1.747927, loss_d: 0.327869
0.7299 --- loss: 1.634815, loss_ss: 1.305086, loss_d: 0.329729
0.7683 --- loss: 2.095613, loss_ss: 1.654258, loss_d: 0.441356
0.8068 --- loss: 1.771825, loss_ss: 1.421389, loss_d: 0.350436
0.8452 --- loss: 1.826134, loss_ss: 1.421455, loss_d: 0.404679
0.8836 --- loss: 2.062253, loss_ss: 1.261530, loss_d: 0.800723
0.9220 --- loss: 2.103246, loss_ss: 1.571865, loss_d: 0.531382
0.9604 --- loss: 1.828521, loss_ss: 1.294798, loss_d: 0.533723
0.9988 --- loss: 1.774161, loss_ss: 1.405124, loss_d: 0.369037
Epoch finished! Loss: 1.9372643658748039
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.874422, loss_ss: 1.469617, loss_d: 0.404804
0.0384 --- loss: 2.055392, loss_ss: 1.507301, loss_d: 0.548091
0.0768 --- loss: 1.825189, loss_ss: 1.455322, loss_d: 0.369868
0.1153 --- loss: 2.093360, loss_ss: 1.263219, loss_d: 0.830141
0.1537 --- loss: 1.843544, loss_ss: 1.412966, loss_d: 0.430578
0.1921 --- loss: 1.834202, loss_ss: 1.403119, loss_d: 0.431083
0.2305 --- loss: 2.108043, loss_ss: 1.508935, loss_d: 0.599108
0.2689 --- loss: 1.810411, loss_ss: 1.269890, loss_d: 0.540521
0.3073 --- loss: 1.786669, loss_ss: 1.373291, loss_d: 0.413378
0.3458 --- loss: 1.917256, loss_ss: 1.425472, loss_d: 0.491784
0.3842 --- loss: 1.628043, loss_ss: 1.218618, loss_d: 0.409425
0.4226 --- loss: 1.625721, loss_ss: 1.315485, loss_d: 0.310236
0.4610 --- loss: 1.616364, loss_ss: 1.395517, loss_d: 0.220847
0.4994 --- loss: 2.542238, loss_ss: 1.246087, loss_d: 1.296151
0.5378 --- loss: 1.886573, loss_ss: 1.373612, loss_d: 0.512961
0.5763 --- loss: 2.131356, loss_ss: 1.401684, loss_d: 0.729672
0.6147 --- loss: 2.182357, loss_ss: 1.585960, loss_d: 0.596397
0.6531 --- loss: 1.651297, loss_ss: 1.269147, loss_d: 0.382150
0.6915 --- loss: 1.574037, loss_ss: 1.221713, loss_d: 0.352324
0.7299 --- loss: 2.051346, loss_ss: 1.528148, loss_d: 0.523198
0.7683 --- loss: 1.975761, loss_ss: 1.488721, loss_d: 0.487040
0.8068 --- loss: 1.972686, loss_ss: 1.439335, loss_d: 0.533351
0.8452 --- loss: 1.515141, loss_ss: 1.186506, loss_d: 0.328635
0.8836 --- loss: 1.833349, loss_ss: 1.405307, loss_d: 0.428042
0.9220 --- loss: 1.877368, loss_ss: 1.357237, loss_d: 0.520131
0.9604 --- loss: 1.893886, loss_ss: 1.472097, loss_d: 0.421789
0.9988 --- loss: 2.216820, loss_ss: 1.825978, loss_d: 0.390842
Epoch finished! Loss: 1.903416098998143
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.722790, loss_ss: 1.352345, loss_d: 0.370445
0.0384 --- loss: 1.673540, loss_ss: 1.270257, loss_d: 0.403283
0.0768 --- loss: 2.075233, loss_ss: 1.589567, loss_d: 0.485666
0.1153 --- loss: 1.639340, loss_ss: 1.310787, loss_d: 0.328553
0.1537 --- loss: 1.825101, loss_ss: 1.469505, loss_d: 0.355596
0.1921 --- loss: 1.928055, loss_ss: 1.333338, loss_d: 0.594716
0.2305 --- loss: 1.853153, loss_ss: 1.351480, loss_d: 0.501673
0.2689 --- loss: 1.701092, loss_ss: 1.162366, loss_d: 0.538725
0.3073 --- loss: 1.797228, loss_ss: 1.350916, loss_d: 0.446311
0.3458 --- loss: 1.511966, loss_ss: 1.128582, loss_d: 0.383384
0.3842 --- loss: 2.179380, loss_ss: 1.603721, loss_d: 0.575659
0.4226 --- loss: 1.749285, loss_ss: 1.329195, loss_d: 0.420090
0.4610 --- loss: 2.014888, loss_ss: 1.243085, loss_d: 0.771803
0.4994 --- loss: 1.760613, loss_ss: 1.440211, loss_d: 0.320401
0.5378 --- loss: 1.458768, loss_ss: 1.099436, loss_d: 0.359332
0.5763 --- loss: 1.461996, loss_ss: 1.106817, loss_d: 0.355179
0.6147 --- loss: 1.911235, loss_ss: 1.409466, loss_d: 0.501768
0.6531 --- loss: 1.839444, loss_ss: 1.390408, loss_d: 0.449036
0.6915 --- loss: 2.098440, loss_ss: 1.495289, loss_d: 0.603151
0.7299 --- loss: 2.219488, loss_ss: 1.289390, loss_d: 0.930098
0.7683 --- loss: 1.571493, loss_ss: 1.321743, loss_d: 0.249750
0.8068 --- loss: 1.680884, loss_ss: 1.210424, loss_d: 0.470459
0.8452 --- loss: 1.981513, loss_ss: 1.532560, loss_d: 0.448953
0.8836 --- loss: 1.841143, loss_ss: 1.254347, loss_d: 0.586797
0.9220 --- loss: 1.662484, loss_ss: 1.219879, loss_d: 0.442605
0.9604 --- loss: 1.851776, loss_ss: 1.575580, loss_d: 0.276196
0.9988 --- loss: 2.328468, loss_ss: 2.048023, loss_d: 0.280444
Epoch finished! Loss: 1.851343153990232
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 2.241322, loss_ss: 1.505209, loss_d: 0.736113
0.0384 --- loss: 1.603650, loss_ss: 1.252346, loss_d: 0.351304
0.0768 --- loss: 1.733490, loss_ss: 1.285377, loss_d: 0.448112
0.1153 --- loss: 1.842470, loss_ss: 1.260724, loss_d: 0.581747
0.1537 --- loss: 1.867326, loss_ss: 1.498974, loss_d: 0.368352
0.1921 --- loss: 1.599898, loss_ss: 1.284310, loss_d: 0.315589
0.2305 --- loss: 1.847522, loss_ss: 1.312644, loss_d: 0.534878
0.2689 --- loss: 1.827593, loss_ss: 1.355974, loss_d: 0.471619
0.3073 --- loss: 1.662812, loss_ss: 1.240667, loss_d: 0.422145
0.3458 --- loss: 1.874294, loss_ss: 1.325628, loss_d: 0.548666
0.3842 --- loss: 1.921405, loss_ss: 1.319010, loss_d: 0.602395
0.4226 --- loss: 1.768789, loss_ss: 1.348350, loss_d: 0.420439
0.4610 --- loss: 1.848923, loss_ss: 1.299417, loss_d: 0.549507
0.4994 --- loss: 1.825006, loss_ss: 1.431640, loss_d: 0.393366
0.5378 --- loss: 1.655671, loss_ss: 1.265644, loss_d: 0.390027
0.5763 --- loss: 2.205766, loss_ss: 1.594859, loss_d: 0.610907
0.6147 --- loss: 1.668986, loss_ss: 1.320928, loss_d: 0.348058
0.6531 --- loss: 1.586977, loss_ss: 1.186437, loss_d: 0.400540
0.6915 --- loss: 1.824023, loss_ss: 1.429902, loss_d: 0.394121
0.7299 --- loss: 1.834615, loss_ss: 1.365359, loss_d: 0.469256
0.7683 --- loss: 2.216931, loss_ss: 1.531217, loss_d: 0.685714
0.8068 --- loss: 1.723516, loss_ss: 1.253507, loss_d: 0.470009
0.8452 --- loss: 1.794909, loss_ss: 1.253183, loss_d: 0.541726
0.8836 --- loss: 1.888435, loss_ss: 1.447229, loss_d: 0.441207
0.9220 --- loss: 1.515231, loss_ss: 1.206889, loss_d: 0.308342
0.9604 --- loss: 1.704986, loss_ss: 1.345142, loss_d: 0.359844
0.9988 --- loss: 3.544783, loss_ss: 1.526283, loss_d: 2.018500
Epoch finished! Loss: 1.8001899155286643
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.003300, loss_ss: 1.656144, loss_d: 0.347156
0.0384 --- loss: 1.694620, loss_ss: 1.176895, loss_d: 0.517724
0.0768 --- loss: 1.493738, loss_ss: 1.147692, loss_d: 0.346046
0.1153 --- loss: 1.638135, loss_ss: 1.235777, loss_d: 0.402358
0.1537 --- loss: 1.737451, loss_ss: 1.375509, loss_d: 0.361942
0.1921 --- loss: 1.473252, loss_ss: 1.162395, loss_d: 0.310857
0.2305 --- loss: 1.728090, loss_ss: 1.282494, loss_d: 0.445596
0.2689 --- loss: 1.747078, loss_ss: 1.389812, loss_d: 0.357267
0.3073 --- loss: 1.523105, loss_ss: 1.049208, loss_d: 0.473897
0.3458 --- loss: 1.656292, loss_ss: 1.285182, loss_d: 0.371110
0.3842 --- loss: 1.605302, loss_ss: 1.114396, loss_d: 0.490906
0.4226 --- loss: 2.294173, loss_ss: 1.449079, loss_d: 0.845094
0.4610 --- loss: 1.629655, loss_ss: 1.198682, loss_d: 0.430973
0.4994 --- loss: 1.737648, loss_ss: 1.330042, loss_d: 0.407605
0.5378 --- loss: 1.575388, loss_ss: 1.256928, loss_d: 0.318460
0.5763 --- loss: 1.775842, loss_ss: 1.436056, loss_d: 0.339786
0.6147 --- loss: 1.774641, loss_ss: 1.419529, loss_d: 0.355111
0.6531 --- loss: 1.788983, loss_ss: 1.173578, loss_d: 0.615405
0.6915 --- loss: 1.637592, loss_ss: 1.220249, loss_d: 0.417343
0.7299 --- loss: 1.484622, loss_ss: 1.151809, loss_d: 0.332813
0.7683 --- loss: 1.511294, loss_ss: 1.072403, loss_d: 0.438892
0.8068 --- loss: 1.557422, loss_ss: 1.058929, loss_d: 0.498493
0.8452 --- loss: 1.584223, loss_ss: 0.922881, loss_d: 0.661342
0.8836 --- loss: 1.864128, loss_ss: 1.372055, loss_d: 0.492073
0.9220 --- loss: 1.438815, loss_ss: 1.137376, loss_d: 0.301439
0.9604 --- loss: 1.452447, loss_ss: 1.092952, loss_d: 0.359495
0.9988 --- loss: 1.423632, loss_ss: 1.137693, loss_d: 0.285939
Epoch finished! Loss: 1.7333938772861774
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.652108, loss_ss: 1.271089, loss_d: 0.381020
0.0384 --- loss: 1.871951, loss_ss: 1.221061, loss_d: 0.650891
0.0768 --- loss: 1.731323, loss_ss: 1.387872, loss_d: 0.343451
0.1153 --- loss: 1.718740, loss_ss: 1.486332, loss_d: 0.232408
0.1537 --- loss: 1.642146, loss_ss: 1.293859, loss_d: 0.348287
0.1921 --- loss: 1.704196, loss_ss: 1.242539, loss_d: 0.461658
0.2305 --- loss: 1.504352, loss_ss: 1.171155, loss_d: 0.333197
0.2689 --- loss: 1.408739, loss_ss: 1.077443, loss_d: 0.331296
0.3073 --- loss: 1.342714, loss_ss: 1.114337, loss_d: 0.228377
0.3458 --- loss: 2.511187, loss_ss: 1.341108, loss_d: 1.170079
0.3842 --- loss: 1.433475, loss_ss: 1.147707, loss_d: 0.285767
0.4226 --- loss: 1.527723, loss_ss: 1.086190, loss_d: 0.441534
0.4610 --- loss: 1.656005, loss_ss: 1.314760, loss_d: 0.341245
0.4994 --- loss: 1.464066, loss_ss: 1.139766, loss_d: 0.324300
0.5378 --- loss: 1.605354, loss_ss: 1.176496, loss_d: 0.428858
0.5763 --- loss: 1.845875, loss_ss: 1.215945, loss_d: 0.629929
0.6147 --- loss: 1.771904, loss_ss: 1.374658, loss_d: 0.397246
0.6531 --- loss: 1.379948, loss_ss: 1.035363, loss_d: 0.344586
0.6915 --- loss: 1.478914, loss_ss: 1.022977, loss_d: 0.455938
0.7299 --- loss: 1.552645, loss_ss: 1.135301, loss_d: 0.417344
0.7683 --- loss: 1.567941, loss_ss: 1.121722, loss_d: 0.446219
0.8068 --- loss: 1.341771, loss_ss: 0.964740, loss_d: 0.377031
0.8452 --- loss: 1.575819, loss_ss: 1.235097, loss_d: 0.340722
0.8836 --- loss: 1.480469, loss_ss: 1.197796, loss_d: 0.282673
0.9220 --- loss: 1.601920, loss_ss: 1.070278, loss_d: 0.531643
0.9604 --- loss: 1.723210, loss_ss: 1.232237, loss_d: 0.490972
0.9988 --- loss: 1.540731, loss_ss: 1.240070, loss_d: 0.300661
Epoch finished! Loss: 1.6768643425061152
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.421931, loss_ss: 1.120938, loss_d: 0.300993
0.0384 --- loss: 2.027664, loss_ss: 1.527370, loss_d: 0.500294
0.0768 --- loss: 1.383097, loss_ss: 1.124778, loss_d: 0.258319
0.1153 --- loss: 2.352993, loss_ss: 1.147413, loss_d: 1.205579
0.1537 --- loss: 1.805174, loss_ss: 1.274025, loss_d: 0.531148
0.1921 --- loss: 1.616186, loss_ss: 1.134493, loss_d: 0.481693
0.2305 --- loss: 1.568863, loss_ss: 1.203743, loss_d: 0.365119
0.2689 --- loss: 1.538711, loss_ss: 1.189509, loss_d: 0.349202
0.3073 --- loss: 1.271244, loss_ss: 1.027556, loss_d: 0.243688
0.3458 --- loss: 1.799402, loss_ss: 1.295912, loss_d: 0.503491
0.3842 --- loss: 2.079444, loss_ss: 1.369924, loss_d: 0.709521
0.4226 --- loss: 1.376792, loss_ss: 1.033478, loss_d: 0.343314
0.4610 --- loss: 1.958614, loss_ss: 1.440397, loss_d: 0.518217
0.4994 --- loss: 1.343764, loss_ss: 0.946805, loss_d: 0.396959
0.5378 --- loss: 1.299402, loss_ss: 1.015128, loss_d: 0.284274
0.5763 --- loss: 1.745454, loss_ss: 1.097100, loss_d: 0.648353
0.6147 --- loss: 1.462605, loss_ss: 1.180175, loss_d: 0.282429
0.6531 --- loss: 1.860684, loss_ss: 1.346407, loss_d: 0.514277
0.6915 --- loss: 1.442816, loss_ss: 1.105600, loss_d: 0.337216
0.7299 --- loss: 1.595583, loss_ss: 1.056278, loss_d: 0.539305
0.7683 --- loss: 1.562802, loss_ss: 1.037383, loss_d: 0.525419
0.8068 --- loss: 1.541750, loss_ss: 1.021479, loss_d: 0.520272
0.8452 --- loss: 1.530670, loss_ss: 1.232243, loss_d: 0.298427
0.8836 --- loss: 1.342387, loss_ss: 1.027305, loss_d: 0.315082
0.9220 --- loss: 1.670835, loss_ss: 1.127100, loss_d: 0.543735
0.9604 --- loss: 1.283730, loss_ss: 0.937479, loss_d: 0.346250
0.9988 --- loss: 1.935064, loss_ss: 1.299033, loss_d: 0.636031
Epoch finished! Loss: 1.6001337088071383
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.734732, loss_ss: 1.091535, loss_d: 0.643197
0.0384 --- loss: 1.635231, loss_ss: 1.344911, loss_d: 0.290320
0.0768 --- loss: 1.599992, loss_ss: 1.240947, loss_d: 0.359044
0.1153 --- loss: 1.585609, loss_ss: 1.147997, loss_d: 0.437613
0.1537 --- loss: 2.181865, loss_ss: 1.086007, loss_d: 1.095857
0.1921 --- loss: 1.366106, loss_ss: 1.075499, loss_d: 0.290607
0.2305 --- loss: 1.497998, loss_ss: 0.978977, loss_d: 0.519022
0.2689 --- loss: 1.333376, loss_ss: 0.937599, loss_d: 0.395777
0.3073 --- loss: 1.781008, loss_ss: 1.380943, loss_d: 0.400065
0.3458 --- loss: 1.486669, loss_ss: 1.229512, loss_d: 0.257157
0.3842 --- loss: 1.511449, loss_ss: 1.127450, loss_d: 0.383999
0.4226 --- loss: 2.045406, loss_ss: 1.240418, loss_d: 0.804988
0.4610 --- loss: 1.108453, loss_ss: 0.834626, loss_d: 0.273827
0.4994 --- loss: 1.734656, loss_ss: 0.996800, loss_d: 0.737855
0.5378 --- loss: 1.813320, loss_ss: 1.472369, loss_d: 0.340951
0.5763 --- loss: 1.520885, loss_ss: 0.911070, loss_d: 0.609816
0.6147 --- loss: 1.826491, loss_ss: 1.270955, loss_d: 0.555536
0.6531 --- loss: 1.596219, loss_ss: 1.144178, loss_d: 0.452041
0.6915 --- loss: 1.664897, loss_ss: 1.332293, loss_d: 0.332604
0.7299 --- loss: 1.449126, loss_ss: 1.004466, loss_d: 0.444660
0.7683 --- loss: 1.317798, loss_ss: 0.933139, loss_d: 0.384659
0.8068 --- loss: 1.525773, loss_ss: 0.863790, loss_d: 0.661983
0.8452 --- loss: 1.464025, loss_ss: 1.194682, loss_d: 0.269343
0.8836 --- loss: 1.560935, loss_ss: 1.055881, loss_d: 0.505054
0.9220 --- loss: 2.482107, loss_ss: 1.555431, loss_d: 0.926675
0.9604 --- loss: 1.759291, loss_ss: 1.375820, loss_d: 0.383471
0.9988 --- loss: 0.849100, loss_ss: 0.691913, loss_d: 0.157186
Epoch finished! Loss: 1.567353653907776
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.1419047619047619
             precision    recall  f1-score   support

        0.0       0.05      1.00      0.09        47
        1.0       0.00      0.00      0.00       108
        2.0       0.00      0.00      0.00       516
        3.0       1.00      0.68      0.81       150
        4.0       0.00      0.00      0.00       229

avg / total       0.15      0.14      0.12      1050
 


====== chp032-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  14.19  100.0   10.17    4.96      9.45
1  89.71    0.0  100.00    0.00      0.00
2  50.86    0.0  100.00    0.00      0.00
3  95.43   68.0  100.00  100.00     80.95
4  78.19    0.0  100.00    0.00      0.00
Total accuracy: 14.19%
Average sen: 33.60%
Average spec: 82.03%
Macro f1-score: 18.08%
[0.52928841 0.32587487 0.4599717  0.14012057 0.44524264 0.38222158
 0.46343157 0.49240121 0.46148649 0.5090394  0.48002568 0.33157793
 0.0995112  0.02509058 0.16545093 0.24986894 0.46741045 0.46772841
 0.57961708 0.48696405 0.51248121 0.497973   0.32371512 0.51625115
 0.36636215 0.10078078 0.0514429  0.46952611 0.58768857 0.54363221
 0.80364591 0.51328176 0.55051529 0.49542069 0.47964251]
pred: 0.41070522979966234, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.347862, loss_ss: 1.700237, loss_d: 0.647624
0.0384 --- loss: 2.542291, loss_ss: 1.610320, loss_d: 0.931971
0.0768 --- loss: 2.169138, loss_ss: 1.605232, loss_d: 0.563907
0.1152 --- loss: 2.189694, loss_ss: 1.561283, loss_d: 0.628410
0.1536 --- loss: 1.780266, loss_ss: 1.519024, loss_d: 0.261241
0.1919 --- loss: 2.210474, loss_ss: 1.705868, loss_d: 0.504606
0.2303 --- loss: 1.988252, loss_ss: 1.574024, loss_d: 0.414227
0.2687 --- loss: 1.783530, loss_ss: 1.383224, loss_d: 0.400306
0.3071 --- loss: 2.140109, loss_ss: 1.594537, loss_d: 0.545572
0.3455 --- loss: 2.391190, loss_ss: 1.480405, loss_d: 0.910785
0.3839 --- loss: 2.054167, loss_ss: 1.447182, loss_d: 0.606985
0.4223 --- loss: 1.818595, loss_ss: 1.483012, loss_d: 0.335584
0.4607 --- loss: 2.327539, loss_ss: 1.650910, loss_d: 0.676630
0.4990 --- loss: 2.154765, loss_ss: 1.587755, loss_d: 0.567010
0.5374 --- loss: 2.183838, loss_ss: 1.511657, loss_d: 0.672181
0.5758 --- loss: 2.067616, loss_ss: 1.618936, loss_d: 0.448680
0.6142 --- loss: 2.346166, loss_ss: 1.520769, loss_d: 0.825397
0.6526 --- loss: 1.868308, loss_ss: 1.421365, loss_d: 0.446942
0.6910 --- loss: 2.239954, loss_ss: 1.413514, loss_d: 0.826440
0.7294 --- loss: 1.931074, loss_ss: 1.411352, loss_d: 0.519722
0.7678 --- loss: 2.087559, loss_ss: 1.524637, loss_d: 0.562921
0.8061 --- loss: 1.957067, loss_ss: 1.456682, loss_d: 0.500385
0.8445 --- loss: 2.351078, loss_ss: 1.496411, loss_d: 0.854667
0.8829 --- loss: 1.750232, loss_ss: 1.378151, loss_d: 0.372080
0.9213 --- loss: 1.937674, loss_ss: 1.528641, loss_d: 0.409034
0.9597 --- loss: 2.003132, loss_ss: 1.634482, loss_d: 0.368651
0.9981 --- loss: 2.168589, loss_ss: 1.763781, loss_d: 0.404808
Epoch finished! Loss: 2.0940667413748226
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.167057, loss_ss: 1.691646, loss_d: 0.475411
0.0384 --- loss: 1.941225, loss_ss: 1.577096, loss_d: 0.364129
0.0768 --- loss: 1.772259, loss_ss: 1.478969, loss_d: 0.293290
0.1152 --- loss: 2.041943, loss_ss: 1.503175, loss_d: 0.538768
0.1536 --- loss: 2.168149, loss_ss: 1.454667, loss_d: 0.713482
0.1919 --- loss: 1.754651, loss_ss: 1.371622, loss_d: 0.383029
0.2303 --- loss: 2.057778, loss_ss: 1.250301, loss_d: 0.807477
0.2687 --- loss: 2.265957, loss_ss: 1.374809, loss_d: 0.891148
0.3071 --- loss: 1.882589, loss_ss: 1.456362, loss_d: 0.426228
0.3455 --- loss: 2.357763, loss_ss: 1.586862, loss_d: 0.770901
0.3839 --- loss: 2.010631, loss_ss: 1.450648, loss_d: 0.559983
0.4223 --- loss: 2.360521, loss_ss: 1.539306, loss_d: 0.821215
0.4607 --- loss: 2.252847, loss_ss: 1.542743, loss_d: 0.710104
0.4990 --- loss: 2.171311, loss_ss: 1.517226, loss_d: 0.654086
0.5374 --- loss: 1.941580, loss_ss: 1.428456, loss_d: 0.513124
0.5758 --- loss: 1.905529, loss_ss: 1.476147, loss_d: 0.429382
0.6142 --- loss: 2.041053, loss_ss: 1.606982, loss_d: 0.434071
0.6526 --- loss: 1.839224, loss_ss: 1.530552, loss_d: 0.308672
0.6910 --- loss: 2.010453, loss_ss: 1.504106, loss_d: 0.506348
0.7294 --- loss: 2.146319, loss_ss: 1.663909, loss_d: 0.482410
0.7678 --- loss: 2.187824, loss_ss: 1.605539, loss_d: 0.582285
0.8061 --- loss: 1.832058, loss_ss: 1.366397, loss_d: 0.465661
0.8445 --- loss: 1.779831, loss_ss: 1.401216, loss_d: 0.378615
0.8829 --- loss: 2.226828, loss_ss: 1.510876, loss_d: 0.715952
0.9213 --- loss: 1.861076, loss_ss: 1.273649, loss_d: 0.587428
0.9597 --- loss: 1.946416, loss_ss: 1.391707, loss_d: 0.554709
0.9981 --- loss: 1.797333, loss_ss: 1.514521, loss_d: 0.282813
Epoch finished! Loss: 2.0261048541619227
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.939113, loss_ss: 1.497552, loss_d: 0.441562
0.0384 --- loss: 1.959028, loss_ss: 1.543466, loss_d: 0.415562
0.0768 --- loss: 1.998222, loss_ss: 1.531932, loss_d: 0.466290
0.1152 --- loss: 2.039885, loss_ss: 1.528684, loss_d: 0.511201
0.1536 --- loss: 1.904182, loss_ss: 1.483165, loss_d: 0.421017
0.1919 --- loss: 1.873684, loss_ss: 1.447170, loss_d: 0.426514
0.2303 --- loss: 2.031046, loss_ss: 1.556361, loss_d: 0.474685
0.2687 --- loss: 1.800365, loss_ss: 1.248993, loss_d: 0.551373
0.3071 --- loss: 2.304101, loss_ss: 1.753608, loss_d: 0.550494
0.3455 --- loss: 1.884875, loss_ss: 1.473625, loss_d: 0.411250
0.3839 --- loss: 1.904287, loss_ss: 1.397288, loss_d: 0.506998
0.4223 --- loss: 2.134237, loss_ss: 1.444858, loss_d: 0.689379
0.4607 --- loss: 2.027558, loss_ss: 1.313499, loss_d: 0.714059
0.4990 --- loss: 2.552478, loss_ss: 1.547708, loss_d: 1.004770
0.5374 --- loss: 2.025944, loss_ss: 1.407164, loss_d: 0.618780
0.5758 --- loss: 2.011343, loss_ss: 1.560534, loss_d: 0.450808
0.6142 --- loss: 1.917379, loss_ss: 1.393464, loss_d: 0.523915
0.6526 --- loss: 1.945745, loss_ss: 1.466535, loss_d: 0.479210
0.6910 --- loss: 2.119378, loss_ss: 1.560551, loss_d: 0.558827
0.7294 --- loss: 2.011081, loss_ss: 1.278103, loss_d: 0.732979
0.7678 --- loss: 1.992257, loss_ss: 1.588824, loss_d: 0.403432
0.8061 --- loss: 2.216486, loss_ss: 1.253783, loss_d: 0.962704
0.8445 --- loss: 2.130897, loss_ss: 1.352688, loss_d: 0.778209
0.8829 --- loss: 2.525220, loss_ss: 1.860627, loss_d: 0.664594
0.9213 --- loss: 1.682063, loss_ss: 1.156707, loss_d: 0.525356
0.9597 --- loss: 1.928771, loss_ss: 1.531157, loss_d: 0.397614
0.9981 --- loss: 1.853285, loss_ss: 1.228431, loss_d: 0.624854
Epoch finished! Loss: 1.989908836896603
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.107665, loss_ss: 1.306121, loss_d: 0.801544
0.0384 --- loss: 2.216386, loss_ss: 1.665976, loss_d: 0.550411
0.0768 --- loss: 1.659528, loss_ss: 1.120336, loss_d: 0.539192
0.1152 --- loss: 1.715840, loss_ss: 1.320065, loss_d: 0.395776
0.1536 --- loss: 1.950572, loss_ss: 1.365698, loss_d: 0.584874
0.1919 --- loss: 2.200235, loss_ss: 1.370737, loss_d: 0.829498
0.2303 --- loss: 1.768778, loss_ss: 1.195562, loss_d: 0.573216
0.2687 --- loss: 1.813640, loss_ss: 1.383526, loss_d: 0.430114
0.3071 --- loss: 1.584845, loss_ss: 1.230413, loss_d: 0.354432
0.3455 --- loss: 1.827563, loss_ss: 1.385008, loss_d: 0.442554
0.3839 --- loss: 1.962726, loss_ss: 1.427784, loss_d: 0.534942
0.4223 --- loss: 1.791981, loss_ss: 1.308219, loss_d: 0.483761
0.4607 --- loss: 1.898762, loss_ss: 1.433839, loss_d: 0.464923
0.4990 --- loss: 1.705042, loss_ss: 1.295296, loss_d: 0.409745
0.5374 --- loss: 1.783166, loss_ss: 1.349443, loss_d: 0.433723
0.5758 --- loss: 2.142405, loss_ss: 1.229375, loss_d: 0.913030
0.6142 --- loss: 1.902709, loss_ss: 1.491862, loss_d: 0.410847
0.6526 --- loss: 1.645068, loss_ss: 1.084864, loss_d: 0.560204
0.6910 --- loss: 1.713846, loss_ss: 1.333154, loss_d: 0.380692
0.7294 --- loss: 1.657353, loss_ss: 1.342146, loss_d: 0.315207
0.7678 --- loss: 1.983532, loss_ss: 1.448938, loss_d: 0.534593
0.8061 --- loss: 1.650263, loss_ss: 1.112952, loss_d: 0.537311
0.8445 --- loss: 1.919750, loss_ss: 1.490705, loss_d: 0.429045
0.8829 --- loss: 1.875291, loss_ss: 1.236814, loss_d: 0.638477
0.9213 --- loss: 1.864346, loss_ss: 1.351674, loss_d: 0.512672
0.9597 --- loss: 1.863877, loss_ss: 1.111659, loss_d: 0.752218
0.9981 --- loss: 1.776912, loss_ss: 1.293479, loss_d: 0.483433
Epoch finished! Loss: 1.873178545328287
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.920094, loss_ss: 1.362764, loss_d: 0.557330
0.0384 --- loss: 1.623013, loss_ss: 1.114519, loss_d: 0.508494
0.0768 --- loss: 1.881738, loss_ss: 1.498165, loss_d: 0.383573
0.1152 --- loss: 1.995115, loss_ss: 1.232960, loss_d: 0.762155
0.1536 --- loss: 2.104395, loss_ss: 1.377168, loss_d: 0.727228
0.1919 --- loss: 1.607902, loss_ss: 1.198057, loss_d: 0.409845
0.2303 --- loss: 1.963615, loss_ss: 1.393259, loss_d: 0.570357
0.2687 --- loss: 1.826475, loss_ss: 1.369161, loss_d: 0.457314
0.3071 --- loss: 1.785027, loss_ss: 1.257170, loss_d: 0.527857
0.3455 --- loss: 1.674214, loss_ss: 1.256630, loss_d: 0.417584
0.3839 --- loss: 1.472298, loss_ss: 1.028257, loss_d: 0.444041
0.4223 --- loss: 1.769899, loss_ss: 1.234334, loss_d: 0.535565
0.4607 --- loss: 1.599330, loss_ss: 1.256223, loss_d: 0.343108
0.4990 --- loss: 2.369987, loss_ss: 1.070651, loss_d: 1.299336
0.5374 --- loss: 1.956234, loss_ss: 1.316346, loss_d: 0.639887
0.5758 --- loss: 1.863246, loss_ss: 1.371331, loss_d: 0.491914
0.6142 --- loss: 1.667194, loss_ss: 1.300641, loss_d: 0.366552
0.6526 --- loss: 1.502446, loss_ss: 1.181927, loss_d: 0.320519
0.6910 --- loss: 1.773108, loss_ss: 1.354590, loss_d: 0.418517
0.7294 --- loss: 1.523768, loss_ss: 1.006342, loss_d: 0.517426
0.7678 --- loss: 2.484210, loss_ss: 1.445586, loss_d: 1.038625
0.8061 --- loss: 1.443931, loss_ss: 0.936898, loss_d: 0.507034
0.8445 --- loss: 1.581677, loss_ss: 1.089211, loss_d: 0.492466
0.8829 --- loss: 1.993592, loss_ss: 1.431786, loss_d: 0.561806
0.9213 --- loss: 1.598423, loss_ss: 1.263943, loss_d: 0.334479
0.9597 --- loss: 1.676618, loss_ss: 1.067200, loss_d: 0.609418
0.9981 --- loss: 1.613466, loss_ss: 1.278618, loss_d: 0.334848
Epoch finished! Loss: 1.7411064198383919
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.959274, loss_ss: 1.081205, loss_d: 0.878069
0.0384 --- loss: 1.730068, loss_ss: 1.241104, loss_d: 0.488965
0.0768 --- loss: 1.708335, loss_ss: 1.324664, loss_d: 0.383672
0.1152 --- loss: 1.543244, loss_ss: 1.148864, loss_d: 0.394380
0.1536 --- loss: 1.978312, loss_ss: 1.201771, loss_d: 0.776541
0.1919 --- loss: 1.690192, loss_ss: 1.206804, loss_d: 0.483388
0.2303 --- loss: 1.483481, loss_ss: 0.871205, loss_d: 0.612276
0.2687 --- loss: 1.217475, loss_ss: 0.980167, loss_d: 0.237308
0.3071 --- loss: 1.411155, loss_ss: 1.043564, loss_d: 0.367591
0.3455 --- loss: 1.380833, loss_ss: 1.072449, loss_d: 0.308385
0.3839 --- loss: 2.399444, loss_ss: 1.055038, loss_d: 1.344406
0.4223 --- loss: 1.721179, loss_ss: 1.079620, loss_d: 0.641559
0.4607 --- loss: 1.819565, loss_ss: 1.284486, loss_d: 0.535079
0.4990 --- loss: 2.072743, loss_ss: 1.336120, loss_d: 0.736624
0.5374 --- loss: 1.535163, loss_ss: 1.121262, loss_d: 0.413901
0.5758 --- loss: 1.324291, loss_ss: 0.954936, loss_d: 0.369355
0.6142 --- loss: 1.844082, loss_ss: 1.472206, loss_d: 0.371876
0.6526 --- loss: 1.617483, loss_ss: 1.335455, loss_d: 0.282028
0.6910 --- loss: 1.597718, loss_ss: 1.284158, loss_d: 0.313560
0.7294 --- loss: 1.757308, loss_ss: 1.294747, loss_d: 0.462562
0.7678 --- loss: 1.622370, loss_ss: 0.878976, loss_d: 0.743394
0.8061 --- loss: 2.097039, loss_ss: 1.644625, loss_d: 0.452415
0.8445 --- loss: 1.728645, loss_ss: 1.122008, loss_d: 0.606637
0.8829 --- loss: 1.709158, loss_ss: 1.371616, loss_d: 0.337542
0.9213 --- loss: 1.629511, loss_ss: 1.306015, loss_d: 0.323496
0.9597 --- loss: 1.691483, loss_ss: 1.382270, loss_d: 0.309213
0.9981 --- loss: 1.536771, loss_ss: 0.954329, loss_d: 0.582442
Epoch finished! Loss: 1.6711447477340697
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.448974, loss_ss: 0.909133, loss_d: 0.539841
0.0384 --- loss: 1.618603, loss_ss: 1.098749, loss_d: 0.519855
0.0768 --- loss: 2.026634, loss_ss: 1.322411, loss_d: 0.704223
0.1152 --- loss: 1.673742, loss_ss: 1.314793, loss_d: 0.358948
0.1536 --- loss: 1.510615, loss_ss: 1.078711, loss_d: 0.431904
0.1919 --- loss: 1.772587, loss_ss: 1.225616, loss_d: 0.546971
0.2303 --- loss: 1.320817, loss_ss: 0.914699, loss_d: 0.406118
0.2687 --- loss: 2.196917, loss_ss: 1.400323, loss_d: 0.796594
0.3071 --- loss: 1.866736, loss_ss: 1.375923, loss_d: 0.490813
0.3455 --- loss: 1.471317, loss_ss: 0.919223, loss_d: 0.552094
0.3839 --- loss: 1.691227, loss_ss: 1.242213, loss_d: 0.449014
0.4223 --- loss: 1.449702, loss_ss: 1.008947, loss_d: 0.440755
0.4607 --- loss: 1.600799, loss_ss: 1.048550, loss_d: 0.552249
0.4990 --- loss: 1.783618, loss_ss: 1.037344, loss_d: 0.746274
0.5374 --- loss: 1.479620, loss_ss: 1.045629, loss_d: 0.433991
0.5758 --- loss: 1.906642, loss_ss: 1.498040, loss_d: 0.408602
0.6142 --- loss: 1.433637, loss_ss: 1.065595, loss_d: 0.368042
0.6526 --- loss: 1.555578, loss_ss: 0.944395, loss_d: 0.611183
0.6910 --- loss: 1.675209, loss_ss: 1.219139, loss_d: 0.456069
0.7294 --- loss: 1.765535, loss_ss: 1.375898, loss_d: 0.389637
0.7678 --- loss: 1.554583, loss_ss: 1.126904, loss_d: 0.427679
0.8061 --- loss: 1.316065, loss_ss: 0.880972, loss_d: 0.435093
0.8445 --- loss: 1.362446, loss_ss: 1.035505, loss_d: 0.326940
0.8829 --- loss: 1.839477, loss_ss: 1.100449, loss_d: 0.739027
0.9213 --- loss: 1.536797, loss_ss: 1.209005, loss_d: 0.327792
0.9597 --- loss: 1.975486, loss_ss: 1.465131, loss_d: 0.510355
0.9981 --- loss: 2.590023, loss_ss: 1.040980, loss_d: 1.549043
Epoch finished! Loss: 1.6015570227916425
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.757194, loss_ss: 1.325930, loss_d: 0.431265
0.0384 --- loss: 1.947645, loss_ss: 1.173431, loss_d: 0.774213
0.0768 --- loss: 1.565529, loss_ss: 1.111793, loss_d: 0.453737
0.1152 --- loss: 1.590853, loss_ss: 1.178697, loss_d: 0.412156
0.1536 --- loss: 1.785478, loss_ss: 1.314277, loss_d: 0.471201
0.1919 --- loss: 1.474202, loss_ss: 0.985403, loss_d: 0.488799
0.2303 --- loss: 1.518244, loss_ss: 1.134180, loss_d: 0.384064
0.2687 --- loss: 1.720132, loss_ss: 1.139472, loss_d: 0.580660
0.3071 --- loss: 1.377521, loss_ss: 1.004343, loss_d: 0.373178
0.3455 --- loss: 1.572551, loss_ss: 0.929009, loss_d: 0.643542
0.3839 --- loss: 1.573080, loss_ss: 1.243262, loss_d: 0.329818
0.4223 --- loss: 1.543090, loss_ss: 1.210364, loss_d: 0.332726
0.4607 --- loss: 1.382418, loss_ss: 0.902371, loss_d: 0.480046
0.4990 --- loss: 1.357067, loss_ss: 1.090368, loss_d: 0.266699
0.5374 --- loss: 1.882337, loss_ss: 1.535274, loss_d: 0.347063
0.5758 --- loss: 1.711299, loss_ss: 1.198827, loss_d: 0.512471
0.6142 --- loss: 1.926647, loss_ss: 1.197794, loss_d: 0.728853
0.6526 --- loss: 1.575220, loss_ss: 1.154862, loss_d: 0.420358
0.6910 --- loss: 1.310706, loss_ss: 0.995201, loss_d: 0.315505
0.7294 --- loss: 1.673626, loss_ss: 1.049567, loss_d: 0.624058
0.7678 --- loss: 1.290502, loss_ss: 1.019301, loss_d: 0.271201
0.8061 --- loss: 1.554646, loss_ss: 1.029976, loss_d: 0.524671
0.8445 --- loss: 1.616632, loss_ss: 1.067815, loss_d: 0.548817
0.8829 --- loss: 1.867239, loss_ss: 1.052009, loss_d: 0.815230
0.9213 --- loss: 1.759809, loss_ss: 1.235881, loss_d: 0.523928
0.9597 --- loss: 1.321166, loss_ss: 1.042562, loss_d: 0.278604
0.9981 --- loss: 1.375861, loss_ss: 1.062590, loss_d: 0.313271
Epoch finished! Loss: 1.5614579760111296
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.891972, loss_ss: 1.325899, loss_d: 0.566074
0.0384 --- loss: 1.540265, loss_ss: 1.007953, loss_d: 0.532312
0.0768 --- loss: 2.106073, loss_ss: 1.266087, loss_d: 0.839986
0.1152 --- loss: 1.316307, loss_ss: 0.896911, loss_d: 0.419396
0.1536 --- loss: 1.491141, loss_ss: 1.169551, loss_d: 0.321590
0.1919 --- loss: 2.501717, loss_ss: 0.995036, loss_d: 1.506681
0.2303 --- loss: 1.217940, loss_ss: 0.873293, loss_d: 0.344647
0.2687 --- loss: 1.590266, loss_ss: 0.949160, loss_d: 0.641106
0.3071 --- loss: 1.849335, loss_ss: 1.514642, loss_d: 0.334693
0.3455 --- loss: 1.700900, loss_ss: 1.299822, loss_d: 0.401078
0.3839 --- loss: 1.544064, loss_ss: 1.099382, loss_d: 0.444681
0.4223 --- loss: 1.375694, loss_ss: 0.993783, loss_d: 0.381911
0.4607 --- loss: 1.249837, loss_ss: 0.876404, loss_d: 0.373433
0.4990 --- loss: 1.465435, loss_ss: 1.164194, loss_d: 0.301241
0.5374 --- loss: 1.228929, loss_ss: 0.857714, loss_d: 0.371215
0.5758 --- loss: 1.636960, loss_ss: 1.180573, loss_d: 0.456386
0.6142 --- loss: 1.490352, loss_ss: 1.105008, loss_d: 0.385344
0.6526 --- loss: 1.378666, loss_ss: 1.006902, loss_d: 0.371765
0.6910 --- loss: 1.438959, loss_ss: 0.982603, loss_d: 0.456355
0.7294 --- loss: 1.906797, loss_ss: 1.538594, loss_d: 0.368203
0.7678 --- loss: 1.484058, loss_ss: 0.991306, loss_d: 0.492752
0.8061 --- loss: 1.603360, loss_ss: 1.123862, loss_d: 0.479498
0.8445 --- loss: 1.322158, loss_ss: 1.031791, loss_d: 0.290367
0.8829 --- loss: 1.301484, loss_ss: 1.052321, loss_d: 0.249163
0.9213 --- loss: 1.287342, loss_ss: 1.105632, loss_d: 0.181710
0.9597 --- loss: 1.683523, loss_ss: 1.189431, loss_d: 0.494092
0.9981 --- loss: 1.687079, loss_ss: 1.091320, loss_d: 0.595759
Epoch finished! Loss: 1.545317575106254
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.368386, loss_ss: 0.941888, loss_d: 0.426498
0.0384 --- loss: 1.565992, loss_ss: 0.942421, loss_d: 0.623571
0.0768 --- loss: 1.409103, loss_ss: 0.912919, loss_d: 0.496184
0.1152 --- loss: 1.502120, loss_ss: 1.092558, loss_d: 0.409563
0.1536 --- loss: 1.198617, loss_ss: 0.922261, loss_d: 0.276355
0.1919 --- loss: 1.369186, loss_ss: 1.079330, loss_d: 0.289856
0.2303 --- loss: 1.373962, loss_ss: 1.063537, loss_d: 0.310425
0.2687 --- loss: 1.375604, loss_ss: 0.921218, loss_d: 0.454385
0.3071 --- loss: 1.266605, loss_ss: 0.953286, loss_d: 0.313318
0.3455 --- loss: 1.348819, loss_ss: 1.133014, loss_d: 0.215806
0.3839 --- loss: 1.685283, loss_ss: 1.198902, loss_d: 0.486381
0.4223 --- loss: 1.693552, loss_ss: 1.419737, loss_d: 0.273815
0.4607 --- loss: 1.316535, loss_ss: 1.056540, loss_d: 0.259995
0.4990 --- loss: 1.292290, loss_ss: 0.839676, loss_d: 0.452614
0.5374 --- loss: 1.776228, loss_ss: 0.851979, loss_d: 0.924249
0.5758 --- loss: 1.204008, loss_ss: 0.963500, loss_d: 0.240508
0.6142 --- loss: 1.746965, loss_ss: 1.386326, loss_d: 0.360640
0.6526 --- loss: 1.959488, loss_ss: 1.357647, loss_d: 0.601841
0.6910 --- loss: 1.492963, loss_ss: 0.974283, loss_d: 0.518680
0.7294 --- loss: 1.353806, loss_ss: 1.009137, loss_d: 0.344669
0.7678 --- loss: 1.467398, loss_ss: 1.122216, loss_d: 0.345182
0.8061 --- loss: 1.393529, loss_ss: 0.995573, loss_d: 0.397957
0.8445 --- loss: 1.806223, loss_ss: 1.498572, loss_d: 0.307651
0.8829 --- loss: 1.691268, loss_ss: 1.232003, loss_d: 0.459265
0.9213 --- loss: 1.695701, loss_ss: 1.171850, loss_d: 0.523851
0.9597 --- loss: 1.681849, loss_ss: 1.005705, loss_d: 0.676144
0.9981 --- loss: 1.945916, loss_ss: 1.298447, loss_d: 0.647469
Epoch finished! Loss: 1.5168930305884434
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4111111111111111
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00        32
        1.0       0.00      0.00      0.00       251
        2.0       0.34      0.99      0.50       208
        3.0       0.53      0.79      0.63       254
        4.0       0.00      0.00      0.00       245

avg / total       0.21      0.41      0.27       990
 


====== chp033-nsrr ======

The ppr of  0  has ZeroDivisionError.


The f1-score of  0  has ZeroDivisionError.


The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  96.77   0.00  100.00   0.00      0.00
1  74.65   0.00  100.00   0.00      0.00
2  59.09  99.04   48.47  33.83     50.43
3  76.46  79.13   75.54  52.76     63.31
4  75.25   0.00  100.00   0.00      0.00
Total accuracy: 41.11%
Average sen: 35.63%
Average spec: 84.80%
Macro f1-score: 22.75%
[0.72788399 0.56801194 0.64115125 0.63482738 0.63478631 0.60089421
 0.56518883 0.56924403 0.56226283 0.60485679 0.72943074 0.58372384
 0.59160316 0.58999103 0.56747901 0.59363598 0.61224383 0.56383198
 0.79492301 0.5632391  0.56121564 0.66359305 0.595676   0.83412367
 0.56578612 0.56120157 0.56747842 0.58540654 0.62055629 0.83368266
 0.82127261 0.81314754 0.78296024]
pred: 0.6395548365332864, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.365228, loss_ss: 1.661031, loss_d: 0.704196
0.0384 --- loss: 2.229130, loss_ss: 1.692654, loss_d: 0.536476
0.0768 --- loss: 2.343574, loss_ss: 1.688824, loss_d: 0.654750
0.1152 --- loss: 2.219550, loss_ss: 1.732389, loss_d: 0.487161
0.1536 --- loss: 2.401819, loss_ss: 1.682944, loss_d: 0.718875
0.1920 --- loss: 2.096611, loss_ss: 1.604561, loss_d: 0.492050
0.2304 --- loss: 2.264987, loss_ss: 1.647415, loss_d: 0.617572
0.2688 --- loss: 2.002265, loss_ss: 1.573886, loss_d: 0.428379
0.3072 --- loss: 2.501671, loss_ss: 1.644178, loss_d: 0.857493
0.3456 --- loss: 2.025201, loss_ss: 1.469381, loss_d: 0.555820
0.3840 --- loss: 2.267820, loss_ss: 1.525262, loss_d: 0.742558
0.4224 --- loss: 2.150927, loss_ss: 1.614215, loss_d: 0.536712
0.4608 --- loss: 2.122605, loss_ss: 1.615369, loss_d: 0.507236
0.4992 --- loss: 2.422126, loss_ss: 1.553414, loss_d: 0.868712
0.5376 --- loss: 2.225318, loss_ss: 1.643809, loss_d: 0.581509
0.5760 --- loss: 2.116909, loss_ss: 1.507394, loss_d: 0.609514
0.6144 --- loss: 1.959741, loss_ss: 1.547972, loss_d: 0.411770
0.6528 --- loss: 2.115330, loss_ss: 1.676499, loss_d: 0.438831
0.6912 --- loss: 2.022890, loss_ss: 1.480227, loss_d: 0.542663
0.7296 --- loss: 2.250792, loss_ss: 1.577817, loss_d: 0.672975
0.7680 --- loss: 1.884722, loss_ss: 1.532400, loss_d: 0.352322
0.8065 --- loss: 2.414388, loss_ss: 1.747425, loss_d: 0.666963
0.8449 --- loss: 1.984327, loss_ss: 1.360028, loss_d: 0.624299
0.8833 --- loss: 1.785549, loss_ss: 1.379889, loss_d: 0.405659
0.9217 --- loss: 1.881213, loss_ss: 1.482118, loss_d: 0.399095
0.9601 --- loss: 1.940048, loss_ss: 1.615333, loss_d: 0.324716
0.9985 --- loss: 1.672260, loss_ss: 1.340019, loss_d: 0.332241
Epoch finished! Loss: 2.161076087676562
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.999979, loss_ss: 1.571173, loss_d: 0.428806
0.0384 --- loss: 2.210055, loss_ss: 1.752550, loss_d: 0.457505
0.0768 --- loss: 1.695027, loss_ss: 1.397143, loss_d: 0.297884
0.1152 --- loss: 2.218843, loss_ss: 1.540446, loss_d: 0.678397
0.1536 --- loss: 2.044909, loss_ss: 1.516800, loss_d: 0.528109
0.1920 --- loss: 1.906611, loss_ss: 1.410801, loss_d: 0.495810
0.2304 --- loss: 2.110304, loss_ss: 1.579838, loss_d: 0.530465
0.2688 --- loss: 2.019566, loss_ss: 1.381045, loss_d: 0.638521
0.3072 --- loss: 1.779761, loss_ss: 1.416940, loss_d: 0.362821
0.3456 --- loss: 2.520933, loss_ss: 1.804907, loss_d: 0.716026
0.3840 --- loss: 2.020007, loss_ss: 1.605103, loss_d: 0.414904
0.4224 --- loss: 2.036454, loss_ss: 1.482494, loss_d: 0.553960
0.4608 --- loss: 2.285012, loss_ss: 1.622510, loss_d: 0.662502
0.4992 --- loss: 1.917726, loss_ss: 1.341588, loss_d: 0.576138
0.5376 --- loss: 1.953754, loss_ss: 1.241964, loss_d: 0.711790
0.5760 --- loss: 1.937546, loss_ss: 1.486027, loss_d: 0.451520
0.6144 --- loss: 1.761771, loss_ss: 1.380187, loss_d: 0.381584
0.6528 --- loss: 1.831367, loss_ss: 1.385579, loss_d: 0.445788
0.6912 --- loss: 1.851077, loss_ss: 1.282815, loss_d: 0.568262
0.7296 --- loss: 1.862719, loss_ss: 1.379964, loss_d: 0.482755
0.7680 --- loss: 2.000105, loss_ss: 1.542907, loss_d: 0.457198
0.8065 --- loss: 2.012614, loss_ss: 1.626312, loss_d: 0.386302
0.8449 --- loss: 2.433033, loss_ss: 1.660383, loss_d: 0.772651
0.8833 --- loss: 2.181606, loss_ss: 1.566715, loss_d: 0.614891
0.9217 --- loss: 1.853451, loss_ss: 1.336714, loss_d: 0.516736
0.9601 --- loss: 2.173485, loss_ss: 1.679266, loss_d: 0.494219
0.9985 --- loss: 1.624089, loss_ss: 1.314784, loss_d: 0.309305
Epoch finished! Loss: 2.037127326085017
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.138064, loss_ss: 1.554425, loss_d: 0.583638
0.0384 --- loss: 1.915192, loss_ss: 1.380104, loss_d: 0.535087
0.0768 --- loss: 1.766202, loss_ss: 1.417067, loss_d: 0.349136
0.1152 --- loss: 1.669209, loss_ss: 1.399029, loss_d: 0.270180
0.1536 --- loss: 1.998472, loss_ss: 1.403936, loss_d: 0.594537
0.1920 --- loss: 2.240379, loss_ss: 1.743512, loss_d: 0.496867
0.2304 --- loss: 1.968789, loss_ss: 1.654102, loss_d: 0.314686
0.2688 --- loss: 1.851405, loss_ss: 1.391909, loss_d: 0.459496
0.3072 --- loss: 2.225014, loss_ss: 1.540341, loss_d: 0.684674
0.3456 --- loss: 1.833144, loss_ss: 1.381263, loss_d: 0.451882
0.3840 --- loss: 1.807199, loss_ss: 1.367396, loss_d: 0.439804
0.4224 --- loss: 2.065554, loss_ss: 1.628386, loss_d: 0.437167
0.4608 --- loss: 1.866770, loss_ss: 1.438901, loss_d: 0.427869
0.4992 --- loss: 1.983245, loss_ss: 1.509609, loss_d: 0.473636
0.5376 --- loss: 2.260289, loss_ss: 1.566687, loss_d: 0.693602
0.5760 --- loss: 1.801238, loss_ss: 1.369098, loss_d: 0.432141
0.6144 --- loss: 1.954314, loss_ss: 1.521366, loss_d: 0.432948
0.6528 --- loss: 1.905477, loss_ss: 1.500319, loss_d: 0.405159
0.6912 --- loss: 2.422001, loss_ss: 1.549108, loss_d: 0.872893
0.7296 --- loss: 1.766706, loss_ss: 1.395659, loss_d: 0.371047
0.7680 --- loss: 1.751793, loss_ss: 1.287548, loss_d: 0.464245
0.8065 --- loss: 1.933158, loss_ss: 1.413093, loss_d: 0.520064
0.8449 --- loss: 1.659199, loss_ss: 1.327638, loss_d: 0.331561
0.8833 --- loss: 2.329014, loss_ss: 1.399651, loss_d: 0.929363
0.9217 --- loss: 2.264172, loss_ss: 1.376623, loss_d: 0.887549
0.9601 --- loss: 1.766218, loss_ss: 1.190104, loss_d: 0.576114
0.9985 --- loss: 2.032581, loss_ss: 1.593624, loss_d: 0.438957
Epoch finished! Loss: 1.983268410884417
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.888715, loss_ss: 1.502218, loss_d: 0.386497
0.0384 --- loss: 2.158221, loss_ss: 1.598126, loss_d: 0.560095
0.0768 --- loss: 1.842737, loss_ss: 1.368843, loss_d: 0.473894
0.1152 --- loss: 2.012507, loss_ss: 1.358548, loss_d: 0.653959
0.1536 --- loss: 2.109933, loss_ss: 1.487817, loss_d: 0.622115
0.1920 --- loss: 1.814259, loss_ss: 1.426724, loss_d: 0.387535
0.2304 --- loss: 1.853155, loss_ss: 1.534659, loss_d: 0.318497
0.2688 --- loss: 1.559110, loss_ss: 1.308163, loss_d: 0.250947
0.3072 --- loss: 1.787520, loss_ss: 1.412639, loss_d: 0.374882
0.3456 --- loss: 1.671356, loss_ss: 1.323560, loss_d: 0.347796
0.3840 --- loss: 1.716083, loss_ss: 1.332822, loss_d: 0.383261
0.4224 --- loss: 1.850591, loss_ss: 1.317499, loss_d: 0.533092
0.4608 --- loss: 1.836182, loss_ss: 1.376534, loss_d: 0.459647
0.4992 --- loss: 1.978235, loss_ss: 1.186026, loss_d: 0.792209
0.5376 --- loss: 2.284113, loss_ss: 1.802309, loss_d: 0.481804
0.5760 --- loss: 1.736179, loss_ss: 1.324193, loss_d: 0.411985
0.6144 --- loss: 1.984664, loss_ss: 1.434999, loss_d: 0.549665
0.6528 --- loss: 2.737442, loss_ss: 1.529808, loss_d: 1.207634
0.6912 --- loss: 1.837259, loss_ss: 1.360792, loss_d: 0.476467
0.7296 --- loss: 2.083678, loss_ss: 1.308265, loss_d: 0.775413
0.7680 --- loss: 1.787017, loss_ss: 1.448174, loss_d: 0.338843
0.8065 --- loss: 1.903282, loss_ss: 1.243614, loss_d: 0.659668
0.8449 --- loss: 1.990371, loss_ss: 1.356909, loss_d: 0.633462
0.8833 --- loss: 1.859823, loss_ss: 1.275929, loss_d: 0.583894
0.9217 --- loss: 1.802331, loss_ss: 1.285043, loss_d: 0.517288
0.9601 --- loss: 1.716386, loss_ss: 1.319256, loss_d: 0.397130
0.9985 --- loss: 3.103038, loss_ss: 1.485614, loss_d: 1.617425
Epoch finished! Loss: 1.9370761756713575
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.969450, loss_ss: 1.444664, loss_d: 0.524785
0.0384 --- loss: 1.978819, loss_ss: 1.552947, loss_d: 0.425872
0.0768 --- loss: 1.847001, loss_ss: 1.333184, loss_d: 0.513817
0.1152 --- loss: 1.861230, loss_ss: 1.384969, loss_d: 0.476262
0.1536 --- loss: 1.962572, loss_ss: 1.569003, loss_d: 0.393568
0.1920 --- loss: 2.126608, loss_ss: 1.641892, loss_d: 0.484716
0.2304 --- loss: 2.341938, loss_ss: 1.397871, loss_d: 0.944067
0.2688 --- loss: 1.476743, loss_ss: 1.184971, loss_d: 0.291771
0.3072 --- loss: 1.757050, loss_ss: 1.406851, loss_d: 0.350199
0.3456 --- loss: 2.044371, loss_ss: 1.429998, loss_d: 0.614373
0.3840 --- loss: 1.561246, loss_ss: 1.194086, loss_d: 0.367160
0.4224 --- loss: 1.784435, loss_ss: 1.293520, loss_d: 0.490915
0.4608 --- loss: 1.888251, loss_ss: 1.349342, loss_d: 0.538909
0.4992 --- loss: 1.886721, loss_ss: 1.365817, loss_d: 0.520904
0.5376 --- loss: 1.757735, loss_ss: 1.169616, loss_d: 0.588119
0.5760 --- loss: 1.491554, loss_ss: 1.113971, loss_d: 0.377582
0.6144 --- loss: 1.740871, loss_ss: 1.309113, loss_d: 0.431758
0.6528 --- loss: 2.065729, loss_ss: 1.135371, loss_d: 0.930358
0.6912 --- loss: 1.586701, loss_ss: 1.168017, loss_d: 0.418684
0.7296 --- loss: 1.763324, loss_ss: 1.441255, loss_d: 0.322069
0.7680 --- loss: 1.799345, loss_ss: 1.300744, loss_d: 0.498601
0.8065 --- loss: 1.776853, loss_ss: 1.232203, loss_d: 0.544650
0.8449 --- loss: 1.661985, loss_ss: 1.193460, loss_d: 0.468526
0.8833 --- loss: 2.318482, loss_ss: 1.372007, loss_d: 0.946475
0.9217 --- loss: 1.758103, loss_ss: 1.416614, loss_d: 0.341489
0.9601 --- loss: 1.610656, loss_ss: 1.196496, loss_d: 0.414160
0.9985 --- loss: 1.546087, loss_ss: 1.273944, loss_d: 0.272142
Epoch finished! Loss: 1.864136379957199
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.627804, loss_ss: 1.250280, loss_d: 0.377524
0.0384 --- loss: 2.638984, loss_ss: 1.344236, loss_d: 1.294748
0.0768 --- loss: 1.881873, loss_ss: 1.455032, loss_d: 0.426841
0.1152 --- loss: 1.646512, loss_ss: 1.213038, loss_d: 0.433473
0.1536 --- loss: 1.514770, loss_ss: 1.122200, loss_d: 0.392569
0.1920 --- loss: 1.815569, loss_ss: 1.280828, loss_d: 0.534741
0.2304 --- loss: 1.975283, loss_ss: 1.182886, loss_d: 0.792396
0.2688 --- loss: 2.077112, loss_ss: 1.105909, loss_d: 0.971203
0.3072 --- loss: 1.664727, loss_ss: 1.228484, loss_d: 0.436244
0.3456 --- loss: 1.857675, loss_ss: 1.220569, loss_d: 0.637106
0.3840 --- loss: 1.609217, loss_ss: 1.301125, loss_d: 0.308092
0.4224 --- loss: 1.756109, loss_ss: 1.222235, loss_d: 0.533874
0.4608 --- loss: 1.642210, loss_ss: 1.154805, loss_d: 0.487404
0.4992 --- loss: 1.629366, loss_ss: 1.007788, loss_d: 0.621578
0.5376 --- loss: 1.620068, loss_ss: 1.111944, loss_d: 0.508124
0.5760 --- loss: 1.861537, loss_ss: 1.270515, loss_d: 0.591022
0.6144 --- loss: 1.751586, loss_ss: 1.338588, loss_d: 0.412997
0.6528 --- loss: 1.844492, loss_ss: 1.285161, loss_d: 0.559330
0.6912 --- loss: 1.734434, loss_ss: 1.294289, loss_d: 0.440145
0.7296 --- loss: 1.715089, loss_ss: 1.244317, loss_d: 0.470772
0.7680 --- loss: 1.599624, loss_ss: 1.186746, loss_d: 0.412878
0.8065 --- loss: 1.731733, loss_ss: 1.319141, loss_d: 0.412592
0.8449 --- loss: 1.902384, loss_ss: 1.438505, loss_d: 0.463879
0.8833 --- loss: 1.933943, loss_ss: 1.438696, loss_d: 0.495247
0.9217 --- loss: 2.812996, loss_ss: 1.413059, loss_d: 1.399937
0.9601 --- loss: 1.986078, loss_ss: 1.165265, loss_d: 0.820813
0.9985 --- loss: 1.651293, loss_ss: 1.358335, loss_d: 0.292958
Epoch finished! Loss: 1.7517163414221544
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.517448, loss_ss: 1.169321, loss_d: 0.348127
0.0384 --- loss: 1.706096, loss_ss: 1.117094, loss_d: 0.589002
0.0768 --- loss: 1.749366, loss_ss: 1.350939, loss_d: 0.398428
0.1152 --- loss: 1.616727, loss_ss: 1.220811, loss_d: 0.395917
0.1536 --- loss: 1.242574, loss_ss: 0.869214, loss_d: 0.373360
0.1920 --- loss: 2.410880, loss_ss: 1.359378, loss_d: 1.051502
0.2304 --- loss: 1.550291, loss_ss: 1.075861, loss_d: 0.474430
0.2688 --- loss: 1.833293, loss_ss: 1.386029, loss_d: 0.447263
0.3072 --- loss: 1.697306, loss_ss: 1.280825, loss_d: 0.416481
0.3456 --- loss: 1.925279, loss_ss: 1.322069, loss_d: 0.603211
0.3840 --- loss: 1.642986, loss_ss: 1.094340, loss_d: 0.548646
0.4224 --- loss: 1.542652, loss_ss: 1.243372, loss_d: 0.299280
0.4608 --- loss: 2.286103, loss_ss: 1.132623, loss_d: 1.153480
0.4992 --- loss: 1.371235, loss_ss: 1.027869, loss_d: 0.343366
0.5376 --- loss: 1.477811, loss_ss: 1.154077, loss_d: 0.323734
0.5760 --- loss: 1.750498, loss_ss: 1.396698, loss_d: 0.353800
0.6144 --- loss: 1.815589, loss_ss: 1.167477, loss_d: 0.648113
0.6528 --- loss: 1.641130, loss_ss: 1.296484, loss_d: 0.344646
0.6912 --- loss: 1.910330, loss_ss: 1.170001, loss_d: 0.740329
0.7296 --- loss: 1.458981, loss_ss: 0.995894, loss_d: 0.463086
0.7680 --- loss: 1.791157, loss_ss: 1.379630, loss_d: 0.411527
0.8065 --- loss: 1.427615, loss_ss: 1.062244, loss_d: 0.365371
0.8449 --- loss: 1.674618, loss_ss: 1.181982, loss_d: 0.492636
0.8833 --- loss: 1.797722, loss_ss: 1.348774, loss_d: 0.448947
0.9217 --- loss: 1.447800, loss_ss: 0.958582, loss_d: 0.489218
0.9601 --- loss: 1.749875, loss_ss: 1.129389, loss_d: 0.620486
0.9985 --- loss: 1.401005, loss_ss: 1.121119, loss_d: 0.279886
Epoch finished! Loss: 1.6794952883170202
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.377298, loss_ss: 1.062800, loss_d: 0.314498
0.0384 --- loss: 1.386975, loss_ss: 1.062270, loss_d: 0.324705
0.0768 --- loss: 1.750839, loss_ss: 1.111460, loss_d: 0.639379
0.1152 --- loss: 1.398279, loss_ss: 0.981475, loss_d: 0.416803
0.1536 --- loss: 1.785446, loss_ss: 1.134172, loss_d: 0.651274
0.1920 --- loss: 1.513182, loss_ss: 1.094149, loss_d: 0.419033
0.2304 --- loss: 1.815903, loss_ss: 1.353095, loss_d: 0.462808
0.2688 --- loss: 1.594825, loss_ss: 1.238699, loss_d: 0.356126
0.3072 --- loss: 1.803544, loss_ss: 1.304320, loss_d: 0.499224
0.3456 --- loss: 1.581159, loss_ss: 1.011625, loss_d: 0.569534
0.3840 --- loss: 1.320344, loss_ss: 1.044079, loss_d: 0.276265
0.4224 --- loss: 1.410600, loss_ss: 1.065921, loss_d: 0.344679
0.4608 --- loss: 1.597068, loss_ss: 1.202503, loss_d: 0.394565
0.4992 --- loss: 1.413650, loss_ss: 0.905300, loss_d: 0.508349
0.5376 --- loss: 1.471845, loss_ss: 1.023321, loss_d: 0.448524
0.5760 --- loss: 1.667101, loss_ss: 1.066613, loss_d: 0.600488
0.6144 --- loss: 1.549312, loss_ss: 1.068989, loss_d: 0.480323
0.6528 --- loss: 1.557233, loss_ss: 1.094792, loss_d: 0.462440
0.6912 --- loss: 1.556138, loss_ss: 1.056578, loss_d: 0.499560
0.7296 --- loss: 2.145750, loss_ss: 1.500791, loss_d: 0.644959
0.7680 --- loss: 1.418392, loss_ss: 1.005946, loss_d: 0.412446
0.8065 --- loss: 1.545353, loss_ss: 1.094303, loss_d: 0.451050
0.8449 --- loss: 1.928371, loss_ss: 1.469451, loss_d: 0.458920
0.8833 --- loss: 1.691970, loss_ss: 1.315306, loss_d: 0.376665
0.9217 --- loss: 1.645923, loss_ss: 1.174751, loss_d: 0.471172
0.9601 --- loss: 1.282108, loss_ss: 0.967319, loss_d: 0.314789
0.9985 --- loss: 2.170772, loss_ss: 0.780160, loss_d: 1.390613
Epoch finished! Loss: 1.6373586673002976
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.392726, loss_ss: 1.064835, loss_d: 0.327891
0.0384 --- loss: 1.709116, loss_ss: 1.084914, loss_d: 0.624202
0.0768 --- loss: 1.691227, loss_ss: 0.979789, loss_d: 0.711439
0.1152 --- loss: 1.769766, loss_ss: 0.967390, loss_d: 0.802376
0.1536 --- loss: 1.493504, loss_ss: 0.937295, loss_d: 0.556209
0.1920 --- loss: 1.459711, loss_ss: 1.129763, loss_d: 0.329947
0.2304 --- loss: 1.903625, loss_ss: 1.236962, loss_d: 0.666662
0.2688 --- loss: 1.591629, loss_ss: 1.096919, loss_d: 0.494710
0.3072 --- loss: 2.376684, loss_ss: 1.196497, loss_d: 1.180187
0.3456 --- loss: 1.692376, loss_ss: 1.105110, loss_d: 0.587266
0.3840 --- loss: 1.301392, loss_ss: 0.930476, loss_d: 0.370915
0.4224 --- loss: 1.432060, loss_ss: 0.917656, loss_d: 0.514404
0.4608 --- loss: 1.512569, loss_ss: 1.094345, loss_d: 0.418223
0.4992 --- loss: 1.464757, loss_ss: 1.073911, loss_d: 0.390846
0.5376 --- loss: 1.544615, loss_ss: 1.089042, loss_d: 0.455573
0.5760 --- loss: 1.529516, loss_ss: 1.124173, loss_d: 0.405343
0.6144 --- loss: 1.606707, loss_ss: 1.061576, loss_d: 0.545131
0.6528 --- loss: 1.899025, loss_ss: 1.517185, loss_d: 0.381840
0.6912 --- loss: 1.847942, loss_ss: 1.086977, loss_d: 0.760965
0.7296 --- loss: 1.760726, loss_ss: 1.264679, loss_d: 0.496046
0.7680 --- loss: 1.840479, loss_ss: 1.441452, loss_d: 0.399027
0.8065 --- loss: 1.473295, loss_ss: 1.120746, loss_d: 0.352550
0.8449 --- loss: 1.791292, loss_ss: 1.436394, loss_d: 0.354898
0.8833 --- loss: 1.689455, loss_ss: 1.211440, loss_d: 0.478015
0.9217 --- loss: 2.301457, loss_ss: 1.118864, loss_d: 1.182593
0.9601 --- loss: 1.677108, loss_ss: 1.378650, loss_d: 0.298458
0.9985 --- loss: 2.082014, loss_ss: 1.026336, loss_d: 1.055678
Epoch finished! Loss: 1.6050483974126668
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.532228, loss_ss: 1.141727, loss_d: 0.390502
0.0384 --- loss: 1.354734, loss_ss: 0.918453, loss_d: 0.436281
0.0768 --- loss: 1.439350, loss_ss: 1.037782, loss_d: 0.401567
0.1152 --- loss: 1.583935, loss_ss: 1.087106, loss_d: 0.496829
0.1536 --- loss: 1.492735, loss_ss: 1.065398, loss_d: 0.427336
0.1920 --- loss: 1.707654, loss_ss: 1.078644, loss_d: 0.629010
0.2304 --- loss: 1.494140, loss_ss: 1.097700, loss_d: 0.396440
0.2688 --- loss: 1.585720, loss_ss: 1.034536, loss_d: 0.551184
0.3072 --- loss: 1.373441, loss_ss: 1.053852, loss_d: 0.319588
0.3456 --- loss: 1.783515, loss_ss: 0.949995, loss_d: 0.833520
0.3840 --- loss: 1.547804, loss_ss: 1.092551, loss_d: 0.455253
0.4224 --- loss: 1.309301, loss_ss: 0.948394, loss_d: 0.360908
0.4608 --- loss: 1.997698, loss_ss: 1.166619, loss_d: 0.831078
0.4992 --- loss: 1.252504, loss_ss: 0.953006, loss_d: 0.299498
0.5376 --- loss: 1.530830, loss_ss: 1.179188, loss_d: 0.351642
0.5760 --- loss: 1.541452, loss_ss: 1.027488, loss_d: 0.513964
0.6144 --- loss: 1.896768, loss_ss: 1.241135, loss_d: 0.655633
0.6528 --- loss: 1.551956, loss_ss: 1.222501, loss_d: 0.329455
0.6912 --- loss: 1.347318, loss_ss: 0.922256, loss_d: 0.425062
0.7296 --- loss: 1.467683, loss_ss: 1.062101, loss_d: 0.405582
0.7680 --- loss: 1.889473, loss_ss: 1.480350, loss_d: 0.409123
0.8065 --- loss: 1.589637, loss_ss: 0.990633, loss_d: 0.599004
0.8449 --- loss: 1.533740, loss_ss: 1.145908, loss_d: 0.387832
0.8833 --- loss: 1.584078, loss_ss: 1.103124, loss_d: 0.480954
0.9217 --- loss: 1.606277, loss_ss: 1.150688, loss_d: 0.455589
0.9601 --- loss: 1.197604, loss_ss: 0.924703, loss_d: 0.272901
0.9985 --- loss: 1.733035, loss_ss: 1.272717, loss_d: 0.460318
Epoch finished! Loss: 1.5753924337717202
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5794117647058824
             precision    recall  f1-score   support

        0.0       1.00      0.12      0.21        17
        1.0       0.00      0.00      0.00        62
        2.0       0.50      0.94      0.65       372
        3.0       1.00      0.23      0.38       337
        4.0       0.67      0.70      0.68       232

avg / total       0.68      0.58      0.52      1020
 


====== chp034-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  98.53  11.76  100.00  100.00     21.05
1  93.82   0.00   99.90    0.00      0.00
2  63.63  93.55   46.45   50.07     65.23
3  74.71  23.44  100.00  100.00     37.98
4  85.20  69.83   89.72   66.67     68.21
Total accuracy: 57.94%
Average sen: 39.72%
Average spec: 87.21%
Macro f1-score: 38.49%
[0.64442712 0.48164806 0.63034922 0.50865704 0.49794933 0.46892229
 0.51025343 0.48046139 0.78759217 0.86451501 0.97124994 0.47789165
 0.47100517 0.46384925 0.46381047 0.47981754 0.47519329 0.4695093
 0.48328853 0.59839702 0.52555025 0.48554891 0.46810803 0.55119383
 0.46692026 0.47486693 0.53459251 0.47588825 0.46817061 0.46159965
 0.4762066  0.62450552 0.46528053 0.47828904]
pred: 0.5348678862347322, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.359880, loss_ss: 1.680204, loss_d: 0.679676
0.0385 --- loss: 2.508961, loss_ss: 1.693328, loss_d: 0.815633
0.0770 --- loss: 2.453309, loss_ss: 1.767539, loss_d: 0.685770
0.1156 --- loss: 2.288423, loss_ss: 1.719645, loss_d: 0.568778
0.1541 --- loss: 2.148129, loss_ss: 1.709617, loss_d: 0.438513
0.1926 --- loss: 2.203078, loss_ss: 1.657447, loss_d: 0.545631
0.2311 --- loss: 1.930216, loss_ss: 1.432113, loss_d: 0.498102
0.2696 --- loss: 1.911041, loss_ss: 1.519729, loss_d: 0.391313
0.3082 --- loss: 2.016508, loss_ss: 1.544847, loss_d: 0.471661
0.3467 --- loss: 2.017308, loss_ss: 1.619010, loss_d: 0.398298
0.3852 --- loss: 1.968832, loss_ss: 1.540733, loss_d: 0.428099
0.4237 --- loss: 2.292233, loss_ss: 1.556648, loss_d: 0.735584
0.4622 --- loss: 2.007086, loss_ss: 1.514289, loss_d: 0.492796
0.5008 --- loss: 1.955006, loss_ss: 1.535352, loss_d: 0.419653
0.5393 --- loss: 2.247700, loss_ss: 1.604069, loss_d: 0.643631
0.5778 --- loss: 2.098704, loss_ss: 1.641662, loss_d: 0.457042
0.6163 --- loss: 1.942845, loss_ss: 1.514068, loss_d: 0.428777
0.6549 --- loss: 1.908624, loss_ss: 1.400180, loss_d: 0.508444
0.6934 --- loss: 2.148545, loss_ss: 1.416461, loss_d: 0.732083
0.7319 --- loss: 2.048409, loss_ss: 1.431305, loss_d: 0.617104
0.7704 --- loss: 2.175743, loss_ss: 1.332699, loss_d: 0.843044
0.8089 --- loss: 2.156632, loss_ss: 1.474887, loss_d: 0.681745
0.8475 --- loss: 2.161481, loss_ss: 1.514700, loss_d: 0.646781
0.8860 --- loss: 2.178479, loss_ss: 1.550431, loss_d: 0.628049
0.9245 --- loss: 1.933696, loss_ss: 1.494915, loss_d: 0.438781
0.9630 --- loss: 2.144516, loss_ss: 1.532756, loss_d: 0.611760
Epoch finished! Loss: 2.145949551957915
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.982309, loss_ss: 1.406674, loss_d: 0.575634
0.0385 --- loss: 2.020880, loss_ss: 1.478816, loss_d: 0.542065
0.0770 --- loss: 2.065956, loss_ss: 1.566567, loss_d: 0.499390
0.1156 --- loss: 1.882838, loss_ss: 1.409432, loss_d: 0.473405
0.1541 --- loss: 1.857002, loss_ss: 1.473697, loss_d: 0.383305
0.1926 --- loss: 2.185701, loss_ss: 1.531290, loss_d: 0.654412
0.2311 --- loss: 2.077335, loss_ss: 1.640592, loss_d: 0.436743
0.2696 --- loss: 1.986581, loss_ss: 1.435040, loss_d: 0.551541
0.3082 --- loss: 2.024653, loss_ss: 1.488472, loss_d: 0.536181
0.3467 --- loss: 1.723218, loss_ss: 1.317585, loss_d: 0.405633
0.3852 --- loss: 1.816401, loss_ss: 1.312200, loss_d: 0.504201
0.4237 --- loss: 2.031584, loss_ss: 1.536716, loss_d: 0.494868
0.4622 --- loss: 1.948844, loss_ss: 1.398410, loss_d: 0.550434
0.5008 --- loss: 1.983697, loss_ss: 1.477690, loss_d: 0.506007
0.5393 --- loss: 2.040369, loss_ss: 1.558655, loss_d: 0.481714
0.5778 --- loss: 1.961167, loss_ss: 1.513696, loss_d: 0.447471
0.6163 --- loss: 1.913786, loss_ss: 1.211813, loss_d: 0.701973
0.6549 --- loss: 1.908034, loss_ss: 1.432994, loss_d: 0.475040
0.6934 --- loss: 1.861685, loss_ss: 1.329585, loss_d: 0.532100
0.7319 --- loss: 2.039810, loss_ss: 1.417682, loss_d: 0.622127
0.7704 --- loss: 1.748610, loss_ss: 1.298942, loss_d: 0.449668
0.8089 --- loss: 2.073010, loss_ss: 1.583804, loss_d: 0.489206
0.8475 --- loss: 1.871475, loss_ss: 1.444275, loss_d: 0.427200
0.8860 --- loss: 2.142611, loss_ss: 1.454794, loss_d: 0.687817
0.9245 --- loss: 2.009787, loss_ss: 1.474138, loss_d: 0.535648
0.9630 --- loss: 1.766208, loss_ss: 1.238261, loss_d: 0.527947
Epoch finished! Loss: 1.9706837021706187
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.783927, loss_ss: 1.351619, loss_d: 0.432308
0.0385 --- loss: 2.168646, loss_ss: 1.513731, loss_d: 0.654915
0.0770 --- loss: 2.717948, loss_ss: 1.366053, loss_d: 1.351896
0.1156 --- loss: 1.745952, loss_ss: 1.347732, loss_d: 0.398220
0.1541 --- loss: 1.709675, loss_ss: 1.303584, loss_d: 0.406091
0.1926 --- loss: 1.946836, loss_ss: 1.294831, loss_d: 0.652005
0.2311 --- loss: 1.635387, loss_ss: 1.067705, loss_d: 0.567682
0.2696 --- loss: 2.245927, loss_ss: 1.533773, loss_d: 0.712154
0.3082 --- loss: 1.888422, loss_ss: 1.553937, loss_d: 0.334485
0.3467 --- loss: 1.715253, loss_ss: 1.443153, loss_d: 0.272101
0.3852 --- loss: 1.836586, loss_ss: 1.173045, loss_d: 0.663542
0.4237 --- loss: 1.560967, loss_ss: 1.244350, loss_d: 0.316617
0.4622 --- loss: 1.786768, loss_ss: 1.249951, loss_d: 0.536818
0.5008 --- loss: 1.689301, loss_ss: 1.222424, loss_d: 0.466877
0.5393 --- loss: 1.893899, loss_ss: 1.313168, loss_d: 0.580731
0.5778 --- loss: 1.937635, loss_ss: 1.481456, loss_d: 0.456179
0.6163 --- loss: 1.957271, loss_ss: 1.376213, loss_d: 0.581058
0.6549 --- loss: 1.834312, loss_ss: 1.362681, loss_d: 0.471631
0.6934 --- loss: 2.186909, loss_ss: 1.706017, loss_d: 0.480892
0.7319 --- loss: 1.954131, loss_ss: 1.288932, loss_d: 0.665199
0.7704 --- loss: 1.800449, loss_ss: 1.170495, loss_d: 0.629955
0.8089 --- loss: 1.799592, loss_ss: 1.274475, loss_d: 0.525117
0.8475 --- loss: 2.053253, loss_ss: 1.426657, loss_d: 0.626596
0.8860 --- loss: 1.467700, loss_ss: 0.948608, loss_d: 0.519093
0.9245 --- loss: 1.869393, loss_ss: 1.382675, loss_d: 0.486718
0.9630 --- loss: 1.804041, loss_ss: 1.231891, loss_d: 0.572150
Epoch finished! Loss: 1.8498372143299884
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.835673, loss_ss: 1.311889, loss_d: 0.523784
0.0385 --- loss: 1.705381, loss_ss: 1.373035, loss_d: 0.332346
0.0770 --- loss: 1.465868, loss_ss: 1.184872, loss_d: 0.280996
0.1156 --- loss: 1.480289, loss_ss: 1.202785, loss_d: 0.277504
0.1541 --- loss: 1.966148, loss_ss: 1.514235, loss_d: 0.451912
0.1926 --- loss: 1.763333, loss_ss: 1.203290, loss_d: 0.560042
0.2311 --- loss: 1.815031, loss_ss: 1.212120, loss_d: 0.602911
0.2696 --- loss: 1.804893, loss_ss: 1.220864, loss_d: 0.584029
0.3082 --- loss: 1.804804, loss_ss: 1.385275, loss_d: 0.419529
0.3467 --- loss: 2.196357, loss_ss: 1.172831, loss_d: 1.023526
0.3852 --- loss: 1.695164, loss_ss: 1.196917, loss_d: 0.498248
0.4237 --- loss: 1.717479, loss_ss: 1.304340, loss_d: 0.413139
0.4622 --- loss: 2.465009, loss_ss: 1.310683, loss_d: 1.154325
0.5008 --- loss: 1.955645, loss_ss: 1.401867, loss_d: 0.553778
0.5393 --- loss: 1.677323, loss_ss: 1.300499, loss_d: 0.376823
0.5778 --- loss: 1.649868, loss_ss: 1.269621, loss_d: 0.380247
0.6163 --- loss: 1.790585, loss_ss: 1.133067, loss_d: 0.657518
0.6549 --- loss: 1.500131, loss_ss: 1.009464, loss_d: 0.490667
0.6934 --- loss: 1.900698, loss_ss: 1.333927, loss_d: 0.566770
0.7319 --- loss: 1.810975, loss_ss: 1.249936, loss_d: 0.561039
0.7704 --- loss: 1.960858, loss_ss: 1.308874, loss_d: 0.651984
0.8089 --- loss: 2.084599, loss_ss: 1.412582, loss_d: 0.672017
0.8475 --- loss: 2.134583, loss_ss: 1.370164, loss_d: 0.764419
0.8860 --- loss: 1.515522, loss_ss: 1.032350, loss_d: 0.483172
0.9245 --- loss: 1.766079, loss_ss: 1.249463, loss_d: 0.516616
0.9630 --- loss: 1.603352, loss_ss: 1.277192, loss_d: 0.326159
Epoch finished! Loss: 1.777682264799317
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.713883, loss_ss: 1.249247, loss_d: 0.464636
0.0385 --- loss: 1.746629, loss_ss: 1.220911, loss_d: 0.525718
0.0770 --- loss: 1.661180, loss_ss: 1.250868, loss_d: 0.410312
0.1156 --- loss: 1.512137, loss_ss: 1.051526, loss_d: 0.460612
0.1541 --- loss: 1.663828, loss_ss: 1.272981, loss_d: 0.390847
0.1926 --- loss: 1.571395, loss_ss: 1.201470, loss_d: 0.369925
0.2311 --- loss: 1.816496, loss_ss: 1.179743, loss_d: 0.636753
0.2696 --- loss: 1.911073, loss_ss: 1.326061, loss_d: 0.585012
0.3082 --- loss: 2.042258, loss_ss: 1.322754, loss_d: 0.719504
0.3467 --- loss: 1.556913, loss_ss: 1.175262, loss_d: 0.381651
0.3852 --- loss: 1.635271, loss_ss: 0.865502, loss_d: 0.769769
0.4237 --- loss: 1.978697, loss_ss: 1.520620, loss_d: 0.458077
0.4622 --- loss: 1.437929, loss_ss: 1.095532, loss_d: 0.342396
0.5008 --- loss: 2.157804, loss_ss: 1.333908, loss_d: 0.823895
0.5393 --- loss: 2.147259, loss_ss: 1.259277, loss_d: 0.887982
0.5778 --- loss: 1.675985, loss_ss: 1.269913, loss_d: 0.406072
0.6163 --- loss: 1.724465, loss_ss: 1.260293, loss_d: 0.464172
0.6549 --- loss: 1.571074, loss_ss: 1.181080, loss_d: 0.389994
0.6934 --- loss: 1.645154, loss_ss: 1.274473, loss_d: 0.370681
0.7319 --- loss: 1.436053, loss_ss: 1.027692, loss_d: 0.408361
0.7704 --- loss: 1.760818, loss_ss: 1.392798, loss_d: 0.368020
0.8089 --- loss: 1.639175, loss_ss: 1.078501, loss_d: 0.560675
0.8475 --- loss: 1.464394, loss_ss: 1.104531, loss_d: 0.359863
0.8860 --- loss: 2.232463, loss_ss: 1.477277, loss_d: 0.755186
0.9245 --- loss: 2.646561, loss_ss: 1.265431, loss_d: 1.381130
0.9630 --- loss: 1.530548, loss_ss: 1.121185, loss_d: 0.409363
Epoch finished! Loss: 1.6955528236263968
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.986398, loss_ss: 1.569454, loss_d: 0.416944
0.0385 --- loss: 1.251148, loss_ss: 0.886397, loss_d: 0.364751
0.0770 --- loss: 1.749935, loss_ss: 1.203673, loss_d: 0.546261
0.1156 --- loss: 1.763756, loss_ss: 1.334327, loss_d: 0.429429
0.1541 --- loss: 1.755301, loss_ss: 1.380550, loss_d: 0.374751
0.1926 --- loss: 1.844637, loss_ss: 1.422109, loss_d: 0.422528
0.2311 --- loss: 1.601792, loss_ss: 0.995093, loss_d: 0.606700
0.2696 --- loss: 1.804877, loss_ss: 1.223298, loss_d: 0.581579
0.3082 --- loss: 1.641375, loss_ss: 1.210159, loss_d: 0.431216
0.3467 --- loss: 1.705343, loss_ss: 1.192530, loss_d: 0.512813
0.3852 --- loss: 1.282230, loss_ss: 0.903840, loss_d: 0.378391
0.4237 --- loss: 1.638641, loss_ss: 1.115378, loss_d: 0.523262
0.4622 --- loss: 1.309332, loss_ss: 0.964848, loss_d: 0.344483
0.5008 --- loss: 1.418680, loss_ss: 1.116724, loss_d: 0.301956
0.5393 --- loss: 1.663813, loss_ss: 1.365369, loss_d: 0.298444
0.5778 --- loss: 1.442472, loss_ss: 1.135915, loss_d: 0.306557
0.6163 --- loss: 2.499166, loss_ss: 1.219814, loss_d: 1.279352
0.6549 --- loss: 1.569749, loss_ss: 0.899839, loss_d: 0.669909
0.6934 --- loss: 1.511966, loss_ss: 1.015740, loss_d: 0.496226
0.7319 --- loss: 1.543986, loss_ss: 1.182704, loss_d: 0.361282
0.7704 --- loss: 1.466990, loss_ss: 1.162522, loss_d: 0.304468
0.8089 --- loss: 1.420263, loss_ss: 1.106577, loss_d: 0.313685
0.8475 --- loss: 1.247664, loss_ss: 0.823719, loss_d: 0.423944
0.8860 --- loss: 1.608690, loss_ss: 0.987326, loss_d: 0.621364
0.9245 --- loss: 1.837187, loss_ss: 1.153791, loss_d: 0.683396
0.9630 --- loss: 1.591924, loss_ss: 0.985672, loss_d: 0.606252
Epoch finished! Loss: 1.6286754479279388
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.681334, loss_ss: 1.176228, loss_d: 0.505106
0.0385 --- loss: 1.511048, loss_ss: 1.075734, loss_d: 0.435315
0.0770 --- loss: 2.399478, loss_ss: 1.801975, loss_d: 0.597504
0.1156 --- loss: 1.520556, loss_ss: 1.016618, loss_d: 0.503938
0.1541 --- loss: 1.543366, loss_ss: 1.190366, loss_d: 0.353000
0.1926 --- loss: 2.371769, loss_ss: 1.111372, loss_d: 1.260397
0.2311 --- loss: 1.678248, loss_ss: 1.131922, loss_d: 0.546325
0.2696 --- loss: 1.732729, loss_ss: 0.986171, loss_d: 0.746558
0.3082 --- loss: 1.413216, loss_ss: 0.920706, loss_d: 0.492510
0.3467 --- loss: 1.509240, loss_ss: 1.167328, loss_d: 0.341912
0.3852 --- loss: 1.367919, loss_ss: 1.085405, loss_d: 0.282514
0.4237 --- loss: 1.197120, loss_ss: 0.913931, loss_d: 0.283189
0.4622 --- loss: 1.919472, loss_ss: 1.023027, loss_d: 0.896445
0.5008 --- loss: 1.712275, loss_ss: 1.155762, loss_d: 0.556512
0.5393 --- loss: 1.493148, loss_ss: 0.983586, loss_d: 0.509562
0.5778 --- loss: 1.307098, loss_ss: 0.918175, loss_d: 0.388923
0.6163 --- loss: 1.579560, loss_ss: 1.171244, loss_d: 0.408317
0.6549 --- loss: 1.326274, loss_ss: 0.989711, loss_d: 0.336562
0.6934 --- loss: 1.914994, loss_ss: 1.574230, loss_d: 0.340764
0.7319 --- loss: 1.483788, loss_ss: 1.104468, loss_d: 0.379321
0.7704 --- loss: 1.273411, loss_ss: 0.994361, loss_d: 0.279050
0.8089 --- loss: 1.845153, loss_ss: 1.083610, loss_d: 0.761543
0.8475 --- loss: 1.588180, loss_ss: 1.052155, loss_d: 0.536025
0.8860 --- loss: 1.609139, loss_ss: 1.173864, loss_d: 0.435276
0.9245 --- loss: 1.785227, loss_ss: 1.103730, loss_d: 0.681497
0.9630 --- loss: 1.881688, loss_ss: 1.437385, loss_d: 0.444303
Epoch finished! Loss: 1.610858617602168
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.512783, loss_ss: 1.175707, loss_d: 0.337076
0.0385 --- loss: 1.957296, loss_ss: 1.147852, loss_d: 0.809444
0.0770 --- loss: 1.500238, loss_ss: 1.128811, loss_d: 0.371426
0.1156 --- loss: 1.437480, loss_ss: 1.040359, loss_d: 0.397121
0.1541 --- loss: 1.484232, loss_ss: 0.990415, loss_d: 0.493817
0.1926 --- loss: 1.855330, loss_ss: 1.240333, loss_d: 0.614997
0.2311 --- loss: 1.414446, loss_ss: 1.102683, loss_d: 0.311762
0.2696 --- loss: 1.768263, loss_ss: 1.399507, loss_d: 0.368756
0.3082 --- loss: 1.461745, loss_ss: 0.889918, loss_d: 0.571827
0.3467 --- loss: 1.357621, loss_ss: 1.086584, loss_d: 0.271038
0.3852 --- loss: 1.645234, loss_ss: 1.340616, loss_d: 0.304618
0.4237 --- loss: 1.605077, loss_ss: 1.002726, loss_d: 0.602351
0.4622 --- loss: 1.386275, loss_ss: 1.010390, loss_d: 0.375886
0.5008 --- loss: 1.418088, loss_ss: 0.896330, loss_d: 0.521759
0.5393 --- loss: 1.778134, loss_ss: 1.222932, loss_d: 0.555202
0.5778 --- loss: 1.624575, loss_ss: 1.012239, loss_d: 0.612336
0.6163 --- loss: 1.555887, loss_ss: 1.050786, loss_d: 0.505100
0.6549 --- loss: 1.777017, loss_ss: 1.265900, loss_d: 0.511117
0.6934 --- loss: 1.567712, loss_ss: 0.999164, loss_d: 0.568548
0.7319 --- loss: 1.249520, loss_ss: 0.997224, loss_d: 0.252296
0.7704 --- loss: 1.847859, loss_ss: 1.394205, loss_d: 0.453654
0.8089 --- loss: 1.334797, loss_ss: 0.887296, loss_d: 0.447501
0.8475 --- loss: 1.565171, loss_ss: 1.106109, loss_d: 0.459062
0.8860 --- loss: 1.588249, loss_ss: 1.227631, loss_d: 0.360619
0.9245 --- loss: 1.310676, loss_ss: 0.963270, loss_d: 0.347406
0.9630 --- loss: 1.253597, loss_ss: 0.939792, loss_d: 0.313805
Epoch finished! Loss: 1.571425485795069
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.429721, loss_ss: 1.087148, loss_d: 0.342573
0.0385 --- loss: 1.598392, loss_ss: 1.305326, loss_d: 0.293066
0.0770 --- loss: 1.769836, loss_ss: 1.467082, loss_d: 0.302754
0.1156 --- loss: 1.615063, loss_ss: 1.089640, loss_d: 0.525423
0.1541 --- loss: 1.553830, loss_ss: 1.169420, loss_d: 0.384410
0.1926 --- loss: 1.208776, loss_ss: 0.863729, loss_d: 0.345047
0.2311 --- loss: 1.458952, loss_ss: 0.925286, loss_d: 0.533666
0.2696 --- loss: 1.791669, loss_ss: 1.391680, loss_d: 0.399989
0.3082 --- loss: 1.692129, loss_ss: 1.359434, loss_d: 0.332694
0.3467 --- loss: 1.462446, loss_ss: 1.072119, loss_d: 0.390327
0.3852 --- loss: 1.474553, loss_ss: 1.099348, loss_d: 0.375205
0.4237 --- loss: 1.414202, loss_ss: 0.997813, loss_d: 0.416389
0.4622 --- loss: 1.265975, loss_ss: 0.899747, loss_d: 0.366228
0.5008 --- loss: 1.470630, loss_ss: 0.972474, loss_d: 0.498155
0.5393 --- loss: 1.487971, loss_ss: 1.164388, loss_d: 0.323583
0.5778 --- loss: 1.614249, loss_ss: 1.120369, loss_d: 0.493879
0.6163 --- loss: 1.984514, loss_ss: 1.208665, loss_d: 0.775849
0.6549 --- loss: 1.323304, loss_ss: 0.990906, loss_d: 0.332398
0.6934 --- loss: 1.661396, loss_ss: 1.388665, loss_d: 0.272731
0.7319 --- loss: 1.654205, loss_ss: 1.137300, loss_d: 0.516905
0.7704 --- loss: 1.513679, loss_ss: 1.061766, loss_d: 0.451913
0.8089 --- loss: 1.824917, loss_ss: 1.091824, loss_d: 0.733093
0.8475 --- loss: 1.658491, loss_ss: 1.217592, loss_d: 0.440900
0.8860 --- loss: 1.477247, loss_ss: 1.102035, loss_d: 0.375212
0.9245 --- loss: 1.410273, loss_ss: 0.801188, loss_d: 0.609086
0.9630 --- loss: 1.556984, loss_ss: 1.101129, loss_d: 0.455855
Epoch finished! Loss: 1.5550724571736163
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.111635, loss_ss: 1.284653, loss_d: 0.826982
0.0385 --- loss: 1.453576, loss_ss: 0.843562, loss_d: 0.610013
0.0770 --- loss: 1.267222, loss_ss: 0.984575, loss_d: 0.282647
0.1156 --- loss: 1.419137, loss_ss: 1.199354, loss_d: 0.219784
0.1541 --- loss: 1.412117, loss_ss: 0.995042, loss_d: 0.417075
0.1926 --- loss: 1.426206, loss_ss: 1.108621, loss_d: 0.317584
0.2311 --- loss: 1.657200, loss_ss: 1.126151, loss_d: 0.531049
0.2696 --- loss: 1.567832, loss_ss: 1.126252, loss_d: 0.441580
0.3082 --- loss: 2.175049, loss_ss: 1.151723, loss_d: 1.023326
0.3467 --- loss: 1.323706, loss_ss: 0.854578, loss_d: 0.469128
0.3852 --- loss: 1.457261, loss_ss: 1.039847, loss_d: 0.417414
0.4237 --- loss: 1.757233, loss_ss: 1.076660, loss_d: 0.680573
0.4622 --- loss: 1.518201, loss_ss: 1.022122, loss_d: 0.496079
0.5008 --- loss: 1.413780, loss_ss: 1.129363, loss_d: 0.284417
0.5393 --- loss: 1.461138, loss_ss: 1.086521, loss_d: 0.374616
0.5778 --- loss: 1.309580, loss_ss: 1.094196, loss_d: 0.215384
0.6163 --- loss: 1.747553, loss_ss: 1.165607, loss_d: 0.581947
0.6549 --- loss: 1.669569, loss_ss: 1.240826, loss_d: 0.428743
0.6934 --- loss: 2.175358, loss_ss: 1.386710, loss_d: 0.788648
0.7319 --- loss: 1.579557, loss_ss: 0.924118, loss_d: 0.655439
0.7704 --- loss: 1.665939, loss_ss: 1.050632, loss_d: 0.615307
0.8089 --- loss: 1.364078, loss_ss: 0.827622, loss_d: 0.536456
0.8475 --- loss: 1.632792, loss_ss: 1.057230, loss_d: 0.575563
0.8860 --- loss: 1.573577, loss_ss: 1.047954, loss_d: 0.525624
0.9245 --- loss: 1.900672, loss_ss: 1.195952, loss_d: 0.704720
0.9630 --- loss: 1.785758, loss_ss: 1.376650, loss_d: 0.409108
Epoch finished! Loss: 1.5320662052935154
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.42777777777777776
             precision    recall  f1-score   support

        0.0       0.74      0.58      0.65       237
        1.0       0.00      0.00      0.00       167
        2.0       0.90      0.25      0.39       563
        3.0       0.00      0.00      0.00         8
        4.0       0.29      0.92      0.44       285

avg / total       0.61      0.43      0.40      1260
 


====== chp036-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  88.25  57.81   95.31  74.05     64.93
1  86.75   0.00  100.00   0.00      0.00
2  65.16  24.69   97.85  90.26     38.77
3  98.02   0.00   98.64   0.00      0.00
4  47.38  92.28   34.26  29.09     44.24
Total accuracy: 42.78%
Average sen: 34.96%
Average spec: 85.21%
Macro f1-score: 29.59%
[0.09800526 0.13567661 0.14486626 0.12094861 0.11139987 0.11169843
 0.13895819 0.13015068 0.12021618 0.12170212 0.13470581 0.12616543
 0.14232631 0.13768579 0.14497939 0.15563853 0.15243174 0.16360396
 0.14112882 0.13218148 0.13131788 0.12684569 0.11891815 0.12998697
 0.12877356 0.14398183 0.12981117 0.15783139 0.13794413 0.14014304
 0.13991186 0.1332285  0.12707843 0.13520166 0.16000958 0.15790723
 0.14688659 0.1442091  0.13572922 0.14038561 0.15826066 0.14043024]
pred: 0.13641099880139032, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.243979, loss_ss: 1.508345, loss_d: 0.735633
0.0384 --- loss: 2.777174, loss_ss: 1.725301, loss_d: 1.051874
0.0768 --- loss: 2.117148, loss_ss: 1.416452, loss_d: 0.700696
0.1152 --- loss: 2.084118, loss_ss: 1.698232, loss_d: 0.385886
0.1536 --- loss: 1.827812, loss_ss: 1.453464, loss_d: 0.374348
0.1920 --- loss: 2.141891, loss_ss: 1.525950, loss_d: 0.615941
0.2304 --- loss: 1.852483, loss_ss: 1.479396, loss_d: 0.373087
0.2688 --- loss: 2.013858, loss_ss: 1.538281, loss_d: 0.475577
0.3072 --- loss: 1.877175, loss_ss: 1.457401, loss_d: 0.419775
0.3456 --- loss: 2.391715, loss_ss: 1.631003, loss_d: 0.760712
0.3840 --- loss: 2.171570, loss_ss: 1.371966, loss_d: 0.799604
0.4224 --- loss: 2.277824, loss_ss: 1.618988, loss_d: 0.658836
0.4608 --- loss: 2.122610, loss_ss: 1.590283, loss_d: 0.532327
0.4992 --- loss: 2.356518, loss_ss: 1.562586, loss_d: 0.793932
0.5376 --- loss: 1.947783, loss_ss: 1.401462, loss_d: 0.546320
0.5760 --- loss: 2.012793, loss_ss: 1.589759, loss_d: 0.423033
0.6144 --- loss: 1.852165, loss_ss: 1.424778, loss_d: 0.427387
0.6528 --- loss: 1.848275, loss_ss: 1.482928, loss_d: 0.365347
0.6912 --- loss: 2.224625, loss_ss: 1.512504, loss_d: 0.712120
0.7296 --- loss: 1.813937, loss_ss: 1.492808, loss_d: 0.321129
0.7680 --- loss: 2.215277, loss_ss: 1.514742, loss_d: 0.700535
0.8065 --- loss: 1.958166, loss_ss: 1.574749, loss_d: 0.383417
0.8449 --- loss: 1.802994, loss_ss: 1.260541, loss_d: 0.542453
0.8833 --- loss: 1.699380, loss_ss: 1.351880, loss_d: 0.347500
0.9217 --- loss: 1.777357, loss_ss: 1.461277, loss_d: 0.316079
0.9601 --- loss: 2.070000, loss_ss: 1.681285, loss_d: 0.388715
0.9985 --- loss: 1.595370, loss_ss: 1.266611, loss_d: 0.328758
Epoch finished! Loss: 2.0547255428937765
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.882944, loss_ss: 1.501167, loss_d: 0.381777
0.0384 --- loss: 1.911592, loss_ss: 1.473271, loss_d: 0.438321
0.0768 --- loss: 1.827500, loss_ss: 1.550469, loss_d: 0.277031
0.1152 --- loss: 2.510044, loss_ss: 1.420726, loss_d: 1.089317
0.1536 --- loss: 1.793567, loss_ss: 1.383178, loss_d: 0.410389
0.1920 --- loss: 2.256271, loss_ss: 1.515473, loss_d: 0.740798
0.2304 --- loss: 2.115290, loss_ss: 1.366620, loss_d: 0.748671
0.2688 --- loss: 1.963921, loss_ss: 1.371387, loss_d: 0.592534
0.3072 --- loss: 1.981976, loss_ss: 1.279476, loss_d: 0.702500
0.3456 --- loss: 1.860323, loss_ss: 1.353084, loss_d: 0.507239
0.3840 --- loss: 2.156315, loss_ss: 1.582129, loss_d: 0.574186
0.4224 --- loss: 1.665691, loss_ss: 1.240171, loss_d: 0.425520
0.4608 --- loss: 1.918006, loss_ss: 1.455506, loss_d: 0.462500
0.4992 --- loss: 1.906183, loss_ss: 1.376355, loss_d: 0.529828
0.5376 --- loss: 1.988400, loss_ss: 1.447435, loss_d: 0.540965
0.5760 --- loss: 1.665273, loss_ss: 1.272624, loss_d: 0.392650
0.6144 --- loss: 1.468232, loss_ss: 1.147260, loss_d: 0.320972
0.6528 --- loss: 1.586971, loss_ss: 1.259965, loss_d: 0.327006
0.6912 --- loss: 2.289778, loss_ss: 1.635074, loss_d: 0.654704
0.7296 --- loss: 1.796900, loss_ss: 1.332955, loss_d: 0.463945
0.7680 --- loss: 1.543810, loss_ss: 1.187510, loss_d: 0.356300
0.8065 --- loss: 1.555598, loss_ss: 1.200953, loss_d: 0.354645
0.8449 --- loss: 1.748043, loss_ss: 1.097727, loss_d: 0.650316
0.8833 --- loss: 1.925703, loss_ss: 1.455405, loss_d: 0.470298
0.9217 --- loss: 1.734550, loss_ss: 1.422720, loss_d: 0.311830
0.9601 --- loss: 1.697335, loss_ss: 1.326226, loss_d: 0.371109
0.9985 --- loss: 1.662047, loss_ss: 1.157638, loss_d: 0.504409
Epoch finished! Loss: 1.9103088828233572
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.062318, loss_ss: 1.348940, loss_d: 0.713377
0.0384 --- loss: 1.689958, loss_ss: 1.340903, loss_d: 0.349056
0.0768 --- loss: 1.797997, loss_ss: 1.406635, loss_d: 0.391362
0.1152 --- loss: 1.671953, loss_ss: 1.212143, loss_d: 0.459810
0.1536 --- loss: 1.842564, loss_ss: 1.472812, loss_d: 0.369752
0.1920 --- loss: 1.913640, loss_ss: 1.402596, loss_d: 0.511044
0.2304 --- loss: 1.943726, loss_ss: 1.283895, loss_d: 0.659831
0.2688 --- loss: 1.808596, loss_ss: 1.306296, loss_d: 0.502301
0.3072 --- loss: 1.715770, loss_ss: 1.238811, loss_d: 0.476959
0.3456 --- loss: 1.652779, loss_ss: 1.210369, loss_d: 0.442411
0.3840 --- loss: 1.737908, loss_ss: 1.414398, loss_d: 0.323511
0.4224 --- loss: 1.925039, loss_ss: 1.389120, loss_d: 0.535919
0.4608 --- loss: 1.971448, loss_ss: 1.516690, loss_d: 0.454758
0.4992 --- loss: 2.001876, loss_ss: 1.391895, loss_d: 0.609981
0.5376 --- loss: 1.716237, loss_ss: 1.234857, loss_d: 0.481380
0.5760 --- loss: 1.673245, loss_ss: 1.300303, loss_d: 0.372943
0.6144 --- loss: 1.558538, loss_ss: 1.195663, loss_d: 0.362875
0.6528 --- loss: 1.597106, loss_ss: 1.151967, loss_d: 0.445139
0.6912 --- loss: 1.356704, loss_ss: 1.085568, loss_d: 0.271136
0.7296 --- loss: 1.577439, loss_ss: 1.202835, loss_d: 0.374604
0.7680 --- loss: 1.605595, loss_ss: 1.185167, loss_d: 0.420428
0.8065 --- loss: 1.698605, loss_ss: 1.278717, loss_d: 0.419888
0.8449 --- loss: 1.856683, loss_ss: 1.273548, loss_d: 0.583135
0.8833 --- loss: 2.199033, loss_ss: 1.233219, loss_d: 0.965814
0.9217 --- loss: 1.335283, loss_ss: 0.946289, loss_d: 0.388994
0.9601 --- loss: 1.538758, loss_ss: 1.220160, loss_d: 0.318598
0.9985 --- loss: 1.663857, loss_ss: 1.284743, loss_d: 0.379114
Epoch finished! Loss: 1.7807637283435234
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.668227, loss_ss: 1.335312, loss_d: 0.332915
0.0384 --- loss: 2.072052, loss_ss: 1.261155, loss_d: 0.810897
0.0768 --- loss: 1.552483, loss_ss: 1.194842, loss_d: 0.357641
0.1152 --- loss: 1.567715, loss_ss: 1.081475, loss_d: 0.486240
0.1536 --- loss: 1.720617, loss_ss: 1.301421, loss_d: 0.419197
0.1920 --- loss: 1.657133, loss_ss: 1.284831, loss_d: 0.372302
0.2304 --- loss: 1.496012, loss_ss: 1.083714, loss_d: 0.412298
0.2688 --- loss: 2.199922, loss_ss: 1.103585, loss_d: 1.096337
0.3072 --- loss: 1.583103, loss_ss: 1.257333, loss_d: 0.325769
0.3456 --- loss: 1.606661, loss_ss: 1.200620, loss_d: 0.406041
0.3840 --- loss: 1.788465, loss_ss: 1.083458, loss_d: 0.705007
0.4224 --- loss: 1.643031, loss_ss: 1.139262, loss_d: 0.503768
0.4608 --- loss: 1.671378, loss_ss: 1.256441, loss_d: 0.414937
0.4992 --- loss: 2.259773, loss_ss: 1.226532, loss_d: 1.033242
0.5376 --- loss: 1.570394, loss_ss: 1.243550, loss_d: 0.326844
0.5760 --- loss: 1.521374, loss_ss: 1.005743, loss_d: 0.515630
0.6144 --- loss: 2.230731, loss_ss: 1.740360, loss_d: 0.490370
0.6528 --- loss: 1.507405, loss_ss: 1.030362, loss_d: 0.477043
0.6912 --- loss: 1.279916, loss_ss: 0.967547, loss_d: 0.312369
0.7296 --- loss: 1.565986, loss_ss: 1.117327, loss_d: 0.448658
0.7680 --- loss: 1.567038, loss_ss: 1.064504, loss_d: 0.502533
0.8065 --- loss: 1.601333, loss_ss: 1.176556, loss_d: 0.424777
0.8449 --- loss: 1.490242, loss_ss: 1.062389, loss_d: 0.427853
0.8833 --- loss: 1.485449, loss_ss: 1.096452, loss_d: 0.388997
0.9217 --- loss: 1.452386, loss_ss: 1.095006, loss_d: 0.357381
0.9601 --- loss: 1.649595, loss_ss: 1.038105, loss_d: 0.611490
0.9985 --- loss: 2.396101, loss_ss: 1.460290, loss_d: 0.935812
Epoch finished! Loss: 1.675843947667342
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.037127, loss_ss: 1.554502, loss_d: 0.482625
0.0384 --- loss: 2.010003, loss_ss: 1.271003, loss_d: 0.739000
0.0768 --- loss: 1.811438, loss_ss: 1.143494, loss_d: 0.667945
0.1152 --- loss: 1.479639, loss_ss: 1.066297, loss_d: 0.413342
0.1536 --- loss: 1.261981, loss_ss: 0.920283, loss_d: 0.341698
0.1920 --- loss: 1.714782, loss_ss: 1.401358, loss_d: 0.313424
0.2304 --- loss: 1.593747, loss_ss: 1.278241, loss_d: 0.315506
0.2688 --- loss: 1.665754, loss_ss: 1.031505, loss_d: 0.634249
0.3072 --- loss: 2.982022, loss_ss: 1.198772, loss_d: 1.783250
0.3456 --- loss: 1.632055, loss_ss: 1.033080, loss_d: 0.598975
0.3840 --- loss: 1.572148, loss_ss: 1.081270, loss_d: 0.490877
0.4224 --- loss: 1.714340, loss_ss: 1.159993, loss_d: 0.554347
0.4608 --- loss: 1.496137, loss_ss: 1.171518, loss_d: 0.324619
0.4992 --- loss: 1.643699, loss_ss: 1.021517, loss_d: 0.622182
0.5376 --- loss: 1.473535, loss_ss: 1.104729, loss_d: 0.368806
0.5760 --- loss: 1.693269, loss_ss: 1.017565, loss_d: 0.675704
0.6144 --- loss: 1.986302, loss_ss: 1.466186, loss_d: 0.520116
0.6528 --- loss: 1.585994, loss_ss: 1.211274, loss_d: 0.374720
0.6912 --- loss: 1.483228, loss_ss: 1.138077, loss_d: 0.345151
0.7296 --- loss: 1.313605, loss_ss: 1.021735, loss_d: 0.291870
0.7680 --- loss: 1.378621, loss_ss: 0.896217, loss_d: 0.482404
0.8065 --- loss: 1.776852, loss_ss: 1.448539, loss_d: 0.328313
0.8449 --- loss: 1.631291, loss_ss: 1.037755, loss_d: 0.593536
0.8833 --- loss: 1.535974, loss_ss: 1.110066, loss_d: 0.425908
0.9217 --- loss: 2.089748, loss_ss: 1.691074, loss_d: 0.398674
0.9601 --- loss: 1.693816, loss_ss: 1.171433, loss_d: 0.522383
0.9985 --- loss: 2.146374, loss_ss: 1.797863, loss_d: 0.348511
Epoch finished! Loss: 1.6366125831237206
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.739004, loss_ss: 1.269157, loss_d: 0.469847
0.0384 --- loss: 1.478570, loss_ss: 1.126140, loss_d: 0.352430
0.0768 --- loss: 1.596889, loss_ss: 1.269246, loss_d: 0.327643
0.1152 --- loss: 2.052401, loss_ss: 1.560033, loss_d: 0.492368
0.1536 --- loss: 1.546435, loss_ss: 0.944983, loss_d: 0.601452
0.1920 --- loss: 1.706778, loss_ss: 1.293102, loss_d: 0.413676
0.2304 --- loss: 1.480898, loss_ss: 0.976712, loss_d: 0.504185
0.2688 --- loss: 1.513114, loss_ss: 1.194777, loss_d: 0.318337
0.3072 --- loss: 1.459524, loss_ss: 1.049270, loss_d: 0.410254
0.3456 --- loss: 1.608320, loss_ss: 1.195632, loss_d: 0.412688
0.3840 --- loss: 1.445762, loss_ss: 1.047060, loss_d: 0.398702
0.4224 --- loss: 1.836720, loss_ss: 1.445084, loss_d: 0.391636
0.4608 --- loss: 1.765946, loss_ss: 1.094040, loss_d: 0.671906
0.4992 --- loss: 1.420707, loss_ss: 1.029338, loss_d: 0.391369
0.5376 --- loss: 1.695316, loss_ss: 1.365314, loss_d: 0.330002
0.5760 --- loss: 2.091642, loss_ss: 1.658298, loss_d: 0.433345
0.6144 --- loss: 1.635934, loss_ss: 0.970653, loss_d: 0.665281
0.6528 --- loss: 1.615625, loss_ss: 1.328569, loss_d: 0.287056
0.6912 --- loss: 1.660695, loss_ss: 1.298649, loss_d: 0.362046
0.7296 --- loss: 1.820039, loss_ss: 1.272787, loss_d: 0.547252
0.7680 --- loss: 1.596536, loss_ss: 1.262057, loss_d: 0.334479
0.8065 --- loss: 1.393659, loss_ss: 1.021490, loss_d: 0.372169
0.8449 --- loss: 1.532130, loss_ss: 1.095386, loss_d: 0.436744
0.8833 --- loss: 1.764356, loss_ss: 0.879115, loss_d: 0.885241
0.9217 --- loss: 1.907790, loss_ss: 1.211896, loss_d: 0.695894
0.9601 --- loss: 1.432752, loss_ss: 1.039147, loss_d: 0.393605
0.9985 --- loss: 2.197316, loss_ss: 1.773875, loss_d: 0.423441
Epoch finished! Loss: 1.6034039648679586
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.320289, loss_ss: 0.963699, loss_d: 0.356591
0.0384 --- loss: 1.521652, loss_ss: 1.166785, loss_d: 0.354867
0.0768 --- loss: 1.437665, loss_ss: 1.086678, loss_d: 0.350987
0.1152 --- loss: 1.435907, loss_ss: 1.091824, loss_d: 0.344083
0.1536 --- loss: 1.704471, loss_ss: 1.044012, loss_d: 0.660458
0.1920 --- loss: 1.199871, loss_ss: 0.758966, loss_d: 0.440904
0.2304 --- loss: 1.663172, loss_ss: 1.192308, loss_d: 0.470864
0.2688 --- loss: 1.449561, loss_ss: 1.066231, loss_d: 0.383330
0.3072 --- loss: 1.695974, loss_ss: 1.193032, loss_d: 0.502942
0.3456 --- loss: 1.554569, loss_ss: 1.221013, loss_d: 0.333557
0.3840 --- loss: 1.289616, loss_ss: 0.930166, loss_d: 0.359451
0.4224 --- loss: 1.133007, loss_ss: 0.737495, loss_d: 0.395512
0.4608 --- loss: 1.743252, loss_ss: 1.148504, loss_d: 0.594748
0.4992 --- loss: 1.804778, loss_ss: 1.113083, loss_d: 0.691694
0.5376 --- loss: 1.653051, loss_ss: 1.023199, loss_d: 0.629852
0.5760 --- loss: 1.392437, loss_ss: 1.042494, loss_d: 0.349944
0.6144 --- loss: 1.523865, loss_ss: 1.094446, loss_d: 0.429419
0.6528 --- loss: 1.550658, loss_ss: 1.203820, loss_d: 0.346838
0.6912 --- loss: 1.440333, loss_ss: 1.102442, loss_d: 0.337891
0.7296 --- loss: 1.256899, loss_ss: 0.881801, loss_d: 0.375099
0.7680 --- loss: 1.393287, loss_ss: 1.040415, loss_d: 0.352872
0.8065 --- loss: 1.656896, loss_ss: 1.323416, loss_d: 0.333480
0.8449 --- loss: 1.182530, loss_ss: 0.831449, loss_d: 0.351081
0.8833 --- loss: 1.721538, loss_ss: 1.238841, loss_d: 0.482697
0.9217 --- loss: 1.982731, loss_ss: 1.682804, loss_d: 0.299927
0.9601 --- loss: 1.351816, loss_ss: 0.822227, loss_d: 0.529589
0.9985 --- loss: 1.459622, loss_ss: 1.136920, loss_d: 0.322702
Epoch finished! Loss: 1.5630928195439853
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.461147, loss_ss: 1.108332, loss_d: 0.352816
0.0384 --- loss: 1.377767, loss_ss: 0.880469, loss_d: 0.497298
0.0768 --- loss: 1.152936, loss_ss: 0.830005, loss_d: 0.322931
0.1152 --- loss: 1.361429, loss_ss: 0.933067, loss_d: 0.428362
0.1536 --- loss: 1.667798, loss_ss: 1.327294, loss_d: 0.340504
0.1920 --- loss: 1.188547, loss_ss: 0.881028, loss_d: 0.307519
0.2304 --- loss: 1.731994, loss_ss: 1.193091, loss_d: 0.538903
0.2688 --- loss: 1.557672, loss_ss: 1.162582, loss_d: 0.395091
0.3072 --- loss: 1.866937, loss_ss: 1.459246, loss_d: 0.407692
0.3456 --- loss: 1.130843, loss_ss: 0.883387, loss_d: 0.247456
0.3840 --- loss: 1.297750, loss_ss: 0.970384, loss_d: 0.327366
0.4224 --- loss: 1.559448, loss_ss: 1.180311, loss_d: 0.379136
0.4608 --- loss: 1.422341, loss_ss: 0.924209, loss_d: 0.498132
0.4992 --- loss: 1.989552, loss_ss: 1.191198, loss_d: 0.798355
0.5376 --- loss: 1.432176, loss_ss: 1.059959, loss_d: 0.372217
0.5760 --- loss: 1.591635, loss_ss: 1.212827, loss_d: 0.378808
0.6144 --- loss: 1.662129, loss_ss: 1.130090, loss_d: 0.532038
0.6528 --- loss: 1.649911, loss_ss: 1.077275, loss_d: 0.572636
0.6912 --- loss: 1.351137, loss_ss: 1.027891, loss_d: 0.323246
0.7296 --- loss: 1.861900, loss_ss: 1.362200, loss_d: 0.499700
0.7680 --- loss: 1.588005, loss_ss: 1.011802, loss_d: 0.576203
0.8065 --- loss: 1.294255, loss_ss: 0.975728, loss_d: 0.318526
0.8449 --- loss: 1.359474, loss_ss: 1.085728, loss_d: 0.273746
0.8833 --- loss: 1.641323, loss_ss: 1.027184, loss_d: 0.614139
0.9217 --- loss: 2.092274, loss_ss: 1.250132, loss_d: 0.842143
0.9601 --- loss: 1.454970, loss_ss: 0.937833, loss_d: 0.517137
0.9985 --- loss: 1.841000, loss_ss: 1.601957, loss_d: 0.239043
Epoch finished! Loss: 1.5244681101578932
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.257966, loss_ss: 0.906594, loss_d: 0.351371
0.0384 --- loss: 1.355014, loss_ss: 1.033462, loss_d: 0.321553
0.0768 --- loss: 1.228584, loss_ss: 0.927258, loss_d: 0.301325
0.1152 --- loss: 1.517244, loss_ss: 1.140511, loss_d: 0.376733
0.1536 --- loss: 1.315088, loss_ss: 1.009069, loss_d: 0.306019
0.1920 --- loss: 1.171487, loss_ss: 0.943544, loss_d: 0.227943
0.2304 --- loss: 1.195968, loss_ss: 0.772657, loss_d: 0.423311
0.2688 --- loss: 1.549767, loss_ss: 1.086218, loss_d: 0.463549
0.3072 --- loss: 1.999101, loss_ss: 1.583975, loss_d: 0.415125
0.3456 --- loss: 1.998707, loss_ss: 1.626760, loss_d: 0.371948
0.3840 --- loss: 1.541600, loss_ss: 1.092948, loss_d: 0.448652
0.4224 --- loss: 1.139665, loss_ss: 0.860058, loss_d: 0.279607
0.4608 --- loss: 1.569605, loss_ss: 1.074091, loss_d: 0.495514
0.4992 --- loss: 1.860905, loss_ss: 1.275630, loss_d: 0.585274
0.5376 --- loss: 2.072482, loss_ss: 1.498046, loss_d: 0.574436
0.5760 --- loss: 1.357459, loss_ss: 0.974993, loss_d: 0.382466
0.6144 --- loss: 1.304961, loss_ss: 0.895481, loss_d: 0.409480
0.6528 --- loss: 1.472924, loss_ss: 1.077828, loss_d: 0.395096
0.6912 --- loss: 1.215578, loss_ss: 0.796373, loss_d: 0.419205
0.7296 --- loss: 2.796126, loss_ss: 1.070510, loss_d: 1.725615
0.7680 --- loss: 1.610288, loss_ss: 1.110241, loss_d: 0.500047
0.8065 --- loss: 1.499096, loss_ss: 0.932102, loss_d: 0.566993
0.8449 --- loss: 1.595751, loss_ss: 1.341553, loss_d: 0.254199
0.8833 --- loss: 1.610287, loss_ss: 1.032339, loss_d: 0.577949
0.9217 --- loss: 1.798858, loss_ss: 1.542748, loss_d: 0.256110
0.9601 --- loss: 1.524843, loss_ss: 1.209197, loss_d: 0.315646
0.9985 --- loss: 1.239997, loss_ss: 0.894983, loss_d: 0.345014
Epoch finished! Loss: 1.5155510929914622
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.589290, loss_ss: 0.866314, loss_d: 0.722975
0.0384 --- loss: 1.369082, loss_ss: 1.118895, loss_d: 0.250187
0.0768 --- loss: 1.716867, loss_ss: 1.450826, loss_d: 0.266041
0.1152 --- loss: 1.497945, loss_ss: 0.910819, loss_d: 0.587125
0.1536 --- loss: 1.434836, loss_ss: 1.170465, loss_d: 0.264371
0.1920 --- loss: 1.420771, loss_ss: 0.996534, loss_d: 0.424238
0.2304 --- loss: 1.271808, loss_ss: 1.035400, loss_d: 0.236408
0.2688 --- loss: 1.550231, loss_ss: 1.176634, loss_d: 0.373597
0.3072 --- loss: 1.439858, loss_ss: 1.034922, loss_d: 0.404936
0.3456 --- loss: 1.620497, loss_ss: 1.318380, loss_d: 0.302117
0.3840 --- loss: 2.261946, loss_ss: 1.307481, loss_d: 0.954465
0.4224 --- loss: 1.255219, loss_ss: 0.751517, loss_d: 0.503702
0.4608 --- loss: 1.399101, loss_ss: 1.056455, loss_d: 0.342645
0.4992 --- loss: 1.340003, loss_ss: 0.962343, loss_d: 0.377660
0.5376 --- loss: 1.291348, loss_ss: 1.042989, loss_d: 0.248359
0.5760 --- loss: 1.505618, loss_ss: 1.039389, loss_d: 0.466228
0.6144 --- loss: 2.211267, loss_ss: 1.734985, loss_d: 0.476281
0.6528 --- loss: 1.264857, loss_ss: 0.734056, loss_d: 0.530802
0.6912 --- loss: 1.659722, loss_ss: 1.141415, loss_d: 0.518308
0.7296 --- loss: 1.338219, loss_ss: 0.941443, loss_d: 0.396777
0.7680 --- loss: 1.011319, loss_ss: 0.778703, loss_d: 0.232616
0.8065 --- loss: 1.312219, loss_ss: 0.903065, loss_d: 0.409154
0.8449 --- loss: 1.425010, loss_ss: 0.912228, loss_d: 0.512782
0.8833 --- loss: 1.514472, loss_ss: 1.002791, loss_d: 0.511681
0.9217 --- loss: 1.270285, loss_ss: 1.043792, loss_d: 0.226493
0.9601 --- loss: 1.446794, loss_ss: 0.948296, loss_d: 0.498498
0.9985 --- loss: 2.361654, loss_ss: 2.009883, loss_d: 0.351771
Epoch finished! Loss: 1.4929394772419562
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00       197
        1.0       0.00      0.00      0.00       161
        2.0       0.44      0.97      0.60       348
        3.0       0.69      0.83      0.76       208
        4.0       0.00      0.00      0.00       104

avg / total       0.29      0.50      0.36      1018
 


====== chp037-nsrr ======

The ppr of  0  has ZeroDivisionError.


The f1-score of  0  has ZeroDivisionError.


The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  80.65   0.00  100.00   0.00      0.00
1  84.18   0.00  100.00   0.00      0.00
2  56.29  96.55   35.37  43.69     60.16
3  89.10  83.17   90.62  69.48     75.71
4  89.78   0.00  100.00   0.00      0.00
Total accuracy: 50.00%
Average sen: 35.94%
Average spec: 85.20%
Macro f1-score: 27.17%
[0.34232891 0.63128209 0.71722823 0.42303887 0.22344822 0.25348967
 0.33942461 0.26248354 0.21230644 0.26214916 0.20823312 0.22074577
 0.66416276 0.24704818 0.27428249 0.22486725 0.42302471 0.72479361
 0.23415603 0.6250186  0.21454839 0.19869074 0.2341291  0.22043286
 0.30461234 0.7057938  0.19803922 0.21138372 0.3905887  0.59976333
 0.2772333  0.34356043 0.28381547 0.2686998 ]
pred: 0.3519059840370627, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.559788, loss_ss: 1.905602, loss_d: 0.654186
0.0384 --- loss: 2.890898, loss_ss: 2.212930, loss_d: 0.677968
0.0768 --- loss: 2.361864, loss_ss: 1.760743, loss_d: 0.601121
0.1152 --- loss: 2.548298, loss_ss: 1.907704, loss_d: 0.640594
0.1536 --- loss: 2.225629, loss_ss: 1.610181, loss_d: 0.615448
0.1920 --- loss: 2.429187, loss_ss: 2.035632, loss_d: 0.393555
0.2304 --- loss: 2.410660, loss_ss: 1.776383, loss_d: 0.634277
0.2688 --- loss: 2.238551, loss_ss: 1.737008, loss_d: 0.501543
0.3072 --- loss: 2.694551, loss_ss: 2.082054, loss_d: 0.612498
0.3456 --- loss: 2.252845, loss_ss: 1.834064, loss_d: 0.418781
0.3840 --- loss: 2.600022, loss_ss: 1.874396, loss_d: 0.725626
0.4224 --- loss: 2.146308, loss_ss: 1.750193, loss_d: 0.396116
0.4608 --- loss: 2.249105, loss_ss: 1.740011, loss_d: 0.509094
0.4992 --- loss: 2.499252, loss_ss: 1.894102, loss_d: 0.605150
0.5376 --- loss: 2.437376, loss_ss: 1.783608, loss_d: 0.653768
0.5760 --- loss: 2.471305, loss_ss: 1.714549, loss_d: 0.756756
0.6144 --- loss: 1.941842, loss_ss: 1.630246, loss_d: 0.311596
0.6528 --- loss: 1.883682, loss_ss: 1.424218, loss_d: 0.459464
0.6912 --- loss: 2.541877, loss_ss: 1.866092, loss_d: 0.675785
0.7296 --- loss: 1.982939, loss_ss: 1.578677, loss_d: 0.404262
0.7680 --- loss: 2.060981, loss_ss: 1.729576, loss_d: 0.331405
0.8065 --- loss: 2.155026, loss_ss: 1.658381, loss_d: 0.496645
0.8449 --- loss: 1.982748, loss_ss: 1.563186, loss_d: 0.419562
0.8833 --- loss: 2.092113, loss_ss: 1.649252, loss_d: 0.442861
0.9217 --- loss: 2.191689, loss_ss: 1.641183, loss_d: 0.550506
0.9601 --- loss: 1.797836, loss_ss: 1.527883, loss_d: 0.269953
0.9985 --- loss: 1.986510, loss_ss: 1.633130, loss_d: 0.353380
Epoch finished! Loss: 2.2894561487894793
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.909272, loss_ss: 1.466007, loss_d: 0.443265
0.0384 --- loss: 2.061312, loss_ss: 1.664214, loss_d: 0.397098
0.0768 --- loss: 1.910735, loss_ss: 1.563696, loss_d: 0.347039
0.1152 --- loss: 1.914912, loss_ss: 1.568878, loss_d: 0.346034
0.1536 --- loss: 1.942812, loss_ss: 1.556283, loss_d: 0.386530
0.1920 --- loss: 2.048503, loss_ss: 1.607242, loss_d: 0.441261
0.2304 --- loss: 1.926621, loss_ss: 1.587217, loss_d: 0.339403
0.2688 --- loss: 2.033877, loss_ss: 1.525064, loss_d: 0.508813
0.3072 --- loss: 2.211875, loss_ss: 1.589517, loss_d: 0.622358
0.3456 --- loss: 2.036251, loss_ss: 1.561050, loss_d: 0.475201
0.3840 --- loss: 2.351616, loss_ss: 1.519070, loss_d: 0.832546
0.4224 --- loss: 1.832682, loss_ss: 1.508397, loss_d: 0.324286
0.4608 --- loss: 2.000911, loss_ss: 1.657704, loss_d: 0.343206
0.4992 --- loss: 1.892284, loss_ss: 1.480362, loss_d: 0.411923
0.5376 --- loss: 1.910169, loss_ss: 1.408697, loss_d: 0.501472
0.5760 --- loss: 1.914831, loss_ss: 1.485371, loss_d: 0.429459
0.6144 --- loss: 1.976506, loss_ss: 1.416367, loss_d: 0.560139
0.6528 --- loss: 1.840559, loss_ss: 1.320850, loss_d: 0.519709
0.6912 --- loss: 2.117990, loss_ss: 1.664089, loss_d: 0.453901
0.7296 --- loss: 1.907000, loss_ss: 1.522954, loss_d: 0.384046
0.7680 --- loss: 1.752064, loss_ss: 1.374410, loss_d: 0.377654
0.8065 --- loss: 1.864742, loss_ss: 1.557618, loss_d: 0.307124
0.8449 --- loss: 1.617965, loss_ss: 1.341488, loss_d: 0.276477
0.8833 --- loss: 2.077484, loss_ss: 1.541833, loss_d: 0.535651
0.9217 --- loss: 1.892925, loss_ss: 1.360414, loss_d: 0.532511
0.9601 --- loss: 1.835441, loss_ss: 1.481652, loss_d: 0.353789
0.9985 --- loss: 1.821430, loss_ss: 1.301441, loss_d: 0.519989
Epoch finished! Loss: 2.022955258534505
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.875093, loss_ss: 1.456036, loss_d: 0.419057
0.0384 --- loss: 1.794226, loss_ss: 1.361309, loss_d: 0.432917
0.0768 --- loss: 1.970453, loss_ss: 1.512552, loss_d: 0.457900
0.1152 --- loss: 1.733458, loss_ss: 1.419369, loss_d: 0.314089
0.1536 --- loss: 2.076915, loss_ss: 1.298316, loss_d: 0.778599
0.1920 --- loss: 1.877239, loss_ss: 1.427528, loss_d: 0.449711
0.2304 --- loss: 1.911153, loss_ss: 1.346094, loss_d: 0.565059
0.2688 --- loss: 1.589833, loss_ss: 1.139903, loss_d: 0.449930
0.3072 --- loss: 1.735259, loss_ss: 1.405088, loss_d: 0.330170
0.3456 --- loss: 1.632564, loss_ss: 1.316132, loss_d: 0.316432
0.3840 --- loss: 1.883025, loss_ss: 1.354421, loss_d: 0.528604
0.4224 --- loss: 1.654008, loss_ss: 1.209562, loss_d: 0.444446
0.4608 --- loss: 1.688046, loss_ss: 1.209155, loss_d: 0.478891
0.4992 --- loss: 2.148165, loss_ss: 1.205926, loss_d: 0.942239
0.5376 --- loss: 2.057452, loss_ss: 1.495851, loss_d: 0.561600
0.5760 --- loss: 2.207232, loss_ss: 1.457352, loss_d: 0.749880
0.6144 --- loss: 2.180742, loss_ss: 1.449717, loss_d: 0.731024
0.6528 --- loss: 1.962795, loss_ss: 1.499864, loss_d: 0.462931
0.6912 --- loss: 2.005618, loss_ss: 1.496823, loss_d: 0.508795
0.7296 --- loss: 2.239723, loss_ss: 1.304917, loss_d: 0.934806
0.7680 --- loss: 1.634444, loss_ss: 1.062896, loss_d: 0.571549
0.8065 --- loss: 1.805477, loss_ss: 1.349968, loss_d: 0.455509
0.8449 --- loss: 2.205513, loss_ss: 1.468709, loss_d: 0.736803
0.8833 --- loss: 1.958105, loss_ss: 1.644555, loss_d: 0.313550
0.9217 --- loss: 1.726033, loss_ss: 1.247325, loss_d: 0.478708
0.9601 --- loss: 1.553723, loss_ss: 1.186579, loss_d: 0.367143
0.9985 --- loss: 1.901192, loss_ss: 1.531851, loss_d: 0.369341
Epoch finished! Loss: 1.8846994918126327
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.531128, loss_ss: 1.126113, loss_d: 0.405015
0.0384 --- loss: 1.747440, loss_ss: 1.331713, loss_d: 0.415727
0.0768 --- loss: 1.689335, loss_ss: 1.269089, loss_d: 0.420247
0.1152 --- loss: 1.685491, loss_ss: 1.304560, loss_d: 0.380930
0.1536 --- loss: 1.957238, loss_ss: 1.431705, loss_d: 0.525534
0.1920 --- loss: 1.894553, loss_ss: 1.524621, loss_d: 0.369932
0.2304 --- loss: 1.627938, loss_ss: 1.231949, loss_d: 0.395989
0.2688 --- loss: 1.901097, loss_ss: 1.398012, loss_d: 0.503084
0.3072 --- loss: 1.534363, loss_ss: 1.160811, loss_d: 0.373552
0.3456 --- loss: 2.145669, loss_ss: 1.793840, loss_d: 0.351829
0.3840 --- loss: 1.933705, loss_ss: 1.196129, loss_d: 0.737576
0.4224 --- loss: 1.963670, loss_ss: 1.346174, loss_d: 0.617496
0.4608 --- loss: 1.625780, loss_ss: 1.154135, loss_d: 0.471644
0.4992 --- loss: 1.870423, loss_ss: 1.439974, loss_d: 0.430449
0.5376 --- loss: 1.650927, loss_ss: 1.190822, loss_d: 0.460104
0.5760 --- loss: 1.746221, loss_ss: 1.314729, loss_d: 0.431492
0.6144 --- loss: 1.576190, loss_ss: 1.075117, loss_d: 0.501073
0.6528 --- loss: 1.682708, loss_ss: 1.256530, loss_d: 0.426178
0.6912 --- loss: 1.750993, loss_ss: 1.317568, loss_d: 0.433426
0.7296 --- loss: 1.507291, loss_ss: 0.993943, loss_d: 0.513348
0.7680 --- loss: 1.741826, loss_ss: 1.261611, loss_d: 0.480215
0.8065 --- loss: 1.598901, loss_ss: 1.265025, loss_d: 0.333875
0.8449 --- loss: 1.749201, loss_ss: 1.301665, loss_d: 0.447536
0.8833 --- loss: 1.589588, loss_ss: 1.082957, loss_d: 0.506631
0.9217 --- loss: 1.695212, loss_ss: 1.296029, loss_d: 0.399183
0.9601 --- loss: 1.764756, loss_ss: 1.358813, loss_d: 0.405943
0.9985 --- loss: 2.559934, loss_ss: 1.696345, loss_d: 0.863590
Epoch finished! Loss: 1.7834456984813396
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.446385, loss_ss: 1.139744, loss_d: 0.306641
0.0384 --- loss: 1.770072, loss_ss: 1.244863, loss_d: 0.525209
0.0768 --- loss: 1.797939, loss_ss: 1.347464, loss_d: 0.450475
0.1152 --- loss: 1.649717, loss_ss: 1.174919, loss_d: 0.474799
0.1536 --- loss: 1.588848, loss_ss: 1.172261, loss_d: 0.416587
0.1920 --- loss: 1.753270, loss_ss: 1.107454, loss_d: 0.645817
0.2304 --- loss: 1.422176, loss_ss: 1.048223, loss_d: 0.373953
0.2688 --- loss: 1.632328, loss_ss: 1.126545, loss_d: 0.505784
0.3072 --- loss: 1.712905, loss_ss: 1.271658, loss_d: 0.441247
0.3456 --- loss: 1.855062, loss_ss: 1.189528, loss_d: 0.665534
0.3840 --- loss: 1.617033, loss_ss: 1.227956, loss_d: 0.389078
0.4224 --- loss: 1.836571, loss_ss: 1.451466, loss_d: 0.385104
0.4608 --- loss: 1.517410, loss_ss: 1.138511, loss_d: 0.378898
0.4992 --- loss: 1.316779, loss_ss: 0.956667, loss_d: 0.360113
0.5376 --- loss: 1.811581, loss_ss: 1.446738, loss_d: 0.364843
0.5760 --- loss: 1.873177, loss_ss: 1.514339, loss_d: 0.358839
0.6144 --- loss: 2.015713, loss_ss: 1.310719, loss_d: 0.704995
0.6528 --- loss: 1.435518, loss_ss: 0.891912, loss_d: 0.543607
0.6912 --- loss: 1.918049, loss_ss: 1.570510, loss_d: 0.347539
0.7296 --- loss: 1.459406, loss_ss: 1.040130, loss_d: 0.419275
0.7680 --- loss: 1.429865, loss_ss: 1.106760, loss_d: 0.323105
0.8065 --- loss: 1.707129, loss_ss: 1.137033, loss_d: 0.570095
0.8449 --- loss: 1.527950, loss_ss: 1.120322, loss_d: 0.407628
0.8833 --- loss: 2.139108, loss_ss: 1.743866, loss_d: 0.395242
0.9217 --- loss: 1.688292, loss_ss: 1.233272, loss_d: 0.455019
0.9601 --- loss: 2.022014, loss_ss: 1.282612, loss_d: 0.739402
0.9985 --- loss: 1.937973, loss_ss: 1.468075, loss_d: 0.469898
Epoch finished! Loss: 1.6907167081649488
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.978853, loss_ss: 1.521710, loss_d: 0.457143
0.0384 --- loss: 1.909100, loss_ss: 1.435709, loss_d: 0.473391
0.0768 --- loss: 1.628386, loss_ss: 1.315216, loss_d: 0.313171
0.1152 --- loss: 1.841128, loss_ss: 1.020886, loss_d: 0.820242
0.1536 --- loss: 1.340808, loss_ss: 0.958017, loss_d: 0.382792
0.1920 --- loss: 1.289752, loss_ss: 0.912146, loss_d: 0.377606
0.2304 --- loss: 1.447127, loss_ss: 0.942866, loss_d: 0.504261
0.2688 --- loss: 1.626665, loss_ss: 1.052750, loss_d: 0.573914
0.3072 --- loss: 1.621141, loss_ss: 1.304996, loss_d: 0.316145
0.3456 --- loss: 1.544611, loss_ss: 1.174479, loss_d: 0.370132
0.3840 --- loss: 1.422719, loss_ss: 1.069446, loss_d: 0.353273
0.4224 --- loss: 1.731401, loss_ss: 1.275365, loss_d: 0.456036
0.4608 --- loss: 1.461524, loss_ss: 1.031353, loss_d: 0.430171
0.4992 --- loss: 1.476279, loss_ss: 0.996688, loss_d: 0.479591
0.5376 --- loss: 1.571835, loss_ss: 1.180004, loss_d: 0.391831
0.5760 --- loss: 1.275989, loss_ss: 0.895946, loss_d: 0.380042
0.6144 --- loss: 1.470794, loss_ss: 1.153518, loss_d: 0.317276
0.6528 --- loss: 1.313621, loss_ss: 1.036463, loss_d: 0.277158
0.6912 --- loss: 1.305987, loss_ss: 0.943505, loss_d: 0.362482
0.7296 --- loss: 1.678796, loss_ss: 1.056544, loss_d: 0.622252
0.7680 --- loss: 2.283504, loss_ss: 1.274745, loss_d: 1.008759
0.8065 --- loss: 1.762536, loss_ss: 1.436337, loss_d: 0.326198
0.8449 --- loss: 1.553295, loss_ss: 1.176268, loss_d: 0.377027
0.8833 --- loss: 1.334074, loss_ss: 0.946962, loss_d: 0.387112
0.9217 --- loss: 1.289121, loss_ss: 0.927825, loss_d: 0.361296
0.9601 --- loss: 1.551596, loss_ss: 1.219117, loss_d: 0.332479
0.9985 --- loss: 1.689025, loss_ss: 1.276834, loss_d: 0.412191
Epoch finished! Loss: 1.6498128739687112
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.454210, loss_ss: 1.063405, loss_d: 0.390804
0.0384 --- loss: 1.493549, loss_ss: 1.162157, loss_d: 0.331392
0.0768 --- loss: 1.578249, loss_ss: 1.289403, loss_d: 0.288846
0.1152 --- loss: 1.548340, loss_ss: 1.161867, loss_d: 0.386474
0.1536 --- loss: 1.583729, loss_ss: 1.133569, loss_d: 0.450160
0.1920 --- loss: 1.678124, loss_ss: 1.135121, loss_d: 0.543003
0.2304 --- loss: 1.807410, loss_ss: 0.955663, loss_d: 0.851746
0.2688 --- loss: 1.196548, loss_ss: 0.828479, loss_d: 0.368069
0.3072 --- loss: 1.439944, loss_ss: 1.082451, loss_d: 0.357493
0.3456 --- loss: 1.746197, loss_ss: 1.172088, loss_d: 0.574109
0.3840 --- loss: 1.719437, loss_ss: 1.200152, loss_d: 0.519285
0.4224 --- loss: 1.433406, loss_ss: 1.014591, loss_d: 0.418815
0.4608 --- loss: 1.800024, loss_ss: 0.933318, loss_d: 0.866706
0.4992 --- loss: 1.679187, loss_ss: 1.373601, loss_d: 0.305586
0.5376 --- loss: 1.587457, loss_ss: 1.280157, loss_d: 0.307300
0.5760 --- loss: 1.330280, loss_ss: 1.017237, loss_d: 0.313043
0.6144 --- loss: 1.509140, loss_ss: 1.156827, loss_d: 0.352313
0.6528 --- loss: 1.250474, loss_ss: 0.977995, loss_d: 0.272479
0.6912 --- loss: 1.922691, loss_ss: 1.135288, loss_d: 0.787403
0.7296 --- loss: 1.472029, loss_ss: 1.202509, loss_d: 0.269520
0.7680 --- loss: 1.586642, loss_ss: 1.112606, loss_d: 0.474036
0.8065 --- loss: 1.488672, loss_ss: 1.131520, loss_d: 0.357152
0.8449 --- loss: 1.258542, loss_ss: 0.903903, loss_d: 0.354639
0.8833 --- loss: 1.837715, loss_ss: 1.120413, loss_d: 0.717302
0.9217 --- loss: 1.444506, loss_ss: 0.996336, loss_d: 0.448171
0.9601 --- loss: 1.428639, loss_ss: 1.124673, loss_d: 0.303965
0.9985 --- loss: 1.321068, loss_ss: 0.976736, loss_d: 0.344332
Epoch finished! Loss: 1.605920475262862
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.434203, loss_ss: 1.027784, loss_d: 0.406420
0.0384 --- loss: 1.089600, loss_ss: 0.806742, loss_d: 0.282858
0.0768 --- loss: 1.838262, loss_ss: 1.072962, loss_d: 0.765300
0.1152 --- loss: 1.567345, loss_ss: 1.050110, loss_d: 0.517235
0.1536 --- loss: 1.428236, loss_ss: 1.019174, loss_d: 0.409062
0.1920 --- loss: 1.626699, loss_ss: 1.327193, loss_d: 0.299506
0.2304 --- loss: 1.443565, loss_ss: 1.068766, loss_d: 0.374799
0.2688 --- loss: 2.334044, loss_ss: 1.150985, loss_d: 1.183060
0.3072 --- loss: 1.847689, loss_ss: 1.404365, loss_d: 0.443324
0.3456 --- loss: 1.474907, loss_ss: 1.115238, loss_d: 0.359669
0.3840 --- loss: 1.651489, loss_ss: 0.999294, loss_d: 0.652195
0.4224 --- loss: 1.433986, loss_ss: 1.111122, loss_d: 0.322865
0.4608 --- loss: 1.768344, loss_ss: 1.136061, loss_d: 0.632282
0.4992 --- loss: 1.192679, loss_ss: 0.887242, loss_d: 0.305438
0.5376 --- loss: 1.834847, loss_ss: 1.478689, loss_d: 0.356158
0.5760 --- loss: 1.749560, loss_ss: 1.132283, loss_d: 0.617277
0.6144 --- loss: 1.685590, loss_ss: 1.092936, loss_d: 0.592654
0.6528 --- loss: 1.742634, loss_ss: 1.265624, loss_d: 0.477010
0.6912 --- loss: 1.559226, loss_ss: 1.192192, loss_d: 0.367033
0.7296 --- loss: 1.458399, loss_ss: 1.069480, loss_d: 0.388919
0.7680 --- loss: 1.654134, loss_ss: 1.244570, loss_d: 0.409563
0.8065 --- loss: 1.421250, loss_ss: 1.021528, loss_d: 0.399721
0.8449 --- loss: 1.464054, loss_ss: 1.076203, loss_d: 0.387851
0.8833 --- loss: 1.510084, loss_ss: 1.095355, loss_d: 0.414729
0.9217 --- loss: 1.509323, loss_ss: 0.932489, loss_d: 0.576834
0.9601 --- loss: 2.241411, loss_ss: 1.486366, loss_d: 0.755045
0.9985 --- loss: 1.692741, loss_ss: 1.310164, loss_d: 0.382577
Epoch finished! Loss: 1.5802451289617099
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.280902, loss_ss: 0.953005, loss_d: 0.327898
0.0384 --- loss: 1.242580, loss_ss: 0.926640, loss_d: 0.315941
0.0768 --- loss: 1.448376, loss_ss: 1.114494, loss_d: 0.333882
0.1152 --- loss: 1.333195, loss_ss: 0.936253, loss_d: 0.396942
0.1536 --- loss: 1.254520, loss_ss: 0.979828, loss_d: 0.274692
0.1920 --- loss: 1.268095, loss_ss: 0.972655, loss_d: 0.295439
0.2304 --- loss: 1.527019, loss_ss: 1.182688, loss_d: 0.344331
0.2688 --- loss: 1.590779, loss_ss: 1.354568, loss_d: 0.236211
0.3072 --- loss: 1.327128, loss_ss: 0.780391, loss_d: 0.546737
0.3456 --- loss: 1.545047, loss_ss: 1.230667, loss_d: 0.314380
0.3840 --- loss: 1.209126, loss_ss: 0.934514, loss_d: 0.274612
0.4224 --- loss: 1.639731, loss_ss: 1.162082, loss_d: 0.477649
0.4608 --- loss: 1.608749, loss_ss: 1.303755, loss_d: 0.304994
0.4992 --- loss: 1.541783, loss_ss: 0.962823, loss_d: 0.578960
0.5376 --- loss: 1.505713, loss_ss: 1.162998, loss_d: 0.342715
0.5760 --- loss: 1.833421, loss_ss: 1.565367, loss_d: 0.268054
0.6144 --- loss: 1.412578, loss_ss: 1.091511, loss_d: 0.321067
0.6528 --- loss: 1.704585, loss_ss: 1.388439, loss_d: 0.316146
0.6912 --- loss: 1.484584, loss_ss: 1.204704, loss_d: 0.279880
0.7296 --- loss: 2.112669, loss_ss: 0.923018, loss_d: 1.189651
0.7680 --- loss: 1.561383, loss_ss: 1.141181, loss_d: 0.420202
0.8065 --- loss: 1.507063, loss_ss: 1.100842, loss_d: 0.406220
0.8449 --- loss: 1.294655, loss_ss: 0.960716, loss_d: 0.333939
0.8833 --- loss: 1.632931, loss_ss: 1.098805, loss_d: 0.534126
0.9217 --- loss: 1.730369, loss_ss: 1.302526, loss_d: 0.427843
0.9601 --- loss: 1.359361, loss_ss: 1.091348, loss_d: 0.268012
0.9985 --- loss: 1.851323, loss_ss: 1.484590, loss_d: 0.366733
Epoch finished! Loss: 1.545786570585691
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.544357, loss_ss: 1.161969, loss_d: 0.382388
0.0384 --- loss: 1.613353, loss_ss: 1.081473, loss_d: 0.531880
0.0768 --- loss: 1.271114, loss_ss: 0.975737, loss_d: 0.295377
0.1152 --- loss: 1.077028, loss_ss: 0.891386, loss_d: 0.185642
0.1536 --- loss: 1.684338, loss_ss: 1.300885, loss_d: 0.383453
0.1920 --- loss: 1.521444, loss_ss: 1.082727, loss_d: 0.438717
0.2304 --- loss: 1.319078, loss_ss: 1.134020, loss_d: 0.185058
0.2688 --- loss: 1.529903, loss_ss: 1.234651, loss_d: 0.295253
0.3072 --- loss: 1.588903, loss_ss: 1.042968, loss_d: 0.545935
0.3456 --- loss: 1.521924, loss_ss: 1.337307, loss_d: 0.184617
0.3840 --- loss: 1.546402, loss_ss: 1.238843, loss_d: 0.307558
0.4224 --- loss: 1.383332, loss_ss: 1.026497, loss_d: 0.356835
0.4608 --- loss: 1.255072, loss_ss: 0.860425, loss_d: 0.394648
0.4992 --- loss: 1.304246, loss_ss: 1.011261, loss_d: 0.292985
0.5376 --- loss: 1.203569, loss_ss: 0.953536, loss_d: 0.250033
0.5760 --- loss: 1.296095, loss_ss: 0.917650, loss_d: 0.378445
0.6144 --- loss: 1.649012, loss_ss: 1.057805, loss_d: 0.591207
0.6528 --- loss: 1.195859, loss_ss: 0.914896, loss_d: 0.280964
0.6912 --- loss: 1.738343, loss_ss: 1.221780, loss_d: 0.516564
0.7296 --- loss: 1.104469, loss_ss: 0.912555, loss_d: 0.191914
0.7680 --- loss: 1.278480, loss_ss: 0.970961, loss_d: 0.307519
0.8065 --- loss: 1.588682, loss_ss: 1.173009, loss_d: 0.415673
0.8449 --- loss: 1.901601, loss_ss: 1.536919, loss_d: 0.364682
0.8833 --- loss: 1.233446, loss_ss: 0.903621, loss_d: 0.329824
0.9217 --- loss: 1.585390, loss_ss: 0.824208, loss_d: 0.761182
0.9601 --- loss: 1.184518, loss_ss: 0.927697, loss_d: 0.256822
0.9985 --- loss: 1.485303, loss_ss: 0.948016, loss_d: 0.537287
Epoch finished! Loss: 1.4963596256879659
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.24803921568627452
             precision    recall  f1-score   support

        0.0       0.10      0.97      0.18        62
        1.0       0.00      0.00      0.00       178
        2.0       0.89      0.22      0.35       437
        3.0       0.32      0.96      0.49       102
        4.0       0.00      0.00      0.00       241

avg / total       0.42      0.25      0.21      1020
 


====== chp038-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  45.78  96.77   42.48   9.82     17.83
1  82.55   0.00  100.00   0.00      0.00
2  65.29  21.74   97.94  88.79     34.93
3  79.61  96.08   77.78  32.45     48.51
4  76.37   0.00  100.00   0.00      0.00
Total accuracy: 24.80%
Average sen: 42.92%
Average spec: 83.64%
Macro f1-score: 20.25%
[0.99170202 0.99080652 0.98704523 0.99139941 0.99039209 0.98373955
 0.94627535 0.97746265 0.97887725 0.97578478 0.97005951 0.98261338
 0.98469037 0.98384708 0.98357105 0.72949755 0.96319383 0.98136789
 0.98291379 0.98454386 0.99029011 0.98162204 0.98997003 0.98143619
 0.69564062 0.65351766 0.98565149 0.98258799 0.96397567 0.98420769
 0.97740138 0.98255664 0.97413957 0.99559927]
pred: 0.9558346920153674, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.440042, loss_ss: 1.705227, loss_d: 0.734815
0.0384 --- loss: 2.147125, loss_ss: 1.575500, loss_d: 0.571625
0.0769 --- loss: 2.503203, loss_ss: 1.549996, loss_d: 0.953207
0.1153 --- loss: 2.188332, loss_ss: 1.603169, loss_d: 0.585163
0.1538 --- loss: 1.839752, loss_ss: 1.476767, loss_d: 0.362985
0.1922 --- loss: 2.895359, loss_ss: 1.577920, loss_d: 1.317439
0.2307 --- loss: 2.086950, loss_ss: 1.554481, loss_d: 0.532469
0.2691 --- loss: 2.127066, loss_ss: 1.559768, loss_d: 0.567298
0.3076 --- loss: 2.015186, loss_ss: 1.532821, loss_d: 0.482365
0.3460 --- loss: 1.742581, loss_ss: 1.422038, loss_d: 0.320543
0.3845 --- loss: 1.885447, loss_ss: 1.456225, loss_d: 0.429222
0.4229 --- loss: 1.976490, loss_ss: 1.606354, loss_d: 0.370136
0.4614 --- loss: 2.589366, loss_ss: 1.670440, loss_d: 0.918927
0.4998 --- loss: 1.841617, loss_ss: 1.411846, loss_d: 0.429771
0.5383 --- loss: 1.968929, loss_ss: 1.409656, loss_d: 0.559273
0.5767 --- loss: 1.884890, loss_ss: 1.366068, loss_d: 0.518822
0.6151 --- loss: 1.945537, loss_ss: 1.585250, loss_d: 0.360287
0.6536 --- loss: 1.924770, loss_ss: 1.482986, loss_d: 0.441784
0.6920 --- loss: 1.940161, loss_ss: 1.334909, loss_d: 0.605252
0.7305 --- loss: 1.981358, loss_ss: 1.515915, loss_d: 0.465443
0.7689 --- loss: 2.127432, loss_ss: 1.416067, loss_d: 0.711364
0.8074 --- loss: 1.793750, loss_ss: 1.392136, loss_d: 0.401614
0.8458 --- loss: 1.911416, loss_ss: 1.580962, loss_d: 0.330454
0.8843 --- loss: 2.127953, loss_ss: 1.682494, loss_d: 0.445459
0.9227 --- loss: 2.214190, loss_ss: 1.424784, loss_d: 0.789406
0.9612 --- loss: 3.095347, loss_ss: 1.387997, loss_d: 1.707350
0.9996 --- loss: 1.546492, loss_ss: 1.325901, loss_d: 0.220592
Epoch finished! Loss: 2.066320838378026
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.331682, loss_ss: 1.552873, loss_d: 0.778809
0.0384 --- loss: 1.697776, loss_ss: 1.304215, loss_d: 0.393561
0.0769 --- loss: 1.801624, loss_ss: 1.302484, loss_d: 0.499140
0.1153 --- loss: 1.868333, loss_ss: 1.471282, loss_d: 0.397052
0.1538 --- loss: 1.686987, loss_ss: 1.303605, loss_d: 0.383382
0.1922 --- loss: 2.163953, loss_ss: 1.359053, loss_d: 0.804900
0.2307 --- loss: 2.755949, loss_ss: 1.596890, loss_d: 1.159058
0.2691 --- loss: 1.852743, loss_ss: 1.306343, loss_d: 0.546400
0.3076 --- loss: 1.930627, loss_ss: 1.504911, loss_d: 0.425716
0.3460 --- loss: 2.258037, loss_ss: 1.704180, loss_d: 0.553856
0.3845 --- loss: 1.843601, loss_ss: 1.449390, loss_d: 0.394211
0.4229 --- loss: 1.731467, loss_ss: 1.219291, loss_d: 0.512177
0.4614 --- loss: 1.891773, loss_ss: 1.375108, loss_d: 0.516665
0.4998 --- loss: 1.999796, loss_ss: 1.429519, loss_d: 0.570276
0.5383 --- loss: 2.025914, loss_ss: 1.440734, loss_d: 0.585180
0.5767 --- loss: 2.044291, loss_ss: 1.547092, loss_d: 0.497199
0.6151 --- loss: 1.936988, loss_ss: 1.426947, loss_d: 0.510041
0.6536 --- loss: 2.016521, loss_ss: 1.539237, loss_d: 0.477284
0.6920 --- loss: 2.123473, loss_ss: 1.407668, loss_d: 0.715805
0.7305 --- loss: 1.782449, loss_ss: 1.430662, loss_d: 0.351787
0.7689 --- loss: 1.586066, loss_ss: 1.257284, loss_d: 0.328782
0.8074 --- loss: 1.755638, loss_ss: 1.347489, loss_d: 0.408150
0.8458 --- loss: 2.313715, loss_ss: 1.495957, loss_d: 0.817758
0.8843 --- loss: 2.319791, loss_ss: 1.821720, loss_d: 0.498071
0.9227 --- loss: 1.860584, loss_ss: 1.415557, loss_d: 0.445027
0.9612 --- loss: 1.960688, loss_ss: 1.386107, loss_d: 0.574581
0.9996 --- loss: 2.326601, loss_ss: 1.089135, loss_d: 1.237466
Epoch finished! Loss: 1.978164956661371
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.994820, loss_ss: 1.402409, loss_d: 0.592411
0.0384 --- loss: 1.909215, loss_ss: 1.422825, loss_d: 0.486390
0.0769 --- loss: 2.021071, loss_ss: 1.497662, loss_d: 0.523409
0.1153 --- loss: 1.887499, loss_ss: 1.451135, loss_d: 0.436364
0.1538 --- loss: 2.150120, loss_ss: 1.413279, loss_d: 0.736841
0.1922 --- loss: 1.707502, loss_ss: 1.131288, loss_d: 0.576214
0.2307 --- loss: 1.799199, loss_ss: 1.449476, loss_d: 0.349723
0.2691 --- loss: 1.676379, loss_ss: 1.300142, loss_d: 0.376237
0.3076 --- loss: 2.264813, loss_ss: 1.450296, loss_d: 0.814517
0.3460 --- loss: 1.765412, loss_ss: 1.334969, loss_d: 0.430444
0.3845 --- loss: 1.758518, loss_ss: 1.390426, loss_d: 0.368092
0.4229 --- loss: 1.528281, loss_ss: 1.208272, loss_d: 0.320009
0.4614 --- loss: 2.191285, loss_ss: 1.338087, loss_d: 0.853198
0.4998 --- loss: 1.714797, loss_ss: 1.135665, loss_d: 0.579132
0.5383 --- loss: 1.719361, loss_ss: 1.308455, loss_d: 0.410907
0.5767 --- loss: 1.868633, loss_ss: 1.389580, loss_d: 0.479053
0.6151 --- loss: 1.940631, loss_ss: 1.229254, loss_d: 0.711377
0.6536 --- loss: 1.823269, loss_ss: 1.294890, loss_d: 0.528379
0.6920 --- loss: 1.589369, loss_ss: 1.171167, loss_d: 0.418202
0.7305 --- loss: 2.010804, loss_ss: 1.685938, loss_d: 0.324866
0.7689 --- loss: 2.165964, loss_ss: 1.293727, loss_d: 0.872237
0.8074 --- loss: 1.691278, loss_ss: 1.258281, loss_d: 0.432997
0.8458 --- loss: 1.701724, loss_ss: 1.238202, loss_d: 0.463522
0.8843 --- loss: 1.719902, loss_ss: 1.261351, loss_d: 0.458551
0.9227 --- loss: 1.953909, loss_ss: 1.402042, loss_d: 0.551866
0.9612 --- loss: 1.839245, loss_ss: 1.484874, loss_d: 0.354371
0.9996 --- loss: 2.059742, loss_ss: 1.689767, loss_d: 0.369976
Epoch finished! Loss: 1.8843230495086083
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.680260, loss_ss: 1.167558, loss_d: 0.512703
0.0384 --- loss: 2.053500, loss_ss: 1.421890, loss_d: 0.631610
0.0769 --- loss: 1.655697, loss_ss: 1.039610, loss_d: 0.616087
0.1153 --- loss: 1.590129, loss_ss: 1.287994, loss_d: 0.302135
0.1538 --- loss: 1.820349, loss_ss: 1.488943, loss_d: 0.331406
0.1922 --- loss: 1.553141, loss_ss: 1.080914, loss_d: 0.472227
0.2307 --- loss: 1.586857, loss_ss: 1.109794, loss_d: 0.477064
0.2691 --- loss: 1.997549, loss_ss: 1.501429, loss_d: 0.496120
0.3076 --- loss: 1.946048, loss_ss: 1.507889, loss_d: 0.438160
0.3460 --- loss: 1.781367, loss_ss: 1.336803, loss_d: 0.444564
0.3845 --- loss: 1.837495, loss_ss: 1.150518, loss_d: 0.686976
0.4229 --- loss: 1.950571, loss_ss: 1.360363, loss_d: 0.590208
0.4614 --- loss: 1.680497, loss_ss: 1.262285, loss_d: 0.418212
0.4998 --- loss: 2.154390, loss_ss: 1.648859, loss_d: 0.505530
0.5383 --- loss: 1.639518, loss_ss: 1.093673, loss_d: 0.545846
0.5767 --- loss: 1.734310, loss_ss: 1.404601, loss_d: 0.329709
0.6151 --- loss: 1.353335, loss_ss: 1.026151, loss_d: 0.327184
0.6536 --- loss: 1.534383, loss_ss: 1.137923, loss_d: 0.396460
0.6920 --- loss: 1.576086, loss_ss: 1.136029, loss_d: 0.440057
0.7305 --- loss: 1.712764, loss_ss: 1.344434, loss_d: 0.368331
0.7689 --- loss: 2.675797, loss_ss: 1.299183, loss_d: 1.376614
0.8074 --- loss: 1.468684, loss_ss: 1.141254, loss_d: 0.327430
0.8458 --- loss: 1.615850, loss_ss: 1.179425, loss_d: 0.436426
0.8843 --- loss: 1.442404, loss_ss: 0.973120, loss_d: 0.469284
0.9227 --- loss: 1.647806, loss_ss: 1.197568, loss_d: 0.450239
0.9612 --- loss: 1.580471, loss_ss: 1.266709, loss_d: 0.313762
0.9996 --- loss: 2.367208, loss_ss: 1.998724, loss_d: 0.368483
Epoch finished! Loss: 1.7501550683608422
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.285186, loss_ss: 0.953741, loss_d: 0.331444
0.0384 --- loss: 1.633026, loss_ss: 1.171279, loss_d: 0.461747
0.0769 --- loss: 1.780301, loss_ss: 1.433795, loss_d: 0.346506
0.1153 --- loss: 1.704493, loss_ss: 1.133016, loss_d: 0.571477
0.1538 --- loss: 2.011931, loss_ss: 1.361087, loss_d: 0.650845
0.1922 --- loss: 1.675111, loss_ss: 1.152452, loss_d: 0.522659
0.2307 --- loss: 1.673344, loss_ss: 1.070746, loss_d: 0.602598
0.2691 --- loss: 1.655580, loss_ss: 1.288905, loss_d: 0.366675
0.3076 --- loss: 2.136928, loss_ss: 1.441799, loss_d: 0.695129
0.3460 --- loss: 1.384893, loss_ss: 1.004539, loss_d: 0.380354
0.3845 --- loss: 1.439881, loss_ss: 1.000215, loss_d: 0.439666
0.4229 --- loss: 1.646631, loss_ss: 1.219074, loss_d: 0.427557
0.4614 --- loss: 1.492172, loss_ss: 0.987867, loss_d: 0.504305
0.4998 --- loss: 1.483030, loss_ss: 1.172179, loss_d: 0.310852
0.5383 --- loss: 1.907789, loss_ss: 1.348046, loss_d: 0.559743
0.5767 --- loss: 1.597394, loss_ss: 1.256897, loss_d: 0.340497
0.6151 --- loss: 1.419240, loss_ss: 1.074526, loss_d: 0.344714
0.6536 --- loss: 1.335808, loss_ss: 0.879618, loss_d: 0.456190
0.6920 --- loss: 1.558535, loss_ss: 1.062919, loss_d: 0.495616
0.7305 --- loss: 1.335250, loss_ss: 0.833899, loss_d: 0.501351
0.7689 --- loss: 1.814011, loss_ss: 1.213058, loss_d: 0.600953
0.8074 --- loss: 1.525447, loss_ss: 1.116103, loss_d: 0.409343
0.8458 --- loss: 1.508464, loss_ss: 1.139370, loss_d: 0.369094
0.8843 --- loss: 1.314755, loss_ss: 1.030431, loss_d: 0.284324
0.9227 --- loss: 1.501549, loss_ss: 1.170675, loss_d: 0.330874
0.9612 --- loss: 1.385982, loss_ss: 0.948863, loss_d: 0.437119
0.9996 --- loss: 1.488310, loss_ss: 1.206496, loss_d: 0.281814
Epoch finished! Loss: 1.6492307195296654
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.591250, loss_ss: 1.164532, loss_d: 0.426718
0.0384 --- loss: 1.595599, loss_ss: 1.290392, loss_d: 0.305207
0.0769 --- loss: 1.685981, loss_ss: 1.339606, loss_d: 0.346375
0.1153 --- loss: 1.795393, loss_ss: 1.299048, loss_d: 0.496344
0.1538 --- loss: 1.621058, loss_ss: 0.969263, loss_d: 0.651795
0.1922 --- loss: 1.595379, loss_ss: 1.167582, loss_d: 0.427796
0.2307 --- loss: 1.686348, loss_ss: 1.339244, loss_d: 0.347104
0.2691 --- loss: 1.384412, loss_ss: 1.034072, loss_d: 0.350340
0.3076 --- loss: 1.584232, loss_ss: 1.158477, loss_d: 0.425755
0.3460 --- loss: 1.634107, loss_ss: 1.211831, loss_d: 0.422276
0.3845 --- loss: 2.137630, loss_ss: 1.253528, loss_d: 0.884102
0.4229 --- loss: 2.225078, loss_ss: 1.358861, loss_d: 0.866217
0.4614 --- loss: 1.663795, loss_ss: 1.044714, loss_d: 0.619080
0.4998 --- loss: 1.499570, loss_ss: 1.057366, loss_d: 0.442204
0.5383 --- loss: 1.553366, loss_ss: 1.094629, loss_d: 0.458738
0.5767 --- loss: 1.924704, loss_ss: 1.619952, loss_d: 0.304752
0.6151 --- loss: 1.561902, loss_ss: 0.931578, loss_d: 0.630323
0.6536 --- loss: 1.418356, loss_ss: 0.872595, loss_d: 0.545760
0.6920 --- loss: 1.963677, loss_ss: 1.176227, loss_d: 0.787449
0.7305 --- loss: 1.578237, loss_ss: 1.065660, loss_d: 0.512577
0.7689 --- loss: 1.419983, loss_ss: 0.920701, loss_d: 0.499282
0.8074 --- loss: 1.378054, loss_ss: 0.904127, loss_d: 0.473927
0.8458 --- loss: 1.695616, loss_ss: 1.097012, loss_d: 0.598604
0.8843 --- loss: 1.246600, loss_ss: 0.738549, loss_d: 0.508051
0.9227 --- loss: 1.492855, loss_ss: 0.914383, loss_d: 0.578472
0.9612 --- loss: 1.553945, loss_ss: 1.017331, loss_d: 0.536614
0.9996 --- loss: 2.581912, loss_ss: 2.308583, loss_d: 0.273328
Epoch finished! Loss: 1.6433654193694776
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.120792, loss_ss: 0.925067, loss_d: 1.195725
0.0384 --- loss: 1.371804, loss_ss: 0.907547, loss_d: 0.464257
0.0769 --- loss: 1.805318, loss_ss: 0.925642, loss_d: 0.879676
0.1153 --- loss: 2.215190, loss_ss: 1.361174, loss_d: 0.854016
0.1538 --- loss: 1.313331, loss_ss: 0.871699, loss_d: 0.441632
0.1922 --- loss: 1.679204, loss_ss: 1.231506, loss_d: 0.447698
0.2307 --- loss: 1.576918, loss_ss: 1.176084, loss_d: 0.400835
0.2691 --- loss: 1.531120, loss_ss: 1.125550, loss_d: 0.405571
0.3076 --- loss: 1.615110, loss_ss: 1.078328, loss_d: 0.536783
0.3460 --- loss: 1.481530, loss_ss: 1.048800, loss_d: 0.432730
0.3845 --- loss: 1.298401, loss_ss: 0.932173, loss_d: 0.366228
0.4229 --- loss: 1.296087, loss_ss: 0.939590, loss_d: 0.356498
0.4614 --- loss: 1.317142, loss_ss: 0.864208, loss_d: 0.452934
0.4998 --- loss: 1.580173, loss_ss: 1.020612, loss_d: 0.559561
0.5383 --- loss: 1.705880, loss_ss: 1.262099, loss_d: 0.443781
0.5767 --- loss: 1.675595, loss_ss: 0.975663, loss_d: 0.699932
0.6151 --- loss: 1.386017, loss_ss: 0.973691, loss_d: 0.412326
0.6536 --- loss: 1.419776, loss_ss: 1.113749, loss_d: 0.306028
0.6920 --- loss: 1.755817, loss_ss: 1.008256, loss_d: 0.747562
0.7305 --- loss: 1.732507, loss_ss: 1.384588, loss_d: 0.347919
0.7689 --- loss: 1.766798, loss_ss: 1.336154, loss_d: 0.430644
0.8074 --- loss: 1.845454, loss_ss: 1.443555, loss_d: 0.401899
0.8458 --- loss: 1.467532, loss_ss: 1.039111, loss_d: 0.428421
0.8843 --- loss: 1.279888, loss_ss: 0.835730, loss_d: 0.444158
0.9227 --- loss: 1.377766, loss_ss: 1.025320, loss_d: 0.352447
0.9612 --- loss: 2.193522, loss_ss: 1.859093, loss_d: 0.334429
0.9996 --- loss: 3.182779, loss_ss: 1.310749, loss_d: 1.872030
Epoch finished! Loss: 1.6017974353753603
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.360332, loss_ss: 0.897700, loss_d: 0.462633
0.0384 --- loss: 1.505748, loss_ss: 1.100496, loss_d: 0.405252
0.0769 --- loss: 1.253593, loss_ss: 0.886232, loss_d: 0.367361
0.1153 --- loss: 1.486076, loss_ss: 1.020717, loss_d: 0.465359
0.1538 --- loss: 1.330969, loss_ss: 0.940412, loss_d: 0.390557
0.1922 --- loss: 1.454904, loss_ss: 1.072429, loss_d: 0.382475
0.2307 --- loss: 2.047823, loss_ss: 1.548406, loss_d: 0.499417
0.2691 --- loss: 1.779418, loss_ss: 1.323865, loss_d: 0.455553
0.3076 --- loss: 1.520937, loss_ss: 1.214739, loss_d: 0.306197
0.3460 --- loss: 1.655583, loss_ss: 1.211012, loss_d: 0.444571
0.3845 --- loss: 1.663724, loss_ss: 1.225486, loss_d: 0.438238
0.4229 --- loss: 1.556485, loss_ss: 1.060213, loss_d: 0.496272
0.4614 --- loss: 1.430693, loss_ss: 0.966302, loss_d: 0.464391
0.4998 --- loss: 1.565363, loss_ss: 1.019779, loss_d: 0.545583
0.5383 --- loss: 1.265499, loss_ss: 0.871133, loss_d: 0.394366
0.5767 --- loss: 1.922657, loss_ss: 1.024707, loss_d: 0.897950
0.6151 --- loss: 1.262724, loss_ss: 0.976633, loss_d: 0.286091
0.6536 --- loss: 1.615596, loss_ss: 1.239694, loss_d: 0.375902
0.6920 --- loss: 1.443470, loss_ss: 0.953090, loss_d: 0.490380
0.7305 --- loss: 1.387292, loss_ss: 0.937129, loss_d: 0.450163
0.7689 --- loss: 1.924543, loss_ss: 1.198261, loss_d: 0.726281
0.8074 --- loss: 1.638639, loss_ss: 1.295036, loss_d: 0.343603
0.8458 --- loss: 1.529431, loss_ss: 1.061804, loss_d: 0.467627
0.8843 --- loss: 1.215594, loss_ss: 0.793389, loss_d: 0.422206
0.9227 --- loss: 1.500429, loss_ss: 1.110941, loss_d: 0.389488
0.9612 --- loss: 1.751292, loss_ss: 0.998228, loss_d: 0.753063
0.9996 --- loss: 2.661818, loss_ss: 2.356951, loss_d: 0.304867
Epoch finished! Loss: 1.5996714578225062
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.495607, loss_ss: 0.881094, loss_d: 0.614513
0.0384 --- loss: 1.510248, loss_ss: 1.068933, loss_d: 0.441315
0.0769 --- loss: 1.394197, loss_ss: 1.007629, loss_d: 0.386569
0.1153 --- loss: 1.533001, loss_ss: 1.250526, loss_d: 0.282475
0.1538 --- loss: 1.517495, loss_ss: 1.173751, loss_d: 0.343743
0.1922 --- loss: 1.472559, loss_ss: 1.183770, loss_d: 0.288789
0.2307 --- loss: 1.386003, loss_ss: 1.076565, loss_d: 0.309438
0.2691 --- loss: 1.403692, loss_ss: 0.954238, loss_d: 0.449454
0.3076 --- loss: 1.386468, loss_ss: 1.012752, loss_d: 0.373716
0.3460 --- loss: 1.204062, loss_ss: 0.965776, loss_d: 0.238286
0.3845 --- loss: 1.338101, loss_ss: 0.927868, loss_d: 0.410234
0.4229 --- loss: 1.494580, loss_ss: 1.129341, loss_d: 0.365239
0.4614 --- loss: 1.496844, loss_ss: 1.207421, loss_d: 0.289423
0.4998 --- loss: 1.571774, loss_ss: 1.100344, loss_d: 0.471430
0.5383 --- loss: 1.447379, loss_ss: 1.146010, loss_d: 0.301369
0.5767 --- loss: 1.326328, loss_ss: 0.890024, loss_d: 0.436304
0.6151 --- loss: 1.193190, loss_ss: 0.916167, loss_d: 0.277022
0.6536 --- loss: 1.271641, loss_ss: 0.895173, loss_d: 0.376468
0.6920 --- loss: 1.321117, loss_ss: 0.979795, loss_d: 0.341323
0.7305 --- loss: 1.092027, loss_ss: 0.768904, loss_d: 0.323123
0.7689 --- loss: 1.555218, loss_ss: 1.234211, loss_d: 0.321007
0.8074 --- loss: 1.366690, loss_ss: 1.084375, loss_d: 0.282315
0.8458 --- loss: 1.835275, loss_ss: 1.432558, loss_d: 0.402717
0.8843 --- loss: 1.645977, loss_ss: 1.100747, loss_d: 0.545229
0.9227 --- loss: 1.849326, loss_ss: 1.304739, loss_d: 0.544587
0.9612 --- loss: 1.397287, loss_ss: 1.042607, loss_d: 0.354680
0.9996 --- loss: 1.498691, loss_ss: 1.300957, loss_d: 0.197734
Epoch finished! Loss: 1.5504764121312362
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.534376, loss_ss: 0.967656, loss_d: 0.566720
0.0384 --- loss: 2.198492, loss_ss: 1.492984, loss_d: 0.705508
0.0769 --- loss: 1.431829, loss_ss: 1.107980, loss_d: 0.323849
0.1153 --- loss: 1.811209, loss_ss: 1.335300, loss_d: 0.475909
0.1538 --- loss: 1.929712, loss_ss: 1.530054, loss_d: 0.399658
0.1922 --- loss: 1.481363, loss_ss: 1.175603, loss_d: 0.305760
0.2307 --- loss: 1.507064, loss_ss: 1.039672, loss_d: 0.467392
0.2691 --- loss: 1.501114, loss_ss: 1.207434, loss_d: 0.293680
0.3076 --- loss: 1.414959, loss_ss: 1.005604, loss_d: 0.409355
0.3460 --- loss: 1.748109, loss_ss: 0.969519, loss_d: 0.778589
0.3845 --- loss: 1.606877, loss_ss: 1.197551, loss_d: 0.409325
0.4229 --- loss: 1.272208, loss_ss: 0.963626, loss_d: 0.308581
0.4614 --- loss: 1.235838, loss_ss: 0.945380, loss_d: 0.290458
0.4998 --- loss: 1.523229, loss_ss: 1.060103, loss_d: 0.463126
0.5383 --- loss: 1.288571, loss_ss: 0.928333, loss_d: 0.360238
0.5767 --- loss: 1.906808, loss_ss: 1.196815, loss_d: 0.709993
0.6151 --- loss: 1.055648, loss_ss: 0.747340, loss_d: 0.308308
0.6536 --- loss: 1.087770, loss_ss: 0.756307, loss_d: 0.331462
0.6920 --- loss: 1.268394, loss_ss: 0.938237, loss_d: 0.330157
0.7305 --- loss: 1.217491, loss_ss: 0.966212, loss_d: 0.251279
0.7689 --- loss: 1.464152, loss_ss: 0.928175, loss_d: 0.535977
0.8074 --- loss: 1.465798, loss_ss: 1.029129, loss_d: 0.436669
0.8458 --- loss: 1.431077, loss_ss: 1.023015, loss_d: 0.408062
0.8843 --- loss: 1.388025, loss_ss: 0.977605, loss_d: 0.410419
0.9227 --- loss: 1.346107, loss_ss: 1.040999, loss_d: 0.305108
0.9612 --- loss: 1.487286, loss_ss: 1.156762, loss_d: 0.330523
0.9996 --- loss: 3.205269, loss_ss: 1.208757, loss_d: 1.996513
Epoch finished! Loss: 1.5243804821601281
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.35585585585585583
             precision    recall  f1-score   support

        0.0       0.04      0.95      0.08        19
        1.0       0.00      0.00      0.00       355
        2.0       0.45      0.48      0.46       376
        3.0       0.70      0.96      0.81       199
        4.0       0.67      0.02      0.05       161

avg / total       0.38      0.36      0.31      1110
 


====== chp039-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  62.97  94.74   62.42   4.21      8.05
1  68.02   0.00  100.00   0.00      0.00
2  62.43  48.14   69.75  44.91     46.47
3  92.07  96.48   91.11  70.33     81.36
4  85.68   2.48   99.79  66.67      4.79
Total accuracy: 35.59%
Average sen: 48.37%
Average spec: 84.61%
Macro f1-score: 28.13%
[0.80448431 0.67454821 0.95246631 0.97324985 0.71823251 0.77408856
 0.66978067 0.59415239 0.69515806 0.71472102 0.6256516  0.66890484
 0.67923945 0.80227375 0.89952976 0.99060941 0.99466163 0.99600297
 0.6888864  0.66659015 0.98752648 0.52862334 0.60566193 0.70963591
 0.92121625 0.73352456 0.6504066  0.64017993 0.66519481 0.74091375
 0.76999021 0.72280705 0.5653553  0.71772307 0.70012021 0.80130076
 0.76748186]
pred: 0.7516457808984293, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.504556, loss_ss: 1.810170, loss_d: 0.694387
0.0384 --- loss: 2.338496, loss_ss: 1.750142, loss_d: 0.588355
0.0768 --- loss: 2.171148, loss_ss: 1.605208, loss_d: 0.565940
0.1153 --- loss: 2.011634, loss_ss: 1.590284, loss_d: 0.421350
0.1537 --- loss: 2.077760, loss_ss: 1.646662, loss_d: 0.431098
0.1921 --- loss: 2.244668, loss_ss: 1.617373, loss_d: 0.627295
0.2305 --- loss: 2.162655, loss_ss: 1.543262, loss_d: 0.619393
0.2689 --- loss: 2.006310, loss_ss: 1.508400, loss_d: 0.497910
0.3073 --- loss: 2.061184, loss_ss: 1.560218, loss_d: 0.500966
0.3458 --- loss: 1.985557, loss_ss: 1.558809, loss_d: 0.426748
0.3842 --- loss: 2.534717, loss_ss: 1.740804, loss_d: 0.793913
0.4226 --- loss: 1.942891, loss_ss: 1.562983, loss_d: 0.379907
0.4610 --- loss: 2.246582, loss_ss: 1.559187, loss_d: 0.687395
0.4994 --- loss: 2.076693, loss_ss: 1.625202, loss_d: 0.451491
0.5378 --- loss: 2.278815, loss_ss: 1.644279, loss_d: 0.634535
0.5763 --- loss: 2.334243, loss_ss: 1.534219, loss_d: 0.800025
0.6147 --- loss: 2.310795, loss_ss: 1.556199, loss_d: 0.754595
0.6531 --- loss: 2.384035, loss_ss: 1.526919, loss_d: 0.857117
0.6915 --- loss: 1.949236, loss_ss: 1.533243, loss_d: 0.415993
0.7299 --- loss: 2.254303, loss_ss: 1.395734, loss_d: 0.858568
0.7683 --- loss: 2.164008, loss_ss: 1.573279, loss_d: 0.590729
0.8068 --- loss: 1.846735, loss_ss: 1.447609, loss_d: 0.399126
0.8452 --- loss: 1.957824, loss_ss: 1.513690, loss_d: 0.444134
0.8836 --- loss: 2.060381, loss_ss: 1.452693, loss_d: 0.607688
0.9220 --- loss: 2.870011, loss_ss: 1.496386, loss_d: 1.373625
0.9604 --- loss: 2.168457, loss_ss: 1.558627, loss_d: 0.609829
0.9988 --- loss: 2.027261, loss_ss: 1.625210, loss_d: 0.402051
Epoch finished! Loss: 2.15781742471915
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.917361, loss_ss: 1.510923, loss_d: 0.406438
0.0384 --- loss: 2.273282, loss_ss: 1.540597, loss_d: 0.732685
0.0768 --- loss: 1.708779, loss_ss: 1.395012, loss_d: 0.313767
0.1153 --- loss: 1.912685, loss_ss: 1.535650, loss_d: 0.377035
0.1537 --- loss: 1.960505, loss_ss: 1.394346, loss_d: 0.566160
0.1921 --- loss: 1.914987, loss_ss: 1.411391, loss_d: 0.503596
0.2305 --- loss: 2.176517, loss_ss: 1.556558, loss_d: 0.619958
0.2689 --- loss: 1.848973, loss_ss: 1.382855, loss_d: 0.466118
0.3073 --- loss: 1.916059, loss_ss: 1.371005, loss_d: 0.545054
0.3458 --- loss: 1.930490, loss_ss: 1.406806, loss_d: 0.523685
0.3842 --- loss: 2.434454, loss_ss: 1.538835, loss_d: 0.895619
0.4226 --- loss: 1.884427, loss_ss: 1.434349, loss_d: 0.450078
0.4610 --- loss: 1.906621, loss_ss: 1.412491, loss_d: 0.494130
0.4994 --- loss: 1.903989, loss_ss: 1.561670, loss_d: 0.342319
0.5378 --- loss: 1.786337, loss_ss: 1.421609, loss_d: 0.364728
0.5763 --- loss: 1.862500, loss_ss: 1.300193, loss_d: 0.562306
0.6147 --- loss: 1.931516, loss_ss: 1.479432, loss_d: 0.452084
0.6531 --- loss: 2.376603, loss_ss: 1.370067, loss_d: 1.006536
0.6915 --- loss: 1.833719, loss_ss: 1.262228, loss_d: 0.571490
0.7299 --- loss: 2.221508, loss_ss: 1.410736, loss_d: 0.810772
0.7683 --- loss: 1.866129, loss_ss: 1.294376, loss_d: 0.571753
0.8068 --- loss: 2.125211, loss_ss: 1.598275, loss_d: 0.526936
0.8452 --- loss: 1.795389, loss_ss: 1.242364, loss_d: 0.553024
0.8836 --- loss: 2.222230, loss_ss: 1.557692, loss_d: 0.664538
0.9220 --- loss: 1.632140, loss_ss: 1.134939, loss_d: 0.497201
0.9604 --- loss: 1.703648, loss_ss: 1.251195, loss_d: 0.452453
0.9988 --- loss: 2.067605, loss_ss: 1.181617, loss_d: 0.885987
Epoch finished! Loss: 1.9636447250843048
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.896374, loss_ss: 1.287269, loss_d: 0.609105
0.0384 --- loss: 2.062337, loss_ss: 1.525988, loss_d: 0.536348
0.0768 --- loss: 1.716276, loss_ss: 1.254361, loss_d: 0.461915
0.1153 --- loss: 1.882088, loss_ss: 1.345158, loss_d: 0.536931
0.1537 --- loss: 1.821418, loss_ss: 1.431881, loss_d: 0.389536
0.1921 --- loss: 1.888586, loss_ss: 1.150178, loss_d: 0.738408
0.2305 --- loss: 1.903286, loss_ss: 1.368991, loss_d: 0.534294
0.2689 --- loss: 1.544404, loss_ss: 1.202114, loss_d: 0.342290
0.3073 --- loss: 1.607937, loss_ss: 1.257900, loss_d: 0.350037
0.3458 --- loss: 1.542478, loss_ss: 1.190354, loss_d: 0.352124
0.3842 --- loss: 1.597070, loss_ss: 1.158845, loss_d: 0.438225
0.4226 --- loss: 1.762758, loss_ss: 1.249980, loss_d: 0.512778
0.4610 --- loss: 1.671413, loss_ss: 1.311893, loss_d: 0.359520
0.4994 --- loss: 1.673195, loss_ss: 1.286514, loss_d: 0.386681
0.5378 --- loss: 1.726051, loss_ss: 1.255939, loss_d: 0.470112
0.5763 --- loss: 1.927911, loss_ss: 1.476958, loss_d: 0.450953
0.6147 --- loss: 1.864867, loss_ss: 1.424596, loss_d: 0.440272
0.6531 --- loss: 1.519513, loss_ss: 1.222724, loss_d: 0.296789
0.6915 --- loss: 1.959708, loss_ss: 1.244583, loss_d: 0.715125
0.7299 --- loss: 1.600984, loss_ss: 1.288591, loss_d: 0.312393
0.7683 --- loss: 1.637577, loss_ss: 1.199234, loss_d: 0.438343
0.8068 --- loss: 1.714764, loss_ss: 1.330059, loss_d: 0.384705
0.8452 --- loss: 1.588095, loss_ss: 1.272717, loss_d: 0.315379
0.8836 --- loss: 1.939857, loss_ss: 1.364756, loss_d: 0.575101
0.9220 --- loss: 1.469854, loss_ss: 1.153853, loss_d: 0.316001
0.9604 --- loss: 2.131579, loss_ss: 1.119307, loss_d: 1.012272
0.9988 --- loss: 1.736230, loss_ss: 1.217956, loss_d: 0.518274
Epoch finished! Loss: 1.7854879315082843
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.846513, loss_ss: 1.243787, loss_d: 0.602726
0.0384 --- loss: 1.705819, loss_ss: 1.039586, loss_d: 0.666233
0.0768 --- loss: 1.659168, loss_ss: 1.206283, loss_d: 0.452885
0.1153 --- loss: 1.474069, loss_ss: 1.059324, loss_d: 0.414745
0.1537 --- loss: 1.409901, loss_ss: 1.056708, loss_d: 0.353194
0.1921 --- loss: 1.576708, loss_ss: 1.213998, loss_d: 0.362710
0.2305 --- loss: 1.709646, loss_ss: 1.211193, loss_d: 0.498453
0.2689 --- loss: 1.560968, loss_ss: 1.112959, loss_d: 0.448009
0.3073 --- loss: 1.824622, loss_ss: 1.209617, loss_d: 0.615005
0.3458 --- loss: 1.570398, loss_ss: 1.136269, loss_d: 0.434129
0.3842 --- loss: 1.720427, loss_ss: 1.266785, loss_d: 0.453642
0.4226 --- loss: 1.601802, loss_ss: 1.164540, loss_d: 0.437261
0.4610 --- loss: 1.730082, loss_ss: 1.288621, loss_d: 0.441460
0.4994 --- loss: 2.009166, loss_ss: 1.643557, loss_d: 0.365609
0.5378 --- loss: 1.386246, loss_ss: 1.055951, loss_d: 0.330296
0.5763 --- loss: 1.600725, loss_ss: 1.215813, loss_d: 0.384912
0.6147 --- loss: 1.583967, loss_ss: 1.248061, loss_d: 0.335906
0.6531 --- loss: 1.849627, loss_ss: 1.374896, loss_d: 0.474731
0.6915 --- loss: 1.864048, loss_ss: 1.398887, loss_d: 0.465161
0.7299 --- loss: 1.652128, loss_ss: 1.266606, loss_d: 0.385522
0.7683 --- loss: 1.770493, loss_ss: 1.018240, loss_d: 0.752253
0.8068 --- loss: 1.447976, loss_ss: 1.095039, loss_d: 0.352937
0.8452 --- loss: 1.405103, loss_ss: 1.148939, loss_d: 0.256164
0.8836 --- loss: 1.855505, loss_ss: 1.159952, loss_d: 0.695553
0.9220 --- loss: 2.089788, loss_ss: 1.413060, loss_d: 0.676728
0.9604 --- loss: 1.635760, loss_ss: 1.183322, loss_d: 0.452438
0.9988 --- loss: 1.337642, loss_ss: 1.039532, loss_d: 0.298110
Epoch finished! Loss: 1.6774527210455674
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.976576, loss_ss: 1.571701, loss_d: 0.404875
0.0384 --- loss: 1.465430, loss_ss: 1.015748, loss_d: 0.449683
0.0768 --- loss: 1.441968, loss_ss: 1.011904, loss_d: 0.430065
0.1153 --- loss: 1.547763, loss_ss: 1.305870, loss_d: 0.241893
0.1537 --- loss: 1.316225, loss_ss: 0.982224, loss_d: 0.334000
0.1921 --- loss: 2.249780, loss_ss: 1.055464, loss_d: 1.194316
0.2305 --- loss: 1.636645, loss_ss: 1.118858, loss_d: 0.517787
0.2689 --- loss: 1.845088, loss_ss: 1.338303, loss_d: 0.506785
0.3073 --- loss: 1.480762, loss_ss: 1.079116, loss_d: 0.401645
0.3458 --- loss: 1.467107, loss_ss: 1.130038, loss_d: 0.337068
0.3842 --- loss: 2.015681, loss_ss: 1.523907, loss_d: 0.491774
0.4226 --- loss: 1.539083, loss_ss: 1.183164, loss_d: 0.355918
0.4610 --- loss: 1.286770, loss_ss: 0.945183, loss_d: 0.341587
0.4994 --- loss: 1.748834, loss_ss: 1.332820, loss_d: 0.416014
0.5378 --- loss: 1.711564, loss_ss: 0.982773, loss_d: 0.728790
0.5763 --- loss: 1.674940, loss_ss: 1.182994, loss_d: 0.491946
0.6147 --- loss: 1.538863, loss_ss: 1.032558, loss_d: 0.506305
0.6531 --- loss: 1.946478, loss_ss: 1.461782, loss_d: 0.484696
0.6915 --- loss: 1.480662, loss_ss: 1.164192, loss_d: 0.316471
0.7299 --- loss: 1.609549, loss_ss: 1.066015, loss_d: 0.543534
0.7683 --- loss: 1.676571, loss_ss: 1.143376, loss_d: 0.533194
0.8068 --- loss: 1.359421, loss_ss: 0.947467, loss_d: 0.411954
0.8452 --- loss: 1.949256, loss_ss: 1.296224, loss_d: 0.653032
0.8836 --- loss: 1.551020, loss_ss: 1.242551, loss_d: 0.308468
0.9220 --- loss: 1.580618, loss_ss: 0.985459, loss_d: 0.595159
0.9604 --- loss: 1.540613, loss_ss: 1.155797, loss_d: 0.384816
0.9988 --- loss: 1.762457, loss_ss: 1.425634, loss_d: 0.336822
Epoch finished! Loss: 1.649061268568039
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.589681, loss_ss: 1.209556, loss_d: 0.380126
0.0384 --- loss: 2.340925, loss_ss: 1.360215, loss_d: 0.980710
0.0768 --- loss: 1.513876, loss_ss: 0.949544, loss_d: 0.564332
0.1153 --- loss: 1.396832, loss_ss: 0.917901, loss_d: 0.478931
0.1537 --- loss: 1.292073, loss_ss: 0.906255, loss_d: 0.385817
0.1921 --- loss: 1.218194, loss_ss: 0.962645, loss_d: 0.255549
0.2305 --- loss: 1.492212, loss_ss: 1.107222, loss_d: 0.384990
0.2689 --- loss: 2.093609, loss_ss: 1.534791, loss_d: 0.558818
0.3073 --- loss: 1.668211, loss_ss: 1.167801, loss_d: 0.500411
0.3458 --- loss: 1.248525, loss_ss: 0.855124, loss_d: 0.393401
0.3842 --- loss: 1.385450, loss_ss: 0.904729, loss_d: 0.480721
0.4226 --- loss: 1.568492, loss_ss: 1.202934, loss_d: 0.365558
0.4610 --- loss: 1.423005, loss_ss: 1.018421, loss_d: 0.404584
0.4994 --- loss: 1.302949, loss_ss: 0.903988, loss_d: 0.398961
0.5378 --- loss: 1.420583, loss_ss: 1.051354, loss_d: 0.369229
0.5763 --- loss: 1.256908, loss_ss: 0.889092, loss_d: 0.367815
0.6147 --- loss: 1.349643, loss_ss: 1.110342, loss_d: 0.239302
0.6531 --- loss: 1.490345, loss_ss: 1.076730, loss_d: 0.413614
0.6915 --- loss: 1.429560, loss_ss: 0.992194, loss_d: 0.437366
0.7299 --- loss: 2.051758, loss_ss: 1.738555, loss_d: 0.313203
0.7683 --- loss: 1.240658, loss_ss: 0.953993, loss_d: 0.286665
0.8068 --- loss: 1.500029, loss_ss: 1.182440, loss_d: 0.317589
0.8452 --- loss: 1.541586, loss_ss: 1.081190, loss_d: 0.460396
0.8836 --- loss: 1.581395, loss_ss: 1.069852, loss_d: 0.511542
0.9220 --- loss: 1.551307, loss_ss: 1.226634, loss_d: 0.324673
0.9604 --- loss: 1.628788, loss_ss: 0.847415, loss_d: 0.781373
0.9988 --- loss: 2.808325, loss_ss: 1.167027, loss_d: 1.641298
Epoch finished! Loss: 1.6033110907444588
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.282863, loss_ss: 0.932748, loss_d: 0.350115
0.0384 --- loss: 1.410780, loss_ss: 0.976718, loss_d: 0.434063
0.0768 --- loss: 1.417078, loss_ss: 0.996545, loss_d: 0.420533
0.1153 --- loss: 1.860540, loss_ss: 1.378398, loss_d: 0.482142
0.1537 --- loss: 1.757368, loss_ss: 1.387515, loss_d: 0.369853
0.1921 --- loss: 1.018240, loss_ss: 0.727867, loss_d: 0.290373
0.2305 --- loss: 1.241875, loss_ss: 0.904883, loss_d: 0.336992
0.2689 --- loss: 1.511409, loss_ss: 1.111420, loss_d: 0.399990
0.3073 --- loss: 1.640762, loss_ss: 1.029345, loss_d: 0.611418
0.3458 --- loss: 1.585067, loss_ss: 1.120140, loss_d: 0.464927
0.3842 --- loss: 1.745158, loss_ss: 1.426152, loss_d: 0.319007
0.4226 --- loss: 1.688635, loss_ss: 1.398440, loss_d: 0.290194
0.4610 --- loss: 1.463064, loss_ss: 1.120242, loss_d: 0.342822
0.4994 --- loss: 2.352940, loss_ss: 1.244918, loss_d: 1.108022
0.5378 --- loss: 1.518607, loss_ss: 1.121241, loss_d: 0.397365
0.5763 --- loss: 1.974493, loss_ss: 1.300251, loss_d: 0.674243
0.6147 --- loss: 1.510010, loss_ss: 1.202036, loss_d: 0.307974
0.6531 --- loss: 1.518477, loss_ss: 1.052676, loss_d: 0.465802
0.6915 --- loss: 1.628266, loss_ss: 1.037373, loss_d: 0.590893
0.7299 --- loss: 1.612858, loss_ss: 1.220941, loss_d: 0.391917
0.7683 --- loss: 1.161803, loss_ss: 0.811484, loss_d: 0.350319
0.8068 --- loss: 1.305591, loss_ss: 0.903126, loss_d: 0.402465
0.8452 --- loss: 1.740413, loss_ss: 1.279746, loss_d: 0.460666
0.8836 --- loss: 1.303310, loss_ss: 0.823341, loss_d: 0.479969
0.9220 --- loss: 1.431523, loss_ss: 1.153501, loss_d: 0.278022
0.9604 --- loss: 1.459106, loss_ss: 1.003062, loss_d: 0.456043
0.9988 --- loss: 1.992547, loss_ss: 1.794344, loss_d: 0.198203
Epoch finished! Loss: 1.5679099935751695
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.443561, loss_ss: 1.179745, loss_d: 0.263816
0.0384 --- loss: 1.357410, loss_ss: 1.027441, loss_d: 0.329969
0.0768 --- loss: 1.670383, loss_ss: 1.231740, loss_d: 0.438643
0.1153 --- loss: 1.550718, loss_ss: 1.101955, loss_d: 0.448763
0.1537 --- loss: 1.537292, loss_ss: 1.034540, loss_d: 0.502752
0.1921 --- loss: 1.950696, loss_ss: 1.063725, loss_d: 0.886971
0.2305 --- loss: 1.550239, loss_ss: 1.180814, loss_d: 0.369425
0.2689 --- loss: 1.493392, loss_ss: 1.176717, loss_d: 0.316675
0.3073 --- loss: 1.374176, loss_ss: 1.130478, loss_d: 0.243698
0.3458 --- loss: 1.308444, loss_ss: 1.006196, loss_d: 0.302248
0.3842 --- loss: 1.193026, loss_ss: 1.006661, loss_d: 0.186365
0.4226 --- loss: 2.244532, loss_ss: 1.216251, loss_d: 1.028281
0.4610 --- loss: 1.545186, loss_ss: 1.140139, loss_d: 0.405047
0.4994 --- loss: 1.741221, loss_ss: 1.391544, loss_d: 0.349678
0.5378 --- loss: 1.247845, loss_ss: 0.856170, loss_d: 0.391675
0.5763 --- loss: 1.456143, loss_ss: 1.099456, loss_d: 0.356687
0.6147 --- loss: 1.240036, loss_ss: 0.952103, loss_d: 0.287933
0.6531 --- loss: 1.513020, loss_ss: 1.210319, loss_d: 0.302701
0.6915 --- loss: 1.511791, loss_ss: 1.076427, loss_d: 0.435364
0.7299 --- loss: 1.553556, loss_ss: 1.159704, loss_d: 0.393852
0.7683 --- loss: 1.314879, loss_ss: 1.073909, loss_d: 0.240969
0.8068 --- loss: 1.400355, loss_ss: 1.016082, loss_d: 0.384272
0.8452 --- loss: 1.800627, loss_ss: 1.403840, loss_d: 0.396787
0.8836 --- loss: 1.580267, loss_ss: 1.129644, loss_d: 0.450623
0.9220 --- loss: 1.297999, loss_ss: 1.073349, loss_d: 0.224651
0.9604 --- loss: 1.211778, loss_ss: 0.933802, loss_d: 0.277976
0.9988 --- loss: 1.714552, loss_ss: 1.356481, loss_d: 0.358071
Epoch finished! Loss: 1.5346703400978676
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.637721, loss_ss: 1.397788, loss_d: 0.239933
0.0384 --- loss: 1.875471, loss_ss: 1.320967, loss_d: 0.554504
0.0768 --- loss: 1.562497, loss_ss: 1.313582, loss_d: 0.248915
0.1153 --- loss: 1.312060, loss_ss: 0.940948, loss_d: 0.371112
0.1537 --- loss: 1.376712, loss_ss: 1.089782, loss_d: 0.286931
0.1921 --- loss: 1.572080, loss_ss: 0.965444, loss_d: 0.606635
0.2305 --- loss: 1.763457, loss_ss: 1.160608, loss_d: 0.602848
0.2689 --- loss: 1.462754, loss_ss: 1.088046, loss_d: 0.374709
0.3073 --- loss: 1.640317, loss_ss: 1.320204, loss_d: 0.320113
0.3458 --- loss: 1.406021, loss_ss: 1.010366, loss_d: 0.395655
0.3842 --- loss: 1.394705, loss_ss: 1.022748, loss_d: 0.371958
0.4226 --- loss: 1.384275, loss_ss: 1.090097, loss_d: 0.294177
0.4610 --- loss: 2.569714, loss_ss: 1.282774, loss_d: 1.286940
0.4994 --- loss: 1.363761, loss_ss: 1.094137, loss_d: 0.269623
0.5378 --- loss: 1.647482, loss_ss: 1.047828, loss_d: 0.599654
0.5763 --- loss: 1.550701, loss_ss: 1.222191, loss_d: 0.328510
0.6147 --- loss: 1.488480, loss_ss: 1.009447, loss_d: 0.479032
0.6531 --- loss: 1.537440, loss_ss: 1.037504, loss_d: 0.499937
0.6915 --- loss: 1.201736, loss_ss: 0.878549, loss_d: 0.323187
0.7299 --- loss: 1.180796, loss_ss: 0.904715, loss_d: 0.276081
0.7683 --- loss: 1.399565, loss_ss: 1.026409, loss_d: 0.373156
0.8068 --- loss: 1.435628, loss_ss: 1.135334, loss_d: 0.300294
0.8452 --- loss: 1.754400, loss_ss: 1.269021, loss_d: 0.485378
0.8836 --- loss: 1.464816, loss_ss: 1.251222, loss_d: 0.213593
0.9220 --- loss: 1.400979, loss_ss: 1.047125, loss_d: 0.353854
0.9604 --- loss: 1.165510, loss_ss: 0.898923, loss_d: 0.266587
0.9988 --- loss: 1.321115, loss_ss: 0.866416, loss_d: 0.454699
Epoch finished! Loss: 1.4960357927359067
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.390779, loss_ss: 1.072259, loss_d: 0.318520
0.0384 --- loss: 1.181996, loss_ss: 0.867303, loss_d: 0.314693
0.0768 --- loss: 1.675691, loss_ss: 1.047526, loss_d: 0.628165
0.1153 --- loss: 1.456639, loss_ss: 1.177125, loss_d: 0.279514
0.1537 --- loss: 1.228358, loss_ss: 0.943646, loss_d: 0.284712
0.1921 --- loss: 2.214990, loss_ss: 0.965760, loss_d: 1.249230
0.2305 --- loss: 1.358041, loss_ss: 1.070787, loss_d: 0.287253
0.2689 --- loss: 1.399668, loss_ss: 1.006430, loss_d: 0.393237
0.3073 --- loss: 1.179129, loss_ss: 0.926825, loss_d: 0.252304
0.3458 --- loss: 1.383369, loss_ss: 0.905297, loss_d: 0.478072
0.3842 --- loss: 1.647612, loss_ss: 1.288397, loss_d: 0.359215
0.4226 --- loss: 1.627979, loss_ss: 0.959528, loss_d: 0.668451
0.4610 --- loss: 1.614770, loss_ss: 1.272333, loss_d: 0.342437
0.4994 --- loss: 1.342137, loss_ss: 1.087433, loss_d: 0.254704
0.5378 --- loss: 1.557162, loss_ss: 1.113739, loss_d: 0.443423
0.5763 --- loss: 1.591974, loss_ss: 1.362462, loss_d: 0.229511
0.6147 --- loss: 2.097193, loss_ss: 1.545531, loss_d: 0.551662
0.6531 --- loss: 1.678220, loss_ss: 0.858021, loss_d: 0.820199
0.6915 --- loss: 1.775265, loss_ss: 1.293587, loss_d: 0.481678
0.7299 --- loss: 1.359620, loss_ss: 1.112854, loss_d: 0.246766
0.7683 --- loss: 1.339838, loss_ss: 0.924979, loss_d: 0.414859
0.8068 --- loss: 1.294041, loss_ss: 0.927234, loss_d: 0.366807
0.8452 --- loss: 1.380613, loss_ss: 1.018868, loss_d: 0.361745
0.8836 --- loss: 1.699810, loss_ss: 0.973964, loss_d: 0.725847
0.9220 --- loss: 1.112538, loss_ss: 0.858115, loss_d: 0.254423
0.9604 --- loss: 1.352730, loss_ss: 1.070448, loss_d: 0.282282
0.9988 --- loss: 1.667163, loss_ss: 1.307621, loss_d: 0.359542
Epoch finished! Loss: 1.472158092718858
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.32666666666666666
             precision    recall  f1-score   support

        0.0       0.50      0.74      0.60       163
        1.0       0.00      0.00      0.00       142
        2.0       0.11      0.05      0.07       329
        3.0       0.31      1.00      0.48       200
        4.0       0.80      0.02      0.04       216

avg / total       0.34      0.33      0.21      1050
 


====== chp040-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  84.67   74.23   86.58  50.42     60.05
1  86.48    0.00  100.00   0.00      0.00
2  56.48    5.47   79.75  10.98      7.30
3  58.00  100.00   48.12  31.20     47.56
4  79.71    1.85   99.88  80.00      3.62
Total accuracy: 32.67%
Average sen: 36.31%
Average spec: 82.87%
Macro f1-score: 23.71%
[0.99782169 0.9990415  0.99876297 0.81588292 0.89640892 0.89725494
 0.92799538 0.91481358 0.89735961 0.91168737 0.90321469 0.84254307
 0.90098733 0.89969659 0.92529511 0.92127389 0.9255867  0.90570116
 0.89523929 0.9894945  0.89680278 0.86581331 0.86715323 0.93270171
 0.92962378 0.87780219 0.93496305 0.90020972 0.76091748 0.89910179
 0.84769577 0.82103795 0.87055123 0.88094419 0.9171831 ]
pred: 0.9019589287894113, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.301232, loss_ss: 1.617513, loss_d: 0.683719
0.0384 --- loss: 3.058981, loss_ss: 1.902723, loss_d: 1.156258
0.0769 --- loss: 2.141500, loss_ss: 1.707922, loss_d: 0.433578
0.1153 --- loss: 2.280366, loss_ss: 1.584315, loss_d: 0.696051
0.1537 --- loss: 2.275689, loss_ss: 1.698730, loss_d: 0.576959
0.1922 --- loss: 2.418704, loss_ss: 1.707343, loss_d: 0.711361
0.2306 --- loss: 2.145529, loss_ss: 1.766408, loss_d: 0.379121
0.2690 --- loss: 2.016391, loss_ss: 1.583648, loss_d: 0.432743
0.3075 --- loss: 1.984545, loss_ss: 1.526716, loss_d: 0.457829
0.3459 --- loss: 2.036393, loss_ss: 1.664372, loss_d: 0.372020
0.3843 --- loss: 1.809372, loss_ss: 1.383885, loss_d: 0.425487
0.4228 --- loss: 2.168977, loss_ss: 1.532829, loss_d: 0.636148
0.4612 --- loss: 2.315671, loss_ss: 1.485620, loss_d: 0.830051
0.4996 --- loss: 2.127206, loss_ss: 1.527164, loss_d: 0.600043
0.5380 --- loss: 2.338392, loss_ss: 1.632732, loss_d: 0.705660
0.5765 --- loss: 2.489478, loss_ss: 1.626795, loss_d: 0.862683
0.6149 --- loss: 2.099494, loss_ss: 1.480080, loss_d: 0.619414
0.6533 --- loss: 1.973006, loss_ss: 1.429037, loss_d: 0.543969
0.6918 --- loss: 2.066012, loss_ss: 1.462388, loss_d: 0.603625
0.7302 --- loss: 1.721446, loss_ss: 1.367810, loss_d: 0.353636
0.7686 --- loss: 1.956700, loss_ss: 1.562680, loss_d: 0.394020
0.8071 --- loss: 1.857239, loss_ss: 1.490295, loss_d: 0.366944
0.8455 --- loss: 2.454837, loss_ss: 1.798046, loss_d: 0.656791
0.8839 --- loss: 2.065135, loss_ss: 1.537132, loss_d: 0.528003
0.9224 --- loss: 2.097965, loss_ss: 1.620607, loss_d: 0.477358
0.9608 --- loss: 2.046662, loss_ss: 1.384392, loss_d: 0.662269
0.9992 --- loss: 1.881238, loss_ss: 1.414940, loss_d: 0.466299
Epoch finished! Loss: 2.148936872298901
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.763296, loss_ss: 1.274902, loss_d: 0.488394
0.0384 --- loss: 2.149347, loss_ss: 1.500785, loss_d: 0.648563
0.0769 --- loss: 1.923730, loss_ss: 1.506970, loss_d: 0.416760
0.1153 --- loss: 2.030309, loss_ss: 1.615859, loss_d: 0.414450
0.1537 --- loss: 1.979801, loss_ss: 1.513840, loss_d: 0.465961
0.1922 --- loss: 1.874082, loss_ss: 1.485169, loss_d: 0.388914
0.2306 --- loss: 1.958186, loss_ss: 1.560809, loss_d: 0.397377
0.2690 --- loss: 1.875637, loss_ss: 1.586438, loss_d: 0.289199
0.3075 --- loss: 2.275242, loss_ss: 1.276852, loss_d: 0.998390
0.3459 --- loss: 2.074468, loss_ss: 1.679172, loss_d: 0.395296
0.3843 --- loss: 2.009184, loss_ss: 1.388031, loss_d: 0.621153
0.4228 --- loss: 1.949385, loss_ss: 1.594736, loss_d: 0.354649
0.4612 --- loss: 1.922998, loss_ss: 1.392013, loss_d: 0.530985
0.4996 --- loss: 2.356040, loss_ss: 1.342882, loss_d: 1.013157
0.5380 --- loss: 1.852283, loss_ss: 1.293165, loss_d: 0.559118
0.5765 --- loss: 2.105874, loss_ss: 1.425545, loss_d: 0.680328
0.6149 --- loss: 2.376481, loss_ss: 1.515541, loss_d: 0.860939
0.6533 --- loss: 1.914166, loss_ss: 1.473451, loss_d: 0.440716
0.6918 --- loss: 1.911569, loss_ss: 1.520637, loss_d: 0.390932
0.7302 --- loss: 1.747164, loss_ss: 1.358366, loss_d: 0.388798
0.7686 --- loss: 2.063958, loss_ss: 1.546815, loss_d: 0.517143
0.8071 --- loss: 2.122109, loss_ss: 1.308688, loss_d: 0.813421
0.8455 --- loss: 2.147964, loss_ss: 1.292745, loss_d: 0.855218
0.8839 --- loss: 1.663786, loss_ss: 1.332367, loss_d: 0.331419
0.9224 --- loss: 1.837202, loss_ss: 1.479054, loss_d: 0.358148
0.9608 --- loss: 1.752167, loss_ss: 1.352435, loss_d: 0.399732
0.9992 --- loss: 1.661011, loss_ss: 1.275647, loss_d: 0.385363
Epoch finished! Loss: 1.980713562781994
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.744910, loss_ss: 1.399050, loss_d: 0.345860
0.0384 --- loss: 2.177265, loss_ss: 1.446503, loss_d: 0.730762
0.0769 --- loss: 1.810390, loss_ss: 1.464744, loss_d: 0.345646
0.1153 --- loss: 1.942642, loss_ss: 1.205842, loss_d: 0.736800
0.1537 --- loss: 1.956222, loss_ss: 1.446695, loss_d: 0.509527
0.1922 --- loss: 1.766391, loss_ss: 1.317365, loss_d: 0.449026
0.2306 --- loss: 1.974792, loss_ss: 1.387568, loss_d: 0.587224
0.2690 --- loss: 2.280664, loss_ss: 1.458741, loss_d: 0.821924
0.3075 --- loss: 1.906769, loss_ss: 1.360467, loss_d: 0.546302
0.3459 --- loss: 1.800719, loss_ss: 1.444668, loss_d: 0.356050
0.3843 --- loss: 1.940312, loss_ss: 1.522509, loss_d: 0.417803
0.4228 --- loss: 1.811194, loss_ss: 1.530490, loss_d: 0.280705
0.4612 --- loss: 1.935302, loss_ss: 1.576498, loss_d: 0.358804
0.4996 --- loss: 1.769088, loss_ss: 1.344631, loss_d: 0.424458
0.5380 --- loss: 1.989498, loss_ss: 1.452601, loss_d: 0.536897
0.5765 --- loss: 2.117005, loss_ss: 1.565149, loss_d: 0.551856
0.6149 --- loss: 1.910259, loss_ss: 1.214470, loss_d: 0.695790
0.6533 --- loss: 2.037191, loss_ss: 1.520962, loss_d: 0.516228
0.6918 --- loss: 2.036563, loss_ss: 1.412904, loss_d: 0.623659
0.7302 --- loss: 1.805235, loss_ss: 1.297419, loss_d: 0.507816
0.7686 --- loss: 1.884547, loss_ss: 1.440251, loss_d: 0.444297
0.8071 --- loss: 1.703553, loss_ss: 1.347983, loss_d: 0.355570
0.8455 --- loss: 2.028849, loss_ss: 1.494107, loss_d: 0.534742
0.8839 --- loss: 2.161220, loss_ss: 1.485158, loss_d: 0.676062
0.9224 --- loss: 2.345746, loss_ss: 1.304573, loss_d: 1.041173
0.9608 --- loss: 1.779767, loss_ss: 1.317568, loss_d: 0.462199
0.9992 --- loss: 2.503061, loss_ss: 2.136922, loss_d: 0.366139
Epoch finished! Loss: 1.9123815829937274
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.724112, loss_ss: 1.358388, loss_d: 0.365724
0.0384 --- loss: 1.516089, loss_ss: 1.183698, loss_d: 0.332391
0.0769 --- loss: 1.936367, loss_ss: 1.407669, loss_d: 0.528698
0.1153 --- loss: 2.079217, loss_ss: 1.536392, loss_d: 0.542825
0.1537 --- loss: 1.691045, loss_ss: 1.237700, loss_d: 0.453345
0.1922 --- loss: 1.707283, loss_ss: 1.328457, loss_d: 0.378826
0.2306 --- loss: 2.025561, loss_ss: 1.310474, loss_d: 0.715087
0.2690 --- loss: 1.824960, loss_ss: 1.381540, loss_d: 0.443421
0.3075 --- loss: 1.797252, loss_ss: 1.305202, loss_d: 0.492050
0.3459 --- loss: 2.159228, loss_ss: 1.618324, loss_d: 0.540904
0.3843 --- loss: 1.592443, loss_ss: 1.262077, loss_d: 0.330366
0.4228 --- loss: 2.090065, loss_ss: 1.483914, loss_d: 0.606151
0.4612 --- loss: 1.597891, loss_ss: 1.109898, loss_d: 0.487994
0.4996 --- loss: 1.883044, loss_ss: 1.392748, loss_d: 0.490297
0.5380 --- loss: 1.569157, loss_ss: 1.227148, loss_d: 0.342009
0.5765 --- loss: 1.560771, loss_ss: 1.187321, loss_d: 0.373450
0.6149 --- loss: 1.863857, loss_ss: 1.501526, loss_d: 0.362331
0.6533 --- loss: 1.757777, loss_ss: 1.408741, loss_d: 0.349036
0.6918 --- loss: 1.537738, loss_ss: 1.180859, loss_d: 0.356878
0.7302 --- loss: 1.715880, loss_ss: 1.376289, loss_d: 0.339590
0.7686 --- loss: 1.663367, loss_ss: 1.334941, loss_d: 0.328426
0.8071 --- loss: 1.854076, loss_ss: 1.498938, loss_d: 0.355139
0.8455 --- loss: 1.576639, loss_ss: 1.228504, loss_d: 0.348135
0.8839 --- loss: 1.848767, loss_ss: 1.092092, loss_d: 0.756676
0.9224 --- loss: 1.799900, loss_ss: 1.345194, loss_d: 0.454706
0.9608 --- loss: 1.911345, loss_ss: 1.134696, loss_d: 0.776649
0.9992 --- loss: 2.014847, loss_ss: 1.655641, loss_d: 0.359206
Epoch finished! Loss: 1.788993611244055
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.537708, loss_ss: 1.151498, loss_d: 0.386210
0.0384 --- loss: 1.597107, loss_ss: 1.215563, loss_d: 0.381544
0.0769 --- loss: 1.425170, loss_ss: 0.997802, loss_d: 0.427369
0.1153 --- loss: 1.928555, loss_ss: 1.292627, loss_d: 0.635928
0.1537 --- loss: 1.782807, loss_ss: 1.314655, loss_d: 0.468152
0.1922 --- loss: 1.629590, loss_ss: 1.245042, loss_d: 0.384548
0.2306 --- loss: 1.912532, loss_ss: 1.083531, loss_d: 0.829001
0.2690 --- loss: 1.769613, loss_ss: 1.415394, loss_d: 0.354220
0.3075 --- loss: 1.791792, loss_ss: 1.279863, loss_d: 0.511928
0.3459 --- loss: 1.928319, loss_ss: 1.366007, loss_d: 0.562312
0.3843 --- loss: 1.652991, loss_ss: 1.195580, loss_d: 0.457411
0.4228 --- loss: 1.494618, loss_ss: 1.034302, loss_d: 0.460316
0.4612 --- loss: 1.798048, loss_ss: 1.450211, loss_d: 0.347837
0.4996 --- loss: 1.562127, loss_ss: 1.187954, loss_d: 0.374173
0.5380 --- loss: 1.800452, loss_ss: 1.365535, loss_d: 0.434917
0.5765 --- loss: 1.578283, loss_ss: 1.194227, loss_d: 0.384056
0.6149 --- loss: 1.710024, loss_ss: 1.439790, loss_d: 0.270234
0.6533 --- loss: 1.770014, loss_ss: 1.472819, loss_d: 0.297195
0.6918 --- loss: 2.179490, loss_ss: 1.178093, loss_d: 1.001397
0.7302 --- loss: 1.694198, loss_ss: 1.326796, loss_d: 0.367402
0.7686 --- loss: 1.898164, loss_ss: 1.091391, loss_d: 0.806773
0.8071 --- loss: 1.520100, loss_ss: 1.088744, loss_d: 0.431356
0.8455 --- loss: 1.435229, loss_ss: 1.090067, loss_d: 0.345162
0.8839 --- loss: 1.551107, loss_ss: 1.161666, loss_d: 0.389441
0.9224 --- loss: 1.470570, loss_ss: 1.135878, loss_d: 0.334692
0.9608 --- loss: 1.584231, loss_ss: 1.212784, loss_d: 0.371447
0.9992 --- loss: 1.578471, loss_ss: 1.196991, loss_d: 0.381481
Epoch finished! Loss: 1.6956447725112622
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.540916, loss_ss: 1.150270, loss_d: 0.390646
0.0384 --- loss: 1.500603, loss_ss: 1.110790, loss_d: 0.389813
0.0769 --- loss: 1.773582, loss_ss: 1.272971, loss_d: 0.500611
0.1153 --- loss: 1.768809, loss_ss: 1.207664, loss_d: 0.561145
0.1537 --- loss: 1.648608, loss_ss: 1.246140, loss_d: 0.402469
0.1922 --- loss: 1.437191, loss_ss: 1.036140, loss_d: 0.401051
0.2306 --- loss: 2.188671, loss_ss: 1.231079, loss_d: 0.957592
0.2690 --- loss: 1.706419, loss_ss: 1.306309, loss_d: 0.400110
0.3075 --- loss: 1.492601, loss_ss: 1.008441, loss_d: 0.484160
0.3459 --- loss: 1.546708, loss_ss: 0.983512, loss_d: 0.563196
0.3843 --- loss: 1.807897, loss_ss: 1.272718, loss_d: 0.535179
0.4228 --- loss: 1.859981, loss_ss: 1.161010, loss_d: 0.698971
0.4612 --- loss: 1.436250, loss_ss: 1.105422, loss_d: 0.330828
0.4996 --- loss: 1.765601, loss_ss: 1.273741, loss_d: 0.491861
0.5380 --- loss: 1.750619, loss_ss: 1.098940, loss_d: 0.651680
0.5765 --- loss: 1.377413, loss_ss: 1.013494, loss_d: 0.363918
0.6149 --- loss: 1.435998, loss_ss: 1.111418, loss_d: 0.324579
0.6533 --- loss: 1.516359, loss_ss: 1.138888, loss_d: 0.377471
0.6918 --- loss: 1.574652, loss_ss: 0.976917, loss_d: 0.597735
0.7302 --- loss: 1.605615, loss_ss: 1.036947, loss_d: 0.568668
0.7686 --- loss: 1.437042, loss_ss: 1.138795, loss_d: 0.298246
0.8071 --- loss: 1.538996, loss_ss: 1.035819, loss_d: 0.503177
0.8455 --- loss: 1.885713, loss_ss: 1.341430, loss_d: 0.544283
0.8839 --- loss: 1.542502, loss_ss: 1.095072, loss_d: 0.447430
0.9224 --- loss: 1.449725, loss_ss: 0.993771, loss_d: 0.455954
0.9608 --- loss: 1.803771, loss_ss: 1.432631, loss_d: 0.371141
0.9992 --- loss: 1.484869, loss_ss: 1.148033, loss_d: 0.336837
Epoch finished! Loss: 1.634253793496352
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.964616, loss_ss: 1.577599, loss_d: 0.387017
0.0384 --- loss: 1.799943, loss_ss: 1.451943, loss_d: 0.348000
0.0769 --- loss: 1.675320, loss_ss: 1.272322, loss_d: 0.402998
0.1153 --- loss: 1.322762, loss_ss: 0.936562, loss_d: 0.386199
0.1537 --- loss: 1.678345, loss_ss: 1.158767, loss_d: 0.519578
0.1922 --- loss: 1.423340, loss_ss: 1.003719, loss_d: 0.419620
0.2306 --- loss: 1.259648, loss_ss: 0.952336, loss_d: 0.307312
0.2690 --- loss: 1.583634, loss_ss: 1.180809, loss_d: 0.402825
0.3075 --- loss: 1.721773, loss_ss: 1.416880, loss_d: 0.304893
0.3459 --- loss: 1.250243, loss_ss: 0.974367, loss_d: 0.275876
0.3843 --- loss: 1.288862, loss_ss: 0.967661, loss_d: 0.321201
0.4228 --- loss: 1.723724, loss_ss: 1.189886, loss_d: 0.533838
0.4612 --- loss: 1.302595, loss_ss: 1.072332, loss_d: 0.230263
0.4996 --- loss: 1.252524, loss_ss: 1.047576, loss_d: 0.204948
0.5380 --- loss: 1.354676, loss_ss: 1.038208, loss_d: 0.316468
0.5765 --- loss: 1.679443, loss_ss: 1.205611, loss_d: 0.473832
0.6149 --- loss: 1.626535, loss_ss: 1.128145, loss_d: 0.498390
0.6533 --- loss: 1.271824, loss_ss: 0.975115, loss_d: 0.296708
0.6918 --- loss: 1.611145, loss_ss: 1.074567, loss_d: 0.536578
0.7302 --- loss: 1.438303, loss_ss: 1.113088, loss_d: 0.325215
0.7686 --- loss: 1.542273, loss_ss: 1.081109, loss_d: 0.461164
0.8071 --- loss: 1.928678, loss_ss: 1.229533, loss_d: 0.699145
0.8455 --- loss: 1.620830, loss_ss: 1.057968, loss_d: 0.562862
0.8839 --- loss: 1.972401, loss_ss: 1.579640, loss_d: 0.392762
0.9224 --- loss: 1.841942, loss_ss: 1.429656, loss_d: 0.412286
0.9608 --- loss: 1.408267, loss_ss: 1.085351, loss_d: 0.322916
0.9992 --- loss: 1.597358, loss_ss: 1.241514, loss_d: 0.355844
Epoch finished! Loss: 1.6051199014370259
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.701936, loss_ss: 1.244725, loss_d: 0.457211
0.0384 --- loss: 1.533225, loss_ss: 1.201324, loss_d: 0.331902
0.0769 --- loss: 1.428036, loss_ss: 0.987024, loss_d: 0.441012
0.1153 --- loss: 1.586634, loss_ss: 1.085907, loss_d: 0.500727
0.1537 --- loss: 1.644389, loss_ss: 1.247282, loss_d: 0.397107
0.1922 --- loss: 1.412119, loss_ss: 1.034790, loss_d: 0.377329
0.2306 --- loss: 1.594650, loss_ss: 1.319005, loss_d: 0.275645
0.2690 --- loss: 1.645607, loss_ss: 0.984752, loss_d: 0.660855
0.3075 --- loss: 1.922685, loss_ss: 1.234686, loss_d: 0.687999
0.3459 --- loss: 1.641106, loss_ss: 1.081871, loss_d: 0.559236
0.3843 --- loss: 1.093371, loss_ss: 0.888706, loss_d: 0.204664
0.4228 --- loss: 1.795215, loss_ss: 1.177777, loss_d: 0.617438
0.4612 --- loss: 1.834851, loss_ss: 1.414902, loss_d: 0.419949
0.4996 --- loss: 1.552978, loss_ss: 1.145951, loss_d: 0.407027
0.5380 --- loss: 1.702436, loss_ss: 1.077169, loss_d: 0.625266
0.5765 --- loss: 1.363151, loss_ss: 1.027255, loss_d: 0.335896
0.6149 --- loss: 1.405591, loss_ss: 1.050411, loss_d: 0.355180
0.6533 --- loss: 1.359825, loss_ss: 1.059697, loss_d: 0.300128
0.6918 --- loss: 1.507924, loss_ss: 1.071528, loss_d: 0.436397
0.7302 --- loss: 1.455937, loss_ss: 1.062958, loss_d: 0.392979
0.7686 --- loss: 1.533061, loss_ss: 1.168022, loss_d: 0.365039
0.8071 --- loss: 1.667315, loss_ss: 1.074542, loss_d: 0.592773
0.8455 --- loss: 2.639720, loss_ss: 1.216640, loss_d: 1.423080
0.8839 --- loss: 1.280896, loss_ss: 0.940308, loss_d: 0.340588
0.9224 --- loss: 1.330933, loss_ss: 0.886559, loss_d: 0.444375
0.9608 --- loss: 1.154014, loss_ss: 0.722280, loss_d: 0.431734
0.9992 --- loss: 2.712628, loss_ss: 0.995567, loss_d: 1.717061
Epoch finished! Loss: 1.565972477197647
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.402694, loss_ss: 1.001499, loss_d: 0.401195
0.0384 --- loss: 1.839781, loss_ss: 1.209725, loss_d: 0.630056
0.0769 --- loss: 1.409670, loss_ss: 1.092024, loss_d: 0.317647
0.1153 --- loss: 1.874922, loss_ss: 1.097654, loss_d: 0.777269
0.1537 --- loss: 1.260464, loss_ss: 0.861957, loss_d: 0.398508
0.1922 --- loss: 1.511279, loss_ss: 1.065866, loss_d: 0.445413
0.2306 --- loss: 1.311148, loss_ss: 0.985020, loss_d: 0.326127
0.2690 --- loss: 1.461792, loss_ss: 0.940074, loss_d: 0.521718
0.3075 --- loss: 1.593037, loss_ss: 1.379036, loss_d: 0.214000
0.3459 --- loss: 1.397840, loss_ss: 0.922831, loss_d: 0.475010
0.3843 --- loss: 1.311303, loss_ss: 1.066086, loss_d: 0.245217
0.4228 --- loss: 2.120751, loss_ss: 0.901794, loss_d: 1.218956
0.4612 --- loss: 1.508790, loss_ss: 0.911158, loss_d: 0.597631
0.4996 --- loss: 1.577828, loss_ss: 1.172146, loss_d: 0.405682
0.5380 --- loss: 1.606453, loss_ss: 1.269803, loss_d: 0.336650
0.5765 --- loss: 1.403740, loss_ss: 1.104135, loss_d: 0.299605
0.6149 --- loss: 1.654973, loss_ss: 1.219554, loss_d: 0.435419
0.6533 --- loss: 1.430611, loss_ss: 1.121076, loss_d: 0.309535
0.6918 --- loss: 1.670910, loss_ss: 1.339287, loss_d: 0.331623
0.7302 --- loss: 1.436327, loss_ss: 0.969542, loss_d: 0.466785
0.7686 --- loss: 1.364922, loss_ss: 1.008887, loss_d: 0.356034
0.8071 --- loss: 1.454728, loss_ss: 1.067423, loss_d: 0.387305
0.8455 --- loss: 1.596950, loss_ss: 1.086198, loss_d: 0.510752
0.8839 --- loss: 2.137407, loss_ss: 1.361193, loss_d: 0.776214
0.9224 --- loss: 1.245034, loss_ss: 0.998555, loss_d: 0.246479
0.9608 --- loss: 1.371153, loss_ss: 0.998046, loss_d: 0.373107
0.9992 --- loss: 1.388216, loss_ss: 1.075395, loss_d: 0.312821
Epoch finished! Loss: 1.543967757316736
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.549469, loss_ss: 1.076497, loss_d: 0.472971
0.0384 --- loss: 1.712453, loss_ss: 1.072567, loss_d: 0.639886
0.0769 --- loss: 1.256701, loss_ss: 0.984311, loss_d: 0.272390
0.1153 --- loss: 1.410507, loss_ss: 1.031306, loss_d: 0.379202
0.1537 --- loss: 1.432969, loss_ss: 1.135895, loss_d: 0.297074
0.1922 --- loss: 2.105770, loss_ss: 1.231198, loss_d: 0.874572
0.2306 --- loss: 1.467547, loss_ss: 1.159285, loss_d: 0.308262
0.2690 --- loss: 1.291070, loss_ss: 0.937755, loss_d: 0.353316
0.3075 --- loss: 1.392632, loss_ss: 1.099777, loss_d: 0.292855
0.3459 --- loss: 1.642580, loss_ss: 0.902526, loss_d: 0.740054
0.3843 --- loss: 1.429191, loss_ss: 0.943340, loss_d: 0.485851
0.4228 --- loss: 1.395415, loss_ss: 1.032980, loss_d: 0.362435
0.4612 --- loss: 1.220798, loss_ss: 0.835897, loss_d: 0.384901
0.4996 --- loss: 1.199039, loss_ss: 0.912220, loss_d: 0.286820
0.5380 --- loss: 1.521707, loss_ss: 1.283454, loss_d: 0.238253
0.5765 --- loss: 1.625427, loss_ss: 1.055515, loss_d: 0.569912
0.6149 --- loss: 1.655738, loss_ss: 1.116479, loss_d: 0.539260
0.6533 --- loss: 1.180054, loss_ss: 0.790521, loss_d: 0.389533
0.6918 --- loss: 1.568494, loss_ss: 1.173242, loss_d: 0.395253
0.7302 --- loss: 1.617230, loss_ss: 0.879648, loss_d: 0.737582
0.7686 --- loss: 1.440725, loss_ss: 1.092807, loss_d: 0.347918
0.8071 --- loss: 1.340904, loss_ss: 0.980936, loss_d: 0.359968
0.8455 --- loss: 1.456011, loss_ss: 1.203067, loss_d: 0.252943
0.8839 --- loss: 1.533591, loss_ss: 1.228439, loss_d: 0.305151
0.9224 --- loss: 1.391885, loss_ss: 1.093743, loss_d: 0.298142
0.9608 --- loss: 1.232625, loss_ss: 0.937861, loss_d: 0.294764
0.9992 --- loss: 1.599922, loss_ss: 1.182042, loss_d: 0.417880
Epoch finished! Loss: 1.5142020028371077
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5842592592592593
             precision    recall  f1-score   support

        0.0       0.56      0.46      0.50       196
        1.0       0.00      0.00      0.00        58
        2.0       0.66      0.78      0.72       527
        3.0       0.29      0.61      0.40        33
        4.0       0.49      0.41      0.44       266

avg / total       0.55      0.58      0.56      1080
 


====== chp041-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  83.52  45.92   91.86  55.56     50.28
1  94.63   0.00  100.00   0.00      0.00
2  69.54  78.37   61.12  65.76     71.52
3  94.35  60.61   95.42  29.41     39.60
4  74.81  40.60   86.00  48.65     44.26
Total accuracy: 58.43%
Average sen: 45.10%
Average spec: 86.88%
Macro f1-score: 41.13%
[0.44603041 0.576042   0.47061506 0.5390721  0.61609918 0.6130181
 0.64265782 0.70015007 0.52862942 0.49900052 0.52804077 0.47279027
 0.50514984 0.50601941 0.44825321 0.48712668 0.51305503 0.42161962
 0.55049211 0.3926751  0.39340365 0.40662339 0.50411886 0.39674821
 0.40286654 0.44786412 0.56888193 0.3886179  0.42942268 0.397946
 0.41831341 0.41880646 0.38018072 0.55378729 0.57188129 0.37674114]
pred: 0.4864650087224113, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.408914, loss_ss: 1.661445, loss_d: 0.747469
0.0384 --- loss: 2.255768, loss_ss: 1.696511, loss_d: 0.559257
0.0769 --- loss: 2.562472, loss_ss: 1.816852, loss_d: 0.745620
0.1153 --- loss: 2.406618, loss_ss: 1.627309, loss_d: 0.779310
0.1538 --- loss: 2.293078, loss_ss: 1.701352, loss_d: 0.591726
0.1922 --- loss: 2.469401, loss_ss: 1.742332, loss_d: 0.727069
0.2307 --- loss: 2.446055, loss_ss: 1.693120, loss_d: 0.752936
0.2691 --- loss: 1.957682, loss_ss: 1.590098, loss_d: 0.367584
0.3076 --- loss: 2.018794, loss_ss: 1.540391, loss_d: 0.478403
0.3460 --- loss: 2.190276, loss_ss: 1.658290, loss_d: 0.531986
0.3845 --- loss: 2.260458, loss_ss: 1.594017, loss_d: 0.666442
0.4229 --- loss: 2.044353, loss_ss: 1.504809, loss_d: 0.539543
0.4614 --- loss: 2.384653, loss_ss: 1.608656, loss_d: 0.775997
0.4998 --- loss: 2.224471, loss_ss: 1.611324, loss_d: 0.613147
0.5383 --- loss: 2.053594, loss_ss: 1.574371, loss_d: 0.479222
0.5767 --- loss: 2.025645, loss_ss: 1.584447, loss_d: 0.441199
0.6151 --- loss: 2.463393, loss_ss: 1.541147, loss_d: 0.922245
0.6536 --- loss: 1.998750, loss_ss: 1.598300, loss_d: 0.400450
0.6920 --- loss: 1.861272, loss_ss: 1.482261, loss_d: 0.379011
0.7305 --- loss: 1.825716, loss_ss: 1.552323, loss_d: 0.273393
0.7689 --- loss: 2.013826, loss_ss: 1.668758, loss_d: 0.345068
0.8074 --- loss: 2.106225, loss_ss: 1.504700, loss_d: 0.601525
0.8458 --- loss: 1.818881, loss_ss: 1.521046, loss_d: 0.297834
0.8843 --- loss: 2.521531, loss_ss: 1.573269, loss_d: 0.948262
0.9227 --- loss: 2.154651, loss_ss: 1.518653, loss_d: 0.635998
0.9612 --- loss: 2.119819, loss_ss: 1.608157, loss_d: 0.511662
0.9996 --- loss: 1.515080, loss_ss: 1.232067, loss_d: 0.283013
Epoch finished! Loss: 2.1549321064582236
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.970436, loss_ss: 1.541634, loss_d: 0.428801
0.0384 --- loss: 1.870281, loss_ss: 1.450937, loss_d: 0.419344
0.0769 --- loss: 1.912021, loss_ss: 1.559245, loss_d: 0.352776
0.1153 --- loss: 2.025600, loss_ss: 1.516222, loss_d: 0.509378
0.1538 --- loss: 2.177110, loss_ss: 1.594750, loss_d: 0.582360
0.1922 --- loss: 2.154976, loss_ss: 1.693750, loss_d: 0.461226
0.2307 --- loss: 2.235788, loss_ss: 1.434184, loss_d: 0.801604
0.2691 --- loss: 1.861967, loss_ss: 1.294790, loss_d: 0.567177
0.3076 --- loss: 2.036719, loss_ss: 1.306731, loss_d: 0.729988
0.3460 --- loss: 1.783211, loss_ss: 1.406746, loss_d: 0.376465
0.3845 --- loss: 2.020601, loss_ss: 1.220941, loss_d: 0.799660
0.4229 --- loss: 2.260990, loss_ss: 1.629272, loss_d: 0.631718
0.4614 --- loss: 1.926765, loss_ss: 1.451613, loss_d: 0.475151
0.4998 --- loss: 1.892964, loss_ss: 1.482544, loss_d: 0.410419
0.5383 --- loss: 1.920802, loss_ss: 1.622056, loss_d: 0.298746
0.5767 --- loss: 1.778733, loss_ss: 1.460923, loss_d: 0.317810
0.6151 --- loss: 2.098397, loss_ss: 1.485449, loss_d: 0.612948
0.6536 --- loss: 1.960891, loss_ss: 1.582585, loss_d: 0.378307
0.6920 --- loss: 1.703251, loss_ss: 1.346232, loss_d: 0.357018
0.7305 --- loss: 2.303162, loss_ss: 1.660586, loss_d: 0.642576
0.7689 --- loss: 2.015679, loss_ss: 1.495122, loss_d: 0.520558
0.8074 --- loss: 2.428597, loss_ss: 1.635317, loss_d: 0.793280
0.8458 --- loss: 2.171843, loss_ss: 1.596688, loss_d: 0.575155
0.8843 --- loss: 2.259612, loss_ss: 1.563987, loss_d: 0.695625
0.9227 --- loss: 1.909500, loss_ss: 1.478278, loss_d: 0.431222
0.9612 --- loss: 1.571014, loss_ss: 1.311060, loss_d: 0.259955
0.9996 --- loss: 2.173680, loss_ss: 2.044038, loss_d: 0.129642
Epoch finished! Loss: 2.0043806988459365
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.919428, loss_ss: 1.348647, loss_d: 0.570781
0.0384 --- loss: 1.925523, loss_ss: 1.381479, loss_d: 0.544044
0.0769 --- loss: 1.860185, loss_ss: 1.415914, loss_d: 0.444271
0.1153 --- loss: 2.046959, loss_ss: 1.605072, loss_d: 0.441887
0.1538 --- loss: 2.301811, loss_ss: 1.439612, loss_d: 0.862200
0.1922 --- loss: 2.050432, loss_ss: 1.566851, loss_d: 0.483581
0.2307 --- loss: 1.914422, loss_ss: 1.515596, loss_d: 0.398826
0.2691 --- loss: 1.931294, loss_ss: 1.543711, loss_d: 0.387583
0.3076 --- loss: 2.193853, loss_ss: 1.551036, loss_d: 0.642817
0.3460 --- loss: 1.875293, loss_ss: 1.537900, loss_d: 0.337393
0.3845 --- loss: 1.887751, loss_ss: 1.473495, loss_d: 0.414256
0.4229 --- loss: 2.212711, loss_ss: 1.562937, loss_d: 0.649775
0.4614 --- loss: 1.798740, loss_ss: 1.481791, loss_d: 0.316949
0.4998 --- loss: 2.144042, loss_ss: 1.548754, loss_d: 0.595288
0.5383 --- loss: 1.848507, loss_ss: 1.562353, loss_d: 0.286153
0.5767 --- loss: 1.589767, loss_ss: 1.250462, loss_d: 0.339305
0.6151 --- loss: 1.889932, loss_ss: 1.478109, loss_d: 0.411822
0.6536 --- loss: 1.852801, loss_ss: 1.341208, loss_d: 0.511593
0.6920 --- loss: 2.094241, loss_ss: 1.618276, loss_d: 0.475966
0.7305 --- loss: 1.695620, loss_ss: 1.319510, loss_d: 0.376110
0.7689 --- loss: 1.746850, loss_ss: 1.274888, loss_d: 0.471961
0.8074 --- loss: 1.737586, loss_ss: 1.249802, loss_d: 0.487784
0.8458 --- loss: 1.790595, loss_ss: 1.427131, loss_d: 0.363464
0.8843 --- loss: 1.926639, loss_ss: 1.351288, loss_d: 0.575351
0.9227 --- loss: 1.686261, loss_ss: 1.328980, loss_d: 0.357281
0.9612 --- loss: 1.874870, loss_ss: 1.308935, loss_d: 0.565935
0.9996 --- loss: 2.501644, loss_ss: 0.978814, loss_d: 1.522830
Epoch finished! Loss: 1.9494960124676044
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.073722, loss_ss: 1.488223, loss_d: 0.585499
0.0384 --- loss: 1.943159, loss_ss: 1.469162, loss_d: 0.473997
0.0769 --- loss: 1.973486, loss_ss: 1.351901, loss_d: 0.621584
0.1153 --- loss: 1.720960, loss_ss: 1.416680, loss_d: 0.304279
0.1538 --- loss: 2.325359, loss_ss: 1.476071, loss_d: 0.849288
0.1922 --- loss: 1.846186, loss_ss: 1.476791, loss_d: 0.369395
0.2307 --- loss: 1.797553, loss_ss: 1.276812, loss_d: 0.520741
0.2691 --- loss: 1.636653, loss_ss: 1.249450, loss_d: 0.387203
0.3076 --- loss: 1.698514, loss_ss: 1.249270, loss_d: 0.449245
0.3460 --- loss: 1.648732, loss_ss: 1.236452, loss_d: 0.412280
0.3845 --- loss: 1.619970, loss_ss: 1.149229, loss_d: 0.470741
0.4229 --- loss: 1.909501, loss_ss: 1.513196, loss_d: 0.396305
0.4614 --- loss: 1.627076, loss_ss: 1.194901, loss_d: 0.432174
0.4998 --- loss: 1.734989, loss_ss: 1.276256, loss_d: 0.458734
0.5383 --- loss: 1.854551, loss_ss: 1.292267, loss_d: 0.562283
0.5767 --- loss: 1.856463, loss_ss: 1.422474, loss_d: 0.433989
0.6151 --- loss: 1.595721, loss_ss: 1.190113, loss_d: 0.405609
0.6536 --- loss: 1.725370, loss_ss: 1.191233, loss_d: 0.534137
0.6920 --- loss: 1.663592, loss_ss: 1.225470, loss_d: 0.438122
0.7305 --- loss: 1.665631, loss_ss: 1.144965, loss_d: 0.520666
0.7689 --- loss: 1.506994, loss_ss: 1.125259, loss_d: 0.381734
0.8074 --- loss: 1.800036, loss_ss: 1.290884, loss_d: 0.509152
0.8458 --- loss: 1.484150, loss_ss: 1.047678, loss_d: 0.436473
0.8843 --- loss: 1.555738, loss_ss: 1.153463, loss_d: 0.402275
0.9227 --- loss: 1.833526, loss_ss: 1.227612, loss_d: 0.605914
0.9612 --- loss: 1.817237, loss_ss: 1.221299, loss_d: 0.595939
0.9996 --- loss: 1.367057, loss_ss: 1.023743, loss_d: 0.343314
Epoch finished! Loss: 1.8234432908204885
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.746838, loss_ss: 1.295521, loss_d: 0.451317
0.0384 --- loss: 1.719135, loss_ss: 1.271686, loss_d: 0.447449
0.0769 --- loss: 1.733270, loss_ss: 1.296104, loss_d: 0.437166
0.1153 --- loss: 1.700790, loss_ss: 1.363029, loss_d: 0.337761
0.1538 --- loss: 1.588722, loss_ss: 1.155388, loss_d: 0.433335
0.1922 --- loss: 2.184718, loss_ss: 1.531366, loss_d: 0.653352
0.2307 --- loss: 1.648349, loss_ss: 1.304669, loss_d: 0.343680
0.2691 --- loss: 2.054909, loss_ss: 1.287419, loss_d: 0.767490
0.3076 --- loss: 1.605429, loss_ss: 1.119086, loss_d: 0.486344
0.3460 --- loss: 1.710369, loss_ss: 1.317883, loss_d: 0.392486
0.3845 --- loss: 1.743855, loss_ss: 1.158733, loss_d: 0.585122
0.4229 --- loss: 1.523199, loss_ss: 1.183922, loss_d: 0.339277
0.4614 --- loss: 1.436168, loss_ss: 1.066045, loss_d: 0.370123
0.4998 --- loss: 1.880269, loss_ss: 1.537939, loss_d: 0.342329
0.5383 --- loss: 1.615636, loss_ss: 1.293746, loss_d: 0.321890
0.5767 --- loss: 1.504914, loss_ss: 1.062712, loss_d: 0.442202
0.6151 --- loss: 1.756634, loss_ss: 1.288584, loss_d: 0.468049
0.6536 --- loss: 1.447553, loss_ss: 1.113572, loss_d: 0.333981
0.6920 --- loss: 1.771378, loss_ss: 1.330944, loss_d: 0.440434
0.7305 --- loss: 1.769917, loss_ss: 1.375235, loss_d: 0.394682
0.7689 --- loss: 1.804384, loss_ss: 1.216815, loss_d: 0.587568
0.8074 --- loss: 2.060109, loss_ss: 1.381081, loss_d: 0.679028
0.8458 --- loss: 1.826499, loss_ss: 1.345311, loss_d: 0.481188
0.8843 --- loss: 1.737281, loss_ss: 1.072908, loss_d: 0.664373
0.9227 --- loss: 1.895214, loss_ss: 1.160014, loss_d: 0.735200
0.9612 --- loss: 1.813147, loss_ss: 0.898461, loss_d: 0.914685
0.9996 --- loss: 1.135531, loss_ss: 0.932902, loss_d: 0.202630
Epoch finished! Loss: 1.7105378705721634
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.968137, loss_ss: 1.186636, loss_d: 0.781501
0.0384 --- loss: 1.598107, loss_ss: 1.112045, loss_d: 0.486061
0.0769 --- loss: 1.734400, loss_ss: 1.234292, loss_d: 0.500108
0.1153 --- loss: 1.552182, loss_ss: 1.229123, loss_d: 0.323059
0.1538 --- loss: 1.543513, loss_ss: 1.029098, loss_d: 0.514415
0.1922 --- loss: 1.909133, loss_ss: 1.351066, loss_d: 0.558068
0.2307 --- loss: 1.613807, loss_ss: 0.925655, loss_d: 0.688152
0.2691 --- loss: 1.632444, loss_ss: 1.042957, loss_d: 0.589487
0.3076 --- loss: 1.589270, loss_ss: 1.286173, loss_d: 0.303096
0.3460 --- loss: 1.546997, loss_ss: 1.121032, loss_d: 0.425966
0.3845 --- loss: 1.663444, loss_ss: 1.097021, loss_d: 0.566423
0.4229 --- loss: 1.513534, loss_ss: 1.131950, loss_d: 0.381584
0.4614 --- loss: 1.772728, loss_ss: 1.253161, loss_d: 0.519566
0.4998 --- loss: 1.443228, loss_ss: 0.990726, loss_d: 0.452502
0.5383 --- loss: 1.440122, loss_ss: 0.990758, loss_d: 0.449364
0.5767 --- loss: 1.863449, loss_ss: 1.428046, loss_d: 0.435402
0.6151 --- loss: 1.592942, loss_ss: 0.866297, loss_d: 0.726645
0.6536 --- loss: 1.707713, loss_ss: 1.303105, loss_d: 0.404608
0.6920 --- loss: 1.524260, loss_ss: 1.107753, loss_d: 0.416506
0.7305 --- loss: 1.696149, loss_ss: 1.299875, loss_d: 0.396274
0.7689 --- loss: 1.464924, loss_ss: 0.984479, loss_d: 0.480445
0.8074 --- loss: 2.302439, loss_ss: 1.326330, loss_d: 0.976110
0.8458 --- loss: 1.320702, loss_ss: 0.953425, loss_d: 0.367277
0.8843 --- loss: 1.654159, loss_ss: 1.140715, loss_d: 0.513444
0.9227 --- loss: 1.631624, loss_ss: 1.145168, loss_d: 0.486456
0.9612 --- loss: 1.698957, loss_ss: 1.345033, loss_d: 0.353924
0.9996 --- loss: 1.258545, loss_ss: 1.065388, loss_d: 0.193157
Epoch finished! Loss: 1.6627340646890494
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.957790, loss_ss: 1.232362, loss_d: 0.725428
0.0384 --- loss: 1.635533, loss_ss: 1.350012, loss_d: 0.285520
0.0769 --- loss: 1.660269, loss_ss: 1.109082, loss_d: 0.551187
0.1153 --- loss: 1.468008, loss_ss: 1.074070, loss_d: 0.393938
0.1538 --- loss: 1.446907, loss_ss: 1.074582, loss_d: 0.372325
0.1922 --- loss: 1.288349, loss_ss: 0.882348, loss_d: 0.406002
0.2307 --- loss: 1.774833, loss_ss: 1.213729, loss_d: 0.561103
0.2691 --- loss: 1.721715, loss_ss: 1.313661, loss_d: 0.408055
0.3076 --- loss: 1.404544, loss_ss: 1.054453, loss_d: 0.350092
0.3460 --- loss: 1.585655, loss_ss: 1.279700, loss_d: 0.305955
0.3845 --- loss: 1.578694, loss_ss: 1.082202, loss_d: 0.496492
0.4229 --- loss: 1.986356, loss_ss: 1.364448, loss_d: 0.621908
0.4614 --- loss: 1.487190, loss_ss: 0.947370, loss_d: 0.539820
0.4998 --- loss: 1.805896, loss_ss: 1.194000, loss_d: 0.611896
0.5383 --- loss: 1.503304, loss_ss: 1.235194, loss_d: 0.268110
0.5767 --- loss: 1.560186, loss_ss: 1.143230, loss_d: 0.416956
0.6151 --- loss: 1.530152, loss_ss: 1.010539, loss_d: 0.519613
0.6536 --- loss: 1.443452, loss_ss: 1.041937, loss_d: 0.401515
0.6920 --- loss: 1.751348, loss_ss: 1.341823, loss_d: 0.409525
0.7305 --- loss: 2.383417, loss_ss: 1.801301, loss_d: 0.582116
0.7689 --- loss: 1.418664, loss_ss: 1.146366, loss_d: 0.272298
0.8074 --- loss: 1.263925, loss_ss: 0.983378, loss_d: 0.280547
0.8458 --- loss: 1.993892, loss_ss: 1.598580, loss_d: 0.395312
0.8843 --- loss: 2.249754, loss_ss: 1.426276, loss_d: 0.823478
0.9227 --- loss: 1.650996, loss_ss: 1.092455, loss_d: 0.558541
0.9612 --- loss: 1.056715, loss_ss: 0.879557, loss_d: 0.177158
0.9996 --- loss: 2.552072, loss_ss: 2.351226, loss_d: 0.200846
Epoch finished! Loss: 1.6274001602943127
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.608225, loss_ss: 1.307599, loss_d: 0.300627
0.0384 --- loss: 1.659987, loss_ss: 0.969063, loss_d: 0.690924
0.0769 --- loss: 1.694010, loss_ss: 1.123700, loss_d: 0.570310
0.1153 --- loss: 1.418811, loss_ss: 1.046883, loss_d: 0.371929
0.1538 --- loss: 1.229777, loss_ss: 0.951115, loss_d: 0.278661
0.1922 --- loss: 1.433961, loss_ss: 1.062560, loss_d: 0.371401
0.2307 --- loss: 1.391379, loss_ss: 1.081713, loss_d: 0.309666
0.2691 --- loss: 1.380080, loss_ss: 1.070155, loss_d: 0.309925
0.3076 --- loss: 1.843889, loss_ss: 0.904118, loss_d: 0.939771
0.3460 --- loss: 1.389232, loss_ss: 1.081831, loss_d: 0.307402
0.3845 --- loss: 1.460828, loss_ss: 1.043005, loss_d: 0.417823
0.4229 --- loss: 1.495145, loss_ss: 1.206007, loss_d: 0.289139
0.4614 --- loss: 1.552661, loss_ss: 1.090168, loss_d: 0.462494
0.4998 --- loss: 1.651232, loss_ss: 1.158887, loss_d: 0.492346
0.5383 --- loss: 1.446476, loss_ss: 1.039294, loss_d: 0.407182
0.5767 --- loss: 1.657619, loss_ss: 1.139944, loss_d: 0.517675
0.6151 --- loss: 1.554885, loss_ss: 1.123152, loss_d: 0.431733
0.6536 --- loss: 1.708506, loss_ss: 1.242191, loss_d: 0.466316
0.6920 --- loss: 1.690566, loss_ss: 1.071954, loss_d: 0.618612
0.7305 --- loss: 1.517988, loss_ss: 1.029770, loss_d: 0.488218
0.7689 --- loss: 1.692626, loss_ss: 1.156150, loss_d: 0.536475
0.8074 --- loss: 1.449309, loss_ss: 1.131278, loss_d: 0.318031
0.8458 --- loss: 1.541964, loss_ss: 0.843737, loss_d: 0.698227
0.8843 --- loss: 1.509134, loss_ss: 1.083143, loss_d: 0.425991
0.9227 --- loss: 1.505603, loss_ss: 1.002698, loss_d: 0.502904
0.9612 --- loss: 1.588757, loss_ss: 1.258642, loss_d: 0.330115
0.9996 --- loss: 1.281214, loss_ss: 1.167353, loss_d: 0.113861
Epoch finished! Loss: 1.577767341870528
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.886232, loss_ss: 1.300156, loss_d: 0.586076
0.0384 --- loss: 2.270274, loss_ss: 1.049965, loss_d: 1.220309
0.0769 --- loss: 1.527947, loss_ss: 1.061247, loss_d: 0.466700
0.1153 --- loss: 1.495075, loss_ss: 1.179582, loss_d: 0.315493
0.1538 --- loss: 1.502416, loss_ss: 1.081086, loss_d: 0.421330
0.1922 --- loss: 1.559982, loss_ss: 0.894710, loss_d: 0.665272
0.2307 --- loss: 1.353584, loss_ss: 1.006204, loss_d: 0.347380
0.2691 --- loss: 1.698254, loss_ss: 0.896070, loss_d: 0.802184
0.3076 --- loss: 1.248810, loss_ss: 0.913736, loss_d: 0.335075
0.3460 --- loss: 1.275678, loss_ss: 0.933490, loss_d: 0.342188
0.3845 --- loss: 1.428663, loss_ss: 1.182393, loss_d: 0.246271
0.4229 --- loss: 1.802133, loss_ss: 1.255781, loss_d: 0.546352
0.4614 --- loss: 1.348021, loss_ss: 0.978199, loss_d: 0.369822
0.4998 --- loss: 1.492479, loss_ss: 1.186933, loss_d: 0.305546
0.5383 --- loss: 1.311102, loss_ss: 1.027425, loss_d: 0.283677
0.5767 --- loss: 1.332104, loss_ss: 0.980846, loss_d: 0.351258
0.6151 --- loss: 1.608922, loss_ss: 1.422064, loss_d: 0.186857
0.6536 --- loss: 1.382806, loss_ss: 1.154540, loss_d: 0.228265
0.6920 --- loss: 1.647876, loss_ss: 1.181726, loss_d: 0.466150
0.7305 --- loss: 1.565357, loss_ss: 1.225817, loss_d: 0.339540
0.7689 --- loss: 1.255670, loss_ss: 0.972933, loss_d: 0.282737
0.8074 --- loss: 1.467407, loss_ss: 1.208211, loss_d: 0.259196
0.8458 --- loss: 1.330328, loss_ss: 1.002609, loss_d: 0.327719
0.8843 --- loss: 1.181404, loss_ss: 0.946555, loss_d: 0.234849
0.9227 --- loss: 1.462662, loss_ss: 1.129552, loss_d: 0.333109
0.9612 --- loss: 1.324620, loss_ss: 0.865941, loss_d: 0.458678
0.9996 --- loss: 1.626750, loss_ss: 1.526754, loss_d: 0.099996
Epoch finished! Loss: 1.5427653055924635
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.131907, loss_ss: 0.770975, loss_d: 0.360932
0.0384 --- loss: 1.433578, loss_ss: 1.120563, loss_d: 0.313015
0.0769 --- loss: 1.576308, loss_ss: 1.101430, loss_d: 0.474877
0.1153 --- loss: 1.412589, loss_ss: 1.190405, loss_d: 0.222184
0.1538 --- loss: 2.086154, loss_ss: 1.509654, loss_d: 0.576500
0.1922 --- loss: 1.632897, loss_ss: 1.090415, loss_d: 0.542482
0.2307 --- loss: 1.413107, loss_ss: 1.037470, loss_d: 0.375637
0.2691 --- loss: 1.534707, loss_ss: 1.182661, loss_d: 0.352046
0.3076 --- loss: 1.151532, loss_ss: 0.731288, loss_d: 0.420244
0.3460 --- loss: 1.685756, loss_ss: 0.970396, loss_d: 0.715361
0.3845 --- loss: 1.441353, loss_ss: 1.134382, loss_d: 0.306972
0.4229 --- loss: 1.511888, loss_ss: 0.983661, loss_d: 0.528227
0.4614 --- loss: 1.594928, loss_ss: 1.272602, loss_d: 0.322326
0.4998 --- loss: 1.513577, loss_ss: 1.155178, loss_d: 0.358400
0.5383 --- loss: 1.664806, loss_ss: 1.015037, loss_d: 0.649769
0.5767 --- loss: 1.196333, loss_ss: 0.837941, loss_d: 0.358392
0.6151 --- loss: 1.853166, loss_ss: 1.212094, loss_d: 0.641073
0.6536 --- loss: 1.457014, loss_ss: 1.052618, loss_d: 0.404396
0.6920 --- loss: 1.859684, loss_ss: 1.234058, loss_d: 0.625626
0.7305 --- loss: 1.237037, loss_ss: 0.894624, loss_d: 0.342413
0.7689 --- loss: 1.685344, loss_ss: 1.326741, loss_d: 0.358603
0.8074 --- loss: 1.685624, loss_ss: 1.129028, loss_d: 0.556596
0.8458 --- loss: 1.475817, loss_ss: 1.027371, loss_d: 0.448447
0.8843 --- loss: 1.112153, loss_ss: 0.894959, loss_d: 0.217194
0.9227 --- loss: 1.355658, loss_ss: 1.051534, loss_d: 0.304124
0.9612 --- loss: 1.301410, loss_ss: 0.963802, loss_d: 0.337608
0.9996 --- loss: 3.076532, loss_ss: 2.954260, loss_d: 0.122272
Epoch finished! Loss: 1.532136866221061
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.41711711711711713
             precision    recall  f1-score   support

        0.0       1.00      0.44      0.62       153
        1.0       0.00      0.00      0.00       232
        2.0       0.40      0.88      0.55       441
        3.0       0.09      0.08      0.08        93
        4.0       0.00      0.00      0.00       191

avg / total       0.31      0.42      0.31      1110
 


====== chp042-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  92.34  44.44  100.00  100.00     61.54
1  79.10   0.00  100.00    0.00      0.00
2  43.15  87.98   13.60   40.17     55.15
3  86.04   7.53   93.22    9.21      8.28
4  82.79   0.00  100.00    0.00      0.00
Total accuracy: 41.71%
Average sen: 27.99%
Average spec: 81.36%
Macro f1-score: 25.00%
[0.08312967 0.05873432 0.04912094 0.00459775 0.00087611 0.00080567
 0.00079494 0.0045349  0.00369989 0.00478501 0.00373275 0.06245819
 0.02688824 0.00648573 0.01170759 0.02310759 0.00573525 0.00236494
 0.0030654  0.00212486 0.00360116 0.0052404  0.00535008 0.04980823
 0.05318253 0.01425783 0.00304113 0.00261251 0.0055187  0.0038515
 0.00381656 0.00956997 0.00275722 0.01049932 0.02374697 0.00656188
 0.01240552]
pred: 0.015528953133931232, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.373202, loss_ss: 1.757273, loss_d: 0.615929
0.0385 --- loss: 2.142326, loss_ss: 1.705220, loss_d: 0.437106
0.0770 --- loss: 2.089476, loss_ss: 1.680886, loss_d: 0.408590
0.1155 --- loss: 1.776607, loss_ss: 1.579326, loss_d: 0.197281
0.1540 --- loss: 2.241261, loss_ss: 1.564359, loss_d: 0.676902
0.1925 --- loss: 2.110503, loss_ss: 1.573830, loss_d: 0.536673
0.2309 --- loss: 2.644591, loss_ss: 1.599580, loss_d: 1.045011
0.2694 --- loss: 2.017580, loss_ss: 1.540367, loss_d: 0.477212
0.3079 --- loss: 2.051077, loss_ss: 1.614460, loss_d: 0.436618
0.3464 --- loss: 2.027710, loss_ss: 1.470442, loss_d: 0.557269
0.3849 --- loss: 2.100150, loss_ss: 1.517088, loss_d: 0.583062
0.4234 --- loss: 2.088312, loss_ss: 1.598895, loss_d: 0.489417
0.4619 --- loss: 1.975660, loss_ss: 1.544148, loss_d: 0.431512
0.5004 --- loss: 1.918862, loss_ss: 1.470866, loss_d: 0.447996
0.5389 --- loss: 2.026790, loss_ss: 1.557598, loss_d: 0.469192
0.5774 --- loss: 1.940423, loss_ss: 1.554272, loss_d: 0.386150
0.6159 --- loss: 2.471874, loss_ss: 1.517483, loss_d: 0.954392
0.6543 --- loss: 1.809399, loss_ss: 1.381389, loss_d: 0.428010
0.6928 --- loss: 1.886719, loss_ss: 1.307886, loss_d: 0.578833
0.7313 --- loss: 2.123044, loss_ss: 1.667492, loss_d: 0.455552
0.7698 --- loss: 2.040097, loss_ss: 1.684112, loss_d: 0.355985
0.8083 --- loss: 1.653421, loss_ss: 1.340624, loss_d: 0.312796
0.8468 --- loss: 1.736144, loss_ss: 1.328566, loss_d: 0.407578
0.8853 --- loss: 2.015126, loss_ss: 1.481505, loss_d: 0.533621
0.9238 --- loss: 1.623459, loss_ss: 1.318915, loss_d: 0.304544
0.9623 --- loss: 1.940732, loss_ss: 1.365503, loss_d: 0.575229
Epoch finished! Loss: 2.1017017341488575
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.853033, loss_ss: 1.430221, loss_d: 0.422812
0.0385 --- loss: 1.954983, loss_ss: 1.455125, loss_d: 0.499858
0.0770 --- loss: 1.806081, loss_ss: 1.455438, loss_d: 0.350644
0.1155 --- loss: 2.002198, loss_ss: 1.357907, loss_d: 0.644291
0.1540 --- loss: 1.810389, loss_ss: 1.418191, loss_d: 0.392198
0.1925 --- loss: 2.047397, loss_ss: 1.557182, loss_d: 0.490215
0.2309 --- loss: 2.141445, loss_ss: 1.405616, loss_d: 0.735829
0.2694 --- loss: 1.804629, loss_ss: 1.415763, loss_d: 0.388865
0.3079 --- loss: 1.994956, loss_ss: 1.578792, loss_d: 0.416164
0.3464 --- loss: 1.915420, loss_ss: 1.395317, loss_d: 0.520102
0.3849 --- loss: 1.859296, loss_ss: 1.283678, loss_d: 0.575617
0.4234 --- loss: 2.068370, loss_ss: 1.373079, loss_d: 0.695292
0.4619 --- loss: 2.137224, loss_ss: 1.471075, loss_d: 0.666149
0.5004 --- loss: 2.073722, loss_ss: 1.485345, loss_d: 0.588377
0.5389 --- loss: 2.103213, loss_ss: 1.594988, loss_d: 0.508225
0.5774 --- loss: 1.890788, loss_ss: 1.406628, loss_d: 0.484160
0.6159 --- loss: 2.357347, loss_ss: 1.337154, loss_d: 1.020193
0.6543 --- loss: 1.968783, loss_ss: 1.515214, loss_d: 0.453569
0.6928 --- loss: 1.869254, loss_ss: 1.534731, loss_d: 0.334522
0.7313 --- loss: 2.123755, loss_ss: 1.514904, loss_d: 0.608850
0.7698 --- loss: 2.003629, loss_ss: 1.399026, loss_d: 0.604603
0.8083 --- loss: 1.748467, loss_ss: 1.320503, loss_d: 0.427964
0.8468 --- loss: 1.641528, loss_ss: 1.353732, loss_d: 0.287795
0.8853 --- loss: 1.920515, loss_ss: 1.274675, loss_d: 0.645840
0.9238 --- loss: 2.310471, loss_ss: 1.532525, loss_d: 0.777946
0.9623 --- loss: 2.033831, loss_ss: 1.279689, loss_d: 0.754142
Epoch finished! Loss: 1.9852256208773285
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.916049, loss_ss: 1.487789, loss_d: 0.428260
0.0385 --- loss: 1.870413, loss_ss: 1.509599, loss_d: 0.360815
0.0770 --- loss: 2.116490, loss_ss: 1.328055, loss_d: 0.788435
0.1155 --- loss: 1.793259, loss_ss: 1.401801, loss_d: 0.391458
0.1540 --- loss: 2.133775, loss_ss: 1.512230, loss_d: 0.621545
0.1925 --- loss: 1.642622, loss_ss: 1.258821, loss_d: 0.383801
0.2309 --- loss: 1.819301, loss_ss: 1.465443, loss_d: 0.353858
0.2694 --- loss: 1.851006, loss_ss: 1.401591, loss_d: 0.449416
0.3079 --- loss: 1.841461, loss_ss: 1.511708, loss_d: 0.329753
0.3464 --- loss: 2.254237, loss_ss: 1.592305, loss_d: 0.661932
0.3849 --- loss: 1.927875, loss_ss: 1.323604, loss_d: 0.604270
0.4234 --- loss: 2.101237, loss_ss: 1.387110, loss_d: 0.714128
0.4619 --- loss: 1.785113, loss_ss: 1.301184, loss_d: 0.483929
0.5004 --- loss: 1.944905, loss_ss: 1.568665, loss_d: 0.376240
0.5389 --- loss: 2.049851, loss_ss: 1.656944, loss_d: 0.392907
0.5774 --- loss: 2.575897, loss_ss: 1.611606, loss_d: 0.964291
0.6159 --- loss: 1.908107, loss_ss: 1.524953, loss_d: 0.383155
0.6543 --- loss: 1.953202, loss_ss: 1.476165, loss_d: 0.477037
0.6928 --- loss: 1.810380, loss_ss: 1.456504, loss_d: 0.353876
0.7313 --- loss: 1.752716, loss_ss: 1.482432, loss_d: 0.270285
0.7698 --- loss: 1.903155, loss_ss: 1.379365, loss_d: 0.523790
0.8083 --- loss: 1.677876, loss_ss: 1.311424, loss_d: 0.366452
0.8468 --- loss: 1.789054, loss_ss: 1.319138, loss_d: 0.469917
0.8853 --- loss: 1.921870, loss_ss: 1.364813, loss_d: 0.557057
0.9238 --- loss: 1.713730, loss_ss: 1.344975, loss_d: 0.368755
0.9623 --- loss: 1.835280, loss_ss: 1.386582, loss_d: 0.448698
Epoch finished! Loss: 1.9363467831409116
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.912233, loss_ss: 1.446034, loss_d: 0.466199
0.0385 --- loss: 1.669924, loss_ss: 1.391732, loss_d: 0.278193
0.0770 --- loss: 2.230158, loss_ss: 1.509462, loss_d: 0.720695
0.1155 --- loss: 2.015719, loss_ss: 1.524147, loss_d: 0.491573
0.1540 --- loss: 2.312159, loss_ss: 1.282001, loss_d: 1.030158
0.1925 --- loss: 1.887812, loss_ss: 1.577276, loss_d: 0.310536
0.2309 --- loss: 1.930443, loss_ss: 1.566906, loss_d: 0.363537
0.2694 --- loss: 1.763870, loss_ss: 1.319058, loss_d: 0.444812
0.3079 --- loss: 1.791696, loss_ss: 1.393854, loss_d: 0.397842
0.3464 --- loss: 1.844465, loss_ss: 1.422232, loss_d: 0.422233
0.3849 --- loss: 1.753221, loss_ss: 1.338520, loss_d: 0.414701
0.4234 --- loss: 1.836462, loss_ss: 1.221199, loss_d: 0.615263
0.4619 --- loss: 1.950949, loss_ss: 1.240764, loss_d: 0.710185
0.5004 --- loss: 1.749119, loss_ss: 1.317693, loss_d: 0.431426
0.5389 --- loss: 1.757286, loss_ss: 1.308010, loss_d: 0.449276
0.5774 --- loss: 1.827313, loss_ss: 1.292589, loss_d: 0.534723
0.6159 --- loss: 1.577292, loss_ss: 1.207795, loss_d: 0.369496
0.6543 --- loss: 1.794645, loss_ss: 1.445544, loss_d: 0.349101
0.6928 --- loss: 2.294218, loss_ss: 1.527771, loss_d: 0.766447
0.7313 --- loss: 2.238541, loss_ss: 1.539044, loss_d: 0.699497
0.7698 --- loss: 2.018917, loss_ss: 1.491190, loss_d: 0.527727
0.8083 --- loss: 1.878012, loss_ss: 1.530423, loss_d: 0.347589
0.8468 --- loss: 1.784843, loss_ss: 1.324590, loss_d: 0.460253
0.8853 --- loss: 1.975596, loss_ss: 1.492911, loss_d: 0.482685
0.9238 --- loss: 1.698494, loss_ss: 1.238230, loss_d: 0.460264
0.9623 --- loss: 1.691618, loss_ss: 1.251841, loss_d: 0.439777
Epoch finished! Loss: 1.8915498601883995
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.654194, loss_ss: 1.226045, loss_d: 0.428149
0.0385 --- loss: 1.759692, loss_ss: 1.182292, loss_d: 0.577401
0.0770 --- loss: 1.742826, loss_ss: 1.410982, loss_d: 0.331844
0.1155 --- loss: 1.868201, loss_ss: 1.377758, loss_d: 0.490444
0.1540 --- loss: 2.014651, loss_ss: 1.568362, loss_d: 0.446289
0.1925 --- loss: 1.773354, loss_ss: 1.316071, loss_d: 0.457283
0.2309 --- loss: 1.822036, loss_ss: 1.279176, loss_d: 0.542860
0.2694 --- loss: 1.787048, loss_ss: 1.272739, loss_d: 0.514308
0.3079 --- loss: 2.293202, loss_ss: 1.434469, loss_d: 0.858733
0.3464 --- loss: 1.729513, loss_ss: 1.261450, loss_d: 0.468063
0.3849 --- loss: 1.787504, loss_ss: 1.430430, loss_d: 0.357074
0.4234 --- loss: 1.773108, loss_ss: 1.338813, loss_d: 0.434295
0.4619 --- loss: 2.002329, loss_ss: 1.638407, loss_d: 0.363922
0.5004 --- loss: 1.924884, loss_ss: 1.348160, loss_d: 0.576725
0.5389 --- loss: 1.784167, loss_ss: 1.329772, loss_d: 0.454395
0.5774 --- loss: 1.667682, loss_ss: 1.330014, loss_d: 0.337668
0.6159 --- loss: 1.674853, loss_ss: 1.284667, loss_d: 0.390185
0.6543 --- loss: 1.947562, loss_ss: 1.531426, loss_d: 0.416136
0.6928 --- loss: 1.884820, loss_ss: 1.444865, loss_d: 0.439956
0.7313 --- loss: 1.762446, loss_ss: 1.440821, loss_d: 0.321625
0.7698 --- loss: 1.723040, loss_ss: 1.311719, loss_d: 0.411321
0.8083 --- loss: 1.696907, loss_ss: 1.327247, loss_d: 0.369659
0.8468 --- loss: 1.820166, loss_ss: 1.409873, loss_d: 0.410293
0.8853 --- loss: 1.618061, loss_ss: 1.240142, loss_d: 0.377919
0.9238 --- loss: 1.679626, loss_ss: 1.298994, loss_d: 0.380632
0.9623 --- loss: 1.764012, loss_ss: 1.273836, loss_d: 0.490176
Epoch finished! Loss: 1.8380506305620938
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.827920, loss_ss: 1.387446, loss_d: 0.440474
0.0385 --- loss: 1.523973, loss_ss: 1.211802, loss_d: 0.312171
0.0770 --- loss: 1.614634, loss_ss: 1.294567, loss_d: 0.320067
0.1155 --- loss: 1.865257, loss_ss: 1.339012, loss_d: 0.526245
0.1540 --- loss: 1.997542, loss_ss: 1.281432, loss_d: 0.716110
0.1925 --- loss: 1.857752, loss_ss: 1.294194, loss_d: 0.563558
0.2309 --- loss: 1.462205, loss_ss: 1.128824, loss_d: 0.333381
0.2694 --- loss: 1.483056, loss_ss: 1.147237, loss_d: 0.335818
0.3079 --- loss: 1.761159, loss_ss: 1.403415, loss_d: 0.357744
0.3464 --- loss: 1.727733, loss_ss: 1.431311, loss_d: 0.296423
0.3849 --- loss: 1.831153, loss_ss: 1.295110, loss_d: 0.536043
0.4234 --- loss: 1.671957, loss_ss: 1.255351, loss_d: 0.416606
0.4619 --- loss: 1.704178, loss_ss: 1.457919, loss_d: 0.246259
0.5004 --- loss: 1.488560, loss_ss: 1.018353, loss_d: 0.470207
0.5389 --- loss: 1.741934, loss_ss: 1.292693, loss_d: 0.449241
0.5774 --- loss: 1.465999, loss_ss: 1.037881, loss_d: 0.428118
0.6159 --- loss: 1.492229, loss_ss: 1.127714, loss_d: 0.364515
0.6543 --- loss: 1.504275, loss_ss: 1.028428, loss_d: 0.475847
0.6928 --- loss: 1.626499, loss_ss: 1.143587, loss_d: 0.482913
0.7313 --- loss: 1.709296, loss_ss: 1.204992, loss_d: 0.504304
0.7698 --- loss: 1.962139, loss_ss: 1.551092, loss_d: 0.411047
0.8083 --- loss: 1.493592, loss_ss: 1.085489, loss_d: 0.408103
0.8468 --- loss: 1.437624, loss_ss: 1.059339, loss_d: 0.378285
0.8853 --- loss: 1.819653, loss_ss: 1.455826, loss_d: 0.363827
0.9238 --- loss: 1.564863, loss_ss: 1.163995, loss_d: 0.400867
0.9623 --- loss: 1.915772, loss_ss: 1.552752, loss_d: 0.363020
Epoch finished! Loss: 1.7479203741522829
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.645286, loss_ss: 1.120875, loss_d: 0.524411
0.0385 --- loss: 1.434214, loss_ss: 0.957304, loss_d: 0.476910
0.0770 --- loss: 1.397571, loss_ss: 1.122288, loss_d: 0.275283
0.1155 --- loss: 2.007912, loss_ss: 1.444255, loss_d: 0.563657
0.1540 --- loss: 1.453093, loss_ss: 1.105844, loss_d: 0.347248
0.1925 --- loss: 1.584440, loss_ss: 1.215217, loss_d: 0.369223
0.2309 --- loss: 1.951996, loss_ss: 1.339612, loss_d: 0.612384
0.2694 --- loss: 1.473398, loss_ss: 1.131188, loss_d: 0.342210
0.3079 --- loss: 1.735392, loss_ss: 1.339452, loss_d: 0.395941
0.3464 --- loss: 1.557361, loss_ss: 1.153794, loss_d: 0.403567
0.3849 --- loss: 1.573071, loss_ss: 0.955066, loss_d: 0.618005
0.4234 --- loss: 1.493696, loss_ss: 1.131861, loss_d: 0.361835
0.4619 --- loss: 1.516060, loss_ss: 1.083020, loss_d: 0.433040
0.5004 --- loss: 1.604436, loss_ss: 1.222985, loss_d: 0.381451
0.5389 --- loss: 1.696922, loss_ss: 1.214935, loss_d: 0.481987
0.5774 --- loss: 1.724382, loss_ss: 0.965162, loss_d: 0.759220
0.6159 --- loss: 1.534304, loss_ss: 1.109786, loss_d: 0.424518
0.6543 --- loss: 1.385119, loss_ss: 1.061947, loss_d: 0.323172
0.6928 --- loss: 2.032959, loss_ss: 1.304403, loss_d: 0.728556
0.7313 --- loss: 1.772132, loss_ss: 1.298213, loss_d: 0.473919
0.7698 --- loss: 1.674407, loss_ss: 1.075998, loss_d: 0.598408
0.8083 --- loss: 1.571703, loss_ss: 1.133734, loss_d: 0.437969
0.8468 --- loss: 1.619104, loss_ss: 1.165261, loss_d: 0.453842
0.8853 --- loss: 1.552533, loss_ss: 1.168132, loss_d: 0.384400
0.9238 --- loss: 1.927882, loss_ss: 1.187858, loss_d: 0.740024
0.9623 --- loss: 1.498987, loss_ss: 1.006839, loss_d: 0.492147
Epoch finished! Loss: 1.6685890203277116
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.496330, loss_ss: 1.202278, loss_d: 0.294053
0.0385 --- loss: 1.639289, loss_ss: 1.199703, loss_d: 0.439586
0.0770 --- loss: 1.323987, loss_ss: 1.051331, loss_d: 0.272656
0.1155 --- loss: 1.550189, loss_ss: 1.185336, loss_d: 0.364853
0.1540 --- loss: 1.925049, loss_ss: 1.496986, loss_d: 0.428063
0.1925 --- loss: 1.639115, loss_ss: 1.317028, loss_d: 0.322087
0.2309 --- loss: 1.294647, loss_ss: 0.968136, loss_d: 0.326511
0.2694 --- loss: 1.429829, loss_ss: 1.138073, loss_d: 0.291756
0.3079 --- loss: 1.749437, loss_ss: 1.373975, loss_d: 0.375461
0.3464 --- loss: 1.598172, loss_ss: 1.233354, loss_d: 0.364818
0.3849 --- loss: 1.818720, loss_ss: 1.275787, loss_d: 0.542933
0.4234 --- loss: 1.332798, loss_ss: 0.989908, loss_d: 0.342890
0.4619 --- loss: 1.681518, loss_ss: 1.060115, loss_d: 0.621402
0.5004 --- loss: 1.214021, loss_ss: 0.867402, loss_d: 0.346619
0.5389 --- loss: 1.669649, loss_ss: 1.125804, loss_d: 0.543845
0.5774 --- loss: 1.421965, loss_ss: 1.116452, loss_d: 0.305513
0.6159 --- loss: 1.805643, loss_ss: 1.376419, loss_d: 0.429224
0.6543 --- loss: 1.544153, loss_ss: 1.039996, loss_d: 0.504157
0.6928 --- loss: 1.232597, loss_ss: 0.831127, loss_d: 0.401469
0.7313 --- loss: 1.436909, loss_ss: 1.051826, loss_d: 0.385083
0.7698 --- loss: 2.015801, loss_ss: 1.558610, loss_d: 0.457190
0.8083 --- loss: 1.235209, loss_ss: 0.950344, loss_d: 0.284865
0.8468 --- loss: 1.510025, loss_ss: 1.101541, loss_d: 0.408485
0.8853 --- loss: 2.001478, loss_ss: 1.139715, loss_d: 0.861763
0.9238 --- loss: 1.499729, loss_ss: 1.028877, loss_d: 0.470852
0.9623 --- loss: 1.579244, loss_ss: 0.997193, loss_d: 0.582051
Epoch finished! Loss: 1.6050176344322882
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.734452, loss_ss: 0.920922, loss_d: 0.813530
0.0385 --- loss: 1.846806, loss_ss: 1.279118, loss_d: 0.567688
0.0770 --- loss: 1.819584, loss_ss: 1.432187, loss_d: 0.387398
0.1155 --- loss: 1.549995, loss_ss: 1.280653, loss_d: 0.269342
0.1540 --- loss: 1.352412, loss_ss: 0.871233, loss_d: 0.481179
0.1925 --- loss: 1.755289, loss_ss: 1.132131, loss_d: 0.623159
0.2309 --- loss: 1.488360, loss_ss: 1.134729, loss_d: 0.353631
0.2694 --- loss: 1.693020, loss_ss: 1.165812, loss_d: 0.527208
0.3079 --- loss: 1.410052, loss_ss: 0.971078, loss_d: 0.438974
0.3464 --- loss: 1.607456, loss_ss: 1.076825, loss_d: 0.530632
0.3849 --- loss: 1.393434, loss_ss: 0.953706, loss_d: 0.439728
0.4234 --- loss: 1.487436, loss_ss: 1.018308, loss_d: 0.469128
0.4619 --- loss: 1.626706, loss_ss: 1.177585, loss_d: 0.449121
0.5004 --- loss: 1.393105, loss_ss: 0.996211, loss_d: 0.396894
0.5389 --- loss: 2.019497, loss_ss: 0.986361, loss_d: 1.033136
0.5774 --- loss: 1.672205, loss_ss: 1.281038, loss_d: 0.391166
0.6159 --- loss: 1.510546, loss_ss: 1.117819, loss_d: 0.392727
0.6543 --- loss: 1.558814, loss_ss: 0.905838, loss_d: 0.652976
0.6928 --- loss: 1.747892, loss_ss: 1.179946, loss_d: 0.567946
0.7313 --- loss: 1.931527, loss_ss: 1.508922, loss_d: 0.422605
0.7698 --- loss: 1.273653, loss_ss: 0.979404, loss_d: 0.294249
0.8083 --- loss: 1.943975, loss_ss: 0.892048, loss_d: 1.051927
0.8468 --- loss: 1.611809, loss_ss: 1.212918, loss_d: 0.398891
0.8853 --- loss: 1.269954, loss_ss: 0.913242, loss_d: 0.356712
0.9238 --- loss: 1.841837, loss_ss: 1.198733, loss_d: 0.643104
0.9623 --- loss: 1.436589, loss_ss: 1.107577, loss_d: 0.329011
Epoch finished! Loss: 1.6009901522669552
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.505131, loss_ss: 1.107505, loss_d: 0.397627
0.0385 --- loss: 1.498935, loss_ss: 1.242099, loss_d: 0.256836
0.0770 --- loss: 1.250773, loss_ss: 0.897461, loss_d: 0.353312
0.1155 --- loss: 1.155077, loss_ss: 0.859451, loss_d: 0.295626
0.1540 --- loss: 1.298468, loss_ss: 0.963212, loss_d: 0.335256
0.1925 --- loss: 1.457622, loss_ss: 1.111445, loss_d: 0.346178
0.2309 --- loss: 1.374800, loss_ss: 1.072530, loss_d: 0.302270
0.2694 --- loss: 1.775120, loss_ss: 1.556200, loss_d: 0.218920
0.3079 --- loss: 1.731939, loss_ss: 1.164016, loss_d: 0.567923
0.3464 --- loss: 1.216586, loss_ss: 0.952213, loss_d: 0.264374
0.3849 --- loss: 1.751720, loss_ss: 1.137861, loss_d: 0.613859
0.4234 --- loss: 1.440647, loss_ss: 0.957044, loss_d: 0.483603
0.4619 --- loss: 1.751889, loss_ss: 1.446599, loss_d: 0.305290
0.5004 --- loss: 1.466434, loss_ss: 1.133718, loss_d: 0.332717
0.5389 --- loss: 1.223561, loss_ss: 0.880697, loss_d: 0.342863
0.5774 --- loss: 2.688078, loss_ss: 1.171345, loss_d: 1.516733
0.6159 --- loss: 1.439517, loss_ss: 1.039008, loss_d: 0.400510
0.6543 --- loss: 1.603732, loss_ss: 1.253458, loss_d: 0.350274
0.6928 --- loss: 1.674945, loss_ss: 1.013298, loss_d: 0.661647
0.7313 --- loss: 1.602269, loss_ss: 1.164064, loss_d: 0.438206
0.7698 --- loss: 1.506303, loss_ss: 0.989872, loss_d: 0.516431
0.8083 --- loss: 1.616798, loss_ss: 0.937436, loss_d: 0.679362
0.8468 --- loss: 1.651392, loss_ss: 1.055114, loss_d: 0.596278
0.8853 --- loss: 1.510229, loss_ss: 1.144246, loss_d: 0.365983
0.9238 --- loss: 1.330133, loss_ss: 0.839449, loss_d: 0.490685
0.9623 --- loss: 1.388220, loss_ss: 0.944668, loss_d: 0.443552
Epoch finished! Loss: 1.5344419842981463
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4583333333333333
             precision    recall  f1-score   support

        0.0       0.92      0.08      0.15       143
        1.0       0.00      0.00      0.00       197
        2.0       0.46      0.99      0.63       506
        3.0       0.00      0.00      0.00        64
        4.0       0.36      0.13      0.19       290

avg / total       0.39      0.46      0.33      1200
 


====== chp043-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  89.00   8.39   99.91  92.31     15.38
1  83.58   0.00  100.00   0.00      0.00
2  51.08  99.01   16.14  46.26     63.06
3  94.67   0.00  100.00   0.00      0.00
4  73.33  12.76   92.64  35.58     18.78
Total accuracy: 45.83%
Average sen: 24.03%
Average spec: 81.74%
Macro f1-score: 19.44%
[0.93710536 0.93638504 0.9465093  0.94772333 0.93560362 0.93856621
 0.93541199 0.92673779 0.93946964 0.93316317 0.94953877 0.9354803
 0.93794501 0.93508112 0.93612629 0.93222791 0.93440294 0.94381309
 0.8017506  0.93272936 0.93180585 0.93030721 0.93573207 0.93273622
 0.93748957 0.93301302 0.93308783 0.92939943 0.93022805 0.93137288
 0.93261015 0.93629283 0.93249029 0.93399793 0.93205863 0.92696953
 0.89826936 0.93093336 0.93887216 0.93509591]
pred: 0.9309633269906044, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.373428, loss_ss: 1.694090, loss_d: 0.679338
0.0384 --- loss: 2.003212, loss_ss: 1.715441, loss_d: 0.287771
0.0768 --- loss: 1.971575, loss_ss: 1.678875, loss_d: 0.292700
0.1153 --- loss: 2.268778, loss_ss: 1.711345, loss_d: 0.557433
0.1537 --- loss: 2.008952, loss_ss: 1.588797, loss_d: 0.420156
0.1921 --- loss: 1.952991, loss_ss: 1.594888, loss_d: 0.358102
0.2305 --- loss: 2.371561, loss_ss: 1.608453, loss_d: 0.763108
0.2689 --- loss: 2.650341, loss_ss: 1.584937, loss_d: 1.065403
0.3073 --- loss: 2.103294, loss_ss: 1.657607, loss_d: 0.445687
0.3458 --- loss: 2.215452, loss_ss: 1.612405, loss_d: 0.603047
0.3842 --- loss: 2.119850, loss_ss: 1.523674, loss_d: 0.596176
0.4226 --- loss: 2.274133, loss_ss: 1.476547, loss_d: 0.797585
0.4610 --- loss: 2.315032, loss_ss: 1.565165, loss_d: 0.749867
0.4994 --- loss: 1.906208, loss_ss: 1.517013, loss_d: 0.389195
0.5378 --- loss: 2.084584, loss_ss: 1.493339, loss_d: 0.591245
0.5763 --- loss: 2.187411, loss_ss: 1.472924, loss_d: 0.714487
0.6147 --- loss: 2.229994, loss_ss: 1.593129, loss_d: 0.636865
0.6531 --- loss: 2.067824, loss_ss: 1.436138, loss_d: 0.631686
0.6915 --- loss: 1.825660, loss_ss: 1.441815, loss_d: 0.383845
0.7299 --- loss: 1.643486, loss_ss: 1.416873, loss_d: 0.226613
0.7683 --- loss: 1.998646, loss_ss: 1.550006, loss_d: 0.448640
0.8068 --- loss: 1.927773, loss_ss: 1.454632, loss_d: 0.473141
0.8452 --- loss: 2.045509, loss_ss: 1.468481, loss_d: 0.577028
0.8836 --- loss: 1.787431, loss_ss: 1.411757, loss_d: 0.375674
0.9220 --- loss: 1.897222, loss_ss: 1.317909, loss_d: 0.579313
0.9604 --- loss: 2.468579, loss_ss: 1.544696, loss_d: 0.923882
0.9988 --- loss: 2.095398, loss_ss: 1.378555, loss_d: 0.716843
Epoch finished! Loss: 2.1250257139022533
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.201975, loss_ss: 1.424263, loss_d: 0.777712
0.0384 --- loss: 2.141865, loss_ss: 1.522583, loss_d: 0.619282
0.0768 --- loss: 1.884223, loss_ss: 1.441837, loss_d: 0.442386
0.1153 --- loss: 1.909733, loss_ss: 1.518512, loss_d: 0.391221
0.1537 --- loss: 1.936540, loss_ss: 1.514367, loss_d: 0.422173
0.1921 --- loss: 2.182751, loss_ss: 1.568962, loss_d: 0.613789
0.2305 --- loss: 1.865802, loss_ss: 1.472502, loss_d: 0.393300
0.2689 --- loss: 1.803001, loss_ss: 1.498332, loss_d: 0.304668
0.3073 --- loss: 1.976360, loss_ss: 1.680071, loss_d: 0.296290
0.3458 --- loss: 2.062319, loss_ss: 1.524934, loss_d: 0.537385
0.3842 --- loss: 1.781022, loss_ss: 1.383293, loss_d: 0.397729
0.4226 --- loss: 1.774216, loss_ss: 1.428981, loss_d: 0.345235
0.4610 --- loss: 1.974395, loss_ss: 1.243447, loss_d: 0.730947
0.4994 --- loss: 1.801065, loss_ss: 1.401038, loss_d: 0.400028
0.5378 --- loss: 2.187309, loss_ss: 1.518592, loss_d: 0.668717
0.5763 --- loss: 1.878169, loss_ss: 1.436633, loss_d: 0.441536
0.6147 --- loss: 2.144485, loss_ss: 1.462256, loss_d: 0.682229
0.6531 --- loss: 1.912022, loss_ss: 1.324454, loss_d: 0.587568
0.6915 --- loss: 2.093469, loss_ss: 1.551116, loss_d: 0.542353
0.7299 --- loss: 1.697711, loss_ss: 1.299070, loss_d: 0.398642
0.7683 --- loss: 1.885842, loss_ss: 1.413901, loss_d: 0.471941
0.8068 --- loss: 2.100167, loss_ss: 1.587274, loss_d: 0.512893
0.8452 --- loss: 1.746665, loss_ss: 1.412256, loss_d: 0.334409
0.8836 --- loss: 1.994828, loss_ss: 1.583384, loss_d: 0.411444
0.9220 --- loss: 1.837325, loss_ss: 1.543816, loss_d: 0.293509
0.9604 --- loss: 2.075191, loss_ss: 1.582611, loss_d: 0.492581
0.9988 --- loss: 2.252019, loss_ss: 1.459213, loss_d: 0.792806
Epoch finished! Loss: 1.9766619861125947
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.915038, loss_ss: 1.527748, loss_d: 0.387289
0.0384 --- loss: 1.934055, loss_ss: 1.352550, loss_d: 0.581505
0.0768 --- loss: 1.842783, loss_ss: 1.322428, loss_d: 0.520355
0.1153 --- loss: 1.901221, loss_ss: 1.506524, loss_d: 0.394697
0.1537 --- loss: 1.803966, loss_ss: 1.373880, loss_d: 0.430086
0.1921 --- loss: 1.583962, loss_ss: 1.286958, loss_d: 0.297004
0.2305 --- loss: 1.735567, loss_ss: 1.438175, loss_d: 0.297391
0.2689 --- loss: 1.805395, loss_ss: 1.422993, loss_d: 0.382402
0.3073 --- loss: 2.025544, loss_ss: 1.276854, loss_d: 0.748690
0.3458 --- loss: 1.903723, loss_ss: 1.392893, loss_d: 0.510830
0.3842 --- loss: 1.672063, loss_ss: 1.263929, loss_d: 0.408134
0.4226 --- loss: 2.346713, loss_ss: 1.482726, loss_d: 0.863987
0.4610 --- loss: 1.917666, loss_ss: 1.346537, loss_d: 0.571130
0.4994 --- loss: 2.283762, loss_ss: 1.431368, loss_d: 0.852394
0.5378 --- loss: 1.693017, loss_ss: 1.358952, loss_d: 0.334065
0.5763 --- loss: 1.556019, loss_ss: 1.217849, loss_d: 0.338171
0.6147 --- loss: 1.714940, loss_ss: 1.398659, loss_d: 0.316280
0.6531 --- loss: 1.945399, loss_ss: 1.353140, loss_d: 0.592258
0.6915 --- loss: 1.761189, loss_ss: 1.209529, loss_d: 0.551659
0.7299 --- loss: 1.837548, loss_ss: 1.371687, loss_d: 0.465861
0.7683 --- loss: 1.577285, loss_ss: 1.219032, loss_d: 0.358253
0.8068 --- loss: 1.743426, loss_ss: 1.197594, loss_d: 0.545832
0.8452 --- loss: 1.310137, loss_ss: 1.012400, loss_d: 0.297737
0.8836 --- loss: 1.774777, loss_ss: 1.104800, loss_d: 0.669977
0.9220 --- loss: 1.659599, loss_ss: 1.196077, loss_d: 0.463521
0.9604 --- loss: 1.766715, loss_ss: 1.295374, loss_d: 0.471341
0.9988 --- loss: 2.424956, loss_ss: 1.086488, loss_d: 1.338468
Epoch finished! Loss: 1.8677049407592186
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.817469, loss_ss: 1.433449, loss_d: 0.384020
0.0384 --- loss: 1.529996, loss_ss: 1.259075, loss_d: 0.270921
0.0768 --- loss: 1.883922, loss_ss: 1.533714, loss_d: 0.350208
0.1153 --- loss: 1.629523, loss_ss: 1.220760, loss_d: 0.408763
0.1537 --- loss: 1.674354, loss_ss: 1.224582, loss_d: 0.449772
0.1921 --- loss: 1.941952, loss_ss: 1.653208, loss_d: 0.288744
0.2305 --- loss: 2.045001, loss_ss: 1.629076, loss_d: 0.415925
0.2689 --- loss: 2.048300, loss_ss: 1.356134, loss_d: 0.692167
0.3073 --- loss: 1.999764, loss_ss: 1.322617, loss_d: 0.677147
0.3458 --- loss: 1.872590, loss_ss: 1.343535, loss_d: 0.529055
0.3842 --- loss: 1.538572, loss_ss: 1.184049, loss_d: 0.354524
0.4226 --- loss: 1.739315, loss_ss: 1.296836, loss_d: 0.442479
0.4610 --- loss: 1.524488, loss_ss: 1.179794, loss_d: 0.344695
0.4994 --- loss: 1.951930, loss_ss: 1.189739, loss_d: 0.762191
0.5378 --- loss: 1.929409, loss_ss: 1.467439, loss_d: 0.461970
0.5763 --- loss: 1.638045, loss_ss: 1.008004, loss_d: 0.630041
0.6147 --- loss: 1.918378, loss_ss: 1.231641, loss_d: 0.686737
0.6531 --- loss: 1.840231, loss_ss: 1.456442, loss_d: 0.383788
0.6915 --- loss: 1.783010, loss_ss: 1.386311, loss_d: 0.396699
0.7299 --- loss: 1.730294, loss_ss: 1.138911, loss_d: 0.591383
0.7683 --- loss: 1.867097, loss_ss: 1.381553, loss_d: 0.485544
0.8068 --- loss: 1.703312, loss_ss: 1.317138, loss_d: 0.386174
0.8452 --- loss: 1.988700, loss_ss: 1.370249, loss_d: 0.618451
0.8836 --- loss: 1.501682, loss_ss: 1.200301, loss_d: 0.301381
0.9220 --- loss: 1.348056, loss_ss: 1.095530, loss_d: 0.252526
0.9604 --- loss: 1.620421, loss_ss: 1.102209, loss_d: 0.518212
0.9988 --- loss: 1.833014, loss_ss: 0.981808, loss_d: 0.851207
Epoch finished! Loss: 1.7814360898274642
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.876963, loss_ss: 1.291837, loss_d: 0.585126
0.0384 --- loss: 1.944770, loss_ss: 1.522854, loss_d: 0.421916
0.0768 --- loss: 1.681239, loss_ss: 1.270055, loss_d: 0.411183
0.1153 --- loss: 2.098675, loss_ss: 1.483981, loss_d: 0.614695
0.1537 --- loss: 1.693023, loss_ss: 1.302715, loss_d: 0.390308
0.1921 --- loss: 1.604849, loss_ss: 1.283476, loss_d: 0.321373
0.2305 --- loss: 1.531927, loss_ss: 1.180892, loss_d: 0.351035
0.2689 --- loss: 1.717013, loss_ss: 1.226590, loss_d: 0.490423
0.3073 --- loss: 1.484410, loss_ss: 1.011575, loss_d: 0.472835
0.3458 --- loss: 1.696836, loss_ss: 1.249370, loss_d: 0.447467
0.3842 --- loss: 1.879750, loss_ss: 1.392400, loss_d: 0.487350
0.4226 --- loss: 1.578039, loss_ss: 1.244998, loss_d: 0.333041
0.4610 --- loss: 1.565624, loss_ss: 1.185513, loss_d: 0.380112
0.4994 --- loss: 1.408760, loss_ss: 1.062898, loss_d: 0.345862
0.5378 --- loss: 1.477132, loss_ss: 1.136960, loss_d: 0.340172
0.5763 --- loss: 1.501396, loss_ss: 0.961903, loss_d: 0.539493
0.6147 --- loss: 1.591744, loss_ss: 1.235527, loss_d: 0.356218
0.6531 --- loss: 2.238919, loss_ss: 1.168468, loss_d: 1.070450
0.6915 --- loss: 1.351080, loss_ss: 0.953661, loss_d: 0.397419
0.7299 --- loss: 1.421407, loss_ss: 0.998092, loss_d: 0.423315
0.7683 --- loss: 1.572119, loss_ss: 1.028609, loss_d: 0.543509
0.8068 --- loss: 1.456546, loss_ss: 1.094974, loss_d: 0.361572
0.8452 --- loss: 2.221406, loss_ss: 1.290823, loss_d: 0.930583
0.8836 --- loss: 1.613840, loss_ss: 1.120884, loss_d: 0.492956
0.9220 --- loss: 2.574946, loss_ss: 1.321458, loss_d: 1.253488
0.9604 --- loss: 1.682676, loss_ss: 1.213534, loss_d: 0.469143
0.9988 --- loss: 1.848126, loss_ss: 1.253779, loss_d: 0.594347
Epoch finished! Loss: 1.6824260166058174
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.497893, loss_ss: 1.151916, loss_d: 0.345976
0.0384 --- loss: 1.535975, loss_ss: 1.074856, loss_d: 0.461120
0.0768 --- loss: 1.613084, loss_ss: 1.010456, loss_d: 0.602628
0.1153 --- loss: 1.536999, loss_ss: 1.078822, loss_d: 0.458177
0.1537 --- loss: 1.378476, loss_ss: 1.055873, loss_d: 0.322603
0.1921 --- loss: 1.747544, loss_ss: 1.372564, loss_d: 0.374980
0.2305 --- loss: 1.848841, loss_ss: 1.432852, loss_d: 0.415990
0.2689 --- loss: 1.628330, loss_ss: 1.194064, loss_d: 0.434266
0.3073 --- loss: 1.388809, loss_ss: 0.949526, loss_d: 0.439283
0.3458 --- loss: 1.889771, loss_ss: 1.320728, loss_d: 0.569043
0.3842 --- loss: 1.517657, loss_ss: 1.119207, loss_d: 0.398450
0.4226 --- loss: 1.550148, loss_ss: 1.006459, loss_d: 0.543689
0.4610 --- loss: 1.735903, loss_ss: 1.301539, loss_d: 0.434364
0.4994 --- loss: 1.461855, loss_ss: 1.083349, loss_d: 0.378505
0.5378 --- loss: 2.023250, loss_ss: 1.496455, loss_d: 0.526795
0.5763 --- loss: 2.139585, loss_ss: 1.607729, loss_d: 0.531856
0.6147 --- loss: 1.908455, loss_ss: 1.613971, loss_d: 0.294484
0.6531 --- loss: 1.696920, loss_ss: 1.320634, loss_d: 0.376286
0.6915 --- loss: 1.787285, loss_ss: 1.256813, loss_d: 0.530472
0.7299 --- loss: 1.676473, loss_ss: 1.294445, loss_d: 0.382027
0.7683 --- loss: 1.418381, loss_ss: 1.090919, loss_d: 0.327462
0.8068 --- loss: 1.657894, loss_ss: 1.040275, loss_d: 0.617619
0.8452 --- loss: 1.194150, loss_ss: 0.793546, loss_d: 0.400604
0.8836 --- loss: 1.639132, loss_ss: 1.184757, loss_d: 0.454376
0.9220 --- loss: 1.665726, loss_ss: 1.197896, loss_d: 0.467831
0.9604 --- loss: 1.475991, loss_ss: 1.131310, loss_d: 0.344681
0.9988 --- loss: 2.615928, loss_ss: 1.661609, loss_d: 0.954319
Epoch finished! Loss: 1.6451881917623372
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.485162, loss_ss: 1.160020, loss_d: 0.325143
0.0384 --- loss: 1.758479, loss_ss: 1.076955, loss_d: 0.681524
0.0768 --- loss: 1.740328, loss_ss: 1.257964, loss_d: 0.482365
0.1153 --- loss: 1.944515, loss_ss: 1.287789, loss_d: 0.656726
0.1537 --- loss: 1.657423, loss_ss: 1.119999, loss_d: 0.537424
0.1921 --- loss: 1.466534, loss_ss: 1.132901, loss_d: 0.333634
0.2305 --- loss: 1.817580, loss_ss: 1.302113, loss_d: 0.515468
0.2689 --- loss: 2.154599, loss_ss: 1.549373, loss_d: 0.605226
0.3073 --- loss: 1.356337, loss_ss: 1.031307, loss_d: 0.325030
0.3458 --- loss: 1.287043, loss_ss: 0.848484, loss_d: 0.438559
0.3842 --- loss: 1.216055, loss_ss: 0.920325, loss_d: 0.295730
0.4226 --- loss: 1.892704, loss_ss: 1.639285, loss_d: 0.253419
0.4610 --- loss: 1.284859, loss_ss: 0.941251, loss_d: 0.343608
0.4994 --- loss: 1.672457, loss_ss: 1.010115, loss_d: 0.662342
0.5378 --- loss: 1.761635, loss_ss: 1.319498, loss_d: 0.442137
0.5763 --- loss: 1.554661, loss_ss: 1.181103, loss_d: 0.373558
0.6147 --- loss: 1.670201, loss_ss: 1.109781, loss_d: 0.560420
0.6531 --- loss: 1.472131, loss_ss: 1.119692, loss_d: 0.352439
0.6915 --- loss: 1.533840, loss_ss: 1.205242, loss_d: 0.328598
0.7299 --- loss: 2.153539, loss_ss: 1.093485, loss_d: 1.060054
0.7683 --- loss: 1.717319, loss_ss: 1.254392, loss_d: 0.462928
0.8068 --- loss: 1.684647, loss_ss: 1.323754, loss_d: 0.360893
0.8452 --- loss: 1.453037, loss_ss: 1.125490, loss_d: 0.327547
0.8836 --- loss: 1.501156, loss_ss: 0.916995, loss_d: 0.584161
0.9220 --- loss: 2.139333, loss_ss: 1.111185, loss_d: 1.028149
0.9604 --- loss: 1.866123, loss_ss: 1.314822, loss_d: 0.551301
0.9988 --- loss: 1.742009, loss_ss: 1.491410, loss_d: 0.250599
Epoch finished! Loss: 1.6147009381881128
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.535247, loss_ss: 1.141231, loss_d: 0.394016
0.0384 --- loss: 1.623333, loss_ss: 1.270943, loss_d: 0.352390
0.0768 --- loss: 1.630334, loss_ss: 1.139769, loss_d: 0.490565
0.1153 --- loss: 1.727389, loss_ss: 1.350711, loss_d: 0.376678
0.1537 --- loss: 2.364416, loss_ss: 1.156105, loss_d: 1.208311
0.1921 --- loss: 2.205982, loss_ss: 1.526666, loss_d: 0.679315
0.2305 --- loss: 1.537555, loss_ss: 0.858012, loss_d: 0.679543
0.2689 --- loss: 1.434253, loss_ss: 1.010907, loss_d: 0.423347
0.3073 --- loss: 1.509830, loss_ss: 1.198427, loss_d: 0.311403
0.3458 --- loss: 1.504226, loss_ss: 1.220414, loss_d: 0.283812
0.3842 --- loss: 1.199197, loss_ss: 0.874653, loss_d: 0.324544
0.4226 --- loss: 1.581990, loss_ss: 1.324753, loss_d: 0.257237
0.4610 --- loss: 1.225073, loss_ss: 0.854859, loss_d: 0.370213
0.4994 --- loss: 1.288766, loss_ss: 0.933810, loss_d: 0.354955
0.5378 --- loss: 1.205891, loss_ss: 0.895993, loss_d: 0.309898
0.5763 --- loss: 1.527656, loss_ss: 1.233873, loss_d: 0.293783
0.6147 --- loss: 1.398844, loss_ss: 1.043037, loss_d: 0.355807
0.6531 --- loss: 1.457978, loss_ss: 1.036797, loss_d: 0.421181
0.6915 --- loss: 1.501570, loss_ss: 0.963473, loss_d: 0.538097
0.7299 --- loss: 1.769001, loss_ss: 1.047313, loss_d: 0.721688
0.7683 --- loss: 1.725312, loss_ss: 1.355628, loss_d: 0.369683
0.8068 --- loss: 1.463981, loss_ss: 1.033852, loss_d: 0.430129
0.8452 --- loss: 1.386061, loss_ss: 1.079497, loss_d: 0.306564
0.8836 --- loss: 1.363251, loss_ss: 1.019599, loss_d: 0.343652
0.9220 --- loss: 1.387980, loss_ss: 1.027884, loss_d: 0.360096
0.9604 --- loss: 1.553460, loss_ss: 1.072528, loss_d: 0.480932
0.9988 --- loss: 2.099687, loss_ss: 1.170405, loss_d: 0.929282
Epoch finished! Loss: 1.5938264447909134
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.397535, loss_ss: 0.760270, loss_d: 0.637264
0.0384 --- loss: 1.584493, loss_ss: 1.219811, loss_d: 0.364683
0.0768 --- loss: 1.204386, loss_ss: 0.926410, loss_d: 0.277977
0.1153 --- loss: 1.658147, loss_ss: 1.296342, loss_d: 0.361805
0.1537 --- loss: 1.533320, loss_ss: 1.095923, loss_d: 0.437397
0.1921 --- loss: 1.894573, loss_ss: 1.277396, loss_d: 0.617177
0.2305 --- loss: 1.432300, loss_ss: 1.040275, loss_d: 0.392025
0.2689 --- loss: 1.350927, loss_ss: 0.904870, loss_d: 0.446057
0.3073 --- loss: 1.185847, loss_ss: 0.896930, loss_d: 0.288917
0.3458 --- loss: 1.722664, loss_ss: 1.252566, loss_d: 0.470098
0.3842 --- loss: 1.814453, loss_ss: 1.124820, loss_d: 0.689633
0.4226 --- loss: 2.000486, loss_ss: 1.069620, loss_d: 0.930866
0.4610 --- loss: 2.010761, loss_ss: 1.276379, loss_d: 0.734382
0.4994 --- loss: 1.616741, loss_ss: 1.024640, loss_d: 0.592102
0.5378 --- loss: 1.902544, loss_ss: 0.989865, loss_d: 0.912679
0.5763 --- loss: 1.337529, loss_ss: 1.012059, loss_d: 0.325470
0.6147 --- loss: 1.450623, loss_ss: 1.044841, loss_d: 0.405782
0.6531 --- loss: 1.577091, loss_ss: 1.200776, loss_d: 0.376316
0.6915 --- loss: 1.389117, loss_ss: 1.125441, loss_d: 0.263676
0.7299 --- loss: 2.035206, loss_ss: 1.213158, loss_d: 0.822047
0.7683 --- loss: 1.269764, loss_ss: 1.007879, loss_d: 0.261885
0.8068 --- loss: 1.541373, loss_ss: 1.009500, loss_d: 0.531873
0.8452 --- loss: 1.580980, loss_ss: 1.206277, loss_d: 0.374702
0.8836 --- loss: 2.082575, loss_ss: 1.322305, loss_d: 0.760270
0.9220 --- loss: 1.207537, loss_ss: 0.872846, loss_d: 0.334692
0.9604 --- loss: 1.616974, loss_ss: 1.102763, loss_d: 0.514211
0.9988 --- loss: 2.856823, loss_ss: 1.637862, loss_d: 1.218961
Epoch finished! Loss: 1.559226498237023
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.156222, loss_ss: 0.864220, loss_d: 0.292002
0.0384 --- loss: 1.592873, loss_ss: 1.139812, loss_d: 0.453061
0.0768 --- loss: 1.718633, loss_ss: 0.896568, loss_d: 0.822065
0.1153 --- loss: 1.338269, loss_ss: 0.994472, loss_d: 0.343797
0.1537 --- loss: 1.472331, loss_ss: 1.167247, loss_d: 0.305084
0.1921 --- loss: 1.413975, loss_ss: 1.131815, loss_d: 0.282160
0.2305 --- loss: 1.526316, loss_ss: 1.035794, loss_d: 0.490523
0.2689 --- loss: 2.335535, loss_ss: 1.417608, loss_d: 0.917926
0.3073 --- loss: 1.567348, loss_ss: 1.131121, loss_d: 0.436227
0.3458 --- loss: 1.434823, loss_ss: 1.012152, loss_d: 0.422672
0.3842 --- loss: 1.423894, loss_ss: 1.034453, loss_d: 0.389441
0.4226 --- loss: 1.261667, loss_ss: 0.856020, loss_d: 0.405647
0.4610 --- loss: 1.590922, loss_ss: 1.059740, loss_d: 0.531182
0.4994 --- loss: 1.485034, loss_ss: 1.154801, loss_d: 0.330232
0.5378 --- loss: 1.659057, loss_ss: 1.130658, loss_d: 0.528400
0.5763 --- loss: 1.621767, loss_ss: 1.183110, loss_d: 0.438657
0.6147 --- loss: 1.562129, loss_ss: 1.130334, loss_d: 0.431795
0.6531 --- loss: 1.598577, loss_ss: 1.258021, loss_d: 0.340557
0.6915 --- loss: 1.431701, loss_ss: 1.067188, loss_d: 0.364513
0.7299 --- loss: 2.307799, loss_ss: 1.031160, loss_d: 1.276639
0.7683 --- loss: 1.554251, loss_ss: 1.169388, loss_d: 0.384863
0.8068 --- loss: 1.398363, loss_ss: 1.040698, loss_d: 0.357665
0.8452 --- loss: 1.298730, loss_ss: 1.004820, loss_d: 0.293910
0.8836 --- loss: 1.441815, loss_ss: 1.202026, loss_d: 0.239789
0.9220 --- loss: 1.415351, loss_ss: 1.000223, loss_d: 0.415127
0.9604 --- loss: 1.747256, loss_ss: 1.145419, loss_d: 0.601837
0.9988 --- loss: 1.589689, loss_ss: 1.317290, loss_d: 0.272399
Epoch finished! Loss: 1.5224244181926434
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.26857142857142857
             precision    recall  f1-score   support

        0.0       0.03      1.00      0.06        25
        1.0       0.00      0.00      0.00        93
        2.0       0.00      0.00      0.00       324
        3.0       0.99      0.53      0.69       484
        4.0       0.00      0.00      0.00       124

avg / total       0.46      0.27      0.32      1050
 


====== chp044-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  27.62  100.0   25.85   3.18      6.17
1  91.14    0.0  100.00   0.00      0.00
2  69.14    0.0  100.00   0.00      0.00
3  78.19   53.1   99.65  99.23     69.18
4  87.62    0.0   99.35   0.00      0.00
Total accuracy: 26.86%
Average sen: 30.62%
Average spec: 84.97%
Macro f1-score: 15.07%
[0.8027609  0.79152209 0.50057298 0.50057298 0.63114589 0.7679854
 0.80023819 0.80002505 0.79392993 0.79844558 0.80109262 0.8179124
 0.79472655 0.79947931 0.78617638 0.50057298 0.50057298 0.50057298
 0.68822253 0.79983956 0.79866207 0.7970556  0.79335207 0.79716742
 0.8148647  0.8035078  0.80087149 0.79765475 0.7898649  0.77264047
 0.79151344 0.8255688  0.80237031 0.7989412  0.70922822]
pred: 0.7448465858186994, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.340712, loss_ss: 1.605836, loss_d: 0.734876
0.0385 --- loss: 2.377095, loss_ss: 1.771659, loss_d: 0.605437
0.0770 --- loss: 2.000544, loss_ss: 1.608483, loss_d: 0.392061
0.1155 --- loss: 2.870111, loss_ss: 1.641371, loss_d: 1.228740
0.1540 --- loss: 2.337128, loss_ss: 1.641511, loss_d: 0.695617
0.1925 --- loss: 2.200345, loss_ss: 1.638797, loss_d: 0.561549
0.2309 --- loss: 2.363541, loss_ss: 1.666317, loss_d: 0.697223
0.2694 --- loss: 2.127331, loss_ss: 1.652689, loss_d: 0.474641
0.3079 --- loss: 2.054500, loss_ss: 1.575598, loss_d: 0.478902
0.3464 --- loss: 2.010006, loss_ss: 1.558536, loss_d: 0.451471
0.3849 --- loss: 2.092261, loss_ss: 1.632065, loss_d: 0.460196
0.4234 --- loss: 1.935222, loss_ss: 1.577657, loss_d: 0.357565
0.4619 --- loss: 2.432868, loss_ss: 1.600231, loss_d: 0.832637
0.5004 --- loss: 2.151064, loss_ss: 1.526684, loss_d: 0.624380
0.5389 --- loss: 2.012236, loss_ss: 1.456551, loss_d: 0.555685
0.5774 --- loss: 2.367088, loss_ss: 1.553667, loss_d: 0.813420
0.6159 --- loss: 1.955448, loss_ss: 1.532655, loss_d: 0.422793
0.6543 --- loss: 1.845016, loss_ss: 1.436888, loss_d: 0.408128
0.6928 --- loss: 2.081737, loss_ss: 1.525360, loss_d: 0.556377
0.7313 --- loss: 1.997297, loss_ss: 1.599139, loss_d: 0.398157
0.7698 --- loss: 1.985720, loss_ss: 1.546358, loss_d: 0.439362
0.8083 --- loss: 1.901942, loss_ss: 1.497716, loss_d: 0.404226
0.8468 --- loss: 2.004077, loss_ss: 1.574596, loss_d: 0.429481
0.8853 --- loss: 1.966688, loss_ss: 1.562953, loss_d: 0.403735
0.9238 --- loss: 2.271253, loss_ss: 1.497587, loss_d: 0.773666
0.9623 --- loss: 2.121790, loss_ss: 1.419940, loss_d: 0.701849
Epoch finished! Loss: 2.1375822440997974
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.154847, loss_ss: 1.618422, loss_d: 0.536425
0.0385 --- loss: 2.168869, loss_ss: 1.676608, loss_d: 0.492261
0.0770 --- loss: 1.859223, loss_ss: 1.502046, loss_d: 0.357176
0.1155 --- loss: 2.001485, loss_ss: 1.414679, loss_d: 0.586806
0.1540 --- loss: 2.132564, loss_ss: 1.507873, loss_d: 0.624690
0.1925 --- loss: 1.892710, loss_ss: 1.539829, loss_d: 0.352880
0.2309 --- loss: 1.870934, loss_ss: 1.364464, loss_d: 0.506470
0.2694 --- loss: 2.002764, loss_ss: 1.427505, loss_d: 0.575259
0.3079 --- loss: 1.824666, loss_ss: 1.412163, loss_d: 0.412503
0.3464 --- loss: 1.888587, loss_ss: 1.436291, loss_d: 0.452296
0.3849 --- loss: 2.064601, loss_ss: 1.298469, loss_d: 0.766132
0.4234 --- loss: 2.325092, loss_ss: 1.493661, loss_d: 0.831431
0.4619 --- loss: 2.134617, loss_ss: 1.560959, loss_d: 0.573657
0.5004 --- loss: 2.429479, loss_ss: 1.579172, loss_d: 0.850307
0.5389 --- loss: 2.018528, loss_ss: 1.549249, loss_d: 0.469279
0.5774 --- loss: 1.747565, loss_ss: 1.329537, loss_d: 0.418028
0.6159 --- loss: 1.635849, loss_ss: 1.260898, loss_d: 0.374951
0.6543 --- loss: 2.061550, loss_ss: 1.409815, loss_d: 0.651735
0.6928 --- loss: 1.676345, loss_ss: 1.408660, loss_d: 0.267684
0.7313 --- loss: 1.830208, loss_ss: 1.412760, loss_d: 0.417448
0.7698 --- loss: 1.749021, loss_ss: 1.274010, loss_d: 0.475011
0.8083 --- loss: 2.002074, loss_ss: 1.331838, loss_d: 0.670236
0.8468 --- loss: 2.125871, loss_ss: 1.543423, loss_d: 0.582448
0.8853 --- loss: 1.984810, loss_ss: 1.561309, loss_d: 0.423501
0.9238 --- loss: 1.962463, loss_ss: 1.407304, loss_d: 0.555158
0.9623 --- loss: 1.880903, loss_ss: 1.389282, loss_d: 0.491620
Epoch finished! Loss: 1.9811696716257043
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.966647, loss_ss: 1.497332, loss_d: 0.469315
0.0385 --- loss: 1.938151, loss_ss: 1.492867, loss_d: 0.445284
0.0770 --- loss: 1.839872, loss_ss: 1.489210, loss_d: 0.350662
0.1155 --- loss: 1.886307, loss_ss: 1.263029, loss_d: 0.623278
0.1540 --- loss: 1.924212, loss_ss: 1.357117, loss_d: 0.567095
0.1925 --- loss: 1.885037, loss_ss: 1.406886, loss_d: 0.478151
0.2309 --- loss: 1.722350, loss_ss: 1.329239, loss_d: 0.393110
0.2694 --- loss: 1.683386, loss_ss: 1.284485, loss_d: 0.398901
0.3079 --- loss: 1.951814, loss_ss: 1.572052, loss_d: 0.379762
0.3464 --- loss: 1.884440, loss_ss: 1.443449, loss_d: 0.440991
0.3849 --- loss: 2.345271, loss_ss: 1.663978, loss_d: 0.681293
0.4234 --- loss: 1.974921, loss_ss: 1.464401, loss_d: 0.510521
0.4619 --- loss: 1.746469, loss_ss: 1.412094, loss_d: 0.334375
0.5004 --- loss: 1.772264, loss_ss: 1.314098, loss_d: 0.458166
0.5389 --- loss: 1.643687, loss_ss: 1.244228, loss_d: 0.399459
0.5774 --- loss: 1.728894, loss_ss: 1.339730, loss_d: 0.389164
0.6159 --- loss: 2.349139, loss_ss: 1.476866, loss_d: 0.872273
0.6543 --- loss: 1.882143, loss_ss: 1.422762, loss_d: 0.459381
0.6928 --- loss: 1.990753, loss_ss: 1.502809, loss_d: 0.487944
0.7313 --- loss: 2.261267, loss_ss: 1.727329, loss_d: 0.533938
0.7698 --- loss: 1.821494, loss_ss: 1.192133, loss_d: 0.629362
0.8083 --- loss: 2.002614, loss_ss: 1.557867, loss_d: 0.444747
0.8468 --- loss: 1.625196, loss_ss: 1.162930, loss_d: 0.462266
0.8853 --- loss: 1.939960, loss_ss: 1.402748, loss_d: 0.537212
0.9238 --- loss: 1.704173, loss_ss: 1.255589, loss_d: 0.448584
0.9623 --- loss: 1.858332, loss_ss: 1.391514, loss_d: 0.466818
Epoch finished! Loss: 1.9051980010330907
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.203655, loss_ss: 1.496170, loss_d: 0.707485
0.0385 --- loss: 1.624755, loss_ss: 1.267034, loss_d: 0.357721
0.0770 --- loss: 2.088101, loss_ss: 1.335382, loss_d: 0.752719
0.1155 --- loss: 1.876026, loss_ss: 1.568096, loss_d: 0.307929
0.1540 --- loss: 2.014917, loss_ss: 1.534848, loss_d: 0.480070
0.1925 --- loss: 2.199089, loss_ss: 1.615387, loss_d: 0.583701
0.2309 --- loss: 1.930576, loss_ss: 1.340417, loss_d: 0.590159
0.2694 --- loss: 1.661654, loss_ss: 1.201725, loss_d: 0.459929
0.3079 --- loss: 1.903772, loss_ss: 1.320381, loss_d: 0.583391
0.3464 --- loss: 1.910894, loss_ss: 1.260429, loss_d: 0.650465
0.3849 --- loss: 1.624437, loss_ss: 1.277525, loss_d: 0.346912
0.4234 --- loss: 1.924130, loss_ss: 1.488503, loss_d: 0.435627
0.4619 --- loss: 1.660307, loss_ss: 1.253845, loss_d: 0.406462
0.5004 --- loss: 1.977700, loss_ss: 1.275839, loss_d: 0.701862
0.5389 --- loss: 2.020009, loss_ss: 1.321064, loss_d: 0.698945
0.5774 --- loss: 1.892807, loss_ss: 1.415129, loss_d: 0.477678
0.6159 --- loss: 1.476278, loss_ss: 1.113407, loss_d: 0.362871
0.6543 --- loss: 2.040963, loss_ss: 1.565127, loss_d: 0.475836
0.6928 --- loss: 1.973431, loss_ss: 1.304547, loss_d: 0.668884
0.7313 --- loss: 1.810254, loss_ss: 1.376446, loss_d: 0.433807
0.7698 --- loss: 1.673735, loss_ss: 1.245056, loss_d: 0.428679
0.8083 --- loss: 2.248635, loss_ss: 1.657573, loss_d: 0.591062
0.8468 --- loss: 2.113116, loss_ss: 1.529229, loss_d: 0.583887
0.8853 --- loss: 1.630861, loss_ss: 1.278224, loss_d: 0.352638
0.9238 --- loss: 1.745303, loss_ss: 1.421859, loss_d: 0.323444
0.9623 --- loss: 1.554574, loss_ss: 1.210333, loss_d: 0.344241
Epoch finished! Loss: 1.8183640112748016
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.657281, loss_ss: 1.173437, loss_d: 0.483844
0.0385 --- loss: 1.992544, loss_ss: 1.592761, loss_d: 0.399783
0.0770 --- loss: 1.517687, loss_ss: 1.176727, loss_d: 0.340960
0.1155 --- loss: 2.044124, loss_ss: 0.951837, loss_d: 1.092288
0.1540 --- loss: 1.741985, loss_ss: 1.404740, loss_d: 0.337245
0.1925 --- loss: 1.627357, loss_ss: 1.204182, loss_d: 0.423175
0.2309 --- loss: 1.460423, loss_ss: 1.102907, loss_d: 0.357515
0.2694 --- loss: 1.466995, loss_ss: 1.116709, loss_d: 0.350286
0.3079 --- loss: 1.728192, loss_ss: 1.090159, loss_d: 0.638032
0.3464 --- loss: 1.806254, loss_ss: 1.106240, loss_d: 0.700014
0.3849 --- loss: 1.438484, loss_ss: 1.085166, loss_d: 0.353318
0.4234 --- loss: 1.697568, loss_ss: 1.306669, loss_d: 0.390899
0.4619 --- loss: 1.629963, loss_ss: 1.155838, loss_d: 0.474126
0.5004 --- loss: 1.616380, loss_ss: 1.275512, loss_d: 0.340869
0.5389 --- loss: 1.730291, loss_ss: 1.367898, loss_d: 0.362393
0.5774 --- loss: 1.706211, loss_ss: 1.017106, loss_d: 0.689105
0.6159 --- loss: 1.669054, loss_ss: 1.122261, loss_d: 0.546793
0.6543 --- loss: 1.759782, loss_ss: 1.225839, loss_d: 0.533942
0.6928 --- loss: 1.722676, loss_ss: 1.190223, loss_d: 0.532454
0.7313 --- loss: 1.587888, loss_ss: 1.258017, loss_d: 0.329871
0.7698 --- loss: 2.024655, loss_ss: 0.942915, loss_d: 1.081740
0.8083 --- loss: 1.309324, loss_ss: 0.997907, loss_d: 0.311417
0.8468 --- loss: 1.567508, loss_ss: 1.196368, loss_d: 0.371140
0.8853 --- loss: 1.557455, loss_ss: 1.064221, loss_d: 0.493234
0.9238 --- loss: 1.809121, loss_ss: 1.252180, loss_d: 0.556941
0.9623 --- loss: 1.694886, loss_ss: 1.091143, loss_d: 0.603743
Epoch finished! Loss: 1.7041643107719864
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.458002, loss_ss: 1.024273, loss_d: 0.433729
0.0385 --- loss: 1.823526, loss_ss: 1.413456, loss_d: 0.410070
0.0770 --- loss: 1.825359, loss_ss: 1.146545, loss_d: 0.678814
0.1155 --- loss: 1.309008, loss_ss: 0.943909, loss_d: 0.365099
0.1540 --- loss: 1.956479, loss_ss: 1.190679, loss_d: 0.765800
0.1925 --- loss: 1.809774, loss_ss: 1.462708, loss_d: 0.347066
0.2309 --- loss: 1.860864, loss_ss: 1.373831, loss_d: 0.487033
0.2694 --- loss: 1.444029, loss_ss: 1.041226, loss_d: 0.402803
0.3079 --- loss: 1.308513, loss_ss: 0.910322, loss_d: 0.398191
0.3464 --- loss: 1.323284, loss_ss: 0.974801, loss_d: 0.348483
0.3849 --- loss: 2.176530, loss_ss: 1.314242, loss_d: 0.862289
0.4234 --- loss: 1.718369, loss_ss: 1.383474, loss_d: 0.334894
0.4619 --- loss: 2.013796, loss_ss: 1.081503, loss_d: 0.932293
0.5004 --- loss: 1.744748, loss_ss: 1.219622, loss_d: 0.525126
0.5389 --- loss: 1.533429, loss_ss: 1.208173, loss_d: 0.325256
0.5774 --- loss: 1.620752, loss_ss: 1.044086, loss_d: 0.576666
0.6159 --- loss: 1.405406, loss_ss: 0.869533, loss_d: 0.535874
0.6543 --- loss: 1.813647, loss_ss: 1.260142, loss_d: 0.553505
0.6928 --- loss: 1.538880, loss_ss: 0.979515, loss_d: 0.559365
0.7313 --- loss: 1.866035, loss_ss: 1.326616, loss_d: 0.539419
0.7698 --- loss: 1.455709, loss_ss: 1.053622, loss_d: 0.402087
0.8083 --- loss: 2.578172, loss_ss: 1.672744, loss_d: 0.905427
0.8468 --- loss: 1.845388, loss_ss: 1.282144, loss_d: 0.563244
0.8853 --- loss: 1.745992, loss_ss: 1.299085, loss_d: 0.446906
0.9238 --- loss: 1.400636, loss_ss: 0.888176, loss_d: 0.512460
0.9623 --- loss: 1.564875, loss_ss: 1.082969, loss_d: 0.481906
Epoch finished! Loss: 1.6496498294778772
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.574588, loss_ss: 1.054574, loss_d: 0.520014
0.0385 --- loss: 1.977823, loss_ss: 0.961569, loss_d: 1.016254
0.0770 --- loss: 1.350429, loss_ss: 0.949730, loss_d: 0.400699
0.1155 --- loss: 1.524060, loss_ss: 1.055778, loss_d: 0.468282
0.1540 --- loss: 1.530863, loss_ss: 1.048262, loss_d: 0.482601
0.1925 --- loss: 1.254818, loss_ss: 0.926285, loss_d: 0.328532
0.2309 --- loss: 1.756782, loss_ss: 1.207922, loss_d: 0.548860
0.2694 --- loss: 1.677119, loss_ss: 1.132620, loss_d: 0.544498
0.3079 --- loss: 1.509608, loss_ss: 1.067519, loss_d: 0.442090
0.3464 --- loss: 1.938804, loss_ss: 1.154310, loss_d: 0.784494
0.3849 --- loss: 1.582233, loss_ss: 1.163573, loss_d: 0.418660
0.4234 --- loss: 2.008114, loss_ss: 1.599363, loss_d: 0.408751
0.4619 --- loss: 1.551993, loss_ss: 1.118032, loss_d: 0.433961
0.5004 --- loss: 1.472354, loss_ss: 1.156923, loss_d: 0.315431
0.5389 --- loss: 1.465337, loss_ss: 1.143885, loss_d: 0.321452
0.5774 --- loss: 1.655816, loss_ss: 1.349087, loss_d: 0.306729
0.6159 --- loss: 1.328753, loss_ss: 0.996638, loss_d: 0.332114
0.6543 --- loss: 1.508710, loss_ss: 0.961882, loss_d: 0.546828
0.6928 --- loss: 1.539075, loss_ss: 1.086227, loss_d: 0.452848
0.7313 --- loss: 1.414766, loss_ss: 0.952850, loss_d: 0.461916
0.7698 --- loss: 1.850345, loss_ss: 1.162001, loss_d: 0.688344
0.8083 --- loss: 1.574003, loss_ss: 1.087483, loss_d: 0.486519
0.8468 --- loss: 1.333770, loss_ss: 0.933488, loss_d: 0.400282
0.8853 --- loss: 1.516744, loss_ss: 1.121246, loss_d: 0.395498
0.9238 --- loss: 1.501170, loss_ss: 1.171116, loss_d: 0.330054
0.9623 --- loss: 1.695001, loss_ss: 0.937886, loss_d: 0.757115
Epoch finished! Loss: 1.6150440806127424
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.116918, loss_ss: 1.557780, loss_d: 0.559138
0.0385 --- loss: 1.466422, loss_ss: 1.098985, loss_d: 0.367437
0.0770 --- loss: 1.387172, loss_ss: 0.939433, loss_d: 0.447740
0.1155 --- loss: 1.895018, loss_ss: 1.379849, loss_d: 0.515170
0.1540 --- loss: 1.882635, loss_ss: 1.352288, loss_d: 0.530347
0.1925 --- loss: 1.147762, loss_ss: 0.883076, loss_d: 0.264686
0.2309 --- loss: 1.478679, loss_ss: 1.044823, loss_d: 0.433856
0.2694 --- loss: 1.382435, loss_ss: 0.935253, loss_d: 0.447182
0.3079 --- loss: 1.468351, loss_ss: 0.986586, loss_d: 0.481765
0.3464 --- loss: 1.491014, loss_ss: 0.871342, loss_d: 0.619672
0.3849 --- loss: 1.765350, loss_ss: 1.132365, loss_d: 0.632984
0.4234 --- loss: 1.466550, loss_ss: 1.083269, loss_d: 0.383281
0.4619 --- loss: 1.390872, loss_ss: 0.997708, loss_d: 0.393164
0.5004 --- loss: 1.468717, loss_ss: 1.057873, loss_d: 0.410844
0.5389 --- loss: 1.160898, loss_ss: 0.896355, loss_d: 0.264543
0.5774 --- loss: 1.399837, loss_ss: 0.921348, loss_d: 0.478490
0.6159 --- loss: 1.679209, loss_ss: 1.196305, loss_d: 0.482903
0.6543 --- loss: 1.369706, loss_ss: 1.007507, loss_d: 0.362199
0.6928 --- loss: 1.681705, loss_ss: 1.369598, loss_d: 0.312107
0.7313 --- loss: 1.460298, loss_ss: 1.142812, loss_d: 0.317486
0.7698 --- loss: 1.149732, loss_ss: 0.901767, loss_d: 0.247965
0.8083 --- loss: 1.678303, loss_ss: 1.215073, loss_d: 0.463230
0.8468 --- loss: 1.627169, loss_ss: 1.116240, loss_d: 0.510930
0.8853 --- loss: 1.569764, loss_ss: 1.002416, loss_d: 0.567348
0.9238 --- loss: 1.322521, loss_ss: 0.767999, loss_d: 0.554522
0.9623 --- loss: 1.360165, loss_ss: 1.029898, loss_d: 0.330267
Epoch finished! Loss: 1.5833635136887834
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.444114, loss_ss: 1.112836, loss_d: 0.331278
0.0385 --- loss: 1.514103, loss_ss: 0.840198, loss_d: 0.673905
0.0770 --- loss: 1.349427, loss_ss: 0.946135, loss_d: 0.403291
0.1155 --- loss: 1.676292, loss_ss: 1.019038, loss_d: 0.657254
0.1540 --- loss: 1.441739, loss_ss: 1.134233, loss_d: 0.307507
0.1925 --- loss: 1.694183, loss_ss: 1.113442, loss_d: 0.580741
0.2309 --- loss: 1.595282, loss_ss: 0.984781, loss_d: 0.610501
0.2694 --- loss: 1.378185, loss_ss: 1.029321, loss_d: 0.348864
0.3079 --- loss: 1.975934, loss_ss: 1.162915, loss_d: 0.813020
0.3464 --- loss: 2.039451, loss_ss: 1.166640, loss_d: 0.872811
0.3849 --- loss: 1.548845, loss_ss: 1.202905, loss_d: 0.345939
0.4234 --- loss: 1.096387, loss_ss: 0.721943, loss_d: 0.374444
0.4619 --- loss: 1.506718, loss_ss: 1.223349, loss_d: 0.283369
0.5004 --- loss: 1.551072, loss_ss: 0.924465, loss_d: 0.626607
0.5389 --- loss: 1.397847, loss_ss: 1.024346, loss_d: 0.373501
0.5774 --- loss: 1.411959, loss_ss: 1.037852, loss_d: 0.374107
0.6159 --- loss: 1.486473, loss_ss: 1.069275, loss_d: 0.417198
0.6543 --- loss: 1.401399, loss_ss: 0.955689, loss_d: 0.445710
0.6928 --- loss: 1.461492, loss_ss: 1.123999, loss_d: 0.337494
0.7313 --- loss: 1.810086, loss_ss: 1.075743, loss_d: 0.734343
0.7698 --- loss: 1.356797, loss_ss: 1.046284, loss_d: 0.310512
0.8083 --- loss: 1.611998, loss_ss: 1.318608, loss_d: 0.293390
0.8468 --- loss: 1.304721, loss_ss: 1.041882, loss_d: 0.262839
0.8853 --- loss: 1.527813, loss_ss: 0.986536, loss_d: 0.541277
0.9238 --- loss: 1.574383, loss_ss: 1.225013, loss_d: 0.349369
0.9623 --- loss: 1.627538, loss_ss: 1.279776, loss_d: 0.347762
Epoch finished! Loss: 1.568850359861455
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.623541, loss_ss: 1.276320, loss_d: 0.347220
0.0385 --- loss: 1.404693, loss_ss: 0.961046, loss_d: 0.443647
0.0770 --- loss: 1.657954, loss_ss: 1.011248, loss_d: 0.646706
0.1155 --- loss: 1.617661, loss_ss: 1.045348, loss_d: 0.572313
0.1540 --- loss: 1.484035, loss_ss: 1.123417, loss_d: 0.360617
0.1925 --- loss: 1.572925, loss_ss: 0.906976, loss_d: 0.665949
0.2309 --- loss: 1.535889, loss_ss: 1.241829, loss_d: 0.294060
0.2694 --- loss: 1.293266, loss_ss: 0.937881, loss_d: 0.355385
0.3079 --- loss: 1.848319, loss_ss: 1.048999, loss_d: 0.799320
0.3464 --- loss: 1.737613, loss_ss: 1.015319, loss_d: 0.722294
0.3849 --- loss: 1.538716, loss_ss: 1.149937, loss_d: 0.388779
0.4234 --- loss: 1.189432, loss_ss: 0.823728, loss_d: 0.365704
0.4619 --- loss: 1.548779, loss_ss: 0.932513, loss_d: 0.616266
0.5004 --- loss: 1.241787, loss_ss: 0.960804, loss_d: 0.280983
0.5389 --- loss: 2.247689, loss_ss: 1.185757, loss_d: 1.061932
0.5774 --- loss: 1.322770, loss_ss: 0.986884, loss_d: 0.335886
0.6159 --- loss: 1.656337, loss_ss: 1.404365, loss_d: 0.251972
0.6543 --- loss: 2.082403, loss_ss: 1.501690, loss_d: 0.580713
0.6928 --- loss: 1.203613, loss_ss: 0.812500, loss_d: 0.391112
0.7313 --- loss: 1.182718, loss_ss: 0.870705, loss_d: 0.312013
0.7698 --- loss: 1.630005, loss_ss: 1.344407, loss_d: 0.285598
0.8083 --- loss: 1.556353, loss_ss: 1.186086, loss_d: 0.370267
0.8468 --- loss: 1.549709, loss_ss: 1.150686, loss_d: 0.399023
0.8853 --- loss: 1.367524, loss_ss: 0.893507, loss_d: 0.474017
0.9238 --- loss: 1.537274, loss_ss: 0.997063, loss_d: 0.540211
0.9623 --- loss: 1.605497, loss_ss: 1.250213, loss_d: 0.355283
Epoch finished! Loss: 1.5557211204845474
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.35279399499582986
             precision    recall  f1-score   support

        0.0       0.32      0.83      0.46       151
        1.0       0.00      0.00      0.00       135
        2.0       0.49      0.10      0.17       442
        3.0       0.90      0.53      0.67       221
        4.0       0.24      0.54      0.33       250

avg / total       0.44      0.35      0.31      1199
 


====== chp045-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  75.23  83.44   74.05  31.66     45.90
1  87.82   0.00   98.97   0.00      0.00
2  62.97  10.18   93.79  48.91     16.85
3  90.24  52.94   98.67  90.00     66.67
4  54.30  54.00   54.37  23.77     33.01
Total accuracy: 35.28%
Average sen: 40.11%
Average spec: 83.97%
Macro f1-score: 32.49%
[0.96096253 0.92056155 0.91301942 0.89614403 0.88984859 0.84843236
 0.90009356 0.91419053 0.91269022 0.92803347 0.89298934 0.87784714
 0.88364863 0.91038305 0.90178949 0.87345451 0.92438287 0.90864384
 0.91244614 0.91244692 0.92004555 0.93481249 0.92053074 0.91147691
 0.84220433 0.89363521 0.90833658 0.91713446 0.9237482  0.90670842
 0.91004735 0.90836501 0.89698535 0.90916842 0.90290433 0.91921753
 0.91775554 0.9199307  0.90310973 0.89284813]
pred: 0.9060243293642998, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.326866, loss_ss: 1.660005, loss_d: 0.666861
0.0384 --- loss: 1.936127, loss_ss: 1.550971, loss_d: 0.385157
0.0769 --- loss: 2.117903, loss_ss: 1.531588, loss_d: 0.586315
0.1153 --- loss: 2.161054, loss_ss: 1.707107, loss_d: 0.453947
0.1537 --- loss: 2.019949, loss_ss: 1.550549, loss_d: 0.469400
0.1922 --- loss: 1.904332, loss_ss: 1.471494, loss_d: 0.432837
0.2306 --- loss: 1.901064, loss_ss: 1.496170, loss_d: 0.404894
0.2690 --- loss: 2.189402, loss_ss: 1.659021, loss_d: 0.530381
0.3075 --- loss: 2.037552, loss_ss: 1.580784, loss_d: 0.456769
0.3459 --- loss: 2.044076, loss_ss: 1.399614, loss_d: 0.644462
0.3843 --- loss: 1.724515, loss_ss: 1.379663, loss_d: 0.344853
0.4228 --- loss: 1.826308, loss_ss: 1.439393, loss_d: 0.386915
0.4612 --- loss: 2.231272, loss_ss: 1.371800, loss_d: 0.859471
0.4996 --- loss: 2.163761, loss_ss: 1.470322, loss_d: 0.693439
0.5380 --- loss: 2.173990, loss_ss: 1.583127, loss_d: 0.590863
0.5765 --- loss: 2.200202, loss_ss: 1.574865, loss_d: 0.625337
0.6149 --- loss: 2.228057, loss_ss: 1.488172, loss_d: 0.739884
0.6533 --- loss: 1.757027, loss_ss: 1.300095, loss_d: 0.456933
0.6918 --- loss: 1.934764, loss_ss: 1.361794, loss_d: 0.572969
0.7302 --- loss: 2.275642, loss_ss: 1.637996, loss_d: 0.637646
0.7686 --- loss: 1.923561, loss_ss: 1.471314, loss_d: 0.452247
0.8071 --- loss: 1.965587, loss_ss: 1.634773, loss_d: 0.330813
0.8455 --- loss: 1.924069, loss_ss: 1.509228, loss_d: 0.414841
0.8839 --- loss: 2.104191, loss_ss: 1.451689, loss_d: 0.652502
0.9224 --- loss: 2.432685, loss_ss: 1.445568, loss_d: 0.987117
0.9608 --- loss: 2.058949, loss_ss: 1.487016, loss_d: 0.571933
0.9992 --- loss: 2.202555, loss_ss: 1.939355, loss_d: 0.263200
Epoch finished! Loss: 2.084717357158661
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.876205, loss_ss: 1.397364, loss_d: 0.478841
0.0384 --- loss: 1.866615, loss_ss: 1.470563, loss_d: 0.396051
0.0769 --- loss: 2.751929, loss_ss: 1.601718, loss_d: 1.150211
0.1153 --- loss: 2.099480, loss_ss: 1.631318, loss_d: 0.468161
0.1537 --- loss: 1.795255, loss_ss: 1.456981, loss_d: 0.338275
0.1922 --- loss: 2.024982, loss_ss: 1.361600, loss_d: 0.663382
0.2306 --- loss: 2.068948, loss_ss: 1.402219, loss_d: 0.666729
0.2690 --- loss: 2.202332, loss_ss: 1.749550, loss_d: 0.452781
0.3075 --- loss: 2.226957, loss_ss: 1.599000, loss_d: 0.627957
0.3459 --- loss: 1.928468, loss_ss: 1.399012, loss_d: 0.529456
0.3843 --- loss: 2.207914, loss_ss: 1.400842, loss_d: 0.807072
0.4228 --- loss: 2.069569, loss_ss: 1.691008, loss_d: 0.378560
0.4612 --- loss: 1.957556, loss_ss: 1.650833, loss_d: 0.306723
0.4996 --- loss: 2.405389, loss_ss: 1.648366, loss_d: 0.757022
0.5380 --- loss: 1.941261, loss_ss: 1.449322, loss_d: 0.491940
0.5765 --- loss: 2.011476, loss_ss: 1.595601, loss_d: 0.415875
0.6149 --- loss: 2.219739, loss_ss: 1.707154, loss_d: 0.512585
0.6533 --- loss: 1.919930, loss_ss: 1.302422, loss_d: 0.617508
0.6918 --- loss: 1.869449, loss_ss: 1.496417, loss_d: 0.373031
0.7302 --- loss: 1.927948, loss_ss: 1.370753, loss_d: 0.557196
0.7686 --- loss: 1.804412, loss_ss: 1.354398, loss_d: 0.450014
0.8071 --- loss: 2.111228, loss_ss: 1.452382, loss_d: 0.658847
0.8455 --- loss: 1.805859, loss_ss: 1.323070, loss_d: 0.482790
0.8839 --- loss: 1.694020, loss_ss: 1.317333, loss_d: 0.376687
0.9224 --- loss: 1.906229, loss_ss: 1.309485, loss_d: 0.596744
0.9608 --- loss: 2.042219, loss_ss: 1.381919, loss_d: 0.660300
0.9992 --- loss: 1.404811, loss_ss: 1.096161, loss_d: 0.308649
Epoch finished! Loss: 1.9945952397126419
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.999774, loss_ss: 1.549193, loss_d: 0.450581
0.0384 --- loss: 2.292948, loss_ss: 1.805351, loss_d: 0.487598
0.0769 --- loss: 1.625426, loss_ss: 1.217418, loss_d: 0.408007
0.1153 --- loss: 2.220887, loss_ss: 1.542921, loss_d: 0.677966
0.1537 --- loss: 2.458968, loss_ss: 1.380604, loss_d: 1.078364
0.1922 --- loss: 2.077423, loss_ss: 1.328232, loss_d: 0.749191
0.2306 --- loss: 1.786415, loss_ss: 1.283916, loss_d: 0.502499
0.2690 --- loss: 2.039099, loss_ss: 1.392381, loss_d: 0.646717
0.3075 --- loss: 2.115119, loss_ss: 1.343918, loss_d: 0.771201
0.3459 --- loss: 1.604312, loss_ss: 1.181446, loss_d: 0.422867
0.3843 --- loss: 1.753264, loss_ss: 1.449853, loss_d: 0.303411
0.4228 --- loss: 1.672973, loss_ss: 1.383999, loss_d: 0.288974
0.4612 --- loss: 1.910764, loss_ss: 1.445082, loss_d: 0.465681
0.4996 --- loss: 1.913099, loss_ss: 1.407518, loss_d: 0.505581
0.5380 --- loss: 1.980178, loss_ss: 1.455711, loss_d: 0.524467
0.5765 --- loss: 2.171889, loss_ss: 1.388626, loss_d: 0.783263
0.6149 --- loss: 2.101838, loss_ss: 1.668893, loss_d: 0.432945
0.6533 --- loss: 1.745718, loss_ss: 1.425551, loss_d: 0.320168
0.6918 --- loss: 2.179038, loss_ss: 1.307630, loss_d: 0.871408
0.7302 --- loss: 2.090402, loss_ss: 1.347707, loss_d: 0.742695
0.7686 --- loss: 2.006155, loss_ss: 1.449065, loss_d: 0.557090
0.8071 --- loss: 1.779139, loss_ss: 1.338831, loss_d: 0.440307
0.8455 --- loss: 1.809497, loss_ss: 1.212917, loss_d: 0.596580
0.8839 --- loss: 2.278324, loss_ss: 1.532130, loss_d: 0.746194
0.9224 --- loss: 1.954884, loss_ss: 1.470863, loss_d: 0.484022
0.9608 --- loss: 1.726605, loss_ss: 1.382116, loss_d: 0.344489
0.9992 --- loss: 1.723161, loss_ss: 1.387225, loss_d: 0.335937
Epoch finished! Loss: 1.8965318597280063
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.818119, loss_ss: 1.270376, loss_d: 0.547743
0.0384 --- loss: 2.183698, loss_ss: 1.331020, loss_d: 0.852678
0.0769 --- loss: 1.644405, loss_ss: 1.263335, loss_d: 0.381069
0.1153 --- loss: 1.598289, loss_ss: 1.217194, loss_d: 0.381095
0.1537 --- loss: 1.770912, loss_ss: 1.427983, loss_d: 0.342929
0.1922 --- loss: 1.894967, loss_ss: 1.260057, loss_d: 0.634910
0.2306 --- loss: 1.619226, loss_ss: 1.291685, loss_d: 0.327541
0.2690 --- loss: 2.085321, loss_ss: 1.565049, loss_d: 0.520272
0.3075 --- loss: 1.941783, loss_ss: 1.499865, loss_d: 0.441918
0.3459 --- loss: 1.721806, loss_ss: 1.178182, loss_d: 0.543624
0.3843 --- loss: 1.868114, loss_ss: 1.414894, loss_d: 0.453221
0.4228 --- loss: 1.800451, loss_ss: 1.357719, loss_d: 0.442733
0.4612 --- loss: 1.787987, loss_ss: 1.430858, loss_d: 0.357130
0.4996 --- loss: 2.094527, loss_ss: 1.462917, loss_d: 0.631609
0.5380 --- loss: 1.662055, loss_ss: 1.219784, loss_d: 0.442270
0.5765 --- loss: 1.771559, loss_ss: 1.295945, loss_d: 0.475613
0.6149 --- loss: 1.782322, loss_ss: 1.322034, loss_d: 0.460288
0.6533 --- loss: 1.644572, loss_ss: 1.229966, loss_d: 0.414606
0.6918 --- loss: 1.732332, loss_ss: 1.380858, loss_d: 0.351475
0.7302 --- loss: 2.024640, loss_ss: 1.371799, loss_d: 0.652841
0.7686 --- loss: 1.681509, loss_ss: 1.232132, loss_d: 0.449377
0.8071 --- loss: 1.898086, loss_ss: 1.269566, loss_d: 0.628520
0.8455 --- loss: 1.565325, loss_ss: 1.203384, loss_d: 0.361940
0.8839 --- loss: 1.603049, loss_ss: 1.245428, loss_d: 0.357621
0.9224 --- loss: 1.673706, loss_ss: 1.306837, loss_d: 0.366868
0.9608 --- loss: 2.047609, loss_ss: 1.624749, loss_d: 0.422860
0.9992 --- loss: 1.643824, loss_ss: 1.295211, loss_d: 0.348613
Epoch finished! Loss: 1.804864628498371
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.583194, loss_ss: 1.163303, loss_d: 0.419891
0.0384 --- loss: 1.905782, loss_ss: 1.250261, loss_d: 0.655521
0.0769 --- loss: 1.908954, loss_ss: 1.358073, loss_d: 0.550882
0.1153 --- loss: 1.907317, loss_ss: 1.210025, loss_d: 0.697292
0.1537 --- loss: 1.665083, loss_ss: 1.182753, loss_d: 0.482330
0.1922 --- loss: 1.595892, loss_ss: 1.149725, loss_d: 0.446167
0.2306 --- loss: 1.567502, loss_ss: 1.054365, loss_d: 0.513137
0.2690 --- loss: 1.852884, loss_ss: 1.374539, loss_d: 0.478345
0.3075 --- loss: 1.516312, loss_ss: 1.176262, loss_d: 0.340050
0.3459 --- loss: 2.262648, loss_ss: 1.285315, loss_d: 0.977334
0.3843 --- loss: 1.781223, loss_ss: 1.415010, loss_d: 0.366213
0.4228 --- loss: 1.617197, loss_ss: 1.190011, loss_d: 0.427186
0.4612 --- loss: 1.636062, loss_ss: 1.113942, loss_d: 0.522120
0.4996 --- loss: 1.688060, loss_ss: 1.315193, loss_d: 0.372867
0.5380 --- loss: 1.795345, loss_ss: 1.200721, loss_d: 0.594624
0.5765 --- loss: 1.849115, loss_ss: 1.365471, loss_d: 0.483644
0.6149 --- loss: 1.474387, loss_ss: 1.021629, loss_d: 0.452758
0.6533 --- loss: 1.497861, loss_ss: 1.111265, loss_d: 0.386596
0.6918 --- loss: 1.766295, loss_ss: 1.389359, loss_d: 0.376935
0.7302 --- loss: 1.694709, loss_ss: 1.095164, loss_d: 0.599545
0.7686 --- loss: 1.530693, loss_ss: 1.130164, loss_d: 0.400529
0.8071 --- loss: 1.874274, loss_ss: 1.282248, loss_d: 0.592026
0.8455 --- loss: 1.772624, loss_ss: 1.308339, loss_d: 0.464285
0.8839 --- loss: 1.883017, loss_ss: 1.394970, loss_d: 0.488046
0.9224 --- loss: 1.347862, loss_ss: 0.919815, loss_d: 0.428047
0.9608 --- loss: 1.498732, loss_ss: 1.142590, loss_d: 0.356141
0.9992 --- loss: 1.234916, loss_ss: 0.901301, loss_d: 0.333615
Epoch finished! Loss: 1.7007455211419327
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.498425, loss_ss: 1.126660, loss_d: 0.371765
0.0384 --- loss: 1.823174, loss_ss: 1.165557, loss_d: 0.657617
0.0769 --- loss: 1.424921, loss_ss: 1.083251, loss_d: 0.341670
0.1153 --- loss: 1.671072, loss_ss: 1.247119, loss_d: 0.423952
0.1537 --- loss: 1.688514, loss_ss: 1.184043, loss_d: 0.504471
0.1922 --- loss: 1.578891, loss_ss: 1.257377, loss_d: 0.321515
0.2306 --- loss: 1.828721, loss_ss: 0.990318, loss_d: 0.838403
0.2690 --- loss: 1.432677, loss_ss: 1.046035, loss_d: 0.386641
0.3075 --- loss: 1.413679, loss_ss: 0.967243, loss_d: 0.446436
0.3459 --- loss: 1.620393, loss_ss: 1.032514, loss_d: 0.587880
0.3843 --- loss: 1.550577, loss_ss: 1.107696, loss_d: 0.442881
0.4228 --- loss: 2.173913, loss_ss: 1.202724, loss_d: 0.971189
0.4612 --- loss: 2.316947, loss_ss: 0.909363, loss_d: 1.407584
0.4996 --- loss: 1.476281, loss_ss: 1.138312, loss_d: 0.337969
0.5380 --- loss: 1.421898, loss_ss: 1.038997, loss_d: 0.382901
0.5765 --- loss: 1.629641, loss_ss: 1.181325, loss_d: 0.448316
0.6149 --- loss: 1.696377, loss_ss: 1.295313, loss_d: 0.401064
0.6533 --- loss: 1.431990, loss_ss: 1.079777, loss_d: 0.352213
0.6918 --- loss: 1.467851, loss_ss: 1.182996, loss_d: 0.284855
0.7302 --- loss: 1.965878, loss_ss: 1.340085, loss_d: 0.625793
0.7686 --- loss: 1.871194, loss_ss: 1.205974, loss_d: 0.665219
0.8071 --- loss: 1.708775, loss_ss: 1.266124, loss_d: 0.442651
0.8455 --- loss: 2.147457, loss_ss: 1.176026, loss_d: 0.971431
0.8839 --- loss: 1.685266, loss_ss: 1.212251, loss_d: 0.473016
0.9224 --- loss: 2.317421, loss_ss: 1.316886, loss_d: 1.000534
0.9608 --- loss: 1.414519, loss_ss: 0.986677, loss_d: 0.427842
0.9992 --- loss: 3.362568, loss_ss: 1.484856, loss_d: 1.877711
Epoch finished! Loss: 1.641674086680779
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 2.184421, loss_ss: 1.325841, loss_d: 0.858580
0.0384 --- loss: 1.749451, loss_ss: 1.247132, loss_d: 0.502319
0.0769 --- loss: 1.785752, loss_ss: 1.343545, loss_d: 0.442207
0.1153 --- loss: 1.439965, loss_ss: 1.037040, loss_d: 0.402925
0.1537 --- loss: 1.661089, loss_ss: 0.957346, loss_d: 0.703743
0.1922 --- loss: 1.609754, loss_ss: 1.305773, loss_d: 0.303981
0.2306 --- loss: 1.696715, loss_ss: 1.135244, loss_d: 0.561471
0.2690 --- loss: 1.496241, loss_ss: 1.031003, loss_d: 0.465237
0.3075 --- loss: 1.752319, loss_ss: 0.993288, loss_d: 0.759031
0.3459 --- loss: 1.398988, loss_ss: 1.033025, loss_d: 0.365963
0.3843 --- loss: 1.665144, loss_ss: 1.234956, loss_d: 0.430189
0.4228 --- loss: 1.871828, loss_ss: 1.200826, loss_d: 0.671002
0.4612 --- loss: 1.368466, loss_ss: 1.003117, loss_d: 0.365349
0.4996 --- loss: 1.675640, loss_ss: 1.185391, loss_d: 0.490249
0.5380 --- loss: 1.566440, loss_ss: 1.243997, loss_d: 0.322444
0.5765 --- loss: 1.391856, loss_ss: 1.082273, loss_d: 0.309584
0.6149 --- loss: 1.583584, loss_ss: 1.042080, loss_d: 0.541504
0.6533 --- loss: 1.990180, loss_ss: 1.537274, loss_d: 0.452906
0.6918 --- loss: 1.845116, loss_ss: 1.052347, loss_d: 0.792769
0.7302 --- loss: 1.492780, loss_ss: 1.037005, loss_d: 0.455776
0.7686 --- loss: 1.637935, loss_ss: 1.210117, loss_d: 0.427818
0.8071 --- loss: 1.464973, loss_ss: 1.152987, loss_d: 0.311986
0.8455 --- loss: 1.266580, loss_ss: 0.933811, loss_d: 0.332769
0.8839 --- loss: 1.918702, loss_ss: 1.163872, loss_d: 0.754831
0.9224 --- loss: 1.512654, loss_ss: 1.103204, loss_d: 0.409449
0.9608 --- loss: 1.349427, loss_ss: 0.816849, loss_d: 0.532578
0.9992 --- loss: 1.677276, loss_ss: 1.289747, loss_d: 0.387529
Epoch finished! Loss: 1.6158012605630434
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.625112, loss_ss: 1.291960, loss_d: 0.333152
0.0384 --- loss: 2.159721, loss_ss: 1.341131, loss_d: 0.818590
0.0769 --- loss: 1.765208, loss_ss: 1.334906, loss_d: 0.430302
0.1153 --- loss: 1.886021, loss_ss: 1.004688, loss_d: 0.881333
0.1537 --- loss: 1.822637, loss_ss: 1.407652, loss_d: 0.414984
0.1922 --- loss: 1.677195, loss_ss: 1.129752, loss_d: 0.547444
0.2306 --- loss: 1.420904, loss_ss: 1.027552, loss_d: 0.393352
0.2690 --- loss: 1.639099, loss_ss: 1.124111, loss_d: 0.514988
0.3075 --- loss: 1.482873, loss_ss: 1.098511, loss_d: 0.384362
0.3459 --- loss: 1.382323, loss_ss: 0.825551, loss_d: 0.556772
0.3843 --- loss: 1.626291, loss_ss: 1.094882, loss_d: 0.531408
0.4228 --- loss: 1.327151, loss_ss: 0.917964, loss_d: 0.409187
0.4612 --- loss: 1.598135, loss_ss: 0.926332, loss_d: 0.671803
0.4996 --- loss: 1.927104, loss_ss: 1.330248, loss_d: 0.596857
0.5380 --- loss: 1.348441, loss_ss: 1.033458, loss_d: 0.314982
0.5765 --- loss: 1.529364, loss_ss: 1.102311, loss_d: 0.427053
0.6149 --- loss: 1.722383, loss_ss: 1.018095, loss_d: 0.704288
0.6533 --- loss: 1.555871, loss_ss: 1.242173, loss_d: 0.313698
0.6918 --- loss: 1.419016, loss_ss: 0.845435, loss_d: 0.573581
0.7302 --- loss: 1.282526, loss_ss: 0.912816, loss_d: 0.369710
0.7686 --- loss: 1.526551, loss_ss: 0.837398, loss_d: 0.689153
0.8071 --- loss: 2.029569, loss_ss: 1.073724, loss_d: 0.955845
0.8455 --- loss: 2.263662, loss_ss: 0.980479, loss_d: 1.283183
0.8839 --- loss: 2.079279, loss_ss: 1.702603, loss_d: 0.376676
0.9224 --- loss: 1.565821, loss_ss: 0.999738, loss_d: 0.566084
0.9608 --- loss: 1.214591, loss_ss: 0.861251, loss_d: 0.353341
0.9992 --- loss: 2.487141, loss_ss: 2.122606, loss_d: 0.364535
Epoch finished! Loss: 1.5965520469041972
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.949970, loss_ss: 1.535030, loss_d: 0.414941
0.0384 --- loss: 1.314039, loss_ss: 1.020886, loss_d: 0.293152
0.0769 --- loss: 1.308589, loss_ss: 1.077555, loss_d: 0.231034
0.1153 --- loss: 1.868726, loss_ss: 1.193464, loss_d: 0.675262
0.1537 --- loss: 1.559334, loss_ss: 1.178084, loss_d: 0.381250
0.1922 --- loss: 1.342260, loss_ss: 0.883868, loss_d: 0.458392
0.2306 --- loss: 1.482090, loss_ss: 1.032607, loss_d: 0.449483
0.2690 --- loss: 1.617987, loss_ss: 1.240887, loss_d: 0.377100
0.3075 --- loss: 1.244695, loss_ss: 0.976246, loss_d: 0.268449
0.3459 --- loss: 1.279302, loss_ss: 0.836990, loss_d: 0.442312
0.3843 --- loss: 1.623029, loss_ss: 1.199093, loss_d: 0.423936
0.4228 --- loss: 1.671714, loss_ss: 1.118889, loss_d: 0.552825
0.4612 --- loss: 1.440958, loss_ss: 1.018190, loss_d: 0.422768
0.4996 --- loss: 1.236907, loss_ss: 0.921753, loss_d: 0.315154
0.5380 --- loss: 1.410327, loss_ss: 0.983657, loss_d: 0.426670
0.5765 --- loss: 1.109446, loss_ss: 0.742177, loss_d: 0.367269
0.6149 --- loss: 1.638026, loss_ss: 1.158998, loss_d: 0.479028
0.6533 --- loss: 0.989763, loss_ss: 0.731214, loss_d: 0.258549
0.6918 --- loss: 1.547781, loss_ss: 1.168833, loss_d: 0.378948
0.7302 --- loss: 1.661317, loss_ss: 1.075330, loss_d: 0.585987
0.7686 --- loss: 1.260340, loss_ss: 0.936288, loss_d: 0.324052
0.8071 --- loss: 1.595755, loss_ss: 1.108397, loss_d: 0.487357
0.8455 --- loss: 1.757656, loss_ss: 1.358137, loss_d: 0.399518
0.8839 --- loss: 1.611477, loss_ss: 1.286318, loss_d: 0.325159
0.9224 --- loss: 1.308847, loss_ss: 0.862171, loss_d: 0.446676
0.9608 --- loss: 1.404349, loss_ss: 1.046535, loss_d: 0.357814
0.9992 --- loss: 1.112693, loss_ss: 0.776063, loss_d: 0.336630
Epoch finished! Loss: 1.5360727548599242
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.831267, loss_ss: 1.147677, loss_d: 0.683590
0.0384 --- loss: 1.531011, loss_ss: 0.963321, loss_d: 0.567690
0.0769 --- loss: 1.456049, loss_ss: 1.070240, loss_d: 0.385809
0.1153 --- loss: 1.288357, loss_ss: 0.982830, loss_d: 0.305528
0.1537 --- loss: 1.455336, loss_ss: 1.066040, loss_d: 0.389297
0.1922 --- loss: 1.402693, loss_ss: 1.005183, loss_d: 0.397510
0.2306 --- loss: 1.154220, loss_ss: 0.900946, loss_d: 0.253273
0.2690 --- loss: 1.569529, loss_ss: 1.255242, loss_d: 0.314287
0.3075 --- loss: 1.146586, loss_ss: 0.765047, loss_d: 0.381539
0.3459 --- loss: 1.681304, loss_ss: 1.220894, loss_d: 0.460410
0.3843 --- loss: 1.267538, loss_ss: 0.870479, loss_d: 0.397059
0.4228 --- loss: 1.535027, loss_ss: 0.859131, loss_d: 0.675896
0.4612 --- loss: 1.554828, loss_ss: 1.243880, loss_d: 0.310948
0.4996 --- loss: 1.269571, loss_ss: 0.943924, loss_d: 0.325647
0.5380 --- loss: 1.727513, loss_ss: 1.164946, loss_d: 0.562567
0.5765 --- loss: 1.289151, loss_ss: 0.933526, loss_d: 0.355625
0.6149 --- loss: 1.172476, loss_ss: 0.830442, loss_d: 0.342033
0.6533 --- loss: 1.933565, loss_ss: 1.214484, loss_d: 0.719082
0.6918 --- loss: 1.568697, loss_ss: 1.117929, loss_d: 0.450769
0.7302 --- loss: 1.225373, loss_ss: 0.907339, loss_d: 0.318033
0.7686 --- loss: 1.218861, loss_ss: 0.916784, loss_d: 0.302077
0.8071 --- loss: 1.296311, loss_ss: 0.906645, loss_d: 0.389666
0.8455 --- loss: 1.480880, loss_ss: 1.019325, loss_d: 0.461555
0.8839 --- loss: 1.090056, loss_ss: 0.818417, loss_d: 0.271640
0.9224 --- loss: 1.603411, loss_ss: 1.131380, loss_d: 0.472031
0.9608 --- loss: 1.517214, loss_ss: 1.076336, loss_d: 0.440879
0.9992 --- loss: 2.407782, loss_ss: 2.035152, loss_d: 0.372630
Epoch finished! Loss: 1.5205400042808972
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.15
             precision    recall  f1-score   support

        0.0       0.61      0.32      0.42       226
        1.0       0.00      0.00      0.00       357
        2.0       0.10      0.40      0.16       192
        3.0       0.01      1.00      0.02         2
        4.0       0.75      0.04      0.08       303

avg / total       0.36      0.15      0.14      1080
 


====== chp046-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  81.48   31.86   94.61  61.02     41.86
1  66.94    0.00  100.00   0.00      0.00
2  26.76   39.58   23.99  10.12     16.12
3  82.13  100.00   82.10   1.03      2.03
4  72.69    3.96   99.49  75.00      7.52
Total accuracy: 15.00%
Average sen: 35.08%
Average spec: 80.04%
Macro f1-score: 13.51%
[0.66979605 0.59136242 0.58861214 0.59277296 0.60692519 0.62083119
 0.72245818 0.62594318 0.62576556 0.69919831 0.67510206 0.66527748
 0.69021511 0.67633873 0.71653032 0.64211762 0.63828158 0.69532669
 0.71557254 0.70678538 0.72121364 0.68475413 0.66983217 0.59642595
 0.62004238 0.61897933 0.62506843 0.68624133 0.60752112 0.67544109
 0.7477988  0.72398275 0.72047782 0.59673339 0.63371909 0.68838286]
pred: 0.660606304804484, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.468609, loss_ss: 1.788696, loss_d: 0.679913
0.0383 --- loss: 2.393222, loss_ss: 1.653285, loss_d: 0.739937
0.0767 --- loss: 2.420796, loss_ss: 1.674578, loss_d: 0.746219
0.1150 --- loss: 2.158927, loss_ss: 1.670367, loss_d: 0.488559
0.1533 --- loss: 2.240715, loss_ss: 1.561342, loss_d: 0.679373
0.1916 --- loss: 2.118631, loss_ss: 1.612106, loss_d: 0.506525
0.2300 --- loss: 2.386364, loss_ss: 1.619320, loss_d: 0.767045
0.2683 --- loss: 1.950698, loss_ss: 1.514985, loss_d: 0.435713
0.3066 --- loss: 2.140869, loss_ss: 1.551606, loss_d: 0.589263
0.3450 --- loss: 2.580309, loss_ss: 1.485141, loss_d: 1.095168
0.3833 --- loss: 1.994394, loss_ss: 1.592891, loss_d: 0.401504
0.4216 --- loss: 1.892984, loss_ss: 1.527660, loss_d: 0.365324
0.4599 --- loss: 2.064135, loss_ss: 1.513283, loss_d: 0.550852
0.4983 --- loss: 2.053041, loss_ss: 1.589252, loss_d: 0.463790
0.5366 --- loss: 2.023297, loss_ss: 1.571466, loss_d: 0.451831
0.5749 --- loss: 2.029866, loss_ss: 1.492438, loss_d: 0.537428
0.6133 --- loss: 2.317456, loss_ss: 1.547287, loss_d: 0.770169
0.6516 --- loss: 2.009148, loss_ss: 1.541616, loss_d: 0.467532
0.6899 --- loss: 2.361639, loss_ss: 1.506667, loss_d: 0.854972
0.7282 --- loss: 2.072808, loss_ss: 1.467725, loss_d: 0.605083
0.7666 --- loss: 1.797126, loss_ss: 1.439345, loss_d: 0.357781
0.8049 --- loss: 2.042598, loss_ss: 1.542211, loss_d: 0.500387
0.8432 --- loss: 1.936892, loss_ss: 1.523293, loss_d: 0.413599
0.8816 --- loss: 1.969646, loss_ss: 1.536505, loss_d: 0.433141
0.9199 --- loss: 1.807799, loss_ss: 1.516920, loss_d: 0.290879
0.9582 --- loss: 2.126140, loss_ss: 1.515070, loss_d: 0.611070
0.9966 --- loss: 1.807006, loss_ss: 1.389689, loss_d: 0.417317
Epoch finished! Loss: 2.125925008608745
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.820353, loss_ss: 1.390796, loss_d: 0.429557
0.0383 --- loss: 2.003074, loss_ss: 1.477984, loss_d: 0.525090
0.0767 --- loss: 1.961362, loss_ss: 1.513599, loss_d: 0.447763
0.1150 --- loss: 2.181389, loss_ss: 1.416717, loss_d: 0.764672
0.1533 --- loss: 2.139025, loss_ss: 1.472533, loss_d: 0.666492
0.1916 --- loss: 2.125599, loss_ss: 1.680498, loss_d: 0.445101
0.2300 --- loss: 2.503689, loss_ss: 1.437870, loss_d: 1.065819
0.2683 --- loss: 1.920696, loss_ss: 1.362870, loss_d: 0.557826
0.3066 --- loss: 1.935307, loss_ss: 1.518562, loss_d: 0.416745
0.3450 --- loss: 2.134409, loss_ss: 1.554710, loss_d: 0.579699
0.3833 --- loss: 1.914505, loss_ss: 1.307422, loss_d: 0.607083
0.4216 --- loss: 1.770230, loss_ss: 1.459624, loss_d: 0.310606
0.4599 --- loss: 2.005990, loss_ss: 1.503083, loss_d: 0.502907
0.4983 --- loss: 1.731388, loss_ss: 1.369408, loss_d: 0.361980
0.5366 --- loss: 1.849622, loss_ss: 1.444453, loss_d: 0.405168
0.5749 --- loss: 1.963025, loss_ss: 1.394165, loss_d: 0.568860
0.6133 --- loss: 1.787759, loss_ss: 1.358983, loss_d: 0.428775
0.6516 --- loss: 1.891330, loss_ss: 1.349912, loss_d: 0.541418
0.6899 --- loss: 1.835107, loss_ss: 1.315573, loss_d: 0.519534
0.7282 --- loss: 2.030029, loss_ss: 1.291266, loss_d: 0.738763
0.7666 --- loss: 1.768622, loss_ss: 1.329160, loss_d: 0.439462
0.8049 --- loss: 1.918689, loss_ss: 1.323244, loss_d: 0.595444
0.8432 --- loss: 2.002753, loss_ss: 1.555498, loss_d: 0.447255
0.8816 --- loss: 1.718390, loss_ss: 1.365592, loss_d: 0.352799
0.9199 --- loss: 1.776156, loss_ss: 1.353286, loss_d: 0.422869
0.9582 --- loss: 2.230501, loss_ss: 1.613425, loss_d: 0.617076
0.9966 --- loss: 2.083336, loss_ss: 1.678028, loss_d: 0.405308
Epoch finished! Loss: 1.9945951617681064
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.946613, loss_ss: 1.557892, loss_d: 0.388721
0.0383 --- loss: 1.903868, loss_ss: 1.335941, loss_d: 0.567927
0.0767 --- loss: 2.106388, loss_ss: 1.492970, loss_d: 0.613417
0.1150 --- loss: 1.713285, loss_ss: 1.253158, loss_d: 0.460127
0.1533 --- loss: 1.988372, loss_ss: 1.544327, loss_d: 0.444045
0.1916 --- loss: 1.642637, loss_ss: 1.351273, loss_d: 0.291365
0.2300 --- loss: 1.806351, loss_ss: 1.411976, loss_d: 0.394376
0.2683 --- loss: 2.120576, loss_ss: 1.360278, loss_d: 0.760298
0.3066 --- loss: 1.616246, loss_ss: 1.244989, loss_d: 0.371257
0.3450 --- loss: 2.003983, loss_ss: 1.482097, loss_d: 0.521887
0.3833 --- loss: 1.968676, loss_ss: 1.367864, loss_d: 0.600813
0.4216 --- loss: 2.101504, loss_ss: 1.528979, loss_d: 0.572526
0.4599 --- loss: 1.867759, loss_ss: 1.429444, loss_d: 0.438315
0.4983 --- loss: 1.963074, loss_ss: 1.494070, loss_d: 0.469004
0.5366 --- loss: 1.972478, loss_ss: 1.511099, loss_d: 0.461379
0.5749 --- loss: 1.751285, loss_ss: 1.338460, loss_d: 0.412825
0.6133 --- loss: 1.967680, loss_ss: 1.473924, loss_d: 0.493756
0.6516 --- loss: 1.605950, loss_ss: 1.189734, loss_d: 0.416216
0.6899 --- loss: 1.734591, loss_ss: 1.211200, loss_d: 0.523391
0.7282 --- loss: 2.096467, loss_ss: 1.560699, loss_d: 0.535768
0.7666 --- loss: 1.839524, loss_ss: 1.424175, loss_d: 0.415349
0.8049 --- loss: 1.848820, loss_ss: 1.284967, loss_d: 0.563852
0.8432 --- loss: 1.877743, loss_ss: 1.481614, loss_d: 0.396128
0.8816 --- loss: 1.947985, loss_ss: 1.510339, loss_d: 0.437646
0.9199 --- loss: 1.957340, loss_ss: 1.526211, loss_d: 0.431129
0.9582 --- loss: 1.845882, loss_ss: 1.396615, loss_d: 0.449267
0.9966 --- loss: 1.520002, loss_ss: 1.292167, loss_d: 0.227835
Epoch finished! Loss: 1.9221747815608978
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.916421, loss_ss: 1.439487, loss_d: 0.476934
0.0383 --- loss: 1.730245, loss_ss: 1.267371, loss_d: 0.462874
0.0767 --- loss: 1.797783, loss_ss: 1.473584, loss_d: 0.324200
0.1150 --- loss: 1.961337, loss_ss: 1.403703, loss_d: 0.557634
0.1533 --- loss: 1.789011, loss_ss: 1.334948, loss_d: 0.454063
0.1916 --- loss: 2.035612, loss_ss: 1.525529, loss_d: 0.510083
0.2300 --- loss: 1.949820, loss_ss: 1.290211, loss_d: 0.659609
0.2683 --- loss: 1.641039, loss_ss: 1.313973, loss_d: 0.327066
0.3066 --- loss: 1.682334, loss_ss: 1.292841, loss_d: 0.389493
0.3450 --- loss: 1.747771, loss_ss: 1.343550, loss_d: 0.404221
0.3833 --- loss: 1.964114, loss_ss: 1.471129, loss_d: 0.492986
0.4216 --- loss: 1.985040, loss_ss: 1.406305, loss_d: 0.578735
0.4599 --- loss: 1.853528, loss_ss: 1.404791, loss_d: 0.448737
0.4983 --- loss: 2.342548, loss_ss: 1.790623, loss_d: 0.551924
0.5366 --- loss: 2.047654, loss_ss: 1.230947, loss_d: 0.816707
0.5749 --- loss: 2.379224, loss_ss: 1.321443, loss_d: 1.057781
0.6133 --- loss: 1.905306, loss_ss: 1.485661, loss_d: 0.419645
0.6516 --- loss: 1.770139, loss_ss: 1.322535, loss_d: 0.447604
0.6899 --- loss: 2.241703, loss_ss: 1.485457, loss_d: 0.756247
0.7282 --- loss: 1.722346, loss_ss: 1.364676, loss_d: 0.357670
0.7666 --- loss: 1.926915, loss_ss: 1.244359, loss_d: 0.682555
0.8049 --- loss: 1.739548, loss_ss: 1.325252, loss_d: 0.414297
0.8432 --- loss: 2.006968, loss_ss: 1.376096, loss_d: 0.630872
0.8816 --- loss: 1.774620, loss_ss: 1.168089, loss_d: 0.606531
0.9199 --- loss: 1.924880, loss_ss: 1.342262, loss_d: 0.582618
0.9582 --- loss: 1.876363, loss_ss: 1.383586, loss_d: 0.492778
0.9966 --- loss: 1.518466, loss_ss: 1.084476, loss_d: 0.433989
Epoch finished! Loss: 1.8374309526040005
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.020833, loss_ss: 1.622083, loss_d: 0.398750
0.0383 --- loss: 1.584240, loss_ss: 1.281206, loss_d: 0.303034
0.0767 --- loss: 1.596609, loss_ss: 1.176635, loss_d: 0.419974
0.1150 --- loss: 1.804083, loss_ss: 1.369764, loss_d: 0.434319
0.1533 --- loss: 1.578932, loss_ss: 1.227449, loss_d: 0.351483
0.1916 --- loss: 1.789481, loss_ss: 1.345505, loss_d: 0.443976
0.2300 --- loss: 1.774986, loss_ss: 1.166861, loss_d: 0.608126
0.2683 --- loss: 1.724887, loss_ss: 1.256177, loss_d: 0.468710
0.3066 --- loss: 1.884523, loss_ss: 1.371325, loss_d: 0.513198
0.3450 --- loss: 1.795317, loss_ss: 1.135721, loss_d: 0.659596
0.3833 --- loss: 1.956632, loss_ss: 1.431365, loss_d: 0.525267
0.4216 --- loss: 1.655588, loss_ss: 1.208698, loss_d: 0.446890
0.4599 --- loss: 1.625870, loss_ss: 1.125704, loss_d: 0.500165
0.4983 --- loss: 1.637141, loss_ss: 1.197320, loss_d: 0.439821
0.5366 --- loss: 1.842575, loss_ss: 1.514506, loss_d: 0.328069
0.5749 --- loss: 2.009463, loss_ss: 1.362404, loss_d: 0.647059
0.6133 --- loss: 1.588565, loss_ss: 1.128822, loss_d: 0.459744
0.6516 --- loss: 1.533424, loss_ss: 1.038906, loss_d: 0.494519
0.6899 --- loss: 1.854239, loss_ss: 1.420150, loss_d: 0.434089
0.7282 --- loss: 1.829145, loss_ss: 1.405302, loss_d: 0.423842
0.7666 --- loss: 1.581900, loss_ss: 1.158393, loss_d: 0.423506
0.8049 --- loss: 1.570736, loss_ss: 1.164745, loss_d: 0.405991
0.8432 --- loss: 1.799201, loss_ss: 1.254339, loss_d: 0.544862
0.8816 --- loss: 1.767939, loss_ss: 1.497475, loss_d: 0.270464
0.9199 --- loss: 1.531409, loss_ss: 1.136688, loss_d: 0.394721
0.9582 --- loss: 1.695334, loss_ss: 1.089346, loss_d: 0.605988
0.9966 --- loss: 1.398252, loss_ss: 0.974246, loss_d: 0.424006
Epoch finished! Loss: 1.7395474158800566
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.616027, loss_ss: 1.194064, loss_d: 0.421963
0.0383 --- loss: 1.982705, loss_ss: 1.450099, loss_d: 0.532606
0.0767 --- loss: 1.553721, loss_ss: 1.098015, loss_d: 0.455706
0.1150 --- loss: 1.693856, loss_ss: 1.219251, loss_d: 0.474605
0.1533 --- loss: 1.779813, loss_ss: 1.221036, loss_d: 0.558777
0.1916 --- loss: 1.861312, loss_ss: 0.932636, loss_d: 0.928676
0.2300 --- loss: 1.753361, loss_ss: 1.226528, loss_d: 0.526833
0.2683 --- loss: 1.723132, loss_ss: 1.118329, loss_d: 0.604803
0.3066 --- loss: 2.382272, loss_ss: 1.687056, loss_d: 0.695215
0.3450 --- loss: 1.861215, loss_ss: 1.385404, loss_d: 0.475811
0.3833 --- loss: 1.703076, loss_ss: 1.276958, loss_d: 0.426117
0.4216 --- loss: 1.575609, loss_ss: 1.161342, loss_d: 0.414267
0.4599 --- loss: 1.792960, loss_ss: 1.311302, loss_d: 0.481658
0.4983 --- loss: 1.779634, loss_ss: 1.326382, loss_d: 0.453252
0.5366 --- loss: 1.607983, loss_ss: 1.155848, loss_d: 0.452135
0.5749 --- loss: 1.620178, loss_ss: 1.044616, loss_d: 0.575562
0.6133 --- loss: 1.800182, loss_ss: 1.030074, loss_d: 0.770109
0.6516 --- loss: 1.512395, loss_ss: 1.002804, loss_d: 0.509591
0.6899 --- loss: 1.827499, loss_ss: 1.224810, loss_d: 0.602688
0.7282 --- loss: 1.546649, loss_ss: 1.121584, loss_d: 0.425064
0.7666 --- loss: 1.427984, loss_ss: 1.024093, loss_d: 0.403891
0.8049 --- loss: 2.026574, loss_ss: 1.365583, loss_d: 0.660991
0.8432 --- loss: 1.627882, loss_ss: 1.202639, loss_d: 0.425243
0.8816 --- loss: 1.367850, loss_ss: 0.929376, loss_d: 0.438474
0.9199 --- loss: 1.400674, loss_ss: 0.972688, loss_d: 0.427986
0.9582 --- loss: 1.780787, loss_ss: 1.442256, loss_d: 0.338531
0.9966 --- loss: 1.535877, loss_ss: 1.186287, loss_d: 0.349590
Epoch finished! Loss: 1.6468524309305044
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.470163, loss_ss: 1.138746, loss_d: 0.331418
0.0383 --- loss: 1.605633, loss_ss: 0.851156, loss_d: 0.754478
0.0767 --- loss: 1.398964, loss_ss: 1.067745, loss_d: 0.331219
0.1150 --- loss: 1.803083, loss_ss: 1.061362, loss_d: 0.741721
0.1533 --- loss: 3.154294, loss_ss: 1.588673, loss_d: 1.565621
0.1916 --- loss: 1.761736, loss_ss: 1.281870, loss_d: 0.479866
0.2300 --- loss: 1.496752, loss_ss: 1.046543, loss_d: 0.450209
0.2683 --- loss: 1.430963, loss_ss: 0.997631, loss_d: 0.433332
0.3066 --- loss: 1.860750, loss_ss: 1.400693, loss_d: 0.460057
0.3450 --- loss: 2.006722, loss_ss: 1.116693, loss_d: 0.890029
0.3833 --- loss: 1.675923, loss_ss: 1.229630, loss_d: 0.446294
0.4216 --- loss: 1.350016, loss_ss: 0.987776, loss_d: 0.362240
0.4599 --- loss: 1.994996, loss_ss: 1.321045, loss_d: 0.673951
0.4983 --- loss: 1.791077, loss_ss: 1.497974, loss_d: 0.293103
0.5366 --- loss: 1.762470, loss_ss: 1.215554, loss_d: 0.546916
0.5749 --- loss: 1.888484, loss_ss: 1.382015, loss_d: 0.506469
0.6133 --- loss: 1.453763, loss_ss: 0.893873, loss_d: 0.559891
0.6516 --- loss: 1.436922, loss_ss: 0.971944, loss_d: 0.464979
0.6899 --- loss: 1.472329, loss_ss: 1.109947, loss_d: 0.362383
0.7282 --- loss: 2.006277, loss_ss: 1.172947, loss_d: 0.833329
0.7666 --- loss: 1.392319, loss_ss: 0.815650, loss_d: 0.576669
0.8049 --- loss: 1.368028, loss_ss: 0.999608, loss_d: 0.368420
0.8432 --- loss: 1.538074, loss_ss: 0.991833, loss_d: 0.546241
0.8816 --- loss: 1.705262, loss_ss: 1.336410, loss_d: 0.368852
0.9199 --- loss: 2.153329, loss_ss: 1.439799, loss_d: 0.713530
0.9582 --- loss: 1.733941, loss_ss: 1.008577, loss_d: 0.725365
0.9966 --- loss: 1.481345, loss_ss: 0.936164, loss_d: 0.545181
Epoch finished! Loss: 1.6070139751984522
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.655816, loss_ss: 1.297075, loss_d: 0.358741
0.0383 --- loss: 1.450926, loss_ss: 1.088811, loss_d: 0.362115
0.0767 --- loss: 1.554537, loss_ss: 0.983610, loss_d: 0.570927
0.1150 --- loss: 1.536811, loss_ss: 1.152399, loss_d: 0.384412
0.1533 --- loss: 1.632172, loss_ss: 1.214293, loss_d: 0.417880
0.1916 --- loss: 1.356860, loss_ss: 0.939469, loss_d: 0.417391
0.2300 --- loss: 2.038118, loss_ss: 1.438984, loss_d: 0.599134
0.2683 --- loss: 1.432229, loss_ss: 1.039511, loss_d: 0.392718
0.3066 --- loss: 1.517409, loss_ss: 1.153821, loss_d: 0.363588
0.3450 --- loss: 1.513759, loss_ss: 1.208481, loss_d: 0.305278
0.3833 --- loss: 1.446399, loss_ss: 0.953649, loss_d: 0.492751
0.4216 --- loss: 1.319718, loss_ss: 0.975151, loss_d: 0.344567
0.4599 --- loss: 1.473811, loss_ss: 1.118539, loss_d: 0.355272
0.4983 --- loss: 1.332056, loss_ss: 1.008691, loss_d: 0.323364
0.5366 --- loss: 1.791613, loss_ss: 1.208457, loss_d: 0.583156
0.5749 --- loss: 1.681192, loss_ss: 1.030520, loss_d: 0.650672
0.6133 --- loss: 1.648893, loss_ss: 1.264284, loss_d: 0.384608
0.6516 --- loss: 1.531285, loss_ss: 1.018448, loss_d: 0.512837
0.6899 --- loss: 1.526181, loss_ss: 1.026876, loss_d: 0.499305
0.7282 --- loss: 1.490658, loss_ss: 0.999025, loss_d: 0.491633
0.7666 --- loss: 1.814744, loss_ss: 1.401940, loss_d: 0.412805
0.8049 --- loss: 1.488894, loss_ss: 0.999320, loss_d: 0.489573
0.8432 --- loss: 1.193328, loss_ss: 0.886780, loss_d: 0.306547
0.8816 --- loss: 1.371375, loss_ss: 1.006941, loss_d: 0.364434
0.9199 --- loss: 1.578328, loss_ss: 0.888931, loss_d: 0.689397
0.9582 --- loss: 1.743335, loss_ss: 1.271309, loss_d: 0.472026
0.9966 --- loss: 1.641032, loss_ss: 1.266092, loss_d: 0.374939
Epoch finished! Loss: 1.5856162836918464
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.620611, loss_ss: 1.068806, loss_d: 0.551805
0.0383 --- loss: 1.489361, loss_ss: 1.189906, loss_d: 0.299455
0.0767 --- loss: 1.516895, loss_ss: 1.169404, loss_d: 0.347492
0.1150 --- loss: 1.368552, loss_ss: 1.094308, loss_d: 0.274245
0.1533 --- loss: 1.290977, loss_ss: 0.924307, loss_d: 0.366670
0.1916 --- loss: 1.282134, loss_ss: 0.929267, loss_d: 0.352867
0.2300 --- loss: 1.536740, loss_ss: 1.165566, loss_d: 0.371174
0.2683 --- loss: 1.656747, loss_ss: 1.291767, loss_d: 0.364980
0.3066 --- loss: 1.619885, loss_ss: 1.204804, loss_d: 0.415081
0.3450 --- loss: 1.755383, loss_ss: 1.381663, loss_d: 0.373720
0.3833 --- loss: 1.399932, loss_ss: 0.989975, loss_d: 0.409957
0.4216 --- loss: 1.313215, loss_ss: 1.027281, loss_d: 0.285934
0.4599 --- loss: 1.401833, loss_ss: 1.097664, loss_d: 0.304168
0.4983 --- loss: 1.565915, loss_ss: 1.189402, loss_d: 0.376514
0.5366 --- loss: 1.364077, loss_ss: 0.994038, loss_d: 0.370038
0.5749 --- loss: 1.409806, loss_ss: 0.844498, loss_d: 0.565308
0.6133 --- loss: 1.576655, loss_ss: 0.971183, loss_d: 0.605472
0.6516 --- loss: 1.658309, loss_ss: 1.196678, loss_d: 0.461631
0.6899 --- loss: 1.396032, loss_ss: 0.979689, loss_d: 0.416343
0.7282 --- loss: 1.179963, loss_ss: 0.829493, loss_d: 0.350470
0.7666 --- loss: 1.268791, loss_ss: 0.970134, loss_d: 0.298657
0.8049 --- loss: 1.472535, loss_ss: 0.993674, loss_d: 0.478860
0.8432 --- loss: 1.624838, loss_ss: 1.222772, loss_d: 0.402066
0.8816 --- loss: 1.517617, loss_ss: 1.164510, loss_d: 0.353107
0.9199 --- loss: 1.212190, loss_ss: 0.929347, loss_d: 0.282844
0.9582 --- loss: 1.209402, loss_ss: 0.834312, loss_d: 0.375090
0.9966 --- loss: 1.264331, loss_ss: 0.919293, loss_d: 0.345038
Epoch finished! Loss: 1.5420721251230973
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.703878, loss_ss: 1.316210, loss_d: 0.387668
0.0383 --- loss: 1.522537, loss_ss: 1.139743, loss_d: 0.382794
0.0767 --- loss: 1.953363, loss_ss: 1.419307, loss_d: 0.534056
0.1150 --- loss: 1.406424, loss_ss: 1.037446, loss_d: 0.368978
0.1533 --- loss: 1.219936, loss_ss: 0.922376, loss_d: 0.297559
0.1916 --- loss: 1.608518, loss_ss: 1.194428, loss_d: 0.414090
0.2300 --- loss: 1.477604, loss_ss: 1.101099, loss_d: 0.376504
0.2683 --- loss: 2.218572, loss_ss: 1.650519, loss_d: 0.568054
0.3066 --- loss: 1.388108, loss_ss: 1.002942, loss_d: 0.385166
0.3450 --- loss: 1.509803, loss_ss: 1.161865, loss_d: 0.347938
0.3833 --- loss: 1.726618, loss_ss: 0.984521, loss_d: 0.742097
0.4216 --- loss: 1.437581, loss_ss: 1.111098, loss_d: 0.326483
0.4599 --- loss: 1.388141, loss_ss: 1.148582, loss_d: 0.239559
0.4983 --- loss: 1.706309, loss_ss: 1.080177, loss_d: 0.626132
0.5366 --- loss: 1.513033, loss_ss: 1.156883, loss_d: 0.356149
0.5749 --- loss: 1.805093, loss_ss: 1.287611, loss_d: 0.517482
0.6133 --- loss: 1.842577, loss_ss: 1.341249, loss_d: 0.501328
0.6516 --- loss: 1.399819, loss_ss: 1.086036, loss_d: 0.313783
0.6899 --- loss: 1.944070, loss_ss: 1.541382, loss_d: 0.402689
0.7282 --- loss: 1.695910, loss_ss: 0.977434, loss_d: 0.718476
0.7666 --- loss: 1.486040, loss_ss: 0.905231, loss_d: 0.580810
0.8049 --- loss: 1.375734, loss_ss: 0.935281, loss_d: 0.440453
0.8432 --- loss: 1.308104, loss_ss: 0.952451, loss_d: 0.355653
0.8816 --- loss: 1.586932, loss_ss: 1.089222, loss_d: 0.497710
0.9199 --- loss: 1.496413, loss_ss: 0.911644, loss_d: 0.584769
0.9582 --- loss: 1.216334, loss_ss: 0.877806, loss_d: 0.338528
0.9966 --- loss: 1.149916, loss_ss: 0.785935, loss_d: 0.363981
Epoch finished! Loss: 1.5439586648574242
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.2850574712643678
             precision    recall  f1-score   support

        0.0       0.38      0.60      0.47       291
        1.0       0.00      0.00      0.00       231
        2.0       0.40      0.19      0.26       233
        3.0       0.12      1.00      0.22        25
        4.0       0.05      0.06      0.05        90

avg / total       0.24      0.29      0.24       870
 


====== chp047-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  54.25   59.79   51.47  38.24     46.65
1  73.45    0.00  100.00   0.00      0.00
2  70.80   18.88   89.80  40.37     25.73
3  79.54  100.00   78.93  12.32     21.93
4  78.97    5.56   87.44   4.85      5.18
Total accuracy: 28.51%
Average sen: 36.85%
Average spec: 81.53%
Macro f1-score: 19.90%
[0.94861019 0.98656589 0.93114811 0.98329276 0.95026708 0.97478682
 0.98118973 0.96002179 0.95202929 0.98456872 0.92241305 0.97701913
 0.97980642 0.97306663 0.98663831 0.97484469 0.98579466 0.9588812
 0.94738799 0.98357612 0.98038495 0.95292008 0.98674041 0.9583053
 0.5699333  0.9707818  0.98452365 0.94415396 0.97484517]
pred: 0.9539481791956671, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.593980, loss_ss: 1.839066, loss_d: 0.754914
0.0384 --- loss: 2.194317, loss_ss: 1.733188, loss_d: 0.461129
0.0768 --- loss: 2.246744, loss_ss: 1.798859, loss_d: 0.447885
0.1152 --- loss: 2.199961, loss_ss: 1.681904, loss_d: 0.518057
0.1536 --- loss: 2.414919, loss_ss: 1.706050, loss_d: 0.708869
0.1920 --- loss: 1.726178, loss_ss: 1.480600, loss_d: 0.245579
0.2304 --- loss: 2.291440, loss_ss: 1.616955, loss_d: 0.674485
0.2688 --- loss: 2.204316, loss_ss: 1.666587, loss_d: 0.537730
0.3072 --- loss: 1.993393, loss_ss: 1.598267, loss_d: 0.395126
0.3456 --- loss: 1.824723, loss_ss: 1.484398, loss_d: 0.340324
0.3840 --- loss: 2.049628, loss_ss: 1.496149, loss_d: 0.553479
0.4224 --- loss: 2.581333, loss_ss: 1.503540, loss_d: 1.077793
0.4608 --- loss: 2.287216, loss_ss: 1.612665, loss_d: 0.674552
0.4992 --- loss: 1.956942, loss_ss: 1.556211, loss_d: 0.400731
0.5376 --- loss: 2.121051, loss_ss: 1.572198, loss_d: 0.548853
0.5760 --- loss: 1.983895, loss_ss: 1.490139, loss_d: 0.493756
0.6144 --- loss: 1.881864, loss_ss: 1.482129, loss_d: 0.399735
0.6528 --- loss: 2.229930, loss_ss: 1.495839, loss_d: 0.734091
0.6912 --- loss: 2.067661, loss_ss: 1.561476, loss_d: 0.506185
0.7296 --- loss: 1.984845, loss_ss: 1.448623, loss_d: 0.536222
0.7680 --- loss: 1.956423, loss_ss: 1.579895, loss_d: 0.376528
0.8065 --- loss: 1.835475, loss_ss: 1.416967, loss_d: 0.418508
0.8449 --- loss: 2.055747, loss_ss: 1.589022, loss_d: 0.466725
0.8833 --- loss: 2.163944, loss_ss: 1.518757, loss_d: 0.645187
0.9217 --- loss: 1.973713, loss_ss: 1.412595, loss_d: 0.561119
0.9601 --- loss: 1.816684, loss_ss: 1.431299, loss_d: 0.385384
0.9985 --- loss: 2.028180, loss_ss: 1.413172, loss_d: 0.615008
Epoch finished! Loss: 2.1484009394278893
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.948000, loss_ss: 1.451999, loss_d: 0.496001
0.0384 --- loss: 2.078171, loss_ss: 1.446720, loss_d: 0.631450
0.0768 --- loss: 2.129075, loss_ss: 1.560540, loss_d: 0.568535
0.1152 --- loss: 2.029019, loss_ss: 1.495137, loss_d: 0.533882
0.1536 --- loss: 2.035148, loss_ss: 1.528780, loss_d: 0.506367
0.1920 --- loss: 1.915590, loss_ss: 1.430670, loss_d: 0.484920
0.2304 --- loss: 1.875604, loss_ss: 1.505178, loss_d: 0.370426
0.2688 --- loss: 1.946739, loss_ss: 1.429293, loss_d: 0.517446
0.3072 --- loss: 1.835125, loss_ss: 1.480254, loss_d: 0.354872
0.3456 --- loss: 1.811679, loss_ss: 1.399703, loss_d: 0.411976
0.3840 --- loss: 2.138201, loss_ss: 1.563844, loss_d: 0.574357
0.4224 --- loss: 2.026182, loss_ss: 1.625579, loss_d: 0.400603
0.4608 --- loss: 1.728099, loss_ss: 1.309720, loss_d: 0.418379
0.4992 --- loss: 1.802875, loss_ss: 1.432229, loss_d: 0.370645
0.5376 --- loss: 1.901236, loss_ss: 1.574998, loss_d: 0.326238
0.5760 --- loss: 1.852653, loss_ss: 1.322771, loss_d: 0.529882
0.6144 --- loss: 2.025771, loss_ss: 1.397920, loss_d: 0.627851
0.6528 --- loss: 1.775855, loss_ss: 1.376962, loss_d: 0.398893
0.6912 --- loss: 1.975137, loss_ss: 1.538817, loss_d: 0.436320
0.7296 --- loss: 1.914714, loss_ss: 1.378043, loss_d: 0.536671
0.7680 --- loss: 1.975030, loss_ss: 1.278166, loss_d: 0.696863
0.8065 --- loss: 1.892623, loss_ss: 1.244526, loss_d: 0.648097
0.8449 --- loss: 2.064724, loss_ss: 1.559756, loss_d: 0.504968
0.8833 --- loss: 1.808609, loss_ss: 1.421828, loss_d: 0.386781
0.9217 --- loss: 2.249581, loss_ss: 1.371987, loss_d: 0.877594
0.9601 --- loss: 2.324350, loss_ss: 1.604782, loss_d: 0.719568
0.9985 --- loss: 2.631433, loss_ss: 1.295885, loss_d: 1.335548
Epoch finished! Loss: 1.9935869423242716
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.874242, loss_ss: 1.322872, loss_d: 0.551371
0.0384 --- loss: 1.789165, loss_ss: 1.375271, loss_d: 0.413894
0.0768 --- loss: 1.877325, loss_ss: 1.434899, loss_d: 0.442426
0.1152 --- loss: 1.976098, loss_ss: 1.429342, loss_d: 0.546756
0.1536 --- loss: 1.968149, loss_ss: 1.357256, loss_d: 0.610893
0.1920 --- loss: 1.835376, loss_ss: 1.451521, loss_d: 0.383855
0.2304 --- loss: 1.699204, loss_ss: 1.340829, loss_d: 0.358375
0.2688 --- loss: 2.493882, loss_ss: 1.469939, loss_d: 1.023942
0.3072 --- loss: 1.690845, loss_ss: 1.359701, loss_d: 0.331144
0.3456 --- loss: 2.243460, loss_ss: 1.634935, loss_d: 0.608525
0.3840 --- loss: 1.942048, loss_ss: 1.519689, loss_d: 0.422359
0.4224 --- loss: 1.735180, loss_ss: 1.412071, loss_d: 0.323109
0.4608 --- loss: 1.931810, loss_ss: 1.472772, loss_d: 0.459038
0.4992 --- loss: 1.960174, loss_ss: 1.590644, loss_d: 0.369530
0.5376 --- loss: 1.790656, loss_ss: 1.352215, loss_d: 0.438441
0.5760 --- loss: 1.853472, loss_ss: 1.404192, loss_d: 0.449280
0.6144 --- loss: 1.955116, loss_ss: 1.303118, loss_d: 0.651998
0.6528 --- loss: 1.924258, loss_ss: 1.263708, loss_d: 0.660550
0.6912 --- loss: 1.912582, loss_ss: 1.457554, loss_d: 0.455028
0.7296 --- loss: 1.699408, loss_ss: 1.284766, loss_d: 0.414642
0.7680 --- loss: 2.195824, loss_ss: 1.391133, loss_d: 0.804691
0.8065 --- loss: 1.797298, loss_ss: 1.417185, loss_d: 0.380114
0.8449 --- loss: 1.804913, loss_ss: 1.379223, loss_d: 0.425690
0.8833 --- loss: 2.026752, loss_ss: 1.505774, loss_d: 0.520978
0.9217 --- loss: 1.721902, loss_ss: 1.220931, loss_d: 0.500971
0.9601 --- loss: 1.783339, loss_ss: 1.440452, loss_d: 0.342887
0.9985 --- loss: 2.124759, loss_ss: 1.679329, loss_d: 0.445430
Epoch finished! Loss: 1.9185692892624782
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.916880, loss_ss: 1.252350, loss_d: 0.664530
0.0384 --- loss: 2.287950, loss_ss: 1.475684, loss_d: 0.812266
0.0768 --- loss: 1.971333, loss_ss: 1.582278, loss_d: 0.389054
0.1152 --- loss: 2.010510, loss_ss: 1.486993, loss_d: 0.523518
0.1536 --- loss: 1.712576, loss_ss: 1.309273, loss_d: 0.403303
0.1920 --- loss: 1.731680, loss_ss: 1.150131, loss_d: 0.581549
0.2304 --- loss: 1.890684, loss_ss: 1.256362, loss_d: 0.634322
0.2688 --- loss: 1.775670, loss_ss: 1.377905, loss_d: 0.397764
0.3072 --- loss: 1.623828, loss_ss: 1.266935, loss_d: 0.356893
0.3456 --- loss: 2.428150, loss_ss: 1.439663, loss_d: 0.988486
0.3840 --- loss: 1.695670, loss_ss: 1.437055, loss_d: 0.258615
0.4224 --- loss: 1.767973, loss_ss: 1.324326, loss_d: 0.443648
0.4608 --- loss: 1.907853, loss_ss: 1.395766, loss_d: 0.512087
0.4992 --- loss: 1.832125, loss_ss: 1.364867, loss_d: 0.467258
0.5376 --- loss: 1.989460, loss_ss: 1.496668, loss_d: 0.492793
0.5760 --- loss: 1.979500, loss_ss: 1.522307, loss_d: 0.457194
0.6144 --- loss: 1.538913, loss_ss: 1.151006, loss_d: 0.387907
0.6528 --- loss: 1.789364, loss_ss: 1.380528, loss_d: 0.408836
0.6912 --- loss: 1.786597, loss_ss: 1.421946, loss_d: 0.364650
0.7296 --- loss: 1.674860, loss_ss: 1.228478, loss_d: 0.446381
0.7680 --- loss: 1.939699, loss_ss: 1.226296, loss_d: 0.713402
0.8065 --- loss: 1.655128, loss_ss: 1.278078, loss_d: 0.377050
0.8449 --- loss: 1.895358, loss_ss: 1.414741, loss_d: 0.480617
0.8833 --- loss: 2.259810, loss_ss: 1.484064, loss_d: 0.775747
0.9217 --- loss: 1.710249, loss_ss: 1.262043, loss_d: 0.448206
0.9601 --- loss: 1.692365, loss_ss: 1.270893, loss_d: 0.421472
0.9985 --- loss: 2.065071, loss_ss: 1.707269, loss_d: 0.357802
Epoch finished! Loss: 1.8763844196613018
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.863176, loss_ss: 1.473342, loss_d: 0.389834
0.0384 --- loss: 1.708724, loss_ss: 1.345393, loss_d: 0.363330
0.0768 --- loss: 1.810141, loss_ss: 1.269024, loss_d: 0.541117
0.1152 --- loss: 1.712648, loss_ss: 1.334360, loss_d: 0.378288
0.1536 --- loss: 1.856352, loss_ss: 1.409520, loss_d: 0.446832
0.1920 --- loss: 1.888243, loss_ss: 1.436501, loss_d: 0.451742
0.2304 --- loss: 1.699732, loss_ss: 1.198711, loss_d: 0.501021
0.2688 --- loss: 1.710110, loss_ss: 1.258510, loss_d: 0.451600
0.3072 --- loss: 1.939293, loss_ss: 1.320019, loss_d: 0.619274
0.3456 --- loss: 1.990605, loss_ss: 1.399988, loss_d: 0.590617
0.3840 --- loss: 1.807605, loss_ss: 1.379172, loss_d: 0.428433
0.4224 --- loss: 1.713175, loss_ss: 1.225106, loss_d: 0.488070
0.4608 --- loss: 1.682273, loss_ss: 1.288530, loss_d: 0.393743
0.4992 --- loss: 1.868315, loss_ss: 1.395563, loss_d: 0.472752
0.5376 --- loss: 1.649902, loss_ss: 1.277789, loss_d: 0.372112
0.5760 --- loss: 1.728760, loss_ss: 1.326613, loss_d: 0.402147
0.6144 --- loss: 1.727375, loss_ss: 1.158173, loss_d: 0.569202
0.6528 --- loss: 1.796303, loss_ss: 1.176205, loss_d: 0.620099
0.6912 --- loss: 1.633137, loss_ss: 1.206461, loss_d: 0.426677
0.7296 --- loss: 1.748438, loss_ss: 1.238825, loss_d: 0.509613
0.7680 --- loss: 1.747227, loss_ss: 1.322119, loss_d: 0.425108
0.8065 --- loss: 1.653389, loss_ss: 1.359668, loss_d: 0.293721
0.8449 --- loss: 1.540100, loss_ss: 1.179647, loss_d: 0.360453
0.8833 --- loss: 1.779518, loss_ss: 1.277929, loss_d: 0.501589
0.9217 --- loss: 1.560559, loss_ss: 1.097114, loss_d: 0.463445
0.9601 --- loss: 1.549912, loss_ss: 1.215967, loss_d: 0.333945
0.9985 --- loss: 3.121685, loss_ss: 1.004097, loss_d: 2.117589
Epoch finished! Loss: 1.79292599100333
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.851082, loss_ss: 1.091947, loss_d: 0.759135
0.0384 --- loss: 1.450755, loss_ss: 0.989028, loss_d: 0.461728
0.0768 --- loss: 1.721668, loss_ss: 1.231146, loss_d: 0.490522
0.1152 --- loss: 1.481314, loss_ss: 1.138974, loss_d: 0.342341
0.1536 --- loss: 1.630251, loss_ss: 1.138141, loss_d: 0.492109
0.1920 --- loss: 1.537236, loss_ss: 1.137497, loss_d: 0.399739
0.2304 --- loss: 1.854254, loss_ss: 1.434063, loss_d: 0.420191
0.2688 --- loss: 1.537845, loss_ss: 1.102872, loss_d: 0.434973
0.3072 --- loss: 1.820352, loss_ss: 1.242386, loss_d: 0.577967
0.3456 --- loss: 1.767792, loss_ss: 0.992279, loss_d: 0.775513
0.3840 --- loss: 1.411591, loss_ss: 1.042067, loss_d: 0.369525
0.4224 --- loss: 1.502422, loss_ss: 1.086438, loss_d: 0.415985
0.4608 --- loss: 1.591392, loss_ss: 1.155196, loss_d: 0.436196
0.4992 --- loss: 1.679430, loss_ss: 1.000968, loss_d: 0.678462
0.5376 --- loss: 1.595084, loss_ss: 0.917430, loss_d: 0.677654
0.5760 --- loss: 1.559364, loss_ss: 1.246041, loss_d: 0.313324
0.6144 --- loss: 1.685342, loss_ss: 1.230370, loss_d: 0.454972
0.6528 --- loss: 1.665708, loss_ss: 1.340700, loss_d: 0.325008
0.6912 --- loss: 1.606430, loss_ss: 1.271767, loss_d: 0.334663
0.7296 --- loss: 1.747486, loss_ss: 1.267101, loss_d: 0.480385
0.7680 --- loss: 1.770414, loss_ss: 1.266259, loss_d: 0.504154
0.8065 --- loss: 1.662302, loss_ss: 1.226989, loss_d: 0.435312
0.8449 --- loss: 1.659350, loss_ss: 1.206110, loss_d: 0.453240
0.8833 --- loss: 1.554121, loss_ss: 1.136438, loss_d: 0.417684
0.9217 --- loss: 1.442911, loss_ss: 1.158406, loss_d: 0.284505
0.9601 --- loss: 1.695300, loss_ss: 1.165247, loss_d: 0.530053
0.9985 --- loss: 1.602452, loss_ss: 1.231867, loss_d: 0.370585
Epoch finished! Loss: 1.6890677305368276
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.686159, loss_ss: 1.290405, loss_d: 0.395755
0.0384 --- loss: 1.466366, loss_ss: 1.146734, loss_d: 0.319633
0.0768 --- loss: 1.558389, loss_ss: 1.178689, loss_d: 0.379700
0.1152 --- loss: 1.634948, loss_ss: 1.208431, loss_d: 0.426517
0.1536 --- loss: 1.355854, loss_ss: 1.034942, loss_d: 0.320911
0.1920 --- loss: 1.249751, loss_ss: 0.865056, loss_d: 0.384695
0.2304 --- loss: 1.153452, loss_ss: 0.912051, loss_d: 0.241401
0.2688 --- loss: 1.703272, loss_ss: 1.095255, loss_d: 0.608016
0.3072 --- loss: 1.559324, loss_ss: 1.150441, loss_d: 0.408883
0.3456 --- loss: 1.983680, loss_ss: 1.517279, loss_d: 0.466402
0.3840 --- loss: 2.041832, loss_ss: 1.514677, loss_d: 0.527154
0.4224 --- loss: 1.934530, loss_ss: 1.306026, loss_d: 0.628504
0.4608 --- loss: 1.537503, loss_ss: 1.071351, loss_d: 0.466152
0.4992 --- loss: 2.470400, loss_ss: 1.977311, loss_d: 0.493089
0.5376 --- loss: 1.356160, loss_ss: 0.911902, loss_d: 0.444258
0.5760 --- loss: 1.496504, loss_ss: 1.119877, loss_d: 0.376627
0.6144 --- loss: 1.796236, loss_ss: 1.288408, loss_d: 0.507828
0.6528 --- loss: 1.600691, loss_ss: 1.064514, loss_d: 0.536176
0.6912 --- loss: 1.420334, loss_ss: 0.834076, loss_d: 0.586259
0.7296 --- loss: 1.550249, loss_ss: 1.194075, loss_d: 0.356174
0.7680 --- loss: 1.200227, loss_ss: 0.896676, loss_d: 0.303551
0.8065 --- loss: 1.402297, loss_ss: 1.035893, loss_d: 0.366404
0.8449 --- loss: 1.519928, loss_ss: 1.073620, loss_d: 0.446308
0.8833 --- loss: 1.715217, loss_ss: 1.196553, loss_d: 0.518664
0.9217 --- loss: 1.514922, loss_ss: 1.147067, loss_d: 0.367855
0.9601 --- loss: 1.863496, loss_ss: 1.162398, loss_d: 0.701098
0.9985 --- loss: 2.301229, loss_ss: 1.197722, loss_d: 1.103507
Epoch finished! Loss: 1.653912905546335
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.536649, loss_ss: 1.148103, loss_d: 0.388545
0.0384 --- loss: 1.495270, loss_ss: 1.103236, loss_d: 0.392034
0.0768 --- loss: 1.426787, loss_ss: 0.982771, loss_d: 0.444016
0.1152 --- loss: 1.665154, loss_ss: 1.312314, loss_d: 0.352840
0.1536 --- loss: 1.398625, loss_ss: 1.100810, loss_d: 0.297815
0.1920 --- loss: 1.210330, loss_ss: 0.885424, loss_d: 0.324906
0.2304 --- loss: 1.764443, loss_ss: 1.311478, loss_d: 0.452965
0.2688 --- loss: 1.294875, loss_ss: 0.945235, loss_d: 0.349640
0.3072 --- loss: 1.487864, loss_ss: 1.159670, loss_d: 0.328194
0.3456 --- loss: 1.470504, loss_ss: 1.047818, loss_d: 0.422686
0.3840 --- loss: 1.689913, loss_ss: 1.071324, loss_d: 0.618589
0.4224 --- loss: 1.794918, loss_ss: 1.186074, loss_d: 0.608844
0.4608 --- loss: 1.550594, loss_ss: 1.199402, loss_d: 0.351191
0.4992 --- loss: 1.620533, loss_ss: 1.187690, loss_d: 0.432842
0.5376 --- loss: 1.441333, loss_ss: 1.070983, loss_d: 0.370350
0.5760 --- loss: 1.399485, loss_ss: 0.925008, loss_d: 0.474476
0.6144 --- loss: 1.212065, loss_ss: 1.033063, loss_d: 0.179002
0.6528 --- loss: 1.286138, loss_ss: 1.033458, loss_d: 0.252680
0.6912 --- loss: 1.378141, loss_ss: 1.087139, loss_d: 0.291002
0.7296 --- loss: 1.713458, loss_ss: 1.171231, loss_d: 0.542227
0.7680 --- loss: 1.247436, loss_ss: 0.891661, loss_d: 0.355775
0.8065 --- loss: 1.402925, loss_ss: 0.938486, loss_d: 0.464439
0.8449 --- loss: 1.384809, loss_ss: 1.014262, loss_d: 0.370547
0.8833 --- loss: 1.674459, loss_ss: 1.285231, loss_d: 0.389227
0.9217 --- loss: 1.477922, loss_ss: 1.134051, loss_d: 0.343871
0.9601 --- loss: 1.509764, loss_ss: 1.022970, loss_d: 0.486793
0.9985 --- loss: 1.772441, loss_ss: 1.431660, loss_d: 0.340782
Epoch finished! Loss: 1.5619435768861036
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.049427, loss_ss: 0.795431, loss_d: 0.253996
0.0384 --- loss: 1.520669, loss_ss: 1.030465, loss_d: 0.490205
0.0768 --- loss: 1.417365, loss_ss: 1.158459, loss_d: 0.258906
0.1152 --- loss: 2.162663, loss_ss: 1.168940, loss_d: 0.993722
0.1536 --- loss: 1.639823, loss_ss: 1.193557, loss_d: 0.446267
0.1920 --- loss: 1.413483, loss_ss: 1.089119, loss_d: 0.324364
0.2304 --- loss: 1.695357, loss_ss: 1.184070, loss_d: 0.511287
0.2688 --- loss: 1.589930, loss_ss: 0.998341, loss_d: 0.591589
0.3072 --- loss: 1.472384, loss_ss: 0.925328, loss_d: 0.547057
0.3456 --- loss: 1.735572, loss_ss: 1.152130, loss_d: 0.583442
0.3840 --- loss: 1.466949, loss_ss: 1.131921, loss_d: 0.335029
0.4224 --- loss: 1.940712, loss_ss: 1.223834, loss_d: 0.716878
0.4608 --- loss: 1.534739, loss_ss: 1.056181, loss_d: 0.478558
0.4992 --- loss: 1.445617, loss_ss: 1.015644, loss_d: 0.429973
0.5376 --- loss: 1.447972, loss_ss: 1.079896, loss_d: 0.368077
0.5760 --- loss: 1.604872, loss_ss: 1.087460, loss_d: 0.517412
0.6144 --- loss: 1.646376, loss_ss: 1.279143, loss_d: 0.367233
0.6528 --- loss: 1.486911, loss_ss: 1.027469, loss_d: 0.459442
0.6912 --- loss: 1.325689, loss_ss: 1.026415, loss_d: 0.299274
0.7296 --- loss: 1.357063, loss_ss: 1.117074, loss_d: 0.239989
0.7680 --- loss: 1.046647, loss_ss: 0.784350, loss_d: 0.262297
0.8065 --- loss: 1.910719, loss_ss: 0.977249, loss_d: 0.933470
0.8449 --- loss: 1.295561, loss_ss: 0.958455, loss_d: 0.337105
0.8833 --- loss: 1.330577, loss_ss: 0.906657, loss_d: 0.423920
0.9217 --- loss: 1.577375, loss_ss: 1.157490, loss_d: 0.419885
0.9601 --- loss: 1.597307, loss_ss: 0.984352, loss_d: 0.612955
0.9985 --- loss: 1.268508, loss_ss: 1.077896, loss_d: 0.190612
Epoch finished! Loss: 1.5676630423619198
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.397712, loss_ss: 0.964286, loss_d: 0.433425
0.0384 --- loss: 1.423539, loss_ss: 1.129320, loss_d: 0.294219
0.0768 --- loss: 1.871894, loss_ss: 0.940057, loss_d: 0.931837
0.1152 --- loss: 2.207529, loss_ss: 1.433358, loss_d: 0.774171
0.1536 --- loss: 1.392200, loss_ss: 0.980257, loss_d: 0.411943
0.1920 --- loss: 1.798133, loss_ss: 1.335832, loss_d: 0.462301
0.2304 --- loss: 1.392095, loss_ss: 0.968956, loss_d: 0.423139
0.2688 --- loss: 1.255184, loss_ss: 0.833443, loss_d: 0.421740
0.3072 --- loss: 1.363815, loss_ss: 1.035995, loss_d: 0.327820
0.3456 --- loss: 1.405222, loss_ss: 1.091534, loss_d: 0.313688
0.3840 --- loss: 1.478565, loss_ss: 1.097540, loss_d: 0.381025
0.4224 --- loss: 2.278781, loss_ss: 1.334701, loss_d: 0.944079
0.4608 --- loss: 1.627705, loss_ss: 1.247721, loss_d: 0.379984
0.4992 --- loss: 1.271211, loss_ss: 1.011728, loss_d: 0.259483
0.5376 --- loss: 1.616028, loss_ss: 1.204995, loss_d: 0.411033
0.5760 --- loss: 1.621663, loss_ss: 0.978047, loss_d: 0.643615
0.6144 --- loss: 1.447091, loss_ss: 1.171893, loss_d: 0.275198
0.6528 --- loss: 1.246301, loss_ss: 0.940349, loss_d: 0.305952
0.6912 --- loss: 1.202147, loss_ss: 0.841276, loss_d: 0.360871
0.7296 --- loss: 1.484923, loss_ss: 1.057131, loss_d: 0.427791
0.7680 --- loss: 1.521832, loss_ss: 1.100370, loss_d: 0.421461
0.8065 --- loss: 1.279780, loss_ss: 0.816191, loss_d: 0.463589
0.8449 --- loss: 2.011523, loss_ss: 1.138752, loss_d: 0.872771
0.8833 --- loss: 1.340232, loss_ss: 0.958669, loss_d: 0.381563
0.9217 --- loss: 1.308240, loss_ss: 1.029620, loss_d: 0.278620
0.9601 --- loss: 1.294204, loss_ss: 1.004856, loss_d: 0.289348
0.9985 --- loss: 1.616500, loss_ss: 1.201838, loss_d: 0.414662
Epoch finished! Loss: 1.5552065340372232
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6264705882352941
             precision    recall  f1-score   support

        0.0       0.50      0.39      0.44        38
        1.0       0.00      0.00      0.00       144
        2.0       0.65      0.93      0.76       495
        3.0       0.00      0.00      0.00       107
        4.0       0.58      0.70      0.64       236

avg / total       0.47      0.63      0.53      1020
 


====== chp048-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  96.27  39.47   98.47  50.00     44.12
1  85.88   0.00  100.00   0.00      0.00
2  72.25  92.53   53.14  65.06     76.40
3  89.51   0.00  100.00   0.00      0.00
4  81.37  70.34   84.69  58.04     63.60
Total accuracy: 62.65%
Average sen: 40.47%
Average spec: 87.26%
Macro f1-score: 36.82%
[0.74805593 0.75266689 0.74758023 0.72782218 0.73493767 0.65811419
 0.59745413 0.63900197 0.42985305 0.72511375 0.7162993  0.48618129
 0.68182528 0.65020168 0.46878695 0.75114602 0.74801737 0.74148238
 0.71282053 0.71478468 0.71356207 0.74568141 0.69915247 0.20562521
 0.62325495 0.74650294 0.63293332 0.75630409 0.56295431 0.75066006
 0.74252433 0.74180317 0.75945354 0.68744749]
pred: 0.670588376767495, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.338356, loss_ss: 1.639612, loss_d: 0.698744
0.0384 --- loss: 1.980405, loss_ss: 1.588498, loss_d: 0.391907
0.0769 --- loss: 2.162476, loss_ss: 1.505403, loss_d: 0.657073
0.1153 --- loss: 2.129174, loss_ss: 1.486183, loss_d: 0.642991
0.1537 --- loss: 1.853588, loss_ss: 1.403711, loss_d: 0.449877
0.1922 --- loss: 1.976666, loss_ss: 1.416347, loss_d: 0.560319
0.2306 --- loss: 2.116016, loss_ss: 1.442174, loss_d: 0.673842
0.2690 --- loss: 2.271941, loss_ss: 1.707031, loss_d: 0.564911
0.3075 --- loss: 2.094234, loss_ss: 1.440063, loss_d: 0.654170
0.3459 --- loss: 1.901137, loss_ss: 1.397196, loss_d: 0.503941
0.3843 --- loss: 1.958063, loss_ss: 1.580785, loss_d: 0.377278
0.4228 --- loss: 2.082156, loss_ss: 1.563392, loss_d: 0.518764
0.4612 --- loss: 2.170160, loss_ss: 1.693341, loss_d: 0.476819
0.4996 --- loss: 2.029976, loss_ss: 1.545927, loss_d: 0.484049
0.5380 --- loss: 2.090865, loss_ss: 1.467110, loss_d: 0.623755
0.5765 --- loss: 1.887387, loss_ss: 1.491034, loss_d: 0.396353
0.6149 --- loss: 1.746189, loss_ss: 1.446278, loss_d: 0.299910
0.6533 --- loss: 1.968112, loss_ss: 1.331053, loss_d: 0.637059
0.6918 --- loss: 2.145210, loss_ss: 1.590666, loss_d: 0.554544
0.7302 --- loss: 2.006063, loss_ss: 1.355459, loss_d: 0.650603
0.7686 --- loss: 1.921355, loss_ss: 1.473079, loss_d: 0.448276
0.8071 --- loss: 2.207108, loss_ss: 1.546999, loss_d: 0.660108
0.8455 --- loss: 2.123366, loss_ss: 1.475067, loss_d: 0.648300
0.8839 --- loss: 2.290061, loss_ss: 1.691642, loss_d: 0.598418
0.9224 --- loss: 2.272962, loss_ss: 1.351612, loss_d: 0.921350
0.9608 --- loss: 1.904470, loss_ss: 1.564306, loss_d: 0.340165
0.9992 --- loss: 2.704642, loss_ss: 1.072661, loss_d: 1.631980
Epoch finished! Loss: 2.0882260157511783
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.016181, loss_ss: 1.532988, loss_d: 0.483193
0.0384 --- loss: 2.123502, loss_ss: 1.575206, loss_d: 0.548296
0.0769 --- loss: 2.022900, loss_ss: 1.561222, loss_d: 0.461678
0.1153 --- loss: 2.107042, loss_ss: 1.485087, loss_d: 0.621955
0.1537 --- loss: 2.071184, loss_ss: 1.496100, loss_d: 0.575084
0.1922 --- loss: 1.882104, loss_ss: 1.518159, loss_d: 0.363946
0.2306 --- loss: 1.793570, loss_ss: 1.466410, loss_d: 0.327161
0.2690 --- loss: 1.584198, loss_ss: 1.307423, loss_d: 0.276775
0.3075 --- loss: 2.711434, loss_ss: 1.438931, loss_d: 1.272504
0.3459 --- loss: 2.085547, loss_ss: 1.522975, loss_d: 0.562572
0.3843 --- loss: 2.135431, loss_ss: 1.619560, loss_d: 0.515871
0.4228 --- loss: 2.007190, loss_ss: 1.515187, loss_d: 0.492003
0.4612 --- loss: 1.930591, loss_ss: 1.615384, loss_d: 0.315207
0.4996 --- loss: 1.933733, loss_ss: 1.534538, loss_d: 0.399195
0.5380 --- loss: 2.251846, loss_ss: 1.602325, loss_d: 0.649520
0.5765 --- loss: 2.273057, loss_ss: 1.434138, loss_d: 0.838920
0.6149 --- loss: 2.182030, loss_ss: 1.566957, loss_d: 0.615073
0.6533 --- loss: 2.005121, loss_ss: 1.475312, loss_d: 0.529809
0.6918 --- loss: 1.939971, loss_ss: 1.535414, loss_d: 0.404558
0.7302 --- loss: 2.187574, loss_ss: 1.653437, loss_d: 0.534138
0.7686 --- loss: 2.018813, loss_ss: 1.487756, loss_d: 0.531057
0.8071 --- loss: 1.880757, loss_ss: 1.551306, loss_d: 0.329451
0.8455 --- loss: 2.098296, loss_ss: 1.576488, loss_d: 0.521808
0.8839 --- loss: 1.989379, loss_ss: 1.579917, loss_d: 0.409462
0.9224 --- loss: 1.936106, loss_ss: 1.466605, loss_d: 0.469501
0.9608 --- loss: 2.084541, loss_ss: 1.461523, loss_d: 0.623018
0.9992 --- loss: 3.641752, loss_ss: 1.805646, loss_d: 1.836106
Epoch finished! Loss: 2.0448066734350645
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.080181, loss_ss: 1.479465, loss_d: 0.600716
0.0384 --- loss: 2.074215, loss_ss: 1.437962, loss_d: 0.636253
0.0769 --- loss: 1.920911, loss_ss: 1.368163, loss_d: 0.552748
0.1153 --- loss: 1.777711, loss_ss: 1.319430, loss_d: 0.458280
0.1537 --- loss: 1.810909, loss_ss: 1.470115, loss_d: 0.340794
0.1922 --- loss: 2.189483, loss_ss: 1.620781, loss_d: 0.568702
0.2306 --- loss: 2.021938, loss_ss: 1.450679, loss_d: 0.571259
0.2690 --- loss: 2.015318, loss_ss: 1.403869, loss_d: 0.611449
0.3075 --- loss: 1.737218, loss_ss: 1.309175, loss_d: 0.428043
0.3459 --- loss: 2.103854, loss_ss: 1.601551, loss_d: 0.502304
0.3843 --- loss: 1.848948, loss_ss: 1.434005, loss_d: 0.414942
0.4228 --- loss: 1.928788, loss_ss: 1.416508, loss_d: 0.512280
0.4612 --- loss: 1.865350, loss_ss: 1.391908, loss_d: 0.473442
0.4996 --- loss: 2.046733, loss_ss: 1.702620, loss_d: 0.344113
0.5380 --- loss: 1.985593, loss_ss: 1.585086, loss_d: 0.400506
0.5765 --- loss: 1.791731, loss_ss: 1.425714, loss_d: 0.366017
0.6149 --- loss: 1.886329, loss_ss: 1.221074, loss_d: 0.665255
0.6533 --- loss: 1.694154, loss_ss: 1.293784, loss_d: 0.400370
0.6918 --- loss: 1.708868, loss_ss: 1.342521, loss_d: 0.366347
0.7302 --- loss: 2.099065, loss_ss: 1.490236, loss_d: 0.608829
0.7686 --- loss: 1.902246, loss_ss: 1.573894, loss_d: 0.328352
0.8071 --- loss: 1.875176, loss_ss: 1.496498, loss_d: 0.378679
0.8455 --- loss: 1.812316, loss_ss: 1.307250, loss_d: 0.505066
0.8839 --- loss: 1.573134, loss_ss: 1.143544, loss_d: 0.429590
0.9224 --- loss: 1.886408, loss_ss: 1.387018, loss_d: 0.499389
0.9608 --- loss: 1.464178, loss_ss: 1.022624, loss_d: 0.441554
0.9992 --- loss: 1.835465, loss_ss: 1.474088, loss_d: 0.361377
Epoch finished! Loss: 1.9176349960840666
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.805228, loss_ss: 1.215529, loss_d: 0.589699
0.0384 --- loss: 1.725305, loss_ss: 1.370471, loss_d: 0.354834
0.0769 --- loss: 1.802786, loss_ss: 1.361928, loss_d: 0.440857
0.1153 --- loss: 1.522102, loss_ss: 1.137747, loss_d: 0.384355
0.1537 --- loss: 2.356997, loss_ss: 1.183662, loss_d: 1.173335
0.1922 --- loss: 1.919235, loss_ss: 1.239805, loss_d: 0.679430
0.2306 --- loss: 1.948305, loss_ss: 1.368332, loss_d: 0.579973
0.2690 --- loss: 1.639113, loss_ss: 1.225123, loss_d: 0.413990
0.3075 --- loss: 1.975933, loss_ss: 1.330457, loss_d: 0.645476
0.3459 --- loss: 1.922596, loss_ss: 1.473471, loss_d: 0.449125
0.3843 --- loss: 1.877993, loss_ss: 1.215284, loss_d: 0.662709
0.4228 --- loss: 1.701577, loss_ss: 1.254466, loss_d: 0.447111
0.4612 --- loss: 1.710412, loss_ss: 1.165678, loss_d: 0.544734
0.4996 --- loss: 1.655906, loss_ss: 1.258700, loss_d: 0.397206
0.5380 --- loss: 1.585866, loss_ss: 1.155202, loss_d: 0.430664
0.5765 --- loss: 2.150442, loss_ss: 1.683415, loss_d: 0.467027
0.6149 --- loss: 1.683065, loss_ss: 1.146217, loss_d: 0.536848
0.6533 --- loss: 2.016478, loss_ss: 1.239315, loss_d: 0.777163
0.6918 --- loss: 1.591871, loss_ss: 1.249074, loss_d: 0.342797
0.7302 --- loss: 1.663810, loss_ss: 0.975503, loss_d: 0.688307
0.7686 --- loss: 1.893392, loss_ss: 1.281309, loss_d: 0.612082
0.8071 --- loss: 1.523397, loss_ss: 1.042754, loss_d: 0.480644
0.8455 --- loss: 1.902590, loss_ss: 1.296691, loss_d: 0.605899
0.8839 --- loss: 1.567285, loss_ss: 1.184693, loss_d: 0.382593
0.9224 --- loss: 1.703180, loss_ss: 1.362266, loss_d: 0.340914
0.9608 --- loss: 1.864679, loss_ss: 1.141807, loss_d: 0.722872
0.9992 --- loss: 1.314769, loss_ss: 0.991100, loss_d: 0.323668
Epoch finished! Loss: 1.76260146682079
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.914697, loss_ss: 1.476250, loss_d: 0.438448
0.0384 --- loss: 2.009192, loss_ss: 1.000245, loss_d: 1.008947
0.0769 --- loss: 1.504379, loss_ss: 1.083003, loss_d: 0.421376
0.1153 --- loss: 1.759547, loss_ss: 1.218561, loss_d: 0.540986
0.1537 --- loss: 1.842335, loss_ss: 1.336847, loss_d: 0.505488
0.1922 --- loss: 1.608647, loss_ss: 1.120542, loss_d: 0.488105
0.2306 --- loss: 1.345258, loss_ss: 0.976404, loss_d: 0.368854
0.2690 --- loss: 1.688865, loss_ss: 0.988618, loss_d: 0.700247
0.3075 --- loss: 1.427434, loss_ss: 1.033030, loss_d: 0.394404
0.3459 --- loss: 1.872437, loss_ss: 1.480499, loss_d: 0.391938
0.3843 --- loss: 1.877861, loss_ss: 1.180121, loss_d: 0.697740
0.4228 --- loss: 2.145318, loss_ss: 1.315753, loss_d: 0.829565
0.4612 --- loss: 1.998003, loss_ss: 1.259102, loss_d: 0.738901
0.4996 --- loss: 1.934198, loss_ss: 1.494204, loss_d: 0.439994
0.5380 --- loss: 2.051802, loss_ss: 1.529066, loss_d: 0.522736
0.5765 --- loss: 1.399006, loss_ss: 1.098354, loss_d: 0.300652
0.6149 --- loss: 1.474056, loss_ss: 1.056977, loss_d: 0.417078
0.6533 --- loss: 1.599275, loss_ss: 1.137181, loss_d: 0.462094
0.6918 --- loss: 1.693830, loss_ss: 1.393226, loss_d: 0.300604
0.7302 --- loss: 1.696701, loss_ss: 1.347498, loss_d: 0.349202
0.7686 --- loss: 1.456546, loss_ss: 1.101017, loss_d: 0.355529
0.8071 --- loss: 1.811048, loss_ss: 0.913643, loss_d: 0.897404
0.8455 --- loss: 1.568136, loss_ss: 1.169265, loss_d: 0.398871
0.8839 --- loss: 1.917750, loss_ss: 1.086469, loss_d: 0.831281
0.9224 --- loss: 1.414577, loss_ss: 0.969269, loss_d: 0.445308
0.9608 --- loss: 1.281033, loss_ss: 0.956990, loss_d: 0.324043
0.9992 --- loss: 3.651475, loss_ss: 1.644076, loss_d: 2.007399
Epoch finished! Loss: 1.7033042348348177
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.902566, loss_ss: 1.594711, loss_d: 0.307855
0.0384 --- loss: 1.638785, loss_ss: 1.034504, loss_d: 0.604280
0.0769 --- loss: 1.423936, loss_ss: 1.036783, loss_d: 0.387153
0.1153 --- loss: 1.624999, loss_ss: 1.261222, loss_d: 0.363777
0.1537 --- loss: 1.895730, loss_ss: 1.304410, loss_d: 0.591320
0.1922 --- loss: 1.590330, loss_ss: 1.225870, loss_d: 0.364460
0.2306 --- loss: 1.956159, loss_ss: 1.022128, loss_d: 0.934031
0.2690 --- loss: 1.431450, loss_ss: 0.987065, loss_d: 0.444385
0.3075 --- loss: 1.284534, loss_ss: 0.904486, loss_d: 0.380048
0.3459 --- loss: 1.725774, loss_ss: 1.386958, loss_d: 0.338816
0.3843 --- loss: 1.418423, loss_ss: 1.137777, loss_d: 0.280646
0.4228 --- loss: 1.569241, loss_ss: 1.213327, loss_d: 0.355914
0.4612 --- loss: 1.811755, loss_ss: 1.377530, loss_d: 0.434225
0.4996 --- loss: 1.447178, loss_ss: 1.115922, loss_d: 0.331256
0.5380 --- loss: 1.204111, loss_ss: 0.919082, loss_d: 0.285028
0.5765 --- loss: 1.630394, loss_ss: 1.157075, loss_d: 0.473319
0.6149 --- loss: 1.773654, loss_ss: 1.250066, loss_d: 0.523588
0.6533 --- loss: 1.849558, loss_ss: 1.368847, loss_d: 0.480711
0.6918 --- loss: 1.284066, loss_ss: 0.856988, loss_d: 0.427077
0.7302 --- loss: 1.399529, loss_ss: 1.005710, loss_d: 0.393819
0.7686 --- loss: 1.761993, loss_ss: 1.267045, loss_d: 0.494948
0.8071 --- loss: 1.548506, loss_ss: 1.198178, loss_d: 0.350328
0.8455 --- loss: 1.631463, loss_ss: 1.236168, loss_d: 0.395295
0.8839 --- loss: 1.678272, loss_ss: 1.212412, loss_d: 0.465861
0.9224 --- loss: 1.335790, loss_ss: 0.888306, loss_d: 0.447484
0.9608 --- loss: 1.404905, loss_ss: 1.090794, loss_d: 0.314111
0.9992 --- loss: 1.651362, loss_ss: 1.235623, loss_d: 0.415738
Epoch finished! Loss: 1.6475562554139358
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.600966, loss_ss: 1.089603, loss_d: 0.511363
0.0384 --- loss: 2.006484, loss_ss: 1.185584, loss_d: 0.820900
0.0769 --- loss: 1.838275, loss_ss: 1.452838, loss_d: 0.385437
0.1153 --- loss: 1.452704, loss_ss: 1.067485, loss_d: 0.385219
0.1537 --- loss: 1.501392, loss_ss: 1.101156, loss_d: 0.400236
0.1922 --- loss: 1.487644, loss_ss: 1.112505, loss_d: 0.375140
0.2306 --- loss: 1.848328, loss_ss: 1.088749, loss_d: 0.759579
0.2690 --- loss: 1.653047, loss_ss: 1.044283, loss_d: 0.608764
0.3075 --- loss: 1.474699, loss_ss: 1.050208, loss_d: 0.424491
0.3459 --- loss: 1.335799, loss_ss: 0.879543, loss_d: 0.456256
0.3843 --- loss: 1.537847, loss_ss: 1.038676, loss_d: 0.499171
0.4228 --- loss: 1.647269, loss_ss: 1.195820, loss_d: 0.451449
0.4612 --- loss: 1.644035, loss_ss: 1.266836, loss_d: 0.377200
0.4996 --- loss: 1.487048, loss_ss: 1.141461, loss_d: 0.345587
0.5380 --- loss: 1.337267, loss_ss: 0.986334, loss_d: 0.350933
0.5765 --- loss: 1.614692, loss_ss: 0.997357, loss_d: 0.617335
0.6149 --- loss: 1.504133, loss_ss: 1.205653, loss_d: 0.298479
0.6533 --- loss: 1.562176, loss_ss: 1.103411, loss_d: 0.458764
0.6918 --- loss: 1.272501, loss_ss: 0.923577, loss_d: 0.348923
0.7302 --- loss: 1.486270, loss_ss: 0.975746, loss_d: 0.510525
0.7686 --- loss: 1.323367, loss_ss: 0.867159, loss_d: 0.456208
0.8071 --- loss: 2.059362, loss_ss: 1.226564, loss_d: 0.832798
0.8455 --- loss: 1.620017, loss_ss: 1.194084, loss_d: 0.425933
0.8839 --- loss: 1.872639, loss_ss: 1.216583, loss_d: 0.656057
0.9224 --- loss: 1.612196, loss_ss: 1.275395, loss_d: 0.336801
0.9608 --- loss: 1.531556, loss_ss: 1.056867, loss_d: 0.474689
0.9992 --- loss: 2.266392, loss_ss: 1.928508, loss_d: 0.337884
Epoch finished! Loss: 1.6222992158853091
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.822821, loss_ss: 1.551853, loss_d: 0.270968
0.0384 --- loss: 1.666890, loss_ss: 1.149261, loss_d: 0.517629
0.0769 --- loss: 1.588992, loss_ss: 1.159427, loss_d: 0.429565
0.1153 --- loss: 1.328028, loss_ss: 0.882616, loss_d: 0.445412
0.1537 --- loss: 1.310981, loss_ss: 0.928152, loss_d: 0.382829
0.1922 --- loss: 1.616803, loss_ss: 1.030583, loss_d: 0.586220
0.2306 --- loss: 1.423403, loss_ss: 1.048421, loss_d: 0.374982
0.2690 --- loss: 1.509999, loss_ss: 1.123004, loss_d: 0.386994
0.3075 --- loss: 1.798375, loss_ss: 1.196679, loss_d: 0.601695
0.3459 --- loss: 1.816423, loss_ss: 1.087334, loss_d: 0.729089
0.3843 --- loss: 1.449156, loss_ss: 1.083500, loss_d: 0.365656
0.4228 --- loss: 1.671051, loss_ss: 0.981452, loss_d: 0.689599
0.4612 --- loss: 1.451397, loss_ss: 1.118252, loss_d: 0.333146
0.4996 --- loss: 1.397836, loss_ss: 0.860572, loss_d: 0.537265
0.5380 --- loss: 1.751595, loss_ss: 1.061444, loss_d: 0.690151
0.5765 --- loss: 2.047246, loss_ss: 1.124070, loss_d: 0.923176
0.6149 --- loss: 1.646226, loss_ss: 1.099386, loss_d: 0.546840
0.6533 --- loss: 1.921457, loss_ss: 1.256252, loss_d: 0.665205
0.6918 --- loss: 1.515645, loss_ss: 1.095911, loss_d: 0.419734
0.7302 --- loss: 1.764427, loss_ss: 1.349834, loss_d: 0.414592
0.7686 --- loss: 1.375410, loss_ss: 0.989812, loss_d: 0.385598
0.8071 --- loss: 1.461465, loss_ss: 1.060148, loss_d: 0.401318
0.8455 --- loss: 1.664242, loss_ss: 1.317186, loss_d: 0.347056
0.8839 --- loss: 1.093096, loss_ss: 0.826582, loss_d: 0.266514
0.9224 --- loss: 1.551999, loss_ss: 0.910957, loss_d: 0.641041
0.9608 --- loss: 1.604702, loss_ss: 1.221669, loss_d: 0.383032
0.9992 --- loss: 1.488816, loss_ss: 1.098990, loss_d: 0.389826
Epoch finished! Loss: 1.5919516618435199
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.400158, loss_ss: 0.979024, loss_d: 0.421135
0.0384 --- loss: 1.724315, loss_ss: 1.093809, loss_d: 0.630506
0.0769 --- loss: 1.185617, loss_ss: 0.881164, loss_d: 0.304454
0.1153 --- loss: 1.257759, loss_ss: 0.863318, loss_d: 0.394441
0.1537 --- loss: 1.263346, loss_ss: 0.811391, loss_d: 0.451955
0.1922 --- loss: 1.359865, loss_ss: 0.935244, loss_d: 0.424621
0.2306 --- loss: 2.098367, loss_ss: 1.358731, loss_d: 0.739636
0.2690 --- loss: 1.695272, loss_ss: 1.027952, loss_d: 0.667320
0.3075 --- loss: 1.692617, loss_ss: 1.084711, loss_d: 0.607906
0.3459 --- loss: 1.423421, loss_ss: 1.072641, loss_d: 0.350781
0.3843 --- loss: 1.496988, loss_ss: 1.028205, loss_d: 0.468783
0.4228 --- loss: 1.596208, loss_ss: 1.095016, loss_d: 0.501192
0.4612 --- loss: 1.491494, loss_ss: 1.080034, loss_d: 0.411460
0.4996 --- loss: 1.960334, loss_ss: 1.043680, loss_d: 0.916654
0.5380 --- loss: 1.962548, loss_ss: 0.967860, loss_d: 0.994689
0.5765 --- loss: 1.276890, loss_ss: 0.917544, loss_d: 0.359346
0.6149 --- loss: 1.505694, loss_ss: 0.885959, loss_d: 0.619735
0.6533 --- loss: 1.348215, loss_ss: 1.106325, loss_d: 0.241890
0.6918 --- loss: 2.094165, loss_ss: 1.303315, loss_d: 0.790850
0.7302 --- loss: 1.635915, loss_ss: 0.860330, loss_d: 0.775585
0.7686 --- loss: 1.375793, loss_ss: 1.003119, loss_d: 0.372674
0.8071 --- loss: 2.037405, loss_ss: 1.786091, loss_d: 0.251314
0.8455 --- loss: 2.046002, loss_ss: 1.500617, loss_d: 0.545386
0.8839 --- loss: 1.511677, loss_ss: 1.258585, loss_d: 0.253092
0.9224 --- loss: 1.697724, loss_ss: 1.054990, loss_d: 0.642734
0.9608 --- loss: 2.137592, loss_ss: 1.702765, loss_d: 0.434827
0.9992 --- loss: 1.317882, loss_ss: 1.010881, loss_d: 0.307001
Epoch finished! Loss: 1.5683820949150966
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.802924, loss_ss: 1.254092, loss_d: 0.548832
0.0384 --- loss: 2.122561, loss_ss: 1.083524, loss_d: 1.039037
0.0769 --- loss: 1.574340, loss_ss: 1.281398, loss_d: 0.292941
0.1153 --- loss: 1.480761, loss_ss: 1.128571, loss_d: 0.352190
0.1537 --- loss: 1.541783, loss_ss: 1.102753, loss_d: 0.439030
0.1922 --- loss: 1.517453, loss_ss: 1.153261, loss_d: 0.364192
0.2306 --- loss: 1.529119, loss_ss: 0.918990, loss_d: 0.610129
0.2690 --- loss: 1.642328, loss_ss: 0.845338, loss_d: 0.796990
0.3075 --- loss: 1.706507, loss_ss: 1.182827, loss_d: 0.523680
0.3459 --- loss: 1.628698, loss_ss: 1.277842, loss_d: 0.350857
0.3843 --- loss: 1.673613, loss_ss: 1.226758, loss_d: 0.446855
0.4228 --- loss: 1.262943, loss_ss: 0.946448, loss_d: 0.316495
0.4612 --- loss: 1.363480, loss_ss: 1.010614, loss_d: 0.352867
0.4996 --- loss: 1.525691, loss_ss: 1.142035, loss_d: 0.383656
0.5380 --- loss: 1.340599, loss_ss: 1.041306, loss_d: 0.299293
0.5765 --- loss: 1.345538, loss_ss: 1.068311, loss_d: 0.277228
0.6149 --- loss: 1.826323, loss_ss: 1.235685, loss_d: 0.590638
0.6533 --- loss: 1.529813, loss_ss: 0.988660, loss_d: 0.541153
0.6918 --- loss: 1.560980, loss_ss: 1.149905, loss_d: 0.411074
0.7302 --- loss: 1.506801, loss_ss: 1.173869, loss_d: 0.332932
0.7686 --- loss: 1.434050, loss_ss: 1.076480, loss_d: 0.357570
0.8071 --- loss: 1.603006, loss_ss: 1.034917, loss_d: 0.568090
0.8455 --- loss: 2.014725, loss_ss: 1.504486, loss_d: 0.510238
0.8839 --- loss: 1.516248, loss_ss: 0.909889, loss_d: 0.606359
0.9224 --- loss: 1.240384, loss_ss: 0.948288, loss_d: 0.292096
0.9608 --- loss: 1.475537, loss_ss: 1.115203, loss_d: 0.360335
0.9992 --- loss: 2.403819, loss_ss: 2.055958, loss_d: 0.347861
Epoch finished! Loss: 1.5632926381551302
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.1925925925925926
             precision    recall  f1-score   support

        0.0       0.12      0.94      0.22       108
        1.0       0.00      0.00      0.00       387
        2.0       0.75      0.01      0.02       360
        3.0       0.98      0.94      0.96        95
        4.0       0.09      0.12      0.10       130

avg / total       0.36      0.19      0.12      1080
 


====== chp049-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  32.31  93.52   25.51  12.24     21.65
1  64.17   0.00  100.00   0.00      0.00
2  66.85   0.83   99.86  75.00      1.65
3  99.26  93.68   99.80  97.80     95.70
4  75.93  11.54   84.74   9.38     10.34
Total accuracy: 19.26%
Average sen: 39.91%
Average spec: 81.98%
Macro f1-score: 25.87%
[0.9542836  0.9069348  0.84441084 0.7909677  0.88736016 0.85135591
 0.94186872 0.85283214 0.86036617 0.86118954 0.9139502  0.95813918
 0.82104468 0.70734286 0.74095714 0.73185295 0.84894037 0.86562508
 0.97205734 0.91678834 0.87891996 0.86718827 0.89526206 0.94118237
 0.89186144 0.79013133 0.76263207 0.9053663  0.86486381 0.88363642
 0.88606465 0.93003029 0.96538448 0.8600899  0.87956613 0.94457501]
pred: 0.871528395348125, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.635828, loss_ss: 1.873649, loss_d: 0.762179
0.0384 --- loss: 2.372472, loss_ss: 1.601242, loss_d: 0.771229
0.0769 --- loss: 2.166278, loss_ss: 1.591425, loss_d: 0.574853
0.1153 --- loss: 2.263319, loss_ss: 1.582838, loss_d: 0.680481
0.1537 --- loss: 2.426675, loss_ss: 1.490703, loss_d: 0.935972
0.1922 --- loss: 2.019310, loss_ss: 1.516734, loss_d: 0.502577
0.2306 --- loss: 2.032483, loss_ss: 1.658010, loss_d: 0.374472
0.2690 --- loss: 2.050756, loss_ss: 1.582919, loss_d: 0.467837
0.3075 --- loss: 2.022292, loss_ss: 1.566469, loss_d: 0.455822
0.3459 --- loss: 2.016735, loss_ss: 1.472728, loss_d: 0.544007
0.3843 --- loss: 2.621823, loss_ss: 1.760482, loss_d: 0.861341
0.4228 --- loss: 2.083778, loss_ss: 1.537684, loss_d: 0.546094
0.4612 --- loss: 2.199588, loss_ss: 1.777020, loss_d: 0.422568
0.4996 --- loss: 1.608232, loss_ss: 1.363309, loss_d: 0.244923
0.5380 --- loss: 2.221051, loss_ss: 1.772564, loss_d: 0.448487
0.5765 --- loss: 2.338084, loss_ss: 1.525383, loss_d: 0.812701
0.6149 --- loss: 1.888351, loss_ss: 1.428298, loss_d: 0.460053
0.6533 --- loss: 1.879160, loss_ss: 1.442554, loss_d: 0.436606
0.6918 --- loss: 2.005607, loss_ss: 1.462952, loss_d: 0.542656
0.7302 --- loss: 1.819889, loss_ss: 1.381583, loss_d: 0.438306
0.7686 --- loss: 2.653480, loss_ss: 1.374482, loss_d: 1.278998
0.8071 --- loss: 1.972581, loss_ss: 1.430651, loss_d: 0.541931
0.8455 --- loss: 2.079835, loss_ss: 1.534460, loss_d: 0.545375
0.8839 --- loss: 1.784007, loss_ss: 1.399682, loss_d: 0.384325
0.9224 --- loss: 1.930878, loss_ss: 1.381719, loss_d: 0.549158
0.9608 --- loss: 2.313479, loss_ss: 1.663619, loss_d: 0.649860
0.9992 --- loss: 2.143015, loss_ss: 1.563470, loss_d: 0.579545
Epoch finished! Loss: 2.112337424663397
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.063157, loss_ss: 1.442261, loss_d: 0.620896
0.0384 --- loss: 1.987280, loss_ss: 1.560539, loss_d: 0.426741
0.0769 --- loss: 2.205205, loss_ss: 1.695843, loss_d: 0.509362
0.1153 --- loss: 2.061121, loss_ss: 1.633525, loss_d: 0.427596
0.1537 --- loss: 1.841637, loss_ss: 1.393965, loss_d: 0.447672
0.1922 --- loss: 2.029905, loss_ss: 1.567197, loss_d: 0.462708
0.2306 --- loss: 1.916395, loss_ss: 1.413809, loss_d: 0.502586
0.2690 --- loss: 1.853688, loss_ss: 1.398354, loss_d: 0.455334
0.3075 --- loss: 2.092605, loss_ss: 1.495049, loss_d: 0.597556
0.3459 --- loss: 1.840953, loss_ss: 1.322488, loss_d: 0.518465
0.3843 --- loss: 1.940030, loss_ss: 1.436629, loss_d: 0.503401
0.4228 --- loss: 2.142033, loss_ss: 1.474312, loss_d: 0.667721
0.4612 --- loss: 1.802706, loss_ss: 1.213757, loss_d: 0.588949
0.4996 --- loss: 1.944991, loss_ss: 1.375224, loss_d: 0.569767
0.5380 --- loss: 1.795980, loss_ss: 1.261154, loss_d: 0.534826
0.5765 --- loss: 1.938366, loss_ss: 1.355892, loss_d: 0.582474
0.6149 --- loss: 1.780464, loss_ss: 1.229829, loss_d: 0.550635
0.6533 --- loss: 1.942020, loss_ss: 1.476002, loss_d: 0.466018
0.6918 --- loss: 2.073457, loss_ss: 1.373278, loss_d: 0.700178
0.7302 --- loss: 1.940456, loss_ss: 1.384779, loss_d: 0.555676
0.7686 --- loss: 1.843130, loss_ss: 1.219736, loss_d: 0.623394
0.8071 --- loss: 1.695587, loss_ss: 1.306547, loss_d: 0.389040
0.8455 --- loss: 1.817644, loss_ss: 1.187593, loss_d: 0.630051
0.8839 --- loss: 2.041866, loss_ss: 1.612189, loss_d: 0.429677
0.9224 --- loss: 1.888930, loss_ss: 1.396449, loss_d: 0.492481
0.9608 --- loss: 1.746020, loss_ss: 1.309925, loss_d: 0.436095
0.9992 --- loss: 3.162609, loss_ss: 1.340747, loss_d: 1.821863
Epoch finished! Loss: 1.9434103924494524
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.944807, loss_ss: 1.501418, loss_d: 0.443389
0.0384 --- loss: 1.815206, loss_ss: 1.348196, loss_d: 0.467010
0.0769 --- loss: 1.585087, loss_ss: 1.229451, loss_d: 0.355637
0.1153 --- loss: 2.032279, loss_ss: 1.371851, loss_d: 0.660428
0.1537 --- loss: 1.917283, loss_ss: 1.348607, loss_d: 0.568676
0.1922 --- loss: 1.832609, loss_ss: 1.386664, loss_d: 0.445945
0.2306 --- loss: 2.577512, loss_ss: 1.489213, loss_d: 1.088299
0.2690 --- loss: 1.861442, loss_ss: 1.438825, loss_d: 0.422616
0.3075 --- loss: 1.833493, loss_ss: 1.421445, loss_d: 0.412049
0.3459 --- loss: 1.646391, loss_ss: 1.295163, loss_d: 0.351228
0.3843 --- loss: 1.757639, loss_ss: 1.253502, loss_d: 0.504137
0.4228 --- loss: 1.681023, loss_ss: 1.354024, loss_d: 0.326999
0.4612 --- loss: 1.845129, loss_ss: 1.454037, loss_d: 0.391093
0.4996 --- loss: 1.775187, loss_ss: 1.414311, loss_d: 0.360876
0.5380 --- loss: 1.672818, loss_ss: 1.271564, loss_d: 0.401255
0.5765 --- loss: 1.913952, loss_ss: 1.380364, loss_d: 0.533588
0.6149 --- loss: 2.107282, loss_ss: 1.446436, loss_d: 0.660846
0.6533 --- loss: 1.640651, loss_ss: 1.171974, loss_d: 0.468677
0.6918 --- loss: 2.011438, loss_ss: 1.417290, loss_d: 0.594149
0.7302 --- loss: 1.963685, loss_ss: 1.414420, loss_d: 0.549265
0.7686 --- loss: 1.698070, loss_ss: 1.414824, loss_d: 0.283246
0.8071 --- loss: 2.025847, loss_ss: 1.300946, loss_d: 0.724901
0.8455 --- loss: 1.800148, loss_ss: 1.429558, loss_d: 0.370590
0.8839 --- loss: 1.924472, loss_ss: 1.594527, loss_d: 0.329945
0.9224 --- loss: 1.577357, loss_ss: 1.005824, loss_d: 0.571533
0.9608 --- loss: 1.715162, loss_ss: 1.191359, loss_d: 0.523803
0.9992 --- loss: 1.443420, loss_ss: 1.008055, loss_d: 0.435365
Epoch finished! Loss: 1.8165781887677999
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.724335, loss_ss: 1.252202, loss_d: 0.472133
0.0384 --- loss: 1.568293, loss_ss: 1.083956, loss_d: 0.484337
0.0769 --- loss: 1.595756, loss_ss: 1.254541, loss_d: 0.341214
0.1153 --- loss: 1.960737, loss_ss: 1.201854, loss_d: 0.758883
0.1537 --- loss: 1.493611, loss_ss: 1.151747, loss_d: 0.341863
0.1922 --- loss: 1.554518, loss_ss: 1.267915, loss_d: 0.286604
0.2306 --- loss: 1.719580, loss_ss: 1.340833, loss_d: 0.378746
0.2690 --- loss: 1.697655, loss_ss: 1.044482, loss_d: 0.653173
0.3075 --- loss: 1.629547, loss_ss: 1.082271, loss_d: 0.547276
0.3459 --- loss: 1.745513, loss_ss: 1.187191, loss_d: 0.558322
0.3843 --- loss: 1.571961, loss_ss: 1.293913, loss_d: 0.278048
0.4228 --- loss: 2.082006, loss_ss: 1.453041, loss_d: 0.628965
0.4612 --- loss: 1.963326, loss_ss: 1.453251, loss_d: 0.510076
0.4996 --- loss: 1.477252, loss_ss: 1.112393, loss_d: 0.364858
0.5380 --- loss: 1.760516, loss_ss: 1.113598, loss_d: 0.646918
0.5765 --- loss: 1.613878, loss_ss: 1.267313, loss_d: 0.346565
0.6149 --- loss: 2.429215, loss_ss: 1.317896, loss_d: 1.111319
0.6533 --- loss: 1.475111, loss_ss: 1.131536, loss_d: 0.343575
0.6918 --- loss: 1.566458, loss_ss: 1.165830, loss_d: 0.400628
0.7302 --- loss: 1.643746, loss_ss: 1.081188, loss_d: 0.562558
0.7686 --- loss: 1.868187, loss_ss: 1.062244, loss_d: 0.805942
0.8071 --- loss: 1.433503, loss_ss: 1.114838, loss_d: 0.318665
0.8455 --- loss: 1.731326, loss_ss: 1.329312, loss_d: 0.402015
0.8839 --- loss: 1.707749, loss_ss: 1.342363, loss_d: 0.365386
0.9224 --- loss: 1.378015, loss_ss: 0.923850, loss_d: 0.454165
0.9608 --- loss: 1.926757, loss_ss: 1.111699, loss_d: 0.815057
0.9992 --- loss: 1.745102, loss_ss: 1.360406, loss_d: 0.384696
Epoch finished! Loss: 1.6920058108293092
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.332918, loss_ss: 0.956586, loss_d: 0.376332
0.0384 --- loss: 1.485317, loss_ss: 1.051705, loss_d: 0.433611
0.0769 --- loss: 1.516683, loss_ss: 1.203290, loss_d: 0.313394
0.1153 --- loss: 1.713032, loss_ss: 1.317028, loss_d: 0.396004
0.1537 --- loss: 1.628685, loss_ss: 1.295224, loss_d: 0.333461
0.1922 --- loss: 1.510993, loss_ss: 1.145972, loss_d: 0.365021
0.2306 --- loss: 1.497589, loss_ss: 0.916871, loss_d: 0.580718
0.2690 --- loss: 1.557475, loss_ss: 0.985632, loss_d: 0.571842
0.3075 --- loss: 1.355480, loss_ss: 0.892921, loss_d: 0.462559
0.3459 --- loss: 1.931077, loss_ss: 1.474474, loss_d: 0.456604
0.3843 --- loss: 1.722333, loss_ss: 1.316448, loss_d: 0.405885
0.4228 --- loss: 1.743209, loss_ss: 1.260906, loss_d: 0.482303
0.4612 --- loss: 1.505244, loss_ss: 1.110849, loss_d: 0.394396
0.4996 --- loss: 1.451553, loss_ss: 1.040864, loss_d: 0.410690
0.5380 --- loss: 1.477682, loss_ss: 0.998863, loss_d: 0.478819
0.5765 --- loss: 1.610750, loss_ss: 1.052540, loss_d: 0.558211
0.6149 --- loss: 2.200896, loss_ss: 1.100093, loss_d: 1.100803
0.6533 --- loss: 1.786251, loss_ss: 1.076471, loss_d: 0.709780
0.6918 --- loss: 1.933151, loss_ss: 1.400280, loss_d: 0.532871
0.7302 --- loss: 1.207666, loss_ss: 0.932087, loss_d: 0.275579
0.7686 --- loss: 1.861253, loss_ss: 1.179830, loss_d: 0.681423
0.8071 --- loss: 1.576242, loss_ss: 1.076439, loss_d: 0.499803
0.8455 --- loss: 1.493440, loss_ss: 1.188571, loss_d: 0.304869
0.8839 --- loss: 1.460063, loss_ss: 0.959435, loss_d: 0.500627
0.9224 --- loss: 1.425105, loss_ss: 1.129049, loss_d: 0.296056
0.9608 --- loss: 1.408630, loss_ss: 1.030972, loss_d: 0.377658
0.9992 --- loss: 1.711738, loss_ss: 1.225262, loss_d: 0.486475
Epoch finished! Loss: 1.6334679168004256
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.446464, loss_ss: 1.082667, loss_d: 0.363797
0.0384 --- loss: 1.554337, loss_ss: 1.061360, loss_d: 0.492977
0.0769 --- loss: 1.533652, loss_ss: 1.128278, loss_d: 0.405374
0.1153 --- loss: 1.515644, loss_ss: 1.073615, loss_d: 0.442029
0.1537 --- loss: 1.523824, loss_ss: 1.010413, loss_d: 0.513411
0.1922 --- loss: 1.500715, loss_ss: 1.169451, loss_d: 0.331264
0.2306 --- loss: 1.437371, loss_ss: 1.162067, loss_d: 0.275304
0.2690 --- loss: 1.547452, loss_ss: 1.063625, loss_d: 0.483828
0.3075 --- loss: 1.597384, loss_ss: 1.153968, loss_d: 0.443416
0.3459 --- loss: 1.561386, loss_ss: 1.101297, loss_d: 0.460089
0.3843 --- loss: 2.175644, loss_ss: 1.012297, loss_d: 1.163347
0.4228 --- loss: 1.325851, loss_ss: 1.032184, loss_d: 0.293667
0.4612 --- loss: 1.320115, loss_ss: 0.821235, loss_d: 0.498879
0.4996 --- loss: 1.636710, loss_ss: 1.310516, loss_d: 0.326194
0.5380 --- loss: 1.580599, loss_ss: 1.319060, loss_d: 0.261539
0.5765 --- loss: 1.766236, loss_ss: 1.392568, loss_d: 0.373668
0.6149 --- loss: 1.090756, loss_ss: 0.779986, loss_d: 0.310770
0.6533 --- loss: 1.691526, loss_ss: 1.111432, loss_d: 0.580094
0.6918 --- loss: 1.892465, loss_ss: 1.500502, loss_d: 0.391964
0.7302 --- loss: 1.422395, loss_ss: 1.031610, loss_d: 0.390785
0.7686 --- loss: 1.777178, loss_ss: 1.210550, loss_d: 0.566628
0.8071 --- loss: 1.325728, loss_ss: 1.045018, loss_d: 0.280710
0.8455 --- loss: 1.511042, loss_ss: 1.160048, loss_d: 0.350994
0.8839 --- loss: 1.684026, loss_ss: 1.128791, loss_d: 0.555235
0.9224 --- loss: 1.725111, loss_ss: 1.401930, loss_d: 0.323181
0.9608 --- loss: 1.618508, loss_ss: 1.262042, loss_d: 0.356467
0.9992 --- loss: 2.255148, loss_ss: 1.990685, loss_d: 0.264464
Epoch finished! Loss: 1.578725854250101
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.597382, loss_ss: 1.344267, loss_d: 0.253115
0.0384 --- loss: 1.697396, loss_ss: 1.245451, loss_d: 0.451945
0.0769 --- loss: 2.076625, loss_ss: 1.373892, loss_d: 0.702733
0.1153 --- loss: 1.371645, loss_ss: 0.944560, loss_d: 0.427085
0.1537 --- loss: 1.333420, loss_ss: 0.919293, loss_d: 0.414127
0.1922 --- loss: 1.527396, loss_ss: 1.209822, loss_d: 0.317574
0.2306 --- loss: 1.674069, loss_ss: 0.994927, loss_d: 0.679141
0.2690 --- loss: 1.498578, loss_ss: 1.017306, loss_d: 0.481272
0.3075 --- loss: 1.496613, loss_ss: 1.029373, loss_d: 0.467240
0.3459 --- loss: 1.466256, loss_ss: 0.932414, loss_d: 0.533842
0.3843 --- loss: 1.382722, loss_ss: 1.039591, loss_d: 0.343130
0.4228 --- loss: 1.330381, loss_ss: 1.040397, loss_d: 0.289984
0.4612 --- loss: 1.470676, loss_ss: 1.117520, loss_d: 0.353156
0.4996 --- loss: 1.677189, loss_ss: 1.193814, loss_d: 0.483375
0.5380 --- loss: 1.550338, loss_ss: 1.303714, loss_d: 0.246624
0.5765 --- loss: 1.825420, loss_ss: 1.110043, loss_d: 0.715377
0.6149 --- loss: 1.452919, loss_ss: 1.067131, loss_d: 0.385788
0.6533 --- loss: 1.926677, loss_ss: 1.292499, loss_d: 0.634178
0.6918 --- loss: 1.588566, loss_ss: 1.096180, loss_d: 0.492386
0.7302 --- loss: 2.174821, loss_ss: 0.973805, loss_d: 1.201015
0.7686 --- loss: 1.541030, loss_ss: 0.981283, loss_d: 0.559747
0.8071 --- loss: 1.419513, loss_ss: 0.914852, loss_d: 0.504662
0.8455 --- loss: 1.941706, loss_ss: 1.197845, loss_d: 0.743860
0.8839 --- loss: 1.525021, loss_ss: 1.045110, loss_d: 0.479912
0.9224 --- loss: 1.626015, loss_ss: 0.940872, loss_d: 0.685143
0.9608 --- loss: 1.466391, loss_ss: 0.970416, loss_d: 0.495975
0.9992 --- loss: 1.405973, loss_ss: 1.062356, loss_d: 0.343618
Epoch finished! Loss: 1.5639266367142017
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.535662, loss_ss: 1.047411, loss_d: 0.488250
0.0384 --- loss: 1.108714, loss_ss: 0.866837, loss_d: 0.241877
0.0769 --- loss: 1.383495, loss_ss: 0.811892, loss_d: 0.571602
0.1153 --- loss: 1.808336, loss_ss: 1.532991, loss_d: 0.275345
0.1537 --- loss: 1.333793, loss_ss: 1.073935, loss_d: 0.259858
0.1922 --- loss: 1.531049, loss_ss: 0.768894, loss_d: 0.762156
0.2306 --- loss: 1.058943, loss_ss: 0.850851, loss_d: 0.208091
0.2690 --- loss: 1.273941, loss_ss: 0.967217, loss_d: 0.306724
0.3075 --- loss: 1.313331, loss_ss: 0.936305, loss_d: 0.377026
0.3459 --- loss: 1.213550, loss_ss: 0.796577, loss_d: 0.416973
0.3843 --- loss: 1.302606, loss_ss: 1.030700, loss_d: 0.271906
0.4228 --- loss: 1.275401, loss_ss: 0.867560, loss_d: 0.407840
0.4612 --- loss: 1.261779, loss_ss: 0.925248, loss_d: 0.336530
0.4996 --- loss: 1.443061, loss_ss: 1.070839, loss_d: 0.372222
0.5380 --- loss: 1.835081, loss_ss: 1.222924, loss_d: 0.612157
0.5765 --- loss: 1.588105, loss_ss: 1.015477, loss_d: 0.572629
0.6149 --- loss: 2.012719, loss_ss: 1.409183, loss_d: 0.603536
0.6533 --- loss: 1.314580, loss_ss: 0.906025, loss_d: 0.408555
0.6918 --- loss: 1.695233, loss_ss: 1.142998, loss_d: 0.552234
0.7302 --- loss: 1.261000, loss_ss: 0.852028, loss_d: 0.408972
0.7686 --- loss: 1.429275, loss_ss: 1.116147, loss_d: 0.313128
0.8071 --- loss: 1.402487, loss_ss: 1.160407, loss_d: 0.242080
0.8455 --- loss: 1.337598, loss_ss: 0.893837, loss_d: 0.443761
0.8839 --- loss: 1.608582, loss_ss: 1.101557, loss_d: 0.507025
0.9224 --- loss: 1.265972, loss_ss: 0.980588, loss_d: 0.285384
0.9608 --- loss: 1.085517, loss_ss: 0.824105, loss_d: 0.261412
0.9992 --- loss: 3.182649, loss_ss: 1.171702, loss_d: 2.010947
Epoch finished! Loss: 1.535613148029034
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.156590, loss_ss: 0.935784, loss_d: 0.220806
0.0384 --- loss: 1.928495, loss_ss: 1.291563, loss_d: 0.636932
0.0769 --- loss: 1.436878, loss_ss: 1.016548, loss_d: 0.420330
0.1153 --- loss: 1.384236, loss_ss: 1.006439, loss_d: 0.377797
0.1537 --- loss: 1.622943, loss_ss: 0.986235, loss_d: 0.636709
0.1922 --- loss: 1.201729, loss_ss: 0.843697, loss_d: 0.358032
0.2306 --- loss: 1.489047, loss_ss: 1.121421, loss_d: 0.367627
0.2690 --- loss: 1.394853, loss_ss: 1.103524, loss_d: 0.291328
0.3075 --- loss: 1.480437, loss_ss: 1.198803, loss_d: 0.281634
0.3459 --- loss: 1.465728, loss_ss: 1.041296, loss_d: 0.424432
0.3843 --- loss: 1.499548, loss_ss: 1.126143, loss_d: 0.373405
0.4228 --- loss: 1.574892, loss_ss: 1.189822, loss_d: 0.385070
0.4612 --- loss: 1.518335, loss_ss: 1.053996, loss_d: 0.464339
0.4996 --- loss: 1.143196, loss_ss: 0.822774, loss_d: 0.320423
0.5380 --- loss: 1.852959, loss_ss: 1.138225, loss_d: 0.714734
0.5765 --- loss: 1.612468, loss_ss: 1.258953, loss_d: 0.353516
0.6149 --- loss: 1.823379, loss_ss: 1.207140, loss_d: 0.616238
0.6533 --- loss: 1.204315, loss_ss: 0.988191, loss_d: 0.216124
0.6918 --- loss: 1.643455, loss_ss: 1.030760, loss_d: 0.612694
0.7302 --- loss: 2.095173, loss_ss: 1.470559, loss_d: 0.624614
0.7686 --- loss: 1.279331, loss_ss: 0.874363, loss_d: 0.404969
0.8071 --- loss: 1.345279, loss_ss: 0.974531, loss_d: 0.370748
0.8455 --- loss: 1.696881, loss_ss: 1.265998, loss_d: 0.430882
0.8839 --- loss: 1.786096, loss_ss: 1.143237, loss_d: 0.642859
0.9224 --- loss: 2.020924, loss_ss: 1.212043, loss_d: 0.808881
0.9608 --- loss: 1.876409, loss_ss: 1.317269, loss_d: 0.559139
0.9992 --- loss: 2.411956, loss_ss: 2.229349, loss_d: 0.182607
Epoch finished! Loss: 1.5408110531476829
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.439914, loss_ss: 1.099212, loss_d: 0.340702
0.0384 --- loss: 1.574893, loss_ss: 1.224645, loss_d: 0.350248
0.0769 --- loss: 1.259838, loss_ss: 0.839600, loss_d: 0.420238
0.1153 --- loss: 1.011996, loss_ss: 0.805965, loss_d: 0.206031
0.1537 --- loss: 1.529882, loss_ss: 1.080283, loss_d: 0.449599
0.1922 --- loss: 2.099623, loss_ss: 1.327855, loss_d: 0.771769
0.2306 --- loss: 1.640436, loss_ss: 0.960255, loss_d: 0.680181
0.2690 --- loss: 1.661424, loss_ss: 0.930424, loss_d: 0.731000
0.3075 --- loss: 1.478242, loss_ss: 1.210367, loss_d: 0.267875
0.3459 --- loss: 1.513376, loss_ss: 0.912215, loss_d: 0.601161
0.3843 --- loss: 1.090626, loss_ss: 0.737223, loss_d: 0.353403
0.4228 --- loss: 1.336821, loss_ss: 0.997612, loss_d: 0.339208
0.4612 --- loss: 1.476200, loss_ss: 1.037469, loss_d: 0.438731
0.4996 --- loss: 1.396166, loss_ss: 1.037651, loss_d: 0.358515
0.5380 --- loss: 1.064659, loss_ss: 0.806484, loss_d: 0.258175
0.5765 --- loss: 1.534549, loss_ss: 0.922721, loss_d: 0.611828
0.6149 --- loss: 1.959015, loss_ss: 1.084143, loss_d: 0.874872
0.6533 --- loss: 1.636497, loss_ss: 1.260234, loss_d: 0.376264
0.6918 --- loss: 1.596583, loss_ss: 1.121194, loss_d: 0.475389
0.7302 --- loss: 1.579209, loss_ss: 1.074914, loss_d: 0.504295
0.7686 --- loss: 1.754548, loss_ss: 1.249737, loss_d: 0.504811
0.8071 --- loss: 1.869917, loss_ss: 1.159153, loss_d: 0.710764
0.8455 --- loss: 1.362020, loss_ss: 1.034176, loss_d: 0.327844
0.8839 --- loss: 1.426046, loss_ss: 1.098881, loss_d: 0.327164
0.9224 --- loss: 1.677577, loss_ss: 0.952811, loss_d: 0.724766
0.9608 --- loss: 1.158987, loss_ss: 0.823725, loss_d: 0.335262
0.9992 --- loss: 2.376746, loss_ss: 1.988775, loss_d: 0.387971
Epoch finished! Loss: 1.4986189181988057
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.39166666666666666
             precision    recall  f1-score   support

        0.0       0.10      0.53      0.17        30
        1.0       0.00      0.00      0.00       136
        2.0       0.00      0.00      0.00       404
        3.0       1.00      0.58      0.74       239
        4.0       0.34      0.99      0.51       271

avg / total       0.31      0.39      0.30      1080
 


====== chp051-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  85.09  53.33   86.00    9.82     16.58
1  87.41   0.00  100.00    0.00      0.00
2  62.59   0.00  100.00    0.00      0.00
3  90.74  58.16  100.00  100.00     73.54
4  52.50  98.89   36.96   34.45     51.10
Total accuracy: 39.17%
Average sen: 42.08%
Average spec: 84.59%
Macro f1-score: 28.24%
[0.98483592 0.99013561 0.99345773 0.98270696 0.98764032 0.99866867
 0.99701285 0.99672556 0.99858272 0.98501968 0.99314088 0.99086225
 0.98497355 0.98300248 0.99384969 0.99319321 0.9939819  0.98632324
 0.99295992 0.99751747 0.99856228 0.99800593 0.98380107 0.98931152
 0.99202394 0.99778581 0.99788541 0.99876714 0.99884135 0.99755365
 0.99411881 0.98956174 0.9835881  0.98592651 0.98593253 0.9901461 ]
pred: 0.9918445133500629, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.407403, loss_ss: 1.734847, loss_d: 0.672555
0.0384 --- loss: 2.601080, loss_ss: 1.672023, loss_d: 0.929057
0.0768 --- loss: 2.088637, loss_ss: 1.513497, loss_d: 0.575140
0.1152 --- loss: 1.968854, loss_ss: 1.495696, loss_d: 0.473158
0.1536 --- loss: 2.029361, loss_ss: 1.505910, loss_d: 0.523451
0.1919 --- loss: 2.194046, loss_ss: 1.500426, loss_d: 0.693621
0.2303 --- loss: 1.834734, loss_ss: 1.417826, loss_d: 0.416908
0.2687 --- loss: 2.068633, loss_ss: 1.420709, loss_d: 0.647923
0.3071 --- loss: 2.067710, loss_ss: 1.555230, loss_d: 0.512480
0.3455 --- loss: 1.816875, loss_ss: 1.404127, loss_d: 0.412748
0.3839 --- loss: 1.927160, loss_ss: 1.510633, loss_d: 0.416527
0.4223 --- loss: 1.928181, loss_ss: 1.602964, loss_d: 0.325217
0.4607 --- loss: 1.931073, loss_ss: 1.563057, loss_d: 0.368016
0.4990 --- loss: 2.044854, loss_ss: 1.539897, loss_d: 0.504958
0.5374 --- loss: 1.969386, loss_ss: 1.509772, loss_d: 0.459614
0.5758 --- loss: 2.138413, loss_ss: 1.642197, loss_d: 0.496216
0.6142 --- loss: 1.847723, loss_ss: 1.388422, loss_d: 0.459302
0.6526 --- loss: 1.749763, loss_ss: 1.388658, loss_d: 0.361105
0.6910 --- loss: 1.869602, loss_ss: 1.382535, loss_d: 0.487066
0.7294 --- loss: 2.181951, loss_ss: 1.476567, loss_d: 0.705384
0.7678 --- loss: 2.033781, loss_ss: 1.666414, loss_d: 0.367367
0.8061 --- loss: 2.237560, loss_ss: 1.564585, loss_d: 0.672974
0.8445 --- loss: 2.104383, loss_ss: 1.527852, loss_d: 0.576530
0.8829 --- loss: 1.927706, loss_ss: 1.443454, loss_d: 0.484253
0.9213 --- loss: 1.958873, loss_ss: 1.561818, loss_d: 0.397056
0.9597 --- loss: 1.816667, loss_ss: 1.467216, loss_d: 0.349451
0.9981 --- loss: 1.794820, loss_ss: 1.500553, loss_d: 0.294267
Epoch finished! Loss: 2.0815362201287195
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.717973, loss_ss: 1.445217, loss_d: 0.272755
0.0384 --- loss: 2.525158, loss_ss: 1.393193, loss_d: 1.131965
0.0768 --- loss: 1.921779, loss_ss: 1.440995, loss_d: 0.480784
0.1152 --- loss: 1.877243, loss_ss: 1.377705, loss_d: 0.499538
0.1536 --- loss: 2.421898, loss_ss: 1.398602, loss_d: 1.023296
0.1919 --- loss: 1.903917, loss_ss: 1.379244, loss_d: 0.524672
0.2303 --- loss: 1.851814, loss_ss: 1.399453, loss_d: 0.452360
0.2687 --- loss: 1.848375, loss_ss: 1.400506, loss_d: 0.447870
0.3071 --- loss: 1.815895, loss_ss: 1.353624, loss_d: 0.462272
0.3455 --- loss: 2.265957, loss_ss: 1.638620, loss_d: 0.627337
0.3839 --- loss: 2.046103, loss_ss: 1.660326, loss_d: 0.385777
0.4223 --- loss: 1.824444, loss_ss: 1.415842, loss_d: 0.408602
0.4607 --- loss: 1.902371, loss_ss: 1.487764, loss_d: 0.414607
0.4990 --- loss: 1.760277, loss_ss: 1.499682, loss_d: 0.260595
0.5374 --- loss: 1.956690, loss_ss: 1.515119, loss_d: 0.441570
0.5758 --- loss: 1.988412, loss_ss: 1.485174, loss_d: 0.503238
0.6142 --- loss: 1.846636, loss_ss: 1.390325, loss_d: 0.456312
0.6526 --- loss: 2.221402, loss_ss: 1.834203, loss_d: 0.387199
0.6910 --- loss: 1.881188, loss_ss: 1.519649, loss_d: 0.361539
0.7294 --- loss: 2.023180, loss_ss: 1.438468, loss_d: 0.584712
0.7678 --- loss: 1.909551, loss_ss: 1.409580, loss_d: 0.499971
0.8061 --- loss: 1.969970, loss_ss: 1.387384, loss_d: 0.582586
0.8445 --- loss: 2.126074, loss_ss: 1.616139, loss_d: 0.509936
0.8829 --- loss: 1.638551, loss_ss: 1.258615, loss_d: 0.379936
0.9213 --- loss: 1.694919, loss_ss: 1.340055, loss_d: 0.354864
0.9597 --- loss: 2.491547, loss_ss: 1.267306, loss_d: 1.224241
0.9981 --- loss: 2.272713, loss_ss: 1.694630, loss_d: 0.578083
Epoch finished! Loss: 1.967579033283087
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.215601, loss_ss: 1.551800, loss_d: 0.663802
0.0384 --- loss: 1.978337, loss_ss: 1.529944, loss_d: 0.448393
0.0768 --- loss: 1.808935, loss_ss: 1.325078, loss_d: 0.483857
0.1152 --- loss: 1.967094, loss_ss: 1.412850, loss_d: 0.554243
0.1536 --- loss: 1.980367, loss_ss: 1.359932, loss_d: 0.620436
0.1919 --- loss: 1.851499, loss_ss: 1.295063, loss_d: 0.556436
0.2303 --- loss: 1.809781, loss_ss: 1.546789, loss_d: 0.262992
0.2687 --- loss: 1.850656, loss_ss: 1.448517, loss_d: 0.402139
0.3071 --- loss: 1.907413, loss_ss: 1.332874, loss_d: 0.574540
0.3455 --- loss: 2.342893, loss_ss: 1.431649, loss_d: 0.911244
0.3839 --- loss: 1.852758, loss_ss: 1.477325, loss_d: 0.375433
0.4223 --- loss: 1.799761, loss_ss: 1.493773, loss_d: 0.305988
0.4607 --- loss: 1.631298, loss_ss: 1.231501, loss_d: 0.399797
0.4990 --- loss: 1.734530, loss_ss: 1.278380, loss_d: 0.456150
0.5374 --- loss: 1.939012, loss_ss: 1.423607, loss_d: 0.515406
0.5758 --- loss: 1.764361, loss_ss: 1.386734, loss_d: 0.377627
0.6142 --- loss: 1.614427, loss_ss: 1.158914, loss_d: 0.455514
0.6526 --- loss: 1.621675, loss_ss: 1.213866, loss_d: 0.407809
0.6910 --- loss: 1.900312, loss_ss: 1.392673, loss_d: 0.507639
0.7294 --- loss: 1.797431, loss_ss: 1.260836, loss_d: 0.536595
0.7678 --- loss: 1.947336, loss_ss: 1.425747, loss_d: 0.521589
0.8061 --- loss: 1.616608, loss_ss: 1.272117, loss_d: 0.344491
0.8445 --- loss: 1.965292, loss_ss: 1.190447, loss_d: 0.774845
0.8829 --- loss: 2.062024, loss_ss: 1.453963, loss_d: 0.608061
0.9213 --- loss: 1.971596, loss_ss: 1.254650, loss_d: 0.716946
0.9597 --- loss: 1.816933, loss_ss: 1.307766, loss_d: 0.509166
0.9981 --- loss: 1.941401, loss_ss: 1.632932, loss_d: 0.308469
Epoch finished! Loss: 1.921745634995974
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.830851, loss_ss: 1.345710, loss_d: 0.485140
0.0384 --- loss: 1.578507, loss_ss: 1.306664, loss_d: 0.271843
0.0768 --- loss: 1.614101, loss_ss: 1.313294, loss_d: 0.300808
0.1152 --- loss: 2.094792, loss_ss: 1.727409, loss_d: 0.367383
0.1536 --- loss: 1.761602, loss_ss: 1.362149, loss_d: 0.399453
0.1919 --- loss: 2.072010, loss_ss: 1.441783, loss_d: 0.630227
0.2303 --- loss: 2.035658, loss_ss: 1.428077, loss_d: 0.607581
0.2687 --- loss: 1.899941, loss_ss: 1.219936, loss_d: 0.680004
0.3071 --- loss: 1.928744, loss_ss: 1.350017, loss_d: 0.578727
0.3455 --- loss: 1.848591, loss_ss: 1.528235, loss_d: 0.320356
0.3839 --- loss: 1.937495, loss_ss: 1.223116, loss_d: 0.714378
0.4223 --- loss: 2.291879, loss_ss: 1.588246, loss_d: 0.703633
0.4607 --- loss: 1.836642, loss_ss: 1.516744, loss_d: 0.319898
0.4990 --- loss: 2.129276, loss_ss: 1.395902, loss_d: 0.733374
0.5374 --- loss: 1.975023, loss_ss: 1.504069, loss_d: 0.470954
0.5758 --- loss: 1.667439, loss_ss: 1.301485, loss_d: 0.365954
0.6142 --- loss: 1.955548, loss_ss: 1.338054, loss_d: 0.617495
0.6526 --- loss: 1.779241, loss_ss: 1.370967, loss_d: 0.408274
0.6910 --- loss: 1.926804, loss_ss: 1.401680, loss_d: 0.525124
0.7294 --- loss: 1.943220, loss_ss: 1.236640, loss_d: 0.706580
0.7678 --- loss: 1.697249, loss_ss: 1.301621, loss_d: 0.395628
0.8061 --- loss: 1.933924, loss_ss: 1.446330, loss_d: 0.487594
0.8445 --- loss: 2.106959, loss_ss: 1.508130, loss_d: 0.598829
0.8829 --- loss: 1.735693, loss_ss: 1.347955, loss_d: 0.387738
0.9213 --- loss: 1.891528, loss_ss: 1.552966, loss_d: 0.338563
0.9597 --- loss: 2.043174, loss_ss: 1.463747, loss_d: 0.579428
0.9981 --- loss: 1.797700, loss_ss: 1.073164, loss_d: 0.724535
Epoch finished! Loss: 1.8812174196426685
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.564050, loss_ss: 1.266923, loss_d: 0.297127
0.0384 --- loss: 1.976658, loss_ss: 1.408451, loss_d: 0.568207
0.0768 --- loss: 1.854528, loss_ss: 1.418167, loss_d: 0.436361
0.1152 --- loss: 1.883039, loss_ss: 1.357050, loss_d: 0.525989
0.1536 --- loss: 1.969581, loss_ss: 1.527445, loss_d: 0.442135
0.1919 --- loss: 1.905871, loss_ss: 1.429083, loss_d: 0.476788
0.2303 --- loss: 1.647489, loss_ss: 1.193609, loss_d: 0.453880
0.2687 --- loss: 1.578495, loss_ss: 1.229583, loss_d: 0.348912
0.3071 --- loss: 1.524658, loss_ss: 1.144004, loss_d: 0.380654
0.3455 --- loss: 1.869014, loss_ss: 1.529852, loss_d: 0.339162
0.3839 --- loss: 1.756593, loss_ss: 1.260780, loss_d: 0.495812
0.4223 --- loss: 1.653818, loss_ss: 1.321371, loss_d: 0.332447
0.4607 --- loss: 1.690950, loss_ss: 1.312012, loss_d: 0.378938
0.4990 --- loss: 1.658405, loss_ss: 1.327910, loss_d: 0.330495
0.5374 --- loss: 1.666654, loss_ss: 1.243367, loss_d: 0.423286
0.5758 --- loss: 1.706949, loss_ss: 1.324184, loss_d: 0.382765
0.6142 --- loss: 1.863850, loss_ss: 1.196631, loss_d: 0.667219
0.6526 --- loss: 1.760985, loss_ss: 1.263240, loss_d: 0.497745
0.6910 --- loss: 1.765461, loss_ss: 1.404705, loss_d: 0.360757
0.7294 --- loss: 1.558759, loss_ss: 1.302996, loss_d: 0.255763
0.7678 --- loss: 2.077157, loss_ss: 1.512118, loss_d: 0.565039
0.8061 --- loss: 2.153260, loss_ss: 1.422166, loss_d: 0.731094
0.8445 --- loss: 1.927732, loss_ss: 1.337642, loss_d: 0.590090
0.8829 --- loss: 1.807686, loss_ss: 1.152983, loss_d: 0.654704
0.9213 --- loss: 1.937433, loss_ss: 1.258610, loss_d: 0.678823
0.9597 --- loss: 1.787254, loss_ss: 1.309455, loss_d: 0.477800
0.9981 --- loss: 1.460440, loss_ss: 1.137269, loss_d: 0.323170
Epoch finished! Loss: 1.8559438806313735
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.636477, loss_ss: 1.303097, loss_d: 0.333380
0.0384 --- loss: 1.669556, loss_ss: 1.152153, loss_d: 0.517403
0.0768 --- loss: 1.480728, loss_ss: 1.159120, loss_d: 0.321608
0.1152 --- loss: 1.874742, loss_ss: 1.482405, loss_d: 0.392337
0.1536 --- loss: 1.749907, loss_ss: 1.428521, loss_d: 0.321385
0.1919 --- loss: 1.499035, loss_ss: 1.106566, loss_d: 0.392469
0.2303 --- loss: 1.753341, loss_ss: 1.319239, loss_d: 0.434102
0.2687 --- loss: 1.901661, loss_ss: 1.253961, loss_d: 0.647699
0.3071 --- loss: 1.424339, loss_ss: 1.073983, loss_d: 0.350356
0.3455 --- loss: 1.645994, loss_ss: 1.249618, loss_d: 0.396377
0.3839 --- loss: 1.337660, loss_ss: 1.083956, loss_d: 0.253704
0.4223 --- loss: 1.467150, loss_ss: 1.053947, loss_d: 0.413202
0.4607 --- loss: 1.353480, loss_ss: 1.108886, loss_d: 0.244594
0.4990 --- loss: 1.684397, loss_ss: 1.078376, loss_d: 0.606022
0.5374 --- loss: 1.502329, loss_ss: 1.195849, loss_d: 0.306480
0.5758 --- loss: 1.556388, loss_ss: 1.205955, loss_d: 0.350433
0.6142 --- loss: 1.848707, loss_ss: 1.065349, loss_d: 0.783358
0.6526 --- loss: 2.140145, loss_ss: 1.305461, loss_d: 0.834684
0.6910 --- loss: 1.520040, loss_ss: 1.064273, loss_d: 0.455767
0.7294 --- loss: 1.872504, loss_ss: 1.425054, loss_d: 0.447450
0.7678 --- loss: 1.510627, loss_ss: 1.095508, loss_d: 0.415118
0.8061 --- loss: 1.904739, loss_ss: 1.576913, loss_d: 0.327826
0.8445 --- loss: 1.717733, loss_ss: 1.297226, loss_d: 0.420507
0.8829 --- loss: 1.387985, loss_ss: 1.122474, loss_d: 0.265510
0.9213 --- loss: 1.924000, loss_ss: 1.215226, loss_d: 0.708774
0.9597 --- loss: 1.521306, loss_ss: 1.132196, loss_d: 0.389111
0.9981 --- loss: 1.581536, loss_ss: 1.126544, loss_d: 0.454991
Epoch finished! Loss: 1.7337565201979417
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.509264, loss_ss: 1.209178, loss_d: 0.300085
0.0384 --- loss: 1.735422, loss_ss: 1.040619, loss_d: 0.694803
0.0768 --- loss: 1.630867, loss_ss: 0.970431, loss_d: 0.660435
0.1152 --- loss: 1.651169, loss_ss: 1.115517, loss_d: 0.535652
0.1536 --- loss: 1.497255, loss_ss: 1.181476, loss_d: 0.315779
0.1919 --- loss: 1.453663, loss_ss: 1.104932, loss_d: 0.348731
0.2303 --- loss: 1.998766, loss_ss: 1.265685, loss_d: 0.733081
0.2687 --- loss: 1.609641, loss_ss: 1.153022, loss_d: 0.456619
0.3071 --- loss: 1.696762, loss_ss: 1.347871, loss_d: 0.348891
0.3455 --- loss: 1.688977, loss_ss: 1.099096, loss_d: 0.589880
0.3839 --- loss: 1.649962, loss_ss: 1.176497, loss_d: 0.473464
0.4223 --- loss: 1.641308, loss_ss: 1.121691, loss_d: 0.519617
0.4607 --- loss: 1.827229, loss_ss: 1.330367, loss_d: 0.496862
0.4990 --- loss: 1.537408, loss_ss: 1.218302, loss_d: 0.319106
0.5374 --- loss: 1.503816, loss_ss: 1.156710, loss_d: 0.347107
0.5758 --- loss: 1.947642, loss_ss: 1.376457, loss_d: 0.571184
0.6142 --- loss: 1.819923, loss_ss: 1.221153, loss_d: 0.598770
0.6526 --- loss: 1.712783, loss_ss: 1.389513, loss_d: 0.323270
0.6910 --- loss: 1.631459, loss_ss: 1.230176, loss_d: 0.401283
0.7294 --- loss: 1.475263, loss_ss: 1.020195, loss_d: 0.455068
0.7678 --- loss: 1.424323, loss_ss: 0.993361, loss_d: 0.430963
0.8061 --- loss: 1.656388, loss_ss: 0.984832, loss_d: 0.671556
0.8445 --- loss: 1.422121, loss_ss: 1.168088, loss_d: 0.254032
0.8829 --- loss: 1.490112, loss_ss: 1.112996, loss_d: 0.377116
0.9213 --- loss: 1.370830, loss_ss: 1.031136, loss_d: 0.339694
0.9597 --- loss: 1.395703, loss_ss: 0.877167, loss_d: 0.518536
0.9981 --- loss: 1.722712, loss_ss: 1.112943, loss_d: 0.609769
Epoch finished! Loss: 1.6692135888796586
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.882443, loss_ss: 1.320546, loss_d: 0.561897
0.0384 --- loss: 1.666882, loss_ss: 1.105274, loss_d: 0.561608
0.0768 --- loss: 1.367539, loss_ss: 1.020863, loss_d: 0.346676
0.1152 --- loss: 1.486118, loss_ss: 1.122823, loss_d: 0.363295
0.1536 --- loss: 1.678745, loss_ss: 1.099341, loss_d: 0.579404
0.1919 --- loss: 1.796340, loss_ss: 1.182581, loss_d: 0.613758
0.2303 --- loss: 1.413516, loss_ss: 1.006495, loss_d: 0.407021
0.2687 --- loss: 1.438763, loss_ss: 1.025623, loss_d: 0.413140
0.3071 --- loss: 1.576366, loss_ss: 0.984256, loss_d: 0.592110
0.3455 --- loss: 1.665357, loss_ss: 1.089238, loss_d: 0.576118
0.3839 --- loss: 1.293665, loss_ss: 1.008503, loss_d: 0.285163
0.4223 --- loss: 1.219243, loss_ss: 0.904366, loss_d: 0.314877
0.4607 --- loss: 1.561905, loss_ss: 1.126839, loss_d: 0.435066
0.4990 --- loss: 1.470213, loss_ss: 1.128909, loss_d: 0.341304
0.5374 --- loss: 1.622522, loss_ss: 1.002099, loss_d: 0.620423
0.5758 --- loss: 1.498874, loss_ss: 1.055390, loss_d: 0.443484
0.6142 --- loss: 1.422884, loss_ss: 1.061132, loss_d: 0.361752
0.6526 --- loss: 1.424487, loss_ss: 1.071622, loss_d: 0.352865
0.6910 --- loss: 1.620709, loss_ss: 1.147058, loss_d: 0.473650
0.7294 --- loss: 1.783235, loss_ss: 1.162964, loss_d: 0.620270
0.7678 --- loss: 1.591021, loss_ss: 1.130777, loss_d: 0.460244
0.8061 --- loss: 1.389736, loss_ss: 1.126030, loss_d: 0.263706
0.8445 --- loss: 1.737441, loss_ss: 1.037491, loss_d: 0.699950
0.8829 --- loss: 1.305196, loss_ss: 0.912211, loss_d: 0.392986
0.9213 --- loss: 2.188937, loss_ss: 1.377684, loss_d: 0.811253
0.9597 --- loss: 1.900025, loss_ss: 1.417675, loss_d: 0.482350
0.9981 --- loss: 1.383464, loss_ss: 0.967742, loss_d: 0.415722
Epoch finished! Loss: 1.591001664675199
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.414921, loss_ss: 0.873173, loss_d: 0.541747
0.0384 --- loss: 1.431748, loss_ss: 1.032232, loss_d: 0.399516
0.0768 --- loss: 1.540466, loss_ss: 1.175188, loss_d: 0.365278
0.1152 --- loss: 1.485043, loss_ss: 0.977499, loss_d: 0.507544
0.1536 --- loss: 1.435522, loss_ss: 1.105263, loss_d: 0.330259
0.1919 --- loss: 1.647323, loss_ss: 1.248773, loss_d: 0.398550
0.2303 --- loss: 1.514488, loss_ss: 0.985345, loss_d: 0.529143
0.2687 --- loss: 1.353539, loss_ss: 1.136642, loss_d: 0.216898
0.3071 --- loss: 1.371654, loss_ss: 1.007256, loss_d: 0.364398
0.3455 --- loss: 1.579372, loss_ss: 1.207676, loss_d: 0.371696
0.3839 --- loss: 1.266662, loss_ss: 0.949191, loss_d: 0.317471
0.4223 --- loss: 1.982181, loss_ss: 0.987630, loss_d: 0.994550
0.4607 --- loss: 1.363661, loss_ss: 1.126001, loss_d: 0.237660
0.4990 --- loss: 1.540160, loss_ss: 1.117952, loss_d: 0.422208
0.5374 --- loss: 1.409060, loss_ss: 1.089906, loss_d: 0.319154
0.5758 --- loss: 1.436176, loss_ss: 1.010372, loss_d: 0.425803
0.6142 --- loss: 1.265528, loss_ss: 0.967082, loss_d: 0.298446
0.6526 --- loss: 1.628354, loss_ss: 1.210363, loss_d: 0.417991
0.6910 --- loss: 1.953971, loss_ss: 1.412703, loss_d: 0.541268
0.7294 --- loss: 2.009819, loss_ss: 1.174130, loss_d: 0.835688
0.7678 --- loss: 1.314883, loss_ss: 1.062056, loss_d: 0.252827
0.8061 --- loss: 1.346529, loss_ss: 1.049088, loss_d: 0.297441
0.8445 --- loss: 1.785348, loss_ss: 1.422667, loss_d: 0.362681
0.8829 --- loss: 1.926608, loss_ss: 0.854722, loss_d: 1.071886
0.9213 --- loss: 1.319523, loss_ss: 0.946957, loss_d: 0.372567
0.9597 --- loss: 1.453326, loss_ss: 1.136946, loss_d: 0.316379
0.9981 --- loss: 1.634190, loss_ss: 1.118753, loss_d: 0.515437
Epoch finished! Loss: 1.5532805598699129
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.230623, loss_ss: 0.936805, loss_d: 0.293818
0.0384 --- loss: 1.486211, loss_ss: 1.024839, loss_d: 0.461372
0.0768 --- loss: 1.492651, loss_ss: 1.306774, loss_d: 0.185876
0.1152 --- loss: 1.368465, loss_ss: 1.013410, loss_d: 0.355056
0.1536 --- loss: 1.592911, loss_ss: 1.183505, loss_d: 0.409405
0.1919 --- loss: 1.621468, loss_ss: 1.133569, loss_d: 0.487899
0.2303 --- loss: 1.325792, loss_ss: 1.009941, loss_d: 0.315850
0.2687 --- loss: 1.507741, loss_ss: 0.858123, loss_d: 0.649619
0.3071 --- loss: 1.581131, loss_ss: 1.058392, loss_d: 0.522738
0.3455 --- loss: 1.557246, loss_ss: 1.181684, loss_d: 0.375562
0.3839 --- loss: 1.597317, loss_ss: 1.228157, loss_d: 0.369159
0.4223 --- loss: 1.780035, loss_ss: 0.948356, loss_d: 0.831679
0.4607 --- loss: 1.148865, loss_ss: 0.960936, loss_d: 0.187929
0.4990 --- loss: 1.808066, loss_ss: 1.517648, loss_d: 0.290419
0.5374 --- loss: 1.363767, loss_ss: 1.082615, loss_d: 0.281152
0.5758 --- loss: 1.206984, loss_ss: 0.832738, loss_d: 0.374245
0.6142 --- loss: 1.254925, loss_ss: 0.911337, loss_d: 0.343589
0.6526 --- loss: 1.506050, loss_ss: 1.037378, loss_d: 0.468672
0.6910 --- loss: 1.486695, loss_ss: 1.292781, loss_d: 0.193914
0.7294 --- loss: 1.305090, loss_ss: 0.985594, loss_d: 0.319496
0.7678 --- loss: 1.434090, loss_ss: 1.188274, loss_d: 0.245816
0.8061 --- loss: 1.383355, loss_ss: 1.041622, loss_d: 0.341732
0.8445 --- loss: 1.574787, loss_ss: 1.292091, loss_d: 0.282696
0.8829 --- loss: 1.279122, loss_ss: 0.922160, loss_d: 0.356963
0.9213 --- loss: 1.307171, loss_ss: 0.916313, loss_d: 0.390858
0.9597 --- loss: 1.690612, loss_ss: 1.216293, loss_d: 0.474319
0.9981 --- loss: 1.542988, loss_ss: 1.132473, loss_d: 0.410516
Epoch finished! Loss: 1.5111860410525249
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6888888888888889
             precision    recall  f1-score   support

        0.0       0.65      0.77      0.71       159
        1.0       0.00      0.00      0.00        87
        2.0       0.78      0.79      0.79       439
        3.0       0.55      0.97      0.70        99
        4.0       0.63      0.56      0.59       206

avg / total       0.64      0.69      0.66       990
 


====== chp052-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  89.80  77.36   92.18  65.43     70.89
1  91.21   0.00  100.00   0.00      0.00
2  81.01  79.27   82.40  78.20     78.73
3  91.72  96.97   91.13  54.86     70.07
4  84.04  55.83   91.45  63.19     59.28
Total accuracy: 68.89%
Average sen: 61.88%
Average spec: 91.43%
Macro f1-score: 55.80%
[0.99953043 0.99970299 0.99995446 0.88227963 0.60851246 0.71573371
 0.99429095 0.99499822 0.98119271 0.82949448 0.94315118 0.92705077
 0.82650089 0.53007925 0.63295001 0.53952855 0.53999138 0.88763529
 0.6324901  0.88111967 0.8918736  0.96722555 0.53531665 0.52753884
 0.51527715 0.75339222 0.97129333 0.97944641 0.98265254 0.86246818
 0.51276052 0.55414766 0.96162742]
pred: 0.798824460217447, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.391350, loss_ss: 1.678163, loss_d: 0.713186
0.0384 --- loss: 2.445866, loss_ss: 1.757370, loss_d: 0.688495
0.0769 --- loss: 2.382787, loss_ss: 1.616048, loss_d: 0.766739
0.1153 --- loss: 2.643027, loss_ss: 1.675143, loss_d: 0.967884
0.1537 --- loss: 2.258646, loss_ss: 1.576310, loss_d: 0.682335
0.1922 --- loss: 2.364830, loss_ss: 1.631132, loss_d: 0.733698
0.2306 --- loss: 2.411908, loss_ss: 1.631227, loss_d: 0.780681
0.2690 --- loss: 2.259679, loss_ss: 1.502625, loss_d: 0.757055
0.3075 --- loss: 2.179532, loss_ss: 1.620868, loss_d: 0.558664
0.3459 --- loss: 2.234038, loss_ss: 1.611174, loss_d: 0.622864
0.3843 --- loss: 2.070332, loss_ss: 1.586323, loss_d: 0.484009
0.4228 --- loss: 1.946836, loss_ss: 1.589653, loss_d: 0.357184
0.4612 --- loss: 2.172116, loss_ss: 1.513710, loss_d: 0.658406
0.4996 --- loss: 2.243902, loss_ss: 1.586943, loss_d: 0.656959
0.5380 --- loss: 2.098335, loss_ss: 1.539521, loss_d: 0.558814
0.5765 --- loss: 2.038511, loss_ss: 1.546110, loss_d: 0.492401
0.6149 --- loss: 1.882652, loss_ss: 1.491526, loss_d: 0.391126
0.6533 --- loss: 1.772836, loss_ss: 1.448579, loss_d: 0.324258
0.6918 --- loss: 1.808125, loss_ss: 1.528170, loss_d: 0.279955
0.7302 --- loss: 1.934219, loss_ss: 1.467435, loss_d: 0.466785
0.7686 --- loss: 2.045530, loss_ss: 1.446790, loss_d: 0.598739
0.8071 --- loss: 1.707128, loss_ss: 1.362435, loss_d: 0.344694
0.8455 --- loss: 2.125064, loss_ss: 1.392908, loss_d: 0.732156
0.8839 --- loss: 1.908128, loss_ss: 1.484453, loss_d: 0.423675
0.9224 --- loss: 1.879488, loss_ss: 1.517479, loss_d: 0.362010
0.9608 --- loss: 1.982754, loss_ss: 1.495982, loss_d: 0.486772
0.9992 --- loss: 1.824176, loss_ss: 1.471331, loss_d: 0.352845
Epoch finished! Loss: 2.120555240374345
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.876287, loss_ss: 1.326265, loss_d: 0.550022
0.0384 --- loss: 1.856375, loss_ss: 1.342681, loss_d: 0.513694
0.0769 --- loss: 1.782512, loss_ss: 1.230630, loss_d: 0.551883
0.1153 --- loss: 2.101334, loss_ss: 1.443160, loss_d: 0.658173
0.1537 --- loss: 2.021789, loss_ss: 1.480649, loss_d: 0.541140
0.1922 --- loss: 1.823349, loss_ss: 1.397394, loss_d: 0.425955
0.2306 --- loss: 1.743243, loss_ss: 1.365152, loss_d: 0.378091
0.2690 --- loss: 2.153108, loss_ss: 1.243795, loss_d: 0.909313
0.3075 --- loss: 1.904063, loss_ss: 1.391385, loss_d: 0.512678
0.3459 --- loss: 2.107025, loss_ss: 1.462935, loss_d: 0.644090
0.3843 --- loss: 1.688432, loss_ss: 1.348918, loss_d: 0.339514
0.4228 --- loss: 1.687295, loss_ss: 1.298865, loss_d: 0.388431
0.4612 --- loss: 1.909534, loss_ss: 1.329532, loss_d: 0.580001
0.4996 --- loss: 1.818214, loss_ss: 1.320614, loss_d: 0.497599
0.5380 --- loss: 2.755671, loss_ss: 1.537767, loss_d: 1.217903
0.5765 --- loss: 1.750264, loss_ss: 1.355540, loss_d: 0.394724
0.6149 --- loss: 2.052987, loss_ss: 1.504653, loss_d: 0.548334
0.6533 --- loss: 2.206402, loss_ss: 1.685174, loss_d: 0.521228
0.6918 --- loss: 1.935353, loss_ss: 1.185351, loss_d: 0.750002
0.7302 --- loss: 1.810657, loss_ss: 1.316604, loss_d: 0.494053
0.7686 --- loss: 1.755244, loss_ss: 1.371565, loss_d: 0.383678
0.8071 --- loss: 1.663247, loss_ss: 1.299443, loss_d: 0.363804
0.8455 --- loss: 1.744709, loss_ss: 1.250194, loss_d: 0.494515
0.8839 --- loss: 1.667290, loss_ss: 1.261027, loss_d: 0.406263
0.9224 --- loss: 1.623729, loss_ss: 1.123318, loss_d: 0.500411
0.9608 --- loss: 1.744662, loss_ss: 1.063950, loss_d: 0.680712
0.9992 --- loss: 3.094645, loss_ss: 0.910372, loss_d: 2.184273
Epoch finished! Loss: 1.8847932604643014
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.526968, loss_ss: 1.357673, loss_d: 1.169295
0.0384 --- loss: 1.823886, loss_ss: 1.320886, loss_d: 0.503001
0.0769 --- loss: 1.552052, loss_ss: 1.253890, loss_d: 0.298162
0.1153 --- loss: 1.524731, loss_ss: 1.087991, loss_d: 0.436740
0.1537 --- loss: 2.345986, loss_ss: 1.496738, loss_d: 0.849248
0.1922 --- loss: 1.578301, loss_ss: 1.191852, loss_d: 0.386449
0.2306 --- loss: 1.806241, loss_ss: 1.310749, loss_d: 0.495492
0.2690 --- loss: 1.626619, loss_ss: 1.033536, loss_d: 0.593082
0.3075 --- loss: 2.045402, loss_ss: 1.322494, loss_d: 0.722907
0.3459 --- loss: 1.552256, loss_ss: 1.172461, loss_d: 0.379795
0.3843 --- loss: 1.735619, loss_ss: 1.301630, loss_d: 0.433989
0.4228 --- loss: 1.750563, loss_ss: 1.262874, loss_d: 0.487689
0.4612 --- loss: 1.627495, loss_ss: 1.262495, loss_d: 0.365000
0.4996 --- loss: 1.641082, loss_ss: 1.247584, loss_d: 0.393497
0.5380 --- loss: 1.631426, loss_ss: 1.223745, loss_d: 0.407680
0.5765 --- loss: 1.932275, loss_ss: 1.487089, loss_d: 0.445186
0.6149 --- loss: 1.561042, loss_ss: 1.193378, loss_d: 0.367665
0.6533 --- loss: 1.851316, loss_ss: 1.090305, loss_d: 0.761011
0.6918 --- loss: 1.593007, loss_ss: 1.084768, loss_d: 0.508239
0.7302 --- loss: 2.005692, loss_ss: 1.328743, loss_d: 0.676948
0.7686 --- loss: 1.758057, loss_ss: 1.364645, loss_d: 0.393412
0.8071 --- loss: 1.502878, loss_ss: 1.144874, loss_d: 0.358003
0.8455 --- loss: 1.460953, loss_ss: 0.970960, loss_d: 0.489993
0.8839 --- loss: 1.530328, loss_ss: 1.178155, loss_d: 0.352173
0.9224 --- loss: 1.555014, loss_ss: 1.181371, loss_d: 0.373643
0.9608 --- loss: 1.660890, loss_ss: 1.198024, loss_d: 0.462866
0.9992 --- loss: 1.928351, loss_ss: 1.580156, loss_d: 0.348195
Epoch finished! Loss: 1.7776629200348488
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.710642, loss_ss: 1.082869, loss_d: 0.627773
0.0384 --- loss: 1.444934, loss_ss: 1.010760, loss_d: 0.434175
0.0769 --- loss: 1.625394, loss_ss: 1.162251, loss_d: 0.463142
0.1153 --- loss: 1.683310, loss_ss: 1.258017, loss_d: 0.425292
0.1537 --- loss: 1.524073, loss_ss: 0.891783, loss_d: 0.632289
0.1922 --- loss: 1.812995, loss_ss: 1.407727, loss_d: 0.405268
0.2306 --- loss: 1.780467, loss_ss: 0.910114, loss_d: 0.870353
0.2690 --- loss: 1.590905, loss_ss: 1.182290, loss_d: 0.408615
0.3075 --- loss: 1.705624, loss_ss: 1.285132, loss_d: 0.420492
0.3459 --- loss: 1.682663, loss_ss: 1.055266, loss_d: 0.627396
0.3843 --- loss: 1.902037, loss_ss: 1.170067, loss_d: 0.731970
0.4228 --- loss: 1.573303, loss_ss: 1.087695, loss_d: 0.485608
0.4612 --- loss: 1.556373, loss_ss: 1.155283, loss_d: 0.401090
0.4996 --- loss: 2.145704, loss_ss: 1.571846, loss_d: 0.573858
0.5380 --- loss: 1.651128, loss_ss: 1.235067, loss_d: 0.416060
0.5765 --- loss: 1.350296, loss_ss: 0.973124, loss_d: 0.377171
0.6149 --- loss: 1.718965, loss_ss: 1.218245, loss_d: 0.500720
0.6533 --- loss: 1.695442, loss_ss: 1.110179, loss_d: 0.585263
0.6918 --- loss: 1.789960, loss_ss: 1.199329, loss_d: 0.590631
0.7302 --- loss: 1.816366, loss_ss: 1.016660, loss_d: 0.799706
0.7686 --- loss: 1.723281, loss_ss: 1.409696, loss_d: 0.313586
0.8071 --- loss: 1.661952, loss_ss: 1.237334, loss_d: 0.424618
0.8455 --- loss: 1.421243, loss_ss: 1.072513, loss_d: 0.348730
0.8839 --- loss: 1.532369, loss_ss: 1.126541, loss_d: 0.405828
0.9224 --- loss: 1.709035, loss_ss: 1.203871, loss_d: 0.505163
0.9608 --- loss: 2.123481, loss_ss: 1.278150, loss_d: 0.845331
0.9992 --- loss: 1.642211, loss_ss: 1.312110, loss_d: 0.330101
Epoch finished! Loss: 1.7146993751709279
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.181156, loss_ss: 1.443940, loss_d: 0.737216
0.0384 --- loss: 1.911228, loss_ss: 1.035378, loss_d: 0.875851
0.0769 --- loss: 1.944690, loss_ss: 1.494635, loss_d: 0.450055
0.1153 --- loss: 2.285325, loss_ss: 1.885264, loss_d: 0.400061
0.1537 --- loss: 1.668449, loss_ss: 1.119176, loss_d: 0.549274
0.1922 --- loss: 1.477672, loss_ss: 1.086399, loss_d: 0.391273
0.2306 --- loss: 1.443930, loss_ss: 1.082082, loss_d: 0.361848
0.2690 --- loss: 1.407360, loss_ss: 1.076106, loss_d: 0.331254
0.3075 --- loss: 1.849166, loss_ss: 1.313261, loss_d: 0.535905
0.3459 --- loss: 1.596463, loss_ss: 1.060861, loss_d: 0.535602
0.3843 --- loss: 1.575799, loss_ss: 1.069294, loss_d: 0.506505
0.4228 --- loss: 1.629587, loss_ss: 1.224395, loss_d: 0.405192
0.4612 --- loss: 1.282169, loss_ss: 0.908506, loss_d: 0.373663
0.4996 --- loss: 1.528369, loss_ss: 1.253828, loss_d: 0.274541
0.5380 --- loss: 1.541998, loss_ss: 1.134526, loss_d: 0.407472
0.5765 --- loss: 1.436381, loss_ss: 0.970867, loss_d: 0.465514
0.6149 --- loss: 1.433095, loss_ss: 1.014711, loss_d: 0.418385
0.6533 --- loss: 1.224696, loss_ss: 0.836963, loss_d: 0.387733
0.6918 --- loss: 1.479641, loss_ss: 1.121150, loss_d: 0.358490
0.7302 --- loss: 2.268398, loss_ss: 1.042405, loss_d: 1.225993
0.7686 --- loss: 1.451580, loss_ss: 1.124994, loss_d: 0.326586
0.8071 --- loss: 1.688194, loss_ss: 1.223982, loss_d: 0.464212
0.8455 --- loss: 1.467457, loss_ss: 1.139337, loss_d: 0.328120
0.8839 --- loss: 1.715482, loss_ss: 1.248861, loss_d: 0.466621
0.9224 --- loss: 2.185904, loss_ss: 1.422181, loss_d: 0.763723
0.9608 --- loss: 1.337563, loss_ss: 0.944356, loss_d: 0.393207
0.9992 --- loss: 1.515399, loss_ss: 1.174688, loss_d: 0.340711
Epoch finished! Loss: 1.6476612425767458
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.433490, loss_ss: 1.001014, loss_d: 0.432476
0.0384 --- loss: 1.692337, loss_ss: 1.095796, loss_d: 0.596541
0.0769 --- loss: 1.287073, loss_ss: 0.883655, loss_d: 0.403418
0.1153 --- loss: 1.509855, loss_ss: 0.975290, loss_d: 0.534565
0.1537 --- loss: 1.439301, loss_ss: 0.932587, loss_d: 0.506715
0.1922 --- loss: 1.743012, loss_ss: 1.302442, loss_d: 0.440570
0.2306 --- loss: 1.367022, loss_ss: 0.787421, loss_d: 0.579601
0.2690 --- loss: 1.123317, loss_ss: 0.831030, loss_d: 0.292287
0.3075 --- loss: 2.187524, loss_ss: 1.249300, loss_d: 0.938224
0.3459 --- loss: 2.195618, loss_ss: 1.214536, loss_d: 0.981082
0.3843 --- loss: 1.748934, loss_ss: 1.147853, loss_d: 0.601081
0.4228 --- loss: 2.091697, loss_ss: 1.721554, loss_d: 0.370143
0.4612 --- loss: 1.764490, loss_ss: 0.987599, loss_d: 0.776891
0.4996 --- loss: 1.851545, loss_ss: 0.998541, loss_d: 0.853004
0.5380 --- loss: 1.496806, loss_ss: 1.212431, loss_d: 0.284375
0.5765 --- loss: 1.462358, loss_ss: 1.067683, loss_d: 0.394675
0.6149 --- loss: 1.643578, loss_ss: 1.078885, loss_d: 0.564693
0.6533 --- loss: 1.656069, loss_ss: 1.076418, loss_d: 0.579651
0.6918 --- loss: 1.251737, loss_ss: 0.901650, loss_d: 0.350087
0.7302 --- loss: 1.486770, loss_ss: 1.140056, loss_d: 0.346715
0.7686 --- loss: 1.402383, loss_ss: 1.040772, loss_d: 0.361610
0.8071 --- loss: 1.451741, loss_ss: 1.007778, loss_d: 0.443963
0.8455 --- loss: 1.594810, loss_ss: 1.172389, loss_d: 0.422421
0.8839 --- loss: 1.670843, loss_ss: 1.223317, loss_d: 0.447526
0.9224 --- loss: 1.741597, loss_ss: 1.141504, loss_d: 0.600093
0.9608 --- loss: 1.840099, loss_ss: 1.071204, loss_d: 0.768895
0.9992 --- loss: 1.567611, loss_ss: 1.215667, loss_d: 0.351944
Epoch finished! Loss: 1.5916964209996738
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.420728, loss_ss: 0.887538, loss_d: 0.533189
0.0384 --- loss: 1.474684, loss_ss: 1.107203, loss_d: 0.367481
0.0769 --- loss: 1.600532, loss_ss: 1.240149, loss_d: 0.360383
0.1153 --- loss: 1.394129, loss_ss: 1.002153, loss_d: 0.391975
0.1537 --- loss: 1.608177, loss_ss: 1.248897, loss_d: 0.359280
0.1922 --- loss: 1.346812, loss_ss: 1.021954, loss_d: 0.324858
0.2306 --- loss: 1.747246, loss_ss: 1.356961, loss_d: 0.390285
0.2690 --- loss: 1.480276, loss_ss: 1.024940, loss_d: 0.455335
0.3075 --- loss: 1.340693, loss_ss: 0.984634, loss_d: 0.356058
0.3459 --- loss: 1.338032, loss_ss: 1.070283, loss_d: 0.267749
0.3843 --- loss: 1.192948, loss_ss: 0.814727, loss_d: 0.378221
0.4228 --- loss: 1.436476, loss_ss: 1.094604, loss_d: 0.341871
0.4612 --- loss: 1.594998, loss_ss: 1.122450, loss_d: 0.472548
0.4996 --- loss: 1.592130, loss_ss: 1.252555, loss_d: 0.339575
0.5380 --- loss: 1.334875, loss_ss: 1.022753, loss_d: 0.312122
0.5765 --- loss: 1.750124, loss_ss: 1.345982, loss_d: 0.404143
0.6149 --- loss: 1.734205, loss_ss: 1.071049, loss_d: 0.663156
0.6533 --- loss: 1.464741, loss_ss: 0.914136, loss_d: 0.550605
0.6918 --- loss: 1.585168, loss_ss: 1.090434, loss_d: 0.494734
0.7302 --- loss: 1.552884, loss_ss: 1.282327, loss_d: 0.270557
0.7686 --- loss: 1.689234, loss_ss: 1.114247, loss_d: 0.574987
0.8071 --- loss: 1.612714, loss_ss: 1.136909, loss_d: 0.475805
0.8455 --- loss: 1.704408, loss_ss: 1.274791, loss_d: 0.429617
0.8839 --- loss: 1.419723, loss_ss: 1.066470, loss_d: 0.353252
0.9224 --- loss: 1.223247, loss_ss: 0.932859, loss_d: 0.290387
0.9608 --- loss: 1.530861, loss_ss: 1.071521, loss_d: 0.459340
0.9992 --- loss: 1.366312, loss_ss: 0.944581, loss_d: 0.421731
Epoch finished! Loss: 1.5632534054609446
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.436084, loss_ss: 0.983616, loss_d: 0.452468
0.0384 --- loss: 1.314620, loss_ss: 0.946083, loss_d: 0.368537
0.0769 --- loss: 1.704691, loss_ss: 1.406702, loss_d: 0.297989
0.1153 --- loss: 1.293412, loss_ss: 0.857717, loss_d: 0.435695
0.1537 --- loss: 2.459195, loss_ss: 1.031084, loss_d: 1.428111
0.1922 --- loss: 1.531139, loss_ss: 1.132446, loss_d: 0.398694
0.2306 --- loss: 1.266425, loss_ss: 0.777717, loss_d: 0.488709
0.2690 --- loss: 1.956097, loss_ss: 1.482443, loss_d: 0.473654
0.3075 --- loss: 1.764787, loss_ss: 1.170911, loss_d: 0.593876
0.3459 --- loss: 1.877277, loss_ss: 1.167767, loss_d: 0.709509
0.3843 --- loss: 1.608855, loss_ss: 1.043918, loss_d: 0.564937
0.4228 --- loss: 1.178845, loss_ss: 0.857725, loss_d: 0.321121
0.4612 --- loss: 1.511542, loss_ss: 0.928400, loss_d: 0.583142
0.4996 --- loss: 1.828363, loss_ss: 0.781203, loss_d: 1.047160
0.5380 --- loss: 1.835102, loss_ss: 1.240998, loss_d: 0.594104
0.5765 --- loss: 2.231835, loss_ss: 1.622873, loss_d: 0.608961
0.6149 --- loss: 1.377217, loss_ss: 0.812975, loss_d: 0.564242
0.6533 --- loss: 1.598475, loss_ss: 1.085458, loss_d: 0.513017
0.6918 --- loss: 2.229381, loss_ss: 1.235743, loss_d: 0.993639
0.7302 --- loss: 1.645302, loss_ss: 1.200675, loss_d: 0.444627
0.7686 --- loss: 1.344442, loss_ss: 0.983849, loss_d: 0.360592
0.8071 --- loss: 1.655469, loss_ss: 1.170251, loss_d: 0.485218
0.8455 --- loss: 1.699563, loss_ss: 1.181452, loss_d: 0.518111
0.8839 --- loss: 1.473830, loss_ss: 0.898328, loss_d: 0.575502
0.9224 --- loss: 1.366131, loss_ss: 0.930764, loss_d: 0.435368
0.9608 --- loss: 1.371331, loss_ss: 1.066502, loss_d: 0.304829
0.9992 --- loss: 1.837890, loss_ss: 1.499787, loss_d: 0.338103
Epoch finished! Loss: 1.5386208213292636
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.820097, loss_ss: 1.497177, loss_d: 0.322920
0.0384 --- loss: 1.437311, loss_ss: 1.162416, loss_d: 0.274895
0.0769 --- loss: 1.509156, loss_ss: 1.146982, loss_d: 0.362174
0.1153 --- loss: 1.735169, loss_ss: 1.241082, loss_d: 0.494087
0.1537 --- loss: 1.287358, loss_ss: 0.976366, loss_d: 0.310992
0.1922 --- loss: 1.564810, loss_ss: 1.174192, loss_d: 0.390618
0.2306 --- loss: 1.218435, loss_ss: 0.859913, loss_d: 0.358521
0.2690 --- loss: 1.309380, loss_ss: 0.959004, loss_d: 0.350376
0.3075 --- loss: 1.372326, loss_ss: 1.081920, loss_d: 0.290405
0.3459 --- loss: 1.450871, loss_ss: 1.173799, loss_d: 0.277072
0.3843 --- loss: 1.322436, loss_ss: 1.004791, loss_d: 0.317645
0.4228 --- loss: 1.852775, loss_ss: 1.402549, loss_d: 0.450226
0.4612 --- loss: 2.022135, loss_ss: 1.224220, loss_d: 0.797914
0.4996 --- loss: 1.296895, loss_ss: 0.928645, loss_d: 0.368251
0.5380 --- loss: 1.466548, loss_ss: 1.112262, loss_d: 0.354286
0.5765 --- loss: 1.707060, loss_ss: 1.254057, loss_d: 0.453003
0.6149 --- loss: 1.418291, loss_ss: 1.006583, loss_d: 0.411708
0.6533 --- loss: 1.452913, loss_ss: 0.918165, loss_d: 0.534748
0.6918 --- loss: 1.392754, loss_ss: 0.996065, loss_d: 0.396689
0.7302 --- loss: 1.522617, loss_ss: 1.156353, loss_d: 0.366263
0.7686 --- loss: 1.637971, loss_ss: 1.156994, loss_d: 0.480977
0.8071 --- loss: 1.321293, loss_ss: 0.982658, loss_d: 0.338635
0.8455 --- loss: 1.303581, loss_ss: 0.963341, loss_d: 0.340240
0.8839 --- loss: 1.637893, loss_ss: 0.924489, loss_d: 0.713405
0.9224 --- loss: 1.593315, loss_ss: 0.967723, loss_d: 0.625592
0.9608 --- loss: 1.270039, loss_ss: 0.981114, loss_d: 0.288925
0.9992 --- loss: 1.180578, loss_ss: 0.878776, loss_d: 0.301801
Epoch finished! Loss: 1.5238647846075204
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.450921, loss_ss: 1.098722, loss_d: 0.352199
0.0384 --- loss: 1.739470, loss_ss: 1.322989, loss_d: 0.416481
0.0769 --- loss: 1.292831, loss_ss: 0.859807, loss_d: 0.433024
0.1153 --- loss: 1.396693, loss_ss: 0.968889, loss_d: 0.427804
0.1537 --- loss: 1.060132, loss_ss: 0.774375, loss_d: 0.285757
0.1922 --- loss: 1.152797, loss_ss: 0.721579, loss_d: 0.431218
0.2306 --- loss: 1.895721, loss_ss: 1.445632, loss_d: 0.450089
0.2690 --- loss: 1.364615, loss_ss: 1.012368, loss_d: 0.352247
0.3075 --- loss: 1.099484, loss_ss: 0.785744, loss_d: 0.313739
0.3459 --- loss: 2.157106, loss_ss: 1.391697, loss_d: 0.765409
0.3843 --- loss: 1.505628, loss_ss: 1.256078, loss_d: 0.249550
0.4228 --- loss: 1.900730, loss_ss: 0.935499, loss_d: 0.965232
0.4612 --- loss: 1.565150, loss_ss: 1.093731, loss_d: 0.471419
0.4996 --- loss: 1.732696, loss_ss: 1.137571, loss_d: 0.595126
0.5380 --- loss: 1.365168, loss_ss: 1.003469, loss_d: 0.361699
0.5765 --- loss: 1.669032, loss_ss: 0.919185, loss_d: 0.749847
0.6149 --- loss: 1.761022, loss_ss: 1.113930, loss_d: 0.647092
0.6533 --- loss: 1.723688, loss_ss: 1.235539, loss_d: 0.488149
0.6918 --- loss: 1.622884, loss_ss: 1.196682, loss_d: 0.426202
0.7302 --- loss: 1.359338, loss_ss: 0.925312, loss_d: 0.434025
0.7686 --- loss: 1.941213, loss_ss: 1.374218, loss_d: 0.566995
0.8071 --- loss: 1.400628, loss_ss: 1.080021, loss_d: 0.320607
0.8455 --- loss: 1.331465, loss_ss: 1.085514, loss_d: 0.245951
0.8839 --- loss: 1.550774, loss_ss: 1.301990, loss_d: 0.248784
0.9224 --- loss: 2.008811, loss_ss: 1.346268, loss_d: 0.662543
0.9608 --- loss: 1.515855, loss_ss: 0.969996, loss_d: 0.545858
0.9992 --- loss: 3.949984, loss_ss: 2.141784, loss_d: 1.808200
Epoch finished! Loss: 1.5195727648643347
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5990740740740741
             precision    recall  f1-score   support

        0.0       0.61      0.66      0.63       251
        1.0       0.00      0.00      0.00       147
        2.0       0.79      0.71      0.74       305
        3.0       0.88      0.84      0.86       250
        4.0       0.18      0.43      0.26       127

avg / total       0.59      0.60      0.59      1080
 


====== chp053-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  82.31  66.14   87.21  61.03     63.48
1  86.39   0.00  100.00   0.00      0.00
2  86.30  70.82   92.39  78.55     74.48
3  93.61  84.40   96.39  87.55     85.95
4  71.20  42.52   75.03  18.49     25.78
Total accuracy: 59.91%
Average sen: 52.77%
Average spec: 90.20%
Macro f1-score: 49.94%
pred: 0.4850902855396271, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.277863, loss_ss: 1.575611, loss_d: 0.702252
0.0384 --- loss: 2.559476, loss_ss: 1.707970, loss_d: 0.851506
0.0769 --- loss: 2.382341, loss_ss: 1.691633, loss_d: 0.690708
0.1153 --- loss: 2.225863, loss_ss: 1.611682, loss_d: 0.614181
0.1538 --- loss: 2.242172, loss_ss: 1.702429, loss_d: 0.539742
0.1922 --- loss: 2.431904, loss_ss: 1.664406, loss_d: 0.767498
0.2307 --- loss: 2.039290, loss_ss: 1.579300, loss_d: 0.459991
0.2691 --- loss: 1.900604, loss_ss: 1.561996, loss_d: 0.338608
0.3076 --- loss: 2.092868, loss_ss: 1.662160, loss_d: 0.430709
0.3460 --- loss: 1.804306, loss_ss: 1.510045, loss_d: 0.294261
0.3845 --- loss: 1.984991, loss_ss: 1.607044, loss_d: 0.377947
0.4229 --- loss: 2.208754, loss_ss: 1.587078, loss_d: 0.621675
0.4614 --- loss: 1.933723, loss_ss: 1.515343, loss_d: 0.418379
0.4998 --- loss: 1.947123, loss_ss: 1.505737, loss_d: 0.441386
0.5383 --- loss: 1.767458, loss_ss: 1.508082, loss_d: 0.259376
0.5767 --- loss: 1.810600, loss_ss: 1.570402, loss_d: 0.240197
0.6151 --- loss: 2.077681, loss_ss: 1.607706, loss_d: 0.469975
0.6536 --- loss: 1.884490, loss_ss: 1.459283, loss_d: 0.425207
0.6920 --- loss: 2.340848, loss_ss: 1.554456, loss_d: 0.786393
0.7305 --- loss: 2.053073, loss_ss: 1.409787, loss_d: 0.643286
0.7689 --- loss: 2.144104, loss_ss: 1.537239, loss_d: 0.606865
0.8074 --- loss: 1.952959, loss_ss: 1.478043, loss_d: 0.474915
0.8458 --- loss: 1.835121, loss_ss: 1.448367, loss_d: 0.386755
0.8843 --- loss: 1.960058, loss_ss: 1.489632, loss_d: 0.470426
0.9227 --- loss: 2.224538, loss_ss: 1.424830, loss_d: 0.799708
0.9612 --- loss: 1.982709, loss_ss: 1.477777, loss_d: 0.504933
0.9996 --- loss: 2.604015, loss_ss: 1.307541, loss_d: 1.296475
Epoch finished! Loss: 2.1147763192653657
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.891251, loss_ss: 1.490578, loss_d: 0.400673
0.0384 --- loss: 2.113455, loss_ss: 1.581102, loss_d: 0.532352
0.0769 --- loss: 2.476640, loss_ss: 1.548081, loss_d: 0.928559
0.1153 --- loss: 2.037817, loss_ss: 1.363770, loss_d: 0.674047
0.1538 --- loss: 2.029436, loss_ss: 1.397902, loss_d: 0.631534
0.1922 --- loss: 1.896652, loss_ss: 1.428864, loss_d: 0.467789
0.2307 --- loss: 2.141879, loss_ss: 1.709296, loss_d: 0.432583
0.2691 --- loss: 1.812501, loss_ss: 1.418937, loss_d: 0.393564
0.3076 --- loss: 2.085795, loss_ss: 1.528921, loss_d: 0.556874
0.3460 --- loss: 2.375741, loss_ss: 1.593049, loss_d: 0.782691
0.3845 --- loss: 1.933715, loss_ss: 1.438630, loss_d: 0.495084
0.4229 --- loss: 2.150445, loss_ss: 1.535702, loss_d: 0.614744
0.4614 --- loss: 2.272224, loss_ss: 1.599761, loss_d: 0.672463
0.4998 --- loss: 2.222625, loss_ss: 1.655726, loss_d: 0.566899
0.5383 --- loss: 1.694588, loss_ss: 1.360211, loss_d: 0.334377
0.5767 --- loss: 1.671970, loss_ss: 1.392055, loss_d: 0.279915
0.6151 --- loss: 2.134396, loss_ss: 1.605137, loss_d: 0.529259
0.6536 --- loss: 1.659884, loss_ss: 1.368528, loss_d: 0.291356
0.6920 --- loss: 1.983344, loss_ss: 1.402857, loss_d: 0.580486
0.7305 --- loss: 2.065859, loss_ss: 1.365053, loss_d: 0.700806
0.7689 --- loss: 1.913143, loss_ss: 1.348022, loss_d: 0.565121
0.8074 --- loss: 1.931861, loss_ss: 1.444465, loss_d: 0.487396
0.8458 --- loss: 2.105099, loss_ss: 1.274515, loss_d: 0.830583
0.8843 --- loss: 1.788019, loss_ss: 1.445282, loss_d: 0.342736
0.9227 --- loss: 2.013174, loss_ss: 1.611151, loss_d: 0.402023
0.9612 --- loss: 1.723918, loss_ss: 1.343025, loss_d: 0.380892
0.9996 --- loss: 3.126826, loss_ss: 1.528294, loss_d: 1.598532
Epoch finished! Loss: 1.9923127646629626
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.429883, loss_ss: 1.383559, loss_d: 1.046324
0.0384 --- loss: 1.767161, loss_ss: 1.186017, loss_d: 0.581144
0.0769 --- loss: 1.674999, loss_ss: 1.205539, loss_d: 0.469461
0.1153 --- loss: 1.754494, loss_ss: 1.298445, loss_d: 0.456049
0.1538 --- loss: 2.064216, loss_ss: 1.528349, loss_d: 0.535867
0.1922 --- loss: 1.713616, loss_ss: 1.327236, loss_d: 0.386381
0.2307 --- loss: 1.712519, loss_ss: 1.396795, loss_d: 0.315724
0.2691 --- loss: 1.695594, loss_ss: 1.374601, loss_d: 0.320993
0.3076 --- loss: 1.723295, loss_ss: 1.260284, loss_d: 0.463011
0.3460 --- loss: 1.644837, loss_ss: 1.163897, loss_d: 0.480940
0.3845 --- loss: 1.500896, loss_ss: 1.164744, loss_d: 0.336152
0.4229 --- loss: 1.661985, loss_ss: 1.313954, loss_d: 0.348031
0.4614 --- loss: 1.951521, loss_ss: 1.312175, loss_d: 0.639346
0.4998 --- loss: 1.734930, loss_ss: 1.396831, loss_d: 0.338099
0.5383 --- loss: 1.803355, loss_ss: 1.227511, loss_d: 0.575844
0.5767 --- loss: 1.946844, loss_ss: 1.325325, loss_d: 0.621520
0.6151 --- loss: 2.223166, loss_ss: 1.592648, loss_d: 0.630517
0.6536 --- loss: 2.326870, loss_ss: 1.615922, loss_d: 0.710948
0.6920 --- loss: 1.511474, loss_ss: 1.180072, loss_d: 0.331403
0.7305 --- loss: 1.806506, loss_ss: 1.428903, loss_d: 0.377602
0.7689 --- loss: 1.439416, loss_ss: 1.044688, loss_d: 0.394729
0.8074 --- loss: 2.104791, loss_ss: 1.448999, loss_d: 0.655793
0.8458 --- loss: 1.631929, loss_ss: 1.323827, loss_d: 0.308102
0.8843 --- loss: 1.704749, loss_ss: 1.300554, loss_d: 0.404195
0.9227 --- loss: 1.954805, loss_ss: 1.333584, loss_d: 0.621220
0.9612 --- loss: 1.919891, loss_ss: 1.650761, loss_d: 0.269130
0.9996 --- loss: 1.217563, loss_ss: 1.091717, loss_d: 0.125846
Epoch finished! Loss: 1.8597504152701452
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.732782, loss_ss: 1.337723, loss_d: 0.395059
0.0384 --- loss: 1.699985, loss_ss: 1.324369, loss_d: 0.375616
0.0769 --- loss: 1.827936, loss_ss: 1.305004, loss_d: 0.522932
0.1153 --- loss: 1.500381, loss_ss: 1.131292, loss_d: 0.369089
0.1538 --- loss: 1.742030, loss_ss: 1.189981, loss_d: 0.552049
0.1922 --- loss: 1.403891, loss_ss: 1.081643, loss_d: 0.322248
0.2307 --- loss: 1.785622, loss_ss: 1.148946, loss_d: 0.636677
0.2691 --- loss: 1.481619, loss_ss: 1.049350, loss_d: 0.432269
0.3076 --- loss: 1.838673, loss_ss: 1.218646, loss_d: 0.620027
0.3460 --- loss: 1.683976, loss_ss: 1.161919, loss_d: 0.522057
0.3845 --- loss: 1.692323, loss_ss: 1.344474, loss_d: 0.347849
0.4229 --- loss: 1.489606, loss_ss: 1.058697, loss_d: 0.430910
0.4614 --- loss: 2.449770, loss_ss: 1.859918, loss_d: 0.589853
0.4998 --- loss: 1.505201, loss_ss: 1.101228, loss_d: 0.403974
0.5383 --- loss: 1.556329, loss_ss: 0.993230, loss_d: 0.563098
0.5767 --- loss: 1.674797, loss_ss: 1.246771, loss_d: 0.428026
0.6151 --- loss: 1.928140, loss_ss: 1.274125, loss_d: 0.654015
0.6536 --- loss: 1.636977, loss_ss: 1.185058, loss_d: 0.451919
0.6920 --- loss: 1.685613, loss_ss: 1.160059, loss_d: 0.525554
0.7305 --- loss: 1.777286, loss_ss: 1.138721, loss_d: 0.638565
0.7689 --- loss: 1.767401, loss_ss: 1.236474, loss_d: 0.530926
0.8074 --- loss: 1.491545, loss_ss: 1.234257, loss_d: 0.257288
0.8458 --- loss: 1.609264, loss_ss: 1.206814, loss_d: 0.402450
0.8843 --- loss: 1.915218, loss_ss: 1.227985, loss_d: 0.687233
0.9227 --- loss: 1.505267, loss_ss: 1.098745, loss_d: 0.406523
0.9612 --- loss: 1.558853, loss_ss: 1.231390, loss_d: 0.327463
0.9996 --- loss: 2.118378, loss_ss: 1.957990, loss_d: 0.160388
Epoch finished! Loss: 1.7430291790228623
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.771135, loss_ss: 1.391414, loss_d: 0.379721
0.0384 --- loss: 1.978193, loss_ss: 1.112990, loss_d: 0.865203
0.0769 --- loss: 1.747947, loss_ss: 1.151734, loss_d: 0.596213
0.1153 --- loss: 2.208935, loss_ss: 1.292445, loss_d: 0.916490
0.1538 --- loss: 1.788308, loss_ss: 1.398218, loss_d: 0.390090
0.1922 --- loss: 1.263302, loss_ss: 1.026833, loss_d: 0.236470
0.2307 --- loss: 1.664834, loss_ss: 1.189257, loss_d: 0.475577
0.2691 --- loss: 1.323409, loss_ss: 0.933918, loss_d: 0.389490
0.3076 --- loss: 1.557109, loss_ss: 1.283172, loss_d: 0.273937
0.3460 --- loss: 1.774506, loss_ss: 1.326778, loss_d: 0.447729
0.3845 --- loss: 1.369028, loss_ss: 1.011994, loss_d: 0.357034
0.4229 --- loss: 1.832858, loss_ss: 1.395328, loss_d: 0.437530
0.4614 --- loss: 1.357614, loss_ss: 0.932062, loss_d: 0.425553
0.4998 --- loss: 1.473936, loss_ss: 1.218658, loss_d: 0.255278
0.5383 --- loss: 1.715488, loss_ss: 1.201573, loss_d: 0.513915
0.5767 --- loss: 1.790703, loss_ss: 1.390947, loss_d: 0.399755
0.6151 --- loss: 1.853200, loss_ss: 1.016499, loss_d: 0.836701
0.6536 --- loss: 1.843520, loss_ss: 1.433080, loss_d: 0.410440
0.6920 --- loss: 2.010927, loss_ss: 1.602995, loss_d: 0.407932
0.7305 --- loss: 1.629898, loss_ss: 1.332551, loss_d: 0.297347
0.7689 --- loss: 1.393894, loss_ss: 1.098892, loss_d: 0.295002
0.8074 --- loss: 1.386226, loss_ss: 1.063753, loss_d: 0.322473
0.8458 --- loss: 1.388820, loss_ss: 1.039645, loss_d: 0.349175
0.8843 --- loss: 1.446791, loss_ss: 1.178740, loss_d: 0.268052
0.9227 --- loss: 1.555306, loss_ss: 1.033113, loss_d: 0.522193
0.9612 --- loss: 1.680023, loss_ss: 1.268790, loss_d: 0.411233
0.9996 --- loss: 2.521008, loss_ss: 2.345004, loss_d: 0.176004
Epoch finished! Loss: 1.6688073974389297
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.574713, loss_ss: 1.203430, loss_d: 0.371282
0.0384 --- loss: 1.646242, loss_ss: 1.157065, loss_d: 0.489177
0.0769 --- loss: 1.897096, loss_ss: 1.195422, loss_d: 0.701674
0.1153 --- loss: 1.735833, loss_ss: 1.101750, loss_d: 0.634083
0.1538 --- loss: 2.467886, loss_ss: 1.428367, loss_d: 1.039519
0.1922 --- loss: 1.505095, loss_ss: 0.992082, loss_d: 0.513013
0.2307 --- loss: 1.395483, loss_ss: 1.052426, loss_d: 0.343056
0.2691 --- loss: 1.516899, loss_ss: 1.120145, loss_d: 0.396754
0.3076 --- loss: 1.472052, loss_ss: 1.124094, loss_d: 0.347958
0.3460 --- loss: 1.622288, loss_ss: 0.993437, loss_d: 0.628850
0.3845 --- loss: 1.632549, loss_ss: 0.952666, loss_d: 0.679883
0.4229 --- loss: 1.575425, loss_ss: 1.193086, loss_d: 0.382339
0.4614 --- loss: 1.735509, loss_ss: 1.350125, loss_d: 0.385384
0.4998 --- loss: 1.650226, loss_ss: 0.964640, loss_d: 0.685586
0.5383 --- loss: 1.381954, loss_ss: 1.065419, loss_d: 0.316535
0.5767 --- loss: 1.464984, loss_ss: 1.050710, loss_d: 0.414274
0.6151 --- loss: 1.511566, loss_ss: 1.110282, loss_d: 0.401284
0.6536 --- loss: 1.389188, loss_ss: 1.065507, loss_d: 0.323681
0.6920 --- loss: 1.328333, loss_ss: 1.014487, loss_d: 0.313847
0.7305 --- loss: 1.521996, loss_ss: 1.229905, loss_d: 0.292092
0.7689 --- loss: 1.433506, loss_ss: 1.117701, loss_d: 0.315805
0.8074 --- loss: 1.404089, loss_ss: 1.112483, loss_d: 0.291606
0.8458 --- loss: 1.780499, loss_ss: 1.119467, loss_d: 0.661032
0.8843 --- loss: 1.682395, loss_ss: 1.271947, loss_d: 0.410449
0.9227 --- loss: 1.564226, loss_ss: 1.173990, loss_d: 0.390236
0.9612 --- loss: 1.507246, loss_ss: 1.036583, loss_d: 0.470663
0.9996 --- loss: 2.489929, loss_ss: 0.768110, loss_d: 1.721820
Epoch finished! Loss: 1.607886515213893
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.527062, loss_ss: 1.135085, loss_d: 0.391977
0.0384 --- loss: 1.643699, loss_ss: 1.229983, loss_d: 0.413716
0.0769 --- loss: 1.730730, loss_ss: 1.279340, loss_d: 0.451391
0.1153 --- loss: 1.890242, loss_ss: 1.168474, loss_d: 0.721768
0.1538 --- loss: 1.528678, loss_ss: 1.050399, loss_d: 0.478278
0.1922 --- loss: 1.408644, loss_ss: 0.906671, loss_d: 0.501973
0.2307 --- loss: 1.521729, loss_ss: 1.011681, loss_d: 0.510047
0.2691 --- loss: 1.657183, loss_ss: 1.176913, loss_d: 0.480270
0.3076 --- loss: 1.250871, loss_ss: 1.069142, loss_d: 0.181729
0.3460 --- loss: 1.192302, loss_ss: 0.854409, loss_d: 0.337893
0.3845 --- loss: 1.539831, loss_ss: 1.175631, loss_d: 0.364200
0.4229 --- loss: 1.755126, loss_ss: 1.398390, loss_d: 0.356735
0.4614 --- loss: 1.757977, loss_ss: 1.251778, loss_d: 0.506199
0.4998 --- loss: 1.385831, loss_ss: 1.046345, loss_d: 0.339487
0.5383 --- loss: 1.475957, loss_ss: 1.119127, loss_d: 0.356830
0.5767 --- loss: 1.300601, loss_ss: 0.976111, loss_d: 0.324490
0.6151 --- loss: 1.127760, loss_ss: 0.782406, loss_d: 0.345354
0.6536 --- loss: 1.700416, loss_ss: 1.291972, loss_d: 0.408443
0.6920 --- loss: 1.420606, loss_ss: 1.107034, loss_d: 0.313572
0.7305 --- loss: 1.345289, loss_ss: 1.136804, loss_d: 0.208485
0.7689 --- loss: 1.723833, loss_ss: 1.194561, loss_d: 0.529272
0.8074 --- loss: 1.556749, loss_ss: 1.063239, loss_d: 0.493511
0.8458 --- loss: 1.638093, loss_ss: 1.176544, loss_d: 0.461548
0.8843 --- loss: 1.523301, loss_ss: 1.247201, loss_d: 0.276100
0.9227 --- loss: 1.480748, loss_ss: 1.159586, loss_d: 0.321162
0.9612 --- loss: 1.536494, loss_ss: 1.123295, loss_d: 0.413200
0.9996 --- loss: 1.951591, loss_ss: 1.837431, loss_d: 0.114160
Epoch finished! Loss: 1.5711366667197302
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.410258, loss_ss: 1.114264, loss_d: 0.295993
0.0384 --- loss: 1.471825, loss_ss: 0.971329, loss_d: 0.500496
0.0769 --- loss: 1.435278, loss_ss: 0.858061, loss_d: 0.577217
0.1153 --- loss: 1.358915, loss_ss: 1.079827, loss_d: 0.279088
0.1538 --- loss: 1.533219, loss_ss: 1.090339, loss_d: 0.442881
0.1922 --- loss: 1.233083, loss_ss: 0.968054, loss_d: 0.265029
0.2307 --- loss: 1.478228, loss_ss: 1.100109, loss_d: 0.378119
0.2691 --- loss: 1.299885, loss_ss: 0.947196, loss_d: 0.352689
0.3076 --- loss: 1.853291, loss_ss: 1.471904, loss_d: 0.381387
0.3460 --- loss: 1.815390, loss_ss: 0.949012, loss_d: 0.866379
0.3845 --- loss: 1.508113, loss_ss: 1.252970, loss_d: 0.255144
0.4229 --- loss: 1.394965, loss_ss: 1.093528, loss_d: 0.301437
0.4614 --- loss: 1.651839, loss_ss: 1.278152, loss_d: 0.373687
0.4998 --- loss: 1.633292, loss_ss: 1.174291, loss_d: 0.459001
0.5383 --- loss: 1.639946, loss_ss: 1.152825, loss_d: 0.487121
0.5767 --- loss: 1.676756, loss_ss: 1.208326, loss_d: 0.468430
0.6151 --- loss: 1.227850, loss_ss: 0.949645, loss_d: 0.278206
0.6536 --- loss: 1.703405, loss_ss: 0.833822, loss_d: 0.869583
0.6920 --- loss: 1.668585, loss_ss: 1.097960, loss_d: 0.570625
0.7305 --- loss: 1.769978, loss_ss: 1.031369, loss_d: 0.738609
0.7689 --- loss: 1.376459, loss_ss: 1.096916, loss_d: 0.279543
0.8074 --- loss: 1.400104, loss_ss: 1.128825, loss_d: 0.271278
0.8458 --- loss: 1.198640, loss_ss: 0.810336, loss_d: 0.388303
0.8843 --- loss: 1.718075, loss_ss: 1.405513, loss_d: 0.312562
0.9227 --- loss: 1.315777, loss_ss: 1.077188, loss_d: 0.238589
0.9612 --- loss: 1.300619, loss_ss: 1.046941, loss_d: 0.253678
0.9996 --- loss: 1.370397, loss_ss: 1.205804, loss_d: 0.164593
Epoch finished! Loss: 1.5560349991688363
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.565447, loss_ss: 1.198211, loss_d: 0.367236
0.0384 --- loss: 1.841377, loss_ss: 1.475680, loss_d: 0.365697
0.0769 --- loss: 1.409942, loss_ss: 1.085866, loss_d: 0.324076
0.1153 --- loss: 1.590573, loss_ss: 1.123311, loss_d: 0.467262
0.1538 --- loss: 1.263698, loss_ss: 0.981794, loss_d: 0.281904
0.1922 --- loss: 1.611765, loss_ss: 1.311489, loss_d: 0.300277
0.2307 --- loss: 1.561124, loss_ss: 1.186489, loss_d: 0.374635
0.2691 --- loss: 1.544173, loss_ss: 1.043356, loss_d: 0.500817
0.3076 --- loss: 1.513236, loss_ss: 1.196520, loss_d: 0.316717
0.3460 --- loss: 1.582062, loss_ss: 1.221274, loss_d: 0.360787
0.3845 --- loss: 1.392601, loss_ss: 1.109926, loss_d: 0.282674
0.4229 --- loss: 1.727702, loss_ss: 1.055800, loss_d: 0.671903
0.4614 --- loss: 1.874359, loss_ss: 1.426303, loss_d: 0.448056
0.4998 --- loss: 1.301388, loss_ss: 1.001428, loss_d: 0.299960
0.5383 --- loss: 1.621842, loss_ss: 0.912380, loss_d: 0.709462
0.5767 --- loss: 1.517285, loss_ss: 1.125031, loss_d: 0.392254
0.6151 --- loss: 1.667338, loss_ss: 1.207816, loss_d: 0.459522
0.6536 --- loss: 1.332818, loss_ss: 1.074033, loss_d: 0.258784
0.6920 --- loss: 1.543596, loss_ss: 1.141062, loss_d: 0.402534
0.7305 --- loss: 1.735125, loss_ss: 1.346115, loss_d: 0.389010
0.7689 --- loss: 1.292966, loss_ss: 0.943620, loss_d: 0.349346
0.8074 --- loss: 1.182211, loss_ss: 0.766912, loss_d: 0.415298
0.8458 --- loss: 1.401332, loss_ss: 0.971820, loss_d: 0.429513
0.8843 --- loss: 1.339656, loss_ss: 0.992062, loss_d: 0.347594
0.9227 --- loss: 1.695382, loss_ss: 1.288638, loss_d: 0.406744
0.9612 --- loss: 1.974089, loss_ss: 1.582392, loss_d: 0.391696
0.9996 --- loss: 2.073569, loss_ss: 1.962031, loss_d: 0.111538
Epoch finished! Loss: 1.5195942025918228
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.555069, loss_ss: 1.006170, loss_d: 0.548899
0.0384 --- loss: 1.676342, loss_ss: 1.397329, loss_d: 0.279013
0.0769 --- loss: 1.184225, loss_ss: 0.938326, loss_d: 0.245899
0.1153 --- loss: 1.576518, loss_ss: 0.909050, loss_d: 0.667468
0.1538 --- loss: 1.241171, loss_ss: 0.929909, loss_d: 0.311262
0.1922 --- loss: 1.274626, loss_ss: 0.906074, loss_d: 0.368551
0.2307 --- loss: 1.543245, loss_ss: 1.218854, loss_d: 0.324392
0.2691 --- loss: 1.615580, loss_ss: 0.959151, loss_d: 0.656430
0.3076 --- loss: 1.389222, loss_ss: 1.160157, loss_d: 0.229065
0.3460 --- loss: 2.002382, loss_ss: 1.094191, loss_d: 0.908191
0.3845 --- loss: 1.148366, loss_ss: 0.905524, loss_d: 0.242842
0.4229 --- loss: 1.547939, loss_ss: 1.239326, loss_d: 0.308613
0.4614 --- loss: 1.591748, loss_ss: 1.003853, loss_d: 0.587895
0.4998 --- loss: 1.402067, loss_ss: 1.074365, loss_d: 0.327702
0.5383 --- loss: 1.372947, loss_ss: 0.972060, loss_d: 0.400887
0.5767 --- loss: 1.843151, loss_ss: 1.594307, loss_d: 0.248845
0.6151 --- loss: 1.391892, loss_ss: 1.027836, loss_d: 0.364055
0.6536 --- loss: 1.191852, loss_ss: 0.920524, loss_d: 0.271328
0.6920 --- loss: 1.324443, loss_ss: 1.093577, loss_d: 0.230866
0.7305 --- loss: 1.495945, loss_ss: 1.223277, loss_d: 0.272668
0.7689 --- loss: 1.434570, loss_ss: 1.119133, loss_d: 0.315437
0.8074 --- loss: 1.512094, loss_ss: 1.219835, loss_d: 0.292260
0.8458 --- loss: 1.670075, loss_ss: 1.106419, loss_d: 0.563657
0.8843 --- loss: 1.513033, loss_ss: 1.222003, loss_d: 0.291029
0.9227 --- loss: 1.193163, loss_ss: 0.918296, loss_d: 0.274867
0.9612 --- loss: 1.505034, loss_ss: 0.770993, loss_d: 0.734041
0.9996 --- loss: 1.335273, loss_ss: 1.161115, loss_d: 0.174158
Epoch finished! Loss: 1.4914031473489908
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.17477477477477477
             precision    recall  f1-score   support

        0.0       0.79      0.38      0.51       231
        1.0       0.00      0.00      0.00        92
        2.0       0.13      0.01      0.03       472
        3.0       0.10      1.00      0.19        99
        4.0       0.00      0.00      0.00       216

avg / total       0.23      0.17      0.14      1110
 


====== chp054-nsrr ======

The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  85.05   38.10   97.38  79.28     51.46
1  91.62    0.00   99.90   0.00      0.00
2  53.87    1.48   92.63  12.96      2.66
3  23.87  100.00   16.42  10.49     18.98
4  80.54    0.00  100.00   0.00      0.00
Total accuracy: 17.48%
Average sen: 27.92%
Average spec: 81.27%
Macro f1-score: 14.62%
[0.99986029 0.99975485 0.99976867 0.99984348 0.99987435 0.99976689
 0.99989569 0.99974185 0.99981564 0.99988961 0.99981409 0.99976891
 0.99981374 0.99982965 0.9998098  0.99979287 0.99976259 0.99974066
 0.99981958 0.99982017 0.99988747 0.99986351 0.99979132 0.99975318
 0.99980098 0.99985504 0.99985588 0.99983168 0.99989855 0.99993193
 0.99996209 0.99982798 0.99979275 0.99977344 0.99983442 0.9998697
 0.99978536]
pred: 0.9998242887290748, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.510708, loss_ss: 1.672388, loss_d: 0.838320
0.0384 --- loss: 2.595613, loss_ss: 1.817070, loss_d: 0.778543
0.0769 --- loss: 2.174331, loss_ss: 1.592083, loss_d: 0.582248
0.1153 --- loss: 1.918729, loss_ss: 1.574790, loss_d: 0.343939
0.1538 --- loss: 2.252825, loss_ss: 1.558729, loss_d: 0.694096
0.1922 --- loss: 2.013731, loss_ss: 1.604049, loss_d: 0.409682
0.2307 --- loss: 2.076035, loss_ss: 1.559558, loss_d: 0.516477
0.2691 --- loss: 2.200627, loss_ss: 1.545090, loss_d: 0.655537
0.3076 --- loss: 2.150851, loss_ss: 1.707243, loss_d: 0.443607
0.3460 --- loss: 2.108937, loss_ss: 1.532986, loss_d: 0.575951
0.3845 --- loss: 2.165664, loss_ss: 1.601696, loss_d: 0.563968
0.4229 --- loss: 1.802763, loss_ss: 1.361285, loss_d: 0.441478
0.4614 --- loss: 2.130774, loss_ss: 1.560136, loss_d: 0.570638
0.4998 --- loss: 1.864985, loss_ss: 1.417691, loss_d: 0.447293
0.5383 --- loss: 2.009860, loss_ss: 1.628516, loss_d: 0.381345
0.5767 --- loss: 2.026621, loss_ss: 1.700442, loss_d: 0.326180
0.6151 --- loss: 2.155236, loss_ss: 1.571898, loss_d: 0.583338
0.6536 --- loss: 2.239285, loss_ss: 1.376636, loss_d: 0.862650
0.6920 --- loss: 2.066535, loss_ss: 1.379029, loss_d: 0.687506
0.7305 --- loss: 1.756412, loss_ss: 1.384537, loss_d: 0.371875
0.7689 --- loss: 1.996286, loss_ss: 1.266535, loss_d: 0.729751
0.8074 --- loss: 2.083151, loss_ss: 1.554737, loss_d: 0.528414
0.8458 --- loss: 1.888292, loss_ss: 1.500170, loss_d: 0.388122
0.8843 --- loss: 1.860330, loss_ss: 1.445587, loss_d: 0.414743
0.9227 --- loss: 2.198274, loss_ss: 1.390103, loss_d: 0.808171
0.9612 --- loss: 2.290846, loss_ss: 1.488369, loss_d: 0.802477
0.9996 --- loss: 1.989100, loss_ss: 1.481903, loss_d: 0.507197
Epoch finished! Loss: 2.097656951500819
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.225371, loss_ss: 1.490707, loss_d: 0.734664
0.0384 --- loss: 1.925071, loss_ss: 1.431574, loss_d: 0.493498
0.0769 --- loss: 1.894153, loss_ss: 1.505798, loss_d: 0.388355
0.1153 --- loss: 2.011121, loss_ss: 1.473937, loss_d: 0.537183
0.1538 --- loss: 1.786443, loss_ss: 1.343104, loss_d: 0.443340
0.1922 --- loss: 1.888632, loss_ss: 1.448572, loss_d: 0.440060
0.2307 --- loss: 2.409097, loss_ss: 1.544678, loss_d: 0.864419
0.2691 --- loss: 1.916096, loss_ss: 1.460555, loss_d: 0.455541
0.3076 --- loss: 1.782919, loss_ss: 1.322074, loss_d: 0.460845
0.3460 --- loss: 1.677742, loss_ss: 1.205367, loss_d: 0.472375
0.3845 --- loss: 2.383132, loss_ss: 1.621697, loss_d: 0.761435
0.4229 --- loss: 2.065628, loss_ss: 1.552240, loss_d: 0.513387
0.4614 --- loss: 1.830714, loss_ss: 1.426338, loss_d: 0.404376
0.4998 --- loss: 2.256785, loss_ss: 1.533733, loss_d: 0.723052
0.5383 --- loss: 1.995126, loss_ss: 1.470077, loss_d: 0.525050
0.5767 --- loss: 2.160266, loss_ss: 1.353016, loss_d: 0.807251
0.6151 --- loss: 2.044069, loss_ss: 1.507501, loss_d: 0.536568
0.6536 --- loss: 1.856638, loss_ss: 1.431935, loss_d: 0.424703
0.6920 --- loss: 1.725215, loss_ss: 1.354420, loss_d: 0.370795
0.7305 --- loss: 1.815504, loss_ss: 1.490060, loss_d: 0.325444
0.7689 --- loss: 1.866134, loss_ss: 1.401498, loss_d: 0.464636
0.8074 --- loss: 1.787650, loss_ss: 1.368046, loss_d: 0.419603
0.8458 --- loss: 1.984519, loss_ss: 1.602996, loss_d: 0.381523
0.8843 --- loss: 2.476829, loss_ss: 1.463242, loss_d: 1.013587
0.9227 --- loss: 1.980876, loss_ss: 1.606526, loss_d: 0.374349
0.9612 --- loss: 1.819371, loss_ss: 1.392661, loss_d: 0.426710
0.9996 --- loss: 2.035773, loss_ss: 1.801786, loss_d: 0.233987
Epoch finished! Loss: 1.9733678423441374
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.891101, loss_ss: 1.412931, loss_d: 0.478170
0.0384 --- loss: 1.633828, loss_ss: 1.350366, loss_d: 0.283462
0.0769 --- loss: 1.902335, loss_ss: 1.585114, loss_d: 0.317221
0.1153 --- loss: 1.786506, loss_ss: 1.309184, loss_d: 0.477323
0.1538 --- loss: 2.102678, loss_ss: 1.502306, loss_d: 0.600372
0.1922 --- loss: 1.970665, loss_ss: 1.542400, loss_d: 0.428265
0.2307 --- loss: 2.191614, loss_ss: 1.498533, loss_d: 0.693080
0.2691 --- loss: 1.844047, loss_ss: 1.477663, loss_d: 0.366384
0.3076 --- loss: 1.841089, loss_ss: 1.511012, loss_d: 0.330076
0.3460 --- loss: 1.883660, loss_ss: 1.299850, loss_d: 0.583810
0.3845 --- loss: 2.061569, loss_ss: 1.410204, loss_d: 0.651365
0.4229 --- loss: 2.232959, loss_ss: 1.567205, loss_d: 0.665754
0.4614 --- loss: 2.098757, loss_ss: 1.402757, loss_d: 0.696000
0.4998 --- loss: 2.075522, loss_ss: 1.617694, loss_d: 0.457827
0.5383 --- loss: 1.840190, loss_ss: 1.214542, loss_d: 0.625648
0.5767 --- loss: 1.723886, loss_ss: 1.296576, loss_d: 0.427311
0.6151 --- loss: 1.983506, loss_ss: 1.559505, loss_d: 0.424001
0.6536 --- loss: 1.844944, loss_ss: 1.327428, loss_d: 0.517515
0.6920 --- loss: 1.885714, loss_ss: 1.325758, loss_d: 0.559956
0.7305 --- loss: 1.993276, loss_ss: 1.173478, loss_d: 0.819798
0.7689 --- loss: 2.053332, loss_ss: 1.379353, loss_d: 0.673979
0.8074 --- loss: 2.486073, loss_ss: 1.376525, loss_d: 1.109548
0.8458 --- loss: 2.083828, loss_ss: 1.555022, loss_d: 0.528806
0.8843 --- loss: 1.694671, loss_ss: 1.277934, loss_d: 0.416737
0.9227 --- loss: 2.022035, loss_ss: 1.377782, loss_d: 0.644252
0.9612 --- loss: 1.745167, loss_ss: 1.302387, loss_d: 0.442780
0.9996 --- loss: 2.498780, loss_ss: 2.012349, loss_d: 0.486431
Epoch finished! Loss: 1.943576660981545
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.963618, loss_ss: 1.414285, loss_d: 0.549333
0.0384 --- loss: 1.746896, loss_ss: 1.246971, loss_d: 0.499924
0.0769 --- loss: 2.032644, loss_ss: 1.528595, loss_d: 0.504049
0.1153 --- loss: 2.693907, loss_ss: 1.494496, loss_d: 1.199411
0.1538 --- loss: 1.834326, loss_ss: 1.287198, loss_d: 0.547128
0.1922 --- loss: 1.689144, loss_ss: 1.340167, loss_d: 0.348977
0.2307 --- loss: 1.649924, loss_ss: 1.248095, loss_d: 0.401829
0.2691 --- loss: 1.987289, loss_ss: 1.547292, loss_d: 0.439997
0.3076 --- loss: 2.052532, loss_ss: 1.619365, loss_d: 0.433167
0.3460 --- loss: 1.977215, loss_ss: 1.406076, loss_d: 0.571139
0.3845 --- loss: 1.847337, loss_ss: 1.409727, loss_d: 0.437610
0.4229 --- loss: 1.896512, loss_ss: 1.494348, loss_d: 0.402164
0.4614 --- loss: 2.223387, loss_ss: 1.276961, loss_d: 0.946427
0.4998 --- loss: 1.969073, loss_ss: 1.367477, loss_d: 0.601596
0.5383 --- loss: 1.727773, loss_ss: 1.335148, loss_d: 0.392625
0.5767 --- loss: 1.637014, loss_ss: 1.200135, loss_d: 0.436879
0.6151 --- loss: 1.691923, loss_ss: 1.236371, loss_d: 0.455552
0.6536 --- loss: 1.642624, loss_ss: 1.333983, loss_d: 0.308641
0.6920 --- loss: 1.799984, loss_ss: 1.175490, loss_d: 0.624494
0.7305 --- loss: 1.635865, loss_ss: 1.242868, loss_d: 0.392997
0.7689 --- loss: 1.839367, loss_ss: 1.347978, loss_d: 0.491389
0.8074 --- loss: 2.226532, loss_ss: 1.491601, loss_d: 0.734930
0.8458 --- loss: 1.792469, loss_ss: 1.314071, loss_d: 0.478397
0.8843 --- loss: 1.669524, loss_ss: 1.285887, loss_d: 0.383637
0.9227 --- loss: 2.304355, loss_ss: 1.277954, loss_d: 1.026400
0.9612 --- loss: 1.835150, loss_ss: 1.291473, loss_d: 0.543677
0.9996 --- loss: 2.272903, loss_ss: 1.901762, loss_d: 0.371141
Epoch finished! Loss: 1.866991373208853
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.788327, loss_ss: 1.375655, loss_d: 0.412672
0.0384 --- loss: 1.462327, loss_ss: 1.093948, loss_d: 0.368379
0.0769 --- loss: 1.840394, loss_ss: 1.293954, loss_d: 0.546440
0.1153 --- loss: 1.671139, loss_ss: 1.245501, loss_d: 0.425639
0.1538 --- loss: 2.011887, loss_ss: 1.456864, loss_d: 0.555023
0.1922 --- loss: 1.769635, loss_ss: 1.300601, loss_d: 0.469034
0.2307 --- loss: 1.582414, loss_ss: 1.215874, loss_d: 0.366541
0.2691 --- loss: 1.802256, loss_ss: 1.266252, loss_d: 0.536004
0.3076 --- loss: 2.118116, loss_ss: 1.362830, loss_d: 0.755286
0.3460 --- loss: 1.534847, loss_ss: 1.081470, loss_d: 0.453377
0.3845 --- loss: 2.000662, loss_ss: 1.668643, loss_d: 0.332019
0.4229 --- loss: 1.754997, loss_ss: 1.324006, loss_d: 0.430992
0.4614 --- loss: 2.515334, loss_ss: 1.323579, loss_d: 1.191755
0.4998 --- loss: 1.603135, loss_ss: 1.245497, loss_d: 0.357639
0.5383 --- loss: 1.736110, loss_ss: 1.303719, loss_d: 0.432391
0.5767 --- loss: 1.718352, loss_ss: 1.223175, loss_d: 0.495177
0.6151 --- loss: 1.587989, loss_ss: 1.140515, loss_d: 0.447474
0.6536 --- loss: 1.915795, loss_ss: 1.332631, loss_d: 0.583164
0.6920 --- loss: 1.684403, loss_ss: 1.215465, loss_d: 0.468938
0.7305 --- loss: 1.721619, loss_ss: 1.266580, loss_d: 0.455039
0.7689 --- loss: 1.769283, loss_ss: 1.232188, loss_d: 0.537095
0.8074 --- loss: 1.595330, loss_ss: 1.090096, loss_d: 0.505234
0.8458 --- loss: 1.539307, loss_ss: 1.076584, loss_d: 0.462723
0.8843 --- loss: 1.826599, loss_ss: 1.203401, loss_d: 0.623198
0.9227 --- loss: 1.768861, loss_ss: 1.412961, loss_d: 0.355899
0.9612 --- loss: 1.556542, loss_ss: 1.150597, loss_d: 0.405945
0.9996 --- loss: 2.493858, loss_ss: 2.224606, loss_d: 0.269252
Epoch finished! Loss: 1.8142288932433495
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.674085, loss_ss: 1.211324, loss_d: 0.462761
0.0384 --- loss: 1.705287, loss_ss: 1.134752, loss_d: 0.570535
0.0769 --- loss: 1.508906, loss_ss: 1.117521, loss_d: 0.391385
0.1153 --- loss: 1.820229, loss_ss: 1.365516, loss_d: 0.454713
0.1538 --- loss: 2.169544, loss_ss: 1.374488, loss_d: 0.795056
0.1922 --- loss: 1.656485, loss_ss: 1.192889, loss_d: 0.463596
0.2307 --- loss: 2.005389, loss_ss: 1.544870, loss_d: 0.460519
0.2691 --- loss: 1.880357, loss_ss: 1.287076, loss_d: 0.593281
0.3076 --- loss: 1.502962, loss_ss: 1.035645, loss_d: 0.467317
0.3460 --- loss: 1.633132, loss_ss: 1.049556, loss_d: 0.583576
0.3845 --- loss: 1.670884, loss_ss: 1.301756, loss_d: 0.369128
0.4229 --- loss: 1.605044, loss_ss: 1.240831, loss_d: 0.364213
0.4614 --- loss: 1.761874, loss_ss: 1.358290, loss_d: 0.403584
0.4998 --- loss: 1.643162, loss_ss: 1.222003, loss_d: 0.421160
0.5383 --- loss: 1.758157, loss_ss: 1.445315, loss_d: 0.312842
0.5767 --- loss: 1.534831, loss_ss: 1.141330, loss_d: 0.393501
0.6151 --- loss: 1.735144, loss_ss: 1.217700, loss_d: 0.517444
0.6536 --- loss: 1.648704, loss_ss: 1.030412, loss_d: 0.618292
0.6920 --- loss: 1.587606, loss_ss: 1.121340, loss_d: 0.466266
0.7305 --- loss: 1.872933, loss_ss: 1.205515, loss_d: 0.667418
0.7689 --- loss: 1.856028, loss_ss: 1.106185, loss_d: 0.749843
0.8074 --- loss: 1.499986, loss_ss: 1.142706, loss_d: 0.357280
0.8458 --- loss: 1.854626, loss_ss: 1.421837, loss_d: 0.432788
0.8843 --- loss: 1.754442, loss_ss: 1.255598, loss_d: 0.498844
0.9227 --- loss: 1.524472, loss_ss: 1.011359, loss_d: 0.513113
0.9612 --- loss: 1.619958, loss_ss: 1.225370, loss_d: 0.394588
0.9996 --- loss: 1.556430, loss_ss: 1.340485, loss_d: 0.215945
Epoch finished! Loss: 1.7575398578093602
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.532131, loss_ss: 1.164430, loss_d: 0.367701
0.0384 --- loss: 1.937559, loss_ss: 1.159598, loss_d: 0.777961
0.0769 --- loss: 1.543265, loss_ss: 1.200877, loss_d: 0.342388
0.1153 --- loss: 1.626131, loss_ss: 1.236308, loss_d: 0.389824
0.1538 --- loss: 1.580774, loss_ss: 1.114218, loss_d: 0.466556
0.1922 --- loss: 1.603199, loss_ss: 1.202636, loss_d: 0.400563
0.2307 --- loss: 1.756299, loss_ss: 1.317348, loss_d: 0.438951
0.2691 --- loss: 1.499783, loss_ss: 1.172453, loss_d: 0.327330
0.3076 --- loss: 1.564955, loss_ss: 1.194983, loss_d: 0.369972
0.3460 --- loss: 2.025570, loss_ss: 1.324875, loss_d: 0.700695
0.3845 --- loss: 2.129314, loss_ss: 1.110423, loss_d: 1.018892
0.4229 --- loss: 1.546276, loss_ss: 1.169121, loss_d: 0.377155
0.4614 --- loss: 1.614073, loss_ss: 1.184328, loss_d: 0.429744
0.4998 --- loss: 1.747640, loss_ss: 1.293505, loss_d: 0.454135
0.5383 --- loss: 1.787664, loss_ss: 1.306334, loss_d: 0.481330
0.5767 --- loss: 1.963856, loss_ss: 1.272749, loss_d: 0.691107
0.6151 --- loss: 1.537260, loss_ss: 1.187760, loss_d: 0.349500
0.6536 --- loss: 1.590949, loss_ss: 1.010672, loss_d: 0.580277
0.6920 --- loss: 1.637701, loss_ss: 1.197570, loss_d: 0.440131
0.7305 --- loss: 1.410523, loss_ss: 1.035423, loss_d: 0.375100
0.7689 --- loss: 1.533868, loss_ss: 1.224046, loss_d: 0.309821
0.8074 --- loss: 1.991874, loss_ss: 1.225553, loss_d: 0.766321
0.8458 --- loss: 1.605864, loss_ss: 1.151917, loss_d: 0.453947
0.8843 --- loss: 1.653319, loss_ss: 1.271353, loss_d: 0.381966
0.9227 --- loss: 1.780585, loss_ss: 1.315058, loss_d: 0.465527
0.9612 --- loss: 1.449260, loss_ss: 1.069557, loss_d: 0.379703
0.9996 --- loss: 1.229014, loss_ss: 1.034005, loss_d: 0.195009
Epoch finished! Loss: 1.7006211179953354
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.831947, loss_ss: 1.415960, loss_d: 0.415987
0.0384 --- loss: 1.586201, loss_ss: 1.250305, loss_d: 0.335895
0.0769 --- loss: 1.489407, loss_ss: 1.223137, loss_d: 0.266270
0.1153 --- loss: 1.685940, loss_ss: 1.106060, loss_d: 0.579880
0.1538 --- loss: 1.422599, loss_ss: 0.942096, loss_d: 0.480503
0.1922 --- loss: 1.580390, loss_ss: 1.184881, loss_d: 0.395509
0.2307 --- loss: 1.511349, loss_ss: 1.042904, loss_d: 0.468445
0.2691 --- loss: 1.755781, loss_ss: 1.422034, loss_d: 0.333746
0.3076 --- loss: 1.886518, loss_ss: 1.433574, loss_d: 0.452944
0.3460 --- loss: 1.500366, loss_ss: 1.204135, loss_d: 0.296230
0.3845 --- loss: 1.862792, loss_ss: 1.330181, loss_d: 0.532611
0.4229 --- loss: 1.484236, loss_ss: 1.091415, loss_d: 0.392821
0.4614 --- loss: 1.472438, loss_ss: 1.170148, loss_d: 0.302289
0.4998 --- loss: 1.672776, loss_ss: 1.238353, loss_d: 0.434423
0.5383 --- loss: 1.593406, loss_ss: 1.052125, loss_d: 0.541280
0.5767 --- loss: 1.582789, loss_ss: 1.168151, loss_d: 0.414637
0.6151 --- loss: 1.613642, loss_ss: 1.170584, loss_d: 0.443058
0.6536 --- loss: 2.174249, loss_ss: 1.074430, loss_d: 1.099819
0.6920 --- loss: 1.775856, loss_ss: 1.379802, loss_d: 0.396054
0.7305 --- loss: 1.584736, loss_ss: 1.151253, loss_d: 0.433483
0.7689 --- loss: 2.079948, loss_ss: 1.391091, loss_d: 0.688857
0.8074 --- loss: 1.633248, loss_ss: 1.238954, loss_d: 0.394293
0.8458 --- loss: 1.486146, loss_ss: 1.055832, loss_d: 0.430314
0.8843 --- loss: 1.496696, loss_ss: 1.205355, loss_d: 0.291341
0.9227 --- loss: 1.339260, loss_ss: 0.997704, loss_d: 0.341556
0.9612 --- loss: 1.754184, loss_ss: 1.391843, loss_d: 0.362341
0.9996 --- loss: 2.467259, loss_ss: 2.193028, loss_d: 0.274231
Epoch finished! Loss: 1.663010778793922
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.434542, loss_ss: 1.031534, loss_d: 0.403008
0.0384 --- loss: 1.700444, loss_ss: 1.143255, loss_d: 0.557189
0.0769 --- loss: 1.351511, loss_ss: 0.896842, loss_d: 0.454669
0.1153 --- loss: 1.485659, loss_ss: 1.060912, loss_d: 0.424747
0.1538 --- loss: 1.402411, loss_ss: 1.080731, loss_d: 0.321679
0.1922 --- loss: 1.568929, loss_ss: 1.234723, loss_d: 0.334206
0.2307 --- loss: 1.440332, loss_ss: 1.052667, loss_d: 0.387665
0.2691 --- loss: 1.355392, loss_ss: 1.007465, loss_d: 0.347927
0.3076 --- loss: 1.511720, loss_ss: 1.145772, loss_d: 0.365949
0.3460 --- loss: 1.617402, loss_ss: 1.081944, loss_d: 0.535458
0.3845 --- loss: 1.644375, loss_ss: 1.206221, loss_d: 0.438155
0.4229 --- loss: 1.742621, loss_ss: 1.326304, loss_d: 0.416318
0.4614 --- loss: 1.461252, loss_ss: 1.037625, loss_d: 0.423628
0.4998 --- loss: 2.162449, loss_ss: 1.446876, loss_d: 0.715573
0.5383 --- loss: 1.498715, loss_ss: 1.171751, loss_d: 0.326964
0.5767 --- loss: 1.604026, loss_ss: 1.251387, loss_d: 0.352639
0.6151 --- loss: 1.838187, loss_ss: 1.410797, loss_d: 0.427391
0.6536 --- loss: 1.337109, loss_ss: 0.983434, loss_d: 0.353674
0.6920 --- loss: 1.721609, loss_ss: 1.358883, loss_d: 0.362726
0.7305 --- loss: 1.581157, loss_ss: 1.129589, loss_d: 0.451568
0.7689 --- loss: 1.931822, loss_ss: 1.240406, loss_d: 0.691416
0.8074 --- loss: 1.481424, loss_ss: 1.172290, loss_d: 0.309134
0.8458 --- loss: 1.466875, loss_ss: 1.168487, loss_d: 0.298387
0.8843 --- loss: 1.546283, loss_ss: 1.271349, loss_d: 0.274934
0.9227 --- loss: 1.339752, loss_ss: 1.048535, loss_d: 0.291217
0.9612 --- loss: 1.587583, loss_ss: 1.164787, loss_d: 0.422796
0.9996 --- loss: 2.835051, loss_ss: 1.428477, loss_d: 1.406574
Epoch finished! Loss: 1.6257401507634384
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.673697, loss_ss: 1.154620, loss_d: 0.519077
0.0384 --- loss: 1.477257, loss_ss: 1.011115, loss_d: 0.466142
0.0769 --- loss: 1.484922, loss_ss: 1.162629, loss_d: 0.322292
0.1153 --- loss: 1.277126, loss_ss: 0.962444, loss_d: 0.314682
0.1538 --- loss: 1.357489, loss_ss: 1.038599, loss_d: 0.318890
0.1922 --- loss: 1.649448, loss_ss: 0.926087, loss_d: 0.723361
0.2307 --- loss: 1.297776, loss_ss: 0.945692, loss_d: 0.352085
0.2691 --- loss: 1.866435, loss_ss: 1.559806, loss_d: 0.306629
0.3076 --- loss: 1.830176, loss_ss: 1.374938, loss_d: 0.455238
0.3460 --- loss: 1.626524, loss_ss: 1.097017, loss_d: 0.529508
0.3845 --- loss: 1.803885, loss_ss: 1.304212, loss_d: 0.499673
0.4229 --- loss: 1.434110, loss_ss: 1.062259, loss_d: 0.371850
0.4614 --- loss: 1.506644, loss_ss: 1.013522, loss_d: 0.493122
0.4998 --- loss: 1.737020, loss_ss: 1.138118, loss_d: 0.598902
0.5383 --- loss: 1.511045, loss_ss: 1.197035, loss_d: 0.314010
0.5767 --- loss: 1.630520, loss_ss: 1.144040, loss_d: 0.486480
0.6151 --- loss: 1.533915, loss_ss: 1.053246, loss_d: 0.480669
0.6536 --- loss: 1.316262, loss_ss: 0.978590, loss_d: 0.337672
0.6920 --- loss: 1.814720, loss_ss: 1.018495, loss_d: 0.796225
0.7305 --- loss: 1.699304, loss_ss: 1.424980, loss_d: 0.274324
0.7689 --- loss: 1.663806, loss_ss: 1.093156, loss_d: 0.570650
0.8074 --- loss: 1.670079, loss_ss: 0.913758, loss_d: 0.756322
0.8458 --- loss: 1.704842, loss_ss: 1.294267, loss_d: 0.410575
0.8843 --- loss: 1.214013, loss_ss: 0.930765, loss_d: 0.283247
0.9227 --- loss: 1.354562, loss_ss: 1.047464, loss_d: 0.307098
0.9612 --- loss: 1.830218, loss_ss: 1.393070, loss_d: 0.437149
0.9996 --- loss: 1.513602, loss_ss: 1.310449, loss_d: 0.203153
Epoch finished! Loss: 1.582042528115786
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.1918918918918919
             precision    recall  f1-score   support

        0.0       0.19      1.00      0.32       211
        1.0       0.00      0.00      0.00       184
        2.0       0.00      0.00      0.00       408
        3.0       0.33      0.02      0.03       130
        4.0       0.00      0.00      0.00       177

avg / total       0.08      0.19      0.06      1110
 


====== chp055-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  2  has ZeroDivisionError.


The f1-score of  2  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  19.55  100.00    0.67  19.11     32.09
1  83.42    0.00  100.00   0.00      0.00
2  63.24    0.00  100.00   0.00      0.00
3  88.11    1.54   99.59  33.33      2.94
4  84.05    0.00  100.00   0.00      0.00
Total accuracy: 19.19%
Average sen: 20.31%
Average spec: 80.05%
Macro f1-score: 7.01%
pred: 1.0, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.377961, loss_ss: 1.679789, loss_d: 0.698172
0.0384 --- loss: 2.259346, loss_ss: 1.673304, loss_d: 0.586042
0.0769 --- loss: 2.788189, loss_ss: 1.847546, loss_d: 0.940643
0.1153 --- loss: 1.959717, loss_ss: 1.605030, loss_d: 0.354687
0.1537 --- loss: 2.249339, loss_ss: 1.711810, loss_d: 0.537529
0.1922 --- loss: 2.262038, loss_ss: 1.711783, loss_d: 0.550255
0.2306 --- loss: 1.990658, loss_ss: 1.530636, loss_d: 0.460022
0.2690 --- loss: 1.993525, loss_ss: 1.529726, loss_d: 0.463799
0.3075 --- loss: 2.100767, loss_ss: 1.571154, loss_d: 0.529613
0.3459 --- loss: 2.185688, loss_ss: 1.615026, loss_d: 0.570662
0.3843 --- loss: 2.355682, loss_ss: 1.607936, loss_d: 0.747746
0.4228 --- loss: 1.933348, loss_ss: 1.367344, loss_d: 0.566004
0.4612 --- loss: 1.912943, loss_ss: 1.445592, loss_d: 0.467351
0.4996 --- loss: 1.966482, loss_ss: 1.518358, loss_d: 0.448124
0.5380 --- loss: 1.995431, loss_ss: 1.427393, loss_d: 0.568038
0.5765 --- loss: 2.252497, loss_ss: 1.646725, loss_d: 0.605772
0.6149 --- loss: 1.980433, loss_ss: 1.364812, loss_d: 0.615621
0.6533 --- loss: 2.015544, loss_ss: 1.592230, loss_d: 0.423314
0.6918 --- loss: 1.861269, loss_ss: 1.473197, loss_d: 0.388073
0.7302 --- loss: 1.747801, loss_ss: 1.430370, loss_d: 0.317431
0.7686 --- loss: 1.854903, loss_ss: 1.393085, loss_d: 0.461818
0.8071 --- loss: 2.006741, loss_ss: 1.441608, loss_d: 0.565133
0.8455 --- loss: 2.187265, loss_ss: 1.392535, loss_d: 0.794730
0.8839 --- loss: 1.810364, loss_ss: 1.371565, loss_d: 0.438799
0.9224 --- loss: 1.912368, loss_ss: 1.485699, loss_d: 0.426669
0.9608 --- loss: 2.137477, loss_ss: 1.427258, loss_d: 0.710219
0.9992 --- loss: 2.312722, loss_ss: 1.988679, loss_d: 0.324044
Epoch finished! Loss: 2.0989923655986784
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.147515, loss_ss: 1.645926, loss_d: 0.501589
0.0384 --- loss: 1.943825, loss_ss: 1.508721, loss_d: 0.435103
0.0769 --- loss: 1.944743, loss_ss: 1.598729, loss_d: 0.346014
0.1153 --- loss: 1.985368, loss_ss: 1.664139, loss_d: 0.321229
0.1537 --- loss: 2.245748, loss_ss: 1.618061, loss_d: 0.627687
0.1922 --- loss: 2.195719, loss_ss: 1.524495, loss_d: 0.671223
0.2306 --- loss: 2.060032, loss_ss: 1.595709, loss_d: 0.464323
0.2690 --- loss: 1.975486, loss_ss: 1.466071, loss_d: 0.509414
0.3075 --- loss: 1.815191, loss_ss: 1.373685, loss_d: 0.441506
0.3459 --- loss: 1.954032, loss_ss: 1.491829, loss_d: 0.462203
0.3843 --- loss: 2.626374, loss_ss: 1.480912, loss_d: 1.145461
0.4228 --- loss: 2.160825, loss_ss: 1.472944, loss_d: 0.687881
0.4612 --- loss: 2.124159, loss_ss: 1.418455, loss_d: 0.705704
0.4996 --- loss: 1.986317, loss_ss: 1.547632, loss_d: 0.438685
0.5380 --- loss: 1.995335, loss_ss: 1.370244, loss_d: 0.625091
0.5765 --- loss: 2.096755, loss_ss: 1.652887, loss_d: 0.443867
0.6149 --- loss: 1.779418, loss_ss: 1.403946, loss_d: 0.375471
0.6533 --- loss: 1.782038, loss_ss: 1.390946, loss_d: 0.391092
0.6918 --- loss: 2.013753, loss_ss: 1.531430, loss_d: 0.482322
0.7302 --- loss: 1.998728, loss_ss: 1.520664, loss_d: 0.478064
0.7686 --- loss: 1.900700, loss_ss: 1.312210, loss_d: 0.588490
0.8071 --- loss: 2.017254, loss_ss: 1.394602, loss_d: 0.622652
0.8455 --- loss: 1.901696, loss_ss: 1.368444, loss_d: 0.533252
0.8839 --- loss: 2.159480, loss_ss: 1.338960, loss_d: 0.820520
0.9224 --- loss: 1.768943, loss_ss: 1.234672, loss_d: 0.534271
0.9608 --- loss: 2.067565, loss_ss: 1.375646, loss_d: 0.691919
0.9992 --- loss: 1.747480, loss_ss: 1.523714, loss_d: 0.223766
Epoch finished! Loss: 1.9923300931086907
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.135190, loss_ss: 1.588410, loss_d: 0.546779
0.0384 --- loss: 2.002947, loss_ss: 1.529248, loss_d: 0.473699
0.0769 --- loss: 1.937119, loss_ss: 1.260583, loss_d: 0.676536
0.1153 --- loss: 2.018949, loss_ss: 1.526320, loss_d: 0.492628
0.1537 --- loss: 1.926482, loss_ss: 1.351906, loss_d: 0.574576
0.1922 --- loss: 1.894101, loss_ss: 1.348666, loss_d: 0.545434
0.2306 --- loss: 1.744032, loss_ss: 1.348312, loss_d: 0.395720
0.2690 --- loss: 1.715619, loss_ss: 1.330797, loss_d: 0.384822
0.3075 --- loss: 1.847772, loss_ss: 1.377382, loss_d: 0.470390
0.3459 --- loss: 1.826018, loss_ss: 1.424708, loss_d: 0.401310
0.3843 --- loss: 1.986928, loss_ss: 1.596298, loss_d: 0.390630
0.4228 --- loss: 2.272154, loss_ss: 1.676907, loss_d: 0.595247
0.4612 --- loss: 1.549599, loss_ss: 1.194341, loss_d: 0.355258
0.4996 --- loss: 1.937890, loss_ss: 1.249038, loss_d: 0.688852
0.5380 --- loss: 1.895388, loss_ss: 1.417591, loss_d: 0.477797
0.5765 --- loss: 2.132141, loss_ss: 1.494139, loss_d: 0.638002
0.6149 --- loss: 2.057218, loss_ss: 1.641278, loss_d: 0.415940
0.6533 --- loss: 1.835490, loss_ss: 1.406103, loss_d: 0.429386
0.6918 --- loss: 1.773483, loss_ss: 1.448304, loss_d: 0.325179
0.7302 --- loss: 1.677843, loss_ss: 1.260442, loss_d: 0.417401
0.7686 --- loss: 1.869383, loss_ss: 1.444760, loss_d: 0.424623
0.8071 --- loss: 2.188176, loss_ss: 1.131822, loss_d: 1.056353
0.8455 --- loss: 1.922246, loss_ss: 1.374938, loss_d: 0.547307
0.8839 --- loss: 1.914474, loss_ss: 1.476763, loss_d: 0.437711
0.9224 --- loss: 1.810426, loss_ss: 1.381723, loss_d: 0.428704
0.9608 --- loss: 1.909159, loss_ss: 1.328342, loss_d: 0.580817
0.9992 --- loss: 1.896699, loss_ss: 1.336609, loss_d: 0.560090
Epoch finished! Loss: 1.9429417779812446
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.819836, loss_ss: 1.368736, loss_d: 0.451100
0.0384 --- loss: 1.874235, loss_ss: 1.423101, loss_d: 0.451134
0.0769 --- loss: 2.723374, loss_ss: 1.678437, loss_d: 1.044936
0.1153 --- loss: 2.675797, loss_ss: 1.508832, loss_d: 1.166965
0.1537 --- loss: 1.849538, loss_ss: 1.326690, loss_d: 0.522847
0.1922 --- loss: 1.909625, loss_ss: 1.322479, loss_d: 0.587146
0.2306 --- loss: 1.576177, loss_ss: 1.289868, loss_d: 0.286309
0.2690 --- loss: 2.078836, loss_ss: 1.723963, loss_d: 0.354873
0.3075 --- loss: 1.752612, loss_ss: 1.350119, loss_d: 0.402493
0.3459 --- loss: 1.967234, loss_ss: 1.421544, loss_d: 0.545690
0.3843 --- loss: 1.833843, loss_ss: 1.352113, loss_d: 0.481730
0.4228 --- loss: 1.750030, loss_ss: 1.143108, loss_d: 0.606922
0.4612 --- loss: 1.864285, loss_ss: 1.545919, loss_d: 0.318366
0.4996 --- loss: 1.896319, loss_ss: 1.441114, loss_d: 0.455204
0.5380 --- loss: 2.001431, loss_ss: 1.429704, loss_d: 0.571728
0.5765 --- loss: 1.527356, loss_ss: 1.170870, loss_d: 0.356486
0.6149 --- loss: 1.777606, loss_ss: 1.424484, loss_d: 0.353122
0.6533 --- loss: 1.660582, loss_ss: 1.356731, loss_d: 0.303851
0.6918 --- loss: 2.425611, loss_ss: 1.378045, loss_d: 1.047566
0.7302 --- loss: 1.792749, loss_ss: 1.422411, loss_d: 0.370338
0.7686 --- loss: 1.915754, loss_ss: 1.569158, loss_d: 0.346596
0.8071 --- loss: 1.977427, loss_ss: 1.531694, loss_d: 0.445733
0.8455 --- loss: 2.225373, loss_ss: 1.597120, loss_d: 0.628253
0.8839 --- loss: 2.029973, loss_ss: 1.464293, loss_d: 0.565680
0.9224 --- loss: 1.612106, loss_ss: 1.347487, loss_d: 0.264619
0.9608 --- loss: 2.585406, loss_ss: 1.478510, loss_d: 1.106895
0.9992 --- loss: 1.988750, loss_ss: 1.674467, loss_d: 0.314283
Epoch finished! Loss: 1.9036773351522593
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.049793, loss_ss: 1.319500, loss_d: 0.730293
0.0384 --- loss: 1.939995, loss_ss: 1.511091, loss_d: 0.428905
0.0769 --- loss: 1.841204, loss_ss: 1.403106, loss_d: 0.438099
0.1153 --- loss: 1.615688, loss_ss: 1.341183, loss_d: 0.274505
0.1537 --- loss: 1.785385, loss_ss: 1.234061, loss_d: 0.551324
0.1922 --- loss: 1.804494, loss_ss: 1.344410, loss_d: 0.460084
0.2306 --- loss: 1.797765, loss_ss: 1.494131, loss_d: 0.303634
0.2690 --- loss: 1.528008, loss_ss: 1.094024, loss_d: 0.433984
0.3075 --- loss: 1.546989, loss_ss: 1.222010, loss_d: 0.324979
0.3459 --- loss: 1.825418, loss_ss: 1.267758, loss_d: 0.557659
0.3843 --- loss: 1.925242, loss_ss: 1.367938, loss_d: 0.557305
0.4228 --- loss: 2.073190, loss_ss: 1.608836, loss_d: 0.464354
0.4612 --- loss: 1.820022, loss_ss: 1.497773, loss_d: 0.322249
0.4996 --- loss: 1.884240, loss_ss: 1.491557, loss_d: 0.392682
0.5380 --- loss: 1.903584, loss_ss: 1.511220, loss_d: 0.392364
0.5765 --- loss: 1.816516, loss_ss: 1.395309, loss_d: 0.421207
0.6149 --- loss: 1.562041, loss_ss: 1.180248, loss_d: 0.381793
0.6533 --- loss: 1.514101, loss_ss: 1.143949, loss_d: 0.370152
0.6918 --- loss: 1.992329, loss_ss: 1.415341, loss_d: 0.576988
0.7302 --- loss: 1.753509, loss_ss: 1.330065, loss_d: 0.423445
0.7686 --- loss: 1.988642, loss_ss: 1.323593, loss_d: 0.665049
0.8071 --- loss: 1.820221, loss_ss: 1.335416, loss_d: 0.484805
0.8455 --- loss: 1.697939, loss_ss: 1.387583, loss_d: 0.310356
0.8839 --- loss: 1.663782, loss_ss: 1.154068, loss_d: 0.509714
0.9224 --- loss: 1.890623, loss_ss: 1.411532, loss_d: 0.479091
0.9608 --- loss: 3.109709, loss_ss: 1.526109, loss_d: 1.583601
0.9992 --- loss: 3.481340, loss_ss: 1.979923, loss_d: 1.501417
Epoch finished! Loss: 1.8804746481088492
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.721287, loss_ss: 1.297830, loss_d: 0.423457
0.0384 --- loss: 1.769473, loss_ss: 1.384481, loss_d: 0.384992
0.0769 --- loss: 2.068965, loss_ss: 1.374363, loss_d: 0.694601
0.1153 --- loss: 1.894920, loss_ss: 1.471537, loss_d: 0.423382
0.1537 --- loss: 1.562865, loss_ss: 1.323260, loss_d: 0.239605
0.1922 --- loss: 1.941182, loss_ss: 1.555965, loss_d: 0.385217
0.2306 --- loss: 2.095426, loss_ss: 1.424280, loss_d: 0.671146
0.2690 --- loss: 2.282776, loss_ss: 1.324044, loss_d: 0.958732
0.3075 --- loss: 1.846584, loss_ss: 1.348081, loss_d: 0.498503
0.3459 --- loss: 1.728402, loss_ss: 1.227020, loss_d: 0.501382
0.3843 --- loss: 1.762445, loss_ss: 1.417212, loss_d: 0.345233
0.4228 --- loss: 1.569923, loss_ss: 1.234892, loss_d: 0.335031
0.4612 --- loss: 1.785881, loss_ss: 1.373885, loss_d: 0.411996
0.4996 --- loss: 1.420510, loss_ss: 1.097179, loss_d: 0.323331
0.5380 --- loss: 1.791930, loss_ss: 1.228508, loss_d: 0.563422
0.5765 --- loss: 1.713890, loss_ss: 1.181513, loss_d: 0.532377
0.6149 --- loss: 1.741674, loss_ss: 1.253828, loss_d: 0.487846
0.6533 --- loss: 1.672438, loss_ss: 1.101472, loss_d: 0.570966
0.6918 --- loss: 1.503684, loss_ss: 1.232406, loss_d: 0.271277
0.7302 --- loss: 1.696272, loss_ss: 1.165648, loss_d: 0.530623
0.7686 --- loss: 1.594258, loss_ss: 1.360631, loss_d: 0.233627
0.8071 --- loss: 2.024145, loss_ss: 1.466762, loss_d: 0.557383
0.8455 --- loss: 1.587287, loss_ss: 1.252228, loss_d: 0.335059
0.8839 --- loss: 1.711968, loss_ss: 1.372949, loss_d: 0.339019
0.9224 --- loss: 2.041774, loss_ss: 1.101687, loss_d: 0.940086
0.9608 --- loss: 1.745966, loss_ss: 1.405335, loss_d: 0.340631
0.9992 --- loss: 3.613716, loss_ss: 1.683185, loss_d: 1.930531
Epoch finished! Loss: 1.8200847584467668
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.465188, loss_ss: 1.237371, loss_d: 0.227818
0.0384 --- loss: 1.915932, loss_ss: 1.187140, loss_d: 0.728792
0.0769 --- loss: 1.558151, loss_ss: 1.149780, loss_d: 0.408371
0.1153 --- loss: 1.766459, loss_ss: 1.230103, loss_d: 0.536356
0.1537 --- loss: 1.717889, loss_ss: 1.316401, loss_d: 0.401488
0.1922 --- loss: 1.355166, loss_ss: 1.025831, loss_d: 0.329335
0.2306 --- loss: 1.580005, loss_ss: 1.262895, loss_d: 0.317110
0.2690 --- loss: 1.808284, loss_ss: 1.439376, loss_d: 0.368908
0.3075 --- loss: 1.823452, loss_ss: 1.425465, loss_d: 0.397987
0.3459 --- loss: 1.796602, loss_ss: 1.435418, loss_d: 0.361184
0.3843 --- loss: 1.557982, loss_ss: 1.170474, loss_d: 0.387508
0.4228 --- loss: 1.781179, loss_ss: 1.300413, loss_d: 0.480766
0.4612 --- loss: 1.828746, loss_ss: 1.146933, loss_d: 0.681812
0.4996 --- loss: 1.633641, loss_ss: 1.228297, loss_d: 0.405344
0.5380 --- loss: 1.812874, loss_ss: 1.362512, loss_d: 0.450362
0.5765 --- loss: 2.037853, loss_ss: 1.607168, loss_d: 0.430685
0.6149 --- loss: 1.391053, loss_ss: 0.969380, loss_d: 0.421672
0.6533 --- loss: 1.497456, loss_ss: 1.124089, loss_d: 0.373367
0.6918 --- loss: 1.202469, loss_ss: 0.974799, loss_d: 0.227670
0.7302 --- loss: 1.579475, loss_ss: 1.089283, loss_d: 0.490193
0.7686 --- loss: 1.885280, loss_ss: 1.178362, loss_d: 0.706918
0.8071 --- loss: 1.412240, loss_ss: 1.083458, loss_d: 0.328782
0.8455 --- loss: 1.486845, loss_ss: 1.044505, loss_d: 0.442341
0.8839 --- loss: 1.513417, loss_ss: 1.254737, loss_d: 0.258680
0.9224 --- loss: 1.637909, loss_ss: 0.999615, loss_d: 0.638294
0.9608 --- loss: 1.625263, loss_ss: 1.076302, loss_d: 0.548961
0.9992 --- loss: 1.439756, loss_ss: 1.219505, loss_d: 0.220251
Epoch finished! Loss: 1.6873429628518912
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.604671, loss_ss: 1.259723, loss_d: 0.344948
0.0384 --- loss: 1.682381, loss_ss: 1.473303, loss_d: 0.209077
0.0769 --- loss: 1.506218, loss_ss: 1.225030, loss_d: 0.281188
0.1153 --- loss: 1.755495, loss_ss: 1.481410, loss_d: 0.274085
0.1537 --- loss: 1.736351, loss_ss: 1.165484, loss_d: 0.570866
0.1922 --- loss: 1.510788, loss_ss: 1.198922, loss_d: 0.311866
0.2306 --- loss: 1.488171, loss_ss: 1.112966, loss_d: 0.375205
0.2690 --- loss: 1.780404, loss_ss: 1.236478, loss_d: 0.543926
0.3075 --- loss: 1.550925, loss_ss: 1.079008, loss_d: 0.471917
0.3459 --- loss: 1.423856, loss_ss: 0.979610, loss_d: 0.444246
0.3843 --- loss: 1.453109, loss_ss: 1.003980, loss_d: 0.449130
0.4228 --- loss: 1.732972, loss_ss: 1.240259, loss_d: 0.492713
0.4612 --- loss: 1.894518, loss_ss: 1.091315, loss_d: 0.803203
0.4996 --- loss: 1.926059, loss_ss: 1.260877, loss_d: 0.665182
0.5380 --- loss: 1.434511, loss_ss: 1.098467, loss_d: 0.336045
0.5765 --- loss: 1.722903, loss_ss: 1.129635, loss_d: 0.593268
0.6149 --- loss: 1.687523, loss_ss: 1.203273, loss_d: 0.484250
0.6533 --- loss: 1.437162, loss_ss: 1.083035, loss_d: 0.354127
0.6918 --- loss: 1.660022, loss_ss: 1.137627, loss_d: 0.522395
0.7302 --- loss: 2.091770, loss_ss: 1.092139, loss_d: 0.999631
0.7686 --- loss: 1.539878, loss_ss: 1.064610, loss_d: 0.475268
0.8071 --- loss: 1.545965, loss_ss: 1.120885, loss_d: 0.425079
0.8455 --- loss: 1.572413, loss_ss: 1.129432, loss_d: 0.442981
0.8839 --- loss: 1.479840, loss_ss: 1.100725, loss_d: 0.379115
0.9224 --- loss: 1.404102, loss_ss: 1.108840, loss_d: 0.295261
0.9608 --- loss: 1.278251, loss_ss: 0.945720, loss_d: 0.332531
0.9992 --- loss: 1.916111, loss_ss: 1.431376, loss_d: 0.484735
Epoch finished! Loss: 1.5996968631560986
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.169278, loss_ss: 0.816719, loss_d: 0.352559
0.0384 --- loss: 1.565222, loss_ss: 1.065105, loss_d: 0.500117
0.0769 --- loss: 1.465839, loss_ss: 1.080637, loss_d: 0.385202
0.1153 --- loss: 1.196373, loss_ss: 0.874146, loss_d: 0.322227
0.1537 --- loss: 1.355041, loss_ss: 1.139928, loss_d: 0.215113
0.1922 --- loss: 1.567331, loss_ss: 1.108899, loss_d: 0.458432
0.2306 --- loss: 1.416710, loss_ss: 0.978271, loss_d: 0.438438
0.2690 --- loss: 1.419327, loss_ss: 0.991314, loss_d: 0.428013
0.3075 --- loss: 1.495453, loss_ss: 1.166043, loss_d: 0.329410
0.3459 --- loss: 1.382070, loss_ss: 1.027146, loss_d: 0.354924
0.3843 --- loss: 1.629712, loss_ss: 1.190072, loss_d: 0.439640
0.4228 --- loss: 1.795762, loss_ss: 1.042545, loss_d: 0.753218
0.4612 --- loss: 1.408762, loss_ss: 1.213038, loss_d: 0.195723
0.4996 --- loss: 1.527043, loss_ss: 0.948044, loss_d: 0.578998
0.5380 --- loss: 1.807802, loss_ss: 1.203691, loss_d: 0.604112
0.5765 --- loss: 1.568558, loss_ss: 1.199543, loss_d: 0.369015
0.6149 --- loss: 1.910583, loss_ss: 1.259505, loss_d: 0.651078
0.6533 --- loss: 1.266460, loss_ss: 1.026132, loss_d: 0.240328
0.6918 --- loss: 1.754075, loss_ss: 0.964865, loss_d: 0.789210
0.7302 --- loss: 1.092234, loss_ss: 0.831524, loss_d: 0.260709
0.7686 --- loss: 1.505453, loss_ss: 1.182889, loss_d: 0.322565
0.8071 --- loss: 1.430829, loss_ss: 1.161238, loss_d: 0.269591
0.8455 --- loss: 1.334495, loss_ss: 0.924665, loss_d: 0.409830
0.8839 --- loss: 1.449776, loss_ss: 0.967239, loss_d: 0.482537
0.9224 --- loss: 1.240455, loss_ss: 0.939156, loss_d: 0.301299
0.9608 --- loss: 1.393766, loss_ss: 1.102031, loss_d: 0.291734
0.9992 --- loss: 1.702002, loss_ss: 1.199250, loss_d: 0.502752
Epoch finished! Loss: 1.5443860585872944
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.187045, loss_ss: 0.929837, loss_d: 0.257208
0.0384 --- loss: 1.570255, loss_ss: 1.316797, loss_d: 0.253458
0.0769 --- loss: 1.434436, loss_ss: 1.184847, loss_d: 0.249589
0.1153 --- loss: 1.618180, loss_ss: 0.981641, loss_d: 0.636539
0.1537 --- loss: 1.351773, loss_ss: 0.969176, loss_d: 0.382596
0.1922 --- loss: 1.907451, loss_ss: 1.646528, loss_d: 0.260923
0.2306 --- loss: 1.260996, loss_ss: 0.919765, loss_d: 0.341231
0.2690 --- loss: 1.230223, loss_ss: 0.898641, loss_d: 0.331582
0.3075 --- loss: 1.476854, loss_ss: 1.266232, loss_d: 0.210622
0.3459 --- loss: 1.466861, loss_ss: 1.122340, loss_d: 0.344521
0.3843 --- loss: 1.720739, loss_ss: 1.141641, loss_d: 0.579098
0.4228 --- loss: 1.722983, loss_ss: 1.293499, loss_d: 0.429484
0.4612 --- loss: 1.397645, loss_ss: 0.960779, loss_d: 0.436866
0.4996 --- loss: 1.078314, loss_ss: 0.831061, loss_d: 0.247253
0.5380 --- loss: 1.096032, loss_ss: 0.923468, loss_d: 0.172564
0.5765 --- loss: 1.380020, loss_ss: 1.011352, loss_d: 0.368668
0.6149 --- loss: 1.747133, loss_ss: 1.340329, loss_d: 0.406805
0.6533 --- loss: 2.207807, loss_ss: 1.230461, loss_d: 0.977346
0.6918 --- loss: 1.251755, loss_ss: 0.853659, loss_d: 0.398096
0.7302 --- loss: 1.572260, loss_ss: 1.275713, loss_d: 0.296547
0.7686 --- loss: 1.673034, loss_ss: 1.246459, loss_d: 0.426575
0.8071 --- loss: 1.468894, loss_ss: 1.015938, loss_d: 0.452956
0.8455 --- loss: 1.848606, loss_ss: 1.006055, loss_d: 0.842551
0.8839 --- loss: 1.399453, loss_ss: 1.057751, loss_d: 0.341702
0.9224 --- loss: 1.521576, loss_ss: 1.107190, loss_d: 0.414386
0.9608 --- loss: 1.163139, loss_ss: 0.879808, loss_d: 0.283331
0.9992 --- loss: 1.328879, loss_ss: 1.096046, loss_d: 0.232833
Epoch finished! Loss: 1.5061999105490171
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.26944444444444443
             precision    recall  f1-score   support

        0.0       0.11      1.00      0.20        78
        1.0       0.00      0.00      0.00       284
        2.0       0.81      0.09      0.15       258
        3.0       0.55      0.99      0.71       185
        4.0       0.23      0.03      0.05       275

avg / total       0.36      0.27      0.19      1080
 


====== chp056-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  43.70  100.00   39.32  11.37     20.42
1  73.70    0.00  100.00   0.00      0.00
2  77.69    8.53   99.39  81.48     15.44
3  86.02   98.92   83.35  55.12     70.79
4  72.78    2.91   96.65  22.86      5.16
Total accuracy: 26.94%
Average sen: 42.07%
Average spec: 83.74%
Macro f1-score: 22.36%
[0.08789621 0.11387265 0.10943324 0.12309352 0.11144273 0.10513686
 0.09668778 0.0879261  0.02715581 0.0718885  0.08681952 0.04145944
 0.08298172 0.09060502 0.09701713 0.11592296 0.07896453 0.09023467
 0.06878673 0.058649   0.08097199 0.08887978 0.09093542 0.11326641
 0.15913546 0.11642462 0.09247959 0.05681054 0.07861521 0.03733588
 0.06977331 0.06468847 0.08165912 0.10059807 0.05255613 0.04313901]
pred: 0.0853678650326199, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.259573, loss_ss: 1.625530, loss_d: 0.634042
0.0385 --- loss: 3.601257, loss_ss: 1.702134, loss_d: 1.899123
0.0770 --- loss: 1.983976, loss_ss: 1.435610, loss_d: 0.548367
0.1154 --- loss: 2.029830, loss_ss: 1.443356, loss_d: 0.586474
0.1539 --- loss: 1.913417, loss_ss: 1.577247, loss_d: 0.336170
0.1924 --- loss: 1.865946, loss_ss: 1.340184, loss_d: 0.525762
0.2309 --- loss: 2.515964, loss_ss: 1.643934, loss_d: 0.872031
0.2693 --- loss: 2.128607, loss_ss: 1.625318, loss_d: 0.503290
0.3078 --- loss: 1.993028, loss_ss: 1.375349, loss_d: 0.617678
0.3463 --- loss: 1.905468, loss_ss: 1.384257, loss_d: 0.521211
0.3848 --- loss: 2.027078, loss_ss: 1.404595, loss_d: 0.622483
0.4232 --- loss: 1.828501, loss_ss: 1.362414, loss_d: 0.466087
0.4617 --- loss: 2.232290, loss_ss: 1.566165, loss_d: 0.666125
0.5002 --- loss: 2.122373, loss_ss: 1.581307, loss_d: 0.541067
0.5387 --- loss: 2.271193, loss_ss: 1.501349, loss_d: 0.769844
0.5771 --- loss: 1.649801, loss_ss: 1.260339, loss_d: 0.389462
0.6156 --- loss: 2.033258, loss_ss: 1.501227, loss_d: 0.532031
0.6541 --- loss: 2.142696, loss_ss: 1.516503, loss_d: 0.626194
0.6926 --- loss: 2.013828, loss_ss: 1.524482, loss_d: 0.489346
0.7311 --- loss: 1.988601, loss_ss: 1.443190, loss_d: 0.545411
0.7695 --- loss: 1.795577, loss_ss: 1.279758, loss_d: 0.515819
0.8080 --- loss: 2.071103, loss_ss: 1.449987, loss_d: 0.621116
0.8465 --- loss: 2.007276, loss_ss: 1.474447, loss_d: 0.532830
0.8850 --- loss: 1.957226, loss_ss: 1.588823, loss_d: 0.368404
0.9234 --- loss: 2.014031, loss_ss: 1.366295, loss_d: 0.647736
0.9619 --- loss: 1.811252, loss_ss: 1.252975, loss_d: 0.558277
Epoch finished! Loss: 2.031006764721226
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.030114, loss_ss: 1.363183, loss_d: 0.666930
0.0385 --- loss: 1.646861, loss_ss: 1.289662, loss_d: 0.357199
0.0770 --- loss: 1.854772, loss_ss: 1.315645, loss_d: 0.539127
0.1154 --- loss: 2.051434, loss_ss: 1.216392, loss_d: 0.835042
0.1539 --- loss: 1.716499, loss_ss: 1.128876, loss_d: 0.587623
0.1924 --- loss: 1.938169, loss_ss: 1.359388, loss_d: 0.578781
0.2309 --- loss: 1.950924, loss_ss: 1.379230, loss_d: 0.571694
0.2693 --- loss: 2.022773, loss_ss: 1.301841, loss_d: 0.720932
0.3078 --- loss: 1.786891, loss_ss: 1.228667, loss_d: 0.558223
0.3463 --- loss: 1.804525, loss_ss: 1.383807, loss_d: 0.420718
0.3848 --- loss: 1.648904, loss_ss: 1.099095, loss_d: 0.549809
0.4232 --- loss: 1.596622, loss_ss: 1.275778, loss_d: 0.320843
0.4617 --- loss: 2.393425, loss_ss: 1.296956, loss_d: 1.096469
0.5002 --- loss: 1.578723, loss_ss: 1.162490, loss_d: 0.416233
0.5387 --- loss: 1.863308, loss_ss: 1.307701, loss_d: 0.555606
0.5771 --- loss: 1.527633, loss_ss: 1.171043, loss_d: 0.356590
0.6156 --- loss: 1.709370, loss_ss: 1.302477, loss_d: 0.406893
0.6541 --- loss: 1.676121, loss_ss: 1.330599, loss_d: 0.345521
0.6926 --- loss: 1.585099, loss_ss: 1.192273, loss_d: 0.392826
0.7311 --- loss: 2.058275, loss_ss: 1.207755, loss_d: 0.850520
0.7695 --- loss: 2.042197, loss_ss: 1.310150, loss_d: 0.732047
0.8080 --- loss: 1.594166, loss_ss: 1.298468, loss_d: 0.295698
0.8465 --- loss: 1.405035, loss_ss: 1.042163, loss_d: 0.362872
0.8850 --- loss: 2.133438, loss_ss: 1.660354, loss_d: 0.473083
0.9234 --- loss: 1.974242, loss_ss: 1.466473, loss_d: 0.507768
0.9619 --- loss: 1.658576, loss_ss: 1.265520, loss_d: 0.393057
Epoch finished! Loss: 1.8108928203582764
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.839648, loss_ss: 1.196098, loss_d: 0.643550
0.0385 --- loss: 1.460934, loss_ss: 0.961920, loss_d: 0.499014
0.0770 --- loss: 1.410835, loss_ss: 1.096464, loss_d: 0.314371
0.1154 --- loss: 1.324955, loss_ss: 1.045921, loss_d: 0.279034
0.1539 --- loss: 1.735249, loss_ss: 1.406665, loss_d: 0.328583
0.1924 --- loss: 1.686640, loss_ss: 1.269575, loss_d: 0.417064
0.2309 --- loss: 2.065940, loss_ss: 1.562029, loss_d: 0.503912
0.2693 --- loss: 1.360889, loss_ss: 1.066694, loss_d: 0.294194
0.3078 --- loss: 1.611672, loss_ss: 1.217724, loss_d: 0.393949
0.3463 --- loss: 1.580796, loss_ss: 1.189251, loss_d: 0.391545
0.3848 --- loss: 1.770231, loss_ss: 0.927722, loss_d: 0.842509
0.4232 --- loss: 1.632508, loss_ss: 1.313324, loss_d: 0.319183
0.4617 --- loss: 1.419228, loss_ss: 1.105795, loss_d: 0.313433
0.5002 --- loss: 1.839112, loss_ss: 1.233728, loss_d: 0.605384
0.5387 --- loss: 2.276263, loss_ss: 1.346015, loss_d: 0.930248
0.5771 --- loss: 1.689408, loss_ss: 1.158835, loss_d: 0.530573
0.6156 --- loss: 1.592263, loss_ss: 1.212707, loss_d: 0.379556
0.6541 --- loss: 1.687974, loss_ss: 1.122349, loss_d: 0.565625
0.6926 --- loss: 1.593285, loss_ss: 1.082806, loss_d: 0.510479
0.7311 --- loss: 1.625084, loss_ss: 1.169764, loss_d: 0.455320
0.7695 --- loss: 1.544240, loss_ss: 1.011415, loss_d: 0.532824
0.8080 --- loss: 1.675733, loss_ss: 1.065642, loss_d: 0.610091
0.8465 --- loss: 1.785588, loss_ss: 0.985809, loss_d: 0.799780
0.8850 --- loss: 1.531304, loss_ss: 1.127286, loss_d: 0.404017
0.9234 --- loss: 1.626669, loss_ss: 1.255652, loss_d: 0.371017
0.9619 --- loss: 1.558111, loss_ss: 1.114716, loss_d: 0.443395
Epoch finished! Loss: 1.7142065252576555
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.607658, loss_ss: 1.093267, loss_d: 0.514390
0.0385 --- loss: 2.165349, loss_ss: 1.329681, loss_d: 0.835669
0.0770 --- loss: 1.510982, loss_ss: 1.071949, loss_d: 0.439033
0.1154 --- loss: 1.703595, loss_ss: 1.201391, loss_d: 0.502204
0.1539 --- loss: 1.441583, loss_ss: 1.038195, loss_d: 0.403387
0.1924 --- loss: 1.677815, loss_ss: 1.250334, loss_d: 0.427482
0.2309 --- loss: 1.982757, loss_ss: 1.174929, loss_d: 0.807829
0.2693 --- loss: 1.894504, loss_ss: 1.415367, loss_d: 0.479137
0.3078 --- loss: 1.704744, loss_ss: 1.337283, loss_d: 0.367460
0.3463 --- loss: 1.802449, loss_ss: 1.013289, loss_d: 0.789160
0.3848 --- loss: 1.625655, loss_ss: 1.077339, loss_d: 0.548316
0.4232 --- loss: 1.611142, loss_ss: 1.226815, loss_d: 0.384327
0.4617 --- loss: 1.977061, loss_ss: 1.440161, loss_d: 0.536901
0.5002 --- loss: 1.568229, loss_ss: 1.138894, loss_d: 0.429334
0.5387 --- loss: 2.005542, loss_ss: 1.101030, loss_d: 0.904512
0.5771 --- loss: 2.077531, loss_ss: 1.058538, loss_d: 1.018994
0.6156 --- loss: 1.872937, loss_ss: 1.093768, loss_d: 0.779168
0.6541 --- loss: 1.614803, loss_ss: 1.010145, loss_d: 0.604658
0.6926 --- loss: 1.687441, loss_ss: 1.093489, loss_d: 0.593953
0.7311 --- loss: 1.666518, loss_ss: 1.370430, loss_d: 0.296088
0.7695 --- loss: 1.667085, loss_ss: 1.050620, loss_d: 0.616465
0.8080 --- loss: 1.758553, loss_ss: 1.150727, loss_d: 0.607825
0.8465 --- loss: 1.684341, loss_ss: 1.114331, loss_d: 0.570010
0.8850 --- loss: 1.434446, loss_ss: 1.053532, loss_d: 0.380914
0.9234 --- loss: 1.970088, loss_ss: 1.410865, loss_d: 0.559222
0.9619 --- loss: 1.531438, loss_ss: 1.093392, loss_d: 0.438046
Epoch finished! Loss: 1.7087531080577365
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.526041, loss_ss: 1.166101, loss_d: 0.359940
0.0385 --- loss: 1.847821, loss_ss: 1.075005, loss_d: 0.772816
0.0770 --- loss: 1.948484, loss_ss: 1.526621, loss_d: 0.421863
0.1154 --- loss: 1.470502, loss_ss: 0.926919, loss_d: 0.543583
0.1539 --- loss: 1.570171, loss_ss: 0.985581, loss_d: 0.584590
0.1924 --- loss: 1.741095, loss_ss: 1.134079, loss_d: 0.607015
0.2309 --- loss: 1.609027, loss_ss: 0.938266, loss_d: 0.670761
0.2693 --- loss: 1.791809, loss_ss: 1.294859, loss_d: 0.496949
0.3078 --- loss: 1.407187, loss_ss: 0.968208, loss_d: 0.438979
0.3463 --- loss: 1.604050, loss_ss: 1.092396, loss_d: 0.511655
0.3848 --- loss: 1.862211, loss_ss: 1.385998, loss_d: 0.476213
0.4232 --- loss: 1.747797, loss_ss: 1.240580, loss_d: 0.507216
0.4617 --- loss: 2.052851, loss_ss: 1.326068, loss_d: 0.726783
0.5002 --- loss: 1.784625, loss_ss: 1.306544, loss_d: 0.478081
0.5387 --- loss: 2.243173, loss_ss: 1.569601, loss_d: 0.673572
0.5771 --- loss: 1.616154, loss_ss: 1.115989, loss_d: 0.500165
0.6156 --- loss: 1.375880, loss_ss: 1.068943, loss_d: 0.306938
0.6541 --- loss: 1.716907, loss_ss: 1.160888, loss_d: 0.556019
0.6926 --- loss: 1.788148, loss_ss: 1.379375, loss_d: 0.408773
0.7311 --- loss: 1.813553, loss_ss: 1.183447, loss_d: 0.630106
0.7695 --- loss: 1.471248, loss_ss: 1.090129, loss_d: 0.381119
0.8080 --- loss: 1.281679, loss_ss: 0.918891, loss_d: 0.362788
0.8465 --- loss: 1.384272, loss_ss: 0.873906, loss_d: 0.510366
0.8850 --- loss: 1.713771, loss_ss: 1.202510, loss_d: 0.511261
0.9234 --- loss: 1.978316, loss_ss: 1.044091, loss_d: 0.934225
0.9619 --- loss: 1.968969, loss_ss: 1.343006, loss_d: 0.625964
Epoch finished! Loss: 1.673063527663242
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.547140, loss_ss: 1.225304, loss_d: 0.321836
0.0385 --- loss: 1.537914, loss_ss: 1.100633, loss_d: 0.437281
0.0770 --- loss: 1.645144, loss_ss: 1.314848, loss_d: 0.330296
0.1154 --- loss: 1.903255, loss_ss: 1.462608, loss_d: 0.440647
0.1539 --- loss: 1.737293, loss_ss: 1.284348, loss_d: 0.452945
0.1924 --- loss: 1.379932, loss_ss: 1.050374, loss_d: 0.329558
0.2309 --- loss: 1.419259, loss_ss: 1.121677, loss_d: 0.297582
0.2693 --- loss: 1.698213, loss_ss: 1.275081, loss_d: 0.423132
0.3078 --- loss: 1.939598, loss_ss: 1.331909, loss_d: 0.607690
0.3463 --- loss: 1.857223, loss_ss: 1.038465, loss_d: 0.818758
0.3848 --- loss: 1.513234, loss_ss: 1.015908, loss_d: 0.497326
0.4232 --- loss: 1.472718, loss_ss: 0.849650, loss_d: 0.623067
0.4617 --- loss: 1.317096, loss_ss: 0.986035, loss_d: 0.331061
0.5002 --- loss: 1.733640, loss_ss: 0.967389, loss_d: 0.766251
0.5387 --- loss: 1.987026, loss_ss: 1.030672, loss_d: 0.956355
0.5771 --- loss: 2.047375, loss_ss: 1.184418, loss_d: 0.862957
0.6156 --- loss: 1.572600, loss_ss: 1.052461, loss_d: 0.520138
0.6541 --- loss: 1.328950, loss_ss: 1.025983, loss_d: 0.302967
0.6926 --- loss: 1.594534, loss_ss: 1.275439, loss_d: 0.319095
0.7311 --- loss: 1.690610, loss_ss: 1.137219, loss_d: 0.553391
0.7695 --- loss: 1.714072, loss_ss: 1.333855, loss_d: 0.380217
0.8080 --- loss: 1.231509, loss_ss: 0.857244, loss_d: 0.374266
0.8465 --- loss: 2.059886, loss_ss: 1.060025, loss_d: 0.999861
0.8850 --- loss: 1.417964, loss_ss: 1.082867, loss_d: 0.335097
0.9234 --- loss: 1.642473, loss_ss: 1.036894, loss_d: 0.605579
0.9619 --- loss: 1.777560, loss_ss: 1.032660, loss_d: 0.744900
Epoch finished! Loss: 1.6055021769291646
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.545305, loss_ss: 1.253724, loss_d: 0.291581
0.0385 --- loss: 1.443122, loss_ss: 0.857174, loss_d: 0.585948
0.0770 --- loss: 1.788420, loss_ss: 1.306767, loss_d: 0.481653
0.1154 --- loss: 1.448460, loss_ss: 0.999418, loss_d: 0.449042
0.1539 --- loss: 1.449323, loss_ss: 0.955870, loss_d: 0.493453
0.1924 --- loss: 1.459116, loss_ss: 1.111366, loss_d: 0.347750
0.2309 --- loss: 1.224130, loss_ss: 0.781776, loss_d: 0.442355
0.2693 --- loss: 1.463686, loss_ss: 1.113420, loss_d: 0.350267
0.3078 --- loss: 1.791218, loss_ss: 1.095816, loss_d: 0.695402
0.3463 --- loss: 1.954437, loss_ss: 1.670958, loss_d: 0.283479
0.3848 --- loss: 1.160471, loss_ss: 0.934131, loss_d: 0.226340
0.4232 --- loss: 1.656580, loss_ss: 1.231813, loss_d: 0.424766
0.4617 --- loss: 2.391358, loss_ss: 1.366114, loss_d: 1.025244
0.5002 --- loss: 1.758456, loss_ss: 1.210073, loss_d: 0.548382
0.5387 --- loss: 1.550858, loss_ss: 1.206419, loss_d: 0.344439
0.5771 --- loss: 1.288676, loss_ss: 0.863997, loss_d: 0.424679
0.6156 --- loss: 1.291549, loss_ss: 0.829020, loss_d: 0.462529
0.6541 --- loss: 1.421094, loss_ss: 1.066390, loss_d: 0.354704
0.6926 --- loss: 1.524595, loss_ss: 0.916029, loss_d: 0.608566
0.7311 --- loss: 1.780906, loss_ss: 0.936531, loss_d: 0.844375
0.7695 --- loss: 1.556302, loss_ss: 1.011678, loss_d: 0.544624
0.8080 --- loss: 1.348176, loss_ss: 0.959351, loss_d: 0.388825
0.8465 --- loss: 1.525323, loss_ss: 1.107063, loss_d: 0.418260
0.8850 --- loss: 1.632745, loss_ss: 1.081637, loss_d: 0.551107
0.9234 --- loss: 1.630507, loss_ss: 1.282622, loss_d: 0.347886
0.9619 --- loss: 1.527832, loss_ss: 1.247477, loss_d: 0.280355
Epoch finished! Loss: 1.5858268157855884
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.648650, loss_ss: 1.184755, loss_d: 0.463895
0.0385 --- loss: 1.434216, loss_ss: 1.087258, loss_d: 0.346958
0.0770 --- loss: 1.673455, loss_ss: 1.182848, loss_d: 0.490607
0.1154 --- loss: 1.554327, loss_ss: 1.289883, loss_d: 0.264444
0.1539 --- loss: 1.305900, loss_ss: 0.968574, loss_d: 0.337326
0.1924 --- loss: 1.379491, loss_ss: 1.138877, loss_d: 0.240614
0.2309 --- loss: 1.556036, loss_ss: 1.265176, loss_d: 0.290860
0.2693 --- loss: 1.461737, loss_ss: 1.063994, loss_d: 0.397743
0.3078 --- loss: 1.655783, loss_ss: 1.029684, loss_d: 0.626100
0.3463 --- loss: 1.450105, loss_ss: 0.927869, loss_d: 0.522236
0.3848 --- loss: 1.527994, loss_ss: 1.079822, loss_d: 0.448171
0.4232 --- loss: 1.308766, loss_ss: 0.929750, loss_d: 0.379015
0.4617 --- loss: 1.730729, loss_ss: 0.992477, loss_d: 0.738252
0.5002 --- loss: 1.490277, loss_ss: 1.003650, loss_d: 0.486626
0.5387 --- loss: 1.512817, loss_ss: 1.099423, loss_d: 0.413393
0.5771 --- loss: 1.474069, loss_ss: 1.017373, loss_d: 0.456696
0.6156 --- loss: 1.428512, loss_ss: 0.992826, loss_d: 0.435687
0.6541 --- loss: 1.705189, loss_ss: 1.263107, loss_d: 0.442082
0.6926 --- loss: 1.482747, loss_ss: 1.040452, loss_d: 0.442295
0.7311 --- loss: 1.871046, loss_ss: 1.223920, loss_d: 0.647125
0.7695 --- loss: 2.150930, loss_ss: 1.295871, loss_d: 0.855058
0.8080 --- loss: 1.717081, loss_ss: 1.230492, loss_d: 0.486590
0.8465 --- loss: 1.423974, loss_ss: 1.191390, loss_d: 0.232585
0.8850 --- loss: 1.616555, loss_ss: 1.016756, loss_d: 0.599799
0.9234 --- loss: 1.647937, loss_ss: 1.098034, loss_d: 0.549903
0.9619 --- loss: 1.686946, loss_ss: 1.183017, loss_d: 0.503929
Epoch finished! Loss: 1.5559547950862458
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.469299, loss_ss: 1.022395, loss_d: 0.446905
0.0385 --- loss: 1.528046, loss_ss: 1.075037, loss_d: 0.453008
0.0770 --- loss: 1.693318, loss_ss: 0.975425, loss_d: 0.717893
0.1154 --- loss: 1.518692, loss_ss: 1.113198, loss_d: 0.405493
0.1539 --- loss: 1.593374, loss_ss: 1.224122, loss_d: 0.369252
0.1924 --- loss: 1.864523, loss_ss: 1.201993, loss_d: 0.662530
0.2309 --- loss: 2.473420, loss_ss: 1.999799, loss_d: 0.473621
0.2693 --- loss: 1.262082, loss_ss: 1.003196, loss_d: 0.258886
0.3078 --- loss: 1.854199, loss_ss: 1.100280, loss_d: 0.753918
0.3463 --- loss: 1.567895, loss_ss: 1.047472, loss_d: 0.520423
0.3848 --- loss: 1.718409, loss_ss: 1.245523, loss_d: 0.472886
0.4232 --- loss: 1.539095, loss_ss: 1.138862, loss_d: 0.400233
0.4617 --- loss: 1.762987, loss_ss: 1.442526, loss_d: 0.320461
0.5002 --- loss: 1.441643, loss_ss: 1.148229, loss_d: 0.293414
0.5387 --- loss: 1.853045, loss_ss: 1.564578, loss_d: 0.288467
0.5771 --- loss: 1.518474, loss_ss: 1.209389, loss_d: 0.309085
0.6156 --- loss: 1.697395, loss_ss: 0.771884, loss_d: 0.925512
0.6541 --- loss: 1.467642, loss_ss: 1.073323, loss_d: 0.394319
0.6926 --- loss: 2.018878, loss_ss: 1.073678, loss_d: 0.945199
0.7311 --- loss: 1.220094, loss_ss: 0.965616, loss_d: 0.254477
0.7695 --- loss: 1.267221, loss_ss: 0.994304, loss_d: 0.272917
0.8080 --- loss: 1.494084, loss_ss: 0.976556, loss_d: 0.517528
0.8465 --- loss: 1.497815, loss_ss: 0.856079, loss_d: 0.641736
0.8850 --- loss: 1.362914, loss_ss: 0.771851, loss_d: 0.591063
0.9234 --- loss: 1.388613, loss_ss: 0.824578, loss_d: 0.564035
0.9619 --- loss: 1.466621, loss_ss: 1.060694, loss_d: 0.405927
Epoch finished! Loss: 1.5528371637852496
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.704378, loss_ss: 1.144866, loss_d: 0.559512
0.0385 --- loss: 1.604012, loss_ss: 0.958592, loss_d: 0.645420
0.0770 --- loss: 1.275658, loss_ss: 0.885705, loss_d: 0.389954
0.1154 --- loss: 1.350978, loss_ss: 0.910892, loss_d: 0.440086
0.1539 --- loss: 2.085886, loss_ss: 1.468684, loss_d: 0.617203
0.1924 --- loss: 1.472921, loss_ss: 0.901298, loss_d: 0.571623
0.2309 --- loss: 1.773904, loss_ss: 1.454774, loss_d: 0.319130
0.2693 --- loss: 1.710669, loss_ss: 1.245390, loss_d: 0.465278
0.3078 --- loss: 1.540417, loss_ss: 1.149254, loss_d: 0.391163
0.3463 --- loss: 1.511474, loss_ss: 1.066199, loss_d: 0.445276
0.3848 --- loss: 1.369300, loss_ss: 1.089674, loss_d: 0.279626
0.4232 --- loss: 1.290634, loss_ss: 0.990116, loss_d: 0.300518
0.4617 --- loss: 1.315839, loss_ss: 1.029395, loss_d: 0.286443
0.5002 --- loss: 1.107561, loss_ss: 0.807777, loss_d: 0.299784
0.5387 --- loss: 1.431067, loss_ss: 1.034660, loss_d: 0.396407
0.5771 --- loss: 1.375667, loss_ss: 0.875942, loss_d: 0.499725
0.6156 --- loss: 1.224345, loss_ss: 0.745204, loss_d: 0.479141
0.6541 --- loss: 1.276656, loss_ss: 1.094894, loss_d: 0.181762
0.6926 --- loss: 1.173213, loss_ss: 0.915273, loss_d: 0.257940
0.7311 --- loss: 1.752551, loss_ss: 1.272154, loss_d: 0.480396
0.7695 --- loss: 1.625630, loss_ss: 1.134701, loss_d: 0.490930
0.8080 --- loss: 1.659460, loss_ss: 1.165696, loss_d: 0.493764
0.8465 --- loss: 1.537202, loss_ss: 1.038734, loss_d: 0.498468
0.8850 --- loss: 1.580083, loss_ss: 1.113166, loss_d: 0.466917
0.9234 --- loss: 1.617595, loss_ss: 1.176709, loss_d: 0.440886
0.9619 --- loss: 1.173441, loss_ss: 0.923097, loss_d: 0.250344
Epoch finished! Loss: 1.5356779264207052
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6467065868263473
             precision    recall  f1-score   support

        0.0       0.77      0.52      0.62       267
        1.0       0.00      0.00      0.00       152
        2.0       0.69      0.88      0.77       496
        3.0       0.55      0.99      0.71        74
        4.0       0.49      0.59      0.54       180

avg / total       0.58      0.65      0.60      1169
 


====== chp057-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  85.46  52.43   95.23  76.50     62.22
1  87.00   0.00  100.00   0.00      0.00
2  77.76  87.90   70.28  68.55     77.03
3  94.87  98.65   94.61  55.30     70.87
4  84.26  59.44   88.78  49.08     53.77
Total accuracy: 64.67%
Average sen: 59.69%
Average spec: 89.78%
Macro f1-score: 52.78%
[0.97686881 0.97231805 0.97121978 0.96912819 0.96550524 0.96366674
 0.96320587 0.96253663 0.96323824 0.96255147 0.96751875 0.96560961
 0.96341485 0.96303415 0.96140528 0.96183431 0.96703845 0.97127986
 0.96357518 0.95868313 0.9589681  0.97026283 0.96146411 0.95950723
 0.96819019 0.96688062 0.96619862 0.96350676 0.96465147 0.9602527
 0.9624458  0.95882142 0.96582961 0.96953672 0.96348065 0.96032238
 0.96298105 0.96002769 0.96242028]
pred: 0.9645995085056012, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.349810, loss_ss: 1.647579, loss_d: 0.702231
0.0384 --- loss: 2.143661, loss_ss: 1.647548, loss_d: 0.496114
0.0768 --- loss: 2.101281, loss_ss: 1.639232, loss_d: 0.462050
0.1152 --- loss: 2.113092, loss_ss: 1.638570, loss_d: 0.474522
0.1536 --- loss: 1.962416, loss_ss: 1.502190, loss_d: 0.460226
0.1920 --- loss: 2.138303, loss_ss: 1.587810, loss_d: 0.550493
0.2304 --- loss: 2.177314, loss_ss: 1.590141, loss_d: 0.587173
0.2688 --- loss: 2.088193, loss_ss: 1.596234, loss_d: 0.491960
0.3072 --- loss: 2.063610, loss_ss: 1.540462, loss_d: 0.523148
0.3456 --- loss: 2.130461, loss_ss: 1.636268, loss_d: 0.494192
0.3840 --- loss: 2.041615, loss_ss: 1.589235, loss_d: 0.452380
0.4224 --- loss: 2.334117, loss_ss: 1.562569, loss_d: 0.771549
0.4608 --- loss: 1.787812, loss_ss: 1.419045, loss_d: 0.368767
0.4992 --- loss: 1.942821, loss_ss: 1.545128, loss_d: 0.397693
0.5376 --- loss: 1.916926, loss_ss: 1.564046, loss_d: 0.352879
0.5760 --- loss: 2.183012, loss_ss: 1.560676, loss_d: 0.622337
0.6144 --- loss: 1.822628, loss_ss: 1.358049, loss_d: 0.464579
0.6528 --- loss: 1.910073, loss_ss: 1.522273, loss_d: 0.387800
0.6912 --- loss: 2.049869, loss_ss: 1.398041, loss_d: 0.651828
0.7296 --- loss: 1.847653, loss_ss: 1.380666, loss_d: 0.466987
0.7680 --- loss: 1.842857, loss_ss: 1.460984, loss_d: 0.381873
0.8065 --- loss: 1.833873, loss_ss: 1.415678, loss_d: 0.418195
0.8449 --- loss: 2.060993, loss_ss: 1.427171, loss_d: 0.633822
0.8833 --- loss: 1.981682, loss_ss: 1.493782, loss_d: 0.487900
0.9217 --- loss: 2.424515, loss_ss: 1.393373, loss_d: 1.031141
0.9601 --- loss: 1.987100, loss_ss: 1.278001, loss_d: 0.709099
0.9985 --- loss: 2.011633, loss_ss: 1.605065, loss_d: 0.406568
Epoch finished! Loss: 2.0616496251179623
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.042943, loss_ss: 1.417149, loss_d: 0.625793
0.0384 --- loss: 2.182832, loss_ss: 1.288850, loss_d: 0.893983
0.0768 --- loss: 1.660100, loss_ss: 1.239119, loss_d: 0.420981
0.1152 --- loss: 1.827008, loss_ss: 1.208306, loss_d: 0.618702
0.1536 --- loss: 1.766635, loss_ss: 1.379106, loss_d: 0.387529
0.1920 --- loss: 1.602753, loss_ss: 1.167618, loss_d: 0.435136
0.2304 --- loss: 1.962020, loss_ss: 1.575443, loss_d: 0.386577
0.2688 --- loss: 1.782371, loss_ss: 1.247396, loss_d: 0.534975
0.3072 --- loss: 1.790923, loss_ss: 1.293201, loss_d: 0.497722
0.3456 --- loss: 1.827657, loss_ss: 1.178448, loss_d: 0.649209
0.3840 --- loss: 1.705266, loss_ss: 1.200158, loss_d: 0.505107
0.4224 --- loss: 1.529541, loss_ss: 1.214015, loss_d: 0.315526
0.4608 --- loss: 1.837631, loss_ss: 1.282834, loss_d: 0.554797
0.4992 --- loss: 1.935054, loss_ss: 1.539908, loss_d: 0.395146
0.5376 --- loss: 1.739160, loss_ss: 1.304709, loss_d: 0.434451
0.5760 --- loss: 1.832700, loss_ss: 1.236530, loss_d: 0.596170
0.6144 --- loss: 2.111504, loss_ss: 1.648119, loss_d: 0.463385
0.6528 --- loss: 1.918604, loss_ss: 1.384973, loss_d: 0.533631
0.6912 --- loss: 2.191443, loss_ss: 1.204828, loss_d: 0.986615
0.7296 --- loss: 1.602630, loss_ss: 1.270176, loss_d: 0.332455
0.7680 --- loss: 1.860764, loss_ss: 1.334533, loss_d: 0.526231
0.8065 --- loss: 2.470630, loss_ss: 1.557007, loss_d: 0.913623
0.8449 --- loss: 1.872275, loss_ss: 1.522475, loss_d: 0.349800
0.8833 --- loss: 1.601564, loss_ss: 1.156337, loss_d: 0.445227
0.9217 --- loss: 1.475576, loss_ss: 1.161068, loss_d: 0.314508
0.9601 --- loss: 1.570214, loss_ss: 1.159249, loss_d: 0.410965
0.9985 --- loss: 2.221222, loss_ss: 1.671691, loss_d: 0.549532
Epoch finished! Loss: 1.8400279742020826
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.699363, loss_ss: 1.214796, loss_d: 0.484567
0.0384 --- loss: 2.031141, loss_ss: 1.559531, loss_d: 0.471611
0.0768 --- loss: 1.977898, loss_ss: 1.495622, loss_d: 0.482275
0.1152 --- loss: 1.653063, loss_ss: 1.122580, loss_d: 0.530483
0.1536 --- loss: 1.515827, loss_ss: 1.175102, loss_d: 0.340725
0.1920 --- loss: 1.552500, loss_ss: 1.183106, loss_d: 0.369394
0.2304 --- loss: 1.592593, loss_ss: 1.099229, loss_d: 0.493365
0.2688 --- loss: 1.927742, loss_ss: 1.262280, loss_d: 0.665462
0.3072 --- loss: 1.473238, loss_ss: 1.080027, loss_d: 0.393211
0.3456 --- loss: 1.460734, loss_ss: 1.155905, loss_d: 0.304829
0.3840 --- loss: 1.567975, loss_ss: 1.140675, loss_d: 0.427300
0.4224 --- loss: 1.443913, loss_ss: 1.076518, loss_d: 0.367394
0.4608 --- loss: 2.088213, loss_ss: 1.580204, loss_d: 0.508009
0.4992 --- loss: 1.697369, loss_ss: 1.096357, loss_d: 0.601012
0.5376 --- loss: 1.418227, loss_ss: 0.925581, loss_d: 0.492647
0.5760 --- loss: 1.917798, loss_ss: 1.448746, loss_d: 0.469052
0.6144 --- loss: 1.454775, loss_ss: 1.131287, loss_d: 0.323488
0.6528 --- loss: 1.507714, loss_ss: 1.173833, loss_d: 0.333881
0.6912 --- loss: 1.552430, loss_ss: 1.162164, loss_d: 0.390266
0.7296 --- loss: 1.723907, loss_ss: 1.080527, loss_d: 0.643380
0.7680 --- loss: 1.892099, loss_ss: 1.265687, loss_d: 0.626413
0.8065 --- loss: 2.009964, loss_ss: 1.504939, loss_d: 0.505025
0.8449 --- loss: 1.704201, loss_ss: 1.199179, loss_d: 0.505023
0.8833 --- loss: 1.722677, loss_ss: 1.167254, loss_d: 0.555423
0.9217 --- loss: 1.840987, loss_ss: 1.022741, loss_d: 0.818246
0.9601 --- loss: 1.540462, loss_ss: 1.030216, loss_d: 0.510246
0.9985 --- loss: 2.614980, loss_ss: 1.858484, loss_d: 0.756496
Epoch finished! Loss: 1.721250403385896
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.610506, loss_ss: 1.221580, loss_d: 0.388926
0.0384 --- loss: 1.922388, loss_ss: 1.191834, loss_d: 0.730553
0.0768 --- loss: 1.520663, loss_ss: 1.140612, loss_d: 0.380051
0.1152 --- loss: 2.254578, loss_ss: 1.397099, loss_d: 0.857480
0.1536 --- loss: 1.544245, loss_ss: 1.223474, loss_d: 0.320771
0.1920 --- loss: 2.085537, loss_ss: 1.683389, loss_d: 0.402149
0.2304 --- loss: 1.877233, loss_ss: 1.168121, loss_d: 0.709113
0.2688 --- loss: 1.672937, loss_ss: 1.224324, loss_d: 0.448613
0.3072 --- loss: 2.050324, loss_ss: 1.292574, loss_d: 0.757749
0.3456 --- loss: 1.760319, loss_ss: 1.169426, loss_d: 0.590893
0.3840 --- loss: 2.014062, loss_ss: 1.325354, loss_d: 0.688708
0.4224 --- loss: 1.809416, loss_ss: 0.929833, loss_d: 0.879583
0.4608 --- loss: 1.826382, loss_ss: 1.179328, loss_d: 0.647054
0.4992 --- loss: 1.558209, loss_ss: 1.075760, loss_d: 0.482450
0.5376 --- loss: 1.651644, loss_ss: 0.985430, loss_d: 0.666214
0.5760 --- loss: 1.325699, loss_ss: 0.878858, loss_d: 0.446841
0.6144 --- loss: 1.580673, loss_ss: 1.147914, loss_d: 0.432758
0.6528 --- loss: 1.664129, loss_ss: 1.263201, loss_d: 0.400929
0.6912 --- loss: 1.694649, loss_ss: 1.291294, loss_d: 0.403355
0.7296 --- loss: 1.339245, loss_ss: 1.021760, loss_d: 0.317485
0.7680 --- loss: 1.497066, loss_ss: 1.038060, loss_d: 0.459006
0.8065 --- loss: 1.786060, loss_ss: 1.208510, loss_d: 0.577549
0.8449 --- loss: 1.693287, loss_ss: 1.239425, loss_d: 0.453862
0.8833 --- loss: 1.524980, loss_ss: 1.004532, loss_d: 0.520448
0.9217 --- loss: 1.736045, loss_ss: 1.079151, loss_d: 0.656894
0.9601 --- loss: 1.552465, loss_ss: 0.997923, loss_d: 0.554542
0.9985 --- loss: 1.324448, loss_ss: 0.886854, loss_d: 0.437593
Epoch finished! Loss: 1.6644596819694226
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.665447, loss_ss: 1.206599, loss_d: 0.458848
0.0384 --- loss: 1.427154, loss_ss: 1.045955, loss_d: 0.381199
0.0768 --- loss: 1.425540, loss_ss: 1.027492, loss_d: 0.398048
0.1152 --- loss: 1.828893, loss_ss: 1.435196, loss_d: 0.393698
0.1536 --- loss: 1.846497, loss_ss: 1.301682, loss_d: 0.544815
0.1920 --- loss: 1.958490, loss_ss: 1.311525, loss_d: 0.646965
0.2304 --- loss: 1.593317, loss_ss: 1.090693, loss_d: 0.502624
0.2688 --- loss: 1.850797, loss_ss: 1.137400, loss_d: 0.713397
0.3072 --- loss: 1.513685, loss_ss: 0.922311, loss_d: 0.591374
0.3456 --- loss: 1.643025, loss_ss: 1.211983, loss_d: 0.431042
0.3840 --- loss: 1.788861, loss_ss: 1.080885, loss_d: 0.707976
0.4224 --- loss: 1.429496, loss_ss: 0.956027, loss_d: 0.473469
0.4608 --- loss: 1.552009, loss_ss: 1.024834, loss_d: 0.527175
0.4992 --- loss: 1.514025, loss_ss: 1.122621, loss_d: 0.391404
0.5376 --- loss: 1.342702, loss_ss: 0.966614, loss_d: 0.376088
0.5760 --- loss: 1.426212, loss_ss: 1.081263, loss_d: 0.344949
0.6144 --- loss: 1.424077, loss_ss: 1.043692, loss_d: 0.380385
0.6528 --- loss: 1.348918, loss_ss: 1.064118, loss_d: 0.284800
0.6912 --- loss: 1.397907, loss_ss: 1.041947, loss_d: 0.355960
0.7296 --- loss: 1.679359, loss_ss: 1.207680, loss_d: 0.471679
0.7680 --- loss: 1.460280, loss_ss: 1.037330, loss_d: 0.422950
0.8065 --- loss: 2.237062, loss_ss: 1.166569, loss_d: 1.070493
0.8449 --- loss: 1.362616, loss_ss: 1.085105, loss_d: 0.277511
0.8833 --- loss: 1.360876, loss_ss: 1.086347, loss_d: 0.274529
0.9217 --- loss: 1.712930, loss_ss: 0.965631, loss_d: 0.747299
0.9601 --- loss: 1.676205, loss_ss: 1.113634, loss_d: 0.562571
0.9985 --- loss: 2.722512, loss_ss: 1.425097, loss_d: 1.297415
Epoch finished! Loss: 1.6310519585242638
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.309298, loss_ss: 0.847857, loss_d: 0.461441
0.0384 --- loss: 1.629909, loss_ss: 1.231304, loss_d: 0.398605
0.0768 --- loss: 1.147611, loss_ss: 0.775352, loss_d: 0.372259
0.1152 --- loss: 1.509685, loss_ss: 1.108733, loss_d: 0.400952
0.1536 --- loss: 1.622967, loss_ss: 1.186447, loss_d: 0.436520
0.1920 --- loss: 1.420677, loss_ss: 1.084645, loss_d: 0.336032
0.2304 --- loss: 1.509887, loss_ss: 1.108390, loss_d: 0.401497
0.2688 --- loss: 1.701973, loss_ss: 1.078669, loss_d: 0.623304
0.3072 --- loss: 1.280224, loss_ss: 0.931056, loss_d: 0.349167
0.3456 --- loss: 1.760828, loss_ss: 1.170806, loss_d: 0.590022
0.3840 --- loss: 2.097800, loss_ss: 1.031304, loss_d: 1.066496
0.4224 --- loss: 1.548352, loss_ss: 1.040812, loss_d: 0.507539
0.4608 --- loss: 1.516147, loss_ss: 1.057523, loss_d: 0.458624
0.4992 --- loss: 2.253921, loss_ss: 1.266084, loss_d: 0.987837
0.5376 --- loss: 1.995530, loss_ss: 1.313037, loss_d: 0.682493
0.5760 --- loss: 1.553307, loss_ss: 1.225216, loss_d: 0.328091
0.6144 --- loss: 1.619130, loss_ss: 1.261726, loss_d: 0.357405
0.6528 --- loss: 1.730414, loss_ss: 1.325241, loss_d: 0.405173
0.6912 --- loss: 1.455186, loss_ss: 1.131035, loss_d: 0.324150
0.7296 --- loss: 1.407882, loss_ss: 0.804312, loss_d: 0.603570
0.7680 --- loss: 1.351217, loss_ss: 1.019172, loss_d: 0.332045
0.8065 --- loss: 1.152976, loss_ss: 0.847756, loss_d: 0.305220
0.8449 --- loss: 2.034009, loss_ss: 1.435506, loss_d: 0.598503
0.8833 --- loss: 1.517675, loss_ss: 0.881805, loss_d: 0.635871
0.9217 --- loss: 1.423317, loss_ss: 1.045004, loss_d: 0.378313
0.9601 --- loss: 1.784803, loss_ss: 0.985859, loss_d: 0.798944
0.9985 --- loss: 1.285836, loss_ss: 0.925439, loss_d: 0.360396
Epoch finished! Loss: 1.5850978397406064
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.717601, loss_ss: 1.164556, loss_d: 0.553045
0.0384 --- loss: 1.287122, loss_ss: 1.014100, loss_d: 0.273023
0.0768 --- loss: 1.476000, loss_ss: 1.089556, loss_d: 0.386444
0.1152 --- loss: 1.489012, loss_ss: 1.107574, loss_d: 0.381438
0.1536 --- loss: 1.128329, loss_ss: 0.826006, loss_d: 0.302324
0.1920 --- loss: 1.202774, loss_ss: 0.813254, loss_d: 0.389520
0.2304 --- loss: 1.549062, loss_ss: 1.169770, loss_d: 0.379292
0.2688 --- loss: 1.448189, loss_ss: 1.099939, loss_d: 0.348250
0.3072 --- loss: 1.442771, loss_ss: 1.086962, loss_d: 0.355808
0.3456 --- loss: 1.583581, loss_ss: 1.099714, loss_d: 0.483867
0.3840 --- loss: 1.322561, loss_ss: 1.011444, loss_d: 0.311118
0.4224 --- loss: 1.898304, loss_ss: 0.988705, loss_d: 0.909599
0.4608 --- loss: 1.751261, loss_ss: 1.209376, loss_d: 0.541885
0.4992 --- loss: 1.637133, loss_ss: 0.980185, loss_d: 0.656947
0.5376 --- loss: 1.445485, loss_ss: 0.984876, loss_d: 0.460609
0.5760 --- loss: 1.422354, loss_ss: 0.954016, loss_d: 0.468338
0.6144 --- loss: 1.669374, loss_ss: 1.165507, loss_d: 0.503867
0.6528 --- loss: 1.736784, loss_ss: 1.403770, loss_d: 0.333014
0.6912 --- loss: 1.390617, loss_ss: 0.957901, loss_d: 0.432715
0.7296 --- loss: 1.290994, loss_ss: 0.980809, loss_d: 0.310185
0.7680 --- loss: 1.189333, loss_ss: 0.789400, loss_d: 0.399933
0.8065 --- loss: 1.919958, loss_ss: 1.295572, loss_d: 0.624386
0.8449 --- loss: 1.371417, loss_ss: 0.966291, loss_d: 0.405126
0.8833 --- loss: 1.499620, loss_ss: 1.110345, loss_d: 0.389275
0.9217 --- loss: 1.438787, loss_ss: 1.136405, loss_d: 0.302382
0.9601 --- loss: 2.039744, loss_ss: 1.230913, loss_d: 0.808831
0.9985 --- loss: 1.390904, loss_ss: 1.068196, loss_d: 0.322708
Epoch finished! Loss: 1.5729047066890276
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.610979, loss_ss: 1.096925, loss_d: 0.514054
0.0384 --- loss: 1.236104, loss_ss: 0.956934, loss_d: 0.279170
0.0768 --- loss: 2.064742, loss_ss: 1.240586, loss_d: 0.824156
0.1152 --- loss: 1.667498, loss_ss: 1.150659, loss_d: 0.516839
0.1536 --- loss: 1.698465, loss_ss: 1.059580, loss_d: 0.638885
0.1920 --- loss: 1.400829, loss_ss: 1.069131, loss_d: 0.331698
0.2304 --- loss: 1.193650, loss_ss: 0.936680, loss_d: 0.256970
0.2688 --- loss: 1.577109, loss_ss: 1.216686, loss_d: 0.360423
0.3072 --- loss: 2.324364, loss_ss: 1.211758, loss_d: 1.112606
0.3456 --- loss: 1.679326, loss_ss: 1.056556, loss_d: 0.622769
0.3840 --- loss: 1.566478, loss_ss: 1.200149, loss_d: 0.366329
0.4224 --- loss: 1.273212, loss_ss: 0.897384, loss_d: 0.375828
0.4608 --- loss: 1.123493, loss_ss: 0.864342, loss_d: 0.259151
0.4992 --- loss: 1.536881, loss_ss: 1.146662, loss_d: 0.390219
0.5376 --- loss: 1.329088, loss_ss: 0.978971, loss_d: 0.350117
0.5760 --- loss: 1.521387, loss_ss: 1.035321, loss_d: 0.486066
0.6144 --- loss: 1.109730, loss_ss: 0.830354, loss_d: 0.279376
0.6528 --- loss: 1.430399, loss_ss: 1.142681, loss_d: 0.287717
0.6912 --- loss: 1.329586, loss_ss: 0.995696, loss_d: 0.333890
0.7296 --- loss: 1.194680, loss_ss: 0.913638, loss_d: 0.281042
0.7680 --- loss: 1.283797, loss_ss: 0.879350, loss_d: 0.404447
0.8065 --- loss: 1.593141, loss_ss: 1.093546, loss_d: 0.499596
0.8449 --- loss: 1.409514, loss_ss: 0.852002, loss_d: 0.557513
0.8833 --- loss: 1.676410, loss_ss: 1.281770, loss_d: 0.394640
0.9217 --- loss: 1.835595, loss_ss: 1.219238, loss_d: 0.616358
0.9601 --- loss: 1.551206, loss_ss: 1.267477, loss_d: 0.283729
0.9985 --- loss: 1.066093, loss_ss: 0.851013, loss_d: 0.215079
Epoch finished! Loss: 1.534872706578328
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.674713, loss_ss: 1.045311, loss_d: 0.629402
0.0384 --- loss: 1.456914, loss_ss: 1.099484, loss_d: 0.357430
0.0768 --- loss: 1.303861, loss_ss: 0.802122, loss_d: 0.501739
0.1152 --- loss: 1.434954, loss_ss: 1.068493, loss_d: 0.366461
0.1536 --- loss: 1.277639, loss_ss: 1.039016, loss_d: 0.238623
0.1920 --- loss: 1.815027, loss_ss: 1.190294, loss_d: 0.624732
0.2304 --- loss: 1.319839, loss_ss: 0.979952, loss_d: 0.339887
0.2688 --- loss: 1.328085, loss_ss: 0.882811, loss_d: 0.445274
0.3072 --- loss: 1.170261, loss_ss: 0.904707, loss_d: 0.265554
0.3456 --- loss: 1.504152, loss_ss: 1.240745, loss_d: 0.263407
0.3840 --- loss: 1.634580, loss_ss: 1.148536, loss_d: 0.486044
0.4224 --- loss: 1.534408, loss_ss: 1.129716, loss_d: 0.404692
0.4608 --- loss: 1.239991, loss_ss: 0.966147, loss_d: 0.273844
0.4992 --- loss: 1.571891, loss_ss: 1.126285, loss_d: 0.445606
0.5376 --- loss: 1.443856, loss_ss: 1.122088, loss_d: 0.321768
0.5760 --- loss: 1.260934, loss_ss: 0.975583, loss_d: 0.285352
0.6144 --- loss: 1.668927, loss_ss: 0.955260, loss_d: 0.713667
0.6528 --- loss: 1.459424, loss_ss: 0.950415, loss_d: 0.509009
0.6912 --- loss: 1.296598, loss_ss: 1.021230, loss_d: 0.275368
0.7296 --- loss: 1.085047, loss_ss: 0.857937, loss_d: 0.227111
0.7680 --- loss: 0.905323, loss_ss: 0.735415, loss_d: 0.169908
0.8065 --- loss: 1.725428, loss_ss: 1.215377, loss_d: 0.510051
0.8449 --- loss: 1.153330, loss_ss: 0.813078, loss_d: 0.340252
0.8833 --- loss: 1.553052, loss_ss: 1.062786, loss_d: 0.490266
0.9217 --- loss: 1.383675, loss_ss: 0.898625, loss_d: 0.485050
0.9601 --- loss: 1.370938, loss_ss: 1.091341, loss_d: 0.279596
0.9985 --- loss: 1.109672, loss_ss: 0.769573, loss_d: 0.340099
Epoch finished! Loss: 1.5015265490000065
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.284036, loss_ss: 0.717025, loss_d: 0.567011
0.0384 --- loss: 1.384561, loss_ss: 1.157968, loss_d: 0.226593
0.0768 --- loss: 1.339103, loss_ss: 1.136687, loss_d: 0.202417
0.1152 --- loss: 1.938371, loss_ss: 1.404667, loss_d: 0.533704
0.1536 --- loss: 1.323341, loss_ss: 1.083183, loss_d: 0.240158
0.1920 --- loss: 1.173292, loss_ss: 0.960269, loss_d: 0.213023
0.2304 --- loss: 1.294331, loss_ss: 1.052761, loss_d: 0.241569
0.2688 --- loss: 2.203847, loss_ss: 1.223938, loss_d: 0.979909
0.3072 --- loss: 1.483708, loss_ss: 0.942669, loss_d: 0.541039
0.3456 --- loss: 1.862568, loss_ss: 1.343671, loss_d: 0.518896
0.3840 --- loss: 1.476886, loss_ss: 1.182240, loss_d: 0.294645
0.4224 --- loss: 1.730081, loss_ss: 1.222560, loss_d: 0.507521
0.4608 --- loss: 1.366514, loss_ss: 0.999766, loss_d: 0.366747
0.4992 --- loss: 1.149027, loss_ss: 0.905346, loss_d: 0.243682
0.5376 --- loss: 1.593871, loss_ss: 0.865019, loss_d: 0.728852
0.5760 --- loss: 2.136689, loss_ss: 1.875732, loss_d: 0.260958
0.6144 --- loss: 1.564535, loss_ss: 0.878017, loss_d: 0.686518
0.6528 --- loss: 1.817063, loss_ss: 1.304657, loss_d: 0.512406
0.6912 --- loss: 1.359440, loss_ss: 0.938463, loss_d: 0.420977
0.7296 --- loss: 1.198116, loss_ss: 0.783287, loss_d: 0.414829
0.7680 --- loss: 1.818922, loss_ss: 1.555428, loss_d: 0.263494
0.8065 --- loss: 1.759172, loss_ss: 0.873142, loss_d: 0.886030
0.8449 --- loss: 1.435865, loss_ss: 0.920994, loss_d: 0.514871
0.8833 --- loss: 1.484272, loss_ss: 0.967360, loss_d: 0.516912
0.9217 --- loss: 1.599743, loss_ss: 0.877686, loss_d: 0.722056
0.9601 --- loss: 1.433470, loss_ss: 1.053668, loss_d: 0.379801
0.9985 --- loss: 1.234413, loss_ss: 0.954825, loss_d: 0.279588
Epoch finished! Loss: 1.49161808857551
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.515686274509804
             precision    recall  f1-score   support

        0.0       0.95      0.50      0.65       105
        1.0       0.00      0.00      0.00        44
        2.0       0.49      0.79      0.60       317
        3.0       0.50      0.87      0.63       258
        4.0       0.00      0.00      0.00       296

avg / total       0.37      0.52      0.41      1020
 


====== chp058-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  4  has ZeroDivisionError.


The f1-score of  4  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.51  49.52   99.67  94.55     65.00
1  95.69   0.00  100.00   0.00      0.00
2  67.55  78.86   62.45  48.64     60.17
3  74.41  86.82   70.21  49.67     63.19
4  70.98   0.00  100.00   0.00      0.00
Total accuracy: 51.57%
Average sen: 43.04%
Average spec: 86.47%
Macro f1-score: 37.67%
[0.60742563 0.90798271 0.94408768 0.73140776 0.90220243 0.85042721
 0.7543323  0.73596442 0.92512554 0.93680906 0.63933879 0.8029719
 0.78843796 0.91218072 0.57066965 0.75013506 0.6821779  0.62108743
 0.8686046  0.92670858 0.92554504 0.91475809 0.83549285 0.62380463
 0.92114675 0.91627586 0.65343517 0.44231871 0.511329   0.58486241
 0.57654369 0.90924501 0.89828986 0.92748857]
pred: 0.779370969709228, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.330581, loss_ss: 1.676499, loss_d: 0.654082
0.0384 --- loss: 2.525870, loss_ss: 1.713193, loss_d: 0.812677
0.0769 --- loss: 1.912185, loss_ss: 1.516548, loss_d: 0.395637
0.1153 --- loss: 2.236724, loss_ss: 1.455086, loss_d: 0.781639
0.1538 --- loss: 2.165878, loss_ss: 1.548654, loss_d: 0.617224
0.1922 --- loss: 1.913153, loss_ss: 1.539165, loss_d: 0.373988
0.2307 --- loss: 2.041230, loss_ss: 1.529190, loss_d: 0.512040
0.2691 --- loss: 2.323117, loss_ss: 1.288883, loss_d: 1.034234
0.3076 --- loss: 2.578205, loss_ss: 1.350219, loss_d: 1.227986
0.3460 --- loss: 2.215242, loss_ss: 1.640757, loss_d: 0.574486
0.3845 --- loss: 2.024678, loss_ss: 1.538896, loss_d: 0.485782
0.4229 --- loss: 1.921952, loss_ss: 1.536314, loss_d: 0.385638
0.4614 --- loss: 2.312093, loss_ss: 1.570840, loss_d: 0.741253
0.4998 --- loss: 2.713449, loss_ss: 1.507384, loss_d: 1.206066
0.5383 --- loss: 1.757471, loss_ss: 1.289351, loss_d: 0.468120
0.5767 --- loss: 2.095776, loss_ss: 1.445464, loss_d: 0.650312
0.6151 --- loss: 2.055110, loss_ss: 1.660212, loss_d: 0.394898
0.6536 --- loss: 2.834968, loss_ss: 1.647337, loss_d: 1.187631
0.6920 --- loss: 1.780854, loss_ss: 1.395638, loss_d: 0.385217
0.7305 --- loss: 2.135061, loss_ss: 1.611099, loss_d: 0.523962
0.7689 --- loss: 2.047582, loss_ss: 1.635868, loss_d: 0.411713
0.8074 --- loss: 2.049083, loss_ss: 1.603037, loss_d: 0.446046
0.8458 --- loss: 2.059643, loss_ss: 1.419061, loss_d: 0.640582
0.8843 --- loss: 2.008029, loss_ss: 1.509742, loss_d: 0.498288
0.9227 --- loss: 2.180398, loss_ss: 1.450172, loss_d: 0.730226
0.9612 --- loss: 1.790818, loss_ss: 1.332715, loss_d: 0.458103
0.9996 --- loss: 3.411863, loss_ss: 1.917034, loss_d: 1.494829
Epoch finished! Loss: 2.0732789709017827
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.774116, loss_ss: 1.432661, loss_d: 0.341456
0.0384 --- loss: 2.031520, loss_ss: 1.534286, loss_d: 0.497234
0.0769 --- loss: 1.914229, loss_ss: 1.517394, loss_d: 0.396836
0.1153 --- loss: 2.311340, loss_ss: 1.369966, loss_d: 0.941374
0.1538 --- loss: 2.172956, loss_ss: 1.540416, loss_d: 0.632540
0.1922 --- loss: 1.955787, loss_ss: 1.441464, loss_d: 0.514323
0.2307 --- loss: 1.962237, loss_ss: 1.494978, loss_d: 0.467258
0.2691 --- loss: 1.833066, loss_ss: 1.397990, loss_d: 0.435075
0.3076 --- loss: 1.926678, loss_ss: 1.361165, loss_d: 0.565513
0.3460 --- loss: 1.944958, loss_ss: 1.409680, loss_d: 0.535278
0.3845 --- loss: 1.917831, loss_ss: 1.202758, loss_d: 0.715073
0.4229 --- loss: 2.125182, loss_ss: 1.466558, loss_d: 0.658624
0.4614 --- loss: 1.709158, loss_ss: 1.211216, loss_d: 0.497942
0.4998 --- loss: 1.919873, loss_ss: 1.273196, loss_d: 0.646677
0.5383 --- loss: 2.290773, loss_ss: 1.509839, loss_d: 0.780934
0.5767 --- loss: 2.058262, loss_ss: 1.318223, loss_d: 0.740040
0.6151 --- loss: 1.539850, loss_ss: 1.207008, loss_d: 0.332842
0.6536 --- loss: 1.871117, loss_ss: 1.160046, loss_d: 0.711072
0.6920 --- loss: 1.956055, loss_ss: 1.228043, loss_d: 0.728012
0.7305 --- loss: 1.693522, loss_ss: 1.133643, loss_d: 0.559879
0.7689 --- loss: 1.752311, loss_ss: 1.057645, loss_d: 0.694666
0.8074 --- loss: 1.589675, loss_ss: 1.356135, loss_d: 0.233540
0.8458 --- loss: 1.517062, loss_ss: 1.215922, loss_d: 0.301140
0.8843 --- loss: 1.611568, loss_ss: 1.200167, loss_d: 0.411401
0.9227 --- loss: 1.465497, loss_ss: 1.152403, loss_d: 0.313095
0.9612 --- loss: 1.660761, loss_ss: 1.359660, loss_d: 0.301102
0.9996 --- loss: 2.047064, loss_ss: 1.677823, loss_d: 0.369241
Epoch finished! Loss: 1.8851138825599965
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.859587, loss_ss: 1.484083, loss_d: 0.375504
0.0384 --- loss: 1.723821, loss_ss: 1.223994, loss_d: 0.499827
0.0769 --- loss: 1.872097, loss_ss: 1.151215, loss_d: 0.720882
0.1153 --- loss: 1.728580, loss_ss: 1.139003, loss_d: 0.589577
0.1538 --- loss: 1.544200, loss_ss: 1.192798, loss_d: 0.351402
0.1922 --- loss: 1.791529, loss_ss: 1.463277, loss_d: 0.328252
0.2307 --- loss: 1.501491, loss_ss: 1.233524, loss_d: 0.267967
0.2691 --- loss: 2.074266, loss_ss: 1.397565, loss_d: 0.676701
0.3076 --- loss: 1.598673, loss_ss: 1.068576, loss_d: 0.530097
0.3460 --- loss: 1.737600, loss_ss: 1.162642, loss_d: 0.574958
0.3845 --- loss: 1.988152, loss_ss: 1.491460, loss_d: 0.496692
0.4229 --- loss: 1.904093, loss_ss: 1.381189, loss_d: 0.522904
0.4614 --- loss: 1.927110, loss_ss: 1.281134, loss_d: 0.645977
0.4998 --- loss: 1.660610, loss_ss: 1.096485, loss_d: 0.564125
0.5383 --- loss: 1.559852, loss_ss: 1.092472, loss_d: 0.467380
0.5767 --- loss: 1.966891, loss_ss: 1.275573, loss_d: 0.691318
0.6151 --- loss: 1.925508, loss_ss: 1.317469, loss_d: 0.608040
0.6536 --- loss: 1.964221, loss_ss: 1.340498, loss_d: 0.623722
0.6920 --- loss: 1.748789, loss_ss: 1.260493, loss_d: 0.488296
0.7305 --- loss: 1.613999, loss_ss: 1.164588, loss_d: 0.449411
0.7689 --- loss: 1.753310, loss_ss: 1.281173, loss_d: 0.472137
0.8074 --- loss: 2.008895, loss_ss: 1.268501, loss_d: 0.740394
0.8458 --- loss: 1.417824, loss_ss: 1.025289, loss_d: 0.392535
0.8843 --- loss: 1.823996, loss_ss: 1.419775, loss_d: 0.404221
0.9227 --- loss: 1.483457, loss_ss: 1.123243, loss_d: 0.360214
0.9612 --- loss: 1.798439, loss_ss: 1.423561, loss_d: 0.374878
0.9996 --- loss: 3.330732, loss_ss: 1.765936, loss_d: 1.564795
Epoch finished! Loss: 1.799565414281992
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.756190, loss_ss: 1.011203, loss_d: 0.744987
0.0384 --- loss: 1.755289, loss_ss: 1.250605, loss_d: 0.504684
0.0769 --- loss: 1.681184, loss_ss: 1.068435, loss_d: 0.612749
0.1153 --- loss: 1.716937, loss_ss: 1.076582, loss_d: 0.640354
0.1538 --- loss: 1.728206, loss_ss: 1.192267, loss_d: 0.535940
0.1922 --- loss: 2.001400, loss_ss: 1.292701, loss_d: 0.708699
0.2307 --- loss: 1.410897, loss_ss: 1.031331, loss_d: 0.379566
0.2691 --- loss: 1.509885, loss_ss: 1.110063, loss_d: 0.399822
0.3076 --- loss: 1.460461, loss_ss: 1.091488, loss_d: 0.368973
0.3460 --- loss: 1.625227, loss_ss: 1.200186, loss_d: 0.425041
0.3845 --- loss: 1.630256, loss_ss: 1.246648, loss_d: 0.383608
0.4229 --- loss: 1.559441, loss_ss: 1.064560, loss_d: 0.494881
0.4614 --- loss: 1.683930, loss_ss: 1.299819, loss_d: 0.384111
0.4998 --- loss: 1.942606, loss_ss: 1.128284, loss_d: 0.814322
0.5383 --- loss: 1.582342, loss_ss: 0.992093, loss_d: 0.590249
0.5767 --- loss: 1.578598, loss_ss: 1.191671, loss_d: 0.386927
0.6151 --- loss: 1.555148, loss_ss: 1.055153, loss_d: 0.499995
0.6536 --- loss: 1.415805, loss_ss: 1.023418, loss_d: 0.392387
0.6920 --- loss: 1.566980, loss_ss: 1.026349, loss_d: 0.540631
0.7305 --- loss: 1.454021, loss_ss: 1.099407, loss_d: 0.354614
0.7689 --- loss: 1.603294, loss_ss: 1.074724, loss_d: 0.528569
0.8074 --- loss: 1.539502, loss_ss: 1.145990, loss_d: 0.393512
0.8458 --- loss: 1.722507, loss_ss: 1.183294, loss_d: 0.539213
0.8843 --- loss: 1.801868, loss_ss: 1.429151, loss_d: 0.372717
0.9227 --- loss: 1.876135, loss_ss: 1.559827, loss_d: 0.316308
0.9612 --- loss: 1.397985, loss_ss: 1.109938, loss_d: 0.288047
0.9996 --- loss: 5.311959, loss_ss: 2.179414, loss_d: 3.132545
Epoch finished! Loss: 1.7103927470170535
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.859459, loss_ss: 1.339160, loss_d: 0.520299
0.0384 --- loss: 1.497178, loss_ss: 1.158752, loss_d: 0.338426
0.0769 --- loss: 1.712332, loss_ss: 1.055677, loss_d: 0.656655
0.1153 --- loss: 1.466986, loss_ss: 1.087642, loss_d: 0.379343
0.1538 --- loss: 1.469485, loss_ss: 1.028128, loss_d: 0.441357
0.1922 --- loss: 2.066169, loss_ss: 1.186797, loss_d: 0.879371
0.2307 --- loss: 1.496341, loss_ss: 1.055040, loss_d: 0.441301
0.2691 --- loss: 1.421901, loss_ss: 0.979619, loss_d: 0.442281
0.3076 --- loss: 1.561465, loss_ss: 1.131316, loss_d: 0.430149
0.3460 --- loss: 1.553389, loss_ss: 0.956031, loss_d: 0.597358
0.3845 --- loss: 1.558229, loss_ss: 1.114593, loss_d: 0.443636
0.4229 --- loss: 1.368240, loss_ss: 0.985557, loss_d: 0.382683
0.4614 --- loss: 1.739128, loss_ss: 1.203412, loss_d: 0.535716
0.4998 --- loss: 1.625879, loss_ss: 1.315471, loss_d: 0.310408
0.5383 --- loss: 1.564150, loss_ss: 1.051292, loss_d: 0.512858
0.5767 --- loss: 1.694785, loss_ss: 1.284289, loss_d: 0.410496
0.6151 --- loss: 1.664892, loss_ss: 1.228707, loss_d: 0.436185
0.6536 --- loss: 1.547717, loss_ss: 0.970543, loss_d: 0.577174
0.6920 --- loss: 1.555259, loss_ss: 1.062612, loss_d: 0.492647
0.7305 --- loss: 1.266222, loss_ss: 0.933452, loss_d: 0.332770
0.7689 --- loss: 2.004414, loss_ss: 1.386957, loss_d: 0.617457
0.8074 --- loss: 1.354528, loss_ss: 0.958666, loss_d: 0.395862
0.8458 --- loss: 1.821329, loss_ss: 1.139632, loss_d: 0.681697
0.8843 --- loss: 1.788868, loss_ss: 1.257260, loss_d: 0.531608
0.9227 --- loss: 1.652030, loss_ss: 1.159769, loss_d: 0.492261
0.9612 --- loss: 1.893840, loss_ss: 1.114693, loss_d: 0.779147
0.9996 --- loss: 1.482498, loss_ss: 1.322498, loss_d: 0.160001
Epoch finished! Loss: 1.625990139062588
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.699038, loss_ss: 1.354471, loss_d: 0.344567
0.0384 --- loss: 1.480356, loss_ss: 0.788219, loss_d: 0.692138
0.0769 --- loss: 1.280750, loss_ss: 1.032184, loss_d: 0.248566
0.1153 --- loss: 1.549741, loss_ss: 1.043071, loss_d: 0.506670
0.1538 --- loss: 1.802664, loss_ss: 1.318655, loss_d: 0.484010
0.1922 --- loss: 1.910529, loss_ss: 1.478175, loss_d: 0.432354
0.2307 --- loss: 1.477697, loss_ss: 1.113480, loss_d: 0.364217
0.2691 --- loss: 1.757518, loss_ss: 1.055170, loss_d: 0.702349
0.3076 --- loss: 1.743696, loss_ss: 1.504296, loss_d: 0.239400
0.3460 --- loss: 1.366437, loss_ss: 1.098074, loss_d: 0.268363
0.3845 --- loss: 2.089428, loss_ss: 1.123251, loss_d: 0.966177
0.4229 --- loss: 1.365113, loss_ss: 1.024128, loss_d: 0.340986
0.4614 --- loss: 1.461104, loss_ss: 0.943250, loss_d: 0.517854
0.4998 --- loss: 1.753165, loss_ss: 0.945845, loss_d: 0.807320
0.5383 --- loss: 1.465847, loss_ss: 1.048896, loss_d: 0.416951
0.5767 --- loss: 1.460592, loss_ss: 0.821433, loss_d: 0.639159
0.6151 --- loss: 1.566704, loss_ss: 0.925064, loss_d: 0.641640
0.6536 --- loss: 1.422715, loss_ss: 0.981691, loss_d: 0.441024
0.6920 --- loss: 1.584986, loss_ss: 0.973842, loss_d: 0.611144
0.7305 --- loss: 1.385743, loss_ss: 1.038582, loss_d: 0.347161
0.7689 --- loss: 1.693942, loss_ss: 1.159680, loss_d: 0.534262
0.8074 --- loss: 1.578777, loss_ss: 1.148233, loss_d: 0.430544
0.8458 --- loss: 1.513768, loss_ss: 1.139165, loss_d: 0.374603
0.8843 --- loss: 1.649639, loss_ss: 1.225574, loss_d: 0.424064
0.9227 --- loss: 1.499749, loss_ss: 1.136003, loss_d: 0.363746
0.9612 --- loss: 1.366093, loss_ss: 1.069784, loss_d: 0.296309
0.9996 --- loss: 2.895873, loss_ss: 2.837598, loss_d: 0.058275
Epoch finished! Loss: 1.5770855027895707
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.370505, loss_ss: 1.150685, loss_d: 0.219820
0.0384 --- loss: 1.637926, loss_ss: 1.323250, loss_d: 0.314676
0.0769 --- loss: 1.378886, loss_ss: 1.086514, loss_d: 0.292373
0.1153 --- loss: 1.839901, loss_ss: 1.308920, loss_d: 0.530982
0.1538 --- loss: 1.510718, loss_ss: 1.125393, loss_d: 0.385325
0.1922 --- loss: 1.431993, loss_ss: 1.078856, loss_d: 0.353137
0.2307 --- loss: 1.582249, loss_ss: 1.218763, loss_d: 0.363486
0.2691 --- loss: 1.632766, loss_ss: 1.152119, loss_d: 0.480647
0.3076 --- loss: 1.244538, loss_ss: 0.879097, loss_d: 0.365441
0.3460 --- loss: 1.397034, loss_ss: 0.947990, loss_d: 0.449044
0.3845 --- loss: 1.853876, loss_ss: 1.208051, loss_d: 0.645825
0.4229 --- loss: 1.835512, loss_ss: 1.477244, loss_d: 0.358267
0.4614 --- loss: 1.443500, loss_ss: 0.989839, loss_d: 0.453661
0.4998 --- loss: 1.994278, loss_ss: 1.242850, loss_d: 0.751428
0.5383 --- loss: 1.298531, loss_ss: 1.007473, loss_d: 0.291057
0.5767 --- loss: 1.450014, loss_ss: 1.159319, loss_d: 0.290695
0.6151 --- loss: 1.415367, loss_ss: 0.959435, loss_d: 0.455933
0.6536 --- loss: 1.463910, loss_ss: 1.179779, loss_d: 0.284131
0.6920 --- loss: 1.904133, loss_ss: 1.561992, loss_d: 0.342141
0.7305 --- loss: 1.692961, loss_ss: 1.316522, loss_d: 0.376439
0.7689 --- loss: 1.017526, loss_ss: 0.732559, loss_d: 0.284967
0.8074 --- loss: 1.292233, loss_ss: 0.907423, loss_d: 0.384811
0.8458 --- loss: 1.568371, loss_ss: 1.238531, loss_d: 0.329840
0.8843 --- loss: 1.416974, loss_ss: 1.183086, loss_d: 0.233888
0.9227 --- loss: 1.453155, loss_ss: 1.036555, loss_d: 0.416600
0.9612 --- loss: 1.546194, loss_ss: 1.277993, loss_d: 0.268200
0.9996 --- loss: 1.688568, loss_ss: 1.509367, loss_d: 0.179201
Epoch finished! Loss: 1.5671024441719055
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.624424, loss_ss: 0.989684, loss_d: 0.634741
0.0384 --- loss: 1.535242, loss_ss: 1.079798, loss_d: 0.455444
0.0769 --- loss: 1.314067, loss_ss: 0.974905, loss_d: 0.339162
0.1153 --- loss: 1.456101, loss_ss: 1.070387, loss_d: 0.385714
0.1538 --- loss: 1.875728, loss_ss: 0.953609, loss_d: 0.922118
0.1922 --- loss: 1.939065, loss_ss: 1.355716, loss_d: 0.583348
0.2307 --- loss: 1.626081, loss_ss: 1.221707, loss_d: 0.404375
0.2691 --- loss: 1.259475, loss_ss: 0.912358, loss_d: 0.347117
0.3076 --- loss: 1.390507, loss_ss: 1.081224, loss_d: 0.309284
0.3460 --- loss: 1.353899, loss_ss: 0.956603, loss_d: 0.397296
0.3845 --- loss: 1.440296, loss_ss: 1.051309, loss_d: 0.388986
0.4229 --- loss: 1.533078, loss_ss: 1.114530, loss_d: 0.418548
0.4614 --- loss: 1.356682, loss_ss: 0.984451, loss_d: 0.372230
0.4998 --- loss: 1.510098, loss_ss: 1.141306, loss_d: 0.368792
0.5383 --- loss: 1.418856, loss_ss: 1.110054, loss_d: 0.308802
0.5767 --- loss: 1.603347, loss_ss: 0.849275, loss_d: 0.754072
0.6151 --- loss: 1.818728, loss_ss: 1.279852, loss_d: 0.538876
0.6536 --- loss: 1.511627, loss_ss: 0.990752, loss_d: 0.520875
0.6920 --- loss: 1.554437, loss_ss: 1.010021, loss_d: 0.544416
0.7305 --- loss: 1.978810, loss_ss: 1.754484, loss_d: 0.224326
0.7689 --- loss: 1.359840, loss_ss: 1.059551, loss_d: 0.300289
0.8074 --- loss: 1.413045, loss_ss: 1.055902, loss_d: 0.357142
0.8458 --- loss: 1.195164, loss_ss: 0.886616, loss_d: 0.308548
0.8843 --- loss: 1.369752, loss_ss: 0.953614, loss_d: 0.416138
0.9227 --- loss: 1.615114, loss_ss: 1.172867, loss_d: 0.442246
0.9612 --- loss: 1.600446, loss_ss: 1.075052, loss_d: 0.525394
0.9996 --- loss: 1.345395, loss_ss: 1.211845, loss_d: 0.133549
Epoch finished! Loss: 1.5312873831162086
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.440859, loss_ss: 0.967603, loss_d: 0.473256
0.0384 --- loss: 1.351408, loss_ss: 0.861173, loss_d: 0.490235
0.0769 --- loss: 2.122520, loss_ss: 1.685340, loss_d: 0.437181
0.1153 --- loss: 1.674659, loss_ss: 1.211664, loss_d: 0.462995
0.1538 --- loss: 1.477528, loss_ss: 1.171445, loss_d: 0.306083
0.1922 --- loss: 1.801949, loss_ss: 1.264769, loss_d: 0.537180
0.2307 --- loss: 1.542236, loss_ss: 1.202487, loss_d: 0.339749
0.2691 --- loss: 1.365485, loss_ss: 1.033987, loss_d: 0.331498
0.3076 --- loss: 1.447687, loss_ss: 1.054335, loss_d: 0.393353
0.3460 --- loss: 1.514645, loss_ss: 1.128083, loss_d: 0.386561
0.3845 --- loss: 1.383438, loss_ss: 1.019584, loss_d: 0.363854
0.4229 --- loss: 1.174919, loss_ss: 0.868046, loss_d: 0.306872
0.4614 --- loss: 1.251245, loss_ss: 0.943643, loss_d: 0.307602
0.4998 --- loss: 1.183105, loss_ss: 0.888785, loss_d: 0.294319
0.5383 --- loss: 1.521301, loss_ss: 1.162324, loss_d: 0.358977
0.5767 --- loss: 1.226232, loss_ss: 0.871565, loss_d: 0.354667
0.6151 --- loss: 1.700651, loss_ss: 1.256361, loss_d: 0.444291
0.6536 --- loss: 1.714527, loss_ss: 1.095288, loss_d: 0.619239
0.6920 --- loss: 1.478236, loss_ss: 1.152236, loss_d: 0.326000
0.7305 --- loss: 1.445012, loss_ss: 1.052826, loss_d: 0.392186
0.7689 --- loss: 1.655779, loss_ss: 0.934809, loss_d: 0.720970
0.8074 --- loss: 1.234833, loss_ss: 0.988647, loss_d: 0.246186
0.8458 --- loss: 1.477919, loss_ss: 1.014941, loss_d: 0.462979
0.8843 --- loss: 1.526424, loss_ss: 0.947690, loss_d: 0.578735
0.9227 --- loss: 1.531553, loss_ss: 0.908799, loss_d: 0.622754
0.9612 --- loss: 1.297884, loss_ss: 1.002340, loss_d: 0.295544
0.9996 --- loss: 3.087739, loss_ss: 1.170671, loss_d: 1.917067
Epoch finished! Loss: 1.5155071668899975
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.286185, loss_ss: 0.967528, loss_d: 0.318657
0.0384 --- loss: 1.809704, loss_ss: 1.447380, loss_d: 0.362324
0.0769 --- loss: 1.739594, loss_ss: 1.266716, loss_d: 0.472878
0.1153 --- loss: 1.448515, loss_ss: 1.137265, loss_d: 0.311251
0.1538 --- loss: 1.608058, loss_ss: 1.144150, loss_d: 0.463907
0.1922 --- loss: 1.879354, loss_ss: 1.552653, loss_d: 0.326700
0.2307 --- loss: 1.220783, loss_ss: 0.764700, loss_d: 0.456083
0.2691 --- loss: 1.462563, loss_ss: 1.204528, loss_d: 0.258035
0.3076 --- loss: 1.533248, loss_ss: 1.216422, loss_d: 0.316826
0.3460 --- loss: 1.557156, loss_ss: 1.308305, loss_d: 0.248852
0.3845 --- loss: 1.297006, loss_ss: 0.895772, loss_d: 0.401234
0.4229 --- loss: 1.335332, loss_ss: 1.045209, loss_d: 0.290123
0.4614 --- loss: 1.305790, loss_ss: 0.919989, loss_d: 0.385801
0.4998 --- loss: 1.594460, loss_ss: 1.084400, loss_d: 0.510060
0.5383 --- loss: 1.527856, loss_ss: 1.167596, loss_d: 0.360260
0.5767 --- loss: 1.204451, loss_ss: 0.990920, loss_d: 0.213531
0.6151 --- loss: 1.641390, loss_ss: 1.004014, loss_d: 0.637376
0.6536 --- loss: 1.078175, loss_ss: 0.842510, loss_d: 0.235665
0.6920 --- loss: 1.372123, loss_ss: 0.821061, loss_d: 0.551062
0.7305 --- loss: 1.402794, loss_ss: 1.068261, loss_d: 0.334533
0.7689 --- loss: 1.487579, loss_ss: 0.912467, loss_d: 0.575112
0.8074 --- loss: 1.183246, loss_ss: 0.894307, loss_d: 0.288939
0.8458 --- loss: 1.155799, loss_ss: 0.851811, loss_d: 0.303988
0.8843 --- loss: 1.060321, loss_ss: 0.856817, loss_d: 0.203505
0.9227 --- loss: 1.603237, loss_ss: 0.985293, loss_d: 0.617944
0.9612 --- loss: 1.368902, loss_ss: 1.082583, loss_d: 0.286319
0.9996 --- loss: 3.008772, loss_ss: 2.698674, loss_d: 0.310098
Epoch finished! Loss: 1.515612376653231
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.47297297297297297
             precision    recall  f1-score   support

        0.0       0.96      0.40      0.57       247
        1.0       0.00      0.00      0.00       254
        2.0       0.64      0.76      0.69       355
        3.0       0.00      0.00      0.00        87
        4.0       0.27      0.92      0.41       167

avg / total       0.46      0.47      0.41      1110
 


====== chp059-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.


The ppr of  3  has ZeroDivisionError.


The f1-score of  3  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  86.40  40.49   99.54  96.15     56.98
1  77.12   0.00  100.00   0.00      0.00
2  78.56  76.34   79.60  63.76     69.49
3  92.16   0.00  100.00   0.00      0.00
4  60.36  92.22   54.72  26.51     41.18
Total accuracy: 47.30%
Average sen: 41.81%
Average spec: 86.77%
Macro f1-score: 33.53%
[0.89167243 0.99334103 0.92975175 0.98297369 0.98939908 0.73523587
 0.46697399 0.29184079 0.43410537 0.49323595 0.45980909 0.38903272
 0.38164154 0.42919484 0.49983734 0.42347175 0.29849783 0.28309351
 0.94360387 0.62598091 0.4154703  0.31184781 0.30835581 0.29697421
 0.32035938 0.63634485 0.61552286 0.30193144 0.38173124 0.27286312
 0.32906398 0.37515947 0.31252399 0.36682451 0.26021287 0.22013567
 0.37933856]
pred: 0.4877663089616879, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.395792, loss_ss: 1.729471, loss_d: 0.666321
0.0385 --- loss: 2.277714, loss_ss: 1.686983, loss_d: 0.590731
0.0770 --- loss: 2.476449, loss_ss: 1.632692, loss_d: 0.843757
0.1156 --- loss: 2.354836, loss_ss: 1.604151, loss_d: 0.750685
0.1541 --- loss: 2.197315, loss_ss: 1.663535, loss_d: 0.533780
0.1926 --- loss: 2.061510, loss_ss: 1.564919, loss_d: 0.496591
0.2311 --- loss: 2.195422, loss_ss: 1.609906, loss_d: 0.585516
0.2696 --- loss: 2.106675, loss_ss: 1.624566, loss_d: 0.482109
0.3082 --- loss: 2.067553, loss_ss: 1.633846, loss_d: 0.433708
0.3467 --- loss: 1.898540, loss_ss: 1.481046, loss_d: 0.417494
0.3852 --- loss: 2.404776, loss_ss: 1.593056, loss_d: 0.811720
0.4237 --- loss: 2.065991, loss_ss: 1.539646, loss_d: 0.526346
0.4622 --- loss: 2.222987, loss_ss: 1.537273, loss_d: 0.685714
0.5008 --- loss: 2.176725, loss_ss: 1.565351, loss_d: 0.611374
0.5393 --- loss: 1.823312, loss_ss: 1.530974, loss_d: 0.292338
0.5778 --- loss: 2.193046, loss_ss: 1.676349, loss_d: 0.516697
0.6163 --- loss: 2.169663, loss_ss: 1.491242, loss_d: 0.678421
0.6549 --- loss: 2.074353, loss_ss: 1.576242, loss_d: 0.498111
0.6934 --- loss: 1.901711, loss_ss: 1.577795, loss_d: 0.323917
0.7319 --- loss: 1.880399, loss_ss: 1.456046, loss_d: 0.424354
0.7704 --- loss: 2.122758, loss_ss: 1.515442, loss_d: 0.607315
0.8089 --- loss: 1.975389, loss_ss: 1.624222, loss_d: 0.351167
0.8475 --- loss: 2.267823, loss_ss: 1.446268, loss_d: 0.821556
0.8860 --- loss: 2.037236, loss_ss: 1.430646, loss_d: 0.606590
0.9245 --- loss: 2.018051, loss_ss: 1.565506, loss_d: 0.452545
0.9630 --- loss: 2.021417, loss_ss: 1.446596, loss_d: 0.574822
Epoch finished! Loss: 2.1320852722440446
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.378606, loss_ss: 1.422781, loss_d: 0.955825
0.0385 --- loss: 1.969696, loss_ss: 1.492980, loss_d: 0.476716
0.0770 --- loss: 1.936834, loss_ss: 1.312067, loss_d: 0.624767
0.1156 --- loss: 2.005565, loss_ss: 1.538305, loss_d: 0.467261
0.1541 --- loss: 2.071383, loss_ss: 1.406474, loss_d: 0.664909
0.1926 --- loss: 2.030037, loss_ss: 1.407174, loss_d: 0.622863
0.2311 --- loss: 1.660062, loss_ss: 1.263578, loss_d: 0.396484
0.2696 --- loss: 1.867126, loss_ss: 1.488885, loss_d: 0.378241
0.3082 --- loss: 1.755235, loss_ss: 1.379621, loss_d: 0.375614
0.3467 --- loss: 2.005033, loss_ss: 1.577121, loss_d: 0.427912
0.3852 --- loss: 1.780375, loss_ss: 1.407142, loss_d: 0.373234
0.4237 --- loss: 2.058939, loss_ss: 1.307193, loss_d: 0.751745
0.4622 --- loss: 1.860563, loss_ss: 1.360759, loss_d: 0.499803
0.5008 --- loss: 1.972673, loss_ss: 1.471480, loss_d: 0.501193
0.5393 --- loss: 2.426903, loss_ss: 1.420369, loss_d: 1.006534
0.5778 --- loss: 1.977491, loss_ss: 1.563974, loss_d: 0.413517
0.6163 --- loss: 1.791782, loss_ss: 1.369683, loss_d: 0.422099
0.6549 --- loss: 1.913877, loss_ss: 1.461385, loss_d: 0.452493
0.6934 --- loss: 1.790148, loss_ss: 1.272917, loss_d: 0.517231
0.7319 --- loss: 1.872607, loss_ss: 1.549073, loss_d: 0.323534
0.7704 --- loss: 1.891013, loss_ss: 1.402595, loss_d: 0.488418
0.8089 --- loss: 1.709305, loss_ss: 1.287567, loss_d: 0.421738
0.8475 --- loss: 1.479074, loss_ss: 1.204670, loss_d: 0.274404
0.8860 --- loss: 1.651988, loss_ss: 1.245261, loss_d: 0.406727
0.9245 --- loss: 1.739931, loss_ss: 1.264252, loss_d: 0.475679
0.9630 --- loss: 1.875155, loss_ss: 1.364786, loss_d: 0.510369
Epoch finished! Loss: 1.9448950180215725
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.959577, loss_ss: 1.328560, loss_d: 0.631018
0.0385 --- loss: 2.453751, loss_ss: 1.519304, loss_d: 0.934447
0.0770 --- loss: 1.913388, loss_ss: 1.382337, loss_d: 0.531051
0.1156 --- loss: 1.672768, loss_ss: 1.336762, loss_d: 0.336006
0.1541 --- loss: 1.598660, loss_ss: 1.271381, loss_d: 0.327280
0.1926 --- loss: 1.998032, loss_ss: 1.376226, loss_d: 0.621806
0.2311 --- loss: 1.784393, loss_ss: 1.352066, loss_d: 0.432327
0.2696 --- loss: 1.595994, loss_ss: 1.266025, loss_d: 0.329969
0.3082 --- loss: 1.974555, loss_ss: 1.254979, loss_d: 0.719576
0.3467 --- loss: 1.657995, loss_ss: 1.278271, loss_d: 0.379724
0.3852 --- loss: 1.879586, loss_ss: 1.315349, loss_d: 0.564237
0.4237 --- loss: 2.058071, loss_ss: 1.163739, loss_d: 0.894332
0.4622 --- loss: 1.809368, loss_ss: 1.337124, loss_d: 0.472244
0.5008 --- loss: 1.493596, loss_ss: 1.149328, loss_d: 0.344268
0.5393 --- loss: 1.940907, loss_ss: 1.441831, loss_d: 0.499076
0.5778 --- loss: 1.811498, loss_ss: 1.331947, loss_d: 0.479551
0.6163 --- loss: 1.545125, loss_ss: 1.208478, loss_d: 0.336647
0.6549 --- loss: 1.671633, loss_ss: 1.252054, loss_d: 0.419579
0.6934 --- loss: 1.930364, loss_ss: 1.313714, loss_d: 0.616650
0.7319 --- loss: 1.650364, loss_ss: 1.300619, loss_d: 0.349745
0.7704 --- loss: 1.566880, loss_ss: 1.125806, loss_d: 0.441073
0.8089 --- loss: 1.585719, loss_ss: 1.268063, loss_d: 0.317656
0.8475 --- loss: 1.480485, loss_ss: 1.098972, loss_d: 0.381513
0.8860 --- loss: 1.826304, loss_ss: 1.475011, loss_d: 0.351293
0.9245 --- loss: 1.751501, loss_ss: 1.351261, loss_d: 0.400240
0.9630 --- loss: 2.103159, loss_ss: 1.757917, loss_d: 0.345242
Epoch finished! Loss: 1.8177269075828169
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.874580, loss_ss: 1.579703, loss_d: 0.294877
0.0385 --- loss: 1.425860, loss_ss: 1.180063, loss_d: 0.245797
0.0770 --- loss: 1.602326, loss_ss: 1.097704, loss_d: 0.504621
0.1156 --- loss: 1.653018, loss_ss: 1.203389, loss_d: 0.449629
0.1541 --- loss: 1.668413, loss_ss: 1.133886, loss_d: 0.534526
0.1926 --- loss: 1.859147, loss_ss: 1.358715, loss_d: 0.500431
0.2311 --- loss: 1.533583, loss_ss: 1.108223, loss_d: 0.425359
0.2696 --- loss: 1.775579, loss_ss: 1.295647, loss_d: 0.479932
0.3082 --- loss: 2.317214, loss_ss: 1.490048, loss_d: 0.827167
0.3467 --- loss: 2.095726, loss_ss: 1.039799, loss_d: 1.055927
0.3852 --- loss: 1.863950, loss_ss: 1.384627, loss_d: 0.479323
0.4237 --- loss: 1.536976, loss_ss: 1.078611, loss_d: 0.458365
0.4622 --- loss: 1.522329, loss_ss: 1.180175, loss_d: 0.342154
0.5008 --- loss: 1.513281, loss_ss: 1.043649, loss_d: 0.469632
0.5393 --- loss: 1.453228, loss_ss: 1.134279, loss_d: 0.318949
0.5778 --- loss: 1.703692, loss_ss: 1.252679, loss_d: 0.451012
0.6163 --- loss: 1.786898, loss_ss: 1.093452, loss_d: 0.693446
0.6549 --- loss: 1.583688, loss_ss: 1.207157, loss_d: 0.376531
0.6934 --- loss: 1.725424, loss_ss: 1.313484, loss_d: 0.411940
0.7319 --- loss: 1.702564, loss_ss: 1.061410, loss_d: 0.641154
0.7704 --- loss: 1.553318, loss_ss: 1.170523, loss_d: 0.382795
0.8089 --- loss: 1.789210, loss_ss: 1.186802, loss_d: 0.602408
0.8475 --- loss: 1.593825, loss_ss: 1.110340, loss_d: 0.483486
0.8860 --- loss: 1.425690, loss_ss: 1.054421, loss_d: 0.371269
0.9245 --- loss: 1.700984, loss_ss: 1.295112, loss_d: 0.405873
0.9630 --- loss: 1.569711, loss_ss: 1.234226, loss_d: 0.335485
Epoch finished! Loss: 1.729260706993604
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.873831, loss_ss: 1.397425, loss_d: 0.476406
0.0385 --- loss: 1.607293, loss_ss: 1.120822, loss_d: 0.486471
0.0770 --- loss: 1.669851, loss_ss: 1.350256, loss_d: 0.319595
0.1156 --- loss: 1.667543, loss_ss: 1.256755, loss_d: 0.410788
0.1541 --- loss: 1.569190, loss_ss: 1.053346, loss_d: 0.515844
0.1926 --- loss: 1.634536, loss_ss: 1.069495, loss_d: 0.565041
0.2311 --- loss: 1.306613, loss_ss: 0.900772, loss_d: 0.405841
0.2696 --- loss: 1.478556, loss_ss: 1.060394, loss_d: 0.418162
0.3082 --- loss: 1.359634, loss_ss: 1.018903, loss_d: 0.340731
0.3467 --- loss: 1.329862, loss_ss: 1.005808, loss_d: 0.324055
0.3852 --- loss: 2.156836, loss_ss: 1.567951, loss_d: 0.588885
0.4237 --- loss: 1.257859, loss_ss: 0.862104, loss_d: 0.395756
0.4622 --- loss: 1.521605, loss_ss: 0.995963, loss_d: 0.525641
0.5008 --- loss: 1.612902, loss_ss: 1.208680, loss_d: 0.404221
0.5393 --- loss: 1.646841, loss_ss: 1.033864, loss_d: 0.612977
0.5778 --- loss: 1.504148, loss_ss: 1.077803, loss_d: 0.426344
0.6163 --- loss: 1.509718, loss_ss: 1.160856, loss_d: 0.348862
0.6549 --- loss: 1.960231, loss_ss: 1.225555, loss_d: 0.734676
0.6934 --- loss: 1.446432, loss_ss: 0.938745, loss_d: 0.507687
0.7319 --- loss: 1.682744, loss_ss: 1.204642, loss_d: 0.478101
0.7704 --- loss: 1.553963, loss_ss: 1.069295, loss_d: 0.484668
0.8089 --- loss: 1.785989, loss_ss: 1.444920, loss_d: 0.341069
0.8475 --- loss: 1.751010, loss_ss: 1.049173, loss_d: 0.701836
0.8860 --- loss: 2.333293, loss_ss: 1.664344, loss_d: 0.668949
0.9245 --- loss: 1.681869, loss_ss: 1.068462, loss_d: 0.613406
0.9630 --- loss: 1.950028, loss_ss: 1.188119, loss_d: 0.761909
Epoch finished! Loss: 1.6528358031423855
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.788221, loss_ss: 1.366694, loss_d: 0.421526
0.0385 --- loss: 1.744264, loss_ss: 1.098365, loss_d: 0.645899
0.0770 --- loss: 1.695060, loss_ss: 1.043177, loss_d: 0.651883
0.1156 --- loss: 1.430436, loss_ss: 0.964512, loss_d: 0.465924
0.1541 --- loss: 1.717008, loss_ss: 1.290269, loss_d: 0.426738
0.1926 --- loss: 1.865367, loss_ss: 1.074688, loss_d: 0.790678
0.2311 --- loss: 2.012936, loss_ss: 1.267573, loss_d: 0.745363
0.2696 --- loss: 1.284120, loss_ss: 0.910552, loss_d: 0.373569
0.3082 --- loss: 1.265785, loss_ss: 0.859218, loss_d: 0.406567
0.3467 --- loss: 1.404874, loss_ss: 0.910499, loss_d: 0.494375
0.3852 --- loss: 1.649107, loss_ss: 1.152919, loss_d: 0.496188
0.4237 --- loss: 1.568751, loss_ss: 1.170124, loss_d: 0.398627
0.4622 --- loss: 1.450137, loss_ss: 1.076926, loss_d: 0.373211
0.5008 --- loss: 1.371955, loss_ss: 0.861694, loss_d: 0.510261
0.5393 --- loss: 1.406163, loss_ss: 1.017695, loss_d: 0.388468
0.5778 --- loss: 2.077424, loss_ss: 1.220891, loss_d: 0.856533
0.6163 --- loss: 2.298924, loss_ss: 1.520538, loss_d: 0.778386
0.6549 --- loss: 1.414612, loss_ss: 1.066679, loss_d: 0.347933
0.6934 --- loss: 2.211853, loss_ss: 1.254474, loss_d: 0.957379
0.7319 --- loss: 1.500208, loss_ss: 1.060848, loss_d: 0.439359
0.7704 --- loss: 1.893628, loss_ss: 1.408966, loss_d: 0.484663
0.8089 --- loss: 2.013465, loss_ss: 1.236603, loss_d: 0.776862
0.8475 --- loss: 1.765566, loss_ss: 1.127975, loss_d: 0.637592
0.8860 --- loss: 1.480246, loss_ss: 1.198102, loss_d: 0.282144
0.9245 --- loss: 1.411716, loss_ss: 1.084003, loss_d: 0.327713
0.9630 --- loss: 1.947103, loss_ss: 1.204484, loss_d: 0.742619
Epoch finished! Loss: 1.609026942474041
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.329582, loss_ss: 0.961624, loss_d: 0.367958
0.0385 --- loss: 1.583060, loss_ss: 1.175945, loss_d: 0.407115
0.0770 --- loss: 1.620082, loss_ss: 1.209329, loss_d: 0.410754
0.1156 --- loss: 1.729706, loss_ss: 1.066688, loss_d: 0.663019
0.1541 --- loss: 1.920057, loss_ss: 1.202312, loss_d: 0.717745
0.1926 --- loss: 1.404466, loss_ss: 0.947051, loss_d: 0.457415
0.2311 --- loss: 1.587085, loss_ss: 1.134892, loss_d: 0.452193
0.2696 --- loss: 2.022546, loss_ss: 0.810715, loss_d: 1.211831
0.3082 --- loss: 1.648830, loss_ss: 0.976086, loss_d: 0.672744
0.3467 --- loss: 1.292869, loss_ss: 0.945306, loss_d: 0.347563
0.3852 --- loss: 1.849133, loss_ss: 1.124075, loss_d: 0.725058
0.4237 --- loss: 1.364887, loss_ss: 0.986533, loss_d: 0.378354
0.4622 --- loss: 1.316167, loss_ss: 0.962250, loss_d: 0.353917
0.5008 --- loss: 1.530062, loss_ss: 1.087567, loss_d: 0.442495
0.5393 --- loss: 1.950519, loss_ss: 1.245746, loss_d: 0.704772
0.5778 --- loss: 1.628259, loss_ss: 1.138783, loss_d: 0.489477
0.6163 --- loss: 1.694031, loss_ss: 1.087480, loss_d: 0.606551
0.6549 --- loss: 1.540688, loss_ss: 0.839886, loss_d: 0.700802
0.6934 --- loss: 1.633956, loss_ss: 1.002401, loss_d: 0.631555
0.7319 --- loss: 1.748459, loss_ss: 1.195674, loss_d: 0.552786
0.7704 --- loss: 1.859109, loss_ss: 1.467350, loss_d: 0.391759
0.8089 --- loss: 1.518254, loss_ss: 1.200253, loss_d: 0.318001
0.8475 --- loss: 1.358691, loss_ss: 1.009765, loss_d: 0.348926
0.8860 --- loss: 1.568637, loss_ss: 1.026749, loss_d: 0.541889
0.9245 --- loss: 1.343896, loss_ss: 0.966231, loss_d: 0.377665
0.9630 --- loss: 1.337884, loss_ss: 0.795395, loss_d: 0.542489
Epoch finished! Loss: 1.571412435369602
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.675133, loss_ss: 1.354563, loss_d: 0.320570
0.0385 --- loss: 1.265617, loss_ss: 0.908204, loss_d: 0.357414
0.0770 --- loss: 1.221931, loss_ss: 0.911844, loss_d: 0.310088
0.1156 --- loss: 1.363791, loss_ss: 0.957980, loss_d: 0.405811
0.1541 --- loss: 1.662209, loss_ss: 1.186989, loss_d: 0.475220
0.1926 --- loss: 1.419301, loss_ss: 1.002846, loss_d: 0.416455
0.2311 --- loss: 1.413808, loss_ss: 0.805533, loss_d: 0.608275
0.2696 --- loss: 1.368280, loss_ss: 0.915239, loss_d: 0.453042
0.3082 --- loss: 1.597769, loss_ss: 1.167650, loss_d: 0.430119
0.3467 --- loss: 1.370900, loss_ss: 1.020018, loss_d: 0.350882
0.3852 --- loss: 1.674809, loss_ss: 1.210803, loss_d: 0.464006
0.4237 --- loss: 1.420305, loss_ss: 1.096026, loss_d: 0.324279
0.4622 --- loss: 1.301668, loss_ss: 1.017772, loss_d: 0.283895
0.5008 --- loss: 1.231239, loss_ss: 0.996863, loss_d: 0.234376
0.5393 --- loss: 1.272593, loss_ss: 1.042514, loss_d: 0.230080
0.5778 --- loss: 1.441295, loss_ss: 0.857353, loss_d: 0.583942
0.6163 --- loss: 1.535280, loss_ss: 0.906824, loss_d: 0.628456
0.6549 --- loss: 1.722167, loss_ss: 1.338484, loss_d: 0.383683
0.6934 --- loss: 1.687159, loss_ss: 0.881073, loss_d: 0.806086
0.7319 --- loss: 1.576936, loss_ss: 1.139475, loss_d: 0.437460
0.7704 --- loss: 2.078216, loss_ss: 1.613146, loss_d: 0.465070
0.8089 --- loss: 1.550270, loss_ss: 1.053052, loss_d: 0.497218
0.8475 --- loss: 1.631601, loss_ss: 1.050098, loss_d: 0.581503
0.8860 --- loss: 1.630759, loss_ss: 1.149517, loss_d: 0.481242
0.9245 --- loss: 1.673666, loss_ss: 1.203457, loss_d: 0.470209
0.9630 --- loss: 1.611675, loss_ss: 1.055655, loss_d: 0.556020
Epoch finished! Loss: 1.560928336441747
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.371673, loss_ss: 0.812878, loss_d: 0.558795
0.0385 --- loss: 1.372962, loss_ss: 1.021873, loss_d: 0.351090
0.0770 --- loss: 2.068771, loss_ss: 1.256154, loss_d: 0.812617
0.1156 --- loss: 1.774831, loss_ss: 1.448204, loss_d: 0.326627
0.1541 --- loss: 1.336994, loss_ss: 1.003286, loss_d: 0.333707
0.1926 --- loss: 1.424726, loss_ss: 1.093219, loss_d: 0.331506
0.2311 --- loss: 1.836945, loss_ss: 1.324164, loss_d: 0.512780
0.2696 --- loss: 1.469316, loss_ss: 1.097039, loss_d: 0.372277
0.3082 --- loss: 1.535644, loss_ss: 1.166163, loss_d: 0.369481
0.3467 --- loss: 1.565403, loss_ss: 1.062243, loss_d: 0.503159
0.3852 --- loss: 1.698096, loss_ss: 1.270290, loss_d: 0.427806
0.4237 --- loss: 1.449800, loss_ss: 1.008124, loss_d: 0.441676
0.4622 --- loss: 1.648812, loss_ss: 1.256606, loss_d: 0.392205
0.5008 --- loss: 1.440722, loss_ss: 1.044141, loss_d: 0.396581
0.5393 --- loss: 1.439059, loss_ss: 1.006360, loss_d: 0.432700
0.5778 --- loss: 1.448709, loss_ss: 1.084052, loss_d: 0.364657
0.6163 --- loss: 1.543284, loss_ss: 1.194264, loss_d: 0.349020
0.6549 --- loss: 1.433297, loss_ss: 1.116511, loss_d: 0.316786
0.6934 --- loss: 1.509096, loss_ss: 1.055943, loss_d: 0.453153
0.7319 --- loss: 1.171448, loss_ss: 0.883908, loss_d: 0.287539
0.7704 --- loss: 1.383826, loss_ss: 1.018253, loss_d: 0.365574
0.8089 --- loss: 1.617220, loss_ss: 1.324088, loss_d: 0.293132
0.8475 --- loss: 1.593164, loss_ss: 1.155387, loss_d: 0.437777
0.8860 --- loss: 1.345312, loss_ss: 0.985520, loss_d: 0.359791
0.9245 --- loss: 1.593993, loss_ss: 0.863599, loss_d: 0.730394
0.9630 --- loss: 1.246419, loss_ss: 0.765436, loss_d: 0.480984
Epoch finished! Loss: 1.5498571713458618
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.465572, loss_ss: 1.119510, loss_d: 0.346061
0.0385 --- loss: 1.421563, loss_ss: 1.015880, loss_d: 0.405683
0.0770 --- loss: 1.551836, loss_ss: 1.279207, loss_d: 0.272629
0.1156 --- loss: 1.568592, loss_ss: 1.284364, loss_d: 0.284228
0.1541 --- loss: 1.687747, loss_ss: 1.316485, loss_d: 0.371262
0.1926 --- loss: 1.648503, loss_ss: 1.329243, loss_d: 0.319260
0.2311 --- loss: 1.405038, loss_ss: 0.968134, loss_d: 0.436904
0.2696 --- loss: 1.315739, loss_ss: 1.033231, loss_d: 0.282508
0.3082 --- loss: 1.381461, loss_ss: 1.107633, loss_d: 0.273828
0.3467 --- loss: 1.408750, loss_ss: 1.055235, loss_d: 0.353515
0.3852 --- loss: 1.522266, loss_ss: 1.270902, loss_d: 0.251364
0.4237 --- loss: 1.320072, loss_ss: 0.968810, loss_d: 0.351261
0.4622 --- loss: 2.184255, loss_ss: 1.066100, loss_d: 1.118154
0.5008 --- loss: 1.380828, loss_ss: 1.033665, loss_d: 0.347163
0.5393 --- loss: 1.117446, loss_ss: 0.783319, loss_d: 0.334126
0.5778 --- loss: 1.388228, loss_ss: 0.949959, loss_d: 0.438269
0.6163 --- loss: 1.248011, loss_ss: 0.895652, loss_d: 0.352359
0.6549 --- loss: 1.525707, loss_ss: 0.961600, loss_d: 0.564107
0.6934 --- loss: 1.167645, loss_ss: 0.829725, loss_d: 0.337920
0.7319 --- loss: 1.443740, loss_ss: 1.040857, loss_d: 0.402884
0.7704 --- loss: 1.366556, loss_ss: 1.061069, loss_d: 0.305486
0.8089 --- loss: 1.248354, loss_ss: 1.000762, loss_d: 0.247592
0.8475 --- loss: 1.593773, loss_ss: 1.255572, loss_d: 0.338201
0.8860 --- loss: 1.367704, loss_ss: 1.055786, loss_d: 0.311918
0.9245 --- loss: 1.627738, loss_ss: 0.799860, loss_d: 0.827878
0.9630 --- loss: 1.399793, loss_ss: 1.080378, loss_d: 0.319415
Epoch finished! Loss: 1.5048959655651255
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5841269841269842
             precision    recall  f1-score   support

        0.0       0.80      0.63      0.71       519
        1.0       0.00      0.00      0.00       201
        2.0       0.44      0.96      0.60       228
        3.0       0.93      0.89      0.91       158
        4.0       0.25      0.32      0.28       154

avg / total       0.56      0.58      0.55      1260
 


====== chp060-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  78.41  63.01   89.20  80.34     70.63
1  84.05   0.00  100.00   0.00      0.00
2  76.75  95.61   72.58  43.51     59.81
3  97.86  89.24   99.09  93.38     91.26
4  79.76  32.47   86.35  24.88     28.17
Total accuracy: 58.41%
Average sen: 56.07%
Average spec: 89.44%
Macro f1-score: 49.97%
[0.98764127 0.98754662 0.9853     0.98220223 0.98302388 0.98244965
 0.98081928 0.98187608 0.98357576 0.98756707 0.98256302 0.98015952
 0.98182881 0.98337215 0.98260671 0.98076355 0.97756469 0.97905272
 0.9812274  0.98297632 0.98885185 0.98595816 0.9824003  0.98293328
 0.97775501 0.98150784 0.98627371 0.98122418 0.9874413  0.98588204
 0.98249662 0.98121315 0.98076469 0.98114073 0.97903103 0.98314363
 0.98302865 0.98536611 0.98398823 0.98685139 0.98706925 0.98535407]
pred: 0.9831855226130712, label: 1
Right! Diagnosis: Narcolepsy type 1

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  77.90  45.34   83.14  30.19     36.25
1  87.26   0.14   99.90  16.67      0.28
2  64.07  47.53   74.13  52.74     50.00
3  79.85  60.75   83.92  44.58     51.42
4  73.25  34.42   81.84  29.56     31.80
Total accuracy: 41.17%
Average sen: 37.63%
Average spec: 84.58%
Macro f1-score: 33.95%
