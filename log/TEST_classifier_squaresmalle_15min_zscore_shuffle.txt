cuda:1
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.417784, loss_ss: 1.676743, loss_d: 0.741041
0.0383 --- loss: 2.218254, loss_ss: 1.581223, loss_d: 0.637031
0.0766 --- loss: 2.446216, loss_ss: 1.693698, loss_d: 0.752518
0.1149 --- loss: 1.967577, loss_ss: 1.520078, loss_d: 0.447499
0.1531 --- loss: 1.933449, loss_ss: 1.444206, loss_d: 0.489244
0.1914 --- loss: 2.217643, loss_ss: 1.476922, loss_d: 0.740721
0.2297 --- loss: 1.978725, loss_ss: 1.470234, loss_d: 0.508491
0.2680 --- loss: 2.141398, loss_ss: 1.380975, loss_d: 0.760423
0.3063 --- loss: 2.317528, loss_ss: 1.407152, loss_d: 0.910376
0.3446 --- loss: 2.170501, loss_ss: 1.732170, loss_d: 0.438331
0.3828 --- loss: 1.974679, loss_ss: 1.207244, loss_d: 0.767435
0.4211 --- loss: 1.824055, loss_ss: 1.379581, loss_d: 0.444474
0.4594 --- loss: 1.807498, loss_ss: 1.369088, loss_d: 0.438410
0.4977 --- loss: 1.638289, loss_ss: 1.164909, loss_d: 0.473380
0.5360 --- loss: 1.848372, loss_ss: 1.343782, loss_d: 0.504589
0.5743 --- loss: 2.035767, loss_ss: 1.217447, loss_d: 0.818320
0.6126 --- loss: 1.711953, loss_ss: 1.219823, loss_d: 0.492130
0.6508 --- loss: 1.892515, loss_ss: 1.324475, loss_d: 0.568040
0.6891 --- loss: 1.769264, loss_ss: 1.396139, loss_d: 0.373125
0.7274 --- loss: 1.777951, loss_ss: 1.430527, loss_d: 0.347424
0.7657 --- loss: 1.990668, loss_ss: 1.286816, loss_d: 0.703852
0.8040 --- loss: 1.842519, loss_ss: 1.545488, loss_d: 0.297031
0.8423 --- loss: 1.516291, loss_ss: 1.115038, loss_d: 0.401253
0.8806 --- loss: 1.537421, loss_ss: 1.073042, loss_d: 0.464378
0.9188 --- loss: 1.557905, loss_ss: 1.048297, loss_d: 0.509607
0.9571 --- loss: 1.573178, loss_ss: 1.158834, loss_d: 0.414344
0.9954 --- loss: 1.768913, loss_ss: 1.035962, loss_d: 0.732952
Epoch finished! Loss: 1.9495081481348966
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.732790, loss_ss: 1.239219, loss_d: 0.493571
0.0383 --- loss: 1.335417, loss_ss: 0.995105, loss_d: 0.340312
0.0766 --- loss: 1.854039, loss_ss: 1.480451, loss_d: 0.373589
0.1149 --- loss: 1.558107, loss_ss: 0.933803, loss_d: 0.624303
0.1531 --- loss: 1.664257, loss_ss: 1.045241, loss_d: 0.619016
0.1914 --- loss: 1.649849, loss_ss: 1.230821, loss_d: 0.419028
0.2297 --- loss: 1.270008, loss_ss: 1.030871, loss_d: 0.239136
0.2680 --- loss: 1.544661, loss_ss: 0.949228, loss_d: 0.595433
0.3063 --- loss: 1.413093, loss_ss: 1.037098, loss_d: 0.375994
0.3446 --- loss: 1.772566, loss_ss: 1.060694, loss_d: 0.711873
0.3828 --- loss: 1.483743, loss_ss: 1.086251, loss_d: 0.397492
0.4211 --- loss: 1.627819, loss_ss: 1.096346, loss_d: 0.531472
0.4594 --- loss: 1.796704, loss_ss: 1.040478, loss_d: 0.756225
0.4977 --- loss: 1.268210, loss_ss: 0.777473, loss_d: 0.490737
0.5360 --- loss: 1.859373, loss_ss: 1.137982, loss_d: 0.721391
0.5743 --- loss: 1.625957, loss_ss: 1.000761, loss_d: 0.625196
0.6126 --- loss: 1.783751, loss_ss: 1.114095, loss_d: 0.669656
0.6508 --- loss: 1.544860, loss_ss: 1.114842, loss_d: 0.430018
0.6891 --- loss: 1.814135, loss_ss: 1.253016, loss_d: 0.561119
0.7274 --- loss: 1.658190, loss_ss: 1.107872, loss_d: 0.550318
0.7657 --- loss: 1.527190, loss_ss: 0.939950, loss_d: 0.587240
0.8040 --- loss: 1.889167, loss_ss: 1.296848, loss_d: 0.592318
0.8423 --- loss: 1.416137, loss_ss: 1.121998, loss_d: 0.294139
0.8806 --- loss: 1.921691, loss_ss: 1.265769, loss_d: 0.655922
0.9188 --- loss: 1.479555, loss_ss: 1.034026, loss_d: 0.445529
0.9571 --- loss: 1.741502, loss_ss: 1.045444, loss_d: 0.696057
0.9954 --- loss: 1.682881, loss_ss: 0.995548, loss_d: 0.687333
Epoch finished! Loss: 1.7032470630046508
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.645158, loss_ss: 1.099974, loss_d: 0.545184
0.0383 --- loss: 1.483235, loss_ss: 0.985387, loss_d: 0.497849
0.0766 --- loss: 1.851023, loss_ss: 1.338556, loss_d: 0.512467
0.1149 --- loss: 1.808140, loss_ss: 1.136773, loss_d: 0.671367
0.1531 --- loss: 1.413676, loss_ss: 1.026470, loss_d: 0.387206
0.1914 --- loss: 1.614876, loss_ss: 1.067786, loss_d: 0.547089
0.2297 --- loss: 1.555465, loss_ss: 0.981093, loss_d: 0.574372
0.2680 --- loss: 1.456237, loss_ss: 0.950181, loss_d: 0.506056
0.3063 --- loss: 1.495788, loss_ss: 0.986390, loss_d: 0.509398
0.3446 --- loss: 1.606126, loss_ss: 1.013207, loss_d: 0.592919
0.3828 --- loss: 1.719461, loss_ss: 0.897456, loss_d: 0.822005
0.4211 --- loss: 1.721601, loss_ss: 1.137618, loss_d: 0.583984
0.4594 --- loss: 1.466995, loss_ss: 0.960375, loss_d: 0.506620
0.4977 --- loss: 1.703783, loss_ss: 1.260814, loss_d: 0.442969
0.5360 --- loss: 1.658996, loss_ss: 1.226220, loss_d: 0.432775
0.5743 --- loss: 1.184013, loss_ss: 0.760273, loss_d: 0.423739
0.6126 --- loss: 1.309903, loss_ss: 1.072589, loss_d: 0.237314
0.6508 --- loss: 1.590798, loss_ss: 0.954130, loss_d: 0.636668
0.6891 --- loss: 1.931492, loss_ss: 0.984016, loss_d: 0.947475
0.7274 --- loss: 1.571505, loss_ss: 0.933879, loss_d: 0.637626
0.7657 --- loss: 1.586022, loss_ss: 1.260515, loss_d: 0.325507
0.8040 --- loss: 1.390004, loss_ss: 0.769555, loss_d: 0.620449
0.8423 --- loss: 1.890043, loss_ss: 0.952331, loss_d: 0.937712
0.8806 --- loss: 1.583941, loss_ss: 0.952498, loss_d: 0.631443
0.9188 --- loss: 1.444347, loss_ss: 1.022688, loss_d: 0.421659
0.9571 --- loss: 1.583285, loss_ss: 1.000733, loss_d: 0.582552
0.9954 --- loss: 1.569418, loss_ss: 0.943728, loss_d: 0.625689
Epoch finished! Loss: 1.6002684900130348
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.236738, loss_ss: 0.947113, loss_d: 0.289625
0.0383 --- loss: 1.635587, loss_ss: 1.144768, loss_d: 0.490819
0.0766 --- loss: 1.604748, loss_ss: 1.028821, loss_d: 0.575927
0.1149 --- loss: 1.578619, loss_ss: 0.917992, loss_d: 0.660627
0.1531 --- loss: 1.217998, loss_ss: 0.722354, loss_d: 0.495643
0.1914 --- loss: 1.653134, loss_ss: 1.022621, loss_d: 0.630513
0.2297 --- loss: 1.606793, loss_ss: 1.175721, loss_d: 0.431072
0.2680 --- loss: 1.472569, loss_ss: 1.122912, loss_d: 0.349657
0.3063 --- loss: 1.543350, loss_ss: 1.113347, loss_d: 0.430003
0.3446 --- loss: 1.483021, loss_ss: 0.883927, loss_d: 0.599093
0.3828 --- loss: 1.541352, loss_ss: 1.024090, loss_d: 0.517262
0.4211 --- loss: 1.534128, loss_ss: 1.159155, loss_d: 0.374973
0.4594 --- loss: 1.486311, loss_ss: 0.929623, loss_d: 0.556688
0.4977 --- loss: 1.362327, loss_ss: 1.045718, loss_d: 0.316609
0.5360 --- loss: 1.283170, loss_ss: 0.945176, loss_d: 0.337994
0.5743 --- loss: 1.330108, loss_ss: 1.077322, loss_d: 0.252786
0.6126 --- loss: 1.567640, loss_ss: 0.970668, loss_d: 0.596973
0.6508 --- loss: 1.692872, loss_ss: 1.022933, loss_d: 0.669938
0.6891 --- loss: 1.246469, loss_ss: 0.975496, loss_d: 0.270973
0.7274 --- loss: 1.477440, loss_ss: 1.017345, loss_d: 0.460094
0.7657 --- loss: 1.655358, loss_ss: 1.172960, loss_d: 0.482398
0.8040 --- loss: 1.300012, loss_ss: 0.882390, loss_d: 0.417622
0.8423 --- loss: 1.363705, loss_ss: 0.971936, loss_d: 0.391769
0.8806 --- loss: 1.863010, loss_ss: 1.047503, loss_d: 0.815507
0.9188 --- loss: 1.407676, loss_ss: 1.052861, loss_d: 0.354815
0.9571 --- loss: 1.328622, loss_ss: 0.831098, loss_d: 0.497524
0.9954 --- loss: 1.175702, loss_ss: 0.978033, loss_d: 0.197670
Epoch finished! Loss: 1.4882062696405753
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.590033, loss_ss: 1.210571, loss_d: 0.379463
0.0383 --- loss: 1.522952, loss_ss: 1.085318, loss_d: 0.437634
0.0766 --- loss: 1.406681, loss_ss: 1.039747, loss_d: 0.366934
0.1149 --- loss: 1.058277, loss_ss: 0.838546, loss_d: 0.219732
0.1531 --- loss: 1.180178, loss_ss: 0.812022, loss_d: 0.368155
0.1914 --- loss: 1.615188, loss_ss: 0.981740, loss_d: 0.633448
0.2297 --- loss: 1.327552, loss_ss: 0.967793, loss_d: 0.359759
0.2680 --- loss: 1.076820, loss_ss: 0.689234, loss_d: 0.387585
0.3063 --- loss: 1.663461, loss_ss: 0.870417, loss_d: 0.793044
0.3446 --- loss: 1.146921, loss_ss: 0.871191, loss_d: 0.275730
0.3828 --- loss: 1.508441, loss_ss: 1.063509, loss_d: 0.444932
0.4211 --- loss: 1.672398, loss_ss: 1.047993, loss_d: 0.624405
0.4594 --- loss: 1.401575, loss_ss: 0.699496, loss_d: 0.702079
0.4977 --- loss: 1.604414, loss_ss: 0.738123, loss_d: 0.866291
0.5360 --- loss: 1.562390, loss_ss: 1.073836, loss_d: 0.488554
0.5743 --- loss: 1.260625, loss_ss: 0.914072, loss_d: 0.346553
0.6126 --- loss: 1.329627, loss_ss: 0.956507, loss_d: 0.373120
0.6508 --- loss: 1.633827, loss_ss: 1.049958, loss_d: 0.583868
0.6891 --- loss: 1.769070, loss_ss: 1.109633, loss_d: 0.659437
0.7274 --- loss: 1.552670, loss_ss: 0.679591, loss_d: 0.873079
0.7657 --- loss: 1.293069, loss_ss: 0.886348, loss_d: 0.406721
0.8040 --- loss: 1.152545, loss_ss: 0.935790, loss_d: 0.216755
0.8423 --- loss: 1.535544, loss_ss: 0.956673, loss_d: 0.578871
0.8806 --- loss: 1.109486, loss_ss: 0.743244, loss_d: 0.366242
0.9188 --- loss: 1.538742, loss_ss: 1.273020, loss_d: 0.265722
0.9571 --- loss: 1.323892, loss_ss: 0.805506, loss_d: 0.518386
0.9954 --- loss: 1.274850, loss_ss: 1.015635, loss_d: 0.259215
Epoch finished! Loss: 1.3896453839608993
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.331620, loss_ss: 0.874590, loss_d: 0.457030
0.0383 --- loss: 1.289697, loss_ss: 0.988206, loss_d: 0.301491
0.0766 --- loss: 1.033582, loss_ss: 0.861932, loss_d: 0.171651
0.1149 --- loss: 1.259270, loss_ss: 0.793970, loss_d: 0.465300
0.1531 --- loss: 0.927223, loss_ss: 0.778560, loss_d: 0.148664
0.1914 --- loss: 1.827451, loss_ss: 0.980675, loss_d: 0.846776
0.2297 --- loss: 1.768697, loss_ss: 1.169578, loss_d: 0.599119
0.2680 --- loss: 1.545183, loss_ss: 0.936056, loss_d: 0.609127
0.3063 --- loss: 1.255546, loss_ss: 1.000142, loss_d: 0.255404
0.3446 --- loss: 1.080780, loss_ss: 0.809948, loss_d: 0.270832
0.3828 --- loss: 1.138587, loss_ss: 0.743235, loss_d: 0.395352
0.4211 --- loss: 1.318258, loss_ss: 0.892390, loss_d: 0.425868
0.4594 --- loss: 1.038309, loss_ss: 0.697541, loss_d: 0.340767
0.4977 --- loss: 1.343743, loss_ss: 0.942345, loss_d: 0.401398
0.5360 --- loss: 1.214931, loss_ss: 0.917420, loss_d: 0.297511
0.5743 --- loss: 1.110577, loss_ss: 0.909139, loss_d: 0.201437
0.6126 --- loss: 1.855743, loss_ss: 0.934461, loss_d: 0.921282
0.6508 --- loss: 1.896118, loss_ss: 0.934806, loss_d: 0.961312
0.6891 --- loss: 1.443790, loss_ss: 0.971603, loss_d: 0.472187
0.7274 --- loss: 0.979906, loss_ss: 0.662977, loss_d: 0.316929
0.7657 --- loss: 1.415043, loss_ss: 1.094145, loss_d: 0.320898
0.8040 --- loss: 1.253421, loss_ss: 0.932032, loss_d: 0.321389
0.8423 --- loss: 1.956794, loss_ss: 1.252806, loss_d: 0.703988
0.8806 --- loss: 1.625931, loss_ss: 0.924083, loss_d: 0.701848
0.9188 --- loss: 1.218295, loss_ss: 0.906699, loss_d: 0.311595
0.9571 --- loss: 1.354886, loss_ss: 0.920461, loss_d: 0.434425
0.9954 --- loss: 1.334562, loss_ss: 0.868305, loss_d: 0.466257
Epoch finished! Loss: 1.3684960183512662
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.582268, loss_ss: 0.960610, loss_d: 0.621658
0.0383 --- loss: 1.553997, loss_ss: 1.211991, loss_d: 0.342006
0.0766 --- loss: 1.003762, loss_ss: 0.642422, loss_d: 0.361340
0.1149 --- loss: 1.357615, loss_ss: 1.202278, loss_d: 0.155336
0.1531 --- loss: 0.817202, loss_ss: 0.690850, loss_d: 0.126352
0.1914 --- loss: 0.837335, loss_ss: 0.692825, loss_d: 0.144510
0.2297 --- loss: 1.117612, loss_ss: 0.969400, loss_d: 0.148212
0.2680 --- loss: 1.577480, loss_ss: 1.249588, loss_d: 0.327892
0.3063 --- loss: 1.437774, loss_ss: 0.957254, loss_d: 0.480520
0.3446 --- loss: 0.887087, loss_ss: 0.692000, loss_d: 0.195087
0.3828 --- loss: 0.773000, loss_ss: 0.607828, loss_d: 0.165172
0.4211 --- loss: 1.687041, loss_ss: 1.007752, loss_d: 0.679289
0.4594 --- loss: 1.362565, loss_ss: 0.949521, loss_d: 0.413044
0.4977 --- loss: 1.821170, loss_ss: 0.808541, loss_d: 1.012629
0.5360 --- loss: 1.892551, loss_ss: 0.911142, loss_d: 0.981410
0.5743 --- loss: 1.264126, loss_ss: 1.089867, loss_d: 0.174259
0.6126 --- loss: 1.159119, loss_ss: 0.870427, loss_d: 0.288693
0.6508 --- loss: 1.239289, loss_ss: 0.754348, loss_d: 0.484941
0.6891 --- loss: 1.789751, loss_ss: 0.729754, loss_d: 1.059997
0.7274 --- loss: 1.248784, loss_ss: 0.697250, loss_d: 0.551534
0.7657 --- loss: 1.317987, loss_ss: 1.082732, loss_d: 0.235255
0.8040 --- loss: 1.018432, loss_ss: 0.738435, loss_d: 0.279997
0.8423 --- loss: 1.444145, loss_ss: 0.941945, loss_d: 0.502200
0.8806 --- loss: 1.133150, loss_ss: 0.721544, loss_d: 0.411606
0.9188 --- loss: 1.308014, loss_ss: 0.857567, loss_d: 0.450447
0.9571 --- loss: 1.405006, loss_ss: 0.980260, loss_d: 0.424746
0.9954 --- loss: 1.165153, loss_ss: 0.850281, loss_d: 0.314871
Epoch finished! Loss: 1.285720011740352
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.210072, loss_ss: 0.927312, loss_d: 0.282760
0.0383 --- loss: 1.657258, loss_ss: 0.972674, loss_d: 0.684584
0.0766 --- loss: 1.202035, loss_ss: 0.898588, loss_d: 0.303447
0.1149 --- loss: 1.174936, loss_ss: 0.900240, loss_d: 0.274696
0.1531 --- loss: 0.963166, loss_ss: 0.765870, loss_d: 0.197297
0.1914 --- loss: 1.293202, loss_ss: 0.800788, loss_d: 0.492414
0.2297 --- loss: 0.847307, loss_ss: 0.643249, loss_d: 0.204058
0.2680 --- loss: 1.041837, loss_ss: 0.924628, loss_d: 0.117208
0.3063 --- loss: 1.241791, loss_ss: 1.035930, loss_d: 0.205862
0.3446 --- loss: 0.821005, loss_ss: 0.672027, loss_d: 0.148978
0.3828 --- loss: 1.816983, loss_ss: 0.927099, loss_d: 0.889884
0.4211 --- loss: 1.246611, loss_ss: 1.041285, loss_d: 0.205326
0.4594 --- loss: 1.061866, loss_ss: 0.864902, loss_d: 0.196963
0.4977 --- loss: 1.375523, loss_ss: 0.806730, loss_d: 0.568793
0.5360 --- loss: 1.127311, loss_ss: 0.656049, loss_d: 0.471262
0.5743 --- loss: 1.146337, loss_ss: 0.600914, loss_d: 0.545423
0.6126 --- loss: 1.074656, loss_ss: 0.723294, loss_d: 0.351363
0.6508 --- loss: 1.131888, loss_ss: 0.852547, loss_d: 0.279341
0.6891 --- loss: 1.331384, loss_ss: 0.865430, loss_d: 0.465955
0.7274 --- loss: 0.850795, loss_ss: 0.743829, loss_d: 0.106966
0.7657 --- loss: 1.001860, loss_ss: 0.885124, loss_d: 0.116737
0.8040 --- loss: 1.263711, loss_ss: 0.557533, loss_d: 0.706177
0.8423 --- loss: 1.741650, loss_ss: 0.666512, loss_d: 1.075137
0.8806 --- loss: 1.017554, loss_ss: 0.734773, loss_d: 0.282781
0.9188 --- loss: 1.234069, loss_ss: 0.875102, loss_d: 0.358967
0.9571 --- loss: 1.121009, loss_ss: 0.831745, loss_d: 0.289263
0.9954 --- loss: 2.267662, loss_ss: 0.988826, loss_d: 1.278836
Epoch finished! Loss: 1.2528781708172911
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.093615, loss_ss: 0.853556, loss_d: 0.240059
0.0383 --- loss: 0.927651, loss_ss: 0.675532, loss_d: 0.252119
0.0766 --- loss: 1.668977, loss_ss: 1.198080, loss_d: 0.470898
0.1149 --- loss: 1.255931, loss_ss: 0.721044, loss_d: 0.534887
0.1531 --- loss: 1.190417, loss_ss: 0.843381, loss_d: 0.347036
0.1914 --- loss: 0.988774, loss_ss: 0.870421, loss_d: 0.118354
0.2297 --- loss: 1.222906, loss_ss: 0.772508, loss_d: 0.450398
0.2680 --- loss: 1.361478, loss_ss: 0.628386, loss_d: 0.733092
0.3063 --- loss: 1.317195, loss_ss: 0.932551, loss_d: 0.384644
0.3446 --- loss: 1.210957, loss_ss: 0.850418, loss_d: 0.360540
0.3828 --- loss: 1.381063, loss_ss: 1.005773, loss_d: 0.375291
0.4211 --- loss: 0.912560, loss_ss: 0.757575, loss_d: 0.154984
0.4594 --- loss: 1.391980, loss_ss: 1.070363, loss_d: 0.321618
0.4977 --- loss: 1.287346, loss_ss: 0.844302, loss_d: 0.443043
0.5360 --- loss: 1.275440, loss_ss: 0.969149, loss_d: 0.306291
0.5743 --- loss: 1.074227, loss_ss: 0.847824, loss_d: 0.226403
0.6126 --- loss: 1.747865, loss_ss: 1.234891, loss_d: 0.512974
0.6508 --- loss: 0.885695, loss_ss: 0.622693, loss_d: 0.263001
0.6891 --- loss: 1.353390, loss_ss: 0.877387, loss_d: 0.476003
0.7274 --- loss: 1.059453, loss_ss: 0.574755, loss_d: 0.484699
0.7657 --- loss: 1.173980, loss_ss: 1.034025, loss_d: 0.139955
0.8040 --- loss: 1.167057, loss_ss: 0.780664, loss_d: 0.386393
0.8423 --- loss: 1.054435, loss_ss: 0.919354, loss_d: 0.135080
0.8806 --- loss: 0.988297, loss_ss: 0.830167, loss_d: 0.158129
0.9188 --- loss: 1.596157, loss_ss: 1.280797, loss_d: 0.315360
0.9571 --- loss: 1.182040, loss_ss: 1.080595, loss_d: 0.101445
0.9954 --- loss: 1.216652, loss_ss: 0.982962, loss_d: 0.233690
Epoch finished! Loss: 1.214089851498147
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.978584, loss_ss: 0.836610, loss_d: 0.141975
0.0383 --- loss: 1.245614, loss_ss: 0.806991, loss_d: 0.438623
0.0766 --- loss: 1.509551, loss_ss: 0.651418, loss_d: 0.858134
0.1149 --- loss: 0.995564, loss_ss: 0.760271, loss_d: 0.235293
0.1531 --- loss: 1.158300, loss_ss: 0.667559, loss_d: 0.490741
0.1914 --- loss: 1.429243, loss_ss: 1.136667, loss_d: 0.292576
0.2297 --- loss: 1.000153, loss_ss: 0.810187, loss_d: 0.189966
0.2680 --- loss: 1.523117, loss_ss: 0.936792, loss_d: 0.586325
0.3063 --- loss: 1.217141, loss_ss: 0.723695, loss_d: 0.493446
0.3446 --- loss: 0.709910, loss_ss: 0.585471, loss_d: 0.124439
0.3828 --- loss: 0.986115, loss_ss: 0.853454, loss_d: 0.132661
0.4211 --- loss: 1.430913, loss_ss: 1.065238, loss_d: 0.365674
0.4594 --- loss: 1.033932, loss_ss: 0.790740, loss_d: 0.243193
0.4977 --- loss: 0.818406, loss_ss: 0.660598, loss_d: 0.157808
0.5360 --- loss: 1.061715, loss_ss: 0.797828, loss_d: 0.263887
0.5743 --- loss: 1.445135, loss_ss: 1.260734, loss_d: 0.184401
0.6126 --- loss: 1.045682, loss_ss: 0.943569, loss_d: 0.102114
0.6508 --- loss: 1.158687, loss_ss: 1.039374, loss_d: 0.119313
0.6891 --- loss: 1.354344, loss_ss: 1.080856, loss_d: 0.273487
0.7274 --- loss: 1.135689, loss_ss: 0.989093, loss_d: 0.146596
0.7657 --- loss: 1.173673, loss_ss: 0.942421, loss_d: 0.231252
0.8040 --- loss: 0.846399, loss_ss: 0.630690, loss_d: 0.215709
0.8423 --- loss: 0.874710, loss_ss: 0.772589, loss_d: 0.102121
0.8806 --- loss: 1.162537, loss_ss: 0.710135, loss_d: 0.452402
0.9188 --- loss: 0.777261, loss_ss: 0.721811, loss_d: 0.055450
0.9571 --- loss: 1.074316, loss_ss: 0.951811, loss_d: 0.122505
0.9954 --- loss: 0.788008, loss_ss: 0.622837, loss_d: 0.165171
Epoch finished! Loss: 1.1593030238973683
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.882051282051282
             precision    recall  f1-score   support

        0.0       0.85      0.92      0.88        78
        1.0       0.50      0.02      0.04        50
        2.0       0.88      0.93      0.90       397
        3.0       0.88      0.98      0.92       143
        4.0       0.95      0.93      0.94       112

avg / total       0.86      0.88      0.86       780
 


====== chc001-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.56  92.31   98.15  84.71     88.34
1  93.59   2.00   99.86  50.00      3.85
2  90.00  93.45   86.42  87.71     90.49
3  97.05  97.90   96.86  87.50     92.41
4  98.21  92.86   99.10  94.55     93.69
Total accuracy: 88.21%
Average sen: 75.70%
Average spec: 96.08%
Macro f1-score: 73.76%
[0.52286762 0.6647917  0.0518736  0.36896077 0.34753293 0.11155649
 0.03001708 0.05952583 0.23052166 0.09883108 0.11839373 0.12120122
 0.14289029 0.07933055 0.05464336 0.06637488 0.08824784 0.27413023
 0.15007922 0.06610757 0.77372009 0.85647035 0.60988879 0.11549234
 0.07946301 0.05689162]
pred: 0.23614630232063624, label: 0
Right! Diagnosis: Other

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.442923, loss_ss: 1.740544, loss_d: 0.702379
0.0384 --- loss: 2.189259, loss_ss: 1.544549, loss_d: 0.644710
0.0768 --- loss: 2.195255, loss_ss: 1.609536, loss_d: 0.585719
0.1153 --- loss: 2.327978, loss_ss: 1.369339, loss_d: 0.958639
0.1537 --- loss: 1.929757, loss_ss: 1.432877, loss_d: 0.496880
0.1921 --- loss: 1.877335, loss_ss: 1.447847, loss_d: 0.429489
0.2305 --- loss: 1.995751, loss_ss: 1.255605, loss_d: 0.740146
0.2689 --- loss: 1.884801, loss_ss: 1.429209, loss_d: 0.455592
0.3073 --- loss: 1.996808, loss_ss: 1.315033, loss_d: 0.681775
0.3458 --- loss: 2.103990, loss_ss: 1.233603, loss_d: 0.870387
0.3842 --- loss: 1.885809, loss_ss: 1.279115, loss_d: 0.606694
0.4226 --- loss: 1.828388, loss_ss: 1.316464, loss_d: 0.511924
0.4610 --- loss: 1.386659, loss_ss: 1.135078, loss_d: 0.251581
0.4994 --- loss: 1.861752, loss_ss: 1.353062, loss_d: 0.508689
0.5378 --- loss: 1.877956, loss_ss: 1.158219, loss_d: 0.719737
0.5763 --- loss: 1.855400, loss_ss: 1.235130, loss_d: 0.620271
0.6147 --- loss: 1.842595, loss_ss: 1.237068, loss_d: 0.605526
0.6531 --- loss: 1.771108, loss_ss: 1.240076, loss_d: 0.531032
0.6915 --- loss: 1.736487, loss_ss: 1.244957, loss_d: 0.491530
0.7299 --- loss: 1.612334, loss_ss: 1.157069, loss_d: 0.455264
0.7683 --- loss: 1.830791, loss_ss: 1.077046, loss_d: 0.753744
0.8068 --- loss: 1.841212, loss_ss: 1.085025, loss_d: 0.756187
0.8452 --- loss: 1.944160, loss_ss: 1.330715, loss_d: 0.613445
0.8836 --- loss: 1.975378, loss_ss: 1.220891, loss_d: 0.754487
0.9220 --- loss: 1.610990, loss_ss: 1.141364, loss_d: 0.469626
0.9604 --- loss: 1.393250, loss_ss: 1.043747, loss_d: 0.349503
0.9988 --- loss: 2.443913, loss_ss: 1.153812, loss_d: 1.290101
Epoch finished! Loss: 1.9121077216588533
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.894005, loss_ss: 0.977647, loss_d: 0.916358
0.0384 --- loss: 1.571388, loss_ss: 1.150174, loss_d: 0.421214
0.0768 --- loss: 1.699254, loss_ss: 1.162865, loss_d: 0.536389
0.1153 --- loss: 1.676350, loss_ss: 1.126515, loss_d: 0.549834
0.1537 --- loss: 1.753387, loss_ss: 1.052261, loss_d: 0.701126
0.1921 --- loss: 1.570802, loss_ss: 0.986840, loss_d: 0.583962
0.2305 --- loss: 1.887110, loss_ss: 1.115284, loss_d: 0.771826
0.2689 --- loss: 1.764547, loss_ss: 1.046912, loss_d: 0.717636
0.3073 --- loss: 1.723012, loss_ss: 1.268292, loss_d: 0.454720
0.3458 --- loss: 1.997870, loss_ss: 1.230035, loss_d: 0.767835
0.3842 --- loss: 1.733662, loss_ss: 0.950459, loss_d: 0.783204
0.4226 --- loss: 1.477540, loss_ss: 0.980849, loss_d: 0.496690
0.4610 --- loss: 1.588131, loss_ss: 1.081172, loss_d: 0.506960
0.4994 --- loss: 1.285037, loss_ss: 1.016998, loss_d: 0.268039
0.5378 --- loss: 1.805272, loss_ss: 1.241858, loss_d: 0.563413
0.5763 --- loss: 1.628567, loss_ss: 1.198966, loss_d: 0.429601
0.6147 --- loss: 1.523963, loss_ss: 1.022306, loss_d: 0.501657
0.6531 --- loss: 1.558986, loss_ss: 1.063260, loss_d: 0.495726
0.6915 --- loss: 1.357057, loss_ss: 0.964760, loss_d: 0.392297
0.7299 --- loss: 1.566275, loss_ss: 1.075930, loss_d: 0.490345
0.7683 --- loss: 1.356565, loss_ss: 0.990334, loss_d: 0.366230
0.8068 --- loss: 2.198157, loss_ss: 1.326763, loss_d: 0.871395
0.8452 --- loss: 1.701838, loss_ss: 1.015810, loss_d: 0.686028
0.8836 --- loss: 1.672941, loss_ss: 1.159585, loss_d: 0.513357
0.9220 --- loss: 1.647122, loss_ss: 1.158545, loss_d: 0.488577
0.9604 --- loss: 1.378470, loss_ss: 0.932616, loss_d: 0.445854
0.9988 --- loss: 1.989969, loss_ss: 1.464644, loss_d: 0.525325
Epoch finished! Loss: 1.6791177763388707
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.931074, loss_ss: 0.827516, loss_d: 1.103558
0.0384 --- loss: 1.511555, loss_ss: 1.043317, loss_d: 0.468238
0.0768 --- loss: 1.193945, loss_ss: 0.746312, loss_d: 0.447633
0.1153 --- loss: 1.982496, loss_ss: 1.380640, loss_d: 0.601856
0.1537 --- loss: 1.831424, loss_ss: 1.098037, loss_d: 0.733388
0.1921 --- loss: 1.304803, loss_ss: 0.810842, loss_d: 0.493961
0.2305 --- loss: 1.637017, loss_ss: 0.836620, loss_d: 0.800397
0.2689 --- loss: 1.832441, loss_ss: 1.023092, loss_d: 0.809349
0.3073 --- loss: 1.714540, loss_ss: 0.973785, loss_d: 0.740756
0.3458 --- loss: 1.393829, loss_ss: 0.942192, loss_d: 0.451637
0.3842 --- loss: 1.642097, loss_ss: 0.983460, loss_d: 0.658637
0.4226 --- loss: 1.332842, loss_ss: 1.093980, loss_d: 0.238862
0.4610 --- loss: 1.494271, loss_ss: 0.922577, loss_d: 0.571694
0.4994 --- loss: 1.712333, loss_ss: 0.845953, loss_d: 0.866381
0.5378 --- loss: 1.998986, loss_ss: 1.262454, loss_d: 0.736532
0.5763 --- loss: 1.765239, loss_ss: 1.104402, loss_d: 0.660837
0.6147 --- loss: 1.349689, loss_ss: 1.098865, loss_d: 0.250825
0.6531 --- loss: 1.340122, loss_ss: 1.078272, loss_d: 0.261851
0.6915 --- loss: 1.154827, loss_ss: 0.843024, loss_d: 0.311803
0.7299 --- loss: 1.203192, loss_ss: 0.974724, loss_d: 0.228468
0.7683 --- loss: 1.784826, loss_ss: 1.202511, loss_d: 0.582314
0.8068 --- loss: 1.753658, loss_ss: 1.191460, loss_d: 0.562197
0.8452 --- loss: 1.450005, loss_ss: 0.887718, loss_d: 0.562287
0.8836 --- loss: 1.275352, loss_ss: 0.892741, loss_d: 0.382611
0.9220 --- loss: 1.876710, loss_ss: 0.996449, loss_d: 0.880261
0.9604 --- loss: 1.594486, loss_ss: 1.091183, loss_d: 0.503303
0.9988 --- loss: 1.459295, loss_ss: 0.916522, loss_d: 0.542773
Epoch finished! Loss: 1.5454901906160208
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.558197, loss_ss: 1.089693, loss_d: 0.468504
0.0384 --- loss: 1.373821, loss_ss: 1.085495, loss_d: 0.288326
0.0768 --- loss: 1.414644, loss_ss: 1.149357, loss_d: 0.265286
0.1153 --- loss: 1.294407, loss_ss: 0.849265, loss_d: 0.445142
0.1537 --- loss: 1.348643, loss_ss: 0.981593, loss_d: 0.367049
0.1921 --- loss: 1.438394, loss_ss: 1.065554, loss_d: 0.372840
0.2305 --- loss: 1.277051, loss_ss: 0.988166, loss_d: 0.288885
0.2689 --- loss: 1.423693, loss_ss: 1.066373, loss_d: 0.357320
0.3073 --- loss: 1.112378, loss_ss: 0.787804, loss_d: 0.324574
0.3458 --- loss: 1.572888, loss_ss: 1.052154, loss_d: 0.520735
0.3842 --- loss: 2.183081, loss_ss: 1.285388, loss_d: 0.897693
0.4226 --- loss: 1.185609, loss_ss: 0.868395, loss_d: 0.317213
0.4610 --- loss: 1.231403, loss_ss: 0.940644, loss_d: 0.290759
0.4994 --- loss: 0.997542, loss_ss: 0.795384, loss_d: 0.202158
0.5378 --- loss: 1.404579, loss_ss: 0.855912, loss_d: 0.548667
0.5763 --- loss: 1.282662, loss_ss: 0.875999, loss_d: 0.406663
0.6147 --- loss: 1.281249, loss_ss: 0.949187, loss_d: 0.332061
0.6531 --- loss: 1.194817, loss_ss: 0.783419, loss_d: 0.411398
0.6915 --- loss: 1.504420, loss_ss: 0.867947, loss_d: 0.636473
0.7299 --- loss: 1.168558, loss_ss: 0.782017, loss_d: 0.386541
0.7683 --- loss: 1.408417, loss_ss: 0.856270, loss_d: 0.552147
0.8068 --- loss: 1.264664, loss_ss: 0.970677, loss_d: 0.293987
0.8452 --- loss: 1.038249, loss_ss: 0.789053, loss_d: 0.249196
0.8836 --- loss: 2.021127, loss_ss: 1.511590, loss_d: 0.509536
0.9220 --- loss: 1.228620, loss_ss: 0.748394, loss_d: 0.480226
0.9604 --- loss: 1.228913, loss_ss: 0.875229, loss_d: 0.353684
0.9988 --- loss: 1.027642, loss_ss: 0.895403, loss_d: 0.132239
Epoch finished! Loss: 1.4505943410671673
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.356944, loss_ss: 0.987670, loss_d: 0.369273
0.0384 --- loss: 1.282521, loss_ss: 1.018584, loss_d: 0.263937
0.0768 --- loss: 1.426442, loss_ss: 1.122129, loss_d: 0.304313
0.1153 --- loss: 1.418936, loss_ss: 0.890996, loss_d: 0.527940
0.1537 --- loss: 1.322118, loss_ss: 0.865589, loss_d: 0.456530
0.1921 --- loss: 1.273456, loss_ss: 1.035435, loss_d: 0.238020
0.2305 --- loss: 1.271355, loss_ss: 0.747792, loss_d: 0.523563
0.2689 --- loss: 0.986455, loss_ss: 0.706880, loss_d: 0.279575
0.3073 --- loss: 1.638829, loss_ss: 1.014239, loss_d: 0.624590
0.3458 --- loss: 1.200601, loss_ss: 0.924576, loss_d: 0.276025
0.3842 --- loss: 1.245423, loss_ss: 1.040609, loss_d: 0.204814
0.4226 --- loss: 0.779953, loss_ss: 0.637768, loss_d: 0.142185
0.4610 --- loss: 1.295409, loss_ss: 0.837100, loss_d: 0.458309
0.4994 --- loss: 1.242936, loss_ss: 0.834520, loss_d: 0.408416
0.5378 --- loss: 1.136939, loss_ss: 0.915437, loss_d: 0.221502
0.5763 --- loss: 1.323213, loss_ss: 0.580568, loss_d: 0.742646
0.6147 --- loss: 1.849145, loss_ss: 1.155943, loss_d: 0.693202
0.6531 --- loss: 1.186126, loss_ss: 1.002940, loss_d: 0.183187
0.6915 --- loss: 1.560810, loss_ss: 1.036550, loss_d: 0.524260
0.7299 --- loss: 1.451655, loss_ss: 0.985984, loss_d: 0.465671
0.7683 --- loss: 1.504955, loss_ss: 0.963669, loss_d: 0.541286
0.8068 --- loss: 1.171371, loss_ss: 0.954304, loss_d: 0.217066
0.8452 --- loss: 1.466782, loss_ss: 1.068096, loss_d: 0.398686
0.8836 --- loss: 1.468191, loss_ss: 1.028882, loss_d: 0.439309
0.9220 --- loss: 1.180074, loss_ss: 0.976055, loss_d: 0.204019
0.9604 --- loss: 1.577638, loss_ss: 0.805194, loss_d: 0.772444
0.9988 --- loss: 1.759371, loss_ss: 0.914359, loss_d: 0.845011
Epoch finished! Loss: 1.3735321127451383
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.173565, loss_ss: 0.936578, loss_d: 0.236987
0.0384 --- loss: 1.372418, loss_ss: 1.071989, loss_d: 0.300429
0.0768 --- loss: 1.523500, loss_ss: 0.963928, loss_d: 0.559572
0.1153 --- loss: 1.118487, loss_ss: 0.763649, loss_d: 0.354839
0.1537 --- loss: 1.049970, loss_ss: 0.882950, loss_d: 0.167020
0.1921 --- loss: 1.792106, loss_ss: 1.014829, loss_d: 0.777276
0.2305 --- loss: 1.199337, loss_ss: 0.940054, loss_d: 0.259283
0.2689 --- loss: 0.977145, loss_ss: 0.735942, loss_d: 0.241203
0.3073 --- loss: 1.536499, loss_ss: 0.696210, loss_d: 0.840290
0.3458 --- loss: 1.873286, loss_ss: 1.276370, loss_d: 0.596916
0.3842 --- loss: 1.344819, loss_ss: 1.058482, loss_d: 0.286337
0.4226 --- loss: 1.550226, loss_ss: 1.131964, loss_d: 0.418262
0.4610 --- loss: 1.288536, loss_ss: 1.048580, loss_d: 0.239956
0.4994 --- loss: 1.562618, loss_ss: 1.020466, loss_d: 0.542152
0.5378 --- loss: 1.068892, loss_ss: 0.822416, loss_d: 0.246476
0.5763 --- loss: 1.287119, loss_ss: 0.912365, loss_d: 0.374754
0.6147 --- loss: 1.718650, loss_ss: 1.160685, loss_d: 0.557965
0.6531 --- loss: 1.204027, loss_ss: 0.949716, loss_d: 0.254311
0.6915 --- loss: 1.382912, loss_ss: 1.101113, loss_d: 0.281799
0.7299 --- loss: 1.526288, loss_ss: 0.819532, loss_d: 0.706756
0.7683 --- loss: 0.938833, loss_ss: 0.695176, loss_d: 0.243657
0.8068 --- loss: 0.997926, loss_ss: 0.577962, loss_d: 0.419964
0.8452 --- loss: 1.335572, loss_ss: 0.843432, loss_d: 0.492140
0.8836 --- loss: 1.502322, loss_ss: 1.227950, loss_d: 0.274372
0.9220 --- loss: 2.116284, loss_ss: 1.353812, loss_d: 0.762472
0.9604 --- loss: 1.286433, loss_ss: 0.995021, loss_d: 0.291412
0.9988 --- loss: 1.859409, loss_ss: 1.506745, loss_d: 0.352664
Epoch finished! Loss: 1.3218283176422119
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.349752, loss_ss: 1.169307, loss_d: 0.180445
0.0384 --- loss: 1.814709, loss_ss: 1.095808, loss_d: 0.718901
0.0768 --- loss: 1.239217, loss_ss: 1.043145, loss_d: 0.196072
0.1153 --- loss: 1.810560, loss_ss: 1.352026, loss_d: 0.458534
0.1537 --- loss: 1.058181, loss_ss: 0.784152, loss_d: 0.274029
0.1921 --- loss: 1.820002, loss_ss: 1.140486, loss_d: 0.679516
0.2305 --- loss: 1.366907, loss_ss: 1.051132, loss_d: 0.315775
0.2689 --- loss: 0.858597, loss_ss: 0.622839, loss_d: 0.235757
0.3073 --- loss: 1.143811, loss_ss: 0.865233, loss_d: 0.278578
0.3458 --- loss: 1.309930, loss_ss: 0.978051, loss_d: 0.331879
0.3842 --- loss: 1.177546, loss_ss: 0.820169, loss_d: 0.357377
0.4226 --- loss: 1.307201, loss_ss: 1.076492, loss_d: 0.230708
0.4610 --- loss: 0.917979, loss_ss: 0.744032, loss_d: 0.173946
0.4994 --- loss: 0.963284, loss_ss: 0.802549, loss_d: 0.160735
0.5378 --- loss: 1.146952, loss_ss: 0.880083, loss_d: 0.266869
0.5763 --- loss: 0.760072, loss_ss: 0.501720, loss_d: 0.258352
0.6147 --- loss: 1.342978, loss_ss: 0.986060, loss_d: 0.356918
0.6531 --- loss: 1.011112, loss_ss: 0.844061, loss_d: 0.167050
0.6915 --- loss: 1.569947, loss_ss: 1.062392, loss_d: 0.507555
0.7299 --- loss: 1.396442, loss_ss: 0.872897, loss_d: 0.523544
0.7683 --- loss: 1.630641, loss_ss: 1.223436, loss_d: 0.407206
0.8068 --- loss: 1.333613, loss_ss: 0.824945, loss_d: 0.508668
0.8452 --- loss: 1.010414, loss_ss: 0.610170, loss_d: 0.400245
0.8836 --- loss: 1.474250, loss_ss: 0.844892, loss_d: 0.629358
0.9220 --- loss: 1.175402, loss_ss: 0.963653, loss_d: 0.211749
0.9604 --- loss: 1.284662, loss_ss: 0.899228, loss_d: 0.385434
0.9988 --- loss: 1.884526, loss_ss: 1.751203, loss_d: 0.133323
Epoch finished! Loss: 1.2888519126635332
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.239846, loss_ss: 0.966412, loss_d: 0.273434
0.0384 --- loss: 0.939930, loss_ss: 0.748968, loss_d: 0.190961
0.0768 --- loss: 1.223812, loss_ss: 0.831770, loss_d: 0.392042
0.1153 --- loss: 1.478467, loss_ss: 1.216248, loss_d: 0.262219
0.1537 --- loss: 1.363925, loss_ss: 1.059867, loss_d: 0.304058
0.1921 --- loss: 1.052718, loss_ss: 0.737421, loss_d: 0.315297
0.2305 --- loss: 1.157304, loss_ss: 0.963569, loss_d: 0.193735
0.2689 --- loss: 1.042419, loss_ss: 0.712533, loss_d: 0.329886
0.3073 --- loss: 1.733672, loss_ss: 0.906261, loss_d: 0.827410
0.3458 --- loss: 1.266481, loss_ss: 0.891425, loss_d: 0.375056
0.3842 --- loss: 0.976162, loss_ss: 0.614380, loss_d: 0.361782
0.4226 --- loss: 1.367717, loss_ss: 1.097754, loss_d: 0.269962
0.4610 --- loss: 1.428926, loss_ss: 0.746755, loss_d: 0.682170
0.4994 --- loss: 0.898898, loss_ss: 0.728341, loss_d: 0.170557
0.5378 --- loss: 1.513282, loss_ss: 1.276283, loss_d: 0.236999
0.5763 --- loss: 1.448578, loss_ss: 1.316023, loss_d: 0.132555
0.6147 --- loss: 1.148804, loss_ss: 0.856963, loss_d: 0.291842
0.6531 --- loss: 1.428687, loss_ss: 1.299493, loss_d: 0.129193
0.6915 --- loss: 1.237720, loss_ss: 0.813418, loss_d: 0.424301
0.7299 --- loss: 1.022914, loss_ss: 0.724142, loss_d: 0.298772
0.7683 --- loss: 1.118219, loss_ss: 0.683695, loss_d: 0.434524
0.8068 --- loss: 1.388227, loss_ss: 0.989786, loss_d: 0.398441
0.8452 --- loss: 1.504185, loss_ss: 1.088495, loss_d: 0.415690
0.8836 --- loss: 0.894866, loss_ss: 0.723024, loss_d: 0.171841
0.9220 --- loss: 1.198564, loss_ss: 0.777877, loss_d: 0.420687
0.9604 --- loss: 1.407033, loss_ss: 1.030149, loss_d: 0.376884
0.9988 --- loss: 0.944487, loss_ss: 0.618454, loss_d: 0.326033
Epoch finished! Loss: 1.2459515129144376
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 2.146376, loss_ss: 0.942046, loss_d: 1.204330
0.0384 --- loss: 1.922255, loss_ss: 1.758030, loss_d: 0.164225
0.0768 --- loss: 1.206471, loss_ss: 0.784517, loss_d: 0.421954
0.1153 --- loss: 1.528851, loss_ss: 1.191270, loss_d: 0.337580
0.1537 --- loss: 1.033388, loss_ss: 0.788144, loss_d: 0.245244
0.1921 --- loss: 1.284946, loss_ss: 0.827765, loss_d: 0.457181
0.2305 --- loss: 1.453505, loss_ss: 0.797985, loss_d: 0.655519
0.2689 --- loss: 1.290281, loss_ss: 0.798125, loss_d: 0.492155
0.3073 --- loss: 1.116584, loss_ss: 0.829528, loss_d: 0.287056
0.3458 --- loss: 0.914537, loss_ss: 0.705903, loss_d: 0.208634
0.3842 --- loss: 1.098543, loss_ss: 1.004793, loss_d: 0.093750
0.4226 --- loss: 1.190569, loss_ss: 0.837046, loss_d: 0.353523
0.4610 --- loss: 1.189057, loss_ss: 0.913728, loss_d: 0.275329
0.4994 --- loss: 1.228809, loss_ss: 1.061170, loss_d: 0.167638
0.5378 --- loss: 1.652422, loss_ss: 1.199659, loss_d: 0.452763
0.5763 --- loss: 0.935109, loss_ss: 0.850310, loss_d: 0.084799
0.6147 --- loss: 1.704523, loss_ss: 0.894671, loss_d: 0.809852
0.6531 --- loss: 1.033570, loss_ss: 0.792793, loss_d: 0.240777
0.6915 --- loss: 1.112900, loss_ss: 0.862199, loss_d: 0.250702
0.7299 --- loss: 1.643766, loss_ss: 0.887867, loss_d: 0.755899
0.7683 --- loss: 1.244061, loss_ss: 0.822834, loss_d: 0.421227
0.8068 --- loss: 1.147490, loss_ss: 0.925649, loss_d: 0.221842
0.8452 --- loss: 1.941147, loss_ss: 1.310912, loss_d: 0.630235
0.8836 --- loss: 0.969815, loss_ss: 0.766520, loss_d: 0.203295
0.9220 --- loss: 0.904506, loss_ss: 0.808079, loss_d: 0.096427
0.9604 --- loss: 1.644991, loss_ss: 0.892983, loss_d: 0.752008
0.9988 --- loss: 2.792253, loss_ss: 0.916977, loss_d: 1.875276
Epoch finished! Loss: 1.2113975761028437
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.846723, loss_ss: 0.695281, loss_d: 0.151443
0.0384 --- loss: 1.044680, loss_ss: 0.816295, loss_d: 0.228386
0.0768 --- loss: 1.490657, loss_ss: 1.300854, loss_d: 0.189803
0.1153 --- loss: 1.642295, loss_ss: 0.702844, loss_d: 0.939452
0.1537 --- loss: 1.036229, loss_ss: 0.646160, loss_d: 0.390069
0.1921 --- loss: 1.692847, loss_ss: 1.220368, loss_d: 0.472479
0.2305 --- loss: 1.362063, loss_ss: 0.874529, loss_d: 0.487534
0.2689 --- loss: 1.356769, loss_ss: 0.897256, loss_d: 0.459513
0.3073 --- loss: 1.263679, loss_ss: 0.904577, loss_d: 0.359102
0.3458 --- loss: 1.340226, loss_ss: 0.898087, loss_d: 0.442139
0.3842 --- loss: 1.083776, loss_ss: 0.849205, loss_d: 0.234571
0.4226 --- loss: 0.986024, loss_ss: 0.846568, loss_d: 0.139456
0.4610 --- loss: 0.874571, loss_ss: 0.787464, loss_d: 0.087108
0.4994 --- loss: 1.127574, loss_ss: 0.938765, loss_d: 0.188810
0.5378 --- loss: 1.222052, loss_ss: 1.113674, loss_d: 0.108378
0.5763 --- loss: 1.043547, loss_ss: 0.699227, loss_d: 0.344321
0.6147 --- loss: 1.061293, loss_ss: 0.829043, loss_d: 0.232250
0.6531 --- loss: 1.401711, loss_ss: 0.790559, loss_d: 0.611152
0.6915 --- loss: 1.219913, loss_ss: 0.916326, loss_d: 0.303587
0.7299 --- loss: 1.206497, loss_ss: 0.873710, loss_d: 0.332787
0.7683 --- loss: 1.030584, loss_ss: 0.943664, loss_d: 0.086920
0.8068 --- loss: 0.994333, loss_ss: 0.925492, loss_d: 0.068841
0.8452 --- loss: 1.356828, loss_ss: 0.935254, loss_d: 0.421574
0.8836 --- loss: 1.230635, loss_ss: 1.143218, loss_d: 0.087417
0.9220 --- loss: 0.751848, loss_ss: 0.534524, loss_d: 0.217324
0.9604 --- loss: 0.808345, loss_ss: 0.666333, loss_d: 0.142012
0.9988 --- loss: 1.388826, loss_ss: 0.964385, loss_d: 0.424441
Epoch finished! Loss: 1.1653443423601297
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8123809523809524
             precision    recall  f1-score   support

        0.0       0.82      0.45      0.58        74
        1.0       0.00      0.00      0.00        42
        2.0       0.81      0.94      0.87       515
        3.0       0.92      0.68      0.78       243
        4.0       0.72      0.97      0.83       176

avg / total       0.79      0.81      0.79      1050
 


====== chc004-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  95.43  44.59   99.28  82.50     57.89
1  96.00   0.00  100.00   0.00      0.00
2  86.48  93.98   79.25  81.34     87.21
3  91.24  67.90   98.27  92.18     78.20
4  93.33  97.16   92.56  72.46     83.01
Total accuracy: 81.24%
Average sen: 60.73%
Average spec: 93.87%
Macro f1-score: 61.26%
[0.213517   0.30834824 0.16334005 0.18344167 0.18932076 0.38558593
 0.32943735 0.38855702 0.28868487 0.39188886 0.15436909 0.21649376
 0.170369   0.22951651 0.22010066 0.17348392 0.21250889 0.17966074
 0.41065374 0.53761148 0.44287077 0.24792278 0.29751316 0.1791833
 0.15541597 0.17358264 0.57576805 0.56344032 0.43735105 0.14306007
 0.17217457 0.18115784 0.1938175  0.76213926 0.56653583]
pred: 0.2982520750590733, label: 0
Right! Diagnosis: Other

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.434235, loss_ss: 1.699077, loss_d: 0.735158
0.0384 --- loss: 2.298370, loss_ss: 1.871489, loss_d: 0.426882
0.0767 --- loss: 2.161756, loss_ss: 1.674836, loss_d: 0.486920
0.1151 --- loss: 1.780714, loss_ss: 1.515014, loss_d: 0.265699
0.1534 --- loss: 2.054828, loss_ss: 1.633970, loss_d: 0.420859
0.1918 --- loss: 2.224648, loss_ss: 1.636713, loss_d: 0.587935
0.2301 --- loss: 2.183853, loss_ss: 1.500277, loss_d: 0.683576
0.2685 --- loss: 2.180502, loss_ss: 1.463177, loss_d: 0.717325
0.3069 --- loss: 2.266713, loss_ss: 1.418526, loss_d: 0.848187
0.3452 --- loss: 1.877515, loss_ss: 1.546780, loss_d: 0.330736
0.3836 --- loss: 1.910615, loss_ss: 1.595285, loss_d: 0.315331
0.4219 --- loss: 1.988176, loss_ss: 1.478535, loss_d: 0.509640
0.4603 --- loss: 1.701173, loss_ss: 1.303251, loss_d: 0.397922
0.4987 --- loss: 1.722776, loss_ss: 1.272145, loss_d: 0.450630
0.5370 --- loss: 1.876770, loss_ss: 1.381595, loss_d: 0.495175
0.5754 --- loss: 1.587028, loss_ss: 1.214347, loss_d: 0.372682
0.6137 --- loss: 1.956772, loss_ss: 1.359695, loss_d: 0.597077
0.6521 --- loss: 1.817966, loss_ss: 1.306605, loss_d: 0.511362
0.6904 --- loss: 1.536788, loss_ss: 1.329738, loss_d: 0.207049
0.7288 --- loss: 2.082164, loss_ss: 1.454424, loss_d: 0.627740
0.7672 --- loss: 1.531740, loss_ss: 1.182555, loss_d: 0.349185
0.8055 --- loss: 1.934479, loss_ss: 1.167371, loss_d: 0.767108
0.8439 --- loss: 1.786199, loss_ss: 1.239606, loss_d: 0.546593
0.8822 --- loss: 1.793542, loss_ss: 1.275879, loss_d: 0.517664
0.9206 --- loss: 1.769751, loss_ss: 1.291401, loss_d: 0.478350
0.9590 --- loss: 1.676850, loss_ss: 1.116778, loss_d: 0.560072
0.9973 --- loss: 1.781733, loss_ss: 1.034612, loss_d: 0.747121
Epoch finished! Loss: 2.018870188181217
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.785115, loss_ss: 1.273671, loss_d: 0.511444
0.0384 --- loss: 2.123166, loss_ss: 1.287229, loss_d: 0.835938
0.0767 --- loss: 1.496796, loss_ss: 0.976089, loss_d: 0.520707
0.1151 --- loss: 2.124812, loss_ss: 1.189260, loss_d: 0.935551
0.1534 --- loss: 1.754164, loss_ss: 1.095344, loss_d: 0.658819
0.1918 --- loss: 1.814502, loss_ss: 1.172774, loss_d: 0.641728
0.2301 --- loss: 1.861379, loss_ss: 1.155438, loss_d: 0.705941
0.2685 --- loss: 1.722673, loss_ss: 1.110643, loss_d: 0.612030
0.3069 --- loss: 1.619472, loss_ss: 0.945409, loss_d: 0.674064
0.3452 --- loss: 1.871490, loss_ss: 1.416830, loss_d: 0.454660
0.3836 --- loss: 1.764022, loss_ss: 1.170280, loss_d: 0.593742
0.4219 --- loss: 1.984696, loss_ss: 1.296319, loss_d: 0.688378
0.4603 --- loss: 1.608032, loss_ss: 1.044320, loss_d: 0.563712
0.4987 --- loss: 1.798433, loss_ss: 1.070301, loss_d: 0.728132
0.5370 --- loss: 1.435897, loss_ss: 0.992642, loss_d: 0.443255
0.5754 --- loss: 1.838185, loss_ss: 0.987962, loss_d: 0.850223
0.6137 --- loss: 1.756031, loss_ss: 1.149206, loss_d: 0.606825
0.6521 --- loss: 1.797819, loss_ss: 1.189702, loss_d: 0.608117
0.6904 --- loss: 1.554803, loss_ss: 1.003605, loss_d: 0.551198
0.7288 --- loss: 1.840094, loss_ss: 1.470098, loss_d: 0.369996
0.7672 --- loss: 1.561737, loss_ss: 1.286567, loss_d: 0.275170
0.8055 --- loss: 1.917868, loss_ss: 1.249989, loss_d: 0.667879
0.8439 --- loss: 1.828404, loss_ss: 0.971082, loss_d: 0.857322
0.8822 --- loss: 1.750496, loss_ss: 1.235026, loss_d: 0.515470
0.9206 --- loss: 1.948785, loss_ss: 1.322216, loss_d: 0.626568
0.9590 --- loss: 1.454583, loss_ss: 0.908433, loss_d: 0.546150
0.9973 --- loss: 1.521186, loss_ss: 0.969527, loss_d: 0.551659
Epoch finished! Loss: 1.7097314619101012
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.280423, loss_ss: 1.403350, loss_d: 0.877073
0.0384 --- loss: 1.576495, loss_ss: 1.074828, loss_d: 0.501667
0.0767 --- loss: 1.632149, loss_ss: 1.084486, loss_d: 0.547663
0.1151 --- loss: 1.797809, loss_ss: 1.133882, loss_d: 0.663927
0.1534 --- loss: 1.668672, loss_ss: 1.311197, loss_d: 0.357475
0.1918 --- loss: 1.829439, loss_ss: 1.185664, loss_d: 0.643775
0.2301 --- loss: 1.527858, loss_ss: 0.930810, loss_d: 0.597047
0.2685 --- loss: 1.775464, loss_ss: 1.172112, loss_d: 0.603351
0.3069 --- loss: 1.675053, loss_ss: 0.946255, loss_d: 0.728798
0.3452 --- loss: 1.406396, loss_ss: 0.950693, loss_d: 0.455703
0.3836 --- loss: 1.535923, loss_ss: 1.147969, loss_d: 0.387954
0.4219 --- loss: 2.011488, loss_ss: 1.523033, loss_d: 0.488455
0.4603 --- loss: 1.601642, loss_ss: 1.046780, loss_d: 0.554862
0.4987 --- loss: 1.380330, loss_ss: 0.970562, loss_d: 0.409768
0.5370 --- loss: 1.572700, loss_ss: 0.930257, loss_d: 0.642443
0.5754 --- loss: 1.560483, loss_ss: 0.995323, loss_d: 0.565160
0.6137 --- loss: 1.718298, loss_ss: 1.069344, loss_d: 0.648954
0.6521 --- loss: 1.419218, loss_ss: 0.990012, loss_d: 0.429206
0.6904 --- loss: 1.934031, loss_ss: 1.076090, loss_d: 0.857941
0.7288 --- loss: 1.512754, loss_ss: 0.993705, loss_d: 0.519049
0.7672 --- loss: 1.598904, loss_ss: 1.115484, loss_d: 0.483420
0.8055 --- loss: 1.272255, loss_ss: 0.942143, loss_d: 0.330113
0.8439 --- loss: 1.793846, loss_ss: 1.205733, loss_d: 0.588113
0.8822 --- loss: 1.114746, loss_ss: 0.860137, loss_d: 0.254609
0.9206 --- loss: 1.476934, loss_ss: 0.959947, loss_d: 0.516987
0.9590 --- loss: 1.800964, loss_ss: 1.135518, loss_d: 0.665446
0.9973 --- loss: 1.597601, loss_ss: 1.155919, loss_d: 0.441682
Epoch finished! Loss: 1.6217529044701502
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.470618, loss_ss: 0.983861, loss_d: 0.486757
0.0384 --- loss: 1.257023, loss_ss: 0.842763, loss_d: 0.414259
0.0767 --- loss: 1.565649, loss_ss: 1.133244, loss_d: 0.432405
0.1151 --- loss: 2.027157, loss_ss: 1.420012, loss_d: 0.607145
0.1534 --- loss: 1.667455, loss_ss: 1.127733, loss_d: 0.539722
0.1918 --- loss: 1.313787, loss_ss: 0.705650, loss_d: 0.608137
0.2301 --- loss: 1.464620, loss_ss: 1.069520, loss_d: 0.395099
0.2685 --- loss: 1.718937, loss_ss: 1.131668, loss_d: 0.587269
0.3069 --- loss: 1.289338, loss_ss: 0.877174, loss_d: 0.412163
0.3452 --- loss: 1.808158, loss_ss: 1.226430, loss_d: 0.581728
0.3836 --- loss: 1.511657, loss_ss: 1.085007, loss_d: 0.426649
0.4219 --- loss: 1.829167, loss_ss: 1.288583, loss_d: 0.540584
0.4603 --- loss: 1.409869, loss_ss: 0.892681, loss_d: 0.517188
0.4987 --- loss: 1.444675, loss_ss: 1.170538, loss_d: 0.274137
0.5370 --- loss: 1.217395, loss_ss: 0.810953, loss_d: 0.406442
0.5754 --- loss: 2.204789, loss_ss: 1.396158, loss_d: 0.808632
0.6137 --- loss: 1.931162, loss_ss: 0.944988, loss_d: 0.986174
0.6521 --- loss: 1.244081, loss_ss: 0.861533, loss_d: 0.382549
0.6904 --- loss: 1.166124, loss_ss: 0.773924, loss_d: 0.392200
0.7288 --- loss: 1.896347, loss_ss: 1.201504, loss_d: 0.694842
0.7672 --- loss: 1.678638, loss_ss: 0.969738, loss_d: 0.708899
0.8055 --- loss: 1.470846, loss_ss: 0.954874, loss_d: 0.515972
0.8439 --- loss: 1.308005, loss_ss: 0.795107, loss_d: 0.512898
0.8822 --- loss: 1.346485, loss_ss: 0.754578, loss_d: 0.591907
0.9206 --- loss: 1.662413, loss_ss: 0.911368, loss_d: 0.751045
0.9590 --- loss: 1.252757, loss_ss: 0.745135, loss_d: 0.507622
0.9973 --- loss: 1.432799, loss_ss: 0.856950, loss_d: 0.575848
Epoch finished! Loss: 1.57460657954216
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.640819, loss_ss: 1.092834, loss_d: 0.547985
0.0384 --- loss: 1.585706, loss_ss: 1.001147, loss_d: 0.584560
0.0767 --- loss: 1.631218, loss_ss: 0.851684, loss_d: 0.779534
0.1151 --- loss: 1.663358, loss_ss: 0.927875, loss_d: 0.735483
0.1534 --- loss: 1.421208, loss_ss: 0.872293, loss_d: 0.548915
0.1918 --- loss: 1.376065, loss_ss: 0.956530, loss_d: 0.419535
0.2301 --- loss: 1.633966, loss_ss: 1.150425, loss_d: 0.483541
0.2685 --- loss: 1.215254, loss_ss: 0.733514, loss_d: 0.481741
0.3069 --- loss: 1.427574, loss_ss: 0.809624, loss_d: 0.617950
0.3452 --- loss: 1.651697, loss_ss: 1.182875, loss_d: 0.468822
0.3836 --- loss: 1.815314, loss_ss: 1.102302, loss_d: 0.713012
0.4219 --- loss: 1.457685, loss_ss: 0.861998, loss_d: 0.595687
0.4603 --- loss: 1.469873, loss_ss: 0.938427, loss_d: 0.531446
0.4987 --- loss: 1.524120, loss_ss: 1.089197, loss_d: 0.434923
0.5370 --- loss: 1.654882, loss_ss: 1.138334, loss_d: 0.516548
0.5754 --- loss: 1.236285, loss_ss: 0.610590, loss_d: 0.625695
0.6137 --- loss: 1.470522, loss_ss: 0.844025, loss_d: 0.626497
0.6521 --- loss: 1.680940, loss_ss: 1.181008, loss_d: 0.499932
0.6904 --- loss: 1.561159, loss_ss: 0.848895, loss_d: 0.712265
0.7288 --- loss: 1.675687, loss_ss: 1.129185, loss_d: 0.546503
0.7672 --- loss: 2.068528, loss_ss: 1.362318, loss_d: 0.706211
0.8055 --- loss: 1.453517, loss_ss: 0.713901, loss_d: 0.739616
0.8439 --- loss: 1.343529, loss_ss: 0.814203, loss_d: 0.529325
0.8822 --- loss: 1.781801, loss_ss: 1.174204, loss_d: 0.607597
0.9206 --- loss: 1.545462, loss_ss: 1.090022, loss_d: 0.455440
0.9590 --- loss: 1.319693, loss_ss: 0.884515, loss_d: 0.435178
0.9973 --- loss: 1.386249, loss_ss: 0.963888, loss_d: 0.422361
Epoch finished! Loss: 1.525576166006235
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.605682, loss_ss: 0.981383, loss_d: 0.624299
0.0384 --- loss: 1.396531, loss_ss: 0.889656, loss_d: 0.506875
0.0767 --- loss: 1.581712, loss_ss: 0.869981, loss_d: 0.711732
0.1151 --- loss: 1.107177, loss_ss: 0.792783, loss_d: 0.314395
0.1534 --- loss: 1.468949, loss_ss: 0.965478, loss_d: 0.503471
0.1918 --- loss: 1.986848, loss_ss: 1.307031, loss_d: 0.679817
0.2301 --- loss: 1.473118, loss_ss: 0.890313, loss_d: 0.582805
0.2685 --- loss: 1.106289, loss_ss: 0.717604, loss_d: 0.388685
0.3069 --- loss: 1.705899, loss_ss: 1.099216, loss_d: 0.606683
0.3452 --- loss: 1.557642, loss_ss: 1.098551, loss_d: 0.459092
0.3836 --- loss: 1.322167, loss_ss: 0.929256, loss_d: 0.392911
0.4219 --- loss: 1.611006, loss_ss: 1.217720, loss_d: 0.393286
0.4603 --- loss: 1.898118, loss_ss: 1.200262, loss_d: 0.697857
0.4987 --- loss: 1.350749, loss_ss: 0.941473, loss_d: 0.409276
0.5370 --- loss: 1.486911, loss_ss: 1.058418, loss_d: 0.428493
0.5754 --- loss: 2.266215, loss_ss: 1.728773, loss_d: 0.537442
0.6137 --- loss: 1.495194, loss_ss: 0.767625, loss_d: 0.727569
0.6521 --- loss: 1.268808, loss_ss: 0.785082, loss_d: 0.483726
0.6904 --- loss: 1.273881, loss_ss: 0.873020, loss_d: 0.400861
0.7288 --- loss: 1.464516, loss_ss: 0.945909, loss_d: 0.518607
0.7672 --- loss: 1.392248, loss_ss: 0.779191, loss_d: 0.613057
0.8055 --- loss: 1.538017, loss_ss: 0.932031, loss_d: 0.605986
0.8439 --- loss: 1.533192, loss_ss: 0.928894, loss_d: 0.604298
0.8822 --- loss: 1.767466, loss_ss: 1.160621, loss_d: 0.606845
0.9206 --- loss: 1.635012, loss_ss: 1.126492, loss_d: 0.508520
0.9590 --- loss: 1.487571, loss_ss: 1.046111, loss_d: 0.441460
0.9973 --- loss: 2.399026, loss_ss: 1.369355, loss_d: 1.029672
Epoch finished! Loss: 1.4923176710422223
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.238305, loss_ss: 0.783981, loss_d: 0.454324
0.0384 --- loss: 1.124674, loss_ss: 0.745426, loss_d: 0.379248
0.0767 --- loss: 1.491659, loss_ss: 1.018126, loss_d: 0.473532
0.1151 --- loss: 1.460415, loss_ss: 0.655598, loss_d: 0.804816
0.1534 --- loss: 1.310077, loss_ss: 0.940005, loss_d: 0.370071
0.1918 --- loss: 1.576885, loss_ss: 1.018862, loss_d: 0.558024
0.2301 --- loss: 1.159387, loss_ss: 0.584471, loss_d: 0.574916
0.2685 --- loss: 1.395253, loss_ss: 0.933749, loss_d: 0.461504
0.3069 --- loss: 1.713533, loss_ss: 0.934112, loss_d: 0.779421
0.3452 --- loss: 1.254263, loss_ss: 0.731175, loss_d: 0.523087
0.3836 --- loss: 1.343939, loss_ss: 0.820939, loss_d: 0.523000
0.4219 --- loss: 1.364452, loss_ss: 0.789534, loss_d: 0.574918
0.4603 --- loss: 1.672199, loss_ss: 0.883443, loss_d: 0.788756
0.4987 --- loss: 1.970103, loss_ss: 1.052304, loss_d: 0.917799
0.5370 --- loss: 1.743018, loss_ss: 0.968443, loss_d: 0.774575
0.5754 --- loss: 1.299099, loss_ss: 0.804365, loss_d: 0.494734
0.6137 --- loss: 1.350753, loss_ss: 0.937103, loss_d: 0.413649
0.6521 --- loss: 1.082864, loss_ss: 0.759679, loss_d: 0.323185
0.6904 --- loss: 1.464786, loss_ss: 1.183852, loss_d: 0.280934
0.7288 --- loss: 1.380405, loss_ss: 0.843918, loss_d: 0.536487
0.7672 --- loss: 1.220119, loss_ss: 0.828003, loss_d: 0.392116
0.8055 --- loss: 1.453707, loss_ss: 1.068425, loss_d: 0.385282
0.8439 --- loss: 1.395207, loss_ss: 0.836510, loss_d: 0.558697
0.8822 --- loss: 1.523042, loss_ss: 0.922242, loss_d: 0.600800
0.9206 --- loss: 1.225035, loss_ss: 0.859677, loss_d: 0.365358
0.9590 --- loss: 1.307544, loss_ss: 0.829321, loss_d: 0.478223
0.9973 --- loss: 0.888716, loss_ss: 0.741190, loss_d: 0.147526
Epoch finished! Loss: 1.4202451673837808
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.352371, loss_ss: 1.095853, loss_d: 0.256517
0.0384 --- loss: 0.995616, loss_ss: 0.823507, loss_d: 0.172109
0.0767 --- loss: 1.399461, loss_ss: 0.984313, loss_d: 0.415147
0.1151 --- loss: 1.576871, loss_ss: 1.023841, loss_d: 0.553031
0.1534 --- loss: 1.653600, loss_ss: 0.992111, loss_d: 0.661489
0.1918 --- loss: 1.240040, loss_ss: 0.615004, loss_d: 0.625035
0.2301 --- loss: 1.645065, loss_ss: 0.950880, loss_d: 0.694185
0.2685 --- loss: 1.307866, loss_ss: 0.992065, loss_d: 0.315801
0.3069 --- loss: 1.275911, loss_ss: 0.670743, loss_d: 0.605168
0.3452 --- loss: 1.299098, loss_ss: 1.054356, loss_d: 0.244742
0.3836 --- loss: 0.876565, loss_ss: 0.537313, loss_d: 0.339252
0.4219 --- loss: 1.317810, loss_ss: 0.962452, loss_d: 0.355358
0.4603 --- loss: 1.491106, loss_ss: 0.993831, loss_d: 0.497276
0.4987 --- loss: 1.062080, loss_ss: 0.782423, loss_d: 0.279657
0.5370 --- loss: 1.261873, loss_ss: 0.826700, loss_d: 0.435173
0.5754 --- loss: 1.069032, loss_ss: 0.799952, loss_d: 0.269079
0.6137 --- loss: 1.232494, loss_ss: 0.756404, loss_d: 0.476090
0.6521 --- loss: 0.926948, loss_ss: 0.679370, loss_d: 0.247578
0.6904 --- loss: 1.608573, loss_ss: 0.989547, loss_d: 0.619027
0.7288 --- loss: 1.901474, loss_ss: 1.209517, loss_d: 0.691956
0.7672 --- loss: 1.227502, loss_ss: 0.826562, loss_d: 0.400940
0.8055 --- loss: 1.268955, loss_ss: 0.997073, loss_d: 0.271882
0.8439 --- loss: 0.970068, loss_ss: 0.765597, loss_d: 0.204471
0.8822 --- loss: 1.238335, loss_ss: 0.960157, loss_d: 0.278178
0.9206 --- loss: 1.273662, loss_ss: 0.826291, loss_d: 0.447371
0.9590 --- loss: 1.160321, loss_ss: 0.702036, loss_d: 0.458285
0.9973 --- loss: 1.224817, loss_ss: 0.803173, loss_d: 0.421644
Epoch finished! Loss: 1.3304711603201353
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.951946, loss_ss: 0.728512, loss_d: 0.223433
0.0384 --- loss: 1.778626, loss_ss: 0.935084, loss_d: 0.843542
0.0767 --- loss: 1.175104, loss_ss: 0.766671, loss_d: 0.408433
0.1151 --- loss: 1.495898, loss_ss: 1.019060, loss_d: 0.476838
0.1534 --- loss: 0.962258, loss_ss: 0.760755, loss_d: 0.201503
0.1918 --- loss: 0.933385, loss_ss: 0.776973, loss_d: 0.156412
0.2301 --- loss: 1.638392, loss_ss: 1.170617, loss_d: 0.467775
0.2685 --- loss: 1.251176, loss_ss: 0.872868, loss_d: 0.378309
0.3069 --- loss: 1.122099, loss_ss: 0.838153, loss_d: 0.283946
0.3452 --- loss: 1.216794, loss_ss: 1.000579, loss_d: 0.216215
0.3836 --- loss: 1.190077, loss_ss: 0.811188, loss_d: 0.378889
0.4219 --- loss: 1.291559, loss_ss: 0.771647, loss_d: 0.519911
0.4603 --- loss: 0.915008, loss_ss: 0.730463, loss_d: 0.184544
0.4987 --- loss: 1.219587, loss_ss: 0.921054, loss_d: 0.298533
0.5370 --- loss: 1.502298, loss_ss: 0.778568, loss_d: 0.723730
0.5754 --- loss: 1.104748, loss_ss: 0.905672, loss_d: 0.199076
0.6137 --- loss: 1.146638, loss_ss: 0.990845, loss_d: 0.155793
0.6521 --- loss: 1.392584, loss_ss: 0.930495, loss_d: 0.462089
0.6904 --- loss: 1.157229, loss_ss: 0.915004, loss_d: 0.242225
0.7288 --- loss: 1.246569, loss_ss: 0.807361, loss_d: 0.439208
0.7672 --- loss: 1.242010, loss_ss: 0.817917, loss_d: 0.424093
0.8055 --- loss: 1.266394, loss_ss: 0.984859, loss_d: 0.281535
0.8439 --- loss: 0.840285, loss_ss: 0.538388, loss_d: 0.301897
0.8822 --- loss: 1.100625, loss_ss: 0.748680, loss_d: 0.351945
0.9206 --- loss: 1.597869, loss_ss: 1.012640, loss_d: 0.585228
0.9590 --- loss: 1.428324, loss_ss: 0.869349, loss_d: 0.558975
0.9973 --- loss: 1.027953, loss_ss: 0.705439, loss_d: 0.322513
Epoch finished! Loss: 1.244324059669788
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.008060, loss_ss: 0.641886, loss_d: 0.366174
0.0384 --- loss: 1.174309, loss_ss: 0.746084, loss_d: 0.428225
0.0767 --- loss: 1.706480, loss_ss: 1.073930, loss_d: 0.632550
0.1151 --- loss: 1.334279, loss_ss: 0.851204, loss_d: 0.483075
0.1534 --- loss: 1.289447, loss_ss: 1.033419, loss_d: 0.256027
0.1918 --- loss: 1.170716, loss_ss: 0.775261, loss_d: 0.395455
0.2301 --- loss: 1.395748, loss_ss: 1.152576, loss_d: 0.243172
0.2685 --- loss: 1.290488, loss_ss: 0.761651, loss_d: 0.528836
0.3069 --- loss: 1.437080, loss_ss: 1.013526, loss_d: 0.423555
0.3452 --- loss: 0.871966, loss_ss: 0.722797, loss_d: 0.149170
0.3836 --- loss: 1.317808, loss_ss: 1.082064, loss_d: 0.235744
0.4219 --- loss: 1.220824, loss_ss: 0.703193, loss_d: 0.517631
0.4603 --- loss: 1.490494, loss_ss: 0.842430, loss_d: 0.648064
0.4987 --- loss: 1.212809, loss_ss: 0.940720, loss_d: 0.272089
0.5370 --- loss: 1.362669, loss_ss: 1.011746, loss_d: 0.350923
0.5754 --- loss: 1.227936, loss_ss: 0.723167, loss_d: 0.504769
0.6137 --- loss: 0.951245, loss_ss: 0.615805, loss_d: 0.335441
0.6521 --- loss: 1.148188, loss_ss: 0.844387, loss_d: 0.303801
0.6904 --- loss: 1.158160, loss_ss: 1.009109, loss_d: 0.149051
0.7288 --- loss: 1.233774, loss_ss: 0.819239, loss_d: 0.414534
0.7672 --- loss: 1.130814, loss_ss: 0.965881, loss_d: 0.164933
0.8055 --- loss: 0.714436, loss_ss: 0.587049, loss_d: 0.127387
0.8439 --- loss: 1.102509, loss_ss: 0.756151, loss_d: 0.346359
0.8822 --- loss: 1.180450, loss_ss: 0.640050, loss_d: 0.540400
0.9206 --- loss: 1.295407, loss_ss: 1.090990, loss_d: 0.204417
0.9590 --- loss: 0.897938, loss_ss: 0.710815, loss_d: 0.187123
0.9973 --- loss: 0.802472, loss_ss: 0.690090, loss_d: 0.112382
Epoch finished! Loss: 1.2070967259315344
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7827956989247312
             precision    recall  f1-score   support

        0.0       0.40      0.98      0.57        41
        1.0       0.00      0.00      0.00        33
        2.0       0.81      0.87      0.84       530
        3.0       0.94      0.61      0.74       236
        4.0       0.76      0.93      0.84        90

avg / total       0.79      0.78      0.77       930
 


====== chc005-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  93.55  97.56   93.36  40.40     57.14
1  96.45   0.00  100.00   0.00      0.00
2  80.97  86.79   73.25  81.13     83.87
3  89.03  61.02   98.56  93.51     73.85
4  96.56  93.33   96.90  76.36     84.00
Total accuracy: 78.28%
Average sen: 67.74%
Average spec: 92.42%
Macro f1-score: 59.77%
[0.50692844 0.0638456  0.10455544 0.31221125 0.15630791 0.11308806
 0.09501836 0.11705907 0.09666919 0.05583759 0.07619175 0.1249074
 0.17412139 0.14870311 0.13861175 0.10717914 0.1186894  0.10390314
 0.2249926  0.10856859 0.12051642 0.23488759 0.26297241 0.12470762
 0.03351197 0.10372494 0.23320003 0.05320503 0.19493704 0.16721903
 0.08571038]
pred: 0.1471606986897607, label: 0
Right! Diagnosis: Other

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.313523, loss_ss: 1.567073, loss_d: 0.746450
0.0383 --- loss: 2.283231, loss_ss: 1.396431, loss_d: 0.886800
0.0766 --- loss: 2.148341, loss_ss: 1.451893, loss_d: 0.696448
0.1149 --- loss: 1.788110, loss_ss: 1.214033, loss_d: 0.574077
0.1532 --- loss: 1.587328, loss_ss: 1.306803, loss_d: 0.280525
0.1915 --- loss: 1.821064, loss_ss: 1.432340, loss_d: 0.388724
0.2298 --- loss: 1.639578, loss_ss: 1.195736, loss_d: 0.443843
0.2681 --- loss: 1.745082, loss_ss: 1.312678, loss_d: 0.432405
0.3064 --- loss: 1.745568, loss_ss: 1.165967, loss_d: 0.579601
0.3447 --- loss: 1.843863, loss_ss: 1.239223, loss_d: 0.604640
0.3830 --- loss: 1.657039, loss_ss: 1.133041, loss_d: 0.523998
0.4213 --- loss: 2.096949, loss_ss: 1.226624, loss_d: 0.870325
0.4596 --- loss: 2.041915, loss_ss: 1.500080, loss_d: 0.541835
0.4979 --- loss: 1.690534, loss_ss: 1.071347, loss_d: 0.619187
0.5362 --- loss: 2.045606, loss_ss: 1.258794, loss_d: 0.786811
0.5745 --- loss: 1.696264, loss_ss: 1.245054, loss_d: 0.451210
0.6128 --- loss: 1.788465, loss_ss: 1.116373, loss_d: 0.672092
0.6511 --- loss: 1.833435, loss_ss: 1.188683, loss_d: 0.644751
0.6894 --- loss: 1.563865, loss_ss: 1.055474, loss_d: 0.508391
0.7277 --- loss: 1.967107, loss_ss: 1.185680, loss_d: 0.781427
0.7660 --- loss: 1.503651, loss_ss: 1.091962, loss_d: 0.411689
0.8043 --- loss: 1.313711, loss_ss: 0.907871, loss_d: 0.405840
0.8426 --- loss: 1.772400, loss_ss: 1.260995, loss_d: 0.511406
0.8809 --- loss: 1.742148, loss_ss: 1.092756, loss_d: 0.649392
0.9192 --- loss: 1.836128, loss_ss: 1.119270, loss_d: 0.716858
0.9575 --- loss: 1.788294, loss_ss: 1.157530, loss_d: 0.630764
0.9958 --- loss: 2.055492, loss_ss: 1.286254, loss_d: 0.769239
Epoch finished! Loss: 1.8259322186539457
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.530493, loss_ss: 0.918898, loss_d: 0.611595
0.0383 --- loss: 1.406526, loss_ss: 0.854517, loss_d: 0.552009
0.0766 --- loss: 1.619400, loss_ss: 0.954011, loss_d: 0.665389
0.1149 --- loss: 1.279580, loss_ss: 0.983795, loss_d: 0.295785
0.1532 --- loss: 1.685056, loss_ss: 0.974986, loss_d: 0.710070
0.1915 --- loss: 1.432106, loss_ss: 0.900555, loss_d: 0.531551
0.2298 --- loss: 1.700833, loss_ss: 0.995179, loss_d: 0.705655
0.2681 --- loss: 1.642724, loss_ss: 1.109094, loss_d: 0.533630
0.3064 --- loss: 1.512425, loss_ss: 0.959690, loss_d: 0.552735
0.3447 --- loss: 1.824267, loss_ss: 1.072387, loss_d: 0.751880
0.3830 --- loss: 1.313045, loss_ss: 0.939154, loss_d: 0.373891
0.4213 --- loss: 1.547336, loss_ss: 0.890289, loss_d: 0.657047
0.4596 --- loss: 1.536529, loss_ss: 1.046845, loss_d: 0.489684
0.4979 --- loss: 2.017709, loss_ss: 1.177175, loss_d: 0.840533
0.5362 --- loss: 1.479791, loss_ss: 0.987723, loss_d: 0.492069
0.5745 --- loss: 1.381381, loss_ss: 1.090242, loss_d: 0.291139
0.6128 --- loss: 1.660560, loss_ss: 1.035325, loss_d: 0.625235
0.6511 --- loss: 2.018319, loss_ss: 1.397048, loss_d: 0.621271
0.6894 --- loss: 1.861577, loss_ss: 1.163444, loss_d: 0.698133
0.7277 --- loss: 1.642235, loss_ss: 1.097122, loss_d: 0.545113
0.7660 --- loss: 1.376569, loss_ss: 1.026673, loss_d: 0.349897
0.8043 --- loss: 1.342052, loss_ss: 0.802803, loss_d: 0.539249
0.8426 --- loss: 1.330563, loss_ss: 0.825510, loss_d: 0.505053
0.8809 --- loss: 1.228440, loss_ss: 0.962933, loss_d: 0.265507
0.9192 --- loss: 1.353611, loss_ss: 1.034150, loss_d: 0.319461
0.9575 --- loss: 1.469169, loss_ss: 1.032788, loss_d: 0.436381
0.9958 --- loss: 1.638965, loss_ss: 0.860018, loss_d: 0.778947
Epoch finished! Loss: 1.642458210046264
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.482380, loss_ss: 0.861674, loss_d: 0.620705
0.0383 --- loss: 1.622868, loss_ss: 1.075854, loss_d: 0.547014
0.0766 --- loss: 1.455707, loss_ss: 1.052773, loss_d: 0.402933
0.1149 --- loss: 1.654279, loss_ss: 1.068827, loss_d: 0.585452
0.1532 --- loss: 1.675414, loss_ss: 0.800459, loss_d: 0.874954
0.1915 --- loss: 1.564507, loss_ss: 1.018773, loss_d: 0.545734
0.2298 --- loss: 1.758613, loss_ss: 1.038759, loss_d: 0.719854
0.2681 --- loss: 1.479321, loss_ss: 0.939934, loss_d: 0.539386
0.3064 --- loss: 1.425371, loss_ss: 0.883599, loss_d: 0.541772
0.3447 --- loss: 1.875344, loss_ss: 1.305346, loss_d: 0.569998
0.3830 --- loss: 1.656946, loss_ss: 0.908800, loss_d: 0.748146
0.4213 --- loss: 1.501415, loss_ss: 1.104804, loss_d: 0.396611
0.4596 --- loss: 1.735425, loss_ss: 1.085545, loss_d: 0.649880
0.4979 --- loss: 1.276105, loss_ss: 0.906547, loss_d: 0.369558
0.5362 --- loss: 1.402349, loss_ss: 0.787063, loss_d: 0.615286
0.5745 --- loss: 1.455546, loss_ss: 0.716874, loss_d: 0.738672
0.6128 --- loss: 1.323748, loss_ss: 0.794648, loss_d: 0.529100
0.6511 --- loss: 1.608437, loss_ss: 0.986048, loss_d: 0.622390
0.6894 --- loss: 1.310284, loss_ss: 0.734684, loss_d: 0.575600
0.7277 --- loss: 2.074989, loss_ss: 1.458248, loss_d: 0.616741
0.7660 --- loss: 1.452824, loss_ss: 0.864822, loss_d: 0.588002
0.8043 --- loss: 1.802794, loss_ss: 1.055493, loss_d: 0.747301
0.8426 --- loss: 1.574140, loss_ss: 0.921001, loss_d: 0.653139
0.8809 --- loss: 1.243862, loss_ss: 0.846057, loss_d: 0.397805
0.9192 --- loss: 1.724094, loss_ss: 1.034452, loss_d: 0.689642
0.9575 --- loss: 1.475169, loss_ss: 0.860107, loss_d: 0.615062
0.9958 --- loss: 1.236590, loss_ss: 0.839815, loss_d: 0.396775
Epoch finished! Loss: 1.5910543303836808
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.380568, loss_ss: 1.028023, loss_d: 0.352545
0.0383 --- loss: 1.629346, loss_ss: 0.983765, loss_d: 0.645581
0.0766 --- loss: 1.256309, loss_ss: 0.920734, loss_d: 0.335575
0.1149 --- loss: 1.730733, loss_ss: 0.915715, loss_d: 0.815018
0.1532 --- loss: 1.094694, loss_ss: 0.680382, loss_d: 0.414311
0.1915 --- loss: 1.298783, loss_ss: 0.737067, loss_d: 0.561717
0.2298 --- loss: 1.782297, loss_ss: 1.157039, loss_d: 0.625258
0.2681 --- loss: 1.791032, loss_ss: 1.401119, loss_d: 0.389913
0.3064 --- loss: 1.634375, loss_ss: 1.027806, loss_d: 0.606569
0.3447 --- loss: 1.488286, loss_ss: 0.946697, loss_d: 0.541589
0.3830 --- loss: 1.438353, loss_ss: 0.900405, loss_d: 0.537948
0.4213 --- loss: 1.228845, loss_ss: 0.829755, loss_d: 0.399090
0.4596 --- loss: 1.234401, loss_ss: 0.822635, loss_d: 0.411766
0.4979 --- loss: 1.542831, loss_ss: 0.985466, loss_d: 0.557365
0.5362 --- loss: 1.673287, loss_ss: 1.176403, loss_d: 0.496884
0.5745 --- loss: 1.338652, loss_ss: 0.750695, loss_d: 0.587958
0.6128 --- loss: 1.120837, loss_ss: 0.762107, loss_d: 0.358730
0.6511 --- loss: 1.680682, loss_ss: 1.087525, loss_d: 0.593157
0.6894 --- loss: 1.733787, loss_ss: 1.118107, loss_d: 0.615680
0.7277 --- loss: 1.374668, loss_ss: 0.960581, loss_d: 0.414088
0.7660 --- loss: 1.939129, loss_ss: 1.240203, loss_d: 0.698926
0.8043 --- loss: 1.780300, loss_ss: 1.006254, loss_d: 0.774046
0.8426 --- loss: 1.743587, loss_ss: 1.080413, loss_d: 0.663174
0.8809 --- loss: 1.413054, loss_ss: 0.774742, loss_d: 0.638312
0.9192 --- loss: 1.305294, loss_ss: 0.749714, loss_d: 0.555580
0.9575 --- loss: 1.514915, loss_ss: 0.776019, loss_d: 0.738896
0.9958 --- loss: 1.617726, loss_ss: 1.150129, loss_d: 0.467597
Epoch finished! Loss: 1.5288545400246807
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.498710, loss_ss: 0.824233, loss_d: 0.674477
0.0383 --- loss: 1.845924, loss_ss: 1.084675, loss_d: 0.761249
0.0766 --- loss: 1.359350, loss_ss: 0.931618, loss_d: 0.427733
0.1149 --- loss: 1.328555, loss_ss: 0.683320, loss_d: 0.645235
0.1532 --- loss: 1.451173, loss_ss: 0.923302, loss_d: 0.527871
0.1915 --- loss: 1.428428, loss_ss: 0.927939, loss_d: 0.500489
0.2298 --- loss: 1.495505, loss_ss: 1.153431, loss_d: 0.342074
0.2681 --- loss: 1.247338, loss_ss: 0.907189, loss_d: 0.340149
0.3064 --- loss: 1.337231, loss_ss: 0.619227, loss_d: 0.718003
0.3447 --- loss: 1.423141, loss_ss: 0.708678, loss_d: 0.714464
0.3830 --- loss: 1.477005, loss_ss: 0.881542, loss_d: 0.595463
0.4213 --- loss: 1.531171, loss_ss: 0.851567, loss_d: 0.679604
0.4596 --- loss: 1.546955, loss_ss: 1.082758, loss_d: 0.464197
0.4979 --- loss: 1.564133, loss_ss: 1.075117, loss_d: 0.489016
0.5362 --- loss: 2.396553, loss_ss: 1.621286, loss_d: 0.775267
0.5745 --- loss: 1.575027, loss_ss: 1.044757, loss_d: 0.530271
0.6128 --- loss: 1.477840, loss_ss: 0.743171, loss_d: 0.734670
0.6511 --- loss: 1.430285, loss_ss: 0.762308, loss_d: 0.667977
0.6894 --- loss: 1.466881, loss_ss: 0.885066, loss_d: 0.581815
0.7277 --- loss: 1.394110, loss_ss: 0.617841, loss_d: 0.776269
0.7660 --- loss: 1.443137, loss_ss: 0.994094, loss_d: 0.449043
0.8043 --- loss: 1.550304, loss_ss: 0.814332, loss_d: 0.735972
0.8426 --- loss: 1.555362, loss_ss: 1.104234, loss_d: 0.451128
0.8809 --- loss: 1.496654, loss_ss: 0.939901, loss_d: 0.556753
0.9192 --- loss: 1.600911, loss_ss: 0.957548, loss_d: 0.643364
0.9575 --- loss: 1.476280, loss_ss: 0.901963, loss_d: 0.574317
0.9958 --- loss: 2.082624, loss_ss: 1.465167, loss_d: 0.617457
Epoch finished! Loss: 1.5117846295751374
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.158332, loss_ss: 0.735620, loss_d: 0.422712
0.0383 --- loss: 1.637505, loss_ss: 0.857546, loss_d: 0.779959
0.0766 --- loss: 1.338971, loss_ss: 0.910649, loss_d: 0.428321
0.1149 --- loss: 1.507154, loss_ss: 1.014016, loss_d: 0.493138
0.1532 --- loss: 1.321964, loss_ss: 0.831783, loss_d: 0.490181
0.1915 --- loss: 1.659680, loss_ss: 1.089359, loss_d: 0.570322
0.2298 --- loss: 1.273362, loss_ss: 0.949020, loss_d: 0.324342
0.2681 --- loss: 1.253975, loss_ss: 0.788008, loss_d: 0.465967
0.3064 --- loss: 1.518412, loss_ss: 0.962394, loss_d: 0.556018
0.3447 --- loss: 1.495760, loss_ss: 0.900854, loss_d: 0.594906
0.3830 --- loss: 1.232128, loss_ss: 0.816284, loss_d: 0.415843
0.4213 --- loss: 1.111984, loss_ss: 0.723731, loss_d: 0.388253
0.4596 --- loss: 1.712102, loss_ss: 1.000307, loss_d: 0.711795
0.4979 --- loss: 1.360703, loss_ss: 0.893992, loss_d: 0.466711
0.5362 --- loss: 1.502357, loss_ss: 1.088463, loss_d: 0.413894
0.5745 --- loss: 1.507086, loss_ss: 0.968919, loss_d: 0.538167
0.6128 --- loss: 1.343607, loss_ss: 0.897493, loss_d: 0.446114
0.6511 --- loss: 1.263295, loss_ss: 0.831921, loss_d: 0.431374
0.6894 --- loss: 1.382528, loss_ss: 0.907671, loss_d: 0.474857
0.7277 --- loss: 2.078979, loss_ss: 1.402752, loss_d: 0.676227
0.7660 --- loss: 1.186803, loss_ss: 0.769123, loss_d: 0.417680
0.8043 --- loss: 1.801405, loss_ss: 1.064295, loss_d: 0.737110
0.8426 --- loss: 1.446705, loss_ss: 0.817893, loss_d: 0.628812
0.8809 --- loss: 1.318338, loss_ss: 0.871793, loss_d: 0.446544
0.9192 --- loss: 1.802737, loss_ss: 0.944762, loss_d: 0.857976
0.9575 --- loss: 1.403720, loss_ss: 0.892133, loss_d: 0.511587
0.9958 --- loss: 1.346048, loss_ss: 0.845158, loss_d: 0.500890
Epoch finished! Loss: 1.4818648949436757
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.386231, loss_ss: 0.926792, loss_d: 0.459439
0.0383 --- loss: 1.092007, loss_ss: 0.834940, loss_d: 0.257067
0.0766 --- loss: 1.553307, loss_ss: 0.992467, loss_d: 0.560840
0.1149 --- loss: 1.287616, loss_ss: 0.651445, loss_d: 0.636171
0.1532 --- loss: 1.273449, loss_ss: 0.683142, loss_d: 0.590307
0.1915 --- loss: 1.693042, loss_ss: 1.068698, loss_d: 0.624344
0.2298 --- loss: 1.174203, loss_ss: 0.705986, loss_d: 0.468217
0.2681 --- loss: 1.384997, loss_ss: 0.890215, loss_d: 0.494782
0.3064 --- loss: 1.690427, loss_ss: 0.850860, loss_d: 0.839566
0.3447 --- loss: 1.267653, loss_ss: 0.724879, loss_d: 0.542774
0.3830 --- loss: 1.363980, loss_ss: 1.014409, loss_d: 0.349571
0.4213 --- loss: 1.632297, loss_ss: 0.979574, loss_d: 0.652723
0.4596 --- loss: 1.442777, loss_ss: 0.994243, loss_d: 0.448534
0.4979 --- loss: 1.421665, loss_ss: 0.971291, loss_d: 0.450374
0.5362 --- loss: 1.519141, loss_ss: 0.894415, loss_d: 0.624726
0.5745 --- loss: 1.176747, loss_ss: 0.837134, loss_d: 0.339613
0.6128 --- loss: 1.634273, loss_ss: 1.217165, loss_d: 0.417108
0.6511 --- loss: 1.257627, loss_ss: 0.868142, loss_d: 0.389485
0.6894 --- loss: 1.252488, loss_ss: 0.764309, loss_d: 0.488178
0.7277 --- loss: 1.162072, loss_ss: 0.872714, loss_d: 0.289358
0.7660 --- loss: 1.602994, loss_ss: 0.857457, loss_d: 0.745537
0.8043 --- loss: 1.547168, loss_ss: 0.923056, loss_d: 0.624113
0.8426 --- loss: 1.234479, loss_ss: 0.868924, loss_d: 0.365555
0.8809 --- loss: 0.937272, loss_ss: 0.509771, loss_d: 0.427501
0.9192 --- loss: 1.274843, loss_ss: 0.845241, loss_d: 0.429602
0.9575 --- loss: 1.522143, loss_ss: 1.103119, loss_d: 0.419024
0.9958 --- loss: 1.446407, loss_ss: 1.086860, loss_d: 0.359546
Epoch finished! Loss: 1.4507211974297447
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.970281, loss_ss: 1.143482, loss_d: 0.826798
0.0383 --- loss: 1.302122, loss_ss: 0.954662, loss_d: 0.347460
0.0766 --- loss: 1.550185, loss_ss: 1.180587, loss_d: 0.369597
0.1149 --- loss: 1.282096, loss_ss: 1.022122, loss_d: 0.259974
0.1532 --- loss: 1.366100, loss_ss: 1.013289, loss_d: 0.352811
0.1915 --- loss: 1.068166, loss_ss: 0.730155, loss_d: 0.338011
0.2298 --- loss: 1.180154, loss_ss: 0.700999, loss_d: 0.479156
0.2681 --- loss: 1.659325, loss_ss: 1.107559, loss_d: 0.551766
0.3064 --- loss: 0.841326, loss_ss: 0.588605, loss_d: 0.252720
0.3447 --- loss: 1.271438, loss_ss: 0.920778, loss_d: 0.350661
0.3830 --- loss: 1.038112, loss_ss: 0.617873, loss_d: 0.420239
0.4213 --- loss: 1.639647, loss_ss: 1.136236, loss_d: 0.503411
0.4596 --- loss: 1.150097, loss_ss: 0.864101, loss_d: 0.285997
0.4979 --- loss: 1.504463, loss_ss: 1.174246, loss_d: 0.330217
0.5362 --- loss: 1.784301, loss_ss: 0.977897, loss_d: 0.806404
0.5745 --- loss: 1.101447, loss_ss: 0.644656, loss_d: 0.456791
0.6128 --- loss: 1.455498, loss_ss: 0.918000, loss_d: 0.537498
0.6511 --- loss: 1.274209, loss_ss: 0.809559, loss_d: 0.464649
0.6894 --- loss: 0.934086, loss_ss: 0.542309, loss_d: 0.391777
0.7277 --- loss: 1.002722, loss_ss: 0.734652, loss_d: 0.268070
0.7660 --- loss: 1.395049, loss_ss: 0.913950, loss_d: 0.481099
0.8043 --- loss: 1.341441, loss_ss: 0.928539, loss_d: 0.412902
0.8426 --- loss: 1.280149, loss_ss: 1.046215, loss_d: 0.233934
0.8809 --- loss: 1.136798, loss_ss: 0.882471, loss_d: 0.254327
0.9192 --- loss: 1.436721, loss_ss: 1.027631, loss_d: 0.409090
0.9575 --- loss: 1.270136, loss_ss: 0.844890, loss_d: 0.425246
0.9958 --- loss: 1.198128, loss_ss: 0.823479, loss_d: 0.374649
Epoch finished! Loss: 1.360308331776396
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.255300, loss_ss: 0.870975, loss_d: 0.384325
0.0383 --- loss: 1.460889, loss_ss: 0.864004, loss_d: 0.596885
0.0766 --- loss: 1.369233, loss_ss: 0.954571, loss_d: 0.414663
0.1149 --- loss: 1.709358, loss_ss: 0.825688, loss_d: 0.883670
0.1532 --- loss: 1.109230, loss_ss: 0.937606, loss_d: 0.171624
0.1915 --- loss: 1.271748, loss_ss: 1.041034, loss_d: 0.230714
0.2298 --- loss: 1.605687, loss_ss: 1.207053, loss_d: 0.398635
0.2681 --- loss: 1.064499, loss_ss: 0.876834, loss_d: 0.187665
0.3064 --- loss: 0.960149, loss_ss: 0.642317, loss_d: 0.317833
0.3447 --- loss: 1.305556, loss_ss: 0.965393, loss_d: 0.340162
0.3830 --- loss: 1.391538, loss_ss: 1.155002, loss_d: 0.236537
0.4213 --- loss: 1.310377, loss_ss: 0.972653, loss_d: 0.337723
0.4596 --- loss: 1.163365, loss_ss: 0.935053, loss_d: 0.228313
0.4979 --- loss: 1.434768, loss_ss: 0.915816, loss_d: 0.518952
0.5362 --- loss: 0.844306, loss_ss: 0.671887, loss_d: 0.172418
0.5745 --- loss: 1.041180, loss_ss: 0.858544, loss_d: 0.182636
0.6128 --- loss: 1.244625, loss_ss: 0.702005, loss_d: 0.542621
0.6511 --- loss: 1.846323, loss_ss: 0.859659, loss_d: 0.986664
0.6894 --- loss: 0.927716, loss_ss: 0.665756, loss_d: 0.261960
0.7277 --- loss: 0.970678, loss_ss: 0.663690, loss_d: 0.306988
0.7660 --- loss: 0.984307, loss_ss: 0.594052, loss_d: 0.390254
0.8043 --- loss: 1.214525, loss_ss: 1.009025, loss_d: 0.205500
0.8426 --- loss: 1.237810, loss_ss: 1.016309, loss_d: 0.221501
0.8809 --- loss: 1.032065, loss_ss: 0.757177, loss_d: 0.274888
0.9192 --- loss: 0.896713, loss_ss: 0.633673, loss_d: 0.263040
0.9575 --- loss: 1.335744, loss_ss: 0.733063, loss_d: 0.602681
0.9958 --- loss: 1.281658, loss_ss: 1.043473, loss_d: 0.238185
Epoch finished! Loss: 1.223716694504822
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.181309, loss_ss: 0.825089, loss_d: 0.356219
0.0383 --- loss: 1.321574, loss_ss: 1.183301, loss_d: 0.138273
0.0766 --- loss: 1.104688, loss_ss: 0.814307, loss_d: 0.290381
0.1149 --- loss: 1.032000, loss_ss: 0.678468, loss_d: 0.353532
0.1532 --- loss: 1.110252, loss_ss: 0.833961, loss_d: 0.276292
0.1915 --- loss: 1.048503, loss_ss: 0.869583, loss_d: 0.178921
0.2298 --- loss: 1.613122, loss_ss: 1.062220, loss_d: 0.550902
0.2681 --- loss: 1.182233, loss_ss: 0.572098, loss_d: 0.610136
0.3064 --- loss: 1.195268, loss_ss: 0.916294, loss_d: 0.278974
0.3447 --- loss: 1.203670, loss_ss: 0.839344, loss_d: 0.364326
0.3830 --- loss: 1.192319, loss_ss: 0.874489, loss_d: 0.317830
0.4213 --- loss: 1.320486, loss_ss: 0.815250, loss_d: 0.505237
0.4596 --- loss: 1.028258, loss_ss: 0.915842, loss_d: 0.112416
0.4979 --- loss: 1.150702, loss_ss: 0.997724, loss_d: 0.152979
0.5362 --- loss: 1.620961, loss_ss: 1.391073, loss_d: 0.229889
0.5745 --- loss: 0.948005, loss_ss: 0.706946, loss_d: 0.241060
0.6128 --- loss: 0.898022, loss_ss: 0.687485, loss_d: 0.210537
0.6511 --- loss: 0.972201, loss_ss: 0.822227, loss_d: 0.149974
0.6894 --- loss: 0.938065, loss_ss: 0.828475, loss_d: 0.109590
0.7277 --- loss: 0.814283, loss_ss: 0.533786, loss_d: 0.280497
0.7660 --- loss: 1.415698, loss_ss: 0.814244, loss_d: 0.601454
0.8043 --- loss: 0.921230, loss_ss: 0.734189, loss_d: 0.187041
0.8426 --- loss: 1.307134, loss_ss: 0.731556, loss_d: 0.575578
0.8809 --- loss: 1.010907, loss_ss: 0.789615, loss_d: 0.221292
0.9192 --- loss: 1.227216, loss_ss: 0.960977, loss_d: 0.266239
0.9575 --- loss: 1.095491, loss_ss: 0.612223, loss_d: 0.483269
0.9958 --- loss: 1.637683, loss_ss: 0.842703, loss_d: 0.794980
Epoch finished! Loss: 1.152536562804518
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6024691358024692
             precision    recall  f1-score   support

        0.0       0.87      0.43      0.58       158
        1.0       0.55      0.12      0.19       103
        2.0       0.67      0.73      0.70       306
        3.0       0.99      0.78      0.87       133
        4.0       0.29      0.73      0.42       110

avg / total       0.70      0.60      0.60       810
 


====== chc006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.65  43.04   98.47  87.18     57.63
1  87.53  11.65   98.59  54.55     19.20
2  76.54  73.20   78.57  67.47     70.22
3  96.30  78.20   99.85  99.05     87.39
4  72.47  72.73   72.43  29.30     41.78
Total accuracy: 60.25%
Average sen: 55.76%
Average spec: 89.58%
Macro f1-score: 55.24%
[0.99925071 0.99851209 0.99641389 0.99377787 0.99823594 0.99362832
 0.97372967 0.99486428 0.99641979 0.99914837 0.99874496 0.99363226
 0.99247932 0.99690276 0.99684995 0.99825019 0.99436873 0.92163515
 0.98387283 0.98362148 0.97445077 0.99596655 0.99897861 0.99851233
 0.99256468 0.98338705 0.99528497]
pred: 0.990499390496148, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.248692, loss_ss: 1.598696, loss_d: 0.649995
0.0384 --- loss: 2.369043, loss_ss: 1.661718, loss_d: 0.707325
0.0767 --- loss: 2.286111, loss_ss: 1.632752, loss_d: 0.653360
0.1151 --- loss: 2.379812, loss_ss: 1.656729, loss_d: 0.723083
0.1535 --- loss: 2.114240, loss_ss: 1.623470, loss_d: 0.490770
0.1919 --- loss: 2.270171, loss_ss: 1.515153, loss_d: 0.755018
0.2302 --- loss: 1.926762, loss_ss: 1.318940, loss_d: 0.607822
0.2686 --- loss: 2.071284, loss_ss: 1.433145, loss_d: 0.638139
0.3070 --- loss: 1.594937, loss_ss: 1.265308, loss_d: 0.329629
0.3454 --- loss: 2.297319, loss_ss: 1.278804, loss_d: 1.018515
0.3837 --- loss: 1.914041, loss_ss: 1.268661, loss_d: 0.645380
0.4221 --- loss: 2.051826, loss_ss: 1.455703, loss_d: 0.596123
0.4605 --- loss: 1.923952, loss_ss: 1.419547, loss_d: 0.504406
0.4988 --- loss: 2.008402, loss_ss: 1.173183, loss_d: 0.835219
0.5372 --- loss: 1.836797, loss_ss: 1.396518, loss_d: 0.440279
0.5756 --- loss: 1.709351, loss_ss: 1.306134, loss_d: 0.403217
0.6140 --- loss: 1.988960, loss_ss: 1.315461, loss_d: 0.673498
0.6523 --- loss: 1.885373, loss_ss: 1.208681, loss_d: 0.676691
0.6907 --- loss: 1.649598, loss_ss: 1.301185, loss_d: 0.348413
0.7291 --- loss: 1.723395, loss_ss: 1.343118, loss_d: 0.380277
0.7675 --- loss: 2.009031, loss_ss: 1.293054, loss_d: 0.715977
0.8058 --- loss: 1.906947, loss_ss: 1.119332, loss_d: 0.787615
0.8442 --- loss: 1.464232, loss_ss: 1.036889, loss_d: 0.427343
0.8826 --- loss: 1.474470, loss_ss: 1.208131, loss_d: 0.266339
0.9210 --- loss: 2.100951, loss_ss: 1.374963, loss_d: 0.725988
0.9593 --- loss: 1.666738, loss_ss: 1.256726, loss_d: 0.410012
0.9977 --- loss: 2.673730, loss_ss: 1.269544, loss_d: 1.404186
Epoch finished! Loss: 1.9628966744129475
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.772951, loss_ss: 1.292129, loss_d: 0.480822
0.0384 --- loss: 1.997589, loss_ss: 1.333595, loss_d: 0.663994
0.0767 --- loss: 1.776367, loss_ss: 1.214587, loss_d: 0.561780
0.1151 --- loss: 1.726423, loss_ss: 1.242081, loss_d: 0.484343
0.1535 --- loss: 1.532174, loss_ss: 1.163627, loss_d: 0.368547
0.1919 --- loss: 1.649712, loss_ss: 0.988916, loss_d: 0.660796
0.2302 --- loss: 1.847502, loss_ss: 1.383182, loss_d: 0.464321
0.2686 --- loss: 1.570285, loss_ss: 1.242818, loss_d: 0.327467
0.3070 --- loss: 1.785242, loss_ss: 1.188559, loss_d: 0.596684
0.3454 --- loss: 1.808443, loss_ss: 1.056922, loss_d: 0.751521
0.3837 --- loss: 1.774180, loss_ss: 0.988685, loss_d: 0.785495
0.4221 --- loss: 1.709657, loss_ss: 1.192804, loss_d: 0.516853
0.4605 --- loss: 1.782400, loss_ss: 1.118023, loss_d: 0.664377
0.4988 --- loss: 1.848236, loss_ss: 1.248403, loss_d: 0.599832
0.5372 --- loss: 1.971106, loss_ss: 1.387412, loss_d: 0.583694
0.5756 --- loss: 1.526115, loss_ss: 1.064077, loss_d: 0.462037
0.6140 --- loss: 1.475084, loss_ss: 1.009905, loss_d: 0.465179
0.6523 --- loss: 1.232604, loss_ss: 0.918146, loss_d: 0.314458
0.6907 --- loss: 1.555260, loss_ss: 1.121879, loss_d: 0.433382
0.7291 --- loss: 1.748463, loss_ss: 1.144664, loss_d: 0.603799
0.7675 --- loss: 1.533402, loss_ss: 0.927952, loss_d: 0.605450
0.8058 --- loss: 1.998229, loss_ss: 1.218437, loss_d: 0.779791
0.8442 --- loss: 1.678332, loss_ss: 1.081034, loss_d: 0.597298
0.8826 --- loss: 1.520059, loss_ss: 1.067328, loss_d: 0.452732
0.9210 --- loss: 1.606192, loss_ss: 1.076289, loss_d: 0.529903
0.9593 --- loss: 1.645774, loss_ss: 0.913856, loss_d: 0.731918
0.9977 --- loss: 1.634361, loss_ss: 0.941968, loss_d: 0.692393
Epoch finished! Loss: 1.6835502807910625
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.696766, loss_ss: 1.048220, loss_d: 0.648546
0.0384 --- loss: 1.496039, loss_ss: 0.840400, loss_d: 0.655639
0.0767 --- loss: 1.701097, loss_ss: 1.230810, loss_d: 0.470286
0.1151 --- loss: 1.316660, loss_ss: 0.956977, loss_d: 0.359683
0.1535 --- loss: 1.472175, loss_ss: 1.035936, loss_d: 0.436239
0.1919 --- loss: 1.428066, loss_ss: 0.878592, loss_d: 0.549474
0.2302 --- loss: 1.800399, loss_ss: 1.211905, loss_d: 0.588495
0.2686 --- loss: 1.755111, loss_ss: 1.321601, loss_d: 0.433510
0.3070 --- loss: 1.458564, loss_ss: 0.933954, loss_d: 0.524609
0.3454 --- loss: 1.825875, loss_ss: 1.163123, loss_d: 0.662753
0.3837 --- loss: 1.383167, loss_ss: 0.914746, loss_d: 0.468421
0.4221 --- loss: 1.586236, loss_ss: 0.916936, loss_d: 0.669300
0.4605 --- loss: 1.668418, loss_ss: 1.043841, loss_d: 0.624577
0.4988 --- loss: 1.755045, loss_ss: 1.100108, loss_d: 0.654937
0.5372 --- loss: 1.318637, loss_ss: 0.962370, loss_d: 0.356267
0.5756 --- loss: 1.526389, loss_ss: 1.051060, loss_d: 0.475329
0.6140 --- loss: 1.755228, loss_ss: 0.897979, loss_d: 0.857249
0.6523 --- loss: 1.278905, loss_ss: 0.811239, loss_d: 0.467666
0.6907 --- loss: 1.827518, loss_ss: 1.231905, loss_d: 0.595614
0.7291 --- loss: 1.854047, loss_ss: 0.949166, loss_d: 0.904882
0.7675 --- loss: 1.304342, loss_ss: 0.946109, loss_d: 0.358233
0.8058 --- loss: 1.349329, loss_ss: 0.989580, loss_d: 0.359749
0.8442 --- loss: 1.597511, loss_ss: 1.176054, loss_d: 0.421457
0.8826 --- loss: 1.432849, loss_ss: 0.869321, loss_d: 0.563527
0.9210 --- loss: 1.862001, loss_ss: 1.256119, loss_d: 0.605882
0.9593 --- loss: 1.407368, loss_ss: 0.880401, loss_d: 0.526967
0.9977 --- loss: 1.759319, loss_ss: 1.029364, loss_d: 0.729954
Epoch finished! Loss: 1.5831438408448146
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.393558, loss_ss: 0.728970, loss_d: 0.664588
0.0384 --- loss: 1.561496, loss_ss: 0.739905, loss_d: 0.821591
0.0767 --- loss: 1.612081, loss_ss: 1.041026, loss_d: 0.571056
0.1151 --- loss: 1.271436, loss_ss: 0.755884, loss_d: 0.515553
0.1535 --- loss: 1.679192, loss_ss: 0.900982, loss_d: 0.778210
0.1919 --- loss: 1.426938, loss_ss: 1.016705, loss_d: 0.410232
0.2302 --- loss: 1.557003, loss_ss: 0.983644, loss_d: 0.573360
0.2686 --- loss: 1.361783, loss_ss: 0.936519, loss_d: 0.425264
0.3070 --- loss: 1.468339, loss_ss: 0.983633, loss_d: 0.484706
0.3454 --- loss: 1.321974, loss_ss: 0.956664, loss_d: 0.365310
0.3837 --- loss: 1.500980, loss_ss: 0.739329, loss_d: 0.761651
0.4221 --- loss: 1.742451, loss_ss: 1.062320, loss_d: 0.680131
0.4605 --- loss: 1.240085, loss_ss: 0.862005, loss_d: 0.378080
0.4988 --- loss: 1.346008, loss_ss: 0.884956, loss_d: 0.461052
0.5372 --- loss: 1.541181, loss_ss: 0.872902, loss_d: 0.668279
0.5756 --- loss: 1.447236, loss_ss: 0.989659, loss_d: 0.457578
0.6140 --- loss: 1.527771, loss_ss: 0.814796, loss_d: 0.712975
0.6523 --- loss: 1.705250, loss_ss: 1.328535, loss_d: 0.376714
0.6907 --- loss: 1.358497, loss_ss: 0.879195, loss_d: 0.479301
0.7291 --- loss: 1.541934, loss_ss: 0.912359, loss_d: 0.629575
0.7675 --- loss: 1.451616, loss_ss: 0.934701, loss_d: 0.516915
0.8058 --- loss: 1.586790, loss_ss: 1.312380, loss_d: 0.274410
0.8442 --- loss: 1.319866, loss_ss: 0.998112, loss_d: 0.321754
0.8826 --- loss: 1.356486, loss_ss: 1.000799, loss_d: 0.355687
0.9210 --- loss: 1.429434, loss_ss: 0.946296, loss_d: 0.483138
0.9593 --- loss: 1.422727, loss_ss: 1.027624, loss_d: 0.395103
0.9977 --- loss: 1.272283, loss_ss: 0.950951, loss_d: 0.321332
Epoch finished! Loss: 1.50130941088383
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.494881, loss_ss: 0.922609, loss_d: 0.572272
0.0384 --- loss: 1.517540, loss_ss: 0.920215, loss_d: 0.597325
0.0767 --- loss: 1.611417, loss_ss: 1.164993, loss_d: 0.446424
0.1151 --- loss: 1.449317, loss_ss: 0.899961, loss_d: 0.549356
0.1535 --- loss: 1.785146, loss_ss: 0.815160, loss_d: 0.969985
0.1919 --- loss: 1.778946, loss_ss: 0.955689, loss_d: 0.823256
0.2302 --- loss: 1.270687, loss_ss: 0.907208, loss_d: 0.363479
0.2686 --- loss: 1.312394, loss_ss: 0.900675, loss_d: 0.411719
0.3070 --- loss: 1.298024, loss_ss: 1.009952, loss_d: 0.288072
0.3454 --- loss: 1.470449, loss_ss: 0.854977, loss_d: 0.615472
0.3837 --- loss: 1.810890, loss_ss: 1.202908, loss_d: 0.607983
0.4221 --- loss: 1.659418, loss_ss: 1.239737, loss_d: 0.419681
0.4605 --- loss: 1.011107, loss_ss: 0.648646, loss_d: 0.362460
0.4988 --- loss: 1.741544, loss_ss: 0.718705, loss_d: 1.022838
0.5372 --- loss: 1.338561, loss_ss: 0.851266, loss_d: 0.487295
0.5756 --- loss: 1.241247, loss_ss: 0.786788, loss_d: 0.454459
0.6140 --- loss: 1.554260, loss_ss: 0.801825, loss_d: 0.752436
0.6523 --- loss: 1.238061, loss_ss: 0.718903, loss_d: 0.519158
0.6907 --- loss: 1.394979, loss_ss: 1.019062, loss_d: 0.375918
0.7291 --- loss: 1.161889, loss_ss: 0.789716, loss_d: 0.372174
0.7675 --- loss: 1.622550, loss_ss: 0.865702, loss_d: 0.756848
0.8058 --- loss: 1.508413, loss_ss: 0.975874, loss_d: 0.532539
0.8442 --- loss: 1.556061, loss_ss: 0.821835, loss_d: 0.734226
0.8826 --- loss: 1.627564, loss_ss: 0.857455, loss_d: 0.770109
0.9210 --- loss: 1.505404, loss_ss: 0.917661, loss_d: 0.587743
0.9593 --- loss: 1.301193, loss_ss: 0.596362, loss_d: 0.704830
0.9977 --- loss: 1.371603, loss_ss: 1.146843, loss_d: 0.224760
Epoch finished! Loss: 1.435838001049482
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.269948, loss_ss: 0.755546, loss_d: 0.514402
0.0384 --- loss: 1.339557, loss_ss: 0.899252, loss_d: 0.440305
0.0767 --- loss: 1.379175, loss_ss: 1.062721, loss_d: 0.316454
0.1151 --- loss: 1.218496, loss_ss: 0.934265, loss_d: 0.284231
0.1535 --- loss: 1.356168, loss_ss: 0.917969, loss_d: 0.438199
0.1919 --- loss: 1.380967, loss_ss: 0.837673, loss_d: 0.543294
0.2302 --- loss: 1.674438, loss_ss: 1.195958, loss_d: 0.478480
0.2686 --- loss: 1.184459, loss_ss: 0.827317, loss_d: 0.357142
0.3070 --- loss: 1.047482, loss_ss: 0.606117, loss_d: 0.441365
0.3454 --- loss: 1.485760, loss_ss: 0.967573, loss_d: 0.518187
0.3837 --- loss: 1.498214, loss_ss: 0.847770, loss_d: 0.650445
0.4221 --- loss: 1.126663, loss_ss: 0.762635, loss_d: 0.364027
0.4605 --- loss: 1.280083, loss_ss: 0.901050, loss_d: 0.379033
0.4988 --- loss: 1.179878, loss_ss: 0.856029, loss_d: 0.323849
0.5372 --- loss: 1.280312, loss_ss: 0.919152, loss_d: 0.361160
0.5756 --- loss: 1.425800, loss_ss: 0.921139, loss_d: 0.504661
0.6140 --- loss: 1.370373, loss_ss: 0.977146, loss_d: 0.393227
0.6523 --- loss: 1.847414, loss_ss: 1.044337, loss_d: 0.803077
0.6907 --- loss: 1.111578, loss_ss: 0.684132, loss_d: 0.427446
0.7291 --- loss: 0.962854, loss_ss: 0.667970, loss_d: 0.294884
0.7675 --- loss: 1.559271, loss_ss: 0.894439, loss_d: 0.664832
0.8058 --- loss: 1.176846, loss_ss: 0.845131, loss_d: 0.331715
0.8442 --- loss: 1.183065, loss_ss: 0.839722, loss_d: 0.343343
0.8826 --- loss: 1.422364, loss_ss: 1.021332, loss_d: 0.401032
0.9210 --- loss: 1.627730, loss_ss: 0.989771, loss_d: 0.637959
0.9593 --- loss: 1.949779, loss_ss: 1.464950, loss_d: 0.484829
0.9977 --- loss: 1.774576, loss_ss: 1.132716, loss_d: 0.641860
Epoch finished! Loss: 1.3790703392945802
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.198787, loss_ss: 0.818840, loss_d: 0.379947
0.0384 --- loss: 1.337499, loss_ss: 0.743520, loss_d: 0.593979
0.0767 --- loss: 1.290856, loss_ss: 0.790314, loss_d: 0.500542
0.1151 --- loss: 1.161041, loss_ss: 0.895125, loss_d: 0.265916
0.1535 --- loss: 1.396674, loss_ss: 1.023508, loss_d: 0.373166
0.1919 --- loss: 1.140095, loss_ss: 0.824526, loss_d: 0.315569
0.2302 --- loss: 1.179398, loss_ss: 0.901060, loss_d: 0.278338
0.2686 --- loss: 1.027688, loss_ss: 0.656709, loss_d: 0.370979
0.3070 --- loss: 1.427083, loss_ss: 1.044493, loss_d: 0.382590
0.3454 --- loss: 1.390550, loss_ss: 1.013444, loss_d: 0.377106
0.3837 --- loss: 1.680813, loss_ss: 1.353062, loss_d: 0.327751
0.4221 --- loss: 1.178171, loss_ss: 0.874159, loss_d: 0.304011
0.4605 --- loss: 2.888006, loss_ss: 1.262552, loss_d: 1.625453
0.4988 --- loss: 1.158388, loss_ss: 0.880156, loss_d: 0.278232
0.5372 --- loss: 1.046999, loss_ss: 0.725477, loss_d: 0.321523
0.5756 --- loss: 0.898318, loss_ss: 0.634317, loss_d: 0.264001
0.6140 --- loss: 1.458338, loss_ss: 0.591311, loss_d: 0.867027
0.6523 --- loss: 1.414322, loss_ss: 1.100794, loss_d: 0.313528
0.6907 --- loss: 1.329625, loss_ss: 0.705582, loss_d: 0.624044
0.7291 --- loss: 1.807033, loss_ss: 1.220899, loss_d: 0.586133
0.7675 --- loss: 1.248282, loss_ss: 0.947669, loss_d: 0.300613
0.8058 --- loss: 1.360543, loss_ss: 0.759457, loss_d: 0.601085
0.8442 --- loss: 1.023124, loss_ss: 0.716841, loss_d: 0.306283
0.8826 --- loss: 1.325112, loss_ss: 0.905668, loss_d: 0.419443
0.9210 --- loss: 1.351010, loss_ss: 0.886601, loss_d: 0.464409
0.9593 --- loss: 1.709853, loss_ss: 1.118202, loss_d: 0.591652
0.9977 --- loss: 0.929878, loss_ss: 0.668933, loss_d: 0.260946
Epoch finished! Loss: 1.3118802552039808
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.107270, loss_ss: 0.807117, loss_d: 0.300153
0.0384 --- loss: 1.621293, loss_ss: 0.784372, loss_d: 0.836921
0.0767 --- loss: 1.423791, loss_ss: 1.077641, loss_d: 0.346151
0.1151 --- loss: 1.358683, loss_ss: 0.841830, loss_d: 0.516853
0.1535 --- loss: 1.692079, loss_ss: 0.900258, loss_d: 0.791820
0.1919 --- loss: 1.230071, loss_ss: 0.912539, loss_d: 0.317533
0.2302 --- loss: 1.130381, loss_ss: 0.608364, loss_d: 0.522016
0.2686 --- loss: 1.459698, loss_ss: 1.219635, loss_d: 0.240063
0.3070 --- loss: 1.300373, loss_ss: 1.016943, loss_d: 0.283430
0.3454 --- loss: 1.972778, loss_ss: 0.831862, loss_d: 1.140915
0.3837 --- loss: 1.254089, loss_ss: 0.967158, loss_d: 0.286931
0.4221 --- loss: 1.092881, loss_ss: 0.894115, loss_d: 0.198766
0.4605 --- loss: 1.139674, loss_ss: 0.885222, loss_d: 0.254452
0.4988 --- loss: 1.192050, loss_ss: 0.882944, loss_d: 0.309106
0.5372 --- loss: 1.195600, loss_ss: 0.579573, loss_d: 0.616026
0.5756 --- loss: 1.332139, loss_ss: 1.075968, loss_d: 0.256171
0.6140 --- loss: 1.139877, loss_ss: 0.814886, loss_d: 0.324990
0.6523 --- loss: 1.394011, loss_ss: 0.968960, loss_d: 0.425050
0.6907 --- loss: 1.274328, loss_ss: 0.996137, loss_d: 0.278192
0.7291 --- loss: 1.346119, loss_ss: 1.080696, loss_d: 0.265423
0.7675 --- loss: 1.043287, loss_ss: 0.750713, loss_d: 0.292573
0.8058 --- loss: 1.118987, loss_ss: 0.885910, loss_d: 0.233077
0.8442 --- loss: 1.407927, loss_ss: 1.103134, loss_d: 0.304794
0.8826 --- loss: 1.297902, loss_ss: 1.060022, loss_d: 0.237880
0.9210 --- loss: 1.215831, loss_ss: 0.833358, loss_d: 0.382473
0.9593 --- loss: 1.296723, loss_ss: 0.879092, loss_d: 0.417631
0.9977 --- loss: 2.102581, loss_ss: 1.539807, loss_d: 0.562774
Epoch finished! Loss: 1.2655222521378444
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.292315, loss_ss: 0.854555, loss_d: 0.437760
0.0384 --- loss: 1.261769, loss_ss: 0.780078, loss_d: 0.481691
0.0767 --- loss: 1.204398, loss_ss: 0.875101, loss_d: 0.329297
0.1151 --- loss: 1.377184, loss_ss: 0.948834, loss_d: 0.428350
0.1535 --- loss: 1.373074, loss_ss: 1.020565, loss_d: 0.352509
0.1919 --- loss: 1.057230, loss_ss: 0.800769, loss_d: 0.256461
0.2302 --- loss: 1.020959, loss_ss: 0.597361, loss_d: 0.423597
0.2686 --- loss: 1.347182, loss_ss: 1.032533, loss_d: 0.314649
0.3070 --- loss: 1.524052, loss_ss: 0.866504, loss_d: 0.657547
0.3454 --- loss: 1.077426, loss_ss: 0.721590, loss_d: 0.355836
0.3837 --- loss: 1.210429, loss_ss: 0.892799, loss_d: 0.317630
0.4221 --- loss: 0.864025, loss_ss: 0.575199, loss_d: 0.288827
0.4605 --- loss: 1.221536, loss_ss: 0.832673, loss_d: 0.388863
0.4988 --- loss: 1.231604, loss_ss: 0.800898, loss_d: 0.430706
0.5372 --- loss: 0.905503, loss_ss: 0.632228, loss_d: 0.273275
0.5756 --- loss: 1.271636, loss_ss: 0.980584, loss_d: 0.291052
0.6140 --- loss: 0.874627, loss_ss: 0.658904, loss_d: 0.215723
0.6523 --- loss: 1.184475, loss_ss: 0.898584, loss_d: 0.285892
0.6907 --- loss: 1.150986, loss_ss: 0.943322, loss_d: 0.207664
0.7291 --- loss: 1.079771, loss_ss: 0.799348, loss_d: 0.280424
0.7675 --- loss: 0.987913, loss_ss: 0.723463, loss_d: 0.264451
0.8058 --- loss: 1.140932, loss_ss: 0.866380, loss_d: 0.274552
0.8442 --- loss: 1.123575, loss_ss: 0.734482, loss_d: 0.389093
0.8826 --- loss: 0.879933, loss_ss: 0.577735, loss_d: 0.302198
0.9210 --- loss: 1.108088, loss_ss: 0.803316, loss_d: 0.304772
0.9593 --- loss: 0.986298, loss_ss: 0.795511, loss_d: 0.190787
0.9977 --- loss: 1.652428, loss_ss: 1.435183, loss_d: 0.217246
Epoch finished! Loss: 1.2360973984003067
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.131418, loss_ss: 0.956528, loss_d: 0.174890
0.0384 --- loss: 0.933796, loss_ss: 0.713198, loss_d: 0.220597
0.0767 --- loss: 1.128996, loss_ss: 0.829315, loss_d: 0.299681
0.1151 --- loss: 1.136887, loss_ss: 0.928181, loss_d: 0.208706
0.1535 --- loss: 1.499974, loss_ss: 0.826375, loss_d: 0.673599
0.1919 --- loss: 0.892426, loss_ss: 0.629177, loss_d: 0.263249
0.2302 --- loss: 1.223096, loss_ss: 0.771674, loss_d: 0.451422
0.2686 --- loss: 1.968556, loss_ss: 0.887535, loss_d: 1.081021
0.3070 --- loss: 0.985070, loss_ss: 0.687470, loss_d: 0.297601
0.3454 --- loss: 1.326035, loss_ss: 0.889963, loss_d: 0.436072
0.3837 --- loss: 1.036395, loss_ss: 0.714843, loss_d: 0.321552
0.4221 --- loss: 1.329706, loss_ss: 1.052065, loss_d: 0.277641
0.4605 --- loss: 1.431804, loss_ss: 1.110166, loss_d: 0.321638
0.4988 --- loss: 1.074199, loss_ss: 0.674699, loss_d: 0.399499
0.5372 --- loss: 0.805157, loss_ss: 0.513079, loss_d: 0.292078
0.5756 --- loss: 1.155362, loss_ss: 0.789425, loss_d: 0.365937
0.6140 --- loss: 1.217514, loss_ss: 0.886340, loss_d: 0.331174
0.6523 --- loss: 0.998967, loss_ss: 0.764421, loss_d: 0.234546
0.6907 --- loss: 1.317563, loss_ss: 0.613951, loss_d: 0.703612
0.7291 --- loss: 1.440334, loss_ss: 1.201812, loss_d: 0.238522
0.7675 --- loss: 1.084230, loss_ss: 0.756121, loss_d: 0.328110
0.8058 --- loss: 1.292268, loss_ss: 0.922418, loss_d: 0.369850
0.8442 --- loss: 0.815515, loss_ss: 0.550264, loss_d: 0.265251
0.8826 --- loss: 1.292876, loss_ss: 0.645489, loss_d: 0.647387
0.9210 --- loss: 1.153470, loss_ss: 0.836295, loss_d: 0.317176
0.9593 --- loss: 1.019123, loss_ss: 0.707569, loss_d: 0.311553
0.9977 --- loss: 0.904988, loss_ss: 0.624502, loss_d: 0.280486
Epoch finished! Loss: 1.2219149566613712
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.671875
             precision    recall  f1-score   support

        0.0       0.61      0.86      0.72       144
        1.0       0.42      0.46      0.44        82
        2.0       0.67      0.71      0.69       379
        3.0       1.00      0.67      0.80       227
        4.0       0.54      0.48      0.51       128

avg / total       0.70      0.67      0.68       960
 


====== chc008-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  89.79  86.11   90.44   61.39     71.68
1  89.90  46.34   93.96   41.76     43.93
2  74.90  71.24   77.28   67.16     69.14
3  92.19  66.96  100.00  100.00     80.21
4  87.60  47.66   93.75   53.98     50.62
Total accuracy: 67.19%
Average sen: 63.66%
Average spec: 91.09%
Macro f1-score: 63.12%
[0.50832355 0.46995792 0.48764196 0.46376956 0.94146168 0.60448939
 0.45890474 0.45890474 0.45890474 0.45890474 0.45890474 0.45890474
 0.45890474 0.62237442 0.47706887 0.45890474 0.45890474 0.46065897
 0.45890474 0.45890474 0.45890474 0.45890474 0.45890474 0.45890474
 0.45890474 0.45890474 0.45890474 0.45890474 0.47991493 0.45890474
 0.45890474 0.45890474]
pred: 0.48786142468452454, label: 0
Right! Diagnosis: Other

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.570575, loss_ss: 1.889954, loss_d: 0.680622
0.0383 --- loss: 1.953817, loss_ss: 1.557990, loss_d: 0.395827
0.0767 --- loss: 2.329941, loss_ss: 1.603519, loss_d: 0.726422
0.1150 --- loss: 2.121058, loss_ss: 1.447979, loss_d: 0.673078
0.1533 --- loss: 2.274604, loss_ss: 1.443734, loss_d: 0.830870
0.1916 --- loss: 1.849548, loss_ss: 1.465767, loss_d: 0.383781
0.2300 --- loss: 1.837691, loss_ss: 1.379101, loss_d: 0.458591
0.2683 --- loss: 1.811826, loss_ss: 1.386371, loss_d: 0.425455
0.3066 --- loss: 2.251345, loss_ss: 1.406831, loss_d: 0.844513
0.3450 --- loss: 2.123182, loss_ss: 1.391281, loss_d: 0.731901
0.3833 --- loss: 2.021566, loss_ss: 1.427480, loss_d: 0.594086
0.4216 --- loss: 1.925116, loss_ss: 1.288885, loss_d: 0.636231
0.4599 --- loss: 2.755007, loss_ss: 1.370037, loss_d: 1.384970
0.4983 --- loss: 1.838579, loss_ss: 1.207039, loss_d: 0.631540
0.5366 --- loss: 1.873062, loss_ss: 1.260910, loss_d: 0.612151
0.5749 --- loss: 1.910571, loss_ss: 1.309339, loss_d: 0.601233
0.6133 --- loss: 1.831204, loss_ss: 1.136978, loss_d: 0.694227
0.6516 --- loss: 1.934080, loss_ss: 1.140522, loss_d: 0.793558
0.6899 --- loss: 2.044442, loss_ss: 1.144730, loss_d: 0.899712
0.7282 --- loss: 1.887693, loss_ss: 1.227064, loss_d: 0.660630
0.7666 --- loss: 1.590606, loss_ss: 1.099432, loss_d: 0.491174
0.8049 --- loss: 1.635961, loss_ss: 1.158622, loss_d: 0.477339
0.8432 --- loss: 1.557557, loss_ss: 1.070339, loss_d: 0.487218
0.8816 --- loss: 1.810114, loss_ss: 1.249083, loss_d: 0.561031
0.9199 --- loss: 1.813866, loss_ss: 1.265170, loss_d: 0.548696
0.9582 --- loss: 1.776797, loss_ss: 1.076285, loss_d: 0.700512
0.9966 --- loss: 1.588569, loss_ss: 1.018083, loss_d: 0.570486
Epoch finished! Loss: 1.9458823075661293
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.668357, loss_ss: 1.023581, loss_d: 0.644776
0.0383 --- loss: 1.832540, loss_ss: 1.363936, loss_d: 0.468604
0.0767 --- loss: 1.734796, loss_ss: 1.061609, loss_d: 0.673188
0.1150 --- loss: 1.734204, loss_ss: 1.305602, loss_d: 0.428602
0.1533 --- loss: 1.762205, loss_ss: 1.101026, loss_d: 0.661179
0.1916 --- loss: 1.490118, loss_ss: 1.015070, loss_d: 0.475048
0.2300 --- loss: 1.390463, loss_ss: 0.976106, loss_d: 0.414357
0.2683 --- loss: 1.671825, loss_ss: 0.977444, loss_d: 0.694381
0.3066 --- loss: 1.579430, loss_ss: 1.184666, loss_d: 0.394764
0.3450 --- loss: 1.624682, loss_ss: 1.173996, loss_d: 0.450686
0.3833 --- loss: 1.754455, loss_ss: 1.237946, loss_d: 0.516510
0.4216 --- loss: 1.666813, loss_ss: 1.074552, loss_d: 0.592261
0.4599 --- loss: 1.790356, loss_ss: 0.979482, loss_d: 0.810875
0.4983 --- loss: 1.357998, loss_ss: 0.842616, loss_d: 0.515382
0.5366 --- loss: 1.634050, loss_ss: 1.215202, loss_d: 0.418848
0.5749 --- loss: 1.749882, loss_ss: 1.318679, loss_d: 0.431202
0.6133 --- loss: 1.851141, loss_ss: 1.178877, loss_d: 0.672264
0.6516 --- loss: 1.946804, loss_ss: 1.117756, loss_d: 0.829048
0.6899 --- loss: 1.638841, loss_ss: 1.141590, loss_d: 0.497251
0.7282 --- loss: 1.635979, loss_ss: 0.871037, loss_d: 0.764941
0.7666 --- loss: 1.604498, loss_ss: 1.036491, loss_d: 0.568006
0.8049 --- loss: 1.444119, loss_ss: 1.011625, loss_d: 0.432494
0.8432 --- loss: 1.597786, loss_ss: 0.758483, loss_d: 0.839303
0.8816 --- loss: 1.833859, loss_ss: 1.142039, loss_d: 0.691820
0.9199 --- loss: 1.794164, loss_ss: 1.170807, loss_d: 0.623357
0.9582 --- loss: 1.556708, loss_ss: 1.055324, loss_d: 0.501384
0.9966 --- loss: 1.432883, loss_ss: 1.043661, loss_d: 0.389223
Epoch finished! Loss: 1.6775316994923812
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.480050, loss_ss: 0.979953, loss_d: 0.500097
0.0383 --- loss: 1.640665, loss_ss: 1.136387, loss_d: 0.504278
0.0767 --- loss: 1.781001, loss_ss: 1.255017, loss_d: 0.525984
0.1150 --- loss: 1.724271, loss_ss: 1.052097, loss_d: 0.672173
0.1533 --- loss: 1.775077, loss_ss: 1.163954, loss_d: 0.611123
0.1916 --- loss: 1.414982, loss_ss: 0.912208, loss_d: 0.502774
0.2300 --- loss: 1.371120, loss_ss: 0.921905, loss_d: 0.449215
0.2683 --- loss: 1.457835, loss_ss: 0.925522, loss_d: 0.532312
0.3066 --- loss: 1.486038, loss_ss: 1.007165, loss_d: 0.478873
0.3450 --- loss: 1.508721, loss_ss: 1.122481, loss_d: 0.386241
0.3833 --- loss: 1.993842, loss_ss: 1.095403, loss_d: 0.898439
0.4216 --- loss: 1.477362, loss_ss: 0.835235, loss_d: 0.642127
0.4599 --- loss: 1.413007, loss_ss: 0.893195, loss_d: 0.519812
0.4983 --- loss: 1.664865, loss_ss: 0.992992, loss_d: 0.671874
0.5366 --- loss: 1.607400, loss_ss: 1.050880, loss_d: 0.556519
0.5749 --- loss: 1.802732, loss_ss: 1.077623, loss_d: 0.725109
0.6133 --- loss: 1.604051, loss_ss: 1.210405, loss_d: 0.393646
0.6516 --- loss: 1.702535, loss_ss: 1.094742, loss_d: 0.607793
0.6899 --- loss: 1.336510, loss_ss: 0.828486, loss_d: 0.508023
0.7282 --- loss: 1.880286, loss_ss: 1.253920, loss_d: 0.626366
0.7666 --- loss: 1.388987, loss_ss: 0.735043, loss_d: 0.653944
0.8049 --- loss: 1.585141, loss_ss: 1.053461, loss_d: 0.531679
0.8432 --- loss: 1.347131, loss_ss: 0.838140, loss_d: 0.508990
0.8816 --- loss: 1.645269, loss_ss: 1.286873, loss_d: 0.358397
0.9199 --- loss: 1.853699, loss_ss: 1.268534, loss_d: 0.585165
0.9582 --- loss: 1.389584, loss_ss: 0.874971, loss_d: 0.514613
0.9966 --- loss: 1.375859, loss_ss: 0.941761, loss_d: 0.434098
Epoch finished! Loss: 1.5727775083138393
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.624139, loss_ss: 0.855475, loss_d: 0.768664
0.0383 --- loss: 1.332729, loss_ss: 0.891096, loss_d: 0.441632
0.0767 --- loss: 1.539144, loss_ss: 0.921149, loss_d: 0.617995
0.1150 --- loss: 1.493332, loss_ss: 0.905564, loss_d: 0.587769
0.1533 --- loss: 2.040814, loss_ss: 1.567540, loss_d: 0.473275
0.1916 --- loss: 1.338786, loss_ss: 0.847472, loss_d: 0.491314
0.2300 --- loss: 1.219977, loss_ss: 0.852750, loss_d: 0.367226
0.2683 --- loss: 1.391008, loss_ss: 0.950855, loss_d: 0.440152
0.3066 --- loss: 1.215147, loss_ss: 0.893158, loss_d: 0.321989
0.3450 --- loss: 1.510811, loss_ss: 0.987862, loss_d: 0.522949
0.3833 --- loss: 1.403798, loss_ss: 0.941361, loss_d: 0.462437
0.4216 --- loss: 1.631833, loss_ss: 0.871830, loss_d: 0.760003
0.4599 --- loss: 1.328679, loss_ss: 1.074156, loss_d: 0.254523
0.4983 --- loss: 1.487578, loss_ss: 0.797553, loss_d: 0.690025
0.5366 --- loss: 2.087188, loss_ss: 1.299439, loss_d: 0.787749
0.5749 --- loss: 1.392324, loss_ss: 0.860135, loss_d: 0.532189
0.6133 --- loss: 1.492797, loss_ss: 0.915057, loss_d: 0.577740
0.6516 --- loss: 1.700860, loss_ss: 1.194731, loss_d: 0.506129
0.6899 --- loss: 1.591830, loss_ss: 0.993424, loss_d: 0.598406
0.7282 --- loss: 1.443702, loss_ss: 0.914497, loss_d: 0.529205
0.7666 --- loss: 1.276123, loss_ss: 0.741867, loss_d: 0.534256
0.8049 --- loss: 1.344582, loss_ss: 0.788494, loss_d: 0.556087
0.8432 --- loss: 1.265785, loss_ss: 0.860522, loss_d: 0.405263
0.8816 --- loss: 1.546287, loss_ss: 1.069423, loss_d: 0.476864
0.9199 --- loss: 1.312117, loss_ss: 0.883454, loss_d: 0.428663
0.9582 --- loss: 1.364156, loss_ss: 1.034673, loss_d: 0.329483
0.9966 --- loss: 1.438510, loss_ss: 0.608616, loss_d: 0.829894
Epoch finished! Loss: 1.520745362685277
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.480491, loss_ss: 0.754339, loss_d: 0.726152
0.0383 --- loss: 1.484081, loss_ss: 0.799407, loss_d: 0.684674
0.0767 --- loss: 1.637154, loss_ss: 1.082683, loss_d: 0.554471
0.1150 --- loss: 1.682710, loss_ss: 1.058679, loss_d: 0.624031
0.1533 --- loss: 1.648421, loss_ss: 0.728322, loss_d: 0.920099
0.1916 --- loss: 1.537694, loss_ss: 0.822650, loss_d: 0.715044
0.2300 --- loss: 1.674901, loss_ss: 0.989532, loss_d: 0.685370
0.2683 --- loss: 1.584420, loss_ss: 0.948365, loss_d: 0.636055
0.3066 --- loss: 1.611360, loss_ss: 1.109183, loss_d: 0.502177
0.3450 --- loss: 1.340185, loss_ss: 0.728339, loss_d: 0.611846
0.3833 --- loss: 1.331902, loss_ss: 0.921381, loss_d: 0.410521
0.4216 --- loss: 1.379882, loss_ss: 0.930942, loss_d: 0.448940
0.4599 --- loss: 1.864980, loss_ss: 1.233940, loss_d: 0.631040
0.4983 --- loss: 1.466348, loss_ss: 1.118137, loss_d: 0.348211
0.5366 --- loss: 0.994382, loss_ss: 0.727438, loss_d: 0.266944
0.5749 --- loss: 1.969687, loss_ss: 1.186215, loss_d: 0.783472
0.6133 --- loss: 1.369517, loss_ss: 0.992375, loss_d: 0.377142
0.6516 --- loss: 1.505034, loss_ss: 0.743198, loss_d: 0.761836
0.6899 --- loss: 1.466090, loss_ss: 1.145627, loss_d: 0.320463
0.7282 --- loss: 1.199967, loss_ss: 0.745419, loss_d: 0.454548
0.7666 --- loss: 1.372454, loss_ss: 0.902896, loss_d: 0.469557
0.8049 --- loss: 1.270273, loss_ss: 0.884146, loss_d: 0.386127
0.8432 --- loss: 1.266442, loss_ss: 0.758409, loss_d: 0.508033
0.8816 --- loss: 1.590177, loss_ss: 1.218958, loss_d: 0.371219
0.9199 --- loss: 1.239630, loss_ss: 0.748937, loss_d: 0.490693
0.9582 --- loss: 1.840576, loss_ss: 1.208873, loss_d: 0.631703
0.9966 --- loss: 1.448699, loss_ss: 1.002871, loss_d: 0.445828
Epoch finished! Loss: 1.4851488177592937
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.222221, loss_ss: 0.818466, loss_d: 0.403755
0.0383 --- loss: 1.603054, loss_ss: 0.941994, loss_d: 0.661060
0.0767 --- loss: 1.448309, loss_ss: 1.085512, loss_d: 0.362798
0.1150 --- loss: 1.486365, loss_ss: 1.117172, loss_d: 0.369193
0.1533 --- loss: 1.533637, loss_ss: 0.843890, loss_d: 0.689747
0.1916 --- loss: 1.258898, loss_ss: 0.852364, loss_d: 0.406534
0.2300 --- loss: 1.289670, loss_ss: 0.965815, loss_d: 0.323855
0.2683 --- loss: 1.799575, loss_ss: 1.303516, loss_d: 0.496059
0.3066 --- loss: 1.330215, loss_ss: 0.938487, loss_d: 0.391728
0.3450 --- loss: 1.518913, loss_ss: 0.966028, loss_d: 0.552885
0.3833 --- loss: 1.634235, loss_ss: 1.111178, loss_d: 0.523058
0.4216 --- loss: 1.760176, loss_ss: 1.065943, loss_d: 0.694233
0.4599 --- loss: 1.352894, loss_ss: 0.836252, loss_d: 0.516643
0.4983 --- loss: 1.452210, loss_ss: 0.905157, loss_d: 0.547053
0.5366 --- loss: 1.304896, loss_ss: 0.806737, loss_d: 0.498159
0.5749 --- loss: 1.266806, loss_ss: 0.865637, loss_d: 0.401169
0.6133 --- loss: 1.549676, loss_ss: 0.824691, loss_d: 0.724985
0.6516 --- loss: 1.199048, loss_ss: 0.867114, loss_d: 0.331934
0.6899 --- loss: 0.812497, loss_ss: 0.557284, loss_d: 0.255212
0.7282 --- loss: 1.067391, loss_ss: 0.680974, loss_d: 0.386417
0.7666 --- loss: 1.688104, loss_ss: 0.753789, loss_d: 0.934315
0.8049 --- loss: 1.078077, loss_ss: 0.807314, loss_d: 0.270763
0.8432 --- loss: 1.334761, loss_ss: 1.056080, loss_d: 0.278681
0.8816 --- loss: 1.283073, loss_ss: 0.715180, loss_d: 0.567893
0.9199 --- loss: 1.427408, loss_ss: 1.144317, loss_d: 0.283091
0.9582 --- loss: 1.179464, loss_ss: 0.966800, loss_d: 0.212664
0.9966 --- loss: 1.571522, loss_ss: 0.967613, loss_d: 0.603910
Epoch finished! Loss: 1.3862557301154503
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.491281, loss_ss: 1.047260, loss_d: 0.444021
0.0383 --- loss: 1.414035, loss_ss: 0.832618, loss_d: 0.581417
0.0767 --- loss: 1.269594, loss_ss: 0.873526, loss_d: 0.396068
0.1150 --- loss: 1.324150, loss_ss: 0.878902, loss_d: 0.445248
0.1533 --- loss: 1.284248, loss_ss: 0.898923, loss_d: 0.385324
0.1916 --- loss: 1.135525, loss_ss: 0.891179, loss_d: 0.244346
0.2300 --- loss: 0.990790, loss_ss: 0.757831, loss_d: 0.232959
0.2683 --- loss: 1.502619, loss_ss: 0.884471, loss_d: 0.618148
0.3066 --- loss: 0.968804, loss_ss: 0.717294, loss_d: 0.251510
0.3450 --- loss: 1.139048, loss_ss: 0.766052, loss_d: 0.372997
0.3833 --- loss: 1.421497, loss_ss: 0.714074, loss_d: 0.707423
0.4216 --- loss: 1.701106, loss_ss: 1.144343, loss_d: 0.556762
0.4599 --- loss: 1.109308, loss_ss: 0.765274, loss_d: 0.344034
0.4983 --- loss: 1.378914, loss_ss: 0.911811, loss_d: 0.467103
0.5366 --- loss: 1.172945, loss_ss: 0.824343, loss_d: 0.348602
0.5749 --- loss: 1.440706, loss_ss: 0.947862, loss_d: 0.492844
0.6133 --- loss: 1.370774, loss_ss: 1.126739, loss_d: 0.244035
0.6516 --- loss: 0.884289, loss_ss: 0.726144, loss_d: 0.158145
0.6899 --- loss: 1.356758, loss_ss: 0.941963, loss_d: 0.414794
0.7282 --- loss: 1.630631, loss_ss: 1.322139, loss_d: 0.308492
0.7666 --- loss: 1.093377, loss_ss: 0.857079, loss_d: 0.236298
0.8049 --- loss: 1.479676, loss_ss: 1.005591, loss_d: 0.474084
0.8432 --- loss: 0.909007, loss_ss: 0.590070, loss_d: 0.318937
0.8816 --- loss: 1.051055, loss_ss: 0.636385, loss_d: 0.414671
0.9199 --- loss: 1.316504, loss_ss: 0.914560, loss_d: 0.401944
0.9582 --- loss: 1.221171, loss_ss: 0.902881, loss_d: 0.318290
0.9966 --- loss: 1.488764, loss_ss: 1.175623, loss_d: 0.313141
Epoch finished! Loss: 1.3127016947819636
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.208885, loss_ss: 0.872484, loss_d: 0.336400
0.0383 --- loss: 1.057960, loss_ss: 0.743114, loss_d: 0.314846
0.0767 --- loss: 0.903399, loss_ss: 0.728300, loss_d: 0.175099
0.1150 --- loss: 0.722071, loss_ss: 0.599713, loss_d: 0.122359
0.1533 --- loss: 1.407115, loss_ss: 1.053614, loss_d: 0.353502
0.1916 --- loss: 1.407767, loss_ss: 0.921730, loss_d: 0.486036
0.2300 --- loss: 0.929059, loss_ss: 0.688818, loss_d: 0.240241
0.2683 --- loss: 1.288235, loss_ss: 1.051601, loss_d: 0.236634
0.3066 --- loss: 1.471023, loss_ss: 1.133805, loss_d: 0.337219
0.3450 --- loss: 1.213154, loss_ss: 0.896446, loss_d: 0.316708
0.3833 --- loss: 1.291610, loss_ss: 1.092714, loss_d: 0.198896
0.4216 --- loss: 1.271932, loss_ss: 0.851196, loss_d: 0.420736
0.4599 --- loss: 1.299720, loss_ss: 0.968490, loss_d: 0.331229
0.4983 --- loss: 1.330269, loss_ss: 0.985382, loss_d: 0.344887
0.5366 --- loss: 1.062629, loss_ss: 0.954009, loss_d: 0.108620
0.5749 --- loss: 1.329638, loss_ss: 0.862435, loss_d: 0.467203
0.6133 --- loss: 1.133671, loss_ss: 0.926906, loss_d: 0.206765
0.6516 --- loss: 0.903459, loss_ss: 0.681708, loss_d: 0.221751
0.6899 --- loss: 1.362707, loss_ss: 0.921975, loss_d: 0.440732
0.7282 --- loss: 0.880570, loss_ss: 0.728286, loss_d: 0.152284
0.7666 --- loss: 1.633122, loss_ss: 0.961657, loss_d: 0.671465
0.8049 --- loss: 1.586694, loss_ss: 0.826564, loss_d: 0.760129
0.8432 --- loss: 1.378187, loss_ss: 0.906717, loss_d: 0.471470
0.8816 --- loss: 1.192080, loss_ss: 0.713416, loss_d: 0.478664
0.9199 --- loss: 1.372322, loss_ss: 0.952715, loss_d: 0.419607
0.9582 --- loss: 1.072099, loss_ss: 0.725458, loss_d: 0.346641
0.9966 --- loss: 2.067551, loss_ss: 1.832162, loss_d: 0.235389
Epoch finished! Loss: 1.2830025090621069
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.054124, loss_ss: 0.846551, loss_d: 0.207573
0.0383 --- loss: 1.307326, loss_ss: 0.979770, loss_d: 0.327555
0.0767 --- loss: 1.285713, loss_ss: 0.998008, loss_d: 0.287704
0.1150 --- loss: 1.816836, loss_ss: 1.005655, loss_d: 0.811181
0.1533 --- loss: 1.194395, loss_ss: 1.037627, loss_d: 0.156769
0.1916 --- loss: 1.071547, loss_ss: 0.888815, loss_d: 0.182732
0.2300 --- loss: 1.450688, loss_ss: 1.172217, loss_d: 0.278472
0.2683 --- loss: 1.343809, loss_ss: 1.058429, loss_d: 0.285380
0.3066 --- loss: 1.246112, loss_ss: 0.916920, loss_d: 0.329192
0.3450 --- loss: 0.999109, loss_ss: 0.776340, loss_d: 0.222769
0.3833 --- loss: 0.943899, loss_ss: 0.659040, loss_d: 0.284859
0.4216 --- loss: 1.093781, loss_ss: 0.744576, loss_d: 0.349206
0.4599 --- loss: 1.509858, loss_ss: 1.107130, loss_d: 0.402727
0.4983 --- loss: 1.387834, loss_ss: 0.744134, loss_d: 0.643700
0.5366 --- loss: 1.224195, loss_ss: 0.993484, loss_d: 0.230711
0.5749 --- loss: 1.098132, loss_ss: 0.892893, loss_d: 0.205239
0.6133 --- loss: 1.158700, loss_ss: 0.613463, loss_d: 0.545236
0.6516 --- loss: 1.075510, loss_ss: 0.873611, loss_d: 0.201898
0.6899 --- loss: 1.057662, loss_ss: 0.793922, loss_d: 0.263740
0.7282 --- loss: 1.419597, loss_ss: 0.997408, loss_d: 0.422189
0.7666 --- loss: 1.165436, loss_ss: 0.795942, loss_d: 0.369494
0.8049 --- loss: 1.107959, loss_ss: 0.725155, loss_d: 0.382804
0.8432 --- loss: 1.506205, loss_ss: 1.181260, loss_d: 0.324945
0.8816 --- loss: 1.129424, loss_ss: 0.825832, loss_d: 0.303592
0.9199 --- loss: 1.205354, loss_ss: 0.923824, loss_d: 0.281530
0.9582 --- loss: 1.872986, loss_ss: 1.049963, loss_d: 0.823024
0.9966 --- loss: 1.094828, loss_ss: 0.971036, loss_d: 0.123792
Epoch finished! Loss: 1.230382053897931
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.813231, loss_ss: 0.727632, loss_d: 0.085599
0.0383 --- loss: 0.994307, loss_ss: 0.805328, loss_d: 0.188979
0.0767 --- loss: 1.183064, loss_ss: 0.891224, loss_d: 0.291840
0.1150 --- loss: 1.220731, loss_ss: 1.076044, loss_d: 0.144687
0.1533 --- loss: 0.734563, loss_ss: 0.652138, loss_d: 0.082425
0.1916 --- loss: 1.021652, loss_ss: 0.877395, loss_d: 0.144257
0.2300 --- loss: 1.178324, loss_ss: 0.686408, loss_d: 0.491916
0.2683 --- loss: 0.881378, loss_ss: 0.699160, loss_d: 0.182218
0.3066 --- loss: 1.065397, loss_ss: 0.825414, loss_d: 0.239983
0.3450 --- loss: 1.600949, loss_ss: 1.411209, loss_d: 0.189740
0.3833 --- loss: 1.033808, loss_ss: 0.953821, loss_d: 0.079987
0.4216 --- loss: 0.962197, loss_ss: 0.821219, loss_d: 0.140977
0.4599 --- loss: 0.828162, loss_ss: 0.747533, loss_d: 0.080629
0.4983 --- loss: 0.848657, loss_ss: 0.692666, loss_d: 0.155991
0.5366 --- loss: 1.060910, loss_ss: 0.741505, loss_d: 0.319405
0.5749 --- loss: 1.324539, loss_ss: 0.825417, loss_d: 0.499122
0.6133 --- loss: 1.104419, loss_ss: 0.944350, loss_d: 0.160068
0.6516 --- loss: 1.022238, loss_ss: 0.880442, loss_d: 0.141796
0.6899 --- loss: 1.050228, loss_ss: 0.935261, loss_d: 0.114968
0.7282 --- loss: 1.514451, loss_ss: 1.311022, loss_d: 0.203429
0.7666 --- loss: 0.795121, loss_ss: 0.656043, loss_d: 0.139077
0.8049 --- loss: 0.797231, loss_ss: 0.653691, loss_d: 0.143540
0.8432 --- loss: 0.777192, loss_ss: 0.627881, loss_d: 0.149311
0.8816 --- loss: 1.267958, loss_ss: 1.064057, loss_d: 0.203901
0.9199 --- loss: 0.773670, loss_ss: 0.607364, loss_d: 0.166306
0.9582 --- loss: 1.124523, loss_ss: 1.029695, loss_d: 0.094828
0.9966 --- loss: 2.027926, loss_ss: 0.723307, loss_d: 1.304619
Epoch finished! Loss: 1.1374167112203746
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7459770114942529
             precision    recall  f1-score   support

        0.0       0.51      0.96      0.66        72
        1.0       0.20      0.13      0.16        46
        2.0       0.96      0.62      0.75       443
        3.0       0.92      0.96      0.94       196
        4.0       0.52      0.99      0.68       113

avg / total       0.82      0.75      0.75       870
 


====== chc009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.95  95.83   91.60  50.74     66.35
1  92.64  13.04   97.09  20.00     15.79
2  79.31  61.85   97.42  96.14     75.27
3  97.24  95.92   97.63  92.16     94.00
4  88.05  99.12   86.39  52.09     68.29
Total accuracy: 74.60%
Average sen: 73.15%
Average spec: 94.03%
Macro f1-score: 63.94%
[0.68054819 0.66040623 0.73940247 0.50209427 0.71963447 0.62630969
 0.23211309 0.64054608 0.3098627  0.7826845  0.67721164 0.89753491
 0.94648963 0.80457622 0.90885323 0.8911857  0.62441319 0.65893883
 0.35976508 0.685691   0.35478064 0.68645555 0.64001369 0.91557461
 0.3590329  0.7081266  0.84750372 0.53867561 0.83725929]
pred: 0.6632994403099192, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.594614, loss_ss: 1.863743, loss_d: 0.730871
0.0383 --- loss: 2.829268, loss_ss: 1.718286, loss_d: 1.110983
0.0766 --- loss: 2.880926, loss_ss: 1.815466, loss_d: 1.065460
0.1149 --- loss: 2.432710, loss_ss: 1.680733, loss_d: 0.751976
0.1533 --- loss: 2.000823, loss_ss: 1.503130, loss_d: 0.497692
0.1916 --- loss: 2.144968, loss_ss: 1.453686, loss_d: 0.691282
0.2299 --- loss: 2.210803, loss_ss: 1.507292, loss_d: 0.703511
0.2682 --- loss: 2.068136, loss_ss: 1.441739, loss_d: 0.626397
0.3065 --- loss: 2.237060, loss_ss: 1.738189, loss_d: 0.498872
0.3448 --- loss: 2.216089, loss_ss: 1.697126, loss_d: 0.518963
0.3831 --- loss: 2.013315, loss_ss: 1.358453, loss_d: 0.654863
0.4215 --- loss: 2.113817, loss_ss: 1.421840, loss_d: 0.691977
0.4598 --- loss: 2.062284, loss_ss: 1.576562, loss_d: 0.485722
0.4981 --- loss: 1.935349, loss_ss: 1.471235, loss_d: 0.464114
0.5364 --- loss: 2.034110, loss_ss: 1.506257, loss_d: 0.527853
0.5747 --- loss: 2.173828, loss_ss: 1.517997, loss_d: 0.655831
0.6130 --- loss: 1.750805, loss_ss: 1.218086, loss_d: 0.532720
0.6513 --- loss: 2.052114, loss_ss: 1.518371, loss_d: 0.533744
0.6897 --- loss: 2.077068, loss_ss: 1.460702, loss_d: 0.616366
0.7280 --- loss: 1.825944, loss_ss: 1.250454, loss_d: 0.575490
0.7663 --- loss: 1.935705, loss_ss: 1.294808, loss_d: 0.640897
0.8046 --- loss: 1.592793, loss_ss: 1.334068, loss_d: 0.258725
0.8429 --- loss: 1.907545, loss_ss: 1.151206, loss_d: 0.756339
0.8812 --- loss: 1.742089, loss_ss: 1.269794, loss_d: 0.472295
0.9195 --- loss: 1.860132, loss_ss: 1.242527, loss_d: 0.617605
0.9579 --- loss: 1.848287, loss_ss: 1.284823, loss_d: 0.563465
0.9962 --- loss: 2.004593, loss_ss: 1.330059, loss_d: 0.674534
Epoch finished! Loss: 2.053860567166255
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.844196, loss_ss: 1.251349, loss_d: 0.592847
0.0383 --- loss: 1.551280, loss_ss: 1.202316, loss_d: 0.348964
0.0766 --- loss: 2.029963, loss_ss: 1.176012, loss_d: 0.853951
0.1149 --- loss: 1.899101, loss_ss: 1.337079, loss_d: 0.562021
0.1533 --- loss: 1.550302, loss_ss: 1.007291, loss_d: 0.543011
0.1916 --- loss: 1.412839, loss_ss: 1.072814, loss_d: 0.340026
0.2299 --- loss: 1.427605, loss_ss: 0.999152, loss_d: 0.428453
0.2682 --- loss: 1.903194, loss_ss: 1.310292, loss_d: 0.592902
0.3065 --- loss: 1.507301, loss_ss: 1.179855, loss_d: 0.327446
0.3448 --- loss: 1.648759, loss_ss: 1.217233, loss_d: 0.431526
0.3831 --- loss: 1.831602, loss_ss: 1.110613, loss_d: 0.720989
0.4215 --- loss: 1.667369, loss_ss: 1.178413, loss_d: 0.488955
0.4598 --- loss: 1.625485, loss_ss: 1.055781, loss_d: 0.569704
0.4981 --- loss: 1.551647, loss_ss: 0.970286, loss_d: 0.581361
0.5364 --- loss: 1.889853, loss_ss: 1.207053, loss_d: 0.682800
0.5747 --- loss: 1.529270, loss_ss: 1.082851, loss_d: 0.446419
0.6130 --- loss: 1.985335, loss_ss: 1.253363, loss_d: 0.731972
0.6513 --- loss: 1.616692, loss_ss: 1.300773, loss_d: 0.315919
0.6897 --- loss: 1.539344, loss_ss: 1.039961, loss_d: 0.499383
0.7280 --- loss: 1.611991, loss_ss: 1.048118, loss_d: 0.563873
0.7663 --- loss: 2.108088, loss_ss: 1.117890, loss_d: 0.990199
0.8046 --- loss: 1.493252, loss_ss: 0.796264, loss_d: 0.696987
0.8429 --- loss: 1.837817, loss_ss: 1.185909, loss_d: 0.651908
0.8812 --- loss: 1.365117, loss_ss: 0.897765, loss_d: 0.467352
0.9195 --- loss: 1.763821, loss_ss: 1.059303, loss_d: 0.704518
0.9579 --- loss: 1.789570, loss_ss: 1.144063, loss_d: 0.645508
0.9962 --- loss: 1.615337, loss_ss: 1.322411, loss_d: 0.292926
Epoch finished! Loss: 1.7174298708255475
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.923026, loss_ss: 1.188929, loss_d: 0.734097
0.0383 --- loss: 1.313127, loss_ss: 0.977142, loss_d: 0.335986
0.0766 --- loss: 1.400603, loss_ss: 0.882565, loss_d: 0.518038
0.1149 --- loss: 1.714612, loss_ss: 1.195935, loss_d: 0.518676
0.1533 --- loss: 1.828163, loss_ss: 1.100605, loss_d: 0.727558
0.1916 --- loss: 1.710651, loss_ss: 1.069721, loss_d: 0.640930
0.2299 --- loss: 1.495019, loss_ss: 0.995524, loss_d: 0.499495
0.2682 --- loss: 1.360427, loss_ss: 0.796632, loss_d: 0.563795
0.3065 --- loss: 1.364050, loss_ss: 1.016697, loss_d: 0.347353
0.3448 --- loss: 1.380867, loss_ss: 1.060895, loss_d: 0.319971
0.3831 --- loss: 1.361161, loss_ss: 0.859072, loss_d: 0.502090
0.4215 --- loss: 1.841800, loss_ss: 1.401704, loss_d: 0.440096
0.4598 --- loss: 1.583747, loss_ss: 1.051224, loss_d: 0.532522
0.4981 --- loss: 1.350998, loss_ss: 1.052840, loss_d: 0.298158
0.5364 --- loss: 1.394963, loss_ss: 0.885897, loss_d: 0.509066
0.5747 --- loss: 1.890250, loss_ss: 0.983355, loss_d: 0.906896
0.6130 --- loss: 1.467774, loss_ss: 1.061834, loss_d: 0.405941
0.6513 --- loss: 2.304766, loss_ss: 1.419724, loss_d: 0.885042
0.6897 --- loss: 1.559232, loss_ss: 1.084920, loss_d: 0.474312
0.7280 --- loss: 1.991352, loss_ss: 1.396273, loss_d: 0.595079
0.7663 --- loss: 1.577592, loss_ss: 0.957524, loss_d: 0.620068
0.8046 --- loss: 1.560121, loss_ss: 0.998999, loss_d: 0.561122
0.8429 --- loss: 1.488114, loss_ss: 1.021719, loss_d: 0.466396
0.8812 --- loss: 1.390335, loss_ss: 1.110568, loss_d: 0.279767
0.9195 --- loss: 1.244425, loss_ss: 0.941704, loss_d: 0.302721
0.9579 --- loss: 1.337676, loss_ss: 1.088118, loss_d: 0.249558
0.9962 --- loss: 1.654767, loss_ss: 1.063618, loss_d: 0.591148
Epoch finished! Loss: 1.5783021266643817
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.162419, loss_ss: 0.779086, loss_d: 0.383333
0.0383 --- loss: 1.562052, loss_ss: 0.940378, loss_d: 0.621674
0.0766 --- loss: 1.362242, loss_ss: 0.901224, loss_d: 0.461019
0.1149 --- loss: 1.297134, loss_ss: 0.884366, loss_d: 0.412768
0.1533 --- loss: 1.802938, loss_ss: 1.109475, loss_d: 0.693463
0.1916 --- loss: 1.624716, loss_ss: 1.086739, loss_d: 0.537977
0.2299 --- loss: 2.093111, loss_ss: 1.655473, loss_d: 0.437638
0.2682 --- loss: 1.424387, loss_ss: 1.015827, loss_d: 0.408560
0.3065 --- loss: 1.274016, loss_ss: 0.859918, loss_d: 0.414098
0.3448 --- loss: 1.923971, loss_ss: 0.914701, loss_d: 1.009271
0.3831 --- loss: 1.770702, loss_ss: 1.090403, loss_d: 0.680299
0.4215 --- loss: 1.340445, loss_ss: 0.881238, loss_d: 0.459206
0.4598 --- loss: 1.524069, loss_ss: 0.743359, loss_d: 0.780711
0.4981 --- loss: 1.503317, loss_ss: 1.013246, loss_d: 0.490071
0.5364 --- loss: 1.831033, loss_ss: 0.846473, loss_d: 0.984560
0.5747 --- loss: 1.498017, loss_ss: 1.138564, loss_d: 0.359453
0.6130 --- loss: 1.440725, loss_ss: 0.916539, loss_d: 0.524186
0.6513 --- loss: 1.141659, loss_ss: 0.778265, loss_d: 0.363394
0.6897 --- loss: 1.535630, loss_ss: 0.916968, loss_d: 0.618662
0.7280 --- loss: 1.439054, loss_ss: 1.005090, loss_d: 0.433964
0.7663 --- loss: 1.629594, loss_ss: 1.228572, loss_d: 0.401023
0.8046 --- loss: 1.103432, loss_ss: 0.814041, loss_d: 0.289391
0.8429 --- loss: 1.463036, loss_ss: 0.893668, loss_d: 0.569368
0.8812 --- loss: 1.242143, loss_ss: 0.785470, loss_d: 0.456673
0.9195 --- loss: 1.334590, loss_ss: 1.018498, loss_d: 0.316092
0.9579 --- loss: 1.663731, loss_ss: 0.972602, loss_d: 0.691129
0.9962 --- loss: 1.290772, loss_ss: 0.983597, loss_d: 0.307175
Epoch finished! Loss: 1.4839886245819238
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.207159, loss_ss: 1.420293, loss_d: 0.786866
0.0383 --- loss: 1.566068, loss_ss: 1.123552, loss_d: 0.442516
0.0766 --- loss: 1.508458, loss_ss: 0.996987, loss_d: 0.511471
0.1149 --- loss: 1.211820, loss_ss: 0.838063, loss_d: 0.373757
0.1533 --- loss: 1.273965, loss_ss: 0.759693, loss_d: 0.514272
0.1916 --- loss: 1.095784, loss_ss: 0.624367, loss_d: 0.471417
0.2299 --- loss: 1.490826, loss_ss: 0.725462, loss_d: 0.765364
0.2682 --- loss: 2.041522, loss_ss: 1.448480, loss_d: 0.593043
0.3065 --- loss: 1.286793, loss_ss: 0.976034, loss_d: 0.310760
0.3448 --- loss: 2.133324, loss_ss: 1.416511, loss_d: 0.716813
0.3831 --- loss: 1.231625, loss_ss: 0.879462, loss_d: 0.352162
0.4215 --- loss: 1.271897, loss_ss: 0.865972, loss_d: 0.405924
0.4598 --- loss: 1.319737, loss_ss: 0.902974, loss_d: 0.416763
0.4981 --- loss: 1.488989, loss_ss: 1.120846, loss_d: 0.368144
0.5364 --- loss: 1.218753, loss_ss: 0.881463, loss_d: 0.337290
0.5747 --- loss: 1.153291, loss_ss: 0.813964, loss_d: 0.339327
0.6130 --- loss: 1.482624, loss_ss: 0.920812, loss_d: 0.561812
0.6513 --- loss: 1.529212, loss_ss: 1.072275, loss_d: 0.456938
0.6897 --- loss: 1.430260, loss_ss: 1.079267, loss_d: 0.350994
0.7280 --- loss: 1.684829, loss_ss: 0.831210, loss_d: 0.853619
0.7663 --- loss: 0.853732, loss_ss: 0.591617, loss_d: 0.262116
0.8046 --- loss: 1.462105, loss_ss: 1.147676, loss_d: 0.314430
0.8429 --- loss: 1.820761, loss_ss: 1.110801, loss_d: 0.709960
0.8812 --- loss: 1.154257, loss_ss: 0.789297, loss_d: 0.364961
0.9195 --- loss: 1.113093, loss_ss: 0.922974, loss_d: 0.190120
0.9579 --- loss: 1.003631, loss_ss: 0.699681, loss_d: 0.303951
0.9962 --- loss: 1.119768, loss_ss: 0.859080, loss_d: 0.260688
Epoch finished! Loss: 1.4015211960444083
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.266517, loss_ss: 1.057147, loss_d: 0.209370
0.0383 --- loss: 1.408803, loss_ss: 1.236131, loss_d: 0.172671
0.0766 --- loss: 1.398805, loss_ss: 0.755764, loss_d: 0.643041
0.1149 --- loss: 1.593540, loss_ss: 1.231637, loss_d: 0.361903
0.1533 --- loss: 1.261718, loss_ss: 0.811363, loss_d: 0.450354
0.1916 --- loss: 1.657479, loss_ss: 0.765033, loss_d: 0.892446
0.2299 --- loss: 0.996982, loss_ss: 0.758767, loss_d: 0.238215
0.2682 --- loss: 1.221062, loss_ss: 0.932514, loss_d: 0.288548
0.3065 --- loss: 0.983519, loss_ss: 0.770249, loss_d: 0.213270
0.3448 --- loss: 1.366121, loss_ss: 0.891689, loss_d: 0.474432
0.3831 --- loss: 1.558087, loss_ss: 1.071471, loss_d: 0.486616
0.4215 --- loss: 1.159138, loss_ss: 0.931753, loss_d: 0.227385
0.4598 --- loss: 1.245459, loss_ss: 0.934878, loss_d: 0.310580
0.4981 --- loss: 1.403927, loss_ss: 0.868647, loss_d: 0.535280
0.5364 --- loss: 1.114167, loss_ss: 0.925658, loss_d: 0.188509
0.5747 --- loss: 1.346409, loss_ss: 1.094641, loss_d: 0.251768
0.6130 --- loss: 1.096798, loss_ss: 0.753062, loss_d: 0.343737
0.6513 --- loss: 1.814873, loss_ss: 1.285660, loss_d: 0.529213
0.6897 --- loss: 1.342603, loss_ss: 0.975650, loss_d: 0.366953
0.7280 --- loss: 1.101418, loss_ss: 0.803570, loss_d: 0.297848
0.7663 --- loss: 1.344147, loss_ss: 0.966854, loss_d: 0.377294
0.8046 --- loss: 1.360058, loss_ss: 1.027923, loss_d: 0.332135
0.8429 --- loss: 1.342366, loss_ss: 0.922123, loss_d: 0.420242
0.8812 --- loss: 1.409488, loss_ss: 0.879755, loss_d: 0.529732
0.9195 --- loss: 1.049459, loss_ss: 0.776465, loss_d: 0.272993
0.9579 --- loss: 0.953288, loss_ss: 0.767822, loss_d: 0.185466
0.9962 --- loss: 1.074837, loss_ss: 0.702388, loss_d: 0.372450
Epoch finished! Loss: 1.3175783214660792
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.106008, loss_ss: 0.752780, loss_d: 0.353228
0.0383 --- loss: 1.055855, loss_ss: 0.898343, loss_d: 0.157512
0.0766 --- loss: 1.060605, loss_ss: 0.913054, loss_d: 0.147551
0.1149 --- loss: 1.260690, loss_ss: 0.929877, loss_d: 0.330813
0.1533 --- loss: 1.214837, loss_ss: 0.997317, loss_d: 0.217521
0.1916 --- loss: 1.114405, loss_ss: 0.879625, loss_d: 0.234779
0.2299 --- loss: 1.605013, loss_ss: 0.963140, loss_d: 0.641873
0.2682 --- loss: 0.904911, loss_ss: 0.734852, loss_d: 0.170059
0.3065 --- loss: 1.271250, loss_ss: 0.906383, loss_d: 0.364866
0.3448 --- loss: 1.345419, loss_ss: 1.115261, loss_d: 0.230158
0.3831 --- loss: 1.434763, loss_ss: 0.813143, loss_d: 0.621620
0.4215 --- loss: 1.339044, loss_ss: 1.097105, loss_d: 0.241939
0.4598 --- loss: 1.255948, loss_ss: 0.848434, loss_d: 0.407514
0.4981 --- loss: 1.310057, loss_ss: 0.846528, loss_d: 0.463529
0.5364 --- loss: 1.203964, loss_ss: 0.883502, loss_d: 0.320462
0.5747 --- loss: 1.254408, loss_ss: 0.877717, loss_d: 0.376691
0.6130 --- loss: 1.538659, loss_ss: 0.886209, loss_d: 0.652450
0.6513 --- loss: 1.149109, loss_ss: 0.649310, loss_d: 0.499799
0.6897 --- loss: 1.306228, loss_ss: 0.837823, loss_d: 0.468404
0.7280 --- loss: 1.362416, loss_ss: 1.060181, loss_d: 0.302235
0.7663 --- loss: 0.977695, loss_ss: 0.528639, loss_d: 0.449056
0.8046 --- loss: 1.460523, loss_ss: 0.800981, loss_d: 0.659543
0.8429 --- loss: 1.063410, loss_ss: 0.774471, loss_d: 0.288939
0.8812 --- loss: 1.830983, loss_ss: 1.079250, loss_d: 0.751733
0.9195 --- loss: 1.063706, loss_ss: 0.636222, loss_d: 0.427484
0.9579 --- loss: 1.192428, loss_ss: 0.818342, loss_d: 0.374086
0.9962 --- loss: 1.425569, loss_ss: 0.897173, loss_d: 0.528396
Epoch finished! Loss: 1.2962929487228394
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.210563, loss_ss: 0.895639, loss_d: 0.314924
0.0383 --- loss: 1.469765, loss_ss: 1.141181, loss_d: 0.328585
0.0766 --- loss: 0.937025, loss_ss: 0.692426, loss_d: 0.244599
0.1149 --- loss: 1.164552, loss_ss: 0.765239, loss_d: 0.399313
0.1533 --- loss: 0.948539, loss_ss: 0.649236, loss_d: 0.299303
0.1916 --- loss: 1.053303, loss_ss: 0.755655, loss_d: 0.297648
0.2299 --- loss: 1.361226, loss_ss: 0.866713, loss_d: 0.494513
0.2682 --- loss: 1.228030, loss_ss: 0.804191, loss_d: 0.423840
0.3065 --- loss: 1.219351, loss_ss: 0.770535, loss_d: 0.448816
0.3448 --- loss: 1.446407, loss_ss: 0.878066, loss_d: 0.568340
0.3831 --- loss: 1.018442, loss_ss: 0.736518, loss_d: 0.281924
0.4215 --- loss: 1.209364, loss_ss: 0.710078, loss_d: 0.499286
0.4598 --- loss: 1.350778, loss_ss: 1.036353, loss_d: 0.314425
0.4981 --- loss: 1.280569, loss_ss: 0.833666, loss_d: 0.446903
0.5364 --- loss: 1.907059, loss_ss: 0.873057, loss_d: 1.034002
0.5747 --- loss: 1.522359, loss_ss: 0.910733, loss_d: 0.611626
0.6130 --- loss: 1.172455, loss_ss: 0.710105, loss_d: 0.462351
0.6513 --- loss: 1.486679, loss_ss: 1.092635, loss_d: 0.394044
0.6897 --- loss: 1.233027, loss_ss: 0.972613, loss_d: 0.260414
0.7280 --- loss: 1.222407, loss_ss: 1.053676, loss_d: 0.168732
0.7663 --- loss: 1.167154, loss_ss: 0.671116, loss_d: 0.496038
0.8046 --- loss: 1.151392, loss_ss: 0.824269, loss_d: 0.327123
0.8429 --- loss: 1.182311, loss_ss: 0.812503, loss_d: 0.369808
0.8812 --- loss: 1.242766, loss_ss: 0.849649, loss_d: 0.393117
0.9195 --- loss: 1.043988, loss_ss: 0.873077, loss_d: 0.170912
0.9579 --- loss: 0.907677, loss_ss: 0.737129, loss_d: 0.170548
0.9962 --- loss: 1.295690, loss_ss: 0.979565, loss_d: 0.316125
Epoch finished! Loss: 1.240341547360787
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.154007, loss_ss: 1.013047, loss_d: 0.140960
0.0383 --- loss: 1.399723, loss_ss: 0.942307, loss_d: 0.457417
0.0766 --- loss: 1.148533, loss_ss: 0.950411, loss_d: 0.198122
0.1149 --- loss: 1.174800, loss_ss: 0.648156, loss_d: 0.526644
0.1533 --- loss: 1.235370, loss_ss: 0.914766, loss_d: 0.320604
0.1916 --- loss: 1.309389, loss_ss: 1.132478, loss_d: 0.176911
0.2299 --- loss: 0.991579, loss_ss: 0.626273, loss_d: 0.365306
0.2682 --- loss: 1.030647, loss_ss: 0.724348, loss_d: 0.306299
0.3065 --- loss: 1.198671, loss_ss: 0.967798, loss_d: 0.230873
0.3448 --- loss: 1.392067, loss_ss: 1.092918, loss_d: 0.299149
0.3831 --- loss: 1.555638, loss_ss: 0.848316, loss_d: 0.707322
0.4215 --- loss: 1.399298, loss_ss: 0.828068, loss_d: 0.571230
0.4598 --- loss: 1.100291, loss_ss: 0.917384, loss_d: 0.182906
0.4981 --- loss: 1.000179, loss_ss: 0.654770, loss_d: 0.345409
0.5364 --- loss: 0.848459, loss_ss: 0.701936, loss_d: 0.146523
0.5747 --- loss: 1.849347, loss_ss: 0.997691, loss_d: 0.851656
0.6130 --- loss: 1.763024, loss_ss: 1.422704, loss_d: 0.340320
0.6513 --- loss: 1.136799, loss_ss: 0.901481, loss_d: 0.235317
0.6897 --- loss: 1.070981, loss_ss: 0.803009, loss_d: 0.267972
0.7280 --- loss: 1.285508, loss_ss: 0.982996, loss_d: 0.302512
0.7663 --- loss: 1.103219, loss_ss: 0.722596, loss_d: 0.380623
0.8046 --- loss: 0.910605, loss_ss: 0.585552, loss_d: 0.325053
0.8429 --- loss: 1.123929, loss_ss: 0.887384, loss_d: 0.236545
0.8812 --- loss: 0.989772, loss_ss: 0.850832, loss_d: 0.138940
0.9195 --- loss: 0.999944, loss_ss: 0.783099, loss_d: 0.216845
0.9579 --- loss: 1.063355, loss_ss: 0.793540, loss_d: 0.269815
0.9962 --- loss: 1.292139, loss_ss: 0.871456, loss_d: 0.420683
Epoch finished! Loss: 1.2193420809048874
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.929622, loss_ss: 0.732739, loss_d: 0.196883
0.0383 --- loss: 1.310245, loss_ss: 0.771176, loss_d: 0.539069
0.0766 --- loss: 1.207021, loss_ss: 0.881094, loss_d: 0.325927
0.1149 --- loss: 1.156981, loss_ss: 0.823955, loss_d: 0.333026
0.1533 --- loss: 0.916894, loss_ss: 0.728749, loss_d: 0.188145
0.1916 --- loss: 1.011742, loss_ss: 0.686392, loss_d: 0.325350
0.2299 --- loss: 0.996687, loss_ss: 0.798796, loss_d: 0.197890
0.2682 --- loss: 1.332633, loss_ss: 0.646345, loss_d: 0.686288
0.3065 --- loss: 1.000300, loss_ss: 0.705404, loss_d: 0.294896
0.3448 --- loss: 1.287425, loss_ss: 0.865955, loss_d: 0.421470
0.3831 --- loss: 0.963781, loss_ss: 0.762122, loss_d: 0.201659
0.4215 --- loss: 1.342046, loss_ss: 0.817926, loss_d: 0.524120
0.4598 --- loss: 0.931303, loss_ss: 0.810903, loss_d: 0.120400
0.4981 --- loss: 1.091992, loss_ss: 0.933863, loss_d: 0.158130
0.5364 --- loss: 0.847820, loss_ss: 0.609707, loss_d: 0.238113
0.5747 --- loss: 1.582305, loss_ss: 0.972552, loss_d: 0.609753
0.6130 --- loss: 1.153574, loss_ss: 0.654217, loss_d: 0.499357
0.6513 --- loss: 1.118890, loss_ss: 0.779477, loss_d: 0.339413
0.6897 --- loss: 1.268671, loss_ss: 0.811106, loss_d: 0.457565
0.7280 --- loss: 0.995585, loss_ss: 0.747976, loss_d: 0.247609
0.7663 --- loss: 1.281894, loss_ss: 0.942248, loss_d: 0.339646
0.8046 --- loss: 0.856912, loss_ss: 0.693040, loss_d: 0.163872
0.8429 --- loss: 1.180984, loss_ss: 1.014902, loss_d: 0.166082
0.8812 --- loss: 1.489761, loss_ss: 0.757571, loss_d: 0.732190
0.9195 --- loss: 0.841428, loss_ss: 0.703340, loss_d: 0.138088
0.9579 --- loss: 1.015901, loss_ss: 0.870036, loss_d: 0.145864
0.9962 --- loss: 0.918486, loss_ss: 0.704956, loss_d: 0.213530
Epoch finished! Loss: 1.169745444563719
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7202380952380952
             precision    recall  f1-score   support

        0.0       0.82      0.85      0.84       123
        1.0       0.50      0.21      0.30        43
        2.0       0.76      0.92      0.83       400
        3.0       0.90      0.23      0.36       193
        4.0       0.49      0.98      0.65        81

avg / total       0.76      0.72      0.68       840
 


====== chc010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.12  85.37   96.79  82.03     83.67
1  94.88  20.93   98.87  50.00     29.51
2  82.38  92.00   73.64  76.03     83.26
3  81.67  22.80   99.23  89.80     36.36
4  90.00  97.53   89.20  49.07     65.29
Total accuracy: 72.02%
Average sen: 63.72%
Average spec: 91.54%
Macro f1-score: 59.62%
[0.22886442 0.80678505 0.36710766 0.97149354 0.13909911 0.34417236
 0.11013364 0.11147268 0.2662105  0.10952516 0.82606959 0.06248586
 0.3473222  0.35673338 0.30436715 0.07566579 0.10096556 0.18514651
 0.0700728  0.1255995  0.17622171 0.30463326 0.66134906 0.12578954
 0.07125007 0.29691851 0.10270221 0.15327775]
pred: 0.27862266331378904, label: 0
Right! Diagnosis: Other

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.422723, loss_ss: 1.719769, loss_d: 0.702954
0.0383 --- loss: 2.132357, loss_ss: 1.620438, loss_d: 0.511919
0.0767 --- loss: 1.877193, loss_ss: 1.538514, loss_d: 0.338679
0.1150 --- loss: 2.346618, loss_ss: 1.594786, loss_d: 0.751832
0.1534 --- loss: 2.010647, loss_ss: 1.559366, loss_d: 0.451281
0.1917 --- loss: 1.927532, loss_ss: 1.449395, loss_d: 0.478137
0.2301 --- loss: 2.008346, loss_ss: 1.326479, loss_d: 0.681868
0.2684 --- loss: 2.010513, loss_ss: 1.447556, loss_d: 0.562957
0.3067 --- loss: 1.941854, loss_ss: 1.328359, loss_d: 0.613494
0.3451 --- loss: 2.133601, loss_ss: 1.299870, loss_d: 0.833732
0.3834 --- loss: 1.994654, loss_ss: 1.523445, loss_d: 0.471209
0.4218 --- loss: 2.209679, loss_ss: 1.543711, loss_d: 0.665968
0.4601 --- loss: 1.711751, loss_ss: 1.287752, loss_d: 0.423999
0.4985 --- loss: 1.740693, loss_ss: 1.405343, loss_d: 0.335350
0.5368 --- loss: 1.933035, loss_ss: 1.459443, loss_d: 0.473592
0.5752 --- loss: 1.875332, loss_ss: 1.373626, loss_d: 0.501707
0.6135 --- loss: 2.274284, loss_ss: 1.491316, loss_d: 0.782968
0.6518 --- loss: 1.670636, loss_ss: 1.229782, loss_d: 0.440854
0.6902 --- loss: 1.916803, loss_ss: 1.426355, loss_d: 0.490449
0.7285 --- loss: 1.829198, loss_ss: 1.132170, loss_d: 0.697028
0.7669 --- loss: 1.727914, loss_ss: 1.224114, loss_d: 0.503800
0.8052 --- loss: 1.937248, loss_ss: 1.393690, loss_d: 0.543558
0.8436 --- loss: 1.999977, loss_ss: 1.329619, loss_d: 0.670358
0.8819 --- loss: 1.861470, loss_ss: 1.268208, loss_d: 0.593262
0.9202 --- loss: 1.818365, loss_ss: 1.221876, loss_d: 0.596489
0.9586 --- loss: 1.935923, loss_ss: 1.253577, loss_d: 0.682346
0.9969 --- loss: 1.771932, loss_ss: 1.231561, loss_d: 0.540371
Epoch finished! Loss: 1.9880489849127256
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.700724, loss_ss: 1.333767, loss_d: 0.366958
0.0383 --- loss: 1.786900, loss_ss: 1.376104, loss_d: 0.410796
0.0767 --- loss: 1.511017, loss_ss: 1.128961, loss_d: 0.382057
0.1150 --- loss: 1.944849, loss_ss: 1.340492, loss_d: 0.604356
0.1534 --- loss: 2.013744, loss_ss: 1.229408, loss_d: 0.784336
0.1917 --- loss: 1.613783, loss_ss: 1.111898, loss_d: 0.501885
0.2301 --- loss: 1.843629, loss_ss: 1.228362, loss_d: 0.615267
0.2684 --- loss: 1.715829, loss_ss: 1.219029, loss_d: 0.496799
0.3067 --- loss: 1.723121, loss_ss: 1.173421, loss_d: 0.549699
0.3451 --- loss: 1.632805, loss_ss: 1.226168, loss_d: 0.406636
0.3834 --- loss: 1.733429, loss_ss: 1.329230, loss_d: 0.404199
0.4218 --- loss: 1.768225, loss_ss: 1.034799, loss_d: 0.733425
0.4601 --- loss: 1.781976, loss_ss: 1.240885, loss_d: 0.541090
0.4985 --- loss: 1.866809, loss_ss: 0.988179, loss_d: 0.878630
0.5368 --- loss: 1.693149, loss_ss: 1.114251, loss_d: 0.578899
0.5752 --- loss: 2.260403, loss_ss: 1.398613, loss_d: 0.861790
0.6135 --- loss: 1.504752, loss_ss: 1.060620, loss_d: 0.444132
0.6518 --- loss: 1.677103, loss_ss: 1.250508, loss_d: 0.426596
0.6902 --- loss: 1.626804, loss_ss: 1.233549, loss_d: 0.393255
0.7285 --- loss: 1.420726, loss_ss: 0.940809, loss_d: 0.479917
0.7669 --- loss: 1.782238, loss_ss: 1.268772, loss_d: 0.513465
0.8052 --- loss: 1.985651, loss_ss: 1.451056, loss_d: 0.534595
0.8436 --- loss: 1.825914, loss_ss: 1.353447, loss_d: 0.472467
0.8819 --- loss: 1.519234, loss_ss: 1.005481, loss_d: 0.513753
0.9202 --- loss: 1.776282, loss_ss: 1.130408, loss_d: 0.645874
0.9586 --- loss: 1.589971, loss_ss: 0.942700, loss_d: 0.647271
0.9969 --- loss: 1.703684, loss_ss: 0.996364, loss_d: 0.707320
Epoch finished! Loss: 1.715163158453428
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.609320, loss_ss: 0.952139, loss_d: 0.657181
0.0383 --- loss: 1.577026, loss_ss: 1.179095, loss_d: 0.397931
0.0767 --- loss: 1.478489, loss_ss: 0.976516, loss_d: 0.501973
0.1150 --- loss: 2.008496, loss_ss: 1.317903, loss_d: 0.690592
0.1534 --- loss: 1.501296, loss_ss: 1.213047, loss_d: 0.288248
0.1917 --- loss: 1.724729, loss_ss: 1.129702, loss_d: 0.595027
0.2301 --- loss: 1.676086, loss_ss: 1.084925, loss_d: 0.591161
0.2684 --- loss: 2.093221, loss_ss: 1.327722, loss_d: 0.765499
0.3067 --- loss: 1.628361, loss_ss: 0.828228, loss_d: 0.800132
0.3451 --- loss: 1.767980, loss_ss: 1.347477, loss_d: 0.420502
0.3834 --- loss: 1.593388, loss_ss: 1.143176, loss_d: 0.450213
0.4218 --- loss: 1.871092, loss_ss: 0.925895, loss_d: 0.945197
0.4601 --- loss: 1.636127, loss_ss: 1.007962, loss_d: 0.628165
0.4985 --- loss: 1.338518, loss_ss: 0.883702, loss_d: 0.454816
0.5368 --- loss: 1.656101, loss_ss: 0.988139, loss_d: 0.667962
0.5752 --- loss: 1.692232, loss_ss: 1.404101, loss_d: 0.288132
0.6135 --- loss: 1.292220, loss_ss: 0.763124, loss_d: 0.529096
0.6518 --- loss: 1.362264, loss_ss: 0.911647, loss_d: 0.450617
0.6902 --- loss: 1.464617, loss_ss: 1.099298, loss_d: 0.365319
0.7285 --- loss: 1.304688, loss_ss: 1.012052, loss_d: 0.292635
0.7669 --- loss: 1.407767, loss_ss: 0.772836, loss_d: 0.634931
0.8052 --- loss: 1.811351, loss_ss: 1.265311, loss_d: 0.546041
0.8436 --- loss: 1.446621, loss_ss: 0.861424, loss_d: 0.585197
0.8819 --- loss: 1.694457, loss_ss: 1.055878, loss_d: 0.638579
0.9202 --- loss: 1.578306, loss_ss: 1.151906, loss_d: 0.426400
0.9586 --- loss: 1.831938, loss_ss: 1.153462, loss_d: 0.678476
0.9969 --- loss: 1.410219, loss_ss: 0.895057, loss_d: 0.515162
Epoch finished! Loss: 1.6147642855460826
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.620640, loss_ss: 0.965608, loss_d: 0.655032
0.0383 --- loss: 1.608323, loss_ss: 0.967930, loss_d: 0.640393
0.0767 --- loss: 1.368942, loss_ss: 0.908490, loss_d: 0.460452
0.1150 --- loss: 1.439790, loss_ss: 1.051535, loss_d: 0.388254
0.1534 --- loss: 1.144909, loss_ss: 0.710774, loss_d: 0.434135
0.1917 --- loss: 1.725710, loss_ss: 1.208618, loss_d: 0.517092
0.2301 --- loss: 2.174714, loss_ss: 1.393774, loss_d: 0.780940
0.2684 --- loss: 1.432923, loss_ss: 1.017481, loss_d: 0.415442
0.3067 --- loss: 1.715214, loss_ss: 1.206840, loss_d: 0.508374
0.3451 --- loss: 1.501888, loss_ss: 1.043359, loss_d: 0.458529
0.3834 --- loss: 1.522387, loss_ss: 0.770116, loss_d: 0.752270
0.4218 --- loss: 2.013739, loss_ss: 1.202750, loss_d: 0.810990
0.4601 --- loss: 1.341805, loss_ss: 0.893564, loss_d: 0.448241
0.4985 --- loss: 1.282289, loss_ss: 0.843906, loss_d: 0.438384
0.5368 --- loss: 1.547708, loss_ss: 1.019938, loss_d: 0.527770
0.5752 --- loss: 1.757242, loss_ss: 1.309159, loss_d: 0.448083
0.6135 --- loss: 1.347192, loss_ss: 0.828288, loss_d: 0.518904
0.6518 --- loss: 1.426081, loss_ss: 0.785428, loss_d: 0.640653
0.6902 --- loss: 1.517861, loss_ss: 1.057969, loss_d: 0.459892
0.7285 --- loss: 1.864344, loss_ss: 1.224072, loss_d: 0.640272
0.7669 --- loss: 1.778210, loss_ss: 0.948395, loss_d: 0.829816
0.8052 --- loss: 2.108757, loss_ss: 1.107749, loss_d: 1.001008
0.8436 --- loss: 1.690657, loss_ss: 1.233727, loss_d: 0.456931
0.8819 --- loss: 1.181571, loss_ss: 0.865715, loss_d: 0.315856
0.9202 --- loss: 1.687485, loss_ss: 1.237215, loss_d: 0.450270
0.9586 --- loss: 1.194214, loss_ss: 0.847856, loss_d: 0.346358
0.9969 --- loss: 1.287105, loss_ss: 0.857697, loss_d: 0.429407
Epoch finished! Loss: 1.541657951244941
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.157216, loss_ss: 0.906941, loss_d: 0.250275
0.0383 --- loss: 1.205176, loss_ss: 0.932320, loss_d: 0.272856
0.0767 --- loss: 2.049795, loss_ss: 1.098411, loss_d: 0.951384
0.1150 --- loss: 1.199410, loss_ss: 0.984984, loss_d: 0.214426
0.1534 --- loss: 1.678032, loss_ss: 0.938544, loss_d: 0.739488
0.1917 --- loss: 1.350376, loss_ss: 1.084066, loss_d: 0.266310
0.2301 --- loss: 1.320515, loss_ss: 0.782532, loss_d: 0.537983
0.2684 --- loss: 1.393367, loss_ss: 0.725152, loss_d: 0.668215
0.3067 --- loss: 1.794394, loss_ss: 1.126892, loss_d: 0.667502
0.3451 --- loss: 1.358085, loss_ss: 0.882876, loss_d: 0.475209
0.3834 --- loss: 1.296200, loss_ss: 0.926635, loss_d: 0.369565
0.4218 --- loss: 1.288211, loss_ss: 1.034471, loss_d: 0.253740
0.4601 --- loss: 1.464520, loss_ss: 1.062010, loss_d: 0.402510
0.4985 --- loss: 1.344089, loss_ss: 0.846944, loss_d: 0.497145
0.5368 --- loss: 1.269692, loss_ss: 0.762520, loss_d: 0.507171
0.5752 --- loss: 1.878323, loss_ss: 1.320271, loss_d: 0.558052
0.6135 --- loss: 1.346802, loss_ss: 0.871717, loss_d: 0.475085
0.6518 --- loss: 1.938295, loss_ss: 1.084293, loss_d: 0.854002
0.6902 --- loss: 2.179658, loss_ss: 1.294192, loss_d: 0.885466
0.7285 --- loss: 1.394139, loss_ss: 0.772251, loss_d: 0.621889
0.7669 --- loss: 1.457789, loss_ss: 0.973838, loss_d: 0.483951
0.8052 --- loss: 1.268638, loss_ss: 0.909130, loss_d: 0.359508
0.8436 --- loss: 1.380357, loss_ss: 1.056553, loss_d: 0.323805
0.8819 --- loss: 1.178537, loss_ss: 0.762985, loss_d: 0.415552
0.9202 --- loss: 1.319556, loss_ss: 0.875197, loss_d: 0.444359
0.9586 --- loss: 1.230363, loss_ss: 0.800995, loss_d: 0.429369
0.9969 --- loss: 1.212557, loss_ss: 0.964860, loss_d: 0.247696
Epoch finished! Loss: 1.4583902987150046
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.205524, loss_ss: 0.931494, loss_d: 0.274030
0.0383 --- loss: 1.535881, loss_ss: 0.911490, loss_d: 0.624391
0.0767 --- loss: 1.249450, loss_ss: 0.801568, loss_d: 0.447882
0.1150 --- loss: 1.745046, loss_ss: 1.343424, loss_d: 0.401621
0.1534 --- loss: 1.298127, loss_ss: 1.032129, loss_d: 0.265998
0.1917 --- loss: 1.521323, loss_ss: 1.127980, loss_d: 0.393343
0.2301 --- loss: 1.260351, loss_ss: 1.075628, loss_d: 0.184723
0.2684 --- loss: 1.032776, loss_ss: 0.800340, loss_d: 0.232436
0.3067 --- loss: 1.563574, loss_ss: 0.754328, loss_d: 0.809246
0.3451 --- loss: 1.650064, loss_ss: 1.061882, loss_d: 0.588181
0.3834 --- loss: 1.099556, loss_ss: 0.771612, loss_d: 0.327944
0.4218 --- loss: 1.364639, loss_ss: 1.071197, loss_d: 0.293442
0.4601 --- loss: 1.347795, loss_ss: 0.721016, loss_d: 0.626779
0.4985 --- loss: 1.831661, loss_ss: 0.919981, loss_d: 0.911681
0.5368 --- loss: 1.410334, loss_ss: 0.912064, loss_d: 0.498270
0.5752 --- loss: 1.351910, loss_ss: 0.882756, loss_d: 0.469154
0.6135 --- loss: 1.241416, loss_ss: 0.781859, loss_d: 0.459557
0.6518 --- loss: 1.592085, loss_ss: 1.014256, loss_d: 0.577829
0.6902 --- loss: 1.044225, loss_ss: 0.893652, loss_d: 0.150573
0.7285 --- loss: 1.006876, loss_ss: 0.793226, loss_d: 0.213649
0.7669 --- loss: 1.102807, loss_ss: 0.874768, loss_d: 0.228039
0.8052 --- loss: 1.054453, loss_ss: 0.856791, loss_d: 0.197662
0.8436 --- loss: 1.076972, loss_ss: 0.901259, loss_d: 0.175713
0.8819 --- loss: 1.456182, loss_ss: 1.015029, loss_d: 0.441153
0.9202 --- loss: 1.299392, loss_ss: 1.032604, loss_d: 0.266788
0.9586 --- loss: 1.271644, loss_ss: 0.770116, loss_d: 0.501528
0.9969 --- loss: 1.115682, loss_ss: 0.937523, loss_d: 0.178159
Epoch finished! Loss: 1.3717128100303504
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.429436, loss_ss: 0.884019, loss_d: 0.545417
0.0383 --- loss: 1.085475, loss_ss: 0.748830, loss_d: 0.336645
0.0767 --- loss: 1.657804, loss_ss: 1.081884, loss_d: 0.575920
0.1150 --- loss: 1.519690, loss_ss: 1.124961, loss_d: 0.394729
0.1534 --- loss: 1.105451, loss_ss: 0.877744, loss_d: 0.227707
0.1917 --- loss: 1.370966, loss_ss: 1.134572, loss_d: 0.236394
0.2301 --- loss: 1.210578, loss_ss: 0.993475, loss_d: 0.217103
0.2684 --- loss: 1.312686, loss_ss: 0.769444, loss_d: 0.543242
0.3067 --- loss: 1.774954, loss_ss: 1.310879, loss_d: 0.464075
0.3451 --- loss: 1.038261, loss_ss: 0.755498, loss_d: 0.282763
0.3834 --- loss: 1.249127, loss_ss: 1.057296, loss_d: 0.191831
0.4218 --- loss: 0.871253, loss_ss: 0.712165, loss_d: 0.159088
0.4601 --- loss: 0.991383, loss_ss: 0.694046, loss_d: 0.297337
0.4985 --- loss: 1.075062, loss_ss: 0.914339, loss_d: 0.160723
0.5368 --- loss: 1.643032, loss_ss: 0.889897, loss_d: 0.753134
0.5752 --- loss: 1.347740, loss_ss: 0.898918, loss_d: 0.448822
0.6135 --- loss: 1.612265, loss_ss: 1.054151, loss_d: 0.558114
0.6518 --- loss: 1.361028, loss_ss: 0.961537, loss_d: 0.399491
0.6902 --- loss: 1.242558, loss_ss: 0.813383, loss_d: 0.429175
0.7285 --- loss: 1.632564, loss_ss: 0.944204, loss_d: 0.688360
0.7669 --- loss: 1.189627, loss_ss: 0.835826, loss_d: 0.353801
0.8052 --- loss: 1.444434, loss_ss: 0.847058, loss_d: 0.597376
0.8436 --- loss: 1.330065, loss_ss: 0.837571, loss_d: 0.492494
0.8819 --- loss: 1.478003, loss_ss: 1.048885, loss_d: 0.429118
0.9202 --- loss: 1.382831, loss_ss: 0.854817, loss_d: 0.528014
0.9586 --- loss: 1.328472, loss_ss: 0.998106, loss_d: 0.330366
0.9969 --- loss: 0.958105, loss_ss: 0.685604, loss_d: 0.272501
Epoch finished! Loss: 1.3055523067712784
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.353724, loss_ss: 0.743818, loss_d: 0.609906
0.0383 --- loss: 1.306593, loss_ss: 1.022099, loss_d: 0.284494
0.0767 --- loss: 1.338617, loss_ss: 0.914288, loss_d: 0.424329
0.1150 --- loss: 1.291081, loss_ss: 1.057352, loss_d: 0.233730
0.1534 --- loss: 1.517981, loss_ss: 0.930917, loss_d: 0.587064
0.1917 --- loss: 0.956040, loss_ss: 0.821470, loss_d: 0.134570
0.2301 --- loss: 1.405450, loss_ss: 0.946832, loss_d: 0.458618
0.2684 --- loss: 1.021045, loss_ss: 0.673404, loss_d: 0.347641
0.3067 --- loss: 1.690248, loss_ss: 0.812781, loss_d: 0.877467
0.3451 --- loss: 1.509815, loss_ss: 0.985221, loss_d: 0.524594
0.3834 --- loss: 1.392487, loss_ss: 1.002771, loss_d: 0.389716
0.4218 --- loss: 1.605204, loss_ss: 1.217744, loss_d: 0.387460
0.4601 --- loss: 1.260923, loss_ss: 1.136945, loss_d: 0.123978
0.4985 --- loss: 1.610739, loss_ss: 1.219566, loss_d: 0.391172
0.5368 --- loss: 1.753875, loss_ss: 0.758523, loss_d: 0.995352
0.5752 --- loss: 1.084785, loss_ss: 0.822768, loss_d: 0.262016
0.6135 --- loss: 1.401190, loss_ss: 0.808200, loss_d: 0.592990
0.6518 --- loss: 1.460067, loss_ss: 0.991981, loss_d: 0.468086
0.6902 --- loss: 1.174511, loss_ss: 0.952499, loss_d: 0.222012
0.7285 --- loss: 1.192772, loss_ss: 1.064931, loss_d: 0.127841
0.7669 --- loss: 0.968630, loss_ss: 0.795773, loss_d: 0.172857
0.8052 --- loss: 0.987804, loss_ss: 0.759919, loss_d: 0.227885
0.8436 --- loss: 1.352481, loss_ss: 1.027585, loss_d: 0.324897
0.8819 --- loss: 1.289244, loss_ss: 0.994654, loss_d: 0.294590
0.9202 --- loss: 1.103252, loss_ss: 0.713396, loss_d: 0.389856
0.9586 --- loss: 1.372697, loss_ss: 0.891509, loss_d: 0.481188
0.9969 --- loss: 1.151529, loss_ss: 0.840213, loss_d: 0.311315
Epoch finished! Loss: 1.2373886759464556
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.448955, loss_ss: 1.143824, loss_d: 0.305131
0.0383 --- loss: 0.681205, loss_ss: 0.582159, loss_d: 0.099046
0.0767 --- loss: 0.924631, loss_ss: 0.727493, loss_d: 0.197138
0.1150 --- loss: 1.748449, loss_ss: 1.249850, loss_d: 0.498599
0.1534 --- loss: 1.632443, loss_ss: 1.323238, loss_d: 0.309205
0.1917 --- loss: 1.087149, loss_ss: 0.979617, loss_d: 0.107532
0.2301 --- loss: 1.225316, loss_ss: 1.051574, loss_d: 0.173742
0.2684 --- loss: 1.072242, loss_ss: 0.969115, loss_d: 0.103126
0.3067 --- loss: 1.100172, loss_ss: 0.870081, loss_d: 0.230091
0.3451 --- loss: 0.821578, loss_ss: 0.620932, loss_d: 0.200645
0.3834 --- loss: 0.838267, loss_ss: 0.714530, loss_d: 0.123737
0.4218 --- loss: 0.988006, loss_ss: 0.882321, loss_d: 0.105685
0.4601 --- loss: 1.092299, loss_ss: 0.842668, loss_d: 0.249631
0.4985 --- loss: 0.816542, loss_ss: 0.698993, loss_d: 0.117549
0.5368 --- loss: 1.307994, loss_ss: 1.123685, loss_d: 0.184309
0.5752 --- loss: 1.142871, loss_ss: 0.660630, loss_d: 0.482241
0.6135 --- loss: 1.189765, loss_ss: 1.026161, loss_d: 0.163604
0.6518 --- loss: 1.395572, loss_ss: 1.011641, loss_d: 0.383931
0.6902 --- loss: 1.635279, loss_ss: 1.089145, loss_d: 0.546134
0.7285 --- loss: 1.340089, loss_ss: 1.015444, loss_d: 0.324645
0.7669 --- loss: 1.128753, loss_ss: 0.930387, loss_d: 0.198366
0.8052 --- loss: 1.206052, loss_ss: 0.974514, loss_d: 0.231538
0.8436 --- loss: 1.134100, loss_ss: 0.839040, loss_d: 0.295060
0.8819 --- loss: 1.309123, loss_ss: 0.879788, loss_d: 0.429335
0.9202 --- loss: 1.226087, loss_ss: 0.820557, loss_d: 0.405529
0.9586 --- loss: 1.154289, loss_ss: 0.923329, loss_d: 0.230959
0.9969 --- loss: 1.253565, loss_ss: 0.882517, loss_d: 0.371048
Epoch finished! Loss: 1.1800452179633654
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.128329, loss_ss: 0.862120, loss_d: 0.266209
0.0383 --- loss: 0.921710, loss_ss: 0.736113, loss_d: 0.185597
0.0767 --- loss: 0.811315, loss_ss: 0.733798, loss_d: 0.077516
0.1150 --- loss: 1.172876, loss_ss: 0.722012, loss_d: 0.450863
0.1534 --- loss: 1.631171, loss_ss: 0.702505, loss_d: 0.928666
0.1917 --- loss: 1.450005, loss_ss: 1.055640, loss_d: 0.394364
0.2301 --- loss: 0.999224, loss_ss: 0.875861, loss_d: 0.123363
0.2684 --- loss: 1.164056, loss_ss: 0.900407, loss_d: 0.263649
0.3067 --- loss: 1.313815, loss_ss: 0.930119, loss_d: 0.383697
0.3451 --- loss: 1.211707, loss_ss: 1.035450, loss_d: 0.176258
0.3834 --- loss: 1.169438, loss_ss: 0.955875, loss_d: 0.213563
0.4218 --- loss: 0.952058, loss_ss: 0.662981, loss_d: 0.289077
0.4601 --- loss: 0.924097, loss_ss: 0.825022, loss_d: 0.099075
0.4985 --- loss: 1.121041, loss_ss: 0.970697, loss_d: 0.150344
0.5368 --- loss: 1.019200, loss_ss: 0.828382, loss_d: 0.190818
0.5752 --- loss: 1.485577, loss_ss: 1.074555, loss_d: 0.411021
0.6135 --- loss: 1.194939, loss_ss: 0.926967, loss_d: 0.267972
0.6518 --- loss: 1.146992, loss_ss: 0.937484, loss_d: 0.209508
0.6902 --- loss: 1.022895, loss_ss: 0.832173, loss_d: 0.190722
0.7285 --- loss: 1.015272, loss_ss: 0.898221, loss_d: 0.117051
0.7669 --- loss: 1.648023, loss_ss: 0.635056, loss_d: 1.012967
0.8052 --- loss: 0.941457, loss_ss: 0.725092, loss_d: 0.216365
0.8436 --- loss: 1.032655, loss_ss: 0.687125, loss_d: 0.345530
0.8819 --- loss: 0.886107, loss_ss: 0.737077, loss_d: 0.149030
0.9202 --- loss: 1.115297, loss_ss: 0.994986, loss_d: 0.120311
0.9586 --- loss: 1.604170, loss_ss: 1.159048, loss_d: 0.445123
0.9969 --- loss: 1.709268, loss_ss: 1.219752, loss_d: 0.489516
Epoch finished! Loss: 1.1418344548115364
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7655555555555555
             precision    recall  f1-score   support

        0.0       0.71      0.32      0.44        63
        1.0       0.00      0.00      0.00        22
        2.0       0.92      0.80      0.85       541
        3.0       0.99      0.82      0.90       204
        4.0       0.30      1.00      0.47        70

avg / total       0.85      0.77      0.78       900
 


====== chc012-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  94.33   31.75   99.04  71.43     43.96
1  97.56    0.00  100.00   0.00      0.00
2  83.44   79.85   88.86  91.53     85.29
3  95.67   81.86   99.71  98.82     89.54
4  82.11  100.00   80.60  30.30     46.51
Total accuracy: 76.56%
Average sen: 58.69%
Average spec: 93.64%
Macro f1-score: 53.06%
[0.84720355 0.16949186 0.37200353 0.2799291  0.1107913  0.67060173
 0.9576385  0.82289803 0.83366537 0.16427109 0.14882138 0.17119274
 0.09032452 0.22083285 0.07063241 0.12710844 0.08994585 0.05300715
 0.31771559 0.04756322 0.14608856 0.60673916 0.77707618 0.67892224
 0.46264541 0.38071352 0.03380588 0.06357934 0.0663185  0.18169409]
pred: 0.33210736997425555, label: 0
Right! Diagnosis: Other

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.502348, loss_ss: 1.831187, loss_d: 0.671162
0.0384 --- loss: 2.032262, loss_ss: 1.468338, loss_d: 0.563923
0.0767 --- loss: 2.012568, loss_ss: 1.468208, loss_d: 0.544360
0.1151 --- loss: 1.873698, loss_ss: 1.479424, loss_d: 0.394274
0.1534 --- loss: 1.870204, loss_ss: 1.358383, loss_d: 0.511822
0.1918 --- loss: 1.962231, loss_ss: 1.347406, loss_d: 0.614826
0.2301 --- loss: 2.174382, loss_ss: 1.497182, loss_d: 0.677200
0.2685 --- loss: 1.957343, loss_ss: 1.435599, loss_d: 0.521744
0.3069 --- loss: 1.977160, loss_ss: 1.491021, loss_d: 0.486139
0.3452 --- loss: 1.976881, loss_ss: 1.321412, loss_d: 0.655469
0.3836 --- loss: 1.711675, loss_ss: 1.234715, loss_d: 0.476960
0.4219 --- loss: 1.846767, loss_ss: 1.357707, loss_d: 0.489059
0.4603 --- loss: 1.764065, loss_ss: 1.266217, loss_d: 0.497848
0.4987 --- loss: 1.556178, loss_ss: 1.172846, loss_d: 0.383333
0.5370 --- loss: 2.051841, loss_ss: 1.286737, loss_d: 0.765104
0.5754 --- loss: 1.786377, loss_ss: 1.183080, loss_d: 0.603297
0.6137 --- loss: 1.829854, loss_ss: 1.166210, loss_d: 0.663643
0.6521 --- loss: 1.728045, loss_ss: 1.358818, loss_d: 0.369228
0.6904 --- loss: 1.477868, loss_ss: 1.098311, loss_d: 0.379557
0.7288 --- loss: 1.602098, loss_ss: 1.115699, loss_d: 0.486400
0.7672 --- loss: 1.733983, loss_ss: 1.215915, loss_d: 0.518068
0.8055 --- loss: 1.655662, loss_ss: 1.155308, loss_d: 0.500354
0.8439 --- loss: 1.618774, loss_ss: 1.195091, loss_d: 0.423683
0.8822 --- loss: 1.530962, loss_ss: 1.063901, loss_d: 0.467061
0.9206 --- loss: 1.733445, loss_ss: 1.187863, loss_d: 0.545582
0.9590 --- loss: 1.687172, loss_ss: 1.085785, loss_d: 0.601387
0.9973 --- loss: 1.906141, loss_ss: 1.324944, loss_d: 0.581197
Epoch finished! Loss: 1.8954980231248415
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.653228, loss_ss: 1.152019, loss_d: 0.501209
0.0384 --- loss: 1.599327, loss_ss: 1.127837, loss_d: 0.471490
0.0767 --- loss: 1.576045, loss_ss: 1.101057, loss_d: 0.474988
0.1151 --- loss: 2.015267, loss_ss: 1.556055, loss_d: 0.459212
0.1534 --- loss: 1.516992, loss_ss: 1.042595, loss_d: 0.474396
0.1918 --- loss: 1.440723, loss_ss: 1.035940, loss_d: 0.404783
0.2301 --- loss: 1.667101, loss_ss: 1.165471, loss_d: 0.501630
0.2685 --- loss: 1.654961, loss_ss: 0.937628, loss_d: 0.717334
0.3069 --- loss: 1.656698, loss_ss: 1.117670, loss_d: 0.539029
0.3452 --- loss: 1.405401, loss_ss: 1.023870, loss_d: 0.381531
0.3836 --- loss: 1.572590, loss_ss: 1.055930, loss_d: 0.516660
0.4219 --- loss: 1.455742, loss_ss: 0.929103, loss_d: 0.526639
0.4603 --- loss: 1.829391, loss_ss: 1.156009, loss_d: 0.673382
0.4987 --- loss: 1.712765, loss_ss: 1.215571, loss_d: 0.497194
0.5370 --- loss: 1.689275, loss_ss: 1.146035, loss_d: 0.543240
0.5754 --- loss: 2.033845, loss_ss: 1.267037, loss_d: 0.766808
0.6137 --- loss: 1.703763, loss_ss: 1.127644, loss_d: 0.576119
0.6521 --- loss: 1.584583, loss_ss: 1.179288, loss_d: 0.405295
0.6904 --- loss: 1.693497, loss_ss: 1.113426, loss_d: 0.580071
0.7288 --- loss: 1.615993, loss_ss: 0.986192, loss_d: 0.629801
0.7672 --- loss: 1.884457, loss_ss: 1.358500, loss_d: 0.525957
0.8055 --- loss: 2.060791, loss_ss: 0.985978, loss_d: 1.074813
0.8439 --- loss: 1.672510, loss_ss: 1.130779, loss_d: 0.541731
0.8822 --- loss: 1.949294, loss_ss: 1.320391, loss_d: 0.628903
0.9206 --- loss: 1.649333, loss_ss: 1.034252, loss_d: 0.615081
0.9590 --- loss: 1.558556, loss_ss: 0.821451, loss_d: 0.737105
0.9973 --- loss: 1.817692, loss_ss: 1.226895, loss_d: 0.590797
Epoch finished! Loss: 1.678851296351506
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.474562, loss_ss: 0.946508, loss_d: 0.528054
0.0384 --- loss: 1.763281, loss_ss: 1.261853, loss_d: 0.501428
0.0767 --- loss: 1.435476, loss_ss: 0.964982, loss_d: 0.470494
0.1151 --- loss: 1.503757, loss_ss: 1.068778, loss_d: 0.434979
0.1534 --- loss: 1.295758, loss_ss: 0.931742, loss_d: 0.364016
0.1918 --- loss: 1.331535, loss_ss: 0.983028, loss_d: 0.348506
0.2301 --- loss: 1.642451, loss_ss: 1.184679, loss_d: 0.457772
0.2685 --- loss: 1.566195, loss_ss: 1.042150, loss_d: 0.524046
0.3069 --- loss: 1.433538, loss_ss: 1.062714, loss_d: 0.370824
0.3452 --- loss: 1.423267, loss_ss: 1.032354, loss_d: 0.390914
0.3836 --- loss: 1.253617, loss_ss: 0.890055, loss_d: 0.363562
0.4219 --- loss: 1.555316, loss_ss: 1.022692, loss_d: 0.532624
0.4603 --- loss: 1.008997, loss_ss: 0.751492, loss_d: 0.257505
0.4987 --- loss: 1.761773, loss_ss: 0.882142, loss_d: 0.879631
0.5370 --- loss: 1.746182, loss_ss: 1.003500, loss_d: 0.742682
0.5754 --- loss: 1.330055, loss_ss: 0.881199, loss_d: 0.448856
0.6137 --- loss: 1.494616, loss_ss: 0.873588, loss_d: 0.621028
0.6521 --- loss: 1.814790, loss_ss: 1.026900, loss_d: 0.787890
0.6904 --- loss: 1.210396, loss_ss: 0.880820, loss_d: 0.329576
0.7288 --- loss: 1.554386, loss_ss: 0.924209, loss_d: 0.630177
0.7672 --- loss: 1.904006, loss_ss: 1.517644, loss_d: 0.386362
0.8055 --- loss: 1.519354, loss_ss: 1.118390, loss_d: 0.400964
0.8439 --- loss: 1.597507, loss_ss: 1.171401, loss_d: 0.426106
0.8822 --- loss: 1.313075, loss_ss: 0.847879, loss_d: 0.465196
0.9206 --- loss: 1.982301, loss_ss: 1.388597, loss_d: 0.593704
0.9590 --- loss: 1.796068, loss_ss: 1.112070, loss_d: 0.683998
0.9973 --- loss: 1.753175, loss_ss: 0.956356, loss_d: 0.796818
Epoch finished! Loss: 1.5637536635765663
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.375887, loss_ss: 1.015904, loss_d: 0.359984
0.0384 --- loss: 1.325228, loss_ss: 0.911018, loss_d: 0.414209
0.0767 --- loss: 1.625497, loss_ss: 0.900925, loss_d: 0.724572
0.1151 --- loss: 1.444407, loss_ss: 1.068162, loss_d: 0.376245
0.1534 --- loss: 1.163957, loss_ss: 0.947294, loss_d: 0.216663
0.1918 --- loss: 1.229040, loss_ss: 0.867815, loss_d: 0.361225
0.2301 --- loss: 1.359408, loss_ss: 0.921595, loss_d: 0.437814
0.2685 --- loss: 1.281394, loss_ss: 0.942192, loss_d: 0.339202
0.3069 --- loss: 1.223012, loss_ss: 0.904095, loss_d: 0.318917
0.3452 --- loss: 1.751961, loss_ss: 1.115186, loss_d: 0.636774
0.3836 --- loss: 1.507216, loss_ss: 0.881297, loss_d: 0.625919
0.4219 --- loss: 1.608037, loss_ss: 1.167161, loss_d: 0.440877
0.4603 --- loss: 1.355812, loss_ss: 0.810774, loss_d: 0.545038
0.4987 --- loss: 1.506503, loss_ss: 0.923325, loss_d: 0.583178
0.5370 --- loss: 0.979666, loss_ss: 0.692265, loss_d: 0.287400
0.5754 --- loss: 1.315161, loss_ss: 0.978642, loss_d: 0.336519
0.6137 --- loss: 1.512990, loss_ss: 0.868668, loss_d: 0.644322
0.6521 --- loss: 1.458395, loss_ss: 1.146225, loss_d: 0.312170
0.6904 --- loss: 1.334458, loss_ss: 0.828523, loss_d: 0.505935
0.7288 --- loss: 1.254382, loss_ss: 0.815766, loss_d: 0.438615
0.7672 --- loss: 1.576038, loss_ss: 1.294094, loss_d: 0.281944
0.8055 --- loss: 1.351160, loss_ss: 0.802594, loss_d: 0.548566
0.8439 --- loss: 1.248124, loss_ss: 0.685418, loss_d: 0.562705
0.8822 --- loss: 1.457632, loss_ss: 0.931790, loss_d: 0.525841
0.9206 --- loss: 1.572997, loss_ss: 1.021621, loss_d: 0.551376
0.9590 --- loss: 1.729750, loss_ss: 0.979491, loss_d: 0.750259
0.9973 --- loss: 1.563295, loss_ss: 1.173071, loss_d: 0.390224
Epoch finished! Loss: 1.4565304930393512
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.423191, loss_ss: 0.976438, loss_d: 0.446753
0.0384 --- loss: 1.385568, loss_ss: 0.809674, loss_d: 0.575894
0.0767 --- loss: 1.928658, loss_ss: 0.951007, loss_d: 0.977651
0.1151 --- loss: 1.528386, loss_ss: 0.819948, loss_d: 0.708438
0.1534 --- loss: 1.453467, loss_ss: 1.051430, loss_d: 0.402037
0.1918 --- loss: 1.195539, loss_ss: 0.753476, loss_d: 0.442064
0.2301 --- loss: 2.077598, loss_ss: 1.392834, loss_d: 0.684764
0.2685 --- loss: 1.390494, loss_ss: 1.030209, loss_d: 0.360284
0.3069 --- loss: 1.700928, loss_ss: 0.928715, loss_d: 0.772214
0.3452 --- loss: 1.616971, loss_ss: 0.958634, loss_d: 0.658337
0.3836 --- loss: 1.584067, loss_ss: 0.896458, loss_d: 0.687609
0.4219 --- loss: 1.379557, loss_ss: 0.919743, loss_d: 0.459815
0.4603 --- loss: 1.479068, loss_ss: 1.185915, loss_d: 0.293152
0.4987 --- loss: 1.091893, loss_ss: 0.902005, loss_d: 0.189888
0.5370 --- loss: 1.879831, loss_ss: 1.039208, loss_d: 0.840623
0.5754 --- loss: 1.073578, loss_ss: 0.756186, loss_d: 0.317392
0.6137 --- loss: 1.917980, loss_ss: 1.341990, loss_d: 0.575990
0.6521 --- loss: 1.436264, loss_ss: 0.918352, loss_d: 0.517912
0.6904 --- loss: 1.290495, loss_ss: 0.936781, loss_d: 0.353714
0.7288 --- loss: 1.506256, loss_ss: 0.990681, loss_d: 0.515575
0.7672 --- loss: 1.746850, loss_ss: 1.156940, loss_d: 0.589910
0.8055 --- loss: 1.490457, loss_ss: 0.946960, loss_d: 0.543497
0.8439 --- loss: 1.074266, loss_ss: 0.747922, loss_d: 0.326344
0.8822 --- loss: 1.275843, loss_ss: 1.037196, loss_d: 0.238646
0.9206 --- loss: 1.515658, loss_ss: 1.014372, loss_d: 0.501285
0.9590 --- loss: 1.132038, loss_ss: 0.725458, loss_d: 0.406580
0.9973 --- loss: 1.657600, loss_ss: 0.973940, loss_d: 0.683660
Epoch finished! Loss: 1.3887795645457048
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.074584, loss_ss: 0.838024, loss_d: 0.236561
0.0384 --- loss: 1.055776, loss_ss: 0.799066, loss_d: 0.256710
0.0767 --- loss: 1.227634, loss_ss: 1.031211, loss_d: 0.196423
0.1151 --- loss: 1.222776, loss_ss: 0.908640, loss_d: 0.314136
0.1534 --- loss: 0.897177, loss_ss: 0.747720, loss_d: 0.149456
0.1918 --- loss: 1.167167, loss_ss: 0.962817, loss_d: 0.204350
0.2301 --- loss: 1.331386, loss_ss: 1.105790, loss_d: 0.225596
0.2685 --- loss: 1.501085, loss_ss: 1.172715, loss_d: 0.328370
0.3069 --- loss: 1.344938, loss_ss: 1.030457, loss_d: 0.314482
0.3452 --- loss: 1.595164, loss_ss: 1.224395, loss_d: 0.370768
0.3836 --- loss: 1.388642, loss_ss: 1.061793, loss_d: 0.326849
0.4219 --- loss: 0.977514, loss_ss: 0.746073, loss_d: 0.231441
0.4603 --- loss: 0.966332, loss_ss: 0.833970, loss_d: 0.132362
0.4987 --- loss: 1.162700, loss_ss: 0.879139, loss_d: 0.283561
0.5370 --- loss: 1.327501, loss_ss: 0.994842, loss_d: 0.332659
0.5754 --- loss: 1.161773, loss_ss: 0.883459, loss_d: 0.278314
0.6137 --- loss: 1.098735, loss_ss: 0.853050, loss_d: 0.245685
0.6521 --- loss: 1.284731, loss_ss: 0.707743, loss_d: 0.576989
0.6904 --- loss: 1.139772, loss_ss: 0.747715, loss_d: 0.392057
0.7288 --- loss: 1.059870, loss_ss: 0.735735, loss_d: 0.324136
0.7672 --- loss: 1.050411, loss_ss: 0.920983, loss_d: 0.129427
0.8055 --- loss: 0.921891, loss_ss: 0.684631, loss_d: 0.237261
0.8439 --- loss: 1.203611, loss_ss: 1.005870, loss_d: 0.197741
0.8822 --- loss: 1.544829, loss_ss: 0.976049, loss_d: 0.568780
0.9206 --- loss: 1.214279, loss_ss: 0.677455, loss_d: 0.536824
0.9590 --- loss: 1.796867, loss_ss: 1.502940, loss_d: 0.293927
0.9973 --- loss: 1.812389, loss_ss: 0.949906, loss_d: 0.862483
Epoch finished! Loss: 1.3131711052014277
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.573760, loss_ss: 1.166753, loss_d: 0.407007
0.0384 --- loss: 1.257213, loss_ss: 0.995729, loss_d: 0.261484
0.0767 --- loss: 1.660844, loss_ss: 0.888913, loss_d: 0.771931
0.1151 --- loss: 1.300787, loss_ss: 1.045359, loss_d: 0.255428
0.1534 --- loss: 1.097659, loss_ss: 0.696291, loss_d: 0.401368
0.1918 --- loss: 1.330291, loss_ss: 0.757364, loss_d: 0.572927
0.2301 --- loss: 0.973441, loss_ss: 0.694325, loss_d: 0.279115
0.2685 --- loss: 1.132516, loss_ss: 0.883466, loss_d: 0.249049
0.3069 --- loss: 1.275367, loss_ss: 1.070458, loss_d: 0.204909
0.3452 --- loss: 1.455694, loss_ss: 1.217219, loss_d: 0.238475
0.3836 --- loss: 1.251557, loss_ss: 0.997562, loss_d: 0.253996
0.4219 --- loss: 1.618059, loss_ss: 0.921264, loss_d: 0.696794
0.4603 --- loss: 1.536124, loss_ss: 0.885211, loss_d: 0.650913
0.4987 --- loss: 1.217559, loss_ss: 0.953191, loss_d: 0.264368
0.5370 --- loss: 1.214539, loss_ss: 0.817216, loss_d: 0.397323
0.5754 --- loss: 0.887834, loss_ss: 0.718787, loss_d: 0.169047
0.6137 --- loss: 1.135789, loss_ss: 0.983421, loss_d: 0.152368
0.6521 --- loss: 1.005620, loss_ss: 0.836077, loss_d: 0.169543
0.6904 --- loss: 0.963503, loss_ss: 0.797499, loss_d: 0.166005
0.7288 --- loss: 1.177906, loss_ss: 0.917412, loss_d: 0.260494
0.7672 --- loss: 1.005613, loss_ss: 0.815379, loss_d: 0.190234
0.8055 --- loss: 0.957978, loss_ss: 0.810061, loss_d: 0.147918
0.8439 --- loss: 1.393979, loss_ss: 0.916992, loss_d: 0.476988
0.8822 --- loss: 1.083823, loss_ss: 0.962765, loss_d: 0.121058
0.9206 --- loss: 1.143421, loss_ss: 0.711713, loss_d: 0.431708
0.9590 --- loss: 1.312982, loss_ss: 0.674301, loss_d: 0.638681
0.9973 --- loss: 1.535529, loss_ss: 0.713374, loss_d: 0.822156
Epoch finished! Loss: 1.2382583553974444
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.182101, loss_ss: 0.985084, loss_d: 0.197016
0.0384 --- loss: 1.249775, loss_ss: 0.885394, loss_d: 0.364381
0.0767 --- loss: 1.297269, loss_ss: 1.066561, loss_d: 0.230707
0.1151 --- loss: 1.475608, loss_ss: 0.808729, loss_d: 0.666879
0.1534 --- loss: 1.123025, loss_ss: 0.895612, loss_d: 0.227412
0.1918 --- loss: 1.083331, loss_ss: 0.931218, loss_d: 0.152114
0.2301 --- loss: 1.016449, loss_ss: 0.852605, loss_d: 0.163844
0.2685 --- loss: 1.474361, loss_ss: 0.928824, loss_d: 0.545537
0.3069 --- loss: 1.303080, loss_ss: 1.145173, loss_d: 0.157907
0.3452 --- loss: 1.110281, loss_ss: 0.830753, loss_d: 0.279528
0.3836 --- loss: 0.990113, loss_ss: 0.762807, loss_d: 0.227306
0.4219 --- loss: 0.934600, loss_ss: 0.702690, loss_d: 0.231910
0.4603 --- loss: 1.355954, loss_ss: 1.018828, loss_d: 0.337126
0.4987 --- loss: 0.981815, loss_ss: 0.830617, loss_d: 0.151198
0.5370 --- loss: 1.276241, loss_ss: 0.924779, loss_d: 0.351463
0.5754 --- loss: 0.755794, loss_ss: 0.605307, loss_d: 0.150487
0.6137 --- loss: 1.421863, loss_ss: 0.910346, loss_d: 0.511517
0.6521 --- loss: 1.166708, loss_ss: 1.008450, loss_d: 0.158259
0.6904 --- loss: 1.271668, loss_ss: 1.047454, loss_d: 0.224214
0.7288 --- loss: 1.233729, loss_ss: 0.881282, loss_d: 0.352448
0.7672 --- loss: 0.934836, loss_ss: 0.813945, loss_d: 0.120891
0.8055 --- loss: 1.353949, loss_ss: 0.941328, loss_d: 0.412621
0.8439 --- loss: 1.181982, loss_ss: 0.711589, loss_d: 0.470394
0.8822 --- loss: 0.791756, loss_ss: 0.643313, loss_d: 0.148443
0.9206 --- loss: 0.839665, loss_ss: 0.733392, loss_d: 0.106273
0.9590 --- loss: 1.165722, loss_ss: 1.021785, loss_d: 0.143937
0.9973 --- loss: 1.061783, loss_ss: 0.933852, loss_d: 0.127931
Epoch finished! Loss: 1.1993401089539895
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.345250, loss_ss: 1.043338, loss_d: 0.301912
0.0384 --- loss: 1.382181, loss_ss: 1.115865, loss_d: 0.266315
0.0767 --- loss: 1.531627, loss_ss: 1.260787, loss_d: 0.270840
0.1151 --- loss: 0.997947, loss_ss: 0.785300, loss_d: 0.212646
0.1534 --- loss: 1.276075, loss_ss: 1.079390, loss_d: 0.196686
0.1918 --- loss: 1.261510, loss_ss: 1.033844, loss_d: 0.227666
0.2301 --- loss: 1.445500, loss_ss: 0.994299, loss_d: 0.451201
0.2685 --- loss: 1.322632, loss_ss: 0.894414, loss_d: 0.428218
0.3069 --- loss: 1.542876, loss_ss: 1.170016, loss_d: 0.372860
0.3452 --- loss: 1.218031, loss_ss: 0.581739, loss_d: 0.636293
0.3836 --- loss: 1.088721, loss_ss: 0.885079, loss_d: 0.203642
0.4219 --- loss: 1.089561, loss_ss: 0.850377, loss_d: 0.239184
0.4603 --- loss: 1.265506, loss_ss: 0.916282, loss_d: 0.349224
0.4987 --- loss: 0.957559, loss_ss: 0.822057, loss_d: 0.135502
0.5370 --- loss: 1.102292, loss_ss: 0.933181, loss_d: 0.169112
0.5754 --- loss: 0.779663, loss_ss: 0.606782, loss_d: 0.172881
0.6137 --- loss: 1.109038, loss_ss: 0.876818, loss_d: 0.232220
0.6521 --- loss: 0.967460, loss_ss: 0.792977, loss_d: 0.174483
0.6904 --- loss: 0.980657, loss_ss: 0.842486, loss_d: 0.138171
0.7288 --- loss: 0.774963, loss_ss: 0.497937, loss_d: 0.277025
0.7672 --- loss: 0.901347, loss_ss: 0.807127, loss_d: 0.094220
0.8055 --- loss: 1.180296, loss_ss: 0.833862, loss_d: 0.346435
0.8439 --- loss: 1.301040, loss_ss: 0.889792, loss_d: 0.411248
0.8822 --- loss: 0.792586, loss_ss: 0.624482, loss_d: 0.168104
0.9206 --- loss: 1.011858, loss_ss: 0.813196, loss_d: 0.198662
0.9590 --- loss: 0.893096, loss_ss: 0.784383, loss_d: 0.108713
0.9973 --- loss: 0.823641, loss_ss: 0.706024, loss_d: 0.117617
Epoch finished! Loss: 1.1695819646120071
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.923976, loss_ss: 0.666881, loss_d: 0.257095
0.0384 --- loss: 1.297485, loss_ss: 0.846908, loss_d: 0.450577
0.0767 --- loss: 1.132087, loss_ss: 0.874449, loss_d: 0.257639
0.1151 --- loss: 1.415540, loss_ss: 1.118953, loss_d: 0.296587
0.1534 --- loss: 0.833560, loss_ss: 0.731940, loss_d: 0.101620
0.1918 --- loss: 1.347663, loss_ss: 0.671898, loss_d: 0.675765
0.2301 --- loss: 0.919223, loss_ss: 0.720707, loss_d: 0.198516
0.2685 --- loss: 0.983233, loss_ss: 0.896227, loss_d: 0.087007
0.3069 --- loss: 1.323478, loss_ss: 0.838432, loss_d: 0.485046
0.3452 --- loss: 1.537278, loss_ss: 1.016463, loss_d: 0.520815
0.3836 --- loss: 0.969645, loss_ss: 0.719650, loss_d: 0.249994
0.4219 --- loss: 1.084865, loss_ss: 0.702948, loss_d: 0.381917
0.4603 --- loss: 0.780617, loss_ss: 0.658199, loss_d: 0.122418
0.4987 --- loss: 1.023602, loss_ss: 0.952141, loss_d: 0.071462
0.5370 --- loss: 0.915264, loss_ss: 0.612992, loss_d: 0.302272
0.5754 --- loss: 0.955402, loss_ss: 0.817172, loss_d: 0.138231
0.6137 --- loss: 1.118735, loss_ss: 1.033219, loss_d: 0.085516
0.6521 --- loss: 1.002586, loss_ss: 0.867305, loss_d: 0.135281
0.6904 --- loss: 0.821627, loss_ss: 0.685807, loss_d: 0.135820
0.7288 --- loss: 1.052953, loss_ss: 0.922704, loss_d: 0.130248
0.7672 --- loss: 0.815633, loss_ss: 0.731488, loss_d: 0.084144
0.8055 --- loss: 0.869497, loss_ss: 0.786537, loss_d: 0.082961
0.8439 --- loss: 2.010561, loss_ss: 0.928111, loss_d: 1.082450
0.8822 --- loss: 1.730297, loss_ss: 0.730495, loss_d: 0.999802
0.9206 --- loss: 1.348951, loss_ss: 0.910931, loss_d: 0.438020
0.9590 --- loss: 1.139138, loss_ss: 0.848624, loss_d: 0.290514
0.9973 --- loss: 1.106034, loss_ss: 1.001934, loss_d: 0.104100
Epoch finished! Loss: 1.10637271633515
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7365591397849462
             precision    recall  f1-score   support

        0.0       0.58      0.90      0.70        69
        1.0       0.22      0.13      0.16        38
        2.0       0.78      0.78      0.78       434
        3.0       1.00      0.64      0.78       228
        4.0       0.60      0.84      0.70       161

avg / total       0.77      0.74      0.74       930
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.41  89.86   94.77   57.94     70.45
1  94.52  13.16   97.98   21.74     16.39
2  79.57  77.65   81.25   78.37     78.01
3  91.18  64.04  100.00  100.00     78.07
4  87.63  83.85   88.43   60.27     70.13
Total accuracy: 73.66%
Average sen: 65.71%
Average spec: 92.49%
Macro f1-score: 62.61%
[0.89805186 0.97889841 0.98956364 0.98860431 0.98407876 0.96960855
 0.9601872  0.99686486 0.99079776 0.95693457 0.97888499 0.99773431
 0.83700693 0.94002622 0.77613693 0.97184348 0.97383797 0.92152339
 0.97282851 0.76881909 0.64188576 0.60918182 0.37717497 0.92229205
 0.99599826 0.99027389 0.35060391 0.2878952  0.3797605  0.60331106
 0.42044646]
pred: 0.8203566333939952, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.424319, loss_ss: 1.690260, loss_d: 0.734059
0.0384 --- loss: 2.244247, loss_ss: 1.610927, loss_d: 0.633320
0.0767 --- loss: 2.312029, loss_ss: 1.606408, loss_d: 0.705621
0.1151 --- loss: 2.022223, loss_ss: 1.280576, loss_d: 0.741647
0.1534 --- loss: 1.919590, loss_ss: 1.441374, loss_d: 0.478217
0.1918 --- loss: 1.770553, loss_ss: 1.348304, loss_d: 0.422249
0.2301 --- loss: 1.852427, loss_ss: 1.446946, loss_d: 0.405480
0.2685 --- loss: 1.958865, loss_ss: 1.404937, loss_d: 0.553928
0.3069 --- loss: 2.002721, loss_ss: 1.497812, loss_d: 0.504909
0.3452 --- loss: 1.710924, loss_ss: 1.339532, loss_d: 0.371392
0.3836 --- loss: 2.083203, loss_ss: 1.238531, loss_d: 0.844673
0.4219 --- loss: 2.238935, loss_ss: 1.485959, loss_d: 0.752976
0.4603 --- loss: 1.746941, loss_ss: 1.236526, loss_d: 0.510416
0.4987 --- loss: 1.899523, loss_ss: 1.196105, loss_d: 0.703417
0.5370 --- loss: 1.812310, loss_ss: 1.304285, loss_d: 0.508025
0.5754 --- loss: 1.678556, loss_ss: 1.338574, loss_d: 0.339981
0.6137 --- loss: 1.905769, loss_ss: 1.371618, loss_d: 0.534151
0.6521 --- loss: 2.140829, loss_ss: 1.553214, loss_d: 0.587615
0.6904 --- loss: 1.551889, loss_ss: 1.317868, loss_d: 0.234021
0.7288 --- loss: 1.529616, loss_ss: 1.188199, loss_d: 0.341417
0.7672 --- loss: 1.693031, loss_ss: 1.209052, loss_d: 0.483980
0.8055 --- loss: 1.718529, loss_ss: 1.236283, loss_d: 0.482245
0.8439 --- loss: 1.718425, loss_ss: 1.067152, loss_d: 0.651273
0.8822 --- loss: 2.148242, loss_ss: 1.382643, loss_d: 0.765599
0.9206 --- loss: 1.601402, loss_ss: 1.240047, loss_d: 0.361355
0.9590 --- loss: 2.027029, loss_ss: 1.142201, loss_d: 0.884828
0.9973 --- loss: 1.645952, loss_ss: 1.039125, loss_d: 0.606827
Epoch finished! Loss: 1.9265877503615159
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.008757, loss_ss: 1.510209, loss_d: 0.498547
0.0384 --- loss: 1.787616, loss_ss: 1.102035, loss_d: 0.685581
0.0767 --- loss: 1.586355, loss_ss: 1.155439, loss_d: 0.430916
0.1151 --- loss: 1.811739, loss_ss: 0.941600, loss_d: 0.870139
0.1534 --- loss: 1.950917, loss_ss: 1.110384, loss_d: 0.840533
0.1918 --- loss: 1.688083, loss_ss: 1.230716, loss_d: 0.457368
0.2301 --- loss: 1.825562, loss_ss: 1.091718, loss_d: 0.733844
0.2685 --- loss: 1.507358, loss_ss: 1.097728, loss_d: 0.409630
0.3069 --- loss: 1.442486, loss_ss: 1.115518, loss_d: 0.326968
0.3452 --- loss: 1.742400, loss_ss: 1.182309, loss_d: 0.560091
0.3836 --- loss: 1.549748, loss_ss: 1.263749, loss_d: 0.285998
0.4219 --- loss: 1.515033, loss_ss: 1.007732, loss_d: 0.507302
0.4603 --- loss: 1.615047, loss_ss: 1.155903, loss_d: 0.459143
0.4987 --- loss: 1.709336, loss_ss: 1.064984, loss_d: 0.644352
0.5370 --- loss: 1.651136, loss_ss: 1.328519, loss_d: 0.322617
0.5754 --- loss: 1.493743, loss_ss: 0.967416, loss_d: 0.526327
0.6137 --- loss: 1.651386, loss_ss: 1.108831, loss_d: 0.542555
0.6521 --- loss: 1.746580, loss_ss: 0.977402, loss_d: 0.769178
0.6904 --- loss: 1.609470, loss_ss: 0.903365, loss_d: 0.706105
0.7288 --- loss: 1.759859, loss_ss: 0.998731, loss_d: 0.761129
0.7672 --- loss: 1.575094, loss_ss: 1.077551, loss_d: 0.497543
0.8055 --- loss: 1.484596, loss_ss: 0.972803, loss_d: 0.511793
0.8439 --- loss: 1.767339, loss_ss: 1.133748, loss_d: 0.633591
0.8822 --- loss: 1.375927, loss_ss: 0.850109, loss_d: 0.525818
0.9206 --- loss: 1.991854, loss_ss: 1.316081, loss_d: 0.675773
0.9590 --- loss: 1.897925, loss_ss: 1.070911, loss_d: 0.827014
0.9973 --- loss: 1.149679, loss_ss: 0.776879, loss_d: 0.372800
Epoch finished! Loss: 1.6898278598602001
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.714463, loss_ss: 1.090224, loss_d: 0.624239
0.0384 --- loss: 1.746633, loss_ss: 1.072964, loss_d: 0.673669
0.0767 --- loss: 1.713003, loss_ss: 1.220188, loss_d: 0.492815
0.1151 --- loss: 1.808174, loss_ss: 1.200068, loss_d: 0.608106
0.1534 --- loss: 1.261160, loss_ss: 0.922829, loss_d: 0.338330
0.1918 --- loss: 1.167795, loss_ss: 0.794891, loss_d: 0.372904
0.2301 --- loss: 1.188843, loss_ss: 0.712151, loss_d: 0.476692
0.2685 --- loss: 2.147329, loss_ss: 1.019687, loss_d: 1.127642
0.3069 --- loss: 1.739657, loss_ss: 1.157336, loss_d: 0.582322
0.3452 --- loss: 1.405120, loss_ss: 0.715381, loss_d: 0.689739
0.3836 --- loss: 1.158540, loss_ss: 0.886792, loss_d: 0.271747
0.4219 --- loss: 1.573824, loss_ss: 0.837103, loss_d: 0.736721
0.4603 --- loss: 1.473432, loss_ss: 0.885020, loss_d: 0.588412
0.4987 --- loss: 1.885610, loss_ss: 1.309358, loss_d: 0.576252
0.5370 --- loss: 1.584172, loss_ss: 1.060990, loss_d: 0.523182
0.5754 --- loss: 1.394291, loss_ss: 1.006077, loss_d: 0.388214
0.6137 --- loss: 1.196007, loss_ss: 0.784370, loss_d: 0.411636
0.6521 --- loss: 1.552706, loss_ss: 1.118103, loss_d: 0.434604
0.6904 --- loss: 1.703667, loss_ss: 1.110363, loss_d: 0.593304
0.7288 --- loss: 1.310678, loss_ss: 0.943949, loss_d: 0.366729
0.7672 --- loss: 1.178221, loss_ss: 0.876432, loss_d: 0.301789
0.8055 --- loss: 1.662515, loss_ss: 1.221084, loss_d: 0.441431
0.8439 --- loss: 1.604374, loss_ss: 1.224659, loss_d: 0.379716
0.8822 --- loss: 1.371088, loss_ss: 0.953163, loss_d: 0.417925
0.9206 --- loss: 1.456298, loss_ss: 0.942352, loss_d: 0.513946
0.9590 --- loss: 1.519638, loss_ss: 0.967457, loss_d: 0.552180
0.9973 --- loss: 1.595282, loss_ss: 0.853522, loss_d: 0.741759
Epoch finished! Loss: 1.5709520789293143
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.607279, loss_ss: 1.136943, loss_d: 0.470336
0.0384 --- loss: 1.204727, loss_ss: 0.791861, loss_d: 0.412866
0.0767 --- loss: 1.349887, loss_ss: 0.928250, loss_d: 0.421637
0.1151 --- loss: 1.718494, loss_ss: 0.841872, loss_d: 0.876623
0.1534 --- loss: 1.474160, loss_ss: 1.092878, loss_d: 0.381281
0.1918 --- loss: 1.566989, loss_ss: 1.044614, loss_d: 0.522375
0.2301 --- loss: 1.863600, loss_ss: 0.928282, loss_d: 0.935318
0.2685 --- loss: 1.260199, loss_ss: 0.688747, loss_d: 0.571453
0.3069 --- loss: 1.992700, loss_ss: 1.175205, loss_d: 0.817495
0.3452 --- loss: 1.333291, loss_ss: 1.041589, loss_d: 0.291702
0.3836 --- loss: 1.212443, loss_ss: 0.839030, loss_d: 0.373412
0.4219 --- loss: 2.032382, loss_ss: 1.211653, loss_d: 0.820729
0.4603 --- loss: 1.232589, loss_ss: 0.870954, loss_d: 0.361635
0.4987 --- loss: 1.473484, loss_ss: 0.910816, loss_d: 0.562668
0.5370 --- loss: 1.271353, loss_ss: 0.863095, loss_d: 0.408259
0.5754 --- loss: 1.410128, loss_ss: 1.082249, loss_d: 0.327879
0.6137 --- loss: 1.355506, loss_ss: 0.698827, loss_d: 0.656678
0.6521 --- loss: 1.310451, loss_ss: 0.796278, loss_d: 0.514173
0.6904 --- loss: 2.020329, loss_ss: 1.297058, loss_d: 0.723271
0.7288 --- loss: 1.705822, loss_ss: 0.980217, loss_d: 0.725605
0.7672 --- loss: 2.178177, loss_ss: 1.791270, loss_d: 0.386907
0.8055 --- loss: 1.700075, loss_ss: 1.176029, loss_d: 0.524046
0.8439 --- loss: 1.099184, loss_ss: 0.781468, loss_d: 0.317716
0.8822 --- loss: 1.588207, loss_ss: 0.875579, loss_d: 0.712628
0.9206 --- loss: 1.418054, loss_ss: 0.959159, loss_d: 0.458895
0.9590 --- loss: 1.562540, loss_ss: 0.840307, loss_d: 0.722233
0.9973 --- loss: 1.530413, loss_ss: 1.154595, loss_d: 0.375818
Epoch finished! Loss: 1.501234026138599
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.382257, loss_ss: 0.778640, loss_d: 0.603616
0.0384 --- loss: 1.498181, loss_ss: 1.031028, loss_d: 0.467152
0.0767 --- loss: 1.559695, loss_ss: 1.020898, loss_d: 0.538797
0.1151 --- loss: 1.527517, loss_ss: 1.072462, loss_d: 0.455055
0.1534 --- loss: 1.563879, loss_ss: 1.019107, loss_d: 0.544772
0.1918 --- loss: 1.043929, loss_ss: 0.705526, loss_d: 0.338403
0.2301 --- loss: 1.501378, loss_ss: 1.187446, loss_d: 0.313932
0.2685 --- loss: 1.687204, loss_ss: 1.413825, loss_d: 0.273379
0.3069 --- loss: 1.021756, loss_ss: 0.668398, loss_d: 0.353358
0.3452 --- loss: 1.419257, loss_ss: 0.924550, loss_d: 0.494707
0.3836 --- loss: 0.967118, loss_ss: 0.545781, loss_d: 0.421337
0.4219 --- loss: 1.293722, loss_ss: 0.770660, loss_d: 0.523062
0.4603 --- loss: 1.302005, loss_ss: 1.010594, loss_d: 0.291411
0.4987 --- loss: 1.110701, loss_ss: 0.847426, loss_d: 0.263275
0.5370 --- loss: 1.257787, loss_ss: 0.835040, loss_d: 0.422747
0.5754 --- loss: 1.361524, loss_ss: 1.119036, loss_d: 0.242487
0.6137 --- loss: 1.249783, loss_ss: 0.723871, loss_d: 0.525912
0.6521 --- loss: 1.282641, loss_ss: 0.863510, loss_d: 0.419130
0.6904 --- loss: 1.531728, loss_ss: 1.241058, loss_d: 0.290670
0.7288 --- loss: 1.337212, loss_ss: 0.869742, loss_d: 0.467470
0.7672 --- loss: 1.152336, loss_ss: 0.810302, loss_d: 0.342034
0.8055 --- loss: 1.783769, loss_ss: 1.020018, loss_d: 0.763750
0.8439 --- loss: 1.540383, loss_ss: 0.947034, loss_d: 0.593349
0.8822 --- loss: 1.205108, loss_ss: 0.648275, loss_d: 0.556834
0.9206 --- loss: 1.212143, loss_ss: 0.697926, loss_d: 0.514217
0.9590 --- loss: 1.916041, loss_ss: 1.634744, loss_d: 0.281297
0.9973 --- loss: 1.199240, loss_ss: 0.976324, loss_d: 0.222916
Epoch finished! Loss: 1.410376797272609
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.092739, loss_ss: 0.902920, loss_d: 0.189819
0.0384 --- loss: 1.765280, loss_ss: 1.228216, loss_d: 0.537064
0.0767 --- loss: 1.640743, loss_ss: 1.344687, loss_d: 0.296057
0.1151 --- loss: 1.620828, loss_ss: 0.830096, loss_d: 0.790732
0.1534 --- loss: 1.344242, loss_ss: 0.855322, loss_d: 0.488920
0.1918 --- loss: 1.080799, loss_ss: 0.657798, loss_d: 0.423000
0.2301 --- loss: 1.207147, loss_ss: 0.894253, loss_d: 0.312895
0.2685 --- loss: 1.266501, loss_ss: 1.054324, loss_d: 0.212177
0.3069 --- loss: 1.005369, loss_ss: 0.796519, loss_d: 0.208850
0.3452 --- loss: 1.339597, loss_ss: 1.082976, loss_d: 0.256620
0.3836 --- loss: 1.101444, loss_ss: 0.819129, loss_d: 0.282315
0.4219 --- loss: 1.183508, loss_ss: 0.929511, loss_d: 0.253997
0.4603 --- loss: 1.249014, loss_ss: 1.021699, loss_d: 0.227315
0.4987 --- loss: 1.109603, loss_ss: 0.787900, loss_d: 0.321703
0.5370 --- loss: 0.816522, loss_ss: 0.624899, loss_d: 0.191624
0.5754 --- loss: 1.437346, loss_ss: 0.960557, loss_d: 0.476789
0.6137 --- loss: 1.305299, loss_ss: 0.994999, loss_d: 0.310299
0.6521 --- loss: 0.923457, loss_ss: 0.774925, loss_d: 0.148532
0.6904 --- loss: 1.413641, loss_ss: 1.232309, loss_d: 0.181332
0.7288 --- loss: 1.308444, loss_ss: 1.020517, loss_d: 0.287927
0.7672 --- loss: 1.344227, loss_ss: 1.037507, loss_d: 0.306720
0.8055 --- loss: 0.825534, loss_ss: 0.659083, loss_d: 0.166451
0.8439 --- loss: 1.508604, loss_ss: 1.031215, loss_d: 0.477389
0.8822 --- loss: 1.028458, loss_ss: 0.775663, loss_d: 0.252795
0.9206 --- loss: 1.164699, loss_ss: 0.946850, loss_d: 0.217849
0.9590 --- loss: 1.091526, loss_ss: 0.727442, loss_d: 0.364084
0.9973 --- loss: 1.348665, loss_ss: 1.031888, loss_d: 0.316777
Epoch finished! Loss: 1.3016651738148468
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.488672, loss_ss: 0.917968, loss_d: 0.570704
0.0384 --- loss: 1.718963, loss_ss: 1.087570, loss_d: 0.631393
0.0767 --- loss: 1.114705, loss_ss: 0.688992, loss_d: 0.425713
0.1151 --- loss: 1.397454, loss_ss: 1.081731, loss_d: 0.315723
0.1534 --- loss: 1.106344, loss_ss: 0.773527, loss_d: 0.332817
0.1918 --- loss: 1.477052, loss_ss: 0.926250, loss_d: 0.550802
0.2301 --- loss: 0.937645, loss_ss: 0.700357, loss_d: 0.237288
0.2685 --- loss: 1.291019, loss_ss: 1.032401, loss_d: 0.258618
0.3069 --- loss: 1.011601, loss_ss: 0.787068, loss_d: 0.224533
0.3452 --- loss: 1.221663, loss_ss: 1.041680, loss_d: 0.179983
0.3836 --- loss: 0.873364, loss_ss: 0.736458, loss_d: 0.136905
0.4219 --- loss: 1.808517, loss_ss: 1.082442, loss_d: 0.726075
0.4603 --- loss: 1.094697, loss_ss: 0.871393, loss_d: 0.223304
0.4987 --- loss: 1.156724, loss_ss: 0.800325, loss_d: 0.356399
0.5370 --- loss: 1.291630, loss_ss: 1.008412, loss_d: 0.283217
0.5754 --- loss: 1.287002, loss_ss: 1.126963, loss_d: 0.160039
0.6137 --- loss: 1.362733, loss_ss: 0.963985, loss_d: 0.398748
0.6521 --- loss: 1.474884, loss_ss: 1.144341, loss_d: 0.330543
0.6904 --- loss: 1.230125, loss_ss: 1.079973, loss_d: 0.150152
0.7288 --- loss: 0.913756, loss_ss: 0.686142, loss_d: 0.227614
0.7672 --- loss: 1.122180, loss_ss: 0.961340, loss_d: 0.160839
0.8055 --- loss: 1.060132, loss_ss: 0.754570, loss_d: 0.305562
0.8439 --- loss: 1.155991, loss_ss: 0.705235, loss_d: 0.450755
0.8822 --- loss: 1.203824, loss_ss: 0.666616, loss_d: 0.537207
0.9206 --- loss: 1.104269, loss_ss: 0.873375, loss_d: 0.230894
0.9590 --- loss: 1.303220, loss_ss: 0.998667, loss_d: 0.304553
0.9973 --- loss: 0.772979, loss_ss: 0.611286, loss_d: 0.161693
Epoch finished! Loss: 1.2412969442514272
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.153445, loss_ss: 0.815309, loss_d: 0.338136
0.0384 --- loss: 1.062483, loss_ss: 0.765840, loss_d: 0.296643
0.0767 --- loss: 1.098146, loss_ss: 0.702694, loss_d: 0.395452
0.1151 --- loss: 1.636995, loss_ss: 0.831153, loss_d: 0.805841
0.1534 --- loss: 1.288407, loss_ss: 0.893298, loss_d: 0.395110
0.1918 --- loss: 1.015189, loss_ss: 0.821581, loss_d: 0.193608
0.2301 --- loss: 1.111257, loss_ss: 0.899433, loss_d: 0.211825
0.2685 --- loss: 0.915451, loss_ss: 0.817248, loss_d: 0.098202
0.3069 --- loss: 0.902625, loss_ss: 0.751947, loss_d: 0.150679
0.3452 --- loss: 1.019404, loss_ss: 0.909930, loss_d: 0.109474
0.3836 --- loss: 1.026849, loss_ss: 0.751182, loss_d: 0.275667
0.4219 --- loss: 0.906831, loss_ss: 0.767095, loss_d: 0.139736
0.4603 --- loss: 1.002541, loss_ss: 0.960054, loss_d: 0.042486
0.4987 --- loss: 2.545181, loss_ss: 0.723274, loss_d: 1.821907
0.5370 --- loss: 1.481504, loss_ss: 0.864966, loss_d: 0.616538
0.5754 --- loss: 1.396576, loss_ss: 0.809254, loss_d: 0.587322
0.6137 --- loss: 1.399283, loss_ss: 0.825424, loss_d: 0.573859
0.6521 --- loss: 1.056403, loss_ss: 0.904402, loss_d: 0.152001
0.6904 --- loss: 1.243603, loss_ss: 0.832987, loss_d: 0.410615
0.7288 --- loss: 1.049677, loss_ss: 0.929053, loss_d: 0.120624
0.7672 --- loss: 1.440776, loss_ss: 0.676392, loss_d: 0.764384
0.8055 --- loss: 1.076596, loss_ss: 0.941887, loss_d: 0.134709
0.8439 --- loss: 1.127806, loss_ss: 0.648570, loss_d: 0.479236
0.8822 --- loss: 1.752596, loss_ss: 1.158591, loss_d: 0.594005
0.9206 --- loss: 1.072956, loss_ss: 0.835667, loss_d: 0.237289
0.9590 --- loss: 1.218428, loss_ss: 0.725675, loss_d: 0.492753
0.9973 --- loss: 1.202973, loss_ss: 0.842251, loss_d: 0.360722
Epoch finished! Loss: 1.1783239254584679
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.146200, loss_ss: 0.894722, loss_d: 0.251478
0.0384 --- loss: 1.102275, loss_ss: 0.960661, loss_d: 0.141615
0.0767 --- loss: 1.308005, loss_ss: 0.998795, loss_d: 0.309210
0.1151 --- loss: 1.075701, loss_ss: 0.881150, loss_d: 0.194551
0.1534 --- loss: 1.278617, loss_ss: 0.905002, loss_d: 0.373616
0.1918 --- loss: 1.247909, loss_ss: 0.995971, loss_d: 0.251938
0.2301 --- loss: 1.483846, loss_ss: 0.990437, loss_d: 0.493409
0.2685 --- loss: 1.028501, loss_ss: 0.814323, loss_d: 0.214178
0.3069 --- loss: 1.417254, loss_ss: 0.634244, loss_d: 0.783010
0.3452 --- loss: 0.961897, loss_ss: 0.763392, loss_d: 0.198505
0.3836 --- loss: 2.066087, loss_ss: 0.542267, loss_d: 1.523820
0.4219 --- loss: 1.322327, loss_ss: 1.073382, loss_d: 0.248946
0.4603 --- loss: 0.807262, loss_ss: 0.683057, loss_d: 0.124205
0.4987 --- loss: 0.910865, loss_ss: 0.766915, loss_d: 0.143950
0.5370 --- loss: 1.094711, loss_ss: 0.642808, loss_d: 0.451903
0.5754 --- loss: 0.698195, loss_ss: 0.597901, loss_d: 0.100294
0.6137 --- loss: 1.516571, loss_ss: 1.031578, loss_d: 0.484993
0.6521 --- loss: 1.313269, loss_ss: 1.135837, loss_d: 0.177431
0.6904 --- loss: 1.050710, loss_ss: 0.731696, loss_d: 0.319014
0.7288 --- loss: 1.060434, loss_ss: 0.957544, loss_d: 0.102890
0.7672 --- loss: 0.963123, loss_ss: 0.840302, loss_d: 0.122821
0.8055 --- loss: 0.963466, loss_ss: 0.709110, loss_d: 0.254356
0.8439 --- loss: 0.723548, loss_ss: 0.577627, loss_d: 0.145921
0.8822 --- loss: 1.069877, loss_ss: 0.912316, loss_d: 0.157561
0.9206 --- loss: 0.867997, loss_ss: 0.650770, loss_d: 0.217226
0.9590 --- loss: 1.122296, loss_ss: 0.701769, loss_d: 0.420527
0.9973 --- loss: 0.938870, loss_ss: 0.803739, loss_d: 0.135130
Epoch finished! Loss: 1.1545176558769665
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.995100, loss_ss: 0.838484, loss_d: 0.156615
0.0384 --- loss: 0.885183, loss_ss: 0.753946, loss_d: 0.131237
0.0767 --- loss: 1.036854, loss_ss: 0.796232, loss_d: 0.240621
0.1151 --- loss: 0.874458, loss_ss: 0.751324, loss_d: 0.123134
0.1534 --- loss: 1.297471, loss_ss: 0.796532, loss_d: 0.500938
0.1918 --- loss: 1.091867, loss_ss: 0.785399, loss_d: 0.306468
0.2301 --- loss: 1.192647, loss_ss: 0.939495, loss_d: 0.253151
0.2685 --- loss: 1.097564, loss_ss: 0.835049, loss_d: 0.262515
0.3069 --- loss: 0.908438, loss_ss: 0.574991, loss_d: 0.333446
0.3452 --- loss: 0.741347, loss_ss: 0.535979, loss_d: 0.205368
0.3836 --- loss: 0.708712, loss_ss: 0.633563, loss_d: 0.075149
0.4219 --- loss: 0.882492, loss_ss: 0.756191, loss_d: 0.126301
0.4603 --- loss: 1.542107, loss_ss: 1.454636, loss_d: 0.087471
0.4987 --- loss: 0.818280, loss_ss: 0.716492, loss_d: 0.101788
0.5370 --- loss: 1.003962, loss_ss: 0.732508, loss_d: 0.271454
0.5754 --- loss: 0.924192, loss_ss: 0.718298, loss_d: 0.205894
0.6137 --- loss: 0.946825, loss_ss: 0.815079, loss_d: 0.131746
0.6521 --- loss: 1.058522, loss_ss: 0.992828, loss_d: 0.065694
0.6904 --- loss: 0.833345, loss_ss: 0.738972, loss_d: 0.094374
0.7288 --- loss: 1.063357, loss_ss: 0.782047, loss_d: 0.281310
0.7672 --- loss: 0.781178, loss_ss: 0.574100, loss_d: 0.207077
0.8055 --- loss: 1.438008, loss_ss: 0.876523, loss_d: 0.561485
0.8439 --- loss: 0.800936, loss_ss: 0.636856, loss_d: 0.164080
0.8822 --- loss: 0.876008, loss_ss: 0.759442, loss_d: 0.116566
0.9206 --- loss: 0.903286, loss_ss: 0.778848, loss_d: 0.124438
0.9590 --- loss: 0.957741, loss_ss: 0.723021, loss_d: 0.234720
0.9973 --- loss: 0.798986, loss_ss: 0.716082, loss_d: 0.082904
Epoch finished! Loss: 1.0938268631696701
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.9333333333333333
             precision    recall  f1-score   support

        0.0       0.96      0.98      0.97       240
        1.0       0.33      0.17      0.22         6
        2.0       0.92      0.96      0.94       439
        3.0       0.99      0.87      0.93       170
        4.0       0.86      0.81      0.84        75

avg / total       0.93      0.93      0.93       930
 


====== chc014-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  98.49  97.92   98.70  96.31     97.11
1  99.25  16.67   99.78  33.33     22.22
2  94.09  96.36   92.06  91.56     93.90
3  97.42  87.06   99.74  98.67     92.50
4  97.42  81.33   98.83  85.92     83.56
Total accuracy: 93.33%
Average sen: 75.87%
Average spec: 97.82%
Macro f1-score: 77.86%
[0.03714993 0.01129617 0.05079328 0.03178518 0.00650476 0.02132463
 0.00566602 0.01560426 0.08238824 0.4411858  0.50404954 0.40665847
 0.02038624 0.02748424 0.02942604 0.10334729 0.02997609 0.02270033
 0.31647596 0.03039395 0.01458359 0.22759077 0.03433245 0.03438359
 0.09801096 0.02354443 0.07195422 0.07647633 0.0100677  0.02532743
 0.3594473 ]
pred: 0.10226823227299799, label: 0
Right! Diagnosis: Other

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.516624, loss_ss: 1.763037, loss_d: 0.753587
0.0384 --- loss: 2.899135, loss_ss: 1.530366, loss_d: 1.368769
0.0767 --- loss: 2.449943, loss_ss: 1.632213, loss_d: 0.817730
0.1151 --- loss: 2.280250, loss_ss: 1.526270, loss_d: 0.753980
0.1534 --- loss: 2.306127, loss_ss: 1.472856, loss_d: 0.833272
0.1918 --- loss: 1.825025, loss_ss: 1.427931, loss_d: 0.397094
0.2301 --- loss: 2.012202, loss_ss: 1.551907, loss_d: 0.460296
0.2685 --- loss: 2.270317, loss_ss: 1.565508, loss_d: 0.704809
0.3069 --- loss: 2.029636, loss_ss: 1.479348, loss_d: 0.550287
0.3452 --- loss: 2.346086, loss_ss: 1.651338, loss_d: 0.694748
0.3836 --- loss: 1.812778, loss_ss: 1.260625, loss_d: 0.552153
0.4219 --- loss: 2.126283, loss_ss: 1.327280, loss_d: 0.799003
0.4603 --- loss: 1.998362, loss_ss: 1.389590, loss_d: 0.608772
0.4987 --- loss: 1.661708, loss_ss: 1.304137, loss_d: 0.357571
0.5370 --- loss: 2.164206, loss_ss: 1.366454, loss_d: 0.797752
0.5754 --- loss: 1.555068, loss_ss: 1.190859, loss_d: 0.364209
0.6137 --- loss: 2.183265, loss_ss: 1.290458, loss_d: 0.892807
0.6521 --- loss: 1.827233, loss_ss: 1.469441, loss_d: 0.357792
0.6904 --- loss: 1.704958, loss_ss: 1.202720, loss_d: 0.502238
0.7288 --- loss: 1.749738, loss_ss: 1.246627, loss_d: 0.503111
0.7672 --- loss: 2.139492, loss_ss: 1.347370, loss_d: 0.792122
0.8055 --- loss: 1.784441, loss_ss: 1.223322, loss_d: 0.561119
0.8439 --- loss: 1.678080, loss_ss: 1.201611, loss_d: 0.476469
0.8822 --- loss: 1.883294, loss_ss: 1.368330, loss_d: 0.514965
0.9206 --- loss: 1.575125, loss_ss: 1.274139, loss_d: 0.300986
0.9590 --- loss: 1.645191, loss_ss: 1.244382, loss_d: 0.400809
0.9973 --- loss: 2.290631, loss_ss: 1.289871, loss_d: 1.000760
Epoch finished! Loss: 1.9961823559724368
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.512532, loss_ss: 0.943442, loss_d: 0.569090
0.0384 --- loss: 2.107212, loss_ss: 1.523708, loss_d: 0.583504
0.0767 --- loss: 1.975898, loss_ss: 1.401742, loss_d: 0.574156
0.1151 --- loss: 1.862665, loss_ss: 1.439753, loss_d: 0.422912
0.1534 --- loss: 1.834199, loss_ss: 1.202696, loss_d: 0.631503
0.1918 --- loss: 1.883695, loss_ss: 1.185866, loss_d: 0.697829
0.2301 --- loss: 1.771852, loss_ss: 1.018020, loss_d: 0.753832
0.2685 --- loss: 1.619705, loss_ss: 1.089262, loss_d: 0.530443
0.3069 --- loss: 2.074589, loss_ss: 1.527847, loss_d: 0.546742
0.3452 --- loss: 1.567963, loss_ss: 1.106770, loss_d: 0.461192
0.3836 --- loss: 2.032525, loss_ss: 1.275019, loss_d: 0.757506
0.4219 --- loss: 2.027509, loss_ss: 1.360479, loss_d: 0.667030
0.4603 --- loss: 1.778348, loss_ss: 0.988663, loss_d: 0.789686
0.4987 --- loss: 1.756752, loss_ss: 1.066183, loss_d: 0.690569
0.5370 --- loss: 1.639532, loss_ss: 1.044865, loss_d: 0.594667
0.5754 --- loss: 1.682989, loss_ss: 0.994494, loss_d: 0.688495
0.6137 --- loss: 2.210904, loss_ss: 1.079574, loss_d: 1.131330
0.6521 --- loss: 1.696413, loss_ss: 1.073516, loss_d: 0.622897
0.6904 --- loss: 2.010203, loss_ss: 1.135174, loss_d: 0.875029
0.7288 --- loss: 1.722860, loss_ss: 1.056668, loss_d: 0.666191
0.7672 --- loss: 1.327414, loss_ss: 0.884671, loss_d: 0.442744
0.8055 --- loss: 1.562325, loss_ss: 1.179615, loss_d: 0.382710
0.8439 --- loss: 1.660968, loss_ss: 1.184415, loss_d: 0.476553
0.8822 --- loss: 1.344637, loss_ss: 0.951314, loss_d: 0.393323
0.9206 --- loss: 1.499801, loss_ss: 0.976689, loss_d: 0.523112
0.9590 --- loss: 1.634710, loss_ss: 1.117060, loss_d: 0.517651
0.9973 --- loss: 2.071768, loss_ss: 1.351073, loss_d: 0.720695
Epoch finished! Loss: 1.7177247203313388
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.862070, loss_ss: 1.119038, loss_d: 0.743032
0.0384 --- loss: 2.010356, loss_ss: 1.328286, loss_d: 0.682070
0.0767 --- loss: 1.615657, loss_ss: 1.155249, loss_d: 0.460408
0.1151 --- loss: 1.711488, loss_ss: 1.092200, loss_d: 0.619288
0.1534 --- loss: 1.552344, loss_ss: 1.007279, loss_d: 0.545066
0.1918 --- loss: 1.316721, loss_ss: 1.025963, loss_d: 0.290758
0.2301 --- loss: 1.756175, loss_ss: 1.131853, loss_d: 0.624322
0.2685 --- loss: 1.763639, loss_ss: 1.170781, loss_d: 0.592858
0.3069 --- loss: 1.615083, loss_ss: 0.982941, loss_d: 0.632143
0.3452 --- loss: 1.896966, loss_ss: 1.366149, loss_d: 0.530817
0.3836 --- loss: 1.575686, loss_ss: 1.086880, loss_d: 0.488806
0.4219 --- loss: 1.591284, loss_ss: 1.044458, loss_d: 0.546826
0.4603 --- loss: 1.797204, loss_ss: 1.006364, loss_d: 0.790841
0.4987 --- loss: 1.577680, loss_ss: 1.004350, loss_d: 0.573331
0.5370 --- loss: 1.598237, loss_ss: 1.000437, loss_d: 0.597800
0.5754 --- loss: 1.334474, loss_ss: 0.756071, loss_d: 0.578404
0.6137 --- loss: 1.235866, loss_ss: 0.744496, loss_d: 0.491370
0.6521 --- loss: 1.543045, loss_ss: 0.881112, loss_d: 0.661933
0.6904 --- loss: 1.478652, loss_ss: 1.008880, loss_d: 0.469772
0.7288 --- loss: 1.556687, loss_ss: 1.050858, loss_d: 0.505830
0.7672 --- loss: 1.765614, loss_ss: 1.302800, loss_d: 0.462814
0.8055 --- loss: 1.709530, loss_ss: 0.996068, loss_d: 0.713462
0.8439 --- loss: 1.351205, loss_ss: 1.008460, loss_d: 0.342744
0.8822 --- loss: 1.627691, loss_ss: 1.101185, loss_d: 0.526506
0.9206 --- loss: 1.472685, loss_ss: 0.967782, loss_d: 0.504903
0.9590 --- loss: 2.302038, loss_ss: 1.518119, loss_d: 0.783918
0.9973 --- loss: 1.848897, loss_ss: 1.068467, loss_d: 0.780430
Epoch finished! Loss: 1.6208349484663742
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.553025, loss_ss: 1.059368, loss_d: 0.493657
0.0384 --- loss: 1.557141, loss_ss: 1.078671, loss_d: 0.478470
0.0767 --- loss: 1.511110, loss_ss: 1.116619, loss_d: 0.394491
0.1151 --- loss: 1.444385, loss_ss: 1.057041, loss_d: 0.387344
0.1534 --- loss: 1.441845, loss_ss: 1.134540, loss_d: 0.307305
0.1918 --- loss: 1.692366, loss_ss: 1.123728, loss_d: 0.568638
0.2301 --- loss: 1.569428, loss_ss: 1.044005, loss_d: 0.525423
0.2685 --- loss: 1.743868, loss_ss: 1.057271, loss_d: 0.686597
0.3069 --- loss: 1.945883, loss_ss: 1.094925, loss_d: 0.850958
0.3452 --- loss: 1.325361, loss_ss: 0.799382, loss_d: 0.525979
0.3836 --- loss: 1.283597, loss_ss: 0.806341, loss_d: 0.477256
0.4219 --- loss: 1.779588, loss_ss: 1.078142, loss_d: 0.701446
0.4603 --- loss: 1.511449, loss_ss: 1.120581, loss_d: 0.390868
0.4987 --- loss: 1.954426, loss_ss: 1.082457, loss_d: 0.871969
0.5370 --- loss: 2.117800, loss_ss: 1.571437, loss_d: 0.546363
0.5754 --- loss: 1.435824, loss_ss: 0.994170, loss_d: 0.441655
0.6137 --- loss: 1.300856, loss_ss: 0.878990, loss_d: 0.421866
0.6521 --- loss: 1.163774, loss_ss: 0.816074, loss_d: 0.347700
0.6904 --- loss: 1.574940, loss_ss: 0.879520, loss_d: 0.695420
0.7288 --- loss: 1.233767, loss_ss: 0.854169, loss_d: 0.379598
0.7672 --- loss: 1.408624, loss_ss: 0.923524, loss_d: 0.485099
0.8055 --- loss: 1.415112, loss_ss: 0.874474, loss_d: 0.540638
0.8439 --- loss: 1.749068, loss_ss: 1.038787, loss_d: 0.710281
0.8822 --- loss: 1.533401, loss_ss: 0.886744, loss_d: 0.646657
0.9206 --- loss: 1.545895, loss_ss: 1.188776, loss_d: 0.357119
0.9590 --- loss: 1.237208, loss_ss: 0.772144, loss_d: 0.465064
0.9973 --- loss: 1.288628, loss_ss: 0.950200, loss_d: 0.338429
Epoch finished! Loss: 1.5475655404421
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.094398, loss_ss: 1.473240, loss_d: 0.621158
0.0384 --- loss: 1.345896, loss_ss: 0.841984, loss_d: 0.503912
0.0767 --- loss: 1.301033, loss_ss: 0.878400, loss_d: 0.422633
0.1151 --- loss: 1.388461, loss_ss: 0.938763, loss_d: 0.449699
0.1534 --- loss: 1.747046, loss_ss: 1.176642, loss_d: 0.570404
0.1918 --- loss: 2.012815, loss_ss: 1.177902, loss_d: 0.834914
0.2301 --- loss: 1.255985, loss_ss: 0.894141, loss_d: 0.361844
0.2685 --- loss: 1.596056, loss_ss: 0.920360, loss_d: 0.675696
0.3069 --- loss: 1.465041, loss_ss: 1.007974, loss_d: 0.457067
0.3452 --- loss: 1.718679, loss_ss: 1.021035, loss_d: 0.697644
0.3836 --- loss: 1.621902, loss_ss: 1.165879, loss_d: 0.456024
0.4219 --- loss: 1.517358, loss_ss: 0.837617, loss_d: 0.679741
0.4603 --- loss: 1.619510, loss_ss: 1.003593, loss_d: 0.615917
0.4987 --- loss: 1.839939, loss_ss: 1.243281, loss_d: 0.596658
0.5370 --- loss: 1.509449, loss_ss: 0.999388, loss_d: 0.510060
0.5754 --- loss: 1.156482, loss_ss: 0.841506, loss_d: 0.314976
0.6137 --- loss: 1.228105, loss_ss: 0.742246, loss_d: 0.485859
0.6521 --- loss: 1.646983, loss_ss: 1.041736, loss_d: 0.605248
0.6904 --- loss: 1.107638, loss_ss: 0.794817, loss_d: 0.312821
0.7288 --- loss: 1.217381, loss_ss: 0.902780, loss_d: 0.314601
0.7672 --- loss: 1.181767, loss_ss: 0.800614, loss_d: 0.381153
0.8055 --- loss: 2.171057, loss_ss: 1.463987, loss_d: 0.707070
0.8439 --- loss: 1.406927, loss_ss: 0.976946, loss_d: 0.429981
0.8822 --- loss: 1.142773, loss_ss: 0.650123, loss_d: 0.492651
0.9206 --- loss: 1.200889, loss_ss: 0.824054, loss_d: 0.376835
0.9590 --- loss: 1.399447, loss_ss: 0.895536, loss_d: 0.503911
0.9973 --- loss: 1.736491, loss_ss: 1.355556, loss_d: 0.380935
Epoch finished! Loss: 1.4847246999924
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.669707, loss_ss: 0.966455, loss_d: 0.703251
0.0384 --- loss: 1.228379, loss_ss: 0.837425, loss_d: 0.390954
0.0767 --- loss: 1.725672, loss_ss: 1.300952, loss_d: 0.424720
0.1151 --- loss: 1.424515, loss_ss: 0.883627, loss_d: 0.540888
0.1534 --- loss: 1.169008, loss_ss: 0.987249, loss_d: 0.181759
0.1918 --- loss: 1.080830, loss_ss: 0.816591, loss_d: 0.264239
0.2301 --- loss: 1.483531, loss_ss: 0.951821, loss_d: 0.531710
0.2685 --- loss: 1.485252, loss_ss: 0.784354, loss_d: 0.700898
0.3069 --- loss: 1.077196, loss_ss: 0.698799, loss_d: 0.378397
0.3452 --- loss: 1.259302, loss_ss: 0.836119, loss_d: 0.423183
0.3836 --- loss: 1.128026, loss_ss: 0.856493, loss_d: 0.271533
0.4219 --- loss: 0.974011, loss_ss: 0.791663, loss_d: 0.182348
0.4603 --- loss: 1.180891, loss_ss: 1.053977, loss_d: 0.126914
0.4987 --- loss: 1.278188, loss_ss: 0.969549, loss_d: 0.308639
0.5370 --- loss: 1.084404, loss_ss: 0.802384, loss_d: 0.282019
0.5754 --- loss: 1.109476, loss_ss: 0.836298, loss_d: 0.273178
0.6137 --- loss: 1.249647, loss_ss: 0.660946, loss_d: 0.588701
0.6521 --- loss: 1.113230, loss_ss: 0.719075, loss_d: 0.394155
0.6904 --- loss: 1.852607, loss_ss: 1.175609, loss_d: 0.676998
0.7288 --- loss: 1.319420, loss_ss: 1.050417, loss_d: 0.269003
0.7672 --- loss: 1.252040, loss_ss: 0.928317, loss_d: 0.323722
0.8055 --- loss: 1.132036, loss_ss: 0.820148, loss_d: 0.311888
0.8439 --- loss: 1.584946, loss_ss: 1.057405, loss_d: 0.527541
0.8822 --- loss: 1.629658, loss_ss: 1.104321, loss_d: 0.525338
0.9206 --- loss: 1.296532, loss_ss: 0.970878, loss_d: 0.325654
0.9590 --- loss: 1.481106, loss_ss: 1.126443, loss_d: 0.354663
0.9973 --- loss: 0.888916, loss_ss: 0.606747, loss_d: 0.282170
Epoch finished! Loss: 1.384098623578365
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.356841, loss_ss: 1.060746, loss_d: 0.296095
0.0384 --- loss: 1.973600, loss_ss: 1.181636, loss_d: 0.791964
0.0767 --- loss: 1.479095, loss_ss: 0.932090, loss_d: 0.547005
0.1151 --- loss: 1.484277, loss_ss: 0.968380, loss_d: 0.515896
0.1534 --- loss: 1.265438, loss_ss: 0.798334, loss_d: 0.467104
0.1918 --- loss: 1.194741, loss_ss: 0.834631, loss_d: 0.360110
0.2301 --- loss: 1.086194, loss_ss: 0.717577, loss_d: 0.368618
0.2685 --- loss: 0.996373, loss_ss: 0.780217, loss_d: 0.216156
0.3069 --- loss: 1.592407, loss_ss: 1.365707, loss_d: 0.226700
0.3452 --- loss: 0.988862, loss_ss: 0.819120, loss_d: 0.169742
0.3836 --- loss: 1.203019, loss_ss: 0.922851, loss_d: 0.280168
0.4219 --- loss: 1.195171, loss_ss: 0.830670, loss_d: 0.364501
0.4603 --- loss: 1.519901, loss_ss: 0.957949, loss_d: 0.561951
0.4987 --- loss: 1.787731, loss_ss: 1.092354, loss_d: 0.695377
0.5370 --- loss: 1.420527, loss_ss: 1.184590, loss_d: 0.235937
0.5754 --- loss: 1.202018, loss_ss: 0.885737, loss_d: 0.316281
0.6137 --- loss: 1.024785, loss_ss: 0.880362, loss_d: 0.144423
0.6521 --- loss: 1.283336, loss_ss: 0.525411, loss_d: 0.757925
0.6904 --- loss: 2.105267, loss_ss: 1.004562, loss_d: 1.100705
0.7288 --- loss: 1.440036, loss_ss: 0.737411, loss_d: 0.702625
0.7672 --- loss: 1.144571, loss_ss: 0.923555, loss_d: 0.221016
0.8055 --- loss: 1.244068, loss_ss: 0.727240, loss_d: 0.516828
0.8439 --- loss: 1.253194, loss_ss: 0.751241, loss_d: 0.501953
0.8822 --- loss: 1.122497, loss_ss: 0.871731, loss_d: 0.250766
0.9206 --- loss: 1.012803, loss_ss: 0.714000, loss_d: 0.298803
0.9590 --- loss: 1.167767, loss_ss: 0.661082, loss_d: 0.506686
0.9973 --- loss: 1.081254, loss_ss: 0.901261, loss_d: 0.179993
Epoch finished! Loss: 1.3237004699615331
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.172381, loss_ss: 0.743709, loss_d: 0.428672
0.0384 --- loss: 1.217274, loss_ss: 1.050913, loss_d: 0.166361
0.0767 --- loss: 0.949976, loss_ss: 0.634143, loss_d: 0.315833
0.1151 --- loss: 1.244380, loss_ss: 1.096482, loss_d: 0.147898
0.1534 --- loss: 1.453792, loss_ss: 1.049509, loss_d: 0.404282
0.1918 --- loss: 0.873676, loss_ss: 0.654889, loss_d: 0.218787
0.2301 --- loss: 1.038296, loss_ss: 0.819022, loss_d: 0.219274
0.2685 --- loss: 0.720874, loss_ss: 0.626599, loss_d: 0.094275
0.3069 --- loss: 1.925179, loss_ss: 1.718842, loss_d: 0.206337
0.3452 --- loss: 1.146079, loss_ss: 0.731023, loss_d: 0.415055
0.3836 --- loss: 1.201347, loss_ss: 1.030463, loss_d: 0.170884
0.4219 --- loss: 0.897565, loss_ss: 0.652962, loss_d: 0.244603
0.4603 --- loss: 1.283968, loss_ss: 0.767008, loss_d: 0.516960
0.4987 --- loss: 1.213228, loss_ss: 0.781321, loss_d: 0.431907
0.5370 --- loss: 0.948271, loss_ss: 0.699690, loss_d: 0.248581
0.5754 --- loss: 1.813240, loss_ss: 1.106638, loss_d: 0.706601
0.6137 --- loss: 1.029848, loss_ss: 0.798859, loss_d: 0.230988
0.6521 --- loss: 1.206363, loss_ss: 0.814247, loss_d: 0.392116
0.6904 --- loss: 1.528591, loss_ss: 1.204016, loss_d: 0.324575
0.7288 --- loss: 1.023812, loss_ss: 0.747880, loss_d: 0.275933
0.7672 --- loss: 1.229037, loss_ss: 0.730619, loss_d: 0.498419
0.8055 --- loss: 1.168037, loss_ss: 0.888042, loss_d: 0.279995
0.8439 --- loss: 0.943821, loss_ss: 0.667688, loss_d: 0.276133
0.8822 --- loss: 1.661383, loss_ss: 0.954081, loss_d: 0.707302
0.9206 --- loss: 0.928154, loss_ss: 0.641688, loss_d: 0.286466
0.9590 --- loss: 1.141825, loss_ss: 0.889947, loss_d: 0.251879
0.9973 --- loss: 0.936137, loss_ss: 0.661588, loss_d: 0.274549
Epoch finished! Loss: 1.2618147572645775
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.847583, loss_ss: 0.673969, loss_d: 0.173614
0.0384 --- loss: 0.790945, loss_ss: 0.717162, loss_d: 0.073783
0.0767 --- loss: 1.280345, loss_ss: 0.954818, loss_d: 0.325527
0.1151 --- loss: 1.213977, loss_ss: 1.047031, loss_d: 0.166946
0.1534 --- loss: 1.026144, loss_ss: 0.662237, loss_d: 0.363907
0.1918 --- loss: 1.132109, loss_ss: 0.919033, loss_d: 0.213077
0.2301 --- loss: 0.907305, loss_ss: 0.774525, loss_d: 0.132780
0.2685 --- loss: 1.029799, loss_ss: 0.633216, loss_d: 0.396583
0.3069 --- loss: 1.168904, loss_ss: 0.888438, loss_d: 0.280466
0.3452 --- loss: 1.337481, loss_ss: 0.852448, loss_d: 0.485033
0.3836 --- loss: 1.009287, loss_ss: 0.836004, loss_d: 0.173282
0.4219 --- loss: 0.984473, loss_ss: 0.691475, loss_d: 0.292999
0.4603 --- loss: 1.100257, loss_ss: 0.607681, loss_d: 0.492577
0.4987 --- loss: 0.902958, loss_ss: 0.667520, loss_d: 0.235437
0.5370 --- loss: 1.309675, loss_ss: 1.048825, loss_d: 0.260851
0.5754 --- loss: 1.396550, loss_ss: 0.960081, loss_d: 0.436468
0.6137 --- loss: 1.556915, loss_ss: 1.158564, loss_d: 0.398351
0.6521 --- loss: 1.027369, loss_ss: 0.899559, loss_d: 0.127810
0.6904 --- loss: 0.969960, loss_ss: 0.623927, loss_d: 0.346033
0.7288 --- loss: 1.058534, loss_ss: 0.903013, loss_d: 0.155521
0.7672 --- loss: 1.437434, loss_ss: 0.813408, loss_d: 0.624026
0.8055 --- loss: 1.373856, loss_ss: 0.882374, loss_d: 0.491482
0.8439 --- loss: 1.021749, loss_ss: 0.620418, loss_d: 0.401331
0.8822 --- loss: 0.985672, loss_ss: 0.844846, loss_d: 0.140826
0.9206 --- loss: 1.124011, loss_ss: 0.972025, loss_d: 0.151986
0.9590 --- loss: 1.473338, loss_ss: 1.296712, loss_d: 0.176626
0.9973 --- loss: 1.191571, loss_ss: 1.062959, loss_d: 0.128612
Epoch finished! Loss: 1.2177069581471958
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.011670, loss_ss: 0.860162, loss_d: 0.151507
0.0384 --- loss: 1.221726, loss_ss: 1.086833, loss_d: 0.134893
0.0767 --- loss: 1.342958, loss_ss: 0.617145, loss_d: 0.725814
0.1151 --- loss: 0.752872, loss_ss: 0.601241, loss_d: 0.151631
0.1534 --- loss: 0.747480, loss_ss: 0.621706, loss_d: 0.125774
0.1918 --- loss: 1.246899, loss_ss: 0.988584, loss_d: 0.258315
0.2301 --- loss: 1.699620, loss_ss: 1.182587, loss_d: 0.517033
0.2685 --- loss: 1.295718, loss_ss: 0.697077, loss_d: 0.598641
0.3069 --- loss: 2.089960, loss_ss: 0.767374, loss_d: 1.322587
0.3452 --- loss: 1.780688, loss_ss: 1.141473, loss_d: 0.639215
0.3836 --- loss: 1.316468, loss_ss: 0.861358, loss_d: 0.455110
0.4219 --- loss: 1.062856, loss_ss: 0.814425, loss_d: 0.248431
0.4603 --- loss: 0.952524, loss_ss: 0.810422, loss_d: 0.142101
0.4987 --- loss: 0.953586, loss_ss: 0.758609, loss_d: 0.194978
0.5370 --- loss: 1.434859, loss_ss: 0.776837, loss_d: 0.658022
0.5754 --- loss: 1.263846, loss_ss: 0.925309, loss_d: 0.338536
0.6137 --- loss: 1.043352, loss_ss: 0.906410, loss_d: 0.136943
0.6521 --- loss: 1.093328, loss_ss: 0.688115, loss_d: 0.405214
0.6904 --- loss: 1.054629, loss_ss: 0.624225, loss_d: 0.430404
0.7288 --- loss: 1.426988, loss_ss: 1.005556, loss_d: 0.421432
0.7672 --- loss: 0.987918, loss_ss: 0.756947, loss_d: 0.230971
0.8055 --- loss: 1.344310, loss_ss: 1.009359, loss_d: 0.334952
0.8439 --- loss: 1.050932, loss_ss: 0.806387, loss_d: 0.244545
0.8822 --- loss: 1.092874, loss_ss: 0.921651, loss_d: 0.171223
0.9206 --- loss: 1.394090, loss_ss: 1.056977, loss_d: 0.337113
0.9590 --- loss: 1.052471, loss_ss: 0.756906, loss_d: 0.295564
0.9973 --- loss: 1.241882, loss_ss: 1.000721, loss_d: 0.241161
Epoch finished! Loss: 1.1819860492761318
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8010752688172043
             precision    recall  f1-score   support

        0.0       0.63      0.89      0.74        38
        1.0       1.00      0.01      0.02        83
        2.0       0.84      0.86      0.85       502
        3.0       0.75      1.00      0.86       166
        4.0       0.79      0.81      0.80       141

avg / total       0.82      0.80      0.77       930
 


====== chc015-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  97.42   89.47   97.76   62.96     73.91
1  91.18    1.20  100.00  100.00      2.38
2  83.66   85.66   81.31   84.31     84.98
3  94.19  100.00   92.93   75.45     86.01
4  93.76   80.85   96.07   78.62     79.72
Total accuracy: 80.11%
Average sen: 71.44%
Average spec: 93.61%
Macro f1-score: 65.40%
[0.92033273 0.86418891 0.83238173 0.86894554 0.84397811 0.19114988
 0.94735855 0.99889982 0.98986965 0.94928098 0.96945572 0.8162384
 0.91689628 0.72333205 0.83568013 0.99442261 0.92123729 0.93481654
 0.94125164 0.84651941 0.90048099 0.96386218 0.98685467 0.90168411
 0.9792701  0.91491455 0.92330742 0.92242664 0.92878783 0.99821496
 0.99845493]
pred: 0.8943385265527233, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.520284, loss_ss: 1.763427, loss_d: 0.756858
0.0384 --- loss: 2.491992, loss_ss: 1.743305, loss_d: 0.748688
0.0767 --- loss: 2.017217, loss_ss: 1.505848, loss_d: 0.511369
0.1151 --- loss: 2.714279, loss_ss: 1.568790, loss_d: 1.145489
0.1534 --- loss: 1.991834, loss_ss: 1.432124, loss_d: 0.559711
0.1918 --- loss: 2.126451, loss_ss: 1.464585, loss_d: 0.661866
0.2301 --- loss: 1.735124, loss_ss: 1.321999, loss_d: 0.413126
0.2685 --- loss: 1.911620, loss_ss: 1.327009, loss_d: 0.584611
0.3069 --- loss: 2.206050, loss_ss: 1.378157, loss_d: 0.827894
0.3452 --- loss: 2.002925, loss_ss: 1.383302, loss_d: 0.619623
0.3836 --- loss: 1.753532, loss_ss: 1.197853, loss_d: 0.555679
0.4219 --- loss: 1.954181, loss_ss: 1.344160, loss_d: 0.610021
0.4603 --- loss: 2.089848, loss_ss: 1.291966, loss_d: 0.797882
0.4987 --- loss: 2.050636, loss_ss: 1.349566, loss_d: 0.701069
0.5370 --- loss: 1.753530, loss_ss: 1.331489, loss_d: 0.422041
0.5754 --- loss: 1.980414, loss_ss: 1.262353, loss_d: 0.718061
0.6137 --- loss: 1.943348, loss_ss: 1.304538, loss_d: 0.638810
0.6521 --- loss: 1.767789, loss_ss: 1.237609, loss_d: 0.530181
0.6904 --- loss: 1.915559, loss_ss: 1.267781, loss_d: 0.647777
0.7288 --- loss: 1.841722, loss_ss: 1.292674, loss_d: 0.549048
0.7672 --- loss: 1.923606, loss_ss: 1.214826, loss_d: 0.708780
0.8055 --- loss: 1.906934, loss_ss: 1.227085, loss_d: 0.679849
0.8439 --- loss: 1.800533, loss_ss: 1.227848, loss_d: 0.572685
0.8822 --- loss: 1.965207, loss_ss: 1.240989, loss_d: 0.724219
0.9206 --- loss: 1.831491, loss_ss: 1.182558, loss_d: 0.648933
0.9590 --- loss: 1.721792, loss_ss: 1.165787, loss_d: 0.556005
0.9973 --- loss: 1.703649, loss_ss: 1.169338, loss_d: 0.534312
Epoch finished! Loss: 1.9404371307446406
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.787043, loss_ss: 1.079680, loss_d: 0.707363
0.0384 --- loss: 1.542167, loss_ss: 1.075080, loss_d: 0.467087
0.0767 --- loss: 1.813024, loss_ss: 1.137727, loss_d: 0.675298
0.1151 --- loss: 1.628267, loss_ss: 1.066740, loss_d: 0.561527
0.1534 --- loss: 1.583567, loss_ss: 1.139920, loss_d: 0.443647
0.1918 --- loss: 1.473600, loss_ss: 1.015248, loss_d: 0.458352
0.2301 --- loss: 1.806014, loss_ss: 1.144115, loss_d: 0.661899
0.2685 --- loss: 1.549268, loss_ss: 0.993088, loss_d: 0.556181
0.3069 --- loss: 1.680435, loss_ss: 1.067129, loss_d: 0.613307
0.3452 --- loss: 1.586006, loss_ss: 1.020226, loss_d: 0.565780
0.3836 --- loss: 1.541640, loss_ss: 0.901272, loss_d: 0.640369
0.4219 --- loss: 1.398992, loss_ss: 1.109715, loss_d: 0.289277
0.4603 --- loss: 1.615092, loss_ss: 1.030989, loss_d: 0.584103
0.4987 --- loss: 1.752336, loss_ss: 1.067319, loss_d: 0.685017
0.5370 --- loss: 1.878834, loss_ss: 1.236704, loss_d: 0.642130
0.5754 --- loss: 1.919842, loss_ss: 1.228258, loss_d: 0.691584
0.6137 --- loss: 1.501398, loss_ss: 1.082397, loss_d: 0.419001
0.6521 --- loss: 1.584800, loss_ss: 1.064582, loss_d: 0.520218
0.6904 --- loss: 1.589663, loss_ss: 1.021134, loss_d: 0.568529
0.7288 --- loss: 1.556161, loss_ss: 1.026606, loss_d: 0.529555
0.7672 --- loss: 1.930859, loss_ss: 1.120416, loss_d: 0.810444
0.8055 --- loss: 1.637296, loss_ss: 1.021380, loss_d: 0.615916
0.8439 --- loss: 1.388839, loss_ss: 0.899742, loss_d: 0.489097
0.8822 --- loss: 1.697659, loss_ss: 1.166671, loss_d: 0.530989
0.9206 --- loss: 1.345495, loss_ss: 0.977559, loss_d: 0.367936
0.9590 --- loss: 1.489048, loss_ss: 0.972357, loss_d: 0.516691
0.9973 --- loss: 1.775021, loss_ss: 0.978150, loss_d: 0.796871
Epoch finished! Loss: 1.6640342790346878
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.875512, loss_ss: 1.176794, loss_d: 0.698718
0.0384 --- loss: 1.830022, loss_ss: 1.012210, loss_d: 0.817812
0.0767 --- loss: 1.579602, loss_ss: 0.809802, loss_d: 0.769800
0.1151 --- loss: 1.273037, loss_ss: 0.735952, loss_d: 0.537086
0.1534 --- loss: 1.389524, loss_ss: 0.898732, loss_d: 0.490792
0.1918 --- loss: 1.744097, loss_ss: 1.166761, loss_d: 0.577336
0.2301 --- loss: 1.652842, loss_ss: 0.833518, loss_d: 0.819324
0.2685 --- loss: 1.583349, loss_ss: 1.167022, loss_d: 0.416327
0.3069 --- loss: 1.320334, loss_ss: 0.853915, loss_d: 0.466419
0.3452 --- loss: 1.728630, loss_ss: 1.347314, loss_d: 0.381316
0.3836 --- loss: 1.473789, loss_ss: 0.977004, loss_d: 0.496785
0.4219 --- loss: 1.461644, loss_ss: 0.975753, loss_d: 0.485891
0.4603 --- loss: 1.511383, loss_ss: 1.200267, loss_d: 0.311116
0.4987 --- loss: 1.551698, loss_ss: 0.917118, loss_d: 0.634580
0.5370 --- loss: 1.956162, loss_ss: 1.273943, loss_d: 0.682219
0.5754 --- loss: 2.034436, loss_ss: 1.412169, loss_d: 0.622267
0.6137 --- loss: 1.438131, loss_ss: 0.932541, loss_d: 0.505590
0.6521 --- loss: 1.277969, loss_ss: 0.821367, loss_d: 0.456602
0.6904 --- loss: 1.890203, loss_ss: 1.120733, loss_d: 0.769470
0.7288 --- loss: 1.759526, loss_ss: 1.198238, loss_d: 0.561288
0.7672 --- loss: 1.697451, loss_ss: 1.080821, loss_d: 0.616629
0.8055 --- loss: 1.403784, loss_ss: 0.929301, loss_d: 0.474483
0.8439 --- loss: 1.487192, loss_ss: 0.887970, loss_d: 0.599222
0.8822 --- loss: 1.525185, loss_ss: 0.700179, loss_d: 0.825007
0.9206 --- loss: 1.407007, loss_ss: 1.001546, loss_d: 0.405462
0.9590 --- loss: 1.325391, loss_ss: 0.743713, loss_d: 0.581679
0.9973 --- loss: 1.440467, loss_ss: 1.060314, loss_d: 0.380153
Epoch finished! Loss: 1.5600694596767426
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.909950, loss_ss: 0.790839, loss_d: 1.119111
0.0384 --- loss: 1.726531, loss_ss: 0.843366, loss_d: 0.883165
0.0767 --- loss: 1.815387, loss_ss: 1.227237, loss_d: 0.588150
0.1151 --- loss: 1.264679, loss_ss: 0.880662, loss_d: 0.384016
0.1534 --- loss: 1.645171, loss_ss: 1.149052, loss_d: 0.496119
0.1918 --- loss: 1.443658, loss_ss: 0.879289, loss_d: 0.564369
0.2301 --- loss: 1.391363, loss_ss: 0.798335, loss_d: 0.593027
0.2685 --- loss: 1.271790, loss_ss: 0.812703, loss_d: 0.459087
0.3069 --- loss: 1.293504, loss_ss: 0.842166, loss_d: 0.451338
0.3452 --- loss: 1.255690, loss_ss: 0.916126, loss_d: 0.339564
0.3836 --- loss: 1.655645, loss_ss: 1.258619, loss_d: 0.397025
0.4219 --- loss: 1.781827, loss_ss: 0.901361, loss_d: 0.880466
0.4603 --- loss: 1.326379, loss_ss: 0.893307, loss_d: 0.433072
0.4987 --- loss: 1.656223, loss_ss: 1.072038, loss_d: 0.584185
0.5370 --- loss: 1.111691, loss_ss: 0.687096, loss_d: 0.424596
0.5754 --- loss: 1.520585, loss_ss: 0.995832, loss_d: 0.524752
0.6137 --- loss: 1.394098, loss_ss: 0.837732, loss_d: 0.556366
0.6521 --- loss: 1.566878, loss_ss: 1.051246, loss_d: 0.515632
0.6904 --- loss: 1.592068, loss_ss: 1.198891, loss_d: 0.393178
0.7288 --- loss: 1.636216, loss_ss: 1.134208, loss_d: 0.502008
0.7672 --- loss: 1.507141, loss_ss: 0.990069, loss_d: 0.517071
0.8055 --- loss: 1.448178, loss_ss: 1.038857, loss_d: 0.409321
0.8439 --- loss: 1.472103, loss_ss: 1.059858, loss_d: 0.412245
0.8822 --- loss: 1.452722, loss_ss: 0.862824, loss_d: 0.589898
0.9206 --- loss: 1.329304, loss_ss: 0.743149, loss_d: 0.586155
0.9590 --- loss: 1.536462, loss_ss: 0.814761, loss_d: 0.721702
0.9973 --- loss: 1.599263, loss_ss: 1.013949, loss_d: 0.585315
Epoch finished! Loss: 1.511636685866576
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.263939, loss_ss: 0.786330, loss_d: 0.477610
0.0384 --- loss: 1.751950, loss_ss: 1.296808, loss_d: 0.455142
0.0767 --- loss: 1.768868, loss_ss: 1.044978, loss_d: 0.723890
0.1151 --- loss: 1.498003, loss_ss: 1.048229, loss_d: 0.449775
0.1534 --- loss: 1.953764, loss_ss: 0.989977, loss_d: 0.963788
0.1918 --- loss: 1.239418, loss_ss: 0.791259, loss_d: 0.448159
0.2301 --- loss: 1.743920, loss_ss: 1.129472, loss_d: 0.614449
0.2685 --- loss: 1.805284, loss_ss: 1.139749, loss_d: 0.665535
0.3069 --- loss: 1.571682, loss_ss: 1.231112, loss_d: 0.340571
0.3452 --- loss: 1.146048, loss_ss: 0.890636, loss_d: 0.255412
0.3836 --- loss: 1.405431, loss_ss: 0.860242, loss_d: 0.545190
0.4219 --- loss: 1.665844, loss_ss: 1.059313, loss_d: 0.606531
0.4603 --- loss: 1.195516, loss_ss: 0.916697, loss_d: 0.278819
0.4987 --- loss: 1.340200, loss_ss: 0.916870, loss_d: 0.423330
0.5370 --- loss: 1.397906, loss_ss: 0.938399, loss_d: 0.459507
0.5754 --- loss: 1.304261, loss_ss: 0.830914, loss_d: 0.473347
0.6137 --- loss: 1.369537, loss_ss: 0.736168, loss_d: 0.633369
0.6521 --- loss: 1.464115, loss_ss: 1.215463, loss_d: 0.248652
0.6904 --- loss: 1.372767, loss_ss: 1.171433, loss_d: 0.201334
0.7288 --- loss: 1.467619, loss_ss: 1.117564, loss_d: 0.350055
0.7672 --- loss: 1.744400, loss_ss: 1.107819, loss_d: 0.636581
0.8055 --- loss: 1.538672, loss_ss: 1.087787, loss_d: 0.450885
0.8439 --- loss: 1.571044, loss_ss: 1.040761, loss_d: 0.530283
0.8822 --- loss: 1.555027, loss_ss: 1.182504, loss_d: 0.372523
0.9206 --- loss: 1.563979, loss_ss: 1.009943, loss_d: 0.554036
0.9590 --- loss: 1.112405, loss_ss: 0.837626, loss_d: 0.274779
0.9973 --- loss: 1.139333, loss_ss: 0.813005, loss_d: 0.326328
Epoch finished! Loss: 1.4417054082338627
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.224450, loss_ss: 0.866241, loss_d: 0.358210
0.0384 --- loss: 1.697754, loss_ss: 1.185547, loss_d: 0.512207
0.0767 --- loss: 1.204217, loss_ss: 0.895968, loss_d: 0.308249
0.1151 --- loss: 1.399716, loss_ss: 1.009278, loss_d: 0.390437
0.1534 --- loss: 1.492308, loss_ss: 1.264878, loss_d: 0.227430
0.1918 --- loss: 1.367345, loss_ss: 0.948908, loss_d: 0.418437
0.2301 --- loss: 1.263178, loss_ss: 0.704109, loss_d: 0.559069
0.2685 --- loss: 1.203946, loss_ss: 0.685932, loss_d: 0.518014
0.3069 --- loss: 1.245104, loss_ss: 0.914216, loss_d: 0.330888
0.3452 --- loss: 1.176863, loss_ss: 0.924871, loss_d: 0.251992
0.3836 --- loss: 1.374903, loss_ss: 0.970112, loss_d: 0.404792
0.4219 --- loss: 1.480219, loss_ss: 1.066980, loss_d: 0.413239
0.4603 --- loss: 1.584851, loss_ss: 1.124762, loss_d: 0.460089
0.4987 --- loss: 1.312867, loss_ss: 1.034378, loss_d: 0.278489
0.5370 --- loss: 1.211271, loss_ss: 0.788250, loss_d: 0.423021
0.5754 --- loss: 1.178705, loss_ss: 0.944507, loss_d: 0.234199
0.6137 --- loss: 1.261253, loss_ss: 0.813659, loss_d: 0.447594
0.6521 --- loss: 1.585146, loss_ss: 0.797019, loss_d: 0.788127
0.6904 --- loss: 0.840694, loss_ss: 0.638237, loss_d: 0.202458
0.7288 --- loss: 1.493713, loss_ss: 0.993842, loss_d: 0.499871
0.7672 --- loss: 1.506178, loss_ss: 1.278730, loss_d: 0.227448
0.8055 --- loss: 1.183203, loss_ss: 0.685474, loss_d: 0.497729
0.8439 --- loss: 1.684658, loss_ss: 1.102306, loss_d: 0.582352
0.8822 --- loss: 1.550452, loss_ss: 1.338924, loss_d: 0.211528
0.9206 --- loss: 1.607987, loss_ss: 0.753681, loss_d: 0.854307
0.9590 --- loss: 1.172102, loss_ss: 0.812721, loss_d: 0.359382
0.9973 --- loss: 1.302041, loss_ss: 0.914782, loss_d: 0.387258
Epoch finished! Loss: 1.35070876456224
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.313895, loss_ss: 0.945240, loss_d: 0.368655
0.0384 --- loss: 1.140298, loss_ss: 0.898076, loss_d: 0.242223
0.0767 --- loss: 0.945475, loss_ss: 0.671550, loss_d: 0.273925
0.1151 --- loss: 0.980247, loss_ss: 0.699939, loss_d: 0.280308
0.1534 --- loss: 1.046283, loss_ss: 0.733081, loss_d: 0.313203
0.1918 --- loss: 1.385255, loss_ss: 0.750847, loss_d: 0.634408
0.2301 --- loss: 1.330224, loss_ss: 1.055367, loss_d: 0.274858
0.2685 --- loss: 0.913821, loss_ss: 0.664623, loss_d: 0.249198
0.3069 --- loss: 1.270073, loss_ss: 0.574933, loss_d: 0.695140
0.3452 --- loss: 1.207988, loss_ss: 0.921868, loss_d: 0.286120
0.3836 --- loss: 1.125609, loss_ss: 0.918809, loss_d: 0.206799
0.4219 --- loss: 1.134766, loss_ss: 0.944455, loss_d: 0.190311
0.4603 --- loss: 1.437624, loss_ss: 1.167250, loss_d: 0.270374
0.4987 --- loss: 1.617703, loss_ss: 0.969753, loss_d: 0.647950
0.5370 --- loss: 0.897109, loss_ss: 0.712048, loss_d: 0.185061
0.5754 --- loss: 1.129171, loss_ss: 0.820609, loss_d: 0.308562
0.6137 --- loss: 1.846212, loss_ss: 1.162235, loss_d: 0.683977
0.6521 --- loss: 1.499852, loss_ss: 1.091377, loss_d: 0.408475
0.6904 --- loss: 1.268692, loss_ss: 1.040533, loss_d: 0.228158
0.7288 --- loss: 1.239535, loss_ss: 0.935956, loss_d: 0.303579
0.7672 --- loss: 0.920026, loss_ss: 0.643079, loss_d: 0.276947
0.8055 --- loss: 1.169114, loss_ss: 0.847457, loss_d: 0.321657
0.8439 --- loss: 1.253427, loss_ss: 0.929841, loss_d: 0.323586
0.8822 --- loss: 1.057846, loss_ss: 0.768156, loss_d: 0.289691
0.9206 --- loss: 0.786566, loss_ss: 0.598059, loss_d: 0.188508
0.9590 --- loss: 1.593276, loss_ss: 1.281907, loss_d: 0.311369
0.9973 --- loss: 1.307132, loss_ss: 0.665388, loss_d: 0.641745
Epoch finished! Loss: 1.267323778455074
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.427470, loss_ss: 0.742668, loss_d: 0.684802
0.0384 --- loss: 1.910341, loss_ss: 0.656738, loss_d: 1.253603
0.0767 --- loss: 0.912487, loss_ss: 0.682796, loss_d: 0.229691
0.1151 --- loss: 1.798913, loss_ss: 1.187749, loss_d: 0.611164
0.1534 --- loss: 0.867934, loss_ss: 0.705550, loss_d: 0.162385
0.1918 --- loss: 1.109623, loss_ss: 0.902892, loss_d: 0.206731
0.2301 --- loss: 1.743176, loss_ss: 0.891756, loss_d: 0.851420
0.2685 --- loss: 1.168280, loss_ss: 0.921642, loss_d: 0.246639
0.3069 --- loss: 1.080887, loss_ss: 0.931611, loss_d: 0.149277
0.3452 --- loss: 0.957367, loss_ss: 0.738076, loss_d: 0.219291
0.3836 --- loss: 1.159158, loss_ss: 0.964091, loss_d: 0.195067
0.4219 --- loss: 1.060539, loss_ss: 0.770058, loss_d: 0.290481
0.4603 --- loss: 1.654041, loss_ss: 1.300557, loss_d: 0.353484
0.4987 --- loss: 1.102914, loss_ss: 0.936042, loss_d: 0.166872
0.5370 --- loss: 1.270890, loss_ss: 0.826639, loss_d: 0.444251
0.5754 --- loss: 1.001910, loss_ss: 0.704607, loss_d: 0.297303
0.6137 --- loss: 1.798120, loss_ss: 1.458775, loss_d: 0.339345
0.6521 --- loss: 0.973648, loss_ss: 0.727736, loss_d: 0.245912
0.6904 --- loss: 1.371808, loss_ss: 0.773187, loss_d: 0.598621
0.7288 --- loss: 1.390673, loss_ss: 1.102195, loss_d: 0.288479
0.7672 --- loss: 1.305060, loss_ss: 1.027671, loss_d: 0.277389
0.8055 --- loss: 1.271154, loss_ss: 1.012661, loss_d: 0.258493
0.8439 --- loss: 0.974611, loss_ss: 0.655442, loss_d: 0.319169
0.8822 --- loss: 0.928954, loss_ss: 0.749945, loss_d: 0.179009
0.9206 --- loss: 1.547042, loss_ss: 1.326261, loss_d: 0.220780
0.9590 --- loss: 1.065875, loss_ss: 0.819159, loss_d: 0.246715
0.9973 --- loss: 1.509786, loss_ss: 1.394610, loss_d: 0.115176
Epoch finished! Loss: 1.2403565514546173
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.905973, loss_ss: 0.779957, loss_d: 0.126016
0.0384 --- loss: 1.047462, loss_ss: 0.692036, loss_d: 0.355426
0.0767 --- loss: 1.050604, loss_ss: 0.851686, loss_d: 0.198918
0.1151 --- loss: 1.550839, loss_ss: 0.834206, loss_d: 0.716633
0.1534 --- loss: 1.001119, loss_ss: 0.906287, loss_d: 0.094833
0.1918 --- loss: 1.501511, loss_ss: 1.152322, loss_d: 0.349189
0.2301 --- loss: 1.651268, loss_ss: 0.993423, loss_d: 0.657845
0.2685 --- loss: 1.325292, loss_ss: 0.997098, loss_d: 0.328194
0.3069 --- loss: 2.126391, loss_ss: 0.693111, loss_d: 1.433279
0.3452 --- loss: 1.096097, loss_ss: 0.607225, loss_d: 0.488872
0.3836 --- loss: 0.823534, loss_ss: 0.674494, loss_d: 0.149040
0.4219 --- loss: 1.083793, loss_ss: 0.722193, loss_d: 0.361600
0.4603 --- loss: 1.052366, loss_ss: 0.857450, loss_d: 0.194917
0.4987 --- loss: 1.096491, loss_ss: 0.811048, loss_d: 0.285443
0.5370 --- loss: 0.844708, loss_ss: 0.649694, loss_d: 0.195014
0.5754 --- loss: 1.214333, loss_ss: 0.821703, loss_d: 0.392629
0.6137 --- loss: 1.269907, loss_ss: 0.596298, loss_d: 0.673609
0.6521 --- loss: 0.819102, loss_ss: 0.657438, loss_d: 0.161664
0.6904 --- loss: 1.268743, loss_ss: 0.821010, loss_d: 0.447734
0.7288 --- loss: 1.578896, loss_ss: 1.045610, loss_d: 0.533286
0.7672 --- loss: 1.294846, loss_ss: 0.970749, loss_d: 0.324097
0.8055 --- loss: 1.527388, loss_ss: 0.983222, loss_d: 0.544166
0.8439 --- loss: 1.244742, loss_ss: 0.832183, loss_d: 0.412558
0.8822 --- loss: 0.768724, loss_ss: 0.666129, loss_d: 0.102595
0.9206 --- loss: 1.131179, loss_ss: 1.028711, loss_d: 0.102468
0.9590 --- loss: 2.047773, loss_ss: 1.576903, loss_d: 0.470870
0.9973 --- loss: 0.990306, loss_ss: 0.882348, loss_d: 0.107958
Epoch finished! Loss: 1.1848164063233595
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.360391, loss_ss: 0.854964, loss_d: 0.505428
0.0384 --- loss: 1.643635, loss_ss: 0.780228, loss_d: 0.863407
0.0767 --- loss: 0.935882, loss_ss: 0.776079, loss_d: 0.159803
0.1151 --- loss: 0.819718, loss_ss: 0.561339, loss_d: 0.258379
0.1534 --- loss: 0.954031, loss_ss: 0.805225, loss_d: 0.148805
0.1918 --- loss: 1.238229, loss_ss: 1.146832, loss_d: 0.091397
0.2301 --- loss: 1.289494, loss_ss: 0.818768, loss_d: 0.470725
0.2685 --- loss: 1.828874, loss_ss: 0.759684, loss_d: 1.069190
0.3069 --- loss: 0.998483, loss_ss: 0.745614, loss_d: 0.252869
0.3452 --- loss: 1.327070, loss_ss: 0.743382, loss_d: 0.583688
0.3836 --- loss: 0.950360, loss_ss: 0.720077, loss_d: 0.230283
0.4219 --- loss: 0.832550, loss_ss: 0.707836, loss_d: 0.124714
0.4603 --- loss: 1.048110, loss_ss: 0.810482, loss_d: 0.237628
0.4987 --- loss: 0.979552, loss_ss: 0.821406, loss_d: 0.158147
0.5370 --- loss: 0.993245, loss_ss: 0.624830, loss_d: 0.368415
0.5754 --- loss: 1.703564, loss_ss: 1.297690, loss_d: 0.405874
0.6137 --- loss: 0.929585, loss_ss: 0.810279, loss_d: 0.119305
0.6521 --- loss: 1.114628, loss_ss: 0.853614, loss_d: 0.261014
0.6904 --- loss: 0.948787, loss_ss: 0.827463, loss_d: 0.121324
0.7288 --- loss: 0.703520, loss_ss: 0.577180, loss_d: 0.126341
0.7672 --- loss: 1.035962, loss_ss: 0.674796, loss_d: 0.361166
0.8055 --- loss: 1.232139, loss_ss: 0.927726, loss_d: 0.304412
0.8439 --- loss: 0.919711, loss_ss: 0.732542, loss_d: 0.187169
0.8822 --- loss: 0.950677, loss_ss: 0.719049, loss_d: 0.231628
0.9206 --- loss: 1.205639, loss_ss: 0.860614, loss_d: 0.345025
0.9590 --- loss: 1.365458, loss_ss: 1.058480, loss_d: 0.306978
0.9973 --- loss: 1.285682, loss_ss: 0.617040, loss_d: 0.668642
Epoch finished! Loss: 1.1515501173642966
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8193548387096774
             precision    recall  f1-score   support

        0.0       0.88      0.80      0.84       226
        1.0       0.56      0.09      0.16        55
        2.0       0.74      0.98      0.85       410
        3.0       0.99      0.69      0.82       108
        4.0       1.00      0.76      0.86       131

avg / total       0.83      0.82      0.80       930
 


====== chc016-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.47  80.09   96.45   87.86     83.80
1  94.19   9.09   99.54   55.56     15.63
2  84.30  98.05   73.46   74.44     84.63
3  96.34  69.44   99.88   98.68     81.52
4  96.56  75.57  100.00  100.00     86.09
Total accuracy: 81.94%
Average sen: 66.45%
Average spec: 93.87%
Macro f1-score: 70.33%
[0.82676744 0.34135211 0.24500567 0.15190007 0.66330528 0.12549873
 0.33901179 0.95053554 0.3533169  0.50845361 0.33761373 0.05324429
 0.09302382 0.12171616 0.19460323 0.55226505 0.79758561 0.21264131
 0.35243666 0.45336741 0.44706714 0.96010143 0.97774029 0.73817033
 0.18947218 0.78103614 0.92664278 0.31624117 0.62413734 0.51475286
 0.43398666]
pred: 0.4704191204040281, label: 0
Right! Diagnosis: Other

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.519346, loss_ss: 1.828592, loss_d: 0.690754
0.0383 --- loss: 2.974774, loss_ss: 1.659718, loss_d: 1.315055
0.0766 --- loss: 2.186563, loss_ss: 1.606897, loss_d: 0.579665
0.1149 --- loss: 2.391865, loss_ss: 1.707596, loss_d: 0.684269
0.1532 --- loss: 2.164380, loss_ss: 1.645069, loss_d: 0.519311
0.1915 --- loss: 2.045516, loss_ss: 1.453132, loss_d: 0.592384
0.2298 --- loss: 1.934010, loss_ss: 1.497460, loss_d: 0.436550
0.2681 --- loss: 2.168805, loss_ss: 1.468584, loss_d: 0.700221
0.3064 --- loss: 2.132710, loss_ss: 1.496989, loss_d: 0.635720
0.3447 --- loss: 1.844890, loss_ss: 1.450080, loss_d: 0.394810
0.3830 --- loss: 1.937400, loss_ss: 1.455659, loss_d: 0.481741
0.4213 --- loss: 2.174562, loss_ss: 1.573436, loss_d: 0.601126
0.4596 --- loss: 2.098061, loss_ss: 1.432905, loss_d: 0.665156
0.4979 --- loss: 1.966669, loss_ss: 1.411310, loss_d: 0.555358
0.5362 --- loss: 2.044885, loss_ss: 1.413498, loss_d: 0.631386
0.5745 --- loss: 1.913524, loss_ss: 1.345137, loss_d: 0.568386
0.6128 --- loss: 2.362328, loss_ss: 1.417982, loss_d: 0.944345
0.6511 --- loss: 1.733861, loss_ss: 1.282597, loss_d: 0.451264
0.6894 --- loss: 2.033105, loss_ss: 1.248302, loss_d: 0.784803
0.7277 --- loss: 1.706015, loss_ss: 1.275086, loss_d: 0.430929
0.7660 --- loss: 2.279039, loss_ss: 1.259155, loss_d: 1.019884
0.8043 --- loss: 1.789198, loss_ss: 1.299329, loss_d: 0.489869
0.8426 --- loss: 1.814211, loss_ss: 1.216300, loss_d: 0.597911
0.8809 --- loss: 1.708034, loss_ss: 1.152245, loss_d: 0.555789
0.9192 --- loss: 1.765487, loss_ss: 1.202188, loss_d: 0.563299
0.9575 --- loss: 1.948069, loss_ss: 1.220294, loss_d: 0.727774
0.9958 --- loss: 1.899866, loss_ss: 1.253294, loss_d: 0.646572
Epoch finished! Loss: 2.004003382733955
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.633958, loss_ss: 1.140623, loss_d: 0.493335
0.0383 --- loss: 1.796941, loss_ss: 1.158100, loss_d: 0.638840
0.0766 --- loss: 1.704433, loss_ss: 1.048209, loss_d: 0.656224
0.1149 --- loss: 1.805514, loss_ss: 1.272413, loss_d: 0.533102
0.1532 --- loss: 1.880929, loss_ss: 1.181415, loss_d: 0.699514
0.1915 --- loss: 1.798635, loss_ss: 1.040561, loss_d: 0.758074
0.2298 --- loss: 2.043469, loss_ss: 1.347886, loss_d: 0.695583
0.2681 --- loss: 1.681299, loss_ss: 1.148530, loss_d: 0.532769
0.3064 --- loss: 1.578411, loss_ss: 1.250655, loss_d: 0.327756
0.3447 --- loss: 1.441306, loss_ss: 0.995796, loss_d: 0.445510
0.3830 --- loss: 1.388338, loss_ss: 0.824411, loss_d: 0.563927
0.4213 --- loss: 1.447632, loss_ss: 0.996728, loss_d: 0.450905
0.4596 --- loss: 1.676591, loss_ss: 1.064607, loss_d: 0.611984
0.4979 --- loss: 2.084798, loss_ss: 1.101150, loss_d: 0.983648
0.5362 --- loss: 1.379077, loss_ss: 0.975336, loss_d: 0.403741
0.5745 --- loss: 2.000121, loss_ss: 1.149829, loss_d: 0.850291
0.6128 --- loss: 1.741539, loss_ss: 1.035348, loss_d: 0.706190
0.6511 --- loss: 1.834639, loss_ss: 1.061604, loss_d: 0.773035
0.6894 --- loss: 1.438514, loss_ss: 1.024305, loss_d: 0.414209
0.7277 --- loss: 1.433078, loss_ss: 1.077333, loss_d: 0.355746
0.7660 --- loss: 1.726725, loss_ss: 1.005417, loss_d: 0.721308
0.8043 --- loss: 1.638082, loss_ss: 1.137113, loss_d: 0.500968
0.8426 --- loss: 1.497421, loss_ss: 0.972330, loss_d: 0.525091
0.8809 --- loss: 1.865004, loss_ss: 1.015663, loss_d: 0.849341
0.9192 --- loss: 1.634080, loss_ss: 1.099850, loss_d: 0.534230
0.9575 --- loss: 1.659010, loss_ss: 0.822493, loss_d: 0.836516
0.9958 --- loss: 1.436024, loss_ss: 1.056993, loss_d: 0.379031
Epoch finished! Loss: 1.6910081371036982
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.901994, loss_ss: 1.087402, loss_d: 0.814592
0.0383 --- loss: 1.735032, loss_ss: 1.143692, loss_d: 0.591339
0.0766 --- loss: 1.900305, loss_ss: 1.066621, loss_d: 0.833684
0.1149 --- loss: 1.649909, loss_ss: 1.076561, loss_d: 0.573348
0.1532 --- loss: 1.787299, loss_ss: 0.998041, loss_d: 0.789258
0.1915 --- loss: 1.517099, loss_ss: 0.999744, loss_d: 0.517355
0.2298 --- loss: 1.612667, loss_ss: 1.017026, loss_d: 0.595641
0.2681 --- loss: 1.630987, loss_ss: 0.990931, loss_d: 0.640056
0.3064 --- loss: 1.304380, loss_ss: 1.032787, loss_d: 0.271592
0.3447 --- loss: 1.529643, loss_ss: 0.909572, loss_d: 0.620071
0.3830 --- loss: 1.793530, loss_ss: 1.009659, loss_d: 0.783871
0.4213 --- loss: 1.622742, loss_ss: 0.883771, loss_d: 0.738971
0.4596 --- loss: 1.425963, loss_ss: 1.002464, loss_d: 0.423499
0.4979 --- loss: 1.448897, loss_ss: 0.906330, loss_d: 0.542567
0.5362 --- loss: 1.155724, loss_ss: 0.670102, loss_d: 0.485622
0.5745 --- loss: 1.807897, loss_ss: 1.231141, loss_d: 0.576756
0.6128 --- loss: 2.038899, loss_ss: 1.277637, loss_d: 0.761262
0.6511 --- loss: 1.690251, loss_ss: 0.998504, loss_d: 0.691747
0.6894 --- loss: 1.387916, loss_ss: 0.813647, loss_d: 0.574268
0.7277 --- loss: 1.900113, loss_ss: 1.274617, loss_d: 0.625496
0.7660 --- loss: 1.352274, loss_ss: 0.956724, loss_d: 0.395550
0.8043 --- loss: 1.505168, loss_ss: 1.267030, loss_d: 0.238139
0.8426 --- loss: 1.453351, loss_ss: 0.846828, loss_d: 0.606522
0.8809 --- loss: 1.656147, loss_ss: 0.860284, loss_d: 0.795863
0.9192 --- loss: 1.785896, loss_ss: 1.237709, loss_d: 0.548187
0.9575 --- loss: 1.594410, loss_ss: 0.938122, loss_d: 0.656288
0.9958 --- loss: 1.644252, loss_ss: 0.989614, loss_d: 0.654639
Epoch finished! Loss: 1.576800916386747
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.588268, loss_ss: 1.159796, loss_d: 0.428473
0.0383 --- loss: 1.646409, loss_ss: 1.108511, loss_d: 0.537898
0.0766 --- loss: 1.498274, loss_ss: 0.927840, loss_d: 0.570435
0.1149 --- loss: 1.226940, loss_ss: 0.944717, loss_d: 0.282223
0.1532 --- loss: 2.295912, loss_ss: 1.077604, loss_d: 1.218307
0.1915 --- loss: 1.644498, loss_ss: 1.033046, loss_d: 0.611452
0.2298 --- loss: 1.272465, loss_ss: 0.684485, loss_d: 0.587979
0.2681 --- loss: 1.511916, loss_ss: 0.832524, loss_d: 0.679392
0.3064 --- loss: 1.411957, loss_ss: 0.726802, loss_d: 0.685156
0.3447 --- loss: 1.343965, loss_ss: 0.696569, loss_d: 0.647395
0.3830 --- loss: 1.719910, loss_ss: 1.202462, loss_d: 0.517448
0.4213 --- loss: 1.489178, loss_ss: 0.963185, loss_d: 0.525993
0.4596 --- loss: 1.444909, loss_ss: 1.031255, loss_d: 0.413655
0.4979 --- loss: 1.883144, loss_ss: 1.044218, loss_d: 0.838926
0.5362 --- loss: 1.557059, loss_ss: 0.869465, loss_d: 0.687594
0.5745 --- loss: 1.455223, loss_ss: 0.767791, loss_d: 0.687432
0.6128 --- loss: 1.486990, loss_ss: 1.113753, loss_d: 0.373237
0.6511 --- loss: 1.616616, loss_ss: 0.698569, loss_d: 0.918047
0.6894 --- loss: 1.658468, loss_ss: 0.882335, loss_d: 0.776132
0.7277 --- loss: 1.598911, loss_ss: 1.198202, loss_d: 0.400708
0.7660 --- loss: 1.403091, loss_ss: 0.993575, loss_d: 0.409516
0.8043 --- loss: 1.533256, loss_ss: 0.895100, loss_d: 0.638156
0.8426 --- loss: 1.463078, loss_ss: 0.924207, loss_d: 0.538871
0.8809 --- loss: 1.565597, loss_ss: 1.147351, loss_d: 0.418246
0.9192 --- loss: 1.121653, loss_ss: 0.660489, loss_d: 0.461165
0.9575 --- loss: 1.334112, loss_ss: 0.893406, loss_d: 0.440706
0.9958 --- loss: 1.821701, loss_ss: 1.255557, loss_d: 0.566144
Epoch finished! Loss: 1.529133678396086
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.612901, loss_ss: 1.229143, loss_d: 0.383758
0.0383 --- loss: 1.238564, loss_ss: 0.839753, loss_d: 0.398811
0.0766 --- loss: 1.359410, loss_ss: 1.036165, loss_d: 0.323245
0.1149 --- loss: 1.350023, loss_ss: 1.047027, loss_d: 0.302995
0.1532 --- loss: 1.502866, loss_ss: 1.027914, loss_d: 0.474953
0.1915 --- loss: 1.704713, loss_ss: 1.101779, loss_d: 0.602934
0.2298 --- loss: 0.982732, loss_ss: 0.720560, loss_d: 0.262172
0.2681 --- loss: 1.441953, loss_ss: 0.854208, loss_d: 0.587745
0.3064 --- loss: 1.628479, loss_ss: 1.160381, loss_d: 0.468098
0.3447 --- loss: 1.285785, loss_ss: 0.727452, loss_d: 0.558333
0.3830 --- loss: 1.317891, loss_ss: 0.862126, loss_d: 0.455765
0.4213 --- loss: 1.486184, loss_ss: 0.825234, loss_d: 0.660950
0.4596 --- loss: 1.506803, loss_ss: 1.026694, loss_d: 0.480108
0.4979 --- loss: 1.857337, loss_ss: 1.058048, loss_d: 0.799289
0.5362 --- loss: 1.568025, loss_ss: 0.825297, loss_d: 0.742728
0.5745 --- loss: 1.409932, loss_ss: 0.887647, loss_d: 0.522285
0.6128 --- loss: 1.514380, loss_ss: 1.025839, loss_d: 0.488541
0.6511 --- loss: 1.682462, loss_ss: 1.116002, loss_d: 0.566461
0.6894 --- loss: 1.727595, loss_ss: 1.221895, loss_d: 0.505700
0.7277 --- loss: 1.433256, loss_ss: 0.982157, loss_d: 0.451099
0.7660 --- loss: 1.511919, loss_ss: 1.167717, loss_d: 0.344203
0.8043 --- loss: 1.304670, loss_ss: 0.832490, loss_d: 0.472180
0.8426 --- loss: 1.765835, loss_ss: 1.108148, loss_d: 0.657687
0.8809 --- loss: 1.330864, loss_ss: 0.766648, loss_d: 0.564216
0.9192 --- loss: 1.722440, loss_ss: 1.070860, loss_d: 0.651580
0.9575 --- loss: 1.683248, loss_ss: 1.109757, loss_d: 0.573492
0.9958 --- loss: 1.379902, loss_ss: 1.143794, loss_d: 0.236108
Epoch finished! Loss: 1.4813498375059544
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.686610, loss_ss: 1.026883, loss_d: 0.659727
0.0383 --- loss: 1.457389, loss_ss: 1.086246, loss_d: 0.371144
0.0766 --- loss: 1.645727, loss_ss: 1.017925, loss_d: 0.627801
0.1149 --- loss: 1.037684, loss_ss: 0.799812, loss_d: 0.237872
0.1532 --- loss: 1.458982, loss_ss: 1.049246, loss_d: 0.409737
0.1915 --- loss: 1.089143, loss_ss: 0.812182, loss_d: 0.276961
0.2298 --- loss: 1.856480, loss_ss: 1.130497, loss_d: 0.725983
0.2681 --- loss: 1.608523, loss_ss: 1.014867, loss_d: 0.593656
0.3064 --- loss: 1.847720, loss_ss: 1.031079, loss_d: 0.816640
0.3447 --- loss: 1.370582, loss_ss: 0.835131, loss_d: 0.535451
0.3830 --- loss: 1.808406, loss_ss: 0.817623, loss_d: 0.990783
0.4213 --- loss: 1.786555, loss_ss: 1.312622, loss_d: 0.473933
0.4596 --- loss: 1.558749, loss_ss: 1.164664, loss_d: 0.394085
0.4979 --- loss: 1.536912, loss_ss: 1.153514, loss_d: 0.383398
0.5362 --- loss: 1.447396, loss_ss: 1.087247, loss_d: 0.360149
0.5745 --- loss: 1.125819, loss_ss: 0.790145, loss_d: 0.335673
0.6128 --- loss: 1.304964, loss_ss: 1.010381, loss_d: 0.294583
0.6511 --- loss: 1.080079, loss_ss: 0.868664, loss_d: 0.211415
0.6894 --- loss: 1.215424, loss_ss: 0.821603, loss_d: 0.393821
0.7277 --- loss: 1.381364, loss_ss: 0.970976, loss_d: 0.410388
0.7660 --- loss: 1.460870, loss_ss: 1.043674, loss_d: 0.417196
0.8043 --- loss: 1.108597, loss_ss: 0.902450, loss_d: 0.206147
0.8426 --- loss: 0.913887, loss_ss: 0.586329, loss_d: 0.327558
0.8809 --- loss: 1.550704, loss_ss: 1.003402, loss_d: 0.547302
0.9192 --- loss: 1.964847, loss_ss: 0.775090, loss_d: 1.189756
0.9575 --- loss: 1.306437, loss_ss: 1.040079, loss_d: 0.266358
0.9958 --- loss: 0.995784, loss_ss: 0.754832, loss_d: 0.240952
Epoch finished! Loss: 1.3860527404880159
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.066429, loss_ss: 0.772347, loss_d: 0.294083
0.0383 --- loss: 1.094757, loss_ss: 0.782422, loss_d: 0.312335
0.0766 --- loss: 1.193407, loss_ss: 0.917498, loss_d: 0.275909
0.1149 --- loss: 1.928468, loss_ss: 1.310501, loss_d: 0.617967
0.1532 --- loss: 1.092914, loss_ss: 0.872274, loss_d: 0.220640
0.1915 --- loss: 1.259905, loss_ss: 1.019668, loss_d: 0.240237
0.2298 --- loss: 1.511282, loss_ss: 1.053147, loss_d: 0.458134
0.2681 --- loss: 1.408591, loss_ss: 0.761390, loss_d: 0.647200
0.3064 --- loss: 1.332161, loss_ss: 0.986877, loss_d: 0.345284
0.3447 --- loss: 1.833241, loss_ss: 1.051274, loss_d: 0.781967
0.3830 --- loss: 1.459699, loss_ss: 0.677179, loss_d: 0.782520
0.4213 --- loss: 1.379898, loss_ss: 0.966677, loss_d: 0.413221
0.4596 --- loss: 1.165499, loss_ss: 0.964624, loss_d: 0.200875
0.4979 --- loss: 1.371929, loss_ss: 0.897099, loss_d: 0.474830
0.5362 --- loss: 1.206077, loss_ss: 0.714916, loss_d: 0.491161
0.5745 --- loss: 1.529789, loss_ss: 1.158380, loss_d: 0.371408
0.6128 --- loss: 1.099303, loss_ss: 0.688612, loss_d: 0.410691
0.6511 --- loss: 1.445637, loss_ss: 1.138535, loss_d: 0.307102
0.6894 --- loss: 1.199014, loss_ss: 0.875395, loss_d: 0.323618
0.7277 --- loss: 1.559017, loss_ss: 0.794979, loss_d: 0.764039
0.7660 --- loss: 1.614279, loss_ss: 1.067812, loss_d: 0.546466
0.8043 --- loss: 2.121355, loss_ss: 1.288721, loss_d: 0.832634
0.8426 --- loss: 1.360402, loss_ss: 0.995387, loss_d: 0.365016
0.8809 --- loss: 1.352149, loss_ss: 1.061988, loss_d: 0.290161
0.9192 --- loss: 1.400516, loss_ss: 1.016321, loss_d: 0.384195
0.9575 --- loss: 0.989995, loss_ss: 0.830391, loss_d: 0.159603
0.9958 --- loss: 1.139998, loss_ss: 1.025639, loss_d: 0.114359
Epoch finished! Loss: 1.3088939219599025
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.101083, loss_ss: 0.752689, loss_d: 0.348394
0.0383 --- loss: 1.046361, loss_ss: 0.678582, loss_d: 0.367779
0.0766 --- loss: 0.917000, loss_ss: 0.609782, loss_d: 0.307218
0.1149 --- loss: 1.171345, loss_ss: 0.998137, loss_d: 0.173209
0.1532 --- loss: 1.633157, loss_ss: 1.195407, loss_d: 0.437750
0.1915 --- loss: 1.633104, loss_ss: 1.332320, loss_d: 0.300785
0.2298 --- loss: 1.225243, loss_ss: 0.990204, loss_d: 0.235039
0.2681 --- loss: 1.993809, loss_ss: 1.196459, loss_d: 0.797351
0.3064 --- loss: 0.983843, loss_ss: 0.781656, loss_d: 0.202188
0.3447 --- loss: 1.108645, loss_ss: 0.827518, loss_d: 0.281127
0.3830 --- loss: 1.299583, loss_ss: 0.842717, loss_d: 0.456866
0.4213 --- loss: 1.254627, loss_ss: 0.759808, loss_d: 0.494819
0.4596 --- loss: 1.021744, loss_ss: 0.804186, loss_d: 0.217558
0.4979 --- loss: 1.063722, loss_ss: 0.903393, loss_d: 0.160329
0.5362 --- loss: 0.976557, loss_ss: 0.783342, loss_d: 0.193215
0.5745 --- loss: 1.536906, loss_ss: 0.837508, loss_d: 0.699398
0.6128 --- loss: 1.179889, loss_ss: 0.906395, loss_d: 0.273494
0.6511 --- loss: 1.099736, loss_ss: 0.887012, loss_d: 0.212724
0.6894 --- loss: 1.296707, loss_ss: 0.877106, loss_d: 0.419601
0.7277 --- loss: 1.249861, loss_ss: 0.906613, loss_d: 0.343248
0.7660 --- loss: 1.049226, loss_ss: 0.578985, loss_d: 0.470241
0.8043 --- loss: 0.868235, loss_ss: 0.739312, loss_d: 0.128923
0.8426 --- loss: 1.311130, loss_ss: 0.789237, loss_d: 0.521893
0.8809 --- loss: 1.289132, loss_ss: 0.882135, loss_d: 0.406996
0.9192 --- loss: 1.092864, loss_ss: 0.832365, loss_d: 0.260499
0.9575 --- loss: 1.456043, loss_ss: 1.101135, loss_d: 0.354908
0.9958 --- loss: 1.222437, loss_ss: 0.782103, loss_d: 0.440334
Epoch finished! Loss: 1.2453082795344093
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.236394, loss_ss: 0.982726, loss_d: 0.253668
0.0383 --- loss: 1.111439, loss_ss: 0.824509, loss_d: 0.286930
0.0766 --- loss: 1.061125, loss_ss: 0.797778, loss_d: 0.263347
0.1149 --- loss: 1.219602, loss_ss: 0.835122, loss_d: 0.384480
0.1532 --- loss: 0.998618, loss_ss: 0.792432, loss_d: 0.206186
0.1915 --- loss: 1.072572, loss_ss: 0.596127, loss_d: 0.476445
0.2298 --- loss: 1.322837, loss_ss: 1.091478, loss_d: 0.231359
0.2681 --- loss: 1.072066, loss_ss: 0.908583, loss_d: 0.163483
0.3064 --- loss: 1.050768, loss_ss: 0.860032, loss_d: 0.190736
0.3447 --- loss: 1.314171, loss_ss: 0.910509, loss_d: 0.403661
0.3830 --- loss: 0.998224, loss_ss: 0.621613, loss_d: 0.376610
0.4213 --- loss: 1.147324, loss_ss: 0.949218, loss_d: 0.198106
0.4596 --- loss: 1.158245, loss_ss: 1.010247, loss_d: 0.147999
0.4979 --- loss: 0.908511, loss_ss: 0.743958, loss_d: 0.164553
0.5362 --- loss: 1.258900, loss_ss: 0.959891, loss_d: 0.299009
0.5745 --- loss: 1.499390, loss_ss: 0.840630, loss_d: 0.658760
0.6128 --- loss: 1.141682, loss_ss: 0.652018, loss_d: 0.489664
0.6511 --- loss: 1.375325, loss_ss: 0.957333, loss_d: 0.417992
0.6894 --- loss: 1.154624, loss_ss: 0.895411, loss_d: 0.259212
0.7277 --- loss: 1.051110, loss_ss: 0.593820, loss_d: 0.457290
0.7660 --- loss: 1.343787, loss_ss: 1.050822, loss_d: 0.292965
0.8043 --- loss: 1.178908, loss_ss: 0.765320, loss_d: 0.413588
0.8426 --- loss: 1.378937, loss_ss: 0.853279, loss_d: 0.525658
0.8809 --- loss: 1.323312, loss_ss: 0.825844, loss_d: 0.497468
0.9192 --- loss: 1.130309, loss_ss: 0.869906, loss_d: 0.260403
0.9575 --- loss: 1.095377, loss_ss: 0.700443, loss_d: 0.394934
0.9958 --- loss: 1.082791, loss_ss: 0.889874, loss_d: 0.192917
Epoch finished! Loss: 1.2395628804904748
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.355632, loss_ss: 0.996181, loss_d: 0.359451
0.0383 --- loss: 1.050545, loss_ss: 0.848233, loss_d: 0.202312
0.0766 --- loss: 1.411236, loss_ss: 0.696512, loss_d: 0.714724
0.1149 --- loss: 0.888245, loss_ss: 0.738686, loss_d: 0.149558
0.1532 --- loss: 1.259431, loss_ss: 0.765234, loss_d: 0.494197
0.1915 --- loss: 1.265195, loss_ss: 0.864244, loss_d: 0.400950
0.2298 --- loss: 0.817852, loss_ss: 0.578431, loss_d: 0.239421
0.2681 --- loss: 1.095932, loss_ss: 0.766320, loss_d: 0.329612
0.3064 --- loss: 0.847653, loss_ss: 0.730720, loss_d: 0.116933
0.3447 --- loss: 1.321802, loss_ss: 0.748035, loss_d: 0.573767
0.3830 --- loss: 1.234684, loss_ss: 0.918960, loss_d: 0.315724
0.4213 --- loss: 1.133252, loss_ss: 0.895885, loss_d: 0.237367
0.4596 --- loss: 1.131871, loss_ss: 0.768548, loss_d: 0.363322
0.4979 --- loss: 1.291277, loss_ss: 0.859153, loss_d: 0.432123
0.5362 --- loss: 1.048692, loss_ss: 0.956114, loss_d: 0.092578
0.5745 --- loss: 1.605205, loss_ss: 1.097238, loss_d: 0.507967
0.6128 --- loss: 0.892446, loss_ss: 0.724120, loss_d: 0.168326
0.6511 --- loss: 0.775467, loss_ss: 0.612593, loss_d: 0.162874
0.6894 --- loss: 1.310205, loss_ss: 0.747524, loss_d: 0.562681
0.7277 --- loss: 1.358649, loss_ss: 0.970608, loss_d: 0.388042
0.7660 --- loss: 1.709055, loss_ss: 1.120081, loss_d: 0.588974
0.8043 --- loss: 1.006795, loss_ss: 0.842349, loss_d: 0.164446
0.8426 --- loss: 1.139066, loss_ss: 0.861139, loss_d: 0.277928
0.8809 --- loss: 1.020115, loss_ss: 0.782520, loss_d: 0.237595
0.9192 --- loss: 1.054504, loss_ss: 0.646362, loss_d: 0.408142
0.9575 --- loss: 1.575265, loss_ss: 1.458498, loss_d: 0.116767
0.9958 --- loss: 0.740321, loss_ss: 0.590092, loss_d: 0.150230
Epoch finished! Loss: 1.1805504290993643
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7061728395061728
             precision    recall  f1-score   support

        0.0       0.91      0.29      0.44       102
        1.0       0.00      0.00      0.00        15
        2.0       0.86      0.72      0.78       397
        3.0       0.64      0.97      0.77       187
        4.0       0.46      0.70      0.56       109

avg / total       0.75      0.71      0.69       810
 


====== chc022-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  90.74  29.41   99.58  90.91     44.44
1  98.15   0.00  100.00   0.00      0.00
2  80.37  71.54   88.86  86.06     78.13
3  86.91  97.33   83.79  64.31     77.45
4  85.06  69.72   87.45  46.34     55.68
Total accuracy: 70.62%
Average sen: 53.60%
Average spec: 91.93%
Macro f1-score: 51.14%
[0.06270601 0.12960808 0.14376062 0.05057319 0.08034407 0.19047356
 0.10429656 0.08419707 0.137321   0.12205069 0.07272545 0.1267872
 0.10608106 0.11635701 0.16771393 0.05722144 0.07443213 0.08394207
 0.14085481 0.16614018 0.12447947 0.12827156 0.11185479 0.11439104
 0.04485033 0.10182627 0.09578106]
pred: 0.10885335753361385, label: 0
Right! Diagnosis: Other

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.381071, loss_ss: 1.676168, loss_d: 0.704902
0.0383 --- loss: 2.086807, loss_ss: 1.593443, loss_d: 0.493363
0.0766 --- loss: 2.296312, loss_ss: 1.535109, loss_d: 0.761203
0.1149 --- loss: 1.976605, loss_ss: 1.419261, loss_d: 0.557345
0.1532 --- loss: 2.450544, loss_ss: 1.639443, loss_d: 0.811101
0.1915 --- loss: 1.638391, loss_ss: 1.436370, loss_d: 0.202021
0.2298 --- loss: 1.798181, loss_ss: 1.422767, loss_d: 0.375414
0.2681 --- loss: 1.821568, loss_ss: 1.364894, loss_d: 0.456674
0.3064 --- loss: 2.364612, loss_ss: 1.598490, loss_d: 0.766122
0.3447 --- loss: 2.198352, loss_ss: 1.488593, loss_d: 0.709759
0.3830 --- loss: 2.310212, loss_ss: 1.349379, loss_d: 0.960833
0.4213 --- loss: 1.950768, loss_ss: 1.403669, loss_d: 0.547099
0.4596 --- loss: 1.904279, loss_ss: 1.376083, loss_d: 0.528196
0.4979 --- loss: 1.993427, loss_ss: 1.379327, loss_d: 0.614100
0.5362 --- loss: 2.118844, loss_ss: 1.521771, loss_d: 0.597073
0.5745 --- loss: 1.895455, loss_ss: 1.415571, loss_d: 0.479883
0.6128 --- loss: 1.945604, loss_ss: 1.397979, loss_d: 0.547624
0.6511 --- loss: 1.568024, loss_ss: 1.190074, loss_d: 0.377949
0.6894 --- loss: 1.850913, loss_ss: 1.203232, loss_d: 0.647681
0.7277 --- loss: 1.851593, loss_ss: 1.242263, loss_d: 0.609330
0.7660 --- loss: 1.992433, loss_ss: 1.320600, loss_d: 0.671833
0.8043 --- loss: 1.737599, loss_ss: 1.286331, loss_d: 0.451268
0.8426 --- loss: 1.868518, loss_ss: 1.190867, loss_d: 0.677651
0.8809 --- loss: 1.910027, loss_ss: 1.279339, loss_d: 0.630688
0.9192 --- loss: 1.673131, loss_ss: 1.167718, loss_d: 0.505413
0.9575 --- loss: 2.055609, loss_ss: 1.392294, loss_d: 0.663314
0.9958 --- loss: 2.109556, loss_ss: 1.337368, loss_d: 0.772187
Epoch finished! Loss: 1.9551654072100175
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.752435, loss_ss: 1.108452, loss_d: 0.643983
0.0383 --- loss: 1.476742, loss_ss: 1.023085, loss_d: 0.453657
0.0766 --- loss: 1.713848, loss_ss: 0.983650, loss_d: 0.730198
0.1149 --- loss: 1.877820, loss_ss: 1.465984, loss_d: 0.411836
0.1532 --- loss: 1.826719, loss_ss: 1.129386, loss_d: 0.697333
0.1915 --- loss: 1.940304, loss_ss: 1.348306, loss_d: 0.591998
0.2298 --- loss: 1.575625, loss_ss: 1.223822, loss_d: 0.351803
0.2681 --- loss: 1.781324, loss_ss: 1.032929, loss_d: 0.748396
0.3064 --- loss: 1.486102, loss_ss: 0.899787, loss_d: 0.586315
0.3447 --- loss: 1.663874, loss_ss: 1.056574, loss_d: 0.607300
0.3830 --- loss: 1.522015, loss_ss: 1.067442, loss_d: 0.454573
0.4213 --- loss: 1.441247, loss_ss: 1.029370, loss_d: 0.411877
0.4596 --- loss: 1.522470, loss_ss: 0.973203, loss_d: 0.549267
0.4979 --- loss: 1.756632, loss_ss: 1.154698, loss_d: 0.601934
0.5362 --- loss: 1.442380, loss_ss: 0.936379, loss_d: 0.506001
0.5745 --- loss: 1.746899, loss_ss: 0.914146, loss_d: 0.832753
0.6128 --- loss: 1.843989, loss_ss: 1.170510, loss_d: 0.673479
0.6511 --- loss: 1.730170, loss_ss: 1.096422, loss_d: 0.633748
0.6894 --- loss: 1.706850, loss_ss: 1.064392, loss_d: 0.642458
0.7277 --- loss: 1.563016, loss_ss: 1.050396, loss_d: 0.512620
0.7660 --- loss: 1.906258, loss_ss: 0.942546, loss_d: 0.963711
0.8043 --- loss: 1.850827, loss_ss: 1.333629, loss_d: 0.517199
0.8426 --- loss: 1.498976, loss_ss: 0.783222, loss_d: 0.715754
0.8809 --- loss: 1.679876, loss_ss: 1.243686, loss_d: 0.436190
0.9192 --- loss: 1.592489, loss_ss: 0.964111, loss_d: 0.628377
0.9575 --- loss: 1.394633, loss_ss: 0.922675, loss_d: 0.471958
0.9958 --- loss: 1.517022, loss_ss: 0.952934, loss_d: 0.564088
Epoch finished! Loss: 1.6599781727882181
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.546332, loss_ss: 0.913760, loss_d: 0.632573
0.0383 --- loss: 1.221210, loss_ss: 0.757723, loss_d: 0.463486
0.0766 --- loss: 1.365869, loss_ss: 0.814588, loss_d: 0.551281
0.1149 --- loss: 1.340938, loss_ss: 0.784584, loss_d: 0.556354
0.1532 --- loss: 1.640825, loss_ss: 1.088687, loss_d: 0.552138
0.1915 --- loss: 1.693452, loss_ss: 0.772887, loss_d: 0.920565
0.2298 --- loss: 1.522788, loss_ss: 0.841564, loss_d: 0.681225
0.2681 --- loss: 1.719675, loss_ss: 0.950254, loss_d: 0.769421
0.3064 --- loss: 1.561057, loss_ss: 1.073165, loss_d: 0.487892
0.3447 --- loss: 1.148300, loss_ss: 0.871484, loss_d: 0.276816
0.3830 --- loss: 1.390258, loss_ss: 0.976888, loss_d: 0.413370
0.4213 --- loss: 1.306126, loss_ss: 0.977536, loss_d: 0.328590
0.4596 --- loss: 1.497695, loss_ss: 0.915594, loss_d: 0.582102
0.4979 --- loss: 1.454411, loss_ss: 0.970024, loss_d: 0.484387
0.5362 --- loss: 1.512114, loss_ss: 1.059835, loss_d: 0.452279
0.5745 --- loss: 1.952079, loss_ss: 1.018356, loss_d: 0.933722
0.6128 --- loss: 1.550386, loss_ss: 1.054982, loss_d: 0.495404
0.6511 --- loss: 1.213271, loss_ss: 0.926701, loss_d: 0.286570
0.6894 --- loss: 1.430187, loss_ss: 1.076741, loss_d: 0.353446
0.7277 --- loss: 1.525206, loss_ss: 0.982933, loss_d: 0.542273
0.7660 --- loss: 1.112235, loss_ss: 0.854478, loss_d: 0.257757
0.8043 --- loss: 1.092331, loss_ss: 0.751374, loss_d: 0.340957
0.8426 --- loss: 1.419778, loss_ss: 1.155289, loss_d: 0.264489
0.8809 --- loss: 1.547242, loss_ss: 1.095453, loss_d: 0.451790
0.9192 --- loss: 1.272826, loss_ss: 0.827752, loss_d: 0.445074
0.9575 --- loss: 1.503488, loss_ss: 1.079600, loss_d: 0.423888
0.9958 --- loss: 1.650191, loss_ss: 1.036578, loss_d: 0.613614
Epoch finished! Loss: 1.550580933176238
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.318452, loss_ss: 0.697493, loss_d: 0.620959
0.0383 --- loss: 1.611880, loss_ss: 0.917882, loss_d: 0.693998
0.0766 --- loss: 1.904775, loss_ss: 1.412640, loss_d: 0.492135
0.1149 --- loss: 1.808203, loss_ss: 1.306091, loss_d: 0.502112
0.1532 --- loss: 1.602312, loss_ss: 0.978634, loss_d: 0.623678
0.1915 --- loss: 1.603091, loss_ss: 0.871967, loss_d: 0.731124
0.2298 --- loss: 1.128625, loss_ss: 0.733243, loss_d: 0.395382
0.2681 --- loss: 1.235265, loss_ss: 0.893176, loss_d: 0.342089
0.3064 --- loss: 1.608633, loss_ss: 0.899495, loss_d: 0.709138
0.3447 --- loss: 1.508756, loss_ss: 0.878748, loss_d: 0.630008
0.3830 --- loss: 1.594694, loss_ss: 1.179499, loss_d: 0.415195
0.4213 --- loss: 1.484264, loss_ss: 1.051490, loss_d: 0.432774
0.4596 --- loss: 1.622885, loss_ss: 0.856418, loss_d: 0.766467
0.4979 --- loss: 1.616710, loss_ss: 1.108716, loss_d: 0.507994
0.5362 --- loss: 1.266920, loss_ss: 0.991648, loss_d: 0.275272
0.5745 --- loss: 1.561851, loss_ss: 1.075013, loss_d: 0.486838
0.6128 --- loss: 1.395310, loss_ss: 0.784160, loss_d: 0.611150
0.6511 --- loss: 1.175970, loss_ss: 0.707189, loss_d: 0.468781
0.6894 --- loss: 1.355611, loss_ss: 0.832412, loss_d: 0.523199
0.7277 --- loss: 1.381697, loss_ss: 0.910578, loss_d: 0.471119
0.7660 --- loss: 1.307363, loss_ss: 1.067845, loss_d: 0.239517
0.8043 --- loss: 1.570375, loss_ss: 0.709929, loss_d: 0.860447
0.8426 --- loss: 1.493950, loss_ss: 1.046652, loss_d: 0.447298
0.8809 --- loss: 1.261480, loss_ss: 0.759573, loss_d: 0.501908
0.9192 --- loss: 1.189114, loss_ss: 0.717125, loss_d: 0.471989
0.9575 --- loss: 1.762664, loss_ss: 1.113066, loss_d: 0.649598
0.9958 --- loss: 1.011652, loss_ss: 0.662113, loss_d: 0.349538
Epoch finished! Loss: 1.4646966633212064
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.469979, loss_ss: 0.968269, loss_d: 0.501710
0.0383 --- loss: 1.556488, loss_ss: 0.870649, loss_d: 0.685839
0.0766 --- loss: 1.159355, loss_ss: 0.691920, loss_d: 0.467435
0.1149 --- loss: 1.480865, loss_ss: 1.148876, loss_d: 0.331988
0.1532 --- loss: 1.639210, loss_ss: 1.141861, loss_d: 0.497349
0.1915 --- loss: 1.060046, loss_ss: 0.821410, loss_d: 0.238637
0.2298 --- loss: 1.751966, loss_ss: 1.212541, loss_d: 0.539425
0.2681 --- loss: 1.399524, loss_ss: 0.687238, loss_d: 0.712287
0.3064 --- loss: 1.356528, loss_ss: 0.944806, loss_d: 0.411722
0.3447 --- loss: 1.828694, loss_ss: 1.056934, loss_d: 0.771760
0.3830 --- loss: 1.405023, loss_ss: 0.854912, loss_d: 0.550110
0.4213 --- loss: 1.210124, loss_ss: 0.618185, loss_d: 0.591939
0.4596 --- loss: 1.644449, loss_ss: 0.921394, loss_d: 0.723056
0.4979 --- loss: 1.369994, loss_ss: 1.063818, loss_d: 0.306176
0.5362 --- loss: 1.534747, loss_ss: 0.953604, loss_d: 0.581143
0.5745 --- loss: 1.183499, loss_ss: 0.692906, loss_d: 0.490593
0.6128 --- loss: 1.878889, loss_ss: 1.207616, loss_d: 0.671272
0.6511 --- loss: 1.647033, loss_ss: 1.416862, loss_d: 0.230172
0.6894 --- loss: 1.108189, loss_ss: 0.909617, loss_d: 0.198572
0.7277 --- loss: 1.111932, loss_ss: 0.820010, loss_d: 0.291923
0.7660 --- loss: 1.121682, loss_ss: 0.767092, loss_d: 0.354589
0.8043 --- loss: 1.620391, loss_ss: 1.007589, loss_d: 0.612802
0.8426 --- loss: 1.577099, loss_ss: 0.960601, loss_d: 0.616498
0.8809 --- loss: 1.296154, loss_ss: 0.997957, loss_d: 0.298197
0.9192 --- loss: 1.568518, loss_ss: 0.722567, loss_d: 0.845951
0.9575 --- loss: 1.952988, loss_ss: 1.204211, loss_d: 0.748777
0.9958 --- loss: 1.315421, loss_ss: 0.913719, loss_d: 0.401702
Epoch finished! Loss: 1.3661168528242587
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.540358, loss_ss: 1.246660, loss_d: 0.293698
0.0383 --- loss: 1.562121, loss_ss: 0.868146, loss_d: 0.693975
0.0766 --- loss: 1.125772, loss_ss: 0.877477, loss_d: 0.248295
0.1149 --- loss: 0.957455, loss_ss: 0.766653, loss_d: 0.190802
0.1532 --- loss: 1.428021, loss_ss: 0.887066, loss_d: 0.540955
0.1915 --- loss: 1.544512, loss_ss: 0.841715, loss_d: 0.702797
0.2298 --- loss: 1.078630, loss_ss: 0.703408, loss_d: 0.375222
0.2681 --- loss: 1.813347, loss_ss: 1.433566, loss_d: 0.379781
0.3064 --- loss: 1.380524, loss_ss: 0.949992, loss_d: 0.430532
0.3447 --- loss: 1.150291, loss_ss: 0.945855, loss_d: 0.204437
0.3830 --- loss: 1.070617, loss_ss: 0.745007, loss_d: 0.325610
0.4213 --- loss: 1.705248, loss_ss: 1.069999, loss_d: 0.635249
0.4596 --- loss: 1.339323, loss_ss: 1.121192, loss_d: 0.218132
0.4979 --- loss: 1.257904, loss_ss: 0.931705, loss_d: 0.326199
0.5362 --- loss: 1.039981, loss_ss: 0.890657, loss_d: 0.149323
0.5745 --- loss: 1.353244, loss_ss: 0.960967, loss_d: 0.392277
0.6128 --- loss: 1.816254, loss_ss: 0.890681, loss_d: 0.925573
0.6511 --- loss: 0.961962, loss_ss: 0.750752, loss_d: 0.211209
0.6894 --- loss: 1.073408, loss_ss: 0.838326, loss_d: 0.235082
0.7277 --- loss: 1.061655, loss_ss: 0.751129, loss_d: 0.310527
0.7660 --- loss: 1.556112, loss_ss: 1.068356, loss_d: 0.487755
0.8043 --- loss: 1.156637, loss_ss: 0.913904, loss_d: 0.242733
0.8426 --- loss: 1.295745, loss_ss: 0.767728, loss_d: 0.528017
0.8809 --- loss: 1.258599, loss_ss: 0.922864, loss_d: 0.335735
0.9192 --- loss: 1.234625, loss_ss: 0.850166, loss_d: 0.384458
0.9575 --- loss: 1.148303, loss_ss: 0.941007, loss_d: 0.207296
0.9958 --- loss: 1.129112, loss_ss: 0.778957, loss_d: 0.350155
Epoch finished! Loss: 1.2831476033875768
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.053003, loss_ss: 0.843653, loss_d: 0.209350
0.0383 --- loss: 1.632565, loss_ss: 0.870958, loss_d: 0.761607
0.0766 --- loss: 1.489191, loss_ss: 0.944992, loss_d: 0.544198
0.1149 --- loss: 1.329137, loss_ss: 0.954399, loss_d: 0.374738
0.1532 --- loss: 1.060765, loss_ss: 0.804497, loss_d: 0.256268
0.1915 --- loss: 1.283399, loss_ss: 0.921109, loss_d: 0.362289
0.2298 --- loss: 0.704148, loss_ss: 0.575388, loss_d: 0.128760
0.2681 --- loss: 0.793523, loss_ss: 0.633083, loss_d: 0.160439
0.3064 --- loss: 1.171223, loss_ss: 0.741248, loss_d: 0.429975
0.3447 --- loss: 1.440335, loss_ss: 1.148883, loss_d: 0.291452
0.3830 --- loss: 1.621465, loss_ss: 1.040492, loss_d: 0.580973
0.4213 --- loss: 1.185385, loss_ss: 0.930134, loss_d: 0.255251
0.4596 --- loss: 0.986510, loss_ss: 0.771258, loss_d: 0.215252
0.4979 --- loss: 0.835018, loss_ss: 0.644358, loss_d: 0.190661
0.5362 --- loss: 1.056118, loss_ss: 0.804797, loss_d: 0.251320
0.5745 --- loss: 1.252013, loss_ss: 0.996785, loss_d: 0.255228
0.6128 --- loss: 1.875570, loss_ss: 0.945238, loss_d: 0.930332
0.6511 --- loss: 1.449484, loss_ss: 1.019774, loss_d: 0.429710
0.6894 --- loss: 1.629228, loss_ss: 1.137916, loss_d: 0.491311
0.7277 --- loss: 1.032575, loss_ss: 0.824513, loss_d: 0.208061
0.7660 --- loss: 1.253195, loss_ss: 0.836337, loss_d: 0.416858
0.8043 --- loss: 1.186612, loss_ss: 0.871458, loss_d: 0.315154
0.8426 --- loss: 1.171414, loss_ss: 1.034992, loss_d: 0.136423
0.8809 --- loss: 1.408870, loss_ss: 0.971270, loss_d: 0.437599
0.9192 --- loss: 1.214692, loss_ss: 0.930793, loss_d: 0.283899
0.9575 --- loss: 1.266040, loss_ss: 0.841137, loss_d: 0.424903
0.9958 --- loss: 1.480647, loss_ss: 0.708078, loss_d: 0.772569
Epoch finished! Loss: 1.2762035736635726
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.939698, loss_ss: 0.659355, loss_d: 0.280343
0.0383 --- loss: 1.159524, loss_ss: 1.004874, loss_d: 0.154649
0.0766 --- loss: 1.045455, loss_ss: 0.762718, loss_d: 0.282737
0.1149 --- loss: 1.388007, loss_ss: 0.838202, loss_d: 0.549805
0.1532 --- loss: 1.090096, loss_ss: 0.881273, loss_d: 0.208824
0.1915 --- loss: 1.167623, loss_ss: 0.766503, loss_d: 0.401120
0.2298 --- loss: 1.020743, loss_ss: 0.703326, loss_d: 0.317417
0.2681 --- loss: 1.436896, loss_ss: 0.825793, loss_d: 0.611103
0.3064 --- loss: 0.945546, loss_ss: 0.747535, loss_d: 0.198011
0.3447 --- loss: 1.503736, loss_ss: 0.846352, loss_d: 0.657384
0.3830 --- loss: 1.149130, loss_ss: 0.812513, loss_d: 0.336617
0.4213 --- loss: 1.182020, loss_ss: 0.858138, loss_d: 0.323882
0.4596 --- loss: 1.203326, loss_ss: 0.829144, loss_d: 0.374182
0.4979 --- loss: 1.448565, loss_ss: 1.291043, loss_d: 0.157522
0.5362 --- loss: 1.356067, loss_ss: 0.973048, loss_d: 0.383020
0.5745 --- loss: 1.286692, loss_ss: 0.925575, loss_d: 0.361117
0.6128 --- loss: 1.434854, loss_ss: 0.978484, loss_d: 0.456370
0.6511 --- loss: 0.977880, loss_ss: 0.829950, loss_d: 0.147929
0.6894 --- loss: 1.068657, loss_ss: 0.676353, loss_d: 0.392304
0.7277 --- loss: 0.995769, loss_ss: 0.755920, loss_d: 0.239849
0.7660 --- loss: 1.128312, loss_ss: 0.868280, loss_d: 0.260032
0.8043 --- loss: 1.284165, loss_ss: 0.733701, loss_d: 0.550464
0.8426 --- loss: 0.808402, loss_ss: 0.677892, loss_d: 0.130510
0.8809 --- loss: 0.760252, loss_ss: 0.634768, loss_d: 0.125483
0.9192 --- loss: 1.383955, loss_ss: 0.884446, loss_d: 0.499510
0.9575 --- loss: 1.234646, loss_ss: 0.869607, loss_d: 0.365038
0.9958 --- loss: 0.890430, loss_ss: 0.766426, loss_d: 0.124004
Epoch finished! Loss: 1.1907498548770774
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.248205, loss_ss: 0.642194, loss_d: 0.606012
0.0383 --- loss: 1.217512, loss_ss: 0.841468, loss_d: 0.376044
0.0766 --- loss: 0.923366, loss_ss: 0.742507, loss_d: 0.180859
0.1149 --- loss: 1.176556, loss_ss: 1.025806, loss_d: 0.150750
0.1532 --- loss: 1.128711, loss_ss: 0.971673, loss_d: 0.157038
0.1915 --- loss: 0.801911, loss_ss: 0.659980, loss_d: 0.141931
0.2298 --- loss: 1.136778, loss_ss: 0.737644, loss_d: 0.399135
0.2681 --- loss: 1.027458, loss_ss: 0.673457, loss_d: 0.354000
0.3064 --- loss: 1.470302, loss_ss: 1.134618, loss_d: 0.335685
0.3447 --- loss: 1.016575, loss_ss: 0.844990, loss_d: 0.171586
0.3830 --- loss: 1.087715, loss_ss: 0.947316, loss_d: 0.140399
0.4213 --- loss: 1.379896, loss_ss: 0.890786, loss_d: 0.489110
0.4596 --- loss: 1.149935, loss_ss: 0.668706, loss_d: 0.481229
0.4979 --- loss: 1.230762, loss_ss: 0.984630, loss_d: 0.246133
0.5362 --- loss: 0.796961, loss_ss: 0.574296, loss_d: 0.222665
0.5745 --- loss: 0.906739, loss_ss: 0.762646, loss_d: 0.144093
0.6128 --- loss: 1.238058, loss_ss: 0.798338, loss_d: 0.439720
0.6511 --- loss: 1.011627, loss_ss: 0.783348, loss_d: 0.228279
0.6894 --- loss: 1.018250, loss_ss: 0.806643, loss_d: 0.211607
0.7277 --- loss: 1.202033, loss_ss: 1.044693, loss_d: 0.157340
0.7660 --- loss: 1.308767, loss_ss: 0.990711, loss_d: 0.318055
0.8043 --- loss: 0.768815, loss_ss: 0.680690, loss_d: 0.088124
0.8426 --- loss: 1.130811, loss_ss: 0.808236, loss_d: 0.322575
0.8809 --- loss: 1.507998, loss_ss: 1.047241, loss_d: 0.460757
0.9192 --- loss: 1.074550, loss_ss: 0.816192, loss_d: 0.258358
0.9575 --- loss: 1.209925, loss_ss: 0.671027, loss_d: 0.538897
0.9958 --- loss: 0.939590, loss_ss: 0.758285, loss_d: 0.181306
Epoch finished! Loss: 1.1307317925138949
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.200697, loss_ss: 0.976926, loss_d: 0.223770
0.0383 --- loss: 1.044772, loss_ss: 0.634552, loss_d: 0.410220
0.0766 --- loss: 0.888490, loss_ss: 0.779644, loss_d: 0.108846
0.1149 --- loss: 0.994941, loss_ss: 0.663924, loss_d: 0.331017
0.1532 --- loss: 1.008601, loss_ss: 0.881354, loss_d: 0.127247
0.1915 --- loss: 1.219392, loss_ss: 1.019729, loss_d: 0.199664
0.2298 --- loss: 1.093939, loss_ss: 0.671591, loss_d: 0.422348
0.2681 --- loss: 1.437526, loss_ss: 1.122716, loss_d: 0.314810
0.3064 --- loss: 1.038372, loss_ss: 0.906029, loss_d: 0.132343
0.3447 --- loss: 1.085163, loss_ss: 0.768791, loss_d: 0.316372
0.3830 --- loss: 1.222918, loss_ss: 1.021170, loss_d: 0.201748
0.4213 --- loss: 0.936761, loss_ss: 0.751029, loss_d: 0.185732
0.4596 --- loss: 0.990914, loss_ss: 0.820140, loss_d: 0.170774
0.4979 --- loss: 0.861669, loss_ss: 0.758228, loss_d: 0.103441
0.5362 --- loss: 0.971879, loss_ss: 0.867788, loss_d: 0.104091
0.5745 --- loss: 1.184404, loss_ss: 1.004915, loss_d: 0.179490
0.6128 --- loss: 0.868253, loss_ss: 0.788351, loss_d: 0.079901
0.6511 --- loss: 0.920193, loss_ss: 0.747318, loss_d: 0.172875
0.6894 --- loss: 1.029669, loss_ss: 0.662337, loss_d: 0.367332
0.7277 --- loss: 1.640823, loss_ss: 0.922976, loss_d: 0.717847
0.7660 --- loss: 1.033858, loss_ss: 0.872481, loss_d: 0.161377
0.8043 --- loss: 1.079637, loss_ss: 0.831345, loss_d: 0.248292
0.8426 --- loss: 0.671980, loss_ss: 0.553348, loss_d: 0.118631
0.8809 --- loss: 0.912027, loss_ss: 0.658793, loss_d: 0.253235
0.9192 --- loss: 0.980365, loss_ss: 0.690423, loss_d: 0.289942
0.9575 --- loss: 1.451243, loss_ss: 1.016144, loss_d: 0.435099
0.9958 --- loss: 1.062624, loss_ss: 0.869713, loss_d: 0.192911
Epoch finished! Loss: 1.119779378518291
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5728395061728395
             precision    recall  f1-score   support

        0.0       0.09      0.83      0.16        30
        1.0       0.15      0.07      0.10        67
        2.0       0.87      0.62      0.72       427
        3.0       0.89      0.88      0.88       114
        4.0       0.84      0.41      0.55       172

avg / total       0.78      0.57      0.64       810
 


====== chc025-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  68.02  83.33   67.44   8.96     16.18
1  88.77   7.46   96.10  14.71      9.90
2  75.19  61.83   90.08  87.42     72.43
3  96.79  87.72   98.28  89.29     88.50
4  85.80  40.70   97.96  84.34     54.90
Total accuracy: 57.28%
Average sen: 56.21%
Average spec: 89.97%
Macro f1-score: 48.38%
[0.3612223  0.67088336 0.22359821 0.77399516 0.49084467 0.69461292
 0.04779387 0.05209297 0.10786597 0.06699526 0.09095507 0.03960543
 0.02969171 0.05661989 0.21158417 0.26888919 0.55102634 0.99262553
 0.98561537 0.31742638 0.17599185 0.08597452 0.06296778 0.02775285
 0.87388468 0.19013321 0.19351487]
pred: 0.3201542053785589, label: 0
Right! Diagnosis: Other

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.479608, loss_ss: 1.771711, loss_d: 0.707897
0.0383 --- loss: 2.887025, loss_ss: 1.571037, loss_d: 1.315988
0.0767 --- loss: 2.171579, loss_ss: 1.543127, loss_d: 0.628452
0.1150 --- loss: 2.211101, loss_ss: 1.556018, loss_d: 0.655083
0.1534 --- loss: 2.343481, loss_ss: 1.565888, loss_d: 0.777593
0.1917 --- loss: 1.861989, loss_ss: 1.485194, loss_d: 0.376796
0.2301 --- loss: 2.295111, loss_ss: 1.300974, loss_d: 0.994137
0.2684 --- loss: 2.080856, loss_ss: 1.510616, loss_d: 0.570240
0.3067 --- loss: 1.829087, loss_ss: 1.395504, loss_d: 0.433583
0.3451 --- loss: 1.942890, loss_ss: 1.575037, loss_d: 0.367853
0.3834 --- loss: 1.965629, loss_ss: 1.318491, loss_d: 0.647138
0.4218 --- loss: 1.948762, loss_ss: 1.304582, loss_d: 0.644180
0.4601 --- loss: 1.873859, loss_ss: 1.320988, loss_d: 0.552872
0.4985 --- loss: 1.775115, loss_ss: 1.250872, loss_d: 0.524242
0.5368 --- loss: 1.877275, loss_ss: 1.299308, loss_d: 0.577967
0.5752 --- loss: 2.082515, loss_ss: 1.190047, loss_d: 0.892468
0.6135 --- loss: 1.775544, loss_ss: 1.266221, loss_d: 0.509323
0.6518 --- loss: 1.857948, loss_ss: 1.466239, loss_d: 0.391709
0.6902 --- loss: 1.553656, loss_ss: 1.159270, loss_d: 0.394386
0.7285 --- loss: 1.673441, loss_ss: 1.160827, loss_d: 0.512614
0.7669 --- loss: 1.968549, loss_ss: 1.111842, loss_d: 0.856707
0.8052 --- loss: 1.794151, loss_ss: 1.485171, loss_d: 0.308980
0.8436 --- loss: 1.708488, loss_ss: 1.220733, loss_d: 0.487755
0.8819 --- loss: 1.757715, loss_ss: 1.143436, loss_d: 0.614278
0.9202 --- loss: 1.887872, loss_ss: 1.155334, loss_d: 0.732538
0.9586 --- loss: 1.662808, loss_ss: 1.162387, loss_d: 0.500421
0.9969 --- loss: 1.858583, loss_ss: 1.289650, loss_d: 0.568933
Epoch finished! Loss: 1.9469466021427742
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.494921, loss_ss: 1.011718, loss_d: 0.483203
0.0383 --- loss: 1.862126, loss_ss: 1.163211, loss_d: 0.698915
0.0767 --- loss: 1.544990, loss_ss: 1.145936, loss_d: 0.399054
0.1150 --- loss: 1.935541, loss_ss: 1.137152, loss_d: 0.798389
0.1534 --- loss: 1.576373, loss_ss: 1.198843, loss_d: 0.377530
0.1917 --- loss: 2.141071, loss_ss: 1.380413, loss_d: 0.760658
0.2301 --- loss: 1.934157, loss_ss: 1.081670, loss_d: 0.852487
0.2684 --- loss: 1.863048, loss_ss: 1.218897, loss_d: 0.644152
0.3067 --- loss: 1.886486, loss_ss: 1.148381, loss_d: 0.738105
0.3451 --- loss: 1.722800, loss_ss: 1.193942, loss_d: 0.528858
0.3834 --- loss: 1.733995, loss_ss: 1.136338, loss_d: 0.597657
0.4218 --- loss: 1.775070, loss_ss: 1.144030, loss_d: 0.631040
0.4601 --- loss: 2.098064, loss_ss: 1.090703, loss_d: 1.007361
0.4985 --- loss: 1.759122, loss_ss: 1.192470, loss_d: 0.566651
0.5368 --- loss: 1.636103, loss_ss: 1.159568, loss_d: 0.476535
0.5752 --- loss: 1.570633, loss_ss: 1.091977, loss_d: 0.478656
0.6135 --- loss: 1.579975, loss_ss: 0.979318, loss_d: 0.600657
0.6518 --- loss: 1.536005, loss_ss: 1.231540, loss_d: 0.304465
0.6902 --- loss: 1.653071, loss_ss: 1.174112, loss_d: 0.478959
0.7285 --- loss: 1.281955, loss_ss: 0.870123, loss_d: 0.411833
0.7669 --- loss: 1.837082, loss_ss: 1.287221, loss_d: 0.549861
0.8052 --- loss: 1.380572, loss_ss: 0.940686, loss_d: 0.439886
0.8436 --- loss: 1.483871, loss_ss: 0.919523, loss_d: 0.564347
0.8819 --- loss: 1.860476, loss_ss: 1.119351, loss_d: 0.741125
0.9202 --- loss: 1.796759, loss_ss: 1.174463, loss_d: 0.622297
0.9586 --- loss: 1.600374, loss_ss: 0.983925, loss_d: 0.616450
0.9969 --- loss: 1.841182, loss_ss: 1.138953, loss_d: 0.702229
Epoch finished! Loss: 1.6999207881780771
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.634357, loss_ss: 1.273995, loss_d: 0.360362
0.0383 --- loss: 1.782931, loss_ss: 1.286711, loss_d: 0.496220
0.0767 --- loss: 1.493773, loss_ss: 0.988450, loss_d: 0.505323
0.1150 --- loss: 1.529111, loss_ss: 1.093688, loss_d: 0.435422
0.1534 --- loss: 1.580335, loss_ss: 1.147629, loss_d: 0.432706
0.1917 --- loss: 1.381840, loss_ss: 1.089357, loss_d: 0.292483
0.2301 --- loss: 1.295089, loss_ss: 0.965742, loss_d: 0.329346
0.2684 --- loss: 1.470528, loss_ss: 0.936248, loss_d: 0.534280
0.3067 --- loss: 1.864752, loss_ss: 1.174814, loss_d: 0.689938
0.3451 --- loss: 1.481422, loss_ss: 1.038696, loss_d: 0.442726
0.3834 --- loss: 1.708939, loss_ss: 1.388822, loss_d: 0.320117
0.4218 --- loss: 1.390847, loss_ss: 0.830341, loss_d: 0.560506
0.4601 --- loss: 1.092725, loss_ss: 0.767640, loss_d: 0.325085
0.4985 --- loss: 1.318361, loss_ss: 0.979764, loss_d: 0.338597
0.5368 --- loss: 1.575630, loss_ss: 1.058162, loss_d: 0.517468
0.5752 --- loss: 1.749088, loss_ss: 1.047178, loss_d: 0.701910
0.6135 --- loss: 1.496076, loss_ss: 0.946259, loss_d: 0.549817
0.6518 --- loss: 1.488838, loss_ss: 0.962590, loss_d: 0.526247
0.6902 --- loss: 1.435046, loss_ss: 0.888977, loss_d: 0.546070
0.7285 --- loss: 1.554643, loss_ss: 1.059380, loss_d: 0.495263
0.7669 --- loss: 1.487391, loss_ss: 0.865763, loss_d: 0.621628
0.8052 --- loss: 1.256879, loss_ss: 0.891900, loss_d: 0.364980
0.8436 --- loss: 1.458292, loss_ss: 0.769453, loss_d: 0.688839
0.8819 --- loss: 1.655206, loss_ss: 1.153407, loss_d: 0.501799
0.9202 --- loss: 1.606384, loss_ss: 1.152692, loss_d: 0.453692
0.9586 --- loss: 1.484800, loss_ss: 0.872218, loss_d: 0.612582
0.9969 --- loss: 1.859066, loss_ss: 1.453511, loss_d: 0.405555
Epoch finished! Loss: 1.5869597820135264
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.559006, loss_ss: 0.975171, loss_d: 0.583836
0.0383 --- loss: 1.353476, loss_ss: 0.883043, loss_d: 0.470432
0.0767 --- loss: 1.652421, loss_ss: 1.281237, loss_d: 0.371185
0.1150 --- loss: 1.835511, loss_ss: 1.090320, loss_d: 0.745191
0.1534 --- loss: 1.542088, loss_ss: 1.180846, loss_d: 0.361242
0.1917 --- loss: 1.093426, loss_ss: 0.759099, loss_d: 0.334327
0.2301 --- loss: 1.987728, loss_ss: 1.240030, loss_d: 0.747699
0.2684 --- loss: 1.306764, loss_ss: 1.010791, loss_d: 0.295973
0.3067 --- loss: 1.397598, loss_ss: 0.884054, loss_d: 0.513544
0.3451 --- loss: 1.835026, loss_ss: 1.366599, loss_d: 0.468427
0.3834 --- loss: 1.123697, loss_ss: 0.810502, loss_d: 0.313195
0.4218 --- loss: 1.443328, loss_ss: 1.098221, loss_d: 0.345107
0.4601 --- loss: 1.796863, loss_ss: 1.403928, loss_d: 0.392935
0.4985 --- loss: 1.228464, loss_ss: 0.822192, loss_d: 0.406272
0.5368 --- loss: 1.078462, loss_ss: 0.809526, loss_d: 0.268936
0.5752 --- loss: 1.449890, loss_ss: 0.937013, loss_d: 0.512877
0.6135 --- loss: 1.327350, loss_ss: 0.974349, loss_d: 0.353002
0.6518 --- loss: 1.481615, loss_ss: 1.103519, loss_d: 0.378096
0.6902 --- loss: 1.466450, loss_ss: 1.080874, loss_d: 0.385576
0.7285 --- loss: 1.531876, loss_ss: 1.113214, loss_d: 0.418663
0.7669 --- loss: 1.264689, loss_ss: 0.605530, loss_d: 0.659159
0.8052 --- loss: 1.409115, loss_ss: 0.993249, loss_d: 0.415865
0.8436 --- loss: 1.104859, loss_ss: 0.747041, loss_d: 0.357817
0.8819 --- loss: 1.644395, loss_ss: 1.219182, loss_d: 0.425213
0.9202 --- loss: 1.736660, loss_ss: 0.997061, loss_d: 0.739599
0.9586 --- loss: 1.282506, loss_ss: 0.949550, loss_d: 0.332956
0.9969 --- loss: 1.369763, loss_ss: 1.107607, loss_d: 0.262156
Epoch finished! Loss: 1.4885500197227184
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.708668, loss_ss: 0.896440, loss_d: 0.812228
0.0383 --- loss: 1.415638, loss_ss: 0.734413, loss_d: 0.681225
0.0767 --- loss: 1.377387, loss_ss: 0.940433, loss_d: 0.436954
0.1150 --- loss: 1.568773, loss_ss: 0.785718, loss_d: 0.783055
0.1534 --- loss: 1.530988, loss_ss: 1.125526, loss_d: 0.405462
0.1917 --- loss: 1.333418, loss_ss: 0.847848, loss_d: 0.485571
0.2301 --- loss: 1.375708, loss_ss: 0.909950, loss_d: 0.465758
0.2684 --- loss: 1.405902, loss_ss: 1.024672, loss_d: 0.381230
0.3067 --- loss: 0.926938, loss_ss: 0.735270, loss_d: 0.191668
0.3451 --- loss: 1.073707, loss_ss: 0.868801, loss_d: 0.204906
0.3834 --- loss: 1.244717, loss_ss: 0.802830, loss_d: 0.441887
0.4218 --- loss: 1.493931, loss_ss: 1.067109, loss_d: 0.426822
0.4601 --- loss: 1.397949, loss_ss: 0.988709, loss_d: 0.409240
0.4985 --- loss: 1.390028, loss_ss: 1.032978, loss_d: 0.357050
0.5368 --- loss: 1.251452, loss_ss: 0.763554, loss_d: 0.487899
0.5752 --- loss: 1.551018, loss_ss: 1.298781, loss_d: 0.252238
0.6135 --- loss: 0.928259, loss_ss: 0.688403, loss_d: 0.239856
0.6518 --- loss: 1.545419, loss_ss: 0.942180, loss_d: 0.603239
0.6902 --- loss: 1.590063, loss_ss: 0.905477, loss_d: 0.684587
0.7285 --- loss: 1.371646, loss_ss: 0.946010, loss_d: 0.425635
0.7669 --- loss: 1.526723, loss_ss: 0.939849, loss_d: 0.586874
0.8052 --- loss: 1.083210, loss_ss: 0.807605, loss_d: 0.275604
0.8436 --- loss: 1.462772, loss_ss: 0.736596, loss_d: 0.726176
0.8819 --- loss: 1.373241, loss_ss: 0.828077, loss_d: 0.545164
0.9202 --- loss: 1.304167, loss_ss: 0.931033, loss_d: 0.373134
0.9586 --- loss: 1.193546, loss_ss: 0.885152, loss_d: 0.308394
0.9969 --- loss: 1.485942, loss_ss: 1.135545, loss_d: 0.350397
Epoch finished! Loss: 1.3932871463207097
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.105906, loss_ss: 0.905681, loss_d: 0.200224
0.0383 --- loss: 1.690597, loss_ss: 0.996351, loss_d: 0.694246
0.0767 --- loss: 1.792964, loss_ss: 1.219251, loss_d: 0.573713
0.1150 --- loss: 1.319403, loss_ss: 0.769783, loss_d: 0.549620
0.1534 --- loss: 1.149563, loss_ss: 0.939759, loss_d: 0.209804
0.1917 --- loss: 1.438746, loss_ss: 0.901234, loss_d: 0.537512
0.2301 --- loss: 1.327537, loss_ss: 0.998693, loss_d: 0.328845
0.2684 --- loss: 1.393836, loss_ss: 0.833675, loss_d: 0.560162
0.3067 --- loss: 1.313950, loss_ss: 0.975227, loss_d: 0.338722
0.3451 --- loss: 1.174294, loss_ss: 0.867655, loss_d: 0.306640
0.3834 --- loss: 1.187638, loss_ss: 0.962607, loss_d: 0.225031
0.4218 --- loss: 1.336533, loss_ss: 0.822841, loss_d: 0.513692
0.4601 --- loss: 1.829764, loss_ss: 1.025581, loss_d: 0.804183
0.4985 --- loss: 1.454657, loss_ss: 1.048357, loss_d: 0.406299
0.5368 --- loss: 1.133220, loss_ss: 0.831240, loss_d: 0.301979
0.5752 --- loss: 1.269966, loss_ss: 1.096671, loss_d: 0.173295
0.6135 --- loss: 1.506392, loss_ss: 0.937153, loss_d: 0.569239
0.6518 --- loss: 1.293441, loss_ss: 1.059300, loss_d: 0.234142
0.6902 --- loss: 1.442950, loss_ss: 0.899131, loss_d: 0.543819
0.7285 --- loss: 1.090359, loss_ss: 0.729605, loss_d: 0.360754
0.7669 --- loss: 1.397990, loss_ss: 0.951794, loss_d: 0.446196
0.8052 --- loss: 1.217030, loss_ss: 0.779828, loss_d: 0.437203
0.8436 --- loss: 1.835009, loss_ss: 0.864857, loss_d: 0.970152
0.8819 --- loss: 1.153448, loss_ss: 0.903798, loss_d: 0.249650
0.9202 --- loss: 1.049072, loss_ss: 0.814616, loss_d: 0.234456
0.9586 --- loss: 1.045635, loss_ss: 0.855521, loss_d: 0.190114
0.9969 --- loss: 1.145349, loss_ss: 0.952081, loss_d: 0.193268
Epoch finished! Loss: 1.3357449043255585
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.064933, loss_ss: 0.664718, loss_d: 0.400215
0.0383 --- loss: 0.879633, loss_ss: 0.730435, loss_d: 0.149199
0.0767 --- loss: 1.112238, loss_ss: 0.913384, loss_d: 0.198854
0.1150 --- loss: 1.155704, loss_ss: 0.827309, loss_d: 0.328395
0.1534 --- loss: 1.268841, loss_ss: 0.929011, loss_d: 0.339830
0.1917 --- loss: 1.104312, loss_ss: 0.739394, loss_d: 0.364919
0.2301 --- loss: 1.449084, loss_ss: 1.120600, loss_d: 0.328484
0.2684 --- loss: 1.508799, loss_ss: 0.992009, loss_d: 0.516790
0.3067 --- loss: 1.085476, loss_ss: 0.687095, loss_d: 0.398381
0.3451 --- loss: 2.498220, loss_ss: 1.730491, loss_d: 0.767730
0.3834 --- loss: 1.090990, loss_ss: 0.892243, loss_d: 0.198747
0.4218 --- loss: 1.164890, loss_ss: 0.767842, loss_d: 0.397048
0.4601 --- loss: 1.371233, loss_ss: 1.112271, loss_d: 0.258963
0.4985 --- loss: 1.139079, loss_ss: 0.944197, loss_d: 0.194882
0.5368 --- loss: 1.083413, loss_ss: 0.816767, loss_d: 0.266645
0.5752 --- loss: 0.961154, loss_ss: 0.742794, loss_d: 0.218360
0.6135 --- loss: 1.303373, loss_ss: 1.065104, loss_d: 0.238269
0.6518 --- loss: 1.591393, loss_ss: 0.970613, loss_d: 0.620781
0.6902 --- loss: 1.348884, loss_ss: 1.039753, loss_d: 0.309132
0.7285 --- loss: 1.140949, loss_ss: 0.815307, loss_d: 0.325643
0.7669 --- loss: 0.915466, loss_ss: 0.672841, loss_d: 0.242625
0.8052 --- loss: 1.404557, loss_ss: 1.141161, loss_d: 0.263396
0.8436 --- loss: 1.103860, loss_ss: 0.813682, loss_d: 0.290178
0.8819 --- loss: 1.195939, loss_ss: 1.085622, loss_d: 0.110317
0.9202 --- loss: 1.697478, loss_ss: 1.248749, loss_d: 0.448728
0.9586 --- loss: 1.496682, loss_ss: 1.023801, loss_d: 0.472881
0.9969 --- loss: 1.237111, loss_ss: 0.831854, loss_d: 0.405257
Epoch finished! Loss: 1.2765118915301104
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.201598, loss_ss: 0.929426, loss_d: 0.272172
0.0383 --- loss: 0.929476, loss_ss: 0.739706, loss_d: 0.189769
0.0767 --- loss: 1.611033, loss_ss: 0.648008, loss_d: 0.963026
0.1150 --- loss: 1.122416, loss_ss: 0.913360, loss_d: 0.209055
0.1534 --- loss: 1.296422, loss_ss: 0.839319, loss_d: 0.457103
0.1917 --- loss: 1.172751, loss_ss: 0.716949, loss_d: 0.455802
0.2301 --- loss: 1.460445, loss_ss: 0.673164, loss_d: 0.787281
0.2684 --- loss: 1.403682, loss_ss: 1.026401, loss_d: 0.377281
0.3067 --- loss: 1.300967, loss_ss: 0.640777, loss_d: 0.660190
0.3451 --- loss: 1.221054, loss_ss: 0.796626, loss_d: 0.424427
0.3834 --- loss: 1.184308, loss_ss: 0.949027, loss_d: 0.235281
0.4218 --- loss: 1.397507, loss_ss: 0.701110, loss_d: 0.696397
0.4601 --- loss: 1.210749, loss_ss: 0.738391, loss_d: 0.472358
0.4985 --- loss: 1.040922, loss_ss: 0.767976, loss_d: 0.272946
0.5368 --- loss: 1.297914, loss_ss: 1.051028, loss_d: 0.246886
0.5752 --- loss: 1.414941, loss_ss: 1.016210, loss_d: 0.398731
0.6135 --- loss: 0.826201, loss_ss: 0.710238, loss_d: 0.115962
0.6518 --- loss: 1.068296, loss_ss: 0.907095, loss_d: 0.161201
0.6902 --- loss: 1.534351, loss_ss: 0.795980, loss_d: 0.738371
0.7285 --- loss: 1.067317, loss_ss: 0.819330, loss_d: 0.247988
0.7669 --- loss: 1.170453, loss_ss: 0.969293, loss_d: 0.201160
0.8052 --- loss: 1.239034, loss_ss: 0.973678, loss_d: 0.265356
0.8436 --- loss: 1.489977, loss_ss: 1.061645, loss_d: 0.428332
0.8819 --- loss: 1.197563, loss_ss: 1.086298, loss_d: 0.111265
0.9202 --- loss: 1.098361, loss_ss: 0.694447, loss_d: 0.403914
0.9586 --- loss: 1.270997, loss_ss: 0.926135, loss_d: 0.344862
0.9969 --- loss: 1.251511, loss_ss: 1.088655, loss_d: 0.162856
Epoch finished! Loss: 1.2733876122878147
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.295977, loss_ss: 0.840751, loss_d: 0.455226
0.0383 --- loss: 1.257128, loss_ss: 0.709858, loss_d: 0.547270
0.0767 --- loss: 1.037018, loss_ss: 0.854511, loss_d: 0.182507
0.1150 --- loss: 1.501533, loss_ss: 1.045399, loss_d: 0.456135
0.1534 --- loss: 1.410189, loss_ss: 0.883221, loss_d: 0.526968
0.1917 --- loss: 0.915081, loss_ss: 0.753545, loss_d: 0.161535
0.2301 --- loss: 1.039013, loss_ss: 0.766000, loss_d: 0.273013
0.2684 --- loss: 1.103891, loss_ss: 0.772470, loss_d: 0.331421
0.3067 --- loss: 1.208509, loss_ss: 0.855333, loss_d: 0.353176
0.3451 --- loss: 1.431382, loss_ss: 0.892527, loss_d: 0.538856
0.3834 --- loss: 1.009306, loss_ss: 0.876168, loss_d: 0.133138
0.4218 --- loss: 1.316278, loss_ss: 0.914881, loss_d: 0.401396
0.4601 --- loss: 1.072407, loss_ss: 0.861089, loss_d: 0.211318
0.4985 --- loss: 0.988182, loss_ss: 0.702147, loss_d: 0.286035
0.5368 --- loss: 1.078787, loss_ss: 0.670690, loss_d: 0.408097
0.5752 --- loss: 1.075214, loss_ss: 0.825972, loss_d: 0.249242
0.6135 --- loss: 1.411956, loss_ss: 0.718936, loss_d: 0.693020
0.6518 --- loss: 1.714800, loss_ss: 1.185578, loss_d: 0.529222
0.6902 --- loss: 1.141490, loss_ss: 1.006376, loss_d: 0.135114
0.7285 --- loss: 1.382326, loss_ss: 1.071511, loss_d: 0.310814
0.7669 --- loss: 1.169591, loss_ss: 0.842629, loss_d: 0.326962
0.8052 --- loss: 1.168250, loss_ss: 1.040306, loss_d: 0.127943
0.8436 --- loss: 1.198729, loss_ss: 0.960738, loss_d: 0.237991
0.8819 --- loss: 1.465760, loss_ss: 0.949449, loss_d: 0.516312
0.9202 --- loss: 1.052605, loss_ss: 0.723520, loss_d: 0.329085
0.9586 --- loss: 1.127280, loss_ss: 0.659280, loss_d: 0.468000
0.9969 --- loss: 0.906900, loss_ss: 0.670359, loss_d: 0.236541
Epoch finished! Loss: 1.206273193542774
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.044731, loss_ss: 0.842689, loss_d: 0.202042
0.0383 --- loss: 0.877117, loss_ss: 0.656193, loss_d: 0.220924
0.0767 --- loss: 0.731475, loss_ss: 0.633320, loss_d: 0.098155
0.1150 --- loss: 1.248184, loss_ss: 0.952331, loss_d: 0.295853
0.1534 --- loss: 1.218957, loss_ss: 0.873393, loss_d: 0.345564
0.1917 --- loss: 0.978891, loss_ss: 0.740266, loss_d: 0.238625
0.2301 --- loss: 0.829172, loss_ss: 0.666592, loss_d: 0.162580
0.2684 --- loss: 1.203949, loss_ss: 1.072830, loss_d: 0.131119
0.3067 --- loss: 1.701394, loss_ss: 1.394488, loss_d: 0.306906
0.3451 --- loss: 1.591044, loss_ss: 1.328139, loss_d: 0.262905
0.3834 --- loss: 1.155002, loss_ss: 0.809807, loss_d: 0.345196
0.4218 --- loss: 0.853581, loss_ss: 0.738385, loss_d: 0.115196
0.4601 --- loss: 1.265251, loss_ss: 1.125086, loss_d: 0.140165
0.4985 --- loss: 0.827844, loss_ss: 0.723114, loss_d: 0.104730
0.5368 --- loss: 1.278736, loss_ss: 1.012808, loss_d: 0.265928
0.5752 --- loss: 1.053381, loss_ss: 0.800626, loss_d: 0.252755
0.6135 --- loss: 1.182003, loss_ss: 0.621409, loss_d: 0.560594
0.6518 --- loss: 1.112926, loss_ss: 0.941937, loss_d: 0.170989
0.6902 --- loss: 1.342747, loss_ss: 0.729115, loss_d: 0.613633
0.7285 --- loss: 1.159707, loss_ss: 0.857271, loss_d: 0.302436
0.7669 --- loss: 0.936293, loss_ss: 0.775398, loss_d: 0.160894
0.8052 --- loss: 1.094097, loss_ss: 0.906307, loss_d: 0.187789
0.8436 --- loss: 1.069784, loss_ss: 0.791528, loss_d: 0.278256
0.8819 --- loss: 1.076022, loss_ss: 0.608593, loss_d: 0.467429
0.9202 --- loss: 1.155326, loss_ss: 0.848865, loss_d: 0.306461
0.9586 --- loss: 1.060803, loss_ss: 0.884482, loss_d: 0.176321
0.9969 --- loss: 1.378020, loss_ss: 0.871006, loss_d: 0.507014
Epoch finished! Loss: 1.1882200128757037
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.85
             precision    recall  f1-score   support

        0.0       0.81      0.96      0.88       277
        1.0       0.00      0.00      0.00        66
        2.0       0.80      0.96      0.87       293
        3.0       0.99      0.90      0.94       189
        4.0       1.00      0.63      0.77        75

avg / total       0.80      0.85      0.82       900
 


====== chc027-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %   ppr %  f1-score
0  91.89  96.39   89.89   80.91     87.97
1  92.67   0.00  100.00    0.00      0.00
2  90.78  95.90   88.30   79.83     87.13
3  97.78  89.95   99.86   99.42     94.44
4  96.89  62.67  100.00  100.00     77.05
Total accuracy: 85.00%
Average sen: 68.98%
Average spec: 95.61%
Macro f1-score: 69.32%
[0.02392708 0.09278741 0.02834608 0.03661104 0.09205946 0.02482585
 0.02159492 0.01976206 0.04228578 0.05401971 0.65910405 0.26422331
 0.13889229 0.05821435 0.05072634 0.02270759 0.01596714 0.01951969
 0.03914447 0.02409651 0.03503281 0.09308591 0.04769099 0.08271468
 0.09777814 0.07180252 0.0345954  0.16167909 0.2332013  0.03595154]
pred: 0.08741158352543911, label: 0
Right! Diagnosis: Other

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.597747, loss_ss: 1.735720, loss_d: 0.862027
0.0383 --- loss: 2.301466, loss_ss: 1.678695, loss_d: 0.622771
0.0767 --- loss: 2.055195, loss_ss: 1.395390, loss_d: 0.659805
0.1150 --- loss: 2.103496, loss_ss: 1.529224, loss_d: 0.574272
0.1533 --- loss: 2.153249, loss_ss: 1.346686, loss_d: 0.806563
0.1916 --- loss: 2.076885, loss_ss: 1.413331, loss_d: 0.663554
0.2300 --- loss: 2.403471, loss_ss: 1.362715, loss_d: 1.040756
0.2683 --- loss: 1.868738, loss_ss: 1.285211, loss_d: 0.583526
0.3066 --- loss: 2.351672, loss_ss: 1.722441, loss_d: 0.629232
0.3450 --- loss: 1.757894, loss_ss: 1.362671, loss_d: 0.395223
0.3833 --- loss: 2.041181, loss_ss: 1.305693, loss_d: 0.735488
0.4216 --- loss: 1.759363, loss_ss: 1.408444, loss_d: 0.350919
0.4599 --- loss: 1.924122, loss_ss: 1.336672, loss_d: 0.587450
0.4983 --- loss: 1.896749, loss_ss: 1.313262, loss_d: 0.583486
0.5366 --- loss: 1.533529, loss_ss: 1.215340, loss_d: 0.318189
0.5749 --- loss: 1.803248, loss_ss: 1.153861, loss_d: 0.649387
0.6133 --- loss: 1.836189, loss_ss: 1.234931, loss_d: 0.601258
0.6516 --- loss: 1.815485, loss_ss: 1.260000, loss_d: 0.555485
0.6899 --- loss: 1.619943, loss_ss: 1.366534, loss_d: 0.253409
0.7282 --- loss: 1.757145, loss_ss: 1.133323, loss_d: 0.623823
0.7666 --- loss: 1.781819, loss_ss: 1.242405, loss_d: 0.539414
0.8049 --- loss: 1.679755, loss_ss: 1.160702, loss_d: 0.519053
0.8432 --- loss: 1.765339, loss_ss: 1.328380, loss_d: 0.436960
0.8816 --- loss: 1.613653, loss_ss: 1.202323, loss_d: 0.411330
0.9199 --- loss: 1.838477, loss_ss: 1.134994, loss_d: 0.703483
0.9582 --- loss: 1.777644, loss_ss: 1.284563, loss_d: 0.493081
0.9966 --- loss: 1.520388, loss_ss: 1.024137, loss_d: 0.496251
Epoch finished! Loss: 1.9649921100873213
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.653129, loss_ss: 1.190099, loss_d: 0.463030
0.0383 --- loss: 1.766323, loss_ss: 1.220584, loss_d: 0.545739
0.0767 --- loss: 1.681176, loss_ss: 1.061528, loss_d: 0.619647
0.1150 --- loss: 2.044833, loss_ss: 1.316332, loss_d: 0.728501
0.1533 --- loss: 1.793227, loss_ss: 1.224592, loss_d: 0.568635
0.1916 --- loss: 1.781873, loss_ss: 1.203247, loss_d: 0.578626
0.2300 --- loss: 1.437330, loss_ss: 0.964101, loss_d: 0.473229
0.2683 --- loss: 1.787708, loss_ss: 1.208977, loss_d: 0.578730
0.3066 --- loss: 1.716578, loss_ss: 1.226980, loss_d: 0.489598
0.3450 --- loss: 1.737333, loss_ss: 1.067038, loss_d: 0.670295
0.3833 --- loss: 1.676105, loss_ss: 1.267619, loss_d: 0.408486
0.4216 --- loss: 1.931796, loss_ss: 1.322421, loss_d: 0.609374
0.4599 --- loss: 1.918047, loss_ss: 1.178988, loss_d: 0.739060
0.4983 --- loss: 1.649798, loss_ss: 1.028849, loss_d: 0.620950
0.5366 --- loss: 1.909065, loss_ss: 1.072064, loss_d: 0.837001
0.5749 --- loss: 1.556608, loss_ss: 1.106220, loss_d: 0.450388
0.6133 --- loss: 1.685948, loss_ss: 1.073268, loss_d: 0.612680
0.6516 --- loss: 1.343109, loss_ss: 0.860886, loss_d: 0.482223
0.6899 --- loss: 1.460991, loss_ss: 0.972343, loss_d: 0.488648
0.7282 --- loss: 1.493776, loss_ss: 1.022836, loss_d: 0.470940
0.7666 --- loss: 1.718995, loss_ss: 0.988385, loss_d: 0.730610
0.8049 --- loss: 1.574063, loss_ss: 1.037937, loss_d: 0.536126
0.8432 --- loss: 1.443492, loss_ss: 0.904372, loss_d: 0.539120
0.8816 --- loss: 1.840535, loss_ss: 1.220515, loss_d: 0.620020
0.9199 --- loss: 1.961336, loss_ss: 1.359361, loss_d: 0.601975
0.9582 --- loss: 1.668745, loss_ss: 1.178457, loss_d: 0.490287
0.9966 --- loss: 1.739347, loss_ss: 1.215553, loss_d: 0.523794
Epoch finished! Loss: 1.7002749300920046
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.699384, loss_ss: 1.203279, loss_d: 0.496105
0.0383 --- loss: 1.529792, loss_ss: 0.843646, loss_d: 0.686145
0.0767 --- loss: 1.648778, loss_ss: 1.062404, loss_d: 0.586374
0.1150 --- loss: 1.436792, loss_ss: 0.841629, loss_d: 0.595163
0.1533 --- loss: 1.923471, loss_ss: 1.117594, loss_d: 0.805877
0.1916 --- loss: 1.438207, loss_ss: 0.997215, loss_d: 0.440992
0.2300 --- loss: 1.662671, loss_ss: 0.732685, loss_d: 0.929986
0.2683 --- loss: 1.625842, loss_ss: 1.215366, loss_d: 0.410476
0.3066 --- loss: 1.839385, loss_ss: 1.200757, loss_d: 0.638628
0.3450 --- loss: 1.458098, loss_ss: 0.945380, loss_d: 0.512718
0.3833 --- loss: 1.807156, loss_ss: 1.032212, loss_d: 0.774944
0.4216 --- loss: 1.619292, loss_ss: 0.978224, loss_d: 0.641067
0.4599 --- loss: 1.454964, loss_ss: 0.908694, loss_d: 0.546270
0.4983 --- loss: 1.658957, loss_ss: 1.146199, loss_d: 0.512758
0.5366 --- loss: 1.446348, loss_ss: 0.928056, loss_d: 0.518291
0.5749 --- loss: 1.190931, loss_ss: 0.875473, loss_d: 0.315458
0.6133 --- loss: 1.673284, loss_ss: 0.848340, loss_d: 0.824944
0.6516 --- loss: 1.579937, loss_ss: 1.063645, loss_d: 0.516292
0.6899 --- loss: 1.615827, loss_ss: 0.884728, loss_d: 0.731098
0.7282 --- loss: 1.509779, loss_ss: 0.875806, loss_d: 0.633973
0.7666 --- loss: 1.565198, loss_ss: 0.831084, loss_d: 0.734114
0.8049 --- loss: 1.760040, loss_ss: 1.068187, loss_d: 0.691854
0.8432 --- loss: 1.634904, loss_ss: 1.130268, loss_d: 0.504635
0.8816 --- loss: 1.708688, loss_ss: 0.956142, loss_d: 0.752546
0.9199 --- loss: 1.427096, loss_ss: 0.824748, loss_d: 0.602348
0.9582 --- loss: 1.571884, loss_ss: 1.052930, loss_d: 0.518953
0.9966 --- loss: 1.502574, loss_ss: 0.921648, loss_d: 0.580926
Epoch finished! Loss: 1.6042726296644945
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.938716, loss_ss: 1.179492, loss_d: 0.759225
0.0383 --- loss: 1.423112, loss_ss: 0.800256, loss_d: 0.622856
0.0767 --- loss: 1.863529, loss_ss: 1.480170, loss_d: 0.383360
0.1150 --- loss: 1.650544, loss_ss: 1.033186, loss_d: 0.617358
0.1533 --- loss: 1.733295, loss_ss: 1.057965, loss_d: 0.675330
0.1916 --- loss: 1.533641, loss_ss: 1.131954, loss_d: 0.401687
0.2300 --- loss: 1.683880, loss_ss: 0.885809, loss_d: 0.798070
0.2683 --- loss: 1.635257, loss_ss: 1.016665, loss_d: 0.618592
0.3066 --- loss: 1.533956, loss_ss: 0.936404, loss_d: 0.597551
0.3450 --- loss: 1.400623, loss_ss: 0.996204, loss_d: 0.404419
0.3833 --- loss: 1.495043, loss_ss: 1.091189, loss_d: 0.403854
0.4216 --- loss: 1.656319, loss_ss: 1.133428, loss_d: 0.522891
0.4599 --- loss: 1.231633, loss_ss: 0.969558, loss_d: 0.262075
0.4983 --- loss: 2.049603, loss_ss: 1.188379, loss_d: 0.861224
0.5366 --- loss: 2.079379, loss_ss: 1.326483, loss_d: 0.752896
0.5749 --- loss: 1.630639, loss_ss: 1.036654, loss_d: 0.593985
0.6133 --- loss: 1.759246, loss_ss: 0.937229, loss_d: 0.822017
0.6516 --- loss: 1.575846, loss_ss: 0.801399, loss_d: 0.774447
0.6899 --- loss: 1.618052, loss_ss: 0.837360, loss_d: 0.780692
0.7282 --- loss: 1.747951, loss_ss: 1.141726, loss_d: 0.606226
0.7666 --- loss: 1.554900, loss_ss: 1.080596, loss_d: 0.474305
0.8049 --- loss: 1.520208, loss_ss: 1.121372, loss_d: 0.398836
0.8432 --- loss: 1.544369, loss_ss: 0.761409, loss_d: 0.782961
0.8816 --- loss: 1.639074, loss_ss: 1.127354, loss_d: 0.511720
0.9199 --- loss: 1.830592, loss_ss: 1.194531, loss_d: 0.636061
0.9582 --- loss: 1.312023, loss_ss: 0.708385, loss_d: 0.603638
0.9966 --- loss: 1.377677, loss_ss: 0.937634, loss_d: 0.440042
Epoch finished! Loss: 1.5500657320022584
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.500921, loss_ss: 0.865598, loss_d: 0.635324
0.0383 --- loss: 1.461661, loss_ss: 0.694509, loss_d: 0.767151
0.0767 --- loss: 1.105960, loss_ss: 0.804449, loss_d: 0.301511
0.1150 --- loss: 1.806107, loss_ss: 0.932751, loss_d: 0.873355
0.1533 --- loss: 1.334901, loss_ss: 0.696068, loss_d: 0.638833
0.1916 --- loss: 1.605055, loss_ss: 0.984146, loss_d: 0.620909
0.2300 --- loss: 1.282536, loss_ss: 0.880518, loss_d: 0.402018
0.2683 --- loss: 1.382563, loss_ss: 0.870447, loss_d: 0.512116
0.3066 --- loss: 1.986321, loss_ss: 1.204814, loss_d: 0.781506
0.3450 --- loss: 1.390461, loss_ss: 0.821794, loss_d: 0.568667
0.3833 --- loss: 1.201241, loss_ss: 0.846415, loss_d: 0.354826
0.4216 --- loss: 1.930964, loss_ss: 1.346156, loss_d: 0.584808
0.4599 --- loss: 1.542917, loss_ss: 1.013909, loss_d: 0.529008
0.4983 --- loss: 1.822120, loss_ss: 0.987893, loss_d: 0.834228
0.5366 --- loss: 1.485893, loss_ss: 1.171689, loss_d: 0.314204
0.5749 --- loss: 1.827289, loss_ss: 1.257391, loss_d: 0.569897
0.6133 --- loss: 1.537419, loss_ss: 0.856213, loss_d: 0.681205
0.6516 --- loss: 1.244932, loss_ss: 0.840262, loss_d: 0.404669
0.6899 --- loss: 1.368697, loss_ss: 0.921543, loss_d: 0.447154
0.7282 --- loss: 1.363087, loss_ss: 0.841886, loss_d: 0.521201
0.7666 --- loss: 1.744467, loss_ss: 1.230409, loss_d: 0.514058
0.8049 --- loss: 1.757139, loss_ss: 0.938443, loss_d: 0.818697
0.8432 --- loss: 1.581277, loss_ss: 0.870539, loss_d: 0.710738
0.8816 --- loss: 1.365470, loss_ss: 0.952378, loss_d: 0.413091
0.9199 --- loss: 1.662261, loss_ss: 1.104821, loss_d: 0.557439
0.9582 --- loss: 1.533520, loss_ss: 0.934143, loss_d: 0.599377
0.9966 --- loss: 1.508575, loss_ss: 0.756880, loss_d: 0.751695
Epoch finished! Loss: 1.4964259615311255
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.211099, loss_ss: 0.825999, loss_d: 0.385100
0.0383 --- loss: 1.309547, loss_ss: 0.945564, loss_d: 0.363983
0.0767 --- loss: 1.276864, loss_ss: 0.760709, loss_d: 0.516155
0.1150 --- loss: 1.290491, loss_ss: 0.860122, loss_d: 0.430369
0.1533 --- loss: 1.287607, loss_ss: 0.972118, loss_d: 0.315490
0.1916 --- loss: 1.246265, loss_ss: 0.909417, loss_d: 0.336848
0.2300 --- loss: 1.236994, loss_ss: 0.819478, loss_d: 0.417516
0.2683 --- loss: 1.414465, loss_ss: 1.040052, loss_d: 0.374413
0.3066 --- loss: 1.651643, loss_ss: 1.096585, loss_d: 0.555057
0.3450 --- loss: 1.142352, loss_ss: 0.773276, loss_d: 0.369076
0.3833 --- loss: 1.198841, loss_ss: 0.860053, loss_d: 0.338787
0.4216 --- loss: 1.272758, loss_ss: 0.813312, loss_d: 0.459446
0.4599 --- loss: 1.835023, loss_ss: 1.250718, loss_d: 0.584306
0.4983 --- loss: 1.447160, loss_ss: 0.903355, loss_d: 0.543804
0.5366 --- loss: 1.703764, loss_ss: 0.984826, loss_d: 0.718938
0.5749 --- loss: 1.480422, loss_ss: 0.809853, loss_d: 0.670569
0.6133 --- loss: 1.376072, loss_ss: 0.883183, loss_d: 0.492889
0.6516 --- loss: 1.532897, loss_ss: 1.116140, loss_d: 0.416756
0.6899 --- loss: 1.396824, loss_ss: 0.982702, loss_d: 0.414122
0.7282 --- loss: 1.469722, loss_ss: 1.001977, loss_d: 0.467745
0.7666 --- loss: 1.281375, loss_ss: 0.877950, loss_d: 0.403426
0.8049 --- loss: 1.497759, loss_ss: 0.962857, loss_d: 0.534902
0.8432 --- loss: 1.329028, loss_ss: 0.748171, loss_d: 0.580857
0.8816 --- loss: 1.246786, loss_ss: 0.900461, loss_d: 0.346325
0.9199 --- loss: 1.317106, loss_ss: 0.697800, loss_d: 0.619307
0.9582 --- loss: 1.274019, loss_ss: 1.000829, loss_d: 0.273190
0.9966 --- loss: 1.501047, loss_ss: 1.230370, loss_d: 0.270678
Epoch finished! Loss: 1.4532943374835527
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.422974, loss_ss: 0.942658, loss_d: 0.480315
0.0383 --- loss: 1.586908, loss_ss: 1.165359, loss_d: 0.421548
0.0767 --- loss: 1.871430, loss_ss: 1.307208, loss_d: 0.564223
0.1150 --- loss: 1.428647, loss_ss: 0.833170, loss_d: 0.595477
0.1533 --- loss: 1.204405, loss_ss: 0.722397, loss_d: 0.482008
0.1916 --- loss: 1.390835, loss_ss: 0.968593, loss_d: 0.422241
0.2300 --- loss: 1.661607, loss_ss: 1.183847, loss_d: 0.477760
0.2683 --- loss: 1.636058, loss_ss: 0.904114, loss_d: 0.731944
0.3066 --- loss: 1.126028, loss_ss: 0.688342, loss_d: 0.437686
0.3450 --- loss: 1.467867, loss_ss: 1.128358, loss_d: 0.339510
0.3833 --- loss: 1.666612, loss_ss: 1.351694, loss_d: 0.314918
0.4216 --- loss: 1.354097, loss_ss: 0.854784, loss_d: 0.499313
0.4599 --- loss: 1.273622, loss_ss: 0.936750, loss_d: 0.336872
0.4983 --- loss: 1.350868, loss_ss: 0.844696, loss_d: 0.506171
0.5366 --- loss: 1.880239, loss_ss: 1.555757, loss_d: 0.324482
0.5749 --- loss: 1.873785, loss_ss: 0.655262, loss_d: 1.218523
0.6133 --- loss: 1.280105, loss_ss: 0.974144, loss_d: 0.305961
0.6516 --- loss: 1.375651, loss_ss: 0.963113, loss_d: 0.412538
0.6899 --- loss: 1.290510, loss_ss: 0.975567, loss_d: 0.314943
0.7282 --- loss: 1.737382, loss_ss: 0.975753, loss_d: 0.761629
0.7666 --- loss: 1.831110, loss_ss: 1.364093, loss_d: 0.467017
0.8049 --- loss: 1.410709, loss_ss: 0.874977, loss_d: 0.535733
0.8432 --- loss: 1.283995, loss_ss: 0.937236, loss_d: 0.346758
0.8816 --- loss: 0.725012, loss_ss: 0.474329, loss_d: 0.250683
0.9199 --- loss: 1.163672, loss_ss: 0.637397, loss_d: 0.526276
0.9582 --- loss: 1.418211, loss_ss: 0.665428, loss_d: 0.752783
0.9966 --- loss: 1.344361, loss_ss: 0.815287, loss_d: 0.529074
Epoch finished! Loss: 1.3521700994326518
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.269559, loss_ss: 0.902943, loss_d: 0.366616
0.0383 --- loss: 1.448811, loss_ss: 0.972355, loss_d: 0.476456
0.0767 --- loss: 1.532853, loss_ss: 0.880310, loss_d: 0.652544
0.1150 --- loss: 1.024039, loss_ss: 0.676849, loss_d: 0.347190
0.1533 --- loss: 1.064460, loss_ss: 0.631618, loss_d: 0.432842
0.1916 --- loss: 1.685672, loss_ss: 1.371986, loss_d: 0.313686
0.2300 --- loss: 1.513683, loss_ss: 1.059571, loss_d: 0.454112
0.2683 --- loss: 1.353353, loss_ss: 0.953152, loss_d: 0.400201
0.3066 --- loss: 1.201209, loss_ss: 0.684090, loss_d: 0.517119
0.3450 --- loss: 2.011102, loss_ss: 0.879889, loss_d: 1.131213
0.3833 --- loss: 1.119762, loss_ss: 0.859870, loss_d: 0.259891
0.4216 --- loss: 1.344832, loss_ss: 0.622999, loss_d: 0.721834
0.4599 --- loss: 0.948386, loss_ss: 0.646632, loss_d: 0.301754
0.4983 --- loss: 1.440662, loss_ss: 1.182950, loss_d: 0.257711
0.5366 --- loss: 1.555526, loss_ss: 1.058025, loss_d: 0.497502
0.5749 --- loss: 1.432417, loss_ss: 1.000393, loss_d: 0.432024
0.6133 --- loss: 1.596901, loss_ss: 1.263481, loss_d: 0.333421
0.6516 --- loss: 1.684528, loss_ss: 0.786387, loss_d: 0.898141
0.6899 --- loss: 1.291857, loss_ss: 1.016290, loss_d: 0.275566
0.7282 --- loss: 1.195088, loss_ss: 0.902261, loss_d: 0.292827
0.7666 --- loss: 1.280560, loss_ss: 0.920596, loss_d: 0.359964
0.8049 --- loss: 1.161166, loss_ss: 0.864363, loss_d: 0.296804
0.8432 --- loss: 1.183442, loss_ss: 0.762002, loss_d: 0.421440
0.8816 --- loss: 0.913156, loss_ss: 0.679586, loss_d: 0.233571
0.9199 --- loss: 1.415514, loss_ss: 1.211018, loss_d: 0.204497
0.9582 --- loss: 1.944498, loss_ss: 1.191417, loss_d: 0.753080
0.9966 --- loss: 1.280329, loss_ss: 0.542546, loss_d: 0.737783
Epoch finished! Loss: 1.330624424952727
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.257350, loss_ss: 0.889575, loss_d: 0.367774
0.0383 --- loss: 1.167219, loss_ss: 0.768834, loss_d: 0.398385
0.0767 --- loss: 1.080361, loss_ss: 0.826659, loss_d: 0.253702
0.1150 --- loss: 1.519901, loss_ss: 1.217046, loss_d: 0.302855
0.1533 --- loss: 1.506178, loss_ss: 1.140909, loss_d: 0.365269
0.1916 --- loss: 1.220491, loss_ss: 0.610224, loss_d: 0.610266
0.2300 --- loss: 1.319922, loss_ss: 0.905369, loss_d: 0.414553
0.2683 --- loss: 1.457257, loss_ss: 0.631654, loss_d: 0.825603
0.3066 --- loss: 1.659468, loss_ss: 0.962790, loss_d: 0.696678
0.3450 --- loss: 1.247067, loss_ss: 0.790709, loss_d: 0.456358
0.3833 --- loss: 1.151866, loss_ss: 0.847099, loss_d: 0.304768
0.4216 --- loss: 1.143339, loss_ss: 0.686985, loss_d: 0.456354
0.4599 --- loss: 1.324711, loss_ss: 0.875309, loss_d: 0.449402
0.4983 --- loss: 1.145424, loss_ss: 0.591256, loss_d: 0.554168
0.5366 --- loss: 1.244560, loss_ss: 0.972675, loss_d: 0.271885
0.5749 --- loss: 1.004991, loss_ss: 0.776092, loss_d: 0.228899
0.6133 --- loss: 1.028049, loss_ss: 0.766561, loss_d: 0.261488
0.6516 --- loss: 1.409580, loss_ss: 0.836253, loss_d: 0.573327
0.6899 --- loss: 1.054106, loss_ss: 0.836982, loss_d: 0.217124
0.7282 --- loss: 1.124097, loss_ss: 0.810837, loss_d: 0.313260
0.7666 --- loss: 1.327971, loss_ss: 0.960031, loss_d: 0.367939
0.8049 --- loss: 1.110076, loss_ss: 0.986986, loss_d: 0.123091
0.8432 --- loss: 1.145378, loss_ss: 0.916611, loss_d: 0.228767
0.8816 --- loss: 1.277131, loss_ss: 1.063252, loss_d: 0.213879
0.9199 --- loss: 0.988097, loss_ss: 0.719425, loss_d: 0.268672
0.9582 --- loss: 1.497139, loss_ss: 1.029679, loss_d: 0.467460
0.9966 --- loss: 0.715595, loss_ss: 0.533314, loss_d: 0.182281
Epoch finished! Loss: 1.242454364666572
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.288170, loss_ss: 0.861572, loss_d: 0.426599
0.0383 --- loss: 0.949368, loss_ss: 0.690099, loss_d: 0.259269
0.0767 --- loss: 1.844079, loss_ss: 1.129053, loss_d: 0.715026
0.1150 --- loss: 1.045581, loss_ss: 0.717246, loss_d: 0.328334
0.1533 --- loss: 0.992408, loss_ss: 0.751995, loss_d: 0.240413
0.1916 --- loss: 1.004513, loss_ss: 0.732425, loss_d: 0.272088
0.2300 --- loss: 1.127580, loss_ss: 0.750871, loss_d: 0.376709
0.2683 --- loss: 1.297087, loss_ss: 0.809027, loss_d: 0.488060
0.3066 --- loss: 1.059557, loss_ss: 0.867178, loss_d: 0.192379
0.3450 --- loss: 1.220423, loss_ss: 0.914614, loss_d: 0.305810
0.3833 --- loss: 1.252179, loss_ss: 0.854160, loss_d: 0.398019
0.4216 --- loss: 1.209691, loss_ss: 0.929229, loss_d: 0.280462
0.4599 --- loss: 1.040522, loss_ss: 0.769506, loss_d: 0.271016
0.4983 --- loss: 0.896400, loss_ss: 0.763222, loss_d: 0.133178
0.5366 --- loss: 0.990230, loss_ss: 0.926248, loss_d: 0.063982
0.5749 --- loss: 1.056913, loss_ss: 0.987141, loss_d: 0.069771
0.6133 --- loss: 1.035709, loss_ss: 0.969186, loss_d: 0.066524
0.6516 --- loss: 0.853707, loss_ss: 0.783209, loss_d: 0.070498
0.6899 --- loss: 1.488028, loss_ss: 1.023584, loss_d: 0.464443
0.7282 --- loss: 1.462002, loss_ss: 1.219897, loss_d: 0.242105
0.7666 --- loss: 1.105598, loss_ss: 0.928004, loss_d: 0.177594
0.8049 --- loss: 1.311093, loss_ss: 1.016224, loss_d: 0.294869
0.8432 --- loss: 1.122750, loss_ss: 0.980192, loss_d: 0.142558
0.8816 --- loss: 1.077928, loss_ss: 0.858608, loss_d: 0.219319
0.9199 --- loss: 1.327999, loss_ss: 1.092864, loss_d: 0.235135
0.9582 --- loss: 1.126373, loss_ss: 0.955434, loss_d: 0.170939
0.9966 --- loss: 1.271973, loss_ss: 1.070760, loss_d: 0.201213
Epoch finished! Loss: 1.1835483615215008
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7402298850574712
             precision    recall  f1-score   support

        0.0       0.65      0.87      0.75       119
        1.0       0.50      0.06      0.10        53
        2.0       0.96      0.67      0.79       460
        3.0       0.84      0.98      0.90       164
        4.0       0.36      0.93      0.52        74

avg / total       0.81      0.74      0.74       870
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.84  87.39   92.54  65.00     74.55
1  93.91   5.66   99.63  50.00     10.17
2  80.92  66.96   96.59  95.65     78.77
3  95.98  97.56   95.61  83.77     90.14
4  85.40  93.24   84.67  36.13     52.08
Total accuracy: 74.02%
Average sen: 70.16%
Average spec: 93.81%
Macro f1-score: 61.14%
[0.03837163 0.03438595 0.01511951 0.86801767 0.3306042  0.22210418
 0.34441507 0.39738289 0.10503801 0.21724981 0.33529401 0.82373524
 0.73289335 0.53714448 0.08441968 0.52715832 0.23257598 0.93367815
 0.12080241 0.07513646 0.33315176 0.21574107 0.13619146 0.21241517
 0.08400746 0.16714148 0.33672604 0.10284897 0.34719852]
pred: 0.30727410059550714, label: 0
Right! Diagnosis: Other

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.269085, loss_ss: 1.566168, loss_d: 0.702917
0.0383 --- loss: 1.936199, loss_ss: 1.653811, loss_d: 0.282388
0.0767 --- loss: 2.110615, loss_ss: 1.604309, loss_d: 0.506306
0.1150 --- loss: 2.133379, loss_ss: 1.643309, loss_d: 0.490070
0.1533 --- loss: 2.401283, loss_ss: 1.537580, loss_d: 0.863703
0.1916 --- loss: 2.122739, loss_ss: 1.438099, loss_d: 0.684640
0.2300 --- loss: 2.011144, loss_ss: 1.488645, loss_d: 0.522500
0.2683 --- loss: 2.398999, loss_ss: 1.533161, loss_d: 0.865838
0.3066 --- loss: 2.043729, loss_ss: 1.565983, loss_d: 0.477746
0.3450 --- loss: 1.891516, loss_ss: 1.556404, loss_d: 0.335112
0.3833 --- loss: 2.053854, loss_ss: 1.420817, loss_d: 0.633037
0.4216 --- loss: 1.797925, loss_ss: 1.482054, loss_d: 0.315871
0.4599 --- loss: 2.000180, loss_ss: 1.343538, loss_d: 0.656642
0.4983 --- loss: 1.907884, loss_ss: 1.380695, loss_d: 0.527189
0.5366 --- loss: 2.088950, loss_ss: 1.403653, loss_d: 0.685298
0.5749 --- loss: 1.708727, loss_ss: 1.284101, loss_d: 0.424626
0.6133 --- loss: 1.727206, loss_ss: 1.320556, loss_d: 0.406649
0.6516 --- loss: 2.368279, loss_ss: 1.568592, loss_d: 0.799687
0.6899 --- loss: 2.093674, loss_ss: 1.322027, loss_d: 0.771647
0.7282 --- loss: 1.961226, loss_ss: 1.386771, loss_d: 0.574456
0.7666 --- loss: 2.029490, loss_ss: 1.446174, loss_d: 0.583316
0.8049 --- loss: 1.837606, loss_ss: 1.313055, loss_d: 0.524551
0.8432 --- loss: 1.799575, loss_ss: 1.410957, loss_d: 0.388618
0.8816 --- loss: 1.909041, loss_ss: 1.392757, loss_d: 0.516283
0.9199 --- loss: 1.867878, loss_ss: 1.212350, loss_d: 0.655528
0.9582 --- loss: 1.723579, loss_ss: 1.127483, loss_d: 0.596096
0.9966 --- loss: 1.898737, loss_ss: 1.451612, loss_d: 0.447125
Epoch finished! Loss: 2.0062382088257715
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.648425, loss_ss: 1.193977, loss_d: 0.454447
0.0383 --- loss: 1.554465, loss_ss: 1.160189, loss_d: 0.394276
0.0767 --- loss: 1.707039, loss_ss: 1.048145, loss_d: 0.658894
0.1150 --- loss: 1.837837, loss_ss: 1.273001, loss_d: 0.564836
0.1533 --- loss: 1.832250, loss_ss: 1.411306, loss_d: 0.420944
0.1916 --- loss: 1.689748, loss_ss: 1.091629, loss_d: 0.598119
0.2300 --- loss: 2.010062, loss_ss: 1.465122, loss_d: 0.544940
0.2683 --- loss: 1.642665, loss_ss: 1.248807, loss_d: 0.393858
0.3066 --- loss: 1.501450, loss_ss: 1.068125, loss_d: 0.433326
0.3450 --- loss: 1.563039, loss_ss: 1.144276, loss_d: 0.418764
0.3833 --- loss: 1.936374, loss_ss: 1.030914, loss_d: 0.905461
0.4216 --- loss: 1.775347, loss_ss: 1.190205, loss_d: 0.585141
0.4599 --- loss: 1.728484, loss_ss: 1.151419, loss_d: 0.577065
0.4983 --- loss: 1.858268, loss_ss: 1.321353, loss_d: 0.536915
0.5366 --- loss: 1.470030, loss_ss: 0.918581, loss_d: 0.551449
0.5749 --- loss: 1.626368, loss_ss: 0.961886, loss_d: 0.664483
0.6133 --- loss: 2.032650, loss_ss: 1.241515, loss_d: 0.791135
0.6516 --- loss: 1.987645, loss_ss: 0.911121, loss_d: 1.076524
0.6899 --- loss: 1.316540, loss_ss: 0.988982, loss_d: 0.327559
0.7282 --- loss: 1.496365, loss_ss: 0.819568, loss_d: 0.676797
0.7666 --- loss: 1.606158, loss_ss: 0.934562, loss_d: 0.671596
0.8049 --- loss: 1.859781, loss_ss: 1.102181, loss_d: 0.757600
0.8432 --- loss: 1.700817, loss_ss: 0.912111, loss_d: 0.788706
0.8816 --- loss: 1.385995, loss_ss: 0.957343, loss_d: 0.428652
0.9199 --- loss: 1.413350, loss_ss: 1.061911, loss_d: 0.351439
0.9582 --- loss: 1.264110, loss_ss: 0.854539, loss_d: 0.409570
0.9966 --- loss: 1.520067, loss_ss: 1.242911, loss_d: 0.277156
Epoch finished! Loss: 1.7031566716157474
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.660493, loss_ss: 1.082140, loss_d: 0.578354
0.0383 --- loss: 1.931458, loss_ss: 1.019372, loss_d: 0.912087
0.0767 --- loss: 1.454850, loss_ss: 0.967211, loss_d: 0.487640
0.1150 --- loss: 1.547308, loss_ss: 0.876343, loss_d: 0.670965
0.1533 --- loss: 1.630547, loss_ss: 1.156527, loss_d: 0.474020
0.1916 --- loss: 1.551460, loss_ss: 0.842925, loss_d: 0.708535
0.2300 --- loss: 1.558013, loss_ss: 1.267605, loss_d: 0.290408
0.2683 --- loss: 1.468132, loss_ss: 1.111279, loss_d: 0.356852
0.3066 --- loss: 1.623145, loss_ss: 0.956636, loss_d: 0.666509
0.3450 --- loss: 1.325003, loss_ss: 1.022419, loss_d: 0.302584
0.3833 --- loss: 1.276259, loss_ss: 0.933290, loss_d: 0.342969
0.4216 --- loss: 1.580869, loss_ss: 1.161373, loss_d: 0.419496
0.4599 --- loss: 1.872379, loss_ss: 0.959720, loss_d: 0.912659
0.4983 --- loss: 1.214351, loss_ss: 0.765953, loss_d: 0.448398
0.5366 --- loss: 1.337456, loss_ss: 1.086637, loss_d: 0.250819
0.5749 --- loss: 1.629699, loss_ss: 0.987406, loss_d: 0.642292
0.6133 --- loss: 1.424599, loss_ss: 0.982331, loss_d: 0.442268
0.6516 --- loss: 1.714126, loss_ss: 1.123816, loss_d: 0.590310
0.6899 --- loss: 1.629840, loss_ss: 1.256321, loss_d: 0.373519
0.7282 --- loss: 1.937907, loss_ss: 0.953111, loss_d: 0.984796
0.7666 --- loss: 1.589682, loss_ss: 1.074183, loss_d: 0.515499
0.8049 --- loss: 1.644959, loss_ss: 1.058558, loss_d: 0.586401
0.8432 --- loss: 1.591752, loss_ss: 1.193574, loss_d: 0.398178
0.8816 --- loss: 1.505325, loss_ss: 1.021949, loss_d: 0.483376
0.9199 --- loss: 1.435087, loss_ss: 1.076310, loss_d: 0.358777
0.9582 --- loss: 1.342361, loss_ss: 1.007790, loss_d: 0.334572
0.9966 --- loss: 1.536051, loss_ss: 1.068689, loss_d: 0.467362
Epoch finished! Loss: 1.5483689468640547
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.518249, loss_ss: 1.132615, loss_d: 0.385633
0.0383 --- loss: 1.366201, loss_ss: 1.106704, loss_d: 0.259497
0.0767 --- loss: 1.440003, loss_ss: 0.978150, loss_d: 0.461853
0.1150 --- loss: 1.191509, loss_ss: 0.766628, loss_d: 0.424880
0.1533 --- loss: 1.390672, loss_ss: 0.633143, loss_d: 0.757529
0.1916 --- loss: 1.690342, loss_ss: 1.131655, loss_d: 0.558687
0.2300 --- loss: 1.603424, loss_ss: 0.972314, loss_d: 0.631110
0.2683 --- loss: 1.081976, loss_ss: 0.767329, loss_d: 0.314646
0.3066 --- loss: 1.123435, loss_ss: 0.889474, loss_d: 0.233961
0.3450 --- loss: 1.363006, loss_ss: 0.876450, loss_d: 0.486555
0.3833 --- loss: 1.467427, loss_ss: 1.092747, loss_d: 0.374680
0.4216 --- loss: 1.248095, loss_ss: 0.847786, loss_d: 0.400309
0.4599 --- loss: 1.611096, loss_ss: 0.841431, loss_d: 0.769664
0.4983 --- loss: 1.469338, loss_ss: 0.925151, loss_d: 0.544186
0.5366 --- loss: 2.217029, loss_ss: 1.623882, loss_d: 0.593147
0.5749 --- loss: 1.420329, loss_ss: 0.908610, loss_d: 0.511719
0.6133 --- loss: 1.527283, loss_ss: 1.145065, loss_d: 0.382217
0.6516 --- loss: 1.104966, loss_ss: 0.877401, loss_d: 0.227566
0.6899 --- loss: 1.676120, loss_ss: 0.966175, loss_d: 0.709945
0.7282 --- loss: 1.406182, loss_ss: 0.984867, loss_d: 0.421315
0.7666 --- loss: 1.082731, loss_ss: 0.649700, loss_d: 0.433032
0.8049 --- loss: 1.762587, loss_ss: 1.168197, loss_d: 0.594390
0.8432 --- loss: 1.564379, loss_ss: 0.887514, loss_d: 0.676865
0.8816 --- loss: 1.482891, loss_ss: 0.845220, loss_d: 0.637671
0.9199 --- loss: 1.297750, loss_ss: 0.947402, loss_d: 0.350348
0.9582 --- loss: 1.183866, loss_ss: 0.837643, loss_d: 0.346223
0.9966 --- loss: 1.972631, loss_ss: 0.878548, loss_d: 1.094083
Epoch finished! Loss: 1.4477341778003252
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.384942, loss_ss: 1.147946, loss_d: 0.236997
0.0383 --- loss: 1.852567, loss_ss: 1.111723, loss_d: 0.740844
0.0767 --- loss: 1.274066, loss_ss: 0.865746, loss_d: 0.408320
0.1150 --- loss: 1.110533, loss_ss: 0.728647, loss_d: 0.381887
0.1533 --- loss: 1.128196, loss_ss: 0.965414, loss_d: 0.162782
0.1916 --- loss: 1.388420, loss_ss: 0.842880, loss_d: 0.545540
0.2300 --- loss: 1.129140, loss_ss: 0.896010, loss_d: 0.233129
0.2683 --- loss: 1.412707, loss_ss: 1.025517, loss_d: 0.387190
0.3066 --- loss: 1.282668, loss_ss: 0.871718, loss_d: 0.410950
0.3450 --- loss: 1.016104, loss_ss: 0.821393, loss_d: 0.194711
0.3833 --- loss: 1.665253, loss_ss: 0.979092, loss_d: 0.686161
0.4216 --- loss: 1.223255, loss_ss: 0.993957, loss_d: 0.229298
0.4599 --- loss: 1.735399, loss_ss: 0.830010, loss_d: 0.905389
0.4983 --- loss: 1.427395, loss_ss: 1.019975, loss_d: 0.407421
0.5366 --- loss: 1.450185, loss_ss: 1.117105, loss_d: 0.333080
0.5749 --- loss: 1.219376, loss_ss: 0.874032, loss_d: 0.345344
0.6133 --- loss: 1.169435, loss_ss: 0.905141, loss_d: 0.264293
0.6516 --- loss: 0.949742, loss_ss: 0.718685, loss_d: 0.231057
0.6899 --- loss: 1.348032, loss_ss: 1.010789, loss_d: 0.337243
0.7282 --- loss: 1.020754, loss_ss: 0.757737, loss_d: 0.263017
0.7666 --- loss: 1.322168, loss_ss: 0.728239, loss_d: 0.593929
0.8049 --- loss: 1.232976, loss_ss: 0.873674, loss_d: 0.359302
0.8432 --- loss: 1.405158, loss_ss: 0.778769, loss_d: 0.626389
0.8816 --- loss: 1.155970, loss_ss: 0.790738, loss_d: 0.365233
0.9199 --- loss: 1.224355, loss_ss: 0.835218, loss_d: 0.389137
0.9582 --- loss: 1.095767, loss_ss: 0.860029, loss_d: 0.235738
0.9966 --- loss: 0.952601, loss_ss: 0.806265, loss_d: 0.146336
Epoch finished! Loss: 1.3369328877100577
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.185722, loss_ss: 1.000719, loss_d: 0.185003
0.0383 --- loss: 1.127242, loss_ss: 0.845434, loss_d: 0.281808
0.0767 --- loss: 1.261774, loss_ss: 0.888581, loss_d: 0.373193
0.1150 --- loss: 0.968240, loss_ss: 0.708779, loss_d: 0.259461
0.1533 --- loss: 1.223215, loss_ss: 0.890933, loss_d: 0.332282
0.1916 --- loss: 1.048730, loss_ss: 0.778677, loss_d: 0.270053
0.2300 --- loss: 1.316278, loss_ss: 0.917478, loss_d: 0.398800
0.2683 --- loss: 1.680275, loss_ss: 0.765935, loss_d: 0.914340
0.3066 --- loss: 1.146502, loss_ss: 1.021437, loss_d: 0.125065
0.3450 --- loss: 1.264903, loss_ss: 0.812978, loss_d: 0.451925
0.3833 --- loss: 1.174842, loss_ss: 0.881706, loss_d: 0.293136
0.4216 --- loss: 1.188395, loss_ss: 0.834613, loss_d: 0.353782
0.4599 --- loss: 1.541345, loss_ss: 0.970729, loss_d: 0.570616
0.4983 --- loss: 1.322298, loss_ss: 0.973386, loss_d: 0.348912
0.5366 --- loss: 1.421526, loss_ss: 0.803921, loss_d: 0.617605
0.5749 --- loss: 0.990457, loss_ss: 0.705592, loss_d: 0.284866
0.6133 --- loss: 1.087671, loss_ss: 0.666484, loss_d: 0.421187
0.6516 --- loss: 1.268024, loss_ss: 0.984701, loss_d: 0.283324
0.6899 --- loss: 1.338411, loss_ss: 0.975485, loss_d: 0.362926
0.7282 --- loss: 1.295383, loss_ss: 0.750162, loss_d: 0.545222
0.7666 --- loss: 1.475624, loss_ss: 1.211810, loss_d: 0.263814
0.8049 --- loss: 1.075608, loss_ss: 0.860037, loss_d: 0.215571
0.8432 --- loss: 0.946301, loss_ss: 0.718301, loss_d: 0.228000
0.8816 --- loss: 1.246073, loss_ss: 0.779871, loss_d: 0.466201
0.9199 --- loss: 1.180883, loss_ss: 0.933327, loss_d: 0.247556
0.9582 --- loss: 1.297086, loss_ss: 1.160294, loss_d: 0.136792
0.9966 --- loss: 0.958044, loss_ss: 0.788885, loss_d: 0.169159
Epoch finished! Loss: 1.2839312392931719
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.361405, loss_ss: 1.046353, loss_d: 0.315052
0.0383 --- loss: 1.152830, loss_ss: 0.885953, loss_d: 0.266877
0.0767 --- loss: 1.076010, loss_ss: 0.915055, loss_d: 0.160954
0.1150 --- loss: 1.750264, loss_ss: 1.348408, loss_d: 0.401856
0.1533 --- loss: 1.410487, loss_ss: 1.182603, loss_d: 0.227884
0.1916 --- loss: 1.265368, loss_ss: 0.992273, loss_d: 0.273095
0.2300 --- loss: 1.042112, loss_ss: 0.786331, loss_d: 0.255781
0.2683 --- loss: 0.940002, loss_ss: 0.707815, loss_d: 0.232187
0.3066 --- loss: 1.049786, loss_ss: 0.787547, loss_d: 0.262239
0.3450 --- loss: 0.998770, loss_ss: 0.735057, loss_d: 0.263713
0.3833 --- loss: 1.441941, loss_ss: 1.074180, loss_d: 0.367760
0.4216 --- loss: 1.677077, loss_ss: 1.093819, loss_d: 0.583259
0.4599 --- loss: 1.031658, loss_ss: 0.838890, loss_d: 0.192768
0.4983 --- loss: 1.358401, loss_ss: 0.898683, loss_d: 0.459718
0.5366 --- loss: 0.971624, loss_ss: 0.676928, loss_d: 0.294696
0.5749 --- loss: 1.435855, loss_ss: 1.031386, loss_d: 0.404468
0.6133 --- loss: 1.148437, loss_ss: 0.782437, loss_d: 0.366000
0.6516 --- loss: 0.918256, loss_ss: 0.730475, loss_d: 0.187780
0.6899 --- loss: 1.222388, loss_ss: 1.016345, loss_d: 0.206044
0.7282 --- loss: 1.412049, loss_ss: 1.130900, loss_d: 0.281149
0.7666 --- loss: 0.993852, loss_ss: 0.789028, loss_d: 0.204824
0.8049 --- loss: 1.143701, loss_ss: 0.940428, loss_d: 0.203273
0.8432 --- loss: 1.384102, loss_ss: 0.835128, loss_d: 0.548974
0.8816 --- loss: 1.026603, loss_ss: 0.806247, loss_d: 0.220356
0.9199 --- loss: 1.012167, loss_ss: 0.838403, loss_d: 0.173764
0.9582 --- loss: 0.974919, loss_ss: 0.825177, loss_d: 0.149742
0.9966 --- loss: 1.352691, loss_ss: 1.072652, loss_d: 0.280038
Epoch finished! Loss: 1.20196118584046
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.012336, loss_ss: 0.601048, loss_d: 0.411288
0.0383 --- loss: 1.373941, loss_ss: 1.136961, loss_d: 0.236979
0.0767 --- loss: 1.387345, loss_ss: 1.107616, loss_d: 0.279729
0.1150 --- loss: 1.164778, loss_ss: 0.969397, loss_d: 0.195381
0.1533 --- loss: 1.344075, loss_ss: 1.028390, loss_d: 0.315685
0.1916 --- loss: 1.001334, loss_ss: 0.723509, loss_d: 0.277826
0.2300 --- loss: 1.718361, loss_ss: 1.139105, loss_d: 0.579255
0.2683 --- loss: 1.134681, loss_ss: 0.843305, loss_d: 0.291376
0.3066 --- loss: 1.473083, loss_ss: 0.652351, loss_d: 0.820732
0.3450 --- loss: 0.960171, loss_ss: 0.736544, loss_d: 0.223626
0.3833 --- loss: 1.576878, loss_ss: 1.142993, loss_d: 0.433884
0.4216 --- loss: 0.860191, loss_ss: 0.727429, loss_d: 0.132762
0.4599 --- loss: 0.966834, loss_ss: 0.878522, loss_d: 0.088312
0.4983 --- loss: 1.118906, loss_ss: 0.948065, loss_d: 0.170842
0.5366 --- loss: 0.977699, loss_ss: 0.719888, loss_d: 0.257812
0.5749 --- loss: 1.006891, loss_ss: 0.911107, loss_d: 0.095784
0.6133 --- loss: 1.154285, loss_ss: 0.901236, loss_d: 0.253049
0.6516 --- loss: 1.290104, loss_ss: 0.951869, loss_d: 0.338235
0.6899 --- loss: 1.023393, loss_ss: 0.612509, loss_d: 0.410884
0.7282 --- loss: 1.165666, loss_ss: 0.928226, loss_d: 0.237440
0.7666 --- loss: 1.144779, loss_ss: 0.880262, loss_d: 0.264517
0.8049 --- loss: 0.876374, loss_ss: 0.681798, loss_d: 0.194576
0.8432 --- loss: 1.263552, loss_ss: 0.985242, loss_d: 0.278310
0.8816 --- loss: 0.952194, loss_ss: 0.844854, loss_d: 0.107340
0.9199 --- loss: 1.127590, loss_ss: 0.962363, loss_d: 0.165227
0.9582 --- loss: 1.267706, loss_ss: 1.054057, loss_d: 0.213649
0.9966 --- loss: 1.054319, loss_ss: 0.929988, loss_d: 0.124331
Epoch finished! Loss: 1.1593525061240564
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.267724, loss_ss: 1.109920, loss_d: 0.157804
0.0383 --- loss: 0.981268, loss_ss: 0.881186, loss_d: 0.100082
0.0767 --- loss: 0.968432, loss_ss: 0.744928, loss_d: 0.223504
0.1150 --- loss: 1.054714, loss_ss: 0.859260, loss_d: 0.195454
0.1533 --- loss: 1.203283, loss_ss: 0.843803, loss_d: 0.359480
0.1916 --- loss: 1.141583, loss_ss: 0.947624, loss_d: 0.193959
0.2300 --- loss: 1.270764, loss_ss: 0.792480, loss_d: 0.478284
0.2683 --- loss: 1.298985, loss_ss: 0.963788, loss_d: 0.335197
0.3066 --- loss: 1.193415, loss_ss: 1.002811, loss_d: 0.190605
0.3450 --- loss: 0.844258, loss_ss: 0.671565, loss_d: 0.172693
0.3833 --- loss: 1.586667, loss_ss: 0.966828, loss_d: 0.619839
0.4216 --- loss: 1.166295, loss_ss: 0.782418, loss_d: 0.383877
0.4599 --- loss: 0.872082, loss_ss: 0.706667, loss_d: 0.165416
0.4983 --- loss: 1.007996, loss_ss: 0.861243, loss_d: 0.146752
0.5366 --- loss: 1.126372, loss_ss: 0.880670, loss_d: 0.245702
0.5749 --- loss: 0.747809, loss_ss: 0.606458, loss_d: 0.141351
0.6133 --- loss: 1.604543, loss_ss: 0.782705, loss_d: 0.821838
0.6516 --- loss: 1.293298, loss_ss: 1.203423, loss_d: 0.089875
0.6899 --- loss: 0.926774, loss_ss: 0.705178, loss_d: 0.221596
0.7282 --- loss: 1.645564, loss_ss: 0.938691, loss_d: 0.706873
0.7666 --- loss: 0.956129, loss_ss: 0.845313, loss_d: 0.110815
0.8049 --- loss: 0.879603, loss_ss: 0.665044, loss_d: 0.214559
0.8432 --- loss: 1.026609, loss_ss: 0.923245, loss_d: 0.103364
0.8816 --- loss: 1.095178, loss_ss: 0.886510, loss_d: 0.208668
0.9199 --- loss: 1.728150, loss_ss: 1.542861, loss_d: 0.185289
0.9582 --- loss: 1.145273, loss_ss: 0.778540, loss_d: 0.366733
0.9966 --- loss: 1.381426, loss_ss: 0.928288, loss_d: 0.453138
Epoch finished! Loss: 1.149791514644256
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.005473, loss_ss: 0.726086, loss_d: 0.279387
0.0383 --- loss: 1.070189, loss_ss: 0.837052, loss_d: 0.233138
0.0767 --- loss: 0.891180, loss_ss: 0.774408, loss_d: 0.116772
0.1150 --- loss: 1.073149, loss_ss: 0.998389, loss_d: 0.074760
0.1533 --- loss: 0.722615, loss_ss: 0.668479, loss_d: 0.054136
0.1916 --- loss: 1.296063, loss_ss: 0.981380, loss_d: 0.314683
0.2300 --- loss: 1.145233, loss_ss: 0.705393, loss_d: 0.439840
0.2683 --- loss: 0.793693, loss_ss: 0.586873, loss_d: 0.206820
0.3066 --- loss: 0.952145, loss_ss: 0.834861, loss_d: 0.117284
0.3450 --- loss: 0.996026, loss_ss: 0.855238, loss_d: 0.140789
0.3833 --- loss: 1.010526, loss_ss: 0.744228, loss_d: 0.266298
0.4216 --- loss: 1.123938, loss_ss: 1.025757, loss_d: 0.098181
0.4599 --- loss: 1.504394, loss_ss: 1.357463, loss_d: 0.146930
0.4983 --- loss: 1.076905, loss_ss: 0.743791, loss_d: 0.333114
0.5366 --- loss: 1.038493, loss_ss: 0.900404, loss_d: 0.138090
0.5749 --- loss: 1.250535, loss_ss: 0.867821, loss_d: 0.382714
0.6133 --- loss: 0.776359, loss_ss: 0.626996, loss_d: 0.149363
0.6516 --- loss: 1.559712, loss_ss: 1.415817, loss_d: 0.143895
0.6899 --- loss: 1.268533, loss_ss: 0.836822, loss_d: 0.431711
0.7282 --- loss: 1.354859, loss_ss: 1.162382, loss_d: 0.192477
0.7666 --- loss: 1.069242, loss_ss: 0.855295, loss_d: 0.213946
0.8049 --- loss: 1.189544, loss_ss: 0.905577, loss_d: 0.283967
0.8432 --- loss: 1.195508, loss_ss: 1.024443, loss_d: 0.171065
0.8816 --- loss: 0.887189, loss_ss: 0.765237, loss_d: 0.121952
0.9199 --- loss: 1.303122, loss_ss: 0.766070, loss_d: 0.537052
0.9582 --- loss: 0.979646, loss_ss: 0.859347, loss_d: 0.120299
0.9966 --- loss: 1.574436, loss_ss: 1.085449, loss_d: 0.488987
Epoch finished! Loss: 1.111568609567789
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7804597701149425
             precision    recall  f1-score   support

        0.0       0.62      0.66      0.64        59
        1.0       0.50      0.07      0.12        60
        2.0       0.90      0.81      0.85       389
        3.0       0.77      0.99      0.86       151
        4.0       0.67      0.81      0.73       211

avg / total       0.77      0.78      0.76       870
 


====== chc033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.94  66.10   97.04  61.90     63.93
1  93.10   6.67   99.51  50.00     11.76
2  87.59  81.49   92.52  89.80     85.44
3  94.60  98.68   93.74  76.80     86.38
4  85.86  80.57   87.56  67.46     73.43
Total accuracy: 78.05%
Average sen: 66.70%
Average spec: 94.07%
Macro f1-score: 64.19%
[0.95793509 0.93623161 0.92280149 0.88012308 0.96349263 0.93720293
 0.98486334 0.99677074 0.99828267 0.99059194 0.84265059 0.92169076
 0.98278219 0.80667448 0.89033377 0.94636607 0.98736042 0.99984825
 0.99990344 0.99850178 0.9028722  0.96935475 0.93189776 0.97836775
 0.9991737  0.97498614 0.8937425  0.8316403  0.97865957]
pred: 0.9450035156874821, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.234220, loss_ss: 1.503914, loss_d: 0.730306
0.0383 --- loss: 2.402514, loss_ss: 1.437243, loss_d: 0.965271
0.0767 --- loss: 1.848845, loss_ss: 1.306019, loss_d: 0.542827
0.1150 --- loss: 1.638634, loss_ss: 1.285301, loss_d: 0.353333
0.1534 --- loss: 1.952778, loss_ss: 1.389609, loss_d: 0.563169
0.1917 --- loss: 1.758805, loss_ss: 1.387626, loss_d: 0.371179
0.2301 --- loss: 2.164986, loss_ss: 1.252319, loss_d: 0.912666
0.2684 --- loss: 1.585622, loss_ss: 1.199209, loss_d: 0.386413
0.3067 --- loss: 1.807480, loss_ss: 1.291096, loss_d: 0.516384
0.3451 --- loss: 1.725774, loss_ss: 1.133570, loss_d: 0.592204
0.3834 --- loss: 1.917712, loss_ss: 1.352998, loss_d: 0.564714
0.4218 --- loss: 1.903855, loss_ss: 1.360780, loss_d: 0.543075
0.4601 --- loss: 2.026118, loss_ss: 1.064492, loss_d: 0.961626
0.4985 --- loss: 1.860247, loss_ss: 1.197822, loss_d: 0.662425
0.5368 --- loss: 1.711714, loss_ss: 1.080334, loss_d: 0.631380
0.5752 --- loss: 1.924368, loss_ss: 1.246938, loss_d: 0.677430
0.6135 --- loss: 1.617606, loss_ss: 1.127722, loss_d: 0.489884
0.6518 --- loss: 1.558000, loss_ss: 1.134543, loss_d: 0.423456
0.6902 --- loss: 1.792042, loss_ss: 1.306543, loss_d: 0.485500
0.7285 --- loss: 1.888740, loss_ss: 1.095727, loss_d: 0.793013
0.7669 --- loss: 2.040934, loss_ss: 1.115483, loss_d: 0.925451
0.8052 --- loss: 1.715667, loss_ss: 1.183525, loss_d: 0.532142
0.8436 --- loss: 1.603518, loss_ss: 1.067547, loss_d: 0.535971
0.8819 --- loss: 1.537392, loss_ss: 1.048228, loss_d: 0.489163
0.9202 --- loss: 1.793965, loss_ss: 1.385008, loss_d: 0.408958
0.9586 --- loss: 1.828223, loss_ss: 1.198097, loss_d: 0.630127
0.9969 --- loss: 1.893854, loss_ss: 1.159971, loss_d: 0.733883
Epoch finished! Loss: 1.8435110358091502
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.842462, loss_ss: 1.143516, loss_d: 0.698946
0.0383 --- loss: 1.315682, loss_ss: 0.951995, loss_d: 0.363686
0.0767 --- loss: 1.950539, loss_ss: 1.352686, loss_d: 0.597853
0.1150 --- loss: 1.393953, loss_ss: 0.976941, loss_d: 0.417011
0.1534 --- loss: 1.771287, loss_ss: 0.969704, loss_d: 0.801583
0.1917 --- loss: 1.863193, loss_ss: 1.202646, loss_d: 0.660547
0.2301 --- loss: 1.538385, loss_ss: 1.009359, loss_d: 0.529026
0.2684 --- loss: 1.606163, loss_ss: 0.942048, loss_d: 0.664114
0.3067 --- loss: 1.638321, loss_ss: 1.138083, loss_d: 0.500239
0.3451 --- loss: 1.580525, loss_ss: 1.075816, loss_d: 0.504709
0.3834 --- loss: 1.529854, loss_ss: 1.132801, loss_d: 0.397053
0.4218 --- loss: 1.747223, loss_ss: 1.069496, loss_d: 0.677727
0.4601 --- loss: 1.508566, loss_ss: 0.938306, loss_d: 0.570261
0.4985 --- loss: 1.671997, loss_ss: 1.060448, loss_d: 0.611549
0.5368 --- loss: 1.495218, loss_ss: 1.102533, loss_d: 0.392686
0.5752 --- loss: 1.236045, loss_ss: 0.986224, loss_d: 0.249822
0.6135 --- loss: 1.721505, loss_ss: 1.089488, loss_d: 0.632017
0.6518 --- loss: 2.072859, loss_ss: 0.939506, loss_d: 1.133352
0.6902 --- loss: 1.653229, loss_ss: 1.097785, loss_d: 0.555444
0.7285 --- loss: 1.464859, loss_ss: 0.938204, loss_d: 0.526655
0.7669 --- loss: 1.654153, loss_ss: 1.079700, loss_d: 0.574453
0.8052 --- loss: 1.730554, loss_ss: 1.152914, loss_d: 0.577639
0.8436 --- loss: 1.458911, loss_ss: 0.951174, loss_d: 0.507737
0.8819 --- loss: 1.569768, loss_ss: 1.026172, loss_d: 0.543596
0.9202 --- loss: 1.233649, loss_ss: 0.959052, loss_d: 0.274597
0.9586 --- loss: 1.409280, loss_ss: 0.772456, loss_d: 0.636824
0.9969 --- loss: 1.371662, loss_ss: 0.967713, loss_d: 0.403949
Epoch finished! Loss: 1.6407777038904336
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.493138, loss_ss: 1.057951, loss_d: 0.435187
0.0383 --- loss: 1.416273, loss_ss: 0.940467, loss_d: 0.475807
0.0767 --- loss: 1.302284, loss_ss: 0.914915, loss_d: 0.387369
0.1150 --- loss: 1.535862, loss_ss: 0.995390, loss_d: 0.540472
0.1534 --- loss: 1.261494, loss_ss: 0.809615, loss_d: 0.451879
0.1917 --- loss: 1.567113, loss_ss: 1.081481, loss_d: 0.485632
0.2301 --- loss: 1.557380, loss_ss: 1.150577, loss_d: 0.406803
0.2684 --- loss: 1.599310, loss_ss: 0.886971, loss_d: 0.712339
0.3067 --- loss: 1.688376, loss_ss: 1.130746, loss_d: 0.557630
0.3451 --- loss: 1.349762, loss_ss: 0.990518, loss_d: 0.359245
0.3834 --- loss: 1.272235, loss_ss: 0.797798, loss_d: 0.474437
0.4218 --- loss: 1.294867, loss_ss: 0.769527, loss_d: 0.525340
0.4601 --- loss: 1.961468, loss_ss: 1.344003, loss_d: 0.617465
0.4985 --- loss: 1.895020, loss_ss: 1.353042, loss_d: 0.541978
0.5368 --- loss: 1.458916, loss_ss: 0.948850, loss_d: 0.510066
0.5752 --- loss: 1.549916, loss_ss: 0.886948, loss_d: 0.662969
0.6135 --- loss: 1.911396, loss_ss: 1.290075, loss_d: 0.621321
0.6518 --- loss: 1.612069, loss_ss: 0.955465, loss_d: 0.656604
0.6902 --- loss: 1.597517, loss_ss: 0.883385, loss_d: 0.714132
0.7285 --- loss: 1.752405, loss_ss: 0.901902, loss_d: 0.850503
0.7669 --- loss: 1.425028, loss_ss: 1.047672, loss_d: 0.377355
0.8052 --- loss: 1.475745, loss_ss: 0.661565, loss_d: 0.814180
0.8436 --- loss: 1.606708, loss_ss: 1.148359, loss_d: 0.458349
0.8819 --- loss: 1.800490, loss_ss: 1.223284, loss_d: 0.577206
0.9202 --- loss: 1.545710, loss_ss: 0.709907, loss_d: 0.835803
0.9586 --- loss: 1.346606, loss_ss: 0.960511, loss_d: 0.386096
0.9969 --- loss: 1.546067, loss_ss: 1.039756, loss_d: 0.506311
Epoch finished! Loss: 1.5583819962464847
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.238574, loss_ss: 0.894961, loss_d: 0.343613
0.0383 --- loss: 1.935903, loss_ss: 1.101878, loss_d: 0.834025
0.0767 --- loss: 1.313484, loss_ss: 0.833257, loss_d: 0.480227
0.1150 --- loss: 1.426246, loss_ss: 1.099190, loss_d: 0.327056
0.1534 --- loss: 2.223659, loss_ss: 1.040987, loss_d: 1.182672
0.1917 --- loss: 1.528863, loss_ss: 1.130486, loss_d: 0.398378
0.2301 --- loss: 1.439319, loss_ss: 1.116916, loss_d: 0.322404
0.2684 --- loss: 0.924135, loss_ss: 0.715493, loss_d: 0.208641
0.3067 --- loss: 1.399473, loss_ss: 0.862224, loss_d: 0.537249
0.3451 --- loss: 1.409476, loss_ss: 0.798135, loss_d: 0.611342
0.3834 --- loss: 1.673443, loss_ss: 0.842058, loss_d: 0.831385
0.4218 --- loss: 2.004087, loss_ss: 1.158734, loss_d: 0.845353
0.4601 --- loss: 1.446890, loss_ss: 0.782842, loss_d: 0.664048
0.4985 --- loss: 1.497215, loss_ss: 1.024435, loss_d: 0.472780
0.5368 --- loss: 1.297315, loss_ss: 0.699042, loss_d: 0.598273
0.5752 --- loss: 1.572865, loss_ss: 0.867137, loss_d: 0.705728
0.6135 --- loss: 1.404992, loss_ss: 0.848405, loss_d: 0.556587
0.6518 --- loss: 1.223376, loss_ss: 0.819950, loss_d: 0.403426
0.6902 --- loss: 1.935342, loss_ss: 1.023082, loss_d: 0.912260
0.7285 --- loss: 2.249883, loss_ss: 1.016380, loss_d: 1.233503
0.7669 --- loss: 1.388216, loss_ss: 0.894483, loss_d: 0.493733
0.8052 --- loss: 1.669728, loss_ss: 1.176548, loss_d: 0.493180
0.8436 --- loss: 1.543859, loss_ss: 1.091913, loss_d: 0.451946
0.8819 --- loss: 1.533234, loss_ss: 0.964613, loss_d: 0.568622
0.9202 --- loss: 1.212169, loss_ss: 0.761122, loss_d: 0.451046
0.9586 --- loss: 1.546208, loss_ss: 0.798341, loss_d: 0.747867
0.9969 --- loss: 1.100508, loss_ss: 0.836155, loss_d: 0.264354
Epoch finished! Loss: 1.47813217823322
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.588707, loss_ss: 1.189598, loss_d: 0.399109
0.0383 --- loss: 1.151736, loss_ss: 0.946921, loss_d: 0.204816
0.0767 --- loss: 1.396939, loss_ss: 1.103381, loss_d: 0.293558
0.1150 --- loss: 1.819906, loss_ss: 1.017088, loss_d: 0.802818
0.1534 --- loss: 1.412989, loss_ss: 1.006819, loss_d: 0.406170
0.1917 --- loss: 1.929994, loss_ss: 1.554287, loss_d: 0.375707
0.2301 --- loss: 1.397063, loss_ss: 0.915817, loss_d: 0.481246
0.2684 --- loss: 1.172023, loss_ss: 0.898312, loss_d: 0.273711
0.3067 --- loss: 1.368133, loss_ss: 0.954602, loss_d: 0.413532
0.3451 --- loss: 1.491813, loss_ss: 1.000875, loss_d: 0.490938
0.3834 --- loss: 1.108529, loss_ss: 0.795325, loss_d: 0.313204
0.4218 --- loss: 1.205170, loss_ss: 0.855246, loss_d: 0.349924
0.4601 --- loss: 1.224628, loss_ss: 0.666937, loss_d: 0.557691
0.4985 --- loss: 1.229223, loss_ss: 0.878829, loss_d: 0.350394
0.5368 --- loss: 1.460166, loss_ss: 0.895127, loss_d: 0.565039
0.5752 --- loss: 1.353812, loss_ss: 0.797044, loss_d: 0.556767
0.6135 --- loss: 1.456637, loss_ss: 1.004106, loss_d: 0.452531
0.6518 --- loss: 1.580640, loss_ss: 1.320738, loss_d: 0.259902
0.6902 --- loss: 1.040575, loss_ss: 0.810183, loss_d: 0.230392
0.7285 --- loss: 1.900362, loss_ss: 1.383192, loss_d: 0.517171
0.7669 --- loss: 1.132158, loss_ss: 0.927563, loss_d: 0.204595
0.8052 --- loss: 1.623928, loss_ss: 1.294359, loss_d: 0.329569
0.8436 --- loss: 1.259214, loss_ss: 0.810345, loss_d: 0.448869
0.8819 --- loss: 1.355338, loss_ss: 1.017379, loss_d: 0.337959
0.9202 --- loss: 1.324296, loss_ss: 0.894147, loss_d: 0.430149
0.9586 --- loss: 1.415287, loss_ss: 0.693903, loss_d: 0.721384
0.9969 --- loss: 1.805298, loss_ss: 1.143030, loss_d: 0.662268
Epoch finished! Loss: 1.4050853440394768
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.483877, loss_ss: 0.981181, loss_d: 0.502696
0.0383 --- loss: 1.133787, loss_ss: 0.796499, loss_d: 0.337288
0.0767 --- loss: 1.189997, loss_ss: 0.995589, loss_d: 0.194408
0.1150 --- loss: 1.446533, loss_ss: 0.831989, loss_d: 0.614543
0.1534 --- loss: 1.128677, loss_ss: 0.764828, loss_d: 0.363849
0.1917 --- loss: 1.387702, loss_ss: 0.871185, loss_d: 0.516518
0.2301 --- loss: 1.805643, loss_ss: 1.357050, loss_d: 0.448594
0.2684 --- loss: 0.953408, loss_ss: 0.732601, loss_d: 0.220807
0.3067 --- loss: 1.412256, loss_ss: 0.794604, loss_d: 0.617652
0.3451 --- loss: 1.501766, loss_ss: 0.665671, loss_d: 0.836095
0.3834 --- loss: 1.573850, loss_ss: 1.174675, loss_d: 0.399175
0.4218 --- loss: 1.067987, loss_ss: 0.812106, loss_d: 0.255881
0.4601 --- loss: 1.306674, loss_ss: 0.800839, loss_d: 0.505835
0.4985 --- loss: 1.328504, loss_ss: 0.866997, loss_d: 0.461506
0.5368 --- loss: 1.814737, loss_ss: 0.839240, loss_d: 0.975497
0.5752 --- loss: 1.614497, loss_ss: 1.034631, loss_d: 0.579866
0.6135 --- loss: 0.902057, loss_ss: 0.652374, loss_d: 0.249683
0.6518 --- loss: 1.659343, loss_ss: 1.367364, loss_d: 0.291979
0.6902 --- loss: 0.923179, loss_ss: 0.739241, loss_d: 0.183938
0.7285 --- loss: 1.252293, loss_ss: 0.773849, loss_d: 0.478444
0.7669 --- loss: 1.050579, loss_ss: 0.816899, loss_d: 0.233680
0.8052 --- loss: 1.203721, loss_ss: 0.958191, loss_d: 0.245530
0.8436 --- loss: 1.139327, loss_ss: 0.796805, loss_d: 0.342521
0.8819 --- loss: 1.403590, loss_ss: 1.129650, loss_d: 0.273940
0.9202 --- loss: 1.000181, loss_ss: 0.790381, loss_d: 0.209800
0.9586 --- loss: 1.544920, loss_ss: 1.242284, loss_d: 0.302637
0.9969 --- loss: 1.537526, loss_ss: 0.929881, loss_d: 0.607645
Epoch finished! Loss: 1.313229752962406
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.269694, loss_ss: 0.943844, loss_d: 0.325850
0.0383 --- loss: 1.158385, loss_ss: 0.888578, loss_d: 0.269807
0.0767 --- loss: 1.369658, loss_ss: 0.829514, loss_d: 0.540144
0.1150 --- loss: 1.095991, loss_ss: 0.916167, loss_d: 0.179824
0.1534 --- loss: 0.971233, loss_ss: 0.724190, loss_d: 0.247043
0.1917 --- loss: 1.590823, loss_ss: 1.210050, loss_d: 0.380773
0.2301 --- loss: 1.098097, loss_ss: 0.905437, loss_d: 0.192660
0.2684 --- loss: 1.513467, loss_ss: 1.088183, loss_d: 0.425284
0.3067 --- loss: 1.654437, loss_ss: 1.146807, loss_d: 0.507630
0.3451 --- loss: 1.559054, loss_ss: 0.972904, loss_d: 0.586150
0.3834 --- loss: 0.838139, loss_ss: 0.619198, loss_d: 0.218942
0.4218 --- loss: 1.423585, loss_ss: 1.104067, loss_d: 0.319518
0.4601 --- loss: 1.096940, loss_ss: 0.733396, loss_d: 0.363544
0.4985 --- loss: 0.969358, loss_ss: 0.853323, loss_d: 0.116036
0.5368 --- loss: 1.205671, loss_ss: 1.032251, loss_d: 0.173420
0.5752 --- loss: 1.420122, loss_ss: 1.234715, loss_d: 0.185406
0.6135 --- loss: 1.217965, loss_ss: 0.967503, loss_d: 0.250463
0.6518 --- loss: 1.454800, loss_ss: 0.807724, loss_d: 0.647076
0.6902 --- loss: 1.319968, loss_ss: 0.990660, loss_d: 0.329308
0.7285 --- loss: 1.072776, loss_ss: 0.797721, loss_d: 0.275055
0.7669 --- loss: 1.463206, loss_ss: 0.992382, loss_d: 0.470824
0.8052 --- loss: 1.318525, loss_ss: 0.921054, loss_d: 0.397471
0.8436 --- loss: 0.799357, loss_ss: 0.619022, loss_d: 0.180334
0.8819 --- loss: 1.140115, loss_ss: 0.876766, loss_d: 0.263349
0.9202 --- loss: 1.449720, loss_ss: 1.011073, loss_d: 0.438647
0.9586 --- loss: 1.027873, loss_ss: 0.655061, loss_d: 0.372812
0.9969 --- loss: 0.967788, loss_ss: 0.694207, loss_d: 0.273581
Epoch finished! Loss: 1.2678820222616196
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.134431, loss_ss: 0.772681, loss_d: 0.361750
0.0383 --- loss: 1.320453, loss_ss: 0.810339, loss_d: 0.510114
0.0767 --- loss: 0.866536, loss_ss: 0.618796, loss_d: 0.247740
0.1150 --- loss: 0.992151, loss_ss: 0.719574, loss_d: 0.272577
0.1534 --- loss: 1.235830, loss_ss: 0.917538, loss_d: 0.318292
0.1917 --- loss: 1.443617, loss_ss: 1.117259, loss_d: 0.326357
0.2301 --- loss: 1.536090, loss_ss: 0.990929, loss_d: 0.545161
0.2684 --- loss: 1.601715, loss_ss: 0.632551, loss_d: 0.969164
0.3067 --- loss: 1.048563, loss_ss: 0.888824, loss_d: 0.159739
0.3451 --- loss: 0.861473, loss_ss: 0.750417, loss_d: 0.111056
0.3834 --- loss: 1.631442, loss_ss: 1.244410, loss_d: 0.387033
0.4218 --- loss: 1.360609, loss_ss: 1.263375, loss_d: 0.097234
0.4601 --- loss: 1.452330, loss_ss: 0.761154, loss_d: 0.691176
0.4985 --- loss: 1.085680, loss_ss: 0.926414, loss_d: 0.159266
0.5368 --- loss: 1.452118, loss_ss: 0.712224, loss_d: 0.739894
0.5752 --- loss: 1.055180, loss_ss: 0.685959, loss_d: 0.369221
0.6135 --- loss: 1.111388, loss_ss: 0.839436, loss_d: 0.271952
0.6518 --- loss: 0.932814, loss_ss: 0.599164, loss_d: 0.333650
0.6902 --- loss: 0.806284, loss_ss: 0.666472, loss_d: 0.139812
0.7285 --- loss: 0.639835, loss_ss: 0.493406, loss_d: 0.146429
0.7669 --- loss: 1.511488, loss_ss: 1.162113, loss_d: 0.349375
0.8052 --- loss: 0.830036, loss_ss: 0.643818, loss_d: 0.186218
0.8436 --- loss: 0.820496, loss_ss: 0.639388, loss_d: 0.181108
0.8819 --- loss: 0.988788, loss_ss: 0.838836, loss_d: 0.149952
0.9202 --- loss: 1.541636, loss_ss: 1.205401, loss_d: 0.336235
0.9586 --- loss: 1.264333, loss_ss: 0.629276, loss_d: 0.635057
0.9969 --- loss: 1.469651, loss_ss: 0.846445, loss_d: 0.623206
Epoch finished! Loss: 1.2050369773919767
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.243273, loss_ss: 0.854794, loss_d: 0.388478
0.0383 --- loss: 0.971594, loss_ss: 0.782876, loss_d: 0.188718
0.0767 --- loss: 1.621560, loss_ss: 1.008630, loss_d: 0.612930
0.1150 --- loss: 1.083592, loss_ss: 0.910803, loss_d: 0.172789
0.1534 --- loss: 1.138253, loss_ss: 0.648751, loss_d: 0.489503
0.1917 --- loss: 1.141381, loss_ss: 0.880533, loss_d: 0.260848
0.2301 --- loss: 1.062127, loss_ss: 0.823665, loss_d: 0.238462
0.2684 --- loss: 1.010554, loss_ss: 0.786453, loss_d: 0.224102
0.3067 --- loss: 1.063823, loss_ss: 0.749432, loss_d: 0.314392
0.3451 --- loss: 1.210751, loss_ss: 0.990044, loss_d: 0.220707
0.3834 --- loss: 1.311491, loss_ss: 1.130422, loss_d: 0.181069
0.4218 --- loss: 1.185312, loss_ss: 0.850550, loss_d: 0.334762
0.4601 --- loss: 1.178532, loss_ss: 0.847387, loss_d: 0.331144
0.4985 --- loss: 1.088407, loss_ss: 0.766596, loss_d: 0.321811
0.5368 --- loss: 1.267201, loss_ss: 0.888987, loss_d: 0.378214
0.5752 --- loss: 1.149887, loss_ss: 0.901942, loss_d: 0.247945
0.6135 --- loss: 1.135813, loss_ss: 0.858216, loss_d: 0.277597
0.6518 --- loss: 0.931500, loss_ss: 0.746450, loss_d: 0.185050
0.6902 --- loss: 1.231398, loss_ss: 1.014400, loss_d: 0.216998
0.7285 --- loss: 0.899719, loss_ss: 0.644916, loss_d: 0.254802
0.7669 --- loss: 1.599437, loss_ss: 1.163044, loss_d: 0.436393
0.8052 --- loss: 1.407286, loss_ss: 1.232222, loss_d: 0.175064
0.8436 --- loss: 0.950980, loss_ss: 0.584959, loss_d: 0.366021
0.8819 --- loss: 1.260900, loss_ss: 1.161965, loss_d: 0.098935
0.9202 --- loss: 1.137154, loss_ss: 0.838324, loss_d: 0.298830
0.9586 --- loss: 0.984348, loss_ss: 0.604744, loss_d: 0.379604
0.9969 --- loss: 0.994589, loss_ss: 0.851821, loss_d: 0.142768
Epoch finished! Loss: 1.1846556037664413
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.800132, loss_ss: 0.699867, loss_d: 0.100265
0.0383 --- loss: 0.765765, loss_ss: 0.694810, loss_d: 0.070955
0.0767 --- loss: 1.167757, loss_ss: 0.930067, loss_d: 0.237690
0.1150 --- loss: 0.949190, loss_ss: 0.869997, loss_d: 0.079193
0.1534 --- loss: 1.301251, loss_ss: 1.157688, loss_d: 0.143563
0.1917 --- loss: 1.080182, loss_ss: 0.904966, loss_d: 0.175216
0.2301 --- loss: 1.254272, loss_ss: 0.872765, loss_d: 0.381507
0.2684 --- loss: 1.412684, loss_ss: 0.775204, loss_d: 0.637480
0.3067 --- loss: 0.930835, loss_ss: 0.821282, loss_d: 0.109554
0.3451 --- loss: 1.668075, loss_ss: 0.980781, loss_d: 0.687295
0.3834 --- loss: 1.134035, loss_ss: 1.014602, loss_d: 0.119433
0.4218 --- loss: 0.778627, loss_ss: 0.678048, loss_d: 0.100579
0.4601 --- loss: 0.990980, loss_ss: 0.744414, loss_d: 0.246566
0.4985 --- loss: 1.341028, loss_ss: 0.750333, loss_d: 0.590694
0.5368 --- loss: 0.892053, loss_ss: 0.671333, loss_d: 0.220720
0.5752 --- loss: 1.244008, loss_ss: 0.854950, loss_d: 0.389058
0.6135 --- loss: 1.018368, loss_ss: 0.915388, loss_d: 0.102980
0.6518 --- loss: 1.103379, loss_ss: 0.755102, loss_d: 0.348277
0.6902 --- loss: 1.091185, loss_ss: 0.729510, loss_d: 0.361675
0.7285 --- loss: 1.159615, loss_ss: 0.946599, loss_d: 0.213016
0.7669 --- loss: 1.460604, loss_ss: 1.063283, loss_d: 0.397321
0.8052 --- loss: 1.130203, loss_ss: 0.973597, loss_d: 0.156607
0.8436 --- loss: 1.494643, loss_ss: 1.032541, loss_d: 0.462102
0.8819 --- loss: 1.316901, loss_ss: 1.198589, loss_d: 0.118312
0.9202 --- loss: 1.469106, loss_ss: 0.875162, loss_d: 0.593944
0.9586 --- loss: 1.276020, loss_ss: 0.893303, loss_d: 0.382717
0.9969 --- loss: 0.940515, loss_ss: 0.557256, loss_d: 0.383259
Epoch finished! Loss: 1.133218844808065
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7488888888888889
             precision    recall  f1-score   support

        0.0       0.25      1.00      0.39        29
        1.0       0.46      0.11      0.17        57
        2.0       0.82      0.79      0.80       391
        3.0       0.98      0.75      0.85       250
        4.0       0.71      0.83      0.77       173

avg / total       0.80      0.75      0.76       900
 


====== chc035-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  90.11  100.00   89.78  24.58     39.46
1  93.56   10.53   99.17  46.15     17.14
2  83.00   78.52   86.44  81.65     80.05
3  92.78   75.20   99.54  98.43     85.26
4  90.33   83.24   92.02  71.29     76.80
Total accuracy: 74.89%
Average sen: 69.50%
Average spec: 93.39%
Macro f1-score: 59.74%
[0.538665   0.23100285 0.41367936 0.34962556 0.44112992 0.32099703
 0.30872223 0.24470757 0.23744352 0.3205696  0.2909551  0.48165762
 0.22025819 0.41875854 0.38969952 0.33633935 0.3225452  0.30447406
 0.20923768 0.290277   0.35476136 0.9648183  0.52364826 0.3756347
 0.31319481 0.17923434 0.23179497 0.27661058 0.35459808 0.3954685 ]
pred: 0.35468362718820573, label: 0
Right! Diagnosis: Other

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.279909, loss_ss: 1.597981, loss_d: 0.681928
0.0383 --- loss: 2.079465, loss_ss: 1.524699, loss_d: 0.554765
0.0767 --- loss: 2.071527, loss_ss: 1.510598, loss_d: 0.560929
0.1150 --- loss: 1.785683, loss_ss: 1.368139, loss_d: 0.417544
0.1533 --- loss: 2.103866, loss_ss: 1.493888, loss_d: 0.609978
0.1916 --- loss: 1.700008, loss_ss: 1.272856, loss_d: 0.427151
0.2300 --- loss: 1.753572, loss_ss: 1.417185, loss_d: 0.336388
0.2683 --- loss: 1.903160, loss_ss: 1.280266, loss_d: 0.622894
0.3066 --- loss: 1.904634, loss_ss: 1.395641, loss_d: 0.508993
0.3450 --- loss: 1.968130, loss_ss: 1.322978, loss_d: 0.645152
0.3833 --- loss: 2.146352, loss_ss: 1.276651, loss_d: 0.869702
0.4216 --- loss: 1.803567, loss_ss: 1.327706, loss_d: 0.475861
0.4599 --- loss: 1.842029, loss_ss: 1.241148, loss_d: 0.600881
0.4983 --- loss: 2.294358, loss_ss: 1.335723, loss_d: 0.958635
0.5366 --- loss: 1.722391, loss_ss: 1.175282, loss_d: 0.547110
0.5749 --- loss: 2.214218, loss_ss: 1.346277, loss_d: 0.867941
0.6133 --- loss: 1.933133, loss_ss: 1.186134, loss_d: 0.746999
0.6516 --- loss: 2.296111, loss_ss: 1.608426, loss_d: 0.687686
0.6899 --- loss: 1.727413, loss_ss: 1.258264, loss_d: 0.469149
0.7282 --- loss: 2.012673, loss_ss: 1.208296, loss_d: 0.804378
0.7666 --- loss: 1.491583, loss_ss: 1.214259, loss_d: 0.277324
0.8049 --- loss: 1.626102, loss_ss: 1.172419, loss_d: 0.453683
0.8432 --- loss: 1.899873, loss_ss: 1.330987, loss_d: 0.568886
0.8816 --- loss: 1.985745, loss_ss: 1.077398, loss_d: 0.908347
0.9199 --- loss: 1.507712, loss_ss: 1.189708, loss_d: 0.318004
0.9582 --- loss: 1.699787, loss_ss: 1.217498, loss_d: 0.482289
0.9966 --- loss: 1.711073, loss_ss: 1.373052, loss_d: 0.338021
Epoch finished! Loss: 1.9056898951530457
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.552522, loss_ss: 0.935181, loss_d: 0.617342
0.0383 --- loss: 1.865674, loss_ss: 1.122990, loss_d: 0.742685
0.0767 --- loss: 1.747827, loss_ss: 1.010713, loss_d: 0.737114
0.1150 --- loss: 1.608697, loss_ss: 1.286108, loss_d: 0.322588
0.1533 --- loss: 2.011873, loss_ss: 1.099888, loss_d: 0.911985
0.1916 --- loss: 1.753711, loss_ss: 1.047356, loss_d: 0.706355
0.2300 --- loss: 1.684959, loss_ss: 1.005468, loss_d: 0.679490
0.2683 --- loss: 1.596879, loss_ss: 1.010856, loss_d: 0.586023
0.3066 --- loss: 1.508145, loss_ss: 0.851779, loss_d: 0.656367
0.3450 --- loss: 1.614492, loss_ss: 0.982838, loss_d: 0.631655
0.3833 --- loss: 1.734770, loss_ss: 1.152635, loss_d: 0.582135
0.4216 --- loss: 1.654808, loss_ss: 1.103330, loss_d: 0.551478
0.4599 --- loss: 1.565272, loss_ss: 1.152685, loss_d: 0.412587
0.4983 --- loss: 1.481611, loss_ss: 1.090240, loss_d: 0.391371
0.5366 --- loss: 1.636530, loss_ss: 1.003862, loss_d: 0.632668
0.5749 --- loss: 1.471664, loss_ss: 0.944587, loss_d: 0.527077
0.6133 --- loss: 1.564892, loss_ss: 1.089123, loss_d: 0.475769
0.6516 --- loss: 1.678134, loss_ss: 1.009661, loss_d: 0.668473
0.6899 --- loss: 1.520626, loss_ss: 0.959912, loss_d: 0.560714
0.7282 --- loss: 1.493459, loss_ss: 0.961659, loss_d: 0.531800
0.7666 --- loss: 1.962324, loss_ss: 1.259300, loss_d: 0.703024
0.8049 --- loss: 1.616678, loss_ss: 1.156390, loss_d: 0.460288
0.8432 --- loss: 1.675142, loss_ss: 0.952976, loss_d: 0.722165
0.8816 --- loss: 1.530128, loss_ss: 0.964785, loss_d: 0.565343
0.9199 --- loss: 1.328438, loss_ss: 0.774902, loss_d: 0.553536
0.9582 --- loss: 1.440229, loss_ss: 1.008500, loss_d: 0.431729
0.9966 --- loss: 1.423760, loss_ss: 1.037622, loss_d: 0.386138
Epoch finished! Loss: 1.6659315320161672
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.440163, loss_ss: 1.028838, loss_d: 0.411325
0.0383 --- loss: 2.002900, loss_ss: 1.459942, loss_d: 0.542958
0.0767 --- loss: 1.331077, loss_ss: 1.025202, loss_d: 0.305875
0.1150 --- loss: 1.293118, loss_ss: 0.864295, loss_d: 0.428823
0.1533 --- loss: 1.212324, loss_ss: 0.913824, loss_d: 0.298500
0.1916 --- loss: 1.851965, loss_ss: 1.029008, loss_d: 0.822958
0.2300 --- loss: 1.702170, loss_ss: 1.192266, loss_d: 0.509903
0.2683 --- loss: 1.504571, loss_ss: 0.972843, loss_d: 0.531727
0.3066 --- loss: 1.727302, loss_ss: 1.299536, loss_d: 0.427766
0.3450 --- loss: 1.325115, loss_ss: 0.964655, loss_d: 0.360460
0.3833 --- loss: 1.869308, loss_ss: 0.994613, loss_d: 0.874695
0.4216 --- loss: 1.532975, loss_ss: 0.935269, loss_d: 0.597706
0.4599 --- loss: 1.405936, loss_ss: 1.036887, loss_d: 0.369049
0.4983 --- loss: 1.328150, loss_ss: 0.840843, loss_d: 0.487307
0.5366 --- loss: 1.528882, loss_ss: 1.021609, loss_d: 0.507273
0.5749 --- loss: 1.870360, loss_ss: 1.185158, loss_d: 0.685202
0.6133 --- loss: 1.819465, loss_ss: 0.953706, loss_d: 0.865759
0.6516 --- loss: 1.532431, loss_ss: 0.959522, loss_d: 0.572909
0.6899 --- loss: 1.879310, loss_ss: 1.365888, loss_d: 0.513422
0.7282 --- loss: 1.641145, loss_ss: 1.010856, loss_d: 0.630289
0.7666 --- loss: 1.327352, loss_ss: 0.816728, loss_d: 0.510624
0.8049 --- loss: 1.535857, loss_ss: 1.110234, loss_d: 0.425622
0.8432 --- loss: 1.606320, loss_ss: 1.210195, loss_d: 0.396126
0.8816 --- loss: 1.517155, loss_ss: 1.122706, loss_d: 0.394449
0.9199 --- loss: 1.601669, loss_ss: 0.873844, loss_d: 0.727825
0.9582 --- loss: 1.518527, loss_ss: 1.097577, loss_d: 0.420950
0.9966 --- loss: 2.141174, loss_ss: 1.463400, loss_d: 0.677774
Epoch finished! Loss: 1.5519061349905454
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.133855, loss_ss: 1.375819, loss_d: 0.758036
0.0383 --- loss: 1.600363, loss_ss: 1.033098, loss_d: 0.567265
0.0767 --- loss: 2.117265, loss_ss: 1.185595, loss_d: 0.931670
0.1150 --- loss: 1.367763, loss_ss: 0.833933, loss_d: 0.533829
0.1533 --- loss: 1.536594, loss_ss: 1.176608, loss_d: 0.359986
0.1916 --- loss: 1.818936, loss_ss: 1.158764, loss_d: 0.660172
0.2300 --- loss: 1.276342, loss_ss: 0.762748, loss_d: 0.513594
0.2683 --- loss: 1.256340, loss_ss: 0.884442, loss_d: 0.371898
0.3066 --- loss: 1.345253, loss_ss: 0.850254, loss_d: 0.494999
0.3450 --- loss: 1.445706, loss_ss: 0.898027, loss_d: 0.547679
0.3833 --- loss: 1.325637, loss_ss: 0.894696, loss_d: 0.430941
0.4216 --- loss: 1.636220, loss_ss: 0.965320, loss_d: 0.670899
0.4599 --- loss: 1.332065, loss_ss: 1.029709, loss_d: 0.302356
0.4983 --- loss: 1.337250, loss_ss: 1.054237, loss_d: 0.283013
0.5366 --- loss: 1.445665, loss_ss: 1.163505, loss_d: 0.282160
0.5749 --- loss: 1.374663, loss_ss: 1.021139, loss_d: 0.353524
0.6133 --- loss: 1.650663, loss_ss: 0.824184, loss_d: 0.826479
0.6516 --- loss: 1.268496, loss_ss: 1.012410, loss_d: 0.256086
0.6899 --- loss: 1.223990, loss_ss: 0.818480, loss_d: 0.405510
0.7282 --- loss: 1.525165, loss_ss: 1.076414, loss_d: 0.448751
0.7666 --- loss: 1.532662, loss_ss: 0.749165, loss_d: 0.783497
0.8049 --- loss: 1.487432, loss_ss: 1.003467, loss_d: 0.483966
0.8432 --- loss: 1.594265, loss_ss: 1.054775, loss_d: 0.539489
0.8816 --- loss: 1.267877, loss_ss: 0.951613, loss_d: 0.316264
0.9199 --- loss: 1.602396, loss_ss: 1.123902, loss_d: 0.478494
0.9582 --- loss: 1.781202, loss_ss: 1.087851, loss_d: 0.693351
0.9966 --- loss: 1.209615, loss_ss: 0.910690, loss_d: 0.298924
Epoch finished! Loss: 1.4692560617740338
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.179621, loss_ss: 0.781422, loss_d: 0.398199
0.0383 --- loss: 1.370175, loss_ss: 0.786016, loss_d: 0.584158
0.0767 --- loss: 1.433409, loss_ss: 0.794496, loss_d: 0.638913
0.1150 --- loss: 1.321916, loss_ss: 0.932990, loss_d: 0.388925
0.1533 --- loss: 1.566829, loss_ss: 0.869753, loss_d: 0.697075
0.1916 --- loss: 1.393281, loss_ss: 1.073241, loss_d: 0.320040
0.2300 --- loss: 1.613121, loss_ss: 0.945440, loss_d: 0.667681
0.2683 --- loss: 1.483775, loss_ss: 0.782000, loss_d: 0.701775
0.3066 --- loss: 1.349170, loss_ss: 0.976508, loss_d: 0.372663
0.3450 --- loss: 1.200951, loss_ss: 0.948814, loss_d: 0.252137
0.3833 --- loss: 1.508341, loss_ss: 1.043134, loss_d: 0.465207
0.4216 --- loss: 1.466155, loss_ss: 0.902275, loss_d: 0.563880
0.4599 --- loss: 1.416481, loss_ss: 0.807836, loss_d: 0.608645
0.4983 --- loss: 1.224340, loss_ss: 0.902699, loss_d: 0.321642
0.5366 --- loss: 1.242703, loss_ss: 0.779869, loss_d: 0.462834
0.5749 --- loss: 1.604989, loss_ss: 1.095251, loss_d: 0.509738
0.6133 --- loss: 0.913394, loss_ss: 0.704581, loss_d: 0.208813
0.6516 --- loss: 1.183967, loss_ss: 0.785988, loss_d: 0.397979
0.6899 --- loss: 1.211357, loss_ss: 0.825670, loss_d: 0.385687
0.7282 --- loss: 1.198494, loss_ss: 0.813395, loss_d: 0.385099
0.7666 --- loss: 1.456823, loss_ss: 0.900652, loss_d: 0.556172
0.8049 --- loss: 1.816804, loss_ss: 0.988590, loss_d: 0.828213
0.8432 --- loss: 1.086138, loss_ss: 0.761504, loss_d: 0.324633
0.8816 --- loss: 1.181188, loss_ss: 0.816170, loss_d: 0.365018
0.9199 --- loss: 0.936915, loss_ss: 0.650701, loss_d: 0.286214
0.9582 --- loss: 0.908416, loss_ss: 0.612462, loss_d: 0.295953
0.9966 --- loss: 1.329594, loss_ss: 0.900564, loss_d: 0.429030
Epoch finished! Loss: 1.3415157941671518
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.017580, loss_ss: 0.725350, loss_d: 0.292230
0.0383 --- loss: 1.535348, loss_ss: 1.042940, loss_d: 0.492407
0.0767 --- loss: 1.128355, loss_ss: 0.866295, loss_d: 0.262061
0.1150 --- loss: 1.516331, loss_ss: 1.090555, loss_d: 0.425777
0.1533 --- loss: 1.252865, loss_ss: 1.053483, loss_d: 0.199382
0.1916 --- loss: 0.906590, loss_ss: 0.786630, loss_d: 0.119960
0.2300 --- loss: 1.369509, loss_ss: 1.000769, loss_d: 0.368741
0.2683 --- loss: 1.263324, loss_ss: 1.138540, loss_d: 0.124784
0.3066 --- loss: 1.906521, loss_ss: 1.085869, loss_d: 0.820653
0.3450 --- loss: 1.325936, loss_ss: 0.891492, loss_d: 0.434445
0.3833 --- loss: 1.077024, loss_ss: 0.858891, loss_d: 0.218133
0.4216 --- loss: 0.994631, loss_ss: 0.649183, loss_d: 0.345448
0.4599 --- loss: 1.033808, loss_ss: 0.625123, loss_d: 0.408686
0.4983 --- loss: 1.268767, loss_ss: 0.948797, loss_d: 0.319970
0.5366 --- loss: 1.343659, loss_ss: 0.862390, loss_d: 0.481269
0.5749 --- loss: 1.360535, loss_ss: 0.884396, loss_d: 0.476140
0.6133 --- loss: 1.366228, loss_ss: 1.206210, loss_d: 0.160018
0.6516 --- loss: 1.121595, loss_ss: 0.930109, loss_d: 0.191486
0.6899 --- loss: 1.398221, loss_ss: 1.249008, loss_d: 0.149213
0.7282 --- loss: 0.929534, loss_ss: 0.760866, loss_d: 0.168668
0.7666 --- loss: 1.604707, loss_ss: 0.876228, loss_d: 0.728479
0.8049 --- loss: 1.408913, loss_ss: 1.008055, loss_d: 0.400858
0.8432 --- loss: 1.190367, loss_ss: 0.947378, loss_d: 0.242990
0.8816 --- loss: 1.418393, loss_ss: 1.112387, loss_d: 0.306006
0.9199 --- loss: 0.843470, loss_ss: 0.629198, loss_d: 0.214272
0.9582 --- loss: 1.268870, loss_ss: 0.950903, loss_d: 0.317966
0.9966 --- loss: 1.166006, loss_ss: 0.981504, loss_d: 0.184502
Epoch finished! Loss: 1.2973615900828288
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.274493, loss_ss: 0.881296, loss_d: 0.393196
0.0383 --- loss: 1.024674, loss_ss: 0.776091, loss_d: 0.248583
0.0767 --- loss: 1.543833, loss_ss: 1.054619, loss_d: 0.489215
0.1150 --- loss: 1.190751, loss_ss: 0.803409, loss_d: 0.387343
0.1533 --- loss: 0.908686, loss_ss: 0.703154, loss_d: 0.205532
0.1916 --- loss: 1.068577, loss_ss: 0.751444, loss_d: 0.317133
0.2300 --- loss: 1.270458, loss_ss: 0.827556, loss_d: 0.442903
0.2683 --- loss: 1.227364, loss_ss: 0.942160, loss_d: 0.285204
0.3066 --- loss: 1.048367, loss_ss: 0.709424, loss_d: 0.338944
0.3450 --- loss: 0.974309, loss_ss: 0.745938, loss_d: 0.228370
0.3833 --- loss: 0.994127, loss_ss: 0.695427, loss_d: 0.298700
0.4216 --- loss: 1.655999, loss_ss: 1.225598, loss_d: 0.430401
0.4599 --- loss: 1.649206, loss_ss: 1.215808, loss_d: 0.433398
0.4983 --- loss: 1.268697, loss_ss: 1.016497, loss_d: 0.252199
0.5366 --- loss: 0.954176, loss_ss: 0.679268, loss_d: 0.274907
0.5749 --- loss: 1.226987, loss_ss: 0.664603, loss_d: 0.562383
0.6133 --- loss: 1.342806, loss_ss: 0.995805, loss_d: 0.347001
0.6516 --- loss: 1.081600, loss_ss: 0.831536, loss_d: 0.250064
0.6899 --- loss: 1.539066, loss_ss: 0.633184, loss_d: 0.905882
0.7282 --- loss: 1.027414, loss_ss: 0.889010, loss_d: 0.138405
0.7666 --- loss: 1.042253, loss_ss: 0.725748, loss_d: 0.316505
0.8049 --- loss: 1.376667, loss_ss: 0.996803, loss_d: 0.379864
0.8432 --- loss: 1.450777, loss_ss: 0.911803, loss_d: 0.538975
0.8816 --- loss: 0.885729, loss_ss: 0.780804, loss_d: 0.104925
0.9199 --- loss: 0.848818, loss_ss: 0.656188, loss_d: 0.192630
0.9582 --- loss: 1.074732, loss_ss: 0.966372, loss_d: 0.108360
0.9966 --- loss: 1.743084, loss_ss: 1.152791, loss_d: 0.590293
Epoch finished! Loss: 1.2357124087902216
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.149577, loss_ss: 0.877072, loss_d: 0.272505
0.0383 --- loss: 0.975768, loss_ss: 0.783161, loss_d: 0.192607
0.0767 --- loss: 2.163174, loss_ss: 1.500095, loss_d: 0.663079
0.1150 --- loss: 1.174220, loss_ss: 0.960375, loss_d: 0.213845
0.1533 --- loss: 1.187276, loss_ss: 1.075564, loss_d: 0.111712
0.1916 --- loss: 1.226941, loss_ss: 0.908548, loss_d: 0.318392
0.2300 --- loss: 0.951138, loss_ss: 0.616644, loss_d: 0.334493
0.2683 --- loss: 1.262850, loss_ss: 1.029394, loss_d: 0.233456
0.3066 --- loss: 1.494990, loss_ss: 1.261762, loss_d: 0.233228
0.3450 --- loss: 1.390388, loss_ss: 0.880898, loss_d: 0.509490
0.3833 --- loss: 1.274147, loss_ss: 1.107777, loss_d: 0.166370
0.4216 --- loss: 1.020230, loss_ss: 0.757372, loss_d: 0.262857
0.4599 --- loss: 0.993052, loss_ss: 0.792691, loss_d: 0.200361
0.4983 --- loss: 1.393400, loss_ss: 0.982602, loss_d: 0.410798
0.5366 --- loss: 1.093168, loss_ss: 0.843787, loss_d: 0.249381
0.5749 --- loss: 1.661541, loss_ss: 1.030625, loss_d: 0.630916
0.6133 --- loss: 1.095041, loss_ss: 0.856022, loss_d: 0.239019
0.6516 --- loss: 1.540244, loss_ss: 1.270014, loss_d: 0.270230
0.6899 --- loss: 1.070832, loss_ss: 0.844252, loss_d: 0.226580
0.7282 --- loss: 0.867369, loss_ss: 0.743929, loss_d: 0.123440
0.7666 --- loss: 1.052386, loss_ss: 0.736043, loss_d: 0.316342
0.8049 --- loss: 0.955650, loss_ss: 0.785619, loss_d: 0.170031
0.8432 --- loss: 1.963760, loss_ss: 1.360310, loss_d: 0.603450
0.8816 --- loss: 1.042009, loss_ss: 0.684654, loss_d: 0.357355
0.9199 --- loss: 1.864986, loss_ss: 0.915006, loss_d: 0.949980
0.9582 --- loss: 1.064157, loss_ss: 0.657762, loss_d: 0.406396
0.9966 --- loss: 0.679695, loss_ss: 0.553250, loss_d: 0.126445
Epoch finished! Loss: 1.1940302825891054
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.021735, loss_ss: 0.948796, loss_d: 0.072940
0.0383 --- loss: 1.040085, loss_ss: 0.853246, loss_d: 0.186839
0.0767 --- loss: 1.001514, loss_ss: 0.868931, loss_d: 0.132583
0.1150 --- loss: 1.667617, loss_ss: 1.451532, loss_d: 0.216085
0.1533 --- loss: 1.304333, loss_ss: 0.702269, loss_d: 0.602064
0.1916 --- loss: 0.892998, loss_ss: 0.753646, loss_d: 0.139353
0.2300 --- loss: 1.280175, loss_ss: 0.591267, loss_d: 0.688908
0.2683 --- loss: 1.137706, loss_ss: 0.981202, loss_d: 0.156504
0.3066 --- loss: 1.159031, loss_ss: 0.759274, loss_d: 0.399757
0.3450 --- loss: 1.052368, loss_ss: 0.802183, loss_d: 0.250185
0.3833 --- loss: 1.525877, loss_ss: 1.000937, loss_d: 0.524940
0.4216 --- loss: 1.542142, loss_ss: 1.209885, loss_d: 0.332256
0.4599 --- loss: 0.951708, loss_ss: 0.760570, loss_d: 0.191137
0.4983 --- loss: 1.327155, loss_ss: 0.774833, loss_d: 0.552322
0.5366 --- loss: 0.960888, loss_ss: 0.646716, loss_d: 0.314172
0.5749 --- loss: 1.189806, loss_ss: 0.448258, loss_d: 0.741548
0.6133 --- loss: 0.999356, loss_ss: 0.858156, loss_d: 0.141200
0.6516 --- loss: 0.692238, loss_ss: 0.601681, loss_d: 0.090557
0.6899 --- loss: 1.158382, loss_ss: 0.783682, loss_d: 0.374700
0.7282 --- loss: 1.176338, loss_ss: 1.010179, loss_d: 0.166159
0.7666 --- loss: 1.031822, loss_ss: 0.813174, loss_d: 0.218648
0.8049 --- loss: 0.920979, loss_ss: 0.775325, loss_d: 0.145655
0.8432 --- loss: 0.777108, loss_ss: 0.620092, loss_d: 0.157016
0.8816 --- loss: 0.802352, loss_ss: 0.697176, loss_d: 0.105176
0.9199 --- loss: 0.797046, loss_ss: 0.672210, loss_d: 0.124836
0.9582 --- loss: 0.952734, loss_ss: 0.670932, loss_d: 0.281802
0.9966 --- loss: 0.919045, loss_ss: 0.864230, loss_d: 0.054815
Epoch finished! Loss: 1.151544571839846
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.206529, loss_ss: 0.781013, loss_d: 0.425515
0.0383 --- loss: 1.149564, loss_ss: 0.904263, loss_d: 0.245300
0.0767 --- loss: 0.722361, loss_ss: 0.651894, loss_d: 0.070467
0.1150 --- loss: 0.873136, loss_ss: 0.762739, loss_d: 0.110397
0.1533 --- loss: 1.697315, loss_ss: 1.250916, loss_d: 0.446399
0.1916 --- loss: 1.284859, loss_ss: 1.041369, loss_d: 0.243490
0.2300 --- loss: 1.044422, loss_ss: 0.787496, loss_d: 0.256926
0.2683 --- loss: 1.021882, loss_ss: 0.839679, loss_d: 0.182203
0.3066 --- loss: 0.900379, loss_ss: 0.640327, loss_d: 0.260052
0.3450 --- loss: 1.345597, loss_ss: 1.189012, loss_d: 0.156586
0.3833 --- loss: 0.918492, loss_ss: 0.700538, loss_d: 0.217954
0.4216 --- loss: 1.120310, loss_ss: 1.029014, loss_d: 0.091296
0.4599 --- loss: 0.918120, loss_ss: 0.718729, loss_d: 0.199391
0.4983 --- loss: 0.985526, loss_ss: 0.788275, loss_d: 0.197251
0.5366 --- loss: 0.766796, loss_ss: 0.617370, loss_d: 0.149425
0.5749 --- loss: 0.745455, loss_ss: 0.606634, loss_d: 0.138821
0.6133 --- loss: 1.228842, loss_ss: 0.923134, loss_d: 0.305708
0.6516 --- loss: 1.325843, loss_ss: 0.984526, loss_d: 0.341316
0.6899 --- loss: 0.962754, loss_ss: 0.861347, loss_d: 0.101407
0.7282 --- loss: 1.358183, loss_ss: 1.096580, loss_d: 0.261603
0.7666 --- loss: 1.192339, loss_ss: 0.848027, loss_d: 0.344312
0.8049 --- loss: 0.947778, loss_ss: 0.768476, loss_d: 0.179302
0.8432 --- loss: 1.114405, loss_ss: 0.998606, loss_d: 0.115798
0.8816 --- loss: 0.965035, loss_ss: 0.643226, loss_d: 0.321809
0.9199 --- loss: 0.915231, loss_ss: 0.731570, loss_d: 0.183661
0.9582 --- loss: 0.757174, loss_ss: 0.684130, loss_d: 0.073044
0.9966 --- loss: 0.821249, loss_ss: 0.774808, loss_d: 0.046440
Epoch finished! Loss: 1.1153441135699933
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8413793103448276
             precision    recall  f1-score   support

        0.0       0.93      0.68      0.79       154
        1.0       0.00      0.00      0.00        34
        2.0       0.78      0.92      0.84       307
        3.0       0.98      0.93      0.95       168
        4.0       0.81      0.91      0.86       207

avg / total       0.82      0.84      0.82       870
 


====== chc037-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  93.45  68.18   98.88  92.92     78.65
1  95.86   0.00   99.76   0.00      0.00
2  87.82  91.86   85.61  77.69     84.18
3  98.28  92.86   99.57  98.11     95.41
4  92.87  91.30   93.36  81.12     85.91
Total accuracy: 84.14%
Average sen: 68.84%
Average spec: 95.44%
Macro f1-score: 68.83%
[0.01737837 0.10399639 0.03584168 0.06472971 0.02789593 0.16725031
 0.1421968  0.03367292 0.07334658 0.05396974 0.17862995 0.08214357
 0.00818145 0.03492403 0.03787736 0.04317332 0.05248106 0.03648854
 0.09644318 0.13281983 0.1323798  0.02937558 0.0430304  0.04765385
 0.13999386 0.20873386 0.19904178 0.2098375  0.03032347]
pred: 0.0849589934765265, label: 0
Right! Diagnosis: Other

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.388508, loss_ss: 1.749550, loss_d: 0.638958
0.0384 --- loss: 2.315480, loss_ss: 1.729491, loss_d: 0.585990
0.0769 --- loss: 2.103325, loss_ss: 1.459301, loss_d: 0.644025
0.1153 --- loss: 2.100216, loss_ss: 1.552357, loss_d: 0.547859
0.1537 --- loss: 2.284478, loss_ss: 1.363292, loss_d: 0.921185
0.1922 --- loss: 2.079488, loss_ss: 1.578877, loss_d: 0.500610
0.2306 --- loss: 1.964001, loss_ss: 1.326250, loss_d: 0.637751
0.2690 --- loss: 2.231277, loss_ss: 1.684442, loss_d: 0.546835
0.3075 --- loss: 1.941877, loss_ss: 1.431489, loss_d: 0.510388
0.3459 --- loss: 2.169577, loss_ss: 1.484675, loss_d: 0.684902
0.3843 --- loss: 1.986301, loss_ss: 1.134142, loss_d: 0.852160
0.4228 --- loss: 1.875721, loss_ss: 1.271358, loss_d: 0.604364
0.4612 --- loss: 1.766377, loss_ss: 1.385112, loss_d: 0.381265
0.4996 --- loss: 1.992496, loss_ss: 1.355172, loss_d: 0.637325
0.5380 --- loss: 1.942971, loss_ss: 1.343638, loss_d: 0.599332
0.5765 --- loss: 1.991204, loss_ss: 1.434832, loss_d: 0.556372
0.6149 --- loss: 1.970955, loss_ss: 1.312495, loss_d: 0.658461
0.6533 --- loss: 1.732493, loss_ss: 1.234073, loss_d: 0.498420
0.6918 --- loss: 1.685947, loss_ss: 1.266397, loss_d: 0.419550
0.7302 --- loss: 1.650019, loss_ss: 1.275851, loss_d: 0.374167
0.7686 --- loss: 1.845392, loss_ss: 1.507959, loss_d: 0.337433
0.8071 --- loss: 1.828890, loss_ss: 1.287024, loss_d: 0.541866
0.8455 --- loss: 1.800558, loss_ss: 1.287903, loss_d: 0.512655
0.8839 --- loss: 1.733623, loss_ss: 1.313630, loss_d: 0.419993
0.9224 --- loss: 1.548738, loss_ss: 1.176500, loss_d: 0.372238
0.9608 --- loss: 1.936210, loss_ss: 1.201205, loss_d: 0.735005
0.9992 --- loss: 2.556713, loss_ss: 2.255131, loss_d: 0.301582
Epoch finished! Loss: 1.979329711657304
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.025033, loss_ss: 1.208405, loss_d: 0.816628
0.0384 --- loss: 1.691067, loss_ss: 1.226222, loss_d: 0.464845
0.0769 --- loss: 2.174080, loss_ss: 1.223232, loss_d: 0.950848
0.1153 --- loss: 1.676096, loss_ss: 1.083442, loss_d: 0.592654
0.1537 --- loss: 1.899491, loss_ss: 1.127243, loss_d: 0.772247
0.1922 --- loss: 1.697453, loss_ss: 1.210945, loss_d: 0.486508
0.2306 --- loss: 1.621188, loss_ss: 1.161772, loss_d: 0.459416
0.2690 --- loss: 1.401135, loss_ss: 1.123034, loss_d: 0.278101
0.3075 --- loss: 1.748915, loss_ss: 1.254929, loss_d: 0.493986
0.3459 --- loss: 1.907198, loss_ss: 1.314051, loss_d: 0.593147
0.3843 --- loss: 1.967371, loss_ss: 1.184949, loss_d: 0.782422
0.4228 --- loss: 1.584506, loss_ss: 1.115890, loss_d: 0.468616
0.4612 --- loss: 1.354029, loss_ss: 1.043174, loss_d: 0.310855
0.4996 --- loss: 1.471216, loss_ss: 1.155663, loss_d: 0.315553
0.5380 --- loss: 1.915353, loss_ss: 1.091914, loss_d: 0.823439
0.5765 --- loss: 1.510917, loss_ss: 1.057023, loss_d: 0.453894
0.6149 --- loss: 1.769409, loss_ss: 0.875894, loss_d: 0.893514
0.6533 --- loss: 1.983739, loss_ss: 1.117265, loss_d: 0.866475
0.6918 --- loss: 1.465016, loss_ss: 1.079292, loss_d: 0.385723
0.7302 --- loss: 1.757143, loss_ss: 0.912067, loss_d: 0.845076
0.7686 --- loss: 1.467619, loss_ss: 0.916297, loss_d: 0.551322
0.8071 --- loss: 1.800151, loss_ss: 1.095288, loss_d: 0.704863
0.8455 --- loss: 1.579220, loss_ss: 0.921001, loss_d: 0.658219
0.8839 --- loss: 1.588889, loss_ss: 0.904684, loss_d: 0.684205
0.9224 --- loss: 1.500958, loss_ss: 1.046826, loss_d: 0.454132
0.9608 --- loss: 1.750686, loss_ss: 0.883585, loss_d: 0.867101
0.9992 --- loss: 2.296160, loss_ss: 1.495567, loss_d: 0.800594
Epoch finished! Loss: 1.6950961837401757
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.629141, loss_ss: 1.006668, loss_d: 0.622473
0.0384 --- loss: 1.594302, loss_ss: 0.985507, loss_d: 0.608796
0.0769 --- loss: 1.472563, loss_ss: 0.866278, loss_d: 0.606285
0.1153 --- loss: 1.544982, loss_ss: 1.173690, loss_d: 0.371292
0.1537 --- loss: 1.710048, loss_ss: 1.219633, loss_d: 0.490415
0.1922 --- loss: 1.573101, loss_ss: 0.978074, loss_d: 0.595027
0.2306 --- loss: 1.476983, loss_ss: 0.892318, loss_d: 0.584665
0.2690 --- loss: 1.700010, loss_ss: 1.062146, loss_d: 0.637865
0.3075 --- loss: 1.639163, loss_ss: 0.854207, loss_d: 0.784956
0.3459 --- loss: 1.362566, loss_ss: 0.851530, loss_d: 0.511036
0.3843 --- loss: 1.564859, loss_ss: 0.928567, loss_d: 0.636293
0.4228 --- loss: 1.804762, loss_ss: 1.278373, loss_d: 0.526389
0.4612 --- loss: 1.557551, loss_ss: 1.034691, loss_d: 0.522860
0.4996 --- loss: 1.700491, loss_ss: 0.929594, loss_d: 0.770897
0.5380 --- loss: 1.535159, loss_ss: 1.103294, loss_d: 0.431864
0.5765 --- loss: 1.342955, loss_ss: 1.012627, loss_d: 0.330328
0.6149 --- loss: 1.406460, loss_ss: 0.818337, loss_d: 0.588123
0.6533 --- loss: 1.865050, loss_ss: 1.470710, loss_d: 0.394341
0.6918 --- loss: 1.509353, loss_ss: 1.057986, loss_d: 0.451367
0.7302 --- loss: 1.476630, loss_ss: 1.036083, loss_d: 0.440547
0.7686 --- loss: 2.116091, loss_ss: 1.398805, loss_d: 0.717286
0.8071 --- loss: 1.677720, loss_ss: 0.991861, loss_d: 0.685859
0.8455 --- loss: 1.230990, loss_ss: 0.915128, loss_d: 0.315861
0.8839 --- loss: 1.506999, loss_ss: 0.943252, loss_d: 0.563747
0.9224 --- loss: 1.665364, loss_ss: 1.137498, loss_d: 0.527865
0.9608 --- loss: 1.314689, loss_ss: 0.902481, loss_d: 0.412208
0.9992 --- loss: 1.927258, loss_ss: 1.426138, loss_d: 0.501120
Epoch finished! Loss: 1.5835247988884265
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.443462, loss_ss: 0.790803, loss_d: 0.652659
0.0384 --- loss: 1.521925, loss_ss: 1.020724, loss_d: 0.501200
0.0769 --- loss: 1.535368, loss_ss: 0.867208, loss_d: 0.668160
0.1153 --- loss: 1.478721, loss_ss: 0.767182, loss_d: 0.711539
0.1537 --- loss: 1.601870, loss_ss: 1.072002, loss_d: 0.529867
0.1922 --- loss: 1.442900, loss_ss: 0.941797, loss_d: 0.501103
0.2306 --- loss: 1.446975, loss_ss: 1.009951, loss_d: 0.437024
0.2690 --- loss: 1.632170, loss_ss: 0.893018, loss_d: 0.739152
0.3075 --- loss: 1.727273, loss_ss: 1.232353, loss_d: 0.494920
0.3459 --- loss: 1.596578, loss_ss: 1.030437, loss_d: 0.566140
0.3843 --- loss: 1.668519, loss_ss: 0.979641, loss_d: 0.688878
0.4228 --- loss: 1.659208, loss_ss: 1.116554, loss_d: 0.542654
0.4612 --- loss: 1.665056, loss_ss: 1.268724, loss_d: 0.396332
0.4996 --- loss: 1.460769, loss_ss: 1.062456, loss_d: 0.398313
0.5380 --- loss: 1.653372, loss_ss: 1.069811, loss_d: 0.583561
0.5765 --- loss: 1.812420, loss_ss: 1.349825, loss_d: 0.462595
0.6149 --- loss: 1.385484, loss_ss: 1.012679, loss_d: 0.372806
0.6533 --- loss: 1.336397, loss_ss: 0.980124, loss_d: 0.356273
0.6918 --- loss: 1.404734, loss_ss: 0.902929, loss_d: 0.501804
0.7302 --- loss: 1.454551, loss_ss: 1.014371, loss_d: 0.440179
0.7686 --- loss: 1.204318, loss_ss: 0.892366, loss_d: 0.311952
0.8071 --- loss: 1.597876, loss_ss: 1.080141, loss_d: 0.517735
0.8455 --- loss: 1.385702, loss_ss: 0.896814, loss_d: 0.488888
0.8839 --- loss: 1.230369, loss_ss: 0.769990, loss_d: 0.460380
0.9224 --- loss: 1.131451, loss_ss: 0.814058, loss_d: 0.317393
0.9608 --- loss: 1.317699, loss_ss: 0.800325, loss_d: 0.517374
0.9992 --- loss: 1.640955, loss_ss: 1.162386, loss_d: 0.478568
Epoch finished! Loss: 1.4869191064284397
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.724586, loss_ss: 0.954085, loss_d: 0.770501
0.0384 --- loss: 1.591566, loss_ss: 1.106070, loss_d: 0.485496
0.0769 --- loss: 1.505447, loss_ss: 1.039963, loss_d: 0.465485
0.1153 --- loss: 1.599376, loss_ss: 0.998099, loss_d: 0.601277
0.1537 --- loss: 1.099533, loss_ss: 0.832794, loss_d: 0.266739
0.1922 --- loss: 1.914491, loss_ss: 1.158262, loss_d: 0.756229
0.2306 --- loss: 1.293323, loss_ss: 0.823681, loss_d: 0.469642
0.2690 --- loss: 1.479888, loss_ss: 0.911764, loss_d: 0.568124
0.3075 --- loss: 1.479601, loss_ss: 0.837173, loss_d: 0.642428
0.3459 --- loss: 1.239170, loss_ss: 0.801093, loss_d: 0.438076
0.3843 --- loss: 1.739769, loss_ss: 1.178423, loss_d: 0.561345
0.4228 --- loss: 1.610748, loss_ss: 1.340982, loss_d: 0.269766
0.4612 --- loss: 1.122742, loss_ss: 0.828250, loss_d: 0.294492
0.4996 --- loss: 1.356912, loss_ss: 0.987066, loss_d: 0.369846
0.5380 --- loss: 1.858195, loss_ss: 0.809783, loss_d: 1.048412
0.5765 --- loss: 1.148605, loss_ss: 0.779235, loss_d: 0.369370
0.6149 --- loss: 1.330757, loss_ss: 0.989480, loss_d: 0.341276
0.6533 --- loss: 1.078928, loss_ss: 0.841489, loss_d: 0.237438
0.6918 --- loss: 1.316165, loss_ss: 0.968470, loss_d: 0.347695
0.7302 --- loss: 1.134369, loss_ss: 0.786718, loss_d: 0.347651
0.7686 --- loss: 1.323994, loss_ss: 0.738553, loss_d: 0.585441
0.8071 --- loss: 1.002417, loss_ss: 0.838747, loss_d: 0.163670
0.8455 --- loss: 1.104324, loss_ss: 0.779392, loss_d: 0.324931
0.8839 --- loss: 1.406893, loss_ss: 0.690260, loss_d: 0.716633
0.9224 --- loss: 1.685794, loss_ss: 0.784873, loss_d: 0.900922
0.9608 --- loss: 1.035123, loss_ss: 0.690889, loss_d: 0.344234
0.9992 --- loss: 1.385896, loss_ss: 1.091498, loss_d: 0.294398
Epoch finished! Loss: 1.4247171521186828
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.108095, loss_ss: 0.786955, loss_d: 0.321141
0.0384 --- loss: 1.686364, loss_ss: 0.775257, loss_d: 0.911107
0.0769 --- loss: 1.341954, loss_ss: 0.953896, loss_d: 0.388058
0.1153 --- loss: 1.161747, loss_ss: 0.793115, loss_d: 0.368632
0.1537 --- loss: 1.105128, loss_ss: 0.857023, loss_d: 0.248105
0.1922 --- loss: 0.961704, loss_ss: 0.826537, loss_d: 0.135167
0.2306 --- loss: 1.057578, loss_ss: 0.832260, loss_d: 0.225318
0.2690 --- loss: 1.089099, loss_ss: 0.911247, loss_d: 0.177852
0.3075 --- loss: 1.380294, loss_ss: 0.945085, loss_d: 0.435209
0.3459 --- loss: 1.654677, loss_ss: 1.162865, loss_d: 0.491812
0.3843 --- loss: 1.006886, loss_ss: 0.728453, loss_d: 0.278434
0.4228 --- loss: 1.141565, loss_ss: 0.628562, loss_d: 0.513003
0.4612 --- loss: 1.254304, loss_ss: 0.900662, loss_d: 0.353642
0.4996 --- loss: 1.313415, loss_ss: 1.013020, loss_d: 0.300395
0.5380 --- loss: 1.524834, loss_ss: 0.918536, loss_d: 0.606298
0.5765 --- loss: 1.211928, loss_ss: 0.889308, loss_d: 0.322620
0.6149 --- loss: 1.189555, loss_ss: 0.962743, loss_d: 0.226813
0.6533 --- loss: 1.482983, loss_ss: 1.061521, loss_d: 0.421462
0.6918 --- loss: 1.053906, loss_ss: 0.733894, loss_d: 0.320012
0.7302 --- loss: 1.633806, loss_ss: 1.028546, loss_d: 0.605260
0.7686 --- loss: 1.184752, loss_ss: 0.615533, loss_d: 0.569219
0.8071 --- loss: 1.121685, loss_ss: 0.825054, loss_d: 0.296631
0.8455 --- loss: 1.473734, loss_ss: 1.053003, loss_d: 0.420731
0.8839 --- loss: 1.799790, loss_ss: 1.257386, loss_d: 0.542404
0.9224 --- loss: 1.210173, loss_ss: 1.018234, loss_d: 0.191938
0.9608 --- loss: 1.239442, loss_ss: 0.990192, loss_d: 0.249250
0.9992 --- loss: 1.438234, loss_ss: 1.087099, loss_d: 0.351135
Epoch finished! Loss: 1.3427083732990117
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.301647, loss_ss: 0.904356, loss_d: 0.397291
0.0384 --- loss: 1.604173, loss_ss: 1.094242, loss_d: 0.509930
0.0769 --- loss: 1.261992, loss_ss: 0.940304, loss_d: 0.321688
0.1153 --- loss: 1.328005, loss_ss: 0.983876, loss_d: 0.344128
0.1537 --- loss: 1.379964, loss_ss: 0.865129, loss_d: 0.514835
0.1922 --- loss: 1.052729, loss_ss: 0.852163, loss_d: 0.200566
0.2306 --- loss: 2.030972, loss_ss: 1.018931, loss_d: 1.012040
0.2690 --- loss: 1.245237, loss_ss: 1.049704, loss_d: 0.195533
0.3075 --- loss: 1.306292, loss_ss: 0.877565, loss_d: 0.428727
0.3459 --- loss: 1.498455, loss_ss: 1.289312, loss_d: 0.209143
0.3843 --- loss: 1.128465, loss_ss: 0.901559, loss_d: 0.226905
0.4228 --- loss: 1.865129, loss_ss: 0.864956, loss_d: 1.000173
0.4612 --- loss: 1.267602, loss_ss: 1.007523, loss_d: 0.260079
0.4996 --- loss: 1.139662, loss_ss: 0.877610, loss_d: 0.262051
0.5380 --- loss: 1.071822, loss_ss: 0.763235, loss_d: 0.308587
0.5765 --- loss: 1.628617, loss_ss: 1.226159, loss_d: 0.402458
0.6149 --- loss: 0.987377, loss_ss: 0.777265, loss_d: 0.210113
0.6533 --- loss: 1.231494, loss_ss: 1.097736, loss_d: 0.133758
0.6918 --- loss: 1.084979, loss_ss: 0.792482, loss_d: 0.292496
0.7302 --- loss: 1.650733, loss_ss: 1.389037, loss_d: 0.261696
0.7686 --- loss: 1.313501, loss_ss: 0.894964, loss_d: 0.418537
0.8071 --- loss: 1.118140, loss_ss: 0.748337, loss_d: 0.369803
0.8455 --- loss: 1.079270, loss_ss: 0.762123, loss_d: 0.317147
0.8839 --- loss: 1.569782, loss_ss: 1.248335, loss_d: 0.321447
0.9224 --- loss: 1.079178, loss_ss: 0.839619, loss_d: 0.239559
0.9608 --- loss: 1.218759, loss_ss: 0.728736, loss_d: 0.490023
0.9992 --- loss: 1.302683, loss_ss: 0.854745, loss_d: 0.447937
Epoch finished! Loss: 1.2898310661315917
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.199287, loss_ss: 0.778296, loss_d: 0.420991
0.0384 --- loss: 1.501679, loss_ss: 1.093960, loss_d: 0.407719
0.0769 --- loss: 1.407791, loss_ss: 1.148712, loss_d: 0.259079
0.1153 --- loss: 0.856877, loss_ss: 0.684473, loss_d: 0.172403
0.1537 --- loss: 1.158667, loss_ss: 0.971385, loss_d: 0.187282
0.1922 --- loss: 0.984979, loss_ss: 0.893305, loss_d: 0.091674
0.2306 --- loss: 1.623240, loss_ss: 1.212948, loss_d: 0.410291
0.2690 --- loss: 0.978293, loss_ss: 0.693753, loss_d: 0.284540
0.3075 --- loss: 1.123288, loss_ss: 0.897143, loss_d: 0.226144
0.3459 --- loss: 1.069460, loss_ss: 0.803083, loss_d: 0.266378
0.3843 --- loss: 1.257094, loss_ss: 0.567387, loss_d: 0.689707
0.4228 --- loss: 1.191022, loss_ss: 1.005248, loss_d: 0.185774
0.4612 --- loss: 0.980212, loss_ss: 0.788321, loss_d: 0.191891
0.4996 --- loss: 1.392880, loss_ss: 0.920579, loss_d: 0.472301
0.5380 --- loss: 1.121831, loss_ss: 0.863839, loss_d: 0.257992
0.5765 --- loss: 1.218007, loss_ss: 1.053217, loss_d: 0.164791
0.6149 --- loss: 1.224821, loss_ss: 0.880517, loss_d: 0.344303
0.6533 --- loss: 1.175895, loss_ss: 0.813578, loss_d: 0.362318
0.6918 --- loss: 1.095081, loss_ss: 0.874131, loss_d: 0.220950
0.7302 --- loss: 1.107697, loss_ss: 0.964046, loss_d: 0.143651
0.7686 --- loss: 1.090776, loss_ss: 0.727688, loss_d: 0.363088
0.8071 --- loss: 1.204285, loss_ss: 0.937309, loss_d: 0.266976
0.8455 --- loss: 1.050091, loss_ss: 0.682243, loss_d: 0.367847
0.8839 --- loss: 0.879006, loss_ss: 0.700501, loss_d: 0.178504
0.9224 --- loss: 0.835853, loss_ss: 0.699347, loss_d: 0.136506
0.9608 --- loss: 1.029848, loss_ss: 0.694794, loss_d: 0.335054
0.9992 --- loss: 2.891059, loss_ss: 2.289752, loss_d: 0.601307
Epoch finished! Loss: 1.232446240232541
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.196023, loss_ss: 0.527991, loss_d: 0.668032
0.0384 --- loss: 0.757082, loss_ss: 0.505536, loss_d: 0.251547
0.0769 --- loss: 1.153721, loss_ss: 0.939198, loss_d: 0.214522
0.1153 --- loss: 0.750075, loss_ss: 0.602680, loss_d: 0.147395
0.1537 --- loss: 1.004640, loss_ss: 0.724678, loss_d: 0.279962
0.1922 --- loss: 1.154086, loss_ss: 0.804024, loss_d: 0.350063
0.2306 --- loss: 1.094992, loss_ss: 0.722264, loss_d: 0.372728
0.2690 --- loss: 1.216557, loss_ss: 0.796750, loss_d: 0.419807
0.3075 --- loss: 1.029983, loss_ss: 0.675415, loss_d: 0.354568
0.3459 --- loss: 1.161965, loss_ss: 0.876872, loss_d: 0.285093
0.3843 --- loss: 1.371221, loss_ss: 0.959426, loss_d: 0.411795
0.4228 --- loss: 1.159828, loss_ss: 0.971966, loss_d: 0.187862
0.4612 --- loss: 1.456650, loss_ss: 1.070187, loss_d: 0.386463
0.4996 --- loss: 1.120475, loss_ss: 0.737563, loss_d: 0.382912
0.5380 --- loss: 0.934385, loss_ss: 0.715213, loss_d: 0.219172
0.5765 --- loss: 2.015469, loss_ss: 0.734935, loss_d: 1.280535
0.6149 --- loss: 1.034264, loss_ss: 0.877882, loss_d: 0.156382
0.6533 --- loss: 1.040163, loss_ss: 0.843167, loss_d: 0.196996
0.6918 --- loss: 1.004676, loss_ss: 0.926151, loss_d: 0.078525
0.7302 --- loss: 1.228488, loss_ss: 0.751345, loss_d: 0.477143
0.7686 --- loss: 1.036792, loss_ss: 0.561050, loss_d: 0.475742
0.8071 --- loss: 1.601080, loss_ss: 1.492602, loss_d: 0.108478
0.8455 --- loss: 0.958738, loss_ss: 0.764102, loss_d: 0.194635
0.8839 --- loss: 1.085962, loss_ss: 0.865891, loss_d: 0.220070
0.9224 --- loss: 0.937099, loss_ss: 0.684723, loss_d: 0.252376
0.9608 --- loss: 0.799020, loss_ss: 0.663999, loss_d: 0.135022
0.9992 --- loss: 1.325054, loss_ss: 0.861147, loss_d: 0.463907
Epoch finished! Loss: 1.195731469301077
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.234308, loss_ss: 0.910783, loss_d: 0.323525
0.0384 --- loss: 0.992644, loss_ss: 0.879182, loss_d: 0.113463
0.0769 --- loss: 0.909985, loss_ss: 0.763393, loss_d: 0.146592
0.1153 --- loss: 1.300713, loss_ss: 0.977927, loss_d: 0.322785
0.1537 --- loss: 1.398961, loss_ss: 0.859404, loss_d: 0.539557
0.1922 --- loss: 1.250604, loss_ss: 0.935884, loss_d: 0.314720
0.2306 --- loss: 0.839824, loss_ss: 0.662642, loss_d: 0.177182
0.2690 --- loss: 1.002102, loss_ss: 0.892550, loss_d: 0.109552
0.3075 --- loss: 2.150261, loss_ss: 0.920470, loss_d: 1.229792
0.3459 --- loss: 1.154615, loss_ss: 1.001696, loss_d: 0.152918
0.3843 --- loss: 1.090241, loss_ss: 0.723825, loss_d: 0.366415
0.4228 --- loss: 0.988349, loss_ss: 0.778239, loss_d: 0.210110
0.4612 --- loss: 1.100747, loss_ss: 0.816546, loss_d: 0.284201
0.4996 --- loss: 1.086563, loss_ss: 0.933556, loss_d: 0.153007
0.5380 --- loss: 1.521376, loss_ss: 1.104113, loss_d: 0.417264
0.5765 --- loss: 1.031282, loss_ss: 0.909977, loss_d: 0.121305
0.6149 --- loss: 0.931525, loss_ss: 0.725392, loss_d: 0.206133
0.6533 --- loss: 0.961093, loss_ss: 0.840221, loss_d: 0.120872
0.6918 --- loss: 1.153863, loss_ss: 0.984597, loss_d: 0.169266
0.7302 --- loss: 1.219211, loss_ss: 0.938073, loss_d: 0.281138
0.7686 --- loss: 0.866880, loss_ss: 0.755452, loss_d: 0.111427
0.8071 --- loss: 0.924727, loss_ss: 0.707928, loss_d: 0.216799
0.8455 --- loss: 1.376845, loss_ss: 0.925358, loss_d: 0.451487
0.8839 --- loss: 0.925847, loss_ss: 0.707344, loss_d: 0.218503
0.9224 --- loss: 0.850843, loss_ss: 0.657699, loss_d: 0.193144
0.9608 --- loss: 1.728929, loss_ss: 0.972589, loss_d: 0.756341
0.9992 --- loss: 0.726760, loss_ss: 0.565041, loss_d: 0.161719
Epoch finished! Loss: 1.1607945279433176
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7388888888888889
             precision    recall  f1-score   support

        0.0       0.94      0.51      0.66       185
        1.0       0.27      0.24      0.25        50
        2.0       0.81      0.84      0.82       483
        3.0       0.88      0.74      0.80       216
        4.0       0.50      0.87      0.64       146

avg / total       0.78      0.74      0.74      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.11  51.35   99.33  94.06     66.43
1  93.43  24.00   96.80  26.67     25.26
2  84.07  83.85   84.25  81.16     82.48
3  92.69  73.61   97.45  87.85     80.10
4  86.48  86.99   86.40  50.00     63.50
Total accuracy: 73.89%
Average sen: 63.96%
Average spec: 92.85%
Macro f1-score: 63.56%
[0.46491972 0.33296394 0.24373874 0.30404216 0.31993443 0.06352639
 0.10921959 0.14453718 0.18419829 0.78813946 0.31689659 0.36620823
 0.34510005 0.27530283 0.14566973 0.11073972 0.23484471 0.12286991
 0.31201771 0.98853147 0.23027454 0.15662168 0.58651572 0.2239987
 0.09238651 0.57276791 0.5097487  0.38097909 0.18453072 0.22674012
 0.20409663 0.2937417  0.08600508 0.13480681 0.30801573 0.223992  ]
pred: 0.2941284026536677, label: 0
Right! Diagnosis: Other

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.371742, loss_ss: 1.634748, loss_d: 0.736994
0.0383 --- loss: 1.958845, loss_ss: 1.398925, loss_d: 0.559921
0.0766 --- loss: 2.194473, loss_ss: 1.442849, loss_d: 0.751624
0.1149 --- loss: 2.142316, loss_ss: 1.572332, loss_d: 0.569983
0.1533 --- loss: 2.315394, loss_ss: 1.520222, loss_d: 0.795172
0.1916 --- loss: 1.708916, loss_ss: 1.340913, loss_d: 0.368003
0.2299 --- loss: 2.199082, loss_ss: 1.426472, loss_d: 0.772610
0.2682 --- loss: 2.217366, loss_ss: 1.502611, loss_d: 0.714754
0.3065 --- loss: 1.976750, loss_ss: 1.257716, loss_d: 0.719033
0.3448 --- loss: 1.895298, loss_ss: 1.315471, loss_d: 0.579827
0.3831 --- loss: 1.946501, loss_ss: 1.302087, loss_d: 0.644414
0.4215 --- loss: 1.823963, loss_ss: 1.309012, loss_d: 0.514951
0.4598 --- loss: 2.260491, loss_ss: 1.438324, loss_d: 0.822167
0.4981 --- loss: 1.798602, loss_ss: 1.381551, loss_d: 0.417051
0.5364 --- loss: 1.681621, loss_ss: 1.192966, loss_d: 0.488655
0.5747 --- loss: 2.031847, loss_ss: 1.623343, loss_d: 0.408504
0.6130 --- loss: 1.995746, loss_ss: 1.393328, loss_d: 0.602419
0.6513 --- loss: 2.077018, loss_ss: 1.246849, loss_d: 0.830169
0.6897 --- loss: 1.673203, loss_ss: 1.163741, loss_d: 0.509462
0.7280 --- loss: 1.960741, loss_ss: 1.167589, loss_d: 0.793152
0.7663 --- loss: 1.707681, loss_ss: 1.078732, loss_d: 0.628948
0.8046 --- loss: 1.848809, loss_ss: 1.190588, loss_d: 0.658220
0.8429 --- loss: 1.743213, loss_ss: 0.934075, loss_d: 0.809139
0.8812 --- loss: 1.664619, loss_ss: 1.167953, loss_d: 0.496666
0.9195 --- loss: 1.788437, loss_ss: 1.152567, loss_d: 0.635870
0.9579 --- loss: 1.957549, loss_ss: 1.386033, loss_d: 0.571516
0.9962 --- loss: 1.560218, loss_ss: 1.047047, loss_d: 0.513171
Epoch finished! Loss: 1.8916648681347186
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.778822, loss_ss: 1.101895, loss_d: 0.676927
0.0383 --- loss: 2.013928, loss_ss: 1.215569, loss_d: 0.798360
0.0766 --- loss: 1.457867, loss_ss: 0.977548, loss_d: 0.480319
0.1149 --- loss: 1.942733, loss_ss: 1.275352, loss_d: 0.667381
0.1533 --- loss: 1.902002, loss_ss: 1.182818, loss_d: 0.719183
0.1916 --- loss: 1.747995, loss_ss: 1.235504, loss_d: 0.512491
0.2299 --- loss: 1.913297, loss_ss: 1.147985, loss_d: 0.765312
0.2682 --- loss: 1.502442, loss_ss: 1.029815, loss_d: 0.472627
0.3065 --- loss: 1.627881, loss_ss: 1.141496, loss_d: 0.486385
0.3448 --- loss: 1.946049, loss_ss: 1.241600, loss_d: 0.704449
0.3831 --- loss: 1.411792, loss_ss: 0.915696, loss_d: 0.496095
0.4215 --- loss: 1.474806, loss_ss: 0.884473, loss_d: 0.590333
0.4598 --- loss: 1.506740, loss_ss: 0.998694, loss_d: 0.508045
0.4981 --- loss: 1.746638, loss_ss: 1.329745, loss_d: 0.416893
0.5364 --- loss: 1.596100, loss_ss: 1.255097, loss_d: 0.341003
0.5747 --- loss: 1.886881, loss_ss: 1.166176, loss_d: 0.720706
0.6130 --- loss: 2.132739, loss_ss: 1.300242, loss_d: 0.832496
0.6513 --- loss: 1.667319, loss_ss: 0.912620, loss_d: 0.754698
0.6897 --- loss: 1.573007, loss_ss: 1.135145, loss_d: 0.437861
0.7280 --- loss: 1.683973, loss_ss: 1.143115, loss_d: 0.540858
0.7663 --- loss: 1.386827, loss_ss: 0.945848, loss_d: 0.440979
0.8046 --- loss: 1.503119, loss_ss: 1.010840, loss_d: 0.492280
0.8429 --- loss: 1.604302, loss_ss: 1.028392, loss_d: 0.575910
0.8812 --- loss: 1.688035, loss_ss: 1.133261, loss_d: 0.554774
0.9195 --- loss: 1.441641, loss_ss: 0.975831, loss_d: 0.465809
0.9579 --- loss: 1.653712, loss_ss: 1.135468, loss_d: 0.518244
0.9962 --- loss: 1.794576, loss_ss: 1.122802, loss_d: 0.671774
Epoch finished! Loss: 1.6893688752101017
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.362733, loss_ss: 0.976073, loss_d: 0.386661
0.0383 --- loss: 1.441865, loss_ss: 1.078103, loss_d: 0.363761
0.0766 --- loss: 1.458836, loss_ss: 0.962742, loss_d: 0.496094
0.1149 --- loss: 1.975341, loss_ss: 1.172246, loss_d: 0.803095
0.1533 --- loss: 1.650407, loss_ss: 1.294611, loss_d: 0.355796
0.1916 --- loss: 1.689852, loss_ss: 1.366414, loss_d: 0.323438
0.2299 --- loss: 1.592467, loss_ss: 1.121620, loss_d: 0.470847
0.2682 --- loss: 1.906654, loss_ss: 1.107391, loss_d: 0.799263
0.3065 --- loss: 1.699755, loss_ss: 1.116599, loss_d: 0.583155
0.3448 --- loss: 1.297089, loss_ss: 0.809419, loss_d: 0.487670
0.3831 --- loss: 1.464577, loss_ss: 1.004227, loss_d: 0.460349
0.4215 --- loss: 1.713566, loss_ss: 1.245201, loss_d: 0.468365
0.4598 --- loss: 1.705042, loss_ss: 1.051216, loss_d: 0.653825
0.4981 --- loss: 1.627348, loss_ss: 0.989543, loss_d: 0.637805
0.5364 --- loss: 1.330735, loss_ss: 0.884512, loss_d: 0.446223
0.5747 --- loss: 1.163500, loss_ss: 0.853236, loss_d: 0.310264
0.6130 --- loss: 1.870114, loss_ss: 0.931148, loss_d: 0.938966
0.6513 --- loss: 1.689324, loss_ss: 0.981791, loss_d: 0.707533
0.6897 --- loss: 1.729259, loss_ss: 0.995317, loss_d: 0.733942
0.7280 --- loss: 1.405919, loss_ss: 0.930722, loss_d: 0.475198
0.7663 --- loss: 1.625211, loss_ss: 1.021924, loss_d: 0.603287
0.8046 --- loss: 1.754735, loss_ss: 1.083882, loss_d: 0.670853
0.8429 --- loss: 1.597983, loss_ss: 0.922036, loss_d: 0.675947
0.8812 --- loss: 1.460429, loss_ss: 0.685488, loss_d: 0.774941
0.9195 --- loss: 1.479121, loss_ss: 1.047998, loss_d: 0.431123
0.9579 --- loss: 1.445808, loss_ss: 0.708390, loss_d: 0.737418
0.9962 --- loss: 1.261639, loss_ss: 0.797313, loss_d: 0.464326
Epoch finished! Loss: 1.583226452423976
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.446922, loss_ss: 0.969142, loss_d: 0.477779
0.0383 --- loss: 1.445592, loss_ss: 0.863483, loss_d: 0.582109
0.0766 --- loss: 1.963966, loss_ss: 1.207559, loss_d: 0.756407
0.1149 --- loss: 1.314071, loss_ss: 0.768032, loss_d: 0.546039
0.1533 --- loss: 1.665204, loss_ss: 1.000139, loss_d: 0.665065
0.1916 --- loss: 1.331132, loss_ss: 0.702963, loss_d: 0.628170
0.2299 --- loss: 1.383453, loss_ss: 0.939709, loss_d: 0.443744
0.2682 --- loss: 1.779382, loss_ss: 1.206737, loss_d: 0.572645
0.3065 --- loss: 1.608951, loss_ss: 1.014739, loss_d: 0.594211
0.3448 --- loss: 1.173513, loss_ss: 0.781610, loss_d: 0.391904
0.3831 --- loss: 1.337452, loss_ss: 0.801524, loss_d: 0.535928
0.4215 --- loss: 1.519241, loss_ss: 0.744051, loss_d: 0.775190
0.4598 --- loss: 1.311445, loss_ss: 0.941596, loss_d: 0.369849
0.4981 --- loss: 1.523505, loss_ss: 1.158115, loss_d: 0.365390
0.5364 --- loss: 1.649406, loss_ss: 1.160705, loss_d: 0.488701
0.5747 --- loss: 2.110096, loss_ss: 1.588071, loss_d: 0.522025
0.6130 --- loss: 1.544256, loss_ss: 0.948655, loss_d: 0.595601
0.6513 --- loss: 1.598889, loss_ss: 1.073288, loss_d: 0.525601
0.6897 --- loss: 1.555924, loss_ss: 0.991216, loss_d: 0.564708
0.7280 --- loss: 1.301586, loss_ss: 0.870959, loss_d: 0.430627
0.7663 --- loss: 1.359086, loss_ss: 0.933473, loss_d: 0.425613
0.8046 --- loss: 1.444146, loss_ss: 0.935375, loss_d: 0.508772
0.8429 --- loss: 1.344663, loss_ss: 0.944948, loss_d: 0.399715
0.8812 --- loss: 1.157438, loss_ss: 0.871167, loss_d: 0.286271
0.9195 --- loss: 1.336492, loss_ss: 0.907851, loss_d: 0.428641
0.9579 --- loss: 1.615416, loss_ss: 0.920014, loss_d: 0.695402
0.9962 --- loss: 1.722739, loss_ss: 0.763225, loss_d: 0.959514
Epoch finished! Loss: 1.535768008690614
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.629702, loss_ss: 0.837568, loss_d: 0.792133
0.0383 --- loss: 1.483515, loss_ss: 0.698598, loss_d: 0.784917
0.0766 --- loss: 1.636781, loss_ss: 1.061247, loss_d: 0.575534
0.1149 --- loss: 1.529912, loss_ss: 0.921464, loss_d: 0.608448
0.1533 --- loss: 1.510013, loss_ss: 0.867414, loss_d: 0.642599
0.1916 --- loss: 1.616087, loss_ss: 0.801692, loss_d: 0.814395
0.2299 --- loss: 1.548854, loss_ss: 1.037834, loss_d: 0.511020
0.2682 --- loss: 1.401542, loss_ss: 0.824421, loss_d: 0.577121
0.3065 --- loss: 1.676985, loss_ss: 1.026986, loss_d: 0.649999
0.3448 --- loss: 1.796519, loss_ss: 0.813072, loss_d: 0.983447
0.3831 --- loss: 1.852416, loss_ss: 1.090243, loss_d: 0.762173
0.4215 --- loss: 1.359357, loss_ss: 0.731734, loss_d: 0.627623
0.4598 --- loss: 1.344255, loss_ss: 0.792334, loss_d: 0.551921
0.4981 --- loss: 1.150670, loss_ss: 0.884570, loss_d: 0.266100
0.5364 --- loss: 1.678979, loss_ss: 0.912323, loss_d: 0.766657
0.5747 --- loss: 1.660826, loss_ss: 1.056604, loss_d: 0.604223
0.6130 --- loss: 1.616801, loss_ss: 1.197133, loss_d: 0.419668
0.6513 --- loss: 1.273999, loss_ss: 0.879897, loss_d: 0.394103
0.6897 --- loss: 1.986756, loss_ss: 1.285973, loss_d: 0.700782
0.7280 --- loss: 1.311745, loss_ss: 0.946972, loss_d: 0.364773
0.7663 --- loss: 1.466961, loss_ss: 0.913141, loss_d: 0.553820
0.8046 --- loss: 1.585913, loss_ss: 0.821938, loss_d: 0.763975
0.8429 --- loss: 1.357052, loss_ss: 0.902135, loss_d: 0.454917
0.8812 --- loss: 1.169394, loss_ss: 0.811603, loss_d: 0.357790
0.9195 --- loss: 1.660948, loss_ss: 0.756020, loss_d: 0.904928
0.9579 --- loss: 1.265377, loss_ss: 0.843646, loss_d: 0.421731
0.9962 --- loss: 1.446753, loss_ss: 0.912269, loss_d: 0.534484
Epoch finished! Loss: 1.489013638633948
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.967815, loss_ss: 1.375784, loss_d: 0.592032
0.0383 --- loss: 1.686032, loss_ss: 1.126164, loss_d: 0.559868
0.0766 --- loss: 1.440136, loss_ss: 0.776119, loss_d: 0.664017
0.1149 --- loss: 1.245862, loss_ss: 0.806120, loss_d: 0.439742
0.1533 --- loss: 1.699824, loss_ss: 0.936691, loss_d: 0.763133
0.1916 --- loss: 1.698121, loss_ss: 1.322816, loss_d: 0.375305
0.2299 --- loss: 1.527968, loss_ss: 0.957204, loss_d: 0.570764
0.2682 --- loss: 1.823543, loss_ss: 0.946767, loss_d: 0.876776
0.3065 --- loss: 1.396036, loss_ss: 0.979582, loss_d: 0.416454
0.3448 --- loss: 1.510896, loss_ss: 0.972209, loss_d: 0.538687
0.3831 --- loss: 1.111488, loss_ss: 0.757530, loss_d: 0.353958
0.4215 --- loss: 1.240220, loss_ss: 0.837311, loss_d: 0.402909
0.4598 --- loss: 1.349465, loss_ss: 0.961876, loss_d: 0.387589
0.4981 --- loss: 1.473931, loss_ss: 0.933881, loss_d: 0.540050
0.5364 --- loss: 1.617050, loss_ss: 1.302835, loss_d: 0.314215
0.5747 --- loss: 1.130611, loss_ss: 0.782609, loss_d: 0.348002
0.6130 --- loss: 1.266346, loss_ss: 0.895826, loss_d: 0.370520
0.6513 --- loss: 1.646694, loss_ss: 1.144307, loss_d: 0.502387
0.6897 --- loss: 1.124025, loss_ss: 0.812339, loss_d: 0.311686
0.7280 --- loss: 1.493038, loss_ss: 1.055485, loss_d: 0.437553
0.7663 --- loss: 1.297717, loss_ss: 0.828536, loss_d: 0.469181
0.8046 --- loss: 1.297445, loss_ss: 0.961010, loss_d: 0.336435
0.8429 --- loss: 1.185197, loss_ss: 0.706996, loss_d: 0.478202
0.8812 --- loss: 1.502268, loss_ss: 0.769877, loss_d: 0.732391
0.9195 --- loss: 1.312754, loss_ss: 0.626277, loss_d: 0.686477
0.9579 --- loss: 1.187829, loss_ss: 0.671152, loss_d: 0.516676
0.9962 --- loss: 1.368016, loss_ss: 1.096975, loss_d: 0.271041
Epoch finished! Loss: 1.4003539385703894
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.296610, loss_ss: 0.767419, loss_d: 0.529191
0.0383 --- loss: 1.295924, loss_ss: 0.717624, loss_d: 0.578300
0.0766 --- loss: 1.390462, loss_ss: 0.889334, loss_d: 0.501128
0.1149 --- loss: 1.493569, loss_ss: 0.982806, loss_d: 0.510763
0.1533 --- loss: 1.148830, loss_ss: 0.911754, loss_d: 0.237076
0.1916 --- loss: 1.250057, loss_ss: 1.020497, loss_d: 0.229560
0.2299 --- loss: 1.410616, loss_ss: 0.944789, loss_d: 0.465827
0.2682 --- loss: 1.151446, loss_ss: 0.902960, loss_d: 0.248486
0.3065 --- loss: 1.245114, loss_ss: 0.998683, loss_d: 0.246431
0.3448 --- loss: 1.715996, loss_ss: 1.116372, loss_d: 0.599624
0.3831 --- loss: 1.609812, loss_ss: 0.872547, loss_d: 0.737265
0.4215 --- loss: 1.056572, loss_ss: 0.868541, loss_d: 0.188032
0.4598 --- loss: 1.043804, loss_ss: 0.808498, loss_d: 0.235306
0.4981 --- loss: 1.358590, loss_ss: 1.046374, loss_d: 0.312216
0.5364 --- loss: 1.205956, loss_ss: 1.025426, loss_d: 0.180530
0.5747 --- loss: 1.348109, loss_ss: 0.908193, loss_d: 0.439916
0.6130 --- loss: 1.627234, loss_ss: 1.103454, loss_d: 0.523780
0.6513 --- loss: 1.228751, loss_ss: 0.650687, loss_d: 0.578064
0.6897 --- loss: 1.228632, loss_ss: 0.918691, loss_d: 0.309941
0.7280 --- loss: 1.423450, loss_ss: 0.856886, loss_d: 0.566564
0.7663 --- loss: 1.806217, loss_ss: 1.262803, loss_d: 0.543414
0.8046 --- loss: 1.301035, loss_ss: 0.935148, loss_d: 0.365888
0.8429 --- loss: 1.238457, loss_ss: 0.928771, loss_d: 0.309686
0.8812 --- loss: 1.018534, loss_ss: 0.741226, loss_d: 0.277308
0.9195 --- loss: 0.919354, loss_ss: 0.750680, loss_d: 0.168674
0.9579 --- loss: 1.450333, loss_ss: 0.812224, loss_d: 0.638109
0.9962 --- loss: 1.244522, loss_ss: 0.773401, loss_d: 0.471121
Epoch finished! Loss: 1.3017929159677946
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.402010, loss_ss: 1.052045, loss_d: 0.349965
0.0383 --- loss: 1.356513, loss_ss: 1.061951, loss_d: 0.294562
0.0766 --- loss: 1.947450, loss_ss: 1.364415, loss_d: 0.583035
0.1149 --- loss: 1.262497, loss_ss: 0.864811, loss_d: 0.397686
0.1533 --- loss: 1.074538, loss_ss: 0.870644, loss_d: 0.203894
0.1916 --- loss: 1.454831, loss_ss: 0.711525, loss_d: 0.743306
0.2299 --- loss: 1.058069, loss_ss: 0.786486, loss_d: 0.271583
0.2682 --- loss: 1.172622, loss_ss: 0.797801, loss_d: 0.374821
0.3065 --- loss: 1.185482, loss_ss: 0.808406, loss_d: 0.377076
0.3448 --- loss: 1.153505, loss_ss: 0.569951, loss_d: 0.583555
0.3831 --- loss: 1.350942, loss_ss: 0.981679, loss_d: 0.369263
0.4215 --- loss: 1.375337, loss_ss: 1.074675, loss_d: 0.300662
0.4598 --- loss: 1.181721, loss_ss: 0.956781, loss_d: 0.224940
0.4981 --- loss: 1.112012, loss_ss: 0.933524, loss_d: 0.178488
0.5364 --- loss: 1.491948, loss_ss: 1.260044, loss_d: 0.231903
0.5747 --- loss: 1.676262, loss_ss: 0.775071, loss_d: 0.901191
0.6130 --- loss: 1.159382, loss_ss: 0.850942, loss_d: 0.308440
0.6513 --- loss: 0.999577, loss_ss: 0.758435, loss_d: 0.241142
0.6897 --- loss: 1.547116, loss_ss: 1.127255, loss_d: 0.419861
0.7280 --- loss: 1.265714, loss_ss: 1.056111, loss_d: 0.209603
0.7663 --- loss: 1.950855, loss_ss: 0.965213, loss_d: 0.985642
0.8046 --- loss: 1.129071, loss_ss: 0.878734, loss_d: 0.250337
0.8429 --- loss: 1.111111, loss_ss: 0.831733, loss_d: 0.279378
0.8812 --- loss: 1.310617, loss_ss: 0.934911, loss_d: 0.375706
0.9195 --- loss: 1.089615, loss_ss: 0.872560, loss_d: 0.217055
0.9579 --- loss: 1.529676, loss_ss: 1.047722, loss_d: 0.481954
0.9962 --- loss: 1.167983, loss_ss: 0.774109, loss_d: 0.393873
Epoch finished! Loss: 1.2938182051365192
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.384898, loss_ss: 0.934092, loss_d: 0.450806
0.0383 --- loss: 1.006004, loss_ss: 0.812234, loss_d: 0.193770
0.0766 --- loss: 1.413532, loss_ss: 1.247249, loss_d: 0.166282
0.1149 --- loss: 0.856335, loss_ss: 0.691904, loss_d: 0.164432
0.1533 --- loss: 1.518336, loss_ss: 1.239044, loss_d: 0.279292
0.1916 --- loss: 1.546249, loss_ss: 0.907818, loss_d: 0.638431
0.2299 --- loss: 1.163267, loss_ss: 0.706326, loss_d: 0.456941
0.2682 --- loss: 1.329086, loss_ss: 0.847218, loss_d: 0.481868
0.3065 --- loss: 1.162882, loss_ss: 0.958119, loss_d: 0.204764
0.3448 --- loss: 1.074968, loss_ss: 0.926446, loss_d: 0.148522
0.3831 --- loss: 1.187589, loss_ss: 0.963815, loss_d: 0.223774
0.4215 --- loss: 0.969807, loss_ss: 0.788408, loss_d: 0.181399
0.4598 --- loss: 0.888037, loss_ss: 0.556390, loss_d: 0.331647
0.4981 --- loss: 1.076360, loss_ss: 0.855066, loss_d: 0.221294
0.5364 --- loss: 1.109750, loss_ss: 0.846625, loss_d: 0.263125
0.5747 --- loss: 1.734785, loss_ss: 0.798212, loss_d: 0.936573
0.6130 --- loss: 1.405897, loss_ss: 0.742297, loss_d: 0.663600
0.6513 --- loss: 0.755001, loss_ss: 0.521634, loss_d: 0.233367
0.6897 --- loss: 1.441001, loss_ss: 1.065442, loss_d: 0.375559
0.7280 --- loss: 1.050965, loss_ss: 0.756015, loss_d: 0.294950
0.7663 --- loss: 1.409488, loss_ss: 1.196423, loss_d: 0.213065
0.8046 --- loss: 0.936506, loss_ss: 0.777689, loss_d: 0.158817
0.8429 --- loss: 1.376663, loss_ss: 0.784855, loss_d: 0.591808
0.8812 --- loss: 1.205195, loss_ss: 0.926161, loss_d: 0.279033
0.9195 --- loss: 1.482004, loss_ss: 0.970969, loss_d: 0.511035
0.9579 --- loss: 1.066086, loss_ss: 0.880417, loss_d: 0.185669
0.9962 --- loss: 0.856760, loss_ss: 0.672742, loss_d: 0.184017
Epoch finished! Loss: 1.2210292103198859
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.327857, loss_ss: 0.888594, loss_d: 0.439263
0.0383 --- loss: 1.075577, loss_ss: 0.791902, loss_d: 0.283675
0.0766 --- loss: 0.902917, loss_ss: 0.733827, loss_d: 0.169090
0.1149 --- loss: 0.931811, loss_ss: 0.747856, loss_d: 0.183955
0.1533 --- loss: 1.174466, loss_ss: 0.976912, loss_d: 0.197553
0.1916 --- loss: 1.414775, loss_ss: 0.881425, loss_d: 0.533350
0.2299 --- loss: 1.124780, loss_ss: 0.760405, loss_d: 0.364375
0.2682 --- loss: 1.054252, loss_ss: 0.823383, loss_d: 0.230870
0.3065 --- loss: 1.558389, loss_ss: 0.762562, loss_d: 0.795827
0.3448 --- loss: 0.926894, loss_ss: 0.757042, loss_d: 0.169852
0.3831 --- loss: 2.087863, loss_ss: 1.571145, loss_d: 0.516718
0.4215 --- loss: 1.257137, loss_ss: 0.810027, loss_d: 0.447110
0.4598 --- loss: 1.383243, loss_ss: 0.899501, loss_d: 0.483742
0.4981 --- loss: 0.935022, loss_ss: 0.784884, loss_d: 0.150138
0.5364 --- loss: 1.385958, loss_ss: 0.789741, loss_d: 0.596217
0.5747 --- loss: 0.927413, loss_ss: 0.750062, loss_d: 0.177351
0.6130 --- loss: 1.569383, loss_ss: 1.101953, loss_d: 0.467430
0.6513 --- loss: 1.565883, loss_ss: 0.890473, loss_d: 0.675410
0.6897 --- loss: 0.921965, loss_ss: 0.712196, loss_d: 0.209769
0.7280 --- loss: 1.132580, loss_ss: 0.783950, loss_d: 0.348630
0.7663 --- loss: 0.869739, loss_ss: 0.689973, loss_d: 0.179766
0.8046 --- loss: 0.926064, loss_ss: 0.656859, loss_d: 0.269205
0.8429 --- loss: 0.861518, loss_ss: 0.671312, loss_d: 0.190206
0.8812 --- loss: 1.116938, loss_ss: 0.781445, loss_d: 0.335493
0.9195 --- loss: 1.474466, loss_ss: 0.750594, loss_d: 0.723872
0.9579 --- loss: 1.003703, loss_ss: 0.885247, loss_d: 0.118456
0.9962 --- loss: 0.850341, loss_ss: 0.670384, loss_d: 0.179957
Epoch finished! Loss: 1.1910266775351304
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7035714285714286
             precision    recall  f1-score   support

        0.0       0.30      0.86      0.44        56
        1.0       0.02      0.03      0.03        38
        2.0       0.80      0.74      0.77       416
        3.0       1.00      0.70      0.82       188
        4.0       0.84      0.74      0.79       142

avg / total       0.78      0.70      0.73       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.71  85.71   85.71   30.00     44.44
1  90.71   2.63   94.89    2.38      2.50
2  77.86  73.56   82.08   80.10     76.69
3  93.21  69.68  100.00  100.00     82.13
4  93.21  73.94   97.13   84.00     78.65
Total accuracy: 70.36%
Average sen: 61.11%
Average spec: 91.96%
Macro f1-score: 56.88%
[0.53336716 0.37182486 0.77095896 0.52601904 0.26896477 0.51587528
 0.85077643 0.68084407 0.41530904 0.32484666 0.23458131 0.35379171
 0.46653762 0.86986804 0.85829234 0.4815169  0.4236556  0.27822065
 0.43534404 0.36912021 0.45771837 0.39356807 0.45712194 0.26366398
 0.18758591 0.3187294  0.47308707 0.17276181]
pred: 0.4554982584502016, label: 0
Right! Diagnosis: Other

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.297304, loss_ss: 1.655249, loss_d: 0.642056
0.0383 --- loss: 2.404926, loss_ss: 1.469783, loss_d: 0.935143
0.0767 --- loss: 1.990422, loss_ss: 1.431864, loss_d: 0.558559
0.1150 --- loss: 2.044585, loss_ss: 1.448640, loss_d: 0.595945
0.1534 --- loss: 1.715510, loss_ss: 1.363617, loss_d: 0.351893
0.1917 --- loss: 1.821908, loss_ss: 1.263615, loss_d: 0.558293
0.2301 --- loss: 1.880114, loss_ss: 1.374386, loss_d: 0.505728
0.2684 --- loss: 2.192623, loss_ss: 1.473539, loss_d: 0.719084
0.3067 --- loss: 1.918129, loss_ss: 1.427992, loss_d: 0.490137
0.3451 --- loss: 2.023875, loss_ss: 1.370512, loss_d: 0.653362
0.3834 --- loss: 1.473266, loss_ss: 1.192446, loss_d: 0.280819
0.4218 --- loss: 1.550094, loss_ss: 1.178247, loss_d: 0.371847
0.4601 --- loss: 2.033102, loss_ss: 1.419853, loss_d: 0.613249
0.4985 --- loss: 2.001269, loss_ss: 1.284895, loss_d: 0.716374
0.5368 --- loss: 1.787288, loss_ss: 1.210036, loss_d: 0.577252
0.5752 --- loss: 2.065903, loss_ss: 1.489264, loss_d: 0.576639
0.6135 --- loss: 2.176031, loss_ss: 1.217836, loss_d: 0.958196
0.6518 --- loss: 1.989865, loss_ss: 1.225785, loss_d: 0.764080
0.6902 --- loss: 1.892956, loss_ss: 1.175432, loss_d: 0.717524
0.7285 --- loss: 1.958122, loss_ss: 1.242035, loss_d: 0.716086
0.7669 --- loss: 1.971119, loss_ss: 1.258247, loss_d: 0.712872
0.8052 --- loss: 1.696864, loss_ss: 1.137962, loss_d: 0.558902
0.8436 --- loss: 1.549498, loss_ss: 1.044571, loss_d: 0.504928
0.8819 --- loss: 1.731944, loss_ss: 1.073892, loss_d: 0.658052
0.9202 --- loss: 2.207160, loss_ss: 1.114830, loss_d: 1.092330
0.9586 --- loss: 1.484887, loss_ss: 0.955975, loss_d: 0.528912
0.9969 --- loss: 1.964563, loss_ss: 1.062373, loss_d: 0.902190
Epoch finished! Loss: 1.8777544828561636
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.531454, loss_ss: 0.949110, loss_d: 0.582343
0.0383 --- loss: 1.820672, loss_ss: 1.321018, loss_d: 0.499653
0.0767 --- loss: 1.701688, loss_ss: 1.161832, loss_d: 0.539855
0.1150 --- loss: 1.240082, loss_ss: 0.979784, loss_d: 0.260298
0.1534 --- loss: 1.505984, loss_ss: 1.049855, loss_d: 0.456129
0.1917 --- loss: 1.645401, loss_ss: 0.976365, loss_d: 0.669037
0.2301 --- loss: 1.824028, loss_ss: 1.101017, loss_d: 0.723011
0.2684 --- loss: 1.658953, loss_ss: 1.167242, loss_d: 0.491711
0.3067 --- loss: 1.945405, loss_ss: 1.109614, loss_d: 0.835790
0.3451 --- loss: 1.965215, loss_ss: 1.071688, loss_d: 0.893527
0.3834 --- loss: 1.861004, loss_ss: 1.393301, loss_d: 0.467703
0.4218 --- loss: 1.587450, loss_ss: 1.104862, loss_d: 0.482588
0.4601 --- loss: 1.841886, loss_ss: 1.314797, loss_d: 0.527089
0.4985 --- loss: 1.600710, loss_ss: 0.912805, loss_d: 0.687905
0.5368 --- loss: 1.698273, loss_ss: 1.212082, loss_d: 0.486191
0.5752 --- loss: 1.628331, loss_ss: 1.179122, loss_d: 0.449209
0.6135 --- loss: 1.911863, loss_ss: 1.109136, loss_d: 0.802727
0.6518 --- loss: 1.663936, loss_ss: 0.908612, loss_d: 0.755324
0.6902 --- loss: 1.254371, loss_ss: 0.914474, loss_d: 0.339897
0.7285 --- loss: 1.817974, loss_ss: 1.211744, loss_d: 0.606230
0.7669 --- loss: 1.533089, loss_ss: 1.044793, loss_d: 0.488297
0.8052 --- loss: 1.569155, loss_ss: 1.147930, loss_d: 0.421225
0.8436 --- loss: 1.402669, loss_ss: 0.814109, loss_d: 0.588561
0.8819 --- loss: 1.365517, loss_ss: 0.970153, loss_d: 0.395364
0.9202 --- loss: 1.475572, loss_ss: 0.991584, loss_d: 0.483989
0.9586 --- loss: 1.622194, loss_ss: 0.953227, loss_d: 0.668968
0.9969 --- loss: 1.416299, loss_ss: 0.872212, loss_d: 0.544087
Epoch finished! Loss: 1.679936790924806
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.688323, loss_ss: 1.127096, loss_d: 0.561227
0.0383 --- loss: 1.350765, loss_ss: 0.886899, loss_d: 0.463866
0.0767 --- loss: 1.803067, loss_ss: 1.195314, loss_d: 0.607753
0.1150 --- loss: 1.313995, loss_ss: 0.797696, loss_d: 0.516300
0.1534 --- loss: 1.867779, loss_ss: 1.323121, loss_d: 0.544658
0.1917 --- loss: 1.403405, loss_ss: 1.055434, loss_d: 0.347971
0.2301 --- loss: 1.943501, loss_ss: 1.240588, loss_d: 0.702912
0.2684 --- loss: 1.465398, loss_ss: 0.907727, loss_d: 0.557671
0.3067 --- loss: 1.704661, loss_ss: 1.243753, loss_d: 0.460908
0.3451 --- loss: 1.644867, loss_ss: 1.258644, loss_d: 0.386223
0.3834 --- loss: 1.461372, loss_ss: 0.904290, loss_d: 0.557082
0.4218 --- loss: 1.663802, loss_ss: 1.178392, loss_d: 0.485410
0.4601 --- loss: 1.699922, loss_ss: 1.090563, loss_d: 0.609360
0.4985 --- loss: 1.475924, loss_ss: 0.945934, loss_d: 0.529989
0.5368 --- loss: 1.708098, loss_ss: 1.341967, loss_d: 0.366131
0.5752 --- loss: 1.773239, loss_ss: 1.130676, loss_d: 0.642563
0.6135 --- loss: 1.731319, loss_ss: 1.152562, loss_d: 0.578758
0.6518 --- loss: 1.550012, loss_ss: 1.003645, loss_d: 0.546367
0.6902 --- loss: 1.331775, loss_ss: 0.994500, loss_d: 0.337275
0.7285 --- loss: 1.701210, loss_ss: 1.108015, loss_d: 0.593195
0.7669 --- loss: 1.712393, loss_ss: 0.968917, loss_d: 0.743475
0.8052 --- loss: 1.665286, loss_ss: 0.980327, loss_d: 0.684959
0.8436 --- loss: 1.540644, loss_ss: 0.881842, loss_d: 0.658802
0.8819 --- loss: 1.477987, loss_ss: 1.040189, loss_d: 0.437798
0.9202 --- loss: 1.239264, loss_ss: 0.847409, loss_d: 0.391854
0.9586 --- loss: 1.595718, loss_ss: 0.907001, loss_d: 0.688717
0.9969 --- loss: 1.537064, loss_ss: 1.013884, loss_d: 0.523180
Epoch finished! Loss: 1.5975881097408442
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.751484, loss_ss: 1.149378, loss_d: 0.602106
0.0383 --- loss: 1.596692, loss_ss: 1.112461, loss_d: 0.484231
0.0767 --- loss: 1.620261, loss_ss: 1.012594, loss_d: 0.607667
0.1150 --- loss: 1.723758, loss_ss: 0.900557, loss_d: 0.823201
0.1534 --- loss: 1.338151, loss_ss: 0.821905, loss_d: 0.516245
0.1917 --- loss: 1.316771, loss_ss: 1.007834, loss_d: 0.308936
0.2301 --- loss: 1.592406, loss_ss: 1.050165, loss_d: 0.542241
0.2684 --- loss: 1.808094, loss_ss: 1.224404, loss_d: 0.583690
0.3067 --- loss: 1.444689, loss_ss: 0.991290, loss_d: 0.453399
0.3451 --- loss: 1.840830, loss_ss: 1.242122, loss_d: 0.598707
0.3834 --- loss: 1.937806, loss_ss: 1.592094, loss_d: 0.345711
0.4218 --- loss: 1.332377, loss_ss: 0.956252, loss_d: 0.376124
0.4601 --- loss: 1.553691, loss_ss: 0.747766, loss_d: 0.805924
0.4985 --- loss: 1.286481, loss_ss: 0.807523, loss_d: 0.478958
0.5368 --- loss: 1.389411, loss_ss: 0.983887, loss_d: 0.405524
0.5752 --- loss: 1.099320, loss_ss: 0.818941, loss_d: 0.280379
0.6135 --- loss: 2.090800, loss_ss: 1.165528, loss_d: 0.925272
0.6518 --- loss: 1.040907, loss_ss: 0.699407, loss_d: 0.341500
0.6902 --- loss: 1.655769, loss_ss: 1.115339, loss_d: 0.540430
0.7285 --- loss: 1.614226, loss_ss: 0.911685, loss_d: 0.702541
0.7669 --- loss: 1.088320, loss_ss: 0.795018, loss_d: 0.293301
0.8052 --- loss: 1.306731, loss_ss: 0.875251, loss_d: 0.431480
0.8436 --- loss: 1.475868, loss_ss: 1.166119, loss_d: 0.309749
0.8819 --- loss: 1.517535, loss_ss: 0.873690, loss_d: 0.643845
0.9202 --- loss: 1.586431, loss_ss: 0.996210, loss_d: 0.590220
0.9586 --- loss: 1.214311, loss_ss: 0.669592, loss_d: 0.544720
0.9969 --- loss: 1.517376, loss_ss: 0.938782, loss_d: 0.578593
Epoch finished! Loss: 1.5124331653118133
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.523318, loss_ss: 0.996620, loss_d: 0.526698
0.0383 --- loss: 1.239203, loss_ss: 0.701283, loss_d: 0.537920
0.0767 --- loss: 1.056684, loss_ss: 0.829243, loss_d: 0.227441
0.1150 --- loss: 1.078022, loss_ss: 0.841467, loss_d: 0.236555
0.1534 --- loss: 1.427061, loss_ss: 1.193412, loss_d: 0.233649
0.1917 --- loss: 0.893889, loss_ss: 0.634075, loss_d: 0.259814
0.2301 --- loss: 1.312146, loss_ss: 0.790557, loss_d: 0.521589
0.2684 --- loss: 0.997372, loss_ss: 0.721054, loss_d: 0.276318
0.3067 --- loss: 1.438288, loss_ss: 1.008927, loss_d: 0.429361
0.3451 --- loss: 1.374370, loss_ss: 1.202249, loss_d: 0.172121
0.3834 --- loss: 1.583527, loss_ss: 0.995387, loss_d: 0.588140
0.4218 --- loss: 1.284535, loss_ss: 1.055731, loss_d: 0.228804
0.4601 --- loss: 1.602341, loss_ss: 0.761156, loss_d: 0.841186
0.4985 --- loss: 1.548548, loss_ss: 1.056127, loss_d: 0.492420
0.5368 --- loss: 1.514569, loss_ss: 0.895183, loss_d: 0.619385
0.5752 --- loss: 1.635843, loss_ss: 0.789384, loss_d: 0.846459
0.6135 --- loss: 1.549374, loss_ss: 1.096187, loss_d: 0.453187
0.6518 --- loss: 1.368975, loss_ss: 1.082045, loss_d: 0.286929
0.6902 --- loss: 1.438956, loss_ss: 0.960984, loss_d: 0.477972
0.7285 --- loss: 1.386512, loss_ss: 0.863408, loss_d: 0.523104
0.7669 --- loss: 1.344115, loss_ss: 0.839572, loss_d: 0.504543
0.8052 --- loss: 1.147770, loss_ss: 0.784631, loss_d: 0.363139
0.8436 --- loss: 1.254711, loss_ss: 0.850562, loss_d: 0.404149
0.8819 --- loss: 1.242656, loss_ss: 1.006923, loss_d: 0.235733
0.9202 --- loss: 1.724527, loss_ss: 0.927128, loss_d: 0.797399
0.9586 --- loss: 1.455417, loss_ss: 0.837563, loss_d: 0.617854
0.9969 --- loss: 1.290290, loss_ss: 0.892312, loss_d: 0.397978
Epoch finished! Loss: 1.4166286287399439
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.517392, loss_ss: 1.083637, loss_d: 0.433755
0.0383 --- loss: 1.349934, loss_ss: 0.797736, loss_d: 0.552198
0.0767 --- loss: 1.406944, loss_ss: 0.869424, loss_d: 0.537520
0.1150 --- loss: 1.289129, loss_ss: 0.929517, loss_d: 0.359612
0.1534 --- loss: 1.206638, loss_ss: 0.890321, loss_d: 0.316316
0.1917 --- loss: 1.263575, loss_ss: 0.977071, loss_d: 0.286504
0.2301 --- loss: 1.178569, loss_ss: 0.932599, loss_d: 0.245971
0.2684 --- loss: 1.408570, loss_ss: 0.729886, loss_d: 0.678684
0.3067 --- loss: 1.665524, loss_ss: 1.055202, loss_d: 0.610321
0.3451 --- loss: 1.252425, loss_ss: 0.926424, loss_d: 0.326001
0.3834 --- loss: 1.496036, loss_ss: 0.926516, loss_d: 0.569520
0.4218 --- loss: 1.357794, loss_ss: 0.930057, loss_d: 0.427736
0.4601 --- loss: 1.205213, loss_ss: 0.957047, loss_d: 0.248166
0.4985 --- loss: 1.268536, loss_ss: 0.827020, loss_d: 0.441516
0.5368 --- loss: 1.406034, loss_ss: 0.966391, loss_d: 0.439643
0.5752 --- loss: 1.403672, loss_ss: 0.838004, loss_d: 0.565669
0.6135 --- loss: 1.504029, loss_ss: 1.021266, loss_d: 0.482763
0.6518 --- loss: 1.580937, loss_ss: 1.083611, loss_d: 0.497326
0.6902 --- loss: 1.163426, loss_ss: 0.888182, loss_d: 0.275244
0.7285 --- loss: 1.283749, loss_ss: 0.776161, loss_d: 0.507588
0.7669 --- loss: 1.466984, loss_ss: 1.134449, loss_d: 0.332535
0.8052 --- loss: 0.767778, loss_ss: 0.628607, loss_d: 0.139171
0.8436 --- loss: 1.340456, loss_ss: 0.917113, loss_d: 0.423343
0.8819 --- loss: 1.421458, loss_ss: 1.083481, loss_d: 0.337977
0.9202 --- loss: 1.473891, loss_ss: 0.979004, loss_d: 0.494887
0.9586 --- loss: 1.179074, loss_ss: 0.667215, loss_d: 0.511859
0.9969 --- loss: 1.084116, loss_ss: 0.834111, loss_d: 0.250004
Epoch finished! Loss: 1.36766015291214
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.509532, loss_ss: 0.973824, loss_d: 0.535709
0.0383 --- loss: 1.089181, loss_ss: 0.853331, loss_d: 0.235850
0.0767 --- loss: 1.644920, loss_ss: 1.163177, loss_d: 0.481743
0.1150 --- loss: 0.934606, loss_ss: 0.701499, loss_d: 0.233108
0.1534 --- loss: 1.436230, loss_ss: 1.036122, loss_d: 0.400109
0.1917 --- loss: 1.455011, loss_ss: 1.017342, loss_d: 0.437669
0.2301 --- loss: 1.152220, loss_ss: 0.887213, loss_d: 0.265007
0.2684 --- loss: 1.329628, loss_ss: 1.158797, loss_d: 0.170830
0.3067 --- loss: 1.620055, loss_ss: 0.726789, loss_d: 0.893266
0.3451 --- loss: 1.262166, loss_ss: 0.935364, loss_d: 0.326801
0.3834 --- loss: 0.909149, loss_ss: 0.716746, loss_d: 0.192402
0.4218 --- loss: 1.706833, loss_ss: 1.179926, loss_d: 0.526908
0.4601 --- loss: 0.888522, loss_ss: 0.669415, loss_d: 0.219107
0.4985 --- loss: 1.176394, loss_ss: 0.880727, loss_d: 0.295667
0.5368 --- loss: 1.317018, loss_ss: 0.766796, loss_d: 0.550222
0.5752 --- loss: 1.913416, loss_ss: 0.946175, loss_d: 0.967241
0.6135 --- loss: 0.895242, loss_ss: 0.742425, loss_d: 0.152817
0.6518 --- loss: 1.783743, loss_ss: 1.480023, loss_d: 0.303720
0.6902 --- loss: 1.358793, loss_ss: 0.969235, loss_d: 0.389558
0.7285 --- loss: 0.909586, loss_ss: 0.679081, loss_d: 0.230504
0.7669 --- loss: 0.947922, loss_ss: 0.784832, loss_d: 0.163090
0.8052 --- loss: 1.207082, loss_ss: 1.036456, loss_d: 0.170625
0.8436 --- loss: 1.018639, loss_ss: 0.872881, loss_d: 0.145758
0.8819 --- loss: 1.265943, loss_ss: 0.924841, loss_d: 0.341102
0.9202 --- loss: 1.440851, loss_ss: 1.121105, loss_d: 0.319746
0.9586 --- loss: 1.589057, loss_ss: 1.070029, loss_d: 0.519029
0.9969 --- loss: 1.447327, loss_ss: 0.888547, loss_d: 0.558780
Epoch finished! Loss: 1.289113383109753
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.911718, loss_ss: 0.818133, loss_d: 1.093586
0.0383 --- loss: 1.345637, loss_ss: 1.145610, loss_d: 0.200027
0.0767 --- loss: 1.728199, loss_ss: 1.096672, loss_d: 0.631527
0.1150 --- loss: 1.568674, loss_ss: 0.883789, loss_d: 0.684885
0.1534 --- loss: 1.318475, loss_ss: 0.833417, loss_d: 0.485058
0.1917 --- loss: 1.103410, loss_ss: 0.828307, loss_d: 0.275103
0.2301 --- loss: 0.980754, loss_ss: 0.804712, loss_d: 0.176042
0.2684 --- loss: 1.639736, loss_ss: 1.308776, loss_d: 0.330959
0.3067 --- loss: 1.318854, loss_ss: 0.946176, loss_d: 0.372678
0.3451 --- loss: 1.074399, loss_ss: 0.922337, loss_d: 0.152062
0.3834 --- loss: 1.015417, loss_ss: 0.785325, loss_d: 0.230092
0.4218 --- loss: 1.661386, loss_ss: 0.852367, loss_d: 0.809019
0.4601 --- loss: 1.335941, loss_ss: 1.023555, loss_d: 0.312386
0.4985 --- loss: 1.359630, loss_ss: 1.058291, loss_d: 0.301338
0.5368 --- loss: 0.936144, loss_ss: 0.715177, loss_d: 0.220967
0.5752 --- loss: 1.489449, loss_ss: 1.360458, loss_d: 0.128991
0.6135 --- loss: 1.021783, loss_ss: 0.652464, loss_d: 0.369319
0.6518 --- loss: 1.692660, loss_ss: 1.031929, loss_d: 0.660731
0.6902 --- loss: 1.200368, loss_ss: 0.897429, loss_d: 0.302939
0.7285 --- loss: 1.110246, loss_ss: 0.968471, loss_d: 0.141774
0.7669 --- loss: 1.138288, loss_ss: 0.947368, loss_d: 0.190921
0.8052 --- loss: 1.315858, loss_ss: 0.968393, loss_d: 0.347466
0.8436 --- loss: 1.083095, loss_ss: 0.872972, loss_d: 0.210123
0.8819 --- loss: 0.863106, loss_ss: 0.627058, loss_d: 0.236049
0.9202 --- loss: 1.323717, loss_ss: 0.811417, loss_d: 0.512301
0.9586 --- loss: 1.496605, loss_ss: 0.918653, loss_d: 0.577951
0.9969 --- loss: 1.276523, loss_ss: 1.166258, loss_d: 0.110265
Epoch finished! Loss: 1.2459787907508704
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.909482, loss_ss: 0.637300, loss_d: 0.272182
0.0383 --- loss: 0.867261, loss_ss: 0.748276, loss_d: 0.118985
0.0767 --- loss: 1.093557, loss_ss: 0.823224, loss_d: 0.270333
0.1150 --- loss: 1.090754, loss_ss: 0.918021, loss_d: 0.172733
0.1534 --- loss: 1.285792, loss_ss: 1.115322, loss_d: 0.170470
0.1917 --- loss: 0.967939, loss_ss: 0.803873, loss_d: 0.164066
0.2301 --- loss: 1.369145, loss_ss: 1.171263, loss_d: 0.197882
0.2684 --- loss: 0.985270, loss_ss: 0.774472, loss_d: 0.210798
0.3067 --- loss: 1.773802, loss_ss: 0.726705, loss_d: 1.047097
0.3451 --- loss: 1.445680, loss_ss: 0.935813, loss_d: 0.509867
0.3834 --- loss: 1.775122, loss_ss: 1.131075, loss_d: 0.644047
0.4218 --- loss: 1.697493, loss_ss: 0.732700, loss_d: 0.964793
0.4601 --- loss: 1.321587, loss_ss: 0.987941, loss_d: 0.333647
0.4985 --- loss: 1.214995, loss_ss: 0.894189, loss_d: 0.320806
0.5368 --- loss: 1.276086, loss_ss: 0.995533, loss_d: 0.280553
0.5752 --- loss: 1.835649, loss_ss: 0.701912, loss_d: 1.133738
0.6135 --- loss: 1.187133, loss_ss: 0.982058, loss_d: 0.205075
0.6518 --- loss: 0.996616, loss_ss: 0.788610, loss_d: 0.208006
0.6902 --- loss: 1.303821, loss_ss: 0.824417, loss_d: 0.479404
0.7285 --- loss: 1.064522, loss_ss: 0.864699, loss_d: 0.199823
0.7669 --- loss: 0.951009, loss_ss: 0.733405, loss_d: 0.217604
0.8052 --- loss: 1.229413, loss_ss: 0.890999, loss_d: 0.338414
0.8436 --- loss: 1.227196, loss_ss: 1.007992, loss_d: 0.219204
0.8819 --- loss: 0.844499, loss_ss: 0.720109, loss_d: 0.124390
0.9202 --- loss: 0.908020, loss_ss: 0.678207, loss_d: 0.229813
0.9586 --- loss: 1.151754, loss_ss: 0.758814, loss_d: 0.392940
0.9969 --- loss: 1.658263, loss_ss: 1.349034, loss_d: 0.309229
Epoch finished! Loss: 1.20006318963491
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.058568, loss_ss: 0.851047, loss_d: 0.207521
0.0383 --- loss: 1.002145, loss_ss: 0.888948, loss_d: 0.113197
0.0767 --- loss: 0.921601, loss_ss: 0.754758, loss_d: 0.166843
0.1150 --- loss: 1.839508, loss_ss: 0.801379, loss_d: 1.038129
0.1534 --- loss: 1.371792, loss_ss: 1.126767, loss_d: 0.245025
0.1917 --- loss: 1.296842, loss_ss: 0.997126, loss_d: 0.299717
0.2301 --- loss: 0.949625, loss_ss: 0.720469, loss_d: 0.229156
0.2684 --- loss: 1.053688, loss_ss: 0.840915, loss_d: 0.212772
0.3067 --- loss: 0.918736, loss_ss: 0.706822, loss_d: 0.211914
0.3451 --- loss: 1.285801, loss_ss: 0.892725, loss_d: 0.393076
0.3834 --- loss: 1.368601, loss_ss: 0.857358, loss_d: 0.511243
0.4218 --- loss: 1.107473, loss_ss: 0.917430, loss_d: 0.190043
0.4601 --- loss: 1.526293, loss_ss: 0.962108, loss_d: 0.564185
0.4985 --- loss: 1.088881, loss_ss: 0.940115, loss_d: 0.148766
0.5368 --- loss: 1.350096, loss_ss: 0.736233, loss_d: 0.613862
0.5752 --- loss: 0.904467, loss_ss: 0.797591, loss_d: 0.106876
0.6135 --- loss: 1.294783, loss_ss: 1.189849, loss_d: 0.104933
0.6518 --- loss: 1.193789, loss_ss: 0.963799, loss_d: 0.229990
0.6902 --- loss: 1.082617, loss_ss: 0.641794, loss_d: 0.440823
0.7285 --- loss: 1.014877, loss_ss: 0.845283, loss_d: 0.169594
0.7669 --- loss: 1.140110, loss_ss: 0.912046, loss_d: 0.228063
0.8052 --- loss: 1.111294, loss_ss: 0.828275, loss_d: 0.283019
0.8436 --- loss: 1.149075, loss_ss: 0.755339, loss_d: 0.393735
0.8819 --- loss: 1.626058, loss_ss: 0.671693, loss_d: 0.954365
0.9202 --- loss: 0.957655, loss_ss: 0.676269, loss_d: 0.281387
0.9586 --- loss: 0.973756, loss_ss: 0.594726, loss_d: 0.379030
0.9969 --- loss: 1.204235, loss_ss: 0.550097, loss_d: 0.654138
Epoch finished! Loss: 1.1549115070929894
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8266666666666667
             precision    recall  f1-score   support

        0.0       0.81      0.96      0.88       142
        1.0       0.00      0.00      0.00        23
        2.0       0.91      0.78      0.84       466
        3.0       0.73      1.00      0.84       167
        4.0       0.77      0.76      0.77       102

avg / total       0.82      0.83      0.82       900
 


====== chc052-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  95.89   95.77   95.91  81.44     88.03
1  97.22    0.00   99.77   0.00      0.00
2  84.33   77.90   91.24  90.52     83.74
3  93.11  100.00   91.54  72.93     84.34
4  94.78   76.47   97.12  77.23     76.85
Total accuracy: 82.67%
Average sen: 70.03%
Average spec: 95.12%
Macro f1-score: 66.59%
[0.13695519 0.07947227 0.13700037 0.28138667 0.02872988 0.01458081
 0.05706992 0.08941147 0.03327536 0.01118162 0.016974   0.00702845
 0.16742268 0.38670871 0.07624122 0.17647284 0.09531268 0.03910444
 0.0241916  0.05709529 0.047541   0.03001249 0.03477612 0.03522694
 0.04038416 0.24545577 0.37948182 0.4661442  0.07640472 0.09399759]
pred: 0.11216800920665264, label: 0
Right! Diagnosis: Other

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.379482, loss_ss: 1.705130, loss_d: 0.674352
0.0383 --- loss: 1.459743, loss_ss: 1.279786, loss_d: 0.179958
0.0767 --- loss: 1.718217, loss_ss: 1.384991, loss_d: 0.333227
0.1150 --- loss: 1.998333, loss_ss: 1.265416, loss_d: 0.732917
0.1534 --- loss: 2.069029, loss_ss: 1.309404, loss_d: 0.759625
0.1917 --- loss: 2.118896, loss_ss: 1.276164, loss_d: 0.842733
0.2301 --- loss: 1.875566, loss_ss: 1.431749, loss_d: 0.443818
0.2684 --- loss: 1.843586, loss_ss: 1.165220, loss_d: 0.678366
0.3067 --- loss: 1.957000, loss_ss: 1.352862, loss_d: 0.604137
0.3451 --- loss: 1.788700, loss_ss: 1.216964, loss_d: 0.571737
0.3834 --- loss: 1.701869, loss_ss: 1.198682, loss_d: 0.503188
0.4218 --- loss: 1.840038, loss_ss: 1.184653, loss_d: 0.655385
0.4601 --- loss: 1.522745, loss_ss: 1.178275, loss_d: 0.344471
0.4985 --- loss: 1.908394, loss_ss: 1.168548, loss_d: 0.739845
0.5368 --- loss: 1.843221, loss_ss: 1.225953, loss_d: 0.617268
0.5752 --- loss: 1.844760, loss_ss: 1.266019, loss_d: 0.578741
0.6135 --- loss: 1.729172, loss_ss: 1.262088, loss_d: 0.467084
0.6518 --- loss: 1.689785, loss_ss: 1.156116, loss_d: 0.533669
0.6902 --- loss: 1.811044, loss_ss: 1.160541, loss_d: 0.650503
0.7285 --- loss: 1.251956, loss_ss: 1.028128, loss_d: 0.223828
0.7669 --- loss: 2.007523, loss_ss: 1.086032, loss_d: 0.921492
0.8052 --- loss: 1.846286, loss_ss: 1.512279, loss_d: 0.334006
0.8436 --- loss: 1.594414, loss_ss: 1.127553, loss_d: 0.466861
0.8819 --- loss: 1.892949, loss_ss: 1.263239, loss_d: 0.629710
0.9202 --- loss: 1.390830, loss_ss: 1.067504, loss_d: 0.323325
0.9586 --- loss: 1.570598, loss_ss: 1.004731, loss_d: 0.565867
0.9969 --- loss: 1.661144, loss_ss: 1.321135, loss_d: 0.340009
Epoch finished! Loss: 1.8295100175417387
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.557723, loss_ss: 1.004743, loss_d: 0.552980
0.0383 --- loss: 1.572349, loss_ss: 1.090579, loss_d: 0.481770
0.0767 --- loss: 1.558154, loss_ss: 1.075436, loss_d: 0.482718
0.1150 --- loss: 1.474308, loss_ss: 0.911241, loss_d: 0.563068
0.1534 --- loss: 1.668402, loss_ss: 1.058383, loss_d: 0.610019
0.1917 --- loss: 1.874506, loss_ss: 1.231199, loss_d: 0.643307
0.2301 --- loss: 1.892789, loss_ss: 1.146865, loss_d: 0.745924
0.2684 --- loss: 1.654800, loss_ss: 1.086146, loss_d: 0.568654
0.3067 --- loss: 1.533799, loss_ss: 0.820553, loss_d: 0.713247
0.3451 --- loss: 1.842839, loss_ss: 1.373238, loss_d: 0.469601
0.3834 --- loss: 1.346122, loss_ss: 0.958633, loss_d: 0.387490
0.4218 --- loss: 1.699949, loss_ss: 1.192573, loss_d: 0.507376
0.4601 --- loss: 1.480164, loss_ss: 0.979394, loss_d: 0.500770
0.4985 --- loss: 1.355675, loss_ss: 1.024397, loss_d: 0.331279
0.5368 --- loss: 1.481174, loss_ss: 0.992296, loss_d: 0.488878
0.5752 --- loss: 1.106532, loss_ss: 0.834646, loss_d: 0.271887
0.6135 --- loss: 1.860877, loss_ss: 0.833880, loss_d: 1.026997
0.6518 --- loss: 1.598722, loss_ss: 0.983912, loss_d: 0.614810
0.6902 --- loss: 1.575271, loss_ss: 0.918591, loss_d: 0.656680
0.7285 --- loss: 1.494863, loss_ss: 0.822945, loss_d: 0.671918
0.7669 --- loss: 1.809463, loss_ss: 1.109854, loss_d: 0.699609
0.8052 --- loss: 1.300853, loss_ss: 0.958102, loss_d: 0.342751
0.8436 --- loss: 1.400643, loss_ss: 1.102399, loss_d: 0.298244
0.8819 --- loss: 1.077802, loss_ss: 0.858955, loss_d: 0.218848
0.9202 --- loss: 1.581391, loss_ss: 0.928671, loss_d: 0.652720
0.9586 --- loss: 1.599344, loss_ss: 0.895415, loss_d: 0.703929
0.9969 --- loss: 1.590180, loss_ss: 1.074807, loss_d: 0.515373
Epoch finished! Loss: 1.634296410358869
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.584998, loss_ss: 1.110722, loss_d: 0.474277
0.0383 --- loss: 1.957834, loss_ss: 1.295723, loss_d: 0.662110
0.0767 --- loss: 1.453365, loss_ss: 0.982235, loss_d: 0.471131
0.1150 --- loss: 1.176448, loss_ss: 0.773879, loss_d: 0.402569
0.1534 --- loss: 1.633095, loss_ss: 0.952231, loss_d: 0.680864
0.1917 --- loss: 2.153542, loss_ss: 1.371099, loss_d: 0.782443
0.2301 --- loss: 1.706018, loss_ss: 1.118799, loss_d: 0.587219
0.2684 --- loss: 1.786604, loss_ss: 1.092663, loss_d: 0.693941
0.3067 --- loss: 1.695276, loss_ss: 1.085484, loss_d: 0.609793
0.3451 --- loss: 1.363609, loss_ss: 0.841501, loss_d: 0.522108
0.3834 --- loss: 1.557876, loss_ss: 0.941082, loss_d: 0.616794
0.4218 --- loss: 1.310802, loss_ss: 1.023830, loss_d: 0.286972
0.4601 --- loss: 1.531644, loss_ss: 0.862101, loss_d: 0.669543
0.4985 --- loss: 1.455444, loss_ss: 0.975258, loss_d: 0.480186
0.5368 --- loss: 1.294361, loss_ss: 0.937276, loss_d: 0.357085
0.5752 --- loss: 1.527323, loss_ss: 1.098064, loss_d: 0.429259
0.6135 --- loss: 1.367939, loss_ss: 0.756327, loss_d: 0.611612
0.6518 --- loss: 1.298833, loss_ss: 0.989992, loss_d: 0.308841
0.6902 --- loss: 1.729330, loss_ss: 1.086620, loss_d: 0.642710
0.7285 --- loss: 1.642492, loss_ss: 1.044645, loss_d: 0.597846
0.7669 --- loss: 1.477461, loss_ss: 0.899761, loss_d: 0.577700
0.8052 --- loss: 1.418809, loss_ss: 0.931669, loss_d: 0.487141
0.8436 --- loss: 1.296952, loss_ss: 0.808920, loss_d: 0.488032
0.8819 --- loss: 1.643754, loss_ss: 1.169047, loss_d: 0.474707
0.9202 --- loss: 1.302377, loss_ss: 0.635732, loss_d: 0.666645
0.9586 --- loss: 1.336653, loss_ss: 0.930822, loss_d: 0.405831
0.9969 --- loss: 1.702370, loss_ss: 1.006303, loss_d: 0.696067
Epoch finished! Loss: 1.5290211278658647
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.618478, loss_ss: 0.833733, loss_d: 0.784745
0.0383 --- loss: 1.565277, loss_ss: 1.020051, loss_d: 0.545227
0.0767 --- loss: 1.680699, loss_ss: 1.353366, loss_d: 0.327333
0.1150 --- loss: 1.601162, loss_ss: 0.758559, loss_d: 0.842603
0.1534 --- loss: 1.340097, loss_ss: 0.762270, loss_d: 0.577827
0.1917 --- loss: 1.685783, loss_ss: 0.884974, loss_d: 0.800808
0.2301 --- loss: 1.769360, loss_ss: 1.441427, loss_d: 0.327933
0.2684 --- loss: 1.310779, loss_ss: 1.107890, loss_d: 0.202888
0.3067 --- loss: 1.911612, loss_ss: 1.118200, loss_d: 0.793412
0.3451 --- loss: 1.315226, loss_ss: 0.993312, loss_d: 0.321914
0.3834 --- loss: 1.260092, loss_ss: 0.819707, loss_d: 0.440385
0.4218 --- loss: 1.566414, loss_ss: 1.057334, loss_d: 0.509080
0.4601 --- loss: 1.193885, loss_ss: 0.889157, loss_d: 0.304729
0.4985 --- loss: 1.175627, loss_ss: 0.952378, loss_d: 0.223249
0.5368 --- loss: 1.538657, loss_ss: 0.822342, loss_d: 0.716316
0.5752 --- loss: 1.493180, loss_ss: 0.994473, loss_d: 0.498707
0.6135 --- loss: 1.743665, loss_ss: 1.197729, loss_d: 0.545936
0.6518 --- loss: 1.767906, loss_ss: 0.914129, loss_d: 0.853777
0.6902 --- loss: 1.048406, loss_ss: 0.770443, loss_d: 0.277963
0.7285 --- loss: 1.362488, loss_ss: 1.109895, loss_d: 0.252593
0.7669 --- loss: 1.442927, loss_ss: 0.861708, loss_d: 0.581219
0.8052 --- loss: 1.723709, loss_ss: 0.768741, loss_d: 0.954969
0.8436 --- loss: 1.744666, loss_ss: 1.032644, loss_d: 0.712023
0.8819 --- loss: 1.704622, loss_ss: 1.367298, loss_d: 0.337324
0.9202 --- loss: 1.365922, loss_ss: 1.135071, loss_d: 0.230851
0.9586 --- loss: 1.836160, loss_ss: 0.770271, loss_d: 1.065889
0.9969 --- loss: 1.816991, loss_ss: 1.092529, loss_d: 0.724463
Epoch finished! Loss: 1.4497035455245237
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.886894, loss_ss: 1.461398, loss_d: 0.425496
0.0383 --- loss: 1.805562, loss_ss: 1.227871, loss_d: 0.577690
0.0767 --- loss: 1.848653, loss_ss: 1.317724, loss_d: 0.530928
0.1150 --- loss: 1.223348, loss_ss: 0.856590, loss_d: 0.366758
0.1534 --- loss: 1.511315, loss_ss: 1.064631, loss_d: 0.446684
0.1917 --- loss: 1.170392, loss_ss: 0.818152, loss_d: 0.352240
0.2301 --- loss: 1.441162, loss_ss: 1.194403, loss_d: 0.246760
0.2684 --- loss: 1.578457, loss_ss: 1.094697, loss_d: 0.483760
0.3067 --- loss: 1.168818, loss_ss: 0.859051, loss_d: 0.309767
0.3451 --- loss: 1.435340, loss_ss: 0.879761, loss_d: 0.555579
0.3834 --- loss: 1.285734, loss_ss: 0.895664, loss_d: 0.390070
0.4218 --- loss: 0.996225, loss_ss: 0.591934, loss_d: 0.404290
0.4601 --- loss: 1.632157, loss_ss: 0.873280, loss_d: 0.758877
0.4985 --- loss: 1.472277, loss_ss: 1.008549, loss_d: 0.463728
0.5368 --- loss: 1.141130, loss_ss: 0.883852, loss_d: 0.257278
0.5752 --- loss: 1.242089, loss_ss: 0.796358, loss_d: 0.445731
0.6135 --- loss: 1.097752, loss_ss: 0.691876, loss_d: 0.405876
0.6518 --- loss: 0.688676, loss_ss: 0.522564, loss_d: 0.166112
0.6902 --- loss: 1.097443, loss_ss: 0.851603, loss_d: 0.245841
0.7285 --- loss: 1.011976, loss_ss: 0.823774, loss_d: 0.188202
0.7669 --- loss: 1.487474, loss_ss: 1.194660, loss_d: 0.292814
0.8052 --- loss: 1.530203, loss_ss: 0.956408, loss_d: 0.573795
0.8436 --- loss: 1.015558, loss_ss: 0.721612, loss_d: 0.293946
0.8819 --- loss: 0.934134, loss_ss: 0.651158, loss_d: 0.282975
0.9202 --- loss: 1.479308, loss_ss: 0.866553, loss_d: 0.612756
0.9586 --- loss: 1.149339, loss_ss: 0.871921, loss_d: 0.277418
0.9969 --- loss: 1.072083, loss_ss: 0.755417, loss_d: 0.316666
Epoch finished! Loss: 1.3685116252073874
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.176959, loss_ss: 0.832936, loss_d: 0.344024
0.0383 --- loss: 1.654930, loss_ss: 0.996970, loss_d: 0.657959
0.0767 --- loss: 1.677070, loss_ss: 0.979607, loss_d: 0.697463
0.1150 --- loss: 1.478989, loss_ss: 1.155137, loss_d: 0.323852
0.1534 --- loss: 1.118503, loss_ss: 0.883609, loss_d: 0.234894
0.1917 --- loss: 1.404489, loss_ss: 0.994519, loss_d: 0.409971
0.2301 --- loss: 1.363360, loss_ss: 1.101043, loss_d: 0.262318
0.2684 --- loss: 1.077878, loss_ss: 0.886043, loss_d: 0.191835
0.3067 --- loss: 1.180891, loss_ss: 0.887772, loss_d: 0.293119
0.3451 --- loss: 1.057823, loss_ss: 0.820891, loss_d: 0.236932
0.3834 --- loss: 1.459074, loss_ss: 1.090003, loss_d: 0.369072
0.4218 --- loss: 0.924600, loss_ss: 0.605066, loss_d: 0.319534
0.4601 --- loss: 1.399992, loss_ss: 0.718823, loss_d: 0.681169
0.4985 --- loss: 1.525009, loss_ss: 1.097589, loss_d: 0.427420
0.5368 --- loss: 1.337718, loss_ss: 0.791690, loss_d: 0.546029
0.5752 --- loss: 1.098685, loss_ss: 0.834919, loss_d: 0.263766
0.6135 --- loss: 1.218443, loss_ss: 0.959879, loss_d: 0.258564
0.6518 --- loss: 1.352087, loss_ss: 1.180674, loss_d: 0.171413
0.6902 --- loss: 1.337974, loss_ss: 0.827191, loss_d: 0.510783
0.7285 --- loss: 1.011834, loss_ss: 0.661123, loss_d: 0.350711
0.7669 --- loss: 1.055881, loss_ss: 0.811353, loss_d: 0.244529
0.8052 --- loss: 1.642460, loss_ss: 0.881739, loss_d: 0.760721
0.8436 --- loss: 1.381510, loss_ss: 0.842581, loss_d: 0.538929
0.8819 --- loss: 1.116769, loss_ss: 0.705115, loss_d: 0.411653
0.9202 --- loss: 1.415602, loss_ss: 1.182854, loss_d: 0.232749
0.9586 --- loss: 1.321433, loss_ss: 0.856021, loss_d: 0.465411
0.9969 --- loss: 1.525884, loss_ss: 1.065448, loss_d: 0.460436
Epoch finished! Loss: 1.3167992481818567
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.743551, loss_ss: 1.324737, loss_d: 0.418814
0.0383 --- loss: 1.068659, loss_ss: 0.771543, loss_d: 0.297116
0.0767 --- loss: 1.559326, loss_ss: 1.091465, loss_d: 0.467861
0.1150 --- loss: 1.389860, loss_ss: 1.109521, loss_d: 0.280339
0.1534 --- loss: 1.079602, loss_ss: 0.755300, loss_d: 0.324302
0.1917 --- loss: 1.049633, loss_ss: 0.694770, loss_d: 0.354863
0.2301 --- loss: 0.900358, loss_ss: 0.582494, loss_d: 0.317864
0.2684 --- loss: 1.049241, loss_ss: 0.805719, loss_d: 0.243522
0.3067 --- loss: 1.061157, loss_ss: 0.933399, loss_d: 0.127757
0.3451 --- loss: 1.331982, loss_ss: 1.024384, loss_d: 0.307597
0.3834 --- loss: 0.990049, loss_ss: 0.779695, loss_d: 0.210353
0.4218 --- loss: 0.945728, loss_ss: 0.745374, loss_d: 0.200354
0.4601 --- loss: 1.525492, loss_ss: 1.370013, loss_d: 0.155479
0.4985 --- loss: 1.200562, loss_ss: 0.965871, loss_d: 0.234691
0.5368 --- loss: 0.886766, loss_ss: 0.601061, loss_d: 0.285705
0.5752 --- loss: 1.446251, loss_ss: 1.204320, loss_d: 0.241931
0.6135 --- loss: 0.993836, loss_ss: 0.797649, loss_d: 0.196187
0.6518 --- loss: 1.155454, loss_ss: 0.813252, loss_d: 0.342201
0.6902 --- loss: 1.903196, loss_ss: 1.010438, loss_d: 0.892758
0.7285 --- loss: 1.480471, loss_ss: 1.166054, loss_d: 0.314418
0.7669 --- loss: 1.215344, loss_ss: 0.923110, loss_d: 0.292234
0.8052 --- loss: 1.223444, loss_ss: 1.031532, loss_d: 0.191912
0.8436 --- loss: 1.077870, loss_ss: 0.963375, loss_d: 0.114495
0.8819 --- loss: 1.474335, loss_ss: 0.827461, loss_d: 0.646874
0.9202 --- loss: 1.174559, loss_ss: 0.845415, loss_d: 0.329145
0.9586 --- loss: 1.180702, loss_ss: 0.928880, loss_d: 0.251822
0.9969 --- loss: 1.374227, loss_ss: 0.895721, loss_d: 0.478506
Epoch finished! Loss: 1.2616185976908758
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.939082, loss_ss: 0.770119, loss_d: 0.168963
0.0383 --- loss: 1.190917, loss_ss: 0.918890, loss_d: 0.272027
0.0767 --- loss: 1.169000, loss_ss: 0.983220, loss_d: 0.185779
0.1150 --- loss: 1.226580, loss_ss: 0.961625, loss_d: 0.264955
0.1534 --- loss: 0.880444, loss_ss: 0.755902, loss_d: 0.124541
0.1917 --- loss: 0.799170, loss_ss: 0.641879, loss_d: 0.157291
0.2301 --- loss: 1.284078, loss_ss: 0.903202, loss_d: 0.380877
0.2684 --- loss: 1.118804, loss_ss: 0.870002, loss_d: 0.248802
0.3067 --- loss: 1.050493, loss_ss: 0.799212, loss_d: 0.251281
0.3451 --- loss: 0.782703, loss_ss: 0.619802, loss_d: 0.162901
0.3834 --- loss: 1.285643, loss_ss: 0.899335, loss_d: 0.386307
0.4218 --- loss: 1.061327, loss_ss: 0.753733, loss_d: 0.307594
0.4601 --- loss: 1.309892, loss_ss: 0.866570, loss_d: 0.443322
0.4985 --- loss: 1.055159, loss_ss: 0.875010, loss_d: 0.180149
0.5368 --- loss: 1.380775, loss_ss: 0.972889, loss_d: 0.407885
0.5752 --- loss: 1.167750, loss_ss: 0.917297, loss_d: 0.250453
0.6135 --- loss: 1.028676, loss_ss: 0.658929, loss_d: 0.369747
0.6518 --- loss: 1.161731, loss_ss: 0.909196, loss_d: 0.252535
0.6902 --- loss: 1.045288, loss_ss: 0.907005, loss_d: 0.138283
0.7285 --- loss: 0.977628, loss_ss: 0.712947, loss_d: 0.264680
0.7669 --- loss: 0.721495, loss_ss: 0.649510, loss_d: 0.071985
0.8052 --- loss: 1.131713, loss_ss: 0.678110, loss_d: 0.453602
0.8436 --- loss: 0.943807, loss_ss: 0.726613, loss_d: 0.217194
0.8819 --- loss: 1.432668, loss_ss: 1.003470, loss_d: 0.429199
0.9202 --- loss: 0.955477, loss_ss: 0.689984, loss_d: 0.265493
0.9586 --- loss: 0.929895, loss_ss: 0.739930, loss_d: 0.189965
0.9969 --- loss: 1.182018, loss_ss: 0.812716, loss_d: 0.369302
Epoch finished! Loss: 1.2194810314820363
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.092040, loss_ss: 0.812045, loss_d: 0.279995
0.0383 --- loss: 0.894928, loss_ss: 0.641180, loss_d: 0.253748
0.0767 --- loss: 1.221994, loss_ss: 1.054034, loss_d: 0.167959
0.1150 --- loss: 0.759501, loss_ss: 0.534645, loss_d: 0.224855
0.1534 --- loss: 1.211737, loss_ss: 0.958796, loss_d: 0.252941
0.1917 --- loss: 1.177606, loss_ss: 0.961526, loss_d: 0.216080
0.2301 --- loss: 0.913649, loss_ss: 0.743343, loss_d: 0.170306
0.2684 --- loss: 1.069183, loss_ss: 0.895877, loss_d: 0.173305
0.3067 --- loss: 1.002471, loss_ss: 0.814954, loss_d: 0.187516
0.3451 --- loss: 1.194746, loss_ss: 0.971209, loss_d: 0.223536
0.3834 --- loss: 1.939602, loss_ss: 1.352627, loss_d: 0.586975
0.4218 --- loss: 1.583580, loss_ss: 0.918286, loss_d: 0.665294
0.4601 --- loss: 2.020002, loss_ss: 1.502049, loss_d: 0.517953
0.4985 --- loss: 1.390175, loss_ss: 0.740765, loss_d: 0.649411
0.5368 --- loss: 0.883824, loss_ss: 0.688563, loss_d: 0.195261
0.5752 --- loss: 0.886976, loss_ss: 0.707229, loss_d: 0.179747
0.6135 --- loss: 1.010519, loss_ss: 0.893299, loss_d: 0.117220
0.6518 --- loss: 1.691339, loss_ss: 1.047083, loss_d: 0.644256
0.6902 --- loss: 1.082560, loss_ss: 0.917796, loss_d: 0.164763
0.7285 --- loss: 1.096893, loss_ss: 0.672587, loss_d: 0.424306
0.7669 --- loss: 1.178494, loss_ss: 0.722068, loss_d: 0.456425
0.8052 --- loss: 1.348885, loss_ss: 1.050529, loss_d: 0.298355
0.8436 --- loss: 1.137680, loss_ss: 0.947821, loss_d: 0.189859
0.8819 --- loss: 1.237148, loss_ss: 1.116566, loss_d: 0.120582
0.9202 --- loss: 1.036092, loss_ss: 0.644556, loss_d: 0.391536
0.9586 --- loss: 1.417327, loss_ss: 0.820937, loss_d: 0.596390
0.9969 --- loss: 1.507774, loss_ss: 1.271682, loss_d: 0.236091
Epoch finished! Loss: 1.2078924866823049
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.917545, loss_ss: 0.729265, loss_d: 0.188280
0.0383 --- loss: 1.234988, loss_ss: 0.807105, loss_d: 0.427883
0.0767 --- loss: 1.214031, loss_ss: 0.797066, loss_d: 0.416965
0.1150 --- loss: 1.489166, loss_ss: 1.099148, loss_d: 0.390018
0.1534 --- loss: 1.086722, loss_ss: 0.860411, loss_d: 0.226311
0.1917 --- loss: 1.199239, loss_ss: 0.882021, loss_d: 0.317218
0.2301 --- loss: 1.160373, loss_ss: 0.962892, loss_d: 0.197481
0.2684 --- loss: 1.084113, loss_ss: 0.868441, loss_d: 0.215672
0.3067 --- loss: 1.035374, loss_ss: 0.648966, loss_d: 0.386408
0.3451 --- loss: 1.248109, loss_ss: 0.854565, loss_d: 0.393544
0.3834 --- loss: 1.111552, loss_ss: 0.865050, loss_d: 0.246502
0.4218 --- loss: 1.178882, loss_ss: 1.019328, loss_d: 0.159554
0.4601 --- loss: 1.218489, loss_ss: 1.081529, loss_d: 0.136960
0.4985 --- loss: 1.487634, loss_ss: 0.958650, loss_d: 0.528983
0.5368 --- loss: 0.993245, loss_ss: 0.690680, loss_d: 0.302565
0.5752 --- loss: 1.204427, loss_ss: 1.054061, loss_d: 0.150366
0.6135 --- loss: 1.072417, loss_ss: 0.808073, loss_d: 0.264344
0.6518 --- loss: 1.701723, loss_ss: 1.162639, loss_d: 0.539083
0.6902 --- loss: 1.006850, loss_ss: 0.797543, loss_d: 0.209308
0.7285 --- loss: 1.129757, loss_ss: 0.706304, loss_d: 0.423453
0.7669 --- loss: 0.857572, loss_ss: 0.709752, loss_d: 0.147820
0.8052 --- loss: 1.274880, loss_ss: 0.803978, loss_d: 0.470902
0.8436 --- loss: 1.442073, loss_ss: 0.557660, loss_d: 0.884413
0.8819 --- loss: 1.075609, loss_ss: 0.681922, loss_d: 0.393687
0.9202 --- loss: 1.115663, loss_ss: 0.615673, loss_d: 0.499989
0.9586 --- loss: 1.072985, loss_ss: 0.961356, loss_d: 0.111628
0.9969 --- loss: 1.477606, loss_ss: 0.912931, loss_d: 0.564675
Epoch finished! Loss: 1.179444149365792
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7855555555555556
             precision    recall  f1-score   support

        0.0       0.71      0.93      0.80       175
        1.0       0.62      0.06      0.11        86
        2.0       0.78      0.90      0.84       396
        3.0       0.96      0.67      0.79       153
        4.0       0.80      0.89      0.84        90

avg / total       0.79      0.79      0.75       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.11  92.57   90.76  70.74     80.20
1  90.67   5.81   99.63  62.50     10.64
2  84.67  90.15   80.36  78.29     83.80
3  94.00  67.32   99.46  96.26     79.23
4  96.67  88.89   97.53  80.00     84.21
Total accuracy: 78.56%
Average sen: 68.95%
Average spec: 93.55%
Macro f1-score: 67.62%
[0.78227842 0.99382979 0.56643969 0.58582866 0.62654436 0.89719057
 0.78479457 0.48085886 0.43968183 0.30367243 0.77322859 0.5071851
 0.41200387 0.38378471 0.44066128 0.8409     0.44410557 0.9808529
 0.27891147 0.79582655 0.38506085 0.27526414 0.58690983 0.73819768
 0.41155696 0.31112376 0.26141524 0.26884666 0.72761065 0.22566606]
pred: 0.550341035425663, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.403312, loss_ss: 1.704071, loss_d: 0.699241
0.0385 --- loss: 1.822930, loss_ss: 1.516911, loss_d: 0.306019
0.0769 --- loss: 2.210275, loss_ss: 1.503378, loss_d: 0.706897
0.1154 --- loss: 2.054028, loss_ss: 1.612594, loss_d: 0.441434
0.1538 --- loss: 1.794066, loss_ss: 1.580875, loss_d: 0.213191
0.1923 --- loss: 2.235982, loss_ss: 1.495338, loss_d: 0.740644
0.2308 --- loss: 1.965268, loss_ss: 1.479815, loss_d: 0.485453
0.2692 --- loss: 1.967825, loss_ss: 1.281297, loss_d: 0.686529
0.3077 --- loss: 2.063983, loss_ss: 1.431111, loss_d: 0.632872
0.3462 --- loss: 1.858631, loss_ss: 1.287860, loss_d: 0.570771
0.3846 --- loss: 1.887788, loss_ss: 1.406641, loss_d: 0.481147
0.4231 --- loss: 1.883835, loss_ss: 1.368460, loss_d: 0.515376
0.4615 --- loss: 2.607455, loss_ss: 1.530788, loss_d: 1.076667
0.5000 --- loss: 1.900533, loss_ss: 1.409539, loss_d: 0.490994
0.5385 --- loss: 1.902462, loss_ss: 1.449143, loss_d: 0.453319
0.5769 --- loss: 1.955389, loss_ss: 1.407199, loss_d: 0.548190
0.6154 --- loss: 2.023004, loss_ss: 1.442660, loss_d: 0.580343
0.6538 --- loss: 1.756638, loss_ss: 1.285223, loss_d: 0.471415
0.6923 --- loss: 2.075663, loss_ss: 1.370899, loss_d: 0.704764
0.7308 --- loss: 1.928890, loss_ss: 1.245854, loss_d: 0.683035
0.7692 --- loss: 2.165905, loss_ss: 1.340690, loss_d: 0.825215
0.8077 --- loss: 1.939999, loss_ss: 1.424172, loss_d: 0.515827
0.8462 --- loss: 1.756210, loss_ss: 1.186063, loss_d: 0.570147
0.8846 --- loss: 1.950801, loss_ss: 1.411505, loss_d: 0.539296
0.9231 --- loss: 1.946186, loss_ss: 1.256586, loss_d: 0.689600
0.9615 --- loss: 1.727796, loss_ss: 1.094929, loss_d: 0.632867
Epoch finished! Loss: 1.9952161744754746
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.838651, loss_ss: 1.240001, loss_d: 0.598650
0.0385 --- loss: 1.616389, loss_ss: 1.106435, loss_d: 0.509954
0.0769 --- loss: 1.706525, loss_ss: 1.194620, loss_d: 0.511904
0.1154 --- loss: 1.772013, loss_ss: 1.269767, loss_d: 0.502246
0.1538 --- loss: 1.841556, loss_ss: 1.201485, loss_d: 0.640071
0.1923 --- loss: 1.583162, loss_ss: 1.240821, loss_d: 0.342341
0.2308 --- loss: 1.676949, loss_ss: 1.180386, loss_d: 0.496562
0.2692 --- loss: 1.865431, loss_ss: 1.340580, loss_d: 0.524851
0.3077 --- loss: 1.693563, loss_ss: 1.296786, loss_d: 0.396778
0.3462 --- loss: 1.776963, loss_ss: 1.087130, loss_d: 0.689833
0.3846 --- loss: 1.809306, loss_ss: 1.206429, loss_d: 0.602876
0.4231 --- loss: 2.207249, loss_ss: 1.530813, loss_d: 0.676436
0.4615 --- loss: 1.859018, loss_ss: 1.126338, loss_d: 0.732680
0.5000 --- loss: 1.808433, loss_ss: 1.066621, loss_d: 0.741812
0.5385 --- loss: 1.694029, loss_ss: 1.203696, loss_d: 0.490333
0.5769 --- loss: 1.481593, loss_ss: 0.991463, loss_d: 0.490129
0.6154 --- loss: 1.797976, loss_ss: 1.279121, loss_d: 0.518855
0.6538 --- loss: 1.678544, loss_ss: 1.137092, loss_d: 0.541452
0.6923 --- loss: 1.794724, loss_ss: 1.279951, loss_d: 0.514773
0.7308 --- loss: 1.760264, loss_ss: 1.281240, loss_d: 0.479024
0.7692 --- loss: 1.746294, loss_ss: 1.128953, loss_d: 0.617341
0.8077 --- loss: 1.567344, loss_ss: 1.178026, loss_d: 0.389318
0.8462 --- loss: 2.122641, loss_ss: 1.221139, loss_d: 0.901501
0.8846 --- loss: 1.915391, loss_ss: 1.242136, loss_d: 0.673255
0.9231 --- loss: 1.607491, loss_ss: 1.178233, loss_d: 0.429257
0.9615 --- loss: 1.461952, loss_ss: 1.082727, loss_d: 0.379225
Epoch finished! Loss: 1.7859325418140897
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.530951, loss_ss: 1.062095, loss_d: 0.468857
0.0385 --- loss: 1.613744, loss_ss: 1.063255, loss_d: 0.550489
0.0769 --- loss: 1.719041, loss_ss: 1.286917, loss_d: 0.432123
0.1154 --- loss: 1.907610, loss_ss: 1.352688, loss_d: 0.554922
0.1538 --- loss: 1.581273, loss_ss: 1.129000, loss_d: 0.452274
0.1923 --- loss: 2.004059, loss_ss: 1.360788, loss_d: 0.643272
0.2308 --- loss: 1.654628, loss_ss: 0.985632, loss_d: 0.668996
0.2692 --- loss: 1.658886, loss_ss: 1.253618, loss_d: 0.405267
0.3077 --- loss: 1.710172, loss_ss: 1.375028, loss_d: 0.335144
0.3462 --- loss: 1.499485, loss_ss: 1.123112, loss_d: 0.376373
0.3846 --- loss: 1.733836, loss_ss: 1.120219, loss_d: 0.613616
0.4231 --- loss: 1.956518, loss_ss: 1.414889, loss_d: 0.541629
0.4615 --- loss: 1.632663, loss_ss: 1.077929, loss_d: 0.554734
0.5000 --- loss: 1.796611, loss_ss: 1.305466, loss_d: 0.491145
0.5385 --- loss: 1.968881, loss_ss: 1.147467, loss_d: 0.821413
0.5769 --- loss: 1.530268, loss_ss: 1.033443, loss_d: 0.496825
0.6154 --- loss: 1.844172, loss_ss: 1.367161, loss_d: 0.477012
0.6538 --- loss: 1.856638, loss_ss: 1.093556, loss_d: 0.763082
0.6923 --- loss: 1.505748, loss_ss: 0.900358, loss_d: 0.605391
0.7308 --- loss: 1.704591, loss_ss: 1.213458, loss_d: 0.491132
0.7692 --- loss: 1.559542, loss_ss: 0.977779, loss_d: 0.581764
0.8077 --- loss: 1.606141, loss_ss: 0.994452, loss_d: 0.611689
0.8462 --- loss: 1.866246, loss_ss: 1.080757, loss_d: 0.785489
0.8846 --- loss: 1.765037, loss_ss: 0.846433, loss_d: 0.918603
0.9231 --- loss: 1.705426, loss_ss: 1.110104, loss_d: 0.595322
0.9615 --- loss: 1.316747, loss_ss: 0.975138, loss_d: 0.341609
Epoch finished! Loss: 1.6935150374777068
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.583632, loss_ss: 1.087445, loss_d: 0.496187
0.0385 --- loss: 1.740392, loss_ss: 1.164707, loss_d: 0.575685
0.0769 --- loss: 1.573859, loss_ss: 1.034168, loss_d: 0.539691
0.1154 --- loss: 1.381894, loss_ss: 1.039180, loss_d: 0.342714
0.1538 --- loss: 1.423011, loss_ss: 1.041773, loss_d: 0.381238
0.1923 --- loss: 1.700463, loss_ss: 1.028783, loss_d: 0.671680
0.2308 --- loss: 1.364381, loss_ss: 0.895867, loss_d: 0.468514
0.2692 --- loss: 1.719491, loss_ss: 1.146221, loss_d: 0.573269
0.3077 --- loss: 1.519081, loss_ss: 1.068994, loss_d: 0.450087
0.3462 --- loss: 1.564431, loss_ss: 1.068370, loss_d: 0.496061
0.3846 --- loss: 1.548094, loss_ss: 1.084622, loss_d: 0.463472
0.4231 --- loss: 1.654642, loss_ss: 1.281100, loss_d: 0.373542
0.4615 --- loss: 1.793150, loss_ss: 1.191537, loss_d: 0.601613
0.5000 --- loss: 1.729051, loss_ss: 1.309114, loss_d: 0.419937
0.5385 --- loss: 1.430047, loss_ss: 0.816375, loss_d: 0.613672
0.5769 --- loss: 1.538019, loss_ss: 1.058012, loss_d: 0.480007
0.6154 --- loss: 1.415530, loss_ss: 0.987595, loss_d: 0.427936
0.6538 --- loss: 1.783585, loss_ss: 0.982320, loss_d: 0.801265
0.6923 --- loss: 1.537132, loss_ss: 0.917170, loss_d: 0.619962
0.7308 --- loss: 1.188657, loss_ss: 0.772944, loss_d: 0.415713
0.7692 --- loss: 1.475880, loss_ss: 0.917708, loss_d: 0.558172
0.8077 --- loss: 1.500969, loss_ss: 1.205607, loss_d: 0.295362
0.8462 --- loss: 1.447847, loss_ss: 0.756884, loss_d: 0.690963
0.8846 --- loss: 1.549380, loss_ss: 1.191376, loss_d: 0.358004
0.9231 --- loss: 1.641233, loss_ss: 1.225208, loss_d: 0.416025
0.9615 --- loss: 1.635701, loss_ss: 0.978574, loss_d: 0.657127
Epoch finished! Loss: 1.5944001292630052
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.531014, loss_ss: 1.314104, loss_d: 0.216911
0.0385 --- loss: 1.439711, loss_ss: 1.032810, loss_d: 0.406901
0.0769 --- loss: 1.624108, loss_ss: 1.066616, loss_d: 0.557492
0.1154 --- loss: 1.629789, loss_ss: 1.141816, loss_d: 0.487973
0.1538 --- loss: 1.375170, loss_ss: 0.960223, loss_d: 0.414947
0.1923 --- loss: 1.466463, loss_ss: 1.018098, loss_d: 0.448365
0.2308 --- loss: 2.136847, loss_ss: 1.188083, loss_d: 0.948765
0.2692 --- loss: 1.308883, loss_ss: 0.914870, loss_d: 0.394013
0.3077 --- loss: 1.376664, loss_ss: 0.918097, loss_d: 0.458567
0.3462 --- loss: 2.138380, loss_ss: 0.947733, loss_d: 1.190647
0.3846 --- loss: 1.257851, loss_ss: 0.788170, loss_d: 0.469681
0.4231 --- loss: 1.814855, loss_ss: 1.171696, loss_d: 0.643159
0.4615 --- loss: 1.713053, loss_ss: 1.254883, loss_d: 0.458170
0.5000 --- loss: 1.444166, loss_ss: 0.956524, loss_d: 0.487642
0.5385 --- loss: 1.126046, loss_ss: 0.857543, loss_d: 0.268503
0.5769 --- loss: 1.517864, loss_ss: 0.975960, loss_d: 0.541904
0.6154 --- loss: 1.620707, loss_ss: 0.924488, loss_d: 0.696219
0.6538 --- loss: 1.825477, loss_ss: 1.125214, loss_d: 0.700263
0.6923 --- loss: 1.601313, loss_ss: 1.198984, loss_d: 0.402329
0.7308 --- loss: 1.472983, loss_ss: 1.148446, loss_d: 0.324537
0.7692 --- loss: 1.267992, loss_ss: 0.834477, loss_d: 0.433515
0.8077 --- loss: 1.434768, loss_ss: 1.085900, loss_d: 0.348868
0.8462 --- loss: 1.477607, loss_ss: 1.192002, loss_d: 0.285605
0.8846 --- loss: 1.411520, loss_ss: 0.966600, loss_d: 0.444920
0.9231 --- loss: 1.665309, loss_ss: 0.915608, loss_d: 0.749701
0.9615 --- loss: 1.802372, loss_ss: 1.341250, loss_d: 0.461122
Epoch finished! Loss: 1.5117239912964662
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.350062, loss_ss: 0.915266, loss_d: 0.434796
0.0385 --- loss: 1.164981, loss_ss: 0.768638, loss_d: 0.396342
0.0769 --- loss: 1.822283, loss_ss: 1.124525, loss_d: 0.697759
0.1154 --- loss: 1.247921, loss_ss: 0.958375, loss_d: 0.289546
0.1538 --- loss: 1.076086, loss_ss: 0.742587, loss_d: 0.333500
0.1923 --- loss: 1.574121, loss_ss: 1.345665, loss_d: 0.228456
0.2308 --- loss: 1.473856, loss_ss: 1.173016, loss_d: 0.300840
0.2692 --- loss: 1.189154, loss_ss: 0.869018, loss_d: 0.320136
0.3077 --- loss: 1.281585, loss_ss: 1.050237, loss_d: 0.231348
0.3462 --- loss: 1.082739, loss_ss: 0.781515, loss_d: 0.301224
0.3846 --- loss: 1.288108, loss_ss: 1.028311, loss_d: 0.259798
0.4231 --- loss: 1.114848, loss_ss: 0.740222, loss_d: 0.374626
0.4615 --- loss: 1.294864, loss_ss: 0.868648, loss_d: 0.426216
0.5000 --- loss: 0.998550, loss_ss: 0.866151, loss_d: 0.132399
0.5385 --- loss: 1.125402, loss_ss: 0.989000, loss_d: 0.136402
0.5769 --- loss: 1.198629, loss_ss: 0.968205, loss_d: 0.230423
0.6154 --- loss: 1.451396, loss_ss: 0.840349, loss_d: 0.611047
0.6538 --- loss: 1.423164, loss_ss: 0.916761, loss_d: 0.506403
0.6923 --- loss: 1.281533, loss_ss: 0.979904, loss_d: 0.301629
0.7308 --- loss: 1.123966, loss_ss: 0.908324, loss_d: 0.215642
0.7692 --- loss: 1.629905, loss_ss: 1.150561, loss_d: 0.479344
0.8077 --- loss: 1.542314, loss_ss: 0.800909, loss_d: 0.741405
0.8462 --- loss: 1.143790, loss_ss: 0.968423, loss_d: 0.175367
0.8846 --- loss: 1.198045, loss_ss: 0.881588, loss_d: 0.316457
0.9231 --- loss: 1.562464, loss_ss: 1.203005, loss_d: 0.359459
0.9615 --- loss: 0.902715, loss_ss: 0.785755, loss_d: 0.116961
Epoch finished! Loss: 1.3925890779863452
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.935783, loss_ss: 0.788630, loss_d: 0.147154
0.0385 --- loss: 1.228701, loss_ss: 0.954602, loss_d: 0.274099
0.0769 --- loss: 1.034890, loss_ss: 0.801180, loss_d: 0.233710
0.1154 --- loss: 1.579995, loss_ss: 1.049788, loss_d: 0.530207
0.1538 --- loss: 1.410442, loss_ss: 1.043720, loss_d: 0.366722
0.1923 --- loss: 1.244707, loss_ss: 0.873493, loss_d: 0.371214
0.2308 --- loss: 1.393063, loss_ss: 1.100116, loss_d: 0.292947
0.2692 --- loss: 1.021209, loss_ss: 0.880771, loss_d: 0.140438
0.3077 --- loss: 1.382353, loss_ss: 1.106789, loss_d: 0.275563
0.3462 --- loss: 1.159541, loss_ss: 0.852955, loss_d: 0.306586
0.3846 --- loss: 1.243797, loss_ss: 1.062070, loss_d: 0.181728
0.4231 --- loss: 1.266238, loss_ss: 0.927158, loss_d: 0.339080
0.4615 --- loss: 1.217489, loss_ss: 0.950259, loss_d: 0.267231
0.5000 --- loss: 1.251021, loss_ss: 1.004357, loss_d: 0.246664
0.5385 --- loss: 1.146550, loss_ss: 0.915200, loss_d: 0.231350
0.5769 --- loss: 1.070468, loss_ss: 0.784368, loss_d: 0.286100
0.6154 --- loss: 1.572291, loss_ss: 0.641342, loss_d: 0.930949
0.6538 --- loss: 1.439978, loss_ss: 1.194061, loss_d: 0.245917
0.6923 --- loss: 1.115627, loss_ss: 0.795586, loss_d: 0.320042
0.7308 --- loss: 0.891773, loss_ss: 0.650028, loss_d: 0.241745
0.7692 --- loss: 1.067253, loss_ss: 0.706335, loss_d: 0.360918
0.8077 --- loss: 1.603067, loss_ss: 1.040406, loss_d: 0.562661
0.8462 --- loss: 1.435947, loss_ss: 0.804075, loss_d: 0.631872
0.8846 --- loss: 1.045905, loss_ss: 0.818362, loss_d: 0.227543
0.9231 --- loss: 1.539116, loss_ss: 1.179269, loss_d: 0.359848
0.9615 --- loss: 1.134897, loss_ss: 0.929408, loss_d: 0.205489
Epoch finished! Loss: 1.3234747892180925
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.314929, loss_ss: 1.041006, loss_d: 0.273923
0.0385 --- loss: 1.612992, loss_ss: 1.255532, loss_d: 0.357460
0.0769 --- loss: 1.464538, loss_ss: 0.958924, loss_d: 0.505614
0.1154 --- loss: 1.073686, loss_ss: 0.804446, loss_d: 0.269239
0.1538 --- loss: 0.833770, loss_ss: 0.693361, loss_d: 0.140409
0.1923 --- loss: 1.154139, loss_ss: 0.852297, loss_d: 0.301842
0.2308 --- loss: 1.969220, loss_ss: 0.949041, loss_d: 1.020179
0.2692 --- loss: 1.503080, loss_ss: 0.966561, loss_d: 0.536518
0.3077 --- loss: 1.535829, loss_ss: 1.319375, loss_d: 0.216454
0.3462 --- loss: 1.240686, loss_ss: 0.931645, loss_d: 0.309041
0.3846 --- loss: 1.369814, loss_ss: 0.932503, loss_d: 0.437311
0.4231 --- loss: 1.140664, loss_ss: 0.918965, loss_d: 0.221699
0.4615 --- loss: 1.414188, loss_ss: 0.969084, loss_d: 0.445104
0.5000 --- loss: 1.062109, loss_ss: 0.894779, loss_d: 0.167329
0.5385 --- loss: 1.145923, loss_ss: 0.927817, loss_d: 0.218106
0.5769 --- loss: 0.999741, loss_ss: 0.840029, loss_d: 0.159711
0.6154 --- loss: 0.995780, loss_ss: 0.849438, loss_d: 0.146341
0.6538 --- loss: 1.003300, loss_ss: 0.846038, loss_d: 0.157262
0.6923 --- loss: 1.097258, loss_ss: 0.858163, loss_d: 0.239095
0.7308 --- loss: 1.152904, loss_ss: 1.027422, loss_d: 0.125482
0.7692 --- loss: 0.925843, loss_ss: 0.686210, loss_d: 0.239633
0.8077 --- loss: 1.621786, loss_ss: 1.344822, loss_d: 0.276964
0.8462 --- loss: 1.036187, loss_ss: 0.929259, loss_d: 0.106928
0.8846 --- loss: 1.066583, loss_ss: 0.935129, loss_d: 0.131454
0.9231 --- loss: 1.841372, loss_ss: 1.151662, loss_d: 0.689710
0.9615 --- loss: 1.087930, loss_ss: 0.905029, loss_d: 0.182901
Epoch finished! Loss: 1.247745972112339
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.932562, loss_ss: 0.737340, loss_d: 0.195221
0.0385 --- loss: 1.264311, loss_ss: 0.869727, loss_d: 0.394584
0.0769 --- loss: 1.037478, loss_ss: 0.810189, loss_d: 0.227289
0.1154 --- loss: 0.882863, loss_ss: 0.727760, loss_d: 0.155102
0.1538 --- loss: 1.296202, loss_ss: 0.878117, loss_d: 0.418085
0.1923 --- loss: 1.296041, loss_ss: 0.829101, loss_d: 0.466940
0.2308 --- loss: 0.996534, loss_ss: 0.783755, loss_d: 0.212779
0.2692 --- loss: 1.074670, loss_ss: 0.692183, loss_d: 0.382486
0.3077 --- loss: 1.334065, loss_ss: 0.760785, loss_d: 0.573281
0.3462 --- loss: 1.106333, loss_ss: 0.741592, loss_d: 0.364741
0.3846 --- loss: 1.061249, loss_ss: 0.690926, loss_d: 0.370323
0.4231 --- loss: 1.124708, loss_ss: 0.911598, loss_d: 0.213111
0.4615 --- loss: 1.084543, loss_ss: 0.724869, loss_d: 0.359673
0.5000 --- loss: 1.101023, loss_ss: 0.686584, loss_d: 0.414439
0.5385 --- loss: 1.413568, loss_ss: 1.010419, loss_d: 0.403149
0.5769 --- loss: 1.367604, loss_ss: 1.014881, loss_d: 0.352723
0.6154 --- loss: 0.888861, loss_ss: 0.729011, loss_d: 0.159850
0.6538 --- loss: 1.151672, loss_ss: 0.801991, loss_d: 0.349681
0.6923 --- loss: 1.406952, loss_ss: 1.217550, loss_d: 0.189402
0.7308 --- loss: 0.920798, loss_ss: 0.769924, loss_d: 0.150874
0.7692 --- loss: 1.400958, loss_ss: 1.116732, loss_d: 0.284226
0.8077 --- loss: 1.214658, loss_ss: 1.093557, loss_d: 0.121101
0.8462 --- loss: 0.922490, loss_ss: 0.845166, loss_d: 0.077324
0.8846 --- loss: 1.890254, loss_ss: 1.564545, loss_d: 0.325709
0.9231 --- loss: 1.130205, loss_ss: 0.823078, loss_d: 0.307127
0.9615 --- loss: 1.486309, loss_ss: 1.181381, loss_d: 0.304928
Epoch finished! Loss: 1.1867104483387185
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.678661, loss_ss: 1.173797, loss_d: 0.504864
0.0385 --- loss: 1.105478, loss_ss: 0.953185, loss_d: 0.152293
0.0769 --- loss: 0.811355, loss_ss: 0.699050, loss_d: 0.112305
0.1154 --- loss: 1.472762, loss_ss: 1.238471, loss_d: 0.234290
0.1538 --- loss: 1.622846, loss_ss: 1.241599, loss_d: 0.381246
0.1923 --- loss: 1.228518, loss_ss: 1.036425, loss_d: 0.192094
0.2308 --- loss: 1.374985, loss_ss: 1.142718, loss_d: 0.232267
0.2692 --- loss: 1.052769, loss_ss: 0.746488, loss_d: 0.306281
0.3077 --- loss: 0.782662, loss_ss: 0.662327, loss_d: 0.120335
0.3462 --- loss: 0.778468, loss_ss: 0.671038, loss_d: 0.107430
0.3846 --- loss: 1.282827, loss_ss: 0.586815, loss_d: 0.696012
0.4231 --- loss: 0.839048, loss_ss: 0.705565, loss_d: 0.133482
0.4615 --- loss: 1.577207, loss_ss: 1.119481, loss_d: 0.457726
0.5000 --- loss: 1.022709, loss_ss: 0.718436, loss_d: 0.304273
0.5385 --- loss: 1.597315, loss_ss: 0.714823, loss_d: 0.882492
0.5769 --- loss: 1.041191, loss_ss: 0.828912, loss_d: 0.212279
0.6154 --- loss: 1.191208, loss_ss: 0.631198, loss_d: 0.560010
0.6538 --- loss: 1.465090, loss_ss: 0.952520, loss_d: 0.512570
0.6923 --- loss: 1.274016, loss_ss: 1.028592, loss_d: 0.245424
0.7308 --- loss: 0.826523, loss_ss: 0.684767, loss_d: 0.141756
0.7692 --- loss: 1.287862, loss_ss: 0.897664, loss_d: 0.390197
0.8077 --- loss: 0.972516, loss_ss: 0.721065, loss_d: 0.251451
0.8462 --- loss: 1.344406, loss_ss: 0.734500, loss_d: 0.609906
0.8846 --- loss: 1.782318, loss_ss: 0.890904, loss_d: 0.891414
0.9231 --- loss: 1.320769, loss_ss: 0.755605, loss_d: 0.565164
0.9615 --- loss: 0.897780, loss_ss: 0.692252, loss_d: 0.205528
Epoch finished! Loss: 1.1500453992700024
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4763157894736842
             precision    recall  f1-score   support

        0.0       0.07      0.88      0.13        40
        1.0       0.00      0.00      0.00        79
        2.0       0.84      0.61      0.70       553
        3.0       0.67      0.83      0.74        69
        4.0       0.93      0.29      0.44       399

avg / total       0.78      0.48      0.55      1140
 


====== chp001-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  60.00  87.50   59.00   7.20     13.31
1  89.04   0.00   95.66   0.00      0.00
2  75.35  60.58   89.27  84.17     70.45
3  96.49  82.61   97.39  67.06     74.03
4  74.39  29.07   98.79  92.80     44.27
Total accuracy: 47.63%
Average sen: 51.95%
Average spec: 88.02%
Macro f1-score: 40.41%
[0.79844445 0.83469719 0.84599847 0.76535523 0.86926895 0.34459814
 0.90455872 0.7610265  0.7895633  0.86020994 0.72618908 0.96019685
 0.69349283 0.78844738 0.60449463 0.80313402 0.90050668 0.81870484
 0.95996666 0.68473381 0.88401675 0.7545917  0.93264318 0.94153434
 0.94144773 0.59279764 0.8871935  0.93562156 0.87246364 0.80143666
 0.93835211 0.91465467 0.92958587 0.90617567 0.85641104 0.9576112
 0.85485619 0.93249887]
pred: 0.8301968425512314, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.256206, loss_ss: 1.570050, loss_d: 0.686155
0.0384 --- loss: 1.995323, loss_ss: 1.504807, loss_d: 0.490516
0.0769 --- loss: 1.961564, loss_ss: 1.509405, loss_d: 0.452159
0.1153 --- loss: 2.015006, loss_ss: 1.577121, loss_d: 0.437885
0.1537 --- loss: 2.067440, loss_ss: 1.516012, loss_d: 0.551429
0.1922 --- loss: 1.997939, loss_ss: 1.533272, loss_d: 0.464667
0.2306 --- loss: 2.304355, loss_ss: 1.525507, loss_d: 0.778848
0.2690 --- loss: 1.919090, loss_ss: 1.398350, loss_d: 0.520739
0.3075 --- loss: 2.111894, loss_ss: 1.462140, loss_d: 0.649754
0.3459 --- loss: 2.389270, loss_ss: 1.446732, loss_d: 0.942538
0.3843 --- loss: 2.214285, loss_ss: 1.469929, loss_d: 0.744357
0.4228 --- loss: 1.953094, loss_ss: 1.363210, loss_d: 0.589884
0.4612 --- loss: 1.999996, loss_ss: 1.395413, loss_d: 0.604583
0.4996 --- loss: 1.724780, loss_ss: 1.340365, loss_d: 0.384415
0.5380 --- loss: 1.699426, loss_ss: 1.329938, loss_d: 0.369488
0.5765 --- loss: 1.860430, loss_ss: 1.340333, loss_d: 0.520097
0.6149 --- loss: 1.892353, loss_ss: 1.407556, loss_d: 0.484797
0.6533 --- loss: 2.070453, loss_ss: 1.380043, loss_d: 0.690411
0.6918 --- loss: 1.874570, loss_ss: 1.252283, loss_d: 0.622288
0.7302 --- loss: 1.851269, loss_ss: 1.283965, loss_d: 0.567304
0.7686 --- loss: 2.126965, loss_ss: 1.440211, loss_d: 0.686754
0.8071 --- loss: 1.860965, loss_ss: 1.380692, loss_d: 0.480273
0.8455 --- loss: 1.925938, loss_ss: 1.184753, loss_d: 0.741185
0.8839 --- loss: 1.638691, loss_ss: 1.176849, loss_d: 0.461843
0.9224 --- loss: 1.783943, loss_ss: 1.151544, loss_d: 0.632399
0.9608 --- loss: 1.770440, loss_ss: 1.389769, loss_d: 0.380670
0.9992 --- loss: 2.117916, loss_ss: 1.437743, loss_d: 0.680172
Epoch finished! Loss: 1.999353976891591
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.730213, loss_ss: 1.244279, loss_d: 0.485933
0.0384 --- loss: 1.834600, loss_ss: 1.300496, loss_d: 0.534104
0.0769 --- loss: 1.820763, loss_ss: 1.136774, loss_d: 0.683990
0.1153 --- loss: 1.717452, loss_ss: 1.109296, loss_d: 0.608156
0.1537 --- loss: 1.553262, loss_ss: 1.131692, loss_d: 0.421569
0.1922 --- loss: 1.607707, loss_ss: 1.132327, loss_d: 0.475380
0.2306 --- loss: 1.527643, loss_ss: 1.140056, loss_d: 0.387586
0.2690 --- loss: 1.642258, loss_ss: 1.209601, loss_d: 0.432657
0.3075 --- loss: 1.598067, loss_ss: 1.129720, loss_d: 0.468347
0.3459 --- loss: 1.865598, loss_ss: 1.174199, loss_d: 0.691399
0.3843 --- loss: 1.355565, loss_ss: 0.968581, loss_d: 0.386983
0.4228 --- loss: 1.530238, loss_ss: 0.898267, loss_d: 0.631971
0.4612 --- loss: 2.061421, loss_ss: 1.154140, loss_d: 0.907282
0.4996 --- loss: 1.737810, loss_ss: 1.290572, loss_d: 0.447237
0.5380 --- loss: 1.554721, loss_ss: 1.115590, loss_d: 0.439132
0.5765 --- loss: 1.781193, loss_ss: 1.203369, loss_d: 0.577824
0.6149 --- loss: 1.629217, loss_ss: 1.099112, loss_d: 0.530105
0.6533 --- loss: 1.633113, loss_ss: 1.131811, loss_d: 0.501301
0.6918 --- loss: 1.614295, loss_ss: 0.938523, loss_d: 0.675772
0.7302 --- loss: 1.741091, loss_ss: 1.044808, loss_d: 0.696283
0.7686 --- loss: 1.516860, loss_ss: 1.034374, loss_d: 0.482486
0.8071 --- loss: 1.667432, loss_ss: 1.134857, loss_d: 0.532574
0.8455 --- loss: 1.678921, loss_ss: 0.980203, loss_d: 0.698718
0.8839 --- loss: 1.618487, loss_ss: 0.963457, loss_d: 0.655031
0.9224 --- loss: 1.556712, loss_ss: 0.978746, loss_d: 0.577966
0.9608 --- loss: 1.755193, loss_ss: 1.039973, loss_d: 0.715220
0.9992 --- loss: 2.097577, loss_ss: 1.747972, loss_d: 0.349605
Epoch finished! Loss: 1.707621674812757
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.580886, loss_ss: 0.971804, loss_d: 0.609082
0.0384 --- loss: 1.448603, loss_ss: 1.015895, loss_d: 0.432708
0.0769 --- loss: 1.536634, loss_ss: 1.108272, loss_d: 0.428362
0.1153 --- loss: 1.514181, loss_ss: 1.100173, loss_d: 0.414008
0.1537 --- loss: 1.917656, loss_ss: 0.992089, loss_d: 0.925567
0.1922 --- loss: 1.783018, loss_ss: 1.155343, loss_d: 0.627675
0.2306 --- loss: 1.486481, loss_ss: 1.080775, loss_d: 0.405705
0.2690 --- loss: 1.737645, loss_ss: 1.013250, loss_d: 0.724394
0.3075 --- loss: 2.213313, loss_ss: 1.378320, loss_d: 0.834993
0.3459 --- loss: 1.559823, loss_ss: 1.057899, loss_d: 0.501924
0.3843 --- loss: 1.405515, loss_ss: 0.879960, loss_d: 0.525555
0.4228 --- loss: 1.453083, loss_ss: 0.842833, loss_d: 0.610250
0.4612 --- loss: 1.951853, loss_ss: 1.088490, loss_d: 0.863363
0.4996 --- loss: 1.383875, loss_ss: 0.954753, loss_d: 0.429121
0.5380 --- loss: 1.230535, loss_ss: 0.807788, loss_d: 0.422746
0.5765 --- loss: 1.201704, loss_ss: 0.713818, loss_d: 0.487886
0.6149 --- loss: 2.023144, loss_ss: 1.264364, loss_d: 0.758780
0.6533 --- loss: 1.578242, loss_ss: 0.786589, loss_d: 0.791652
0.6918 --- loss: 1.681916, loss_ss: 1.143927, loss_d: 0.537989
0.7302 --- loss: 1.714753, loss_ss: 1.084532, loss_d: 0.630221
0.7686 --- loss: 1.677106, loss_ss: 0.948324, loss_d: 0.728782
0.8071 --- loss: 1.588621, loss_ss: 1.175089, loss_d: 0.413533
0.8455 --- loss: 1.463752, loss_ss: 1.040286, loss_d: 0.423466
0.8839 --- loss: 1.824429, loss_ss: 1.078796, loss_d: 0.745633
0.9224 --- loss: 1.658863, loss_ss: 0.973076, loss_d: 0.685787
0.9608 --- loss: 1.511008, loss_ss: 0.931743, loss_d: 0.579264
0.9992 --- loss: 1.408859, loss_ss: 0.911449, loss_d: 0.497410
Epoch finished! Loss: 1.5866794256063608
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.672568, loss_ss: 0.990710, loss_d: 0.681858
0.0384 --- loss: 1.708846, loss_ss: 0.951164, loss_d: 0.757682
0.0769 --- loss: 1.261022, loss_ss: 0.814330, loss_d: 0.446693
0.1153 --- loss: 1.391803, loss_ss: 0.875330, loss_d: 0.516473
0.1537 --- loss: 1.566161, loss_ss: 1.001462, loss_d: 0.564698
0.1922 --- loss: 1.928567, loss_ss: 1.405062, loss_d: 0.523505
0.2306 --- loss: 1.506824, loss_ss: 0.958629, loss_d: 0.548195
0.2690 --- loss: 1.306874, loss_ss: 0.943022, loss_d: 0.363851
0.3075 --- loss: 1.037301, loss_ss: 0.673398, loss_d: 0.363904
0.3459 --- loss: 1.639084, loss_ss: 1.061602, loss_d: 0.577482
0.3843 --- loss: 1.399786, loss_ss: 0.946639, loss_d: 0.453148
0.4228 --- loss: 1.441033, loss_ss: 0.815468, loss_d: 0.625565
0.4612 --- loss: 1.456863, loss_ss: 0.677862, loss_d: 0.779001
0.4996 --- loss: 1.672164, loss_ss: 1.377228, loss_d: 0.294936
0.5380 --- loss: 1.654561, loss_ss: 0.794146, loss_d: 0.860415
0.5765 --- loss: 1.651863, loss_ss: 1.150227, loss_d: 0.501636
0.6149 --- loss: 1.112118, loss_ss: 0.645653, loss_d: 0.466465
0.6533 --- loss: 1.184956, loss_ss: 0.793886, loss_d: 0.391070
0.6918 --- loss: 1.450583, loss_ss: 0.794591, loss_d: 0.655991
0.7302 --- loss: 1.273091, loss_ss: 0.740541, loss_d: 0.532550
0.7686 --- loss: 1.443401, loss_ss: 0.975104, loss_d: 0.468297
0.8071 --- loss: 1.655884, loss_ss: 1.118482, loss_d: 0.537401
0.8455 --- loss: 1.633195, loss_ss: 0.984583, loss_d: 0.648612
0.8839 --- loss: 1.473027, loss_ss: 0.891977, loss_d: 0.581050
0.9224 --- loss: 1.492211, loss_ss: 0.890928, loss_d: 0.601283
0.9608 --- loss: 1.802853, loss_ss: 0.880539, loss_d: 0.922314
0.9992 --- loss: 1.822140, loss_ss: 1.648416, loss_d: 0.173724
Epoch finished! Loss: 1.5074082993544065
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.519124, loss_ss: 0.682760, loss_d: 0.836364
0.0384 --- loss: 1.574839, loss_ss: 0.759634, loss_d: 0.815204
0.0769 --- loss: 1.308674, loss_ss: 1.000325, loss_d: 0.308350
0.1153 --- loss: 1.580519, loss_ss: 1.142396, loss_d: 0.438123
0.1537 --- loss: 1.618003, loss_ss: 0.862827, loss_d: 0.755176
0.1922 --- loss: 1.627645, loss_ss: 1.082291, loss_d: 0.545355
0.2306 --- loss: 1.816333, loss_ss: 1.114652, loss_d: 0.701682
0.2690 --- loss: 1.516524, loss_ss: 1.131960, loss_d: 0.384564
0.3075 --- loss: 1.442521, loss_ss: 0.789889, loss_d: 0.652633
0.3459 --- loss: 1.435528, loss_ss: 1.102458, loss_d: 0.333070
0.3843 --- loss: 1.135849, loss_ss: 0.777722, loss_d: 0.358127
0.4228 --- loss: 1.455670, loss_ss: 0.890461, loss_d: 0.565209
0.4612 --- loss: 1.214471, loss_ss: 0.964689, loss_d: 0.249783
0.4996 --- loss: 1.328503, loss_ss: 0.779074, loss_d: 0.549430
0.5380 --- loss: 1.586645, loss_ss: 1.089093, loss_d: 0.497552
0.5765 --- loss: 1.302842, loss_ss: 0.871548, loss_d: 0.431294
0.6149 --- loss: 1.319223, loss_ss: 0.986595, loss_d: 0.332628
0.6533 --- loss: 1.514089, loss_ss: 0.902239, loss_d: 0.611850
0.6918 --- loss: 1.612725, loss_ss: 1.292939, loss_d: 0.319786
0.7302 --- loss: 1.387385, loss_ss: 0.986364, loss_d: 0.401020
0.7686 --- loss: 1.322751, loss_ss: 0.774333, loss_d: 0.548418
0.8071 --- loss: 1.633383, loss_ss: 1.184301, loss_d: 0.449081
0.8455 --- loss: 1.180151, loss_ss: 0.839339, loss_d: 0.340812
0.8839 --- loss: 1.140991, loss_ss: 0.681577, loss_d: 0.459415
0.9224 --- loss: 1.268373, loss_ss: 0.745903, loss_d: 0.522469
0.9608 --- loss: 1.040183, loss_ss: 0.688896, loss_d: 0.351288
0.9992 --- loss: 2.772257, loss_ss: 2.422592, loss_d: 0.349665
Epoch finished! Loss: 1.431406518816948
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.355189, loss_ss: 0.806376, loss_d: 0.548813
0.0384 --- loss: 1.552617, loss_ss: 1.103021, loss_d: 0.449596
0.0769 --- loss: 1.571516, loss_ss: 0.963077, loss_d: 0.608438
0.1153 --- loss: 1.285607, loss_ss: 0.924173, loss_d: 0.361434
0.1537 --- loss: 1.199573, loss_ss: 0.699619, loss_d: 0.499955
0.1922 --- loss: 1.460631, loss_ss: 1.074418, loss_d: 0.386213
0.2306 --- loss: 1.341492, loss_ss: 1.040416, loss_d: 0.301076
0.2690 --- loss: 1.385827, loss_ss: 0.718484, loss_d: 0.667344
0.3075 --- loss: 0.960413, loss_ss: 0.643106, loss_d: 0.317307
0.3459 --- loss: 1.519075, loss_ss: 0.911355, loss_d: 0.607720
0.3843 --- loss: 1.170299, loss_ss: 0.882884, loss_d: 0.287415
0.4228 --- loss: 1.147068, loss_ss: 0.890082, loss_d: 0.256986
0.4612 --- loss: 1.283676, loss_ss: 0.769745, loss_d: 0.513930
0.4996 --- loss: 1.327366, loss_ss: 0.872762, loss_d: 0.454604
0.5380 --- loss: 1.132096, loss_ss: 0.774366, loss_d: 0.357730
0.5765 --- loss: 1.355225, loss_ss: 0.800804, loss_d: 0.554421
0.6149 --- loss: 1.264670, loss_ss: 1.032450, loss_d: 0.232220
0.6533 --- loss: 1.145833, loss_ss: 0.866902, loss_d: 0.278931
0.6918 --- loss: 1.295581, loss_ss: 0.848331, loss_d: 0.447250
0.7302 --- loss: 1.044647, loss_ss: 0.859554, loss_d: 0.185093
0.7686 --- loss: 1.150741, loss_ss: 0.853220, loss_d: 0.297522
0.8071 --- loss: 1.100111, loss_ss: 0.716753, loss_d: 0.383358
0.8455 --- loss: 1.585643, loss_ss: 0.951077, loss_d: 0.634565
0.8839 --- loss: 1.108672, loss_ss: 0.627906, loss_d: 0.480766
0.9224 --- loss: 1.535812, loss_ss: 1.125779, loss_d: 0.410034
0.9608 --- loss: 1.389647, loss_ss: 1.062835, loss_d: 0.326812
0.9992 --- loss: 1.315770, loss_ss: 1.055317, loss_d: 0.260453
Epoch finished! Loss: 1.34197539801781
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.094131, loss_ss: 0.878510, loss_d: 0.215621
0.0384 --- loss: 1.718364, loss_ss: 1.051056, loss_d: 0.667309
0.0769 --- loss: 1.320694, loss_ss: 0.895296, loss_d: 0.425397
0.1153 --- loss: 1.325708, loss_ss: 0.842508, loss_d: 0.483201
0.1537 --- loss: 1.235956, loss_ss: 1.001549, loss_d: 0.234407
0.1922 --- loss: 1.021637, loss_ss: 0.756815, loss_d: 0.264821
0.2306 --- loss: 1.317121, loss_ss: 0.761802, loss_d: 0.555319
0.2690 --- loss: 1.248518, loss_ss: 1.048391, loss_d: 0.200127
0.3075 --- loss: 1.490401, loss_ss: 1.053380, loss_d: 0.437021
0.3459 --- loss: 1.335771, loss_ss: 1.135973, loss_d: 0.199797
0.3843 --- loss: 1.378252, loss_ss: 0.827724, loss_d: 0.550528
0.4228 --- loss: 1.258104, loss_ss: 0.768565, loss_d: 0.489539
0.4612 --- loss: 1.127972, loss_ss: 0.880303, loss_d: 0.247669
0.4996 --- loss: 0.792897, loss_ss: 0.539401, loss_d: 0.253497
0.5380 --- loss: 1.489977, loss_ss: 0.949353, loss_d: 0.540624
0.5765 --- loss: 1.515254, loss_ss: 1.007803, loss_d: 0.507451
0.6149 --- loss: 1.446054, loss_ss: 1.181441, loss_d: 0.264613
0.6533 --- loss: 0.975467, loss_ss: 0.684982, loss_d: 0.290486
0.6918 --- loss: 0.991683, loss_ss: 0.778718, loss_d: 0.212965
0.7302 --- loss: 1.030678, loss_ss: 0.746823, loss_d: 0.283855
0.7686 --- loss: 0.894181, loss_ss: 0.733768, loss_d: 0.160413
0.8071 --- loss: 0.998610, loss_ss: 0.801662, loss_d: 0.196948
0.8455 --- loss: 1.311591, loss_ss: 1.052255, loss_d: 0.259336
0.8839 --- loss: 1.497189, loss_ss: 0.785932, loss_d: 0.711257
0.9224 --- loss: 1.590005, loss_ss: 1.140286, loss_d: 0.449719
0.9608 --- loss: 0.898060, loss_ss: 0.677334, loss_d: 0.220726
0.9992 --- loss: 1.034690, loss_ss: 0.809313, loss_d: 0.225377
Epoch finished! Loss: 1.2617587039103875
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.153140, loss_ss: 0.852711, loss_d: 0.300429
0.0384 --- loss: 1.495117, loss_ss: 1.382327, loss_d: 0.112790
0.0769 --- loss: 0.875469, loss_ss: 0.616829, loss_d: 0.258641
0.1153 --- loss: 1.052564, loss_ss: 0.866502, loss_d: 0.186062
0.1537 --- loss: 1.408364, loss_ss: 0.894219, loss_d: 0.514145
0.1922 --- loss: 1.321846, loss_ss: 0.993421, loss_d: 0.328425
0.2306 --- loss: 1.081768, loss_ss: 0.906383, loss_d: 0.175385
0.2690 --- loss: 1.263563, loss_ss: 0.839024, loss_d: 0.424539
0.3075 --- loss: 1.235736, loss_ss: 0.852283, loss_d: 0.383452
0.3459 --- loss: 1.033587, loss_ss: 0.791684, loss_d: 0.241903
0.3843 --- loss: 1.371250, loss_ss: 1.078161, loss_d: 0.293089
0.4228 --- loss: 1.124329, loss_ss: 0.752291, loss_d: 0.372038
0.4612 --- loss: 1.384026, loss_ss: 0.896416, loss_d: 0.487610
0.4996 --- loss: 1.118856, loss_ss: 0.743567, loss_d: 0.375289
0.5380 --- loss: 1.217074, loss_ss: 0.898227, loss_d: 0.318847
0.5765 --- loss: 1.013632, loss_ss: 0.674766, loss_d: 0.338866
0.6149 --- loss: 1.129856, loss_ss: 0.814953, loss_d: 0.314903
0.6533 --- loss: 1.022821, loss_ss: 0.845748, loss_d: 0.177072
0.6918 --- loss: 1.466637, loss_ss: 0.954023, loss_d: 0.512614
0.7302 --- loss: 0.866219, loss_ss: 0.514758, loss_d: 0.351462
0.7686 --- loss: 1.326547, loss_ss: 1.053524, loss_d: 0.273022
0.8071 --- loss: 0.975023, loss_ss: 0.601807, loss_d: 0.373216
0.8455 --- loss: 0.965506, loss_ss: 0.780064, loss_d: 0.185441
0.8839 --- loss: 0.938798, loss_ss: 0.698249, loss_d: 0.240549
0.9224 --- loss: 1.469673, loss_ss: 1.141399, loss_d: 0.328274
0.9608 --- loss: 1.265476, loss_ss: 0.786434, loss_d: 0.479042
0.9992 --- loss: 1.406021, loss_ss: 0.951200, loss_d: 0.454822
Epoch finished! Loss: 1.2348709370081241
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.072414, loss_ss: 0.808540, loss_d: 0.263874
0.0384 --- loss: 1.179830, loss_ss: 0.940596, loss_d: 0.239234
0.0769 --- loss: 1.092800, loss_ss: 0.656584, loss_d: 0.436216
0.1153 --- loss: 1.196958, loss_ss: 0.656784, loss_d: 0.540174
0.1537 --- loss: 1.089375, loss_ss: 0.867780, loss_d: 0.221595
0.1922 --- loss: 1.247438, loss_ss: 0.696994, loss_d: 0.550444
0.2306 --- loss: 1.773649, loss_ss: 0.634520, loss_d: 1.139130
0.2690 --- loss: 1.348642, loss_ss: 0.736782, loss_d: 0.611860
0.3075 --- loss: 1.590203, loss_ss: 1.106374, loss_d: 0.483829
0.3459 --- loss: 1.550912, loss_ss: 1.333006, loss_d: 0.217906
0.3843 --- loss: 1.312141, loss_ss: 0.908230, loss_d: 0.403911
0.4228 --- loss: 1.286781, loss_ss: 1.005731, loss_d: 0.281049
0.4612 --- loss: 1.098355, loss_ss: 0.875848, loss_d: 0.222507
0.4996 --- loss: 1.300089, loss_ss: 0.792413, loss_d: 0.507675
0.5380 --- loss: 1.397894, loss_ss: 1.016470, loss_d: 0.381424
0.5765 --- loss: 1.369535, loss_ss: 0.535680, loss_d: 0.833855
0.6149 --- loss: 0.924899, loss_ss: 0.630580, loss_d: 0.294319
0.6533 --- loss: 1.708259, loss_ss: 1.198519, loss_d: 0.509740
0.6918 --- loss: 1.474117, loss_ss: 0.968110, loss_d: 0.506008
0.7302 --- loss: 1.274900, loss_ss: 1.058162, loss_d: 0.216738
0.7686 --- loss: 1.221426, loss_ss: 0.965716, loss_d: 0.255709
0.8071 --- loss: 0.913677, loss_ss: 0.655545, loss_d: 0.258132
0.8455 --- loss: 1.077874, loss_ss: 0.899464, loss_d: 0.178410
0.8839 --- loss: 1.160061, loss_ss: 0.987838, loss_d: 0.172223
0.9224 --- loss: 1.007307, loss_ss: 0.812086, loss_d: 0.195221
0.9608 --- loss: 1.462341, loss_ss: 1.043584, loss_d: 0.418757
0.9992 --- loss: 1.501771, loss_ss: 1.284985, loss_d: 0.216786
Epoch finished! Loss: 1.2075106799602509
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.307154, loss_ss: 1.005389, loss_d: 0.301765
0.0384 --- loss: 0.935573, loss_ss: 0.692738, loss_d: 0.242835
0.0769 --- loss: 1.484483, loss_ss: 1.274866, loss_d: 0.209617
0.1153 --- loss: 0.950318, loss_ss: 0.739806, loss_d: 0.210512
0.1537 --- loss: 1.308471, loss_ss: 1.075314, loss_d: 0.233158
0.1922 --- loss: 0.932068, loss_ss: 0.730151, loss_d: 0.201917
0.2306 --- loss: 1.482535, loss_ss: 1.267876, loss_d: 0.214659
0.2690 --- loss: 0.981441, loss_ss: 0.829343, loss_d: 0.152098
0.3075 --- loss: 0.997475, loss_ss: 0.647713, loss_d: 0.349762
0.3459 --- loss: 1.029928, loss_ss: 0.704577, loss_d: 0.325351
0.3843 --- loss: 1.053623, loss_ss: 0.818866, loss_d: 0.234757
0.4228 --- loss: 1.254135, loss_ss: 0.680158, loss_d: 0.573977
0.4612 --- loss: 1.778123, loss_ss: 1.137938, loss_d: 0.640186
0.4996 --- loss: 0.885480, loss_ss: 0.649407, loss_d: 0.236073
0.5380 --- loss: 1.129252, loss_ss: 0.795269, loss_d: 0.333983
0.5765 --- loss: 1.240588, loss_ss: 1.104753, loss_d: 0.135835
0.6149 --- loss: 0.645885, loss_ss: 0.540253, loss_d: 0.105632
0.6533 --- loss: 0.969930, loss_ss: 0.777695, loss_d: 0.192235
0.6918 --- loss: 1.304348, loss_ss: 1.036766, loss_d: 0.267582
0.7302 --- loss: 0.953893, loss_ss: 0.691654, loss_d: 0.262238
0.7686 --- loss: 1.144730, loss_ss: 0.860559, loss_d: 0.284171
0.8071 --- loss: 1.027836, loss_ss: 0.803169, loss_d: 0.224667
0.8455 --- loss: 0.968270, loss_ss: 0.781394, loss_d: 0.186876
0.8839 --- loss: 1.200906, loss_ss: 0.970877, loss_d: 0.230028
0.9224 --- loss: 1.165037, loss_ss: 0.896281, loss_d: 0.268756
0.9608 --- loss: 0.967721, loss_ss: 0.560625, loss_d: 0.407096
0.9992 --- loss: 2.118416, loss_ss: 1.540500, loss_d: 0.577916
Epoch finished! Loss: 1.1807289036420676
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6722222222222223
             precision    recall  f1-score   support

        0.0       0.79      0.41      0.54       260
        1.0       0.66      0.29      0.40       248
        2.0       0.78      0.95      0.86       375
        3.0       0.98      0.98      0.98       169
        4.0       0.12      0.93      0.22        28

avg / total       0.77      0.67      0.68      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.15  41.15   96.46  78.68     54.04
1  80.19  28.63   95.55  65.74     39.89
2  89.26  95.20   86.10  78.46     86.02
3  99.35  97.63   99.67  98.21     97.92
4  82.50  92.86   82.22  12.21     21.58
Total accuracy: 67.22%
Average sen: 71.09%
Average spec: 92.00%
Macro f1-score: 59.89%
[0.89259315 0.93091023 0.99721694 0.99801826 0.99818844 0.98730069
 0.89785987 0.9916836  0.97902828 0.96497422 0.98473603 0.98090702
 0.86106914 0.97363991 0.90359187 0.98956609 0.99908233 0.99419278
 0.99903715 0.99872988 0.98777801 0.86440778 0.99537343 0.93132126
 0.94661707 0.99541473 0.94632244 0.90141958 0.95565653 0.99063241
 0.98840487 0.82325387 0.85749084 0.84958684 0.97710538 0.91492164]
pred: 0.9513342380523682, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.423060, loss_ss: 1.703467, loss_d: 0.719593
0.0384 --- loss: 2.361463, loss_ss: 1.543937, loss_d: 0.817526
0.0768 --- loss: 2.223451, loss_ss: 1.505039, loss_d: 0.718411
0.1152 --- loss: 2.039660, loss_ss: 1.481902, loss_d: 0.557758
0.1536 --- loss: 1.860696, loss_ss: 1.385535, loss_d: 0.475161
0.1919 --- loss: 2.171499, loss_ss: 1.373141, loss_d: 0.798358
0.2303 --- loss: 2.109192, loss_ss: 1.463621, loss_d: 0.645571
0.2687 --- loss: 1.985840, loss_ss: 1.436712, loss_d: 0.549128
0.3071 --- loss: 2.137827, loss_ss: 1.494367, loss_d: 0.643460
0.3455 --- loss: 1.634963, loss_ss: 1.279488, loss_d: 0.355475
0.3839 --- loss: 1.959096, loss_ss: 1.270327, loss_d: 0.688769
0.4223 --- loss: 1.802622, loss_ss: 1.384344, loss_d: 0.418278
0.4607 --- loss: 2.052303, loss_ss: 1.276403, loss_d: 0.775900
0.4990 --- loss: 2.107620, loss_ss: 1.461225, loss_d: 0.646394
0.5374 --- loss: 1.930116, loss_ss: 1.238425, loss_d: 0.691690
0.5758 --- loss: 1.792313, loss_ss: 1.279661, loss_d: 0.512652
0.6142 --- loss: 1.785867, loss_ss: 1.191236, loss_d: 0.594631
0.6526 --- loss: 1.704861, loss_ss: 1.293692, loss_d: 0.411169
0.6910 --- loss: 1.793580, loss_ss: 1.279603, loss_d: 0.513976
0.7294 --- loss: 1.655283, loss_ss: 1.106405, loss_d: 0.548878
0.7678 --- loss: 1.716739, loss_ss: 1.032126, loss_d: 0.684614
0.8061 --- loss: 1.800990, loss_ss: 1.297180, loss_d: 0.503811
0.8445 --- loss: 1.870341, loss_ss: 1.404367, loss_d: 0.465974
0.8829 --- loss: 2.029949, loss_ss: 1.191672, loss_d: 0.838277
0.9213 --- loss: 1.727152, loss_ss: 1.139430, loss_d: 0.587722
0.9597 --- loss: 1.611377, loss_ss: 1.063489, loss_d: 0.547888
0.9981 --- loss: 1.547906, loss_ss: 1.216513, loss_d: 0.331393
Epoch finished! Loss: 1.9175654888153075
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.797452, loss_ss: 1.183969, loss_d: 0.613483
0.0384 --- loss: 1.825947, loss_ss: 1.197693, loss_d: 0.628255
0.0768 --- loss: 1.541974, loss_ss: 1.149499, loss_d: 0.392475
0.1152 --- loss: 1.839805, loss_ss: 1.224936, loss_d: 0.614869
0.1536 --- loss: 1.975046, loss_ss: 1.224061, loss_d: 0.750985
0.1919 --- loss: 1.569840, loss_ss: 1.064563, loss_d: 0.505277
0.2303 --- loss: 1.748511, loss_ss: 1.154661, loss_d: 0.593850
0.2687 --- loss: 1.952036, loss_ss: 1.284118, loss_d: 0.667918
0.3071 --- loss: 1.737783, loss_ss: 1.218810, loss_d: 0.518973
0.3455 --- loss: 1.289906, loss_ss: 0.813344, loss_d: 0.476562
0.3839 --- loss: 1.559980, loss_ss: 1.034074, loss_d: 0.525906
0.4223 --- loss: 2.409156, loss_ss: 1.223624, loss_d: 1.185532
0.4607 --- loss: 1.740244, loss_ss: 1.212435, loss_d: 0.527809
0.4990 --- loss: 1.969696, loss_ss: 1.386018, loss_d: 0.583678
0.5374 --- loss: 1.713213, loss_ss: 1.136688, loss_d: 0.576524
0.5758 --- loss: 1.971463, loss_ss: 1.409519, loss_d: 0.561944
0.6142 --- loss: 1.844610, loss_ss: 1.137541, loss_d: 0.707070
0.6526 --- loss: 1.870229, loss_ss: 1.401870, loss_d: 0.468359
0.6910 --- loss: 1.945569, loss_ss: 1.153107, loss_d: 0.792461
0.7294 --- loss: 1.530194, loss_ss: 1.045116, loss_d: 0.485078
0.7678 --- loss: 1.292965, loss_ss: 0.973673, loss_d: 0.319292
0.8061 --- loss: 1.674720, loss_ss: 1.055219, loss_d: 0.619501
0.8445 --- loss: 1.384822, loss_ss: 0.899188, loss_d: 0.485635
0.8829 --- loss: 1.472612, loss_ss: 1.072097, loss_d: 0.400515
0.9213 --- loss: 1.958859, loss_ss: 1.061199, loss_d: 0.897659
0.9597 --- loss: 1.815299, loss_ss: 1.240856, loss_d: 0.574443
0.9981 --- loss: 1.388211, loss_ss: 1.088369, loss_d: 0.299843
Epoch finished! Loss: 1.6950393392489507
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.561475, loss_ss: 0.981966, loss_d: 0.579509
0.0384 --- loss: 1.688984, loss_ss: 1.321593, loss_d: 0.367391
0.0768 --- loss: 1.853483, loss_ss: 0.958717, loss_d: 0.894766
0.1152 --- loss: 1.870239, loss_ss: 1.309542, loss_d: 0.560697
0.1536 --- loss: 1.592653, loss_ss: 0.971287, loss_d: 0.621367
0.1919 --- loss: 1.834745, loss_ss: 1.315856, loss_d: 0.518888
0.2303 --- loss: 1.562340, loss_ss: 0.981601, loss_d: 0.580740
0.2687 --- loss: 1.467024, loss_ss: 1.023205, loss_d: 0.443819
0.3071 --- loss: 1.446132, loss_ss: 0.824558, loss_d: 0.621574
0.3455 --- loss: 1.793206, loss_ss: 0.999723, loss_d: 0.793482
0.3839 --- loss: 1.405609, loss_ss: 1.036906, loss_d: 0.368703
0.4223 --- loss: 1.559227, loss_ss: 0.975588, loss_d: 0.583639
0.4607 --- loss: 1.489905, loss_ss: 0.842085, loss_d: 0.647820
0.4990 --- loss: 1.523632, loss_ss: 0.801758, loss_d: 0.721874
0.5374 --- loss: 1.523072, loss_ss: 1.063559, loss_d: 0.459513
0.5758 --- loss: 1.306665, loss_ss: 0.754670, loss_d: 0.551996
0.6142 --- loss: 1.518778, loss_ss: 0.979492, loss_d: 0.539286
0.6526 --- loss: 2.092144, loss_ss: 1.352643, loss_d: 0.739501
0.6910 --- loss: 1.260178, loss_ss: 0.948145, loss_d: 0.312033
0.7294 --- loss: 1.890260, loss_ss: 1.071459, loss_d: 0.818802
0.7678 --- loss: 1.418571, loss_ss: 0.924190, loss_d: 0.494381
0.8061 --- loss: 1.690827, loss_ss: 0.993835, loss_d: 0.696992
0.8445 --- loss: 1.210095, loss_ss: 0.878000, loss_d: 0.332095
0.8829 --- loss: 1.880815, loss_ss: 1.192281, loss_d: 0.688535
0.9213 --- loss: 1.412931, loss_ss: 0.931330, loss_d: 0.481601
0.9597 --- loss: 1.474264, loss_ss: 1.084830, loss_d: 0.389434
0.9981 --- loss: 2.111838, loss_ss: 1.241662, loss_d: 0.870176
Epoch finished! Loss: 1.5828261269972874
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.532417, loss_ss: 1.070813, loss_d: 0.461604
0.0384 --- loss: 1.832325, loss_ss: 1.202801, loss_d: 0.629523
0.0768 --- loss: 1.677616, loss_ss: 1.354306, loss_d: 0.323311
0.1152 --- loss: 1.666364, loss_ss: 1.184786, loss_d: 0.481578
0.1536 --- loss: 1.196077, loss_ss: 0.808603, loss_d: 0.387473
0.1919 --- loss: 1.356876, loss_ss: 0.858569, loss_d: 0.498307
0.2303 --- loss: 1.316580, loss_ss: 0.993114, loss_d: 0.323466
0.2687 --- loss: 1.338877, loss_ss: 0.948226, loss_d: 0.390651
0.3071 --- loss: 1.529796, loss_ss: 0.918739, loss_d: 0.611058
0.3455 --- loss: 1.252282, loss_ss: 0.860497, loss_d: 0.391785
0.3839 --- loss: 2.363926, loss_ss: 1.370859, loss_d: 0.993068
0.4223 --- loss: 1.686283, loss_ss: 1.345482, loss_d: 0.340801
0.4607 --- loss: 1.820079, loss_ss: 0.814196, loss_d: 1.005883
0.4990 --- loss: 1.074444, loss_ss: 0.812549, loss_d: 0.261895
0.5374 --- loss: 1.772812, loss_ss: 1.053489, loss_d: 0.719322
0.5758 --- loss: 1.339129, loss_ss: 0.774850, loss_d: 0.564279
0.6142 --- loss: 1.685530, loss_ss: 1.144268, loss_d: 0.541262
0.6526 --- loss: 1.476381, loss_ss: 0.972582, loss_d: 0.503799
0.6910 --- loss: 1.472948, loss_ss: 1.109249, loss_d: 0.363699
0.7294 --- loss: 1.554579, loss_ss: 1.224969, loss_d: 0.329611
0.7678 --- loss: 1.337422, loss_ss: 1.143440, loss_d: 0.193982
0.8061 --- loss: 1.122502, loss_ss: 0.908617, loss_d: 0.213885
0.8445 --- loss: 1.567504, loss_ss: 1.005629, loss_d: 0.561875
0.8829 --- loss: 1.212427, loss_ss: 0.971910, loss_d: 0.240517
0.9213 --- loss: 1.432483, loss_ss: 0.756103, loss_d: 0.676379
0.9597 --- loss: 1.503019, loss_ss: 1.195719, loss_d: 0.307300
0.9981 --- loss: 1.247346, loss_ss: 0.934999, loss_d: 0.312347
Epoch finished! Loss: 1.4621406720234797
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.503652, loss_ss: 1.208987, loss_d: 0.294665
0.0384 --- loss: 1.529616, loss_ss: 1.027378, loss_d: 0.502237
0.0768 --- loss: 1.409316, loss_ss: 0.926493, loss_d: 0.482823
0.1152 --- loss: 1.385307, loss_ss: 1.030404, loss_d: 0.354903
0.1536 --- loss: 1.723363, loss_ss: 1.407717, loss_d: 0.315646
0.1919 --- loss: 2.339156, loss_ss: 0.851252, loss_d: 1.487903
0.2303 --- loss: 1.279315, loss_ss: 0.985914, loss_d: 0.293401
0.2687 --- loss: 1.240751, loss_ss: 0.891433, loss_d: 0.349317
0.3071 --- loss: 1.240620, loss_ss: 0.926856, loss_d: 0.313765
0.3455 --- loss: 1.015877, loss_ss: 0.778721, loss_d: 0.237156
0.3839 --- loss: 1.448978, loss_ss: 1.208913, loss_d: 0.240065
0.4223 --- loss: 1.602060, loss_ss: 0.993871, loss_d: 0.608189
0.4607 --- loss: 1.007900, loss_ss: 0.611312, loss_d: 0.396588
0.4990 --- loss: 1.192772, loss_ss: 0.871338, loss_d: 0.321434
0.5374 --- loss: 1.608213, loss_ss: 1.232233, loss_d: 0.375980
0.5758 --- loss: 1.106056, loss_ss: 0.882024, loss_d: 0.224032
0.6142 --- loss: 1.100070, loss_ss: 0.850367, loss_d: 0.249703
0.6526 --- loss: 1.501988, loss_ss: 0.896877, loss_d: 0.605111
0.6910 --- loss: 1.366063, loss_ss: 0.900945, loss_d: 0.465118
0.7294 --- loss: 1.148226, loss_ss: 1.000624, loss_d: 0.147602
0.7678 --- loss: 1.519743, loss_ss: 0.747545, loss_d: 0.772198
0.8061 --- loss: 1.013905, loss_ss: 0.704897, loss_d: 0.309008
0.8445 --- loss: 1.157913, loss_ss: 0.860836, loss_d: 0.297077
0.8829 --- loss: 1.548447, loss_ss: 0.852878, loss_d: 0.695569
0.9213 --- loss: 1.287850, loss_ss: 0.754952, loss_d: 0.532898
0.9597 --- loss: 1.153695, loss_ss: 0.822442, loss_d: 0.331253
0.9981 --- loss: 1.240471, loss_ss: 0.819976, loss_d: 0.420495
Epoch finished! Loss: 1.3707344816281246
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.983547, loss_ss: 0.741888, loss_d: 0.241659
0.0384 --- loss: 1.393396, loss_ss: 0.932719, loss_d: 0.460677
0.0768 --- loss: 1.030607, loss_ss: 0.704104, loss_d: 0.326502
0.1152 --- loss: 1.508193, loss_ss: 0.696792, loss_d: 0.811401
0.1536 --- loss: 1.495569, loss_ss: 0.776550, loss_d: 0.719019
0.1919 --- loss: 1.182710, loss_ss: 0.850533, loss_d: 0.332177
0.2303 --- loss: 1.131025, loss_ss: 0.903601, loss_d: 0.227424
0.2687 --- loss: 1.612089, loss_ss: 1.004143, loss_d: 0.607946
0.3071 --- loss: 0.979443, loss_ss: 0.851345, loss_d: 0.128098
0.3455 --- loss: 1.042911, loss_ss: 0.810671, loss_d: 0.232239
0.3839 --- loss: 1.041208, loss_ss: 0.867093, loss_d: 0.174115
0.4223 --- loss: 0.944448, loss_ss: 0.717339, loss_d: 0.227110
0.4607 --- loss: 1.570107, loss_ss: 1.280850, loss_d: 0.289256
0.4990 --- loss: 1.165571, loss_ss: 0.613656, loss_d: 0.551916
0.5374 --- loss: 1.721857, loss_ss: 1.153654, loss_d: 0.568203
0.5758 --- loss: 1.615222, loss_ss: 1.169670, loss_d: 0.445552
0.6142 --- loss: 1.113045, loss_ss: 0.894874, loss_d: 0.218171
0.6526 --- loss: 1.476695, loss_ss: 0.865367, loss_d: 0.611328
0.6910 --- loss: 1.353817, loss_ss: 1.060126, loss_d: 0.293690
0.7294 --- loss: 1.155606, loss_ss: 0.918719, loss_d: 0.236887
0.7678 --- loss: 1.333138, loss_ss: 0.860248, loss_d: 0.472890
0.8061 --- loss: 1.380146, loss_ss: 0.588708, loss_d: 0.791437
0.8445 --- loss: 1.075234, loss_ss: 0.920097, loss_d: 0.155137
0.8829 --- loss: 1.364521, loss_ss: 0.995067, loss_d: 0.369454
0.9213 --- loss: 0.993146, loss_ss: 0.803291, loss_d: 0.189855
0.9597 --- loss: 1.524911, loss_ss: 0.665822, loss_d: 0.859089
0.9981 --- loss: 1.111599, loss_ss: 0.893874, loss_d: 0.217725
Epoch finished! Loss: 1.2830252399811377
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.533469, loss_ss: 0.736743, loss_d: 0.796727
0.0384 --- loss: 1.716719, loss_ss: 1.010403, loss_d: 0.706315
0.0768 --- loss: 1.333775, loss_ss: 1.015505, loss_d: 0.318270
0.1152 --- loss: 1.203065, loss_ss: 1.020287, loss_d: 0.182778
0.1536 --- loss: 1.148566, loss_ss: 0.958896, loss_d: 0.189670
0.1919 --- loss: 1.311240, loss_ss: 0.793997, loss_d: 0.517243
0.2303 --- loss: 0.995453, loss_ss: 0.829008, loss_d: 0.166444
0.2687 --- loss: 1.004463, loss_ss: 0.802128, loss_d: 0.202336
0.3071 --- loss: 1.107829, loss_ss: 0.800868, loss_d: 0.306961
0.3455 --- loss: 1.436678, loss_ss: 0.982848, loss_d: 0.453830
0.3839 --- loss: 0.838166, loss_ss: 0.668515, loss_d: 0.169651
0.4223 --- loss: 1.060270, loss_ss: 0.839474, loss_d: 0.220796
0.4607 --- loss: 1.790460, loss_ss: 0.946280, loss_d: 0.844181
0.4990 --- loss: 0.950172, loss_ss: 0.775052, loss_d: 0.175120
0.5374 --- loss: 1.016324, loss_ss: 0.816751, loss_d: 0.199573
0.5758 --- loss: 1.150004, loss_ss: 0.789951, loss_d: 0.360054
0.6142 --- loss: 1.349231, loss_ss: 1.024950, loss_d: 0.324281
0.6526 --- loss: 1.195649, loss_ss: 0.794103, loss_d: 0.401546
0.6910 --- loss: 1.205784, loss_ss: 0.832656, loss_d: 0.373127
0.7294 --- loss: 1.355316, loss_ss: 1.051590, loss_d: 0.303726
0.7678 --- loss: 1.236286, loss_ss: 1.062647, loss_d: 0.173639
0.8061 --- loss: 1.013891, loss_ss: 0.866507, loss_d: 0.147383
0.8445 --- loss: 0.949705, loss_ss: 0.609334, loss_d: 0.340371
0.8829 --- loss: 1.098773, loss_ss: 0.970285, loss_d: 0.128488
0.9213 --- loss: 1.049072, loss_ss: 0.745777, loss_d: 0.303295
0.9597 --- loss: 1.308637, loss_ss: 0.992097, loss_d: 0.316539
0.9981 --- loss: 1.637130, loss_ss: 0.695082, loss_d: 0.942048
Epoch finished! Loss: 1.2383029194978568
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.229895, loss_ss: 1.020170, loss_d: 0.209725
0.0384 --- loss: 1.446149, loss_ss: 1.003290, loss_d: 0.442860
0.0768 --- loss: 0.974458, loss_ss: 0.660666, loss_d: 0.313792
0.1152 --- loss: 1.834411, loss_ss: 1.363891, loss_d: 0.470520
0.1536 --- loss: 0.969326, loss_ss: 0.775715, loss_d: 0.193612
0.1919 --- loss: 1.049197, loss_ss: 0.802015, loss_d: 0.247183
0.2303 --- loss: 1.032948, loss_ss: 0.814550, loss_d: 0.218398
0.2687 --- loss: 0.944222, loss_ss: 0.807292, loss_d: 0.136929
0.3071 --- loss: 1.133306, loss_ss: 0.767926, loss_d: 0.365380
0.3455 --- loss: 0.867832, loss_ss: 0.787144, loss_d: 0.080688
0.3839 --- loss: 1.478377, loss_ss: 1.183357, loss_d: 0.295020
0.4223 --- loss: 1.056456, loss_ss: 0.771013, loss_d: 0.285443
0.4607 --- loss: 1.234953, loss_ss: 0.889116, loss_d: 0.345837
0.4990 --- loss: 1.331136, loss_ss: 1.087745, loss_d: 0.243391
0.5374 --- loss: 1.042718, loss_ss: 0.883894, loss_d: 0.158824
0.5758 --- loss: 1.096521, loss_ss: 0.834578, loss_d: 0.261943
0.6142 --- loss: 1.287462, loss_ss: 0.995113, loss_d: 0.292349
0.6526 --- loss: 1.124606, loss_ss: 0.801217, loss_d: 0.323389
0.6910 --- loss: 1.155161, loss_ss: 0.841556, loss_d: 0.313606
0.7294 --- loss: 1.429930, loss_ss: 1.292642, loss_d: 0.137288
0.7678 --- loss: 0.935982, loss_ss: 0.719103, loss_d: 0.216880
0.8061 --- loss: 1.183517, loss_ss: 0.854011, loss_d: 0.329506
0.8445 --- loss: 1.570338, loss_ss: 0.768831, loss_d: 0.801507
0.8829 --- loss: 1.459673, loss_ss: 0.855633, loss_d: 0.604040
0.9213 --- loss: 1.289671, loss_ss: 0.876395, loss_d: 0.413275
0.9597 --- loss: 0.973726, loss_ss: 0.782126, loss_d: 0.191600
0.9981 --- loss: 1.019790, loss_ss: 0.703723, loss_d: 0.316067
Epoch finished! Loss: 1.2143639592023996
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.897072, loss_ss: 0.731365, loss_d: 0.165707
0.0384 --- loss: 1.409586, loss_ss: 0.883224, loss_d: 0.526363
0.0768 --- loss: 1.179589, loss_ss: 1.007694, loss_d: 0.171895
0.1152 --- loss: 1.060222, loss_ss: 0.894307, loss_d: 0.165915
0.1536 --- loss: 0.793006, loss_ss: 0.554035, loss_d: 0.238972
0.1919 --- loss: 1.115605, loss_ss: 0.967649, loss_d: 0.147956
0.2303 --- loss: 1.849462, loss_ss: 1.210271, loss_d: 0.639191
0.2687 --- loss: 1.050781, loss_ss: 0.720614, loss_d: 0.330167
0.3071 --- loss: 1.081824, loss_ss: 0.742199, loss_d: 0.339624
0.3455 --- loss: 1.391547, loss_ss: 1.011270, loss_d: 0.380277
0.3839 --- loss: 1.607498, loss_ss: 0.923116, loss_d: 0.684382
0.4223 --- loss: 1.078714, loss_ss: 0.874231, loss_d: 0.204483
0.4607 --- loss: 1.042181, loss_ss: 0.642660, loss_d: 0.399521
0.4990 --- loss: 1.094202, loss_ss: 0.721357, loss_d: 0.372845
0.5374 --- loss: 1.472667, loss_ss: 1.335774, loss_d: 0.136892
0.5758 --- loss: 1.406902, loss_ss: 0.941265, loss_d: 0.465637
0.6142 --- loss: 1.036143, loss_ss: 0.829929, loss_d: 0.206214
0.6526 --- loss: 0.981775, loss_ss: 0.701643, loss_d: 0.280132
0.6910 --- loss: 1.284494, loss_ss: 1.097897, loss_d: 0.186596
0.7294 --- loss: 0.861148, loss_ss: 0.587479, loss_d: 0.273670
0.7678 --- loss: 1.283987, loss_ss: 0.720704, loss_d: 0.563283
0.8061 --- loss: 1.620403, loss_ss: 1.165735, loss_d: 0.454668
0.8445 --- loss: 1.125936, loss_ss: 0.868446, loss_d: 0.257490
0.8829 --- loss: 1.231029, loss_ss: 1.090835, loss_d: 0.140194
0.9213 --- loss: 0.728404, loss_ss: 0.631876, loss_d: 0.096529
0.9597 --- loss: 1.413559, loss_ss: 0.882678, loss_d: 0.530881
0.9981 --- loss: 1.190173, loss_ss: 0.894475, loss_d: 0.295699
Epoch finished! Loss: 1.1801094587032612
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.940601, loss_ss: 0.754729, loss_d: 0.185873
0.0384 --- loss: 0.900114, loss_ss: 0.808302, loss_d: 0.091812
0.0768 --- loss: 0.584646, loss_ss: 0.489006, loss_d: 0.095640
0.1152 --- loss: 1.383754, loss_ss: 0.585732, loss_d: 0.798023
0.1536 --- loss: 1.124661, loss_ss: 0.847841, loss_d: 0.276820
0.1919 --- loss: 1.166311, loss_ss: 0.975022, loss_d: 0.191289
0.2303 --- loss: 1.332609, loss_ss: 0.842266, loss_d: 0.490343
0.2687 --- loss: 1.370466, loss_ss: 1.122677, loss_d: 0.247789
0.3071 --- loss: 1.266643, loss_ss: 1.056417, loss_d: 0.210226
0.3455 --- loss: 0.954140, loss_ss: 0.823431, loss_d: 0.130710
0.3839 --- loss: 1.224159, loss_ss: 0.830664, loss_d: 0.393494
0.4223 --- loss: 1.020027, loss_ss: 0.868961, loss_d: 0.151066
0.4607 --- loss: 1.120861, loss_ss: 0.962911, loss_d: 0.157949
0.4990 --- loss: 1.588125, loss_ss: 0.891862, loss_d: 0.696262
0.5374 --- loss: 1.533324, loss_ss: 0.899130, loss_d: 0.634193
0.5758 --- loss: 1.183868, loss_ss: 0.822626, loss_d: 0.361242
0.6142 --- loss: 0.995447, loss_ss: 0.823638, loss_d: 0.171809
0.6526 --- loss: 0.726913, loss_ss: 0.614842, loss_d: 0.112071
0.6910 --- loss: 0.791871, loss_ss: 0.660829, loss_d: 0.131042
0.7294 --- loss: 1.078282, loss_ss: 0.793781, loss_d: 0.284501
0.7678 --- loss: 1.649580, loss_ss: 1.030099, loss_d: 0.619481
0.8061 --- loss: 0.912062, loss_ss: 0.834811, loss_d: 0.077250
0.8445 --- loss: 1.286958, loss_ss: 1.020960, loss_d: 0.265998
0.8829 --- loss: 1.566607, loss_ss: 1.135257, loss_d: 0.431349
0.9213 --- loss: 0.986221, loss_ss: 0.835720, loss_d: 0.150500
0.9597 --- loss: 0.683059, loss_ss: 0.571325, loss_d: 0.111735
0.9981 --- loss: 2.523186, loss_ss: 0.464739, loss_d: 2.058447
Epoch finished! Loss: 1.1530260001237576
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5898989898989899
             precision    recall  f1-score   support

        0.0       0.38      0.26      0.31        80
        1.0       0.10      0.87      0.18        38
        2.0       0.94      0.53      0.68       478
        3.0       0.90      0.90      0.90       196
        4.0       0.69      0.50      0.58       198

avg / total       0.80      0.59      0.65       990
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.61  26.25   96.26  38.18     31.11
1  70.10  86.84   69.43  10.19     18.23
2  75.66  53.14   96.68  93.73     67.82
3  96.16  90.31   97.61  90.31     90.31
4  85.45  50.00   94.32  68.75     57.89
Total accuracy: 58.99%
Average sen: 61.31%
Average spec: 90.86%
Macro f1-score: 53.07%
[0.98744917 0.97087955 0.9897058  0.99683893 0.99723852 0.99483985
 0.99823147 0.99752742 0.99725854 0.98078936 0.98518777 0.99645388
 0.99372357 0.9926939  0.99312133 0.99104273 0.99353665 0.97761601
 0.98431826 0.98943418 0.99655342 0.98582387 0.98563623 0.99719149
 0.99059379 0.99932599 0.98513609 0.9961319  0.99064624 0.99856037
 0.98334008 0.9965238  0.97653884]
pred: 0.9906026973868861, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.506562, loss_ss: 1.779878, loss_d: 0.726685
0.0384 --- loss: 1.974109, loss_ss: 1.378783, loss_d: 0.595326
0.0767 --- loss: 2.049299, loss_ss: 1.383668, loss_d: 0.665631
0.1151 --- loss: 2.150885, loss_ss: 1.442642, loss_d: 0.708243
0.1535 --- loss: 1.906181, loss_ss: 1.403104, loss_d: 0.503077
0.1919 --- loss: 1.855168, loss_ss: 1.364276, loss_d: 0.490892
0.2302 --- loss: 1.944901, loss_ss: 1.521171, loss_d: 0.423730
0.2686 --- loss: 2.011506, loss_ss: 1.420043, loss_d: 0.591463
0.3070 --- loss: 2.024996, loss_ss: 1.368728, loss_d: 0.656268
0.3454 --- loss: 1.959580, loss_ss: 1.468761, loss_d: 0.490819
0.3837 --- loss: 1.695459, loss_ss: 1.338383, loss_d: 0.357075
0.4221 --- loss: 2.001942, loss_ss: 1.259788, loss_d: 0.742154
0.4605 --- loss: 1.741804, loss_ss: 1.230853, loss_d: 0.510951
0.4988 --- loss: 1.961628, loss_ss: 1.264151, loss_d: 0.697477
0.5372 --- loss: 2.055486, loss_ss: 1.299803, loss_d: 0.755682
0.5756 --- loss: 1.928273, loss_ss: 1.245367, loss_d: 0.682906
0.6140 --- loss: 1.911835, loss_ss: 1.463056, loss_d: 0.448779
0.6523 --- loss: 1.696585, loss_ss: 1.186913, loss_d: 0.509672
0.6907 --- loss: 1.915032, loss_ss: 1.394530, loss_d: 0.520503
0.7291 --- loss: 1.864301, loss_ss: 1.259769, loss_d: 0.604532
0.7675 --- loss: 1.762482, loss_ss: 1.265167, loss_d: 0.497315
0.8058 --- loss: 1.911879, loss_ss: 1.330468, loss_d: 0.581411
0.8442 --- loss: 1.900402, loss_ss: 1.380765, loss_d: 0.519637
0.8826 --- loss: 1.877573, loss_ss: 1.189407, loss_d: 0.688166
0.9210 --- loss: 1.910279, loss_ss: 1.211009, loss_d: 0.699270
0.9593 --- loss: 1.847213, loss_ss: 1.139721, loss_d: 0.707493
0.9977 --- loss: 1.673358, loss_ss: 1.041854, loss_d: 0.631504
Epoch finished! Loss: 1.9668680475308344
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.624967, loss_ss: 1.157122, loss_d: 0.467845
0.0384 --- loss: 1.839792, loss_ss: 1.156599, loss_d: 0.683193
0.0767 --- loss: 1.739152, loss_ss: 1.096403, loss_d: 0.642750
0.1151 --- loss: 1.824460, loss_ss: 1.226379, loss_d: 0.598081
0.1535 --- loss: 1.602484, loss_ss: 1.009308, loss_d: 0.593176
0.1919 --- loss: 2.061200, loss_ss: 1.413342, loss_d: 0.647859
0.2302 --- loss: 1.524222, loss_ss: 1.074574, loss_d: 0.449648
0.2686 --- loss: 1.849579, loss_ss: 1.222152, loss_d: 0.627427
0.3070 --- loss: 1.793235, loss_ss: 1.151034, loss_d: 0.642200
0.3454 --- loss: 1.479239, loss_ss: 1.090634, loss_d: 0.388605
0.3837 --- loss: 1.731231, loss_ss: 1.094169, loss_d: 0.637062
0.4221 --- loss: 1.613471, loss_ss: 1.143327, loss_d: 0.470144
0.4605 --- loss: 1.464788, loss_ss: 1.034213, loss_d: 0.430575
0.4988 --- loss: 1.514973, loss_ss: 1.048492, loss_d: 0.466481
0.5372 --- loss: 1.539573, loss_ss: 1.139614, loss_d: 0.399959
0.5756 --- loss: 1.596861, loss_ss: 1.064996, loss_d: 0.531865
0.6140 --- loss: 1.503093, loss_ss: 1.007073, loss_d: 0.496019
0.6523 --- loss: 1.676390, loss_ss: 1.209067, loss_d: 0.467324
0.6907 --- loss: 1.326638, loss_ss: 0.805364, loss_d: 0.521275
0.7291 --- loss: 1.595488, loss_ss: 1.045695, loss_d: 0.549793
0.7675 --- loss: 1.646121, loss_ss: 0.894823, loss_d: 0.751299
0.8058 --- loss: 1.527259, loss_ss: 1.110758, loss_d: 0.416500
0.8442 --- loss: 1.822385, loss_ss: 1.235742, loss_d: 0.586642
0.8826 --- loss: 1.700315, loss_ss: 1.111060, loss_d: 0.589256
0.9210 --- loss: 1.615442, loss_ss: 0.997072, loss_d: 0.618370
0.9593 --- loss: 1.641163, loss_ss: 0.953054, loss_d: 0.688109
0.9977 --- loss: 1.393783, loss_ss: 1.041575, loss_d: 0.352207
Epoch finished! Loss: 1.7074575758897341
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.514266, loss_ss: 0.898932, loss_d: 0.615334
0.0384 --- loss: 1.508457, loss_ss: 0.810493, loss_d: 0.697964
0.0767 --- loss: 1.431936, loss_ss: 0.949492, loss_d: 0.482444
0.1151 --- loss: 1.713245, loss_ss: 1.394799, loss_d: 0.318446
0.1535 --- loss: 1.709152, loss_ss: 1.079744, loss_d: 0.629408
0.1919 --- loss: 1.664079, loss_ss: 1.152958, loss_d: 0.511121
0.2302 --- loss: 1.555166, loss_ss: 0.849698, loss_d: 0.705468
0.2686 --- loss: 1.536224, loss_ss: 0.929224, loss_d: 0.607000
0.3070 --- loss: 1.678189, loss_ss: 1.032814, loss_d: 0.645375
0.3454 --- loss: 1.561995, loss_ss: 1.074809, loss_d: 0.487186
0.3837 --- loss: 1.436461, loss_ss: 1.050165, loss_d: 0.386296
0.4221 --- loss: 1.426373, loss_ss: 0.995093, loss_d: 0.431280
0.4605 --- loss: 1.632885, loss_ss: 1.126874, loss_d: 0.506011
0.4988 --- loss: 1.583398, loss_ss: 1.064052, loss_d: 0.519345
0.5372 --- loss: 1.512436, loss_ss: 0.975954, loss_d: 0.536482
0.5756 --- loss: 1.539132, loss_ss: 0.975609, loss_d: 0.563522
0.6140 --- loss: 1.408490, loss_ss: 0.991400, loss_d: 0.417090
0.6523 --- loss: 1.756879, loss_ss: 1.047388, loss_d: 0.709491
0.6907 --- loss: 1.562737, loss_ss: 0.932427, loss_d: 0.630309
0.7291 --- loss: 1.470393, loss_ss: 0.851743, loss_d: 0.618649
0.7675 --- loss: 1.712765, loss_ss: 1.004125, loss_d: 0.708640
0.8058 --- loss: 1.703410, loss_ss: 1.267671, loss_d: 0.435739
0.8442 --- loss: 1.388016, loss_ss: 0.950264, loss_d: 0.437752
0.8826 --- loss: 1.143805, loss_ss: 0.799008, loss_d: 0.344798
0.9210 --- loss: 1.818951, loss_ss: 1.068658, loss_d: 0.750293
0.9593 --- loss: 1.667709, loss_ss: 1.250153, loss_d: 0.417555
0.9977 --- loss: 2.027683, loss_ss: 1.343198, loss_d: 0.684485
Epoch finished! Loss: 1.6072003277448508
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.295067, loss_ss: 0.810735, loss_d: 0.484331
0.0384 --- loss: 1.800082, loss_ss: 0.958544, loss_d: 0.841538
0.0767 --- loss: 1.483797, loss_ss: 1.100315, loss_d: 0.383482
0.1151 --- loss: 1.631497, loss_ss: 0.920837, loss_d: 0.710659
0.1535 --- loss: 1.774779, loss_ss: 1.277554, loss_d: 0.497225
0.1919 --- loss: 1.334568, loss_ss: 0.801549, loss_d: 0.533019
0.2302 --- loss: 1.362205, loss_ss: 0.786821, loss_d: 0.575384
0.2686 --- loss: 1.629955, loss_ss: 1.008229, loss_d: 0.621726
0.3070 --- loss: 1.520794, loss_ss: 1.065102, loss_d: 0.455692
0.3454 --- loss: 1.498126, loss_ss: 1.030485, loss_d: 0.467641
0.3837 --- loss: 1.572581, loss_ss: 0.987526, loss_d: 0.585054
0.4221 --- loss: 1.176233, loss_ss: 0.724163, loss_d: 0.452070
0.4605 --- loss: 1.546058, loss_ss: 1.000632, loss_d: 0.545426
0.4988 --- loss: 1.265410, loss_ss: 0.932085, loss_d: 0.333325
0.5372 --- loss: 1.860699, loss_ss: 1.409166, loss_d: 0.451533
0.5756 --- loss: 1.682526, loss_ss: 1.062790, loss_d: 0.619736
0.6140 --- loss: 1.802839, loss_ss: 1.125436, loss_d: 0.677403
0.6523 --- loss: 1.645057, loss_ss: 1.308704, loss_d: 0.336353
0.6907 --- loss: 1.705249, loss_ss: 0.999040, loss_d: 0.706208
0.7291 --- loss: 1.502808, loss_ss: 0.788829, loss_d: 0.713979
0.7675 --- loss: 1.505580, loss_ss: 0.887034, loss_d: 0.618546
0.8058 --- loss: 1.323921, loss_ss: 0.897231, loss_d: 0.426691
0.8442 --- loss: 1.138981, loss_ss: 0.753055, loss_d: 0.385925
0.8826 --- loss: 1.151548, loss_ss: 0.836057, loss_d: 0.315491
0.9210 --- loss: 1.283904, loss_ss: 0.903113, loss_d: 0.380790
0.9593 --- loss: 1.120085, loss_ss: 0.807515, loss_d: 0.312570
0.9977 --- loss: 1.437062, loss_ss: 1.130496, loss_d: 0.306566
Epoch finished! Loss: 1.5195234743448405
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.414640, loss_ss: 0.772313, loss_d: 0.642327
0.0384 --- loss: 1.094093, loss_ss: 0.672604, loss_d: 0.421490
0.0767 --- loss: 1.606094, loss_ss: 1.035123, loss_d: 0.570971
0.1151 --- loss: 1.497453, loss_ss: 1.185923, loss_d: 0.311530
0.1535 --- loss: 1.548808, loss_ss: 0.819925, loss_d: 0.728882
0.1919 --- loss: 1.737010, loss_ss: 1.189373, loss_d: 0.547637
0.2302 --- loss: 1.515717, loss_ss: 0.900668, loss_d: 0.615048
0.2686 --- loss: 1.580327, loss_ss: 1.019062, loss_d: 0.561265
0.3070 --- loss: 1.572351, loss_ss: 0.898474, loss_d: 0.673878
0.3454 --- loss: 1.347405, loss_ss: 0.861717, loss_d: 0.485688
0.3837 --- loss: 1.212713, loss_ss: 0.777186, loss_d: 0.435527
0.4221 --- loss: 1.196673, loss_ss: 0.784415, loss_d: 0.412258
0.4605 --- loss: 1.504846, loss_ss: 0.921156, loss_d: 0.583691
0.4988 --- loss: 1.319904, loss_ss: 0.758504, loss_d: 0.561400
0.5372 --- loss: 1.984826, loss_ss: 1.647241, loss_d: 0.337586
0.5756 --- loss: 1.275260, loss_ss: 0.981672, loss_d: 0.293588
0.6140 --- loss: 1.235671, loss_ss: 0.987651, loss_d: 0.248020
0.6523 --- loss: 1.380803, loss_ss: 1.095302, loss_d: 0.285501
0.6907 --- loss: 1.129076, loss_ss: 0.748675, loss_d: 0.380401
0.7291 --- loss: 1.386086, loss_ss: 0.863337, loss_d: 0.522749
0.7675 --- loss: 1.472626, loss_ss: 0.758651, loss_d: 0.713975
0.8058 --- loss: 1.694243, loss_ss: 0.772636, loss_d: 0.921606
0.8442 --- loss: 1.628382, loss_ss: 1.263232, loss_d: 0.365151
0.8826 --- loss: 1.402780, loss_ss: 1.062888, loss_d: 0.339892
0.9210 --- loss: 1.397222, loss_ss: 0.693769, loss_d: 0.703453
0.9593 --- loss: 1.161352, loss_ss: 0.721611, loss_d: 0.439741
0.9977 --- loss: 1.256081, loss_ss: 0.931230, loss_d: 0.324851
Epoch finished! Loss: 1.4383907068234223
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.413265, loss_ss: 1.032096, loss_d: 0.381169
0.0384 --- loss: 1.293463, loss_ss: 0.967701, loss_d: 0.325761
0.0767 --- loss: 1.285995, loss_ss: 0.779524, loss_d: 0.506470
0.1151 --- loss: 1.367323, loss_ss: 0.775513, loss_d: 0.591811
0.1535 --- loss: 1.173987, loss_ss: 0.623987, loss_d: 0.549999
0.1919 --- loss: 1.155816, loss_ss: 0.829117, loss_d: 0.326699
0.2302 --- loss: 1.306537, loss_ss: 0.839491, loss_d: 0.467046
0.2686 --- loss: 1.206550, loss_ss: 0.904014, loss_d: 0.302536
0.3070 --- loss: 1.486064, loss_ss: 0.835728, loss_d: 0.650337
0.3454 --- loss: 1.045416, loss_ss: 0.674939, loss_d: 0.370477
0.3837 --- loss: 1.289259, loss_ss: 0.946801, loss_d: 0.342459
0.4221 --- loss: 1.306416, loss_ss: 0.860218, loss_d: 0.446198
0.4605 --- loss: 1.285623, loss_ss: 0.740638, loss_d: 0.544985
0.4988 --- loss: 1.393013, loss_ss: 1.151315, loss_d: 0.241697
0.5372 --- loss: 1.256544, loss_ss: 0.845269, loss_d: 0.411275
0.5756 --- loss: 1.035488, loss_ss: 0.714401, loss_d: 0.321087
0.6140 --- loss: 1.518297, loss_ss: 0.726719, loss_d: 0.791578
0.6523 --- loss: 1.520343, loss_ss: 1.111958, loss_d: 0.408385
0.6907 --- loss: 1.603585, loss_ss: 1.036373, loss_d: 0.567212
0.7291 --- loss: 1.583365, loss_ss: 0.780652, loss_d: 0.802714
0.7675 --- loss: 1.138890, loss_ss: 0.737715, loss_d: 0.401175
0.8058 --- loss: 1.169494, loss_ss: 0.867864, loss_d: 0.301631
0.8442 --- loss: 1.725467, loss_ss: 0.968750, loss_d: 0.756717
0.8826 --- loss: 1.661429, loss_ss: 0.997842, loss_d: 0.663587
0.9210 --- loss: 1.216839, loss_ss: 0.789716, loss_d: 0.427123
0.9593 --- loss: 1.356524, loss_ss: 0.972282, loss_d: 0.384242
0.9977 --- loss: 1.676811, loss_ss: 1.358391, loss_d: 0.318421
Epoch finished! Loss: 1.3775982801730817
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.072599, loss_ss: 0.753057, loss_d: 0.319542
0.0384 --- loss: 1.133385, loss_ss: 0.819440, loss_d: 0.313945
0.0767 --- loss: 1.718783, loss_ss: 0.855702, loss_d: 0.863081
0.1151 --- loss: 1.611183, loss_ss: 1.150409, loss_d: 0.460775
0.1535 --- loss: 1.876304, loss_ss: 0.820481, loss_d: 1.055823
0.1919 --- loss: 1.295634, loss_ss: 0.735118, loss_d: 0.560517
0.2302 --- loss: 1.181239, loss_ss: 0.678183, loss_d: 0.503056
0.2686 --- loss: 1.131426, loss_ss: 0.814664, loss_d: 0.316762
0.3070 --- loss: 1.100723, loss_ss: 0.798017, loss_d: 0.302706
0.3454 --- loss: 1.073865, loss_ss: 0.687509, loss_d: 0.386356
0.3837 --- loss: 1.176290, loss_ss: 0.891359, loss_d: 0.284930
0.4221 --- loss: 1.612589, loss_ss: 0.994845, loss_d: 0.617744
0.4605 --- loss: 1.272179, loss_ss: 0.909377, loss_d: 0.362802
0.4988 --- loss: 1.197137, loss_ss: 0.816110, loss_d: 0.381027
0.5372 --- loss: 1.238979, loss_ss: 0.911560, loss_d: 0.327419
0.5756 --- loss: 1.329893, loss_ss: 0.876391, loss_d: 0.453501
0.6140 --- loss: 1.246363, loss_ss: 0.726872, loss_d: 0.519490
0.6523 --- loss: 1.911111, loss_ss: 1.223420, loss_d: 0.687691
0.6907 --- loss: 1.151006, loss_ss: 0.838957, loss_d: 0.312049
0.7291 --- loss: 1.547147, loss_ss: 1.084080, loss_d: 0.463067
0.7675 --- loss: 1.084463, loss_ss: 0.781065, loss_d: 0.303398
0.8058 --- loss: 1.054285, loss_ss: 0.782757, loss_d: 0.271528
0.8442 --- loss: 1.050328, loss_ss: 0.795952, loss_d: 0.254376
0.8826 --- loss: 1.034833, loss_ss: 0.786197, loss_d: 0.248636
0.9210 --- loss: 0.984469, loss_ss: 0.775674, loss_d: 0.208795
0.9593 --- loss: 1.081406, loss_ss: 0.744315, loss_d: 0.337090
0.9977 --- loss: 1.854318, loss_ss: 1.245078, loss_d: 0.609241
Epoch finished! Loss: 1.3120891958475114
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.366282, loss_ss: 0.883952, loss_d: 0.482330
0.0384 --- loss: 1.618902, loss_ss: 1.255552, loss_d: 0.363350
0.0767 --- loss: 1.286748, loss_ss: 0.939458, loss_d: 0.347290
0.1151 --- loss: 1.517378, loss_ss: 0.919599, loss_d: 0.597779
0.1535 --- loss: 1.237266, loss_ss: 0.764413, loss_d: 0.472853
0.1919 --- loss: 1.044441, loss_ss: 0.737189, loss_d: 0.307251
0.2302 --- loss: 1.065219, loss_ss: 0.733567, loss_d: 0.331652
0.2686 --- loss: 1.366705, loss_ss: 1.101986, loss_d: 0.264719
0.3070 --- loss: 1.579811, loss_ss: 1.210825, loss_d: 0.368987
0.3454 --- loss: 0.997002, loss_ss: 0.731390, loss_d: 0.265612
0.3837 --- loss: 1.735305, loss_ss: 0.769522, loss_d: 0.965783
0.4221 --- loss: 0.891113, loss_ss: 0.686840, loss_d: 0.204273
0.4605 --- loss: 1.340372, loss_ss: 0.768956, loss_d: 0.571416
0.4988 --- loss: 1.238275, loss_ss: 0.864956, loss_d: 0.373319
0.5372 --- loss: 1.345048, loss_ss: 0.936764, loss_d: 0.408285
0.5756 --- loss: 1.108033, loss_ss: 0.876287, loss_d: 0.231747
0.6140 --- loss: 1.935917, loss_ss: 0.932747, loss_d: 1.003171
0.6523 --- loss: 0.840436, loss_ss: 0.581977, loss_d: 0.258459
0.6907 --- loss: 0.945561, loss_ss: 0.698244, loss_d: 0.247317
0.7291 --- loss: 1.206847, loss_ss: 0.994983, loss_d: 0.211865
0.7675 --- loss: 0.828303, loss_ss: 0.589724, loss_d: 0.238578
0.8058 --- loss: 1.191693, loss_ss: 0.887881, loss_d: 0.303812
0.8442 --- loss: 1.122052, loss_ss: 0.756168, loss_d: 0.365884
0.8826 --- loss: 1.145002, loss_ss: 0.770356, loss_d: 0.374646
0.9210 --- loss: 1.246156, loss_ss: 0.928207, loss_d: 0.317949
0.9593 --- loss: 0.931944, loss_ss: 0.707817, loss_d: 0.224127
0.9977 --- loss: 1.800772, loss_ss: 1.112773, loss_d: 0.687999
Epoch finished! Loss: 1.2671766911561673
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.237482, loss_ss: 0.990078, loss_d: 0.247404
0.0384 --- loss: 1.419998, loss_ss: 1.215167, loss_d: 0.204830
0.0767 --- loss: 1.081713, loss_ss: 0.853756, loss_d: 0.227957
0.1151 --- loss: 1.105770, loss_ss: 0.771870, loss_d: 0.333900
0.1535 --- loss: 1.289127, loss_ss: 0.973853, loss_d: 0.315273
0.1919 --- loss: 1.607893, loss_ss: 0.967010, loss_d: 0.640884
0.2302 --- loss: 0.952220, loss_ss: 0.883985, loss_d: 0.068235
0.2686 --- loss: 1.366271, loss_ss: 0.848562, loss_d: 0.517709
0.3070 --- loss: 1.168677, loss_ss: 0.782419, loss_d: 0.386258
0.3454 --- loss: 1.200485, loss_ss: 0.764418, loss_d: 0.436067
0.3837 --- loss: 0.937531, loss_ss: 0.688208, loss_d: 0.249323
0.4221 --- loss: 1.137793, loss_ss: 1.005536, loss_d: 0.132257
0.4605 --- loss: 1.361500, loss_ss: 1.009703, loss_d: 0.351797
0.4988 --- loss: 1.148587, loss_ss: 0.712281, loss_d: 0.436306
0.5372 --- loss: 1.002353, loss_ss: 0.781811, loss_d: 0.220542
0.5756 --- loss: 1.109809, loss_ss: 0.811372, loss_d: 0.298437
0.6140 --- loss: 1.354103, loss_ss: 0.960444, loss_d: 0.393659
0.6523 --- loss: 1.128695, loss_ss: 0.831144, loss_d: 0.297551
0.6907 --- loss: 1.401777, loss_ss: 0.967465, loss_d: 0.434312
0.7291 --- loss: 2.277008, loss_ss: 0.905615, loss_d: 1.371393
0.7675 --- loss: 1.019973, loss_ss: 0.769557, loss_d: 0.250417
0.8058 --- loss: 1.322496, loss_ss: 1.160856, loss_d: 0.161640
0.8442 --- loss: 1.526408, loss_ss: 0.785740, loss_d: 0.740668
0.8826 --- loss: 1.614167, loss_ss: 0.780239, loss_d: 0.833928
0.9210 --- loss: 1.352630, loss_ss: 1.229549, loss_d: 0.123081
0.9593 --- loss: 1.219618, loss_ss: 0.694686, loss_d: 0.524932
0.9977 --- loss: 1.342211, loss_ss: 1.081424, loss_d: 0.260787
Epoch finished! Loss: 1.2027685919633277
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.860081, loss_ss: 0.586030, loss_d: 0.274051
0.0384 --- loss: 1.311570, loss_ss: 1.055297, loss_d: 0.256272
0.0767 --- loss: 0.815853, loss_ss: 0.693788, loss_d: 0.122065
0.1151 --- loss: 0.795693, loss_ss: 0.610223, loss_d: 0.185470
0.1535 --- loss: 0.890673, loss_ss: 0.670588, loss_d: 0.220085
0.1919 --- loss: 1.072291, loss_ss: 0.681283, loss_d: 0.391008
0.2302 --- loss: 1.189413, loss_ss: 0.946555, loss_d: 0.242858
0.2686 --- loss: 1.023257, loss_ss: 0.820966, loss_d: 0.202291
0.3070 --- loss: 1.333310, loss_ss: 1.092417, loss_d: 0.240892
0.3454 --- loss: 1.239904, loss_ss: 0.989900, loss_d: 0.250004
0.3837 --- loss: 1.068923, loss_ss: 0.840542, loss_d: 0.228381
0.4221 --- loss: 1.163262, loss_ss: 0.917018, loss_d: 0.246244
0.4605 --- loss: 1.820267, loss_ss: 0.832486, loss_d: 0.987782
0.4988 --- loss: 1.014502, loss_ss: 0.807161, loss_d: 0.207340
0.5372 --- loss: 0.727310, loss_ss: 0.603548, loss_d: 0.123763
0.5756 --- loss: 1.126178, loss_ss: 0.842059, loss_d: 0.284118
0.6140 --- loss: 1.233845, loss_ss: 0.810590, loss_d: 0.423255
0.6523 --- loss: 1.090765, loss_ss: 0.771581, loss_d: 0.319184
0.6907 --- loss: 1.129803, loss_ss: 0.916931, loss_d: 0.212872
0.7291 --- loss: 1.090297, loss_ss: 0.934268, loss_d: 0.156030
0.7675 --- loss: 0.897524, loss_ss: 0.716523, loss_d: 0.181001
0.8058 --- loss: 1.253445, loss_ss: 0.858362, loss_d: 0.395083
0.8442 --- loss: 1.332391, loss_ss: 0.865075, loss_d: 0.467316
0.8826 --- loss: 1.210671, loss_ss: 0.823484, loss_d: 0.387187
0.9210 --- loss: 0.935363, loss_ss: 0.767343, loss_d: 0.168019
0.9593 --- loss: 1.489110, loss_ss: 0.987071, loss_d: 0.502040
0.9977 --- loss: 1.574177, loss_ss: 0.903362, loss_d: 0.670814
Epoch finished! Loss: 1.1599082194841825
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.621875
             precision    recall  f1-score   support

        0.0       0.79      0.36      0.50       135
        1.0       0.23      0.13      0.16       141
        2.0       0.59      0.93      0.72       354
        3.0       0.94      0.60      0.73       197
        4.0       0.61      0.63      0.62       133

avg / total       0.64      0.62      0.60       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.69  36.30   98.42  79.03     49.75
1  80.94  12.77   92.67  23.08     16.44
2  73.44  92.66   62.21  58.89     72.01
3  90.94  59.90   98.95  93.65     73.07
4  89.38  63.16   93.59  61.31     62.22
Total accuracy: 62.19%
Average sen: 52.95%
Average spec: 89.17%
Macro f1-score: 54.70%
[0.99812609 0.99571204 0.99373078 0.9889015  0.99677867 0.99512488
 0.99780864 0.99759066 0.99849761 0.99828231 0.99896371 0.99762863
 0.99543911 0.99885964 0.99639589 0.99884206 0.99956745 0.99582714
 0.99864489 0.98954773 0.99880409 0.98577487 0.99360955 0.99812573
 0.99893695 0.99715662 0.99436885 0.99551082 0.98019892 0.98740244
 0.99630404 0.987571  ]
pred: 0.9951260406523943, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.449243, loss_ss: 1.789969, loss_d: 0.659274
0.0385 --- loss: 2.209805, loss_ss: 1.653392, loss_d: 0.556412
0.0771 --- loss: 2.348642, loss_ss: 1.597148, loss_d: 0.751494
0.1156 --- loss: 2.158839, loss_ss: 1.422108, loss_d: 0.736732
0.1541 --- loss: 2.347189, loss_ss: 1.504909, loss_d: 0.842280
0.1927 --- loss: 2.230746, loss_ss: 1.590549, loss_d: 0.640196
0.2312 --- loss: 1.933871, loss_ss: 1.317038, loss_d: 0.616833
0.2697 --- loss: 1.911775, loss_ss: 1.369415, loss_d: 0.542360
0.3083 --- loss: 2.233296, loss_ss: 1.386296, loss_d: 0.847000
0.3468 --- loss: 2.307119, loss_ss: 1.642468, loss_d: 0.664651
0.3854 --- loss: 1.916622, loss_ss: 1.346475, loss_d: 0.570147
0.4239 --- loss: 1.939040, loss_ss: 1.352108, loss_d: 0.586933
0.4624 --- loss: 1.721095, loss_ss: 1.376824, loss_d: 0.344271
0.5010 --- loss: 2.112330, loss_ss: 1.332184, loss_d: 0.780146
0.5395 --- loss: 2.434634, loss_ss: 1.509391, loss_d: 0.925243
0.5780 --- loss: 1.877200, loss_ss: 1.214626, loss_d: 0.662574
0.6166 --- loss: 1.931519, loss_ss: 1.226873, loss_d: 0.704646
0.6551 --- loss: 2.056485, loss_ss: 1.449748, loss_d: 0.606737
0.6936 --- loss: 1.739445, loss_ss: 1.287984, loss_d: 0.451460
0.7322 --- loss: 2.042009, loss_ss: 1.615177, loss_d: 0.426832
0.7707 --- loss: 1.774801, loss_ss: 1.188447, loss_d: 0.586354
0.8092 --- loss: 2.185961, loss_ss: 1.310900, loss_d: 0.875061
0.8478 --- loss: 2.026840, loss_ss: 1.436331, loss_d: 0.590509
0.8863 --- loss: 1.594192, loss_ss: 1.115392, loss_d: 0.478800
0.9249 --- loss: 1.846384, loss_ss: 1.279159, loss_d: 0.567225
0.9634 --- loss: 1.748560, loss_ss: 1.200542, loss_d: 0.548018
Epoch finished! Loss: 1.9545453128667412
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.497264, loss_ss: 1.160926, loss_d: 0.336339
0.0385 --- loss: 1.669549, loss_ss: 1.175110, loss_d: 0.494439
0.0771 --- loss: 1.845911, loss_ss: 1.243840, loss_d: 0.602071
0.1156 --- loss: 2.118594, loss_ss: 1.436289, loss_d: 0.682305
0.1541 --- loss: 1.641711, loss_ss: 1.114496, loss_d: 0.527214
0.1927 --- loss: 1.895499, loss_ss: 1.348201, loss_d: 0.547298
0.2312 --- loss: 1.747658, loss_ss: 1.112526, loss_d: 0.635132
0.2697 --- loss: 1.780475, loss_ss: 1.084616, loss_d: 0.695859
0.3083 --- loss: 1.520120, loss_ss: 1.105285, loss_d: 0.414835
0.3468 --- loss: 1.786166, loss_ss: 0.982178, loss_d: 0.803988
0.3854 --- loss: 1.704904, loss_ss: 1.151934, loss_d: 0.552970
0.4239 --- loss: 1.652879, loss_ss: 1.067014, loss_d: 0.585865
0.4624 --- loss: 1.965363, loss_ss: 1.227837, loss_d: 0.737526
0.5010 --- loss: 1.932048, loss_ss: 1.111135, loss_d: 0.820913
0.5395 --- loss: 1.678595, loss_ss: 1.090253, loss_d: 0.588342
0.5780 --- loss: 1.457774, loss_ss: 1.033782, loss_d: 0.423992
0.6166 --- loss: 1.572879, loss_ss: 1.072762, loss_d: 0.500117
0.6551 --- loss: 1.775533, loss_ss: 1.260563, loss_d: 0.514970
0.6936 --- loss: 1.639342, loss_ss: 0.881773, loss_d: 0.757569
0.7322 --- loss: 1.498006, loss_ss: 1.143802, loss_d: 0.354204
0.7707 --- loss: 1.584099, loss_ss: 1.148758, loss_d: 0.435342
0.8092 --- loss: 1.590880, loss_ss: 1.062008, loss_d: 0.528872
0.8478 --- loss: 2.140777, loss_ss: 1.430886, loss_d: 0.709891
0.8863 --- loss: 1.377121, loss_ss: 0.832160, loss_d: 0.544961
0.9249 --- loss: 1.396040, loss_ss: 0.922526, loss_d: 0.473514
0.9634 --- loss: 1.349340, loss_ss: 1.034190, loss_d: 0.315150
Epoch finished! Loss: 1.711032330759704
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.700802, loss_ss: 0.892420, loss_d: 0.808383
0.0385 --- loss: 1.686083, loss_ss: 1.219375, loss_d: 0.466707
0.0771 --- loss: 1.593566, loss_ss: 1.033156, loss_d: 0.560411
0.1156 --- loss: 1.349797, loss_ss: 1.020840, loss_d: 0.328958
0.1541 --- loss: 1.799060, loss_ss: 1.282019, loss_d: 0.517041
0.1927 --- loss: 1.247220, loss_ss: 0.766619, loss_d: 0.480601
0.2312 --- loss: 1.643757, loss_ss: 0.994071, loss_d: 0.649686
0.2697 --- loss: 1.417340, loss_ss: 1.123281, loss_d: 0.294059
0.3083 --- loss: 1.623361, loss_ss: 0.999489, loss_d: 0.623872
0.3468 --- loss: 1.797078, loss_ss: 1.201581, loss_d: 0.595497
0.3854 --- loss: 1.441857, loss_ss: 1.065694, loss_d: 0.376163
0.4239 --- loss: 1.628617, loss_ss: 1.141844, loss_d: 0.486774
0.4624 --- loss: 1.601294, loss_ss: 0.993138, loss_d: 0.608157
0.5010 --- loss: 1.591182, loss_ss: 0.983969, loss_d: 0.607213
0.5395 --- loss: 1.503898, loss_ss: 0.980293, loss_d: 0.523605
0.5780 --- loss: 1.141952, loss_ss: 0.829660, loss_d: 0.312293
0.6166 --- loss: 1.679352, loss_ss: 1.104673, loss_d: 0.574679
0.6551 --- loss: 1.594054, loss_ss: 0.875625, loss_d: 0.718429
0.6936 --- loss: 1.551938, loss_ss: 1.088506, loss_d: 0.463432
0.7322 --- loss: 1.642270, loss_ss: 1.162672, loss_d: 0.479597
0.7707 --- loss: 1.637723, loss_ss: 0.944516, loss_d: 0.693207
0.8092 --- loss: 1.751312, loss_ss: 1.220916, loss_d: 0.530397
0.8478 --- loss: 1.485079, loss_ss: 0.972191, loss_d: 0.512888
0.8863 --- loss: 1.468690, loss_ss: 0.858832, loss_d: 0.609858
0.9249 --- loss: 1.588457, loss_ss: 0.942565, loss_d: 0.645893
0.9634 --- loss: 1.284454, loss_ss: 0.982326, loss_d: 0.302127
Epoch finished! Loss: 1.609400887286801
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.251995, loss_ss: 0.791642, loss_d: 0.460352
0.0385 --- loss: 1.265985, loss_ss: 0.834775, loss_d: 0.431211
0.0771 --- loss: 1.629429, loss_ss: 1.003026, loss_d: 0.626404
0.1156 --- loss: 1.159863, loss_ss: 0.837670, loss_d: 0.322193
0.1541 --- loss: 1.410584, loss_ss: 0.908959, loss_d: 0.501625
0.1927 --- loss: 1.296353, loss_ss: 0.979127, loss_d: 0.317226
0.2312 --- loss: 1.685497, loss_ss: 1.220425, loss_d: 0.465072
0.2697 --- loss: 1.821589, loss_ss: 1.370853, loss_d: 0.450736
0.3083 --- loss: 1.670509, loss_ss: 0.956766, loss_d: 0.713743
0.3468 --- loss: 1.588094, loss_ss: 1.004881, loss_d: 0.583213
0.3854 --- loss: 1.491006, loss_ss: 1.047443, loss_d: 0.443564
0.4239 --- loss: 1.312511, loss_ss: 0.890541, loss_d: 0.421970
0.4624 --- loss: 1.717102, loss_ss: 1.251937, loss_d: 0.465165
0.5010 --- loss: 1.369587, loss_ss: 0.894310, loss_d: 0.475277
0.5395 --- loss: 1.439855, loss_ss: 0.970451, loss_d: 0.469405
0.5780 --- loss: 1.595667, loss_ss: 1.162187, loss_d: 0.433480
0.6166 --- loss: 1.607731, loss_ss: 0.798671, loss_d: 0.809060
0.6551 --- loss: 1.493119, loss_ss: 1.075860, loss_d: 0.417259
0.6936 --- loss: 1.570842, loss_ss: 1.132000, loss_d: 0.438842
0.7322 --- loss: 1.434325, loss_ss: 1.030929, loss_d: 0.403396
0.7707 --- loss: 1.592287, loss_ss: 1.222707, loss_d: 0.369580
0.8092 --- loss: 1.389790, loss_ss: 0.934037, loss_d: 0.455753
0.8478 --- loss: 1.591207, loss_ss: 0.856612, loss_d: 0.734595
0.8863 --- loss: 1.518840, loss_ss: 0.904695, loss_d: 0.614145
0.9249 --- loss: 1.591173, loss_ss: 0.854500, loss_d: 0.736674
0.9634 --- loss: 1.664551, loss_ss: 0.893657, loss_d: 0.770894
Epoch finished! Loss: 1.5343089499528804
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.155643, loss_ss: 0.809599, loss_d: 0.346043
0.0385 --- loss: 1.625584, loss_ss: 1.001219, loss_d: 0.624365
0.0771 --- loss: 1.312100, loss_ss: 1.007150, loss_d: 0.304950
0.1156 --- loss: 1.499015, loss_ss: 0.944524, loss_d: 0.554491
0.1541 --- loss: 1.534318, loss_ss: 1.058698, loss_d: 0.475619
0.1927 --- loss: 1.394203, loss_ss: 1.215040, loss_d: 0.179163
0.2312 --- loss: 1.334991, loss_ss: 1.044026, loss_d: 0.290965
0.2697 --- loss: 2.467594, loss_ss: 1.686254, loss_d: 0.781340
0.3083 --- loss: 1.405938, loss_ss: 0.994942, loss_d: 0.410996
0.3468 --- loss: 1.324774, loss_ss: 1.010693, loss_d: 0.314081
0.3854 --- loss: 1.420415, loss_ss: 0.952263, loss_d: 0.468152
0.4239 --- loss: 1.026630, loss_ss: 0.761573, loss_d: 0.265057
0.4624 --- loss: 1.774882, loss_ss: 0.972745, loss_d: 0.802137
0.5010 --- loss: 1.705507, loss_ss: 1.335310, loss_d: 0.370197
0.5395 --- loss: 1.880612, loss_ss: 1.089616, loss_d: 0.790996
0.5780 --- loss: 1.331474, loss_ss: 0.931889, loss_d: 0.399585
0.6166 --- loss: 1.241971, loss_ss: 0.819776, loss_d: 0.422194
0.6551 --- loss: 1.134900, loss_ss: 0.873672, loss_d: 0.261228
0.6936 --- loss: 1.624986, loss_ss: 0.930621, loss_d: 0.694365
0.7322 --- loss: 1.120800, loss_ss: 0.892131, loss_d: 0.228669
0.7707 --- loss: 1.365110, loss_ss: 0.936659, loss_d: 0.428451
0.8092 --- loss: 1.073822, loss_ss: 0.813902, loss_d: 0.259921
0.8478 --- loss: 1.496286, loss_ss: 1.051503, loss_d: 0.444784
0.8863 --- loss: 1.001985, loss_ss: 0.713610, loss_d: 0.288375
0.9249 --- loss: 1.298495, loss_ss: 1.082415, loss_d: 0.216081
0.9634 --- loss: 1.370719, loss_ss: 1.179410, loss_d: 0.191309
Epoch finished! Loss: 1.4122017654212746
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.439345, loss_ss: 0.769930, loss_d: 0.669415
0.0385 --- loss: 1.366143, loss_ss: 0.805158, loss_d: 0.560984
0.0771 --- loss: 1.129715, loss_ss: 0.949160, loss_d: 0.180555
0.1156 --- loss: 1.868652, loss_ss: 1.231519, loss_d: 0.637133
0.1541 --- loss: 1.318452, loss_ss: 0.883659, loss_d: 0.434793
0.1927 --- loss: 1.017291, loss_ss: 0.654785, loss_d: 0.362506
0.2312 --- loss: 1.337134, loss_ss: 0.883376, loss_d: 0.453758
0.2697 --- loss: 1.172241, loss_ss: 0.730538, loss_d: 0.441703
0.3083 --- loss: 1.875296, loss_ss: 1.235272, loss_d: 0.640024
0.3468 --- loss: 1.412695, loss_ss: 0.996259, loss_d: 0.416436
0.3854 --- loss: 1.327664, loss_ss: 1.045874, loss_d: 0.281790
0.4239 --- loss: 1.191211, loss_ss: 0.912493, loss_d: 0.278718
0.4624 --- loss: 1.225155, loss_ss: 0.949448, loss_d: 0.275708
0.5010 --- loss: 0.911462, loss_ss: 0.712272, loss_d: 0.199190
0.5395 --- loss: 1.448365, loss_ss: 1.204932, loss_d: 0.243433
0.5780 --- loss: 1.364675, loss_ss: 0.927140, loss_d: 0.437535
0.6166 --- loss: 1.221476, loss_ss: 0.792127, loss_d: 0.429350
0.6551 --- loss: 1.424782, loss_ss: 0.959790, loss_d: 0.464992
0.6936 --- loss: 1.374109, loss_ss: 0.915234, loss_d: 0.458875
0.7322 --- loss: 1.004821, loss_ss: 0.784161, loss_d: 0.220661
0.7707 --- loss: 1.350941, loss_ss: 1.102360, loss_d: 0.248581
0.8092 --- loss: 1.489926, loss_ss: 0.810514, loss_d: 0.679412
0.8478 --- loss: 1.007173, loss_ss: 0.653231, loss_d: 0.353941
0.8863 --- loss: 1.312294, loss_ss: 0.968377, loss_d: 0.343917
0.9249 --- loss: 1.070361, loss_ss: 0.869286, loss_d: 0.201075
0.9634 --- loss: 1.135738, loss_ss: 0.783910, loss_d: 0.351828
Epoch finished! Loss: 1.3444016011985573
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.063166, loss_ss: 0.819262, loss_d: 0.243904
0.0385 --- loss: 1.186829, loss_ss: 0.872153, loss_d: 0.314676
0.0771 --- loss: 1.045660, loss_ss: 0.749403, loss_d: 0.296257
0.1156 --- loss: 1.121544, loss_ss: 0.945849, loss_d: 0.175695
0.1541 --- loss: 1.080242, loss_ss: 0.908533, loss_d: 0.171709
0.1927 --- loss: 1.007846, loss_ss: 0.827748, loss_d: 0.180098
0.2312 --- loss: 1.659388, loss_ss: 1.043559, loss_d: 0.615829
0.2697 --- loss: 1.739741, loss_ss: 1.304637, loss_d: 0.435104
0.3083 --- loss: 1.121808, loss_ss: 0.683541, loss_d: 0.438267
0.3468 --- loss: 0.855451, loss_ss: 0.687793, loss_d: 0.167658
0.3854 --- loss: 1.020755, loss_ss: 0.874783, loss_d: 0.145972
0.4239 --- loss: 0.869642, loss_ss: 0.713702, loss_d: 0.155940
0.4624 --- loss: 1.002219, loss_ss: 0.877674, loss_d: 0.124546
0.5010 --- loss: 1.057214, loss_ss: 0.858715, loss_d: 0.198499
0.5395 --- loss: 1.074364, loss_ss: 0.835806, loss_d: 0.238557
0.5780 --- loss: 0.912378, loss_ss: 0.706900, loss_d: 0.205478
0.6166 --- loss: 1.529054, loss_ss: 1.362625, loss_d: 0.166429
0.6551 --- loss: 1.322297, loss_ss: 0.956136, loss_d: 0.366161
0.6936 --- loss: 1.366188, loss_ss: 0.887349, loss_d: 0.478839
0.7322 --- loss: 0.831368, loss_ss: 0.635340, loss_d: 0.196027
0.7707 --- loss: 1.258150, loss_ss: 1.084471, loss_d: 0.173678
0.8092 --- loss: 1.887102, loss_ss: 1.292076, loss_d: 0.595026
0.8478 --- loss: 1.285080, loss_ss: 0.784476, loss_d: 0.500605
0.8863 --- loss: 1.141585, loss_ss: 0.887823, loss_d: 0.253762
0.9249 --- loss: 1.424344, loss_ss: 0.883701, loss_d: 0.540643
0.9634 --- loss: 0.977289, loss_ss: 0.729355, loss_d: 0.247934
Epoch finished! Loss: 1.2614249299391815
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.555464, loss_ss: 1.037546, loss_d: 0.517918
0.0385 --- loss: 1.019756, loss_ss: 0.767301, loss_d: 0.252455
0.0771 --- loss: 1.171595, loss_ss: 1.045523, loss_d: 0.126072
0.1156 --- loss: 1.411583, loss_ss: 1.267441, loss_d: 0.144142
0.1541 --- loss: 0.976741, loss_ss: 0.831050, loss_d: 0.145691
0.1927 --- loss: 1.341966, loss_ss: 0.835020, loss_d: 0.506945
0.2312 --- loss: 0.974371, loss_ss: 0.813037, loss_d: 0.161334
0.2697 --- loss: 1.308881, loss_ss: 1.102188, loss_d: 0.206693
0.3083 --- loss: 1.703139, loss_ss: 0.984148, loss_d: 0.718992
0.3468 --- loss: 1.020584, loss_ss: 0.806801, loss_d: 0.213784
0.3854 --- loss: 1.437216, loss_ss: 0.928553, loss_d: 0.508663
0.4239 --- loss: 0.915065, loss_ss: 0.577988, loss_d: 0.337077
0.4624 --- loss: 0.812216, loss_ss: 0.627593, loss_d: 0.184622
0.5010 --- loss: 1.231478, loss_ss: 0.895272, loss_d: 0.336206
0.5395 --- loss: 0.883456, loss_ss: 0.673789, loss_d: 0.209667
0.5780 --- loss: 0.881442, loss_ss: 0.790304, loss_d: 0.091138
0.6166 --- loss: 1.075811, loss_ss: 0.893879, loss_d: 0.181932
0.6551 --- loss: 1.114081, loss_ss: 0.844190, loss_d: 0.269891
0.6936 --- loss: 0.925786, loss_ss: 0.722726, loss_d: 0.203060
0.7322 --- loss: 0.976513, loss_ss: 0.638898, loss_d: 0.337615
0.7707 --- loss: 1.152726, loss_ss: 0.889075, loss_d: 0.263651
0.8092 --- loss: 1.460181, loss_ss: 0.902985, loss_d: 0.557196
0.8478 --- loss: 1.037019, loss_ss: 0.811535, loss_d: 0.225484
0.8863 --- loss: 1.213104, loss_ss: 0.787660, loss_d: 0.425445
0.9249 --- loss: 1.506607, loss_ss: 1.022717, loss_d: 0.483890
0.9634 --- loss: 0.973338, loss_ss: 0.823980, loss_d: 0.149358
Epoch finished! Loss: 1.216359376677215
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.089068, loss_ss: 0.882636, loss_d: 0.206432
0.0385 --- loss: 1.163334, loss_ss: 0.619276, loss_d: 0.544058
0.0771 --- loss: 1.352636, loss_ss: 0.795665, loss_d: 0.556971
0.1156 --- loss: 1.319696, loss_ss: 1.075848, loss_d: 0.243848
0.1541 --- loss: 1.007173, loss_ss: 0.930522, loss_d: 0.076651
0.1927 --- loss: 1.067172, loss_ss: 0.851457, loss_d: 0.215714
0.2312 --- loss: 1.217019, loss_ss: 0.892487, loss_d: 0.324532
0.2697 --- loss: 0.907811, loss_ss: 0.733372, loss_d: 0.174439
0.3083 --- loss: 1.331944, loss_ss: 1.240839, loss_d: 0.091104
0.3468 --- loss: 1.465798, loss_ss: 1.009038, loss_d: 0.456761
0.3854 --- loss: 0.759258, loss_ss: 0.649137, loss_d: 0.110121
0.4239 --- loss: 1.077456, loss_ss: 0.794376, loss_d: 0.283080
0.4624 --- loss: 1.162659, loss_ss: 0.689850, loss_d: 0.472809
0.5010 --- loss: 0.711127, loss_ss: 0.614816, loss_d: 0.096311
0.5395 --- loss: 1.218706, loss_ss: 0.986949, loss_d: 0.231757
0.5780 --- loss: 1.068897, loss_ss: 0.931333, loss_d: 0.137564
0.6166 --- loss: 0.988444, loss_ss: 0.888655, loss_d: 0.099789
0.6551 --- loss: 1.150414, loss_ss: 0.840034, loss_d: 0.310380
0.6936 --- loss: 1.715095, loss_ss: 1.059571, loss_d: 0.655524
0.7322 --- loss: 1.320886, loss_ss: 1.073058, loss_d: 0.247828
0.7707 --- loss: 1.207435, loss_ss: 0.962642, loss_d: 0.244793
0.8092 --- loss: 1.184638, loss_ss: 0.920059, loss_d: 0.264579
0.8478 --- loss: 0.979066, loss_ss: 0.833349, loss_d: 0.145717
0.8863 --- loss: 1.298981, loss_ss: 0.904946, loss_d: 0.394035
0.9249 --- loss: 1.718463, loss_ss: 0.881655, loss_d: 0.836809
0.9634 --- loss: 1.106092, loss_ss: 0.782418, loss_d: 0.323674
Epoch finished! Loss: 1.180338248783097
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.232839, loss_ss: 0.723328, loss_d: 0.509511
0.0385 --- loss: 0.877609, loss_ss: 0.717334, loss_d: 0.160275
0.0771 --- loss: 1.115144, loss_ss: 0.878177, loss_d: 0.236967
0.1156 --- loss: 0.878490, loss_ss: 0.744953, loss_d: 0.133537
0.1541 --- loss: 0.930268, loss_ss: 0.688331, loss_d: 0.241937
0.1927 --- loss: 1.116095, loss_ss: 0.858431, loss_d: 0.257664
0.2312 --- loss: 1.268501, loss_ss: 0.863364, loss_d: 0.405137
0.2697 --- loss: 1.584168, loss_ss: 1.083206, loss_d: 0.500962
0.3083 --- loss: 1.019874, loss_ss: 0.859094, loss_d: 0.160781
0.3468 --- loss: 1.050597, loss_ss: 0.855372, loss_d: 0.195225
0.3854 --- loss: 1.333180, loss_ss: 0.962719, loss_d: 0.370461
0.4239 --- loss: 0.953009, loss_ss: 0.776285, loss_d: 0.176724
0.4624 --- loss: 1.097347, loss_ss: 0.950142, loss_d: 0.147206
0.5010 --- loss: 0.879383, loss_ss: 0.778546, loss_d: 0.100837
0.5395 --- loss: 1.288232, loss_ss: 1.098587, loss_d: 0.189646
0.5780 --- loss: 1.603449, loss_ss: 0.839780, loss_d: 0.763669
0.6166 --- loss: 1.260443, loss_ss: 1.006463, loss_d: 0.253979
0.6551 --- loss: 1.279179, loss_ss: 0.807608, loss_d: 0.471571
0.6936 --- loss: 0.913696, loss_ss: 0.736635, loss_d: 0.177061
0.7322 --- loss: 0.917658, loss_ss: 0.729829, loss_d: 0.187829
0.7707 --- loss: 0.901747, loss_ss: 0.742681, loss_d: 0.159067
0.8092 --- loss: 1.488592, loss_ss: 0.861913, loss_d: 0.626679
0.8478 --- loss: 0.945669, loss_ss: 0.797210, loss_d: 0.148460
0.8863 --- loss: 1.048020, loss_ss: 0.740835, loss_d: 0.307185
0.9249 --- loss: 1.686526, loss_ss: 0.985220, loss_d: 0.701306
0.9634 --- loss: 1.061158, loss_ss: 0.616371, loss_d: 0.444787
Epoch finished! Loss: 1.1729974065508162
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.610077519379845
             precision    recall  f1-score   support

        0.0       0.31      0.64      0.42        69
        1.0       0.85      0.05      0.09       238
        2.0       0.65      0.78      0.71       565
        3.0       0.55      1.00      0.71       136
        4.0       0.76      0.54      0.63       282

avg / total       0.68      0.61      0.56      1290
 


====== chp005-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  90.47   63.77   91.97  30.99     41.71
1  82.25    4.62   99.81  84.62      8.76
2  71.71   78.41   66.48  64.58     70.82
3  91.32  100.00   90.29  54.84     70.83
4  86.28   54.26   95.24  76.12     63.35
Total accuracy: 61.01%
Average sen: 60.21%
Average spec: 88.76%
Macro f1-score: 51.10%
[0.78001064 0.80142969 0.90128827 0.93543291 0.96877855 0.98246682
 0.98022318 0.82358479 0.87400919 0.96693158 0.96495527 0.97001362
 0.90806115 0.93346673 0.96782625 0.94814879 0.97627074 0.95952129
 0.98421812 0.98401999 0.98992831 0.99105632 0.95730793 0.99849308
 0.95323944 0.9854452  0.9638716  0.97967637 0.95552939 0.98570013
 0.97606349 0.94843447 0.9522208  0.97143066 0.90698206 0.98847991
 0.96817714 0.32490298 0.94938809 0.96558994 0.99463838 0.95368928
 0.95444018]
pred: 0.9354730865289999, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.148123, loss_ss: 1.518546, loss_d: 0.629577
0.0384 --- loss: 2.034847, loss_ss: 1.391163, loss_d: 0.643683
0.0769 --- loss: 2.113082, loss_ss: 1.462222, loss_d: 0.650860
0.1153 --- loss: 1.955538, loss_ss: 1.442496, loss_d: 0.513041
0.1537 --- loss: 1.710061, loss_ss: 1.209715, loss_d: 0.500347
0.1922 --- loss: 2.093242, loss_ss: 1.223957, loss_d: 0.869285
0.2306 --- loss: 1.941861, loss_ss: 1.192275, loss_d: 0.749585
0.2690 --- loss: 2.068978, loss_ss: 1.501817, loss_d: 0.567161
0.3075 --- loss: 1.987425, loss_ss: 1.311522, loss_d: 0.675903
0.3459 --- loss: 2.234357, loss_ss: 1.322258, loss_d: 0.912098
0.3843 --- loss: 1.913307, loss_ss: 1.225162, loss_d: 0.688146
0.4228 --- loss: 1.763236, loss_ss: 1.420753, loss_d: 0.342483
0.4612 --- loss: 2.253642, loss_ss: 1.447178, loss_d: 0.806464
0.4996 --- loss: 1.943128, loss_ss: 1.238123, loss_d: 0.705005
0.5380 --- loss: 1.649280, loss_ss: 1.266785, loss_d: 0.382495
0.5765 --- loss: 1.604992, loss_ss: 1.212687, loss_d: 0.392305
0.6149 --- loss: 1.923084, loss_ss: 1.215268, loss_d: 0.707816
0.6533 --- loss: 2.150774, loss_ss: 1.521973, loss_d: 0.628801
0.6918 --- loss: 2.013214, loss_ss: 1.284298, loss_d: 0.728915
0.7302 --- loss: 1.878015, loss_ss: 1.098932, loss_d: 0.779084
0.7686 --- loss: 1.922486, loss_ss: 1.283111, loss_d: 0.639375
0.8071 --- loss: 1.805874, loss_ss: 1.176159, loss_d: 0.629715
0.8455 --- loss: 2.006873, loss_ss: 1.098299, loss_d: 0.908574
0.8839 --- loss: 1.709760, loss_ss: 1.200146, loss_d: 0.509614
0.9224 --- loss: 1.762342, loss_ss: 1.331636, loss_d: 0.430706
0.9608 --- loss: 1.796397, loss_ss: 1.096454, loss_d: 0.699943
0.9992 --- loss: 2.848997, loss_ss: 1.759325, loss_d: 1.089672
Epoch finished! Loss: 1.8868948647609123
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.166325, loss_ss: 1.564868, loss_d: 0.601456
0.0384 --- loss: 1.795131, loss_ss: 1.102909, loss_d: 0.692222
0.0769 --- loss: 1.535437, loss_ss: 1.023090, loss_d: 0.512346
0.1153 --- loss: 1.832893, loss_ss: 1.215834, loss_d: 0.617059
0.1537 --- loss: 1.569381, loss_ss: 1.128255, loss_d: 0.441126
0.1922 --- loss: 1.517592, loss_ss: 1.129292, loss_d: 0.388300
0.2306 --- loss: 1.523688, loss_ss: 1.047856, loss_d: 0.475831
0.2690 --- loss: 1.831574, loss_ss: 1.086186, loss_d: 0.745387
0.3075 --- loss: 1.646423, loss_ss: 1.001043, loss_d: 0.645380
0.3459 --- loss: 1.535488, loss_ss: 1.092958, loss_d: 0.442530
0.3843 --- loss: 1.702938, loss_ss: 1.076780, loss_d: 0.626158
0.4228 --- loss: 1.506396, loss_ss: 1.067825, loss_d: 0.438571
0.4612 --- loss: 1.629116, loss_ss: 1.278486, loss_d: 0.350631
0.4996 --- loss: 1.850036, loss_ss: 1.090095, loss_d: 0.759942
0.5380 --- loss: 2.258906, loss_ss: 1.489094, loss_d: 0.769812
0.5765 --- loss: 1.478086, loss_ss: 1.064057, loss_d: 0.414029
0.6149 --- loss: 1.631586, loss_ss: 1.122027, loss_d: 0.509558
0.6533 --- loss: 1.695170, loss_ss: 1.190450, loss_d: 0.504720
0.6918 --- loss: 1.658688, loss_ss: 1.293988, loss_d: 0.364700
0.7302 --- loss: 1.686983, loss_ss: 1.039593, loss_d: 0.647390
0.7686 --- loss: 1.739638, loss_ss: 0.891685, loss_d: 0.847954
0.8071 --- loss: 1.364412, loss_ss: 0.912643, loss_d: 0.451769
0.8455 --- loss: 1.558418, loss_ss: 1.044472, loss_d: 0.513945
0.8839 --- loss: 1.420786, loss_ss: 1.161871, loss_d: 0.258915
0.9224 --- loss: 1.706671, loss_ss: 1.128506, loss_d: 0.578165
0.9608 --- loss: 1.118410, loss_ss: 0.763562, loss_d: 0.354847
0.9992 --- loss: 2.302685, loss_ss: 1.884832, loss_d: 0.417853
Epoch finished! Loss: 1.680042952299118
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.459999, loss_ss: 0.990793, loss_d: 0.469207
0.0384 --- loss: 1.829259, loss_ss: 1.198177, loss_d: 0.631082
0.0769 --- loss: 1.316990, loss_ss: 0.954406, loss_d: 0.362584
0.1153 --- loss: 1.230774, loss_ss: 0.883130, loss_d: 0.347644
0.1537 --- loss: 1.787312, loss_ss: 0.860550, loss_d: 0.926762
0.1922 --- loss: 1.211016, loss_ss: 0.780972, loss_d: 0.430044
0.2306 --- loss: 1.915364, loss_ss: 1.433837, loss_d: 0.481527
0.2690 --- loss: 1.453393, loss_ss: 0.981421, loss_d: 0.471972
0.3075 --- loss: 1.427065, loss_ss: 0.911298, loss_d: 0.515767
0.3459 --- loss: 1.466487, loss_ss: 1.035911, loss_d: 0.430576
0.3843 --- loss: 1.741878, loss_ss: 1.107691, loss_d: 0.634187
0.4228 --- loss: 1.510540, loss_ss: 1.046718, loss_d: 0.463822
0.4612 --- loss: 1.555842, loss_ss: 1.063663, loss_d: 0.492179
0.4996 --- loss: 1.567979, loss_ss: 1.153670, loss_d: 0.414309
0.5380 --- loss: 1.574493, loss_ss: 0.945119, loss_d: 0.629374
0.5765 --- loss: 1.336654, loss_ss: 0.933475, loss_d: 0.403178
0.6149 --- loss: 1.580063, loss_ss: 0.804691, loss_d: 0.775372
0.6533 --- loss: 1.245432, loss_ss: 0.788320, loss_d: 0.457112
0.6918 --- loss: 1.429497, loss_ss: 1.063403, loss_d: 0.366095
0.7302 --- loss: 1.449889, loss_ss: 0.966087, loss_d: 0.483802
0.7686 --- loss: 1.333192, loss_ss: 1.066767, loss_d: 0.266425
0.8071 --- loss: 1.092476, loss_ss: 0.837096, loss_d: 0.255380
0.8455 --- loss: 1.542356, loss_ss: 1.285058, loss_d: 0.257298
0.8839 --- loss: 1.418987, loss_ss: 0.914137, loss_d: 0.504850
0.9224 --- loss: 1.239726, loss_ss: 0.871927, loss_d: 0.367798
0.9608 --- loss: 1.808362, loss_ss: 1.343915, loss_d: 0.464447
0.9992 --- loss: 1.679623, loss_ss: 1.432726, loss_d: 0.246897
Epoch finished! Loss: 1.5672772843104141
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.433506, loss_ss: 0.886643, loss_d: 0.546862
0.0384 --- loss: 1.382113, loss_ss: 0.979021, loss_d: 0.403092
0.0769 --- loss: 1.693879, loss_ss: 0.906265, loss_d: 0.787615
0.1153 --- loss: 1.895977, loss_ss: 1.444460, loss_d: 0.451517
0.1537 --- loss: 1.521159, loss_ss: 1.057734, loss_d: 0.463424
0.1922 --- loss: 1.523542, loss_ss: 1.092736, loss_d: 0.430806
0.2306 --- loss: 1.658622, loss_ss: 1.157753, loss_d: 0.500868
0.2690 --- loss: 1.130262, loss_ss: 0.845954, loss_d: 0.284308
0.3075 --- loss: 2.369339, loss_ss: 1.333830, loss_d: 1.035509
0.3459 --- loss: 1.291797, loss_ss: 0.804619, loss_d: 0.487178
0.3843 --- loss: 1.279371, loss_ss: 0.712868, loss_d: 0.566503
0.4228 --- loss: 1.402368, loss_ss: 0.956342, loss_d: 0.446026
0.4612 --- loss: 1.494175, loss_ss: 0.983326, loss_d: 0.510849
0.4996 --- loss: 1.558645, loss_ss: 1.164904, loss_d: 0.393741
0.5380 --- loss: 1.669833, loss_ss: 0.903023, loss_d: 0.766810
0.5765 --- loss: 1.614818, loss_ss: 1.231136, loss_d: 0.383682
0.6149 --- loss: 1.313902, loss_ss: 0.873700, loss_d: 0.440202
0.6533 --- loss: 1.791876, loss_ss: 1.246255, loss_d: 0.545620
0.6918 --- loss: 1.634292, loss_ss: 1.040623, loss_d: 0.593670
0.7302 --- loss: 1.394473, loss_ss: 0.862505, loss_d: 0.531967
0.7686 --- loss: 1.715597, loss_ss: 1.089801, loss_d: 0.625796
0.8071 --- loss: 1.111075, loss_ss: 0.707901, loss_d: 0.403175
0.8455 --- loss: 1.740918, loss_ss: 1.442218, loss_d: 0.298699
0.8839 --- loss: 1.902559, loss_ss: 1.221078, loss_d: 0.681481
0.9224 --- loss: 1.652890, loss_ss: 0.812781, loss_d: 0.840109
0.9608 --- loss: 1.647639, loss_ss: 1.137368, loss_d: 0.510271
0.9992 --- loss: 1.503188, loss_ss: 1.280887, loss_d: 0.222300
Epoch finished! Loss: 1.4757191486083545
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.529183, loss_ss: 1.180470, loss_d: 0.348713
0.0384 --- loss: 1.735099, loss_ss: 1.219635, loss_d: 0.515464
0.0769 --- loss: 1.813370, loss_ss: 1.097853, loss_d: 0.715517
0.1153 --- loss: 1.417935, loss_ss: 1.058029, loss_d: 0.359906
0.1537 --- loss: 1.365669, loss_ss: 0.940872, loss_d: 0.424797
0.1922 --- loss: 1.165213, loss_ss: 0.835422, loss_d: 0.329792
0.2306 --- loss: 1.140806, loss_ss: 0.942145, loss_d: 0.198661
0.2690 --- loss: 1.935554, loss_ss: 1.001530, loss_d: 0.934024
0.3075 --- loss: 1.075946, loss_ss: 0.885668, loss_d: 0.190278
0.3459 --- loss: 1.180692, loss_ss: 0.931126, loss_d: 0.249566
0.3843 --- loss: 1.313961, loss_ss: 1.006433, loss_d: 0.307528
0.4228 --- loss: 1.299434, loss_ss: 0.967442, loss_d: 0.331992
0.4612 --- loss: 1.599375, loss_ss: 1.025818, loss_d: 0.573557
0.4996 --- loss: 1.535643, loss_ss: 0.904653, loss_d: 0.630990
0.5380 --- loss: 1.342762, loss_ss: 0.830960, loss_d: 0.511801
0.5765 --- loss: 1.693139, loss_ss: 1.113791, loss_d: 0.579348
0.6149 --- loss: 1.493411, loss_ss: 1.212364, loss_d: 0.281047
0.6533 --- loss: 1.253701, loss_ss: 1.004589, loss_d: 0.249112
0.6918 --- loss: 1.715357, loss_ss: 1.119455, loss_d: 0.595903
0.7302 --- loss: 1.278122, loss_ss: 0.955884, loss_d: 0.322238
0.7686 --- loss: 0.993820, loss_ss: 0.820739, loss_d: 0.173082
0.8071 --- loss: 2.015959, loss_ss: 1.242722, loss_d: 0.773237
0.8455 --- loss: 1.859480, loss_ss: 1.195069, loss_d: 0.664411
0.8839 --- loss: 1.024893, loss_ss: 0.766667, loss_d: 0.258225
0.9224 --- loss: 1.759202, loss_ss: 0.777367, loss_d: 0.981835
0.9608 --- loss: 1.748596, loss_ss: 1.240788, loss_d: 0.507808
0.9992 --- loss: 1.920720, loss_ss: 1.437897, loss_d: 0.482823
Epoch finished! Loss: 1.3774917575029226
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.293926, loss_ss: 1.013806, loss_d: 0.280120
0.0384 --- loss: 1.502643, loss_ss: 1.274197, loss_d: 0.228446
0.0769 --- loss: 1.582643, loss_ss: 0.970267, loss_d: 0.612376
0.1153 --- loss: 1.000006, loss_ss: 0.660202, loss_d: 0.339804
0.1537 --- loss: 1.177448, loss_ss: 0.868272, loss_d: 0.309176
0.1922 --- loss: 1.644524, loss_ss: 1.132580, loss_d: 0.511944
0.2306 --- loss: 1.000232, loss_ss: 0.782307, loss_d: 0.217925
0.2690 --- loss: 1.231899, loss_ss: 0.819511, loss_d: 0.412388
0.3075 --- loss: 1.445982, loss_ss: 1.010290, loss_d: 0.435693
0.3459 --- loss: 1.302202, loss_ss: 0.811195, loss_d: 0.491008
0.3843 --- loss: 1.022692, loss_ss: 0.804421, loss_d: 0.218271
0.4228 --- loss: 1.170265, loss_ss: 1.017413, loss_d: 0.152852
0.4612 --- loss: 1.142189, loss_ss: 0.908619, loss_d: 0.233570
0.4996 --- loss: 1.162574, loss_ss: 0.842392, loss_d: 0.320182
0.5380 --- loss: 1.011849, loss_ss: 0.786920, loss_d: 0.224929
0.5765 --- loss: 1.303737, loss_ss: 0.880444, loss_d: 0.423293
0.6149 --- loss: 1.262339, loss_ss: 0.734079, loss_d: 0.528260
0.6533 --- loss: 1.742747, loss_ss: 1.196274, loss_d: 0.546473
0.6918 --- loss: 1.645039, loss_ss: 0.838238, loss_d: 0.806801
0.7302 --- loss: 1.549840, loss_ss: 1.085258, loss_d: 0.464582
0.7686 --- loss: 1.108392, loss_ss: 0.817100, loss_d: 0.291292
0.8071 --- loss: 1.602201, loss_ss: 1.069962, loss_d: 0.532240
0.8455 --- loss: 1.318296, loss_ss: 0.891838, loss_d: 0.426457
0.8839 --- loss: 1.219030, loss_ss: 0.828698, loss_d: 0.390332
0.9224 --- loss: 0.876069, loss_ss: 0.614540, loss_d: 0.261529
0.9608 --- loss: 1.165126, loss_ss: 1.031502, loss_d: 0.133624
0.9992 --- loss: 1.235492, loss_ss: 0.869157, loss_d: 0.366334
Epoch finished! Loss: 1.3024016877779594
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.192913, loss_ss: 0.952259, loss_d: 0.240655
0.0384 --- loss: 1.491826, loss_ss: 1.178887, loss_d: 0.312939
0.0769 --- loss: 1.312470, loss_ss: 0.860486, loss_d: 0.451985
0.1153 --- loss: 1.406633, loss_ss: 0.737325, loss_d: 0.669308
0.1537 --- loss: 1.711472, loss_ss: 1.104073, loss_d: 0.607399
0.1922 --- loss: 1.306375, loss_ss: 1.013494, loss_d: 0.292881
0.2306 --- loss: 1.094699, loss_ss: 0.841295, loss_d: 0.253404
0.2690 --- loss: 1.396852, loss_ss: 1.183644, loss_d: 0.213207
0.3075 --- loss: 1.355914, loss_ss: 1.012493, loss_d: 0.343422
0.3459 --- loss: 1.218849, loss_ss: 0.887879, loss_d: 0.330970
0.3843 --- loss: 1.411491, loss_ss: 1.009761, loss_d: 0.401729
0.4228 --- loss: 1.088081, loss_ss: 0.854586, loss_d: 0.233494
0.4612 --- loss: 1.405506, loss_ss: 1.189555, loss_d: 0.215951
0.4996 --- loss: 1.211530, loss_ss: 0.821122, loss_d: 0.390408
0.5380 --- loss: 1.269902, loss_ss: 0.912939, loss_d: 0.356963
0.5765 --- loss: 1.201900, loss_ss: 0.928160, loss_d: 0.273739
0.6149 --- loss: 1.411502, loss_ss: 0.979920, loss_d: 0.431583
0.6533 --- loss: 1.210483, loss_ss: 0.681515, loss_d: 0.528968
0.6918 --- loss: 1.069015, loss_ss: 0.867158, loss_d: 0.201856
0.7302 --- loss: 1.170869, loss_ss: 0.871714, loss_d: 0.299155
0.7686 --- loss: 1.125880, loss_ss: 0.748665, loss_d: 0.377215
0.8071 --- loss: 0.891771, loss_ss: 0.695765, loss_d: 0.196006
0.8455 --- loss: 1.384255, loss_ss: 1.004158, loss_d: 0.380097
0.8839 --- loss: 1.065338, loss_ss: 0.686141, loss_d: 0.379196
0.9224 --- loss: 1.798854, loss_ss: 0.834533, loss_d: 0.964321
0.9608 --- loss: 1.222083, loss_ss: 1.000723, loss_d: 0.221360
0.9992 --- loss: 2.067714, loss_ss: 1.465493, loss_d: 0.602221
Epoch finished! Loss: 1.2784322644655521
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.248614, loss_ss: 0.896201, loss_d: 0.352414
0.0384 --- loss: 1.113323, loss_ss: 0.711035, loss_d: 0.402288
0.0769 --- loss: 1.651762, loss_ss: 1.326506, loss_d: 0.325256
0.1153 --- loss: 1.191435, loss_ss: 0.981259, loss_d: 0.210175
0.1537 --- loss: 0.936419, loss_ss: 0.787358, loss_d: 0.149062
0.1922 --- loss: 0.829304, loss_ss: 0.663186, loss_d: 0.166117
0.2306 --- loss: 1.114502, loss_ss: 0.788246, loss_d: 0.326256
0.2690 --- loss: 1.117285, loss_ss: 0.920030, loss_d: 0.197254
0.3075 --- loss: 1.426455, loss_ss: 0.984896, loss_d: 0.441559
0.3459 --- loss: 1.245096, loss_ss: 0.716846, loss_d: 0.528251
0.3843 --- loss: 0.928110, loss_ss: 0.635394, loss_d: 0.292716
0.4228 --- loss: 1.127855, loss_ss: 0.999914, loss_d: 0.127941
0.4612 --- loss: 1.230731, loss_ss: 0.843167, loss_d: 0.387564
0.4996 --- loss: 1.925230, loss_ss: 1.245099, loss_d: 0.680131
0.5380 --- loss: 1.019985, loss_ss: 0.795731, loss_d: 0.224254
0.5765 --- loss: 0.986640, loss_ss: 0.752065, loss_d: 0.234575
0.6149 --- loss: 1.001477, loss_ss: 0.761599, loss_d: 0.239878
0.6533 --- loss: 0.969327, loss_ss: 0.802822, loss_d: 0.166505
0.6918 --- loss: 1.302387, loss_ss: 0.836037, loss_d: 0.466349
0.7302 --- loss: 0.996600, loss_ss: 0.770057, loss_d: 0.226543
0.7686 --- loss: 1.808318, loss_ss: 1.162389, loss_d: 0.645929
0.8071 --- loss: 1.294591, loss_ss: 0.844390, loss_d: 0.450201
0.8455 --- loss: 1.098773, loss_ss: 0.864851, loss_d: 0.233922
0.8839 --- loss: 0.908983, loss_ss: 0.772870, loss_d: 0.136113
0.9224 --- loss: 1.212766, loss_ss: 0.844135, loss_d: 0.368631
0.9608 --- loss: 1.270039, loss_ss: 1.105476, loss_d: 0.164563
0.9992 --- loss: 1.652236, loss_ss: 1.186503, loss_d: 0.465733
Epoch finished! Loss: 1.2224922106816218
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.122400, loss_ss: 0.924322, loss_d: 0.198078
0.0384 --- loss: 1.014771, loss_ss: 0.788301, loss_d: 0.226470
0.0769 --- loss: 1.379575, loss_ss: 1.063106, loss_d: 0.316470
0.1153 --- loss: 1.212163, loss_ss: 0.799718, loss_d: 0.412445
0.1537 --- loss: 1.731133, loss_ss: 1.516127, loss_d: 0.215007
0.1922 --- loss: 1.150784, loss_ss: 0.945747, loss_d: 0.205037
0.2306 --- loss: 1.226204, loss_ss: 0.774749, loss_d: 0.451455
0.2690 --- loss: 1.016150, loss_ss: 0.952703, loss_d: 0.063447
0.3075 --- loss: 0.850648, loss_ss: 0.723953, loss_d: 0.126695
0.3459 --- loss: 1.246523, loss_ss: 0.931575, loss_d: 0.314948
0.3843 --- loss: 1.108635, loss_ss: 0.916069, loss_d: 0.192567
0.4228 --- loss: 1.491496, loss_ss: 0.797168, loss_d: 0.694328
0.4612 --- loss: 1.133105, loss_ss: 0.845659, loss_d: 0.287446
0.4996 --- loss: 1.319751, loss_ss: 0.924551, loss_d: 0.395200
0.5380 --- loss: 0.739508, loss_ss: 0.601233, loss_d: 0.138275
0.5765 --- loss: 1.356311, loss_ss: 0.996065, loss_d: 0.360246
0.6149 --- loss: 1.298554, loss_ss: 0.882275, loss_d: 0.416279
0.6533 --- loss: 1.219553, loss_ss: 0.932145, loss_d: 0.287408
0.6918 --- loss: 1.120836, loss_ss: 0.956922, loss_d: 0.163914
0.7302 --- loss: 0.983472, loss_ss: 0.843423, loss_d: 0.140049
0.7686 --- loss: 0.999398, loss_ss: 0.879481, loss_d: 0.119917
0.8071 --- loss: 1.410882, loss_ss: 1.321378, loss_d: 0.089504
0.8455 --- loss: 1.076470, loss_ss: 0.969406, loss_d: 0.107063
0.8839 --- loss: 1.142535, loss_ss: 0.913847, loss_d: 0.228689
0.9224 --- loss: 1.421691, loss_ss: 0.959108, loss_d: 0.462583
0.9608 --- loss: 1.053116, loss_ss: 0.907026, loss_d: 0.146091
0.9992 --- loss: 1.607731, loss_ss: 1.350657, loss_d: 0.257074
Epoch finished! Loss: 1.1835693006332104
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.210279, loss_ss: 1.062537, loss_d: 0.147741
0.0384 --- loss: 0.756488, loss_ss: 0.630268, loss_d: 0.126220
0.0769 --- loss: 1.059768, loss_ss: 0.908471, loss_d: 0.151297
0.1153 --- loss: 1.243286, loss_ss: 0.881096, loss_d: 0.362189
0.1537 --- loss: 0.852181, loss_ss: 0.790690, loss_d: 0.061491
0.1922 --- loss: 1.463660, loss_ss: 0.802922, loss_d: 0.660738
0.2306 --- loss: 0.989015, loss_ss: 0.824528, loss_d: 0.164487
0.2690 --- loss: 0.765758, loss_ss: 0.565340, loss_d: 0.200419
0.3075 --- loss: 0.842247, loss_ss: 0.784476, loss_d: 0.057771
0.3459 --- loss: 1.674002, loss_ss: 1.372593, loss_d: 0.301409
0.3843 --- loss: 1.593940, loss_ss: 0.821288, loss_d: 0.772652
0.4228 --- loss: 1.219812, loss_ss: 0.956545, loss_d: 0.263267
0.4612 --- loss: 1.163203, loss_ss: 0.662713, loss_d: 0.500490
0.4996 --- loss: 1.232062, loss_ss: 0.958899, loss_d: 0.273163
0.5380 --- loss: 1.164516, loss_ss: 0.905504, loss_d: 0.259012
0.5765 --- loss: 1.399333, loss_ss: 1.204675, loss_d: 0.194657
0.6149 --- loss: 0.968620, loss_ss: 0.549181, loss_d: 0.419438
0.6533 --- loss: 1.299860, loss_ss: 0.611759, loss_d: 0.688100
0.6918 --- loss: 1.333570, loss_ss: 1.057262, loss_d: 0.276308
0.7302 --- loss: 0.737011, loss_ss: 0.591153, loss_d: 0.145859
0.7686 --- loss: 1.059024, loss_ss: 0.990004, loss_d: 0.069020
0.8071 --- loss: 1.431269, loss_ss: 0.925658, loss_d: 0.505611
0.8455 --- loss: 0.960091, loss_ss: 0.671409, loss_d: 0.288682
0.8839 --- loss: 0.976928, loss_ss: 0.650283, loss_d: 0.326644
0.9224 --- loss: 0.698414, loss_ss: 0.555346, loss_d: 0.143068
0.9608 --- loss: 1.342810, loss_ss: 0.887332, loss_d: 0.455477
0.9992 --- loss: 6.141123, loss_ss: 2.020499, loss_d: 4.120624
Epoch finished! Loss: 1.159165912408095
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.575925925925926
             precision    recall  f1-score   support

        0.0       0.66      0.53      0.59       120
        1.0       0.75      0.01      0.02       322
        2.0       0.41      0.99      0.58       274
        3.0       1.00      0.80      0.89       224
        4.0       0.76      0.75      0.76       140

avg / total       0.71      0.58      0.50      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.76  52.50   96.67   66.32     58.60
1  70.37   0.93   99.87   75.00      1.84
2  63.43  98.91   51.36   40.87     57.84
3  95.93  80.36  100.00  100.00     89.11
4  93.70  75.00   96.49   76.09     75.54
Total accuracy: 57.59%
Average sen: 61.54%
Average spec: 88.88%
Macro f1-score: 56.59%
[0.36914918 0.41676804 0.80339587 0.87442076 0.96390492 0.77912694
 0.57288033 0.94729596 0.64729482 0.6747641  0.74926913 0.90747148
 0.98584992 0.92160541 0.95483488 0.97517574 0.79669183 0.99106216
 0.92235762 0.99017262 0.42291445 0.90522355 0.82546854 0.95898157
 0.51832396 0.79792351 0.83608931 0.95134842 0.91799599 0.65947646
 0.77279502 0.85318911 0.59243119 0.65954131 0.81535178 0.77663493]
pred: 0.7918661336104075, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.124646, loss_ss: 1.438082, loss_d: 0.686564
0.0385 --- loss: 2.327225, loss_ss: 1.488348, loss_d: 0.838877
0.0769 --- loss: 2.318651, loss_ss: 1.451343, loss_d: 0.867308
0.1154 --- loss: 2.213343, loss_ss: 1.493796, loss_d: 0.719548
0.1538 --- loss: 2.131640, loss_ss: 1.516875, loss_d: 0.614765
0.1923 --- loss: 1.848421, loss_ss: 1.109994, loss_d: 0.738427
0.2308 --- loss: 2.071873, loss_ss: 1.379177, loss_d: 0.692697
0.2692 --- loss: 1.992857, loss_ss: 1.453636, loss_d: 0.539221
0.3077 --- loss: 1.898218, loss_ss: 1.406623, loss_d: 0.491595
0.3462 --- loss: 1.550224, loss_ss: 1.189058, loss_d: 0.361166
0.3846 --- loss: 1.941059, loss_ss: 1.248145, loss_d: 0.692914
0.4231 --- loss: 1.703340, loss_ss: 1.068451, loss_d: 0.634890
0.4615 --- loss: 1.733772, loss_ss: 1.112557, loss_d: 0.621215
0.5000 --- loss: 1.747668, loss_ss: 1.231464, loss_d: 0.516204
0.5385 --- loss: 1.688213, loss_ss: 1.106179, loss_d: 0.582034
0.5769 --- loss: 2.081279, loss_ss: 1.290300, loss_d: 0.790979
0.6154 --- loss: 2.198573, loss_ss: 1.626623, loss_d: 0.571950
0.6538 --- loss: 1.804107, loss_ss: 1.294327, loss_d: 0.509781
0.6923 --- loss: 1.712901, loss_ss: 1.319659, loss_d: 0.393242
0.7308 --- loss: 1.915198, loss_ss: 1.159916, loss_d: 0.755281
0.7692 --- loss: 1.836266, loss_ss: 1.263170, loss_d: 0.573096
0.8077 --- loss: 1.477942, loss_ss: 1.063742, loss_d: 0.414200
0.8462 --- loss: 2.003994, loss_ss: 1.551499, loss_d: 0.452495
0.8846 --- loss: 1.802961, loss_ss: 1.152125, loss_d: 0.650836
0.9231 --- loss: 1.592995, loss_ss: 1.021713, loss_d: 0.571282
0.9615 --- loss: 1.602575, loss_ss: 1.096550, loss_d: 0.506025
Epoch finished! Loss: 1.8749118224074022
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.533029, loss_ss: 0.985678, loss_d: 0.547350
0.0385 --- loss: 1.918273, loss_ss: 1.367976, loss_d: 0.550297
0.0769 --- loss: 1.756933, loss_ss: 1.048228, loss_d: 0.708705
0.1154 --- loss: 1.761288, loss_ss: 1.076963, loss_d: 0.684324
0.1538 --- loss: 1.456788, loss_ss: 1.089234, loss_d: 0.367554
0.1923 --- loss: 1.904167, loss_ss: 1.147332, loss_d: 0.756834
0.2308 --- loss: 1.786201, loss_ss: 1.115678, loss_d: 0.670522
0.2692 --- loss: 2.025658, loss_ss: 1.328988, loss_d: 0.696670
0.3077 --- loss: 2.055308, loss_ss: 1.237106, loss_d: 0.818203
0.3462 --- loss: 1.801887, loss_ss: 1.228392, loss_d: 0.573495
0.3846 --- loss: 1.530128, loss_ss: 0.899987, loss_d: 0.630141
0.4231 --- loss: 1.883241, loss_ss: 1.333361, loss_d: 0.549880
0.4615 --- loss: 1.573439, loss_ss: 1.007676, loss_d: 0.565764
0.5000 --- loss: 1.737308, loss_ss: 1.203925, loss_d: 0.533383
0.5385 --- loss: 1.730746, loss_ss: 1.014081, loss_d: 0.716664
0.5769 --- loss: 1.479165, loss_ss: 0.843102, loss_d: 0.636063
0.6154 --- loss: 1.737445, loss_ss: 1.080641, loss_d: 0.656804
0.6538 --- loss: 1.710003, loss_ss: 1.087515, loss_d: 0.622488
0.6923 --- loss: 2.033986, loss_ss: 1.298324, loss_d: 0.735662
0.7308 --- loss: 1.387009, loss_ss: 0.937040, loss_d: 0.449969
0.7692 --- loss: 1.294271, loss_ss: 0.977559, loss_d: 0.316712
0.8077 --- loss: 1.939917, loss_ss: 1.285202, loss_d: 0.654715
0.8462 --- loss: 1.883750, loss_ss: 1.193974, loss_d: 0.689776
0.8846 --- loss: 1.648561, loss_ss: 1.063878, loss_d: 0.584683
0.9231 --- loss: 1.242978, loss_ss: 0.803363, loss_d: 0.439615
0.9615 --- loss: 1.661417, loss_ss: 0.905401, loss_d: 0.756016
Epoch finished! Loss: 1.6844852582828418
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.762929, loss_ss: 1.219130, loss_d: 0.543799
0.0385 --- loss: 1.779482, loss_ss: 1.043770, loss_d: 0.735712
0.0769 --- loss: 1.712545, loss_ss: 0.995601, loss_d: 0.716944
0.1154 --- loss: 1.753017, loss_ss: 1.169802, loss_d: 0.583215
0.1538 --- loss: 1.379978, loss_ss: 0.869771, loss_d: 0.510207
0.1923 --- loss: 1.658237, loss_ss: 0.808832, loss_d: 0.849406
0.2308 --- loss: 1.293613, loss_ss: 0.846421, loss_d: 0.447192
0.2692 --- loss: 1.690115, loss_ss: 1.022805, loss_d: 0.667311
0.3077 --- loss: 1.745165, loss_ss: 1.164050, loss_d: 0.581115
0.3462 --- loss: 1.535016, loss_ss: 1.060935, loss_d: 0.474081
0.3846 --- loss: 1.408351, loss_ss: 1.028122, loss_d: 0.380229
0.4231 --- loss: 1.722982, loss_ss: 1.206565, loss_d: 0.516417
0.4615 --- loss: 1.685912, loss_ss: 0.856734, loss_d: 0.829177
0.5000 --- loss: 1.381037, loss_ss: 0.779159, loss_d: 0.601878
0.5385 --- loss: 1.789975, loss_ss: 1.057733, loss_d: 0.732242
0.5769 --- loss: 1.444037, loss_ss: 0.790627, loss_d: 0.653410
0.6154 --- loss: 1.235689, loss_ss: 0.816559, loss_d: 0.419129
0.6538 --- loss: 1.613968, loss_ss: 0.899045, loss_d: 0.714923
0.6923 --- loss: 1.525622, loss_ss: 1.024822, loss_d: 0.500800
0.7308 --- loss: 1.426448, loss_ss: 0.904788, loss_d: 0.521660
0.7692 --- loss: 1.897762, loss_ss: 1.200996, loss_d: 0.696766
0.8077 --- loss: 1.572811, loss_ss: 1.022857, loss_d: 0.549955
0.8462 --- loss: 1.245093, loss_ss: 0.636062, loss_d: 0.609031
0.8846 --- loss: 1.468356, loss_ss: 1.100639, loss_d: 0.367717
0.9231 --- loss: 1.990762, loss_ss: 1.364259, loss_d: 0.626504
0.9615 --- loss: 1.470923, loss_ss: 0.983078, loss_d: 0.487845
Epoch finished! Loss: 1.581163807725354
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.536561, loss_ss: 0.877799, loss_d: 0.658762
0.0385 --- loss: 1.390744, loss_ss: 0.849791, loss_d: 0.540953
0.0769 --- loss: 1.441519, loss_ss: 1.138739, loss_d: 0.302780
0.1154 --- loss: 1.378075, loss_ss: 1.038584, loss_d: 0.339491
0.1538 --- loss: 1.637527, loss_ss: 1.000369, loss_d: 0.637158
0.1923 --- loss: 1.481534, loss_ss: 0.803546, loss_d: 0.677988
0.2308 --- loss: 1.849743, loss_ss: 1.336238, loss_d: 0.513505
0.2692 --- loss: 1.316573, loss_ss: 0.803442, loss_d: 0.513131
0.3077 --- loss: 1.683037, loss_ss: 0.875856, loss_d: 0.807180
0.3462 --- loss: 1.529827, loss_ss: 1.046516, loss_d: 0.483311
0.3846 --- loss: 1.489864, loss_ss: 1.019822, loss_d: 0.470042
0.4231 --- loss: 1.516502, loss_ss: 0.911241, loss_d: 0.605261
0.4615 --- loss: 1.316407, loss_ss: 1.002868, loss_d: 0.313539
0.5000 --- loss: 1.222825, loss_ss: 0.775213, loss_d: 0.447612
0.5385 --- loss: 1.383992, loss_ss: 0.898245, loss_d: 0.485747
0.5769 --- loss: 1.269764, loss_ss: 0.840798, loss_d: 0.428966
0.6154 --- loss: 1.318970, loss_ss: 0.902478, loss_d: 0.416493
0.6538 --- loss: 1.367715, loss_ss: 0.904346, loss_d: 0.463369
0.6923 --- loss: 1.481629, loss_ss: 1.183203, loss_d: 0.298426
0.7308 --- loss: 1.655667, loss_ss: 1.098407, loss_d: 0.557260
0.7692 --- loss: 1.744048, loss_ss: 1.026527, loss_d: 0.717521
0.8077 --- loss: 1.381578, loss_ss: 0.728775, loss_d: 0.652803
0.8462 --- loss: 1.791955, loss_ss: 1.269106, loss_d: 0.522850
0.8846 --- loss: 1.443153, loss_ss: 0.963475, loss_d: 0.479677
0.9231 --- loss: 1.352949, loss_ss: 0.722890, loss_d: 0.630059
0.9615 --- loss: 1.362044, loss_ss: 0.858585, loss_d: 0.503459
Epoch finished! Loss: 1.5125871482503
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.493273, loss_ss: 1.030031, loss_d: 0.463242
0.0385 --- loss: 1.338867, loss_ss: 1.013265, loss_d: 0.325602
0.0769 --- loss: 1.343686, loss_ss: 0.960040, loss_d: 0.383646
0.1154 --- loss: 1.255381, loss_ss: 0.883630, loss_d: 0.371751
0.1538 --- loss: 1.530956, loss_ss: 0.784266, loss_d: 0.746690
0.1923 --- loss: 1.524901, loss_ss: 0.841918, loss_d: 0.682984
0.2308 --- loss: 1.642004, loss_ss: 1.259081, loss_d: 0.382923
0.2692 --- loss: 1.083870, loss_ss: 0.809533, loss_d: 0.274338
0.3077 --- loss: 1.892455, loss_ss: 1.280376, loss_d: 0.612080
0.3462 --- loss: 1.448443, loss_ss: 0.852580, loss_d: 0.595863
0.3846 --- loss: 1.559586, loss_ss: 0.906469, loss_d: 0.653117
0.4231 --- loss: 0.936853, loss_ss: 0.686869, loss_d: 0.249984
0.4615 --- loss: 1.364676, loss_ss: 1.022732, loss_d: 0.341944
0.5000 --- loss: 1.596352, loss_ss: 1.098517, loss_d: 0.497834
0.5385 --- loss: 1.542872, loss_ss: 1.093423, loss_d: 0.449448
0.5769 --- loss: 1.470228, loss_ss: 1.144846, loss_d: 0.325382
0.6154 --- loss: 1.530172, loss_ss: 1.228547, loss_d: 0.301625
0.6538 --- loss: 1.892628, loss_ss: 1.129780, loss_d: 0.762849
0.6923 --- loss: 1.391572, loss_ss: 0.576831, loss_d: 0.814741
0.7308 --- loss: 1.174322, loss_ss: 0.689107, loss_d: 0.485215
0.7692 --- loss: 1.900910, loss_ss: 0.925047, loss_d: 0.975863
0.8077 --- loss: 1.423840, loss_ss: 1.120213, loss_d: 0.303627
0.8462 --- loss: 1.262882, loss_ss: 1.017425, loss_d: 0.245457
0.8846 --- loss: 1.118539, loss_ss: 0.782024, loss_d: 0.336516
0.9231 --- loss: 1.194682, loss_ss: 0.941034, loss_d: 0.253649
0.9615 --- loss: 1.793818, loss_ss: 0.803627, loss_d: 0.990191
Epoch finished! Loss: 1.4141429706429882
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.284337, loss_ss: 0.810264, loss_d: 0.474073
0.0385 --- loss: 1.205690, loss_ss: 0.750782, loss_d: 0.454907
0.0769 --- loss: 1.036489, loss_ss: 0.717607, loss_d: 0.318882
0.1154 --- loss: 1.333172, loss_ss: 0.731139, loss_d: 0.602033
0.1538 --- loss: 1.257558, loss_ss: 0.763510, loss_d: 0.494048
0.1923 --- loss: 1.181418, loss_ss: 0.828693, loss_d: 0.352726
0.2308 --- loss: 1.491093, loss_ss: 0.865674, loss_d: 0.625419
0.2692 --- loss: 1.283405, loss_ss: 0.928698, loss_d: 0.354707
0.3077 --- loss: 1.032712, loss_ss: 0.759503, loss_d: 0.273209
0.3462 --- loss: 1.507572, loss_ss: 0.929218, loss_d: 0.578354
0.3846 --- loss: 1.046766, loss_ss: 0.838782, loss_d: 0.207984
0.4231 --- loss: 1.067947, loss_ss: 0.808506, loss_d: 0.259441
0.4615 --- loss: 1.379124, loss_ss: 1.109177, loss_d: 0.269947
0.5000 --- loss: 1.364475, loss_ss: 1.076922, loss_d: 0.287553
0.5385 --- loss: 1.318426, loss_ss: 1.098675, loss_d: 0.219750
0.5769 --- loss: 1.073399, loss_ss: 0.845662, loss_d: 0.227736
0.6154 --- loss: 1.193342, loss_ss: 1.026330, loss_d: 0.167012
0.6538 --- loss: 1.116597, loss_ss: 0.900292, loss_d: 0.216304
0.6923 --- loss: 1.479157, loss_ss: 0.951270, loss_d: 0.527887
0.7308 --- loss: 1.543918, loss_ss: 1.012518, loss_d: 0.531400
0.7692 --- loss: 1.214151, loss_ss: 0.736278, loss_d: 0.477873
0.8077 --- loss: 1.408979, loss_ss: 0.935028, loss_d: 0.473951
0.8462 --- loss: 1.009508, loss_ss: 0.567588, loss_d: 0.441920
0.8846 --- loss: 1.107045, loss_ss: 0.745178, loss_d: 0.361866
0.9231 --- loss: 1.286821, loss_ss: 1.062787, loss_d: 0.224034
0.9615 --- loss: 1.648832, loss_ss: 0.999136, loss_d: 0.649697
Epoch finished! Loss: 1.3268095093804437
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.931004, loss_ss: 0.739116, loss_d: 0.191887
0.0385 --- loss: 1.322736, loss_ss: 0.823698, loss_d: 0.499038
0.0769 --- loss: 1.096278, loss_ss: 0.797886, loss_d: 0.298392
0.1154 --- loss: 1.372848, loss_ss: 0.829925, loss_d: 0.542922
0.1538 --- loss: 1.301403, loss_ss: 0.753909, loss_d: 0.547495
0.1923 --- loss: 1.337777, loss_ss: 0.931962, loss_d: 0.405815
0.2308 --- loss: 1.477999, loss_ss: 1.107780, loss_d: 0.370220
0.2692 --- loss: 1.114056, loss_ss: 0.797459, loss_d: 0.316596
0.3077 --- loss: 0.983059, loss_ss: 0.703794, loss_d: 0.279265
0.3462 --- loss: 0.997514, loss_ss: 0.765382, loss_d: 0.232133
0.3846 --- loss: 1.168977, loss_ss: 0.853994, loss_d: 0.314983
0.4231 --- loss: 1.061037, loss_ss: 0.724919, loss_d: 0.336119
0.4615 --- loss: 1.174817, loss_ss: 0.611873, loss_d: 0.562945
0.5000 --- loss: 1.530743, loss_ss: 1.071099, loss_d: 0.459644
0.5385 --- loss: 1.345885, loss_ss: 1.023957, loss_d: 0.321928
0.5769 --- loss: 1.765973, loss_ss: 1.161617, loss_d: 0.604356
0.6154 --- loss: 1.394688, loss_ss: 0.908677, loss_d: 0.486011
0.6538 --- loss: 1.241071, loss_ss: 0.632394, loss_d: 0.608677
0.6923 --- loss: 1.471043, loss_ss: 1.122760, loss_d: 0.348283
0.7308 --- loss: 0.988687, loss_ss: 0.612385, loss_d: 0.376302
0.7692 --- loss: 0.967349, loss_ss: 0.651322, loss_d: 0.316027
0.8077 --- loss: 1.357529, loss_ss: 0.707254, loss_d: 0.650275
0.8462 --- loss: 1.143978, loss_ss: 0.747636, loss_d: 0.396342
0.8846 --- loss: 1.053456, loss_ss: 0.732621, loss_d: 0.320836
0.9231 --- loss: 1.179076, loss_ss: 0.940841, loss_d: 0.238235
0.9615 --- loss: 1.310675, loss_ss: 0.860078, loss_d: 0.450597
Epoch finished! Loss: 1.2713500530563266
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.276374, loss_ss: 0.909818, loss_d: 0.366556
0.0385 --- loss: 1.393152, loss_ss: 0.944892, loss_d: 0.448260
0.0769 --- loss: 0.993324, loss_ss: 0.843976, loss_d: 0.149349
0.1154 --- loss: 1.623313, loss_ss: 0.972351, loss_d: 0.650962
0.1538 --- loss: 1.049875, loss_ss: 0.910370, loss_d: 0.139504
0.1923 --- loss: 1.574841, loss_ss: 0.919681, loss_d: 0.655161
0.2308 --- loss: 0.944622, loss_ss: 0.800538, loss_d: 0.144084
0.2692 --- loss: 1.446996, loss_ss: 0.798410, loss_d: 0.648586
0.3077 --- loss: 0.995744, loss_ss: 0.656879, loss_d: 0.338865
0.3462 --- loss: 1.150002, loss_ss: 0.832211, loss_d: 0.317791
0.3846 --- loss: 0.993392, loss_ss: 0.731118, loss_d: 0.262274
0.4231 --- loss: 1.596331, loss_ss: 1.077348, loss_d: 0.518982
0.4615 --- loss: 1.213278, loss_ss: 0.763273, loss_d: 0.450005
0.5000 --- loss: 1.040036, loss_ss: 0.788358, loss_d: 0.251678
0.5385 --- loss: 1.556601, loss_ss: 1.044490, loss_d: 0.512111
0.5769 --- loss: 1.357165, loss_ss: 0.901828, loss_d: 0.455337
0.6154 --- loss: 0.933324, loss_ss: 0.553420, loss_d: 0.379904
0.6538 --- loss: 1.064026, loss_ss: 0.823232, loss_d: 0.240793
0.6923 --- loss: 1.071423, loss_ss: 0.915324, loss_d: 0.156099
0.7308 --- loss: 0.997813, loss_ss: 0.724085, loss_d: 0.273728
0.7692 --- loss: 1.052570, loss_ss: 0.809510, loss_d: 0.243059
0.8077 --- loss: 1.597189, loss_ss: 1.153637, loss_d: 0.443552
0.8462 --- loss: 0.946689, loss_ss: 0.791338, loss_d: 0.155351
0.8846 --- loss: 1.238203, loss_ss: 0.958313, loss_d: 0.279890
0.9231 --- loss: 1.915212, loss_ss: 1.365719, loss_d: 0.549493
0.9615 --- loss: 1.371106, loss_ss: 0.937714, loss_d: 0.433391
Epoch finished! Loss: 1.2284726610975376
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.065335, loss_ss: 0.771372, loss_d: 0.293963
0.0385 --- loss: 1.194994, loss_ss: 0.906586, loss_d: 0.288407
0.0769 --- loss: 1.421531, loss_ss: 0.721084, loss_d: 0.700447
0.1154 --- loss: 0.791178, loss_ss: 0.592854, loss_d: 0.198324
0.1538 --- loss: 1.165515, loss_ss: 1.051794, loss_d: 0.113721
0.1923 --- loss: 1.105428, loss_ss: 0.914108, loss_d: 0.191320
0.2308 --- loss: 0.989452, loss_ss: 0.809256, loss_d: 0.180197
0.2692 --- loss: 1.171595, loss_ss: 0.827580, loss_d: 0.344014
0.3077 --- loss: 0.870261, loss_ss: 0.700047, loss_d: 0.170213
0.3462 --- loss: 1.351699, loss_ss: 1.020962, loss_d: 0.330737
0.3846 --- loss: 1.427818, loss_ss: 0.949951, loss_d: 0.477867
0.4231 --- loss: 1.233729, loss_ss: 0.945194, loss_d: 0.288535
0.4615 --- loss: 0.989128, loss_ss: 0.817481, loss_d: 0.171647
0.5000 --- loss: 0.948631, loss_ss: 0.846661, loss_d: 0.101971
0.5385 --- loss: 0.692204, loss_ss: 0.472839, loss_d: 0.219365
0.5769 --- loss: 1.553548, loss_ss: 0.871996, loss_d: 0.681552
0.6154 --- loss: 1.141918, loss_ss: 0.583850, loss_d: 0.558068
0.6538 --- loss: 1.549716, loss_ss: 1.147910, loss_d: 0.401806
0.6923 --- loss: 0.825608, loss_ss: 0.626844, loss_d: 0.198763
0.7308 --- loss: 1.116216, loss_ss: 0.941808, loss_d: 0.174408
0.7692 --- loss: 0.903995, loss_ss: 0.810829, loss_d: 0.093165
0.8077 --- loss: 1.248262, loss_ss: 0.815949, loss_d: 0.432314
0.8462 --- loss: 2.147854, loss_ss: 0.873962, loss_d: 1.273893
0.8846 --- loss: 1.391775, loss_ss: 1.057247, loss_d: 0.334528
0.9231 --- loss: 0.954016, loss_ss: 0.802300, loss_d: 0.151716
0.9615 --- loss: 0.994924, loss_ss: 0.670263, loss_d: 0.324662
Epoch finished! Loss: 1.1735518570111985
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.160219, loss_ss: 1.001764, loss_d: 0.158454
0.0385 --- loss: 0.952379, loss_ss: 0.855938, loss_d: 0.096442
0.0769 --- loss: 0.898512, loss_ss: 0.731582, loss_d: 0.166930
0.1154 --- loss: 1.448766, loss_ss: 0.803466, loss_d: 0.645300
0.1538 --- loss: 1.302866, loss_ss: 0.750521, loss_d: 0.552345
0.1923 --- loss: 0.921822, loss_ss: 0.682400, loss_d: 0.239422
0.2308 --- loss: 0.972433, loss_ss: 0.616057, loss_d: 0.356376
0.2692 --- loss: 1.465666, loss_ss: 0.963847, loss_d: 0.501820
0.3077 --- loss: 0.818635, loss_ss: 0.555815, loss_d: 0.262820
0.3462 --- loss: 1.080042, loss_ss: 0.947563, loss_d: 0.132478
0.3846 --- loss: 1.015058, loss_ss: 0.732628, loss_d: 0.282430
0.4231 --- loss: 1.169047, loss_ss: 0.957644, loss_d: 0.211404
0.4615 --- loss: 1.384725, loss_ss: 0.804652, loss_d: 0.580073
0.5000 --- loss: 1.419032, loss_ss: 0.986992, loss_d: 0.432040
0.5385 --- loss: 1.402070, loss_ss: 1.026833, loss_d: 0.375236
0.5769 --- loss: 1.115477, loss_ss: 0.772725, loss_d: 0.342752
0.6154 --- loss: 1.080196, loss_ss: 0.769534, loss_d: 0.310661
0.6538 --- loss: 1.121978, loss_ss: 0.899834, loss_d: 0.222145
0.6923 --- loss: 1.530242, loss_ss: 0.716232, loss_d: 0.814010
0.7308 --- loss: 1.034563, loss_ss: 0.706843, loss_d: 0.327720
0.7692 --- loss: 0.897368, loss_ss: 0.755754, loss_d: 0.141614
0.8077 --- loss: 1.078220, loss_ss: 0.703800, loss_d: 0.374419
0.8462 --- loss: 1.345397, loss_ss: 1.144846, loss_d: 0.200551
0.8846 --- loss: 1.606094, loss_ss: 1.484194, loss_d: 0.121899
0.9231 --- loss: 0.884342, loss_ss: 0.672990, loss_d: 0.211352
0.9615 --- loss: 1.351543, loss_ss: 0.862363, loss_d: 0.489180
Epoch finished! Loss: 1.1505055236540245
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6736842105263158
             precision    recall  f1-score   support

        0.0       0.75      0.67      0.71       166
        1.0       0.17      0.02      0.03        58
        2.0       0.54      0.96      0.70       397
        3.0       0.98      0.72      0.83       165
        4.0       0.96      0.44      0.60       354

avg / total       0.75      0.67      0.65      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.93  67.47   96.10  74.67     70.89
1  94.56   1.72   99.54  16.67      3.12
2  70.61  96.22   56.93  54.42     69.52
3  95.79  72.12   99.79  98.35     83.22
4  81.84  43.50   99.11  95.65     59.81
Total accuracy: 67.37%
Average sen: 56.21%
Average spec: 90.29%
Macro f1-score: 57.31%
[0.26989222 0.61817628 0.86721772 0.94325244 0.05501986 0.33721891
 0.71571165 0.34050086 0.24909385 0.09428376 0.67193514 0.34713015
 0.43579945 0.62871724 0.38726151 0.5811398  0.1935806  0.16503666
 0.40194681 0.41266793 0.87761122 0.76373035 0.42376339 0.36391145
 0.67836267 0.36567661 0.42119864 0.30037794 0.68618119 0.47423381
 0.22063196 0.42923921 0.16524792 0.20530412 0.26492637 0.37694257
 0.35843629 0.37884864]
pred: 0.43342650505272967, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.288713, loss_ss: 1.641427, loss_d: 0.647286
0.0384 --- loss: 2.321509, loss_ss: 1.679096, loss_d: 0.642413
0.0767 --- loss: 2.067622, loss_ss: 1.405050, loss_d: 0.662572
0.1151 --- loss: 1.879790, loss_ss: 1.264004, loss_d: 0.615786
0.1534 --- loss: 2.013952, loss_ss: 1.323707, loss_d: 0.690245
0.1918 --- loss: 1.925806, loss_ss: 1.350284, loss_d: 0.575522
0.2301 --- loss: 1.668053, loss_ss: 1.302467, loss_d: 0.365586
0.2685 --- loss: 2.227978, loss_ss: 1.645414, loss_d: 0.582563
0.3069 --- loss: 2.101962, loss_ss: 1.624312, loss_d: 0.477650
0.3452 --- loss: 1.803034, loss_ss: 1.361312, loss_d: 0.441722
0.3836 --- loss: 1.604601, loss_ss: 1.259074, loss_d: 0.345527
0.4219 --- loss: 1.844149, loss_ss: 1.070280, loss_d: 0.773869
0.4603 --- loss: 1.992100, loss_ss: 1.386976, loss_d: 0.605125
0.4987 --- loss: 2.355662, loss_ss: 1.284984, loss_d: 1.070678
0.5370 --- loss: 1.966933, loss_ss: 1.270962, loss_d: 0.695970
0.5754 --- loss: 2.146593, loss_ss: 1.400750, loss_d: 0.745843
0.6137 --- loss: 1.759024, loss_ss: 1.216312, loss_d: 0.542712
0.6521 --- loss: 1.939021, loss_ss: 1.088661, loss_d: 0.850360
0.6904 --- loss: 1.834102, loss_ss: 1.223780, loss_d: 0.610323
0.7288 --- loss: 1.464569, loss_ss: 1.132771, loss_d: 0.331799
0.7672 --- loss: 2.189734, loss_ss: 1.222958, loss_d: 0.966775
0.8055 --- loss: 1.830348, loss_ss: 1.240996, loss_d: 0.589352
0.8439 --- loss: 1.780424, loss_ss: 1.219190, loss_d: 0.561234
0.8822 --- loss: 1.888946, loss_ss: 1.161444, loss_d: 0.727502
0.9206 --- loss: 1.789569, loss_ss: 1.162257, loss_d: 0.627312
0.9590 --- loss: 1.675737, loss_ss: 1.153774, loss_d: 0.521963
0.9973 --- loss: 2.036732, loss_ss: 1.404435, loss_d: 0.632297
Epoch finished! Loss: 1.9062887897858254
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.964394, loss_ss: 1.225801, loss_d: 0.738593
0.0384 --- loss: 1.556969, loss_ss: 1.047639, loss_d: 0.509330
0.0767 --- loss: 1.390343, loss_ss: 0.976521, loss_d: 0.413822
0.1151 --- loss: 1.742664, loss_ss: 1.230523, loss_d: 0.512140
0.1534 --- loss: 1.505844, loss_ss: 0.998376, loss_d: 0.507468
0.1918 --- loss: 1.774146, loss_ss: 1.310271, loss_d: 0.463875
0.2301 --- loss: 1.813565, loss_ss: 1.040905, loss_d: 0.772660
0.2685 --- loss: 1.609721, loss_ss: 1.077993, loss_d: 0.531728
0.3069 --- loss: 1.884447, loss_ss: 1.270706, loss_d: 0.613741
0.3452 --- loss: 1.810870, loss_ss: 1.114474, loss_d: 0.696396
0.3836 --- loss: 1.384468, loss_ss: 1.021637, loss_d: 0.362831
0.4219 --- loss: 1.557982, loss_ss: 1.046807, loss_d: 0.511175
0.4603 --- loss: 1.566537, loss_ss: 1.011781, loss_d: 0.554755
0.4987 --- loss: 1.657848, loss_ss: 1.272601, loss_d: 0.385246
0.5370 --- loss: 1.535783, loss_ss: 0.821340, loss_d: 0.714443
0.5754 --- loss: 1.674916, loss_ss: 0.967639, loss_d: 0.707276
0.6137 --- loss: 2.262026, loss_ss: 1.483957, loss_d: 0.778069
0.6521 --- loss: 1.689326, loss_ss: 1.118464, loss_d: 0.570862
0.6904 --- loss: 1.598332, loss_ss: 1.129549, loss_d: 0.468783
0.7288 --- loss: 1.971457, loss_ss: 0.967364, loss_d: 1.004093
0.7672 --- loss: 1.969290, loss_ss: 1.183201, loss_d: 0.786090
0.8055 --- loss: 1.607365, loss_ss: 0.832927, loss_d: 0.774438
0.8439 --- loss: 1.785600, loss_ss: 1.098563, loss_d: 0.687037
0.8822 --- loss: 1.868731, loss_ss: 1.089799, loss_d: 0.778933
0.9206 --- loss: 1.799949, loss_ss: 1.224194, loss_d: 0.575756
0.9590 --- loss: 1.384199, loss_ss: 1.083736, loss_d: 0.300463
0.9973 --- loss: 1.683351, loss_ss: 1.037201, loss_d: 0.646151
Epoch finished! Loss: 1.7265084413381724
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.636486, loss_ss: 0.899032, loss_d: 0.737453
0.0384 --- loss: 1.611921, loss_ss: 1.115736, loss_d: 0.496185
0.0767 --- loss: 1.444160, loss_ss: 0.997010, loss_d: 0.447149
0.1151 --- loss: 1.477202, loss_ss: 0.978971, loss_d: 0.498231
0.1534 --- loss: 1.650354, loss_ss: 0.975899, loss_d: 0.674455
0.1918 --- loss: 1.771056, loss_ss: 1.316694, loss_d: 0.454362
0.2301 --- loss: 1.898565, loss_ss: 1.146500, loss_d: 0.752064
0.2685 --- loss: 1.572474, loss_ss: 1.047068, loss_d: 0.525406
0.3069 --- loss: 1.732268, loss_ss: 1.235105, loss_d: 0.497163
0.3452 --- loss: 1.813438, loss_ss: 1.110115, loss_d: 0.703323
0.3836 --- loss: 1.774828, loss_ss: 1.070027, loss_d: 0.704801
0.4219 --- loss: 1.600128, loss_ss: 1.058878, loss_d: 0.541250
0.4603 --- loss: 2.010179, loss_ss: 1.304137, loss_d: 0.706041
0.4987 --- loss: 1.575899, loss_ss: 0.894040, loss_d: 0.681859
0.5370 --- loss: 1.901643, loss_ss: 0.949324, loss_d: 0.952319
0.5754 --- loss: 1.621459, loss_ss: 1.067738, loss_d: 0.553721
0.6137 --- loss: 1.426064, loss_ss: 0.989601, loss_d: 0.436463
0.6521 --- loss: 1.951167, loss_ss: 1.220286, loss_d: 0.730881
0.6904 --- loss: 1.542233, loss_ss: 1.021220, loss_d: 0.521014
0.7288 --- loss: 1.282385, loss_ss: 0.940166, loss_d: 0.342219
0.7672 --- loss: 1.304896, loss_ss: 0.827838, loss_d: 0.477058
0.8055 --- loss: 1.731083, loss_ss: 0.845909, loss_d: 0.885174
0.8439 --- loss: 1.704921, loss_ss: 1.274783, loss_d: 0.430137
0.8822 --- loss: 1.594813, loss_ss: 0.907696, loss_d: 0.687118
0.9206 --- loss: 1.458333, loss_ss: 1.055203, loss_d: 0.403130
0.9590 --- loss: 1.691750, loss_ss: 0.888239, loss_d: 0.803511
0.9973 --- loss: 1.221726, loss_ss: 0.799836, loss_d: 0.421890
Epoch finished! Loss: 1.6722706698454344
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.320771, loss_ss: 0.845597, loss_d: 0.475174
0.0384 --- loss: 1.561381, loss_ss: 1.000750, loss_d: 0.560632
0.0767 --- loss: 1.714013, loss_ss: 1.188999, loss_d: 0.525014
0.1151 --- loss: 1.617743, loss_ss: 1.238533, loss_d: 0.379209
0.1534 --- loss: 1.539751, loss_ss: 0.878980, loss_d: 0.660772
0.1918 --- loss: 1.641543, loss_ss: 1.131856, loss_d: 0.509687
0.2301 --- loss: 1.804377, loss_ss: 1.045471, loss_d: 0.758906
0.2685 --- loss: 1.490662, loss_ss: 1.078695, loss_d: 0.411967
0.3069 --- loss: 1.939844, loss_ss: 1.090199, loss_d: 0.849645
0.3452 --- loss: 1.814529, loss_ss: 1.078349, loss_d: 0.736180
0.3836 --- loss: 1.516684, loss_ss: 1.081236, loss_d: 0.435448
0.4219 --- loss: 1.759496, loss_ss: 1.202058, loss_d: 0.557437
0.4603 --- loss: 1.543604, loss_ss: 0.983545, loss_d: 0.560059
0.4987 --- loss: 1.652815, loss_ss: 1.078197, loss_d: 0.574618
0.5370 --- loss: 1.483266, loss_ss: 0.889875, loss_d: 0.593391
0.5754 --- loss: 1.314305, loss_ss: 0.957517, loss_d: 0.356788
0.6137 --- loss: 1.320734, loss_ss: 0.887926, loss_d: 0.432808
0.6521 --- loss: 1.511261, loss_ss: 0.909955, loss_d: 0.601307
0.6904 --- loss: 1.512802, loss_ss: 0.923306, loss_d: 0.589496
0.7288 --- loss: 1.355940, loss_ss: 0.913046, loss_d: 0.442894
0.7672 --- loss: 1.557584, loss_ss: 0.943087, loss_d: 0.614497
0.8055 --- loss: 1.813398, loss_ss: 0.926476, loss_d: 0.886922
0.8439 --- loss: 1.218277, loss_ss: 0.760281, loss_d: 0.457997
0.8822 --- loss: 1.476860, loss_ss: 0.848855, loss_d: 0.628005
0.9206 --- loss: 1.976651, loss_ss: 1.060042, loss_d: 0.916609
0.9590 --- loss: 1.620326, loss_ss: 1.022051, loss_d: 0.598275
0.9973 --- loss: 1.444028, loss_ss: 0.995579, loss_d: 0.448449
Epoch finished! Loss: 1.6230552829228915
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.667847, loss_ss: 1.111793, loss_d: 0.556054
0.0384 --- loss: 1.272186, loss_ss: 0.887378, loss_d: 0.384808
0.0767 --- loss: 1.894235, loss_ss: 1.041924, loss_d: 0.852311
0.1151 --- loss: 1.358437, loss_ss: 0.781112, loss_d: 0.577325
0.1534 --- loss: 1.420581, loss_ss: 1.089714, loss_d: 0.330867
0.1918 --- loss: 1.773972, loss_ss: 0.950841, loss_d: 0.823131
0.2301 --- loss: 1.533350, loss_ss: 0.854819, loss_d: 0.678531
0.2685 --- loss: 1.540728, loss_ss: 0.923730, loss_d: 0.616998
0.3069 --- loss: 1.449182, loss_ss: 0.786832, loss_d: 0.662350
0.3452 --- loss: 1.373469, loss_ss: 0.926993, loss_d: 0.446475
0.3836 --- loss: 1.694503, loss_ss: 1.112454, loss_d: 0.582049
0.4219 --- loss: 1.251750, loss_ss: 0.917712, loss_d: 0.334038
0.4603 --- loss: 1.525687, loss_ss: 0.878091, loss_d: 0.647596
0.4987 --- loss: 1.576474, loss_ss: 0.920326, loss_d: 0.656148
0.5370 --- loss: 1.310062, loss_ss: 0.854084, loss_d: 0.455978
0.5754 --- loss: 1.557393, loss_ss: 0.725609, loss_d: 0.831784
0.6137 --- loss: 1.283876, loss_ss: 0.923917, loss_d: 0.359959
0.6521 --- loss: 1.870417, loss_ss: 0.947900, loss_d: 0.922517
0.6904 --- loss: 1.676646, loss_ss: 1.043789, loss_d: 0.632857
0.7288 --- loss: 1.621576, loss_ss: 1.025015, loss_d: 0.596561
0.7672 --- loss: 2.191507, loss_ss: 1.034680, loss_d: 1.156827
0.8055 --- loss: 1.670109, loss_ss: 1.247638, loss_d: 0.422471
0.8439 --- loss: 1.327635, loss_ss: 0.946993, loss_d: 0.380643
0.8822 --- loss: 1.470881, loss_ss: 0.806464, loss_d: 0.664417
0.9206 --- loss: 1.835176, loss_ss: 1.058469, loss_d: 0.776707
0.9590 --- loss: 1.398575, loss_ss: 0.818684, loss_d: 0.579891
0.9973 --- loss: 1.649381, loss_ss: 1.167003, loss_d: 0.482378
Epoch finished! Loss: 1.5623731416005355
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.529911, loss_ss: 0.996186, loss_d: 0.533725
0.0384 --- loss: 1.742881, loss_ss: 0.799743, loss_d: 0.943138
0.0767 --- loss: 1.622879, loss_ss: 1.045392, loss_d: 0.577487
0.1151 --- loss: 1.859294, loss_ss: 0.822469, loss_d: 1.036825
0.1534 --- loss: 2.288515, loss_ss: 1.807299, loss_d: 0.481216
0.1918 --- loss: 1.043572, loss_ss: 0.714541, loss_d: 0.329032
0.2301 --- loss: 1.369108, loss_ss: 0.870769, loss_d: 0.498339
0.2685 --- loss: 1.477973, loss_ss: 1.208945, loss_d: 0.269029
0.3069 --- loss: 1.618440, loss_ss: 1.264407, loss_d: 0.354033
0.3452 --- loss: 1.563602, loss_ss: 0.861618, loss_d: 0.701984
0.3836 --- loss: 1.287921, loss_ss: 0.900724, loss_d: 0.387197
0.4219 --- loss: 1.230384, loss_ss: 0.767030, loss_d: 0.463354
0.4603 --- loss: 1.855265, loss_ss: 1.083295, loss_d: 0.771971
0.4987 --- loss: 1.571523, loss_ss: 1.074007, loss_d: 0.497516
0.5370 --- loss: 1.229569, loss_ss: 0.848573, loss_d: 0.380995
0.5754 --- loss: 1.541050, loss_ss: 0.985168, loss_d: 0.555883
0.6137 --- loss: 1.534435, loss_ss: 0.948754, loss_d: 0.585681
0.6521 --- loss: 2.005459, loss_ss: 0.915300, loss_d: 1.090159
0.6904 --- loss: 1.309354, loss_ss: 0.933936, loss_d: 0.375418
0.7288 --- loss: 1.497288, loss_ss: 0.787294, loss_d: 0.709994
0.7672 --- loss: 1.241195, loss_ss: 0.833711, loss_d: 0.407483
0.8055 --- loss: 1.555282, loss_ss: 1.036855, loss_d: 0.518427
0.8439 --- loss: 2.100333, loss_ss: 0.756983, loss_d: 1.343351
0.8822 --- loss: 1.205400, loss_ss: 0.966718, loss_d: 0.238682
0.9206 --- loss: 1.683130, loss_ss: 1.027595, loss_d: 0.655534
0.9590 --- loss: 1.804609, loss_ss: 1.526421, loss_d: 0.278188
0.9973 --- loss: 1.470284, loss_ss: 1.104999, loss_d: 0.365285
Epoch finished! Loss: 1.4751859323336527
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.657758, loss_ss: 1.101111, loss_d: 0.556647
0.0384 --- loss: 1.638796, loss_ss: 0.801127, loss_d: 0.837669
0.0767 --- loss: 1.657425, loss_ss: 1.248832, loss_d: 0.408593
0.1151 --- loss: 1.561898, loss_ss: 1.316601, loss_d: 0.245298
0.1534 --- loss: 1.205730, loss_ss: 1.021783, loss_d: 0.183947
0.1918 --- loss: 1.839681, loss_ss: 0.971403, loss_d: 0.868278
0.2301 --- loss: 1.754636, loss_ss: 0.954877, loss_d: 0.799759
0.2685 --- loss: 1.650732, loss_ss: 1.224333, loss_d: 0.426399
0.3069 --- loss: 1.643346, loss_ss: 1.240009, loss_d: 0.403337
0.3452 --- loss: 1.612098, loss_ss: 0.871714, loss_d: 0.740384
0.3836 --- loss: 1.421210, loss_ss: 1.055268, loss_d: 0.365942
0.4219 --- loss: 1.498793, loss_ss: 1.000807, loss_d: 0.497985
0.4603 --- loss: 1.257563, loss_ss: 0.997862, loss_d: 0.259701
0.4987 --- loss: 1.155641, loss_ss: 0.941154, loss_d: 0.214486
0.5370 --- loss: 0.938470, loss_ss: 0.771178, loss_d: 0.167292
0.5754 --- loss: 1.679163, loss_ss: 0.887118, loss_d: 0.792045
0.6137 --- loss: 1.116202, loss_ss: 0.805843, loss_d: 0.310359
0.6521 --- loss: 1.407370, loss_ss: 0.937502, loss_d: 0.469868
0.6904 --- loss: 1.676929, loss_ss: 0.905746, loss_d: 0.771182
0.7288 --- loss: 1.335876, loss_ss: 0.700719, loss_d: 0.635156
0.7672 --- loss: 1.082833, loss_ss: 0.873168, loss_d: 0.209665
0.8055 --- loss: 1.613381, loss_ss: 1.165559, loss_d: 0.447821
0.8439 --- loss: 1.851283, loss_ss: 1.145820, loss_d: 0.705462
0.8822 --- loss: 1.433507, loss_ss: 0.891052, loss_d: 0.542455
0.9206 --- loss: 1.307357, loss_ss: 0.894669, loss_d: 0.412688
0.9590 --- loss: 1.346762, loss_ss: 1.027142, loss_d: 0.319620
0.9973 --- loss: 1.167678, loss_ss: 0.777867, loss_d: 0.389811
Epoch finished! Loss: 1.4214494116031207
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.618817, loss_ss: 1.160847, loss_d: 0.457970
0.0384 --- loss: 1.546025, loss_ss: 1.024064, loss_d: 0.521962
0.0767 --- loss: 1.265939, loss_ss: 0.940413, loss_d: 0.325526
0.1151 --- loss: 1.170521, loss_ss: 0.891419, loss_d: 0.279102
0.1534 --- loss: 1.278240, loss_ss: 1.033582, loss_d: 0.244658
0.1918 --- loss: 1.534403, loss_ss: 0.953447, loss_d: 0.580955
0.2301 --- loss: 1.613642, loss_ss: 0.776760, loss_d: 0.836882
0.2685 --- loss: 1.295780, loss_ss: 1.037053, loss_d: 0.258728
0.3069 --- loss: 1.674043, loss_ss: 1.248407, loss_d: 0.425636
0.3452 --- loss: 1.099998, loss_ss: 0.946027, loss_d: 0.153971
0.3836 --- loss: 1.084905, loss_ss: 0.869954, loss_d: 0.214952
0.4219 --- loss: 0.972319, loss_ss: 0.661861, loss_d: 0.310459
0.4603 --- loss: 1.739705, loss_ss: 1.318712, loss_d: 0.420993
0.4987 --- loss: 1.429827, loss_ss: 0.917644, loss_d: 0.512184
0.5370 --- loss: 1.196800, loss_ss: 0.795105, loss_d: 0.401696
0.5754 --- loss: 1.631418, loss_ss: 1.094563, loss_d: 0.536855
0.6137 --- loss: 1.452051, loss_ss: 0.775798, loss_d: 0.676253
0.6521 --- loss: 1.319122, loss_ss: 0.776547, loss_d: 0.542575
0.6904 --- loss: 1.186017, loss_ss: 1.000771, loss_d: 0.185245
0.7288 --- loss: 1.552804, loss_ss: 1.088133, loss_d: 0.464671
0.7672 --- loss: 1.518757, loss_ss: 1.133168, loss_d: 0.385589
0.8055 --- loss: 1.684746, loss_ss: 1.279489, loss_d: 0.405257
0.8439 --- loss: 1.347075, loss_ss: 0.701917, loss_d: 0.645158
0.8822 --- loss: 1.121155, loss_ss: 0.802195, loss_d: 0.318960
0.9206 --- loss: 1.993805, loss_ss: 1.211469, loss_d: 0.782336
0.9590 --- loss: 1.488122, loss_ss: 1.184677, loss_d: 0.303446
0.9973 --- loss: 0.955432, loss_ss: 0.771754, loss_d: 0.183678
Epoch finished! Loss: 1.3568200640953505
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.464797, loss_ss: 1.202041, loss_d: 0.262755
0.0384 --- loss: 1.023464, loss_ss: 0.875258, loss_d: 0.148206
0.0767 --- loss: 1.221304, loss_ss: 0.927949, loss_d: 0.293356
0.1151 --- loss: 1.034335, loss_ss: 0.793542, loss_d: 0.240793
0.1534 --- loss: 1.388228, loss_ss: 0.799232, loss_d: 0.588996
0.1918 --- loss: 1.146043, loss_ss: 0.928942, loss_d: 0.217101
0.2301 --- loss: 1.178664, loss_ss: 0.994190, loss_d: 0.184474
0.2685 --- loss: 2.027511, loss_ss: 1.406848, loss_d: 0.620663
0.3069 --- loss: 0.992299, loss_ss: 0.727229, loss_d: 0.265070
0.3452 --- loss: 1.059512, loss_ss: 0.822199, loss_d: 0.237313
0.3836 --- loss: 0.942043, loss_ss: 0.766223, loss_d: 0.175821
0.4219 --- loss: 1.222827, loss_ss: 0.881104, loss_d: 0.341723
0.4603 --- loss: 1.442994, loss_ss: 1.039260, loss_d: 0.403735
0.4987 --- loss: 1.615478, loss_ss: 0.954980, loss_d: 0.660498
0.5370 --- loss: 1.718499, loss_ss: 0.724460, loss_d: 0.994040
0.5754 --- loss: 1.492148, loss_ss: 1.146142, loss_d: 0.346006
0.6137 --- loss: 1.382102, loss_ss: 0.837002, loss_d: 0.545101
0.6521 --- loss: 1.145808, loss_ss: 0.880698, loss_d: 0.265110
0.6904 --- loss: 0.966749, loss_ss: 0.676094, loss_d: 0.290655
0.7288 --- loss: 1.416517, loss_ss: 1.296297, loss_d: 0.120221
0.7672 --- loss: 1.264445, loss_ss: 1.026829, loss_d: 0.237615
0.8055 --- loss: 2.022741, loss_ss: 1.403019, loss_d: 0.619722
0.8439 --- loss: 1.824360, loss_ss: 0.892207, loss_d: 0.932153
0.8822 --- loss: 1.143387, loss_ss: 0.657747, loss_d: 0.485640
0.9206 --- loss: 1.284077, loss_ss: 1.030432, loss_d: 0.253645
0.9590 --- loss: 1.468688, loss_ss: 1.195714, loss_d: 0.272973
0.9973 --- loss: 1.517560, loss_ss: 1.016502, loss_d: 0.501058
Epoch finished! Loss: 1.2783578998767413
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.227098, loss_ss: 1.021753, loss_d: 0.205344
0.0384 --- loss: 1.262744, loss_ss: 0.915082, loss_d: 0.347662
0.0767 --- loss: 1.000279, loss_ss: 0.826489, loss_d: 0.173790
0.1151 --- loss: 1.427333, loss_ss: 0.880731, loss_d: 0.546601
0.1534 --- loss: 1.004070, loss_ss: 0.517007, loss_d: 0.487063
0.1918 --- loss: 1.677260, loss_ss: 0.815434, loss_d: 0.861827
0.2301 --- loss: 1.163403, loss_ss: 0.913536, loss_d: 0.249867
0.2685 --- loss: 1.004367, loss_ss: 0.741628, loss_d: 0.262739
0.3069 --- loss: 1.298080, loss_ss: 1.003049, loss_d: 0.295031
0.3452 --- loss: 1.126853, loss_ss: 0.908891, loss_d: 0.217962
0.3836 --- loss: 1.025385, loss_ss: 0.905076, loss_d: 0.120309
0.4219 --- loss: 0.877997, loss_ss: 0.804426, loss_d: 0.073571
0.4603 --- loss: 1.307258, loss_ss: 0.773086, loss_d: 0.534172
0.4987 --- loss: 1.519698, loss_ss: 1.215301, loss_d: 0.304397
0.5370 --- loss: 1.106824, loss_ss: 0.879250, loss_d: 0.227574
0.5754 --- loss: 1.379873, loss_ss: 0.997423, loss_d: 0.382450
0.6137 --- loss: 1.144951, loss_ss: 0.772370, loss_d: 0.372580
0.6521 --- loss: 1.207475, loss_ss: 0.956922, loss_d: 0.250554
0.6904 --- loss: 1.646091, loss_ss: 1.333968, loss_d: 0.312123
0.7288 --- loss: 1.325678, loss_ss: 0.893280, loss_d: 0.432398
0.7672 --- loss: 1.125104, loss_ss: 0.911839, loss_d: 0.213264
0.8055 --- loss: 1.321892, loss_ss: 0.712123, loss_d: 0.609770
0.8439 --- loss: 1.049756, loss_ss: 0.871892, loss_d: 0.177864
0.8822 --- loss: 1.117252, loss_ss: 0.807944, loss_d: 0.309309
0.9206 --- loss: 1.143741, loss_ss: 0.952241, loss_d: 0.191500
0.9590 --- loss: 1.234103, loss_ss: 0.971978, loss_d: 0.262125
0.9973 --- loss: 1.401389, loss_ss: 0.754560, loss_d: 0.646828
Epoch finished! Loss: 1.212346436197941
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6935483870967742
             precision    recall  f1-score   support

        0.0       0.49      0.96      0.65       119
        1.0       0.00      0.00      0.00        37
        2.0       0.88      0.47      0.61       387
        3.0       0.74      0.95      0.83       263
        4.0       0.68      0.81      0.74       124

avg / total       0.73      0.69      0.67       930
 


====== chp008-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  86.67  95.80   85.33  48.93     64.77
1  95.48   0.00   99.44   0.00      0.00
2  75.27  47.03   95.40  87.92     61.28
3  88.92  94.68   86.66  73.67     82.86
4  92.37  80.65   94.17  68.03     73.80
Total accuracy: 69.35%
Average sen: 63.63%
Average spec: 92.20%
Macro f1-score: 56.54%
[0.43770516 0.85873634 0.96572345 0.98236454 0.98182881 0.38038343
 0.77306658 0.98101431 0.76833767 0.87571317 0.98991513 0.59308797
 0.72283095 0.45777357 0.79817402 0.746544   0.94595492 0.9477492
 0.97203648 0.49111146 0.83368564 0.96256781 0.54175967 0.94165087
 0.84235889 0.97973609 0.89593148 0.46659297 0.68946886 0.99751818
 0.9976241 ]
pred: 0.8006111518029244, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.462966, loss_ss: 1.758181, loss_d: 0.704786
0.0384 --- loss: 2.247838, loss_ss: 1.571235, loss_d: 0.676603
0.0768 --- loss: 2.139590, loss_ss: 1.506270, loss_d: 0.633320
0.1152 --- loss: 2.217811, loss_ss: 1.525521, loss_d: 0.692290
0.1536 --- loss: 2.189179, loss_ss: 1.525603, loss_d: 0.663576
0.1920 --- loss: 2.229360, loss_ss: 1.497156, loss_d: 0.732204
0.2304 --- loss: 2.225776, loss_ss: 1.510215, loss_d: 0.715562
0.2688 --- loss: 2.014113, loss_ss: 1.566132, loss_d: 0.447981
0.3072 --- loss: 1.955725, loss_ss: 1.495048, loss_d: 0.460677
0.3456 --- loss: 2.122218, loss_ss: 1.445382, loss_d: 0.676837
0.3840 --- loss: 1.911012, loss_ss: 1.299856, loss_d: 0.611156
0.4224 --- loss: 1.994536, loss_ss: 1.402554, loss_d: 0.591982
0.4608 --- loss: 2.086201, loss_ss: 1.260249, loss_d: 0.825952
0.4992 --- loss: 1.968555, loss_ss: 1.247838, loss_d: 0.720717
0.5376 --- loss: 2.169944, loss_ss: 1.261677, loss_d: 0.908267
0.5760 --- loss: 1.934216, loss_ss: 1.318681, loss_d: 0.615536
0.6144 --- loss: 1.938832, loss_ss: 1.386742, loss_d: 0.552090
0.6528 --- loss: 1.998718, loss_ss: 1.319093, loss_d: 0.679625
0.6912 --- loss: 1.815512, loss_ss: 1.271802, loss_d: 0.543709
0.7296 --- loss: 1.982954, loss_ss: 1.311804, loss_d: 0.671150
0.7680 --- loss: 1.610606, loss_ss: 1.177493, loss_d: 0.433114
0.8065 --- loss: 2.052789, loss_ss: 1.383795, loss_d: 0.668994
0.8449 --- loss: 1.885915, loss_ss: 1.156024, loss_d: 0.729891
0.8833 --- loss: 1.848098, loss_ss: 1.303846, loss_d: 0.544252
0.9217 --- loss: 1.977899, loss_ss: 1.479480, loss_d: 0.498420
0.9601 --- loss: 1.705455, loss_ss: 1.001671, loss_d: 0.703784
0.9985 --- loss: 1.693902, loss_ss: 1.362183, loss_d: 0.331719
Epoch finished! Loss: 1.9737812638282777
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.597680, loss_ss: 1.079418, loss_d: 0.518263
0.0384 --- loss: 1.349780, loss_ss: 0.973758, loss_d: 0.376021
0.0768 --- loss: 1.656665, loss_ss: 1.063097, loss_d: 0.593568
0.1152 --- loss: 1.529304, loss_ss: 1.004953, loss_d: 0.524351
0.1536 --- loss: 1.815053, loss_ss: 1.084917, loss_d: 0.730136
0.1920 --- loss: 1.557434, loss_ss: 0.998437, loss_d: 0.558997
0.2304 --- loss: 1.767597, loss_ss: 1.270875, loss_d: 0.496722
0.2688 --- loss: 1.984008, loss_ss: 1.245846, loss_d: 0.738162
0.3072 --- loss: 1.702488, loss_ss: 1.236566, loss_d: 0.465923
0.3456 --- loss: 1.639856, loss_ss: 1.098242, loss_d: 0.541614
0.3840 --- loss: 1.364945, loss_ss: 0.798987, loss_d: 0.565958
0.4224 --- loss: 1.990916, loss_ss: 1.091922, loss_d: 0.898994
0.4608 --- loss: 1.586578, loss_ss: 0.980580, loss_d: 0.605998
0.4992 --- loss: 1.779420, loss_ss: 1.106166, loss_d: 0.673254
0.5376 --- loss: 1.567922, loss_ss: 1.056934, loss_d: 0.510988
0.5760 --- loss: 1.756334, loss_ss: 1.125983, loss_d: 0.630350
0.6144 --- loss: 1.934913, loss_ss: 1.041762, loss_d: 0.893152
0.6528 --- loss: 1.704965, loss_ss: 0.982520, loss_d: 0.722445
0.6912 --- loss: 1.706784, loss_ss: 1.233790, loss_d: 0.472993
0.7296 --- loss: 1.744494, loss_ss: 0.820106, loss_d: 0.924388
0.7680 --- loss: 1.542978, loss_ss: 0.962049, loss_d: 0.580929
0.8065 --- loss: 1.760551, loss_ss: 1.190999, loss_d: 0.569551
0.8449 --- loss: 2.021798, loss_ss: 1.333155, loss_d: 0.688644
0.8833 --- loss: 1.600303, loss_ss: 0.927261, loss_d: 0.673042
0.9217 --- loss: 1.351164, loss_ss: 1.029814, loss_d: 0.321350
0.9601 --- loss: 1.945415, loss_ss: 0.969472, loss_d: 0.975943
0.9985 --- loss: 1.925314, loss_ss: 1.098105, loss_d: 0.827209
Epoch finished! Loss: 1.6789242441837604
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.778740, loss_ss: 1.235949, loss_d: 0.542792
0.0384 --- loss: 1.461193, loss_ss: 0.911603, loss_d: 0.549590
0.0768 --- loss: 1.685890, loss_ss: 0.858510, loss_d: 0.827380
0.1152 --- loss: 1.380800, loss_ss: 0.980061, loss_d: 0.400739
0.1536 --- loss: 1.627162, loss_ss: 1.073714, loss_d: 0.553447
0.1920 --- loss: 1.478931, loss_ss: 1.097090, loss_d: 0.381842
0.2304 --- loss: 1.647936, loss_ss: 0.954201, loss_d: 0.693734
0.2688 --- loss: 1.658502, loss_ss: 1.102100, loss_d: 0.556402
0.3072 --- loss: 1.880906, loss_ss: 1.135555, loss_d: 0.745351
0.3456 --- loss: 1.265984, loss_ss: 0.910717, loss_d: 0.355267
0.3840 --- loss: 1.140404, loss_ss: 0.861984, loss_d: 0.278419
0.4224 --- loss: 1.248736, loss_ss: 0.929929, loss_d: 0.318807
0.4608 --- loss: 1.273189, loss_ss: 0.899688, loss_d: 0.373501
0.4992 --- loss: 1.597114, loss_ss: 1.127410, loss_d: 0.469704
0.5376 --- loss: 1.642242, loss_ss: 1.225108, loss_d: 0.417134
0.5760 --- loss: 1.315894, loss_ss: 0.970847, loss_d: 0.345048
0.6144 --- loss: 1.529756, loss_ss: 0.908728, loss_d: 0.621028
0.6528 --- loss: 1.742043, loss_ss: 1.143869, loss_d: 0.598174
0.6912 --- loss: 1.481369, loss_ss: 0.936794, loss_d: 0.544576
0.7296 --- loss: 1.432967, loss_ss: 0.932009, loss_d: 0.500958
0.7680 --- loss: 1.666496, loss_ss: 1.255443, loss_d: 0.411053
0.8065 --- loss: 1.907358, loss_ss: 0.967441, loss_d: 0.939916
0.8449 --- loss: 1.237781, loss_ss: 0.823295, loss_d: 0.414486
0.8833 --- loss: 1.412582, loss_ss: 0.949579, loss_d: 0.463003
0.9217 --- loss: 1.494639, loss_ss: 0.998466, loss_d: 0.496174
0.9601 --- loss: 1.589449, loss_ss: 1.077613, loss_d: 0.511836
0.9985 --- loss: 1.716418, loss_ss: 0.921320, loss_d: 0.795097
Epoch finished! Loss: 1.5571804110820477
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.590993, loss_ss: 0.897131, loss_d: 0.693862
0.0384 --- loss: 1.473033, loss_ss: 1.136345, loss_d: 0.336688
0.0768 --- loss: 1.577076, loss_ss: 0.953713, loss_d: 0.623363
0.1152 --- loss: 2.028796, loss_ss: 1.146179, loss_d: 0.882618
0.1536 --- loss: 1.556910, loss_ss: 0.821470, loss_d: 0.735440
0.1920 --- loss: 1.644137, loss_ss: 1.051194, loss_d: 0.592944
0.2304 --- loss: 1.512825, loss_ss: 0.921939, loss_d: 0.590886
0.2688 --- loss: 1.416284, loss_ss: 0.860505, loss_d: 0.555779
0.3072 --- loss: 1.715187, loss_ss: 0.986742, loss_d: 0.728445
0.3456 --- loss: 1.520060, loss_ss: 0.885697, loss_d: 0.634363
0.3840 --- loss: 1.775592, loss_ss: 1.101557, loss_d: 0.674035
0.4224 --- loss: 1.117505, loss_ss: 0.819718, loss_d: 0.297787
0.4608 --- loss: 1.671188, loss_ss: 1.098528, loss_d: 0.572661
0.4992 --- loss: 1.085998, loss_ss: 0.648016, loss_d: 0.437982
0.5376 --- loss: 1.467322, loss_ss: 0.782626, loss_d: 0.684696
0.5760 --- loss: 1.358272, loss_ss: 1.017399, loss_d: 0.340873
0.6144 --- loss: 1.823837, loss_ss: 0.874419, loss_d: 0.949418
0.6528 --- loss: 1.668961, loss_ss: 1.193619, loss_d: 0.475342
0.6912 --- loss: 1.253744, loss_ss: 0.961857, loss_d: 0.291887
0.7296 --- loss: 1.302399, loss_ss: 0.806762, loss_d: 0.495637
0.7680 --- loss: 1.524397, loss_ss: 0.972402, loss_d: 0.551995
0.8065 --- loss: 1.540106, loss_ss: 1.022292, loss_d: 0.517814
0.8449 --- loss: 1.246235, loss_ss: 0.864257, loss_d: 0.381978
0.8833 --- loss: 1.576997, loss_ss: 1.031680, loss_d: 0.545316
0.9217 --- loss: 1.219662, loss_ss: 0.680425, loss_d: 0.539237
0.9601 --- loss: 1.195580, loss_ss: 0.839265, loss_d: 0.356315
0.9985 --- loss: 1.729494, loss_ss: 1.416710, loss_d: 0.312784
Epoch finished! Loss: 1.5019485927545106
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.308729, loss_ss: 0.876191, loss_d: 0.432538
0.0384 --- loss: 1.461679, loss_ss: 1.198179, loss_d: 0.263500
0.0768 --- loss: 1.818377, loss_ss: 0.977774, loss_d: 0.840603
0.1152 --- loss: 1.402547, loss_ss: 1.066613, loss_d: 0.335933
0.1536 --- loss: 1.353590, loss_ss: 1.030502, loss_d: 0.323088
0.1920 --- loss: 1.678991, loss_ss: 1.035252, loss_d: 0.643739
0.2304 --- loss: 1.409598, loss_ss: 1.133118, loss_d: 0.276480
0.2688 --- loss: 1.427347, loss_ss: 0.877768, loss_d: 0.549579
0.3072 --- loss: 1.260827, loss_ss: 0.768972, loss_d: 0.491854
0.3456 --- loss: 1.362499, loss_ss: 0.910788, loss_d: 0.451710
0.3840 --- loss: 1.281929, loss_ss: 0.952821, loss_d: 0.329108
0.4224 --- loss: 1.233453, loss_ss: 0.760432, loss_d: 0.473021
0.4608 --- loss: 1.492140, loss_ss: 0.931556, loss_d: 0.560584
0.4992 --- loss: 2.119306, loss_ss: 1.112684, loss_d: 1.006622
0.5376 --- loss: 1.087672, loss_ss: 0.568768, loss_d: 0.518904
0.5760 --- loss: 1.221030, loss_ss: 0.661114, loss_d: 0.559916
0.6144 --- loss: 1.248334, loss_ss: 1.064109, loss_d: 0.184224
0.6528 --- loss: 1.572926, loss_ss: 0.825975, loss_d: 0.746951
0.6912 --- loss: 1.559530, loss_ss: 0.814032, loss_d: 0.745499
0.7296 --- loss: 1.211609, loss_ss: 0.827393, loss_d: 0.384217
0.7680 --- loss: 1.200933, loss_ss: 0.966019, loss_d: 0.234913
0.8065 --- loss: 1.610923, loss_ss: 0.836900, loss_d: 0.774023
0.8449 --- loss: 1.530569, loss_ss: 1.098926, loss_d: 0.431643
0.8833 --- loss: 1.152859, loss_ss: 0.695965, loss_d: 0.456893
0.9217 --- loss: 1.020975, loss_ss: 0.602407, loss_d: 0.418567
0.9601 --- loss: 1.256757, loss_ss: 0.800633, loss_d: 0.456123
0.9985 --- loss: 1.108241, loss_ss: 0.769622, loss_d: 0.338619
Epoch finished! Loss: 1.39367653635832
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.100015, loss_ss: 0.888224, loss_d: 0.211790
0.0384 --- loss: 1.362163, loss_ss: 0.795647, loss_d: 0.566515
0.0768 --- loss: 1.069682, loss_ss: 0.832128, loss_d: 0.237554
0.1152 --- loss: 1.107356, loss_ss: 0.889326, loss_d: 0.218031
0.1536 --- loss: 1.576826, loss_ss: 1.010025, loss_d: 0.566801
0.1920 --- loss: 1.238892, loss_ss: 1.011583, loss_d: 0.227309
0.2304 --- loss: 1.686998, loss_ss: 1.278223, loss_d: 0.408775
0.2688 --- loss: 1.288736, loss_ss: 0.971259, loss_d: 0.317476
0.3072 --- loss: 1.262035, loss_ss: 1.019245, loss_d: 0.242791
0.3456 --- loss: 0.979010, loss_ss: 0.729552, loss_d: 0.249458
0.3840 --- loss: 1.222065, loss_ss: 0.924017, loss_d: 0.298048
0.4224 --- loss: 0.991808, loss_ss: 0.784769, loss_d: 0.207038
0.4608 --- loss: 1.291182, loss_ss: 0.741504, loss_d: 0.549677
0.4992 --- loss: 1.095791, loss_ss: 0.883304, loss_d: 0.212487
0.5376 --- loss: 1.275642, loss_ss: 0.875610, loss_d: 0.400033
0.5760 --- loss: 1.215967, loss_ss: 0.999447, loss_d: 0.216520
0.6144 --- loss: 1.517941, loss_ss: 1.122607, loss_d: 0.395334
0.6528 --- loss: 1.547880, loss_ss: 0.969993, loss_d: 0.577887
0.6912 --- loss: 1.201852, loss_ss: 0.961920, loss_d: 0.239932
0.7296 --- loss: 1.258377, loss_ss: 0.963090, loss_d: 0.295287
0.7680 --- loss: 0.987137, loss_ss: 0.692359, loss_d: 0.294778
0.8065 --- loss: 0.964983, loss_ss: 0.782073, loss_d: 0.182910
0.8449 --- loss: 1.162957, loss_ss: 0.926197, loss_d: 0.236759
0.8833 --- loss: 1.297601, loss_ss: 0.859904, loss_d: 0.437698
0.9217 --- loss: 1.742733, loss_ss: 0.894798, loss_d: 0.847935
0.9601 --- loss: 1.293510, loss_ss: 1.003996, loss_d: 0.289514
0.9985 --- loss: 1.392855, loss_ss: 1.244231, loss_d: 0.148623
Epoch finished! Loss: 1.293058478144499
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.195700, loss_ss: 0.866968, loss_d: 0.328732
0.0384 --- loss: 1.070159, loss_ss: 0.617845, loss_d: 0.452314
0.0768 --- loss: 1.315019, loss_ss: 0.923863, loss_d: 0.391157
0.1152 --- loss: 1.814431, loss_ss: 1.232324, loss_d: 0.582108
0.1536 --- loss: 1.223282, loss_ss: 0.968617, loss_d: 0.254665
0.1920 --- loss: 1.170013, loss_ss: 0.850497, loss_d: 0.319516
0.2304 --- loss: 1.183181, loss_ss: 0.963862, loss_d: 0.219318
0.2688 --- loss: 1.652784, loss_ss: 1.367934, loss_d: 0.284850
0.3072 --- loss: 1.415363, loss_ss: 0.774092, loss_d: 0.641271
0.3456 --- loss: 0.908237, loss_ss: 0.691188, loss_d: 0.217049
0.3840 --- loss: 0.924605, loss_ss: 0.735438, loss_d: 0.189168
0.4224 --- loss: 0.898258, loss_ss: 0.674869, loss_d: 0.223389
0.4608 --- loss: 1.205482, loss_ss: 0.786778, loss_d: 0.418704
0.4992 --- loss: 1.245511, loss_ss: 0.827937, loss_d: 0.417574
0.5376 --- loss: 1.242066, loss_ss: 1.067341, loss_d: 0.174725
0.5760 --- loss: 1.954810, loss_ss: 0.987823, loss_d: 0.966987
0.6144 --- loss: 1.356445, loss_ss: 0.935681, loss_d: 0.420763
0.6528 --- loss: 1.280398, loss_ss: 0.790331, loss_d: 0.490066
0.6912 --- loss: 1.496757, loss_ss: 1.098895, loss_d: 0.397862
0.7296 --- loss: 1.134786, loss_ss: 0.869169, loss_d: 0.265617
0.7680 --- loss: 1.258451, loss_ss: 0.769981, loss_d: 0.488470
0.8065 --- loss: 1.043701, loss_ss: 0.749086, loss_d: 0.294615
0.8449 --- loss: 1.006486, loss_ss: 0.706561, loss_d: 0.299925
0.8833 --- loss: 1.053887, loss_ss: 0.741654, loss_d: 0.312232
0.9217 --- loss: 1.133487, loss_ss: 0.904801, loss_d: 0.228685
0.9601 --- loss: 1.307243, loss_ss: 0.796514, loss_d: 0.510729
0.9985 --- loss: 1.574640, loss_ss: 1.181941, loss_d: 0.392700
Epoch finished! Loss: 1.2280025626604374
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.152988, loss_ss: 0.828189, loss_d: 0.324800
0.0384 --- loss: 1.365801, loss_ss: 0.791321, loss_d: 0.574481
0.0768 --- loss: 1.268340, loss_ss: 0.757000, loss_d: 0.511340
0.1152 --- loss: 1.372110, loss_ss: 0.956574, loss_d: 0.415537
0.1536 --- loss: 1.061935, loss_ss: 0.854019, loss_d: 0.207916
0.1920 --- loss: 1.129591, loss_ss: 0.783668, loss_d: 0.345923
0.2304 --- loss: 1.107815, loss_ss: 0.780031, loss_d: 0.327784
0.2688 --- loss: 1.411673, loss_ss: 1.235754, loss_d: 0.175920
0.3072 --- loss: 1.138473, loss_ss: 0.665850, loss_d: 0.472624
0.3456 --- loss: 0.975510, loss_ss: 0.721197, loss_d: 0.254313
0.3840 --- loss: 1.051843, loss_ss: 0.766380, loss_d: 0.285464
0.4224 --- loss: 1.383636, loss_ss: 0.912417, loss_d: 0.471219
0.4608 --- loss: 1.534972, loss_ss: 1.090546, loss_d: 0.444426
0.4992 --- loss: 1.314139, loss_ss: 0.799486, loss_d: 0.514653
0.5376 --- loss: 1.012093, loss_ss: 0.768310, loss_d: 0.243783
0.5760 --- loss: 1.061419, loss_ss: 0.792578, loss_d: 0.268842
0.6144 --- loss: 1.504467, loss_ss: 0.755116, loss_d: 0.749350
0.6528 --- loss: 1.407826, loss_ss: 1.020663, loss_d: 0.387162
0.6912 --- loss: 1.615684, loss_ss: 1.370340, loss_d: 0.245343
0.7296 --- loss: 1.126113, loss_ss: 0.797164, loss_d: 0.328949
0.7680 --- loss: 1.203752, loss_ss: 0.997803, loss_d: 0.205949
0.8065 --- loss: 1.455354, loss_ss: 1.022463, loss_d: 0.432891
0.8449 --- loss: 1.166689, loss_ss: 0.982290, loss_d: 0.184399
0.8833 --- loss: 0.850036, loss_ss: 0.553151, loss_d: 0.296884
0.9217 --- loss: 1.256552, loss_ss: 0.811372, loss_d: 0.445180
0.9601 --- loss: 1.443581, loss_ss: 0.950622, loss_d: 0.492959
0.9985 --- loss: 1.068367, loss_ss: 0.979443, loss_d: 0.088924
Epoch finished! Loss: 1.1994431479619099
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.272348, loss_ss: 0.848053, loss_d: 0.424295
0.0384 --- loss: 0.750305, loss_ss: 0.628241, loss_d: 0.122064
0.0768 --- loss: 0.904951, loss_ss: 0.653878, loss_d: 0.251073
0.1152 --- loss: 0.889607, loss_ss: 0.602626, loss_d: 0.286981
0.1536 --- loss: 1.195598, loss_ss: 0.905196, loss_d: 0.290402
0.1920 --- loss: 1.124300, loss_ss: 0.896063, loss_d: 0.228237
0.2304 --- loss: 1.009915, loss_ss: 0.928712, loss_d: 0.081203
0.2688 --- loss: 1.320505, loss_ss: 0.657675, loss_d: 0.662830
0.3072 --- loss: 1.094456, loss_ss: 0.872509, loss_d: 0.221947
0.3456 --- loss: 1.209111, loss_ss: 0.528609, loss_d: 0.680502
0.3840 --- loss: 0.868686, loss_ss: 0.565489, loss_d: 0.303197
0.4224 --- loss: 0.774635, loss_ss: 0.623779, loss_d: 0.150856
0.4608 --- loss: 1.053965, loss_ss: 0.916404, loss_d: 0.137561
0.4992 --- loss: 1.085123, loss_ss: 0.825214, loss_d: 0.259909
0.5376 --- loss: 0.995502, loss_ss: 0.813290, loss_d: 0.182212
0.5760 --- loss: 1.988775, loss_ss: 1.076767, loss_d: 0.912008
0.6144 --- loss: 1.455606, loss_ss: 0.879014, loss_d: 0.576592
0.6528 --- loss: 0.951917, loss_ss: 0.747725, loss_d: 0.204192
0.6912 --- loss: 1.518174, loss_ss: 0.971329, loss_d: 0.546845
0.7296 --- loss: 1.578813, loss_ss: 1.078896, loss_d: 0.499917
0.7680 --- loss: 1.114072, loss_ss: 0.707602, loss_d: 0.406470
0.8065 --- loss: 1.206180, loss_ss: 1.035903, loss_d: 0.170278
0.8449 --- loss: 1.727073, loss_ss: 1.349737, loss_d: 0.377336
0.8833 --- loss: 1.236643, loss_ss: 1.106281, loss_d: 0.130361
0.9217 --- loss: 1.223883, loss_ss: 0.911051, loss_d: 0.312832
0.9601 --- loss: 1.123389, loss_ss: 0.766025, loss_d: 0.357364
0.9985 --- loss: 1.637393, loss_ss: 1.106204, loss_d: 0.531190
Epoch finished! Loss: 1.1499012775146045
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.973707, loss_ss: 0.744620, loss_d: 0.229086
0.0384 --- loss: 1.222408, loss_ss: 1.035001, loss_d: 0.187407
0.0768 --- loss: 0.691870, loss_ss: 0.464007, loss_d: 0.227863
0.1152 --- loss: 0.998014, loss_ss: 0.787157, loss_d: 0.210858
0.1536 --- loss: 1.005370, loss_ss: 0.745697, loss_d: 0.259673
0.1920 --- loss: 1.287129, loss_ss: 1.080338, loss_d: 0.206791
0.2304 --- loss: 0.707949, loss_ss: 0.586524, loss_d: 0.121424
0.2688 --- loss: 1.039031, loss_ss: 0.695405, loss_d: 0.343626
0.3072 --- loss: 0.877849, loss_ss: 0.654172, loss_d: 0.223677
0.3456 --- loss: 1.663509, loss_ss: 1.110075, loss_d: 0.553435
0.3840 --- loss: 0.857175, loss_ss: 0.587087, loss_d: 0.270088
0.4224 --- loss: 1.099494, loss_ss: 0.999465, loss_d: 0.100029
0.4608 --- loss: 0.987150, loss_ss: 0.767747, loss_d: 0.219403
0.4992 --- loss: 0.922466, loss_ss: 0.653671, loss_d: 0.268795
0.5376 --- loss: 1.349301, loss_ss: 0.931900, loss_d: 0.417400
0.5760 --- loss: 0.988034, loss_ss: 0.829899, loss_d: 0.158135
0.6144 --- loss: 1.216853, loss_ss: 0.949858, loss_d: 0.266995
0.6528 --- loss: 0.749552, loss_ss: 0.656482, loss_d: 0.093071
0.6912 --- loss: 0.910082, loss_ss: 0.786829, loss_d: 0.123253
0.7296 --- loss: 0.671473, loss_ss: 0.552599, loss_d: 0.118875
0.7680 --- loss: 1.122795, loss_ss: 0.904967, loss_d: 0.217828
0.8065 --- loss: 1.634895, loss_ss: 1.249134, loss_d: 0.385761
0.8449 --- loss: 1.343705, loss_ss: 0.742916, loss_d: 0.600789
0.8833 --- loss: 0.858758, loss_ss: 0.685431, loss_d: 0.173327
0.9217 --- loss: 0.775838, loss_ss: 0.694447, loss_d: 0.081391
0.9601 --- loss: 0.885886, loss_ss: 0.791360, loss_d: 0.094526
0.9985 --- loss: 1.028666, loss_ss: 0.850549, loss_d: 0.178117
Epoch finished! Loss: 1.1231117138495812
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7049019607843138
             precision    recall  f1-score   support

        0.0       0.55      0.93      0.69        96
        1.0       0.19      0.15      0.17       123
        2.0       0.69      0.90      0.78       355
        3.0       0.99      0.86      0.92       209
        4.0       0.97      0.48      0.64       237

avg / total       0.74      0.70      0.69      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.16  92.71   92.10  54.94     68.99
1  81.67  15.45   90.75  18.63     16.89
2  82.65  89.58   78.95  69.43     78.23
3  96.96  86.12   99.75  98.90     92.07
4  87.55  47.68   99.62  97.41     64.02
Total accuracy: 70.49%
Average sen: 66.31%
Average spec: 92.23%
Macro f1-score: 64.04%
[0.99032253 0.99586511 0.99945086 0.99415827 0.99474597 0.99425262
 0.99887294 0.99907458 0.99944216 0.99967337 0.99972051 0.99985778
 0.99892068 0.99915957 0.99847335 0.99804556 0.99773526 0.99846929
 0.9986124  0.99970108 0.99615878 0.99516416 0.99592125 0.99917418
 0.99853778 0.99911278 0.99890399 0.9992004  0.99900466 0.99460214
 0.99843496 0.9976809  0.99935132 0.99888569]
pred: 0.9977849090800566, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.191560, loss_ss: 1.495938, loss_d: 0.695623
0.0384 --- loss: 2.236155, loss_ss: 1.593218, loss_d: 0.642937
0.0767 --- loss: 2.381618, loss_ss: 1.623591, loss_d: 0.758027
0.1151 --- loss: 2.018770, loss_ss: 1.331890, loss_d: 0.686880
0.1535 --- loss: 1.800102, loss_ss: 1.451524, loss_d: 0.348578
0.1919 --- loss: 1.672591, loss_ss: 1.157992, loss_d: 0.514599
0.2302 --- loss: 2.218219, loss_ss: 1.335087, loss_d: 0.883132
0.2686 --- loss: 2.298211, loss_ss: 1.526260, loss_d: 0.771951
0.3070 --- loss: 1.615377, loss_ss: 1.100064, loss_d: 0.515313
0.3454 --- loss: 1.935513, loss_ss: 1.474317, loss_d: 0.461196
0.3837 --- loss: 2.014884, loss_ss: 1.057264, loss_d: 0.957620
0.4221 --- loss: 1.942901, loss_ss: 1.355343, loss_d: 0.587558
0.4605 --- loss: 1.582888, loss_ss: 1.190189, loss_d: 0.392698
0.4988 --- loss: 1.666549, loss_ss: 1.169863, loss_d: 0.496687
0.5372 --- loss: 1.692678, loss_ss: 1.180429, loss_d: 0.512250
0.5756 --- loss: 1.817458, loss_ss: 1.326884, loss_d: 0.490574
0.6140 --- loss: 1.719821, loss_ss: 1.274680, loss_d: 0.445142
0.6523 --- loss: 1.722437, loss_ss: 1.202291, loss_d: 0.520146
0.6907 --- loss: 2.005879, loss_ss: 1.469918, loss_d: 0.535961
0.7291 --- loss: 1.553547, loss_ss: 1.103956, loss_d: 0.449590
0.7675 --- loss: 1.679595, loss_ss: 1.004594, loss_d: 0.675001
0.8058 --- loss: 1.721324, loss_ss: 1.065136, loss_d: 0.656188
0.8442 --- loss: 1.676082, loss_ss: 1.081484, loss_d: 0.594598
0.8826 --- loss: 1.533570, loss_ss: 1.059405, loss_d: 0.474165
0.9210 --- loss: 1.936080, loss_ss: 1.449419, loss_d: 0.486661
0.9593 --- loss: 1.841002, loss_ss: 1.017560, loss_d: 0.823442
0.9977 --- loss: 1.798235, loss_ss: 1.262373, loss_d: 0.535862
Epoch finished! Loss: 1.8924145262974958
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.405281, loss_ss: 0.878433, loss_d: 0.526848
0.0384 --- loss: 2.367472, loss_ss: 1.606741, loss_d: 0.760731
0.0767 --- loss: 1.833267, loss_ss: 1.248957, loss_d: 0.584310
0.1151 --- loss: 1.919780, loss_ss: 1.388181, loss_d: 0.531599
0.1535 --- loss: 1.987807, loss_ss: 1.368238, loss_d: 0.619569
0.1919 --- loss: 2.238171, loss_ss: 1.602849, loss_d: 0.635321
0.2302 --- loss: 1.792369, loss_ss: 1.185775, loss_d: 0.606595
0.2686 --- loss: 1.786528, loss_ss: 1.355790, loss_d: 0.430737
0.3070 --- loss: 1.753273, loss_ss: 0.991729, loss_d: 0.761544
0.3454 --- loss: 1.659098, loss_ss: 1.073023, loss_d: 0.586075
0.3837 --- loss: 1.510226, loss_ss: 1.009309, loss_d: 0.500917
0.4221 --- loss: 1.667328, loss_ss: 1.320446, loss_d: 0.346883
0.4605 --- loss: 1.697251, loss_ss: 1.149031, loss_d: 0.548220
0.4988 --- loss: 2.093104, loss_ss: 1.326453, loss_d: 0.766651
0.5372 --- loss: 1.516235, loss_ss: 1.191309, loss_d: 0.324925
0.5756 --- loss: 1.673651, loss_ss: 0.995887, loss_d: 0.677764
0.6140 --- loss: 1.552876, loss_ss: 1.000801, loss_d: 0.552074
0.6523 --- loss: 1.545700, loss_ss: 1.018728, loss_d: 0.526971
0.6907 --- loss: 1.668393, loss_ss: 1.229868, loss_d: 0.438525
0.7291 --- loss: 1.756755, loss_ss: 0.955418, loss_d: 0.801337
0.7675 --- loss: 1.882857, loss_ss: 1.449917, loss_d: 0.432940
0.8058 --- loss: 1.999830, loss_ss: 1.365617, loss_d: 0.634213
0.8442 --- loss: 1.543573, loss_ss: 1.044283, loss_d: 0.499290
0.8826 --- loss: 1.691486, loss_ss: 1.286527, loss_d: 0.404959
0.9210 --- loss: 1.583674, loss_ss: 1.099694, loss_d: 0.483980
0.9593 --- loss: 1.573245, loss_ss: 0.953139, loss_d: 0.620105
0.9977 --- loss: 1.801129, loss_ss: 1.222065, loss_d: 0.579064
Epoch finished! Loss: 1.7255640176626352
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.726935, loss_ss: 1.034090, loss_d: 0.692844
0.0384 --- loss: 1.805169, loss_ss: 1.266379, loss_d: 0.538790
0.0767 --- loss: 1.661241, loss_ss: 1.123146, loss_d: 0.538095
0.1151 --- loss: 1.824863, loss_ss: 1.301284, loss_d: 0.523580
0.1535 --- loss: 1.546093, loss_ss: 1.175241, loss_d: 0.370852
0.1919 --- loss: 1.633122, loss_ss: 1.000624, loss_d: 0.632498
0.2302 --- loss: 1.736102, loss_ss: 0.783509, loss_d: 0.952594
0.2686 --- loss: 1.542543, loss_ss: 1.041654, loss_d: 0.500889
0.3070 --- loss: 1.657866, loss_ss: 1.158537, loss_d: 0.499329
0.3454 --- loss: 1.474395, loss_ss: 0.941086, loss_d: 0.533309
0.3837 --- loss: 1.861037, loss_ss: 1.286571, loss_d: 0.574466
0.4221 --- loss: 1.885875, loss_ss: 1.149972, loss_d: 0.735903
0.4605 --- loss: 1.729419, loss_ss: 1.207266, loss_d: 0.522154
0.4988 --- loss: 1.266746, loss_ss: 0.865757, loss_d: 0.400989
0.5372 --- loss: 1.541160, loss_ss: 0.998603, loss_d: 0.542557
0.5756 --- loss: 1.293419, loss_ss: 1.005210, loss_d: 0.288209
0.6140 --- loss: 1.729364, loss_ss: 1.202007, loss_d: 0.527357
0.6523 --- loss: 1.969125, loss_ss: 1.257526, loss_d: 0.711599
0.6907 --- loss: 1.694645, loss_ss: 1.094808, loss_d: 0.599837
0.7291 --- loss: 1.867475, loss_ss: 1.100138, loss_d: 0.767336
0.7675 --- loss: 1.904035, loss_ss: 1.318343, loss_d: 0.585692
0.8058 --- loss: 1.461329, loss_ss: 0.853736, loss_d: 0.607593
0.8442 --- loss: 1.456798, loss_ss: 0.997914, loss_d: 0.458884
0.8826 --- loss: 1.596665, loss_ss: 1.082425, loss_d: 0.514240
0.9210 --- loss: 1.482620, loss_ss: 1.195461, loss_d: 0.287160
0.9593 --- loss: 1.795396, loss_ss: 0.949445, loss_d: 0.845951
0.9977 --- loss: 2.159831, loss_ss: 1.521969, loss_d: 0.637862
Epoch finished! Loss: 1.625200144144205
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.931033, loss_ss: 1.538041, loss_d: 0.392991
0.0384 --- loss: 1.340330, loss_ss: 1.112364, loss_d: 0.227966
0.0767 --- loss: 1.985225, loss_ss: 1.337761, loss_d: 0.647464
0.1151 --- loss: 1.470093, loss_ss: 1.111394, loss_d: 0.358698
0.1535 --- loss: 1.694919, loss_ss: 1.034565, loss_d: 0.660354
0.1919 --- loss: 1.707366, loss_ss: 1.140399, loss_d: 0.566968
0.2302 --- loss: 1.307344, loss_ss: 0.916126, loss_d: 0.391218
0.2686 --- loss: 1.742724, loss_ss: 1.166278, loss_d: 0.576446
0.3070 --- loss: 1.364074, loss_ss: 0.751170, loss_d: 0.612904
0.3454 --- loss: 1.381237, loss_ss: 0.812683, loss_d: 0.568554
0.3837 --- loss: 1.551325, loss_ss: 0.968335, loss_d: 0.582990
0.4221 --- loss: 1.317798, loss_ss: 0.882081, loss_d: 0.435717
0.4605 --- loss: 1.263698, loss_ss: 0.767440, loss_d: 0.496257
0.4988 --- loss: 1.681578, loss_ss: 1.375766, loss_d: 0.305813
0.5372 --- loss: 1.410513, loss_ss: 0.786560, loss_d: 0.623953
0.5756 --- loss: 1.284434, loss_ss: 0.897516, loss_d: 0.386918
0.6140 --- loss: 1.543913, loss_ss: 0.972260, loss_d: 0.571653
0.6523 --- loss: 1.380934, loss_ss: 1.012669, loss_d: 0.368265
0.6907 --- loss: 1.692627, loss_ss: 1.164406, loss_d: 0.528221
0.7291 --- loss: 1.404317, loss_ss: 1.090077, loss_d: 0.314240
0.7675 --- loss: 1.541933, loss_ss: 1.052519, loss_d: 0.489414
0.8058 --- loss: 1.860285, loss_ss: 1.173432, loss_d: 0.686853
0.8442 --- loss: 1.494644, loss_ss: 1.137645, loss_d: 0.356998
0.8826 --- loss: 1.426733, loss_ss: 1.000882, loss_d: 0.425851
0.9210 --- loss: 1.100825, loss_ss: 0.740636, loss_d: 0.360189
0.9593 --- loss: 1.918871, loss_ss: 1.111318, loss_d: 0.807553
0.9977 --- loss: 1.511254, loss_ss: 0.978784, loss_d: 0.532470
Epoch finished! Loss: 1.5584139819328602
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.366995, loss_ss: 1.075554, loss_d: 0.291441
0.0384 --- loss: 2.034768, loss_ss: 1.237124, loss_d: 0.797644
0.0767 --- loss: 1.437386, loss_ss: 0.943069, loss_d: 0.494318
0.1151 --- loss: 1.223752, loss_ss: 0.894729, loss_d: 0.329024
0.1535 --- loss: 2.012161, loss_ss: 0.963827, loss_d: 1.048333
0.1919 --- loss: 1.422804, loss_ss: 1.113314, loss_d: 0.309490
0.2302 --- loss: 1.448429, loss_ss: 1.084420, loss_d: 0.364009
0.2686 --- loss: 1.206447, loss_ss: 0.839416, loss_d: 0.367031
0.3070 --- loss: 1.396497, loss_ss: 0.943832, loss_d: 0.452665
0.3454 --- loss: 1.448748, loss_ss: 0.845088, loss_d: 0.603659
0.3837 --- loss: 1.425290, loss_ss: 0.973502, loss_d: 0.451787
0.4221 --- loss: 1.459917, loss_ss: 0.871354, loss_d: 0.588563
0.4605 --- loss: 1.563517, loss_ss: 0.880162, loss_d: 0.683356
0.4988 --- loss: 1.249162, loss_ss: 0.736987, loss_d: 0.512176
0.5372 --- loss: 1.237113, loss_ss: 0.916944, loss_d: 0.320169
0.5756 --- loss: 1.322184, loss_ss: 0.857276, loss_d: 0.464908
0.6140 --- loss: 1.544645, loss_ss: 0.954458, loss_d: 0.590187
0.6523 --- loss: 1.594919, loss_ss: 1.166807, loss_d: 0.428112
0.6907 --- loss: 1.430535, loss_ss: 1.046353, loss_d: 0.384182
0.7291 --- loss: 1.222786, loss_ss: 0.972683, loss_d: 0.250103
0.7675 --- loss: 1.589648, loss_ss: 0.973636, loss_d: 0.616012
0.8058 --- loss: 1.355188, loss_ss: 0.826874, loss_d: 0.528314
0.8442 --- loss: 1.615406, loss_ss: 1.254372, loss_d: 0.361033
0.8826 --- loss: 1.302504, loss_ss: 1.033907, loss_d: 0.268597
0.9210 --- loss: 1.261575, loss_ss: 1.078550, loss_d: 0.183025
0.9593 --- loss: 1.571729, loss_ss: 1.101431, loss_d: 0.470297
0.9977 --- loss: 1.304511, loss_ss: 1.124506, loss_d: 0.180004
Epoch finished! Loss: 1.4732963596399014
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.260917, loss_ss: 0.951385, loss_d: 0.309532
0.0384 --- loss: 1.709250, loss_ss: 1.165645, loss_d: 0.543605
0.0767 --- loss: 0.954545, loss_ss: 0.747605, loss_d: 0.206941
0.1151 --- loss: 1.699277, loss_ss: 1.032252, loss_d: 0.667025
0.1535 --- loss: 1.835226, loss_ss: 1.192223, loss_d: 0.643003
0.1919 --- loss: 1.296846, loss_ss: 0.890467, loss_d: 0.406379
0.2302 --- loss: 1.040220, loss_ss: 0.774419, loss_d: 0.265802
0.2686 --- loss: 1.083816, loss_ss: 0.797582, loss_d: 0.286233
0.3070 --- loss: 1.562676, loss_ss: 0.965978, loss_d: 0.596698
0.3454 --- loss: 1.767027, loss_ss: 1.427845, loss_d: 0.339182
0.3837 --- loss: 1.333719, loss_ss: 0.864361, loss_d: 0.469357
0.4221 --- loss: 1.260621, loss_ss: 0.808313, loss_d: 0.452308
0.4605 --- loss: 1.398915, loss_ss: 0.832203, loss_d: 0.566712
0.4988 --- loss: 1.179090, loss_ss: 0.811608, loss_d: 0.367482
0.5372 --- loss: 1.642244, loss_ss: 1.023822, loss_d: 0.618423
0.5756 --- loss: 1.493863, loss_ss: 0.994774, loss_d: 0.499088
0.6140 --- loss: 1.145020, loss_ss: 0.855339, loss_d: 0.289681
0.6523 --- loss: 1.234709, loss_ss: 0.745256, loss_d: 0.489453
0.6907 --- loss: 1.211929, loss_ss: 0.965540, loss_d: 0.246389
0.7291 --- loss: 1.149910, loss_ss: 0.916757, loss_d: 0.233154
0.7675 --- loss: 1.143547, loss_ss: 0.851629, loss_d: 0.291918
0.8058 --- loss: 1.409979, loss_ss: 0.837761, loss_d: 0.572218
0.8442 --- loss: 1.351085, loss_ss: 0.748975, loss_d: 0.602110
0.8826 --- loss: 1.243390, loss_ss: 1.005979, loss_d: 0.237411
0.9210 --- loss: 1.122913, loss_ss: 0.887273, loss_d: 0.235640
0.9593 --- loss: 1.304515, loss_ss: 0.977668, loss_d: 0.326847
0.9977 --- loss: 1.621052, loss_ss: 0.749694, loss_d: 0.871358
Epoch finished! Loss: 1.400498435130486
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.379730, loss_ss: 1.008301, loss_d: 0.371429
0.0384 --- loss: 1.262633, loss_ss: 0.946115, loss_d: 0.316517
0.0767 --- loss: 1.596165, loss_ss: 1.001662, loss_d: 0.594503
0.1151 --- loss: 1.107196, loss_ss: 0.856379, loss_d: 0.250817
0.1535 --- loss: 1.272550, loss_ss: 1.103742, loss_d: 0.168808
0.1919 --- loss: 1.022966, loss_ss: 0.815738, loss_d: 0.207229
0.2302 --- loss: 1.499279, loss_ss: 0.757239, loss_d: 0.742040
0.2686 --- loss: 1.073683, loss_ss: 0.908522, loss_d: 0.165161
0.3070 --- loss: 1.552005, loss_ss: 0.931148, loss_d: 0.620857
0.3454 --- loss: 1.287883, loss_ss: 0.831678, loss_d: 0.456205
0.3837 --- loss: 0.977923, loss_ss: 0.815809, loss_d: 0.162115
0.4221 --- loss: 0.957229, loss_ss: 0.717621, loss_d: 0.239608
0.4605 --- loss: 0.845753, loss_ss: 0.649310, loss_d: 0.196444
0.4988 --- loss: 1.170664, loss_ss: 0.963218, loss_d: 0.207446
0.5372 --- loss: 1.026187, loss_ss: 0.694431, loss_d: 0.331757
0.5756 --- loss: 1.237002, loss_ss: 1.065305, loss_d: 0.171697
0.6140 --- loss: 1.363258, loss_ss: 1.184160, loss_d: 0.179097
0.6523 --- loss: 1.215916, loss_ss: 0.963749, loss_d: 0.252167
0.6907 --- loss: 1.289625, loss_ss: 0.982943, loss_d: 0.306682
0.7291 --- loss: 1.207813, loss_ss: 0.956276, loss_d: 0.251537
0.7675 --- loss: 1.170912, loss_ss: 0.944841, loss_d: 0.226071
0.8058 --- loss: 1.190008, loss_ss: 0.886515, loss_d: 0.303493
0.8442 --- loss: 1.255360, loss_ss: 0.901228, loss_d: 0.354132
0.8826 --- loss: 1.309008, loss_ss: 0.992339, loss_d: 0.316669
0.9210 --- loss: 1.255508, loss_ss: 0.824861, loss_d: 0.430646
0.9593 --- loss: 1.201948, loss_ss: 0.909001, loss_d: 0.292946
0.9977 --- loss: 1.190887, loss_ss: 0.752031, loss_d: 0.438855
Epoch finished! Loss: 1.28432462650996
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.060854, loss_ss: 0.779725, loss_d: 0.281130
0.0384 --- loss: 1.415066, loss_ss: 0.972633, loss_d: 0.442433
0.0767 --- loss: 0.951383, loss_ss: 0.798303, loss_d: 0.153080
0.1151 --- loss: 0.958357, loss_ss: 0.824804, loss_d: 0.133554
0.1535 --- loss: 1.100518, loss_ss: 0.941233, loss_d: 0.159285
0.1919 --- loss: 1.180787, loss_ss: 0.796320, loss_d: 0.384467
0.2302 --- loss: 1.316266, loss_ss: 0.973935, loss_d: 0.342331
0.2686 --- loss: 1.421450, loss_ss: 1.024121, loss_d: 0.397329
0.3070 --- loss: 1.262028, loss_ss: 0.841800, loss_d: 0.420228
0.3454 --- loss: 1.016994, loss_ss: 0.649965, loss_d: 0.367029
0.3837 --- loss: 1.268225, loss_ss: 0.737946, loss_d: 0.530279
0.4221 --- loss: 1.306032, loss_ss: 0.641367, loss_d: 0.664665
0.4605 --- loss: 1.592179, loss_ss: 1.207226, loss_d: 0.384953
0.4988 --- loss: 1.706740, loss_ss: 1.219815, loss_d: 0.486925
0.5372 --- loss: 1.310904, loss_ss: 0.873690, loss_d: 0.437214
0.5756 --- loss: 0.971515, loss_ss: 0.850730, loss_d: 0.120785
0.6140 --- loss: 1.120826, loss_ss: 0.888256, loss_d: 0.232570
0.6523 --- loss: 1.145464, loss_ss: 0.974128, loss_d: 0.171337
0.6907 --- loss: 1.463903, loss_ss: 1.214743, loss_d: 0.249160
0.7291 --- loss: 1.034211, loss_ss: 0.697956, loss_d: 0.336256
0.7675 --- loss: 1.319884, loss_ss: 0.953501, loss_d: 0.366383
0.8058 --- loss: 1.237982, loss_ss: 0.976457, loss_d: 0.261524
0.8442 --- loss: 0.925258, loss_ss: 0.763866, loss_d: 0.161392
0.8826 --- loss: 1.230233, loss_ss: 1.107276, loss_d: 0.122956
0.9210 --- loss: 0.858705, loss_ss: 0.713764, loss_d: 0.144941
0.9593 --- loss: 1.391255, loss_ss: 1.160095, loss_d: 0.231160
0.9977 --- loss: 1.170840, loss_ss: 1.038593, loss_d: 0.132247
Epoch finished! Loss: 1.245865949988365
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.081831, loss_ss: 0.799981, loss_d: 0.281849
0.0384 --- loss: 1.907196, loss_ss: 1.001637, loss_d: 0.905559
0.0767 --- loss: 1.341069, loss_ss: 1.057500, loss_d: 0.283569
0.1151 --- loss: 0.906650, loss_ss: 0.762533, loss_d: 0.144118
0.1535 --- loss: 1.161681, loss_ss: 0.988761, loss_d: 0.172920
0.1919 --- loss: 1.195759, loss_ss: 0.717885, loss_d: 0.477874
0.2302 --- loss: 0.932804, loss_ss: 0.648812, loss_d: 0.283992
0.2686 --- loss: 1.545702, loss_ss: 1.198626, loss_d: 0.347076
0.3070 --- loss: 1.431126, loss_ss: 1.138135, loss_d: 0.292991
0.3454 --- loss: 1.203748, loss_ss: 0.723073, loss_d: 0.480675
0.3837 --- loss: 1.146250, loss_ss: 0.803160, loss_d: 0.343089
0.4221 --- loss: 1.213333, loss_ss: 0.959304, loss_d: 0.254029
0.4605 --- loss: 0.965477, loss_ss: 0.828164, loss_d: 0.137313
0.4988 --- loss: 0.841313, loss_ss: 0.740245, loss_d: 0.101068
0.5372 --- loss: 1.184015, loss_ss: 0.898963, loss_d: 0.285052
0.5756 --- loss: 1.302210, loss_ss: 1.033017, loss_d: 0.269194
0.6140 --- loss: 1.045846, loss_ss: 0.907183, loss_d: 0.138664
0.6523 --- loss: 0.960187, loss_ss: 0.694245, loss_d: 0.265943
0.6907 --- loss: 0.925521, loss_ss: 0.807326, loss_d: 0.118194
0.7291 --- loss: 1.017362, loss_ss: 0.821742, loss_d: 0.195620
0.7675 --- loss: 1.097573, loss_ss: 0.788215, loss_d: 0.309358
0.8058 --- loss: 1.800671, loss_ss: 1.247246, loss_d: 0.553425
0.8442 --- loss: 1.114463, loss_ss: 0.958490, loss_d: 0.155973
0.8826 --- loss: 1.033454, loss_ss: 0.875792, loss_d: 0.157662
0.9210 --- loss: 0.878553, loss_ss: 0.789258, loss_d: 0.089296
0.9593 --- loss: 0.945718, loss_ss: 0.767331, loss_d: 0.178387
0.9977 --- loss: 1.589314, loss_ss: 1.024610, loss_d: 0.564704
Epoch finished! Loss: 1.2097032407155404
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.439470, loss_ss: 0.945217, loss_d: 0.494253
0.0384 --- loss: 1.100423, loss_ss: 0.765658, loss_d: 0.334765
0.0767 --- loss: 1.458373, loss_ss: 1.248881, loss_d: 0.209492
0.1151 --- loss: 1.024905, loss_ss: 0.739226, loss_d: 0.285679
0.1535 --- loss: 0.917931, loss_ss: 0.784815, loss_d: 0.133115
0.1919 --- loss: 1.425451, loss_ss: 1.084720, loss_d: 0.340731
0.2302 --- loss: 1.316086, loss_ss: 1.084813, loss_d: 0.231273
0.2686 --- loss: 1.090539, loss_ss: 0.889434, loss_d: 0.201105
0.3070 --- loss: 1.088483, loss_ss: 0.878088, loss_d: 0.210395
0.3454 --- loss: 1.086121, loss_ss: 0.858226, loss_d: 0.227894
0.3837 --- loss: 1.108514, loss_ss: 0.886066, loss_d: 0.222449
0.4221 --- loss: 1.039069, loss_ss: 0.734477, loss_d: 0.304592
0.4605 --- loss: 1.096642, loss_ss: 0.761655, loss_d: 0.334987
0.4988 --- loss: 1.283887, loss_ss: 1.074935, loss_d: 0.208952
0.5372 --- loss: 1.079846, loss_ss: 0.920563, loss_d: 0.159284
0.5756 --- loss: 1.162803, loss_ss: 0.936556, loss_d: 0.226247
0.6140 --- loss: 0.828442, loss_ss: 0.741380, loss_d: 0.087061
0.6523 --- loss: 0.877941, loss_ss: 0.799953, loss_d: 0.077988
0.6907 --- loss: 0.784220, loss_ss: 0.722682, loss_d: 0.061538
0.7291 --- loss: 1.726191, loss_ss: 0.913591, loss_d: 0.812600
0.7675 --- loss: 0.733409, loss_ss: 0.572284, loss_d: 0.161125
0.8058 --- loss: 0.935910, loss_ss: 0.860063, loss_d: 0.075847
0.8442 --- loss: 1.171227, loss_ss: 0.998909, loss_d: 0.172317
0.8826 --- loss: 1.288427, loss_ss: 0.758347, loss_d: 0.530080
0.9210 --- loss: 1.515194, loss_ss: 1.025668, loss_d: 0.489526
0.9593 --- loss: 1.208972, loss_ss: 0.940202, loss_d: 0.268771
0.9977 --- loss: 0.869068, loss_ss: 0.712309, loss_d: 0.156760
Epoch finished! Loss: 1.160843456708468
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4427083333333333
             precision    recall  f1-score   support

        0.0       0.33      0.61      0.43        57
        1.0       0.09      0.67      0.15        60
        2.0       0.94      0.34      0.50       496
        3.0       0.90      0.88      0.89        90
        4.0       0.81      0.39      0.53       257

avg / total       0.81      0.44      0.52       960
 


====== chp010-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.31  61.40   92.14  33.02     42.94
1  54.06  66.67   53.22   8.68     15.36
2  64.90  34.27   97.63  93.92     50.22
3  97.92  87.78   98.97  89.77     88.76
4  81.35  39.30   96.73  81.45     53.02
Total accuracy: 44.27%
Average sen: 57.88%
Average spec: 87.74%
Macro f1-score: 50.06%
[0.92818362 0.99618214 0.97744441 0.97774315 0.99024045 0.99657249
 0.99739587 0.99659663 0.98207581 0.99715996 0.99843842 0.99576676
 0.99603313 0.99381787 0.99458849 0.99186641 0.99674892 0.9946503
 0.99838388 0.99202555 0.98254907 0.9953317  0.98784256 0.99173951
 0.99636626 0.99498749 0.99679321 0.99674475 0.99576783 0.99144614
 0.986148   0.99607617]
pred: 0.9907408431172371, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.501974, loss_ss: 1.723162, loss_d: 0.778812
0.0384 --- loss: 2.185385, loss_ss: 1.650432, loss_d: 0.534953
0.0768 --- loss: 2.035081, loss_ss: 1.530067, loss_d: 0.505014
0.1152 --- loss: 2.493126, loss_ss: 1.786652, loss_d: 0.706474
0.1536 --- loss: 2.230978, loss_ss: 1.473596, loss_d: 0.757381
0.1919 --- loss: 2.067587, loss_ss: 1.578254, loss_d: 0.489333
0.2303 --- loss: 2.427446, loss_ss: 1.568380, loss_d: 0.859066
0.2687 --- loss: 2.131311, loss_ss: 1.589530, loss_d: 0.541781
0.3071 --- loss: 2.365838, loss_ss: 1.759126, loss_d: 0.606712
0.3455 --- loss: 2.054951, loss_ss: 1.423756, loss_d: 0.631196
0.3839 --- loss: 2.098505, loss_ss: 1.542767, loss_d: 0.555738
0.4223 --- loss: 2.301364, loss_ss: 1.551875, loss_d: 0.749489
0.4607 --- loss: 2.118547, loss_ss: 1.531812, loss_d: 0.586735
0.4990 --- loss: 2.254781, loss_ss: 1.549368, loss_d: 0.705413
0.5374 --- loss: 2.075015, loss_ss: 1.670913, loss_d: 0.404102
0.5758 --- loss: 1.802884, loss_ss: 1.394534, loss_d: 0.408349
0.6142 --- loss: 1.894575, loss_ss: 1.243173, loss_d: 0.651402
0.6526 --- loss: 1.961894, loss_ss: 1.361230, loss_d: 0.600664
0.6910 --- loss: 1.775586, loss_ss: 1.314607, loss_d: 0.460979
0.7294 --- loss: 2.067885, loss_ss: 1.439909, loss_d: 0.627976
0.7678 --- loss: 1.669967, loss_ss: 1.273904, loss_d: 0.396063
0.8061 --- loss: 1.809311, loss_ss: 1.336228, loss_d: 0.473083
0.8445 --- loss: 1.745372, loss_ss: 1.446079, loss_d: 0.299293
0.8829 --- loss: 2.327242, loss_ss: 1.447602, loss_d: 0.879640
0.9213 --- loss: 1.960053, loss_ss: 1.320655, loss_d: 0.639399
0.9597 --- loss: 1.808196, loss_ss: 1.299036, loss_d: 0.509159
0.9981 --- loss: 1.882865, loss_ss: 1.613525, loss_d: 0.269340
Epoch finished! Loss: 2.0585290221067574
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.860543, loss_ss: 1.444391, loss_d: 0.416152
0.0384 --- loss: 1.717050, loss_ss: 1.165124, loss_d: 0.551926
0.0768 --- loss: 1.762921, loss_ss: 1.171452, loss_d: 0.591469
0.1152 --- loss: 1.723286, loss_ss: 1.287372, loss_d: 0.435914
0.1536 --- loss: 1.576059, loss_ss: 1.158432, loss_d: 0.417627
0.1919 --- loss: 1.977984, loss_ss: 1.237682, loss_d: 0.740302
0.2303 --- loss: 1.864064, loss_ss: 1.200993, loss_d: 0.663071
0.2687 --- loss: 1.687179, loss_ss: 0.956102, loss_d: 0.731077
0.3071 --- loss: 1.496146, loss_ss: 1.184175, loss_d: 0.311971
0.3455 --- loss: 1.465759, loss_ss: 1.031333, loss_d: 0.434426
0.3839 --- loss: 1.737222, loss_ss: 1.240430, loss_d: 0.496793
0.4223 --- loss: 1.597663, loss_ss: 1.175121, loss_d: 0.422542
0.4607 --- loss: 1.756826, loss_ss: 1.046707, loss_d: 0.710119
0.4990 --- loss: 1.717795, loss_ss: 1.251665, loss_d: 0.466130
0.5374 --- loss: 1.672806, loss_ss: 1.107553, loss_d: 0.565253
0.5758 --- loss: 1.585448, loss_ss: 1.190173, loss_d: 0.395275
0.6142 --- loss: 1.508547, loss_ss: 0.987074, loss_d: 0.521472
0.6526 --- loss: 1.607151, loss_ss: 0.978737, loss_d: 0.628414
0.6910 --- loss: 1.506812, loss_ss: 1.175428, loss_d: 0.331385
0.7294 --- loss: 1.649161, loss_ss: 1.192815, loss_d: 0.456346
0.7678 --- loss: 1.757549, loss_ss: 1.003990, loss_d: 0.753559
0.8061 --- loss: 1.803149, loss_ss: 1.181211, loss_d: 0.621938
0.8445 --- loss: 1.212596, loss_ss: 0.896424, loss_d: 0.316172
0.8829 --- loss: 1.463937, loss_ss: 0.885946, loss_d: 0.577991
0.9213 --- loss: 1.798612, loss_ss: 1.069467, loss_d: 0.729145
0.9597 --- loss: 1.542972, loss_ss: 0.976481, loss_d: 0.566491
0.9981 --- loss: 3.163053, loss_ss: 2.203833, loss_d: 0.959220
Epoch finished! Loss: 1.7370866527924171
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.399538, loss_ss: 0.935295, loss_d: 0.464243
0.0384 --- loss: 1.454759, loss_ss: 0.849558, loss_d: 0.605201
0.0768 --- loss: 1.702992, loss_ss: 1.132283, loss_d: 0.570710
0.1152 --- loss: 1.700412, loss_ss: 1.032079, loss_d: 0.668332
0.1536 --- loss: 1.624360, loss_ss: 1.041865, loss_d: 0.582496
0.1919 --- loss: 1.439964, loss_ss: 0.938252, loss_d: 0.501712
0.2303 --- loss: 2.183005, loss_ss: 1.276346, loss_d: 0.906659
0.2687 --- loss: 1.788900, loss_ss: 0.913129, loss_d: 0.875772
0.3071 --- loss: 1.539550, loss_ss: 1.039766, loss_d: 0.499784
0.3455 --- loss: 1.570544, loss_ss: 1.220190, loss_d: 0.350354
0.3839 --- loss: 1.461913, loss_ss: 1.105463, loss_d: 0.356451
0.4223 --- loss: 1.799662, loss_ss: 1.071478, loss_d: 0.728184
0.4607 --- loss: 1.868464, loss_ss: 0.919717, loss_d: 0.948747
0.4990 --- loss: 1.884874, loss_ss: 1.297176, loss_d: 0.587698
0.5374 --- loss: 1.581560, loss_ss: 0.858993, loss_d: 0.722566
0.5758 --- loss: 1.869597, loss_ss: 1.291065, loss_d: 0.578532
0.6142 --- loss: 1.376493, loss_ss: 0.779687, loss_d: 0.596806
0.6526 --- loss: 1.402659, loss_ss: 0.912092, loss_d: 0.490567
0.6910 --- loss: 1.868375, loss_ss: 1.136655, loss_d: 0.731720
0.7294 --- loss: 1.785756, loss_ss: 1.139138, loss_d: 0.646618
0.7678 --- loss: 1.577234, loss_ss: 0.789331, loss_d: 0.787903
0.8061 --- loss: 1.461148, loss_ss: 0.993476, loss_d: 0.467672
0.8445 --- loss: 1.654990, loss_ss: 0.970618, loss_d: 0.684372
0.8829 --- loss: 1.833647, loss_ss: 1.194386, loss_d: 0.639261
0.9213 --- loss: 1.609734, loss_ss: 1.222685, loss_d: 0.387049
0.9597 --- loss: 1.533484, loss_ss: 0.941342, loss_d: 0.592142
0.9981 --- loss: 2.377467, loss_ss: 1.845852, loss_d: 0.531615
Epoch finished! Loss: 1.618184906244278
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.700691, loss_ss: 1.110677, loss_d: 0.590015
0.0384 --- loss: 1.470866, loss_ss: 0.990185, loss_d: 0.480681
0.0768 --- loss: 1.405758, loss_ss: 0.877287, loss_d: 0.528471
0.1152 --- loss: 1.485313, loss_ss: 0.979599, loss_d: 0.505714
0.1536 --- loss: 1.591781, loss_ss: 0.963564, loss_d: 0.628217
0.1919 --- loss: 1.683754, loss_ss: 1.159317, loss_d: 0.524437
0.2303 --- loss: 1.569718, loss_ss: 0.941747, loss_d: 0.627971
0.2687 --- loss: 1.425550, loss_ss: 0.844266, loss_d: 0.581283
0.3071 --- loss: 1.667777, loss_ss: 1.195397, loss_d: 0.472380
0.3455 --- loss: 1.785941, loss_ss: 1.028525, loss_d: 0.757417
0.3839 --- loss: 1.451079, loss_ss: 0.810406, loss_d: 0.640673
0.4223 --- loss: 1.543818, loss_ss: 0.867706, loss_d: 0.676111
0.4607 --- loss: 1.498576, loss_ss: 0.905744, loss_d: 0.592832
0.4990 --- loss: 1.515067, loss_ss: 1.095981, loss_d: 0.419086
0.5374 --- loss: 1.469294, loss_ss: 0.957961, loss_d: 0.511333
0.5758 --- loss: 1.082008, loss_ss: 0.770450, loss_d: 0.311557
0.6142 --- loss: 1.133538, loss_ss: 0.563569, loss_d: 0.569969
0.6526 --- loss: 1.242726, loss_ss: 0.878492, loss_d: 0.364234
0.6910 --- loss: 1.344411, loss_ss: 1.003351, loss_d: 0.341060
0.7294 --- loss: 1.470838, loss_ss: 1.213550, loss_d: 0.257289
0.7678 --- loss: 1.854920, loss_ss: 1.191937, loss_d: 0.662983
0.8061 --- loss: 1.812783, loss_ss: 0.962524, loss_d: 0.850259
0.8445 --- loss: 1.590758, loss_ss: 1.037791, loss_d: 0.552968
0.8829 --- loss: 1.586315, loss_ss: 1.110756, loss_d: 0.475560
0.9213 --- loss: 1.561197, loss_ss: 1.007680, loss_d: 0.553517
0.9597 --- loss: 1.585157, loss_ss: 0.989776, loss_d: 0.595381
0.9981 --- loss: 1.451325, loss_ss: 0.954718, loss_d: 0.496607
Epoch finished! Loss: 1.5289055553766397
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.467788, loss_ss: 0.968184, loss_d: 0.499604
0.0384 --- loss: 1.538077, loss_ss: 0.699275, loss_d: 0.838803
0.0768 --- loss: 1.301263, loss_ss: 0.964553, loss_d: 0.336711
0.1152 --- loss: 1.149216, loss_ss: 0.870668, loss_d: 0.278548
0.1536 --- loss: 1.638099, loss_ss: 1.381873, loss_d: 0.256226
0.1919 --- loss: 1.559964, loss_ss: 0.729590, loss_d: 0.830375
0.2303 --- loss: 1.473254, loss_ss: 0.898231, loss_d: 0.575024
0.2687 --- loss: 1.311527, loss_ss: 0.933391, loss_d: 0.378136
0.3071 --- loss: 1.104453, loss_ss: 0.697135, loss_d: 0.407318
0.3455 --- loss: 1.483023, loss_ss: 0.794559, loss_d: 0.688464
0.3839 --- loss: 1.640106, loss_ss: 1.093155, loss_d: 0.546951
0.4223 --- loss: 1.152705, loss_ss: 0.785920, loss_d: 0.366786
0.4607 --- loss: 1.234698, loss_ss: 0.915701, loss_d: 0.318997
0.4990 --- loss: 1.644113, loss_ss: 1.117509, loss_d: 0.526604
0.5374 --- loss: 1.266092, loss_ss: 0.812228, loss_d: 0.453864
0.5758 --- loss: 1.131981, loss_ss: 0.858714, loss_d: 0.273267
0.6142 --- loss: 1.216277, loss_ss: 0.859577, loss_d: 0.356700
0.6526 --- loss: 1.655966, loss_ss: 0.969954, loss_d: 0.686011
0.6910 --- loss: 1.124851, loss_ss: 0.845372, loss_d: 0.279479
0.7294 --- loss: 1.305587, loss_ss: 1.112215, loss_d: 0.193372
0.7678 --- loss: 1.164905, loss_ss: 0.849850, loss_d: 0.315055
0.8061 --- loss: 1.440189, loss_ss: 1.136820, loss_d: 0.303369
0.8445 --- loss: 1.217843, loss_ss: 1.026756, loss_d: 0.191087
0.8829 --- loss: 1.282220, loss_ss: 0.840047, loss_d: 0.442173
0.9213 --- loss: 1.713626, loss_ss: 1.231513, loss_d: 0.482113
0.9597 --- loss: 1.122321, loss_ss: 0.816623, loss_d: 0.305698
0.9981 --- loss: 1.720501, loss_ss: 1.229018, loss_d: 0.491483
Epoch finished! Loss: 1.3841613978147507
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.369584, loss_ss: 1.056570, loss_d: 0.313014
0.0384 --- loss: 1.199117, loss_ss: 0.672178, loss_d: 0.526939
0.0768 --- loss: 1.454746, loss_ss: 1.072452, loss_d: 0.382294
0.1152 --- loss: 1.438663, loss_ss: 0.966035, loss_d: 0.472628
0.1536 --- loss: 1.166031, loss_ss: 0.827035, loss_d: 0.338996
0.1919 --- loss: 1.267067, loss_ss: 0.780530, loss_d: 0.486537
0.2303 --- loss: 0.765210, loss_ss: 0.574447, loss_d: 0.190763
0.2687 --- loss: 1.126386, loss_ss: 0.891040, loss_d: 0.235346
0.3071 --- loss: 1.698256, loss_ss: 1.172715, loss_d: 0.525541
0.3455 --- loss: 1.683857, loss_ss: 0.996048, loss_d: 0.687809
0.3839 --- loss: 1.787417, loss_ss: 1.000228, loss_d: 0.787189
0.4223 --- loss: 1.057044, loss_ss: 0.752984, loss_d: 0.304060
0.4607 --- loss: 1.175940, loss_ss: 0.662643, loss_d: 0.513297
0.4990 --- loss: 1.186843, loss_ss: 0.726219, loss_d: 0.460624
0.5374 --- loss: 1.374613, loss_ss: 0.849720, loss_d: 0.524892
0.5758 --- loss: 1.388086, loss_ss: 0.852029, loss_d: 0.536057
0.6142 --- loss: 1.818081, loss_ss: 0.817378, loss_d: 1.000704
0.6526 --- loss: 1.159308, loss_ss: 0.775226, loss_d: 0.384082
0.6910 --- loss: 1.190737, loss_ss: 0.906564, loss_d: 0.284174
0.7294 --- loss: 1.205850, loss_ss: 0.844334, loss_d: 0.361515
0.7678 --- loss: 1.476080, loss_ss: 1.124147, loss_d: 0.351933
0.8061 --- loss: 0.876050, loss_ss: 0.704300, loss_d: 0.171751
0.8445 --- loss: 1.328662, loss_ss: 0.929287, loss_d: 0.399374
0.8829 --- loss: 1.090080, loss_ss: 0.815651, loss_d: 0.274429
0.9213 --- loss: 1.489127, loss_ss: 1.195078, loss_d: 0.294049
0.9597 --- loss: 1.208091, loss_ss: 0.733421, loss_d: 0.474670
0.9981 --- loss: 1.361059, loss_ss: 1.204412, loss_d: 0.156647
Epoch finished! Loss: 1.3043601492276558
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.125492, loss_ss: 0.847397, loss_d: 0.278095
0.0384 --- loss: 1.097503, loss_ss: 0.890974, loss_d: 0.206529
0.0768 --- loss: 1.140898, loss_ss: 0.788786, loss_d: 0.352113
0.1152 --- loss: 0.977581, loss_ss: 0.768941, loss_d: 0.208640
0.1536 --- loss: 1.205573, loss_ss: 1.004190, loss_d: 0.201383
0.1919 --- loss: 1.020337, loss_ss: 0.799101, loss_d: 0.221236
0.2303 --- loss: 0.916941, loss_ss: 0.710173, loss_d: 0.206768
0.2687 --- loss: 1.126599, loss_ss: 0.719901, loss_d: 0.406698
0.3071 --- loss: 1.677351, loss_ss: 1.032015, loss_d: 0.645336
0.3455 --- loss: 1.430651, loss_ss: 0.926265, loss_d: 0.504385
0.3839 --- loss: 0.940609, loss_ss: 0.708185, loss_d: 0.232424
0.4223 --- loss: 1.168565, loss_ss: 0.888972, loss_d: 0.279593
0.4607 --- loss: 1.031509, loss_ss: 0.720829, loss_d: 0.310680
0.4990 --- loss: 0.938376, loss_ss: 0.617385, loss_d: 0.320991
0.5374 --- loss: 0.996695, loss_ss: 0.824683, loss_d: 0.172011
0.5758 --- loss: 0.990537, loss_ss: 0.874368, loss_d: 0.116168
0.6142 --- loss: 1.276566, loss_ss: 0.916550, loss_d: 0.360016
0.6526 --- loss: 1.341162, loss_ss: 1.050588, loss_d: 0.290574
0.6910 --- loss: 1.038061, loss_ss: 0.835865, loss_d: 0.202197
0.7294 --- loss: 0.853764, loss_ss: 0.616692, loss_d: 0.237071
0.7678 --- loss: 1.580377, loss_ss: 0.804213, loss_d: 0.776164
0.8061 --- loss: 1.134358, loss_ss: 0.844671, loss_d: 0.289688
0.8445 --- loss: 1.211796, loss_ss: 0.989254, loss_d: 0.222542
0.8829 --- loss: 1.812510, loss_ss: 1.091875, loss_d: 0.720635
0.9213 --- loss: 1.377182, loss_ss: 0.980003, loss_d: 0.397178
0.9597 --- loss: 1.795620, loss_ss: 0.843817, loss_d: 0.951803
0.9981 --- loss: 1.249157, loss_ss: 0.876295, loss_d: 0.372862
Epoch finished! Loss: 1.2453469425439834
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.197893, loss_ss: 0.961005, loss_d: 0.236888
0.0384 --- loss: 1.130263, loss_ss: 0.878970, loss_d: 0.251293
0.0768 --- loss: 1.249964, loss_ss: 0.870279, loss_d: 0.379684
0.1152 --- loss: 1.040045, loss_ss: 0.855869, loss_d: 0.184176
0.1536 --- loss: 0.894194, loss_ss: 0.734148, loss_d: 0.160046
0.1919 --- loss: 0.970344, loss_ss: 0.871401, loss_d: 0.098943
0.2303 --- loss: 1.045408, loss_ss: 0.719519, loss_d: 0.325890
0.2687 --- loss: 1.369802, loss_ss: 0.905084, loss_d: 0.464718
0.3071 --- loss: 1.647719, loss_ss: 1.091439, loss_d: 0.556280
0.3455 --- loss: 1.273540, loss_ss: 0.972486, loss_d: 0.301054
0.3839 --- loss: 1.327896, loss_ss: 0.684428, loss_d: 0.643468
0.4223 --- loss: 1.448104, loss_ss: 0.985835, loss_d: 0.462268
0.4607 --- loss: 1.102181, loss_ss: 0.902444, loss_d: 0.199737
0.4990 --- loss: 1.110214, loss_ss: 0.684452, loss_d: 0.425762
0.5374 --- loss: 1.107028, loss_ss: 0.871400, loss_d: 0.235629
0.5758 --- loss: 1.055758, loss_ss: 0.822246, loss_d: 0.233511
0.6142 --- loss: 1.412640, loss_ss: 0.828568, loss_d: 0.584072
0.6526 --- loss: 0.991357, loss_ss: 0.730410, loss_d: 0.260946
0.6910 --- loss: 1.255966, loss_ss: 0.660917, loss_d: 0.595049
0.7294 --- loss: 1.293224, loss_ss: 0.665618, loss_d: 0.627606
0.7678 --- loss: 1.127582, loss_ss: 0.931551, loss_d: 0.196031
0.8061 --- loss: 1.409601, loss_ss: 0.805169, loss_d: 0.604432
0.8445 --- loss: 1.029103, loss_ss: 0.682654, loss_d: 0.346449
0.8829 --- loss: 1.344491, loss_ss: 1.197549, loss_d: 0.146941
0.9213 --- loss: 1.059075, loss_ss: 0.915212, loss_d: 0.143863
0.9597 --- loss: 1.765618, loss_ss: 1.108040, loss_d: 0.657578
0.9981 --- loss: 1.202413, loss_ss: 0.815071, loss_d: 0.387342
Epoch finished! Loss: 1.1882941677020147
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.783700, loss_ss: 0.624146, loss_d: 0.159554
0.0384 --- loss: 1.123574, loss_ss: 0.907766, loss_d: 0.215809
0.0768 --- loss: 1.016906, loss_ss: 0.794559, loss_d: 0.222347
0.1152 --- loss: 1.103415, loss_ss: 0.694116, loss_d: 0.409299
0.1536 --- loss: 1.760052, loss_ss: 1.587666, loss_d: 0.172386
0.1919 --- loss: 1.237002, loss_ss: 1.041313, loss_d: 0.195689
0.2303 --- loss: 1.038658, loss_ss: 0.880414, loss_d: 0.158245
0.2687 --- loss: 1.073314, loss_ss: 0.887133, loss_d: 0.186181
0.3071 --- loss: 1.767325, loss_ss: 0.778853, loss_d: 0.988473
0.3455 --- loss: 1.223415, loss_ss: 0.865852, loss_d: 0.357563
0.3839 --- loss: 0.876919, loss_ss: 0.689999, loss_d: 0.186921
0.4223 --- loss: 1.339131, loss_ss: 1.202258, loss_d: 0.136873
0.4607 --- loss: 1.022381, loss_ss: 0.807115, loss_d: 0.215266
0.4990 --- loss: 1.325725, loss_ss: 1.139647, loss_d: 0.186078
0.5374 --- loss: 0.799367, loss_ss: 0.619451, loss_d: 0.179916
0.5758 --- loss: 1.304914, loss_ss: 1.123890, loss_d: 0.181024
0.6142 --- loss: 0.888831, loss_ss: 0.538772, loss_d: 0.350060
0.6526 --- loss: 0.818658, loss_ss: 0.682097, loss_d: 0.136562
0.6910 --- loss: 1.188719, loss_ss: 0.793492, loss_d: 0.395227
0.7294 --- loss: 1.421060, loss_ss: 1.128360, loss_d: 0.292700
0.7678 --- loss: 1.210586, loss_ss: 0.793103, loss_d: 0.417483
0.8061 --- loss: 1.501445, loss_ss: 0.976838, loss_d: 0.524607
0.8445 --- loss: 0.806809, loss_ss: 0.587699, loss_d: 0.219110
0.8829 --- loss: 0.933257, loss_ss: 0.713388, loss_d: 0.219869
0.9213 --- loss: 1.515371, loss_ss: 1.112221, loss_d: 0.403150
0.9597 --- loss: 1.056380, loss_ss: 0.927697, loss_d: 0.128683
0.9981 --- loss: 0.983404, loss_ss: 0.532930, loss_d: 0.450474
Epoch finished! Loss: 1.1450502682190675
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.929361, loss_ss: 0.614590, loss_d: 0.314771
0.0384 --- loss: 1.598827, loss_ss: 1.187539, loss_d: 0.411288
0.0768 --- loss: 1.450752, loss_ss: 1.212239, loss_d: 0.238513
0.1152 --- loss: 1.023370, loss_ss: 0.735635, loss_d: 0.287735
0.1536 --- loss: 1.744296, loss_ss: 1.597271, loss_d: 0.147025
0.1919 --- loss: 1.020847, loss_ss: 0.580715, loss_d: 0.440131
0.2303 --- loss: 0.872633, loss_ss: 0.690846, loss_d: 0.181786
0.2687 --- loss: 1.421666, loss_ss: 0.850923, loss_d: 0.570743
0.3071 --- loss: 1.227380, loss_ss: 0.641510, loss_d: 0.585870
0.3455 --- loss: 0.835113, loss_ss: 0.663650, loss_d: 0.171463
0.3839 --- loss: 0.925361, loss_ss: 0.823921, loss_d: 0.101441
0.4223 --- loss: 0.717181, loss_ss: 0.613154, loss_d: 0.104027
0.4607 --- loss: 1.356927, loss_ss: 0.964630, loss_d: 0.392297
0.4990 --- loss: 1.420957, loss_ss: 0.974476, loss_d: 0.446481
0.5374 --- loss: 1.302877, loss_ss: 0.763262, loss_d: 0.539615
0.5758 --- loss: 1.147500, loss_ss: 0.671964, loss_d: 0.475536
0.6142 --- loss: 1.336826, loss_ss: 1.106303, loss_d: 0.230523
0.6526 --- loss: 1.085600, loss_ss: 0.812701, loss_d: 0.272899
0.6910 --- loss: 1.192270, loss_ss: 0.739400, loss_d: 0.452870
0.7294 --- loss: 1.020954, loss_ss: 0.889306, loss_d: 0.131648
0.7678 --- loss: 1.405354, loss_ss: 0.736997, loss_d: 0.668356
0.8061 --- loss: 1.256451, loss_ss: 0.741691, loss_d: 0.514760
0.8445 --- loss: 0.996221, loss_ss: 0.633157, loss_d: 0.363065
0.8829 --- loss: 1.148467, loss_ss: 0.687786, loss_d: 0.460681
0.9213 --- loss: 1.150792, loss_ss: 1.062956, loss_d: 0.087835
0.9597 --- loss: 1.182943, loss_ss: 0.724928, loss_d: 0.458015
0.9981 --- loss: 0.691460, loss_ss: 0.468618, loss_d: 0.222842
Epoch finished! Loss: 1.130540875517405
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5959595959595959
             precision    recall  f1-score   support

        0.0       0.82      0.19      0.30       219
        1.0       0.20      0.08      0.12       143
        2.0       0.44      0.91      0.59       221
        3.0       0.95      0.92      0.93       271
        4.0       0.53      0.65      0.58       136

avg / total       0.64      0.60      0.55       990
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  81.11  18.72   98.83  82.00     30.48
1  82.02   8.39   94.45  20.34     11.88
2  72.32  90.95   66.97  44.18     59.47
3  96.46  91.51   98.33  95.38     93.41
4  87.27  64.71   90.87  53.01     58.28
Total accuracy: 59.60%
Average sen: 54.86%
Average spec: 89.89%
Macro f1-score: 50.70%
[0.99464118 0.99590379 0.99477482 0.99596536 0.99562162 0.9853065
 0.99991357 0.99968052 0.99974161 0.98988229 0.99999869 0.99960667
 0.99525356 0.99524248 0.99787021 0.99872571 0.99938381 0.9999913
 0.999856   0.98999047 0.99899381 0.98987585 0.25930759 0.93972802
 0.99939358 0.99986088 0.99809295 0.98958826 0.99862385 0.99944669
 0.73928773 0.61705571 0.8915537 ]
pred: 0.9499442062594674, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.355398, loss_ss: 1.689044, loss_d: 0.666354
0.0384 --- loss: 2.349950, loss_ss: 1.425490, loss_d: 0.924459
0.0769 --- loss: 2.066299, loss_ss: 1.434586, loss_d: 0.631713
0.1153 --- loss: 1.948825, loss_ss: 1.383788, loss_d: 0.565038
0.1538 --- loss: 1.925038, loss_ss: 1.280024, loss_d: 0.645014
0.1922 --- loss: 2.063647, loss_ss: 1.349402, loss_d: 0.714245
0.2307 --- loss: 1.985406, loss_ss: 1.290218, loss_d: 0.695189
0.2691 --- loss: 1.750787, loss_ss: 1.180616, loss_d: 0.570170
0.3076 --- loss: 1.913722, loss_ss: 1.481035, loss_d: 0.432687
0.3460 --- loss: 2.032052, loss_ss: 1.406485, loss_d: 0.625567
0.3845 --- loss: 1.688067, loss_ss: 1.256050, loss_d: 0.432017
0.4229 --- loss: 1.928949, loss_ss: 1.507776, loss_d: 0.421173
0.4614 --- loss: 1.566967, loss_ss: 1.158873, loss_d: 0.408094
0.4998 --- loss: 1.632763, loss_ss: 1.205438, loss_d: 0.427325
0.5383 --- loss: 1.816489, loss_ss: 1.202590, loss_d: 0.613898
0.5767 --- loss: 1.861339, loss_ss: 1.121189, loss_d: 0.740150
0.6151 --- loss: 1.861755, loss_ss: 1.182846, loss_d: 0.678909
0.6536 --- loss: 1.830391, loss_ss: 1.152905, loss_d: 0.677486
0.6920 --- loss: 1.935851, loss_ss: 1.293177, loss_d: 0.642675
0.7305 --- loss: 1.861468, loss_ss: 1.107626, loss_d: 0.753842
0.7689 --- loss: 1.585067, loss_ss: 1.095149, loss_d: 0.489918
0.8074 --- loss: 1.512135, loss_ss: 1.175503, loss_d: 0.336632
0.8458 --- loss: 1.959080, loss_ss: 1.117972, loss_d: 0.841109
0.8843 --- loss: 1.793032, loss_ss: 1.317534, loss_d: 0.475498
0.9227 --- loss: 1.857806, loss_ss: 1.071957, loss_d: 0.785849
0.9612 --- loss: 1.643111, loss_ss: 0.880439, loss_d: 0.762672
0.9996 --- loss: 1.627865, loss_ss: 1.197093, loss_d: 0.430772
Epoch finished! Loss: 1.8821955653337332
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.590354, loss_ss: 1.059965, loss_d: 0.530389
0.0384 --- loss: 1.821287, loss_ss: 1.331947, loss_d: 0.489340
0.0769 --- loss: 1.380946, loss_ss: 1.066223, loss_d: 0.314723
0.1153 --- loss: 2.079039, loss_ss: 1.181051, loss_d: 0.897987
0.1538 --- loss: 1.630278, loss_ss: 1.198750, loss_d: 0.431528
0.1922 --- loss: 1.895389, loss_ss: 1.084193, loss_d: 0.811197
0.2307 --- loss: 1.504272, loss_ss: 0.980929, loss_d: 0.523343
0.2691 --- loss: 1.622011, loss_ss: 1.093287, loss_d: 0.528724
0.3076 --- loss: 1.723877, loss_ss: 1.112079, loss_d: 0.611799
0.3460 --- loss: 1.566636, loss_ss: 1.089802, loss_d: 0.476834
0.3845 --- loss: 1.783078, loss_ss: 1.180545, loss_d: 0.602533
0.4229 --- loss: 1.294756, loss_ss: 0.915264, loss_d: 0.379492
0.4614 --- loss: 1.419467, loss_ss: 0.919920, loss_d: 0.499547
0.4998 --- loss: 1.507913, loss_ss: 0.876564, loss_d: 0.631349
0.5383 --- loss: 1.875876, loss_ss: 1.196164, loss_d: 0.679712
0.5767 --- loss: 1.522068, loss_ss: 1.147983, loss_d: 0.374085
0.6151 --- loss: 1.787149, loss_ss: 0.960104, loss_d: 0.827046
0.6536 --- loss: 1.490002, loss_ss: 1.005764, loss_d: 0.484238
0.6920 --- loss: 1.708205, loss_ss: 1.298314, loss_d: 0.409892
0.7305 --- loss: 1.468050, loss_ss: 0.906742, loss_d: 0.561309
0.7689 --- loss: 1.511301, loss_ss: 0.940406, loss_d: 0.570896
0.8074 --- loss: 1.707342, loss_ss: 1.232975, loss_d: 0.474367
0.8458 --- loss: 1.432213, loss_ss: 1.007787, loss_d: 0.424426
0.8843 --- loss: 1.597360, loss_ss: 1.091026, loss_d: 0.506334
0.9227 --- loss: 1.472886, loss_ss: 0.922796, loss_d: 0.550090
0.9612 --- loss: 1.459920, loss_ss: 0.968828, loss_d: 0.491093
0.9996 --- loss: 3.477647, loss_ss: 2.185614, loss_d: 1.292033
Epoch finished! Loss: 1.6960330426692962
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.778863, loss_ss: 0.935178, loss_d: 0.843685
0.0384 --- loss: 1.466367, loss_ss: 0.942296, loss_d: 0.524072
0.0769 --- loss: 1.605129, loss_ss: 1.003658, loss_d: 0.601472
0.1153 --- loss: 1.472477, loss_ss: 0.837663, loss_d: 0.634814
0.1538 --- loss: 1.494927, loss_ss: 0.898377, loss_d: 0.596550
0.1922 --- loss: 1.988054, loss_ss: 1.272687, loss_d: 0.715367
0.2307 --- loss: 1.578002, loss_ss: 1.023368, loss_d: 0.554635
0.2691 --- loss: 1.693530, loss_ss: 1.281812, loss_d: 0.411718
0.3076 --- loss: 1.776819, loss_ss: 1.396861, loss_d: 0.379958
0.3460 --- loss: 1.538401, loss_ss: 0.954621, loss_d: 0.583780
0.3845 --- loss: 1.656403, loss_ss: 0.838551, loss_d: 0.817851
0.4229 --- loss: 1.505546, loss_ss: 1.080810, loss_d: 0.424736
0.4614 --- loss: 1.469226, loss_ss: 0.965480, loss_d: 0.503745
0.4998 --- loss: 1.734337, loss_ss: 1.061386, loss_d: 0.672951
0.5383 --- loss: 1.497811, loss_ss: 1.142690, loss_d: 0.355121
0.5767 --- loss: 1.717574, loss_ss: 1.002824, loss_d: 0.714750
0.6151 --- loss: 1.570131, loss_ss: 1.015843, loss_d: 0.554288
0.6536 --- loss: 1.439391, loss_ss: 0.910851, loss_d: 0.528540
0.6920 --- loss: 1.724252, loss_ss: 0.954095, loss_d: 0.770157
0.7305 --- loss: 1.578751, loss_ss: 0.999645, loss_d: 0.579106
0.7689 --- loss: 1.528976, loss_ss: 0.877389, loss_d: 0.651587
0.8074 --- loss: 1.608032, loss_ss: 1.025440, loss_d: 0.582592
0.8458 --- loss: 1.353248, loss_ss: 0.840919, loss_d: 0.512328
0.8843 --- loss: 1.721147, loss_ss: 1.074280, loss_d: 0.646867
0.9227 --- loss: 1.567560, loss_ss: 0.852903, loss_d: 0.714657
0.9612 --- loss: 1.416529, loss_ss: 0.920121, loss_d: 0.496409
0.9996 --- loss: 1.334332, loss_ss: 1.027681, loss_d: 0.306652
Epoch finished! Loss: 1.6306220673597775
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.676922, loss_ss: 0.876458, loss_d: 0.800463
0.0384 --- loss: 1.732772, loss_ss: 0.962244, loss_d: 0.770528
0.0769 --- loss: 1.257137, loss_ss: 0.804098, loss_d: 0.453038
0.1153 --- loss: 1.597816, loss_ss: 1.213103, loss_d: 0.384713
0.1538 --- loss: 1.574664, loss_ss: 0.829976, loss_d: 0.744687
0.1922 --- loss: 1.429602, loss_ss: 0.809910, loss_d: 0.619691
0.2307 --- loss: 1.584182, loss_ss: 1.028470, loss_d: 0.555713
0.2691 --- loss: 1.440713, loss_ss: 0.746464, loss_d: 0.694249
0.3076 --- loss: 1.778129, loss_ss: 1.142861, loss_d: 0.635268
0.3460 --- loss: 1.164207, loss_ss: 0.760280, loss_d: 0.403926
0.3845 --- loss: 1.423825, loss_ss: 0.809944, loss_d: 0.613881
0.4229 --- loss: 1.466735, loss_ss: 0.947795, loss_d: 0.518941
0.4614 --- loss: 1.431167, loss_ss: 1.063436, loss_d: 0.367731
0.4998 --- loss: 1.496510, loss_ss: 0.865164, loss_d: 0.631345
0.5383 --- loss: 1.625121, loss_ss: 1.002201, loss_d: 0.622920
0.5767 --- loss: 1.926470, loss_ss: 0.906681, loss_d: 1.019789
0.6151 --- loss: 1.485660, loss_ss: 0.886162, loss_d: 0.599498
0.6536 --- loss: 1.598853, loss_ss: 0.929389, loss_d: 0.669464
0.6920 --- loss: 1.411865, loss_ss: 1.008682, loss_d: 0.403184
0.7305 --- loss: 1.499073, loss_ss: 1.120499, loss_d: 0.378574
0.7689 --- loss: 1.699975, loss_ss: 1.113462, loss_d: 0.586513
0.8074 --- loss: 1.262239, loss_ss: 0.908094, loss_d: 0.354144
0.8458 --- loss: 1.301565, loss_ss: 0.927892, loss_d: 0.373673
0.8843 --- loss: 1.313771, loss_ss: 0.955471, loss_d: 0.358299
0.9227 --- loss: 1.432269, loss_ss: 1.003131, loss_d: 0.429138
0.9612 --- loss: 1.392621, loss_ss: 0.712326, loss_d: 0.680295
0.9996 --- loss: 3.952292, loss_ss: 2.532364, loss_d: 1.419928
Epoch finished! Loss: 1.53409712268756
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.462956, loss_ss: 0.916687, loss_d: 0.546269
0.0384 --- loss: 1.866745, loss_ss: 1.433430, loss_d: 0.433314
0.0769 --- loss: 1.071647, loss_ss: 0.701571, loss_d: 0.370077
0.1153 --- loss: 0.988243, loss_ss: 0.741679, loss_d: 0.246564
0.1538 --- loss: 1.477291, loss_ss: 1.090655, loss_d: 0.386636
0.1922 --- loss: 1.283896, loss_ss: 0.866815, loss_d: 0.417081
0.2307 --- loss: 1.109647, loss_ss: 0.800791, loss_d: 0.308856
0.2691 --- loss: 1.228431, loss_ss: 0.923268, loss_d: 0.305163
0.3076 --- loss: 1.740784, loss_ss: 0.858651, loss_d: 0.882134
0.3460 --- loss: 0.993541, loss_ss: 0.650587, loss_d: 0.342954
0.3845 --- loss: 1.217198, loss_ss: 0.820540, loss_d: 0.396658
0.4229 --- loss: 1.402952, loss_ss: 0.794948, loss_d: 0.608004
0.4614 --- loss: 1.235180, loss_ss: 0.997090, loss_d: 0.238090
0.4998 --- loss: 1.365840, loss_ss: 0.711435, loss_d: 0.654405
0.5383 --- loss: 1.341535, loss_ss: 0.924026, loss_d: 0.417508
0.5767 --- loss: 1.192807, loss_ss: 0.898394, loss_d: 0.294413
0.6151 --- loss: 1.038755, loss_ss: 0.735641, loss_d: 0.303114
0.6536 --- loss: 1.255796, loss_ss: 0.844508, loss_d: 0.411288
0.6920 --- loss: 1.393245, loss_ss: 1.072131, loss_d: 0.321114
0.7305 --- loss: 1.515660, loss_ss: 0.805039, loss_d: 0.710621
0.7689 --- loss: 1.610647, loss_ss: 0.910746, loss_d: 0.699901
0.8074 --- loss: 1.100541, loss_ss: 0.894444, loss_d: 0.206097
0.8458 --- loss: 1.292119, loss_ss: 0.854240, loss_d: 0.437879
0.8843 --- loss: 1.396029, loss_ss: 0.700823, loss_d: 0.695206
0.9227 --- loss: 1.006655, loss_ss: 0.698194, loss_d: 0.308461
0.9612 --- loss: 1.454846, loss_ss: 1.047725, loss_d: 0.407121
0.9996 --- loss: 1.237338, loss_ss: 1.058945, loss_d: 0.178394
Epoch finished! Loss: 1.405228488949629
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.001612, loss_ss: 0.803935, loss_d: 0.197677
0.0384 --- loss: 1.370311, loss_ss: 0.832047, loss_d: 0.538265
0.0769 --- loss: 1.698621, loss_ss: 1.142761, loss_d: 0.555860
0.1153 --- loss: 1.300971, loss_ss: 0.758196, loss_d: 0.542776
0.1538 --- loss: 1.333253, loss_ss: 1.037402, loss_d: 0.295851
0.1922 --- loss: 1.151886, loss_ss: 0.724590, loss_d: 0.427296
0.2307 --- loss: 1.539243, loss_ss: 1.217172, loss_d: 0.322071
0.2691 --- loss: 1.313391, loss_ss: 1.038009, loss_d: 0.275382
0.3076 --- loss: 1.337308, loss_ss: 0.843151, loss_d: 0.494157
0.3460 --- loss: 1.508541, loss_ss: 1.211489, loss_d: 0.297052
0.3845 --- loss: 1.557793, loss_ss: 0.936818, loss_d: 0.620974
0.4229 --- loss: 1.149657, loss_ss: 0.885278, loss_d: 0.264379
0.4614 --- loss: 1.471147, loss_ss: 1.235096, loss_d: 0.236050
0.4998 --- loss: 1.262474, loss_ss: 1.028725, loss_d: 0.233749
0.5383 --- loss: 1.053554, loss_ss: 0.733612, loss_d: 0.319941
0.5767 --- loss: 1.005630, loss_ss: 0.745031, loss_d: 0.260598
0.6151 --- loss: 1.398381, loss_ss: 0.794959, loss_d: 0.603422
0.6536 --- loss: 1.103032, loss_ss: 0.978794, loss_d: 0.124239
0.6920 --- loss: 2.189505, loss_ss: 0.981804, loss_d: 1.207701
0.7305 --- loss: 1.484929, loss_ss: 0.915002, loss_d: 0.569928
0.7689 --- loss: 1.217232, loss_ss: 0.963774, loss_d: 0.253458
0.8074 --- loss: 1.224571, loss_ss: 0.946139, loss_d: 0.278432
0.8458 --- loss: 1.493486, loss_ss: 1.028038, loss_d: 0.465448
0.8843 --- loss: 1.488769, loss_ss: 0.909950, loss_d: 0.578819
0.9227 --- loss: 1.579607, loss_ss: 1.005463, loss_d: 0.574144
0.9612 --- loss: 0.983922, loss_ss: 0.681898, loss_d: 0.302024
0.9996 --- loss: 2.597554, loss_ss: 2.441569, loss_d: 0.155985
Epoch finished! Loss: 1.35338806280723
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.155691, loss_ss: 0.719370, loss_d: 0.436320
0.0384 --- loss: 1.363129, loss_ss: 0.842011, loss_d: 0.521118
0.0769 --- loss: 1.402588, loss_ss: 0.943328, loss_d: 0.459259
0.1153 --- loss: 1.174536, loss_ss: 0.898299, loss_d: 0.276237
0.1538 --- loss: 1.225754, loss_ss: 0.760383, loss_d: 0.465371
0.1922 --- loss: 1.212417, loss_ss: 0.834775, loss_d: 0.377641
0.2307 --- loss: 1.277971, loss_ss: 0.970148, loss_d: 0.307822
0.2691 --- loss: 1.077224, loss_ss: 0.863059, loss_d: 0.214165
0.3076 --- loss: 0.992607, loss_ss: 0.782708, loss_d: 0.209898
0.3460 --- loss: 1.097594, loss_ss: 0.840360, loss_d: 0.257234
0.3845 --- loss: 0.994564, loss_ss: 0.779521, loss_d: 0.215043
0.4229 --- loss: 1.003468, loss_ss: 0.759496, loss_d: 0.243972
0.4614 --- loss: 1.422600, loss_ss: 1.045645, loss_d: 0.376955
0.4998 --- loss: 0.951989, loss_ss: 0.743099, loss_d: 0.208890
0.5383 --- loss: 1.485509, loss_ss: 1.285982, loss_d: 0.199527
0.5767 --- loss: 1.285845, loss_ss: 1.087081, loss_d: 0.198765
0.6151 --- loss: 1.764532, loss_ss: 1.087924, loss_d: 0.676608
0.6536 --- loss: 0.984694, loss_ss: 0.716399, loss_d: 0.268295
0.6920 --- loss: 1.269570, loss_ss: 0.806322, loss_d: 0.463248
0.7305 --- loss: 1.114531, loss_ss: 0.920750, loss_d: 0.193781
0.7689 --- loss: 1.544106, loss_ss: 0.569107, loss_d: 0.975000
0.8074 --- loss: 1.594453, loss_ss: 1.201945, loss_d: 0.392508
0.8458 --- loss: 1.388598, loss_ss: 0.878665, loss_d: 0.509933
0.8843 --- loss: 1.136082, loss_ss: 0.838451, loss_d: 0.297630
0.9227 --- loss: 0.690281, loss_ss: 0.565392, loss_d: 0.124889
0.9612 --- loss: 1.299255, loss_ss: 0.850339, loss_d: 0.448916
0.9996 --- loss: 3.688820, loss_ss: 1.348350, loss_d: 2.340470
Epoch finished! Loss: 1.296686205955652
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.572795, loss_ss: 0.908630, loss_d: 0.664165
0.0384 --- loss: 1.477806, loss_ss: 1.150448, loss_d: 0.327358
0.0769 --- loss: 1.376106, loss_ss: 0.844056, loss_d: 0.532051
0.1153 --- loss: 1.013614, loss_ss: 0.647673, loss_d: 0.365941
0.1538 --- loss: 1.327872, loss_ss: 0.979402, loss_d: 0.348471
0.1922 --- loss: 0.834149, loss_ss: 0.656418, loss_d: 0.177731
0.2307 --- loss: 1.004525, loss_ss: 0.817881, loss_d: 0.186644
0.2691 --- loss: 1.231883, loss_ss: 1.044198, loss_d: 0.187685
0.3076 --- loss: 1.219675, loss_ss: 0.616831, loss_d: 0.602845
0.3460 --- loss: 1.169377, loss_ss: 0.904258, loss_d: 0.265120
0.3845 --- loss: 1.315932, loss_ss: 0.798497, loss_d: 0.517435
0.4229 --- loss: 1.631218, loss_ss: 1.317836, loss_d: 0.313382
0.4614 --- loss: 1.316564, loss_ss: 0.632923, loss_d: 0.683641
0.4998 --- loss: 1.268981, loss_ss: 0.983849, loss_d: 0.285132
0.5383 --- loss: 1.431139, loss_ss: 1.160279, loss_d: 0.270860
0.5767 --- loss: 1.252045, loss_ss: 0.898700, loss_d: 0.353346
0.6151 --- loss: 1.436966, loss_ss: 1.030978, loss_d: 0.405988
0.6536 --- loss: 1.342906, loss_ss: 0.941636, loss_d: 0.401270
0.6920 --- loss: 1.882746, loss_ss: 1.319710, loss_d: 0.563037
0.7305 --- loss: 1.172848, loss_ss: 0.926729, loss_d: 0.246119
0.7689 --- loss: 1.231009, loss_ss: 0.863703, loss_d: 0.367306
0.8074 --- loss: 1.030832, loss_ss: 0.938864, loss_d: 0.091968
0.8458 --- loss: 0.984289, loss_ss: 0.781768, loss_d: 0.202521
0.8843 --- loss: 1.591698, loss_ss: 0.908097, loss_d: 0.683600
0.9227 --- loss: 1.141009, loss_ss: 0.685112, loss_d: 0.455897
0.9612 --- loss: 0.982237, loss_ss: 0.753218, loss_d: 0.229018
0.9996 --- loss: 3.598058, loss_ss: 1.253803, loss_d: 2.344254
Epoch finished! Loss: 1.284620068852718
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.313858, loss_ss: 1.039298, loss_d: 0.274560
0.0384 --- loss: 1.821925, loss_ss: 1.153043, loss_d: 0.668882
0.0769 --- loss: 1.370976, loss_ss: 0.868058, loss_d: 0.502917
0.1153 --- loss: 1.672812, loss_ss: 1.091072, loss_d: 0.581740
0.1538 --- loss: 1.255793, loss_ss: 0.865612, loss_d: 0.390181
0.1922 --- loss: 1.279404, loss_ss: 0.990614, loss_d: 0.288790
0.2307 --- loss: 1.747621, loss_ss: 1.199237, loss_d: 0.548383
0.2691 --- loss: 1.574080, loss_ss: 0.988749, loss_d: 0.585331
0.3076 --- loss: 1.569714, loss_ss: 1.214369, loss_d: 0.355344
0.3460 --- loss: 1.020963, loss_ss: 0.873349, loss_d: 0.147614
0.3845 --- loss: 1.275542, loss_ss: 0.871856, loss_d: 0.403686
0.4229 --- loss: 1.661160, loss_ss: 0.786150, loss_d: 0.875010
0.4614 --- loss: 0.865000, loss_ss: 0.595731, loss_d: 0.269269
0.4998 --- loss: 1.063072, loss_ss: 0.834259, loss_d: 0.228813
0.5383 --- loss: 1.086229, loss_ss: 0.750405, loss_d: 0.335824
0.5767 --- loss: 1.022512, loss_ss: 0.840553, loss_d: 0.181959
0.6151 --- loss: 1.274369, loss_ss: 0.947021, loss_d: 0.327349
0.6536 --- loss: 1.083511, loss_ss: 0.909431, loss_d: 0.174080
0.6920 --- loss: 0.909750, loss_ss: 0.735327, loss_d: 0.174423
0.7305 --- loss: 1.438182, loss_ss: 1.175104, loss_d: 0.263077
0.7689 --- loss: 0.977643, loss_ss: 0.885385, loss_d: 0.092258
0.8074 --- loss: 1.561069, loss_ss: 1.255568, loss_d: 0.305502
0.8458 --- loss: 1.225672, loss_ss: 0.883711, loss_d: 0.341961
0.8843 --- loss: 1.378455, loss_ss: 0.819731, loss_d: 0.558724
0.9227 --- loss: 0.846339, loss_ss: 0.652151, loss_d: 0.194188
0.9612 --- loss: 0.978032, loss_ss: 0.790153, loss_d: 0.187878
0.9996 --- loss: 2.078992, loss_ss: 2.010799, loss_d: 0.068193
Epoch finished! Loss: 1.2251352715950745
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.384081, loss_ss: 0.889152, loss_d: 0.494929
0.0384 --- loss: 1.226308, loss_ss: 0.935989, loss_d: 0.290319
0.0769 --- loss: 1.503831, loss_ss: 1.276798, loss_d: 0.227032
0.1153 --- loss: 1.064765, loss_ss: 0.826315, loss_d: 0.238450
0.1538 --- loss: 1.152370, loss_ss: 0.785946, loss_d: 0.366424
0.1922 --- loss: 0.893164, loss_ss: 0.632156, loss_d: 0.261007
0.2307 --- loss: 1.741021, loss_ss: 1.191787, loss_d: 0.549234
0.2691 --- loss: 1.334225, loss_ss: 0.987818, loss_d: 0.346407
0.3076 --- loss: 1.190855, loss_ss: 0.713965, loss_d: 0.476890
0.3460 --- loss: 1.360561, loss_ss: 0.939287, loss_d: 0.421273
0.3845 --- loss: 1.033321, loss_ss: 0.673255, loss_d: 0.360066
0.4229 --- loss: 1.704394, loss_ss: 1.132264, loss_d: 0.572129
0.4614 --- loss: 0.899350, loss_ss: 0.788891, loss_d: 0.110459
0.4998 --- loss: 1.080463, loss_ss: 0.960383, loss_d: 0.120080
0.5383 --- loss: 1.232747, loss_ss: 0.889154, loss_d: 0.343593
0.5767 --- loss: 0.986420, loss_ss: 0.587615, loss_d: 0.398805
0.6151 --- loss: 1.355816, loss_ss: 0.951534, loss_d: 0.404282
0.6536 --- loss: 0.937546, loss_ss: 0.715414, loss_d: 0.222132
0.6920 --- loss: 1.304333, loss_ss: 0.838683, loss_d: 0.465650
0.7305 --- loss: 1.380953, loss_ss: 0.760149, loss_d: 0.620804
0.7689 --- loss: 1.036768, loss_ss: 0.894169, loss_d: 0.142599
0.8074 --- loss: 1.466854, loss_ss: 1.012249, loss_d: 0.454605
0.8458 --- loss: 1.066972, loss_ss: 0.784488, loss_d: 0.282484
0.8843 --- loss: 1.059364, loss_ss: 0.918756, loss_d: 0.140608
0.9227 --- loss: 1.231613, loss_ss: 0.768519, loss_d: 0.463094
0.9612 --- loss: 1.022592, loss_ss: 0.894128, loss_d: 0.128464
0.9996 --- loss: 1.400341, loss_ss: 1.331782, loss_d: 0.068559
Epoch finished! Loss: 1.1915183234673279
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6018018018018018
             precision    recall  f1-score   support

        0.0       0.07      0.87      0.13        23
        1.0       0.40      0.26      0.32       182
        2.0       0.83      0.59      0.69       379
        3.0       0.97      0.88      0.93       203
        4.0       0.77      0.61      0.68       323

avg / total       0.75      0.60      0.66      1110
 


====== chp012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  76.40  86.96   76.17   7.17     13.25
1  81.44  26.37   92.24  40.00     31.79
2  81.71  58.84   93.57  82.59     68.72
3  97.39  88.18   99.45  97.28     92.51
4  83.42  61.30   92.50  77.04     68.28
Total accuracy: 60.18%
Average sen: 64.33%
Average spec: 90.79%
Macro f1-score: 54.91%
[0.99929368 0.98320627 0.94397604 0.98018056 0.96974474 0.96314335
 0.99648428 0.99926597 0.99856037 0.99685329 0.99836928 0.9977963
 0.99809474 0.99782985 0.99828655 0.99988103 0.99959427 0.99004781
 0.96967244 0.99562931 0.99972898 0.99943525 0.99960619 0.9997384
 0.9986161  0.99987984 0.99896324 0.99148822 0.9997018  0.94842654
 0.99910045 0.99990129 0.99982268 0.99961084 0.99804676 0.99855369
 0.99793988]
pred: 0.9920127101846643, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.366681, loss_ss: 1.652991, loss_d: 0.713691
0.0384 --- loss: 1.919214, loss_ss: 1.534299, loss_d: 0.384915
0.0768 --- loss: 1.914196, loss_ss: 1.409939, loss_d: 0.504257
0.1152 --- loss: 1.931373, loss_ss: 1.430578, loss_d: 0.500795
0.1536 --- loss: 2.194430, loss_ss: 1.430915, loss_d: 0.763514
0.1919 --- loss: 2.048325, loss_ss: 1.400156, loss_d: 0.648169
0.2303 --- loss: 2.360961, loss_ss: 1.465124, loss_d: 0.895837
0.2687 --- loss: 2.094828, loss_ss: 1.511990, loss_d: 0.582838
0.3071 --- loss: 1.816018, loss_ss: 1.304393, loss_d: 0.511625
0.3455 --- loss: 1.975682, loss_ss: 1.507710, loss_d: 0.467972
0.3839 --- loss: 1.975220, loss_ss: 1.298373, loss_d: 0.676847
0.4223 --- loss: 1.977792, loss_ss: 1.310712, loss_d: 0.667079
0.4607 --- loss: 1.908700, loss_ss: 1.313156, loss_d: 0.595544
0.4990 --- loss: 1.690060, loss_ss: 1.232297, loss_d: 0.457763
0.5374 --- loss: 2.139885, loss_ss: 1.382727, loss_d: 0.757158
0.5758 --- loss: 2.090444, loss_ss: 1.386387, loss_d: 0.704057
0.6142 --- loss: 2.104149, loss_ss: 1.532423, loss_d: 0.571726
0.6526 --- loss: 1.608329, loss_ss: 1.191191, loss_d: 0.417138
0.6910 --- loss: 2.230958, loss_ss: 1.226195, loss_d: 1.004763
0.7294 --- loss: 1.896697, loss_ss: 1.336821, loss_d: 0.559876
0.7678 --- loss: 1.835569, loss_ss: 1.297631, loss_d: 0.537937
0.8061 --- loss: 1.902253, loss_ss: 1.204959, loss_d: 0.697294
0.8445 --- loss: 1.700698, loss_ss: 1.142161, loss_d: 0.558537
0.8829 --- loss: 2.194715, loss_ss: 1.442767, loss_d: 0.751948
0.9213 --- loss: 1.842127, loss_ss: 1.489542, loss_d: 0.352585
0.9597 --- loss: 1.569054, loss_ss: 1.180254, loss_d: 0.388800
0.9981 --- loss: 1.586006, loss_ss: 1.040674, loss_d: 0.545332
Epoch finished! Loss: 2.0091978192329405
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.889045, loss_ss: 1.370744, loss_d: 0.518300
0.0384 --- loss: 2.195018, loss_ss: 1.353882, loss_d: 0.841136
0.0768 --- loss: 1.567947, loss_ss: 1.141532, loss_d: 0.426415
0.1152 --- loss: 1.859828, loss_ss: 1.249575, loss_d: 0.610253
0.1536 --- loss: 1.777310, loss_ss: 1.202386, loss_d: 0.574924
0.1919 --- loss: 1.880365, loss_ss: 1.300118, loss_d: 0.580246
0.2303 --- loss: 1.873854, loss_ss: 1.362108, loss_d: 0.511746
0.2687 --- loss: 1.645039, loss_ss: 1.224771, loss_d: 0.420268
0.3071 --- loss: 1.754281, loss_ss: 1.185098, loss_d: 0.569184
0.3455 --- loss: 1.965234, loss_ss: 1.150653, loss_d: 0.814581
0.3839 --- loss: 1.859377, loss_ss: 1.314452, loss_d: 0.544925
0.4223 --- loss: 1.819887, loss_ss: 1.297055, loss_d: 0.522833
0.4607 --- loss: 1.844400, loss_ss: 1.202850, loss_d: 0.641550
0.4990 --- loss: 1.917840, loss_ss: 1.407521, loss_d: 0.510319
0.5374 --- loss: 1.471950, loss_ss: 1.165589, loss_d: 0.306361
0.5758 --- loss: 1.684211, loss_ss: 1.246758, loss_d: 0.437452
0.6142 --- loss: 1.540474, loss_ss: 1.018895, loss_d: 0.521579
0.6526 --- loss: 2.080695, loss_ss: 1.374723, loss_d: 0.705972
0.6910 --- loss: 1.445739, loss_ss: 1.095588, loss_d: 0.350152
0.7294 --- loss: 1.518865, loss_ss: 1.181777, loss_d: 0.337088
0.7678 --- loss: 1.833751, loss_ss: 1.122229, loss_d: 0.711522
0.8061 --- loss: 1.785654, loss_ss: 1.122620, loss_d: 0.663034
0.8445 --- loss: 1.798947, loss_ss: 1.237375, loss_d: 0.561572
0.8829 --- loss: 1.813477, loss_ss: 1.189872, loss_d: 0.623605
0.9213 --- loss: 1.965848, loss_ss: 1.255597, loss_d: 0.710251
0.9597 --- loss: 2.212345, loss_ss: 1.610409, loss_d: 0.601936
0.9981 --- loss: 2.079202, loss_ss: 1.254299, loss_d: 0.824904
Epoch finished! Loss: 1.8006786135526804
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.930750, loss_ss: 1.312882, loss_d: 0.617868
0.0384 --- loss: 2.123539, loss_ss: 1.338927, loss_d: 0.784613
0.0768 --- loss: 1.415485, loss_ss: 0.903086, loss_d: 0.512399
0.1152 --- loss: 1.961109, loss_ss: 1.509038, loss_d: 0.452070
0.1536 --- loss: 1.641509, loss_ss: 0.857851, loss_d: 0.783658
0.1919 --- loss: 1.446360, loss_ss: 0.937453, loss_d: 0.508907
0.2303 --- loss: 1.578648, loss_ss: 1.242355, loss_d: 0.336293
0.2687 --- loss: 1.644762, loss_ss: 1.272495, loss_d: 0.372267
0.3071 --- loss: 1.630727, loss_ss: 1.150914, loss_d: 0.479813
0.3455 --- loss: 1.793328, loss_ss: 1.082953, loss_d: 0.710375
0.3839 --- loss: 1.738723, loss_ss: 0.951130, loss_d: 0.787593
0.4223 --- loss: 1.756965, loss_ss: 1.149492, loss_d: 0.607473
0.4607 --- loss: 1.859762, loss_ss: 1.225444, loss_d: 0.634318
0.4990 --- loss: 1.656391, loss_ss: 1.011006, loss_d: 0.645385
0.5374 --- loss: 1.482744, loss_ss: 1.026075, loss_d: 0.456669
0.5758 --- loss: 1.920499, loss_ss: 0.990881, loss_d: 0.929618
0.6142 --- loss: 1.776596, loss_ss: 1.048029, loss_d: 0.728566
0.6526 --- loss: 1.737189, loss_ss: 1.151340, loss_d: 0.585849
0.6910 --- loss: 1.557094, loss_ss: 0.951591, loss_d: 0.605503
0.7294 --- loss: 1.550776, loss_ss: 0.968802, loss_d: 0.581974
0.7678 --- loss: 1.521566, loss_ss: 1.116154, loss_d: 0.405412
0.8061 --- loss: 1.576456, loss_ss: 1.134032, loss_d: 0.442425
0.8445 --- loss: 1.584579, loss_ss: 0.979324, loss_d: 0.605256
0.8829 --- loss: 1.898412, loss_ss: 1.342613, loss_d: 0.555799
0.9213 --- loss: 1.311641, loss_ss: 0.985633, loss_d: 0.326008
0.9597 --- loss: 1.841997, loss_ss: 1.357458, loss_d: 0.484538
0.9981 --- loss: 1.610125, loss_ss: 1.017616, loss_d: 0.592508
Epoch finished! Loss: 1.6982036384252401
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.272529, loss_ss: 0.960986, loss_d: 0.311543
0.0384 --- loss: 1.668445, loss_ss: 1.155714, loss_d: 0.512731
0.0768 --- loss: 1.516598, loss_ss: 1.151103, loss_d: 0.365494
0.1152 --- loss: 1.595694, loss_ss: 1.169009, loss_d: 0.426685
0.1536 --- loss: 1.721146, loss_ss: 1.015636, loss_d: 0.705510
0.1919 --- loss: 1.944446, loss_ss: 1.218556, loss_d: 0.725890
0.2303 --- loss: 1.627035, loss_ss: 1.011951, loss_d: 0.615083
0.2687 --- loss: 1.738643, loss_ss: 1.255533, loss_d: 0.483110
0.3071 --- loss: 1.517671, loss_ss: 0.982589, loss_d: 0.535082
0.3455 --- loss: 1.578876, loss_ss: 0.960271, loss_d: 0.618605
0.3839 --- loss: 1.681565, loss_ss: 1.067357, loss_d: 0.614207
0.4223 --- loss: 1.555204, loss_ss: 1.104094, loss_d: 0.451110
0.4607 --- loss: 1.831361, loss_ss: 1.020480, loss_d: 0.810880
0.4990 --- loss: 1.575005, loss_ss: 0.981808, loss_d: 0.593197
0.5374 --- loss: 1.323998, loss_ss: 0.952566, loss_d: 0.371432
0.5758 --- loss: 2.127315, loss_ss: 1.182156, loss_d: 0.945158
0.6142 --- loss: 1.560554, loss_ss: 1.188727, loss_d: 0.371827
0.6526 --- loss: 1.375102, loss_ss: 1.007800, loss_d: 0.367302
0.6910 --- loss: 1.767361, loss_ss: 1.255686, loss_d: 0.511674
0.7294 --- loss: 1.194159, loss_ss: 0.842231, loss_d: 0.351928
0.7678 --- loss: 1.562487, loss_ss: 0.978476, loss_d: 0.584011
0.8061 --- loss: 1.629533, loss_ss: 1.029127, loss_d: 0.600406
0.8445 --- loss: 1.424145, loss_ss: 1.011925, loss_d: 0.412220
0.8829 --- loss: 1.240356, loss_ss: 0.903652, loss_d: 0.336704
0.9213 --- loss: 1.942944, loss_ss: 1.077890, loss_d: 0.865054
0.9597 --- loss: 1.616086, loss_ss: 1.003440, loss_d: 0.612646
0.9981 --- loss: 2.315897, loss_ss: 1.206195, loss_d: 1.109702
Epoch finished! Loss: 1.6144489540503575
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.824897, loss_ss: 1.326321, loss_d: 0.498575
0.0384 --- loss: 1.288160, loss_ss: 0.951506, loss_d: 0.336653
0.0768 --- loss: 1.390118, loss_ss: 1.026559, loss_d: 0.363559
0.1152 --- loss: 1.337123, loss_ss: 0.946856, loss_d: 0.390268
0.1536 --- loss: 1.742112, loss_ss: 1.086728, loss_d: 0.655384
0.1919 --- loss: 1.564809, loss_ss: 1.019001, loss_d: 0.545809
0.2303 --- loss: 1.225023, loss_ss: 0.989798, loss_d: 0.235225
0.2687 --- loss: 1.756488, loss_ss: 1.428901, loss_d: 0.327587
0.3071 --- loss: 1.353154, loss_ss: 1.088019, loss_d: 0.265136
0.3455 --- loss: 1.494126, loss_ss: 1.183975, loss_d: 0.310151
0.3839 --- loss: 1.257020, loss_ss: 0.916327, loss_d: 0.340693
0.4223 --- loss: 1.511947, loss_ss: 1.171369, loss_d: 0.340578
0.4607 --- loss: 1.222991, loss_ss: 1.012702, loss_d: 0.210290
0.4990 --- loss: 1.362321, loss_ss: 0.931536, loss_d: 0.430785
0.5374 --- loss: 1.318866, loss_ss: 1.028468, loss_d: 0.290399
0.5758 --- loss: 1.267534, loss_ss: 0.915237, loss_d: 0.352297
0.6142 --- loss: 1.515839, loss_ss: 1.098082, loss_d: 0.417757
0.6526 --- loss: 1.272921, loss_ss: 0.965759, loss_d: 0.307162
0.6910 --- loss: 1.969348, loss_ss: 1.343429, loss_d: 0.625919
0.7294 --- loss: 1.599152, loss_ss: 1.110239, loss_d: 0.488914
0.7678 --- loss: 1.383559, loss_ss: 1.095253, loss_d: 0.288306
0.8061 --- loss: 1.404817, loss_ss: 1.133213, loss_d: 0.271604
0.8445 --- loss: 1.208735, loss_ss: 0.944700, loss_d: 0.264035
0.8829 --- loss: 1.646036, loss_ss: 1.294423, loss_d: 0.351613
0.9213 --- loss: 1.059302, loss_ss: 0.916782, loss_d: 0.142520
0.9597 --- loss: 1.635332, loss_ss: 1.112909, loss_d: 0.522423
0.9981 --- loss: 1.687993, loss_ss: 1.177854, loss_d: 0.510139
Epoch finished! Loss: 1.4580457022556892
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.177344, loss_ss: 0.976786, loss_d: 0.200558
0.0384 --- loss: 1.545406, loss_ss: 1.241848, loss_d: 0.303558
0.0768 --- loss: 1.695158, loss_ss: 1.123106, loss_d: 0.572052
0.1152 --- loss: 1.523455, loss_ss: 1.043332, loss_d: 0.480123
0.1536 --- loss: 1.574674, loss_ss: 1.116976, loss_d: 0.457698
0.1919 --- loss: 1.450732, loss_ss: 1.050585, loss_d: 0.400147
0.2303 --- loss: 1.298543, loss_ss: 0.822070, loss_d: 0.476473
0.2687 --- loss: 1.519742, loss_ss: 0.945253, loss_d: 0.574490
0.3071 --- loss: 1.300951, loss_ss: 0.949347, loss_d: 0.351604
0.3455 --- loss: 1.794058, loss_ss: 1.121794, loss_d: 0.672264
0.3839 --- loss: 1.034951, loss_ss: 0.827449, loss_d: 0.207502
0.4223 --- loss: 1.190884, loss_ss: 0.880158, loss_d: 0.310726
0.4607 --- loss: 1.332067, loss_ss: 0.842824, loss_d: 0.489243
0.4990 --- loss: 1.372832, loss_ss: 1.021673, loss_d: 0.351159
0.5374 --- loss: 1.674546, loss_ss: 1.035530, loss_d: 0.639016
0.5758 --- loss: 1.663186, loss_ss: 1.262981, loss_d: 0.400205
0.6142 --- loss: 1.232249, loss_ss: 0.752098, loss_d: 0.480151
0.6526 --- loss: 1.161629, loss_ss: 1.001792, loss_d: 0.159837
0.6910 --- loss: 1.194500, loss_ss: 0.873966, loss_d: 0.320534
0.7294 --- loss: 1.543988, loss_ss: 0.934683, loss_d: 0.609305
0.7678 --- loss: 1.733179, loss_ss: 1.255270, loss_d: 0.477909
0.8061 --- loss: 1.308737, loss_ss: 0.969548, loss_d: 0.339189
0.8445 --- loss: 1.264741, loss_ss: 0.876753, loss_d: 0.387987
0.8829 --- loss: 1.267637, loss_ss: 1.019898, loss_d: 0.247738
0.9213 --- loss: 1.772994, loss_ss: 1.111088, loss_d: 0.661906
0.9597 --- loss: 1.161615, loss_ss: 0.832259, loss_d: 0.329357
0.9981 --- loss: 1.919387, loss_ss: 1.632800, loss_d: 0.286587
Epoch finished! Loss: 1.354183826308984
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.114334, loss_ss: 0.888602, loss_d: 0.225732
0.0384 --- loss: 0.957208, loss_ss: 0.730098, loss_d: 0.227110
0.0768 --- loss: 1.060183, loss_ss: 0.905653, loss_d: 0.154530
0.1152 --- loss: 1.233724, loss_ss: 0.939026, loss_d: 0.294698
0.1536 --- loss: 0.976633, loss_ss: 0.861429, loss_d: 0.115205
0.1919 --- loss: 1.543008, loss_ss: 1.162841, loss_d: 0.380167
0.2303 --- loss: 1.398775, loss_ss: 1.048211, loss_d: 0.350564
0.2687 --- loss: 1.042905, loss_ss: 0.784632, loss_d: 0.258273
0.3071 --- loss: 1.370431, loss_ss: 0.759475, loss_d: 0.610956
0.3455 --- loss: 1.124238, loss_ss: 0.865103, loss_d: 0.259135
0.3839 --- loss: 1.271837, loss_ss: 1.010325, loss_d: 0.261512
0.4223 --- loss: 1.113828, loss_ss: 0.838025, loss_d: 0.275803
0.4607 --- loss: 1.224754, loss_ss: 0.993941, loss_d: 0.230814
0.4990 --- loss: 1.003966, loss_ss: 0.881159, loss_d: 0.122807
0.5374 --- loss: 1.442828, loss_ss: 1.015994, loss_d: 0.426834
0.5758 --- loss: 1.074399, loss_ss: 0.715856, loss_d: 0.358543
0.6142 --- loss: 1.009035, loss_ss: 0.715262, loss_d: 0.293773
0.6526 --- loss: 0.932606, loss_ss: 0.622873, loss_d: 0.309733
0.6910 --- loss: 1.416273, loss_ss: 0.977488, loss_d: 0.438785
0.7294 --- loss: 1.107873, loss_ss: 0.992128, loss_d: 0.115745
0.7678 --- loss: 1.282022, loss_ss: 1.028701, loss_d: 0.253320
0.8061 --- loss: 1.185274, loss_ss: 0.867620, loss_d: 0.317653
0.8445 --- loss: 1.329554, loss_ss: 0.821957, loss_d: 0.507597
0.8829 --- loss: 1.044664, loss_ss: 0.817467, loss_d: 0.227197
0.9213 --- loss: 1.112864, loss_ss: 0.711228, loss_d: 0.401637
0.9597 --- loss: 1.430958, loss_ss: 0.920758, loss_d: 0.510200
0.9981 --- loss: 1.534127, loss_ss: 1.348765, loss_d: 0.185362
Epoch finished! Loss: 1.238047022315172
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.093515, loss_ss: 1.711048, loss_d: 0.382467
0.0384 --- loss: 1.289130, loss_ss: 0.704316, loss_d: 0.584814
0.0768 --- loss: 1.241470, loss_ss: 0.954219, loss_d: 0.287251
0.1152 --- loss: 1.900922, loss_ss: 1.071162, loss_d: 0.829759
0.1536 --- loss: 1.053210, loss_ss: 0.827561, loss_d: 0.225648
0.1919 --- loss: 1.101057, loss_ss: 0.894390, loss_d: 0.206667
0.2303 --- loss: 1.274064, loss_ss: 0.949616, loss_d: 0.324448
0.2687 --- loss: 0.941467, loss_ss: 0.628682, loss_d: 0.312784
0.3071 --- loss: 1.235339, loss_ss: 0.907050, loss_d: 0.328290
0.3455 --- loss: 0.970625, loss_ss: 0.806714, loss_d: 0.163911
0.3839 --- loss: 1.175179, loss_ss: 0.820536, loss_d: 0.354643
0.4223 --- loss: 1.424109, loss_ss: 1.063649, loss_d: 0.360460
0.4607 --- loss: 1.535335, loss_ss: 0.804201, loss_d: 0.731134
0.4990 --- loss: 1.475233, loss_ss: 0.947743, loss_d: 0.527490
0.5374 --- loss: 1.514671, loss_ss: 1.283201, loss_d: 0.231470
0.5758 --- loss: 1.433915, loss_ss: 0.971687, loss_d: 0.462228
0.6142 --- loss: 0.948717, loss_ss: 0.815060, loss_d: 0.133658
0.6526 --- loss: 1.522989, loss_ss: 1.098474, loss_d: 0.424515
0.6910 --- loss: 1.612231, loss_ss: 0.857368, loss_d: 0.754862
0.7294 --- loss: 1.357095, loss_ss: 1.211871, loss_d: 0.145225
0.7678 --- loss: 1.214077, loss_ss: 1.025519, loss_d: 0.188558
0.8061 --- loss: 1.508523, loss_ss: 0.656183, loss_d: 0.852340
0.8445 --- loss: 1.153088, loss_ss: 0.772793, loss_d: 0.380295
0.8829 --- loss: 1.093536, loss_ss: 0.760882, loss_d: 0.332654
0.9213 --- loss: 0.922958, loss_ss: 0.782738, loss_d: 0.140221
0.9597 --- loss: 1.587780, loss_ss: 1.164489, loss_d: 0.423291
0.9981 --- loss: 1.433038, loss_ss: 1.241082, loss_d: 0.191956
Epoch finished! Loss: 1.2120577541681437
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.231924, loss_ss: 0.790316, loss_d: 0.441607
0.0384 --- loss: 1.114436, loss_ss: 0.975490, loss_d: 0.138946
0.0768 --- loss: 1.043349, loss_ss: 0.948056, loss_d: 0.095293
0.1152 --- loss: 0.936450, loss_ss: 0.817598, loss_d: 0.118852
0.1536 --- loss: 0.947387, loss_ss: 0.782284, loss_d: 0.165104
0.1919 --- loss: 0.960026, loss_ss: 0.716799, loss_d: 0.243227
0.2303 --- loss: 1.474855, loss_ss: 1.060104, loss_d: 0.414751
0.2687 --- loss: 1.397827, loss_ss: 0.901018, loss_d: 0.496810
0.3071 --- loss: 0.861666, loss_ss: 0.720550, loss_d: 0.141115
0.3455 --- loss: 0.803491, loss_ss: 0.515955, loss_d: 0.287536
0.3839 --- loss: 1.122810, loss_ss: 1.037698, loss_d: 0.085112
0.4223 --- loss: 1.015760, loss_ss: 0.736459, loss_d: 0.279301
0.4607 --- loss: 0.891755, loss_ss: 0.729195, loss_d: 0.162560
0.4990 --- loss: 1.352211, loss_ss: 1.253223, loss_d: 0.098988
0.5374 --- loss: 1.725283, loss_ss: 1.388270, loss_d: 0.337013
0.5758 --- loss: 0.971205, loss_ss: 0.825235, loss_d: 0.145970
0.6142 --- loss: 1.431179, loss_ss: 1.106310, loss_d: 0.324869
0.6526 --- loss: 1.418810, loss_ss: 0.820626, loss_d: 0.598185
0.6910 --- loss: 1.009129, loss_ss: 0.855830, loss_d: 0.153299
0.7294 --- loss: 1.124969, loss_ss: 0.965375, loss_d: 0.159595
0.7678 --- loss: 2.593477, loss_ss: 0.588578, loss_d: 2.004899
0.8061 --- loss: 1.252754, loss_ss: 1.011844, loss_d: 0.240911
0.8445 --- loss: 1.294412, loss_ss: 0.947048, loss_d: 0.347365
0.8829 --- loss: 1.384533, loss_ss: 0.874215, loss_d: 0.510318
0.9213 --- loss: 1.075787, loss_ss: 0.734011, loss_d: 0.341776
0.9597 --- loss: 0.943544, loss_ss: 0.717915, loss_d: 0.225629
0.9981 --- loss: 1.453975, loss_ss: 0.675799, loss_d: 0.778176
Epoch finished! Loss: 1.171751373547774
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.398995, loss_ss: 1.027529, loss_d: 0.371466
0.0384 --- loss: 1.873562, loss_ss: 1.526918, loss_d: 0.346643
0.0768 --- loss: 1.301465, loss_ss: 0.952346, loss_d: 0.349119
0.1152 --- loss: 0.981298, loss_ss: 0.648972, loss_d: 0.332326
0.1536 --- loss: 0.842732, loss_ss: 0.738587, loss_d: 0.104144
0.1919 --- loss: 0.910990, loss_ss: 0.691082, loss_d: 0.219908
0.2303 --- loss: 0.941572, loss_ss: 0.793501, loss_d: 0.148072
0.2687 --- loss: 0.904943, loss_ss: 0.756328, loss_d: 0.148615
0.3071 --- loss: 1.060606, loss_ss: 0.853942, loss_d: 0.206664
0.3455 --- loss: 1.027954, loss_ss: 0.775849, loss_d: 0.252105
0.3839 --- loss: 1.187040, loss_ss: 1.049733, loss_d: 0.137307
0.4223 --- loss: 0.971263, loss_ss: 0.894488, loss_d: 0.076775
0.4607 --- loss: 1.191065, loss_ss: 1.002829, loss_d: 0.188236
0.4990 --- loss: 1.404988, loss_ss: 0.951928, loss_d: 0.453059
0.5374 --- loss: 1.492375, loss_ss: 0.812662, loss_d: 0.679713
0.5758 --- loss: 1.159094, loss_ss: 0.864494, loss_d: 0.294600
0.6142 --- loss: 0.804569, loss_ss: 0.690897, loss_d: 0.113673
0.6526 --- loss: 1.095299, loss_ss: 0.761896, loss_d: 0.333403
0.6910 --- loss: 0.825705, loss_ss: 0.726096, loss_d: 0.099609
0.7294 --- loss: 1.245458, loss_ss: 0.750035, loss_d: 0.495424
0.7678 --- loss: 0.934359, loss_ss: 0.784345, loss_d: 0.150015
0.8061 --- loss: 0.957071, loss_ss: 0.808722, loss_d: 0.148349
0.8445 --- loss: 1.166123, loss_ss: 0.611187, loss_d: 0.554936
0.8829 --- loss: 0.829236, loss_ss: 0.500806, loss_d: 0.328430
0.9213 --- loss: 1.015770, loss_ss: 0.633584, loss_d: 0.382186
0.9597 --- loss: 1.173143, loss_ss: 0.973879, loss_d: 0.199264
0.9981 --- loss: 1.085619, loss_ss: 0.965827, loss_d: 0.119793
Epoch finished! Loss: 1.144145651276295
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6232323232323232
             precision    recall  f1-score   support

        0.0       0.30      0.88      0.45        33
        1.0       0.32      0.06      0.11       142
        2.0       0.83      0.59      0.69       433
        3.0       0.56      0.84      0.68       189
        4.0       0.59      0.84      0.70       193

avg / total       0.64      0.62      0.60       990
 


====== chp013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.83  87.88   93.00  30.21     44.96
1  84.65   6.34   97.76  32.14     10.59
2  76.97  59.35   90.66  83.17     69.27
3  84.55  84.13   84.64  56.38     67.52
4  85.66  84.46   85.95  59.27     69.66
Total accuracy: 62.32%
Average sen: 64.43%
Average spec: 90.40%
Macro f1-score: 52.40%
[0.16179065 0.1915243  0.25809911 0.26210594 0.2002997  0.11350374
 0.10083919 0.41245747 0.16743143 0.20596248 0.8118903  0.37105939
 0.17939381 0.22303602 0.69799787 0.73540503 0.32773349 0.89626563
 0.86210352 0.46506083 0.93216628 0.85345149 0.42106336 0.91459173
 0.37063777 0.82923913 0.54630166 0.26901895 0.2452115  0.25830859
 0.63866645 0.66996318 0.82755435]
pred: 0.4672767978274461, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.357559, loss_ss: 1.716673, loss_d: 0.640886
0.0384 --- loss: 2.182793, loss_ss: 1.619989, loss_d: 0.562804
0.0768 --- loss: 1.957837, loss_ss: 1.496871, loss_d: 0.460966
0.1152 --- loss: 2.120572, loss_ss: 1.487523, loss_d: 0.633049
0.1536 --- loss: 2.209849, loss_ss: 1.505567, loss_d: 0.704282
0.1919 --- loss: 2.096117, loss_ss: 1.363122, loss_d: 0.732994
0.2303 --- loss: 1.939443, loss_ss: 1.298988, loss_d: 0.640455
0.2687 --- loss: 2.010751, loss_ss: 1.376394, loss_d: 0.634357
0.3071 --- loss: 1.832338, loss_ss: 1.419316, loss_d: 0.413021
0.3455 --- loss: 1.923032, loss_ss: 1.296698, loss_d: 0.626334
0.3839 --- loss: 1.889883, loss_ss: 1.379724, loss_d: 0.510160
0.4223 --- loss: 1.820068, loss_ss: 1.336167, loss_d: 0.483901
0.4607 --- loss: 2.093797, loss_ss: 1.544456, loss_d: 0.549341
0.4990 --- loss: 1.712932, loss_ss: 1.289659, loss_d: 0.423273
0.5374 --- loss: 1.601503, loss_ss: 1.203199, loss_d: 0.398304
0.5758 --- loss: 1.843213, loss_ss: 1.328166, loss_d: 0.515047
0.6142 --- loss: 1.628035, loss_ss: 1.307672, loss_d: 0.320363
0.6526 --- loss: 1.698572, loss_ss: 1.262109, loss_d: 0.436463
0.6910 --- loss: 1.763731, loss_ss: 1.355615, loss_d: 0.408115
0.7294 --- loss: 1.663277, loss_ss: 1.267301, loss_d: 0.395976
0.7678 --- loss: 2.054527, loss_ss: 1.365677, loss_d: 0.688850
0.8061 --- loss: 1.837984, loss_ss: 1.208141, loss_d: 0.629844
0.8445 --- loss: 1.575828, loss_ss: 1.095676, loss_d: 0.480153
0.8829 --- loss: 1.684567, loss_ss: 1.066966, loss_d: 0.617602
0.9213 --- loss: 1.784692, loss_ss: 1.220162, loss_d: 0.564530
0.9597 --- loss: 1.696102, loss_ss: 1.278482, loss_d: 0.417620
0.9981 --- loss: 2.358757, loss_ss: 1.361920, loss_d: 0.996837
Epoch finished! Loss: 1.9454348458693578
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.771574, loss_ss: 1.389484, loss_d: 0.382090
0.0384 --- loss: 2.173139, loss_ss: 1.475167, loss_d: 0.697972
0.0768 --- loss: 1.734117, loss_ss: 1.011003, loss_d: 0.723114
0.1152 --- loss: 1.798939, loss_ss: 1.118947, loss_d: 0.679992
0.1536 --- loss: 1.714350, loss_ss: 0.938236, loss_d: 0.776114
0.1919 --- loss: 1.561144, loss_ss: 1.042979, loss_d: 0.518165
0.2303 --- loss: 1.789692, loss_ss: 1.256453, loss_d: 0.533238
0.2687 --- loss: 1.809080, loss_ss: 1.198711, loss_d: 0.610369
0.3071 --- loss: 1.649415, loss_ss: 1.028326, loss_d: 0.621089
0.3455 --- loss: 1.589335, loss_ss: 0.959401, loss_d: 0.629934
0.3839 --- loss: 1.711955, loss_ss: 1.016318, loss_d: 0.695637
0.4223 --- loss: 2.379112, loss_ss: 1.277910, loss_d: 1.101202
0.4607 --- loss: 1.692101, loss_ss: 1.013767, loss_d: 0.678334
0.4990 --- loss: 1.421783, loss_ss: 1.018603, loss_d: 0.403181
0.5374 --- loss: 1.563022, loss_ss: 1.124244, loss_d: 0.438778
0.5758 --- loss: 1.730230, loss_ss: 1.048030, loss_d: 0.682200
0.6142 --- loss: 1.864627, loss_ss: 1.472512, loss_d: 0.392115
0.6526 --- loss: 1.689703, loss_ss: 0.987546, loss_d: 0.702156
0.6910 --- loss: 1.969968, loss_ss: 1.167379, loss_d: 0.802589
0.7294 --- loss: 1.995499, loss_ss: 1.448229, loss_d: 0.547270
0.7678 --- loss: 1.604989, loss_ss: 1.071898, loss_d: 0.533091
0.8061 --- loss: 1.798775, loss_ss: 1.022715, loss_d: 0.776060
0.8445 --- loss: 2.055102, loss_ss: 1.500821, loss_d: 0.554282
0.8829 --- loss: 1.727430, loss_ss: 1.137956, loss_d: 0.589475
0.9213 --- loss: 1.394073, loss_ss: 0.943135, loss_d: 0.450937
0.9597 --- loss: 1.683584, loss_ss: 1.088102, loss_d: 0.595482
0.9981 --- loss: 1.342093, loss_ss: 1.029575, loss_d: 0.312518
Epoch finished! Loss: 1.7326017187191889
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.976422, loss_ss: 1.222573, loss_d: 0.753849
0.0384 --- loss: 1.669510, loss_ss: 1.051379, loss_d: 0.618131
0.0768 --- loss: 1.710545, loss_ss: 0.874295, loss_d: 0.836250
0.1152 --- loss: 1.590271, loss_ss: 0.954442, loss_d: 0.635828
0.1536 --- loss: 1.121508, loss_ss: 0.720731, loss_d: 0.400778
0.1919 --- loss: 1.496627, loss_ss: 1.107018, loss_d: 0.389609
0.2303 --- loss: 1.922241, loss_ss: 1.157094, loss_d: 0.765147
0.2687 --- loss: 1.379440, loss_ss: 0.855027, loss_d: 0.524413
0.3071 --- loss: 1.774968, loss_ss: 1.144939, loss_d: 0.630029
0.3455 --- loss: 1.670447, loss_ss: 1.272801, loss_d: 0.397646
0.3839 --- loss: 1.963690, loss_ss: 1.499745, loss_d: 0.463945
0.4223 --- loss: 1.726597, loss_ss: 1.348209, loss_d: 0.378388
0.4607 --- loss: 2.226155, loss_ss: 1.272181, loss_d: 0.953974
0.4990 --- loss: 1.855723, loss_ss: 1.056694, loss_d: 0.799029
0.5374 --- loss: 1.600000, loss_ss: 1.170919, loss_d: 0.429081
0.5758 --- loss: 1.736410, loss_ss: 0.948429, loss_d: 0.787980
0.6142 --- loss: 1.452893, loss_ss: 0.910974, loss_d: 0.541919
0.6526 --- loss: 1.645597, loss_ss: 1.127495, loss_d: 0.518102
0.6910 --- loss: 1.628309, loss_ss: 1.103551, loss_d: 0.524758
0.7294 --- loss: 1.593958, loss_ss: 0.890007, loss_d: 0.703950
0.7678 --- loss: 1.688764, loss_ss: 0.964565, loss_d: 0.724199
0.8061 --- loss: 1.558726, loss_ss: 0.965793, loss_d: 0.592933
0.8445 --- loss: 1.471772, loss_ss: 0.924203, loss_d: 0.547569
0.8829 --- loss: 1.902295, loss_ss: 1.079093, loss_d: 0.823201
0.9213 --- loss: 1.548393, loss_ss: 0.899952, loss_d: 0.648441
0.9597 --- loss: 1.344177, loss_ss: 0.894742, loss_d: 0.449435
0.9981 --- loss: 1.367967, loss_ss: 0.870246, loss_d: 0.497721
Epoch finished! Loss: 1.642505655838893
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.522576, loss_ss: 0.941640, loss_d: 0.580936
0.0384 --- loss: 1.620881, loss_ss: 1.106692, loss_d: 0.514189
0.0768 --- loss: 1.528268, loss_ss: 0.951834, loss_d: 0.576434
0.1152 --- loss: 1.070716, loss_ss: 0.758463, loss_d: 0.312253
0.1536 --- loss: 1.311536, loss_ss: 0.798949, loss_d: 0.512587
0.1919 --- loss: 1.532614, loss_ss: 0.932094, loss_d: 0.600519
0.2303 --- loss: 1.529036, loss_ss: 1.127371, loss_d: 0.401665
0.2687 --- loss: 1.542958, loss_ss: 0.989719, loss_d: 0.553239
0.3071 --- loss: 1.460511, loss_ss: 0.969332, loss_d: 0.491179
0.3455 --- loss: 1.459767, loss_ss: 0.727170, loss_d: 0.732597
0.3839 --- loss: 1.692939, loss_ss: 0.954662, loss_d: 0.738277
0.4223 --- loss: 1.493834, loss_ss: 0.695209, loss_d: 0.798625
0.4607 --- loss: 1.490477, loss_ss: 1.112281, loss_d: 0.378196
0.4990 --- loss: 1.603998, loss_ss: 1.019403, loss_d: 0.584596
0.5374 --- loss: 1.406665, loss_ss: 0.911300, loss_d: 0.495366
0.5758 --- loss: 1.439505, loss_ss: 0.924242, loss_d: 0.515263
0.6142 --- loss: 1.494053, loss_ss: 0.823710, loss_d: 0.670343
0.6526 --- loss: 1.463773, loss_ss: 1.101053, loss_d: 0.362720
0.6910 --- loss: 1.612188, loss_ss: 1.067061, loss_d: 0.545126
0.7294 --- loss: 1.783948, loss_ss: 0.987761, loss_d: 0.796187
0.7678 --- loss: 1.328723, loss_ss: 0.643556, loss_d: 0.685167
0.8061 --- loss: 1.455999, loss_ss: 0.895903, loss_d: 0.560097
0.8445 --- loss: 1.385762, loss_ss: 0.930154, loss_d: 0.455608
0.8829 --- loss: 1.273101, loss_ss: 0.692831, loss_d: 0.580270
0.9213 --- loss: 1.692711, loss_ss: 1.261249, loss_d: 0.431461
0.9597 --- loss: 1.405462, loss_ss: 0.845561, loss_d: 0.559901
0.9981 --- loss: 2.079756, loss_ss: 1.470633, loss_d: 0.609123
Epoch finished! Loss: 1.5608217156850375
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.843241, loss_ss: 1.336466, loss_d: 0.506775
0.0384 --- loss: 1.158162, loss_ss: 0.759319, loss_d: 0.398843
0.0768 --- loss: 1.550606, loss_ss: 0.943900, loss_d: 0.606706
0.1152 --- loss: 1.308652, loss_ss: 0.805289, loss_d: 0.503363
0.1536 --- loss: 1.897174, loss_ss: 1.521901, loss_d: 0.375273
0.1919 --- loss: 1.522411, loss_ss: 1.048588, loss_d: 0.473824
0.2303 --- loss: 1.463121, loss_ss: 0.946244, loss_d: 0.516877
0.2687 --- loss: 1.884894, loss_ss: 0.897431, loss_d: 0.987464
0.3071 --- loss: 1.463286, loss_ss: 0.970837, loss_d: 0.492449
0.3455 --- loss: 1.612381, loss_ss: 0.906584, loss_d: 0.705796
0.3839 --- loss: 1.268618, loss_ss: 0.864263, loss_d: 0.404354
0.4223 --- loss: 1.232177, loss_ss: 1.062157, loss_d: 0.170020
0.4607 --- loss: 1.502009, loss_ss: 1.101329, loss_d: 0.400680
0.4990 --- loss: 1.373471, loss_ss: 0.967929, loss_d: 0.405542
0.5374 --- loss: 1.514484, loss_ss: 1.100253, loss_d: 0.414231
0.5758 --- loss: 1.752584, loss_ss: 1.151943, loss_d: 0.600641
0.6142 --- loss: 2.004011, loss_ss: 0.982481, loss_d: 1.021530
0.6526 --- loss: 1.316515, loss_ss: 0.805048, loss_d: 0.511467
0.6910 --- loss: 1.539906, loss_ss: 0.984058, loss_d: 0.555847
0.7294 --- loss: 1.400200, loss_ss: 0.917644, loss_d: 0.482557
0.7678 --- loss: 1.767699, loss_ss: 1.067624, loss_d: 0.700075
0.8061 --- loss: 1.562659, loss_ss: 0.843617, loss_d: 0.719042
0.8445 --- loss: 1.050759, loss_ss: 0.741933, loss_d: 0.308826
0.8829 --- loss: 1.764881, loss_ss: 0.785805, loss_d: 0.979076
0.9213 --- loss: 1.277356, loss_ss: 0.843660, loss_d: 0.433695
0.9597 --- loss: 1.832822, loss_ss: 1.450596, loss_d: 0.382226
0.9981 --- loss: 1.652748, loss_ss: 0.755994, loss_d: 0.896754
Epoch finished! Loss: 1.5156670863811785
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.820871, loss_ss: 1.162307, loss_d: 0.658564
0.0384 --- loss: 1.355404, loss_ss: 0.880956, loss_d: 0.474448
0.0768 --- loss: 1.418479, loss_ss: 1.040045, loss_d: 0.378434
0.1152 --- loss: 1.443837, loss_ss: 0.727053, loss_d: 0.716784
0.1536 --- loss: 1.353222, loss_ss: 0.996475, loss_d: 0.356747
0.1919 --- loss: 1.313486, loss_ss: 0.757471, loss_d: 0.556016
0.2303 --- loss: 1.757407, loss_ss: 0.880845, loss_d: 0.876562
0.2687 --- loss: 1.103429, loss_ss: 0.869272, loss_d: 0.234157
0.3071 --- loss: 1.705851, loss_ss: 1.133142, loss_d: 0.572709
0.3455 --- loss: 1.440746, loss_ss: 0.865314, loss_d: 0.575432
0.3839 --- loss: 1.444432, loss_ss: 0.871107, loss_d: 0.573325
0.4223 --- loss: 1.330692, loss_ss: 0.774053, loss_d: 0.556639
0.4607 --- loss: 1.326385, loss_ss: 0.976168, loss_d: 0.350217
0.4990 --- loss: 1.436767, loss_ss: 1.153766, loss_d: 0.283001
0.5374 --- loss: 1.227413, loss_ss: 1.049170, loss_d: 0.178243
0.5758 --- loss: 1.362662, loss_ss: 0.903953, loss_d: 0.458710
0.6142 --- loss: 1.976538, loss_ss: 1.115486, loss_d: 0.861052
0.6526 --- loss: 1.090469, loss_ss: 0.645229, loss_d: 0.445240
0.6910 --- loss: 1.304069, loss_ss: 0.812318, loss_d: 0.491751
0.7294 --- loss: 1.285254, loss_ss: 0.682389, loss_d: 0.602865
0.7678 --- loss: 1.224955, loss_ss: 0.953283, loss_d: 0.271672
0.8061 --- loss: 1.085790, loss_ss: 0.756934, loss_d: 0.328856
0.8445 --- loss: 1.725556, loss_ss: 1.289695, loss_d: 0.435860
0.8829 --- loss: 1.309551, loss_ss: 0.855427, loss_d: 0.454123
0.9213 --- loss: 1.230927, loss_ss: 0.903570, loss_d: 0.327357
0.9597 --- loss: 1.289716, loss_ss: 0.681078, loss_d: 0.608639
0.9981 --- loss: 1.319053, loss_ss: 1.134770, loss_d: 0.184283
Epoch finished! Loss: 1.3894543634011196
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.431212, loss_ss: 0.786767, loss_d: 0.644445
0.0384 --- loss: 1.493567, loss_ss: 1.123412, loss_d: 0.370155
0.0768 --- loss: 1.305980, loss_ss: 0.932209, loss_d: 0.373771
0.1152 --- loss: 1.440020, loss_ss: 1.161105, loss_d: 0.278916
0.1536 --- loss: 0.934067, loss_ss: 0.733965, loss_d: 0.200102
0.1919 --- loss: 1.300308, loss_ss: 1.052335, loss_d: 0.247974
0.2303 --- loss: 1.225154, loss_ss: 0.989764, loss_d: 0.235390
0.2687 --- loss: 1.075844, loss_ss: 0.797850, loss_d: 0.277994
0.3071 --- loss: 1.209947, loss_ss: 0.856089, loss_d: 0.353858
0.3455 --- loss: 0.930807, loss_ss: 0.793186, loss_d: 0.137621
0.3839 --- loss: 1.183364, loss_ss: 0.800438, loss_d: 0.382926
0.4223 --- loss: 1.266043, loss_ss: 1.041192, loss_d: 0.224851
0.4607 --- loss: 1.481346, loss_ss: 1.153561, loss_d: 0.327786
0.4990 --- loss: 1.059991, loss_ss: 0.627846, loss_d: 0.432144
0.5374 --- loss: 1.620699, loss_ss: 0.850509, loss_d: 0.770190
0.5758 --- loss: 1.364068, loss_ss: 0.855008, loss_d: 0.509059
0.6142 --- loss: 1.205804, loss_ss: 0.989867, loss_d: 0.215938
0.6526 --- loss: 1.196398, loss_ss: 0.827253, loss_d: 0.369145
0.6910 --- loss: 1.222921, loss_ss: 0.989808, loss_d: 0.233113
0.7294 --- loss: 1.494340, loss_ss: 0.866596, loss_d: 0.627744
0.7678 --- loss: 1.119577, loss_ss: 0.707567, loss_d: 0.412010
0.8061 --- loss: 1.272181, loss_ss: 0.600285, loss_d: 0.671896
0.8445 --- loss: 1.466820, loss_ss: 1.076957, loss_d: 0.389863
0.8829 --- loss: 1.405545, loss_ss: 0.899574, loss_d: 0.505971
0.9213 --- loss: 1.162938, loss_ss: 0.809737, loss_d: 0.353200
0.9597 --- loss: 1.491504, loss_ss: 1.027563, loss_d: 0.463941
0.9981 --- loss: 1.783811, loss_ss: 0.851541, loss_d: 0.932270
Epoch finished! Loss: 1.3034064382314683
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.539346, loss_ss: 0.977693, loss_d: 0.561653
0.0384 --- loss: 1.938997, loss_ss: 1.535423, loss_d: 0.403574
0.0768 --- loss: 0.983754, loss_ss: 0.715353, loss_d: 0.268401
0.1152 --- loss: 1.052502, loss_ss: 0.893071, loss_d: 0.159432
0.1536 --- loss: 1.106602, loss_ss: 0.881028, loss_d: 0.225574
0.1919 --- loss: 1.469741, loss_ss: 1.002116, loss_d: 0.467625
0.2303 --- loss: 1.322065, loss_ss: 0.883565, loss_d: 0.438500
0.2687 --- loss: 1.283742, loss_ss: 0.727042, loss_d: 0.556700
0.3071 --- loss: 1.099149, loss_ss: 0.765319, loss_d: 0.333830
0.3455 --- loss: 1.332679, loss_ss: 0.848082, loss_d: 0.484597
0.3839 --- loss: 1.832560, loss_ss: 1.152565, loss_d: 0.679994
0.4223 --- loss: 0.989517, loss_ss: 0.762295, loss_d: 0.227222
0.4607 --- loss: 1.304786, loss_ss: 0.833779, loss_d: 0.471007
0.4990 --- loss: 1.668796, loss_ss: 1.081280, loss_d: 0.587516
0.5374 --- loss: 1.709717, loss_ss: 1.409906, loss_d: 0.299812
0.5758 --- loss: 1.218751, loss_ss: 0.699628, loss_d: 0.519124
0.6142 --- loss: 0.883807, loss_ss: 0.705964, loss_d: 0.177843
0.6526 --- loss: 1.744833, loss_ss: 0.931666, loss_d: 0.813167
0.6910 --- loss: 1.334128, loss_ss: 0.896862, loss_d: 0.437266
0.7294 --- loss: 1.012872, loss_ss: 0.680391, loss_d: 0.332481
0.7678 --- loss: 1.159697, loss_ss: 0.667193, loss_d: 0.492503
0.8061 --- loss: 1.260189, loss_ss: 0.985755, loss_d: 0.274434
0.8445 --- loss: 1.178116, loss_ss: 1.010745, loss_d: 0.167371
0.8829 --- loss: 1.363390, loss_ss: 1.180925, loss_d: 0.182465
0.9213 --- loss: 1.403799, loss_ss: 1.014072, loss_d: 0.389726
0.9597 --- loss: 1.475730, loss_ss: 1.045379, loss_d: 0.430351
0.9981 --- loss: 1.125074, loss_ss: 0.974742, loss_d: 0.150332
Epoch finished! Loss: 1.2601581876094525
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.606951, loss_ss: 1.384532, loss_d: 0.222419
0.0384 --- loss: 1.169394, loss_ss: 0.946091, loss_d: 0.223303
0.0768 --- loss: 1.267010, loss_ss: 0.803606, loss_d: 0.463405
0.1152 --- loss: 0.903244, loss_ss: 0.677719, loss_d: 0.225524
0.1536 --- loss: 1.518757, loss_ss: 1.271056, loss_d: 0.247701
0.1919 --- loss: 0.822374, loss_ss: 0.689061, loss_d: 0.133313
0.2303 --- loss: 1.187376, loss_ss: 0.917510, loss_d: 0.269867
0.2687 --- loss: 1.024207, loss_ss: 0.840003, loss_d: 0.184203
0.3071 --- loss: 2.120123, loss_ss: 1.191533, loss_d: 0.928591
0.3455 --- loss: 1.045511, loss_ss: 0.745677, loss_d: 0.299834
0.3839 --- loss: 1.408869, loss_ss: 1.108255, loss_d: 0.300614
0.4223 --- loss: 1.302292, loss_ss: 1.100741, loss_d: 0.201551
0.4607 --- loss: 1.971504, loss_ss: 1.443887, loss_d: 0.527617
0.4990 --- loss: 1.132231, loss_ss: 0.535229, loss_d: 0.597001
0.5374 --- loss: 1.123399, loss_ss: 0.824420, loss_d: 0.298980
0.5758 --- loss: 1.088854, loss_ss: 0.950356, loss_d: 0.138498
0.6142 --- loss: 1.314593, loss_ss: 1.087768, loss_d: 0.226826
0.6526 --- loss: 1.322169, loss_ss: 0.898906, loss_d: 0.423264
0.6910 --- loss: 1.253824, loss_ss: 0.883227, loss_d: 0.370597
0.7294 --- loss: 1.061630, loss_ss: 0.736224, loss_d: 0.325406
0.7678 --- loss: 1.485645, loss_ss: 0.790674, loss_d: 0.694971
0.8061 --- loss: 1.603961, loss_ss: 0.986024, loss_d: 0.617938
0.8445 --- loss: 1.724991, loss_ss: 1.342546, loss_d: 0.382444
0.8829 --- loss: 0.798851, loss_ss: 0.643633, loss_d: 0.155219
0.9213 --- loss: 1.138644, loss_ss: 0.949761, loss_d: 0.188883
0.9597 --- loss: 1.025427, loss_ss: 0.599290, loss_d: 0.426137
0.9981 --- loss: 1.086159, loss_ss: 0.883907, loss_d: 0.202252
Epoch finished! Loss: 1.1997702981416996
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.114907, loss_ss: 0.972165, loss_d: 0.142741
0.0384 --- loss: 1.100958, loss_ss: 0.813515, loss_d: 0.287443
0.0768 --- loss: 1.081590, loss_ss: 0.727333, loss_d: 0.354257
0.1152 --- loss: 0.767894, loss_ss: 0.605250, loss_d: 0.162644
0.1536 --- loss: 1.504636, loss_ss: 0.731514, loss_d: 0.773122
0.1919 --- loss: 1.570952, loss_ss: 0.805003, loss_d: 0.765949
0.2303 --- loss: 0.990739, loss_ss: 0.712242, loss_d: 0.278497
0.2687 --- loss: 1.082727, loss_ss: 0.726998, loss_d: 0.355729
0.3071 --- loss: 0.898563, loss_ss: 0.732593, loss_d: 0.165970
0.3455 --- loss: 0.967483, loss_ss: 0.701052, loss_d: 0.266431
0.3839 --- loss: 1.075131, loss_ss: 0.899150, loss_d: 0.175981
0.4223 --- loss: 1.453614, loss_ss: 0.982294, loss_d: 0.471319
0.4607 --- loss: 1.621593, loss_ss: 0.782529, loss_d: 0.839064
0.4990 --- loss: 1.041885, loss_ss: 0.762563, loss_d: 0.279322
0.5374 --- loss: 0.953564, loss_ss: 0.728468, loss_d: 0.225096
0.5758 --- loss: 0.854711, loss_ss: 0.707511, loss_d: 0.147200
0.6142 --- loss: 1.561661, loss_ss: 0.898800, loss_d: 0.662861
0.6526 --- loss: 0.824698, loss_ss: 0.742175, loss_d: 0.082523
0.6910 --- loss: 0.853448, loss_ss: 0.693252, loss_d: 0.160196
0.7294 --- loss: 1.476981, loss_ss: 0.789023, loss_d: 0.687958
0.7678 --- loss: 1.000489, loss_ss: 0.754373, loss_d: 0.246116
0.8061 --- loss: 1.141621, loss_ss: 0.960277, loss_d: 0.181344
0.8445 --- loss: 0.952625, loss_ss: 0.729283, loss_d: 0.223342
0.8829 --- loss: 1.123363, loss_ss: 0.989916, loss_d: 0.133447
0.9213 --- loss: 1.047633, loss_ss: 0.907870, loss_d: 0.139763
0.9597 --- loss: 1.067940, loss_ss: 0.929025, loss_d: 0.138914
0.9981 --- loss: 1.249205, loss_ss: 0.619098, loss_d: 0.630107
Epoch finished! Loss: 1.1772241447980587
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7858585858585858
             precision    recall  f1-score   support

        0.0       0.89      0.79      0.84       203
        1.0       0.23      0.41      0.29        68
        2.0       0.87      0.90      0.88       397
        3.0       0.97      0.97      0.97       146
        4.0       0.68      0.53      0.60       176

avg / total       0.81      0.79      0.80       990
 


====== chp014-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.74  78.82   97.59  89.39     83.77
1  86.46  41.18   89.80  22.95     29.47
2  90.61  89.67   91.23  87.25     88.45
3  99.09  96.58   99.53  97.24     96.91
4  87.27  52.84   94.72  68.38     59.62
Total accuracy: 78.59%
Average sen: 71.82%
Average spec: 94.57%
Macro f1-score: 71.64%
[0.89935529 0.98892689 0.98961508 0.93578583 0.91391724 0.87827665
 0.97193772 0.99457991 0.99957699 0.98909354 0.98619276 0.99684489
 0.97712815 0.97133589 0.91233557 0.9184823  0.98886245 0.99772745
 0.99097002 0.99509001 0.99794585 0.91055971 0.85699558 0.98968226
 0.99705005 0.99409193 0.97647333 0.99440432 0.98671198 0.96745414
 0.95154721 0.99696022 0.94341779]
pred: 0.9654342116731586, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.166885, loss_ss: 1.498787, loss_d: 0.668099
0.0385 --- loss: 1.788781, loss_ss: 1.422787, loss_d: 0.365994
0.0769 --- loss: 1.803710, loss_ss: 1.397049, loss_d: 0.406660
0.1154 --- loss: 2.094838, loss_ss: 1.612604, loss_d: 0.482234
0.1538 --- loss: 2.338406, loss_ss: 1.593118, loss_d: 0.745288
0.1923 --- loss: 1.971638, loss_ss: 1.366694, loss_d: 0.604943
0.2308 --- loss: 1.977607, loss_ss: 1.366764, loss_d: 0.610843
0.2692 --- loss: 1.872564, loss_ss: 1.299303, loss_d: 0.573261
0.3077 --- loss: 2.104787, loss_ss: 1.380835, loss_d: 0.723952
0.3462 --- loss: 2.149373, loss_ss: 1.259135, loss_d: 0.890238
0.3846 --- loss: 2.087350, loss_ss: 1.202057, loss_d: 0.885294
0.4231 --- loss: 1.796276, loss_ss: 1.247857, loss_d: 0.548419
0.4615 --- loss: 1.848177, loss_ss: 1.331656, loss_d: 0.516521
0.5000 --- loss: 1.816916, loss_ss: 1.251264, loss_d: 0.565653
0.5385 --- loss: 1.657858, loss_ss: 1.275654, loss_d: 0.382204
0.5769 --- loss: 2.067783, loss_ss: 1.443187, loss_d: 0.624596
0.6154 --- loss: 1.852051, loss_ss: 1.454113, loss_d: 0.397938
0.6538 --- loss: 1.933643, loss_ss: 1.360594, loss_d: 0.573049
0.6923 --- loss: 1.751979, loss_ss: 1.301361, loss_d: 0.450617
0.7308 --- loss: 1.590407, loss_ss: 1.335333, loss_d: 0.255074
0.7692 --- loss: 1.872694, loss_ss: 1.320210, loss_d: 0.552484
0.8077 --- loss: 1.912200, loss_ss: 1.307302, loss_d: 0.604898
0.8462 --- loss: 1.674765, loss_ss: 1.248824, loss_d: 0.425941
0.8846 --- loss: 1.993273, loss_ss: 1.276626, loss_d: 0.716646
0.9231 --- loss: 1.898516, loss_ss: 1.267671, loss_d: 0.630845
0.9615 --- loss: 1.886690, loss_ss: 1.096422, loss_d: 0.790268
Epoch finished! Loss: 1.959408586549943
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.172829, loss_ss: 1.637026, loss_d: 0.535803
0.0385 --- loss: 1.936138, loss_ss: 1.373341, loss_d: 0.562797
0.0769 --- loss: 1.691213, loss_ss: 1.237578, loss_d: 0.453635
0.1154 --- loss: 1.873779, loss_ss: 1.273431, loss_d: 0.600348
0.1538 --- loss: 1.968230, loss_ss: 1.413701, loss_d: 0.554529
0.1923 --- loss: 1.993738, loss_ss: 1.367928, loss_d: 0.625810
0.2308 --- loss: 1.649614, loss_ss: 1.266611, loss_d: 0.383003
0.2692 --- loss: 1.632310, loss_ss: 1.133647, loss_d: 0.498663
0.3077 --- loss: 2.014309, loss_ss: 1.381123, loss_d: 0.633187
0.3462 --- loss: 1.466862, loss_ss: 1.050188, loss_d: 0.416674
0.3846 --- loss: 1.615817, loss_ss: 1.257491, loss_d: 0.358326
0.4231 --- loss: 1.875289, loss_ss: 1.418837, loss_d: 0.456452
0.4615 --- loss: 1.670380, loss_ss: 1.029002, loss_d: 0.641378
0.5000 --- loss: 1.663624, loss_ss: 1.000388, loss_d: 0.663236
0.5385 --- loss: 1.953138, loss_ss: 1.405426, loss_d: 0.547712
0.5769 --- loss: 1.852860, loss_ss: 1.308617, loss_d: 0.544243
0.6154 --- loss: 1.867475, loss_ss: 1.351197, loss_d: 0.516278
0.6538 --- loss: 1.554335, loss_ss: 0.967270, loss_d: 0.587066
0.6923 --- loss: 1.710539, loss_ss: 1.075760, loss_d: 0.634778
0.7308 --- loss: 1.626638, loss_ss: 0.971568, loss_d: 0.655069
0.7692 --- loss: 1.754526, loss_ss: 0.952764, loss_d: 0.801762
0.8077 --- loss: 2.003206, loss_ss: 1.436652, loss_d: 0.566554
0.8462 --- loss: 1.470728, loss_ss: 1.008227, loss_d: 0.462501
0.8846 --- loss: 1.618539, loss_ss: 1.140034, loss_d: 0.478506
0.9231 --- loss: 1.840712, loss_ss: 1.113551, loss_d: 0.727160
0.9615 --- loss: 1.925761, loss_ss: 1.379171, loss_d: 0.546590
Epoch finished! Loss: 1.765880900000053
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.499347, loss_ss: 1.107513, loss_d: 0.391834
0.0385 --- loss: 1.794256, loss_ss: 1.313273, loss_d: 0.480983
0.0769 --- loss: 2.030770, loss_ss: 1.003985, loss_d: 1.026784
0.1154 --- loss: 1.533658, loss_ss: 1.008629, loss_d: 0.525030
0.1538 --- loss: 2.119658, loss_ss: 1.179970, loss_d: 0.939688
0.1923 --- loss: 1.395444, loss_ss: 0.848416, loss_d: 0.547028
0.2308 --- loss: 1.520490, loss_ss: 1.146059, loss_d: 0.374432
0.2692 --- loss: 2.052235, loss_ss: 1.107706, loss_d: 0.944529
0.3077 --- loss: 1.293952, loss_ss: 0.850354, loss_d: 0.443597
0.3462 --- loss: 1.700224, loss_ss: 0.961028, loss_d: 0.739196
0.3846 --- loss: 1.834575, loss_ss: 1.053583, loss_d: 0.780992
0.4231 --- loss: 1.236832, loss_ss: 0.869155, loss_d: 0.367677
0.4615 --- loss: 1.828579, loss_ss: 1.193994, loss_d: 0.634585
0.5000 --- loss: 1.614467, loss_ss: 1.092514, loss_d: 0.521953
0.5385 --- loss: 1.546922, loss_ss: 0.951035, loss_d: 0.595887
0.5769 --- loss: 1.536283, loss_ss: 1.029149, loss_d: 0.507134
0.6154 --- loss: 1.327327, loss_ss: 0.791261, loss_d: 0.536066
0.6538 --- loss: 1.631779, loss_ss: 1.061116, loss_d: 0.570663
0.6923 --- loss: 1.632939, loss_ss: 0.896101, loss_d: 0.736838
0.7308 --- loss: 1.602365, loss_ss: 1.046869, loss_d: 0.555496
0.7692 --- loss: 1.710841, loss_ss: 1.123152, loss_d: 0.587689
0.8077 --- loss: 1.444415, loss_ss: 0.905024, loss_d: 0.539391
0.8462 --- loss: 2.035806, loss_ss: 1.312950, loss_d: 0.722856
0.8846 --- loss: 1.444789, loss_ss: 0.924718, loss_d: 0.520071
0.9231 --- loss: 1.385007, loss_ss: 0.885021, loss_d: 0.499986
0.9615 --- loss: 1.722511, loss_ss: 1.076506, loss_d: 0.646005
Epoch finished! Loss: 1.6066755935492203
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.427173, loss_ss: 0.960894, loss_d: 0.466279
0.0385 --- loss: 1.898019, loss_ss: 1.340853, loss_d: 0.557166
0.0769 --- loss: 1.696050, loss_ss: 1.052364, loss_d: 0.643686
0.1154 --- loss: 1.543274, loss_ss: 0.871215, loss_d: 0.672059
0.1538 --- loss: 1.596993, loss_ss: 1.142258, loss_d: 0.454735
0.1923 --- loss: 1.667985, loss_ss: 0.961429, loss_d: 0.706556
0.2308 --- loss: 1.512714, loss_ss: 0.934489, loss_d: 0.578225
0.2692 --- loss: 1.819252, loss_ss: 1.087499, loss_d: 0.731753
0.3077 --- loss: 1.498045, loss_ss: 0.936713, loss_d: 0.561332
0.3462 --- loss: 1.536925, loss_ss: 0.964369, loss_d: 0.572556
0.3846 --- loss: 1.394553, loss_ss: 0.841876, loss_d: 0.552677
0.4231 --- loss: 1.513046, loss_ss: 1.220521, loss_d: 0.292524
0.4615 --- loss: 1.580441, loss_ss: 1.055045, loss_d: 0.525395
0.5000 --- loss: 1.722075, loss_ss: 0.948299, loss_d: 0.773776
0.5385 --- loss: 1.889921, loss_ss: 1.023345, loss_d: 0.866576
0.5769 --- loss: 1.773699, loss_ss: 1.182348, loss_d: 0.591351
0.6154 --- loss: 1.520912, loss_ss: 1.044289, loss_d: 0.476622
0.6538 --- loss: 1.915598, loss_ss: 1.155115, loss_d: 0.760483
0.6923 --- loss: 1.155178, loss_ss: 0.918478, loss_d: 0.236700
0.7308 --- loss: 1.926131, loss_ss: 1.224773, loss_d: 0.701358
0.7692 --- loss: 1.160121, loss_ss: 0.723010, loss_d: 0.437111
0.8077 --- loss: 1.076391, loss_ss: 0.779430, loss_d: 0.296961
0.8462 --- loss: 1.114368, loss_ss: 0.789629, loss_d: 0.324739
0.8846 --- loss: 1.391213, loss_ss: 0.894189, loss_d: 0.497024
0.9231 --- loss: 1.545027, loss_ss: 1.045645, loss_d: 0.499382
0.9615 --- loss: 1.463597, loss_ss: 0.875261, loss_d: 0.588335
Epoch finished! Loss: 1.4849737482181387
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.405393, loss_ss: 0.729422, loss_d: 0.675971
0.0385 --- loss: 1.215072, loss_ss: 0.815440, loss_d: 0.399631
0.0769 --- loss: 1.380350, loss_ss: 0.944375, loss_d: 0.435976
0.1154 --- loss: 1.370817, loss_ss: 1.022737, loss_d: 0.348080
0.1538 --- loss: 1.490075, loss_ss: 1.003999, loss_d: 0.486076
0.1923 --- loss: 1.580803, loss_ss: 0.758128, loss_d: 0.822676
0.2308 --- loss: 1.268165, loss_ss: 1.005048, loss_d: 0.263117
0.2692 --- loss: 1.954433, loss_ss: 1.245785, loss_d: 0.708648
0.3077 --- loss: 1.617620, loss_ss: 1.087857, loss_d: 0.529763
0.3462 --- loss: 1.193498, loss_ss: 0.805812, loss_d: 0.387686
0.3846 --- loss: 1.225744, loss_ss: 0.841190, loss_d: 0.384554
0.4231 --- loss: 1.245826, loss_ss: 0.827623, loss_d: 0.418203
0.4615 --- loss: 1.318789, loss_ss: 0.725305, loss_d: 0.593484
0.5000 --- loss: 1.781050, loss_ss: 1.210812, loss_d: 0.570238
0.5385 --- loss: 1.892533, loss_ss: 1.220485, loss_d: 0.672048
0.5769 --- loss: 1.703055, loss_ss: 1.197383, loss_d: 0.505672
0.6154 --- loss: 1.486739, loss_ss: 0.788520, loss_d: 0.698219
0.6538 --- loss: 1.162300, loss_ss: 0.747826, loss_d: 0.414474
0.6923 --- loss: 1.735805, loss_ss: 0.656659, loss_d: 1.079145
0.7308 --- loss: 1.471054, loss_ss: 0.787388, loss_d: 0.683666
0.7692 --- loss: 1.249305, loss_ss: 0.853067, loss_d: 0.396238
0.8077 --- loss: 1.972428, loss_ss: 1.272358, loss_d: 0.700070
0.8462 --- loss: 1.171894, loss_ss: 0.877878, loss_d: 0.294016
0.8846 --- loss: 1.344873, loss_ss: 0.851331, loss_d: 0.493542
0.9231 --- loss: 1.609262, loss_ss: 1.275522, loss_d: 0.333740
0.9615 --- loss: 1.175639, loss_ss: 0.766242, loss_d: 0.409398
Epoch finished! Loss: 1.4133668014901946
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.126760, loss_ss: 0.805972, loss_d: 0.320788
0.0385 --- loss: 1.250489, loss_ss: 1.026775, loss_d: 0.223714
0.0769 --- loss: 1.232094, loss_ss: 1.015949, loss_d: 0.216145
0.1154 --- loss: 1.338041, loss_ss: 1.165441, loss_d: 0.172600
0.1538 --- loss: 0.922663, loss_ss: 0.747178, loss_d: 0.175485
0.1923 --- loss: 1.453433, loss_ss: 1.032454, loss_d: 0.420978
0.2308 --- loss: 1.203866, loss_ss: 0.802058, loss_d: 0.401808
0.2692 --- loss: 1.237208, loss_ss: 0.960466, loss_d: 0.276742
0.3077 --- loss: 1.127991, loss_ss: 0.781797, loss_d: 0.346194
0.3462 --- loss: 0.953848, loss_ss: 0.730211, loss_d: 0.223637
0.3846 --- loss: 1.415875, loss_ss: 0.758520, loss_d: 0.657355
0.4231 --- loss: 1.670925, loss_ss: 1.261167, loss_d: 0.409758
0.4615 --- loss: 1.746545, loss_ss: 0.944024, loss_d: 0.802521
0.5000 --- loss: 1.207885, loss_ss: 0.824227, loss_d: 0.383658
0.5385 --- loss: 1.344666, loss_ss: 0.819675, loss_d: 0.524991
0.5769 --- loss: 1.370181, loss_ss: 0.929223, loss_d: 0.440958
0.6154 --- loss: 1.783956, loss_ss: 1.184769, loss_d: 0.599188
0.6538 --- loss: 1.369437, loss_ss: 0.934832, loss_d: 0.434605
0.6923 --- loss: 1.406546, loss_ss: 0.892202, loss_d: 0.514344
0.7308 --- loss: 1.042570, loss_ss: 0.719693, loss_d: 0.322877
0.7692 --- loss: 1.111064, loss_ss: 0.911041, loss_d: 0.200022
0.8077 --- loss: 1.060599, loss_ss: 0.794272, loss_d: 0.266327
0.8462 --- loss: 2.202329, loss_ss: 0.805710, loss_d: 1.396619
0.8846 --- loss: 1.552282, loss_ss: 0.940095, loss_d: 0.612187
0.9231 --- loss: 1.400589, loss_ss: 0.908856, loss_d: 0.491732
0.9615 --- loss: 1.694439, loss_ss: 0.708135, loss_d: 0.986304
Epoch finished! Loss: 1.3188840838933082
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.176553, loss_ss: 0.754677, loss_d: 0.421876
0.0385 --- loss: 1.280263, loss_ss: 0.767034, loss_d: 0.513229
0.0769 --- loss: 1.662880, loss_ss: 1.103677, loss_d: 0.559203
0.1154 --- loss: 0.942454, loss_ss: 0.754323, loss_d: 0.188130
0.1538 --- loss: 1.045710, loss_ss: 0.817051, loss_d: 0.228659
0.1923 --- loss: 1.394391, loss_ss: 1.093640, loss_d: 0.300751
0.2308 --- loss: 1.457575, loss_ss: 0.805519, loss_d: 0.652056
0.2692 --- loss: 1.260979, loss_ss: 0.892825, loss_d: 0.368155
0.3077 --- loss: 1.250550, loss_ss: 0.923755, loss_d: 0.326795
0.3462 --- loss: 0.999176, loss_ss: 0.707945, loss_d: 0.291231
0.3846 --- loss: 0.793935, loss_ss: 0.562862, loss_d: 0.231073
0.4231 --- loss: 1.547932, loss_ss: 1.338006, loss_d: 0.209926
0.4615 --- loss: 1.677992, loss_ss: 1.292237, loss_d: 0.385755
0.5000 --- loss: 1.334216, loss_ss: 0.907089, loss_d: 0.427127
0.5385 --- loss: 1.159791, loss_ss: 0.821643, loss_d: 0.338148
0.5769 --- loss: 1.460705, loss_ss: 1.140234, loss_d: 0.320472
0.6154 --- loss: 1.148755, loss_ss: 0.778933, loss_d: 0.369822
0.6538 --- loss: 1.443238, loss_ss: 1.176237, loss_d: 0.267001
0.6923 --- loss: 1.512756, loss_ss: 0.941894, loss_d: 0.570862
0.7308 --- loss: 1.096217, loss_ss: 0.871508, loss_d: 0.224709
0.7692 --- loss: 1.293460, loss_ss: 0.770314, loss_d: 0.523146
0.8077 --- loss: 1.803988, loss_ss: 1.129124, loss_d: 0.674864
0.8462 --- loss: 1.186840, loss_ss: 0.752667, loss_d: 0.434173
0.8846 --- loss: 1.074282, loss_ss: 0.853058, loss_d: 0.221224
0.9231 --- loss: 1.208390, loss_ss: 0.647543, loss_d: 0.560847
0.9615 --- loss: 1.418234, loss_ss: 0.931491, loss_d: 0.486743
Epoch finished! Loss: 1.3162703629166004
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.040975, loss_ss: 0.805033, loss_d: 0.235942
0.0385 --- loss: 1.263437, loss_ss: 0.997249, loss_d: 0.266188
0.0769 --- loss: 1.693158, loss_ss: 0.955538, loss_d: 0.737620
0.1154 --- loss: 0.987884, loss_ss: 0.849324, loss_d: 0.138560
0.1538 --- loss: 1.078175, loss_ss: 0.863759, loss_d: 0.214416
0.1923 --- loss: 1.185554, loss_ss: 0.898683, loss_d: 0.286871
0.2308 --- loss: 1.332981, loss_ss: 0.906170, loss_d: 0.426811
0.2692 --- loss: 1.146109, loss_ss: 0.867643, loss_d: 0.278466
0.3077 --- loss: 1.050663, loss_ss: 0.795842, loss_d: 0.254820
0.3462 --- loss: 1.378204, loss_ss: 1.120061, loss_d: 0.258142
0.3846 --- loss: 1.494014, loss_ss: 1.232218, loss_d: 0.261795
0.4231 --- loss: 1.523930, loss_ss: 1.158203, loss_d: 0.365726
0.4615 --- loss: 1.371464, loss_ss: 0.900316, loss_d: 0.471148
0.5000 --- loss: 1.526539, loss_ss: 0.938373, loss_d: 0.588166
0.5385 --- loss: 1.009910, loss_ss: 0.773351, loss_d: 0.236559
0.5769 --- loss: 1.667587, loss_ss: 1.004755, loss_d: 0.662832
0.6154 --- loss: 0.989609, loss_ss: 0.843773, loss_d: 0.145836
0.6538 --- loss: 1.390430, loss_ss: 1.171832, loss_d: 0.218598
0.6923 --- loss: 0.995863, loss_ss: 0.792468, loss_d: 0.203395
0.7308 --- loss: 1.684818, loss_ss: 0.912178, loss_d: 0.772640
0.7692 --- loss: 1.284677, loss_ss: 1.062663, loss_d: 0.222013
0.8077 --- loss: 1.241532, loss_ss: 0.733312, loss_d: 0.508220
0.8462 --- loss: 1.072500, loss_ss: 0.681741, loss_d: 0.390759
0.8846 --- loss: 1.350039, loss_ss: 1.008569, loss_d: 0.341470
0.9231 --- loss: 1.690176, loss_ss: 1.374293, loss_d: 0.315883
0.9615 --- loss: 1.064102, loss_ss: 0.861931, loss_d: 0.202172
Epoch finished! Loss: 1.260564108382781
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.803964, loss_ss: 0.571748, loss_d: 0.232216
0.0385 --- loss: 0.929515, loss_ss: 0.793737, loss_d: 0.135778
0.0769 --- loss: 1.460058, loss_ss: 1.043326, loss_d: 0.416732
0.1154 --- loss: 1.137845, loss_ss: 0.684284, loss_d: 0.453561
0.1538 --- loss: 0.782902, loss_ss: 0.604855, loss_d: 0.178046
0.1923 --- loss: 1.311378, loss_ss: 0.909175, loss_d: 0.402203
0.2308 --- loss: 0.984176, loss_ss: 0.632762, loss_d: 0.351413
0.2692 --- loss: 0.871107, loss_ss: 0.745152, loss_d: 0.125955
0.3077 --- loss: 1.188321, loss_ss: 0.877315, loss_d: 0.311006
0.3462 --- loss: 1.059954, loss_ss: 0.619752, loss_d: 0.440203
0.3846 --- loss: 1.692977, loss_ss: 0.990982, loss_d: 0.701995
0.4231 --- loss: 1.069470, loss_ss: 0.778615, loss_d: 0.290855
0.4615 --- loss: 0.910287, loss_ss: 0.710017, loss_d: 0.200270
0.5000 --- loss: 1.445414, loss_ss: 1.045715, loss_d: 0.399699
0.5385 --- loss: 0.861144, loss_ss: 0.722525, loss_d: 0.138620
0.5769 --- loss: 1.269525, loss_ss: 0.841113, loss_d: 0.428412
0.6154 --- loss: 1.383255, loss_ss: 0.928030, loss_d: 0.455225
0.6538 --- loss: 1.364394, loss_ss: 1.045221, loss_d: 0.319173
0.6923 --- loss: 0.995507, loss_ss: 0.654152, loss_d: 0.341355
0.7308 --- loss: 0.771497, loss_ss: 0.686381, loss_d: 0.085115
0.7692 --- loss: 0.929232, loss_ss: 0.840040, loss_d: 0.089192
0.8077 --- loss: 1.515913, loss_ss: 0.643926, loss_d: 0.871986
0.8462 --- loss: 1.007690, loss_ss: 0.813071, loss_d: 0.194618
0.8846 --- loss: 1.425729, loss_ss: 0.899041, loss_d: 0.526689
0.9231 --- loss: 0.927818, loss_ss: 0.620286, loss_d: 0.307532
0.9615 --- loss: 1.352753, loss_ss: 1.016660, loss_d: 0.336093
Epoch finished! Loss: 1.197136573349647
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.345124, loss_ss: 0.803110, loss_d: 0.542013
0.0385 --- loss: 1.336910, loss_ss: 0.878639, loss_d: 0.458271
0.0769 --- loss: 1.016630, loss_ss: 0.806587, loss_d: 0.210043
0.1154 --- loss: 1.172184, loss_ss: 0.897152, loss_d: 0.275032
0.1538 --- loss: 0.960714, loss_ss: 0.871506, loss_d: 0.089209
0.1923 --- loss: 1.088890, loss_ss: 0.948522, loss_d: 0.140368
0.2308 --- loss: 1.778020, loss_ss: 1.383205, loss_d: 0.394815
0.2692 --- loss: 1.497188, loss_ss: 1.092247, loss_d: 0.404941
0.3077 --- loss: 1.275093, loss_ss: 0.817270, loss_d: 0.457822
0.3462 --- loss: 0.885976, loss_ss: 0.652759, loss_d: 0.233217
0.3846 --- loss: 1.146708, loss_ss: 0.888118, loss_d: 0.258590
0.4231 --- loss: 1.081831, loss_ss: 0.768187, loss_d: 0.313643
0.4615 --- loss: 1.190329, loss_ss: 0.998570, loss_d: 0.191758
0.5000 --- loss: 0.802232, loss_ss: 0.704298, loss_d: 0.097934
0.5385 --- loss: 1.329128, loss_ss: 1.037030, loss_d: 0.292099
0.5769 --- loss: 0.912428, loss_ss: 0.595486, loss_d: 0.316942
0.6154 --- loss: 1.317768, loss_ss: 1.108989, loss_d: 0.208779
0.6538 --- loss: 1.181411, loss_ss: 0.849752, loss_d: 0.331659
0.6923 --- loss: 1.203020, loss_ss: 0.944111, loss_d: 0.258910
0.7308 --- loss: 1.465776, loss_ss: 1.066712, loss_d: 0.399064
0.7692 --- loss: 1.050399, loss_ss: 0.919033, loss_d: 0.131366
0.8077 --- loss: 0.940100, loss_ss: 0.678742, loss_d: 0.261358
0.8462 --- loss: 1.363034, loss_ss: 0.789062, loss_d: 0.573972
0.8846 --- loss: 0.880902, loss_ss: 0.628063, loss_d: 0.252839
0.9231 --- loss: 1.154240, loss_ss: 1.010796, loss_d: 0.143444
0.9615 --- loss: 0.900372, loss_ss: 0.752629, loss_d: 0.147743
Epoch finished! Loss: 1.1654271271698262
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6464912280701754
             precision    recall  f1-score   support

        0.0       0.22      0.85      0.35        67
        1.0       0.69      0.14      0.23       281
        2.0       0.83      0.74      0.79       335
        3.0       0.99      0.82      0.90       264
        4.0       0.58      0.92      0.71       193

avg / total       0.76      0.65      0.63      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  81.14  85.07   80.89  21.76     34.65
1  77.19  13.52   98.02  69.09     22.62
2  88.07  74.33   93.79  83.28     78.55
3  95.61  81.82   99.77  99.08     89.63
4  87.28  91.71   86.38  57.84     70.94
Total accuracy: 64.65%
Average sen: 69.29%
Average spec: 91.77%
Macro f1-score: 59.28%
[0.67764288 0.12343635 0.1262143  0.21648647 0.38485721 0.29807109
 0.85650498 0.62938935 0.71757573 0.65820283 0.93088025 0.99338937
 0.58680403 0.56826699 0.25598186 0.23105375 0.80084884 0.82751995
 0.98824114 0.86017668 0.59020245 0.40098378 0.90510643 0.94292587
 0.94471234 0.97942811 0.46467799 0.15017328 0.37096712 0.6937052
 0.66713274 0.30960003 0.37329829 0.50957561 0.82443762 0.93581092
 0.92742079 0.50784016]
pred: 0.6113037566997503, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.293886, loss_ss: 1.574955, loss_d: 0.718932
0.0385 --- loss: 2.208332, loss_ss: 1.476736, loss_d: 0.731596
0.0770 --- loss: 2.094548, loss_ss: 1.486700, loss_d: 0.607848
0.1156 --- loss: 2.026534, loss_ss: 1.364447, loss_d: 0.662087
0.1541 --- loss: 1.876911, loss_ss: 1.274194, loss_d: 0.602718
0.1926 --- loss: 2.264644, loss_ss: 1.391540, loss_d: 0.873104
0.2311 --- loss: 2.315194, loss_ss: 1.504618, loss_d: 0.810577
0.2696 --- loss: 1.942727, loss_ss: 1.365011, loss_d: 0.577715
0.3082 --- loss: 1.609608, loss_ss: 1.209971, loss_d: 0.399637
0.3467 --- loss: 2.081634, loss_ss: 1.352865, loss_d: 0.728769
0.3852 --- loss: 1.701506, loss_ss: 1.077683, loss_d: 0.623823
0.4237 --- loss: 1.689069, loss_ss: 1.185153, loss_d: 0.503916
0.4622 --- loss: 1.805026, loss_ss: 1.144972, loss_d: 0.660054
0.5008 --- loss: 1.781753, loss_ss: 1.256150, loss_d: 0.525603
0.5393 --- loss: 1.829544, loss_ss: 1.091694, loss_d: 0.737850
0.5778 --- loss: 1.873331, loss_ss: 1.292927, loss_d: 0.580404
0.6163 --- loss: 1.775633, loss_ss: 1.340528, loss_d: 0.435105
0.6549 --- loss: 2.219737, loss_ss: 1.290634, loss_d: 0.929102
0.6934 --- loss: 1.912929, loss_ss: 1.289673, loss_d: 0.623256
0.7319 --- loss: 1.638207, loss_ss: 1.193607, loss_d: 0.444600
0.7704 --- loss: 1.757495, loss_ss: 1.245700, loss_d: 0.511796
0.8089 --- loss: 1.619164, loss_ss: 1.045221, loss_d: 0.573943
0.8475 --- loss: 1.874657, loss_ss: 1.218398, loss_d: 0.656258
0.8860 --- loss: 1.544735, loss_ss: 1.101194, loss_d: 0.443541
0.9245 --- loss: 1.581619, loss_ss: 1.078956, loss_d: 0.502662
0.9630 --- loss: 1.485790, loss_ss: 1.092902, loss_d: 0.392888
Epoch finished! Loss: 1.8611868440414487
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.638705, loss_ss: 1.079584, loss_d: 0.559121
0.0385 --- loss: 1.591102, loss_ss: 1.070958, loss_d: 0.520143
0.0770 --- loss: 1.760177, loss_ss: 1.014737, loss_d: 0.745440
0.1156 --- loss: 1.699697, loss_ss: 1.192606, loss_d: 0.507091
0.1541 --- loss: 1.469588, loss_ss: 1.112396, loss_d: 0.357192
0.1926 --- loss: 1.955930, loss_ss: 0.974608, loss_d: 0.981322
0.2311 --- loss: 1.474059, loss_ss: 0.993918, loss_d: 0.480141
0.2696 --- loss: 1.679287, loss_ss: 1.230209, loss_d: 0.449079
0.3082 --- loss: 1.531043, loss_ss: 1.131258, loss_d: 0.399785
0.3467 --- loss: 1.945668, loss_ss: 1.179025, loss_d: 0.766643
0.3852 --- loss: 1.737447, loss_ss: 1.210581, loss_d: 0.526865
0.4237 --- loss: 1.604532, loss_ss: 0.917196, loss_d: 0.687337
0.4622 --- loss: 2.122038, loss_ss: 1.303474, loss_d: 0.818564
0.5008 --- loss: 1.549413, loss_ss: 1.019209, loss_d: 0.530204
0.5393 --- loss: 1.615527, loss_ss: 1.103469, loss_d: 0.512058
0.5778 --- loss: 1.496412, loss_ss: 0.953296, loss_d: 0.543116
0.6163 --- loss: 1.779508, loss_ss: 1.216690, loss_d: 0.562818
0.6549 --- loss: 1.202617, loss_ss: 0.846449, loss_d: 0.356168
0.6934 --- loss: 1.889507, loss_ss: 0.915197, loss_d: 0.974310
0.7319 --- loss: 1.801616, loss_ss: 1.136987, loss_d: 0.664630
0.7704 --- loss: 1.325128, loss_ss: 0.844679, loss_d: 0.480449
0.8089 --- loss: 2.056350, loss_ss: 1.207567, loss_d: 0.848784
0.8475 --- loss: 1.839656, loss_ss: 1.270139, loss_d: 0.569517
0.8860 --- loss: 1.801780, loss_ss: 1.308581, loss_d: 0.493199
0.9245 --- loss: 1.275432, loss_ss: 0.877519, loss_d: 0.397914
0.9630 --- loss: 1.772182, loss_ss: 0.936086, loss_d: 0.836096
Epoch finished! Loss: 1.6595349611002506
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.536495, loss_ss: 0.897943, loss_d: 0.638552
0.0385 --- loss: 1.549484, loss_ss: 0.980309, loss_d: 0.569174
0.0770 --- loss: 1.943464, loss_ss: 1.356582, loss_d: 0.586882
0.1156 --- loss: 1.958195, loss_ss: 1.470642, loss_d: 0.487553
0.1541 --- loss: 1.252687, loss_ss: 0.822943, loss_d: 0.429744
0.1926 --- loss: 1.419751, loss_ss: 1.056374, loss_d: 0.363377
0.2311 --- loss: 1.610317, loss_ss: 1.120203, loss_d: 0.490114
0.2696 --- loss: 1.878766, loss_ss: 0.950800, loss_d: 0.927966
0.3082 --- loss: 1.728464, loss_ss: 1.105460, loss_d: 0.623004
0.3467 --- loss: 1.685645, loss_ss: 0.997049, loss_d: 0.688596
0.3852 --- loss: 1.775572, loss_ss: 0.787742, loss_d: 0.987830
0.4237 --- loss: 1.586749, loss_ss: 0.941040, loss_d: 0.645709
0.4622 --- loss: 1.792192, loss_ss: 1.203427, loss_d: 0.588765
0.5008 --- loss: 1.417523, loss_ss: 1.008786, loss_d: 0.408737
0.5393 --- loss: 1.713335, loss_ss: 1.092591, loss_d: 0.620744
0.5778 --- loss: 1.687962, loss_ss: 1.181794, loss_d: 0.506167
0.6163 --- loss: 1.812109, loss_ss: 1.036293, loss_d: 0.775816
0.6549 --- loss: 1.384531, loss_ss: 0.829529, loss_d: 0.555002
0.6934 --- loss: 1.257710, loss_ss: 0.929729, loss_d: 0.327981
0.7319 --- loss: 1.362678, loss_ss: 0.913240, loss_d: 0.449438
0.7704 --- loss: 1.495678, loss_ss: 0.861721, loss_d: 0.633956
0.8089 --- loss: 1.490878, loss_ss: 0.935994, loss_d: 0.554885
0.8475 --- loss: 1.577319, loss_ss: 1.027062, loss_d: 0.550258
0.8860 --- loss: 1.227855, loss_ss: 0.898661, loss_d: 0.329194
0.9245 --- loss: 1.431289, loss_ss: 0.786968, loss_d: 0.644321
0.9630 --- loss: 1.584221, loss_ss: 1.081734, loss_d: 0.502487
Epoch finished! Loss: 1.5591282283017074
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.659015, loss_ss: 1.085230, loss_d: 0.573785
0.0385 --- loss: 1.627059, loss_ss: 1.283811, loss_d: 0.343248
0.0770 --- loss: 1.370193, loss_ss: 1.061487, loss_d: 0.308706
0.1156 --- loss: 1.442151, loss_ss: 1.086207, loss_d: 0.355944
0.1541 --- loss: 1.218138, loss_ss: 0.629725, loss_d: 0.588414
0.1926 --- loss: 1.753118, loss_ss: 0.995156, loss_d: 0.757962
0.2311 --- loss: 1.483235, loss_ss: 0.908740, loss_d: 0.574495
0.2696 --- loss: 1.437391, loss_ss: 0.892381, loss_d: 0.545010
0.3082 --- loss: 1.420830, loss_ss: 0.946271, loss_d: 0.474558
0.3467 --- loss: 1.160707, loss_ss: 0.917394, loss_d: 0.243313
0.3852 --- loss: 1.958930, loss_ss: 0.812483, loss_d: 1.146446
0.4237 --- loss: 1.495412, loss_ss: 1.048215, loss_d: 0.447197
0.4622 --- loss: 1.312592, loss_ss: 0.909168, loss_d: 0.403424
0.5008 --- loss: 2.118584, loss_ss: 1.751502, loss_d: 0.367082
0.5393 --- loss: 1.436500, loss_ss: 0.787589, loss_d: 0.648910
0.5778 --- loss: 1.423197, loss_ss: 1.003034, loss_d: 0.420163
0.6163 --- loss: 1.419263, loss_ss: 0.852676, loss_d: 0.566587
0.6549 --- loss: 1.524400, loss_ss: 0.821171, loss_d: 0.703228
0.6934 --- loss: 1.370261, loss_ss: 1.019380, loss_d: 0.350881
0.7319 --- loss: 1.437779, loss_ss: 0.988638, loss_d: 0.449141
0.7704 --- loss: 1.617513, loss_ss: 0.886739, loss_d: 0.730774
0.8089 --- loss: 1.423877, loss_ss: 0.841972, loss_d: 0.581906
0.8475 --- loss: 1.244795, loss_ss: 0.905387, loss_d: 0.339408
0.8860 --- loss: 1.607384, loss_ss: 1.245797, loss_d: 0.361587
0.9245 --- loss: 1.804785, loss_ss: 1.312008, loss_d: 0.492777
0.9630 --- loss: 1.275703, loss_ss: 0.800645, loss_d: 0.475058
Epoch finished! Loss: 1.4911032383506362
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.349401, loss_ss: 1.069674, loss_d: 0.279726
0.0385 --- loss: 1.159372, loss_ss: 0.881487, loss_d: 0.277885
0.0770 --- loss: 1.755838, loss_ss: 1.229631, loss_d: 0.526207
0.1156 --- loss: 1.294586, loss_ss: 0.812883, loss_d: 0.481703
0.1541 --- loss: 1.434461, loss_ss: 0.971527, loss_d: 0.462934
0.1926 --- loss: 1.368296, loss_ss: 1.048048, loss_d: 0.320249
0.2311 --- loss: 2.026562, loss_ss: 1.013492, loss_d: 1.013070
0.2696 --- loss: 1.526839, loss_ss: 0.958460, loss_d: 0.568379
0.3082 --- loss: 1.514471, loss_ss: 0.695958, loss_d: 0.818513
0.3467 --- loss: 1.689762, loss_ss: 1.195817, loss_d: 0.493945
0.3852 --- loss: 1.871099, loss_ss: 1.197522, loss_d: 0.673577
0.4237 --- loss: 1.257650, loss_ss: 0.959596, loss_d: 0.298054
0.4622 --- loss: 1.634543, loss_ss: 1.072757, loss_d: 0.561785
0.5008 --- loss: 1.549723, loss_ss: 0.894551, loss_d: 0.655172
0.5393 --- loss: 1.190114, loss_ss: 0.934790, loss_d: 0.255324
0.5778 --- loss: 1.380626, loss_ss: 0.780702, loss_d: 0.599923
0.6163 --- loss: 1.357895, loss_ss: 0.915393, loss_d: 0.442502
0.6549 --- loss: 0.960999, loss_ss: 0.668166, loss_d: 0.292834
0.6934 --- loss: 0.974572, loss_ss: 0.739466, loss_d: 0.235106
0.7319 --- loss: 1.380711, loss_ss: 0.931908, loss_d: 0.448803
0.7704 --- loss: 1.473941, loss_ss: 0.856084, loss_d: 0.617856
0.8089 --- loss: 1.753523, loss_ss: 1.244310, loss_d: 0.509213
0.8475 --- loss: 1.638185, loss_ss: 1.186658, loss_d: 0.451526
0.8860 --- loss: 1.782414, loss_ss: 0.911577, loss_d: 0.870837
0.9245 --- loss: 1.398103, loss_ss: 1.073892, loss_d: 0.324211
0.9630 --- loss: 0.935865, loss_ss: 0.666403, loss_d: 0.269462
Epoch finished! Loss: 1.39947786639556
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.928881, loss_ss: 0.490441, loss_d: 0.438440
0.0385 --- loss: 1.582510, loss_ss: 1.135055, loss_d: 0.447455
0.0770 --- loss: 1.485393, loss_ss: 0.789273, loss_d: 0.696120
0.1156 --- loss: 1.225077, loss_ss: 0.732214, loss_d: 0.492864
0.1541 --- loss: 1.413021, loss_ss: 0.848512, loss_d: 0.564509
0.1926 --- loss: 1.281776, loss_ss: 0.643555, loss_d: 0.638221
0.2311 --- loss: 1.139519, loss_ss: 0.774931, loss_d: 0.364588
0.2696 --- loss: 0.975123, loss_ss: 0.809057, loss_d: 0.166066
0.3082 --- loss: 1.604539, loss_ss: 1.049369, loss_d: 0.555170
0.3467 --- loss: 1.093369, loss_ss: 0.732507, loss_d: 0.360862
0.3852 --- loss: 1.358071, loss_ss: 0.724854, loss_d: 0.633217
0.4237 --- loss: 1.591829, loss_ss: 1.088274, loss_d: 0.503555
0.4622 --- loss: 1.348259, loss_ss: 1.175273, loss_d: 0.172986
0.5008 --- loss: 1.055496, loss_ss: 0.529901, loss_d: 0.525595
0.5393 --- loss: 1.219016, loss_ss: 0.821536, loss_d: 0.397479
0.5778 --- loss: 1.452618, loss_ss: 0.746030, loss_d: 0.706587
0.6163 --- loss: 1.156008, loss_ss: 0.984443, loss_d: 0.171565
0.6549 --- loss: 1.374282, loss_ss: 1.078469, loss_d: 0.295813
0.6934 --- loss: 1.652790, loss_ss: 1.238309, loss_d: 0.414480
0.7319 --- loss: 1.181884, loss_ss: 0.703737, loss_d: 0.478148
0.7704 --- loss: 1.484424, loss_ss: 1.011794, loss_d: 0.472630
0.8089 --- loss: 1.248576, loss_ss: 0.850404, loss_d: 0.398171
0.8475 --- loss: 1.530968, loss_ss: 1.026369, loss_d: 0.504599
0.8860 --- loss: 1.571500, loss_ss: 0.936503, loss_d: 0.634997
0.9245 --- loss: 1.111918, loss_ss: 0.702985, loss_d: 0.408933
0.9630 --- loss: 1.659563, loss_ss: 1.162594, loss_d: 0.496969
Epoch finished! Loss: 1.3250595450861573
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.840889, loss_ss: 0.616531, loss_d: 0.224358
0.0385 --- loss: 1.091991, loss_ss: 0.896428, loss_d: 0.195564
0.0770 --- loss: 1.156668, loss_ss: 0.774758, loss_d: 0.381910
0.1156 --- loss: 0.872617, loss_ss: 0.731819, loss_d: 0.140798
0.1541 --- loss: 2.366386, loss_ss: 1.561146, loss_d: 0.805240
0.1926 --- loss: 1.056109, loss_ss: 0.808460, loss_d: 0.247649
0.2311 --- loss: 1.587058, loss_ss: 0.777287, loss_d: 0.809772
0.2696 --- loss: 1.236563, loss_ss: 0.717576, loss_d: 0.518988
0.3082 --- loss: 1.302821, loss_ss: 0.928878, loss_d: 0.373943
0.3467 --- loss: 1.088711, loss_ss: 0.872164, loss_d: 0.216547
0.3852 --- loss: 1.238300, loss_ss: 0.884754, loss_d: 0.353545
0.4237 --- loss: 1.501002, loss_ss: 1.079608, loss_d: 0.421394
0.4622 --- loss: 1.074375, loss_ss: 0.754772, loss_d: 0.319603
0.5008 --- loss: 1.171476, loss_ss: 0.798385, loss_d: 0.373092
0.5393 --- loss: 1.108800, loss_ss: 0.780976, loss_d: 0.327823
0.5778 --- loss: 1.195855, loss_ss: 0.959758, loss_d: 0.236096
0.6163 --- loss: 0.868342, loss_ss: 0.626686, loss_d: 0.241656
0.6549 --- loss: 1.080351, loss_ss: 0.846892, loss_d: 0.233459
0.6934 --- loss: 1.010614, loss_ss: 0.869131, loss_d: 0.141483
0.7319 --- loss: 1.457707, loss_ss: 1.160680, loss_d: 0.297027
0.7704 --- loss: 1.522202, loss_ss: 1.176350, loss_d: 0.345852
0.8089 --- loss: 0.982493, loss_ss: 0.803456, loss_d: 0.179037
0.8475 --- loss: 1.374849, loss_ss: 0.984389, loss_d: 0.390460
0.8860 --- loss: 1.009018, loss_ss: 0.820959, loss_d: 0.188060
0.9245 --- loss: 1.198357, loss_ss: 0.865083, loss_d: 0.333274
0.9630 --- loss: 1.564881, loss_ss: 1.046988, loss_d: 0.517893
Epoch finished! Loss: 1.2725383655444995
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.000443, loss_ss: 0.523057, loss_d: 0.477386
0.0385 --- loss: 1.046657, loss_ss: 0.778740, loss_d: 0.267917
0.0770 --- loss: 1.218778, loss_ss: 0.764413, loss_d: 0.454365
0.1156 --- loss: 1.446234, loss_ss: 1.175335, loss_d: 0.270899
0.1541 --- loss: 1.090433, loss_ss: 0.813959, loss_d: 0.276475
0.1926 --- loss: 1.059292, loss_ss: 0.679327, loss_d: 0.379966
0.2311 --- loss: 1.136594, loss_ss: 0.839303, loss_d: 0.297291
0.2696 --- loss: 0.855344, loss_ss: 0.750551, loss_d: 0.104794
0.3082 --- loss: 0.949052, loss_ss: 0.800346, loss_d: 0.148706
0.3467 --- loss: 2.168607, loss_ss: 1.722454, loss_d: 0.446153
0.3852 --- loss: 1.630962, loss_ss: 1.097487, loss_d: 0.533475
0.4237 --- loss: 0.972387, loss_ss: 0.677908, loss_d: 0.294479
0.4622 --- loss: 0.874153, loss_ss: 0.734671, loss_d: 0.139481
0.5008 --- loss: 1.319616, loss_ss: 0.962433, loss_d: 0.357183
0.5393 --- loss: 1.021955, loss_ss: 0.850271, loss_d: 0.171684
0.5778 --- loss: 1.083132, loss_ss: 0.970666, loss_d: 0.112466
0.6163 --- loss: 1.178897, loss_ss: 0.732372, loss_d: 0.446525
0.6549 --- loss: 1.477293, loss_ss: 0.803682, loss_d: 0.673611
0.6934 --- loss: 1.109945, loss_ss: 0.689968, loss_d: 0.419976
0.7319 --- loss: 1.050193, loss_ss: 0.846171, loss_d: 0.204022
0.7704 --- loss: 0.940153, loss_ss: 0.728059, loss_d: 0.212095
0.8089 --- loss: 1.240823, loss_ss: 0.792425, loss_d: 0.448398
0.8475 --- loss: 1.221086, loss_ss: 0.880611, loss_d: 0.340475
0.8860 --- loss: 0.961989, loss_ss: 0.710776, loss_d: 0.251213
0.9245 --- loss: 1.547992, loss_ss: 0.711501, loss_d: 0.836491
0.9630 --- loss: 1.141766, loss_ss: 0.868879, loss_d: 0.272887
Epoch finished! Loss: 1.1859600606111946
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.267789, loss_ss: 1.069930, loss_d: 0.197859
0.0385 --- loss: 1.062844, loss_ss: 0.858093, loss_d: 0.204751
0.0770 --- loss: 0.648488, loss_ss: 0.558185, loss_d: 0.090304
0.1156 --- loss: 1.126406, loss_ss: 1.020828, loss_d: 0.105578
0.1541 --- loss: 3.340200, loss_ss: 0.826694, loss_d: 2.513506
0.1926 --- loss: 1.417525, loss_ss: 1.068691, loss_d: 0.348833
0.2311 --- loss: 1.278455, loss_ss: 0.815062, loss_d: 0.463392
0.2696 --- loss: 0.899032, loss_ss: 0.680787, loss_d: 0.218245
0.3082 --- loss: 0.879344, loss_ss: 0.750805, loss_d: 0.128539
0.3467 --- loss: 0.895132, loss_ss: 0.779777, loss_d: 0.115355
0.3852 --- loss: 0.927483, loss_ss: 0.843361, loss_d: 0.084123
0.4237 --- loss: 1.409251, loss_ss: 1.200577, loss_d: 0.208674
0.4622 --- loss: 1.776758, loss_ss: 0.850971, loss_d: 0.925787
0.5008 --- loss: 0.932643, loss_ss: 0.852265, loss_d: 0.080378
0.5393 --- loss: 1.030991, loss_ss: 0.885042, loss_d: 0.145950
0.5778 --- loss: 1.007561, loss_ss: 0.810655, loss_d: 0.196906
0.6163 --- loss: 1.690678, loss_ss: 0.901956, loss_d: 0.788722
0.6549 --- loss: 1.706209, loss_ss: 1.153989, loss_d: 0.552220
0.6934 --- loss: 0.795293, loss_ss: 0.661096, loss_d: 0.134196
0.7319 --- loss: 1.092357, loss_ss: 0.840587, loss_d: 0.251770
0.7704 --- loss: 1.033909, loss_ss: 0.943291, loss_d: 0.090618
0.8089 --- loss: 1.155060, loss_ss: 1.024359, loss_d: 0.130702
0.8475 --- loss: 0.827712, loss_ss: 0.695094, loss_d: 0.132619
0.8860 --- loss: 0.943957, loss_ss: 0.785318, loss_d: 0.158639
0.9245 --- loss: 1.052524, loss_ss: 0.882104, loss_d: 0.170420
0.9630 --- loss: 1.271684, loss_ss: 0.983315, loss_d: 0.288368
Epoch finished! Loss: 1.162947093197738
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.861051, loss_ss: 0.733763, loss_d: 0.127289
0.0385 --- loss: 1.007931, loss_ss: 0.903522, loss_d: 0.104410
0.0770 --- loss: 0.973301, loss_ss: 0.816173, loss_d: 0.157129
0.1156 --- loss: 1.183071, loss_ss: 1.086397, loss_d: 0.096674
0.1541 --- loss: 0.942199, loss_ss: 0.811517, loss_d: 0.130682
0.1926 --- loss: 1.017986, loss_ss: 0.794290, loss_d: 0.223696
0.2311 --- loss: 0.806205, loss_ss: 0.546187, loss_d: 0.260017
0.2696 --- loss: 0.676839, loss_ss: 0.454952, loss_d: 0.221887
0.3082 --- loss: 1.101492, loss_ss: 0.779645, loss_d: 0.321847
0.3467 --- loss: 0.932476, loss_ss: 0.742888, loss_d: 0.189588
0.3852 --- loss: 1.629058, loss_ss: 0.791321, loss_d: 0.837737
0.4237 --- loss: 0.917605, loss_ss: 0.542462, loss_d: 0.375143
0.4622 --- loss: 0.860285, loss_ss: 0.597042, loss_d: 0.263243
0.5008 --- loss: 1.196398, loss_ss: 0.923391, loss_d: 0.273007
0.5393 --- loss: 1.035693, loss_ss: 0.930392, loss_d: 0.105301
0.5778 --- loss: 0.956927, loss_ss: 0.732457, loss_d: 0.224470
0.6163 --- loss: 0.837020, loss_ss: 0.529087, loss_d: 0.307933
0.6549 --- loss: 1.287782, loss_ss: 0.979843, loss_d: 0.307940
0.6934 --- loss: 0.865877, loss_ss: 0.727550, loss_d: 0.138327
0.7319 --- loss: 1.801944, loss_ss: 0.855237, loss_d: 0.946707
0.7704 --- loss: 0.944413, loss_ss: 0.812266, loss_d: 0.132147
0.8089 --- loss: 1.546492, loss_ss: 0.936964, loss_d: 0.609528
0.8475 --- loss: 1.404251, loss_ss: 0.853925, loss_d: 0.550326
0.8860 --- loss: 1.284193, loss_ss: 0.821735, loss_d: 0.462458
0.9245 --- loss: 0.996564, loss_ss: 0.755397, loss_d: 0.241167
0.9630 --- loss: 0.762088, loss_ss: 0.683571, loss_d: 0.078517
Epoch finished! Loss: 1.1089485810069963
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6801587301587302
             precision    recall  f1-score   support

        0.0       0.71      0.94      0.81       297
        1.0       0.74      0.20      0.31       289
        2.0       0.56      0.80      0.66       330
        3.0       0.69      0.98      0.81       133
        4.0       0.98      0.60      0.74       211

avg / total       0.72      0.68      0.64      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.68  93.94   88.37  71.36     81.10
1  80.00  19.72   97.94  74.03     31.15
2  78.10  80.00   77.42  55.70     65.67
3  95.16  98.50   94.76  68.95     81.11
4  93.10  59.72   99.81  98.44     74.34
Total accuracy: 68.02%
Average sen: 70.37%
Average spec: 91.66%
Macro f1-score: 66.67%
[0.78111619 0.70100754 0.96396142 0.98825663 0.97681183 0.9949162
 0.99164259 0.99540663 0.98827469 0.99653143 0.9606905  0.99210781
 0.97269475 0.99735886 0.98308945 0.98049104 0.98279184 0.98352295
 0.97776824 0.99460924 0.98774105 0.97422749 0.97743702 0.98567563
 0.99138218 0.99951446 0.98904699 0.99709582 0.99747181 0.99377728
 0.99766195 0.98287189 0.99218881 0.98187721 0.95913446 0.99581224
 0.99683088 0.93298995 0.99088913 0.8862409  0.99224299 0.99510336]
pred: 0.9714348415533701, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.377334, loss_ss: 1.646081, loss_d: 0.731253
0.0384 --- loss: 1.997695, loss_ss: 1.512198, loss_d: 0.485497
0.0768 --- loss: 2.242314, loss_ss: 1.573629, loss_d: 0.668685
0.1152 --- loss: 2.067792, loss_ss: 1.442549, loss_d: 0.625243
0.1536 --- loss: 1.954854, loss_ss: 1.482763, loss_d: 0.472091
0.1919 --- loss: 2.255152, loss_ss: 1.397299, loss_d: 0.857853
0.2303 --- loss: 1.847903, loss_ss: 1.370985, loss_d: 0.476918
0.2687 --- loss: 2.099224, loss_ss: 1.399155, loss_d: 0.700068
0.3071 --- loss: 1.937528, loss_ss: 1.418579, loss_d: 0.518949
0.3455 --- loss: 1.740090, loss_ss: 1.303017, loss_d: 0.437073
0.3839 --- loss: 1.941750, loss_ss: 1.421330, loss_d: 0.520419
0.4223 --- loss: 2.143905, loss_ss: 1.269916, loss_d: 0.873989
0.4607 --- loss: 1.859515, loss_ss: 1.305954, loss_d: 0.553561
0.4990 --- loss: 1.660254, loss_ss: 1.165905, loss_d: 0.494349
0.5374 --- loss: 1.901237, loss_ss: 1.200720, loss_d: 0.700518
0.5758 --- loss: 1.864923, loss_ss: 1.455065, loss_d: 0.409858
0.6142 --- loss: 1.578886, loss_ss: 1.313882, loss_d: 0.265004
0.6526 --- loss: 1.926855, loss_ss: 1.356663, loss_d: 0.570192
0.6910 --- loss: 1.963179, loss_ss: 1.419083, loss_d: 0.544095
0.7294 --- loss: 1.975692, loss_ss: 1.340709, loss_d: 0.634983
0.7678 --- loss: 1.823536, loss_ss: 1.203680, loss_d: 0.619856
0.8061 --- loss: 1.900516, loss_ss: 1.290769, loss_d: 0.609747
0.8445 --- loss: 1.912525, loss_ss: 1.041229, loss_d: 0.871296
0.8829 --- loss: 1.892424, loss_ss: 1.466706, loss_d: 0.425718
0.9213 --- loss: 1.781407, loss_ss: 1.253618, loss_d: 0.527789
0.9597 --- loss: 1.620143, loss_ss: 1.173283, loss_d: 0.446860
0.9981 --- loss: 1.823652, loss_ss: 1.349042, loss_d: 0.474610
Epoch finished! Loss: 1.9266236717884357
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.081950, loss_ss: 1.249935, loss_d: 0.832015
0.0384 --- loss: 1.630982, loss_ss: 1.131075, loss_d: 0.499907
0.0768 --- loss: 1.643938, loss_ss: 1.135699, loss_d: 0.508238
0.1152 --- loss: 1.601541, loss_ss: 1.050858, loss_d: 0.550683
0.1536 --- loss: 1.844023, loss_ss: 1.032197, loss_d: 0.811827
0.1919 --- loss: 1.581567, loss_ss: 1.138155, loss_d: 0.443412
0.2303 --- loss: 1.388018, loss_ss: 1.024126, loss_d: 0.363892
0.2687 --- loss: 1.566772, loss_ss: 1.194424, loss_d: 0.372347
0.3071 --- loss: 1.333971, loss_ss: 0.926081, loss_d: 0.407890
0.3455 --- loss: 1.621031, loss_ss: 1.214687, loss_d: 0.406344
0.3839 --- loss: 1.662681, loss_ss: 1.050525, loss_d: 0.612156
0.4223 --- loss: 1.627688, loss_ss: 1.078341, loss_d: 0.549347
0.4607 --- loss: 1.758033, loss_ss: 1.190412, loss_d: 0.567621
0.4990 --- loss: 1.889011, loss_ss: 1.241704, loss_d: 0.647306
0.5374 --- loss: 1.254971, loss_ss: 0.826236, loss_d: 0.428735
0.5758 --- loss: 1.452657, loss_ss: 0.886710, loss_d: 0.565947
0.6142 --- loss: 1.448801, loss_ss: 0.984325, loss_d: 0.464476
0.6526 --- loss: 1.642474, loss_ss: 0.980255, loss_d: 0.662218
0.6910 --- loss: 1.673268, loss_ss: 1.384382, loss_d: 0.288886
0.7294 --- loss: 1.449950, loss_ss: 0.968327, loss_d: 0.481623
0.7678 --- loss: 1.474787, loss_ss: 0.912126, loss_d: 0.562660
0.8061 --- loss: 1.665487, loss_ss: 1.087008, loss_d: 0.578479
0.8445 --- loss: 1.829014, loss_ss: 1.307734, loss_d: 0.521280
0.8829 --- loss: 2.047534, loss_ss: 0.987501, loss_d: 1.060034
0.9213 --- loss: 1.476722, loss_ss: 1.000174, loss_d: 0.476548
0.9597 --- loss: 2.034163, loss_ss: 1.341198, loss_d: 0.692965
0.9981 --- loss: 1.811094, loss_ss: 1.179131, loss_d: 0.631964
Epoch finished! Loss: 1.639737830712245
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.550835, loss_ss: 1.076425, loss_d: 0.474409
0.0384 --- loss: 1.581582, loss_ss: 1.002103, loss_d: 0.579479
0.0768 --- loss: 1.219409, loss_ss: 0.870700, loss_d: 0.348709
0.1152 --- loss: 1.943207, loss_ss: 1.391846, loss_d: 0.551361
0.1536 --- loss: 1.682870, loss_ss: 1.063545, loss_d: 0.619325
0.1919 --- loss: 1.345220, loss_ss: 0.848165, loss_d: 0.497055
0.2303 --- loss: 1.226296, loss_ss: 0.748798, loss_d: 0.477498
0.2687 --- loss: 1.183176, loss_ss: 0.880727, loss_d: 0.302450
0.3071 --- loss: 1.603492, loss_ss: 1.028050, loss_d: 0.575442
0.3455 --- loss: 1.412882, loss_ss: 0.983044, loss_d: 0.429838
0.3839 --- loss: 1.563873, loss_ss: 1.040513, loss_d: 0.523360
0.4223 --- loss: 1.689107, loss_ss: 0.991110, loss_d: 0.697998
0.4607 --- loss: 1.640134, loss_ss: 1.097202, loss_d: 0.542933
0.4990 --- loss: 1.924410, loss_ss: 1.505723, loss_d: 0.418687
0.5374 --- loss: 1.478082, loss_ss: 0.819549, loss_d: 0.658534
0.5758 --- loss: 1.349080, loss_ss: 0.907144, loss_d: 0.441936
0.6142 --- loss: 1.307969, loss_ss: 0.737265, loss_d: 0.570704
0.6526 --- loss: 1.941044, loss_ss: 1.351743, loss_d: 0.589300
0.6910 --- loss: 1.683192, loss_ss: 1.020824, loss_d: 0.662368
0.7294 --- loss: 1.421275, loss_ss: 0.924835, loss_d: 0.496441
0.7678 --- loss: 1.348520, loss_ss: 1.044836, loss_d: 0.303684
0.8061 --- loss: 1.566033, loss_ss: 1.228961, loss_d: 0.337072
0.8445 --- loss: 1.162450, loss_ss: 0.801296, loss_d: 0.361154
0.8829 --- loss: 1.296144, loss_ss: 1.069885, loss_d: 0.226259
0.9213 --- loss: 1.499350, loss_ss: 0.883582, loss_d: 0.615767
0.9597 --- loss: 1.527295, loss_ss: 1.022847, loss_d: 0.504447
0.9981 --- loss: 1.608100, loss_ss: 1.438874, loss_d: 0.169226
Epoch finished! Loss: 1.5048063713770645
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.076581, loss_ss: 0.888616, loss_d: 0.187965
0.0384 --- loss: 1.330808, loss_ss: 0.769152, loss_d: 0.561656
0.0768 --- loss: 1.608810, loss_ss: 0.713734, loss_d: 0.895076
0.1152 --- loss: 2.042472, loss_ss: 1.078446, loss_d: 0.964026
0.1536 --- loss: 1.640971, loss_ss: 1.101874, loss_d: 0.539097
0.1919 --- loss: 1.731007, loss_ss: 1.070636, loss_d: 0.660371
0.2303 --- loss: 1.292212, loss_ss: 0.956968, loss_d: 0.335244
0.2687 --- loss: 1.409745, loss_ss: 1.121962, loss_d: 0.287783
0.3071 --- loss: 1.372585, loss_ss: 0.961850, loss_d: 0.410735
0.3455 --- loss: 1.064179, loss_ss: 0.839827, loss_d: 0.224352
0.3839 --- loss: 1.469801, loss_ss: 0.922537, loss_d: 0.547263
0.4223 --- loss: 1.230851, loss_ss: 0.722294, loss_d: 0.508557
0.4607 --- loss: 1.438004, loss_ss: 0.995569, loss_d: 0.442435
0.4990 --- loss: 2.047066, loss_ss: 0.894558, loss_d: 1.152508
0.5374 --- loss: 1.336214, loss_ss: 0.949488, loss_d: 0.386727
0.5758 --- loss: 1.323867, loss_ss: 0.936850, loss_d: 0.387017
0.6142 --- loss: 1.196400, loss_ss: 0.667494, loss_d: 0.528906
0.6526 --- loss: 1.259723, loss_ss: 0.840674, loss_d: 0.419048
0.6910 --- loss: 1.825176, loss_ss: 1.060707, loss_d: 0.764469
0.7294 --- loss: 1.093222, loss_ss: 0.781114, loss_d: 0.312108
0.7678 --- loss: 1.162367, loss_ss: 0.917528, loss_d: 0.244839
0.8061 --- loss: 1.384900, loss_ss: 1.143619, loss_d: 0.241281
0.8445 --- loss: 1.542300, loss_ss: 1.065918, loss_d: 0.476382
0.8829 --- loss: 1.723990, loss_ss: 1.131605, loss_d: 0.592385
0.9213 --- loss: 1.813894, loss_ss: 1.164131, loss_d: 0.649763
0.9597 --- loss: 1.482450, loss_ss: 0.794789, loss_d: 0.687661
0.9981 --- loss: 1.449655, loss_ss: 0.778167, loss_d: 0.671488
Epoch finished! Loss: 1.4502707488261737
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.769014, loss_ss: 1.394934, loss_d: 0.374080
0.0384 --- loss: 1.543066, loss_ss: 1.145170, loss_d: 0.397896
0.0768 --- loss: 0.901519, loss_ss: 0.699359, loss_d: 0.202160
0.1152 --- loss: 1.156969, loss_ss: 0.661970, loss_d: 0.494999
0.1536 --- loss: 1.272727, loss_ss: 0.879019, loss_d: 0.393708
0.1919 --- loss: 1.392302, loss_ss: 0.938710, loss_d: 0.453591
0.2303 --- loss: 1.290061, loss_ss: 0.831473, loss_d: 0.458587
0.2687 --- loss: 1.178733, loss_ss: 0.879123, loss_d: 0.299611
0.3071 --- loss: 1.803873, loss_ss: 1.166106, loss_d: 0.637768
0.3455 --- loss: 1.657454, loss_ss: 0.894012, loss_d: 0.763442
0.3839 --- loss: 1.286274, loss_ss: 0.771348, loss_d: 0.514927
0.4223 --- loss: 1.327099, loss_ss: 0.982459, loss_d: 0.344640
0.4607 --- loss: 1.377881, loss_ss: 1.045586, loss_d: 0.332294
0.4990 --- loss: 1.532639, loss_ss: 0.824020, loss_d: 0.708619
0.5374 --- loss: 1.508727, loss_ss: 1.199016, loss_d: 0.309711
0.5758 --- loss: 1.449758, loss_ss: 0.921120, loss_d: 0.528638
0.6142 --- loss: 1.521571, loss_ss: 0.987433, loss_d: 0.534138
0.6526 --- loss: 1.509796, loss_ss: 1.159367, loss_d: 0.350429
0.6910 --- loss: 1.448153, loss_ss: 1.018078, loss_d: 0.430075
0.7294 --- loss: 1.022293, loss_ss: 0.726692, loss_d: 0.295601
0.7678 --- loss: 0.992597, loss_ss: 0.803858, loss_d: 0.188739
0.8061 --- loss: 2.388224, loss_ss: 0.993687, loss_d: 1.394537
0.8445 --- loss: 1.298550, loss_ss: 0.818127, loss_d: 0.480422
0.8829 --- loss: 1.468485, loss_ss: 0.971686, loss_d: 0.496799
0.9213 --- loss: 1.301708, loss_ss: 1.011091, loss_d: 0.290616
0.9597 --- loss: 1.260908, loss_ss: 0.716405, loss_d: 0.544503
0.9981 --- loss: 1.440865, loss_ss: 1.084013, loss_d: 0.356852
Epoch finished! Loss: 1.3725983241429696
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.493834, loss_ss: 1.161642, loss_d: 0.332192
0.0384 --- loss: 1.320919, loss_ss: 0.853429, loss_d: 0.467490
0.0768 --- loss: 1.277640, loss_ss: 0.919015, loss_d: 0.358626
0.1152 --- loss: 1.538968, loss_ss: 0.982568, loss_d: 0.556400
0.1536 --- loss: 1.029083, loss_ss: 0.715102, loss_d: 0.313982
0.1919 --- loss: 1.179507, loss_ss: 0.751446, loss_d: 0.428062
0.2303 --- loss: 1.210689, loss_ss: 0.932746, loss_d: 0.277943
0.2687 --- loss: 1.093144, loss_ss: 0.676560, loss_d: 0.416584
0.3071 --- loss: 1.428571, loss_ss: 0.731565, loss_d: 0.697006
0.3455 --- loss: 1.193505, loss_ss: 0.808150, loss_d: 0.385355
0.3839 --- loss: 1.375785, loss_ss: 0.969896, loss_d: 0.405890
0.4223 --- loss: 1.065963, loss_ss: 0.710848, loss_d: 0.355116
0.4607 --- loss: 1.021977, loss_ss: 0.775879, loss_d: 0.246098
0.4990 --- loss: 0.987812, loss_ss: 0.658890, loss_d: 0.328922
0.5374 --- loss: 1.304910, loss_ss: 0.697711, loss_d: 0.607199
0.5758 --- loss: 1.719534, loss_ss: 0.979031, loss_d: 0.740503
0.6142 --- loss: 1.196321, loss_ss: 0.999739, loss_d: 0.196582
0.6526 --- loss: 1.335022, loss_ss: 0.877925, loss_d: 0.457096
0.6910 --- loss: 1.056008, loss_ss: 0.829439, loss_d: 0.226569
0.7294 --- loss: 1.135502, loss_ss: 0.905134, loss_d: 0.230368
0.7678 --- loss: 1.256610, loss_ss: 0.923982, loss_d: 0.332628
0.8061 --- loss: 0.919876, loss_ss: 0.724366, loss_d: 0.195510
0.8445 --- loss: 1.289474, loss_ss: 0.945137, loss_d: 0.344338
0.8829 --- loss: 1.422487, loss_ss: 1.105667, loss_d: 0.316820
0.9213 --- loss: 1.515338, loss_ss: 1.019546, loss_d: 0.495792
0.9597 --- loss: 1.110792, loss_ss: 0.779831, loss_d: 0.330961
0.9981 --- loss: 1.325370, loss_ss: 0.841311, loss_d: 0.484059
Epoch finished! Loss: 1.3100238481393227
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.080640, loss_ss: 0.800522, loss_d: 0.280119
0.0384 --- loss: 1.216917, loss_ss: 0.883238, loss_d: 0.333679
0.0768 --- loss: 1.190121, loss_ss: 0.950538, loss_d: 0.239582
0.1152 --- loss: 1.116650, loss_ss: 0.912147, loss_d: 0.204504
0.1536 --- loss: 1.657346, loss_ss: 0.969978, loss_d: 0.687369
0.1919 --- loss: 0.945572, loss_ss: 0.760685, loss_d: 0.184887
0.2303 --- loss: 1.356686, loss_ss: 0.895382, loss_d: 0.461304
0.2687 --- loss: 1.911895, loss_ss: 0.944232, loss_d: 0.967663
0.3071 --- loss: 1.393433, loss_ss: 0.665827, loss_d: 0.727606
0.3455 --- loss: 1.001592, loss_ss: 0.626010, loss_d: 0.375581
0.3839 --- loss: 1.238944, loss_ss: 0.914221, loss_d: 0.324723
0.4223 --- loss: 1.112158, loss_ss: 0.919190, loss_d: 0.192968
0.4607 --- loss: 1.819806, loss_ss: 0.787878, loss_d: 1.031927
0.4990 --- loss: 1.565530, loss_ss: 1.303530, loss_d: 0.262001
0.5374 --- loss: 1.282591, loss_ss: 0.982007, loss_d: 0.300584
0.5758 --- loss: 1.208997, loss_ss: 0.939045, loss_d: 0.269952
0.6142 --- loss: 1.074501, loss_ss: 0.747766, loss_d: 0.326735
0.6526 --- loss: 1.401944, loss_ss: 1.097261, loss_d: 0.304683
0.6910 --- loss: 1.306449, loss_ss: 0.879608, loss_d: 0.426841
0.7294 --- loss: 1.459494, loss_ss: 0.734424, loss_d: 0.725069
0.7678 --- loss: 1.126033, loss_ss: 0.843604, loss_d: 0.282429
0.8061 --- loss: 1.400228, loss_ss: 1.074947, loss_d: 0.325282
0.8445 --- loss: 1.543437, loss_ss: 0.783805, loss_d: 0.759632
0.8829 --- loss: 1.685436, loss_ss: 0.855810, loss_d: 0.829626
0.9213 --- loss: 1.249676, loss_ss: 0.833774, loss_d: 0.415902
0.9597 --- loss: 1.270254, loss_ss: 0.863139, loss_d: 0.407116
0.9981 --- loss: 1.031182, loss_ss: 0.632918, loss_d: 0.398264
Epoch finished! Loss: 1.2618056609080388
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.060548, loss_ss: 0.691373, loss_d: 0.369175
0.0384 --- loss: 1.290510, loss_ss: 0.779368, loss_d: 0.511142
0.0768 --- loss: 0.977629, loss_ss: 0.737361, loss_d: 0.240268
0.1152 --- loss: 1.023386, loss_ss: 0.899911, loss_d: 0.123474
0.1536 --- loss: 1.735802, loss_ss: 0.840625, loss_d: 0.895177
0.1919 --- loss: 1.536986, loss_ss: 0.855244, loss_d: 0.681742
0.2303 --- loss: 1.619410, loss_ss: 1.007500, loss_d: 0.611910
0.2687 --- loss: 1.214536, loss_ss: 0.723621, loss_d: 0.490914
0.3071 --- loss: 1.226785, loss_ss: 0.902849, loss_d: 0.323936
0.3455 --- loss: 0.944801, loss_ss: 0.679533, loss_d: 0.265268
0.3839 --- loss: 1.520483, loss_ss: 0.944020, loss_d: 0.576462
0.4223 --- loss: 1.146897, loss_ss: 0.671987, loss_d: 0.474911
0.4607 --- loss: 1.469938, loss_ss: 1.122877, loss_d: 0.347061
0.4990 --- loss: 0.956402, loss_ss: 0.723755, loss_d: 0.232647
0.5374 --- loss: 0.949136, loss_ss: 0.814163, loss_d: 0.134973
0.5758 --- loss: 1.397324, loss_ss: 0.887898, loss_d: 0.509426
0.6142 --- loss: 1.601685, loss_ss: 0.903483, loss_d: 0.698202
0.6526 --- loss: 1.696657, loss_ss: 1.265591, loss_d: 0.431066
0.6910 --- loss: 1.198278, loss_ss: 0.856947, loss_d: 0.341330
0.7294 --- loss: 1.801325, loss_ss: 0.836581, loss_d: 0.964744
0.7678 --- loss: 1.086206, loss_ss: 0.840942, loss_d: 0.245263
0.8061 --- loss: 1.240816, loss_ss: 0.975413, loss_d: 0.265404
0.8445 --- loss: 1.227573, loss_ss: 0.731484, loss_d: 0.496089
0.8829 --- loss: 1.072312, loss_ss: 0.804599, loss_d: 0.267713
0.9213 --- loss: 1.423518, loss_ss: 0.852970, loss_d: 0.570548
0.9597 --- loss: 1.266597, loss_ss: 0.948972, loss_d: 0.317625
0.9981 --- loss: 1.069718, loss_ss: 0.952827, loss_d: 0.116891
Epoch finished! Loss: 1.223442781659273
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.962495, loss_ss: 0.764290, loss_d: 0.198205
0.0384 --- loss: 0.819491, loss_ss: 0.625458, loss_d: 0.194033
0.0768 --- loss: 1.299955, loss_ss: 1.011362, loss_d: 0.288593
0.1152 --- loss: 1.807861, loss_ss: 1.312510, loss_d: 0.495352
0.1536 --- loss: 1.170975, loss_ss: 0.831777, loss_d: 0.339198
0.1919 --- loss: 1.164776, loss_ss: 0.799710, loss_d: 0.365066
0.2303 --- loss: 0.920808, loss_ss: 0.735911, loss_d: 0.184897
0.2687 --- loss: 1.072675, loss_ss: 0.810995, loss_d: 0.261680
0.3071 --- loss: 0.839160, loss_ss: 0.705426, loss_d: 0.133734
0.3455 --- loss: 0.882066, loss_ss: 0.615827, loss_d: 0.266238
0.3839 --- loss: 0.862535, loss_ss: 0.675352, loss_d: 0.187183
0.4223 --- loss: 1.068678, loss_ss: 0.789537, loss_d: 0.279141
0.4607 --- loss: 1.487030, loss_ss: 1.243918, loss_d: 0.243112
0.4990 --- loss: 1.324589, loss_ss: 0.830592, loss_d: 0.493997
0.5374 --- loss: 0.987460, loss_ss: 0.707924, loss_d: 0.279536
0.5758 --- loss: 1.254372, loss_ss: 0.987165, loss_d: 0.267206
0.6142 --- loss: 0.977914, loss_ss: 0.778950, loss_d: 0.198965
0.6526 --- loss: 1.485650, loss_ss: 0.678884, loss_d: 0.806766
0.6910 --- loss: 1.257360, loss_ss: 0.845254, loss_d: 0.412107
0.7294 --- loss: 0.887465, loss_ss: 0.759135, loss_d: 0.128330
0.7678 --- loss: 1.404796, loss_ss: 0.798499, loss_d: 0.606297
0.8061 --- loss: 0.982354, loss_ss: 0.717649, loss_d: 0.264705
0.8445 --- loss: 1.877719, loss_ss: 1.651120, loss_d: 0.226599
0.8829 --- loss: 0.864565, loss_ss: 0.780612, loss_d: 0.083953
0.9213 --- loss: 1.182659, loss_ss: 0.759359, loss_d: 0.423301
0.9597 --- loss: 1.079635, loss_ss: 0.855563, loss_d: 0.224072
0.9981 --- loss: 1.649488, loss_ss: 1.187015, loss_d: 0.462473
Epoch finished! Loss: 1.180030897947458
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.835480, loss_ss: 0.704255, loss_d: 0.131225
0.0384 --- loss: 1.375393, loss_ss: 1.149654, loss_d: 0.225739
0.0768 --- loss: 0.796013, loss_ss: 0.665719, loss_d: 0.130294
0.1152 --- loss: 1.334705, loss_ss: 0.632239, loss_d: 0.702466
0.1536 --- loss: 2.189890, loss_ss: 1.341955, loss_d: 0.847935
0.1919 --- loss: 1.182910, loss_ss: 0.786651, loss_d: 0.396259
0.2303 --- loss: 1.179444, loss_ss: 0.765555, loss_d: 0.413889
0.2687 --- loss: 1.144977, loss_ss: 0.942099, loss_d: 0.202879
0.3071 --- loss: 0.997211, loss_ss: 0.686491, loss_d: 0.310719
0.3455 --- loss: 1.127466, loss_ss: 0.769132, loss_d: 0.358334
0.3839 --- loss: 1.171694, loss_ss: 0.820294, loss_d: 0.351400
0.4223 --- loss: 0.812189, loss_ss: 0.677616, loss_d: 0.134573
0.4607 --- loss: 1.250920, loss_ss: 0.936414, loss_d: 0.314506
0.4990 --- loss: 1.372609, loss_ss: 1.015437, loss_d: 0.357173
0.5374 --- loss: 0.838251, loss_ss: 0.647565, loss_d: 0.190685
0.5758 --- loss: 1.320901, loss_ss: 1.079591, loss_d: 0.241310
0.6142 --- loss: 1.018497, loss_ss: 0.903673, loss_d: 0.114825
0.6526 --- loss: 1.315281, loss_ss: 1.163122, loss_d: 0.152159
0.6910 --- loss: 0.899846, loss_ss: 0.730844, loss_d: 0.169003
0.7294 --- loss: 1.237715, loss_ss: 0.957791, loss_d: 0.279924
0.7678 --- loss: 0.915967, loss_ss: 0.627930, loss_d: 0.288037
0.8061 --- loss: 0.824534, loss_ss: 0.692268, loss_d: 0.132266
0.8445 --- loss: 1.085726, loss_ss: 0.792619, loss_d: 0.293107
0.8829 --- loss: 1.741066, loss_ss: 1.091088, loss_d: 0.649978
0.9213 --- loss: 1.036985, loss_ss: 0.821347, loss_d: 0.215638
0.9597 --- loss: 1.489320, loss_ss: 0.866526, loss_d: 0.622794
0.9981 --- loss: 1.146870, loss_ss: 0.729771, loss_d: 0.417100
Epoch finished! Loss: 1.176039845439104
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.26464646464646463
             precision    recall  f1-score   support

        0.0       0.40      0.14      0.21       237
        1.0       0.11      0.00      0.01       249
        2.0       0.37      0.39      0.38       210
        3.0       0.67      0.39      0.49       245
        4.0       0.09      1.00      0.17        49

avg / total       0.37      0.26      0.26       990
 


====== chp017-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  74.34   14.35   93.23  40.00     21.12
1  74.14    0.40   98.92  11.11      0.78
2  73.03   39.05   82.18  37.10     38.05
3  80.10   39.18   93.56  66.67     49.36
4  51.31  100.00   48.78   9.23     16.90
Total accuracy: 26.46%
Average sen: 38.60%
Average spec: 83.33%
Macro f1-score: 25.24%
[0.83431602 0.70098013 0.61086816 0.97556871 0.86550379 0.7447511
 0.82107717 0.92741382 0.99782759 0.98883933 0.9780311  0.97591907
 0.86075425 0.76473087 0.93276632 1.         0.99925524 1.
 0.99348748 0.99411881 0.90540999 0.92387211 0.87568527 0.9183408
 0.98348558 0.97357583 0.99364859 0.86565554 0.82831758 0.31070435
 0.93573123 0.99242944 0.98028666]
pred: 0.8925258156025049, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.394583, loss_ss: 1.699412, loss_d: 0.695172
0.0384 --- loss: 3.242044, loss_ss: 1.555668, loss_d: 1.686377
0.0769 --- loss: 2.282113, loss_ss: 1.533076, loss_d: 0.749037
0.1153 --- loss: 1.839276, loss_ss: 1.419555, loss_d: 0.419720
0.1538 --- loss: 1.923569, loss_ss: 1.433738, loss_d: 0.489831
0.1922 --- loss: 1.909701, loss_ss: 1.333004, loss_d: 0.576697
0.2307 --- loss: 1.883981, loss_ss: 1.366087, loss_d: 0.517894
0.2691 --- loss: 1.959383, loss_ss: 1.382275, loss_d: 0.577107
0.3076 --- loss: 1.818567, loss_ss: 1.272252, loss_d: 0.546316
0.3460 --- loss: 1.853325, loss_ss: 1.371335, loss_d: 0.481990
0.3845 --- loss: 1.719626, loss_ss: 1.346335, loss_d: 0.373291
0.4229 --- loss: 1.938830, loss_ss: 1.358579, loss_d: 0.580250
0.4614 --- loss: 1.564279, loss_ss: 1.191987, loss_d: 0.372292
0.4998 --- loss: 1.672555, loss_ss: 1.266354, loss_d: 0.406200
0.5383 --- loss: 1.862204, loss_ss: 1.421122, loss_d: 0.441082
0.5767 --- loss: 1.814515, loss_ss: 1.234746, loss_d: 0.579769
0.6151 --- loss: 2.107409, loss_ss: 1.312235, loss_d: 0.795174
0.6536 --- loss: 1.865838, loss_ss: 1.139913, loss_d: 0.725925
0.6920 --- loss: 1.803130, loss_ss: 1.418564, loss_d: 0.384565
0.7305 --- loss: 1.784484, loss_ss: 1.137158, loss_d: 0.647325
0.7689 --- loss: 1.780407, loss_ss: 1.164730, loss_d: 0.615677
0.8074 --- loss: 1.710739, loss_ss: 1.191347, loss_d: 0.519392
0.8458 --- loss: 2.091726, loss_ss: 1.127294, loss_d: 0.964432
0.8843 --- loss: 1.672842, loss_ss: 1.243892, loss_d: 0.428950
0.9227 --- loss: 1.960581, loss_ss: 1.197636, loss_d: 0.762945
0.9612 --- loss: 1.605372, loss_ss: 1.122150, loss_d: 0.483222
0.9996 --- loss: 2.315659, loss_ss: 1.100723, loss_d: 1.214936
Epoch finished! Loss: 1.908255473925517
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.692356, loss_ss: 1.225369, loss_d: 0.466987
0.0384 --- loss: 1.901290, loss_ss: 1.179628, loss_d: 0.721661
0.0769 --- loss: 1.555675, loss_ss: 0.916501, loss_d: 0.639174
0.1153 --- loss: 1.652031, loss_ss: 1.002397, loss_d: 0.649634
0.1538 --- loss: 1.793719, loss_ss: 1.158209, loss_d: 0.635510
0.1922 --- loss: 1.367237, loss_ss: 1.090831, loss_d: 0.276405
0.2307 --- loss: 1.614164, loss_ss: 0.976329, loss_d: 0.637835
0.2691 --- loss: 1.766525, loss_ss: 1.184016, loss_d: 0.582509
0.3076 --- loss: 1.856166, loss_ss: 1.207410, loss_d: 0.648756
0.3460 --- loss: 1.589748, loss_ss: 0.994439, loss_d: 0.595309
0.3845 --- loss: 1.476674, loss_ss: 0.923299, loss_d: 0.553374
0.4229 --- loss: 1.540218, loss_ss: 1.133215, loss_d: 0.407003
0.4614 --- loss: 1.758337, loss_ss: 1.035986, loss_d: 0.722351
0.4998 --- loss: 1.707810, loss_ss: 1.056500, loss_d: 0.651310
0.5383 --- loss: 1.698473, loss_ss: 1.065044, loss_d: 0.633428
0.5767 --- loss: 1.498049, loss_ss: 0.973948, loss_d: 0.524102
0.6151 --- loss: 1.737307, loss_ss: 1.027986, loss_d: 0.709320
0.6536 --- loss: 1.479255, loss_ss: 0.911945, loss_d: 0.567311
0.6920 --- loss: 1.661619, loss_ss: 1.070674, loss_d: 0.590945
0.7305 --- loss: 1.714411, loss_ss: 0.994967, loss_d: 0.719445
0.7689 --- loss: 1.661594, loss_ss: 0.980354, loss_d: 0.681239
0.8074 --- loss: 1.549112, loss_ss: 0.844069, loss_d: 0.705043
0.8458 --- loss: 1.772289, loss_ss: 1.029978, loss_d: 0.742311
0.8843 --- loss: 1.364627, loss_ss: 0.994753, loss_d: 0.369873
0.9227 --- loss: 1.781803, loss_ss: 1.004927, loss_d: 0.776876
0.9612 --- loss: 1.416084, loss_ss: 0.829011, loss_d: 0.587073
0.9996 --- loss: 2.539169, loss_ss: 1.110621, loss_d: 1.428548
Epoch finished! Loss: 1.6704246915303744
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.601603, loss_ss: 0.944825, loss_d: 0.656778
0.0384 --- loss: 1.466655, loss_ss: 1.044784, loss_d: 0.421871
0.0769 --- loss: 1.421050, loss_ss: 1.118445, loss_d: 0.302605
0.1153 --- loss: 1.452551, loss_ss: 1.000391, loss_d: 0.452160
0.1538 --- loss: 1.379670, loss_ss: 0.886930, loss_d: 0.492740
0.1922 --- loss: 1.487321, loss_ss: 0.934959, loss_d: 0.552362
0.2307 --- loss: 1.854828, loss_ss: 1.364601, loss_d: 0.490226
0.2691 --- loss: 1.384913, loss_ss: 0.838295, loss_d: 0.546618
0.3076 --- loss: 1.652642, loss_ss: 0.965240, loss_d: 0.687403
0.3460 --- loss: 1.712037, loss_ss: 1.109479, loss_d: 0.602557
0.3845 --- loss: 1.471164, loss_ss: 0.932422, loss_d: 0.538741
0.4229 --- loss: 1.421201, loss_ss: 0.977722, loss_d: 0.443479
0.4614 --- loss: 1.333668, loss_ss: 0.906356, loss_d: 0.427312
0.4998 --- loss: 1.658089, loss_ss: 1.074324, loss_d: 0.583765
0.5383 --- loss: 1.495525, loss_ss: 0.872433, loss_d: 0.623092
0.5767 --- loss: 1.388276, loss_ss: 0.827201, loss_d: 0.561075
0.6151 --- loss: 1.411838, loss_ss: 0.916344, loss_d: 0.495494
0.6536 --- loss: 1.456509, loss_ss: 1.029045, loss_d: 0.427464
0.6920 --- loss: 1.521569, loss_ss: 1.037446, loss_d: 0.484123
0.7305 --- loss: 1.038711, loss_ss: 0.663679, loss_d: 0.375032
0.7689 --- loss: 1.421721, loss_ss: 0.971514, loss_d: 0.450207
0.8074 --- loss: 1.569970, loss_ss: 1.047750, loss_d: 0.522220
0.8458 --- loss: 1.756397, loss_ss: 1.060409, loss_d: 0.695988
0.8843 --- loss: 1.826355, loss_ss: 1.061662, loss_d: 0.764693
0.9227 --- loss: 1.429406, loss_ss: 0.843162, loss_d: 0.586244
0.9612 --- loss: 1.514249, loss_ss: 1.041872, loss_d: 0.472377
0.9996 --- loss: 2.486691, loss_ss: 2.237114, loss_d: 0.249577
Epoch finished! Loss: 1.582998618712792
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.522912, loss_ss: 0.881775, loss_d: 0.641136
0.0384 --- loss: 2.122486, loss_ss: 0.989178, loss_d: 1.133309
0.0769 --- loss: 1.384181, loss_ss: 0.858589, loss_d: 0.525592
0.1153 --- loss: 1.603285, loss_ss: 0.965644, loss_d: 0.637641
0.1538 --- loss: 1.495582, loss_ss: 0.888874, loss_d: 0.606709
0.1922 --- loss: 1.528856, loss_ss: 1.121901, loss_d: 0.406955
0.2307 --- loss: 1.688691, loss_ss: 1.011172, loss_d: 0.677519
0.2691 --- loss: 1.752361, loss_ss: 1.167701, loss_d: 0.584660
0.3076 --- loss: 1.439427, loss_ss: 0.876015, loss_d: 0.563412
0.3460 --- loss: 1.355154, loss_ss: 0.928413, loss_d: 0.426741
0.3845 --- loss: 1.915890, loss_ss: 1.160190, loss_d: 0.755700
0.4229 --- loss: 1.892632, loss_ss: 0.807149, loss_d: 1.085484
0.4614 --- loss: 1.819576, loss_ss: 0.839593, loss_d: 0.979983
0.4998 --- loss: 1.468858, loss_ss: 0.938857, loss_d: 0.530001
0.5383 --- loss: 1.688052, loss_ss: 1.017846, loss_d: 0.670206
0.5767 --- loss: 1.839856, loss_ss: 1.164358, loss_d: 0.675497
0.6151 --- loss: 1.513078, loss_ss: 0.933883, loss_d: 0.579196
0.6536 --- loss: 1.900830, loss_ss: 0.925554, loss_d: 0.975276
0.6920 --- loss: 1.339290, loss_ss: 0.880930, loss_d: 0.458359
0.7305 --- loss: 1.322056, loss_ss: 0.808534, loss_d: 0.513522
0.7689 --- loss: 1.444065, loss_ss: 0.714235, loss_d: 0.729830
0.8074 --- loss: 1.629606, loss_ss: 0.996728, loss_d: 0.632878
0.8458 --- loss: 1.303497, loss_ss: 0.862442, loss_d: 0.441055
0.8843 --- loss: 1.480681, loss_ss: 0.923904, loss_d: 0.556778
0.9227 --- loss: 1.651360, loss_ss: 0.936919, loss_d: 0.714441
0.9612 --- loss: 1.830477, loss_ss: 0.888838, loss_d: 0.941638
0.9996 --- loss: 1.254119, loss_ss: 1.063173, loss_d: 0.190947
Epoch finished! Loss: 1.5464115138237293
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.425679, loss_ss: 1.005466, loss_d: 0.420213
0.0384 --- loss: 2.037029, loss_ss: 1.051885, loss_d: 0.985143
0.0769 --- loss: 1.723715, loss_ss: 1.171209, loss_d: 0.552506
0.1153 --- loss: 1.209648, loss_ss: 0.851547, loss_d: 0.358101
0.1538 --- loss: 1.442498, loss_ss: 0.950472, loss_d: 0.492026
0.1922 --- loss: 1.293405, loss_ss: 0.729522, loss_d: 0.563883
0.2307 --- loss: 1.541446, loss_ss: 0.708674, loss_d: 0.832771
0.2691 --- loss: 1.379047, loss_ss: 0.835007, loss_d: 0.544040
0.3076 --- loss: 1.721460, loss_ss: 0.942264, loss_d: 0.779196
0.3460 --- loss: 1.281331, loss_ss: 0.909254, loss_d: 0.372077
0.3845 --- loss: 1.196406, loss_ss: 0.777698, loss_d: 0.418708
0.4229 --- loss: 1.231955, loss_ss: 0.843616, loss_d: 0.388339
0.4614 --- loss: 1.589530, loss_ss: 1.045782, loss_d: 0.543747
0.4998 --- loss: 1.795340, loss_ss: 1.156942, loss_d: 0.638397
0.5383 --- loss: 1.635097, loss_ss: 0.875646, loss_d: 0.759452
0.5767 --- loss: 1.629420, loss_ss: 0.921963, loss_d: 0.707457
0.6151 --- loss: 1.498955, loss_ss: 0.868551, loss_d: 0.630404
0.6536 --- loss: 1.663502, loss_ss: 1.124754, loss_d: 0.538748
0.6920 --- loss: 1.732940, loss_ss: 1.140434, loss_d: 0.592506
0.7305 --- loss: 1.090683, loss_ss: 0.667276, loss_d: 0.423406
0.7689 --- loss: 1.153884, loss_ss: 0.664329, loss_d: 0.489555
0.8074 --- loss: 1.535347, loss_ss: 1.069675, loss_d: 0.465672
0.8458 --- loss: 1.544991, loss_ss: 0.847178, loss_d: 0.697812
0.8843 --- loss: 1.831263, loss_ss: 1.156328, loss_d: 0.674935
0.9227 --- loss: 1.316435, loss_ss: 0.858328, loss_d: 0.458107
0.9612 --- loss: 1.328748, loss_ss: 0.909512, loss_d: 0.419236
0.9996 --- loss: 2.887994, loss_ss: 1.176062, loss_d: 1.711932
Epoch finished! Loss: 1.4703515974374919
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.056511, loss_ss: 0.772705, loss_d: 0.283806
0.0384 --- loss: 1.525069, loss_ss: 0.790862, loss_d: 0.734207
0.0769 --- loss: 1.213564, loss_ss: 0.769679, loss_d: 0.443885
0.1153 --- loss: 1.485661, loss_ss: 0.918724, loss_d: 0.566937
0.1538 --- loss: 1.329121, loss_ss: 0.976058, loss_d: 0.353062
0.1922 --- loss: 1.515657, loss_ss: 0.810616, loss_d: 0.705042
0.2307 --- loss: 1.645056, loss_ss: 1.223681, loss_d: 0.421375
0.2691 --- loss: 1.297117, loss_ss: 0.855403, loss_d: 0.441714
0.3076 --- loss: 1.692090, loss_ss: 1.141874, loss_d: 0.550215
0.3460 --- loss: 0.833225, loss_ss: 0.635973, loss_d: 0.197252
0.3845 --- loss: 1.299861, loss_ss: 0.837839, loss_d: 0.462021
0.4229 --- loss: 1.549500, loss_ss: 1.065827, loss_d: 0.483673
0.4614 --- loss: 1.452432, loss_ss: 0.769586, loss_d: 0.682846
0.4998 --- loss: 1.494472, loss_ss: 1.012540, loss_d: 0.481932
0.5383 --- loss: 1.229058, loss_ss: 0.920791, loss_d: 0.308267
0.5767 --- loss: 0.921804, loss_ss: 0.687485, loss_d: 0.234319
0.6151 --- loss: 1.207109, loss_ss: 0.829809, loss_d: 0.377300
0.6536 --- loss: 1.199269, loss_ss: 0.751248, loss_d: 0.448021
0.6920 --- loss: 1.036305, loss_ss: 0.767424, loss_d: 0.268881
0.7305 --- loss: 1.368733, loss_ss: 0.708904, loss_d: 0.659829
0.7689 --- loss: 1.345596, loss_ss: 0.863581, loss_d: 0.482015
0.8074 --- loss: 1.418647, loss_ss: 0.887555, loss_d: 0.531091
0.8458 --- loss: 1.108006, loss_ss: 0.757519, loss_d: 0.350487
0.8843 --- loss: 1.119152, loss_ss: 0.679438, loss_d: 0.439714
0.9227 --- loss: 1.353193, loss_ss: 1.053447, loss_d: 0.299747
0.9612 --- loss: 1.113587, loss_ss: 0.903557, loss_d: 0.210029
0.9996 --- loss: 3.485073, loss_ss: 1.375304, loss_d: 2.109769
Epoch finished! Loss: 1.3690347400995402
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.267931, loss_ss: 0.706380, loss_d: 0.561551
0.0384 --- loss: 1.244601, loss_ss: 0.938348, loss_d: 0.306253
0.0769 --- loss: 1.445988, loss_ss: 0.934075, loss_d: 0.511913
0.1153 --- loss: 1.384970, loss_ss: 0.749833, loss_d: 0.635137
0.1538 --- loss: 1.288682, loss_ss: 0.934961, loss_d: 0.353722
0.1922 --- loss: 1.041219, loss_ss: 0.710928, loss_d: 0.330291
0.2307 --- loss: 0.908692, loss_ss: 0.716599, loss_d: 0.192093
0.2691 --- loss: 1.273576, loss_ss: 0.765924, loss_d: 0.507653
0.3076 --- loss: 1.312172, loss_ss: 1.127036, loss_d: 0.185136
0.3460 --- loss: 1.101892, loss_ss: 0.824226, loss_d: 0.277666
0.3845 --- loss: 1.944628, loss_ss: 0.691989, loss_d: 1.252638
0.4229 --- loss: 1.120478, loss_ss: 0.816540, loss_d: 0.303938
0.4614 --- loss: 1.653755, loss_ss: 1.359997, loss_d: 0.293759
0.4998 --- loss: 1.520795, loss_ss: 1.091691, loss_d: 0.429105
0.5383 --- loss: 1.225293, loss_ss: 1.018056, loss_d: 0.207236
0.5767 --- loss: 0.976683, loss_ss: 0.820304, loss_d: 0.156379
0.6151 --- loss: 1.206043, loss_ss: 1.003806, loss_d: 0.202236
0.6536 --- loss: 1.413864, loss_ss: 0.988456, loss_d: 0.425409
0.6920 --- loss: 0.993857, loss_ss: 0.712498, loss_d: 0.281359
0.7305 --- loss: 1.470481, loss_ss: 0.761535, loss_d: 0.708947
0.7689 --- loss: 1.402754, loss_ss: 1.028423, loss_d: 0.374331
0.8074 --- loss: 1.164403, loss_ss: 0.781274, loss_d: 0.383129
0.8458 --- loss: 1.615425, loss_ss: 1.155554, loss_d: 0.459871
0.8843 --- loss: 1.246323, loss_ss: 0.659016, loss_d: 0.587307
0.9227 --- loss: 1.163030, loss_ss: 0.879228, loss_d: 0.283802
0.9612 --- loss: 1.203835, loss_ss: 0.985062, loss_d: 0.218773
0.9996 --- loss: 3.961338, loss_ss: 1.831158, loss_d: 2.130180
Epoch finished! Loss: 1.3092909700595416
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.512019, loss_ss: 1.367420, loss_d: 0.144599
0.0384 --- loss: 1.228480, loss_ss: 0.927044, loss_d: 0.301436
0.0769 --- loss: 0.838973, loss_ss: 0.579154, loss_d: 0.259820
0.1153 --- loss: 0.925135, loss_ss: 0.656518, loss_d: 0.268617
0.1538 --- loss: 1.600975, loss_ss: 0.993408, loss_d: 0.607567
0.1922 --- loss: 0.653406, loss_ss: 0.482699, loss_d: 0.170706
0.2307 --- loss: 1.095794, loss_ss: 0.730514, loss_d: 0.365280
0.2691 --- loss: 1.262262, loss_ss: 0.819599, loss_d: 0.442663
0.3076 --- loss: 1.207541, loss_ss: 0.810489, loss_d: 0.397053
0.3460 --- loss: 1.027406, loss_ss: 0.698700, loss_d: 0.328706
0.3845 --- loss: 0.952381, loss_ss: 0.761749, loss_d: 0.190632
0.4229 --- loss: 1.501161, loss_ss: 1.213637, loss_d: 0.287524
0.4614 --- loss: 1.278924, loss_ss: 0.910427, loss_d: 0.368497
0.4998 --- loss: 1.330770, loss_ss: 1.113430, loss_d: 0.217340
0.5383 --- loss: 1.394452, loss_ss: 0.665195, loss_d: 0.729257
0.5767 --- loss: 1.244278, loss_ss: 0.996760, loss_d: 0.247518
0.6151 --- loss: 1.139732, loss_ss: 0.777415, loss_d: 0.362318
0.6536 --- loss: 1.265563, loss_ss: 1.073589, loss_d: 0.191974
0.6920 --- loss: 1.308298, loss_ss: 0.722205, loss_d: 0.586093
0.7305 --- loss: 1.234160, loss_ss: 0.864369, loss_d: 0.369791
0.7689 --- loss: 1.014643, loss_ss: 0.798118, loss_d: 0.216525
0.8074 --- loss: 1.163109, loss_ss: 0.936178, loss_d: 0.226931
0.8458 --- loss: 1.409508, loss_ss: 0.990281, loss_d: 0.419227
0.8843 --- loss: 1.303207, loss_ss: 1.065696, loss_d: 0.237511
0.9227 --- loss: 1.381255, loss_ss: 1.178659, loss_d: 0.202595
0.9612 --- loss: 1.681442, loss_ss: 0.949805, loss_d: 0.731637
0.9996 --- loss: 4.054756, loss_ss: 2.144399, loss_d: 1.910357
Epoch finished! Loss: 1.249252397280473
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.336340, loss_ss: 0.921145, loss_d: 0.415195
0.0384 --- loss: 1.103932, loss_ss: 0.660900, loss_d: 0.443032
0.0769 --- loss: 1.121446, loss_ss: 0.737229, loss_d: 0.384217
0.1153 --- loss: 1.115146, loss_ss: 0.904111, loss_d: 0.211035
0.1538 --- loss: 0.938074, loss_ss: 0.714621, loss_d: 0.223453
0.1922 --- loss: 1.006592, loss_ss: 0.783959, loss_d: 0.222632
0.2307 --- loss: 1.114421, loss_ss: 0.884055, loss_d: 0.230366
0.2691 --- loss: 1.524250, loss_ss: 1.406420, loss_d: 0.117830
0.3076 --- loss: 1.026546, loss_ss: 0.833912, loss_d: 0.192634
0.3460 --- loss: 1.024481, loss_ss: 0.859778, loss_d: 0.164703
0.3845 --- loss: 1.272477, loss_ss: 1.077675, loss_d: 0.194801
0.4229 --- loss: 1.453561, loss_ss: 0.958960, loss_d: 0.494601
0.4614 --- loss: 1.277367, loss_ss: 1.117967, loss_d: 0.159400
0.4998 --- loss: 1.125408, loss_ss: 0.835053, loss_d: 0.290355
0.5383 --- loss: 1.053695, loss_ss: 0.891671, loss_d: 0.162024
0.5767 --- loss: 1.011578, loss_ss: 0.783457, loss_d: 0.228121
0.6151 --- loss: 0.868739, loss_ss: 0.708449, loss_d: 0.160290
0.6536 --- loss: 0.836937, loss_ss: 0.583598, loss_d: 0.253338
0.6920 --- loss: 1.844635, loss_ss: 1.585857, loss_d: 0.258778
0.7305 --- loss: 0.965218, loss_ss: 0.799131, loss_d: 0.166087
0.7689 --- loss: 0.922592, loss_ss: 0.748500, loss_d: 0.174092
0.8074 --- loss: 1.326018, loss_ss: 0.814263, loss_d: 0.511755
0.8458 --- loss: 1.203676, loss_ss: 0.794172, loss_d: 0.409504
0.8843 --- loss: 0.886450, loss_ss: 0.745851, loss_d: 0.140598
0.9227 --- loss: 0.953693, loss_ss: 0.800163, loss_d: 0.153530
0.9612 --- loss: 1.334838, loss_ss: 1.220921, loss_d: 0.113917
0.9996 --- loss: 3.138092, loss_ss: 3.121990, loss_d: 0.016102
Epoch finished! Loss: 1.2172910020901606
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.086519, loss_ss: 0.886904, loss_d: 0.199615
0.0384 --- loss: 1.392061, loss_ss: 1.026916, loss_d: 0.365145
0.0769 --- loss: 1.089737, loss_ss: 0.831036, loss_d: 0.258701
0.1153 --- loss: 1.137207, loss_ss: 0.669494, loss_d: 0.467713
0.1538 --- loss: 0.994934, loss_ss: 0.866026, loss_d: 0.128907
0.1922 --- loss: 1.022768, loss_ss: 0.678928, loss_d: 0.343840
0.2307 --- loss: 1.347735, loss_ss: 0.780509, loss_d: 0.567226
0.2691 --- loss: 0.924419, loss_ss: 0.711088, loss_d: 0.213331
0.3076 --- loss: 1.160898, loss_ss: 0.798970, loss_d: 0.361928
0.3460 --- loss: 1.120268, loss_ss: 0.853220, loss_d: 0.267047
0.3845 --- loss: 1.290951, loss_ss: 1.042268, loss_d: 0.248684
0.4229 --- loss: 1.336901, loss_ss: 0.956779, loss_d: 0.380121
0.4614 --- loss: 1.042709, loss_ss: 0.789792, loss_d: 0.252917
0.4998 --- loss: 0.958063, loss_ss: 0.693458, loss_d: 0.264605
0.5383 --- loss: 0.684822, loss_ss: 0.519926, loss_d: 0.164896
0.5767 --- loss: 0.844979, loss_ss: 0.612400, loss_d: 0.232579
0.6151 --- loss: 1.751106, loss_ss: 0.941485, loss_d: 0.809621
0.6536 --- loss: 1.071340, loss_ss: 0.864135, loss_d: 0.207205
0.6920 --- loss: 0.840621, loss_ss: 0.619461, loss_d: 0.221160
0.7305 --- loss: 1.156863, loss_ss: 0.707483, loss_d: 0.449380
0.7689 --- loss: 0.849560, loss_ss: 0.743201, loss_d: 0.106359
0.8074 --- loss: 1.167542, loss_ss: 0.881685, loss_d: 0.285857
0.8458 --- loss: 1.281861, loss_ss: 1.048364, loss_d: 0.233497
0.8843 --- loss: 1.228880, loss_ss: 1.128872, loss_d: 0.100008
0.9227 --- loss: 0.933028, loss_ss: 0.818700, loss_d: 0.114327
0.9612 --- loss: 1.290693, loss_ss: 1.178795, loss_d: 0.111898
0.9996 --- loss: 0.965476, loss_ss: 0.922728, loss_d: 0.042748
Epoch finished! Loss: 1.1549001310880367
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7135135135135136
             precision    recall  f1-score   support

        0.0       0.73      0.86      0.79       138
        1.0       0.33      0.01      0.02       123
        2.0       0.32      0.67      0.43       120
        3.0       0.90      0.89      0.89       363
        4.0       0.81      0.74      0.77       366

avg / total       0.72      0.71      0.69      1110
 


====== chp018-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.32  85.51   95.58  73.29     78.93
1  88.83   0.81   99.80  33.33      1.59
2  80.81  66.67   82.53  31.62     42.90
3  93.15  88.71   95.31  90.20     89.44
4  85.59  74.04   91.26  80.65     77.21
Total accuracy: 71.35%
Average sen: 63.15%
Average spec: 92.90%
Macro f1-score: 58.01%
[0.85087699 0.33225346 0.21755506 0.3489731  0.29903981 0.83968616
 0.88926554 0.88186568 0.47581804 0.61176997 0.31294385 0.61773604
 0.47434869 0.92466998 0.84253329 0.70379549 0.8227635  0.87037849
 0.36968493 0.47350061 0.70606256 0.66059774 0.68950295 0.65894622
 0.71006578 0.2585547  0.63436174 0.59407806 0.43153477 0.58195162
 0.41464719 0.55767131 0.92697448 0.78754926 0.69132495 0.22729373
 0.39052463]
pred: 0.5967864962042989, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.446895, loss_ss: 1.755471, loss_d: 0.691424
0.0384 --- loss: 2.056968, loss_ss: 1.400577, loss_d: 0.656391
0.0767 --- loss: 1.944961, loss_ss: 1.373533, loss_d: 0.571428
0.1151 --- loss: 1.699780, loss_ss: 1.346739, loss_d: 0.353041
0.1534 --- loss: 1.740380, loss_ss: 1.301350, loss_d: 0.439030
0.1918 --- loss: 1.862855, loss_ss: 1.379587, loss_d: 0.483268
0.2301 --- loss: 1.942100, loss_ss: 1.376468, loss_d: 0.565632
0.2685 --- loss: 1.593698, loss_ss: 1.222978, loss_d: 0.370719
0.3069 --- loss: 1.779175, loss_ss: 1.288835, loss_d: 0.490339
0.3452 --- loss: 1.895028, loss_ss: 1.370601, loss_d: 0.524427
0.3836 --- loss: 1.921784, loss_ss: 1.303793, loss_d: 0.617991
0.4219 --- loss: 1.806875, loss_ss: 1.323925, loss_d: 0.482950
0.4603 --- loss: 1.625901, loss_ss: 1.283842, loss_d: 0.342058
0.4987 --- loss: 1.474200, loss_ss: 1.180643, loss_d: 0.293557
0.5370 --- loss: 1.752032, loss_ss: 1.304348, loss_d: 0.447684
0.5754 --- loss: 1.812964, loss_ss: 1.182081, loss_d: 0.630883
0.6137 --- loss: 2.031228, loss_ss: 1.267150, loss_d: 0.764078
0.6521 --- loss: 1.694226, loss_ss: 1.148500, loss_d: 0.545726
0.6904 --- loss: 1.827709, loss_ss: 1.328783, loss_d: 0.498926
0.7288 --- loss: 1.663791, loss_ss: 1.091902, loss_d: 0.571889
0.7672 --- loss: 1.873010, loss_ss: 1.497135, loss_d: 0.375875
0.8055 --- loss: 1.735121, loss_ss: 0.991363, loss_d: 0.743758
0.8439 --- loss: 1.907989, loss_ss: 1.275169, loss_d: 0.632820
0.8822 --- loss: 1.748284, loss_ss: 1.201557, loss_d: 0.546727
0.9206 --- loss: 1.526144, loss_ss: 1.019502, loss_d: 0.506643
0.9590 --- loss: 1.690038, loss_ss: 1.021818, loss_d: 0.668220
0.9973 --- loss: 1.886581, loss_ss: 1.122134, loss_d: 0.764447
Epoch finished! Loss: 1.878711694937486
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.620615, loss_ss: 1.080136, loss_d: 0.540479
0.0384 --- loss: 2.022938, loss_ss: 1.343516, loss_d: 0.679422
0.0767 --- loss: 1.716828, loss_ss: 1.128748, loss_d: 0.588080
0.1151 --- loss: 1.771392, loss_ss: 1.206598, loss_d: 0.564794
0.1534 --- loss: 1.496299, loss_ss: 1.098933, loss_d: 0.397367
0.1918 --- loss: 1.626258, loss_ss: 1.045974, loss_d: 0.580283
0.2301 --- loss: 1.828306, loss_ss: 1.210519, loss_d: 0.617787
0.2685 --- loss: 1.838648, loss_ss: 1.393565, loss_d: 0.445083
0.3069 --- loss: 1.730156, loss_ss: 1.197280, loss_d: 0.532877
0.3452 --- loss: 1.882173, loss_ss: 1.090686, loss_d: 0.791486
0.3836 --- loss: 1.695119, loss_ss: 1.146460, loss_d: 0.548659
0.4219 --- loss: 1.578341, loss_ss: 1.054580, loss_d: 0.523761
0.4603 --- loss: 1.992881, loss_ss: 1.212568, loss_d: 0.780313
0.4987 --- loss: 1.791639, loss_ss: 1.041802, loss_d: 0.749837
0.5370 --- loss: 1.797420, loss_ss: 1.423080, loss_d: 0.374340
0.5754 --- loss: 1.900923, loss_ss: 1.417976, loss_d: 0.482947
0.6137 --- loss: 1.589522, loss_ss: 1.073273, loss_d: 0.516249
0.6521 --- loss: 1.518583, loss_ss: 1.066907, loss_d: 0.451675
0.6904 --- loss: 1.814704, loss_ss: 1.115098, loss_d: 0.699605
0.7288 --- loss: 1.538787, loss_ss: 1.101685, loss_d: 0.437103
0.7672 --- loss: 1.438672, loss_ss: 0.967426, loss_d: 0.471246
0.8055 --- loss: 1.645067, loss_ss: 1.043781, loss_d: 0.601286
0.8439 --- loss: 1.455799, loss_ss: 0.994688, loss_d: 0.461111
0.8822 --- loss: 2.225305, loss_ss: 1.212882, loss_d: 1.012422
0.9206 --- loss: 1.792629, loss_ss: 1.169158, loss_d: 0.623472
0.9590 --- loss: 1.713652, loss_ss: 1.087580, loss_d: 0.626071
0.9973 --- loss: 2.046466, loss_ss: 1.445166, loss_d: 0.601300
Epoch finished! Loss: 1.6854765649025256
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.477834, loss_ss: 0.970542, loss_d: 0.507293
0.0384 --- loss: 1.468214, loss_ss: 0.891241, loss_d: 0.576973
0.0767 --- loss: 1.545181, loss_ss: 0.997670, loss_d: 0.547511
0.1151 --- loss: 1.611562, loss_ss: 0.926190, loss_d: 0.685372
0.1534 --- loss: 1.819352, loss_ss: 1.091644, loss_d: 0.727708
0.1918 --- loss: 1.578876, loss_ss: 0.825161, loss_d: 0.753715
0.2301 --- loss: 1.598097, loss_ss: 0.954436, loss_d: 0.643661
0.2685 --- loss: 1.751357, loss_ss: 1.086927, loss_d: 0.664430
0.3069 --- loss: 1.707103, loss_ss: 1.168574, loss_d: 0.538528
0.3452 --- loss: 1.386410, loss_ss: 1.023939, loss_d: 0.362470
0.3836 --- loss: 1.661148, loss_ss: 1.087518, loss_d: 0.573630
0.4219 --- loss: 1.957943, loss_ss: 1.159315, loss_d: 0.798627
0.4603 --- loss: 1.677737, loss_ss: 0.945393, loss_d: 0.732344
0.4987 --- loss: 1.505881, loss_ss: 0.950676, loss_d: 0.555205
0.5370 --- loss: 1.543278, loss_ss: 0.942187, loss_d: 0.601090
0.5754 --- loss: 1.449530, loss_ss: 0.944192, loss_d: 0.505339
0.6137 --- loss: 1.798638, loss_ss: 1.081517, loss_d: 0.717120
0.6521 --- loss: 1.519090, loss_ss: 1.027013, loss_d: 0.492077
0.6904 --- loss: 1.390164, loss_ss: 1.010016, loss_d: 0.380147
0.7288 --- loss: 1.627344, loss_ss: 1.039245, loss_d: 0.588100
0.7672 --- loss: 1.642978, loss_ss: 1.061922, loss_d: 0.581056
0.8055 --- loss: 1.257363, loss_ss: 0.790402, loss_d: 0.466960
0.8439 --- loss: 1.408309, loss_ss: 0.973647, loss_d: 0.434661
0.8822 --- loss: 1.444283, loss_ss: 0.817235, loss_d: 0.627048
0.9206 --- loss: 1.262540, loss_ss: 0.933730, loss_d: 0.328809
0.9590 --- loss: 1.953310, loss_ss: 1.178768, loss_d: 0.774543
0.9973 --- loss: 1.684666, loss_ss: 1.169957, loss_d: 0.514708
Epoch finished! Loss: 1.59189006456962
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.429170, loss_ss: 0.983357, loss_d: 0.445814
0.0384 --- loss: 1.452462, loss_ss: 1.051400, loss_d: 0.401062
0.0767 --- loss: 1.747210, loss_ss: 1.037814, loss_d: 0.709397
0.1151 --- loss: 1.201888, loss_ss: 0.930709, loss_d: 0.271179
0.1534 --- loss: 1.113247, loss_ss: 0.838365, loss_d: 0.274882
0.1918 --- loss: 1.362816, loss_ss: 1.033601, loss_d: 0.329215
0.2301 --- loss: 1.624470, loss_ss: 1.168437, loss_d: 0.456033
0.2685 --- loss: 1.710250, loss_ss: 1.157090, loss_d: 0.553160
0.3069 --- loss: 1.481163, loss_ss: 0.860335, loss_d: 0.620828
0.3452 --- loss: 1.166825, loss_ss: 0.907667, loss_d: 0.259158
0.3836 --- loss: 1.048670, loss_ss: 0.834673, loss_d: 0.213997
0.4219 --- loss: 1.051849, loss_ss: 0.811996, loss_d: 0.239852
0.4603 --- loss: 1.250204, loss_ss: 1.020502, loss_d: 0.229702
0.4987 --- loss: 1.258987, loss_ss: 0.963524, loss_d: 0.295463
0.5370 --- loss: 1.151392, loss_ss: 0.878862, loss_d: 0.272530
0.5754 --- loss: 1.106411, loss_ss: 0.867807, loss_d: 0.238604
0.6137 --- loss: 1.286820, loss_ss: 0.888743, loss_d: 0.398077
0.6521 --- loss: 1.287461, loss_ss: 0.747188, loss_d: 0.540273
0.6904 --- loss: 1.131569, loss_ss: 0.843379, loss_d: 0.288190
0.7288 --- loss: 1.349371, loss_ss: 0.920935, loss_d: 0.428437
0.7672 --- loss: 1.176351, loss_ss: 0.927132, loss_d: 0.249219
0.8055 --- loss: 1.276462, loss_ss: 1.010267, loss_d: 0.266195
0.8439 --- loss: 1.538167, loss_ss: 1.198772, loss_d: 0.339395
0.8822 --- loss: 1.368817, loss_ss: 0.807793, loss_d: 0.561024
0.9206 --- loss: 1.477450, loss_ss: 0.841771, loss_d: 0.635679
0.9590 --- loss: 1.370871, loss_ss: 0.909530, loss_d: 0.461340
0.9973 --- loss: 1.284825, loss_ss: 1.077360, loss_d: 0.207465
Epoch finished! Loss: 1.4628777380173024
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.712838, loss_ss: 1.213419, loss_d: 0.499419
0.0384 --- loss: 1.397164, loss_ss: 0.954446, loss_d: 0.442718
0.0767 --- loss: 1.386455, loss_ss: 1.026762, loss_d: 0.359693
0.1151 --- loss: 1.207192, loss_ss: 1.003743, loss_d: 0.203449
0.1534 --- loss: 1.258255, loss_ss: 0.753630, loss_d: 0.504625
0.1918 --- loss: 1.233208, loss_ss: 1.012733, loss_d: 0.220475
0.2301 --- loss: 1.270276, loss_ss: 0.973480, loss_d: 0.296796
0.2685 --- loss: 1.404073, loss_ss: 1.020625, loss_d: 0.383448
0.3069 --- loss: 1.538577, loss_ss: 0.817433, loss_d: 0.721144
0.3452 --- loss: 1.409254, loss_ss: 0.841864, loss_d: 0.567390
0.3836 --- loss: 0.959653, loss_ss: 0.753531, loss_d: 0.206122
0.4219 --- loss: 1.153670, loss_ss: 0.849221, loss_d: 0.304449
0.4603 --- loss: 1.179243, loss_ss: 0.820744, loss_d: 0.358499
0.4987 --- loss: 1.249540, loss_ss: 0.945763, loss_d: 0.303777
0.5370 --- loss: 1.601835, loss_ss: 0.639295, loss_d: 0.962541
0.5754 --- loss: 1.112587, loss_ss: 0.857660, loss_d: 0.254927
0.6137 --- loss: 1.557022, loss_ss: 1.058700, loss_d: 0.498322
0.6521 --- loss: 1.758649, loss_ss: 1.046076, loss_d: 0.712573
0.6904 --- loss: 1.024956, loss_ss: 0.805610, loss_d: 0.219346
0.7288 --- loss: 1.455958, loss_ss: 1.151588, loss_d: 0.304370
0.7672 --- loss: 1.438473, loss_ss: 1.019746, loss_d: 0.418727
0.8055 --- loss: 1.778781, loss_ss: 1.073778, loss_d: 0.705003
0.8439 --- loss: 1.387068, loss_ss: 1.150355, loss_d: 0.236713
0.8822 --- loss: 1.160100, loss_ss: 0.945858, loss_d: 0.214242
0.9206 --- loss: 1.225485, loss_ss: 0.753736, loss_d: 0.471749
0.9590 --- loss: 1.415036, loss_ss: 1.139217, loss_d: 0.275819
0.9973 --- loss: 1.765951, loss_ss: 1.416803, loss_d: 0.349148
Epoch finished! Loss: 1.356081212254671
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.523058, loss_ss: 1.216706, loss_d: 0.306353
0.0384 --- loss: 1.458632, loss_ss: 1.242861, loss_d: 0.215771
0.0767 --- loss: 1.602256, loss_ss: 1.123619, loss_d: 0.478637
0.1151 --- loss: 1.132038, loss_ss: 0.844564, loss_d: 0.287474
0.1534 --- loss: 1.007467, loss_ss: 0.676930, loss_d: 0.330537
0.1918 --- loss: 1.166644, loss_ss: 0.901530, loss_d: 0.265113
0.2301 --- loss: 0.994795, loss_ss: 0.697839, loss_d: 0.296956
0.2685 --- loss: 1.268680, loss_ss: 0.938914, loss_d: 0.329766
0.3069 --- loss: 1.463148, loss_ss: 1.127111, loss_d: 0.336037
0.3452 --- loss: 1.206794, loss_ss: 0.767417, loss_d: 0.439377
0.3836 --- loss: 1.192899, loss_ss: 0.922627, loss_d: 0.270272
0.4219 --- loss: 1.560575, loss_ss: 1.093717, loss_d: 0.466858
0.4603 --- loss: 1.050490, loss_ss: 0.823073, loss_d: 0.227417
0.4987 --- loss: 0.967987, loss_ss: 0.820877, loss_d: 0.147110
0.5370 --- loss: 1.117398, loss_ss: 0.863908, loss_d: 0.253490
0.5754 --- loss: 1.287286, loss_ss: 1.104841, loss_d: 0.182445
0.6137 --- loss: 1.378177, loss_ss: 1.003945, loss_d: 0.374232
0.6521 --- loss: 1.781078, loss_ss: 1.077994, loss_d: 0.703084
0.6904 --- loss: 0.918850, loss_ss: 0.653943, loss_d: 0.264907
0.7288 --- loss: 1.448624, loss_ss: 1.072378, loss_d: 0.376246
0.7672 --- loss: 1.560809, loss_ss: 1.087310, loss_d: 0.473499
0.8055 --- loss: 2.158400, loss_ss: 1.081237, loss_d: 1.077163
0.8439 --- loss: 1.131140, loss_ss: 0.885953, loss_d: 0.245187
0.8822 --- loss: 1.344533, loss_ss: 1.119027, loss_d: 0.225506
0.9206 --- loss: 0.955154, loss_ss: 0.832857, loss_d: 0.122298
0.9590 --- loss: 1.247848, loss_ss: 0.946043, loss_d: 0.301806
0.9973 --- loss: 1.585051, loss_ss: 0.939763, loss_d: 0.645288
Epoch finished! Loss: 1.3188945955955065
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.044762, loss_ss: 0.819681, loss_d: 0.225080
0.0384 --- loss: 1.014305, loss_ss: 0.729672, loss_d: 0.284632
0.0767 --- loss: 0.983189, loss_ss: 0.733559, loss_d: 0.249630
0.1151 --- loss: 1.714230, loss_ss: 1.224737, loss_d: 0.489493
0.1534 --- loss: 1.006764, loss_ss: 0.848723, loss_d: 0.158041
0.1918 --- loss: 1.374932, loss_ss: 0.654788, loss_d: 0.720144
0.2301 --- loss: 1.299184, loss_ss: 0.775848, loss_d: 0.523336
0.2685 --- loss: 0.774502, loss_ss: 0.521591, loss_d: 0.252910
0.3069 --- loss: 1.228955, loss_ss: 0.858724, loss_d: 0.370231
0.3452 --- loss: 1.061393, loss_ss: 0.870835, loss_d: 0.190558
0.3836 --- loss: 1.547211, loss_ss: 1.108249, loss_d: 0.438962
0.4219 --- loss: 1.508309, loss_ss: 1.091112, loss_d: 0.417197
0.4603 --- loss: 1.558437, loss_ss: 0.879159, loss_d: 0.679278
0.4987 --- loss: 1.540179, loss_ss: 0.871211, loss_d: 0.668968
0.5370 --- loss: 1.786205, loss_ss: 1.252792, loss_d: 0.533413
0.5754 --- loss: 1.271370, loss_ss: 1.069214, loss_d: 0.202156
0.6137 --- loss: 1.146512, loss_ss: 0.987841, loss_d: 0.158671
0.6521 --- loss: 1.315822, loss_ss: 1.095127, loss_d: 0.220695
0.6904 --- loss: 1.077320, loss_ss: 0.702354, loss_d: 0.374967
0.7288 --- loss: 1.318491, loss_ss: 1.021777, loss_d: 0.296714
0.7672 --- loss: 1.693302, loss_ss: 0.688480, loss_d: 1.004822
0.8055 --- loss: 1.252656, loss_ss: 0.872538, loss_d: 0.380118
0.8439 --- loss: 1.306898, loss_ss: 0.736522, loss_d: 0.570376
0.8822 --- loss: 1.303486, loss_ss: 0.853179, loss_d: 0.450307
0.9206 --- loss: 1.343401, loss_ss: 1.012071, loss_d: 0.331330
0.9590 --- loss: 0.870192, loss_ss: 0.679317, loss_d: 0.190875
0.9973 --- loss: 0.809016, loss_ss: 0.648658, loss_d: 0.160357
Epoch finished! Loss: 1.2623972161458088
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.487898, loss_ss: 1.085758, loss_d: 0.402140
0.0384 --- loss: 0.938489, loss_ss: 0.838231, loss_d: 0.100258
0.0767 --- loss: 1.245545, loss_ss: 1.106359, loss_d: 0.139186
0.1151 --- loss: 1.222056, loss_ss: 0.931165, loss_d: 0.290892
0.1534 --- loss: 1.157818, loss_ss: 0.839524, loss_d: 0.318294
0.1918 --- loss: 1.264966, loss_ss: 0.914287, loss_d: 0.350680
0.2301 --- loss: 1.567925, loss_ss: 0.908748, loss_d: 0.659178
0.2685 --- loss: 0.822942, loss_ss: 0.602110, loss_d: 0.220832
0.3069 --- loss: 0.969376, loss_ss: 0.809201, loss_d: 0.160175
0.3452 --- loss: 1.507846, loss_ss: 0.994644, loss_d: 0.513202
0.3836 --- loss: 1.027020, loss_ss: 0.871177, loss_d: 0.155842
0.4219 --- loss: 1.307621, loss_ss: 0.941580, loss_d: 0.366041
0.4603 --- loss: 1.320187, loss_ss: 0.647777, loss_d: 0.672410
0.4987 --- loss: 1.058874, loss_ss: 0.896585, loss_d: 0.162290
0.5370 --- loss: 0.956042, loss_ss: 0.759401, loss_d: 0.196641
0.5754 --- loss: 1.317677, loss_ss: 1.027763, loss_d: 0.289915
0.6137 --- loss: 0.950382, loss_ss: 0.735684, loss_d: 0.214698
0.6521 --- loss: 1.060077, loss_ss: 0.905376, loss_d: 0.154701
0.6904 --- loss: 1.040650, loss_ss: 0.848927, loss_d: 0.191723
0.7288 --- loss: 1.282825, loss_ss: 1.035313, loss_d: 0.247512
0.7672 --- loss: 0.945055, loss_ss: 0.761647, loss_d: 0.183408
0.8055 --- loss: 1.153633, loss_ss: 1.019356, loss_d: 0.134277
0.8439 --- loss: 1.322096, loss_ss: 0.969435, loss_d: 0.352660
0.8822 --- loss: 1.253114, loss_ss: 0.717484, loss_d: 0.535630
0.9206 --- loss: 1.305913, loss_ss: 1.077794, loss_d: 0.228119
0.9590 --- loss: 1.058728, loss_ss: 0.890123, loss_d: 0.168606
0.9973 --- loss: 1.478563, loss_ss: 0.981537, loss_d: 0.497027
Epoch finished! Loss: 1.217681517280065
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.036438, loss_ss: 0.843345, loss_d: 0.193093
0.0384 --- loss: 1.012135, loss_ss: 0.540940, loss_d: 0.471196
0.0767 --- loss: 1.255134, loss_ss: 1.089080, loss_d: 0.166054
0.1151 --- loss: 1.191401, loss_ss: 0.746030, loss_d: 0.445371
0.1534 --- loss: 1.531682, loss_ss: 0.916648, loss_d: 0.615034
0.1918 --- loss: 1.540941, loss_ss: 1.204243, loss_d: 0.336697
0.2301 --- loss: 1.058011, loss_ss: 0.712169, loss_d: 0.345842
0.2685 --- loss: 1.341830, loss_ss: 1.013452, loss_d: 0.328379
0.3069 --- loss: 1.408886, loss_ss: 0.979963, loss_d: 0.428923
0.3452 --- loss: 1.301799, loss_ss: 1.087215, loss_d: 0.214584
0.3836 --- loss: 1.162912, loss_ss: 0.943190, loss_d: 0.219722
0.4219 --- loss: 1.390490, loss_ss: 0.905831, loss_d: 0.484660
0.4603 --- loss: 1.298710, loss_ss: 0.817592, loss_d: 0.481117
0.4987 --- loss: 1.590408, loss_ss: 1.141707, loss_d: 0.448701
0.5370 --- loss: 1.416551, loss_ss: 1.128278, loss_d: 0.288274
0.5754 --- loss: 1.336808, loss_ss: 0.870211, loss_d: 0.466597
0.6137 --- loss: 0.904323, loss_ss: 0.675052, loss_d: 0.229272
0.6521 --- loss: 0.970908, loss_ss: 0.808515, loss_d: 0.162392
0.6904 --- loss: 1.630972, loss_ss: 0.905435, loss_d: 0.725537
0.7288 --- loss: 1.042509, loss_ss: 0.826459, loss_d: 0.216051
0.7672 --- loss: 1.208417, loss_ss: 0.696981, loss_d: 0.511436
0.8055 --- loss: 0.955199, loss_ss: 0.861074, loss_d: 0.094125
0.8439 --- loss: 0.894442, loss_ss: 0.783525, loss_d: 0.110917
0.8822 --- loss: 1.136381, loss_ss: 0.932571, loss_d: 0.203810
0.9206 --- loss: 1.554816, loss_ss: 0.906093, loss_d: 0.648724
0.9590 --- loss: 1.278643, loss_ss: 0.770616, loss_d: 0.508027
0.9973 --- loss: 0.940420, loss_ss: 0.674766, loss_d: 0.265654
Epoch finished! Loss: 1.2005096811514635
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.145105, loss_ss: 0.876825, loss_d: 0.268280
0.0384 --- loss: 1.133773, loss_ss: 0.759442, loss_d: 0.374331
0.0767 --- loss: 1.625710, loss_ss: 1.170944, loss_d: 0.454766
0.1151 --- loss: 1.029327, loss_ss: 0.617476, loss_d: 0.411851
0.1534 --- loss: 1.045350, loss_ss: 0.730322, loss_d: 0.315028
0.1918 --- loss: 1.066199, loss_ss: 0.910097, loss_d: 0.156101
0.2301 --- loss: 1.206619, loss_ss: 0.994813, loss_d: 0.211806
0.2685 --- loss: 1.271419, loss_ss: 0.966138, loss_d: 0.305281
0.3069 --- loss: 1.301491, loss_ss: 0.848061, loss_d: 0.453430
0.3452 --- loss: 1.145880, loss_ss: 0.965612, loss_d: 0.180268
0.3836 --- loss: 1.636503, loss_ss: 1.047628, loss_d: 0.588875
0.4219 --- loss: 0.816683, loss_ss: 0.720841, loss_d: 0.095842
0.4603 --- loss: 0.866712, loss_ss: 0.526757, loss_d: 0.339955
0.4987 --- loss: 1.275370, loss_ss: 0.668537, loss_d: 0.606834
0.5370 --- loss: 1.078132, loss_ss: 0.895877, loss_d: 0.182256
0.5754 --- loss: 1.061083, loss_ss: 0.737220, loss_d: 0.323863
0.6137 --- loss: 0.937653, loss_ss: 0.719197, loss_d: 0.218456
0.6521 --- loss: 1.135222, loss_ss: 0.888208, loss_d: 0.247013
0.6904 --- loss: 1.353145, loss_ss: 1.197481, loss_d: 0.155664
0.7288 --- loss: 1.142691, loss_ss: 0.938054, loss_d: 0.204637
0.7672 --- loss: 1.022331, loss_ss: 0.652143, loss_d: 0.370188
0.8055 --- loss: 1.585502, loss_ss: 0.630058, loss_d: 0.955444
0.8439 --- loss: 1.189670, loss_ss: 0.833600, loss_d: 0.356069
0.8822 --- loss: 1.676137, loss_ss: 0.831432, loss_d: 0.844705
0.9206 --- loss: 1.077743, loss_ss: 0.876102, loss_d: 0.201641
0.9590 --- loss: 1.113846, loss_ss: 0.920557, loss_d: 0.193289
0.9973 --- loss: 1.797228, loss_ss: 1.226214, loss_d: 0.571014
Epoch finished! Loss: 1.1567261404716052
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5924731182795699
             precision    recall  f1-score   support

        0.0       0.25      0.44      0.32        36
        1.0       0.09      0.02      0.03       112
        2.0       0.41      0.74      0.53       224
        3.0       0.85      0.88      0.86       226
        4.0       0.82      0.51      0.63       332

avg / total       0.62      0.59      0.58       930
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.80  44.44   94.74  25.40     32.32
1  86.02   1.79   97.56   9.09      2.99
2  67.85  74.11   65.86  40.79     52.61
3  93.33  87.61   95.17  85.34     86.46
4  78.49  50.90   93.81  82.04     62.83
Total accuracy: 59.25%
Average sen: 51.77%
Average spec: 89.43%
Macro f1-score: 47.44%
[0.99883431 0.99974877 0.9999361  0.99974567 0.99974674 0.99980623
 0.99995708 0.99990678 0.99995375 0.99971133 0.99998105 0.99999797
 0.99992025 0.99995053 0.99997234 0.9999665  0.99999142 0.99997389
 0.99995756 0.99999666 0.99999475 0.9999404  0.99992597 0.9999615
 0.99983966 0.9999789  0.99999237 0.99998212 0.9999404  0.9997161
 0.99998772]
pred: 0.9998811233428216, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.436704, loss_ss: 1.759436, loss_d: 0.677268
0.0385 --- loss: 2.265391, loss_ss: 1.639372, loss_d: 0.626019
0.0769 --- loss: 2.418504, loss_ss: 1.722201, loss_d: 0.696304
0.1154 --- loss: 1.962043, loss_ss: 1.523389, loss_d: 0.438654
0.1538 --- loss: 1.964756, loss_ss: 1.354401, loss_d: 0.610355
0.1923 --- loss: 2.064608, loss_ss: 1.399695, loss_d: 0.664913
0.2308 --- loss: 1.921020, loss_ss: 1.249638, loss_d: 0.671382
0.2692 --- loss: 1.913046, loss_ss: 1.330565, loss_d: 0.582481
0.3077 --- loss: 1.726310, loss_ss: 1.177550, loss_d: 0.548760
0.3462 --- loss: 2.292690, loss_ss: 1.279284, loss_d: 1.013407
0.3846 --- loss: 1.924021, loss_ss: 1.229300, loss_d: 0.694721
0.4231 --- loss: 1.759380, loss_ss: 1.324848, loss_d: 0.434532
0.4615 --- loss: 1.587264, loss_ss: 1.170260, loss_d: 0.417004
0.5000 --- loss: 2.089109, loss_ss: 1.204227, loss_d: 0.884883
0.5385 --- loss: 2.190847, loss_ss: 1.310226, loss_d: 0.880621
0.5769 --- loss: 1.932570, loss_ss: 1.300824, loss_d: 0.631747
0.6154 --- loss: 1.869647, loss_ss: 1.078652, loss_d: 0.790995
0.6538 --- loss: 1.969712, loss_ss: 1.397782, loss_d: 0.571930
0.6923 --- loss: 1.877970, loss_ss: 1.274565, loss_d: 0.603405
0.7308 --- loss: 1.637396, loss_ss: 1.101777, loss_d: 0.535619
0.7692 --- loss: 1.840504, loss_ss: 1.465237, loss_d: 0.375267
0.8077 --- loss: 1.930021, loss_ss: 1.223099, loss_d: 0.706922
0.8462 --- loss: 1.461276, loss_ss: 0.993359, loss_d: 0.467917
0.8846 --- loss: 1.738128, loss_ss: 1.211860, loss_d: 0.526268
0.9231 --- loss: 1.773467, loss_ss: 1.147517, loss_d: 0.625950
0.9615 --- loss: 1.640986, loss_ss: 1.143946, loss_d: 0.497040
Epoch finished! Loss: 1.9225820560713072
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.818265, loss_ss: 1.142546, loss_d: 0.675719
0.0385 --- loss: 2.002781, loss_ss: 1.378129, loss_d: 0.624653
0.0769 --- loss: 1.977836, loss_ss: 1.075563, loss_d: 0.902272
0.1154 --- loss: 1.914700, loss_ss: 1.224692, loss_d: 0.690007
0.1538 --- loss: 1.897501, loss_ss: 1.295937, loss_d: 0.601564
0.1923 --- loss: 1.573241, loss_ss: 1.111383, loss_d: 0.461858
0.2308 --- loss: 1.910857, loss_ss: 1.089461, loss_d: 0.821396
0.2692 --- loss: 1.842765, loss_ss: 1.342488, loss_d: 0.500276
0.3077 --- loss: 1.538463, loss_ss: 1.193826, loss_d: 0.344638
0.3462 --- loss: 1.866960, loss_ss: 1.239349, loss_d: 0.627611
0.3846 --- loss: 1.657426, loss_ss: 1.090159, loss_d: 0.567267
0.4231 --- loss: 1.549911, loss_ss: 0.931065, loss_d: 0.618846
0.4615 --- loss: 1.956633, loss_ss: 1.109756, loss_d: 0.846877
0.5000 --- loss: 1.623292, loss_ss: 0.931898, loss_d: 0.691394
0.5385 --- loss: 1.712327, loss_ss: 1.211833, loss_d: 0.500494
0.5769 --- loss: 1.982902, loss_ss: 1.391390, loss_d: 0.591512
0.6154 --- loss: 1.800424, loss_ss: 1.145715, loss_d: 0.654708
0.6538 --- loss: 1.733866, loss_ss: 0.889506, loss_d: 0.844360
0.6923 --- loss: 1.704806, loss_ss: 1.264222, loss_d: 0.440584
0.7308 --- loss: 1.660584, loss_ss: 0.968303, loss_d: 0.692281
0.7692 --- loss: 1.435403, loss_ss: 0.942636, loss_d: 0.492767
0.8077 --- loss: 1.564340, loss_ss: 1.100466, loss_d: 0.463873
0.8462 --- loss: 1.845496, loss_ss: 0.837443, loss_d: 1.008053
0.8846 --- loss: 1.887804, loss_ss: 0.954841, loss_d: 0.932963
0.9231 --- loss: 1.589958, loss_ss: 1.096071, loss_d: 0.493887
0.9615 --- loss: 1.485364, loss_ss: 1.069323, loss_d: 0.416041
Epoch finished! Loss: 1.6606404546605114
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.831756, loss_ss: 1.212134, loss_d: 0.619622
0.0385 --- loss: 1.790729, loss_ss: 1.126714, loss_d: 0.664015
0.0769 --- loss: 1.400549, loss_ss: 0.775902, loss_d: 0.624647
0.1154 --- loss: 1.470006, loss_ss: 0.943059, loss_d: 0.526948
0.1538 --- loss: 1.483768, loss_ss: 0.958926, loss_d: 0.524842
0.1923 --- loss: 1.431750, loss_ss: 1.004057, loss_d: 0.427693
0.2308 --- loss: 1.321142, loss_ss: 1.034251, loss_d: 0.286891
0.2692 --- loss: 1.567264, loss_ss: 0.971182, loss_d: 0.596082
0.3077 --- loss: 1.921888, loss_ss: 1.077063, loss_d: 0.844825
0.3462 --- loss: 1.678958, loss_ss: 1.087208, loss_d: 0.591750
0.3846 --- loss: 1.498791, loss_ss: 0.991850, loss_d: 0.506941
0.4231 --- loss: 1.213786, loss_ss: 0.851514, loss_d: 0.362272
0.4615 --- loss: 1.242757, loss_ss: 0.827383, loss_d: 0.415374
0.5000 --- loss: 1.486525, loss_ss: 0.927540, loss_d: 0.558984
0.5385 --- loss: 1.133503, loss_ss: 0.700725, loss_d: 0.432778
0.5769 --- loss: 1.638477, loss_ss: 0.998541, loss_d: 0.639936
0.6154 --- loss: 1.569633, loss_ss: 0.909290, loss_d: 0.660342
0.6538 --- loss: 1.797657, loss_ss: 1.042343, loss_d: 0.755315
0.6923 --- loss: 1.540641, loss_ss: 0.821761, loss_d: 0.718880
0.7308 --- loss: 1.722651, loss_ss: 1.086824, loss_d: 0.635827
0.7692 --- loss: 1.632504, loss_ss: 1.060882, loss_d: 0.571623
0.8077 --- loss: 1.704419, loss_ss: 1.149074, loss_d: 0.555345
0.8462 --- loss: 1.853870, loss_ss: 1.077792, loss_d: 0.776078
0.8846 --- loss: 1.682452, loss_ss: 0.986833, loss_d: 0.695619
0.9231 --- loss: 1.616003, loss_ss: 0.947962, loss_d: 0.668041
0.9615 --- loss: 1.748432, loss_ss: 0.951978, loss_d: 0.796455
Epoch finished! Loss: 1.560067428585185
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.402215, loss_ss: 0.747996, loss_d: 0.654219
0.0385 --- loss: 1.703503, loss_ss: 0.937135, loss_d: 0.766368
0.0769 --- loss: 1.153215, loss_ss: 0.826915, loss_d: 0.326301
0.1154 --- loss: 1.654898, loss_ss: 0.712588, loss_d: 0.942309
0.1538 --- loss: 1.504435, loss_ss: 0.842879, loss_d: 0.661556
0.1923 --- loss: 1.487962, loss_ss: 0.758437, loss_d: 0.729525
0.2308 --- loss: 1.427175, loss_ss: 0.654590, loss_d: 0.772585
0.2692 --- loss: 1.488262, loss_ss: 0.904366, loss_d: 0.583896
0.3077 --- loss: 1.672691, loss_ss: 1.264759, loss_d: 0.407932
0.3462 --- loss: 1.405679, loss_ss: 1.065054, loss_d: 0.340624
0.3846 --- loss: 2.301934, loss_ss: 1.363783, loss_d: 0.938150
0.4231 --- loss: 1.201158, loss_ss: 0.806034, loss_d: 0.395124
0.4615 --- loss: 1.883026, loss_ss: 0.983025, loss_d: 0.900000
0.5000 --- loss: 1.262579, loss_ss: 0.671617, loss_d: 0.590962
0.5385 --- loss: 1.523063, loss_ss: 1.096263, loss_d: 0.426800
0.5769 --- loss: 1.525368, loss_ss: 1.153817, loss_d: 0.371551
0.6154 --- loss: 1.471024, loss_ss: 0.972433, loss_d: 0.498591
0.6538 --- loss: 1.811176, loss_ss: 1.134926, loss_d: 0.676250
0.6923 --- loss: 1.715504, loss_ss: 0.934904, loss_d: 0.780600
0.7308 --- loss: 1.504795, loss_ss: 0.948520, loss_d: 0.556276
0.7692 --- loss: 1.485443, loss_ss: 0.656303, loss_d: 0.829140
0.8077 --- loss: 1.337632, loss_ss: 1.022987, loss_d: 0.314645
0.8462 --- loss: 1.242685, loss_ss: 0.882906, loss_d: 0.359779
0.8846 --- loss: 1.037142, loss_ss: 0.697290, loss_d: 0.339852
0.9231 --- loss: 2.059214, loss_ss: 0.922958, loss_d: 1.136255
0.9615 --- loss: 1.151659, loss_ss: 0.784378, loss_d: 0.367282
Epoch finished! Loss: 1.4750805683577843
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.011360, loss_ss: 0.758964, loss_d: 0.252396
0.0385 --- loss: 1.316328, loss_ss: 1.061069, loss_d: 0.255259
0.0769 --- loss: 1.333647, loss_ss: 1.001058, loss_d: 0.332589
0.1154 --- loss: 1.441594, loss_ss: 1.088358, loss_d: 0.353236
0.1538 --- loss: 1.197000, loss_ss: 0.810376, loss_d: 0.386624
0.1923 --- loss: 1.698653, loss_ss: 0.829233, loss_d: 0.869421
0.2308 --- loss: 1.314275, loss_ss: 1.019536, loss_d: 0.294739
0.2692 --- loss: 1.943979, loss_ss: 1.241283, loss_d: 0.702697
0.3077 --- loss: 1.289036, loss_ss: 0.920474, loss_d: 0.368562
0.3462 --- loss: 1.446942, loss_ss: 0.900866, loss_d: 0.546076
0.3846 --- loss: 1.117865, loss_ss: 0.704392, loss_d: 0.413473
0.4231 --- loss: 2.031432, loss_ss: 0.857193, loss_d: 1.174239
0.4615 --- loss: 1.666514, loss_ss: 1.308215, loss_d: 0.358300
0.5000 --- loss: 1.374996, loss_ss: 1.035343, loss_d: 0.339654
0.5385 --- loss: 1.210485, loss_ss: 0.884380, loss_d: 0.326105
0.5769 --- loss: 1.048592, loss_ss: 0.785729, loss_d: 0.262863
0.6154 --- loss: 1.277328, loss_ss: 0.835499, loss_d: 0.441829
0.6538 --- loss: 1.085252, loss_ss: 0.773911, loss_d: 0.311341
0.6923 --- loss: 1.097638, loss_ss: 0.786287, loss_d: 0.311350
0.7308 --- loss: 1.088822, loss_ss: 0.734227, loss_d: 0.354595
0.7692 --- loss: 1.486415, loss_ss: 0.953936, loss_d: 0.532479
0.8077 --- loss: 1.227718, loss_ss: 0.733378, loss_d: 0.494340
0.8462 --- loss: 1.289629, loss_ss: 0.767214, loss_d: 0.522414
0.8846 --- loss: 0.785083, loss_ss: 0.526757, loss_d: 0.258326
0.9231 --- loss: 0.927617, loss_ss: 0.662002, loss_d: 0.265615
0.9615 --- loss: 1.777088, loss_ss: 1.209808, loss_d: 0.567281
Epoch finished! Loss: 1.3818622797612519
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.101477, loss_ss: 0.834103, loss_d: 0.267374
0.0385 --- loss: 0.976992, loss_ss: 0.758943, loss_d: 0.218049
0.0769 --- loss: 0.936333, loss_ss: 0.743264, loss_d: 0.193070
0.1154 --- loss: 1.363929, loss_ss: 1.063220, loss_d: 0.300710
0.1538 --- loss: 1.669360, loss_ss: 1.082431, loss_d: 0.586930
0.1923 --- loss: 1.143301, loss_ss: 0.751969, loss_d: 0.391332
0.2308 --- loss: 1.185931, loss_ss: 0.972920, loss_d: 0.213011
0.2692 --- loss: 1.590679, loss_ss: 1.007571, loss_d: 0.583109
0.3077 --- loss: 1.112978, loss_ss: 0.713912, loss_d: 0.399066
0.3462 --- loss: 1.274317, loss_ss: 0.932127, loss_d: 0.342189
0.3846 --- loss: 1.368859, loss_ss: 0.900010, loss_d: 0.468848
0.4231 --- loss: 2.044987, loss_ss: 0.967966, loss_d: 1.077020
0.4615 --- loss: 1.301263, loss_ss: 0.960564, loss_d: 0.340698
0.5000 --- loss: 2.470424, loss_ss: 0.854901, loss_d: 1.615523
0.5385 --- loss: 1.388107, loss_ss: 0.930704, loss_d: 0.457403
0.5769 --- loss: 1.115407, loss_ss: 0.834442, loss_d: 0.280964
0.6154 --- loss: 1.384339, loss_ss: 1.116194, loss_d: 0.268146
0.6538 --- loss: 0.987553, loss_ss: 0.657721, loss_d: 0.329832
0.6923 --- loss: 1.086156, loss_ss: 0.867090, loss_d: 0.219066
0.7308 --- loss: 1.235363, loss_ss: 0.913114, loss_d: 0.322249
0.7692 --- loss: 1.077099, loss_ss: 0.853920, loss_d: 0.223179
0.8077 --- loss: 1.310912, loss_ss: 0.716876, loss_d: 0.594036
0.8462 --- loss: 1.425318, loss_ss: 0.775373, loss_d: 0.649945
0.8846 --- loss: 0.931276, loss_ss: 0.732245, loss_d: 0.199031
0.9231 --- loss: 1.519444, loss_ss: 1.067338, loss_d: 0.452106
0.9615 --- loss: 1.427565, loss_ss: 1.189583, loss_d: 0.237983
Epoch finished! Loss: 1.3001647870052735
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.648862, loss_ss: 0.702229, loss_d: 0.946633
0.0385 --- loss: 1.036081, loss_ss: 0.817163, loss_d: 0.218918
0.0769 --- loss: 1.036853, loss_ss: 0.715747, loss_d: 0.321106
0.1154 --- loss: 1.113481, loss_ss: 0.895874, loss_d: 0.217607
0.1538 --- loss: 1.774460, loss_ss: 1.069163, loss_d: 0.705296
0.1923 --- loss: 1.063557, loss_ss: 0.740050, loss_d: 0.323507
0.2308 --- loss: 1.232618, loss_ss: 0.989979, loss_d: 0.242638
0.2692 --- loss: 1.465163, loss_ss: 1.068747, loss_d: 0.396415
0.3077 --- loss: 1.145418, loss_ss: 0.821521, loss_d: 0.323897
0.3462 --- loss: 0.986172, loss_ss: 0.668518, loss_d: 0.317654
0.3846 --- loss: 1.193351, loss_ss: 0.886071, loss_d: 0.307280
0.4231 --- loss: 1.419683, loss_ss: 1.015367, loss_d: 0.404316
0.4615 --- loss: 0.895838, loss_ss: 0.649216, loss_d: 0.246621
0.5000 --- loss: 1.282242, loss_ss: 0.905346, loss_d: 0.376896
0.5385 --- loss: 0.847394, loss_ss: 0.672506, loss_d: 0.174888
0.5769 --- loss: 1.411960, loss_ss: 0.860914, loss_d: 0.551046
0.6154 --- loss: 1.099965, loss_ss: 0.942006, loss_d: 0.157958
0.6538 --- loss: 1.012422, loss_ss: 0.860649, loss_d: 0.151773
0.6923 --- loss: 1.479087, loss_ss: 0.995788, loss_d: 0.483299
0.7308 --- loss: 0.940419, loss_ss: 0.736858, loss_d: 0.203561
0.7692 --- loss: 1.393347, loss_ss: 0.914833, loss_d: 0.478514
0.8077 --- loss: 1.467915, loss_ss: 0.895812, loss_d: 0.572103
0.8462 --- loss: 1.053661, loss_ss: 0.845454, loss_d: 0.208207
0.8846 --- loss: 1.186063, loss_ss: 0.995640, loss_d: 0.190423
0.9231 --- loss: 1.086507, loss_ss: 0.876704, loss_d: 0.209803
0.9615 --- loss: 1.181930, loss_ss: 0.916926, loss_d: 0.265004
Epoch finished! Loss: 1.2584531164537525
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.399333, loss_ss: 0.813321, loss_d: 0.586011
0.0385 --- loss: 1.673375, loss_ss: 1.111514, loss_d: 0.561861
0.0769 --- loss: 1.112791, loss_ss: 0.904487, loss_d: 0.208304
0.1154 --- loss: 1.084512, loss_ss: 0.772895, loss_d: 0.311617
0.1538 --- loss: 1.061632, loss_ss: 0.790767, loss_d: 0.270865
0.1923 --- loss: 1.253992, loss_ss: 0.757577, loss_d: 0.496415
0.2308 --- loss: 1.223623, loss_ss: 0.937671, loss_d: 0.285951
0.2692 --- loss: 1.062686, loss_ss: 0.839652, loss_d: 0.223035
0.3077 --- loss: 1.087091, loss_ss: 0.752904, loss_d: 0.334187
0.3462 --- loss: 1.222991, loss_ss: 0.802731, loss_d: 0.420260
0.3846 --- loss: 0.951396, loss_ss: 0.619905, loss_d: 0.331490
0.4231 --- loss: 2.149915, loss_ss: 1.074027, loss_d: 1.075888
0.4615 --- loss: 1.306665, loss_ss: 0.979477, loss_d: 0.327188
0.5000 --- loss: 1.091116, loss_ss: 0.676525, loss_d: 0.414591
0.5385 --- loss: 0.935384, loss_ss: 0.786742, loss_d: 0.148641
0.5769 --- loss: 1.571577, loss_ss: 0.961355, loss_d: 0.610221
0.6154 --- loss: 1.073336, loss_ss: 0.718079, loss_d: 0.355257
0.6538 --- loss: 1.217977, loss_ss: 0.952959, loss_d: 0.265018
0.6923 --- loss: 1.309073, loss_ss: 0.881879, loss_d: 0.427194
0.7308 --- loss: 1.368384, loss_ss: 0.969189, loss_d: 0.399195
0.7692 --- loss: 1.286439, loss_ss: 0.903787, loss_d: 0.382652
0.8077 --- loss: 0.973479, loss_ss: 0.818170, loss_d: 0.155309
0.8462 --- loss: 0.935407, loss_ss: 0.717391, loss_d: 0.218016
0.8846 --- loss: 1.400518, loss_ss: 0.848516, loss_d: 0.552002
0.9231 --- loss: 1.548230, loss_ss: 0.876308, loss_d: 0.671922
0.9615 --- loss: 0.928990, loss_ss: 0.728265, loss_d: 0.200725
Epoch finished! Loss: 1.1930387409037144
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.013422, loss_ss: 0.818149, loss_d: 0.195273
0.0385 --- loss: 0.965830, loss_ss: 0.685677, loss_d: 0.280153
0.0769 --- loss: 1.067627, loss_ss: 0.929887, loss_d: 0.137740
0.1154 --- loss: 1.033322, loss_ss: 0.927766, loss_d: 0.105555
0.1538 --- loss: 1.120786, loss_ss: 0.858429, loss_d: 0.262357
0.1923 --- loss: 1.294691, loss_ss: 0.859932, loss_d: 0.434759
0.2308 --- loss: 1.893249, loss_ss: 0.760266, loss_d: 1.132983
0.2692 --- loss: 1.169932, loss_ss: 0.862463, loss_d: 0.307469
0.3077 --- loss: 1.195541, loss_ss: 0.591812, loss_d: 0.603729
0.3462 --- loss: 1.670689, loss_ss: 0.860567, loss_d: 0.810122
0.3846 --- loss: 1.156995, loss_ss: 0.887836, loss_d: 0.269159
0.4231 --- loss: 1.006182, loss_ss: 0.739334, loss_d: 0.266848
0.4615 --- loss: 1.884083, loss_ss: 1.678962, loss_d: 0.205121
0.5000 --- loss: 1.294224, loss_ss: 0.792728, loss_d: 0.501496
0.5385 --- loss: 0.979608, loss_ss: 0.771198, loss_d: 0.208410
0.5769 --- loss: 1.413316, loss_ss: 1.063039, loss_d: 0.350276
0.6154 --- loss: 1.162866, loss_ss: 0.842475, loss_d: 0.320391
0.6538 --- loss: 1.470635, loss_ss: 0.894137, loss_d: 0.576498
0.6923 --- loss: 1.279904, loss_ss: 0.881325, loss_d: 0.398579
0.7308 --- loss: 1.144356, loss_ss: 0.857636, loss_d: 0.286721
0.7692 --- loss: 0.915525, loss_ss: 0.730563, loss_d: 0.184963
0.8077 --- loss: 0.990198, loss_ss: 0.672992, loss_d: 0.317206
0.8462 --- loss: 0.984561, loss_ss: 0.891346, loss_d: 0.093215
0.8846 --- loss: 0.655886, loss_ss: 0.508220, loss_d: 0.147666
0.9231 --- loss: 0.934762, loss_ss: 0.835914, loss_d: 0.098847
0.9615 --- loss: 1.361464, loss_ss: 0.838979, loss_d: 0.522485
Epoch finished! Loss: 1.1869621541509296
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.881424, loss_ss: 0.731879, loss_d: 0.149545
0.0385 --- loss: 1.153264, loss_ss: 1.007488, loss_d: 0.145776
0.0769 --- loss: 0.852359, loss_ss: 0.727988, loss_d: 0.124370
0.1154 --- loss: 0.920861, loss_ss: 0.770662, loss_d: 0.150199
0.1538 --- loss: 1.212332, loss_ss: 0.950212, loss_d: 0.262121
0.1923 --- loss: 1.035042, loss_ss: 0.889448, loss_d: 0.145595
0.2308 --- loss: 1.720928, loss_ss: 1.327094, loss_d: 0.393833
0.2692 --- loss: 0.914600, loss_ss: 0.850315, loss_d: 0.064285
0.3077 --- loss: 1.536489, loss_ss: 1.155525, loss_d: 0.380964
0.3462 --- loss: 1.449137, loss_ss: 1.231631, loss_d: 0.217506
0.3846 --- loss: 0.985090, loss_ss: 0.846978, loss_d: 0.138112
0.4231 --- loss: 1.751892, loss_ss: 0.715559, loss_d: 1.036333
0.4615 --- loss: 0.919223, loss_ss: 0.733215, loss_d: 0.186008
0.5000 --- loss: 1.124384, loss_ss: 0.888751, loss_d: 0.235633
0.5385 --- loss: 1.151505, loss_ss: 0.868123, loss_d: 0.283382
0.5769 --- loss: 1.261464, loss_ss: 0.788285, loss_d: 0.473179
0.6154 --- loss: 0.856198, loss_ss: 0.731451, loss_d: 0.124747
0.6538 --- loss: 1.137276, loss_ss: 0.941809, loss_d: 0.195468
0.6923 --- loss: 1.148902, loss_ss: 0.623691, loss_d: 0.525211
0.7308 --- loss: 1.510455, loss_ss: 0.920211, loss_d: 0.590244
0.7692 --- loss: 1.212004, loss_ss: 0.851496, loss_d: 0.360508
0.8077 --- loss: 1.031222, loss_ss: 0.837344, loss_d: 0.193878
0.8462 --- loss: 1.129561, loss_ss: 0.770809, loss_d: 0.358752
0.8846 --- loss: 1.274293, loss_ss: 0.977930, loss_d: 0.296362
0.9231 --- loss: 0.820732, loss_ss: 0.676445, loss_d: 0.144287
0.9615 --- loss: 1.232632, loss_ss: 0.977139, loss_d: 0.255492
Epoch finished! Loss: 1.1231759567978759
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6412280701754386
             precision    recall  f1-score   support

        0.0       0.90      0.55      0.68       297
        1.0       0.41      0.17      0.24       200
        2.0       0.56      1.00      0.72       354
        3.0       1.00      0.62      0.77       159
        4.0       0.58      0.63      0.60       130

avg / total       0.68      0.64      0.62      1140
 


====== chp020-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  86.49   54.55   97.75   89.50     67.78
1  81.23   17.00   94.89   41.46     24.11
2  75.26  100.00   64.12   55.66     71.52
3  94.74   62.26  100.00  100.00     76.74
4  90.53   63.08   94.06   57.75     60.29
Total accuracy: 64.12%
Average sen: 59.38%
Average spec: 90.16%
Macro f1-score: 60.09%
[0.98808295 0.98499113 0.88940167 0.38126156 0.30443344 0.75580138
 0.3923749  0.92881781 0.83599734 0.92028785 0.95572603 0.99937171
 0.99733955 0.89697498 0.92447716 0.99898511 0.99944264 0.99227494
 0.99788159 0.9946056  0.86320901 0.82888973 0.99902856 0.99904555
 0.9942385  0.9950735  0.96742558 0.94030166 0.99695033 0.97774279
 0.98557681 0.8605907  0.93574816 0.91566497 0.99855214 0.9972589
 0.99901378 0.99417877]
pred: 0.9049215465784073, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.237952, loss_ss: 1.560501, loss_d: 0.677450
0.0385 --- loss: 1.742515, loss_ss: 1.458144, loss_d: 0.284371
0.0770 --- loss: 2.088210, loss_ss: 1.279509, loss_d: 0.808700
0.1156 --- loss: 1.872090, loss_ss: 1.297445, loss_d: 0.574645
0.1541 --- loss: 2.164227, loss_ss: 1.253639, loss_d: 0.910587
0.1926 --- loss: 2.008833, loss_ss: 1.434151, loss_d: 0.574682
0.2311 --- loss: 2.098462, loss_ss: 1.385890, loss_d: 0.712572
0.2696 --- loss: 2.183110, loss_ss: 1.374111, loss_d: 0.808999
0.3082 --- loss: 1.897570, loss_ss: 1.324058, loss_d: 0.573512
0.3467 --- loss: 2.123906, loss_ss: 1.356254, loss_d: 0.767653
0.3852 --- loss: 1.662250, loss_ss: 1.260896, loss_d: 0.401354
0.4237 --- loss: 1.820415, loss_ss: 1.183618, loss_d: 0.636797
0.4622 --- loss: 1.993468, loss_ss: 1.218012, loss_d: 0.775456
0.5008 --- loss: 1.825431, loss_ss: 1.235113, loss_d: 0.590318
0.5393 --- loss: 2.271310, loss_ss: 1.415433, loss_d: 0.855878
0.5778 --- loss: 2.001377, loss_ss: 1.095176, loss_d: 0.906201
0.6163 --- loss: 1.935184, loss_ss: 1.397799, loss_d: 0.537384
0.6549 --- loss: 1.771307, loss_ss: 1.213557, loss_d: 0.557749
0.6934 --- loss: 1.768682, loss_ss: 1.182389, loss_d: 0.586293
0.7319 --- loss: 1.662438, loss_ss: 1.219859, loss_d: 0.442579
0.7704 --- loss: 1.682900, loss_ss: 1.206779, loss_d: 0.476121
0.8089 --- loss: 1.898809, loss_ss: 1.401571, loss_d: 0.497238
0.8475 --- loss: 1.868615, loss_ss: 1.182454, loss_d: 0.686161
0.8860 --- loss: 1.771065, loss_ss: 1.131834, loss_d: 0.639231
0.9245 --- loss: 1.833584, loss_ss: 1.421229, loss_d: 0.412355
0.9630 --- loss: 1.815529, loss_ss: 1.339105, loss_d: 0.476424
Epoch finished! Loss: 1.9024929429573443
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.587441, loss_ss: 1.125941, loss_d: 0.461500
0.0385 --- loss: 1.762507, loss_ss: 1.045786, loss_d: 0.716721
0.0770 --- loss: 1.770036, loss_ss: 1.220136, loss_d: 0.549900
0.1156 --- loss: 1.375146, loss_ss: 0.948723, loss_d: 0.426424
0.1541 --- loss: 2.494054, loss_ss: 1.600659, loss_d: 0.893395
0.1926 --- loss: 1.900679, loss_ss: 1.152371, loss_d: 0.748308
0.2311 --- loss: 1.592186, loss_ss: 0.891208, loss_d: 0.700979
0.2696 --- loss: 1.597007, loss_ss: 1.137295, loss_d: 0.459712
0.3082 --- loss: 1.811266, loss_ss: 1.121227, loss_d: 0.690039
0.3467 --- loss: 1.649582, loss_ss: 0.979932, loss_d: 0.669650
0.3852 --- loss: 1.339171, loss_ss: 0.821361, loss_d: 0.517810
0.4237 --- loss: 1.537045, loss_ss: 1.067759, loss_d: 0.469286
0.4622 --- loss: 1.707558, loss_ss: 0.898323, loss_d: 0.809236
0.5008 --- loss: 1.417049, loss_ss: 0.911728, loss_d: 0.505322
0.5393 --- loss: 1.657516, loss_ss: 1.008046, loss_d: 0.649471
0.5778 --- loss: 1.697925, loss_ss: 0.950993, loss_d: 0.746933
0.6163 --- loss: 1.586109, loss_ss: 0.990356, loss_d: 0.595752
0.6549 --- loss: 1.260346, loss_ss: 0.895383, loss_d: 0.364963
0.6934 --- loss: 1.748579, loss_ss: 1.157206, loss_d: 0.591373
0.7319 --- loss: 2.031054, loss_ss: 1.540327, loss_d: 0.490728
0.7704 --- loss: 1.868019, loss_ss: 1.300965, loss_d: 0.567053
0.8089 --- loss: 1.869165, loss_ss: 1.124331, loss_d: 0.744834
0.8475 --- loss: 1.883017, loss_ss: 1.256979, loss_d: 0.626039
0.8860 --- loss: 1.431164, loss_ss: 0.929566, loss_d: 0.501598
0.9245 --- loss: 1.436594, loss_ss: 0.958862, loss_d: 0.477731
0.9630 --- loss: 1.552296, loss_ss: 1.057189, loss_d: 0.495107
Epoch finished! Loss: 1.6780173497770743
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.246768, loss_ss: 0.976457, loss_d: 0.270311
0.0385 --- loss: 1.723614, loss_ss: 1.040083, loss_d: 0.683531
0.0770 --- loss: 1.607661, loss_ss: 0.850809, loss_d: 0.756852
0.1156 --- loss: 1.511428, loss_ss: 1.118322, loss_d: 0.393106
0.1541 --- loss: 1.354625, loss_ss: 0.828144, loss_d: 0.526481
0.1926 --- loss: 1.613190, loss_ss: 1.064735, loss_d: 0.548455
0.2311 --- loss: 1.282105, loss_ss: 0.810360, loss_d: 0.471746
0.2696 --- loss: 1.866338, loss_ss: 1.394840, loss_d: 0.471497
0.3082 --- loss: 1.514762, loss_ss: 1.257908, loss_d: 0.256854
0.3467 --- loss: 1.306204, loss_ss: 0.926431, loss_d: 0.379773
0.3852 --- loss: 1.584234, loss_ss: 0.990297, loss_d: 0.593937
0.4237 --- loss: 1.610435, loss_ss: 1.214851, loss_d: 0.395584
0.4622 --- loss: 1.607618, loss_ss: 1.024779, loss_d: 0.582839
0.5008 --- loss: 1.565009, loss_ss: 1.107945, loss_d: 0.457064
0.5393 --- loss: 1.274065, loss_ss: 0.962611, loss_d: 0.311455
0.5778 --- loss: 1.497770, loss_ss: 0.873902, loss_d: 0.623868
0.6163 --- loss: 1.411392, loss_ss: 0.996312, loss_d: 0.415080
0.6549 --- loss: 1.219179, loss_ss: 0.985100, loss_d: 0.234079
0.6934 --- loss: 1.380406, loss_ss: 1.080176, loss_d: 0.300230
0.7319 --- loss: 1.330559, loss_ss: 0.890259, loss_d: 0.440300
0.7704 --- loss: 1.696942, loss_ss: 1.000010, loss_d: 0.696932
0.8089 --- loss: 1.916809, loss_ss: 1.430327, loss_d: 0.486482
0.8475 --- loss: 1.330965, loss_ss: 0.994895, loss_d: 0.336070
0.8860 --- loss: 1.201460, loss_ss: 0.707064, loss_d: 0.494397
0.9245 --- loss: 1.912169, loss_ss: 1.374129, loss_d: 0.538040
0.9630 --- loss: 1.415685, loss_ss: 0.830120, loss_d: 0.585565
Epoch finished! Loss: 1.564963530849766
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.479145, loss_ss: 1.184449, loss_d: 0.294697
0.0385 --- loss: 1.187100, loss_ss: 0.880240, loss_d: 0.306859
0.0770 --- loss: 1.414860, loss_ss: 0.921999, loss_d: 0.492862
0.1156 --- loss: 1.490535, loss_ss: 0.916051, loss_d: 0.574485
0.1541 --- loss: 1.901849, loss_ss: 0.902102, loss_d: 0.999747
0.1926 --- loss: 1.657674, loss_ss: 0.995533, loss_d: 0.662141
0.2311 --- loss: 1.197726, loss_ss: 0.987244, loss_d: 0.210483
0.2696 --- loss: 1.291994, loss_ss: 1.035993, loss_d: 0.256001
0.3082 --- loss: 1.284404, loss_ss: 1.026562, loss_d: 0.257842
0.3467 --- loss: 1.782617, loss_ss: 1.092419, loss_d: 0.690198
0.3852 --- loss: 1.869909, loss_ss: 1.152245, loss_d: 0.717664
0.4237 --- loss: 1.343048, loss_ss: 0.983970, loss_d: 0.359079
0.4622 --- loss: 1.235431, loss_ss: 0.869017, loss_d: 0.366414
0.5008 --- loss: 1.396265, loss_ss: 0.985369, loss_d: 0.410896
0.5393 --- loss: 1.584902, loss_ss: 1.167662, loss_d: 0.417240
0.5778 --- loss: 1.488538, loss_ss: 0.906488, loss_d: 0.582050
0.6163 --- loss: 1.424689, loss_ss: 1.148589, loss_d: 0.276100
0.6549 --- loss: 1.615396, loss_ss: 0.994019, loss_d: 0.621377
0.6934 --- loss: 1.132795, loss_ss: 0.912760, loss_d: 0.220035
0.7319 --- loss: 1.737537, loss_ss: 1.514168, loss_d: 0.223369
0.7704 --- loss: 1.255344, loss_ss: 0.913951, loss_d: 0.341393
0.8089 --- loss: 1.435381, loss_ss: 0.914908, loss_d: 0.520473
0.8475 --- loss: 1.348423, loss_ss: 0.799464, loss_d: 0.548959
0.8860 --- loss: 1.489245, loss_ss: 0.965172, loss_d: 0.524073
0.9245 --- loss: 1.484735, loss_ss: 0.830672, loss_d: 0.654062
0.9630 --- loss: 2.012340, loss_ss: 0.964752, loss_d: 1.047588
Epoch finished! Loss: 1.4686303290621194
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.589392, loss_ss: 1.157087, loss_d: 0.432304
0.0385 --- loss: 1.364068, loss_ss: 0.679693, loss_d: 0.684375
0.0770 --- loss: 1.256935, loss_ss: 0.940178, loss_d: 0.316757
0.1156 --- loss: 1.390011, loss_ss: 1.184794, loss_d: 0.205217
0.1541 --- loss: 1.491016, loss_ss: 0.988831, loss_d: 0.502185
0.1926 --- loss: 1.441809, loss_ss: 1.127340, loss_d: 0.314469
0.2311 --- loss: 1.381625, loss_ss: 0.916198, loss_d: 0.465427
0.2696 --- loss: 1.518511, loss_ss: 0.968337, loss_d: 0.550173
0.3082 --- loss: 1.274935, loss_ss: 0.982371, loss_d: 0.292564
0.3467 --- loss: 1.158771, loss_ss: 0.836612, loss_d: 0.322159
0.3852 --- loss: 2.013455, loss_ss: 1.316736, loss_d: 0.696719
0.4237 --- loss: 1.244272, loss_ss: 0.936360, loss_d: 0.307912
0.4622 --- loss: 1.348114, loss_ss: 1.057388, loss_d: 0.290726
0.5008 --- loss: 1.533288, loss_ss: 1.287901, loss_d: 0.245386
0.5393 --- loss: 1.268986, loss_ss: 1.034976, loss_d: 0.234010
0.5778 --- loss: 1.374103, loss_ss: 0.980976, loss_d: 0.393127
0.6163 --- loss: 1.545488, loss_ss: 0.968167, loss_d: 0.577321
0.6549 --- loss: 1.246448, loss_ss: 0.953172, loss_d: 0.293276
0.6934 --- loss: 1.361978, loss_ss: 0.686459, loss_d: 0.675519
0.7319 --- loss: 1.388745, loss_ss: 0.848088, loss_d: 0.540657
0.7704 --- loss: 1.415892, loss_ss: 1.095026, loss_d: 0.320867
0.8089 --- loss: 1.135654, loss_ss: 0.794617, loss_d: 0.341037
0.8475 --- loss: 0.914471, loss_ss: 0.739115, loss_d: 0.175357
0.8860 --- loss: 0.975829, loss_ss: 0.864190, loss_d: 0.111638
0.9245 --- loss: 1.222444, loss_ss: 0.985579, loss_d: 0.236865
0.9630 --- loss: 1.202084, loss_ss: 0.879692, loss_d: 0.322392
Epoch finished! Loss: 1.4032634001901252
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.151099, loss_ss: 0.899993, loss_d: 0.251105
0.0385 --- loss: 1.653512, loss_ss: 1.182443, loss_d: 0.471069
0.0770 --- loss: 1.125328, loss_ss: 0.801295, loss_d: 0.324033
0.1156 --- loss: 1.465186, loss_ss: 1.032908, loss_d: 0.432278
0.1541 --- loss: 1.350180, loss_ss: 0.959473, loss_d: 0.390708
0.1926 --- loss: 1.446876, loss_ss: 0.898683, loss_d: 0.548193
0.2311 --- loss: 1.052252, loss_ss: 0.776432, loss_d: 0.275820
0.2696 --- loss: 1.338905, loss_ss: 1.042755, loss_d: 0.296150
0.3082 --- loss: 1.278510, loss_ss: 0.967137, loss_d: 0.311373
0.3467 --- loss: 1.553468, loss_ss: 1.019858, loss_d: 0.533611
0.3852 --- loss: 1.150960, loss_ss: 0.987303, loss_d: 0.163657
0.4237 --- loss: 1.471418, loss_ss: 1.098669, loss_d: 0.372749
0.4622 --- loss: 1.085180, loss_ss: 0.737056, loss_d: 0.348125
0.5008 --- loss: 1.260682, loss_ss: 0.865501, loss_d: 0.395181
0.5393 --- loss: 1.433825, loss_ss: 0.914432, loss_d: 0.519393
0.5778 --- loss: 1.572000, loss_ss: 1.091901, loss_d: 0.480099
0.6163 --- loss: 1.213474, loss_ss: 0.966279, loss_d: 0.247195
0.6549 --- loss: 1.109711, loss_ss: 0.958930, loss_d: 0.150781
0.6934 --- loss: 2.010033, loss_ss: 0.950802, loss_d: 1.059231
0.7319 --- loss: 1.091100, loss_ss: 0.854820, loss_d: 0.236280
0.7704 --- loss: 1.735191, loss_ss: 1.115237, loss_d: 0.619953
0.8089 --- loss: 1.423214, loss_ss: 1.163838, loss_d: 0.259376
0.8475 --- loss: 1.085008, loss_ss: 0.901029, loss_d: 0.183979
0.8860 --- loss: 1.080060, loss_ss: 0.878321, loss_d: 0.201740
0.9245 --- loss: 1.135016, loss_ss: 0.703098, loss_d: 0.431918
0.9630 --- loss: 1.160677, loss_ss: 0.933184, loss_d: 0.227493
Epoch finished! Loss: 1.3097879274471387
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.964699, loss_ss: 0.726162, loss_d: 0.238537
0.0385 --- loss: 0.945655, loss_ss: 0.786835, loss_d: 0.158820
0.0770 --- loss: 1.260304, loss_ss: 0.850653, loss_d: 0.409650
0.1156 --- loss: 1.262519, loss_ss: 0.908976, loss_d: 0.353543
0.1541 --- loss: 0.870775, loss_ss: 0.722079, loss_d: 0.148696
0.1926 --- loss: 1.091249, loss_ss: 0.860232, loss_d: 0.231018
0.2311 --- loss: 1.407714, loss_ss: 0.937170, loss_d: 0.470544
0.2696 --- loss: 1.173399, loss_ss: 0.952840, loss_d: 0.220559
0.3082 --- loss: 1.237317, loss_ss: 0.982060, loss_d: 0.255257
0.3467 --- loss: 1.437837, loss_ss: 1.045094, loss_d: 0.392743
0.3852 --- loss: 1.650599, loss_ss: 0.989443, loss_d: 0.661156
0.4237 --- loss: 1.087862, loss_ss: 0.855734, loss_d: 0.232128
0.4622 --- loss: 1.045594, loss_ss: 0.804187, loss_d: 0.241407
0.5008 --- loss: 0.968731, loss_ss: 0.682520, loss_d: 0.286211
0.5393 --- loss: 1.346261, loss_ss: 0.885279, loss_d: 0.460982
0.5778 --- loss: 1.212075, loss_ss: 0.854538, loss_d: 0.357537
0.6163 --- loss: 1.080720, loss_ss: 0.780343, loss_d: 0.300377
0.6549 --- loss: 1.204180, loss_ss: 0.839042, loss_d: 0.365138
0.6934 --- loss: 1.167706, loss_ss: 0.848135, loss_d: 0.319572
0.7319 --- loss: 1.329289, loss_ss: 0.761020, loss_d: 0.568270
0.7704 --- loss: 1.183751, loss_ss: 0.975071, loss_d: 0.208680
0.8089 --- loss: 1.149826, loss_ss: 0.874068, loss_d: 0.275758
0.8475 --- loss: 1.264411, loss_ss: 0.992558, loss_d: 0.271853
0.8860 --- loss: 1.295351, loss_ss: 0.709495, loss_d: 0.585856
0.9245 --- loss: 1.373330, loss_ss: 0.729148, loss_d: 0.644182
0.9630 --- loss: 1.203650, loss_ss: 0.895830, loss_d: 0.307819
Epoch finished! Loss: 1.293863078572115
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.136331, loss_ss: 0.806988, loss_d: 0.329343
0.0385 --- loss: 1.023114, loss_ss: 0.876117, loss_d: 0.146997
0.0770 --- loss: 1.080953, loss_ss: 0.848894, loss_d: 0.232059
0.1156 --- loss: 1.139085, loss_ss: 0.652267, loss_d: 0.486818
0.1541 --- loss: 1.089912, loss_ss: 0.866664, loss_d: 0.223248
0.1926 --- loss: 1.119495, loss_ss: 0.909713, loss_d: 0.209783
0.2311 --- loss: 0.819329, loss_ss: 0.687512, loss_d: 0.131817
0.2696 --- loss: 1.071527, loss_ss: 0.644310, loss_d: 0.427217
0.3082 --- loss: 1.124979, loss_ss: 0.812621, loss_d: 0.312358
0.3467 --- loss: 1.707628, loss_ss: 0.925187, loss_d: 0.782442
0.3852 --- loss: 1.501744, loss_ss: 1.229230, loss_d: 0.272513
0.4237 --- loss: 1.177980, loss_ss: 0.728376, loss_d: 0.449604
0.4622 --- loss: 1.258807, loss_ss: 1.095617, loss_d: 0.163191
0.5008 --- loss: 1.293687, loss_ss: 0.853977, loss_d: 0.439710
0.5393 --- loss: 1.153932, loss_ss: 0.734368, loss_d: 0.419565
0.5778 --- loss: 1.136365, loss_ss: 1.039573, loss_d: 0.096792
0.6163 --- loss: 1.842084, loss_ss: 1.235881, loss_d: 0.606203
0.6549 --- loss: 0.915156, loss_ss: 0.653351, loss_d: 0.261805
0.6934 --- loss: 1.248752, loss_ss: 0.913659, loss_d: 0.335092
0.7319 --- loss: 1.103291, loss_ss: 0.928254, loss_d: 0.175038
0.7704 --- loss: 1.319325, loss_ss: 0.735579, loss_d: 0.583745
0.8089 --- loss: 1.224424, loss_ss: 0.927661, loss_d: 0.296762
0.8475 --- loss: 1.308977, loss_ss: 1.078421, loss_d: 0.230555
0.8860 --- loss: 1.142375, loss_ss: 0.808090, loss_d: 0.334285
0.9245 --- loss: 0.761297, loss_ss: 0.536282, loss_d: 0.225014
0.9630 --- loss: 1.185365, loss_ss: 0.731022, loss_d: 0.454343
Epoch finished! Loss: 1.243457482588337
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.948916, loss_ss: 0.605833, loss_d: 0.343082
0.0385 --- loss: 1.333384, loss_ss: 0.831862, loss_d: 0.501522
0.0770 --- loss: 1.640485, loss_ss: 1.238446, loss_d: 0.402039
0.1156 --- loss: 0.933939, loss_ss: 0.745037, loss_d: 0.188902
0.1541 --- loss: 0.949585, loss_ss: 0.813150, loss_d: 0.136435
0.1926 --- loss: 0.987592, loss_ss: 0.709513, loss_d: 0.278079
0.2311 --- loss: 0.697459, loss_ss: 0.622175, loss_d: 0.075284
0.2696 --- loss: 1.273595, loss_ss: 0.662239, loss_d: 0.611356
0.3082 --- loss: 1.302961, loss_ss: 1.089501, loss_d: 0.213460
0.3467 --- loss: 1.216545, loss_ss: 0.814260, loss_d: 0.402285
0.3852 --- loss: 0.951071, loss_ss: 0.784547, loss_d: 0.166525
0.4237 --- loss: 1.659523, loss_ss: 0.822111, loss_d: 0.837412
0.4622 --- loss: 1.711181, loss_ss: 1.016603, loss_d: 0.694577
0.5008 --- loss: 1.093738, loss_ss: 0.661776, loss_d: 0.431962
0.5393 --- loss: 1.074953, loss_ss: 0.848468, loss_d: 0.226486
0.5778 --- loss: 1.139428, loss_ss: 0.738178, loss_d: 0.401250
0.6163 --- loss: 1.559950, loss_ss: 1.132714, loss_d: 0.427237
0.6549 --- loss: 0.875705, loss_ss: 0.743684, loss_d: 0.132021
0.6934 --- loss: 0.859622, loss_ss: 0.692188, loss_d: 0.167434
0.7319 --- loss: 1.621218, loss_ss: 1.012486, loss_d: 0.608733
0.7704 --- loss: 0.925227, loss_ss: 0.725204, loss_d: 0.200023
0.8089 --- loss: 1.260333, loss_ss: 1.028852, loss_d: 0.231481
0.8475 --- loss: 1.145994, loss_ss: 0.736674, loss_d: 0.409320
0.8860 --- loss: 1.226170, loss_ss: 0.612000, loss_d: 0.614169
0.9245 --- loss: 1.178749, loss_ss: 0.930219, loss_d: 0.248530
0.9630 --- loss: 1.508664, loss_ss: 0.761715, loss_d: 0.746949
Epoch finished! Loss: 1.2192018522258892
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.353631, loss_ss: 0.957434, loss_d: 0.396198
0.0385 --- loss: 1.149986, loss_ss: 0.738869, loss_d: 0.411117
0.0770 --- loss: 1.391979, loss_ss: 0.914337, loss_d: 0.477642
0.1156 --- loss: 1.393076, loss_ss: 1.192455, loss_d: 0.200620
0.1541 --- loss: 1.119964, loss_ss: 0.889268, loss_d: 0.230696
0.1926 --- loss: 1.023621, loss_ss: 0.661638, loss_d: 0.361984
0.2311 --- loss: 1.182318, loss_ss: 0.805256, loss_d: 0.377062
0.2696 --- loss: 0.994433, loss_ss: 0.651364, loss_d: 0.343069
0.3082 --- loss: 0.878476, loss_ss: 0.678672, loss_d: 0.199804
0.3467 --- loss: 1.242061, loss_ss: 0.976847, loss_d: 0.265214
0.3852 --- loss: 1.338272, loss_ss: 1.091454, loss_d: 0.246818
0.4237 --- loss: 0.886720, loss_ss: 0.728778, loss_d: 0.157943
0.4622 --- loss: 1.184565, loss_ss: 0.793310, loss_d: 0.391254
0.5008 --- loss: 1.148044, loss_ss: 1.032894, loss_d: 0.115149
0.5393 --- loss: 1.126327, loss_ss: 0.895250, loss_d: 0.231077
0.5778 --- loss: 0.983477, loss_ss: 0.768165, loss_d: 0.215312
0.6163 --- loss: 1.081341, loss_ss: 0.776589, loss_d: 0.304752
0.6549 --- loss: 0.913099, loss_ss: 0.736903, loss_d: 0.176197
0.6934 --- loss: 1.064130, loss_ss: 0.843649, loss_d: 0.220481
0.7319 --- loss: 1.301264, loss_ss: 0.949852, loss_d: 0.351412
0.7704 --- loss: 1.924769, loss_ss: 1.397177, loss_d: 0.527592
0.8089 --- loss: 0.943678, loss_ss: 0.868592, loss_d: 0.075086
0.8475 --- loss: 1.267207, loss_ss: 0.675793, loss_d: 0.591414
0.8860 --- loss: 1.312609, loss_ss: 0.851752, loss_d: 0.460856
0.9245 --- loss: 0.920911, loss_ss: 0.747483, loss_d: 0.173428
0.9630 --- loss: 1.169272, loss_ss: 1.009495, loss_d: 0.159777
Epoch finished! Loss: 1.160592702825097
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6015873015873016
             precision    recall  f1-score   support

        0.0       0.67      0.83      0.74       253
        1.0       0.85      0.08      0.14       293
        2.0       0.65      0.68      0.67       468
        3.0       0.41      1.00      0.58       107
        4.0       0.58      0.71      0.64       139

avg / total       0.67      0.60      0.55      1260
 


====== chp022-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  88.49   83.40   89.77  67.20     74.43
1  78.25    7.85   99.59  85.19     14.38
2  74.60   67.95   78.54  65.16     66.53
3  87.94  100.00   86.82  41.31     58.47
4  91.03   71.22   93.49  57.56     63.67
Total accuracy: 60.16%
Average sen: 66.08%
Average spec: 89.64%
Macro f1-score: 55.49%
[0.38314769 0.11588844 0.49326229 0.195483   0.53703034 0.71710688
 0.93381274 0.78467113 0.95436937 0.91685688 0.76745725 0.95505714
 0.9943763  0.6987766  0.99697614 0.99771994 0.9958691  0.94426781
 0.99698824 0.98756301 0.81193054 0.67287356 0.99555355 0.98720831
 0.99163568 0.72867614 0.65183842 0.93554527 0.96186662 0.48717064
 0.5850867  0.87215531 0.95520222 0.92911994 0.76882684 0.88390243
 0.38010985 0.81905168 0.98340976 0.98783767 0.89441335 0.99546367]
pred: 0.8010847247427418, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.328717, loss_ss: 1.652488, loss_d: 0.676229
0.0384 --- loss: 2.314404, loss_ss: 1.540958, loss_d: 0.773446
0.0769 --- loss: 2.385466, loss_ss: 1.676716, loss_d: 0.708750
0.1153 --- loss: 2.166095, loss_ss: 1.636326, loss_d: 0.529770
0.1538 --- loss: 1.705263, loss_ss: 1.263464, loss_d: 0.441798
0.1922 --- loss: 2.083448, loss_ss: 1.359636, loss_d: 0.723812
0.2307 --- loss: 2.066374, loss_ss: 1.273301, loss_d: 0.793073
0.2691 --- loss: 1.735032, loss_ss: 1.187475, loss_d: 0.547556
0.3076 --- loss: 1.779545, loss_ss: 1.229430, loss_d: 0.550115
0.3460 --- loss: 2.085381, loss_ss: 1.472492, loss_d: 0.612889
0.3845 --- loss: 2.155132, loss_ss: 1.484170, loss_d: 0.670963
0.4229 --- loss: 2.012953, loss_ss: 1.302399, loss_d: 0.710554
0.4614 --- loss: 1.780128, loss_ss: 1.354576, loss_d: 0.425552
0.4998 --- loss: 1.743048, loss_ss: 1.238724, loss_d: 0.504324
0.5383 --- loss: 2.127981, loss_ss: 1.295460, loss_d: 0.832521
0.5767 --- loss: 1.820651, loss_ss: 1.252110, loss_d: 0.568541
0.6151 --- loss: 1.656611, loss_ss: 1.105405, loss_d: 0.551206
0.6536 --- loss: 1.989836, loss_ss: 1.426986, loss_d: 0.562851
0.6920 --- loss: 1.561362, loss_ss: 1.257065, loss_d: 0.304297
0.7305 --- loss: 1.792341, loss_ss: 1.229935, loss_d: 0.562405
0.7689 --- loss: 1.763003, loss_ss: 1.287764, loss_d: 0.475238
0.8074 --- loss: 1.624548, loss_ss: 1.086844, loss_d: 0.537704
0.8458 --- loss: 1.899466, loss_ss: 1.370921, loss_d: 0.528545
0.8843 --- loss: 1.670120, loss_ss: 1.037733, loss_d: 0.632387
0.9227 --- loss: 1.803104, loss_ss: 1.163662, loss_d: 0.639442
0.9612 --- loss: 1.952867, loss_ss: 1.353161, loss_d: 0.599706
0.9996 --- loss: 2.250174, loss_ss: 1.975288, loss_d: 0.274886
Epoch finished! Loss: 1.8981152942547432
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.576966, loss_ss: 0.981203, loss_d: 0.595762
0.0384 --- loss: 2.131414, loss_ss: 1.345214, loss_d: 0.786200
0.0769 --- loss: 1.739525, loss_ss: 0.874069, loss_d: 0.865456
0.1153 --- loss: 1.721163, loss_ss: 0.958467, loss_d: 0.762697
0.1538 --- loss: 1.596976, loss_ss: 1.095065, loss_d: 0.501911
0.1922 --- loss: 1.554107, loss_ss: 1.154352, loss_d: 0.399755
0.2307 --- loss: 2.316568, loss_ss: 1.103949, loss_d: 1.212619
0.2691 --- loss: 1.800068, loss_ss: 1.279054, loss_d: 0.521014
0.3076 --- loss: 1.532022, loss_ss: 1.062065, loss_d: 0.469956
0.3460 --- loss: 1.703671, loss_ss: 1.227949, loss_d: 0.475722
0.3845 --- loss: 1.398945, loss_ss: 0.908103, loss_d: 0.490842
0.4229 --- loss: 1.570538, loss_ss: 1.032556, loss_d: 0.537982
0.4614 --- loss: 1.708946, loss_ss: 1.037940, loss_d: 0.671007
0.4998 --- loss: 2.022004, loss_ss: 1.315157, loss_d: 0.706847
0.5383 --- loss: 1.752254, loss_ss: 1.023493, loss_d: 0.728761
0.5767 --- loss: 1.760332, loss_ss: 1.108948, loss_d: 0.651385
0.6151 --- loss: 1.503736, loss_ss: 0.991997, loss_d: 0.511739
0.6536 --- loss: 2.242023, loss_ss: 1.423012, loss_d: 0.819011
0.6920 --- loss: 1.676662, loss_ss: 1.124681, loss_d: 0.551982
0.7305 --- loss: 1.734765, loss_ss: 1.113341, loss_d: 0.621424
0.7689 --- loss: 1.697386, loss_ss: 1.166775, loss_d: 0.530611
0.8074 --- loss: 1.757666, loss_ss: 1.121519, loss_d: 0.636146
0.8458 --- loss: 1.716828, loss_ss: 0.975767, loss_d: 0.741061
0.8843 --- loss: 1.585057, loss_ss: 0.716354, loss_d: 0.868703
0.9227 --- loss: 1.755230, loss_ss: 1.217999, loss_d: 0.537232
0.9612 --- loss: 1.570085, loss_ss: 0.872642, loss_d: 0.697444
0.9996 --- loss: 2.575261, loss_ss: 2.273803, loss_d: 0.301457
Epoch finished! Loss: 1.6960419934529525
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.024467, loss_ss: 1.491910, loss_d: 0.532557
0.0384 --- loss: 1.449218, loss_ss: 1.148866, loss_d: 0.300352
0.0769 --- loss: 1.678364, loss_ss: 1.027656, loss_d: 0.650708
0.1153 --- loss: 1.801117, loss_ss: 1.215557, loss_d: 0.585561
0.1538 --- loss: 1.578014, loss_ss: 0.887458, loss_d: 0.690556
0.1922 --- loss: 1.652041, loss_ss: 1.058680, loss_d: 0.593361
0.2307 --- loss: 2.054433, loss_ss: 1.052905, loss_d: 1.001528
0.2691 --- loss: 1.488157, loss_ss: 1.003110, loss_d: 0.485047
0.3076 --- loss: 1.412624, loss_ss: 0.947720, loss_d: 0.464904
0.3460 --- loss: 1.607282, loss_ss: 1.107793, loss_d: 0.499489
0.3845 --- loss: 1.756902, loss_ss: 1.047857, loss_d: 0.709045
0.4229 --- loss: 1.479296, loss_ss: 1.111217, loss_d: 0.368079
0.4614 --- loss: 1.731152, loss_ss: 1.103047, loss_d: 0.628105
0.4998 --- loss: 1.674465, loss_ss: 0.891231, loss_d: 0.783234
0.5383 --- loss: 1.593771, loss_ss: 1.192136, loss_d: 0.401636
0.5767 --- loss: 1.473025, loss_ss: 1.132562, loss_d: 0.340463
0.6151 --- loss: 1.508276, loss_ss: 0.974882, loss_d: 0.533394
0.6536 --- loss: 1.646302, loss_ss: 0.946830, loss_d: 0.699472
0.6920 --- loss: 1.383387, loss_ss: 0.772089, loss_d: 0.611298
0.7305 --- loss: 1.445145, loss_ss: 0.847493, loss_d: 0.597652
0.7689 --- loss: 1.557530, loss_ss: 0.749729, loss_d: 0.807801
0.8074 --- loss: 1.655377, loss_ss: 1.068646, loss_d: 0.586731
0.8458 --- loss: 1.456180, loss_ss: 0.820543, loss_d: 0.635636
0.8843 --- loss: 1.528975, loss_ss: 0.989055, loss_d: 0.539920
0.9227 --- loss: 1.495004, loss_ss: 0.995019, loss_d: 0.499985
0.9612 --- loss: 1.514365, loss_ss: 1.000823, loss_d: 0.513542
0.9996 --- loss: 2.738600, loss_ss: 2.457332, loss_d: 0.281268
Epoch finished! Loss: 1.6054944767401769
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.965350, loss_ss: 1.403303, loss_d: 0.562047
0.0384 --- loss: 1.552094, loss_ss: 0.992759, loss_d: 0.559334
0.0769 --- loss: 1.569566, loss_ss: 0.957222, loss_d: 0.612344
0.1153 --- loss: 1.644788, loss_ss: 1.040685, loss_d: 0.604103
0.1538 --- loss: 1.162877, loss_ss: 0.701216, loss_d: 0.461661
0.1922 --- loss: 1.534960, loss_ss: 0.911253, loss_d: 0.623707
0.2307 --- loss: 1.336797, loss_ss: 0.935952, loss_d: 0.400845
0.2691 --- loss: 1.120531, loss_ss: 0.734631, loss_d: 0.385900
0.3076 --- loss: 1.571996, loss_ss: 0.970863, loss_d: 0.601133
0.3460 --- loss: 1.531463, loss_ss: 0.915550, loss_d: 0.615913
0.3845 --- loss: 1.671962, loss_ss: 1.003425, loss_d: 0.668537
0.4229 --- loss: 1.512936, loss_ss: 1.026858, loss_d: 0.486078
0.4614 --- loss: 1.420082, loss_ss: 0.834161, loss_d: 0.585921
0.4998 --- loss: 2.044550, loss_ss: 1.489039, loss_d: 0.555511
0.5383 --- loss: 1.425333, loss_ss: 0.892278, loss_d: 0.533055
0.5767 --- loss: 1.462427, loss_ss: 0.716204, loss_d: 0.746224
0.6151 --- loss: 1.475586, loss_ss: 0.768752, loss_d: 0.706834
0.6536 --- loss: 1.651031, loss_ss: 0.840681, loss_d: 0.810350
0.6920 --- loss: 1.718019, loss_ss: 1.131196, loss_d: 0.586823
0.7305 --- loss: 1.479822, loss_ss: 0.827302, loss_d: 0.652520
0.7689 --- loss: 1.786043, loss_ss: 0.883599, loss_d: 0.902444
0.8074 --- loss: 1.342991, loss_ss: 0.874348, loss_d: 0.468643
0.8458 --- loss: 1.797929, loss_ss: 1.359278, loss_d: 0.438651
0.8843 --- loss: 1.912817, loss_ss: 1.287497, loss_d: 0.625320
0.9227 --- loss: 1.249207, loss_ss: 0.703329, loss_d: 0.545878
0.9612 --- loss: 1.875283, loss_ss: 0.887286, loss_d: 0.987997
0.9996 --- loss: 2.576537, loss_ss: 2.229270, loss_d: 0.347268
Epoch finished! Loss: 1.5493995336385873
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.508227, loss_ss: 0.868150, loss_d: 0.640077
0.0384 --- loss: 1.627579, loss_ss: 0.928958, loss_d: 0.698621
0.0769 --- loss: 1.240512, loss_ss: 0.972869, loss_d: 0.267643
0.1153 --- loss: 1.466270, loss_ss: 0.896483, loss_d: 0.569787
0.1538 --- loss: 1.821434, loss_ss: 0.853424, loss_d: 0.968010
0.1922 --- loss: 1.575977, loss_ss: 1.052915, loss_d: 0.523062
0.2307 --- loss: 1.395853, loss_ss: 0.851307, loss_d: 0.544546
0.2691 --- loss: 1.918822, loss_ss: 1.421047, loss_d: 0.497775
0.3076 --- loss: 1.650911, loss_ss: 1.013398, loss_d: 0.637514
0.3460 --- loss: 1.582207, loss_ss: 0.855713, loss_d: 0.726493
0.3845 --- loss: 1.647985, loss_ss: 1.111753, loss_d: 0.536231
0.4229 --- loss: 1.589667, loss_ss: 0.909765, loss_d: 0.679902
0.4614 --- loss: 1.408659, loss_ss: 0.839049, loss_d: 0.569610
0.4998 --- loss: 1.513463, loss_ss: 0.917514, loss_d: 0.595949
0.5383 --- loss: 1.653701, loss_ss: 1.028122, loss_d: 0.625579
0.5767 --- loss: 1.384901, loss_ss: 0.894747, loss_d: 0.490155
0.6151 --- loss: 1.707171, loss_ss: 1.302098, loss_d: 0.405073
0.6536 --- loss: 1.527934, loss_ss: 1.117066, loss_d: 0.410868
0.6920 --- loss: 1.467269, loss_ss: 0.893857, loss_d: 0.573412
0.7305 --- loss: 1.153012, loss_ss: 0.819972, loss_d: 0.333040
0.7689 --- loss: 1.335141, loss_ss: 0.982510, loss_d: 0.352631
0.8074 --- loss: 1.507782, loss_ss: 0.724751, loss_d: 0.783031
0.8458 --- loss: 1.058482, loss_ss: 0.605440, loss_d: 0.453042
0.8843 --- loss: 1.472641, loss_ss: 0.884559, loss_d: 0.588082
0.9227 --- loss: 1.176386, loss_ss: 0.816337, loss_d: 0.360049
0.9612 --- loss: 1.426861, loss_ss: 1.025162, loss_d: 0.401699
0.9996 --- loss: 4.201425, loss_ss: 2.431043, loss_d: 1.770381
Epoch finished! Loss: 1.4940283346634644
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.373006, loss_ss: 0.942648, loss_d: 0.430358
0.0384 --- loss: 1.887969, loss_ss: 1.107329, loss_d: 0.780640
0.0769 --- loss: 1.398089, loss_ss: 0.775517, loss_d: 0.622572
0.1153 --- loss: 1.224167, loss_ss: 0.945941, loss_d: 0.278227
0.1538 --- loss: 2.009520, loss_ss: 1.405692, loss_d: 0.603827
0.1922 --- loss: 1.491138, loss_ss: 1.108993, loss_d: 0.382144
0.2307 --- loss: 1.532194, loss_ss: 0.953687, loss_d: 0.578508
0.2691 --- loss: 1.581917, loss_ss: 0.689684, loss_d: 0.892233
0.3076 --- loss: 1.464046, loss_ss: 0.803383, loss_d: 0.660663
0.3460 --- loss: 1.616524, loss_ss: 1.056561, loss_d: 0.559962
0.3845 --- loss: 1.367841, loss_ss: 0.983537, loss_d: 0.384305
0.4229 --- loss: 1.344154, loss_ss: 0.889692, loss_d: 0.454462
0.4614 --- loss: 1.636696, loss_ss: 1.077253, loss_d: 0.559443
0.4998 --- loss: 1.527382, loss_ss: 0.855155, loss_d: 0.672227
0.5383 --- loss: 1.248516, loss_ss: 0.912547, loss_d: 0.335968
0.5767 --- loss: 1.526876, loss_ss: 1.061148, loss_d: 0.465728
0.6151 --- loss: 1.288892, loss_ss: 0.932061, loss_d: 0.356831
0.6536 --- loss: 1.669948, loss_ss: 1.185138, loss_d: 0.484810
0.6920 --- loss: 1.776711, loss_ss: 0.910150, loss_d: 0.866562
0.7305 --- loss: 1.288350, loss_ss: 0.985790, loss_d: 0.302560
0.7689 --- loss: 1.270762, loss_ss: 0.866126, loss_d: 0.404636
0.8074 --- loss: 1.861112, loss_ss: 0.924803, loss_d: 0.936309
0.8458 --- loss: 1.225529, loss_ss: 0.899674, loss_d: 0.325855
0.8843 --- loss: 1.386713, loss_ss: 0.982217, loss_d: 0.404496
0.9227 --- loss: 1.183403, loss_ss: 0.873558, loss_d: 0.309845
0.9612 --- loss: 1.874566, loss_ss: 1.391969, loss_d: 0.482598
0.9996 --- loss: 1.190918, loss_ss: 1.077361, loss_d: 0.113558
Epoch finished! Loss: 1.4063137822426282
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.580016, loss_ss: 0.751891, loss_d: 0.828125
0.0384 --- loss: 1.160244, loss_ss: 0.856456, loss_d: 0.303789
0.0769 --- loss: 1.445134, loss_ss: 0.754745, loss_d: 0.690389
0.1153 --- loss: 1.703457, loss_ss: 0.927831, loss_d: 0.775626
0.1538 --- loss: 1.489062, loss_ss: 1.096957, loss_d: 0.392105
0.1922 --- loss: 1.373476, loss_ss: 0.805073, loss_d: 0.568403
0.2307 --- loss: 1.788821, loss_ss: 1.155335, loss_d: 0.633486
0.2691 --- loss: 1.522153, loss_ss: 1.191175, loss_d: 0.330979
0.3076 --- loss: 1.319158, loss_ss: 0.889822, loss_d: 0.429336
0.3460 --- loss: 1.554417, loss_ss: 0.822056, loss_d: 0.732362
0.3845 --- loss: 1.086626, loss_ss: 0.806814, loss_d: 0.279812
0.4229 --- loss: 1.696292, loss_ss: 1.038112, loss_d: 0.658181
0.4614 --- loss: 1.525194, loss_ss: 1.069269, loss_d: 0.455925
0.4998 --- loss: 1.108657, loss_ss: 0.787764, loss_d: 0.320893
0.5383 --- loss: 1.230965, loss_ss: 0.840228, loss_d: 0.390737
0.5767 --- loss: 0.991250, loss_ss: 0.741183, loss_d: 0.250067
0.6151 --- loss: 0.855931, loss_ss: 0.471410, loss_d: 0.384521
0.6536 --- loss: 1.210189, loss_ss: 0.965816, loss_d: 0.244373
0.6920 --- loss: 1.688217, loss_ss: 0.895733, loss_d: 0.792484
0.7305 --- loss: 0.846821, loss_ss: 0.721672, loss_d: 0.125149
0.7689 --- loss: 1.075778, loss_ss: 0.920896, loss_d: 0.154882
0.8074 --- loss: 1.547105, loss_ss: 0.976152, loss_d: 0.570954
0.8458 --- loss: 1.145288, loss_ss: 0.895119, loss_d: 0.250169
0.8843 --- loss: 1.275725, loss_ss: 0.885721, loss_d: 0.390004
0.9227 --- loss: 1.183913, loss_ss: 0.882234, loss_d: 0.301679
0.9612 --- loss: 1.283218, loss_ss: 0.878116, loss_d: 0.405102
0.9996 --- loss: 0.837587, loss_ss: 0.756175, loss_d: 0.081412
Epoch finished! Loss: 1.3579981826818905
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.940581, loss_ss: 0.656463, loss_d: 0.284118
0.0384 --- loss: 1.526614, loss_ss: 1.174993, loss_d: 0.351621
0.0769 --- loss: 1.188407, loss_ss: 0.676592, loss_d: 0.511815
0.1153 --- loss: 1.462057, loss_ss: 0.994832, loss_d: 0.467225
0.1538 --- loss: 1.530460, loss_ss: 1.219874, loss_d: 0.310586
0.1922 --- loss: 1.053096, loss_ss: 0.864874, loss_d: 0.188222
0.2307 --- loss: 1.396615, loss_ss: 1.140786, loss_d: 0.255829
0.2691 --- loss: 1.695242, loss_ss: 1.110633, loss_d: 0.584609
0.3076 --- loss: 1.564734, loss_ss: 0.833170, loss_d: 0.731564
0.3460 --- loss: 1.247813, loss_ss: 0.834210, loss_d: 0.413603
0.3845 --- loss: 1.135359, loss_ss: 0.891135, loss_d: 0.244224
0.4229 --- loss: 1.247050, loss_ss: 1.003417, loss_d: 0.243633
0.4614 --- loss: 1.146990, loss_ss: 0.810270, loss_d: 0.336720
0.4998 --- loss: 1.031248, loss_ss: 0.796295, loss_d: 0.234953
0.5383 --- loss: 1.232994, loss_ss: 0.974635, loss_d: 0.258359
0.5767 --- loss: 1.006893, loss_ss: 0.752798, loss_d: 0.254095
0.6151 --- loss: 0.939757, loss_ss: 0.678594, loss_d: 0.261162
0.6536 --- loss: 1.349898, loss_ss: 0.668416, loss_d: 0.681482
0.6920 --- loss: 1.405081, loss_ss: 0.908939, loss_d: 0.496142
0.7305 --- loss: 1.167809, loss_ss: 0.935258, loss_d: 0.232551
0.7689 --- loss: 1.155947, loss_ss: 0.862307, loss_d: 0.293640
0.8074 --- loss: 1.243719, loss_ss: 0.962576, loss_d: 0.281143
0.8458 --- loss: 1.672605, loss_ss: 0.963675, loss_d: 0.708930
0.8843 --- loss: 1.437734, loss_ss: 1.039826, loss_d: 0.397908
0.9227 --- loss: 1.076524, loss_ss: 0.754140, loss_d: 0.322384
0.9612 --- loss: 1.713630, loss_ss: 1.098314, loss_d: 0.615316
0.9996 --- loss: 1.203055, loss_ss: 1.029989, loss_d: 0.173066
Epoch finished! Loss: 1.2929107115818903
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.441725, loss_ss: 1.182776, loss_d: 0.258950
0.0384 --- loss: 1.100147, loss_ss: 0.898879, loss_d: 0.201268
0.0769 --- loss: 1.185066, loss_ss: 0.807765, loss_d: 0.377301
0.1153 --- loss: 0.895226, loss_ss: 0.762250, loss_d: 0.132976
0.1538 --- loss: 1.554789, loss_ss: 1.024790, loss_d: 0.529998
0.1922 --- loss: 0.857591, loss_ss: 0.665043, loss_d: 0.192549
0.2307 --- loss: 0.883699, loss_ss: 0.722065, loss_d: 0.161634
0.2691 --- loss: 1.508602, loss_ss: 1.083909, loss_d: 0.424693
0.3076 --- loss: 0.995592, loss_ss: 0.772980, loss_d: 0.222612
0.3460 --- loss: 1.306647, loss_ss: 1.169470, loss_d: 0.137177
0.3845 --- loss: 1.269202, loss_ss: 0.646644, loss_d: 0.622558
0.4229 --- loss: 1.122422, loss_ss: 0.517297, loss_d: 0.605125
0.4614 --- loss: 1.678269, loss_ss: 1.027202, loss_d: 0.651067
0.4998 --- loss: 1.745915, loss_ss: 1.099687, loss_d: 0.646227
0.5383 --- loss: 1.178112, loss_ss: 0.934511, loss_d: 0.243601
0.5767 --- loss: 1.400342, loss_ss: 1.074147, loss_d: 0.326195
0.6151 --- loss: 0.949749, loss_ss: 0.723602, loss_d: 0.226147
0.6536 --- loss: 0.747900, loss_ss: 0.595565, loss_d: 0.152335
0.6920 --- loss: 1.498003, loss_ss: 0.842412, loss_d: 0.655591
0.7305 --- loss: 1.181427, loss_ss: 0.854159, loss_d: 0.327268
0.7689 --- loss: 1.671673, loss_ss: 0.836233, loss_d: 0.835440
0.8074 --- loss: 1.297672, loss_ss: 0.943530, loss_d: 0.354142
0.8458 --- loss: 1.293046, loss_ss: 0.843773, loss_d: 0.449273
0.8843 --- loss: 1.715579, loss_ss: 1.249584, loss_d: 0.465995
0.9227 --- loss: 1.486132, loss_ss: 1.147553, loss_d: 0.338579
0.9612 --- loss: 1.002206, loss_ss: 0.746405, loss_d: 0.255801
0.9996 --- loss: 1.203895, loss_ss: 1.136207, loss_d: 0.067688
Epoch finished! Loss: 1.2240007024544937
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.318074, loss_ss: 0.620338, loss_d: 0.697735
0.0384 --- loss: 0.851803, loss_ss: 0.666714, loss_d: 0.185089
0.0769 --- loss: 0.974163, loss_ss: 0.763334, loss_d: 0.210829
0.1153 --- loss: 1.284969, loss_ss: 0.775619, loss_d: 0.509350
0.1538 --- loss: 1.218601, loss_ss: 0.896244, loss_d: 0.322357
0.1922 --- loss: 1.290152, loss_ss: 0.823530, loss_d: 0.466622
0.2307 --- loss: 0.805444, loss_ss: 0.697976, loss_d: 0.107468
0.2691 --- loss: 0.762720, loss_ss: 0.646114, loss_d: 0.116607
0.3076 --- loss: 1.711074, loss_ss: 0.886338, loss_d: 0.824736
0.3460 --- loss: 1.295625, loss_ss: 1.094754, loss_d: 0.200871
0.3845 --- loss: 0.993089, loss_ss: 0.783507, loss_d: 0.209582
0.4229 --- loss: 2.177113, loss_ss: 1.477831, loss_d: 0.699282
0.4614 --- loss: 1.382816, loss_ss: 0.761983, loss_d: 0.620833
0.4998 --- loss: 1.739434, loss_ss: 0.928149, loss_d: 0.811284
0.5383 --- loss: 0.990308, loss_ss: 0.759762, loss_d: 0.230546
0.5767 --- loss: 1.010313, loss_ss: 0.861991, loss_d: 0.148322
0.6151 --- loss: 1.023442, loss_ss: 0.851081, loss_d: 0.172361
0.6536 --- loss: 1.222966, loss_ss: 0.937234, loss_d: 0.285732
0.6920 --- loss: 1.087175, loss_ss: 0.545861, loss_d: 0.541314
0.7305 --- loss: 0.842086, loss_ss: 0.603632, loss_d: 0.238454
0.7689 --- loss: 0.807134, loss_ss: 0.631394, loss_d: 0.175740
0.8074 --- loss: 1.064228, loss_ss: 0.687738, loss_d: 0.376490
0.8458 --- loss: 1.074304, loss_ss: 0.755332, loss_d: 0.318972
0.8843 --- loss: 1.311610, loss_ss: 1.049372, loss_d: 0.262238
0.9227 --- loss: 1.022309, loss_ss: 0.825661, loss_d: 0.196648
0.9612 --- loss: 1.475006, loss_ss: 0.940017, loss_d: 0.534988
0.9996 --- loss: 3.941905, loss_ss: 3.841657, loss_d: 0.100248
Epoch finished! Loss: 1.1976832408171434
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5837837837837838
             precision    recall  f1-score   support

        0.0       0.59      0.87      0.71       232
        1.0       0.14      0.04      0.07       179
        2.0       0.57      0.44      0.49       246
        3.0       0.99      0.75      0.85       339
        4.0       0.29      0.68      0.41       114

avg / total       0.60      0.58      0.57      1110
 


====== chp024-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.86  86.64   84.40  59.47     70.53
1  80.00   4.47   94.52  13.56      6.72
2  80.09  43.90   90.39  56.54     49.43
3  91.98  74.63   99.61  98.83     85.04
4  79.82  68.42   81.12  29.32     41.05
Total accuracy: 58.38%
Average sen: 55.61%
Average spec: 90.01%
Macro f1-score: 50.55%
[0.98008335 0.99222153 0.9965713  0.9911657  0.99161303 0.99208671
 0.9872914  0.98699367 0.99376184 0.97615141 0.98492289 0.99322891
 0.99001533 0.9852336  0.99790478 0.99565351 0.99673104 0.99663866
 0.99756134 0.99444938 0.99442285 0.99179888 0.98630828 0.9899742
 0.9920392  0.99619591 0.99645483 0.9968797  0.99653625 0.99713022
 0.9976871  0.99709249 0.9770025  0.98917037 0.99624133 0.9942199
 0.99262309]
pred: 0.9919474720954895, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.208532, loss_ss: 1.539718, loss_d: 0.668814
0.0381 --- loss: 2.067989, loss_ss: 1.566046, loss_d: 0.501943
0.0762 --- loss: 2.230356, loss_ss: 1.543930, loss_d: 0.686427
0.1143 --- loss: 2.330447, loss_ss: 1.818816, loss_d: 0.511631
0.1524 --- loss: 2.044769, loss_ss: 1.470484, loss_d: 0.574285
0.1905 --- loss: 2.111886, loss_ss: 1.645801, loss_d: 0.466085
0.2287 --- loss: 2.095057, loss_ss: 1.347118, loss_d: 0.747940
0.2668 --- loss: 1.674094, loss_ss: 1.287334, loss_d: 0.386761
0.3049 --- loss: 2.080401, loss_ss: 1.628642, loss_d: 0.451759
0.3430 --- loss: 1.927694, loss_ss: 1.344457, loss_d: 0.583237
0.3811 --- loss: 2.205558, loss_ss: 1.440673, loss_d: 0.764886
0.4192 --- loss: 1.983517, loss_ss: 1.466016, loss_d: 0.517501
0.4573 --- loss: 1.968792, loss_ss: 1.448556, loss_d: 0.520236
0.4954 --- loss: 2.044043, loss_ss: 1.323638, loss_d: 0.720406
0.5335 --- loss: 1.971213, loss_ss: 1.464638, loss_d: 0.506575
0.5716 --- loss: 2.293224, loss_ss: 1.521755, loss_d: 0.771469
0.6098 --- loss: 1.968395, loss_ss: 1.363739, loss_d: 0.604656
0.6479 --- loss: 1.854716, loss_ss: 1.488392, loss_d: 0.366324
0.6860 --- loss: 1.906572, loss_ss: 1.374835, loss_d: 0.531738
0.7241 --- loss: 2.013046, loss_ss: 1.265392, loss_d: 0.747654
0.7622 --- loss: 1.876576, loss_ss: 1.246392, loss_d: 0.630184
0.8003 --- loss: 1.983014, loss_ss: 1.380164, loss_d: 0.602850
0.8384 --- loss: 1.885315, loss_ss: 1.293975, loss_d: 0.591340
0.8765 --- loss: 2.051787, loss_ss: 1.394470, loss_d: 0.657316
0.9146 --- loss: 1.783356, loss_ss: 1.282633, loss_d: 0.500724
0.9527 --- loss: 2.022589, loss_ss: 1.518002, loss_d: 0.504587
0.9909 --- loss: 1.877332, loss_ss: 1.255157, loss_d: 0.622175
Epoch finished! Loss: 1.9886319700998205
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.613096, loss_ss: 1.153790, loss_d: 0.459307
0.0381 --- loss: 1.955921, loss_ss: 1.436826, loss_d: 0.519096
0.0762 --- loss: 1.840482, loss_ss: 1.321995, loss_d: 0.518488
0.1143 --- loss: 1.969319, loss_ss: 1.237430, loss_d: 0.731889
0.1524 --- loss: 1.901496, loss_ss: 1.373536, loss_d: 0.527959
0.1905 --- loss: 1.844480, loss_ss: 1.206226, loss_d: 0.638254
0.2287 --- loss: 2.030485, loss_ss: 1.446119, loss_d: 0.584366
0.2668 --- loss: 1.564760, loss_ss: 1.072611, loss_d: 0.492148
0.3049 --- loss: 1.728004, loss_ss: 1.381342, loss_d: 0.346662
0.3430 --- loss: 1.708775, loss_ss: 1.245407, loss_d: 0.463368
0.3811 --- loss: 1.924165, loss_ss: 1.114798, loss_d: 0.809367
0.4192 --- loss: 2.067563, loss_ss: 1.366110, loss_d: 0.701453
0.4573 --- loss: 2.213636, loss_ss: 1.601210, loss_d: 0.612426
0.4954 --- loss: 1.690599, loss_ss: 1.043174, loss_d: 0.647425
0.5335 --- loss: 2.108235, loss_ss: 1.588601, loss_d: 0.519634
0.5716 --- loss: 2.042132, loss_ss: 1.267297, loss_d: 0.774835
0.6098 --- loss: 1.674030, loss_ss: 1.292942, loss_d: 0.381088
0.6479 --- loss: 1.690617, loss_ss: 1.180748, loss_d: 0.509869
0.6860 --- loss: 1.541577, loss_ss: 1.120149, loss_d: 0.421428
0.7241 --- loss: 1.545560, loss_ss: 1.112175, loss_d: 0.433385
0.7622 --- loss: 1.471886, loss_ss: 0.936507, loss_d: 0.535379
0.8003 --- loss: 1.409147, loss_ss: 1.013012, loss_d: 0.396135
0.8384 --- loss: 1.789856, loss_ss: 1.052792, loss_d: 0.737064
0.8765 --- loss: 1.460456, loss_ss: 1.050876, loss_d: 0.409581
0.9146 --- loss: 1.724597, loss_ss: 1.119417, loss_d: 0.605180
0.9527 --- loss: 1.584780, loss_ss: 1.057164, loss_d: 0.527616
0.9909 --- loss: 1.444666, loss_ss: 0.984093, loss_d: 0.460573
Epoch finished! Loss: 1.7716568144223162
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.460319, loss_ss: 0.989465, loss_d: 0.470854
0.0381 --- loss: 1.591587, loss_ss: 1.107532, loss_d: 0.484055
0.0762 --- loss: 2.000858, loss_ss: 1.177183, loss_d: 0.823675
0.1143 --- loss: 1.854462, loss_ss: 1.388088, loss_d: 0.466374
0.1524 --- loss: 1.576131, loss_ss: 0.943433, loss_d: 0.632698
0.1905 --- loss: 1.512645, loss_ss: 0.848343, loss_d: 0.664302
0.2287 --- loss: 1.381971, loss_ss: 0.897866, loss_d: 0.484105
0.2668 --- loss: 1.470651, loss_ss: 0.867448, loss_d: 0.603203
0.3049 --- loss: 1.555186, loss_ss: 0.965773, loss_d: 0.589414
0.3430 --- loss: 1.421748, loss_ss: 0.918575, loss_d: 0.503173
0.3811 --- loss: 1.902354, loss_ss: 0.981491, loss_d: 0.920863
0.4192 --- loss: 1.832531, loss_ss: 1.159621, loss_d: 0.672910
0.4573 --- loss: 1.421039, loss_ss: 0.923539, loss_d: 0.497500
0.4954 --- loss: 1.865506, loss_ss: 1.300717, loss_d: 0.564789
0.5335 --- loss: 1.348289, loss_ss: 0.879474, loss_d: 0.468815
0.5716 --- loss: 1.404608, loss_ss: 0.863168, loss_d: 0.541439
0.6098 --- loss: 1.526762, loss_ss: 0.953316, loss_d: 0.573445
0.6479 --- loss: 1.590168, loss_ss: 1.055468, loss_d: 0.534699
0.6860 --- loss: 1.616883, loss_ss: 1.073747, loss_d: 0.543136
0.7241 --- loss: 1.587339, loss_ss: 1.110596, loss_d: 0.476743
0.7622 --- loss: 1.514184, loss_ss: 1.024016, loss_d: 0.490168
0.8003 --- loss: 1.652102, loss_ss: 1.154482, loss_d: 0.497620
0.8384 --- loss: 1.754302, loss_ss: 0.935037, loss_d: 0.819264
0.8765 --- loss: 1.615646, loss_ss: 1.017459, loss_d: 0.598187
0.9146 --- loss: 1.453587, loss_ss: 0.810811, loss_d: 0.642776
0.9527 --- loss: 1.590667, loss_ss: 1.003695, loss_d: 0.586971
0.9909 --- loss: 1.622756, loss_ss: 1.032205, loss_d: 0.590551
Epoch finished! Loss: 1.6163052916526794
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.335110, loss_ss: 0.716482, loss_d: 0.618629
0.0381 --- loss: 1.312492, loss_ss: 0.807126, loss_d: 0.505366
0.0762 --- loss: 1.719107, loss_ss: 1.306606, loss_d: 0.412501
0.1143 --- loss: 1.870907, loss_ss: 1.346361, loss_d: 0.524546
0.1524 --- loss: 1.524171, loss_ss: 0.918204, loss_d: 0.605967
0.1905 --- loss: 1.553030, loss_ss: 0.945094, loss_d: 0.607936
0.2287 --- loss: 1.797505, loss_ss: 1.079610, loss_d: 0.717896
0.2668 --- loss: 1.547535, loss_ss: 0.791523, loss_d: 0.756011
0.3049 --- loss: 1.426992, loss_ss: 0.873633, loss_d: 0.553359
0.3430 --- loss: 1.410242, loss_ss: 1.049787, loss_d: 0.360455
0.3811 --- loss: 1.235959, loss_ss: 0.806582, loss_d: 0.429377
0.4192 --- loss: 1.854006, loss_ss: 0.926801, loss_d: 0.927205
0.4573 --- loss: 1.465857, loss_ss: 0.929307, loss_d: 0.536550
0.4954 --- loss: 1.656459, loss_ss: 0.923788, loss_d: 0.732671
0.5335 --- loss: 1.722448, loss_ss: 0.981702, loss_d: 0.740746
0.5716 --- loss: 1.610818, loss_ss: 0.928715, loss_d: 0.682103
0.6098 --- loss: 1.556485, loss_ss: 0.868827, loss_d: 0.687658
0.6479 --- loss: 1.459677, loss_ss: 0.760545, loss_d: 0.699132
0.6860 --- loss: 1.361667, loss_ss: 0.836347, loss_d: 0.525320
0.7241 --- loss: 1.533026, loss_ss: 0.953013, loss_d: 0.580013
0.7622 --- loss: 1.736481, loss_ss: 0.962275, loss_d: 0.774206
0.8003 --- loss: 1.501462, loss_ss: 1.070630, loss_d: 0.430832
0.8384 --- loss: 1.411617, loss_ss: 0.784048, loss_d: 0.627569
0.8765 --- loss: 1.474426, loss_ss: 1.119841, loss_d: 0.354585
0.9146 --- loss: 1.432347, loss_ss: 0.959481, loss_d: 0.472866
0.9527 --- loss: 1.410323, loss_ss: 0.827577, loss_d: 0.582746
0.9909 --- loss: 1.218613, loss_ss: 0.951538, loss_d: 0.267075
Epoch finished! Loss: 1.528228139604321
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.543710, loss_ss: 0.998016, loss_d: 0.545694
0.0381 --- loss: 1.904937, loss_ss: 1.297860, loss_d: 0.607077
0.0762 --- loss: 1.811688, loss_ss: 0.879782, loss_d: 0.931906
0.1143 --- loss: 1.466431, loss_ss: 0.763689, loss_d: 0.702742
0.1524 --- loss: 1.349091, loss_ss: 0.764171, loss_d: 0.584921
0.1905 --- loss: 1.381102, loss_ss: 0.900573, loss_d: 0.480529
0.2287 --- loss: 1.547755, loss_ss: 1.066183, loss_d: 0.481571
0.2668 --- loss: 1.418091, loss_ss: 1.078336, loss_d: 0.339754
0.3049 --- loss: 1.838481, loss_ss: 0.999530, loss_d: 0.838951
0.3430 --- loss: 1.186402, loss_ss: 0.756429, loss_d: 0.429973
0.3811 --- loss: 1.789261, loss_ss: 1.303608, loss_d: 0.485653
0.4192 --- loss: 1.390184, loss_ss: 1.059316, loss_d: 0.330868
0.4573 --- loss: 1.168059, loss_ss: 0.725518, loss_d: 0.442541
0.4954 --- loss: 1.719155, loss_ss: 0.851001, loss_d: 0.868154
0.5335 --- loss: 1.322274, loss_ss: 0.730160, loss_d: 0.592114
0.5716 --- loss: 1.471221, loss_ss: 0.836261, loss_d: 0.634961
0.6098 --- loss: 1.279883, loss_ss: 0.705696, loss_d: 0.574187
0.6479 --- loss: 1.591646, loss_ss: 0.896244, loss_d: 0.695402
0.6860 --- loss: 1.335383, loss_ss: 0.982657, loss_d: 0.352727
0.7241 --- loss: 1.646814, loss_ss: 1.126576, loss_d: 0.520237
0.7622 --- loss: 1.409921, loss_ss: 0.844668, loss_d: 0.565253
0.8003 --- loss: 1.888020, loss_ss: 0.977911, loss_d: 0.910109
0.8384 --- loss: 1.589196, loss_ss: 0.954447, loss_d: 0.634749
0.8765 --- loss: 1.638213, loss_ss: 0.770665, loss_d: 0.867548
0.9146 --- loss: 1.671100, loss_ss: 0.989357, loss_d: 0.681743
0.9527 --- loss: 1.845667, loss_ss: 1.309073, loss_d: 0.536595
0.9909 --- loss: 1.329412, loss_ss: 0.837446, loss_d: 0.491966
Epoch finished! Loss: 1.498057486446759
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.350956, loss_ss: 0.768162, loss_d: 0.582793
0.0381 --- loss: 1.436102, loss_ss: 0.750090, loss_d: 0.686012
0.0762 --- loss: 1.513370, loss_ss: 0.978917, loss_d: 0.534453
0.1143 --- loss: 1.636429, loss_ss: 1.081597, loss_d: 0.554832
0.1524 --- loss: 1.611987, loss_ss: 1.167740, loss_d: 0.444247
0.1905 --- loss: 1.314342, loss_ss: 0.788307, loss_d: 0.526035
0.2287 --- loss: 1.687774, loss_ss: 0.767616, loss_d: 0.920158
0.2668 --- loss: 1.199553, loss_ss: 0.869943, loss_d: 0.329610
0.3049 --- loss: 1.505445, loss_ss: 0.873174, loss_d: 0.632271
0.3430 --- loss: 1.412397, loss_ss: 0.796448, loss_d: 0.615949
0.3811 --- loss: 1.763279, loss_ss: 1.128234, loss_d: 0.635045
0.4192 --- loss: 1.698516, loss_ss: 1.358646, loss_d: 0.339869
0.4573 --- loss: 1.166018, loss_ss: 0.812810, loss_d: 0.353208
0.4954 --- loss: 1.832663, loss_ss: 1.034884, loss_d: 0.797779
0.5335 --- loss: 1.267655, loss_ss: 0.798388, loss_d: 0.469266
0.5716 --- loss: 1.375842, loss_ss: 0.783878, loss_d: 0.591965
0.6098 --- loss: 1.601424, loss_ss: 0.775217, loss_d: 0.826207
0.6479 --- loss: 1.225678, loss_ss: 0.810148, loss_d: 0.415530
0.6860 --- loss: 1.457336, loss_ss: 0.908024, loss_d: 0.549312
0.7241 --- loss: 1.625221, loss_ss: 1.046206, loss_d: 0.579015
0.7622 --- loss: 1.669777, loss_ss: 0.690101, loss_d: 0.979675
0.8003 --- loss: 1.076875, loss_ss: 0.699283, loss_d: 0.377592
0.8384 --- loss: 1.580412, loss_ss: 1.257447, loss_d: 0.322964
0.8765 --- loss: 1.417590, loss_ss: 1.047922, loss_d: 0.369668
0.9146 --- loss: 1.261142, loss_ss: 0.800376, loss_d: 0.460766
0.9527 --- loss: 1.409231, loss_ss: 0.833857, loss_d: 0.575374
0.9909 --- loss: 1.745382, loss_ss: 1.052628, loss_d: 0.692754
Epoch finished! Loss: 1.463418812924669
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.667097, loss_ss: 1.100031, loss_d: 0.567066
0.0381 --- loss: 1.765817, loss_ss: 1.020759, loss_d: 0.745058
0.0762 --- loss: 1.954934, loss_ss: 1.490133, loss_d: 0.464802
0.1143 --- loss: 1.227623, loss_ss: 0.655668, loss_d: 0.571955
0.1524 --- loss: 1.467094, loss_ss: 0.944853, loss_d: 0.522241
0.1905 --- loss: 1.377306, loss_ss: 0.807093, loss_d: 0.570213
0.2287 --- loss: 1.401263, loss_ss: 0.957763, loss_d: 0.443500
0.2668 --- loss: 1.403229, loss_ss: 1.032826, loss_d: 0.370403
0.3049 --- loss: 0.931229, loss_ss: 0.605500, loss_d: 0.325729
0.3430 --- loss: 1.634797, loss_ss: 0.927959, loss_d: 0.706837
0.3811 --- loss: 1.228778, loss_ss: 0.716181, loss_d: 0.512597
0.4192 --- loss: 1.247159, loss_ss: 0.740781, loss_d: 0.506378
0.4573 --- loss: 1.110733, loss_ss: 0.823016, loss_d: 0.287717
0.4954 --- loss: 1.441048, loss_ss: 0.787263, loss_d: 0.653785
0.5335 --- loss: 1.173628, loss_ss: 0.675812, loss_d: 0.497816
0.5716 --- loss: 1.672593, loss_ss: 1.339574, loss_d: 0.333019
0.6098 --- loss: 0.975086, loss_ss: 0.703630, loss_d: 0.271456
0.6479 --- loss: 1.457893, loss_ss: 0.865881, loss_d: 0.592012
0.6860 --- loss: 1.278367, loss_ss: 0.708753, loss_d: 0.569615
0.7241 --- loss: 1.774130, loss_ss: 1.167907, loss_d: 0.606223
0.7622 --- loss: 0.784727, loss_ss: 0.520481, loss_d: 0.264246
0.8003 --- loss: 1.091540, loss_ss: 0.812521, loss_d: 0.279019
0.8384 --- loss: 1.424114, loss_ss: 0.965183, loss_d: 0.458931
0.8765 --- loss: 1.144567, loss_ss: 0.742350, loss_d: 0.402216
0.9146 --- loss: 0.910300, loss_ss: 0.583534, loss_d: 0.326766
0.9527 --- loss: 1.474271, loss_ss: 0.896276, loss_d: 0.577995
0.9909 --- loss: 1.300315, loss_ss: 0.970049, loss_d: 0.330266
Epoch finished! Loss: 1.3768172223149364
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.443177, loss_ss: 1.028131, loss_d: 0.415045
0.0381 --- loss: 1.453572, loss_ss: 1.078238, loss_d: 0.375333
0.0762 --- loss: 1.171094, loss_ss: 0.797081, loss_d: 0.374013
0.1143 --- loss: 1.660803, loss_ss: 0.786005, loss_d: 0.874798
0.1524 --- loss: 1.468397, loss_ss: 0.919663, loss_d: 0.548734
0.1905 --- loss: 1.410737, loss_ss: 0.974599, loss_d: 0.436139
0.2287 --- loss: 1.577601, loss_ss: 1.008726, loss_d: 0.568875
0.2668 --- loss: 1.359956, loss_ss: 0.873725, loss_d: 0.486231
0.3049 --- loss: 1.140401, loss_ss: 0.838902, loss_d: 0.301499
0.3430 --- loss: 1.311194, loss_ss: 0.588643, loss_d: 0.722551
0.3811 --- loss: 0.961348, loss_ss: 0.648250, loss_d: 0.313098
0.4192 --- loss: 1.225064, loss_ss: 0.918363, loss_d: 0.306700
0.4573 --- loss: 1.152585, loss_ss: 0.868853, loss_d: 0.283731
0.4954 --- loss: 1.371721, loss_ss: 0.830803, loss_d: 0.540917
0.5335 --- loss: 1.663715, loss_ss: 0.729976, loss_d: 0.933740
0.5716 --- loss: 1.732400, loss_ss: 0.679727, loss_d: 1.052673
0.6098 --- loss: 0.971519, loss_ss: 0.663359, loss_d: 0.308159
0.6479 --- loss: 1.356628, loss_ss: 0.863747, loss_d: 0.492881
0.6860 --- loss: 1.416885, loss_ss: 0.928357, loss_d: 0.488527
0.7241 --- loss: 1.004170, loss_ss: 0.728143, loss_d: 0.276027
0.7622 --- loss: 1.264990, loss_ss: 0.768899, loss_d: 0.496091
0.8003 --- loss: 1.255823, loss_ss: 0.659578, loss_d: 0.596245
0.8384 --- loss: 1.195216, loss_ss: 0.867443, loss_d: 0.327774
0.8765 --- loss: 0.867201, loss_ss: 0.514099, loss_d: 0.353102
0.9146 --- loss: 1.125068, loss_ss: 0.792162, loss_d: 0.332906
0.9527 --- loss: 1.364455, loss_ss: 0.915722, loss_d: 0.448733
0.9909 --- loss: 1.420446, loss_ss: 0.822415, loss_d: 0.598031
Epoch finished! Loss: 1.3039415915503756
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.216359, loss_ss: 0.961159, loss_d: 0.255200
0.0381 --- loss: 1.155297, loss_ss: 0.851746, loss_d: 0.303551
0.0762 --- loss: 1.138072, loss_ss: 0.671996, loss_d: 0.466076
0.1143 --- loss: 1.379973, loss_ss: 0.855353, loss_d: 0.524620
0.1524 --- loss: 1.250649, loss_ss: 0.937275, loss_d: 0.313374
0.1905 --- loss: 1.177451, loss_ss: 0.850810, loss_d: 0.326642
0.2287 --- loss: 1.093595, loss_ss: 0.753673, loss_d: 0.339922
0.2668 --- loss: 1.237806, loss_ss: 0.857694, loss_d: 0.380112
0.3049 --- loss: 0.897908, loss_ss: 0.616559, loss_d: 0.281348
0.3430 --- loss: 1.490945, loss_ss: 0.832243, loss_d: 0.658702
0.3811 --- loss: 1.026998, loss_ss: 0.764578, loss_d: 0.262420
0.4192 --- loss: 1.128181, loss_ss: 0.799146, loss_d: 0.329035
0.4573 --- loss: 1.035318, loss_ss: 0.558460, loss_d: 0.476857
0.4954 --- loss: 0.971232, loss_ss: 0.666166, loss_d: 0.305065
0.5335 --- loss: 1.226298, loss_ss: 0.925571, loss_d: 0.300728
0.5716 --- loss: 0.904884, loss_ss: 0.635265, loss_d: 0.269619
0.6098 --- loss: 1.029939, loss_ss: 0.757523, loss_d: 0.272416
0.6479 --- loss: 1.152514, loss_ss: 0.828159, loss_d: 0.324354
0.6860 --- loss: 1.440364, loss_ss: 1.090605, loss_d: 0.349759
0.7241 --- loss: 1.189410, loss_ss: 0.907782, loss_d: 0.281628
0.7622 --- loss: 0.934726, loss_ss: 0.704868, loss_d: 0.229858
0.8003 --- loss: 1.097379, loss_ss: 0.850660, loss_d: 0.246720
0.8384 --- loss: 0.930916, loss_ss: 0.698406, loss_d: 0.232510
0.8765 --- loss: 1.355448, loss_ss: 0.922909, loss_d: 0.432539
0.9146 --- loss: 1.137054, loss_ss: 0.851077, loss_d: 0.285976
0.9527 --- loss: 1.116557, loss_ss: 0.780388, loss_d: 0.336169
0.9909 --- loss: 1.068849, loss_ss: 0.764174, loss_d: 0.304675
Epoch finished! Loss: 1.2613299718794933
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.178227, loss_ss: 0.705703, loss_d: 0.472524
0.0381 --- loss: 1.173669, loss_ss: 0.826408, loss_d: 0.347261
0.0762 --- loss: 1.234975, loss_ss: 0.780193, loss_d: 0.454782
0.1143 --- loss: 1.208927, loss_ss: 0.902904, loss_d: 0.306022
0.1524 --- loss: 1.264065, loss_ss: 0.891666, loss_d: 0.372399
0.1905 --- loss: 1.031435, loss_ss: 0.715451, loss_d: 0.315984
0.2287 --- loss: 1.260865, loss_ss: 0.971898, loss_d: 0.288966
0.2668 --- loss: 1.587552, loss_ss: 1.050681, loss_d: 0.536871
0.3049 --- loss: 1.240160, loss_ss: 0.918980, loss_d: 0.321180
0.3430 --- loss: 1.097861, loss_ss: 0.813926, loss_d: 0.283935
0.3811 --- loss: 1.367811, loss_ss: 1.014793, loss_d: 0.353018
0.4192 --- loss: 1.177809, loss_ss: 0.866375, loss_d: 0.311434
0.4573 --- loss: 1.061324, loss_ss: 0.814543, loss_d: 0.246781
0.4954 --- loss: 1.301486, loss_ss: 0.966092, loss_d: 0.335395
0.5335 --- loss: 1.145396, loss_ss: 0.859075, loss_d: 0.286321
0.5716 --- loss: 1.149503, loss_ss: 0.849164, loss_d: 0.300338
0.6098 --- loss: 1.222378, loss_ss: 0.794325, loss_d: 0.428052
0.6479 --- loss: 1.230512, loss_ss: 0.885396, loss_d: 0.345116
0.6860 --- loss: 1.355590, loss_ss: 1.145118, loss_d: 0.210472
0.7241 --- loss: 1.390735, loss_ss: 0.836123, loss_d: 0.554612
0.7622 --- loss: 1.054535, loss_ss: 0.829821, loss_d: 0.224714
0.8003 --- loss: 1.403699, loss_ss: 1.144399, loss_d: 0.259301
0.8384 --- loss: 1.427211, loss_ss: 0.997961, loss_d: 0.429251
0.8765 --- loss: 1.016207, loss_ss: 0.713337, loss_d: 0.302871
0.9146 --- loss: 1.253407, loss_ss: 0.905350, loss_d: 0.348057
0.9527 --- loss: 1.117626, loss_ss: 0.847218, loss_d: 0.270408
0.9909 --- loss: 0.875195, loss_ss: 0.612955, loss_d: 0.262240
Epoch finished! Loss: 1.2185929062712284
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.9238095238095239
             precision    recall  f1-score   support

        0.0       0.93      0.99      0.96       304
        1.0       0.73      0.32      0.44        25
        2.0       0.79      0.66      0.72        29
        3.0       1.00      0.97      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.92      0.92      0.92       420
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  94.29  99.01   81.90   93.48     96.17
1  95.24  32.00   99.24   72.73     44.44
2  96.43  65.52   98.72   79.17     71.70
3  99.52  96.77  100.00  100.00     98.36
4  99.29    NaN   99.29    0.00       NaN
Total accuracy: 92.38%
Average sen: 73.33%
Average spec: 95.83%
Macro f1-score: 77.67%
[0.91395164 0.92028153 0.93093914 0.93562305 0.9095149  0.91133815
 0.91374075 0.75987995 0.86416674 0.86970824 0.90412295 0.86512488
 0.87089843 0.95857501]
pred: 0.8948475250176021, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.407798, loss_ss: 1.723839, loss_d: 0.683959
0.0384 --- loss: 2.246985, loss_ss: 1.619737, loss_d: 0.627249
0.0767 --- loss: 2.173521, loss_ss: 1.730850, loss_d: 0.442670
0.1151 --- loss: 2.240155, loss_ss: 1.465089, loss_d: 0.775066
0.1534 --- loss: 2.169492, loss_ss: 1.490739, loss_d: 0.678753
0.1918 --- loss: 2.119558, loss_ss: 1.505729, loss_d: 0.613829
0.2301 --- loss: 2.172398, loss_ss: 1.675354, loss_d: 0.497044
0.2685 --- loss: 1.885504, loss_ss: 1.384620, loss_d: 0.500884
0.3069 --- loss: 2.155932, loss_ss: 1.575720, loss_d: 0.580212
0.3452 --- loss: 2.010163, loss_ss: 1.429832, loss_d: 0.580331
0.3836 --- loss: 1.976763, loss_ss: 1.520395, loss_d: 0.456368
0.4219 --- loss: 2.028846, loss_ss: 1.430795, loss_d: 0.598051
0.4603 --- loss: 1.829647, loss_ss: 1.339951, loss_d: 0.489696
0.4987 --- loss: 1.941879, loss_ss: 1.381938, loss_d: 0.559941
0.5370 --- loss: 1.979578, loss_ss: 1.429014, loss_d: 0.550564
0.5754 --- loss: 1.978865, loss_ss: 1.356549, loss_d: 0.622317
0.6137 --- loss: 1.565415, loss_ss: 1.277283, loss_d: 0.288131
0.6521 --- loss: 2.123699, loss_ss: 1.398790, loss_d: 0.724908
0.6904 --- loss: 1.844375, loss_ss: 1.324211, loss_d: 0.520163
0.7288 --- loss: 1.709089, loss_ss: 1.261570, loss_d: 0.447519
0.7672 --- loss: 2.002273, loss_ss: 1.487159, loss_d: 0.515113
0.8055 --- loss: 1.941950, loss_ss: 1.354715, loss_d: 0.587236
0.8439 --- loss: 1.985759, loss_ss: 1.455396, loss_d: 0.530362
0.8822 --- loss: 1.633497, loss_ss: 1.247599, loss_d: 0.385898
0.9206 --- loss: 1.777668, loss_ss: 1.358322, loss_d: 0.419346
0.9590 --- loss: 1.901387, loss_ss: 1.392535, loss_d: 0.508852
0.9973 --- loss: 2.292774, loss_ss: 1.523100, loss_d: 0.769674
Epoch finished! Loss: 2.0293077418437373
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.938134, loss_ss: 1.290882, loss_d: 0.647252
0.0384 --- loss: 1.730720, loss_ss: 1.264143, loss_d: 0.466577
0.0767 --- loss: 1.738221, loss_ss: 1.147781, loss_d: 0.590440
0.1151 --- loss: 1.696048, loss_ss: 1.069728, loss_d: 0.626320
0.1534 --- loss: 1.685807, loss_ss: 1.156723, loss_d: 0.529084
0.1918 --- loss: 1.908067, loss_ss: 1.127950, loss_d: 0.780117
0.2301 --- loss: 1.721524, loss_ss: 1.385925, loss_d: 0.335599
0.2685 --- loss: 1.638461, loss_ss: 1.131144, loss_d: 0.507317
0.3069 --- loss: 1.931558, loss_ss: 1.392100, loss_d: 0.539458
0.3452 --- loss: 1.801351, loss_ss: 1.165340, loss_d: 0.636012
0.3836 --- loss: 1.831333, loss_ss: 1.239349, loss_d: 0.591984
0.4219 --- loss: 1.639041, loss_ss: 0.974400, loss_d: 0.664641
0.4603 --- loss: 1.434049, loss_ss: 1.036824, loss_d: 0.397225
0.4987 --- loss: 1.605580, loss_ss: 1.054757, loss_d: 0.550823
0.5370 --- loss: 1.698554, loss_ss: 1.028148, loss_d: 0.670407
0.5754 --- loss: 1.668208, loss_ss: 1.076708, loss_d: 0.591500
0.6137 --- loss: 1.876295, loss_ss: 1.177776, loss_d: 0.698519
0.6521 --- loss: 1.587260, loss_ss: 1.038759, loss_d: 0.548501
0.6904 --- loss: 1.389360, loss_ss: 1.039271, loss_d: 0.350089
0.7288 --- loss: 2.112230, loss_ss: 1.613294, loss_d: 0.498936
0.7672 --- loss: 1.755635, loss_ss: 1.051581, loss_d: 0.704054
0.8055 --- loss: 1.956454, loss_ss: 1.449096, loss_d: 0.507358
0.8439 --- loss: 1.732938, loss_ss: 0.888765, loss_d: 0.844174
0.8822 --- loss: 1.316761, loss_ss: 0.989663, loss_d: 0.327099
0.9206 --- loss: 1.529739, loss_ss: 0.978082, loss_d: 0.551657
0.9590 --- loss: 1.543504, loss_ss: 0.874564, loss_d: 0.668940
0.9973 --- loss: 1.385118, loss_ss: 0.891004, loss_d: 0.494115
Epoch finished! Loss: 1.7511697759995093
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.705832, loss_ss: 1.000626, loss_d: 0.705207
0.0384 --- loss: 1.569646, loss_ss: 0.938902, loss_d: 0.630744
0.0767 --- loss: 1.309097, loss_ss: 0.876298, loss_d: 0.432799
0.1151 --- loss: 1.811004, loss_ss: 0.982244, loss_d: 0.828760
0.1534 --- loss: 1.709852, loss_ss: 0.963196, loss_d: 0.746655
0.1918 --- loss: 1.883181, loss_ss: 1.246058, loss_d: 0.637123
0.2301 --- loss: 1.691732, loss_ss: 1.165914, loss_d: 0.525818
0.2685 --- loss: 1.385476, loss_ss: 0.845700, loss_d: 0.539775
0.3069 --- loss: 1.408044, loss_ss: 0.910579, loss_d: 0.497464
0.3452 --- loss: 1.581325, loss_ss: 0.993206, loss_d: 0.588119
0.3836 --- loss: 1.385552, loss_ss: 0.954457, loss_d: 0.431095
0.4219 --- loss: 1.309375, loss_ss: 0.977963, loss_d: 0.331411
0.4603 --- loss: 1.370520, loss_ss: 0.992084, loss_d: 0.378436
0.4987 --- loss: 1.507550, loss_ss: 1.086831, loss_d: 0.420719
0.5370 --- loss: 1.564574, loss_ss: 1.064732, loss_d: 0.499842
0.5754 --- loss: 1.492186, loss_ss: 0.855591, loss_d: 0.636594
0.6137 --- loss: 1.619671, loss_ss: 1.044083, loss_d: 0.575589
0.6521 --- loss: 1.588274, loss_ss: 1.072774, loss_d: 0.515500
0.6904 --- loss: 1.726805, loss_ss: 1.094360, loss_d: 0.632446
0.7288 --- loss: 1.488235, loss_ss: 0.839632, loss_d: 0.648602
0.7672 --- loss: 1.394011, loss_ss: 0.958763, loss_d: 0.435247
0.8055 --- loss: 1.212847, loss_ss: 0.963150, loss_d: 0.249697
0.8439 --- loss: 1.715045, loss_ss: 0.828622, loss_d: 0.886422
0.8822 --- loss: 1.683260, loss_ss: 1.111213, loss_d: 0.572048
0.9206 --- loss: 1.284042, loss_ss: 0.936142, loss_d: 0.347900
0.9590 --- loss: 1.755881, loss_ss: 1.473574, loss_d: 0.282307
0.9973 --- loss: 1.770662, loss_ss: 1.195409, loss_d: 0.575253
Epoch finished! Loss: 1.5779723584651948
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.660192, loss_ss: 0.881841, loss_d: 0.778351
0.0384 --- loss: 1.482421, loss_ss: 0.823143, loss_d: 0.659277
0.0767 --- loss: 1.564908, loss_ss: 0.924503, loss_d: 0.640405
0.1151 --- loss: 1.423495, loss_ss: 0.803316, loss_d: 0.620179
0.1534 --- loss: 1.342817, loss_ss: 1.010691, loss_d: 0.332126
0.1918 --- loss: 1.013024, loss_ss: 0.748783, loss_d: 0.264242
0.2301 --- loss: 1.518189, loss_ss: 0.912142, loss_d: 0.606047
0.2685 --- loss: 1.448389, loss_ss: 0.757779, loss_d: 0.690610
0.3069 --- loss: 1.347894, loss_ss: 0.984524, loss_d: 0.363370
0.3452 --- loss: 1.783286, loss_ss: 0.985438, loss_d: 0.797848
0.3836 --- loss: 1.967174, loss_ss: 1.607230, loss_d: 0.359944
0.4219 --- loss: 1.658177, loss_ss: 0.949615, loss_d: 0.708562
0.4603 --- loss: 1.495457, loss_ss: 0.764009, loss_d: 0.731448
0.4987 --- loss: 1.564111, loss_ss: 1.011945, loss_d: 0.552166
0.5370 --- loss: 1.292037, loss_ss: 0.791610, loss_d: 0.500428
0.5754 --- loss: 1.477998, loss_ss: 0.986107, loss_d: 0.491891
0.6137 --- loss: 1.937528, loss_ss: 1.092914, loss_d: 0.844614
0.6521 --- loss: 1.405564, loss_ss: 1.144705, loss_d: 0.260858
0.6904 --- loss: 1.381470, loss_ss: 0.942946, loss_d: 0.438524
0.7288 --- loss: 1.174705, loss_ss: 0.890425, loss_d: 0.284280
0.7672 --- loss: 1.495758, loss_ss: 0.940551, loss_d: 0.555207
0.8055 --- loss: 1.645070, loss_ss: 0.859574, loss_d: 0.785496
0.8439 --- loss: 1.309583, loss_ss: 0.937496, loss_d: 0.372087
0.8822 --- loss: 1.595865, loss_ss: 0.762257, loss_d: 0.833608
0.9206 --- loss: 1.563990, loss_ss: 1.204716, loss_d: 0.359274
0.9590 --- loss: 1.647113, loss_ss: 0.811840, loss_d: 0.835273
0.9973 --- loss: 1.840529, loss_ss: 0.753304, loss_d: 1.087225
Epoch finished! Loss: 1.4911468200958693
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.452962, loss_ss: 1.084665, loss_d: 0.368297
0.0384 --- loss: 1.241880, loss_ss: 0.932925, loss_d: 0.308955
0.0767 --- loss: 1.422091, loss_ss: 0.828986, loss_d: 0.593105
0.1151 --- loss: 1.937578, loss_ss: 1.341212, loss_d: 0.596366
0.1534 --- loss: 1.334056, loss_ss: 0.798532, loss_d: 0.535524
0.1918 --- loss: 1.576836, loss_ss: 1.343225, loss_d: 0.233611
0.2301 --- loss: 1.287288, loss_ss: 1.039617, loss_d: 0.247671
0.2685 --- loss: 1.164960, loss_ss: 0.844323, loss_d: 0.320636
0.3069 --- loss: 1.200171, loss_ss: 0.849561, loss_d: 0.350610
0.3452 --- loss: 1.718353, loss_ss: 1.398912, loss_d: 0.319440
0.3836 --- loss: 1.477863, loss_ss: 0.726698, loss_d: 0.751165
0.4219 --- loss: 1.106184, loss_ss: 0.860369, loss_d: 0.245815
0.4603 --- loss: 1.561641, loss_ss: 0.993968, loss_d: 0.567673
0.4987 --- loss: 1.354681, loss_ss: 0.997956, loss_d: 0.356725
0.5370 --- loss: 1.668486, loss_ss: 1.113403, loss_d: 0.555083
0.5754 --- loss: 1.689355, loss_ss: 1.107416, loss_d: 0.581939
0.6137 --- loss: 1.334971, loss_ss: 0.881942, loss_d: 0.453030
0.6521 --- loss: 1.534429, loss_ss: 0.735162, loss_d: 0.799267
0.6904 --- loss: 1.335874, loss_ss: 0.929500, loss_d: 0.406374
0.7288 --- loss: 1.198599, loss_ss: 0.764084, loss_d: 0.434515
0.7672 --- loss: 1.112303, loss_ss: 0.781160, loss_d: 0.331142
0.8055 --- loss: 1.743605, loss_ss: 0.988786, loss_d: 0.754819
0.8439 --- loss: 1.154374, loss_ss: 0.914420, loss_d: 0.239955
0.8822 --- loss: 1.566092, loss_ss: 1.173919, loss_d: 0.392173
0.9206 --- loss: 1.553390, loss_ss: 0.782952, loss_d: 0.770438
0.9590 --- loss: 1.562167, loss_ss: 1.004735, loss_d: 0.557431
0.9973 --- loss: 1.314353, loss_ss: 0.936124, loss_d: 0.378229
Epoch finished! Loss: 1.3870684220240665
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.735573, loss_ss: 0.961501, loss_d: 0.774072
0.0384 --- loss: 1.454851, loss_ss: 1.003892, loss_d: 0.450959
0.0767 --- loss: 1.440518, loss_ss: 1.200455, loss_d: 0.240063
0.1151 --- loss: 1.456003, loss_ss: 1.321377, loss_d: 0.134626
0.1534 --- loss: 1.346587, loss_ss: 0.884891, loss_d: 0.461696
0.1918 --- loss: 1.093956, loss_ss: 0.864175, loss_d: 0.229781
0.2301 --- loss: 1.017817, loss_ss: 0.775583, loss_d: 0.242235
0.2685 --- loss: 1.767681, loss_ss: 1.030675, loss_d: 0.737006
0.3069 --- loss: 1.252769, loss_ss: 0.770643, loss_d: 0.482127
0.3452 --- loss: 1.309358, loss_ss: 0.854605, loss_d: 0.454753
0.3836 --- loss: 1.274579, loss_ss: 0.994089, loss_d: 0.280490
0.4219 --- loss: 1.032902, loss_ss: 0.738596, loss_d: 0.294306
0.4603 --- loss: 1.407131, loss_ss: 1.077023, loss_d: 0.330108
0.4987 --- loss: 1.324083, loss_ss: 1.014917, loss_d: 0.309167
0.5370 --- loss: 1.156705, loss_ss: 0.856537, loss_d: 0.300168
0.5754 --- loss: 1.429744, loss_ss: 0.815682, loss_d: 0.614062
0.6137 --- loss: 0.919614, loss_ss: 0.778656, loss_d: 0.140957
0.6521 --- loss: 1.347667, loss_ss: 0.922330, loss_d: 0.425337
0.6904 --- loss: 0.811112, loss_ss: 0.540858, loss_d: 0.270254
0.7288 --- loss: 1.606034, loss_ss: 0.886079, loss_d: 0.719955
0.7672 --- loss: 1.068820, loss_ss: 0.719052, loss_d: 0.349768
0.8055 --- loss: 1.099211, loss_ss: 0.680976, loss_d: 0.418235
0.8439 --- loss: 1.496846, loss_ss: 1.107654, loss_d: 0.389192
0.8822 --- loss: 1.628397, loss_ss: 0.791239, loss_d: 0.837158
0.9206 --- loss: 1.248917, loss_ss: 0.787782, loss_d: 0.461135
0.9590 --- loss: 1.436132, loss_ss: 0.888010, loss_d: 0.548122
0.9973 --- loss: 1.775856, loss_ss: 1.491328, loss_d: 0.284528
Epoch finished! Loss: 1.3062209773522158
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.129100, loss_ss: 0.649915, loss_d: 0.479185
0.0384 --- loss: 1.084197, loss_ss: 0.810807, loss_d: 0.273390
0.0767 --- loss: 0.914461, loss_ss: 0.628394, loss_d: 0.286067
0.1151 --- loss: 1.286578, loss_ss: 0.875000, loss_d: 0.411578
0.1534 --- loss: 1.591534, loss_ss: 1.301950, loss_d: 0.289584
0.1918 --- loss: 0.843994, loss_ss: 0.670670, loss_d: 0.173324
0.2301 --- loss: 1.269440, loss_ss: 0.808212, loss_d: 0.461228
0.2685 --- loss: 1.755972, loss_ss: 0.742700, loss_d: 1.013272
0.3069 --- loss: 1.436484, loss_ss: 1.001403, loss_d: 0.435081
0.3452 --- loss: 1.376134, loss_ss: 0.773238, loss_d: 0.602896
0.3836 --- loss: 1.650266, loss_ss: 1.394106, loss_d: 0.256160
0.4219 --- loss: 1.010802, loss_ss: 0.799558, loss_d: 0.211245
0.4603 --- loss: 1.240459, loss_ss: 0.884356, loss_d: 0.356103
0.4987 --- loss: 1.597426, loss_ss: 0.928271, loss_d: 0.669155
0.5370 --- loss: 1.039244, loss_ss: 0.786714, loss_d: 0.252530
0.5754 --- loss: 1.183942, loss_ss: 0.968750, loss_d: 0.215192
0.6137 --- loss: 1.143302, loss_ss: 0.883869, loss_d: 0.259433
0.6521 --- loss: 1.270776, loss_ss: 1.040354, loss_d: 0.230421
0.6904 --- loss: 1.336377, loss_ss: 0.829051, loss_d: 0.507327
0.7288 --- loss: 1.042488, loss_ss: 0.894166, loss_d: 0.148323
0.7672 --- loss: 0.985133, loss_ss: 0.717500, loss_d: 0.267634
0.8055 --- loss: 1.181013, loss_ss: 0.714306, loss_d: 0.466707
0.8439 --- loss: 0.870445, loss_ss: 0.498622, loss_d: 0.371824
0.8822 --- loss: 1.026651, loss_ss: 0.819930, loss_d: 0.206721
0.9206 --- loss: 1.242593, loss_ss: 0.983163, loss_d: 0.259429
0.9590 --- loss: 1.139059, loss_ss: 1.025943, loss_d: 0.113116
0.9973 --- loss: 0.789857, loss_ss: 0.640581, loss_d: 0.149275
Epoch finished! Loss: 1.2257681323931768
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.103328, loss_ss: 0.825042, loss_d: 0.278286
0.0384 --- loss: 1.573058, loss_ss: 0.521317, loss_d: 1.051741
0.0767 --- loss: 1.137793, loss_ss: 0.965198, loss_d: 0.172595
0.1151 --- loss: 0.873556, loss_ss: 0.650067, loss_d: 0.223489
0.1534 --- loss: 0.864476, loss_ss: 0.638336, loss_d: 0.226140
0.1918 --- loss: 1.181318, loss_ss: 1.004947, loss_d: 0.176371
0.2301 --- loss: 1.124636, loss_ss: 0.878050, loss_d: 0.246587
0.2685 --- loss: 1.554222, loss_ss: 1.110619, loss_d: 0.443602
0.3069 --- loss: 1.162782, loss_ss: 0.939187, loss_d: 0.223594
0.3452 --- loss: 0.967020, loss_ss: 0.748507, loss_d: 0.218512
0.3836 --- loss: 1.320156, loss_ss: 0.862668, loss_d: 0.457489
0.4219 --- loss: 1.657528, loss_ss: 1.266423, loss_d: 0.391104
0.4603 --- loss: 1.197926, loss_ss: 1.067305, loss_d: 0.130621
0.4987 --- loss: 1.456210, loss_ss: 1.074859, loss_d: 0.381351
0.5370 --- loss: 1.021650, loss_ss: 0.820614, loss_d: 0.201037
0.5754 --- loss: 1.131063, loss_ss: 0.829187, loss_d: 0.301875
0.6137 --- loss: 1.531556, loss_ss: 1.105709, loss_d: 0.425846
0.6521 --- loss: 1.257064, loss_ss: 0.795310, loss_d: 0.461754
0.6904 --- loss: 0.941701, loss_ss: 0.784924, loss_d: 0.156777
0.7288 --- loss: 1.150215, loss_ss: 0.999264, loss_d: 0.150951
0.7672 --- loss: 1.454457, loss_ss: 0.997224, loss_d: 0.457233
0.8055 --- loss: 0.909477, loss_ss: 0.751963, loss_d: 0.157514
0.8439 --- loss: 1.549345, loss_ss: 0.979050, loss_d: 0.570296
0.8822 --- loss: 1.169338, loss_ss: 0.726823, loss_d: 0.442515
0.9206 --- loss: 1.019769, loss_ss: 0.829255, loss_d: 0.190514
0.9590 --- loss: 0.844114, loss_ss: 0.627529, loss_d: 0.216585
0.9973 --- loss: 1.490205, loss_ss: 1.143760, loss_d: 0.346445
Epoch finished! Loss: 1.193134762919866
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.420897, loss_ss: 1.194474, loss_d: 0.226423
0.0384 --- loss: 1.316376, loss_ss: 0.978717, loss_d: 0.337659
0.0767 --- loss: 1.180993, loss_ss: 0.756942, loss_d: 0.424052
0.1151 --- loss: 1.062632, loss_ss: 0.844008, loss_d: 0.218624
0.1534 --- loss: 1.124151, loss_ss: 0.958612, loss_d: 0.165539
0.1918 --- loss: 1.280757, loss_ss: 1.119501, loss_d: 0.161256
0.2301 --- loss: 1.332972, loss_ss: 1.021871, loss_d: 0.311101
0.2685 --- loss: 1.428334, loss_ss: 1.263121, loss_d: 0.165213
0.3069 --- loss: 1.274806, loss_ss: 0.807199, loss_d: 0.467606
0.3452 --- loss: 1.130114, loss_ss: 0.991698, loss_d: 0.138416
0.3836 --- loss: 1.763292, loss_ss: 0.713234, loss_d: 1.050058
0.4219 --- loss: 1.260602, loss_ss: 0.772893, loss_d: 0.487709
0.4603 --- loss: 0.979473, loss_ss: 0.740249, loss_d: 0.239223
0.4987 --- loss: 0.958893, loss_ss: 0.506397, loss_d: 0.452496
0.5370 --- loss: 1.311810, loss_ss: 0.736321, loss_d: 0.575489
0.5754 --- loss: 1.073671, loss_ss: 0.904483, loss_d: 0.169188
0.6137 --- loss: 1.149757, loss_ss: 0.967982, loss_d: 0.181775
0.6521 --- loss: 1.591741, loss_ss: 0.952968, loss_d: 0.638773
0.6904 --- loss: 0.971732, loss_ss: 0.726313, loss_d: 0.245419
0.7288 --- loss: 1.504380, loss_ss: 1.193316, loss_d: 0.311063
0.7672 --- loss: 1.468270, loss_ss: 0.919402, loss_d: 0.548868
0.8055 --- loss: 1.071872, loss_ss: 0.827200, loss_d: 0.244671
0.8439 --- loss: 1.177605, loss_ss: 1.112902, loss_d: 0.064704
0.8822 --- loss: 1.851341, loss_ss: 1.094817, loss_d: 0.756524
0.9206 --- loss: 1.443363, loss_ss: 0.952226, loss_d: 0.491136
0.9590 --- loss: 1.004925, loss_ss: 0.890193, loss_d: 0.114731
0.9973 --- loss: 1.178007, loss_ss: 0.868938, loss_d: 0.309069
Epoch finished! Loss: 1.161621248263579
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.098803, loss_ss: 0.687115, loss_d: 0.411688
0.0384 --- loss: 0.887093, loss_ss: 0.732582, loss_d: 0.154510
0.0767 --- loss: 1.545428, loss_ss: 1.036085, loss_d: 0.509343
0.1151 --- loss: 0.905705, loss_ss: 0.765858, loss_d: 0.139847
0.1534 --- loss: 1.016220, loss_ss: 0.685993, loss_d: 0.330227
0.1918 --- loss: 1.535637, loss_ss: 0.662806, loss_d: 0.872831
0.2301 --- loss: 1.145888, loss_ss: 0.789243, loss_d: 0.356645
0.2685 --- loss: 0.960256, loss_ss: 0.746031, loss_d: 0.214225
0.3069 --- loss: 0.920403, loss_ss: 0.782003, loss_d: 0.138399
0.3452 --- loss: 0.875332, loss_ss: 0.696441, loss_d: 0.178890
0.3836 --- loss: 1.127665, loss_ss: 1.006918, loss_d: 0.120748
0.4219 --- loss: 1.042112, loss_ss: 0.875422, loss_d: 0.166691
0.4603 --- loss: 0.799200, loss_ss: 0.690036, loss_d: 0.109164
0.4987 --- loss: 1.827717, loss_ss: 1.335248, loss_d: 0.492469
0.5370 --- loss: 1.164780, loss_ss: 0.972980, loss_d: 0.191800
0.5754 --- loss: 1.336325, loss_ss: 0.558533, loss_d: 0.777792
0.6137 --- loss: 1.144962, loss_ss: 0.696206, loss_d: 0.448756
0.6521 --- loss: 1.726246, loss_ss: 1.218692, loss_d: 0.507553
0.6904 --- loss: 1.552939, loss_ss: 1.385641, loss_d: 0.167299
0.7288 --- loss: 1.352005, loss_ss: 0.970499, loss_d: 0.381506
0.7672 --- loss: 1.045266, loss_ss: 0.800367, loss_d: 0.244899
0.8055 --- loss: 1.179675, loss_ss: 1.016048, loss_d: 0.163627
0.8439 --- loss: 1.232679, loss_ss: 0.654014, loss_d: 0.578665
0.8822 --- loss: 1.038517, loss_ss: 0.817478, loss_d: 0.221039
0.9206 --- loss: 1.116278, loss_ss: 0.808235, loss_d: 0.308043
0.9590 --- loss: 1.023429, loss_ss: 0.838046, loss_d: 0.185383
0.9973 --- loss: 1.102070, loss_ss: 0.545504, loss_d: 0.556567
Epoch finished! Loss: 1.133301151715792
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8
             precision    recall  f1-score   support

        0.0       0.51      0.86      0.64        58
        1.0       0.28      0.20      0.23        55
        2.0       0.81      0.85      0.83       412
        3.0       0.90      0.89      0.89       182
        4.0       0.96      0.76      0.85       223

avg / total       0.81      0.80      0.80       930
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.98  86.21   94.50  51.02     64.10
1  92.15  20.00   96.69  27.50     23.16
2  84.52  85.19   83.98  80.88     82.98
3  95.81  89.01   97.46  89.50     89.26
4  93.55  76.23   99.01  96.05     85.00
Total accuracy: 80.00%
Average sen: 71.33%
Average spec: 94.33%
Macro f1-score: 68.90%
[0.45509461 0.76463389 0.38780829 0.60040581 0.29118216 0.93083531
 0.88292509 0.83910596 0.90916979 0.88926947 0.85756785 0.99971944
 0.41430929 0.61514163 0.4560661  0.79475182 0.28070164 0.84936422
 0.18952087 0.47408351 0.46150616 0.85764611 0.94122052 0.82215685
 0.3039546  0.99930489 0.36539608 0.18405314 0.9821406  0.86057013
 0.25097048]
pred: 0.6422766557624263, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.358964, loss_ss: 1.721360, loss_d: 0.637604
0.0384 --- loss: 2.206545, loss_ss: 1.557875, loss_d: 0.648670
0.0768 --- loss: 2.152066, loss_ss: 1.538409, loss_d: 0.613657
0.1152 --- loss: 2.033385, loss_ss: 1.408041, loss_d: 0.625344
0.1536 --- loss: 2.000336, loss_ss: 1.422956, loss_d: 0.577380
0.1920 --- loss: 1.975197, loss_ss: 1.517227, loss_d: 0.457970
0.2304 --- loss: 1.834063, loss_ss: 1.465127, loss_d: 0.368936
0.2688 --- loss: 1.805949, loss_ss: 1.410752, loss_d: 0.395197
0.3072 --- loss: 2.004931, loss_ss: 1.445102, loss_d: 0.559829
0.3456 --- loss: 1.964099, loss_ss: 1.375326, loss_d: 0.588773
0.3840 --- loss: 2.179130, loss_ss: 1.427618, loss_d: 0.751511
0.4224 --- loss: 2.145077, loss_ss: 1.376471, loss_d: 0.768606
0.4608 --- loss: 1.966813, loss_ss: 1.342466, loss_d: 0.624346
0.4992 --- loss: 2.064841, loss_ss: 1.205648, loss_d: 0.859193
0.5376 --- loss: 1.922863, loss_ss: 1.263436, loss_d: 0.659427
0.5760 --- loss: 2.009527, loss_ss: 1.355366, loss_d: 0.654161
0.6144 --- loss: 2.016995, loss_ss: 1.313350, loss_d: 0.703645
0.6528 --- loss: 2.020496, loss_ss: 1.252112, loss_d: 0.768384
0.6912 --- loss: 2.015426, loss_ss: 1.270031, loss_d: 0.745395
0.7296 --- loss: 1.922358, loss_ss: 1.333637, loss_d: 0.588721
0.7680 --- loss: 1.698182, loss_ss: 1.225469, loss_d: 0.472712
0.8065 --- loss: 1.858364, loss_ss: 1.066687, loss_d: 0.791677
0.8449 --- loss: 1.674474, loss_ss: 1.157451, loss_d: 0.517023
0.8833 --- loss: 1.765047, loss_ss: 1.133134, loss_d: 0.631913
0.9217 --- loss: 1.911170, loss_ss: 1.341297, loss_d: 0.569873
0.9601 --- loss: 1.939868, loss_ss: 1.282025, loss_d: 0.657843
0.9985 --- loss: 1.828785, loss_ss: 1.096207, loss_d: 0.732578
Epoch finished! Loss: 1.966648656129837
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.889477, loss_ss: 1.174342, loss_d: 0.715135
0.0384 --- loss: 1.543077, loss_ss: 1.158198, loss_d: 0.384879
0.0768 --- loss: 1.774536, loss_ss: 1.068126, loss_d: 0.706410
0.1152 --- loss: 1.577641, loss_ss: 1.156989, loss_d: 0.420653
0.1536 --- loss: 1.609620, loss_ss: 1.093197, loss_d: 0.516424
0.1920 --- loss: 1.768185, loss_ss: 1.168834, loss_d: 0.599351
0.2304 --- loss: 1.921011, loss_ss: 1.166277, loss_d: 0.754735
0.2688 --- loss: 1.981522, loss_ss: 1.288376, loss_d: 0.693145
0.3072 --- loss: 1.557125, loss_ss: 0.924669, loss_d: 0.632456
0.3456 --- loss: 1.573225, loss_ss: 0.998907, loss_d: 0.574318
0.3840 --- loss: 1.586373, loss_ss: 1.085167, loss_d: 0.501206
0.4224 --- loss: 1.496217, loss_ss: 1.063461, loss_d: 0.432756
0.4608 --- loss: 1.810378, loss_ss: 1.252519, loss_d: 0.557859
0.4992 --- loss: 1.870015, loss_ss: 1.150536, loss_d: 0.719479
0.5376 --- loss: 1.492438, loss_ss: 1.074603, loss_d: 0.417835
0.5760 --- loss: 1.855008, loss_ss: 1.175930, loss_d: 0.679078
0.6144 --- loss: 1.689910, loss_ss: 0.907257, loss_d: 0.782653
0.6528 --- loss: 1.643464, loss_ss: 1.179513, loss_d: 0.463951
0.6912 --- loss: 1.635615, loss_ss: 0.873993, loss_d: 0.761622
0.7296 --- loss: 1.637950, loss_ss: 1.036882, loss_d: 0.601068
0.7680 --- loss: 1.640534, loss_ss: 1.102715, loss_d: 0.537819
0.8065 --- loss: 1.599116, loss_ss: 0.943218, loss_d: 0.655897
0.8449 --- loss: 1.820206, loss_ss: 1.192177, loss_d: 0.628029
0.8833 --- loss: 1.693218, loss_ss: 1.130839, loss_d: 0.562379
0.9217 --- loss: 1.571904, loss_ss: 0.964143, loss_d: 0.607761
0.9601 --- loss: 1.465011, loss_ss: 0.880793, loss_d: 0.584218
0.9985 --- loss: 1.482176, loss_ss: 1.062793, loss_d: 0.419383
Epoch finished! Loss: 1.685134345293045
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.482528, loss_ss: 1.146828, loss_d: 0.335699
0.0384 --- loss: 1.784251, loss_ss: 0.831452, loss_d: 0.952798
0.0768 --- loss: 1.654533, loss_ss: 1.021089, loss_d: 0.633445
0.1152 --- loss: 1.620195, loss_ss: 1.178762, loss_d: 0.441433
0.1536 --- loss: 1.546138, loss_ss: 0.895077, loss_d: 0.651061
0.1920 --- loss: 1.796902, loss_ss: 0.992325, loss_d: 0.804577
0.2304 --- loss: 1.499853, loss_ss: 0.684976, loss_d: 0.814877
0.2688 --- loss: 1.680843, loss_ss: 0.816918, loss_d: 0.863925
0.3072 --- loss: 1.473952, loss_ss: 0.807687, loss_d: 0.666265
0.3456 --- loss: 1.433625, loss_ss: 0.832398, loss_d: 0.601227
0.3840 --- loss: 1.409579, loss_ss: 0.841981, loss_d: 0.567598
0.4224 --- loss: 1.728644, loss_ss: 0.998831, loss_d: 0.729813
0.4608 --- loss: 1.432487, loss_ss: 0.918755, loss_d: 0.513731
0.4992 --- loss: 1.694325, loss_ss: 0.945444, loss_d: 0.748881
0.5376 --- loss: 1.759901, loss_ss: 1.107969, loss_d: 0.651932
0.5760 --- loss: 1.342844, loss_ss: 0.903138, loss_d: 0.439706
0.6144 --- loss: 1.663865, loss_ss: 0.873676, loss_d: 0.790189
0.6528 --- loss: 1.653870, loss_ss: 0.857029, loss_d: 0.796842
0.6912 --- loss: 1.882630, loss_ss: 1.084666, loss_d: 0.797964
0.7296 --- loss: 1.745315, loss_ss: 0.896472, loss_d: 0.848843
0.7680 --- loss: 1.610944, loss_ss: 1.140008, loss_d: 0.470936
0.8065 --- loss: 1.439370, loss_ss: 0.943621, loss_d: 0.495750
0.8449 --- loss: 1.448524, loss_ss: 1.024303, loss_d: 0.424222
0.8833 --- loss: 1.515962, loss_ss: 0.945258, loss_d: 0.570704
0.9217 --- loss: 1.321683, loss_ss: 1.068112, loss_d: 0.253571
0.9601 --- loss: 1.761505, loss_ss: 0.946203, loss_d: 0.815302
0.9985 --- loss: 1.612605, loss_ss: 0.898737, loss_d: 0.713868
Epoch finished! Loss: 1.568574562898049
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.618153, loss_ss: 0.918889, loss_d: 0.699264
0.0384 --- loss: 1.450522, loss_ss: 0.872460, loss_d: 0.578062
0.0768 --- loss: 1.426103, loss_ss: 0.937192, loss_d: 0.488911
0.1152 --- loss: 1.363683, loss_ss: 0.905053, loss_d: 0.458630
0.1536 --- loss: 1.338701, loss_ss: 0.937373, loss_d: 0.401329
0.1920 --- loss: 1.163821, loss_ss: 0.818204, loss_d: 0.345617
0.2304 --- loss: 1.767039, loss_ss: 1.220728, loss_d: 0.546311
0.2688 --- loss: 1.422201, loss_ss: 0.801924, loss_d: 0.620276
0.3072 --- loss: 1.951772, loss_ss: 1.300949, loss_d: 0.650822
0.3456 --- loss: 2.053048, loss_ss: 1.280798, loss_d: 0.772250
0.3840 --- loss: 1.438691, loss_ss: 0.721486, loss_d: 0.717205
0.4224 --- loss: 1.260196, loss_ss: 0.866639, loss_d: 0.393557
0.4608 --- loss: 1.782873, loss_ss: 1.185429, loss_d: 0.597444
0.4992 --- loss: 1.246659, loss_ss: 0.887052, loss_d: 0.359608
0.5376 --- loss: 1.506123, loss_ss: 0.864149, loss_d: 0.641975
0.5760 --- loss: 1.525641, loss_ss: 1.056321, loss_d: 0.469320
0.6144 --- loss: 1.324656, loss_ss: 0.674543, loss_d: 0.650113
0.6528 --- loss: 1.902772, loss_ss: 1.324187, loss_d: 0.578585
0.6912 --- loss: 1.290765, loss_ss: 0.821450, loss_d: 0.469315
0.7296 --- loss: 1.375584, loss_ss: 0.741961, loss_d: 0.633623
0.7680 --- loss: 1.159320, loss_ss: 0.922406, loss_d: 0.236914
0.8065 --- loss: 1.865833, loss_ss: 0.795540, loss_d: 1.070293
0.8449 --- loss: 1.411107, loss_ss: 0.877887, loss_d: 0.533220
0.8833 --- loss: 1.860302, loss_ss: 0.984641, loss_d: 0.875661
0.9217 --- loss: 1.592640, loss_ss: 0.871852, loss_d: 0.720789
0.9601 --- loss: 1.168575, loss_ss: 0.750909, loss_d: 0.417666
0.9985 --- loss: 1.597898, loss_ss: 1.237522, loss_d: 0.360376
Epoch finished! Loss: 1.5164205555732433
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.401458, loss_ss: 0.840894, loss_d: 0.560564
0.0384 --- loss: 1.276997, loss_ss: 0.779935, loss_d: 0.497062
0.0768 --- loss: 2.078693, loss_ss: 0.988294, loss_d: 1.090400
0.1152 --- loss: 1.258800, loss_ss: 0.783509, loss_d: 0.475291
0.1536 --- loss: 1.195794, loss_ss: 0.859546, loss_d: 0.336248
0.1920 --- loss: 1.649124, loss_ss: 1.136022, loss_d: 0.513102
0.2304 --- loss: 1.304750, loss_ss: 0.881339, loss_d: 0.423411
0.2688 --- loss: 1.720089, loss_ss: 1.391353, loss_d: 0.328736
0.3072 --- loss: 1.292444, loss_ss: 1.016904, loss_d: 0.275540
0.3456 --- loss: 1.898043, loss_ss: 1.164417, loss_d: 0.733626
0.3840 --- loss: 1.301864, loss_ss: 1.009418, loss_d: 0.292446
0.4224 --- loss: 1.400441, loss_ss: 1.002303, loss_d: 0.398138
0.4608 --- loss: 1.526748, loss_ss: 0.983243, loss_d: 0.543505
0.4992 --- loss: 1.774124, loss_ss: 1.137358, loss_d: 0.636766
0.5376 --- loss: 1.670578, loss_ss: 1.173525, loss_d: 0.497053
0.5760 --- loss: 1.740043, loss_ss: 1.182000, loss_d: 0.558043
0.6144 --- loss: 1.270282, loss_ss: 0.919111, loss_d: 0.351171
0.6528 --- loss: 1.309587, loss_ss: 0.869377, loss_d: 0.440209
0.6912 --- loss: 1.538704, loss_ss: 1.212047, loss_d: 0.326657
0.7296 --- loss: 1.121966, loss_ss: 0.785248, loss_d: 0.336718
0.7680 --- loss: 1.141881, loss_ss: 0.927640, loss_d: 0.214241
0.8065 --- loss: 1.121948, loss_ss: 0.750691, loss_d: 0.371257
0.8449 --- loss: 1.712006, loss_ss: 1.178783, loss_d: 0.533223
0.8833 --- loss: 1.260998, loss_ss: 0.820921, loss_d: 0.440078
0.9217 --- loss: 1.208051, loss_ss: 0.883166, loss_d: 0.324885
0.9601 --- loss: 1.219597, loss_ss: 0.873321, loss_d: 0.346276
0.9985 --- loss: 1.727350, loss_ss: 1.189441, loss_d: 0.537910
Epoch finished! Loss: 1.4446778311179234
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.625227, loss_ss: 0.993686, loss_d: 0.631541
0.0384 --- loss: 1.367295, loss_ss: 0.885915, loss_d: 0.481380
0.0768 --- loss: 1.389299, loss_ss: 0.978729, loss_d: 0.410570
0.1152 --- loss: 1.472194, loss_ss: 0.910802, loss_d: 0.561392
0.1536 --- loss: 1.169340, loss_ss: 0.811750, loss_d: 0.357590
0.1920 --- loss: 1.234467, loss_ss: 0.931159, loss_d: 0.303308
0.2304 --- loss: 1.591897, loss_ss: 0.902414, loss_d: 0.689483
0.2688 --- loss: 1.231247, loss_ss: 0.709412, loss_d: 0.521835
0.3072 --- loss: 1.358782, loss_ss: 0.779095, loss_d: 0.579688
0.3456 --- loss: 1.664190, loss_ss: 0.772152, loss_d: 0.892038
0.3840 --- loss: 1.240415, loss_ss: 0.839622, loss_d: 0.400794
0.4224 --- loss: 1.385913, loss_ss: 1.076403, loss_d: 0.309510
0.4608 --- loss: 1.395368, loss_ss: 1.006792, loss_d: 0.388576
0.4992 --- loss: 1.320331, loss_ss: 1.088974, loss_d: 0.231357
0.5376 --- loss: 1.374674, loss_ss: 0.813261, loss_d: 0.561413
0.5760 --- loss: 1.252682, loss_ss: 0.886319, loss_d: 0.366362
0.6144 --- loss: 1.236382, loss_ss: 0.842476, loss_d: 0.393906
0.6528 --- loss: 1.958329, loss_ss: 0.828813, loss_d: 1.129516
0.6912 --- loss: 1.203721, loss_ss: 0.790400, loss_d: 0.413321
0.7296 --- loss: 1.206090, loss_ss: 0.829737, loss_d: 0.376353
0.7680 --- loss: 1.171674, loss_ss: 0.693926, loss_d: 0.477748
0.8065 --- loss: 1.540757, loss_ss: 1.287131, loss_d: 0.253626
0.8449 --- loss: 1.258764, loss_ss: 0.958259, loss_d: 0.300505
0.8833 --- loss: 0.880300, loss_ss: 0.594528, loss_d: 0.285771
0.9217 --- loss: 1.264412, loss_ss: 0.982570, loss_d: 0.281842
0.9601 --- loss: 0.952370, loss_ss: 0.664499, loss_d: 0.287870
0.9985 --- loss: 1.752123, loss_ss: 1.331141, loss_d: 0.420981
Epoch finished! Loss: 1.3399849112217244
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.373137, loss_ss: 0.809255, loss_d: 0.563882
0.0384 --- loss: 1.255874, loss_ss: 0.872797, loss_d: 0.383077
0.0768 --- loss: 0.933036, loss_ss: 0.524360, loss_d: 0.408676
0.1152 --- loss: 0.966931, loss_ss: 0.809254, loss_d: 0.157677
0.1536 --- loss: 1.831808, loss_ss: 1.515847, loss_d: 0.315960
0.1920 --- loss: 1.208135, loss_ss: 0.744841, loss_d: 0.463294
0.2304 --- loss: 1.280178, loss_ss: 0.989403, loss_d: 0.290774
0.2688 --- loss: 0.959582, loss_ss: 0.781303, loss_d: 0.178279
0.3072 --- loss: 1.577954, loss_ss: 1.027438, loss_d: 0.550516
0.3456 --- loss: 0.993929, loss_ss: 0.698511, loss_d: 0.295418
0.3840 --- loss: 1.238807, loss_ss: 0.760171, loss_d: 0.478636
0.4224 --- loss: 0.891019, loss_ss: 0.695252, loss_d: 0.195767
0.4608 --- loss: 1.824649, loss_ss: 0.884516, loss_d: 0.940133
0.4992 --- loss: 1.381083, loss_ss: 0.813722, loss_d: 0.567361
0.5376 --- loss: 1.267742, loss_ss: 0.852358, loss_d: 0.415384
0.5760 --- loss: 0.931073, loss_ss: 0.653038, loss_d: 0.278035
0.6144 --- loss: 1.059095, loss_ss: 0.796837, loss_d: 0.262258
0.6528 --- loss: 1.396106, loss_ss: 1.045107, loss_d: 0.350999
0.6912 --- loss: 1.178745, loss_ss: 0.823127, loss_d: 0.355618
0.7296 --- loss: 1.662494, loss_ss: 0.753687, loss_d: 0.908807
0.7680 --- loss: 1.224548, loss_ss: 0.963984, loss_d: 0.260564
0.8065 --- loss: 0.886457, loss_ss: 0.573558, loss_d: 0.312898
0.8449 --- loss: 1.549680, loss_ss: 0.945285, loss_d: 0.604394
0.8833 --- loss: 0.772337, loss_ss: 0.643902, loss_d: 0.128435
0.9217 --- loss: 1.414487, loss_ss: 0.906801, loss_d: 0.507686
0.9601 --- loss: 1.075117, loss_ss: 0.754041, loss_d: 0.321077
0.9985 --- loss: 1.342294, loss_ss: 1.245502, loss_d: 0.096793
Epoch finished! Loss: 1.2414475241532692
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.033740, loss_ss: 0.802589, loss_d: 0.231150
0.0384 --- loss: 0.960812, loss_ss: 0.691385, loss_d: 0.269427
0.0768 --- loss: 0.976640, loss_ss: 0.781488, loss_d: 0.195152
0.1152 --- loss: 1.212582, loss_ss: 0.890858, loss_d: 0.321725
0.1536 --- loss: 1.316735, loss_ss: 0.905894, loss_d: 0.410841
0.1920 --- loss: 1.359427, loss_ss: 0.841991, loss_d: 0.517436
0.2304 --- loss: 1.141815, loss_ss: 0.883808, loss_d: 0.258007
0.2688 --- loss: 2.175299, loss_ss: 1.085749, loss_d: 1.089550
0.3072 --- loss: 1.399558, loss_ss: 0.861110, loss_d: 0.538448
0.3456 --- loss: 1.119405, loss_ss: 0.814633, loss_d: 0.304772
0.3840 --- loss: 1.000045, loss_ss: 0.693349, loss_d: 0.306697
0.4224 --- loss: 1.613481, loss_ss: 1.046819, loss_d: 0.566662
0.4608 --- loss: 1.111988, loss_ss: 1.025561, loss_d: 0.086427
0.4992 --- loss: 0.863809, loss_ss: 0.640758, loss_d: 0.223051
0.5376 --- loss: 0.927585, loss_ss: 0.813392, loss_d: 0.114193
0.5760 --- loss: 1.963670, loss_ss: 1.457280, loss_d: 0.506390
0.6144 --- loss: 1.166187, loss_ss: 1.006813, loss_d: 0.159375
0.6528 --- loss: 0.891141, loss_ss: 0.723416, loss_d: 0.167725
0.6912 --- loss: 1.416467, loss_ss: 0.802450, loss_d: 0.614017
0.7296 --- loss: 1.011653, loss_ss: 0.832778, loss_d: 0.178875
0.7680 --- loss: 1.183070, loss_ss: 0.744727, loss_d: 0.438343
0.8065 --- loss: 0.958632, loss_ss: 0.763654, loss_d: 0.194978
0.8449 --- loss: 1.236100, loss_ss: 0.867584, loss_d: 0.368516
0.8833 --- loss: 1.176910, loss_ss: 0.992486, loss_d: 0.184423
0.9217 --- loss: 1.146157, loss_ss: 0.869589, loss_d: 0.276568
0.9601 --- loss: 1.093500, loss_ss: 0.686749, loss_d: 0.406751
0.9985 --- loss: 1.603913, loss_ss: 1.137554, loss_d: 0.466359
Epoch finished! Loss: 1.1689307662156911
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.086434, loss_ss: 0.838552, loss_d: 0.247882
0.0384 --- loss: 0.883846, loss_ss: 0.734336, loss_d: 0.149510
0.0768 --- loss: 1.245947, loss_ss: 0.928518, loss_d: 0.317430
0.1152 --- loss: 1.109020, loss_ss: 0.720203, loss_d: 0.388817
0.1536 --- loss: 1.038954, loss_ss: 0.777594, loss_d: 0.261360
0.1920 --- loss: 0.903498, loss_ss: 0.657739, loss_d: 0.245760
0.2304 --- loss: 0.811523, loss_ss: 0.615291, loss_d: 0.196232
0.2688 --- loss: 1.054166, loss_ss: 0.848282, loss_d: 0.205884
0.3072 --- loss: 1.645688, loss_ss: 1.117938, loss_d: 0.527750
0.3456 --- loss: 0.961871, loss_ss: 0.808477, loss_d: 0.153394
0.3840 --- loss: 0.842875, loss_ss: 0.695974, loss_d: 0.146902
0.4224 --- loss: 0.972898, loss_ss: 0.864382, loss_d: 0.108516
0.4608 --- loss: 0.952445, loss_ss: 0.911656, loss_d: 0.040789
0.4992 --- loss: 0.763118, loss_ss: 0.618583, loss_d: 0.144534
0.5376 --- loss: 1.010714, loss_ss: 0.935804, loss_d: 0.074910
0.5760 --- loss: 1.033628, loss_ss: 0.895213, loss_d: 0.138415
0.6144 --- loss: 0.925996, loss_ss: 0.716212, loss_d: 0.209784
0.6528 --- loss: 1.065956, loss_ss: 0.880881, loss_d: 0.185075
0.6912 --- loss: 0.830613, loss_ss: 0.730388, loss_d: 0.100225
0.7296 --- loss: 0.742329, loss_ss: 0.559414, loss_d: 0.182915
0.7680 --- loss: 0.996652, loss_ss: 0.797954, loss_d: 0.198699
0.8065 --- loss: 1.466036, loss_ss: 0.951547, loss_d: 0.514489
0.8449 --- loss: 0.846316, loss_ss: 0.747002, loss_d: 0.099314
0.8833 --- loss: 1.138825, loss_ss: 0.960653, loss_d: 0.178171
0.9217 --- loss: 0.968507, loss_ss: 0.654755, loss_d: 0.313752
0.9601 --- loss: 1.208147, loss_ss: 0.601248, loss_d: 0.606899
0.9985 --- loss: 1.415098, loss_ss: 1.268783, loss_d: 0.146315
Epoch finished! Loss: 1.131894741150049
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.096614, loss_ss: 0.869467, loss_d: 0.227147
0.0384 --- loss: 1.404762, loss_ss: 1.051038, loss_d: 0.353723
0.0768 --- loss: 1.164471, loss_ss: 0.871614, loss_d: 0.292857
0.1152 --- loss: 1.248828, loss_ss: 0.912368, loss_d: 0.336461
0.1536 --- loss: 1.005889, loss_ss: 0.885517, loss_d: 0.120372
0.1920 --- loss: 1.138239, loss_ss: 0.993741, loss_d: 0.144498
0.2304 --- loss: 0.808246, loss_ss: 0.729887, loss_d: 0.078359
0.2688 --- loss: 0.978525, loss_ss: 0.800610, loss_d: 0.177915
0.3072 --- loss: 1.003968, loss_ss: 0.919623, loss_d: 0.084345
0.3456 --- loss: 1.023449, loss_ss: 0.713954, loss_d: 0.309494
0.3840 --- loss: 1.254883, loss_ss: 0.760569, loss_d: 0.494314
0.4224 --- loss: 1.314533, loss_ss: 0.848931, loss_d: 0.465602
0.4608 --- loss: 0.827802, loss_ss: 0.681606, loss_d: 0.146196
0.4992 --- loss: 0.865541, loss_ss: 0.756452, loss_d: 0.109089
0.5376 --- loss: 0.920785, loss_ss: 0.723829, loss_d: 0.196957
0.5760 --- loss: 1.350926, loss_ss: 1.007865, loss_d: 0.343061
0.6144 --- loss: 0.884273, loss_ss: 0.826085, loss_d: 0.058189
0.6528 --- loss: 1.088255, loss_ss: 0.776855, loss_d: 0.311400
0.6912 --- loss: 1.860851, loss_ss: 0.675691, loss_d: 1.185160
0.7296 --- loss: 1.017873, loss_ss: 0.773325, loss_d: 0.244548
0.7680 --- loss: 1.104770, loss_ss: 0.925502, loss_d: 0.179268
0.8065 --- loss: 0.856702, loss_ss: 0.735953, loss_d: 0.120749
0.8449 --- loss: 0.971551, loss_ss: 0.752079, loss_d: 0.219472
0.8833 --- loss: 0.992446, loss_ss: 0.625626, loss_d: 0.366820
0.9217 --- loss: 0.994314, loss_ss: 0.831702, loss_d: 0.162612
0.9601 --- loss: 0.753348, loss_ss: 0.643307, loss_d: 0.110041
0.9985 --- loss: 0.891731, loss_ss: 0.857116, loss_d: 0.034615
Epoch finished! Loss: 1.1052930501791147
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7909715407262021
             precision    recall  f1-score   support

        0.0       0.92      0.80      0.86       101
        1.0       0.54      0.35      0.42        55
        2.0       0.75      0.82      0.78       382
        3.0       0.76      0.66      0.71       191
        4.0       0.86      0.92      0.89       290

avg / total       0.79      0.79      0.79      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  97.35  80.20   99.24  92.05     85.71
1  94.90  34.55   98.34  54.29     42.22
2  82.92  81.94   83.52  74.88     78.25
3  89.70  65.97   95.17  75.90     70.59
4  93.33  92.07   93.83  85.58     88.70
Total accuracy: 79.10%
Average sen: 70.94%
Average spec: 94.02%
Macro f1-score: 73.10%
[0.97709352 0.87497807 0.92602092 0.99841595 0.99822682 0.99812216
 0.99755752 0.98631442 0.99920684 0.99603289 0.99979287 0.99650013
 0.99778938 0.99995124 0.9824968  0.97661746 0.98095405 0.99474418
 0.99968231 0.99452657 0.99718624 0.99978381 0.99675363 0.90828484
 0.99234045 0.99956208 0.99409407 0.99952292 0.99955124 0.99665451
 0.98506564 0.97927105 0.99060434 0.91667914]
pred: 0.9832464141004226, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.346146, loss_ss: 1.639561, loss_d: 0.706585
0.0384 --- loss: 2.163164, loss_ss: 1.455463, loss_d: 0.707700
0.0768 --- loss: 1.964304, loss_ss: 1.554658, loss_d: 0.409646
0.1152 --- loss: 2.309246, loss_ss: 1.526925, loss_d: 0.782321
0.1536 --- loss: 2.052155, loss_ss: 1.309046, loss_d: 0.743108
0.1920 --- loss: 2.123397, loss_ss: 1.335766, loss_d: 0.787630
0.2304 --- loss: 1.791608, loss_ss: 1.217830, loss_d: 0.573779
0.2688 --- loss: 2.108857, loss_ss: 1.472132, loss_d: 0.636724
0.3072 --- loss: 1.914230, loss_ss: 1.256426, loss_d: 0.657804
0.3456 --- loss: 1.564192, loss_ss: 1.152713, loss_d: 0.411479
0.3840 --- loss: 1.799227, loss_ss: 1.303841, loss_d: 0.495385
0.4224 --- loss: 2.086679, loss_ss: 1.239349, loss_d: 0.847330
0.4608 --- loss: 1.545499, loss_ss: 1.284891, loss_d: 0.260608
0.4992 --- loss: 2.017474, loss_ss: 1.098063, loss_d: 0.919411
0.5376 --- loss: 2.020406, loss_ss: 1.195273, loss_d: 0.825133
0.5760 --- loss: 1.840391, loss_ss: 1.172123, loss_d: 0.668268
0.6144 --- loss: 1.752205, loss_ss: 1.169375, loss_d: 0.582830
0.6528 --- loss: 1.796732, loss_ss: 1.127949, loss_d: 0.668783
0.6912 --- loss: 1.815127, loss_ss: 1.233518, loss_d: 0.581610
0.7296 --- loss: 1.891401, loss_ss: 1.230062, loss_d: 0.661339
0.7680 --- loss: 1.582772, loss_ss: 0.951154, loss_d: 0.631618
0.8065 --- loss: 1.606019, loss_ss: 1.070333, loss_d: 0.535685
0.8449 --- loss: 1.603865, loss_ss: 1.121341, loss_d: 0.482524
0.8833 --- loss: 1.569261, loss_ss: 1.142257, loss_d: 0.427004
0.9217 --- loss: 1.921996, loss_ss: 1.138602, loss_d: 0.783394
0.9601 --- loss: 1.938487, loss_ss: 1.083362, loss_d: 0.855125
0.9985 --- loss: 2.089457, loss_ss: 0.984101, loss_d: 1.105356
Epoch finished! Loss: 1.8887049230245443
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.744429, loss_ss: 1.329544, loss_d: 0.414885
0.0384 --- loss: 1.816055, loss_ss: 1.135220, loss_d: 0.680834
0.0768 --- loss: 1.613996, loss_ss: 1.013337, loss_d: 0.600659
0.1152 --- loss: 1.445769, loss_ss: 1.100159, loss_d: 0.345609
0.1536 --- loss: 1.420909, loss_ss: 0.841614, loss_d: 0.579295
0.1920 --- loss: 1.815148, loss_ss: 1.143494, loss_d: 0.671654
0.2304 --- loss: 1.866009, loss_ss: 1.076790, loss_d: 0.789219
0.2688 --- loss: 1.631073, loss_ss: 1.113940, loss_d: 0.517133
0.3072 --- loss: 1.657324, loss_ss: 1.084114, loss_d: 0.573210
0.3456 --- loss: 1.874486, loss_ss: 0.878188, loss_d: 0.996298
0.3840 --- loss: 1.674432, loss_ss: 1.241363, loss_d: 0.433069
0.4224 --- loss: 1.674427, loss_ss: 0.926387, loss_d: 0.748040
0.4608 --- loss: 1.488219, loss_ss: 1.056036, loss_d: 0.432183
0.4992 --- loss: 1.884569, loss_ss: 0.940788, loss_d: 0.943781
0.5376 --- loss: 1.644409, loss_ss: 1.013363, loss_d: 0.631047
0.5760 --- loss: 1.521862, loss_ss: 1.012371, loss_d: 0.509490
0.6144 --- loss: 1.819751, loss_ss: 1.129324, loss_d: 0.690427
0.6528 --- loss: 1.800401, loss_ss: 0.948189, loss_d: 0.852212
0.6912 --- loss: 1.449034, loss_ss: 0.946279, loss_d: 0.502756
0.7296 --- loss: 1.623922, loss_ss: 1.088760, loss_d: 0.535163
0.7680 --- loss: 1.352537, loss_ss: 0.940211, loss_d: 0.412327
0.8065 --- loss: 1.449848, loss_ss: 0.821867, loss_d: 0.627981
0.8449 --- loss: 1.573532, loss_ss: 0.968689, loss_d: 0.604843
0.8833 --- loss: 2.160909, loss_ss: 1.460653, loss_d: 0.700256
0.9217 --- loss: 1.431443, loss_ss: 0.873034, loss_d: 0.558409
0.9601 --- loss: 1.350876, loss_ss: 0.910853, loss_d: 0.440023
0.9985 --- loss: 1.392044, loss_ss: 1.023299, loss_d: 0.368745
Epoch finished! Loss: 1.652746527011578
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.371723, loss_ss: 0.835278, loss_d: 0.536445
0.0384 --- loss: 1.605428, loss_ss: 0.975564, loss_d: 0.629863
0.0768 --- loss: 1.555827, loss_ss: 1.115153, loss_d: 0.440674
0.1152 --- loss: 1.748979, loss_ss: 1.095615, loss_d: 0.653365
0.1536 --- loss: 1.148200, loss_ss: 0.821036, loss_d: 0.327164
0.1920 --- loss: 1.527418, loss_ss: 1.178898, loss_d: 0.348520
0.2304 --- loss: 1.526833, loss_ss: 0.985917, loss_d: 0.540915
0.2688 --- loss: 1.591064, loss_ss: 1.118021, loss_d: 0.473043
0.3072 --- loss: 1.715330, loss_ss: 0.979659, loss_d: 0.735671
0.3456 --- loss: 1.544322, loss_ss: 0.831149, loss_d: 0.713174
0.3840 --- loss: 1.626016, loss_ss: 1.055793, loss_d: 0.570223
0.4224 --- loss: 1.755580, loss_ss: 1.274395, loss_d: 0.481185
0.4608 --- loss: 1.889690, loss_ss: 1.054639, loss_d: 0.835052
0.4992 --- loss: 1.460156, loss_ss: 0.896474, loss_d: 0.563682
0.5376 --- loss: 1.429153, loss_ss: 0.935711, loss_d: 0.493442
0.5760 --- loss: 1.454566, loss_ss: 0.902700, loss_d: 0.551866
0.6144 --- loss: 1.394262, loss_ss: 0.789705, loss_d: 0.604557
0.6528 --- loss: 1.360638, loss_ss: 0.771097, loss_d: 0.589541
0.6912 --- loss: 1.216900, loss_ss: 0.829349, loss_d: 0.387551
0.7296 --- loss: 1.608695, loss_ss: 1.115150, loss_d: 0.493545
0.7680 --- loss: 1.744933, loss_ss: 1.244525, loss_d: 0.500408
0.8065 --- loss: 1.549770, loss_ss: 0.940826, loss_d: 0.608944
0.8449 --- loss: 1.659232, loss_ss: 0.966559, loss_d: 0.692673
0.8833 --- loss: 1.174224, loss_ss: 0.846971, loss_d: 0.327253
0.9217 --- loss: 1.587847, loss_ss: 1.212665, loss_d: 0.375182
0.9601 --- loss: 1.453851, loss_ss: 0.968230, loss_d: 0.485620
0.9985 --- loss: 1.424449, loss_ss: 1.006467, loss_d: 0.417981
Epoch finished! Loss: 1.5496801871519823
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.306174, loss_ss: 0.956278, loss_d: 0.349896
0.0384 --- loss: 1.327225, loss_ss: 0.884214, loss_d: 0.443010
0.0768 --- loss: 2.161241, loss_ss: 1.097159, loss_d: 1.064082
0.1152 --- loss: 1.324349, loss_ss: 0.814991, loss_d: 0.509358
0.1536 --- loss: 1.734021, loss_ss: 1.172818, loss_d: 0.561203
0.1920 --- loss: 1.629037, loss_ss: 1.151307, loss_d: 0.477730
0.2304 --- loss: 1.738867, loss_ss: 1.251921, loss_d: 0.486946
0.2688 --- loss: 1.272573, loss_ss: 0.838383, loss_d: 0.434191
0.3072 --- loss: 1.587775, loss_ss: 0.826105, loss_d: 0.761670
0.3456 --- loss: 1.116435, loss_ss: 0.772390, loss_d: 0.344044
0.3840 --- loss: 1.148971, loss_ss: 0.751325, loss_d: 0.397646
0.4224 --- loss: 1.292130, loss_ss: 0.941829, loss_d: 0.350301
0.4608 --- loss: 1.142098, loss_ss: 0.852691, loss_d: 0.289407
0.4992 --- loss: 1.393906, loss_ss: 1.008163, loss_d: 0.385743
0.5376 --- loss: 1.707534, loss_ss: 0.987590, loss_d: 0.719944
0.5760 --- loss: 1.228196, loss_ss: 0.755316, loss_d: 0.472880
0.6144 --- loss: 1.245852, loss_ss: 0.843576, loss_d: 0.402276
0.6528 --- loss: 1.954684, loss_ss: 1.296373, loss_d: 0.658312
0.6912 --- loss: 1.383299, loss_ss: 1.019743, loss_d: 0.363557
0.7296 --- loss: 1.107020, loss_ss: 0.826283, loss_d: 0.280737
0.7680 --- loss: 1.369287, loss_ss: 0.902502, loss_d: 0.466785
0.8065 --- loss: 1.431221, loss_ss: 0.960973, loss_d: 0.470248
0.8449 --- loss: 1.358461, loss_ss: 0.860265, loss_d: 0.498197
0.8833 --- loss: 1.589819, loss_ss: 0.945051, loss_d: 0.644768
0.9217 --- loss: 1.685636, loss_ss: 0.977228, loss_d: 0.708407
0.9601 --- loss: 0.932224, loss_ss: 0.647049, loss_d: 0.285175
0.9985 --- loss: 1.485638, loss_ss: 1.198162, loss_d: 0.287476
Epoch finished! Loss: 1.460451989219739
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.246977, loss_ss: 0.789164, loss_d: 0.457813
0.0384 --- loss: 1.342425, loss_ss: 1.050067, loss_d: 0.292357
0.0768 --- loss: 1.321660, loss_ss: 0.920198, loss_d: 0.401462
0.1152 --- loss: 1.241372, loss_ss: 0.829666, loss_d: 0.411706
0.1536 --- loss: 1.077080, loss_ss: 0.706330, loss_d: 0.370750
0.1920 --- loss: 1.613306, loss_ss: 0.593651, loss_d: 1.019655
0.2304 --- loss: 1.483012, loss_ss: 1.064085, loss_d: 0.418927
0.2688 --- loss: 1.787705, loss_ss: 0.778127, loss_d: 1.009578
0.3072 --- loss: 1.743800, loss_ss: 1.001075, loss_d: 0.742724
0.3456 --- loss: 1.557887, loss_ss: 1.101759, loss_d: 0.456128
0.3840 --- loss: 1.213245, loss_ss: 0.871005, loss_d: 0.342241
0.4224 --- loss: 1.493541, loss_ss: 0.786739, loss_d: 0.706803
0.4608 --- loss: 1.156135, loss_ss: 0.799801, loss_d: 0.356334
0.4992 --- loss: 1.497226, loss_ss: 0.695493, loss_d: 0.801733
0.5376 --- loss: 1.264355, loss_ss: 0.948579, loss_d: 0.315776
0.5760 --- loss: 1.345920, loss_ss: 1.048146, loss_d: 0.297774
0.6144 --- loss: 1.404231, loss_ss: 0.922139, loss_d: 0.482092
0.6528 --- loss: 1.277220, loss_ss: 0.869411, loss_d: 0.407809
0.6912 --- loss: 1.334359, loss_ss: 1.063287, loss_d: 0.271072
0.7296 --- loss: 1.610368, loss_ss: 1.189486, loss_d: 0.420882
0.7680 --- loss: 1.365955, loss_ss: 1.120090, loss_d: 0.245866
0.8065 --- loss: 1.118655, loss_ss: 0.721376, loss_d: 0.397279
0.8449 --- loss: 1.325945, loss_ss: 0.853933, loss_d: 0.472013
0.8833 --- loss: 1.235328, loss_ss: 0.726777, loss_d: 0.508551
0.9217 --- loss: 1.531007, loss_ss: 0.908540, loss_d: 0.622467
0.9601 --- loss: 1.719151, loss_ss: 0.725610, loss_d: 0.993540
0.9985 --- loss: 1.545883, loss_ss: 1.087910, loss_d: 0.457973
Epoch finished! Loss: 1.3964200469163748
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.582766, loss_ss: 1.074584, loss_d: 0.508182
0.0384 --- loss: 1.093207, loss_ss: 0.646033, loss_d: 0.447174
0.0768 --- loss: 1.365613, loss_ss: 0.850584, loss_d: 0.515029
0.1152 --- loss: 1.243017, loss_ss: 0.945775, loss_d: 0.297242
0.1536 --- loss: 1.510846, loss_ss: 0.808010, loss_d: 0.702836
0.1920 --- loss: 1.190380, loss_ss: 0.783307, loss_d: 0.407073
0.2304 --- loss: 1.360672, loss_ss: 0.972095, loss_d: 0.388577
0.2688 --- loss: 1.164038, loss_ss: 0.838868, loss_d: 0.325170
0.3072 --- loss: 1.246552, loss_ss: 0.802053, loss_d: 0.444499
0.3456 --- loss: 1.481243, loss_ss: 1.072103, loss_d: 0.409140
0.3840 --- loss: 1.817885, loss_ss: 1.179512, loss_d: 0.638373
0.4224 --- loss: 1.120757, loss_ss: 0.893436, loss_d: 0.227321
0.4608 --- loss: 1.009014, loss_ss: 0.797480, loss_d: 0.211534
0.4992 --- loss: 1.275722, loss_ss: 0.890256, loss_d: 0.385466
0.5376 --- loss: 1.518972, loss_ss: 1.024716, loss_d: 0.494256
0.5760 --- loss: 1.301855, loss_ss: 0.919946, loss_d: 0.381908
0.6144 --- loss: 1.150901, loss_ss: 0.882933, loss_d: 0.267968
0.6528 --- loss: 1.178100, loss_ss: 0.942378, loss_d: 0.235721
0.6912 --- loss: 1.036428, loss_ss: 0.793640, loss_d: 0.242788
0.7296 --- loss: 1.127456, loss_ss: 0.698234, loss_d: 0.429222
0.7680 --- loss: 1.094360, loss_ss: 0.847377, loss_d: 0.246982
0.8065 --- loss: 1.385757, loss_ss: 0.958595, loss_d: 0.427162
0.8449 --- loss: 1.020071, loss_ss: 0.815003, loss_d: 0.205067
0.8833 --- loss: 1.247696, loss_ss: 0.954108, loss_d: 0.293588
0.9217 --- loss: 1.598442, loss_ss: 0.869714, loss_d: 0.728727
0.9601 --- loss: 1.206325, loss_ss: 0.735652, loss_d: 0.470673
0.9985 --- loss: 1.049195, loss_ss: 0.688430, loss_d: 0.360765
Epoch finished! Loss: 1.3386437796629391
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.587923, loss_ss: 1.190609, loss_d: 0.397314
0.0384 --- loss: 1.381159, loss_ss: 0.923552, loss_d: 0.457608
0.0768 --- loss: 1.549800, loss_ss: 1.171426, loss_d: 0.378374
0.1152 --- loss: 1.462579, loss_ss: 0.748838, loss_d: 0.713741
0.1536 --- loss: 0.794519, loss_ss: 0.645241, loss_d: 0.149279
0.1920 --- loss: 1.471483, loss_ss: 0.886863, loss_d: 0.584621
0.2304 --- loss: 1.164743, loss_ss: 0.813071, loss_d: 0.351673
0.2688 --- loss: 1.180531, loss_ss: 0.861558, loss_d: 0.318973
0.3072 --- loss: 1.086593, loss_ss: 0.865408, loss_d: 0.221185
0.3456 --- loss: 1.160743, loss_ss: 0.890702, loss_d: 0.270042
0.3840 --- loss: 1.491918, loss_ss: 0.980296, loss_d: 0.511622
0.4224 --- loss: 1.049844, loss_ss: 0.889842, loss_d: 0.160002
0.4608 --- loss: 1.206922, loss_ss: 0.820993, loss_d: 0.385930
0.4992 --- loss: 1.635755, loss_ss: 1.199371, loss_d: 0.436384
0.5376 --- loss: 1.545490, loss_ss: 0.794423, loss_d: 0.751067
0.5760 --- loss: 1.067239, loss_ss: 0.813217, loss_d: 0.254023
0.6144 --- loss: 1.824397, loss_ss: 0.904589, loss_d: 0.919808
0.6528 --- loss: 1.217231, loss_ss: 1.006984, loss_d: 0.210248
0.6912 --- loss: 1.336104, loss_ss: 1.099214, loss_d: 0.236890
0.7296 --- loss: 1.306112, loss_ss: 1.006187, loss_d: 0.299925
0.7680 --- loss: 1.202306, loss_ss: 0.711795, loss_d: 0.490511
0.8065 --- loss: 1.217972, loss_ss: 0.928911, loss_d: 0.289060
0.8449 --- loss: 1.082105, loss_ss: 0.625378, loss_d: 0.456727
0.8833 --- loss: 1.382181, loss_ss: 0.999594, loss_d: 0.382587
0.9217 --- loss: 1.270666, loss_ss: 1.011740, loss_d: 0.258926
0.9601 --- loss: 1.212847, loss_ss: 0.833638, loss_d: 0.379209
0.9985 --- loss: 1.235110, loss_ss: 0.775693, loss_d: 0.459417
Epoch finished! Loss: 1.2620236969911136
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.162040, loss_ss: 0.786898, loss_d: 0.375142
0.0384 --- loss: 1.351936, loss_ss: 0.990083, loss_d: 0.361852
0.0768 --- loss: 1.328458, loss_ss: 0.945542, loss_d: 0.382916
0.1152 --- loss: 1.581213, loss_ss: 0.874465, loss_d: 0.706748
0.1536 --- loss: 1.186011, loss_ss: 0.876853, loss_d: 0.309159
0.1920 --- loss: 1.057488, loss_ss: 0.733169, loss_d: 0.324319
0.2304 --- loss: 1.292723, loss_ss: 1.026505, loss_d: 0.266218
0.2688 --- loss: 0.883802, loss_ss: 0.689851, loss_d: 0.193951
0.3072 --- loss: 1.393231, loss_ss: 0.846597, loss_d: 0.546634
0.3456 --- loss: 1.771024, loss_ss: 1.441160, loss_d: 0.329865
0.3840 --- loss: 1.494811, loss_ss: 0.659653, loss_d: 0.835159
0.4224 --- loss: 1.072842, loss_ss: 0.749501, loss_d: 0.323341
0.4608 --- loss: 1.282092, loss_ss: 0.853243, loss_d: 0.428849
0.4992 --- loss: 0.913931, loss_ss: 0.788002, loss_d: 0.125929
0.5376 --- loss: 1.947242, loss_ss: 0.938354, loss_d: 1.008889
0.5760 --- loss: 1.130916, loss_ss: 0.898649, loss_d: 0.232267
0.6144 --- loss: 1.014843, loss_ss: 0.672638, loss_d: 0.342205
0.6528 --- loss: 1.043929, loss_ss: 0.836346, loss_d: 0.207582
0.6912 --- loss: 1.698514, loss_ss: 0.835394, loss_d: 0.863120
0.7296 --- loss: 1.252500, loss_ss: 1.073935, loss_d: 0.178564
0.7680 --- loss: 1.438214, loss_ss: 1.103716, loss_d: 0.334497
0.8065 --- loss: 1.261378, loss_ss: 0.992410, loss_d: 0.268968
0.8449 --- loss: 1.002213, loss_ss: 0.808870, loss_d: 0.193342
0.8833 --- loss: 1.103592, loss_ss: 0.924073, loss_d: 0.179519
0.9217 --- loss: 1.187588, loss_ss: 0.970322, loss_d: 0.217266
0.9601 --- loss: 1.219651, loss_ss: 0.527539, loss_d: 0.692111
0.9985 --- loss: 2.427303, loss_ss: 1.316364, loss_d: 1.110939
Epoch finished! Loss: 1.2392401940547504
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.121483, loss_ss: 0.722209, loss_d: 0.399274
0.0384 --- loss: 1.309374, loss_ss: 0.892039, loss_d: 0.417335
0.0768 --- loss: 1.135048, loss_ss: 0.931897, loss_d: 0.203151
0.1152 --- loss: 1.149174, loss_ss: 0.779856, loss_d: 0.369318
0.1536 --- loss: 1.180450, loss_ss: 1.036191, loss_d: 0.144260
0.1920 --- loss: 1.124852, loss_ss: 0.826512, loss_d: 0.298340
0.2304 --- loss: 0.854511, loss_ss: 0.580133, loss_d: 0.274378
0.2688 --- loss: 0.935379, loss_ss: 0.730520, loss_d: 0.204858
0.3072 --- loss: 1.413397, loss_ss: 1.135660, loss_d: 0.277737
0.3456 --- loss: 1.073374, loss_ss: 0.834181, loss_d: 0.239194
0.3840 --- loss: 1.255026, loss_ss: 0.802426, loss_d: 0.452600
0.4224 --- loss: 1.219770, loss_ss: 0.935916, loss_d: 0.283855
0.4608 --- loss: 1.174064, loss_ss: 0.903767, loss_d: 0.270297
0.4992 --- loss: 1.034491, loss_ss: 0.780409, loss_d: 0.254082
0.5376 --- loss: 1.029691, loss_ss: 0.780042, loss_d: 0.249649
0.5760 --- loss: 1.243810, loss_ss: 0.846231, loss_d: 0.397579
0.6144 --- loss: 1.171373, loss_ss: 0.826403, loss_d: 0.344970
0.6528 --- loss: 1.272433, loss_ss: 0.922283, loss_d: 0.350150
0.6912 --- loss: 1.663784, loss_ss: 1.051107, loss_d: 0.612677
0.7296 --- loss: 1.409952, loss_ss: 0.992754, loss_d: 0.417198
0.7680 --- loss: 0.720855, loss_ss: 0.511891, loss_d: 0.208964
0.8065 --- loss: 1.340285, loss_ss: 0.938899, loss_d: 0.401386
0.8449 --- loss: 1.296799, loss_ss: 1.115740, loss_d: 0.181060
0.8833 --- loss: 1.206042, loss_ss: 1.010059, loss_d: 0.195983
0.9217 --- loss: 1.034179, loss_ss: 0.851735, loss_d: 0.182444
0.9601 --- loss: 1.026441, loss_ss: 0.587069, loss_d: 0.439371
0.9985 --- loss: 1.528543, loss_ss: 1.097662, loss_d: 0.430881
Epoch finished! Loss: 1.191356758429454
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.799325, loss_ss: 0.652960, loss_d: 0.146366
0.0384 --- loss: 1.180658, loss_ss: 0.975940, loss_d: 0.204718
0.0768 --- loss: 1.141604, loss_ss: 0.741676, loss_d: 0.399928
0.1152 --- loss: 1.022399, loss_ss: 0.900798, loss_d: 0.121601
0.1536 --- loss: 1.504215, loss_ss: 0.605127, loss_d: 0.899088
0.1920 --- loss: 0.986369, loss_ss: 0.810104, loss_d: 0.176264
0.2304 --- loss: 0.973247, loss_ss: 0.734693, loss_d: 0.238554
0.2688 --- loss: 1.517588, loss_ss: 0.882951, loss_d: 0.634637
0.3072 --- loss: 1.320791, loss_ss: 0.974470, loss_d: 0.346321
0.3456 --- loss: 1.084941, loss_ss: 0.846436, loss_d: 0.238504
0.3840 --- loss: 0.930180, loss_ss: 0.795824, loss_d: 0.134356
0.4224 --- loss: 0.922537, loss_ss: 0.805205, loss_d: 0.117332
0.4608 --- loss: 0.976361, loss_ss: 0.816544, loss_d: 0.159817
0.4992 --- loss: 1.322003, loss_ss: 0.916377, loss_d: 0.405626
0.5376 --- loss: 1.767271, loss_ss: 1.292880, loss_d: 0.474391
0.5760 --- loss: 0.874889, loss_ss: 0.637233, loss_d: 0.237656
0.6144 --- loss: 1.076264, loss_ss: 0.847480, loss_d: 0.228784
0.6528 --- loss: 1.106606, loss_ss: 0.910066, loss_d: 0.196540
0.6912 --- loss: 1.452876, loss_ss: 1.054790, loss_d: 0.398085
0.7296 --- loss: 1.047675, loss_ss: 0.726980, loss_d: 0.320695
0.7680 --- loss: 1.097678, loss_ss: 0.927745, loss_d: 0.169933
0.8065 --- loss: 1.042869, loss_ss: 0.726855, loss_d: 0.316014
0.8449 --- loss: 0.874008, loss_ss: 0.739900, loss_d: 0.134108
0.8833 --- loss: 1.080618, loss_ss: 0.768327, loss_d: 0.312290
0.9217 --- loss: 1.227579, loss_ss: 0.877954, loss_d: 0.349624
0.9601 --- loss: 1.039496, loss_ss: 0.859383, loss_d: 0.180113
0.9985 --- loss: 0.976950, loss_ss: 0.889636, loss_d: 0.087314
Epoch finished! Loss: 1.1463814609325849
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6480392156862745
             precision    recall  f1-score   support

        0.0       0.49      0.77      0.60        66
        1.0       0.00      0.00      0.00        44
        2.0       0.72      0.48      0.58       406
        3.0       0.63      0.90      0.74       334
        4.0       0.69      0.66      0.67       170

avg / total       0.64      0.65      0.62      1020
 


====== chp029-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  93.33  77.27   94.44  49.04     60.00
1  95.69   0.00  100.00   0.00      0.00
2  71.96  48.28   87.62  72.06     57.82
3  79.22  90.42   73.76  62.66     74.02
4  89.41  65.88   94.12  69.14     67.47
Total accuracy: 64.80%
Average sen: 56.37%
Average spec: 89.99%
Macro f1-score: 51.86%
[0.99622822 0.99328208 0.99316978 0.99445951 0.99681681 0.99819332
 0.99601632 0.98904246 0.99486935 0.99848974 0.99591368 0.99534321
 0.99673009 0.99713516 0.99332339 0.97789043 0.99825937 0.99793172
 0.99418133 0.99272174 0.99422967 0.99431568 0.99817002 0.99785513
 0.99793005 0.90467101 0.99797326 0.99873799 0.99817514 0.99816847
 0.99656677 0.98051101 0.98769838 0.99782652]
pred: 0.9921419655575472, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.286443, loss_ss: 1.547125, loss_d: 0.739318
0.0385 --- loss: 1.974257, loss_ss: 1.422389, loss_d: 0.551868
0.0770 --- loss: 1.986777, loss_ss: 1.153943, loss_d: 0.832834
0.1155 --- loss: 2.246732, loss_ss: 1.695322, loss_d: 0.551410
0.1540 --- loss: 2.305191, loss_ss: 1.399899, loss_d: 0.905291
0.1925 --- loss: 1.837808, loss_ss: 1.307396, loss_d: 0.530412
0.2309 --- loss: 1.768516, loss_ss: 1.283621, loss_d: 0.484894
0.2694 --- loss: 1.788911, loss_ss: 1.441567, loss_d: 0.347344
0.3079 --- loss: 1.945382, loss_ss: 1.218855, loss_d: 0.726526
0.3464 --- loss: 1.995749, loss_ss: 1.331161, loss_d: 0.664587
0.3849 --- loss: 1.708559, loss_ss: 1.389751, loss_d: 0.318808
0.4234 --- loss: 1.832517, loss_ss: 1.168288, loss_d: 0.664229
0.4619 --- loss: 1.825378, loss_ss: 1.071885, loss_d: 0.753493
0.5004 --- loss: 2.200388, loss_ss: 1.485494, loss_d: 0.714895
0.5389 --- loss: 1.830806, loss_ss: 1.196259, loss_d: 0.634547
0.5774 --- loss: 1.936126, loss_ss: 1.282325, loss_d: 0.653801
0.6159 --- loss: 2.052368, loss_ss: 1.274757, loss_d: 0.777611
0.6543 --- loss: 1.893952, loss_ss: 1.122027, loss_d: 0.771925
0.6928 --- loss: 1.931197, loss_ss: 1.176316, loss_d: 0.754881
0.7313 --- loss: 1.834576, loss_ss: 1.067572, loss_d: 0.767004
0.7698 --- loss: 1.859277, loss_ss: 1.346722, loss_d: 0.512556
0.8083 --- loss: 1.850281, loss_ss: 1.300108, loss_d: 0.550173
0.8468 --- loss: 1.876967, loss_ss: 1.070567, loss_d: 0.806400
0.8853 --- loss: 1.769196, loss_ss: 1.056741, loss_d: 0.712454
0.9238 --- loss: 1.695350, loss_ss: 1.103663, loss_d: 0.591687
0.9623 --- loss: 1.876530, loss_ss: 1.102023, loss_d: 0.774507
Epoch finished! Loss: 1.9438210845453858
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.690328, loss_ss: 1.283605, loss_d: 0.406723
0.0385 --- loss: 1.950887, loss_ss: 1.381192, loss_d: 0.569695
0.0770 --- loss: 1.867788, loss_ss: 1.179165, loss_d: 0.688623
0.1155 --- loss: 1.883350, loss_ss: 1.122580, loss_d: 0.760770
0.1540 --- loss: 1.786072, loss_ss: 1.234657, loss_d: 0.551414
0.1925 --- loss: 1.856462, loss_ss: 1.273475, loss_d: 0.582987
0.2309 --- loss: 1.876564, loss_ss: 1.334640, loss_d: 0.541924
0.2694 --- loss: 1.603423, loss_ss: 1.311506, loss_d: 0.291916
0.3079 --- loss: 1.828147, loss_ss: 1.326006, loss_d: 0.502141
0.3464 --- loss: 1.388543, loss_ss: 0.918002, loss_d: 0.470542
0.3849 --- loss: 1.626835, loss_ss: 1.097165, loss_d: 0.529669
0.4234 --- loss: 1.922075, loss_ss: 1.295593, loss_d: 0.626481
0.4619 --- loss: 2.099817, loss_ss: 1.286909, loss_d: 0.812908
0.5004 --- loss: 1.476835, loss_ss: 1.061047, loss_d: 0.415788
0.5389 --- loss: 1.885244, loss_ss: 1.221843, loss_d: 0.663401
0.5774 --- loss: 1.649168, loss_ss: 0.941445, loss_d: 0.707723
0.6159 --- loss: 1.597319, loss_ss: 1.060207, loss_d: 0.537112
0.6543 --- loss: 1.457810, loss_ss: 1.097041, loss_d: 0.360769
0.6928 --- loss: 1.444939, loss_ss: 1.114170, loss_d: 0.330769
0.7313 --- loss: 1.707209, loss_ss: 0.964983, loss_d: 0.742226
0.7698 --- loss: 1.707334, loss_ss: 1.217627, loss_d: 0.489707
0.8083 --- loss: 1.612921, loss_ss: 0.980190, loss_d: 0.632731
0.8468 --- loss: 1.455514, loss_ss: 0.889503, loss_d: 0.566011
0.8853 --- loss: 1.396655, loss_ss: 1.028234, loss_d: 0.368421
0.9238 --- loss: 1.275686, loss_ss: 0.942748, loss_d: 0.332938
0.9623 --- loss: 1.562857, loss_ss: 1.135694, loss_d: 0.427162
Epoch finished! Loss: 1.7232649455199371
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.665012, loss_ss: 1.008566, loss_d: 0.656446
0.0385 --- loss: 1.943736, loss_ss: 1.283883, loss_d: 0.659853
0.0770 --- loss: 1.401499, loss_ss: 1.124462, loss_d: 0.277037
0.1155 --- loss: 1.482852, loss_ss: 0.984888, loss_d: 0.497964
0.1540 --- loss: 1.531974, loss_ss: 0.868329, loss_d: 0.663645
0.1925 --- loss: 1.325944, loss_ss: 0.919754, loss_d: 0.406190
0.2309 --- loss: 1.868443, loss_ss: 1.232411, loss_d: 0.636032
0.2694 --- loss: 1.576520, loss_ss: 1.137813, loss_d: 0.438707
0.3079 --- loss: 1.892478, loss_ss: 1.077111, loss_d: 0.815367
0.3464 --- loss: 1.691306, loss_ss: 1.304889, loss_d: 0.386417
0.3849 --- loss: 1.761572, loss_ss: 1.120423, loss_d: 0.641149
0.4234 --- loss: 1.719825, loss_ss: 1.156572, loss_d: 0.563254
0.4619 --- loss: 1.280153, loss_ss: 1.012909, loss_d: 0.267244
0.5004 --- loss: 1.639944, loss_ss: 1.026758, loss_d: 0.613186
0.5389 --- loss: 1.370322, loss_ss: 1.032318, loss_d: 0.338004
0.5774 --- loss: 1.423577, loss_ss: 1.186955, loss_d: 0.236623
0.6159 --- loss: 1.644776, loss_ss: 1.060125, loss_d: 0.584652
0.6543 --- loss: 1.869363, loss_ss: 1.252600, loss_d: 0.616763
0.6928 --- loss: 1.376105, loss_ss: 0.842022, loss_d: 0.534083
0.7313 --- loss: 1.487015, loss_ss: 0.898314, loss_d: 0.588700
0.7698 --- loss: 1.732388, loss_ss: 0.991739, loss_d: 0.740649
0.8083 --- loss: 1.292400, loss_ss: 0.816352, loss_d: 0.476049
0.8468 --- loss: 1.457678, loss_ss: 0.973240, loss_d: 0.484437
0.8853 --- loss: 1.199302, loss_ss: 0.965697, loss_d: 0.233605
0.9238 --- loss: 1.432401, loss_ss: 0.971743, loss_d: 0.460657
0.9623 --- loss: 1.288422, loss_ss: 0.897519, loss_d: 0.390904
Epoch finished! Loss: 1.5403921756044778
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.543469, loss_ss: 0.975210, loss_d: 0.568259
0.0385 --- loss: 1.393073, loss_ss: 1.025384, loss_d: 0.367689
0.0770 --- loss: 1.532082, loss_ss: 1.077265, loss_d: 0.454818
0.1155 --- loss: 1.736870, loss_ss: 1.183864, loss_d: 0.553005
0.1540 --- loss: 1.388598, loss_ss: 0.934514, loss_d: 0.454083
0.1925 --- loss: 1.390814, loss_ss: 0.856925, loss_d: 0.533889
0.2309 --- loss: 1.305501, loss_ss: 0.862011, loss_d: 0.443490
0.2694 --- loss: 1.136135, loss_ss: 0.772717, loss_d: 0.363417
0.3079 --- loss: 1.014014, loss_ss: 0.707352, loss_d: 0.306662
0.3464 --- loss: 1.404528, loss_ss: 1.002725, loss_d: 0.401803
0.3849 --- loss: 1.572549, loss_ss: 0.864869, loss_d: 0.707680
0.4234 --- loss: 1.371424, loss_ss: 1.014296, loss_d: 0.357128
0.4619 --- loss: 1.686180, loss_ss: 0.860450, loss_d: 0.825730
0.5004 --- loss: 1.580567, loss_ss: 1.246841, loss_d: 0.333726
0.5389 --- loss: 1.413136, loss_ss: 0.916057, loss_d: 0.497080
0.5774 --- loss: 1.117614, loss_ss: 0.869466, loss_d: 0.248149
0.6159 --- loss: 1.160380, loss_ss: 0.803637, loss_d: 0.356743
0.6543 --- loss: 1.345684, loss_ss: 0.834763, loss_d: 0.510921
0.6928 --- loss: 1.172505, loss_ss: 0.959795, loss_d: 0.212710
0.7313 --- loss: 1.831833, loss_ss: 1.008762, loss_d: 0.823070
0.7698 --- loss: 1.819675, loss_ss: 1.376189, loss_d: 0.443486
0.8083 --- loss: 1.238094, loss_ss: 0.859018, loss_d: 0.379076
0.8468 --- loss: 1.140582, loss_ss: 0.945929, loss_d: 0.194653
0.8853 --- loss: 1.309532, loss_ss: 1.108202, loss_d: 0.201330
0.9238 --- loss: 1.323561, loss_ss: 1.026298, loss_d: 0.297263
0.9623 --- loss: 1.139146, loss_ss: 0.885797, loss_d: 0.253349
Epoch finished! Loss: 1.4026396640479335
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.541903, loss_ss: 0.892200, loss_d: 0.649703
0.0385 --- loss: 1.320595, loss_ss: 0.960262, loss_d: 0.360333
0.0770 --- loss: 1.131674, loss_ss: 0.928700, loss_d: 0.202974
0.1155 --- loss: 2.010292, loss_ss: 1.324118, loss_d: 0.686175
0.1540 --- loss: 1.167565, loss_ss: 0.966648, loss_d: 0.200917
0.1925 --- loss: 1.267944, loss_ss: 0.892259, loss_d: 0.375685
0.2309 --- loss: 1.332530, loss_ss: 0.745886, loss_d: 0.586643
0.2694 --- loss: 1.598657, loss_ss: 1.102206, loss_d: 0.496451
0.3079 --- loss: 1.029310, loss_ss: 0.642819, loss_d: 0.386491
0.3464 --- loss: 1.159199, loss_ss: 0.759636, loss_d: 0.399563
0.3849 --- loss: 1.301637, loss_ss: 0.925660, loss_d: 0.375977
0.4234 --- loss: 1.069668, loss_ss: 0.826039, loss_d: 0.243629
0.4619 --- loss: 1.645514, loss_ss: 0.820420, loss_d: 0.825095
0.5004 --- loss: 1.442465, loss_ss: 0.987648, loss_d: 0.454817
0.5389 --- loss: 1.560030, loss_ss: 0.896869, loss_d: 0.663161
0.5774 --- loss: 1.181515, loss_ss: 0.829239, loss_d: 0.352277
0.6159 --- loss: 1.482322, loss_ss: 1.111787, loss_d: 0.370536
0.6543 --- loss: 1.267937, loss_ss: 1.028738, loss_d: 0.239199
0.6928 --- loss: 1.292661, loss_ss: 1.076861, loss_d: 0.215800
0.7313 --- loss: 1.208534, loss_ss: 0.965271, loss_d: 0.243264
0.7698 --- loss: 1.097813, loss_ss: 0.683269, loss_d: 0.414543
0.8083 --- loss: 1.033998, loss_ss: 0.647418, loss_d: 0.386580
0.8468 --- loss: 1.466303, loss_ss: 0.992644, loss_d: 0.473659
0.8853 --- loss: 1.279040, loss_ss: 1.073274, loss_d: 0.205766
0.9238 --- loss: 1.516431, loss_ss: 1.271528, loss_d: 0.244903
0.9623 --- loss: 0.959670, loss_ss: 0.819143, loss_d: 0.140526
Epoch finished! Loss: 1.2946854549025015
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.275232, loss_ss: 0.939295, loss_d: 0.335937
0.0385 --- loss: 1.233237, loss_ss: 1.022026, loss_d: 0.211210
0.0770 --- loss: 1.323615, loss_ss: 1.037239, loss_d: 0.286375
0.1155 --- loss: 1.042065, loss_ss: 0.909050, loss_d: 0.133015
0.1540 --- loss: 1.131459, loss_ss: 0.836418, loss_d: 0.295041
0.1925 --- loss: 1.170247, loss_ss: 0.916423, loss_d: 0.253825
0.2309 --- loss: 1.319586, loss_ss: 1.149640, loss_d: 0.169946
0.2694 --- loss: 1.185562, loss_ss: 0.822120, loss_d: 0.363442
0.3079 --- loss: 1.634779, loss_ss: 0.854045, loss_d: 0.780734
0.3464 --- loss: 2.094117, loss_ss: 1.517421, loss_d: 0.576697
0.3849 --- loss: 1.148665, loss_ss: 0.813387, loss_d: 0.335278
0.4234 --- loss: 1.198367, loss_ss: 0.758499, loss_d: 0.439868
0.4619 --- loss: 0.947598, loss_ss: 0.770317, loss_d: 0.177281
0.5004 --- loss: 1.395138, loss_ss: 0.980738, loss_d: 0.414400
0.5389 --- loss: 1.062998, loss_ss: 0.778341, loss_d: 0.284657
0.5774 --- loss: 1.105703, loss_ss: 0.863580, loss_d: 0.242124
0.6159 --- loss: 1.042741, loss_ss: 0.810984, loss_d: 0.231757
0.6543 --- loss: 1.334684, loss_ss: 0.714064, loss_d: 0.620621
0.6928 --- loss: 0.959140, loss_ss: 0.685142, loss_d: 0.273997
0.7313 --- loss: 1.839234, loss_ss: 1.299629, loss_d: 0.539605
0.7698 --- loss: 1.114771, loss_ss: 0.760655, loss_d: 0.354116
0.8083 --- loss: 1.064933, loss_ss: 0.823474, loss_d: 0.241459
0.8468 --- loss: 1.250583, loss_ss: 0.990322, loss_d: 0.260260
0.8853 --- loss: 1.298569, loss_ss: 0.689842, loss_d: 0.608727
0.9238 --- loss: 1.012659, loss_ss: 0.862851, loss_d: 0.149808
0.9623 --- loss: 1.445693, loss_ss: 0.832925, loss_d: 0.612768
Epoch finished! Loss: 1.2368576061771643
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.235025, loss_ss: 0.969141, loss_d: 0.265884
0.0385 --- loss: 0.950035, loss_ss: 0.680978, loss_d: 0.269057
0.0770 --- loss: 1.252141, loss_ss: 0.874132, loss_d: 0.378009
0.1155 --- loss: 1.008130, loss_ss: 0.835250, loss_d: 0.172880
0.1540 --- loss: 1.095758, loss_ss: 0.872143, loss_d: 0.223615
0.1925 --- loss: 1.053242, loss_ss: 0.891306, loss_d: 0.161936
0.2309 --- loss: 1.328066, loss_ss: 0.987229, loss_d: 0.340837
0.2694 --- loss: 1.389493, loss_ss: 0.775823, loss_d: 0.613670
0.3079 --- loss: 1.652467, loss_ss: 1.111459, loss_d: 0.541007
0.3464 --- loss: 1.065728, loss_ss: 0.773799, loss_d: 0.291929
0.3849 --- loss: 1.220233, loss_ss: 0.922522, loss_d: 0.297711
0.4234 --- loss: 0.730129, loss_ss: 0.584807, loss_d: 0.145322
0.4619 --- loss: 1.384307, loss_ss: 0.994102, loss_d: 0.390205
0.5004 --- loss: 1.064845, loss_ss: 0.876758, loss_d: 0.188087
0.5389 --- loss: 1.102608, loss_ss: 0.880966, loss_d: 0.221642
0.5774 --- loss: 0.928328, loss_ss: 0.707594, loss_d: 0.220734
0.6159 --- loss: 1.399840, loss_ss: 0.809202, loss_d: 0.590637
0.6543 --- loss: 1.349821, loss_ss: 1.211930, loss_d: 0.137892
0.6928 --- loss: 1.600536, loss_ss: 1.087510, loss_d: 0.513026
0.7313 --- loss: 0.958406, loss_ss: 0.834890, loss_d: 0.123516
0.7698 --- loss: 1.519315, loss_ss: 0.774625, loss_d: 0.744690
0.8083 --- loss: 0.878455, loss_ss: 0.683286, loss_d: 0.195168
0.8468 --- loss: 1.392060, loss_ss: 1.047955, loss_d: 0.344105
0.8853 --- loss: 1.098714, loss_ss: 1.009092, loss_d: 0.089621
0.9238 --- loss: 0.902304, loss_ss: 0.807881, loss_d: 0.094422
0.9623 --- loss: 1.528548, loss_ss: 1.144563, loss_d: 0.383985
Epoch finished! Loss: 1.1819023126340742
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.096812, loss_ss: 0.992222, loss_d: 0.104590
0.0385 --- loss: 1.083469, loss_ss: 1.010394, loss_d: 0.073075
0.0770 --- loss: 0.901858, loss_ss: 0.789674, loss_d: 0.112184
0.1155 --- loss: 1.279510, loss_ss: 1.007786, loss_d: 0.271724
0.1540 --- loss: 0.906498, loss_ss: 0.597317, loss_d: 0.309182
0.1925 --- loss: 0.901300, loss_ss: 0.835543, loss_d: 0.065757
0.2309 --- loss: 1.264187, loss_ss: 0.709954, loss_d: 0.554233
0.2694 --- loss: 1.271339, loss_ss: 0.666210, loss_d: 0.605129
0.3079 --- loss: 1.419900, loss_ss: 0.887419, loss_d: 0.532481
0.3464 --- loss: 1.299010, loss_ss: 0.823259, loss_d: 0.475751
0.3849 --- loss: 1.325682, loss_ss: 1.062449, loss_d: 0.263233
0.4234 --- loss: 0.981303, loss_ss: 0.764724, loss_d: 0.216579
0.4619 --- loss: 1.059679, loss_ss: 0.908092, loss_d: 0.151587
0.5004 --- loss: 0.943318, loss_ss: 0.725651, loss_d: 0.217667
0.5389 --- loss: 0.940735, loss_ss: 0.782800, loss_d: 0.157936
0.5774 --- loss: 0.846860, loss_ss: 0.764093, loss_d: 0.082767
0.6159 --- loss: 1.154445, loss_ss: 0.844139, loss_d: 0.310306
0.6543 --- loss: 1.985156, loss_ss: 1.792892, loss_d: 0.192264
0.6928 --- loss: 1.542698, loss_ss: 1.260027, loss_d: 0.282671
0.7313 --- loss: 1.320178, loss_ss: 0.866609, loss_d: 0.453568
0.7698 --- loss: 1.052890, loss_ss: 0.885011, loss_d: 0.167879
0.8083 --- loss: 1.350436, loss_ss: 0.958685, loss_d: 0.391751
0.8468 --- loss: 1.351187, loss_ss: 0.863319, loss_d: 0.487869
0.8853 --- loss: 0.872145, loss_ss: 0.688917, loss_d: 0.183228
0.9238 --- loss: 0.888034, loss_ss: 0.766842, loss_d: 0.121192
0.9623 --- loss: 1.052799, loss_ss: 0.978533, loss_d: 0.074266
Epoch finished! Loss: 1.1480869963822677
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.070233, loss_ss: 1.006066, loss_d: 0.064167
0.0385 --- loss: 1.139663, loss_ss: 0.973252, loss_d: 0.166411
0.0770 --- loss: 1.082766, loss_ss: 0.961990, loss_d: 0.120776
0.1155 --- loss: 0.971882, loss_ss: 0.789653, loss_d: 0.182228
0.1540 --- loss: 1.107570, loss_ss: 0.637942, loss_d: 0.469629
0.1925 --- loss: 1.196377, loss_ss: 0.953378, loss_d: 0.242999
0.2309 --- loss: 0.909672, loss_ss: 0.769032, loss_d: 0.140641
0.2694 --- loss: 1.167480, loss_ss: 0.954023, loss_d: 0.213457
0.3079 --- loss: 1.014944, loss_ss: 0.616714, loss_d: 0.398230
0.3464 --- loss: 0.882911, loss_ss: 0.741754, loss_d: 0.141157
0.3849 --- loss: 1.204544, loss_ss: 1.081650, loss_d: 0.122894
0.4234 --- loss: 0.904464, loss_ss: 0.828429, loss_d: 0.076034
0.4619 --- loss: 1.069785, loss_ss: 0.996076, loss_d: 0.073710
0.5004 --- loss: 1.117374, loss_ss: 0.735843, loss_d: 0.381531
0.5389 --- loss: 1.158319, loss_ss: 0.761226, loss_d: 0.397092
0.5774 --- loss: 1.401035, loss_ss: 1.211571, loss_d: 0.189464
0.6159 --- loss: 1.067834, loss_ss: 0.852081, loss_d: 0.215753
0.6543 --- loss: 1.357527, loss_ss: 0.826616, loss_d: 0.530911
0.6928 --- loss: 1.061560, loss_ss: 0.788090, loss_d: 0.273470
0.7313 --- loss: 0.950489, loss_ss: 0.735742, loss_d: 0.214748
0.7698 --- loss: 1.006340, loss_ss: 0.777456, loss_d: 0.228884
0.8083 --- loss: 1.119349, loss_ss: 0.828033, loss_d: 0.291316
0.8468 --- loss: 1.103226, loss_ss: 0.948187, loss_d: 0.155039
0.8853 --- loss: 0.826518, loss_ss: 0.704530, loss_d: 0.121988
0.9238 --- loss: 1.037194, loss_ss: 0.973566, loss_d: 0.063628
0.9623 --- loss: 1.049560, loss_ss: 0.865504, loss_d: 0.184056
Epoch finished! Loss: 1.1167454954279896
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.021652, loss_ss: 0.924889, loss_d: 0.096762
0.0385 --- loss: 0.932511, loss_ss: 0.775488, loss_d: 0.157023
0.0770 --- loss: 1.576362, loss_ss: 1.340826, loss_d: 0.235536
0.1155 --- loss: 0.965491, loss_ss: 0.883875, loss_d: 0.081617
0.1540 --- loss: 1.332639, loss_ss: 0.828432, loss_d: 0.504206
0.1925 --- loss: 0.969974, loss_ss: 0.881917, loss_d: 0.088058
0.2309 --- loss: 1.150710, loss_ss: 0.792445, loss_d: 0.358265
0.2694 --- loss: 0.718628, loss_ss: 0.595277, loss_d: 0.123351
0.3079 --- loss: 0.838547, loss_ss: 0.644640, loss_d: 0.193907
0.3464 --- loss: 1.084556, loss_ss: 0.798305, loss_d: 0.286251
0.3849 --- loss: 1.383845, loss_ss: 0.798531, loss_d: 0.585314
0.4234 --- loss: 0.891500, loss_ss: 0.603611, loss_d: 0.287889
0.4619 --- loss: 1.578899, loss_ss: 1.207590, loss_d: 0.371309
0.5004 --- loss: 0.824066, loss_ss: 0.674418, loss_d: 0.149648
0.5389 --- loss: 1.068580, loss_ss: 0.679545, loss_d: 0.389034
0.5774 --- loss: 2.112404, loss_ss: 0.821601, loss_d: 1.290803
0.6159 --- loss: 0.836832, loss_ss: 0.778164, loss_d: 0.058668
0.6543 --- loss: 0.947651, loss_ss: 0.818595, loss_d: 0.129055
0.6928 --- loss: 1.195960, loss_ss: 1.004732, loss_d: 0.191227
0.7313 --- loss: 1.539708, loss_ss: 1.122576, loss_d: 0.417131
0.7698 --- loss: 1.845917, loss_ss: 1.046819, loss_d: 0.799098
0.8083 --- loss: 1.180543, loss_ss: 0.875577, loss_d: 0.304966
0.8468 --- loss: 0.846246, loss_ss: 0.751707, loss_d: 0.094539
0.8853 --- loss: 0.925228, loss_ss: 0.765693, loss_d: 0.159535
0.9238 --- loss: 0.609960, loss_ss: 0.490757, loss_d: 0.119203
0.9623 --- loss: 0.899521, loss_ss: 0.798227, loss_d: 0.101294
Epoch finished! Loss: 1.091773097119276
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4245204336947456
             precision    recall  f1-score   support

        0.0       0.91      0.33      0.49       350
        1.0       0.52      0.17      0.25       204
        2.0       0.49      0.69      0.58       346
        3.0       0.00      0.00      0.00       179
        4.0       0.25      1.00      0.40       120

avg / total       0.52      0.42      0.39      1199
 


====== chp030-nsrr ======

The f1-score of  3  has ZeroDivisionError.

   acc %   sen %  spec %  ppr %  f1-score
0  79.57   33.14   98.70  91.34     48.64
1  83.24   16.67   96.88  52.31     25.28
2  70.73   69.08   71.40  49.48     57.66
3  81.15    0.00   95.39   0.00      0.00
4  70.23  100.00   66.91  25.16     40.20
Total accuracy: 42.45%
Average sen: 43.78%
Average spec: 85.86%
Macro f1-score: 34.36%
[0.87816584 0.58310133 0.99780887 0.52928686 0.9929992  0.99370378
 0.99824739 0.99915707 0.99847585 0.98324627 0.99860603 0.99953234
 0.40231588 0.98070014 0.99798775 0.92520738 0.95202506 0.82102919
 0.31371915 0.19143564 0.92702794 0.98369342 0.98051995 0.61090344
 0.36485845 0.58645386 0.8370682  0.99318779 0.98598248 0.99830472
 0.9998678  0.86840379 0.89262503 0.92556983 0.94245106 0.7187435
 0.37981907 0.9270817  0.99144489 0.99936837]
pred: 0.8362531572580337, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.286485, loss_ss: 1.615872, loss_d: 0.670613
0.0384 --- loss: 2.332369, loss_ss: 1.769210, loss_d: 0.563160
0.0769 --- loss: 2.231478, loss_ss: 1.606327, loss_d: 0.625151
0.1153 --- loss: 2.590765, loss_ss: 1.518822, loss_d: 1.071942
0.1538 --- loss: 2.202865, loss_ss: 1.397742, loss_d: 0.805122
0.1922 --- loss: 2.097512, loss_ss: 1.495804, loss_d: 0.601708
0.2307 --- loss: 2.084755, loss_ss: 1.521495, loss_d: 0.563260
0.2691 --- loss: 1.946431, loss_ss: 1.518439, loss_d: 0.427992
0.3076 --- loss: 2.247916, loss_ss: 1.324461, loss_d: 0.923455
0.3460 --- loss: 2.038522, loss_ss: 1.592110, loss_d: 0.446412
0.3845 --- loss: 1.841131, loss_ss: 1.399617, loss_d: 0.441514
0.4229 --- loss: 1.934263, loss_ss: 1.424132, loss_d: 0.510131
0.4614 --- loss: 2.016912, loss_ss: 1.335303, loss_d: 0.681609
0.4998 --- loss: 1.940756, loss_ss: 1.229955, loss_d: 0.710801
0.5383 --- loss: 1.591180, loss_ss: 1.217373, loss_d: 0.373807
0.5767 --- loss: 1.780553, loss_ss: 1.186009, loss_d: 0.594544
0.6151 --- loss: 2.355892, loss_ss: 1.750803, loss_d: 0.605089
0.6536 --- loss: 1.976352, loss_ss: 1.440739, loss_d: 0.535613
0.6920 --- loss: 1.818069, loss_ss: 1.233005, loss_d: 0.585064
0.7305 --- loss: 2.203840, loss_ss: 1.453340, loss_d: 0.750499
0.7689 --- loss: 1.720351, loss_ss: 1.205680, loss_d: 0.514670
0.8074 --- loss: 1.772502, loss_ss: 1.204486, loss_d: 0.568016
0.8458 --- loss: 1.644285, loss_ss: 1.050462, loss_d: 0.593824
0.8843 --- loss: 1.684837, loss_ss: 1.103645, loss_d: 0.581192
0.9227 --- loss: 1.902819, loss_ss: 1.185639, loss_d: 0.717181
0.9612 --- loss: 1.815110, loss_ss: 1.195441, loss_d: 0.619670
0.9996 --- loss: 1.872286, loss_ss: 1.444853, loss_d: 0.427433
Epoch finished! Loss: 1.9825011546795184
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.631521, loss_ss: 1.050158, loss_d: 0.581363
0.0384 --- loss: 1.644996, loss_ss: 0.946478, loss_d: 0.698518
0.0769 --- loss: 1.840038, loss_ss: 1.245818, loss_d: 0.594220
0.1153 --- loss: 1.760853, loss_ss: 1.054609, loss_d: 0.706244
0.1538 --- loss: 1.758668, loss_ss: 1.188878, loss_d: 0.569790
0.1922 --- loss: 1.950076, loss_ss: 1.266911, loss_d: 0.683165
0.2307 --- loss: 2.203773, loss_ss: 1.447857, loss_d: 0.755917
0.2691 --- loss: 1.881468, loss_ss: 1.259347, loss_d: 0.622121
0.3076 --- loss: 1.666159, loss_ss: 1.291721, loss_d: 0.374438
0.3460 --- loss: 1.472538, loss_ss: 1.226678, loss_d: 0.245860
0.3845 --- loss: 1.590167, loss_ss: 0.995444, loss_d: 0.594722
0.4229 --- loss: 1.567945, loss_ss: 0.992827, loss_d: 0.575118
0.4614 --- loss: 1.622277, loss_ss: 1.051412, loss_d: 0.570865
0.4998 --- loss: 1.676972, loss_ss: 1.112478, loss_d: 0.564494
0.5383 --- loss: 1.611562, loss_ss: 1.151908, loss_d: 0.459654
0.5767 --- loss: 1.712327, loss_ss: 1.181910, loss_d: 0.530416
0.6151 --- loss: 1.938948, loss_ss: 1.030933, loss_d: 0.908015
0.6536 --- loss: 1.653538, loss_ss: 1.113255, loss_d: 0.540284
0.6920 --- loss: 1.564237, loss_ss: 0.971931, loss_d: 0.592306
0.7305 --- loss: 1.841452, loss_ss: 1.280126, loss_d: 0.561325
0.7689 --- loss: 1.452494, loss_ss: 0.825141, loss_d: 0.627352
0.8074 --- loss: 1.551891, loss_ss: 1.161359, loss_d: 0.390532
0.8458 --- loss: 1.693345, loss_ss: 1.127095, loss_d: 0.566250
0.8843 --- loss: 1.556664, loss_ss: 1.018076, loss_d: 0.538588
0.9227 --- loss: 1.650337, loss_ss: 1.122415, loss_d: 0.527923
0.9612 --- loss: 1.636991, loss_ss: 1.028800, loss_d: 0.608192
0.9996 --- loss: 2.571906, loss_ss: 1.038048, loss_d: 1.533858
Epoch finished! Loss: 1.7331950563650864
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.523888, loss_ss: 0.834291, loss_d: 0.689598
0.0384 --- loss: 1.796258, loss_ss: 1.159187, loss_d: 0.637071
0.0769 --- loss: 1.821237, loss_ss: 1.254611, loss_d: 0.566626
0.1153 --- loss: 1.191314, loss_ss: 0.874611, loss_d: 0.316703
0.1538 --- loss: 1.834950, loss_ss: 0.948547, loss_d: 0.886402
0.1922 --- loss: 2.113139, loss_ss: 1.189135, loss_d: 0.924005
0.2307 --- loss: 1.574829, loss_ss: 0.923443, loss_d: 0.651387
0.2691 --- loss: 1.518496, loss_ss: 0.983441, loss_d: 0.535055
0.3076 --- loss: 2.006168, loss_ss: 1.290456, loss_d: 0.715712
0.3460 --- loss: 1.465200, loss_ss: 0.968452, loss_d: 0.496748
0.3845 --- loss: 1.419796, loss_ss: 0.857097, loss_d: 0.562699
0.4229 --- loss: 1.644124, loss_ss: 1.013572, loss_d: 0.630552
0.4614 --- loss: 1.757189, loss_ss: 1.158458, loss_d: 0.598731
0.4998 --- loss: 1.534057, loss_ss: 0.925242, loss_d: 0.608815
0.5383 --- loss: 1.632662, loss_ss: 1.090436, loss_d: 0.542226
0.5767 --- loss: 1.703550, loss_ss: 1.032611, loss_d: 0.670940
0.6151 --- loss: 1.507683, loss_ss: 1.022043, loss_d: 0.485640
0.6536 --- loss: 1.894698, loss_ss: 0.968477, loss_d: 0.926220
0.6920 --- loss: 2.168847, loss_ss: 1.525610, loss_d: 0.643237
0.7305 --- loss: 1.429585, loss_ss: 1.111162, loss_d: 0.318422
0.7689 --- loss: 1.669456, loss_ss: 1.234081, loss_d: 0.435375
0.8074 --- loss: 1.591161, loss_ss: 0.975220, loss_d: 0.615941
0.8458 --- loss: 1.478419, loss_ss: 0.975784, loss_d: 0.502635
0.8843 --- loss: 1.421567, loss_ss: 0.915655, loss_d: 0.505912
0.9227 --- loss: 1.708151, loss_ss: 1.010719, loss_d: 0.697432
0.9612 --- loss: 1.511299, loss_ss: 1.071565, loss_d: 0.439734
0.9996 --- loss: 1.217985, loss_ss: 1.007827, loss_d: 0.210158
Epoch finished! Loss: 1.6103957552176256
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.880953, loss_ss: 1.269208, loss_d: 0.611745
0.0384 --- loss: 1.747459, loss_ss: 0.970164, loss_d: 0.777296
0.0769 --- loss: 2.072021, loss_ss: 1.452626, loss_d: 0.619395
0.1153 --- loss: 1.505564, loss_ss: 0.963310, loss_d: 0.542253
0.1538 --- loss: 1.627764, loss_ss: 1.054347, loss_d: 0.573418
0.1922 --- loss: 1.837970, loss_ss: 1.457075, loss_d: 0.380895
0.2307 --- loss: 1.371304, loss_ss: 0.966031, loss_d: 0.405274
0.2691 --- loss: 1.515773, loss_ss: 0.938128, loss_d: 0.577645
0.3076 --- loss: 1.430160, loss_ss: 1.067086, loss_d: 0.363075
0.3460 --- loss: 1.385336, loss_ss: 1.032809, loss_d: 0.352527
0.3845 --- loss: 1.455868, loss_ss: 0.968446, loss_d: 0.487422
0.4229 --- loss: 1.500269, loss_ss: 0.818182, loss_d: 0.682087
0.4614 --- loss: 1.783620, loss_ss: 1.291303, loss_d: 0.492317
0.4998 --- loss: 1.375190, loss_ss: 0.911335, loss_d: 0.463855
0.5383 --- loss: 1.202103, loss_ss: 0.973553, loss_d: 0.228550
0.5767 --- loss: 1.152218, loss_ss: 0.839645, loss_d: 0.312573
0.6151 --- loss: 1.320970, loss_ss: 0.919729, loss_d: 0.401241
0.6536 --- loss: 1.435789, loss_ss: 0.972391, loss_d: 0.463398
0.6920 --- loss: 1.633988, loss_ss: 0.857026, loss_d: 0.776963
0.7305 --- loss: 1.305548, loss_ss: 0.804959, loss_d: 0.500590
0.7689 --- loss: 1.638049, loss_ss: 0.841908, loss_d: 0.796142
0.8074 --- loss: 1.861202, loss_ss: 1.447768, loss_d: 0.413435
0.8458 --- loss: 1.433703, loss_ss: 0.961189, loss_d: 0.472514
0.8843 --- loss: 1.216264, loss_ss: 0.841274, loss_d: 0.374990
0.9227 --- loss: 1.305190, loss_ss: 1.008587, loss_d: 0.296603
0.9612 --- loss: 1.238466, loss_ss: 0.982676, loss_d: 0.255790
0.9996 --- loss: 1.357558, loss_ss: 1.100062, loss_d: 0.257497
Epoch finished! Loss: 1.525615628866049
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.226035, loss_ss: 0.854878, loss_d: 0.371157
0.0384 --- loss: 1.468251, loss_ss: 1.130571, loss_d: 0.337680
0.0769 --- loss: 1.441400, loss_ss: 1.054874, loss_d: 0.386527
0.1153 --- loss: 1.207697, loss_ss: 0.852084, loss_d: 0.355613
0.1538 --- loss: 2.084476, loss_ss: 1.174184, loss_d: 0.910293
0.1922 --- loss: 1.858965, loss_ss: 1.276548, loss_d: 0.582417
0.2307 --- loss: 1.098840, loss_ss: 0.823511, loss_d: 0.275329
0.2691 --- loss: 1.324949, loss_ss: 0.968651, loss_d: 0.356298
0.3076 --- loss: 1.511868, loss_ss: 0.866120, loss_d: 0.645748
0.3460 --- loss: 1.390775, loss_ss: 0.863431, loss_d: 0.527345
0.3845 --- loss: 1.404002, loss_ss: 1.085507, loss_d: 0.318495
0.4229 --- loss: 1.240479, loss_ss: 0.822817, loss_d: 0.417662
0.4614 --- loss: 1.353147, loss_ss: 0.912395, loss_d: 0.440752
0.4998 --- loss: 1.423715, loss_ss: 0.992829, loss_d: 0.430886
0.5383 --- loss: 1.757117, loss_ss: 0.972379, loss_d: 0.784738
0.5767 --- loss: 1.490516, loss_ss: 0.999575, loss_d: 0.490941
0.6151 --- loss: 1.007233, loss_ss: 0.790246, loss_d: 0.216987
0.6536 --- loss: 1.017488, loss_ss: 0.848626, loss_d: 0.168862
0.6920 --- loss: 1.269651, loss_ss: 0.878584, loss_d: 0.391067
0.7305 --- loss: 1.136822, loss_ss: 0.829456, loss_d: 0.307365
0.7689 --- loss: 1.217726, loss_ss: 0.855496, loss_d: 0.362231
0.8074 --- loss: 1.460455, loss_ss: 1.227262, loss_d: 0.233193
0.8458 --- loss: 1.503969, loss_ss: 1.092603, loss_d: 0.411366
0.8843 --- loss: 1.601482, loss_ss: 1.251408, loss_d: 0.350074
0.9227 --- loss: 1.278101, loss_ss: 0.869138, loss_d: 0.408963
0.9612 --- loss: 1.269616, loss_ss: 0.989291, loss_d: 0.280325
0.9996 --- loss: 1.597646, loss_ss: 1.468016, loss_d: 0.129630
Epoch finished! Loss: 1.3746453443398843
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.330816, loss_ss: 0.951187, loss_d: 0.379629
0.0384 --- loss: 0.885892, loss_ss: 0.707952, loss_d: 0.177939
0.0769 --- loss: 1.244613, loss_ss: 0.924802, loss_d: 0.319812
0.1153 --- loss: 1.300930, loss_ss: 0.978743, loss_d: 0.322187
0.1538 --- loss: 1.691540, loss_ss: 1.100037, loss_d: 0.591503
0.1922 --- loss: 1.055928, loss_ss: 0.819344, loss_d: 0.236585
0.2307 --- loss: 1.630623, loss_ss: 1.339021, loss_d: 0.291602
0.2691 --- loss: 1.169562, loss_ss: 0.693422, loss_d: 0.476140
0.3076 --- loss: 0.946907, loss_ss: 0.687027, loss_d: 0.259880
0.3460 --- loss: 1.983479, loss_ss: 1.389007, loss_d: 0.594472
0.3845 --- loss: 1.318292, loss_ss: 1.072112, loss_d: 0.246181
0.4229 --- loss: 1.778507, loss_ss: 1.401001, loss_d: 0.377506
0.4614 --- loss: 1.365988, loss_ss: 1.143369, loss_d: 0.222619
0.4998 --- loss: 1.135829, loss_ss: 0.893915, loss_d: 0.241915
0.5383 --- loss: 1.559798, loss_ss: 0.622038, loss_d: 0.937760
0.5767 --- loss: 1.581621, loss_ss: 0.811315, loss_d: 0.770307
0.6151 --- loss: 1.184149, loss_ss: 1.007696, loss_d: 0.176452
0.6536 --- loss: 1.211173, loss_ss: 0.922496, loss_d: 0.288677
0.6920 --- loss: 1.177787, loss_ss: 0.827300, loss_d: 0.350486
0.7305 --- loss: 1.199541, loss_ss: 0.929403, loss_d: 0.270138
0.7689 --- loss: 1.454198, loss_ss: 1.220024, loss_d: 0.234174
0.8074 --- loss: 1.297163, loss_ss: 1.163503, loss_d: 0.133660
0.8458 --- loss: 1.089976, loss_ss: 0.699502, loss_d: 0.390474
0.8843 --- loss: 1.604458, loss_ss: 0.990927, loss_d: 0.613532
0.9227 --- loss: 1.113095, loss_ss: 0.756016, loss_d: 0.357079
0.9612 --- loss: 1.225440, loss_ss: 0.911281, loss_d: 0.314158
0.9996 --- loss: 1.833020, loss_ss: 1.732637, loss_d: 0.100383
Epoch finished! Loss: 1.307223618718294
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.230704, loss_ss: 1.052284, loss_d: 0.178420
0.0384 --- loss: 1.239554, loss_ss: 0.846034, loss_d: 0.393519
0.0769 --- loss: 0.960501, loss_ss: 0.733529, loss_d: 0.226972
0.1153 --- loss: 1.552041, loss_ss: 1.264791, loss_d: 0.287250
0.1538 --- loss: 1.266013, loss_ss: 1.082676, loss_d: 0.183337
0.1922 --- loss: 1.178875, loss_ss: 0.893778, loss_d: 0.285098
0.2307 --- loss: 1.286172, loss_ss: 0.964262, loss_d: 0.321911
0.2691 --- loss: 1.165360, loss_ss: 0.860309, loss_d: 0.305051
0.3076 --- loss: 1.247230, loss_ss: 0.685695, loss_d: 0.561535
0.3460 --- loss: 0.799216, loss_ss: 0.675551, loss_d: 0.123665
0.3845 --- loss: 1.005751, loss_ss: 0.748549, loss_d: 0.257201
0.4229 --- loss: 1.757455, loss_ss: 1.264238, loss_d: 0.493217
0.4614 --- loss: 1.058006, loss_ss: 0.767413, loss_d: 0.290593
0.4998 --- loss: 1.360449, loss_ss: 0.899999, loss_d: 0.460450
0.5383 --- loss: 1.419855, loss_ss: 1.043363, loss_d: 0.376492
0.5767 --- loss: 1.354568, loss_ss: 1.099245, loss_d: 0.255323
0.6151 --- loss: 1.302046, loss_ss: 0.745366, loss_d: 0.556680
0.6536 --- loss: 0.886795, loss_ss: 0.626471, loss_d: 0.260324
0.6920 --- loss: 1.246269, loss_ss: 0.805240, loss_d: 0.441029
0.7305 --- loss: 1.312335, loss_ss: 0.919112, loss_d: 0.393223
0.7689 --- loss: 1.657419, loss_ss: 1.045718, loss_d: 0.611701
0.8074 --- loss: 1.165286, loss_ss: 0.782938, loss_d: 0.382348
0.8458 --- loss: 1.303035, loss_ss: 0.962129, loss_d: 0.340906
0.8843 --- loss: 1.025617, loss_ss: 0.707475, loss_d: 0.318142
0.9227 --- loss: 1.186161, loss_ss: 0.958288, loss_d: 0.227873
0.9612 --- loss: 1.012531, loss_ss: 0.653114, loss_d: 0.359417
0.9996 --- loss: 1.227916, loss_ss: 1.146961, loss_d: 0.080955
Epoch finished! Loss: 1.2427240963165576
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.010957, loss_ss: 0.874573, loss_d: 0.136384
0.0384 --- loss: 1.013675, loss_ss: 0.474895, loss_d: 0.538781
0.0769 --- loss: 1.171457, loss_ss: 1.012625, loss_d: 0.158832
0.1153 --- loss: 1.241863, loss_ss: 1.053249, loss_d: 0.188614
0.1538 --- loss: 1.673089, loss_ss: 1.022348, loss_d: 0.650741
0.1922 --- loss: 1.375990, loss_ss: 1.190905, loss_d: 0.185084
0.2307 --- loss: 1.013689, loss_ss: 0.860009, loss_d: 0.153681
0.2691 --- loss: 1.152922, loss_ss: 0.969514, loss_d: 0.183408
0.3076 --- loss: 0.910052, loss_ss: 0.840022, loss_d: 0.070030
0.3460 --- loss: 1.195560, loss_ss: 1.090380, loss_d: 0.105179
0.3845 --- loss: 1.099821, loss_ss: 0.810233, loss_d: 0.289588
0.4229 --- loss: 1.340049, loss_ss: 1.171371, loss_d: 0.168678
0.4614 --- loss: 0.874455, loss_ss: 0.712099, loss_d: 0.162356
0.4998 --- loss: 1.250550, loss_ss: 1.066860, loss_d: 0.183690
0.5383 --- loss: 1.489480, loss_ss: 1.337662, loss_d: 0.151818
0.5767 --- loss: 1.719142, loss_ss: 1.603293, loss_d: 0.115849
0.6151 --- loss: 0.838565, loss_ss: 0.774818, loss_d: 0.063747
0.6536 --- loss: 1.255632, loss_ss: 1.036606, loss_d: 0.219026
0.6920 --- loss: 1.117766, loss_ss: 0.817205, loss_d: 0.300561
0.7305 --- loss: 1.185141, loss_ss: 0.844923, loss_d: 0.340218
0.7689 --- loss: 1.344245, loss_ss: 1.021071, loss_d: 0.323174
0.8074 --- loss: 1.294165, loss_ss: 1.065576, loss_d: 0.228589
0.8458 --- loss: 0.991480, loss_ss: 0.765959, loss_d: 0.225521
0.8843 --- loss: 0.948316, loss_ss: 0.859094, loss_d: 0.089222
0.9227 --- loss: 1.432692, loss_ss: 0.744729, loss_d: 0.687964
0.9612 --- loss: 1.120194, loss_ss: 0.888987, loss_d: 0.231207
0.9996 --- loss: 0.983088, loss_ss: 0.946372, loss_d: 0.036716
Epoch finished! Loss: 1.1984570883787595
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.972510, loss_ss: 0.870728, loss_d: 0.101782
0.0384 --- loss: 1.348239, loss_ss: 1.274888, loss_d: 0.073351
0.0769 --- loss: 1.042932, loss_ss: 0.864472, loss_d: 0.178460
0.1153 --- loss: 1.010746, loss_ss: 0.912431, loss_d: 0.098315
0.1538 --- loss: 0.980329, loss_ss: 0.782948, loss_d: 0.197381
0.1922 --- loss: 0.924596, loss_ss: 0.803477, loss_d: 0.121119
0.2307 --- loss: 0.920870, loss_ss: 0.826349, loss_d: 0.094521
0.2691 --- loss: 0.922174, loss_ss: 0.755155, loss_d: 0.167018
0.3076 --- loss: 1.480962, loss_ss: 1.041268, loss_d: 0.439694
0.3460 --- loss: 1.106059, loss_ss: 0.949913, loss_d: 0.156146
0.3845 --- loss: 0.973370, loss_ss: 0.796487, loss_d: 0.176883
0.4229 --- loss: 1.359273, loss_ss: 1.069038, loss_d: 0.290236
0.4614 --- loss: 1.292287, loss_ss: 0.679694, loss_d: 0.612593
0.4998 --- loss: 1.321284, loss_ss: 0.755813, loss_d: 0.565471
0.5383 --- loss: 1.193419, loss_ss: 1.096468, loss_d: 0.096951
0.5767 --- loss: 0.975579, loss_ss: 0.630242, loss_d: 0.345336
0.6151 --- loss: 1.120786, loss_ss: 0.866314, loss_d: 0.254472
0.6536 --- loss: 1.194738, loss_ss: 0.873203, loss_d: 0.321536
0.6920 --- loss: 0.809907, loss_ss: 0.688212, loss_d: 0.121695
0.7305 --- loss: 1.034908, loss_ss: 0.941031, loss_d: 0.093877
0.7689 --- loss: 1.058706, loss_ss: 0.890085, loss_d: 0.168621
0.8074 --- loss: 1.066622, loss_ss: 0.964439, loss_d: 0.102183
0.8458 --- loss: 1.240152, loss_ss: 0.924925, loss_d: 0.315228
0.8843 --- loss: 0.705261, loss_ss: 0.561558, loss_d: 0.143703
0.9227 --- loss: 0.869304, loss_ss: 0.797830, loss_d: 0.071474
0.9612 --- loss: 1.048348, loss_ss: 0.883497, loss_d: 0.164851
0.9996 --- loss: 1.267128, loss_ss: 1.194598, loss_d: 0.072530
Epoch finished! Loss: 1.1631081306017361
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.866637, loss_ss: 0.481164, loss_d: 0.385473
0.0384 --- loss: 1.442898, loss_ss: 1.056264, loss_d: 0.386635
0.0769 --- loss: 1.274076, loss_ss: 1.037486, loss_d: 0.236590
0.1153 --- loss: 0.995983, loss_ss: 0.734018, loss_d: 0.261965
0.1538 --- loss: 1.282149, loss_ss: 0.753916, loss_d: 0.528233
0.1922 --- loss: 1.265378, loss_ss: 0.985968, loss_d: 0.279409
0.2307 --- loss: 1.103009, loss_ss: 0.717094, loss_d: 0.385915
0.2691 --- loss: 0.856431, loss_ss: 0.719812, loss_d: 0.136619
0.3076 --- loss: 1.150194, loss_ss: 0.965581, loss_d: 0.184613
0.3460 --- loss: 1.129563, loss_ss: 0.978541, loss_d: 0.151022
0.3845 --- loss: 1.040774, loss_ss: 0.911845, loss_d: 0.128929
0.4229 --- loss: 1.290555, loss_ss: 0.813161, loss_d: 0.477393
0.4614 --- loss: 1.199571, loss_ss: 1.112247, loss_d: 0.087324
0.4998 --- loss: 1.274954, loss_ss: 1.090529, loss_d: 0.184424
0.5383 --- loss: 0.896026, loss_ss: 0.764337, loss_d: 0.131689
0.5767 --- loss: 1.418703, loss_ss: 0.757912, loss_d: 0.660790
0.6151 --- loss: 1.059257, loss_ss: 0.762122, loss_d: 0.297136
0.6536 --- loss: 1.180845, loss_ss: 1.013884, loss_d: 0.166962
0.6920 --- loss: 0.791942, loss_ss: 0.686176, loss_d: 0.105766
0.7305 --- loss: 1.159564, loss_ss: 1.066157, loss_d: 0.093407
0.7689 --- loss: 1.383242, loss_ss: 1.183650, loss_d: 0.199592
0.8074 --- loss: 1.435149, loss_ss: 1.166105, loss_d: 0.269044
0.8458 --- loss: 1.170920, loss_ss: 0.560995, loss_d: 0.609925
0.8843 --- loss: 1.081506, loss_ss: 0.945895, loss_d: 0.135611
0.9227 --- loss: 0.800759, loss_ss: 0.738447, loss_d: 0.062313
0.9612 --- loss: 1.205241, loss_ss: 0.757708, loss_d: 0.447533
0.9996 --- loss: 2.593032, loss_ss: 2.559730, loss_d: 0.033303
Epoch finished! Loss: 1.1476978331804275
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6846846846846847
             precision    recall  f1-score   support

        0.0       0.15      0.63      0.25        51
        1.0       0.00      0.00      0.00        48
        2.0       0.68      0.84      0.75       309
        3.0       0.88      0.84      0.86       229
        4.0       0.91      0.58      0.71       473

avg / total       0.77      0.68      0.70      1110
 


====== chp031-nsrr ======

The ppr of  1  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  82.25  62.75   83.19  15.24     24.52
1  95.68   0.00  100.00   0.00      0.00
2  84.77  84.14   85.02  68.42     75.47
3  94.32  83.84   97.05  88.07     85.91
4  79.91  58.35   95.92  91.39     71.23
Total accuracy: 68.47%
Average sen: 57.82%
Average spec: 92.24%
Macro f1-score: 51.42%
[0.13655652 0.4542692  0.16805142 0.12733769 0.46852136 0.20279245
 0.18594654 0.545286   0.1235534  0.16043933 0.12221667 0.23248543
 0.34842849 0.40928823 0.29062256 0.34550044 0.10858396 0.09107813
 0.17614347 0.11410476 0.10369346 0.16776855 0.22450796 0.2400074
 0.29657799 0.12415528 0.07712495 0.13779649 0.3076894  0.32044727
 0.23675507 0.16701783 0.15284407 0.0747571  0.46527022 0.22438774
 0.42198238]
pred: 0.23118889734551712, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.291443, loss_ss: 1.614151, loss_d: 0.677292
0.0384 --- loss: 2.563488, loss_ss: 1.538919, loss_d: 1.024569
0.0768 --- loss: 2.152076, loss_ss: 1.429120, loss_d: 0.722955
0.1153 --- loss: 2.324074, loss_ss: 1.488955, loss_d: 0.835119
0.1537 --- loss: 2.060525, loss_ss: 1.522659, loss_d: 0.537865
0.1921 --- loss: 2.109045, loss_ss: 1.356809, loss_d: 0.752236
0.2305 --- loss: 2.144949, loss_ss: 1.369249, loss_d: 0.775700
0.2689 --- loss: 2.206605, loss_ss: 1.345138, loss_d: 0.861467
0.3073 --- loss: 1.898413, loss_ss: 1.315754, loss_d: 0.582659
0.3458 --- loss: 1.843503, loss_ss: 1.294131, loss_d: 0.549373
0.3842 --- loss: 1.660801, loss_ss: 1.325044, loss_d: 0.335757
0.4226 --- loss: 2.274184, loss_ss: 1.344151, loss_d: 0.930033
0.4610 --- loss: 1.897701, loss_ss: 1.158565, loss_d: 0.739136
0.4994 --- loss: 1.901349, loss_ss: 1.289118, loss_d: 0.612231
0.5378 --- loss: 2.021907, loss_ss: 1.503848, loss_d: 0.518059
0.5763 --- loss: 1.759761, loss_ss: 1.258628, loss_d: 0.501134
0.6147 --- loss: 1.839332, loss_ss: 1.455313, loss_d: 0.384019
0.6531 --- loss: 1.682938, loss_ss: 1.239568, loss_d: 0.443370
0.6915 --- loss: 1.827821, loss_ss: 1.189178, loss_d: 0.638643
0.7299 --- loss: 2.051890, loss_ss: 1.300995, loss_d: 0.750895
0.7683 --- loss: 1.930186, loss_ss: 1.189492, loss_d: 0.740693
0.8068 --- loss: 1.772192, loss_ss: 1.035910, loss_d: 0.736281
0.8452 --- loss: 1.920092, loss_ss: 1.338770, loss_d: 0.581322
0.8836 --- loss: 1.882857, loss_ss: 1.253366, loss_d: 0.629491
0.9220 --- loss: 1.779050, loss_ss: 1.170569, loss_d: 0.608481
0.9604 --- loss: 1.720831, loss_ss: 1.223188, loss_d: 0.497643
0.9988 --- loss: 1.293856, loss_ss: 0.986832, loss_d: 0.307023
Epoch finished! Loss: 1.9443702661074125
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.921737, loss_ss: 1.226746, loss_d: 0.694991
0.0384 --- loss: 1.866337, loss_ss: 1.097483, loss_d: 0.768854
0.0768 --- loss: 1.545433, loss_ss: 1.056760, loss_d: 0.488674
0.1153 --- loss: 2.037080, loss_ss: 1.175155, loss_d: 0.861924
0.1537 --- loss: 1.462364, loss_ss: 1.102024, loss_d: 0.360340
0.1921 --- loss: 1.954818, loss_ss: 1.259457, loss_d: 0.695361
0.2305 --- loss: 1.718555, loss_ss: 1.097124, loss_d: 0.621431
0.2689 --- loss: 1.613084, loss_ss: 1.054651, loss_d: 0.558433
0.3073 --- loss: 1.880275, loss_ss: 1.348774, loss_d: 0.531500
0.3458 --- loss: 1.821984, loss_ss: 1.143563, loss_d: 0.678422
0.3842 --- loss: 2.094072, loss_ss: 1.431250, loss_d: 0.662822
0.4226 --- loss: 1.642048, loss_ss: 1.107170, loss_d: 0.534878
0.4610 --- loss: 1.947420, loss_ss: 1.549684, loss_d: 0.397737
0.4994 --- loss: 1.858020, loss_ss: 0.938546, loss_d: 0.919475
0.5378 --- loss: 1.471026, loss_ss: 0.995350, loss_d: 0.475675
0.5763 --- loss: 1.450181, loss_ss: 0.899277, loss_d: 0.550904
0.6147 --- loss: 1.809701, loss_ss: 1.079884, loss_d: 0.729818
0.6531 --- loss: 1.529583, loss_ss: 0.995604, loss_d: 0.533979
0.6915 --- loss: 1.547978, loss_ss: 1.166284, loss_d: 0.381695
0.7299 --- loss: 1.605061, loss_ss: 1.105390, loss_d: 0.499671
0.7683 --- loss: 1.542434, loss_ss: 0.924675, loss_d: 0.617759
0.8068 --- loss: 1.263141, loss_ss: 0.856288, loss_d: 0.406853
0.8452 --- loss: 1.614756, loss_ss: 1.025645, loss_d: 0.589111
0.8836 --- loss: 1.757736, loss_ss: 1.154767, loss_d: 0.602969
0.9220 --- loss: 1.648449, loss_ss: 1.036921, loss_d: 0.611528
0.9604 --- loss: 1.275052, loss_ss: 0.757056, loss_d: 0.517996
0.9988 --- loss: 1.982328, loss_ss: 1.391177, loss_d: 0.591151
Epoch finished! Loss: 1.6866225458108461
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.839230, loss_ss: 1.236316, loss_d: 0.602914
0.0384 --- loss: 1.421991, loss_ss: 0.884706, loss_d: 0.537284
0.0768 --- loss: 1.780147, loss_ss: 0.842356, loss_d: 0.937791
0.1153 --- loss: 1.478694, loss_ss: 0.786905, loss_d: 0.691788
0.1537 --- loss: 1.801832, loss_ss: 0.980615, loss_d: 0.821217
0.1921 --- loss: 1.558563, loss_ss: 0.994304, loss_d: 0.564258
0.2305 --- loss: 1.271417, loss_ss: 0.685403, loss_d: 0.586014
0.2689 --- loss: 1.796619, loss_ss: 1.316333, loss_d: 0.480286
0.3073 --- loss: 1.585279, loss_ss: 0.827423, loss_d: 0.757856
0.3458 --- loss: 1.708851, loss_ss: 1.232979, loss_d: 0.475872
0.3842 --- loss: 1.312348, loss_ss: 0.977452, loss_d: 0.334896
0.4226 --- loss: 1.327417, loss_ss: 0.879805, loss_d: 0.447612
0.4610 --- loss: 1.368114, loss_ss: 0.853162, loss_d: 0.514952
0.4994 --- loss: 1.882642, loss_ss: 1.280891, loss_d: 0.601751
0.5378 --- loss: 1.570741, loss_ss: 1.139223, loss_d: 0.431518
0.5763 --- loss: 1.515352, loss_ss: 0.994750, loss_d: 0.520602
0.6147 --- loss: 1.503647, loss_ss: 0.978249, loss_d: 0.525397
0.6531 --- loss: 1.890066, loss_ss: 1.026858, loss_d: 0.863208
0.6915 --- loss: 1.434566, loss_ss: 1.000734, loss_d: 0.433832
0.7299 --- loss: 1.816848, loss_ss: 1.005257, loss_d: 0.811591
0.7683 --- loss: 1.341299, loss_ss: 0.726774, loss_d: 0.614526
0.8068 --- loss: 1.441704, loss_ss: 0.822435, loss_d: 0.619269
0.8452 --- loss: 1.441705, loss_ss: 0.860901, loss_d: 0.580805
0.8836 --- loss: 1.625358, loss_ss: 0.961168, loss_d: 0.664190
0.9220 --- loss: 1.690552, loss_ss: 0.842663, loss_d: 0.847889
0.9604 --- loss: 1.680169, loss_ss: 1.046300, loss_d: 0.633869
0.9988 --- loss: 1.224881, loss_ss: 0.891035, loss_d: 0.333846
Epoch finished! Loss: 1.5837147157925826
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.630768, loss_ss: 0.694515, loss_d: 0.936253
0.0384 --- loss: 1.409823, loss_ss: 0.969838, loss_d: 0.439985
0.0768 --- loss: 1.648238, loss_ss: 1.179081, loss_d: 0.469158
0.1153 --- loss: 1.642013, loss_ss: 1.191445, loss_d: 0.450568
0.1537 --- loss: 1.792220, loss_ss: 0.861284, loss_d: 0.930936
0.1921 --- loss: 1.301131, loss_ss: 0.803051, loss_d: 0.498079
0.2305 --- loss: 1.350916, loss_ss: 0.750484, loss_d: 0.600432
0.2689 --- loss: 1.176879, loss_ss: 0.782323, loss_d: 0.394556
0.3073 --- loss: 1.852880, loss_ss: 0.991198, loss_d: 0.861683
0.3458 --- loss: 1.494212, loss_ss: 0.852600, loss_d: 0.641612
0.3842 --- loss: 1.868410, loss_ss: 1.088588, loss_d: 0.779823
0.4226 --- loss: 1.601188, loss_ss: 1.048498, loss_d: 0.552690
0.4610 --- loss: 1.351317, loss_ss: 0.803225, loss_d: 0.548092
0.4994 --- loss: 1.619252, loss_ss: 1.311109, loss_d: 0.308144
0.5378 --- loss: 1.342355, loss_ss: 0.932174, loss_d: 0.410181
0.5763 --- loss: 1.441632, loss_ss: 0.997614, loss_d: 0.444018
0.6147 --- loss: 1.385817, loss_ss: 1.082732, loss_d: 0.303085
0.6531 --- loss: 1.506396, loss_ss: 1.054037, loss_d: 0.452358
0.6915 --- loss: 1.205188, loss_ss: 0.898755, loss_d: 0.306433
0.7299 --- loss: 1.407788, loss_ss: 0.945553, loss_d: 0.462235
0.7683 --- loss: 1.689369, loss_ss: 0.891670, loss_d: 0.797699
0.8068 --- loss: 1.887866, loss_ss: 1.187306, loss_d: 0.700559
0.8452 --- loss: 1.751817, loss_ss: 0.954558, loss_d: 0.797259
0.8836 --- loss: 1.534731, loss_ss: 1.127328, loss_d: 0.407404
0.9220 --- loss: 1.415662, loss_ss: 0.893040, loss_d: 0.522622
0.9604 --- loss: 1.322347, loss_ss: 0.966169, loss_d: 0.356178
0.9988 --- loss: 1.830847, loss_ss: 0.889525, loss_d: 0.941321
Epoch finished! Loss: 1.5204535071666425
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.366703, loss_ss: 0.545426, loss_d: 0.821277
0.0384 --- loss: 1.594638, loss_ss: 1.088985, loss_d: 0.505652
0.0768 --- loss: 1.823561, loss_ss: 0.926994, loss_d: 0.896567
0.1153 --- loss: 1.371436, loss_ss: 0.860687, loss_d: 0.510749
0.1537 --- loss: 1.787755, loss_ss: 1.050805, loss_d: 0.736950
0.1921 --- loss: 1.728585, loss_ss: 0.868755, loss_d: 0.859830
0.2305 --- loss: 1.417234, loss_ss: 0.896702, loss_d: 0.520532
0.2689 --- loss: 1.419994, loss_ss: 0.963412, loss_d: 0.456582
0.3073 --- loss: 1.398509, loss_ss: 0.635559, loss_d: 0.762950
0.3458 --- loss: 1.742052, loss_ss: 0.850716, loss_d: 0.891336
0.3842 --- loss: 1.758495, loss_ss: 0.993616, loss_d: 0.764879
0.4226 --- loss: 1.301570, loss_ss: 0.956732, loss_d: 0.344838
0.4610 --- loss: 1.636344, loss_ss: 0.879426, loss_d: 0.756918
0.4994 --- loss: 1.384968, loss_ss: 1.102871, loss_d: 0.282097
0.5378 --- loss: 1.554064, loss_ss: 1.055431, loss_d: 0.498633
0.5763 --- loss: 1.594900, loss_ss: 0.784344, loss_d: 0.810556
0.6147 --- loss: 1.223544, loss_ss: 0.765338, loss_d: 0.458206
0.6531 --- loss: 1.035280, loss_ss: 0.682180, loss_d: 0.353101
0.6915 --- loss: 1.263123, loss_ss: 0.879437, loss_d: 0.383686
0.7299 --- loss: 1.352222, loss_ss: 1.060574, loss_d: 0.291648
0.7683 --- loss: 1.527764, loss_ss: 1.084323, loss_d: 0.443440
0.8068 --- loss: 1.322101, loss_ss: 0.869048, loss_d: 0.453053
0.8452 --- loss: 1.826761, loss_ss: 1.043059, loss_d: 0.783703
0.8836 --- loss: 1.452396, loss_ss: 0.810436, loss_d: 0.641961
0.9220 --- loss: 1.454014, loss_ss: 0.971132, loss_d: 0.482881
0.9604 --- loss: 1.361318, loss_ss: 0.984373, loss_d: 0.376945
0.9988 --- loss: 1.949309, loss_ss: 0.688451, loss_d: 1.260858
Epoch finished! Loss: 1.4620694160461425
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.084967, loss_ss: 0.790215, loss_d: 0.294752
0.0384 --- loss: 1.338323, loss_ss: 0.793420, loss_d: 0.544903
0.0768 --- loss: 1.411382, loss_ss: 0.920889, loss_d: 0.490493
0.1153 --- loss: 0.859315, loss_ss: 0.659110, loss_d: 0.200205
0.1537 --- loss: 1.930705, loss_ss: 0.938581, loss_d: 0.992123
0.1921 --- loss: 1.526903, loss_ss: 1.033581, loss_d: 0.493322
0.2305 --- loss: 1.536030, loss_ss: 0.916594, loss_d: 0.619436
0.2689 --- loss: 1.113528, loss_ss: 0.754212, loss_d: 0.359316
0.3073 --- loss: 1.659723, loss_ss: 0.782512, loss_d: 0.877211
0.3458 --- loss: 1.232839, loss_ss: 0.837103, loss_d: 0.395737
0.3842 --- loss: 1.869715, loss_ss: 1.057723, loss_d: 0.811992
0.4226 --- loss: 1.115427, loss_ss: 0.825760, loss_d: 0.289667
0.4610 --- loss: 1.342741, loss_ss: 1.075999, loss_d: 0.266742
0.4994 --- loss: 0.906590, loss_ss: 0.663367, loss_d: 0.243223
0.5378 --- loss: 1.405452, loss_ss: 0.663726, loss_d: 0.741726
0.5763 --- loss: 1.629944, loss_ss: 0.953040, loss_d: 0.676904
0.6147 --- loss: 1.492596, loss_ss: 1.043437, loss_d: 0.449160
0.6531 --- loss: 1.494929, loss_ss: 0.874309, loss_d: 0.620619
0.6915 --- loss: 1.782542, loss_ss: 1.063383, loss_d: 0.719160
0.7299 --- loss: 1.141491, loss_ss: 0.957169, loss_d: 0.184323
0.7683 --- loss: 1.550107, loss_ss: 0.943530, loss_d: 0.606577
0.8068 --- loss: 1.491996, loss_ss: 1.086035, loss_d: 0.405960
0.8452 --- loss: 1.366073, loss_ss: 0.851321, loss_d: 0.514752
0.8836 --- loss: 0.967799, loss_ss: 0.791726, loss_d: 0.176074
0.9220 --- loss: 1.214513, loss_ss: 0.915809, loss_d: 0.298704
0.9604 --- loss: 1.209622, loss_ss: 0.897449, loss_d: 0.312173
0.9988 --- loss: 1.791127, loss_ss: 1.169766, loss_d: 0.621361
Epoch finished! Loss: 1.3784631025332672
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.847288, loss_ss: 0.709763, loss_d: 0.137524
0.0384 --- loss: 0.880691, loss_ss: 0.744535, loss_d: 0.136156
0.0768 --- loss: 1.011074, loss_ss: 0.778588, loss_d: 0.232486
0.1153 --- loss: 1.522036, loss_ss: 1.084577, loss_d: 0.437458
0.1537 --- loss: 1.495124, loss_ss: 0.839226, loss_d: 0.655898
0.1921 --- loss: 1.143251, loss_ss: 0.772463, loss_d: 0.370789
0.2305 --- loss: 1.981453, loss_ss: 1.618564, loss_d: 0.362889
0.2689 --- loss: 1.379808, loss_ss: 0.703918, loss_d: 0.675890
0.3073 --- loss: 1.489372, loss_ss: 1.086357, loss_d: 0.403016
0.3458 --- loss: 1.475408, loss_ss: 1.015652, loss_d: 0.459757
0.3842 --- loss: 1.011670, loss_ss: 0.790435, loss_d: 0.221236
0.4226 --- loss: 1.831669, loss_ss: 1.339337, loss_d: 0.492331
0.4610 --- loss: 1.110263, loss_ss: 0.679681, loss_d: 0.430582
0.4994 --- loss: 0.983160, loss_ss: 0.685559, loss_d: 0.297600
0.5378 --- loss: 1.138141, loss_ss: 0.817917, loss_d: 0.320224
0.5763 --- loss: 1.119961, loss_ss: 0.882010, loss_d: 0.237951
0.6147 --- loss: 1.519811, loss_ss: 1.217744, loss_d: 0.302067
0.6531 --- loss: 1.170756, loss_ss: 0.895115, loss_d: 0.275642
0.6915 --- loss: 1.331565, loss_ss: 0.898950, loss_d: 0.432614
0.7299 --- loss: 1.568125, loss_ss: 1.066818, loss_d: 0.501307
0.7683 --- loss: 1.486222, loss_ss: 1.014118, loss_d: 0.472104
0.8068 --- loss: 1.569818, loss_ss: 0.992533, loss_d: 0.577285
0.8452 --- loss: 0.991528, loss_ss: 0.600922, loss_d: 0.390605
0.8836 --- loss: 1.432135, loss_ss: 1.030914, loss_d: 0.401221
0.9220 --- loss: 1.202207, loss_ss: 0.704195, loss_d: 0.498013
0.9604 --- loss: 1.221024, loss_ss: 0.753023, loss_d: 0.468001
0.9988 --- loss: 1.598053, loss_ss: 1.139048, loss_d: 0.459005
Epoch finished! Loss: 1.3225958386292824
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.941131, loss_ss: 0.746192, loss_d: 0.194939
0.0384 --- loss: 1.046422, loss_ss: 0.900477, loss_d: 0.145945
0.0768 --- loss: 1.035281, loss_ss: 0.775693, loss_d: 0.259588
0.1153 --- loss: 1.270830, loss_ss: 0.913673, loss_d: 0.357157
0.1537 --- loss: 2.279254, loss_ss: 0.744201, loss_d: 1.535054
0.1921 --- loss: 1.177311, loss_ss: 0.802038, loss_d: 0.375273
0.2305 --- loss: 1.490317, loss_ss: 1.175153, loss_d: 0.315164
0.2689 --- loss: 0.910444, loss_ss: 0.711908, loss_d: 0.198535
0.3073 --- loss: 1.067104, loss_ss: 0.644170, loss_d: 0.422934
0.3458 --- loss: 0.922542, loss_ss: 0.775196, loss_d: 0.147346
0.3842 --- loss: 1.233144, loss_ss: 0.846507, loss_d: 0.386637
0.4226 --- loss: 1.101096, loss_ss: 0.965888, loss_d: 0.135208
0.4610 --- loss: 1.521936, loss_ss: 0.996577, loss_d: 0.525360
0.4994 --- loss: 1.193784, loss_ss: 0.893967, loss_d: 0.299817
0.5378 --- loss: 1.271493, loss_ss: 1.132296, loss_d: 0.139196
0.5763 --- loss: 1.216424, loss_ss: 0.856647, loss_d: 0.359778
0.6147 --- loss: 1.341691, loss_ss: 1.142014, loss_d: 0.199677
0.6531 --- loss: 1.034862, loss_ss: 0.783601, loss_d: 0.251261
0.6915 --- loss: 1.082529, loss_ss: 0.701579, loss_d: 0.380949
0.7299 --- loss: 1.162181, loss_ss: 0.761518, loss_d: 0.400663
0.7683 --- loss: 1.138951, loss_ss: 0.913051, loss_d: 0.225899
0.8068 --- loss: 1.282847, loss_ss: 0.836211, loss_d: 0.446636
0.8452 --- loss: 1.419932, loss_ss: 0.953081, loss_d: 0.466851
0.8836 --- loss: 1.025123, loss_ss: 0.677744, loss_d: 0.347379
0.9220 --- loss: 1.575593, loss_ss: 1.152815, loss_d: 0.422778
0.9604 --- loss: 1.006121, loss_ss: 0.661722, loss_d: 0.344399
0.9988 --- loss: 2.699059, loss_ss: 2.532147, loss_d: 0.166912
Epoch finished! Loss: 1.2709509957295198
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.975324, loss_ss: 0.534874, loss_d: 0.440449
0.0384 --- loss: 1.141351, loss_ss: 0.861974, loss_d: 0.279376
0.0768 --- loss: 1.443345, loss_ss: 1.106958, loss_d: 0.336387
0.1153 --- loss: 1.326245, loss_ss: 0.934784, loss_d: 0.391460
0.1537 --- loss: 1.212417, loss_ss: 0.896867, loss_d: 0.315550
0.1921 --- loss: 1.030155, loss_ss: 0.906627, loss_d: 0.123528
0.2305 --- loss: 0.996491, loss_ss: 0.778846, loss_d: 0.217645
0.2689 --- loss: 1.377328, loss_ss: 0.994192, loss_d: 0.383137
0.3073 --- loss: 1.119995, loss_ss: 0.962409, loss_d: 0.157586
0.3458 --- loss: 0.928205, loss_ss: 0.827196, loss_d: 0.101009
0.3842 --- loss: 1.238836, loss_ss: 0.984548, loss_d: 0.254288
0.4226 --- loss: 0.961198, loss_ss: 0.807714, loss_d: 0.153484
0.4610 --- loss: 1.095468, loss_ss: 0.842015, loss_d: 0.253453
0.4994 --- loss: 1.032047, loss_ss: 0.845121, loss_d: 0.186926
0.5378 --- loss: 1.265548, loss_ss: 1.005496, loss_d: 0.260052
0.5763 --- loss: 1.095502, loss_ss: 0.750163, loss_d: 0.345340
0.6147 --- loss: 1.159244, loss_ss: 0.781884, loss_d: 0.377360
0.6531 --- loss: 1.189704, loss_ss: 0.762230, loss_d: 0.427475
0.6915 --- loss: 1.236096, loss_ss: 0.754262, loss_d: 0.481834
0.7299 --- loss: 1.200192, loss_ss: 0.833181, loss_d: 0.367011
0.7683 --- loss: 1.335938, loss_ss: 0.748598, loss_d: 0.587340
0.8068 --- loss: 0.849722, loss_ss: 0.676086, loss_d: 0.173636
0.8452 --- loss: 0.894426, loss_ss: 0.678127, loss_d: 0.216299
0.8836 --- loss: 1.092025, loss_ss: 0.768603, loss_d: 0.323422
0.9220 --- loss: 1.088000, loss_ss: 0.872161, loss_d: 0.215839
0.9604 --- loss: 1.573549, loss_ss: 1.276638, loss_d: 0.296911
0.9988 --- loss: 1.568737, loss_ss: 0.657365, loss_d: 0.911372
Epoch finished! Loss: 1.1964309428746884
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.069272, loss_ss: 0.849584, loss_d: 0.219688
0.0384 --- loss: 1.496164, loss_ss: 1.164963, loss_d: 0.331201
0.0768 --- loss: 1.339804, loss_ss: 0.977507, loss_d: 0.362298
0.1153 --- loss: 0.879831, loss_ss: 0.676632, loss_d: 0.203199
0.1537 --- loss: 1.410005, loss_ss: 1.026334, loss_d: 0.383672
0.1921 --- loss: 0.890682, loss_ss: 0.719766, loss_d: 0.170916
0.2305 --- loss: 1.989342, loss_ss: 0.987002, loss_d: 1.002340
0.2689 --- loss: 0.982803, loss_ss: 0.762027, loss_d: 0.220777
0.3073 --- loss: 1.117827, loss_ss: 0.756022, loss_d: 0.361805
0.3458 --- loss: 1.048150, loss_ss: 0.692304, loss_d: 0.355845
0.3842 --- loss: 1.345339, loss_ss: 1.089650, loss_d: 0.255689
0.4226 --- loss: 1.336239, loss_ss: 1.183776, loss_d: 0.152463
0.4610 --- loss: 0.885234, loss_ss: 0.751231, loss_d: 0.134003
0.4994 --- loss: 1.158031, loss_ss: 0.727330, loss_d: 0.430701
0.5378 --- loss: 1.130659, loss_ss: 0.963309, loss_d: 0.167350
0.5763 --- loss: 1.030436, loss_ss: 0.749038, loss_d: 0.281398
0.6147 --- loss: 1.169859, loss_ss: 0.928736, loss_d: 0.241123
0.6531 --- loss: 1.278002, loss_ss: 0.894491, loss_d: 0.383511
0.6915 --- loss: 1.339178, loss_ss: 0.729794, loss_d: 0.609384
0.7299 --- loss: 0.969581, loss_ss: 0.860864, loss_d: 0.108717
0.7683 --- loss: 1.312774, loss_ss: 1.050556, loss_d: 0.262218
0.8068 --- loss: 0.781606, loss_ss: 0.628849, loss_d: 0.152757
0.8452 --- loss: 1.572150, loss_ss: 1.424625, loss_d: 0.147525
0.8836 --- loss: 0.782969, loss_ss: 0.410549, loss_d: 0.372420
0.9220 --- loss: 0.799354, loss_ss: 0.662686, loss_d: 0.136668
0.9604 --- loss: 1.751347, loss_ss: 0.710675, loss_d: 1.040671
0.9988 --- loss: 2.268923, loss_ss: 1.730757, loss_d: 0.538166
Epoch finished! Loss: 1.152842805477289
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6104761904761905
             precision    recall  f1-score   support

        0.0       0.65      0.51      0.57        47
        1.0       0.00      0.00      0.00       108
        2.0       0.98      0.48      0.64       516
        3.0       0.67      0.97      0.79       150
        4.0       0.41      0.97      0.58       229

avg / total       0.70      0.61      0.58      1050
 


====== chp032-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  96.57  51.06   98.70  64.86     57.14
1  89.52   0.00   99.79   0.00      0.00
2  74.00  48.06   99.06  98.02     64.50
3  92.67  97.33   91.89  66.67     79.13
4  69.33  97.38   61.51  41.37     58.07
Total accuracy: 61.05%
Average sen: 58.77%
Average spec: 90.19%
Macro f1-score: 51.77%
[0.93412036 0.90671587 0.54792279 0.28335947 0.17352296 0.26117468
 0.39673948 0.92449749 0.93964916 0.97059971 0.90986484 0.29514053
 0.31535268 0.71358317 0.64139974 0.19996415 0.394104   0.34908885
 0.98053116 0.99061489 0.96881491 0.9147563  0.97134405 0.98423588
 0.42767677 0.14828104 0.60436064 0.96399915 0.97214264 0.98715425
 0.98934013 0.9666853  0.93737447 0.98960096 0.79289222]
pred: 0.7070458480290004, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.324664, loss_ss: 1.631397, loss_d: 0.693268
0.0384 --- loss: 2.063192, loss_ss: 1.618680, loss_d: 0.444512
0.0768 --- loss: 2.244792, loss_ss: 1.554176, loss_d: 0.690615
0.1152 --- loss: 1.934763, loss_ss: 1.416252, loss_d: 0.518511
0.1536 --- loss: 2.624648, loss_ss: 1.609008, loss_d: 1.015640
0.1919 --- loss: 1.983567, loss_ss: 1.392535, loss_d: 0.591032
0.2303 --- loss: 2.108866, loss_ss: 1.438034, loss_d: 0.670832
0.2687 --- loss: 1.928473, loss_ss: 1.288152, loss_d: 0.640321
0.3071 --- loss: 2.218410, loss_ss: 1.319863, loss_d: 0.898547
0.3455 --- loss: 2.164263, loss_ss: 1.492897, loss_d: 0.671366
0.3839 --- loss: 1.891604, loss_ss: 1.351962, loss_d: 0.539642
0.4223 --- loss: 1.960190, loss_ss: 1.367834, loss_d: 0.592356
0.4607 --- loss: 1.790622, loss_ss: 1.299983, loss_d: 0.490639
0.4990 --- loss: 1.726512, loss_ss: 1.264490, loss_d: 0.462021
0.5374 --- loss: 1.649658, loss_ss: 1.193383, loss_d: 0.456275
0.5758 --- loss: 2.192663, loss_ss: 1.683229, loss_d: 0.509434
0.6142 --- loss: 1.956537, loss_ss: 1.322076, loss_d: 0.634461
0.6526 --- loss: 1.787663, loss_ss: 1.141634, loss_d: 0.646029
0.6910 --- loss: 1.641360, loss_ss: 1.202084, loss_d: 0.439276
0.7294 --- loss: 1.932561, loss_ss: 1.204820, loss_d: 0.727741
0.7678 --- loss: 1.831937, loss_ss: 1.244168, loss_d: 0.587769
0.8061 --- loss: 1.492903, loss_ss: 1.104069, loss_d: 0.388834
0.8445 --- loss: 1.995083, loss_ss: 1.327654, loss_d: 0.667429
0.8829 --- loss: 1.997838, loss_ss: 1.251184, loss_d: 0.746655
0.9213 --- loss: 1.717092, loss_ss: 1.160953, loss_d: 0.556139
0.9597 --- loss: 1.595526, loss_ss: 1.042214, loss_d: 0.553312
0.9981 --- loss: 2.108192, loss_ss: 1.359839, loss_d: 0.748353
Epoch finished! Loss: 1.9539568772682776
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.752264, loss_ss: 1.064934, loss_d: 0.687330
0.0384 --- loss: 1.780955, loss_ss: 1.076522, loss_d: 0.704433
0.0768 --- loss: 1.863998, loss_ss: 1.105856, loss_d: 0.758142
0.1152 --- loss: 1.672479, loss_ss: 1.118412, loss_d: 0.554068
0.1536 --- loss: 1.638871, loss_ss: 1.135031, loss_d: 0.503840
0.1919 --- loss: 2.107795, loss_ss: 1.256014, loss_d: 0.851782
0.2303 --- loss: 1.704183, loss_ss: 0.942499, loss_d: 0.761684
0.2687 --- loss: 1.484424, loss_ss: 1.124962, loss_d: 0.359462
0.3071 --- loss: 1.672187, loss_ss: 1.068286, loss_d: 0.603902
0.3455 --- loss: 1.504719, loss_ss: 1.030058, loss_d: 0.474661
0.3839 --- loss: 1.530660, loss_ss: 1.023730, loss_d: 0.506930
0.4223 --- loss: 1.445389, loss_ss: 0.950550, loss_d: 0.494838
0.4607 --- loss: 1.518134, loss_ss: 1.123549, loss_d: 0.394585
0.4990 --- loss: 1.664328, loss_ss: 1.209051, loss_d: 0.455276
0.5374 --- loss: 1.831910, loss_ss: 1.228659, loss_d: 0.603251
0.5758 --- loss: 1.427190, loss_ss: 0.906429, loss_d: 0.520761
0.6142 --- loss: 1.642373, loss_ss: 1.089436, loss_d: 0.552938
0.6526 --- loss: 1.647002, loss_ss: 1.014385, loss_d: 0.632617
0.6910 --- loss: 1.789060, loss_ss: 1.186695, loss_d: 0.602365
0.7294 --- loss: 1.402729, loss_ss: 1.067386, loss_d: 0.335343
0.7678 --- loss: 1.828771, loss_ss: 1.219465, loss_d: 0.609306
0.8061 --- loss: 1.609840, loss_ss: 1.002674, loss_d: 0.607166
0.8445 --- loss: 1.660416, loss_ss: 1.062386, loss_d: 0.598030
0.8829 --- loss: 1.502879, loss_ss: 1.016235, loss_d: 0.486644
0.9213 --- loss: 1.304096, loss_ss: 0.918911, loss_d: 0.385184
0.9597 --- loss: 1.924640, loss_ss: 1.047688, loss_d: 0.876952
0.9981 --- loss: 1.720887, loss_ss: 1.134951, loss_d: 0.585936
Epoch finished! Loss: 1.683711982690371
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.535553, loss_ss: 0.920286, loss_d: 0.615268
0.0384 --- loss: 1.348290, loss_ss: 0.802114, loss_d: 0.546176
0.0768 --- loss: 1.394540, loss_ss: 0.883528, loss_d: 0.511013
0.1152 --- loss: 1.619246, loss_ss: 1.234161, loss_d: 0.385086
0.1536 --- loss: 1.710172, loss_ss: 1.180349, loss_d: 0.529823
0.1919 --- loss: 1.501568, loss_ss: 1.107982, loss_d: 0.393586
0.2303 --- loss: 1.924815, loss_ss: 1.239028, loss_d: 0.685787
0.2687 --- loss: 1.625707, loss_ss: 0.885359, loss_d: 0.740347
0.3071 --- loss: 1.780753, loss_ss: 1.128487, loss_d: 0.652266
0.3455 --- loss: 1.575857, loss_ss: 1.200215, loss_d: 0.375641
0.3839 --- loss: 1.555328, loss_ss: 1.031480, loss_d: 0.523848
0.4223 --- loss: 1.397483, loss_ss: 0.840207, loss_d: 0.557276
0.4607 --- loss: 1.555961, loss_ss: 0.963831, loss_d: 0.592129
0.4990 --- loss: 1.833498, loss_ss: 1.022337, loss_d: 0.811160
0.5374 --- loss: 1.649621, loss_ss: 1.147634, loss_d: 0.501987
0.5758 --- loss: 1.946299, loss_ss: 1.370438, loss_d: 0.575862
0.6142 --- loss: 1.409509, loss_ss: 0.985255, loss_d: 0.424254
0.6526 --- loss: 1.384964, loss_ss: 0.892144, loss_d: 0.492820
0.6910 --- loss: 1.493385, loss_ss: 1.023263, loss_d: 0.470122
0.7294 --- loss: 1.378098, loss_ss: 1.099079, loss_d: 0.279019
0.7678 --- loss: 1.288961, loss_ss: 0.733348, loss_d: 0.555613
0.8061 --- loss: 1.930383, loss_ss: 1.031121, loss_d: 0.899262
0.8445 --- loss: 1.376647, loss_ss: 0.948450, loss_d: 0.428197
0.8829 --- loss: 1.330510, loss_ss: 0.872195, loss_d: 0.458316
0.9213 --- loss: 1.675647, loss_ss: 1.104981, loss_d: 0.570665
0.9597 --- loss: 1.232043, loss_ss: 0.706038, loss_d: 0.526004
0.9981 --- loss: 1.227056, loss_ss: 0.946280, loss_d: 0.280776
Epoch finished! Loss: 1.5847630940950834
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.307794, loss_ss: 0.869478, loss_d: 0.438316
0.0384 --- loss: 1.769703, loss_ss: 0.957931, loss_d: 0.811772
0.0768 --- loss: 1.261302, loss_ss: 0.894243, loss_d: 0.367059
0.1152 --- loss: 1.644659, loss_ss: 1.166277, loss_d: 0.478382
0.1536 --- loss: 1.378338, loss_ss: 0.974391, loss_d: 0.403947
0.1919 --- loss: 1.584143, loss_ss: 0.942816, loss_d: 0.641326
0.2303 --- loss: 1.467097, loss_ss: 0.829822, loss_d: 0.637274
0.2687 --- loss: 1.555640, loss_ss: 1.160344, loss_d: 0.395297
0.3071 --- loss: 1.487965, loss_ss: 0.985932, loss_d: 0.502033
0.3455 --- loss: 1.591203, loss_ss: 0.991984, loss_d: 0.599219
0.3839 --- loss: 1.358927, loss_ss: 0.826887, loss_d: 0.532040
0.4223 --- loss: 1.552041, loss_ss: 1.052115, loss_d: 0.499926
0.4607 --- loss: 1.390222, loss_ss: 1.001621, loss_d: 0.388601
0.4990 --- loss: 1.342273, loss_ss: 0.760162, loss_d: 0.582111
0.5374 --- loss: 1.504293, loss_ss: 0.954389, loss_d: 0.549904
0.5758 --- loss: 1.402713, loss_ss: 0.849796, loss_d: 0.552917
0.6142 --- loss: 1.677096, loss_ss: 1.272767, loss_d: 0.404329
0.6526 --- loss: 1.392162, loss_ss: 0.922882, loss_d: 0.469280
0.6910 --- loss: 1.323953, loss_ss: 0.899873, loss_d: 0.424079
0.7294 --- loss: 1.628155, loss_ss: 1.032474, loss_d: 0.595681
0.7678 --- loss: 2.027775, loss_ss: 1.180798, loss_d: 0.846977
0.8061 --- loss: 1.375298, loss_ss: 0.804837, loss_d: 0.570460
0.8445 --- loss: 1.421114, loss_ss: 0.976696, loss_d: 0.444418
0.8829 --- loss: 1.186026, loss_ss: 0.859486, loss_d: 0.326540
0.9213 --- loss: 1.558651, loss_ss: 1.250785, loss_d: 0.307865
0.9597 --- loss: 1.607192, loss_ss: 1.109130, loss_d: 0.498062
0.9981 --- loss: 1.330234, loss_ss: 1.112008, loss_d: 0.218226
Epoch finished! Loss: 1.496696775463911
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.953270, loss_ss: 0.625447, loss_d: 0.327823
0.0384 --- loss: 1.969081, loss_ss: 1.346464, loss_d: 0.622617
0.0768 --- loss: 1.517039, loss_ss: 1.200502, loss_d: 0.316537
0.1152 --- loss: 1.010725, loss_ss: 0.788983, loss_d: 0.221743
0.1536 --- loss: 2.075605, loss_ss: 0.968880, loss_d: 1.106726
0.1919 --- loss: 1.720970, loss_ss: 0.928641, loss_d: 0.792329
0.2303 --- loss: 1.274096, loss_ss: 0.929397, loss_d: 0.344699
0.2687 --- loss: 1.368163, loss_ss: 1.098375, loss_d: 0.269787
0.3071 --- loss: 1.636925, loss_ss: 1.084875, loss_d: 0.552050
0.3455 --- loss: 1.532200, loss_ss: 0.983573, loss_d: 0.548627
0.3839 --- loss: 1.372875, loss_ss: 1.005812, loss_d: 0.367063
0.4223 --- loss: 1.531234, loss_ss: 1.058548, loss_d: 0.472686
0.4607 --- loss: 1.323908, loss_ss: 0.944386, loss_d: 0.379522
0.4990 --- loss: 1.751637, loss_ss: 1.069090, loss_d: 0.682547
0.5374 --- loss: 1.616285, loss_ss: 0.952702, loss_d: 0.663583
0.5758 --- loss: 1.615446, loss_ss: 0.957047, loss_d: 0.658399
0.6142 --- loss: 1.153608, loss_ss: 0.680855, loss_d: 0.472754
0.6526 --- loss: 1.285343, loss_ss: 0.880458, loss_d: 0.404884
0.6910 --- loss: 1.530841, loss_ss: 0.911912, loss_d: 0.618929
0.7294 --- loss: 1.198637, loss_ss: 0.663279, loss_d: 0.535357
0.7678 --- loss: 1.534850, loss_ss: 1.007594, loss_d: 0.527256
0.8061 --- loss: 1.364375, loss_ss: 1.116332, loss_d: 0.248043
0.8445 --- loss: 1.312624, loss_ss: 0.845897, loss_d: 0.466727
0.8829 --- loss: 1.636881, loss_ss: 0.942746, loss_d: 0.694134
0.9213 --- loss: 1.454603, loss_ss: 1.110722, loss_d: 0.343880
0.9597 --- loss: 1.446693, loss_ss: 0.798679, loss_d: 0.648014
0.9981 --- loss: 1.569986, loss_ss: 0.985439, loss_d: 0.584546
Epoch finished! Loss: 1.3956035763025283
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.706171, loss_ss: 1.119417, loss_d: 0.586754
0.0384 --- loss: 1.192096, loss_ss: 0.828418, loss_d: 0.363678
0.0768 --- loss: 1.390586, loss_ss: 1.070635, loss_d: 0.319951
0.1152 --- loss: 1.344199, loss_ss: 0.946046, loss_d: 0.398152
0.1536 --- loss: 1.128789, loss_ss: 0.749919, loss_d: 0.378870
0.1919 --- loss: 1.203889, loss_ss: 0.692597, loss_d: 0.511292
0.2303 --- loss: 1.496356, loss_ss: 1.117561, loss_d: 0.378795
0.2687 --- loss: 1.128130, loss_ss: 0.859445, loss_d: 0.268686
0.3071 --- loss: 0.933454, loss_ss: 0.706255, loss_d: 0.227198
0.3455 --- loss: 1.310990, loss_ss: 0.985109, loss_d: 0.325880
0.3839 --- loss: 1.330501, loss_ss: 1.067181, loss_d: 0.263320
0.4223 --- loss: 1.168324, loss_ss: 0.673364, loss_d: 0.494960
0.4607 --- loss: 1.163929, loss_ss: 0.897531, loss_d: 0.266398
0.4990 --- loss: 1.114917, loss_ss: 0.857000, loss_d: 0.257917
0.5374 --- loss: 1.217367, loss_ss: 0.780661, loss_d: 0.436706
0.5758 --- loss: 0.923684, loss_ss: 0.790011, loss_d: 0.133673
0.6142 --- loss: 1.248467, loss_ss: 0.688213, loss_d: 0.560254
0.6526 --- loss: 1.271629, loss_ss: 1.019720, loss_d: 0.251908
0.6910 --- loss: 1.095567, loss_ss: 0.938953, loss_d: 0.156613
0.7294 --- loss: 1.545440, loss_ss: 1.095790, loss_d: 0.449650
0.7678 --- loss: 1.296927, loss_ss: 0.944094, loss_d: 0.352833
0.8061 --- loss: 1.308101, loss_ss: 0.911402, loss_d: 0.396698
0.8445 --- loss: 1.196779, loss_ss: 0.985440, loss_d: 0.211339
0.8829 --- loss: 1.504516, loss_ss: 1.288568, loss_d: 0.215948
0.9213 --- loss: 1.938747, loss_ss: 0.985591, loss_d: 0.953156
0.9597 --- loss: 1.528767, loss_ss: 0.776504, loss_d: 0.752262
0.9981 --- loss: 1.648441, loss_ss: 1.141221, loss_d: 0.507219
Epoch finished! Loss: 1.3194541021035269
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.242997, loss_ss: 0.821525, loss_d: 0.421472
0.0384 --- loss: 1.329352, loss_ss: 0.897140, loss_d: 0.432212
0.0768 --- loss: 1.528467, loss_ss: 0.972428, loss_d: 0.556039
0.1152 --- loss: 1.065059, loss_ss: 0.748282, loss_d: 0.316777
0.1536 --- loss: 1.218570, loss_ss: 0.904592, loss_d: 0.313979
0.1919 --- loss: 1.581750, loss_ss: 1.051765, loss_d: 0.529986
0.2303 --- loss: 1.614834, loss_ss: 1.010881, loss_d: 0.603953
0.2687 --- loss: 1.457881, loss_ss: 1.066870, loss_d: 0.391011
0.3071 --- loss: 1.158894, loss_ss: 0.846648, loss_d: 0.312245
0.3455 --- loss: 1.400734, loss_ss: 0.961171, loss_d: 0.439563
0.3839 --- loss: 1.273958, loss_ss: 1.038925, loss_d: 0.235034
0.4223 --- loss: 1.306941, loss_ss: 1.002301, loss_d: 0.304640
0.4607 --- loss: 1.094131, loss_ss: 0.657061, loss_d: 0.437070
0.4990 --- loss: 1.048561, loss_ss: 0.798007, loss_d: 0.250554
0.5374 --- loss: 1.657415, loss_ss: 1.073965, loss_d: 0.583450
0.5758 --- loss: 0.978882, loss_ss: 0.807408, loss_d: 0.171474
0.6142 --- loss: 1.602167, loss_ss: 0.956196, loss_d: 0.645971
0.6526 --- loss: 0.972275, loss_ss: 0.630997, loss_d: 0.341278
0.6910 --- loss: 1.498921, loss_ss: 0.778213, loss_d: 0.720708
0.7294 --- loss: 1.141497, loss_ss: 0.841799, loss_d: 0.299698
0.7678 --- loss: 1.110773, loss_ss: 0.900752, loss_d: 0.210020
0.8061 --- loss: 0.938334, loss_ss: 0.760962, loss_d: 0.177372
0.8445 --- loss: 1.279901, loss_ss: 1.001593, loss_d: 0.278308
0.8829 --- loss: 1.432943, loss_ss: 0.736936, loss_d: 0.696008
0.9213 --- loss: 1.346328, loss_ss: 1.086137, loss_d: 0.260191
0.9597 --- loss: 1.674997, loss_ss: 0.921157, loss_d: 0.753840
0.9981 --- loss: 1.486666, loss_ss: 1.044558, loss_d: 0.442109
Epoch finished! Loss: 1.271504003726519
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.930217, loss_ss: 0.649619, loss_d: 1.280598
0.0384 --- loss: 1.319870, loss_ss: 0.565759, loss_d: 0.754111
0.0768 --- loss: 1.094193, loss_ss: 0.751494, loss_d: 0.342699
0.1152 --- loss: 1.147814, loss_ss: 0.886427, loss_d: 0.261387
0.1536 --- loss: 1.166845, loss_ss: 1.003106, loss_d: 0.163739
0.1919 --- loss: 1.098595, loss_ss: 0.988488, loss_d: 0.110107
0.2303 --- loss: 0.951893, loss_ss: 0.815872, loss_d: 0.136022
0.2687 --- loss: 0.758053, loss_ss: 0.493281, loss_d: 0.264772
0.3071 --- loss: 1.294654, loss_ss: 0.940323, loss_d: 0.354331
0.3455 --- loss: 0.879972, loss_ss: 0.715838, loss_d: 0.164134
0.3839 --- loss: 1.058377, loss_ss: 0.823462, loss_d: 0.234914
0.4223 --- loss: 1.378051, loss_ss: 0.735593, loss_d: 0.642458
0.4607 --- loss: 0.985698, loss_ss: 0.719554, loss_d: 0.266144
0.4990 --- loss: 1.067326, loss_ss: 0.852576, loss_d: 0.214750
0.5374 --- loss: 1.245908, loss_ss: 0.894241, loss_d: 0.351667
0.5758 --- loss: 1.455883, loss_ss: 1.078803, loss_d: 0.377080
0.6142 --- loss: 0.890513, loss_ss: 0.792487, loss_d: 0.098026
0.6526 --- loss: 1.011423, loss_ss: 0.783708, loss_d: 0.227715
0.6910 --- loss: 0.890348, loss_ss: 0.598276, loss_d: 0.292072
0.7294 --- loss: 1.310846, loss_ss: 0.995935, loss_d: 0.314911
0.7678 --- loss: 1.113763, loss_ss: 0.858405, loss_d: 0.255358
0.8061 --- loss: 1.195053, loss_ss: 0.722970, loss_d: 0.472083
0.8445 --- loss: 1.072419, loss_ss: 0.898313, loss_d: 0.174106
0.8829 --- loss: 1.470776, loss_ss: 1.282564, loss_d: 0.188212
0.9213 --- loss: 0.989289, loss_ss: 0.879125, loss_d: 0.110164
0.9597 --- loss: 1.481608, loss_ss: 1.007622, loss_d: 0.473986
0.9981 --- loss: 1.814798, loss_ss: 1.465783, loss_d: 0.349016
Epoch finished! Loss: 1.209885227221709
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.817618, loss_ss: 1.276985, loss_d: 0.540633
0.0384 --- loss: 1.180131, loss_ss: 0.945587, loss_d: 0.234544
0.0768 --- loss: 1.148250, loss_ss: 0.945834, loss_d: 0.202416
0.1152 --- loss: 0.952581, loss_ss: 0.797655, loss_d: 0.154925
0.1536 --- loss: 1.166977, loss_ss: 0.727672, loss_d: 0.439305
0.1919 --- loss: 0.996975, loss_ss: 0.787267, loss_d: 0.209708
0.2303 --- loss: 1.040445, loss_ss: 0.839227, loss_d: 0.201217
0.2687 --- loss: 1.292648, loss_ss: 1.005446, loss_d: 0.287203
0.3071 --- loss: 1.395864, loss_ss: 1.136488, loss_d: 0.259375
0.3455 --- loss: 1.109359, loss_ss: 0.900242, loss_d: 0.209117
0.3839 --- loss: 0.805741, loss_ss: 0.664793, loss_d: 0.140948
0.4223 --- loss: 0.734372, loss_ss: 0.617309, loss_d: 0.117063
0.4607 --- loss: 0.928561, loss_ss: 0.741754, loss_d: 0.186807
0.4990 --- loss: 1.500302, loss_ss: 1.250070, loss_d: 0.250231
0.5374 --- loss: 1.424581, loss_ss: 1.027668, loss_d: 0.396913
0.5758 --- loss: 1.260278, loss_ss: 0.783640, loss_d: 0.476638
0.6142 --- loss: 0.963468, loss_ss: 0.781612, loss_d: 0.181856
0.6526 --- loss: 1.243372, loss_ss: 1.062228, loss_d: 0.181144
0.6910 --- loss: 0.906968, loss_ss: 0.707940, loss_d: 0.199028
0.7294 --- loss: 0.839017, loss_ss: 0.676053, loss_d: 0.162964
0.7678 --- loss: 1.034345, loss_ss: 0.762303, loss_d: 0.272042
0.8061 --- loss: 1.386592, loss_ss: 1.196789, loss_d: 0.189802
0.8445 --- loss: 1.113376, loss_ss: 0.615419, loss_d: 0.497956
0.8829 --- loss: 1.090320, loss_ss: 0.746954, loss_d: 0.343366
0.9213 --- loss: 0.869994, loss_ss: 0.716610, loss_d: 0.153384
0.9597 --- loss: 1.134550, loss_ss: 0.793428, loss_d: 0.341122
0.9981 --- loss: 1.103304, loss_ss: 0.855499, loss_d: 0.247805
Epoch finished! Loss: 1.2090041137658634
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.012373, loss_ss: 0.691380, loss_d: 0.320993
0.0384 --- loss: 1.012447, loss_ss: 0.740668, loss_d: 0.271779
0.0768 --- loss: 1.276211, loss_ss: 0.697656, loss_d: 0.578555
0.1152 --- loss: 1.307439, loss_ss: 1.017142, loss_d: 0.290297
0.1536 --- loss: 1.387473, loss_ss: 0.888583, loss_d: 0.498890
0.1919 --- loss: 1.704332, loss_ss: 1.311419, loss_d: 0.392913
0.2303 --- loss: 1.408374, loss_ss: 0.676879, loss_d: 0.731494
0.2687 --- loss: 1.271179, loss_ss: 1.020892, loss_d: 0.250287
0.3071 --- loss: 0.954163, loss_ss: 0.651022, loss_d: 0.303141
0.3455 --- loss: 1.006660, loss_ss: 0.606276, loss_d: 0.400384
0.3839 --- loss: 0.993251, loss_ss: 0.710929, loss_d: 0.282322
0.4223 --- loss: 1.410829, loss_ss: 1.089080, loss_d: 0.321749
0.4607 --- loss: 1.334761, loss_ss: 1.048621, loss_d: 0.286141
0.4990 --- loss: 0.936583, loss_ss: 0.645402, loss_d: 0.291181
0.5374 --- loss: 1.196707, loss_ss: 0.920709, loss_d: 0.275997
0.5758 --- loss: 1.221213, loss_ss: 0.614310, loss_d: 0.606903
0.6142 --- loss: 0.890588, loss_ss: 0.779980, loss_d: 0.110608
0.6526 --- loss: 0.985579, loss_ss: 0.878333, loss_d: 0.107246
0.6910 --- loss: 1.227216, loss_ss: 0.758034, loss_d: 0.469183
0.7294 --- loss: 1.026416, loss_ss: 0.637902, loss_d: 0.388514
0.7678 --- loss: 1.256359, loss_ss: 1.040075, loss_d: 0.216283
0.8061 --- loss: 1.547291, loss_ss: 0.761963, loss_d: 0.785327
0.8445 --- loss: 1.027862, loss_ss: 0.716040, loss_d: 0.311822
0.8829 --- loss: 1.090894, loss_ss: 0.899314, loss_d: 0.191580
0.9213 --- loss: 1.436719, loss_ss: 0.826461, loss_d: 0.610258
0.9597 --- loss: 1.298533, loss_ss: 0.784180, loss_d: 0.514353
0.9981 --- loss: 0.952588, loss_ss: 0.891637, loss_d: 0.060951
Epoch finished! Loss: 1.1436752860362713
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6202020202020202
             precision    recall  f1-score   support

        0.0       0.18      0.91      0.30        32
        1.0       0.73      0.06      0.12       251
        2.0       0.49      0.89      0.64       208
        3.0       0.96      0.96      0.96       254
        4.0       0.78      0.56      0.65       245

avg / total       0.73      0.62      0.58       990
 


====== chp033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.57  90.62   86.43  18.24     30.37
1  75.66   6.37   99.19  72.73     11.72
2  78.59  89.42   75.70  49.47     63.70
3  98.08  96.46   98.64  96.08     96.27
4  85.15  56.33   94.63  77.53     65.25
Total accuracy: 62.02%
Average sen: 67.84%
Average spec: 90.92%
Macro f1-score: 53.46%
[0.76194155 0.93510532 0.98012    0.98686218 0.98246735 0.9899658
 0.98527616 0.99889141 0.99999547 0.98980826 0.92933625 0.97460145
 0.97289622 0.99990153 0.99610847 0.9807905  0.98371941 0.99999452
 0.90488845 0.99999595 0.99984574 0.98001879 0.99999309 0.63240182
 0.9922874  0.99999511 0.99846303 0.98552752 0.91193569 0.75071412
 0.98287857 0.94394684 0.97792441]
pred: 0.9548060117345868, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.557587, loss_ss: 1.853837, loss_d: 0.703750
0.0384 --- loss: 2.118971, loss_ss: 1.464451, loss_d: 0.654520
0.0768 --- loss: 2.074177, loss_ss: 1.527782, loss_d: 0.546394
0.1152 --- loss: 1.912997, loss_ss: 1.343496, loss_d: 0.569501
0.1536 --- loss: 2.002280, loss_ss: 1.430360, loss_d: 0.571920
0.1920 --- loss: 2.061106, loss_ss: 1.488681, loss_d: 0.572425
0.2304 --- loss: 1.668005, loss_ss: 1.285599, loss_d: 0.382407
0.2688 --- loss: 1.716037, loss_ss: 1.276899, loss_d: 0.439139
0.3072 --- loss: 1.650937, loss_ss: 1.248811, loss_d: 0.402126
0.3456 --- loss: 2.293816, loss_ss: 1.666025, loss_d: 0.627791
0.3840 --- loss: 2.201551, loss_ss: 1.473147, loss_d: 0.728405
0.4224 --- loss: 2.389265, loss_ss: 1.303337, loss_d: 1.085928
0.4608 --- loss: 1.753735, loss_ss: 1.413996, loss_d: 0.339739
0.4992 --- loss: 1.584732, loss_ss: 1.188665, loss_d: 0.396067
0.5376 --- loss: 2.171984, loss_ss: 1.562845, loss_d: 0.609139
0.5760 --- loss: 1.918887, loss_ss: 1.203229, loss_d: 0.715658
0.6144 --- loss: 1.892077, loss_ss: 1.353282, loss_d: 0.538795
0.6528 --- loss: 1.873168, loss_ss: 1.266956, loss_d: 0.606213
0.6912 --- loss: 1.916816, loss_ss: 1.185652, loss_d: 0.731164
0.7296 --- loss: 1.903269, loss_ss: 1.226069, loss_d: 0.677200
0.7680 --- loss: 1.639279, loss_ss: 1.101106, loss_d: 0.538173
0.8065 --- loss: 1.551755, loss_ss: 1.264688, loss_d: 0.287067
0.8449 --- loss: 1.976940, loss_ss: 1.443879, loss_d: 0.533061
0.8833 --- loss: 1.890589, loss_ss: 1.220425, loss_d: 0.670165
0.9217 --- loss: 1.809102, loss_ss: 1.327529, loss_d: 0.481573
0.9601 --- loss: 1.783936, loss_ss: 1.143341, loss_d: 0.640595
0.9985 --- loss: 1.784130, loss_ss: 1.415396, loss_d: 0.368734
Epoch finished! Loss: 1.9702983723236964
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.735772, loss_ss: 1.114154, loss_d: 0.621618
0.0384 --- loss: 1.788097, loss_ss: 1.312838, loss_d: 0.475259
0.0768 --- loss: 1.678188, loss_ss: 1.049358, loss_d: 0.628829
0.1152 --- loss: 1.802529, loss_ss: 1.418519, loss_d: 0.384010
0.1536 --- loss: 1.811627, loss_ss: 1.155887, loss_d: 0.655740
0.1920 --- loss: 1.922752, loss_ss: 1.463516, loss_d: 0.459236
0.2304 --- loss: 1.932454, loss_ss: 1.269924, loss_d: 0.662530
0.2688 --- loss: 1.544774, loss_ss: 1.251112, loss_d: 0.293662
0.3072 --- loss: 1.874585, loss_ss: 1.365657, loss_d: 0.508928
0.3456 --- loss: 1.370660, loss_ss: 1.038458, loss_d: 0.332202
0.3840 --- loss: 1.796468, loss_ss: 1.205506, loss_d: 0.590961
0.4224 --- loss: 1.700279, loss_ss: 1.052144, loss_d: 0.648135
0.4608 --- loss: 1.719063, loss_ss: 1.099328, loss_d: 0.619735
0.4992 --- loss: 1.474998, loss_ss: 1.014540, loss_d: 0.460459
0.5376 --- loss: 1.842519, loss_ss: 1.390190, loss_d: 0.452329
0.5760 --- loss: 1.787754, loss_ss: 1.247243, loss_d: 0.540510
0.6144 --- loss: 1.769704, loss_ss: 1.123226, loss_d: 0.646477
0.6528 --- loss: 1.427982, loss_ss: 0.949340, loss_d: 0.478642
0.6912 --- loss: 1.362156, loss_ss: 0.961623, loss_d: 0.400532
0.7296 --- loss: 1.497519, loss_ss: 1.054618, loss_d: 0.442901
0.7680 --- loss: 1.711244, loss_ss: 1.072477, loss_d: 0.638768
0.8065 --- loss: 1.822308, loss_ss: 1.278379, loss_d: 0.543930
0.8449 --- loss: 1.330591, loss_ss: 0.949978, loss_d: 0.380613
0.8833 --- loss: 1.677092, loss_ss: 1.053570, loss_d: 0.623522
0.9217 --- loss: 1.744653, loss_ss: 1.085524, loss_d: 0.659129
0.9601 --- loss: 1.851746, loss_ss: 1.142800, loss_d: 0.708946
0.9985 --- loss: 1.860712, loss_ss: 0.867330, loss_d: 0.993381
Epoch finished! Loss: 1.7379480036405417
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.319722, loss_ss: 1.011274, loss_d: 0.308449
0.0384 --- loss: 1.457577, loss_ss: 0.956616, loss_d: 0.500961
0.0768 --- loss: 1.529956, loss_ss: 0.996835, loss_d: 0.533121
0.1152 --- loss: 1.588719, loss_ss: 1.154797, loss_d: 0.433921
0.1536 --- loss: 1.731670, loss_ss: 1.061825, loss_d: 0.669845
0.1920 --- loss: 1.741609, loss_ss: 1.025024, loss_d: 0.716585
0.2304 --- loss: 1.557316, loss_ss: 1.058269, loss_d: 0.499047
0.2688 --- loss: 1.820745, loss_ss: 1.170382, loss_d: 0.650363
0.3072 --- loss: 1.379287, loss_ss: 0.864274, loss_d: 0.515014
0.3456 --- loss: 1.243783, loss_ss: 0.915969, loss_d: 0.327814
0.3840 --- loss: 1.650607, loss_ss: 1.114220, loss_d: 0.536387
0.4224 --- loss: 1.677995, loss_ss: 1.194010, loss_d: 0.483985
0.4608 --- loss: 1.518157, loss_ss: 1.084738, loss_d: 0.433419
0.4992 --- loss: 1.283716, loss_ss: 0.868366, loss_d: 0.415350
0.5376 --- loss: 1.666305, loss_ss: 1.078288, loss_d: 0.588017
0.5760 --- loss: 1.331114, loss_ss: 0.887625, loss_d: 0.443489
0.6144 --- loss: 1.440196, loss_ss: 0.981242, loss_d: 0.458954
0.6528 --- loss: 1.322795, loss_ss: 0.829524, loss_d: 0.493272
0.6912 --- loss: 1.139457, loss_ss: 0.864014, loss_d: 0.275443
0.7296 --- loss: 1.762884, loss_ss: 1.046207, loss_d: 0.716677
0.7680 --- loss: 1.344144, loss_ss: 1.015633, loss_d: 0.328511
0.8065 --- loss: 1.576403, loss_ss: 1.053564, loss_d: 0.522840
0.8449 --- loss: 1.621670, loss_ss: 0.965715, loss_d: 0.655955
0.8833 --- loss: 1.664950, loss_ss: 0.995897, loss_d: 0.669053
0.9217 --- loss: 1.821601, loss_ss: 1.274493, loss_d: 0.547108
0.9601 --- loss: 1.458565, loss_ss: 0.910827, loss_d: 0.547738
0.9985 --- loss: 1.686406, loss_ss: 1.016650, loss_d: 0.669756
Epoch finished! Loss: 1.5869217423292308
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.664553, loss_ss: 1.062697, loss_d: 0.601856
0.0384 --- loss: 1.469157, loss_ss: 0.864849, loss_d: 0.604308
0.0768 --- loss: 1.615743, loss_ss: 0.990253, loss_d: 0.625490
0.1152 --- loss: 1.610367, loss_ss: 0.858987, loss_d: 0.751379
0.1536 --- loss: 1.694480, loss_ss: 1.090211, loss_d: 0.604269
0.1920 --- loss: 1.395379, loss_ss: 1.126386, loss_d: 0.268993
0.2304 --- loss: 1.499681, loss_ss: 1.176714, loss_d: 0.322967
0.2688 --- loss: 1.256720, loss_ss: 0.998021, loss_d: 0.258699
0.3072 --- loss: 1.258127, loss_ss: 0.841626, loss_d: 0.416500
0.3456 --- loss: 1.605820, loss_ss: 0.842543, loss_d: 0.763277
0.3840 --- loss: 1.375316, loss_ss: 0.802555, loss_d: 0.572761
0.4224 --- loss: 1.336656, loss_ss: 0.949082, loss_d: 0.387574
0.4608 --- loss: 1.440258, loss_ss: 0.790186, loss_d: 0.650073
0.4992 --- loss: 1.486148, loss_ss: 0.804770, loss_d: 0.681378
0.5376 --- loss: 1.389344, loss_ss: 0.862242, loss_d: 0.527101
0.5760 --- loss: 1.305215, loss_ss: 0.762265, loss_d: 0.542949
0.6144 --- loss: 1.299080, loss_ss: 0.876116, loss_d: 0.422964
0.6528 --- loss: 1.478817, loss_ss: 0.939349, loss_d: 0.539468
0.6912 --- loss: 1.330509, loss_ss: 0.991383, loss_d: 0.339126
0.7296 --- loss: 1.517115, loss_ss: 1.058914, loss_d: 0.458201
0.7680 --- loss: 1.106860, loss_ss: 0.736437, loss_d: 0.370423
0.8065 --- loss: 1.476741, loss_ss: 0.897254, loss_d: 0.579487
0.8449 --- loss: 1.426841, loss_ss: 0.916421, loss_d: 0.510420
0.8833 --- loss: 1.104203, loss_ss: 0.830028, loss_d: 0.274175
0.9217 --- loss: 1.137068, loss_ss: 0.757333, loss_d: 0.379734
0.9601 --- loss: 1.231903, loss_ss: 0.904928, loss_d: 0.326975
0.9985 --- loss: 1.111727, loss_ss: 0.904149, loss_d: 0.207578
Epoch finished! Loss: 1.4574876744013565
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.438677, loss_ss: 0.850447, loss_d: 0.588230
0.0384 --- loss: 1.476013, loss_ss: 1.000288, loss_d: 0.475725
0.0768 --- loss: 1.407836, loss_ss: 0.996141, loss_d: 0.411695
0.1152 --- loss: 1.576126, loss_ss: 0.894823, loss_d: 0.681302
0.1536 --- loss: 1.844532, loss_ss: 0.800062, loss_d: 1.044470
0.1920 --- loss: 1.435296, loss_ss: 0.955626, loss_d: 0.479670
0.2304 --- loss: 1.023813, loss_ss: 0.792138, loss_d: 0.231675
0.2688 --- loss: 1.264006, loss_ss: 1.036800, loss_d: 0.227206
0.3072 --- loss: 1.228718, loss_ss: 0.782926, loss_d: 0.445792
0.3456 --- loss: 1.690331, loss_ss: 0.908270, loss_d: 0.782061
0.3840 --- loss: 1.015924, loss_ss: 0.777921, loss_d: 0.238003
0.4224 --- loss: 1.147604, loss_ss: 0.720462, loss_d: 0.427142
0.4608 --- loss: 1.339354, loss_ss: 0.987898, loss_d: 0.351456
0.4992 --- loss: 1.161821, loss_ss: 0.879867, loss_d: 0.281954
0.5376 --- loss: 1.500101, loss_ss: 1.038112, loss_d: 0.461989
0.5760 --- loss: 1.175784, loss_ss: 0.983590, loss_d: 0.192194
0.6144 --- loss: 1.380977, loss_ss: 1.152415, loss_d: 0.228563
0.6528 --- loss: 1.071195, loss_ss: 0.804814, loss_d: 0.266381
0.6912 --- loss: 1.749580, loss_ss: 0.910180, loss_d: 0.839400
0.7296 --- loss: 1.119084, loss_ss: 0.692535, loss_d: 0.426550
0.7680 --- loss: 1.348580, loss_ss: 0.975923, loss_d: 0.372657
0.8065 --- loss: 1.580194, loss_ss: 0.841984, loss_d: 0.738210
0.8449 --- loss: 1.437701, loss_ss: 1.102636, loss_d: 0.335065
0.8833 --- loss: 1.310538, loss_ss: 0.989780, loss_d: 0.320757
0.9217 --- loss: 1.256207, loss_ss: 0.823951, loss_d: 0.432256
0.9601 --- loss: 1.327743, loss_ss: 1.124136, loss_d: 0.203607
0.9985 --- loss: 1.808746, loss_ss: 1.009720, loss_d: 0.799026
Epoch finished! Loss: 1.3837897777557373
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.481731, loss_ss: 0.996899, loss_d: 0.484832
0.0384 --- loss: 1.361195, loss_ss: 0.913416, loss_d: 0.447779
0.0768 --- loss: 1.510682, loss_ss: 0.874667, loss_d: 0.636016
0.1152 --- loss: 1.000582, loss_ss: 0.633285, loss_d: 0.367297
0.1536 --- loss: 1.160709, loss_ss: 0.701069, loss_d: 0.459640
0.1920 --- loss: 1.677766, loss_ss: 1.053977, loss_d: 0.623788
0.2304 --- loss: 1.782566, loss_ss: 1.216472, loss_d: 0.566093
0.2688 --- loss: 1.187888, loss_ss: 0.788807, loss_d: 0.399081
0.3072 --- loss: 1.175451, loss_ss: 0.773532, loss_d: 0.401919
0.3456 --- loss: 1.293112, loss_ss: 0.984705, loss_d: 0.308406
0.3840 --- loss: 1.196220, loss_ss: 0.957794, loss_d: 0.238426
0.4224 --- loss: 1.495431, loss_ss: 0.855027, loss_d: 0.640404
0.4608 --- loss: 1.752341, loss_ss: 0.780145, loss_d: 0.972196
0.4992 --- loss: 1.769602, loss_ss: 1.523875, loss_d: 0.245726
0.5376 --- loss: 1.263246, loss_ss: 0.795747, loss_d: 0.467499
0.5760 --- loss: 1.167907, loss_ss: 0.937487, loss_d: 0.230420
0.6144 --- loss: 1.010442, loss_ss: 0.887165, loss_d: 0.123278
0.6528 --- loss: 1.625568, loss_ss: 0.961695, loss_d: 0.663873
0.6912 --- loss: 1.462353, loss_ss: 1.004201, loss_d: 0.458152
0.7296 --- loss: 1.263188, loss_ss: 0.923240, loss_d: 0.339948
0.7680 --- loss: 1.253322, loss_ss: 1.034019, loss_d: 0.219303
0.8065 --- loss: 1.284189, loss_ss: 1.020106, loss_d: 0.264083
0.8449 --- loss: 1.041964, loss_ss: 0.772072, loss_d: 0.269892
0.8833 --- loss: 1.101304, loss_ss: 0.803887, loss_d: 0.297417
0.9217 --- loss: 1.303407, loss_ss: 1.084111, loss_d: 0.219296
0.9601 --- loss: 1.580004, loss_ss: 0.762644, loss_d: 0.817361
0.9985 --- loss: 1.610022, loss_ss: 0.797164, loss_d: 0.812858
Epoch finished! Loss: 1.3177554038854746
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.431542, loss_ss: 1.084204, loss_d: 0.347338
0.0384 --- loss: 1.529531, loss_ss: 0.932041, loss_d: 0.597490
0.0768 --- loss: 1.554837, loss_ss: 1.157118, loss_d: 0.397719
0.1152 --- loss: 1.492423, loss_ss: 1.135612, loss_d: 0.356811
0.1536 --- loss: 1.016396, loss_ss: 0.781245, loss_d: 0.235150
0.1920 --- loss: 1.060393, loss_ss: 0.765523, loss_d: 0.294870
0.2304 --- loss: 1.466593, loss_ss: 0.963670, loss_d: 0.502923
0.2688 --- loss: 1.469183, loss_ss: 1.146122, loss_d: 0.323061
0.3072 --- loss: 1.255583, loss_ss: 1.029368, loss_d: 0.226215
0.3456 --- loss: 0.987218, loss_ss: 0.798778, loss_d: 0.188441
0.3840 --- loss: 1.320001, loss_ss: 0.947026, loss_d: 0.372975
0.4224 --- loss: 1.260833, loss_ss: 0.866271, loss_d: 0.394561
0.4608 --- loss: 1.279809, loss_ss: 0.726525, loss_d: 0.553284
0.4992 --- loss: 1.023412, loss_ss: 0.662112, loss_d: 0.361300
0.5376 --- loss: 0.740439, loss_ss: 0.569606, loss_d: 0.170833
0.5760 --- loss: 1.382464, loss_ss: 0.788383, loss_d: 0.594082
0.6144 --- loss: 0.969805, loss_ss: 0.644806, loss_d: 0.324999
0.6528 --- loss: 1.237063, loss_ss: 0.676582, loss_d: 0.560481
0.6912 --- loss: 1.460767, loss_ss: 0.974303, loss_d: 0.486463
0.7296 --- loss: 1.195652, loss_ss: 0.942228, loss_d: 0.253424
0.7680 --- loss: 1.655972, loss_ss: 0.914926, loss_d: 0.741046
0.8065 --- loss: 1.132622, loss_ss: 0.933332, loss_d: 0.199289
0.8449 --- loss: 1.307865, loss_ss: 0.982275, loss_d: 0.325590
0.8833 --- loss: 1.038783, loss_ss: 0.629925, loss_d: 0.408858
0.9217 --- loss: 1.604313, loss_ss: 1.124179, loss_d: 0.480134
0.9601 --- loss: 1.007988, loss_ss: 0.857927, loss_d: 0.150061
0.9985 --- loss: 0.993971, loss_ss: 0.859454, loss_d: 0.134516
Epoch finished! Loss: 1.2554657839811765
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.961489, loss_ss: 0.801160, loss_d: 1.160329
0.0384 --- loss: 1.432290, loss_ss: 1.068979, loss_d: 0.363311
0.0768 --- loss: 0.993877, loss_ss: 0.682271, loss_d: 0.311606
0.1152 --- loss: 1.074496, loss_ss: 0.977649, loss_d: 0.096847
0.1536 --- loss: 1.144339, loss_ss: 0.906133, loss_d: 0.238206
0.1920 --- loss: 1.198249, loss_ss: 1.037118, loss_d: 0.161131
0.2304 --- loss: 1.397557, loss_ss: 0.926354, loss_d: 0.471203
0.2688 --- loss: 0.899579, loss_ss: 0.740485, loss_d: 0.159094
0.3072 --- loss: 1.218095, loss_ss: 1.010480, loss_d: 0.207615
0.3456 --- loss: 1.117979, loss_ss: 0.883944, loss_d: 0.234035
0.3840 --- loss: 0.861323, loss_ss: 0.774800, loss_d: 0.086523
0.4224 --- loss: 1.446316, loss_ss: 0.801584, loss_d: 0.644732
0.4608 --- loss: 0.962178, loss_ss: 0.848608, loss_d: 0.113570
0.4992 --- loss: 1.002447, loss_ss: 0.783886, loss_d: 0.218561
0.5376 --- loss: 1.006598, loss_ss: 0.853470, loss_d: 0.153128
0.5760 --- loss: 1.409664, loss_ss: 1.067822, loss_d: 0.341843
0.6144 --- loss: 1.450973, loss_ss: 1.123735, loss_d: 0.327237
0.6528 --- loss: 1.310817, loss_ss: 1.022490, loss_d: 0.288328
0.6912 --- loss: 1.404310, loss_ss: 1.097444, loss_d: 0.306866
0.7296 --- loss: 1.367610, loss_ss: 0.981233, loss_d: 0.386377
0.7680 --- loss: 1.763295, loss_ss: 1.379858, loss_d: 0.383437
0.8065 --- loss: 1.344828, loss_ss: 0.786718, loss_d: 0.558109
0.8449 --- loss: 1.758065, loss_ss: 1.156757, loss_d: 0.601307
0.8833 --- loss: 1.265414, loss_ss: 0.938743, loss_d: 0.326671
0.9217 --- loss: 1.214527, loss_ss: 0.705973, loss_d: 0.508554
0.9601 --- loss: 0.897019, loss_ss: 0.789004, loss_d: 0.108015
0.9985 --- loss: 1.720798, loss_ss: 0.788111, loss_d: 0.932687
Epoch finished! Loss: 1.184694954752922
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.060554, loss_ss: 0.985799, loss_d: 0.074756
0.0384 --- loss: 1.753652, loss_ss: 0.998008, loss_d: 0.755644
0.0768 --- loss: 0.855701, loss_ss: 0.699730, loss_d: 0.155971
0.1152 --- loss: 1.234961, loss_ss: 0.866086, loss_d: 0.368875
0.1536 --- loss: 1.093172, loss_ss: 0.937680, loss_d: 0.155492
0.1920 --- loss: 1.440687, loss_ss: 0.860561, loss_d: 0.580125
0.2304 --- loss: 0.765889, loss_ss: 0.595635, loss_d: 0.170254
0.2688 --- loss: 0.836230, loss_ss: 0.659451, loss_d: 0.176779
0.3072 --- loss: 1.202014, loss_ss: 0.780351, loss_d: 0.421663
0.3456 --- loss: 1.807747, loss_ss: 1.361003, loss_d: 0.446743
0.3840 --- loss: 0.893412, loss_ss: 0.744654, loss_d: 0.148758
0.4224 --- loss: 1.181132, loss_ss: 1.057289, loss_d: 0.123843
0.4608 --- loss: 1.186398, loss_ss: 0.974380, loss_d: 0.212018
0.4992 --- loss: 1.264359, loss_ss: 0.971798, loss_d: 0.292561
0.5376 --- loss: 1.102059, loss_ss: 0.745930, loss_d: 0.356129
0.5760 --- loss: 1.099642, loss_ss: 0.900250, loss_d: 0.199392
0.6144 --- loss: 0.996575, loss_ss: 0.710887, loss_d: 0.285689
0.6528 --- loss: 1.311212, loss_ss: 0.978604, loss_d: 0.332608
0.6912 --- loss: 1.646332, loss_ss: 1.047290, loss_d: 0.599042
0.7296 --- loss: 1.889089, loss_ss: 0.701942, loss_d: 1.187147
0.7680 --- loss: 1.014686, loss_ss: 0.845465, loss_d: 0.169221
0.8065 --- loss: 1.538205, loss_ss: 0.997277, loss_d: 0.540929
0.8449 --- loss: 0.980299, loss_ss: 0.799046, loss_d: 0.181253
0.8833 --- loss: 0.758426, loss_ss: 0.687019, loss_d: 0.071407
0.9217 --- loss: 0.761070, loss_ss: 0.594090, loss_d: 0.166981
0.9601 --- loss: 1.059592, loss_ss: 0.824755, loss_d: 0.234838
0.9985 --- loss: 1.139500, loss_ss: 1.082862, loss_d: 0.056638
Epoch finished! Loss: 1.1476495513549219
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.670894, loss_ss: 0.683697, loss_d: 0.987197
0.0384 --- loss: 1.159278, loss_ss: 1.066973, loss_d: 0.092305
0.0768 --- loss: 1.346355, loss_ss: 0.921475, loss_d: 0.424880
0.1152 --- loss: 1.225112, loss_ss: 0.747785, loss_d: 0.477327
0.1536 --- loss: 1.155672, loss_ss: 1.032914, loss_d: 0.122758
0.1920 --- loss: 1.397216, loss_ss: 0.937677, loss_d: 0.459539
0.2304 --- loss: 0.924315, loss_ss: 0.788310, loss_d: 0.136005
0.2688 --- loss: 1.115202, loss_ss: 0.984723, loss_d: 0.130479
0.3072 --- loss: 0.972183, loss_ss: 0.558605, loss_d: 0.413578
0.3456 --- loss: 0.706543, loss_ss: 0.659222, loss_d: 0.047321
0.3840 --- loss: 1.180494, loss_ss: 0.733491, loss_d: 0.447004
0.4224 --- loss: 1.171849, loss_ss: 0.794812, loss_d: 0.377036
0.4608 --- loss: 0.926958, loss_ss: 0.778262, loss_d: 0.148696
0.4992 --- loss: 0.745169, loss_ss: 0.617562, loss_d: 0.127607
0.5376 --- loss: 1.053038, loss_ss: 0.665352, loss_d: 0.387686
0.5760 --- loss: 0.847908, loss_ss: 0.621897, loss_d: 0.226011
0.6144 --- loss: 1.132075, loss_ss: 0.744928, loss_d: 0.387147
0.6528 --- loss: 1.012068, loss_ss: 0.661276, loss_d: 0.350792
0.6912 --- loss: 1.411929, loss_ss: 1.122850, loss_d: 0.289080
0.7296 --- loss: 1.040124, loss_ss: 0.783018, loss_d: 0.257106
0.7680 --- loss: 2.001105, loss_ss: 0.871124, loss_d: 1.129981
0.8065 --- loss: 1.294235, loss_ss: 0.914290, loss_d: 0.379945
0.8449 --- loss: 1.238831, loss_ss: 0.870954, loss_d: 0.367877
0.8833 --- loss: 1.002452, loss_ss: 0.751802, loss_d: 0.250650
0.9217 --- loss: 1.363708, loss_ss: 1.205183, loss_d: 0.158525
0.9601 --- loss: 1.582069, loss_ss: 0.889469, loss_d: 0.692599
0.9985 --- loss: 0.808129, loss_ss: 0.648468, loss_d: 0.159661
Epoch finished! Loss: 1.1436143109431633
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6323529411764706
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00        17
        1.0       0.00      0.00      0.00        62
        2.0       0.76      0.41      0.53       372
        3.0       0.91      0.79      0.84       337
        4.0       0.48      0.98      0.64       232

avg / total       0.69      0.63      0.62      1020
 


====== chp034-nsrr ======

The f1-score of  0  has ZeroDivisionError.


The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.41   0.00   96.01   0.00      0.00
1  92.65   0.00   98.64   0.00      0.00
2  73.73  40.59   92.75  76.26     52.98
3  90.39  79.23   95.90  90.51     84.49
4  75.29  97.84   68.65  47.89     64.31
Total accuracy: 63.24%
Average sen: 43.53%
Average spec: 90.39%
Macro f1-score: 40.36%
[0.98236519 0.97233689 0.97742403 0.96526474 0.98020142 0.71333724
 0.98178458 0.98107326 0.97888499 0.9816519  0.99613756 0.95948559
 0.71547091 0.58117878 0.98590034 0.96601325 0.95035827 0.97095829
 0.99037725 0.97235233 0.95217746 0.9617604  0.93825722 0.97308594
 0.97439665 0.98596001 0.97621548 0.8286112  0.9501586  0.96510082
 0.99005413 0.97892821 0.89246434 0.94352615]
pred: 0.9386251007809359, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.253513, loss_ss: 1.603809, loss_d: 0.649703
0.0385 --- loss: 2.322426, loss_ss: 1.636875, loss_d: 0.685551
0.0770 --- loss: 1.978522, loss_ss: 1.430702, loss_d: 0.547820
0.1156 --- loss: 1.943877, loss_ss: 1.535800, loss_d: 0.408077
0.1541 --- loss: 2.460694, loss_ss: 1.363948, loss_d: 1.096746
0.1926 --- loss: 2.090324, loss_ss: 1.343712, loss_d: 0.746612
0.2311 --- loss: 1.887292, loss_ss: 1.319583, loss_d: 0.567709
0.2696 --- loss: 1.930136, loss_ss: 1.271020, loss_d: 0.659116
0.3082 --- loss: 2.080995, loss_ss: 1.550367, loss_d: 0.530629
0.3467 --- loss: 1.915872, loss_ss: 1.275455, loss_d: 0.640417
0.3852 --- loss: 1.871120, loss_ss: 1.308318, loss_d: 0.562802
0.4237 --- loss: 1.848593, loss_ss: 1.311132, loss_d: 0.537461
0.4622 --- loss: 1.725192, loss_ss: 1.220015, loss_d: 0.505177
0.5008 --- loss: 2.111152, loss_ss: 1.112297, loss_d: 0.998855
0.5393 --- loss: 1.632644, loss_ss: 1.100155, loss_d: 0.532489
0.5778 --- loss: 1.720986, loss_ss: 1.271867, loss_d: 0.449119
0.6163 --- loss: 1.730244, loss_ss: 1.221862, loss_d: 0.508382
0.6549 --- loss: 1.808758, loss_ss: 1.205581, loss_d: 0.603177
0.6934 --- loss: 1.487416, loss_ss: 1.002552, loss_d: 0.484864
0.7319 --- loss: 1.951729, loss_ss: 1.221404, loss_d: 0.730325
0.7704 --- loss: 1.793363, loss_ss: 1.016037, loss_d: 0.777326
0.8089 --- loss: 1.773879, loss_ss: 1.233710, loss_d: 0.540169
0.8475 --- loss: 2.433821, loss_ss: 1.625919, loss_d: 0.807902
0.8860 --- loss: 1.994011, loss_ss: 1.475613, loss_d: 0.518397
0.9245 --- loss: 1.985168, loss_ss: 1.375741, loss_d: 0.609427
0.9630 --- loss: 1.688600, loss_ss: 0.960571, loss_d: 0.728029
Epoch finished! Loss: 1.8895655792192143
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.749783, loss_ss: 1.262396, loss_d: 0.487387
0.0385 --- loss: 2.023200, loss_ss: 1.347608, loss_d: 0.675591
0.0770 --- loss: 1.468697, loss_ss: 1.056548, loss_d: 0.412150
0.1156 --- loss: 1.447461, loss_ss: 1.075842, loss_d: 0.371619
0.1541 --- loss: 1.624416, loss_ss: 1.024492, loss_d: 0.599924
0.1926 --- loss: 1.384139, loss_ss: 1.063279, loss_d: 0.320860
0.2311 --- loss: 1.723289, loss_ss: 1.127424, loss_d: 0.595865
0.2696 --- loss: 1.749512, loss_ss: 1.132582, loss_d: 0.616930
0.3082 --- loss: 1.482024, loss_ss: 0.943749, loss_d: 0.538275
0.3467 --- loss: 1.530157, loss_ss: 0.964486, loss_d: 0.565671
0.3852 --- loss: 1.637676, loss_ss: 1.108082, loss_d: 0.529594
0.4237 --- loss: 1.570781, loss_ss: 0.987042, loss_d: 0.583739
0.4622 --- loss: 1.531188, loss_ss: 0.887689, loss_d: 0.643499
0.5008 --- loss: 1.519220, loss_ss: 1.082186, loss_d: 0.437034
0.5393 --- loss: 1.676623, loss_ss: 1.158984, loss_d: 0.517639
0.5778 --- loss: 1.671508, loss_ss: 1.003229, loss_d: 0.668278
0.6163 --- loss: 1.812288, loss_ss: 0.958262, loss_d: 0.854026
0.6549 --- loss: 1.447761, loss_ss: 1.036710, loss_d: 0.411051
0.6934 --- loss: 1.565855, loss_ss: 1.003937, loss_d: 0.561918
0.7319 --- loss: 1.649099, loss_ss: 1.128180, loss_d: 0.520919
0.7704 --- loss: 1.401896, loss_ss: 0.974867, loss_d: 0.427029
0.8089 --- loss: 1.470571, loss_ss: 0.967306, loss_d: 0.503264
0.8475 --- loss: 1.591869, loss_ss: 0.881682, loss_d: 0.710187
0.8860 --- loss: 1.720563, loss_ss: 0.784566, loss_d: 0.935997
0.9245 --- loss: 1.990248, loss_ss: 1.096230, loss_d: 0.894018
0.9630 --- loss: 1.705446, loss_ss: 1.033247, loss_d: 0.672198
Epoch finished! Loss: 1.6561773265190567
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.268982, loss_ss: 0.839007, loss_d: 0.429975
0.0385 --- loss: 1.652589, loss_ss: 1.147895, loss_d: 0.504695
0.0770 --- loss: 1.357697, loss_ss: 1.064916, loss_d: 0.292781
0.1156 --- loss: 1.486902, loss_ss: 0.815851, loss_d: 0.671051
0.1541 --- loss: 1.597391, loss_ss: 1.091687, loss_d: 0.505705
0.1926 --- loss: 1.510045, loss_ss: 0.944379, loss_d: 0.565666
0.2311 --- loss: 1.757128, loss_ss: 1.054790, loss_d: 0.702338
0.2696 --- loss: 1.631441, loss_ss: 1.117050, loss_d: 0.514391
0.3082 --- loss: 1.560453, loss_ss: 1.042898, loss_d: 0.517554
0.3467 --- loss: 1.736760, loss_ss: 1.386528, loss_d: 0.350231
0.3852 --- loss: 1.677809, loss_ss: 1.006286, loss_d: 0.671523
0.4237 --- loss: 1.490723, loss_ss: 1.031258, loss_d: 0.459465
0.4622 --- loss: 1.568631, loss_ss: 0.907360, loss_d: 0.661271
0.5008 --- loss: 1.652889, loss_ss: 1.202091, loss_d: 0.450798
0.5393 --- loss: 1.532458, loss_ss: 1.074352, loss_d: 0.458105
0.5778 --- loss: 1.636373, loss_ss: 1.285707, loss_d: 0.350666
0.6163 --- loss: 1.771023, loss_ss: 1.119603, loss_d: 0.651420
0.6549 --- loss: 1.561120, loss_ss: 0.898560, loss_d: 0.662560
0.6934 --- loss: 1.572222, loss_ss: 0.849687, loss_d: 0.722536
0.7319 --- loss: 1.485162, loss_ss: 0.689926, loss_d: 0.795235
0.7704 --- loss: 1.354088, loss_ss: 0.736395, loss_d: 0.617694
0.8089 --- loss: 1.466719, loss_ss: 1.065794, loss_d: 0.400925
0.8475 --- loss: 1.266714, loss_ss: 0.884517, loss_d: 0.382197
0.8860 --- loss: 1.755622, loss_ss: 0.908764, loss_d: 0.846857
0.9245 --- loss: 1.816639, loss_ss: 1.302230, loss_d: 0.514409
0.9630 --- loss: 1.191207, loss_ss: 0.764168, loss_d: 0.427039
Epoch finished! Loss: 1.593337174087878
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.712283, loss_ss: 0.947706, loss_d: 0.764577
0.0385 --- loss: 1.524079, loss_ss: 1.010894, loss_d: 0.513185
0.0770 --- loss: 1.474824, loss_ss: 0.753897, loss_d: 0.720927
0.1156 --- loss: 1.336545, loss_ss: 0.908206, loss_d: 0.428339
0.1541 --- loss: 1.496824, loss_ss: 1.031638, loss_d: 0.465187
0.1926 --- loss: 1.615349, loss_ss: 1.150035, loss_d: 0.465314
0.2311 --- loss: 1.664965, loss_ss: 1.090532, loss_d: 0.574433
0.2696 --- loss: 1.576180, loss_ss: 0.818418, loss_d: 0.757762
0.3082 --- loss: 1.602121, loss_ss: 1.091678, loss_d: 0.510443
0.3467 --- loss: 1.591754, loss_ss: 0.925967, loss_d: 0.665788
0.3852 --- loss: 1.514882, loss_ss: 1.046847, loss_d: 0.468035
0.4237 --- loss: 1.592316, loss_ss: 1.095950, loss_d: 0.496365
0.4622 --- loss: 2.158267, loss_ss: 1.279860, loss_d: 0.878406
0.5008 --- loss: 1.385940, loss_ss: 0.954809, loss_d: 0.431131
0.5393 --- loss: 1.610741, loss_ss: 1.009613, loss_d: 0.601128
0.5778 --- loss: 1.368226, loss_ss: 0.939438, loss_d: 0.428788
0.6163 --- loss: 1.658250, loss_ss: 0.939547, loss_d: 0.718704
0.6549 --- loss: 1.665204, loss_ss: 0.991728, loss_d: 0.673476
0.6934 --- loss: 1.543885, loss_ss: 1.047236, loss_d: 0.496648
0.7319 --- loss: 1.456767, loss_ss: 1.124497, loss_d: 0.332270
0.7704 --- loss: 1.614938, loss_ss: 0.800931, loss_d: 0.814007
0.8089 --- loss: 1.165276, loss_ss: 0.764031, loss_d: 0.401245
0.8475 --- loss: 1.850433, loss_ss: 1.411665, loss_d: 0.438769
0.8860 --- loss: 1.207577, loss_ss: 0.889840, loss_d: 0.317737
0.9245 --- loss: 1.628706, loss_ss: 0.909900, loss_d: 0.718806
0.9630 --- loss: 1.712542, loss_ss: 1.089771, loss_d: 0.622770
Epoch finished! Loss: 1.5386629624716563
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.726998, loss_ss: 1.155368, loss_d: 0.571629
0.0385 --- loss: 1.731531, loss_ss: 1.012705, loss_d: 0.718826
0.0770 --- loss: 1.687249, loss_ss: 0.945958, loss_d: 0.741291
0.1156 --- loss: 1.526666, loss_ss: 0.837231, loss_d: 0.689435
0.1541 --- loss: 1.565369, loss_ss: 1.075291, loss_d: 0.490078
0.1926 --- loss: 1.450927, loss_ss: 0.875085, loss_d: 0.575843
0.2311 --- loss: 1.508108, loss_ss: 0.769812, loss_d: 0.738297
0.2696 --- loss: 1.286477, loss_ss: 0.947967, loss_d: 0.338511
0.3082 --- loss: 1.220223, loss_ss: 0.887584, loss_d: 0.332639
0.3467 --- loss: 1.228301, loss_ss: 0.845846, loss_d: 0.382455
0.3852 --- loss: 1.533120, loss_ss: 0.766972, loss_d: 0.766148
0.4237 --- loss: 1.369066, loss_ss: 1.098180, loss_d: 0.270885
0.4622 --- loss: 1.331368, loss_ss: 0.803507, loss_d: 0.527861
0.5008 --- loss: 1.305273, loss_ss: 1.010492, loss_d: 0.294781
0.5393 --- loss: 1.716252, loss_ss: 0.810979, loss_d: 0.905272
0.5778 --- loss: 1.347242, loss_ss: 0.986694, loss_d: 0.360549
0.6163 --- loss: 1.543388, loss_ss: 1.084041, loss_d: 0.459348
0.6549 --- loss: 1.116127, loss_ss: 0.740287, loss_d: 0.375841
0.6934 --- loss: 1.567131, loss_ss: 0.743788, loss_d: 0.823343
0.7319 --- loss: 1.802310, loss_ss: 1.295742, loss_d: 0.506568
0.7704 --- loss: 1.471946, loss_ss: 0.964921, loss_d: 0.507025
0.8089 --- loss: 1.532856, loss_ss: 1.083543, loss_d: 0.449313
0.8475 --- loss: 1.299094, loss_ss: 1.129994, loss_d: 0.169100
0.8860 --- loss: 1.544689, loss_ss: 1.239988, loss_d: 0.304701
0.9245 --- loss: 1.421636, loss_ss: 0.943250, loss_d: 0.478386
0.9630 --- loss: 1.382942, loss_ss: 1.022116, loss_d: 0.360827
Epoch finished! Loss: 1.4477618955737375
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.565521, loss_ss: 1.187899, loss_d: 0.377622
0.0385 --- loss: 1.250638, loss_ss: 0.906800, loss_d: 0.343838
0.0770 --- loss: 1.592237, loss_ss: 0.769292, loss_d: 0.822945
0.1156 --- loss: 1.608650, loss_ss: 1.231756, loss_d: 0.376894
0.1541 --- loss: 1.151218, loss_ss: 0.768365, loss_d: 0.382854
0.1926 --- loss: 1.060789, loss_ss: 0.781246, loss_d: 0.279543
0.2311 --- loss: 1.107532, loss_ss: 0.840406, loss_d: 0.267126
0.2696 --- loss: 0.980142, loss_ss: 0.672544, loss_d: 0.307598
0.3082 --- loss: 1.688742, loss_ss: 1.153366, loss_d: 0.535376
0.3467 --- loss: 1.214500, loss_ss: 0.848671, loss_d: 0.365829
0.3852 --- loss: 1.133764, loss_ss: 0.838209, loss_d: 0.295556
0.4237 --- loss: 1.127305, loss_ss: 0.904538, loss_d: 0.222767
0.4622 --- loss: 1.020230, loss_ss: 0.841705, loss_d: 0.178525
0.5008 --- loss: 1.692942, loss_ss: 0.932620, loss_d: 0.760322
0.5393 --- loss: 1.253221, loss_ss: 0.807101, loss_d: 0.446120
0.5778 --- loss: 1.283614, loss_ss: 0.967937, loss_d: 0.315677
0.6163 --- loss: 1.442937, loss_ss: 1.150915, loss_d: 0.292022
0.6549 --- loss: 1.387219, loss_ss: 0.704661, loss_d: 0.682559
0.6934 --- loss: 1.122670, loss_ss: 0.804680, loss_d: 0.317990
0.7319 --- loss: 1.510035, loss_ss: 1.115485, loss_d: 0.394550
0.7704 --- loss: 1.217028, loss_ss: 0.793917, loss_d: 0.423111
0.8089 --- loss: 1.393153, loss_ss: 0.846043, loss_d: 0.547110
0.8475 --- loss: 1.095407, loss_ss: 0.861743, loss_d: 0.233664
0.8860 --- loss: 2.129181, loss_ss: 0.764860, loss_d: 1.364321
0.9245 --- loss: 1.254499, loss_ss: 0.825516, loss_d: 0.428983
0.9630 --- loss: 1.394787, loss_ss: 0.888209, loss_d: 0.506578
Epoch finished! Loss: 1.3590451366192586
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.592777, loss_ss: 1.007407, loss_d: 0.585371
0.0385 --- loss: 1.232495, loss_ss: 0.835163, loss_d: 0.397332
0.0770 --- loss: 1.138598, loss_ss: 0.584440, loss_d: 0.554158
0.1156 --- loss: 1.199114, loss_ss: 0.929176, loss_d: 0.269938
0.1541 --- loss: 1.489946, loss_ss: 1.033049, loss_d: 0.456898
0.1926 --- loss: 1.541657, loss_ss: 0.825433, loss_d: 0.716223
0.2311 --- loss: 1.128711, loss_ss: 0.796949, loss_d: 0.331763
0.2696 --- loss: 1.916640, loss_ss: 1.482635, loss_d: 0.434005
0.3082 --- loss: 1.326752, loss_ss: 0.639704, loss_d: 0.687048
0.3467 --- loss: 1.325754, loss_ss: 1.023373, loss_d: 0.302381
0.3852 --- loss: 0.983603, loss_ss: 0.673072, loss_d: 0.310531
0.4237 --- loss: 1.347687, loss_ss: 0.753665, loss_d: 0.594022
0.4622 --- loss: 1.427359, loss_ss: 0.695469, loss_d: 0.731889
0.5008 --- loss: 1.552799, loss_ss: 1.322192, loss_d: 0.230607
0.5393 --- loss: 2.061689, loss_ss: 0.925476, loss_d: 1.136213
0.5778 --- loss: 1.223329, loss_ss: 0.929079, loss_d: 0.294250
0.6163 --- loss: 1.356328, loss_ss: 1.045980, loss_d: 0.310348
0.6549 --- loss: 1.299202, loss_ss: 0.847369, loss_d: 0.451832
0.6934 --- loss: 1.130196, loss_ss: 0.813363, loss_d: 0.316833
0.7319 --- loss: 1.242074, loss_ss: 0.916899, loss_d: 0.325174
0.7704 --- loss: 0.958539, loss_ss: 0.730372, loss_d: 0.228167
0.8089 --- loss: 1.213974, loss_ss: 0.956628, loss_d: 0.257346
0.8475 --- loss: 1.433714, loss_ss: 0.918298, loss_d: 0.515416
0.8860 --- loss: 1.098670, loss_ss: 0.792763, loss_d: 0.305907
0.9245 --- loss: 1.337737, loss_ss: 1.168088, loss_d: 0.169649
0.9630 --- loss: 0.984720, loss_ss: 0.829382, loss_d: 0.155338
Epoch finished! Loss: 1.2670842846388062
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.858579, loss_ss: 0.779961, loss_d: 0.078618
0.0385 --- loss: 1.319520, loss_ss: 1.155133, loss_d: 0.164387
0.0770 --- loss: 1.221313, loss_ss: 0.823085, loss_d: 0.398228
0.1156 --- loss: 1.071417, loss_ss: 0.913135, loss_d: 0.158282
0.1541 --- loss: 0.923706, loss_ss: 0.757362, loss_d: 0.166345
0.1926 --- loss: 1.278565, loss_ss: 0.978620, loss_d: 0.299944
0.2311 --- loss: 1.143273, loss_ss: 0.988306, loss_d: 0.154967
0.2696 --- loss: 1.091116, loss_ss: 0.803564, loss_d: 0.287551
0.3082 --- loss: 2.101610, loss_ss: 0.903861, loss_d: 1.197749
0.3467 --- loss: 1.047133, loss_ss: 0.629730, loss_d: 0.417404
0.3852 --- loss: 1.102021, loss_ss: 0.818806, loss_d: 0.283216
0.4237 --- loss: 1.297795, loss_ss: 1.009671, loss_d: 0.288124
0.4622 --- loss: 1.135455, loss_ss: 0.697059, loss_d: 0.438397
0.5008 --- loss: 1.121249, loss_ss: 0.864767, loss_d: 0.256482
0.5393 --- loss: 1.184028, loss_ss: 1.043430, loss_d: 0.140599
0.5778 --- loss: 1.171001, loss_ss: 0.890279, loss_d: 0.280722
0.6163 --- loss: 1.062426, loss_ss: 0.900342, loss_d: 0.162085
0.6549 --- loss: 1.475800, loss_ss: 0.889363, loss_d: 0.586436
0.6934 --- loss: 1.096767, loss_ss: 0.850014, loss_d: 0.246754
0.7319 --- loss: 1.080688, loss_ss: 0.768223, loss_d: 0.312466
0.7704 --- loss: 1.489036, loss_ss: 0.678825, loss_d: 0.810211
0.8089 --- loss: 1.061407, loss_ss: 0.675145, loss_d: 0.386262
0.8475 --- loss: 1.011036, loss_ss: 0.654065, loss_d: 0.356971
0.8860 --- loss: 1.056113, loss_ss: 0.598285, loss_d: 0.457828
0.9245 --- loss: 1.358407, loss_ss: 0.939474, loss_d: 0.418933
0.9630 --- loss: 1.519115, loss_ss: 0.983539, loss_d: 0.535576
Epoch finished! Loss: 1.2095573293656456
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.819582, loss_ss: 0.634248, loss_d: 0.185333
0.0385 --- loss: 1.223355, loss_ss: 0.973606, loss_d: 0.249749
0.0770 --- loss: 1.144421, loss_ss: 0.696223, loss_d: 0.448197
0.1156 --- loss: 0.960740, loss_ss: 0.825368, loss_d: 0.135373
0.1541 --- loss: 0.965487, loss_ss: 0.722714, loss_d: 0.242772
0.1926 --- loss: 1.272892, loss_ss: 1.059807, loss_d: 0.213085
0.2311 --- loss: 1.313101, loss_ss: 0.882496, loss_d: 0.430605
0.2696 --- loss: 1.036564, loss_ss: 0.709632, loss_d: 0.326932
0.3082 --- loss: 0.958181, loss_ss: 0.690818, loss_d: 0.267363
0.3467 --- loss: 1.615206, loss_ss: 0.770125, loss_d: 0.845080
0.3852 --- loss: 1.445453, loss_ss: 0.721156, loss_d: 0.724296
0.4237 --- loss: 1.571298, loss_ss: 1.374189, loss_d: 0.197109
0.4622 --- loss: 1.040513, loss_ss: 0.730912, loss_d: 0.309601
0.5008 --- loss: 1.310776, loss_ss: 1.020275, loss_d: 0.290500
0.5393 --- loss: 1.904929, loss_ss: 1.088473, loss_d: 0.816456
0.5778 --- loss: 1.016460, loss_ss: 0.746110, loss_d: 0.270350
0.6163 --- loss: 0.904957, loss_ss: 0.764545, loss_d: 0.140412
0.6549 --- loss: 1.114259, loss_ss: 1.032916, loss_d: 0.081343
0.6934 --- loss: 1.887346, loss_ss: 0.831839, loss_d: 1.055507
0.7319 --- loss: 1.111250, loss_ss: 0.789786, loss_d: 0.321464
0.7704 --- loss: 1.287730, loss_ss: 0.795253, loss_d: 0.492477
0.8089 --- loss: 1.184896, loss_ss: 0.907726, loss_d: 0.277170
0.8475 --- loss: 1.026229, loss_ss: 0.857237, loss_d: 0.168992
0.8860 --- loss: 0.906189, loss_ss: 0.593894, loss_d: 0.312295
0.9245 --- loss: 1.317983, loss_ss: 1.026593, loss_d: 0.291390
0.9630 --- loss: 0.872013, loss_ss: 0.509977, loss_d: 0.362036
Epoch finished! Loss: 1.1864406958970324
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.047806, loss_ss: 0.920585, loss_d: 0.127221
0.0385 --- loss: 1.295168, loss_ss: 0.752373, loss_d: 0.542794
0.0770 --- loss: 1.203241, loss_ss: 0.949687, loss_d: 0.253554
0.1156 --- loss: 0.908857, loss_ss: 0.561089, loss_d: 0.347769
0.1541 --- loss: 1.035000, loss_ss: 0.822546, loss_d: 0.212454
0.1926 --- loss: 1.388501, loss_ss: 1.027198, loss_d: 0.361303
0.2311 --- loss: 0.848714, loss_ss: 0.667707, loss_d: 0.181007
0.2696 --- loss: 1.512699, loss_ss: 0.876104, loss_d: 0.636595
0.3082 --- loss: 1.347161, loss_ss: 0.991689, loss_d: 0.355472
0.3467 --- loss: 1.026463, loss_ss: 0.905500, loss_d: 0.120963
0.3852 --- loss: 1.347925, loss_ss: 1.199117, loss_d: 0.148809
0.4237 --- loss: 0.802787, loss_ss: 0.703861, loss_d: 0.098926
0.4622 --- loss: 1.052107, loss_ss: 0.893786, loss_d: 0.158322
0.5008 --- loss: 1.059403, loss_ss: 0.891997, loss_d: 0.167406
0.5393 --- loss: 0.777724, loss_ss: 0.672426, loss_d: 0.105298
0.5778 --- loss: 1.105038, loss_ss: 0.739699, loss_d: 0.365339
0.6163 --- loss: 1.731701, loss_ss: 0.926472, loss_d: 0.805230
0.6549 --- loss: 1.100934, loss_ss: 0.904166, loss_d: 0.196768
0.6934 --- loss: 1.043645, loss_ss: 0.705186, loss_d: 0.338460
0.7319 --- loss: 0.994599, loss_ss: 0.899201, loss_d: 0.095398
0.7704 --- loss: 1.021495, loss_ss: 0.563151, loss_d: 0.458344
0.8089 --- loss: 1.086069, loss_ss: 0.870401, loss_d: 0.215668
0.8475 --- loss: 1.350032, loss_ss: 1.185069, loss_d: 0.164963
0.8860 --- loss: 1.366937, loss_ss: 0.871551, loss_d: 0.495387
0.9245 --- loss: 1.137013, loss_ss: 0.748530, loss_d: 0.388483
0.9630 --- loss: 1.208593, loss_ss: 1.087899, loss_d: 0.120694
Epoch finished! Loss: 1.1643206767133765
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7158730158730159
             precision    recall  f1-score   support

        0.0       0.61      0.78      0.69       237
        1.0       0.58      0.25      0.34       167
        2.0       0.87      0.75      0.81       563
        3.0       0.11      0.88      0.19         8
        4.0       0.74      0.85      0.79       285

avg / total       0.75      0.72      0.72      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.59  78.48   88.47  61.18     68.76
1  87.62  24.55   97.26  57.75     34.45
2  83.81  75.49   90.53  86.56     80.65
3  95.24  87.50   95.29  10.61     18.92
4  89.92  85.26   91.28  74.09     79.28
Total accuracy: 71.59%
Average sen: 70.26%
Average spec: 92.56%
Macro f1-score: 56.41%
[0.87197495 0.9942053  0.99593484 0.99636358 0.99007553 0.97668469
 0.98495525 0.97892511 0.97952372 0.96580982 0.9763841  0.97958988
 0.95020109 0.97614098 0.97180396 0.92683381 0.97529107 0.97821176
 0.9885146  0.98565722 0.99931061 0.99789774 0.99837756 0.99101865
 0.99270004 0.98960996 0.97115862 0.95240879 0.9377287  0.9993999
 0.95892227 0.9996137  0.9970361  0.9995259  0.98876768 0.97727865
 0.99999726 0.95418906 0.92330933 0.99983299 0.90539104 0.97980738]
pred: 0.97515150478908, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.269150, loss_ss: 1.596707, loss_d: 0.672443
0.0384 --- loss: 2.042445, loss_ss: 1.456293, loss_d: 0.586152
0.0768 --- loss: 2.024695, loss_ss: 1.398827, loss_d: 0.625867
0.1152 --- loss: 2.139333, loss_ss: 1.359823, loss_d: 0.779509
0.1536 --- loss: 2.126058, loss_ss: 1.361373, loss_d: 0.764686
0.1920 --- loss: 2.009199, loss_ss: 1.320430, loss_d: 0.688769
0.2304 --- loss: 1.922249, loss_ss: 1.266891, loss_d: 0.655358
0.2688 --- loss: 1.864224, loss_ss: 1.302085, loss_d: 0.562140
0.3072 --- loss: 1.815167, loss_ss: 1.266318, loss_d: 0.548849
0.3456 --- loss: 1.559894, loss_ss: 1.240614, loss_d: 0.319280
0.3840 --- loss: 1.926509, loss_ss: 1.362049, loss_d: 0.564460
0.4224 --- loss: 1.811175, loss_ss: 1.182996, loss_d: 0.628179
0.4608 --- loss: 1.949824, loss_ss: 1.250911, loss_d: 0.698913
0.4992 --- loss: 1.531021, loss_ss: 1.139135, loss_d: 0.391885
0.5376 --- loss: 1.899589, loss_ss: 1.395795, loss_d: 0.503794
0.5760 --- loss: 1.609414, loss_ss: 1.098162, loss_d: 0.511252
0.6144 --- loss: 1.715165, loss_ss: 1.105279, loss_d: 0.609886
0.6528 --- loss: 2.016585, loss_ss: 1.207862, loss_d: 0.808724
0.6912 --- loss: 1.563234, loss_ss: 1.030733, loss_d: 0.532502
0.7296 --- loss: 1.775225, loss_ss: 1.152962, loss_d: 0.622263
0.7680 --- loss: 2.096238, loss_ss: 1.416342, loss_d: 0.679896
0.8065 --- loss: 1.539654, loss_ss: 1.157967, loss_d: 0.381687
0.8449 --- loss: 1.642416, loss_ss: 1.227398, loss_d: 0.415018
0.8833 --- loss: 1.544307, loss_ss: 1.034291, loss_d: 0.510017
0.9217 --- loss: 1.623857, loss_ss: 1.231551, loss_d: 0.392306
0.9601 --- loss: 1.710477, loss_ss: 1.310514, loss_d: 0.399963
0.9985 --- loss: 1.761243, loss_ss: 1.514761, loss_d: 0.246482
Epoch finished! Loss: 1.8854430579222166
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.717728, loss_ss: 1.009287, loss_d: 0.708441
0.0384 --- loss: 1.938850, loss_ss: 1.211747, loss_d: 0.727104
0.0768 --- loss: 1.477116, loss_ss: 1.145700, loss_d: 0.331416
0.1152 --- loss: 1.379242, loss_ss: 1.048745, loss_d: 0.330497
0.1536 --- loss: 1.672356, loss_ss: 1.258765, loss_d: 0.413591
0.1920 --- loss: 1.508436, loss_ss: 1.051321, loss_d: 0.457115
0.2304 --- loss: 1.412496, loss_ss: 0.858752, loss_d: 0.553744
0.2688 --- loss: 1.551302, loss_ss: 0.878940, loss_d: 0.672361
0.3072 --- loss: 1.803862, loss_ss: 1.066228, loss_d: 0.737634
0.3456 --- loss: 1.458708, loss_ss: 0.909070, loss_d: 0.549638
0.3840 --- loss: 1.691266, loss_ss: 1.213410, loss_d: 0.477856
0.4224 --- loss: 1.598167, loss_ss: 0.978804, loss_d: 0.619363
0.4608 --- loss: 1.644384, loss_ss: 0.919898, loss_d: 0.724486
0.4992 --- loss: 1.804430, loss_ss: 0.952236, loss_d: 0.852194
0.5376 --- loss: 2.391488, loss_ss: 1.450975, loss_d: 0.940512
0.5760 --- loss: 1.636166, loss_ss: 1.037958, loss_d: 0.598208
0.6144 --- loss: 1.511135, loss_ss: 0.895302, loss_d: 0.615833
0.6528 --- loss: 1.767299, loss_ss: 1.502168, loss_d: 0.265130
0.6912 --- loss: 1.533378, loss_ss: 0.932286, loss_d: 0.601092
0.7296 --- loss: 1.757785, loss_ss: 1.191246, loss_d: 0.566539
0.7680 --- loss: 1.624055, loss_ss: 1.065693, loss_d: 0.558361
0.8065 --- loss: 1.976880, loss_ss: 1.418824, loss_d: 0.558055
0.8449 --- loss: 1.770782, loss_ss: 1.100495, loss_d: 0.670287
0.8833 --- loss: 1.671213, loss_ss: 1.033127, loss_d: 0.638086
0.9217 --- loss: 1.588222, loss_ss: 1.043321, loss_d: 0.544901
0.9601 --- loss: 1.825053, loss_ss: 1.314639, loss_d: 0.510414
0.9985 --- loss: 1.671607, loss_ss: 0.923452, loss_d: 0.748156
Epoch finished! Loss: 1.6729506423840157
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.682585, loss_ss: 0.949125, loss_d: 0.733460
0.0384 --- loss: 1.578788, loss_ss: 0.918218, loss_d: 0.660570
0.0768 --- loss: 1.826644, loss_ss: 1.117994, loss_d: 0.708650
0.1152 --- loss: 1.758953, loss_ss: 1.143296, loss_d: 0.615658
0.1536 --- loss: 1.779525, loss_ss: 0.848624, loss_d: 0.930901
0.1920 --- loss: 1.803720, loss_ss: 1.003091, loss_d: 0.800629
0.2304 --- loss: 1.355920, loss_ss: 0.889022, loss_d: 0.466899
0.2688 --- loss: 1.404341, loss_ss: 1.070892, loss_d: 0.333449
0.3072 --- loss: 1.469212, loss_ss: 0.817524, loss_d: 0.651688
0.3456 --- loss: 1.737197, loss_ss: 1.177893, loss_d: 0.559304
0.3840 --- loss: 1.503141, loss_ss: 0.796150, loss_d: 0.706991
0.4224 --- loss: 1.686667, loss_ss: 0.975924, loss_d: 0.710744
0.4608 --- loss: 1.373838, loss_ss: 0.779606, loss_d: 0.594232
0.4992 --- loss: 1.477708, loss_ss: 0.959212, loss_d: 0.518496
0.5376 --- loss: 1.532534, loss_ss: 1.040481, loss_d: 0.492052
0.5760 --- loss: 1.428607, loss_ss: 0.876153, loss_d: 0.552454
0.6144 --- loss: 1.350258, loss_ss: 0.919609, loss_d: 0.430649
0.6528 --- loss: 1.406960, loss_ss: 0.914641, loss_d: 0.492319
0.6912 --- loss: 1.499902, loss_ss: 0.953876, loss_d: 0.546027
0.7296 --- loss: 1.236523, loss_ss: 0.836523, loss_d: 0.400000
0.7680 --- loss: 1.474807, loss_ss: 0.784718, loss_d: 0.690089
0.8065 --- loss: 1.494292, loss_ss: 1.037487, loss_d: 0.456805
0.8449 --- loss: 1.305133, loss_ss: 0.767304, loss_d: 0.537829
0.8833 --- loss: 1.479472, loss_ss: 0.876882, loss_d: 0.602589
0.9217 --- loss: 1.685047, loss_ss: 1.210882, loss_d: 0.474165
0.9601 --- loss: 1.477950, loss_ss: 1.033498, loss_d: 0.444452
0.9985 --- loss: 1.791467, loss_ss: 1.455207, loss_d: 0.336261
Epoch finished! Loss: 1.5933257983281062
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.154749, loss_ss: 0.793481, loss_d: 0.361268
0.0384 --- loss: 1.424446, loss_ss: 1.095574, loss_d: 0.328872
0.0768 --- loss: 1.824677, loss_ss: 1.200777, loss_d: 0.623900
0.1152 --- loss: 1.990213, loss_ss: 0.881241, loss_d: 1.108972
0.1536 --- loss: 1.626496, loss_ss: 1.128438, loss_d: 0.498058
0.1920 --- loss: 1.597672, loss_ss: 1.002614, loss_d: 0.595058
0.2304 --- loss: 1.498191, loss_ss: 0.910717, loss_d: 0.587475
0.2688 --- loss: 1.513152, loss_ss: 0.927998, loss_d: 0.585154
0.3072 --- loss: 1.725744, loss_ss: 1.115084, loss_d: 0.610660
0.3456 --- loss: 1.243384, loss_ss: 0.778803, loss_d: 0.464582
0.3840 --- loss: 1.913229, loss_ss: 1.222499, loss_d: 0.690730
0.4224 --- loss: 1.422365, loss_ss: 0.997944, loss_d: 0.424422
0.4608 --- loss: 1.690571, loss_ss: 1.072778, loss_d: 0.617793
0.4992 --- loss: 1.381947, loss_ss: 0.884748, loss_d: 0.497198
0.5376 --- loss: 1.760361, loss_ss: 1.145915, loss_d: 0.614446
0.5760 --- loss: 1.778812, loss_ss: 1.311625, loss_d: 0.467188
0.6144 --- loss: 1.327343, loss_ss: 0.941795, loss_d: 0.385549
0.6528 --- loss: 1.740405, loss_ss: 0.876481, loss_d: 0.863924
0.6912 --- loss: 1.138760, loss_ss: 0.808344, loss_d: 0.330416
0.7296 --- loss: 1.277782, loss_ss: 0.983242, loss_d: 0.294540
0.7680 --- loss: 1.709909, loss_ss: 1.323723, loss_d: 0.386186
0.8065 --- loss: 1.456277, loss_ss: 0.854460, loss_d: 0.601816
0.8449 --- loss: 1.421887, loss_ss: 0.921584, loss_d: 0.500303
0.8833 --- loss: 1.235351, loss_ss: 0.846114, loss_d: 0.389237
0.9217 --- loss: 2.364329, loss_ss: 0.911291, loss_d: 1.453038
0.9601 --- loss: 1.779988, loss_ss: 1.122326, loss_d: 0.657662
0.9985 --- loss: 1.274203, loss_ss: 0.943751, loss_d: 0.330451
Epoch finished! Loss: 1.488806430193094
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.230728, loss_ss: 0.688119, loss_d: 0.542609
0.0384 --- loss: 1.356087, loss_ss: 0.761302, loss_d: 0.594785
0.0768 --- loss: 1.234609, loss_ss: 0.687657, loss_d: 0.546952
0.1152 --- loss: 1.223759, loss_ss: 0.863220, loss_d: 0.360540
0.1536 --- loss: 1.180784, loss_ss: 0.933407, loss_d: 0.247378
0.1920 --- loss: 1.231881, loss_ss: 0.893245, loss_d: 0.338636
0.2304 --- loss: 1.229265, loss_ss: 0.702615, loss_d: 0.526650
0.2688 --- loss: 1.155822, loss_ss: 0.838653, loss_d: 0.317169
0.3072 --- loss: 1.542313, loss_ss: 1.097788, loss_d: 0.444524
0.3456 --- loss: 1.157602, loss_ss: 0.792801, loss_d: 0.364800
0.3840 --- loss: 1.398788, loss_ss: 0.997070, loss_d: 0.401718
0.4224 --- loss: 1.821781, loss_ss: 1.153330, loss_d: 0.668451
0.4608 --- loss: 1.423947, loss_ss: 0.784962, loss_d: 0.638984
0.4992 --- loss: 1.037004, loss_ss: 0.637429, loss_d: 0.399574
0.5376 --- loss: 1.977893, loss_ss: 1.284738, loss_d: 0.693155
0.5760 --- loss: 1.204503, loss_ss: 0.972877, loss_d: 0.231625
0.6144 --- loss: 1.809998, loss_ss: 1.192006, loss_d: 0.617991
0.6528 --- loss: 1.565171, loss_ss: 0.689324, loss_d: 0.875847
0.6912 --- loss: 1.823127, loss_ss: 0.942973, loss_d: 0.880154
0.7296 --- loss: 1.206009, loss_ss: 0.976933, loss_d: 0.229076
0.7680 --- loss: 1.884073, loss_ss: 1.000650, loss_d: 0.883423
0.8065 --- loss: 1.515954, loss_ss: 1.081156, loss_d: 0.434798
0.8449 --- loss: 1.325171, loss_ss: 1.044983, loss_d: 0.280188
0.8833 --- loss: 1.122380, loss_ss: 0.859398, loss_d: 0.262982
0.9217 --- loss: 1.433333, loss_ss: 1.148532, loss_d: 0.284801
0.9601 --- loss: 1.250738, loss_ss: 0.840936, loss_d: 0.409801
0.9985 --- loss: 1.583784, loss_ss: 1.141805, loss_d: 0.441979
Epoch finished! Loss: 1.3812886382524783
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.202487, loss_ss: 0.813270, loss_d: 0.389217
0.0384 --- loss: 1.353949, loss_ss: 0.864221, loss_d: 0.489728
0.0768 --- loss: 1.247031, loss_ss: 1.000023, loss_d: 0.247009
0.1152 --- loss: 1.553648, loss_ss: 1.072578, loss_d: 0.481071
0.1536 --- loss: 1.330694, loss_ss: 1.106057, loss_d: 0.224637
0.1920 --- loss: 1.324041, loss_ss: 0.979532, loss_d: 0.344509
0.2304 --- loss: 1.224958, loss_ss: 0.861638, loss_d: 0.363319
0.2688 --- loss: 1.281850, loss_ss: 1.036746, loss_d: 0.245104
0.3072 --- loss: 0.950969, loss_ss: 0.651521, loss_d: 0.299448
0.3456 --- loss: 1.044253, loss_ss: 0.754232, loss_d: 0.290021
0.3840 --- loss: 0.940477, loss_ss: 0.789903, loss_d: 0.150574
0.4224 --- loss: 1.395276, loss_ss: 0.909423, loss_d: 0.485853
0.4608 --- loss: 1.158680, loss_ss: 0.786187, loss_d: 0.372493
0.4992 --- loss: 0.840753, loss_ss: 0.610677, loss_d: 0.230075
0.5376 --- loss: 1.065688, loss_ss: 0.674366, loss_d: 0.391322
0.5760 --- loss: 0.993679, loss_ss: 0.751305, loss_d: 0.242374
0.6144 --- loss: 1.691829, loss_ss: 0.916285, loss_d: 0.775544
0.6528 --- loss: 1.023670, loss_ss: 0.863255, loss_d: 0.160415
0.6912 --- loss: 1.440252, loss_ss: 1.135730, loss_d: 0.304522
0.7296 --- loss: 1.055739, loss_ss: 0.799095, loss_d: 0.256644
0.7680 --- loss: 1.050369, loss_ss: 0.873599, loss_d: 0.176770
0.8065 --- loss: 1.519730, loss_ss: 1.068793, loss_d: 0.450937
0.8449 --- loss: 1.298557, loss_ss: 0.833983, loss_d: 0.464574
0.8833 --- loss: 1.257932, loss_ss: 0.959733, loss_d: 0.298199
0.9217 --- loss: 1.618554, loss_ss: 1.313744, loss_d: 0.304810
0.9601 --- loss: 1.161577, loss_ss: 0.803019, loss_d: 0.358558
0.9985 --- loss: 1.365766, loss_ss: 0.950499, loss_d: 0.415267
Epoch finished! Loss: 1.2880023701832846
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.950748, loss_ss: 0.885022, loss_d: 1.065726
0.0384 --- loss: 1.261726, loss_ss: 1.022796, loss_d: 0.238930
0.0768 --- loss: 1.211961, loss_ss: 0.954835, loss_d: 0.257127
0.1152 --- loss: 1.495128, loss_ss: 1.325454, loss_d: 0.169675
0.1536 --- loss: 0.987785, loss_ss: 0.869641, loss_d: 0.118144
0.1920 --- loss: 0.896723, loss_ss: 0.775075, loss_d: 0.121648
0.2304 --- loss: 1.181702, loss_ss: 0.947394, loss_d: 0.234308
0.2688 --- loss: 1.225521, loss_ss: 0.738582, loss_d: 0.486939
0.3072 --- loss: 1.035346, loss_ss: 0.696519, loss_d: 0.338827
0.3456 --- loss: 1.018412, loss_ss: 0.733768, loss_d: 0.284643
0.3840 --- loss: 1.676637, loss_ss: 0.869466, loss_d: 0.807171
0.4224 --- loss: 0.903998, loss_ss: 0.684954, loss_d: 0.219044
0.4608 --- loss: 1.228831, loss_ss: 0.995288, loss_d: 0.233543
0.4992 --- loss: 1.253788, loss_ss: 1.073388, loss_d: 0.180400
0.5376 --- loss: 1.141145, loss_ss: 0.711300, loss_d: 0.429846
0.5760 --- loss: 1.380995, loss_ss: 0.896358, loss_d: 0.484637
0.6144 --- loss: 1.158815, loss_ss: 0.873000, loss_d: 0.285815
0.6528 --- loss: 1.335331, loss_ss: 0.953147, loss_d: 0.382184
0.6912 --- loss: 1.067653, loss_ss: 0.711495, loss_d: 0.356158
0.7296 --- loss: 1.188614, loss_ss: 0.929371, loss_d: 0.259244
0.7680 --- loss: 0.897214, loss_ss: 0.559132, loss_d: 0.338081
0.8065 --- loss: 1.335115, loss_ss: 1.056646, loss_d: 0.278469
0.8449 --- loss: 1.071342, loss_ss: 0.824190, loss_d: 0.247152
0.8833 --- loss: 1.936629, loss_ss: 0.890580, loss_d: 1.046048
0.9217 --- loss: 0.850100, loss_ss: 0.568291, loss_d: 0.281808
0.9601 --- loss: 0.989621, loss_ss: 0.800243, loss_d: 0.189378
0.9985 --- loss: 1.110358, loss_ss: 0.718637, loss_d: 0.391722
Epoch finished! Loss: 1.2385415049699637
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.814844, loss_ss: 0.657563, loss_d: 0.157281
0.0384 --- loss: 0.921355, loss_ss: 0.661307, loss_d: 0.260048
0.0768 --- loss: 1.069231, loss_ss: 0.604591, loss_d: 0.464640
0.1152 --- loss: 1.172306, loss_ss: 0.971973, loss_d: 0.200333
0.1536 --- loss: 1.212343, loss_ss: 0.934655, loss_d: 0.277688
0.1920 --- loss: 0.924606, loss_ss: 0.801242, loss_d: 0.123364
0.2304 --- loss: 1.030439, loss_ss: 0.778007, loss_d: 0.252432
0.2688 --- loss: 1.142210, loss_ss: 0.785558, loss_d: 0.356652
0.3072 --- loss: 1.919510, loss_ss: 0.893884, loss_d: 1.025627
0.3456 --- loss: 0.966276, loss_ss: 0.728311, loss_d: 0.237964
0.3840 --- loss: 0.976099, loss_ss: 0.777410, loss_d: 0.198689
0.4224 --- loss: 1.397947, loss_ss: 0.965451, loss_d: 0.432496
0.4608 --- loss: 1.187227, loss_ss: 0.849590, loss_d: 0.337637
0.4992 --- loss: 1.295420, loss_ss: 0.728438, loss_d: 0.566982
0.5376 --- loss: 0.836967, loss_ss: 0.658852, loss_d: 0.178115
0.5760 --- loss: 1.645761, loss_ss: 0.970170, loss_d: 0.675590
0.6144 --- loss: 0.981987, loss_ss: 0.659708, loss_d: 0.322279
0.6528 --- loss: 1.458375, loss_ss: 1.225248, loss_d: 0.233127
0.6912 --- loss: 1.061141, loss_ss: 0.744389, loss_d: 0.316752
0.7296 --- loss: 1.615822, loss_ss: 1.074836, loss_d: 0.540986
0.7680 --- loss: 1.547125, loss_ss: 0.967715, loss_d: 0.579410
0.8065 --- loss: 1.174544, loss_ss: 0.954439, loss_d: 0.220105
0.8449 --- loss: 1.266326, loss_ss: 1.091103, loss_d: 0.175223
0.8833 --- loss: 1.173632, loss_ss: 1.016086, loss_d: 0.157546
0.9217 --- loss: 1.012674, loss_ss: 0.717833, loss_d: 0.294841
0.9601 --- loss: 1.115644, loss_ss: 0.992133, loss_d: 0.123511
0.9985 --- loss: 2.006379, loss_ss: 1.468204, loss_d: 0.538176
Epoch finished! Loss: 1.168165453351461
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.140836, loss_ss: 0.887349, loss_d: 0.253487
0.0384 --- loss: 1.191548, loss_ss: 1.040355, loss_d: 0.151193
0.0768 --- loss: 1.222231, loss_ss: 1.070638, loss_d: 0.151593
0.1152 --- loss: 1.117266, loss_ss: 0.863442, loss_d: 0.253824
0.1536 --- loss: 1.364086, loss_ss: 1.153196, loss_d: 0.210890
0.1920 --- loss: 1.077941, loss_ss: 0.951527, loss_d: 0.126414
0.2304 --- loss: 1.979132, loss_ss: 1.206444, loss_d: 0.772688
0.2688 --- loss: 0.942404, loss_ss: 0.789270, loss_d: 0.153134
0.3072 --- loss: 1.208090, loss_ss: 0.868979, loss_d: 0.339111
0.3456 --- loss: 0.907482, loss_ss: 0.758637, loss_d: 0.148845
0.3840 --- loss: 0.908325, loss_ss: 0.808402, loss_d: 0.099923
0.4224 --- loss: 1.101421, loss_ss: 0.696701, loss_d: 0.404720
0.4608 --- loss: 0.872503, loss_ss: 0.785688, loss_d: 0.086815
0.4992 --- loss: 1.296368, loss_ss: 0.930016, loss_d: 0.366352
0.5376 --- loss: 1.046011, loss_ss: 0.766038, loss_d: 0.279974
0.5760 --- loss: 0.831750, loss_ss: 0.651400, loss_d: 0.180351
0.6144 --- loss: 1.114758, loss_ss: 1.036066, loss_d: 0.078692
0.6528 --- loss: 1.308947, loss_ss: 0.627441, loss_d: 0.681506
0.6912 --- loss: 1.145841, loss_ss: 0.778794, loss_d: 0.367047
0.7296 --- loss: 1.175079, loss_ss: 1.013923, loss_d: 0.161157
0.7680 --- loss: 1.467122, loss_ss: 1.300801, loss_d: 0.166322
0.8065 --- loss: 1.145796, loss_ss: 1.002410, loss_d: 0.143386
0.8449 --- loss: 1.322788, loss_ss: 0.754654, loss_d: 0.568134
0.8833 --- loss: 1.016172, loss_ss: 0.690132, loss_d: 0.326040
0.9217 --- loss: 1.219736, loss_ss: 0.749503, loss_d: 0.470233
0.9601 --- loss: 1.116442, loss_ss: 0.870968, loss_d: 0.245474
0.9985 --- loss: 0.988378, loss_ss: 0.907065, loss_d: 0.081313
Epoch finished! Loss: 1.1472426909666795
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.848068, loss_ss: 0.687586, loss_d: 0.160482
0.0384 --- loss: 0.718020, loss_ss: 0.605730, loss_d: 0.112290
0.0768 --- loss: 1.100066, loss_ss: 1.008246, loss_d: 0.091820
0.1152 --- loss: 0.978447, loss_ss: 0.866625, loss_d: 0.111822
0.1536 --- loss: 0.766005, loss_ss: 0.703225, loss_d: 0.062780
0.1920 --- loss: 0.893310, loss_ss: 0.835416, loss_d: 0.057895
0.2304 --- loss: 1.180405, loss_ss: 0.941122, loss_d: 0.239283
0.2688 --- loss: 0.910350, loss_ss: 0.759861, loss_d: 0.150489
0.3072 --- loss: 1.338327, loss_ss: 0.974822, loss_d: 0.363505
0.3456 --- loss: 1.124621, loss_ss: 0.817434, loss_d: 0.307187
0.3840 --- loss: 1.235978, loss_ss: 0.956200, loss_d: 0.279778
0.4224 --- loss: 1.551669, loss_ss: 0.921761, loss_d: 0.629908
0.4608 --- loss: 1.257163, loss_ss: 0.911703, loss_d: 0.345459
0.4992 --- loss: 0.861774, loss_ss: 0.530229, loss_d: 0.331545
0.5376 --- loss: 1.294887, loss_ss: 1.149920, loss_d: 0.144967
0.5760 --- loss: 1.095072, loss_ss: 1.022595, loss_d: 0.072477
0.6144 --- loss: 1.135828, loss_ss: 0.824003, loss_d: 0.311825
0.6528 --- loss: 0.870493, loss_ss: 0.722173, loss_d: 0.148320
0.6912 --- loss: 0.825141, loss_ss: 0.607496, loss_d: 0.217645
0.7296 --- loss: 0.751444, loss_ss: 0.596364, loss_d: 0.155080
0.7680 --- loss: 1.118788, loss_ss: 0.876143, loss_d: 0.242645
0.8065 --- loss: 0.933984, loss_ss: 0.824047, loss_d: 0.109937
0.8449 --- loss: 1.596868, loss_ss: 1.363916, loss_d: 0.232952
0.8833 --- loss: 1.087151, loss_ss: 0.808698, loss_d: 0.278453
0.9217 --- loss: 1.090935, loss_ss: 0.943062, loss_d: 0.147873
0.9601 --- loss: 1.160110, loss_ss: 0.944048, loss_d: 0.216061
0.9985 --- loss: 2.713605, loss_ss: 0.740918, loss_d: 1.972687
Epoch finished! Loss: 1.1170924642911324
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.587426326129666
             precision    recall  f1-score   support

        0.0       0.73      0.38      0.50       197
        1.0       0.12      0.02      0.04       161
        2.0       0.67      0.66      0.66       348
        3.0       0.98      0.90      0.94       208
        4.0       0.29      0.99      0.45       104

avg / total       0.62      0.59      0.57      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.27  38.07   96.59  72.82     50.00
1  81.83   2.48   96.73  12.50      4.15
2  77.11  65.52   83.13  66.86     66.18
3  97.64  90.38   99.51  97.92     94.00
4  75.64  99.04   72.98  29.43     45.37
Total accuracy: 58.74%
Average sen: 59.10%
Average spec: 89.79%
Macro f1-score: 51.94%
[0.78973657 0.99219394 0.99367577 0.9755435  0.99890006 0.99751318
 0.3692843  0.9734056  0.95478922 0.6378336  0.92586148 0.67996937
 0.98972577 0.80380237 0.8456375  0.86510628 0.9720785  0.99352211
 0.99112403 0.56115055 0.97992319 0.97664577 0.75457507 0.98677945
 0.81813228 0.13836364 0.78463477 0.94553387 0.82525826 0.95419186
 0.64067143 0.95806068 0.34293386 0.65063655]
pred: 0.8255057172740207, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.338269, loss_ss: 1.639581, loss_d: 0.698688
0.0384 --- loss: 2.208489, loss_ss: 1.320322, loss_d: 0.888167
0.0768 --- loss: 2.035395, loss_ss: 1.343619, loss_d: 0.691776
0.1152 --- loss: 1.925106, loss_ss: 1.403056, loss_d: 0.522050
0.1536 --- loss: 2.114046, loss_ss: 1.540224, loss_d: 0.573822
0.1920 --- loss: 2.188537, loss_ss: 1.278513, loss_d: 0.910024
0.2304 --- loss: 1.671727, loss_ss: 1.231962, loss_d: 0.439765
0.2688 --- loss: 1.958982, loss_ss: 1.309115, loss_d: 0.649867
0.3072 --- loss: 2.031028, loss_ss: 1.410419, loss_d: 0.620609
0.3456 --- loss: 2.226499, loss_ss: 1.170472, loss_d: 1.056027
0.3840 --- loss: 1.974405, loss_ss: 1.302641, loss_d: 0.671764
0.4224 --- loss: 1.711507, loss_ss: 1.324082, loss_d: 0.387424
0.4608 --- loss: 1.654095, loss_ss: 1.162645, loss_d: 0.491450
0.4992 --- loss: 1.966075, loss_ss: 1.437098, loss_d: 0.528978
0.5376 --- loss: 1.699051, loss_ss: 1.131912, loss_d: 0.567138
0.5760 --- loss: 1.804594, loss_ss: 1.247164, loss_d: 0.557431
0.6144 --- loss: 1.952967, loss_ss: 1.441004, loss_d: 0.511963
0.6528 --- loss: 2.002346, loss_ss: 1.398687, loss_d: 0.603659
0.6912 --- loss: 1.778537, loss_ss: 1.161896, loss_d: 0.616640
0.7296 --- loss: 1.496703, loss_ss: 1.007837, loss_d: 0.488866
0.7680 --- loss: 1.643720, loss_ss: 1.039554, loss_d: 0.604166
0.8065 --- loss: 1.916203, loss_ss: 1.367175, loss_d: 0.549029
0.8449 --- loss: 1.692102, loss_ss: 1.295132, loss_d: 0.396970
0.8833 --- loss: 1.623756, loss_ss: 0.985551, loss_d: 0.638205
0.9217 --- loss: 1.892330, loss_ss: 1.133493, loss_d: 0.758837
0.9601 --- loss: 1.660120, loss_ss: 1.035730, loss_d: 0.624391
0.9985 --- loss: 1.753931, loss_ss: 1.282758, loss_d: 0.471173
Epoch finished! Loss: 1.9176064482102027
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.826932, loss_ss: 1.223925, loss_d: 0.603007
0.0384 --- loss: 1.955498, loss_ss: 1.150437, loss_d: 0.805061
0.0768 --- loss: 1.683774, loss_ss: 1.313770, loss_d: 0.370004
0.1152 --- loss: 1.654395, loss_ss: 1.188311, loss_d: 0.466084
0.1536 --- loss: 1.667350, loss_ss: 1.210101, loss_d: 0.457249
0.1920 --- loss: 1.708385, loss_ss: 1.196141, loss_d: 0.512244
0.2304 --- loss: 1.501776, loss_ss: 1.087717, loss_d: 0.414059
0.2688 --- loss: 2.006726, loss_ss: 1.395854, loss_d: 0.610872
0.3072 --- loss: 1.833001, loss_ss: 1.235588, loss_d: 0.597414
0.3456 --- loss: 1.688534, loss_ss: 1.158153, loss_d: 0.530381
0.3840 --- loss: 1.815175, loss_ss: 1.253132, loss_d: 0.562043
0.4224 --- loss: 1.816418, loss_ss: 1.070780, loss_d: 0.745637
0.4608 --- loss: 1.479791, loss_ss: 1.078425, loss_d: 0.401366
0.4992 --- loss: 1.803251, loss_ss: 1.300550, loss_d: 0.502701
0.5376 --- loss: 1.482086, loss_ss: 0.992792, loss_d: 0.489294
0.5760 --- loss: 1.486070, loss_ss: 1.015251, loss_d: 0.470819
0.6144 --- loss: 1.708853, loss_ss: 0.945732, loss_d: 0.763121
0.6528 --- loss: 1.591693, loss_ss: 0.881549, loss_d: 0.710145
0.6912 --- loss: 1.731261, loss_ss: 0.894550, loss_d: 0.836711
0.7296 --- loss: 1.751159, loss_ss: 1.030882, loss_d: 0.720277
0.7680 --- loss: 1.728862, loss_ss: 1.161332, loss_d: 0.567530
0.8065 --- loss: 1.626423, loss_ss: 0.930912, loss_d: 0.695511
0.8449 --- loss: 1.557480, loss_ss: 0.915216, loss_d: 0.642264
0.8833 --- loss: 1.470798, loss_ss: 1.003388, loss_d: 0.467410
0.9217 --- loss: 1.704614, loss_ss: 0.978365, loss_d: 0.726249
0.9601 --- loss: 1.612801, loss_ss: 1.139279, loss_d: 0.473522
0.9985 --- loss: 1.365421, loss_ss: 1.080036, loss_d: 0.285386
Epoch finished! Loss: 1.6956131907609793
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.248628, loss_ss: 1.400570, loss_d: 0.848058
0.0384 --- loss: 1.732363, loss_ss: 0.910169, loss_d: 0.822194
0.0768 --- loss: 1.508180, loss_ss: 1.035553, loss_d: 0.472627
0.1152 --- loss: 1.588524, loss_ss: 1.188023, loss_d: 0.400501
0.1536 --- loss: 1.650245, loss_ss: 1.055401, loss_d: 0.594844
0.1920 --- loss: 1.957627, loss_ss: 1.170042, loss_d: 0.787585
0.2304 --- loss: 1.442109, loss_ss: 1.012067, loss_d: 0.430042
0.2688 --- loss: 1.519793, loss_ss: 0.853011, loss_d: 0.666782
0.3072 --- loss: 1.550399, loss_ss: 1.050694, loss_d: 0.499704
0.3456 --- loss: 1.601640, loss_ss: 1.088395, loss_d: 0.513244
0.3840 --- loss: 2.171842, loss_ss: 1.400533, loss_d: 0.771309
0.4224 --- loss: 1.505700, loss_ss: 0.858951, loss_d: 0.646749
0.4608 --- loss: 1.930774, loss_ss: 1.019285, loss_d: 0.911489
0.4992 --- loss: 1.455866, loss_ss: 0.950268, loss_d: 0.505598
0.5376 --- loss: 1.611597, loss_ss: 0.841113, loss_d: 0.770484
0.5760 --- loss: 1.322818, loss_ss: 0.886691, loss_d: 0.436127
0.6144 --- loss: 1.722131, loss_ss: 1.123213, loss_d: 0.598918
0.6528 --- loss: 1.590305, loss_ss: 1.103673, loss_d: 0.486632
0.6912 --- loss: 1.323500, loss_ss: 0.934206, loss_d: 0.389294
0.7296 --- loss: 1.512366, loss_ss: 1.096927, loss_d: 0.415439
0.7680 --- loss: 1.902695, loss_ss: 1.274461, loss_d: 0.628234
0.8065 --- loss: 1.524794, loss_ss: 0.952519, loss_d: 0.572275
0.8449 --- loss: 1.511399, loss_ss: 0.942490, loss_d: 0.568909
0.8833 --- loss: 1.705714, loss_ss: 0.937777, loss_d: 0.767936
0.9217 --- loss: 1.289252, loss_ss: 0.809767, loss_d: 0.479485
0.9601 --- loss: 1.340496, loss_ss: 0.641832, loss_d: 0.698663
0.9985 --- loss: 1.759618, loss_ss: 0.865327, loss_d: 0.894291
Epoch finished! Loss: 1.621946543455124
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.713547, loss_ss: 1.087587, loss_d: 0.625960
0.0384 --- loss: 1.650270, loss_ss: 1.003946, loss_d: 0.646325
0.0768 --- loss: 1.813557, loss_ss: 1.167440, loss_d: 0.646117
0.1152 --- loss: 1.526612, loss_ss: 1.081175, loss_d: 0.445438
0.1536 --- loss: 1.615787, loss_ss: 1.117071, loss_d: 0.498716
0.1920 --- loss: 1.681605, loss_ss: 0.981892, loss_d: 0.699713
0.2304 --- loss: 1.587720, loss_ss: 1.228615, loss_d: 0.359105
0.2688 --- loss: 1.469457, loss_ss: 0.905529, loss_d: 0.563928
0.3072 --- loss: 1.609894, loss_ss: 0.981920, loss_d: 0.627974
0.3456 --- loss: 2.145293, loss_ss: 1.661401, loss_d: 0.483891
0.3840 --- loss: 1.815262, loss_ss: 1.174302, loss_d: 0.640960
0.4224 --- loss: 1.418771, loss_ss: 1.020693, loss_d: 0.398079
0.4608 --- loss: 1.394571, loss_ss: 0.754112, loss_d: 0.640459
0.4992 --- loss: 1.723962, loss_ss: 1.257671, loss_d: 0.466291
0.5376 --- loss: 1.316422, loss_ss: 0.814948, loss_d: 0.501474
0.5760 --- loss: 1.673872, loss_ss: 0.909144, loss_d: 0.764728
0.6144 --- loss: 1.489366, loss_ss: 1.043880, loss_d: 0.445486
0.6528 --- loss: 1.569032, loss_ss: 1.027557, loss_d: 0.541475
0.6912 --- loss: 1.525257, loss_ss: 0.745656, loss_d: 0.779600
0.7296 --- loss: 1.153670, loss_ss: 0.680991, loss_d: 0.472680
0.7680 --- loss: 1.755985, loss_ss: 1.031530, loss_d: 0.724454
0.8065 --- loss: 1.567011, loss_ss: 1.142429, loss_d: 0.424582
0.8449 --- loss: 1.253732, loss_ss: 0.738172, loss_d: 0.515561
0.8833 --- loss: 1.317665, loss_ss: 0.857402, loss_d: 0.460263
0.9217 --- loss: 1.796145, loss_ss: 1.242835, loss_d: 0.553310
0.9601 --- loss: 1.604924, loss_ss: 0.869954, loss_d: 0.734969
0.9985 --- loss: 1.762565, loss_ss: 1.239999, loss_d: 0.522566
Epoch finished! Loss: 1.5582363500044896
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.442019, loss_ss: 0.971551, loss_d: 0.470468
0.0384 --- loss: 1.526285, loss_ss: 1.074372, loss_d: 0.451913
0.0768 --- loss: 1.453199, loss_ss: 0.888147, loss_d: 0.565052
0.1152 --- loss: 1.738567, loss_ss: 1.095630, loss_d: 0.642937
0.1536 --- loss: 1.462020, loss_ss: 0.917612, loss_d: 0.544408
0.1920 --- loss: 1.578321, loss_ss: 1.086558, loss_d: 0.491762
0.2304 --- loss: 1.424529, loss_ss: 0.869917, loss_d: 0.554612
0.2688 --- loss: 1.879430, loss_ss: 1.120462, loss_d: 0.758968
0.3072 --- loss: 1.431126, loss_ss: 0.798958, loss_d: 0.632167
0.3456 --- loss: 2.000223, loss_ss: 1.197219, loss_d: 0.803003
0.3840 --- loss: 1.445753, loss_ss: 1.019050, loss_d: 0.426702
0.4224 --- loss: 1.611124, loss_ss: 0.988536, loss_d: 0.622587
0.4608 --- loss: 1.389954, loss_ss: 0.808893, loss_d: 0.581061
0.4992 --- loss: 1.185960, loss_ss: 0.757870, loss_d: 0.428090
0.5376 --- loss: 1.593940, loss_ss: 1.069558, loss_d: 0.524382
0.5760 --- loss: 1.578460, loss_ss: 0.911817, loss_d: 0.666643
0.6144 --- loss: 1.421126, loss_ss: 0.981513, loss_d: 0.439613
0.6528 --- loss: 1.387849, loss_ss: 1.092351, loss_d: 0.295498
0.6912 --- loss: 1.430580, loss_ss: 1.015010, loss_d: 0.415570
0.7296 --- loss: 1.503756, loss_ss: 1.004981, loss_d: 0.498776
0.7680 --- loss: 1.158147, loss_ss: 0.810125, loss_d: 0.348021
0.8065 --- loss: 1.249610, loss_ss: 0.828251, loss_d: 0.421359
0.8449 --- loss: 1.543949, loss_ss: 0.969851, loss_d: 0.574099
0.8833 --- loss: 1.163199, loss_ss: 0.757681, loss_d: 0.405518
0.9217 --- loss: 1.484504, loss_ss: 0.885107, loss_d: 0.599397
0.9601 --- loss: 1.780749, loss_ss: 1.066849, loss_d: 0.713900
0.9985 --- loss: 1.851286, loss_ss: 1.186122, loss_d: 0.665163
Epoch finished! Loss: 1.478062281700281
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.110785, loss_ss: 0.856236, loss_d: 0.254549
0.0384 --- loss: 1.374380, loss_ss: 0.709825, loss_d: 0.664555
0.0768 --- loss: 1.634674, loss_ss: 1.211910, loss_d: 0.422764
0.1152 --- loss: 1.117932, loss_ss: 0.596512, loss_d: 0.521420
0.1536 --- loss: 1.253809, loss_ss: 0.858829, loss_d: 0.394981
0.1920 --- loss: 1.377198, loss_ss: 0.869442, loss_d: 0.507755
0.2304 --- loss: 1.364724, loss_ss: 0.991063, loss_d: 0.373661
0.2688 --- loss: 1.503210, loss_ss: 1.025605, loss_d: 0.477605
0.3072 --- loss: 1.710178, loss_ss: 0.918470, loss_d: 0.791708
0.3456 --- loss: 1.202641, loss_ss: 0.770755, loss_d: 0.431887
0.3840 --- loss: 1.413357, loss_ss: 0.836769, loss_d: 0.576589
0.4224 --- loss: 1.153620, loss_ss: 0.833766, loss_d: 0.319854
0.4608 --- loss: 1.203876, loss_ss: 0.714537, loss_d: 0.489339
0.4992 --- loss: 1.374726, loss_ss: 1.051650, loss_d: 0.323075
0.5376 --- loss: 1.130047, loss_ss: 0.743037, loss_d: 0.387010
0.5760 --- loss: 1.165278, loss_ss: 0.566996, loss_d: 0.598282
0.6144 --- loss: 1.026213, loss_ss: 0.759457, loss_d: 0.266756
0.6528 --- loss: 1.786090, loss_ss: 1.034798, loss_d: 0.751292
0.6912 --- loss: 1.571649, loss_ss: 1.105543, loss_d: 0.466106
0.7296 --- loss: 1.573873, loss_ss: 1.134418, loss_d: 0.439455
0.7680 --- loss: 1.024634, loss_ss: 0.772679, loss_d: 0.251955
0.8065 --- loss: 1.198860, loss_ss: 0.746686, loss_d: 0.452174
0.8449 --- loss: 1.318023, loss_ss: 0.665881, loss_d: 0.652142
0.8833 --- loss: 1.692950, loss_ss: 0.832000, loss_d: 0.860949
0.9217 --- loss: 1.328985, loss_ss: 0.793485, loss_d: 0.535500
0.9601 --- loss: 1.042418, loss_ss: 0.731337, loss_d: 0.311082
0.9985 --- loss: 1.819209, loss_ss: 0.838897, loss_d: 0.980313
Epoch finished! Loss: 1.4057023889743365
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.177701, loss_ss: 0.892343, loss_d: 0.285359
0.0384 --- loss: 1.885602, loss_ss: 1.004260, loss_d: 0.881341
0.0768 --- loss: 1.567526, loss_ss: 0.779067, loss_d: 0.788458
0.1152 --- loss: 1.240242, loss_ss: 0.720375, loss_d: 0.519868
0.1536 --- loss: 1.586382, loss_ss: 1.131846, loss_d: 0.454536
0.1920 --- loss: 1.574174, loss_ss: 1.039766, loss_d: 0.534408
0.2304 --- loss: 1.258403, loss_ss: 0.807734, loss_d: 0.450669
0.2688 --- loss: 1.602322, loss_ss: 1.083966, loss_d: 0.518356
0.3072 --- loss: 1.233674, loss_ss: 0.837057, loss_d: 0.396617
0.3456 --- loss: 1.421932, loss_ss: 0.730089, loss_d: 0.691843
0.3840 --- loss: 1.640819, loss_ss: 1.108515, loss_d: 0.532304
0.4224 --- loss: 1.134884, loss_ss: 0.855276, loss_d: 0.279608
0.4608 --- loss: 1.481903, loss_ss: 0.980567, loss_d: 0.501336
0.4992 --- loss: 1.087284, loss_ss: 0.757420, loss_d: 0.329864
0.5376 --- loss: 1.011199, loss_ss: 0.728718, loss_d: 0.282480
0.5760 --- loss: 1.337850, loss_ss: 0.766592, loss_d: 0.571259
0.6144 --- loss: 1.016211, loss_ss: 0.777186, loss_d: 0.239025
0.6528 --- loss: 0.963585, loss_ss: 0.687102, loss_d: 0.276483
0.6912 --- loss: 1.449600, loss_ss: 1.039638, loss_d: 0.409962
0.7296 --- loss: 1.038962, loss_ss: 0.831473, loss_d: 0.207489
0.7680 --- loss: 1.275695, loss_ss: 0.885372, loss_d: 0.390323
0.8065 --- loss: 0.957447, loss_ss: 0.740546, loss_d: 0.216900
0.8449 --- loss: 1.112070, loss_ss: 0.616949, loss_d: 0.495121
0.8833 --- loss: 2.025834, loss_ss: 1.032067, loss_d: 0.993767
0.9217 --- loss: 1.745810, loss_ss: 1.208478, loss_d: 0.537332
0.9601 --- loss: 1.455835, loss_ss: 1.230863, loss_d: 0.224972
0.9985 --- loss: 1.682979, loss_ss: 1.434789, loss_d: 0.248190
Epoch finished! Loss: 1.345552324790221
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.188209, loss_ss: 0.741656, loss_d: 0.446553
0.0384 --- loss: 1.488493, loss_ss: 0.859080, loss_d: 0.629413
0.0768 --- loss: 1.997854, loss_ss: 1.375020, loss_d: 0.622835
0.1152 --- loss: 1.278357, loss_ss: 0.981771, loss_d: 0.296586
0.1536 --- loss: 1.038781, loss_ss: 0.816912, loss_d: 0.221869
0.1920 --- loss: 1.368255, loss_ss: 0.791547, loss_d: 0.576708
0.2304 --- loss: 1.211787, loss_ss: 0.899265, loss_d: 0.312522
0.2688 --- loss: 1.248853, loss_ss: 0.814452, loss_d: 0.434401
0.3072 --- loss: 1.781407, loss_ss: 1.352308, loss_d: 0.429099
0.3456 --- loss: 1.224874, loss_ss: 0.832189, loss_d: 0.392685
0.3840 --- loss: 1.197596, loss_ss: 0.809984, loss_d: 0.387613
0.4224 --- loss: 1.074861, loss_ss: 0.857658, loss_d: 0.217203
0.4608 --- loss: 1.205072, loss_ss: 0.815957, loss_d: 0.389115
0.4992 --- loss: 1.210628, loss_ss: 0.906748, loss_d: 0.303880
0.5376 --- loss: 1.065338, loss_ss: 0.731906, loss_d: 0.333433
0.5760 --- loss: 1.037907, loss_ss: 0.767294, loss_d: 0.270613
0.6144 --- loss: 1.090513, loss_ss: 0.637847, loss_d: 0.452666
0.6528 --- loss: 1.601470, loss_ss: 1.065735, loss_d: 0.535734
0.6912 --- loss: 1.183655, loss_ss: 1.042256, loss_d: 0.141400
0.7296 --- loss: 1.052086, loss_ss: 0.858734, loss_d: 0.193352
0.7680 --- loss: 1.164390, loss_ss: 0.797571, loss_d: 0.366820
0.8065 --- loss: 1.224479, loss_ss: 0.628868, loss_d: 0.595611
0.8449 --- loss: 1.176589, loss_ss: 0.954007, loss_d: 0.222582
0.8833 --- loss: 1.444493, loss_ss: 0.687489, loss_d: 0.757004
0.9217 --- loss: 1.032320, loss_ss: 0.832747, loss_d: 0.199573
0.9601 --- loss: 1.174948, loss_ss: 0.861814, loss_d: 0.313135
0.9985 --- loss: 1.977445, loss_ss: 0.607924, loss_d: 1.369522
Epoch finished! Loss: 1.2856561857920425
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.117880, loss_ss: 0.695790, loss_d: 0.422090
0.0384 --- loss: 0.992014, loss_ss: 0.825643, loss_d: 0.166370
0.0768 --- loss: 1.127838, loss_ss: 0.788071, loss_d: 0.339767
0.1152 --- loss: 1.313607, loss_ss: 0.891659, loss_d: 0.421948
0.1536 --- loss: 0.782469, loss_ss: 0.546525, loss_d: 0.235943
0.1920 --- loss: 1.135537, loss_ss: 0.846883, loss_d: 0.288655
0.2304 --- loss: 1.231862, loss_ss: 0.823753, loss_d: 0.408110
0.2688 --- loss: 1.136491, loss_ss: 0.674470, loss_d: 0.462022
0.3072 --- loss: 1.249111, loss_ss: 1.095922, loss_d: 0.153189
0.3456 --- loss: 0.848724, loss_ss: 0.655549, loss_d: 0.193175
0.3840 --- loss: 1.695628, loss_ss: 0.893202, loss_d: 0.802426
0.4224 --- loss: 1.135574, loss_ss: 0.855110, loss_d: 0.280463
0.4608 --- loss: 1.189506, loss_ss: 0.914788, loss_d: 0.274718
0.4992 --- loss: 1.213740, loss_ss: 0.921063, loss_d: 0.292677
0.5376 --- loss: 1.040844, loss_ss: 0.881423, loss_d: 0.159421
0.5760 --- loss: 1.513476, loss_ss: 0.805752, loss_d: 0.707724
0.6144 --- loss: 0.993178, loss_ss: 0.811890, loss_d: 0.181287
0.6528 --- loss: 1.218579, loss_ss: 0.899041, loss_d: 0.319538
0.6912 --- loss: 1.676697, loss_ss: 1.242355, loss_d: 0.434342
0.7296 --- loss: 1.401446, loss_ss: 1.013332, loss_d: 0.388114
0.7680 --- loss: 0.808915, loss_ss: 0.681190, loss_d: 0.127724
0.8065 --- loss: 1.234633, loss_ss: 1.084760, loss_d: 0.149874
0.8449 --- loss: 1.061386, loss_ss: 0.676038, loss_d: 0.385348
0.8833 --- loss: 0.812322, loss_ss: 0.560367, loss_d: 0.251955
0.9217 --- loss: 1.126036, loss_ss: 0.716880, loss_d: 0.409157
0.9601 --- loss: 1.945289, loss_ss: 1.378055, loss_d: 0.567234
0.9985 --- loss: 2.155786, loss_ss: 1.839190, loss_d: 0.316596
Epoch finished! Loss: 1.2378626472674883
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.034623, loss_ss: 0.851362, loss_d: 0.183261
0.0384 --- loss: 1.445002, loss_ss: 0.969354, loss_d: 0.475648
0.0768 --- loss: 0.901381, loss_ss: 0.579786, loss_d: 0.321595
0.1152 --- loss: 1.213155, loss_ss: 0.760336, loss_d: 0.452820
0.1536 --- loss: 1.137973, loss_ss: 0.750147, loss_d: 0.387826
0.1920 --- loss: 0.962902, loss_ss: 0.701939, loss_d: 0.260964
0.2304 --- loss: 1.268921, loss_ss: 0.485495, loss_d: 0.783426
0.2688 --- loss: 1.517258, loss_ss: 0.982172, loss_d: 0.535086
0.3072 --- loss: 1.291484, loss_ss: 0.882126, loss_d: 0.409357
0.3456 --- loss: 0.870550, loss_ss: 0.768118, loss_d: 0.102432
0.3840 --- loss: 1.192219, loss_ss: 0.712959, loss_d: 0.479260
0.4224 --- loss: 1.742649, loss_ss: 0.987167, loss_d: 0.755482
0.4608 --- loss: 0.868491, loss_ss: 0.724011, loss_d: 0.144479
0.4992 --- loss: 0.986543, loss_ss: 0.656905, loss_d: 0.329638
0.5376 --- loss: 1.293337, loss_ss: 0.904547, loss_d: 0.388791
0.5760 --- loss: 1.935496, loss_ss: 1.180091, loss_d: 0.755405
0.6144 --- loss: 1.704695, loss_ss: 0.992937, loss_d: 0.711757
0.6528 --- loss: 1.238487, loss_ss: 0.875604, loss_d: 0.362883
0.6912 --- loss: 1.131433, loss_ss: 0.723737, loss_d: 0.407696
0.7296 --- loss: 1.225050, loss_ss: 0.874520, loss_d: 0.350530
0.7680 --- loss: 1.368472, loss_ss: 0.799112, loss_d: 0.569359
0.8065 --- loss: 0.967503, loss_ss: 0.726750, loss_d: 0.240753
0.8449 --- loss: 1.523137, loss_ss: 1.385217, loss_d: 0.137920
0.8833 --- loss: 1.549904, loss_ss: 1.046114, loss_d: 0.503790
0.9217 --- loss: 1.117600, loss_ss: 0.914219, loss_d: 0.203381
0.9601 --- loss: 0.826364, loss_ss: 0.670652, loss_d: 0.155712
0.9985 --- loss: 1.096205, loss_ss: 1.014521, loss_d: 0.081684
Epoch finished! Loss: 1.2030234630291279
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.611764705882353
             precision    recall  f1-score   support

        0.0       0.24      0.98      0.38        62
        1.0       0.53      0.09      0.15       178
        2.0       0.74      0.80      0.77       437
        3.0       0.70      0.95      0.80       102
        4.0       0.82      0.42      0.56       241

avg / total       0.69      0.61      0.59      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.59  98.39   79.44  23.64     38.12
1  82.75   8.99   98.34  53.33     15.38
2  79.41  79.63   79.25  74.20     76.82
3  95.39  95.10   95.42  69.78     80.50
4  84.22  42.32   97.18  82.26     55.89
Total accuracy: 61.18%
Average sen: 64.89%
Average spec: 89.92%
Macro f1-score: 53.34%
[0.97775513 0.92680699 0.91123194 0.95395589 0.98706323 0.9788053
 0.98623496 0.9915632  0.99185866 0.97541398 0.98271704 0.83639163
 0.97631365 0.98973769 0.85792667 0.89178264 0.94835758 0.98922616
 0.99527353 0.98689979 0.96118063 0.98332238 0.9704414  0.97339678
 0.91947585 0.91008395 0.97872138 0.98223662 0.98132724 0.97662592
 0.97680742 0.96675384 0.99469757 0.95857096]
pred: 0.9608516938546124, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.618308, loss_ss: 1.875137, loss_d: 0.743171
0.0384 --- loss: 2.300352, loss_ss: 1.890568, loss_d: 0.409784
0.0769 --- loss: 2.073427, loss_ss: 1.439286, loss_d: 0.634140
0.1153 --- loss: 2.582749, loss_ss: 1.823949, loss_d: 0.758800
0.1538 --- loss: 2.069782, loss_ss: 1.443949, loss_d: 0.625833
0.1922 --- loss: 2.103210, loss_ss: 1.423674, loss_d: 0.679536
0.2307 --- loss: 2.286571, loss_ss: 1.446020, loss_d: 0.840551
0.2691 --- loss: 2.137848, loss_ss: 1.618036, loss_d: 0.519811
0.3076 --- loss: 1.908669, loss_ss: 1.372961, loss_d: 0.535708
0.3460 --- loss: 1.868027, loss_ss: 1.378706, loss_d: 0.489321
0.3845 --- loss: 2.325960, loss_ss: 1.521644, loss_d: 0.804316
0.4229 --- loss: 2.167669, loss_ss: 1.528923, loss_d: 0.638745
0.4614 --- loss: 2.047208, loss_ss: 1.497016, loss_d: 0.550192
0.4998 --- loss: 1.535172, loss_ss: 1.214021, loss_d: 0.321151
0.5383 --- loss: 1.998274, loss_ss: 1.377774, loss_d: 0.620500
0.5767 --- loss: 1.915839, loss_ss: 1.464991, loss_d: 0.450848
0.6151 --- loss: 1.869693, loss_ss: 1.350658, loss_d: 0.519035
0.6536 --- loss: 2.014414, loss_ss: 1.342231, loss_d: 0.672183
0.6920 --- loss: 1.935718, loss_ss: 1.421251, loss_d: 0.514466
0.7305 --- loss: 1.979336, loss_ss: 1.264507, loss_d: 0.714829
0.7689 --- loss: 2.142927, loss_ss: 1.580370, loss_d: 0.562557
0.8074 --- loss: 1.917577, loss_ss: 1.250466, loss_d: 0.667112
0.8458 --- loss: 2.125741, loss_ss: 1.206080, loss_d: 0.919660
0.8843 --- loss: 1.655878, loss_ss: 1.203827, loss_d: 0.452051
0.9227 --- loss: 2.182839, loss_ss: 1.248503, loss_d: 0.934335
0.9612 --- loss: 2.025101, loss_ss: 1.360695, loss_d: 0.664406
0.9996 --- loss: 1.752831, loss_ss: 1.444883, loss_d: 0.307947
Epoch finished! Loss: 2.04200300849401
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.851121, loss_ss: 1.228879, loss_d: 0.622243
0.0384 --- loss: 1.820760, loss_ss: 1.332824, loss_d: 0.487936
0.0769 --- loss: 2.016181, loss_ss: 1.145500, loss_d: 0.870681
0.1153 --- loss: 1.895575, loss_ss: 1.414637, loss_d: 0.480937
0.1538 --- loss: 1.632953, loss_ss: 1.173803, loss_d: 0.459150
0.1922 --- loss: 1.410538, loss_ss: 1.069252, loss_d: 0.341286
0.2307 --- loss: 1.892409, loss_ss: 1.278675, loss_d: 0.613734
0.2691 --- loss: 1.823851, loss_ss: 1.304179, loss_d: 0.519672
0.3076 --- loss: 1.660452, loss_ss: 1.093284, loss_d: 0.567168
0.3460 --- loss: 1.711435, loss_ss: 1.118533, loss_d: 0.592902
0.3845 --- loss: 1.857667, loss_ss: 1.200447, loss_d: 0.657220
0.4229 --- loss: 1.768516, loss_ss: 1.140811, loss_d: 0.627705
0.4614 --- loss: 1.583954, loss_ss: 1.146420, loss_d: 0.437534
0.4998 --- loss: 1.659809, loss_ss: 1.135303, loss_d: 0.524506
0.5383 --- loss: 1.633357, loss_ss: 1.049392, loss_d: 0.583965
0.5767 --- loss: 2.145577, loss_ss: 1.315898, loss_d: 0.829679
0.6151 --- loss: 1.629253, loss_ss: 1.199306, loss_d: 0.429947
0.6536 --- loss: 1.694637, loss_ss: 1.060505, loss_d: 0.634131
0.6920 --- loss: 1.877144, loss_ss: 1.242080, loss_d: 0.635064
0.7305 --- loss: 1.812376, loss_ss: 0.954721, loss_d: 0.857656
0.7689 --- loss: 1.876788, loss_ss: 1.062273, loss_d: 0.814515
0.8074 --- loss: 1.538305, loss_ss: 0.947133, loss_d: 0.591172
0.8458 --- loss: 1.708714, loss_ss: 1.058125, loss_d: 0.650588
0.8843 --- loss: 1.502816, loss_ss: 1.032703, loss_d: 0.470113
0.9227 --- loss: 1.456089, loss_ss: 0.908922, loss_d: 0.547168
0.9612 --- loss: 1.731840, loss_ss: 1.019095, loss_d: 0.712745
0.9996 --- loss: 2.141953, loss_ss: 1.770208, loss_d: 0.371745
Epoch finished! Loss: 1.7369470683427957
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.957987, loss_ss: 1.565071, loss_d: 0.392916
0.0384 --- loss: 1.526754, loss_ss: 0.964720, loss_d: 0.562035
0.0769 --- loss: 1.511942, loss_ss: 0.974260, loss_d: 0.537681
0.1153 --- loss: 1.571629, loss_ss: 1.014354, loss_d: 0.557275
0.1538 --- loss: 1.652681, loss_ss: 1.095726, loss_d: 0.556955
0.1922 --- loss: 1.859397, loss_ss: 0.984556, loss_d: 0.874841
0.2307 --- loss: 1.630490, loss_ss: 0.956146, loss_d: 0.674345
0.2691 --- loss: 1.727074, loss_ss: 0.929700, loss_d: 0.797374
0.3076 --- loss: 1.401918, loss_ss: 0.723889, loss_d: 0.678029
0.3460 --- loss: 1.626873, loss_ss: 0.995048, loss_d: 0.631825
0.3845 --- loss: 1.794299, loss_ss: 0.984701, loss_d: 0.809598
0.4229 --- loss: 1.354514, loss_ss: 0.984219, loss_d: 0.370295
0.4614 --- loss: 1.587689, loss_ss: 1.064860, loss_d: 0.522829
0.4998 --- loss: 1.177237, loss_ss: 0.812129, loss_d: 0.365108
0.5383 --- loss: 1.429309, loss_ss: 0.862915, loss_d: 0.566394
0.5767 --- loss: 1.586294, loss_ss: 1.220993, loss_d: 0.365301
0.6151 --- loss: 1.955699, loss_ss: 1.105969, loss_d: 0.849730
0.6536 --- loss: 1.764033, loss_ss: 1.353216, loss_d: 0.410817
0.6920 --- loss: 1.914234, loss_ss: 1.253272, loss_d: 0.660962
0.7305 --- loss: 1.220254, loss_ss: 0.807921, loss_d: 0.412333
0.7689 --- loss: 1.150183, loss_ss: 0.738288, loss_d: 0.411895
0.8074 --- loss: 1.839975, loss_ss: 0.898283, loss_d: 0.941692
0.8458 --- loss: 1.342766, loss_ss: 0.956582, loss_d: 0.386184
0.8843 --- loss: 1.537360, loss_ss: 0.943503, loss_d: 0.593857
0.9227 --- loss: 1.543910, loss_ss: 1.102137, loss_d: 0.441772
0.9612 --- loss: 1.849439, loss_ss: 1.158429, loss_d: 0.691011
0.9996 --- loss: 1.578223, loss_ss: 1.257869, loss_d: 0.320354
Epoch finished! Loss: 1.5886915284853715
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.635382, loss_ss: 0.969384, loss_d: 0.665998
0.0384 --- loss: 1.501150, loss_ss: 1.170382, loss_d: 0.330769
0.0769 --- loss: 1.623372, loss_ss: 1.154106, loss_d: 0.469266
0.1153 --- loss: 1.441390, loss_ss: 0.768940, loss_d: 0.672450
0.1538 --- loss: 1.115724, loss_ss: 0.716019, loss_d: 0.399705
0.1922 --- loss: 1.511347, loss_ss: 0.948023, loss_d: 0.563323
0.2307 --- loss: 1.502026, loss_ss: 1.030139, loss_d: 0.471887
0.2691 --- loss: 1.304031, loss_ss: 0.865448, loss_d: 0.438583
0.3076 --- loss: 1.482695, loss_ss: 0.986073, loss_d: 0.496622
0.3460 --- loss: 1.654252, loss_ss: 0.868104, loss_d: 0.786148
0.3845 --- loss: 1.420999, loss_ss: 0.799490, loss_d: 0.621509
0.4229 --- loss: 1.539878, loss_ss: 0.965021, loss_d: 0.574857
0.4614 --- loss: 1.414292, loss_ss: 1.033572, loss_d: 0.380720
0.4998 --- loss: 1.574989, loss_ss: 1.031054, loss_d: 0.543934
0.5383 --- loss: 1.471820, loss_ss: 1.127472, loss_d: 0.344348
0.5767 --- loss: 1.390189, loss_ss: 1.064266, loss_d: 0.325923
0.6151 --- loss: 1.774128, loss_ss: 0.735401, loss_d: 1.038728
0.6536 --- loss: 1.443026, loss_ss: 0.955830, loss_d: 0.487197
0.6920 --- loss: 1.578831, loss_ss: 0.828037, loss_d: 0.750795
0.7305 --- loss: 1.684047, loss_ss: 1.168967, loss_d: 0.515079
0.7689 --- loss: 1.457520, loss_ss: 0.772821, loss_d: 0.684699
0.8074 --- loss: 1.330842, loss_ss: 1.009574, loss_d: 0.321268
0.8458 --- loss: 1.378218, loss_ss: 0.823598, loss_d: 0.554620
0.8843 --- loss: 1.727497, loss_ss: 1.075256, loss_d: 0.652241
0.9227 --- loss: 1.144156, loss_ss: 0.853743, loss_d: 0.290413
0.9612 --- loss: 1.377977, loss_ss: 0.950354, loss_d: 0.427624
0.9996 --- loss: 1.521016, loss_ss: 1.335335, loss_d: 0.185681
Epoch finished! Loss: 1.4771324127912522
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.142943, loss_ss: 0.755501, loss_d: 0.387442
0.0384 --- loss: 1.412909, loss_ss: 0.772015, loss_d: 0.640894
0.0769 --- loss: 1.003200, loss_ss: 0.731107, loss_d: 0.272092
0.1153 --- loss: 1.638554, loss_ss: 1.009059, loss_d: 0.629495
0.1538 --- loss: 1.739799, loss_ss: 0.986629, loss_d: 0.753170
0.1922 --- loss: 1.504192, loss_ss: 1.175542, loss_d: 0.328650
0.2307 --- loss: 1.284179, loss_ss: 1.014724, loss_d: 0.269455
0.2691 --- loss: 1.009356, loss_ss: 0.702066, loss_d: 0.307289
0.3076 --- loss: 1.605522, loss_ss: 1.025355, loss_d: 0.580167
0.3460 --- loss: 1.256907, loss_ss: 0.754836, loss_d: 0.502071
0.3845 --- loss: 1.536679, loss_ss: 0.820409, loss_d: 0.716269
0.4229 --- loss: 1.493986, loss_ss: 1.115389, loss_d: 0.378597
0.4614 --- loss: 1.376858, loss_ss: 0.953496, loss_d: 0.423362
0.4998 --- loss: 1.245627, loss_ss: 0.739434, loss_d: 0.506193
0.5383 --- loss: 1.420319, loss_ss: 1.035894, loss_d: 0.384425
0.5767 --- loss: 1.442609, loss_ss: 0.888607, loss_d: 0.554003
0.6151 --- loss: 0.980510, loss_ss: 0.704854, loss_d: 0.275656
0.6536 --- loss: 1.312938, loss_ss: 0.976162, loss_d: 0.336776
0.6920 --- loss: 1.079938, loss_ss: 0.792746, loss_d: 0.287191
0.7305 --- loss: 1.213479, loss_ss: 1.017775, loss_d: 0.195703
0.7689 --- loss: 1.167152, loss_ss: 0.762582, loss_d: 0.404570
0.8074 --- loss: 1.956711, loss_ss: 1.240931, loss_d: 0.715779
0.8458 --- loss: 0.963143, loss_ss: 0.756402, loss_d: 0.206741
0.8843 --- loss: 1.491044, loss_ss: 0.978478, loss_d: 0.512565
0.9227 --- loss: 1.423216, loss_ss: 0.840466, loss_d: 0.582750
0.9612 --- loss: 1.308891, loss_ss: 1.052775, loss_d: 0.256116
0.9996 --- loss: 4.423953, loss_ss: 2.648616, loss_d: 1.775338
Epoch finished! Loss: 1.378192112308282
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.849429, loss_ss: 0.634624, loss_d: 0.214804
0.0384 --- loss: 1.229241, loss_ss: 0.894875, loss_d: 0.334366
0.0769 --- loss: 1.699658, loss_ss: 1.351020, loss_d: 0.348638
0.1153 --- loss: 1.354546, loss_ss: 0.911778, loss_d: 0.442767
0.1538 --- loss: 1.567055, loss_ss: 1.104689, loss_d: 0.462366
0.1922 --- loss: 1.317902, loss_ss: 0.810271, loss_d: 0.507631
0.2307 --- loss: 1.235251, loss_ss: 0.867406, loss_d: 0.367845
0.2691 --- loss: 1.545993, loss_ss: 1.053037, loss_d: 0.492956
0.3076 --- loss: 1.442369, loss_ss: 1.007630, loss_d: 0.434739
0.3460 --- loss: 1.347938, loss_ss: 0.557304, loss_d: 0.790634
0.3845 --- loss: 1.070122, loss_ss: 0.733594, loss_d: 0.336528
0.4229 --- loss: 1.222663, loss_ss: 0.671528, loss_d: 0.551136
0.4614 --- loss: 1.523907, loss_ss: 1.065422, loss_d: 0.458484
0.4998 --- loss: 1.357111, loss_ss: 1.193064, loss_d: 0.164047
0.5383 --- loss: 0.984200, loss_ss: 0.795310, loss_d: 0.188890
0.5767 --- loss: 1.997999, loss_ss: 1.127559, loss_d: 0.870439
0.6151 --- loss: 1.435187, loss_ss: 1.000906, loss_d: 0.434281
0.6536 --- loss: 1.295043, loss_ss: 0.844344, loss_d: 0.450698
0.6920 --- loss: 1.450533, loss_ss: 0.897040, loss_d: 0.553493
0.7305 --- loss: 1.283600, loss_ss: 0.983152, loss_d: 0.300449
0.7689 --- loss: 1.330549, loss_ss: 0.842182, loss_d: 0.488367
0.8074 --- loss: 1.270855, loss_ss: 0.875951, loss_d: 0.394904
0.8458 --- loss: 1.531322, loss_ss: 1.115610, loss_d: 0.415712
0.8843 --- loss: 1.142311, loss_ss: 0.768598, loss_d: 0.373713
0.9227 --- loss: 1.359653, loss_ss: 1.096912, loss_d: 0.262741
0.9612 --- loss: 2.090384, loss_ss: 1.145592, loss_d: 0.944792
0.9996 --- loss: 2.225906, loss_ss: 1.757080, loss_d: 0.468826
Epoch finished! Loss: 1.3060490323947027
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.098535, loss_ss: 0.865523, loss_d: 0.233012
0.0384 --- loss: 1.594560, loss_ss: 1.065532, loss_d: 0.529028
0.0769 --- loss: 1.448257, loss_ss: 0.998463, loss_d: 0.449795
0.1153 --- loss: 1.114396, loss_ss: 0.925269, loss_d: 0.189126
0.1538 --- loss: 1.520434, loss_ss: 1.287661, loss_d: 0.232773
0.1922 --- loss: 0.854879, loss_ss: 0.650400, loss_d: 0.204480
0.2307 --- loss: 1.043665, loss_ss: 0.873624, loss_d: 0.170041
0.2691 --- loss: 1.956347, loss_ss: 0.891478, loss_d: 1.064869
0.3076 --- loss: 1.092979, loss_ss: 0.796687, loss_d: 0.296293
0.3460 --- loss: 1.038398, loss_ss: 0.813542, loss_d: 0.224856
0.3845 --- loss: 1.274385, loss_ss: 0.867473, loss_d: 0.406913
0.4229 --- loss: 1.190826, loss_ss: 0.762000, loss_d: 0.428826
0.4614 --- loss: 1.073752, loss_ss: 0.810430, loss_d: 0.263322
0.4998 --- loss: 1.240778, loss_ss: 0.830621, loss_d: 0.410157
0.5383 --- loss: 1.173846, loss_ss: 0.727239, loss_d: 0.446606
0.5767 --- loss: 1.191556, loss_ss: 0.907738, loss_d: 0.283818
0.6151 --- loss: 0.953309, loss_ss: 0.727297, loss_d: 0.226011
0.6536 --- loss: 1.184996, loss_ss: 0.930519, loss_d: 0.254477
0.6920 --- loss: 1.169093, loss_ss: 1.034606, loss_d: 0.134487
0.7305 --- loss: 1.510418, loss_ss: 0.963405, loss_d: 0.547014
0.7689 --- loss: 1.004802, loss_ss: 0.744893, loss_d: 0.259908
0.8074 --- loss: 1.185005, loss_ss: 0.872074, loss_d: 0.312931
0.8458 --- loss: 0.944993, loss_ss: 0.758479, loss_d: 0.186513
0.8843 --- loss: 1.045983, loss_ss: 0.812257, loss_d: 0.233726
0.9227 --- loss: 1.100188, loss_ss: 0.739660, loss_d: 0.360528
0.9612 --- loss: 1.965138, loss_ss: 0.896440, loss_d: 1.068697
0.9996 --- loss: 2.226943, loss_ss: 0.749523, loss_d: 1.477420
Epoch finished! Loss: 1.2700132899559462
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.450917, loss_ss: 0.959734, loss_d: 0.491183
0.0384 --- loss: 1.097528, loss_ss: 0.862207, loss_d: 0.235321
0.0769 --- loss: 0.990555, loss_ss: 0.735283, loss_d: 0.255272
0.1153 --- loss: 1.276468, loss_ss: 0.719750, loss_d: 0.556718
0.1538 --- loss: 1.533550, loss_ss: 1.328198, loss_d: 0.205353
0.1922 --- loss: 1.245330, loss_ss: 0.880932, loss_d: 0.364398
0.2307 --- loss: 1.071571, loss_ss: 0.872073, loss_d: 0.199498
0.2691 --- loss: 0.831126, loss_ss: 0.642713, loss_d: 0.188413
0.3076 --- loss: 1.133503, loss_ss: 0.782274, loss_d: 0.351229
0.3460 --- loss: 1.205101, loss_ss: 0.946481, loss_d: 0.258620
0.3845 --- loss: 1.249009, loss_ss: 0.768122, loss_d: 0.480887
0.4229 --- loss: 1.363022, loss_ss: 0.997856, loss_d: 0.365166
0.4614 --- loss: 1.041795, loss_ss: 0.818343, loss_d: 0.223452
0.4998 --- loss: 1.108172, loss_ss: 0.807590, loss_d: 0.300582
0.5383 --- loss: 1.453435, loss_ss: 0.956696, loss_d: 0.496738
0.5767 --- loss: 1.202975, loss_ss: 0.853709, loss_d: 0.349266
0.6151 --- loss: 0.858102, loss_ss: 0.745066, loss_d: 0.113036
0.6536 --- loss: 1.140339, loss_ss: 0.875621, loss_d: 0.264718
0.6920 --- loss: 1.032851, loss_ss: 0.846356, loss_d: 0.186494
0.7305 --- loss: 1.920065, loss_ss: 0.838498, loss_d: 1.081567
0.7689 --- loss: 0.973484, loss_ss: 0.763227, loss_d: 0.210257
0.8074 --- loss: 1.264341, loss_ss: 1.000251, loss_d: 0.264090
0.8458 --- loss: 1.679965, loss_ss: 1.102931, loss_d: 0.577034
0.8843 --- loss: 1.550314, loss_ss: 1.194784, loss_d: 0.355531
0.9227 --- loss: 1.516895, loss_ss: 1.372512, loss_d: 0.144383
0.9612 --- loss: 1.032481, loss_ss: 0.886801, loss_d: 0.145680
0.9996 --- loss: 3.204216, loss_ss: 3.057870, loss_d: 0.146346
Epoch finished! Loss: 1.2478966628129666
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.908305, loss_ss: 0.741857, loss_d: 0.166448
0.0384 --- loss: 1.169599, loss_ss: 0.908158, loss_d: 0.261441
0.0769 --- loss: 1.227196, loss_ss: 1.051739, loss_d: 0.175457
0.1153 --- loss: 0.936069, loss_ss: 0.733860, loss_d: 0.202208
0.1538 --- loss: 1.261202, loss_ss: 0.852606, loss_d: 0.408597
0.1922 --- loss: 0.972563, loss_ss: 0.843220, loss_d: 0.129343
0.2307 --- loss: 0.984985, loss_ss: 0.662890, loss_d: 0.322095
0.2691 --- loss: 1.483026, loss_ss: 1.150823, loss_d: 0.332204
0.3076 --- loss: 1.309283, loss_ss: 1.095864, loss_d: 0.213419
0.3460 --- loss: 1.081777, loss_ss: 0.810579, loss_d: 0.271198
0.3845 --- loss: 1.331583, loss_ss: 1.070569, loss_d: 0.261014
0.4229 --- loss: 1.365524, loss_ss: 0.897550, loss_d: 0.467974
0.4614 --- loss: 1.192651, loss_ss: 0.793032, loss_d: 0.399619
0.4998 --- loss: 1.236530, loss_ss: 0.777308, loss_d: 0.459222
0.5383 --- loss: 1.172936, loss_ss: 0.741973, loss_d: 0.430963
0.5767 --- loss: 1.362341, loss_ss: 1.076260, loss_d: 0.286081
0.6151 --- loss: 0.979448, loss_ss: 0.792134, loss_d: 0.187314
0.6536 --- loss: 0.874723, loss_ss: 0.734989, loss_d: 0.139734
0.6920 --- loss: 1.475762, loss_ss: 0.898628, loss_d: 0.577134
0.7305 --- loss: 1.664756, loss_ss: 1.348163, loss_d: 0.316593
0.7689 --- loss: 0.915064, loss_ss: 0.644709, loss_d: 0.270355
0.8074 --- loss: 0.734388, loss_ss: 0.534379, loss_d: 0.200009
0.8458 --- loss: 1.303715, loss_ss: 0.972406, loss_d: 0.331309
0.8843 --- loss: 1.162879, loss_ss: 0.940302, loss_d: 0.222577
0.9227 --- loss: 1.118324, loss_ss: 0.874474, loss_d: 0.243850
0.9612 --- loss: 1.294446, loss_ss: 0.868990, loss_d: 0.425455
0.9996 --- loss: 1.541880, loss_ss: 1.419640, loss_d: 0.122241
Epoch finished! Loss: 1.188406252173277
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.328084, loss_ss: 0.793255, loss_d: 0.534830
0.0384 --- loss: 1.237258, loss_ss: 0.871030, loss_d: 0.366228
0.0769 --- loss: 1.339592, loss_ss: 1.096319, loss_d: 0.243273
0.1153 --- loss: 1.077571, loss_ss: 0.588072, loss_d: 0.489500
0.1538 --- loss: 1.255087, loss_ss: 0.986350, loss_d: 0.268737
0.1922 --- loss: 0.992272, loss_ss: 0.798238, loss_d: 0.194034
0.2307 --- loss: 0.885320, loss_ss: 0.758557, loss_d: 0.126762
0.2691 --- loss: 1.217337, loss_ss: 0.847038, loss_d: 0.370299
0.3076 --- loss: 1.418899, loss_ss: 0.615267, loss_d: 0.803633
0.3460 --- loss: 1.080360, loss_ss: 0.767102, loss_d: 0.313259
0.3845 --- loss: 1.221713, loss_ss: 0.653723, loss_d: 0.567990
0.4229 --- loss: 1.253095, loss_ss: 1.030702, loss_d: 0.222394
0.4614 --- loss: 1.374450, loss_ss: 0.817206, loss_d: 0.557244
0.4998 --- loss: 1.208582, loss_ss: 0.930696, loss_d: 0.277886
0.5383 --- loss: 1.234909, loss_ss: 0.882278, loss_d: 0.352631
0.5767 --- loss: 1.153094, loss_ss: 0.677309, loss_d: 0.475785
0.6151 --- loss: 0.922626, loss_ss: 0.691390, loss_d: 0.231235
0.6536 --- loss: 1.027464, loss_ss: 0.797724, loss_d: 0.229740
0.6920 --- loss: 1.487724, loss_ss: 1.287571, loss_d: 0.200153
0.7305 --- loss: 1.457151, loss_ss: 0.632640, loss_d: 0.824512
0.7689 --- loss: 0.938170, loss_ss: 0.858952, loss_d: 0.079218
0.8074 --- loss: 0.963651, loss_ss: 0.793614, loss_d: 0.170037
0.8458 --- loss: 0.876760, loss_ss: 0.739158, loss_d: 0.137603
0.8843 --- loss: 1.055854, loss_ss: 0.730276, loss_d: 0.325577
0.9227 --- loss: 1.611054, loss_ss: 1.208143, loss_d: 0.402911
0.9612 --- loss: 1.460665, loss_ss: 0.796012, loss_d: 0.664653
0.9996 --- loss: 5.250196, loss_ss: 1.703131, loss_d: 3.547064
Epoch finished! Loss: 1.207036864069792
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4261261261261261
             precision    recall  f1-score   support

        0.0       0.08      0.95      0.15        19
        1.0       0.53      0.12      0.19       355
        2.0       0.80      0.42      0.55       376
        3.0       0.98      0.71      0.83       199
        4.0       0.24      0.70      0.36       161

avg / total       0.65      0.43      0.45      1110
 


====== chp039-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.07  94.74   81.85   8.33     15.32
1  68.47  11.83   95.10  53.16     19.35
2  76.85  42.02   94.69  80.20     55.15
3  94.59  71.36   99.67  97.93     82.56
4  63.24  70.19   62.07  23.89     35.65
Total accuracy: 42.61%
Average sen: 58.03%
Average spec: 86.67%
Macro f1-score: 41.61%
[0.99945909 0.99979526 0.67351675 0.93641669 0.98846161 0.99892092
 0.99987686 0.99988985 0.99986732 0.99967611 0.99997127 0.99986494
 0.99961025 0.99919456 0.99787641 0.91904128 0.94499284 0.94816959
 0.99994886 0.99994588 0.99908328 0.99980694 0.99994802 0.9995172
 0.99849129 0.99953222 0.99995172 0.9998312  0.99992251 0.99871159
 0.9954645  0.99967182 0.99992633 0.99993908 0.99968421 0.99960393
 0.99937135]
pred: 0.9835933382446701, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.323540, loss_ss: 1.624990, loss_d: 0.698550
0.0384 --- loss: 2.131531, loss_ss: 1.413896, loss_d: 0.717634
0.0768 --- loss: 2.310259, loss_ss: 1.431959, loss_d: 0.878300
0.1153 --- loss: 1.921564, loss_ss: 1.355706, loss_d: 0.565858
0.1537 --- loss: 2.200877, loss_ss: 1.662040, loss_d: 0.538837
0.1921 --- loss: 1.992441, loss_ss: 1.475701, loss_d: 0.516740
0.2305 --- loss: 2.058216, loss_ss: 1.488962, loss_d: 0.569254
0.2689 --- loss: 1.918354, loss_ss: 1.400613, loss_d: 0.517740
0.3073 --- loss: 2.260186, loss_ss: 1.283723, loss_d: 0.976463
0.3458 --- loss: 1.780389, loss_ss: 1.383689, loss_d: 0.396700
0.3842 --- loss: 1.977359, loss_ss: 1.281129, loss_d: 0.696230
0.4226 --- loss: 1.959839, loss_ss: 1.543659, loss_d: 0.416180
0.4610 --- loss: 2.070734, loss_ss: 1.441321, loss_d: 0.629413
0.4994 --- loss: 2.043294, loss_ss: 1.482564, loss_d: 0.560731
0.5378 --- loss: 1.760235, loss_ss: 1.322266, loss_d: 0.437969
0.5763 --- loss: 1.774025, loss_ss: 1.124000, loss_d: 0.650025
0.6147 --- loss: 1.871519, loss_ss: 1.289385, loss_d: 0.582133
0.6531 --- loss: 1.719354, loss_ss: 1.152103, loss_d: 0.567251
0.6915 --- loss: 1.657897, loss_ss: 1.210180, loss_d: 0.447716
0.7299 --- loss: 2.239976, loss_ss: 1.279247, loss_d: 0.960729
0.7683 --- loss: 2.052747, loss_ss: 1.150865, loss_d: 0.901881
0.8068 --- loss: 1.891083, loss_ss: 1.225952, loss_d: 0.665131
0.8452 --- loss: 1.835711, loss_ss: 1.148062, loss_d: 0.687649
0.8836 --- loss: 2.021709, loss_ss: 1.362934, loss_d: 0.658775
0.9220 --- loss: 1.835205, loss_ss: 1.173250, loss_d: 0.661955
0.9604 --- loss: 1.766822, loss_ss: 1.151191, loss_d: 0.615631
0.9988 --- loss: 1.691124, loss_ss: 1.468989, loss_d: 0.222134
Epoch finished! Loss: 1.9643869179945725
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.636566, loss_ss: 1.118962, loss_d: 0.517604
0.0384 --- loss: 1.814872, loss_ss: 1.143620, loss_d: 0.671252
0.0768 --- loss: 1.568408, loss_ss: 1.176201, loss_d: 0.392207
0.1153 --- loss: 1.640620, loss_ss: 1.188573, loss_d: 0.452047
0.1537 --- loss: 2.091449, loss_ss: 1.430775, loss_d: 0.660674
0.1921 --- loss: 1.720368, loss_ss: 1.130565, loss_d: 0.589804
0.2305 --- loss: 1.722435, loss_ss: 0.976719, loss_d: 0.745716
0.2689 --- loss: 1.780827, loss_ss: 1.352850, loss_d: 0.427977
0.3073 --- loss: 1.578932, loss_ss: 0.959358, loss_d: 0.619573
0.3458 --- loss: 1.660674, loss_ss: 1.259662, loss_d: 0.401012
0.3842 --- loss: 1.634885, loss_ss: 0.944322, loss_d: 0.690563
0.4226 --- loss: 1.634773, loss_ss: 1.037740, loss_d: 0.597033
0.4610 --- loss: 1.533800, loss_ss: 1.096086, loss_d: 0.437714
0.4994 --- loss: 1.500318, loss_ss: 1.111378, loss_d: 0.388940
0.5378 --- loss: 1.509238, loss_ss: 0.911039, loss_d: 0.598198
0.5763 --- loss: 1.609336, loss_ss: 1.100049, loss_d: 0.509287
0.6147 --- loss: 1.842249, loss_ss: 1.203911, loss_d: 0.638338
0.6531 --- loss: 1.704416, loss_ss: 1.244640, loss_d: 0.459776
0.6915 --- loss: 1.595795, loss_ss: 1.072847, loss_d: 0.522948
0.7299 --- loss: 1.683996, loss_ss: 1.174466, loss_d: 0.509530
0.7683 --- loss: 1.404749, loss_ss: 0.866275, loss_d: 0.538474
0.8068 --- loss: 1.901043, loss_ss: 1.329365, loss_d: 0.571677
0.8452 --- loss: 1.633822, loss_ss: 0.978950, loss_d: 0.654872
0.8836 --- loss: 1.858264, loss_ss: 1.061873, loss_d: 0.796391
0.9220 --- loss: 2.119515, loss_ss: 1.532047, loss_d: 0.587468
0.9604 --- loss: 1.618785, loss_ss: 1.092215, loss_d: 0.526570
0.9988 --- loss: 1.549657, loss_ss: 1.160415, loss_d: 0.389242
Epoch finished! Loss: 1.7273432112657108
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.739333, loss_ss: 1.019042, loss_d: 0.720291
0.0384 --- loss: 1.750111, loss_ss: 1.228783, loss_d: 0.521328
0.0768 --- loss: 1.414698, loss_ss: 0.925700, loss_d: 0.488998
0.1153 --- loss: 1.462899, loss_ss: 0.810634, loss_d: 0.652266
0.1537 --- loss: 1.347819, loss_ss: 1.045917, loss_d: 0.301902
0.1921 --- loss: 2.254247, loss_ss: 1.572411, loss_d: 0.681837
0.2305 --- loss: 1.587335, loss_ss: 1.118035, loss_d: 0.469300
0.2689 --- loss: 1.506573, loss_ss: 0.924272, loss_d: 0.582301
0.3073 --- loss: 1.660934, loss_ss: 1.138195, loss_d: 0.522739
0.3458 --- loss: 1.636943, loss_ss: 1.050323, loss_d: 0.586620
0.3842 --- loss: 1.413229, loss_ss: 1.054132, loss_d: 0.359098
0.4226 --- loss: 1.576943, loss_ss: 0.915344, loss_d: 0.661600
0.4610 --- loss: 1.667356, loss_ss: 1.069517, loss_d: 0.597839
0.4994 --- loss: 1.493888, loss_ss: 0.854225, loss_d: 0.639663
0.5378 --- loss: 1.636861, loss_ss: 1.099733, loss_d: 0.537128
0.5763 --- loss: 1.712525, loss_ss: 1.111485, loss_d: 0.601040
0.6147 --- loss: 1.372366, loss_ss: 0.791043, loss_d: 0.581324
0.6531 --- loss: 1.403622, loss_ss: 0.942802, loss_d: 0.460821
0.6915 --- loss: 1.677590, loss_ss: 1.082589, loss_d: 0.595002
0.7299 --- loss: 1.686095, loss_ss: 1.037984, loss_d: 0.648110
0.7683 --- loss: 1.752650, loss_ss: 1.377564, loss_d: 0.375086
0.8068 --- loss: 1.613605, loss_ss: 0.997199, loss_d: 0.616407
0.8452 --- loss: 1.664545, loss_ss: 1.238920, loss_d: 0.425625
0.8836 --- loss: 1.363813, loss_ss: 0.998469, loss_d: 0.365344
0.9220 --- loss: 1.372251, loss_ss: 0.904853, loss_d: 0.467398
0.9604 --- loss: 1.274034, loss_ss: 0.880738, loss_d: 0.393296
0.9988 --- loss: 1.857019, loss_ss: 1.205988, loss_d: 0.651032
Epoch finished! Loss: 1.6053067876742437
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.346879, loss_ss: 0.941520, loss_d: 0.405359
0.0384 --- loss: 1.506867, loss_ss: 1.028495, loss_d: 0.478372
0.0768 --- loss: 1.218024, loss_ss: 0.833441, loss_d: 0.384584
0.1153 --- loss: 1.491667, loss_ss: 0.904181, loss_d: 0.587485
0.1537 --- loss: 1.258345, loss_ss: 0.841222, loss_d: 0.417123
0.1921 --- loss: 1.370171, loss_ss: 0.928414, loss_d: 0.441757
0.2305 --- loss: 1.635608, loss_ss: 1.022578, loss_d: 0.613031
0.2689 --- loss: 1.827160, loss_ss: 1.186015, loss_d: 0.641145
0.3073 --- loss: 1.776871, loss_ss: 1.299739, loss_d: 0.477132
0.3458 --- loss: 1.382128, loss_ss: 0.826659, loss_d: 0.555469
0.3842 --- loss: 1.195614, loss_ss: 0.874913, loss_d: 0.320702
0.4226 --- loss: 2.029507, loss_ss: 1.100873, loss_d: 0.928634
0.4610 --- loss: 1.290112, loss_ss: 0.877847, loss_d: 0.412265
0.4994 --- loss: 1.776711, loss_ss: 1.470048, loss_d: 0.306662
0.5378 --- loss: 1.782097, loss_ss: 0.926088, loss_d: 0.856009
0.5763 --- loss: 2.012311, loss_ss: 1.040543, loss_d: 0.971768
0.6147 --- loss: 1.475542, loss_ss: 0.803567, loss_d: 0.671975
0.6531 --- loss: 1.079773, loss_ss: 0.813325, loss_d: 0.266448
0.6915 --- loss: 1.906875, loss_ss: 0.957415, loss_d: 0.949459
0.7299 --- loss: 1.930843, loss_ss: 1.069370, loss_d: 0.861472
0.7683 --- loss: 1.615395, loss_ss: 1.215677, loss_d: 0.399718
0.8068 --- loss: 1.456587, loss_ss: 0.796158, loss_d: 0.660429
0.8452 --- loss: 1.505637, loss_ss: 1.009094, loss_d: 0.496542
0.8836 --- loss: 1.315201, loss_ss: 0.949004, loss_d: 0.366197
0.9220 --- loss: 1.388043, loss_ss: 1.050060, loss_d: 0.337983
0.9604 --- loss: 1.752021, loss_ss: 0.709799, loss_d: 1.042222
0.9988 --- loss: 1.651651, loss_ss: 1.286349, loss_d: 0.365302
Epoch finished! Loss: 1.5128854183050302
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.807699, loss_ss: 1.113949, loss_d: 0.693750
0.0384 --- loss: 1.908814, loss_ss: 1.342404, loss_d: 0.566410
0.0768 --- loss: 1.198657, loss_ss: 0.849141, loss_d: 0.349516
0.1153 --- loss: 1.149043, loss_ss: 0.807583, loss_d: 0.341460
0.1537 --- loss: 1.586504, loss_ss: 0.746763, loss_d: 0.839741
0.1921 --- loss: 1.399522, loss_ss: 0.967499, loss_d: 0.432023
0.2305 --- loss: 1.352647, loss_ss: 1.127814, loss_d: 0.224833
0.2689 --- loss: 1.442884, loss_ss: 1.099434, loss_d: 0.343451
0.3073 --- loss: 1.111231, loss_ss: 0.842147, loss_d: 0.269084
0.3458 --- loss: 1.461820, loss_ss: 0.853170, loss_d: 0.608650
0.3842 --- loss: 1.398776, loss_ss: 0.728549, loss_d: 0.670227
0.4226 --- loss: 1.656662, loss_ss: 1.067205, loss_d: 0.589457
0.4610 --- loss: 1.194558, loss_ss: 0.949772, loss_d: 0.244786
0.4994 --- loss: 1.499219, loss_ss: 1.149993, loss_d: 0.349226
0.5378 --- loss: 1.290422, loss_ss: 0.961570, loss_d: 0.328853
0.5763 --- loss: 1.432312, loss_ss: 0.875775, loss_d: 0.556538
0.6147 --- loss: 1.625096, loss_ss: 1.135214, loss_d: 0.489882
0.6531 --- loss: 1.535708, loss_ss: 0.900999, loss_d: 0.634709
0.6915 --- loss: 1.137100, loss_ss: 0.737113, loss_d: 0.399987
0.7299 --- loss: 1.285213, loss_ss: 0.989389, loss_d: 0.295824
0.7683 --- loss: 1.485832, loss_ss: 1.094538, loss_d: 0.391294
0.8068 --- loss: 1.024739, loss_ss: 0.787758, loss_d: 0.236981
0.8452 --- loss: 1.519345, loss_ss: 0.805970, loss_d: 0.713375
0.8836 --- loss: 0.968367, loss_ss: 0.644571, loss_d: 0.323796
0.9220 --- loss: 1.145729, loss_ss: 0.946263, loss_d: 0.199466
0.9604 --- loss: 1.121715, loss_ss: 0.803230, loss_d: 0.318485
0.9988 --- loss: 1.134638, loss_ss: 0.871175, loss_d: 0.263463
Epoch finished! Loss: 1.3824746106679624
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.329708, loss_ss: 0.935756, loss_d: 0.393953
0.0384 --- loss: 1.096283, loss_ss: 0.925376, loss_d: 0.170907
0.0768 --- loss: 1.333141, loss_ss: 0.769062, loss_d: 0.564079
0.1153 --- loss: 1.336557, loss_ss: 0.955989, loss_d: 0.380568
0.1537 --- loss: 1.300331, loss_ss: 0.821446, loss_d: 0.478885
0.1921 --- loss: 1.399388, loss_ss: 0.954442, loss_d: 0.444946
0.2305 --- loss: 1.192144, loss_ss: 0.736645, loss_d: 0.455498
0.2689 --- loss: 1.277075, loss_ss: 0.953638, loss_d: 0.323436
0.3073 --- loss: 2.198462, loss_ss: 1.532984, loss_d: 0.665478
0.3458 --- loss: 1.707761, loss_ss: 1.435758, loss_d: 0.272003
0.3842 --- loss: 1.337490, loss_ss: 0.774377, loss_d: 0.563113
0.4226 --- loss: 1.072256, loss_ss: 0.838729, loss_d: 0.233527
0.4610 --- loss: 1.261111, loss_ss: 0.888521, loss_d: 0.372590
0.4994 --- loss: 1.482827, loss_ss: 1.080157, loss_d: 0.402670
0.5378 --- loss: 1.735934, loss_ss: 1.150914, loss_d: 0.585020
0.5763 --- loss: 1.101477, loss_ss: 0.768955, loss_d: 0.332521
0.6147 --- loss: 1.233796, loss_ss: 1.032430, loss_d: 0.201366
0.6531 --- loss: 1.565792, loss_ss: 1.216537, loss_d: 0.349255
0.6915 --- loss: 1.452161, loss_ss: 0.917063, loss_d: 0.535098
0.7299 --- loss: 1.334573, loss_ss: 0.928635, loss_d: 0.405938
0.7683 --- loss: 1.043684, loss_ss: 0.844348, loss_d: 0.199336
0.8068 --- loss: 1.208550, loss_ss: 1.015071, loss_d: 0.193479
0.8452 --- loss: 1.559616, loss_ss: 0.748896, loss_d: 0.810720
0.8836 --- loss: 0.884970, loss_ss: 0.712189, loss_d: 0.172781
0.9220 --- loss: 1.157058, loss_ss: 0.739740, loss_d: 0.417317
0.9604 --- loss: 1.377027, loss_ss: 1.003151, loss_d: 0.373875
0.9988 --- loss: 2.281815, loss_ss: 0.560598, loss_d: 1.721216
Epoch finished! Loss: 1.3153154111825502
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.458912, loss_ss: 0.937478, loss_d: 0.521434
0.0384 --- loss: 1.416415, loss_ss: 0.629803, loss_d: 0.786612
0.0768 --- loss: 1.586875, loss_ss: 1.139813, loss_d: 0.447062
0.1153 --- loss: 1.402267, loss_ss: 0.825654, loss_d: 0.576613
0.1537 --- loss: 1.152340, loss_ss: 0.874712, loss_d: 0.277628
0.1921 --- loss: 1.224866, loss_ss: 0.856079, loss_d: 0.368788
0.2305 --- loss: 1.286953, loss_ss: 0.896631, loss_d: 0.390323
0.2689 --- loss: 1.332344, loss_ss: 1.102589, loss_d: 0.229754
0.3073 --- loss: 0.981524, loss_ss: 0.730251, loss_d: 0.251273
0.3458 --- loss: 1.601478, loss_ss: 1.229666, loss_d: 0.371812
0.3842 --- loss: 1.088100, loss_ss: 0.770204, loss_d: 0.317895
0.4226 --- loss: 1.407500, loss_ss: 0.926252, loss_d: 0.481248
0.4610 --- loss: 1.510183, loss_ss: 1.289421, loss_d: 0.220762
0.4994 --- loss: 1.297726, loss_ss: 1.048227, loss_d: 0.249499
0.5378 --- loss: 1.048848, loss_ss: 0.790251, loss_d: 0.258597
0.5763 --- loss: 1.040926, loss_ss: 0.790488, loss_d: 0.250438
0.6147 --- loss: 0.884374, loss_ss: 0.775452, loss_d: 0.108922
0.6531 --- loss: 0.869993, loss_ss: 0.700211, loss_d: 0.169782
0.6915 --- loss: 1.426173, loss_ss: 0.902021, loss_d: 0.524152
0.7299 --- loss: 1.030608, loss_ss: 0.779130, loss_d: 0.251479
0.7683 --- loss: 1.592449, loss_ss: 1.078757, loss_d: 0.513692
0.8068 --- loss: 1.058385, loss_ss: 0.695401, loss_d: 0.362984
0.8452 --- loss: 1.223101, loss_ss: 1.070996, loss_d: 0.152105
0.8836 --- loss: 1.488567, loss_ss: 0.954073, loss_d: 0.534493
0.9220 --- loss: 1.181799, loss_ss: 0.763252, loss_d: 0.418547
0.9604 --- loss: 1.110554, loss_ss: 0.715795, loss_d: 0.394759
0.9988 --- loss: 1.633538, loss_ss: 0.894540, loss_d: 0.738998
Epoch finished! Loss: 1.2476493874421486
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.408349, loss_ss: 0.877093, loss_d: 0.531256
0.0384 --- loss: 0.931071, loss_ss: 0.777732, loss_d: 0.153339
0.0768 --- loss: 1.390390, loss_ss: 1.091821, loss_d: 0.298569
0.1153 --- loss: 1.405600, loss_ss: 0.963570, loss_d: 0.442031
0.1537 --- loss: 1.027474, loss_ss: 0.884269, loss_d: 0.143204
0.1921 --- loss: 1.265287, loss_ss: 1.069389, loss_d: 0.195899
0.2305 --- loss: 1.564430, loss_ss: 1.051324, loss_d: 0.513106
0.2689 --- loss: 1.161584, loss_ss: 0.893968, loss_d: 0.267616
0.3073 --- loss: 1.012055, loss_ss: 0.807107, loss_d: 0.204948
0.3458 --- loss: 1.145220, loss_ss: 0.719659, loss_d: 0.425560
0.3842 --- loss: 1.208044, loss_ss: 0.939715, loss_d: 0.268329
0.4226 --- loss: 0.890991, loss_ss: 0.640527, loss_d: 0.250465
0.4610 --- loss: 1.266322, loss_ss: 1.103644, loss_d: 0.162678
0.4994 --- loss: 0.734759, loss_ss: 0.606425, loss_d: 0.128334
0.5378 --- loss: 1.046070, loss_ss: 0.830839, loss_d: 0.215231
0.5763 --- loss: 1.157027, loss_ss: 0.816585, loss_d: 0.340442
0.6147 --- loss: 0.828093, loss_ss: 0.610910, loss_d: 0.217184
0.6531 --- loss: 1.147617, loss_ss: 0.729851, loss_d: 0.417766
0.6915 --- loss: 1.390382, loss_ss: 1.215775, loss_d: 0.174607
0.7299 --- loss: 1.027569, loss_ss: 0.934736, loss_d: 0.092834
0.7683 --- loss: 1.452006, loss_ss: 0.960564, loss_d: 0.491443
0.8068 --- loss: 1.055660, loss_ss: 0.807885, loss_d: 0.247776
0.8452 --- loss: 1.119998, loss_ss: 0.929648, loss_d: 0.190350
0.8836 --- loss: 1.247112, loss_ss: 0.767285, loss_d: 0.479827
0.9220 --- loss: 1.313226, loss_ss: 0.946048, loss_d: 0.367177
0.9604 --- loss: 1.347191, loss_ss: 0.769906, loss_d: 0.577285
0.9988 --- loss: 1.239745, loss_ss: 1.139671, loss_d: 0.100075
Epoch finished! Loss: 1.226670114352153
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.864573, loss_ss: 0.735534, loss_d: 0.129039
0.0384 --- loss: 0.819405, loss_ss: 0.565867, loss_d: 0.253537
0.0768 --- loss: 0.893362, loss_ss: 0.720750, loss_d: 0.172612
0.1153 --- loss: 1.267444, loss_ss: 1.019564, loss_d: 0.247880
0.1537 --- loss: 2.192471, loss_ss: 0.941328, loss_d: 1.251143
0.1921 --- loss: 1.377763, loss_ss: 1.064906, loss_d: 0.312858
0.2305 --- loss: 1.234242, loss_ss: 0.683971, loss_d: 0.550271
0.2689 --- loss: 0.818792, loss_ss: 0.567511, loss_d: 0.251281
0.3073 --- loss: 1.072476, loss_ss: 0.777176, loss_d: 0.295299
0.3458 --- loss: 1.225356, loss_ss: 0.893684, loss_d: 0.331673
0.3842 --- loss: 1.166458, loss_ss: 0.777141, loss_d: 0.389317
0.4226 --- loss: 1.181210, loss_ss: 0.820808, loss_d: 0.360403
0.4610 --- loss: 1.373229, loss_ss: 1.029317, loss_d: 0.343912
0.4994 --- loss: 0.980370, loss_ss: 0.824558, loss_d: 0.155812
0.5378 --- loss: 1.012853, loss_ss: 0.869078, loss_d: 0.143774
0.5763 --- loss: 0.862271, loss_ss: 0.792610, loss_d: 0.069661
0.6147 --- loss: 1.205852, loss_ss: 1.082493, loss_d: 0.123359
0.6531 --- loss: 0.861595, loss_ss: 0.764293, loss_d: 0.097302
0.6915 --- loss: 0.809600, loss_ss: 0.669409, loss_d: 0.140191
0.7299 --- loss: 1.279344, loss_ss: 0.814960, loss_d: 0.464384
0.7683 --- loss: 1.396317, loss_ss: 0.818406, loss_d: 0.577910
0.8068 --- loss: 1.486682, loss_ss: 0.992393, loss_d: 0.494289
0.8452 --- loss: 0.972881, loss_ss: 0.780751, loss_d: 0.192130
0.8836 --- loss: 0.882911, loss_ss: 0.680160, loss_d: 0.202751
0.9220 --- loss: 0.994650, loss_ss: 0.794102, loss_d: 0.200547
0.9604 --- loss: 0.984521, loss_ss: 0.836726, loss_d: 0.147795
0.9988 --- loss: 1.023059, loss_ss: 0.950964, loss_d: 0.072095
Epoch finished! Loss: 1.1776070814866286
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.232080, loss_ss: 0.911094, loss_d: 0.320987
0.0384 --- loss: 0.989537, loss_ss: 0.769788, loss_d: 0.219748
0.0768 --- loss: 1.123458, loss_ss: 0.666754, loss_d: 0.456703
0.1153 --- loss: 1.347103, loss_ss: 0.982665, loss_d: 0.364438
0.1537 --- loss: 1.035030, loss_ss: 0.739161, loss_d: 0.295869
0.1921 --- loss: 1.029453, loss_ss: 0.844036, loss_d: 0.185417
0.2305 --- loss: 1.396650, loss_ss: 1.096576, loss_d: 0.300074
0.2689 --- loss: 1.270335, loss_ss: 0.968706, loss_d: 0.301629
0.3073 --- loss: 0.852931, loss_ss: 0.701531, loss_d: 0.151399
0.3458 --- loss: 1.520612, loss_ss: 0.913244, loss_d: 0.607368
0.3842 --- loss: 1.271622, loss_ss: 0.890042, loss_d: 0.381580
0.4226 --- loss: 0.974154, loss_ss: 0.825229, loss_d: 0.148925
0.4610 --- loss: 1.286219, loss_ss: 0.877973, loss_d: 0.408245
0.4994 --- loss: 1.293968, loss_ss: 0.962455, loss_d: 0.331513
0.5378 --- loss: 1.137646, loss_ss: 0.862994, loss_d: 0.274651
0.5763 --- loss: 1.011434, loss_ss: 0.833596, loss_d: 0.177839
0.6147 --- loss: 0.966583, loss_ss: 0.845552, loss_d: 0.121031
0.6531 --- loss: 1.191827, loss_ss: 0.927007, loss_d: 0.264820
0.6915 --- loss: 1.211411, loss_ss: 0.831251, loss_d: 0.380160
0.7299 --- loss: 0.995469, loss_ss: 0.749796, loss_d: 0.245673
0.7683 --- loss: 1.264988, loss_ss: 1.004512, loss_d: 0.260476
0.8068 --- loss: 1.032316, loss_ss: 0.750331, loss_d: 0.281985
0.8452 --- loss: 1.355868, loss_ss: 1.013996, loss_d: 0.341873
0.8836 --- loss: 0.682556, loss_ss: 0.497811, loss_d: 0.184745
0.9220 --- loss: 0.989119, loss_ss: 0.703473, loss_d: 0.285647
0.9604 --- loss: 0.988845, loss_ss: 0.786678, loss_d: 0.202167
0.9988 --- loss: 1.401555, loss_ss: 1.324674, loss_d: 0.076881
Epoch finished! Loss: 1.1573097325288333
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7390476190476191
             precision    recall  f1-score   support

        0.0       0.98      0.67      0.80       163
        1.0       0.57      0.11      0.19       142
        2.0       0.65      0.94      0.77       329
        3.0       0.91      0.74      0.82       200
        4.0       0.72      0.88      0.79       216

avg / total       0.75      0.74      0.71      1050
 


====== chp040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.76  67.48   99.77  98.21     80.00
1  86.86  11.27   98.68  57.14     18.82
2  82.00  94.22   76.42  64.58     76.64
3  93.71  74.50   98.24  90.85     81.87
4  90.48  88.43   91.01  71.80     79.25
Total accuracy: 73.90%
Average sen: 67.18%
Average spec: 92.82%
Macro f1-score: 67.32%
[0.99982601 0.98889434 0.96965349 0.98645926 0.85538965 0.998806
 0.99735945 0.99560732 0.99810743 0.99893111 0.99554634 0.98319536
 0.99894577 0.99885464 0.99842823 0.99705756 0.97755069 0.97644073
 0.88742423 0.99831355 0.97801375 0.99397004 0.99901557 0.9994216
 0.99413389 0.8765071  0.92745203 0.96521443 0.9642548  0.96003014
 0.91794407 0.86316049 0.99080187 0.99842668 0.99920928]
pred: 0.9722384827477591, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.425932, loss_ss: 1.738498, loss_d: 0.687434
0.0384 --- loss: 2.123596, loss_ss: 1.532137, loss_d: 0.591460
0.0769 --- loss: 2.587382, loss_ss: 1.407301, loss_d: 1.180081
0.1153 --- loss: 2.068114, loss_ss: 1.432226, loss_d: 0.635888
0.1537 --- loss: 1.885805, loss_ss: 1.338825, loss_d: 0.546980
0.1922 --- loss: 1.644282, loss_ss: 1.306497, loss_d: 0.337785
0.2306 --- loss: 2.106495, loss_ss: 1.350255, loss_d: 0.756240
0.2690 --- loss: 2.041219, loss_ss: 1.311934, loss_d: 0.729285
0.3075 --- loss: 1.943224, loss_ss: 1.224635, loss_d: 0.718590
0.3459 --- loss: 1.685079, loss_ss: 1.289031, loss_d: 0.396048
0.3843 --- loss: 1.918090, loss_ss: 1.397108, loss_d: 0.520982
0.4228 --- loss: 1.821549, loss_ss: 1.203002, loss_d: 0.618547
0.4612 --- loss: 1.884189, loss_ss: 1.265513, loss_d: 0.618677
0.4996 --- loss: 2.043042, loss_ss: 1.231229, loss_d: 0.811813
0.5380 --- loss: 1.730562, loss_ss: 1.210700, loss_d: 0.519862
0.5765 --- loss: 1.890975, loss_ss: 1.195015, loss_d: 0.695960
0.6149 --- loss: 1.970253, loss_ss: 1.296074, loss_d: 0.674178
0.6533 --- loss: 1.755867, loss_ss: 1.292307, loss_d: 0.463560
0.6918 --- loss: 1.776407, loss_ss: 1.287624, loss_d: 0.488783
0.7302 --- loss: 2.027585, loss_ss: 1.420331, loss_d: 0.607254
0.7686 --- loss: 2.348618, loss_ss: 1.518924, loss_d: 0.829695
0.8071 --- loss: 1.929364, loss_ss: 1.255076, loss_d: 0.674288
0.8455 --- loss: 1.794259, loss_ss: 1.145170, loss_d: 0.649089
0.8839 --- loss: 1.627657, loss_ss: 1.003613, loss_d: 0.624044
0.9224 --- loss: 1.665460, loss_ss: 1.192700, loss_d: 0.472760
0.9608 --- loss: 1.662044, loss_ss: 1.095901, loss_d: 0.566143
0.9992 --- loss: 1.438637, loss_ss: 1.185995, loss_d: 0.252642
Epoch finished! Loss: 1.8773632572247432
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.730026, loss_ss: 1.315635, loss_d: 0.414391
0.0384 --- loss: 1.601423, loss_ss: 1.112943, loss_d: 0.488480
0.0769 --- loss: 1.869389, loss_ss: 1.107507, loss_d: 0.761882
0.1153 --- loss: 1.819724, loss_ss: 1.273701, loss_d: 0.546023
0.1537 --- loss: 1.494265, loss_ss: 1.006356, loss_d: 0.487909
0.1922 --- loss: 1.681736, loss_ss: 1.268694, loss_d: 0.413042
0.2306 --- loss: 1.589601, loss_ss: 1.002262, loss_d: 0.587338
0.2690 --- loss: 1.928409, loss_ss: 1.155937, loss_d: 0.772471
0.3075 --- loss: 1.632360, loss_ss: 0.987169, loss_d: 0.645190
0.3459 --- loss: 1.713241, loss_ss: 1.130820, loss_d: 0.582420
0.3843 --- loss: 1.629548, loss_ss: 1.284666, loss_d: 0.344882
0.4228 --- loss: 1.741679, loss_ss: 1.149686, loss_d: 0.591993
0.4612 --- loss: 1.705373, loss_ss: 1.112337, loss_d: 0.593036
0.4996 --- loss: 1.985284, loss_ss: 1.265232, loss_d: 0.720052
0.5380 --- loss: 1.485801, loss_ss: 0.898061, loss_d: 0.587740
0.5765 --- loss: 1.553553, loss_ss: 0.882645, loss_d: 0.670908
0.6149 --- loss: 1.650914, loss_ss: 1.249401, loss_d: 0.401513
0.6533 --- loss: 1.364099, loss_ss: 0.821834, loss_d: 0.542264
0.6918 --- loss: 1.656528, loss_ss: 1.166855, loss_d: 0.489673
0.7302 --- loss: 1.433754, loss_ss: 1.009763, loss_d: 0.423991
0.7686 --- loss: 1.508281, loss_ss: 0.929441, loss_d: 0.578840
0.8071 --- loss: 1.589042, loss_ss: 0.945413, loss_d: 0.643630
0.8455 --- loss: 1.452122, loss_ss: 0.986008, loss_d: 0.466114
0.8839 --- loss: 1.700546, loss_ss: 1.204143, loss_d: 0.496403
0.9224 --- loss: 1.488508, loss_ss: 0.843636, loss_d: 0.644873
0.9608 --- loss: 1.729461, loss_ss: 1.133635, loss_d: 0.595827
0.9992 --- loss: 1.936379, loss_ss: 1.536217, loss_d: 0.400162
Epoch finished! Loss: 1.6700167555075425
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.876637, loss_ss: 1.184150, loss_d: 0.692487
0.0384 --- loss: 1.656512, loss_ss: 0.854702, loss_d: 0.801810
0.0769 --- loss: 1.533445, loss_ss: 1.013288, loss_d: 0.520157
0.1153 --- loss: 1.595140, loss_ss: 0.908111, loss_d: 0.687029
0.1537 --- loss: 1.609223, loss_ss: 1.062441, loss_d: 0.546782
0.1922 --- loss: 1.393353, loss_ss: 0.850343, loss_d: 0.543010
0.2306 --- loss: 1.522238, loss_ss: 0.930016, loss_d: 0.592222
0.2690 --- loss: 1.337625, loss_ss: 0.968727, loss_d: 0.368898
0.3075 --- loss: 1.601367, loss_ss: 1.142088, loss_d: 0.459279
0.3459 --- loss: 1.631754, loss_ss: 1.187149, loss_d: 0.444605
0.3843 --- loss: 1.442903, loss_ss: 1.043700, loss_d: 0.399202
0.4228 --- loss: 1.667517, loss_ss: 1.035778, loss_d: 0.631739
0.4612 --- loss: 1.791701, loss_ss: 1.167541, loss_d: 0.624160
0.4996 --- loss: 1.660991, loss_ss: 0.998009, loss_d: 0.662982
0.5380 --- loss: 1.308955, loss_ss: 0.959575, loss_d: 0.349379
0.5765 --- loss: 1.821652, loss_ss: 1.053566, loss_d: 0.768086
0.6149 --- loss: 2.157543, loss_ss: 1.404424, loss_d: 0.753119
0.6533 --- loss: 1.398234, loss_ss: 0.879093, loss_d: 0.519140
0.6918 --- loss: 1.750758, loss_ss: 1.020620, loss_d: 0.730138
0.7302 --- loss: 1.847618, loss_ss: 0.959501, loss_d: 0.888116
0.7686 --- loss: 1.401510, loss_ss: 0.931990, loss_d: 0.469521
0.8071 --- loss: 1.524272, loss_ss: 0.973367, loss_d: 0.550905
0.8455 --- loss: 1.626365, loss_ss: 0.845117, loss_d: 0.781248
0.8839 --- loss: 1.648587, loss_ss: 0.925244, loss_d: 0.723343
0.9224 --- loss: 1.651570, loss_ss: 0.991058, loss_d: 0.660513
0.9608 --- loss: 1.242285, loss_ss: 0.795656, loss_d: 0.446629
0.9992 --- loss: 1.879171, loss_ss: 1.567877, loss_d: 0.311294
Epoch finished! Loss: 1.5910323179685153
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.451760, loss_ss: 0.926839, loss_d: 0.524922
0.0384 --- loss: 1.350474, loss_ss: 0.758822, loss_d: 0.591652
0.0769 --- loss: 1.494596, loss_ss: 0.831211, loss_d: 0.663385
0.1153 --- loss: 1.301957, loss_ss: 0.853921, loss_d: 0.448036
0.1537 --- loss: 1.496529, loss_ss: 0.962271, loss_d: 0.534258
0.1922 --- loss: 1.410028, loss_ss: 0.887205, loss_d: 0.522824
0.2306 --- loss: 1.853139, loss_ss: 1.447381, loss_d: 0.405759
0.2690 --- loss: 1.536367, loss_ss: 0.910746, loss_d: 0.625621
0.3075 --- loss: 1.825391, loss_ss: 0.929949, loss_d: 0.895442
0.3459 --- loss: 1.736998, loss_ss: 1.132405, loss_d: 0.604593
0.3843 --- loss: 1.965685, loss_ss: 1.087989, loss_d: 0.877696
0.4228 --- loss: 1.060563, loss_ss: 0.743266, loss_d: 0.317297
0.4612 --- loss: 1.304982, loss_ss: 0.726919, loss_d: 0.578064
0.4996 --- loss: 1.254650, loss_ss: 0.851707, loss_d: 0.402944
0.5380 --- loss: 1.437899, loss_ss: 0.724921, loss_d: 0.712978
0.5765 --- loss: 1.432927, loss_ss: 0.919608, loss_d: 0.513319
0.6149 --- loss: 1.426673, loss_ss: 0.920133, loss_d: 0.506540
0.6533 --- loss: 1.280160, loss_ss: 0.933102, loss_d: 0.347058
0.6918 --- loss: 1.399103, loss_ss: 0.859979, loss_d: 0.539123
0.7302 --- loss: 1.582066, loss_ss: 1.066444, loss_d: 0.515622
0.7686 --- loss: 1.616471, loss_ss: 0.913951, loss_d: 0.702520
0.8071 --- loss: 1.883378, loss_ss: 1.116294, loss_d: 0.767084
0.8455 --- loss: 1.380740, loss_ss: 0.851949, loss_d: 0.528791
0.8839 --- loss: 1.801131, loss_ss: 0.878909, loss_d: 0.922222
0.9224 --- loss: 1.295371, loss_ss: 0.885751, loss_d: 0.409619
0.9608 --- loss: 1.061223, loss_ss: 0.749785, loss_d: 0.311438
0.9992 --- loss: 1.306874, loss_ss: 0.788183, loss_d: 0.518691
Epoch finished! Loss: 1.5238635159455813
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.645764, loss_ss: 0.941872, loss_d: 0.703892
0.0384 --- loss: 1.389784, loss_ss: 0.992650, loss_d: 0.397134
0.0769 --- loss: 1.416973, loss_ss: 0.939562, loss_d: 0.477411
0.1153 --- loss: 1.199789, loss_ss: 0.852638, loss_d: 0.347151
0.1537 --- loss: 1.059746, loss_ss: 0.742740, loss_d: 0.317007
0.1922 --- loss: 1.020402, loss_ss: 0.680337, loss_d: 0.340065
0.2306 --- loss: 1.779238, loss_ss: 1.111615, loss_d: 0.667624
0.2690 --- loss: 1.830951, loss_ss: 1.313002, loss_d: 0.517950
0.3075 --- loss: 1.879650, loss_ss: 1.332387, loss_d: 0.547263
0.3459 --- loss: 1.788496, loss_ss: 1.091149, loss_d: 0.697347
0.3843 --- loss: 1.385936, loss_ss: 0.684574, loss_d: 0.701362
0.4228 --- loss: 1.544649, loss_ss: 0.982906, loss_d: 0.561743
0.4612 --- loss: 1.068894, loss_ss: 0.680426, loss_d: 0.388468
0.4996 --- loss: 1.597443, loss_ss: 0.997946, loss_d: 0.599498
0.5380 --- loss: 1.521412, loss_ss: 1.107258, loss_d: 0.414154
0.5765 --- loss: 1.291759, loss_ss: 1.000327, loss_d: 0.291432
0.6149 --- loss: 1.764852, loss_ss: 0.853953, loss_d: 0.910899
0.6533 --- loss: 1.292529, loss_ss: 0.847159, loss_d: 0.445370
0.6918 --- loss: 1.373514, loss_ss: 1.095604, loss_d: 0.277910
0.7302 --- loss: 1.345160, loss_ss: 0.987988, loss_d: 0.357172
0.7686 --- loss: 1.514721, loss_ss: 0.698854, loss_d: 0.815866
0.8071 --- loss: 1.578264, loss_ss: 0.899783, loss_d: 0.678481
0.8455 --- loss: 1.483402, loss_ss: 0.908951, loss_d: 0.574451
0.8839 --- loss: 1.316719, loss_ss: 0.991211, loss_d: 0.325508
0.9224 --- loss: 1.875395, loss_ss: 1.158966, loss_d: 0.716429
0.9608 --- loss: 1.838658, loss_ss: 1.098059, loss_d: 0.740600
0.9992 --- loss: 1.672432, loss_ss: 1.366921, loss_d: 0.305512
Epoch finished! Loss: 1.4561994777275966
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.589055, loss_ss: 0.808716, loss_d: 0.780338
0.0384 --- loss: 1.514467, loss_ss: 1.159808, loss_d: 0.354659
0.0769 --- loss: 1.498628, loss_ss: 0.692962, loss_d: 0.805666
0.1153 --- loss: 1.559622, loss_ss: 1.064373, loss_d: 0.495249
0.1537 --- loss: 1.197065, loss_ss: 0.953123, loss_d: 0.243942
0.1922 --- loss: 1.096327, loss_ss: 0.886485, loss_d: 0.209842
0.2306 --- loss: 1.295488, loss_ss: 0.779265, loss_d: 0.516223
0.2690 --- loss: 1.239521, loss_ss: 0.830233, loss_d: 0.409288
0.3075 --- loss: 1.606192, loss_ss: 1.070858, loss_d: 0.535334
0.3459 --- loss: 1.281808, loss_ss: 0.895583, loss_d: 0.386226
0.3843 --- loss: 1.310956, loss_ss: 0.899391, loss_d: 0.411564
0.4228 --- loss: 1.395378, loss_ss: 0.989077, loss_d: 0.406302
0.4612 --- loss: 1.377612, loss_ss: 0.972538, loss_d: 0.405074
0.4996 --- loss: 1.142512, loss_ss: 0.738323, loss_d: 0.404189
0.5380 --- loss: 0.877881, loss_ss: 0.584064, loss_d: 0.293817
0.5765 --- loss: 1.090761, loss_ss: 0.607829, loss_d: 0.482932
0.6149 --- loss: 1.142482, loss_ss: 0.778745, loss_d: 0.363738
0.6533 --- loss: 1.561166, loss_ss: 0.967411, loss_d: 0.593755
0.6918 --- loss: 1.209662, loss_ss: 0.833686, loss_d: 0.375977
0.7302 --- loss: 1.243662, loss_ss: 0.938736, loss_d: 0.304926
0.7686 --- loss: 0.926785, loss_ss: 0.623583, loss_d: 0.303202
0.8071 --- loss: 1.400346, loss_ss: 0.860592, loss_d: 0.539754
0.8455 --- loss: 0.945576, loss_ss: 0.681552, loss_d: 0.264024
0.8839 --- loss: 1.289601, loss_ss: 0.988650, loss_d: 0.300950
0.9224 --- loss: 1.647042, loss_ss: 1.067386, loss_d: 0.579656
0.9608 --- loss: 0.910562, loss_ss: 0.621943, loss_d: 0.288619
0.9992 --- loss: 3.191585, loss_ss: 0.652738, loss_d: 2.538847
Epoch finished! Loss: 1.3448212953714225
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.934819, loss_ss: 0.785163, loss_d: 0.149656
0.0384 --- loss: 1.418019, loss_ss: 0.921547, loss_d: 0.496472
0.0769 --- loss: 0.881669, loss_ss: 0.689850, loss_d: 0.191819
0.1153 --- loss: 0.819365, loss_ss: 0.525170, loss_d: 0.294195
0.1537 --- loss: 0.930059, loss_ss: 0.699243, loss_d: 0.230816
0.1922 --- loss: 1.516463, loss_ss: 0.957168, loss_d: 0.559295
0.2306 --- loss: 1.500988, loss_ss: 0.840686, loss_d: 0.660303
0.2690 --- loss: 1.214234, loss_ss: 0.750291, loss_d: 0.463943
0.3075 --- loss: 0.921764, loss_ss: 0.753866, loss_d: 0.167898
0.3459 --- loss: 1.392329, loss_ss: 0.936865, loss_d: 0.455464
0.3843 --- loss: 1.481694, loss_ss: 1.162431, loss_d: 0.319263
0.4228 --- loss: 1.705261, loss_ss: 1.359670, loss_d: 0.345590
0.4612 --- loss: 1.255931, loss_ss: 0.889411, loss_d: 0.366519
0.4996 --- loss: 1.702667, loss_ss: 0.829781, loss_d: 0.872886
0.5380 --- loss: 1.695137, loss_ss: 0.813025, loss_d: 0.882112
0.5765 --- loss: 1.285651, loss_ss: 0.840799, loss_d: 0.444851
0.6149 --- loss: 1.472512, loss_ss: 0.938957, loss_d: 0.533555
0.6533 --- loss: 1.179124, loss_ss: 0.887590, loss_d: 0.291535
0.6918 --- loss: 0.947060, loss_ss: 0.723241, loss_d: 0.223819
0.7302 --- loss: 1.065372, loss_ss: 0.923522, loss_d: 0.141851
0.7686 --- loss: 1.187328, loss_ss: 0.922172, loss_d: 0.265156
0.8071 --- loss: 1.380317, loss_ss: 1.071598, loss_d: 0.308719
0.8455 --- loss: 1.032694, loss_ss: 0.843168, loss_d: 0.189527
0.8839 --- loss: 1.022990, loss_ss: 0.782268, loss_d: 0.240723
0.9224 --- loss: 1.567327, loss_ss: 1.286312, loss_d: 0.281015
0.9608 --- loss: 1.334188, loss_ss: 0.898227, loss_d: 0.435961
0.9992 --- loss: 2.313207, loss_ss: 1.921231, loss_d: 0.391976
Epoch finished! Loss: 1.3006519929720806
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.275311, loss_ss: 0.918982, loss_d: 0.356329
0.0384 --- loss: 0.998109, loss_ss: 0.721951, loss_d: 0.276158
0.0769 --- loss: 1.470413, loss_ss: 1.298674, loss_d: 0.171739
0.1153 --- loss: 0.988176, loss_ss: 0.790591, loss_d: 0.197585
0.1537 --- loss: 0.994177, loss_ss: 0.774991, loss_d: 0.219186
0.1922 --- loss: 1.321484, loss_ss: 0.881151, loss_d: 0.440334
0.2306 --- loss: 1.024383, loss_ss: 0.704407, loss_d: 0.319976
0.2690 --- loss: 1.066101, loss_ss: 0.908966, loss_d: 0.157135
0.3075 --- loss: 1.173691, loss_ss: 0.883340, loss_d: 0.290351
0.3459 --- loss: 1.244795, loss_ss: 1.072199, loss_d: 0.172596
0.3843 --- loss: 1.286389, loss_ss: 0.879410, loss_d: 0.406979
0.4228 --- loss: 1.498779, loss_ss: 0.663269, loss_d: 0.835511
0.4612 --- loss: 1.459240, loss_ss: 0.974135, loss_d: 0.485105
0.4996 --- loss: 1.502198, loss_ss: 0.807161, loss_d: 0.695037
0.5380 --- loss: 1.313317, loss_ss: 0.946101, loss_d: 0.367216
0.5765 --- loss: 1.405088, loss_ss: 0.952049, loss_d: 0.453039
0.6149 --- loss: 1.445618, loss_ss: 1.024459, loss_d: 0.421159
0.6533 --- loss: 1.348581, loss_ss: 0.552063, loss_d: 0.796517
0.6918 --- loss: 0.848782, loss_ss: 0.680416, loss_d: 0.168366
0.7302 --- loss: 1.029428, loss_ss: 0.811590, loss_d: 0.217838
0.7686 --- loss: 0.949829, loss_ss: 0.764743, loss_d: 0.185087
0.8071 --- loss: 0.977477, loss_ss: 0.776075, loss_d: 0.201402
0.8455 --- loss: 1.145406, loss_ss: 0.770502, loss_d: 0.374904
0.8839 --- loss: 1.194638, loss_ss: 0.887467, loss_d: 0.307171
0.9224 --- loss: 1.831717, loss_ss: 1.357734, loss_d: 0.473983
0.9608 --- loss: 1.267240, loss_ss: 0.789551, loss_d: 0.477689
0.9992 --- loss: 1.444498, loss_ss: 0.968920, loss_d: 0.475578
Epoch finished! Loss: 1.2264398501469538
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.121754, loss_ss: 0.791658, loss_d: 0.330096
0.0384 --- loss: 1.133722, loss_ss: 0.641351, loss_d: 0.492371
0.0769 --- loss: 1.035690, loss_ss: 0.789657, loss_d: 0.246034
0.1153 --- loss: 1.111766, loss_ss: 0.866275, loss_d: 0.245491
0.1537 --- loss: 0.928519, loss_ss: 0.587873, loss_d: 0.340647
0.1922 --- loss: 1.142546, loss_ss: 0.966958, loss_d: 0.175588
0.2306 --- loss: 1.016597, loss_ss: 0.747708, loss_d: 0.268889
0.2690 --- loss: 1.085474, loss_ss: 0.785392, loss_d: 0.300082
0.3075 --- loss: 1.101557, loss_ss: 0.832965, loss_d: 0.268592
0.3459 --- loss: 1.133878, loss_ss: 0.665626, loss_d: 0.468253
0.3843 --- loss: 0.883041, loss_ss: 0.718354, loss_d: 0.164687
0.4228 --- loss: 1.049105, loss_ss: 0.822806, loss_d: 0.226299
0.4612 --- loss: 1.033468, loss_ss: 0.752237, loss_d: 0.281231
0.4996 --- loss: 1.446281, loss_ss: 1.099052, loss_d: 0.347229
0.5380 --- loss: 1.092885, loss_ss: 0.875388, loss_d: 0.217497
0.5765 --- loss: 1.703871, loss_ss: 0.934273, loss_d: 0.769598
0.6149 --- loss: 1.292689, loss_ss: 0.930927, loss_d: 0.361761
0.6533 --- loss: 1.356562, loss_ss: 1.062643, loss_d: 0.293919
0.6918 --- loss: 1.849480, loss_ss: 1.641545, loss_d: 0.207935
0.7302 --- loss: 1.239310, loss_ss: 0.679308, loss_d: 0.560002
0.7686 --- loss: 1.017187, loss_ss: 0.854851, loss_d: 0.162335
0.8071 --- loss: 1.365387, loss_ss: 0.856352, loss_d: 0.509035
0.8455 --- loss: 1.001319, loss_ss: 0.624843, loss_d: 0.376476
0.8839 --- loss: 1.428246, loss_ss: 1.184982, loss_d: 0.243264
0.9224 --- loss: 0.794476, loss_ss: 0.643499, loss_d: 0.150977
0.9608 --- loss: 1.298746, loss_ss: 0.995365, loss_d: 0.303381
0.9992 --- loss: 1.305455, loss_ss: 1.140850, loss_d: 0.164605
Epoch finished! Loss: 1.2023480174633172
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.061824, loss_ss: 0.859327, loss_d: 0.202497
0.0384 --- loss: 1.105071, loss_ss: 0.790560, loss_d: 0.314511
0.0769 --- loss: 1.359241, loss_ss: 0.799376, loss_d: 0.559865
0.1153 --- loss: 1.048278, loss_ss: 0.648395, loss_d: 0.399884
0.1537 --- loss: 1.736952, loss_ss: 0.842289, loss_d: 0.894662
0.1922 --- loss: 1.028896, loss_ss: 0.814862, loss_d: 0.214035
0.2306 --- loss: 1.144205, loss_ss: 0.981630, loss_d: 0.162575
0.2690 --- loss: 1.153013, loss_ss: 0.637906, loss_d: 0.515107
0.3075 --- loss: 1.513895, loss_ss: 0.771986, loss_d: 0.741909
0.3459 --- loss: 1.005344, loss_ss: 0.727572, loss_d: 0.277772
0.3843 --- loss: 1.222217, loss_ss: 0.784002, loss_d: 0.438214
0.4228 --- loss: 0.955236, loss_ss: 0.777978, loss_d: 0.177258
0.4612 --- loss: 1.149621, loss_ss: 1.054971, loss_d: 0.094650
0.4996 --- loss: 0.729962, loss_ss: 0.579308, loss_d: 0.150653
0.5380 --- loss: 0.836889, loss_ss: 0.582397, loss_d: 0.254492
0.5765 --- loss: 1.080804, loss_ss: 0.948861, loss_d: 0.131943
0.6149 --- loss: 0.867370, loss_ss: 0.614083, loss_d: 0.253287
0.6533 --- loss: 0.946525, loss_ss: 0.740645, loss_d: 0.205880
0.6918 --- loss: 0.993000, loss_ss: 0.664767, loss_d: 0.328234
0.7302 --- loss: 1.422805, loss_ss: 1.109892, loss_d: 0.312913
0.7686 --- loss: 1.454065, loss_ss: 1.100688, loss_d: 0.353376
0.8071 --- loss: 0.936590, loss_ss: 0.746794, loss_d: 0.189796
0.8455 --- loss: 0.967245, loss_ss: 0.630376, loss_d: 0.336869
0.8839 --- loss: 1.563843, loss_ss: 1.087274, loss_d: 0.476569
0.9224 --- loss: 1.153555, loss_ss: 0.719492, loss_d: 0.434063
0.9608 --- loss: 1.001133, loss_ss: 0.773029, loss_d: 0.228103
0.9992 --- loss: 2.074137, loss_ss: 1.939898, loss_d: 0.134239
Epoch finished! Loss: 1.160872149696717
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7129629629629629
             precision    recall  f1-score   support

        0.0       0.79      0.63      0.70       196
        1.0       0.19      0.43      0.26        58
        2.0       0.87      0.77      0.82       527
        3.0       0.36      0.97      0.52        33
        4.0       0.77      0.68      0.72       266

avg / total       0.78      0.71      0.74      1080
 


====== chp041-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.37  63.27   96.38  79.49     70.45
1  87.04  43.10   89.53  18.94     26.32
2  83.43  77.23   89.33  87.34     81.97
3  94.63  96.97   94.56  35.96     52.46
4  87.13  68.42   93.24  76.79     72.37
Total accuracy: 71.30%
Average sen: 69.80%
Average spec: 92.61%
Macro f1-score: 60.71%
[0.98302388 0.95264232 0.99799901 0.55794299 0.97367883 0.98820949
 0.88194615 0.94058233 0.96179438 0.97189325 0.99615711 0.97020882
 0.99979371 0.99804854 0.98917001 0.99931896 0.79231972 0.85183966
 0.99020982 0.97667867 0.94869405 0.98921388 0.98843199 0.94086778
 0.96511924 0.99362814 0.94110036 0.83576256 0.99497628 0.87185323
 0.99064165 0.98775625 0.99427152 0.92141753 0.77608174 0.98788083]
pred: 0.9416987415817049, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.408783, loss_ss: 1.715627, loss_d: 0.693156
0.0384 --- loss: 1.980539, loss_ss: 1.495558, loss_d: 0.484981
0.0769 --- loss: 2.109642, loss_ss: 1.387769, loss_d: 0.721872
0.1153 --- loss: 2.177822, loss_ss: 1.354287, loss_d: 0.823536
0.1538 --- loss: 2.144131, loss_ss: 1.439922, loss_d: 0.704210
0.1922 --- loss: 2.077820, loss_ss: 1.501881, loss_d: 0.575939
0.2307 --- loss: 1.883985, loss_ss: 1.201562, loss_d: 0.682423
0.2691 --- loss: 2.002117, loss_ss: 1.364089, loss_d: 0.638029
0.3076 --- loss: 1.799851, loss_ss: 1.234020, loss_d: 0.565831
0.3460 --- loss: 1.715382, loss_ss: 1.238316, loss_d: 0.477066
0.3845 --- loss: 2.143762, loss_ss: 1.301555, loss_d: 0.842207
0.4229 --- loss: 1.873731, loss_ss: 1.196485, loss_d: 0.677246
0.4614 --- loss: 1.752314, loss_ss: 1.092614, loss_d: 0.659700
0.4998 --- loss: 1.735767, loss_ss: 1.057012, loss_d: 0.678755
0.5383 --- loss: 1.753114, loss_ss: 1.222907, loss_d: 0.530207
0.5767 --- loss: 2.014459, loss_ss: 1.359259, loss_d: 0.655200
0.6151 --- loss: 1.942136, loss_ss: 1.284889, loss_d: 0.657247
0.6536 --- loss: 1.722222, loss_ss: 1.262829, loss_d: 0.459393
0.6920 --- loss: 2.032111, loss_ss: 1.293440, loss_d: 0.738671
0.7305 --- loss: 1.629794, loss_ss: 1.180771, loss_d: 0.449024
0.7689 --- loss: 1.869993, loss_ss: 1.264903, loss_d: 0.605091
0.8074 --- loss: 2.180207, loss_ss: 1.364845, loss_d: 0.815363
0.8458 --- loss: 1.689817, loss_ss: 0.998754, loss_d: 0.691063
0.8843 --- loss: 1.743336, loss_ss: 1.119635, loss_d: 0.623701
0.9227 --- loss: 1.826337, loss_ss: 1.207723, loss_d: 0.618614
0.9612 --- loss: 1.708647, loss_ss: 1.168499, loss_d: 0.540149
0.9996 --- loss: 1.508523, loss_ss: 1.196766, loss_d: 0.311756
Epoch finished! Loss: 1.8777861379660092
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.686493, loss_ss: 1.102159, loss_d: 0.584334
0.0384 --- loss: 1.638787, loss_ss: 1.102972, loss_d: 0.535814
0.0769 --- loss: 1.829803, loss_ss: 1.146577, loss_d: 0.683225
0.1153 --- loss: 1.640948, loss_ss: 1.203615, loss_d: 0.437333
0.1538 --- loss: 1.909085, loss_ss: 1.151997, loss_d: 0.757088
0.1922 --- loss: 1.737154, loss_ss: 1.067372, loss_d: 0.669782
0.2307 --- loss: 1.932140, loss_ss: 1.226737, loss_d: 0.705402
0.2691 --- loss: 1.580725, loss_ss: 1.139488, loss_d: 0.441237
0.3076 --- loss: 1.759908, loss_ss: 1.074902, loss_d: 0.685006
0.3460 --- loss: 1.190887, loss_ss: 0.918541, loss_d: 0.272345
0.3845 --- loss: 1.421304, loss_ss: 0.974032, loss_d: 0.447272
0.4229 --- loss: 1.495513, loss_ss: 0.842810, loss_d: 0.652702
0.4614 --- loss: 1.773605, loss_ss: 1.156259, loss_d: 0.617346
0.4998 --- loss: 1.725619, loss_ss: 1.298012, loss_d: 0.427607
0.5383 --- loss: 1.620898, loss_ss: 0.999296, loss_d: 0.621601
0.5767 --- loss: 1.741455, loss_ss: 1.159539, loss_d: 0.581916
0.6151 --- loss: 1.712221, loss_ss: 1.141528, loss_d: 0.570693
0.6536 --- loss: 1.575076, loss_ss: 1.071107, loss_d: 0.503969
0.6920 --- loss: 1.495680, loss_ss: 1.015923, loss_d: 0.479758
0.7305 --- loss: 1.411467, loss_ss: 0.893847, loss_d: 0.517620
0.7689 --- loss: 1.781710, loss_ss: 1.042495, loss_d: 0.739215
0.8074 --- loss: 1.675834, loss_ss: 1.038369, loss_d: 0.637466
0.8458 --- loss: 1.372896, loss_ss: 0.865634, loss_d: 0.507262
0.8843 --- loss: 1.479888, loss_ss: 1.067698, loss_d: 0.412190
0.9227 --- loss: 1.616161, loss_ss: 1.008437, loss_d: 0.607724
0.9612 --- loss: 1.377043, loss_ss: 0.879919, loss_d: 0.497124
0.9996 --- loss: 2.684952, loss_ss: 2.239540, loss_d: 0.445412
Epoch finished! Loss: 1.6935625145068536
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.583533, loss_ss: 0.966296, loss_d: 0.617237
0.0384 --- loss: 1.539986, loss_ss: 0.713117, loss_d: 0.826868
0.0769 --- loss: 1.325485, loss_ss: 0.691598, loss_d: 0.633888
0.1153 --- loss: 1.687460, loss_ss: 0.986751, loss_d: 0.700709
0.1538 --- loss: 1.542399, loss_ss: 1.022440, loss_d: 0.519959
0.1922 --- loss: 1.256445, loss_ss: 1.000531, loss_d: 0.255914
0.2307 --- loss: 1.658221, loss_ss: 1.284780, loss_d: 0.373441
0.2691 --- loss: 1.694037, loss_ss: 1.057932, loss_d: 0.636106
0.3076 --- loss: 1.746989, loss_ss: 0.989082, loss_d: 0.757907
0.3460 --- loss: 1.449506, loss_ss: 0.918399, loss_d: 0.531107
0.3845 --- loss: 1.590169, loss_ss: 1.074878, loss_d: 0.515291
0.4229 --- loss: 1.637188, loss_ss: 1.165448, loss_d: 0.471740
0.4614 --- loss: 1.527690, loss_ss: 0.950584, loss_d: 0.577105
0.4998 --- loss: 1.948563, loss_ss: 1.277759, loss_d: 0.670804
0.5383 --- loss: 1.384598, loss_ss: 0.673571, loss_d: 0.711027
0.5767 --- loss: 1.768074, loss_ss: 0.959433, loss_d: 0.808641
0.6151 --- loss: 1.535897, loss_ss: 1.054200, loss_d: 0.481697
0.6536 --- loss: 1.531176, loss_ss: 0.881131, loss_d: 0.650045
0.6920 --- loss: 1.446353, loss_ss: 0.963653, loss_d: 0.482700
0.7305 --- loss: 1.622586, loss_ss: 0.953157, loss_d: 0.669429
0.7689 --- loss: 1.738464, loss_ss: 1.195737, loss_d: 0.542727
0.8074 --- loss: 1.416018, loss_ss: 0.864681, loss_d: 0.551337
0.8458 --- loss: 1.579559, loss_ss: 1.024784, loss_d: 0.554775
0.8843 --- loss: 1.693418, loss_ss: 1.324252, loss_d: 0.369165
0.9227 --- loss: 1.594189, loss_ss: 1.102199, loss_d: 0.491990
0.9612 --- loss: 1.514467, loss_ss: 1.018150, loss_d: 0.496316
0.9996 --- loss: 2.796725, loss_ss: 2.501664, loss_d: 0.295061
Epoch finished! Loss: 1.6083004268316121
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.566322, loss_ss: 0.888078, loss_d: 0.678244
0.0384 --- loss: 1.389579, loss_ss: 0.985884, loss_d: 0.403695
0.0769 --- loss: 1.488879, loss_ss: 0.943927, loss_d: 0.544952
0.1153 --- loss: 1.488619, loss_ss: 0.887606, loss_d: 0.601013
0.1538 --- loss: 1.669860, loss_ss: 0.890996, loss_d: 0.778864
0.1922 --- loss: 1.658307, loss_ss: 1.119791, loss_d: 0.538516
0.2307 --- loss: 1.655787, loss_ss: 1.052655, loss_d: 0.603133
0.2691 --- loss: 1.694428, loss_ss: 1.152297, loss_d: 0.542131
0.3076 --- loss: 1.732978, loss_ss: 1.273268, loss_d: 0.459710
0.3460 --- loss: 1.932628, loss_ss: 0.916686, loss_d: 1.015942
0.3845 --- loss: 1.681422, loss_ss: 1.193448, loss_d: 0.487974
0.4229 --- loss: 1.748139, loss_ss: 1.173388, loss_d: 0.574751
0.4614 --- loss: 1.234958, loss_ss: 0.867425, loss_d: 0.367533
0.4998 --- loss: 1.339476, loss_ss: 0.833496, loss_d: 0.505979
0.5383 --- loss: 1.425393, loss_ss: 0.850881, loss_d: 0.574512
0.5767 --- loss: 1.492071, loss_ss: 0.934389, loss_d: 0.557683
0.6151 --- loss: 1.375124, loss_ss: 0.741666, loss_d: 0.633458
0.6536 --- loss: 1.785558, loss_ss: 0.874016, loss_d: 0.911542
0.6920 --- loss: 1.457002, loss_ss: 1.063868, loss_d: 0.393133
0.7305 --- loss: 1.258515, loss_ss: 0.958643, loss_d: 0.299872
0.7689 --- loss: 1.599921, loss_ss: 0.794482, loss_d: 0.805439
0.8074 --- loss: 1.222564, loss_ss: 0.778888, loss_d: 0.443677
0.8458 --- loss: 1.286208, loss_ss: 0.913783, loss_d: 0.372425
0.8843 --- loss: 1.479553, loss_ss: 0.958573, loss_d: 0.520980
0.9227 --- loss: 1.436459, loss_ss: 1.002071, loss_d: 0.434387
0.9612 --- loss: 1.263420, loss_ss: 0.727428, loss_d: 0.535991
0.9996 --- loss: 2.792254, loss_ss: 2.562873, loss_d: 0.229381
Epoch finished! Loss: 1.5451061574312357
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.517339, loss_ss: 1.048750, loss_d: 0.468589
0.0384 --- loss: 1.591722, loss_ss: 0.853165, loss_d: 0.738557
0.0769 --- loss: 1.252271, loss_ss: 0.785696, loss_d: 0.466574
0.1153 --- loss: 1.401922, loss_ss: 1.035919, loss_d: 0.366003
0.1538 --- loss: 1.497156, loss_ss: 0.813666, loss_d: 0.683491
0.1922 --- loss: 1.624744, loss_ss: 1.036302, loss_d: 0.588442
0.2307 --- loss: 1.499581, loss_ss: 0.783481, loss_d: 0.716100
0.2691 --- loss: 2.031799, loss_ss: 1.541007, loss_d: 0.490792
0.3076 --- loss: 1.746614, loss_ss: 1.062416, loss_d: 0.684198
0.3460 --- loss: 1.120044, loss_ss: 0.849210, loss_d: 0.270833
0.3845 --- loss: 1.829225, loss_ss: 0.931945, loss_d: 0.897280
0.4229 --- loss: 1.278734, loss_ss: 0.834498, loss_d: 0.444237
0.4614 --- loss: 1.566781, loss_ss: 1.130119, loss_d: 0.436661
0.4998 --- loss: 1.280354, loss_ss: 0.948624, loss_d: 0.331730
0.5383 --- loss: 1.396005, loss_ss: 0.966767, loss_d: 0.429238
0.5767 --- loss: 1.323275, loss_ss: 0.907953, loss_d: 0.415322
0.6151 --- loss: 1.505988, loss_ss: 0.954123, loss_d: 0.551864
0.6536 --- loss: 1.456564, loss_ss: 0.927218, loss_d: 0.529346
0.6920 --- loss: 1.270901, loss_ss: 0.914209, loss_d: 0.356692
0.7305 --- loss: 1.505534, loss_ss: 0.861519, loss_d: 0.644015
0.7689 --- loss: 1.030679, loss_ss: 0.738818, loss_d: 0.291861
0.8074 --- loss: 1.728831, loss_ss: 1.090082, loss_d: 0.638748
0.8458 --- loss: 1.629916, loss_ss: 0.807966, loss_d: 0.821950
0.8843 --- loss: 1.608221, loss_ss: 0.911397, loss_d: 0.696825
0.9227 --- loss: 1.559860, loss_ss: 1.098175, loss_d: 0.461685
0.9612 --- loss: 1.349679, loss_ss: 0.900732, loss_d: 0.448947
0.9996 --- loss: 2.493879, loss_ss: 0.799259, loss_d: 1.694620
Epoch finished! Loss: 1.487681629566046
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.553105, loss_ss: 0.740943, loss_d: 0.812162
0.0384 --- loss: 1.434518, loss_ss: 0.859966, loss_d: 0.574551
0.0769 --- loss: 1.607312, loss_ss: 1.198291, loss_d: 0.409021
0.1153 --- loss: 2.017983, loss_ss: 1.529777, loss_d: 0.488206
0.1538 --- loss: 1.264767, loss_ss: 0.885917, loss_d: 0.378849
0.1922 --- loss: 1.240574, loss_ss: 0.879471, loss_d: 0.361103
0.2307 --- loss: 1.482684, loss_ss: 0.600179, loss_d: 0.882505
0.2691 --- loss: 1.814632, loss_ss: 1.473393, loss_d: 0.341240
0.3076 --- loss: 1.338417, loss_ss: 1.003299, loss_d: 0.335118
0.3460 --- loss: 1.455626, loss_ss: 1.145495, loss_d: 0.310131
0.3845 --- loss: 1.349518, loss_ss: 0.801632, loss_d: 0.547886
0.4229 --- loss: 1.358653, loss_ss: 0.932180, loss_d: 0.426473
0.4614 --- loss: 1.388670, loss_ss: 0.918580, loss_d: 0.470090
0.4998 --- loss: 1.089998, loss_ss: 0.753083, loss_d: 0.336915
0.5383 --- loss: 1.129769, loss_ss: 0.769944, loss_d: 0.359825
0.5767 --- loss: 1.232432, loss_ss: 0.957889, loss_d: 0.274543
0.6151 --- loss: 1.376582, loss_ss: 0.799568, loss_d: 0.577014
0.6536 --- loss: 1.113320, loss_ss: 0.774740, loss_d: 0.338579
0.6920 --- loss: 1.381197, loss_ss: 1.036741, loss_d: 0.344456
0.7305 --- loss: 1.579357, loss_ss: 1.079109, loss_d: 0.500249
0.7689 --- loss: 1.355232, loss_ss: 0.915563, loss_d: 0.439669
0.8074 --- loss: 1.365245, loss_ss: 0.992270, loss_d: 0.372975
0.8458 --- loss: 1.032374, loss_ss: 0.686791, loss_d: 0.345584
0.8843 --- loss: 1.528412, loss_ss: 0.895179, loss_d: 0.633232
0.9227 --- loss: 1.238618, loss_ss: 0.999656, loss_d: 0.238961
0.9612 --- loss: 1.144221, loss_ss: 0.892004, loss_d: 0.252217
0.9996 --- loss: 1.662742, loss_ss: 1.486191, loss_d: 0.176550
Epoch finished! Loss: 1.4085855334997177
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.536297, loss_ss: 0.821139, loss_d: 0.715157
0.0384 --- loss: 1.397357, loss_ss: 0.911460, loss_d: 0.485897
0.0769 --- loss: 1.003356, loss_ss: 0.730268, loss_d: 0.273088
0.1153 --- loss: 1.057372, loss_ss: 0.812165, loss_d: 0.245207
0.1538 --- loss: 1.494506, loss_ss: 0.760500, loss_d: 0.734006
0.1922 --- loss: 1.146238, loss_ss: 0.891314, loss_d: 0.254924
0.2307 --- loss: 1.342410, loss_ss: 0.619626, loss_d: 0.722784
0.2691 --- loss: 1.464089, loss_ss: 0.846087, loss_d: 0.618002
0.3076 --- loss: 0.828026, loss_ss: 0.650154, loss_d: 0.177872
0.3460 --- loss: 0.889343, loss_ss: 0.671662, loss_d: 0.217681
0.3845 --- loss: 1.288098, loss_ss: 1.059221, loss_d: 0.228877
0.4229 --- loss: 1.472467, loss_ss: 1.077882, loss_d: 0.394585
0.4614 --- loss: 1.171723, loss_ss: 0.794647, loss_d: 0.377076
0.4998 --- loss: 1.589706, loss_ss: 0.985550, loss_d: 0.604156
0.5383 --- loss: 1.307006, loss_ss: 0.726475, loss_d: 0.580531
0.5767 --- loss: 1.254014, loss_ss: 0.776754, loss_d: 0.477260
0.6151 --- loss: 1.335545, loss_ss: 1.105907, loss_d: 0.229638
0.6536 --- loss: 1.094297, loss_ss: 0.784046, loss_d: 0.310251
0.6920 --- loss: 1.636078, loss_ss: 1.133826, loss_d: 0.502252
0.7305 --- loss: 1.377792, loss_ss: 0.796115, loss_d: 0.581677
0.7689 --- loss: 1.286776, loss_ss: 0.861968, loss_d: 0.424808
0.8074 --- loss: 1.561862, loss_ss: 1.182573, loss_d: 0.379288
0.8458 --- loss: 1.245542, loss_ss: 0.894006, loss_d: 0.351537
0.8843 --- loss: 1.561270, loss_ss: 1.106441, loss_d: 0.454829
0.9227 --- loss: 1.472238, loss_ss: 1.232679, loss_d: 0.239559
0.9612 --- loss: 1.300811, loss_ss: 0.937870, loss_d: 0.362941
0.9996 --- loss: 1.583975, loss_ss: 1.452112, loss_d: 0.131863
Epoch finished! Loss: 1.297309782413336
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.136104, loss_ss: 0.890218, loss_d: 0.245886
0.0384 --- loss: 1.111352, loss_ss: 0.848233, loss_d: 0.263119
0.0769 --- loss: 0.991888, loss_ss: 0.752245, loss_d: 0.239643
0.1153 --- loss: 1.087067, loss_ss: 0.917166, loss_d: 0.169902
0.1538 --- loss: 1.252042, loss_ss: 0.980236, loss_d: 0.271806
0.1922 --- loss: 1.643458, loss_ss: 1.301435, loss_d: 0.342023
0.2307 --- loss: 1.505526, loss_ss: 0.871000, loss_d: 0.634526
0.2691 --- loss: 0.958558, loss_ss: 0.663374, loss_d: 0.295185
0.3076 --- loss: 1.116111, loss_ss: 0.962025, loss_d: 0.154085
0.3460 --- loss: 1.162715, loss_ss: 1.011963, loss_d: 0.150752
0.3845 --- loss: 0.984292, loss_ss: 0.738726, loss_d: 0.245566
0.4229 --- loss: 1.120874, loss_ss: 0.866348, loss_d: 0.254526
0.4614 --- loss: 1.462264, loss_ss: 1.186896, loss_d: 0.275368
0.4998 --- loss: 1.161417, loss_ss: 0.724643, loss_d: 0.436774
0.5383 --- loss: 0.959215, loss_ss: 0.738204, loss_d: 0.221011
0.5767 --- loss: 1.038921, loss_ss: 0.663838, loss_d: 0.375083
0.6151 --- loss: 1.236553, loss_ss: 0.955440, loss_d: 0.281113
0.6536 --- loss: 1.352027, loss_ss: 0.726431, loss_d: 0.625596
0.6920 --- loss: 0.986714, loss_ss: 0.804227, loss_d: 0.182487
0.7305 --- loss: 1.590987, loss_ss: 1.004901, loss_d: 0.586086
0.7689 --- loss: 1.530051, loss_ss: 1.192974, loss_d: 0.337076
0.8074 --- loss: 1.192277, loss_ss: 1.017169, loss_d: 0.175108
0.8458 --- loss: 1.014054, loss_ss: 0.784495, loss_d: 0.229559
0.8843 --- loss: 0.951034, loss_ss: 0.782447, loss_d: 0.168587
0.9227 --- loss: 1.224352, loss_ss: 0.845305, loss_d: 0.379047
0.9612 --- loss: 1.208473, loss_ss: 0.632122, loss_d: 0.576351
0.9996 --- loss: 4.024790, loss_ss: 2.064887, loss_d: 1.959903
Epoch finished! Loss: 1.2259818888627565
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.144447, loss_ss: 0.862447, loss_d: 0.282001
0.0384 --- loss: 1.248696, loss_ss: 0.866585, loss_d: 0.382110
0.0769 --- loss: 1.190679, loss_ss: 0.917525, loss_d: 0.273154
0.1153 --- loss: 1.092637, loss_ss: 0.816667, loss_d: 0.275970
0.1538 --- loss: 1.183589, loss_ss: 0.949498, loss_d: 0.234092
0.1922 --- loss: 1.401682, loss_ss: 0.826652, loss_d: 0.575030
0.2307 --- loss: 1.269475, loss_ss: 0.776322, loss_d: 0.493153
0.2691 --- loss: 1.243630, loss_ss: 0.900843, loss_d: 0.342787
0.3076 --- loss: 1.771621, loss_ss: 0.828585, loss_d: 0.943036
0.3460 --- loss: 1.466892, loss_ss: 0.868720, loss_d: 0.598172
0.3845 --- loss: 1.201429, loss_ss: 0.942272, loss_d: 0.259157
0.4229 --- loss: 1.194053, loss_ss: 1.008967, loss_d: 0.185085
0.4614 --- loss: 2.131692, loss_ss: 1.890508, loss_d: 0.241185
0.4998 --- loss: 1.145312, loss_ss: 0.789460, loss_d: 0.355852
0.5383 --- loss: 1.018388, loss_ss: 0.890832, loss_d: 0.127556
0.5767 --- loss: 0.826775, loss_ss: 0.607791, loss_d: 0.218984
0.6151 --- loss: 1.503379, loss_ss: 1.046549, loss_d: 0.456830
0.6536 --- loss: 1.185696, loss_ss: 0.608771, loss_d: 0.576925
0.6920 --- loss: 1.083596, loss_ss: 0.859688, loss_d: 0.223909
0.7305 --- loss: 1.105649, loss_ss: 0.910176, loss_d: 0.195472
0.7689 --- loss: 1.065658, loss_ss: 0.697178, loss_d: 0.368480
0.8074 --- loss: 0.976196, loss_ss: 0.780177, loss_d: 0.196019
0.8458 --- loss: 0.968605, loss_ss: 0.825743, loss_d: 0.142862
0.8843 --- loss: 0.954208, loss_ss: 0.772347, loss_d: 0.181861
0.9227 --- loss: 1.102746, loss_ss: 0.786211, loss_d: 0.316536
0.9612 --- loss: 1.236856, loss_ss: 0.975159, loss_d: 0.261697
0.9996 --- loss: 6.243948, loss_ss: 3.519140, loss_d: 2.724808
Epoch finished! Loss: 1.210079342356095
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.401615, loss_ss: 0.976991, loss_d: 0.424625
0.0384 --- loss: 1.182540, loss_ss: 0.862369, loss_d: 0.320171
0.0769 --- loss: 1.308707, loss_ss: 0.929875, loss_d: 0.378833
0.1153 --- loss: 0.910885, loss_ss: 0.681683, loss_d: 0.229202
0.1538 --- loss: 0.881469, loss_ss: 0.705201, loss_d: 0.176268
0.1922 --- loss: 1.143400, loss_ss: 0.712115, loss_d: 0.431285
0.2307 --- loss: 0.956533, loss_ss: 0.814497, loss_d: 0.142036
0.2691 --- loss: 0.854916, loss_ss: 0.742143, loss_d: 0.112772
0.3076 --- loss: 1.225744, loss_ss: 0.846400, loss_d: 0.379343
0.3460 --- loss: 1.206685, loss_ss: 0.864097, loss_d: 0.342588
0.3845 --- loss: 1.363483, loss_ss: 1.152728, loss_d: 0.210755
0.4229 --- loss: 1.156246, loss_ss: 0.538331, loss_d: 0.617915
0.4614 --- loss: 1.040143, loss_ss: 0.714656, loss_d: 0.325487
0.4998 --- loss: 1.267636, loss_ss: 0.974942, loss_d: 0.292694
0.5383 --- loss: 1.007270, loss_ss: 0.844045, loss_d: 0.163224
0.5767 --- loss: 1.506028, loss_ss: 1.230647, loss_d: 0.275381
0.6151 --- loss: 0.871103, loss_ss: 0.640276, loss_d: 0.230826
0.6536 --- loss: 1.032387, loss_ss: 0.851641, loss_d: 0.180746
0.6920 --- loss: 0.697427, loss_ss: 0.569004, loss_d: 0.128423
0.7305 --- loss: 0.860414, loss_ss: 0.669018, loss_d: 0.191396
0.7689 --- loss: 1.631755, loss_ss: 0.863136, loss_d: 0.768620
0.8074 --- loss: 1.292765, loss_ss: 0.932341, loss_d: 0.360424
0.8458 --- loss: 1.073102, loss_ss: 0.930481, loss_d: 0.142621
0.8843 --- loss: 0.980463, loss_ss: 0.736972, loss_d: 0.243490
0.9227 --- loss: 1.059634, loss_ss: 0.799496, loss_d: 0.260138
0.9612 --- loss: 0.785383, loss_ss: 0.531147, loss_d: 0.254236
0.9996 --- loss: 3.786364, loss_ss: 1.211654, loss_d: 2.574710
Epoch finished! Loss: 1.1808026240422176
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6198198198198198
             precision    recall  f1-score   support

        0.0       0.57      0.49      0.53       153
        1.0       0.43      0.06      0.11       232
        2.0       0.56      0.91      0.69       441
        3.0       0.90      0.82      0.86        93
        4.0       0.85      0.63      0.72       191

avg / total       0.61      0.62      0.57      1110
 


====== chp042-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.93  49.02   94.15  57.25     52.82
1  78.65   6.47   97.72  42.86     11.24
2  67.93  91.16   52.62  55.91     69.31
3  97.75  81.72   99.21  90.48     85.88
4  91.71  62.83   97.71  85.11     72.29
Total accuracy: 61.98%
Average sen: 58.24%
Average spec: 88.28%
Macro f1-score: 58.31%
[0.64715338 0.49776283 0.68116736 0.9934963  0.995417   0.98425573
 0.9854092  0.97200012 0.91914326 0.43745983 0.99918777 0.70452809
 0.79643613 0.98683804 0.99849021 0.99828917 0.99887723 0.99998963
 0.97479689 0.99957865 0.99997973 0.98408991 0.99808216 0.67010933
 0.7399534  0.98211116 0.99958795 0.9989484  0.9996506  0.9939931
 0.90389729 0.99906844 0.99874026 0.89715594 0.87828869 0.99419832
 0.99991047]
pred: 0.9083254587005924, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.389401, loss_ss: 1.702113, loss_d: 0.687288
0.0385 --- loss: 2.009624, loss_ss: 1.625665, loss_d: 0.383958
0.0770 --- loss: 2.406544, loss_ss: 1.493521, loss_d: 0.913024
0.1155 --- loss: 2.006943, loss_ss: 1.526215, loss_d: 0.480728
0.1540 --- loss: 2.069838, loss_ss: 1.577662, loss_d: 0.492176
0.1925 --- loss: 2.220810, loss_ss: 1.433749, loss_d: 0.787062
0.2309 --- loss: 1.922214, loss_ss: 1.316424, loss_d: 0.605790
0.2694 --- loss: 2.202700, loss_ss: 1.516130, loss_d: 0.686570
0.3079 --- loss: 2.223980, loss_ss: 1.515868, loss_d: 0.708112
0.3464 --- loss: 2.030452, loss_ss: 1.250207, loss_d: 0.780245
0.3849 --- loss: 1.892708, loss_ss: 1.267186, loss_d: 0.625521
0.4234 --- loss: 1.802946, loss_ss: 1.205104, loss_d: 0.597843
0.4619 --- loss: 2.152437, loss_ss: 1.283388, loss_d: 0.869049
0.5004 --- loss: 1.800285, loss_ss: 1.170067, loss_d: 0.630218
0.5389 --- loss: 1.926337, loss_ss: 1.409074, loss_d: 0.517262
0.5774 --- loss: 1.812846, loss_ss: 1.343584, loss_d: 0.469262
0.6159 --- loss: 1.754986, loss_ss: 1.323127, loss_d: 0.431859
0.6543 --- loss: 1.690513, loss_ss: 1.150971, loss_d: 0.539542
0.6928 --- loss: 1.818499, loss_ss: 1.302913, loss_d: 0.515586
0.7313 --- loss: 1.819044, loss_ss: 1.225688, loss_d: 0.593355
0.7698 --- loss: 1.682567, loss_ss: 1.240236, loss_d: 0.442331
0.8083 --- loss: 1.397074, loss_ss: 1.094137, loss_d: 0.302937
0.8468 --- loss: 1.834347, loss_ss: 1.186981, loss_d: 0.647366
0.8853 --- loss: 1.946537, loss_ss: 1.353339, loss_d: 0.593198
0.9238 --- loss: 1.569826, loss_ss: 1.170441, loss_d: 0.399385
0.9623 --- loss: 1.899110, loss_ss: 1.198836, loss_d: 0.700274
Epoch finished! Loss: 1.8887690775182717
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.691494, loss_ss: 1.169771, loss_d: 0.521723
0.0385 --- loss: 1.787859, loss_ss: 1.161091, loss_d: 0.626768
0.0770 --- loss: 1.358660, loss_ss: 0.957057, loss_d: 0.401603
0.1155 --- loss: 1.844664, loss_ss: 1.189865, loss_d: 0.654799
0.1540 --- loss: 1.609831, loss_ss: 1.106062, loss_d: 0.503769
0.1925 --- loss: 1.741484, loss_ss: 1.043443, loss_d: 0.698041
0.2309 --- loss: 1.659482, loss_ss: 0.998347, loss_d: 0.661136
0.2694 --- loss: 1.935304, loss_ss: 1.252026, loss_d: 0.683278
0.3079 --- loss: 1.638239, loss_ss: 1.139045, loss_d: 0.499194
0.3464 --- loss: 1.791920, loss_ss: 0.985590, loss_d: 0.806331
0.3849 --- loss: 1.698197, loss_ss: 1.181025, loss_d: 0.517172
0.4234 --- loss: 1.689398, loss_ss: 1.005468, loss_d: 0.683930
0.4619 --- loss: 1.470540, loss_ss: 0.990941, loss_d: 0.479599
0.5004 --- loss: 1.194375, loss_ss: 0.990909, loss_d: 0.203466
0.5389 --- loss: 2.164443, loss_ss: 1.014441, loss_d: 1.150002
0.5774 --- loss: 1.835394, loss_ss: 1.233857, loss_d: 0.601537
0.6159 --- loss: 1.492885, loss_ss: 0.892842, loss_d: 0.600043
0.6543 --- loss: 1.644328, loss_ss: 1.000931, loss_d: 0.643397
0.6928 --- loss: 1.810442, loss_ss: 1.195418, loss_d: 0.615024
0.7313 --- loss: 1.781264, loss_ss: 1.161506, loss_d: 0.619757
0.7698 --- loss: 1.365946, loss_ss: 1.002123, loss_d: 0.363823
0.8083 --- loss: 1.440600, loss_ss: 0.915166, loss_d: 0.525433
0.8468 --- loss: 1.480484, loss_ss: 1.031186, loss_d: 0.449297
0.8853 --- loss: 1.685667, loss_ss: 1.036646, loss_d: 0.649021
0.9238 --- loss: 1.302488, loss_ss: 0.862239, loss_d: 0.440249
0.9623 --- loss: 1.574746, loss_ss: 0.818431, loss_d: 0.756315
Epoch finished! Loss: 1.675970915201548
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.721483, loss_ss: 1.123293, loss_d: 0.598190
0.0385 --- loss: 1.505341, loss_ss: 1.069136, loss_d: 0.436206
0.0770 --- loss: 1.686258, loss_ss: 1.091238, loss_d: 0.595020
0.1155 --- loss: 1.367429, loss_ss: 0.859693, loss_d: 0.507737
0.1540 --- loss: 1.402369, loss_ss: 0.931497, loss_d: 0.470872
0.1925 --- loss: 1.421462, loss_ss: 0.960268, loss_d: 0.461194
0.2309 --- loss: 1.501018, loss_ss: 0.965501, loss_d: 0.535516
0.2694 --- loss: 1.543014, loss_ss: 0.917917, loss_d: 0.625096
0.3079 --- loss: 1.395803, loss_ss: 0.865224, loss_d: 0.530580
0.3464 --- loss: 1.534437, loss_ss: 0.995357, loss_d: 0.539079
0.3849 --- loss: 1.612055, loss_ss: 0.999245, loss_d: 0.612810
0.4234 --- loss: 1.960816, loss_ss: 1.247046, loss_d: 0.713770
0.4619 --- loss: 1.908878, loss_ss: 1.440188, loss_d: 0.468690
0.5004 --- loss: 1.767196, loss_ss: 1.052985, loss_d: 0.714211
0.5389 --- loss: 1.335811, loss_ss: 0.952647, loss_d: 0.383163
0.5774 --- loss: 1.348196, loss_ss: 0.805137, loss_d: 0.543059
0.6159 --- loss: 1.615508, loss_ss: 1.139358, loss_d: 0.476150
0.6543 --- loss: 1.769725, loss_ss: 1.298905, loss_d: 0.470820
0.6928 --- loss: 1.432738, loss_ss: 0.941979, loss_d: 0.490759
0.7313 --- loss: 1.309911, loss_ss: 0.939161, loss_d: 0.370750
0.7698 --- loss: 1.971897, loss_ss: 1.402868, loss_d: 0.569028
0.8083 --- loss: 1.464541, loss_ss: 1.206582, loss_d: 0.257958
0.8468 --- loss: 1.495771, loss_ss: 1.119125, loss_d: 0.376646
0.8853 --- loss: 1.663840, loss_ss: 0.799245, loss_d: 0.864595
0.9238 --- loss: 1.857814, loss_ss: 1.060287, loss_d: 0.797526
0.9623 --- loss: 1.436737, loss_ss: 0.962839, loss_d: 0.473898
Epoch finished! Loss: 1.5986298562016727
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.706465, loss_ss: 0.865706, loss_d: 0.840759
0.0385 --- loss: 1.546366, loss_ss: 1.150924, loss_d: 0.395442
0.0770 --- loss: 1.639342, loss_ss: 1.008826, loss_d: 0.630516
0.1155 --- loss: 1.875780, loss_ss: 1.175480, loss_d: 0.700300
0.1540 --- loss: 1.475640, loss_ss: 0.901245, loss_d: 0.574395
0.1925 --- loss: 1.539075, loss_ss: 1.035461, loss_d: 0.503615
0.2309 --- loss: 1.575870, loss_ss: 0.971757, loss_d: 0.604112
0.2694 --- loss: 1.816980, loss_ss: 1.295346, loss_d: 0.521634
0.3079 --- loss: 1.698337, loss_ss: 0.971339, loss_d: 0.726997
0.3464 --- loss: 1.657746, loss_ss: 1.137633, loss_d: 0.520113
0.3849 --- loss: 1.566628, loss_ss: 1.000673, loss_d: 0.565955
0.4234 --- loss: 1.186302, loss_ss: 0.729017, loss_d: 0.457285
0.4619 --- loss: 1.341600, loss_ss: 0.970105, loss_d: 0.371495
0.5004 --- loss: 2.009649, loss_ss: 1.434625, loss_d: 0.575024
0.5389 --- loss: 1.188224, loss_ss: 0.684122, loss_d: 0.504102
0.5774 --- loss: 1.520043, loss_ss: 1.145611, loss_d: 0.374432
0.6159 --- loss: 1.447246, loss_ss: 0.954541, loss_d: 0.492704
0.6543 --- loss: 1.300101, loss_ss: 1.067373, loss_d: 0.232729
0.6928 --- loss: 1.150186, loss_ss: 0.838831, loss_d: 0.311356
0.7313 --- loss: 1.591664, loss_ss: 1.045798, loss_d: 0.545866
0.7698 --- loss: 1.303777, loss_ss: 0.740429, loss_d: 0.563349
0.8083 --- loss: 0.980287, loss_ss: 0.678977, loss_d: 0.301310
0.8468 --- loss: 1.584606, loss_ss: 1.296479, loss_d: 0.288127
0.8853 --- loss: 1.347176, loss_ss: 1.004466, loss_d: 0.342710
0.9238 --- loss: 1.160656, loss_ss: 0.928382, loss_d: 0.232274
0.9623 --- loss: 1.593047, loss_ss: 0.859250, loss_d: 0.733797
Epoch finished! Loss: 1.5294896170899674
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.180146, loss_ss: 0.927993, loss_d: 0.252152
0.0385 --- loss: 1.294542, loss_ss: 0.865881, loss_d: 0.428660
0.0770 --- loss: 1.308496, loss_ss: 0.932169, loss_d: 0.376327
0.1155 --- loss: 1.329362, loss_ss: 1.055788, loss_d: 0.273574
0.1540 --- loss: 1.524450, loss_ss: 1.201091, loss_d: 0.323358
0.1925 --- loss: 1.706354, loss_ss: 1.261332, loss_d: 0.445022
0.2309 --- loss: 1.537731, loss_ss: 1.241881, loss_d: 0.295851
0.2694 --- loss: 1.604453, loss_ss: 1.172724, loss_d: 0.431730
0.3079 --- loss: 1.410655, loss_ss: 0.814026, loss_d: 0.596629
0.3464 --- loss: 1.206729, loss_ss: 0.992827, loss_d: 0.213902
0.3849 --- loss: 1.437168, loss_ss: 0.715193, loss_d: 0.721975
0.4234 --- loss: 1.729498, loss_ss: 1.204547, loss_d: 0.524951
0.4619 --- loss: 1.393372, loss_ss: 1.009135, loss_d: 0.384237
0.5004 --- loss: 1.686459, loss_ss: 1.129808, loss_d: 0.556651
0.5389 --- loss: 1.448240, loss_ss: 0.929444, loss_d: 0.518796
0.5774 --- loss: 2.079275, loss_ss: 1.310403, loss_d: 0.768872
0.6159 --- loss: 1.429834, loss_ss: 0.897940, loss_d: 0.531893
0.6543 --- loss: 1.451382, loss_ss: 0.983749, loss_d: 0.467633
0.6928 --- loss: 1.447839, loss_ss: 1.023553, loss_d: 0.424286
0.7313 --- loss: 1.861984, loss_ss: 1.067322, loss_d: 0.794661
0.7698 --- loss: 1.291385, loss_ss: 0.945738, loss_d: 0.345646
0.8083 --- loss: 1.546229, loss_ss: 0.951134, loss_d: 0.595096
0.8468 --- loss: 2.049446, loss_ss: 1.354891, loss_d: 0.694555
0.8853 --- loss: 1.629991, loss_ss: 1.047261, loss_d: 0.582730
0.9238 --- loss: 1.294572, loss_ss: 0.949843, loss_d: 0.344729
0.9623 --- loss: 0.970021, loss_ss: 0.737965, loss_d: 0.232056
Epoch finished! Loss: 1.4486309791623855
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.248373, loss_ss: 0.859612, loss_d: 0.388761
0.0385 --- loss: 1.082740, loss_ss: 0.854159, loss_d: 0.228581
0.0770 --- loss: 1.104258, loss_ss: 0.830126, loss_d: 0.274132
0.1155 --- loss: 1.056026, loss_ss: 0.666500, loss_d: 0.389526
0.1540 --- loss: 1.570126, loss_ss: 1.310478, loss_d: 0.259647
0.1925 --- loss: 1.252796, loss_ss: 1.051203, loss_d: 0.201593
0.2309 --- loss: 1.631681, loss_ss: 1.041782, loss_d: 0.589899
0.2694 --- loss: 1.333068, loss_ss: 1.046152, loss_d: 0.286916
0.3079 --- loss: 1.216264, loss_ss: 0.751483, loss_d: 0.464782
0.3464 --- loss: 1.487966, loss_ss: 1.013561, loss_d: 0.474405
0.3849 --- loss: 1.740534, loss_ss: 1.295281, loss_d: 0.445253
0.4234 --- loss: 1.039370, loss_ss: 0.822979, loss_d: 0.216391
0.4619 --- loss: 1.097011, loss_ss: 0.692431, loss_d: 0.404580
0.5004 --- loss: 1.105835, loss_ss: 0.844739, loss_d: 0.261096
0.5389 --- loss: 1.003802, loss_ss: 0.748554, loss_d: 0.255248
0.5774 --- loss: 2.438879, loss_ss: 1.124539, loss_d: 1.314340
0.6159 --- loss: 0.928443, loss_ss: 0.548799, loss_d: 0.379644
0.6543 --- loss: 1.281492, loss_ss: 0.871606, loss_d: 0.409885
0.6928 --- loss: 1.656001, loss_ss: 0.844472, loss_d: 0.811529
0.7313 --- loss: 1.554843, loss_ss: 1.156772, loss_d: 0.398071
0.7698 --- loss: 0.991495, loss_ss: 0.698757, loss_d: 0.292738
0.8083 --- loss: 1.058372, loss_ss: 0.844278, loss_d: 0.214095
0.8468 --- loss: 1.423754, loss_ss: 0.926725, loss_d: 0.497029
0.8853 --- loss: 1.274889, loss_ss: 0.777050, loss_d: 0.497839
0.9238 --- loss: 1.780434, loss_ss: 0.958377, loss_d: 0.822058
0.9623 --- loss: 1.296284, loss_ss: 0.811417, loss_d: 0.484867
Epoch finished! Loss: 1.356898408138614
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.368408, loss_ss: 0.971248, loss_d: 0.397160
0.0385 --- loss: 1.110355, loss_ss: 0.808313, loss_d: 0.302042
0.0770 --- loss: 1.296645, loss_ss: 0.894462, loss_d: 0.402183
0.1155 --- loss: 0.941767, loss_ss: 0.667159, loss_d: 0.274608
0.1540 --- loss: 1.503438, loss_ss: 0.790994, loss_d: 0.712445
0.1925 --- loss: 1.020159, loss_ss: 0.700270, loss_d: 0.319889
0.2309 --- loss: 1.118848, loss_ss: 0.891018, loss_d: 0.227829
0.2694 --- loss: 1.928068, loss_ss: 1.151132, loss_d: 0.776937
0.3079 --- loss: 1.234991, loss_ss: 0.930214, loss_d: 0.304777
0.3464 --- loss: 1.253310, loss_ss: 0.771669, loss_d: 0.481641
0.3849 --- loss: 1.192537, loss_ss: 0.831429, loss_d: 0.361108
0.4234 --- loss: 1.469595, loss_ss: 1.218447, loss_d: 0.251148
0.4619 --- loss: 1.351715, loss_ss: 0.938383, loss_d: 0.413333
0.5004 --- loss: 1.020901, loss_ss: 0.842344, loss_d: 0.178558
0.5389 --- loss: 1.480248, loss_ss: 0.808255, loss_d: 0.671994
0.5774 --- loss: 1.014725, loss_ss: 0.887854, loss_d: 0.126871
0.6159 --- loss: 1.278914, loss_ss: 0.856944, loss_d: 0.421971
0.6543 --- loss: 1.134315, loss_ss: 0.856576, loss_d: 0.277739
0.6928 --- loss: 1.362134, loss_ss: 0.893779, loss_d: 0.468355
0.7313 --- loss: 1.146289, loss_ss: 0.970676, loss_d: 0.175613
0.7698 --- loss: 0.977191, loss_ss: 0.751353, loss_d: 0.225838
0.8083 --- loss: 1.258436, loss_ss: 0.810428, loss_d: 0.448009
0.8468 --- loss: 1.156118, loss_ss: 0.835893, loss_d: 0.320225
0.8853 --- loss: 1.188988, loss_ss: 0.950610, loss_d: 0.238378
0.9238 --- loss: 1.264624, loss_ss: 0.918351, loss_d: 0.346273
0.9623 --- loss: 1.568756, loss_ss: 1.172932, loss_d: 0.395824
Epoch finished! Loss: 1.292488319303078
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.476618, loss_ss: 1.074111, loss_d: 0.402507
0.0385 --- loss: 1.398825, loss_ss: 1.160469, loss_d: 0.238356
0.0770 --- loss: 1.750162, loss_ss: 1.065107, loss_d: 0.685055
0.1155 --- loss: 0.882733, loss_ss: 0.753393, loss_d: 0.129340
0.1540 --- loss: 1.570753, loss_ss: 0.923132, loss_d: 0.647621
0.1925 --- loss: 1.327769, loss_ss: 0.877910, loss_d: 0.449859
0.2309 --- loss: 1.157755, loss_ss: 0.932623, loss_d: 0.225133
0.2694 --- loss: 1.029994, loss_ss: 0.758914, loss_d: 0.271080
0.3079 --- loss: 1.044291, loss_ss: 0.812451, loss_d: 0.231840
0.3464 --- loss: 1.094015, loss_ss: 0.792548, loss_d: 0.301468
0.3849 --- loss: 1.134868, loss_ss: 0.802271, loss_d: 0.332597
0.4234 --- loss: 1.270190, loss_ss: 1.014264, loss_d: 0.255926
0.4619 --- loss: 1.188555, loss_ss: 0.948895, loss_d: 0.239660
0.5004 --- loss: 1.286580, loss_ss: 0.763250, loss_d: 0.523329
0.5389 --- loss: 2.098155, loss_ss: 0.897066, loss_d: 1.201089
0.5774 --- loss: 1.488753, loss_ss: 0.952475, loss_d: 0.536278
0.6159 --- loss: 1.180820, loss_ss: 0.951484, loss_d: 0.229335
0.6543 --- loss: 1.129602, loss_ss: 0.919440, loss_d: 0.210162
0.6928 --- loss: 1.539055, loss_ss: 0.951887, loss_d: 0.587168
0.7313 --- loss: 1.148471, loss_ss: 0.755940, loss_d: 0.392532
0.7698 --- loss: 1.194103, loss_ss: 0.922217, loss_d: 0.271886
0.8083 --- loss: 1.356540, loss_ss: 1.224770, loss_d: 0.131770
0.8468 --- loss: 0.956165, loss_ss: 0.730340, loss_d: 0.225825
0.8853 --- loss: 1.062936, loss_ss: 0.838686, loss_d: 0.224250
0.9238 --- loss: 1.157479, loss_ss: 0.619577, loss_d: 0.537902
0.9623 --- loss: 0.987145, loss_ss: 0.795774, loss_d: 0.191371
Epoch finished! Loss: 1.2306608233212504
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.302886, loss_ss: 0.987068, loss_d: 0.315818
0.0385 --- loss: 0.955689, loss_ss: 0.817738, loss_d: 0.137951
0.0770 --- loss: 1.013738, loss_ss: 0.792416, loss_d: 0.221322
0.1155 --- loss: 1.309225, loss_ss: 0.987089, loss_d: 0.322136
0.1540 --- loss: 0.995879, loss_ss: 0.800075, loss_d: 0.195804
0.1925 --- loss: 1.502339, loss_ss: 1.025514, loss_d: 0.476826
0.2309 --- loss: 1.206986, loss_ss: 1.077138, loss_d: 0.129848
0.2694 --- loss: 1.331417, loss_ss: 0.965980, loss_d: 0.365437
0.3079 --- loss: 1.141853, loss_ss: 0.953595, loss_d: 0.188258
0.3464 --- loss: 1.470409, loss_ss: 0.949551, loss_d: 0.520858
0.3849 --- loss: 1.023526, loss_ss: 0.852151, loss_d: 0.171375
0.4234 --- loss: 1.281361, loss_ss: 0.912315, loss_d: 0.369047
0.4619 --- loss: 1.270315, loss_ss: 0.874177, loss_d: 0.396138
0.5004 --- loss: 0.986631, loss_ss: 0.907644, loss_d: 0.078988
0.5389 --- loss: 1.512704, loss_ss: 0.734608, loss_d: 0.778097
0.5774 --- loss: 1.039803, loss_ss: 0.804923, loss_d: 0.234880
0.6159 --- loss: 1.494462, loss_ss: 1.055151, loss_d: 0.439311
0.6543 --- loss: 1.190019, loss_ss: 0.956457, loss_d: 0.233562
0.6928 --- loss: 0.905934, loss_ss: 0.729253, loss_d: 0.176681
0.7313 --- loss: 0.882859, loss_ss: 0.691377, loss_d: 0.191482
0.7698 --- loss: 1.279044, loss_ss: 1.144771, loss_d: 0.134273
0.8083 --- loss: 0.854933, loss_ss: 0.673574, loss_d: 0.181359
0.8468 --- loss: 1.231944, loss_ss: 0.768197, loss_d: 0.463748
0.8853 --- loss: 0.817817, loss_ss: 0.639082, loss_d: 0.178735
0.9238 --- loss: 1.337858, loss_ss: 1.057620, loss_d: 0.280239
0.9623 --- loss: 1.304110, loss_ss: 0.909145, loss_d: 0.394964
Epoch finished! Loss: 1.1966311367782387
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.719338, loss_ss: 1.124534, loss_d: 0.594804
0.0385 --- loss: 0.978090, loss_ss: 0.813222, loss_d: 0.164869
0.0770 --- loss: 1.485877, loss_ss: 1.249459, loss_d: 0.236418
0.1155 --- loss: 0.997753, loss_ss: 0.850218, loss_d: 0.147535
0.1540 --- loss: 1.113874, loss_ss: 0.856583, loss_d: 0.257291
0.1925 --- loss: 1.056208, loss_ss: 0.736848, loss_d: 0.319360
0.2309 --- loss: 1.127994, loss_ss: 0.977118, loss_d: 0.150876
0.2694 --- loss: 1.506257, loss_ss: 0.965439, loss_d: 0.540819
0.3079 --- loss: 1.043539, loss_ss: 0.865480, loss_d: 0.178059
0.3464 --- loss: 0.963228, loss_ss: 0.693430, loss_d: 0.269798
0.3849 --- loss: 1.498335, loss_ss: 1.314029, loss_d: 0.184306
0.4234 --- loss: 1.204302, loss_ss: 0.775259, loss_d: 0.429043
0.4619 --- loss: 1.138728, loss_ss: 0.844018, loss_d: 0.294711
0.5004 --- loss: 1.623180, loss_ss: 1.077735, loss_d: 0.545445
0.5389 --- loss: 1.426268, loss_ss: 1.213572, loss_d: 0.212696
0.5774 --- loss: 1.486486, loss_ss: 1.124386, loss_d: 0.362100
0.6159 --- loss: 1.425862, loss_ss: 1.241442, loss_d: 0.184421
0.6543 --- loss: 1.485071, loss_ss: 0.747180, loss_d: 0.737890
0.6928 --- loss: 1.020753, loss_ss: 0.782143, loss_d: 0.238610
0.7313 --- loss: 0.827072, loss_ss: 0.599370, loss_d: 0.227701
0.7698 --- loss: 1.017300, loss_ss: 0.717032, loss_d: 0.300268
0.8083 --- loss: 1.716471, loss_ss: 1.069820, loss_d: 0.646651
0.8468 --- loss: 1.358604, loss_ss: 0.814165, loss_d: 0.544439
0.8853 --- loss: 0.991638, loss_ss: 0.772712, loss_d: 0.218925
0.9238 --- loss: 1.200543, loss_ss: 0.837650, loss_d: 0.362893
0.9623 --- loss: 0.975101, loss_ss: 0.819441, loss_d: 0.155660
Epoch finished! Loss: 1.151493038219835
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6583333333333333
             precision    recall  f1-score   support

        0.0       0.78      0.48      0.60       143
        1.0       0.43      0.05      0.08       197
        2.0       0.85      0.76      0.81       506
        3.0       0.85      0.86      0.85        64
        4.0       0.47      0.93      0.63       290

avg / total       0.68      0.66      0.62      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.25  48.25   98.20  78.41     59.74
1  83.33   4.57   98.80  42.86      8.26
2  84.50  76.48   90.35  85.24     80.62
3  98.42  85.94   99.12  84.62     85.27
4  73.17  93.10   66.81  47.20     62.65
Total accuracy: 65.83%
Average sen: 61.67%
Average spec: 90.66%
Macro f1-score: 59.31%
[0.99190724 0.76700085 0.05796598 0.95060563 0.85119253 0.8004837
 0.35622206 0.58699507 0.91596812 0.76055002 0.80436027 0.50098336
 0.62052089 0.82682079 0.72871    0.46916169 0.79849392 0.92722642
 0.25157687 0.42177361 0.51498246 0.85355526 0.94385004 0.90161598
 0.90888119 0.99501365 0.89210248 0.76700723 0.95745313 0.99685621
 0.91962838 0.92771113 0.96597308 0.57736874 0.85652542 0.84409767
 0.99692315 0.95905429 0.91286176 0.90215218]
pred: 0.7745533120818436, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.792013, loss_ss: 2.091863, loss_d: 0.700150
0.0384 --- loss: 2.546886, loss_ss: 1.930016, loss_d: 0.616870
0.0768 --- loss: 2.381176, loss_ss: 1.782517, loss_d: 0.598659
0.1153 --- loss: 2.044269, loss_ss: 1.577941, loss_d: 0.466327
0.1537 --- loss: 2.389060, loss_ss: 1.604024, loss_d: 0.785036
0.1921 --- loss: 2.459690, loss_ss: 1.750747, loss_d: 0.708943
0.2305 --- loss: 2.122571, loss_ss: 1.518390, loss_d: 0.604182
0.2689 --- loss: 2.061357, loss_ss: 1.508672, loss_d: 0.552685
0.3073 --- loss: 2.027128, loss_ss: 1.504882, loss_d: 0.522246
0.3458 --- loss: 2.287460, loss_ss: 1.470866, loss_d: 0.816594
0.3842 --- loss: 2.124782, loss_ss: 1.676469, loss_d: 0.448313
0.4226 --- loss: 2.081722, loss_ss: 1.491960, loss_d: 0.589762
0.4610 --- loss: 1.933182, loss_ss: 1.322116, loss_d: 0.611066
0.4994 --- loss: 2.053385, loss_ss: 1.361429, loss_d: 0.691956
0.5378 --- loss: 2.127640, loss_ss: 1.351188, loss_d: 0.776452
0.5763 --- loss: 2.294959, loss_ss: 1.587197, loss_d: 0.707761
0.6147 --- loss: 2.093133, loss_ss: 1.466740, loss_d: 0.626393
0.6531 --- loss: 1.850861, loss_ss: 1.362053, loss_d: 0.488808
0.6915 --- loss: 1.896988, loss_ss: 1.292886, loss_d: 0.604102
0.7299 --- loss: 2.069762, loss_ss: 1.513173, loss_d: 0.556589
0.7683 --- loss: 1.774951, loss_ss: 1.359070, loss_d: 0.415881
0.8068 --- loss: 2.100583, loss_ss: 1.351574, loss_d: 0.749009
0.8452 --- loss: 1.923782, loss_ss: 1.442275, loss_d: 0.481507
0.8836 --- loss: 2.178198, loss_ss: 1.424150, loss_d: 0.754048
0.9220 --- loss: 2.152812, loss_ss: 1.287068, loss_d: 0.865743
0.9604 --- loss: 1.661831, loss_ss: 1.287080, loss_d: 0.374751
0.9988 --- loss: 1.577562, loss_ss: 1.285834, loss_d: 0.291727
Epoch finished! Loss: 2.085524673645313
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.963049, loss_ss: 1.297504, loss_d: 0.665545
0.0384 --- loss: 1.850747, loss_ss: 1.185639, loss_d: 0.665108
0.0768 --- loss: 1.863493, loss_ss: 1.177189, loss_d: 0.686304
0.1153 --- loss: 1.949354, loss_ss: 1.407212, loss_d: 0.542141
0.1537 --- loss: 1.559376, loss_ss: 1.228917, loss_d: 0.330459
0.1921 --- loss: 1.778743, loss_ss: 1.157732, loss_d: 0.621011
0.2305 --- loss: 1.939873, loss_ss: 1.188989, loss_d: 0.750884
0.2689 --- loss: 1.625868, loss_ss: 1.248998, loss_d: 0.376871
0.3073 --- loss: 1.771353, loss_ss: 1.105997, loss_d: 0.665356
0.3458 --- loss: 1.700942, loss_ss: 1.214678, loss_d: 0.486264
0.3842 --- loss: 1.739150, loss_ss: 1.142215, loss_d: 0.596935
0.4226 --- loss: 1.863689, loss_ss: 1.497684, loss_d: 0.366005
0.4610 --- loss: 1.559417, loss_ss: 1.050943, loss_d: 0.508475
0.4994 --- loss: 1.855406, loss_ss: 1.227615, loss_d: 0.627790
0.5378 --- loss: 1.438782, loss_ss: 1.131307, loss_d: 0.307474
0.5763 --- loss: 1.984447, loss_ss: 1.174444, loss_d: 0.810003
0.6147 --- loss: 1.753238, loss_ss: 1.145812, loss_d: 0.607427
0.6531 --- loss: 1.470111, loss_ss: 1.000769, loss_d: 0.469343
0.6915 --- loss: 2.129547, loss_ss: 1.181430, loss_d: 0.948117
0.7299 --- loss: 1.609186, loss_ss: 1.068589, loss_d: 0.540597
0.7683 --- loss: 1.826971, loss_ss: 1.148428, loss_d: 0.678542
0.8068 --- loss: 1.766950, loss_ss: 1.158646, loss_d: 0.608304
0.8452 --- loss: 2.002759, loss_ss: 1.159722, loss_d: 0.843037
0.8836 --- loss: 1.713841, loss_ss: 1.115473, loss_d: 0.598368
0.9220 --- loss: 1.372454, loss_ss: 0.960487, loss_d: 0.411967
0.9604 --- loss: 1.754857, loss_ss: 1.095600, loss_d: 0.659257
0.9988 --- loss: 1.575046, loss_ss: 1.189942, loss_d: 0.385104
Epoch finished! Loss: 1.75444447856683
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.623877, loss_ss: 0.974522, loss_d: 0.649355
0.0384 --- loss: 1.829602, loss_ss: 0.928807, loss_d: 0.900795
0.0768 --- loss: 1.559281, loss_ss: 0.987166, loss_d: 0.572115
0.1153 --- loss: 1.764399, loss_ss: 1.247770, loss_d: 0.516630
0.1537 --- loss: 1.560740, loss_ss: 0.915378, loss_d: 0.645362
0.1921 --- loss: 1.605465, loss_ss: 1.003911, loss_d: 0.601555
0.2305 --- loss: 1.402544, loss_ss: 0.925223, loss_d: 0.477321
0.2689 --- loss: 1.384700, loss_ss: 0.979386, loss_d: 0.405313
0.3073 --- loss: 1.729690, loss_ss: 1.190635, loss_d: 0.539054
0.3458 --- loss: 1.677976, loss_ss: 1.066890, loss_d: 0.611086
0.3842 --- loss: 1.559146, loss_ss: 1.002840, loss_d: 0.556306
0.4226 --- loss: 1.752322, loss_ss: 1.189620, loss_d: 0.562702
0.4610 --- loss: 1.556017, loss_ss: 1.165942, loss_d: 0.390075
0.4994 --- loss: 1.600962, loss_ss: 1.028217, loss_d: 0.572745
0.5378 --- loss: 1.602462, loss_ss: 1.041126, loss_d: 0.561337
0.5763 --- loss: 1.328122, loss_ss: 0.795055, loss_d: 0.533067
0.6147 --- loss: 1.610732, loss_ss: 1.254699, loss_d: 0.356033
0.6531 --- loss: 1.416698, loss_ss: 0.954949, loss_d: 0.461749
0.6915 --- loss: 1.661486, loss_ss: 1.014902, loss_d: 0.646585
0.7299 --- loss: 1.352526, loss_ss: 0.789629, loss_d: 0.562897
0.7683 --- loss: 1.430759, loss_ss: 1.082368, loss_d: 0.348391
0.8068 --- loss: 1.556606, loss_ss: 1.107784, loss_d: 0.448823
0.8452 --- loss: 1.763788, loss_ss: 1.142214, loss_d: 0.621574
0.8836 --- loss: 1.400385, loss_ss: 0.888342, loss_d: 0.512043
0.9220 --- loss: 1.513807, loss_ss: 0.861569, loss_d: 0.652238
0.9604 --- loss: 1.439686, loss_ss: 1.006093, loss_d: 0.433593
0.9988 --- loss: 2.258330, loss_ss: 1.394733, loss_d: 0.863597
Epoch finished! Loss: 1.6275356595332806
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.323849, loss_ss: 0.853222, loss_d: 0.470627
0.0384 --- loss: 1.600089, loss_ss: 0.800551, loss_d: 0.799538
0.0768 --- loss: 1.171893, loss_ss: 0.640788, loss_d: 0.531105
0.1153 --- loss: 1.981893, loss_ss: 1.292802, loss_d: 0.689091
0.1537 --- loss: 1.382775, loss_ss: 0.955462, loss_d: 0.427313
0.1921 --- loss: 1.334138, loss_ss: 0.984076, loss_d: 0.350061
0.2305 --- loss: 1.739594, loss_ss: 1.010762, loss_d: 0.728832
0.2689 --- loss: 1.660505, loss_ss: 1.382960, loss_d: 0.277545
0.3073 --- loss: 1.364950, loss_ss: 0.830630, loss_d: 0.534320
0.3458 --- loss: 1.252953, loss_ss: 0.663986, loss_d: 0.588966
0.3842 --- loss: 1.319187, loss_ss: 0.954186, loss_d: 0.365001
0.4226 --- loss: 1.490532, loss_ss: 0.930719, loss_d: 0.559813
0.4610 --- loss: 1.109550, loss_ss: 0.767676, loss_d: 0.341873
0.4994 --- loss: 1.641345, loss_ss: 1.064277, loss_d: 0.577069
0.5378 --- loss: 1.610188, loss_ss: 0.923974, loss_d: 0.686214
0.5763 --- loss: 1.690284, loss_ss: 1.013857, loss_d: 0.676427
0.6147 --- loss: 1.472441, loss_ss: 0.893514, loss_d: 0.578927
0.6531 --- loss: 1.235765, loss_ss: 0.939113, loss_d: 0.296652
0.6915 --- loss: 1.651973, loss_ss: 0.965910, loss_d: 0.686063
0.7299 --- loss: 1.448724, loss_ss: 1.147712, loss_d: 0.301012
0.7683 --- loss: 1.542615, loss_ss: 1.090777, loss_d: 0.451838
0.8068 --- loss: 1.323096, loss_ss: 0.969803, loss_d: 0.353292
0.8452 --- loss: 1.377334, loss_ss: 1.083151, loss_d: 0.294183
0.8836 --- loss: 1.699649, loss_ss: 0.984242, loss_d: 0.715408
0.9220 --- loss: 1.327213, loss_ss: 0.693847, loss_d: 0.633367
0.9604 --- loss: 1.333091, loss_ss: 0.902236, loss_d: 0.430855
0.9988 --- loss: 1.150247, loss_ss: 0.704464, loss_d: 0.445783
Epoch finished! Loss: 1.5608747899532318
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.558935, loss_ss: 1.140539, loss_d: 0.418396
0.0384 --- loss: 1.224658, loss_ss: 0.938789, loss_d: 0.285869
0.0768 --- loss: 1.122796, loss_ss: 0.820109, loss_d: 0.302687
0.1153 --- loss: 1.496776, loss_ss: 1.127227, loss_d: 0.369549
0.1537 --- loss: 1.362981, loss_ss: 0.757944, loss_d: 0.605037
0.1921 --- loss: 1.253506, loss_ss: 0.885786, loss_d: 0.367720
0.2305 --- loss: 1.418385, loss_ss: 0.938976, loss_d: 0.479409
0.2689 --- loss: 1.360451, loss_ss: 1.011522, loss_d: 0.348929
0.3073 --- loss: 1.532579, loss_ss: 0.851791, loss_d: 0.680788
0.3458 --- loss: 1.505676, loss_ss: 1.222005, loss_d: 0.283671
0.3842 --- loss: 1.505782, loss_ss: 0.788159, loss_d: 0.717623
0.4226 --- loss: 1.365869, loss_ss: 0.982751, loss_d: 0.383118
0.4610 --- loss: 1.437601, loss_ss: 0.981363, loss_d: 0.456239
0.4994 --- loss: 1.534392, loss_ss: 1.147536, loss_d: 0.386856
0.5378 --- loss: 1.556723, loss_ss: 1.006888, loss_d: 0.549835
0.5763 --- loss: 1.448139, loss_ss: 0.918316, loss_d: 0.529823
0.6147 --- loss: 1.676973, loss_ss: 1.125323, loss_d: 0.551650
0.6531 --- loss: 1.833246, loss_ss: 1.095361, loss_d: 0.737885
0.6915 --- loss: 1.714844, loss_ss: 1.272648, loss_d: 0.442197
0.7299 --- loss: 1.438032, loss_ss: 0.851699, loss_d: 0.586333
0.7683 --- loss: 1.516861, loss_ss: 1.100950, loss_d: 0.415910
0.8068 --- loss: 1.334961, loss_ss: 1.083580, loss_d: 0.251380
0.8452 --- loss: 1.245227, loss_ss: 0.808617, loss_d: 0.436610
0.8836 --- loss: 1.604542, loss_ss: 1.029804, loss_d: 0.574738
0.9220 --- loss: 1.503743, loss_ss: 1.006189, loss_d: 0.497554
0.9604 --- loss: 1.559518, loss_ss: 0.990198, loss_d: 0.569320
0.9988 --- loss: 1.715324, loss_ss: 0.750171, loss_d: 0.965153
Epoch finished! Loss: 1.4632883369922638
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.381800, loss_ss: 1.003671, loss_d: 0.378129
0.0384 --- loss: 1.345417, loss_ss: 0.838033, loss_d: 0.507385
0.0768 --- loss: 1.251590, loss_ss: 0.795485, loss_d: 0.456105
0.1153 --- loss: 0.861229, loss_ss: 0.635374, loss_d: 0.225855
0.1537 --- loss: 1.356026, loss_ss: 0.832550, loss_d: 0.523477
0.1921 --- loss: 1.476953, loss_ss: 1.081930, loss_d: 0.395023
0.2305 --- loss: 1.540317, loss_ss: 1.012702, loss_d: 0.527615
0.2689 --- loss: 1.268215, loss_ss: 0.876060, loss_d: 0.392155
0.3073 --- loss: 1.502981, loss_ss: 1.064165, loss_d: 0.438816
0.3458 --- loss: 1.609340, loss_ss: 0.840917, loss_d: 0.768422
0.3842 --- loss: 1.190381, loss_ss: 0.867149, loss_d: 0.323232
0.4226 --- loss: 1.512830, loss_ss: 0.860792, loss_d: 0.652038
0.4610 --- loss: 1.211736, loss_ss: 0.733356, loss_d: 0.478380
0.4994 --- loss: 1.357266, loss_ss: 1.089993, loss_d: 0.267273
0.5378 --- loss: 1.724612, loss_ss: 0.944004, loss_d: 0.780607
0.5763 --- loss: 1.215492, loss_ss: 0.669936, loss_d: 0.545556
0.6147 --- loss: 1.077561, loss_ss: 0.665890, loss_d: 0.411672
0.6531 --- loss: 1.895153, loss_ss: 1.077347, loss_d: 0.817806
0.6915 --- loss: 1.736545, loss_ss: 1.205518, loss_d: 0.531027
0.7299 --- loss: 1.051626, loss_ss: 0.705002, loss_d: 0.346624
0.7683 --- loss: 1.898700, loss_ss: 1.462909, loss_d: 0.435791
0.8068 --- loss: 0.931351, loss_ss: 0.792108, loss_d: 0.139243
0.8452 --- loss: 1.118129, loss_ss: 0.750721, loss_d: 0.367408
0.8836 --- loss: 1.480596, loss_ss: 0.981478, loss_d: 0.499119
0.9220 --- loss: 1.188984, loss_ss: 0.778026, loss_d: 0.410958
0.9604 --- loss: 1.153175, loss_ss: 0.964868, loss_d: 0.188307
0.9988 --- loss: 1.186398, loss_ss: 1.066288, loss_d: 0.120110
Epoch finished! Loss: 1.3533541947603225
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.114403, loss_ss: 0.973920, loss_d: 0.140483
0.0384 --- loss: 1.349585, loss_ss: 0.910794, loss_d: 0.438791
0.0768 --- loss: 1.095669, loss_ss: 0.806358, loss_d: 0.289311
0.1153 --- loss: 1.467426, loss_ss: 1.021067, loss_d: 0.446359
0.1537 --- loss: 1.582348, loss_ss: 0.840218, loss_d: 0.742129
0.1921 --- loss: 1.557243, loss_ss: 1.073262, loss_d: 0.483981
0.2305 --- loss: 1.502743, loss_ss: 0.996985, loss_d: 0.505758
0.2689 --- loss: 1.152722, loss_ss: 0.850623, loss_d: 0.302099
0.3073 --- loss: 1.561769, loss_ss: 0.909672, loss_d: 0.652097
0.3458 --- loss: 1.095238, loss_ss: 0.781404, loss_d: 0.313835
0.3842 --- loss: 1.224622, loss_ss: 0.938602, loss_d: 0.286020
0.4226 --- loss: 1.255918, loss_ss: 1.029426, loss_d: 0.226492
0.4610 --- loss: 1.110899, loss_ss: 0.858159, loss_d: 0.252741
0.4994 --- loss: 1.236216, loss_ss: 0.898156, loss_d: 0.338060
0.5378 --- loss: 1.185473, loss_ss: 0.842584, loss_d: 0.342888
0.5763 --- loss: 1.219024, loss_ss: 0.692154, loss_d: 0.526870
0.6147 --- loss: 1.313444, loss_ss: 0.834305, loss_d: 0.479139
0.6531 --- loss: 1.167138, loss_ss: 0.981792, loss_d: 0.185346
0.6915 --- loss: 1.510134, loss_ss: 0.709913, loss_d: 0.800221
0.7299 --- loss: 1.098439, loss_ss: 0.663608, loss_d: 0.434830
0.7683 --- loss: 1.359165, loss_ss: 0.666215, loss_d: 0.692951
0.8068 --- loss: 1.217662, loss_ss: 0.962703, loss_d: 0.254959
0.8452 --- loss: 1.390127, loss_ss: 1.096747, loss_d: 0.293380
0.8836 --- loss: 0.920904, loss_ss: 0.751138, loss_d: 0.169766
0.9220 --- loss: 1.261596, loss_ss: 1.052054, loss_d: 0.209542
0.9604 --- loss: 1.996681, loss_ss: 0.950409, loss_d: 1.046272
0.9988 --- loss: 0.797707, loss_ss: 0.536275, loss_d: 0.261432
Epoch finished! Loss: 1.2872350055437822
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.973465, loss_ss: 0.598559, loss_d: 0.374907
0.0384 --- loss: 1.880555, loss_ss: 1.457454, loss_d: 0.423101
0.0768 --- loss: 0.995944, loss_ss: 0.773696, loss_d: 0.222248
0.1153 --- loss: 1.232436, loss_ss: 0.839209, loss_d: 0.393226
0.1537 --- loss: 1.144055, loss_ss: 0.821370, loss_d: 0.322685
0.1921 --- loss: 1.167426, loss_ss: 0.956070, loss_d: 0.211356
0.2305 --- loss: 0.907570, loss_ss: 0.622296, loss_d: 0.285274
0.2689 --- loss: 0.821457, loss_ss: 0.610038, loss_d: 0.211419
0.3073 --- loss: 1.342059, loss_ss: 0.810789, loss_d: 0.531270
0.3458 --- loss: 1.486092, loss_ss: 0.961492, loss_d: 0.524601
0.3842 --- loss: 1.472930, loss_ss: 0.945099, loss_d: 0.527831
0.4226 --- loss: 1.609172, loss_ss: 1.016410, loss_d: 0.592762
0.4610 --- loss: 1.323762, loss_ss: 0.936071, loss_d: 0.387691
0.4994 --- loss: 1.055044, loss_ss: 0.847109, loss_d: 0.207935
0.5378 --- loss: 1.682781, loss_ss: 1.480063, loss_d: 0.202718
0.5763 --- loss: 1.000985, loss_ss: 0.723011, loss_d: 0.277974
0.6147 --- loss: 1.645940, loss_ss: 0.963138, loss_d: 0.682802
0.6531 --- loss: 1.216426, loss_ss: 1.006184, loss_d: 0.210241
0.6915 --- loss: 1.188949, loss_ss: 0.787200, loss_d: 0.401750
0.7299 --- loss: 1.401735, loss_ss: 0.960869, loss_d: 0.440866
0.7683 --- loss: 1.064957, loss_ss: 0.906576, loss_d: 0.158380
0.8068 --- loss: 1.832170, loss_ss: 0.673098, loss_d: 1.159072
0.8452 --- loss: 1.128071, loss_ss: 0.793830, loss_d: 0.334241
0.8836 --- loss: 1.970807, loss_ss: 0.811373, loss_d: 1.159434
0.9220 --- loss: 1.269969, loss_ss: 1.029973, loss_d: 0.239996
0.9604 --- loss: 0.970688, loss_ss: 0.679797, loss_d: 0.290891
0.9988 --- loss: 2.039183, loss_ss: 1.725180, loss_d: 0.314002
Epoch finished! Loss: 1.2488500909163402
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.320928, loss_ss: 0.759113, loss_d: 0.561815
0.0384 --- loss: 1.141887, loss_ss: 0.767820, loss_d: 0.374067
0.0768 --- loss: 0.938664, loss_ss: 0.745834, loss_d: 0.192830
0.1153 --- loss: 0.921895, loss_ss: 0.694831, loss_d: 0.227064
0.1537 --- loss: 0.955778, loss_ss: 0.709502, loss_d: 0.246276
0.1921 --- loss: 0.821814, loss_ss: 0.658841, loss_d: 0.162973
0.2305 --- loss: 1.597420, loss_ss: 0.765643, loss_d: 0.831778
0.2689 --- loss: 1.650702, loss_ss: 1.200383, loss_d: 0.450319
0.3073 --- loss: 0.919255, loss_ss: 0.727503, loss_d: 0.191752
0.3458 --- loss: 1.128629, loss_ss: 0.631367, loss_d: 0.497262
0.3842 --- loss: 0.926710, loss_ss: 0.728009, loss_d: 0.198701
0.4226 --- loss: 1.267380, loss_ss: 1.068186, loss_d: 0.199194
0.4610 --- loss: 1.189793, loss_ss: 0.914943, loss_d: 0.274850
0.4994 --- loss: 0.803954, loss_ss: 0.581849, loss_d: 0.222105
0.5378 --- loss: 1.005850, loss_ss: 0.829884, loss_d: 0.175966
0.5763 --- loss: 1.386928, loss_ss: 1.095775, loss_d: 0.291152
0.6147 --- loss: 1.224912, loss_ss: 1.055614, loss_d: 0.169298
0.6531 --- loss: 0.917225, loss_ss: 0.621429, loss_d: 0.295796
0.6915 --- loss: 1.648865, loss_ss: 0.846207, loss_d: 0.802657
0.7299 --- loss: 1.244075, loss_ss: 0.930729, loss_d: 0.313346
0.7683 --- loss: 0.750183, loss_ss: 0.601608, loss_d: 0.148575
0.8068 --- loss: 1.367217, loss_ss: 0.889618, loss_d: 0.477599
0.8452 --- loss: 1.574139, loss_ss: 0.774896, loss_d: 0.799243
0.8836 --- loss: 1.192962, loss_ss: 0.881514, loss_d: 0.311448
0.9220 --- loss: 0.980643, loss_ss: 0.758031, loss_d: 0.222612
0.9604 --- loss: 1.289900, loss_ss: 0.893471, loss_d: 0.396429
0.9988 --- loss: 1.378458, loss_ss: 1.293048, loss_d: 0.085410
Epoch finished! Loss: 1.1990109035601983
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.341769, loss_ss: 0.869551, loss_d: 0.472218
0.0384 --- loss: 1.010491, loss_ss: 0.677595, loss_d: 0.332895
0.0768 --- loss: 0.970841, loss_ss: 0.795422, loss_d: 0.175419
0.1153 --- loss: 1.093494, loss_ss: 0.930743, loss_d: 0.162751
0.1537 --- loss: 1.282268, loss_ss: 0.813603, loss_d: 0.468665
0.1921 --- loss: 1.051135, loss_ss: 0.955967, loss_d: 0.095168
0.2305 --- loss: 1.033557, loss_ss: 0.812576, loss_d: 0.220981
0.2689 --- loss: 1.573246, loss_ss: 0.989251, loss_d: 0.583995
0.3073 --- loss: 1.086528, loss_ss: 0.842353, loss_d: 0.244175
0.3458 --- loss: 1.123608, loss_ss: 0.886789, loss_d: 0.236819
0.3842 --- loss: 1.306112, loss_ss: 1.098322, loss_d: 0.207790
0.4226 --- loss: 1.098537, loss_ss: 0.919900, loss_d: 0.178637
0.4610 --- loss: 1.180450, loss_ss: 0.644393, loss_d: 0.536057
0.4994 --- loss: 1.099745, loss_ss: 0.849262, loss_d: 0.250482
0.5378 --- loss: 1.264899, loss_ss: 0.980212, loss_d: 0.284687
0.5763 --- loss: 1.003156, loss_ss: 0.769639, loss_d: 0.233517
0.6147 --- loss: 0.843610, loss_ss: 0.731761, loss_d: 0.111849
0.6531 --- loss: 1.062051, loss_ss: 0.804903, loss_d: 0.257148
0.6915 --- loss: 1.021984, loss_ss: 0.869050, loss_d: 0.152934
0.7299 --- loss: 0.882030, loss_ss: 0.656230, loss_d: 0.225800
0.7683 --- loss: 1.086264, loss_ss: 0.784990, loss_d: 0.301274
0.8068 --- loss: 1.011952, loss_ss: 0.803831, loss_d: 0.208121
0.8452 --- loss: 1.349795, loss_ss: 0.939507, loss_d: 0.410288
0.8836 --- loss: 1.112344, loss_ss: 0.813358, loss_d: 0.298986
0.9220 --- loss: 1.143121, loss_ss: 0.612837, loss_d: 0.530284
0.9604 --- loss: 0.952490, loss_ss: 0.559104, loss_d: 0.393386
0.9988 --- loss: 0.923871, loss_ss: 0.736782, loss_d: 0.187089
Epoch finished! Loss: 1.144681148804151
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5876190476190476
             precision    recall  f1-score   support

        0.0       0.27      0.92      0.41        25
        1.0       0.40      0.04      0.08        93
        2.0       0.47      0.93      0.62       324
        3.0       1.00      0.49      0.65       484
        4.0       0.71      0.43      0.53       124

avg / total       0.73      0.59      0.57      1050
 


====== chp044-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.81  92.00   93.85   26.74     41.44
1  90.95   4.30   99.37   40.00      7.77
2  65.33  93.21   52.89   46.89     62.40
3  76.29  48.55  100.00  100.00     65.37
4  91.14  42.74   97.62   70.67     53.27
Total accuracy: 58.76%
Average sen: 56.16%
Average spec: 88.75%
Macro f1-score: 46.05%
[0.86566722 0.96932751 0.80789816 0.81020647 0.67599553 0.93088615
 0.99828535 0.99772805 0.9201318  0.97480768 0.98973185 0.92400092
 0.96258235 0.99729723 0.90222198 0.81482995 0.82987279 0.80473357
 0.91033155 0.95577765 0.97769606 0.96155798 0.87542731 0.98206598
 0.92526084 0.90938407 0.95442605 0.90419102 0.78794765 0.82428116
 0.9693712  0.68373913 0.93636984 0.95506728 0.8690601 ]
pred: 0.9016616974558149, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.502312, loss_ss: 1.833336, loss_d: 0.668976
0.0385 --- loss: 1.962324, loss_ss: 1.609067, loss_d: 0.353257
0.0770 --- loss: 2.000929, loss_ss: 1.557038, loss_d: 0.443891
0.1155 --- loss: 2.729065, loss_ss: 1.620267, loss_d: 1.108798
0.1540 --- loss: 1.807249, loss_ss: 1.438870, loss_d: 0.368379
0.1925 --- loss: 2.018720, loss_ss: 1.464330, loss_d: 0.554390
0.2309 --- loss: 2.180567, loss_ss: 1.566853, loss_d: 0.613713
0.2694 --- loss: 2.199307, loss_ss: 1.585570, loss_d: 0.613737
0.3079 --- loss: 2.295207, loss_ss: 1.530260, loss_d: 0.764946
0.3464 --- loss: 2.159758, loss_ss: 1.536397, loss_d: 0.623360
0.3849 --- loss: 2.256951, loss_ss: 1.558252, loss_d: 0.698699
0.4234 --- loss: 2.392635, loss_ss: 1.494434, loss_d: 0.898201
0.4619 --- loss: 2.139444, loss_ss: 1.464836, loss_d: 0.674608
0.5004 --- loss: 2.043447, loss_ss: 1.465383, loss_d: 0.578065
0.5389 --- loss: 1.818289, loss_ss: 1.359351, loss_d: 0.458939
0.5774 --- loss: 1.806077, loss_ss: 1.402763, loss_d: 0.403314
0.6159 --- loss: 1.579629, loss_ss: 1.090505, loss_d: 0.489124
0.6543 --- loss: 2.001150, loss_ss: 1.472154, loss_d: 0.528995
0.6928 --- loss: 2.134705, loss_ss: 1.178461, loss_d: 0.956244
0.7313 --- loss: 1.518520, loss_ss: 1.152919, loss_d: 0.365601
0.7698 --- loss: 1.512132, loss_ss: 1.196654, loss_d: 0.315478
0.8083 --- loss: 1.810770, loss_ss: 1.364336, loss_d: 0.446434
0.8468 --- loss: 1.740887, loss_ss: 1.260747, loss_d: 0.480140
0.8853 --- loss: 1.939817, loss_ss: 1.339494, loss_d: 0.600323
0.9238 --- loss: 1.725283, loss_ss: 1.169420, loss_d: 0.555863
0.9623 --- loss: 1.874168, loss_ss: 1.134884, loss_d: 0.739284
Epoch finished! Loss: 2.0166578071918266
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.655759, loss_ss: 1.137549, loss_d: 0.518210
0.0385 --- loss: 1.821290, loss_ss: 1.354166, loss_d: 0.467124
0.0770 --- loss: 1.788965, loss_ss: 1.278309, loss_d: 0.510656
0.1155 --- loss: 1.935744, loss_ss: 1.184070, loss_d: 0.751674
0.1540 --- loss: 1.937223, loss_ss: 1.283515, loss_d: 0.653709
0.1925 --- loss: 1.750730, loss_ss: 1.204276, loss_d: 0.546455
0.2309 --- loss: 1.728520, loss_ss: 1.205816, loss_d: 0.522704
0.2694 --- loss: 1.713577, loss_ss: 1.229569, loss_d: 0.484009
0.3079 --- loss: 2.003114, loss_ss: 1.230978, loss_d: 0.772136
0.3464 --- loss: 1.564623, loss_ss: 1.093060, loss_d: 0.471563
0.3849 --- loss: 1.492590, loss_ss: 1.088002, loss_d: 0.404587
0.4234 --- loss: 1.429182, loss_ss: 0.948420, loss_d: 0.480762
0.4619 --- loss: 1.700696, loss_ss: 1.290411, loss_d: 0.410286
0.5004 --- loss: 1.566665, loss_ss: 1.200759, loss_d: 0.365906
0.5389 --- loss: 1.769069, loss_ss: 0.999141, loss_d: 0.769928
0.5774 --- loss: 1.413854, loss_ss: 0.941870, loss_d: 0.471983
0.6159 --- loss: 1.515182, loss_ss: 1.113487, loss_d: 0.401695
0.6543 --- loss: 1.809966, loss_ss: 1.188864, loss_d: 0.621102
0.6928 --- loss: 1.753593, loss_ss: 1.311224, loss_d: 0.442369
0.7313 --- loss: 1.792162, loss_ss: 1.028727, loss_d: 0.763435
0.7698 --- loss: 1.268528, loss_ss: 0.888248, loss_d: 0.380280
0.8083 --- loss: 1.370401, loss_ss: 0.767972, loss_d: 0.602429
0.8468 --- loss: 1.845496, loss_ss: 1.071914, loss_d: 0.773582
0.8853 --- loss: 1.488138, loss_ss: 0.941301, loss_d: 0.546837
0.9238 --- loss: 1.633306, loss_ss: 1.098795, loss_d: 0.534510
0.9623 --- loss: 1.648685, loss_ss: 1.205098, loss_d: 0.443587
Epoch finished! Loss: 1.6855538149137754
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.359629, loss_ss: 0.741042, loss_d: 0.618587
0.0385 --- loss: 1.723101, loss_ss: 0.898078, loss_d: 0.825023
0.0770 --- loss: 1.760299, loss_ss: 1.289391, loss_d: 0.470908
0.1155 --- loss: 1.766812, loss_ss: 1.405208, loss_d: 0.361604
0.1540 --- loss: 1.950706, loss_ss: 1.035069, loss_d: 0.915637
0.1925 --- loss: 1.360438, loss_ss: 0.850712, loss_d: 0.509726
0.2309 --- loss: 1.595592, loss_ss: 0.996231, loss_d: 0.599361
0.2694 --- loss: 1.486853, loss_ss: 1.054402, loss_d: 0.432450
0.3079 --- loss: 1.275735, loss_ss: 0.880468, loss_d: 0.395267
0.3464 --- loss: 1.918343, loss_ss: 1.268702, loss_d: 0.649641
0.3849 --- loss: 1.687508, loss_ss: 1.221514, loss_d: 0.465994
0.4234 --- loss: 1.506631, loss_ss: 0.987828, loss_d: 0.518803
0.4619 --- loss: 1.662540, loss_ss: 0.993070, loss_d: 0.669469
0.5004 --- loss: 1.649495, loss_ss: 0.889495, loss_d: 0.760000
0.5389 --- loss: 2.389040, loss_ss: 1.526940, loss_d: 0.862100
0.5774 --- loss: 1.362095, loss_ss: 0.832922, loss_d: 0.529173
0.6159 --- loss: 1.489262, loss_ss: 1.157676, loss_d: 0.331586
0.6543 --- loss: 1.351394, loss_ss: 0.823648, loss_d: 0.527746
0.6928 --- loss: 1.411834, loss_ss: 1.107940, loss_d: 0.303894
0.7313 --- loss: 1.620824, loss_ss: 1.139139, loss_d: 0.481686
0.7698 --- loss: 1.638890, loss_ss: 1.268534, loss_d: 0.370357
0.8083 --- loss: 1.402874, loss_ss: 0.942101, loss_d: 0.460773
0.8468 --- loss: 1.451183, loss_ss: 0.823403, loss_d: 0.627780
0.8853 --- loss: 1.588351, loss_ss: 0.904986, loss_d: 0.683365
0.9238 --- loss: 1.193754, loss_ss: 0.796634, loss_d: 0.397120
0.9623 --- loss: 1.591897, loss_ss: 0.936103, loss_d: 0.655793
Epoch finished! Loss: 1.5564253514337725
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.556234, loss_ss: 0.944288, loss_d: 0.611946
0.0385 --- loss: 1.373525, loss_ss: 1.030833, loss_d: 0.342692
0.0770 --- loss: 1.744201, loss_ss: 1.194548, loss_d: 0.549653
0.1155 --- loss: 1.669220, loss_ss: 0.828904, loss_d: 0.840316
0.1540 --- loss: 1.508414, loss_ss: 0.977695, loss_d: 0.530719
0.1925 --- loss: 1.418631, loss_ss: 0.783418, loss_d: 0.635213
0.2309 --- loss: 1.513143, loss_ss: 0.942469, loss_d: 0.570673
0.2694 --- loss: 1.549754, loss_ss: 0.816934, loss_d: 0.732820
0.3079 --- loss: 1.458386, loss_ss: 0.889532, loss_d: 0.568854
0.3464 --- loss: 1.356372, loss_ss: 0.770273, loss_d: 0.586098
0.3849 --- loss: 1.711596, loss_ss: 0.903121, loss_d: 0.808475
0.4234 --- loss: 1.544937, loss_ss: 0.815487, loss_d: 0.729450
0.4619 --- loss: 1.321127, loss_ss: 0.896473, loss_d: 0.424655
0.5004 --- loss: 1.467079, loss_ss: 0.902906, loss_d: 0.564174
0.5389 --- loss: 1.312034, loss_ss: 0.915675, loss_d: 0.396359
0.5774 --- loss: 1.445522, loss_ss: 1.129029, loss_d: 0.316493
0.6159 --- loss: 1.631544, loss_ss: 0.914280, loss_d: 0.717264
0.6543 --- loss: 1.408571, loss_ss: 0.928382, loss_d: 0.480190
0.6928 --- loss: 1.127932, loss_ss: 0.825645, loss_d: 0.302287
0.7313 --- loss: 1.715293, loss_ss: 1.158019, loss_d: 0.557274
0.7698 --- loss: 1.905469, loss_ss: 1.261845, loss_d: 0.643624
0.8083 --- loss: 1.608213, loss_ss: 1.080986, loss_d: 0.527227
0.8468 --- loss: 1.409173, loss_ss: 0.714566, loss_d: 0.694607
0.8853 --- loss: 1.231326, loss_ss: 0.810325, loss_d: 0.421001
0.9238 --- loss: 1.272004, loss_ss: 1.016653, loss_d: 0.255352
0.9623 --- loss: 1.179943, loss_ss: 0.850352, loss_d: 0.329591
Epoch finished! Loss: 1.4684186971325672
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.293938, loss_ss: 1.051724, loss_d: 0.242214
0.0385 --- loss: 1.415028, loss_ss: 0.923716, loss_d: 0.491313
0.0770 --- loss: 1.408955, loss_ss: 0.980882, loss_d: 0.428073
0.1155 --- loss: 1.055075, loss_ss: 0.715949, loss_d: 0.339126
0.1540 --- loss: 1.258661, loss_ss: 0.826622, loss_d: 0.432039
0.1925 --- loss: 1.392582, loss_ss: 1.140364, loss_d: 0.252218
0.2309 --- loss: 1.123459, loss_ss: 0.740641, loss_d: 0.382818
0.2694 --- loss: 1.636132, loss_ss: 1.134031, loss_d: 0.502101
0.3079 --- loss: 1.305647, loss_ss: 0.871089, loss_d: 0.434558
0.3464 --- loss: 1.619099, loss_ss: 0.898078, loss_d: 0.721021
0.3849 --- loss: 1.109040, loss_ss: 0.847081, loss_d: 0.261960
0.4234 --- loss: 1.468163, loss_ss: 1.060500, loss_d: 0.407663
0.4619 --- loss: 1.515613, loss_ss: 1.017023, loss_d: 0.498590
0.5004 --- loss: 1.443843, loss_ss: 0.886283, loss_d: 0.557559
0.5389 --- loss: 0.816109, loss_ss: 0.502607, loss_d: 0.313502
0.5774 --- loss: 1.106935, loss_ss: 0.732128, loss_d: 0.374807
0.6159 --- loss: 1.432084, loss_ss: 1.000995, loss_d: 0.431089
0.6543 --- loss: 1.596346, loss_ss: 1.190413, loss_d: 0.405932
0.6928 --- loss: 1.225482, loss_ss: 0.919353, loss_d: 0.306129
0.7313 --- loss: 1.265102, loss_ss: 1.006637, loss_d: 0.258465
0.7698 --- loss: 1.398424, loss_ss: 0.870022, loss_d: 0.528402
0.8083 --- loss: 1.326091, loss_ss: 0.885157, loss_d: 0.440935
0.8468 --- loss: 1.624356, loss_ss: 0.955387, loss_d: 0.668969
0.8853 --- loss: 1.640803, loss_ss: 1.019410, loss_d: 0.621393
0.9238 --- loss: 0.909631, loss_ss: 0.695053, loss_d: 0.214578
0.9623 --- loss: 1.663268, loss_ss: 0.947247, loss_d: 0.716021
Epoch finished! Loss: 1.366243260017233
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.359169, loss_ss: 0.963848, loss_d: 0.395321
0.0385 --- loss: 1.253863, loss_ss: 0.931954, loss_d: 0.321908
0.0770 --- loss: 1.300960, loss_ss: 0.902709, loss_d: 0.398250
0.1155 --- loss: 1.011451, loss_ss: 0.770975, loss_d: 0.240476
0.1540 --- loss: 1.345659, loss_ss: 1.045786, loss_d: 0.299873
0.1925 --- loss: 1.067904, loss_ss: 0.777216, loss_d: 0.290688
0.2309 --- loss: 1.303686, loss_ss: 1.109473, loss_d: 0.194213
0.2694 --- loss: 1.365264, loss_ss: 0.986374, loss_d: 0.378890
0.3079 --- loss: 1.420052, loss_ss: 0.920099, loss_d: 0.499953
0.3464 --- loss: 1.188528, loss_ss: 0.820354, loss_d: 0.368174
0.3849 --- loss: 1.663432, loss_ss: 1.003643, loss_d: 0.659789
0.4234 --- loss: 1.795071, loss_ss: 1.128103, loss_d: 0.666968
0.4619 --- loss: 1.325121, loss_ss: 0.846979, loss_d: 0.478142
0.5004 --- loss: 1.336153, loss_ss: 0.715042, loss_d: 0.621111
0.5389 --- loss: 1.713512, loss_ss: 0.821627, loss_d: 0.891885
0.5774 --- loss: 1.163144, loss_ss: 0.870532, loss_d: 0.292611
0.6159 --- loss: 1.522001, loss_ss: 0.855003, loss_d: 0.666998
0.6543 --- loss: 1.668536, loss_ss: 0.697292, loss_d: 0.971244
0.6928 --- loss: 1.539116, loss_ss: 0.861638, loss_d: 0.677478
0.7313 --- loss: 1.066369, loss_ss: 0.858154, loss_d: 0.208216
0.7698 --- loss: 1.544247, loss_ss: 1.118530, loss_d: 0.425716
0.8083 --- loss: 0.982487, loss_ss: 0.707921, loss_d: 0.274566
0.8468 --- loss: 1.112120, loss_ss: 0.892280, loss_d: 0.219840
0.8853 --- loss: 1.171758, loss_ss: 0.964472, loss_d: 0.207286
0.9238 --- loss: 1.211349, loss_ss: 0.879198, loss_d: 0.332150
0.9623 --- loss: 1.248204, loss_ss: 0.747700, loss_d: 0.500504
Epoch finished! Loss: 1.3082710366451602
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.237774, loss_ss: 0.976643, loss_d: 0.261131
0.0385 --- loss: 1.253421, loss_ss: 0.996859, loss_d: 0.256562
0.0770 --- loss: 1.061102, loss_ss: 0.849766, loss_d: 0.211336
0.1155 --- loss: 1.067832, loss_ss: 0.883946, loss_d: 0.183886
0.1540 --- loss: 1.062607, loss_ss: 0.645138, loss_d: 0.417469
0.1925 --- loss: 1.360234, loss_ss: 0.809404, loss_d: 0.550829
0.2309 --- loss: 0.922485, loss_ss: 0.793816, loss_d: 0.128669
0.2694 --- loss: 0.883459, loss_ss: 0.729311, loss_d: 0.154148
0.3079 --- loss: 1.045786, loss_ss: 0.667287, loss_d: 0.378499
0.3464 --- loss: 1.170947, loss_ss: 0.762539, loss_d: 0.408408
0.3849 --- loss: 1.631358, loss_ss: 0.853313, loss_d: 0.778044
0.4234 --- loss: 1.654759, loss_ss: 1.452072, loss_d: 0.202687
0.4619 --- loss: 1.046251, loss_ss: 0.684717, loss_d: 0.361533
0.5004 --- loss: 1.016922, loss_ss: 0.819903, loss_d: 0.197018
0.5389 --- loss: 1.269577, loss_ss: 0.800207, loss_d: 0.469370
0.5774 --- loss: 1.336384, loss_ss: 0.954789, loss_d: 0.381595
0.6159 --- loss: 1.147024, loss_ss: 0.671677, loss_d: 0.475347
0.6543 --- loss: 1.493042, loss_ss: 0.996328, loss_d: 0.496715
0.6928 --- loss: 1.334141, loss_ss: 0.902209, loss_d: 0.431932
0.7313 --- loss: 1.470546, loss_ss: 0.914839, loss_d: 0.555707
0.7698 --- loss: 1.323609, loss_ss: 1.049978, loss_d: 0.273631
0.8083 --- loss: 1.754904, loss_ss: 1.073520, loss_d: 0.681384
0.8468 --- loss: 1.205366, loss_ss: 1.071499, loss_d: 0.133867
0.8853 --- loss: 1.454185, loss_ss: 0.712209, loss_d: 0.741976
0.9238 --- loss: 1.249618, loss_ss: 1.032440, loss_d: 0.217177
0.9623 --- loss: 1.060580, loss_ss: 0.617983, loss_d: 0.442597
Epoch finished! Loss: 1.2370011007923878
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.519355, loss_ss: 1.113338, loss_d: 0.406016
0.0385 --- loss: 1.092830, loss_ss: 0.671118, loss_d: 0.421712
0.0770 --- loss: 1.132630, loss_ss: 0.641781, loss_d: 0.490849
0.1155 --- loss: 1.101557, loss_ss: 0.753481, loss_d: 0.348076
0.1540 --- loss: 1.203705, loss_ss: 0.976112, loss_d: 0.227593
0.1925 --- loss: 1.187045, loss_ss: 1.035089, loss_d: 0.151956
0.2309 --- loss: 1.967891, loss_ss: 0.951625, loss_d: 1.016265
0.2694 --- loss: 1.719528, loss_ss: 1.032469, loss_d: 0.687059
0.3079 --- loss: 0.868715, loss_ss: 0.739509, loss_d: 0.129206
0.3464 --- loss: 1.437218, loss_ss: 0.891005, loss_d: 0.546213
0.3849 --- loss: 1.696108, loss_ss: 0.939907, loss_d: 0.756201
0.4234 --- loss: 1.171896, loss_ss: 0.974886, loss_d: 0.197009
0.4619 --- loss: 0.846691, loss_ss: 0.749800, loss_d: 0.096890
0.5004 --- loss: 2.226356, loss_ss: 1.491049, loss_d: 0.735307
0.5389 --- loss: 1.341175, loss_ss: 0.704486, loss_d: 0.636689
0.5774 --- loss: 1.233515, loss_ss: 1.037675, loss_d: 0.195840
0.6159 --- loss: 1.351355, loss_ss: 0.760583, loss_d: 0.590772
0.6543 --- loss: 0.950074, loss_ss: 0.754040, loss_d: 0.196035
0.6928 --- loss: 1.224836, loss_ss: 0.795837, loss_d: 0.429000
0.7313 --- loss: 1.237544, loss_ss: 0.951968, loss_d: 0.285576
0.7698 --- loss: 1.337755, loss_ss: 0.984816, loss_d: 0.352939
0.8083 --- loss: 0.656377, loss_ss: 0.523925, loss_d: 0.132452
0.8468 --- loss: 1.058535, loss_ss: 0.837406, loss_d: 0.221130
0.8853 --- loss: 1.466853, loss_ss: 0.907032, loss_d: 0.559821
0.9238 --- loss: 1.258184, loss_ss: 0.882039, loss_d: 0.376145
0.9623 --- loss: 1.142173, loss_ss: 0.903863, loss_d: 0.238310
Epoch finished! Loss: 1.19958918803447
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.045817, loss_ss: 0.895788, loss_d: 0.150029
0.0385 --- loss: 1.027007, loss_ss: 0.885811, loss_d: 0.141197
0.0770 --- loss: 1.560495, loss_ss: 0.837828, loss_d: 0.722667
0.1155 --- loss: 1.131194, loss_ss: 0.783070, loss_d: 0.348124
0.1540 --- loss: 1.034724, loss_ss: 0.727975, loss_d: 0.306749
0.1925 --- loss: 1.348578, loss_ss: 0.988862, loss_d: 0.359717
0.2309 --- loss: 1.591193, loss_ss: 1.110687, loss_d: 0.480506
0.2694 --- loss: 1.052475, loss_ss: 0.796220, loss_d: 0.256255
0.3079 --- loss: 1.340448, loss_ss: 1.070259, loss_d: 0.270189
0.3464 --- loss: 1.267805, loss_ss: 1.202784, loss_d: 0.065021
0.3849 --- loss: 0.901620, loss_ss: 0.654311, loss_d: 0.247309
0.4234 --- loss: 1.169449, loss_ss: 0.949406, loss_d: 0.220042
0.4619 --- loss: 1.135546, loss_ss: 0.955777, loss_d: 0.179769
0.5004 --- loss: 1.281352, loss_ss: 0.990981, loss_d: 0.290370
0.5389 --- loss: 1.255935, loss_ss: 0.761044, loss_d: 0.494891
0.5774 --- loss: 1.014728, loss_ss: 0.749276, loss_d: 0.265452
0.6159 --- loss: 1.104465, loss_ss: 0.876077, loss_d: 0.228388
0.6543 --- loss: 1.020663, loss_ss: 0.900440, loss_d: 0.120223
0.6928 --- loss: 1.594306, loss_ss: 0.812382, loss_d: 0.781924
0.7313 --- loss: 1.127561, loss_ss: 1.046662, loss_d: 0.080899
0.7698 --- loss: 1.223366, loss_ss: 0.862075, loss_d: 0.361291
0.8083 --- loss: 0.943431, loss_ss: 0.673956, loss_d: 0.269475
0.8468 --- loss: 0.916685, loss_ss: 0.724106, loss_d: 0.192580
0.8853 --- loss: 0.937553, loss_ss: 0.755682, loss_d: 0.181871
0.9238 --- loss: 0.983675, loss_ss: 0.794871, loss_d: 0.188804
0.9623 --- loss: 1.499891, loss_ss: 0.708178, loss_d: 0.791713
Epoch finished! Loss: 1.1534025521812292
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.155662, loss_ss: 0.780973, loss_d: 0.374689
0.0385 --- loss: 1.433823, loss_ss: 1.155198, loss_d: 0.278625
0.0770 --- loss: 1.404558, loss_ss: 1.005913, loss_d: 0.398646
0.1155 --- loss: 1.125974, loss_ss: 0.882899, loss_d: 0.243074
0.1540 --- loss: 1.214768, loss_ss: 0.734566, loss_d: 0.480202
0.1925 --- loss: 0.783160, loss_ss: 0.629681, loss_d: 0.153479
0.2309 --- loss: 1.149107, loss_ss: 0.982669, loss_d: 0.166438
0.2694 --- loss: 0.648676, loss_ss: 0.577745, loss_d: 0.070931
0.3079 --- loss: 1.424793, loss_ss: 0.610177, loss_d: 0.814616
0.3464 --- loss: 1.069423, loss_ss: 0.907526, loss_d: 0.161897
0.3849 --- loss: 1.750429, loss_ss: 0.982786, loss_d: 0.767643
0.4234 --- loss: 0.799241, loss_ss: 0.653321, loss_d: 0.145919
0.4619 --- loss: 1.067795, loss_ss: 0.963166, loss_d: 0.104629
0.5004 --- loss: 0.984142, loss_ss: 0.818606, loss_d: 0.165536
0.5389 --- loss: 0.904518, loss_ss: 0.690419, loss_d: 0.214099
0.5774 --- loss: 1.282115, loss_ss: 0.500065, loss_d: 0.782050
0.6159 --- loss: 1.374616, loss_ss: 1.205927, loss_d: 0.168689
0.6543 --- loss: 0.939444, loss_ss: 0.510690, loss_d: 0.428754
0.6928 --- loss: 0.962825, loss_ss: 0.815580, loss_d: 0.147245
0.7313 --- loss: 0.831527, loss_ss: 0.746225, loss_d: 0.085301
0.7698 --- loss: 1.104444, loss_ss: 0.795466, loss_d: 0.308979
0.8083 --- loss: 0.991170, loss_ss: 0.854053, loss_d: 0.137118
0.8468 --- loss: 0.949063, loss_ss: 0.618894, loss_d: 0.330169
0.8853 --- loss: 0.821261, loss_ss: 0.679466, loss_d: 0.141795
0.9238 --- loss: 1.454537, loss_ss: 1.197396, loss_d: 0.257141
0.9623 --- loss: 1.049787, loss_ss: 0.955567, loss_d: 0.094220
Epoch finished! Loss: 1.1229611655920169
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6538782318598833
             precision    recall  f1-score   support

        0.0       0.65      0.72      0.68       151
        1.0       0.48      0.16      0.24       135
        2.0       0.74      0.66      0.70       442
        3.0       0.78      0.71      0.74       221
        4.0       0.52      0.82      0.64       250

avg / total       0.66      0.65      0.64      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.58  71.52   94.47  65.06     68.14
1  88.57  16.30   97.74  47.83     24.31
2  79.07  66.06   86.66  74.30     69.94
3  90.91  70.59   95.50  78.00     74.11
4  80.65  82.40   80.19  52.28     63.98
Total accuracy: 65.39%
Average sen: 61.37%
Average spec: 90.91%
Macro f1-score: 60.09%
[0.92849278 0.93087697 0.99428892 0.99045885 0.28658977 0.2360757
 0.88980037 0.95772392 0.89145076 0.85395539 0.9034158  0.91689426
 0.66666585 0.938986   0.51292562 0.67507046 0.85765976 0.92345685
 0.94382745 0.99362856 0.9842695  0.93386358 0.54050362 0.88132143
 0.19691093 0.850546   0.63897753 0.59369236 0.62629008 0.9188453
 0.85613436 0.87428272 0.93255931 0.8776046  0.90354639 0.87820852
 0.68536991 0.91445148 0.92226052 0.84958243]
pred: 0.8037866156548261, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.569603, loss_ss: 1.877351, loss_d: 0.692252
0.0384 --- loss: 2.498780, loss_ss: 1.764277, loss_d: 0.734503
0.0769 --- loss: 1.938781, loss_ss: 1.372579, loss_d: 0.566202
0.1153 --- loss: 1.645519, loss_ss: 1.285249, loss_d: 0.360270
0.1537 --- loss: 2.107327, loss_ss: 1.575446, loss_d: 0.531880
0.1922 --- loss: 1.951356, loss_ss: 1.446175, loss_d: 0.505181
0.2306 --- loss: 2.296634, loss_ss: 1.361798, loss_d: 0.934837
0.2690 --- loss: 2.268333, loss_ss: 1.690442, loss_d: 0.577891
0.3075 --- loss: 1.850883, loss_ss: 1.379593, loss_d: 0.471290
0.3459 --- loss: 2.225633, loss_ss: 1.728910, loss_d: 0.496723
0.3843 --- loss: 2.259436, loss_ss: 1.603050, loss_d: 0.656387
0.4228 --- loss: 2.055290, loss_ss: 1.570656, loss_d: 0.484634
0.4612 --- loss: 2.122218, loss_ss: 1.428296, loss_d: 0.693922
0.4996 --- loss: 2.013150, loss_ss: 1.533049, loss_d: 0.480101
0.5380 --- loss: 2.032265, loss_ss: 1.530424, loss_d: 0.501842
0.5765 --- loss: 2.210790, loss_ss: 1.345589, loss_d: 0.865201
0.6149 --- loss: 2.276615, loss_ss: 1.373927, loss_d: 0.902688
0.6533 --- loss: 2.224443, loss_ss: 1.443856, loss_d: 0.780588
0.6918 --- loss: 1.798062, loss_ss: 1.378720, loss_d: 0.419341
0.7302 --- loss: 1.617298, loss_ss: 1.207970, loss_d: 0.409328
0.7686 --- loss: 1.734006, loss_ss: 1.322777, loss_d: 0.411229
0.8071 --- loss: 1.602151, loss_ss: 1.099668, loss_d: 0.502483
0.8455 --- loss: 2.010356, loss_ss: 1.166648, loss_d: 0.843707
0.8839 --- loss: 1.877952, loss_ss: 1.337693, loss_d: 0.540258
0.9224 --- loss: 2.129977, loss_ss: 1.312765, loss_d: 0.817212
0.9608 --- loss: 2.084741, loss_ss: 1.409517, loss_d: 0.675223
0.9992 --- loss: 1.489479, loss_ss: 1.228574, loss_d: 0.260905
Epoch finished! Loss: 2.058157877738659
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.926791, loss_ss: 1.286908, loss_d: 0.639883
0.0384 --- loss: 1.777646, loss_ss: 1.148261, loss_d: 0.629384
0.0769 --- loss: 2.077996, loss_ss: 1.499306, loss_d: 0.578690
0.1153 --- loss: 1.572469, loss_ss: 1.154989, loss_d: 0.417480
0.1537 --- loss: 2.071856, loss_ss: 1.102910, loss_d: 0.968946
0.1922 --- loss: 1.801389, loss_ss: 1.159428, loss_d: 0.641960
0.2306 --- loss: 1.968444, loss_ss: 1.290052, loss_d: 0.678392
0.2690 --- loss: 1.796959, loss_ss: 1.273254, loss_d: 0.523705
0.3075 --- loss: 1.712951, loss_ss: 1.138089, loss_d: 0.574862
0.3459 --- loss: 1.814637, loss_ss: 1.125911, loss_d: 0.688725
0.3843 --- loss: 1.711001, loss_ss: 1.225714, loss_d: 0.485287
0.4228 --- loss: 1.890173, loss_ss: 1.345134, loss_d: 0.545039
0.4612 --- loss: 1.864007, loss_ss: 0.989271, loss_d: 0.874737
0.4996 --- loss: 1.506914, loss_ss: 0.930433, loss_d: 0.576481
0.5380 --- loss: 1.620612, loss_ss: 1.052636, loss_d: 0.567976
0.5765 --- loss: 1.438979, loss_ss: 1.014045, loss_d: 0.424933
0.6149 --- loss: 1.449375, loss_ss: 1.052176, loss_d: 0.397199
0.6533 --- loss: 1.758227, loss_ss: 0.957760, loss_d: 0.800466
0.6918 --- loss: 1.722554, loss_ss: 1.137735, loss_d: 0.584819
0.7302 --- loss: 1.747289, loss_ss: 1.190056, loss_d: 0.557233
0.7686 --- loss: 1.507689, loss_ss: 0.964070, loss_d: 0.543619
0.8071 --- loss: 1.688576, loss_ss: 1.044088, loss_d: 0.644488
0.8455 --- loss: 1.531299, loss_ss: 1.074257, loss_d: 0.457041
0.8839 --- loss: 1.638334, loss_ss: 0.994366, loss_d: 0.643968
0.9224 --- loss: 1.687740, loss_ss: 0.942287, loss_d: 0.745454
0.9608 --- loss: 1.399220, loss_ss: 1.051509, loss_d: 0.347710
0.9992 --- loss: 1.309222, loss_ss: 0.809026, loss_d: 0.500196
Epoch finished! Loss: 1.7426395067801843
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.683638, loss_ss: 1.361132, loss_d: 0.322506
0.0384 --- loss: 1.452673, loss_ss: 1.043891, loss_d: 0.408782
0.0769 --- loss: 1.531727, loss_ss: 0.951442, loss_d: 0.580285
0.1153 --- loss: 1.713915, loss_ss: 1.089741, loss_d: 0.624175
0.1537 --- loss: 1.457485, loss_ss: 0.996806, loss_d: 0.460679
0.1922 --- loss: 1.596988, loss_ss: 1.049547, loss_d: 0.547441
0.2306 --- loss: 1.545114, loss_ss: 0.937743, loss_d: 0.607371
0.2690 --- loss: 1.657865, loss_ss: 1.127708, loss_d: 0.530157
0.3075 --- loss: 1.838546, loss_ss: 1.271038, loss_d: 0.567508
0.3459 --- loss: 1.471351, loss_ss: 0.944666, loss_d: 0.526685
0.3843 --- loss: 2.316516, loss_ss: 1.660264, loss_d: 0.656252
0.4228 --- loss: 1.599698, loss_ss: 1.001312, loss_d: 0.598386
0.4612 --- loss: 1.475583, loss_ss: 0.886378, loss_d: 0.589205
0.4996 --- loss: 1.493546, loss_ss: 0.871476, loss_d: 0.622070
0.5380 --- loss: 1.128286, loss_ss: 0.728430, loss_d: 0.399856
0.5765 --- loss: 1.460165, loss_ss: 0.867830, loss_d: 0.592335
0.6149 --- loss: 1.126785, loss_ss: 0.884681, loss_d: 0.242104
0.6533 --- loss: 1.454641, loss_ss: 0.997319, loss_d: 0.457322
0.6918 --- loss: 1.630009, loss_ss: 1.075681, loss_d: 0.554328
0.7302 --- loss: 1.322475, loss_ss: 0.850784, loss_d: 0.471691
0.7686 --- loss: 1.388726, loss_ss: 0.937157, loss_d: 0.451569
0.8071 --- loss: 1.626724, loss_ss: 0.978945, loss_d: 0.647780
0.8455 --- loss: 1.280016, loss_ss: 0.880328, loss_d: 0.399688
0.8839 --- loss: 1.641316, loss_ss: 1.229599, loss_d: 0.411717
0.9224 --- loss: 1.548255, loss_ss: 1.191279, loss_d: 0.356976
0.9608 --- loss: 1.619680, loss_ss: 0.926878, loss_d: 0.692802
0.9992 --- loss: 1.091260, loss_ss: 0.868420, loss_d: 0.222840
Epoch finished! Loss: 1.611983060836792
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.238712, loss_ss: 0.807861, loss_d: 0.430851
0.0384 --- loss: 1.167560, loss_ss: 0.833090, loss_d: 0.334470
0.0769 --- loss: 1.617851, loss_ss: 1.064651, loss_d: 0.553200
0.1153 --- loss: 1.666968, loss_ss: 0.987692, loss_d: 0.679276
0.1537 --- loss: 1.312877, loss_ss: 0.952368, loss_d: 0.360509
0.1922 --- loss: 1.378894, loss_ss: 0.970904, loss_d: 0.407989
0.2306 --- loss: 1.804955, loss_ss: 1.227868, loss_d: 0.577086
0.2690 --- loss: 1.531029, loss_ss: 1.032799, loss_d: 0.498230
0.3075 --- loss: 1.595171, loss_ss: 1.096869, loss_d: 0.498302
0.3459 --- loss: 1.818480, loss_ss: 1.066637, loss_d: 0.751843
0.3843 --- loss: 1.370638, loss_ss: 0.883189, loss_d: 0.487448
0.4228 --- loss: 1.633984, loss_ss: 1.002963, loss_d: 0.631021
0.4612 --- loss: 1.503479, loss_ss: 1.157743, loss_d: 0.345737
0.4996 --- loss: 1.367190, loss_ss: 0.949245, loss_d: 0.417945
0.5380 --- loss: 1.461304, loss_ss: 0.963593, loss_d: 0.497711
0.5765 --- loss: 1.573061, loss_ss: 0.856842, loss_d: 0.716219
0.6149 --- loss: 1.208575, loss_ss: 0.668202, loss_d: 0.540373
0.6533 --- loss: 1.714556, loss_ss: 0.951659, loss_d: 0.762897
0.6918 --- loss: 1.573752, loss_ss: 1.012744, loss_d: 0.561008
0.7302 --- loss: 1.772002, loss_ss: 1.177297, loss_d: 0.594705
0.7686 --- loss: 1.527520, loss_ss: 1.030503, loss_d: 0.497017
0.8071 --- loss: 1.220244, loss_ss: 0.623145, loss_d: 0.597099
0.8455 --- loss: 1.529559, loss_ss: 1.030791, loss_d: 0.498768
0.8839 --- loss: 1.843214, loss_ss: 1.101664, loss_d: 0.741550
0.9224 --- loss: 1.870115, loss_ss: 1.387438, loss_d: 0.482678
0.9608 --- loss: 1.530513, loss_ss: 1.058524, loss_d: 0.471989
0.9992 --- loss: 1.308412, loss_ss: 0.758763, loss_d: 0.549649
Epoch finished! Loss: 1.539365541934967
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.567072, loss_ss: 0.828985, loss_d: 0.738087
0.0384 --- loss: 1.324982, loss_ss: 1.032742, loss_d: 0.292241
0.0769 --- loss: 1.720517, loss_ss: 1.012656, loss_d: 0.707861
0.1153 --- loss: 1.649463, loss_ss: 1.169056, loss_d: 0.480407
0.1537 --- loss: 1.588185, loss_ss: 1.102950, loss_d: 0.485234
0.1922 --- loss: 1.301702, loss_ss: 0.848427, loss_d: 0.453275
0.2306 --- loss: 1.271183, loss_ss: 0.742759, loss_d: 0.528424
0.2690 --- loss: 1.565709, loss_ss: 1.104573, loss_d: 0.461136
0.3075 --- loss: 1.584382, loss_ss: 1.017755, loss_d: 0.566628
0.3459 --- loss: 1.484050, loss_ss: 0.992864, loss_d: 0.491186
0.3843 --- loss: 1.602933, loss_ss: 1.126971, loss_d: 0.475961
0.4228 --- loss: 1.998954, loss_ss: 1.230735, loss_d: 0.768219
0.4612 --- loss: 1.830542, loss_ss: 0.910168, loss_d: 0.920374
0.4996 --- loss: 1.803499, loss_ss: 0.974686, loss_d: 0.828814
0.5380 --- loss: 1.662187, loss_ss: 0.853903, loss_d: 0.808284
0.5765 --- loss: 1.418139, loss_ss: 0.932448, loss_d: 0.485690
0.6149 --- loss: 1.204482, loss_ss: 0.868447, loss_d: 0.336035
0.6533 --- loss: 1.238297, loss_ss: 0.804608, loss_d: 0.433689
0.6918 --- loss: 1.508728, loss_ss: 1.074991, loss_d: 0.433737
0.7302 --- loss: 1.271441, loss_ss: 1.011984, loss_d: 0.259457
0.7686 --- loss: 1.536727, loss_ss: 1.087322, loss_d: 0.449405
0.8071 --- loss: 1.226443, loss_ss: 0.987363, loss_d: 0.239080
0.8455 --- loss: 1.584168, loss_ss: 1.046569, loss_d: 0.537600
0.8839 --- loss: 1.058112, loss_ss: 0.851987, loss_d: 0.206125
0.9224 --- loss: 1.284198, loss_ss: 0.648493, loss_d: 0.635705
0.9608 --- loss: 1.166440, loss_ss: 0.687798, loss_d: 0.478642
0.9992 --- loss: 1.236804, loss_ss: 0.802291, loss_d: 0.434513
Epoch finished! Loss: 1.4619613480109435
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.643001, loss_ss: 1.162381, loss_d: 0.480620
0.0384 --- loss: 1.482072, loss_ss: 0.754600, loss_d: 0.727472
0.0769 --- loss: 1.463710, loss_ss: 0.955127, loss_d: 0.508584
0.1153 --- loss: 1.995451, loss_ss: 1.363890, loss_d: 0.631561
0.1537 --- loss: 1.228062, loss_ss: 0.836663, loss_d: 0.391399
0.1922 --- loss: 1.256835, loss_ss: 0.753555, loss_d: 0.503279
0.2306 --- loss: 1.454612, loss_ss: 0.980997, loss_d: 0.473615
0.2690 --- loss: 1.633299, loss_ss: 0.979526, loss_d: 0.653773
0.3075 --- loss: 1.295640, loss_ss: 0.982858, loss_d: 0.312782
0.3459 --- loss: 1.029874, loss_ss: 0.618519, loss_d: 0.411355
0.3843 --- loss: 1.609045, loss_ss: 1.146875, loss_d: 0.462170
0.4228 --- loss: 0.937460, loss_ss: 0.726822, loss_d: 0.210638
0.4612 --- loss: 1.362989, loss_ss: 0.791814, loss_d: 0.571175
0.4996 --- loss: 1.137119, loss_ss: 0.854715, loss_d: 0.282404
0.5380 --- loss: 1.516785, loss_ss: 0.892943, loss_d: 0.623842
0.5765 --- loss: 1.546185, loss_ss: 1.099001, loss_d: 0.447184
0.6149 --- loss: 1.091994, loss_ss: 0.832313, loss_d: 0.259681
0.6533 --- loss: 0.937047, loss_ss: 0.585284, loss_d: 0.351763
0.6918 --- loss: 1.130411, loss_ss: 0.882248, loss_d: 0.248163
0.7302 --- loss: 1.051923, loss_ss: 0.878503, loss_d: 0.173420
0.7686 --- loss: 1.591076, loss_ss: 1.311923, loss_d: 0.279153
0.8071 --- loss: 1.070826, loss_ss: 0.921651, loss_d: 0.149175
0.8455 --- loss: 0.875258, loss_ss: 0.744811, loss_d: 0.130447
0.8839 --- loss: 1.302134, loss_ss: 0.839669, loss_d: 0.462464
0.9224 --- loss: 1.202188, loss_ss: 0.745848, loss_d: 0.456340
0.9608 --- loss: 0.976561, loss_ss: 0.713761, loss_d: 0.262800
0.9992 --- loss: 2.498061, loss_ss: 2.019214, loss_d: 0.478847
Epoch finished! Loss: 1.3621431444699947
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.448882, loss_ss: 0.799279, loss_d: 0.649603
0.0384 --- loss: 1.653741, loss_ss: 1.095549, loss_d: 0.558192
0.0769 --- loss: 1.250574, loss_ss: 0.936541, loss_d: 0.314032
0.1153 --- loss: 1.067155, loss_ss: 0.796101, loss_d: 0.271054
0.1537 --- loss: 1.229885, loss_ss: 0.914935, loss_d: 0.314951
0.1922 --- loss: 0.790130, loss_ss: 0.591088, loss_d: 0.199041
0.2306 --- loss: 1.386698, loss_ss: 1.128656, loss_d: 0.258043
0.2690 --- loss: 1.364151, loss_ss: 0.828876, loss_d: 0.535275
0.3075 --- loss: 1.960995, loss_ss: 1.100439, loss_d: 0.860556
0.3459 --- loss: 1.800111, loss_ss: 0.803151, loss_d: 0.996960
0.3843 --- loss: 1.532905, loss_ss: 0.805626, loss_d: 0.727278
0.4228 --- loss: 1.019972, loss_ss: 0.798081, loss_d: 0.221891
0.4612 --- loss: 2.208942, loss_ss: 0.981061, loss_d: 1.227881
0.4996 --- loss: 1.615932, loss_ss: 0.989594, loss_d: 0.626338
0.5380 --- loss: 1.146858, loss_ss: 0.693896, loss_d: 0.452962
0.5765 --- loss: 1.701259, loss_ss: 0.766365, loss_d: 0.934894
0.6149 --- loss: 1.255428, loss_ss: 0.913702, loss_d: 0.341726
0.6533 --- loss: 1.333380, loss_ss: 0.904356, loss_d: 0.429024
0.6918 --- loss: 1.268200, loss_ss: 0.900346, loss_d: 0.367854
0.7302 --- loss: 1.315224, loss_ss: 1.078558, loss_d: 0.236665
0.7686 --- loss: 0.856374, loss_ss: 0.651722, loss_d: 0.204652
0.8071 --- loss: 1.426052, loss_ss: 1.182627, loss_d: 0.243424
0.8455 --- loss: 1.214884, loss_ss: 0.860289, loss_d: 0.354595
0.8839 --- loss: 1.496612, loss_ss: 1.168094, loss_d: 0.328518
0.9224 --- loss: 0.929314, loss_ss: 0.701247, loss_d: 0.228067
0.9608 --- loss: 0.933710, loss_ss: 0.761039, loss_d: 0.172672
0.9992 --- loss: 1.504100, loss_ss: 1.373841, loss_d: 0.130260
Epoch finished! Loss: 1.2999946612578173
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.348766, loss_ss: 1.133820, loss_d: 0.214947
0.0384 --- loss: 1.264110, loss_ss: 0.942682, loss_d: 0.321428
0.0769 --- loss: 1.242473, loss_ss: 0.776049, loss_d: 0.466424
0.1153 --- loss: 1.443066, loss_ss: 1.238115, loss_d: 0.204951
0.1537 --- loss: 1.424302, loss_ss: 0.800293, loss_d: 0.624009
0.1922 --- loss: 1.455189, loss_ss: 1.170308, loss_d: 0.284881
0.2306 --- loss: 1.014504, loss_ss: 0.747229, loss_d: 0.267274
0.2690 --- loss: 1.097121, loss_ss: 0.846002, loss_d: 0.251120
0.3075 --- loss: 1.341112, loss_ss: 0.900510, loss_d: 0.440602
0.3459 --- loss: 1.468848, loss_ss: 0.937312, loss_d: 0.531536
0.3843 --- loss: 1.203150, loss_ss: 0.674262, loss_d: 0.528888
0.4228 --- loss: 1.553297, loss_ss: 0.932491, loss_d: 0.620805
0.4612 --- loss: 0.746713, loss_ss: 0.520113, loss_d: 0.226600
0.4996 --- loss: 1.231861, loss_ss: 0.939991, loss_d: 0.291870
0.5380 --- loss: 1.393525, loss_ss: 1.220420, loss_d: 0.173105
0.5765 --- loss: 1.530219, loss_ss: 1.006945, loss_d: 0.523274
0.6149 --- loss: 1.218351, loss_ss: 0.841093, loss_d: 0.377258
0.6533 --- loss: 1.104106, loss_ss: 0.961964, loss_d: 0.142142
0.6918 --- loss: 1.223326, loss_ss: 0.915968, loss_d: 0.307358
0.7302 --- loss: 1.076935, loss_ss: 0.697956, loss_d: 0.378979
0.7686 --- loss: 1.171278, loss_ss: 0.951974, loss_d: 0.219303
0.8071 --- loss: 1.058443, loss_ss: 0.831261, loss_d: 0.227181
0.8455 --- loss: 1.048895, loss_ss: 0.933052, loss_d: 0.115843
0.8839 --- loss: 1.157757, loss_ss: 1.017855, loss_d: 0.139902
0.9224 --- loss: 1.393175, loss_ss: 0.853754, loss_d: 0.539421
0.9608 --- loss: 1.580652, loss_ss: 1.049967, loss_d: 0.530685
0.9992 --- loss: 2.568075, loss_ss: 2.135327, loss_d: 0.432748
Epoch finished! Loss: 1.2181811222663292
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.308993, loss_ss: 1.022370, loss_d: 0.286623
0.0384 --- loss: 0.796442, loss_ss: 0.561200, loss_d: 0.235242
0.0769 --- loss: 0.760399, loss_ss: 0.554102, loss_d: 0.206297
0.1153 --- loss: 0.970428, loss_ss: 0.733072, loss_d: 0.237356
0.1537 --- loss: 1.467725, loss_ss: 1.306400, loss_d: 0.161325
0.1922 --- loss: 0.907124, loss_ss: 0.790295, loss_d: 0.116828
0.2306 --- loss: 1.485664, loss_ss: 0.786749, loss_d: 0.698916
0.2690 --- loss: 1.209889, loss_ss: 0.954677, loss_d: 0.255212
0.3075 --- loss: 1.000851, loss_ss: 0.816766, loss_d: 0.184085
0.3459 --- loss: 1.239254, loss_ss: 1.033650, loss_d: 0.205604
0.3843 --- loss: 0.880102, loss_ss: 0.744008, loss_d: 0.136093
0.4228 --- loss: 1.137151, loss_ss: 0.858292, loss_d: 0.278859
0.4612 --- loss: 1.257321, loss_ss: 0.987624, loss_d: 0.269697
0.4996 --- loss: 0.937364, loss_ss: 0.795585, loss_d: 0.141779
0.5380 --- loss: 1.149697, loss_ss: 0.968671, loss_d: 0.181026
0.5765 --- loss: 1.173700, loss_ss: 0.798218, loss_d: 0.375481
0.6149 --- loss: 1.082304, loss_ss: 0.677006, loss_d: 0.405298
0.6533 --- loss: 1.004001, loss_ss: 0.773069, loss_d: 0.230932
0.6918 --- loss: 0.990144, loss_ss: 0.725863, loss_d: 0.264281
0.7302 --- loss: 1.540395, loss_ss: 1.154384, loss_d: 0.386012
0.7686 --- loss: 0.909426, loss_ss: 0.812751, loss_d: 0.096675
0.8071 --- loss: 1.789108, loss_ss: 0.741907, loss_d: 1.047201
0.8455 --- loss: 1.415182, loss_ss: 0.733921, loss_d: 0.681261
0.8839 --- loss: 1.171658, loss_ss: 1.072153, loss_d: 0.099505
0.9224 --- loss: 0.958224, loss_ss: 0.786066, loss_d: 0.172159
0.9608 --- loss: 1.283297, loss_ss: 0.610383, loss_d: 0.672914
0.9992 --- loss: 1.133724, loss_ss: 1.000852, loss_d: 0.132872
Epoch finished! Loss: 1.1704570561647416
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.859043, loss_ss: 0.671382, loss_d: 0.187660
0.0384 --- loss: 1.608329, loss_ss: 0.723796, loss_d: 0.884533
0.0769 --- loss: 1.188369, loss_ss: 0.999281, loss_d: 0.189088
0.1153 --- loss: 1.044152, loss_ss: 0.804505, loss_d: 0.239647
0.1537 --- loss: 0.943132, loss_ss: 0.493912, loss_d: 0.449220
0.1922 --- loss: 1.038479, loss_ss: 0.912673, loss_d: 0.125806
0.2306 --- loss: 1.055537, loss_ss: 0.876176, loss_d: 0.179361
0.2690 --- loss: 0.810643, loss_ss: 0.558801, loss_d: 0.251842
0.3075 --- loss: 0.925914, loss_ss: 0.838429, loss_d: 0.087486
0.3459 --- loss: 0.801773, loss_ss: 0.702513, loss_d: 0.099260
0.3843 --- loss: 1.557416, loss_ss: 0.777207, loss_d: 0.780209
0.4228 --- loss: 0.960723, loss_ss: 0.816650, loss_d: 0.144072
0.4612 --- loss: 1.206436, loss_ss: 0.604617, loss_d: 0.601819
0.4996 --- loss: 1.122115, loss_ss: 0.819100, loss_d: 0.303014
0.5380 --- loss: 1.189544, loss_ss: 0.961316, loss_d: 0.228228
0.5765 --- loss: 1.242852, loss_ss: 0.982306, loss_d: 0.260546
0.6149 --- loss: 1.006338, loss_ss: 0.747881, loss_d: 0.258456
0.6533 --- loss: 1.183636, loss_ss: 0.797291, loss_d: 0.386345
0.6918 --- loss: 1.095732, loss_ss: 0.963889, loss_d: 0.131844
0.7302 --- loss: 0.899190, loss_ss: 0.739538, loss_d: 0.159652
0.7686 --- loss: 1.193039, loss_ss: 0.843386, loss_d: 0.349653
0.8071 --- loss: 1.064127, loss_ss: 0.896034, loss_d: 0.168093
0.8455 --- loss: 0.908984, loss_ss: 0.741355, loss_d: 0.167629
0.8839 --- loss: 1.116410, loss_ss: 0.826818, loss_d: 0.289593
0.9224 --- loss: 1.113717, loss_ss: 0.679479, loss_d: 0.434238
0.9608 --- loss: 1.061680, loss_ss: 0.871056, loss_d: 0.190624
0.9992 --- loss: 1.719547, loss_ss: 1.575142, loss_d: 0.144405
Epoch finished! Loss: 1.1406098081515386
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.45740740740740743
             precision    recall  f1-score   support

        0.0       0.91      0.69      0.79       226
        1.0       0.50      0.00      0.01       357
        2.0       0.23      0.70      0.34       192
        3.0       0.02      0.50      0.04         2
        4.0       0.78      0.66      0.72       303

avg / total       0.62      0.46      0.43      1080
 


====== chp046-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.13  69.47   98.13  90.75     78.70
1  66.94   0.28   99.86  50.00      0.56
2  51.94  70.31   47.97  22.61     34.22
3  95.09  50.00   95.18   1.89      3.64
4  85.37  66.01   92.92  78.43     71.68
Total accuracy: 45.74%
Average sen: 51.21%
Average spec: 86.81%
Macro f1-score: 37.76%
[0.87342882 0.27431682 0.42874256 0.57590145 0.81700635 0.92783827
 0.91375208 0.89684623 0.91037333 0.86593676 0.66822523 0.91011518
 0.99232763 0.76012486 0.90958208 0.85457933 0.97013974 0.98800719
 0.8642807  0.97142136 0.91565406 0.98049998 0.94609118 0.90995759
 0.99618417 0.99855775 0.95198345 0.92636114 0.98330873 0.96846139
 0.88554382 0.96959275 0.99541312 0.92884088 0.94321084 0.90906626]
pred: 0.8772686968247095, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.307414, loss_ss: 1.624384, loss_d: 0.683030
0.0383 --- loss: 1.819929, loss_ss: 1.336695, loss_d: 0.483234
0.0767 --- loss: 2.547666, loss_ss: 1.574075, loss_d: 0.973591
0.1150 --- loss: 1.970484, loss_ss: 1.401499, loss_d: 0.568985
0.1533 --- loss: 2.083036, loss_ss: 1.525687, loss_d: 0.557349
0.1916 --- loss: 1.864882, loss_ss: 1.428077, loss_d: 0.436805
0.2300 --- loss: 2.287280, loss_ss: 1.401900, loss_d: 0.885380
0.2683 --- loss: 1.955875, loss_ss: 1.252437, loss_d: 0.703438
0.3066 --- loss: 1.894022, loss_ss: 1.353137, loss_d: 0.540885
0.3450 --- loss: 1.797757, loss_ss: 1.300869, loss_d: 0.496888
0.3833 --- loss: 1.630768, loss_ss: 1.045300, loss_d: 0.585468
0.4216 --- loss: 1.541747, loss_ss: 1.256936, loss_d: 0.284811
0.4599 --- loss: 2.008529, loss_ss: 1.198265, loss_d: 0.810265
0.4983 --- loss: 1.749236, loss_ss: 1.270922, loss_d: 0.478314
0.5366 --- loss: 2.261569, loss_ss: 1.194820, loss_d: 1.066749
0.5749 --- loss: 1.886852, loss_ss: 1.074689, loss_d: 0.812162
0.6133 --- loss: 1.757655, loss_ss: 1.301738, loss_d: 0.455917
0.6516 --- loss: 1.895164, loss_ss: 1.109533, loss_d: 0.785632
0.6899 --- loss: 1.807247, loss_ss: 1.349419, loss_d: 0.457828
0.7282 --- loss: 2.377732, loss_ss: 1.492003, loss_d: 0.885729
0.7666 --- loss: 1.764545, loss_ss: 1.275530, loss_d: 0.489016
0.8049 --- loss: 1.814728, loss_ss: 1.176165, loss_d: 0.638563
0.8432 --- loss: 1.646961, loss_ss: 1.205176, loss_d: 0.441785
0.8816 --- loss: 1.687567, loss_ss: 1.179903, loss_d: 0.507664
0.9199 --- loss: 1.856970, loss_ss: 1.218584, loss_d: 0.638386
0.9582 --- loss: 1.795523, loss_ss: 1.298007, loss_d: 0.497515
0.9966 --- loss: 2.191309, loss_ss: 1.535500, loss_d: 0.655809
Epoch finished! Loss: 1.9019052624702453
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.675384, loss_ss: 1.186564, loss_d: 0.488820
0.0383 --- loss: 1.626309, loss_ss: 1.091822, loss_d: 0.534487
0.0767 --- loss: 1.549758, loss_ss: 1.039103, loss_d: 0.510655
0.1150 --- loss: 1.828804, loss_ss: 1.252916, loss_d: 0.575888
0.1533 --- loss: 1.775088, loss_ss: 1.199634, loss_d: 0.575453
0.1916 --- loss: 1.742432, loss_ss: 1.331926, loss_d: 0.410507
0.2300 --- loss: 1.823794, loss_ss: 1.156256, loss_d: 0.667538
0.2683 --- loss: 2.079706, loss_ss: 1.334721, loss_d: 0.744985
0.3066 --- loss: 1.533036, loss_ss: 0.961850, loss_d: 0.571186
0.3450 --- loss: 1.588765, loss_ss: 1.112910, loss_d: 0.475855
0.3833 --- loss: 1.899374, loss_ss: 1.347908, loss_d: 0.551465
0.4216 --- loss: 1.666818, loss_ss: 1.033315, loss_d: 0.633503
0.4599 --- loss: 1.579442, loss_ss: 1.091394, loss_d: 0.488047
0.4983 --- loss: 1.466004, loss_ss: 1.059035, loss_d: 0.406969
0.5366 --- loss: 1.748428, loss_ss: 1.005043, loss_d: 0.743385
0.5749 --- loss: 1.399551, loss_ss: 0.854197, loss_d: 0.545354
0.6133 --- loss: 1.768606, loss_ss: 1.016911, loss_d: 0.751695
0.6516 --- loss: 1.723541, loss_ss: 1.176421, loss_d: 0.547120
0.6899 --- loss: 1.507182, loss_ss: 0.922007, loss_d: 0.585175
0.7282 --- loss: 1.842586, loss_ss: 1.144944, loss_d: 0.697642
0.7666 --- loss: 1.757905, loss_ss: 1.232231, loss_d: 0.525673
0.8049 --- loss: 1.866634, loss_ss: 1.214393, loss_d: 0.652241
0.8432 --- loss: 1.633582, loss_ss: 1.139280, loss_d: 0.494302
0.8816 --- loss: 1.585074, loss_ss: 1.076415, loss_d: 0.508659
0.9199 --- loss: 1.683105, loss_ss: 1.221127, loss_d: 0.461979
0.9582 --- loss: 1.617327, loss_ss: 1.045496, loss_d: 0.571831
0.9966 --- loss: 1.396057, loss_ss: 0.923714, loss_d: 0.472343
Epoch finished! Loss: 1.681369440830671
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.433441, loss_ss: 1.180452, loss_d: 0.252989
0.0383 --- loss: 1.327435, loss_ss: 0.933270, loss_d: 0.394164
0.0767 --- loss: 1.568534, loss_ss: 1.000627, loss_d: 0.567907
0.1150 --- loss: 1.244888, loss_ss: 0.865554, loss_d: 0.379334
0.1533 --- loss: 1.616463, loss_ss: 0.828342, loss_d: 0.788121
0.1916 --- loss: 1.601477, loss_ss: 0.841333, loss_d: 0.760144
0.2300 --- loss: 1.647973, loss_ss: 1.207447, loss_d: 0.440526
0.2683 --- loss: 1.464939, loss_ss: 0.996919, loss_d: 0.468020
0.3066 --- loss: 1.692761, loss_ss: 0.777105, loss_d: 0.915656
0.3450 --- loss: 1.319223, loss_ss: 0.783959, loss_d: 0.535264
0.3833 --- loss: 1.680071, loss_ss: 0.773146, loss_d: 0.906925
0.4216 --- loss: 1.782696, loss_ss: 1.052821, loss_d: 0.729876
0.4599 --- loss: 1.523561, loss_ss: 0.755148, loss_d: 0.768414
0.4983 --- loss: 2.020793, loss_ss: 1.215472, loss_d: 0.805321
0.5366 --- loss: 1.546157, loss_ss: 1.011935, loss_d: 0.534222
0.5749 --- loss: 1.217292, loss_ss: 0.884649, loss_d: 0.332643
0.6133 --- loss: 1.075167, loss_ss: 0.855834, loss_d: 0.219333
0.6516 --- loss: 1.352880, loss_ss: 0.795789, loss_d: 0.557091
0.6899 --- loss: 1.309514, loss_ss: 0.851425, loss_d: 0.458088
0.7282 --- loss: 1.697161, loss_ss: 1.109549, loss_d: 0.587613
0.7666 --- loss: 1.230785, loss_ss: 0.926265, loss_d: 0.304519
0.8049 --- loss: 1.316586, loss_ss: 0.889471, loss_d: 0.427114
0.8432 --- loss: 1.445160, loss_ss: 1.032544, loss_d: 0.412616
0.8816 --- loss: 1.447490, loss_ss: 1.052821, loss_d: 0.394669
0.9199 --- loss: 1.254636, loss_ss: 0.831889, loss_d: 0.422747
0.9582 --- loss: 1.241936, loss_ss: 0.881551, loss_d: 0.360385
0.9966 --- loss: 1.418327, loss_ss: 1.122831, loss_d: 0.295497
Epoch finished! Loss: 1.528692484818972
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.254140, loss_ss: 0.993099, loss_d: 0.261042
0.0383 --- loss: 1.257039, loss_ss: 1.006052, loss_d: 0.250987
0.0767 --- loss: 1.315965, loss_ss: 0.784248, loss_d: 0.531717
0.1150 --- loss: 1.507662, loss_ss: 0.924555, loss_d: 0.583108
0.1533 --- loss: 1.255656, loss_ss: 0.826789, loss_d: 0.428867
0.1916 --- loss: 1.589347, loss_ss: 1.149558, loss_d: 0.439789
0.2300 --- loss: 1.345731, loss_ss: 0.825563, loss_d: 0.520168
0.2683 --- loss: 1.389153, loss_ss: 1.011870, loss_d: 0.377283
0.3066 --- loss: 1.160455, loss_ss: 0.746523, loss_d: 0.413932
0.3450 --- loss: 1.825354, loss_ss: 0.857833, loss_d: 0.967521
0.3833 --- loss: 1.623827, loss_ss: 0.891698, loss_d: 0.732129
0.4216 --- loss: 1.414135, loss_ss: 0.940236, loss_d: 0.473899
0.4599 --- loss: 1.502223, loss_ss: 0.841728, loss_d: 0.660495
0.4983 --- loss: 1.534276, loss_ss: 1.021080, loss_d: 0.513196
0.5366 --- loss: 1.182659, loss_ss: 0.861724, loss_d: 0.320935
0.5749 --- loss: 1.614246, loss_ss: 0.955210, loss_d: 0.659036
0.6133 --- loss: 1.817472, loss_ss: 1.341734, loss_d: 0.475738
0.6516 --- loss: 1.262786, loss_ss: 1.046190, loss_d: 0.216596
0.6899 --- loss: 1.187919, loss_ss: 0.934679, loss_d: 0.253240
0.7282 --- loss: 1.206800, loss_ss: 0.802113, loss_d: 0.404687
0.7666 --- loss: 1.536279, loss_ss: 0.947315, loss_d: 0.588963
0.8049 --- loss: 1.275272, loss_ss: 0.784457, loss_d: 0.490815
0.8432 --- loss: 0.981604, loss_ss: 0.709693, loss_d: 0.271911
0.8816 --- loss: 1.439685, loss_ss: 1.058500, loss_d: 0.381185
0.9199 --- loss: 1.519365, loss_ss: 1.268115, loss_d: 0.251250
0.9582 --- loss: 1.143697, loss_ss: 0.805743, loss_d: 0.337954
0.9966 --- loss: 1.191476, loss_ss: 0.950490, loss_d: 0.240986
Epoch finished! Loss: 1.4379960257273454
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.265072, loss_ss: 0.941842, loss_d: 0.323230
0.0383 --- loss: 1.464779, loss_ss: 1.142790, loss_d: 0.321988
0.0767 --- loss: 1.330960, loss_ss: 0.899280, loss_d: 0.431680
0.1150 --- loss: 1.402896, loss_ss: 0.854880, loss_d: 0.548016
0.1533 --- loss: 1.045980, loss_ss: 0.846613, loss_d: 0.199367
0.1916 --- loss: 2.204876, loss_ss: 1.201550, loss_d: 1.003326
0.2300 --- loss: 1.035717, loss_ss: 0.888829, loss_d: 0.146889
0.2683 --- loss: 1.261189, loss_ss: 0.642644, loss_d: 0.618545
0.3066 --- loss: 1.315699, loss_ss: 0.968660, loss_d: 0.347039
0.3450 --- loss: 1.400661, loss_ss: 0.962338, loss_d: 0.438323
0.3833 --- loss: 1.259669, loss_ss: 0.819459, loss_d: 0.440210
0.4216 --- loss: 1.174897, loss_ss: 0.907799, loss_d: 0.267098
0.4599 --- loss: 1.565716, loss_ss: 1.243596, loss_d: 0.322120
0.4983 --- loss: 1.300860, loss_ss: 0.919957, loss_d: 0.380903
0.5366 --- loss: 1.135207, loss_ss: 0.652921, loss_d: 0.482286
0.5749 --- loss: 1.397025, loss_ss: 0.970096, loss_d: 0.426929
0.6133 --- loss: 1.340187, loss_ss: 1.117940, loss_d: 0.222247
0.6516 --- loss: 1.217504, loss_ss: 0.752423, loss_d: 0.465081
0.6899 --- loss: 1.014418, loss_ss: 0.706922, loss_d: 0.307495
0.7282 --- loss: 1.044834, loss_ss: 0.812894, loss_d: 0.231940
0.7666 --- loss: 1.304592, loss_ss: 1.067070, loss_d: 0.237522
0.8049 --- loss: 1.242893, loss_ss: 0.837168, loss_d: 0.405725
0.8432 --- loss: 1.197845, loss_ss: 0.876775, loss_d: 0.321069
0.8816 --- loss: 1.139347, loss_ss: 0.719341, loss_d: 0.420005
0.9199 --- loss: 1.825108, loss_ss: 1.174059, loss_d: 0.651050
0.9582 --- loss: 1.124220, loss_ss: 0.756803, loss_d: 0.367417
0.9966 --- loss: 1.109591, loss_ss: 0.916002, loss_d: 0.193589
Epoch finished! Loss: 1.332980761390466
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.275494, loss_ss: 0.812496, loss_d: 0.462998
0.0383 --- loss: 0.983436, loss_ss: 0.822942, loss_d: 0.160493
0.0767 --- loss: 1.513072, loss_ss: 0.947119, loss_d: 0.565953
0.1150 --- loss: 1.577105, loss_ss: 1.233036, loss_d: 0.344069
0.1533 --- loss: 1.370423, loss_ss: 0.872358, loss_d: 0.498065
0.1916 --- loss: 1.165695, loss_ss: 0.905320, loss_d: 0.260376
0.2300 --- loss: 1.931269, loss_ss: 1.109678, loss_d: 0.821591
0.2683 --- loss: 1.088044, loss_ss: 0.740080, loss_d: 0.347964
0.3066 --- loss: 1.268011, loss_ss: 0.881735, loss_d: 0.386276
0.3450 --- loss: 0.807060, loss_ss: 0.646614, loss_d: 0.160446
0.3833 --- loss: 0.958859, loss_ss: 0.802969, loss_d: 0.155889
0.4216 --- loss: 1.000623, loss_ss: 0.744425, loss_d: 0.256198
0.4599 --- loss: 1.105133, loss_ss: 0.643587, loss_d: 0.461545
0.4983 --- loss: 1.068407, loss_ss: 0.809612, loss_d: 0.258795
0.5366 --- loss: 1.239188, loss_ss: 0.828018, loss_d: 0.411170
0.5749 --- loss: 1.297522, loss_ss: 0.791507, loss_d: 0.506015
0.6133 --- loss: 1.707248, loss_ss: 1.152519, loss_d: 0.554730
0.6516 --- loss: 1.520020, loss_ss: 1.125455, loss_d: 0.394565
0.6899 --- loss: 1.253819, loss_ss: 0.933623, loss_d: 0.320196
0.7282 --- loss: 1.345562, loss_ss: 1.017438, loss_d: 0.328125
0.7666 --- loss: 1.110150, loss_ss: 0.690775, loss_d: 0.419375
0.8049 --- loss: 1.302992, loss_ss: 1.064659, loss_d: 0.238333
0.8432 --- loss: 1.220836, loss_ss: 0.903512, loss_d: 0.317324
0.8816 --- loss: 1.280509, loss_ss: 0.917490, loss_d: 0.363019
0.9199 --- loss: 1.238875, loss_ss: 0.727484, loss_d: 0.511391
0.9582 --- loss: 1.039194, loss_ss: 0.862475, loss_d: 0.176718
0.9966 --- loss: 1.027519, loss_ss: 0.875198, loss_d: 0.152321
Epoch finished! Loss: 1.2626713518912975
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.653692, loss_ss: 0.548020, loss_d: 0.105672
0.0383 --- loss: 1.056038, loss_ss: 0.674688, loss_d: 0.381350
0.0767 --- loss: 1.090828, loss_ss: 0.831261, loss_d: 0.259567
0.1150 --- loss: 1.178307, loss_ss: 0.761095, loss_d: 0.417213
0.1533 --- loss: 1.125501, loss_ss: 0.805957, loss_d: 0.319545
0.1916 --- loss: 0.940473, loss_ss: 0.810977, loss_d: 0.129496
0.2300 --- loss: 0.901293, loss_ss: 0.716489, loss_d: 0.184804
0.2683 --- loss: 1.200786, loss_ss: 0.965845, loss_d: 0.234941
0.3066 --- loss: 1.155358, loss_ss: 0.934051, loss_d: 0.221308
0.3450 --- loss: 2.037382, loss_ss: 0.698642, loss_d: 1.338740
0.3833 --- loss: 1.193455, loss_ss: 0.996288, loss_d: 0.197167
0.4216 --- loss: 1.126382, loss_ss: 0.820474, loss_d: 0.305908
0.4599 --- loss: 0.923627, loss_ss: 0.624946, loss_d: 0.298681
0.4983 --- loss: 1.092287, loss_ss: 0.904744, loss_d: 0.187543
0.5366 --- loss: 0.931555, loss_ss: 0.819812, loss_d: 0.111744
0.5749 --- loss: 1.134365, loss_ss: 0.884281, loss_d: 0.250084
0.6133 --- loss: 1.108328, loss_ss: 0.832940, loss_d: 0.275387
0.6516 --- loss: 1.015751, loss_ss: 0.824304, loss_d: 0.191447
0.6899 --- loss: 1.757622, loss_ss: 1.060737, loss_d: 0.696886
0.7282 --- loss: 1.185234, loss_ss: 0.919696, loss_d: 0.265538
0.7666 --- loss: 0.912660, loss_ss: 0.752587, loss_d: 0.160073
0.8049 --- loss: 0.907897, loss_ss: 0.727136, loss_d: 0.180761
0.8432 --- loss: 1.082447, loss_ss: 0.916416, loss_d: 0.166030
0.8816 --- loss: 1.010056, loss_ss: 0.843777, loss_d: 0.166279
0.9199 --- loss: 0.908984, loss_ss: 0.668565, loss_d: 0.240419
0.9582 --- loss: 1.044620, loss_ss: 0.849943, loss_d: 0.194677
0.9966 --- loss: 1.199787, loss_ss: 0.951411, loss_d: 0.248375
Epoch finished! Loss: 1.2008704462876687
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.173541, loss_ss: 0.996339, loss_d: 0.177202
0.0383 --- loss: 0.734340, loss_ss: 0.632389, loss_d: 0.101952
0.0767 --- loss: 1.697232, loss_ss: 0.743935, loss_d: 0.953297
0.1150 --- loss: 1.295813, loss_ss: 0.997823, loss_d: 0.297989
0.1533 --- loss: 1.009881, loss_ss: 0.822093, loss_d: 0.187789
0.1916 --- loss: 0.833672, loss_ss: 0.611253, loss_d: 0.222419
0.2300 --- loss: 1.307138, loss_ss: 0.852295, loss_d: 0.454843
0.2683 --- loss: 1.175642, loss_ss: 0.938070, loss_d: 0.237572
0.3066 --- loss: 1.640385, loss_ss: 1.293282, loss_d: 0.347103
0.3450 --- loss: 1.284530, loss_ss: 1.160921, loss_d: 0.123609
0.3833 --- loss: 0.980334, loss_ss: 0.710893, loss_d: 0.269441
0.4216 --- loss: 1.252354, loss_ss: 0.791169, loss_d: 0.461186
0.4599 --- loss: 0.842186, loss_ss: 0.735864, loss_d: 0.106322
0.4983 --- loss: 0.927452, loss_ss: 0.578910, loss_d: 0.348542
0.5366 --- loss: 1.163935, loss_ss: 0.875803, loss_d: 0.288132
0.5749 --- loss: 0.916694, loss_ss: 0.639720, loss_d: 0.276974
0.6133 --- loss: 1.543085, loss_ss: 0.817571, loss_d: 0.725515
0.6516 --- loss: 0.929338, loss_ss: 0.803891, loss_d: 0.125447
0.6899 --- loss: 0.897258, loss_ss: 0.804286, loss_d: 0.092972
0.7282 --- loss: 1.619788, loss_ss: 1.203031, loss_d: 0.416757
0.7666 --- loss: 1.056110, loss_ss: 0.890266, loss_d: 0.165843
0.8049 --- loss: 1.329058, loss_ss: 1.023745, loss_d: 0.305313
0.8432 --- loss: 1.000152, loss_ss: 0.840619, loss_d: 0.159533
0.8816 --- loss: 1.100409, loss_ss: 0.917432, loss_d: 0.182976
0.9199 --- loss: 0.945271, loss_ss: 0.767558, loss_d: 0.177713
0.9582 --- loss: 1.211670, loss_ss: 1.063231, loss_d: 0.148439
0.9966 --- loss: 1.007522, loss_ss: 0.764044, loss_d: 0.243479
Epoch finished! Loss: 1.1655933199020532
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.825760, loss_ss: 0.687087, loss_d: 0.138673
0.0383 --- loss: 0.906633, loss_ss: 0.723613, loss_d: 0.183020
0.0767 --- loss: 1.722173, loss_ss: 1.128476, loss_d: 0.593697
0.1150 --- loss: 0.952602, loss_ss: 0.802135, loss_d: 0.150467
0.1533 --- loss: 1.350894, loss_ss: 1.002519, loss_d: 0.348376
0.1916 --- loss: 1.777889, loss_ss: 1.186925, loss_d: 0.590965
0.2300 --- loss: 1.459001, loss_ss: 0.831855, loss_d: 0.627146
0.2683 --- loss: 0.850629, loss_ss: 0.701990, loss_d: 0.148639
0.3066 --- loss: 1.113796, loss_ss: 0.944565, loss_d: 0.169232
0.3450 --- loss: 1.412822, loss_ss: 0.833813, loss_d: 0.579009
0.3833 --- loss: 1.540515, loss_ss: 0.915848, loss_d: 0.624667
0.4216 --- loss: 0.826726, loss_ss: 0.652720, loss_d: 0.174006
0.4599 --- loss: 0.748931, loss_ss: 0.506531, loss_d: 0.242400
0.4983 --- loss: 0.832007, loss_ss: 0.577723, loss_d: 0.254284
0.5366 --- loss: 1.340863, loss_ss: 1.180315, loss_d: 0.160548
0.5749 --- loss: 1.381196, loss_ss: 1.136181, loss_d: 0.245015
0.6133 --- loss: 0.886206, loss_ss: 0.602567, loss_d: 0.283638
0.6516 --- loss: 0.939125, loss_ss: 0.701492, loss_d: 0.237633
0.6899 --- loss: 1.105337, loss_ss: 1.027688, loss_d: 0.077650
0.7282 --- loss: 1.676023, loss_ss: 1.391240, loss_d: 0.284783
0.7666 --- loss: 1.407949, loss_ss: 1.157898, loss_d: 0.250051
0.8049 --- loss: 1.027536, loss_ss: 0.836881, loss_d: 0.190655
0.8432 --- loss: 1.502720, loss_ss: 0.828852, loss_d: 0.673867
0.8816 --- loss: 0.768635, loss_ss: 0.631691, loss_d: 0.136944
0.9199 --- loss: 1.490707, loss_ss: 0.985336, loss_d: 0.505371
0.9582 --- loss: 0.932828, loss_ss: 0.817765, loss_d: 0.115063
0.9966 --- loss: 1.001227, loss_ss: 0.888827, loss_d: 0.112401
Epoch finished! Loss: 1.1565826920362619
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.694273, loss_ss: 0.636729, loss_d: 0.057544
0.0383 --- loss: 1.276697, loss_ss: 0.872373, loss_d: 0.404323
0.0767 --- loss: 0.928227, loss_ss: 0.776253, loss_d: 0.151975
0.1150 --- loss: 0.857174, loss_ss: 0.718412, loss_d: 0.138762
0.1533 --- loss: 0.813251, loss_ss: 0.624768, loss_d: 0.188483
0.1916 --- loss: 1.135974, loss_ss: 0.988651, loss_d: 0.147323
0.2300 --- loss: 1.005844, loss_ss: 0.952521, loss_d: 0.053323
0.2683 --- loss: 1.512347, loss_ss: 1.380478, loss_d: 0.131869
0.3066 --- loss: 1.728510, loss_ss: 1.089771, loss_d: 0.638740
0.3450 --- loss: 0.908468, loss_ss: 0.812790, loss_d: 0.095678
0.3833 --- loss: 0.867061, loss_ss: 0.619449, loss_d: 0.247612
0.4216 --- loss: 0.786877, loss_ss: 0.666163, loss_d: 0.120714
0.4599 --- loss: 0.855916, loss_ss: 0.746515, loss_d: 0.109402
0.4983 --- loss: 1.155155, loss_ss: 1.020762, loss_d: 0.134393
0.5366 --- loss: 1.065491, loss_ss: 0.949153, loss_d: 0.116337
0.5749 --- loss: 1.136023, loss_ss: 1.014388, loss_d: 0.121635
0.6133 --- loss: 1.362293, loss_ss: 0.863833, loss_d: 0.498459
0.6516 --- loss: 1.049260, loss_ss: 0.845510, loss_d: 0.203750
0.6899 --- loss: 0.938704, loss_ss: 0.836328, loss_d: 0.102376
0.7282 --- loss: 1.235429, loss_ss: 0.632915, loss_d: 0.602515
0.7666 --- loss: 1.184284, loss_ss: 0.556727, loss_d: 0.627557
0.8049 --- loss: 1.447521, loss_ss: 0.859719, loss_d: 0.587802
0.8432 --- loss: 1.374895, loss_ss: 0.980753, loss_d: 0.394141
0.8816 --- loss: 0.991360, loss_ss: 0.722077, loss_d: 0.269282
0.9199 --- loss: 1.085350, loss_ss: 0.847724, loss_d: 0.237626
0.9582 --- loss: 0.908635, loss_ss: 0.716538, loss_d: 0.192097
0.9966 --- loss: 1.528545, loss_ss: 0.705207, loss_d: 0.823338
Epoch finished! Loss: 1.1397105051920964
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.3275862068965517
             precision    recall  f1-score   support

        0.0       0.55      0.31      0.40       291
        1.0       0.13      0.02      0.03       231
        2.0       0.53      0.46      0.49       233
        3.0       0.28      0.20      0.23        25
        4.0       0.17      0.88      0.29        90

avg / total       0.39      0.33      0.31       870
 


====== chp047-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  68.51  30.93   87.39  55.21     39.65
1  70.92   1.73   95.93  13.33      3.07
2  74.71  45.92   85.24  53.23     49.31
3  96.21  20.00   98.46  27.78     23.26
4  55.17  87.78   51.41  17.25     28.83
Total accuracy: 32.76%
Average sen: 37.27%
Average spec: 83.69%
Macro f1-score: 28.82%
[0.51039755 0.68398744 0.87355238 0.79485381 0.64175642 0.87301207
 0.64782804 0.64590335 0.9380731  0.63978845 0.93269616 0.91827846
 0.92868179 0.72855991 0.78505743 0.89441413 0.43938324 0.33604145
 0.6375947  0.68127185 0.74212229 0.83079958 0.82444268 0.94657445
 0.32124883 0.39730653 0.65694326 0.3008441  0.68028182]
pred: 0.6976446642957884, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.310875, loss_ss: 1.611012, loss_d: 0.699863
0.0384 --- loss: 2.191220, loss_ss: 1.703398, loss_d: 0.487821
0.0768 --- loss: 1.952501, loss_ss: 1.346238, loss_d: 0.606264
0.1152 --- loss: 2.010135, loss_ss: 1.351980, loss_d: 0.658154
0.1536 --- loss: 2.010679, loss_ss: 1.631780, loss_d: 0.378900
0.1920 --- loss: 1.744595, loss_ss: 1.265524, loss_d: 0.479071
0.2304 --- loss: 1.972234, loss_ss: 1.391452, loss_d: 0.580782
0.2688 --- loss: 2.160343, loss_ss: 1.581250, loss_d: 0.579094
0.3072 --- loss: 1.699363, loss_ss: 1.325673, loss_d: 0.373690
0.3456 --- loss: 2.017122, loss_ss: 1.409614, loss_d: 0.607508
0.3840 --- loss: 2.050297, loss_ss: 1.660909, loss_d: 0.389388
0.4224 --- loss: 2.091684, loss_ss: 1.494624, loss_d: 0.597060
0.4608 --- loss: 2.246804, loss_ss: 1.609777, loss_d: 0.637027
0.4992 --- loss: 2.435825, loss_ss: 1.551088, loss_d: 0.884737
0.5376 --- loss: 2.010956, loss_ss: 1.399965, loss_d: 0.610991
0.5760 --- loss: 1.903775, loss_ss: 1.317760, loss_d: 0.586015
0.6144 --- loss: 2.106614, loss_ss: 1.375286, loss_d: 0.731328
0.6528 --- loss: 1.800361, loss_ss: 1.200072, loss_d: 0.600289
0.6912 --- loss: 1.770927, loss_ss: 1.074375, loss_d: 0.696552
0.7296 --- loss: 1.615914, loss_ss: 1.124989, loss_d: 0.490925
0.7680 --- loss: 1.777682, loss_ss: 1.293840, loss_d: 0.483842
0.8065 --- loss: 1.754123, loss_ss: 1.467650, loss_d: 0.286473
0.8449 --- loss: 1.759175, loss_ss: 1.274000, loss_d: 0.485175
0.8833 --- loss: 2.031071, loss_ss: 1.449675, loss_d: 0.581396
0.9217 --- loss: 1.915624, loss_ss: 1.264453, loss_d: 0.651171
0.9601 --- loss: 1.599010, loss_ss: 1.184017, loss_d: 0.414993
0.9985 --- loss: 2.318859, loss_ss: 1.457925, loss_d: 0.860934
Epoch finished! Loss: 1.957744836807251
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.005945, loss_ss: 1.071275, loss_d: 0.934670
0.0384 --- loss: 1.925614, loss_ss: 1.238042, loss_d: 0.687572
0.0768 --- loss: 1.907965, loss_ss: 1.209206, loss_d: 0.698760
0.1152 --- loss: 1.690069, loss_ss: 1.165170, loss_d: 0.524899
0.1536 --- loss: 1.792944, loss_ss: 1.262696, loss_d: 0.530247
0.1920 --- loss: 1.853435, loss_ss: 1.240504, loss_d: 0.612932
0.2304 --- loss: 1.840681, loss_ss: 1.383073, loss_d: 0.457608
0.2688 --- loss: 1.701608, loss_ss: 1.042948, loss_d: 0.658660
0.3072 --- loss: 2.073420, loss_ss: 1.328068, loss_d: 0.745352
0.3456 --- loss: 1.896637, loss_ss: 1.060255, loss_d: 0.836383
0.3840 --- loss: 1.429977, loss_ss: 0.988116, loss_d: 0.441860
0.4224 --- loss: 1.681021, loss_ss: 1.157013, loss_d: 0.524008
0.4608 --- loss: 1.890255, loss_ss: 1.137677, loss_d: 0.752578
0.4992 --- loss: 1.955101, loss_ss: 1.141814, loss_d: 0.813288
0.5376 --- loss: 1.563412, loss_ss: 0.986380, loss_d: 0.577032
0.5760 --- loss: 1.549761, loss_ss: 1.052144, loss_d: 0.497617
0.6144 --- loss: 1.454499, loss_ss: 1.014477, loss_d: 0.440021
0.6528 --- loss: 1.826995, loss_ss: 1.267022, loss_d: 0.559973
0.6912 --- loss: 1.497154, loss_ss: 1.146671, loss_d: 0.350483
0.7296 --- loss: 1.589196, loss_ss: 1.176811, loss_d: 0.412385
0.7680 --- loss: 1.656344, loss_ss: 1.238603, loss_d: 0.417741
0.8065 --- loss: 1.684609, loss_ss: 0.990923, loss_d: 0.693686
0.8449 --- loss: 1.643515, loss_ss: 0.982382, loss_d: 0.661132
0.8833 --- loss: 1.793929, loss_ss: 1.289456, loss_d: 0.504473
0.9217 --- loss: 1.678314, loss_ss: 0.938466, loss_d: 0.739848
0.9601 --- loss: 1.956810, loss_ss: 1.131213, loss_d: 0.825596
0.9985 --- loss: 1.994802, loss_ss: 1.419256, loss_d: 0.575546
Epoch finished! Loss: 1.6968596091637245
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.582346, loss_ss: 0.962682, loss_d: 0.619664
0.0384 --- loss: 1.629887, loss_ss: 1.067276, loss_d: 0.562611
0.0768 --- loss: 1.500585, loss_ss: 1.000362, loss_d: 0.500223
0.1152 --- loss: 1.724380, loss_ss: 1.093599, loss_d: 0.630781
0.1536 --- loss: 1.595112, loss_ss: 1.059718, loss_d: 0.535395
0.1920 --- loss: 1.446383, loss_ss: 0.844309, loss_d: 0.602074
0.2304 --- loss: 1.425142, loss_ss: 0.825247, loss_d: 0.599895
0.2688 --- loss: 1.623908, loss_ss: 1.126270, loss_d: 0.497638
0.3072 --- loss: 1.117888, loss_ss: 0.847055, loss_d: 0.270832
0.3456 --- loss: 1.166573, loss_ss: 0.938344, loss_d: 0.228229
0.3840 --- loss: 1.471971, loss_ss: 0.925375, loss_d: 0.546596
0.4224 --- loss: 1.803338, loss_ss: 1.032890, loss_d: 0.770449
0.4608 --- loss: 1.398730, loss_ss: 0.869267, loss_d: 0.529463
0.4992 --- loss: 1.519541, loss_ss: 0.900748, loss_d: 0.618793
0.5376 --- loss: 1.640475, loss_ss: 1.121522, loss_d: 0.518952
0.5760 --- loss: 1.743742, loss_ss: 1.093980, loss_d: 0.649762
0.6144 --- loss: 1.613567, loss_ss: 1.020656, loss_d: 0.592911
0.6528 --- loss: 1.778337, loss_ss: 1.105313, loss_d: 0.673025
0.6912 --- loss: 1.252338, loss_ss: 0.781743, loss_d: 0.470595
0.7296 --- loss: 1.552762, loss_ss: 1.005464, loss_d: 0.547298
0.7680 --- loss: 1.435214, loss_ss: 0.806501, loss_d: 0.628713
0.8065 --- loss: 1.512208, loss_ss: 0.914551, loss_d: 0.597657
0.8449 --- loss: 1.633473, loss_ss: 1.101994, loss_d: 0.531479
0.8833 --- loss: 1.412258, loss_ss: 0.941426, loss_d: 0.470831
0.9217 --- loss: 1.859121, loss_ss: 0.912901, loss_d: 0.946220
0.9601 --- loss: 1.666061, loss_ss: 0.925622, loss_d: 0.740439
0.9985 --- loss: 1.962438, loss_ss: 1.034970, loss_d: 0.927468
Epoch finished! Loss: 1.5960597370679561
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.362563, loss_ss: 1.005768, loss_d: 0.356795
0.0384 --- loss: 1.399178, loss_ss: 0.863631, loss_d: 0.535547
0.0768 --- loss: 1.857544, loss_ss: 0.995404, loss_d: 0.862140
0.1152 --- loss: 1.568495, loss_ss: 1.028312, loss_d: 0.540183
0.1536 --- loss: 1.212858, loss_ss: 0.686778, loss_d: 0.526080
0.1920 --- loss: 1.550748, loss_ss: 1.037416, loss_d: 0.513332
0.2304 --- loss: 1.688541, loss_ss: 0.998131, loss_d: 0.690410
0.2688 --- loss: 1.620141, loss_ss: 1.212286, loss_d: 0.407854
0.3072 --- loss: 1.502995, loss_ss: 1.062059, loss_d: 0.440936
0.3456 --- loss: 1.842741, loss_ss: 1.138526, loss_d: 0.704215
0.3840 --- loss: 1.540902, loss_ss: 0.891386, loss_d: 0.649516
0.4224 --- loss: 1.692985, loss_ss: 1.153619, loss_d: 0.539366
0.4608 --- loss: 1.093045, loss_ss: 0.627834, loss_d: 0.465211
0.4992 --- loss: 1.299043, loss_ss: 0.808642, loss_d: 0.490400
0.5376 --- loss: 1.586373, loss_ss: 0.733931, loss_d: 0.852442
0.5760 --- loss: 1.505663, loss_ss: 0.922527, loss_d: 0.583136
0.6144 --- loss: 1.848428, loss_ss: 1.266652, loss_d: 0.581777
0.6528 --- loss: 1.201933, loss_ss: 0.643341, loss_d: 0.558592
0.6912 --- loss: 1.635942, loss_ss: 1.128300, loss_d: 0.507641
0.7296 --- loss: 1.718286, loss_ss: 1.188140, loss_d: 0.530146
0.7680 --- loss: 1.834347, loss_ss: 1.100672, loss_d: 0.733675
0.8065 --- loss: 1.673511, loss_ss: 1.195131, loss_d: 0.478380
0.8449 --- loss: 1.625398, loss_ss: 1.125295, loss_d: 0.500103
0.8833 --- loss: 1.366047, loss_ss: 0.825319, loss_d: 0.540729
0.9217 --- loss: 1.557950, loss_ss: 1.115556, loss_d: 0.442395
0.9601 --- loss: 1.665561, loss_ss: 1.138255, loss_d: 0.527307
0.9985 --- loss: 1.806578, loss_ss: 1.149578, loss_d: 0.657000
Epoch finished! Loss: 1.5486532128774202
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.388088, loss_ss: 0.927769, loss_d: 0.460320
0.0384 --- loss: 1.513920, loss_ss: 0.730233, loss_d: 0.783688
0.0768 --- loss: 1.454947, loss_ss: 0.874047, loss_d: 0.580901
0.1152 --- loss: 1.472339, loss_ss: 0.903394, loss_d: 0.568945
0.1536 --- loss: 1.325207, loss_ss: 0.936018, loss_d: 0.389189
0.1920 --- loss: 1.597856, loss_ss: 1.388274, loss_d: 0.209582
0.2304 --- loss: 1.633511, loss_ss: 0.985193, loss_d: 0.648318
0.2688 --- loss: 1.138544, loss_ss: 0.832003, loss_d: 0.306541
0.3072 --- loss: 1.385664, loss_ss: 0.877051, loss_d: 0.508613
0.3456 --- loss: 1.239565, loss_ss: 0.840691, loss_d: 0.398874
0.3840 --- loss: 0.996392, loss_ss: 0.602956, loss_d: 0.393436
0.4224 --- loss: 1.197506, loss_ss: 0.765659, loss_d: 0.431847
0.4608 --- loss: 1.153220, loss_ss: 0.716857, loss_d: 0.436363
0.4992 --- loss: 1.459282, loss_ss: 1.007116, loss_d: 0.452165
0.5376 --- loss: 1.325871, loss_ss: 0.824334, loss_d: 0.501538
0.5760 --- loss: 1.668043, loss_ss: 0.806323, loss_d: 0.861719
0.6144 --- loss: 1.269043, loss_ss: 0.876166, loss_d: 0.392878
0.6528 --- loss: 1.511337, loss_ss: 1.047263, loss_d: 0.464074
0.6912 --- loss: 1.267709, loss_ss: 0.754830, loss_d: 0.512879
0.7296 --- loss: 1.214436, loss_ss: 0.655364, loss_d: 0.559072
0.7680 --- loss: 1.398490, loss_ss: 1.176026, loss_d: 0.222463
0.8065 --- loss: 1.156566, loss_ss: 0.835130, loss_d: 0.321436
0.8449 --- loss: 1.391796, loss_ss: 0.783335, loss_d: 0.608461
0.8833 --- loss: 1.680432, loss_ss: 1.145226, loss_d: 0.535206
0.9217 --- loss: 1.325184, loss_ss: 0.791235, loss_d: 0.533949
0.9601 --- loss: 1.706122, loss_ss: 0.812574, loss_d: 0.893548
0.9985 --- loss: 1.467340, loss_ss: 1.011530, loss_d: 0.455809
Epoch finished! Loss: 1.5048029725368206
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.311900, loss_ss: 0.736723, loss_d: 0.575177
0.0384 --- loss: 1.656129, loss_ss: 1.265100, loss_d: 0.391029
0.0768 --- loss: 1.601143, loss_ss: 1.081030, loss_d: 0.520113
0.1152 --- loss: 1.288696, loss_ss: 0.946918, loss_d: 0.341777
0.1536 --- loss: 1.555047, loss_ss: 0.999741, loss_d: 0.555306
0.1920 --- loss: 1.531798, loss_ss: 0.851408, loss_d: 0.680390
0.2304 --- loss: 1.393944, loss_ss: 1.014226, loss_d: 0.379718
0.2688 --- loss: 0.903438, loss_ss: 0.679231, loss_d: 0.224207
0.3072 --- loss: 1.242759, loss_ss: 0.975877, loss_d: 0.266881
0.3456 --- loss: 0.947146, loss_ss: 0.692661, loss_d: 0.254485
0.3840 --- loss: 1.504500, loss_ss: 0.829785, loss_d: 0.674715
0.4224 --- loss: 1.114060, loss_ss: 0.722321, loss_d: 0.391739
0.4608 --- loss: 1.529632, loss_ss: 0.906638, loss_d: 0.622994
0.4992 --- loss: 1.138679, loss_ss: 0.879222, loss_d: 0.259457
0.5376 --- loss: 1.391603, loss_ss: 0.898208, loss_d: 0.493395
0.5760 --- loss: 1.108938, loss_ss: 0.712476, loss_d: 0.396462
0.6144 --- loss: 1.703985, loss_ss: 0.782568, loss_d: 0.921417
0.6528 --- loss: 1.492983, loss_ss: 1.171227, loss_d: 0.321756
0.6912 --- loss: 1.243912, loss_ss: 0.786166, loss_d: 0.457746
0.7296 --- loss: 1.626356, loss_ss: 0.869499, loss_d: 0.756857
0.7680 --- loss: 1.395188, loss_ss: 0.865671, loss_d: 0.529517
0.8065 --- loss: 1.135592, loss_ss: 0.877224, loss_d: 0.258368
0.8449 --- loss: 1.698823, loss_ss: 1.186117, loss_d: 0.512706
0.8833 --- loss: 1.234013, loss_ss: 1.002412, loss_d: 0.231601
0.9217 --- loss: 1.080333, loss_ss: 0.640194, loss_d: 0.440139
0.9601 --- loss: 1.132916, loss_ss: 0.615129, loss_d: 0.517786
0.9985 --- loss: 2.065491, loss_ss: 1.626127, loss_d: 0.439364
Epoch finished! Loss: 1.3896124124526978
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.544454, loss_ss: 1.195859, loss_d: 0.348595
0.0384 --- loss: 1.275815, loss_ss: 1.042350, loss_d: 0.233465
0.0768 --- loss: 1.580094, loss_ss: 0.882699, loss_d: 0.697395
0.1152 --- loss: 1.192011, loss_ss: 0.950526, loss_d: 0.241485
0.1536 --- loss: 1.494336, loss_ss: 1.093855, loss_d: 0.400481
0.1920 --- loss: 1.190138, loss_ss: 0.966732, loss_d: 0.223406
0.2304 --- loss: 1.114471, loss_ss: 0.745987, loss_d: 0.368484
0.2688 --- loss: 1.111264, loss_ss: 0.683585, loss_d: 0.427679
0.3072 --- loss: 1.363790, loss_ss: 0.914375, loss_d: 0.449414
0.3456 --- loss: 1.725675, loss_ss: 1.266721, loss_d: 0.458954
0.3840 --- loss: 1.433762, loss_ss: 1.126298, loss_d: 0.307464
0.4224 --- loss: 1.521767, loss_ss: 0.935674, loss_d: 0.586094
0.4608 --- loss: 1.058120, loss_ss: 0.788491, loss_d: 0.269629
0.4992 --- loss: 0.960793, loss_ss: 0.634169, loss_d: 0.326624
0.5376 --- loss: 1.485852, loss_ss: 0.973530, loss_d: 0.512322
0.5760 --- loss: 1.208795, loss_ss: 0.752818, loss_d: 0.455978
0.6144 --- loss: 1.050390, loss_ss: 0.873584, loss_d: 0.176805
0.6528 --- loss: 1.732452, loss_ss: 0.778709, loss_d: 0.953742
0.6912 --- loss: 1.058956, loss_ss: 0.699631, loss_d: 0.359325
0.7296 --- loss: 1.132453, loss_ss: 0.850180, loss_d: 0.282273
0.7680 --- loss: 1.104401, loss_ss: 0.662596, loss_d: 0.441805
0.8065 --- loss: 1.131433, loss_ss: 0.948602, loss_d: 0.182832
0.8449 --- loss: 1.281017, loss_ss: 1.063891, loss_d: 0.217126
0.8833 --- loss: 1.150487, loss_ss: 0.948644, loss_d: 0.201843
0.9217 --- loss: 1.130477, loss_ss: 0.963624, loss_d: 0.166853
0.9601 --- loss: 1.084385, loss_ss: 0.871108, loss_d: 0.213276
0.9985 --- loss: 1.583558, loss_ss: 1.009865, loss_d: 0.573693
Epoch finished! Loss: 1.290400386085877
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.257017, loss_ss: 0.925339, loss_d: 0.331678
0.0384 --- loss: 1.398657, loss_ss: 0.796485, loss_d: 0.602171
0.0768 --- loss: 1.277679, loss_ss: 1.105280, loss_d: 0.172399
0.1152 --- loss: 1.218973, loss_ss: 0.852237, loss_d: 0.366737
0.1536 --- loss: 1.020845, loss_ss: 0.789232, loss_d: 0.231613
0.1920 --- loss: 1.302340, loss_ss: 1.067196, loss_d: 0.235144
0.2304 --- loss: 1.370724, loss_ss: 1.118073, loss_d: 0.252650
0.2688 --- loss: 1.159017, loss_ss: 0.842652, loss_d: 0.316365
0.3072 --- loss: 1.922958, loss_ss: 1.107320, loss_d: 0.815638
0.3456 --- loss: 0.882633, loss_ss: 0.665576, loss_d: 0.217057
0.3840 --- loss: 0.946408, loss_ss: 0.764517, loss_d: 0.181891
0.4224 --- loss: 1.191186, loss_ss: 0.975562, loss_d: 0.215624
0.4608 --- loss: 1.241274, loss_ss: 1.012927, loss_d: 0.228347
0.4992 --- loss: 1.326525, loss_ss: 1.134283, loss_d: 0.192242
0.5376 --- loss: 1.053953, loss_ss: 0.830018, loss_d: 0.223935
0.5760 --- loss: 1.319386, loss_ss: 0.857036, loss_d: 0.462350
0.6144 --- loss: 1.102813, loss_ss: 0.869975, loss_d: 0.232838
0.6528 --- loss: 1.353423, loss_ss: 0.876704, loss_d: 0.476719
0.6912 --- loss: 1.060785, loss_ss: 0.772789, loss_d: 0.287996
0.7296 --- loss: 1.271888, loss_ss: 0.948202, loss_d: 0.323685
0.7680 --- loss: 1.118368, loss_ss: 0.825694, loss_d: 0.292674
0.8065 --- loss: 1.436637, loss_ss: 1.281441, loss_d: 0.155196
0.8449 --- loss: 1.874385, loss_ss: 1.590075, loss_d: 0.284310
0.8833 --- loss: 0.858042, loss_ss: 0.652963, loss_d: 0.205079
0.9217 --- loss: 1.410218, loss_ss: 1.012805, loss_d: 0.397413
0.9601 --- loss: 1.727391, loss_ss: 0.944433, loss_d: 0.782957
0.9985 --- loss: 1.296642, loss_ss: 1.063492, loss_d: 0.233150
Epoch finished! Loss: 1.2427512854337692
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.030210, loss_ss: 0.863216, loss_d: 0.166994
0.0384 --- loss: 1.200724, loss_ss: 0.833430, loss_d: 0.367294
0.0768 --- loss: 1.369876, loss_ss: 1.004935, loss_d: 0.364941
0.1152 --- loss: 1.193901, loss_ss: 0.984361, loss_d: 0.209539
0.1536 --- loss: 0.685048, loss_ss: 0.591322, loss_d: 0.093726
0.1920 --- loss: 1.404325, loss_ss: 0.776217, loss_d: 0.628107
0.2304 --- loss: 1.421419, loss_ss: 0.849774, loss_d: 0.571646
0.2688 --- loss: 1.109279, loss_ss: 1.036393, loss_d: 0.072886
0.3072 --- loss: 0.986163, loss_ss: 0.778265, loss_d: 0.207898
0.3456 --- loss: 1.322950, loss_ss: 1.113610, loss_d: 0.209340
0.3840 --- loss: 1.200823, loss_ss: 0.836633, loss_d: 0.364190
0.4224 --- loss: 1.083852, loss_ss: 0.571134, loss_d: 0.512719
0.4608 --- loss: 1.587762, loss_ss: 0.934515, loss_d: 0.653247
0.4992 --- loss: 1.479560, loss_ss: 1.169889, loss_d: 0.309671
0.5376 --- loss: 1.193979, loss_ss: 0.763222, loss_d: 0.430757
0.5760 --- loss: 0.996969, loss_ss: 0.886004, loss_d: 0.110965
0.6144 --- loss: 1.008901, loss_ss: 0.895039, loss_d: 0.113862
0.6528 --- loss: 0.907217, loss_ss: 0.814006, loss_d: 0.093211
0.6912 --- loss: 1.124929, loss_ss: 0.761048, loss_d: 0.363881
0.7296 --- loss: 0.954871, loss_ss: 0.825191, loss_d: 0.129680
0.7680 --- loss: 0.962870, loss_ss: 0.769988, loss_d: 0.192882
0.8065 --- loss: 1.415194, loss_ss: 0.780467, loss_d: 0.634727
0.8449 --- loss: 1.136658, loss_ss: 0.974717, loss_d: 0.161941
0.8833 --- loss: 1.419163, loss_ss: 0.870314, loss_d: 0.548848
0.9217 --- loss: 1.128088, loss_ss: 0.777930, loss_d: 0.350158
0.9601 --- loss: 0.842797, loss_ss: 0.617001, loss_d: 0.225796
0.9985 --- loss: 1.643631, loss_ss: 1.006414, loss_d: 0.637217
Epoch finished! Loss: 1.1888635131028982
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.268316, loss_ss: 0.931519, loss_d: 0.336797
0.0384 --- loss: 1.373404, loss_ss: 0.930449, loss_d: 0.442955
0.0768 --- loss: 1.079644, loss_ss: 0.886411, loss_d: 0.193233
0.1152 --- loss: 1.580535, loss_ss: 0.904855, loss_d: 0.675680
0.1536 --- loss: 2.126683, loss_ss: 0.646486, loss_d: 1.480196
0.1920 --- loss: 1.007500, loss_ss: 0.684860, loss_d: 0.322641
0.2304 --- loss: 1.652675, loss_ss: 1.093990, loss_d: 0.558685
0.2688 --- loss: 1.114841, loss_ss: 0.958784, loss_d: 0.156057
0.3072 --- loss: 1.189958, loss_ss: 0.927829, loss_d: 0.262129
0.3456 --- loss: 0.675288, loss_ss: 0.554744, loss_d: 0.120545
0.3840 --- loss: 0.867816, loss_ss: 0.751334, loss_d: 0.116482
0.4224 --- loss: 1.051946, loss_ss: 0.683757, loss_d: 0.368189
0.4608 --- loss: 1.018668, loss_ss: 0.736414, loss_d: 0.282254
0.4992 --- loss: 0.852093, loss_ss: 0.668907, loss_d: 0.183187
0.5376 --- loss: 0.894181, loss_ss: 0.774136, loss_d: 0.120045
0.5760 --- loss: 0.766042, loss_ss: 0.595964, loss_d: 0.170077
0.6144 --- loss: 0.978681, loss_ss: 0.906907, loss_d: 0.071774
0.6528 --- loss: 0.814706, loss_ss: 0.707033, loss_d: 0.107673
0.6912 --- loss: 1.351410, loss_ss: 1.147264, loss_d: 0.204145
0.7296 --- loss: 1.168032, loss_ss: 0.940310, loss_d: 0.227722
0.7680 --- loss: 0.908787, loss_ss: 0.628061, loss_d: 0.280727
0.8065 --- loss: 0.781327, loss_ss: 0.630417, loss_d: 0.150909
0.8449 --- loss: 1.715906, loss_ss: 1.037972, loss_d: 0.677933
0.8833 --- loss: 1.514500, loss_ss: 1.166400, loss_d: 0.348101
0.9217 --- loss: 1.020959, loss_ss: 0.717222, loss_d: 0.303737
0.9601 --- loss: 0.994703, loss_ss: 0.831747, loss_d: 0.162956
0.9985 --- loss: 1.062005, loss_ss: 0.776974, loss_d: 0.285031
Epoch finished! Loss: 1.1438273627024431
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6411764705882353
             precision    recall  f1-score   support

        0.0       0.19      0.97      0.32        38
        1.0       0.38      0.12      0.19       144
        2.0       0.83      0.74      0.78       495
        3.0       0.57      0.74      0.64       107
        4.0       0.77      0.65      0.71       236

avg / total       0.70      0.64      0.65      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.31  97.37   83.81  18.88     31.62
1  84.71  12.50   96.58  37.50     18.75
2  80.20  73.94   86.10  83.37     78.37
3  91.47  73.83   93.54  57.25     64.49
4  87.55  65.25   94.26  77.39     70.80
Total accuracy: 64.12%
Average sen: 64.58%
Average spec: 90.86%
Macro f1-score: 52.81%
[0.05838578 0.09789541 0.08307412 0.05946768 0.09306385 0.14098395
 0.07780772 0.08561338 0.19131543 0.09514228 0.05323108 0.14642926
 0.09047418 0.16292752 0.10541525 0.30677477 0.06290319 0.04613939
 0.06009596 0.0919953  0.0848716  0.25844827 0.10119407 0.07633306
 0.18995017 0.06306513 0.07733236 0.5056017  0.19407122 0.11063906
 0.12582791 0.17185894 0.3315154  0.2790648 ]
pred: 0.13761497584774213, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.223935, loss_ss: 1.564456, loss_d: 0.659479
0.0384 --- loss: 2.146199, loss_ss: 1.608348, loss_d: 0.537851
0.0769 --- loss: 2.106477, loss_ss: 1.402409, loss_d: 0.704068
0.1153 --- loss: 2.095792, loss_ss: 1.504301, loss_d: 0.591492
0.1537 --- loss: 2.273286, loss_ss: 1.484042, loss_d: 0.789244
0.1922 --- loss: 2.031767, loss_ss: 1.455016, loss_d: 0.576751
0.2306 --- loss: 2.025862, loss_ss: 1.370358, loss_d: 0.655505
0.2690 --- loss: 2.089861, loss_ss: 1.390625, loss_d: 0.699236
0.3075 --- loss: 2.121296, loss_ss: 1.450062, loss_d: 0.671234
0.3459 --- loss: 1.845599, loss_ss: 1.325397, loss_d: 0.520202
0.3843 --- loss: 1.977249, loss_ss: 1.325845, loss_d: 0.651405
0.4228 --- loss: 2.005730, loss_ss: 1.255194, loss_d: 0.750536
0.4612 --- loss: 2.204247, loss_ss: 1.404137, loss_d: 0.800109
0.4996 --- loss: 1.856672, loss_ss: 1.427551, loss_d: 0.429121
0.5380 --- loss: 1.707864, loss_ss: 1.341575, loss_d: 0.366289
0.5765 --- loss: 1.681555, loss_ss: 1.178329, loss_d: 0.503226
0.6149 --- loss: 1.565879, loss_ss: 1.209864, loss_d: 0.356015
0.6533 --- loss: 1.624804, loss_ss: 1.090200, loss_d: 0.534604
0.6918 --- loss: 1.727530, loss_ss: 1.160791, loss_d: 0.566739
0.7302 --- loss: 1.822225, loss_ss: 1.288745, loss_d: 0.533479
0.7686 --- loss: 1.853332, loss_ss: 1.206275, loss_d: 0.647057
0.8071 --- loss: 1.870585, loss_ss: 1.238422, loss_d: 0.632163
0.8455 --- loss: 1.517063, loss_ss: 1.143026, loss_d: 0.374037
0.8839 --- loss: 1.566334, loss_ss: 1.052985, loss_d: 0.513349
0.9224 --- loss: 1.681089, loss_ss: 1.151987, loss_d: 0.529102
0.9608 --- loss: 1.795412, loss_ss: 1.305115, loss_d: 0.490298
0.9992 --- loss: 2.867747, loss_ss: 1.233701, loss_d: 1.634046
Epoch finished! Loss: 1.9230442675260397
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.710428, loss_ss: 1.259490, loss_d: 0.450938
0.0384 --- loss: 1.839806, loss_ss: 1.070643, loss_d: 0.769162
0.0769 --- loss: 1.738727, loss_ss: 1.119780, loss_d: 0.618947
0.1153 --- loss: 1.534010, loss_ss: 1.070763, loss_d: 0.463247
0.1537 --- loss: 1.748892, loss_ss: 1.049492, loss_d: 0.699400
0.1922 --- loss: 1.684366, loss_ss: 1.043537, loss_d: 0.640830
0.2306 --- loss: 1.657541, loss_ss: 0.966106, loss_d: 0.691435
0.2690 --- loss: 1.654363, loss_ss: 0.898965, loss_d: 0.755398
0.3075 --- loss: 1.555576, loss_ss: 1.051646, loss_d: 0.503931
0.3459 --- loss: 1.500849, loss_ss: 0.921296, loss_d: 0.579554
0.3843 --- loss: 1.801973, loss_ss: 1.232631, loss_d: 0.569341
0.4228 --- loss: 1.729870, loss_ss: 1.032073, loss_d: 0.697797
0.4612 --- loss: 1.586331, loss_ss: 0.961238, loss_d: 0.625093
0.4996 --- loss: 1.946568, loss_ss: 1.273455, loss_d: 0.673113
0.5380 --- loss: 1.980554, loss_ss: 1.257846, loss_d: 0.722708
0.5765 --- loss: 1.709797, loss_ss: 1.112283, loss_d: 0.597514
0.6149 --- loss: 2.038087, loss_ss: 1.030532, loss_d: 1.007555
0.6533 --- loss: 1.777881, loss_ss: 1.173748, loss_d: 0.604133
0.6918 --- loss: 1.405178, loss_ss: 0.920709, loss_d: 0.484470
0.7302 --- loss: 1.483689, loss_ss: 0.965469, loss_d: 0.518220
0.7686 --- loss: 1.445165, loss_ss: 1.040369, loss_d: 0.404796
0.8071 --- loss: 1.857263, loss_ss: 1.111152, loss_d: 0.746111
0.8455 --- loss: 1.891982, loss_ss: 1.215973, loss_d: 0.676009
0.8839 --- loss: 1.436513, loss_ss: 0.832809, loss_d: 0.603703
0.9224 --- loss: 1.867574, loss_ss: 1.227932, loss_d: 0.639642
0.9608 --- loss: 1.691107, loss_ss: 1.277528, loss_d: 0.413579
0.9992 --- loss: 1.737598, loss_ss: 1.140439, loss_d: 0.597160
Epoch finished! Loss: 1.6852840235600104
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.645400, loss_ss: 1.086505, loss_d: 0.558895
0.0384 --- loss: 1.636466, loss_ss: 1.063477, loss_d: 0.572988
0.0769 --- loss: 1.452773, loss_ss: 0.996743, loss_d: 0.456030
0.1153 --- loss: 1.600825, loss_ss: 1.115052, loss_d: 0.485773
0.1537 --- loss: 1.547214, loss_ss: 0.857333, loss_d: 0.689881
0.1922 --- loss: 1.754024, loss_ss: 0.933740, loss_d: 0.820284
0.2306 --- loss: 1.397171, loss_ss: 0.878139, loss_d: 0.519032
0.2690 --- loss: 1.580937, loss_ss: 0.947064, loss_d: 0.633873
0.3075 --- loss: 1.582754, loss_ss: 1.031845, loss_d: 0.550909
0.3459 --- loss: 1.659264, loss_ss: 0.988722, loss_d: 0.670543
0.3843 --- loss: 1.423582, loss_ss: 0.766513, loss_d: 0.657069
0.4228 --- loss: 1.280979, loss_ss: 1.002822, loss_d: 0.278157
0.4612 --- loss: 1.416224, loss_ss: 0.963796, loss_d: 0.452429
0.4996 --- loss: 1.522508, loss_ss: 0.943505, loss_d: 0.579003
0.5380 --- loss: 1.442663, loss_ss: 1.022501, loss_d: 0.420162
0.5765 --- loss: 1.383443, loss_ss: 1.081259, loss_d: 0.302184
0.6149 --- loss: 1.507214, loss_ss: 0.909124, loss_d: 0.598090
0.6533 --- loss: 1.864244, loss_ss: 1.247356, loss_d: 0.616888
0.6918 --- loss: 1.622913, loss_ss: 0.959411, loss_d: 0.663502
0.7302 --- loss: 1.651659, loss_ss: 0.887250, loss_d: 0.764409
0.7686 --- loss: 1.736135, loss_ss: 1.029676, loss_d: 0.706459
0.8071 --- loss: 2.077693, loss_ss: 1.371445, loss_d: 0.706247
0.8455 --- loss: 1.212048, loss_ss: 0.694488, loss_d: 0.517560
0.8839 --- loss: 1.221315, loss_ss: 0.853468, loss_d: 0.367847
0.9224 --- loss: 1.678564, loss_ss: 1.205795, loss_d: 0.472769
0.9608 --- loss: 1.690676, loss_ss: 1.231774, loss_d: 0.458903
0.9992 --- loss: 1.458961, loss_ss: 1.137618, loss_d: 0.321343
Epoch finished! Loss: 1.5623893650678489
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.254492, loss_ss: 0.689443, loss_d: 0.565049
0.0384 --- loss: 1.683722, loss_ss: 1.368457, loss_d: 0.315265
0.0769 --- loss: 1.608889, loss_ss: 0.838925, loss_d: 0.769963
0.1153 --- loss: 1.646876, loss_ss: 0.788083, loss_d: 0.858793
0.1537 --- loss: 1.458728, loss_ss: 0.989191, loss_d: 0.469538
0.1922 --- loss: 1.428661, loss_ss: 0.885584, loss_d: 0.543077
0.2306 --- loss: 1.656322, loss_ss: 1.107788, loss_d: 0.548534
0.2690 --- loss: 1.585563, loss_ss: 0.864574, loss_d: 0.720989
0.3075 --- loss: 1.247971, loss_ss: 0.843815, loss_d: 0.404156
0.3459 --- loss: 1.482867, loss_ss: 0.912227, loss_d: 0.570640
0.3843 --- loss: 1.867568, loss_ss: 1.362901, loss_d: 0.504667
0.4228 --- loss: 1.492925, loss_ss: 1.054936, loss_d: 0.437989
0.4612 --- loss: 1.421570, loss_ss: 0.993644, loss_d: 0.427926
0.4996 --- loss: 1.385221, loss_ss: 1.061820, loss_d: 0.323401
0.5380 --- loss: 1.389268, loss_ss: 0.763425, loss_d: 0.625843
0.5765 --- loss: 1.272907, loss_ss: 0.748674, loss_d: 0.524233
0.6149 --- loss: 1.984970, loss_ss: 1.141310, loss_d: 0.843660
0.6533 --- loss: 1.698772, loss_ss: 1.077707, loss_d: 0.621065
0.6918 --- loss: 1.148696, loss_ss: 0.766850, loss_d: 0.381846
0.7302 --- loss: 1.377214, loss_ss: 0.792161, loss_d: 0.585053
0.7686 --- loss: 1.216407, loss_ss: 0.903109, loss_d: 0.313298
0.8071 --- loss: 1.171280, loss_ss: 0.699280, loss_d: 0.472000
0.8455 --- loss: 1.772409, loss_ss: 1.469247, loss_d: 0.303163
0.8839 --- loss: 1.295040, loss_ss: 0.852810, loss_d: 0.442230
0.9224 --- loss: 1.767669, loss_ss: 1.114551, loss_d: 0.653118
0.9608 --- loss: 1.526113, loss_ss: 1.007695, loss_d: 0.518418
0.9992 --- loss: 1.548723, loss_ss: 1.091567, loss_d: 0.457156
Epoch finished! Loss: 1.509768308355258
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.288365, loss_ss: 0.689495, loss_d: 0.598870
0.0384 --- loss: 1.539738, loss_ss: 0.872034, loss_d: 0.667704
0.0769 --- loss: 1.465291, loss_ss: 1.079190, loss_d: 0.386100
0.1153 --- loss: 1.449626, loss_ss: 1.011873, loss_d: 0.437753
0.1537 --- loss: 1.425585, loss_ss: 1.064226, loss_d: 0.361359
0.1922 --- loss: 1.716720, loss_ss: 1.452521, loss_d: 0.264199
0.2306 --- loss: 1.703777, loss_ss: 0.804770, loss_d: 0.899006
0.2690 --- loss: 1.776039, loss_ss: 1.090918, loss_d: 0.685121
0.3075 --- loss: 1.509721, loss_ss: 1.032430, loss_d: 0.477291
0.3459 --- loss: 1.517830, loss_ss: 0.872028, loss_d: 0.645802
0.3843 --- loss: 1.441298, loss_ss: 0.802270, loss_d: 0.639029
0.4228 --- loss: 1.594981, loss_ss: 0.996520, loss_d: 0.598461
0.4612 --- loss: 1.582367, loss_ss: 0.994977, loss_d: 0.587390
0.4996 --- loss: 1.299958, loss_ss: 0.756654, loss_d: 0.543304
0.5380 --- loss: 0.965878, loss_ss: 0.578775, loss_d: 0.387103
0.5765 --- loss: 2.049364, loss_ss: 0.925251, loss_d: 1.124113
0.6149 --- loss: 1.121391, loss_ss: 0.775079, loss_d: 0.346312
0.6533 --- loss: 1.279998, loss_ss: 0.804964, loss_d: 0.475034
0.6918 --- loss: 1.421341, loss_ss: 1.084918, loss_d: 0.336423
0.7302 --- loss: 1.554568, loss_ss: 0.849020, loss_d: 0.705548
0.7686 --- loss: 1.386725, loss_ss: 0.837289, loss_d: 0.549436
0.8071 --- loss: 1.432131, loss_ss: 0.830448, loss_d: 0.601684
0.8455 --- loss: 1.535183, loss_ss: 1.188311, loss_d: 0.346872
0.8839 --- loss: 1.076113, loss_ss: 0.756525, loss_d: 0.319589
0.9224 --- loss: 1.609381, loss_ss: 0.956529, loss_d: 0.652852
0.9608 --- loss: 1.402142, loss_ss: 0.837155, loss_d: 0.564986
0.9992 --- loss: 2.115929, loss_ss: 1.766875, loss_d: 0.349055
Epoch finished! Loss: 1.4329717567333808
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.188960, loss_ss: 0.767646, loss_d: 0.421314
0.0384 --- loss: 1.379678, loss_ss: 0.896896, loss_d: 0.482781
0.0769 --- loss: 1.443952, loss_ss: 0.806728, loss_d: 0.637224
0.1153 --- loss: 1.495624, loss_ss: 0.885507, loss_d: 0.610117
0.1537 --- loss: 1.612761, loss_ss: 0.929437, loss_d: 0.683325
0.1922 --- loss: 1.151753, loss_ss: 0.673549, loss_d: 0.478205
0.2306 --- loss: 1.460024, loss_ss: 0.964335, loss_d: 0.495689
0.2690 --- loss: 1.269686, loss_ss: 0.893591, loss_d: 0.376095
0.3075 --- loss: 1.535748, loss_ss: 1.150646, loss_d: 0.385101
0.3459 --- loss: 1.154819, loss_ss: 0.865167, loss_d: 0.289652
0.3843 --- loss: 1.335742, loss_ss: 0.831876, loss_d: 0.503866
0.4228 --- loss: 1.128790, loss_ss: 0.797450, loss_d: 0.331339
0.4612 --- loss: 1.098921, loss_ss: 0.680447, loss_d: 0.418473
0.4996 --- loss: 1.504292, loss_ss: 0.939678, loss_d: 0.564614
0.5380 --- loss: 1.173313, loss_ss: 0.820135, loss_d: 0.353178
0.5765 --- loss: 1.230862, loss_ss: 0.746992, loss_d: 0.483870
0.6149 --- loss: 1.387501, loss_ss: 1.013820, loss_d: 0.373681
0.6533 --- loss: 1.048211, loss_ss: 0.606905, loss_d: 0.441307
0.6918 --- loss: 1.248702, loss_ss: 0.744184, loss_d: 0.504518
0.7302 --- loss: 1.276681, loss_ss: 0.836210, loss_d: 0.440471
0.7686 --- loss: 1.312449, loss_ss: 0.705417, loss_d: 0.607032
0.8071 --- loss: 1.432562, loss_ss: 0.734503, loss_d: 0.698059
0.8455 --- loss: 1.819730, loss_ss: 1.016811, loss_d: 0.802919
0.8839 --- loss: 1.072994, loss_ss: 0.799233, loss_d: 0.273760
0.9224 --- loss: 1.296127, loss_ss: 0.884378, loss_d: 0.411750
0.9608 --- loss: 1.306094, loss_ss: 0.794542, loss_d: 0.511553
0.9992 --- loss: 2.638189, loss_ss: 2.258655, loss_d: 0.379534
Epoch finished! Loss: 1.3864832905622628
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.438079, loss_ss: 1.080517, loss_d: 0.357562
0.0384 --- loss: 1.042922, loss_ss: 0.485064, loss_d: 0.557858
0.0769 --- loss: 1.406573, loss_ss: 0.840444, loss_d: 0.566129
0.1153 --- loss: 1.375541, loss_ss: 1.000197, loss_d: 0.375344
0.1537 --- loss: 1.124031, loss_ss: 0.829541, loss_d: 0.294490
0.1922 --- loss: 1.022082, loss_ss: 0.723966, loss_d: 0.298116
0.2306 --- loss: 1.806232, loss_ss: 1.022888, loss_d: 0.783345
0.2690 --- loss: 1.454576, loss_ss: 1.175007, loss_d: 0.279569
0.3075 --- loss: 1.487712, loss_ss: 0.819496, loss_d: 0.668216
0.3459 --- loss: 1.242577, loss_ss: 0.976284, loss_d: 0.266293
0.3843 --- loss: 1.150575, loss_ss: 0.693726, loss_d: 0.456850
0.4228 --- loss: 1.443844, loss_ss: 0.905641, loss_d: 0.538203
0.4612 --- loss: 1.302270, loss_ss: 1.055783, loss_d: 0.246487
0.4996 --- loss: 1.311920, loss_ss: 0.901618, loss_d: 0.410302
0.5380 --- loss: 1.048790, loss_ss: 0.694525, loss_d: 0.354265
0.5765 --- loss: 1.511411, loss_ss: 1.229292, loss_d: 0.282119
0.6149 --- loss: 1.430653, loss_ss: 0.864505, loss_d: 0.566148
0.6533 --- loss: 1.678916, loss_ss: 1.161302, loss_d: 0.517613
0.6918 --- loss: 1.365027, loss_ss: 0.750122, loss_d: 0.614905
0.7302 --- loss: 1.179776, loss_ss: 0.925793, loss_d: 0.253983
0.7686 --- loss: 1.421263, loss_ss: 0.786439, loss_d: 0.634824
0.8071 --- loss: 0.970180, loss_ss: 0.728219, loss_d: 0.241961
0.8455 --- loss: 1.378321, loss_ss: 0.928590, loss_d: 0.449731
0.8839 --- loss: 1.353276, loss_ss: 0.976889, loss_d: 0.376387
0.9224 --- loss: 1.911190, loss_ss: 0.863888, loss_d: 1.047302
0.9608 --- loss: 1.390533, loss_ss: 0.764286, loss_d: 0.626247
0.9992 --- loss: 2.292992, loss_ss: 1.782921, loss_d: 0.510072
Epoch finished! Loss: 1.3282801155860608
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.272495, loss_ss: 0.789116, loss_d: 0.483379
0.0384 --- loss: 1.231190, loss_ss: 0.797709, loss_d: 0.433481
0.0769 --- loss: 1.017226, loss_ss: 0.737839, loss_d: 0.279388
0.1153 --- loss: 1.031917, loss_ss: 0.771970, loss_d: 0.259947
0.1537 --- loss: 1.032152, loss_ss: 0.826246, loss_d: 0.205906
0.1922 --- loss: 1.461350, loss_ss: 1.074587, loss_d: 0.386764
0.2306 --- loss: 1.583401, loss_ss: 1.262507, loss_d: 0.320894
0.2690 --- loss: 1.246791, loss_ss: 0.879842, loss_d: 0.366949
0.3075 --- loss: 1.260706, loss_ss: 0.798101, loss_d: 0.462605
0.3459 --- loss: 0.903153, loss_ss: 0.640790, loss_d: 0.262364
0.3843 --- loss: 1.459808, loss_ss: 0.971995, loss_d: 0.487814
0.4228 --- loss: 1.674458, loss_ss: 0.737255, loss_d: 0.937203
0.4612 --- loss: 1.133464, loss_ss: 0.729525, loss_d: 0.403938
0.4996 --- loss: 1.101779, loss_ss: 0.808206, loss_d: 0.293572
0.5380 --- loss: 1.026531, loss_ss: 0.825821, loss_d: 0.200710
0.5765 --- loss: 0.859871, loss_ss: 0.625087, loss_d: 0.234785
0.6149 --- loss: 1.710912, loss_ss: 1.466840, loss_d: 0.244072
0.6533 --- loss: 0.948150, loss_ss: 0.752243, loss_d: 0.195908
0.6918 --- loss: 1.251613, loss_ss: 0.802370, loss_d: 0.449243
0.7302 --- loss: 0.858863, loss_ss: 0.650695, loss_d: 0.208168
0.7686 --- loss: 1.321717, loss_ss: 0.806539, loss_d: 0.515178
0.8071 --- loss: 1.032556, loss_ss: 0.882771, loss_d: 0.149785
0.8455 --- loss: 1.104773, loss_ss: 0.893418, loss_d: 0.211354
0.8839 --- loss: 1.124802, loss_ss: 0.760532, loss_d: 0.364270
0.9224 --- loss: 1.753422, loss_ss: 1.474909, loss_d: 0.278514
0.9608 --- loss: 1.378405, loss_ss: 0.728770, loss_d: 0.649635
0.9992 --- loss: 2.331345, loss_ss: 1.813030, loss_d: 0.518315
Epoch finished! Loss: 1.261994504240843
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.022976, loss_ss: 0.776857, loss_d: 0.246119
0.0384 --- loss: 0.912741, loss_ss: 0.706475, loss_d: 0.206266
0.0769 --- loss: 1.047400, loss_ss: 0.820817, loss_d: 0.226583
0.1153 --- loss: 1.396726, loss_ss: 0.933190, loss_d: 0.463536
0.1537 --- loss: 1.118555, loss_ss: 0.567585, loss_d: 0.550970
0.1922 --- loss: 1.019799, loss_ss: 0.751048, loss_d: 0.268751
0.2306 --- loss: 1.039418, loss_ss: 0.772513, loss_d: 0.266905
0.2690 --- loss: 1.687097, loss_ss: 0.823218, loss_d: 0.863879
0.3075 --- loss: 1.338402, loss_ss: 1.041315, loss_d: 0.297087
0.3459 --- loss: 1.344024, loss_ss: 0.831888, loss_d: 0.512135
0.3843 --- loss: 1.742368, loss_ss: 1.174615, loss_d: 0.567754
0.4228 --- loss: 0.875275, loss_ss: 0.652696, loss_d: 0.222578
0.4612 --- loss: 0.820759, loss_ss: 0.586029, loss_d: 0.234729
0.4996 --- loss: 1.391227, loss_ss: 0.688934, loss_d: 0.702293
0.5380 --- loss: 1.365538, loss_ss: 1.142628, loss_d: 0.222909
0.5765 --- loss: 1.320557, loss_ss: 1.025711, loss_d: 0.294846
0.6149 --- loss: 1.639664, loss_ss: 0.911375, loss_d: 0.728288
0.6533 --- loss: 1.032988, loss_ss: 0.499283, loss_d: 0.533705
0.6918 --- loss: 1.534935, loss_ss: 0.631183, loss_d: 0.903752
0.7302 --- loss: 1.083412, loss_ss: 0.723035, loss_d: 0.360376
0.7686 --- loss: 1.285428, loss_ss: 0.769657, loss_d: 0.515771
0.8071 --- loss: 1.105989, loss_ss: 0.791723, loss_d: 0.314266
0.8455 --- loss: 1.157792, loss_ss: 0.835449, loss_d: 0.322344
0.8839 --- loss: 0.958303, loss_ss: 0.702249, loss_d: 0.256055
0.9224 --- loss: 1.017606, loss_ss: 0.831557, loss_d: 0.186049
0.9608 --- loss: 1.067968, loss_ss: 0.903708, loss_d: 0.164260
0.9992 --- loss: 1.370979, loss_ss: 1.142040, loss_d: 0.228940
Epoch finished! Loss: 1.217087359382556
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.417475, loss_ss: 0.926895, loss_d: 0.490580
0.0384 --- loss: 1.128719, loss_ss: 0.748922, loss_d: 0.379797
0.0769 --- loss: 1.103263, loss_ss: 0.919218, loss_d: 0.184045
0.1153 --- loss: 1.406812, loss_ss: 0.821017, loss_d: 0.585795
0.1537 --- loss: 1.220958, loss_ss: 0.937342, loss_d: 0.283615
0.1922 --- loss: 0.999535, loss_ss: 0.739587, loss_d: 0.259948
0.2306 --- loss: 1.297279, loss_ss: 0.830959, loss_d: 0.466321
0.2690 --- loss: 0.945382, loss_ss: 0.782083, loss_d: 0.163298
0.3075 --- loss: 0.986053, loss_ss: 0.752017, loss_d: 0.234037
0.3459 --- loss: 0.941517, loss_ss: 0.620966, loss_d: 0.320551
0.3843 --- loss: 0.952520, loss_ss: 0.741897, loss_d: 0.210623
0.4228 --- loss: 1.386883, loss_ss: 1.222215, loss_d: 0.164668
0.4612 --- loss: 1.602158, loss_ss: 1.037251, loss_d: 0.564906
0.4996 --- loss: 0.971410, loss_ss: 0.816443, loss_d: 0.154967
0.5380 --- loss: 1.050728, loss_ss: 0.503467, loss_d: 0.547261
0.5765 --- loss: 1.682066, loss_ss: 0.798250, loss_d: 0.883816
0.6149 --- loss: 1.239933, loss_ss: 0.834654, loss_d: 0.405278
0.6533 --- loss: 1.254668, loss_ss: 0.878132, loss_d: 0.376536
0.6918 --- loss: 1.018374, loss_ss: 0.787307, loss_d: 0.231067
0.7302 --- loss: 1.372071, loss_ss: 0.909349, loss_d: 0.462721
0.7686 --- loss: 1.340960, loss_ss: 1.192926, loss_d: 0.148034
0.8071 --- loss: 1.181194, loss_ss: 0.963187, loss_d: 0.218007
0.8455 --- loss: 1.136289, loss_ss: 0.800471, loss_d: 0.335818
0.8839 --- loss: 0.912909, loss_ss: 0.709416, loss_d: 0.203493
0.9224 --- loss: 0.891535, loss_ss: 0.616914, loss_d: 0.274621
0.9608 --- loss: 1.056157, loss_ss: 0.826679, loss_d: 0.229478
0.9992 --- loss: 1.625862, loss_ss: 1.118992, loss_d: 0.506870
Epoch finished! Loss: 1.1816460501689177
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.45092592592592595
             precision    recall  f1-score   support

        0.0       0.21      0.87      0.34       108
        1.0       0.36      0.11      0.17       387
        2.0       0.69      0.48      0.56       360
        3.0       0.64      0.94      0.76        95
        4.0       0.67      0.69      0.68       130

avg / total       0.52      0.45      0.43      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  66.76  87.04   64.51  21.41     34.37
1  61.02  10.85   89.03  35.59     16.63
2  75.46  47.78   89.31  69.08     56.49
3  94.72  93.68   94.82  63.57     75.74
4  92.22  69.23   95.37  67.16     68.18
Total accuracy: 45.09%
Average sen: 61.72%
Average spec: 86.61%
Macro f1-score: 50.28%
[0.90265864 0.99310666 0.99455726 0.97764367 0.99351257 0.9914028
 0.96183705 0.98666871 0.99169487 0.98873293 0.99424148 0.98294133
 0.98909622 0.94002128 0.83351094 0.84332305 0.99019146 0.99369448
 0.97714818 0.98548108 0.95469207 0.99001044 0.99271411 0.99095297
 0.99258876 0.96353298 0.47558501 0.99054539 0.98098236 0.98550469
 0.98522204 0.95939606 0.9586755  0.95680249 0.99261308 0.97552401]
pred: 0.9571335174971156, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.376153, loss_ss: 1.650229, loss_d: 0.725924
0.0384 --- loss: 2.142125, loss_ss: 1.584861, loss_d: 0.557265
0.0769 --- loss: 1.933845, loss_ss: 1.420213, loss_d: 0.513632
0.1153 --- loss: 2.338052, loss_ss: 1.402294, loss_d: 0.935758
0.1537 --- loss: 2.147763, loss_ss: 1.472334, loss_d: 0.675429
0.1922 --- loss: 2.249290, loss_ss: 1.278943, loss_d: 0.970347
0.2306 --- loss: 2.142738, loss_ss: 1.403071, loss_d: 0.739667
0.2690 --- loss: 1.945222, loss_ss: 1.528804, loss_d: 0.416418
0.3075 --- loss: 2.121865, loss_ss: 1.388997, loss_d: 0.732868
0.3459 --- loss: 2.074177, loss_ss: 1.209369, loss_d: 0.864808
0.3843 --- loss: 1.943473, loss_ss: 1.293301, loss_d: 0.650172
0.4228 --- loss: 1.809388, loss_ss: 1.413497, loss_d: 0.395891
0.4612 --- loss: 1.707195, loss_ss: 1.316810, loss_d: 0.390385
0.4996 --- loss: 1.880829, loss_ss: 1.253263, loss_d: 0.627566
0.5380 --- loss: 1.998110, loss_ss: 1.386459, loss_d: 0.611651
0.5765 --- loss: 2.129534, loss_ss: 1.447929, loss_d: 0.681605
0.6149 --- loss: 1.595386, loss_ss: 1.152663, loss_d: 0.442723
0.6533 --- loss: 1.870715, loss_ss: 1.290185, loss_d: 0.580530
0.6918 --- loss: 2.011444, loss_ss: 1.268761, loss_d: 0.742682
0.7302 --- loss: 2.139711, loss_ss: 1.331869, loss_d: 0.807842
0.7686 --- loss: 1.715202, loss_ss: 1.182523, loss_d: 0.532679
0.8071 --- loss: 1.824649, loss_ss: 1.187874, loss_d: 0.636775
0.8455 --- loss: 2.111337, loss_ss: 1.207577, loss_d: 0.903759
0.8839 --- loss: 1.838629, loss_ss: 1.297470, loss_d: 0.541159
0.9224 --- loss: 1.638680, loss_ss: 1.158379, loss_d: 0.480301
0.9608 --- loss: 1.751642, loss_ss: 1.183412, loss_d: 0.568231
0.9992 --- loss: 1.931140, loss_ss: 1.507790, loss_d: 0.423350
Epoch finished! Loss: 1.9387204229831696
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.712640, loss_ss: 1.089813, loss_d: 0.622827
0.0384 --- loss: 1.666759, loss_ss: 1.217500, loss_d: 0.449260
0.0769 --- loss: 1.842567, loss_ss: 1.274553, loss_d: 0.568014
0.1153 --- loss: 1.545019, loss_ss: 1.125527, loss_d: 0.419492
0.1537 --- loss: 1.581887, loss_ss: 1.056080, loss_d: 0.525807
0.1922 --- loss: 1.710334, loss_ss: 1.144776, loss_d: 0.565557
0.2306 --- loss: 1.948815, loss_ss: 1.451989, loss_d: 0.496826
0.2690 --- loss: 1.786688, loss_ss: 1.094067, loss_d: 0.692621
0.3075 --- loss: 2.004242, loss_ss: 1.371758, loss_d: 0.632484
0.3459 --- loss: 1.885257, loss_ss: 1.103584, loss_d: 0.781673
0.3843 --- loss: 1.699865, loss_ss: 1.191681, loss_d: 0.508184
0.4228 --- loss: 1.780324, loss_ss: 1.134559, loss_d: 0.645764
0.4612 --- loss: 1.736918, loss_ss: 1.202813, loss_d: 0.534105
0.4996 --- loss: 1.860605, loss_ss: 1.332364, loss_d: 0.528241
0.5380 --- loss: 1.723088, loss_ss: 1.077858, loss_d: 0.645230
0.5765 --- loss: 1.527997, loss_ss: 0.982007, loss_d: 0.545991
0.6149 --- loss: 1.756864, loss_ss: 1.094870, loss_d: 0.661994
0.6533 --- loss: 1.922714, loss_ss: 1.397755, loss_d: 0.524959
0.6918 --- loss: 1.863738, loss_ss: 1.188689, loss_d: 0.675049
0.7302 --- loss: 1.580766, loss_ss: 0.982194, loss_d: 0.598572
0.7686 --- loss: 1.497630, loss_ss: 1.033273, loss_d: 0.464357
0.8071 --- loss: 1.689240, loss_ss: 1.038187, loss_d: 0.651053
0.8455 --- loss: 1.652279, loss_ss: 1.044860, loss_d: 0.607419
0.8839 --- loss: 1.530110, loss_ss: 0.975689, loss_d: 0.554421
0.9224 --- loss: 1.763505, loss_ss: 1.143104, loss_d: 0.620401
0.9608 --- loss: 1.993114, loss_ss: 1.476418, loss_d: 0.516696
0.9992 --- loss: 2.871804, loss_ss: 1.650669, loss_d: 1.221135
Epoch finished! Loss: 1.7506695009194888
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.811155, loss_ss: 1.207746, loss_d: 0.603409
0.0384 --- loss: 1.726464, loss_ss: 1.207126, loss_d: 0.519338
0.0769 --- loss: 1.829266, loss_ss: 1.164269, loss_d: 0.664997
0.1153 --- loss: 1.600515, loss_ss: 0.922360, loss_d: 0.678155
0.1537 --- loss: 1.694080, loss_ss: 1.132069, loss_d: 0.562011
0.1922 --- loss: 1.487542, loss_ss: 0.881650, loss_d: 0.605892
0.2306 --- loss: 1.706421, loss_ss: 0.890325, loss_d: 0.816096
0.2690 --- loss: 1.530761, loss_ss: 1.144810, loss_d: 0.385952
0.3075 --- loss: 1.350437, loss_ss: 0.938296, loss_d: 0.412141
0.3459 --- loss: 1.908304, loss_ss: 1.199454, loss_d: 0.708851
0.3843 --- loss: 1.830035, loss_ss: 1.301161, loss_d: 0.528874
0.4228 --- loss: 1.770875, loss_ss: 1.175736, loss_d: 0.595139
0.4612 --- loss: 1.833997, loss_ss: 1.209563, loss_d: 0.624435
0.4996 --- loss: 1.369595, loss_ss: 1.130411, loss_d: 0.239184
0.5380 --- loss: 1.643439, loss_ss: 0.988533, loss_d: 0.654906
0.5765 --- loss: 1.829496, loss_ss: 0.936791, loss_d: 0.892705
0.6149 --- loss: 1.785183, loss_ss: 0.976332, loss_d: 0.808851
0.6533 --- loss: 1.863023, loss_ss: 1.014322, loss_d: 0.848701
0.6918 --- loss: 1.541035, loss_ss: 0.846992, loss_d: 0.694043
0.7302 --- loss: 1.673939, loss_ss: 1.191820, loss_d: 0.482119
0.7686 --- loss: 1.717818, loss_ss: 0.978285, loss_d: 0.739533
0.8071 --- loss: 1.538534, loss_ss: 0.809406, loss_d: 0.729129
0.8455 --- loss: 1.281253, loss_ss: 0.935890, loss_d: 0.345363
0.8839 --- loss: 1.635442, loss_ss: 1.035807, loss_d: 0.599635
0.9224 --- loss: 1.670048, loss_ss: 1.107913, loss_d: 0.562135
0.9608 --- loss: 1.779544, loss_ss: 1.342342, loss_d: 0.437203
0.9992 --- loss: 1.827765, loss_ss: 1.266932, loss_d: 0.560832
Epoch finished! Loss: 1.6478071199013637
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.415494, loss_ss: 1.008723, loss_d: 0.406772
0.0384 --- loss: 1.637456, loss_ss: 0.905366, loss_d: 0.732090
0.0769 --- loss: 1.515703, loss_ss: 1.059466, loss_d: 0.456237
0.1153 --- loss: 1.745108, loss_ss: 1.256693, loss_d: 0.488415
0.1537 --- loss: 1.474934, loss_ss: 0.956085, loss_d: 0.518849
0.1922 --- loss: 1.630683, loss_ss: 1.075594, loss_d: 0.555089
0.2306 --- loss: 1.272495, loss_ss: 0.874702, loss_d: 0.397793
0.2690 --- loss: 1.418066, loss_ss: 0.875733, loss_d: 0.542333
0.3075 --- loss: 1.389785, loss_ss: 0.979094, loss_d: 0.410692
0.3459 --- loss: 1.832487, loss_ss: 1.358978, loss_d: 0.473509
0.3843 --- loss: 1.624998, loss_ss: 0.945354, loss_d: 0.679644
0.4228 --- loss: 1.804934, loss_ss: 1.078065, loss_d: 0.726869
0.4612 --- loss: 1.503971, loss_ss: 0.987152, loss_d: 0.516819
0.4996 --- loss: 1.665218, loss_ss: 0.951084, loss_d: 0.714134
0.5380 --- loss: 1.555592, loss_ss: 1.022099, loss_d: 0.533493
0.5765 --- loss: 1.801545, loss_ss: 1.246400, loss_d: 0.555145
0.6149 --- loss: 1.390332, loss_ss: 0.938328, loss_d: 0.452004
0.6533 --- loss: 1.674835, loss_ss: 1.004699, loss_d: 0.670137
0.6918 --- loss: 1.457221, loss_ss: 0.879785, loss_d: 0.577436
0.7302 --- loss: 1.366912, loss_ss: 0.808279, loss_d: 0.558633
0.7686 --- loss: 1.469698, loss_ss: 0.732286, loss_d: 0.737412
0.8071 --- loss: 1.828977, loss_ss: 1.337121, loss_d: 0.491856
0.8455 --- loss: 1.502139, loss_ss: 1.089589, loss_d: 0.412550
0.8839 --- loss: 1.788090, loss_ss: 1.004605, loss_d: 0.783485
0.9224 --- loss: 1.697706, loss_ss: 1.298385, loss_d: 0.399321
0.9608 --- loss: 1.927412, loss_ss: 1.396002, loss_d: 0.531410
0.9992 --- loss: 1.358299, loss_ss: 1.147182, loss_d: 0.211117
Epoch finished! Loss: 1.5687950730323792
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.475368, loss_ss: 0.989250, loss_d: 0.486118
0.0384 --- loss: 1.585449, loss_ss: 1.001866, loss_d: 0.583583
0.0769 --- loss: 1.180582, loss_ss: 0.906434, loss_d: 0.274148
0.1153 --- loss: 1.188839, loss_ss: 0.931920, loss_d: 0.256920
0.1537 --- loss: 1.385225, loss_ss: 0.910652, loss_d: 0.474573
0.1922 --- loss: 1.530117, loss_ss: 1.044666, loss_d: 0.485451
0.2306 --- loss: 1.259961, loss_ss: 0.939156, loss_d: 0.320804
0.2690 --- loss: 1.510388, loss_ss: 0.844123, loss_d: 0.666264
0.3075 --- loss: 1.417302, loss_ss: 1.097110, loss_d: 0.320192
0.3459 --- loss: 1.017207, loss_ss: 0.821894, loss_d: 0.195313
0.3843 --- loss: 1.362885, loss_ss: 1.121493, loss_d: 0.241392
0.4228 --- loss: 1.240170, loss_ss: 0.985746, loss_d: 0.254424
0.4612 --- loss: 1.479085, loss_ss: 0.817521, loss_d: 0.661563
0.4996 --- loss: 1.465468, loss_ss: 0.951639, loss_d: 0.513829
0.5380 --- loss: 1.358437, loss_ss: 0.785402, loss_d: 0.573035
0.5765 --- loss: 1.409552, loss_ss: 1.104843, loss_d: 0.304709
0.6149 --- loss: 1.079323, loss_ss: 0.885895, loss_d: 0.193427
0.6533 --- loss: 0.960698, loss_ss: 0.771230, loss_d: 0.189468
0.6918 --- loss: 1.367008, loss_ss: 0.963519, loss_d: 0.403489
0.7302 --- loss: 1.717254, loss_ss: 0.666926, loss_d: 1.050329
0.7686 --- loss: 1.450877, loss_ss: 0.944397, loss_d: 0.506480
0.8071 --- loss: 1.584258, loss_ss: 0.842132, loss_d: 0.742126
0.8455 --- loss: 1.439327, loss_ss: 1.068091, loss_d: 0.371236
0.8839 --- loss: 1.466092, loss_ss: 0.887576, loss_d: 0.578516
0.9224 --- loss: 1.740742, loss_ss: 1.032978, loss_d: 0.707764
0.9608 --- loss: 1.452277, loss_ss: 0.849441, loss_d: 0.602836
0.9992 --- loss: 1.661097, loss_ss: 1.162519, loss_d: 0.498578
Epoch finished! Loss: 1.4487920990357033
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.343586, loss_ss: 1.059777, loss_d: 0.283809
0.0384 --- loss: 1.479240, loss_ss: 0.837386, loss_d: 0.641854
0.0769 --- loss: 1.095530, loss_ss: 0.894025, loss_d: 0.201505
0.1153 --- loss: 1.590676, loss_ss: 1.010244, loss_d: 0.580431
0.1537 --- loss: 1.409157, loss_ss: 0.963086, loss_d: 0.446071
0.1922 --- loss: 1.237934, loss_ss: 0.852900, loss_d: 0.385034
0.2306 --- loss: 2.137280, loss_ss: 0.990741, loss_d: 1.146539
0.2690 --- loss: 1.400308, loss_ss: 0.946139, loss_d: 0.454169
0.3075 --- loss: 1.318279, loss_ss: 0.988538, loss_d: 0.329741
0.3459 --- loss: 1.280882, loss_ss: 0.827018, loss_d: 0.453864
0.3843 --- loss: 1.333200, loss_ss: 0.937729, loss_d: 0.395471
0.4228 --- loss: 1.355907, loss_ss: 1.054382, loss_d: 0.301524
0.4612 --- loss: 1.635261, loss_ss: 0.960147, loss_d: 0.675114
0.4996 --- loss: 1.226054, loss_ss: 0.884038, loss_d: 0.342016
0.5380 --- loss: 1.260861, loss_ss: 0.847779, loss_d: 0.413082
0.5765 --- loss: 1.379542, loss_ss: 1.053079, loss_d: 0.326463
0.6149 --- loss: 1.119200, loss_ss: 0.734157, loss_d: 0.385043
0.6533 --- loss: 1.720146, loss_ss: 1.103142, loss_d: 0.617004
0.6918 --- loss: 1.331337, loss_ss: 0.731109, loss_d: 0.600229
0.7302 --- loss: 1.266641, loss_ss: 0.983063, loss_d: 0.283578
0.7686 --- loss: 1.470497, loss_ss: 0.852984, loss_d: 0.617513
0.8071 --- loss: 1.633592, loss_ss: 1.302258, loss_d: 0.331334
0.8455 --- loss: 1.407973, loss_ss: 0.929739, loss_d: 0.478235
0.8839 --- loss: 1.629416, loss_ss: 1.116118, loss_d: 0.513299
0.9224 --- loss: 1.462225, loss_ss: 0.909634, loss_d: 0.552591
0.9608 --- loss: 1.267850, loss_ss: 0.987455, loss_d: 0.280395
0.9992 --- loss: 2.079014, loss_ss: 1.873417, loss_d: 0.205597
Epoch finished! Loss: 1.3955531365596332
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.103081, loss_ss: 0.850628, loss_d: 0.252453
0.0384 --- loss: 1.208773, loss_ss: 0.834669, loss_d: 0.374104
0.0769 --- loss: 1.673870, loss_ss: 1.232072, loss_d: 0.441797
0.1153 --- loss: 0.887836, loss_ss: 0.637834, loss_d: 0.250002
0.1537 --- loss: 1.312572, loss_ss: 0.867243, loss_d: 0.445329
0.1922 --- loss: 1.249816, loss_ss: 0.923562, loss_d: 0.326253
0.2306 --- loss: 2.005070, loss_ss: 1.136931, loss_d: 0.868139
0.2690 --- loss: 1.224047, loss_ss: 0.803218, loss_d: 0.420829
0.3075 --- loss: 1.123719, loss_ss: 0.928623, loss_d: 0.195095
0.3459 --- loss: 1.425350, loss_ss: 0.794069, loss_d: 0.631282
0.3843 --- loss: 1.713348, loss_ss: 1.187286, loss_d: 0.526062
0.4228 --- loss: 1.103118, loss_ss: 0.718665, loss_d: 0.384453
0.4612 --- loss: 1.029727, loss_ss: 0.845714, loss_d: 0.184013
0.4996 --- loss: 1.103917, loss_ss: 0.884385, loss_d: 0.219532
0.5380 --- loss: 0.991518, loss_ss: 0.798072, loss_d: 0.193446
0.5765 --- loss: 1.413170, loss_ss: 1.031524, loss_d: 0.381646
0.6149 --- loss: 0.967905, loss_ss: 0.767438, loss_d: 0.200467
0.6533 --- loss: 1.313991, loss_ss: 0.737424, loss_d: 0.576567
0.6918 --- loss: 1.397052, loss_ss: 0.923618, loss_d: 0.473435
0.7302 --- loss: 1.233320, loss_ss: 0.969577, loss_d: 0.263742
0.7686 --- loss: 1.176317, loss_ss: 0.798271, loss_d: 0.378046
0.8071 --- loss: 1.246514, loss_ss: 0.766641, loss_d: 0.479873
0.8455 --- loss: 1.427414, loss_ss: 0.733382, loss_d: 0.694031
0.8839 --- loss: 1.674435, loss_ss: 1.010898, loss_d: 0.663537
0.9224 --- loss: 1.068707, loss_ss: 0.634360, loss_d: 0.434346
0.9608 --- loss: 1.332756, loss_ss: 1.077443, loss_d: 0.255313
0.9992 --- loss: 1.571619, loss_ss: 1.371797, loss_d: 0.199822
Epoch finished! Loss: 1.3437028229236603
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.336615, loss_ss: 1.119694, loss_d: 0.216922
0.0384 --- loss: 1.397010, loss_ss: 0.914743, loss_d: 0.482267
0.0769 --- loss: 1.524984, loss_ss: 0.877022, loss_d: 0.647962
0.1153 --- loss: 1.101755, loss_ss: 0.661792, loss_d: 0.439963
0.1537 --- loss: 1.144435, loss_ss: 0.682813, loss_d: 0.461623
0.1922 --- loss: 1.645041, loss_ss: 0.700513, loss_d: 0.944528
0.2306 --- loss: 1.910833, loss_ss: 1.078668, loss_d: 0.832165
0.2690 --- loss: 1.071789, loss_ss: 0.764032, loss_d: 0.307757
0.3075 --- loss: 1.507349, loss_ss: 0.727565, loss_d: 0.779785
0.3459 --- loss: 1.065453, loss_ss: 0.870217, loss_d: 0.195236
0.3843 --- loss: 1.117100, loss_ss: 0.842720, loss_d: 0.274380
0.4228 --- loss: 1.355165, loss_ss: 0.814189, loss_d: 0.540976
0.4612 --- loss: 1.302047, loss_ss: 0.841794, loss_d: 0.460253
0.4996 --- loss: 1.185345, loss_ss: 0.907324, loss_d: 0.278021
0.5380 --- loss: 1.451897, loss_ss: 1.047366, loss_d: 0.404531
0.5765 --- loss: 1.103565, loss_ss: 0.853662, loss_d: 0.249904
0.6149 --- loss: 1.354093, loss_ss: 1.021771, loss_d: 0.332322
0.6533 --- loss: 1.039116, loss_ss: 0.708471, loss_d: 0.330645
0.6918 --- loss: 1.213850, loss_ss: 0.702459, loss_d: 0.511391
0.7302 --- loss: 1.121464, loss_ss: 0.812394, loss_d: 0.309071
0.7686 --- loss: 0.905217, loss_ss: 0.766669, loss_d: 0.138548
0.8071 --- loss: 1.025280, loss_ss: 0.712750, loss_d: 0.312531
0.8455 --- loss: 1.361022, loss_ss: 1.081170, loss_d: 0.279853
0.8839 --- loss: 1.200569, loss_ss: 0.957007, loss_d: 0.243562
0.9224 --- loss: 1.831225, loss_ss: 1.061159, loss_d: 0.770066
0.9608 --- loss: 1.269704, loss_ss: 0.630870, loss_d: 0.638834
0.9992 --- loss: 2.288009, loss_ss: 1.523560, loss_d: 0.764449
Epoch finished! Loss: 1.2805831232896219
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.351077, loss_ss: 0.902500, loss_d: 0.448577
0.0384 --- loss: 1.718405, loss_ss: 0.844783, loss_d: 0.873622
0.0769 --- loss: 1.209213, loss_ss: 0.847717, loss_d: 0.361496
0.1153 --- loss: 1.470760, loss_ss: 0.883780, loss_d: 0.586980
0.1537 --- loss: 1.563752, loss_ss: 1.095417, loss_d: 0.468335
0.1922 --- loss: 1.102915, loss_ss: 0.732197, loss_d: 0.370717
0.2306 --- loss: 1.691886, loss_ss: 0.972231, loss_d: 0.719655
0.2690 --- loss: 1.693288, loss_ss: 0.961666, loss_d: 0.731622
0.3075 --- loss: 0.934181, loss_ss: 0.557912, loss_d: 0.376269
0.3459 --- loss: 1.731218, loss_ss: 1.111214, loss_d: 0.620003
0.3843 --- loss: 1.463179, loss_ss: 0.931028, loss_d: 0.532151
0.4228 --- loss: 1.289471, loss_ss: 1.059177, loss_d: 0.230294
0.4612 --- loss: 1.118429, loss_ss: 0.733187, loss_d: 0.385242
0.4996 --- loss: 1.316651, loss_ss: 0.727865, loss_d: 0.588786
0.5380 --- loss: 1.355239, loss_ss: 0.935554, loss_d: 0.419685
0.5765 --- loss: 0.807919, loss_ss: 0.663907, loss_d: 0.144012
0.6149 --- loss: 1.223753, loss_ss: 0.889799, loss_d: 0.333954
0.6533 --- loss: 1.266168, loss_ss: 0.966729, loss_d: 0.299439
0.6918 --- loss: 1.667219, loss_ss: 1.296498, loss_d: 0.370721
0.7302 --- loss: 1.282477, loss_ss: 1.010769, loss_d: 0.271708
0.7686 --- loss: 1.469045, loss_ss: 1.172743, loss_d: 0.296302
0.8071 --- loss: 1.676767, loss_ss: 0.979780, loss_d: 0.696986
0.8455 --- loss: 1.275026, loss_ss: 1.042165, loss_d: 0.232860
0.8839 --- loss: 1.167017, loss_ss: 0.741911, loss_d: 0.425106
0.9224 --- loss: 1.412098, loss_ss: 0.935645, loss_d: 0.476453
0.9608 --- loss: 1.628345, loss_ss: 1.231113, loss_d: 0.397232
0.9992 --- loss: 1.180651, loss_ss: 0.760095, loss_d: 0.420556
Epoch finished! Loss: 1.3216656904954176
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.459570, loss_ss: 0.969789, loss_d: 0.489781
0.0384 --- loss: 1.383066, loss_ss: 0.786243, loss_d: 0.596823
0.0769 --- loss: 1.286569, loss_ss: 0.936460, loss_d: 0.350108
0.1153 --- loss: 0.851051, loss_ss: 0.634046, loss_d: 0.217005
0.1537 --- loss: 1.471849, loss_ss: 1.194904, loss_d: 0.276946
0.1922 --- loss: 1.273736, loss_ss: 0.911407, loss_d: 0.362330
0.2306 --- loss: 1.421286, loss_ss: 0.663340, loss_d: 0.757945
0.2690 --- loss: 1.075439, loss_ss: 0.923852, loss_d: 0.151588
0.3075 --- loss: 0.848133, loss_ss: 0.561995, loss_d: 0.286138
0.3459 --- loss: 1.196167, loss_ss: 0.891172, loss_d: 0.304995
0.3843 --- loss: 1.255892, loss_ss: 0.837968, loss_d: 0.417925
0.4228 --- loss: 1.217038, loss_ss: 0.872768, loss_d: 0.344270
0.4612 --- loss: 1.127286, loss_ss: 0.760087, loss_d: 0.367199
0.4996 --- loss: 1.371295, loss_ss: 0.841324, loss_d: 0.529972
0.5380 --- loss: 1.417111, loss_ss: 0.682746, loss_d: 0.734365
0.5765 --- loss: 1.384850, loss_ss: 1.154388, loss_d: 0.230461
0.6149 --- loss: 1.051347, loss_ss: 0.623522, loss_d: 0.427825
0.6533 --- loss: 1.212525, loss_ss: 0.747109, loss_d: 0.465416
0.6918 --- loss: 1.258319, loss_ss: 0.971346, loss_d: 0.286973
0.7302 --- loss: 1.013844, loss_ss: 0.768690, loss_d: 0.245154
0.7686 --- loss: 1.055365, loss_ss: 0.856275, loss_d: 0.199090
0.8071 --- loss: 0.915082, loss_ss: 0.691440, loss_d: 0.223642
0.8455 --- loss: 1.073525, loss_ss: 0.805935, loss_d: 0.267590
0.8839 --- loss: 1.120302, loss_ss: 0.890840, loss_d: 0.229462
0.9224 --- loss: 0.975116, loss_ss: 0.766016, loss_d: 0.209100
0.9608 --- loss: 1.004240, loss_ss: 0.824098, loss_d: 0.180143
0.9992 --- loss: 3.107997, loss_ss: 2.595161, loss_d: 0.512836
Epoch finished! Loss: 1.1897312542566887
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6712962962962963
             precision    recall  f1-score   support

        0.0       0.26      0.93      0.41        30
        1.0       0.27      0.04      0.08       136
        2.0       0.61      0.80      0.70       404
        3.0       0.93      0.77      0.84       239
        4.0       0.82      0.67      0.74       271

avg / total       0.68      0.67      0.65      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.50  93.33   92.48  26.17     40.88
1  86.48   4.41   98.31  27.27      7.59
2  73.61  80.45   69.53  61.21     69.52
3  93.70  76.99   98.45  93.40     84.40
4  87.96  67.16   94.93  81.61     73.68
Total accuracy: 67.13%
Average sen: 64.47%
Average spec: 90.74%
Macro f1-score: 55.22%
[0.93735582 0.32658356 0.59017509 0.61016065 0.80005175 0.74262202
 0.70419705 0.59136182 0.90469629 0.79055357 0.99499989 0.80711275
 0.7302233  0.82808918 0.96598321 0.88828081 0.34839529 0.9408583
 0.96870112 0.98489827 0.95557916 0.98688811 0.86331755 0.98681927
 0.81639093 0.99451941 0.99395281 0.97551209 0.99292618 0.68738139
 0.84976524 0.19199228 0.89967573 0.96356612 0.87285346 0.96636528]
pred: 0.8181334651178784, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.405771, loss_ss: 1.727357, loss_d: 0.678414
0.0384 --- loss: 2.245486, loss_ss: 1.611146, loss_d: 0.634340
0.0768 --- loss: 2.146867, loss_ss: 1.502046, loss_d: 0.644821
0.1152 --- loss: 1.914689, loss_ss: 1.497077, loss_d: 0.417611
0.1536 --- loss: 2.124929, loss_ss: 1.458513, loss_d: 0.666415
0.1919 --- loss: 2.059138, loss_ss: 1.429466, loss_d: 0.629672
0.2303 --- loss: 1.928339, loss_ss: 1.436125, loss_d: 0.492214
0.2687 --- loss: 1.949153, loss_ss: 1.292557, loss_d: 0.656596
0.3071 --- loss: 2.010893, loss_ss: 1.422868, loss_d: 0.588025
0.3455 --- loss: 2.194208, loss_ss: 1.428869, loss_d: 0.765338
0.3839 --- loss: 1.855042, loss_ss: 1.331919, loss_d: 0.523124
0.4223 --- loss: 1.960804, loss_ss: 1.371085, loss_d: 0.589719
0.4607 --- loss: 1.871881, loss_ss: 1.243028, loss_d: 0.628853
0.4990 --- loss: 1.992899, loss_ss: 1.317522, loss_d: 0.675377
0.5374 --- loss: 1.670556, loss_ss: 1.254903, loss_d: 0.415652
0.5758 --- loss: 1.764771, loss_ss: 1.304976, loss_d: 0.459795
0.6142 --- loss: 2.290541, loss_ss: 1.352148, loss_d: 0.938393
0.6526 --- loss: 1.848560, loss_ss: 1.210224, loss_d: 0.638336
0.6910 --- loss: 1.843681, loss_ss: 1.306156, loss_d: 0.537525
0.7294 --- loss: 1.634885, loss_ss: 1.142061, loss_d: 0.492824
0.7678 --- loss: 2.026949, loss_ss: 1.416635, loss_d: 0.610314
0.8061 --- loss: 2.024112, loss_ss: 1.311667, loss_d: 0.712445
0.8445 --- loss: 2.012362, loss_ss: 1.072465, loss_d: 0.939897
0.8829 --- loss: 1.694396, loss_ss: 1.209719, loss_d: 0.484677
0.9213 --- loss: 1.509561, loss_ss: 1.164870, loss_d: 0.344691
0.9597 --- loss: 2.050694, loss_ss: 1.323502, loss_d: 0.727192
0.9981 --- loss: 1.495178, loss_ss: 1.173206, loss_d: 0.321972
Epoch finished! Loss: 1.9565865567097298
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.686295, loss_ss: 1.159269, loss_d: 0.527026
0.0384 --- loss: 1.582697, loss_ss: 1.179232, loss_d: 0.403465
0.0768 --- loss: 2.124114, loss_ss: 1.309129, loss_d: 0.814985
0.1152 --- loss: 1.494187, loss_ss: 1.056809, loss_d: 0.437378
0.1536 --- loss: 1.800237, loss_ss: 1.221206, loss_d: 0.579031
0.1919 --- loss: 1.594441, loss_ss: 1.151588, loss_d: 0.442853
0.2303 --- loss: 1.790283, loss_ss: 1.101521, loss_d: 0.688763
0.2687 --- loss: 1.803238, loss_ss: 1.058422, loss_d: 0.744816
0.3071 --- loss: 1.528120, loss_ss: 0.972042, loss_d: 0.556078
0.3455 --- loss: 1.517516, loss_ss: 1.024179, loss_d: 0.493337
0.3839 --- loss: 2.005176, loss_ss: 1.421838, loss_d: 0.583338
0.4223 --- loss: 1.841811, loss_ss: 1.114275, loss_d: 0.727536
0.4607 --- loss: 1.597949, loss_ss: 1.184419, loss_d: 0.413530
0.4990 --- loss: 1.482895, loss_ss: 0.955074, loss_d: 0.527821
0.5374 --- loss: 1.641884, loss_ss: 1.008983, loss_d: 0.632900
0.5758 --- loss: 1.601736, loss_ss: 1.053067, loss_d: 0.548669
0.6142 --- loss: 2.090054, loss_ss: 1.212437, loss_d: 0.877617
0.6526 --- loss: 1.242028, loss_ss: 0.909702, loss_d: 0.332326
0.6910 --- loss: 1.768712, loss_ss: 0.987792, loss_d: 0.780920
0.7294 --- loss: 1.725277, loss_ss: 1.029708, loss_d: 0.695569
0.7678 --- loss: 1.786158, loss_ss: 0.903175, loss_d: 0.882983
0.8061 --- loss: 1.405627, loss_ss: 0.845073, loss_d: 0.560555
0.8445 --- loss: 1.722322, loss_ss: 0.971154, loss_d: 0.751168
0.8829 --- loss: 1.868004, loss_ss: 1.334279, loss_d: 0.533724
0.9213 --- loss: 1.695226, loss_ss: 0.971548, loss_d: 0.723678
0.9597 --- loss: 1.639179, loss_ss: 1.127408, loss_d: 0.511771
0.9981 --- loss: 1.814222, loss_ss: 1.289669, loss_d: 0.524553
Epoch finished! Loss: 1.6868974474760203
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.588232, loss_ss: 0.980748, loss_d: 0.607484
0.0384 --- loss: 1.454530, loss_ss: 0.899142, loss_d: 0.555388
0.0768 --- loss: 1.448652, loss_ss: 0.913017, loss_d: 0.535635
0.1152 --- loss: 1.316642, loss_ss: 0.916010, loss_d: 0.400632
0.1536 --- loss: 1.408279, loss_ss: 0.862373, loss_d: 0.545906
0.1919 --- loss: 1.300943, loss_ss: 0.761557, loss_d: 0.539386
0.2303 --- loss: 1.501697, loss_ss: 1.069771, loss_d: 0.431926
0.2687 --- loss: 1.558207, loss_ss: 1.242924, loss_d: 0.315283
0.3071 --- loss: 1.551189, loss_ss: 1.053019, loss_d: 0.498170
0.3455 --- loss: 1.332463, loss_ss: 0.922754, loss_d: 0.409708
0.3839 --- loss: 1.276850, loss_ss: 0.803548, loss_d: 0.473302
0.4223 --- loss: 1.535065, loss_ss: 0.999710, loss_d: 0.535355
0.4607 --- loss: 1.597544, loss_ss: 0.968199, loss_d: 0.629345
0.4990 --- loss: 1.282330, loss_ss: 0.916024, loss_d: 0.366306
0.5374 --- loss: 1.297963, loss_ss: 0.790158, loss_d: 0.507805
0.5758 --- loss: 1.437776, loss_ss: 1.122043, loss_d: 0.315733
0.6142 --- loss: 2.097291, loss_ss: 1.014359, loss_d: 1.082932
0.6526 --- loss: 1.427220, loss_ss: 0.977833, loss_d: 0.449388
0.6910 --- loss: 1.569076, loss_ss: 1.029577, loss_d: 0.539499
0.7294 --- loss: 1.440263, loss_ss: 0.939110, loss_d: 0.501153
0.7678 --- loss: 1.734527, loss_ss: 1.153397, loss_d: 0.581130
0.8061 --- loss: 2.505808, loss_ss: 1.321139, loss_d: 1.184669
0.8445 --- loss: 1.802071, loss_ss: 0.973841, loss_d: 0.828230
0.8829 --- loss: 1.394403, loss_ss: 1.040807, loss_d: 0.353596
0.9213 --- loss: 1.909274, loss_ss: 1.327329, loss_d: 0.581945
0.9597 --- loss: 1.802834, loss_ss: 1.358410, loss_d: 0.444424
0.9981 --- loss: 1.864321, loss_ss: 1.167933, loss_d: 0.696387
Epoch finished! Loss: 1.5768083856656
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.692843, loss_ss: 1.206227, loss_d: 0.486616
0.0384 --- loss: 1.765385, loss_ss: 1.092547, loss_d: 0.672838
0.0768 --- loss: 1.480399, loss_ss: 1.044240, loss_d: 0.436159
0.1152 --- loss: 1.629572, loss_ss: 1.197434, loss_d: 0.432139
0.1536 --- loss: 1.689318, loss_ss: 0.888087, loss_d: 0.801231
0.1919 --- loss: 1.425842, loss_ss: 1.033397, loss_d: 0.392446
0.2303 --- loss: 1.365558, loss_ss: 1.050852, loss_d: 0.314706
0.2687 --- loss: 1.423733, loss_ss: 0.795785, loss_d: 0.627948
0.3071 --- loss: 1.473879, loss_ss: 0.915245, loss_d: 0.558634
0.3455 --- loss: 1.666589, loss_ss: 0.991972, loss_d: 0.674617
0.3839 --- loss: 1.562401, loss_ss: 0.883390, loss_d: 0.679011
0.4223 --- loss: 1.256194, loss_ss: 0.869356, loss_d: 0.386839
0.4607 --- loss: 1.426595, loss_ss: 0.900986, loss_d: 0.525608
0.4990 --- loss: 1.371811, loss_ss: 0.808017, loss_d: 0.563794
0.5374 --- loss: 1.725828, loss_ss: 1.143430, loss_d: 0.582398
0.5758 --- loss: 1.310578, loss_ss: 1.015598, loss_d: 0.294980
0.6142 --- loss: 2.075650, loss_ss: 1.370536, loss_d: 0.705114
0.6526 --- loss: 1.367758, loss_ss: 0.793673, loss_d: 0.574085
0.6910 --- loss: 1.620796, loss_ss: 1.075573, loss_d: 0.545223
0.7294 --- loss: 1.905008, loss_ss: 1.108949, loss_d: 0.796059
0.7678 --- loss: 1.524986, loss_ss: 0.794647, loss_d: 0.730339
0.8061 --- loss: 1.425237, loss_ss: 0.865960, loss_d: 0.559277
0.8445 --- loss: 1.422886, loss_ss: 1.139540, loss_d: 0.283346
0.8829 --- loss: 1.682997, loss_ss: 1.291032, loss_d: 0.391965
0.9213 --- loss: 1.716567, loss_ss: 1.169133, loss_d: 0.547434
0.9597 --- loss: 1.624739, loss_ss: 0.865037, loss_d: 0.759702
0.9981 --- loss: 1.425058, loss_ss: 1.188109, loss_d: 0.236948
Epoch finished! Loss: 1.514031127324471
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.497001, loss_ss: 0.840844, loss_d: 0.656157
0.0384 --- loss: 1.443842, loss_ss: 0.947565, loss_d: 0.496277
0.0768 --- loss: 1.550617, loss_ss: 0.731686, loss_d: 0.818931
0.1152 --- loss: 1.356769, loss_ss: 1.125163, loss_d: 0.231606
0.1536 --- loss: 1.299469, loss_ss: 0.769419, loss_d: 0.530050
0.1919 --- loss: 1.316223, loss_ss: 0.886787, loss_d: 0.429436
0.2303 --- loss: 1.121389, loss_ss: 0.859678, loss_d: 0.261712
0.2687 --- loss: 1.226991, loss_ss: 0.659754, loss_d: 0.567237
0.3071 --- loss: 1.594636, loss_ss: 1.213021, loss_d: 0.381615
0.3455 --- loss: 1.885665, loss_ss: 1.205522, loss_d: 0.680143
0.3839 --- loss: 1.421538, loss_ss: 0.833806, loss_d: 0.587732
0.4223 --- loss: 1.288331, loss_ss: 0.941535, loss_d: 0.346795
0.4607 --- loss: 1.201732, loss_ss: 0.862263, loss_d: 0.339469
0.4990 --- loss: 1.349534, loss_ss: 1.060260, loss_d: 0.289274
0.5374 --- loss: 1.616206, loss_ss: 0.955387, loss_d: 0.660819
0.5758 --- loss: 1.861982, loss_ss: 1.105367, loss_d: 0.756615
0.6142 --- loss: 1.760492, loss_ss: 1.332250, loss_d: 0.428241
0.6526 --- loss: 1.679597, loss_ss: 1.272056, loss_d: 0.407541
0.6910 --- loss: 1.475802, loss_ss: 0.777389, loss_d: 0.698413
0.7294 --- loss: 1.325989, loss_ss: 0.884591, loss_d: 0.441398
0.7678 --- loss: 1.581137, loss_ss: 1.051912, loss_d: 0.529225
0.8061 --- loss: 1.292138, loss_ss: 0.766896, loss_d: 0.525243
0.8445 --- loss: 1.691644, loss_ss: 0.906333, loss_d: 0.785311
0.8829 --- loss: 1.666290, loss_ss: 1.293908, loss_d: 0.372383
0.9213 --- loss: 1.284958, loss_ss: 0.997493, loss_d: 0.287464
0.9597 --- loss: 1.595260, loss_ss: 1.261855, loss_d: 0.333405
0.9981 --- loss: 1.303633, loss_ss: 0.810798, loss_d: 0.492835
Epoch finished! Loss: 1.4117640130794966
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.265533, loss_ss: 0.902255, loss_d: 0.363278
0.0384 --- loss: 1.355883, loss_ss: 0.837298, loss_d: 0.518584
0.0768 --- loss: 1.169978, loss_ss: 0.516459, loss_d: 0.653519
0.1152 --- loss: 1.414490, loss_ss: 1.201269, loss_d: 0.213221
0.1536 --- loss: 1.456984, loss_ss: 1.073808, loss_d: 0.383176
0.1919 --- loss: 1.310975, loss_ss: 0.821385, loss_d: 0.489590
0.2303 --- loss: 1.513109, loss_ss: 1.345042, loss_d: 0.168068
0.2687 --- loss: 1.174658, loss_ss: 0.777467, loss_d: 0.397191
0.3071 --- loss: 1.281211, loss_ss: 0.985163, loss_d: 0.296048
0.3455 --- loss: 1.229957, loss_ss: 1.050290, loss_d: 0.179667
0.3839 --- loss: 1.555027, loss_ss: 0.797827, loss_d: 0.757201
0.4223 --- loss: 1.358953, loss_ss: 0.750599, loss_d: 0.608353
0.4607 --- loss: 1.568798, loss_ss: 1.208643, loss_d: 0.360156
0.4990 --- loss: 1.227219, loss_ss: 0.864987, loss_d: 0.362232
0.5374 --- loss: 0.971473, loss_ss: 0.725743, loss_d: 0.245730
0.5758 --- loss: 1.776717, loss_ss: 1.203680, loss_d: 0.573037
0.6142 --- loss: 1.438162, loss_ss: 0.822317, loss_d: 0.615845
0.6526 --- loss: 1.435560, loss_ss: 0.941285, loss_d: 0.494275
0.6910 --- loss: 1.565287, loss_ss: 0.898158, loss_d: 0.667129
0.7294 --- loss: 1.301954, loss_ss: 1.099052, loss_d: 0.202902
0.7678 --- loss: 1.240923, loss_ss: 0.832770, loss_d: 0.408153
0.8061 --- loss: 1.169934, loss_ss: 0.805386, loss_d: 0.364548
0.8445 --- loss: 1.808762, loss_ss: 0.937968, loss_d: 0.870794
0.8829 --- loss: 1.771196, loss_ss: 0.879331, loss_d: 0.891866
0.9213 --- loss: 1.220707, loss_ss: 0.847199, loss_d: 0.373508
0.9597 --- loss: 1.137659, loss_ss: 0.922208, loss_d: 0.215451
0.9981 --- loss: 1.147757, loss_ss: 0.927479, loss_d: 0.220278
Epoch finished! Loss: 1.3616385489702225
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.313497, loss_ss: 0.917955, loss_d: 0.395541
0.0384 --- loss: 1.417843, loss_ss: 1.089794, loss_d: 0.328049
0.0768 --- loss: 1.135350, loss_ss: 0.900983, loss_d: 0.234367
0.1152 --- loss: 0.992519, loss_ss: 0.767363, loss_d: 0.225155
0.1536 --- loss: 1.246556, loss_ss: 0.670588, loss_d: 0.575968
0.1919 --- loss: 0.696193, loss_ss: 0.506717, loss_d: 0.189476
0.2303 --- loss: 0.899823, loss_ss: 0.748523, loss_d: 0.151300
0.2687 --- loss: 1.086568, loss_ss: 0.871891, loss_d: 0.214678
0.3071 --- loss: 1.398967, loss_ss: 0.928789, loss_d: 0.470178
0.3455 --- loss: 1.661401, loss_ss: 1.292210, loss_d: 0.369191
0.3839 --- loss: 1.131928, loss_ss: 0.900547, loss_d: 0.231381
0.4223 --- loss: 1.245023, loss_ss: 0.829269, loss_d: 0.415755
0.4607 --- loss: 1.236040, loss_ss: 1.119499, loss_d: 0.116541
0.4990 --- loss: 0.920866, loss_ss: 0.793488, loss_d: 0.127378
0.5374 --- loss: 1.270738, loss_ss: 0.908048, loss_d: 0.362690
0.5758 --- loss: 1.154194, loss_ss: 1.041276, loss_d: 0.112917
0.6142 --- loss: 1.436955, loss_ss: 0.876933, loss_d: 0.560023
0.6526 --- loss: 1.053267, loss_ss: 0.917134, loss_d: 0.136132
0.6910 --- loss: 1.016985, loss_ss: 0.836260, loss_d: 0.180725
0.7294 --- loss: 1.110446, loss_ss: 0.702827, loss_d: 0.407619
0.7678 --- loss: 1.493195, loss_ss: 1.196059, loss_d: 0.297136
0.8061 --- loss: 1.181220, loss_ss: 0.905406, loss_d: 0.275814
0.8445 --- loss: 1.617869, loss_ss: 1.210351, loss_d: 0.407518
0.8829 --- loss: 0.980533, loss_ss: 0.704753, loss_d: 0.275780
0.9213 --- loss: 1.246757, loss_ss: 0.926778, loss_d: 0.319979
0.9597 --- loss: 1.291235, loss_ss: 0.772571, loss_d: 0.518665
0.9981 --- loss: 1.446187, loss_ss: 0.996200, loss_d: 0.449987
Epoch finished! Loss: 1.2537135784442608
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.609678, loss_ss: 1.197559, loss_d: 0.412119
0.0384 --- loss: 1.415678, loss_ss: 0.701443, loss_d: 0.714234
0.0768 --- loss: 1.214303, loss_ss: 0.983075, loss_d: 0.231228
0.1152 --- loss: 1.701213, loss_ss: 1.178765, loss_d: 0.522448
0.1536 --- loss: 0.989440, loss_ss: 0.832202, loss_d: 0.157238
0.1919 --- loss: 1.307148, loss_ss: 0.774762, loss_d: 0.532386
0.2303 --- loss: 1.536429, loss_ss: 1.259015, loss_d: 0.277414
0.2687 --- loss: 1.843979, loss_ss: 1.322130, loss_d: 0.521849
0.3071 --- loss: 1.537971, loss_ss: 1.021885, loss_d: 0.516085
0.3455 --- loss: 1.196038, loss_ss: 1.018135, loss_d: 0.177903
0.3839 --- loss: 1.536356, loss_ss: 1.005999, loss_d: 0.530357
0.4223 --- loss: 1.315122, loss_ss: 0.807905, loss_d: 0.507217
0.4607 --- loss: 1.422386, loss_ss: 1.118889, loss_d: 0.303497
0.4990 --- loss: 1.028437, loss_ss: 0.721965, loss_d: 0.306472
0.5374 --- loss: 1.124818, loss_ss: 0.943289, loss_d: 0.181529
0.5758 --- loss: 1.280966, loss_ss: 0.836116, loss_d: 0.444849
0.6142 --- loss: 1.737341, loss_ss: 0.889553, loss_d: 0.847788
0.6526 --- loss: 1.028694, loss_ss: 0.841910, loss_d: 0.186784
0.6910 --- loss: 1.205858, loss_ss: 0.923479, loss_d: 0.282379
0.7294 --- loss: 1.495178, loss_ss: 0.997366, loss_d: 0.497811
0.7678 --- loss: 1.033886, loss_ss: 0.783972, loss_d: 0.249914
0.8061 --- loss: 1.515960, loss_ss: 0.979974, loss_d: 0.535987
0.8445 --- loss: 1.345349, loss_ss: 0.917829, loss_d: 0.427520
0.8829 --- loss: 1.064204, loss_ss: 0.714037, loss_d: 0.350167
0.9213 --- loss: 1.167259, loss_ss: 0.737168, loss_d: 0.430091
0.9597 --- loss: 1.145242, loss_ss: 0.811771, loss_d: 0.333471
0.9981 --- loss: 1.268298, loss_ss: 0.872795, loss_d: 0.395503
Epoch finished! Loss: 1.2408470007089467
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.576334, loss_ss: 0.986258, loss_d: 0.590076
0.0384 --- loss: 1.407119, loss_ss: 1.097603, loss_d: 0.309517
0.0768 --- loss: 1.172730, loss_ss: 0.880473, loss_d: 0.292257
0.1152 --- loss: 1.661292, loss_ss: 1.251009, loss_d: 0.410282
0.1536 --- loss: 1.130593, loss_ss: 0.640498, loss_d: 0.490094
0.1919 --- loss: 1.454683, loss_ss: 1.014574, loss_d: 0.440109
0.2303 --- loss: 0.998604, loss_ss: 0.844144, loss_d: 0.154461
0.2687 --- loss: 1.192549, loss_ss: 1.008596, loss_d: 0.183953
0.3071 --- loss: 1.382215, loss_ss: 1.110916, loss_d: 0.271299
0.3455 --- loss: 1.089104, loss_ss: 0.942772, loss_d: 0.146332
0.3839 --- loss: 0.849724, loss_ss: 0.671314, loss_d: 0.178410
0.4223 --- loss: 1.104157, loss_ss: 0.957595, loss_d: 0.146562
0.4607 --- loss: 1.596134, loss_ss: 0.834163, loss_d: 0.761971
0.4990 --- loss: 1.228647, loss_ss: 0.995999, loss_d: 0.232648
0.5374 --- loss: 1.107796, loss_ss: 0.919333, loss_d: 0.188463
0.5758 --- loss: 1.391341, loss_ss: 1.203220, loss_d: 0.188121
0.6142 --- loss: 1.199122, loss_ss: 0.950644, loss_d: 0.248478
0.6526 --- loss: 1.392436, loss_ss: 0.869818, loss_d: 0.522618
0.6910 --- loss: 0.958911, loss_ss: 0.804963, loss_d: 0.153948
0.7294 --- loss: 0.775132, loss_ss: 0.639533, loss_d: 0.135599
0.7678 --- loss: 0.847970, loss_ss: 0.745087, loss_d: 0.102882
0.8061 --- loss: 1.286429, loss_ss: 0.676151, loss_d: 0.610278
0.8445 --- loss: 1.410325, loss_ss: 0.925326, loss_d: 0.484999
0.8829 --- loss: 1.304596, loss_ss: 0.859604, loss_d: 0.444992
0.9213 --- loss: 1.222329, loss_ss: 1.129459, loss_d: 0.092870
0.9597 --- loss: 1.066696, loss_ss: 0.919508, loss_d: 0.147188
0.9981 --- loss: 0.879472, loss_ss: 0.797874, loss_d: 0.081598
Epoch finished! Loss: 1.2045775374540917
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.849335, loss_ss: 0.732052, loss_d: 0.117283
0.0384 --- loss: 1.374541, loss_ss: 0.826506, loss_d: 0.548035
0.0768 --- loss: 0.763695, loss_ss: 0.695285, loss_d: 0.068409
0.1152 --- loss: 1.277121, loss_ss: 1.060344, loss_d: 0.216778
0.1536 --- loss: 1.097097, loss_ss: 0.975316, loss_d: 0.121781
0.1919 --- loss: 1.306628, loss_ss: 1.159599, loss_d: 0.147028
0.2303 --- loss: 0.990466, loss_ss: 0.766723, loss_d: 0.223743
0.2687 --- loss: 0.864816, loss_ss: 0.716094, loss_d: 0.148722
0.3071 --- loss: 1.064379, loss_ss: 0.750349, loss_d: 0.314030
0.3455 --- loss: 1.299346, loss_ss: 0.874970, loss_d: 0.424376
0.3839 --- loss: 0.974444, loss_ss: 0.772844, loss_d: 0.201600
0.4223 --- loss: 1.108059, loss_ss: 0.672877, loss_d: 0.435182
0.4607 --- loss: 0.935945, loss_ss: 0.822922, loss_d: 0.113023
0.4990 --- loss: 0.843330, loss_ss: 0.623060, loss_d: 0.220271
0.5374 --- loss: 1.390091, loss_ss: 1.262512, loss_d: 0.127579
0.5758 --- loss: 1.143447, loss_ss: 0.921539, loss_d: 0.221908
0.6142 --- loss: 1.159328, loss_ss: 1.059227, loss_d: 0.100101
0.6526 --- loss: 0.866337, loss_ss: 0.741998, loss_d: 0.124339
0.6910 --- loss: 1.054393, loss_ss: 0.882152, loss_d: 0.172240
0.7294 --- loss: 1.011575, loss_ss: 0.902063, loss_d: 0.109513
0.7678 --- loss: 1.256661, loss_ss: 0.968905, loss_d: 0.287757
0.8061 --- loss: 1.130639, loss_ss: 0.980407, loss_d: 0.150232
0.8445 --- loss: 1.083083, loss_ss: 0.856131, loss_d: 0.226952
0.8829 --- loss: 1.508221, loss_ss: 1.124799, loss_d: 0.383422
0.9213 --- loss: 1.191357, loss_ss: 0.594604, loss_d: 0.596753
0.9597 --- loss: 0.721328, loss_ss: 0.523855, loss_d: 0.197473
0.9981 --- loss: 0.928379, loss_ss: 0.871402, loss_d: 0.056978
Epoch finished! Loss: 1.1339063685673934
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7828282828282829
             precision    recall  f1-score   support

        0.0       0.94      0.74      0.82       159
        1.0       0.00      0.00      0.00        87
        2.0       0.84      0.89      0.86       439
        3.0       0.78      0.80      0.79        99
        4.0       0.64      0.92      0.75       206

avg / total       0.73      0.78      0.75       990
 


====== chp052-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  94.95  73.58   99.04  93.60     82.39
1  91.11   0.00   99.89   0.00      0.00
2  87.37  88.84   86.21  83.69     86.19
3  95.76  79.80   97.53  78.22     79.00
4  87.37  91.75   86.22  63.64     75.15
Total accuracy: 78.28%
Average sen: 66.79%
Average spec: 93.78%
Macro f1-score: 64.55%
[0.62042826 0.26976624 0.75795555 0.08982836 0.22041979 0.12157561
 0.27059546 0.73142755 0.18616563 0.16746175 0.77162492 0.18193258
 0.11190881 0.07937527 0.16799948 0.09686239 0.25402769 0.17917529
 0.20866112 0.17137986 0.06818114 0.0719387  0.29638052 0.27014408
 0.15040413 0.23176736 0.16763029 0.76087576 0.04470067 0.08857786
 0.13480406 0.19611001 0.49484381]
pred: 0.26166454589728155, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.415788, loss_ss: 1.756459, loss_d: 0.659329
0.0384 --- loss: 2.242771, loss_ss: 1.634219, loss_d: 0.608552
0.0769 --- loss: 2.296618, loss_ss: 1.654711, loss_d: 0.641907
0.1153 --- loss: 2.124873, loss_ss: 1.605740, loss_d: 0.519133
0.1537 --- loss: 1.925948, loss_ss: 1.330410, loss_d: 0.595537
0.1922 --- loss: 2.000669, loss_ss: 1.639417, loss_d: 0.361253
0.2306 --- loss: 1.687425, loss_ss: 1.275344, loss_d: 0.412080
0.2690 --- loss: 1.867248, loss_ss: 1.300698, loss_d: 0.566550
0.3075 --- loss: 2.252293, loss_ss: 1.527983, loss_d: 0.724310
0.3459 --- loss: 2.077713, loss_ss: 1.305246, loss_d: 0.772468
0.3843 --- loss: 1.771837, loss_ss: 1.381021, loss_d: 0.390816
0.4228 --- loss: 1.593873, loss_ss: 1.230978, loss_d: 0.362894
0.4612 --- loss: 1.805635, loss_ss: 1.298714, loss_d: 0.506921
0.4996 --- loss: 1.893625, loss_ss: 1.359849, loss_d: 0.533776
0.5380 --- loss: 1.808768, loss_ss: 1.332438, loss_d: 0.476330
0.5765 --- loss: 1.910359, loss_ss: 1.268322, loss_d: 0.642037
0.6149 --- loss: 2.021264, loss_ss: 1.547998, loss_d: 0.473266
0.6533 --- loss: 1.987774, loss_ss: 1.317871, loss_d: 0.669903
0.6918 --- loss: 2.166007, loss_ss: 1.408153, loss_d: 0.757854
0.7302 --- loss: 1.762797, loss_ss: 1.196406, loss_d: 0.566391
0.7686 --- loss: 1.971259, loss_ss: 1.401544, loss_d: 0.569715
0.8071 --- loss: 1.923638, loss_ss: 1.235542, loss_d: 0.688097
0.8455 --- loss: 1.863519, loss_ss: 1.219119, loss_d: 0.644400
0.8839 --- loss: 2.033385, loss_ss: 1.311871, loss_d: 0.721514
0.9224 --- loss: 1.645129, loss_ss: 1.141254, loss_d: 0.503875
0.9608 --- loss: 1.619842, loss_ss: 1.126941, loss_d: 0.492900
0.9992 --- loss: 2.529827, loss_ss: 1.542672, loss_d: 0.987155
Epoch finished! Loss: 1.9627816502864543
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.765751, loss_ss: 1.106048, loss_d: 0.659703
0.0384 --- loss: 1.899510, loss_ss: 1.286622, loss_d: 0.612888
0.0769 --- loss: 1.922916, loss_ss: 1.277888, loss_d: 0.645027
0.1153 --- loss: 2.030463, loss_ss: 1.173260, loss_d: 0.857203
0.1537 --- loss: 1.666115, loss_ss: 1.091026, loss_d: 0.575089
0.1922 --- loss: 2.003056, loss_ss: 1.373939, loss_d: 0.629117
0.2306 --- loss: 1.776329, loss_ss: 1.257710, loss_d: 0.518619
0.2690 --- loss: 1.835699, loss_ss: 1.128678, loss_d: 0.707021
0.3075 --- loss: 1.630475, loss_ss: 1.107541, loss_d: 0.522934
0.3459 --- loss: 1.597167, loss_ss: 1.148194, loss_d: 0.448973
0.3843 --- loss: 1.933826, loss_ss: 1.325331, loss_d: 0.608495
0.4228 --- loss: 2.036081, loss_ss: 1.111898, loss_d: 0.924184
0.4612 --- loss: 1.740955, loss_ss: 1.101634, loss_d: 0.639321
0.4996 --- loss: 1.711740, loss_ss: 1.065931, loss_d: 0.645809
0.5380 --- loss: 1.904949, loss_ss: 0.983195, loss_d: 0.921754
0.5765 --- loss: 1.639325, loss_ss: 1.233478, loss_d: 0.405847
0.6149 --- loss: 1.756966, loss_ss: 1.252006, loss_d: 0.504960
0.6533 --- loss: 1.577977, loss_ss: 0.966741, loss_d: 0.611235
0.6918 --- loss: 1.817005, loss_ss: 1.309753, loss_d: 0.507252
0.7302 --- loss: 1.596806, loss_ss: 0.985458, loss_d: 0.611348
0.7686 --- loss: 1.702584, loss_ss: 1.160356, loss_d: 0.542228
0.8071 --- loss: 1.688639, loss_ss: 1.218323, loss_d: 0.470316
0.8455 --- loss: 1.694588, loss_ss: 1.066989, loss_d: 0.627599
0.8839 --- loss: 1.768317, loss_ss: 1.030733, loss_d: 0.737585
0.9224 --- loss: 1.668552, loss_ss: 1.105042, loss_d: 0.563510
0.9608 --- loss: 1.455566, loss_ss: 0.771315, loss_d: 0.684251
0.9992 --- loss: 2.008611, loss_ss: 1.669030, loss_d: 0.339581
Epoch finished! Loss: 1.7263270946649405
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.515331, loss_ss: 1.044544, loss_d: 0.470787
0.0384 --- loss: 1.464283, loss_ss: 0.969862, loss_d: 0.494421
0.0769 --- loss: 1.593444, loss_ss: 1.111893, loss_d: 0.481551
0.1153 --- loss: 1.739412, loss_ss: 1.128553, loss_d: 0.610859
0.1537 --- loss: 1.451398, loss_ss: 0.937509, loss_d: 0.513889
0.1922 --- loss: 1.932595, loss_ss: 1.254678, loss_d: 0.677916
0.2306 --- loss: 1.456081, loss_ss: 0.949232, loss_d: 0.506849
0.2690 --- loss: 1.654290, loss_ss: 1.044150, loss_d: 0.610139
0.3075 --- loss: 1.462838, loss_ss: 1.048637, loss_d: 0.414201
0.3459 --- loss: 1.542819, loss_ss: 1.157407, loss_d: 0.385412
0.3843 --- loss: 1.545789, loss_ss: 0.851565, loss_d: 0.694223
0.4228 --- loss: 1.598519, loss_ss: 0.888397, loss_d: 0.710122
0.4612 --- loss: 1.153554, loss_ss: 0.801834, loss_d: 0.351720
0.4996 --- loss: 1.450937, loss_ss: 1.158764, loss_d: 0.292173
0.5380 --- loss: 1.758168, loss_ss: 1.222522, loss_d: 0.535645
0.5765 --- loss: 1.742812, loss_ss: 1.238317, loss_d: 0.504494
0.6149 --- loss: 2.046353, loss_ss: 1.324304, loss_d: 0.722049
0.6533 --- loss: 1.829630, loss_ss: 1.059016, loss_d: 0.770614
0.6918 --- loss: 1.506513, loss_ss: 0.961388, loss_d: 0.545125
0.7302 --- loss: 1.394289, loss_ss: 0.973321, loss_d: 0.420968
0.7686 --- loss: 1.603451, loss_ss: 0.893868, loss_d: 0.709583
0.8071 --- loss: 1.822160, loss_ss: 0.879809, loss_d: 0.942351
0.8455 --- loss: 1.447155, loss_ss: 0.971277, loss_d: 0.475878
0.8839 --- loss: 1.545609, loss_ss: 1.009827, loss_d: 0.535782
0.9224 --- loss: 1.231480, loss_ss: 0.741460, loss_d: 0.490019
0.9608 --- loss: 1.503645, loss_ss: 0.669223, loss_d: 0.834421
0.9992 --- loss: 2.519029, loss_ss: 1.957324, loss_d: 0.561705
Epoch finished! Loss: 1.562427124610314
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.221158, loss_ss: 0.932494, loss_d: 0.288665
0.0384 --- loss: 1.388446, loss_ss: 1.040196, loss_d: 0.348251
0.0769 --- loss: 1.712529, loss_ss: 1.027069, loss_d: 0.685459
0.1153 --- loss: 1.494271, loss_ss: 0.909219, loss_d: 0.585052
0.1537 --- loss: 1.718302, loss_ss: 0.906335, loss_d: 0.811967
0.1922 --- loss: 1.779311, loss_ss: 1.256800, loss_d: 0.522510
0.2306 --- loss: 1.830033, loss_ss: 1.369498, loss_d: 0.460535
0.2690 --- loss: 1.189673, loss_ss: 0.776116, loss_d: 0.413558
0.3075 --- loss: 1.523527, loss_ss: 1.018678, loss_d: 0.504849
0.3459 --- loss: 1.470786, loss_ss: 0.926560, loss_d: 0.544226
0.3843 --- loss: 1.860422, loss_ss: 0.977975, loss_d: 0.882447
0.4228 --- loss: 1.701928, loss_ss: 0.879901, loss_d: 0.822028
0.4612 --- loss: 1.709235, loss_ss: 1.362379, loss_d: 0.346856
0.4996 --- loss: 1.253390, loss_ss: 0.737251, loss_d: 0.516139
0.5380 --- loss: 1.037606, loss_ss: 0.674874, loss_d: 0.362732
0.5765 --- loss: 1.505136, loss_ss: 1.158313, loss_d: 0.346823
0.6149 --- loss: 0.976429, loss_ss: 0.745827, loss_d: 0.230602
0.6533 --- loss: 0.904474, loss_ss: 0.682823, loss_d: 0.221651
0.6918 --- loss: 1.163870, loss_ss: 0.962359, loss_d: 0.201510
0.7302 --- loss: 1.496975, loss_ss: 1.113553, loss_d: 0.383422
0.7686 --- loss: 1.240631, loss_ss: 0.840879, loss_d: 0.399752
0.8071 --- loss: 1.403802, loss_ss: 1.147149, loss_d: 0.256654
0.8455 --- loss: 1.164435, loss_ss: 0.819918, loss_d: 0.344516
0.8839 --- loss: 1.171800, loss_ss: 0.863776, loss_d: 0.308024
0.9224 --- loss: 1.253310, loss_ss: 0.802599, loss_d: 0.450711
0.9608 --- loss: 1.065763, loss_ss: 0.693765, loss_d: 0.371998
0.9992 --- loss: 1.125510, loss_ss: 0.904531, loss_d: 0.220979
Epoch finished! Loss: 1.4405128137423442
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.139924, loss_ss: 0.862307, loss_d: 0.277618
0.0384 --- loss: 1.735369, loss_ss: 1.031145, loss_d: 0.704224
0.0769 --- loss: 1.347408, loss_ss: 0.707112, loss_d: 0.640296
0.1153 --- loss: 1.473577, loss_ss: 0.830287, loss_d: 0.643290
0.1537 --- loss: 1.435731, loss_ss: 1.101225, loss_d: 0.334506
0.1922 --- loss: 1.424762, loss_ss: 0.928833, loss_d: 0.495929
0.2306 --- loss: 1.535476, loss_ss: 1.026707, loss_d: 0.508769
0.2690 --- loss: 1.636131, loss_ss: 0.677945, loss_d: 0.958186
0.3075 --- loss: 1.200213, loss_ss: 0.921143, loss_d: 0.279070
0.3459 --- loss: 1.242479, loss_ss: 0.811810, loss_d: 0.430669
0.3843 --- loss: 1.318826, loss_ss: 1.057113, loss_d: 0.261713
0.4228 --- loss: 1.312080, loss_ss: 0.821841, loss_d: 0.490239
0.4612 --- loss: 1.107497, loss_ss: 0.764717, loss_d: 0.342780
0.4996 --- loss: 1.507048, loss_ss: 0.899222, loss_d: 0.607826
0.5380 --- loss: 1.401519, loss_ss: 1.033515, loss_d: 0.368004
0.5765 --- loss: 1.244143, loss_ss: 0.770159, loss_d: 0.473984
0.6149 --- loss: 1.137681, loss_ss: 0.764106, loss_d: 0.373575
0.6533 --- loss: 1.116829, loss_ss: 0.846888, loss_d: 0.269941
0.6918 --- loss: 1.536517, loss_ss: 1.192543, loss_d: 0.343974
0.7302 --- loss: 1.924635, loss_ss: 1.487790, loss_d: 0.436845
0.7686 --- loss: 1.291075, loss_ss: 1.122667, loss_d: 0.168408
0.8071 --- loss: 1.221162, loss_ss: 0.859390, loss_d: 0.361772
0.8455 --- loss: 1.229041, loss_ss: 1.054862, loss_d: 0.174179
0.8839 --- loss: 1.044821, loss_ss: 0.833470, loss_d: 0.211351
0.9224 --- loss: 1.427761, loss_ss: 1.109199, loss_d: 0.318562
0.9608 --- loss: 0.957372, loss_ss: 0.646804, loss_d: 0.310568
0.9992 --- loss: 1.211622, loss_ss: 0.984326, loss_d: 0.227297
Epoch finished! Loss: 1.378530185497724
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.910043, loss_ss: 0.689654, loss_d: 0.220389
0.0384 --- loss: 1.398703, loss_ss: 1.042951, loss_d: 0.355751
0.0769 --- loss: 1.761919, loss_ss: 1.217075, loss_d: 0.544844
0.1153 --- loss: 1.562046, loss_ss: 0.962697, loss_d: 0.599349
0.1537 --- loss: 1.166382, loss_ss: 0.782356, loss_d: 0.384026
0.1922 --- loss: 1.582825, loss_ss: 1.127946, loss_d: 0.454879
0.2306 --- loss: 1.251432, loss_ss: 0.912539, loss_d: 0.338893
0.2690 --- loss: 1.421959, loss_ss: 0.923087, loss_d: 0.498872
0.3075 --- loss: 1.252329, loss_ss: 0.952732, loss_d: 0.299597
0.3459 --- loss: 1.006896, loss_ss: 0.776178, loss_d: 0.230719
0.3843 --- loss: 1.007197, loss_ss: 0.667002, loss_d: 0.340196
0.4228 --- loss: 0.995535, loss_ss: 0.752665, loss_d: 0.242870
0.4612 --- loss: 1.594691, loss_ss: 1.052714, loss_d: 0.541978
0.4996 --- loss: 1.623699, loss_ss: 1.282194, loss_d: 0.341504
0.5380 --- loss: 1.201546, loss_ss: 0.893537, loss_d: 0.308009
0.5765 --- loss: 0.997310, loss_ss: 0.735853, loss_d: 0.261457
0.6149 --- loss: 1.156416, loss_ss: 0.931949, loss_d: 0.224466
0.6533 --- loss: 1.212567, loss_ss: 0.928224, loss_d: 0.284342
0.6918 --- loss: 1.064021, loss_ss: 0.846745, loss_d: 0.217277
0.7302 --- loss: 1.167439, loss_ss: 1.008712, loss_d: 0.158727
0.7686 --- loss: 1.413218, loss_ss: 0.938278, loss_d: 0.474940
0.8071 --- loss: 1.078988, loss_ss: 0.737170, loss_d: 0.341818
0.8455 --- loss: 1.622987, loss_ss: 1.038298, loss_d: 0.584689
0.8839 --- loss: 1.879273, loss_ss: 0.736562, loss_d: 1.142711
0.9224 --- loss: 1.300641, loss_ss: 1.060194, loss_d: 0.240448
0.9608 --- loss: 1.516328, loss_ss: 1.015968, loss_d: 0.500360
0.9992 --- loss: 1.676268, loss_ss: 1.306506, loss_d: 0.369762
Epoch finished! Loss: 1.3153586891981273
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.123207, loss_ss: 0.845736, loss_d: 0.277471
0.0384 --- loss: 1.186590, loss_ss: 0.903032, loss_d: 0.283558
0.0769 --- loss: 1.073536, loss_ss: 0.857830, loss_d: 0.215707
0.1153 --- loss: 1.180043, loss_ss: 0.984163, loss_d: 0.195879
0.1537 --- loss: 1.112701, loss_ss: 0.882639, loss_d: 0.230062
0.1922 --- loss: 1.264936, loss_ss: 1.008726, loss_d: 0.256210
0.2306 --- loss: 1.518932, loss_ss: 1.001472, loss_d: 0.517460
0.2690 --- loss: 1.002447, loss_ss: 0.831452, loss_d: 0.170995
0.3075 --- loss: 1.564937, loss_ss: 1.048309, loss_d: 0.516628
0.3459 --- loss: 1.201754, loss_ss: 0.850653, loss_d: 0.351101
0.3843 --- loss: 1.327163, loss_ss: 0.934939, loss_d: 0.392224
0.4228 --- loss: 1.852861, loss_ss: 1.003140, loss_d: 0.849722
0.4612 --- loss: 1.185597, loss_ss: 0.980229, loss_d: 0.205369
0.4996 --- loss: 1.169683, loss_ss: 0.917761, loss_d: 0.251923
0.5380 --- loss: 1.048449, loss_ss: 0.747089, loss_d: 0.301360
0.5765 --- loss: 0.987607, loss_ss: 0.659583, loss_d: 0.328024
0.6149 --- loss: 1.204725, loss_ss: 0.900970, loss_d: 0.303755
0.6533 --- loss: 1.584581, loss_ss: 0.942409, loss_d: 0.642172
0.6918 --- loss: 1.338796, loss_ss: 0.864548, loss_d: 0.474248
0.7302 --- loss: 1.058059, loss_ss: 0.892966, loss_d: 0.165093
0.7686 --- loss: 1.476696, loss_ss: 0.926359, loss_d: 0.550337
0.8071 --- loss: 1.176558, loss_ss: 0.888695, loss_d: 0.287863
0.8455 --- loss: 1.070785, loss_ss: 0.630328, loss_d: 0.440458
0.8839 --- loss: 1.322023, loss_ss: 1.150607, loss_d: 0.171416
0.9224 --- loss: 0.991425, loss_ss: 0.710183, loss_d: 0.281242
0.9608 --- loss: 1.557953, loss_ss: 0.976020, loss_d: 0.581934
0.9992 --- loss: 1.640743, loss_ss: 1.328629, loss_d: 0.312114
Epoch finished! Loss: 1.267513498205405
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.282896, loss_ss: 0.999621, loss_d: 0.283275
0.0384 --- loss: 0.970808, loss_ss: 0.761502, loss_d: 0.209305
0.0769 --- loss: 1.196711, loss_ss: 0.721193, loss_d: 0.475518
0.1153 --- loss: 1.348251, loss_ss: 0.631412, loss_d: 0.716839
0.1537 --- loss: 1.410306, loss_ss: 1.182148, loss_d: 0.228158
0.1922 --- loss: 1.132141, loss_ss: 0.955441, loss_d: 0.176700
0.2306 --- loss: 1.266150, loss_ss: 0.852733, loss_d: 0.413417
0.2690 --- loss: 1.233771, loss_ss: 0.978650, loss_d: 0.255120
0.3075 --- loss: 1.045700, loss_ss: 0.823719, loss_d: 0.221981
0.3459 --- loss: 1.327164, loss_ss: 1.119321, loss_d: 0.207843
0.3843 --- loss: 0.999480, loss_ss: 0.856609, loss_d: 0.142870
0.4228 --- loss: 1.373229, loss_ss: 0.978181, loss_d: 0.395048
0.4612 --- loss: 1.605678, loss_ss: 0.946140, loss_d: 0.659538
0.4996 --- loss: 1.404746, loss_ss: 1.002167, loss_d: 0.402579
0.5380 --- loss: 0.832216, loss_ss: 0.593529, loss_d: 0.238687
0.5765 --- loss: 1.114372, loss_ss: 0.914701, loss_d: 0.199671
0.6149 --- loss: 1.219018, loss_ss: 0.839905, loss_d: 0.379113
0.6533 --- loss: 1.601550, loss_ss: 0.783147, loss_d: 0.818403
0.6918 --- loss: 0.988771, loss_ss: 0.863131, loss_d: 0.125640
0.7302 --- loss: 1.112934, loss_ss: 0.679510, loss_d: 0.433424
0.7686 --- loss: 1.279500, loss_ss: 0.682585, loss_d: 0.596915
0.8071 --- loss: 1.771601, loss_ss: 1.237136, loss_d: 0.534465
0.8455 --- loss: 1.135878, loss_ss: 0.928036, loss_d: 0.207842
0.8839 --- loss: 1.191365, loss_ss: 0.760638, loss_d: 0.430727
0.9224 --- loss: 1.224777, loss_ss: 0.848777, loss_d: 0.376000
0.9608 --- loss: 1.209596, loss_ss: 0.988080, loss_d: 0.221516
0.9992 --- loss: 0.917370, loss_ss: 0.676766, loss_d: 0.240604
Epoch finished! Loss: 1.2075672319302193
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.858650, loss_ss: 0.726591, loss_d: 0.132059
0.0384 --- loss: 1.092334, loss_ss: 0.711559, loss_d: 0.380775
0.0769 --- loss: 1.148337, loss_ss: 0.890148, loss_d: 0.258189
0.1153 --- loss: 1.517603, loss_ss: 0.837950, loss_d: 0.679653
0.1537 --- loss: 1.088893, loss_ss: 0.797879, loss_d: 0.291014
0.1922 --- loss: 0.871321, loss_ss: 0.671089, loss_d: 0.200232
0.2306 --- loss: 1.543587, loss_ss: 0.818353, loss_d: 0.725234
0.2690 --- loss: 0.921272, loss_ss: 0.658015, loss_d: 0.263257
0.3075 --- loss: 1.195397, loss_ss: 0.831235, loss_d: 0.364162
0.3459 --- loss: 0.956436, loss_ss: 0.822696, loss_d: 0.133740
0.3843 --- loss: 1.099699, loss_ss: 0.832395, loss_d: 0.267304
0.4228 --- loss: 1.092026, loss_ss: 0.882877, loss_d: 0.209149
0.4612 --- loss: 0.860772, loss_ss: 0.682460, loss_d: 0.178312
0.4996 --- loss: 1.188565, loss_ss: 1.098380, loss_d: 0.090185
0.5380 --- loss: 1.034386, loss_ss: 0.818239, loss_d: 0.216147
0.5765 --- loss: 0.803107, loss_ss: 0.633898, loss_d: 0.169209
0.6149 --- loss: 1.096586, loss_ss: 0.824696, loss_d: 0.271890
0.6533 --- loss: 1.410831, loss_ss: 0.953421, loss_d: 0.457410
0.6918 --- loss: 0.839288, loss_ss: 0.702846, loss_d: 0.136442
0.7302 --- loss: 1.371563, loss_ss: 0.809216, loss_d: 0.562347
0.7686 --- loss: 0.851889, loss_ss: 0.727020, loss_d: 0.124869
0.8071 --- loss: 0.860770, loss_ss: 0.578277, loss_d: 0.282493
0.8455 --- loss: 0.820277, loss_ss: 0.733815, loss_d: 0.086461
0.8839 --- loss: 1.289553, loss_ss: 0.979974, loss_d: 0.309579
0.9224 --- loss: 1.173967, loss_ss: 0.901277, loss_d: 0.272689
0.9608 --- loss: 1.359761, loss_ss: 0.676785, loss_d: 0.682976
0.9992 --- loss: 1.539511, loss_ss: 1.335083, loss_d: 0.204429
Epoch finished! Loss: 1.1538629380556253
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.304431, loss_ss: 0.967971, loss_d: 0.336460
0.0384 --- loss: 1.865579, loss_ss: 0.586294, loss_d: 1.279285
0.0769 --- loss: 1.316750, loss_ss: 0.757168, loss_d: 0.559583
0.1153 --- loss: 1.112278, loss_ss: 0.831125, loss_d: 0.281153
0.1537 --- loss: 1.079708, loss_ss: 0.913530, loss_d: 0.166177
0.1922 --- loss: 0.989202, loss_ss: 0.762913, loss_d: 0.226289
0.2306 --- loss: 0.960691, loss_ss: 0.884487, loss_d: 0.076204
0.2690 --- loss: 1.005497, loss_ss: 0.890748, loss_d: 0.114749
0.3075 --- loss: 1.170495, loss_ss: 0.813381, loss_d: 0.357114
0.3459 --- loss: 0.854493, loss_ss: 0.756563, loss_d: 0.097930
0.3843 --- loss: 1.101783, loss_ss: 0.973719, loss_d: 0.128064
0.4228 --- loss: 1.217199, loss_ss: 0.730157, loss_d: 0.487042
0.4612 --- loss: 1.169878, loss_ss: 0.853146, loss_d: 0.316732
0.4996 --- loss: 1.096785, loss_ss: 0.755243, loss_d: 0.341542
0.5380 --- loss: 0.970284, loss_ss: 0.791646, loss_d: 0.178638
0.5765 --- loss: 0.958419, loss_ss: 0.627702, loss_d: 0.330717
0.6149 --- loss: 1.012759, loss_ss: 0.848449, loss_d: 0.164310
0.6533 --- loss: 0.829062, loss_ss: 0.555024, loss_d: 0.274038
0.6918 --- loss: 1.183215, loss_ss: 0.922730, loss_d: 0.260485
0.7302 --- loss: 1.532667, loss_ss: 0.595234, loss_d: 0.937434
0.7686 --- loss: 1.341553, loss_ss: 1.151923, loss_d: 0.189630
0.8071 --- loss: 1.290379, loss_ss: 0.775760, loss_d: 0.514618
0.8455 --- loss: 0.953232, loss_ss: 0.829136, loss_d: 0.124096
0.8839 --- loss: 0.887294, loss_ss: 0.798152, loss_d: 0.089142
0.9224 --- loss: 1.820297, loss_ss: 0.903400, loss_d: 0.916897
0.9608 --- loss: 1.196678, loss_ss: 0.655956, loss_d: 0.540722
0.9992 --- loss: 1.376104, loss_ss: 1.175406, loss_d: 0.200699
Epoch finished! Loss: 1.1272858133682837
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6638888888888889
             precision    recall  f1-score   support

        0.0       0.71      0.64      0.67       251
        1.0       0.29      0.31      0.30       147
        2.0       0.62      0.92      0.74       305
        3.0       1.00      0.76      0.86       250
        4.0       0.73      0.31      0.44       127

avg / total       0.70      0.66      0.66      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.56  64.14   92.04   70.93     67.36
1  80.28  31.29   88.00   29.11     30.16
2  82.04  92.13   78.06   62.31     74.34
3  94.35  75.60  100.00  100.00     86.10
4  90.56  31.50   98.43   72.73     43.96
Total accuracy: 66.39%
Average sen: 58.93%
Average spec: 91.30%
Macro f1-score: 60.39%
[0.58046937 0.58547711 0.96198916 0.96624982 0.97267276 0.76165766
 0.51563603 0.99964142 0.91264194 0.94992626 0.97265631 0.99806124
 0.68760014 0.99540025 0.68207395 0.30128327 0.36710539 0.87016505
 0.7473349  0.88688183 0.97897631 0.99531698 0.94358599 0.96672106
 0.96582884 0.98456502 0.74513829 0.62614703 0.99038118 0.9329747
 0.95015275 0.9892267  0.59580266 0.67851156 0.91573673 0.98370081]
pred: 0.8321580688158671, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.466544, loss_ss: 1.745430, loss_d: 0.721113
0.0384 --- loss: 2.303164, loss_ss: 1.540952, loss_d: 0.762212
0.0769 --- loss: 1.985330, loss_ss: 1.561209, loss_d: 0.424121
0.1153 --- loss: 2.186518, loss_ss: 1.616460, loss_d: 0.570058
0.1538 --- loss: 1.961421, loss_ss: 1.415531, loss_d: 0.545890
0.1922 --- loss: 1.740357, loss_ss: 1.367254, loss_d: 0.373103
0.2307 --- loss: 2.217906, loss_ss: 1.440973, loss_d: 0.776933
0.2691 --- loss: 2.274318, loss_ss: 1.368824, loss_d: 0.905494
0.3076 --- loss: 1.990162, loss_ss: 1.342638, loss_d: 0.647524
0.3460 --- loss: 1.934216, loss_ss: 1.386996, loss_d: 0.547220
0.3845 --- loss: 1.669455, loss_ss: 1.300456, loss_d: 0.368999
0.4229 --- loss: 2.134374, loss_ss: 1.391223, loss_d: 0.743151
0.4614 --- loss: 1.723830, loss_ss: 1.217294, loss_d: 0.506537
0.4998 --- loss: 1.765708, loss_ss: 1.335840, loss_d: 0.429868
0.5383 --- loss: 1.937706, loss_ss: 1.354390, loss_d: 0.583316
0.5767 --- loss: 1.691897, loss_ss: 1.089091, loss_d: 0.602806
0.6151 --- loss: 1.861711, loss_ss: 1.264890, loss_d: 0.596821
0.6536 --- loss: 1.734771, loss_ss: 1.179192, loss_d: 0.555579
0.6920 --- loss: 1.721826, loss_ss: 1.216162, loss_d: 0.505664
0.7305 --- loss: 1.715833, loss_ss: 1.266607, loss_d: 0.449226
0.7689 --- loss: 1.656344, loss_ss: 1.210041, loss_d: 0.446303
0.8074 --- loss: 1.978648, loss_ss: 1.313939, loss_d: 0.664709
0.8458 --- loss: 1.817877, loss_ss: 1.146742, loss_d: 0.671135
0.8843 --- loss: 1.994654, loss_ss: 1.325089, loss_d: 0.669565
0.9227 --- loss: 1.689124, loss_ss: 0.945116, loss_d: 0.744007
0.9612 --- loss: 1.866873, loss_ss: 1.187270, loss_d: 0.679603
0.9996 --- loss: 1.587723, loss_ss: 1.272054, loss_d: 0.315669
Epoch finished! Loss: 1.9134289095034966
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.789699, loss_ss: 1.206093, loss_d: 0.583606
0.0384 --- loss: 1.753061, loss_ss: 1.127658, loss_d: 0.625403
0.0769 --- loss: 1.533186, loss_ss: 0.990086, loss_d: 0.543101
0.1153 --- loss: 1.660513, loss_ss: 1.144505, loss_d: 0.516008
0.1538 --- loss: 1.557447, loss_ss: 1.091949, loss_d: 0.465498
0.1922 --- loss: 1.767884, loss_ss: 1.166644, loss_d: 0.601240
0.2307 --- loss: 1.898721, loss_ss: 0.889298, loss_d: 1.009424
0.2691 --- loss: 1.706213, loss_ss: 0.991290, loss_d: 0.714923
0.3076 --- loss: 2.008954, loss_ss: 1.260406, loss_d: 0.748547
0.3460 --- loss: 1.559767, loss_ss: 1.068974, loss_d: 0.490793
0.3845 --- loss: 1.521941, loss_ss: 0.957649, loss_d: 0.564292
0.4229 --- loss: 1.750495, loss_ss: 1.231826, loss_d: 0.518669
0.4614 --- loss: 1.630712, loss_ss: 1.046350, loss_d: 0.584362
0.4998 --- loss: 1.819445, loss_ss: 1.336494, loss_d: 0.482951
0.5383 --- loss: 1.862182, loss_ss: 1.440704, loss_d: 0.421478
0.5767 --- loss: 1.588168, loss_ss: 0.981177, loss_d: 0.606991
0.6151 --- loss: 1.711169, loss_ss: 1.144212, loss_d: 0.566957
0.6536 --- loss: 1.700865, loss_ss: 0.919398, loss_d: 0.781467
0.6920 --- loss: 1.375917, loss_ss: 0.904786, loss_d: 0.471131
0.7305 --- loss: 1.694759, loss_ss: 0.983888, loss_d: 0.710872
0.7689 --- loss: 1.419119, loss_ss: 1.104984, loss_d: 0.314135
0.8074 --- loss: 1.524083, loss_ss: 1.083681, loss_d: 0.440403
0.8458 --- loss: 1.497200, loss_ss: 1.193073, loss_d: 0.304127
0.8843 --- loss: 1.874227, loss_ss: 0.944556, loss_d: 0.929671
0.9227 --- loss: 1.406456, loss_ss: 0.939073, loss_d: 0.467383
0.9612 --- loss: 1.385457, loss_ss: 0.966875, loss_d: 0.418582
0.9996 --- loss: 2.262074, loss_ss: 2.064363, loss_d: 0.197712
Epoch finished! Loss: 1.6360612635429088
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.341854, loss_ss: 0.859507, loss_d: 0.482348
0.0384 --- loss: 1.751132, loss_ss: 1.065981, loss_d: 0.685151
0.0769 --- loss: 1.571970, loss_ss: 1.121203, loss_d: 0.450767
0.1153 --- loss: 2.102388, loss_ss: 1.253853, loss_d: 0.848535
0.1538 --- loss: 1.912927, loss_ss: 1.509128, loss_d: 0.403800
0.1922 --- loss: 1.416252, loss_ss: 0.880555, loss_d: 0.535697
0.2307 --- loss: 2.043941, loss_ss: 1.018556, loss_d: 1.025385
0.2691 --- loss: 1.721575, loss_ss: 1.044213, loss_d: 0.677363
0.3076 --- loss: 1.589466, loss_ss: 1.105777, loss_d: 0.483689
0.3460 --- loss: 2.032043, loss_ss: 1.486092, loss_d: 0.545951
0.3845 --- loss: 1.746473, loss_ss: 1.193854, loss_d: 0.552619
0.4229 --- loss: 1.153722, loss_ss: 0.837099, loss_d: 0.316623
0.4614 --- loss: 1.419852, loss_ss: 1.019581, loss_d: 0.400270
0.4998 --- loss: 1.375118, loss_ss: 1.016828, loss_d: 0.358290
0.5383 --- loss: 1.367147, loss_ss: 0.869271, loss_d: 0.497876
0.5767 --- loss: 1.529495, loss_ss: 0.975985, loss_d: 0.553510
0.6151 --- loss: 1.140732, loss_ss: 0.821033, loss_d: 0.319699
0.6536 --- loss: 1.684572, loss_ss: 0.906890, loss_d: 0.777681
0.6920 --- loss: 1.712544, loss_ss: 1.236671, loss_d: 0.475873
0.7305 --- loss: 1.218074, loss_ss: 0.839818, loss_d: 0.378256
0.7689 --- loss: 1.602332, loss_ss: 1.089109, loss_d: 0.513223
0.8074 --- loss: 1.593894, loss_ss: 1.268472, loss_d: 0.325423
0.8458 --- loss: 1.183142, loss_ss: 0.724214, loss_d: 0.458928
0.8843 --- loss: 1.601970, loss_ss: 1.038778, loss_d: 0.563192
0.9227 --- loss: 1.124106, loss_ss: 0.853908, loss_d: 0.270198
0.9612 --- loss: 1.593110, loss_ss: 1.014315, loss_d: 0.578795
0.9996 --- loss: 2.742640, loss_ss: 2.497563, loss_d: 0.245076
Epoch finished! Loss: 1.5068703137911283
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.280540, loss_ss: 0.689537, loss_d: 0.591003
0.0384 --- loss: 1.067928, loss_ss: 0.688622, loss_d: 0.379305
0.0769 --- loss: 1.235155, loss_ss: 0.942777, loss_d: 0.292378
0.1153 --- loss: 1.479255, loss_ss: 1.123613, loss_d: 0.355642
0.1538 --- loss: 1.579981, loss_ss: 1.044668, loss_d: 0.535314
0.1922 --- loss: 1.377782, loss_ss: 1.001148, loss_d: 0.376634
0.2307 --- loss: 1.389568, loss_ss: 1.006487, loss_d: 0.383081
0.2691 --- loss: 1.032818, loss_ss: 0.765298, loss_d: 0.267520
0.3076 --- loss: 1.895942, loss_ss: 0.985394, loss_d: 0.910548
0.3460 --- loss: 1.149508, loss_ss: 0.792586, loss_d: 0.356921
0.3845 --- loss: 1.677168, loss_ss: 1.007593, loss_d: 0.669574
0.4229 --- loss: 1.195282, loss_ss: 0.711559, loss_d: 0.483722
0.4614 --- loss: 1.411824, loss_ss: 0.834948, loss_d: 0.576877
0.4998 --- loss: 1.683959, loss_ss: 1.367186, loss_d: 0.316774
0.5383 --- loss: 1.635166, loss_ss: 1.184334, loss_d: 0.450832
0.5767 --- loss: 2.131227, loss_ss: 0.767552, loss_d: 1.363674
0.6151 --- loss: 1.461881, loss_ss: 0.867090, loss_d: 0.594791
0.6536 --- loss: 1.064174, loss_ss: 0.768224, loss_d: 0.295950
0.6920 --- loss: 1.659491, loss_ss: 1.373267, loss_d: 0.286223
0.7305 --- loss: 1.738119, loss_ss: 1.078945, loss_d: 0.659174
0.7689 --- loss: 1.047287, loss_ss: 0.801417, loss_d: 0.245871
0.8074 --- loss: 1.454052, loss_ss: 1.106081, loss_d: 0.347972
0.8458 --- loss: 1.322570, loss_ss: 0.825074, loss_d: 0.497497
0.8843 --- loss: 1.558543, loss_ss: 1.071987, loss_d: 0.486556
0.9227 --- loss: 1.096998, loss_ss: 0.817187, loss_d: 0.279810
0.9612 --- loss: 1.038600, loss_ss: 0.640106, loss_d: 0.398494
0.9996 --- loss: 1.818977, loss_ss: 1.714346, loss_d: 0.104631
Epoch finished! Loss: 1.4371655863064987
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.508066, loss_ss: 0.946326, loss_d: 0.561740
0.0384 --- loss: 1.533164, loss_ss: 0.945870, loss_d: 0.587293
0.0769 --- loss: 1.363471, loss_ss: 1.048756, loss_d: 0.314715
0.1153 --- loss: 1.310304, loss_ss: 0.948813, loss_d: 0.361491
0.1538 --- loss: 1.359507, loss_ss: 0.729095, loss_d: 0.630411
0.1922 --- loss: 1.569793, loss_ss: 1.218171, loss_d: 0.351621
0.2307 --- loss: 1.246953, loss_ss: 0.823742, loss_d: 0.423210
0.2691 --- loss: 1.221840, loss_ss: 0.897383, loss_d: 0.324456
0.3076 --- loss: 1.049008, loss_ss: 0.785427, loss_d: 0.263581
0.3460 --- loss: 1.074045, loss_ss: 0.816989, loss_d: 0.257056
0.3845 --- loss: 1.658671, loss_ss: 0.954013, loss_d: 0.704658
0.4229 --- loss: 1.589395, loss_ss: 1.030219, loss_d: 0.559176
0.4614 --- loss: 1.522840, loss_ss: 1.097594, loss_d: 0.425246
0.4998 --- loss: 1.209770, loss_ss: 0.899844, loss_d: 0.309926
0.5383 --- loss: 1.318418, loss_ss: 0.562421, loss_d: 0.755997
0.5767 --- loss: 1.676934, loss_ss: 1.102849, loss_d: 0.574084
0.6151 --- loss: 1.226022, loss_ss: 0.894502, loss_d: 0.331520
0.6536 --- loss: 1.403448, loss_ss: 0.926443, loss_d: 0.477005
0.6920 --- loss: 1.699663, loss_ss: 0.934017, loss_d: 0.765646
0.7305 --- loss: 1.475069, loss_ss: 1.194236, loss_d: 0.280833
0.7689 --- loss: 1.158987, loss_ss: 0.804777, loss_d: 0.354210
0.8074 --- loss: 1.040086, loss_ss: 0.770799, loss_d: 0.269287
0.8458 --- loss: 1.536233, loss_ss: 0.944542, loss_d: 0.591690
0.8843 --- loss: 0.956219, loss_ss: 0.855184, loss_d: 0.101036
0.9227 --- loss: 1.394929, loss_ss: 0.984453, loss_d: 0.410476
0.9612 --- loss: 1.464035, loss_ss: 1.147149, loss_d: 0.316886
0.9996 --- loss: 0.987296, loss_ss: 0.909414, loss_d: 0.077881
Epoch finished! Loss: 1.3663167025034244
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.959643, loss_ss: 0.689921, loss_d: 0.269722
0.0384 --- loss: 1.658476, loss_ss: 0.947137, loss_d: 0.711340
0.0769 --- loss: 1.458485, loss_ss: 0.972629, loss_d: 0.485856
0.1153 --- loss: 1.148760, loss_ss: 0.901961, loss_d: 0.246799
0.1538 --- loss: 1.123734, loss_ss: 0.875477, loss_d: 0.248257
0.1922 --- loss: 1.257416, loss_ss: 0.888768, loss_d: 0.368648
0.2307 --- loss: 1.023154, loss_ss: 0.791723, loss_d: 0.231431
0.2691 --- loss: 0.978957, loss_ss: 0.695235, loss_d: 0.283721
0.3076 --- loss: 1.259392, loss_ss: 0.940585, loss_d: 0.318807
0.3460 --- loss: 1.542213, loss_ss: 1.032583, loss_d: 0.509630
0.3845 --- loss: 1.004288, loss_ss: 0.796227, loss_d: 0.208061
0.4229 --- loss: 1.256055, loss_ss: 1.008804, loss_d: 0.247252
0.4614 --- loss: 1.362768, loss_ss: 0.995779, loss_d: 0.366989
0.4998 --- loss: 1.260782, loss_ss: 0.938422, loss_d: 0.322361
0.5383 --- loss: 1.015003, loss_ss: 0.777812, loss_d: 0.237192
0.5767 --- loss: 1.467080, loss_ss: 0.789717, loss_d: 0.677363
0.6151 --- loss: 0.988034, loss_ss: 0.844059, loss_d: 0.143975
0.6536 --- loss: 1.437969, loss_ss: 0.961028, loss_d: 0.476941
0.6920 --- loss: 1.692950, loss_ss: 1.401643, loss_d: 0.291307
0.7305 --- loss: 1.182209, loss_ss: 0.713961, loss_d: 0.468248
0.7689 --- loss: 1.305121, loss_ss: 0.892344, loss_d: 0.412777
0.8074 --- loss: 1.017049, loss_ss: 0.819198, loss_d: 0.197851
0.8458 --- loss: 1.284004, loss_ss: 0.870220, loss_d: 0.413784
0.8843 --- loss: 1.172017, loss_ss: 0.778176, loss_d: 0.393841
0.9227 --- loss: 1.402165, loss_ss: 1.097644, loss_d: 0.304521
0.9612 --- loss: 1.032424, loss_ss: 0.758312, loss_d: 0.274112
0.9996 --- loss: 3.175041, loss_ss: 0.966991, loss_d: 2.208050
Epoch finished! Loss: 1.2847798154904293
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.277034, loss_ss: 1.123048, loss_d: 0.153986
0.0384 --- loss: 1.012629, loss_ss: 0.805295, loss_d: 0.207334
0.0769 --- loss: 0.875381, loss_ss: 0.750798, loss_d: 0.124583
0.1153 --- loss: 1.647077, loss_ss: 1.172134, loss_d: 0.474942
0.1538 --- loss: 0.913044, loss_ss: 0.739042, loss_d: 0.174002
0.1922 --- loss: 1.225928, loss_ss: 0.949856, loss_d: 0.276071
0.2307 --- loss: 1.233628, loss_ss: 0.863679, loss_d: 0.369949
0.2691 --- loss: 1.444292, loss_ss: 1.214198, loss_d: 0.230094
0.3076 --- loss: 1.083569, loss_ss: 0.740304, loss_d: 0.343265
0.3460 --- loss: 1.047963, loss_ss: 0.913515, loss_d: 0.134449
0.3845 --- loss: 0.958873, loss_ss: 0.623053, loss_d: 0.335821
0.4229 --- loss: 1.321564, loss_ss: 0.878659, loss_d: 0.442906
0.4614 --- loss: 1.091915, loss_ss: 0.681417, loss_d: 0.410498
0.4998 --- loss: 1.255903, loss_ss: 0.751908, loss_d: 0.503996
0.5383 --- loss: 1.111187, loss_ss: 0.849745, loss_d: 0.261442
0.5767 --- loss: 1.042623, loss_ss: 0.764531, loss_d: 0.278092
0.6151 --- loss: 1.383855, loss_ss: 1.063373, loss_d: 0.320482
0.6536 --- loss: 1.317255, loss_ss: 1.011635, loss_d: 0.305620
0.6920 --- loss: 1.057122, loss_ss: 0.895097, loss_d: 0.162025
0.7305 --- loss: 0.943842, loss_ss: 0.747314, loss_d: 0.196528
0.7689 --- loss: 1.358252, loss_ss: 0.949641, loss_d: 0.408611
0.8074 --- loss: 1.151736, loss_ss: 0.687976, loss_d: 0.463760
0.8458 --- loss: 1.232028, loss_ss: 0.855484, loss_d: 0.376544
0.8843 --- loss: 1.401363, loss_ss: 0.981468, loss_d: 0.419895
0.9227 --- loss: 0.840524, loss_ss: 0.711249, loss_d: 0.129275
0.9612 --- loss: 1.194691, loss_ss: 0.974819, loss_d: 0.219872
0.9996 --- loss: 2.977759, loss_ss: 1.296335, loss_d: 1.681424
Epoch finished! Loss: 1.2308998444905648
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.249015, loss_ss: 1.026385, loss_d: 0.222631
0.0384 --- loss: 1.242334, loss_ss: 0.942224, loss_d: 0.300110
0.0769 --- loss: 1.205402, loss_ss: 0.973325, loss_d: 0.232077
0.1153 --- loss: 1.088982, loss_ss: 0.861685, loss_d: 0.227297
0.1538 --- loss: 1.149414, loss_ss: 0.865773, loss_d: 0.283640
0.1922 --- loss: 1.765475, loss_ss: 1.026624, loss_d: 0.738851
0.2307 --- loss: 1.003071, loss_ss: 0.772977, loss_d: 0.230093
0.2691 --- loss: 1.219645, loss_ss: 0.814117, loss_d: 0.405528
0.3076 --- loss: 1.230943, loss_ss: 0.993395, loss_d: 0.237548
0.3460 --- loss: 1.041056, loss_ss: 0.773827, loss_d: 0.267229
0.3845 --- loss: 0.787670, loss_ss: 0.672209, loss_d: 0.115460
0.4229 --- loss: 0.881241, loss_ss: 0.635686, loss_d: 0.245554
0.4614 --- loss: 1.515266, loss_ss: 0.805579, loss_d: 0.709687
0.4998 --- loss: 0.908827, loss_ss: 0.797140, loss_d: 0.111687
0.5383 --- loss: 1.009834, loss_ss: 0.660229, loss_d: 0.349606
0.5767 --- loss: 1.317417, loss_ss: 0.584921, loss_d: 0.732496
0.6151 --- loss: 1.299039, loss_ss: 1.004599, loss_d: 0.294441
0.6536 --- loss: 1.357156, loss_ss: 1.036222, loss_d: 0.320934
0.6920 --- loss: 1.116077, loss_ss: 0.953308, loss_d: 0.162769
0.7305 --- loss: 0.779692, loss_ss: 0.620876, loss_d: 0.158816
0.7689 --- loss: 1.013608, loss_ss: 0.677121, loss_d: 0.336487
0.8074 --- loss: 1.635062, loss_ss: 1.135960, loss_d: 0.499103
0.8458 --- loss: 1.279402, loss_ss: 0.909444, loss_d: 0.369958
0.8843 --- loss: 1.240373, loss_ss: 1.020583, loss_d: 0.219790
0.9227 --- loss: 0.942178, loss_ss: 0.702594, loss_d: 0.239584
0.9612 --- loss: 1.158816, loss_ss: 0.859699, loss_d: 0.299117
0.9996 --- loss: 2.574432, loss_ss: 2.456771, loss_d: 0.117661
Epoch finished! Loss: 1.200049057832131
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.291166, loss_ss: 0.759903, loss_d: 0.531263
0.0384 --- loss: 0.971228, loss_ss: 0.802336, loss_d: 0.168892
0.0769 --- loss: 1.118787, loss_ss: 0.889763, loss_d: 0.229024
0.1153 --- loss: 1.281261, loss_ss: 0.930425, loss_d: 0.350836
0.1538 --- loss: 0.825934, loss_ss: 0.686514, loss_d: 0.139420
0.1922 --- loss: 1.274466, loss_ss: 0.845185, loss_d: 0.429281
0.2307 --- loss: 1.141533, loss_ss: 0.848509, loss_d: 0.293024
0.2691 --- loss: 1.438581, loss_ss: 0.849557, loss_d: 0.589024
0.3076 --- loss: 1.260861, loss_ss: 1.047652, loss_d: 0.213209
0.3460 --- loss: 0.840570, loss_ss: 0.729189, loss_d: 0.111380
0.3845 --- loss: 1.179856, loss_ss: 1.033650, loss_d: 0.146207
0.4229 --- loss: 1.161543, loss_ss: 1.013974, loss_d: 0.147569
0.4614 --- loss: 1.013788, loss_ss: 0.749399, loss_d: 0.264389
0.4998 --- loss: 0.979922, loss_ss: 0.871504, loss_d: 0.108419
0.5383 --- loss: 0.989971, loss_ss: 0.764592, loss_d: 0.225379
0.5767 --- loss: 1.002221, loss_ss: 0.728946, loss_d: 0.273275
0.6151 --- loss: 1.073959, loss_ss: 0.959599, loss_d: 0.114360
0.6536 --- loss: 0.895379, loss_ss: 0.640295, loss_d: 0.255085
0.6920 --- loss: 0.982028, loss_ss: 0.644778, loss_d: 0.337250
0.7305 --- loss: 1.219587, loss_ss: 0.867998, loss_d: 0.351589
0.7689 --- loss: 1.263337, loss_ss: 1.075840, loss_d: 0.187498
0.8074 --- loss: 1.452208, loss_ss: 0.956854, loss_d: 0.495354
0.8458 --- loss: 1.027005, loss_ss: 0.760351, loss_d: 0.266654
0.8843 --- loss: 1.472526, loss_ss: 1.001827, loss_d: 0.470699
0.9227 --- loss: 1.209244, loss_ss: 0.824318, loss_d: 0.384926
0.9612 --- loss: 1.452782, loss_ss: 1.217737, loss_d: 0.235045
0.9996 --- loss: 1.820569, loss_ss: 1.702314, loss_d: 0.118255
Epoch finished! Loss: 1.165086574279345
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.499328, loss_ss: 1.231481, loss_d: 0.267847
0.0384 --- loss: 1.175146, loss_ss: 0.900238, loss_d: 0.274908
0.0769 --- loss: 1.315792, loss_ss: 0.979648, loss_d: 0.336144
0.1153 --- loss: 1.158687, loss_ss: 0.579617, loss_d: 0.579069
0.1538 --- loss: 0.869122, loss_ss: 0.704229, loss_d: 0.164892
0.1922 --- loss: 0.747452, loss_ss: 0.574214, loss_d: 0.173238
0.2307 --- loss: 0.699401, loss_ss: 0.539696, loss_d: 0.159705
0.2691 --- loss: 0.818346, loss_ss: 0.610108, loss_d: 0.208238
0.3076 --- loss: 0.858278, loss_ss: 0.768014, loss_d: 0.090263
0.3460 --- loss: 0.934881, loss_ss: 0.806847, loss_d: 0.128035
0.3845 --- loss: 1.202762, loss_ss: 0.956422, loss_d: 0.246340
0.4229 --- loss: 0.752722, loss_ss: 0.642079, loss_d: 0.110644
0.4614 --- loss: 1.006555, loss_ss: 0.836398, loss_d: 0.170157
0.4998 --- loss: 1.012884, loss_ss: 0.826201, loss_d: 0.186683
0.5383 --- loss: 1.361616, loss_ss: 1.056979, loss_d: 0.304638
0.5767 --- loss: 0.826783, loss_ss: 0.766857, loss_d: 0.059926
0.6151 --- loss: 0.930030, loss_ss: 0.868388, loss_d: 0.061642
0.6536 --- loss: 0.834589, loss_ss: 0.559155, loss_d: 0.275435
0.6920 --- loss: 1.348620, loss_ss: 0.874019, loss_d: 0.474601
0.7305 --- loss: 1.078562, loss_ss: 0.666852, loss_d: 0.411710
0.7689 --- loss: 1.563185, loss_ss: 1.009568, loss_d: 0.553618
0.8074 --- loss: 0.885376, loss_ss: 0.733365, loss_d: 0.152011
0.8458 --- loss: 1.169904, loss_ss: 0.942243, loss_d: 0.227661
0.8843 --- loss: 1.299016, loss_ss: 1.124743, loss_d: 0.174273
0.9227 --- loss: 0.883993, loss_ss: 0.773514, loss_d: 0.110479
0.9612 --- loss: 1.055976, loss_ss: 0.810746, loss_d: 0.245230
0.9996 --- loss: 2.817532, loss_ss: 2.798400, loss_d: 0.019133
Epoch finished! Loss: 1.1116669313265728
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6936936936936937
             precision    recall  f1-score   support

        0.0       0.78      0.58      0.66       231
        1.0       0.05      0.02      0.03        92
        2.0       0.78      0.73      0.75       472
        3.0       0.67      0.99      0.80        99
        4.0       0.62      0.90      0.73       216

avg / total       0.68      0.69      0.67      1110
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.75  57.58   95.68  77.78     66.17
1  88.74   2.17   96.56   5.41      3.10
2  79.46  72.67   84.48  77.60     75.05
3  95.50  98.99   95.15  66.67     79.67
4  87.30  89.81   86.69  61.98     73.35
Total accuracy: 69.37%
Average sen: 64.24%
Average spec: 91.71%
Macro f1-score: 59.47%
[0.99647731 0.99843389 0.98520076 0.93838382 0.84871131 0.99834597
 0.99699807 0.74853146 0.95105904 0.88757586 0.8085236  0.78142905
 0.99140012 0.97129291 0.99481201 0.91709805 0.99183238 0.99689615
 0.99138778 0.99676228 0.99478132 0.88470823 0.99497652 0.83130538
 0.99541229 0.99781823 0.99726945 0.97202253 0.99519736 0.90930265
 0.97728604 0.98943186 0.99939442 0.99996102 0.997491   0.99652773
 0.99944669]
pred: 0.9546887713509637, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.320858, loss_ss: 1.637092, loss_d: 0.683766
0.0384 --- loss: 2.147899, loss_ss: 1.544099, loss_d: 0.603800
0.0769 --- loss: 2.186230, loss_ss: 1.437500, loss_d: 0.748730
0.1153 --- loss: 2.105244, loss_ss: 1.538723, loss_d: 0.566521
0.1538 --- loss: 2.283625, loss_ss: 1.448450, loss_d: 0.835175
0.1922 --- loss: 2.050710, loss_ss: 1.483821, loss_d: 0.566889
0.2307 --- loss: 2.137908, loss_ss: 1.581363, loss_d: 0.556545
0.2691 --- loss: 1.985214, loss_ss: 1.520838, loss_d: 0.464376
0.3076 --- loss: 2.071884, loss_ss: 1.522947, loss_d: 0.548938
0.3460 --- loss: 2.152472, loss_ss: 1.499532, loss_d: 0.652940
0.3845 --- loss: 1.993587, loss_ss: 1.383891, loss_d: 0.609696
0.4229 --- loss: 2.065854, loss_ss: 1.497397, loss_d: 0.568456
0.4614 --- loss: 2.048079, loss_ss: 1.515842, loss_d: 0.532236
0.4998 --- loss: 1.988589, loss_ss: 1.478998, loss_d: 0.509591
0.5383 --- loss: 2.089742, loss_ss: 1.425222, loss_d: 0.664521
0.5767 --- loss: 2.013784, loss_ss: 1.383526, loss_d: 0.630258
0.6151 --- loss: 1.847967, loss_ss: 1.299202, loss_d: 0.548765
0.6536 --- loss: 1.852445, loss_ss: 1.441668, loss_d: 0.410778
0.6920 --- loss: 2.081409, loss_ss: 1.259727, loss_d: 0.821681
0.7305 --- loss: 1.931684, loss_ss: 1.377227, loss_d: 0.554457
0.7689 --- loss: 1.838967, loss_ss: 1.232927, loss_d: 0.606040
0.8074 --- loss: 1.826022, loss_ss: 1.144147, loss_d: 0.681875
0.8458 --- loss: 1.943622, loss_ss: 1.443494, loss_d: 0.500127
0.8843 --- loss: 1.785429, loss_ss: 1.341481, loss_d: 0.443947
0.9227 --- loss: 1.832499, loss_ss: 1.340527, loss_d: 0.491972
0.9612 --- loss: 1.862558, loss_ss: 1.396267, loss_d: 0.466291
0.9996 --- loss: 1.696231, loss_ss: 1.369435, loss_d: 0.326796
Epoch finished! Loss: 2.000005776148576
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.934862, loss_ss: 1.273686, loss_d: 0.661176
0.0384 --- loss: 1.459162, loss_ss: 1.196154, loss_d: 0.263008
0.0769 --- loss: 1.734099, loss_ss: 1.268063, loss_d: 0.466035
0.1153 --- loss: 1.752451, loss_ss: 1.242324, loss_d: 0.510127
0.1538 --- loss: 1.963768, loss_ss: 1.128421, loss_d: 0.835347
0.1922 --- loss: 1.615135, loss_ss: 1.191584, loss_d: 0.423551
0.2307 --- loss: 1.459300, loss_ss: 1.018172, loss_d: 0.441128
0.2691 --- loss: 1.803379, loss_ss: 1.149754, loss_d: 0.653625
0.3076 --- loss: 1.755617, loss_ss: 1.158067, loss_d: 0.597550
0.3460 --- loss: 1.594796, loss_ss: 0.990287, loss_d: 0.604509
0.3845 --- loss: 1.869167, loss_ss: 1.153719, loss_d: 0.715448
0.4229 --- loss: 1.803724, loss_ss: 1.159309, loss_d: 0.644415
0.4614 --- loss: 1.510473, loss_ss: 0.989787, loss_d: 0.520685
0.4998 --- loss: 1.894897, loss_ss: 1.266833, loss_d: 0.628064
0.5383 --- loss: 1.475289, loss_ss: 1.062406, loss_d: 0.412883
0.5767 --- loss: 1.951613, loss_ss: 1.266486, loss_d: 0.685128
0.6151 --- loss: 1.971310, loss_ss: 1.137264, loss_d: 0.834046
0.6536 --- loss: 2.115066, loss_ss: 1.440150, loss_d: 0.674916
0.6920 --- loss: 1.915495, loss_ss: 1.371656, loss_d: 0.543839
0.7305 --- loss: 1.531795, loss_ss: 0.996180, loss_d: 0.535615
0.7689 --- loss: 1.633260, loss_ss: 1.103539, loss_d: 0.529720
0.8074 --- loss: 1.691627, loss_ss: 1.111223, loss_d: 0.580403
0.8458 --- loss: 1.763289, loss_ss: 1.258764, loss_d: 0.504525
0.8843 --- loss: 1.505851, loss_ss: 0.864635, loss_d: 0.641217
0.9227 --- loss: 1.371548, loss_ss: 0.936520, loss_d: 0.435029
0.9612 --- loss: 1.724216, loss_ss: 1.235261, loss_d: 0.488955
0.9996 --- loss: 1.533969, loss_ss: 1.133616, loss_d: 0.400352
Epoch finished! Loss: 1.7200349491376143
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.534885, loss_ss: 1.015857, loss_d: 0.519028
0.0384 --- loss: 1.959867, loss_ss: 1.389092, loss_d: 0.570775
0.0769 --- loss: 1.441432, loss_ss: 0.901353, loss_d: 0.540079
0.1153 --- loss: 1.436883, loss_ss: 0.997160, loss_d: 0.439723
0.1538 --- loss: 1.328060, loss_ss: 0.876857, loss_d: 0.451203
0.1922 --- loss: 1.827802, loss_ss: 1.370631, loss_d: 0.457171
0.2307 --- loss: 1.597973, loss_ss: 1.186963, loss_d: 0.411010
0.2691 --- loss: 1.375177, loss_ss: 0.944127, loss_d: 0.431051
0.3076 --- loss: 1.926748, loss_ss: 1.171043, loss_d: 0.755705
0.3460 --- loss: 1.676224, loss_ss: 1.106053, loss_d: 0.570171
0.3845 --- loss: 1.594025, loss_ss: 1.250025, loss_d: 0.344000
0.4229 --- loss: 1.334069, loss_ss: 0.967370, loss_d: 0.366698
0.4614 --- loss: 1.598791, loss_ss: 1.095424, loss_d: 0.503367
0.4998 --- loss: 1.577580, loss_ss: 0.901949, loss_d: 0.675631
0.5383 --- loss: 1.428580, loss_ss: 1.029335, loss_d: 0.399244
0.5767 --- loss: 1.416500, loss_ss: 0.960385, loss_d: 0.456115
0.6151 --- loss: 1.464348, loss_ss: 0.953201, loss_d: 0.511147
0.6536 --- loss: 1.160386, loss_ss: 0.747574, loss_d: 0.412811
0.6920 --- loss: 1.320231, loss_ss: 1.048418, loss_d: 0.271813
0.7305 --- loss: 1.420047, loss_ss: 0.905475, loss_d: 0.514571
0.7689 --- loss: 1.340764, loss_ss: 1.005770, loss_d: 0.334994
0.8074 --- loss: 1.072906, loss_ss: 0.740582, loss_d: 0.332324
0.8458 --- loss: 1.722116, loss_ss: 1.319695, loss_d: 0.402422
0.8843 --- loss: 1.594062, loss_ss: 1.284377, loss_d: 0.309685
0.9227 --- loss: 1.683880, loss_ss: 0.878403, loss_d: 0.805477
0.9612 --- loss: 1.914173, loss_ss: 1.202546, loss_d: 0.711627
0.9996 --- loss: 2.528200, loss_ss: 2.181017, loss_d: 0.347183
Epoch finished! Loss: 1.5918852443878466
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.645062, loss_ss: 1.184005, loss_d: 0.461057
0.0384 --- loss: 1.397398, loss_ss: 0.964107, loss_d: 0.433291
0.0769 --- loss: 1.605025, loss_ss: 0.949693, loss_d: 0.655331
0.1153 --- loss: 1.189933, loss_ss: 0.800976, loss_d: 0.388957
0.1538 --- loss: 1.480400, loss_ss: 0.973730, loss_d: 0.506671
0.1922 --- loss: 1.444155, loss_ss: 0.983527, loss_d: 0.460628
0.2307 --- loss: 1.163359, loss_ss: 0.870631, loss_d: 0.292728
0.2691 --- loss: 2.067544, loss_ss: 1.455852, loss_d: 0.611692
0.3076 --- loss: 1.617961, loss_ss: 0.844070, loss_d: 0.773891
0.3460 --- loss: 1.556904, loss_ss: 0.995081, loss_d: 0.561823
0.3845 --- loss: 1.725453, loss_ss: 0.974970, loss_d: 0.750484
0.4229 --- loss: 1.474079, loss_ss: 0.973802, loss_d: 0.500276
0.4614 --- loss: 1.167702, loss_ss: 0.769919, loss_d: 0.397784
0.4998 --- loss: 0.978969, loss_ss: 0.744833, loss_d: 0.234136
0.5383 --- loss: 1.691291, loss_ss: 1.321341, loss_d: 0.369950
0.5767 --- loss: 1.640613, loss_ss: 0.916829, loss_d: 0.723784
0.6151 --- loss: 1.559085, loss_ss: 0.880004, loss_d: 0.679081
0.6536 --- loss: 1.133214, loss_ss: 0.767110, loss_d: 0.366104
0.6920 --- loss: 1.324305, loss_ss: 0.861310, loss_d: 0.462995
0.7305 --- loss: 1.495990, loss_ss: 0.930234, loss_d: 0.565756
0.7689 --- loss: 1.257881, loss_ss: 0.738690, loss_d: 0.519191
0.8074 --- loss: 1.472064, loss_ss: 0.958614, loss_d: 0.513450
0.8458 --- loss: 1.654628, loss_ss: 0.860109, loss_d: 0.794520
0.8843 --- loss: 1.494346, loss_ss: 1.120960, loss_d: 0.373386
0.9227 --- loss: 1.262399, loss_ss: 0.896741, loss_d: 0.365658
0.9612 --- loss: 1.319219, loss_ss: 0.714238, loss_d: 0.604982
0.9996 --- loss: 2.616966, loss_ss: 2.431580, loss_d: 0.185387
Epoch finished! Loss: 1.5082454438392932
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.523257, loss_ss: 0.772844, loss_d: 0.750414
0.0384 --- loss: 1.263032, loss_ss: 0.999631, loss_d: 0.263402
0.0769 --- loss: 2.033151, loss_ss: 1.299002, loss_d: 0.734149
0.1153 --- loss: 1.476884, loss_ss: 0.862757, loss_d: 0.614127
0.1538 --- loss: 1.724824, loss_ss: 1.041259, loss_d: 0.683565
0.1922 --- loss: 1.528916, loss_ss: 1.062471, loss_d: 0.466445
0.2307 --- loss: 1.661879, loss_ss: 0.933258, loss_d: 0.728622
0.2691 --- loss: 1.721380, loss_ss: 1.053298, loss_d: 0.668082
0.3076 --- loss: 1.521446, loss_ss: 0.837435, loss_d: 0.684011
0.3460 --- loss: 1.803730, loss_ss: 1.084908, loss_d: 0.718822
0.3845 --- loss: 1.510890, loss_ss: 0.907467, loss_d: 0.603423
0.4229 --- loss: 1.122647, loss_ss: 0.656109, loss_d: 0.466538
0.4614 --- loss: 1.052567, loss_ss: 0.616669, loss_d: 0.435898
0.4998 --- loss: 1.068461, loss_ss: 0.705940, loss_d: 0.362520
0.5383 --- loss: 1.313230, loss_ss: 0.901171, loss_d: 0.412059
0.5767 --- loss: 1.804441, loss_ss: 0.970975, loss_d: 0.833466
0.6151 --- loss: 1.147464, loss_ss: 0.714324, loss_d: 0.433140
0.6536 --- loss: 1.597157, loss_ss: 1.253416, loss_d: 0.343742
0.6920 --- loss: 1.045031, loss_ss: 0.649169, loss_d: 0.395862
0.7305 --- loss: 1.189372, loss_ss: 0.785187, loss_d: 0.404185
0.7689 --- loss: 1.512795, loss_ss: 0.847159, loss_d: 0.665636
0.8074 --- loss: 1.742173, loss_ss: 0.786137, loss_d: 0.956036
0.8458 --- loss: 1.785538, loss_ss: 1.337222, loss_d: 0.448317
0.8843 --- loss: 1.046633, loss_ss: 0.743997, loss_d: 0.302636
0.9227 --- loss: 1.313438, loss_ss: 1.019453, loss_d: 0.293985
0.9612 --- loss: 1.283710, loss_ss: 0.823934, loss_d: 0.459776
0.9996 --- loss: 3.294363, loss_ss: 1.307430, loss_d: 1.986933
Epoch finished! Loss: 1.4665671009283798
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.417882, loss_ss: 1.195462, loss_d: 0.222420
0.0384 --- loss: 1.333192, loss_ss: 0.886238, loss_d: 0.446954
0.0769 --- loss: 1.351405, loss_ss: 0.756791, loss_d: 0.594614
0.1153 --- loss: 1.204674, loss_ss: 0.818067, loss_d: 0.386607
0.1538 --- loss: 1.296226, loss_ss: 0.913692, loss_d: 0.382534
0.1922 --- loss: 1.761360, loss_ss: 0.678000, loss_d: 1.083361
0.2307 --- loss: 1.636655, loss_ss: 1.099954, loss_d: 0.536701
0.2691 --- loss: 1.467507, loss_ss: 0.717847, loss_d: 0.749659
0.3076 --- loss: 1.225328, loss_ss: 0.688927, loss_d: 0.536401
0.3460 --- loss: 1.337413, loss_ss: 0.765335, loss_d: 0.572078
0.3845 --- loss: 1.344359, loss_ss: 0.791384, loss_d: 0.552975
0.4229 --- loss: 1.270518, loss_ss: 1.030146, loss_d: 0.240372
0.4614 --- loss: 1.546376, loss_ss: 1.258778, loss_d: 0.287598
0.4998 --- loss: 1.151887, loss_ss: 0.980744, loss_d: 0.171144
0.5383 --- loss: 1.334463, loss_ss: 0.888024, loss_d: 0.446439
0.5767 --- loss: 1.149948, loss_ss: 0.865635, loss_d: 0.284313
0.6151 --- loss: 1.513671, loss_ss: 0.848103, loss_d: 0.665568
0.6536 --- loss: 1.563499, loss_ss: 0.838595, loss_d: 0.724904
0.6920 --- loss: 1.503491, loss_ss: 1.041908, loss_d: 0.461583
0.7305 --- loss: 1.136482, loss_ss: 0.874386, loss_d: 0.262096
0.7689 --- loss: 1.502338, loss_ss: 1.060938, loss_d: 0.441399
0.8074 --- loss: 1.129757, loss_ss: 0.800845, loss_d: 0.328912
0.8458 --- loss: 1.351716, loss_ss: 0.727683, loss_d: 0.624033
0.8843 --- loss: 1.146363, loss_ss: 0.770963, loss_d: 0.375400
0.9227 --- loss: 1.428365, loss_ss: 1.098534, loss_d: 0.329831
0.9612 --- loss: 1.065266, loss_ss: 0.833394, loss_d: 0.231873
0.9996 --- loss: 2.292554, loss_ss: 2.140234, loss_d: 0.152320
Epoch finished! Loss: 1.3573824605116478
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.427566, loss_ss: 0.915593, loss_d: 0.511972
0.0384 --- loss: 1.717553, loss_ss: 0.731772, loss_d: 0.985781
0.0769 --- loss: 0.998141, loss_ss: 0.766161, loss_d: 0.231979
0.1153 --- loss: 1.289520, loss_ss: 0.968928, loss_d: 0.320592
0.1538 --- loss: 1.517017, loss_ss: 1.061633, loss_d: 0.455384
0.1922 --- loss: 1.280891, loss_ss: 0.866670, loss_d: 0.414221
0.2307 --- loss: 1.513927, loss_ss: 1.013603, loss_d: 0.500324
0.2691 --- loss: 1.182972, loss_ss: 0.825080, loss_d: 0.357892
0.3076 --- loss: 1.105479, loss_ss: 0.708688, loss_d: 0.396792
0.3460 --- loss: 1.185308, loss_ss: 0.825277, loss_d: 0.360031
0.3845 --- loss: 1.598137, loss_ss: 1.058881, loss_d: 0.539256
0.4229 --- loss: 1.246002, loss_ss: 0.739219, loss_d: 0.506784
0.4614 --- loss: 1.053795, loss_ss: 0.789627, loss_d: 0.264168
0.4998 --- loss: 0.924795, loss_ss: 0.696730, loss_d: 0.228065
0.5383 --- loss: 1.257928, loss_ss: 0.863348, loss_d: 0.394580
0.5767 --- loss: 1.538796, loss_ss: 1.092744, loss_d: 0.446052
0.6151 --- loss: 0.943125, loss_ss: 0.721884, loss_d: 0.221241
0.6536 --- loss: 1.364624, loss_ss: 1.032935, loss_d: 0.331689
0.6920 --- loss: 1.776222, loss_ss: 1.056108, loss_d: 0.720114
0.7305 --- loss: 1.562666, loss_ss: 1.099407, loss_d: 0.463258
0.7689 --- loss: 1.017767, loss_ss: 0.703225, loss_d: 0.314542
0.8074 --- loss: 1.261015, loss_ss: 0.950872, loss_d: 0.310143
0.8458 --- loss: 1.605752, loss_ss: 0.951144, loss_d: 0.654608
0.8843 --- loss: 1.390939, loss_ss: 1.103987, loss_d: 0.286951
0.9227 --- loss: 0.957595, loss_ss: 0.767509, loss_d: 0.190087
0.9612 --- loss: 1.264725, loss_ss: 0.856411, loss_d: 0.408314
0.9996 --- loss: 3.089050, loss_ss: 2.765704, loss_d: 0.323347
Epoch finished! Loss: 1.3282923118426249
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.324817, loss_ss: 0.927904, loss_d: 0.396913
0.0384 --- loss: 1.146221, loss_ss: 0.703378, loss_d: 0.442843
0.0769 --- loss: 1.086672, loss_ss: 0.846743, loss_d: 0.239929
0.1153 --- loss: 1.595650, loss_ss: 0.833702, loss_d: 0.761948
0.1538 --- loss: 1.476833, loss_ss: 0.936839, loss_d: 0.539994
0.1922 --- loss: 1.580403, loss_ss: 1.301905, loss_d: 0.278498
0.2307 --- loss: 0.916061, loss_ss: 0.749738, loss_d: 0.166323
0.2691 --- loss: 1.317609, loss_ss: 0.764236, loss_d: 0.553373
0.3076 --- loss: 1.399237, loss_ss: 0.854543, loss_d: 0.544695
0.3460 --- loss: 0.875752, loss_ss: 0.567935, loss_d: 0.307817
0.3845 --- loss: 1.352597, loss_ss: 0.803099, loss_d: 0.549498
0.4229 --- loss: 1.134105, loss_ss: 0.862137, loss_d: 0.271968
0.4614 --- loss: 1.377380, loss_ss: 0.971669, loss_d: 0.405711
0.4998 --- loss: 1.289803, loss_ss: 1.027194, loss_d: 0.262609
0.5383 --- loss: 1.450308, loss_ss: 0.901194, loss_d: 0.549113
0.5767 --- loss: 1.281058, loss_ss: 0.892143, loss_d: 0.388914
0.6151 --- loss: 1.533886, loss_ss: 1.080034, loss_d: 0.453852
0.6536 --- loss: 1.687607, loss_ss: 1.181716, loss_d: 0.505891
0.6920 --- loss: 1.300294, loss_ss: 0.810383, loss_d: 0.489911
0.7305 --- loss: 1.208612, loss_ss: 0.930511, loss_d: 0.278101
0.7689 --- loss: 1.225709, loss_ss: 0.943593, loss_d: 0.282116
0.8074 --- loss: 1.566287, loss_ss: 0.721832, loss_d: 0.844455
0.8458 --- loss: 1.419677, loss_ss: 0.701819, loss_d: 0.717858
0.8843 --- loss: 0.898059, loss_ss: 0.625810, loss_d: 0.272249
0.9227 --- loss: 1.258898, loss_ss: 0.912637, loss_d: 0.346261
0.9612 --- loss: 1.906158, loss_ss: 1.409596, loss_d: 0.496562
0.9996 --- loss: 3.326643, loss_ss: 1.322541, loss_d: 2.004103
Epoch finished! Loss: 1.2920819935890344
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.233531, loss_ss: 1.003652, loss_d: 0.229879
0.0384 --- loss: 1.382484, loss_ss: 0.706822, loss_d: 0.675662
0.0769 --- loss: 1.165156, loss_ss: 0.760233, loss_d: 0.404923
0.1153 --- loss: 0.966169, loss_ss: 0.603268, loss_d: 0.362901
0.1538 --- loss: 0.959001, loss_ss: 0.676657, loss_d: 0.282344
0.1922 --- loss: 1.172962, loss_ss: 0.789982, loss_d: 0.382980
0.2307 --- loss: 1.080456, loss_ss: 0.619693, loss_d: 0.460763
0.2691 --- loss: 1.388000, loss_ss: 0.566250, loss_d: 0.821750
0.3076 --- loss: 1.701598, loss_ss: 1.153565, loss_d: 0.548033
0.3460 --- loss: 1.567147, loss_ss: 0.822972, loss_d: 0.744175
0.3845 --- loss: 1.241502, loss_ss: 0.972355, loss_d: 0.269147
0.4229 --- loss: 1.422741, loss_ss: 0.951044, loss_d: 0.471696
0.4614 --- loss: 1.197325, loss_ss: 0.896912, loss_d: 0.300413
0.4998 --- loss: 1.290070, loss_ss: 0.629776, loss_d: 0.660294
0.5383 --- loss: 1.113516, loss_ss: 0.913989, loss_d: 0.199527
0.5767 --- loss: 1.089115, loss_ss: 0.606199, loss_d: 0.482916
0.6151 --- loss: 1.133427, loss_ss: 0.725166, loss_d: 0.408261
0.6536 --- loss: 1.641423, loss_ss: 1.036853, loss_d: 0.604569
0.6920 --- loss: 1.134575, loss_ss: 0.599014, loss_d: 0.535561
0.7305 --- loss: 1.631613, loss_ss: 1.071590, loss_d: 0.560023
0.7689 --- loss: 1.352391, loss_ss: 1.161552, loss_d: 0.190839
0.8074 --- loss: 0.951058, loss_ss: 0.771650, loss_d: 0.179407
0.8458 --- loss: 1.457843, loss_ss: 0.957376, loss_d: 0.500467
0.8843 --- loss: 1.391185, loss_ss: 1.052312, loss_d: 0.338873
0.9227 --- loss: 1.435870, loss_ss: 0.881359, loss_d: 0.554511
0.9612 --- loss: 1.450243, loss_ss: 1.196183, loss_d: 0.254061
0.9996 --- loss: 3.036571, loss_ss: 2.850117, loss_d: 0.186454
Epoch finished! Loss: 1.234907054213377
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.104333, loss_ss: 0.825398, loss_d: 0.278936
0.0384 --- loss: 1.094239, loss_ss: 0.725644, loss_d: 0.368594
0.0769 --- loss: 1.342561, loss_ss: 0.742482, loss_d: 0.600079
0.1153 --- loss: 0.926577, loss_ss: 0.703907, loss_d: 0.222670
0.1538 --- loss: 2.617321, loss_ss: 0.959148, loss_d: 1.658173
0.1922 --- loss: 0.893161, loss_ss: 0.611641, loss_d: 0.281520
0.2307 --- loss: 1.128561, loss_ss: 0.795908, loss_d: 0.332653
0.2691 --- loss: 1.116444, loss_ss: 0.843664, loss_d: 0.272781
0.3076 --- loss: 1.283388, loss_ss: 1.064896, loss_d: 0.218492
0.3460 --- loss: 1.275028, loss_ss: 1.060073, loss_d: 0.214955
0.3845 --- loss: 1.194793, loss_ss: 0.894435, loss_d: 0.300359
0.4229 --- loss: 1.220576, loss_ss: 0.955572, loss_d: 0.265004
0.4614 --- loss: 1.059059, loss_ss: 0.691172, loss_d: 0.367887
0.4998 --- loss: 1.692129, loss_ss: 0.983900, loss_d: 0.708229
0.5383 --- loss: 1.504611, loss_ss: 0.812973, loss_d: 0.691637
0.5767 --- loss: 1.810163, loss_ss: 1.514179, loss_d: 0.295984
0.6151 --- loss: 1.226077, loss_ss: 1.020931, loss_d: 0.205146
0.6536 --- loss: 0.753177, loss_ss: 0.565197, loss_d: 0.187981
0.6920 --- loss: 1.171810, loss_ss: 1.001643, loss_d: 0.170166
0.7305 --- loss: 1.146086, loss_ss: 0.691465, loss_d: 0.454620
0.7689 --- loss: 0.891818, loss_ss: 0.725762, loss_d: 0.166056
0.8074 --- loss: 1.185979, loss_ss: 0.871349, loss_d: 0.314630
0.8458 --- loss: 1.809932, loss_ss: 1.012536, loss_d: 0.797396
0.8843 --- loss: 1.287867, loss_ss: 0.973226, loss_d: 0.314640
0.9227 --- loss: 0.937143, loss_ss: 0.742694, loss_d: 0.194449
0.9612 --- loss: 1.167368, loss_ss: 0.927104, loss_d: 0.240264
0.9996 --- loss: 3.525034, loss_ss: 1.504908, loss_d: 2.020126
Epoch finished! Loss: 1.2124552609828803
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5882882882882883
             precision    recall  f1-score   support

        0.0       0.85      0.26      0.40       211
        1.0       1.00      0.01      0.01       184
        2.0       0.75      0.85      0.80       408
        3.0       0.62      0.75      0.68       130
        4.0       0.36      0.87      0.51       177

avg / total       0.73      0.59      0.53      1110
 


====== chp055-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.05  26.07   98.89   84.62     39.86
1  83.51   0.54  100.00  100.00      1.08
2  84.05  84.56   83.76   75.16     79.58
3  91.71  75.38   93.88   62.03     68.06
4  73.33  87.01   70.74   36.07     50.99
Total accuracy: 58.83%
Average sen: 54.71%
Average spec: 89.45%
Macro f1-score: 47.91%
[0.42293033 0.96640998 0.94688153 0.7834146  0.82143986 0.60568136
 0.409881   0.8593843  0.55273086 0.92217416 0.93927532 0.97277969
 0.95283425 0.89898127 0.87170309 0.83528054 0.2650986  0.71396846
 0.73907322 0.28085068 0.35389268 0.85595912 0.83441693 0.70460945
 0.73595363 0.41039392 0.36814952 0.04508726 0.80680352 0.96180785
 0.51723015 0.0715965  0.70359701 0.75639296 0.42577198 0.71113658
 0.58578509]
pred: 0.6651177632848959, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.297833, loss_ss: 1.546829, loss_d: 0.751004
0.0384 --- loss: 1.873078, loss_ss: 1.366795, loss_d: 0.506283
0.0769 --- loss: 1.955949, loss_ss: 1.403405, loss_d: 0.552544
0.1153 --- loss: 1.910501, loss_ss: 1.363817, loss_d: 0.546683
0.1537 --- loss: 1.910401, loss_ss: 1.339224, loss_d: 0.571178
0.1922 --- loss: 1.829201, loss_ss: 1.473046, loss_d: 0.356156
0.2306 --- loss: 2.393727, loss_ss: 1.404700, loss_d: 0.989027
0.2690 --- loss: 2.088106, loss_ss: 1.378424, loss_d: 0.709682
0.3075 --- loss: 2.052056, loss_ss: 1.445849, loss_d: 0.606208
0.3459 --- loss: 1.774568, loss_ss: 1.386693, loss_d: 0.387875
0.3843 --- loss: 1.882446, loss_ss: 1.293541, loss_d: 0.588905
0.4228 --- loss: 1.842334, loss_ss: 1.299930, loss_d: 0.542404
0.4612 --- loss: 1.789105, loss_ss: 1.411098, loss_d: 0.378007
0.4996 --- loss: 1.460652, loss_ss: 1.145700, loss_d: 0.314952
0.5380 --- loss: 1.870595, loss_ss: 1.166414, loss_d: 0.704181
0.5765 --- loss: 2.073015, loss_ss: 1.416957, loss_d: 0.656058
0.6149 --- loss: 1.715921, loss_ss: 1.136470, loss_d: 0.579450
0.6533 --- loss: 1.642550, loss_ss: 1.120407, loss_d: 0.522143
0.6918 --- loss: 1.989753, loss_ss: 1.458053, loss_d: 0.531700
0.7302 --- loss: 1.939017, loss_ss: 1.238649, loss_d: 0.700368
0.7686 --- loss: 1.886078, loss_ss: 1.343528, loss_d: 0.542550
0.8071 --- loss: 1.868995, loss_ss: 1.206102, loss_d: 0.662892
0.8455 --- loss: 1.866018, loss_ss: 1.301915, loss_d: 0.564103
0.8839 --- loss: 1.979633, loss_ss: 1.459036, loss_d: 0.520597
0.9224 --- loss: 1.654309, loss_ss: 1.225486, loss_d: 0.428823
0.9608 --- loss: 1.994917, loss_ss: 1.553501, loss_d: 0.441416
0.9992 --- loss: 2.506584, loss_ss: 1.309698, loss_d: 1.196886
Epoch finished! Loss: 1.9535230893355149
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.026548, loss_ss: 1.450160, loss_d: 0.576387
0.0384 --- loss: 1.888438, loss_ss: 1.236934, loss_d: 0.651504
0.0769 --- loss: 1.797269, loss_ss: 1.340166, loss_d: 0.457103
0.1153 --- loss: 1.413957, loss_ss: 1.111526, loss_d: 0.302431
0.1537 --- loss: 1.992952, loss_ss: 1.214233, loss_d: 0.778719
0.1922 --- loss: 1.732508, loss_ss: 1.334769, loss_d: 0.397739
0.2306 --- loss: 1.937435, loss_ss: 1.396114, loss_d: 0.541321
0.2690 --- loss: 1.637863, loss_ss: 1.171092, loss_d: 0.466771
0.3075 --- loss: 1.861983, loss_ss: 1.374114, loss_d: 0.487869
0.3459 --- loss: 1.905164, loss_ss: 1.181793, loss_d: 0.723371
0.3843 --- loss: 1.577188, loss_ss: 1.038726, loss_d: 0.538463
0.4228 --- loss: 1.910441, loss_ss: 1.209616, loss_d: 0.700825
0.4612 --- loss: 1.906342, loss_ss: 1.057477, loss_d: 0.848865
0.4996 --- loss: 1.743274, loss_ss: 1.137747, loss_d: 0.605527
0.5380 --- loss: 1.711835, loss_ss: 1.178991, loss_d: 0.532844
0.5765 --- loss: 2.068209, loss_ss: 1.457346, loss_d: 0.610863
0.6149 --- loss: 1.709348, loss_ss: 1.102652, loss_d: 0.606696
0.6533 --- loss: 1.388467, loss_ss: 0.939776, loss_d: 0.448690
0.6918 --- loss: 1.587576, loss_ss: 1.022612, loss_d: 0.564964
0.7302 --- loss: 1.621615, loss_ss: 1.186512, loss_d: 0.435103
0.7686 --- loss: 1.895873, loss_ss: 1.015338, loss_d: 0.880535
0.8071 --- loss: 1.552747, loss_ss: 0.988449, loss_d: 0.564299
0.8455 --- loss: 1.459732, loss_ss: 0.987346, loss_d: 0.472386
0.8839 --- loss: 2.203362, loss_ss: 1.077187, loss_d: 1.126176
0.9224 --- loss: 1.927845, loss_ss: 1.152013, loss_d: 0.775831
0.9608 --- loss: 1.170615, loss_ss: 0.799116, loss_d: 0.371499
0.9992 --- loss: 1.169245, loss_ss: 0.945418, loss_d: 0.223827
Epoch finished! Loss: 1.7274464235855982
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.741169, loss_ss: 0.978122, loss_d: 0.763047
0.0384 --- loss: 1.718931, loss_ss: 1.000784, loss_d: 0.718147
0.0769 --- loss: 1.789931, loss_ss: 1.012273, loss_d: 0.777658
0.1153 --- loss: 1.334416, loss_ss: 0.889197, loss_d: 0.445219
0.1537 --- loss: 1.377778, loss_ss: 0.850872, loss_d: 0.526906
0.1922 --- loss: 1.802417, loss_ss: 0.989058, loss_d: 0.813359
0.2306 --- loss: 1.479068, loss_ss: 1.007002, loss_d: 0.472066
0.2690 --- loss: 1.490319, loss_ss: 1.024717, loss_d: 0.465602
0.3075 --- loss: 1.705963, loss_ss: 0.750250, loss_d: 0.955713
0.3459 --- loss: 1.575384, loss_ss: 1.119870, loss_d: 0.455514
0.3843 --- loss: 1.239666, loss_ss: 0.806612, loss_d: 0.433055
0.4228 --- loss: 1.440622, loss_ss: 1.003522, loss_d: 0.437100
0.4612 --- loss: 1.586345, loss_ss: 0.866678, loss_d: 0.719666
0.4996 --- loss: 1.598044, loss_ss: 1.144692, loss_d: 0.453352
0.5380 --- loss: 1.557821, loss_ss: 0.898220, loss_d: 0.659601
0.5765 --- loss: 1.365774, loss_ss: 0.840122, loss_d: 0.525652
0.6149 --- loss: 1.742963, loss_ss: 1.241216, loss_d: 0.501746
0.6533 --- loss: 1.633080, loss_ss: 1.039126, loss_d: 0.593954
0.6918 --- loss: 1.508442, loss_ss: 0.880781, loss_d: 0.627661
0.7302 --- loss: 2.033545, loss_ss: 1.226935, loss_d: 0.806611
0.7686 --- loss: 1.469000, loss_ss: 0.829379, loss_d: 0.639621
0.8071 --- loss: 1.462446, loss_ss: 0.993287, loss_d: 0.469159
0.8455 --- loss: 1.316057, loss_ss: 0.919838, loss_d: 0.396219
0.8839 --- loss: 1.304413, loss_ss: 0.723989, loss_d: 0.580424
0.9224 --- loss: 1.563477, loss_ss: 0.919915, loss_d: 0.643562
0.9608 --- loss: 1.284546, loss_ss: 0.843064, loss_d: 0.441482
0.9992 --- loss: 1.674026, loss_ss: 0.985682, loss_d: 0.688345
Epoch finished! Loss: 1.5876298212088071
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.505009, loss_ss: 1.006577, loss_d: 0.498432
0.0384 --- loss: 1.363508, loss_ss: 0.862295, loss_d: 0.501214
0.0769 --- loss: 1.433937, loss_ss: 0.810288, loss_d: 0.623649
0.1153 --- loss: 1.546207, loss_ss: 1.099075, loss_d: 0.447132
0.1537 --- loss: 1.489379, loss_ss: 1.102162, loss_d: 0.387217
0.1922 --- loss: 1.492834, loss_ss: 1.062783, loss_d: 0.430051
0.2306 --- loss: 1.574176, loss_ss: 0.939416, loss_d: 0.634760
0.2690 --- loss: 1.610981, loss_ss: 0.953181, loss_d: 0.657800
0.3075 --- loss: 1.511340, loss_ss: 1.014902, loss_d: 0.496438
0.3459 --- loss: 1.380064, loss_ss: 0.966680, loss_d: 0.413384
0.3843 --- loss: 1.725904, loss_ss: 0.848113, loss_d: 0.877790
0.4228 --- loss: 1.508324, loss_ss: 0.923673, loss_d: 0.584652
0.4612 --- loss: 1.627188, loss_ss: 1.092354, loss_d: 0.534834
0.4996 --- loss: 1.189016, loss_ss: 0.748355, loss_d: 0.440661
0.5380 --- loss: 1.287014, loss_ss: 0.718596, loss_d: 0.568418
0.5765 --- loss: 1.367323, loss_ss: 0.972789, loss_d: 0.394534
0.6149 --- loss: 1.484232, loss_ss: 1.119877, loss_d: 0.364355
0.6533 --- loss: 1.242482, loss_ss: 0.972046, loss_d: 0.270437
0.6918 --- loss: 1.580900, loss_ss: 0.915582, loss_d: 0.665318
0.7302 --- loss: 1.705218, loss_ss: 0.857770, loss_d: 0.847448
0.7686 --- loss: 1.616102, loss_ss: 1.099991, loss_d: 0.516111
0.8071 --- loss: 1.237751, loss_ss: 0.813111, loss_d: 0.424640
0.8455 --- loss: 1.906609, loss_ss: 1.117680, loss_d: 0.788929
0.8839 --- loss: 1.123473, loss_ss: 0.773283, loss_d: 0.350190
0.9224 --- loss: 1.305997, loss_ss: 0.916994, loss_d: 0.389003
0.9608 --- loss: 1.596258, loss_ss: 1.090501, loss_d: 0.505757
0.9992 --- loss: 1.660159, loss_ss: 1.062977, loss_d: 0.597182
Epoch finished! Loss: 1.5276989702995007
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.445188, loss_ss: 0.961778, loss_d: 0.483411
0.0384 --- loss: 1.602978, loss_ss: 1.112716, loss_d: 0.490262
0.0769 --- loss: 1.592851, loss_ss: 1.244130, loss_d: 0.348721
0.1153 --- loss: 1.304913, loss_ss: 0.945420, loss_d: 0.359493
0.1537 --- loss: 1.496189, loss_ss: 0.948303, loss_d: 0.547886
0.1922 --- loss: 1.671377, loss_ss: 1.062512, loss_d: 0.608865
0.2306 --- loss: 1.578508, loss_ss: 1.182266, loss_d: 0.396243
0.2690 --- loss: 1.310156, loss_ss: 0.821992, loss_d: 0.488164
0.3075 --- loss: 1.293213, loss_ss: 0.798988, loss_d: 0.494225
0.3459 --- loss: 1.393387, loss_ss: 0.840301, loss_d: 0.553086
0.3843 --- loss: 1.694399, loss_ss: 1.050988, loss_d: 0.643410
0.4228 --- loss: 2.055448, loss_ss: 0.847852, loss_d: 1.207596
0.4612 --- loss: 1.191219, loss_ss: 0.888022, loss_d: 0.303197
0.4996 --- loss: 1.772903, loss_ss: 1.174177, loss_d: 0.598726
0.5380 --- loss: 1.546769, loss_ss: 0.874665, loss_d: 0.672104
0.5765 --- loss: 1.826825, loss_ss: 1.114990, loss_d: 0.711835
0.6149 --- loss: 1.715232, loss_ss: 1.207097, loss_d: 0.508136
0.6533 --- loss: 0.940808, loss_ss: 0.627825, loss_d: 0.312983
0.6918 --- loss: 1.043802, loss_ss: 0.776421, loss_d: 0.267381
0.7302 --- loss: 1.334028, loss_ss: 0.874812, loss_d: 0.459216
0.7686 --- loss: 1.345575, loss_ss: 0.811054, loss_d: 0.534522
0.8071 --- loss: 1.532903, loss_ss: 0.867645, loss_d: 0.665259
0.8455 --- loss: 1.384050, loss_ss: 0.982839, loss_d: 0.401211
0.8839 --- loss: 1.727871, loss_ss: 0.746276, loss_d: 0.981595
0.9224 --- loss: 1.489754, loss_ss: 1.012710, loss_d: 0.477044
0.9608 --- loss: 1.448505, loss_ss: 0.848139, loss_d: 0.600366
0.9992 --- loss: 1.448093, loss_ss: 1.149488, loss_d: 0.298604
Epoch finished! Loss: 1.4593496659627327
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.423902, loss_ss: 0.875382, loss_d: 0.548520
0.0384 --- loss: 1.479375, loss_ss: 0.772577, loss_d: 0.706798
0.0769 --- loss: 1.137709, loss_ss: 0.966035, loss_d: 0.171673
0.1153 --- loss: 1.482646, loss_ss: 0.821854, loss_d: 0.660792
0.1537 --- loss: 1.072139, loss_ss: 0.835945, loss_d: 0.236194
0.1922 --- loss: 1.545379, loss_ss: 1.024750, loss_d: 0.520629
0.2306 --- loss: 1.451495, loss_ss: 1.030480, loss_d: 0.421015
0.2690 --- loss: 0.923338, loss_ss: 0.687934, loss_d: 0.235404
0.3075 --- loss: 1.294794, loss_ss: 1.029979, loss_d: 0.264815
0.3459 --- loss: 1.116954, loss_ss: 0.898356, loss_d: 0.218598
0.3843 --- loss: 1.165089, loss_ss: 0.999800, loss_d: 0.165290
0.4228 --- loss: 1.352950, loss_ss: 1.033199, loss_d: 0.319751
0.4612 --- loss: 1.066125, loss_ss: 0.811252, loss_d: 0.254873
0.4996 --- loss: 1.568425, loss_ss: 0.996000, loss_d: 0.572426
0.5380 --- loss: 1.573079, loss_ss: 1.094230, loss_d: 0.478848
0.5765 --- loss: 1.301784, loss_ss: 0.905829, loss_d: 0.395955
0.6149 --- loss: 1.386861, loss_ss: 0.912166, loss_d: 0.474695
0.6533 --- loss: 1.423359, loss_ss: 0.815008, loss_d: 0.608351
0.6918 --- loss: 1.703272, loss_ss: 0.989149, loss_d: 0.714123
0.7302 --- loss: 1.498213, loss_ss: 0.832489, loss_d: 0.665724
0.7686 --- loss: 1.334325, loss_ss: 0.847111, loss_d: 0.487214
0.8071 --- loss: 1.751299, loss_ss: 1.130417, loss_d: 0.620883
0.8455 --- loss: 0.963858, loss_ss: 0.731509, loss_d: 0.232349
0.8839 --- loss: 1.087971, loss_ss: 0.900693, loss_d: 0.187278
0.9224 --- loss: 1.944474, loss_ss: 0.946802, loss_d: 0.997672
0.9608 --- loss: 1.598857, loss_ss: 1.244751, loss_d: 0.354106
0.9992 --- loss: 2.677077, loss_ss: 0.950316, loss_d: 1.726762
Epoch finished! Loss: 1.3550201191351965
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.422644, loss_ss: 0.844841, loss_d: 0.577803
0.0384 --- loss: 1.570966, loss_ss: 1.166071, loss_d: 0.404895
0.0769 --- loss: 1.213874, loss_ss: 1.054962, loss_d: 0.158912
0.1153 --- loss: 1.030340, loss_ss: 0.701190, loss_d: 0.329150
0.1537 --- loss: 1.257689, loss_ss: 0.988471, loss_d: 0.269218
0.1922 --- loss: 1.617642, loss_ss: 1.012471, loss_d: 0.605171
0.2306 --- loss: 1.196507, loss_ss: 0.921536, loss_d: 0.274972
0.2690 --- loss: 1.489276, loss_ss: 0.790429, loss_d: 0.698847
0.3075 --- loss: 1.058506, loss_ss: 0.755165, loss_d: 0.303341
0.3459 --- loss: 1.201246, loss_ss: 0.618475, loss_d: 0.582770
0.3843 --- loss: 1.772852, loss_ss: 1.220264, loss_d: 0.552587
0.4228 --- loss: 1.327309, loss_ss: 0.869025, loss_d: 0.458284
0.4612 --- loss: 1.544373, loss_ss: 1.289881, loss_d: 0.254492
0.4996 --- loss: 1.030400, loss_ss: 0.736708, loss_d: 0.293692
0.5380 --- loss: 1.328858, loss_ss: 0.893208, loss_d: 0.435649
0.5765 --- loss: 1.339483, loss_ss: 0.924578, loss_d: 0.414904
0.6149 --- loss: 1.173353, loss_ss: 0.980981, loss_d: 0.192371
0.6533 --- loss: 1.135552, loss_ss: 0.719573, loss_d: 0.415979
0.6918 --- loss: 1.271995, loss_ss: 0.732762, loss_d: 0.539233
0.7302 --- loss: 1.732831, loss_ss: 0.924333, loss_d: 0.808498
0.7686 --- loss: 1.300921, loss_ss: 0.756293, loss_d: 0.544628
0.8071 --- loss: 1.332609, loss_ss: 0.927956, loss_d: 0.404653
0.8455 --- loss: 1.497254, loss_ss: 0.956749, loss_d: 0.540506
0.8839 --- loss: 1.559259, loss_ss: 0.854707, loss_d: 0.704551
0.9224 --- loss: 1.349479, loss_ss: 1.131947, loss_d: 0.217532
0.9608 --- loss: 1.645340, loss_ss: 0.942028, loss_d: 0.703312
0.9992 --- loss: 1.638765, loss_ss: 1.341284, loss_d: 0.297481
Epoch finished! Loss: 1.2976481758631193
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.144942, loss_ss: 0.882162, loss_d: 0.262780
0.0384 --- loss: 1.345638, loss_ss: 0.952711, loss_d: 0.392927
0.0769 --- loss: 1.392945, loss_ss: 0.881283, loss_d: 0.511662
0.1153 --- loss: 1.063947, loss_ss: 0.755230, loss_d: 0.308717
0.1537 --- loss: 1.227686, loss_ss: 0.868842, loss_d: 0.358844
0.1922 --- loss: 1.261136, loss_ss: 1.086271, loss_d: 0.174864
0.2306 --- loss: 1.410883, loss_ss: 0.858881, loss_d: 0.552002
0.2690 --- loss: 0.910732, loss_ss: 0.652334, loss_d: 0.258398
0.3075 --- loss: 1.103439, loss_ss: 0.620015, loss_d: 0.483424
0.3459 --- loss: 1.209627, loss_ss: 0.848787, loss_d: 0.360840
0.3843 --- loss: 1.079732, loss_ss: 0.805451, loss_d: 0.274281
0.4228 --- loss: 0.970026, loss_ss: 0.707245, loss_d: 0.262781
0.4612 --- loss: 1.232435, loss_ss: 0.853436, loss_d: 0.378999
0.4996 --- loss: 1.459121, loss_ss: 1.145795, loss_d: 0.313326
0.5380 --- loss: 0.957845, loss_ss: 0.801135, loss_d: 0.156710
0.5765 --- loss: 1.172511, loss_ss: 0.828489, loss_d: 0.344022
0.6149 --- loss: 1.257573, loss_ss: 0.819496, loss_d: 0.438077
0.6533 --- loss: 1.353333, loss_ss: 0.871038, loss_d: 0.482294
0.6918 --- loss: 1.098333, loss_ss: 0.783141, loss_d: 0.315192
0.7302 --- loss: 1.047511, loss_ss: 0.706895, loss_d: 0.340615
0.7686 --- loss: 0.931764, loss_ss: 0.719819, loss_d: 0.211945
0.8071 --- loss: 0.971505, loss_ss: 0.829792, loss_d: 0.141713
0.8455 --- loss: 1.723171, loss_ss: 1.189261, loss_d: 0.533909
0.8839 --- loss: 1.811729, loss_ss: 1.277805, loss_d: 0.533924
0.9224 --- loss: 1.240754, loss_ss: 0.934980, loss_d: 0.305774
0.9608 --- loss: 1.317015, loss_ss: 0.874729, loss_d: 0.442286
0.9992 --- loss: 2.239237, loss_ss: 1.488346, loss_d: 0.750890
Epoch finished! Loss: 1.2941223960656387
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.316402, loss_ss: 0.842888, loss_d: 0.473513
0.0384 --- loss: 1.031498, loss_ss: 0.752581, loss_d: 0.278918
0.0769 --- loss: 1.819560, loss_ss: 0.858967, loss_d: 0.960594
0.1153 --- loss: 1.233982, loss_ss: 0.882261, loss_d: 0.351721
0.1537 --- loss: 1.132951, loss_ss: 0.803552, loss_d: 0.329399
0.1922 --- loss: 1.536638, loss_ss: 1.299277, loss_d: 0.237362
0.2306 --- loss: 0.984798, loss_ss: 0.870734, loss_d: 0.114064
0.2690 --- loss: 0.895872, loss_ss: 0.648960, loss_d: 0.246913
0.3075 --- loss: 1.568449, loss_ss: 0.719860, loss_d: 0.848589
0.3459 --- loss: 1.251954, loss_ss: 1.095133, loss_d: 0.156821
0.3843 --- loss: 0.837234, loss_ss: 0.611674, loss_d: 0.225559
0.4228 --- loss: 1.266626, loss_ss: 0.866656, loss_d: 0.399970
0.4612 --- loss: 1.027856, loss_ss: 0.845759, loss_d: 0.182098
0.4996 --- loss: 1.017893, loss_ss: 0.757463, loss_d: 0.260430
0.5380 --- loss: 1.259493, loss_ss: 0.968248, loss_d: 0.291246
0.5765 --- loss: 1.031628, loss_ss: 0.850754, loss_d: 0.180873
0.6149 --- loss: 1.092111, loss_ss: 0.632599, loss_d: 0.459512
0.6533 --- loss: 1.587534, loss_ss: 0.856399, loss_d: 0.731135
0.6918 --- loss: 0.942714, loss_ss: 0.755111, loss_d: 0.187602
0.7302 --- loss: 1.238736, loss_ss: 0.989250, loss_d: 0.249486
0.7686 --- loss: 1.506103, loss_ss: 0.902421, loss_d: 0.603682
0.8071 --- loss: 1.073423, loss_ss: 0.889934, loss_d: 0.183489
0.8455 --- loss: 0.806242, loss_ss: 0.543029, loss_d: 0.263213
0.8839 --- loss: 1.093470, loss_ss: 0.881758, loss_d: 0.211712
0.9224 --- loss: 0.873271, loss_ss: 0.610013, loss_d: 0.263258
0.9608 --- loss: 1.039015, loss_ss: 0.883191, loss_d: 0.155824
0.9992 --- loss: 0.701201, loss_ss: 0.535268, loss_d: 0.165934
Epoch finished! Loss: 1.238591992855072
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.061692, loss_ss: 0.669398, loss_d: 0.392294
0.0384 --- loss: 0.907208, loss_ss: 0.648155, loss_d: 0.259053
0.0769 --- loss: 1.293517, loss_ss: 0.666689, loss_d: 0.626828
0.1153 --- loss: 0.976483, loss_ss: 0.717689, loss_d: 0.258794
0.1537 --- loss: 1.516844, loss_ss: 0.835045, loss_d: 0.681799
0.1922 --- loss: 1.049981, loss_ss: 0.744390, loss_d: 0.305591
0.2306 --- loss: 1.341300, loss_ss: 0.840126, loss_d: 0.501174
0.2690 --- loss: 0.960971, loss_ss: 0.642800, loss_d: 0.318171
0.3075 --- loss: 1.850503, loss_ss: 1.098000, loss_d: 0.752503
0.3459 --- loss: 1.962907, loss_ss: 1.269146, loss_d: 0.693761
0.3843 --- loss: 1.474249, loss_ss: 1.198153, loss_d: 0.276097
0.4228 --- loss: 1.296605, loss_ss: 1.032872, loss_d: 0.263733
0.4612 --- loss: 1.142882, loss_ss: 0.504377, loss_d: 0.638505
0.4996 --- loss: 1.467816, loss_ss: 1.022287, loss_d: 0.445529
0.5380 --- loss: 1.016126, loss_ss: 0.764989, loss_d: 0.251137
0.5765 --- loss: 1.183329, loss_ss: 0.742096, loss_d: 0.441233
0.6149 --- loss: 0.913979, loss_ss: 0.656911, loss_d: 0.257068
0.6533 --- loss: 1.083425, loss_ss: 0.962184, loss_d: 0.121241
0.6918 --- loss: 1.187850, loss_ss: 0.880507, loss_d: 0.307342
0.7302 --- loss: 1.964117, loss_ss: 1.572298, loss_d: 0.391819
0.7686 --- loss: 1.085575, loss_ss: 0.675144, loss_d: 0.410431
0.8071 --- loss: 1.250462, loss_ss: 0.681532, loss_d: 0.568931
0.8455 --- loss: 1.049178, loss_ss: 0.843325, loss_d: 0.205853
0.8839 --- loss: 1.142631, loss_ss: 0.974421, loss_d: 0.168211
0.9224 --- loss: 1.075368, loss_ss: 0.747871, loss_d: 0.327497
0.9608 --- loss: 1.355525, loss_ss: 0.648466, loss_d: 0.707059
0.9992 --- loss: 0.974944, loss_ss: 0.856319, loss_d: 0.118625
Epoch finished! Loss: 1.2401244693077527
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5166666666666667
             precision    recall  f1-score   support

        0.0       0.20      0.77      0.32        78
        1.0       0.55      0.08      0.15       284
        2.0       0.49      0.88      0.63       258
        3.0       0.92      0.99      0.96       185
        4.0       0.83      0.23      0.36       275

avg / total       0.64      0.52      0.47      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  76.57  76.92   76.55  20.34     32.17
1  74.07   8.45   97.49  54.55     14.63
2  75.00  87.98   70.92  48.71     62.71
3  98.43  98.92   98.32  92.42     95.56
4  79.26  23.27   98.39  83.12     36.36
Total accuracy: 51.67%
Average sen: 59.11%
Average spec: 88.33%
Macro f1-score: 48.29%
[0.3674981  0.33552283 0.94840604 0.95061374 0.93218583 0.23467216
 0.13296872 0.52305698 0.6972447  0.3969093  0.67974389 0.79404944
 0.59847873 0.43522903 0.13970187 0.52437568 0.17464659 0.51637518
 0.365035   0.36813271 0.193812   0.21644035 0.3622646  0.84423888
 0.84996009 0.94462156 0.82934779 0.5760287  0.63786739 0.41315696
 0.63472712 0.87505609 0.91283941 0.64599329 0.20302285 0.39505124]
pred: 0.5458131904403368, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.358052, loss_ss: 1.687392, loss_d: 0.670660
0.0385 --- loss: 2.683028, loss_ss: 1.558738, loss_d: 1.124290
0.0770 --- loss: 2.142786, loss_ss: 1.568160, loss_d: 0.574626
0.1154 --- loss: 2.045338, loss_ss: 1.562651, loss_d: 0.482687
0.1539 --- loss: 2.334791, loss_ss: 1.342273, loss_d: 0.992518
0.1924 --- loss: 2.023103, loss_ss: 1.456182, loss_d: 0.566920
0.2309 --- loss: 2.000150, loss_ss: 1.385345, loss_d: 0.614805
0.2693 --- loss: 2.059369, loss_ss: 1.428655, loss_d: 0.630713
0.3078 --- loss: 1.884263, loss_ss: 1.400146, loss_d: 0.484117
0.3463 --- loss: 2.101148, loss_ss: 1.376833, loss_d: 0.724315
0.3848 --- loss: 2.235748, loss_ss: 1.711227, loss_d: 0.524521
0.4232 --- loss: 1.810601, loss_ss: 1.179206, loss_d: 0.631394
0.4617 --- loss: 1.822165, loss_ss: 1.301515, loss_d: 0.520650
0.5002 --- loss: 1.887230, loss_ss: 1.413944, loss_d: 0.473286
0.5387 --- loss: 1.685517, loss_ss: 1.334095, loss_d: 0.351422
0.5771 --- loss: 1.910008, loss_ss: 1.323652, loss_d: 0.586356
0.6156 --- loss: 1.831654, loss_ss: 1.220495, loss_d: 0.611159
0.6541 --- loss: 1.974505, loss_ss: 1.505317, loss_d: 0.469189
0.6926 --- loss: 1.819281, loss_ss: 1.326870, loss_d: 0.492411
0.7311 --- loss: 1.775662, loss_ss: 1.121410, loss_d: 0.654252
0.7695 --- loss: 1.797802, loss_ss: 1.302608, loss_d: 0.495194
0.8080 --- loss: 2.031530, loss_ss: 1.312683, loss_d: 0.718847
0.8465 --- loss: 1.905686, loss_ss: 1.096014, loss_d: 0.809672
0.8850 --- loss: 1.803524, loss_ss: 1.384765, loss_d: 0.418760
0.9234 --- loss: 1.702131, loss_ss: 1.261956, loss_d: 0.440175
0.9619 --- loss: 1.630287, loss_ss: 1.240851, loss_d: 0.389436
Epoch finished! Loss: 1.9751466636952286
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.611428, loss_ss: 1.169112, loss_d: 0.442316
0.0385 --- loss: 2.096919, loss_ss: 1.199285, loss_d: 0.897634
0.0770 --- loss: 1.600955, loss_ss: 1.168792, loss_d: 0.432163
0.1154 --- loss: 1.890633, loss_ss: 1.136028, loss_d: 0.754604
0.1539 --- loss: 1.642121, loss_ss: 1.012687, loss_d: 0.629433
0.1924 --- loss: 1.712976, loss_ss: 1.270222, loss_d: 0.442753
0.2309 --- loss: 1.687877, loss_ss: 1.024531, loss_d: 0.663346
0.2693 --- loss: 1.503879, loss_ss: 1.086867, loss_d: 0.417012
0.3078 --- loss: 1.995451, loss_ss: 1.176329, loss_d: 0.819122
0.3463 --- loss: 1.652430, loss_ss: 1.054053, loss_d: 0.598378
0.3848 --- loss: 1.591686, loss_ss: 1.181856, loss_d: 0.409830
0.4232 --- loss: 1.590690, loss_ss: 1.111036, loss_d: 0.479654
0.4617 --- loss: 1.842478, loss_ss: 1.376354, loss_d: 0.466124
0.5002 --- loss: 1.676304, loss_ss: 0.991683, loss_d: 0.684621
0.5387 --- loss: 1.620649, loss_ss: 1.072351, loss_d: 0.548297
0.5771 --- loss: 1.662772, loss_ss: 1.176022, loss_d: 0.486750
0.6156 --- loss: 1.688970, loss_ss: 1.197865, loss_d: 0.491105
0.6541 --- loss: 1.760107, loss_ss: 1.178182, loss_d: 0.581926
0.6926 --- loss: 1.797157, loss_ss: 1.168489, loss_d: 0.628668
0.7311 --- loss: 1.841209, loss_ss: 0.981912, loss_d: 0.859297
0.7695 --- loss: 1.763942, loss_ss: 1.115761, loss_d: 0.648182
0.8080 --- loss: 1.983305, loss_ss: 1.214178, loss_d: 0.769127
0.8465 --- loss: 1.487756, loss_ss: 1.017441, loss_d: 0.470315
0.8850 --- loss: 1.461256, loss_ss: 0.950410, loss_d: 0.510845
0.9234 --- loss: 1.923506, loss_ss: 1.287557, loss_d: 0.635948
0.9619 --- loss: 1.642631, loss_ss: 1.064997, loss_d: 0.577634
Epoch finished! Loss: 1.7300901495812022
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.823046, loss_ss: 1.206088, loss_d: 0.616957
0.0385 --- loss: 1.733386, loss_ss: 1.010347, loss_d: 0.723039
0.0770 --- loss: 1.528752, loss_ss: 1.036867, loss_d: 0.491885
0.1154 --- loss: 1.856826, loss_ss: 1.086792, loss_d: 0.770034
0.1539 --- loss: 1.778857, loss_ss: 1.131204, loss_d: 0.647653
0.1924 --- loss: 1.514855, loss_ss: 0.935813, loss_d: 0.579042
0.2309 --- loss: 1.327472, loss_ss: 0.904584, loss_d: 0.422888
0.2693 --- loss: 1.344518, loss_ss: 0.852343, loss_d: 0.492174
0.3078 --- loss: 1.651229, loss_ss: 1.017701, loss_d: 0.633528
0.3463 --- loss: 1.671433, loss_ss: 1.097101, loss_d: 0.574332
0.3848 --- loss: 1.660987, loss_ss: 1.036839, loss_d: 0.624148
0.4232 --- loss: 1.504296, loss_ss: 0.922782, loss_d: 0.581514
0.4617 --- loss: 1.452729, loss_ss: 0.857633, loss_d: 0.595096
0.5002 --- loss: 1.538394, loss_ss: 0.978598, loss_d: 0.559796
0.5387 --- loss: 1.680036, loss_ss: 1.162966, loss_d: 0.517070
0.5771 --- loss: 1.548298, loss_ss: 1.064388, loss_d: 0.483910
0.6156 --- loss: 1.666873, loss_ss: 1.364723, loss_d: 0.302149
0.6541 --- loss: 1.748792, loss_ss: 1.250007, loss_d: 0.498785
0.6926 --- loss: 1.535969, loss_ss: 0.953739, loss_d: 0.582231
0.7311 --- loss: 1.582973, loss_ss: 1.018758, loss_d: 0.564215
0.7695 --- loss: 2.029873, loss_ss: 1.524487, loss_d: 0.505386
0.8080 --- loss: 1.488423, loss_ss: 0.966031, loss_d: 0.522392
0.8465 --- loss: 1.362853, loss_ss: 1.048216, loss_d: 0.314637
0.8850 --- loss: 1.709625, loss_ss: 1.028206, loss_d: 0.681420
0.9234 --- loss: 1.226518, loss_ss: 0.938498, loss_d: 0.288021
0.9619 --- loss: 1.582236, loss_ss: 0.932663, loss_d: 0.649573
Epoch finished! Loss: 1.5818983205957302
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.618482, loss_ss: 1.036497, loss_d: 0.581985
0.0385 --- loss: 1.726393, loss_ss: 1.038035, loss_d: 0.688358
0.0770 --- loss: 1.680921, loss_ss: 1.164061, loss_d: 0.516860
0.1154 --- loss: 1.432806, loss_ss: 1.054799, loss_d: 0.378006
0.1539 --- loss: 1.620874, loss_ss: 0.986620, loss_d: 0.634254
0.1924 --- loss: 2.057130, loss_ss: 1.631449, loss_d: 0.425681
0.2309 --- loss: 1.515150, loss_ss: 1.028311, loss_d: 0.486839
0.2693 --- loss: 1.284281, loss_ss: 0.907190, loss_d: 0.377092
0.3078 --- loss: 1.110417, loss_ss: 0.772208, loss_d: 0.338209
0.3463 --- loss: 1.449138, loss_ss: 1.116187, loss_d: 0.332951
0.3848 --- loss: 1.801779, loss_ss: 1.079638, loss_d: 0.722141
0.4232 --- loss: 1.022253, loss_ss: 0.718852, loss_d: 0.303402
0.4617 --- loss: 1.204756, loss_ss: 0.989568, loss_d: 0.215188
0.5002 --- loss: 1.514363, loss_ss: 0.814322, loss_d: 0.700041
0.5387 --- loss: 1.279005, loss_ss: 0.871924, loss_d: 0.407080
0.5771 --- loss: 1.031381, loss_ss: 0.660798, loss_d: 0.370583
0.6156 --- loss: 1.219703, loss_ss: 0.916796, loss_d: 0.302907
0.6541 --- loss: 1.680038, loss_ss: 1.054232, loss_d: 0.625806
0.6926 --- loss: 1.769999, loss_ss: 1.005229, loss_d: 0.764770
0.7311 --- loss: 1.697171, loss_ss: 0.880511, loss_d: 0.816659
0.7695 --- loss: 1.272115, loss_ss: 0.812236, loss_d: 0.459879
0.8080 --- loss: 1.700652, loss_ss: 1.050073, loss_d: 0.650579
0.8465 --- loss: 1.347622, loss_ss: 1.067094, loss_d: 0.280529
0.8850 --- loss: 1.229663, loss_ss: 0.794015, loss_d: 0.435648
0.9234 --- loss: 1.515300, loss_ss: 1.261061, loss_d: 0.254239
0.9619 --- loss: 1.112349, loss_ss: 0.779660, loss_d: 0.332689
Epoch finished! Loss: 1.4794777321079062
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.547347, loss_ss: 1.169656, loss_d: 0.377691
0.0385 --- loss: 1.281029, loss_ss: 0.949102, loss_d: 0.331927
0.0770 --- loss: 1.263070, loss_ss: 0.942502, loss_d: 0.320568
0.1154 --- loss: 1.394373, loss_ss: 0.897566, loss_d: 0.496807
0.1539 --- loss: 1.238668, loss_ss: 0.834330, loss_d: 0.404338
0.1924 --- loss: 1.181690, loss_ss: 0.911064, loss_d: 0.270626
0.2309 --- loss: 1.432952, loss_ss: 0.708266, loss_d: 0.724686
0.2693 --- loss: 1.631439, loss_ss: 1.169849, loss_d: 0.461590
0.3078 --- loss: 1.726994, loss_ss: 0.594843, loss_d: 1.132151
0.3463 --- loss: 1.447686, loss_ss: 0.791981, loss_d: 0.655706
0.3848 --- loss: 1.713650, loss_ss: 0.994823, loss_d: 0.718828
0.4232 --- loss: 1.094356, loss_ss: 0.822583, loss_d: 0.271773
0.4617 --- loss: 0.956013, loss_ss: 0.777619, loss_d: 0.178395
0.5002 --- loss: 1.306871, loss_ss: 0.895452, loss_d: 0.411419
0.5387 --- loss: 1.447269, loss_ss: 1.019957, loss_d: 0.427312
0.5771 --- loss: 1.488689, loss_ss: 1.069669, loss_d: 0.419020
0.6156 --- loss: 1.371662, loss_ss: 0.972916, loss_d: 0.398746
0.6541 --- loss: 1.170728, loss_ss: 0.827492, loss_d: 0.343236
0.6926 --- loss: 1.302080, loss_ss: 1.128929, loss_d: 0.173151
0.7311 --- loss: 1.359874, loss_ss: 0.777215, loss_d: 0.582659
0.7695 --- loss: 1.043039, loss_ss: 0.810483, loss_d: 0.232556
0.8080 --- loss: 1.056529, loss_ss: 0.805511, loss_d: 0.251018
0.8465 --- loss: 1.262211, loss_ss: 0.829397, loss_d: 0.432813
0.8850 --- loss: 1.835208, loss_ss: 1.580952, loss_d: 0.254256
0.9234 --- loss: 1.330935, loss_ss: 1.034083, loss_d: 0.296852
0.9619 --- loss: 1.141326, loss_ss: 0.891841, loss_d: 0.249485
Epoch finished! Loss: 1.3578085742862067
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.498901, loss_ss: 1.014054, loss_d: 0.484847
0.0385 --- loss: 1.140473, loss_ss: 0.717417, loss_d: 0.423056
0.0770 --- loss: 1.507171, loss_ss: 0.829211, loss_d: 0.677960
0.1154 --- loss: 1.180121, loss_ss: 0.844162, loss_d: 0.335960
0.1539 --- loss: 1.071550, loss_ss: 0.876412, loss_d: 0.195139
0.1924 --- loss: 1.297633, loss_ss: 0.813934, loss_d: 0.483699
0.2309 --- loss: 0.994742, loss_ss: 0.776333, loss_d: 0.218409
0.2693 --- loss: 1.184509, loss_ss: 0.936797, loss_d: 0.247712
0.3078 --- loss: 1.054986, loss_ss: 0.832115, loss_d: 0.222871
0.3463 --- loss: 1.623964, loss_ss: 0.992563, loss_d: 0.631400
0.3848 --- loss: 1.123081, loss_ss: 0.751853, loss_d: 0.371228
0.4232 --- loss: 1.083603, loss_ss: 0.567378, loss_d: 0.516225
0.4617 --- loss: 1.324025, loss_ss: 0.942513, loss_d: 0.381512
0.5002 --- loss: 1.849126, loss_ss: 0.951503, loss_d: 0.897623
0.5387 --- loss: 1.482729, loss_ss: 1.129304, loss_d: 0.353426
0.5771 --- loss: 1.324873, loss_ss: 0.932105, loss_d: 0.392768
0.6156 --- loss: 1.563409, loss_ss: 1.158069, loss_d: 0.405340
0.6541 --- loss: 1.810774, loss_ss: 1.620666, loss_d: 0.190108
0.6926 --- loss: 1.237133, loss_ss: 0.929595, loss_d: 0.307537
0.7311 --- loss: 1.319391, loss_ss: 1.085344, loss_d: 0.234047
0.7695 --- loss: 1.300770, loss_ss: 0.702855, loss_d: 0.597915
0.8080 --- loss: 1.109488, loss_ss: 0.711236, loss_d: 0.398252
0.8465 --- loss: 1.107773, loss_ss: 0.795462, loss_d: 0.312311
0.8850 --- loss: 1.674495, loss_ss: 1.218413, loss_d: 0.456082
0.9234 --- loss: 1.065592, loss_ss: 0.757111, loss_d: 0.308481
0.9619 --- loss: 1.275749, loss_ss: 1.009911, loss_d: 0.265838
Epoch finished! Loss: 1.2885364892399909
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.408038, loss_ss: 1.041699, loss_d: 0.366338
0.0385 --- loss: 1.140582, loss_ss: 0.881054, loss_d: 0.259528
0.0770 --- loss: 1.137352, loss_ss: 0.763653, loss_d: 0.373698
0.1154 --- loss: 1.001782, loss_ss: 0.881335, loss_d: 0.120446
0.1539 --- loss: 1.054637, loss_ss: 0.916328, loss_d: 0.138309
0.1924 --- loss: 1.966199, loss_ss: 1.486650, loss_d: 0.479549
0.2309 --- loss: 1.022296, loss_ss: 0.690225, loss_d: 0.332071
0.2693 --- loss: 1.181460, loss_ss: 0.870532, loss_d: 0.310928
0.3078 --- loss: 1.081822, loss_ss: 0.856562, loss_d: 0.225260
0.3463 --- loss: 1.213654, loss_ss: 0.952856, loss_d: 0.260798
0.3848 --- loss: 1.461800, loss_ss: 1.135205, loss_d: 0.326596
0.4232 --- loss: 1.016658, loss_ss: 0.760059, loss_d: 0.256599
0.4617 --- loss: 1.049862, loss_ss: 0.660747, loss_d: 0.389115
0.5002 --- loss: 1.714284, loss_ss: 0.895719, loss_d: 0.818565
0.5387 --- loss: 1.103970, loss_ss: 0.706050, loss_d: 0.397920
0.5771 --- loss: 0.901919, loss_ss: 0.721298, loss_d: 0.180620
0.6156 --- loss: 1.212597, loss_ss: 0.901152, loss_d: 0.311445
0.6541 --- loss: 0.969177, loss_ss: 0.767329, loss_d: 0.201848
0.6926 --- loss: 1.504579, loss_ss: 1.111697, loss_d: 0.392882
0.7311 --- loss: 1.235093, loss_ss: 0.805279, loss_d: 0.429813
0.7695 --- loss: 1.169839, loss_ss: 0.810693, loss_d: 0.359146
0.8080 --- loss: 1.034199, loss_ss: 0.830465, loss_d: 0.203735
0.8465 --- loss: 1.293291, loss_ss: 0.858490, loss_d: 0.434801
0.8850 --- loss: 1.218096, loss_ss: 0.954290, loss_d: 0.263806
0.9234 --- loss: 1.032912, loss_ss: 0.879907, loss_d: 0.153005
0.9619 --- loss: 0.942517, loss_ss: 0.807673, loss_d: 0.134844
Epoch finished! Loss: 1.2338344896622147
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.070287, loss_ss: 0.920873, loss_d: 0.149414
0.0385 --- loss: 1.026366, loss_ss: 0.748597, loss_d: 0.277769
0.0770 --- loss: 1.206964, loss_ss: 0.973542, loss_d: 0.233422
0.1154 --- loss: 0.997309, loss_ss: 0.801408, loss_d: 0.195901
0.1539 --- loss: 0.786669, loss_ss: 0.657457, loss_d: 0.129212
0.1924 --- loss: 1.358786, loss_ss: 0.845152, loss_d: 0.513635
0.2309 --- loss: 0.977888, loss_ss: 0.680219, loss_d: 0.297668
0.2693 --- loss: 1.250189, loss_ss: 0.902572, loss_d: 0.347617
0.3078 --- loss: 1.133346, loss_ss: 0.875530, loss_d: 0.257816
0.3463 --- loss: 1.309157, loss_ss: 0.944159, loss_d: 0.364998
0.3848 --- loss: 1.478415, loss_ss: 0.770604, loss_d: 0.707811
0.4232 --- loss: 1.315283, loss_ss: 0.773756, loss_d: 0.541527
0.4617 --- loss: 1.162700, loss_ss: 0.761659, loss_d: 0.401041
0.5002 --- loss: 1.127789, loss_ss: 0.893639, loss_d: 0.234151
0.5387 --- loss: 0.836332, loss_ss: 0.627529, loss_d: 0.208804
0.5771 --- loss: 1.129290, loss_ss: 0.979387, loss_d: 0.149903
0.6156 --- loss: 2.025301, loss_ss: 1.611355, loss_d: 0.413946
0.6541 --- loss: 1.203845, loss_ss: 0.798248, loss_d: 0.405596
0.6926 --- loss: 1.106824, loss_ss: 1.008461, loss_d: 0.098362
0.7311 --- loss: 1.466980, loss_ss: 0.883453, loss_d: 0.583527
0.7695 --- loss: 1.304756, loss_ss: 0.952416, loss_d: 0.352339
0.8080 --- loss: 1.037124, loss_ss: 0.865402, loss_d: 0.171722
0.8465 --- loss: 0.846233, loss_ss: 0.660792, loss_d: 0.185442
0.8850 --- loss: 1.468056, loss_ss: 1.239271, loss_d: 0.228785
0.9234 --- loss: 1.859808, loss_ss: 0.893171, loss_d: 0.966638
0.9619 --- loss: 1.359374, loss_ss: 0.865343, loss_d: 0.494030
Epoch finished! Loss: 1.207554258434929
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.230301, loss_ss: 0.781907, loss_d: 0.448394
0.0385 --- loss: 0.843478, loss_ss: 0.710173, loss_d: 0.133305
0.0770 --- loss: 0.766747, loss_ss: 0.646914, loss_d: 0.119832
0.1154 --- loss: 1.016956, loss_ss: 0.793279, loss_d: 0.223677
0.1539 --- loss: 1.297686, loss_ss: 0.806218, loss_d: 0.491468
0.1924 --- loss: 1.393900, loss_ss: 1.002539, loss_d: 0.391361
0.2309 --- loss: 1.426413, loss_ss: 0.994479, loss_d: 0.431933
0.2693 --- loss: 1.209334, loss_ss: 0.892735, loss_d: 0.316599
0.3078 --- loss: 1.109786, loss_ss: 0.878808, loss_d: 0.230978
0.3463 --- loss: 1.336649, loss_ss: 1.065055, loss_d: 0.271595
0.3848 --- loss: 1.219529, loss_ss: 0.960665, loss_d: 0.258863
0.4232 --- loss: 1.240272, loss_ss: 1.008013, loss_d: 0.232260
0.4617 --- loss: 1.464427, loss_ss: 0.976454, loss_d: 0.487974
0.5002 --- loss: 1.216591, loss_ss: 0.813670, loss_d: 0.402921
0.5387 --- loss: 0.849953, loss_ss: 0.665881, loss_d: 0.184072
0.5771 --- loss: 1.359417, loss_ss: 0.811314, loss_d: 0.548103
0.6156 --- loss: 0.972798, loss_ss: 0.844587, loss_d: 0.128210
0.6541 --- loss: 1.366350, loss_ss: 0.957487, loss_d: 0.408863
0.6926 --- loss: 1.225103, loss_ss: 0.687007, loss_d: 0.538096
0.7311 --- loss: 0.895767, loss_ss: 0.724368, loss_d: 0.171400
0.7695 --- loss: 1.351092, loss_ss: 0.863164, loss_d: 0.487928
0.8080 --- loss: 1.192833, loss_ss: 0.857291, loss_d: 0.335542
0.8465 --- loss: 1.999143, loss_ss: 1.341477, loss_d: 0.657666
0.8850 --- loss: 1.199104, loss_ss: 0.869138, loss_d: 0.329966
0.9234 --- loss: 1.234914, loss_ss: 0.975079, loss_d: 0.259835
0.9619 --- loss: 0.658143, loss_ss: 0.535869, loss_d: 0.122274
Epoch finished! Loss: 1.1784431600662733
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.260185, loss_ss: 0.859320, loss_d: 0.400865
0.0385 --- loss: 1.027666, loss_ss: 0.826123, loss_d: 0.201543
0.0770 --- loss: 1.529162, loss_ss: 0.820472, loss_d: 0.708690
0.1154 --- loss: 1.322812, loss_ss: 0.933236, loss_d: 0.389576
0.1539 --- loss: 0.726146, loss_ss: 0.527100, loss_d: 0.199046
0.1924 --- loss: 1.351720, loss_ss: 1.030928, loss_d: 0.320792
0.2309 --- loss: 0.920445, loss_ss: 0.767951, loss_d: 0.152493
0.2693 --- loss: 0.958799, loss_ss: 0.760988, loss_d: 0.197811
0.3078 --- loss: 0.898817, loss_ss: 0.765436, loss_d: 0.133381
0.3463 --- loss: 0.797733, loss_ss: 0.669882, loss_d: 0.127851
0.3848 --- loss: 1.351246, loss_ss: 0.896953, loss_d: 0.454293
0.4232 --- loss: 1.135262, loss_ss: 0.832691, loss_d: 0.302571
0.4617 --- loss: 0.941318, loss_ss: 0.707670, loss_d: 0.233648
0.5002 --- loss: 1.055073, loss_ss: 0.602434, loss_d: 0.452639
0.5387 --- loss: 1.243829, loss_ss: 1.069564, loss_d: 0.174264
0.5771 --- loss: 0.974872, loss_ss: 0.848980, loss_d: 0.125892
0.6156 --- loss: 0.782330, loss_ss: 0.648727, loss_d: 0.133603
0.6541 --- loss: 1.246110, loss_ss: 1.004812, loss_d: 0.241297
0.6926 --- loss: 1.393655, loss_ss: 0.685924, loss_d: 0.707731
0.7311 --- loss: 1.063857, loss_ss: 0.883801, loss_d: 0.180055
0.7695 --- loss: 1.104448, loss_ss: 0.932957, loss_d: 0.171491
0.8080 --- loss: 1.472328, loss_ss: 0.804313, loss_d: 0.668015
0.8465 --- loss: 1.399360, loss_ss: 1.172071, loss_d: 0.227289
0.8850 --- loss: 0.989624, loss_ss: 0.693470, loss_d: 0.296154
0.9234 --- loss: 1.145075, loss_ss: 0.960394, loss_d: 0.184681
0.9619 --- loss: 1.305156, loss_ss: 0.943902, loss_d: 0.361254
Epoch finished! Loss: 1.1580131099951314
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7194183062446535
             precision    recall  f1-score   support

        0.0       0.85      0.72      0.78       267
        1.0       0.32      0.22      0.26       152
        2.0       0.71      0.82      0.76       496
        3.0       0.70      0.86      0.77        74
        4.0       0.83      0.79      0.81       180

avg / total       0.71      0.72      0.71      1169
 


====== chp057-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.85  72.28   96.34  85.40     78.30
1  83.75  22.37   92.92  32.08     26.36
2  78.36  82.26   75.48  71.20     76.33
3  96.75  86.49   97.44  69.57     77.11
4  94.18  78.89   96.97  82.56     80.68
Total accuracy: 71.94%
Average sen: 68.46%
Average spec: 91.83%
Macro f1-score: 67.76%
[0.58636576 0.30363682 0.60636407 0.72007668 0.87213701 0.97222722
 0.91238487 0.90696901 0.87246484 0.80922192 0.74256611 0.51695204
 0.9971841  0.69261438 0.99492848 0.99353987 0.91633731 0.92878842
 0.99749184 0.90694839 0.98548096 0.99192411 0.99183261 0.92104179
 0.98894709 0.97318661 0.97378355 0.94733685 0.61718816 0.87530154
 0.98187166 0.99761498 0.97804755 0.92545068 0.88896161 0.83559626
 0.92384607 0.92858917 0.93418735]
pred: 0.8694714804490408, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.461080, loss_ss: 1.763263, loss_d: 0.697817
0.0384 --- loss: 2.322805, loss_ss: 1.706685, loss_d: 0.616121
0.0768 --- loss: 1.901881, loss_ss: 1.621359, loss_d: 0.280522
0.1152 --- loss: 2.208802, loss_ss: 1.546257, loss_d: 0.662545
0.1536 --- loss: 1.967951, loss_ss: 1.473012, loss_d: 0.494938
0.1920 --- loss: 2.055326, loss_ss: 1.416351, loss_d: 0.638976
0.2304 --- loss: 2.239913, loss_ss: 1.652254, loss_d: 0.587659
0.2688 --- loss: 1.770110, loss_ss: 1.387698, loss_d: 0.382412
0.3072 --- loss: 2.083942, loss_ss: 1.389802, loss_d: 0.694140
0.3456 --- loss: 1.936908, loss_ss: 1.303618, loss_d: 0.633291
0.3840 --- loss: 1.851458, loss_ss: 1.211156, loss_d: 0.640302
0.4224 --- loss: 1.938528, loss_ss: 1.475630, loss_d: 0.462898
0.4608 --- loss: 1.631140, loss_ss: 1.252155, loss_d: 0.378986
0.4992 --- loss: 1.839250, loss_ss: 1.308568, loss_d: 0.530681
0.5376 --- loss: 1.936770, loss_ss: 1.305702, loss_d: 0.631068
0.5760 --- loss: 2.087316, loss_ss: 1.472061, loss_d: 0.615256
0.6144 --- loss: 1.815778, loss_ss: 1.233718, loss_d: 0.582060
0.6528 --- loss: 1.928482, loss_ss: 1.375692, loss_d: 0.552790
0.6912 --- loss: 1.619218, loss_ss: 1.219279, loss_d: 0.399939
0.7296 --- loss: 1.725150, loss_ss: 1.250526, loss_d: 0.474624
0.7680 --- loss: 2.031398, loss_ss: 1.457401, loss_d: 0.573998
0.8065 --- loss: 1.578140, loss_ss: 1.124065, loss_d: 0.454075
0.8449 --- loss: 1.843886, loss_ss: 1.279468, loss_d: 0.564418
0.8833 --- loss: 1.669398, loss_ss: 1.160076, loss_d: 0.509322
0.9217 --- loss: 1.801815, loss_ss: 1.346658, loss_d: 0.455157
0.9601 --- loss: 2.160213, loss_ss: 1.340918, loss_d: 0.819295
0.9985 --- loss: 2.000684, loss_ss: 1.389097, loss_d: 0.611587
Epoch finished! Loss: 1.9959435036549202
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.515795, loss_ss: 1.162973, loss_d: 0.352822
0.0384 --- loss: 1.758409, loss_ss: 1.272578, loss_d: 0.485831
0.0768 --- loss: 1.820456, loss_ss: 1.238181, loss_d: 0.582275
0.1152 --- loss: 1.694529, loss_ss: 1.203957, loss_d: 0.490572
0.1536 --- loss: 1.858523, loss_ss: 1.304979, loss_d: 0.553544
0.1920 --- loss: 1.534602, loss_ss: 1.118502, loss_d: 0.416100
0.2304 --- loss: 1.970982, loss_ss: 1.270122, loss_d: 0.700860
0.2688 --- loss: 2.000201, loss_ss: 1.259736, loss_d: 0.740466
0.3072 --- loss: 1.453583, loss_ss: 0.974539, loss_d: 0.479043
0.3456 --- loss: 1.468892, loss_ss: 1.039551, loss_d: 0.429341
0.3840 --- loss: 2.213983, loss_ss: 1.728970, loss_d: 0.485013
0.4224 --- loss: 1.453974, loss_ss: 0.953269, loss_d: 0.500705
0.4608 --- loss: 1.584495, loss_ss: 1.103567, loss_d: 0.480929
0.4992 --- loss: 1.780588, loss_ss: 1.134379, loss_d: 0.646209
0.5376 --- loss: 1.720995, loss_ss: 0.923258, loss_d: 0.797736
0.5760 --- loss: 1.809154, loss_ss: 1.227768, loss_d: 0.581386
0.6144 --- loss: 1.757957, loss_ss: 1.154871, loss_d: 0.603087
0.6528 --- loss: 1.775896, loss_ss: 1.022799, loss_d: 0.753097
0.6912 --- loss: 2.063327, loss_ss: 1.352722, loss_d: 0.710605
0.7296 --- loss: 1.910174, loss_ss: 1.237587, loss_d: 0.672587
0.7680 --- loss: 1.908077, loss_ss: 1.155689, loss_d: 0.752388
0.8065 --- loss: 1.333461, loss_ss: 0.909222, loss_d: 0.424239
0.8449 --- loss: 1.671593, loss_ss: 0.977889, loss_d: 0.693704
0.8833 --- loss: 1.373541, loss_ss: 0.966796, loss_d: 0.406746
0.9217 --- loss: 1.663093, loss_ss: 1.134370, loss_d: 0.528723
0.9601 --- loss: 1.577590, loss_ss: 1.012919, loss_d: 0.564671
0.9985 --- loss: 2.124177, loss_ss: 1.300341, loss_d: 0.823836
Epoch finished! Loss: 1.7278414437404046
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.809364, loss_ss: 1.144618, loss_d: 0.664746
0.0384 --- loss: 1.563219, loss_ss: 1.081999, loss_d: 0.481220
0.0768 --- loss: 1.623722, loss_ss: 1.054349, loss_d: 0.569373
0.1152 --- loss: 1.689792, loss_ss: 1.041965, loss_d: 0.647827
0.1536 --- loss: 1.554626, loss_ss: 0.897534, loss_d: 0.657092
0.1920 --- loss: 1.704531, loss_ss: 1.163838, loss_d: 0.540693
0.2304 --- loss: 1.969036, loss_ss: 1.408525, loss_d: 0.560511
0.2688 --- loss: 1.388532, loss_ss: 0.924754, loss_d: 0.463778
0.3072 --- loss: 1.719564, loss_ss: 1.281222, loss_d: 0.438342
0.3456 --- loss: 1.522749, loss_ss: 0.977980, loss_d: 0.544770
0.3840 --- loss: 1.381727, loss_ss: 1.014326, loss_d: 0.367402
0.4224 --- loss: 2.071218, loss_ss: 1.334717, loss_d: 0.736501
0.4608 --- loss: 1.433801, loss_ss: 0.824414, loss_d: 0.609387
0.4992 --- loss: 1.617456, loss_ss: 0.941546, loss_d: 0.675910
0.5376 --- loss: 2.146134, loss_ss: 1.421448, loss_d: 0.724686
0.5760 --- loss: 1.326415, loss_ss: 0.850191, loss_d: 0.476224
0.6144 --- loss: 1.379082, loss_ss: 0.921176, loss_d: 0.457906
0.6528 --- loss: 1.427212, loss_ss: 0.992062, loss_d: 0.435150
0.6912 --- loss: 1.627139, loss_ss: 1.049892, loss_d: 0.577247
0.7296 --- loss: 1.754242, loss_ss: 1.069022, loss_d: 0.685220
0.7680 --- loss: 1.379830, loss_ss: 0.891709, loss_d: 0.488120
0.8065 --- loss: 1.319193, loss_ss: 0.838974, loss_d: 0.480219
0.8449 --- loss: 1.839709, loss_ss: 1.348004, loss_d: 0.491705
0.8833 --- loss: 1.382859, loss_ss: 0.992813, loss_d: 0.390047
0.9217 --- loss: 2.299099, loss_ss: 1.518281, loss_d: 0.780818
0.9601 --- loss: 1.753531, loss_ss: 1.202864, loss_d: 0.550667
0.9985 --- loss: 1.436160, loss_ss: 1.011794, loss_d: 0.424366
Epoch finished! Loss: 1.5951219792549427
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.448995, loss_ss: 0.963991, loss_d: 0.485004
0.0384 --- loss: 1.800474, loss_ss: 1.173704, loss_d: 0.626771
0.0768 --- loss: 1.310572, loss_ss: 0.713481, loss_d: 0.597092
0.1152 --- loss: 1.266747, loss_ss: 0.990724, loss_d: 0.276024
0.1536 --- loss: 1.637647, loss_ss: 1.037750, loss_d: 0.599897
0.1920 --- loss: 1.661390, loss_ss: 1.292349, loss_d: 0.369041
0.2304 --- loss: 1.184528, loss_ss: 0.695723, loss_d: 0.488805
0.2688 --- loss: 1.786352, loss_ss: 1.037575, loss_d: 0.748777
0.3072 --- loss: 1.576426, loss_ss: 0.928274, loss_d: 0.648152
0.3456 --- loss: 1.571550, loss_ss: 0.955797, loss_d: 0.615752
0.3840 --- loss: 1.381040, loss_ss: 0.935329, loss_d: 0.445712
0.4224 --- loss: 1.776008, loss_ss: 0.985698, loss_d: 0.790309
0.4608 --- loss: 1.533615, loss_ss: 0.714452, loss_d: 0.819163
0.4992 --- loss: 1.325951, loss_ss: 0.720326, loss_d: 0.605625
0.5376 --- loss: 1.461004, loss_ss: 0.915214, loss_d: 0.545790
0.5760 --- loss: 1.433120, loss_ss: 1.022277, loss_d: 0.410843
0.6144 --- loss: 1.760745, loss_ss: 1.247169, loss_d: 0.513576
0.6528 --- loss: 1.375069, loss_ss: 0.808829, loss_d: 0.566240
0.6912 --- loss: 1.770269, loss_ss: 1.036877, loss_d: 0.733392
0.7296 --- loss: 1.297538, loss_ss: 0.861698, loss_d: 0.435840
0.7680 --- loss: 1.165792, loss_ss: 0.741972, loss_d: 0.423820
0.8065 --- loss: 1.624768, loss_ss: 1.260605, loss_d: 0.364163
0.8449 --- loss: 1.275543, loss_ss: 0.926050, loss_d: 0.349493
0.8833 --- loss: 1.545778, loss_ss: 0.955511, loss_d: 0.590267
0.9217 --- loss: 1.330874, loss_ss: 0.849207, loss_d: 0.481667
0.9601 --- loss: 1.296455, loss_ss: 1.001238, loss_d: 0.295217
0.9985 --- loss: 2.390879, loss_ss: 2.189726, loss_d: 0.201153
Epoch finished! Loss: 1.467060675070836
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.029024, loss_ss: 0.863941, loss_d: 0.165083
0.0384 --- loss: 1.566601, loss_ss: 1.185356, loss_d: 0.381245
0.0768 --- loss: 1.498503, loss_ss: 0.941314, loss_d: 0.557189
0.1152 --- loss: 1.094934, loss_ss: 0.930772, loss_d: 0.164162
0.1536 --- loss: 1.393882, loss_ss: 1.016708, loss_d: 0.377173
0.1920 --- loss: 1.273944, loss_ss: 0.657867, loss_d: 0.616077
0.2304 --- loss: 1.404555, loss_ss: 0.974548, loss_d: 0.430008
0.2688 --- loss: 1.295423, loss_ss: 0.744472, loss_d: 0.550951
0.3072 --- loss: 1.598085, loss_ss: 1.049019, loss_d: 0.549066
0.3456 --- loss: 1.183936, loss_ss: 0.864024, loss_d: 0.319912
0.3840 --- loss: 1.275259, loss_ss: 0.853201, loss_d: 0.422058
0.4224 --- loss: 1.238531, loss_ss: 0.979574, loss_d: 0.258958
0.4608 --- loss: 1.587129, loss_ss: 1.242338, loss_d: 0.344791
0.4992 --- loss: 1.497241, loss_ss: 1.114727, loss_d: 0.382514
0.5376 --- loss: 1.047532, loss_ss: 0.841514, loss_d: 0.206018
0.5760 --- loss: 1.243874, loss_ss: 0.878342, loss_d: 0.365532
0.6144 --- loss: 1.558424, loss_ss: 0.779205, loss_d: 0.779220
0.6528 --- loss: 1.252965, loss_ss: 0.949618, loss_d: 0.303346
0.6912 --- loss: 1.214026, loss_ss: 0.619682, loss_d: 0.594344
0.7296 --- loss: 1.280280, loss_ss: 0.854603, loss_d: 0.425677
0.7680 --- loss: 1.407087, loss_ss: 0.868711, loss_d: 0.538376
0.8065 --- loss: 1.130919, loss_ss: 0.874509, loss_d: 0.256411
0.8449 --- loss: 1.134341, loss_ss: 0.826935, loss_d: 0.307406
0.8833 --- loss: 1.572635, loss_ss: 1.014769, loss_d: 0.557867
0.9217 --- loss: 1.764776, loss_ss: 1.133997, loss_d: 0.630778
0.9601 --- loss: 1.025027, loss_ss: 0.808584, loss_d: 0.216443
0.9985 --- loss: 1.071854, loss_ss: 0.846434, loss_d: 0.225420
Epoch finished! Loss: 1.379188765012301
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.579264, loss_ss: 1.071490, loss_d: 0.507775
0.0384 --- loss: 1.136044, loss_ss: 0.748964, loss_d: 0.387080
0.0768 --- loss: 1.306911, loss_ss: 0.850695, loss_d: 0.456216
0.1152 --- loss: 1.219869, loss_ss: 1.005323, loss_d: 0.214546
0.1536 --- loss: 2.012547, loss_ss: 0.894730, loss_d: 1.117817
0.1920 --- loss: 1.523965, loss_ss: 0.979431, loss_d: 0.544534
0.2304 --- loss: 1.290720, loss_ss: 0.825278, loss_d: 0.465442
0.2688 --- loss: 1.110316, loss_ss: 0.752316, loss_d: 0.358000
0.3072 --- loss: 1.372943, loss_ss: 1.073399, loss_d: 0.299544
0.3456 --- loss: 1.270312, loss_ss: 1.032168, loss_d: 0.238144
0.3840 --- loss: 1.449597, loss_ss: 1.068637, loss_d: 0.380960
0.4224 --- loss: 1.450627, loss_ss: 1.057009, loss_d: 0.393617
0.4608 --- loss: 1.199354, loss_ss: 0.804999, loss_d: 0.394355
0.4992 --- loss: 1.120773, loss_ss: 0.869763, loss_d: 0.251009
0.5376 --- loss: 1.402982, loss_ss: 0.937616, loss_d: 0.465367
0.5760 --- loss: 1.323137, loss_ss: 1.020189, loss_d: 0.302947
0.6144 --- loss: 1.659490, loss_ss: 0.883842, loss_d: 0.775648
0.6528 --- loss: 1.400883, loss_ss: 0.870695, loss_d: 0.530188
0.6912 --- loss: 1.127734, loss_ss: 0.731862, loss_d: 0.395872
0.7296 --- loss: 1.747521, loss_ss: 1.057542, loss_d: 0.689978
0.7680 --- loss: 0.904030, loss_ss: 0.713503, loss_d: 0.190527
0.8065 --- loss: 1.458059, loss_ss: 1.147744, loss_d: 0.310315
0.8449 --- loss: 1.229141, loss_ss: 0.942573, loss_d: 0.286568
0.8833 --- loss: 1.302407, loss_ss: 0.900821, loss_d: 0.401585
0.9217 --- loss: 1.449266, loss_ss: 0.824547, loss_d: 0.624719
0.9601 --- loss: 1.743738, loss_ss: 0.904572, loss_d: 0.839166
0.9985 --- loss: 1.817545, loss_ss: 1.434554, loss_d: 0.382991
Epoch finished! Loss: 1.3212092145131185
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.487309, loss_ss: 0.835609, loss_d: 0.651700
0.0384 --- loss: 1.168157, loss_ss: 0.949314, loss_d: 0.218843
0.0768 --- loss: 1.240954, loss_ss: 0.882661, loss_d: 0.358292
0.1152 --- loss: 0.960905, loss_ss: 0.818794, loss_d: 0.142111
0.1536 --- loss: 1.283974, loss_ss: 0.764666, loss_d: 0.519308
0.1920 --- loss: 1.037627, loss_ss: 0.790128, loss_d: 0.247499
0.2304 --- loss: 1.265726, loss_ss: 0.921056, loss_d: 0.344670
0.2688 --- loss: 0.971772, loss_ss: 0.689424, loss_d: 0.282348
0.3072 --- loss: 1.306283, loss_ss: 0.777350, loss_d: 0.528933
0.3456 --- loss: 1.064734, loss_ss: 0.592297, loss_d: 0.472437
0.3840 --- loss: 1.142789, loss_ss: 0.933626, loss_d: 0.209163
0.4224 --- loss: 0.897222, loss_ss: 0.580434, loss_d: 0.316788
0.4608 --- loss: 1.247816, loss_ss: 0.926686, loss_d: 0.321130
0.4992 --- loss: 1.361715, loss_ss: 1.170527, loss_d: 0.191188
0.5376 --- loss: 1.332145, loss_ss: 1.037901, loss_d: 0.294243
0.5760 --- loss: 1.315072, loss_ss: 0.958131, loss_d: 0.356941
0.6144 --- loss: 1.653646, loss_ss: 1.024127, loss_d: 0.629519
0.6528 --- loss: 1.031998, loss_ss: 0.729050, loss_d: 0.302948
0.6912 --- loss: 0.979314, loss_ss: 0.765430, loss_d: 0.213884
0.7296 --- loss: 1.179106, loss_ss: 0.800085, loss_d: 0.379021
0.7680 --- loss: 1.309027, loss_ss: 0.887840, loss_d: 0.421187
0.8065 --- loss: 1.275140, loss_ss: 1.000706, loss_d: 0.274434
0.8449 --- loss: 1.063769, loss_ss: 0.883493, loss_d: 0.180276
0.8833 --- loss: 1.009504, loss_ss: 0.703362, loss_d: 0.306142
0.9217 --- loss: 1.247814, loss_ss: 1.038714, loss_d: 0.209100
0.9601 --- loss: 1.162259, loss_ss: 0.819263, loss_d: 0.342996
0.9985 --- loss: 2.186353, loss_ss: 0.479698, loss_d: 1.706655
Epoch finished! Loss: 1.245833805203438
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.349759, loss_ss: 1.022369, loss_d: 0.327390
0.0384 --- loss: 1.246006, loss_ss: 0.946504, loss_d: 0.299502
0.0768 --- loss: 1.338682, loss_ss: 0.979026, loss_d: 0.359657
0.1152 --- loss: 1.792298, loss_ss: 1.020947, loss_d: 0.771351
0.1536 --- loss: 1.158504, loss_ss: 0.845053, loss_d: 0.313450
0.1920 --- loss: 0.924092, loss_ss: 0.793782, loss_d: 0.130310
0.2304 --- loss: 1.421417, loss_ss: 0.694886, loss_d: 0.726531
0.2688 --- loss: 1.302688, loss_ss: 0.802444, loss_d: 0.500244
0.3072 --- loss: 1.504187, loss_ss: 0.858161, loss_d: 0.646027
0.3456 --- loss: 1.539433, loss_ss: 1.377585, loss_d: 0.161849
0.3840 --- loss: 1.046030, loss_ss: 0.714699, loss_d: 0.331331
0.4224 --- loss: 1.063783, loss_ss: 0.959033, loss_d: 0.104749
0.4608 --- loss: 1.308169, loss_ss: 0.985117, loss_d: 0.323052
0.4992 --- loss: 0.977904, loss_ss: 0.851850, loss_d: 0.126054
0.5376 --- loss: 1.079885, loss_ss: 0.970797, loss_d: 0.109088
0.5760 --- loss: 1.556217, loss_ss: 1.051088, loss_d: 0.505129
0.6144 --- loss: 1.101706, loss_ss: 0.827833, loss_d: 0.273873
0.6528 --- loss: 0.974576, loss_ss: 0.787086, loss_d: 0.187489
0.6912 --- loss: 1.347205, loss_ss: 1.197875, loss_d: 0.149329
0.7296 --- loss: 0.972283, loss_ss: 0.781591, loss_d: 0.190691
0.7680 --- loss: 1.206160, loss_ss: 0.958540, loss_d: 0.247620
0.8065 --- loss: 1.466161, loss_ss: 1.013653, loss_d: 0.452508
0.8449 --- loss: 1.240679, loss_ss: 0.975559, loss_d: 0.265120
0.8833 --- loss: 0.846834, loss_ss: 0.624457, loss_d: 0.222377
0.9217 --- loss: 1.534680, loss_ss: 0.951726, loss_d: 0.582955
0.9601 --- loss: 1.300282, loss_ss: 1.097228, loss_d: 0.203055
0.9985 --- loss: 1.913468, loss_ss: 0.961773, loss_d: 0.951695
Epoch finished! Loss: 1.1823336401811013
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.067369, loss_ss: 0.781742, loss_d: 0.285626
0.0384 --- loss: 1.489139, loss_ss: 0.708200, loss_d: 0.780939
0.0768 --- loss: 1.102810, loss_ss: 0.937592, loss_d: 0.165217
0.1152 --- loss: 0.858367, loss_ss: 0.533638, loss_d: 0.324730
0.1536 --- loss: 1.028775, loss_ss: 0.880155, loss_d: 0.148620
0.1920 --- loss: 1.262675, loss_ss: 1.009166, loss_d: 0.253510
0.2304 --- loss: 0.888785, loss_ss: 0.729630, loss_d: 0.159154
0.2688 --- loss: 0.828810, loss_ss: 0.721352, loss_d: 0.107458
0.3072 --- loss: 0.800308, loss_ss: 0.566037, loss_d: 0.234271
0.3456 --- loss: 1.191078, loss_ss: 0.731544, loss_d: 0.459534
0.3840 --- loss: 1.215675, loss_ss: 0.964250, loss_d: 0.251426
0.4224 --- loss: 1.151317, loss_ss: 0.522447, loss_d: 0.628870
0.4608 --- loss: 1.470165, loss_ss: 0.774227, loss_d: 0.695938
0.4992 --- loss: 0.805527, loss_ss: 0.662163, loss_d: 0.143364
0.5376 --- loss: 0.936710, loss_ss: 0.721744, loss_d: 0.214967
0.5760 --- loss: 1.064999, loss_ss: 0.894580, loss_d: 0.170419
0.6144 --- loss: 0.745698, loss_ss: 0.503699, loss_d: 0.241999
0.6528 --- loss: 1.336274, loss_ss: 1.201251, loss_d: 0.135023
0.6912 --- loss: 1.157169, loss_ss: 0.844812, loss_d: 0.312357
0.7296 --- loss: 1.612916, loss_ss: 0.823743, loss_d: 0.789172
0.7680 --- loss: 1.295039, loss_ss: 0.915016, loss_d: 0.380024
0.8065 --- loss: 1.263183, loss_ss: 0.899286, loss_d: 0.363897
0.8449 --- loss: 0.949472, loss_ss: 0.823082, loss_d: 0.126390
0.8833 --- loss: 0.946763, loss_ss: 0.764571, loss_d: 0.182192
0.9217 --- loss: 0.836593, loss_ss: 0.676986, loss_d: 0.159607
0.9601 --- loss: 1.247026, loss_ss: 0.922780, loss_d: 0.324245
0.9985 --- loss: 2.234738, loss_ss: 1.026114, loss_d: 1.208624
Epoch finished! Loss: 1.1761744549641242
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.136904, loss_ss: 0.928426, loss_d: 0.208478
0.0384 --- loss: 1.107193, loss_ss: 0.649521, loss_d: 0.457672
0.0768 --- loss: 0.971231, loss_ss: 0.743837, loss_d: 0.227394
0.1152 --- loss: 1.032117, loss_ss: 0.745274, loss_d: 0.286843
0.1536 --- loss: 1.115802, loss_ss: 0.877268, loss_d: 0.238535
0.1920 --- loss: 1.019050, loss_ss: 0.812127, loss_d: 0.206923
0.2304 --- loss: 1.345951, loss_ss: 0.939035, loss_d: 0.406916
0.2688 --- loss: 1.031175, loss_ss: 0.918594, loss_d: 0.112581
0.3072 --- loss: 1.360879, loss_ss: 1.029876, loss_d: 0.331002
0.3456 --- loss: 0.739157, loss_ss: 0.589133, loss_d: 0.150024
0.3840 --- loss: 1.040884, loss_ss: 0.881535, loss_d: 0.159350
0.4224 --- loss: 1.410368, loss_ss: 0.797875, loss_d: 0.612493
0.4608 --- loss: 1.096430, loss_ss: 0.845465, loss_d: 0.250965
0.4992 --- loss: 0.719116, loss_ss: 0.591919, loss_d: 0.127196
0.5376 --- loss: 0.885781, loss_ss: 0.597756, loss_d: 0.288025
0.5760 --- loss: 1.099526, loss_ss: 0.705949, loss_d: 0.393577
0.6144 --- loss: 1.646014, loss_ss: 0.785685, loss_d: 0.860329
0.6528 --- loss: 1.158298, loss_ss: 0.953293, loss_d: 0.205004
0.6912 --- loss: 0.860946, loss_ss: 0.640678, loss_d: 0.220268
0.7296 --- loss: 1.277719, loss_ss: 0.748325, loss_d: 0.529393
0.7680 --- loss: 1.206655, loss_ss: 0.879658, loss_d: 0.326997
0.8065 --- loss: 1.173176, loss_ss: 0.884169, loss_d: 0.289007
0.8449 --- loss: 1.266633, loss_ss: 1.143028, loss_d: 0.123605
0.8833 --- loss: 0.745963, loss_ss: 0.605538, loss_d: 0.140426
0.9217 --- loss: 0.888372, loss_ss: 0.795379, loss_d: 0.092993
0.9601 --- loss: 1.202218, loss_ss: 0.900969, loss_d: 0.301250
0.9985 --- loss: 1.474830, loss_ss: 1.144402, loss_d: 0.330428
Epoch finished! Loss: 1.1253131712858493
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6166666666666667
             precision    recall  f1-score   support

        0.0       0.86      0.72      0.79       105
        1.0       0.00      0.00      0.00        44
        2.0       0.47      0.97      0.63       317
        3.0       0.98      0.55      0.71       258
        4.0       0.86      0.34      0.49       296

avg / total       0.73      0.62      0.60      1020
 


====== chp058-nsrr ======

The f1-score of  1  has ZeroDivisionError.

   acc %  sen %  spec %  ppr %  f1-score
0  95.98  72.38   98.69  86.36     78.76
1  95.00   0.00   99.28   0.00      0.00
2  64.71  97.48   49.93  46.75     63.19
3  88.43  55.43   99.61  97.95     70.79
4  79.22  34.12   97.65  85.59     48.79
Total accuracy: 61.67%
Average sen: 51.88%
Average spec: 89.03%
Macro f1-score: 52.31%
[0.99595225 0.99923325 0.99945539 0.99909365 0.99786073 0.99685317
 0.97627038 0.99587679 0.99963069 0.99939907 0.99859124 0.99764329
 0.99712592 0.99914694 0.95809931 0.9960568  0.99656385 0.99890709
 0.98516428 0.99866927 0.99909925 0.99922442 0.99541205 0.99814165
 0.9994055  0.99531388 0.99821377 0.80739266 0.99318415 0.99808347
 0.99937433 0.9980647  0.99851066 0.99821341]
pred: 0.9900949194150812, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.543686, loss_ss: 1.839257, loss_d: 0.704429
0.0384 --- loss: 2.012357, loss_ss: 1.498860, loss_d: 0.513497
0.0769 --- loss: 2.215028, loss_ss: 1.530677, loss_d: 0.684351
0.1153 --- loss: 1.982914, loss_ss: 1.457154, loss_d: 0.525760
0.1538 --- loss: 2.182680, loss_ss: 1.391507, loss_d: 0.791173
0.1922 --- loss: 2.058662, loss_ss: 1.543893, loss_d: 0.514769
0.2307 --- loss: 1.939491, loss_ss: 1.289526, loss_d: 0.649966
0.2691 --- loss: 1.682866, loss_ss: 1.395334, loss_d: 0.287531
0.3076 --- loss: 1.697974, loss_ss: 1.276229, loss_d: 0.421745
0.3460 --- loss: 1.811486, loss_ss: 1.341430, loss_d: 0.470055
0.3845 --- loss: 1.865364, loss_ss: 1.230663, loss_d: 0.634701
0.4229 --- loss: 1.862242, loss_ss: 1.180152, loss_d: 0.682091
0.4614 --- loss: 1.932420, loss_ss: 1.222628, loss_d: 0.709792
0.4998 --- loss: 1.777088, loss_ss: 1.237284, loss_d: 0.539804
0.5383 --- loss: 2.177016, loss_ss: 1.457985, loss_d: 0.719030
0.5767 --- loss: 2.195047, loss_ss: 1.477091, loss_d: 0.717956
0.6151 --- loss: 1.645535, loss_ss: 1.139135, loss_d: 0.506400
0.6536 --- loss: 1.933785, loss_ss: 1.082933, loss_d: 0.850852
0.6920 --- loss: 1.727604, loss_ss: 1.272806, loss_d: 0.454797
0.7305 --- loss: 1.800963, loss_ss: 1.264076, loss_d: 0.536886
0.7689 --- loss: 1.517634, loss_ss: 1.087397, loss_d: 0.430238
0.8074 --- loss: 1.529825, loss_ss: 1.162483, loss_d: 0.367342
0.8458 --- loss: 1.621853, loss_ss: 1.129445, loss_d: 0.492408
0.8843 --- loss: 1.856089, loss_ss: 1.201434, loss_d: 0.654655
0.9227 --- loss: 1.556948, loss_ss: 0.930923, loss_d: 0.626025
0.9612 --- loss: 1.741434, loss_ss: 1.170452, loss_d: 0.570982
0.9996 --- loss: 3.045364, loss_ss: 2.755152, loss_d: 0.290211
Epoch finished! Loss: 1.912775335403589
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.180120, loss_ss: 1.586173, loss_d: 0.593948
0.0384 --- loss: 1.446617, loss_ss: 1.140560, loss_d: 0.306056
0.0769 --- loss: 1.886368, loss_ss: 1.527797, loss_d: 0.358571
0.1153 --- loss: 1.728761, loss_ss: 1.243780, loss_d: 0.484981
0.1538 --- loss: 1.883387, loss_ss: 1.214824, loss_d: 0.668563
0.1922 --- loss: 1.879636, loss_ss: 1.285554, loss_d: 0.594082
0.2307 --- loss: 1.470763, loss_ss: 1.060680, loss_d: 0.410083
0.2691 --- loss: 1.663417, loss_ss: 1.035711, loss_d: 0.627706
0.3076 --- loss: 1.619885, loss_ss: 1.084734, loss_d: 0.535151
0.3460 --- loss: 1.924565, loss_ss: 1.511796, loss_d: 0.412768
0.3845 --- loss: 1.819793, loss_ss: 1.102592, loss_d: 0.717200
0.4229 --- loss: 2.203831, loss_ss: 1.558417, loss_d: 0.645414
0.4614 --- loss: 1.686327, loss_ss: 1.044878, loss_d: 0.641448
0.4998 --- loss: 1.879318, loss_ss: 1.258937, loss_d: 0.620381
0.5383 --- loss: 1.501146, loss_ss: 1.061534, loss_d: 0.439612
0.5767 --- loss: 1.496148, loss_ss: 1.065670, loss_d: 0.430478
0.6151 --- loss: 1.887415, loss_ss: 1.129308, loss_d: 0.758107
0.6536 --- loss: 1.661532, loss_ss: 1.091461, loss_d: 0.570071
0.6920 --- loss: 1.991337, loss_ss: 1.476479, loss_d: 0.514859
0.7305 --- loss: 1.528032, loss_ss: 0.994477, loss_d: 0.533556
0.7689 --- loss: 1.986372, loss_ss: 1.288547, loss_d: 0.697825
0.8074 --- loss: 1.680429, loss_ss: 1.098154, loss_d: 0.582275
0.8458 --- loss: 1.587449, loss_ss: 1.122400, loss_d: 0.465048
0.8843 --- loss: 1.599014, loss_ss: 1.089657, loss_d: 0.509357
0.9227 --- loss: 1.564801, loss_ss: 1.104937, loss_d: 0.459864
0.9612 --- loss: 2.187518, loss_ss: 1.180415, loss_d: 1.007103
0.9996 --- loss: 2.263376, loss_ss: 0.920933, loss_d: 1.342443
Epoch finished! Loss: 1.697622925043106
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.884001, loss_ss: 1.294148, loss_d: 0.589853
0.0384 --- loss: 1.330564, loss_ss: 0.946853, loss_d: 0.383711
0.0769 --- loss: 1.192309, loss_ss: 0.804946, loss_d: 0.387363
0.1153 --- loss: 1.165589, loss_ss: 0.888123, loss_d: 0.277466
0.1538 --- loss: 1.517019, loss_ss: 1.136900, loss_d: 0.380119
0.1922 --- loss: 2.101758, loss_ss: 1.097984, loss_d: 1.003775
0.2307 --- loss: 1.464445, loss_ss: 0.999974, loss_d: 0.464471
0.2691 --- loss: 1.423467, loss_ss: 0.944668, loss_d: 0.478799
0.3076 --- loss: 1.528550, loss_ss: 0.924000, loss_d: 0.604550
0.3460 --- loss: 1.243400, loss_ss: 0.923037, loss_d: 0.320363
0.3845 --- loss: 1.722515, loss_ss: 0.911728, loss_d: 0.810787
0.4229 --- loss: 1.348638, loss_ss: 0.902243, loss_d: 0.446396
0.4614 --- loss: 1.514620, loss_ss: 1.048849, loss_d: 0.465771
0.4998 --- loss: 1.762924, loss_ss: 1.475299, loss_d: 0.287625
0.5383 --- loss: 1.401996, loss_ss: 1.068824, loss_d: 0.333171
0.5767 --- loss: 1.613326, loss_ss: 0.910935, loss_d: 0.702391
0.6151 --- loss: 1.342340, loss_ss: 0.830051, loss_d: 0.512289
0.6536 --- loss: 1.285461, loss_ss: 1.038100, loss_d: 0.247361
0.6920 --- loss: 1.169119, loss_ss: 0.912180, loss_d: 0.256939
0.7305 --- loss: 1.089949, loss_ss: 0.900828, loss_d: 0.189122
0.7689 --- loss: 1.431375, loss_ss: 1.041600, loss_d: 0.389774
0.8074 --- loss: 2.224386, loss_ss: 0.969672, loss_d: 1.254714
0.8458 --- loss: 1.607442, loss_ss: 1.131653, loss_d: 0.475790
0.8843 --- loss: 1.398829, loss_ss: 0.966894, loss_d: 0.431935
0.9227 --- loss: 1.278095, loss_ss: 0.884033, loss_d: 0.394062
0.9612 --- loss: 1.853066, loss_ss: 1.020422, loss_d: 0.832645
0.9996 --- loss: 2.647765, loss_ss: 2.371322, loss_d: 0.276443
Epoch finished! Loss: 1.5387486829207493
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.469269, loss_ss: 0.915103, loss_d: 0.554166
0.0384 --- loss: 1.591461, loss_ss: 0.996709, loss_d: 0.594752
0.0769 --- loss: 1.844046, loss_ss: 1.322351, loss_d: 0.521695
0.1153 --- loss: 1.339491, loss_ss: 1.099098, loss_d: 0.240393
0.1538 --- loss: 1.551547, loss_ss: 1.196461, loss_d: 0.355086
0.1922 --- loss: 1.229823, loss_ss: 0.846716, loss_d: 0.383107
0.2307 --- loss: 1.414621, loss_ss: 0.962586, loss_d: 0.452035
0.2691 --- loss: 1.756248, loss_ss: 0.933792, loss_d: 0.822456
0.3076 --- loss: 1.063651, loss_ss: 0.844042, loss_d: 0.219609
0.3460 --- loss: 1.535794, loss_ss: 1.034503, loss_d: 0.501292
0.3845 --- loss: 1.848545, loss_ss: 1.325166, loss_d: 0.523379
0.4229 --- loss: 1.050505, loss_ss: 0.859907, loss_d: 0.190598
0.4614 --- loss: 1.145335, loss_ss: 0.914456, loss_d: 0.230879
0.4998 --- loss: 1.409253, loss_ss: 0.862515, loss_d: 0.546738
0.5383 --- loss: 1.376128, loss_ss: 1.097093, loss_d: 0.279035
0.5767 --- loss: 1.224825, loss_ss: 0.884659, loss_d: 0.340166
0.6151 --- loss: 1.490584, loss_ss: 1.207250, loss_d: 0.283333
0.6536 --- loss: 1.216373, loss_ss: 0.866386, loss_d: 0.349987
0.6920 --- loss: 1.854996, loss_ss: 1.381661, loss_d: 0.473335
0.7305 --- loss: 1.496397, loss_ss: 0.800372, loss_d: 0.696026
0.7689 --- loss: 1.573604, loss_ss: 1.105173, loss_d: 0.468431
0.8074 --- loss: 1.128453, loss_ss: 0.851204, loss_d: 0.277249
0.8458 --- loss: 1.417513, loss_ss: 0.832197, loss_d: 0.585316
0.8843 --- loss: 1.487186, loss_ss: 0.930085, loss_d: 0.557102
0.9227 --- loss: 1.555029, loss_ss: 1.120635, loss_d: 0.434394
0.9612 --- loss: 1.531650, loss_ss: 1.166058, loss_d: 0.365592
0.9996 --- loss: 2.477332, loss_ss: 2.237162, loss_d: 0.240170
Epoch finished! Loss: 1.4829054002578441
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.507456, loss_ss: 0.994507, loss_d: 0.512948
0.0384 --- loss: 1.844744, loss_ss: 1.369949, loss_d: 0.474795
0.0769 --- loss: 1.259491, loss_ss: 0.904646, loss_d: 0.354844
0.1153 --- loss: 1.369030, loss_ss: 0.835061, loss_d: 0.533969
0.1538 --- loss: 1.204063, loss_ss: 0.906597, loss_d: 0.297466
0.1922 --- loss: 1.550143, loss_ss: 0.910908, loss_d: 0.639235
0.2307 --- loss: 1.360452, loss_ss: 0.984637, loss_d: 0.375815
0.2691 --- loss: 0.930964, loss_ss: 0.716407, loss_d: 0.214557
0.3076 --- loss: 1.594346, loss_ss: 1.200893, loss_d: 0.393453
0.3460 --- loss: 1.226550, loss_ss: 0.956791, loss_d: 0.269759
0.3845 --- loss: 1.064245, loss_ss: 0.899333, loss_d: 0.164912
0.4229 --- loss: 1.530496, loss_ss: 1.116334, loss_d: 0.414162
0.4614 --- loss: 1.727589, loss_ss: 1.194563, loss_d: 0.533026
0.4998 --- loss: 1.131335, loss_ss: 0.901652, loss_d: 0.229683
0.5383 --- loss: 2.085526, loss_ss: 0.983709, loss_d: 1.101817
0.5767 --- loss: 1.376638, loss_ss: 0.828579, loss_d: 0.548059
0.6151 --- loss: 1.159055, loss_ss: 0.819859, loss_d: 0.339197
0.6536 --- loss: 1.376083, loss_ss: 0.854795, loss_d: 0.521288
0.6920 --- loss: 1.373713, loss_ss: 0.849477, loss_d: 0.524236
0.7305 --- loss: 1.470652, loss_ss: 0.965119, loss_d: 0.505533
0.7689 --- loss: 1.039061, loss_ss: 0.803795, loss_d: 0.235267
0.8074 --- loss: 1.615812, loss_ss: 1.018826, loss_d: 0.596986
0.8458 --- loss: 1.177905, loss_ss: 0.930725, loss_d: 0.247180
0.8843 --- loss: 2.015445, loss_ss: 1.048728, loss_d: 0.966717
0.9227 --- loss: 1.474913, loss_ss: 1.015815, loss_d: 0.459098
0.9612 --- loss: 1.560860, loss_ss: 1.243887, loss_d: 0.316973
0.9996 --- loss: 2.295473, loss_ss: 2.171683, loss_d: 0.123790
Epoch finished! Loss: 1.3896600296864143
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.571055, loss_ss: 0.983011, loss_d: 0.588044
0.0384 --- loss: 1.202619, loss_ss: 1.053036, loss_d: 0.149582
0.0769 --- loss: 1.340208, loss_ss: 1.142563, loss_d: 0.197645
0.1153 --- loss: 1.552536, loss_ss: 1.093120, loss_d: 0.459416
0.1538 --- loss: 1.300612, loss_ss: 0.925242, loss_d: 0.375370
0.1922 --- loss: 1.151934, loss_ss: 0.945278, loss_d: 0.206656
0.2307 --- loss: 1.085947, loss_ss: 0.819899, loss_d: 0.266048
0.2691 --- loss: 0.884810, loss_ss: 0.655601, loss_d: 0.229208
0.3076 --- loss: 1.550655, loss_ss: 1.015635, loss_d: 0.535021
0.3460 --- loss: 1.334913, loss_ss: 1.043062, loss_d: 0.291851
0.3845 --- loss: 1.020942, loss_ss: 0.849846, loss_d: 0.171095
0.4229 --- loss: 1.444016, loss_ss: 1.035902, loss_d: 0.408115
0.4614 --- loss: 0.988402, loss_ss: 0.751321, loss_d: 0.237081
0.4998 --- loss: 1.465650, loss_ss: 1.049015, loss_d: 0.416636
0.5383 --- loss: 1.644681, loss_ss: 1.223530, loss_d: 0.421151
0.5767 --- loss: 1.100246, loss_ss: 0.792492, loss_d: 0.307753
0.6151 --- loss: 1.214273, loss_ss: 0.998160, loss_d: 0.216113
0.6536 --- loss: 1.370568, loss_ss: 1.066084, loss_d: 0.304484
0.6920 --- loss: 1.141001, loss_ss: 0.871308, loss_d: 0.269693
0.7305 --- loss: 1.286871, loss_ss: 0.915130, loss_d: 0.371741
0.7689 --- loss: 1.106589, loss_ss: 0.888778, loss_d: 0.217811
0.8074 --- loss: 1.416042, loss_ss: 1.239505, loss_d: 0.176537
0.8458 --- loss: 0.899368, loss_ss: 0.671886, loss_d: 0.227482
0.8843 --- loss: 1.531626, loss_ss: 1.142644, loss_d: 0.388982
0.9227 --- loss: 1.091902, loss_ss: 0.902785, loss_d: 0.189118
0.9612 --- loss: 1.697535, loss_ss: 1.073689, loss_d: 0.623846
0.9996 --- loss: 1.252817, loss_ss: 1.098360, loss_d: 0.154457
Epoch finished! Loss: 1.3197791383816646
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.989514, loss_ss: 0.772905, loss_d: 0.216609
0.0384 --- loss: 1.318702, loss_ss: 1.039421, loss_d: 0.279281
0.0769 --- loss: 1.194760, loss_ss: 1.010059, loss_d: 0.184701
0.1153 --- loss: 0.826534, loss_ss: 0.635844, loss_d: 0.190689
0.1538 --- loss: 1.360298, loss_ss: 1.091264, loss_d: 0.269035
0.1922 --- loss: 1.289167, loss_ss: 1.079755, loss_d: 0.209412
0.2307 --- loss: 1.136629, loss_ss: 0.756218, loss_d: 0.380411
0.2691 --- loss: 1.224122, loss_ss: 0.656746, loss_d: 0.567376
0.3076 --- loss: 1.239272, loss_ss: 0.954090, loss_d: 0.285182
0.3460 --- loss: 1.449830, loss_ss: 0.723756, loss_d: 0.726074
0.3845 --- loss: 0.849810, loss_ss: 0.746278, loss_d: 0.103531
0.4229 --- loss: 1.276539, loss_ss: 0.840476, loss_d: 0.436062
0.4614 --- loss: 1.480399, loss_ss: 0.974744, loss_d: 0.505656
0.4998 --- loss: 1.120027, loss_ss: 0.874360, loss_d: 0.245666
0.5383 --- loss: 1.077508, loss_ss: 0.865842, loss_d: 0.211666
0.5767 --- loss: 0.802156, loss_ss: 0.677971, loss_d: 0.124186
0.6151 --- loss: 1.114094, loss_ss: 0.848664, loss_d: 0.265430
0.6536 --- loss: 1.212024, loss_ss: 0.885811, loss_d: 0.326213
0.6920 --- loss: 1.183392, loss_ss: 0.850220, loss_d: 0.333172
0.7305 --- loss: 1.445890, loss_ss: 0.698061, loss_d: 0.747830
0.7689 --- loss: 0.720829, loss_ss: 0.508333, loss_d: 0.212496
0.8074 --- loss: 1.304505, loss_ss: 1.048138, loss_d: 0.256367
0.8458 --- loss: 1.129921, loss_ss: 0.911375, loss_d: 0.218545
0.8843 --- loss: 0.956216, loss_ss: 0.756056, loss_d: 0.200160
0.9227 --- loss: 1.332887, loss_ss: 1.003789, loss_d: 0.329098
0.9612 --- loss: 1.250360, loss_ss: 0.957067, loss_d: 0.293293
0.9996 --- loss: 1.051391, loss_ss: 0.993838, loss_d: 0.057553
Epoch finished! Loss: 1.2561079593805167
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.035097, loss_ss: 0.918085, loss_d: 0.117012
0.0384 --- loss: 1.186671, loss_ss: 0.720829, loss_d: 0.465842
0.0769 --- loss: 1.072537, loss_ss: 0.720685, loss_d: 0.351852
0.1153 --- loss: 0.901860, loss_ss: 0.719358, loss_d: 0.182502
0.1538 --- loss: 1.154573, loss_ss: 0.846431, loss_d: 0.308142
0.1922 --- loss: 1.306027, loss_ss: 0.983607, loss_d: 0.322420
0.2307 --- loss: 1.041276, loss_ss: 0.924593, loss_d: 0.116684
0.2691 --- loss: 0.970484, loss_ss: 0.874532, loss_d: 0.095952
0.3076 --- loss: 1.517193, loss_ss: 1.135299, loss_d: 0.381894
0.3460 --- loss: 1.258485, loss_ss: 0.645688, loss_d: 0.612797
0.3845 --- loss: 1.508291, loss_ss: 1.066406, loss_d: 0.441885
0.4229 --- loss: 1.339361, loss_ss: 0.975505, loss_d: 0.363856
0.4614 --- loss: 1.086769, loss_ss: 0.849072, loss_d: 0.237697
0.4998 --- loss: 1.687927, loss_ss: 1.217534, loss_d: 0.470394
0.5383 --- loss: 0.900538, loss_ss: 0.700948, loss_d: 0.199591
0.5767 --- loss: 1.631144, loss_ss: 1.440808, loss_d: 0.190336
0.6151 --- loss: 1.259011, loss_ss: 1.090302, loss_d: 0.168709
0.6536 --- loss: 0.755328, loss_ss: 0.624515, loss_d: 0.130813
0.6920 --- loss: 1.695902, loss_ss: 0.991772, loss_d: 0.704130
0.7305 --- loss: 0.883726, loss_ss: 0.656687, loss_d: 0.227039
0.7689 --- loss: 1.194984, loss_ss: 0.773167, loss_d: 0.421817
0.8074 --- loss: 0.870762, loss_ss: 0.778883, loss_d: 0.091879
0.8458 --- loss: 0.977507, loss_ss: 0.889087, loss_d: 0.088420
0.8843 --- loss: 1.349376, loss_ss: 0.909446, loss_d: 0.439930
0.9227 --- loss: 0.984871, loss_ss: 0.641697, loss_d: 0.343174
0.9612 --- loss: 0.952931, loss_ss: 0.765360, loss_d: 0.187571
0.9996 --- loss: 0.751178, loss_ss: 0.675210, loss_d: 0.075968
Epoch finished! Loss: 1.2028936564922332
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.176996, loss_ss: 1.010454, loss_d: 0.166542
0.0384 --- loss: 1.444564, loss_ss: 0.846797, loss_d: 0.597767
0.0769 --- loss: 1.192349, loss_ss: 0.861189, loss_d: 0.331160
0.1153 --- loss: 1.077563, loss_ss: 0.823953, loss_d: 0.253610
0.1538 --- loss: 1.361715, loss_ss: 0.778503, loss_d: 0.583212
0.1922 --- loss: 1.536373, loss_ss: 1.157632, loss_d: 0.378741
0.2307 --- loss: 1.541543, loss_ss: 1.271025, loss_d: 0.270518
0.2691 --- loss: 1.561101, loss_ss: 0.926781, loss_d: 0.634319
0.3076 --- loss: 1.367341, loss_ss: 0.910237, loss_d: 0.457105
0.3460 --- loss: 1.176099, loss_ss: 0.879621, loss_d: 0.296478
0.3845 --- loss: 0.949164, loss_ss: 0.724930, loss_d: 0.224234
0.4229 --- loss: 1.258507, loss_ss: 0.837053, loss_d: 0.421454
0.4614 --- loss: 1.205563, loss_ss: 1.080403, loss_d: 0.125160
0.4998 --- loss: 0.863914, loss_ss: 0.759793, loss_d: 0.104121
0.5383 --- loss: 1.056987, loss_ss: 0.906165, loss_d: 0.150822
0.5767 --- loss: 0.983236, loss_ss: 0.837741, loss_d: 0.145495
0.6151 --- loss: 1.093453, loss_ss: 0.664746, loss_d: 0.428707
0.6536 --- loss: 1.246903, loss_ss: 0.922104, loss_d: 0.324798
0.6920 --- loss: 1.204180, loss_ss: 1.017534, loss_d: 0.186647
0.7305 --- loss: 0.964536, loss_ss: 0.779801, loss_d: 0.184735
0.7689 --- loss: 0.941213, loss_ss: 0.867447, loss_d: 0.073766
0.8074 --- loss: 1.035334, loss_ss: 0.687818, loss_d: 0.347516
0.8458 --- loss: 0.849333, loss_ss: 0.631794, loss_d: 0.217539
0.8843 --- loss: 1.194801, loss_ss: 0.861439, loss_d: 0.333362
0.9227 --- loss: 1.171625, loss_ss: 0.908033, loss_d: 0.263591
0.9612 --- loss: 1.231458, loss_ss: 0.719707, loss_d: 0.511751
0.9996 --- loss: 1.337501, loss_ss: 1.314374, loss_d: 0.023127
Epoch finished! Loss: 1.1812081914681656
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.255864, loss_ss: 0.895536, loss_d: 0.360328
0.0384 --- loss: 0.890610, loss_ss: 0.808627, loss_d: 0.081983
0.0769 --- loss: 0.821416, loss_ss: 0.635378, loss_d: 0.186038
0.1153 --- loss: 1.535888, loss_ss: 0.999274, loss_d: 0.536615
0.1538 --- loss: 1.271662, loss_ss: 1.028195, loss_d: 0.243467
0.1922 --- loss: 1.198748, loss_ss: 1.009483, loss_d: 0.189265
0.2307 --- loss: 1.406601, loss_ss: 0.611714, loss_d: 0.794888
0.2691 --- loss: 0.945099, loss_ss: 0.629996, loss_d: 0.315103
0.3076 --- loss: 1.623691, loss_ss: 0.971190, loss_d: 0.652501
0.3460 --- loss: 1.113000, loss_ss: 0.927203, loss_d: 0.185796
0.3845 --- loss: 0.949464, loss_ss: 0.867908, loss_d: 0.081557
0.4229 --- loss: 1.281277, loss_ss: 0.807402, loss_d: 0.473874
0.4614 --- loss: 0.940986, loss_ss: 0.801867, loss_d: 0.139120
0.4998 --- loss: 1.085514, loss_ss: 0.928033, loss_d: 0.157480
0.5383 --- loss: 1.761548, loss_ss: 0.660058, loss_d: 1.101490
0.5767 --- loss: 0.987433, loss_ss: 0.868227, loss_d: 0.119206
0.6151 --- loss: 1.239022, loss_ss: 0.974005, loss_d: 0.265017
0.6536 --- loss: 1.205836, loss_ss: 0.934090, loss_d: 0.271747
0.6920 --- loss: 1.149662, loss_ss: 0.883433, loss_d: 0.266229
0.7305 --- loss: 1.088228, loss_ss: 1.021246, loss_d: 0.066982
0.7689 --- loss: 0.897494, loss_ss: 0.720768, loss_d: 0.176726
0.8074 --- loss: 0.986841, loss_ss: 0.772764, loss_d: 0.214077
0.8458 --- loss: 1.586336, loss_ss: 0.802406, loss_d: 0.783930
0.8843 --- loss: 1.203199, loss_ss: 0.885117, loss_d: 0.318082
0.9227 --- loss: 1.217894, loss_ss: 0.962985, loss_d: 0.254909
0.9612 --- loss: 1.189244, loss_ss: 0.983546, loss_d: 0.205698
0.9996 --- loss: 1.298798, loss_ss: 1.254276, loss_d: 0.044521
Epoch finished! Loss: 1.148888977445089
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7162162162162162
             precision    recall  f1-score   support

        0.0       0.88      0.83      0.85       247
        1.0       0.64      0.31      0.42       254
        2.0       0.72      0.83      0.77       355
        3.0       0.78      0.78      0.78        87
        4.0       0.57      0.88      0.69       167

avg / total       0.72      0.72      0.70      1110
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.69  83.00   96.76  87.98     85.42
1  80.27  31.10   94.86  64.23     41.91
2  84.41  83.38   84.90  72.20     77.39
3  96.58  78.16   98.14  78.16     78.16
4  88.29  88.02   88.34  57.20     69.34
Total accuracy: 71.62%
Average sen: 72.73%
Average spec: 92.60%
Macro f1-score: 70.44%
[0.99975997 0.99625885 0.99461597 0.99727112 0.99591666 0.9992488
 0.99274832 0.9854424  0.99836498 0.99696356 0.99333763 0.99296027
 0.99644804 0.99860162 0.99860758 0.96221238 0.96711427 0.99490792
 0.9980076  0.99153566 0.99980587 0.99899656 0.99980074 0.99922824
 0.97903317 0.95854664 0.99630982 0.94826007 0.99236989 0.96848631
 0.99375689 0.99290961 0.99903464 0.9688493  0.96019244 0.96405911
 0.9139775 ]
pred: 0.9860524438522957, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.247206, loss_ss: 1.562394, loss_d: 0.684812
0.0385 --- loss: 2.607954, loss_ss: 1.510605, loss_d: 1.097349
0.0770 --- loss: 2.074957, loss_ss: 1.449227, loss_d: 0.625729
0.1156 --- loss: 1.924634, loss_ss: 1.376776, loss_d: 0.547858
0.1541 --- loss: 1.960652, loss_ss: 1.378889, loss_d: 0.581763
0.1926 --- loss: 1.771135, loss_ss: 1.355630, loss_d: 0.415505
0.2311 --- loss: 1.932907, loss_ss: 1.321417, loss_d: 0.611490
0.2696 --- loss: 1.773695, loss_ss: 1.341640, loss_d: 0.432055
0.3082 --- loss: 2.125792, loss_ss: 1.352080, loss_d: 0.773712
0.3467 --- loss: 2.011130, loss_ss: 1.361059, loss_d: 0.650071
0.3852 --- loss: 1.950055, loss_ss: 1.210302, loss_d: 0.739753
0.4237 --- loss: 1.647998, loss_ss: 1.215975, loss_d: 0.432022
0.4622 --- loss: 1.728562, loss_ss: 1.278787, loss_d: 0.449775
0.5008 --- loss: 2.093225, loss_ss: 1.201931, loss_d: 0.891294
0.5393 --- loss: 1.964741, loss_ss: 1.331731, loss_d: 0.633010
0.5778 --- loss: 1.594307, loss_ss: 1.236163, loss_d: 0.358144
0.6163 --- loss: 1.761330, loss_ss: 1.275257, loss_d: 0.486074
0.6549 --- loss: 1.866877, loss_ss: 1.361044, loss_d: 0.505834
0.6934 --- loss: 2.090491, loss_ss: 1.158132, loss_d: 0.932359
0.7319 --- loss: 1.675044, loss_ss: 1.156704, loss_d: 0.518340
0.7704 --- loss: 1.673330, loss_ss: 1.162601, loss_d: 0.510729
0.8089 --- loss: 1.761814, loss_ss: 1.067496, loss_d: 0.694318
0.8475 --- loss: 2.029403, loss_ss: 1.373054, loss_d: 0.656349
0.8860 --- loss: 1.690234, loss_ss: 1.229995, loss_d: 0.460239
0.9245 --- loss: 2.190113, loss_ss: 1.609200, loss_d: 0.580913
0.9630 --- loss: 1.953982, loss_ss: 1.525424, loss_d: 0.428557
Epoch finished! Loss: 1.8945345616248583
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.806083, loss_ss: 1.307330, loss_d: 0.498754
0.0385 --- loss: 1.761577, loss_ss: 1.343457, loss_d: 0.418120
0.0770 --- loss: 1.842088, loss_ss: 1.118098, loss_d: 0.723990
0.1156 --- loss: 1.625409, loss_ss: 1.284506, loss_d: 0.340903
0.1541 --- loss: 1.968945, loss_ss: 1.304139, loss_d: 0.664806
0.1926 --- loss: 2.046037, loss_ss: 1.163347, loss_d: 0.882689
0.2311 --- loss: 1.663450, loss_ss: 0.889481, loss_d: 0.773969
0.2696 --- loss: 1.758949, loss_ss: 1.011474, loss_d: 0.747475
0.3082 --- loss: 1.667588, loss_ss: 1.138740, loss_d: 0.528848
0.3467 --- loss: 1.667945, loss_ss: 1.262864, loss_d: 0.405081
0.3852 --- loss: 1.758518, loss_ss: 1.028384, loss_d: 0.730134
0.4237 --- loss: 1.607019, loss_ss: 0.917231, loss_d: 0.689788
0.4622 --- loss: 1.876728, loss_ss: 1.168152, loss_d: 0.708576
0.5008 --- loss: 1.475660, loss_ss: 0.924640, loss_d: 0.551021
0.5393 --- loss: 1.491347, loss_ss: 0.955648, loss_d: 0.535699
0.5778 --- loss: 1.399953, loss_ss: 0.774727, loss_d: 0.625227
0.6163 --- loss: 1.564800, loss_ss: 1.041927, loss_d: 0.522873
0.6549 --- loss: 1.372016, loss_ss: 1.072164, loss_d: 0.299852
0.6934 --- loss: 1.860670, loss_ss: 0.812153, loss_d: 1.048517
0.7319 --- loss: 1.593571, loss_ss: 0.991320, loss_d: 0.602251
0.7704 --- loss: 1.443282, loss_ss: 0.967700, loss_d: 0.475581
0.8089 --- loss: 1.561169, loss_ss: 0.990567, loss_d: 0.570602
0.8475 --- loss: 1.483801, loss_ss: 0.830943, loss_d: 0.652858
0.8860 --- loss: 1.996006, loss_ss: 1.015619, loss_d: 0.980387
0.9245 --- loss: 1.880967, loss_ss: 1.374915, loss_d: 0.506052
0.9630 --- loss: 1.760265, loss_ss: 1.188031, loss_d: 0.572234
Epoch finished! Loss: 1.6727588310204877
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.465088, loss_ss: 0.930885, loss_d: 0.534203
0.0385 --- loss: 1.454411, loss_ss: 0.975196, loss_d: 0.479216
0.0770 --- loss: 1.580231, loss_ss: 1.005721, loss_d: 0.574510
0.1156 --- loss: 1.633494, loss_ss: 0.906256, loss_d: 0.727237
0.1541 --- loss: 1.717221, loss_ss: 0.772187, loss_d: 0.945035
0.1926 --- loss: 1.411472, loss_ss: 1.004336, loss_d: 0.407136
0.2311 --- loss: 1.699436, loss_ss: 1.191318, loss_d: 0.508118
0.2696 --- loss: 1.496408, loss_ss: 0.893364, loss_d: 0.603044
0.3082 --- loss: 1.271016, loss_ss: 0.869756, loss_d: 0.401260
0.3467 --- loss: 1.260028, loss_ss: 0.884037, loss_d: 0.375990
0.3852 --- loss: 1.733980, loss_ss: 1.175777, loss_d: 0.558203
0.4237 --- loss: 1.712107, loss_ss: 1.032353, loss_d: 0.679754
0.4622 --- loss: 1.555634, loss_ss: 0.946800, loss_d: 0.608834
0.5008 --- loss: 1.377631, loss_ss: 0.822207, loss_d: 0.555423
0.5393 --- loss: 1.525833, loss_ss: 0.890663, loss_d: 0.635170
0.5778 --- loss: 1.083124, loss_ss: 0.760276, loss_d: 0.322848
0.6163 --- loss: 1.480522, loss_ss: 1.025875, loss_d: 0.454647
0.6549 --- loss: 1.279770, loss_ss: 0.879390, loss_d: 0.400380
0.6934 --- loss: 1.388743, loss_ss: 0.914319, loss_d: 0.474424
0.7319 --- loss: 1.224505, loss_ss: 0.742069, loss_d: 0.482436
0.7704 --- loss: 1.415887, loss_ss: 0.941898, loss_d: 0.473989
0.8089 --- loss: 1.503006, loss_ss: 0.848476, loss_d: 0.654531
0.8475 --- loss: 1.427660, loss_ss: 0.970909, loss_d: 0.456751
0.8860 --- loss: 1.876394, loss_ss: 1.452586, loss_d: 0.423808
0.9245 --- loss: 1.671860, loss_ss: 1.102944, loss_d: 0.568915
0.9630 --- loss: 1.444671, loss_ss: 0.871856, loss_d: 0.572815
Epoch finished! Loss: 1.5617029998293255
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.631821, loss_ss: 1.065567, loss_d: 0.566254
0.0385 --- loss: 1.640215, loss_ss: 1.312720, loss_d: 0.327494
0.0770 --- loss: 1.139354, loss_ss: 0.826366, loss_d: 0.312988
0.1156 --- loss: 1.601853, loss_ss: 0.916440, loss_d: 0.685413
0.1541 --- loss: 1.494389, loss_ss: 0.925126, loss_d: 0.569263
0.1926 --- loss: 1.913345, loss_ss: 0.856446, loss_d: 1.056899
0.2311 --- loss: 1.917547, loss_ss: 1.285156, loss_d: 0.632391
0.2696 --- loss: 1.559734, loss_ss: 1.100253, loss_d: 0.459481
0.3082 --- loss: 1.540903, loss_ss: 1.036785, loss_d: 0.504118
0.3467 --- loss: 1.808958, loss_ss: 0.998335, loss_d: 0.810623
0.3852 --- loss: 1.904690, loss_ss: 1.461343, loss_d: 0.443346
0.4237 --- loss: 1.226021, loss_ss: 0.907042, loss_d: 0.318979
0.4622 --- loss: 0.985415, loss_ss: 0.725787, loss_d: 0.259628
0.5008 --- loss: 1.301705, loss_ss: 0.701238, loss_d: 0.600467
0.5393 --- loss: 1.261358, loss_ss: 0.870772, loss_d: 0.390586
0.5778 --- loss: 1.442598, loss_ss: 0.847482, loss_d: 0.595117
0.6163 --- loss: 1.308679, loss_ss: 0.923519, loss_d: 0.385160
0.6549 --- loss: 1.591638, loss_ss: 1.018355, loss_d: 0.573283
0.6934 --- loss: 1.688006, loss_ss: 1.217167, loss_d: 0.470839
0.7319 --- loss: 1.713750, loss_ss: 1.181086, loss_d: 0.532664
0.7704 --- loss: 1.284923, loss_ss: 1.004751, loss_d: 0.280172
0.8089 --- loss: 1.656289, loss_ss: 0.913995, loss_d: 0.742294
0.8475 --- loss: 1.195939, loss_ss: 0.883297, loss_d: 0.312642
0.8860 --- loss: 1.420581, loss_ss: 0.792509, loss_d: 0.628072
0.9245 --- loss: 1.528201, loss_ss: 0.906215, loss_d: 0.621986
0.9630 --- loss: 1.300750, loss_ss: 0.729202, loss_d: 0.571547
Epoch finished! Loss: 1.4679053156532376
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.610034, loss_ss: 1.235026, loss_d: 0.375008
0.0385 --- loss: 1.640979, loss_ss: 1.271209, loss_d: 0.369770
0.0770 --- loss: 1.078255, loss_ss: 0.808373, loss_d: 0.269881
0.1156 --- loss: 1.234602, loss_ss: 0.962167, loss_d: 0.272435
0.1541 --- loss: 1.412941, loss_ss: 0.714831, loss_d: 0.698110
0.1926 --- loss: 1.097316, loss_ss: 0.885947, loss_d: 0.211369
0.2311 --- loss: 1.718861, loss_ss: 0.968157, loss_d: 0.750704
0.2696 --- loss: 1.687254, loss_ss: 1.116239, loss_d: 0.571015
0.3082 --- loss: 1.318358, loss_ss: 0.817390, loss_d: 0.500968
0.3467 --- loss: 1.323067, loss_ss: 0.887710, loss_d: 0.435357
0.3852 --- loss: 1.503316, loss_ss: 1.051504, loss_d: 0.451813
0.4237 --- loss: 1.651716, loss_ss: 1.134276, loss_d: 0.517440
0.4622 --- loss: 1.056079, loss_ss: 0.781175, loss_d: 0.274904
0.5008 --- loss: 1.388182, loss_ss: 0.835816, loss_d: 0.552366
0.5393 --- loss: 1.317964, loss_ss: 1.083442, loss_d: 0.234523
0.5778 --- loss: 1.216089, loss_ss: 0.777399, loss_d: 0.438690
0.6163 --- loss: 1.250266, loss_ss: 0.778336, loss_d: 0.471931
0.6549 --- loss: 1.737566, loss_ss: 1.037192, loss_d: 0.700374
0.6934 --- loss: 1.381099, loss_ss: 0.846045, loss_d: 0.535053
0.7319 --- loss: 0.878132, loss_ss: 0.690726, loss_d: 0.187406
0.7704 --- loss: 1.873351, loss_ss: 0.903556, loss_d: 0.969794
0.8089 --- loss: 1.430781, loss_ss: 1.130260, loss_d: 0.300521
0.8475 --- loss: 1.153794, loss_ss: 0.723063, loss_d: 0.430731
0.8860 --- loss: 1.173726, loss_ss: 0.829080, loss_d: 0.344646
0.9245 --- loss: 1.013335, loss_ss: 0.632307, loss_d: 0.381027
0.9630 --- loss: 0.957758, loss_ss: 0.678393, loss_d: 0.279366
Epoch finished! Loss: 1.3882721241376574
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.464422, loss_ss: 1.277311, loss_d: 0.187111
0.0385 --- loss: 1.550735, loss_ss: 1.138228, loss_d: 0.412507
0.0770 --- loss: 1.305766, loss_ss: 0.803026, loss_d: 0.502740
0.1156 --- loss: 1.460264, loss_ss: 0.995536, loss_d: 0.464728
0.1541 --- loss: 1.052366, loss_ss: 0.831641, loss_d: 0.220726
0.1926 --- loss: 1.450356, loss_ss: 1.099052, loss_d: 0.351304
0.2311 --- loss: 1.332077, loss_ss: 0.949106, loss_d: 0.382971
0.2696 --- loss: 1.750922, loss_ss: 0.933006, loss_d: 0.817917
0.3082 --- loss: 1.016542, loss_ss: 0.737774, loss_d: 0.278768
0.3467 --- loss: 1.173270, loss_ss: 0.842336, loss_d: 0.330934
0.3852 --- loss: 1.049923, loss_ss: 0.796378, loss_d: 0.253545
0.4237 --- loss: 0.944717, loss_ss: 0.767713, loss_d: 0.177003
0.4622 --- loss: 1.122375, loss_ss: 0.919272, loss_d: 0.203103
0.5008 --- loss: 1.667527, loss_ss: 1.203200, loss_d: 0.464327
0.5393 --- loss: 1.717093, loss_ss: 1.025159, loss_d: 0.691934
0.5778 --- loss: 1.051009, loss_ss: 0.852552, loss_d: 0.198457
0.6163 --- loss: 1.075561, loss_ss: 0.759894, loss_d: 0.315666
0.6549 --- loss: 1.051619, loss_ss: 0.750495, loss_d: 0.301124
0.6934 --- loss: 1.363150, loss_ss: 1.010848, loss_d: 0.352303
0.7319 --- loss: 1.047030, loss_ss: 0.674395, loss_d: 0.372634
0.7704 --- loss: 0.945755, loss_ss: 0.712896, loss_d: 0.232860
0.8089 --- loss: 1.700536, loss_ss: 1.173103, loss_d: 0.527434
0.8475 --- loss: 1.445090, loss_ss: 0.821232, loss_d: 0.623858
0.8860 --- loss: 1.468010, loss_ss: 1.032220, loss_d: 0.435790
0.9245 --- loss: 1.234425, loss_ss: 0.864677, loss_d: 0.369748
0.9630 --- loss: 1.465489, loss_ss: 0.878652, loss_d: 0.586837
Epoch finished! Loss: 1.3010519607186777
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.521671, loss_ss: 0.936172, loss_d: 0.585499
0.0385 --- loss: 1.011885, loss_ss: 0.834058, loss_d: 0.177827
0.0770 --- loss: 1.031795, loss_ss: 0.800470, loss_d: 0.231325
0.1156 --- loss: 1.136159, loss_ss: 0.860086, loss_d: 0.276073
0.1541 --- loss: 2.105368, loss_ss: 1.065640, loss_d: 1.039728
0.1926 --- loss: 1.258579, loss_ss: 0.927648, loss_d: 0.330931
0.2311 --- loss: 1.200711, loss_ss: 0.700526, loss_d: 0.500184
0.2696 --- loss: 1.875717, loss_ss: 1.058681, loss_d: 0.817036
0.3082 --- loss: 1.428827, loss_ss: 0.829447, loss_d: 0.599380
0.3467 --- loss: 1.118767, loss_ss: 0.734013, loss_d: 0.384754
0.3852 --- loss: 1.468350, loss_ss: 1.218152, loss_d: 0.250198
0.4237 --- loss: 1.729504, loss_ss: 1.321697, loss_d: 0.407807
0.4622 --- loss: 1.274035, loss_ss: 0.854230, loss_d: 0.419805
0.5008 --- loss: 1.100522, loss_ss: 0.726493, loss_d: 0.374029
0.5393 --- loss: 1.354475, loss_ss: 1.015870, loss_d: 0.338605
0.5778 --- loss: 0.949779, loss_ss: 0.538717, loss_d: 0.411063
0.6163 --- loss: 1.181844, loss_ss: 0.916150, loss_d: 0.265694
0.6549 --- loss: 0.936522, loss_ss: 0.788602, loss_d: 0.147920
0.6934 --- loss: 1.381845, loss_ss: 0.877310, loss_d: 0.504535
0.7319 --- loss: 1.139978, loss_ss: 0.919778, loss_d: 0.220200
0.7704 --- loss: 1.255278, loss_ss: 0.856458, loss_d: 0.398820
0.8089 --- loss: 1.275651, loss_ss: 0.859189, loss_d: 0.416461
0.8475 --- loss: 1.105424, loss_ss: 0.898741, loss_d: 0.206683
0.8860 --- loss: 0.887521, loss_ss: 0.664491, loss_d: 0.223030
0.9245 --- loss: 1.094028, loss_ss: 0.878673, loss_d: 0.215356
0.9630 --- loss: 1.184385, loss_ss: 0.925930, loss_d: 0.258455
Epoch finished! Loss: 1.2756056672817953
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.079358, loss_ss: 0.891430, loss_d: 0.187928
0.0385 --- loss: 1.186925, loss_ss: 0.869246, loss_d: 0.317679
0.0770 --- loss: 1.231218, loss_ss: 0.749493, loss_d: 0.481724
0.1156 --- loss: 1.075050, loss_ss: 0.784653, loss_d: 0.290397
0.1541 --- loss: 1.060238, loss_ss: 0.854245, loss_d: 0.205992
0.1926 --- loss: 1.170728, loss_ss: 0.738683, loss_d: 0.432045
0.2311 --- loss: 0.966536, loss_ss: 0.659169, loss_d: 0.307368
0.2696 --- loss: 1.309699, loss_ss: 0.745308, loss_d: 0.564391
0.3082 --- loss: 1.231848, loss_ss: 0.982897, loss_d: 0.248951
0.3467 --- loss: 1.408068, loss_ss: 0.872729, loss_d: 0.535338
0.3852 --- loss: 1.220305, loss_ss: 0.964344, loss_d: 0.255961
0.4237 --- loss: 0.987952, loss_ss: 0.771999, loss_d: 0.215953
0.4622 --- loss: 1.161454, loss_ss: 0.872538, loss_d: 0.288917
0.5008 --- loss: 1.049389, loss_ss: 0.827276, loss_d: 0.222113
0.5393 --- loss: 1.299194, loss_ss: 1.096170, loss_d: 0.203024
0.5778 --- loss: 0.878839, loss_ss: 0.635792, loss_d: 0.243047
0.6163 --- loss: 1.653091, loss_ss: 1.202996, loss_d: 0.450095
0.6549 --- loss: 0.907062, loss_ss: 0.629027, loss_d: 0.278035
0.6934 --- loss: 1.241035, loss_ss: 0.854333, loss_d: 0.386702
0.7319 --- loss: 1.510628, loss_ss: 1.011976, loss_d: 0.498652
0.7704 --- loss: 1.238127, loss_ss: 0.754301, loss_d: 0.483827
0.8089 --- loss: 1.165127, loss_ss: 0.864106, loss_d: 0.301021
0.8475 --- loss: 1.839342, loss_ss: 0.717601, loss_d: 1.121741
0.8860 --- loss: 1.150486, loss_ss: 0.727006, loss_d: 0.423480
0.9245 --- loss: 1.226497, loss_ss: 0.714079, loss_d: 0.512418
0.9630 --- loss: 1.007503, loss_ss: 0.819850, loss_d: 0.187653
Epoch finished! Loss: 1.2306491302247213
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.194599, loss_ss: 0.962070, loss_d: 0.232529
0.0385 --- loss: 1.553564, loss_ss: 0.907447, loss_d: 0.646117
0.0770 --- loss: 1.330165, loss_ss: 0.840633, loss_d: 0.489532
0.1156 --- loss: 1.251813, loss_ss: 1.096949, loss_d: 0.154864
0.1541 --- loss: 1.325577, loss_ss: 0.826240, loss_d: 0.499337
0.1926 --- loss: 1.251369, loss_ss: 0.743423, loss_d: 0.507946
0.2311 --- loss: 0.865575, loss_ss: 0.646889, loss_d: 0.218686
0.2696 --- loss: 0.785697, loss_ss: 0.620914, loss_d: 0.164783
0.3082 --- loss: 1.352887, loss_ss: 0.953578, loss_d: 0.399308
0.3467 --- loss: 0.781943, loss_ss: 0.649069, loss_d: 0.132875
0.3852 --- loss: 1.297636, loss_ss: 0.923347, loss_d: 0.374289
0.4237 --- loss: 1.623531, loss_ss: 1.040838, loss_d: 0.582693
0.4622 --- loss: 0.932245, loss_ss: 0.763721, loss_d: 0.168524
0.5008 --- loss: 0.853293, loss_ss: 0.677980, loss_d: 0.175313
0.5393 --- loss: 0.742659, loss_ss: 0.583508, loss_d: 0.159151
0.5778 --- loss: 1.823045, loss_ss: 1.229451, loss_d: 0.593593
0.6163 --- loss: 1.044591, loss_ss: 0.761923, loss_d: 0.282668
0.6549 --- loss: 1.783502, loss_ss: 1.253111, loss_d: 0.530391
0.6934 --- loss: 0.914353, loss_ss: 0.813703, loss_d: 0.100651
0.7319 --- loss: 1.165110, loss_ss: 0.830354, loss_d: 0.334756
0.7704 --- loss: 1.353234, loss_ss: 1.074781, loss_d: 0.278453
0.8089 --- loss: 1.408530, loss_ss: 0.961729, loss_d: 0.446801
0.8475 --- loss: 1.105465, loss_ss: 0.752050, loss_d: 0.353415
0.8860 --- loss: 1.099005, loss_ss: 0.894673, loss_d: 0.204332
0.9245 --- loss: 1.056140, loss_ss: 0.808758, loss_d: 0.247382
0.9630 --- loss: 1.119699, loss_ss: 0.715137, loss_d: 0.404561
Epoch finished! Loss: 1.1747136620020775
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.941489, loss_ss: 0.873184, loss_d: 0.068305
0.0385 --- loss: 1.325256, loss_ss: 0.628332, loss_d: 0.696925
0.0770 --- loss: 0.801419, loss_ss: 0.694636, loss_d: 0.106783
0.1156 --- loss: 0.999620, loss_ss: 0.863891, loss_d: 0.135729
0.1541 --- loss: 1.386312, loss_ss: 0.841147, loss_d: 0.545165
0.1926 --- loss: 1.130614, loss_ss: 1.026667, loss_d: 0.103947
0.2311 --- loss: 1.254720, loss_ss: 0.739690, loss_d: 0.515030
0.2696 --- loss: 1.165468, loss_ss: 1.027038, loss_d: 0.138430
0.3082 --- loss: 1.137797, loss_ss: 0.978573, loss_d: 0.159224
0.3467 --- loss: 0.920589, loss_ss: 0.784557, loss_d: 0.136031
0.3852 --- loss: 1.136173, loss_ss: 0.803325, loss_d: 0.332847
0.4237 --- loss: 1.371819, loss_ss: 0.715685, loss_d: 0.656134
0.4622 --- loss: 1.106417, loss_ss: 0.650488, loss_d: 0.455929
0.5008 --- loss: 1.109828, loss_ss: 0.856224, loss_d: 0.253605
0.5393 --- loss: 1.421036, loss_ss: 0.844618, loss_d: 0.576418
0.5778 --- loss: 1.468262, loss_ss: 0.768909, loss_d: 0.699354
0.6163 --- loss: 0.974511, loss_ss: 0.765811, loss_d: 0.208700
0.6549 --- loss: 1.099271, loss_ss: 0.954258, loss_d: 0.145012
0.6934 --- loss: 0.863245, loss_ss: 0.703601, loss_d: 0.159644
0.7319 --- loss: 0.799521, loss_ss: 0.706434, loss_d: 0.093087
0.7704 --- loss: 0.863673, loss_ss: 0.766251, loss_d: 0.097423
0.8089 --- loss: 0.926053, loss_ss: 0.725595, loss_d: 0.200458
0.8475 --- loss: 0.954034, loss_ss: 0.633755, loss_d: 0.320279
0.8860 --- loss: 1.528106, loss_ss: 0.957579, loss_d: 0.570527
0.9245 --- loss: 0.771405, loss_ss: 0.684405, loss_d: 0.087000
0.9630 --- loss: 1.209229, loss_ss: 0.933106, loss_d: 0.276124
Epoch finished! Loss: 1.135517542196517
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6666666666666666
             precision    recall  f1-score   support

        0.0       0.82      0.74      0.78       519
        1.0       0.36      0.30      0.33       201
        2.0       0.53      0.99      0.69       228
        3.0       0.99      0.70      0.82       158
        4.0       0.65      0.39      0.49       154

avg / total       0.70      0.67      0.66      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.86  74.18   88.93  82.44     78.09
1  80.48  29.85   90.08  36.36     32.79
2  83.97  98.68   80.72  53.07     69.02
3  96.11  69.62   99.91  99.10     81.78
4  89.92  38.96   97.02  64.52     48.58
Total accuracy: 66.67%
Average sen: 62.26%
Average spec: 91.33%
Macro f1-score: 62.05%
[0.99734604 0.99418867 0.99774557 0.9996984  0.99980623 0.99962234
 0.99003464 0.99308985 0.99845397 0.99933112 0.99904066 0.99783832
 0.99983883 0.99994683 0.99991918 0.9996984  0.99975961 0.99856371
 0.99889541 0.99963284 0.99381131 0.99449182 0.94361645 0.99997103
 0.99978858 0.9997732  0.99908495 0.99999261 0.99544311 0.99736977
 0.99999738 0.99992919 0.99999857 0.99990511 0.99988568 0.99990952
 0.99922085 0.99699116 0.99966252 0.99773139 0.99967778 0.99943441]
pred: 0.9970984998203459, label: 1
Right! Diagnosis: Narcolepsy type 1

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.47  67.53   91.84  57.10     61.88
1  85.61  11.67   96.33  31.60     17.04
2  78.77  76.23   80.32  70.17     73.08
3  93.48  78.73   96.62  83.21     80.91
4  85.58  68.90   89.28  58.71     63.40
Total accuracy: 65.96%
Average sen: 60.61%
Average spec: 90.88%
Macro f1-score: 59.26%
