cuda:1
Subjects num: 78

15min inputs: chc001-nsrr (26)
15min inputs: chc004-nsrr (35)
15min inputs: chc005-nsrr (31)
15min inputs: chc006-nsrr (27)
15min inputs: chc008-nsrr (32)
15min inputs: chc009-nsrr (29)
15min inputs: chc010-nsrr (28)
15min inputs: chc012-nsrr (30)
15min inputs: chc013-nsrr (31)
15min inputs: chc014-nsrr (31)
15min inputs: chc015-nsrr (31)
15min inputs: chc016-nsrr (31)
15min inputs: chc022-nsrr (27)
15min inputs: chc025-nsrr (27)
15min inputs: chc027-nsrr (30)
15min inputs: chc028-nsrr (29)
15min inputs: chc033-nsrr (29)
15min inputs: chc035-nsrr (30)
15min inputs: chc037-nsrr (29)
15min inputs: chc040-nsrr (36)
15min inputs: chc041-nsrr (28)
15min inputs: chc052-nsrr (30)
15min inputs: chc056-nsrr (30)
15min inputs: chp001-nsrr (38)
15min inputs: chp002-nsrr (36)
15min inputs: chp003-nsrr (33)
15min inputs: chp004-nsrr (32)
15min inputs: chp005-nsrr (43)
15min inputs: chp006-nsrr (36)
15min inputs: chp007-nsrr (38)
15min inputs: chp008-nsrr (31)
15min inputs: chp009-nsrr (34)
15min inputs: chp010-nsrr (32)
15min inputs: chp011-nsrr (33)
15min inputs: chp012-nsrr (37)
15min inputs: chp013-nsrr (33)
15min inputs: chp014-nsrr (33)
15min inputs: chp015-nsrr (38)
15min inputs: chp016-nsrr (42)
15min inputs: chp017-nsrr (33)
15min inputs: chp018-nsrr (37)
15min inputs: chp019-nsrr (31)
15min inputs: chp020-nsrr (38)
15min inputs: chp022-nsrr (42)
15min inputs: chp024-nsrr (37)
15min inputs: chp025-nsrr (14)
15min inputs: chp026-nsrr (31)
15min inputs: chp028-nsrr (34)
15min inputs: chp029-nsrr (34)
15min inputs: chp030-nsrr (40)
15min inputs: chp031-nsrr (37)
15min inputs: chp032-nsrr (35)
15min inputs: chp033-nsrr (33)
15min inputs: chp034-nsrr (34)
15min inputs: chp036-nsrr (42)
15min inputs: chp037-nsrr (34)
15min inputs: chp038-nsrr (34)
15min inputs: chp039-nsrr (37)
15min inputs: chp040-nsrr (35)
15min inputs: chp041-nsrr (36)
15min inputs: chp042-nsrr (37)
15min inputs: chp043-nsrr (40)
15min inputs: chp044-nsrr (35)
15min inputs: chp045-nsrr (40)
15min inputs: chp046-nsrr (36)
15min inputs: chp047-nsrr (29)
15min inputs: chp048-nsrr (34)
15min inputs: chp049-nsrr (36)
15min inputs: chp051-nsrr (36)
15min inputs: chp052-nsrr (33)
15min inputs: chp053-nsrr (36)
15min inputs: chp054-nsrr (37)
15min inputs: chp055-nsrr (37)
15min inputs: chp056-nsrr (36)
15min inputs: chp057-nsrr (39)
15min inputs: chp058-nsrr (34)
15min inputs: chp059-nsrr (37)
15min inputs: chp060-nsrr (42)

=== Test on chc001-nsrr. train_data(2612), test_data(26) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.678184, loss_ss: 1.956302, loss_d: 0.721882
0.0383 --- loss: 2.058317, loss_ss: 1.745812, loss_d: 0.312505
0.0766 --- loss: 2.399813, loss_ss: 1.917278, loss_d: 0.482535
0.1149 --- loss: 2.581540, loss_ss: 1.717023, loss_d: 0.864517
0.1531 --- loss: 1.939852, loss_ss: 1.385213, loss_d: 0.554639
0.1914 --- loss: 1.909116, loss_ss: 1.470615, loss_d: 0.438501
0.2297 --- loss: 2.007308, loss_ss: 1.402142, loss_d: 0.605166
0.2680 --- loss: 2.056374, loss_ss: 1.495142, loss_d: 0.561232
0.3063 --- loss: 2.450172, loss_ss: 1.618778, loss_d: 0.831395
0.3446 --- loss: 1.656578, loss_ss: 1.293632, loss_d: 0.362946
0.3828 --- loss: 1.860890, loss_ss: 1.444967, loss_d: 0.415923
0.4211 --- loss: 2.006559, loss_ss: 1.496007, loss_d: 0.510552
0.4594 --- loss: 1.840164, loss_ss: 1.374418, loss_d: 0.465746
0.4977 --- loss: 1.851035, loss_ss: 1.440692, loss_d: 0.410343
0.5360 --- loss: 2.326176, loss_ss: 1.427128, loss_d: 0.899047
0.5743 --- loss: 1.878050, loss_ss: 1.533280, loss_d: 0.344770
0.6126 --- loss: 2.248085, loss_ss: 1.578956, loss_d: 0.669129
0.6508 --- loss: 1.990682, loss_ss: 1.580453, loss_d: 0.410229
0.6891 --- loss: 2.249796, loss_ss: 1.482521, loss_d: 0.767275
0.7274 --- loss: 1.913684, loss_ss: 1.500490, loss_d: 0.413195
0.7657 --- loss: 2.037620, loss_ss: 1.466535, loss_d: 0.571084
0.8040 --- loss: 1.660201, loss_ss: 1.273555, loss_d: 0.386646
0.8423 --- loss: 1.982707, loss_ss: 1.465035, loss_d: 0.517672
0.8806 --- loss: 1.611556, loss_ss: 1.234241, loss_d: 0.377315
0.9188 --- loss: 1.965629, loss_ss: 1.327258, loss_d: 0.638371
0.9571 --- loss: 1.924492, loss_ss: 1.290267, loss_d: 0.634225
0.9954 --- loss: 2.270869, loss_ss: 1.513165, loss_d: 0.757704
Epoch finished! Loss: 2.074902275969699
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.849580, loss_ss: 1.198383, loss_d: 0.651196
0.0383 --- loss: 1.764820, loss_ss: 1.230876, loss_d: 0.533944
0.0766 --- loss: 1.687286, loss_ss: 1.082456, loss_d: 0.604831
0.1149 --- loss: 1.779721, loss_ss: 1.276135, loss_d: 0.503586
0.1531 --- loss: 1.736277, loss_ss: 1.072096, loss_d: 0.664182
0.1914 --- loss: 1.641190, loss_ss: 1.235370, loss_d: 0.405820
0.2297 --- loss: 1.655918, loss_ss: 1.164604, loss_d: 0.491314
0.2680 --- loss: 1.852992, loss_ss: 1.301806, loss_d: 0.551186
0.3063 --- loss: 1.575969, loss_ss: 1.036636, loss_d: 0.539334
0.3446 --- loss: 1.675511, loss_ss: 1.233875, loss_d: 0.441637
0.3828 --- loss: 1.675183, loss_ss: 1.161186, loss_d: 0.513997
0.4211 --- loss: 1.635314, loss_ss: 1.428734, loss_d: 0.206580
0.4594 --- loss: 1.949902, loss_ss: 1.171693, loss_d: 0.778209
0.4977 --- loss: 1.959333, loss_ss: 1.258093, loss_d: 0.701240
0.5360 --- loss: 1.702037, loss_ss: 1.176990, loss_d: 0.525047
0.5743 --- loss: 1.568430, loss_ss: 1.117426, loss_d: 0.451004
0.6126 --- loss: 1.515674, loss_ss: 1.044804, loss_d: 0.470870
0.6508 --- loss: 1.511241, loss_ss: 1.039671, loss_d: 0.471570
0.6891 --- loss: 1.432825, loss_ss: 1.131998, loss_d: 0.300827
0.7274 --- loss: 1.791784, loss_ss: 1.351638, loss_d: 0.440146
0.7657 --- loss: 1.517902, loss_ss: 0.913677, loss_d: 0.604225
0.8040 --- loss: 1.581898, loss_ss: 0.909521, loss_d: 0.672376
0.8423 --- loss: 1.591059, loss_ss: 0.934095, loss_d: 0.656964
0.8806 --- loss: 1.432550, loss_ss: 1.193091, loss_d: 0.239459
0.9188 --- loss: 1.714636, loss_ss: 1.092973, loss_d: 0.621663
0.9571 --- loss: 1.802051, loss_ss: 1.295470, loss_d: 0.506581
0.9954 --- loss: 1.289270, loss_ss: 0.949138, loss_d: 0.340132
Epoch finished! Loss: 1.7565820477474694
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.425858, loss_ss: 1.168490, loss_d: 0.257369
0.0383 --- loss: 1.563555, loss_ss: 1.066278, loss_d: 0.497277
0.0766 --- loss: 1.487214, loss_ss: 1.101229, loss_d: 0.385984
0.1149 --- loss: 1.539968, loss_ss: 0.928012, loss_d: 0.611956
0.1531 --- loss: 1.452361, loss_ss: 1.017880, loss_d: 0.434481
0.1914 --- loss: 1.854108, loss_ss: 1.158167, loss_d: 0.695941
0.2297 --- loss: 1.361275, loss_ss: 0.972477, loss_d: 0.388797
0.2680 --- loss: 1.882862, loss_ss: 1.117498, loss_d: 0.765364
0.3063 --- loss: 1.314962, loss_ss: 0.810495, loss_d: 0.504467
0.3446 --- loss: 1.512115, loss_ss: 1.219787, loss_d: 0.292327
0.3828 --- loss: 1.599380, loss_ss: 1.170585, loss_d: 0.428795
0.4211 --- loss: 1.484377, loss_ss: 0.915450, loss_d: 0.568927
0.4594 --- loss: 1.529650, loss_ss: 1.108684, loss_d: 0.420966
0.4977 --- loss: 1.572429, loss_ss: 0.895648, loss_d: 0.676781
0.5360 --- loss: 1.489232, loss_ss: 1.111801, loss_d: 0.377431
0.5743 --- loss: 1.371128, loss_ss: 0.945241, loss_d: 0.425887
0.6126 --- loss: 1.692099, loss_ss: 1.226689, loss_d: 0.465410
0.6508 --- loss: 1.476454, loss_ss: 0.979630, loss_d: 0.496825
0.6891 --- loss: 1.980111, loss_ss: 1.004835, loss_d: 0.975276
0.7274 --- loss: 1.717998, loss_ss: 1.108273, loss_d: 0.609724
0.7657 --- loss: 1.830426, loss_ss: 1.226296, loss_d: 0.604130
0.8040 --- loss: 1.433467, loss_ss: 1.074466, loss_d: 0.359001
0.8423 --- loss: 1.752885, loss_ss: 1.237716, loss_d: 0.515169
0.8806 --- loss: 1.874355, loss_ss: 1.140563, loss_d: 0.733792
0.9188 --- loss: 1.275359, loss_ss: 0.857165, loss_d: 0.418195
0.9571 --- loss: 1.590759, loss_ss: 1.200844, loss_d: 0.389915
0.9954 --- loss: 1.497529, loss_ss: 0.877706, loss_d: 0.619823
Epoch finished! Loss: 1.665713777944046
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.734349, loss_ss: 0.922876, loss_d: 0.811473
0.0383 --- loss: 1.957475, loss_ss: 0.888968, loss_d: 1.068507
0.0766 --- loss: 1.465383, loss_ss: 0.953433, loss_d: 0.511951
0.1149 --- loss: 1.335759, loss_ss: 0.925385, loss_d: 0.410374
0.1531 --- loss: 1.561542, loss_ss: 1.010649, loss_d: 0.550893
0.1914 --- loss: 1.943984, loss_ss: 1.141208, loss_d: 0.802776
0.2297 --- loss: 1.693629, loss_ss: 1.049854, loss_d: 0.643775
0.2680 --- loss: 1.724601, loss_ss: 1.022373, loss_d: 0.702228
0.3063 --- loss: 1.682427, loss_ss: 0.939856, loss_d: 0.742571
0.3446 --- loss: 1.515362, loss_ss: 0.882958, loss_d: 0.632404
0.3828 --- loss: 1.425446, loss_ss: 0.912689, loss_d: 0.512757
0.4211 --- loss: 1.688340, loss_ss: 1.127091, loss_d: 0.561250
0.4594 --- loss: 1.275299, loss_ss: 1.001968, loss_d: 0.273331
0.4977 --- loss: 1.441760, loss_ss: 0.893959, loss_d: 0.547802
0.5360 --- loss: 1.659832, loss_ss: 1.155444, loss_d: 0.504388
0.5743 --- loss: 1.458558, loss_ss: 0.897483, loss_d: 0.561074
0.6126 --- loss: 1.330444, loss_ss: 0.864511, loss_d: 0.465933
0.6508 --- loss: 1.584852, loss_ss: 1.333238, loss_d: 0.251615
0.6891 --- loss: 1.590707, loss_ss: 1.022346, loss_d: 0.568361
0.7274 --- loss: 1.344750, loss_ss: 0.813134, loss_d: 0.531616
0.7657 --- loss: 1.775669, loss_ss: 0.806876, loss_d: 0.968793
0.8040 --- loss: 1.690262, loss_ss: 1.116137, loss_d: 0.574125
0.8423 --- loss: 1.759392, loss_ss: 1.103346, loss_d: 0.656045
0.8806 --- loss: 1.602671, loss_ss: 1.001125, loss_d: 0.601545
0.9188 --- loss: 1.751717, loss_ss: 0.894995, loss_d: 0.856722
0.9571 --- loss: 1.531224, loss_ss: 0.891587, loss_d: 0.639637
0.9954 --- loss: 1.280562, loss_ss: 0.838979, loss_d: 0.441583
Epoch finished! Loss: 1.5994993306667868
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.804116, loss_ss: 1.147825, loss_d: 0.656290
0.0383 --- loss: 1.300861, loss_ss: 0.823467, loss_d: 0.477394
0.0766 --- loss: 1.463384, loss_ss: 0.905204, loss_d: 0.558180
0.1149 --- loss: 1.652240, loss_ss: 1.134339, loss_d: 0.517901
0.1531 --- loss: 1.393488, loss_ss: 0.777687, loss_d: 0.615801
0.1914 --- loss: 1.479654, loss_ss: 1.121856, loss_d: 0.357798
0.2297 --- loss: 1.860952, loss_ss: 1.271205, loss_d: 0.589747
0.2680 --- loss: 1.470829, loss_ss: 0.807078, loss_d: 0.663751
0.3063 --- loss: 1.554441, loss_ss: 0.917725, loss_d: 0.636716
0.3446 --- loss: 1.776706, loss_ss: 1.238397, loss_d: 0.538309
0.3828 --- loss: 1.389375, loss_ss: 0.936994, loss_d: 0.452381
0.4211 --- loss: 1.665978, loss_ss: 1.283377, loss_d: 0.382601
0.4594 --- loss: 1.263849, loss_ss: 0.830190, loss_d: 0.433658
0.4977 --- loss: 2.264980, loss_ss: 1.526953, loss_d: 0.738027
0.5360 --- loss: 1.449423, loss_ss: 0.979540, loss_d: 0.469883
0.5743 --- loss: 1.683378, loss_ss: 1.217329, loss_d: 0.466049
0.6126 --- loss: 1.697829, loss_ss: 0.948380, loss_d: 0.749449
0.6508 --- loss: 1.579068, loss_ss: 0.756864, loss_d: 0.822204
0.6891 --- loss: 1.360669, loss_ss: 0.966971, loss_d: 0.393698
0.7274 --- loss: 1.459441, loss_ss: 0.937499, loss_d: 0.521942
0.7657 --- loss: 1.419905, loss_ss: 0.906904, loss_d: 0.513001
0.8040 --- loss: 1.463931, loss_ss: 0.981127, loss_d: 0.482804
0.8423 --- loss: 1.694579, loss_ss: 1.146135, loss_d: 0.548444
0.8806 --- loss: 1.248563, loss_ss: 0.947919, loss_d: 0.300643
0.9188 --- loss: 1.411769, loss_ss: 0.874909, loss_d: 0.536860
0.9571 --- loss: 1.552464, loss_ss: 1.130989, loss_d: 0.421475
0.9954 --- loss: 1.271973, loss_ss: 0.789525, loss_d: 0.482448
Epoch finished! Loss: 1.54526676300385
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.301505, loss_ss: 0.815935, loss_d: 0.485569
0.0383 --- loss: 1.333292, loss_ss: 1.043362, loss_d: 0.289929
0.0766 --- loss: 1.484342, loss_ss: 0.842935, loss_d: 0.641407
0.1149 --- loss: 2.783841, loss_ss: 2.192266, loss_d: 0.591575
0.1531 --- loss: 1.260761, loss_ss: 0.823636, loss_d: 0.437125
0.1914 --- loss: 1.654178, loss_ss: 1.081283, loss_d: 0.572895
0.2297 --- loss: 1.500605, loss_ss: 1.093415, loss_d: 0.407190
0.2680 --- loss: 1.807847, loss_ss: 1.187245, loss_d: 0.620602
0.3063 --- loss: 1.196563, loss_ss: 0.819553, loss_d: 0.377010
0.3446 --- loss: 1.323603, loss_ss: 1.040607, loss_d: 0.282996
0.3828 --- loss: 1.163242, loss_ss: 0.867436, loss_d: 0.295806
0.4211 --- loss: 1.048717, loss_ss: 0.826414, loss_d: 0.222303
0.4594 --- loss: 1.156978, loss_ss: 0.927957, loss_d: 0.229020
0.4977 --- loss: 1.088605, loss_ss: 0.811753, loss_d: 0.276852
0.5360 --- loss: 1.396378, loss_ss: 1.013473, loss_d: 0.382905
0.5743 --- loss: 1.552758, loss_ss: 0.835197, loss_d: 0.717562
0.6126 --- loss: 1.324080, loss_ss: 1.051376, loss_d: 0.272704
0.6508 --- loss: 1.287538, loss_ss: 0.731637, loss_d: 0.555901
0.6891 --- loss: 1.540929, loss_ss: 0.898545, loss_d: 0.642384
0.7274 --- loss: 1.245297, loss_ss: 0.823579, loss_d: 0.421718
0.7657 --- loss: 1.407964, loss_ss: 1.077975, loss_d: 0.329989
0.8040 --- loss: 1.274482, loss_ss: 0.851322, loss_d: 0.423160
0.8423 --- loss: 1.750687, loss_ss: 0.871777, loss_d: 0.878910
0.8806 --- loss: 1.273658, loss_ss: 0.750102, loss_d: 0.523556
0.9188 --- loss: 1.062347, loss_ss: 0.688136, loss_d: 0.374211
0.9571 --- loss: 1.259590, loss_ss: 0.812114, loss_d: 0.447476
0.9954 --- loss: 1.709330, loss_ss: 1.070006, loss_d: 0.639323
Epoch finished! Loss: 1.4587046889966475
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.187384, loss_ss: 0.887718, loss_d: 0.299666
0.0383 --- loss: 2.006467, loss_ss: 0.974662, loss_d: 1.031805
0.0766 --- loss: 1.692595, loss_ss: 1.063874, loss_d: 0.628722
0.1149 --- loss: 1.773594, loss_ss: 1.275183, loss_d: 0.498411
0.1531 --- loss: 1.473497, loss_ss: 0.998364, loss_d: 0.475132
0.1914 --- loss: 1.539572, loss_ss: 1.263527, loss_d: 0.276046
0.2297 --- loss: 1.236992, loss_ss: 0.981281, loss_d: 0.255711
0.2680 --- loss: 1.264369, loss_ss: 0.869594, loss_d: 0.394775
0.3063 --- loss: 1.480277, loss_ss: 0.796427, loss_d: 0.683850
0.3446 --- loss: 1.283505, loss_ss: 0.806547, loss_d: 0.476958
0.3828 --- loss: 1.309000, loss_ss: 0.737553, loss_d: 0.571447
0.4211 --- loss: 1.247890, loss_ss: 0.881078, loss_d: 0.366812
0.4594 --- loss: 1.099546, loss_ss: 0.709263, loss_d: 0.390283
0.4977 --- loss: 0.922696, loss_ss: 0.770633, loss_d: 0.152064
0.5360 --- loss: 0.958706, loss_ss: 0.746315, loss_d: 0.212391
0.5743 --- loss: 1.764681, loss_ss: 1.068144, loss_d: 0.696537
0.6126 --- loss: 1.071572, loss_ss: 0.790209, loss_d: 0.281363
0.6508 --- loss: 1.077861, loss_ss: 0.734297, loss_d: 0.343564
0.6891 --- loss: 1.070358, loss_ss: 0.829936, loss_d: 0.240421
0.7274 --- loss: 1.355233, loss_ss: 0.938618, loss_d: 0.416615
0.7657 --- loss: 1.443240, loss_ss: 1.115360, loss_d: 0.327880
0.8040 --- loss: 1.347372, loss_ss: 1.127769, loss_d: 0.219603
0.8423 --- loss: 1.037283, loss_ss: 0.762131, loss_d: 0.275152
0.8806 --- loss: 1.240024, loss_ss: 0.895589, loss_d: 0.344436
0.9188 --- loss: 0.993067, loss_ss: 0.735096, loss_d: 0.257971
0.9571 --- loss: 1.091574, loss_ss: 0.909808, loss_d: 0.181766
0.9954 --- loss: 1.134955, loss_ss: 0.798323, loss_d: 0.336632
Epoch finished! Loss: 1.3655987872931235
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.292540, loss_ss: 0.878540, loss_d: 0.414000
0.0383 --- loss: 1.622442, loss_ss: 0.805396, loss_d: 0.817045
0.0766 --- loss: 1.473521, loss_ss: 0.964024, loss_d: 0.509497
0.1149 --- loss: 1.715814, loss_ss: 0.928582, loss_d: 0.787232
0.1531 --- loss: 1.354957, loss_ss: 1.000435, loss_d: 0.354522
0.1914 --- loss: 1.117917, loss_ss: 0.766763, loss_d: 0.351154
0.2297 --- loss: 1.293717, loss_ss: 0.838369, loss_d: 0.455347
0.2680 --- loss: 1.060790, loss_ss: 0.856699, loss_d: 0.204091
0.3063 --- loss: 1.161475, loss_ss: 0.995405, loss_d: 0.166070
0.3446 --- loss: 0.816037, loss_ss: 0.692137, loss_d: 0.123901
0.3828 --- loss: 1.459851, loss_ss: 0.832754, loss_d: 0.627096
0.4211 --- loss: 1.523127, loss_ss: 1.250522, loss_d: 0.272605
0.4594 --- loss: 1.216257, loss_ss: 0.955649, loss_d: 0.260608
0.4977 --- loss: 1.203161, loss_ss: 0.828351, loss_d: 0.374810
0.5360 --- loss: 1.242980, loss_ss: 0.926645, loss_d: 0.316335
0.5743 --- loss: 1.390082, loss_ss: 1.041687, loss_d: 0.348395
0.6126 --- loss: 1.059812, loss_ss: 0.850643, loss_d: 0.209168
0.6508 --- loss: 1.480402, loss_ss: 1.178709, loss_d: 0.301692
0.6891 --- loss: 1.526235, loss_ss: 0.894638, loss_d: 0.631596
0.7274 --- loss: 1.414433, loss_ss: 0.696239, loss_d: 0.718195
0.7657 --- loss: 0.895786, loss_ss: 0.685387, loss_d: 0.210399
0.8040 --- loss: 1.117228, loss_ss: 0.902134, loss_d: 0.215094
0.8423 --- loss: 1.261634, loss_ss: 1.023636, loss_d: 0.237997
0.8806 --- loss: 0.790593, loss_ss: 0.654659, loss_d: 0.135934
0.9188 --- loss: 1.145795, loss_ss: 0.752105, loss_d: 0.393689
0.9571 --- loss: 1.649760, loss_ss: 1.048381, loss_d: 0.601378
0.9954 --- loss: 1.343900, loss_ss: 1.064728, loss_d: 0.279172
Epoch finished! Loss: 1.3017151289516025
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.021002, loss_ss: 0.598666, loss_d: 0.422336
0.0383 --- loss: 1.331977, loss_ss: 0.969812, loss_d: 0.362165
0.0766 --- loss: 1.110805, loss_ss: 0.820852, loss_d: 0.289952
0.1149 --- loss: 1.216366, loss_ss: 0.992877, loss_d: 0.223489
0.1531 --- loss: 1.069442, loss_ss: 0.894848, loss_d: 0.174594
0.1914 --- loss: 1.309637, loss_ss: 1.037743, loss_d: 0.271894
0.2297 --- loss: 1.082648, loss_ss: 0.710257, loss_d: 0.372390
0.2680 --- loss: 1.344845, loss_ss: 0.813561, loss_d: 0.531284
0.3063 --- loss: 0.982325, loss_ss: 0.742785, loss_d: 0.239540
0.3446 --- loss: 1.020193, loss_ss: 0.881202, loss_d: 0.138991
0.3828 --- loss: 1.873307, loss_ss: 1.516378, loss_d: 0.356929
0.4211 --- loss: 1.085139, loss_ss: 0.873549, loss_d: 0.211590
0.4594 --- loss: 1.509447, loss_ss: 1.084782, loss_d: 0.424665
0.4977 --- loss: 1.158839, loss_ss: 0.721683, loss_d: 0.437156
0.5360 --- loss: 1.267524, loss_ss: 0.810045, loss_d: 0.457479
0.5743 --- loss: 1.135461, loss_ss: 0.734659, loss_d: 0.400801
0.6126 --- loss: 1.184475, loss_ss: 0.951628, loss_d: 0.232848
0.6508 --- loss: 1.200969, loss_ss: 0.753758, loss_d: 0.447211
0.6891 --- loss: 1.033047, loss_ss: 0.844782, loss_d: 0.188265
0.7274 --- loss: 1.135078, loss_ss: 0.699526, loss_d: 0.435552
0.7657 --- loss: 1.318704, loss_ss: 1.064718, loss_d: 0.253985
0.8040 --- loss: 0.948114, loss_ss: 0.826400, loss_d: 0.121714
0.8423 --- loss: 1.363211, loss_ss: 0.833874, loss_d: 0.529338
0.8806 --- loss: 1.277435, loss_ss: 0.915845, loss_d: 0.361590
0.9188 --- loss: 1.350838, loss_ss: 0.794891, loss_d: 0.555947
0.9571 --- loss: 1.143789, loss_ss: 0.926421, loss_d: 0.217368
0.9954 --- loss: 1.012312, loss_ss: 0.713053, loss_d: 0.299259
Epoch finished! Loss: 1.2600064994731626
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.470814, loss_ss: 0.843844, loss_d: 0.626970
0.0383 --- loss: 1.433193, loss_ss: 0.843575, loss_d: 0.589618
0.0766 --- loss: 1.170169, loss_ss: 0.872651, loss_d: 0.297518
0.1149 --- loss: 0.971052, loss_ss: 0.780523, loss_d: 0.190529
0.1531 --- loss: 1.419534, loss_ss: 1.001939, loss_d: 0.417595
0.1914 --- loss: 1.231670, loss_ss: 0.906324, loss_d: 0.325346
0.2297 --- loss: 0.988824, loss_ss: 0.822808, loss_d: 0.166016
0.2680 --- loss: 1.084639, loss_ss: 0.779354, loss_d: 0.305284
0.3063 --- loss: 1.099059, loss_ss: 0.960568, loss_d: 0.138492
0.3446 --- loss: 1.120705, loss_ss: 0.931535, loss_d: 0.189170
0.3828 --- loss: 1.063350, loss_ss: 0.823979, loss_d: 0.239370
0.4211 --- loss: 1.248344, loss_ss: 0.890778, loss_d: 0.357565
0.4594 --- loss: 1.097080, loss_ss: 0.823152, loss_d: 0.273928
0.4977 --- loss: 1.291964, loss_ss: 0.876582, loss_d: 0.415382
0.5360 --- loss: 1.312438, loss_ss: 0.819595, loss_d: 0.492843
0.5743 --- loss: 0.833755, loss_ss: 0.595555, loss_d: 0.238200
0.6126 --- loss: 1.123889, loss_ss: 0.702116, loss_d: 0.421773
0.6508 --- loss: 1.850535, loss_ss: 1.269208, loss_d: 0.581327
0.6891 --- loss: 1.724267, loss_ss: 0.848918, loss_d: 0.875349
0.7274 --- loss: 1.427580, loss_ss: 0.879229, loss_d: 0.548352
0.7657 --- loss: 1.912857, loss_ss: 1.082220, loss_d: 0.830637
0.8040 --- loss: 1.121675, loss_ss: 0.831894, loss_d: 0.289780
0.8423 --- loss: 1.594175, loss_ss: 0.973850, loss_d: 0.620326
0.8806 --- loss: 1.080152, loss_ss: 0.869446, loss_d: 0.210706
0.9188 --- loss: 1.201114, loss_ss: 0.865874, loss_d: 0.335240
0.9571 --- loss: 1.164543, loss_ss: 0.763630, loss_d: 0.400914
0.9954 --- loss: 0.939562, loss_ss: 0.662174, loss_d: 0.277388
Epoch finished! Loss: 1.2537081264444694
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8897435897435897
             precision    recall  f1-score   support

        0.0       0.80      0.92      0.86        78
        1.0       0.67      0.08      0.14        50
        2.0       0.88      0.96      0.92       397
        3.0       0.95      0.90      0.92       143
        4.0       0.93      0.97      0.95       112

avg / total       0.88      0.89      0.87       780
 


====== chc001-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.92  92.31   97.44  80.00     85.71
1  93.85   8.00   99.73  66.67     14.29
2  91.28  95.72   86.68  88.17     91.79
3  97.31  90.21   98.90  94.85     92.47
4  98.59  97.32   98.80  93.16     95.20
Total accuracy: 88.97%
Average sen: 76.71%
Average spec: 96.31%
Macro f1-score: 75.89%
Diagnosis acc on 15mins: 0.8461538461538461
[0.96749419 0.7705099  0.23821492 0.49813113 0.46299416 0.1137883
 0.02517255 0.05767421 0.15504119 0.24634176 0.31133625 0.13656592
 0.24497359 0.07102667 0.07512546 0.10192923 0.19765091 0.48298383
 0.27961269 0.07375643 0.5498513  0.6507768  0.25989005 0.09201601
 0.07844894 0.07127692]
pred: 0.2774070505625926, label: 0
Right! Diagnosis: Other

=== Test on chc004-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.283774, loss_ss: 1.580749, loss_d: 0.703025
0.0384 --- loss: 1.924913, loss_ss: 1.401895, loss_d: 0.523018
0.0768 --- loss: 2.083000, loss_ss: 1.441866, loss_d: 0.641135
0.1153 --- loss: 1.888984, loss_ss: 1.357085, loss_d: 0.531899
0.1537 --- loss: 1.659105, loss_ss: 1.161829, loss_d: 0.497276
0.1921 --- loss: 2.304329, loss_ss: 1.664125, loss_d: 0.640204
0.2305 --- loss: 2.145020, loss_ss: 1.336158, loss_d: 0.808862
0.2689 --- loss: 1.979943, loss_ss: 1.219806, loss_d: 0.760137
0.3073 --- loss: 1.708563, loss_ss: 1.332785, loss_d: 0.375778
0.3458 --- loss: 1.971814, loss_ss: 1.158259, loss_d: 0.813555
0.3842 --- loss: 1.699971, loss_ss: 1.259785, loss_d: 0.440186
0.4226 --- loss: 1.820199, loss_ss: 1.126798, loss_d: 0.693400
0.4610 --- loss: 1.821074, loss_ss: 1.137528, loss_d: 0.683547
0.4994 --- loss: 1.685896, loss_ss: 1.192876, loss_d: 0.493020
0.5378 --- loss: 1.603306, loss_ss: 1.081014, loss_d: 0.522292
0.5763 --- loss: 1.489472, loss_ss: 1.209880, loss_d: 0.279593
0.6147 --- loss: 1.593123, loss_ss: 1.179567, loss_d: 0.413556
0.6531 --- loss: 1.689542, loss_ss: 1.167514, loss_d: 0.522029
0.6915 --- loss: 1.776562, loss_ss: 1.202335, loss_d: 0.574227
0.7299 --- loss: 1.840056, loss_ss: 1.154242, loss_d: 0.685813
0.7683 --- loss: 1.734645, loss_ss: 1.152547, loss_d: 0.582098
0.8068 --- loss: 1.370080, loss_ss: 1.003840, loss_d: 0.366239
0.8452 --- loss: 1.296155, loss_ss: 1.055943, loss_d: 0.240212
0.8836 --- loss: 1.896425, loss_ss: 1.041146, loss_d: 0.855280
0.9220 --- loss: 1.382502, loss_ss: 0.898324, loss_d: 0.484178
0.9604 --- loss: 1.700660, loss_ss: 0.969425, loss_d: 0.731235
0.9988 --- loss: 2.253750, loss_ss: 1.809502, loss_d: 0.444248
Epoch finished! Loss: 1.812427414380587
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.755752, loss_ss: 1.267116, loss_d: 0.488636
0.0384 --- loss: 1.943254, loss_ss: 1.403658, loss_d: 0.539596
0.0768 --- loss: 1.573515, loss_ss: 1.165287, loss_d: 0.408228
0.1153 --- loss: 1.838779, loss_ss: 0.940358, loss_d: 0.898421
0.1537 --- loss: 1.912092, loss_ss: 1.374698, loss_d: 0.537395
0.1921 --- loss: 1.764546, loss_ss: 1.313345, loss_d: 0.451200
0.2305 --- loss: 1.378829, loss_ss: 0.966208, loss_d: 0.412622
0.2689 --- loss: 1.679613, loss_ss: 1.080845, loss_d: 0.598768
0.3073 --- loss: 1.903696, loss_ss: 1.323806, loss_d: 0.579890
0.3458 --- loss: 1.760599, loss_ss: 1.217555, loss_d: 0.543044
0.3842 --- loss: 1.626885, loss_ss: 1.025519, loss_d: 0.601366
0.4226 --- loss: 1.767126, loss_ss: 0.964038, loss_d: 0.803088
0.4610 --- loss: 1.683251, loss_ss: 0.975014, loss_d: 0.708237
0.4994 --- loss: 1.662822, loss_ss: 0.964797, loss_d: 0.698025
0.5378 --- loss: 1.519501, loss_ss: 1.019555, loss_d: 0.499947
0.5763 --- loss: 1.591848, loss_ss: 1.085580, loss_d: 0.506268
0.6147 --- loss: 1.940732, loss_ss: 1.022211, loss_d: 0.918520
0.6531 --- loss: 1.443508, loss_ss: 0.842909, loss_d: 0.600599
0.6915 --- loss: 1.591024, loss_ss: 1.175412, loss_d: 0.415612
0.7299 --- loss: 1.455900, loss_ss: 0.853357, loss_d: 0.602542
0.7683 --- loss: 1.342521, loss_ss: 1.068889, loss_d: 0.273632
0.8068 --- loss: 1.357057, loss_ss: 0.787848, loss_d: 0.569209
0.8452 --- loss: 1.845811, loss_ss: 0.810748, loss_d: 1.035063
0.8836 --- loss: 1.841470, loss_ss: 1.228328, loss_d: 0.613142
0.9220 --- loss: 1.548783, loss_ss: 0.937441, loss_d: 0.611342
0.9604 --- loss: 1.487962, loss_ss: 1.045410, loss_d: 0.442552
0.9988 --- loss: 1.770836, loss_ss: 1.194267, loss_d: 0.576569
Epoch finished! Loss: 1.6273086025164678
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.279384, loss_ss: 0.821949, loss_d: 0.457436
0.0384 --- loss: 2.057355, loss_ss: 1.203302, loss_d: 0.854053
0.0768 --- loss: 1.880041, loss_ss: 1.355514, loss_d: 0.524527
0.1153 --- loss: 1.573237, loss_ss: 1.181734, loss_d: 0.391502
0.1537 --- loss: 1.519058, loss_ss: 1.190875, loss_d: 0.328183
0.1921 --- loss: 1.848984, loss_ss: 1.044520, loss_d: 0.804464
0.2305 --- loss: 1.534545, loss_ss: 1.115778, loss_d: 0.418768
0.2689 --- loss: 1.206140, loss_ss: 0.823660, loss_d: 0.382479
0.3073 --- loss: 1.227067, loss_ss: 0.744268, loss_d: 0.482799
0.3458 --- loss: 1.721327, loss_ss: 1.089362, loss_d: 0.631965
0.3842 --- loss: 1.691186, loss_ss: 1.045574, loss_d: 0.645612
0.4226 --- loss: 1.755147, loss_ss: 1.107478, loss_d: 0.647669
0.4610 --- loss: 1.456229, loss_ss: 0.972805, loss_d: 0.483424
0.4994 --- loss: 1.499668, loss_ss: 1.070428, loss_d: 0.429241
0.5378 --- loss: 1.185146, loss_ss: 0.654600, loss_d: 0.530545
0.5763 --- loss: 1.315389, loss_ss: 0.876042, loss_d: 0.439347
0.6147 --- loss: 1.822664, loss_ss: 1.086233, loss_d: 0.736431
0.6531 --- loss: 1.239334, loss_ss: 0.894788, loss_d: 0.344546
0.6915 --- loss: 1.246507, loss_ss: 0.707443, loss_d: 0.539064
0.7299 --- loss: 1.266990, loss_ss: 0.940824, loss_d: 0.326167
0.7683 --- loss: 1.375071, loss_ss: 0.932463, loss_d: 0.442608
0.8068 --- loss: 0.982740, loss_ss: 0.734704, loss_d: 0.248036
0.8452 --- loss: 1.511703, loss_ss: 1.273463, loss_d: 0.238240
0.8836 --- loss: 1.746223, loss_ss: 0.923459, loss_d: 0.822764
0.9220 --- loss: 1.718372, loss_ss: 1.002801, loss_d: 0.715571
0.9604 --- loss: 1.526053, loss_ss: 1.096182, loss_d: 0.429870
0.9988 --- loss: 1.251226, loss_ss: 0.953791, loss_d: 0.297436
Epoch finished! Loss: 1.5404527544975282
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.394525, loss_ss: 0.911012, loss_d: 0.483513
0.0384 --- loss: 1.504726, loss_ss: 0.706264, loss_d: 0.798462
0.0768 --- loss: 1.673468, loss_ss: 1.236090, loss_d: 0.437379
0.1153 --- loss: 1.115319, loss_ss: 0.906871, loss_d: 0.208448
0.1537 --- loss: 1.555579, loss_ss: 1.099984, loss_d: 0.455595
0.1921 --- loss: 1.570998, loss_ss: 1.137938, loss_d: 0.433060
0.2305 --- loss: 1.061445, loss_ss: 0.862306, loss_d: 0.199138
0.2689 --- loss: 1.560825, loss_ss: 1.005477, loss_d: 0.555348
0.3073 --- loss: 1.271942, loss_ss: 0.721927, loss_d: 0.550015
0.3458 --- loss: 1.624070, loss_ss: 0.908800, loss_d: 0.715270
0.3842 --- loss: 1.315694, loss_ss: 0.942495, loss_d: 0.373200
0.4226 --- loss: 1.743898, loss_ss: 1.114818, loss_d: 0.629080
0.4610 --- loss: 1.513397, loss_ss: 1.167598, loss_d: 0.345798
0.4994 --- loss: 1.099888, loss_ss: 0.809549, loss_d: 0.290339
0.5378 --- loss: 1.675765, loss_ss: 0.941402, loss_d: 0.734363
0.5763 --- loss: 1.543249, loss_ss: 0.972490, loss_d: 0.570759
0.6147 --- loss: 1.257636, loss_ss: 0.926172, loss_d: 0.331463
0.6531 --- loss: 1.110755, loss_ss: 0.848215, loss_d: 0.262540
0.6915 --- loss: 1.272246, loss_ss: 0.957029, loss_d: 0.315217
0.7299 --- loss: 1.208928, loss_ss: 1.022470, loss_d: 0.186458
0.7683 --- loss: 1.610931, loss_ss: 1.009136, loss_d: 0.601794
0.8068 --- loss: 1.391293, loss_ss: 0.915323, loss_d: 0.475970
0.8452 --- loss: 1.875940, loss_ss: 1.084939, loss_d: 0.791001
0.8836 --- loss: 1.362294, loss_ss: 0.918326, loss_d: 0.443968
0.9220 --- loss: 1.331219, loss_ss: 0.928125, loss_d: 0.403094
0.9604 --- loss: 1.340598, loss_ss: 1.033174, loss_d: 0.307424
0.9988 --- loss: 1.345052, loss_ss: 0.936491, loss_d: 0.408562
Epoch finished! Loss: 1.4281754560195483
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.594920, loss_ss: 0.879299, loss_d: 0.715621
0.0384 --- loss: 1.560260, loss_ss: 0.967909, loss_d: 0.592351
0.0768 --- loss: 1.864878, loss_ss: 1.388113, loss_d: 0.476765
0.1153 --- loss: 1.657089, loss_ss: 1.144815, loss_d: 0.512273
0.1537 --- loss: 1.141536, loss_ss: 0.844827, loss_d: 0.296709
0.1921 --- loss: 1.041776, loss_ss: 0.779634, loss_d: 0.262142
0.2305 --- loss: 1.639638, loss_ss: 1.046900, loss_d: 0.592738
0.2689 --- loss: 1.026510, loss_ss: 0.609139, loss_d: 0.417372
0.3073 --- loss: 1.281372, loss_ss: 0.768048, loss_d: 0.513324
0.3458 --- loss: 2.141876, loss_ss: 1.617968, loss_d: 0.523907
0.3842 --- loss: 1.197634, loss_ss: 0.561073, loss_d: 0.636561
0.4226 --- loss: 1.340603, loss_ss: 0.763755, loss_d: 0.576848
0.4610 --- loss: 1.547270, loss_ss: 1.060466, loss_d: 0.486804
0.4994 --- loss: 1.914564, loss_ss: 1.039913, loss_d: 0.874651
0.5378 --- loss: 1.591916, loss_ss: 1.094024, loss_d: 0.497891
0.5763 --- loss: 1.613347, loss_ss: 0.874891, loss_d: 0.738456
0.6147 --- loss: 1.567643, loss_ss: 0.932220, loss_d: 0.635423
0.6531 --- loss: 1.102809, loss_ss: 0.794752, loss_d: 0.308057
0.6915 --- loss: 1.571512, loss_ss: 1.094247, loss_d: 0.477264
0.7299 --- loss: 1.440606, loss_ss: 1.138724, loss_d: 0.301882
0.7683 --- loss: 1.413348, loss_ss: 0.933772, loss_d: 0.479577
0.8068 --- loss: 1.611518, loss_ss: 0.770223, loss_d: 0.841295
0.8452 --- loss: 1.319562, loss_ss: 1.012425, loss_d: 0.307137
0.8836 --- loss: 1.382771, loss_ss: 1.065278, loss_d: 0.317493
0.9220 --- loss: 1.192739, loss_ss: 0.906789, loss_d: 0.285950
0.9604 --- loss: 1.406938, loss_ss: 0.962741, loss_d: 0.444197
0.9988 --- loss: 1.210197, loss_ss: 0.902819, loss_d: 0.307377
Epoch finished! Loss: 1.368855590086717
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.424761, loss_ss: 1.175500, loss_d: 0.249261
0.0384 --- loss: 1.097052, loss_ss: 0.844513, loss_d: 0.252539
0.0768 --- loss: 1.370864, loss_ss: 0.678871, loss_d: 0.691993
0.1153 --- loss: 1.357209, loss_ss: 0.870270, loss_d: 0.486940
0.1537 --- loss: 1.436955, loss_ss: 1.058599, loss_d: 0.378357
0.1921 --- loss: 1.278980, loss_ss: 0.809414, loss_d: 0.469565
0.2305 --- loss: 0.877319, loss_ss: 0.648855, loss_d: 0.228464
0.2689 --- loss: 1.618312, loss_ss: 1.002517, loss_d: 0.615794
0.3073 --- loss: 0.920528, loss_ss: 0.721817, loss_d: 0.198711
0.3458 --- loss: 1.310258, loss_ss: 0.967194, loss_d: 0.343064
0.3842 --- loss: 1.618111, loss_ss: 1.232676, loss_d: 0.385435
0.4226 --- loss: 1.377925, loss_ss: 0.954897, loss_d: 0.423028
0.4610 --- loss: 0.839570, loss_ss: 0.590378, loss_d: 0.249192
0.4994 --- loss: 1.323434, loss_ss: 0.697421, loss_d: 0.626012
0.5378 --- loss: 1.622413, loss_ss: 1.354104, loss_d: 0.268309
0.5763 --- loss: 0.886253, loss_ss: 0.782161, loss_d: 0.104093
0.6147 --- loss: 1.195112, loss_ss: 0.928553, loss_d: 0.266558
0.6531 --- loss: 1.101165, loss_ss: 0.889474, loss_d: 0.211691
0.6915 --- loss: 1.394658, loss_ss: 1.081435, loss_d: 0.313223
0.7299 --- loss: 1.955727, loss_ss: 1.445724, loss_d: 0.510003
0.7683 --- loss: 1.317774, loss_ss: 0.948305, loss_d: 0.369469
0.8068 --- loss: 1.325636, loss_ss: 0.691656, loss_d: 0.633980
0.8452 --- loss: 1.653228, loss_ss: 1.191247, loss_d: 0.461981
0.8836 --- loss: 1.432555, loss_ss: 0.953754, loss_d: 0.478801
0.9220 --- loss: 1.575124, loss_ss: 1.153721, loss_d: 0.421403
0.9604 --- loss: 1.988680, loss_ss: 1.043608, loss_d: 0.945072
0.9988 --- loss: 2.331999, loss_ss: 1.205339, loss_d: 1.126660
Epoch finished! Loss: 1.3216042559880476
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.177848, loss_ss: 0.872109, loss_d: 0.305740
0.0384 --- loss: 1.562443, loss_ss: 1.266537, loss_d: 0.295906
0.0768 --- loss: 1.110836, loss_ss: 0.829410, loss_d: 0.281426
0.1153 --- loss: 1.462173, loss_ss: 1.046012, loss_d: 0.416161
0.1537 --- loss: 0.838795, loss_ss: 0.606228, loss_d: 0.232567
0.1921 --- loss: 1.005730, loss_ss: 0.700109, loss_d: 0.305621
0.2305 --- loss: 1.222282, loss_ss: 0.744893, loss_d: 0.477388
0.2689 --- loss: 1.250481, loss_ss: 1.031032, loss_d: 0.219449
0.3073 --- loss: 1.238518, loss_ss: 0.826487, loss_d: 0.412030
0.3458 --- loss: 1.567979, loss_ss: 0.878894, loss_d: 0.689085
0.3842 --- loss: 1.357119, loss_ss: 0.889694, loss_d: 0.467425
0.4226 --- loss: 1.171095, loss_ss: 0.784280, loss_d: 0.386815
0.4610 --- loss: 0.857777, loss_ss: 0.690731, loss_d: 0.167046
0.4994 --- loss: 1.686970, loss_ss: 0.972936, loss_d: 0.714033
0.5378 --- loss: 1.094888, loss_ss: 0.884926, loss_d: 0.209962
0.5763 --- loss: 1.354563, loss_ss: 0.822989, loss_d: 0.531575
0.6147 --- loss: 1.045658, loss_ss: 0.883838, loss_d: 0.161820
0.6531 --- loss: 0.745325, loss_ss: 0.606718, loss_d: 0.138608
0.6915 --- loss: 1.567758, loss_ss: 1.010574, loss_d: 0.557184
0.7299 --- loss: 1.144472, loss_ss: 0.996722, loss_d: 0.147750
0.7683 --- loss: 1.269304, loss_ss: 0.849675, loss_d: 0.419629
0.8068 --- loss: 1.078110, loss_ss: 0.746834, loss_d: 0.331276
0.8452 --- loss: 1.190847, loss_ss: 0.976632, loss_d: 0.214215
0.8836 --- loss: 0.949757, loss_ss: 0.790099, loss_d: 0.159658
0.9220 --- loss: 1.288376, loss_ss: 0.997444, loss_d: 0.290932
0.9604 --- loss: 1.208821, loss_ss: 0.884183, loss_d: 0.324638
0.9988 --- loss: 1.537614, loss_ss: 1.394473, loss_d: 0.143140
Epoch finished! Loss: 1.2741863956818213
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.168687, loss_ss: 0.913917, loss_d: 0.254770
0.0384 --- loss: 1.069468, loss_ss: 0.950064, loss_d: 0.119405
0.0768 --- loss: 0.886272, loss_ss: 0.757270, loss_d: 0.129002
0.1153 --- loss: 1.396060, loss_ss: 1.053366, loss_d: 0.342694
0.1537 --- loss: 1.726912, loss_ss: 1.073808, loss_d: 0.653105
0.1921 --- loss: 1.163169, loss_ss: 0.709684, loss_d: 0.453485
0.2305 --- loss: 1.105517, loss_ss: 0.753877, loss_d: 0.351640
0.2689 --- loss: 0.876911, loss_ss: 0.698811, loss_d: 0.178099
0.3073 --- loss: 1.429738, loss_ss: 0.969365, loss_d: 0.460373
0.3458 --- loss: 1.330898, loss_ss: 0.868152, loss_d: 0.462746
0.3842 --- loss: 0.830960, loss_ss: 0.736662, loss_d: 0.094297
0.4226 --- loss: 0.836212, loss_ss: 0.722887, loss_d: 0.113325
0.4610 --- loss: 0.971499, loss_ss: 0.732974, loss_d: 0.238526
0.4994 --- loss: 1.318346, loss_ss: 0.691406, loss_d: 0.626940
0.5378 --- loss: 1.011410, loss_ss: 0.819021, loss_d: 0.192390
0.5763 --- loss: 1.418930, loss_ss: 1.050854, loss_d: 0.368076
0.6147 --- loss: 1.251052, loss_ss: 1.021559, loss_d: 0.229493
0.6531 --- loss: 1.314121, loss_ss: 0.868390, loss_d: 0.445731
0.6915 --- loss: 1.656644, loss_ss: 0.896615, loss_d: 0.760029
0.7299 --- loss: 1.096150, loss_ss: 0.864134, loss_d: 0.232016
0.7683 --- loss: 1.168214, loss_ss: 0.832773, loss_d: 0.335441
0.8068 --- loss: 1.224703, loss_ss: 0.932750, loss_d: 0.291952
0.8452 --- loss: 1.548079, loss_ss: 0.791529, loss_d: 0.756551
0.8836 --- loss: 1.495984, loss_ss: 0.854790, loss_d: 0.641194
0.9220 --- loss: 0.884620, loss_ss: 0.692340, loss_d: 0.192280
0.9604 --- loss: 1.069606, loss_ss: 0.922761, loss_d: 0.146844
0.9988 --- loss: 1.108900, loss_ss: 1.033225, loss_d: 0.075674
Epoch finished! Loss: 1.2251396880700038
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.780596, loss_ss: 0.627226, loss_d: 0.153370
0.0384 --- loss: 0.790414, loss_ss: 0.572349, loss_d: 0.218065
0.0768 --- loss: 1.132042, loss_ss: 0.879217, loss_d: 0.252825
0.1153 --- loss: 1.088023, loss_ss: 0.729208, loss_d: 0.358816
0.1537 --- loss: 1.342328, loss_ss: 0.958559, loss_d: 0.383769
0.1921 --- loss: 1.365664, loss_ss: 1.089356, loss_d: 0.276308
0.2305 --- loss: 1.407220, loss_ss: 1.267502, loss_d: 0.139719
0.2689 --- loss: 1.318226, loss_ss: 0.741427, loss_d: 0.576799
0.3073 --- loss: 1.660931, loss_ss: 1.289612, loss_d: 0.371318
0.3458 --- loss: 0.686216, loss_ss: 0.592030, loss_d: 0.094186
0.3842 --- loss: 1.238319, loss_ss: 0.772928, loss_d: 0.465391
0.4226 --- loss: 1.096193, loss_ss: 0.852343, loss_d: 0.243850
0.4610 --- loss: 0.950800, loss_ss: 0.579144, loss_d: 0.371655
0.4994 --- loss: 1.476692, loss_ss: 1.194667, loss_d: 0.282025
0.5378 --- loss: 1.401002, loss_ss: 0.822271, loss_d: 0.578731
0.5763 --- loss: 1.649003, loss_ss: 1.268785, loss_d: 0.380217
0.6147 --- loss: 1.541686, loss_ss: 1.101011, loss_d: 0.440675
0.6531 --- loss: 0.956323, loss_ss: 0.781431, loss_d: 0.174892
0.6915 --- loss: 1.341155, loss_ss: 0.882368, loss_d: 0.458787
0.7299 --- loss: 1.273375, loss_ss: 1.149420, loss_d: 0.123955
0.7683 --- loss: 1.174597, loss_ss: 0.705723, loss_d: 0.468873
0.8068 --- loss: 1.117341, loss_ss: 0.806845, loss_d: 0.310495
0.8452 --- loss: 0.955443, loss_ss: 0.631907, loss_d: 0.323536
0.8836 --- loss: 1.022400, loss_ss: 0.708280, loss_d: 0.314121
0.9220 --- loss: 1.050774, loss_ss: 0.827468, loss_d: 0.223306
0.9604 --- loss: 2.001508, loss_ss: 1.211488, loss_d: 0.790020
0.9988 --- loss: 1.741232, loss_ss: 1.512179, loss_d: 0.229052
Epoch finished! Loss: 1.1957209697136513
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.728947, loss_ss: 1.008328, loss_d: 0.720619
0.0384 --- loss: 0.856935, loss_ss: 0.600860, loss_d: 0.256075
0.0768 --- loss: 1.201125, loss_ss: 0.871450, loss_d: 0.329675
0.1153 --- loss: 1.140893, loss_ss: 0.950743, loss_d: 0.190150
0.1537 --- loss: 1.019283, loss_ss: 0.659503, loss_d: 0.359780
0.1921 --- loss: 1.302799, loss_ss: 0.779633, loss_d: 0.523166
0.2305 --- loss: 1.254553, loss_ss: 1.061565, loss_d: 0.192988
0.2689 --- loss: 1.155781, loss_ss: 0.896132, loss_d: 0.259650
0.3073 --- loss: 1.487242, loss_ss: 0.738190, loss_d: 0.749052
0.3458 --- loss: 1.562510, loss_ss: 1.049005, loss_d: 0.513505
0.3842 --- loss: 1.091303, loss_ss: 0.703199, loss_d: 0.388103
0.4226 --- loss: 0.900790, loss_ss: 0.589404, loss_d: 0.311387
0.4610 --- loss: 0.884626, loss_ss: 0.718209, loss_d: 0.166417
0.4994 --- loss: 1.034349, loss_ss: 0.835812, loss_d: 0.198537
0.5378 --- loss: 1.229896, loss_ss: 0.914472, loss_d: 0.315424
0.5763 --- loss: 1.016238, loss_ss: 0.820998, loss_d: 0.195241
0.6147 --- loss: 1.070847, loss_ss: 0.769153, loss_d: 0.301693
0.6531 --- loss: 2.661668, loss_ss: 0.809150, loss_d: 1.852518
0.6915 --- loss: 0.996252, loss_ss: 0.695827, loss_d: 0.300425
0.7299 --- loss: 1.113019, loss_ss: 0.889156, loss_d: 0.223863
0.7683 --- loss: 1.451674, loss_ss: 1.333463, loss_d: 0.118212
0.8068 --- loss: 0.898926, loss_ss: 0.799266, loss_d: 0.099660
0.8452 --- loss: 1.198671, loss_ss: 0.840032, loss_d: 0.358639
0.8836 --- loss: 0.983571, loss_ss: 0.710103, loss_d: 0.273468
0.9220 --- loss: 1.687542, loss_ss: 0.975074, loss_d: 0.712468
0.9604 --- loss: 1.025874, loss_ss: 0.776565, loss_d: 0.249309
0.9988 --- loss: 1.920679, loss_ss: 1.607758, loss_d: 0.312921
Epoch finished! Loss: 1.1629884699216255
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.839047619047619
             precision    recall  f1-score   support

        0.0       0.87      0.61      0.71        74
        1.0       0.29      0.05      0.08        42
        2.0       0.86      0.90      0.88       515
        3.0       0.87      0.82      0.84       243
        4.0       0.78      0.98      0.87       176

avg / total       0.82      0.84      0.82      1050
 


====== chc004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.57  60.81   99.28  86.54     71.43
1  95.71   4.76   99.50  28.57      8.16
2  87.62  89.90   85.42  85.58     87.69
3  92.86  81.89   96.16  86.52     84.14
4  95.05  97.73   94.51  78.18     86.87
Total accuracy: 83.90%
Average sen: 67.02%
Average spec: 94.97%
Macro f1-score: 67.66%
Diagnosis acc on 15mins: 0.4857142857142857
[0.23724115 0.14921549 0.32478023 0.36738232 0.58002698 0.96473235
 0.92488521 0.94881111 0.83941305 0.51331669 0.61782044 0.48555639
 0.34579709 0.7943505  0.56656605 0.35564315 0.85538638 0.58523273
 0.38353154 0.31875104 0.66460001 0.83907545 0.83975315 0.60616106
 0.39781606 0.26855144 0.30181533 0.3084037  0.55774176 0.45533735
 0.72435486 0.43534759 0.60320705 0.39206359 0.31769261]
pred: 0.5391531688826424, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc005-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.409871, loss_ss: 1.669597, loss_d: 0.740274
0.0384 --- loss: 1.876948, loss_ss: 1.562342, loss_d: 0.314606
0.0767 --- loss: 1.865478, loss_ss: 1.449406, loss_d: 0.416072
0.1151 --- loss: 2.145327, loss_ss: 1.411519, loss_d: 0.733808
0.1534 --- loss: 2.062324, loss_ss: 1.527207, loss_d: 0.535117
0.1918 --- loss: 1.859567, loss_ss: 1.327976, loss_d: 0.531591
0.2301 --- loss: 1.728555, loss_ss: 1.221500, loss_d: 0.507055
0.2685 --- loss: 1.760470, loss_ss: 1.322087, loss_d: 0.438383
0.3069 --- loss: 1.846778, loss_ss: 1.441169, loss_d: 0.405609
0.3452 --- loss: 2.263891, loss_ss: 1.532431, loss_d: 0.731460
0.3836 --- loss: 2.054183, loss_ss: 1.334040, loss_d: 0.720143
0.4219 --- loss: 1.963059, loss_ss: 1.257688, loss_d: 0.705371
0.4603 --- loss: 1.887891, loss_ss: 1.326012, loss_d: 0.561878
0.4987 --- loss: 1.848296, loss_ss: 1.443767, loss_d: 0.404529
0.5370 --- loss: 2.122602, loss_ss: 1.448135, loss_d: 0.674467
0.5754 --- loss: 2.014536, loss_ss: 1.358939, loss_d: 0.655597
0.6137 --- loss: 1.888044, loss_ss: 1.299569, loss_d: 0.588475
0.6521 --- loss: 2.071146, loss_ss: 1.263827, loss_d: 0.807319
0.6904 --- loss: 1.851861, loss_ss: 1.236105, loss_d: 0.615755
0.7288 --- loss: 2.066998, loss_ss: 1.316728, loss_d: 0.750271
0.7672 --- loss: 1.693964, loss_ss: 1.201174, loss_d: 0.492789
0.8055 --- loss: 1.782899, loss_ss: 1.105039, loss_d: 0.677860
0.8439 --- loss: 2.357843, loss_ss: 1.441077, loss_d: 0.916766
0.8822 --- loss: 1.482755, loss_ss: 1.154769, loss_d: 0.327986
0.9206 --- loss: 1.553938, loss_ss: 1.094838, loss_d: 0.459100
0.9590 --- loss: 2.204357, loss_ss: 1.357440, loss_d: 0.846917
0.9973 --- loss: 1.757000, loss_ss: 1.238082, loss_d: 0.518918
Epoch finished! Loss: 1.9425761163234712
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.682892, loss_ss: 1.069619, loss_d: 0.613273
0.0384 --- loss: 1.885188, loss_ss: 1.139803, loss_d: 0.745385
0.0767 --- loss: 1.814865, loss_ss: 1.183777, loss_d: 0.631088
0.1151 --- loss: 1.513174, loss_ss: 0.956723, loss_d: 0.556451
0.1534 --- loss: 1.659565, loss_ss: 1.199724, loss_d: 0.459842
0.1918 --- loss: 1.797613, loss_ss: 1.103198, loss_d: 0.694414
0.2301 --- loss: 1.860291, loss_ss: 1.204499, loss_d: 0.655791
0.2685 --- loss: 1.686759, loss_ss: 0.964835, loss_d: 0.721923
0.3069 --- loss: 1.494272, loss_ss: 1.034808, loss_d: 0.459464
0.3452 --- loss: 1.950223, loss_ss: 1.102625, loss_d: 0.847598
0.3836 --- loss: 1.706716, loss_ss: 1.153227, loss_d: 0.553489
0.4219 --- loss: 1.430717, loss_ss: 1.020901, loss_d: 0.409816
0.4603 --- loss: 1.680606, loss_ss: 1.099329, loss_d: 0.581276
0.4987 --- loss: 1.622674, loss_ss: 1.030789, loss_d: 0.591886
0.5370 --- loss: 1.529724, loss_ss: 1.139224, loss_d: 0.390501
0.5754 --- loss: 1.544206, loss_ss: 0.906779, loss_d: 0.637428
0.6137 --- loss: 1.672807, loss_ss: 1.061727, loss_d: 0.611081
0.6521 --- loss: 1.708265, loss_ss: 1.321829, loss_d: 0.386436
0.6904 --- loss: 1.362337, loss_ss: 1.018115, loss_d: 0.344222
0.7288 --- loss: 1.919605, loss_ss: 1.454266, loss_d: 0.465339
0.7672 --- loss: 1.469441, loss_ss: 1.090288, loss_d: 0.379154
0.8055 --- loss: 1.458924, loss_ss: 0.930084, loss_d: 0.528841
0.8439 --- loss: 1.817096, loss_ss: 1.294726, loss_d: 0.522370
0.8822 --- loss: 1.461788, loss_ss: 0.923976, loss_d: 0.537812
0.9206 --- loss: 1.614372, loss_ss: 0.811360, loss_d: 0.803011
0.9590 --- loss: 1.802026, loss_ss: 0.993545, loss_d: 0.808481
0.9973 --- loss: 1.588658, loss_ss: 1.041855, loss_d: 0.546803
Epoch finished! Loss: 1.7200543779593247
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.579271, loss_ss: 1.031392, loss_d: 0.547879
0.0384 --- loss: 1.687817, loss_ss: 1.152409, loss_d: 0.535408
0.0767 --- loss: 1.789312, loss_ss: 1.335427, loss_d: 0.453885
0.1151 --- loss: 1.727036, loss_ss: 1.356005, loss_d: 0.371031
0.1534 --- loss: 1.817499, loss_ss: 1.016981, loss_d: 0.800518
0.1918 --- loss: 1.788516, loss_ss: 1.305943, loss_d: 0.482573
0.2301 --- loss: 1.545681, loss_ss: 1.033602, loss_d: 0.512079
0.2685 --- loss: 1.758333, loss_ss: 0.931318, loss_d: 0.827015
0.3069 --- loss: 1.810207, loss_ss: 1.216588, loss_d: 0.593619
0.3452 --- loss: 1.804321, loss_ss: 0.904059, loss_d: 0.900261
0.3836 --- loss: 1.515870, loss_ss: 1.034888, loss_d: 0.480982
0.4219 --- loss: 1.365845, loss_ss: 0.879353, loss_d: 0.486493
0.4603 --- loss: 1.552365, loss_ss: 0.929570, loss_d: 0.622796
0.4987 --- loss: 1.385224, loss_ss: 1.094255, loss_d: 0.290969
0.5370 --- loss: 1.818958, loss_ss: 1.130321, loss_d: 0.688637
0.5754 --- loss: 1.424448, loss_ss: 0.992412, loss_d: 0.432037
0.6137 --- loss: 1.480988, loss_ss: 1.253526, loss_d: 0.227462
0.6521 --- loss: 1.634719, loss_ss: 1.057766, loss_d: 0.576953
0.6904 --- loss: 1.591768, loss_ss: 0.852690, loss_d: 0.739077
0.7288 --- loss: 1.384158, loss_ss: 0.932383, loss_d: 0.451775
0.7672 --- loss: 1.617940, loss_ss: 0.923885, loss_d: 0.694055
0.8055 --- loss: 1.222638, loss_ss: 0.858112, loss_d: 0.364525
0.8439 --- loss: 1.358386, loss_ss: 0.989234, loss_d: 0.369152
0.8822 --- loss: 1.797700, loss_ss: 0.995851, loss_d: 0.801849
0.9206 --- loss: 1.149565, loss_ss: 0.709814, loss_d: 0.439752
0.9590 --- loss: 1.582670, loss_ss: 1.081985, loss_d: 0.500685
0.9973 --- loss: 1.654786, loss_ss: 1.066676, loss_d: 0.588110
Epoch finished! Loss: 1.5814607565219585
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.662654, loss_ss: 0.907168, loss_d: 0.755486
0.0384 --- loss: 1.866866, loss_ss: 1.228297, loss_d: 0.638569
0.0767 --- loss: 1.615774, loss_ss: 1.001709, loss_d: 0.614065
0.1151 --- loss: 1.613115, loss_ss: 1.072149, loss_d: 0.540965
0.1534 --- loss: 1.596095, loss_ss: 0.993611, loss_d: 0.602485
0.1918 --- loss: 2.061686, loss_ss: 1.490577, loss_d: 0.571109
0.2301 --- loss: 1.646684, loss_ss: 1.126403, loss_d: 0.520281
0.2685 --- loss: 1.383450, loss_ss: 0.921678, loss_d: 0.461772
0.3069 --- loss: 1.413920, loss_ss: 0.943358, loss_d: 0.470562
0.3452 --- loss: 1.376569, loss_ss: 0.860034, loss_d: 0.516535
0.3836 --- loss: 1.807704, loss_ss: 0.966155, loss_d: 0.841550
0.4219 --- loss: 1.152691, loss_ss: 0.878487, loss_d: 0.274204
0.4603 --- loss: 1.355783, loss_ss: 0.870638, loss_d: 0.485144
0.4987 --- loss: 1.578570, loss_ss: 0.871763, loss_d: 0.706806
0.5370 --- loss: 1.337051, loss_ss: 0.831566, loss_d: 0.505486
0.5754 --- loss: 1.411175, loss_ss: 0.998902, loss_d: 0.412273
0.6137 --- loss: 1.439377, loss_ss: 0.780186, loss_d: 0.659191
0.6521 --- loss: 1.491109, loss_ss: 0.962409, loss_d: 0.528699
0.6904 --- loss: 1.649633, loss_ss: 0.901221, loss_d: 0.748413
0.7288 --- loss: 1.743502, loss_ss: 0.739056, loss_d: 1.004445
0.7672 --- loss: 1.366034, loss_ss: 0.984229, loss_d: 0.381805
0.8055 --- loss: 1.977187, loss_ss: 1.176564, loss_d: 0.800623
0.8439 --- loss: 1.079071, loss_ss: 0.742822, loss_d: 0.336248
0.8822 --- loss: 1.830307, loss_ss: 1.094357, loss_d: 0.735950
0.9206 --- loss: 1.134479, loss_ss: 0.840720, loss_d: 0.293759
0.9590 --- loss: 1.200675, loss_ss: 0.765989, loss_d: 0.434686
0.9973 --- loss: 1.652640, loss_ss: 0.942015, loss_d: 0.710625
Epoch finished! Loss: 1.5230985352626214
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.401628, loss_ss: 0.798467, loss_d: 0.603161
0.0384 --- loss: 1.812670, loss_ss: 1.102517, loss_d: 0.710153
0.0767 --- loss: 1.431904, loss_ss: 1.019631, loss_d: 0.412272
0.1151 --- loss: 1.710338, loss_ss: 0.876486, loss_d: 0.833852
0.1534 --- loss: 1.386682, loss_ss: 0.573477, loss_d: 0.813205
0.1918 --- loss: 1.242484, loss_ss: 0.850866, loss_d: 0.391618
0.2301 --- loss: 1.428397, loss_ss: 0.825512, loss_d: 0.602885
0.2685 --- loss: 1.232728, loss_ss: 0.860548, loss_d: 0.372180
0.3069 --- loss: 1.236626, loss_ss: 0.942266, loss_d: 0.294360
0.3452 --- loss: 1.510571, loss_ss: 0.868149, loss_d: 0.642422
0.3836 --- loss: 1.526726, loss_ss: 0.893763, loss_d: 0.632964
0.4219 --- loss: 1.445351, loss_ss: 0.747832, loss_d: 0.697519
0.4603 --- loss: 1.492780, loss_ss: 1.113811, loss_d: 0.378969
0.4987 --- loss: 1.989260, loss_ss: 1.489922, loss_d: 0.499338
0.5370 --- loss: 1.452076, loss_ss: 0.979695, loss_d: 0.472381
0.5754 --- loss: 1.354907, loss_ss: 0.934857, loss_d: 0.420050
0.6137 --- loss: 1.432631, loss_ss: 0.855839, loss_d: 0.576793
0.6521 --- loss: 1.349383, loss_ss: 0.656030, loss_d: 0.693353
0.6904 --- loss: 1.365679, loss_ss: 0.910065, loss_d: 0.455614
0.7288 --- loss: 1.048905, loss_ss: 0.613989, loss_d: 0.434916
0.7672 --- loss: 1.606269, loss_ss: 1.153083, loss_d: 0.453187
0.8055 --- loss: 1.748239, loss_ss: 1.148014, loss_d: 0.600224
0.8439 --- loss: 1.591840, loss_ss: 0.926016, loss_d: 0.665824
0.8822 --- loss: 1.094385, loss_ss: 0.791196, loss_d: 0.303189
0.9206 --- loss: 1.328712, loss_ss: 0.958337, loss_d: 0.370375
0.9590 --- loss: 1.528208, loss_ss: 0.880212, loss_d: 0.647996
0.9973 --- loss: 1.169251, loss_ss: 0.988491, loss_d: 0.180760
Epoch finished! Loss: 1.4665083933335084
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.542853, loss_ss: 0.916861, loss_d: 0.625992
0.0384 --- loss: 1.430591, loss_ss: 0.779472, loss_d: 0.651118
0.0767 --- loss: 1.673869, loss_ss: 0.857273, loss_d: 0.816597
0.1151 --- loss: 2.203611, loss_ss: 1.286415, loss_d: 0.917196
0.1534 --- loss: 1.486936, loss_ss: 1.101200, loss_d: 0.385735
0.1918 --- loss: 1.153981, loss_ss: 0.935373, loss_d: 0.218609
0.2301 --- loss: 1.269191, loss_ss: 0.863572, loss_d: 0.405620
0.2685 --- loss: 1.202839, loss_ss: 0.763863, loss_d: 0.438976
0.3069 --- loss: 1.517156, loss_ss: 0.849854, loss_d: 0.667302
0.3452 --- loss: 2.100310, loss_ss: 1.391118, loss_d: 0.709192
0.3836 --- loss: 1.537109, loss_ss: 0.864019, loss_d: 0.673090
0.4219 --- loss: 1.524104, loss_ss: 0.954617, loss_d: 0.569487
0.4603 --- loss: 1.312848, loss_ss: 0.775246, loss_d: 0.537603
0.4987 --- loss: 1.660778, loss_ss: 1.018194, loss_d: 0.642584
0.5370 --- loss: 1.246516, loss_ss: 0.731037, loss_d: 0.515479
0.5754 --- loss: 1.358896, loss_ss: 0.939219, loss_d: 0.419677
0.6137 --- loss: 1.369310, loss_ss: 0.877043, loss_d: 0.492268
0.6521 --- loss: 1.475410, loss_ss: 1.082424, loss_d: 0.392986
0.6904 --- loss: 1.228819, loss_ss: 1.044763, loss_d: 0.184056
0.7288 --- loss: 1.483028, loss_ss: 0.551211, loss_d: 0.931817
0.7672 --- loss: 1.460999, loss_ss: 1.036008, loss_d: 0.424991
0.8055 --- loss: 1.499231, loss_ss: 0.699254, loss_d: 0.799977
0.8439 --- loss: 1.337630, loss_ss: 0.818828, loss_d: 0.518802
0.8822 --- loss: 1.348843, loss_ss: 0.984563, loss_d: 0.364280
0.9206 --- loss: 1.221556, loss_ss: 0.938711, loss_d: 0.282845
0.9590 --- loss: 1.161720, loss_ss: 0.779459, loss_d: 0.382262
0.9973 --- loss: 2.005250, loss_ss: 0.835745, loss_d: 1.169505
Epoch finished! Loss: 1.4494293380242127
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.389950, loss_ss: 0.765103, loss_d: 0.624846
0.0384 --- loss: 1.193584, loss_ss: 0.728168, loss_d: 0.465416
0.0767 --- loss: 1.276317, loss_ss: 0.871611, loss_d: 0.404706
0.1151 --- loss: 1.318109, loss_ss: 0.800880, loss_d: 0.517228
0.1534 --- loss: 1.156467, loss_ss: 0.756393, loss_d: 0.400074
0.1918 --- loss: 1.174823, loss_ss: 0.727764, loss_d: 0.447059
0.2301 --- loss: 1.373220, loss_ss: 1.071708, loss_d: 0.301512
0.2685 --- loss: 1.629370, loss_ss: 0.984855, loss_d: 0.644515
0.3069 --- loss: 1.207241, loss_ss: 0.882761, loss_d: 0.324480
0.3452 --- loss: 1.184882, loss_ss: 0.758734, loss_d: 0.426148
0.3836 --- loss: 1.842251, loss_ss: 1.049150, loss_d: 0.793101
0.4219 --- loss: 1.690694, loss_ss: 0.575930, loss_d: 1.114764
0.4603 --- loss: 1.408589, loss_ss: 0.699060, loss_d: 0.709529
0.4987 --- loss: 1.399100, loss_ss: 1.030749, loss_d: 0.368350
0.5370 --- loss: 1.387589, loss_ss: 0.761993, loss_d: 0.625596
0.5754 --- loss: 1.557445, loss_ss: 0.953950, loss_d: 0.603495
0.6137 --- loss: 1.408350, loss_ss: 0.909087, loss_d: 0.499263
0.6521 --- loss: 1.786835, loss_ss: 1.021766, loss_d: 0.765069
0.6904 --- loss: 1.092035, loss_ss: 0.752920, loss_d: 0.339115
0.7288 --- loss: 1.329682, loss_ss: 0.971582, loss_d: 0.358100
0.7672 --- loss: 1.252732, loss_ss: 0.745186, loss_d: 0.507545
0.8055 --- loss: 1.180834, loss_ss: 0.756703, loss_d: 0.424131
0.8439 --- loss: 1.421937, loss_ss: 1.058989, loss_d: 0.362947
0.8822 --- loss: 1.759765, loss_ss: 1.139619, loss_d: 0.620146
0.9206 --- loss: 1.044855, loss_ss: 0.850378, loss_d: 0.194477
0.9590 --- loss: 1.682298, loss_ss: 0.933105, loss_d: 0.749193
0.9973 --- loss: 1.331154, loss_ss: 0.822640, loss_d: 0.508513
Epoch finished! Loss: 1.3494975184018796
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.406782, loss_ss: 0.961440, loss_d: 0.445342
0.0384 --- loss: 1.334138, loss_ss: 1.036815, loss_d: 0.297323
0.0767 --- loss: 1.436365, loss_ss: 1.021117, loss_d: 0.415248
0.1151 --- loss: 1.335936, loss_ss: 1.128170, loss_d: 0.207766
0.1534 --- loss: 1.188136, loss_ss: 0.846331, loss_d: 0.341805
0.1918 --- loss: 1.395783, loss_ss: 0.636482, loss_d: 0.759301
0.2301 --- loss: 1.284251, loss_ss: 0.996999, loss_d: 0.287252
0.2685 --- loss: 1.779268, loss_ss: 1.413745, loss_d: 0.365523
0.3069 --- loss: 0.920286, loss_ss: 0.574149, loss_d: 0.346137
0.3452 --- loss: 1.252263, loss_ss: 0.879038, loss_d: 0.373225
0.3836 --- loss: 1.485988, loss_ss: 0.934555, loss_d: 0.551433
0.4219 --- loss: 1.319773, loss_ss: 0.739200, loss_d: 0.580574
0.4603 --- loss: 1.405501, loss_ss: 1.060330, loss_d: 0.345171
0.4987 --- loss: 1.513543, loss_ss: 1.104230, loss_d: 0.409314
0.5370 --- loss: 1.364146, loss_ss: 0.928957, loss_d: 0.435189
0.5754 --- loss: 1.331698, loss_ss: 1.110640, loss_d: 0.221057
0.6137 --- loss: 1.143522, loss_ss: 0.827436, loss_d: 0.316086
0.6521 --- loss: 1.156851, loss_ss: 0.884614, loss_d: 0.272237
0.6904 --- loss: 1.128261, loss_ss: 0.949608, loss_d: 0.178653
0.7288 --- loss: 1.595523, loss_ss: 0.810090, loss_d: 0.785433
0.7672 --- loss: 1.392986, loss_ss: 1.119757, loss_d: 0.273229
0.8055 --- loss: 0.963759, loss_ss: 0.819759, loss_d: 0.144001
0.8439 --- loss: 1.103549, loss_ss: 0.936806, loss_d: 0.166743
0.8822 --- loss: 1.082790, loss_ss: 0.551948, loss_d: 0.530842
0.9206 --- loss: 1.208181, loss_ss: 0.766411, loss_d: 0.441770
0.9590 --- loss: 1.453067, loss_ss: 0.998752, loss_d: 0.454315
0.9973 --- loss: 1.145451, loss_ss: 0.764823, loss_d: 0.380628
Epoch finished! Loss: 1.3039800277123084
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.202958, loss_ss: 0.701523, loss_d: 0.501435
0.0384 --- loss: 1.559737, loss_ss: 1.005731, loss_d: 0.554006
0.0767 --- loss: 1.415813, loss_ss: 0.836518, loss_d: 0.579295
0.1151 --- loss: 1.578633, loss_ss: 0.815314, loss_d: 0.763319
0.1534 --- loss: 1.093113, loss_ss: 0.547987, loss_d: 0.545126
0.1918 --- loss: 1.421192, loss_ss: 0.935553, loss_d: 0.485639
0.2301 --- loss: 1.323843, loss_ss: 1.096754, loss_d: 0.227089
0.2685 --- loss: 1.089934, loss_ss: 0.925592, loss_d: 0.164342
0.3069 --- loss: 1.001459, loss_ss: 0.786033, loss_d: 0.215426
0.3452 --- loss: 1.202902, loss_ss: 1.018764, loss_d: 0.184139
0.3836 --- loss: 1.141183, loss_ss: 0.425369, loss_d: 0.715813
0.4219 --- loss: 1.263569, loss_ss: 0.784281, loss_d: 0.479288
0.4603 --- loss: 1.136355, loss_ss: 0.668920, loss_d: 0.467435
0.4987 --- loss: 1.264066, loss_ss: 0.856996, loss_d: 0.407070
0.5370 --- loss: 1.010343, loss_ss: 0.816176, loss_d: 0.194167
0.5754 --- loss: 1.259850, loss_ss: 0.747021, loss_d: 0.512829
0.6137 --- loss: 1.367339, loss_ss: 1.144474, loss_d: 0.222865
0.6521 --- loss: 1.406367, loss_ss: 0.869139, loss_d: 0.537228
0.6904 --- loss: 1.727367, loss_ss: 1.323919, loss_d: 0.403448
0.7288 --- loss: 1.028359, loss_ss: 0.819662, loss_d: 0.208697
0.7672 --- loss: 1.120433, loss_ss: 0.936427, loss_d: 0.184006
0.8055 --- loss: 0.966928, loss_ss: 0.793491, loss_d: 0.173437
0.8439 --- loss: 1.109034, loss_ss: 0.832071, loss_d: 0.276963
0.8822 --- loss: 0.957180, loss_ss: 0.782571, loss_d: 0.174609
0.9206 --- loss: 1.205773, loss_ss: 0.759657, loss_d: 0.446116
0.9590 --- loss: 0.873226, loss_ss: 0.614731, loss_d: 0.258495
0.9973 --- loss: 1.102418, loss_ss: 0.999399, loss_d: 0.103019
Epoch finished! Loss: 1.2456764737000832
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.342577, loss_ss: 1.239215, loss_d: 0.103362
0.0384 --- loss: 0.923664, loss_ss: 0.563649, loss_d: 0.360016
0.0767 --- loss: 1.071254, loss_ss: 0.928200, loss_d: 0.143055
0.1151 --- loss: 1.373457, loss_ss: 1.048180, loss_d: 0.325277
0.1534 --- loss: 0.827566, loss_ss: 0.688706, loss_d: 0.138860
0.1918 --- loss: 1.246114, loss_ss: 0.919642, loss_d: 0.326471
0.2301 --- loss: 1.000052, loss_ss: 0.785080, loss_d: 0.214971
0.2685 --- loss: 1.018867, loss_ss: 0.653819, loss_d: 0.365048
0.3069 --- loss: 1.117400, loss_ss: 0.812086, loss_d: 0.305314
0.3452 --- loss: 0.861809, loss_ss: 0.693289, loss_d: 0.168520
0.3836 --- loss: 1.291162, loss_ss: 0.883672, loss_d: 0.407490
0.4219 --- loss: 1.326391, loss_ss: 0.647926, loss_d: 0.678465
0.4603 --- loss: 0.940044, loss_ss: 0.711994, loss_d: 0.228050
0.4987 --- loss: 1.025501, loss_ss: 0.858773, loss_d: 0.166728
0.5370 --- loss: 1.065452, loss_ss: 0.955956, loss_d: 0.109497
0.5754 --- loss: 1.044931, loss_ss: 0.753573, loss_d: 0.291358
0.6137 --- loss: 1.245957, loss_ss: 0.860244, loss_d: 0.385712
0.6521 --- loss: 1.091789, loss_ss: 0.622773, loss_d: 0.469017
0.6904 --- loss: 0.721967, loss_ss: 0.551440, loss_d: 0.170527
0.7288 --- loss: 1.044725, loss_ss: 0.906659, loss_d: 0.138066
0.7672 --- loss: 1.324871, loss_ss: 0.962803, loss_d: 0.362068
0.8055 --- loss: 1.187404, loss_ss: 0.937860, loss_d: 0.249545
0.8439 --- loss: 1.170954, loss_ss: 0.855889, loss_d: 0.315065
0.8822 --- loss: 0.915455, loss_ss: 0.727267, loss_d: 0.188187
0.9206 --- loss: 1.018635, loss_ss: 0.713945, loss_d: 0.304690
0.9590 --- loss: 1.155721, loss_ss: 0.872697, loss_d: 0.283023
0.9973 --- loss: 1.540125, loss_ss: 1.139042, loss_d: 0.401083
Epoch finished! Loss: 1.1990917405256858
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7580645161290323
             precision    recall  f1-score   support

        0.0       0.26      1.00      0.42        41
        1.0       0.00      0.00      0.00        33
        2.0       0.95      0.69      0.80       530
        3.0       0.80      0.92      0.85       236
        4.0       0.70      0.92      0.80        90

avg / total       0.82      0.76      0.77       930
 


====== chc005-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  87.74  100.00   87.18  26.45     41.84
1  96.45    0.00  100.00   0.00      0.00
2  80.00   68.87   94.75  94.56     79.69
3  91.94   91.53   92.07  79.70     85.21
4  95.48   92.22   95.83  70.34     79.81
Total accuracy: 75.81%
Average sen: 70.52%
Average spec: 93.97%
Macro f1-score: 57.31%
Diagnosis acc on 15mins: 1.0
[0.15445535 0.0440077  0.06972223 0.1836931  0.09739555 0.07211472
 0.07137985 0.09614178 0.07742169 0.04147946 0.04885143 0.06606649
 0.09634764 0.0918434  0.08497144 0.08819746 0.06822821 0.06176225
 0.13345809 0.06975206 0.09811462 0.22332826 0.19470473 0.06846862
 0.02304708 0.06810151 0.13427922 0.0400165  0.12139601 0.11971338
 0.06397492]
pred: 0.09265918591089788, label: 0
Right! Diagnosis: Other

=== Test on chc006-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.273457, loss_ss: 1.579106, loss_d: 0.694351
0.0383 --- loss: 2.345158, loss_ss: 1.560714, loss_d: 0.784444
0.0766 --- loss: 2.182512, loss_ss: 1.545404, loss_d: 0.637108
0.1149 --- loss: 1.779533, loss_ss: 1.375668, loss_d: 0.403865
0.1532 --- loss: 2.405736, loss_ss: 1.459979, loss_d: 0.945757
0.1915 --- loss: 1.980848, loss_ss: 1.239286, loss_d: 0.741562
0.2298 --- loss: 1.852719, loss_ss: 1.267314, loss_d: 0.585405
0.2681 --- loss: 2.055030, loss_ss: 1.439604, loss_d: 0.615426
0.3064 --- loss: 1.695733, loss_ss: 1.238522, loss_d: 0.457211
0.3447 --- loss: 1.578495, loss_ss: 1.159533, loss_d: 0.418962
0.3830 --- loss: 2.195220, loss_ss: 1.217693, loss_d: 0.977528
0.4213 --- loss: 1.786480, loss_ss: 1.218136, loss_d: 0.568345
0.4596 --- loss: 1.721957, loss_ss: 1.192406, loss_d: 0.529552
0.4979 --- loss: 1.608004, loss_ss: 1.187620, loss_d: 0.420384
0.5362 --- loss: 1.829392, loss_ss: 1.067998, loss_d: 0.761394
0.5745 --- loss: 1.562783, loss_ss: 1.141739, loss_d: 0.421044
0.6128 --- loss: 1.651978, loss_ss: 1.169375, loss_d: 0.482602
0.6511 --- loss: 1.766351, loss_ss: 1.317124, loss_d: 0.449227
0.6894 --- loss: 1.985559, loss_ss: 1.185379, loss_d: 0.800180
0.7277 --- loss: 1.572352, loss_ss: 1.131325, loss_d: 0.441027
0.7660 --- loss: 1.999837, loss_ss: 1.088261, loss_d: 0.911575
0.8043 --- loss: 2.121512, loss_ss: 1.328199, loss_d: 0.793314
0.8426 --- loss: 1.297248, loss_ss: 1.038664, loss_d: 0.258584
0.8809 --- loss: 1.762276, loss_ss: 1.182317, loss_d: 0.579959
0.9192 --- loss: 1.567222, loss_ss: 1.074489, loss_d: 0.492733
0.9575 --- loss: 1.904254, loss_ss: 1.133327, loss_d: 0.770927
0.9958 --- loss: 1.622485, loss_ss: 0.981571, loss_d: 0.640913
Epoch finished! Loss: 1.8491079976275506
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.575677, loss_ss: 1.027599, loss_d: 0.548078
0.0383 --- loss: 1.601733, loss_ss: 0.976544, loss_d: 0.625190
0.0766 --- loss: 1.469143, loss_ss: 1.163994, loss_d: 0.305149
0.1149 --- loss: 1.707089, loss_ss: 1.273854, loss_d: 0.433235
0.1532 --- loss: 1.438401, loss_ss: 1.026018, loss_d: 0.412383
0.1915 --- loss: 1.656308, loss_ss: 1.025821, loss_d: 0.630488
0.2298 --- loss: 1.341135, loss_ss: 0.903946, loss_d: 0.437189
0.2681 --- loss: 1.811931, loss_ss: 1.164331, loss_d: 0.647600
0.3064 --- loss: 1.780226, loss_ss: 1.096163, loss_d: 0.684062
0.3447 --- loss: 1.294865, loss_ss: 1.068138, loss_d: 0.226726
0.3830 --- loss: 1.575787, loss_ss: 0.973437, loss_d: 0.602349
0.4213 --- loss: 1.601434, loss_ss: 1.165918, loss_d: 0.435517
0.4596 --- loss: 1.696365, loss_ss: 1.157248, loss_d: 0.539117
0.4979 --- loss: 1.635809, loss_ss: 1.084093, loss_d: 0.551717
0.5362 --- loss: 1.824559, loss_ss: 1.021964, loss_d: 0.802595
0.5745 --- loss: 1.776487, loss_ss: 1.312738, loss_d: 0.463749
0.6128 --- loss: 1.475046, loss_ss: 1.022411, loss_d: 0.452635
0.6511 --- loss: 1.265003, loss_ss: 0.835167, loss_d: 0.429836
0.6894 --- loss: 1.597683, loss_ss: 1.100792, loss_d: 0.496891
0.7277 --- loss: 1.514119, loss_ss: 1.090431, loss_d: 0.423688
0.7660 --- loss: 1.809164, loss_ss: 1.074498, loss_d: 0.734665
0.8043 --- loss: 1.953853, loss_ss: 1.533044, loss_d: 0.420809
0.8426 --- loss: 1.747988, loss_ss: 1.069370, loss_d: 0.678618
0.8809 --- loss: 1.718425, loss_ss: 0.974445, loss_d: 0.743979
0.9192 --- loss: 1.707409, loss_ss: 1.166144, loss_d: 0.541265
0.9575 --- loss: 1.524404, loss_ss: 0.988560, loss_d: 0.535845
0.9958 --- loss: 1.582572, loss_ss: 1.021103, loss_d: 0.561469
Epoch finished! Loss: 1.6392247448479078
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.821386, loss_ss: 1.233948, loss_d: 0.587438
0.0383 --- loss: 1.616041, loss_ss: 1.057249, loss_d: 0.558792
0.0766 --- loss: 1.669383, loss_ss: 0.919655, loss_d: 0.749729
0.1149 --- loss: 1.853238, loss_ss: 1.216736, loss_d: 0.636502
0.1532 --- loss: 1.538987, loss_ss: 0.947629, loss_d: 0.591358
0.1915 --- loss: 1.679941, loss_ss: 1.135524, loss_d: 0.544416
0.2298 --- loss: 1.875133, loss_ss: 1.108002, loss_d: 0.767131
0.2681 --- loss: 1.868483, loss_ss: 0.985765, loss_d: 0.882718
0.3064 --- loss: 1.541063, loss_ss: 0.816365, loss_d: 0.724699
0.3447 --- loss: 1.485568, loss_ss: 1.015931, loss_d: 0.469637
0.3830 --- loss: 1.852795, loss_ss: 1.185882, loss_d: 0.666913
0.4213 --- loss: 1.833833, loss_ss: 1.078722, loss_d: 0.755110
0.4596 --- loss: 1.437786, loss_ss: 0.884618, loss_d: 0.553168
0.4979 --- loss: 1.358931, loss_ss: 0.868276, loss_d: 0.490655
0.5362 --- loss: 2.093313, loss_ss: 1.039118, loss_d: 1.054195
0.5745 --- loss: 1.732558, loss_ss: 1.041966, loss_d: 0.690592
0.6128 --- loss: 1.440259, loss_ss: 1.068525, loss_d: 0.371734
0.6511 --- loss: 1.741840, loss_ss: 1.343151, loss_d: 0.398688
0.6894 --- loss: 1.638561, loss_ss: 0.935597, loss_d: 0.702963
0.7277 --- loss: 1.854893, loss_ss: 1.167162, loss_d: 0.687730
0.7660 --- loss: 1.329583, loss_ss: 0.990876, loss_d: 0.338707
0.8043 --- loss: 1.508760, loss_ss: 1.088680, loss_d: 0.420080
0.8426 --- loss: 1.632049, loss_ss: 0.995394, loss_d: 0.636654
0.8809 --- loss: 1.343367, loss_ss: 0.922656, loss_d: 0.420711
0.9192 --- loss: 1.450484, loss_ss: 1.158816, loss_d: 0.291668
0.9575 --- loss: 1.642197, loss_ss: 0.923393, loss_d: 0.718804
0.9958 --- loss: 1.602062, loss_ss: 0.937403, loss_d: 0.664659
Epoch finished! Loss: 1.5701437375554637
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.567576, loss_ss: 1.051429, loss_d: 0.516147
0.0383 --- loss: 1.425360, loss_ss: 0.984266, loss_d: 0.441094
0.0766 --- loss: 1.641187, loss_ss: 0.892109, loss_d: 0.749078
0.1149 --- loss: 1.402207, loss_ss: 0.996004, loss_d: 0.406203
0.1532 --- loss: 1.913188, loss_ss: 1.419595, loss_d: 0.493593
0.1915 --- loss: 1.554199, loss_ss: 0.988895, loss_d: 0.565304
0.2298 --- loss: 1.842227, loss_ss: 1.554537, loss_d: 0.287690
0.2681 --- loss: 1.366228, loss_ss: 0.762467, loss_d: 0.603760
0.3064 --- loss: 1.674075, loss_ss: 1.218572, loss_d: 0.455502
0.3447 --- loss: 1.649337, loss_ss: 1.182918, loss_d: 0.466419
0.3830 --- loss: 1.474229, loss_ss: 0.949171, loss_d: 0.525059
0.4213 --- loss: 1.150445, loss_ss: 0.777243, loss_d: 0.373201
0.4596 --- loss: 1.366238, loss_ss: 0.962372, loss_d: 0.403865
0.4979 --- loss: 1.711435, loss_ss: 1.189626, loss_d: 0.521808
0.5362 --- loss: 1.454637, loss_ss: 0.774627, loss_d: 0.680010
0.5745 --- loss: 1.427268, loss_ss: 0.859249, loss_d: 0.568019
0.6128 --- loss: 1.519430, loss_ss: 1.048649, loss_d: 0.470782
0.6511 --- loss: 1.154293, loss_ss: 0.790185, loss_d: 0.364108
0.6894 --- loss: 1.349377, loss_ss: 0.871003, loss_d: 0.478373
0.7277 --- loss: 1.285664, loss_ss: 1.035086, loss_d: 0.250578
0.7660 --- loss: 1.249834, loss_ss: 0.904211, loss_d: 0.345623
0.8043 --- loss: 1.117577, loss_ss: 0.894760, loss_d: 0.222818
0.8426 --- loss: 1.632265, loss_ss: 0.699042, loss_d: 0.933223
0.8809 --- loss: 1.565358, loss_ss: 0.857127, loss_d: 0.708231
0.9192 --- loss: 1.566989, loss_ss: 1.061138, loss_d: 0.505851
0.9575 --- loss: 1.172237, loss_ss: 0.927942, loss_d: 0.244295
0.9958 --- loss: 1.557930, loss_ss: 0.764993, loss_d: 0.792937
Epoch finished! Loss: 1.475658205733902
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.223801, loss_ss: 0.840628, loss_d: 0.383172
0.0383 --- loss: 1.407256, loss_ss: 1.077982, loss_d: 0.329274
0.0766 --- loss: 1.196028, loss_ss: 0.875145, loss_d: 0.320883
0.1149 --- loss: 1.318338, loss_ss: 0.839776, loss_d: 0.478562
0.1532 --- loss: 1.669017, loss_ss: 1.112046, loss_d: 0.556971
0.1915 --- loss: 1.186805, loss_ss: 0.742968, loss_d: 0.443836
0.2298 --- loss: 1.741740, loss_ss: 1.157515, loss_d: 0.584226
0.2681 --- loss: 1.472113, loss_ss: 0.941426, loss_d: 0.530686
0.3064 --- loss: 1.038156, loss_ss: 0.611991, loss_d: 0.426165
0.3447 --- loss: 1.289089, loss_ss: 0.963002, loss_d: 0.326087
0.3830 --- loss: 1.073036, loss_ss: 0.822761, loss_d: 0.250275
0.4213 --- loss: 1.064930, loss_ss: 0.858027, loss_d: 0.206903
0.4596 --- loss: 1.026833, loss_ss: 0.742455, loss_d: 0.284379
0.4979 --- loss: 1.811691, loss_ss: 0.950829, loss_d: 0.860862
0.5362 --- loss: 1.360759, loss_ss: 1.091243, loss_d: 0.269516
0.5745 --- loss: 1.367218, loss_ss: 0.899686, loss_d: 0.467532
0.6128 --- loss: 1.731702, loss_ss: 1.396199, loss_d: 0.335503
0.6511 --- loss: 0.872406, loss_ss: 0.716321, loss_d: 0.156085
0.6894 --- loss: 1.402722, loss_ss: 0.934576, loss_d: 0.468145
0.7277 --- loss: 1.323307, loss_ss: 0.920077, loss_d: 0.403230
0.7660 --- loss: 1.265031, loss_ss: 1.092465, loss_d: 0.172565
0.8043 --- loss: 1.788083, loss_ss: 0.980590, loss_d: 0.807492
0.8426 --- loss: 1.713224, loss_ss: 1.324124, loss_d: 0.389100
0.8809 --- loss: 0.993133, loss_ss: 0.764689, loss_d: 0.228444
0.9192 --- loss: 1.142599, loss_ss: 0.844905, loss_d: 0.297694
0.9575 --- loss: 1.118885, loss_ss: 0.849601, loss_d: 0.269284
0.9958 --- loss: 0.987168, loss_ss: 0.761205, loss_d: 0.225963
Epoch finished! Loss: 1.3600385958664263
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.281408, loss_ss: 1.105361, loss_d: 0.176047
0.0383 --- loss: 0.991889, loss_ss: 0.706152, loss_d: 0.285737
0.0766 --- loss: 1.055571, loss_ss: 0.792561, loss_d: 0.263010
0.1149 --- loss: 1.276063, loss_ss: 1.051515, loss_d: 0.224548
0.1532 --- loss: 1.427444, loss_ss: 0.836616, loss_d: 0.590829
0.1915 --- loss: 1.372792, loss_ss: 1.039793, loss_d: 0.332998
0.2298 --- loss: 1.165264, loss_ss: 0.973212, loss_d: 0.192052
0.2681 --- loss: 1.260214, loss_ss: 0.797274, loss_d: 0.462940
0.3064 --- loss: 1.365233, loss_ss: 0.958041, loss_d: 0.407192
0.3447 --- loss: 1.238309, loss_ss: 0.790264, loss_d: 0.448046
0.3830 --- loss: 1.229233, loss_ss: 0.960923, loss_d: 0.268310
0.4213 --- loss: 1.910142, loss_ss: 1.518248, loss_d: 0.391894
0.4596 --- loss: 1.463167, loss_ss: 0.756922, loss_d: 0.706245
0.4979 --- loss: 1.423221, loss_ss: 0.896737, loss_d: 0.526484
0.5362 --- loss: 0.844680, loss_ss: 0.644376, loss_d: 0.200304
0.5745 --- loss: 1.591352, loss_ss: 1.183027, loss_d: 0.408325
0.6128 --- loss: 1.138023, loss_ss: 0.974707, loss_d: 0.163316
0.6511 --- loss: 0.985843, loss_ss: 0.836160, loss_d: 0.149683
0.6894 --- loss: 1.147924, loss_ss: 0.915011, loss_d: 0.232913
0.7277 --- loss: 1.321483, loss_ss: 0.902965, loss_d: 0.418518
0.7660 --- loss: 1.567981, loss_ss: 0.752675, loss_d: 0.815306
0.8043 --- loss: 1.330735, loss_ss: 1.002450, loss_d: 0.328285
0.8426 --- loss: 1.109897, loss_ss: 0.764668, loss_d: 0.345229
0.8809 --- loss: 1.144783, loss_ss: 0.726220, loss_d: 0.418563
0.9192 --- loss: 1.036668, loss_ss: 0.894860, loss_d: 0.141808
0.9575 --- loss: 1.240093, loss_ss: 1.015875, loss_d: 0.224217
0.9958 --- loss: 1.074464, loss_ss: 0.877094, loss_d: 0.197370
Epoch finished! Loss: 1.2858968959457573
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.081220, loss_ss: 0.853833, loss_d: 0.227387
0.0383 --- loss: 1.505665, loss_ss: 1.081830, loss_d: 0.423835
0.0766 --- loss: 1.437708, loss_ss: 0.867245, loss_d: 0.570463
0.1149 --- loss: 1.000778, loss_ss: 0.727611, loss_d: 0.273167
0.1532 --- loss: 1.029997, loss_ss: 0.739756, loss_d: 0.290241
0.1915 --- loss: 1.193069, loss_ss: 0.999703, loss_d: 0.193365
0.2298 --- loss: 1.152152, loss_ss: 0.998495, loss_d: 0.153657
0.2681 --- loss: 1.658303, loss_ss: 1.333004, loss_d: 0.325299
0.3064 --- loss: 1.242679, loss_ss: 0.800730, loss_d: 0.441949
0.3447 --- loss: 1.296018, loss_ss: 0.912615, loss_d: 0.383403
0.3830 --- loss: 0.983086, loss_ss: 0.816422, loss_d: 0.166664
0.4213 --- loss: 1.246460, loss_ss: 0.691701, loss_d: 0.554759
0.4596 --- loss: 1.225443, loss_ss: 1.067448, loss_d: 0.157994
0.4979 --- loss: 1.136526, loss_ss: 0.775320, loss_d: 0.361206
0.5362 --- loss: 1.264207, loss_ss: 0.889919, loss_d: 0.374288
0.5745 --- loss: 1.145157, loss_ss: 0.848960, loss_d: 0.296197
0.6128 --- loss: 1.099636, loss_ss: 0.782612, loss_d: 0.317024
0.6511 --- loss: 1.192418, loss_ss: 0.912083, loss_d: 0.280335
0.6894 --- loss: 1.280819, loss_ss: 0.741767, loss_d: 0.539052
0.7277 --- loss: 1.345796, loss_ss: 0.882409, loss_d: 0.463387
0.7660 --- loss: 1.179867, loss_ss: 0.895672, loss_d: 0.284195
0.8043 --- loss: 1.862890, loss_ss: 0.905737, loss_d: 0.957153
0.8426 --- loss: 0.883293, loss_ss: 0.590537, loss_d: 0.292756
0.8809 --- loss: 1.613519, loss_ss: 0.798634, loss_d: 0.814885
0.9192 --- loss: 1.200174, loss_ss: 0.793518, loss_d: 0.406656
0.9575 --- loss: 1.455295, loss_ss: 1.260916, loss_d: 0.194379
0.9958 --- loss: 0.953075, loss_ss: 0.747002, loss_d: 0.206073
Epoch finished! Loss: 1.283571850065984
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.118127, loss_ss: 0.920187, loss_d: 0.197940
0.0383 --- loss: 1.268938, loss_ss: 0.836225, loss_d: 0.432713
0.0766 --- loss: 1.107779, loss_ss: 0.850670, loss_d: 0.257109
0.1149 --- loss: 0.967879, loss_ss: 0.720351, loss_d: 0.247528
0.1532 --- loss: 1.041107, loss_ss: 0.728598, loss_d: 0.312509
0.1915 --- loss: 1.537689, loss_ss: 0.768924, loss_d: 0.768765
0.2298 --- loss: 1.062621, loss_ss: 0.832183, loss_d: 0.230438
0.2681 --- loss: 1.410036, loss_ss: 1.144364, loss_d: 0.265672
0.3064 --- loss: 1.249077, loss_ss: 1.046943, loss_d: 0.202135
0.3447 --- loss: 0.867821, loss_ss: 0.637015, loss_d: 0.230806
0.3830 --- loss: 1.416656, loss_ss: 1.184843, loss_d: 0.231813
0.4213 --- loss: 1.311529, loss_ss: 0.887338, loss_d: 0.424191
0.4596 --- loss: 1.295907, loss_ss: 1.127694, loss_d: 0.168214
0.4979 --- loss: 1.321142, loss_ss: 1.137952, loss_d: 0.183190
0.5362 --- loss: 1.861053, loss_ss: 0.865910, loss_d: 0.995143
0.5745 --- loss: 1.029280, loss_ss: 0.771954, loss_d: 0.257326
0.6128 --- loss: 1.625776, loss_ss: 0.833511, loss_d: 0.792265
0.6511 --- loss: 1.290251, loss_ss: 0.979979, loss_d: 0.310272
0.6894 --- loss: 1.000343, loss_ss: 0.767952, loss_d: 0.232391
0.7277 --- loss: 1.284094, loss_ss: 0.960481, loss_d: 0.323613
0.7660 --- loss: 1.270418, loss_ss: 0.805696, loss_d: 0.464723
0.8043 --- loss: 1.380811, loss_ss: 1.131240, loss_d: 0.249571
0.8426 --- loss: 1.157106, loss_ss: 0.831632, loss_d: 0.325474
0.8809 --- loss: 1.229302, loss_ss: 0.840672, loss_d: 0.388630
0.9192 --- loss: 1.035625, loss_ss: 0.784371, loss_d: 0.251254
0.9575 --- loss: 1.135735, loss_ss: 0.830908, loss_d: 0.304827
0.9958 --- loss: 1.599491, loss_ss: 1.267401, loss_d: 0.332090
Epoch finished! Loss: 1.214469064926279
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.966846, loss_ss: 0.729943, loss_d: 0.236904
0.0383 --- loss: 1.139251, loss_ss: 0.916350, loss_d: 0.222900
0.0766 --- loss: 1.191541, loss_ss: 0.939353, loss_d: 0.252188
0.1149 --- loss: 0.725330, loss_ss: 0.499903, loss_d: 0.225427
0.1532 --- loss: 1.516246, loss_ss: 0.936389, loss_d: 0.579857
0.1915 --- loss: 1.121305, loss_ss: 0.772372, loss_d: 0.348933
0.2298 --- loss: 1.254548, loss_ss: 0.964136, loss_d: 0.290411
0.2681 --- loss: 1.484926, loss_ss: 0.954465, loss_d: 0.530461
0.3064 --- loss: 1.255776, loss_ss: 0.921690, loss_d: 0.334086
0.3447 --- loss: 1.238918, loss_ss: 0.834970, loss_d: 0.403947
0.3830 --- loss: 1.163110, loss_ss: 0.858385, loss_d: 0.304725
0.4213 --- loss: 0.960229, loss_ss: 0.736059, loss_d: 0.224170
0.4596 --- loss: 0.876088, loss_ss: 0.756342, loss_d: 0.119746
0.4979 --- loss: 1.172126, loss_ss: 0.768034, loss_d: 0.404092
0.5362 --- loss: 1.266689, loss_ss: 0.820352, loss_d: 0.446337
0.5745 --- loss: 1.311130, loss_ss: 0.866588, loss_d: 0.444542
0.6128 --- loss: 1.003781, loss_ss: 0.747919, loss_d: 0.255863
0.6511 --- loss: 1.193068, loss_ss: 0.842382, loss_d: 0.350686
0.6894 --- loss: 1.235301, loss_ss: 0.769544, loss_d: 0.465757
0.7277 --- loss: 1.184784, loss_ss: 0.945514, loss_d: 0.239271
0.7660 --- loss: 1.041205, loss_ss: 0.867156, loss_d: 0.174049
0.8043 --- loss: 1.209040, loss_ss: 0.779967, loss_d: 0.429073
0.8426 --- loss: 1.641329, loss_ss: 1.369355, loss_d: 0.271974
0.8809 --- loss: 1.208769, loss_ss: 0.872426, loss_d: 0.336343
0.9192 --- loss: 1.267379, loss_ss: 0.812926, loss_d: 0.454453
0.9575 --- loss: 0.855909, loss_ss: 0.619153, loss_d: 0.236756
0.9958 --- loss: 1.122520, loss_ss: 0.874410, loss_d: 0.248110
Epoch finished! Loss: 1.197958847115323
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.215256, loss_ss: 0.890536, loss_d: 0.324720
0.0383 --- loss: 1.394089, loss_ss: 1.116644, loss_d: 0.277445
0.0766 --- loss: 1.283738, loss_ss: 0.918043, loss_d: 0.365695
0.1149 --- loss: 1.353040, loss_ss: 1.174951, loss_d: 0.178089
0.1532 --- loss: 1.012734, loss_ss: 0.778393, loss_d: 0.234341
0.1915 --- loss: 0.976189, loss_ss: 0.762158, loss_d: 0.214031
0.2298 --- loss: 1.226871, loss_ss: 1.031180, loss_d: 0.195692
0.2681 --- loss: 0.871034, loss_ss: 0.584441, loss_d: 0.286592
0.3064 --- loss: 0.955537, loss_ss: 0.724082, loss_d: 0.231454
0.3447 --- loss: 1.833378, loss_ss: 0.761725, loss_d: 1.071653
0.3830 --- loss: 2.068907, loss_ss: 1.245711, loss_d: 0.823196
0.4213 --- loss: 0.972458, loss_ss: 0.867915, loss_d: 0.104543
0.4596 --- loss: 1.082202, loss_ss: 0.814770, loss_d: 0.267432
0.4979 --- loss: 1.250163, loss_ss: 1.113497, loss_d: 0.136667
0.5362 --- loss: 1.499473, loss_ss: 0.978708, loss_d: 0.520765
0.5745 --- loss: 0.776921, loss_ss: 0.545162, loss_d: 0.231759
0.6128 --- loss: 0.852524, loss_ss: 0.675958, loss_d: 0.176566
0.6511 --- loss: 1.122117, loss_ss: 0.597055, loss_d: 0.525061
0.6894 --- loss: 1.071485, loss_ss: 0.915149, loss_d: 0.156336
0.7277 --- loss: 0.839282, loss_ss: 0.683968, loss_d: 0.155314
0.7660 --- loss: 1.443982, loss_ss: 0.726368, loss_d: 0.717613
0.8043 --- loss: 1.595899, loss_ss: 0.591892, loss_d: 1.004007
0.8426 --- loss: 1.023802, loss_ss: 0.728489, loss_d: 0.295313
0.8809 --- loss: 1.406808, loss_ss: 0.912863, loss_d: 0.493945
0.9192 --- loss: 1.410523, loss_ss: 1.017434, loss_d: 0.393089
0.9575 --- loss: 1.847389, loss_ss: 1.352363, loss_d: 0.495026
0.9958 --- loss: 1.001815, loss_ss: 0.825967, loss_d: 0.175847
Epoch finished! Loss: 1.1738212405493433
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5901234567901235
             precision    recall  f1-score   support

        0.0       0.95      0.39      0.55       158
        1.0       0.50      0.02      0.04       103
        2.0       0.59      0.80      0.68       306
        3.0       1.00      0.74      0.85       133
        4.0       0.32      0.66      0.43       110

avg / total       0.68      0.59      0.57       810
 


====== chc006-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  87.65  38.61   99.54   95.31     54.95
1  87.28   1.94   99.72   50.00      3.74
2  71.36  79.74   66.27   58.94     67.78
3  95.68  73.68  100.00  100.00     84.85
4  76.05  66.36   77.57   31.74     42.94
Total accuracy: 59.01%
Average sen: 52.07%
Average spec: 88.62%
Macro f1-score: 50.85%
Diagnosis acc on 15mins: 0.037037037037037035
[0.98569053 0.99479043 0.9946419  0.97461444 0.99581546 0.81563437
 0.51362705 0.94567329 0.90925586 0.99322164 0.98445904 0.94219184
 0.8645702  0.93562645 0.84018701 0.98597348 0.58518696 0.4759267
 0.54840481 0.92972761 0.75149471 0.97202569 0.95646864 0.58333999
 0.96979642 0.85338128 0.90365231]
pred: 0.859458448710265, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc008-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.255539, loss_ss: 1.587299, loss_d: 0.668241
0.0384 --- loss: 2.099423, loss_ss: 1.470059, loss_d: 0.629365
0.0767 --- loss: 1.968557, loss_ss: 1.500992, loss_d: 0.467564
0.1151 --- loss: 2.047924, loss_ss: 1.442939, loss_d: 0.604985
0.1535 --- loss: 1.995292, loss_ss: 1.351898, loss_d: 0.643394
0.1919 --- loss: 1.961038, loss_ss: 1.365649, loss_d: 0.595389
0.2302 --- loss: 1.862234, loss_ss: 1.467425, loss_d: 0.394809
0.2686 --- loss: 2.065606, loss_ss: 1.488123, loss_d: 0.577483
0.3070 --- loss: 1.703169, loss_ss: 1.184221, loss_d: 0.518948
0.3454 --- loss: 1.557445, loss_ss: 1.131293, loss_d: 0.426152
0.3837 --- loss: 1.434467, loss_ss: 1.221079, loss_d: 0.213388
0.4221 --- loss: 1.658287, loss_ss: 1.060021, loss_d: 0.598266
0.4605 --- loss: 1.862777, loss_ss: 1.302952, loss_d: 0.559825
0.4988 --- loss: 1.833885, loss_ss: 1.154838, loss_d: 0.679048
0.5372 --- loss: 1.883115, loss_ss: 1.339438, loss_d: 0.543677
0.5756 --- loss: 2.058730, loss_ss: 1.360097, loss_d: 0.698633
0.6140 --- loss: 1.955525, loss_ss: 1.357638, loss_d: 0.597887
0.6523 --- loss: 1.825693, loss_ss: 1.447392, loss_d: 0.378301
0.6907 --- loss: 2.014575, loss_ss: 1.346307, loss_d: 0.668268
0.7291 --- loss: 1.836569, loss_ss: 1.211999, loss_d: 0.624570
0.7675 --- loss: 2.056262, loss_ss: 1.192952, loss_d: 0.863310
0.8058 --- loss: 1.641474, loss_ss: 1.331719, loss_d: 0.309755
0.8442 --- loss: 1.590428, loss_ss: 1.217953, loss_d: 0.372475
0.8826 --- loss: 1.771632, loss_ss: 1.068674, loss_d: 0.702959
0.9210 --- loss: 1.840339, loss_ss: 1.175022, loss_d: 0.665317
0.9593 --- loss: 1.917300, loss_ss: 1.211437, loss_d: 0.705864
0.9977 --- loss: 1.647239, loss_ss: 1.165403, loss_d: 0.481836
Epoch finished! Loss: 1.898823908659128
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.989246, loss_ss: 1.212637, loss_d: 0.776609
0.0384 --- loss: 1.858218, loss_ss: 1.381132, loss_d: 0.477086
0.0767 --- loss: 1.720831, loss_ss: 1.202453, loss_d: 0.518377
0.1151 --- loss: 1.612753, loss_ss: 1.160867, loss_d: 0.451886
0.1535 --- loss: 2.254504, loss_ss: 1.525689, loss_d: 0.728815
0.1919 --- loss: 1.467742, loss_ss: 0.876906, loss_d: 0.590836
0.2302 --- loss: 1.756139, loss_ss: 1.208595, loss_d: 0.547543
0.2686 --- loss: 1.582900, loss_ss: 1.203534, loss_d: 0.379366
0.3070 --- loss: 1.703451, loss_ss: 0.983444, loss_d: 0.720007
0.3454 --- loss: 1.832275, loss_ss: 1.198019, loss_d: 0.634257
0.3837 --- loss: 1.484618, loss_ss: 0.911054, loss_d: 0.573564
0.4221 --- loss: 2.260628, loss_ss: 1.320614, loss_d: 0.940014
0.4605 --- loss: 2.054832, loss_ss: 1.207651, loss_d: 0.847181
0.4988 --- loss: 1.462249, loss_ss: 1.033079, loss_d: 0.429170
0.5372 --- loss: 1.619966, loss_ss: 1.032488, loss_d: 0.587477
0.5756 --- loss: 1.631672, loss_ss: 1.096521, loss_d: 0.535151
0.6140 --- loss: 2.196378, loss_ss: 1.533235, loss_d: 0.663143
0.6523 --- loss: 1.490694, loss_ss: 1.125256, loss_d: 0.365438
0.6907 --- loss: 1.774249, loss_ss: 1.177323, loss_d: 0.596926
0.7291 --- loss: 1.875865, loss_ss: 1.420535, loss_d: 0.455330
0.7675 --- loss: 1.932022, loss_ss: 1.482989, loss_d: 0.449033
0.8058 --- loss: 1.527982, loss_ss: 1.219724, loss_d: 0.308258
0.8442 --- loss: 1.413813, loss_ss: 0.922219, loss_d: 0.491594
0.8826 --- loss: 1.634607, loss_ss: 1.216669, loss_d: 0.417938
0.9210 --- loss: 1.517447, loss_ss: 0.906547, loss_d: 0.610900
0.9593 --- loss: 1.229447, loss_ss: 0.924482, loss_d: 0.304965
0.9977 --- loss: 1.753505, loss_ss: 1.286692, loss_d: 0.466813
Epoch finished! Loss: 1.7013798016768236
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.528517, loss_ss: 1.159682, loss_d: 0.368835
0.0384 --- loss: 2.072793, loss_ss: 1.496372, loss_d: 0.576421
0.0767 --- loss: 1.821327, loss_ss: 1.217749, loss_d: 0.603579
0.1151 --- loss: 1.578381, loss_ss: 0.937433, loss_d: 0.640948
0.1535 --- loss: 1.563269, loss_ss: 0.917238, loss_d: 0.646031
0.1919 --- loss: 1.465079, loss_ss: 0.800431, loss_d: 0.664648
0.2302 --- loss: 2.139422, loss_ss: 1.251811, loss_d: 0.887611
0.2686 --- loss: 1.432444, loss_ss: 0.817044, loss_d: 0.615400
0.3070 --- loss: 1.153330, loss_ss: 0.850150, loss_d: 0.303179
0.3454 --- loss: 1.371393, loss_ss: 1.022153, loss_d: 0.349240
0.3837 --- loss: 1.233426, loss_ss: 0.759930, loss_d: 0.473496
0.4221 --- loss: 1.475289, loss_ss: 1.047235, loss_d: 0.428054
0.4605 --- loss: 1.824876, loss_ss: 1.245181, loss_d: 0.579694
0.4988 --- loss: 1.534001, loss_ss: 1.108392, loss_d: 0.425609
0.5372 --- loss: 1.272584, loss_ss: 0.866194, loss_d: 0.406390
0.5756 --- loss: 1.571542, loss_ss: 0.957966, loss_d: 0.613576
0.6140 --- loss: 1.328171, loss_ss: 0.866273, loss_d: 0.461898
0.6523 --- loss: 1.422181, loss_ss: 0.869699, loss_d: 0.552483
0.6907 --- loss: 1.498008, loss_ss: 1.033002, loss_d: 0.465006
0.7291 --- loss: 1.691942, loss_ss: 1.239931, loss_d: 0.452011
0.7675 --- loss: 1.560934, loss_ss: 0.933617, loss_d: 0.627317
0.8058 --- loss: 1.807061, loss_ss: 1.027073, loss_d: 0.779988
0.8442 --- loss: 1.396967, loss_ss: 1.039887, loss_d: 0.357081
0.8826 --- loss: 1.496644, loss_ss: 1.023522, loss_d: 0.473122
0.9210 --- loss: 1.589012, loss_ss: 1.056493, loss_d: 0.532519
0.9593 --- loss: 1.705739, loss_ss: 1.046585, loss_d: 0.659155
0.9977 --- loss: 1.510471, loss_ss: 0.907927, loss_d: 0.602544
Epoch finished! Loss: 1.5858979426897488
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.501899, loss_ss: 1.088491, loss_d: 0.413409
0.0384 --- loss: 1.441657, loss_ss: 0.959701, loss_d: 0.481956
0.0767 --- loss: 1.252075, loss_ss: 0.804044, loss_d: 0.448030
0.1151 --- loss: 1.667781, loss_ss: 1.058127, loss_d: 0.609653
0.1535 --- loss: 1.802698, loss_ss: 1.032218, loss_d: 0.770480
0.1919 --- loss: 1.727078, loss_ss: 1.146541, loss_d: 0.580537
0.2302 --- loss: 1.496434, loss_ss: 0.975876, loss_d: 0.520558
0.2686 --- loss: 1.535683, loss_ss: 0.961124, loss_d: 0.574559
0.3070 --- loss: 1.643788, loss_ss: 1.318658, loss_d: 0.325130
0.3454 --- loss: 1.357447, loss_ss: 0.952551, loss_d: 0.404896
0.3837 --- loss: 2.037530, loss_ss: 1.018992, loss_d: 1.018539
0.4221 --- loss: 1.145547, loss_ss: 0.775749, loss_d: 0.369798
0.4605 --- loss: 1.373154, loss_ss: 0.896351, loss_d: 0.476803
0.4988 --- loss: 1.616479, loss_ss: 1.114940, loss_d: 0.501539
0.5372 --- loss: 1.338369, loss_ss: 1.010351, loss_d: 0.328017
0.5756 --- loss: 1.431877, loss_ss: 1.105844, loss_d: 0.326032
0.6140 --- loss: 1.246748, loss_ss: 1.021890, loss_d: 0.224859
0.6523 --- loss: 1.315522, loss_ss: 0.888102, loss_d: 0.427420
0.6907 --- loss: 1.317054, loss_ss: 0.793712, loss_d: 0.523342
0.7291 --- loss: 1.440315, loss_ss: 0.902375, loss_d: 0.537940
0.7675 --- loss: 1.628291, loss_ss: 0.913378, loss_d: 0.714912
0.8058 --- loss: 1.643221, loss_ss: 1.217106, loss_d: 0.426115
0.8442 --- loss: 1.397032, loss_ss: 0.859920, loss_d: 0.537113
0.8826 --- loss: 1.355181, loss_ss: 0.986594, loss_d: 0.368587
0.9210 --- loss: 1.431961, loss_ss: 0.846823, loss_d: 0.585138
0.9593 --- loss: 1.204086, loss_ss: 0.921570, loss_d: 0.282516
0.9977 --- loss: 1.794892, loss_ss: 1.114302, loss_d: 0.680590
Epoch finished! Loss: 1.4891515291654147
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.238649, loss_ss: 0.954639, loss_d: 0.284010
0.0384 --- loss: 1.617873, loss_ss: 0.816686, loss_d: 0.801187
0.0767 --- loss: 1.180996, loss_ss: 0.945032, loss_d: 0.235964
0.1151 --- loss: 1.190141, loss_ss: 0.869915, loss_d: 0.320225
0.1535 --- loss: 1.616024, loss_ss: 1.406309, loss_d: 0.209715
0.1919 --- loss: 1.135277, loss_ss: 0.639215, loss_d: 0.496062
0.2302 --- loss: 1.635075, loss_ss: 1.058206, loss_d: 0.576869
0.2686 --- loss: 1.726838, loss_ss: 0.832797, loss_d: 0.894041
0.3070 --- loss: 1.056338, loss_ss: 0.803224, loss_d: 0.253114
0.3454 --- loss: 1.562753, loss_ss: 1.158759, loss_d: 0.403994
0.3837 --- loss: 1.202795, loss_ss: 0.805742, loss_d: 0.397054
0.4221 --- loss: 1.317264, loss_ss: 0.905389, loss_d: 0.411875
0.4605 --- loss: 1.477285, loss_ss: 1.203972, loss_d: 0.273313
0.4988 --- loss: 1.781694, loss_ss: 1.108808, loss_d: 0.672886
0.5372 --- loss: 1.671894, loss_ss: 0.974164, loss_d: 0.697730
0.5756 --- loss: 1.725125, loss_ss: 1.141879, loss_d: 0.583246
0.6140 --- loss: 1.327861, loss_ss: 0.733173, loss_d: 0.594688
0.6523 --- loss: 1.286059, loss_ss: 0.725999, loss_d: 0.560061
0.6907 --- loss: 1.488325, loss_ss: 1.224087, loss_d: 0.264238
0.7291 --- loss: 1.486124, loss_ss: 0.937714, loss_d: 0.548410
0.7675 --- loss: 1.211251, loss_ss: 0.932951, loss_d: 0.278299
0.8058 --- loss: 1.227305, loss_ss: 0.776892, loss_d: 0.450414
0.8442 --- loss: 1.135731, loss_ss: 0.810084, loss_d: 0.325646
0.8826 --- loss: 1.914097, loss_ss: 1.108349, loss_d: 0.805748
0.9210 --- loss: 0.978774, loss_ss: 0.692388, loss_d: 0.286386
0.9593 --- loss: 1.648066, loss_ss: 0.759502, loss_d: 0.888563
0.9977 --- loss: 1.655850, loss_ss: 0.729229, loss_d: 0.926621
Epoch finished! Loss: 1.3720244458088509
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.252206, loss_ss: 0.696545, loss_d: 0.555661
0.0384 --- loss: 1.315641, loss_ss: 0.875823, loss_d: 0.439818
0.0767 --- loss: 1.199122, loss_ss: 0.960220, loss_d: 0.238902
0.1151 --- loss: 1.513216, loss_ss: 0.715801, loss_d: 0.797414
0.1535 --- loss: 1.270125, loss_ss: 0.967073, loss_d: 0.303051
0.1919 --- loss: 1.000450, loss_ss: 0.775383, loss_d: 0.225066
0.2302 --- loss: 0.851203, loss_ss: 0.711850, loss_d: 0.139353
0.2686 --- loss: 1.238177, loss_ss: 0.772084, loss_d: 0.466093
0.3070 --- loss: 1.310612, loss_ss: 0.833284, loss_d: 0.477328
0.3454 --- loss: 1.295874, loss_ss: 0.869998, loss_d: 0.425876
0.3837 --- loss: 1.180454, loss_ss: 0.790608, loss_d: 0.389846
0.4221 --- loss: 1.219193, loss_ss: 0.639649, loss_d: 0.579544
0.4605 --- loss: 1.203465, loss_ss: 0.715089, loss_d: 0.488376
0.4988 --- loss: 1.563435, loss_ss: 0.999156, loss_d: 0.564279
0.5372 --- loss: 1.206320, loss_ss: 0.870406, loss_d: 0.335914
0.5756 --- loss: 1.080195, loss_ss: 0.629525, loss_d: 0.450670
0.6140 --- loss: 1.449135, loss_ss: 0.991043, loss_d: 0.458092
0.6523 --- loss: 0.907520, loss_ss: 0.638641, loss_d: 0.268880
0.6907 --- loss: 1.900837, loss_ss: 1.211323, loss_d: 0.689515
0.7291 --- loss: 1.421375, loss_ss: 0.658448, loss_d: 0.762927
0.7675 --- loss: 1.186230, loss_ss: 0.775504, loss_d: 0.410726
0.8058 --- loss: 1.097016, loss_ss: 0.715951, loss_d: 0.381065
0.8442 --- loss: 1.780669, loss_ss: 1.228979, loss_d: 0.551690
0.8826 --- loss: 1.121042, loss_ss: 0.930576, loss_d: 0.190467
0.9210 --- loss: 1.089039, loss_ss: 0.859650, loss_d: 0.229389
0.9593 --- loss: 1.391697, loss_ss: 0.950443, loss_d: 0.441254
0.9977 --- loss: 1.647629, loss_ss: 0.897744, loss_d: 0.749885
Epoch finished! Loss: 1.3136014184126488
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.400259, loss_ss: 0.781940, loss_d: 0.618319
0.0384 --- loss: 1.349664, loss_ss: 0.822506, loss_d: 0.527158
0.0767 --- loss: 0.858824, loss_ss: 0.569345, loss_d: 0.289480
0.1151 --- loss: 1.163117, loss_ss: 0.965366, loss_d: 0.197751
0.1535 --- loss: 1.221670, loss_ss: 0.948467, loss_d: 0.273202
0.1919 --- loss: 1.455523, loss_ss: 0.612465, loss_d: 0.843059
0.2302 --- loss: 1.776624, loss_ss: 1.277785, loss_d: 0.498839
0.2686 --- loss: 1.144251, loss_ss: 0.826929, loss_d: 0.317322
0.3070 --- loss: 1.148389, loss_ss: 0.913229, loss_d: 0.235160
0.3454 --- loss: 1.516886, loss_ss: 1.141443, loss_d: 0.375442
0.3837 --- loss: 0.979305, loss_ss: 0.860092, loss_d: 0.119213
0.4221 --- loss: 1.139499, loss_ss: 1.029292, loss_d: 0.110207
0.4605 --- loss: 1.439501, loss_ss: 0.976028, loss_d: 0.463474
0.4988 --- loss: 1.198551, loss_ss: 0.850001, loss_d: 0.348550
0.5372 --- loss: 1.616987, loss_ss: 1.162121, loss_d: 0.454866
0.5756 --- loss: 1.340025, loss_ss: 0.857503, loss_d: 0.482521
0.6140 --- loss: 0.884559, loss_ss: 0.710722, loss_d: 0.173838
0.6523 --- loss: 1.126341, loss_ss: 0.899160, loss_d: 0.227180
0.6907 --- loss: 1.148247, loss_ss: 0.765951, loss_d: 0.382296
0.7291 --- loss: 1.333736, loss_ss: 1.075323, loss_d: 0.258414
0.7675 --- loss: 1.020506, loss_ss: 0.731623, loss_d: 0.288883
0.8058 --- loss: 0.966857, loss_ss: 0.741813, loss_d: 0.225044
0.8442 --- loss: 1.209049, loss_ss: 0.985953, loss_d: 0.223097
0.8826 --- loss: 0.903691, loss_ss: 0.714570, loss_d: 0.189121
0.9210 --- loss: 1.473364, loss_ss: 1.065906, loss_d: 0.407458
0.9593 --- loss: 1.496846, loss_ss: 0.892486, loss_d: 0.604360
0.9977 --- loss: 1.306077, loss_ss: 1.160034, loss_d: 0.146043
Epoch finished! Loss: 1.2297296281044299
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.003484, loss_ss: 0.741436, loss_d: 0.262048
0.0384 --- loss: 1.487657, loss_ss: 1.005637, loss_d: 0.482020
0.0767 --- loss: 1.268896, loss_ss: 0.805677, loss_d: 0.463219
0.1151 --- loss: 1.240107, loss_ss: 0.650948, loss_d: 0.589159
0.1535 --- loss: 0.985690, loss_ss: 0.631331, loss_d: 0.354360
0.1919 --- loss: 0.983619, loss_ss: 0.738946, loss_d: 0.244673
0.2302 --- loss: 0.937242, loss_ss: 0.723014, loss_d: 0.214228
0.2686 --- loss: 1.579992, loss_ss: 1.356115, loss_d: 0.223877
0.3070 --- loss: 1.516569, loss_ss: 1.112367, loss_d: 0.404202
0.3454 --- loss: 1.180018, loss_ss: 0.812156, loss_d: 0.367862
0.3837 --- loss: 1.543703, loss_ss: 0.998779, loss_d: 0.544924
0.4221 --- loss: 1.218603, loss_ss: 0.677073, loss_d: 0.541531
0.4605 --- loss: 0.960249, loss_ss: 0.762694, loss_d: 0.197556
0.4988 --- loss: 2.149763, loss_ss: 0.987261, loss_d: 1.162502
0.5372 --- loss: 1.127782, loss_ss: 0.727794, loss_d: 0.399988
0.5756 --- loss: 1.287018, loss_ss: 0.837927, loss_d: 0.449091
0.6140 --- loss: 1.399220, loss_ss: 1.149495, loss_d: 0.249724
0.6523 --- loss: 1.116036, loss_ss: 0.929195, loss_d: 0.186841
0.6907 --- loss: 1.177652, loss_ss: 0.929404, loss_d: 0.248249
0.7291 --- loss: 0.967396, loss_ss: 0.788444, loss_d: 0.178951
0.7675 --- loss: 1.696174, loss_ss: 1.434557, loss_d: 0.261617
0.8058 --- loss: 1.288802, loss_ss: 1.004613, loss_d: 0.284188
0.8442 --- loss: 1.299348, loss_ss: 1.074368, loss_d: 0.224980
0.8826 --- loss: 1.541409, loss_ss: 0.980880, loss_d: 0.560529
0.9210 --- loss: 1.638128, loss_ss: 1.011766, loss_d: 0.626362
0.9593 --- loss: 1.285301, loss_ss: 0.999419, loss_d: 0.285882
0.9977 --- loss: 0.779598, loss_ss: 0.672072, loss_d: 0.107527
Epoch finished! Loss: 1.2058287574694706
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.955014, loss_ss: 0.792919, loss_d: 0.162095
0.0384 --- loss: 0.834483, loss_ss: 0.663738, loss_d: 0.170746
0.0767 --- loss: 1.078635, loss_ss: 0.888314, loss_d: 0.190321
0.1151 --- loss: 0.940855, loss_ss: 0.825148, loss_d: 0.115707
0.1535 --- loss: 1.133963, loss_ss: 0.994488, loss_d: 0.139475
0.1919 --- loss: 1.232058, loss_ss: 0.880758, loss_d: 0.351300
0.2302 --- loss: 0.842205, loss_ss: 0.735607, loss_d: 0.106598
0.2686 --- loss: 1.160589, loss_ss: 0.991795, loss_d: 0.168794
0.3070 --- loss: 0.879232, loss_ss: 0.747731, loss_d: 0.131501
0.3454 --- loss: 0.972406, loss_ss: 0.615538, loss_d: 0.356867
0.3837 --- loss: 1.410809, loss_ss: 0.983811, loss_d: 0.426997
0.4221 --- loss: 1.020360, loss_ss: 0.740950, loss_d: 0.279411
0.4605 --- loss: 1.678731, loss_ss: 1.403311, loss_d: 0.275420
0.4988 --- loss: 1.504647, loss_ss: 0.861046, loss_d: 0.643601
0.5372 --- loss: 0.951707, loss_ss: 0.646460, loss_d: 0.305247
0.5756 --- loss: 1.001450, loss_ss: 0.889553, loss_d: 0.111898
0.6140 --- loss: 1.331087, loss_ss: 1.023909, loss_d: 0.307177
0.6523 --- loss: 0.751551, loss_ss: 0.666403, loss_d: 0.085148
0.6907 --- loss: 1.249109, loss_ss: 1.087770, loss_d: 0.161339
0.7291 --- loss: 1.437320, loss_ss: 1.232359, loss_d: 0.204961
0.7675 --- loss: 1.307546, loss_ss: 1.017093, loss_d: 0.290453
0.8058 --- loss: 1.344873, loss_ss: 0.795281, loss_d: 0.549592
0.8442 --- loss: 1.335022, loss_ss: 0.952825, loss_d: 0.382196
0.8826 --- loss: 1.387793, loss_ss: 0.965333, loss_d: 0.422460
0.9210 --- loss: 1.535945, loss_ss: 1.040600, loss_d: 0.495345
0.9593 --- loss: 1.246220, loss_ss: 0.838449, loss_d: 0.407771
0.9977 --- loss: 1.145012, loss_ss: 0.866256, loss_d: 0.278756
Epoch finished! Loss: 1.1715172783686565
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.863968, loss_ss: 0.782606, loss_d: 0.081363
0.0384 --- loss: 0.890579, loss_ss: 0.764788, loss_d: 0.125791
0.0767 --- loss: 1.058120, loss_ss: 0.834504, loss_d: 0.223616
0.1151 --- loss: 0.675698, loss_ss: 0.596490, loss_d: 0.079208
0.1535 --- loss: 0.972029, loss_ss: 0.905782, loss_d: 0.066247
0.1919 --- loss: 1.157210, loss_ss: 0.821295, loss_d: 0.335915
0.2302 --- loss: 1.172244, loss_ss: 0.913429, loss_d: 0.258816
0.2686 --- loss: 0.880785, loss_ss: 0.793092, loss_d: 0.087692
0.3070 --- loss: 0.994563, loss_ss: 0.799068, loss_d: 0.195495
0.3454 --- loss: 1.378888, loss_ss: 0.996685, loss_d: 0.382203
0.3837 --- loss: 0.960366, loss_ss: 0.850576, loss_d: 0.109790
0.4221 --- loss: 1.430095, loss_ss: 0.580787, loss_d: 0.849307
0.4605 --- loss: 0.849389, loss_ss: 0.765795, loss_d: 0.083594
0.4988 --- loss: 1.069363, loss_ss: 0.928695, loss_d: 0.140668
0.5372 --- loss: 1.005957, loss_ss: 0.732361, loss_d: 0.273596
0.5756 --- loss: 0.723549, loss_ss: 0.557959, loss_d: 0.165590
0.6140 --- loss: 1.160402, loss_ss: 0.991289, loss_d: 0.169113
0.6523 --- loss: 1.458626, loss_ss: 1.263604, loss_d: 0.195023
0.6907 --- loss: 0.955792, loss_ss: 0.824886, loss_d: 0.130906
0.7291 --- loss: 1.111868, loss_ss: 0.914518, loss_d: 0.197351
0.7675 --- loss: 1.125470, loss_ss: 0.965807, loss_d: 0.159664
0.8058 --- loss: 1.182082, loss_ss: 1.057388, loss_d: 0.124693
0.8442 --- loss: 1.296967, loss_ss: 1.050182, loss_d: 0.246785
0.8826 --- loss: 1.051476, loss_ss: 0.928273, loss_d: 0.123203
0.9210 --- loss: 1.122813, loss_ss: 1.003576, loss_d: 0.119237
0.9593 --- loss: 1.276386, loss_ss: 0.826584, loss_d: 0.449802
0.9977 --- loss: 1.318935, loss_ss: 0.616468, loss_d: 0.702467
Epoch finished! Loss: 1.129648706316948
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6197916666666666
             precision    recall  f1-score   support

        0.0       0.52      0.90      0.66       144
        1.0       0.52      0.37      0.43        82
        2.0       0.64      0.75      0.70       379
        3.0       1.00      0.41      0.59       227
        4.0       0.49      0.44      0.46       128

avg / total       0.68      0.62      0.61       960
 


====== chc008-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.94  89.58   85.29   51.81     65.65
1  91.67  36.59   96.81   51.72     42.86
2  73.85  75.46   72.81   64.41     69.50
3  86.15  41.41  100.00  100.00     58.57
4  86.35  43.75   92.91   48.70     46.09
Total accuracy: 61.98%
Average sen: 57.36%
Average spec: 89.56%
Macro f1-score: 56.53%
Diagnosis acc on 15mins: 0.96875
[7.40805343e-02 5.91660179e-02 4.40048464e-02 1.16298616e-01
 2.16606095e-01 1.64029688e-01 3.49349044e-02 1.03396527e-01
 9.48422998e-02 1.54888481e-01 7.90879354e-02 4.91805114e-02
 3.04373980e-01 6.94217682e-01 2.56661415e-01 1.71288073e-01
 8.83937404e-02 5.61672933e-02 3.18421163e-02 2.44225375e-02
 1.15089733e-02 8.97289068e-03 9.36472416e-03 2.45280594e-01
 6.01751730e-02 5.18979989e-02 9.55997314e-03 2.59506386e-02
 7.72473812e-02 2.25152704e-03 3.74887110e-04 1.21053224e-02]
pred: 0.10414291803954256, label: 0
Right! Diagnosis: Other

=== Test on chc009-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.378954, loss_ss: 1.657773, loss_d: 0.721180
0.0383 --- loss: 2.560109, loss_ss: 1.661544, loss_d: 0.898565
0.0767 --- loss: 2.299219, loss_ss: 1.602616, loss_d: 0.696602
0.1150 --- loss: 2.220656, loss_ss: 1.537350, loss_d: 0.683306
0.1533 --- loss: 2.164876, loss_ss: 1.537309, loss_d: 0.627567
0.1916 --- loss: 2.001614, loss_ss: 1.408542, loss_d: 0.593073
0.2300 --- loss: 2.002620, loss_ss: 1.425618, loss_d: 0.577002
0.2683 --- loss: 1.953849, loss_ss: 1.467443, loss_d: 0.486406
0.3066 --- loss: 2.054883, loss_ss: 1.468456, loss_d: 0.586427
0.3450 --- loss: 2.119017, loss_ss: 1.388986, loss_d: 0.730031
0.3833 --- loss: 1.962819, loss_ss: 1.524959, loss_d: 0.437860
0.4216 --- loss: 1.935058, loss_ss: 1.331596, loss_d: 0.603462
0.4599 --- loss: 1.867974, loss_ss: 1.369131, loss_d: 0.498843
0.4983 --- loss: 1.923631, loss_ss: 1.374946, loss_d: 0.548685
0.5366 --- loss: 2.136286, loss_ss: 1.327238, loss_d: 0.809048
0.5749 --- loss: 2.031522, loss_ss: 1.418807, loss_d: 0.612714
0.6133 --- loss: 1.797754, loss_ss: 1.306336, loss_d: 0.491418
0.6516 --- loss: 1.943967, loss_ss: 1.221306, loss_d: 0.722661
0.6899 --- loss: 1.868979, loss_ss: 1.357682, loss_d: 0.511297
0.7282 --- loss: 2.095817, loss_ss: 1.382752, loss_d: 0.713065
0.7666 --- loss: 1.802776, loss_ss: 1.205306, loss_d: 0.597471
0.8049 --- loss: 1.936080, loss_ss: 1.472235, loss_d: 0.463844
0.8432 --- loss: 1.786811, loss_ss: 1.306007, loss_d: 0.480804
0.8816 --- loss: 1.722891, loss_ss: 1.181590, loss_d: 0.541301
0.9199 --- loss: 1.895424, loss_ss: 1.208528, loss_d: 0.686896
0.9582 --- loss: 2.021189, loss_ss: 1.242158, loss_d: 0.779031
0.9966 --- loss: 1.739992, loss_ss: 1.191094, loss_d: 0.548898
Epoch finished! Loss: 2.0008058914771447
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.709113, loss_ss: 1.272492, loss_d: 0.436621
0.0383 --- loss: 1.622816, loss_ss: 1.113564, loss_d: 0.509252
0.0767 --- loss: 1.698135, loss_ss: 1.269054, loss_d: 0.429082
0.1150 --- loss: 1.713958, loss_ss: 1.132446, loss_d: 0.581512
0.1533 --- loss: 1.471364, loss_ss: 1.075386, loss_d: 0.395978
0.1916 --- loss: 1.742927, loss_ss: 1.043736, loss_d: 0.699191
0.2300 --- loss: 1.927464, loss_ss: 1.221968, loss_d: 0.705496
0.2683 --- loss: 1.940581, loss_ss: 1.357596, loss_d: 0.582985
0.3066 --- loss: 1.811338, loss_ss: 1.337460, loss_d: 0.473878
0.3450 --- loss: 1.920490, loss_ss: 1.471969, loss_d: 0.448521
0.3833 --- loss: 1.919720, loss_ss: 1.139823, loss_d: 0.779897
0.4216 --- loss: 1.848019, loss_ss: 1.322845, loss_d: 0.525174
0.4599 --- loss: 1.787762, loss_ss: 1.283714, loss_d: 0.504048
0.4983 --- loss: 1.773447, loss_ss: 1.288689, loss_d: 0.484758
0.5366 --- loss: 1.638448, loss_ss: 1.051399, loss_d: 0.587049
0.5749 --- loss: 1.864276, loss_ss: 1.258894, loss_d: 0.605382
0.6133 --- loss: 1.609367, loss_ss: 1.093656, loss_d: 0.515710
0.6516 --- loss: 1.537984, loss_ss: 1.047829, loss_d: 0.490155
0.6899 --- loss: 1.397771, loss_ss: 1.066684, loss_d: 0.331087
0.7282 --- loss: 1.720606, loss_ss: 1.230681, loss_d: 0.489925
0.7666 --- loss: 1.602019, loss_ss: 1.116220, loss_d: 0.485799
0.8049 --- loss: 1.559372, loss_ss: 1.135478, loss_d: 0.423894
0.8432 --- loss: 1.563147, loss_ss: 1.056182, loss_d: 0.506966
0.8816 --- loss: 1.697550, loss_ss: 1.047288, loss_d: 0.650262
0.9199 --- loss: 1.744088, loss_ss: 1.146386, loss_d: 0.597702
0.9582 --- loss: 1.971174, loss_ss: 1.358879, loss_d: 0.612295
0.9966 --- loss: 1.569957, loss_ss: 0.950791, loss_d: 0.619166
Epoch finished! Loss: 1.754410214149035
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.708905, loss_ss: 1.169474, loss_d: 0.539431
0.0383 --- loss: 1.698328, loss_ss: 1.151618, loss_d: 0.546710
0.0767 --- loss: 1.431294, loss_ss: 1.173604, loss_d: 0.257690
0.1150 --- loss: 1.841684, loss_ss: 1.112217, loss_d: 0.729466
0.1533 --- loss: 1.477886, loss_ss: 0.935038, loss_d: 0.542848
0.1916 --- loss: 1.757578, loss_ss: 1.165963, loss_d: 0.591615
0.2300 --- loss: 1.888403, loss_ss: 1.355172, loss_d: 0.533231
0.2683 --- loss: 1.580793, loss_ss: 0.947768, loss_d: 0.633025
0.3066 --- loss: 1.584808, loss_ss: 1.013682, loss_d: 0.571126
0.3450 --- loss: 1.449623, loss_ss: 1.040465, loss_d: 0.409159
0.3833 --- loss: 1.679796, loss_ss: 1.250760, loss_d: 0.429036
0.4216 --- loss: 1.400475, loss_ss: 0.985334, loss_d: 0.415141
0.4599 --- loss: 1.491055, loss_ss: 0.993244, loss_d: 0.497811
0.4983 --- loss: 1.801885, loss_ss: 1.143613, loss_d: 0.658272
0.5366 --- loss: 1.217427, loss_ss: 0.725788, loss_d: 0.491639
0.5749 --- loss: 1.499884, loss_ss: 0.946284, loss_d: 0.553600
0.6133 --- loss: 1.604797, loss_ss: 1.004333, loss_d: 0.600465
0.6516 --- loss: 2.022234, loss_ss: 1.083434, loss_d: 0.938800
0.6899 --- loss: 1.552471, loss_ss: 1.075876, loss_d: 0.476595
0.7282 --- loss: 1.493383, loss_ss: 0.824870, loss_d: 0.668513
0.7666 --- loss: 1.698454, loss_ss: 1.152642, loss_d: 0.545812
0.8049 --- loss: 1.961492, loss_ss: 1.398917, loss_d: 0.562574
0.8432 --- loss: 1.575450, loss_ss: 1.095341, loss_d: 0.480109
0.8816 --- loss: 1.504344, loss_ss: 0.880265, loss_d: 0.624078
0.9199 --- loss: 1.508976, loss_ss: 1.043323, loss_d: 0.465653
0.9582 --- loss: 1.725650, loss_ss: 0.941971, loss_d: 0.783680
0.9966 --- loss: 1.547164, loss_ss: 1.159130, loss_d: 0.388033
Epoch finished! Loss: 1.6219611942768097
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.536797, loss_ss: 0.950984, loss_d: 0.585813
0.0383 --- loss: 1.940955, loss_ss: 1.348698, loss_d: 0.592258
0.0767 --- loss: 1.496528, loss_ss: 1.079427, loss_d: 0.417101
0.1150 --- loss: 1.684618, loss_ss: 0.917621, loss_d: 0.766997
0.1533 --- loss: 1.324207, loss_ss: 0.798210, loss_d: 0.525997
0.1916 --- loss: 1.852228, loss_ss: 0.967223, loss_d: 0.885005
0.2300 --- loss: 1.623094, loss_ss: 0.958321, loss_d: 0.664773
0.2683 --- loss: 1.128199, loss_ss: 0.860968, loss_d: 0.267230
0.3066 --- loss: 1.790439, loss_ss: 1.131652, loss_d: 0.658787
0.3450 --- loss: 1.823068, loss_ss: 0.918729, loss_d: 0.904339
0.3833 --- loss: 1.673971, loss_ss: 1.065188, loss_d: 0.608782
0.4216 --- loss: 1.410507, loss_ss: 0.971673, loss_d: 0.438834
0.4599 --- loss: 1.324000, loss_ss: 1.080152, loss_d: 0.243848
0.4983 --- loss: 1.376973, loss_ss: 0.867360, loss_d: 0.509613
0.5366 --- loss: 1.579415, loss_ss: 0.921155, loss_d: 0.658259
0.5749 --- loss: 1.487330, loss_ss: 1.071490, loss_d: 0.415840
0.6133 --- loss: 1.540633, loss_ss: 0.981197, loss_d: 0.559437
0.6516 --- loss: 1.968238, loss_ss: 1.380133, loss_d: 0.588104
0.6899 --- loss: 1.180741, loss_ss: 0.772102, loss_d: 0.408638
0.7282 --- loss: 1.578750, loss_ss: 1.104018, loss_d: 0.474731
0.7666 --- loss: 1.274286, loss_ss: 0.862303, loss_d: 0.411984
0.8049 --- loss: 1.286294, loss_ss: 0.838145, loss_d: 0.448149
0.8432 --- loss: 1.628732, loss_ss: 0.914177, loss_d: 0.714555
0.8816 --- loss: 1.823463, loss_ss: 1.182999, loss_d: 0.640465
0.9199 --- loss: 1.330460, loss_ss: 0.982699, loss_d: 0.347761
0.9582 --- loss: 1.589109, loss_ss: 1.115701, loss_d: 0.473408
0.9966 --- loss: 1.495467, loss_ss: 0.908064, loss_d: 0.587402
Epoch finished! Loss: 1.5392958242159622
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.183870, loss_ss: 0.854804, loss_d: 0.329067
0.0383 --- loss: 1.740561, loss_ss: 0.935895, loss_d: 0.804666
0.0767 --- loss: 1.402871, loss_ss: 0.868018, loss_d: 0.534853
0.1150 --- loss: 1.606310, loss_ss: 0.790250, loss_d: 0.816060
0.1533 --- loss: 1.697487, loss_ss: 1.118015, loss_d: 0.579472
0.1916 --- loss: 1.179420, loss_ss: 0.857972, loss_d: 0.321448
0.2300 --- loss: 1.378247, loss_ss: 0.887264, loss_d: 0.490983
0.2683 --- loss: 1.408286, loss_ss: 1.134294, loss_d: 0.273992
0.3066 --- loss: 1.385168, loss_ss: 0.662528, loss_d: 0.722640
0.3450 --- loss: 1.383496, loss_ss: 0.877259, loss_d: 0.506237
0.3833 --- loss: 1.730052, loss_ss: 0.826675, loss_d: 0.903377
0.4216 --- loss: 1.520416, loss_ss: 1.089711, loss_d: 0.430705
0.4599 --- loss: 1.207380, loss_ss: 0.729116, loss_d: 0.478265
0.4983 --- loss: 1.362484, loss_ss: 0.957266, loss_d: 0.405217
0.5366 --- loss: 1.115583, loss_ss: 0.790485, loss_d: 0.325098
0.5749 --- loss: 1.072739, loss_ss: 0.880296, loss_d: 0.192443
0.6133 --- loss: 1.658664, loss_ss: 0.796632, loss_d: 0.862032
0.6516 --- loss: 1.624524, loss_ss: 0.812220, loss_d: 0.812305
0.6899 --- loss: 1.681894, loss_ss: 0.927401, loss_d: 0.754493
0.7282 --- loss: 1.280473, loss_ss: 0.833461, loss_d: 0.447013
0.7666 --- loss: 1.465377, loss_ss: 0.958150, loss_d: 0.507227
0.8049 --- loss: 1.705208, loss_ss: 1.156304, loss_d: 0.548905
0.8432 --- loss: 1.594020, loss_ss: 0.927515, loss_d: 0.666505
0.8816 --- loss: 1.146422, loss_ss: 0.720630, loss_d: 0.425793
0.9199 --- loss: 1.580751, loss_ss: 0.829358, loss_d: 0.751393
0.9582 --- loss: 1.365579, loss_ss: 1.149486, loss_d: 0.216093
0.9966 --- loss: 1.390645, loss_ss: 1.038317, loss_d: 0.352328
Epoch finished! Loss: 1.474326325609134
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.050466, loss_ss: 0.735704, loss_d: 0.314763
0.0383 --- loss: 2.209526, loss_ss: 1.121950, loss_d: 1.087576
0.0767 --- loss: 1.387098, loss_ss: 0.914501, loss_d: 0.472597
0.1150 --- loss: 1.117664, loss_ss: 0.784343, loss_d: 0.333321
0.1533 --- loss: 1.989652, loss_ss: 0.788257, loss_d: 1.201394
0.1916 --- loss: 1.388135, loss_ss: 0.860797, loss_d: 0.527338
0.2300 --- loss: 1.701862, loss_ss: 0.930270, loss_d: 0.771592
0.2683 --- loss: 1.221322, loss_ss: 0.751405, loss_d: 0.469917
0.3066 --- loss: 1.374994, loss_ss: 0.896764, loss_d: 0.478230
0.3450 --- loss: 1.603061, loss_ss: 0.749557, loss_d: 0.853504
0.3833 --- loss: 1.167704, loss_ss: 0.763438, loss_d: 0.404267
0.4216 --- loss: 1.507309, loss_ss: 0.807449, loss_d: 0.699860
0.4599 --- loss: 1.725503, loss_ss: 0.923127, loss_d: 0.802376
0.4983 --- loss: 1.379648, loss_ss: 0.928593, loss_d: 0.451055
0.5366 --- loss: 1.495526, loss_ss: 0.951054, loss_d: 0.544472
0.5749 --- loss: 1.517772, loss_ss: 1.008416, loss_d: 0.509356
0.6133 --- loss: 1.096356, loss_ss: 0.850187, loss_d: 0.246169
0.6516 --- loss: 1.508353, loss_ss: 1.124135, loss_d: 0.384217
0.6899 --- loss: 1.290243, loss_ss: 0.997907, loss_d: 0.292337
0.7282 --- loss: 1.460999, loss_ss: 1.139722, loss_d: 0.321277
0.7666 --- loss: 1.201760, loss_ss: 0.795287, loss_d: 0.406473
0.8049 --- loss: 1.048375, loss_ss: 0.807085, loss_d: 0.241289
0.8432 --- loss: 1.363604, loss_ss: 0.768669, loss_d: 0.594935
0.8816 --- loss: 1.154614, loss_ss: 0.825230, loss_d: 0.329384
0.9199 --- loss: 1.393494, loss_ss: 0.991929, loss_d: 0.401565
0.9582 --- loss: 1.575613, loss_ss: 1.041223, loss_d: 0.534389
0.9966 --- loss: 1.314335, loss_ss: 0.871824, loss_d: 0.442511
Epoch finished! Loss: 1.3694043404780902
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.119232, loss_ss: 0.869526, loss_d: 0.249706
0.0383 --- loss: 1.118276, loss_ss: 0.773020, loss_d: 0.345256
0.0767 --- loss: 1.079769, loss_ss: 0.774117, loss_d: 0.305652
0.1150 --- loss: 1.189047, loss_ss: 0.671460, loss_d: 0.517587
0.1533 --- loss: 1.482924, loss_ss: 1.096478, loss_d: 0.386446
0.1916 --- loss: 1.307174, loss_ss: 1.007020, loss_d: 0.300154
0.2300 --- loss: 1.189997, loss_ss: 0.898926, loss_d: 0.291070
0.2683 --- loss: 1.136819, loss_ss: 0.794968, loss_d: 0.341851
0.3066 --- loss: 1.349119, loss_ss: 0.834439, loss_d: 0.514680
0.3450 --- loss: 1.408681, loss_ss: 0.690169, loss_d: 0.718512
0.3833 --- loss: 1.322722, loss_ss: 0.991264, loss_d: 0.331458
0.4216 --- loss: 1.030921, loss_ss: 0.834992, loss_d: 0.195928
0.4599 --- loss: 1.222862, loss_ss: 0.579436, loss_d: 0.643426
0.4983 --- loss: 1.644191, loss_ss: 0.961617, loss_d: 0.682574
0.5366 --- loss: 1.262685, loss_ss: 0.972822, loss_d: 0.289862
0.5749 --- loss: 1.090422, loss_ss: 0.838734, loss_d: 0.251688
0.6133 --- loss: 1.566374, loss_ss: 1.074130, loss_d: 0.492244
0.6516 --- loss: 1.194352, loss_ss: 0.978134, loss_d: 0.216218
0.6899 --- loss: 1.108788, loss_ss: 0.912438, loss_d: 0.196350
0.7282 --- loss: 1.630261, loss_ss: 1.074290, loss_d: 0.555971
0.7666 --- loss: 1.389003, loss_ss: 0.966043, loss_d: 0.422960
0.8049 --- loss: 1.679256, loss_ss: 0.869588, loss_d: 0.809668
0.8432 --- loss: 1.609912, loss_ss: 1.331978, loss_d: 0.277934
0.8816 --- loss: 1.176140, loss_ss: 0.564243, loss_d: 0.611898
0.9199 --- loss: 1.150511, loss_ss: 0.878163, loss_d: 0.272348
0.9582 --- loss: 0.813403, loss_ss: 0.651603, loss_d: 0.161800
0.9966 --- loss: 1.206840, loss_ss: 0.997308, loss_d: 0.209532
Epoch finished! Loss: 1.2665896133734629
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.311003, loss_ss: 1.022064, loss_d: 0.288939
0.0383 --- loss: 1.260493, loss_ss: 0.826235, loss_d: 0.434258
0.0767 --- loss: 1.422832, loss_ss: 0.916770, loss_d: 0.506062
0.1150 --- loss: 1.354578, loss_ss: 0.991927, loss_d: 0.362652
0.1533 --- loss: 0.800826, loss_ss: 0.729520, loss_d: 0.071306
0.1916 --- loss: 1.506346, loss_ss: 0.727404, loss_d: 0.778942
0.2300 --- loss: 1.913811, loss_ss: 1.178493, loss_d: 0.735318
0.2683 --- loss: 1.399522, loss_ss: 0.733838, loss_d: 0.665684
0.3066 --- loss: 0.980628, loss_ss: 0.636888, loss_d: 0.343740
0.3450 --- loss: 1.286624, loss_ss: 0.999098, loss_d: 0.287526
0.3833 --- loss: 1.313027, loss_ss: 0.957549, loss_d: 0.355478
0.4216 --- loss: 0.797437, loss_ss: 0.697330, loss_d: 0.100107
0.4599 --- loss: 0.954520, loss_ss: 0.563018, loss_d: 0.391502
0.4983 --- loss: 1.010198, loss_ss: 0.824340, loss_d: 0.185857
0.5366 --- loss: 1.490163, loss_ss: 1.060771, loss_d: 0.429393
0.5749 --- loss: 1.024194, loss_ss: 0.781345, loss_d: 0.242849
0.6133 --- loss: 1.052181, loss_ss: 0.809110, loss_d: 0.243071
0.6516 --- loss: 1.025816, loss_ss: 0.620308, loss_d: 0.405508
0.6899 --- loss: 1.090307, loss_ss: 0.864266, loss_d: 0.226041
0.7282 --- loss: 0.892749, loss_ss: 0.465588, loss_d: 0.427161
0.7666 --- loss: 0.993071, loss_ss: 0.711106, loss_d: 0.281965
0.8049 --- loss: 1.124196, loss_ss: 0.789430, loss_d: 0.334766
0.8432 --- loss: 1.519652, loss_ss: 1.187473, loss_d: 0.332179
0.8816 --- loss: 1.054957, loss_ss: 0.780306, loss_d: 0.274651
0.9199 --- loss: 1.105339, loss_ss: 0.754547, loss_d: 0.350792
0.9582 --- loss: 1.429275, loss_ss: 0.691137, loss_d: 0.738138
0.9966 --- loss: 0.826578, loss_ss: 0.637127, loss_d: 0.189451
Epoch finished! Loss: 1.2174700234945004
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.985093, loss_ss: 0.805069, loss_d: 0.180024
0.0383 --- loss: 1.472348, loss_ss: 1.278897, loss_d: 0.193451
0.0767 --- loss: 1.239698, loss_ss: 0.790203, loss_d: 0.449495
0.1150 --- loss: 1.315988, loss_ss: 1.151122, loss_d: 0.164865
0.1533 --- loss: 1.062065, loss_ss: 0.833711, loss_d: 0.228355
0.1916 --- loss: 0.880905, loss_ss: 0.700655, loss_d: 0.180251
0.2300 --- loss: 0.985186, loss_ss: 0.855350, loss_d: 0.129836
0.2683 --- loss: 1.066344, loss_ss: 0.842735, loss_d: 0.223609
0.3066 --- loss: 0.837038, loss_ss: 0.758085, loss_d: 0.078953
0.3450 --- loss: 0.968048, loss_ss: 0.733387, loss_d: 0.234661
0.3833 --- loss: 1.043882, loss_ss: 0.683446, loss_d: 0.360435
0.4216 --- loss: 0.783912, loss_ss: 0.659774, loss_d: 0.124138
0.4599 --- loss: 1.496576, loss_ss: 0.698888, loss_d: 0.797688
0.4983 --- loss: 1.105560, loss_ss: 0.640092, loss_d: 0.465469
0.5366 --- loss: 1.282848, loss_ss: 0.695342, loss_d: 0.587505
0.5749 --- loss: 1.582814, loss_ss: 0.890688, loss_d: 0.692126
0.6133 --- loss: 1.066972, loss_ss: 0.864279, loss_d: 0.202692
0.6516 --- loss: 1.563491, loss_ss: 0.863199, loss_d: 0.700293
0.6899 --- loss: 1.309056, loss_ss: 0.836990, loss_d: 0.472066
0.7282 --- loss: 1.363632, loss_ss: 0.642880, loss_d: 0.720751
0.7666 --- loss: 1.025481, loss_ss: 0.794231, loss_d: 0.231250
0.8049 --- loss: 1.337803, loss_ss: 1.119114, loss_d: 0.218689
0.8432 --- loss: 0.912647, loss_ss: 0.579140, loss_d: 0.333507
0.8816 --- loss: 1.195825, loss_ss: 0.940784, loss_d: 0.255041
0.9199 --- loss: 1.565006, loss_ss: 1.119178, loss_d: 0.445827
0.9582 --- loss: 1.130228, loss_ss: 0.725498, loss_d: 0.404730
0.9966 --- loss: 1.263395, loss_ss: 0.954913, loss_d: 0.308481
Epoch finished! Loss: 1.1596308428507585
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.201154, loss_ss: 0.776437, loss_d: 0.424717
0.0383 --- loss: 0.904830, loss_ss: 0.660416, loss_d: 0.244414
0.0767 --- loss: 1.352431, loss_ss: 0.689625, loss_d: 0.662806
0.1150 --- loss: 1.135431, loss_ss: 0.950968, loss_d: 0.184463
0.1533 --- loss: 1.443654, loss_ss: 0.813769, loss_d: 0.629885
0.1916 --- loss: 1.137463, loss_ss: 0.930342, loss_d: 0.207121
0.2300 --- loss: 1.052553, loss_ss: 0.757940, loss_d: 0.294614
0.2683 --- loss: 0.896085, loss_ss: 0.794187, loss_d: 0.101898
0.3066 --- loss: 1.083751, loss_ss: 0.872184, loss_d: 0.211568
0.3450 --- loss: 1.478364, loss_ss: 0.878938, loss_d: 0.599426
0.3833 --- loss: 0.971458, loss_ss: 0.811472, loss_d: 0.159986
0.4216 --- loss: 1.246195, loss_ss: 0.974619, loss_d: 0.271576
0.4599 --- loss: 1.048428, loss_ss: 0.920338, loss_d: 0.128091
0.4983 --- loss: 0.705559, loss_ss: 0.605357, loss_d: 0.100202
0.5366 --- loss: 0.779036, loss_ss: 0.661866, loss_d: 0.117170
0.5749 --- loss: 0.894793, loss_ss: 0.744138, loss_d: 0.150656
0.6133 --- loss: 0.965614, loss_ss: 0.781897, loss_d: 0.183717
0.6516 --- loss: 1.193051, loss_ss: 0.924953, loss_d: 0.268098
0.6899 --- loss: 1.043946, loss_ss: 0.784062, loss_d: 0.259884
0.7282 --- loss: 1.345514, loss_ss: 1.194764, loss_d: 0.150750
0.7666 --- loss: 1.348036, loss_ss: 0.755795, loss_d: 0.592241
0.8049 --- loss: 1.311012, loss_ss: 0.642414, loss_d: 0.668598
0.8432 --- loss: 0.845310, loss_ss: 0.693617, loss_d: 0.151693
0.8816 --- loss: 1.091497, loss_ss: 0.856217, loss_d: 0.235280
0.9199 --- loss: 0.911742, loss_ss: 0.832063, loss_d: 0.079679
0.9582 --- loss: 0.859800, loss_ss: 0.710572, loss_d: 0.149228
0.9966 --- loss: 1.153433, loss_ss: 0.884320, loss_d: 0.269114
Epoch finished! Loss: 1.1276460920388882
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8425287356321839
             precision    recall  f1-score   support

        0.0       0.65      0.93      0.77        72
        1.0       0.50      0.04      0.08        46
        2.0       0.89      0.85      0.87       443
        3.0       0.83      0.98      0.90       196
        4.0       0.87      0.85      0.86       113

avg / total       0.83      0.84      0.82       870
 


====== chc009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.29  93.06   95.49  65.05     76.57
1  94.71   4.35   99.76  50.00      8.00
2  87.01  84.88   89.23  89.10     86.94
3  95.06  97.96   94.21  83.12     89.93
4  96.44  84.96   98.15  87.27     86.10
Total accuracy: 84.25%
Average sen: 73.04%
Average spec: 95.37%
Macro f1-score: 69.51%
Diagnosis acc on 15mins: 1.0
[0.09275255 0.13448542 0.08218066 0.11291897 0.12422293 0.1740284
 0.06912715 0.10955063 0.04481237 0.0560714  0.06640504 0.16726393
 0.12801276 0.10097937 0.24463858 0.14293458 0.05770777 0.09163268
 0.1523415  0.03884534 0.10591938 0.17956001 0.10631504 0.10376272
 0.06131151 0.19461972 0.1687765  0.16662124 0.16335267]
pred: 0.11866037187905147, label: 0
Right! Diagnosis: Other

=== Test on chc010-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.254129, loss_ss: 1.576229, loss_d: 0.677900
0.0383 --- loss: 2.066339, loss_ss: 1.398831, loss_d: 0.667508
0.0766 --- loss: 2.128722, loss_ss: 1.662654, loss_d: 0.466068
0.1149 --- loss: 2.222268, loss_ss: 1.395543, loss_d: 0.826725
0.1533 --- loss: 1.898239, loss_ss: 1.297766, loss_d: 0.600473
0.1916 --- loss: 1.897643, loss_ss: 1.336346, loss_d: 0.561296
0.2299 --- loss: 1.834686, loss_ss: 1.310604, loss_d: 0.524081
0.2682 --- loss: 1.994911, loss_ss: 1.434761, loss_d: 0.560150
0.3065 --- loss: 1.981846, loss_ss: 1.415864, loss_d: 0.565982
0.3448 --- loss: 1.925414, loss_ss: 1.412208, loss_d: 0.513206
0.3831 --- loss: 1.963898, loss_ss: 1.438223, loss_d: 0.525675
0.4215 --- loss: 1.864209, loss_ss: 1.350639, loss_d: 0.513570
0.4598 --- loss: 1.815373, loss_ss: 1.248152, loss_d: 0.567221
0.4981 --- loss: 1.862622, loss_ss: 1.305240, loss_d: 0.557382
0.5364 --- loss: 1.708087, loss_ss: 1.334522, loss_d: 0.373565
0.5747 --- loss: 2.060982, loss_ss: 1.366623, loss_d: 0.694358
0.6130 --- loss: 1.812700, loss_ss: 1.120774, loss_d: 0.691927
0.6513 --- loss: 1.876183, loss_ss: 1.363780, loss_d: 0.512404
0.6897 --- loss: 1.917386, loss_ss: 1.236163, loss_d: 0.681223
0.7280 --- loss: 2.136991, loss_ss: 1.398719, loss_d: 0.738272
0.7663 --- loss: 1.841691, loss_ss: 1.052885, loss_d: 0.788806
0.8046 --- loss: 1.880093, loss_ss: 1.292158, loss_d: 0.587935
0.8429 --- loss: 1.833980, loss_ss: 1.343793, loss_d: 0.490188
0.8812 --- loss: 1.949461, loss_ss: 1.044150, loss_d: 0.905311
0.9195 --- loss: 1.503778, loss_ss: 1.102504, loss_d: 0.401274
0.9579 --- loss: 1.822216, loss_ss: 1.301767, loss_d: 0.520450
0.9962 --- loss: 1.810828, loss_ss: 1.331839, loss_d: 0.478990
Epoch finished! Loss: 1.9314716829703404
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.618218, loss_ss: 1.126992, loss_d: 0.491226
0.0383 --- loss: 1.549409, loss_ss: 1.067565, loss_d: 0.481844
0.0766 --- loss: 2.061419, loss_ss: 1.430489, loss_d: 0.630929
0.1149 --- loss: 1.560147, loss_ss: 1.046421, loss_d: 0.513726
0.1533 --- loss: 1.649328, loss_ss: 1.130775, loss_d: 0.518554
0.1916 --- loss: 1.651938, loss_ss: 1.114244, loss_d: 0.537694
0.2299 --- loss: 2.002795, loss_ss: 1.212706, loss_d: 0.790089
0.2682 --- loss: 1.902823, loss_ss: 1.173231, loss_d: 0.729591
0.3065 --- loss: 2.088226, loss_ss: 1.099409, loss_d: 0.988818
0.3448 --- loss: 1.538925, loss_ss: 1.094562, loss_d: 0.444363
0.3831 --- loss: 1.637499, loss_ss: 1.119645, loss_d: 0.517854
0.4215 --- loss: 1.865299, loss_ss: 1.041884, loss_d: 0.823415
0.4598 --- loss: 1.580496, loss_ss: 1.164536, loss_d: 0.415960
0.4981 --- loss: 1.629278, loss_ss: 1.008178, loss_d: 0.621100
0.5364 --- loss: 1.676176, loss_ss: 1.041026, loss_d: 0.635150
0.5747 --- loss: 1.542673, loss_ss: 1.299764, loss_d: 0.242909
0.6130 --- loss: 1.779411, loss_ss: 1.190747, loss_d: 0.588664
0.6513 --- loss: 1.655234, loss_ss: 1.147201, loss_d: 0.508033
0.6897 --- loss: 1.453653, loss_ss: 1.021689, loss_d: 0.431964
0.7280 --- loss: 2.290183, loss_ss: 1.317223, loss_d: 0.972960
0.7663 --- loss: 1.610108, loss_ss: 0.891932, loss_d: 0.718176
0.8046 --- loss: 2.011841, loss_ss: 1.476213, loss_d: 0.535628
0.8429 --- loss: 1.774206, loss_ss: 1.082972, loss_d: 0.691234
0.8812 --- loss: 1.615521, loss_ss: 1.101629, loss_d: 0.513893
0.9195 --- loss: 1.448845, loss_ss: 0.999011, loss_d: 0.449834
0.9579 --- loss: 1.419173, loss_ss: 0.964378, loss_d: 0.454796
0.9962 --- loss: 1.729760, loss_ss: 1.069244, loss_d: 0.660517
Epoch finished! Loss: 1.7332347585604742
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.756706, loss_ss: 1.216310, loss_d: 0.540397
0.0383 --- loss: 1.731732, loss_ss: 1.191343, loss_d: 0.540389
0.0766 --- loss: 1.944813, loss_ss: 0.982127, loss_d: 0.962686
0.1149 --- loss: 1.347784, loss_ss: 0.904623, loss_d: 0.443161
0.1533 --- loss: 1.926425, loss_ss: 1.246674, loss_d: 0.679751
0.1916 --- loss: 1.720732, loss_ss: 1.079884, loss_d: 0.640848
0.2299 --- loss: 1.464767, loss_ss: 0.926533, loss_d: 0.538235
0.2682 --- loss: 1.638883, loss_ss: 1.083223, loss_d: 0.555660
0.3065 --- loss: 2.066812, loss_ss: 1.261881, loss_d: 0.804931
0.3448 --- loss: 1.972507, loss_ss: 1.152730, loss_d: 0.819777
0.3831 --- loss: 1.725116, loss_ss: 1.189888, loss_d: 0.535227
0.4215 --- loss: 1.620221, loss_ss: 1.143477, loss_d: 0.476744
0.4598 --- loss: 1.392096, loss_ss: 1.030454, loss_d: 0.361642
0.4981 --- loss: 1.863861, loss_ss: 0.979869, loss_d: 0.883992
0.5364 --- loss: 1.313818, loss_ss: 1.012293, loss_d: 0.301525
0.5747 --- loss: 1.593209, loss_ss: 0.996933, loss_d: 0.596276
0.6130 --- loss: 2.056509, loss_ss: 1.342601, loss_d: 0.713908
0.6513 --- loss: 1.484962, loss_ss: 0.799729, loss_d: 0.685233
0.6897 --- loss: 1.432340, loss_ss: 1.070835, loss_d: 0.361504
0.7280 --- loss: 1.372468, loss_ss: 0.980248, loss_d: 0.392220
0.7663 --- loss: 1.653887, loss_ss: 0.942017, loss_d: 0.711869
0.8046 --- loss: 1.836127, loss_ss: 1.370316, loss_d: 0.465811
0.8429 --- loss: 1.671478, loss_ss: 0.881623, loss_d: 0.789855
0.8812 --- loss: 1.563661, loss_ss: 1.111363, loss_d: 0.452297
0.9195 --- loss: 1.561037, loss_ss: 0.885396, loss_d: 0.675641
0.9579 --- loss: 1.812568, loss_ss: 1.035330, loss_d: 0.777238
0.9962 --- loss: 1.597044, loss_ss: 0.884982, loss_d: 0.712062
Epoch finished! Loss: 1.6366127504752233
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.774143, loss_ss: 0.973698, loss_d: 0.800444
0.0383 --- loss: 1.911898, loss_ss: 1.122759, loss_d: 0.789139
0.0766 --- loss: 1.718397, loss_ss: 0.773588, loss_d: 0.944808
0.1149 --- loss: 1.547804, loss_ss: 0.876650, loss_d: 0.671153
0.1533 --- loss: 1.597057, loss_ss: 0.905573, loss_d: 0.691484
0.1916 --- loss: 1.882325, loss_ss: 0.937585, loss_d: 0.944740
0.2299 --- loss: 1.776460, loss_ss: 1.147232, loss_d: 0.629228
0.2682 --- loss: 1.621846, loss_ss: 1.029860, loss_d: 0.591985
0.3065 --- loss: 1.513481, loss_ss: 0.868874, loss_d: 0.644607
0.3448 --- loss: 1.517453, loss_ss: 1.067530, loss_d: 0.449923
0.3831 --- loss: 1.515522, loss_ss: 1.080874, loss_d: 0.434649
0.4215 --- loss: 1.315947, loss_ss: 0.697629, loss_d: 0.618318
0.4598 --- loss: 1.436602, loss_ss: 1.115656, loss_d: 0.320946
0.4981 --- loss: 1.370428, loss_ss: 0.909931, loss_d: 0.460497
0.5364 --- loss: 1.536252, loss_ss: 0.956289, loss_d: 0.579963
0.5747 --- loss: 1.566991, loss_ss: 0.951393, loss_d: 0.615598
0.6130 --- loss: 1.406714, loss_ss: 0.916333, loss_d: 0.490381
0.6513 --- loss: 1.329435, loss_ss: 0.869552, loss_d: 0.459883
0.6897 --- loss: 1.595638, loss_ss: 0.869716, loss_d: 0.725922
0.7280 --- loss: 1.681737, loss_ss: 1.213603, loss_d: 0.468134
0.7663 --- loss: 1.582539, loss_ss: 0.947936, loss_d: 0.634603
0.8046 --- loss: 1.408628, loss_ss: 0.840643, loss_d: 0.567985
0.8429 --- loss: 1.829468, loss_ss: 0.989641, loss_d: 0.839827
0.8812 --- loss: 1.375594, loss_ss: 1.008822, loss_d: 0.366772
0.9195 --- loss: 1.265388, loss_ss: 0.786173, loss_d: 0.479215
0.9579 --- loss: 1.448761, loss_ss: 0.741204, loss_d: 0.707557
0.9962 --- loss: 1.751178, loss_ss: 0.961130, loss_d: 0.790047
Epoch finished! Loss: 1.5503397891154655
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.454569, loss_ss: 0.959939, loss_d: 0.494631
0.0383 --- loss: 1.538273, loss_ss: 1.039181, loss_d: 0.499093
0.0766 --- loss: 1.398994, loss_ss: 0.983987, loss_d: 0.415008
0.1149 --- loss: 1.502725, loss_ss: 1.077908, loss_d: 0.424817
0.1533 --- loss: 1.554276, loss_ss: 0.828874, loss_d: 0.725401
0.1916 --- loss: 1.520605, loss_ss: 1.029480, loss_d: 0.491125
0.2299 --- loss: 1.965562, loss_ss: 1.399064, loss_d: 0.566498
0.2682 --- loss: 1.829291, loss_ss: 1.300629, loss_d: 0.528661
0.3065 --- loss: 1.564977, loss_ss: 1.056223, loss_d: 0.508754
0.3448 --- loss: 1.234352, loss_ss: 0.809031, loss_d: 0.425321
0.3831 --- loss: 1.358047, loss_ss: 0.783094, loss_d: 0.574953
0.4215 --- loss: 1.492414, loss_ss: 0.820480, loss_d: 0.671934
0.4598 --- loss: 1.524941, loss_ss: 0.986088, loss_d: 0.538852
0.4981 --- loss: 1.304142, loss_ss: 1.071322, loss_d: 0.232820
0.5364 --- loss: 1.280836, loss_ss: 0.857896, loss_d: 0.422940
0.5747 --- loss: 1.254023, loss_ss: 0.857152, loss_d: 0.396871
0.6130 --- loss: 1.616635, loss_ss: 0.963954, loss_d: 0.652681
0.6513 --- loss: 1.369603, loss_ss: 0.950022, loss_d: 0.419581
0.6897 --- loss: 1.191762, loss_ss: 0.816907, loss_d: 0.374855
0.7280 --- loss: 1.604001, loss_ss: 1.130238, loss_d: 0.473763
0.7663 --- loss: 1.591496, loss_ss: 0.912511, loss_d: 0.678985
0.8046 --- loss: 1.360725, loss_ss: 0.840623, loss_d: 0.520103
0.8429 --- loss: 1.237830, loss_ss: 0.828028, loss_d: 0.409803
0.8812 --- loss: 1.297625, loss_ss: 0.787503, loss_d: 0.510122
0.9195 --- loss: 1.550762, loss_ss: 1.058674, loss_d: 0.492088
0.9579 --- loss: 1.551892, loss_ss: 1.142036, loss_d: 0.409856
0.9962 --- loss: 1.638441, loss_ss: 0.945113, loss_d: 0.693328
Epoch finished! Loss: 1.4806909130169794
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.518964, loss_ss: 0.951183, loss_d: 0.567781
0.0383 --- loss: 1.057776, loss_ss: 0.688838, loss_d: 0.368938
0.0766 --- loss: 1.130017, loss_ss: 0.777731, loss_d: 0.352286
0.1149 --- loss: 1.260712, loss_ss: 0.879444, loss_d: 0.381268
0.1533 --- loss: 1.462151, loss_ss: 0.897665, loss_d: 0.564486
0.1916 --- loss: 1.465867, loss_ss: 1.146019, loss_d: 0.319848
0.2299 --- loss: 1.225909, loss_ss: 0.959592, loss_d: 0.266317
0.2682 --- loss: 1.237759, loss_ss: 0.930816, loss_d: 0.306943
0.3065 --- loss: 1.323626, loss_ss: 0.893229, loss_d: 0.430397
0.3448 --- loss: 1.513649, loss_ss: 0.904688, loss_d: 0.608961
0.3831 --- loss: 1.622056, loss_ss: 0.904361, loss_d: 0.717695
0.4215 --- loss: 1.693406, loss_ss: 0.747216, loss_d: 0.946190
0.4598 --- loss: 1.263988, loss_ss: 0.842178, loss_d: 0.421810
0.4981 --- loss: 1.530102, loss_ss: 1.238928, loss_d: 0.291174
0.5364 --- loss: 1.685251, loss_ss: 1.007738, loss_d: 0.677512
0.5747 --- loss: 1.393944, loss_ss: 0.892642, loss_d: 0.501302
0.6130 --- loss: 1.208751, loss_ss: 0.760249, loss_d: 0.448502
0.6513 --- loss: 1.732869, loss_ss: 0.955771, loss_d: 0.777098
0.6897 --- loss: 0.999889, loss_ss: 0.764371, loss_d: 0.235518
0.7280 --- loss: 1.456235, loss_ss: 0.921923, loss_d: 0.534312
0.7663 --- loss: 1.190166, loss_ss: 0.756328, loss_d: 0.433838
0.8046 --- loss: 1.491323, loss_ss: 1.044404, loss_d: 0.446919
0.8429 --- loss: 1.601629, loss_ss: 0.664783, loss_d: 0.936846
0.8812 --- loss: 1.019153, loss_ss: 0.805899, loss_d: 0.213254
0.9195 --- loss: 1.409109, loss_ss: 0.973088, loss_d: 0.436021
0.9579 --- loss: 1.426403, loss_ss: 0.587606, loss_d: 0.838797
0.9962 --- loss: 1.312023, loss_ss: 0.923056, loss_d: 0.388966
Epoch finished! Loss: 1.4249994344436205
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.340675, loss_ss: 0.921260, loss_d: 0.419415
0.0383 --- loss: 1.275733, loss_ss: 0.908858, loss_d: 0.366875
0.0766 --- loss: 1.386683, loss_ss: 0.956719, loss_d: 0.429964
0.1149 --- loss: 1.401849, loss_ss: 0.707617, loss_d: 0.694232
0.1533 --- loss: 1.391196, loss_ss: 0.918486, loss_d: 0.472709
0.1916 --- loss: 1.542562, loss_ss: 0.855174, loss_d: 0.687388
0.2299 --- loss: 1.598768, loss_ss: 0.896501, loss_d: 0.702267
0.2682 --- loss: 1.014021, loss_ss: 0.740823, loss_d: 0.273198
0.3065 --- loss: 1.350792, loss_ss: 1.090074, loss_d: 0.260719
0.3448 --- loss: 1.403323, loss_ss: 1.234856, loss_d: 0.168467
0.3831 --- loss: 0.887092, loss_ss: 0.715406, loss_d: 0.171687
0.4215 --- loss: 1.384475, loss_ss: 1.023737, loss_d: 0.360737
0.4598 --- loss: 1.406628, loss_ss: 0.713199, loss_d: 0.693429
0.4981 --- loss: 1.597079, loss_ss: 1.125244, loss_d: 0.471835
0.5364 --- loss: 1.575176, loss_ss: 0.879808, loss_d: 0.695368
0.5747 --- loss: 1.517740, loss_ss: 1.008784, loss_d: 0.508956
0.6130 --- loss: 1.345588, loss_ss: 1.064979, loss_d: 0.280609
0.6513 --- loss: 1.291722, loss_ss: 0.901797, loss_d: 0.389925
0.6897 --- loss: 1.220421, loss_ss: 0.974568, loss_d: 0.245853
0.7280 --- loss: 1.022081, loss_ss: 0.824667, loss_d: 0.197415
0.7663 --- loss: 1.108971, loss_ss: 0.751005, loss_d: 0.357966
0.8046 --- loss: 1.310332, loss_ss: 0.944349, loss_d: 0.365983
0.8429 --- loss: 1.397392, loss_ss: 0.897614, loss_d: 0.499778
0.8812 --- loss: 1.372652, loss_ss: 0.940784, loss_d: 0.431868
0.9195 --- loss: 1.296546, loss_ss: 0.982058, loss_d: 0.314488
0.9579 --- loss: 0.945977, loss_ss: 0.767266, loss_d: 0.178710
0.9962 --- loss: 1.113532, loss_ss: 1.006707, loss_d: 0.106825
Epoch finished! Loss: 1.3378639085934712
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.200778, loss_ss: 0.773888, loss_d: 0.426890
0.0383 --- loss: 1.265077, loss_ss: 1.061042, loss_d: 0.204035
0.0766 --- loss: 0.797420, loss_ss: 0.684287, loss_d: 0.113133
0.1149 --- loss: 1.107614, loss_ss: 0.886428, loss_d: 0.221187
0.1533 --- loss: 0.853368, loss_ss: 0.739591, loss_d: 0.113777
0.1916 --- loss: 1.134118, loss_ss: 0.683263, loss_d: 0.450855
0.2299 --- loss: 1.392160, loss_ss: 0.940409, loss_d: 0.451751
0.2682 --- loss: 1.637641, loss_ss: 1.270507, loss_d: 0.367134
0.3065 --- loss: 0.794372, loss_ss: 0.606167, loss_d: 0.188205
0.3448 --- loss: 1.677356, loss_ss: 1.130047, loss_d: 0.547309
0.3831 --- loss: 1.225092, loss_ss: 0.722236, loss_d: 0.502856
0.4215 --- loss: 1.020589, loss_ss: 0.814357, loss_d: 0.206233
0.4598 --- loss: 1.379820, loss_ss: 1.119561, loss_d: 0.260259
0.4981 --- loss: 1.083079, loss_ss: 0.790910, loss_d: 0.292169
0.5364 --- loss: 1.114173, loss_ss: 0.777835, loss_d: 0.336338
0.5747 --- loss: 1.664270, loss_ss: 1.080705, loss_d: 0.583564
0.6130 --- loss: 1.001033, loss_ss: 0.684535, loss_d: 0.316498
0.6513 --- loss: 1.546108, loss_ss: 1.129175, loss_d: 0.416932
0.6897 --- loss: 1.046554, loss_ss: 0.759426, loss_d: 0.287128
0.7280 --- loss: 1.326732, loss_ss: 0.892264, loss_d: 0.434468
0.7663 --- loss: 1.370040, loss_ss: 0.907138, loss_d: 0.462901
0.8046 --- loss: 1.726898, loss_ss: 1.339419, loss_d: 0.387479
0.8429 --- loss: 1.101139, loss_ss: 0.833824, loss_d: 0.267315
0.8812 --- loss: 1.309208, loss_ss: 1.006695, loss_d: 0.302512
0.9195 --- loss: 1.180869, loss_ss: 1.049053, loss_d: 0.131816
0.9579 --- loss: 1.124558, loss_ss: 0.879120, loss_d: 0.245438
0.9962 --- loss: 1.001162, loss_ss: 0.847325, loss_d: 0.153837
Epoch finished! Loss: 1.2624360873148992
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.279761, loss_ss: 1.030582, loss_d: 0.249179
0.0383 --- loss: 1.155238, loss_ss: 0.944446, loss_d: 0.210792
0.0766 --- loss: 1.456336, loss_ss: 1.198132, loss_d: 0.258204
0.1149 --- loss: 1.427574, loss_ss: 1.121219, loss_d: 0.306354
0.1533 --- loss: 1.156661, loss_ss: 0.995905, loss_d: 0.160756
0.1916 --- loss: 1.406175, loss_ss: 0.713800, loss_d: 0.692375
0.2299 --- loss: 0.875615, loss_ss: 0.617060, loss_d: 0.258555
0.2682 --- loss: 1.203542, loss_ss: 0.970117, loss_d: 0.233425
0.3065 --- loss: 1.104930, loss_ss: 0.753538, loss_d: 0.351392
0.3448 --- loss: 1.114192, loss_ss: 0.920007, loss_d: 0.194185
0.3831 --- loss: 1.151909, loss_ss: 0.876582, loss_d: 0.275328
0.4215 --- loss: 1.213069, loss_ss: 1.003078, loss_d: 0.209991
0.4598 --- loss: 1.293769, loss_ss: 1.114287, loss_d: 0.179482
0.4981 --- loss: 1.134816, loss_ss: 1.013291, loss_d: 0.121526
0.5364 --- loss: 0.815521, loss_ss: 0.671053, loss_d: 0.144468
0.5747 --- loss: 0.750736, loss_ss: 0.595999, loss_d: 0.154737
0.6130 --- loss: 1.279441, loss_ss: 0.800803, loss_d: 0.478639
0.6513 --- loss: 1.105637, loss_ss: 0.838945, loss_d: 0.266692
0.6897 --- loss: 1.155863, loss_ss: 0.777627, loss_d: 0.378236
0.7280 --- loss: 1.496541, loss_ss: 1.009333, loss_d: 0.487208
0.7663 --- loss: 1.062526, loss_ss: 0.874748, loss_d: 0.187779
0.8046 --- loss: 1.219575, loss_ss: 0.820611, loss_d: 0.398964
0.8429 --- loss: 1.108257, loss_ss: 0.853342, loss_d: 0.254914
0.8812 --- loss: 1.476391, loss_ss: 1.040921, loss_d: 0.435469
0.9195 --- loss: 1.042275, loss_ss: 0.695459, loss_d: 0.346816
0.9579 --- loss: 1.140913, loss_ss: 0.863126, loss_d: 0.277787
0.9962 --- loss: 1.567034, loss_ss: 1.119016, loss_d: 0.448018
Epoch finished! Loss: 1.1834852264477655
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.977788, loss_ss: 0.735869, loss_d: 0.241919
0.0383 --- loss: 1.262652, loss_ss: 0.770162, loss_d: 0.492490
0.0766 --- loss: 1.441966, loss_ss: 1.172264, loss_d: 0.269702
0.1149 --- loss: 0.745125, loss_ss: 0.580356, loss_d: 0.164769
0.1533 --- loss: 1.093014, loss_ss: 0.884240, loss_d: 0.208774
0.1916 --- loss: 1.455812, loss_ss: 1.242279, loss_d: 0.213533
0.2299 --- loss: 0.750884, loss_ss: 0.610978, loss_d: 0.139905
0.2682 --- loss: 0.868134, loss_ss: 0.538242, loss_d: 0.329893
0.3065 --- loss: 1.097952, loss_ss: 0.937444, loss_d: 0.160508
0.3448 --- loss: 1.114574, loss_ss: 0.915610, loss_d: 0.198964
0.3831 --- loss: 1.444037, loss_ss: 0.922290, loss_d: 0.521747
0.4215 --- loss: 1.408106, loss_ss: 0.955558, loss_d: 0.452548
0.4598 --- loss: 1.304399, loss_ss: 1.070972, loss_d: 0.233426
0.4981 --- loss: 0.901429, loss_ss: 0.710646, loss_d: 0.190783
0.5364 --- loss: 1.234330, loss_ss: 0.851922, loss_d: 0.382408
0.5747 --- loss: 1.252868, loss_ss: 0.906748, loss_d: 0.346120
0.6130 --- loss: 1.021528, loss_ss: 0.766900, loss_d: 0.254628
0.6513 --- loss: 1.102180, loss_ss: 0.904453, loss_d: 0.197727
0.6897 --- loss: 1.249125, loss_ss: 1.109861, loss_d: 0.139264
0.7280 --- loss: 1.084001, loss_ss: 0.977412, loss_d: 0.106589
0.7663 --- loss: 1.491160, loss_ss: 0.993824, loss_d: 0.497335
0.8046 --- loss: 1.458159, loss_ss: 0.803898, loss_d: 0.654261
0.8429 --- loss: 0.866275, loss_ss: 0.660553, loss_d: 0.205722
0.8812 --- loss: 1.074133, loss_ss: 0.709337, loss_d: 0.364796
0.9195 --- loss: 1.283286, loss_ss: 1.062677, loss_d: 0.220609
0.9579 --- loss: 1.186673, loss_ss: 0.711998, loss_d: 0.474675
0.9962 --- loss: 1.004154, loss_ss: 0.674003, loss_d: 0.330151
Epoch finished! Loss: 1.1588204454917175
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6833333333333333
             precision    recall  f1-score   support

        0.0       0.85      0.89      0.87       123
        1.0       0.00      0.00      0.00        43
        2.0       0.70      0.94      0.80       400
        3.0       1.00      0.04      0.08       193
        4.0       0.48      1.00      0.65        81

avg / total       0.73      0.68      0.59       840
 


====== chc010-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  96.07   89.43   97.21   84.62     86.96
1  94.88    0.00  100.00    0.00      0.00
2  78.10   93.75   63.86   70.22     80.30
3  77.98    4.15  100.00  100.00      7.96
4  89.64  100.00   88.54   48.21     65.06
Total accuracy: 68.33%
Average sen: 57.47%
Average spec: 89.92%
Macro f1-score: 48.06%
Diagnosis acc on 15mins: 0.8571428571428571
[0.99276638 0.99994659 0.99999726 0.93098658 0.17807214 0.25036478
 0.28057611 0.19899659 0.26319301 0.15948904 0.41210076 0.18164445
 0.18468574 0.13376255 0.09134978 0.11950123 0.22627121 0.21411982
 0.16779381 0.19431257 0.22763167 0.13194837 0.18993808 0.15835202
 0.1210958  0.20537296 0.16299082 0.24103394]
pred: 0.30779621723507133, label: 0
Right! Diagnosis: Other

=== Test on chc012-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.315178, loss_ss: 1.666759, loss_d: 0.648419
0.0383 --- loss: 2.017721, loss_ss: 1.427492, loss_d: 0.590228
0.0767 --- loss: 2.060034, loss_ss: 1.443089, loss_d: 0.616945
0.1150 --- loss: 1.822645, loss_ss: 1.286847, loss_d: 0.535798
0.1534 --- loss: 2.057308, loss_ss: 1.495859, loss_d: 0.561449
0.1917 --- loss: 2.193279, loss_ss: 1.513320, loss_d: 0.679959
0.2301 --- loss: 1.885555, loss_ss: 1.259738, loss_d: 0.625818
0.2684 --- loss: 1.984651, loss_ss: 1.358758, loss_d: 0.625894
0.3067 --- loss: 1.928578, loss_ss: 1.328161, loss_d: 0.600418
0.3451 --- loss: 1.930924, loss_ss: 1.319215, loss_d: 0.611709
0.3834 --- loss: 2.033320, loss_ss: 1.239887, loss_d: 0.793433
0.4218 --- loss: 1.959575, loss_ss: 1.233547, loss_d: 0.726027
0.4601 --- loss: 1.884238, loss_ss: 1.343192, loss_d: 0.541045
0.4985 --- loss: 1.927639, loss_ss: 1.380723, loss_d: 0.546916
0.5368 --- loss: 1.737952, loss_ss: 1.171219, loss_d: 0.566732
0.5752 --- loss: 2.113361, loss_ss: 1.104750, loss_d: 1.008611
0.6135 --- loss: 2.012276, loss_ss: 1.574087, loss_d: 0.438189
0.6518 --- loss: 1.946002, loss_ss: 1.181082, loss_d: 0.764920
0.6902 --- loss: 1.502942, loss_ss: 1.050336, loss_d: 0.452605
0.7285 --- loss: 1.462176, loss_ss: 1.140132, loss_d: 0.322044
0.7669 --- loss: 1.768348, loss_ss: 1.152843, loss_d: 0.615505
0.8052 --- loss: 1.831066, loss_ss: 1.224320, loss_d: 0.606746
0.8436 --- loss: 1.703411, loss_ss: 1.037977, loss_d: 0.665434
0.8819 --- loss: 2.163453, loss_ss: 1.465505, loss_d: 0.697947
0.9202 --- loss: 1.683993, loss_ss: 1.238683, loss_d: 0.445309
0.9586 --- loss: 2.523783, loss_ss: 1.547520, loss_d: 0.976263
0.9969 --- loss: 1.917925, loss_ss: 1.381334, loss_d: 0.536591
Epoch finished! Loss: 1.880594662978099
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.834373, loss_ss: 1.336194, loss_d: 0.498178
0.0383 --- loss: 1.804078, loss_ss: 1.241961, loss_d: 0.562118
0.0767 --- loss: 1.857095, loss_ss: 1.133714, loss_d: 0.723380
0.1150 --- loss: 1.710159, loss_ss: 1.223421, loss_d: 0.486738
0.1534 --- loss: 1.593607, loss_ss: 1.185202, loss_d: 0.408406
0.1917 --- loss: 1.610155, loss_ss: 1.086003, loss_d: 0.524152
0.2301 --- loss: 1.512048, loss_ss: 0.999076, loss_d: 0.512972
0.2684 --- loss: 1.573461, loss_ss: 1.154308, loss_d: 0.419153
0.3067 --- loss: 1.622644, loss_ss: 1.088131, loss_d: 0.534514
0.3451 --- loss: 1.672139, loss_ss: 1.112670, loss_d: 0.559470
0.3834 --- loss: 1.553443, loss_ss: 0.985535, loss_d: 0.567908
0.4218 --- loss: 1.441265, loss_ss: 1.199528, loss_d: 0.241736
0.4601 --- loss: 1.707272, loss_ss: 1.025425, loss_d: 0.681847
0.4985 --- loss: 1.772617, loss_ss: 1.040350, loss_d: 0.732267
0.5368 --- loss: 1.728703, loss_ss: 1.078362, loss_d: 0.650341
0.5752 --- loss: 1.636905, loss_ss: 1.139571, loss_d: 0.497334
0.6135 --- loss: 1.890834, loss_ss: 1.288667, loss_d: 0.602167
0.6518 --- loss: 1.512362, loss_ss: 0.916451, loss_d: 0.595911
0.6902 --- loss: 1.629235, loss_ss: 1.107741, loss_d: 0.521495
0.7285 --- loss: 2.127005, loss_ss: 1.273300, loss_d: 0.853704
0.7669 --- loss: 1.552647, loss_ss: 1.022206, loss_d: 0.530441
0.8052 --- loss: 1.572896, loss_ss: 0.955517, loss_d: 0.617379
0.8436 --- loss: 1.353637, loss_ss: 0.833372, loss_d: 0.520265
0.8819 --- loss: 1.400190, loss_ss: 0.928308, loss_d: 0.471882
0.9202 --- loss: 1.749165, loss_ss: 1.182782, loss_d: 0.566384
0.9586 --- loss: 1.590364, loss_ss: 0.999263, loss_d: 0.591101
0.9969 --- loss: 1.533242, loss_ss: 0.979627, loss_d: 0.553615
Epoch finished! Loss: 1.692386019229889
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.506886, loss_ss: 1.113210, loss_d: 0.393676
0.0383 --- loss: 1.555174, loss_ss: 0.948887, loss_d: 0.606287
0.0767 --- loss: 1.567576, loss_ss: 1.231323, loss_d: 0.336253
0.1150 --- loss: 1.654483, loss_ss: 1.255715, loss_d: 0.398768
0.1534 --- loss: 1.346097, loss_ss: 0.945563, loss_d: 0.400535
0.1917 --- loss: 1.454264, loss_ss: 0.923090, loss_d: 0.531174
0.2301 --- loss: 1.528070, loss_ss: 0.903075, loss_d: 0.624995
0.2684 --- loss: 1.995358, loss_ss: 1.164559, loss_d: 0.830799
0.3067 --- loss: 1.905543, loss_ss: 1.182945, loss_d: 0.722598
0.3451 --- loss: 1.450667, loss_ss: 0.981205, loss_d: 0.469462
0.3834 --- loss: 1.693783, loss_ss: 1.123495, loss_d: 0.570288
0.4218 --- loss: 1.742075, loss_ss: 1.063155, loss_d: 0.678920
0.4601 --- loss: 1.438454, loss_ss: 1.080497, loss_d: 0.357958
0.4985 --- loss: 1.825596, loss_ss: 1.412917, loss_d: 0.412679
0.5368 --- loss: 1.308992, loss_ss: 0.830653, loss_d: 0.478339
0.5752 --- loss: 1.314814, loss_ss: 0.842625, loss_d: 0.472189
0.6135 --- loss: 1.691396, loss_ss: 0.944389, loss_d: 0.747008
0.6518 --- loss: 1.625237, loss_ss: 1.126958, loss_d: 0.498279
0.6902 --- loss: 1.314557, loss_ss: 0.758776, loss_d: 0.555781
0.7285 --- loss: 1.555577, loss_ss: 1.006949, loss_d: 0.548628
0.7669 --- loss: 1.403428, loss_ss: 0.994073, loss_d: 0.409356
0.8052 --- loss: 1.543198, loss_ss: 0.982872, loss_d: 0.560327
0.8436 --- loss: 1.307568, loss_ss: 0.837443, loss_d: 0.470125
0.8819 --- loss: 1.719143, loss_ss: 0.777454, loss_d: 0.941689
0.9202 --- loss: 1.448781, loss_ss: 0.963789, loss_d: 0.484993
0.9586 --- loss: 1.385580, loss_ss: 1.034951, loss_d: 0.350629
0.9969 --- loss: 1.615857, loss_ss: 0.971236, loss_d: 0.644620
Epoch finished! Loss: 1.552176466354957
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.247770, loss_ss: 0.864793, loss_d: 0.382977
0.0383 --- loss: 1.056345, loss_ss: 0.791412, loss_d: 0.264933
0.0767 --- loss: 1.141199, loss_ss: 0.663848, loss_d: 0.477351
0.1150 --- loss: 1.399600, loss_ss: 0.756803, loss_d: 0.642797
0.1534 --- loss: 1.273561, loss_ss: 0.962647, loss_d: 0.310914
0.1917 --- loss: 2.052374, loss_ss: 1.076819, loss_d: 0.975555
0.2301 --- loss: 1.092141, loss_ss: 0.697590, loss_d: 0.394551
0.2684 --- loss: 1.338777, loss_ss: 0.818071, loss_d: 0.520705
0.3067 --- loss: 1.696096, loss_ss: 1.126101, loss_d: 0.569996
0.3451 --- loss: 1.203338, loss_ss: 0.601845, loss_d: 0.601493
0.3834 --- loss: 2.024278, loss_ss: 1.265110, loss_d: 0.759168
0.4218 --- loss: 1.456668, loss_ss: 1.213892, loss_d: 0.242776
0.4601 --- loss: 1.347410, loss_ss: 0.974872, loss_d: 0.372538
0.4985 --- loss: 1.394626, loss_ss: 1.021411, loss_d: 0.373215
0.5368 --- loss: 1.057777, loss_ss: 0.791753, loss_d: 0.266024
0.5752 --- loss: 1.258083, loss_ss: 0.880584, loss_d: 0.377499
0.6135 --- loss: 1.191664, loss_ss: 0.879882, loss_d: 0.311783
0.6518 --- loss: 0.980171, loss_ss: 0.825327, loss_d: 0.154843
0.6902 --- loss: 1.281161, loss_ss: 0.839255, loss_d: 0.441907
0.7285 --- loss: 2.389879, loss_ss: 1.690304, loss_d: 0.699575
0.7669 --- loss: 1.449631, loss_ss: 1.036335, loss_d: 0.413296
0.8052 --- loss: 1.230079, loss_ss: 0.907802, loss_d: 0.322278
0.8436 --- loss: 1.456970, loss_ss: 1.110251, loss_d: 0.346718
0.8819 --- loss: 1.364376, loss_ss: 0.883571, loss_d: 0.480805
0.9202 --- loss: 1.071765, loss_ss: 0.800112, loss_d: 0.271653
0.9586 --- loss: 1.251740, loss_ss: 0.843737, loss_d: 0.408003
0.9969 --- loss: 2.234652, loss_ss: 1.258866, loss_d: 0.975786
Epoch finished! Loss: 1.4325080156326293
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.652322, loss_ss: 1.175262, loss_d: 0.477059
0.0383 --- loss: 1.337224, loss_ss: 0.945115, loss_d: 0.392110
0.0767 --- loss: 1.722344, loss_ss: 0.639004, loss_d: 1.083340
0.1150 --- loss: 1.375117, loss_ss: 0.882227, loss_d: 0.492890
0.1534 --- loss: 1.585361, loss_ss: 1.093817, loss_d: 0.491545
0.1917 --- loss: 1.256402, loss_ss: 0.866426, loss_d: 0.389976
0.2301 --- loss: 1.374951, loss_ss: 0.773815, loss_d: 0.601136
0.2684 --- loss: 1.440818, loss_ss: 1.000266, loss_d: 0.440552
0.3067 --- loss: 1.456474, loss_ss: 0.891019, loss_d: 0.565456
0.3451 --- loss: 1.281043, loss_ss: 0.684704, loss_d: 0.596339
0.3834 --- loss: 1.283236, loss_ss: 1.092166, loss_d: 0.191070
0.4218 --- loss: 1.401735, loss_ss: 1.068185, loss_d: 0.333550
0.4601 --- loss: 1.407690, loss_ss: 0.943758, loss_d: 0.463932
0.4985 --- loss: 1.164132, loss_ss: 0.788916, loss_d: 0.375216
0.5368 --- loss: 1.244622, loss_ss: 0.981370, loss_d: 0.263253
0.5752 --- loss: 1.005251, loss_ss: 0.809814, loss_d: 0.195437
0.6135 --- loss: 1.867710, loss_ss: 1.483762, loss_d: 0.383948
0.6518 --- loss: 1.468917, loss_ss: 1.069267, loss_d: 0.399650
0.6902 --- loss: 1.167531, loss_ss: 0.780479, loss_d: 0.387052
0.7285 --- loss: 1.403945, loss_ss: 0.928117, loss_d: 0.475828
0.7669 --- loss: 1.613219, loss_ss: 0.849311, loss_d: 0.763908
0.8052 --- loss: 1.508024, loss_ss: 1.061483, loss_d: 0.446540
0.8436 --- loss: 1.083471, loss_ss: 0.710388, loss_d: 0.373084
0.8819 --- loss: 1.538956, loss_ss: 0.972318, loss_d: 0.566638
0.9202 --- loss: 1.345404, loss_ss: 1.045965, loss_d: 0.299439
0.9586 --- loss: 1.097237, loss_ss: 0.848519, loss_d: 0.248718
0.9969 --- loss: 1.641378, loss_ss: 0.912761, loss_d: 0.728618
Epoch finished! Loss: 1.3876706334260793
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.699686, loss_ss: 0.971857, loss_d: 0.727829
0.0383 --- loss: 0.850826, loss_ss: 0.693016, loss_d: 0.157810
0.0767 --- loss: 1.689661, loss_ss: 1.243743, loss_d: 0.445917
0.1150 --- loss: 1.601346, loss_ss: 0.938451, loss_d: 0.662895
0.1534 --- loss: 1.293637, loss_ss: 0.757837, loss_d: 0.535800
0.1917 --- loss: 1.212112, loss_ss: 0.784258, loss_d: 0.427854
0.2301 --- loss: 1.159455, loss_ss: 0.758054, loss_d: 0.401401
0.2684 --- loss: 1.151244, loss_ss: 0.888332, loss_d: 0.262912
0.3067 --- loss: 1.297868, loss_ss: 0.989148, loss_d: 0.308720
0.3451 --- loss: 0.990288, loss_ss: 0.701933, loss_d: 0.288356
0.3834 --- loss: 2.232276, loss_ss: 1.097210, loss_d: 1.135066
0.4218 --- loss: 1.530125, loss_ss: 0.997542, loss_d: 0.532583
0.4601 --- loss: 1.607524, loss_ss: 1.110763, loss_d: 0.496762
0.4985 --- loss: 1.257369, loss_ss: 0.840963, loss_d: 0.416406
0.5368 --- loss: 1.823313, loss_ss: 1.201523, loss_d: 0.621790
0.5752 --- loss: 1.029833, loss_ss: 0.654439, loss_d: 0.375394
0.6135 --- loss: 1.079396, loss_ss: 0.735319, loss_d: 0.344077
0.6518 --- loss: 1.377200, loss_ss: 0.732316, loss_d: 0.644884
0.6902 --- loss: 1.083045, loss_ss: 0.808066, loss_d: 0.274979
0.7285 --- loss: 1.257652, loss_ss: 0.797862, loss_d: 0.459789
0.7669 --- loss: 1.078453, loss_ss: 0.827175, loss_d: 0.251278
0.8052 --- loss: 0.992364, loss_ss: 0.744023, loss_d: 0.248341
0.8436 --- loss: 1.278819, loss_ss: 1.067489, loss_d: 0.211331
0.8819 --- loss: 1.006746, loss_ss: 0.621989, loss_d: 0.384757
0.9202 --- loss: 1.844946, loss_ss: 0.720950, loss_d: 1.123996
0.9586 --- loss: 1.359621, loss_ss: 0.956555, loss_d: 0.403066
0.9969 --- loss: 1.628503, loss_ss: 0.904784, loss_d: 0.723719
Epoch finished! Loss: 1.3194308443711353
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.097498, loss_ss: 0.675355, loss_d: 0.422143
0.0383 --- loss: 1.043834, loss_ss: 0.794052, loss_d: 0.249781
0.0767 --- loss: 1.356564, loss_ss: 0.898562, loss_d: 0.458002
0.1150 --- loss: 1.367040, loss_ss: 0.805412, loss_d: 0.561629
0.1534 --- loss: 1.333734, loss_ss: 0.929656, loss_d: 0.404078
0.1917 --- loss: 1.171184, loss_ss: 0.949183, loss_d: 0.222001
0.2301 --- loss: 1.376555, loss_ss: 1.130129, loss_d: 0.246426
0.2684 --- loss: 1.095229, loss_ss: 0.886675, loss_d: 0.208554
0.3067 --- loss: 1.395812, loss_ss: 0.933798, loss_d: 0.462014
0.3451 --- loss: 1.054048, loss_ss: 0.792599, loss_d: 0.261450
0.3834 --- loss: 1.201717, loss_ss: 0.786465, loss_d: 0.415252
0.4218 --- loss: 1.322491, loss_ss: 0.808845, loss_d: 0.513646
0.4601 --- loss: 0.917192, loss_ss: 0.715889, loss_d: 0.201303
0.4985 --- loss: 1.760774, loss_ss: 1.325725, loss_d: 0.435049
0.5368 --- loss: 1.595249, loss_ss: 1.104516, loss_d: 0.490732
0.5752 --- loss: 1.785922, loss_ss: 0.925708, loss_d: 0.860214
0.6135 --- loss: 0.931514, loss_ss: 0.620727, loss_d: 0.310787
0.6518 --- loss: 0.909001, loss_ss: 0.648914, loss_d: 0.260086
0.6902 --- loss: 1.339032, loss_ss: 1.043696, loss_d: 0.295336
0.7285 --- loss: 1.329277, loss_ss: 0.993088, loss_d: 0.336189
0.7669 --- loss: 1.108730, loss_ss: 0.923273, loss_d: 0.185457
0.8052 --- loss: 1.264286, loss_ss: 0.997462, loss_d: 0.266823
0.8436 --- loss: 1.110021, loss_ss: 0.936873, loss_d: 0.173148
0.8819 --- loss: 1.648008, loss_ss: 1.369203, loss_d: 0.278805
0.9202 --- loss: 0.982643, loss_ss: 0.722261, loss_d: 0.260382
0.9586 --- loss: 1.197823, loss_ss: 0.882050, loss_d: 0.315773
0.9969 --- loss: 1.371014, loss_ss: 1.062399, loss_d: 0.308615
Epoch finished! Loss: 1.2769069479062007
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.595649, loss_ss: 1.433919, loss_d: 0.161730
0.0383 --- loss: 1.051919, loss_ss: 0.750991, loss_d: 0.300927
0.0767 --- loss: 1.036713, loss_ss: 0.761930, loss_d: 0.274784
0.1150 --- loss: 0.975704, loss_ss: 0.765020, loss_d: 0.210684
0.1534 --- loss: 1.426615, loss_ss: 0.824833, loss_d: 0.601781
0.1917 --- loss: 0.965293, loss_ss: 0.789167, loss_d: 0.176126
0.2301 --- loss: 1.516517, loss_ss: 1.132405, loss_d: 0.384112
0.2684 --- loss: 1.190155, loss_ss: 0.691410, loss_d: 0.498746
0.3067 --- loss: 1.632325, loss_ss: 1.122604, loss_d: 0.509721
0.3451 --- loss: 1.898869, loss_ss: 0.740982, loss_d: 1.157887
0.3834 --- loss: 1.242899, loss_ss: 0.874138, loss_d: 0.368761
0.4218 --- loss: 1.238282, loss_ss: 0.973798, loss_d: 0.264484
0.4601 --- loss: 0.734334, loss_ss: 0.516340, loss_d: 0.217995
0.4985 --- loss: 1.168796, loss_ss: 0.835434, loss_d: 0.333362
0.5368 --- loss: 1.575443, loss_ss: 0.884159, loss_d: 0.691285
0.5752 --- loss: 1.270811, loss_ss: 0.665122, loss_d: 0.605688
0.6135 --- loss: 1.094610, loss_ss: 0.831206, loss_d: 0.263403
0.6518 --- loss: 1.287603, loss_ss: 0.985400, loss_d: 0.302203
0.6902 --- loss: 1.357236, loss_ss: 1.156341, loss_d: 0.200895
0.7285 --- loss: 1.941485, loss_ss: 1.002972, loss_d: 0.938512
0.7669 --- loss: 1.280572, loss_ss: 0.738395, loss_d: 0.542177
0.8052 --- loss: 1.602731, loss_ss: 1.174371, loss_d: 0.428360
0.8436 --- loss: 1.455339, loss_ss: 1.014593, loss_d: 0.440747
0.8819 --- loss: 1.538025, loss_ss: 0.922937, loss_d: 0.615088
0.9202 --- loss: 1.183070, loss_ss: 0.843156, loss_d: 0.339914
0.9586 --- loss: 1.078169, loss_ss: 0.747733, loss_d: 0.330436
0.9969 --- loss: 1.236609, loss_ss: 0.853392, loss_d: 0.383217
Epoch finished! Loss: 1.2443664358212398
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.335834, loss_ss: 0.857786, loss_d: 0.478048
0.0383 --- loss: 0.882069, loss_ss: 0.686919, loss_d: 0.195150
0.0767 --- loss: 1.608400, loss_ss: 1.051584, loss_d: 0.556816
0.1150 --- loss: 1.268533, loss_ss: 1.034621, loss_d: 0.233912
0.1534 --- loss: 1.080234, loss_ss: 0.754283, loss_d: 0.325950
0.1917 --- loss: 0.955284, loss_ss: 0.696082, loss_d: 0.259202
0.2301 --- loss: 1.063790, loss_ss: 0.655663, loss_d: 0.408126
0.2684 --- loss: 1.119690, loss_ss: 0.765001, loss_d: 0.354690
0.3067 --- loss: 1.522321, loss_ss: 0.822502, loss_d: 0.699819
0.3451 --- loss: 1.505610, loss_ss: 1.208046, loss_d: 0.297564
0.3834 --- loss: 1.307414, loss_ss: 0.880626, loss_d: 0.426789
0.4218 --- loss: 1.142408, loss_ss: 0.612997, loss_d: 0.529411
0.4601 --- loss: 1.042497, loss_ss: 0.918204, loss_d: 0.124293
0.4985 --- loss: 1.181078, loss_ss: 0.990573, loss_d: 0.190505
0.5368 --- loss: 1.380519, loss_ss: 1.031017, loss_d: 0.349502
0.5752 --- loss: 1.233369, loss_ss: 1.049730, loss_d: 0.183639
0.6135 --- loss: 0.914392, loss_ss: 0.710731, loss_d: 0.203661
0.6518 --- loss: 0.938023, loss_ss: 0.822112, loss_d: 0.115911
0.6902 --- loss: 1.129139, loss_ss: 0.825025, loss_d: 0.304114
0.7285 --- loss: 0.928510, loss_ss: 0.809985, loss_d: 0.118525
0.7669 --- loss: 0.845311, loss_ss: 0.703194, loss_d: 0.142117
0.8052 --- loss: 1.093719, loss_ss: 0.563703, loss_d: 0.530017
0.8436 --- loss: 1.021193, loss_ss: 0.748800, loss_d: 0.272393
0.8819 --- loss: 1.344394, loss_ss: 0.894434, loss_d: 0.449960
0.9202 --- loss: 1.060433, loss_ss: 0.852127, loss_d: 0.208306
0.9586 --- loss: 0.843424, loss_ss: 0.648103, loss_d: 0.195322
0.9969 --- loss: 0.968576, loss_ss: 0.666655, loss_d: 0.301921
Epoch finished! Loss: 1.207426300415626
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.120454, loss_ss: 0.726189, loss_d: 0.394265
0.0383 --- loss: 0.874270, loss_ss: 0.744752, loss_d: 0.129518
0.0767 --- loss: 0.991409, loss_ss: 0.733423, loss_d: 0.257986
0.1150 --- loss: 1.671449, loss_ss: 0.966439, loss_d: 0.705011
0.1534 --- loss: 1.476215, loss_ss: 1.053597, loss_d: 0.422618
0.1917 --- loss: 1.188328, loss_ss: 1.023842, loss_d: 0.164486
0.2301 --- loss: 1.078832, loss_ss: 0.898637, loss_d: 0.180194
0.2684 --- loss: 1.055730, loss_ss: 0.730900, loss_d: 0.324830
0.3067 --- loss: 1.008539, loss_ss: 0.761082, loss_d: 0.247457
0.3451 --- loss: 1.431198, loss_ss: 0.755969, loss_d: 0.675229
0.3834 --- loss: 1.291035, loss_ss: 1.102420, loss_d: 0.188615
0.4218 --- loss: 1.099578, loss_ss: 0.986356, loss_d: 0.113222
0.4601 --- loss: 1.018104, loss_ss: 0.711490, loss_d: 0.306614
0.4985 --- loss: 1.143026, loss_ss: 0.827950, loss_d: 0.315076
0.5368 --- loss: 1.251543, loss_ss: 0.790659, loss_d: 0.460884
0.5752 --- loss: 1.331050, loss_ss: 0.840674, loss_d: 0.490376
0.6135 --- loss: 0.820551, loss_ss: 0.692341, loss_d: 0.128210
0.6518 --- loss: 1.087998, loss_ss: 0.729575, loss_d: 0.358422
0.6902 --- loss: 1.099381, loss_ss: 0.758096, loss_d: 0.341285
0.7285 --- loss: 1.052662, loss_ss: 0.816343, loss_d: 0.236319
0.7669 --- loss: 1.069733, loss_ss: 0.817153, loss_d: 0.252580
0.8052 --- loss: 1.233280, loss_ss: 0.766341, loss_d: 0.466939
0.8436 --- loss: 0.702644, loss_ss: 0.607375, loss_d: 0.095269
0.8819 --- loss: 0.977706, loss_ss: 0.894213, loss_d: 0.083493
0.9202 --- loss: 1.174379, loss_ss: 0.833604, loss_d: 0.340775
0.9586 --- loss: 1.475958, loss_ss: 1.007138, loss_d: 0.468820
0.9969 --- loss: 2.262147, loss_ss: 1.238855, loss_d: 1.023292
Epoch finished! Loss: 1.1609282594460708
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7833333333333333
             precision    recall  f1-score   support

        0.0       0.42      0.62      0.50        63
        1.0       0.17      0.05      0.07        22
        2.0       0.94      0.79      0.86       541
        3.0       0.96      0.87      0.91       204
        4.0       0.38      0.87      0.53        70

avg / total       0.84      0.78      0.80       900
 


====== chc012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.33  61.90   93.55  41.94     50.00
1  97.11   4.55   99.43  16.67      7.14
2  84.22  78.74   92.48  94.04     85.71
3  96.22  87.25   98.85  95.70     91.28
4  87.78  87.14   87.83  37.65     52.59
Total accuracy: 78.33%
Average sen: 63.92%
Average spec: 94.43%
Macro f1-score: 57.35%
Diagnosis acc on 15mins: 0.0
[0.82987863 0.90243053 0.97500211 0.9724406  0.9328385  0.97310549
 0.9677335  0.96771854 0.9518292  0.92971247 0.90005761 0.96999145
 0.97342336 0.97323745 0.9437955  0.97197604 0.94817954 0.92146343
 0.90131342 0.88114649 0.98051685 0.97530341 0.97195697 0.68391925
 0.67887539 0.72100323 0.88531291 0.96661758 0.96323031 0.97084302]
pred: 0.9194950938224793, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc013-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.285163, loss_ss: 1.580355, loss_d: 0.704808
0.0384 --- loss: 2.213166, loss_ss: 1.581358, loss_d: 0.631808
0.0767 --- loss: 1.987865, loss_ss: 1.500079, loss_d: 0.487786
0.1151 --- loss: 2.065392, loss_ss: 1.447442, loss_d: 0.617950
0.1534 --- loss: 1.925190, loss_ss: 1.418028, loss_d: 0.507162
0.1918 --- loss: 2.044407, loss_ss: 1.357593, loss_d: 0.686814
0.2301 --- loss: 1.917641, loss_ss: 1.294555, loss_d: 0.623086
0.2685 --- loss: 1.833914, loss_ss: 1.325434, loss_d: 0.508480
0.3069 --- loss: 2.028708, loss_ss: 1.373889, loss_d: 0.654818
0.3452 --- loss: 2.111942, loss_ss: 1.365114, loss_d: 0.746828
0.3836 --- loss: 2.025514, loss_ss: 1.273927, loss_d: 0.751587
0.4219 --- loss: 1.930632, loss_ss: 1.352253, loss_d: 0.578379
0.4603 --- loss: 2.176205, loss_ss: 1.519841, loss_d: 0.656364
0.4987 --- loss: 1.826300, loss_ss: 1.296600, loss_d: 0.529700
0.5370 --- loss: 1.941544, loss_ss: 1.306987, loss_d: 0.634557
0.5754 --- loss: 2.142924, loss_ss: 1.599875, loss_d: 0.543049
0.6137 --- loss: 1.805640, loss_ss: 1.152038, loss_d: 0.653603
0.6521 --- loss: 1.946979, loss_ss: 1.233969, loss_d: 0.713010
0.6904 --- loss: 1.846277, loss_ss: 1.184666, loss_d: 0.661610
0.7288 --- loss: 1.980973, loss_ss: 1.344019, loss_d: 0.636954
0.7672 --- loss: 2.014194, loss_ss: 1.247269, loss_d: 0.766925
0.8055 --- loss: 2.077197, loss_ss: 1.390790, loss_d: 0.686407
0.8439 --- loss: 1.756398, loss_ss: 1.118860, loss_d: 0.637538
0.8822 --- loss: 1.856093, loss_ss: 1.453794, loss_d: 0.402299
0.9206 --- loss: 1.889444, loss_ss: 1.329668, loss_d: 0.559776
0.9590 --- loss: 1.956023, loss_ss: 1.178138, loss_d: 0.777884
0.9973 --- loss: 1.644104, loss_ss: 1.127408, loss_d: 0.516696
Epoch finished! Loss: 1.9248406336857722
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.800992, loss_ss: 1.184738, loss_d: 0.616255
0.0384 --- loss: 1.447204, loss_ss: 1.142782, loss_d: 0.304422
0.0767 --- loss: 1.577730, loss_ss: 1.187238, loss_d: 0.390492
0.1151 --- loss: 1.746485, loss_ss: 1.116904, loss_d: 0.629580
0.1534 --- loss: 1.696064, loss_ss: 1.176552, loss_d: 0.519512
0.1918 --- loss: 1.546466, loss_ss: 0.956463, loss_d: 0.590003
0.2301 --- loss: 2.025346, loss_ss: 1.250571, loss_d: 0.774775
0.2685 --- loss: 1.370945, loss_ss: 0.917066, loss_d: 0.453879
0.3069 --- loss: 1.311132, loss_ss: 0.989495, loss_d: 0.321637
0.3452 --- loss: 1.689630, loss_ss: 1.057799, loss_d: 0.631831
0.3836 --- loss: 1.645729, loss_ss: 1.135757, loss_d: 0.509972
0.4219 --- loss: 1.599851, loss_ss: 0.918573, loss_d: 0.681277
0.4603 --- loss: 1.711257, loss_ss: 1.289110, loss_d: 0.422146
0.4987 --- loss: 1.426001, loss_ss: 0.972776, loss_d: 0.453225
0.5370 --- loss: 1.484535, loss_ss: 0.844303, loss_d: 0.640231
0.5754 --- loss: 1.826168, loss_ss: 1.083443, loss_d: 0.742725
0.6137 --- loss: 2.053792, loss_ss: 1.330284, loss_d: 0.723508
0.6521 --- loss: 1.572826, loss_ss: 0.944672, loss_d: 0.628153
0.6904 --- loss: 1.711866, loss_ss: 1.156099, loss_d: 0.555767
0.7288 --- loss: 1.847641, loss_ss: 1.150213, loss_d: 0.697428
0.7672 --- loss: 1.652272, loss_ss: 1.048431, loss_d: 0.603840
0.8055 --- loss: 1.854796, loss_ss: 1.526917, loss_d: 0.327880
0.8439 --- loss: 1.489348, loss_ss: 0.926967, loss_d: 0.562381
0.8822 --- loss: 1.544220, loss_ss: 1.050009, loss_d: 0.494210
0.9206 --- loss: 1.659679, loss_ss: 1.099104, loss_d: 0.560575
0.9590 --- loss: 1.431505, loss_ss: 1.116393, loss_d: 0.315112
0.9973 --- loss: 1.443985, loss_ss: 0.971867, loss_d: 0.472118
Epoch finished! Loss: 1.6948021223911873
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.815130, loss_ss: 1.049694, loss_d: 0.765436
0.0384 --- loss: 1.720658, loss_ss: 1.199921, loss_d: 0.520738
0.0767 --- loss: 1.605852, loss_ss: 0.818645, loss_d: 0.787207
0.1151 --- loss: 1.566514, loss_ss: 1.010566, loss_d: 0.555948
0.1534 --- loss: 1.556854, loss_ss: 1.015391, loss_d: 0.541462
0.1918 --- loss: 1.382733, loss_ss: 1.008433, loss_d: 0.374300
0.2301 --- loss: 1.734077, loss_ss: 1.181309, loss_d: 0.552769
0.2685 --- loss: 2.070961, loss_ss: 1.514880, loss_d: 0.556082
0.3069 --- loss: 1.549957, loss_ss: 0.892297, loss_d: 0.657660
0.3452 --- loss: 1.566475, loss_ss: 0.824355, loss_d: 0.742121
0.3836 --- loss: 1.544084, loss_ss: 1.069021, loss_d: 0.475063
0.4219 --- loss: 1.897762, loss_ss: 1.271834, loss_d: 0.625928
0.4603 --- loss: 1.607242, loss_ss: 1.099442, loss_d: 0.507800
0.4987 --- loss: 1.267150, loss_ss: 0.964167, loss_d: 0.302983
0.5370 --- loss: 1.431583, loss_ss: 0.862537, loss_d: 0.569046
0.5754 --- loss: 1.797867, loss_ss: 1.003365, loss_d: 0.794502
0.6137 --- loss: 1.773774, loss_ss: 0.884506, loss_d: 0.889268
0.6521 --- loss: 1.884753, loss_ss: 1.255023, loss_d: 0.629729
0.6904 --- loss: 1.971795, loss_ss: 1.113765, loss_d: 0.858030
0.7288 --- loss: 1.697745, loss_ss: 1.305104, loss_d: 0.392642
0.7672 --- loss: 1.681248, loss_ss: 1.063320, loss_d: 0.617928
0.8055 --- loss: 1.618303, loss_ss: 0.978756, loss_d: 0.639547
0.8439 --- loss: 1.606292, loss_ss: 0.833054, loss_d: 0.773238
0.8822 --- loss: 1.644705, loss_ss: 1.057393, loss_d: 0.587312
0.9206 --- loss: 1.408981, loss_ss: 0.871004, loss_d: 0.537977
0.9590 --- loss: 1.453874, loss_ss: 0.980283, loss_d: 0.473591
0.9973 --- loss: 1.518299, loss_ss: 1.066870, loss_d: 0.451429
Epoch finished! Loss: 1.6077776697965769
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.700351, loss_ss: 1.026412, loss_d: 0.673939
0.0384 --- loss: 1.948683, loss_ss: 1.115459, loss_d: 0.833224
0.0767 --- loss: 1.478272, loss_ss: 0.937088, loss_d: 0.541184
0.1151 --- loss: 1.733597, loss_ss: 1.074359, loss_d: 0.659238
0.1534 --- loss: 1.445215, loss_ss: 0.744821, loss_d: 0.700394
0.1918 --- loss: 1.535125, loss_ss: 1.000192, loss_d: 0.534933
0.2301 --- loss: 1.786662, loss_ss: 1.095684, loss_d: 0.690978
0.2685 --- loss: 1.654942, loss_ss: 1.098618, loss_d: 0.556324
0.3069 --- loss: 0.996411, loss_ss: 0.815107, loss_d: 0.181304
0.3452 --- loss: 1.564582, loss_ss: 1.221703, loss_d: 0.342878
0.3836 --- loss: 1.302443, loss_ss: 0.877510, loss_d: 0.424933
0.4219 --- loss: 1.229710, loss_ss: 0.897351, loss_d: 0.332359
0.4603 --- loss: 1.518806, loss_ss: 1.054509, loss_d: 0.464297
0.4987 --- loss: 1.413623, loss_ss: 0.849970, loss_d: 0.563653
0.5370 --- loss: 1.440753, loss_ss: 0.991500, loss_d: 0.449253
0.5754 --- loss: 1.439171, loss_ss: 0.911335, loss_d: 0.527835
0.6137 --- loss: 1.201291, loss_ss: 0.801751, loss_d: 0.399540
0.6521 --- loss: 1.593208, loss_ss: 0.844363, loss_d: 0.748845
0.6904 --- loss: 1.913158, loss_ss: 1.257663, loss_d: 0.655495
0.7288 --- loss: 1.572200, loss_ss: 1.170022, loss_d: 0.402178
0.7672 --- loss: 1.299170, loss_ss: 0.838237, loss_d: 0.460933
0.8055 --- loss: 1.322587, loss_ss: 0.873343, loss_d: 0.449244
0.8439 --- loss: 1.197644, loss_ss: 0.851617, loss_d: 0.346027
0.8822 --- loss: 1.220929, loss_ss: 0.944590, loss_d: 0.276340
0.9206 --- loss: 1.645864, loss_ss: 1.100377, loss_d: 0.545487
0.9590 --- loss: 1.546659, loss_ss: 1.118926, loss_d: 0.427733
0.9973 --- loss: 1.560754, loss_ss: 1.208341, loss_d: 0.352413
Epoch finished! Loss: 1.5232416895719676
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.604865, loss_ss: 0.895932, loss_d: 0.708934
0.0384 --- loss: 1.864724, loss_ss: 0.945376, loss_d: 0.919348
0.0767 --- loss: 1.332942, loss_ss: 1.041167, loss_d: 0.291776
0.1151 --- loss: 1.794478, loss_ss: 1.136060, loss_d: 0.658418
0.1534 --- loss: 1.153074, loss_ss: 0.826705, loss_d: 0.326369
0.1918 --- loss: 1.748782, loss_ss: 1.118375, loss_d: 0.630407
0.2301 --- loss: 1.410669, loss_ss: 0.909968, loss_d: 0.500700
0.2685 --- loss: 1.219613, loss_ss: 0.890716, loss_d: 0.328897
0.3069 --- loss: 1.554058, loss_ss: 1.196306, loss_d: 0.357752
0.3452 --- loss: 1.297979, loss_ss: 1.106399, loss_d: 0.191580
0.3836 --- loss: 1.513624, loss_ss: 0.899430, loss_d: 0.614193
0.4219 --- loss: 1.412156, loss_ss: 1.074021, loss_d: 0.338135
0.4603 --- loss: 1.417612, loss_ss: 1.007647, loss_d: 0.409965
0.4987 --- loss: 1.588938, loss_ss: 1.108147, loss_d: 0.480790
0.5370 --- loss: 1.515830, loss_ss: 1.164073, loss_d: 0.351757
0.5754 --- loss: 1.253209, loss_ss: 0.807223, loss_d: 0.445985
0.6137 --- loss: 1.442061, loss_ss: 1.075420, loss_d: 0.366642
0.6521 --- loss: 1.265370, loss_ss: 1.041395, loss_d: 0.223975
0.6904 --- loss: 1.515567, loss_ss: 0.865624, loss_d: 0.649943
0.7288 --- loss: 1.398825, loss_ss: 1.014067, loss_d: 0.384759
0.7672 --- loss: 1.272230, loss_ss: 0.792613, loss_d: 0.479617
0.8055 --- loss: 1.653843, loss_ss: 1.324813, loss_d: 0.329030
0.8439 --- loss: 1.356597, loss_ss: 1.028624, loss_d: 0.327973
0.8822 --- loss: 1.014359, loss_ss: 0.824142, loss_d: 0.190218
0.9206 --- loss: 1.219777, loss_ss: 0.760445, loss_d: 0.459332
0.9590 --- loss: 1.858814, loss_ss: 1.140481, loss_d: 0.718333
0.9973 --- loss: 1.624853, loss_ss: 1.184908, loss_d: 0.439945
Epoch finished! Loss: 1.4349944653419349
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.224059, loss_ss: 0.831658, loss_d: 0.392401
0.0384 --- loss: 1.428170, loss_ss: 1.152284, loss_d: 0.275885
0.0767 --- loss: 1.403546, loss_ss: 0.853933, loss_d: 0.549612
0.1151 --- loss: 1.424592, loss_ss: 0.987455, loss_d: 0.437137
0.1534 --- loss: 1.547648, loss_ss: 1.107424, loss_d: 0.440224
0.1918 --- loss: 1.515862, loss_ss: 1.299400, loss_d: 0.216461
0.2301 --- loss: 1.576778, loss_ss: 0.761953, loss_d: 0.814824
0.2685 --- loss: 1.018042, loss_ss: 0.827076, loss_d: 0.190966
0.3069 --- loss: 1.315368, loss_ss: 0.913569, loss_d: 0.401799
0.3452 --- loss: 1.236949, loss_ss: 0.950416, loss_d: 0.286532
0.3836 --- loss: 1.743351, loss_ss: 1.028544, loss_d: 0.714807
0.4219 --- loss: 1.422044, loss_ss: 0.982391, loss_d: 0.439653
0.4603 --- loss: 1.001802, loss_ss: 0.690948, loss_d: 0.310854
0.4987 --- loss: 1.132202, loss_ss: 0.777390, loss_d: 0.354812
0.5370 --- loss: 1.234147, loss_ss: 1.065806, loss_d: 0.168342
0.5754 --- loss: 1.859241, loss_ss: 0.783975, loss_d: 1.075265
0.6137 --- loss: 1.244590, loss_ss: 0.830361, loss_d: 0.414229
0.6521 --- loss: 1.627313, loss_ss: 1.244308, loss_d: 0.383005
0.6904 --- loss: 1.146327, loss_ss: 0.782829, loss_d: 0.363499
0.7288 --- loss: 1.534865, loss_ss: 0.983072, loss_d: 0.551793
0.7672 --- loss: 1.989796, loss_ss: 1.340773, loss_d: 0.649023
0.8055 --- loss: 1.948888, loss_ss: 1.557245, loss_d: 0.391643
0.8439 --- loss: 1.200204, loss_ss: 0.849802, loss_d: 0.350403
0.8822 --- loss: 1.323455, loss_ss: 0.990815, loss_d: 0.332640
0.9206 --- loss: 1.361958, loss_ss: 1.155055, loss_d: 0.206903
0.9590 --- loss: 1.100186, loss_ss: 0.871607, loss_d: 0.228579
0.9973 --- loss: 1.327704, loss_ss: 0.884214, loss_d: 0.443490
Epoch finished! Loss: 1.3591642971222218
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.079934, loss_ss: 0.864693, loss_d: 0.215241
0.0384 --- loss: 1.296197, loss_ss: 0.646712, loss_d: 0.649485
0.0767 --- loss: 1.160437, loss_ss: 0.900472, loss_d: 0.259964
0.1151 --- loss: 1.096708, loss_ss: 0.825919, loss_d: 0.270789
0.1534 --- loss: 1.205525, loss_ss: 0.878537, loss_d: 0.326988
0.1918 --- loss: 1.385664, loss_ss: 1.129131, loss_d: 0.256533
0.2301 --- loss: 1.124723, loss_ss: 0.827016, loss_d: 0.297707
0.2685 --- loss: 1.249377, loss_ss: 0.904370, loss_d: 0.345008
0.3069 --- loss: 1.304840, loss_ss: 1.013220, loss_d: 0.291619
0.3452 --- loss: 1.032410, loss_ss: 0.797856, loss_d: 0.234555
0.3836 --- loss: 1.009829, loss_ss: 0.782884, loss_d: 0.226945
0.4219 --- loss: 1.007248, loss_ss: 0.840547, loss_d: 0.166701
0.4603 --- loss: 1.042328, loss_ss: 0.904239, loss_d: 0.138089
0.4987 --- loss: 1.287611, loss_ss: 0.822000, loss_d: 0.465611
0.5370 --- loss: 1.134650, loss_ss: 0.718999, loss_d: 0.415651
0.5754 --- loss: 1.451170, loss_ss: 0.978110, loss_d: 0.473061
0.6137 --- loss: 1.568158, loss_ss: 0.978148, loss_d: 0.590010
0.6521 --- loss: 1.242893, loss_ss: 0.980171, loss_d: 0.262722
0.6904 --- loss: 0.896236, loss_ss: 0.675746, loss_d: 0.220490
0.7288 --- loss: 1.625449, loss_ss: 0.929880, loss_d: 0.695569
0.7672 --- loss: 0.890684, loss_ss: 0.601359, loss_d: 0.289325
0.8055 --- loss: 1.497693, loss_ss: 1.072728, loss_d: 0.424965
0.8439 --- loss: 1.421270, loss_ss: 0.906851, loss_d: 0.514420
0.8822 --- loss: 1.062339, loss_ss: 0.836367, loss_d: 0.225971
0.9206 --- loss: 1.212626, loss_ss: 0.747442, loss_d: 0.465184
0.9590 --- loss: 1.291247, loss_ss: 0.977140, loss_d: 0.314107
0.9973 --- loss: 1.265181, loss_ss: 1.019153, loss_d: 0.246028
Epoch finished! Loss: 1.2854805973859933
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.047099, loss_ss: 0.789675, loss_d: 0.257424
0.0384 --- loss: 1.363048, loss_ss: 0.758645, loss_d: 0.604402
0.0767 --- loss: 1.292732, loss_ss: 0.858155, loss_d: 0.434576
0.1151 --- loss: 1.003711, loss_ss: 0.792220, loss_d: 0.211491
0.1534 --- loss: 1.007275, loss_ss: 0.805594, loss_d: 0.201681
0.1918 --- loss: 1.408430, loss_ss: 0.882555, loss_d: 0.525875
0.2301 --- loss: 1.162037, loss_ss: 0.915808, loss_d: 0.246230
0.2685 --- loss: 1.335655, loss_ss: 1.129937, loss_d: 0.205719
0.3069 --- loss: 0.848528, loss_ss: 0.710964, loss_d: 0.137564
0.3452 --- loss: 1.253221, loss_ss: 0.905311, loss_d: 0.347910
0.3836 --- loss: 1.212500, loss_ss: 0.702752, loss_d: 0.509748
0.4219 --- loss: 1.196943, loss_ss: 0.812325, loss_d: 0.384617
0.4603 --- loss: 1.204546, loss_ss: 0.970381, loss_d: 0.234166
0.4987 --- loss: 1.102269, loss_ss: 0.902666, loss_d: 0.199603
0.5370 --- loss: 1.190388, loss_ss: 0.916911, loss_d: 0.273477
0.5754 --- loss: 0.958774, loss_ss: 0.729830, loss_d: 0.228944
0.6137 --- loss: 1.411293, loss_ss: 0.801980, loss_d: 0.609313
0.6521 --- loss: 1.171979, loss_ss: 0.742355, loss_d: 0.429624
0.6904 --- loss: 1.217511, loss_ss: 0.806229, loss_d: 0.411282
0.7288 --- loss: 1.041973, loss_ss: 0.595734, loss_d: 0.446239
0.7672 --- loss: 1.241098, loss_ss: 0.996489, loss_d: 0.244609
0.8055 --- loss: 1.267547, loss_ss: 0.844538, loss_d: 0.423009
0.8439 --- loss: 1.045067, loss_ss: 0.899348, loss_d: 0.145719
0.8822 --- loss: 1.038179, loss_ss: 0.759216, loss_d: 0.278963
0.9206 --- loss: 1.169108, loss_ss: 0.981673, loss_d: 0.187435
0.9590 --- loss: 1.084678, loss_ss: 0.807767, loss_d: 0.276911
0.9973 --- loss: 1.470374, loss_ss: 1.075857, loss_d: 0.394517
Epoch finished! Loss: 1.2482225422675792
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.244253, loss_ss: 1.064894, loss_d: 0.179359
0.0384 --- loss: 0.880080, loss_ss: 0.685540, loss_d: 0.194540
0.0767 --- loss: 1.263101, loss_ss: 0.778852, loss_d: 0.484249
0.1151 --- loss: 1.025519, loss_ss: 0.919054, loss_d: 0.106465
0.1534 --- loss: 1.276300, loss_ss: 0.823786, loss_d: 0.452514
0.1918 --- loss: 1.551522, loss_ss: 0.930514, loss_d: 0.621009
0.2301 --- loss: 1.428867, loss_ss: 1.110541, loss_d: 0.318326
0.2685 --- loss: 1.274778, loss_ss: 0.869004, loss_d: 0.405774
0.3069 --- loss: 1.183981, loss_ss: 0.912720, loss_d: 0.271261
0.3452 --- loss: 0.968642, loss_ss: 0.706362, loss_d: 0.262281
0.3836 --- loss: 1.292080, loss_ss: 0.864909, loss_d: 0.427171
0.4219 --- loss: 0.984111, loss_ss: 0.751285, loss_d: 0.232826
0.4603 --- loss: 0.919366, loss_ss: 0.777225, loss_d: 0.142141
0.4987 --- loss: 1.640507, loss_ss: 1.069240, loss_d: 0.571267
0.5370 --- loss: 1.060647, loss_ss: 0.748241, loss_d: 0.312406
0.5754 --- loss: 1.416139, loss_ss: 1.213849, loss_d: 0.202290
0.6137 --- loss: 1.192750, loss_ss: 0.963875, loss_d: 0.228874
0.6521 --- loss: 1.462037, loss_ss: 1.101583, loss_d: 0.360454
0.6904 --- loss: 1.186382, loss_ss: 0.817088, loss_d: 0.369294
0.7288 --- loss: 0.807323, loss_ss: 0.609193, loss_d: 0.198129
0.7672 --- loss: 1.349904, loss_ss: 0.965772, loss_d: 0.384132
0.8055 --- loss: 0.817837, loss_ss: 0.666634, loss_d: 0.151202
0.8439 --- loss: 0.919722, loss_ss: 0.775797, loss_d: 0.143925
0.8822 --- loss: 0.824874, loss_ss: 0.722974, loss_d: 0.101900
0.9206 --- loss: 1.081549, loss_ss: 0.912688, loss_d: 0.168860
0.9590 --- loss: 1.148900, loss_ss: 0.990573, loss_d: 0.158328
0.9973 --- loss: 0.836217, loss_ss: 0.658452, loss_d: 0.177766
Epoch finished! Loss: 1.2082247885373922
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.798883, loss_ss: 0.652302, loss_d: 0.146582
0.0384 --- loss: 1.343398, loss_ss: 0.888923, loss_d: 0.454474
0.0767 --- loss: 1.252046, loss_ss: 0.763391, loss_d: 0.488654
0.1151 --- loss: 1.240031, loss_ss: 0.926903, loss_d: 0.313128
0.1534 --- loss: 1.153185, loss_ss: 0.666124, loss_d: 0.487061
0.1918 --- loss: 1.195479, loss_ss: 0.890844, loss_d: 0.304635
0.2301 --- loss: 1.281612, loss_ss: 0.687486, loss_d: 0.594126
0.2685 --- loss: 1.259584, loss_ss: 0.805215, loss_d: 0.454370
0.3069 --- loss: 1.366389, loss_ss: 1.063201, loss_d: 0.303188
0.3452 --- loss: 1.160120, loss_ss: 0.924226, loss_d: 0.235893
0.3836 --- loss: 1.258206, loss_ss: 1.000682, loss_d: 0.257524
0.4219 --- loss: 1.051478, loss_ss: 0.838506, loss_d: 0.212972
0.4603 --- loss: 1.145017, loss_ss: 0.960717, loss_d: 0.184300
0.4987 --- loss: 1.477315, loss_ss: 1.056875, loss_d: 0.420440
0.5370 --- loss: 1.077120, loss_ss: 0.857981, loss_d: 0.219139
0.5754 --- loss: 0.796751, loss_ss: 0.502809, loss_d: 0.293942
0.6137 --- loss: 0.868215, loss_ss: 0.742456, loss_d: 0.125759
0.6521 --- loss: 1.156897, loss_ss: 0.706708, loss_d: 0.450189
0.6904 --- loss: 1.087335, loss_ss: 0.695976, loss_d: 0.391359
0.7288 --- loss: 1.719800, loss_ss: 0.685694, loss_d: 1.034106
0.7672 --- loss: 1.609770, loss_ss: 1.394653, loss_d: 0.215117
0.8055 --- loss: 1.398406, loss_ss: 1.202343, loss_d: 0.196062
0.8439 --- loss: 1.870065, loss_ss: 1.126688, loss_d: 0.743378
0.8822 --- loss: 0.933695, loss_ss: 0.708846, loss_d: 0.224849
0.9206 --- loss: 1.011360, loss_ss: 0.859456, loss_d: 0.151904
0.9590 --- loss: 1.063115, loss_ss: 0.829594, loss_d: 0.233521
0.9973 --- loss: 1.144727, loss_ss: 0.972790, loss_d: 0.171938
Epoch finished! Loss: 1.2123844334712395
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6978494623655914
             precision    recall  f1-score   support

        0.0       0.47      0.94      0.63        69
        1.0       0.20      0.05      0.08        38
        2.0       0.75      0.74      0.74       434
        3.0       1.00      0.54      0.70       228
        4.0       0.60      0.86      0.71       161

avg / total       0.74      0.70      0.69       930
 


====== chc013-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.72  94.20   91.52   47.10     62.80
1  95.27   5.26   99.10   20.00      8.33
2  76.34  73.96   78.43   75.00     74.48
3  88.60  53.51  100.00  100.00     69.71
4  87.63  86.34   87.91   59.91     70.74
Total accuracy: 69.78%
Average sen: 62.65%
Average spec: 91.39%
Macro f1-score: 57.21%
Diagnosis acc on 15mins: 0.12903225806451613
[0.93858349 0.99496692 0.41913289 0.93681961 0.5527792  0.35535949
 0.75618428 0.99374878 0.67245781 0.49971253 0.58530623 0.763322
 0.785622   0.94754136 0.81353539 0.79788053 0.91444081 0.72823
 0.82583386 0.67662662 0.94477075 0.66470438 0.77877259 0.60119677
 0.54275632 0.83523822 0.57629204 0.7816807  0.49453107 0.89558339
 0.54329693]
pred: 0.7295776442173989, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc014-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.569797, loss_ss: 1.833921, loss_d: 0.735876
0.0384 --- loss: 2.286714, loss_ss: 1.568187, loss_d: 0.718526
0.0767 --- loss: 2.133252, loss_ss: 1.518921, loss_d: 0.614331
0.1151 --- loss: 2.196980, loss_ss: 1.479441, loss_d: 0.717539
0.1534 --- loss: 1.921287, loss_ss: 1.407680, loss_d: 0.513607
0.1918 --- loss: 1.822192, loss_ss: 1.409001, loss_d: 0.413191
0.2301 --- loss: 1.766843, loss_ss: 1.386129, loss_d: 0.380714
0.2685 --- loss: 2.541277, loss_ss: 1.434445, loss_d: 1.106832
0.3069 --- loss: 2.070971, loss_ss: 1.373420, loss_d: 0.697551
0.3452 --- loss: 1.579744, loss_ss: 1.289626, loss_d: 0.290118
0.3836 --- loss: 1.784217, loss_ss: 1.386361, loss_d: 0.397855
0.4219 --- loss: 1.815422, loss_ss: 1.314418, loss_d: 0.501004
0.4603 --- loss: 1.838464, loss_ss: 1.354769, loss_d: 0.483695
0.4987 --- loss: 1.718184, loss_ss: 1.192707, loss_d: 0.525477
0.5370 --- loss: 1.906092, loss_ss: 1.172922, loss_d: 0.733170
0.5754 --- loss: 1.832678, loss_ss: 1.338631, loss_d: 0.494046
0.6137 --- loss: 1.715200, loss_ss: 1.185324, loss_d: 0.529876
0.6521 --- loss: 1.824708, loss_ss: 1.168110, loss_d: 0.656598
0.6904 --- loss: 1.986425, loss_ss: 1.506979, loss_d: 0.479445
0.7288 --- loss: 1.706717, loss_ss: 1.239921, loss_d: 0.466796
0.7672 --- loss: 1.747751, loss_ss: 1.201248, loss_d: 0.546503
0.8055 --- loss: 1.889836, loss_ss: 1.272702, loss_d: 0.617134
0.8439 --- loss: 1.695969, loss_ss: 1.173211, loss_d: 0.522758
0.8822 --- loss: 1.567417, loss_ss: 1.122171, loss_d: 0.445246
0.9206 --- loss: 1.795412, loss_ss: 1.314871, loss_d: 0.480541
0.9590 --- loss: 2.178722, loss_ss: 1.533964, loss_d: 0.644758
0.9973 --- loss: 2.160955, loss_ss: 1.085635, loss_d: 1.075320
Epoch finished! Loss: 1.9080323008390574
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.051790, loss_ss: 1.264087, loss_d: 0.787702
0.0384 --- loss: 1.657054, loss_ss: 1.086777, loss_d: 0.570277
0.0767 --- loss: 1.696647, loss_ss: 1.017692, loss_d: 0.678955
0.1151 --- loss: 1.727915, loss_ss: 1.213438, loss_d: 0.514477
0.1534 --- loss: 1.819109, loss_ss: 1.160886, loss_d: 0.658223
0.1918 --- loss: 1.889011, loss_ss: 1.255613, loss_d: 0.633398
0.2301 --- loss: 1.810513, loss_ss: 1.117437, loss_d: 0.693075
0.2685 --- loss: 1.945398, loss_ss: 1.455364, loss_d: 0.490033
0.3069 --- loss: 1.524130, loss_ss: 1.008150, loss_d: 0.515980
0.3452 --- loss: 1.475898, loss_ss: 1.033342, loss_d: 0.442556
0.3836 --- loss: 1.668614, loss_ss: 1.256267, loss_d: 0.412347
0.4219 --- loss: 2.150840, loss_ss: 1.740614, loss_d: 0.410226
0.4603 --- loss: 1.807570, loss_ss: 1.319949, loss_d: 0.487620
0.4987 --- loss: 1.951474, loss_ss: 0.990424, loss_d: 0.961051
0.5370 --- loss: 1.456471, loss_ss: 0.918316, loss_d: 0.538155
0.5754 --- loss: 1.873047, loss_ss: 1.267227, loss_d: 0.605820
0.6137 --- loss: 1.663250, loss_ss: 1.364996, loss_d: 0.298254
0.6521 --- loss: 1.535869, loss_ss: 1.035198, loss_d: 0.500670
0.6904 --- loss: 1.784938, loss_ss: 1.130952, loss_d: 0.653985
0.7288 --- loss: 1.836551, loss_ss: 1.296247, loss_d: 0.540305
0.7672 --- loss: 1.775801, loss_ss: 1.148723, loss_d: 0.627079
0.8055 --- loss: 1.960320, loss_ss: 1.322810, loss_d: 0.637509
0.8439 --- loss: 1.757160, loss_ss: 1.222643, loss_d: 0.534517
0.8822 --- loss: 1.914998, loss_ss: 1.180705, loss_d: 0.734293
0.9206 --- loss: 1.808987, loss_ss: 1.109166, loss_d: 0.699821
0.9590 --- loss: 1.506645, loss_ss: 0.901548, loss_d: 0.605097
0.9973 --- loss: 1.802541, loss_ss: 1.346363, loss_d: 0.456177
Epoch finished! Loss: 1.6868632568762854
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.585863, loss_ss: 0.939936, loss_d: 0.645927
0.0384 --- loss: 1.343187, loss_ss: 0.925981, loss_d: 0.417206
0.0767 --- loss: 1.544996, loss_ss: 0.879500, loss_d: 0.665495
0.1151 --- loss: 1.244022, loss_ss: 0.877946, loss_d: 0.366076
0.1534 --- loss: 1.711009, loss_ss: 1.005127, loss_d: 0.705882
0.1918 --- loss: 1.525431, loss_ss: 0.882865, loss_d: 0.642566
0.2301 --- loss: 1.720070, loss_ss: 1.043760, loss_d: 0.676310
0.2685 --- loss: 1.483603, loss_ss: 0.918985, loss_d: 0.564619
0.3069 --- loss: 1.694657, loss_ss: 0.980960, loss_d: 0.713697
0.3452 --- loss: 1.468019, loss_ss: 1.076183, loss_d: 0.391836
0.3836 --- loss: 1.554154, loss_ss: 1.074401, loss_d: 0.479753
0.4219 --- loss: 1.743400, loss_ss: 1.025014, loss_d: 0.718386
0.4603 --- loss: 1.634042, loss_ss: 0.976379, loss_d: 0.657663
0.4987 --- loss: 1.628195, loss_ss: 1.055425, loss_d: 0.572770
0.5370 --- loss: 1.568779, loss_ss: 1.000525, loss_d: 0.568254
0.5754 --- loss: 1.458425, loss_ss: 0.888576, loss_d: 0.569848
0.6137 --- loss: 1.394551, loss_ss: 0.912404, loss_d: 0.482147
0.6521 --- loss: 2.068489, loss_ss: 1.210718, loss_d: 0.857771
0.6904 --- loss: 1.654550, loss_ss: 1.038991, loss_d: 0.615559
0.7288 --- loss: 1.597628, loss_ss: 1.094769, loss_d: 0.502859
0.7672 --- loss: 1.701601, loss_ss: 1.330804, loss_d: 0.370797
0.8055 --- loss: 1.256488, loss_ss: 0.707986, loss_d: 0.548503
0.8439 --- loss: 1.743856, loss_ss: 1.204392, loss_d: 0.539464
0.8822 --- loss: 1.329036, loss_ss: 0.858494, loss_d: 0.470543
0.9206 --- loss: 1.566923, loss_ss: 0.934632, loss_d: 0.632291
0.9590 --- loss: 1.548788, loss_ss: 1.091234, loss_d: 0.457553
0.9973 --- loss: 2.021066, loss_ss: 0.957866, loss_d: 1.063200
Epoch finished! Loss: 1.589147769487821
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.254142, loss_ss: 0.878641, loss_d: 0.375501
0.0384 --- loss: 1.250099, loss_ss: 0.846325, loss_d: 0.403774
0.0767 --- loss: 1.634348, loss_ss: 1.103692, loss_d: 0.530657
0.1151 --- loss: 1.236061, loss_ss: 0.851540, loss_d: 0.384521
0.1534 --- loss: 1.442415, loss_ss: 0.959445, loss_d: 0.482970
0.1918 --- loss: 1.913655, loss_ss: 1.240813, loss_d: 0.672842
0.2301 --- loss: 1.455926, loss_ss: 1.153800, loss_d: 0.302126
0.2685 --- loss: 1.656870, loss_ss: 1.038070, loss_d: 0.618800
0.3069 --- loss: 1.699559, loss_ss: 0.866279, loss_d: 0.833280
0.3452 --- loss: 1.909678, loss_ss: 0.789925, loss_d: 1.119752
0.3836 --- loss: 1.440185, loss_ss: 0.829058, loss_d: 0.611127
0.4219 --- loss: 1.963761, loss_ss: 1.580165, loss_d: 0.383596
0.4603 --- loss: 1.648384, loss_ss: 1.310056, loss_d: 0.338328
0.4987 --- loss: 1.613405, loss_ss: 0.936546, loss_d: 0.676859
0.5370 --- loss: 1.688789, loss_ss: 1.072591, loss_d: 0.616198
0.5754 --- loss: 1.537581, loss_ss: 1.085387, loss_d: 0.452193
0.6137 --- loss: 1.530800, loss_ss: 0.959764, loss_d: 0.571036
0.6521 --- loss: 1.330211, loss_ss: 0.762530, loss_d: 0.567681
0.6904 --- loss: 1.480984, loss_ss: 1.027932, loss_d: 0.453052
0.7288 --- loss: 1.354667, loss_ss: 0.789101, loss_d: 0.565566
0.7672 --- loss: 1.210389, loss_ss: 0.784473, loss_d: 0.425915
0.8055 --- loss: 1.347190, loss_ss: 0.874862, loss_d: 0.472328
0.8439 --- loss: 1.542250, loss_ss: 1.184930, loss_d: 0.357320
0.8822 --- loss: 1.796519, loss_ss: 1.405760, loss_d: 0.390759
0.9206 --- loss: 1.614774, loss_ss: 0.973729, loss_d: 0.641046
0.9590 --- loss: 1.578019, loss_ss: 1.145910, loss_d: 0.432109
0.9973 --- loss: 1.717100, loss_ss: 1.443150, loss_d: 0.273950
Epoch finished! Loss: 1.5288346125529362
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.271467, loss_ss: 0.994899, loss_d: 0.276568
0.0384 --- loss: 1.737520, loss_ss: 1.233537, loss_d: 0.503984
0.0767 --- loss: 1.196411, loss_ss: 0.696989, loss_d: 0.499422
0.1151 --- loss: 1.627176, loss_ss: 1.276872, loss_d: 0.350304
0.1534 --- loss: 1.300264, loss_ss: 0.867164, loss_d: 0.433101
0.1918 --- loss: 1.472429, loss_ss: 0.823034, loss_d: 0.649395
0.2301 --- loss: 1.992394, loss_ss: 0.934593, loss_d: 1.057801
0.2685 --- loss: 1.153409, loss_ss: 0.712671, loss_d: 0.440738
0.3069 --- loss: 1.120795, loss_ss: 0.778518, loss_d: 0.342277
0.3452 --- loss: 1.397467, loss_ss: 0.921023, loss_d: 0.476444
0.3836 --- loss: 1.638237, loss_ss: 0.844401, loss_d: 0.793835
0.4219 --- loss: 1.177950, loss_ss: 0.853465, loss_d: 0.324485
0.4603 --- loss: 1.248482, loss_ss: 0.872632, loss_d: 0.375850
0.4987 --- loss: 0.982560, loss_ss: 0.662226, loss_d: 0.320334
0.5370 --- loss: 1.509062, loss_ss: 0.922381, loss_d: 0.586681
0.5754 --- loss: 1.068603, loss_ss: 0.813496, loss_d: 0.255107
0.6137 --- loss: 1.559817, loss_ss: 0.810117, loss_d: 0.749700
0.6521 --- loss: 1.411804, loss_ss: 0.784656, loss_d: 0.627148
0.6904 --- loss: 1.656382, loss_ss: 1.189575, loss_d: 0.466807
0.7288 --- loss: 1.983349, loss_ss: 1.038193, loss_d: 0.945157
0.7672 --- loss: 1.252635, loss_ss: 0.960271, loss_d: 0.292364
0.8055 --- loss: 1.708814, loss_ss: 0.846622, loss_d: 0.862191
0.8439 --- loss: 1.412646, loss_ss: 1.176971, loss_d: 0.235675
0.8822 --- loss: 1.368655, loss_ss: 0.791257, loss_d: 0.577398
0.9206 --- loss: 1.267555, loss_ss: 0.706815, loss_d: 0.560740
0.9590 --- loss: 1.732399, loss_ss: 1.126581, loss_d: 0.605818
0.9973 --- loss: 1.102180, loss_ss: 0.871132, loss_d: 0.231048
Epoch finished! Loss: 1.445566912797781
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 2.049699, loss_ss: 1.771492, loss_d: 0.278206
0.0384 --- loss: 1.299750, loss_ss: 0.790352, loss_d: 0.509398
0.0767 --- loss: 1.367406, loss_ss: 0.876021, loss_d: 0.491385
0.1151 --- loss: 1.528471, loss_ss: 1.135555, loss_d: 0.392916
0.1534 --- loss: 1.032219, loss_ss: 0.601211, loss_d: 0.431008
0.1918 --- loss: 1.630108, loss_ss: 0.885077, loss_d: 0.745031
0.2301 --- loss: 1.117563, loss_ss: 0.710347, loss_d: 0.407216
0.2685 --- loss: 1.159148, loss_ss: 0.803315, loss_d: 0.355833
0.3069 --- loss: 1.302680, loss_ss: 0.889091, loss_d: 0.413588
0.3452 --- loss: 1.035884, loss_ss: 0.760527, loss_d: 0.275357
0.3836 --- loss: 1.211944, loss_ss: 0.873506, loss_d: 0.338438
0.4219 --- loss: 1.267859, loss_ss: 0.935893, loss_d: 0.331966
0.4603 --- loss: 1.409066, loss_ss: 0.966715, loss_d: 0.442352
0.4987 --- loss: 1.018766, loss_ss: 0.655349, loss_d: 0.363418
0.5370 --- loss: 1.374346, loss_ss: 0.938829, loss_d: 0.435518
0.5754 --- loss: 1.178872, loss_ss: 0.749951, loss_d: 0.428922
0.6137 --- loss: 1.438022, loss_ss: 0.824360, loss_d: 0.613662
0.6521 --- loss: 1.787861, loss_ss: 0.971433, loss_d: 0.816428
0.6904 --- loss: 1.372828, loss_ss: 1.044166, loss_d: 0.328662
0.7288 --- loss: 1.080386, loss_ss: 0.781887, loss_d: 0.298499
0.7672 --- loss: 1.281796, loss_ss: 0.977247, loss_d: 0.304549
0.8055 --- loss: 0.948324, loss_ss: 0.806057, loss_d: 0.142266
0.8439 --- loss: 1.580466, loss_ss: 0.972315, loss_d: 0.608151
0.8822 --- loss: 1.254574, loss_ss: 0.772126, loss_d: 0.482448
0.9206 --- loss: 1.631905, loss_ss: 1.073826, loss_d: 0.558079
0.9590 --- loss: 1.648014, loss_ss: 1.299551, loss_d: 0.348463
0.9973 --- loss: 1.106727, loss_ss: 0.702535, loss_d: 0.404192
Epoch finished! Loss: 1.3822993856209975
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.562964, loss_ss: 1.000403, loss_d: 0.562561
0.0384 --- loss: 1.478343, loss_ss: 0.836107, loss_d: 0.642235
0.0767 --- loss: 1.376864, loss_ss: 1.100037, loss_d: 0.276827
0.1151 --- loss: 0.942664, loss_ss: 0.702497, loss_d: 0.240167
0.1534 --- loss: 1.321252, loss_ss: 0.968288, loss_d: 0.352964
0.1918 --- loss: 1.267912, loss_ss: 1.044917, loss_d: 0.222995
0.2301 --- loss: 1.800127, loss_ss: 1.111731, loss_d: 0.688395
0.2685 --- loss: 1.662764, loss_ss: 0.732523, loss_d: 0.930242
0.3069 --- loss: 1.396476, loss_ss: 0.887360, loss_d: 0.509116
0.3452 --- loss: 1.054497, loss_ss: 0.772500, loss_d: 0.281997
0.3836 --- loss: 1.618397, loss_ss: 0.845534, loss_d: 0.772863
0.4219 --- loss: 0.999215, loss_ss: 0.801151, loss_d: 0.198064
0.4603 --- loss: 1.988004, loss_ss: 1.193920, loss_d: 0.794084
0.4987 --- loss: 1.265474, loss_ss: 0.830098, loss_d: 0.435376
0.5370 --- loss: 1.458326, loss_ss: 0.820387, loss_d: 0.637939
0.5754 --- loss: 1.230554, loss_ss: 0.956614, loss_d: 0.273940
0.6137 --- loss: 1.054931, loss_ss: 0.899806, loss_d: 0.155125
0.6521 --- loss: 1.519054, loss_ss: 0.983517, loss_d: 0.535538
0.6904 --- loss: 1.186783, loss_ss: 0.853400, loss_d: 0.333382
0.7288 --- loss: 1.184730, loss_ss: 0.794067, loss_d: 0.390663
0.7672 --- loss: 1.114904, loss_ss: 0.838111, loss_d: 0.276793
0.8055 --- loss: 1.215286, loss_ss: 1.018567, loss_d: 0.196719
0.8439 --- loss: 0.852351, loss_ss: 0.667994, loss_d: 0.184357
0.8822 --- loss: 1.427091, loss_ss: 1.013637, loss_d: 0.413454
0.9206 --- loss: 1.511106, loss_ss: 1.243116, loss_d: 0.267989
0.9590 --- loss: 1.135157, loss_ss: 0.869440, loss_d: 0.265716
0.9973 --- loss: 1.686432, loss_ss: 0.765014, loss_d: 0.921417
Epoch finished! Loss: 1.314749131523646
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.287358, loss_ss: 0.930521, loss_d: 0.356837
0.0384 --- loss: 1.523480, loss_ss: 1.076042, loss_d: 0.447438
0.0767 --- loss: 1.345566, loss_ss: 1.004539, loss_d: 0.341026
0.1151 --- loss: 1.185820, loss_ss: 0.843930, loss_d: 0.341890
0.1534 --- loss: 1.355969, loss_ss: 1.047365, loss_d: 0.308604
0.1918 --- loss: 1.597942, loss_ss: 0.623140, loss_d: 0.974802
0.2301 --- loss: 1.151994, loss_ss: 0.802417, loss_d: 0.349577
0.2685 --- loss: 0.879406, loss_ss: 0.727089, loss_d: 0.152317
0.3069 --- loss: 1.200850, loss_ss: 0.958719, loss_d: 0.242131
0.3452 --- loss: 1.124373, loss_ss: 0.906513, loss_d: 0.217861
0.3836 --- loss: 1.445637, loss_ss: 1.117939, loss_d: 0.327698
0.4219 --- loss: 0.906842, loss_ss: 0.586726, loss_d: 0.320116
0.4603 --- loss: 1.102009, loss_ss: 0.735601, loss_d: 0.366408
0.4987 --- loss: 1.336505, loss_ss: 0.791549, loss_d: 0.544956
0.5370 --- loss: 1.420864, loss_ss: 0.810134, loss_d: 0.610730
0.5754 --- loss: 1.230258, loss_ss: 0.615149, loss_d: 0.615108
0.6137 --- loss: 1.047307, loss_ss: 0.844693, loss_d: 0.202615
0.6521 --- loss: 1.322659, loss_ss: 1.113963, loss_d: 0.208696
0.6904 --- loss: 1.383223, loss_ss: 0.947942, loss_d: 0.435281
0.7288 --- loss: 1.365467, loss_ss: 0.918202, loss_d: 0.447266
0.7672 --- loss: 1.013633, loss_ss: 0.775009, loss_d: 0.238624
0.8055 --- loss: 1.084728, loss_ss: 0.758703, loss_d: 0.326025
0.8439 --- loss: 0.989774, loss_ss: 0.824703, loss_d: 0.165071
0.8822 --- loss: 0.876460, loss_ss: 0.745093, loss_d: 0.131367
0.9206 --- loss: 1.406107, loss_ss: 0.939354, loss_d: 0.466754
0.9590 --- loss: 1.077830, loss_ss: 0.773855, loss_d: 0.303975
0.9973 --- loss: 1.467390, loss_ss: 0.797138, loss_d: 0.670252
Epoch finished! Loss: 1.2701862293940325
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.162841, loss_ss: 1.002806, loss_d: 0.160036
0.0384 --- loss: 1.769572, loss_ss: 1.241301, loss_d: 0.528271
0.0767 --- loss: 0.942602, loss_ss: 0.771783, loss_d: 0.170819
0.1151 --- loss: 0.819497, loss_ss: 0.602426, loss_d: 0.217071
0.1534 --- loss: 1.359730, loss_ss: 0.940510, loss_d: 0.419221
0.1918 --- loss: 1.324446, loss_ss: 1.001246, loss_d: 0.323199
0.2301 --- loss: 1.371553, loss_ss: 1.081201, loss_d: 0.290352
0.2685 --- loss: 1.516906, loss_ss: 0.992299, loss_d: 0.524608
0.3069 --- loss: 0.770840, loss_ss: 0.689976, loss_d: 0.080864
0.3452 --- loss: 1.068601, loss_ss: 0.737816, loss_d: 0.330785
0.3836 --- loss: 0.961218, loss_ss: 0.712659, loss_d: 0.248560
0.4219 --- loss: 0.973032, loss_ss: 0.793725, loss_d: 0.179306
0.4603 --- loss: 1.408506, loss_ss: 1.002512, loss_d: 0.405994
0.4987 --- loss: 1.384794, loss_ss: 1.048746, loss_d: 0.336048
0.5370 --- loss: 1.105026, loss_ss: 0.847114, loss_d: 0.257912
0.5754 --- loss: 1.685888, loss_ss: 0.967365, loss_d: 0.718524
0.6137 --- loss: 1.169475, loss_ss: 0.756339, loss_d: 0.413136
0.6521 --- loss: 1.196355, loss_ss: 0.823191, loss_d: 0.373165
0.6904 --- loss: 0.992945, loss_ss: 0.780494, loss_d: 0.212451
0.7288 --- loss: 1.177477, loss_ss: 0.983692, loss_d: 0.193785
0.7672 --- loss: 0.887047, loss_ss: 0.754129, loss_d: 0.132918
0.8055 --- loss: 1.372579, loss_ss: 0.842242, loss_d: 0.530336
0.8439 --- loss: 1.342768, loss_ss: 0.775805, loss_d: 0.566962
0.8822 --- loss: 1.229793, loss_ss: 0.759325, loss_d: 0.470468
0.9206 --- loss: 0.997880, loss_ss: 0.833094, loss_d: 0.164787
0.9590 --- loss: 0.839437, loss_ss: 0.724227, loss_d: 0.115210
0.9973 --- loss: 2.262498, loss_ss: 0.834589, loss_d: 1.427908
Epoch finished! Loss: 1.2103649442012494
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.062750, loss_ss: 0.750824, loss_d: 0.311926
0.0384 --- loss: 1.457174, loss_ss: 0.960554, loss_d: 0.496621
0.0767 --- loss: 0.735424, loss_ss: 0.614283, loss_d: 0.121142
0.1151 --- loss: 1.272684, loss_ss: 0.802365, loss_d: 0.470319
0.1534 --- loss: 1.129560, loss_ss: 0.925340, loss_d: 0.204220
0.1918 --- loss: 1.050895, loss_ss: 0.834407, loss_d: 0.216488
0.2301 --- loss: 1.263858, loss_ss: 0.983400, loss_d: 0.280458
0.2685 --- loss: 0.982733, loss_ss: 0.799612, loss_d: 0.183121
0.3069 --- loss: 0.852242, loss_ss: 0.740392, loss_d: 0.111850
0.3452 --- loss: 1.172319, loss_ss: 1.050535, loss_d: 0.121783
0.3836 --- loss: 1.414195, loss_ss: 0.954591, loss_d: 0.459604
0.4219 --- loss: 1.066024, loss_ss: 0.724783, loss_d: 0.341242
0.4603 --- loss: 0.941341, loss_ss: 0.660354, loss_d: 0.280987
0.4987 --- loss: 1.051479, loss_ss: 0.820733, loss_d: 0.230746
0.5370 --- loss: 1.186688, loss_ss: 1.001257, loss_d: 0.185432
0.5754 --- loss: 0.976457, loss_ss: 0.794922, loss_d: 0.181535
0.6137 --- loss: 1.261821, loss_ss: 0.817055, loss_d: 0.444767
0.6521 --- loss: 1.104313, loss_ss: 0.614574, loss_d: 0.489739
0.6904 --- loss: 1.007986, loss_ss: 0.849957, loss_d: 0.158029
0.7288 --- loss: 0.782408, loss_ss: 0.693045, loss_d: 0.089363
0.7672 --- loss: 1.104049, loss_ss: 0.868487, loss_d: 0.235562
0.8055 --- loss: 1.291148, loss_ss: 1.019005, loss_d: 0.272143
0.8439 --- loss: 1.318485, loss_ss: 1.123886, loss_d: 0.194599
0.8822 --- loss: 1.124488, loss_ss: 0.831367, loss_d: 0.293121
0.9206 --- loss: 1.058312, loss_ss: 0.943666, loss_d: 0.114646
0.9590 --- loss: 1.203278, loss_ss: 0.835213, loss_d: 0.368065
0.9973 --- loss: 1.848693, loss_ss: 0.771489, loss_d: 1.077204
Epoch finished! Loss: 1.1683229501430805
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.9204301075268817
             precision    recall  f1-score   support

        0.0       0.95      1.00      0.97       240
        1.0       0.12      0.17      0.14         6
        2.0       0.92      0.92      0.92       439
        3.0       0.93      0.87      0.90       170
        4.0       0.91      0.83      0.87        75

avg / total       0.92      0.92      0.92       930
 


====== chc014-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  98.60  100.00   98.12  94.86     97.36
1  98.71   16.67   99.24  12.50     14.29
2  92.37   92.26   92.46  91.63     91.94
3  96.45   87.06   98.55  93.08     89.97
4  97.96   82.67   99.30  91.18     86.71
Total accuracy: 92.04%
Average sen: 75.73%
Average spec: 97.53%
Macro f1-score: 76.05%
Diagnosis acc on 15mins: 0.22580645161290322
[0.75596261 0.74609989 0.86588192 0.75997627 0.29762217 0.74196023
 0.65626121 0.72995055 0.70190001 0.78373384 0.73020297 0.6706751
 0.65880978 0.45014891 0.62450153 0.74281418 0.96045607 0.71289426
 0.78125    0.30756694 0.25118732 0.57883996 0.80283749 0.48422348
 0.93515229 0.54134566 0.57262999 0.43230897 0.37831783 0.71688479
 0.94493783]
pred: 0.6553978727709863, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc015-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.381981, loss_ss: 1.653545, loss_d: 0.728436
0.0384 --- loss: 2.176254, loss_ss: 1.653398, loss_d: 0.522856
0.0767 --- loss: 2.088556, loss_ss: 1.555908, loss_d: 0.532648
0.1151 --- loss: 1.989153, loss_ss: 1.442839, loss_d: 0.546314
0.1534 --- loss: 2.180053, loss_ss: 1.288455, loss_d: 0.891599
0.1918 --- loss: 1.960263, loss_ss: 1.370591, loss_d: 0.589673
0.2301 --- loss: 2.219921, loss_ss: 1.489434, loss_d: 0.730486
0.2685 --- loss: 2.041532, loss_ss: 1.554542, loss_d: 0.486990
0.3069 --- loss: 2.051455, loss_ss: 1.310364, loss_d: 0.741091
0.3452 --- loss: 1.809410, loss_ss: 1.291687, loss_d: 0.517723
0.3836 --- loss: 2.105764, loss_ss: 1.320444, loss_d: 0.785320
0.4219 --- loss: 2.007760, loss_ss: 1.374170, loss_d: 0.633590
0.4603 --- loss: 1.873708, loss_ss: 1.420331, loss_d: 0.453377
0.4987 --- loss: 1.805824, loss_ss: 1.179544, loss_d: 0.626280
0.5370 --- loss: 2.088411, loss_ss: 1.337142, loss_d: 0.751269
0.5754 --- loss: 2.024379, loss_ss: 1.534410, loss_d: 0.489969
0.6137 --- loss: 1.965999, loss_ss: 1.374829, loss_d: 0.591171
0.6521 --- loss: 1.623161, loss_ss: 1.242211, loss_d: 0.380951
0.6904 --- loss: 1.587497, loss_ss: 1.076365, loss_d: 0.511132
0.7288 --- loss: 1.836083, loss_ss: 1.228883, loss_d: 0.607200
0.7672 --- loss: 1.363482, loss_ss: 1.030230, loss_d: 0.333252
0.8055 --- loss: 1.764021, loss_ss: 1.163602, loss_d: 0.600419
0.8439 --- loss: 1.973188, loss_ss: 1.229841, loss_d: 0.743348
0.8822 --- loss: 1.415226, loss_ss: 1.055888, loss_d: 0.359337
0.9206 --- loss: 1.650280, loss_ss: 1.235205, loss_d: 0.415075
0.9590 --- loss: 1.580135, loss_ss: 1.107710, loss_d: 0.472425
0.9973 --- loss: 1.932177, loss_ss: 1.173588, loss_d: 0.758589
Epoch finished! Loss: 1.8824284227994772
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.902943, loss_ss: 1.161487, loss_d: 0.741456
0.0384 --- loss: 1.977708, loss_ss: 1.101223, loss_d: 0.876484
0.0767 --- loss: 1.581286, loss_ss: 1.076028, loss_d: 0.505259
0.1151 --- loss: 1.820131, loss_ss: 1.183903, loss_d: 0.636227
0.1534 --- loss: 1.792928, loss_ss: 1.193643, loss_d: 0.599284
0.1918 --- loss: 1.324872, loss_ss: 0.868626, loss_d: 0.456246
0.2301 --- loss: 1.634568, loss_ss: 1.162693, loss_d: 0.471875
0.2685 --- loss: 1.541747, loss_ss: 1.144641, loss_d: 0.397106
0.3069 --- loss: 1.592899, loss_ss: 1.000303, loss_d: 0.592596
0.3452 --- loss: 1.768918, loss_ss: 1.227185, loss_d: 0.541732
0.3836 --- loss: 1.418914, loss_ss: 0.959739, loss_d: 0.459175
0.4219 --- loss: 1.598660, loss_ss: 1.103548, loss_d: 0.495112
0.4603 --- loss: 2.070661, loss_ss: 1.147620, loss_d: 0.923041
0.4987 --- loss: 1.660345, loss_ss: 1.169923, loss_d: 0.490422
0.5370 --- loss: 1.838364, loss_ss: 1.053293, loss_d: 0.785071
0.5754 --- loss: 1.763003, loss_ss: 1.338549, loss_d: 0.424453
0.6137 --- loss: 1.718170, loss_ss: 1.082413, loss_d: 0.635758
0.6521 --- loss: 1.548006, loss_ss: 0.928534, loss_d: 0.619472
0.6904 --- loss: 1.824517, loss_ss: 1.224816, loss_d: 0.599701
0.7288 --- loss: 1.265311, loss_ss: 0.850330, loss_d: 0.414982
0.7672 --- loss: 1.515477, loss_ss: 0.939856, loss_d: 0.575620
0.8055 --- loss: 1.519200, loss_ss: 1.038011, loss_d: 0.481189
0.8439 --- loss: 1.252074, loss_ss: 0.780507, loss_d: 0.471567
0.8822 --- loss: 1.615936, loss_ss: 1.102483, loss_d: 0.513453
0.9206 --- loss: 1.565016, loss_ss: 1.117303, loss_d: 0.447712
0.9590 --- loss: 1.164300, loss_ss: 0.846817, loss_d: 0.317483
0.9973 --- loss: 1.498861, loss_ss: 1.052975, loss_d: 0.445886
Epoch finished! Loss: 1.6567021580842825
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.780090, loss_ss: 0.973408, loss_d: 0.806683
0.0384 --- loss: 1.781367, loss_ss: 1.249389, loss_d: 0.531978
0.0767 --- loss: 1.453777, loss_ss: 1.118567, loss_d: 0.335210
0.1151 --- loss: 1.571670, loss_ss: 1.032364, loss_d: 0.539306
0.1534 --- loss: 1.248707, loss_ss: 0.881446, loss_d: 0.367262
0.1918 --- loss: 1.689591, loss_ss: 0.981846, loss_d: 0.707745
0.2301 --- loss: 1.367595, loss_ss: 0.876661, loss_d: 0.490934
0.2685 --- loss: 1.622791, loss_ss: 1.176729, loss_d: 0.446062
0.3069 --- loss: 1.613772, loss_ss: 1.117825, loss_d: 0.495947
0.3452 --- loss: 1.500851, loss_ss: 0.912812, loss_d: 0.588039
0.3836 --- loss: 1.686445, loss_ss: 1.131592, loss_d: 0.554853
0.4219 --- loss: 1.669519, loss_ss: 0.971727, loss_d: 0.697792
0.4603 --- loss: 1.608172, loss_ss: 1.088044, loss_d: 0.520128
0.4987 --- loss: 1.634758, loss_ss: 0.837021, loss_d: 0.797737
0.5370 --- loss: 1.527224, loss_ss: 1.254918, loss_d: 0.272306
0.5754 --- loss: 1.744543, loss_ss: 0.899358, loss_d: 0.845185
0.6137 --- loss: 1.467041, loss_ss: 0.794152, loss_d: 0.672888
0.6521 --- loss: 1.782479, loss_ss: 1.265452, loss_d: 0.517027
0.6904 --- loss: 1.313918, loss_ss: 1.104843, loss_d: 0.209075
0.7288 --- loss: 1.694760, loss_ss: 1.275610, loss_d: 0.419149
0.7672 --- loss: 1.592251, loss_ss: 1.034948, loss_d: 0.557303
0.8055 --- loss: 1.534547, loss_ss: 0.962773, loss_d: 0.571774
0.8439 --- loss: 1.317246, loss_ss: 0.833852, loss_d: 0.483394
0.8822 --- loss: 1.548831, loss_ss: 0.799365, loss_d: 0.749466
0.9206 --- loss: 1.736920, loss_ss: 1.029530, loss_d: 0.707390
0.9590 --- loss: 1.286587, loss_ss: 0.878975, loss_d: 0.407612
0.9973 --- loss: 1.456976, loss_ss: 0.977532, loss_d: 0.479444
Epoch finished! Loss: 1.566505411496529
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.760042, loss_ss: 1.157927, loss_d: 0.602115
0.0384 --- loss: 1.350420, loss_ss: 0.867135, loss_d: 0.483285
0.0767 --- loss: 1.519277, loss_ss: 0.881412, loss_d: 0.637865
0.1151 --- loss: 1.613788, loss_ss: 0.860180, loss_d: 0.753608
0.1534 --- loss: 1.908530, loss_ss: 0.938414, loss_d: 0.970116
0.1918 --- loss: 1.304188, loss_ss: 0.785283, loss_d: 0.518905
0.2301 --- loss: 1.832690, loss_ss: 1.147338, loss_d: 0.685353
0.2685 --- loss: 1.712854, loss_ss: 0.967343, loss_d: 0.745511
0.3069 --- loss: 1.603979, loss_ss: 1.131797, loss_d: 0.472182
0.3452 --- loss: 1.525672, loss_ss: 0.927084, loss_d: 0.598588
0.3836 --- loss: 1.865205, loss_ss: 1.059829, loss_d: 0.805376
0.4219 --- loss: 1.494137, loss_ss: 0.869613, loss_d: 0.624524
0.4603 --- loss: 1.093042, loss_ss: 0.761580, loss_d: 0.331462
0.4987 --- loss: 1.873357, loss_ss: 0.816759, loss_d: 1.056597
0.5370 --- loss: 1.404724, loss_ss: 0.955692, loss_d: 0.449032
0.5754 --- loss: 1.843234, loss_ss: 1.090615, loss_d: 0.752619
0.6137 --- loss: 1.697337, loss_ss: 0.968803, loss_d: 0.728534
0.6521 --- loss: 1.435995, loss_ss: 0.927018, loss_d: 0.508977
0.6904 --- loss: 1.623081, loss_ss: 0.904261, loss_d: 0.718820
0.7288 --- loss: 1.873017, loss_ss: 1.248367, loss_d: 0.624650
0.7672 --- loss: 1.388336, loss_ss: 0.730020, loss_d: 0.658316
0.8055 --- loss: 1.557495, loss_ss: 0.937528, loss_d: 0.619966
0.8439 --- loss: 1.392107, loss_ss: 0.918696, loss_d: 0.473411
0.8822 --- loss: 1.349021, loss_ss: 0.926323, loss_d: 0.422698
0.9206 --- loss: 1.629153, loss_ss: 0.943495, loss_d: 0.685658
0.9590 --- loss: 1.334843, loss_ss: 0.961695, loss_d: 0.373148
0.9973 --- loss: 1.760774, loss_ss: 0.820849, loss_d: 0.939925
Epoch finished! Loss: 1.519435460292376
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 0.974902, loss_ss: 0.747179, loss_d: 0.227722
0.0384 --- loss: 1.652721, loss_ss: 0.971130, loss_d: 0.681592
0.0767 --- loss: 1.374806, loss_ss: 0.756754, loss_d: 0.618052
0.1151 --- loss: 1.414887, loss_ss: 0.852580, loss_d: 0.562308
0.1534 --- loss: 1.415216, loss_ss: 0.969047, loss_d: 0.446169
0.1918 --- loss: 1.537362, loss_ss: 0.965582, loss_d: 0.571780
0.2301 --- loss: 1.500925, loss_ss: 1.142685, loss_d: 0.358241
0.2685 --- loss: 1.527722, loss_ss: 0.893900, loss_d: 0.633822
0.3069 --- loss: 1.582886, loss_ss: 0.991486, loss_d: 0.591400
0.3452 --- loss: 1.361061, loss_ss: 1.029009, loss_d: 0.332051
0.3836 --- loss: 1.716407, loss_ss: 1.180429, loss_d: 0.535978
0.4219 --- loss: 1.407139, loss_ss: 0.763290, loss_d: 0.643849
0.4603 --- loss: 1.339640, loss_ss: 0.946668, loss_d: 0.392972
0.4987 --- loss: 1.203587, loss_ss: 0.873823, loss_d: 0.329764
0.5370 --- loss: 1.156476, loss_ss: 0.764909, loss_d: 0.391567
0.5754 --- loss: 1.333523, loss_ss: 0.882269, loss_d: 0.451254
0.6137 --- loss: 1.589927, loss_ss: 1.109614, loss_d: 0.480313
0.6521 --- loss: 2.017466, loss_ss: 1.128996, loss_d: 0.888469
0.6904 --- loss: 1.539938, loss_ss: 0.880627, loss_d: 0.659311
0.7288 --- loss: 1.527527, loss_ss: 1.109849, loss_d: 0.417677
0.7672 --- loss: 1.324045, loss_ss: 0.799002, loss_d: 0.525043
0.8055 --- loss: 1.631980, loss_ss: 1.036650, loss_d: 0.595330
0.8439 --- loss: 1.386783, loss_ss: 0.813197, loss_d: 0.573586
0.8822 --- loss: 1.187020, loss_ss: 0.869653, loss_d: 0.317367
0.9206 --- loss: 1.855623, loss_ss: 0.991817, loss_d: 0.863806
0.9590 --- loss: 1.629585, loss_ss: 0.708772, loss_d: 0.920813
0.9973 --- loss: 1.735697, loss_ss: 0.933538, loss_d: 0.802160
Epoch finished! Loss: 1.4624885325248425
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.333013, loss_ss: 0.752926, loss_d: 0.580087
0.0384 --- loss: 1.463383, loss_ss: 1.033919, loss_d: 0.429464
0.0767 --- loss: 1.432951, loss_ss: 0.906416, loss_d: 0.526535
0.1151 --- loss: 1.323641, loss_ss: 0.783863, loss_d: 0.539778
0.1534 --- loss: 1.671372, loss_ss: 0.817181, loss_d: 0.854192
0.1918 --- loss: 1.196765, loss_ss: 0.736596, loss_d: 0.460169
0.2301 --- loss: 1.572819, loss_ss: 1.190114, loss_d: 0.382705
0.2685 --- loss: 1.435170, loss_ss: 0.917122, loss_d: 0.518048
0.3069 --- loss: 1.660368, loss_ss: 1.367785, loss_d: 0.292583
0.3452 --- loss: 1.675940, loss_ss: 0.915893, loss_d: 0.760047
0.3836 --- loss: 1.604586, loss_ss: 1.155889, loss_d: 0.448696
0.4219 --- loss: 1.425906, loss_ss: 1.057467, loss_d: 0.368439
0.4603 --- loss: 1.461029, loss_ss: 1.065084, loss_d: 0.395944
0.4987 --- loss: 1.196855, loss_ss: 0.874556, loss_d: 0.322299
0.5370 --- loss: 1.389835, loss_ss: 1.037282, loss_d: 0.352552
0.5754 --- loss: 1.331651, loss_ss: 0.751561, loss_d: 0.580091
0.6137 --- loss: 1.297020, loss_ss: 0.990388, loss_d: 0.306632
0.6521 --- loss: 1.650685, loss_ss: 1.020872, loss_d: 0.629813
0.6904 --- loss: 1.299342, loss_ss: 0.826013, loss_d: 0.473329
0.7288 --- loss: 1.101431, loss_ss: 0.821906, loss_d: 0.279525
0.7672 --- loss: 1.349702, loss_ss: 0.936050, loss_d: 0.413652
0.8055 --- loss: 1.161696, loss_ss: 0.860586, loss_d: 0.301110
0.8439 --- loss: 1.473955, loss_ss: 1.041211, loss_d: 0.432744
0.8822 --- loss: 1.160208, loss_ss: 0.883694, loss_d: 0.276515
0.9206 --- loss: 1.228472, loss_ss: 0.698042, loss_d: 0.530429
0.9590 --- loss: 1.091657, loss_ss: 0.704008, loss_d: 0.387649
0.9973 --- loss: 1.568881, loss_ss: 0.736317, loss_d: 0.832564
Epoch finished! Loss: 1.384176478936122
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.274305, loss_ss: 0.943157, loss_d: 0.331147
0.0384 --- loss: 1.256720, loss_ss: 0.768837, loss_d: 0.487882
0.0767 --- loss: 1.331818, loss_ss: 1.007585, loss_d: 0.324233
0.1151 --- loss: 1.076580, loss_ss: 0.698487, loss_d: 0.378094
0.1534 --- loss: 1.443890, loss_ss: 1.208882, loss_d: 0.235008
0.1918 --- loss: 0.960226, loss_ss: 0.766335, loss_d: 0.193890
0.2301 --- loss: 1.197258, loss_ss: 0.750467, loss_d: 0.446790
0.2685 --- loss: 1.268480, loss_ss: 0.993826, loss_d: 0.274654
0.3069 --- loss: 1.232709, loss_ss: 0.879798, loss_d: 0.352910
0.3452 --- loss: 1.963702, loss_ss: 0.911375, loss_d: 1.052327
0.3836 --- loss: 1.483722, loss_ss: 0.930019, loss_d: 0.553702
0.4219 --- loss: 1.290941, loss_ss: 0.834442, loss_d: 0.456499
0.4603 --- loss: 1.582285, loss_ss: 0.918036, loss_d: 0.664248
0.4987 --- loss: 1.364319, loss_ss: 0.963242, loss_d: 0.401077
0.5370 --- loss: 1.080170, loss_ss: 0.922899, loss_d: 0.157271
0.5754 --- loss: 1.529134, loss_ss: 0.946494, loss_d: 0.582641
0.6137 --- loss: 1.325781, loss_ss: 0.857195, loss_d: 0.468586
0.6521 --- loss: 1.349277, loss_ss: 0.865193, loss_d: 0.484084
0.6904 --- loss: 1.386184, loss_ss: 0.906718, loss_d: 0.479466
0.7288 --- loss: 1.281241, loss_ss: 0.944441, loss_d: 0.336799
0.7672 --- loss: 1.264118, loss_ss: 0.858166, loss_d: 0.405952
0.8055 --- loss: 1.143399, loss_ss: 0.728564, loss_d: 0.414834
0.8439 --- loss: 1.083390, loss_ss: 0.864626, loss_d: 0.218764
0.8822 --- loss: 1.234861, loss_ss: 1.018713, loss_d: 0.216148
0.9206 --- loss: 0.892118, loss_ss: 0.743803, loss_d: 0.148315
0.9590 --- loss: 0.980595, loss_ss: 0.765363, loss_d: 0.215231
0.9973 --- loss: 1.099655, loss_ss: 0.682745, loss_d: 0.416909
Epoch finished! Loss: 1.311744959767048
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.995936, loss_ss: 0.863267, loss_d: 0.132670
0.0384 --- loss: 0.913276, loss_ss: 0.684977, loss_d: 0.228299
0.0767 --- loss: 1.193813, loss_ss: 0.786624, loss_d: 0.407189
0.1151 --- loss: 1.732961, loss_ss: 1.434122, loss_d: 0.298839
0.1534 --- loss: 1.358770, loss_ss: 1.118953, loss_d: 0.239817
0.1918 --- loss: 1.334118, loss_ss: 0.808683, loss_d: 0.525436
0.2301 --- loss: 1.067392, loss_ss: 0.880372, loss_d: 0.187020
0.2685 --- loss: 1.015414, loss_ss: 0.688380, loss_d: 0.327034
0.3069 --- loss: 1.067906, loss_ss: 0.749243, loss_d: 0.318663
0.3452 --- loss: 1.067848, loss_ss: 0.752500, loss_d: 0.315347
0.3836 --- loss: 1.020566, loss_ss: 0.858890, loss_d: 0.161675
0.4219 --- loss: 0.899100, loss_ss: 0.635129, loss_d: 0.263971
0.4603 --- loss: 0.919729, loss_ss: 0.738533, loss_d: 0.181196
0.4987 --- loss: 1.049780, loss_ss: 0.615105, loss_d: 0.434674
0.5370 --- loss: 0.794655, loss_ss: 0.668012, loss_d: 0.126643
0.5754 --- loss: 0.884933, loss_ss: 0.698222, loss_d: 0.186711
0.6137 --- loss: 1.240498, loss_ss: 0.932911, loss_d: 0.307587
0.6521 --- loss: 1.620333, loss_ss: 0.899953, loss_d: 0.720381
0.6904 --- loss: 1.475946, loss_ss: 0.944034, loss_d: 0.531912
0.7288 --- loss: 1.135104, loss_ss: 0.962776, loss_d: 0.172328
0.7672 --- loss: 1.394697, loss_ss: 1.094167, loss_d: 0.300529
0.8055 --- loss: 2.102399, loss_ss: 1.172822, loss_d: 0.929577
0.8439 --- loss: 1.761209, loss_ss: 1.084266, loss_d: 0.676943
0.8822 --- loss: 1.860133, loss_ss: 0.700546, loss_d: 1.159587
0.9206 --- loss: 1.427756, loss_ss: 0.781352, loss_d: 0.646403
0.9590 --- loss: 1.080992, loss_ss: 0.675479, loss_d: 0.405513
0.9973 --- loss: 1.327404, loss_ss: 0.884601, loss_d: 0.442803
Epoch finished! Loss: 1.2741355001926422
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.143421, loss_ss: 0.894689, loss_d: 0.248732
0.0384 --- loss: 0.996673, loss_ss: 0.788384, loss_d: 0.208288
0.0767 --- loss: 1.196617, loss_ss: 0.815275, loss_d: 0.381342
0.1151 --- loss: 0.997884, loss_ss: 0.792357, loss_d: 0.205527
0.1534 --- loss: 1.070140, loss_ss: 0.870566, loss_d: 0.199574
0.1918 --- loss: 0.932122, loss_ss: 0.691827, loss_d: 0.240295
0.2301 --- loss: 1.203391, loss_ss: 0.753502, loss_d: 0.449889
0.2685 --- loss: 1.336805, loss_ss: 0.876493, loss_d: 0.460313
0.3069 --- loss: 1.030643, loss_ss: 0.831259, loss_d: 0.199384
0.3452 --- loss: 1.047016, loss_ss: 0.886849, loss_d: 0.160167
0.3836 --- loss: 1.280407, loss_ss: 0.954483, loss_d: 0.325924
0.4219 --- loss: 1.189974, loss_ss: 1.066163, loss_d: 0.123810
0.4603 --- loss: 1.816576, loss_ss: 0.833474, loss_d: 0.983102
0.4987 --- loss: 1.473402, loss_ss: 0.907354, loss_d: 0.566048
0.5370 --- loss: 1.128151, loss_ss: 0.922286, loss_d: 0.205865
0.5754 --- loss: 0.896588, loss_ss: 0.666244, loss_d: 0.230344
0.6137 --- loss: 0.821916, loss_ss: 0.669143, loss_d: 0.152773
0.6521 --- loss: 1.098288, loss_ss: 0.907938, loss_d: 0.190350
0.6904 --- loss: 1.221850, loss_ss: 0.831968, loss_d: 0.389883
0.7288 --- loss: 1.190001, loss_ss: 1.025757, loss_d: 0.164244
0.7672 --- loss: 1.340026, loss_ss: 0.920838, loss_d: 0.419188
0.8055 --- loss: 1.467248, loss_ss: 0.935398, loss_d: 0.531851
0.8439 --- loss: 0.856481, loss_ss: 0.706711, loss_d: 0.149771
0.8822 --- loss: 1.403211, loss_ss: 0.857264, loss_d: 0.545947
0.9206 --- loss: 1.203378, loss_ss: 0.870426, loss_d: 0.332952
0.9590 --- loss: 1.546141, loss_ss: 1.124640, loss_d: 0.421501
0.9973 --- loss: 1.830811, loss_ss: 1.097709, loss_d: 0.733102
Epoch finished! Loss: 1.2147656420102486
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.229640, loss_ss: 0.995562, loss_d: 0.234079
0.0384 --- loss: 1.101919, loss_ss: 0.856668, loss_d: 0.245250
0.0767 --- loss: 0.968851, loss_ss: 0.799376, loss_d: 0.169475
0.1151 --- loss: 0.849756, loss_ss: 0.697791, loss_d: 0.151965
0.1534 --- loss: 1.488601, loss_ss: 1.241692, loss_d: 0.246909
0.1918 --- loss: 1.016014, loss_ss: 0.736917, loss_d: 0.279097
0.2301 --- loss: 0.887516, loss_ss: 0.671664, loss_d: 0.215852
0.2685 --- loss: 1.329049, loss_ss: 1.107510, loss_d: 0.221539
0.3069 --- loss: 0.975738, loss_ss: 0.818556, loss_d: 0.157182
0.3452 --- loss: 0.806081, loss_ss: 0.635870, loss_d: 0.170211
0.3836 --- loss: 0.670943, loss_ss: 0.494501, loss_d: 0.176442
0.4219 --- loss: 0.972620, loss_ss: 0.630246, loss_d: 0.342373
0.4603 --- loss: 1.355133, loss_ss: 0.725075, loss_d: 0.630058
0.4987 --- loss: 1.602736, loss_ss: 1.012491, loss_d: 0.590245
0.5370 --- loss: 1.012697, loss_ss: 0.775655, loss_d: 0.237043
0.5754 --- loss: 1.107004, loss_ss: 0.941763, loss_d: 0.165240
0.6137 --- loss: 1.218535, loss_ss: 1.002359, loss_d: 0.216176
0.6521 --- loss: 1.447931, loss_ss: 0.891256, loss_d: 0.556675
0.6904 --- loss: 2.068098, loss_ss: 0.805951, loss_d: 1.262147
0.7288 --- loss: 1.139358, loss_ss: 0.736306, loss_d: 0.403052
0.7672 --- loss: 1.362918, loss_ss: 1.061971, loss_d: 0.300946
0.8055 --- loss: 1.407293, loss_ss: 0.704552, loss_d: 0.702741
0.8439 --- loss: 1.358188, loss_ss: 0.814172, loss_d: 0.544016
0.8822 --- loss: 1.061171, loss_ss: 0.965799, loss_d: 0.095371
0.9206 --- loss: 2.079600, loss_ss: 1.406452, loss_d: 0.673148
0.9590 --- loss: 1.555016, loss_ss: 1.175701, loss_d: 0.379315
0.9973 --- loss: 1.036532, loss_ss: 0.836098, loss_d: 0.200434
Epoch finished! Loss: 1.1707976210575837
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8086021505376344
             precision    recall  f1-score   support

        0.0       0.49      0.89      0.63        38
        1.0       0.75      0.07      0.13        83
        2.0       0.84      0.89      0.86       502
        3.0       0.79      1.00      0.88       166
        4.0       0.90      0.72      0.80       141

avg / total       0.82      0.81      0.78       930
 


====== chc015-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  95.70   89.47   95.96  48.57     62.96
1  91.51    7.23   99.76  75.00     13.19
2  84.73   88.65   80.14  83.96     86.24
3  95.27  100.00   94.24  79.05     88.30
4  94.52   71.63   98.61  90.18     79.84
Total accuracy: 80.86%
Average sen: 71.40%
Average spec: 93.74%
Macro f1-score: 66.11%
Diagnosis acc on 15mins: 0.0
[0.80327809 0.62003517 0.66590965 0.83985025 0.98232126 0.54745966
 0.98191327 0.9999342  0.99990118 0.99940431 0.9862895  0.99026138
 0.87261522 0.97343957 0.99554729 0.99996519 0.99152035 0.98902261
 0.95625967 0.83593386 0.96039188 0.99496341 0.99915004 0.986121
 0.99717903 0.83191019 0.84633154 0.60616916 0.99665999 0.99991715
 0.99999034]
pred: 0.9112788842570397, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc016-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.267969, loss_ss: 1.610132, loss_d: 0.657838
0.0384 --- loss: 2.203674, loss_ss: 1.607812, loss_d: 0.595862
0.0767 --- loss: 2.081813, loss_ss: 1.437602, loss_d: 0.644211
0.1151 --- loss: 2.501970, loss_ss: 1.559542, loss_d: 0.942429
0.1534 --- loss: 2.199041, loss_ss: 1.489476, loss_d: 0.709565
0.1918 --- loss: 2.131860, loss_ss: 1.568432, loss_d: 0.563428
0.2301 --- loss: 1.766885, loss_ss: 1.378052, loss_d: 0.388833
0.2685 --- loss: 2.537815, loss_ss: 1.583577, loss_d: 0.954238
0.3069 --- loss: 1.939171, loss_ss: 1.432725, loss_d: 0.506447
0.3452 --- loss: 1.899961, loss_ss: 1.328595, loss_d: 0.571366
0.3836 --- loss: 2.176976, loss_ss: 1.384757, loss_d: 0.792219
0.4219 --- loss: 1.714026, loss_ss: 1.306630, loss_d: 0.407396
0.4603 --- loss: 2.266267, loss_ss: 1.339689, loss_d: 0.926579
0.4987 --- loss: 1.648441, loss_ss: 1.250007, loss_d: 0.398434
0.5370 --- loss: 2.202434, loss_ss: 1.448682, loss_d: 0.753753
0.5754 --- loss: 1.870417, loss_ss: 1.272206, loss_d: 0.598211
0.6137 --- loss: 1.803898, loss_ss: 1.107349, loss_d: 0.696549
0.6521 --- loss: 1.755243, loss_ss: 1.178039, loss_d: 0.577204
0.6904 --- loss: 1.573498, loss_ss: 1.144864, loss_d: 0.428633
0.7288 --- loss: 1.552411, loss_ss: 1.230746, loss_d: 0.321665
0.7672 --- loss: 1.512633, loss_ss: 1.171520, loss_d: 0.341113
0.8055 --- loss: 2.055092, loss_ss: 1.304753, loss_d: 0.750339
0.8439 --- loss: 1.695404, loss_ss: 1.193625, loss_d: 0.501779
0.8822 --- loss: 2.153976, loss_ss: 1.370684, loss_d: 0.783292
0.9206 --- loss: 1.782709, loss_ss: 1.270755, loss_d: 0.511954
0.9590 --- loss: 1.784561, loss_ss: 1.168398, loss_d: 0.616164
0.9973 --- loss: 2.267108, loss_ss: 1.731204, loss_d: 0.535905
Epoch finished! Loss: 1.9501864181115076
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.790028, loss_ss: 1.213308, loss_d: 0.576720
0.0384 --- loss: 1.885854, loss_ss: 1.133199, loss_d: 0.752655
0.0767 --- loss: 1.842828, loss_ss: 1.360227, loss_d: 0.482601
0.1151 --- loss: 1.561421, loss_ss: 1.126523, loss_d: 0.434898
0.1534 --- loss: 1.800669, loss_ss: 1.123064, loss_d: 0.677605
0.1918 --- loss: 1.550367, loss_ss: 1.127918, loss_d: 0.422449
0.2301 --- loss: 1.939537, loss_ss: 1.091396, loss_d: 0.848141
0.2685 --- loss: 1.807984, loss_ss: 1.055036, loss_d: 0.752948
0.3069 --- loss: 1.656218, loss_ss: 1.076972, loss_d: 0.579246
0.3452 --- loss: 1.651300, loss_ss: 1.089263, loss_d: 0.562037
0.3836 --- loss: 2.285078, loss_ss: 1.520275, loss_d: 0.764803
0.4219 --- loss: 1.620473, loss_ss: 1.056475, loss_d: 0.563997
0.4603 --- loss: 1.640860, loss_ss: 0.902782, loss_d: 0.738079
0.4987 --- loss: 1.571610, loss_ss: 1.077220, loss_d: 0.494389
0.5370 --- loss: 1.626711, loss_ss: 1.077986, loss_d: 0.548725
0.5754 --- loss: 1.588483, loss_ss: 0.808374, loss_d: 0.780110
0.6137 --- loss: 1.614617, loss_ss: 1.098018, loss_d: 0.516599
0.6521 --- loss: 1.370339, loss_ss: 1.037522, loss_d: 0.332817
0.6904 --- loss: 1.642219, loss_ss: 1.154090, loss_d: 0.488129
0.7288 --- loss: 1.954672, loss_ss: 1.533226, loss_d: 0.421445
0.7672 --- loss: 1.670634, loss_ss: 0.927248, loss_d: 0.743386
0.8055 --- loss: 1.863746, loss_ss: 1.408709, loss_d: 0.455037
0.8439 --- loss: 1.730917, loss_ss: 1.157944, loss_d: 0.572973
0.8822 --- loss: 1.590741, loss_ss: 0.939086, loss_d: 0.651655
0.9206 --- loss: 1.453615, loss_ss: 1.114201, loss_d: 0.339414
0.9590 --- loss: 2.386148, loss_ss: 1.920578, loss_d: 0.465571
0.9973 --- loss: 2.095929, loss_ss: 1.444706, loss_d: 0.651223
Epoch finished! Loss: 1.7345325456215785
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.730156, loss_ss: 1.276213, loss_d: 0.453943
0.0384 --- loss: 1.608387, loss_ss: 1.185729, loss_d: 0.422658
0.0767 --- loss: 1.581910, loss_ss: 1.189094, loss_d: 0.392816
0.1151 --- loss: 1.952799, loss_ss: 1.680926, loss_d: 0.271873
0.1534 --- loss: 1.821185, loss_ss: 1.155507, loss_d: 0.665677
0.1918 --- loss: 1.317538, loss_ss: 0.906828, loss_d: 0.410710
0.2301 --- loss: 1.486609, loss_ss: 1.110214, loss_d: 0.376394
0.2685 --- loss: 1.637456, loss_ss: 1.141599, loss_d: 0.495857
0.3069 --- loss: 1.684345, loss_ss: 1.205982, loss_d: 0.478363
0.3452 --- loss: 1.871583, loss_ss: 1.313439, loss_d: 0.558145
0.3836 --- loss: 1.807428, loss_ss: 1.095392, loss_d: 0.712036
0.4219 --- loss: 1.612773, loss_ss: 0.921136, loss_d: 0.691637
0.4603 --- loss: 1.767737, loss_ss: 1.032910, loss_d: 0.734827
0.4987 --- loss: 1.727485, loss_ss: 0.991091, loss_d: 0.736394
0.5370 --- loss: 1.589291, loss_ss: 1.209197, loss_d: 0.380094
0.5754 --- loss: 1.878735, loss_ss: 1.224673, loss_d: 0.654063
0.6137 --- loss: 1.395039, loss_ss: 1.042531, loss_d: 0.352507
0.6521 --- loss: 1.400054, loss_ss: 1.062269, loss_d: 0.337785
0.6904 --- loss: 1.729927, loss_ss: 1.122347, loss_d: 0.607580
0.7288 --- loss: 1.441439, loss_ss: 0.988929, loss_d: 0.452510
0.7672 --- loss: 1.608171, loss_ss: 1.136595, loss_d: 0.471576
0.8055 --- loss: 1.954945, loss_ss: 1.424276, loss_d: 0.530669
0.8439 --- loss: 1.569351, loss_ss: 1.185906, loss_d: 0.383446
0.8822 --- loss: 1.569106, loss_ss: 1.073661, loss_d: 0.495445
0.9206 --- loss: 1.769394, loss_ss: 1.115023, loss_d: 0.654371
0.9590 --- loss: 1.128775, loss_ss: 0.860891, loss_d: 0.267884
0.9973 --- loss: 1.603498, loss_ss: 1.041348, loss_d: 0.562149
Epoch finished! Loss: 1.6399019250502953
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.673241, loss_ss: 1.150876, loss_d: 0.522365
0.0384 --- loss: 1.627652, loss_ss: 1.088682, loss_d: 0.538969
0.0767 --- loss: 1.400572, loss_ss: 0.897687, loss_d: 0.502885
0.1151 --- loss: 1.664369, loss_ss: 1.160260, loss_d: 0.504108
0.1534 --- loss: 1.660547, loss_ss: 1.113618, loss_d: 0.546929
0.1918 --- loss: 1.385121, loss_ss: 0.952264, loss_d: 0.432858
0.2301 --- loss: 1.347097, loss_ss: 0.978715, loss_d: 0.368382
0.2685 --- loss: 1.625162, loss_ss: 1.024591, loss_d: 0.600571
0.3069 --- loss: 2.016893, loss_ss: 1.277102, loss_d: 0.739791
0.3452 --- loss: 1.708896, loss_ss: 1.218075, loss_d: 0.490821
0.3836 --- loss: 1.693160, loss_ss: 1.019691, loss_d: 0.673468
0.4219 --- loss: 1.243652, loss_ss: 0.809516, loss_d: 0.434136
0.4603 --- loss: 1.062446, loss_ss: 0.816943, loss_d: 0.245504
0.4987 --- loss: 1.479140, loss_ss: 0.958437, loss_d: 0.520703
0.5370 --- loss: 1.844645, loss_ss: 1.211889, loss_d: 0.632756
0.5754 --- loss: 1.404417, loss_ss: 0.800474, loss_d: 0.603943
0.6137 --- loss: 1.795105, loss_ss: 1.156722, loss_d: 0.638382
0.6521 --- loss: 2.065606, loss_ss: 1.005803, loss_d: 1.059803
0.6904 --- loss: 1.629686, loss_ss: 0.885645, loss_d: 0.744041
0.7288 --- loss: 1.442893, loss_ss: 0.845278, loss_d: 0.597615
0.7672 --- loss: 1.516005, loss_ss: 1.104251, loss_d: 0.411753
0.8055 --- loss: 1.282020, loss_ss: 1.051269, loss_d: 0.230751
0.8439 --- loss: 1.309125, loss_ss: 0.808160, loss_d: 0.500966
0.8822 --- loss: 1.089819, loss_ss: 0.801396, loss_d: 0.288423
0.9206 --- loss: 1.114601, loss_ss: 0.724002, loss_d: 0.390599
0.9590 --- loss: 1.578847, loss_ss: 0.985941, loss_d: 0.592907
0.9973 --- loss: 1.536372, loss_ss: 0.820585, loss_d: 0.715787
Epoch finished! Loss: 1.5370210679677816
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.881835, loss_ss: 0.951479, loss_d: 0.930356
0.0384 --- loss: 1.823919, loss_ss: 0.989602, loss_d: 0.834317
0.0767 --- loss: 1.532560, loss_ss: 0.947853, loss_d: 0.584707
0.1151 --- loss: 1.422967, loss_ss: 0.967192, loss_d: 0.455775
0.1534 --- loss: 1.184763, loss_ss: 0.808438, loss_d: 0.376326
0.1918 --- loss: 1.083896, loss_ss: 0.764630, loss_d: 0.319266
0.2301 --- loss: 1.444482, loss_ss: 0.949629, loss_d: 0.494853
0.2685 --- loss: 1.755983, loss_ss: 1.049062, loss_d: 0.706921
0.3069 --- loss: 1.519971, loss_ss: 1.048101, loss_d: 0.471870
0.3452 --- loss: 1.812908, loss_ss: 1.235260, loss_d: 0.577648
0.3836 --- loss: 1.549332, loss_ss: 1.244695, loss_d: 0.304637
0.4219 --- loss: 1.595686, loss_ss: 1.065463, loss_d: 0.530223
0.4603 --- loss: 1.319197, loss_ss: 1.068903, loss_d: 0.250294
0.4987 --- loss: 1.132930, loss_ss: 0.962096, loss_d: 0.170834
0.5370 --- loss: 0.990239, loss_ss: 0.823433, loss_d: 0.166806
0.5754 --- loss: 1.178592, loss_ss: 0.949666, loss_d: 0.228927
0.6137 --- loss: 1.302046, loss_ss: 0.885853, loss_d: 0.416193
0.6521 --- loss: 1.357613, loss_ss: 0.827873, loss_d: 0.529740
0.6904 --- loss: 1.538012, loss_ss: 1.155666, loss_d: 0.382346
0.7288 --- loss: 1.579740, loss_ss: 0.982498, loss_d: 0.597242
0.7672 --- loss: 1.493386, loss_ss: 0.967335, loss_d: 0.526051
0.8055 --- loss: 1.284710, loss_ss: 0.967982, loss_d: 0.316728
0.8439 --- loss: 1.923808, loss_ss: 1.032263, loss_d: 0.891545
0.8822 --- loss: 1.639296, loss_ss: 1.171204, loss_d: 0.468092
0.9206 --- loss: 1.237253, loss_ss: 0.878008, loss_d: 0.359245
0.9590 --- loss: 1.188960, loss_ss: 0.922657, loss_d: 0.266302
0.9973 --- loss: 1.330456, loss_ss: 1.012529, loss_d: 0.317927
Epoch finished! Loss: 1.4380818378466826
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.648597, loss_ss: 1.288818, loss_d: 0.359779
0.0384 --- loss: 1.231341, loss_ss: 0.973340, loss_d: 0.258001
0.0767 --- loss: 1.652607, loss_ss: 0.956767, loss_d: 0.695840
0.1151 --- loss: 1.091591, loss_ss: 0.876336, loss_d: 0.215255
0.1534 --- loss: 1.330060, loss_ss: 1.013246, loss_d: 0.316813
0.1918 --- loss: 1.539114, loss_ss: 0.981124, loss_d: 0.557990
0.2301 --- loss: 1.564749, loss_ss: 1.177399, loss_d: 0.387350
0.2685 --- loss: 1.168058, loss_ss: 0.702787, loss_d: 0.465271
0.3069 --- loss: 1.336900, loss_ss: 0.756599, loss_d: 0.580301
0.3452 --- loss: 1.625015, loss_ss: 1.282102, loss_d: 0.342913
0.3836 --- loss: 1.657174, loss_ss: 1.023967, loss_d: 0.633207
0.4219 --- loss: 1.457978, loss_ss: 1.082723, loss_d: 0.375255
0.4603 --- loss: 1.330093, loss_ss: 0.930738, loss_d: 0.399356
0.4987 --- loss: 1.446013, loss_ss: 0.804990, loss_d: 0.641023
0.5370 --- loss: 1.262347, loss_ss: 1.015553, loss_d: 0.246794
0.5754 --- loss: 1.519337, loss_ss: 1.180720, loss_d: 0.338617
0.6137 --- loss: 1.092379, loss_ss: 0.901454, loss_d: 0.190926
0.6521 --- loss: 1.410122, loss_ss: 1.036180, loss_d: 0.373943
0.6904 --- loss: 1.369639, loss_ss: 0.961336, loss_d: 0.408303
0.7288 --- loss: 1.224616, loss_ss: 0.734294, loss_d: 0.490321
0.7672 --- loss: 1.267342, loss_ss: 0.834291, loss_d: 0.433052
0.8055 --- loss: 1.178310, loss_ss: 0.845459, loss_d: 0.332850
0.8439 --- loss: 1.090046, loss_ss: 0.886480, loss_d: 0.203566
0.8822 --- loss: 1.334855, loss_ss: 1.070122, loss_d: 0.264732
0.9206 --- loss: 1.175591, loss_ss: 0.940096, loss_d: 0.235495
0.9590 --- loss: 1.343520, loss_ss: 1.046265, loss_d: 0.297255
0.9973 --- loss: 1.477144, loss_ss: 1.058993, loss_d: 0.418151
Epoch finished! Loss: 1.377388349404702
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.057759, loss_ss: 0.870620, loss_d: 0.187139
0.0384 --- loss: 1.290713, loss_ss: 0.987814, loss_d: 0.302900
0.0767 --- loss: 1.062024, loss_ss: 0.866962, loss_d: 0.195062
0.1151 --- loss: 1.407236, loss_ss: 1.051318, loss_d: 0.355917
0.1534 --- loss: 1.311202, loss_ss: 0.866050, loss_d: 0.445151
0.1918 --- loss: 0.932761, loss_ss: 0.721383, loss_d: 0.211378
0.2301 --- loss: 1.505638, loss_ss: 1.335272, loss_d: 0.170366
0.2685 --- loss: 1.120230, loss_ss: 0.938288, loss_d: 0.181942
0.3069 --- loss: 1.287482, loss_ss: 1.020307, loss_d: 0.267175
0.3452 --- loss: 1.169705, loss_ss: 0.904868, loss_d: 0.264837
0.3836 --- loss: 1.266534, loss_ss: 0.871532, loss_d: 0.395002
0.4219 --- loss: 1.238709, loss_ss: 1.018763, loss_d: 0.219946
0.4603 --- loss: 1.263906, loss_ss: 1.058529, loss_d: 0.205377
0.4987 --- loss: 1.421428, loss_ss: 0.990176, loss_d: 0.431252
0.5370 --- loss: 1.607475, loss_ss: 1.120725, loss_d: 0.486750
0.5754 --- loss: 1.568390, loss_ss: 1.291492, loss_d: 0.276899
0.6137 --- loss: 1.329762, loss_ss: 0.761295, loss_d: 0.568467
0.6521 --- loss: 1.501886, loss_ss: 1.264518, loss_d: 0.237369
0.6904 --- loss: 1.035383, loss_ss: 0.769518, loss_d: 0.265865
0.7288 --- loss: 1.781860, loss_ss: 1.072843, loss_d: 0.709017
0.7672 --- loss: 1.057273, loss_ss: 0.942468, loss_d: 0.114805
0.8055 --- loss: 1.883975, loss_ss: 1.133770, loss_d: 0.750205
0.8439 --- loss: 1.496884, loss_ss: 0.899395, loss_d: 0.597490
0.8822 --- loss: 1.190217, loss_ss: 0.943992, loss_d: 0.246225
0.9206 --- loss: 1.194400, loss_ss: 0.980323, loss_d: 0.214077
0.9590 --- loss: 1.486407, loss_ss: 1.106810, loss_d: 0.379597
0.9973 --- loss: 1.013371, loss_ss: 0.740815, loss_d: 0.272557
Epoch finished! Loss: 1.3000736025663522
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.171390, loss_ss: 0.707333, loss_d: 0.464057
0.0384 --- loss: 1.080391, loss_ss: 0.859736, loss_d: 0.220654
0.0767 --- loss: 1.603006, loss_ss: 0.793313, loss_d: 0.809693
0.1151 --- loss: 0.874214, loss_ss: 0.673171, loss_d: 0.201043
0.1534 --- loss: 1.135330, loss_ss: 1.009365, loss_d: 0.125965
0.1918 --- loss: 1.245481, loss_ss: 0.829066, loss_d: 0.416415
0.2301 --- loss: 1.444555, loss_ss: 0.902006, loss_d: 0.542549
0.2685 --- loss: 1.223072, loss_ss: 1.009506, loss_d: 0.213567
0.3069 --- loss: 1.111125, loss_ss: 0.876289, loss_d: 0.234837
0.3452 --- loss: 1.184779, loss_ss: 0.950817, loss_d: 0.233963
0.3836 --- loss: 1.035413, loss_ss: 0.770045, loss_d: 0.265368
0.4219 --- loss: 1.524987, loss_ss: 1.210264, loss_d: 0.314722
0.4603 --- loss: 1.040699, loss_ss: 0.873806, loss_d: 0.166893
0.4987 --- loss: 1.609471, loss_ss: 1.164818, loss_d: 0.444653
0.5370 --- loss: 1.034259, loss_ss: 0.708743, loss_d: 0.325517
0.5754 --- loss: 0.840203, loss_ss: 0.742479, loss_d: 0.097724
0.6137 --- loss: 1.383405, loss_ss: 0.883786, loss_d: 0.499619
0.6521 --- loss: 1.899261, loss_ss: 0.976475, loss_d: 0.922785
0.6904 --- loss: 1.604788, loss_ss: 0.897391, loss_d: 0.707397
0.7288 --- loss: 1.844994, loss_ss: 1.156375, loss_d: 0.688619
0.7672 --- loss: 1.033296, loss_ss: 0.847075, loss_d: 0.186221
0.8055 --- loss: 1.072074, loss_ss: 0.921145, loss_d: 0.150929
0.8439 --- loss: 1.044733, loss_ss: 0.750851, loss_d: 0.293882
0.8822 --- loss: 1.714667, loss_ss: 1.103807, loss_d: 0.610860
0.9206 --- loss: 1.421413, loss_ss: 0.988418, loss_d: 0.432994
0.9590 --- loss: 0.993281, loss_ss: 0.802320, loss_d: 0.190961
0.9973 --- loss: 1.337317, loss_ss: 0.740822, loss_d: 0.596495
Epoch finished! Loss: 1.2348091097978444
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.094003, loss_ss: 0.838123, loss_d: 0.255880
0.0384 --- loss: 1.344331, loss_ss: 0.789950, loss_d: 0.554381
0.0767 --- loss: 1.347390, loss_ss: 0.809961, loss_d: 0.537429
0.1151 --- loss: 1.147290, loss_ss: 0.831187, loss_d: 0.316102
0.1534 --- loss: 1.368716, loss_ss: 1.003314, loss_d: 0.365402
0.1918 --- loss: 1.203884, loss_ss: 1.108816, loss_d: 0.095068
0.2301 --- loss: 1.049900, loss_ss: 0.881517, loss_d: 0.168382
0.2685 --- loss: 1.031681, loss_ss: 0.710098, loss_d: 0.321583
0.3069 --- loss: 1.652565, loss_ss: 0.813999, loss_d: 0.838567
0.3452 --- loss: 0.819953, loss_ss: 0.645095, loss_d: 0.174858
0.3836 --- loss: 1.068931, loss_ss: 0.924212, loss_d: 0.144719
0.4219 --- loss: 1.617309, loss_ss: 0.889641, loss_d: 0.727669
0.4603 --- loss: 1.041535, loss_ss: 0.794515, loss_d: 0.247020
0.4987 --- loss: 0.920746, loss_ss: 0.714711, loss_d: 0.206035
0.5370 --- loss: 1.897016, loss_ss: 1.445998, loss_d: 0.451018
0.5754 --- loss: 1.354840, loss_ss: 0.815979, loss_d: 0.538861
0.6137 --- loss: 1.168203, loss_ss: 0.908383, loss_d: 0.259820
0.6521 --- loss: 0.964229, loss_ss: 0.814754, loss_d: 0.149475
0.6904 --- loss: 1.318532, loss_ss: 1.024303, loss_d: 0.294229
0.7288 --- loss: 1.058918, loss_ss: 0.933613, loss_d: 0.125304
0.7672 --- loss: 1.379729, loss_ss: 1.224557, loss_d: 0.155172
0.8055 --- loss: 1.032241, loss_ss: 0.704205, loss_d: 0.328036
0.8439 --- loss: 1.095520, loss_ss: 0.893218, loss_d: 0.202302
0.8822 --- loss: 0.917126, loss_ss: 0.654036, loss_d: 0.263090
0.9206 --- loss: 1.062141, loss_ss: 0.943055, loss_d: 0.119086
0.9590 --- loss: 1.055219, loss_ss: 0.812509, loss_d: 0.242710
0.9973 --- loss: 1.273714, loss_ss: 0.999192, loss_d: 0.274522
Epoch finished! Loss: 1.227711827479876
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.954108, loss_ss: 0.793238, loss_d: 0.160870
0.0384 --- loss: 0.823822, loss_ss: 0.648422, loss_d: 0.175400
0.0767 --- loss: 1.138431, loss_ss: 1.049608, loss_d: 0.088823
0.1151 --- loss: 1.279783, loss_ss: 1.011351, loss_d: 0.268431
0.1534 --- loss: 0.828185, loss_ss: 0.663298, loss_d: 0.164888
0.1918 --- loss: 1.600250, loss_ss: 0.898143, loss_d: 0.702107
0.2301 --- loss: 1.749022, loss_ss: 0.947163, loss_d: 0.801860
0.2685 --- loss: 1.135366, loss_ss: 0.697099, loss_d: 0.438267
0.3069 --- loss: 1.142736, loss_ss: 0.915794, loss_d: 0.226941
0.3452 --- loss: 1.111100, loss_ss: 0.953000, loss_d: 0.158100
0.3836 --- loss: 0.977090, loss_ss: 0.749026, loss_d: 0.228064
0.4219 --- loss: 0.941419, loss_ss: 0.586713, loss_d: 0.354706
0.4603 --- loss: 1.227525, loss_ss: 0.540422, loss_d: 0.687103
0.4987 --- loss: 0.950574, loss_ss: 0.846204, loss_d: 0.104369
0.5370 --- loss: 1.565524, loss_ss: 1.240552, loss_d: 0.324971
0.5754 --- loss: 0.707869, loss_ss: 0.593481, loss_d: 0.114388
0.6137 --- loss: 1.010115, loss_ss: 0.821567, loss_d: 0.188548
0.6521 --- loss: 0.691001, loss_ss: 0.586714, loss_d: 0.104288
0.6904 --- loss: 1.142811, loss_ss: 0.752364, loss_d: 0.390448
0.7288 --- loss: 1.251333, loss_ss: 0.845107, loss_d: 0.406226
0.7672 --- loss: 1.331362, loss_ss: 1.091122, loss_d: 0.240240
0.8055 --- loss: 1.136822, loss_ss: 0.913143, loss_d: 0.223679
0.8439 --- loss: 1.402346, loss_ss: 1.218038, loss_d: 0.184308
0.8822 --- loss: 1.132155, loss_ss: 0.724289, loss_d: 0.407866
0.9206 --- loss: 1.142970, loss_ss: 0.994774, loss_d: 0.148196
0.9590 --- loss: 1.206469, loss_ss: 1.040345, loss_d: 0.166124
0.9973 --- loss: 0.949458, loss_ss: 0.865652, loss_d: 0.083806
Epoch finished! Loss: 1.156907036442023
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8311827956989247
             precision    recall  f1-score   support

        0.0       0.78      0.94      0.85       226
        1.0       0.00      0.00      0.00        55
        2.0       0.81      0.96      0.88       410
        3.0       1.00      0.66      0.79       108
        4.0       0.97      0.74      0.84       131

avg / total       0.80      0.83      0.80       930
 


====== chc016-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %   ppr %  f1-score
0  92.15  94.25   91.48   78.02     85.37
1  94.09   0.00  100.00    0.00      0.00
2  87.96  95.61   81.92   80.66     87.50
3  96.02  65.74  100.00  100.00     79.33
4  96.02  74.05   99.62   97.00     83.98
Total accuracy: 83.12%
Average sen: 65.93%
Average spec: 94.60%
Macro f1-score: 67.24%
Diagnosis acc on 15mins: 1.0
[0.18806313 0.10282527 0.03754158 0.01400702 0.01099049 0.01083875
 0.01261805 0.01784545 0.01209565 0.01175565 0.00797542 0.00219945
 0.00468186 0.01173654 0.00793703 0.00578944 0.01005632 0.01034431
 0.1064511  0.13870469 0.0203249  0.03186215 0.05636163 0.01276325
 0.03696207 0.02255357 0.06567902 0.01128066 0.0113022  0.02208159
 0.16719536]
pred: 0.03815560016570793, label: 0
Right! Diagnosis: Other

=== Test on chc022-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.528626, loss_ss: 1.831268, loss_d: 0.697358
0.0383 --- loss: 2.051029, loss_ss: 1.618560, loss_d: 0.432469
0.0766 --- loss: 2.009435, loss_ss: 1.465867, loss_d: 0.543568
0.1149 --- loss: 2.082201, loss_ss: 1.438373, loss_d: 0.643828
0.1532 --- loss: 2.251338, loss_ss: 1.620600, loss_d: 0.630739
0.1915 --- loss: 1.920439, loss_ss: 1.317746, loss_d: 0.602694
0.2298 --- loss: 1.960634, loss_ss: 1.247711, loss_d: 0.712923
0.2681 --- loss: 1.795861, loss_ss: 1.419737, loss_d: 0.376125
0.3064 --- loss: 2.032858, loss_ss: 1.240305, loss_d: 0.792553
0.3447 --- loss: 2.002029, loss_ss: 1.308272, loss_d: 0.693757
0.3830 --- loss: 1.850164, loss_ss: 1.356067, loss_d: 0.494096
0.4213 --- loss: 2.113943, loss_ss: 1.362422, loss_d: 0.751521
0.4596 --- loss: 1.751375, loss_ss: 1.367212, loss_d: 0.384163
0.4979 --- loss: 1.814756, loss_ss: 1.264972, loss_d: 0.549784
0.5362 --- loss: 2.003799, loss_ss: 1.265131, loss_d: 0.738669
0.5745 --- loss: 2.109988, loss_ss: 1.277362, loss_d: 0.832626
0.6128 --- loss: 1.559743, loss_ss: 1.229834, loss_d: 0.329908
0.6511 --- loss: 2.096303, loss_ss: 1.128793, loss_d: 0.967509
0.6894 --- loss: 2.224357, loss_ss: 1.483982, loss_d: 0.740375
0.7277 --- loss: 1.991905, loss_ss: 1.379754, loss_d: 0.612151
0.7660 --- loss: 1.831463, loss_ss: 1.248328, loss_d: 0.583134
0.8043 --- loss: 2.417914, loss_ss: 2.088327, loss_d: 0.329587
0.8426 --- loss: 1.544258, loss_ss: 1.031103, loss_d: 0.513155
0.8809 --- loss: 1.545360, loss_ss: 1.280042, loss_d: 0.265318
0.9192 --- loss: 2.169796, loss_ss: 1.376658, loss_d: 0.793138
0.9575 --- loss: 1.858906, loss_ss: 1.088285, loss_d: 0.770621
0.9958 --- loss: 1.827698, loss_ss: 1.049641, loss_d: 0.778057
Epoch finished! Loss: 1.9337435234552143
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.684477, loss_ss: 1.029229, loss_d: 0.655248
0.0383 --- loss: 1.264842, loss_ss: 0.958961, loss_d: 0.305881
0.0766 --- loss: 1.688934, loss_ss: 1.240439, loss_d: 0.448496
0.1149 --- loss: 1.794040, loss_ss: 1.253726, loss_d: 0.540314
0.1532 --- loss: 1.934998, loss_ss: 1.334929, loss_d: 0.600069
0.1915 --- loss: 1.581301, loss_ss: 1.047895, loss_d: 0.533406
0.2298 --- loss: 1.238259, loss_ss: 0.956493, loss_d: 0.281765
0.2681 --- loss: 1.810050, loss_ss: 1.212812, loss_d: 0.597238
0.3064 --- loss: 2.082957, loss_ss: 1.381055, loss_d: 0.701903
0.3447 --- loss: 1.860597, loss_ss: 1.453508, loss_d: 0.407089
0.3830 --- loss: 1.507958, loss_ss: 1.116545, loss_d: 0.391414
0.4213 --- loss: 1.688598, loss_ss: 1.076297, loss_d: 0.612302
0.4596 --- loss: 1.572750, loss_ss: 1.045048, loss_d: 0.527702
0.4979 --- loss: 1.753034, loss_ss: 0.972622, loss_d: 0.780412
0.5362 --- loss: 1.794047, loss_ss: 0.990118, loss_d: 0.803929
0.5745 --- loss: 1.692202, loss_ss: 1.081509, loss_d: 0.610693
0.6128 --- loss: 1.518109, loss_ss: 1.014525, loss_d: 0.503583
0.6511 --- loss: 1.910357, loss_ss: 1.594567, loss_d: 0.315789
0.6894 --- loss: 1.329324, loss_ss: 0.962785, loss_d: 0.366539
0.7277 --- loss: 1.666095, loss_ss: 1.164014, loss_d: 0.502082
0.7660 --- loss: 2.077826, loss_ss: 1.381940, loss_d: 0.695886
0.8043 --- loss: 1.431650, loss_ss: 0.874056, loss_d: 0.557594
0.8426 --- loss: 1.585863, loss_ss: 1.058409, loss_d: 0.527455
0.8809 --- loss: 1.478675, loss_ss: 1.107999, loss_d: 0.370676
0.9192 --- loss: 1.573729, loss_ss: 1.053456, loss_d: 0.520273
0.9575 --- loss: 1.643592, loss_ss: 0.901204, loss_d: 0.742388
0.9958 --- loss: 1.851366, loss_ss: 1.316472, loss_d: 0.534894
Epoch finished! Loss: 1.7124009310514077
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.795397, loss_ss: 1.233346, loss_d: 0.562051
0.0383 --- loss: 1.386079, loss_ss: 0.958065, loss_d: 0.428015
0.0766 --- loss: 1.485097, loss_ss: 0.988061, loss_d: 0.497036
0.1149 --- loss: 2.015407, loss_ss: 1.487593, loss_d: 0.527814
0.1532 --- loss: 1.696557, loss_ss: 1.008215, loss_d: 0.688341
0.1915 --- loss: 1.733958, loss_ss: 1.384417, loss_d: 0.349541
0.2298 --- loss: 1.792670, loss_ss: 1.076610, loss_d: 0.716060
0.2681 --- loss: 1.472266, loss_ss: 0.901049, loss_d: 0.571217
0.3064 --- loss: 1.464424, loss_ss: 1.062487, loss_d: 0.401938
0.3447 --- loss: 1.501328, loss_ss: 0.803912, loss_d: 0.697416
0.3830 --- loss: 1.585603, loss_ss: 1.117659, loss_d: 0.467945
0.4213 --- loss: 1.290323, loss_ss: 0.880430, loss_d: 0.409893
0.4596 --- loss: 1.566014, loss_ss: 0.905362, loss_d: 0.660652
0.4979 --- loss: 1.406293, loss_ss: 0.751151, loss_d: 0.655142
0.5362 --- loss: 1.362283, loss_ss: 0.965886, loss_d: 0.396397
0.5745 --- loss: 1.841928, loss_ss: 1.251032, loss_d: 0.590896
0.6128 --- loss: 1.767578, loss_ss: 1.049602, loss_d: 0.717976
0.6511 --- loss: 1.410880, loss_ss: 0.965665, loss_d: 0.445215
0.6894 --- loss: 1.928818, loss_ss: 1.225051, loss_d: 0.703766
0.7277 --- loss: 1.514764, loss_ss: 0.958458, loss_d: 0.556306
0.7660 --- loss: 1.301419, loss_ss: 1.001823, loss_d: 0.299597
0.8043 --- loss: 1.699229, loss_ss: 1.094481, loss_d: 0.604747
0.8426 --- loss: 1.458337, loss_ss: 0.931084, loss_d: 0.527253
0.8809 --- loss: 1.807978, loss_ss: 1.190267, loss_d: 0.617711
0.9192 --- loss: 1.809062, loss_ss: 1.181581, loss_d: 0.627481
0.9575 --- loss: 1.447464, loss_ss: 0.989675, loss_d: 0.457790
0.9958 --- loss: 1.681490, loss_ss: 1.216024, loss_d: 0.465465
Epoch finished! Loss: 1.6244526137794115
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.389663, loss_ss: 1.046574, loss_d: 0.343089
0.0383 --- loss: 1.299237, loss_ss: 0.873693, loss_d: 0.425544
0.0766 --- loss: 1.565505, loss_ss: 1.014644, loss_d: 0.550861
0.1149 --- loss: 1.420315, loss_ss: 0.996642, loss_d: 0.423673
0.1532 --- loss: 1.657209, loss_ss: 1.230283, loss_d: 0.426926
0.1915 --- loss: 1.461356, loss_ss: 0.973390, loss_d: 0.487965
0.2298 --- loss: 1.562647, loss_ss: 0.997561, loss_d: 0.565086
0.2681 --- loss: 1.479702, loss_ss: 1.068334, loss_d: 0.411368
0.3064 --- loss: 1.764697, loss_ss: 1.025389, loss_d: 0.739308
0.3447 --- loss: 1.611597, loss_ss: 0.946387, loss_d: 0.665210
0.3830 --- loss: 1.604175, loss_ss: 1.179599, loss_d: 0.424576
0.4213 --- loss: 1.735717, loss_ss: 0.968293, loss_d: 0.767424
0.4596 --- loss: 1.645051, loss_ss: 0.970092, loss_d: 0.674959
0.4979 --- loss: 1.789902, loss_ss: 0.967479, loss_d: 0.822423
0.5362 --- loss: 1.533346, loss_ss: 0.964270, loss_d: 0.569076
0.5745 --- loss: 1.347021, loss_ss: 0.908209, loss_d: 0.438811
0.6128 --- loss: 1.464791, loss_ss: 0.948751, loss_d: 0.516040
0.6511 --- loss: 1.739361, loss_ss: 1.046129, loss_d: 0.693231
0.6894 --- loss: 1.643026, loss_ss: 1.304193, loss_d: 0.338833
0.7277 --- loss: 1.333318, loss_ss: 0.820487, loss_d: 0.512831
0.7660 --- loss: 1.578721, loss_ss: 1.026384, loss_d: 0.552337
0.8043 --- loss: 1.512204, loss_ss: 1.069990, loss_d: 0.442215
0.8426 --- loss: 1.460421, loss_ss: 0.935561, loss_d: 0.524860
0.8809 --- loss: 1.522004, loss_ss: 0.925963, loss_d: 0.596042
0.9192 --- loss: 1.431831, loss_ss: 0.977656, loss_d: 0.454175
0.9575 --- loss: 1.446656, loss_ss: 0.850691, loss_d: 0.595965
0.9958 --- loss: 1.643167, loss_ss: 0.936261, loss_d: 0.706906
Epoch finished! Loss: 1.557091524774544
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.592164, loss_ss: 1.064700, loss_d: 0.527464
0.0383 --- loss: 1.261199, loss_ss: 0.767457, loss_d: 0.493741
0.0766 --- loss: 1.311425, loss_ss: 0.956579, loss_d: 0.354846
0.1149 --- loss: 1.184684, loss_ss: 0.784782, loss_d: 0.399901
0.1532 --- loss: 1.276053, loss_ss: 0.760036, loss_d: 0.516018
0.1915 --- loss: 1.422083, loss_ss: 0.983615, loss_d: 0.438469
0.2298 --- loss: 1.659854, loss_ss: 1.300763, loss_d: 0.359091
0.2681 --- loss: 1.443257, loss_ss: 0.958605, loss_d: 0.484652
0.3064 --- loss: 1.612563, loss_ss: 0.885431, loss_d: 0.727132
0.3447 --- loss: 1.492883, loss_ss: 0.959256, loss_d: 0.533626
0.3830 --- loss: 1.263542, loss_ss: 0.816795, loss_d: 0.446747
0.4213 --- loss: 1.540225, loss_ss: 1.137229, loss_d: 0.402996
0.4596 --- loss: 1.550610, loss_ss: 0.987968, loss_d: 0.562642
0.4979 --- loss: 1.884701, loss_ss: 1.345837, loss_d: 0.538863
0.5362 --- loss: 1.194480, loss_ss: 0.883089, loss_d: 0.311390
0.5745 --- loss: 1.110816, loss_ss: 0.803020, loss_d: 0.307796
0.6128 --- loss: 1.770960, loss_ss: 1.221761, loss_d: 0.549199
0.6511 --- loss: 1.602399, loss_ss: 0.892444, loss_d: 0.709955
0.6894 --- loss: 1.654838, loss_ss: 1.245732, loss_d: 0.409106
0.7277 --- loss: 1.249322, loss_ss: 0.909110, loss_d: 0.340212
0.7660 --- loss: 1.127554, loss_ss: 0.862983, loss_d: 0.264571
0.8043 --- loss: 1.225539, loss_ss: 0.768844, loss_d: 0.456694
0.8426 --- loss: 1.610259, loss_ss: 1.251751, loss_d: 0.358508
0.8809 --- loss: 1.663289, loss_ss: 1.374376, loss_d: 0.288913
0.9192 --- loss: 1.593848, loss_ss: 0.858056, loss_d: 0.735792
0.9575 --- loss: 1.637929, loss_ss: 1.119526, loss_d: 0.518403
0.9958 --- loss: 1.798023, loss_ss: 0.830201, loss_d: 0.967822
Epoch finished! Loss: 1.4676611501138328
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.410506, loss_ss: 0.925608, loss_d: 0.484898
0.0383 --- loss: 1.909454, loss_ss: 0.815122, loss_d: 1.094332
0.0766 --- loss: 1.126363, loss_ss: 0.873889, loss_d: 0.252474
0.1149 --- loss: 1.413150, loss_ss: 0.774155, loss_d: 0.638994
0.1532 --- loss: 1.524533, loss_ss: 0.756174, loss_d: 0.768359
0.1915 --- loss: 1.195097, loss_ss: 0.942563, loss_d: 0.252535
0.2298 --- loss: 1.291149, loss_ss: 0.922866, loss_d: 0.368282
0.2681 --- loss: 1.956532, loss_ss: 1.008218, loss_d: 0.948314
0.3064 --- loss: 1.185873, loss_ss: 0.838456, loss_d: 0.347417
0.3447 --- loss: 1.913267, loss_ss: 1.167853, loss_d: 0.745414
0.3830 --- loss: 1.308781, loss_ss: 0.850617, loss_d: 0.458164
0.4213 --- loss: 1.273952, loss_ss: 0.996886, loss_d: 0.277065
0.4596 --- loss: 1.468162, loss_ss: 1.221341, loss_d: 0.246822
0.4979 --- loss: 1.668739, loss_ss: 1.199533, loss_d: 0.469207
0.5362 --- loss: 1.546176, loss_ss: 1.075439, loss_d: 0.470737
0.5745 --- loss: 1.362301, loss_ss: 0.801449, loss_d: 0.560852
0.6128 --- loss: 1.712889, loss_ss: 1.242104, loss_d: 0.470785
0.6511 --- loss: 1.134930, loss_ss: 0.930600, loss_d: 0.204330
0.6894 --- loss: 1.019134, loss_ss: 0.647558, loss_d: 0.371576
0.7277 --- loss: 0.850531, loss_ss: 0.688902, loss_d: 0.161629
0.7660 --- loss: 1.395836, loss_ss: 1.171883, loss_d: 0.223953
0.8043 --- loss: 1.123783, loss_ss: 0.781803, loss_d: 0.341981
0.8426 --- loss: 1.300014, loss_ss: 1.045351, loss_d: 0.254664
0.8809 --- loss: 1.121986, loss_ss: 0.860409, loss_d: 0.261577
0.9192 --- loss: 1.100067, loss_ss: 0.835117, loss_d: 0.264949
0.9575 --- loss: 1.822828, loss_ss: 0.950153, loss_d: 0.872675
0.9958 --- loss: 1.361909, loss_ss: 0.878535, loss_d: 0.483374
Epoch finished! Loss: 1.3771389533276759
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.142413, loss_ss: 0.923134, loss_d: 0.219279
0.0383 --- loss: 1.156481, loss_ss: 0.972234, loss_d: 0.184247
0.0766 --- loss: 1.530529, loss_ss: 1.076492, loss_d: 0.454037
0.1149 --- loss: 1.388824, loss_ss: 0.958359, loss_d: 0.430465
0.1532 --- loss: 1.393597, loss_ss: 0.989536, loss_d: 0.404061
0.1915 --- loss: 1.183675, loss_ss: 0.803279, loss_d: 0.380396
0.2298 --- loss: 1.264315, loss_ss: 0.978817, loss_d: 0.285498
0.2681 --- loss: 1.319301, loss_ss: 1.079589, loss_d: 0.239712
0.3064 --- loss: 1.397115, loss_ss: 0.968565, loss_d: 0.428551
0.3447 --- loss: 1.476922, loss_ss: 0.931353, loss_d: 0.545569
0.3830 --- loss: 1.373177, loss_ss: 0.895144, loss_d: 0.478033
0.4213 --- loss: 1.133072, loss_ss: 0.967833, loss_d: 0.165239
0.4596 --- loss: 0.936882, loss_ss: 0.736602, loss_d: 0.200280
0.4979 --- loss: 1.465647, loss_ss: 0.941764, loss_d: 0.523883
0.5362 --- loss: 1.279441, loss_ss: 1.166569, loss_d: 0.112871
0.5745 --- loss: 1.117508, loss_ss: 0.924282, loss_d: 0.193226
0.6128 --- loss: 1.099614, loss_ss: 0.674412, loss_d: 0.425202
0.6511 --- loss: 1.024396, loss_ss: 0.855660, loss_d: 0.168736
0.6894 --- loss: 1.422881, loss_ss: 1.261615, loss_d: 0.161266
0.7277 --- loss: 1.302243, loss_ss: 1.041954, loss_d: 0.260289
0.7660 --- loss: 1.508634, loss_ss: 0.825423, loss_d: 0.683210
0.8043 --- loss: 1.141387, loss_ss: 0.657603, loss_d: 0.483784
0.8426 --- loss: 1.104546, loss_ss: 0.756781, loss_d: 0.347765
0.8809 --- loss: 1.646968, loss_ss: 0.840469, loss_d: 0.806499
0.9192 --- loss: 1.077135, loss_ss: 0.884267, loss_d: 0.192868
0.9575 --- loss: 1.889930, loss_ss: 0.832597, loss_d: 1.057333
0.9958 --- loss: 1.599255, loss_ss: 0.887870, loss_d: 0.711385
Epoch finished! Loss: 1.309200968093799
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.067693, loss_ss: 0.797293, loss_d: 0.270400
0.0383 --- loss: 0.997873, loss_ss: 0.599160, loss_d: 0.398713
0.0766 --- loss: 1.066536, loss_ss: 0.840261, loss_d: 0.226275
0.1149 --- loss: 1.030565, loss_ss: 0.756299, loss_d: 0.274265
0.1532 --- loss: 1.306108, loss_ss: 1.046210, loss_d: 0.259898
0.1915 --- loss: 1.152810, loss_ss: 0.874252, loss_d: 0.278558
0.2298 --- loss: 1.497178, loss_ss: 1.085049, loss_d: 0.412129
0.2681 --- loss: 1.396285, loss_ss: 1.191905, loss_d: 0.204379
0.3064 --- loss: 1.422545, loss_ss: 1.006969, loss_d: 0.415576
0.3447 --- loss: 1.213658, loss_ss: 1.014153, loss_d: 0.199505
0.3830 --- loss: 1.266131, loss_ss: 0.672006, loss_d: 0.594125
0.4213 --- loss: 1.047420, loss_ss: 0.739449, loss_d: 0.307971
0.4596 --- loss: 1.671283, loss_ss: 0.957384, loss_d: 0.713899
0.4979 --- loss: 1.244145, loss_ss: 0.844320, loss_d: 0.399825
0.5362 --- loss: 1.243161, loss_ss: 0.974402, loss_d: 0.268759
0.5745 --- loss: 1.742589, loss_ss: 1.184868, loss_d: 0.557721
0.6128 --- loss: 0.963419, loss_ss: 0.767095, loss_d: 0.196324
0.6511 --- loss: 1.210899, loss_ss: 0.769518, loss_d: 0.441381
0.6894 --- loss: 1.153891, loss_ss: 0.843324, loss_d: 0.310567
0.7277 --- loss: 0.980862, loss_ss: 0.815027, loss_d: 0.165835
0.7660 --- loss: 1.796559, loss_ss: 1.377436, loss_d: 0.419123
0.8043 --- loss: 1.605559, loss_ss: 0.865354, loss_d: 0.740205
0.8426 --- loss: 1.252264, loss_ss: 0.804492, loss_d: 0.447772
0.8809 --- loss: 1.670902, loss_ss: 1.052602, loss_d: 0.618300
0.9192 --- loss: 0.913621, loss_ss: 0.707044, loss_d: 0.206577
0.9575 --- loss: 1.664389, loss_ss: 0.801993, loss_d: 0.862396
0.9958 --- loss: 0.958031, loss_ss: 0.724561, loss_d: 0.233470
Epoch finished! Loss: 1.2589511476257296
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.332579, loss_ss: 1.091923, loss_d: 0.240655
0.0383 --- loss: 1.565891, loss_ss: 0.949599, loss_d: 0.616292
0.0766 --- loss: 1.472756, loss_ss: 0.872039, loss_d: 0.600717
0.1149 --- loss: 1.261217, loss_ss: 1.050600, loss_d: 0.210616
0.1532 --- loss: 1.338724, loss_ss: 0.690720, loss_d: 0.648005
0.1915 --- loss: 1.259385, loss_ss: 1.005237, loss_d: 0.254149
0.2298 --- loss: 1.064831, loss_ss: 0.910491, loss_d: 0.154341
0.2681 --- loss: 1.677042, loss_ss: 1.155115, loss_d: 0.521927
0.3064 --- loss: 1.099927, loss_ss: 1.023983, loss_d: 0.075944
0.3447 --- loss: 0.897997, loss_ss: 0.764871, loss_d: 0.133127
0.3830 --- loss: 1.424889, loss_ss: 1.095507, loss_d: 0.329382
0.4213 --- loss: 2.081988, loss_ss: 0.832757, loss_d: 1.249231
0.4596 --- loss: 1.279655, loss_ss: 1.062947, loss_d: 0.216707
0.4979 --- loss: 1.052813, loss_ss: 0.859163, loss_d: 0.193651
0.5362 --- loss: 1.236084, loss_ss: 1.060439, loss_d: 0.175645
0.5745 --- loss: 1.079723, loss_ss: 0.950405, loss_d: 0.129317
0.6128 --- loss: 0.834682, loss_ss: 0.759070, loss_d: 0.075613
0.6511 --- loss: 1.358777, loss_ss: 0.966608, loss_d: 0.392169
0.6894 --- loss: 1.199415, loss_ss: 0.954848, loss_d: 0.244567
0.7277 --- loss: 1.499884, loss_ss: 1.134952, loss_d: 0.364932
0.7660 --- loss: 1.204776, loss_ss: 0.870259, loss_d: 0.334516
0.8043 --- loss: 1.715964, loss_ss: 1.292775, loss_d: 0.423189
0.8426 --- loss: 0.697434, loss_ss: 0.543395, loss_d: 0.154038
0.8809 --- loss: 0.936569, loss_ss: 0.784844, loss_d: 0.151726
0.9192 --- loss: 0.917482, loss_ss: 0.717531, loss_d: 0.199951
0.9575 --- loss: 0.867277, loss_ss: 0.727154, loss_d: 0.140123
0.9958 --- loss: 1.101669, loss_ss: 0.857131, loss_d: 0.244538
Epoch finished! Loss: 1.218819733323722
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.537962, loss_ss: 0.929335, loss_d: 0.608628
0.0383 --- loss: 1.642637, loss_ss: 1.236992, loss_d: 0.405645
0.0766 --- loss: 0.927270, loss_ss: 0.639460, loss_d: 0.287811
0.1149 --- loss: 0.968835, loss_ss: 0.821688, loss_d: 0.147147
0.1532 --- loss: 1.345481, loss_ss: 1.118400, loss_d: 0.227080
0.1915 --- loss: 1.033453, loss_ss: 0.796761, loss_d: 0.236692
0.2298 --- loss: 1.370027, loss_ss: 0.786657, loss_d: 0.583370
0.2681 --- loss: 1.059172, loss_ss: 0.927029, loss_d: 0.132142
0.3064 --- loss: 1.394326, loss_ss: 1.051945, loss_d: 0.342381
0.3447 --- loss: 0.799542, loss_ss: 0.656179, loss_d: 0.143363
0.3830 --- loss: 1.150512, loss_ss: 0.940194, loss_d: 0.210318
0.4213 --- loss: 1.089416, loss_ss: 0.891565, loss_d: 0.197852
0.4596 --- loss: 0.940138, loss_ss: 0.602689, loss_d: 0.337449
0.4979 --- loss: 1.045131, loss_ss: 0.779396, loss_d: 0.265736
0.5362 --- loss: 0.822466, loss_ss: 0.637310, loss_d: 0.185156
0.5745 --- loss: 1.063645, loss_ss: 0.761736, loss_d: 0.301909
0.6128 --- loss: 1.161359, loss_ss: 0.859325, loss_d: 0.302034
0.6511 --- loss: 1.041581, loss_ss: 0.842839, loss_d: 0.198742
0.6894 --- loss: 1.134969, loss_ss: 0.994838, loss_d: 0.140132
0.7277 --- loss: 1.393005, loss_ss: 1.024845, loss_d: 0.368160
0.7660 --- loss: 0.893788, loss_ss: 0.573209, loss_d: 0.320579
0.8043 --- loss: 0.726683, loss_ss: 0.660228, loss_d: 0.066455
0.8426 --- loss: 0.884190, loss_ss: 0.704637, loss_d: 0.179554
0.8809 --- loss: 1.202197, loss_ss: 0.904947, loss_d: 0.297250
0.9192 --- loss: 1.418417, loss_ss: 1.038011, loss_d: 0.380406
0.9575 --- loss: 1.210378, loss_ss: 0.811029, loss_d: 0.399349
0.9958 --- loss: 1.267850, loss_ss: 1.019216, loss_d: 0.248634
Epoch finished! Loss: 1.1971491330884882
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7679012345679013
             precision    recall  f1-score   support

        0.0       0.64      0.33      0.44       102
        1.0       0.00      0.00      0.00        15
        2.0       0.85      0.89      0.87       397
        3.0       0.91      0.74      0.81       187
        4.0       0.52      0.90      0.66       109

avg / total       0.78      0.77      0.76       810
 


====== chc022-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  89.26  33.33   97.32  64.15     43.87
1  98.02   0.00   99.87   0.00      0.00
2  86.79  88.66   84.99  85.02     86.81
3  92.22  73.80   97.75  90.79     81.42
4  87.28  89.91   86.88  51.58     65.55
Total accuracy: 76.79%
Average sen: 57.14%
Average spec: 93.36%
Macro f1-score: 55.53%
Diagnosis acc on 15mins: 1.0
[0.43555173 0.16865014 0.44740552 0.07190394 0.05646583 0.21236868
 0.08496195 0.06115719 0.08510452 0.04929017 0.05378819 0.08755147
 0.05993072 0.1451436  0.24130246 0.03764787 0.05239201 0.07195733
 0.14382076 0.21893947 0.10274442 0.13298592 0.1224535  0.09815355
 0.01798691 0.13445233 0.11896787]
pred: 0.13011400091151396, label: 0
Right! Diagnosis: Other

=== Test on chc025-nsrr. train_data(2611), test_data(27) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.344801, loss_ss: 1.684530, loss_d: 0.660271
0.0383 --- loss: 2.801758, loss_ss: 1.701278, loss_d: 1.100480
0.0766 --- loss: 2.617199, loss_ss: 1.605976, loss_d: 1.011222
0.1149 --- loss: 2.215083, loss_ss: 1.624309, loss_d: 0.590774
0.1532 --- loss: 2.297732, loss_ss: 1.695463, loss_d: 0.602269
0.1915 --- loss: 1.919219, loss_ss: 1.543396, loss_d: 0.375823
0.2298 --- loss: 2.137626, loss_ss: 1.583091, loss_d: 0.554535
0.2681 --- loss: 2.171958, loss_ss: 1.549344, loss_d: 0.622615
0.3064 --- loss: 1.901106, loss_ss: 1.520274, loss_d: 0.380832
0.3447 --- loss: 2.250545, loss_ss: 1.600064, loss_d: 0.650481
0.3830 --- loss: 2.118551, loss_ss: 1.480965, loss_d: 0.637586
0.4213 --- loss: 2.088086, loss_ss: 1.403610, loss_d: 0.684475
0.4596 --- loss: 2.001961, loss_ss: 1.349925, loss_d: 0.652036
0.4979 --- loss: 1.647577, loss_ss: 1.328871, loss_d: 0.318706
0.5362 --- loss: 2.106550, loss_ss: 1.432313, loss_d: 0.674237
0.5745 --- loss: 1.952081, loss_ss: 1.466221, loss_d: 0.485860
0.6128 --- loss: 1.863236, loss_ss: 1.364419, loss_d: 0.498817
0.6511 --- loss: 2.088927, loss_ss: 1.400822, loss_d: 0.688105
0.6894 --- loss: 1.822947, loss_ss: 1.255439, loss_d: 0.567508
0.7277 --- loss: 1.983799, loss_ss: 1.430170, loss_d: 0.553629
0.7660 --- loss: 1.840046, loss_ss: 1.321732, loss_d: 0.518314
0.8043 --- loss: 1.743002, loss_ss: 1.193444, loss_d: 0.549558
0.8426 --- loss: 1.689404, loss_ss: 1.194247, loss_d: 0.495157
0.8809 --- loss: 1.877822, loss_ss: 1.242081, loss_d: 0.635741
0.9192 --- loss: 2.031675, loss_ss: 1.408529, loss_d: 0.623146
0.9575 --- loss: 1.777724, loss_ss: 1.285389, loss_d: 0.492335
0.9958 --- loss: 1.959429, loss_ss: 1.371410, loss_d: 0.588018
Epoch finished! Loss: 2.040386322814386
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.797000, loss_ss: 1.351279, loss_d: 0.445722
0.0383 --- loss: 1.821611, loss_ss: 1.321348, loss_d: 0.500263
0.0766 --- loss: 1.529423, loss_ss: 1.195476, loss_d: 0.333947
0.1149 --- loss: 1.859654, loss_ss: 1.418137, loss_d: 0.441517
0.1532 --- loss: 2.109125, loss_ss: 1.381024, loss_d: 0.728100
0.1915 --- loss: 1.689236, loss_ss: 1.069031, loss_d: 0.620205
0.2298 --- loss: 1.721365, loss_ss: 1.209980, loss_d: 0.511385
0.2681 --- loss: 1.589758, loss_ss: 1.250062, loss_d: 0.339695
0.3064 --- loss: 1.542952, loss_ss: 1.164404, loss_d: 0.378548
0.3447 --- loss: 1.763515, loss_ss: 1.269645, loss_d: 0.493870
0.3830 --- loss: 1.861870, loss_ss: 1.245144, loss_d: 0.616726
0.4213 --- loss: 1.976384, loss_ss: 1.309317, loss_d: 0.667067
0.4596 --- loss: 1.919136, loss_ss: 1.328459, loss_d: 0.590677
0.4979 --- loss: 1.866481, loss_ss: 1.153308, loss_d: 0.713173
0.5362 --- loss: 1.654946, loss_ss: 1.212032, loss_d: 0.442914
0.5745 --- loss: 1.715760, loss_ss: 1.106812, loss_d: 0.608948
0.6128 --- loss: 1.755773, loss_ss: 1.225599, loss_d: 0.530173
0.6511 --- loss: 1.995001, loss_ss: 1.122216, loss_d: 0.872785
0.6894 --- loss: 1.639365, loss_ss: 1.125519, loss_d: 0.513846
0.7277 --- loss: 1.709049, loss_ss: 1.272598, loss_d: 0.436451
0.7660 --- loss: 1.519251, loss_ss: 1.095543, loss_d: 0.423708
0.8043 --- loss: 1.803124, loss_ss: 1.265699, loss_d: 0.537425
0.8426 --- loss: 1.711790, loss_ss: 1.217165, loss_d: 0.494625
0.8809 --- loss: 1.344119, loss_ss: 1.022848, loss_d: 0.321271
0.9192 --- loss: 1.710663, loss_ss: 1.156681, loss_d: 0.553982
0.9575 --- loss: 2.270608, loss_ss: 1.363236, loss_d: 0.907372
0.9958 --- loss: 1.618582, loss_ss: 1.189550, loss_d: 0.429031
Epoch finished! Loss: 1.8138441948141633
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.445861, loss_ss: 1.043883, loss_d: 0.401978
0.0383 --- loss: 1.644619, loss_ss: 1.097846, loss_d: 0.546773
0.0766 --- loss: 1.587925, loss_ss: 0.973382, loss_d: 0.614543
0.1149 --- loss: 1.464561, loss_ss: 0.888973, loss_d: 0.575589
0.1532 --- loss: 1.844074, loss_ss: 1.117969, loss_d: 0.726105
0.1915 --- loss: 1.539138, loss_ss: 1.001180, loss_d: 0.537959
0.2298 --- loss: 1.609026, loss_ss: 1.123826, loss_d: 0.485200
0.2681 --- loss: 1.679201, loss_ss: 1.162143, loss_d: 0.517058
0.3064 --- loss: 1.659883, loss_ss: 1.084187, loss_d: 0.575697
0.3447 --- loss: 1.854333, loss_ss: 1.266734, loss_d: 0.587599
0.3830 --- loss: 1.816809, loss_ss: 1.215546, loss_d: 0.601263
0.4213 --- loss: 1.614403, loss_ss: 1.033870, loss_d: 0.580533
0.4596 --- loss: 1.584883, loss_ss: 0.991980, loss_d: 0.592902
0.4979 --- loss: 1.532106, loss_ss: 1.239411, loss_d: 0.292695
0.5362 --- loss: 1.619364, loss_ss: 1.058455, loss_d: 0.560909
0.5745 --- loss: 1.639089, loss_ss: 1.120908, loss_d: 0.518181
0.6128 --- loss: 1.784024, loss_ss: 1.230416, loss_d: 0.553608
0.6511 --- loss: 1.831351, loss_ss: 1.237270, loss_d: 0.594081
0.6894 --- loss: 1.597288, loss_ss: 1.131701, loss_d: 0.465588
0.7277 --- loss: 1.586381, loss_ss: 0.967968, loss_d: 0.618413
0.7660 --- loss: 1.444545, loss_ss: 0.941476, loss_d: 0.503069
0.8043 --- loss: 1.573343, loss_ss: 0.984303, loss_d: 0.589040
0.8426 --- loss: 1.640416, loss_ss: 1.194898, loss_d: 0.445518
0.8809 --- loss: 1.236266, loss_ss: 0.893518, loss_d: 0.342748
0.9192 --- loss: 1.592978, loss_ss: 1.125311, loss_d: 0.467667
0.9575 --- loss: 1.378810, loss_ss: 1.046588, loss_d: 0.332223
0.9958 --- loss: 1.655910, loss_ss: 1.131589, loss_d: 0.524321
Epoch finished! Loss: 1.6573057156412994
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.118064, loss_ss: 1.009181, loss_d: 1.108883
0.0383 --- loss: 1.496599, loss_ss: 0.891034, loss_d: 0.605565
0.0766 --- loss: 1.590457, loss_ss: 0.978418, loss_d: 0.612039
0.1149 --- loss: 1.531315, loss_ss: 1.180076, loss_d: 0.351239
0.1532 --- loss: 1.669614, loss_ss: 1.056214, loss_d: 0.613400
0.1915 --- loss: 1.438950, loss_ss: 1.116362, loss_d: 0.322589
0.2298 --- loss: 1.354045, loss_ss: 0.915994, loss_d: 0.438052
0.2681 --- loss: 1.622701, loss_ss: 0.899732, loss_d: 0.722969
0.3064 --- loss: 1.417771, loss_ss: 0.907431, loss_d: 0.510340
0.3447 --- loss: 1.751065, loss_ss: 1.003433, loss_d: 0.747632
0.3830 --- loss: 1.645147, loss_ss: 1.048597, loss_d: 0.596550
0.4213 --- loss: 1.608608, loss_ss: 1.148578, loss_d: 0.460030
0.4596 --- loss: 1.223930, loss_ss: 0.986601, loss_d: 0.237329
0.4979 --- loss: 1.374460, loss_ss: 0.870366, loss_d: 0.504095
0.5362 --- loss: 1.209347, loss_ss: 0.878070, loss_d: 0.331277
0.5745 --- loss: 1.760845, loss_ss: 0.988018, loss_d: 0.772827
0.6128 --- loss: 1.531682, loss_ss: 1.108050, loss_d: 0.423632
0.6511 --- loss: 1.596450, loss_ss: 0.982729, loss_d: 0.613721
0.6894 --- loss: 1.343269, loss_ss: 1.042978, loss_d: 0.300292
0.7277 --- loss: 1.463018, loss_ss: 1.227575, loss_d: 0.235443
0.7660 --- loss: 1.557740, loss_ss: 0.861412, loss_d: 0.696328
0.8043 --- loss: 1.517379, loss_ss: 0.955395, loss_d: 0.561984
0.8426 --- loss: 1.837083, loss_ss: 1.365187, loss_d: 0.471896
0.8809 --- loss: 1.439208, loss_ss: 1.019707, loss_d: 0.419501
0.9192 --- loss: 1.383316, loss_ss: 0.810666, loss_d: 0.572651
0.9575 --- loss: 1.479928, loss_ss: 0.956532, loss_d: 0.523396
0.9958 --- loss: 1.333526, loss_ss: 0.832755, loss_d: 0.500771
Epoch finished! Loss: 1.5307249958944504
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.397373, loss_ss: 1.049705, loss_d: 0.347668
0.0383 --- loss: 1.147631, loss_ss: 0.832854, loss_d: 0.314777
0.0766 --- loss: 1.814596, loss_ss: 1.434448, loss_d: 0.380148
0.1149 --- loss: 1.704178, loss_ss: 1.080296, loss_d: 0.623881
0.1532 --- loss: 1.687685, loss_ss: 0.873106, loss_d: 0.814579
0.1915 --- loss: 1.483722, loss_ss: 1.058679, loss_d: 0.425043
0.2298 --- loss: 2.099555, loss_ss: 1.475722, loss_d: 0.623833
0.2681 --- loss: 2.247050, loss_ss: 0.984696, loss_d: 1.262355
0.3064 --- loss: 1.348493, loss_ss: 1.036439, loss_d: 0.312053
0.3447 --- loss: 1.282238, loss_ss: 0.871852, loss_d: 0.410386
0.3830 --- loss: 1.192087, loss_ss: 0.907116, loss_d: 0.284971
0.4213 --- loss: 1.489758, loss_ss: 1.012523, loss_d: 0.477235
0.4596 --- loss: 1.081366, loss_ss: 0.690329, loss_d: 0.391037
0.4979 --- loss: 1.494338, loss_ss: 0.875737, loss_d: 0.618601
0.5362 --- loss: 1.311620, loss_ss: 0.822340, loss_d: 0.489280
0.5745 --- loss: 0.968507, loss_ss: 0.584676, loss_d: 0.383831
0.6128 --- loss: 1.396057, loss_ss: 0.977278, loss_d: 0.418779
0.6511 --- loss: 1.291178, loss_ss: 0.958096, loss_d: 0.333082
0.6894 --- loss: 1.317419, loss_ss: 0.988577, loss_d: 0.328842
0.7277 --- loss: 1.403104, loss_ss: 0.956556, loss_d: 0.446548
0.7660 --- loss: 1.397421, loss_ss: 0.976984, loss_d: 0.420438
0.8043 --- loss: 1.735090, loss_ss: 1.319718, loss_d: 0.415373
0.8426 --- loss: 1.185380, loss_ss: 0.802028, loss_d: 0.383352
0.8809 --- loss: 0.989201, loss_ss: 0.718148, loss_d: 0.271053
0.9192 --- loss: 1.546020, loss_ss: 0.898359, loss_d: 0.647661
0.9575 --- loss: 1.308738, loss_ss: 0.797918, loss_d: 0.510820
0.9958 --- loss: 1.084094, loss_ss: 0.818634, loss_d: 0.265460
Epoch finished! Loss: 1.4249350803108507
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.078296, loss_ss: 0.722855, loss_d: 0.355441
0.0383 --- loss: 1.197933, loss_ss: 0.856166, loss_d: 0.341767
0.0766 --- loss: 1.930178, loss_ss: 1.712076, loss_d: 0.218102
0.1149 --- loss: 1.240858, loss_ss: 0.948610, loss_d: 0.292248
0.1532 --- loss: 1.137595, loss_ss: 0.900604, loss_d: 0.236990
0.1915 --- loss: 1.427062, loss_ss: 0.996754, loss_d: 0.430308
0.2298 --- loss: 1.284841, loss_ss: 1.124922, loss_d: 0.159919
0.2681 --- loss: 1.116107, loss_ss: 0.915114, loss_d: 0.200993
0.3064 --- loss: 0.879359, loss_ss: 0.718302, loss_d: 0.161056
0.3447 --- loss: 1.338789, loss_ss: 0.853396, loss_d: 0.485392
0.3830 --- loss: 1.159922, loss_ss: 0.708892, loss_d: 0.451030
0.4213 --- loss: 1.149099, loss_ss: 0.815751, loss_d: 0.333347
0.4596 --- loss: 1.370771, loss_ss: 1.123481, loss_d: 0.247289
0.4979 --- loss: 1.440850, loss_ss: 0.907299, loss_d: 0.533551
0.5362 --- loss: 1.305200, loss_ss: 1.046806, loss_d: 0.258393
0.5745 --- loss: 1.687349, loss_ss: 1.205489, loss_d: 0.481859
0.6128 --- loss: 1.305412, loss_ss: 0.694366, loss_d: 0.611046
0.6511 --- loss: 1.278129, loss_ss: 0.917872, loss_d: 0.360257
0.6894 --- loss: 1.049086, loss_ss: 0.684411, loss_d: 0.364675
0.7277 --- loss: 1.254747, loss_ss: 0.895893, loss_d: 0.358854
0.7660 --- loss: 1.078616, loss_ss: 0.786116, loss_d: 0.292499
0.8043 --- loss: 1.065369, loss_ss: 0.734607, loss_d: 0.330763
0.8426 --- loss: 1.321431, loss_ss: 0.882771, loss_d: 0.438660
0.8809 --- loss: 1.144985, loss_ss: 0.744935, loss_d: 0.400049
0.9192 --- loss: 1.601090, loss_ss: 0.904576, loss_d: 0.696514
0.9575 --- loss: 1.648608, loss_ss: 0.959603, loss_d: 0.689004
0.9958 --- loss: 1.168852, loss_ss: 0.959615, loss_d: 0.209237
Epoch finished! Loss: 1.353503925818593
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.233533, loss_ss: 0.949841, loss_d: 0.283692
0.0383 --- loss: 1.026093, loss_ss: 0.674973, loss_d: 0.351119
0.0766 --- loss: 1.219543, loss_ss: 0.764800, loss_d: 0.454743
0.1149 --- loss: 1.048666, loss_ss: 0.831591, loss_d: 0.217075
0.1532 --- loss: 1.686741, loss_ss: 1.219785, loss_d: 0.466955
0.1915 --- loss: 1.275339, loss_ss: 0.707356, loss_d: 0.567983
0.2298 --- loss: 1.195061, loss_ss: 0.938552, loss_d: 0.256510
0.2681 --- loss: 1.064567, loss_ss: 0.948685, loss_d: 0.115882
0.3064 --- loss: 1.478252, loss_ss: 0.977388, loss_d: 0.500865
0.3447 --- loss: 1.583076, loss_ss: 1.069548, loss_d: 0.513528
0.3830 --- loss: 1.201367, loss_ss: 0.767865, loss_d: 0.433503
0.4213 --- loss: 1.219666, loss_ss: 1.027974, loss_d: 0.191693
0.4596 --- loss: 1.168037, loss_ss: 0.726551, loss_d: 0.441486
0.4979 --- loss: 1.372774, loss_ss: 0.922948, loss_d: 0.449826
0.5362 --- loss: 1.293376, loss_ss: 0.796037, loss_d: 0.497339
0.5745 --- loss: 1.029186, loss_ss: 0.754936, loss_d: 0.274250
0.6128 --- loss: 1.103273, loss_ss: 0.836354, loss_d: 0.266919
0.6511 --- loss: 1.422256, loss_ss: 1.280023, loss_d: 0.142233
0.6894 --- loss: 1.588278, loss_ss: 1.126776, loss_d: 0.461502
0.7277 --- loss: 1.580748, loss_ss: 1.273141, loss_d: 0.307607
0.7660 --- loss: 1.829931, loss_ss: 0.921619, loss_d: 0.908313
0.8043 --- loss: 1.277878, loss_ss: 0.930429, loss_d: 0.347450
0.8426 --- loss: 1.238052, loss_ss: 1.013995, loss_d: 0.224057
0.8809 --- loss: 1.172029, loss_ss: 0.754501, loss_d: 0.417528
0.9192 --- loss: 1.418730, loss_ss: 0.867437, loss_d: 0.551293
0.9575 --- loss: 1.220632, loss_ss: 1.071939, loss_d: 0.148693
0.9958 --- loss: 1.174996, loss_ss: 0.785677, loss_d: 0.389318
Epoch finished! Loss: 1.2668806643321597
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.092148, loss_ss: 0.875365, loss_d: 0.216782
0.0383 --- loss: 1.409727, loss_ss: 0.951302, loss_d: 0.458425
0.0766 --- loss: 1.151741, loss_ss: 0.912737, loss_d: 0.239004
0.1149 --- loss: 1.311855, loss_ss: 0.544952, loss_d: 0.766903
0.1532 --- loss: 1.086197, loss_ss: 0.735425, loss_d: 0.350772
0.1915 --- loss: 1.618582, loss_ss: 1.145291, loss_d: 0.473290
0.2298 --- loss: 1.216709, loss_ss: 0.553970, loss_d: 0.662739
0.2681 --- loss: 1.413240, loss_ss: 1.069932, loss_d: 0.343308
0.3064 --- loss: 1.224191, loss_ss: 1.043256, loss_d: 0.180935
0.3447 --- loss: 1.257615, loss_ss: 0.880973, loss_d: 0.376642
0.3830 --- loss: 1.202284, loss_ss: 1.032772, loss_d: 0.169512
0.4213 --- loss: 1.022825, loss_ss: 0.754939, loss_d: 0.267886
0.4596 --- loss: 1.640057, loss_ss: 0.969467, loss_d: 0.670590
0.4979 --- loss: 0.856702, loss_ss: 0.687953, loss_d: 0.168750
0.5362 --- loss: 1.644398, loss_ss: 1.136586, loss_d: 0.507812
0.5745 --- loss: 1.136389, loss_ss: 0.901847, loss_d: 0.234543
0.6128 --- loss: 1.069726, loss_ss: 0.796133, loss_d: 0.273593
0.6511 --- loss: 1.461358, loss_ss: 0.789539, loss_d: 0.671819
0.6894 --- loss: 1.215633, loss_ss: 0.860570, loss_d: 0.355063
0.7277 --- loss: 0.970712, loss_ss: 0.775610, loss_d: 0.195102
0.7660 --- loss: 1.041788, loss_ss: 0.778165, loss_d: 0.263624
0.8043 --- loss: 1.354619, loss_ss: 1.196873, loss_d: 0.157745
0.8426 --- loss: 1.053654, loss_ss: 0.674509, loss_d: 0.379145
0.8809 --- loss: 1.025515, loss_ss: 0.679688, loss_d: 0.345827
0.9192 --- loss: 0.904737, loss_ss: 0.660690, loss_d: 0.244047
0.9575 --- loss: 1.151146, loss_ss: 0.824411, loss_d: 0.326735
0.9958 --- loss: 1.105758, loss_ss: 0.958319, loss_d: 0.147439
Epoch finished! Loss: 1.229608682837066
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.704552, loss_ss: 0.561234, loss_d: 0.143318
0.0383 --- loss: 1.160489, loss_ss: 0.951464, loss_d: 0.209025
0.0766 --- loss: 1.251865, loss_ss: 1.052726, loss_d: 0.199139
0.1149 --- loss: 1.080452, loss_ss: 0.912945, loss_d: 0.167507
0.1532 --- loss: 1.207801, loss_ss: 0.975684, loss_d: 0.232117
0.1915 --- loss: 1.600549, loss_ss: 1.042161, loss_d: 0.558388
0.2298 --- loss: 1.074933, loss_ss: 0.766538, loss_d: 0.308395
0.2681 --- loss: 1.182135, loss_ss: 1.004579, loss_d: 0.177556
0.3064 --- loss: 0.951363, loss_ss: 0.712284, loss_d: 0.239079
0.3447 --- loss: 1.319464, loss_ss: 1.071630, loss_d: 0.247834
0.3830 --- loss: 1.626676, loss_ss: 1.054377, loss_d: 0.572299
0.4213 --- loss: 0.941731, loss_ss: 0.806358, loss_d: 0.135373
0.4596 --- loss: 1.188902, loss_ss: 0.925385, loss_d: 0.263516
0.4979 --- loss: 1.294801, loss_ss: 0.652158, loss_d: 0.642643
0.5362 --- loss: 1.268969, loss_ss: 0.925203, loss_d: 0.343767
0.5745 --- loss: 1.415241, loss_ss: 0.809639, loss_d: 0.605602
0.6128 --- loss: 1.627516, loss_ss: 1.078042, loss_d: 0.549474
0.6511 --- loss: 0.844058, loss_ss: 0.706588, loss_d: 0.137470
0.6894 --- loss: 1.006299, loss_ss: 0.783255, loss_d: 0.223044
0.7277 --- loss: 0.901273, loss_ss: 0.592580, loss_d: 0.308693
0.7660 --- loss: 1.115975, loss_ss: 0.826653, loss_d: 0.289322
0.8043 --- loss: 1.052545, loss_ss: 0.811953, loss_d: 0.240592
0.8426 --- loss: 1.094241, loss_ss: 0.883736, loss_d: 0.210504
0.8809 --- loss: 1.285610, loss_ss: 0.731216, loss_d: 0.554394
0.9192 --- loss: 1.105406, loss_ss: 0.856365, loss_d: 0.249041
0.9575 --- loss: 0.929687, loss_ss: 0.662289, loss_d: 0.267397
0.9958 --- loss: 1.682378, loss_ss: 1.358449, loss_d: 0.323929
Epoch finished! Loss: 1.181134500266035
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.213234, loss_ss: 0.773036, loss_d: 0.440197
0.0383 --- loss: 1.130313, loss_ss: 0.871320, loss_d: 0.258993
0.0766 --- loss: 0.991362, loss_ss: 0.834971, loss_d: 0.156391
0.1149 --- loss: 0.979503, loss_ss: 0.713074, loss_d: 0.266428
0.1532 --- loss: 0.992195, loss_ss: 0.784429, loss_d: 0.207766
0.1915 --- loss: 1.290635, loss_ss: 1.001976, loss_d: 0.288659
0.2298 --- loss: 0.978651, loss_ss: 0.837907, loss_d: 0.140744
0.2681 --- loss: 1.379685, loss_ss: 0.959989, loss_d: 0.419697
0.3064 --- loss: 1.061957, loss_ss: 0.894190, loss_d: 0.167766
0.3447 --- loss: 0.986514, loss_ss: 0.723286, loss_d: 0.263229
0.3830 --- loss: 0.820696, loss_ss: 0.513995, loss_d: 0.306701
0.4213 --- loss: 1.827701, loss_ss: 1.308358, loss_d: 0.519342
0.4596 --- loss: 1.007477, loss_ss: 0.858938, loss_d: 0.148538
0.4979 --- loss: 1.134821, loss_ss: 0.689935, loss_d: 0.444886
0.5362 --- loss: 0.866225, loss_ss: 0.794791, loss_d: 0.071434
0.5745 --- loss: 0.908934, loss_ss: 0.752824, loss_d: 0.156110
0.6128 --- loss: 0.807183, loss_ss: 0.657589, loss_d: 0.149594
0.6511 --- loss: 0.960349, loss_ss: 0.804676, loss_d: 0.155673
0.6894 --- loss: 1.503705, loss_ss: 0.695640, loss_d: 0.808065
0.7277 --- loss: 1.158212, loss_ss: 0.841067, loss_d: 0.317144
0.7660 --- loss: 1.555991, loss_ss: 1.066894, loss_d: 0.489097
0.8043 --- loss: 1.407006, loss_ss: 0.921573, loss_d: 0.485432
0.8426 --- loss: 1.065756, loss_ss: 0.746092, loss_d: 0.319664
0.8809 --- loss: 0.915106, loss_ss: 0.712303, loss_d: 0.202803
0.9192 --- loss: 1.357784, loss_ss: 0.993075, loss_d: 0.364709
0.9575 --- loss: 0.833232, loss_ss: 0.694706, loss_d: 0.138526
0.9958 --- loss: 1.127767, loss_ss: 1.002641, loss_d: 0.125126
Epoch finished! Loss: 1.142251011740659
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4691358024691358
             precision    recall  f1-score   support

        0.0       0.08      1.00      0.15        30
        1.0       0.00      0.00      0.00        67
        2.0       0.74      0.61      0.67       427
        3.0       1.00      0.31      0.47       114
        4.0       0.87      0.32      0.47       172

avg / total       0.72      0.47      0.52       810
 


====== chc025-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %   ppr %  f1-score
0  59.51  100.00   57.95    8.38     15.46
1  91.60    0.00   99.87    0.00      0.00
2  67.90   60.89   75.72   73.65     66.67
3  90.25   30.70  100.00  100.00     46.98
4  84.57   31.98   98.75   87.30     46.81
Total accuracy: 46.91%
Average sen: 44.71%
Average spec: 86.46%
Macro f1-score: 35.18%
Diagnosis acc on 15mins: 0.8518518518518519
[0.05934908 0.28333202 0.11988083 0.50865167 0.60419995 0.12881188
 0.04103008 0.12066267 0.01567341 0.0208507  0.00981686 0.00481715
 0.00157796 0.01142238 0.17450812 0.00463662 0.25257289 0.79515976
 0.15801463 0.14908747 0.08830148 0.01397501 0.02850149 0.01097003
 0.51012754 0.01296805 0.06957652]
pred: 0.15549912181665637, label: 0
Right! Diagnosis: Other

=== Test on chc027-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.391780, loss_ss: 1.699618, loss_d: 0.692162
0.0383 --- loss: 1.910178, loss_ss: 1.388377, loss_d: 0.521801
0.0767 --- loss: 1.816980, loss_ss: 1.357289, loss_d: 0.459690
0.1150 --- loss: 1.656334, loss_ss: 1.293649, loss_d: 0.362685
0.1534 --- loss: 2.021691, loss_ss: 1.448593, loss_d: 0.573098
0.1917 --- loss: 1.969011, loss_ss: 1.291627, loss_d: 0.677384
0.2301 --- loss: 1.727103, loss_ss: 1.332301, loss_d: 0.394802
0.2684 --- loss: 1.757934, loss_ss: 1.331841, loss_d: 0.426094
0.3067 --- loss: 2.083550, loss_ss: 1.452866, loss_d: 0.630684
0.3451 --- loss: 1.896235, loss_ss: 1.205141, loss_d: 0.691095
0.3834 --- loss: 2.106030, loss_ss: 1.506655, loss_d: 0.599374
0.4218 --- loss: 1.907920, loss_ss: 1.238420, loss_d: 0.669499
0.4601 --- loss: 1.645088, loss_ss: 1.205025, loss_d: 0.440063
0.4985 --- loss: 1.625946, loss_ss: 1.235008, loss_d: 0.390938
0.5368 --- loss: 1.804624, loss_ss: 1.277337, loss_d: 0.527287
0.5752 --- loss: 2.118362, loss_ss: 1.366698, loss_d: 0.751665
0.6135 --- loss: 1.909506, loss_ss: 1.105930, loss_d: 0.803575
0.6518 --- loss: 1.462850, loss_ss: 1.041660, loss_d: 0.421190
0.6902 --- loss: 1.774618, loss_ss: 1.187406, loss_d: 0.587212
0.7285 --- loss: 1.492444, loss_ss: 1.021098, loss_d: 0.471347
0.7669 --- loss: 1.598228, loss_ss: 1.046735, loss_d: 0.551493
0.8052 --- loss: 1.654440, loss_ss: 1.003391, loss_d: 0.651049
0.8436 --- loss: 1.699774, loss_ss: 1.212231, loss_d: 0.487543
0.8819 --- loss: 1.682614, loss_ss: 1.186825, loss_d: 0.495789
0.9202 --- loss: 1.633758, loss_ss: 0.991040, loss_d: 0.642718
0.9586 --- loss: 1.694148, loss_ss: 1.157894, loss_d: 0.536254
0.9969 --- loss: 1.274539, loss_ss: 1.000341, loss_d: 0.274198
Epoch finished! Loss: 1.8650848319897284
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.857213, loss_ss: 1.192586, loss_d: 0.664627
0.0383 --- loss: 1.492846, loss_ss: 0.996157, loss_d: 0.496689
0.0767 --- loss: 1.638757, loss_ss: 0.999864, loss_d: 0.638893
0.1150 --- loss: 1.355789, loss_ss: 1.014886, loss_d: 0.340903
0.1534 --- loss: 1.452323, loss_ss: 0.983058, loss_d: 0.469265
0.1917 --- loss: 1.657283, loss_ss: 1.076158, loss_d: 0.581125
0.2301 --- loss: 1.554669, loss_ss: 1.067551, loss_d: 0.487118
0.2684 --- loss: 1.524887, loss_ss: 1.055150, loss_d: 0.469738
0.3067 --- loss: 1.634367, loss_ss: 0.979590, loss_d: 0.654778
0.3451 --- loss: 1.803963, loss_ss: 1.181673, loss_d: 0.622291
0.3834 --- loss: 2.056168, loss_ss: 1.411809, loss_d: 0.644359
0.4218 --- loss: 1.897182, loss_ss: 1.279498, loss_d: 0.617684
0.4601 --- loss: 1.657449, loss_ss: 1.078390, loss_d: 0.579059
0.4985 --- loss: 1.692909, loss_ss: 0.967925, loss_d: 0.724984
0.5368 --- loss: 1.761196, loss_ss: 1.045112, loss_d: 0.716084
0.5752 --- loss: 1.512908, loss_ss: 0.976480, loss_d: 0.536427
0.6135 --- loss: 1.711585, loss_ss: 1.153194, loss_d: 0.558391
0.6518 --- loss: 1.388218, loss_ss: 1.103355, loss_d: 0.284863
0.6902 --- loss: 1.644161, loss_ss: 1.026227, loss_d: 0.617934
0.7285 --- loss: 1.571752, loss_ss: 1.121139, loss_d: 0.450613
0.7669 --- loss: 1.434915, loss_ss: 0.918057, loss_d: 0.516858
0.8052 --- loss: 1.615423, loss_ss: 1.077293, loss_d: 0.538130
0.8436 --- loss: 1.502834, loss_ss: 0.910445, loss_d: 0.592389
0.8819 --- loss: 1.557281, loss_ss: 1.057158, loss_d: 0.500123
0.9202 --- loss: 1.621300, loss_ss: 0.910322, loss_d: 0.710978
0.9586 --- loss: 1.416856, loss_ss: 0.855999, loss_d: 0.560857
0.9969 --- loss: 1.687774, loss_ss: 1.078246, loss_d: 0.609527
Epoch finished! Loss: 1.6640228615357326
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.958392, loss_ss: 1.385872, loss_d: 0.572519
0.0383 --- loss: 1.363787, loss_ss: 0.853664, loss_d: 0.510123
0.0767 --- loss: 1.784989, loss_ss: 1.080176, loss_d: 0.704813
0.1150 --- loss: 1.586128, loss_ss: 0.847674, loss_d: 0.738454
0.1534 --- loss: 1.361421, loss_ss: 0.881630, loss_d: 0.479791
0.1917 --- loss: 1.504221, loss_ss: 1.182710, loss_d: 0.321511
0.2301 --- loss: 1.962522, loss_ss: 1.177697, loss_d: 0.784826
0.2684 --- loss: 1.688969, loss_ss: 1.046004, loss_d: 0.642965
0.3067 --- loss: 1.759963, loss_ss: 1.015768, loss_d: 0.744196
0.3451 --- loss: 1.738827, loss_ss: 0.961437, loss_d: 0.777390
0.3834 --- loss: 1.397083, loss_ss: 0.846381, loss_d: 0.550702
0.4218 --- loss: 1.801442, loss_ss: 0.970277, loss_d: 0.831165
0.4601 --- loss: 1.646002, loss_ss: 1.068898, loss_d: 0.577105
0.4985 --- loss: 1.722549, loss_ss: 0.933619, loss_d: 0.788930
0.5368 --- loss: 1.856173, loss_ss: 1.308778, loss_d: 0.547395
0.5752 --- loss: 1.550910, loss_ss: 1.007298, loss_d: 0.543612
0.6135 --- loss: 1.257665, loss_ss: 0.827709, loss_d: 0.429956
0.6518 --- loss: 1.169777, loss_ss: 0.808409, loss_d: 0.361368
0.6902 --- loss: 1.489641, loss_ss: 1.070714, loss_d: 0.418926
0.7285 --- loss: 1.574637, loss_ss: 0.888062, loss_d: 0.686575
0.7669 --- loss: 1.421124, loss_ss: 1.052969, loss_d: 0.368155
0.8052 --- loss: 1.537374, loss_ss: 1.034348, loss_d: 0.503026
0.8436 --- loss: 1.228443, loss_ss: 0.936354, loss_d: 0.292088
0.8819 --- loss: 1.211169, loss_ss: 0.796614, loss_d: 0.414556
0.9202 --- loss: 1.503968, loss_ss: 0.947141, loss_d: 0.556826
0.9586 --- loss: 1.579414, loss_ss: 0.912449, loss_d: 0.666965
0.9969 --- loss: 1.663531, loss_ss: 0.910218, loss_d: 0.753312
Epoch finished! Loss: 1.5762687087059022
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.419254, loss_ss: 0.843084, loss_d: 0.576169
0.0383 --- loss: 1.240849, loss_ss: 0.771554, loss_d: 0.469295
0.0767 --- loss: 1.578975, loss_ss: 1.151098, loss_d: 0.427876
0.1150 --- loss: 1.594823, loss_ss: 0.923615, loss_d: 0.671209
0.1534 --- loss: 1.872273, loss_ss: 1.073950, loss_d: 0.798323
0.1917 --- loss: 1.627700, loss_ss: 0.823601, loss_d: 0.804098
0.2301 --- loss: 1.492878, loss_ss: 1.111218, loss_d: 0.381660
0.2684 --- loss: 2.030883, loss_ss: 1.465978, loss_d: 0.564905
0.3067 --- loss: 1.819920, loss_ss: 0.963853, loss_d: 0.856067
0.3451 --- loss: 1.231141, loss_ss: 0.848221, loss_d: 0.382920
0.3834 --- loss: 1.225134, loss_ss: 0.923534, loss_d: 0.301600
0.4218 --- loss: 1.418046, loss_ss: 0.806489, loss_d: 0.611557
0.4601 --- loss: 1.522554, loss_ss: 1.025793, loss_d: 0.496761
0.4985 --- loss: 1.779667, loss_ss: 1.141212, loss_d: 0.638455
0.5368 --- loss: 1.859358, loss_ss: 0.840367, loss_d: 1.018992
0.5752 --- loss: 1.640552, loss_ss: 0.979890, loss_d: 0.660662
0.6135 --- loss: 1.432695, loss_ss: 0.962135, loss_d: 0.470560
0.6518 --- loss: 1.282171, loss_ss: 0.927274, loss_d: 0.354897
0.6902 --- loss: 1.357139, loss_ss: 1.030096, loss_d: 0.327043
0.7285 --- loss: 1.126405, loss_ss: 0.716518, loss_d: 0.409887
0.7669 --- loss: 1.011009, loss_ss: 0.660737, loss_d: 0.350272
0.8052 --- loss: 1.721233, loss_ss: 1.234727, loss_d: 0.486506
0.8436 --- loss: 1.605351, loss_ss: 0.974125, loss_d: 0.631226
0.8819 --- loss: 1.351648, loss_ss: 1.007250, loss_d: 0.344398
0.9202 --- loss: 1.319762, loss_ss: 0.997445, loss_d: 0.322317
0.9586 --- loss: 1.616338, loss_ss: 0.913363, loss_d: 0.702975
0.9969 --- loss: 1.352540, loss_ss: 1.029480, loss_d: 0.323060
Epoch finished! Loss: 1.4743624914150972
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.412523, loss_ss: 0.842253, loss_d: 0.570270
0.0383 --- loss: 1.086811, loss_ss: 0.763145, loss_d: 0.323666
0.0767 --- loss: 1.866891, loss_ss: 1.185956, loss_d: 0.680935
0.1150 --- loss: 1.639410, loss_ss: 0.805128, loss_d: 0.834282
0.1534 --- loss: 1.280939, loss_ss: 0.846672, loss_d: 0.434267
0.1917 --- loss: 1.226803, loss_ss: 0.756726, loss_d: 0.470078
0.2301 --- loss: 1.323457, loss_ss: 0.890463, loss_d: 0.432994
0.2684 --- loss: 1.168553, loss_ss: 0.997974, loss_d: 0.170579
0.3067 --- loss: 1.650624, loss_ss: 1.095190, loss_d: 0.555434
0.3451 --- loss: 1.424513, loss_ss: 1.152500, loss_d: 0.272013
0.3834 --- loss: 1.097775, loss_ss: 0.867310, loss_d: 0.230464
0.4218 --- loss: 1.183382, loss_ss: 0.950082, loss_d: 0.233300
0.4601 --- loss: 1.248767, loss_ss: 0.968709, loss_d: 0.280059
0.4985 --- loss: 1.327828, loss_ss: 1.099110, loss_d: 0.228718
0.5368 --- loss: 1.295089, loss_ss: 1.049032, loss_d: 0.246056
0.5752 --- loss: 1.451232, loss_ss: 0.935414, loss_d: 0.515818
0.6135 --- loss: 1.534912, loss_ss: 0.830082, loss_d: 0.704830
0.6518 --- loss: 1.733751, loss_ss: 1.057223, loss_d: 0.676528
0.6902 --- loss: 1.365335, loss_ss: 1.009652, loss_d: 0.355683
0.7285 --- loss: 1.867883, loss_ss: 1.462915, loss_d: 0.404968
0.7669 --- loss: 1.275387, loss_ss: 1.057623, loss_d: 0.217764
0.8052 --- loss: 1.217169, loss_ss: 0.809415, loss_d: 0.407754
0.8436 --- loss: 1.083127, loss_ss: 0.639111, loss_d: 0.444016
0.8819 --- loss: 1.313986, loss_ss: 0.922160, loss_d: 0.391826
0.9202 --- loss: 1.418920, loss_ss: 1.196987, loss_d: 0.221933
0.9586 --- loss: 1.758004, loss_ss: 0.737351, loss_d: 1.020653
0.9969 --- loss: 1.236761, loss_ss: 0.898254, loss_d: 0.338507
Epoch finished! Loss: 1.372758553119806
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.642615, loss_ss: 1.140151, loss_d: 0.502464
0.0383 --- loss: 1.136214, loss_ss: 0.894530, loss_d: 0.241685
0.0767 --- loss: 1.207296, loss_ss: 0.794973, loss_d: 0.412322
0.1150 --- loss: 1.366492, loss_ss: 0.874990, loss_d: 0.491502
0.1534 --- loss: 0.923646, loss_ss: 0.762145, loss_d: 0.161501
0.1917 --- loss: 1.903467, loss_ss: 1.424032, loss_d: 0.479434
0.2301 --- loss: 1.620802, loss_ss: 0.751754, loss_d: 0.869048
0.2684 --- loss: 0.951075, loss_ss: 0.783444, loss_d: 0.167631
0.3067 --- loss: 1.149691, loss_ss: 0.808855, loss_d: 0.340835
0.3451 --- loss: 1.036292, loss_ss: 0.690908, loss_d: 0.345384
0.3834 --- loss: 1.089404, loss_ss: 0.936967, loss_d: 0.152437
0.4218 --- loss: 1.064468, loss_ss: 0.763604, loss_d: 0.300863
0.4601 --- loss: 0.887760, loss_ss: 0.638284, loss_d: 0.249476
0.4985 --- loss: 1.124431, loss_ss: 0.858936, loss_d: 0.265495
0.5368 --- loss: 1.423220, loss_ss: 1.039031, loss_d: 0.384188
0.5752 --- loss: 1.240130, loss_ss: 0.742531, loss_d: 0.497598
0.6135 --- loss: 0.987122, loss_ss: 0.723319, loss_d: 0.263803
0.6518 --- loss: 1.305537, loss_ss: 1.139485, loss_d: 0.166051
0.6902 --- loss: 1.226280, loss_ss: 0.961233, loss_d: 0.265047
0.7285 --- loss: 1.191067, loss_ss: 0.995477, loss_d: 0.195590
0.7669 --- loss: 1.278924, loss_ss: 0.627871, loss_d: 0.651053
0.8052 --- loss: 1.278798, loss_ss: 0.741565, loss_d: 0.537232
0.8436 --- loss: 1.095032, loss_ss: 0.829234, loss_d: 0.265799
0.8819 --- loss: 1.244600, loss_ss: 0.653326, loss_d: 0.591274
0.9202 --- loss: 1.635558, loss_ss: 1.095800, loss_d: 0.539757
0.9586 --- loss: 1.045746, loss_ss: 0.682123, loss_d: 0.363623
0.9969 --- loss: 1.186265, loss_ss: 1.048091, loss_d: 0.138174
Epoch finished! Loss: 1.2743287501426843
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.966440, loss_ss: 0.709304, loss_d: 0.257136
0.0383 --- loss: 1.005145, loss_ss: 0.939595, loss_d: 0.065550
0.0767 --- loss: 1.432933, loss_ss: 0.928683, loss_d: 0.504250
0.1150 --- loss: 1.261941, loss_ss: 0.771647, loss_d: 0.490294
0.1534 --- loss: 1.577810, loss_ss: 0.961270, loss_d: 0.616540
0.1917 --- loss: 1.265172, loss_ss: 1.006544, loss_d: 0.258628
0.2301 --- loss: 0.851447, loss_ss: 0.707531, loss_d: 0.143915
0.2684 --- loss: 0.928574, loss_ss: 0.805924, loss_d: 0.122650
0.3067 --- loss: 1.361640, loss_ss: 0.930257, loss_d: 0.431384
0.3451 --- loss: 1.290478, loss_ss: 0.791440, loss_d: 0.499037
0.3834 --- loss: 1.233260, loss_ss: 1.020794, loss_d: 0.212466
0.4218 --- loss: 1.103225, loss_ss: 0.810942, loss_d: 0.292283
0.4601 --- loss: 1.069474, loss_ss: 0.919990, loss_d: 0.149484
0.4985 --- loss: 0.923789, loss_ss: 0.765883, loss_d: 0.157906
0.5368 --- loss: 1.596097, loss_ss: 0.887731, loss_d: 0.708366
0.5752 --- loss: 1.217507, loss_ss: 0.934873, loss_d: 0.282634
0.6135 --- loss: 1.303702, loss_ss: 1.170044, loss_d: 0.133658
0.6518 --- loss: 1.118681, loss_ss: 0.815574, loss_d: 0.303108
0.6902 --- loss: 1.100401, loss_ss: 0.804843, loss_d: 0.295558
0.7285 --- loss: 1.903125, loss_ss: 1.196728, loss_d: 0.706397
0.7669 --- loss: 1.305363, loss_ss: 0.942242, loss_d: 0.363122
0.8052 --- loss: 1.780980, loss_ss: 1.351308, loss_d: 0.429673
0.8436 --- loss: 1.305612, loss_ss: 1.132620, loss_d: 0.172992
0.8819 --- loss: 1.000905, loss_ss: 0.739047, loss_d: 0.261858
0.9202 --- loss: 1.199371, loss_ss: 0.965411, loss_d: 0.233960
0.9586 --- loss: 1.413888, loss_ss: 1.049250, loss_d: 0.364638
0.9969 --- loss: 1.187088, loss_ss: 0.983722, loss_d: 0.203366
Epoch finished! Loss: 1.2237738040777353
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.040703, loss_ss: 0.863702, loss_d: 0.177001
0.0383 --- loss: 1.034580, loss_ss: 0.894389, loss_d: 0.140190
0.0767 --- loss: 1.083049, loss_ss: 0.862773, loss_d: 0.220276
0.1150 --- loss: 0.954037, loss_ss: 0.751108, loss_d: 0.202929
0.1534 --- loss: 0.695987, loss_ss: 0.603274, loss_d: 0.092713
0.1917 --- loss: 0.985376, loss_ss: 0.900844, loss_d: 0.084531
0.2301 --- loss: 1.065022, loss_ss: 0.858494, loss_d: 0.206528
0.2684 --- loss: 1.338004, loss_ss: 0.653124, loss_d: 0.684880
0.3067 --- loss: 1.599666, loss_ss: 0.918651, loss_d: 0.681014
0.3451 --- loss: 1.273049, loss_ss: 0.920150, loss_d: 0.352899
0.3834 --- loss: 1.434435, loss_ss: 1.055255, loss_d: 0.379180
0.4218 --- loss: 1.164672, loss_ss: 0.944297, loss_d: 0.220374
0.4601 --- loss: 0.977794, loss_ss: 0.804148, loss_d: 0.173646
0.4985 --- loss: 0.723071, loss_ss: 0.647142, loss_d: 0.075929
0.5368 --- loss: 1.562403, loss_ss: 0.805074, loss_d: 0.757329
0.5752 --- loss: 0.904023, loss_ss: 0.695601, loss_d: 0.208422
0.6135 --- loss: 0.989707, loss_ss: 0.789765, loss_d: 0.199943
0.6518 --- loss: 1.287524, loss_ss: 0.990002, loss_d: 0.297522
0.6902 --- loss: 0.998430, loss_ss: 0.763716, loss_d: 0.234714
0.7285 --- loss: 1.490898, loss_ss: 1.050099, loss_d: 0.440799
0.7669 --- loss: 1.343354, loss_ss: 1.053324, loss_d: 0.290030
0.8052 --- loss: 0.892163, loss_ss: 0.716009, loss_d: 0.176154
0.8436 --- loss: 1.052205, loss_ss: 0.916050, loss_d: 0.136155
0.8819 --- loss: 0.945642, loss_ss: 0.700792, loss_d: 0.244850
0.9202 --- loss: 1.191367, loss_ss: 0.996122, loss_d: 0.195245
0.9586 --- loss: 1.047033, loss_ss: 0.892972, loss_d: 0.154061
0.9969 --- loss: 1.134746, loss_ss: 1.025927, loss_d: 0.108819
Epoch finished! Loss: 1.1654941687217126
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.946809, loss_ss: 0.576807, loss_d: 0.370002
0.0383 --- loss: 1.203350, loss_ss: 0.959773, loss_d: 0.243577
0.0767 --- loss: 1.245153, loss_ss: 0.839121, loss_d: 0.406031
0.1150 --- loss: 0.795730, loss_ss: 0.639443, loss_d: 0.156287
0.1534 --- loss: 0.888386, loss_ss: 0.580134, loss_d: 0.308252
0.1917 --- loss: 1.098833, loss_ss: 0.826689, loss_d: 0.272144
0.2301 --- loss: 1.096219, loss_ss: 0.880521, loss_d: 0.215697
0.2684 --- loss: 0.752993, loss_ss: 0.617588, loss_d: 0.135405
0.3067 --- loss: 1.054472, loss_ss: 0.840374, loss_d: 0.214098
0.3451 --- loss: 0.734225, loss_ss: 0.503618, loss_d: 0.230608
0.3834 --- loss: 0.969173, loss_ss: 0.891430, loss_d: 0.077744
0.4218 --- loss: 1.080201, loss_ss: 1.008655, loss_d: 0.071545
0.4601 --- loss: 1.017335, loss_ss: 0.905346, loss_d: 0.111988
0.4985 --- loss: 0.956444, loss_ss: 0.871760, loss_d: 0.084685
0.5368 --- loss: 0.784721, loss_ss: 0.650981, loss_d: 0.133740
0.5752 --- loss: 1.300207, loss_ss: 0.997208, loss_d: 0.302998
0.6135 --- loss: 1.084978, loss_ss: 0.801620, loss_d: 0.283358
0.6518 --- loss: 1.102295, loss_ss: 0.877110, loss_d: 0.225185
0.6902 --- loss: 1.182781, loss_ss: 0.846443, loss_d: 0.336338
0.7285 --- loss: 1.128170, loss_ss: 0.860601, loss_d: 0.267569
0.7669 --- loss: 0.833271, loss_ss: 0.711616, loss_d: 0.121655
0.8052 --- loss: 1.150116, loss_ss: 0.904733, loss_d: 0.245383
0.8436 --- loss: 1.041587, loss_ss: 0.809951, loss_d: 0.231635
0.8819 --- loss: 1.233321, loss_ss: 0.892058, loss_d: 0.341263
0.9202 --- loss: 0.865370, loss_ss: 0.737402, loss_d: 0.127968
0.9586 --- loss: 1.213481, loss_ss: 1.034611, loss_d: 0.178870
0.9969 --- loss: 1.357625, loss_ss: 1.150612, loss_d: 0.207013
Epoch finished! Loss: 1.1462915560373894
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.040265, loss_ss: 0.892675, loss_d: 0.147590
0.0383 --- loss: 1.213043, loss_ss: 1.084329, loss_d: 0.128714
0.0767 --- loss: 0.902162, loss_ss: 0.692672, loss_d: 0.209489
0.1150 --- loss: 0.800649, loss_ss: 0.699088, loss_d: 0.101561
0.1534 --- loss: 1.055788, loss_ss: 0.703409, loss_d: 0.352379
0.1917 --- loss: 1.383676, loss_ss: 1.206141, loss_d: 0.177535
0.2301 --- loss: 0.897567, loss_ss: 0.790952, loss_d: 0.106614
0.2684 --- loss: 1.146408, loss_ss: 0.970680, loss_d: 0.175728
0.3067 --- loss: 1.143131, loss_ss: 1.060331, loss_d: 0.082800
0.3451 --- loss: 1.118892, loss_ss: 0.816033, loss_d: 0.302859
0.3834 --- loss: 0.826277, loss_ss: 0.661645, loss_d: 0.164632
0.4218 --- loss: 2.309999, loss_ss: 0.938631, loss_d: 1.371368
0.4601 --- loss: 0.973795, loss_ss: 0.806950, loss_d: 0.166845
0.4985 --- loss: 1.177253, loss_ss: 0.919045, loss_d: 0.258207
0.5368 --- loss: 1.161036, loss_ss: 0.792672, loss_d: 0.368364
0.5752 --- loss: 1.217003, loss_ss: 0.690274, loss_d: 0.526729
0.6135 --- loss: 1.276797, loss_ss: 0.706673, loss_d: 0.570124
0.6518 --- loss: 1.690142, loss_ss: 0.649206, loss_d: 1.040935
0.6902 --- loss: 1.243106, loss_ss: 1.102132, loss_d: 0.140974
0.7285 --- loss: 1.012511, loss_ss: 0.855131, loss_d: 0.157380
0.7669 --- loss: 1.227329, loss_ss: 0.943422, loss_d: 0.283907
0.8052 --- loss: 1.089370, loss_ss: 0.864712, loss_d: 0.224658
0.8436 --- loss: 1.228765, loss_ss: 0.873811, loss_d: 0.354954
0.8819 --- loss: 1.238749, loss_ss: 1.064542, loss_d: 0.174207
0.9202 --- loss: 1.155275, loss_ss: 0.988445, loss_d: 0.166829
0.9586 --- loss: 0.788885, loss_ss: 0.716263, loss_d: 0.072622
0.9969 --- loss: 0.821391, loss_ss: 0.716540, loss_d: 0.104851
Epoch finished! Loss: 1.1536490220289963
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.8411111111111111
             precision    recall  f1-score   support

        0.0       0.85      0.86      0.85       277
        1.0       0.50      0.02      0.03        66
        2.0       0.74      0.98      0.84       293
        3.0       0.99      0.92      0.95       189
        4.0       1.00      0.79      0.88        75

avg / total       0.83      0.84      0.81       900
 


====== chc027-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  91.00  85.92   93.26   85.00     85.46
1  92.67   1.52   99.88   50.00      2.94
2  88.33  97.61   83.86   74.48     84.49
3  98.00  91.53   99.72   98.86     95.05
4  98.22  78.67  100.00  100.00     88.06
Total accuracy: 84.11%
Average sen: 71.05%
Average spec: 95.34%
Macro f1-score: 71.20%
Diagnosis acc on 15mins: 0.9
[0.11983838 0.10980385 0.04871822 0.14321035 0.12521425 0.27082628
 0.03558065 0.29097584 0.17654416 0.02620226 0.60943872 0.52846235
 0.21999739 0.03186513 0.02249059 0.06155667 0.34087762 0.10237815
 0.60276371 0.15970689 0.03146178 0.07136858 0.04839319 0.18826573
 0.21216601 0.08557145 0.0238262  0.08562842 0.15808551 0.02235836]
pred: 0.1651192231103778, label: 0
Right! Diagnosis: Other

=== Test on chc028-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.438308, loss_ss: 1.716744, loss_d: 0.721564
0.0383 --- loss: 2.359680, loss_ss: 1.752102, loss_d: 0.607579
0.0767 --- loss: 2.184506, loss_ss: 1.812255, loss_d: 0.372251
0.1150 --- loss: 2.261817, loss_ss: 1.707525, loss_d: 0.554292
0.1533 --- loss: 2.154177, loss_ss: 1.514378, loss_d: 0.639799
0.1916 --- loss: 2.213830, loss_ss: 1.479779, loss_d: 0.734051
0.2300 --- loss: 2.175406, loss_ss: 1.623414, loss_d: 0.551991
0.2683 --- loss: 2.213179, loss_ss: 1.528359, loss_d: 0.684820
0.3066 --- loss: 2.024378, loss_ss: 1.366022, loss_d: 0.658357
0.3450 --- loss: 2.027710, loss_ss: 1.398884, loss_d: 0.628826
0.3833 --- loss: 2.095042, loss_ss: 1.394427, loss_d: 0.700615
0.4216 --- loss: 1.873906, loss_ss: 1.403677, loss_d: 0.470229
0.4599 --- loss: 1.776982, loss_ss: 1.442824, loss_d: 0.334157
0.4983 --- loss: 2.149610, loss_ss: 1.451839, loss_d: 0.697771
0.5366 --- loss: 2.367893, loss_ss: 1.450842, loss_d: 0.917051
0.5749 --- loss: 1.794796, loss_ss: 1.329869, loss_d: 0.464928
0.6133 --- loss: 1.889376, loss_ss: 1.278945, loss_d: 0.610431
0.6516 --- loss: 1.554847, loss_ss: 1.274198, loss_d: 0.280649
0.6899 --- loss: 1.881472, loss_ss: 1.395270, loss_d: 0.486202
0.7282 --- loss: 1.849853, loss_ss: 1.227006, loss_d: 0.622847
0.7666 --- loss: 1.912117, loss_ss: 1.259132, loss_d: 0.652985
0.8049 --- loss: 1.963627, loss_ss: 1.301956, loss_d: 0.661671
0.8432 --- loss: 2.096209, loss_ss: 1.409465, loss_d: 0.686744
0.8816 --- loss: 2.112291, loss_ss: 1.343444, loss_d: 0.768847
0.9199 --- loss: 1.571485, loss_ss: 1.210487, loss_d: 0.360998
0.9582 --- loss: 1.419293, loss_ss: 0.989616, loss_d: 0.429678
0.9966 --- loss: 1.917727, loss_ss: 1.229159, loss_d: 0.688568
Epoch finished! Loss: 2.0089663551403927
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.661846, loss_ss: 1.061972, loss_d: 0.599874
0.0383 --- loss: 2.034162, loss_ss: 1.220368, loss_d: 0.813794
0.0767 --- loss: 1.869672, loss_ss: 1.136364, loss_d: 0.733308
0.1150 --- loss: 1.714290, loss_ss: 1.176642, loss_d: 0.537647
0.1533 --- loss: 1.719597, loss_ss: 1.194848, loss_d: 0.524749
0.1916 --- loss: 2.066318, loss_ss: 1.033618, loss_d: 1.032700
0.2300 --- loss: 1.672818, loss_ss: 1.234802, loss_d: 0.438017
0.2683 --- loss: 1.692603, loss_ss: 1.111217, loss_d: 0.581386
0.3066 --- loss: 1.827499, loss_ss: 1.156439, loss_d: 0.671060
0.3450 --- loss: 1.622060, loss_ss: 1.048970, loss_d: 0.573089
0.3833 --- loss: 1.742091, loss_ss: 1.250556, loss_d: 0.491535
0.4216 --- loss: 1.721023, loss_ss: 1.062625, loss_d: 0.658398
0.4599 --- loss: 1.781101, loss_ss: 0.960313, loss_d: 0.820788
0.4983 --- loss: 1.664110, loss_ss: 0.936623, loss_d: 0.727487
0.5366 --- loss: 1.492166, loss_ss: 1.156574, loss_d: 0.335593
0.5749 --- loss: 1.689511, loss_ss: 1.128821, loss_d: 0.560690
0.6133 --- loss: 1.678008, loss_ss: 0.877268, loss_d: 0.800740
0.6516 --- loss: 1.599513, loss_ss: 0.959922, loss_d: 0.639591
0.6899 --- loss: 1.312218, loss_ss: 0.955896, loss_d: 0.356322
0.7282 --- loss: 1.334970, loss_ss: 0.967221, loss_d: 0.367749
0.7666 --- loss: 1.514442, loss_ss: 0.968039, loss_d: 0.546403
0.8049 --- loss: 1.716530, loss_ss: 1.149891, loss_d: 0.566639
0.8432 --- loss: 1.787295, loss_ss: 1.295281, loss_d: 0.492014
0.8816 --- loss: 1.391596, loss_ss: 0.856716, loss_d: 0.534881
0.9199 --- loss: 1.644665, loss_ss: 1.011972, loss_d: 0.632694
0.9582 --- loss: 1.660719, loss_ss: 1.142981, loss_d: 0.517738
0.9966 --- loss: 1.753956, loss_ss: 0.976585, loss_d: 0.777371
Epoch finished! Loss: 1.6971474564992464
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.624172, loss_ss: 1.031641, loss_d: 0.592532
0.0383 --- loss: 1.696018, loss_ss: 1.181187, loss_d: 0.514832
0.0767 --- loss: 2.073296, loss_ss: 1.480051, loss_d: 0.593245
0.1150 --- loss: 1.318516, loss_ss: 0.807519, loss_d: 0.510997
0.1533 --- loss: 1.444349, loss_ss: 1.016624, loss_d: 0.427724
0.1916 --- loss: 1.444313, loss_ss: 0.939592, loss_d: 0.504721
0.2300 --- loss: 1.898865, loss_ss: 0.974477, loss_d: 0.924388
0.2683 --- loss: 1.723939, loss_ss: 1.017416, loss_d: 0.706523
0.3066 --- loss: 1.305342, loss_ss: 0.885702, loss_d: 0.419640
0.3450 --- loss: 1.346737, loss_ss: 0.870909, loss_d: 0.475828
0.3833 --- loss: 1.591412, loss_ss: 1.182200, loss_d: 0.409211
0.4216 --- loss: 1.645674, loss_ss: 1.005084, loss_d: 0.640590
0.4599 --- loss: 1.922328, loss_ss: 1.228154, loss_d: 0.694174
0.4983 --- loss: 1.430509, loss_ss: 1.076895, loss_d: 0.353614
0.5366 --- loss: 1.268973, loss_ss: 1.032066, loss_d: 0.236907
0.5749 --- loss: 1.533447, loss_ss: 1.081225, loss_d: 0.452222
0.6133 --- loss: 1.404815, loss_ss: 0.924931, loss_d: 0.479884
0.6516 --- loss: 1.165579, loss_ss: 0.913475, loss_d: 0.252104
0.6899 --- loss: 1.127511, loss_ss: 0.838612, loss_d: 0.288898
0.7282 --- loss: 1.356646, loss_ss: 0.977755, loss_d: 0.378891
0.7666 --- loss: 1.128943, loss_ss: 0.856048, loss_d: 0.272895
0.8049 --- loss: 1.484936, loss_ss: 1.079672, loss_d: 0.405265
0.8432 --- loss: 1.547520, loss_ss: 1.343596, loss_d: 0.203923
0.8816 --- loss: 1.284210, loss_ss: 0.940150, loss_d: 0.344060
0.9199 --- loss: 1.532388, loss_ss: 0.861498, loss_d: 0.670890
0.9582 --- loss: 1.640192, loss_ss: 1.090871, loss_d: 0.549321
0.9966 --- loss: 1.618179, loss_ss: 0.879772, loss_d: 0.738408
Epoch finished! Loss: 1.5331162526057316
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.046021, loss_ss: 0.784941, loss_d: 0.261079
0.0383 --- loss: 1.512175, loss_ss: 0.996521, loss_d: 0.515654
0.0767 --- loss: 1.790416, loss_ss: 1.026526, loss_d: 0.763890
0.1150 --- loss: 1.247505, loss_ss: 0.785248, loss_d: 0.462258
0.1533 --- loss: 1.332217, loss_ss: 0.919198, loss_d: 0.413019
0.1916 --- loss: 1.667585, loss_ss: 1.180558, loss_d: 0.487027
0.2300 --- loss: 1.538602, loss_ss: 1.062756, loss_d: 0.475846
0.2683 --- loss: 1.293047, loss_ss: 0.892514, loss_d: 0.400534
0.3066 --- loss: 1.483603, loss_ss: 0.954397, loss_d: 0.529206
0.3450 --- loss: 1.999270, loss_ss: 1.187872, loss_d: 0.811399
0.3833 --- loss: 1.209878, loss_ss: 0.975194, loss_d: 0.234684
0.4216 --- loss: 1.289551, loss_ss: 1.084958, loss_d: 0.204593
0.4599 --- loss: 0.941242, loss_ss: 0.753127, loss_d: 0.188115
0.4983 --- loss: 1.923450, loss_ss: 1.522816, loss_d: 0.400633
0.5366 --- loss: 1.041836, loss_ss: 0.861471, loss_d: 0.180365
0.5749 --- loss: 0.991054, loss_ss: 0.775117, loss_d: 0.215937
0.6133 --- loss: 1.328562, loss_ss: 0.967910, loss_d: 0.360652
0.6516 --- loss: 1.492190, loss_ss: 0.934829, loss_d: 0.557361
0.6899 --- loss: 1.461601, loss_ss: 1.111232, loss_d: 0.350370
0.7282 --- loss: 1.198598, loss_ss: 0.847367, loss_d: 0.351232
0.7666 --- loss: 1.298154, loss_ss: 0.998019, loss_d: 0.300135
0.8049 --- loss: 1.054109, loss_ss: 0.687255, loss_d: 0.366854
0.8432 --- loss: 1.645416, loss_ss: 1.020103, loss_d: 0.625314
0.8816 --- loss: 1.361846, loss_ss: 0.978404, loss_d: 0.383442
0.9199 --- loss: 1.361879, loss_ss: 0.937343, loss_d: 0.424536
0.9582 --- loss: 1.080968, loss_ss: 0.878300, loss_d: 0.202667
0.9966 --- loss: 1.426487, loss_ss: 1.071860, loss_d: 0.354627
Epoch finished! Loss: 1.4136625092763166
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.283561, loss_ss: 0.768700, loss_d: 0.514861
0.0383 --- loss: 1.219247, loss_ss: 0.973057, loss_d: 0.246190
0.0767 --- loss: 1.648435, loss_ss: 0.981334, loss_d: 0.667101
0.1150 --- loss: 1.255061, loss_ss: 0.905160, loss_d: 0.349901
0.1533 --- loss: 1.267228, loss_ss: 0.906329, loss_d: 0.360899
0.1916 --- loss: 1.454163, loss_ss: 0.935930, loss_d: 0.518233
0.2300 --- loss: 1.184138, loss_ss: 0.953458, loss_d: 0.230680
0.2683 --- loss: 1.462361, loss_ss: 0.910690, loss_d: 0.551671
0.3066 --- loss: 1.405980, loss_ss: 0.900692, loss_d: 0.505287
0.3450 --- loss: 1.309519, loss_ss: 0.915157, loss_d: 0.394362
0.3833 --- loss: 1.366204, loss_ss: 0.541689, loss_d: 0.824515
0.4216 --- loss: 1.210371, loss_ss: 0.819250, loss_d: 0.391121
0.4599 --- loss: 1.299714, loss_ss: 1.007166, loss_d: 0.292548
0.4983 --- loss: 1.294174, loss_ss: 0.736285, loss_d: 0.557889
0.5366 --- loss: 1.426892, loss_ss: 0.792997, loss_d: 0.633895
0.5749 --- loss: 1.039613, loss_ss: 0.833174, loss_d: 0.206439
0.6133 --- loss: 1.539042, loss_ss: 1.267074, loss_d: 0.271968
0.6516 --- loss: 1.873567, loss_ss: 0.806657, loss_d: 1.066910
0.6899 --- loss: 0.941485, loss_ss: 0.754216, loss_d: 0.187268
0.7282 --- loss: 1.375144, loss_ss: 0.806215, loss_d: 0.568929
0.7666 --- loss: 1.294530, loss_ss: 0.919550, loss_d: 0.374979
0.8049 --- loss: 1.054247, loss_ss: 0.852443, loss_d: 0.201805
0.8432 --- loss: 1.255758, loss_ss: 1.004067, loss_d: 0.251691
0.8816 --- loss: 1.061221, loss_ss: 0.849896, loss_d: 0.211324
0.9199 --- loss: 0.884700, loss_ss: 0.612543, loss_d: 0.272156
0.9582 --- loss: 1.134245, loss_ss: 0.988849, loss_d: 0.145396
0.9966 --- loss: 1.349187, loss_ss: 0.839840, loss_d: 0.509347
Epoch finished! Loss: 1.3436395885852668
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.252198, loss_ss: 1.110493, loss_d: 0.141705
0.0383 --- loss: 1.217356, loss_ss: 0.976867, loss_d: 0.240488
0.0767 --- loss: 1.529800, loss_ss: 0.853881, loss_d: 0.675919
0.1150 --- loss: 1.219898, loss_ss: 0.882480, loss_d: 0.337419
0.1533 --- loss: 1.127116, loss_ss: 0.664487, loss_d: 0.462629
0.1916 --- loss: 1.169518, loss_ss: 0.922190, loss_d: 0.247328
0.2300 --- loss: 1.069824, loss_ss: 0.695475, loss_d: 0.374349
0.2683 --- loss: 1.914486, loss_ss: 0.747548, loss_d: 1.166938
0.3066 --- loss: 1.116242, loss_ss: 0.752083, loss_d: 0.364159
0.3450 --- loss: 1.389003, loss_ss: 1.087644, loss_d: 0.301359
0.3833 --- loss: 0.836204, loss_ss: 0.611481, loss_d: 0.224723
0.4216 --- loss: 1.255167, loss_ss: 1.081312, loss_d: 0.173855
0.4599 --- loss: 1.976029, loss_ss: 1.484463, loss_d: 0.491566
0.4983 --- loss: 1.306540, loss_ss: 1.026396, loss_d: 0.280144
0.5366 --- loss: 1.129094, loss_ss: 0.664876, loss_d: 0.464218
0.5749 --- loss: 0.909479, loss_ss: 0.740684, loss_d: 0.168795
0.6133 --- loss: 0.944924, loss_ss: 0.727454, loss_d: 0.217470
0.6516 --- loss: 1.305092, loss_ss: 1.023144, loss_d: 0.281948
0.6899 --- loss: 1.485701, loss_ss: 1.220986, loss_d: 0.264716
0.7282 --- loss: 1.231164, loss_ss: 0.920763, loss_d: 0.310401
0.7666 --- loss: 1.319191, loss_ss: 0.847371, loss_d: 0.471821
0.8049 --- loss: 1.338794, loss_ss: 0.972290, loss_d: 0.366504
0.8432 --- loss: 1.810736, loss_ss: 0.769954, loss_d: 1.040782
0.8816 --- loss: 0.955638, loss_ss: 0.839887, loss_d: 0.115751
0.9199 --- loss: 1.197825, loss_ss: 1.018259, loss_d: 0.179567
0.9582 --- loss: 1.867900, loss_ss: 1.473750, loss_d: 0.394150
0.9966 --- loss: 1.369976, loss_ss: 0.896585, loss_d: 0.473391
Epoch finished! Loss: 1.284828717662738
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.849798, loss_ss: 0.589452, loss_d: 0.260347
0.0383 --- loss: 1.180834, loss_ss: 0.811831, loss_d: 0.369002
0.0767 --- loss: 1.117854, loss_ss: 0.701121, loss_d: 0.416733
0.1150 --- loss: 1.022585, loss_ss: 0.771243, loss_d: 0.251342
0.1533 --- loss: 1.222730, loss_ss: 0.750876, loss_d: 0.471854
0.1916 --- loss: 1.297236, loss_ss: 1.052956, loss_d: 0.244280
0.2300 --- loss: 1.225933, loss_ss: 0.865831, loss_d: 0.360102
0.2683 --- loss: 1.170633, loss_ss: 0.761614, loss_d: 0.409019
0.3066 --- loss: 0.920935, loss_ss: 0.753665, loss_d: 0.167271
0.3450 --- loss: 1.342694, loss_ss: 0.925427, loss_d: 0.417267
0.3833 --- loss: 0.897686, loss_ss: 0.701981, loss_d: 0.195705
0.4216 --- loss: 0.810675, loss_ss: 0.716445, loss_d: 0.094230
0.4599 --- loss: 1.140301, loss_ss: 0.996641, loss_d: 0.143660
0.4983 --- loss: 0.875740, loss_ss: 0.773479, loss_d: 0.102262
0.5366 --- loss: 1.229779, loss_ss: 0.793650, loss_d: 0.436130
0.5749 --- loss: 1.288057, loss_ss: 0.869906, loss_d: 0.418151
0.6133 --- loss: 1.182343, loss_ss: 0.750916, loss_d: 0.431427
0.6516 --- loss: 1.804460, loss_ss: 0.843225, loss_d: 0.961235
0.6899 --- loss: 1.128896, loss_ss: 0.809482, loss_d: 0.319415
0.7282 --- loss: 1.087079, loss_ss: 0.936371, loss_d: 0.150709
0.7666 --- loss: 0.964104, loss_ss: 0.717586, loss_d: 0.246518
0.8049 --- loss: 1.376248, loss_ss: 1.101972, loss_d: 0.274277
0.8432 --- loss: 1.027367, loss_ss: 0.677874, loss_d: 0.349494
0.8816 --- loss: 0.948616, loss_ss: 0.839137, loss_d: 0.109480
0.9199 --- loss: 1.374440, loss_ss: 0.931743, loss_d: 0.442697
0.9582 --- loss: 1.443166, loss_ss: 0.973082, loss_d: 0.470084
0.9966 --- loss: 1.178168, loss_ss: 0.815785, loss_d: 0.362383
Epoch finished! Loss: 1.2243060384805386
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.342054, loss_ss: 1.108873, loss_d: 0.233181
0.0383 --- loss: 0.782612, loss_ss: 0.661123, loss_d: 0.121489
0.0767 --- loss: 1.219520, loss_ss: 1.071088, loss_d: 0.148432
0.1150 --- loss: 1.582282, loss_ss: 1.058682, loss_d: 0.523600
0.1533 --- loss: 1.233479, loss_ss: 1.159180, loss_d: 0.074298
0.1916 --- loss: 0.992303, loss_ss: 0.736901, loss_d: 0.255402
0.2300 --- loss: 1.096661, loss_ss: 1.003778, loss_d: 0.092883
0.2683 --- loss: 1.604082, loss_ss: 1.043886, loss_d: 0.560196
0.3066 --- loss: 0.966275, loss_ss: 0.682065, loss_d: 0.284209
0.3450 --- loss: 1.246145, loss_ss: 0.983296, loss_d: 0.262848
0.3833 --- loss: 2.002761, loss_ss: 1.661643, loss_d: 0.341118
0.4216 --- loss: 1.940876, loss_ss: 0.856247, loss_d: 1.084629
0.4599 --- loss: 0.970746, loss_ss: 0.822403, loss_d: 0.148343
0.4983 --- loss: 1.189636, loss_ss: 0.692423, loss_d: 0.497214
0.5366 --- loss: 1.019662, loss_ss: 0.804967, loss_d: 0.214695
0.5749 --- loss: 1.672180, loss_ss: 0.854823, loss_d: 0.817357
0.6133 --- loss: 1.308239, loss_ss: 0.779406, loss_d: 0.528833
0.6516 --- loss: 1.525333, loss_ss: 1.366209, loss_d: 0.159124
0.6899 --- loss: 0.994544, loss_ss: 0.762761, loss_d: 0.231783
0.7282 --- loss: 1.351960, loss_ss: 0.931869, loss_d: 0.420091
0.7666 --- loss: 0.775567, loss_ss: 0.559901, loss_d: 0.215666
0.8049 --- loss: 1.449863, loss_ss: 0.766446, loss_d: 0.683417
0.8432 --- loss: 0.947986, loss_ss: 0.805626, loss_d: 0.142360
0.8816 --- loss: 0.861617, loss_ss: 0.668481, loss_d: 0.193136
0.9199 --- loss: 1.184854, loss_ss: 0.760759, loss_d: 0.424095
0.9582 --- loss: 1.281667, loss_ss: 0.820994, loss_d: 0.460673
0.9966 --- loss: 0.968948, loss_ss: 0.794467, loss_d: 0.174481
Epoch finished! Loss: 1.1831871947416892
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.968183, loss_ss: 0.785457, loss_d: 0.182726
0.0383 --- loss: 1.047051, loss_ss: 0.757688, loss_d: 0.289363
0.0767 --- loss: 1.020294, loss_ss: 0.901409, loss_d: 0.118885
0.1150 --- loss: 0.912535, loss_ss: 0.702297, loss_d: 0.210238
0.1533 --- loss: 0.774170, loss_ss: 0.613344, loss_d: 0.160826
0.1916 --- loss: 1.411227, loss_ss: 0.991424, loss_d: 0.419803
0.2300 --- loss: 0.832153, loss_ss: 0.729658, loss_d: 0.102495
0.2683 --- loss: 1.127420, loss_ss: 0.935079, loss_d: 0.192341
0.3066 --- loss: 1.137000, loss_ss: 0.887664, loss_d: 0.249336
0.3450 --- loss: 1.017465, loss_ss: 0.924298, loss_d: 0.093168
0.3833 --- loss: 1.051390, loss_ss: 0.879960, loss_d: 0.171430
0.4216 --- loss: 1.250484, loss_ss: 0.986157, loss_d: 0.264327
0.4599 --- loss: 0.992459, loss_ss: 0.937270, loss_d: 0.055189
0.4983 --- loss: 1.856997, loss_ss: 1.410361, loss_d: 0.446636
0.5366 --- loss: 1.343747, loss_ss: 0.782316, loss_d: 0.561431
0.5749 --- loss: 1.092344, loss_ss: 0.751365, loss_d: 0.340978
0.6133 --- loss: 1.306304, loss_ss: 0.893248, loss_d: 0.413055
0.6516 --- loss: 1.086766, loss_ss: 0.759951, loss_d: 0.326815
0.6899 --- loss: 1.292117, loss_ss: 0.881452, loss_d: 0.410664
0.7282 --- loss: 1.237420, loss_ss: 1.011984, loss_d: 0.225436
0.7666 --- loss: 0.963221, loss_ss: 0.816072, loss_d: 0.147148
0.8049 --- loss: 0.718553, loss_ss: 0.574266, loss_d: 0.144287
0.8432 --- loss: 1.285995, loss_ss: 0.807480, loss_d: 0.478514
0.8816 --- loss: 1.157109, loss_ss: 1.040691, loss_d: 0.116418
0.9199 --- loss: 1.169463, loss_ss: 0.657482, loss_d: 0.511981
0.9582 --- loss: 0.914374, loss_ss: 0.716803, loss_d: 0.197571
0.9966 --- loss: 1.464348, loss_ss: 0.927341, loss_d: 0.537007
Epoch finished! Loss: 1.1537810330207532
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.114407, loss_ss: 0.783485, loss_d: 0.330922
0.0383 --- loss: 1.261342, loss_ss: 0.893471, loss_d: 0.367870
0.0767 --- loss: 0.950375, loss_ss: 0.863209, loss_d: 0.087165
0.1150 --- loss: 1.709793, loss_ss: 1.191698, loss_d: 0.518095
0.1533 --- loss: 1.515239, loss_ss: 1.042372, loss_d: 0.472867
0.1916 --- loss: 1.132708, loss_ss: 0.957952, loss_d: 0.174757
0.2300 --- loss: 0.768791, loss_ss: 0.616120, loss_d: 0.152671
0.2683 --- loss: 1.003577, loss_ss: 0.801863, loss_d: 0.201714
0.3066 --- loss: 1.286294, loss_ss: 0.819442, loss_d: 0.466852
0.3450 --- loss: 0.990646, loss_ss: 0.859316, loss_d: 0.131330
0.3833 --- loss: 1.114306, loss_ss: 1.048951, loss_d: 0.065356
0.4216 --- loss: 0.991040, loss_ss: 0.807390, loss_d: 0.183650
0.4599 --- loss: 1.066635, loss_ss: 0.836986, loss_d: 0.229648
0.4983 --- loss: 1.730099, loss_ss: 1.473386, loss_d: 0.256713
0.5366 --- loss: 1.044542, loss_ss: 0.823816, loss_d: 0.220726
0.5749 --- loss: 0.951486, loss_ss: 0.750972, loss_d: 0.200514
0.6133 --- loss: 1.408057, loss_ss: 0.700929, loss_d: 0.707129
0.6516 --- loss: 0.940285, loss_ss: 0.824868, loss_d: 0.115416
0.6899 --- loss: 0.967730, loss_ss: 0.719435, loss_d: 0.248295
0.7282 --- loss: 1.625861, loss_ss: 1.192561, loss_d: 0.433301
0.7666 --- loss: 1.060124, loss_ss: 0.939154, loss_d: 0.120971
0.8049 --- loss: 1.507632, loss_ss: 0.906940, loss_d: 0.600691
0.8432 --- loss: 1.188922, loss_ss: 0.726723, loss_d: 0.462198
0.8816 --- loss: 0.988975, loss_ss: 0.795461, loss_d: 0.193514
0.9199 --- loss: 1.175930, loss_ss: 0.990461, loss_d: 0.185469
0.9582 --- loss: 1.190422, loss_ss: 1.014393, loss_d: 0.176029
0.9966 --- loss: 1.301458, loss_ss: 1.035523, loss_d: 0.265935
Epoch finished! Loss: 1.1127856719952363
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7758620689655172
             precision    recall  f1-score   support

        0.0       0.66      0.85      0.74       119
        1.0       0.20      0.04      0.06        53
        2.0       0.93      0.76      0.84       460
        3.0       0.87      0.95      0.91       164
        4.0       0.45      0.89      0.59        74

avg / total       0.79      0.78      0.77       870
 


====== chc028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.84  84.87   92.94  65.58     73.99
1  93.22   3.77   99.02  20.00      6.35
2  84.14  76.09   93.17  92.59     83.53
3  96.32  95.12   96.60  86.67     90.70
4  89.66  89.19   89.70  44.59     59.46
Total accuracy: 77.59%
Average sen: 69.81%
Average spec: 94.29%
Macro f1-score: 62.81%
Diagnosis acc on 15mins: 0.7931034482758621
[0.41571599 0.60414571 0.05723095 0.84194237 0.49266401 0.14494917
 0.27306786 0.49295595 0.12762511 0.22247674 0.37043157 0.65130782
 0.68929601 0.59198415 0.13538751 0.44274089 0.12586768 0.68355078
 0.14353058 0.08663858 0.19196384 0.29481235 0.22912903 0.35580897
 0.06989798 0.10638642 0.20652442 0.16197771 0.2885204 ]
pred: 0.3275355351125372, label: 0
Right! Diagnosis: Other

=== Test on chc033-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.548159, loss_ss: 1.822220, loss_d: 0.725938
0.0383 --- loss: 2.173326, loss_ss: 1.564626, loss_d: 0.608700
0.0767 --- loss: 2.118844, loss_ss: 1.464033, loss_d: 0.654810
0.1150 --- loss: 2.112332, loss_ss: 1.516962, loss_d: 0.595369
0.1533 --- loss: 2.164347, loss_ss: 1.483606, loss_d: 0.680741
0.1916 --- loss: 2.155763, loss_ss: 1.429249, loss_d: 0.726514
0.2300 --- loss: 1.954782, loss_ss: 1.429282, loss_d: 0.525500
0.2683 --- loss: 2.134775, loss_ss: 1.574639, loss_d: 0.560136
0.3066 --- loss: 2.278744, loss_ss: 1.445413, loss_d: 0.833331
0.3450 --- loss: 1.826043, loss_ss: 1.583510, loss_d: 0.242533
0.3833 --- loss: 1.627510, loss_ss: 1.276075, loss_d: 0.351436
0.4216 --- loss: 2.290174, loss_ss: 1.587099, loss_d: 0.703075
0.4599 --- loss: 1.945690, loss_ss: 1.509338, loss_d: 0.436351
0.4983 --- loss: 1.832538, loss_ss: 1.223387, loss_d: 0.609151
0.5366 --- loss: 1.966533, loss_ss: 1.362781, loss_d: 0.603752
0.5749 --- loss: 1.903395, loss_ss: 1.241689, loss_d: 0.661706
0.6133 --- loss: 1.843350, loss_ss: 1.310421, loss_d: 0.532929
0.6516 --- loss: 1.647153, loss_ss: 1.222109, loss_d: 0.425044
0.6899 --- loss: 2.196473, loss_ss: 1.438232, loss_d: 0.758241
0.7282 --- loss: 1.741884, loss_ss: 1.232642, loss_d: 0.509242
0.7666 --- loss: 1.794480, loss_ss: 1.208457, loss_d: 0.586023
0.8049 --- loss: 1.901490, loss_ss: 1.361278, loss_d: 0.540212
0.8432 --- loss: 2.185661, loss_ss: 1.428104, loss_d: 0.757557
0.8816 --- loss: 2.022936, loss_ss: 1.463530, loss_d: 0.559405
0.9199 --- loss: 1.808241, loss_ss: 1.209383, loss_d: 0.598858
0.9582 --- loss: 1.738336, loss_ss: 1.084785, loss_d: 0.653551
0.9966 --- loss: 1.987672, loss_ss: 1.133515, loss_d: 0.854158
Epoch finished! Loss: 1.9555373792464916
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.717285, loss_ss: 1.136940, loss_d: 0.580345
0.0383 --- loss: 2.016730, loss_ss: 1.221947, loss_d: 0.794783
0.0767 --- loss: 1.716693, loss_ss: 1.052727, loss_d: 0.663967
0.1150 --- loss: 1.709314, loss_ss: 1.132844, loss_d: 0.576470
0.1533 --- loss: 1.529367, loss_ss: 1.207217, loss_d: 0.322150
0.1916 --- loss: 1.742347, loss_ss: 1.041561, loss_d: 0.700785
0.2300 --- loss: 1.822703, loss_ss: 1.129855, loss_d: 0.692848
0.2683 --- loss: 1.859368, loss_ss: 1.366773, loss_d: 0.492595
0.3066 --- loss: 1.965242, loss_ss: 1.201093, loss_d: 0.764149
0.3450 --- loss: 2.091242, loss_ss: 1.400299, loss_d: 0.690942
0.3833 --- loss: 1.667357, loss_ss: 1.006231, loss_d: 0.661127
0.4216 --- loss: 1.743672, loss_ss: 1.280357, loss_d: 0.463315
0.4599 --- loss: 1.418067, loss_ss: 0.931697, loss_d: 0.486370
0.4983 --- loss: 1.803015, loss_ss: 1.318627, loss_d: 0.484388
0.5366 --- loss: 1.632037, loss_ss: 1.183793, loss_d: 0.448245
0.5749 --- loss: 1.892258, loss_ss: 1.264322, loss_d: 0.627936
0.6133 --- loss: 1.525766, loss_ss: 0.968050, loss_d: 0.557716
0.6516 --- loss: 1.369002, loss_ss: 1.100183, loss_d: 0.268818
0.6899 --- loss: 1.853348, loss_ss: 1.036726, loss_d: 0.816622
0.7282 --- loss: 1.804545, loss_ss: 1.065016, loss_d: 0.739529
0.7666 --- loss: 1.753379, loss_ss: 1.250847, loss_d: 0.502532
0.8049 --- loss: 1.993676, loss_ss: 1.217732, loss_d: 0.775944
0.8432 --- loss: 1.692289, loss_ss: 1.227620, loss_d: 0.464668
0.8816 --- loss: 1.591003, loss_ss: 0.979090, loss_d: 0.611914
0.9199 --- loss: 1.863921, loss_ss: 1.045340, loss_d: 0.818582
0.9582 --- loss: 1.669005, loss_ss: 0.897367, loss_d: 0.771638
0.9966 --- loss: 2.140640, loss_ss: 1.502937, loss_d: 0.637702
Epoch finished! Loss: 1.7409697257555448
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.528117, loss_ss: 1.242914, loss_d: 0.285203
0.0383 --- loss: 1.380125, loss_ss: 0.868120, loss_d: 0.512005
0.0767 --- loss: 1.469298, loss_ss: 0.831758, loss_d: 0.637541
0.1150 --- loss: 2.002216, loss_ss: 1.214020, loss_d: 0.788196
0.1533 --- loss: 1.699337, loss_ss: 1.245890, loss_d: 0.453447
0.1916 --- loss: 1.374119, loss_ss: 0.858512, loss_d: 0.515607
0.2300 --- loss: 1.809897, loss_ss: 1.141527, loss_d: 0.668370
0.2683 --- loss: 1.370134, loss_ss: 0.936803, loss_d: 0.433331
0.3066 --- loss: 1.350355, loss_ss: 0.847092, loss_d: 0.503263
0.3450 --- loss: 1.762300, loss_ss: 1.271003, loss_d: 0.491296
0.3833 --- loss: 1.595237, loss_ss: 0.891966, loss_d: 0.703271
0.4216 --- loss: 1.823911, loss_ss: 0.945843, loss_d: 0.878068
0.4599 --- loss: 1.263025, loss_ss: 0.800303, loss_d: 0.462722
0.4983 --- loss: 1.491799, loss_ss: 1.031044, loss_d: 0.460756
0.5366 --- loss: 1.404736, loss_ss: 0.985723, loss_d: 0.419012
0.5749 --- loss: 1.619835, loss_ss: 1.164011, loss_d: 0.455824
0.6133 --- loss: 1.399160, loss_ss: 0.783554, loss_d: 0.615606
0.6516 --- loss: 1.673458, loss_ss: 1.134687, loss_d: 0.538771
0.6899 --- loss: 1.519555, loss_ss: 0.924230, loss_d: 0.595326
0.7282 --- loss: 1.765320, loss_ss: 1.356621, loss_d: 0.408699
0.7666 --- loss: 1.462570, loss_ss: 0.939042, loss_d: 0.523528
0.8049 --- loss: 1.772943, loss_ss: 0.924301, loss_d: 0.848642
0.8432 --- loss: 1.418548, loss_ss: 0.874062, loss_d: 0.544485
0.8816 --- loss: 1.325794, loss_ss: 0.912296, loss_d: 0.413498
0.9199 --- loss: 1.351386, loss_ss: 0.988899, loss_d: 0.362486
0.9582 --- loss: 1.553713, loss_ss: 0.979916, loss_d: 0.573796
0.9966 --- loss: 1.534182, loss_ss: 0.942869, loss_d: 0.591313
Epoch finished! Loss: 1.6111383626094231
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.840298, loss_ss: 1.086588, loss_d: 0.753710
0.0383 --- loss: 1.950829, loss_ss: 1.365257, loss_d: 0.585573
0.0767 --- loss: 1.529068, loss_ss: 1.095968, loss_d: 0.433101
0.1150 --- loss: 1.268422, loss_ss: 0.796379, loss_d: 0.472042
0.1533 --- loss: 1.729045, loss_ss: 1.255275, loss_d: 0.473770
0.1916 --- loss: 1.448843, loss_ss: 1.152309, loss_d: 0.296534
0.2300 --- loss: 1.574595, loss_ss: 1.116085, loss_d: 0.458510
0.2683 --- loss: 1.726194, loss_ss: 1.211647, loss_d: 0.514547
0.3066 --- loss: 1.699457, loss_ss: 0.802478, loss_d: 0.896979
0.3450 --- loss: 1.445575, loss_ss: 1.018585, loss_d: 0.426989
0.3833 --- loss: 1.710692, loss_ss: 1.358520, loss_d: 0.352171
0.4216 --- loss: 1.390286, loss_ss: 0.867575, loss_d: 0.522711
0.4599 --- loss: 1.613953, loss_ss: 1.001971, loss_d: 0.611982
0.4983 --- loss: 1.559735, loss_ss: 1.149868, loss_d: 0.409868
0.5366 --- loss: 1.795974, loss_ss: 1.378098, loss_d: 0.417876
0.5749 --- loss: 1.259456, loss_ss: 0.840339, loss_d: 0.419117
0.6133 --- loss: 1.394639, loss_ss: 1.139204, loss_d: 0.255435
0.6516 --- loss: 1.482848, loss_ss: 0.812614, loss_d: 0.670233
0.6899 --- loss: 1.467208, loss_ss: 0.715662, loss_d: 0.751546
0.7282 --- loss: 1.470425, loss_ss: 0.973870, loss_d: 0.496555
0.7666 --- loss: 1.342002, loss_ss: 0.906191, loss_d: 0.435811
0.8049 --- loss: 1.950191, loss_ss: 1.379467, loss_d: 0.570724
0.8432 --- loss: 1.279146, loss_ss: 0.961773, loss_d: 0.317373
0.8816 --- loss: 1.368237, loss_ss: 1.059764, loss_d: 0.308473
0.9199 --- loss: 1.530483, loss_ss: 1.017043, loss_d: 0.513440
0.9582 --- loss: 1.617496, loss_ss: 1.318497, loss_d: 0.298999
0.9966 --- loss: 1.098314, loss_ss: 0.812704, loss_d: 0.285609
Epoch finished! Loss: 1.5131020534497042
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.448979, loss_ss: 0.843329, loss_d: 0.605650
0.0383 --- loss: 1.611109, loss_ss: 0.957860, loss_d: 0.653248
0.0767 --- loss: 1.412525, loss_ss: 1.178411, loss_d: 0.234114
0.1150 --- loss: 1.511028, loss_ss: 0.936042, loss_d: 0.574986
0.1533 --- loss: 1.785311, loss_ss: 1.175011, loss_d: 0.610299
0.1916 --- loss: 1.474193, loss_ss: 1.015427, loss_d: 0.458766
0.2300 --- loss: 1.250834, loss_ss: 0.836257, loss_d: 0.414577
0.2683 --- loss: 1.314434, loss_ss: 0.778807, loss_d: 0.535627
0.3066 --- loss: 1.502110, loss_ss: 0.873447, loss_d: 0.628663
0.3450 --- loss: 1.030396, loss_ss: 0.815060, loss_d: 0.215336
0.3833 --- loss: 0.953425, loss_ss: 0.734739, loss_d: 0.218686
0.4216 --- loss: 1.230725, loss_ss: 0.820344, loss_d: 0.410381
0.4599 --- loss: 1.572634, loss_ss: 0.882958, loss_d: 0.689675
0.4983 --- loss: 1.318227, loss_ss: 1.030996, loss_d: 0.287230
0.5366 --- loss: 1.435594, loss_ss: 1.133595, loss_d: 0.301999
0.5749 --- loss: 1.022417, loss_ss: 0.701035, loss_d: 0.321382
0.6133 --- loss: 1.226677, loss_ss: 0.833484, loss_d: 0.393194
0.6516 --- loss: 1.665566, loss_ss: 1.136797, loss_d: 0.528769
0.6899 --- loss: 1.113870, loss_ss: 0.785830, loss_d: 0.328040
0.7282 --- loss: 1.132724, loss_ss: 0.872722, loss_d: 0.260002
0.7666 --- loss: 1.182571, loss_ss: 0.897539, loss_d: 0.285031
0.8049 --- loss: 1.503727, loss_ss: 0.818706, loss_d: 0.685021
0.8432 --- loss: 0.896079, loss_ss: 0.705265, loss_d: 0.190813
0.8816 --- loss: 2.211229, loss_ss: 0.690496, loss_d: 1.520732
0.9199 --- loss: 1.730289, loss_ss: 1.192722, loss_d: 0.537567
0.9582 --- loss: 0.980082, loss_ss: 0.738600, loss_d: 0.241481
0.9966 --- loss: 1.235453, loss_ss: 0.840945, loss_d: 0.394508
Epoch finished! Loss: 1.4110735684633255
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.220043, loss_ss: 0.748109, loss_d: 0.471934
0.0383 --- loss: 1.163255, loss_ss: 0.861805, loss_d: 0.301451
0.0767 --- loss: 1.585887, loss_ss: 0.690924, loss_d: 0.894963
0.1150 --- loss: 1.473175, loss_ss: 1.219148, loss_d: 0.254027
0.1533 --- loss: 1.630855, loss_ss: 0.819069, loss_d: 0.811786
0.1916 --- loss: 1.245475, loss_ss: 1.026224, loss_d: 0.219251
0.2300 --- loss: 1.477133, loss_ss: 0.782240, loss_d: 0.694893
0.2683 --- loss: 1.310395, loss_ss: 0.913504, loss_d: 0.396892
0.3066 --- loss: 1.374898, loss_ss: 0.881783, loss_d: 0.493115
0.3450 --- loss: 1.479524, loss_ss: 0.989922, loss_d: 0.489602
0.3833 --- loss: 1.681927, loss_ss: 1.141279, loss_d: 0.540648
0.4216 --- loss: 1.788123, loss_ss: 1.115576, loss_d: 0.672548
0.4599 --- loss: 1.565220, loss_ss: 1.141474, loss_d: 0.423746
0.4983 --- loss: 1.582929, loss_ss: 0.868129, loss_d: 0.714800
0.5366 --- loss: 1.578164, loss_ss: 0.938815, loss_d: 0.639348
0.5749 --- loss: 1.286105, loss_ss: 0.936224, loss_d: 0.349881
0.6133 --- loss: 1.453656, loss_ss: 1.140612, loss_d: 0.313044
0.6516 --- loss: 1.459605, loss_ss: 1.074256, loss_d: 0.385349
0.6899 --- loss: 1.397559, loss_ss: 0.986050, loss_d: 0.411509
0.7282 --- loss: 1.228772, loss_ss: 0.881678, loss_d: 0.347094
0.7666 --- loss: 1.442423, loss_ss: 1.141093, loss_d: 0.301330
0.8049 --- loss: 1.474445, loss_ss: 1.079433, loss_d: 0.395011
0.8432 --- loss: 1.165197, loss_ss: 0.927839, loss_d: 0.237358
0.8816 --- loss: 1.361834, loss_ss: 0.956905, loss_d: 0.404930
0.9199 --- loss: 1.144029, loss_ss: 0.876783, loss_d: 0.267245
0.9582 --- loss: 1.447826, loss_ss: 1.038745, loss_d: 0.409081
0.9966 --- loss: 1.075628, loss_ss: 0.712609, loss_d: 0.363019
Epoch finished! Loss: 1.337925562950281
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.358532, loss_ss: 1.043669, loss_d: 0.314863
0.0383 --- loss: 1.221532, loss_ss: 0.782126, loss_d: 0.439406
0.0767 --- loss: 1.236773, loss_ss: 0.924615, loss_d: 0.312158
0.1150 --- loss: 1.361378, loss_ss: 0.864224, loss_d: 0.497154
0.1533 --- loss: 1.120515, loss_ss: 0.703768, loss_d: 0.416747
0.1916 --- loss: 1.121950, loss_ss: 0.946235, loss_d: 0.175714
0.2300 --- loss: 0.996919, loss_ss: 0.781473, loss_d: 0.215446
0.2683 --- loss: 1.302454, loss_ss: 0.762729, loss_d: 0.539725
0.3066 --- loss: 1.350731, loss_ss: 0.702798, loss_d: 0.647933
0.3450 --- loss: 1.424385, loss_ss: 0.712684, loss_d: 0.711701
0.3833 --- loss: 0.975596, loss_ss: 0.807302, loss_d: 0.168294
0.4216 --- loss: 1.272237, loss_ss: 0.807142, loss_d: 0.465095
0.4599 --- loss: 1.353814, loss_ss: 0.876820, loss_d: 0.476994
0.4983 --- loss: 0.916400, loss_ss: 0.695545, loss_d: 0.220856
0.5366 --- loss: 1.027190, loss_ss: 0.799259, loss_d: 0.227931
0.5749 --- loss: 1.315331, loss_ss: 0.863993, loss_d: 0.451338
0.6133 --- loss: 1.039074, loss_ss: 0.876327, loss_d: 0.162748
0.6516 --- loss: 1.372921, loss_ss: 0.845768, loss_d: 0.527153
0.6899 --- loss: 1.431177, loss_ss: 1.025987, loss_d: 0.405190
0.7282 --- loss: 0.886596, loss_ss: 0.752343, loss_d: 0.134253
0.7666 --- loss: 1.008193, loss_ss: 0.777571, loss_d: 0.230621
0.8049 --- loss: 1.156812, loss_ss: 0.863753, loss_d: 0.293059
0.8432 --- loss: 1.243215, loss_ss: 1.021023, loss_d: 0.222192
0.8816 --- loss: 1.026257, loss_ss: 0.685969, loss_d: 0.340288
0.9199 --- loss: 0.773608, loss_ss: 0.602470, loss_d: 0.171137
0.9582 --- loss: 1.238169, loss_ss: 0.870349, loss_d: 0.367820
0.9966 --- loss: 1.029509, loss_ss: 0.741773, loss_d: 0.287736
Epoch finished! Loss: 1.2528189569711685
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.273853, loss_ss: 0.812445, loss_d: 0.461408
0.0383 --- loss: 1.326876, loss_ss: 0.914255, loss_d: 0.412621
0.0767 --- loss: 1.265453, loss_ss: 0.990935, loss_d: 0.274519
0.1150 --- loss: 1.160828, loss_ss: 0.751784, loss_d: 0.409044
0.1533 --- loss: 1.215205, loss_ss: 1.059159, loss_d: 0.156046
0.1916 --- loss: 0.991769, loss_ss: 0.677824, loss_d: 0.313945
0.2300 --- loss: 1.271781, loss_ss: 0.872572, loss_d: 0.399209
0.2683 --- loss: 1.379582, loss_ss: 0.953826, loss_d: 0.425756
0.3066 --- loss: 1.039399, loss_ss: 0.784002, loss_d: 0.255397
0.3450 --- loss: 0.859417, loss_ss: 0.698727, loss_d: 0.160690
0.3833 --- loss: 1.151565, loss_ss: 0.912604, loss_d: 0.238960
0.4216 --- loss: 1.225627, loss_ss: 0.992766, loss_d: 0.232860
0.4599 --- loss: 0.837046, loss_ss: 0.727087, loss_d: 0.109959
0.4983 --- loss: 1.039179, loss_ss: 0.668261, loss_d: 0.370918
0.5366 --- loss: 1.087875, loss_ss: 0.903729, loss_d: 0.184146
0.5749 --- loss: 1.191841, loss_ss: 1.044444, loss_d: 0.147397
0.6133 --- loss: 1.248493, loss_ss: 0.826341, loss_d: 0.422152
0.6516 --- loss: 1.070861, loss_ss: 0.617834, loss_d: 0.453027
0.6899 --- loss: 1.606049, loss_ss: 1.368720, loss_d: 0.237329
0.7282 --- loss: 1.109188, loss_ss: 0.844329, loss_d: 0.264859
0.7666 --- loss: 1.045093, loss_ss: 0.845102, loss_d: 0.199990
0.8049 --- loss: 0.854618, loss_ss: 0.660963, loss_d: 0.193656
0.8432 --- loss: 1.338100, loss_ss: 1.022165, loss_d: 0.315935
0.8816 --- loss: 0.895991, loss_ss: 0.692147, loss_d: 0.203844
0.9199 --- loss: 0.812593, loss_ss: 0.560330, loss_d: 0.252263
0.9582 --- loss: 1.171636, loss_ss: 0.746718, loss_d: 0.424918
0.9966 --- loss: 1.140053, loss_ss: 0.847046, loss_d: 0.293007
Epoch finished! Loss: 1.216942630822842
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.249584, loss_ss: 0.943964, loss_d: 0.305621
0.0383 --- loss: 1.137186, loss_ss: 0.805349, loss_d: 0.331837
0.0767 --- loss: 1.151925, loss_ss: 0.956295, loss_d: 0.195630
0.1150 --- loss: 1.177209, loss_ss: 0.659926, loss_d: 0.517283
0.1533 --- loss: 1.125513, loss_ss: 0.911308, loss_d: 0.214205
0.1916 --- loss: 1.128903, loss_ss: 0.938780, loss_d: 0.190123
0.2300 --- loss: 1.197806, loss_ss: 0.863032, loss_d: 0.334774
0.2683 --- loss: 0.813253, loss_ss: 0.687887, loss_d: 0.125366
0.3066 --- loss: 1.472907, loss_ss: 1.333376, loss_d: 0.139531
0.3450 --- loss: 0.896647, loss_ss: 0.752666, loss_d: 0.143981
0.3833 --- loss: 1.301211, loss_ss: 0.780342, loss_d: 0.520869
0.4216 --- loss: 1.136676, loss_ss: 0.923133, loss_d: 0.213543
0.4599 --- loss: 1.201745, loss_ss: 0.794290, loss_d: 0.407456
0.4983 --- loss: 1.659822, loss_ss: 1.405291, loss_d: 0.254531
0.5366 --- loss: 1.061876, loss_ss: 0.897888, loss_d: 0.163988
0.5749 --- loss: 1.258183, loss_ss: 0.763976, loss_d: 0.494207
0.6133 --- loss: 1.247807, loss_ss: 0.674441, loss_d: 0.573365
0.6516 --- loss: 1.533575, loss_ss: 0.761232, loss_d: 0.772343
0.6899 --- loss: 1.243409, loss_ss: 0.927957, loss_d: 0.315452
0.7282 --- loss: 0.837254, loss_ss: 0.651142, loss_d: 0.186112
0.7666 --- loss: 0.761890, loss_ss: 0.630934, loss_d: 0.130955
0.8049 --- loss: 1.094927, loss_ss: 0.898446, loss_d: 0.196481
0.8432 --- loss: 1.117762, loss_ss: 0.975542, loss_d: 0.142220
0.8816 --- loss: 1.188664, loss_ss: 0.687557, loss_d: 0.501107
0.9199 --- loss: 0.638641, loss_ss: 0.459302, loss_d: 0.179340
0.9582 --- loss: 0.950072, loss_ss: 0.830985, loss_d: 0.119087
0.9966 --- loss: 1.035846, loss_ss: 0.837483, loss_d: 0.198362
Epoch finished! Loss: 1.184069746503463
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.004143, loss_ss: 0.892967, loss_d: 0.111176
0.0383 --- loss: 1.301203, loss_ss: 0.781867, loss_d: 0.519337
0.0767 --- loss: 1.141038, loss_ss: 1.012582, loss_d: 0.128456
0.1150 --- loss: 1.029120, loss_ss: 0.737929, loss_d: 0.291192
0.1533 --- loss: 1.585620, loss_ss: 0.750285, loss_d: 0.835335
0.1916 --- loss: 1.265245, loss_ss: 1.032350, loss_d: 0.232895
0.2300 --- loss: 0.812364, loss_ss: 0.704409, loss_d: 0.107956
0.2683 --- loss: 0.910549, loss_ss: 0.805664, loss_d: 0.104885
0.3066 --- loss: 1.224472, loss_ss: 0.757195, loss_d: 0.467277
0.3450 --- loss: 1.245375, loss_ss: 0.843528, loss_d: 0.401847
0.3833 --- loss: 1.562400, loss_ss: 1.179708, loss_d: 0.382692
0.4216 --- loss: 1.199623, loss_ss: 0.679737, loss_d: 0.519886
0.4599 --- loss: 0.781880, loss_ss: 0.572033, loss_d: 0.209847
0.4983 --- loss: 1.224274, loss_ss: 0.951359, loss_d: 0.272915
0.5366 --- loss: 1.276639, loss_ss: 1.094690, loss_d: 0.181949
0.5749 --- loss: 1.378895, loss_ss: 1.100737, loss_d: 0.278158
0.6133 --- loss: 1.667153, loss_ss: 1.170157, loss_d: 0.496996
0.6516 --- loss: 1.162009, loss_ss: 0.994494, loss_d: 0.167514
0.6899 --- loss: 1.176499, loss_ss: 0.891008, loss_d: 0.285490
0.7282 --- loss: 1.080453, loss_ss: 0.817476, loss_d: 0.262977
0.7666 --- loss: 0.843347, loss_ss: 0.736210, loss_d: 0.107138
0.8049 --- loss: 1.423683, loss_ss: 1.018635, loss_d: 0.405048
0.8432 --- loss: 1.191918, loss_ss: 0.984416, loss_d: 0.207501
0.8816 --- loss: 1.850296, loss_ss: 0.807643, loss_d: 1.042653
0.9199 --- loss: 0.790018, loss_ss: 0.579566, loss_d: 0.210452
0.9582 --- loss: 0.723250, loss_ss: 0.659983, loss_d: 0.063267
0.9966 --- loss: 1.511243, loss_ss: 0.887350, loss_d: 0.623893
Epoch finished! Loss: 1.1385346217797352
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7873563218390804
             precision    recall  f1-score   support

        0.0       0.83      0.32      0.46        59
        1.0       0.33      0.02      0.03        60
        2.0       0.94      0.83      0.88       389
        3.0       0.82      0.98      0.89       151
        4.0       0.61      0.92      0.73       211

avg / total       0.79      0.79      0.76       870
 


====== chc033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.94  32.20   99.51  82.61     46.34
1  92.99   1.67   99.75  33.33      3.17
2  89.77  82.78   95.43  93.60     87.86
3  95.98  98.01   95.55  82.22     89.43
4  83.79  92.42   81.03  60.94     73.45
Total accuracy: 78.74%
Average sen: 61.42%
Average spec: 94.25%
Macro f1-score: 60.05%
Diagnosis acc on 15mins: 0.0
[0.93576759 0.99169099 0.99779391 0.99790442 0.99601185 0.99795306
 0.99599874 0.99789172 0.9950611  0.99667704 0.99454653 0.99833566
 0.98761123 0.98853379 0.99738234 0.97507238 0.98120338 0.99923503
 0.9989863  0.99706751 0.99163765 0.99751246 0.80355871 0.99172544
 0.99905449 0.98499978 0.91878134 0.87540591 0.99741983]
pred: 0.978648972922358, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc035-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.444500, loss_ss: 1.743878, loss_d: 0.700622
0.0383 --- loss: 2.159557, loss_ss: 1.611605, loss_d: 0.547952
0.0767 --- loss: 2.098294, loss_ss: 1.616911, loss_d: 0.481383
0.1150 --- loss: 1.546985, loss_ss: 1.360360, loss_d: 0.186625
0.1534 --- loss: 1.831606, loss_ss: 1.277143, loss_d: 0.554463
0.1917 --- loss: 1.677827, loss_ss: 1.208299, loss_d: 0.469528
0.2301 --- loss: 1.893830, loss_ss: 1.451650, loss_d: 0.442180
0.2684 --- loss: 2.055616, loss_ss: 1.348680, loss_d: 0.706936
0.3067 --- loss: 1.991315, loss_ss: 1.215545, loss_d: 0.775770
0.3451 --- loss: 1.812233, loss_ss: 1.297705, loss_d: 0.514527
0.3834 --- loss: 1.939035, loss_ss: 1.322747, loss_d: 0.616288
0.4218 --- loss: 1.900649, loss_ss: 1.242010, loss_d: 0.658639
0.4601 --- loss: 1.951980, loss_ss: 1.251858, loss_d: 0.700122
0.4985 --- loss: 1.800688, loss_ss: 1.124333, loss_d: 0.676355
0.5368 --- loss: 1.788894, loss_ss: 1.233950, loss_d: 0.554944
0.5752 --- loss: 1.833595, loss_ss: 1.293571, loss_d: 0.540024
0.6135 --- loss: 1.574717, loss_ss: 1.076678, loss_d: 0.498039
0.6518 --- loss: 1.728164, loss_ss: 1.253093, loss_d: 0.475071
0.6902 --- loss: 1.637838, loss_ss: 1.166973, loss_d: 0.470865
0.7285 --- loss: 2.078002, loss_ss: 1.158217, loss_d: 0.919785
0.7669 --- loss: 1.811455, loss_ss: 1.150581, loss_d: 0.660874
0.8052 --- loss: 1.562028, loss_ss: 1.030038, loss_d: 0.531991
0.8436 --- loss: 2.285802, loss_ss: 1.589638, loss_d: 0.696163
0.8819 --- loss: 1.829670, loss_ss: 1.146752, loss_d: 0.682918
0.9202 --- loss: 1.583905, loss_ss: 1.088398, loss_d: 0.495507
0.9586 --- loss: 1.523945, loss_ss: 1.137689, loss_d: 0.386256
0.9969 --- loss: 1.519132, loss_ss: 1.105314, loss_d: 0.413817
Epoch finished! Loss: 1.888791615687884
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.614444, loss_ss: 1.078689, loss_d: 0.535756
0.0383 --- loss: 1.535593, loss_ss: 1.110634, loss_d: 0.424959
0.0767 --- loss: 1.837965, loss_ss: 0.983699, loss_d: 0.854266
0.1150 --- loss: 1.653137, loss_ss: 1.055920, loss_d: 0.597217
0.1534 --- loss: 1.769602, loss_ss: 1.094551, loss_d: 0.675050
0.1917 --- loss: 1.654439, loss_ss: 1.048814, loss_d: 0.605625
0.2301 --- loss: 1.658797, loss_ss: 0.936899, loss_d: 0.721898
0.2684 --- loss: 2.417407, loss_ss: 1.817920, loss_d: 0.599486
0.3067 --- loss: 1.829810, loss_ss: 1.211454, loss_d: 0.618356
0.3451 --- loss: 1.661600, loss_ss: 1.236615, loss_d: 0.424985
0.3834 --- loss: 1.657172, loss_ss: 1.181885, loss_d: 0.475287
0.4218 --- loss: 1.675552, loss_ss: 1.132871, loss_d: 0.542681
0.4601 --- loss: 1.847669, loss_ss: 1.288488, loss_d: 0.559181
0.4985 --- loss: 1.773944, loss_ss: 0.950618, loss_d: 0.823326
0.5368 --- loss: 1.886357, loss_ss: 1.147664, loss_d: 0.738693
0.5752 --- loss: 1.635526, loss_ss: 1.140790, loss_d: 0.494737
0.6135 --- loss: 1.560280, loss_ss: 1.010676, loss_d: 0.549604
0.6518 --- loss: 1.570021, loss_ss: 0.845479, loss_d: 0.724542
0.6902 --- loss: 2.138562, loss_ss: 1.675131, loss_d: 0.463431
0.7285 --- loss: 2.178862, loss_ss: 1.252820, loss_d: 0.926042
0.7669 --- loss: 1.647903, loss_ss: 0.977045, loss_d: 0.670858
0.8052 --- loss: 1.523640, loss_ss: 0.912029, loss_d: 0.611611
0.8436 --- loss: 1.744063, loss_ss: 1.285350, loss_d: 0.458713
0.8819 --- loss: 1.445162, loss_ss: 1.073092, loss_d: 0.372070
0.9202 --- loss: 1.745884, loss_ss: 0.931120, loss_d: 0.814764
0.9586 --- loss: 1.561119, loss_ss: 1.088583, loss_d: 0.472537
0.9969 --- loss: 1.514505, loss_ss: 0.976745, loss_d: 0.537760
Epoch finished! Loss: 1.7034938605932088
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.414587, loss_ss: 0.713205, loss_d: 0.701381
0.0383 --- loss: 1.684162, loss_ss: 1.126352, loss_d: 0.557810
0.0767 --- loss: 1.502468, loss_ss: 0.985820, loss_d: 0.516648
0.1150 --- loss: 1.648879, loss_ss: 1.046588, loss_d: 0.602291
0.1534 --- loss: 1.458092, loss_ss: 0.945174, loss_d: 0.512918
0.1917 --- loss: 1.475196, loss_ss: 1.035063, loss_d: 0.440134
0.2301 --- loss: 1.280159, loss_ss: 0.808941, loss_d: 0.471218
0.2684 --- loss: 2.057282, loss_ss: 1.033104, loss_d: 1.024178
0.3067 --- loss: 1.778822, loss_ss: 1.237404, loss_d: 0.541418
0.3451 --- loss: 1.547580, loss_ss: 0.937007, loss_d: 0.610573
0.3834 --- loss: 1.666808, loss_ss: 1.066469, loss_d: 0.600339
0.4218 --- loss: 1.546806, loss_ss: 0.950411, loss_d: 0.596395
0.4601 --- loss: 1.735844, loss_ss: 1.245345, loss_d: 0.490499
0.4985 --- loss: 1.700159, loss_ss: 1.114619, loss_d: 0.585540
0.5368 --- loss: 1.807999, loss_ss: 1.171583, loss_d: 0.636416
0.5752 --- loss: 1.549870, loss_ss: 0.990826, loss_d: 0.559044
0.6135 --- loss: 1.428055, loss_ss: 1.102116, loss_d: 0.325938
0.6518 --- loss: 1.533409, loss_ss: 0.832372, loss_d: 0.701037
0.6902 --- loss: 1.543695, loss_ss: 0.885611, loss_d: 0.658084
0.7285 --- loss: 1.485215, loss_ss: 0.945581, loss_d: 0.539634
0.7669 --- loss: 1.548565, loss_ss: 0.789408, loss_d: 0.759157
0.8052 --- loss: 1.579070, loss_ss: 1.130321, loss_d: 0.448749
0.8436 --- loss: 1.511910, loss_ss: 0.828384, loss_d: 0.683526
0.8819 --- loss: 1.672350, loss_ss: 1.076792, loss_d: 0.595558
0.9202 --- loss: 1.348342, loss_ss: 0.773542, loss_d: 0.574799
0.9586 --- loss: 1.364723, loss_ss: 0.899707, loss_d: 0.465016
0.9969 --- loss: 1.658391, loss_ss: 0.828264, loss_d: 0.830127
Epoch finished! Loss: 1.5996397614479065
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.632988, loss_ss: 0.963378, loss_d: 0.669611
0.0383 --- loss: 1.981803, loss_ss: 1.455830, loss_d: 0.525973
0.0767 --- loss: 1.265898, loss_ss: 0.875150, loss_d: 0.390748
0.1150 --- loss: 1.770142, loss_ss: 1.140797, loss_d: 0.629345
0.1534 --- loss: 1.666289, loss_ss: 1.261692, loss_d: 0.404597
0.1917 --- loss: 1.302845, loss_ss: 0.865057, loss_d: 0.437787
0.2301 --- loss: 1.525412, loss_ss: 0.775883, loss_d: 0.749529
0.2684 --- loss: 1.717224, loss_ss: 1.174835, loss_d: 0.542389
0.3067 --- loss: 1.506612, loss_ss: 1.106325, loss_d: 0.400287
0.3451 --- loss: 1.613273, loss_ss: 1.161174, loss_d: 0.452099
0.3834 --- loss: 1.754687, loss_ss: 0.973167, loss_d: 0.781520
0.4218 --- loss: 1.223076, loss_ss: 0.933624, loss_d: 0.289451
0.4601 --- loss: 1.163557, loss_ss: 0.887098, loss_d: 0.276458
0.4985 --- loss: 1.154309, loss_ss: 0.849407, loss_d: 0.304903
0.5368 --- loss: 1.354750, loss_ss: 0.801512, loss_d: 0.553238
0.5752 --- loss: 1.665656, loss_ss: 1.026227, loss_d: 0.639430
0.6135 --- loss: 1.439088, loss_ss: 0.794201, loss_d: 0.644887
0.6518 --- loss: 1.551233, loss_ss: 0.960843, loss_d: 0.590390
0.6902 --- loss: 1.834022, loss_ss: 1.008133, loss_d: 0.825889
0.7285 --- loss: 1.092031, loss_ss: 0.755840, loss_d: 0.336191
0.7669 --- loss: 1.794130, loss_ss: 1.266256, loss_d: 0.527873
0.8052 --- loss: 1.289869, loss_ss: 0.747361, loss_d: 0.542508
0.8436 --- loss: 1.466070, loss_ss: 1.041236, loss_d: 0.424834
0.8819 --- loss: 1.257885, loss_ss: 0.775002, loss_d: 0.482884
0.9202 --- loss: 1.080042, loss_ss: 0.745237, loss_d: 0.334806
0.9586 --- loss: 1.136066, loss_ss: 0.735101, loss_d: 0.400965
0.9969 --- loss: 1.976802, loss_ss: 1.245118, loss_d: 0.731684
Epoch finished! Loss: 1.5109364495827602
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.477641, loss_ss: 1.075047, loss_d: 0.402594
0.0383 --- loss: 1.313177, loss_ss: 0.965715, loss_d: 0.347462
0.0767 --- loss: 1.054696, loss_ss: 0.819656, loss_d: 0.235040
0.1150 --- loss: 1.480108, loss_ss: 0.977117, loss_d: 0.502991
0.1534 --- loss: 1.289621, loss_ss: 0.835825, loss_d: 0.453796
0.1917 --- loss: 1.086621, loss_ss: 0.560681, loss_d: 0.525940
0.2301 --- loss: 1.375588, loss_ss: 0.937202, loss_d: 0.438386
0.2684 --- loss: 1.646041, loss_ss: 1.432699, loss_d: 0.213341
0.3067 --- loss: 1.366397, loss_ss: 0.972726, loss_d: 0.393671
0.3451 --- loss: 1.677472, loss_ss: 1.135237, loss_d: 0.542234
0.3834 --- loss: 1.438204, loss_ss: 1.005568, loss_d: 0.432636
0.4218 --- loss: 1.452745, loss_ss: 1.098985, loss_d: 0.353761
0.4601 --- loss: 1.197084, loss_ss: 0.857456, loss_d: 0.339628
0.4985 --- loss: 1.402244, loss_ss: 0.855369, loss_d: 0.546875
0.5368 --- loss: 1.273695, loss_ss: 0.851257, loss_d: 0.422438
0.5752 --- loss: 1.401587, loss_ss: 0.915779, loss_d: 0.485808
0.6135 --- loss: 1.156155, loss_ss: 0.734192, loss_d: 0.421963
0.6518 --- loss: 1.372166, loss_ss: 0.710720, loss_d: 0.661447
0.6902 --- loss: 1.363695, loss_ss: 0.871887, loss_d: 0.491809
0.7285 --- loss: 1.326371, loss_ss: 0.969855, loss_d: 0.356516
0.7669 --- loss: 1.240873, loss_ss: 0.868946, loss_d: 0.371927
0.8052 --- loss: 1.482370, loss_ss: 0.663429, loss_d: 0.818942
0.8436 --- loss: 1.373411, loss_ss: 0.945767, loss_d: 0.427644
0.8819 --- loss: 1.329330, loss_ss: 0.942677, loss_d: 0.386653
0.9202 --- loss: 1.339459, loss_ss: 1.010670, loss_d: 0.328790
0.9586 --- loss: 1.012726, loss_ss: 0.749364, loss_d: 0.263362
0.9969 --- loss: 1.111432, loss_ss: 0.806278, loss_d: 0.305154
Epoch finished! Loss: 1.3901271290504016
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.355724, loss_ss: 1.017476, loss_d: 0.338248
0.0383 --- loss: 1.081724, loss_ss: 0.848321, loss_d: 0.233404
0.0767 --- loss: 0.927393, loss_ss: 0.702334, loss_d: 0.225059
0.1150 --- loss: 1.388554, loss_ss: 0.882902, loss_d: 0.505651
0.1534 --- loss: 1.212783, loss_ss: 0.878274, loss_d: 0.334508
0.1917 --- loss: 1.206094, loss_ss: 0.914475, loss_d: 0.291619
0.2301 --- loss: 2.370986, loss_ss: 1.290366, loss_d: 1.080620
0.2684 --- loss: 1.507026, loss_ss: 0.963890, loss_d: 0.543137
0.3067 --- loss: 1.355462, loss_ss: 1.107715, loss_d: 0.247747
0.3451 --- loss: 1.654819, loss_ss: 0.906308, loss_d: 0.748511
0.3834 --- loss: 1.538214, loss_ss: 1.142921, loss_d: 0.395293
0.4218 --- loss: 1.045164, loss_ss: 0.829576, loss_d: 0.215589
0.4601 --- loss: 1.423539, loss_ss: 0.883456, loss_d: 0.540083
0.4985 --- loss: 0.967397, loss_ss: 0.695740, loss_d: 0.271656
0.5368 --- loss: 0.996258, loss_ss: 0.769981, loss_d: 0.226277
0.5752 --- loss: 1.147607, loss_ss: 0.870829, loss_d: 0.276778
0.6135 --- loss: 1.019744, loss_ss: 0.804939, loss_d: 0.214805
0.6518 --- loss: 0.887083, loss_ss: 0.641732, loss_d: 0.245351
0.6902 --- loss: 1.409740, loss_ss: 1.225023, loss_d: 0.184717
0.7285 --- loss: 1.203148, loss_ss: 0.833948, loss_d: 0.369201
0.7669 --- loss: 1.242519, loss_ss: 0.865691, loss_d: 0.376827
0.8052 --- loss: 1.451273, loss_ss: 1.065925, loss_d: 0.385347
0.8436 --- loss: 1.561634, loss_ss: 1.350585, loss_d: 0.211049
0.8819 --- loss: 0.972806, loss_ss: 0.756258, loss_d: 0.216548
0.9202 --- loss: 1.035661, loss_ss: 0.837821, loss_d: 0.197839
0.9586 --- loss: 1.065126, loss_ss: 0.658679, loss_d: 0.406446
0.9969 --- loss: 1.283823, loss_ss: 0.776114, loss_d: 0.507709
Epoch finished! Loss: 1.31570774270938
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.336073, loss_ss: 1.011787, loss_d: 0.324286
0.0383 --- loss: 1.404701, loss_ss: 0.837933, loss_d: 0.566768
0.0767 --- loss: 1.174512, loss_ss: 0.687156, loss_d: 0.487356
0.1150 --- loss: 1.421213, loss_ss: 0.786339, loss_d: 0.634874
0.1534 --- loss: 1.192160, loss_ss: 0.906239, loss_d: 0.285921
0.1917 --- loss: 1.280466, loss_ss: 0.785542, loss_d: 0.494924
0.2301 --- loss: 1.073644, loss_ss: 0.830409, loss_d: 0.243235
0.2684 --- loss: 1.028792, loss_ss: 0.864891, loss_d: 0.163901
0.3067 --- loss: 1.418391, loss_ss: 0.829072, loss_d: 0.589318
0.3451 --- loss: 1.322396, loss_ss: 0.954227, loss_d: 0.368169
0.3834 --- loss: 0.861630, loss_ss: 0.611194, loss_d: 0.250437
0.4218 --- loss: 1.736384, loss_ss: 1.005110, loss_d: 0.731274
0.4601 --- loss: 1.463376, loss_ss: 0.963806, loss_d: 0.499570
0.4985 --- loss: 1.238826, loss_ss: 0.966922, loss_d: 0.271904
0.5368 --- loss: 1.688621, loss_ss: 0.895039, loss_d: 0.793581
0.5752 --- loss: 0.954119, loss_ss: 0.646485, loss_d: 0.307634
0.6135 --- loss: 1.900068, loss_ss: 1.159565, loss_d: 0.740503
0.6518 --- loss: 1.303048, loss_ss: 0.818995, loss_d: 0.484054
0.6902 --- loss: 1.572509, loss_ss: 1.010589, loss_d: 0.561920
0.7285 --- loss: 1.570993, loss_ss: 0.994564, loss_d: 0.576429
0.7669 --- loss: 1.184372, loss_ss: 0.868885, loss_d: 0.315487
0.8052 --- loss: 0.987524, loss_ss: 0.812984, loss_d: 0.174540
0.8436 --- loss: 1.163655, loss_ss: 0.802225, loss_d: 0.361431
0.8819 --- loss: 1.162916, loss_ss: 0.988934, loss_d: 0.173983
0.9202 --- loss: 1.223505, loss_ss: 1.036102, loss_d: 0.187403
0.9586 --- loss: 1.059732, loss_ss: 0.759791, loss_d: 0.299941
0.9969 --- loss: 1.268370, loss_ss: 0.853585, loss_d: 0.414785
Epoch finished! Loss: 1.2782926431069008
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.069716, loss_ss: 0.913644, loss_d: 0.156071
0.0383 --- loss: 1.119839, loss_ss: 0.751542, loss_d: 0.368296
0.0767 --- loss: 1.189126, loss_ss: 0.824153, loss_d: 0.364972
0.1150 --- loss: 1.761157, loss_ss: 0.885024, loss_d: 0.876133
0.1534 --- loss: 1.204922, loss_ss: 1.074813, loss_d: 0.130109
0.1917 --- loss: 0.805209, loss_ss: 0.674849, loss_d: 0.130360
0.2301 --- loss: 1.569260, loss_ss: 1.305557, loss_d: 0.263702
0.2684 --- loss: 1.167104, loss_ss: 1.010455, loss_d: 0.156649
0.3067 --- loss: 0.939196, loss_ss: 0.678581, loss_d: 0.260616
0.3451 --- loss: 1.192970, loss_ss: 0.973707, loss_d: 0.219263
0.3834 --- loss: 1.894298, loss_ss: 1.426761, loss_d: 0.467537
0.4218 --- loss: 1.247354, loss_ss: 0.802315, loss_d: 0.445039
0.4601 --- loss: 1.094435, loss_ss: 0.864382, loss_d: 0.230053
0.4985 --- loss: 0.976852, loss_ss: 0.686263, loss_d: 0.290589
0.5368 --- loss: 1.200876, loss_ss: 0.814132, loss_d: 0.386744
0.5752 --- loss: 1.212494, loss_ss: 0.888706, loss_d: 0.323788
0.6135 --- loss: 1.099484, loss_ss: 0.839738, loss_d: 0.259746
0.6518 --- loss: 1.751618, loss_ss: 1.248628, loss_d: 0.502990
0.6902 --- loss: 1.356140, loss_ss: 0.810262, loss_d: 0.545878
0.7285 --- loss: 1.583158, loss_ss: 1.073975, loss_d: 0.509183
0.7669 --- loss: 1.280432, loss_ss: 1.003436, loss_d: 0.276996
0.8052 --- loss: 1.353795, loss_ss: 1.081926, loss_d: 0.271868
0.8436 --- loss: 1.057786, loss_ss: 0.767060, loss_d: 0.290726
0.8819 --- loss: 1.440643, loss_ss: 0.811649, loss_d: 0.628993
0.9202 --- loss: 1.180292, loss_ss: 0.993300, loss_d: 0.186993
0.9586 --- loss: 1.077442, loss_ss: 0.866463, loss_d: 0.210980
0.9969 --- loss: 1.827288, loss_ss: 1.255564, loss_d: 0.571723
Epoch finished! Loss: 1.2140883308190566
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.415054, loss_ss: 0.940166, loss_d: 0.474888
0.0383 --- loss: 1.064942, loss_ss: 0.577997, loss_d: 0.486945
0.0767 --- loss: 1.098058, loss_ss: 0.790821, loss_d: 0.307237
0.1150 --- loss: 1.011193, loss_ss: 0.762216, loss_d: 0.248977
0.1534 --- loss: 1.317041, loss_ss: 0.883548, loss_d: 0.433492
0.1917 --- loss: 0.820326, loss_ss: 0.704089, loss_d: 0.116237
0.2301 --- loss: 1.123668, loss_ss: 0.942764, loss_d: 0.180904
0.2684 --- loss: 1.731972, loss_ss: 0.982568, loss_d: 0.749403
0.3067 --- loss: 1.330742, loss_ss: 0.990477, loss_d: 0.340265
0.3451 --- loss: 1.235256, loss_ss: 0.858574, loss_d: 0.376682
0.3834 --- loss: 1.103154, loss_ss: 0.901732, loss_d: 0.201422
0.4218 --- loss: 1.223759, loss_ss: 1.073873, loss_d: 0.149887
0.4601 --- loss: 1.517212, loss_ss: 0.842196, loss_d: 0.675016
0.4985 --- loss: 1.686504, loss_ss: 0.696148, loss_d: 0.990357
0.5368 --- loss: 0.966420, loss_ss: 0.830803, loss_d: 0.135617
0.5752 --- loss: 1.157963, loss_ss: 0.879652, loss_d: 0.278311
0.6135 --- loss: 0.922773, loss_ss: 0.761469, loss_d: 0.161303
0.6518 --- loss: 0.962227, loss_ss: 0.728782, loss_d: 0.233445
0.6902 --- loss: 1.053212, loss_ss: 0.725563, loss_d: 0.327649
0.7285 --- loss: 1.260265, loss_ss: 0.855401, loss_d: 0.404864
0.7669 --- loss: 1.138071, loss_ss: 0.905291, loss_d: 0.232780
0.8052 --- loss: 1.322425, loss_ss: 0.845790, loss_d: 0.476634
0.8436 --- loss: 1.208978, loss_ss: 0.903030, loss_d: 0.305948
0.8819 --- loss: 0.876916, loss_ss: 0.698570, loss_d: 0.178345
0.9202 --- loss: 0.987524, loss_ss: 0.859067, loss_d: 0.128457
0.9586 --- loss: 1.575869, loss_ss: 0.889865, loss_d: 0.686004
0.9969 --- loss: 0.923268, loss_ss: 0.575901, loss_d: 0.347367
Epoch finished! Loss: 1.1871323094918178
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.158078, loss_ss: 0.920632, loss_d: 0.237446
0.0383 --- loss: 0.796986, loss_ss: 0.637999, loss_d: 0.158986
0.0767 --- loss: 1.186516, loss_ss: 1.056598, loss_d: 0.129918
0.1150 --- loss: 1.136546, loss_ss: 1.041346, loss_d: 0.095200
0.1534 --- loss: 0.978862, loss_ss: 0.838472, loss_d: 0.140390
0.1917 --- loss: 2.136610, loss_ss: 1.155878, loss_d: 0.980732
0.2301 --- loss: 0.982628, loss_ss: 0.781577, loss_d: 0.201051
0.2684 --- loss: 0.881520, loss_ss: 0.676830, loss_d: 0.204690
0.3067 --- loss: 0.837072, loss_ss: 0.561820, loss_d: 0.275252
0.3451 --- loss: 0.997899, loss_ss: 0.781663, loss_d: 0.216236
0.3834 --- loss: 1.593123, loss_ss: 1.294171, loss_d: 0.298952
0.4218 --- loss: 1.028648, loss_ss: 0.766163, loss_d: 0.262486
0.4601 --- loss: 1.133709, loss_ss: 0.784236, loss_d: 0.349473
0.4985 --- loss: 1.077327, loss_ss: 0.784252, loss_d: 0.293075
0.5368 --- loss: 1.248392, loss_ss: 0.836695, loss_d: 0.411698
0.5752 --- loss: 0.713465, loss_ss: 0.629479, loss_d: 0.083986
0.6135 --- loss: 1.156917, loss_ss: 0.990375, loss_d: 0.166542
0.6518 --- loss: 0.936243, loss_ss: 0.689827, loss_d: 0.246417
0.6902 --- loss: 1.264024, loss_ss: 0.986387, loss_d: 0.277637
0.7285 --- loss: 1.072843, loss_ss: 0.768994, loss_d: 0.303849
0.7669 --- loss: 0.948149, loss_ss: 0.787245, loss_d: 0.160904
0.8052 --- loss: 1.642928, loss_ss: 1.219612, loss_d: 0.423316
0.8436 --- loss: 1.382895, loss_ss: 1.146459, loss_d: 0.236436
0.8819 --- loss: 0.924216, loss_ss: 0.630790, loss_d: 0.293425
0.9202 --- loss: 0.903801, loss_ss: 0.790563, loss_d: 0.113238
0.9586 --- loss: 0.673060, loss_ss: 0.539763, loss_d: 0.133296
0.9969 --- loss: 0.705226, loss_ss: 0.610173, loss_d: 0.095054
Epoch finished! Loss: 1.1348357017223651
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6966666666666667
             precision    recall  f1-score   support

        0.0       0.36      0.93      0.52        29
        1.0       0.50      0.02      0.03        57
        2.0       0.84      0.57      0.68       391
        3.0       0.78      0.95      0.86       250
        4.0       0.55      0.80      0.65       173

avg / total       0.73      0.70      0.68       900
 


====== chc035-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.56  93.10   94.60  36.49     52.43
1  93.67   1.75   99.88  50.00      3.39
2  76.67  57.29   91.55  83.90     68.09
3  91.11  94.80   89.69  77.96     85.56
4  83.33  79.77   84.18  54.55     64.79
Total accuracy: 69.67%
Average sen: 65.34%
Average spec: 91.98%
Macro f1-score: 54.85%
Diagnosis acc on 15mins: 0.6333333333333333
[0.76962048 0.31560189 0.97333843 0.85748523 0.95152628 0.79041737
 0.6331687  0.1650089  0.18676668 0.42434597 0.36826655 0.68833441
 0.21977445 0.56640267 0.28089318 0.23701687 0.76942217 0.23477846
 0.22881518 0.20448895 0.42926526 0.77333552 0.44557279 0.28274465
 0.37320921 0.09781435 0.15019321 0.22654521 0.30772105 0.72107476]
pred: 0.45576496173938114, label: 0
Right! Diagnosis: Other

=== Test on chc037-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.453459, loss_ss: 1.790171, loss_d: 0.663288
0.0383 --- loss: 2.093508, loss_ss: 1.691841, loss_d: 0.401667
0.0767 --- loss: 2.075193, loss_ss: 1.505243, loss_d: 0.569950
0.1150 --- loss: 2.158511, loss_ss: 1.516019, loss_d: 0.642492
0.1533 --- loss: 2.159882, loss_ss: 1.531768, loss_d: 0.628113
0.1916 --- loss: 1.902855, loss_ss: 1.443828, loss_d: 0.459027
0.2300 --- loss: 2.241372, loss_ss: 1.489131, loss_d: 0.752240
0.2683 --- loss: 2.102141, loss_ss: 1.392544, loss_d: 0.709597
0.3066 --- loss: 1.938333, loss_ss: 1.412974, loss_d: 0.525359
0.3450 --- loss: 1.473051, loss_ss: 1.305663, loss_d: 0.167388
0.3833 --- loss: 1.878970, loss_ss: 1.302131, loss_d: 0.576839
0.4216 --- loss: 1.966117, loss_ss: 1.333473, loss_d: 0.632644
0.4599 --- loss: 1.821080, loss_ss: 1.301687, loss_d: 0.519393
0.4983 --- loss: 1.838138, loss_ss: 1.449635, loss_d: 0.388503
0.5366 --- loss: 1.925188, loss_ss: 1.329116, loss_d: 0.596072
0.5749 --- loss: 1.876738, loss_ss: 1.254944, loss_d: 0.621793
0.6133 --- loss: 1.766126, loss_ss: 1.224756, loss_d: 0.541370
0.6516 --- loss: 1.744310, loss_ss: 1.323423, loss_d: 0.420887
0.6899 --- loss: 1.630227, loss_ss: 1.199168, loss_d: 0.431059
0.7282 --- loss: 1.977710, loss_ss: 1.328536, loss_d: 0.649175
0.7666 --- loss: 1.583633, loss_ss: 1.148089, loss_d: 0.435544
0.8049 --- loss: 1.540977, loss_ss: 1.088794, loss_d: 0.452184
0.8432 --- loss: 2.004906, loss_ss: 1.341241, loss_d: 0.663666
0.8816 --- loss: 1.737855, loss_ss: 1.088682, loss_d: 0.649173
0.9199 --- loss: 1.683218, loss_ss: 1.279232, loss_d: 0.403987
0.9582 --- loss: 2.275066, loss_ss: 1.456673, loss_d: 0.818392
0.9966 --- loss: 1.945442, loss_ss: 1.138339, loss_d: 0.807102
Epoch finished! Loss: 1.9670837682027082
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.818002, loss_ss: 1.064489, loss_d: 0.753514
0.0383 --- loss: 1.743006, loss_ss: 0.958619, loss_d: 0.784388
0.0767 --- loss: 2.081706, loss_ss: 1.217558, loss_d: 0.864148
0.1150 --- loss: 1.754293, loss_ss: 0.975857, loss_d: 0.778436
0.1533 --- loss: 1.982754, loss_ss: 1.159612, loss_d: 0.823143
0.1916 --- loss: 1.510181, loss_ss: 1.150009, loss_d: 0.360172
0.2300 --- loss: 1.925542, loss_ss: 1.142205, loss_d: 0.783337
0.2683 --- loss: 1.697940, loss_ss: 1.163295, loss_d: 0.534645
0.3066 --- loss: 1.557531, loss_ss: 1.073334, loss_d: 0.484197
0.3450 --- loss: 1.533308, loss_ss: 1.213320, loss_d: 0.319988
0.3833 --- loss: 1.655111, loss_ss: 1.004335, loss_d: 0.650776
0.4216 --- loss: 1.639052, loss_ss: 1.104262, loss_d: 0.534791
0.4599 --- loss: 1.703272, loss_ss: 1.162097, loss_d: 0.541174
0.4983 --- loss: 1.432328, loss_ss: 0.921895, loss_d: 0.510433
0.5366 --- loss: 1.364729, loss_ss: 1.038413, loss_d: 0.326316
0.5749 --- loss: 1.435000, loss_ss: 1.066447, loss_d: 0.368553
0.6133 --- loss: 1.731732, loss_ss: 1.283484, loss_d: 0.448248
0.6516 --- loss: 1.794209, loss_ss: 0.983854, loss_d: 0.810354
0.6899 --- loss: 1.457624, loss_ss: 0.921672, loss_d: 0.535953
0.7282 --- loss: 2.029790, loss_ss: 1.353196, loss_d: 0.676594
0.7666 --- loss: 1.711982, loss_ss: 0.901572, loss_d: 0.810410
0.8049 --- loss: 1.917832, loss_ss: 1.308743, loss_d: 0.609090
0.8432 --- loss: 1.645090, loss_ss: 1.059021, loss_d: 0.586069
0.8816 --- loss: 1.749744, loss_ss: 1.116915, loss_d: 0.632829
0.9199 --- loss: 1.618161, loss_ss: 1.024979, loss_d: 0.593182
0.9582 --- loss: 1.529317, loss_ss: 0.940328, loss_d: 0.588989
0.9966 --- loss: 1.677709, loss_ss: 1.108727, loss_d: 0.568981
Epoch finished! Loss: 1.6719457832666544
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.632131, loss_ss: 1.145777, loss_d: 0.486354
0.0383 --- loss: 1.370704, loss_ss: 0.970461, loss_d: 0.400243
0.0767 --- loss: 1.430932, loss_ss: 1.154990, loss_d: 0.275942
0.1150 --- loss: 1.645174, loss_ss: 1.074567, loss_d: 0.570607
0.1533 --- loss: 1.872089, loss_ss: 0.907944, loss_d: 0.964145
0.1916 --- loss: 1.838522, loss_ss: 0.914840, loss_d: 0.923682
0.2300 --- loss: 1.883440, loss_ss: 1.091858, loss_d: 0.791582
0.2683 --- loss: 1.457968, loss_ss: 0.901740, loss_d: 0.556229
0.3066 --- loss: 1.486272, loss_ss: 1.052454, loss_d: 0.433817
0.3450 --- loss: 1.780692, loss_ss: 0.826814, loss_d: 0.953878
0.3833 --- loss: 1.811613, loss_ss: 0.963691, loss_d: 0.847922
0.4216 --- loss: 1.579835, loss_ss: 1.179075, loss_d: 0.400760
0.4599 --- loss: 1.686349, loss_ss: 1.139526, loss_d: 0.546823
0.4983 --- loss: 1.806333, loss_ss: 1.154450, loss_d: 0.651883
0.5366 --- loss: 1.818038, loss_ss: 1.526206, loss_d: 0.291831
0.5749 --- loss: 1.775834, loss_ss: 1.396156, loss_d: 0.379678
0.6133 --- loss: 1.364890, loss_ss: 0.999900, loss_d: 0.364989
0.6516 --- loss: 1.627889, loss_ss: 0.862214, loss_d: 0.765675
0.6899 --- loss: 1.939544, loss_ss: 1.138696, loss_d: 0.800848
0.7282 --- loss: 1.791981, loss_ss: 1.049592, loss_d: 0.742390
0.7666 --- loss: 1.117683, loss_ss: 0.698312, loss_d: 0.419371
0.8049 --- loss: 1.223657, loss_ss: 0.725091, loss_d: 0.498566
0.8432 --- loss: 1.618207, loss_ss: 1.074377, loss_d: 0.543830
0.8816 --- loss: 1.646465, loss_ss: 1.158533, loss_d: 0.487932
0.9199 --- loss: 1.574503, loss_ss: 1.013494, loss_d: 0.561009
0.9582 --- loss: 1.727481, loss_ss: 0.769779, loss_d: 0.957702
0.9966 --- loss: 1.411308, loss_ss: 0.782279, loss_d: 0.629029
Epoch finished! Loss: 1.586001723087751
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.216164, loss_ss: 0.842564, loss_d: 0.373600
0.0383 --- loss: 1.395911, loss_ss: 0.946459, loss_d: 0.449452
0.0767 --- loss: 1.491316, loss_ss: 1.036930, loss_d: 0.454387
0.1150 --- loss: 1.504714, loss_ss: 0.838297, loss_d: 0.666416
0.1533 --- loss: 1.635037, loss_ss: 0.994462, loss_d: 0.640575
0.1916 --- loss: 1.432157, loss_ss: 0.951096, loss_d: 0.481061
0.2300 --- loss: 1.556275, loss_ss: 0.981021, loss_d: 0.575254
0.2683 --- loss: 1.620100, loss_ss: 0.903784, loss_d: 0.716315
0.3066 --- loss: 1.728740, loss_ss: 1.091456, loss_d: 0.637284
0.3450 --- loss: 1.612458, loss_ss: 1.038770, loss_d: 0.573688
0.3833 --- loss: 1.400142, loss_ss: 0.809030, loss_d: 0.591112
0.4216 --- loss: 1.699739, loss_ss: 1.008416, loss_d: 0.691323
0.4599 --- loss: 1.616855, loss_ss: 1.175026, loss_d: 0.441829
0.4983 --- loss: 1.695876, loss_ss: 1.085388, loss_d: 0.610488
0.5366 --- loss: 1.361169, loss_ss: 0.939225, loss_d: 0.421944
0.5749 --- loss: 1.430664, loss_ss: 0.909958, loss_d: 0.520706
0.6133 --- loss: 1.136560, loss_ss: 0.756111, loss_d: 0.380449
0.6516 --- loss: 1.232203, loss_ss: 0.819182, loss_d: 0.413021
0.6899 --- loss: 1.775182, loss_ss: 0.943370, loss_d: 0.831812
0.7282 --- loss: 1.551433, loss_ss: 1.050755, loss_d: 0.500678
0.7666 --- loss: 1.391251, loss_ss: 0.978149, loss_d: 0.413102
0.8049 --- loss: 1.034764, loss_ss: 0.657055, loss_d: 0.377708
0.8432 --- loss: 1.439281, loss_ss: 0.889913, loss_d: 0.549368
0.8816 --- loss: 1.217031, loss_ss: 0.894467, loss_d: 0.322564
0.9199 --- loss: 1.517351, loss_ss: 1.210216, loss_d: 0.307135
0.9582 --- loss: 1.490340, loss_ss: 1.068059, loss_d: 0.422281
0.9966 --- loss: 1.334918, loss_ss: 1.081038, loss_d: 0.253879
Epoch finished! Loss: 1.5140143486169668
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.066386, loss_ss: 1.031540, loss_d: 1.034846
0.0383 --- loss: 1.739505, loss_ss: 0.927878, loss_d: 0.811627
0.0767 --- loss: 1.378286, loss_ss: 1.037008, loss_d: 0.341278
0.1150 --- loss: 1.217333, loss_ss: 0.773762, loss_d: 0.443571
0.1533 --- loss: 1.363995, loss_ss: 1.061647, loss_d: 0.302348
0.1916 --- loss: 1.412244, loss_ss: 0.985519, loss_d: 0.426725
0.2300 --- loss: 1.607027, loss_ss: 0.999909, loss_d: 0.607118
0.2683 --- loss: 1.444881, loss_ss: 0.868161, loss_d: 0.576720
0.3066 --- loss: 1.747356, loss_ss: 1.115220, loss_d: 0.632136
0.3450 --- loss: 1.298036, loss_ss: 1.129163, loss_d: 0.168872
0.3833 --- loss: 1.628098, loss_ss: 1.115310, loss_d: 0.512788
0.4216 --- loss: 1.433315, loss_ss: 1.054249, loss_d: 0.379066
0.4599 --- loss: 1.377263, loss_ss: 0.977496, loss_d: 0.399767
0.4983 --- loss: 1.166200, loss_ss: 0.765608, loss_d: 0.400592
0.5366 --- loss: 1.202685, loss_ss: 0.725592, loss_d: 0.477093
0.5749 --- loss: 1.189124, loss_ss: 1.013169, loss_d: 0.175955
0.6133 --- loss: 1.339403, loss_ss: 0.959410, loss_d: 0.379992
0.6516 --- loss: 1.520972, loss_ss: 1.071362, loss_d: 0.449611
0.6899 --- loss: 1.536090, loss_ss: 1.144393, loss_d: 0.391697
0.7282 --- loss: 1.823101, loss_ss: 1.090754, loss_d: 0.732347
0.7666 --- loss: 1.818557, loss_ss: 0.963859, loss_d: 0.854697
0.8049 --- loss: 1.372646, loss_ss: 0.875875, loss_d: 0.496771
0.8432 --- loss: 1.490552, loss_ss: 1.228883, loss_d: 0.261669
0.8816 --- loss: 1.810341, loss_ss: 0.857892, loss_d: 0.952448
0.9199 --- loss: 1.625518, loss_ss: 1.338964, loss_d: 0.286554
0.9582 --- loss: 1.167428, loss_ss: 0.837980, loss_d: 0.329448
0.9966 --- loss: 1.072913, loss_ss: 0.731155, loss_d: 0.341758
Epoch finished! Loss: 1.4104335193450634
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.446980, loss_ss: 1.159317, loss_d: 0.287663
0.0383 --- loss: 1.462836, loss_ss: 0.964126, loss_d: 0.498710
0.0767 --- loss: 1.245851, loss_ss: 0.810018, loss_d: 0.435833
0.1150 --- loss: 1.193432, loss_ss: 0.867007, loss_d: 0.326425
0.1533 --- loss: 1.094019, loss_ss: 0.853441, loss_d: 0.240577
0.1916 --- loss: 1.558730, loss_ss: 1.070023, loss_d: 0.488707
0.2300 --- loss: 1.204480, loss_ss: 0.735131, loss_d: 0.469348
0.2683 --- loss: 1.107716, loss_ss: 0.776650, loss_d: 0.331066
0.3066 --- loss: 1.704444, loss_ss: 0.835097, loss_d: 0.869347
0.3450 --- loss: 1.327251, loss_ss: 1.115695, loss_d: 0.211556
0.3833 --- loss: 1.453350, loss_ss: 0.947630, loss_d: 0.505719
0.4216 --- loss: 1.725065, loss_ss: 1.160986, loss_d: 0.564079
0.4599 --- loss: 1.607361, loss_ss: 0.841990, loss_d: 0.765371
0.4983 --- loss: 1.307794, loss_ss: 0.978607, loss_d: 0.329186
0.5366 --- loss: 1.716122, loss_ss: 1.110005, loss_d: 0.606118
0.5749 --- loss: 1.118484, loss_ss: 0.818461, loss_d: 0.300023
0.6133 --- loss: 1.506782, loss_ss: 0.862384, loss_d: 0.644398
0.6516 --- loss: 1.504720, loss_ss: 0.817518, loss_d: 0.687203
0.6899 --- loss: 1.699950, loss_ss: 0.881046, loss_d: 0.818905
0.7282 --- loss: 1.499707, loss_ss: 0.952664, loss_d: 0.547044
0.7666 --- loss: 1.238489, loss_ss: 0.839011, loss_d: 0.399478
0.8049 --- loss: 1.228853, loss_ss: 0.995297, loss_d: 0.233557
0.8432 --- loss: 1.040526, loss_ss: 0.870724, loss_d: 0.169802
0.8816 --- loss: 1.325138, loss_ss: 0.842420, loss_d: 0.482718
0.9199 --- loss: 0.855307, loss_ss: 0.694202, loss_d: 0.161105
0.9582 --- loss: 1.242636, loss_ss: 0.599920, loss_d: 0.642717
0.9966 --- loss: 0.868646, loss_ss: 0.659016, loss_d: 0.209630
Epoch finished! Loss: 1.3495942033254182
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.478720, loss_ss: 0.933952, loss_d: 0.544769
0.0383 --- loss: 1.602296, loss_ss: 1.146923, loss_d: 0.455373
0.0767 --- loss: 1.184500, loss_ss: 1.005956, loss_d: 0.178544
0.1150 --- loss: 1.811346, loss_ss: 1.114503, loss_d: 0.696844
0.1533 --- loss: 1.444298, loss_ss: 0.955911, loss_d: 0.488387
0.1916 --- loss: 1.540409, loss_ss: 1.084076, loss_d: 0.456333
0.2300 --- loss: 1.385644, loss_ss: 1.030115, loss_d: 0.355529
0.2683 --- loss: 1.368004, loss_ss: 0.877513, loss_d: 0.490491
0.3066 --- loss: 1.170857, loss_ss: 0.843171, loss_d: 0.327686
0.3450 --- loss: 1.172710, loss_ss: 0.921601, loss_d: 0.251109
0.3833 --- loss: 1.366688, loss_ss: 1.009753, loss_d: 0.356934
0.4216 --- loss: 1.358203, loss_ss: 0.984212, loss_d: 0.373991
0.4599 --- loss: 1.504945, loss_ss: 1.290026, loss_d: 0.214919
0.4983 --- loss: 1.030828, loss_ss: 0.779106, loss_d: 0.251722
0.5366 --- loss: 1.079604, loss_ss: 0.841874, loss_d: 0.237730
0.5749 --- loss: 1.293470, loss_ss: 0.914980, loss_d: 0.378489
0.6133 --- loss: 1.534682, loss_ss: 1.111551, loss_d: 0.423131
0.6516 --- loss: 1.608959, loss_ss: 1.064785, loss_d: 0.544174
0.6899 --- loss: 1.209758, loss_ss: 0.807067, loss_d: 0.402691
0.7282 --- loss: 1.215460, loss_ss: 1.079271, loss_d: 0.136189
0.7666 --- loss: 1.176266, loss_ss: 0.840619, loss_d: 0.335647
0.8049 --- loss: 0.984542, loss_ss: 0.732406, loss_d: 0.252136
0.8432 --- loss: 1.101937, loss_ss: 0.964853, loss_d: 0.137083
0.8816 --- loss: 1.206080, loss_ss: 0.990321, loss_d: 0.215759
0.9199 --- loss: 1.490229, loss_ss: 1.133908, loss_d: 0.356321
0.9582 --- loss: 1.269088, loss_ss: 0.880050, loss_d: 0.389038
0.9966 --- loss: 1.420647, loss_ss: 0.764832, loss_d: 0.655815
Epoch finished! Loss: 1.2984795889029137
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.355535, loss_ss: 1.018549, loss_d: 0.336987
0.0383 --- loss: 1.128201, loss_ss: 0.798798, loss_d: 0.329402
0.0767 --- loss: 1.761932, loss_ss: 1.127064, loss_d: 0.634869
0.1150 --- loss: 1.252267, loss_ss: 0.895606, loss_d: 0.356660
0.1533 --- loss: 1.256216, loss_ss: 0.890232, loss_d: 0.365984
0.1916 --- loss: 1.191262, loss_ss: 0.740675, loss_d: 0.450587
0.2300 --- loss: 1.213131, loss_ss: 1.013079, loss_d: 0.200052
0.2683 --- loss: 0.981741, loss_ss: 0.726481, loss_d: 0.255260
0.3066 --- loss: 2.136519, loss_ss: 1.114423, loss_d: 1.022097
0.3450 --- loss: 1.109609, loss_ss: 0.835036, loss_d: 0.274573
0.3833 --- loss: 0.855472, loss_ss: 0.672739, loss_d: 0.182732
0.4216 --- loss: 0.967123, loss_ss: 0.677953, loss_d: 0.289170
0.4599 --- loss: 0.993916, loss_ss: 0.749184, loss_d: 0.244732
0.4983 --- loss: 1.174209, loss_ss: 0.721313, loss_d: 0.452896
0.5366 --- loss: 1.439340, loss_ss: 1.273869, loss_d: 0.165471
0.5749 --- loss: 1.604697, loss_ss: 1.063074, loss_d: 0.541623
0.6133 --- loss: 1.199670, loss_ss: 1.022991, loss_d: 0.176679
0.6516 --- loss: 1.095532, loss_ss: 0.775025, loss_d: 0.320507
0.6899 --- loss: 1.128345, loss_ss: 0.845650, loss_d: 0.282696
0.7282 --- loss: 1.473943, loss_ss: 1.029757, loss_d: 0.444186
0.7666 --- loss: 1.418824, loss_ss: 0.944151, loss_d: 0.474673
0.8049 --- loss: 1.085259, loss_ss: 0.685293, loss_d: 0.399966
0.8432 --- loss: 1.078207, loss_ss: 0.817320, loss_d: 0.260886
0.8816 --- loss: 1.451710, loss_ss: 1.115131, loss_d: 0.336578
0.9199 --- loss: 1.373191, loss_ss: 1.016092, loss_d: 0.357099
0.9582 --- loss: 1.079357, loss_ss: 0.789476, loss_d: 0.289882
0.9966 --- loss: 0.941724, loss_ss: 0.632465, loss_d: 0.309259
Epoch finished! Loss: 1.2433941086897484
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.912592, loss_ss: 1.315388, loss_d: 0.597203
0.0383 --- loss: 1.189017, loss_ss: 0.658960, loss_d: 0.530057
0.0767 --- loss: 1.091044, loss_ss: 0.828753, loss_d: 0.262291
0.1150 --- loss: 1.030141, loss_ss: 0.778246, loss_d: 0.251895
0.1533 --- loss: 1.045519, loss_ss: 0.835012, loss_d: 0.210506
0.1916 --- loss: 1.152106, loss_ss: 0.744579, loss_d: 0.407527
0.2300 --- loss: 2.251568, loss_ss: 0.662772, loss_d: 1.588796
0.2683 --- loss: 0.954911, loss_ss: 0.810428, loss_d: 0.144483
0.3066 --- loss: 1.422099, loss_ss: 0.954341, loss_d: 0.467758
0.3450 --- loss: 1.482572, loss_ss: 1.046925, loss_d: 0.435648
0.3833 --- loss: 0.905568, loss_ss: 0.711711, loss_d: 0.193857
0.4216 --- loss: 1.478092, loss_ss: 0.740240, loss_d: 0.737851
0.4599 --- loss: 0.996414, loss_ss: 0.814303, loss_d: 0.182111
0.4983 --- loss: 1.088838, loss_ss: 0.803740, loss_d: 0.285098
0.5366 --- loss: 1.150131, loss_ss: 0.993756, loss_d: 0.156375
0.5749 --- loss: 1.522659, loss_ss: 0.840771, loss_d: 0.681888
0.6133 --- loss: 1.582498, loss_ss: 1.166804, loss_d: 0.415694
0.6516 --- loss: 1.229945, loss_ss: 0.842377, loss_d: 0.387568
0.6899 --- loss: 1.352181, loss_ss: 1.145684, loss_d: 0.206496
0.7282 --- loss: 1.283606, loss_ss: 0.745155, loss_d: 0.538451
0.7666 --- loss: 1.352117, loss_ss: 0.976070, loss_d: 0.376046
0.8049 --- loss: 1.279715, loss_ss: 0.760298, loss_d: 0.519417
0.8432 --- loss: 1.154009, loss_ss: 0.941713, loss_d: 0.212295
0.8816 --- loss: 1.344693, loss_ss: 1.053730, loss_d: 0.290963
0.9199 --- loss: 1.058996, loss_ss: 0.667864, loss_d: 0.391132
0.9582 --- loss: 1.041372, loss_ss: 0.826775, loss_d: 0.214597
0.9966 --- loss: 1.201536, loss_ss: 0.817321, loss_d: 0.384215
Epoch finished! Loss: 1.236371952524552
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.640461, loss_ss: 0.720074, loss_d: 0.920387
0.0383 --- loss: 0.838285, loss_ss: 0.645074, loss_d: 0.193210
0.0767 --- loss: 1.200118, loss_ss: 0.887732, loss_d: 0.312387
0.1150 --- loss: 1.076215, loss_ss: 0.914952, loss_d: 0.161263
0.1533 --- loss: 0.954102, loss_ss: 0.782571, loss_d: 0.171532
0.1916 --- loss: 0.854531, loss_ss: 0.590781, loss_d: 0.263750
0.2300 --- loss: 1.146277, loss_ss: 0.697118, loss_d: 0.449159
0.2683 --- loss: 1.153399, loss_ss: 0.970933, loss_d: 0.182466
0.3066 --- loss: 0.941508, loss_ss: 0.635755, loss_d: 0.305753
0.3450 --- loss: 1.234866, loss_ss: 0.872112, loss_d: 0.362754
0.3833 --- loss: 1.082745, loss_ss: 0.755450, loss_d: 0.327294
0.4216 --- loss: 1.846061, loss_ss: 1.275759, loss_d: 0.570302
0.4599 --- loss: 1.279194, loss_ss: 1.031361, loss_d: 0.247833
0.4983 --- loss: 0.920854, loss_ss: 0.692881, loss_d: 0.227974
0.5366 --- loss: 1.077741, loss_ss: 0.974334, loss_d: 0.103407
0.5749 --- loss: 0.861144, loss_ss: 0.704743, loss_d: 0.156400
0.6133 --- loss: 2.008365, loss_ss: 0.830411, loss_d: 1.177954
0.6516 --- loss: 1.106399, loss_ss: 0.874454, loss_d: 0.231945
0.6899 --- loss: 1.146845, loss_ss: 0.839641, loss_d: 0.307204
0.7282 --- loss: 1.286048, loss_ss: 1.013908, loss_d: 0.272140
0.7666 --- loss: 1.042638, loss_ss: 0.681931, loss_d: 0.360706
0.8049 --- loss: 1.250495, loss_ss: 1.042931, loss_d: 0.207565
0.8432 --- loss: 1.377155, loss_ss: 0.967169, loss_d: 0.409986
0.8816 --- loss: 1.488191, loss_ss: 1.066343, loss_d: 0.421848
0.9199 --- loss: 1.095377, loss_ss: 0.872890, loss_d: 0.222487
0.9582 --- loss: 1.583152, loss_ss: 1.242405, loss_d: 0.340747
0.9966 --- loss: 1.242670, loss_ss: 1.031363, loss_d: 0.211308
Epoch finished! Loss: 1.2187353395498717
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7137931034482758
             precision    recall  f1-score   support

        0.0       0.83      0.19      0.32       154
        1.0       0.00      0.00      0.00        34
        2.0       0.58      0.94      0.72       307
        3.0       0.93      0.98      0.95       168
        4.0       0.86      0.67      0.76       207

avg / total       0.74      0.71      0.67       870
 


====== chc037-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  85.06  19.48   99.16  83.33     31.58
1  96.09   0.00  100.00   0.00      0.00
2  73.79  93.81   62.88  57.95     71.64
3  98.16  97.62   98.29  93.18     95.35
4  89.66  67.15   96.68  86.34     75.54
Total accuracy: 71.38%
Average sen: 55.61%
Average spec: 91.40%
Macro f1-score: 54.82%
Diagnosis acc on 15mins: 1.0
[0.02380622 0.2730124  0.0141369  0.04615402 0.09546754 0.1100416
 0.13148123 0.04946348 0.06598685 0.11165576 0.32334614 0.17849644
 0.02670246 0.05113437 0.04360197 0.04772691 0.07548362 0.07267392
 0.27397138 0.35937154 0.33080542 0.10177451 0.06854951 0.08190959
 0.28515494 0.42865634 0.48022914 0.3397024  0.08185387]
pred: 0.15766725811208115, label: 0
Right! Diagnosis: Other

=== Test on chc040-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.326865, loss_ss: 1.649163, loss_d: 0.677701
0.0384 --- loss: 2.218179, loss_ss: 1.567245, loss_d: 0.650934
0.0769 --- loss: 2.118637, loss_ss: 1.444780, loss_d: 0.673856
0.1153 --- loss: 1.931472, loss_ss: 1.534078, loss_d: 0.397394
0.1537 --- loss: 2.262987, loss_ss: 1.607657, loss_d: 0.655330
0.1922 --- loss: 2.137483, loss_ss: 1.395998, loss_d: 0.741485
0.2306 --- loss: 1.715594, loss_ss: 1.310787, loss_d: 0.404808
0.2690 --- loss: 2.531432, loss_ss: 1.519785, loss_d: 1.011647
0.3075 --- loss: 1.777643, loss_ss: 1.445143, loss_d: 0.332500
0.3459 --- loss: 1.670766, loss_ss: 1.178730, loss_d: 0.492035
0.3843 --- loss: 1.842129, loss_ss: 1.562928, loss_d: 0.279201
0.4228 --- loss: 2.543443, loss_ss: 1.430563, loss_d: 1.112880
0.4612 --- loss: 1.781833, loss_ss: 1.393264, loss_d: 0.388569
0.4996 --- loss: 1.844500, loss_ss: 1.339739, loss_d: 0.504761
0.5380 --- loss: 2.176262, loss_ss: 1.364311, loss_d: 0.811951
0.5765 --- loss: 2.088505, loss_ss: 1.387973, loss_d: 0.700532
0.6149 --- loss: 1.781250, loss_ss: 1.226941, loss_d: 0.554308
0.6533 --- loss: 2.005236, loss_ss: 1.477238, loss_d: 0.527998
0.6918 --- loss: 1.877907, loss_ss: 1.380994, loss_d: 0.496913
0.7302 --- loss: 1.632841, loss_ss: 1.392357, loss_d: 0.240484
0.7686 --- loss: 1.851727, loss_ss: 1.181382, loss_d: 0.670345
0.8071 --- loss: 1.651755, loss_ss: 1.204855, loss_d: 0.446900
0.8455 --- loss: 1.655832, loss_ss: 1.195379, loss_d: 0.460453
0.8839 --- loss: 1.959792, loss_ss: 1.206173, loss_d: 0.753619
0.9224 --- loss: 1.319472, loss_ss: 1.042897, loss_d: 0.276575
0.9608 --- loss: 1.770139, loss_ss: 1.125172, loss_d: 0.644967
0.9992 --- loss: 1.595635, loss_ss: 1.308848, loss_d: 0.286787
Epoch finished! Loss: 1.9546582052340875
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.784073, loss_ss: 1.190724, loss_d: 0.593349
0.0384 --- loss: 1.734502, loss_ss: 1.317904, loss_d: 0.416598
0.0769 --- loss: 1.583015, loss_ss: 1.098243, loss_d: 0.484772
0.1153 --- loss: 1.546417, loss_ss: 1.056374, loss_d: 0.490042
0.1537 --- loss: 1.350263, loss_ss: 1.020428, loss_d: 0.329835
0.1922 --- loss: 1.566591, loss_ss: 1.227337, loss_d: 0.339254
0.2306 --- loss: 1.583690, loss_ss: 1.148238, loss_d: 0.435452
0.2690 --- loss: 1.911347, loss_ss: 1.033460, loss_d: 0.877887
0.3075 --- loss: 1.838750, loss_ss: 1.219941, loss_d: 0.618810
0.3459 --- loss: 1.849584, loss_ss: 1.039916, loss_d: 0.809668
0.3843 --- loss: 1.748265, loss_ss: 1.067122, loss_d: 0.681143
0.4228 --- loss: 1.479116, loss_ss: 0.996960, loss_d: 0.482156
0.4612 --- loss: 1.593223, loss_ss: 1.095505, loss_d: 0.497718
0.4996 --- loss: 1.420676, loss_ss: 0.980377, loss_d: 0.440299
0.5380 --- loss: 1.728238, loss_ss: 1.156042, loss_d: 0.572196
0.5765 --- loss: 1.552653, loss_ss: 1.000502, loss_d: 0.552151
0.6149 --- loss: 1.384156, loss_ss: 1.169394, loss_d: 0.214762
0.6533 --- loss: 1.788077, loss_ss: 1.392687, loss_d: 0.395390
0.6918 --- loss: 1.942074, loss_ss: 1.037914, loss_d: 0.904160
0.7302 --- loss: 1.708454, loss_ss: 1.039751, loss_d: 0.668703
0.7686 --- loss: 1.627452, loss_ss: 1.075959, loss_d: 0.551493
0.8071 --- loss: 1.879392, loss_ss: 1.161340, loss_d: 0.718052
0.8455 --- loss: 1.400266, loss_ss: 0.982939, loss_d: 0.417327
0.8839 --- loss: 1.624964, loss_ss: 1.368719, loss_d: 0.256245
0.9224 --- loss: 2.179585, loss_ss: 1.389401, loss_d: 0.790183
0.9608 --- loss: 1.442652, loss_ss: 1.092119, loss_d: 0.350533
0.9992 --- loss: 1.839931, loss_ss: 0.838902, loss_d: 1.001028
Epoch finished! Loss: 1.7036057316339932
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.263013, loss_ss: 1.262326, loss_d: 1.000687
0.0384 --- loss: 1.711544, loss_ss: 1.283747, loss_d: 0.427796
0.0769 --- loss: 1.642517, loss_ss: 1.080483, loss_d: 0.562034
0.1153 --- loss: 1.486024, loss_ss: 0.830551, loss_d: 0.655474
0.1537 --- loss: 2.054455, loss_ss: 1.408444, loss_d: 0.646011
0.1922 --- loss: 1.418925, loss_ss: 0.887201, loss_d: 0.531724
0.2306 --- loss: 1.367002, loss_ss: 0.833218, loss_d: 0.533783
0.2690 --- loss: 1.628894, loss_ss: 0.955162, loss_d: 0.673732
0.3075 --- loss: 1.529311, loss_ss: 1.058749, loss_d: 0.470562
0.3459 --- loss: 1.791678, loss_ss: 0.857554, loss_d: 0.934123
0.3843 --- loss: 1.609740, loss_ss: 0.860038, loss_d: 0.749702
0.4228 --- loss: 1.759306, loss_ss: 0.917787, loss_d: 0.841519
0.4612 --- loss: 1.451635, loss_ss: 0.947587, loss_d: 0.504048
0.4996 --- loss: 1.789258, loss_ss: 1.314177, loss_d: 0.475081
0.5380 --- loss: 1.333916, loss_ss: 0.825060, loss_d: 0.508856
0.5765 --- loss: 1.209812, loss_ss: 0.874198, loss_d: 0.335614
0.6149 --- loss: 1.428138, loss_ss: 0.962885, loss_d: 0.465253
0.6533 --- loss: 1.529562, loss_ss: 1.028448, loss_d: 0.501114
0.6918 --- loss: 1.266761, loss_ss: 0.702148, loss_d: 0.564613
0.7302 --- loss: 1.665256, loss_ss: 1.126725, loss_d: 0.538531
0.7686 --- loss: 1.188031, loss_ss: 0.880030, loss_d: 0.308001
0.8071 --- loss: 1.949520, loss_ss: 1.185434, loss_d: 0.764086
0.8455 --- loss: 1.358986, loss_ss: 0.819592, loss_d: 0.539394
0.8839 --- loss: 1.561954, loss_ss: 0.790353, loss_d: 0.771601
0.9224 --- loss: 1.493550, loss_ss: 0.948158, loss_d: 0.545392
0.9608 --- loss: 1.421863, loss_ss: 0.802797, loss_d: 0.619066
0.9992 --- loss: 1.560560, loss_ss: 0.848179, loss_d: 0.712381
Epoch finished! Loss: 1.5707234199230486
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.528755, loss_ss: 1.009450, loss_d: 0.519305
0.0384 --- loss: 1.337431, loss_ss: 0.974452, loss_d: 0.362979
0.0769 --- loss: 1.547377, loss_ss: 1.037385, loss_d: 0.509992
0.1153 --- loss: 1.605328, loss_ss: 0.918319, loss_d: 0.687009
0.1537 --- loss: 1.493471, loss_ss: 0.937689, loss_d: 0.555783
0.1922 --- loss: 1.340610, loss_ss: 0.896262, loss_d: 0.444347
0.2306 --- loss: 1.608240, loss_ss: 1.365495, loss_d: 0.242745
0.2690 --- loss: 1.417034, loss_ss: 1.004286, loss_d: 0.412748
0.3075 --- loss: 1.303953, loss_ss: 0.855263, loss_d: 0.448690
0.3459 --- loss: 1.611825, loss_ss: 0.877115, loss_d: 0.734710
0.3843 --- loss: 1.738790, loss_ss: 1.275060, loss_d: 0.463730
0.4228 --- loss: 1.642583, loss_ss: 0.982325, loss_d: 0.660258
0.4612 --- loss: 1.390990, loss_ss: 1.000596, loss_d: 0.390394
0.4996 --- loss: 1.381823, loss_ss: 0.936072, loss_d: 0.445751
0.5380 --- loss: 1.606543, loss_ss: 1.009228, loss_d: 0.597315
0.5765 --- loss: 1.731647, loss_ss: 1.008862, loss_d: 0.722786
0.6149 --- loss: 1.399683, loss_ss: 0.921950, loss_d: 0.477733
0.6533 --- loss: 1.577860, loss_ss: 0.979287, loss_d: 0.598572
0.6918 --- loss: 1.402792, loss_ss: 0.821637, loss_d: 0.581155
0.7302 --- loss: 1.046816, loss_ss: 0.773170, loss_d: 0.273646
0.7686 --- loss: 1.522925, loss_ss: 1.223400, loss_d: 0.299525
0.8071 --- loss: 2.276310, loss_ss: 1.144421, loss_d: 1.131890
0.8455 --- loss: 1.352167, loss_ss: 0.979929, loss_d: 0.372238
0.8839 --- loss: 1.530978, loss_ss: 0.908427, loss_d: 0.622552
0.9224 --- loss: 1.744973, loss_ss: 0.949987, loss_d: 0.794986
0.9608 --- loss: 1.398465, loss_ss: 1.146006, loss_d: 0.252459
0.9992 --- loss: 1.600749, loss_ss: 1.089250, loss_d: 0.511499
Epoch finished! Loss: 1.4589503288269043
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.603788, loss_ss: 1.137958, loss_d: 0.465830
0.0384 --- loss: 1.162855, loss_ss: 0.738396, loss_d: 0.424459
0.0769 --- loss: 1.422208, loss_ss: 1.140873, loss_d: 0.281335
0.1153 --- loss: 1.416387, loss_ss: 1.131345, loss_d: 0.285042
0.1537 --- loss: 1.302374, loss_ss: 0.714901, loss_d: 0.587473
0.1922 --- loss: 1.483508, loss_ss: 0.952263, loss_d: 0.531245
0.2306 --- loss: 1.401101, loss_ss: 1.022829, loss_d: 0.378272
0.2690 --- loss: 1.255560, loss_ss: 0.878812, loss_d: 0.376748
0.3075 --- loss: 1.215358, loss_ss: 0.743647, loss_d: 0.471711
0.3459 --- loss: 1.769574, loss_ss: 1.051502, loss_d: 0.718072
0.3843 --- loss: 1.531523, loss_ss: 1.147033, loss_d: 0.384491
0.4228 --- loss: 1.941924, loss_ss: 1.316803, loss_d: 0.625122
0.4612 --- loss: 1.255410, loss_ss: 1.009339, loss_d: 0.246071
0.4996 --- loss: 2.074498, loss_ss: 1.433883, loss_d: 0.640615
0.5380 --- loss: 1.489595, loss_ss: 0.990454, loss_d: 0.499141
0.5765 --- loss: 1.328247, loss_ss: 0.998250, loss_d: 0.329997
0.6149 --- loss: 1.181553, loss_ss: 0.768409, loss_d: 0.413144
0.6533 --- loss: 1.410925, loss_ss: 0.878801, loss_d: 0.532124
0.6918 --- loss: 1.444762, loss_ss: 0.723241, loss_d: 0.721521
0.7302 --- loss: 1.074276, loss_ss: 0.722826, loss_d: 0.351450
0.7686 --- loss: 1.017772, loss_ss: 0.704545, loss_d: 0.313227
0.8071 --- loss: 1.348210, loss_ss: 0.976095, loss_d: 0.372114
0.8455 --- loss: 1.021111, loss_ss: 0.758367, loss_d: 0.262744
0.8839 --- loss: 1.932457, loss_ss: 1.222858, loss_d: 0.709599
0.9224 --- loss: 1.126707, loss_ss: 0.790580, loss_d: 0.336127
0.9608 --- loss: 1.088013, loss_ss: 0.770670, loss_d: 0.317343
0.9992 --- loss: 1.320718, loss_ss: 0.812277, loss_d: 0.508441
Epoch finished! Loss: 1.4000526448855033
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.415098, loss_ss: 0.856799, loss_d: 0.558299
0.0384 --- loss: 1.527728, loss_ss: 1.114857, loss_d: 0.412871
0.0769 --- loss: 1.035603, loss_ss: 0.871276, loss_d: 0.164327
0.1153 --- loss: 0.961443, loss_ss: 0.795812, loss_d: 0.165630
0.1537 --- loss: 1.176278, loss_ss: 0.800968, loss_d: 0.375310
0.1922 --- loss: 1.950699, loss_ss: 0.901434, loss_d: 1.049265
0.2306 --- loss: 1.153728, loss_ss: 0.823414, loss_d: 0.330314
0.2690 --- loss: 1.406072, loss_ss: 0.833987, loss_d: 0.572085
0.3075 --- loss: 1.799721, loss_ss: 1.164416, loss_d: 0.635306
0.3459 --- loss: 1.214314, loss_ss: 1.035062, loss_d: 0.179252
0.3843 --- loss: 1.965687, loss_ss: 0.847759, loss_d: 1.117928
0.4228 --- loss: 1.400605, loss_ss: 1.089982, loss_d: 0.310624
0.4612 --- loss: 1.337168, loss_ss: 0.826227, loss_d: 0.510942
0.4996 --- loss: 1.622428, loss_ss: 1.263002, loss_d: 0.359426
0.5380 --- loss: 1.622757, loss_ss: 0.827709, loss_d: 0.795048
0.5765 --- loss: 1.365441, loss_ss: 0.821681, loss_d: 0.543760
0.6149 --- loss: 1.383384, loss_ss: 0.878453, loss_d: 0.504931
0.6533 --- loss: 1.221223, loss_ss: 0.728951, loss_d: 0.492272
0.6918 --- loss: 1.112587, loss_ss: 0.736154, loss_d: 0.376432
0.7302 --- loss: 0.946859, loss_ss: 0.795890, loss_d: 0.150969
0.7686 --- loss: 1.547626, loss_ss: 0.943350, loss_d: 0.604276
0.8071 --- loss: 1.065810, loss_ss: 0.769691, loss_d: 0.296119
0.8455 --- loss: 1.046016, loss_ss: 0.796167, loss_d: 0.249850
0.8839 --- loss: 1.536275, loss_ss: 1.283735, loss_d: 0.252540
0.9224 --- loss: 2.271748, loss_ss: 1.366861, loss_d: 0.904887
0.9608 --- loss: 1.547241, loss_ss: 0.882239, loss_d: 0.665002
0.9992 --- loss: 1.732388, loss_ss: 1.251145, loss_d: 0.481243
Epoch finished! Loss: 1.3295220111425106
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.607504, loss_ss: 1.015432, loss_d: 0.592072
0.0384 --- loss: 1.042197, loss_ss: 0.838221, loss_d: 0.203976
0.0769 --- loss: 1.595756, loss_ss: 0.691924, loss_d: 0.903832
0.1153 --- loss: 1.166319, loss_ss: 0.834822, loss_d: 0.331497
0.1537 --- loss: 1.356139, loss_ss: 1.049962, loss_d: 0.306176
0.1922 --- loss: 1.181751, loss_ss: 0.822127, loss_d: 0.359624
0.2306 --- loss: 1.213818, loss_ss: 1.022877, loss_d: 0.190942
0.2690 --- loss: 1.111602, loss_ss: 0.925203, loss_d: 0.186399
0.3075 --- loss: 1.768758, loss_ss: 0.882410, loss_d: 0.886348
0.3459 --- loss: 1.099936, loss_ss: 0.899053, loss_d: 0.200884
0.3843 --- loss: 1.029098, loss_ss: 0.642396, loss_d: 0.386703
0.4228 --- loss: 1.042376, loss_ss: 0.739911, loss_d: 0.302465
0.4612 --- loss: 1.364154, loss_ss: 0.749058, loss_d: 0.615096
0.4996 --- loss: 1.380727, loss_ss: 1.025828, loss_d: 0.354898
0.5380 --- loss: 1.222220, loss_ss: 0.872861, loss_d: 0.349359
0.5765 --- loss: 0.879365, loss_ss: 0.712204, loss_d: 0.167161
0.6149 --- loss: 1.396706, loss_ss: 1.030597, loss_d: 0.366109
0.6533 --- loss: 1.268906, loss_ss: 1.037854, loss_d: 0.231052
0.6918 --- loss: 0.875758, loss_ss: 0.656511, loss_d: 0.219248
0.7302 --- loss: 1.085642, loss_ss: 0.895109, loss_d: 0.190533
0.7686 --- loss: 0.814959, loss_ss: 0.657535, loss_d: 0.157424
0.8071 --- loss: 2.192029, loss_ss: 1.460152, loss_d: 0.731877
0.8455 --- loss: 1.518477, loss_ss: 1.052730, loss_d: 0.465747
0.8839 --- loss: 1.231356, loss_ss: 0.643359, loss_d: 0.587996
0.9224 --- loss: 0.980182, loss_ss: 0.777213, loss_d: 0.202969
0.9608 --- loss: 1.890782, loss_ss: 1.138920, loss_d: 0.751862
0.9992 --- loss: 2.522233, loss_ss: 2.292087, loss_d: 0.230147
Epoch finished! Loss: 1.3043777983922225
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.292638, loss_ss: 0.891393, loss_d: 0.401245
0.0384 --- loss: 1.217001, loss_ss: 0.744880, loss_d: 0.472122
0.0769 --- loss: 1.078749, loss_ss: 0.860318, loss_d: 0.218431
0.1153 --- loss: 1.720254, loss_ss: 0.824449, loss_d: 0.895805
0.1537 --- loss: 1.310972, loss_ss: 0.862272, loss_d: 0.448700
0.1922 --- loss: 1.109577, loss_ss: 0.888103, loss_d: 0.221474
0.2306 --- loss: 1.094921, loss_ss: 0.799243, loss_d: 0.295678
0.2690 --- loss: 1.162210, loss_ss: 0.780860, loss_d: 0.381350
0.3075 --- loss: 1.281275, loss_ss: 0.906417, loss_d: 0.374857
0.3459 --- loss: 1.211765, loss_ss: 0.899882, loss_d: 0.311883
0.3843 --- loss: 1.537558, loss_ss: 1.052585, loss_d: 0.484973
0.4228 --- loss: 1.114620, loss_ss: 0.839396, loss_d: 0.275225
0.4612 --- loss: 1.812645, loss_ss: 1.387364, loss_d: 0.425281
0.4996 --- loss: 1.217469, loss_ss: 0.970937, loss_d: 0.246532
0.5380 --- loss: 1.228031, loss_ss: 0.747395, loss_d: 0.480636
0.5765 --- loss: 1.070280, loss_ss: 0.797797, loss_d: 0.272483
0.6149 --- loss: 1.052987, loss_ss: 0.636712, loss_d: 0.416274
0.6533 --- loss: 1.130727, loss_ss: 0.886618, loss_d: 0.244109
0.6918 --- loss: 1.136018, loss_ss: 0.899533, loss_d: 0.236484
0.7302 --- loss: 1.672795, loss_ss: 0.857122, loss_d: 0.815673
0.7686 --- loss: 1.085743, loss_ss: 0.904411, loss_d: 0.181332
0.8071 --- loss: 1.570106, loss_ss: 1.054713, loss_d: 0.515393
0.8455 --- loss: 1.786319, loss_ss: 0.947310, loss_d: 0.839009
0.8839 --- loss: 1.749789, loss_ss: 0.918376, loss_d: 0.831412
0.9224 --- loss: 1.625718, loss_ss: 0.919839, loss_d: 0.705880
0.9608 --- loss: 1.734536, loss_ss: 1.064452, loss_d: 0.670084
0.9992 --- loss: 2.245869, loss_ss: 1.822416, loss_d: 0.423454
Epoch finished! Loss: 1.2759239698831852
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.122817, loss_ss: 0.743320, loss_d: 0.379497
0.0384 --- loss: 1.650920, loss_ss: 1.286627, loss_d: 0.364293
0.0769 --- loss: 1.208370, loss_ss: 1.011273, loss_d: 0.197097
0.1153 --- loss: 1.024258, loss_ss: 0.831760, loss_d: 0.192497
0.1537 --- loss: 0.947568, loss_ss: 0.752102, loss_d: 0.195466
0.1922 --- loss: 1.044060, loss_ss: 0.601390, loss_d: 0.442670
0.2306 --- loss: 1.342009, loss_ss: 0.942157, loss_d: 0.399852
0.2690 --- loss: 1.236389, loss_ss: 0.838406, loss_d: 0.397983
0.3075 --- loss: 1.470299, loss_ss: 1.010277, loss_d: 0.460022
0.3459 --- loss: 1.178291, loss_ss: 0.763006, loss_d: 0.415285
0.3843 --- loss: 1.055986, loss_ss: 0.903490, loss_d: 0.152495
0.4228 --- loss: 1.804319, loss_ss: 1.329510, loss_d: 0.474809
0.4612 --- loss: 1.206078, loss_ss: 0.717524, loss_d: 0.488554
0.4996 --- loss: 1.113471, loss_ss: 0.830408, loss_d: 0.283063
0.5380 --- loss: 0.934330, loss_ss: 0.507883, loss_d: 0.426447
0.5765 --- loss: 1.273910, loss_ss: 0.929317, loss_d: 0.344593
0.6149 --- loss: 1.583989, loss_ss: 0.972943, loss_d: 0.611046
0.6533 --- loss: 0.958426, loss_ss: 0.748150, loss_d: 0.210276
0.6918 --- loss: 1.211383, loss_ss: 0.743065, loss_d: 0.468318
0.7302 --- loss: 1.108889, loss_ss: 0.678937, loss_d: 0.429951
0.7686 --- loss: 0.818906, loss_ss: 0.671156, loss_d: 0.147750
0.8071 --- loss: 0.989913, loss_ss: 0.703210, loss_d: 0.286703
0.8455 --- loss: 0.782209, loss_ss: 0.663547, loss_d: 0.118662
0.8839 --- loss: 1.019348, loss_ss: 0.768801, loss_d: 0.250547
0.9224 --- loss: 1.407385, loss_ss: 0.873333, loss_d: 0.534052
0.9608 --- loss: 1.106194, loss_ss: 0.760671, loss_d: 0.345524
0.9992 --- loss: 1.194327, loss_ss: 0.837515, loss_d: 0.356812
Epoch finished! Loss: 1.238656552709066
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.048844, loss_ss: 0.632547, loss_d: 0.416297
0.0384 --- loss: 1.174368, loss_ss: 0.979365, loss_d: 0.195002
0.0769 --- loss: 0.682178, loss_ss: 0.558600, loss_d: 0.123578
0.1153 --- loss: 1.327166, loss_ss: 0.976527, loss_d: 0.350638
0.1537 --- loss: 1.044885, loss_ss: 0.786891, loss_d: 0.257994
0.1922 --- loss: 1.166279, loss_ss: 0.934388, loss_d: 0.231891
0.2306 --- loss: 0.872953, loss_ss: 0.528524, loss_d: 0.344429
0.2690 --- loss: 1.155892, loss_ss: 0.858365, loss_d: 0.297527
0.3075 --- loss: 0.867708, loss_ss: 0.658388, loss_d: 0.209320
0.3459 --- loss: 0.821398, loss_ss: 0.649613, loss_d: 0.171785
0.3843 --- loss: 1.079720, loss_ss: 0.798328, loss_d: 0.281392
0.4228 --- loss: 1.034904, loss_ss: 0.819533, loss_d: 0.215371
0.4612 --- loss: 1.470228, loss_ss: 1.159711, loss_d: 0.310516
0.4996 --- loss: 0.925035, loss_ss: 0.735008, loss_d: 0.190027
0.5380 --- loss: 1.438393, loss_ss: 0.894395, loss_d: 0.543998
0.5765 --- loss: 1.518081, loss_ss: 0.953310, loss_d: 0.564771
0.6149 --- loss: 1.521812, loss_ss: 1.135571, loss_d: 0.386242
0.6533 --- loss: 1.022258, loss_ss: 0.724741, loss_d: 0.297517
0.6918 --- loss: 1.125587, loss_ss: 0.848232, loss_d: 0.277354
0.7302 --- loss: 0.855182, loss_ss: 0.743061, loss_d: 0.112121
0.7686 --- loss: 0.879995, loss_ss: 0.690206, loss_d: 0.189790
0.8071 --- loss: 1.024609, loss_ss: 0.619372, loss_d: 0.405238
0.8455 --- loss: 1.498289, loss_ss: 0.960306, loss_d: 0.537982
0.8839 --- loss: 1.304599, loss_ss: 0.822401, loss_d: 0.482197
0.9224 --- loss: 0.946347, loss_ss: 0.683742, loss_d: 0.262606
0.9608 --- loss: 1.275117, loss_ss: 0.802095, loss_d: 0.473023
0.9992 --- loss: 1.151771, loss_ss: 0.918322, loss_d: 0.233448
Epoch finished! Loss: 1.1886751239116375
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7240740740740741
             precision    recall  f1-score   support

        0.0       0.81      0.52      0.64       185
        1.0       0.27      0.22      0.24        50
        2.0       0.83      0.81      0.82       483
        3.0       0.93      0.64      0.76       216
        4.0       0.48      0.98      0.65       146

avg / total       0.77      0.72      0.73      1080
 


====== chc040-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.72  52.43   97.43  80.83     63.61
1  93.61  22.00   97.09  26.83     24.18
2  83.98  81.16   86.26  82.70     81.92
3  91.85  64.35   98.73  92.67     75.96
4  85.65  97.95   83.73  48.47     64.85
Total accuracy: 72.41%
Average sen: 63.58%
Average spec: 92.65%
Macro f1-score: 62.10%
Diagnosis acc on 15mins: 0.25
[0.40992069 0.3766776  0.82426596 0.82200348 0.26362681 0.82408446
 0.43067065 0.99109113 0.98986524 0.97205192 0.40734321 0.94340277
 0.99263954 0.99119169 0.87663317 0.7226876  0.95544422 0.96776104
 0.98891538 0.96133554 0.89934999 0.43643582 0.75017244 0.38511562
 0.76470441 0.84092474 0.78486168 0.56691253 0.93622917 0.99100727
 0.98225594 0.98902601 0.44008321 0.70006263 0.70394635 0.3910369 ]
pred: 0.757603800131215, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc041-nsrr. train_data(2610), test_data(28) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.423504, loss_ss: 1.767899, loss_d: 0.655605
0.0383 --- loss: 2.250782, loss_ss: 1.457116, loss_d: 0.793667
0.0766 --- loss: 2.192181, loss_ss: 1.537967, loss_d: 0.654214
0.1149 --- loss: 2.083729, loss_ss: 1.383389, loss_d: 0.700340
0.1533 --- loss: 1.859397, loss_ss: 1.353972, loss_d: 0.505425
0.1916 --- loss: 2.276067, loss_ss: 1.475662, loss_d: 0.800405
0.2299 --- loss: 1.645462, loss_ss: 1.343600, loss_d: 0.301862
0.2682 --- loss: 1.954476, loss_ss: 1.369289, loss_d: 0.585188
0.3065 --- loss: 1.972579, loss_ss: 1.319018, loss_d: 0.653561
0.3448 --- loss: 1.892589, loss_ss: 1.327159, loss_d: 0.565430
0.3831 --- loss: 1.802759, loss_ss: 1.397256, loss_d: 0.405503
0.4215 --- loss: 1.880935, loss_ss: 1.305112, loss_d: 0.575824
0.4598 --- loss: 1.885825, loss_ss: 1.221166, loss_d: 0.664659
0.4981 --- loss: 1.875782, loss_ss: 1.377600, loss_d: 0.498182
0.5364 --- loss: 1.691720, loss_ss: 1.141166, loss_d: 0.550554
0.5747 --- loss: 1.651171, loss_ss: 1.126005, loss_d: 0.525165
0.6130 --- loss: 1.950967, loss_ss: 1.231270, loss_d: 0.719697
0.6513 --- loss: 1.631253, loss_ss: 1.332950, loss_d: 0.298303
0.6897 --- loss: 1.709138, loss_ss: 1.190054, loss_d: 0.519084
0.7280 --- loss: 1.934181, loss_ss: 1.055963, loss_d: 0.878218
0.7663 --- loss: 1.848360, loss_ss: 1.163543, loss_d: 0.684816
0.8046 --- loss: 1.270932, loss_ss: 1.060693, loss_d: 0.210239
0.8429 --- loss: 1.628307, loss_ss: 1.122997, loss_d: 0.505310
0.8812 --- loss: 1.367513, loss_ss: 0.922535, loss_d: 0.444977
0.9195 --- loss: 2.023623, loss_ss: 0.985079, loss_d: 1.038545
0.9579 --- loss: 1.970678, loss_ss: 1.231105, loss_d: 0.739573
0.9962 --- loss: 1.678997, loss_ss: 1.112775, loss_d: 0.566222
Epoch finished! Loss: 1.8857025568301862
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.731532, loss_ss: 1.100556, loss_d: 0.630975
0.0383 --- loss: 1.811802, loss_ss: 1.326873, loss_d: 0.484929
0.0766 --- loss: 1.743493, loss_ss: 1.116034, loss_d: 0.627459
0.1149 --- loss: 1.665666, loss_ss: 1.244558, loss_d: 0.421108
0.1533 --- loss: 1.766119, loss_ss: 1.148511, loss_d: 0.617609
0.1916 --- loss: 1.687844, loss_ss: 1.193295, loss_d: 0.494548
0.2299 --- loss: 1.425283, loss_ss: 1.090900, loss_d: 0.334383
0.2682 --- loss: 1.895217, loss_ss: 1.126964, loss_d: 0.768252
0.3065 --- loss: 1.750132, loss_ss: 1.133006, loss_d: 0.617126
0.3448 --- loss: 1.431960, loss_ss: 1.060239, loss_d: 0.371721
0.3831 --- loss: 1.968886, loss_ss: 1.265024, loss_d: 0.703862
0.4215 --- loss: 1.692837, loss_ss: 1.063071, loss_d: 0.629766
0.4598 --- loss: 1.722597, loss_ss: 1.021468, loss_d: 0.701128
0.4981 --- loss: 1.861466, loss_ss: 1.068169, loss_d: 0.793298
0.5364 --- loss: 1.867468, loss_ss: 0.990451, loss_d: 0.877017
0.5747 --- loss: 1.577049, loss_ss: 0.854187, loss_d: 0.722862
0.6130 --- loss: 1.966795, loss_ss: 1.079605, loss_d: 0.887190
0.6513 --- loss: 2.023423, loss_ss: 1.077121, loss_d: 0.946301
0.6897 --- loss: 1.613856, loss_ss: 1.024194, loss_d: 0.589663
0.7280 --- loss: 1.530379, loss_ss: 0.998248, loss_d: 0.532131
0.7663 --- loss: 1.630683, loss_ss: 1.086673, loss_d: 0.544010
0.8046 --- loss: 1.594647, loss_ss: 1.077050, loss_d: 0.517598
0.8429 --- loss: 1.684322, loss_ss: 1.050749, loss_d: 0.633574
0.8812 --- loss: 1.730747, loss_ss: 1.221994, loss_d: 0.508753
0.9195 --- loss: 1.544609, loss_ss: 0.848425, loss_d: 0.696185
0.9579 --- loss: 1.726752, loss_ss: 1.157787, loss_d: 0.568965
0.9962 --- loss: 1.667645, loss_ss: 1.002047, loss_d: 0.665598
Epoch finished! Loss: 1.649759069772867
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.551873, loss_ss: 1.022433, loss_d: 0.529440
0.0383 --- loss: 1.650522, loss_ss: 1.060049, loss_d: 0.590473
0.0766 --- loss: 1.404017, loss_ss: 0.738920, loss_d: 0.665097
0.1149 --- loss: 1.386229, loss_ss: 0.894505, loss_d: 0.491724
0.1533 --- loss: 1.511678, loss_ss: 1.053373, loss_d: 0.458305
0.1916 --- loss: 1.652806, loss_ss: 0.922061, loss_d: 0.730745
0.2299 --- loss: 1.444569, loss_ss: 0.949365, loss_d: 0.495204
0.2682 --- loss: 1.529351, loss_ss: 0.908205, loss_d: 0.621146
0.3065 --- loss: 1.463580, loss_ss: 0.935710, loss_d: 0.527870
0.3448 --- loss: 1.616179, loss_ss: 1.049069, loss_d: 0.567110
0.3831 --- loss: 1.691577, loss_ss: 1.353576, loss_d: 0.338001
0.4215 --- loss: 1.508076, loss_ss: 0.898236, loss_d: 0.609840
0.4598 --- loss: 1.418368, loss_ss: 1.043187, loss_d: 0.375181
0.4981 --- loss: 1.380405, loss_ss: 0.952686, loss_d: 0.427719
0.5364 --- loss: 1.354028, loss_ss: 0.709742, loss_d: 0.644287
0.5747 --- loss: 1.566340, loss_ss: 0.968253, loss_d: 0.598087
0.6130 --- loss: 1.809108, loss_ss: 1.498802, loss_d: 0.310306
0.6513 --- loss: 1.296220, loss_ss: 0.972510, loss_d: 0.323710
0.6897 --- loss: 1.479291, loss_ss: 0.807145, loss_d: 0.672146
0.7280 --- loss: 1.746147, loss_ss: 1.254453, loss_d: 0.491695
0.7663 --- loss: 1.408494, loss_ss: 0.907694, loss_d: 0.500800
0.8046 --- loss: 1.679570, loss_ss: 1.186987, loss_d: 0.492583
0.8429 --- loss: 1.758441, loss_ss: 1.020190, loss_d: 0.738251
0.8812 --- loss: 1.647991, loss_ss: 0.947982, loss_d: 0.700010
0.9195 --- loss: 1.443814, loss_ss: 0.830623, loss_d: 0.613191
0.9579 --- loss: 1.334411, loss_ss: 0.842378, loss_d: 0.492033
0.9962 --- loss: 1.244156, loss_ss: 0.694854, loss_d: 0.549302
Epoch finished! Loss: 1.539784210920334
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.570770, loss_ss: 0.915020, loss_d: 0.655750
0.0383 --- loss: 1.461787, loss_ss: 0.752887, loss_d: 0.708900
0.0766 --- loss: 1.581059, loss_ss: 1.030321, loss_d: 0.550738
0.1149 --- loss: 1.563819, loss_ss: 0.840295, loss_d: 0.723523
0.1533 --- loss: 1.380707, loss_ss: 0.874399, loss_d: 0.506309
0.1916 --- loss: 1.265071, loss_ss: 0.813491, loss_d: 0.451580
0.2299 --- loss: 1.729449, loss_ss: 1.155968, loss_d: 0.573481
0.2682 --- loss: 1.459414, loss_ss: 0.741111, loss_d: 0.718302
0.3065 --- loss: 1.373250, loss_ss: 0.590583, loss_d: 0.782667
0.3448 --- loss: 1.160310, loss_ss: 0.804748, loss_d: 0.355562
0.3831 --- loss: 1.581123, loss_ss: 0.958295, loss_d: 0.622828
0.4215 --- loss: 1.557195, loss_ss: 1.033725, loss_d: 0.523470
0.4598 --- loss: 1.558492, loss_ss: 0.928890, loss_d: 0.629602
0.4981 --- loss: 1.294070, loss_ss: 0.760822, loss_d: 0.533248
0.5364 --- loss: 1.590629, loss_ss: 1.218277, loss_d: 0.372352
0.5747 --- loss: 1.527034, loss_ss: 1.105887, loss_d: 0.421147
0.6130 --- loss: 1.383315, loss_ss: 0.926122, loss_d: 0.457193
0.6513 --- loss: 1.506243, loss_ss: 1.220316, loss_d: 0.285927
0.6897 --- loss: 1.458279, loss_ss: 1.104489, loss_d: 0.353791
0.7280 --- loss: 1.434073, loss_ss: 0.962787, loss_d: 0.471286
0.7663 --- loss: 1.707665, loss_ss: 1.137121, loss_d: 0.570544
0.8046 --- loss: 2.055828, loss_ss: 1.234366, loss_d: 0.821462
0.8429 --- loss: 1.506570, loss_ss: 0.919454, loss_d: 0.587116
0.8812 --- loss: 1.993102, loss_ss: 1.114450, loss_d: 0.878653
0.9195 --- loss: 1.391858, loss_ss: 0.870891, loss_d: 0.520967
0.9579 --- loss: 1.417568, loss_ss: 0.929478, loss_d: 0.488090
0.9962 --- loss: 1.312090, loss_ss: 0.742828, loss_d: 0.569262
Epoch finished! Loss: 1.504459642446958
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.377736, loss_ss: 0.746559, loss_d: 0.631177
0.0383 --- loss: 1.279815, loss_ss: 0.743102, loss_d: 0.536713
0.0766 --- loss: 1.317988, loss_ss: 0.815414, loss_d: 0.502574
0.1149 --- loss: 1.422137, loss_ss: 0.777935, loss_d: 0.644202
0.1533 --- loss: 1.253068, loss_ss: 0.731944, loss_d: 0.521125
0.1916 --- loss: 1.474966, loss_ss: 0.969574, loss_d: 0.505392
0.2299 --- loss: 1.716378, loss_ss: 1.347624, loss_d: 0.368755
0.2682 --- loss: 1.496550, loss_ss: 0.858858, loss_d: 0.637692
0.3065 --- loss: 1.241937, loss_ss: 0.756550, loss_d: 0.485387
0.3448 --- loss: 1.145062, loss_ss: 0.788831, loss_d: 0.356232
0.3831 --- loss: 0.975516, loss_ss: 0.756878, loss_d: 0.218638
0.4215 --- loss: 0.872844, loss_ss: 0.679800, loss_d: 0.193044
0.4598 --- loss: 1.407277, loss_ss: 0.847952, loss_d: 0.559325
0.4981 --- loss: 1.048696, loss_ss: 0.724893, loss_d: 0.323803
0.5364 --- loss: 1.702020, loss_ss: 1.159670, loss_d: 0.542350
0.5747 --- loss: 1.384110, loss_ss: 0.912444, loss_d: 0.471667
0.6130 --- loss: 1.999428, loss_ss: 1.287327, loss_d: 0.712101
0.6513 --- loss: 1.721486, loss_ss: 1.002451, loss_d: 0.719035
0.6897 --- loss: 1.212738, loss_ss: 0.876577, loss_d: 0.336161
0.7280 --- loss: 1.261151, loss_ss: 1.048733, loss_d: 0.212418
0.7663 --- loss: 1.122816, loss_ss: 0.850324, loss_d: 0.272492
0.8046 --- loss: 1.181366, loss_ss: 0.730696, loss_d: 0.450671
0.8429 --- loss: 1.538559, loss_ss: 0.728488, loss_d: 0.810071
0.8812 --- loss: 1.591286, loss_ss: 0.845023, loss_d: 0.746263
0.9195 --- loss: 1.280825, loss_ss: 1.028274, loss_d: 0.252551
0.9579 --- loss: 1.215215, loss_ss: 0.748121, loss_d: 0.467095
0.9962 --- loss: 1.240131, loss_ss: 0.865921, loss_d: 0.374210
Epoch finished! Loss: 1.4048567593097687
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.902510, loss_ss: 1.425497, loss_d: 0.477013
0.0383 --- loss: 1.175135, loss_ss: 0.801857, loss_d: 0.373278
0.0766 --- loss: 1.282188, loss_ss: 0.869084, loss_d: 0.413104
0.1149 --- loss: 1.448244, loss_ss: 0.932160, loss_d: 0.516083
0.1533 --- loss: 1.935005, loss_ss: 0.994397, loss_d: 0.940608
0.1916 --- loss: 1.295762, loss_ss: 0.824312, loss_d: 0.471450
0.2299 --- loss: 1.061044, loss_ss: 0.772694, loss_d: 0.288350
0.2682 --- loss: 1.345831, loss_ss: 0.842897, loss_d: 0.502934
0.3065 --- loss: 1.149966, loss_ss: 0.782838, loss_d: 0.367128
0.3448 --- loss: 1.567002, loss_ss: 1.067494, loss_d: 0.499509
0.3831 --- loss: 1.348632, loss_ss: 0.962693, loss_d: 0.385938
0.4215 --- loss: 1.644648, loss_ss: 1.083760, loss_d: 0.560888
0.4598 --- loss: 1.042514, loss_ss: 0.813484, loss_d: 0.229031
0.4981 --- loss: 1.098031, loss_ss: 0.798702, loss_d: 0.299328
0.5364 --- loss: 1.566907, loss_ss: 0.824156, loss_d: 0.742751
0.5747 --- loss: 1.611680, loss_ss: 1.125058, loss_d: 0.486622
0.6130 --- loss: 1.126544, loss_ss: 0.863135, loss_d: 0.263409
0.6513 --- loss: 1.494477, loss_ss: 0.729472, loss_d: 0.765005
0.6897 --- loss: 1.660753, loss_ss: 0.609795, loss_d: 1.050958
0.7280 --- loss: 1.010128, loss_ss: 0.848422, loss_d: 0.161706
0.7663 --- loss: 1.709893, loss_ss: 0.937083, loss_d: 0.772810
0.8046 --- loss: 1.146977, loss_ss: 0.806808, loss_d: 0.340170
0.8429 --- loss: 0.836994, loss_ss: 0.693158, loss_d: 0.143837
0.8812 --- loss: 1.477028, loss_ss: 1.132621, loss_d: 0.344407
0.9195 --- loss: 1.433373, loss_ss: 0.682818, loss_d: 0.750555
0.9579 --- loss: 0.930290, loss_ss: 0.688550, loss_d: 0.241739
0.9962 --- loss: 0.698156, loss_ss: 0.515271, loss_d: 0.182886
Epoch finished! Loss: 1.3446567017298479
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.919535, loss_ss: 0.579389, loss_d: 0.340147
0.0383 --- loss: 1.489104, loss_ss: 1.041088, loss_d: 0.448016
0.0766 --- loss: 1.076568, loss_ss: 0.827914, loss_d: 0.248655
0.1149 --- loss: 1.127712, loss_ss: 0.781769, loss_d: 0.345943
0.1533 --- loss: 1.555112, loss_ss: 1.093971, loss_d: 0.461141
0.1916 --- loss: 1.549543, loss_ss: 1.159578, loss_d: 0.389965
0.2299 --- loss: 1.304086, loss_ss: 1.019618, loss_d: 0.284467
0.2682 --- loss: 1.295852, loss_ss: 0.885637, loss_d: 0.410214
0.3065 --- loss: 1.544806, loss_ss: 0.885607, loss_d: 0.659199
0.3448 --- loss: 1.467829, loss_ss: 1.006388, loss_d: 0.461441
0.3831 --- loss: 1.951717, loss_ss: 0.947747, loss_d: 1.003971
0.4215 --- loss: 1.305169, loss_ss: 0.804305, loss_d: 0.500864
0.4598 --- loss: 1.679828, loss_ss: 1.319062, loss_d: 0.360766
0.4981 --- loss: 1.460824, loss_ss: 0.910116, loss_d: 0.550708
0.5364 --- loss: 1.211990, loss_ss: 0.965801, loss_d: 0.246190
0.5747 --- loss: 1.899860, loss_ss: 0.970926, loss_d: 0.928934
0.6130 --- loss: 1.416753, loss_ss: 0.884215, loss_d: 0.532538
0.6513 --- loss: 1.170518, loss_ss: 0.938776, loss_d: 0.231742
0.6897 --- loss: 1.351457, loss_ss: 0.829769, loss_d: 0.521689
0.7280 --- loss: 1.131155, loss_ss: 0.837257, loss_d: 0.293897
0.7663 --- loss: 1.224944, loss_ss: 0.857166, loss_d: 0.367778
0.8046 --- loss: 1.101341, loss_ss: 0.796728, loss_d: 0.304613
0.8429 --- loss: 1.069480, loss_ss: 0.806202, loss_d: 0.263278
0.8812 --- loss: 1.277950, loss_ss: 0.875036, loss_d: 0.402914
0.9195 --- loss: 1.148442, loss_ss: 0.809608, loss_d: 0.338834
0.9579 --- loss: 1.547603, loss_ss: 1.044560, loss_d: 0.503043
0.9962 --- loss: 1.314269, loss_ss: 0.771672, loss_d: 0.542596
Epoch finished! Loss: 1.3032223676259702
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.679394, loss_ss: 1.116989, loss_d: 0.562404
0.0383 --- loss: 1.305333, loss_ss: 0.960863, loss_d: 0.344470
0.0766 --- loss: 1.553176, loss_ss: 0.988657, loss_d: 0.564519
0.1149 --- loss: 1.231573, loss_ss: 0.909118, loss_d: 0.322454
0.1533 --- loss: 1.091629, loss_ss: 0.730494, loss_d: 0.361135
0.1916 --- loss: 1.043609, loss_ss: 0.791182, loss_d: 0.252427
0.2299 --- loss: 1.255835, loss_ss: 0.983157, loss_d: 0.272678
0.2682 --- loss: 1.127669, loss_ss: 0.928600, loss_d: 0.199069
0.3065 --- loss: 1.526261, loss_ss: 0.884787, loss_d: 0.641475
0.3448 --- loss: 1.330561, loss_ss: 1.112612, loss_d: 0.217950
0.3831 --- loss: 1.439405, loss_ss: 0.796684, loss_d: 0.642722
0.4215 --- loss: 1.335891, loss_ss: 1.162979, loss_d: 0.172912
0.4598 --- loss: 1.473057, loss_ss: 0.930222, loss_d: 0.542835
0.4981 --- loss: 1.579479, loss_ss: 1.059252, loss_d: 0.520228
0.5364 --- loss: 1.110830, loss_ss: 0.866185, loss_d: 0.244645
0.5747 --- loss: 0.957426, loss_ss: 0.764491, loss_d: 0.192935
0.6130 --- loss: 1.305696, loss_ss: 0.788746, loss_d: 0.516950
0.6513 --- loss: 1.470938, loss_ss: 1.193662, loss_d: 0.277276
0.6897 --- loss: 0.834219, loss_ss: 0.618915, loss_d: 0.215304
0.7280 --- loss: 0.965613, loss_ss: 0.794271, loss_d: 0.171342
0.7663 --- loss: 1.054546, loss_ss: 0.787770, loss_d: 0.266775
0.8046 --- loss: 1.018561, loss_ss: 0.635276, loss_d: 0.383285
0.8429 --- loss: 1.338953, loss_ss: 0.973642, loss_d: 0.365311
0.8812 --- loss: 1.092982, loss_ss: 0.763062, loss_d: 0.329920
0.9195 --- loss: 0.900188, loss_ss: 0.685431, loss_d: 0.214757
0.9579 --- loss: 1.316593, loss_ss: 0.955485, loss_d: 0.361108
0.9962 --- loss: 0.960050, loss_ss: 0.740807, loss_d: 0.219243
Epoch finished! Loss: 1.2359715736829318
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.288911, loss_ss: 0.716345, loss_d: 0.572566
0.0383 --- loss: 1.390450, loss_ss: 0.896379, loss_d: 0.494071
0.0766 --- loss: 1.041055, loss_ss: 0.870310, loss_d: 0.170745
0.1149 --- loss: 1.545795, loss_ss: 1.182685, loss_d: 0.363111
0.1533 --- loss: 1.139446, loss_ss: 0.744090, loss_d: 0.395357
0.1916 --- loss: 0.972081, loss_ss: 0.693226, loss_d: 0.278855
0.2299 --- loss: 1.035420, loss_ss: 0.913533, loss_d: 0.121886
0.2682 --- loss: 1.583220, loss_ss: 0.872152, loss_d: 0.711068
0.3065 --- loss: 1.318526, loss_ss: 1.020169, loss_d: 0.298357
0.3448 --- loss: 1.431540, loss_ss: 0.928423, loss_d: 0.503116
0.3831 --- loss: 1.054489, loss_ss: 0.827071, loss_d: 0.227418
0.4215 --- loss: 1.160035, loss_ss: 0.992048, loss_d: 0.167988
0.4598 --- loss: 1.342263, loss_ss: 0.805138, loss_d: 0.537125
0.4981 --- loss: 0.968524, loss_ss: 0.770184, loss_d: 0.198340
0.5364 --- loss: 1.214767, loss_ss: 0.929876, loss_d: 0.284890
0.5747 --- loss: 1.000348, loss_ss: 0.766882, loss_d: 0.233466
0.6130 --- loss: 1.281741, loss_ss: 1.058219, loss_d: 0.223522
0.6513 --- loss: 0.877903, loss_ss: 0.708367, loss_d: 0.169535
0.6897 --- loss: 1.498824, loss_ss: 0.861209, loss_d: 0.637615
0.7280 --- loss: 1.179329, loss_ss: 0.984643, loss_d: 0.194686
0.7663 --- loss: 0.987223, loss_ss: 0.683109, loss_d: 0.304114
0.8046 --- loss: 1.608202, loss_ss: 0.757102, loss_d: 0.851100
0.8429 --- loss: 0.948262, loss_ss: 0.730041, loss_d: 0.218222
0.8812 --- loss: 1.099408, loss_ss: 0.656227, loss_d: 0.443181
0.9195 --- loss: 1.523299, loss_ss: 1.162789, loss_d: 0.360509
0.9579 --- loss: 1.128031, loss_ss: 0.874425, loss_d: 0.253606
0.9962 --- loss: 1.512310, loss_ss: 0.934242, loss_d: 0.578068
Epoch finished! Loss: 1.2236664907290384
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.430346, loss_ss: 0.924112, loss_d: 0.506235
0.0383 --- loss: 1.113198, loss_ss: 0.859834, loss_d: 0.253364
0.0766 --- loss: 1.611727, loss_ss: 1.045257, loss_d: 0.566471
0.1149 --- loss: 1.149400, loss_ss: 0.795284, loss_d: 0.354116
0.1533 --- loss: 0.999476, loss_ss: 0.813632, loss_d: 0.185844
0.1916 --- loss: 1.597557, loss_ss: 0.930516, loss_d: 0.667041
0.2299 --- loss: 1.358114, loss_ss: 1.150197, loss_d: 0.207917
0.2682 --- loss: 1.500749, loss_ss: 1.390175, loss_d: 0.110574
0.3065 --- loss: 1.151894, loss_ss: 0.857718, loss_d: 0.294175
0.3448 --- loss: 0.951413, loss_ss: 0.662495, loss_d: 0.288919
0.3831 --- loss: 1.126630, loss_ss: 0.968486, loss_d: 0.158145
0.4215 --- loss: 1.338884, loss_ss: 0.953334, loss_d: 0.385550
0.4598 --- loss: 1.416724, loss_ss: 1.016826, loss_d: 0.399898
0.4981 --- loss: 1.249120, loss_ss: 0.960236, loss_d: 0.288883
0.5364 --- loss: 0.889892, loss_ss: 0.670786, loss_d: 0.219105
0.5747 --- loss: 1.425423, loss_ss: 0.816507, loss_d: 0.608916
0.6130 --- loss: 1.110032, loss_ss: 0.953856, loss_d: 0.156176
0.6513 --- loss: 1.038915, loss_ss: 0.843627, loss_d: 0.195288
0.6897 --- loss: 1.185146, loss_ss: 0.790273, loss_d: 0.394873
0.7280 --- loss: 1.073248, loss_ss: 0.745432, loss_d: 0.327816
0.7663 --- loss: 0.853494, loss_ss: 0.665611, loss_d: 0.187882
0.8046 --- loss: 1.189120, loss_ss: 1.011857, loss_d: 0.177263
0.8429 --- loss: 0.942256, loss_ss: 0.673615, loss_d: 0.268641
0.8812 --- loss: 1.186410, loss_ss: 0.888995, loss_d: 0.297415
0.9195 --- loss: 1.059140, loss_ss: 0.659471, loss_d: 0.399669
0.9579 --- loss: 1.668847, loss_ss: 1.032406, loss_d: 0.636441
0.9962 --- loss: 0.938290, loss_ss: 0.735896, loss_d: 0.202393
Epoch finished! Loss: 1.1981137218383642
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7476190476190476
             precision    recall  f1-score   support

        0.0       0.52      0.68      0.59        56
        1.0       0.29      0.16      0.20        38
        2.0       0.75      0.92      0.82       416
        3.0       1.00      0.54      0.70       188
        4.0       0.76      0.70      0.73       142

avg / total       0.77      0.75      0.74       840
 


====== chc041-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.69  67.86   95.54   52.05     58.91
1  94.40  15.79   98.13   28.57     20.34
2  80.48  92.07   69.10   74.51     82.37
3  89.76  54.26  100.00  100.00     70.34
4  91.19  69.72   95.56   76.15     72.79
Total accuracy: 74.76%
Average sen: 59.94%
Average spec: 91.67%
Macro f1-score: 60.95%
Diagnosis acc on 15mins: 0.14285714285714285
[0.70028138 0.44586957 0.98474556 0.99818927 0.47092015 0.75997871
 0.94536144 0.97392976 0.9867034  0.95888251 0.54557037 0.99588108
 0.94260418 0.98324424 0.97531384 0.9953739  0.97457236 0.89653516
 0.99919242 0.99632484 0.9711473  0.99764711 0.9766717  0.86605155
 0.14336656 0.58247161 0.94220632 0.12777954]
pred: 0.8263148511094707, label: 0
Wrong!!! Real Diagnosis: Other

=== Test on chc052-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.528735, loss_ss: 1.812962, loss_d: 0.715772
0.0383 --- loss: 2.154817, loss_ss: 1.631825, loss_d: 0.522992
0.0767 --- loss: 2.277729, loss_ss: 1.794170, loss_d: 0.483558
0.1150 --- loss: 2.527800, loss_ss: 1.731117, loss_d: 0.796684
0.1534 --- loss: 1.923412, loss_ss: 1.617206, loss_d: 0.306206
0.1917 --- loss: 2.037914, loss_ss: 1.531414, loss_d: 0.506500
0.2301 --- loss: 2.214335, loss_ss: 1.546017, loss_d: 0.668319
0.2684 --- loss: 2.008192, loss_ss: 1.714427, loss_d: 0.293765
0.3067 --- loss: 1.694817, loss_ss: 1.312369, loss_d: 0.382448
0.3451 --- loss: 2.005236, loss_ss: 1.422430, loss_d: 0.582807
0.3834 --- loss: 2.009684, loss_ss: 1.404446, loss_d: 0.605237
0.4218 --- loss: 1.909763, loss_ss: 1.316207, loss_d: 0.593557
0.4601 --- loss: 1.833357, loss_ss: 1.347245, loss_d: 0.486112
0.4985 --- loss: 2.352805, loss_ss: 1.500286, loss_d: 0.852520
0.5368 --- loss: 2.134204, loss_ss: 1.500965, loss_d: 0.633239
0.5752 --- loss: 1.665267, loss_ss: 1.266356, loss_d: 0.398911
0.6135 --- loss: 1.788054, loss_ss: 1.313595, loss_d: 0.474459
0.6518 --- loss: 1.951780, loss_ss: 1.205145, loss_d: 0.746635
0.6902 --- loss: 1.825103, loss_ss: 1.285585, loss_d: 0.539518
0.7285 --- loss: 1.921572, loss_ss: 1.410550, loss_d: 0.511022
0.7669 --- loss: 1.697904, loss_ss: 1.271020, loss_d: 0.426884
0.8052 --- loss: 1.857732, loss_ss: 1.367563, loss_d: 0.490169
0.8436 --- loss: 2.016111, loss_ss: 1.148456, loss_d: 0.867655
0.8819 --- loss: 1.827866, loss_ss: 1.232142, loss_d: 0.595724
0.9202 --- loss: 1.675968, loss_ss: 1.243454, loss_d: 0.432514
0.9586 --- loss: 1.661606, loss_ss: 1.292848, loss_d: 0.368758
0.9969 --- loss: 2.156654, loss_ss: 1.230896, loss_d: 0.925759
Epoch finished! Loss: 1.9897054786865527
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.762446, loss_ss: 1.164550, loss_d: 0.597896
0.0383 --- loss: 1.727752, loss_ss: 1.140140, loss_d: 0.587612
0.0767 --- loss: 1.634357, loss_ss: 1.184308, loss_d: 0.450049
0.1150 --- loss: 2.029000, loss_ss: 1.187616, loss_d: 0.841385
0.1534 --- loss: 1.641699, loss_ss: 1.034013, loss_d: 0.607686
0.1917 --- loss: 1.726260, loss_ss: 1.014693, loss_d: 0.711566
0.2301 --- loss: 1.606426, loss_ss: 1.139752, loss_d: 0.466674
0.2684 --- loss: 1.573812, loss_ss: 1.161851, loss_d: 0.411960
0.3067 --- loss: 1.685036, loss_ss: 1.179906, loss_d: 0.505131
0.3451 --- loss: 2.010942, loss_ss: 1.482995, loss_d: 0.527947
0.3834 --- loss: 1.432990, loss_ss: 1.022334, loss_d: 0.410656
0.4218 --- loss: 1.806081, loss_ss: 1.174354, loss_d: 0.631728
0.4601 --- loss: 1.819673, loss_ss: 1.194905, loss_d: 0.624768
0.4985 --- loss: 1.439759, loss_ss: 0.974738, loss_d: 0.465021
0.5368 --- loss: 1.629681, loss_ss: 1.043846, loss_d: 0.585835
0.5752 --- loss: 1.513283, loss_ss: 1.167859, loss_d: 0.345424
0.6135 --- loss: 1.373952, loss_ss: 0.932970, loss_d: 0.440983
0.6518 --- loss: 1.756190, loss_ss: 1.173426, loss_d: 0.582764
0.6902 --- loss: 1.504182, loss_ss: 1.029592, loss_d: 0.474590
0.7285 --- loss: 1.927910, loss_ss: 1.076533, loss_d: 0.851377
0.7669 --- loss: 1.903337, loss_ss: 1.221197, loss_d: 0.682141
0.8052 --- loss: 1.626777, loss_ss: 1.020332, loss_d: 0.606445
0.8436 --- loss: 1.659049, loss_ss: 1.049325, loss_d: 0.609724
0.8819 --- loss: 1.523541, loss_ss: 0.970056, loss_d: 0.553485
0.9202 --- loss: 1.806818, loss_ss: 1.045533, loss_d: 0.761285
0.9586 --- loss: 1.618774, loss_ss: 1.039242, loss_d: 0.579532
0.9969 --- loss: 1.740185, loss_ss: 1.138519, loss_d: 0.601666
Epoch finished! Loss: 1.6715563003833478
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.423913, loss_ss: 1.059570, loss_d: 0.364343
0.0383 --- loss: 1.586381, loss_ss: 1.015127, loss_d: 0.571254
0.0767 --- loss: 1.494479, loss_ss: 0.992418, loss_d: 0.502061
0.1150 --- loss: 2.085748, loss_ss: 1.363056, loss_d: 0.722692
0.1534 --- loss: 1.749936, loss_ss: 1.167144, loss_d: 0.582792
0.1917 --- loss: 1.507559, loss_ss: 0.894489, loss_d: 0.613069
0.2301 --- loss: 1.553150, loss_ss: 0.901776, loss_d: 0.651374
0.2684 --- loss: 1.572737, loss_ss: 0.989258, loss_d: 0.583479
0.3067 --- loss: 1.360170, loss_ss: 0.948931, loss_d: 0.411239
0.3451 --- loss: 1.564994, loss_ss: 1.077348, loss_d: 0.487646
0.3834 --- loss: 2.228332, loss_ss: 1.335787, loss_d: 0.892545
0.4218 --- loss: 1.381710, loss_ss: 0.743634, loss_d: 0.638076
0.4601 --- loss: 1.253180, loss_ss: 0.852659, loss_d: 0.400522
0.4985 --- loss: 1.565237, loss_ss: 0.897214, loss_d: 0.668023
0.5368 --- loss: 1.476099, loss_ss: 1.024054, loss_d: 0.452045
0.5752 --- loss: 1.645356, loss_ss: 1.263842, loss_d: 0.381514
0.6135 --- loss: 1.297269, loss_ss: 0.927011, loss_d: 0.370257
0.6518 --- loss: 1.346441, loss_ss: 0.862676, loss_d: 0.483765
0.6902 --- loss: 1.712031, loss_ss: 0.913570, loss_d: 0.798462
0.7285 --- loss: 1.470703, loss_ss: 1.066764, loss_d: 0.403939
0.7669 --- loss: 1.805678, loss_ss: 1.220910, loss_d: 0.584767
0.8052 --- loss: 1.345293, loss_ss: 0.646115, loss_d: 0.699178
0.8436 --- loss: 1.519796, loss_ss: 1.108230, loss_d: 0.411566
0.8819 --- loss: 1.672487, loss_ss: 0.837989, loss_d: 0.834498
0.9202 --- loss: 1.258893, loss_ss: 0.828165, loss_d: 0.430729
0.9586 --- loss: 1.738801, loss_ss: 1.131680, loss_d: 0.607121
0.9969 --- loss: 1.695152, loss_ss: 1.175285, loss_d: 0.519867
Epoch finished! Loss: 1.5729521558834956
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.170765, loss_ss: 0.803318, loss_d: 0.367447
0.0383 --- loss: 1.206832, loss_ss: 0.912060, loss_d: 0.294772
0.0767 --- loss: 1.359252, loss_ss: 0.875972, loss_d: 0.483280
0.1150 --- loss: 1.630888, loss_ss: 1.256245, loss_d: 0.374643
0.1534 --- loss: 1.651815, loss_ss: 0.927480, loss_d: 0.724335
0.1917 --- loss: 1.304716, loss_ss: 0.974975, loss_d: 0.329741
0.2301 --- loss: 1.698828, loss_ss: 0.837922, loss_d: 0.860906
0.2684 --- loss: 1.405865, loss_ss: 0.799898, loss_d: 0.605968
0.3067 --- loss: 1.779449, loss_ss: 1.114595, loss_d: 0.664854
0.3451 --- loss: 1.637632, loss_ss: 1.252064, loss_d: 0.385568
0.3834 --- loss: 1.709238, loss_ss: 0.970290, loss_d: 0.738948
0.4218 --- loss: 1.370056, loss_ss: 0.883277, loss_d: 0.486779
0.4601 --- loss: 1.581430, loss_ss: 0.889878, loss_d: 0.691552
0.4985 --- loss: 1.169727, loss_ss: 0.773286, loss_d: 0.396440
0.5368 --- loss: 1.489367, loss_ss: 0.997423, loss_d: 0.491945
0.5752 --- loss: 2.147411, loss_ss: 1.041368, loss_d: 1.106043
0.6135 --- loss: 1.456272, loss_ss: 1.133601, loss_d: 0.322671
0.6518 --- loss: 1.341168, loss_ss: 1.003939, loss_d: 0.337229
0.6902 --- loss: 1.421222, loss_ss: 0.898435, loss_d: 0.522787
0.7285 --- loss: 1.142414, loss_ss: 0.753151, loss_d: 0.389263
0.7669 --- loss: 1.167145, loss_ss: 0.884846, loss_d: 0.282299
0.8052 --- loss: 1.828200, loss_ss: 1.051806, loss_d: 0.776394
0.8436 --- loss: 1.286664, loss_ss: 0.872843, loss_d: 0.413821
0.8819 --- loss: 1.622987, loss_ss: 0.674905, loss_d: 0.948082
0.9202 --- loss: 1.443030, loss_ss: 0.896590, loss_d: 0.546439
0.9586 --- loss: 1.206000, loss_ss: 0.834875, loss_d: 0.371125
0.9969 --- loss: 1.782623, loss_ss: 1.017227, loss_d: 0.765396
Epoch finished! Loss: 1.511256341292308
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.397382, loss_ss: 0.713878, loss_d: 0.683504
0.0383 --- loss: 1.011886, loss_ss: 0.687721, loss_d: 0.324164
0.0767 --- loss: 1.295757, loss_ss: 0.990702, loss_d: 0.305055
0.1150 --- loss: 1.584956, loss_ss: 1.224918, loss_d: 0.360038
0.1534 --- loss: 1.388749, loss_ss: 1.038641, loss_d: 0.350108
0.1917 --- loss: 1.644313, loss_ss: 0.918891, loss_d: 0.725422
0.2301 --- loss: 1.455444, loss_ss: 1.002172, loss_d: 0.453272
0.2684 --- loss: 1.650616, loss_ss: 0.832810, loss_d: 0.817807
0.3067 --- loss: 1.374060, loss_ss: 0.985126, loss_d: 0.388935
0.3451 --- loss: 1.697213, loss_ss: 0.991590, loss_d: 0.705623
0.3834 --- loss: 1.323911, loss_ss: 1.004076, loss_d: 0.319836
0.4218 --- loss: 1.679220, loss_ss: 1.167803, loss_d: 0.511417
0.4601 --- loss: 1.217836, loss_ss: 0.817102, loss_d: 0.400733
0.4985 --- loss: 1.466847, loss_ss: 1.144635, loss_d: 0.322213
0.5368 --- loss: 1.511249, loss_ss: 1.035834, loss_d: 0.475416
0.5752 --- loss: 1.507636, loss_ss: 0.772026, loss_d: 0.735610
0.6135 --- loss: 1.175765, loss_ss: 0.693433, loss_d: 0.482332
0.6518 --- loss: 1.480330, loss_ss: 1.117961, loss_d: 0.362370
0.6902 --- loss: 1.187349, loss_ss: 0.846886, loss_d: 0.340463
0.7285 --- loss: 1.249637, loss_ss: 0.972159, loss_d: 0.277478
0.7669 --- loss: 1.463563, loss_ss: 1.020171, loss_d: 0.443392
0.8052 --- loss: 1.312142, loss_ss: 0.812427, loss_d: 0.499716
0.8436 --- loss: 1.323708, loss_ss: 0.992215, loss_d: 0.331493
0.8819 --- loss: 1.242610, loss_ss: 0.919143, loss_d: 0.323467
0.9202 --- loss: 0.839290, loss_ss: 0.569063, loss_d: 0.270227
0.9586 --- loss: 1.573079, loss_ss: 0.898962, loss_d: 0.674116
0.9969 --- loss: 1.493348, loss_ss: 1.278909, loss_d: 0.214439
Epoch finished! Loss: 1.4315168623740857
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.661529, loss_ss: 0.936171, loss_d: 0.725358
0.0383 --- loss: 1.112956, loss_ss: 0.812538, loss_d: 0.300418
0.0767 --- loss: 1.280518, loss_ss: 0.854693, loss_d: 0.425825
0.1150 --- loss: 1.350603, loss_ss: 0.686003, loss_d: 0.664600
0.1534 --- loss: 1.257642, loss_ss: 0.910248, loss_d: 0.347394
0.1917 --- loss: 1.028426, loss_ss: 0.755897, loss_d: 0.272529
0.2301 --- loss: 0.981543, loss_ss: 0.634546, loss_d: 0.346997
0.2684 --- loss: 1.277285, loss_ss: 0.717962, loss_d: 0.559323
0.3067 --- loss: 1.697015, loss_ss: 1.025818, loss_d: 0.671197
0.3451 --- loss: 1.355240, loss_ss: 0.816864, loss_d: 0.538376
0.3834 --- loss: 1.255711, loss_ss: 0.709200, loss_d: 0.546510
0.4218 --- loss: 1.637303, loss_ss: 1.235790, loss_d: 0.401513
0.4601 --- loss: 1.175291, loss_ss: 0.900458, loss_d: 0.274833
0.4985 --- loss: 1.439801, loss_ss: 0.917048, loss_d: 0.522753
0.5368 --- loss: 1.424551, loss_ss: 0.972456, loss_d: 0.452094
0.5752 --- loss: 1.155671, loss_ss: 0.888659, loss_d: 0.267013
0.6135 --- loss: 1.278714, loss_ss: 0.907542, loss_d: 0.371172
0.6518 --- loss: 1.230540, loss_ss: 0.963182, loss_d: 0.267357
0.6902 --- loss: 1.199796, loss_ss: 0.858882, loss_d: 0.340914
0.7285 --- loss: 1.717210, loss_ss: 1.189746, loss_d: 0.527464
0.7669 --- loss: 1.279866, loss_ss: 0.821623, loss_d: 0.458243
0.8052 --- loss: 1.809306, loss_ss: 1.389318, loss_d: 0.419988
0.8436 --- loss: 1.778514, loss_ss: 1.428221, loss_d: 0.350293
0.8819 --- loss: 1.566928, loss_ss: 0.643497, loss_d: 0.923431
0.9202 --- loss: 1.580882, loss_ss: 1.037155, loss_d: 0.543728
0.9586 --- loss: 1.534125, loss_ss: 1.015001, loss_d: 0.519124
0.9969 --- loss: 1.518570, loss_ss: 0.902354, loss_d: 0.616216
Epoch finished! Loss: 1.3925773391356835
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.250166, loss_ss: 0.951665, loss_d: 0.298500
0.0383 --- loss: 1.053278, loss_ss: 0.822134, loss_d: 0.231144
0.0767 --- loss: 1.505354, loss_ss: 0.882169, loss_d: 0.623184
0.1150 --- loss: 1.753267, loss_ss: 0.978453, loss_d: 0.774814
0.1534 --- loss: 1.079287, loss_ss: 0.771962, loss_d: 0.307325
0.1917 --- loss: 0.922580, loss_ss: 0.689225, loss_d: 0.233356
0.2301 --- loss: 1.162957, loss_ss: 0.965287, loss_d: 0.197670
0.2684 --- loss: 1.370678, loss_ss: 1.031098, loss_d: 0.339580
0.3067 --- loss: 1.281555, loss_ss: 1.010233, loss_d: 0.271322
0.3451 --- loss: 1.926300, loss_ss: 1.221273, loss_d: 0.705027
0.3834 --- loss: 1.359528, loss_ss: 0.964083, loss_d: 0.395446
0.4218 --- loss: 1.148696, loss_ss: 0.786814, loss_d: 0.361882
0.4601 --- loss: 1.546027, loss_ss: 0.932929, loss_d: 0.613099
0.4985 --- loss: 2.371299, loss_ss: 1.388363, loss_d: 0.982936
0.5368 --- loss: 1.185176, loss_ss: 0.879710, loss_d: 0.305465
0.5752 --- loss: 1.062267, loss_ss: 0.765652, loss_d: 0.296615
0.6135 --- loss: 0.913064, loss_ss: 0.662632, loss_d: 0.250431
0.6518 --- loss: 1.402488, loss_ss: 0.939908, loss_d: 0.462580
0.6902 --- loss: 0.910088, loss_ss: 0.477444, loss_d: 0.432643
0.7285 --- loss: 1.134536, loss_ss: 0.654225, loss_d: 0.480311
0.7669 --- loss: 1.129978, loss_ss: 0.808976, loss_d: 0.321002
0.8052 --- loss: 1.389357, loss_ss: 0.842351, loss_d: 0.547005
0.8436 --- loss: 1.470727, loss_ss: 0.923025, loss_d: 0.547702
0.8819 --- loss: 1.539022, loss_ss: 0.944894, loss_d: 0.594128
0.9202 --- loss: 1.499025, loss_ss: 1.277030, loss_d: 0.221995
0.9586 --- loss: 0.811381, loss_ss: 0.565857, loss_d: 0.245524
0.9969 --- loss: 1.841933, loss_ss: 0.976505, loss_d: 0.865427
Epoch finished! Loss: 1.3284726220827836
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.577598, loss_ss: 0.966525, loss_d: 0.611074
0.0383 --- loss: 1.504701, loss_ss: 1.050012, loss_d: 0.454688
0.0767 --- loss: 1.186335, loss_ss: 0.892089, loss_d: 0.294246
0.1150 --- loss: 1.383874, loss_ss: 0.727266, loss_d: 0.656608
0.1534 --- loss: 1.430634, loss_ss: 0.919699, loss_d: 0.510936
0.1917 --- loss: 1.254783, loss_ss: 0.914580, loss_d: 0.340203
0.2301 --- loss: 1.368693, loss_ss: 0.913123, loss_d: 0.455571
0.2684 --- loss: 1.050056, loss_ss: 0.671651, loss_d: 0.378405
0.3067 --- loss: 1.331945, loss_ss: 0.944015, loss_d: 0.387930
0.3451 --- loss: 0.978903, loss_ss: 0.734947, loss_d: 0.243955
0.3834 --- loss: 1.408368, loss_ss: 1.133269, loss_d: 0.275098
0.4218 --- loss: 0.924568, loss_ss: 0.663771, loss_d: 0.260797
0.4601 --- loss: 0.972600, loss_ss: 0.629221, loss_d: 0.343379
0.4985 --- loss: 1.459225, loss_ss: 0.911270, loss_d: 0.547955
0.5368 --- loss: 1.015733, loss_ss: 0.633663, loss_d: 0.382070
0.5752 --- loss: 1.229581, loss_ss: 0.892923, loss_d: 0.336657
0.6135 --- loss: 1.345698, loss_ss: 0.857490, loss_d: 0.488208
0.6518 --- loss: 1.281146, loss_ss: 0.996557, loss_d: 0.284589
0.6902 --- loss: 1.386145, loss_ss: 1.180966, loss_d: 0.205179
0.7285 --- loss: 1.042565, loss_ss: 0.821442, loss_d: 0.221123
0.7669 --- loss: 1.377092, loss_ss: 1.156916, loss_d: 0.220176
0.8052 --- loss: 1.031675, loss_ss: 0.758304, loss_d: 0.273372
0.8436 --- loss: 1.361814, loss_ss: 1.032221, loss_d: 0.329593
0.8819 --- loss: 1.002025, loss_ss: 0.698466, loss_d: 0.303559
0.9202 --- loss: 1.479990, loss_ss: 0.973494, loss_d: 0.506497
0.9586 --- loss: 0.913802, loss_ss: 0.624188, loss_d: 0.289613
0.9969 --- loss: 2.007668, loss_ss: 1.015923, loss_d: 0.991745
Epoch finished! Loss: 1.2719904633668753
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.187352, loss_ss: 0.920283, loss_d: 0.267069
0.0383 --- loss: 1.072039, loss_ss: 0.671818, loss_d: 0.400221
0.0767 --- loss: 1.262809, loss_ss: 0.904921, loss_d: 0.357888
0.1150 --- loss: 1.261239, loss_ss: 0.976343, loss_d: 0.284896
0.1534 --- loss: 1.313316, loss_ss: 1.014018, loss_d: 0.299298
0.1917 --- loss: 1.059682, loss_ss: 0.820560, loss_d: 0.239122
0.2301 --- loss: 1.037311, loss_ss: 0.844410, loss_d: 0.192902
0.2684 --- loss: 1.431427, loss_ss: 0.575431, loss_d: 0.855996
0.3067 --- loss: 1.389657, loss_ss: 0.743334, loss_d: 0.646323
0.3451 --- loss: 1.089356, loss_ss: 0.756469, loss_d: 0.332887
0.3834 --- loss: 0.963211, loss_ss: 0.716612, loss_d: 0.246599
0.4218 --- loss: 1.372348, loss_ss: 0.889723, loss_d: 0.482625
0.4601 --- loss: 1.374464, loss_ss: 1.088153, loss_d: 0.286312
0.4985 --- loss: 1.110268, loss_ss: 0.878614, loss_d: 0.231654
0.5368 --- loss: 1.669435, loss_ss: 1.002034, loss_d: 0.667401
0.5752 --- loss: 1.260898, loss_ss: 0.962204, loss_d: 0.298693
0.6135 --- loss: 1.115655, loss_ss: 0.926897, loss_d: 0.188758
0.6518 --- loss: 0.982324, loss_ss: 0.652407, loss_d: 0.329917
0.6902 --- loss: 0.909900, loss_ss: 0.708703, loss_d: 0.201197
0.7285 --- loss: 1.464200, loss_ss: 1.120621, loss_d: 0.343578
0.7669 --- loss: 1.387602, loss_ss: 0.798753, loss_d: 0.588850
0.8052 --- loss: 1.043704, loss_ss: 0.765563, loss_d: 0.278141
0.8436 --- loss: 1.234968, loss_ss: 0.992816, loss_d: 0.242152
0.8819 --- loss: 1.169679, loss_ss: 0.889239, loss_d: 0.280440
0.9202 --- loss: 1.566086, loss_ss: 1.230967, loss_d: 0.335119
0.9586 --- loss: 1.029733, loss_ss: 0.784823, loss_d: 0.244910
0.9969 --- loss: 1.406382, loss_ss: 1.068780, loss_d: 0.337602
Epoch finished! Loss: 1.2349785674076814
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.159856, loss_ss: 0.624667, loss_d: 0.535189
0.0383 --- loss: 0.756422, loss_ss: 0.534037, loss_d: 0.222386
0.0767 --- loss: 0.911489, loss_ss: 0.546907, loss_d: 0.364582
0.1150 --- loss: 0.973661, loss_ss: 0.662002, loss_d: 0.311658
0.1534 --- loss: 1.606812, loss_ss: 0.807406, loss_d: 0.799406
0.1917 --- loss: 0.922204, loss_ss: 0.658847, loss_d: 0.263358
0.2301 --- loss: 1.135449, loss_ss: 0.876213, loss_d: 0.259236
0.2684 --- loss: 1.171051, loss_ss: 0.855698, loss_d: 0.315353
0.3067 --- loss: 1.586295, loss_ss: 0.828232, loss_d: 0.758063
0.3451 --- loss: 1.263291, loss_ss: 0.908878, loss_d: 0.354412
0.3834 --- loss: 1.110781, loss_ss: 0.874896, loss_d: 0.235885
0.4218 --- loss: 1.662466, loss_ss: 0.933601, loss_d: 0.728865
0.4601 --- loss: 1.051072, loss_ss: 0.822333, loss_d: 0.228738
0.4985 --- loss: 1.399094, loss_ss: 1.107273, loss_d: 0.291821
0.5368 --- loss: 1.079028, loss_ss: 0.741860, loss_d: 0.337168
0.5752 --- loss: 1.182835, loss_ss: 0.860694, loss_d: 0.322141
0.6135 --- loss: 1.052709, loss_ss: 0.701610, loss_d: 0.351098
0.6518 --- loss: 1.110614, loss_ss: 0.666701, loss_d: 0.443913
0.6902 --- loss: 0.920377, loss_ss: 0.686296, loss_d: 0.234081
0.7285 --- loss: 1.765565, loss_ss: 1.506334, loss_d: 0.259232
0.7669 --- loss: 1.162112, loss_ss: 0.874321, loss_d: 0.287791
0.8052 --- loss: 1.405429, loss_ss: 1.048582, loss_d: 0.356847
0.8436 --- loss: 0.972133, loss_ss: 0.737069, loss_d: 0.235064
0.8819 --- loss: 1.040909, loss_ss: 0.779216, loss_d: 0.261693
0.9202 --- loss: 1.110844, loss_ss: 0.769009, loss_d: 0.341835
0.9586 --- loss: 1.251331, loss_ss: 1.027002, loss_d: 0.224329
0.9969 --- loss: 1.410612, loss_ss: 1.075696, loss_d: 0.334916
Epoch finished! Loss: 1.2135038231427853
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7733333333333333
             precision    recall  f1-score   support

        0.0       0.69      1.00      0.82       142
        1.0       0.00      0.00      0.00        23
        2.0       0.96      0.64      0.76       466
        3.0       0.63      0.99      0.77       167
        4.0       0.74      0.90      0.81       102

avg / total       0.81      0.77      0.76       900
 


====== chc052-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  93.00  100.00   91.69  69.27     81.84
1  97.44    0.00  100.00   0.00      0.00
2  79.78   63.52   97.24  96.10     76.49
3  89.11   99.40   86.77  63.12     77.21
4  95.33   90.20   95.99  74.19     81.42
Total accuracy: 77.33%
Average sen: 70.62%
Average spec: 94.34%
Macro f1-score: 63.39%
Diagnosis acc on 15mins: 1.0
[0.44692925 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925
 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925
 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925
 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925
 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925 0.44692925]
pred: 0.4469292461872101, label: 0
Right! Diagnosis: Other

=== Test on chc056-nsrr. train_data(2608), test_data(30) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.277003, loss_ss: 1.578883, loss_d: 0.698121
0.0383 --- loss: 2.998178, loss_ss: 1.482516, loss_d: 1.515661
0.0767 --- loss: 2.084084, loss_ss: 1.647634, loss_d: 0.436450
0.1150 --- loss: 2.212669, loss_ss: 1.446144, loss_d: 0.766525
0.1534 --- loss: 1.953738, loss_ss: 1.515783, loss_d: 0.437955
0.1917 --- loss: 2.230781, loss_ss: 1.621552, loss_d: 0.609229
0.2301 --- loss: 1.981292, loss_ss: 1.418343, loss_d: 0.562949
0.2684 --- loss: 1.942277, loss_ss: 1.306224, loss_d: 0.636053
0.3067 --- loss: 2.312034, loss_ss: 1.703491, loss_d: 0.608543
0.3451 --- loss: 1.979139, loss_ss: 1.299278, loss_d: 0.679861
0.3834 --- loss: 1.909702, loss_ss: 1.399093, loss_d: 0.510609
0.4218 --- loss: 1.683063, loss_ss: 1.280365, loss_d: 0.402698
0.4601 --- loss: 2.051472, loss_ss: 1.320695, loss_d: 0.730777
0.4985 --- loss: 2.077465, loss_ss: 1.440668, loss_d: 0.636797
0.5368 --- loss: 2.077878, loss_ss: 1.394696, loss_d: 0.683183
0.5752 --- loss: 1.995831, loss_ss: 1.544340, loss_d: 0.451491
0.6135 --- loss: 1.955961, loss_ss: 1.062545, loss_d: 0.893415
0.6518 --- loss: 1.644866, loss_ss: 1.203534, loss_d: 0.441332
0.6902 --- loss: 1.736736, loss_ss: 1.362131, loss_d: 0.374605
0.7285 --- loss: 1.720171, loss_ss: 1.313347, loss_d: 0.406824
0.7669 --- loss: 1.747264, loss_ss: 1.335105, loss_d: 0.412159
0.8052 --- loss: 1.752574, loss_ss: 1.190927, loss_d: 0.561647
0.8436 --- loss: 2.074046, loss_ss: 1.372193, loss_d: 0.701853
0.8819 --- loss: 1.502601, loss_ss: 1.000622, loss_d: 0.501979
0.9202 --- loss: 1.788184, loss_ss: 1.295633, loss_d: 0.492551
0.9586 --- loss: 1.685241, loss_ss: 1.156400, loss_d: 0.528840
0.9969 --- loss: 1.948363, loss_ss: 1.334965, loss_d: 0.613397
Epoch finished! Loss: 1.9367989320021408
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.648427, loss_ss: 1.128999, loss_d: 0.519428
0.0383 --- loss: 2.001755, loss_ss: 1.362337, loss_d: 0.639419
0.0767 --- loss: 1.626160, loss_ss: 1.080104, loss_d: 0.546056
0.1150 --- loss: 1.758558, loss_ss: 1.113968, loss_d: 0.644589
0.1534 --- loss: 1.398247, loss_ss: 1.049641, loss_d: 0.348605
0.1917 --- loss: 1.840580, loss_ss: 1.093330, loss_d: 0.747250
0.2301 --- loss: 1.524220, loss_ss: 1.015147, loss_d: 0.509072
0.2684 --- loss: 2.149009, loss_ss: 1.298315, loss_d: 0.850694
0.3067 --- loss: 1.513896, loss_ss: 1.029163, loss_d: 0.484733
0.3451 --- loss: 1.495984, loss_ss: 0.802633, loss_d: 0.693351
0.3834 --- loss: 1.415097, loss_ss: 0.848526, loss_d: 0.566571
0.4218 --- loss: 1.633237, loss_ss: 1.229209, loss_d: 0.404028
0.4601 --- loss: 1.611145, loss_ss: 1.356449, loss_d: 0.254696
0.4985 --- loss: 1.751474, loss_ss: 1.378149, loss_d: 0.373325
0.5368 --- loss: 2.039566, loss_ss: 1.176027, loss_d: 0.863539
0.5752 --- loss: 1.548188, loss_ss: 1.011874, loss_d: 0.536314
0.6135 --- loss: 1.618168, loss_ss: 1.085610, loss_d: 0.532558
0.6518 --- loss: 1.894525, loss_ss: 1.097648, loss_d: 0.796877
0.6902 --- loss: 1.656770, loss_ss: 1.183435, loss_d: 0.473335
0.7285 --- loss: 1.323377, loss_ss: 1.021587, loss_d: 0.301790
0.7669 --- loss: 1.707130, loss_ss: 1.090890, loss_d: 0.616240
0.8052 --- loss: 1.733607, loss_ss: 1.175499, loss_d: 0.558108
0.8436 --- loss: 1.564433, loss_ss: 0.978340, loss_d: 0.586093
0.8819 --- loss: 1.408039, loss_ss: 0.852292, loss_d: 0.555748
0.9202 --- loss: 1.666694, loss_ss: 1.161474, loss_d: 0.505220
0.9586 --- loss: 1.288087, loss_ss: 0.793739, loss_d: 0.494348
0.9969 --- loss: 1.787123, loss_ss: 1.454495, loss_d: 0.332628
Epoch finished! Loss: 1.7015527124588306
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.417389, loss_ss: 1.127083, loss_d: 0.290306
0.0383 --- loss: 1.655850, loss_ss: 1.059800, loss_d: 0.596050
0.0767 --- loss: 1.584244, loss_ss: 1.061312, loss_d: 0.522932
0.1150 --- loss: 1.617884, loss_ss: 1.059408, loss_d: 0.558476
0.1534 --- loss: 2.029222, loss_ss: 1.513670, loss_d: 0.515552
0.1917 --- loss: 1.517225, loss_ss: 0.912050, loss_d: 0.605175
0.2301 --- loss: 1.246381, loss_ss: 0.799713, loss_d: 0.446668
0.2684 --- loss: 1.835734, loss_ss: 1.119269, loss_d: 0.716466
0.3067 --- loss: 1.375402, loss_ss: 1.023021, loss_d: 0.352381
0.3451 --- loss: 1.416532, loss_ss: 0.931761, loss_d: 0.484771
0.3834 --- loss: 1.550684, loss_ss: 1.086911, loss_d: 0.463773
0.4218 --- loss: 1.656863, loss_ss: 0.930912, loss_d: 0.725951
0.4601 --- loss: 1.450211, loss_ss: 0.884958, loss_d: 0.565253
0.4985 --- loss: 1.686274, loss_ss: 0.982087, loss_d: 0.704188
0.5368 --- loss: 1.854870, loss_ss: 1.349835, loss_d: 0.505035
0.5752 --- loss: 1.582641, loss_ss: 0.991398, loss_d: 0.591243
0.6135 --- loss: 1.342444, loss_ss: 1.040363, loss_d: 0.302081
0.6518 --- loss: 1.485743, loss_ss: 0.815243, loss_d: 0.670500
0.6902 --- loss: 1.414638, loss_ss: 0.951860, loss_d: 0.462778
0.7285 --- loss: 1.446832, loss_ss: 0.906801, loss_d: 0.540031
0.7669 --- loss: 1.857688, loss_ss: 1.240630, loss_d: 0.617058
0.8052 --- loss: 2.135758, loss_ss: 1.656904, loss_d: 0.478854
0.8436 --- loss: 1.936709, loss_ss: 0.916955, loss_d: 1.019754
0.8819 --- loss: 1.601034, loss_ss: 0.989351, loss_d: 0.611683
0.9202 --- loss: 1.146256, loss_ss: 0.777748, loss_d: 0.368507
0.9586 --- loss: 1.680198, loss_ss: 0.805869, loss_d: 0.874329
0.9969 --- loss: 1.562041, loss_ss: 1.061773, loss_d: 0.500268
Epoch finished! Loss: 1.5957436772493216
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.332598, loss_ss: 0.883940, loss_d: 0.448657
0.0383 --- loss: 1.529616, loss_ss: 0.875625, loss_d: 0.653992
0.0767 --- loss: 1.465248, loss_ss: 0.810920, loss_d: 0.654327
0.1150 --- loss: 1.815628, loss_ss: 0.930069, loss_d: 0.885559
0.1534 --- loss: 1.682009, loss_ss: 1.203987, loss_d: 0.478022
0.1917 --- loss: 1.711601, loss_ss: 0.852497, loss_d: 0.859104
0.2301 --- loss: 1.281767, loss_ss: 0.770783, loss_d: 0.510984
0.2684 --- loss: 1.369345, loss_ss: 1.016780, loss_d: 0.352564
0.3067 --- loss: 1.464722, loss_ss: 0.936276, loss_d: 0.528446
0.3451 --- loss: 1.277537, loss_ss: 0.918597, loss_d: 0.358940
0.3834 --- loss: 1.739619, loss_ss: 1.121393, loss_d: 0.618225
0.4218 --- loss: 1.532143, loss_ss: 0.939422, loss_d: 0.592720
0.4601 --- loss: 1.285093, loss_ss: 0.781193, loss_d: 0.503900
0.4985 --- loss: 1.809705, loss_ss: 1.204093, loss_d: 0.605612
0.5368 --- loss: 1.510071, loss_ss: 0.980201, loss_d: 0.529870
0.5752 --- loss: 1.380656, loss_ss: 0.832017, loss_d: 0.548639
0.6135 --- loss: 1.362886, loss_ss: 0.934247, loss_d: 0.428639
0.6518 --- loss: 1.158416, loss_ss: 0.751496, loss_d: 0.406920
0.6902 --- loss: 1.612135, loss_ss: 0.924441, loss_d: 0.687694
0.7285 --- loss: 1.525136, loss_ss: 0.847544, loss_d: 0.677593
0.7669 --- loss: 1.357925, loss_ss: 0.970986, loss_d: 0.386939
0.8052 --- loss: 1.926330, loss_ss: 1.605706, loss_d: 0.320624
0.8436 --- loss: 1.640638, loss_ss: 0.983191, loss_d: 0.657446
0.8819 --- loss: 1.509440, loss_ss: 1.173662, loss_d: 0.335778
0.9202 --- loss: 1.173791, loss_ss: 0.868217, loss_d: 0.305575
0.9586 --- loss: 1.528845, loss_ss: 0.895954, loss_d: 0.632892
0.9969 --- loss: 1.308602, loss_ss: 0.816162, loss_d: 0.492439
Epoch finished! Loss: 1.5072171004918906
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.387977, loss_ss: 0.747803, loss_d: 0.640174
0.0383 --- loss: 1.376300, loss_ss: 0.822941, loss_d: 0.553360
0.0767 --- loss: 1.278761, loss_ss: 0.850737, loss_d: 0.428024
0.1150 --- loss: 2.190099, loss_ss: 1.116824, loss_d: 1.073275
0.1534 --- loss: 1.603405, loss_ss: 0.957865, loss_d: 0.645540
0.1917 --- loss: 1.814056, loss_ss: 1.278902, loss_d: 0.535154
0.2301 --- loss: 1.327702, loss_ss: 0.960194, loss_d: 0.367508
0.2684 --- loss: 1.339700, loss_ss: 1.045916, loss_d: 0.293784
0.3067 --- loss: 1.124108, loss_ss: 0.850682, loss_d: 0.273426
0.3451 --- loss: 1.239248, loss_ss: 0.898127, loss_d: 0.341121
0.3834 --- loss: 1.544882, loss_ss: 1.114570, loss_d: 0.430312
0.4218 --- loss: 1.497982, loss_ss: 1.004977, loss_d: 0.493005
0.4601 --- loss: 1.483560, loss_ss: 0.712157, loss_d: 0.771402
0.4985 --- loss: 1.245320, loss_ss: 0.740891, loss_d: 0.504429
0.5368 --- loss: 1.329644, loss_ss: 0.769319, loss_d: 0.560325
0.5752 --- loss: 2.426056, loss_ss: 1.413265, loss_d: 1.012791
0.6135 --- loss: 1.476068, loss_ss: 1.189111, loss_d: 0.286956
0.6518 --- loss: 1.462581, loss_ss: 1.014870, loss_d: 0.447711
0.6902 --- loss: 1.352739, loss_ss: 0.870659, loss_d: 0.482080
0.7285 --- loss: 1.567327, loss_ss: 1.169591, loss_d: 0.397735
0.7669 --- loss: 1.436334, loss_ss: 0.987458, loss_d: 0.448876
0.8052 --- loss: 2.023930, loss_ss: 1.260230, loss_d: 0.763699
0.8436 --- loss: 1.631997, loss_ss: 1.129221, loss_d: 0.502776
0.8819 --- loss: 1.405186, loss_ss: 0.953463, loss_d: 0.451723
0.9202 --- loss: 1.101811, loss_ss: 0.760237, loss_d: 0.341574
0.9586 --- loss: 1.649147, loss_ss: 1.029640, loss_d: 0.619507
0.9969 --- loss: 1.122984, loss_ss: 0.706445, loss_d: 0.416538
Epoch finished! Loss: 1.4528552766029652
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.671734, loss_ss: 0.963478, loss_d: 0.708256
0.0383 --- loss: 1.183518, loss_ss: 0.612530, loss_d: 0.570988
0.0767 --- loss: 1.037009, loss_ss: 0.675989, loss_d: 0.361020
0.1150 --- loss: 1.554520, loss_ss: 0.835943, loss_d: 0.718577
0.1534 --- loss: 1.412027, loss_ss: 0.873711, loss_d: 0.538316
0.1917 --- loss: 1.277245, loss_ss: 0.823983, loss_d: 0.453262
0.2301 --- loss: 1.525063, loss_ss: 1.185920, loss_d: 0.339144
0.2684 --- loss: 1.292887, loss_ss: 0.646687, loss_d: 0.646200
0.3067 --- loss: 1.362293, loss_ss: 0.948632, loss_d: 0.413661
0.3451 --- loss: 1.127863, loss_ss: 0.794685, loss_d: 0.333178
0.3834 --- loss: 1.791854, loss_ss: 1.091251, loss_d: 0.700603
0.4218 --- loss: 1.199003, loss_ss: 0.925940, loss_d: 0.273063
0.4601 --- loss: 1.542145, loss_ss: 0.992149, loss_d: 0.549996
0.4985 --- loss: 1.404060, loss_ss: 0.955614, loss_d: 0.448447
0.5368 --- loss: 1.210268, loss_ss: 0.886213, loss_d: 0.324054
0.5752 --- loss: 1.373944, loss_ss: 1.060343, loss_d: 0.313601
0.6135 --- loss: 1.432054, loss_ss: 0.863168, loss_d: 0.568886
0.6518 --- loss: 1.201411, loss_ss: 0.849529, loss_d: 0.351882
0.6902 --- loss: 1.230940, loss_ss: 0.929074, loss_d: 0.301866
0.7285 --- loss: 1.437223, loss_ss: 0.757097, loss_d: 0.680125
0.7669 --- loss: 1.590860, loss_ss: 1.126287, loss_d: 0.464573
0.8052 --- loss: 1.537065, loss_ss: 1.050680, loss_d: 0.486385
0.8436 --- loss: 1.730729, loss_ss: 0.647675, loss_d: 1.083053
0.8819 --- loss: 1.712410, loss_ss: 1.063209, loss_d: 0.649201
0.9202 --- loss: 1.283465, loss_ss: 0.740318, loss_d: 0.543147
0.9586 --- loss: 1.704760, loss_ss: 0.916603, loss_d: 0.788157
0.9969 --- loss: 1.205432, loss_ss: 0.753391, loss_d: 0.452041
Epoch finished! Loss: 1.3974781212898402
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.410347, loss_ss: 0.900126, loss_d: 0.510221
0.0383 --- loss: 1.133314, loss_ss: 0.807307, loss_d: 0.326007
0.0767 --- loss: 1.491203, loss_ss: 0.976688, loss_d: 0.514514
0.1150 --- loss: 1.153037, loss_ss: 0.731641, loss_d: 0.421396
0.1534 --- loss: 1.863892, loss_ss: 0.811060, loss_d: 1.052831
0.1917 --- loss: 1.445416, loss_ss: 0.703938, loss_d: 0.741479
0.2301 --- loss: 1.288656, loss_ss: 0.935281, loss_d: 0.353375
0.2684 --- loss: 1.683521, loss_ss: 1.247378, loss_d: 0.436142
0.3067 --- loss: 1.484533, loss_ss: 0.988042, loss_d: 0.496491
0.3451 --- loss: 1.483969, loss_ss: 1.243497, loss_d: 0.240472
0.3834 --- loss: 1.184348, loss_ss: 0.740771, loss_d: 0.443577
0.4218 --- loss: 1.117389, loss_ss: 0.838759, loss_d: 0.278629
0.4601 --- loss: 1.363267, loss_ss: 0.941543, loss_d: 0.421724
0.4985 --- loss: 1.259016, loss_ss: 0.768151, loss_d: 0.490865
0.5368 --- loss: 1.101508, loss_ss: 0.885335, loss_d: 0.216173
0.5752 --- loss: 1.086563, loss_ss: 0.904510, loss_d: 0.182053
0.6135 --- loss: 1.711344, loss_ss: 0.763637, loss_d: 0.947707
0.6518 --- loss: 1.102196, loss_ss: 0.797426, loss_d: 0.304770
0.6902 --- loss: 0.894614, loss_ss: 0.524236, loss_d: 0.370378
0.7285 --- loss: 1.419027, loss_ss: 1.058923, loss_d: 0.360103
0.7669 --- loss: 1.116740, loss_ss: 0.933967, loss_d: 0.182773
0.8052 --- loss: 1.270570, loss_ss: 0.898422, loss_d: 0.372149
0.8436 --- loss: 1.125465, loss_ss: 0.857558, loss_d: 0.267907
0.8819 --- loss: 1.439636, loss_ss: 1.141484, loss_d: 0.298151
0.9202 --- loss: 1.063456, loss_ss: 0.801206, loss_d: 0.262250
0.9586 --- loss: 1.225915, loss_ss: 0.955771, loss_d: 0.270144
0.9969 --- loss: 1.331318, loss_ss: 0.970085, loss_d: 0.361233
Epoch finished! Loss: 1.3227966436972984
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.115526, loss_ss: 0.781583, loss_d: 0.333943
0.0383 --- loss: 1.069465, loss_ss: 0.833380, loss_d: 0.236085
0.0767 --- loss: 1.572556, loss_ss: 0.851549, loss_d: 0.721006
0.1150 --- loss: 1.252702, loss_ss: 1.007665, loss_d: 0.245037
0.1534 --- loss: 1.564915, loss_ss: 1.014086, loss_d: 0.550829
0.1917 --- loss: 1.168875, loss_ss: 0.779818, loss_d: 0.389057
0.2301 --- loss: 1.478575, loss_ss: 1.247491, loss_d: 0.231084
0.2684 --- loss: 1.131516, loss_ss: 0.931696, loss_d: 0.199819
0.3067 --- loss: 1.279912, loss_ss: 1.080924, loss_d: 0.198987
0.3451 --- loss: 1.475429, loss_ss: 0.783370, loss_d: 0.692059
0.3834 --- loss: 1.664955, loss_ss: 1.206452, loss_d: 0.458502
0.4218 --- loss: 1.839543, loss_ss: 1.068166, loss_d: 0.771378
0.4601 --- loss: 1.062045, loss_ss: 0.718934, loss_d: 0.343111
0.4985 --- loss: 1.006000, loss_ss: 0.740912, loss_d: 0.265088
0.5368 --- loss: 1.237736, loss_ss: 0.997540, loss_d: 0.240195
0.5752 --- loss: 0.901155, loss_ss: 0.745903, loss_d: 0.155252
0.6135 --- loss: 1.316952, loss_ss: 0.921826, loss_d: 0.395126
0.6518 --- loss: 1.231816, loss_ss: 0.951209, loss_d: 0.280608
0.6902 --- loss: 1.830839, loss_ss: 1.304999, loss_d: 0.525840
0.7285 --- loss: 1.016797, loss_ss: 0.794415, loss_d: 0.222382
0.7669 --- loss: 1.219083, loss_ss: 0.949252, loss_d: 0.269831
0.8052 --- loss: 1.248160, loss_ss: 1.046300, loss_d: 0.201860
0.8436 --- loss: 1.172856, loss_ss: 0.993466, loss_d: 0.179390
0.8819 --- loss: 1.368240, loss_ss: 0.989143, loss_d: 0.379097
0.9202 --- loss: 1.561339, loss_ss: 0.925466, loss_d: 0.635873
0.9586 --- loss: 1.159260, loss_ss: 0.989205, loss_d: 0.170055
0.9969 --- loss: 1.155243, loss_ss: 0.848789, loss_d: 0.306454
Epoch finished! Loss: 1.2585987304265682
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.085753, loss_ss: 0.756626, loss_d: 0.329127
0.0383 --- loss: 1.608179, loss_ss: 1.208861, loss_d: 0.399319
0.0767 --- loss: 1.331535, loss_ss: 0.831371, loss_d: 0.500164
0.1150 --- loss: 0.823647, loss_ss: 0.673175, loss_d: 0.150472
0.1534 --- loss: 1.121542, loss_ss: 0.671690, loss_d: 0.449852
0.1917 --- loss: 1.364417, loss_ss: 0.895408, loss_d: 0.469010
0.2301 --- loss: 0.921612, loss_ss: 0.717407, loss_d: 0.204206
0.2684 --- loss: 1.064410, loss_ss: 0.736540, loss_d: 0.327871
0.3067 --- loss: 1.062475, loss_ss: 0.880315, loss_d: 0.182160
0.3451 --- loss: 1.103681, loss_ss: 0.682702, loss_d: 0.420979
0.3834 --- loss: 1.005882, loss_ss: 0.634197, loss_d: 0.371685
0.4218 --- loss: 1.718158, loss_ss: 1.307221, loss_d: 0.410937
0.4601 --- loss: 1.007232, loss_ss: 0.744676, loss_d: 0.262556
0.4985 --- loss: 1.232799, loss_ss: 0.989119, loss_d: 0.243680
0.5368 --- loss: 1.383694, loss_ss: 0.862505, loss_d: 0.521189
0.5752 --- loss: 1.217064, loss_ss: 0.866098, loss_d: 0.350967
0.6135 --- loss: 1.718524, loss_ss: 0.967063, loss_d: 0.751461
0.6518 --- loss: 1.147837, loss_ss: 0.771374, loss_d: 0.376463
0.6902 --- loss: 0.835499, loss_ss: 0.692410, loss_d: 0.143088
0.7285 --- loss: 1.518994, loss_ss: 1.187182, loss_d: 0.331812
0.7669 --- loss: 1.365266, loss_ss: 1.051165, loss_d: 0.314101
0.8052 --- loss: 0.994489, loss_ss: 0.838580, loss_d: 0.155910
0.8436 --- loss: 1.411779, loss_ss: 1.006917, loss_d: 0.404862
0.8819 --- loss: 1.037438, loss_ss: 0.876090, loss_d: 0.161348
0.9202 --- loss: 1.064878, loss_ss: 0.802005, loss_d: 0.262874
0.9586 --- loss: 0.935057, loss_ss: 0.794823, loss_d: 0.140234
0.9969 --- loss: 1.322272, loss_ss: 0.902332, loss_d: 0.419940
Epoch finished! Loss: 1.1952218975012119
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.299291, loss_ss: 0.879615, loss_d: 0.419676
0.0383 --- loss: 1.468310, loss_ss: 1.145494, loss_d: 0.322816
0.0767 --- loss: 1.181406, loss_ss: 0.746172, loss_d: 0.435234
0.1150 --- loss: 1.152327, loss_ss: 1.005680, loss_d: 0.146647
0.1534 --- loss: 1.396008, loss_ss: 1.133389, loss_d: 0.262619
0.1917 --- loss: 0.876187, loss_ss: 0.754143, loss_d: 0.122045
0.2301 --- loss: 1.204120, loss_ss: 0.945637, loss_d: 0.258483
0.2684 --- loss: 1.379154, loss_ss: 0.742315, loss_d: 0.636839
0.3067 --- loss: 1.034501, loss_ss: 0.633589, loss_d: 0.400912
0.3451 --- loss: 1.929859, loss_ss: 0.900877, loss_d: 1.028982
0.3834 --- loss: 0.982242, loss_ss: 0.778967, loss_d: 0.203275
0.4218 --- loss: 0.901178, loss_ss: 0.691290, loss_d: 0.209888
0.4601 --- loss: 1.027072, loss_ss: 0.827003, loss_d: 0.200069
0.4985 --- loss: 0.876974, loss_ss: 0.740166, loss_d: 0.136808
0.5368 --- loss: 0.793854, loss_ss: 0.667231, loss_d: 0.126623
0.5752 --- loss: 1.137959, loss_ss: 1.015003, loss_d: 0.122956
0.6135 --- loss: 1.076221, loss_ss: 0.933469, loss_d: 0.142752
0.6518 --- loss: 1.203963, loss_ss: 0.737027, loss_d: 0.466936
0.6902 --- loss: 0.681685, loss_ss: 0.563663, loss_d: 0.118022
0.7285 --- loss: 0.864118, loss_ss: 0.702385, loss_d: 0.161733
0.7669 --- loss: 0.711929, loss_ss: 0.525269, loss_d: 0.186661
0.8052 --- loss: 1.211542, loss_ss: 0.866704, loss_d: 0.344839
0.8436 --- loss: 1.055142, loss_ss: 0.882858, loss_d: 0.172284
0.8819 --- loss: 1.394623, loss_ss: 0.977159, loss_d: 0.417464
0.9202 --- loss: 0.980973, loss_ss: 0.772131, loss_d: 0.208841
0.9586 --- loss: 1.045691, loss_ss: 0.833243, loss_d: 0.212448
0.9969 --- loss: 1.117743, loss_ss: 0.891693, loss_d: 0.226050
Epoch finished! Loss: 1.1551828010724141
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7888888888888889
             precision    recall  f1-score   support

        0.0       0.75      0.89      0.81       175
        1.0       0.50      0.07      0.12        86
        2.0       0.75      0.96      0.85       396
        3.0       1.00      0.61      0.76       153
        4.0       0.90      0.81      0.85        90

avg / total       0.79      0.79      0.76       900
 


====== chc056-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  92.11  89.14   92.83   75.00     81.46
1  90.44   6.98   99.26   50.00     12.24
2  84.56  96.21   75.40   75.45     84.57
3  93.44  61.44  100.00  100.00     76.11
4  97.22  81.11   99.01   90.12     85.38
Total accuracy: 78.89%
Average sen: 66.98%
Average spec: 93.30%
Macro f1-score: 67.95%
Diagnosis acc on 15mins: 1.0
[0.28135052 0.25218257 0.27405047 0.19837737 0.17543791 0.21394904
 0.27364263 0.20323876 0.09527072 0.08681529 0.26183367 0.26560032
 0.11243133 0.23290794 0.13748953 0.20100553 0.1595103  0.1225298
 0.0852638  0.24220686 0.1901385  0.07431313 0.120319   0.14358141
 0.10091368 0.09256653 0.10436037 0.10230951 0.25952387 0.08738311]
pred: 0.1716834495464961, label: 0
Right! Diagnosis: Other

=== Test on chp001-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.358445, loss_ss: 1.682501, loss_d: 0.675944
0.0385 --- loss: 1.909853, loss_ss: 1.417447, loss_d: 0.492406
0.0769 --- loss: 2.135795, loss_ss: 1.591771, loss_d: 0.544024
0.1154 --- loss: 1.727057, loss_ss: 1.201785, loss_d: 0.525273
0.1538 --- loss: 1.872496, loss_ss: 1.416396, loss_d: 0.456101
0.1923 --- loss: 1.931481, loss_ss: 1.471059, loss_d: 0.460422
0.2308 --- loss: 1.914676, loss_ss: 1.155251, loss_d: 0.759425
0.2692 --- loss: 1.991788, loss_ss: 1.339632, loss_d: 0.652156
0.3077 --- loss: 2.118155, loss_ss: 1.424833, loss_d: 0.693322
0.3462 --- loss: 2.224414, loss_ss: 1.483444, loss_d: 0.740970
0.3846 --- loss: 2.200219, loss_ss: 1.507794, loss_d: 0.692425
0.4231 --- loss: 1.709623, loss_ss: 1.231540, loss_d: 0.478082
0.4615 --- loss: 2.275832, loss_ss: 1.537604, loss_d: 0.738228
0.5000 --- loss: 1.851245, loss_ss: 1.251841, loss_d: 0.599404
0.5385 --- loss: 1.873451, loss_ss: 1.250956, loss_d: 0.622495
0.5769 --- loss: 1.835309, loss_ss: 1.401449, loss_d: 0.433860
0.6154 --- loss: 1.669164, loss_ss: 1.221732, loss_d: 0.447432
0.6538 --- loss: 1.605166, loss_ss: 1.242552, loss_d: 0.362614
0.6923 --- loss: 1.974717, loss_ss: 1.245636, loss_d: 0.729080
0.7308 --- loss: 1.593950, loss_ss: 1.169363, loss_d: 0.424587
0.7692 --- loss: 1.812575, loss_ss: 1.406751, loss_d: 0.405824
0.8077 --- loss: 1.634362, loss_ss: 1.079143, loss_d: 0.555219
0.8462 --- loss: 1.614650, loss_ss: 1.049198, loss_d: 0.565452
0.8846 --- loss: 1.676166, loss_ss: 1.151634, loss_d: 0.524532
0.9231 --- loss: 1.885504, loss_ss: 1.158018, loss_d: 0.727487
0.9615 --- loss: 2.222777, loss_ss: 1.236462, loss_d: 0.986314
Epoch finished! Loss: 1.9221285687450276
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.873339, loss_ss: 1.236143, loss_d: 0.637196
0.0385 --- loss: 1.646582, loss_ss: 1.022771, loss_d: 0.623811
0.0769 --- loss: 2.047198, loss_ss: 1.295865, loss_d: 0.751332
0.1154 --- loss: 1.638381, loss_ss: 1.072609, loss_d: 0.565771
0.1538 --- loss: 2.097577, loss_ss: 1.587374, loss_d: 0.510203
0.1923 --- loss: 1.881163, loss_ss: 1.038017, loss_d: 0.843146
0.2308 --- loss: 1.593723, loss_ss: 1.076376, loss_d: 0.517347
0.2692 --- loss: 1.789448, loss_ss: 1.268676, loss_d: 0.520773
0.3077 --- loss: 1.842427, loss_ss: 1.328717, loss_d: 0.513710
0.3462 --- loss: 1.457207, loss_ss: 1.081485, loss_d: 0.375722
0.3846 --- loss: 1.668742, loss_ss: 1.010677, loss_d: 0.658065
0.4231 --- loss: 1.723980, loss_ss: 1.083671, loss_d: 0.640308
0.4615 --- loss: 1.977858, loss_ss: 1.461956, loss_d: 0.515902
0.5000 --- loss: 1.727656, loss_ss: 0.947198, loss_d: 0.780458
0.5385 --- loss: 1.327513, loss_ss: 0.905004, loss_d: 0.422509
0.5769 --- loss: 1.581061, loss_ss: 1.077801, loss_d: 0.503260
0.6154 --- loss: 1.828520, loss_ss: 1.167615, loss_d: 0.660905
0.6538 --- loss: 1.371338, loss_ss: 0.934802, loss_d: 0.436536
0.6923 --- loss: 1.922485, loss_ss: 1.329127, loss_d: 0.593358
0.7308 --- loss: 1.892605, loss_ss: 1.387454, loss_d: 0.505150
0.7692 --- loss: 1.949089, loss_ss: 1.122160, loss_d: 0.826929
0.8077 --- loss: 1.590328, loss_ss: 1.174698, loss_d: 0.415630
0.8462 --- loss: 1.501950, loss_ss: 1.024004, loss_d: 0.477947
0.8846 --- loss: 1.672580, loss_ss: 0.974225, loss_d: 0.698355
0.9231 --- loss: 1.607744, loss_ss: 0.977780, loss_d: 0.629963
0.9615 --- loss: 1.667903, loss_ss: 1.279973, loss_d: 0.387929
Epoch finished! Loss: 1.7142995655766786
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.684081, loss_ss: 1.188532, loss_d: 0.495549
0.0385 --- loss: 1.891135, loss_ss: 1.084305, loss_d: 0.806831
0.0769 --- loss: 1.928217, loss_ss: 1.125482, loss_d: 0.802735
0.1154 --- loss: 1.365404, loss_ss: 0.905214, loss_d: 0.460190
0.1538 --- loss: 1.718518, loss_ss: 0.984068, loss_d: 0.734450
0.1923 --- loss: 1.526547, loss_ss: 1.004006, loss_d: 0.522541
0.2308 --- loss: 1.530595, loss_ss: 0.938136, loss_d: 0.592459
0.2692 --- loss: 1.808971, loss_ss: 1.047616, loss_d: 0.761355
0.3077 --- loss: 1.445802, loss_ss: 0.933422, loss_d: 0.512380
0.3462 --- loss: 1.558061, loss_ss: 1.067242, loss_d: 0.490818
0.3846 --- loss: 1.438773, loss_ss: 0.862621, loss_d: 0.576151
0.4231 --- loss: 1.806775, loss_ss: 1.082503, loss_d: 0.724271
0.4615 --- loss: 1.569153, loss_ss: 0.906320, loss_d: 0.662833
0.5000 --- loss: 1.598455, loss_ss: 0.914522, loss_d: 0.683933
0.5385 --- loss: 1.901887, loss_ss: 1.079486, loss_d: 0.822400
0.5769 --- loss: 1.620744, loss_ss: 1.078573, loss_d: 0.542170
0.6154 --- loss: 1.825930, loss_ss: 1.232714, loss_d: 0.593216
0.6538 --- loss: 1.586776, loss_ss: 0.957080, loss_d: 0.629696
0.6923 --- loss: 1.527293, loss_ss: 0.849215, loss_d: 0.678078
0.7308 --- loss: 1.345268, loss_ss: 0.881207, loss_d: 0.464061
0.7692 --- loss: 1.852989, loss_ss: 1.059246, loss_d: 0.793743
0.8077 --- loss: 1.889635, loss_ss: 1.275376, loss_d: 0.614260
0.8462 --- loss: 1.386399, loss_ss: 1.013284, loss_d: 0.373116
0.8846 --- loss: 1.253462, loss_ss: 1.000988, loss_d: 0.252474
0.9231 --- loss: 1.198932, loss_ss: 0.929161, loss_d: 0.269770
0.9615 --- loss: 1.461567, loss_ss: 1.056980, loss_d: 0.404588
Epoch finished! Loss: 1.6035188445713529
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.610254, loss_ss: 0.880067, loss_d: 0.730186
0.0385 --- loss: 1.886956, loss_ss: 1.150298, loss_d: 0.736658
0.0769 --- loss: 1.452104, loss_ss: 0.883597, loss_d: 0.568507
0.1154 --- loss: 1.438533, loss_ss: 0.961436, loss_d: 0.477097
0.1538 --- loss: 1.505682, loss_ss: 0.757017, loss_d: 0.748665
0.1923 --- loss: 1.599953, loss_ss: 1.023485, loss_d: 0.576468
0.2308 --- loss: 1.302625, loss_ss: 0.901265, loss_d: 0.401361
0.2692 --- loss: 2.047479, loss_ss: 1.156246, loss_d: 0.891233
0.3077 --- loss: 1.650329, loss_ss: 0.969545, loss_d: 0.680785
0.3462 --- loss: 1.447147, loss_ss: 0.828301, loss_d: 0.618846
0.3846 --- loss: 1.506633, loss_ss: 0.926112, loss_d: 0.580521
0.4231 --- loss: 1.472310, loss_ss: 0.827048, loss_d: 0.645262
0.4615 --- loss: 1.726102, loss_ss: 0.880794, loss_d: 0.845308
0.5000 --- loss: 1.384240, loss_ss: 1.043056, loss_d: 0.341184
0.5385 --- loss: 1.685024, loss_ss: 0.922491, loss_d: 0.762533
0.5769 --- loss: 1.382583, loss_ss: 0.930122, loss_d: 0.452460
0.6154 --- loss: 1.818122, loss_ss: 0.907596, loss_d: 0.910526
0.6538 --- loss: 2.118205, loss_ss: 0.868136, loss_d: 1.250070
0.6923 --- loss: 2.209777, loss_ss: 1.717969, loss_d: 0.491807
0.7308 --- loss: 1.767146, loss_ss: 1.030982, loss_d: 0.736165
0.7692 --- loss: 1.408031, loss_ss: 0.970261, loss_d: 0.437770
0.8077 --- loss: 1.216699, loss_ss: 0.865965, loss_d: 0.350734
0.8462 --- loss: 2.106986, loss_ss: 1.781132, loss_d: 0.325853
0.8846 --- loss: 1.079699, loss_ss: 0.902304, loss_d: 0.177395
0.9231 --- loss: 1.653690, loss_ss: 0.825035, loss_d: 0.828656
0.9615 --- loss: 1.594482, loss_ss: 1.098886, loss_d: 0.495596
Epoch finished! Loss: 1.5164492040527373
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.286339, loss_ss: 0.989560, loss_d: 0.296779
0.0385 --- loss: 1.150405, loss_ss: 0.718191, loss_d: 0.432214
0.0769 --- loss: 1.361694, loss_ss: 1.037860, loss_d: 0.323834
0.1154 --- loss: 1.305813, loss_ss: 0.882496, loss_d: 0.423317
0.1538 --- loss: 1.444950, loss_ss: 0.906527, loss_d: 0.538423
0.1923 --- loss: 1.709407, loss_ss: 0.706236, loss_d: 1.003170
0.2308 --- loss: 1.168174, loss_ss: 0.828580, loss_d: 0.339594
0.2692 --- loss: 1.398864, loss_ss: 0.894077, loss_d: 0.504787
0.3077 --- loss: 1.857808, loss_ss: 1.147328, loss_d: 0.710480
0.3462 --- loss: 1.531610, loss_ss: 1.112090, loss_d: 0.419520
0.3846 --- loss: 1.238719, loss_ss: 0.732773, loss_d: 0.505946
0.4231 --- loss: 1.708999, loss_ss: 1.277101, loss_d: 0.431899
0.4615 --- loss: 1.080898, loss_ss: 0.833932, loss_d: 0.246966
0.5000 --- loss: 1.417228, loss_ss: 0.868273, loss_d: 0.548954
0.5385 --- loss: 1.335073, loss_ss: 0.741307, loss_d: 0.593766
0.5769 --- loss: 1.245620, loss_ss: 0.681690, loss_d: 0.563930
0.6154 --- loss: 1.210991, loss_ss: 0.915018, loss_d: 0.295973
0.6538 --- loss: 1.162172, loss_ss: 0.824793, loss_d: 0.337379
0.6923 --- loss: 1.673715, loss_ss: 1.323385, loss_d: 0.350330
0.7308 --- loss: 1.162023, loss_ss: 0.958260, loss_d: 0.203763
0.7692 --- loss: 1.584735, loss_ss: 0.836195, loss_d: 0.748540
0.8077 --- loss: 1.431718, loss_ss: 0.865402, loss_d: 0.566316
0.8462 --- loss: 1.523919, loss_ss: 1.175458, loss_d: 0.348461
0.8846 --- loss: 1.061381, loss_ss: 0.835752, loss_d: 0.225629
0.9231 --- loss: 1.160182, loss_ss: 0.958039, loss_d: 0.202143
0.9615 --- loss: 1.156718, loss_ss: 0.840321, loss_d: 0.316397
Epoch finished! Loss: 1.4020373439236498
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.312866, loss_ss: 1.037479, loss_d: 0.275387
0.0385 --- loss: 1.101232, loss_ss: 0.670322, loss_d: 0.430910
0.0769 --- loss: 1.139625, loss_ss: 0.706862, loss_d: 0.432763
0.1154 --- loss: 1.750826, loss_ss: 0.954811, loss_d: 0.796015
0.1538 --- loss: 1.262979, loss_ss: 1.087159, loss_d: 0.175819
0.1923 --- loss: 1.612432, loss_ss: 1.043694, loss_d: 0.568738
0.2308 --- loss: 0.893907, loss_ss: 0.675487, loss_d: 0.218420
0.2692 --- loss: 1.535738, loss_ss: 1.078096, loss_d: 0.457642
0.3077 --- loss: 1.259322, loss_ss: 0.673338, loss_d: 0.585984
0.3462 --- loss: 1.106084, loss_ss: 0.748857, loss_d: 0.357226
0.3846 --- loss: 1.440276, loss_ss: 0.765344, loss_d: 0.674932
0.4231 --- loss: 1.379455, loss_ss: 1.044239, loss_d: 0.335216
0.4615 --- loss: 1.290440, loss_ss: 1.010581, loss_d: 0.279859
0.5000 --- loss: 1.141012, loss_ss: 0.743611, loss_d: 0.397401
0.5385 --- loss: 0.916655, loss_ss: 0.709229, loss_d: 0.207426
0.5769 --- loss: 1.204161, loss_ss: 0.799249, loss_d: 0.404912
0.6154 --- loss: 1.116140, loss_ss: 0.898065, loss_d: 0.218075
0.6538 --- loss: 0.996761, loss_ss: 0.734149, loss_d: 0.262612
0.6923 --- loss: 1.072510, loss_ss: 0.918713, loss_d: 0.153797
0.7308 --- loss: 1.213999, loss_ss: 0.980468, loss_d: 0.233532
0.7692 --- loss: 1.037876, loss_ss: 0.849174, loss_d: 0.188702
0.8077 --- loss: 1.137364, loss_ss: 0.940351, loss_d: 0.197013
0.8462 --- loss: 1.197656, loss_ss: 0.746115, loss_d: 0.451541
0.8846 --- loss: 0.818734, loss_ss: 0.723068, loss_d: 0.095666
0.9231 --- loss: 1.214809, loss_ss: 0.936892, loss_d: 0.277917
0.9615 --- loss: 1.122211, loss_ss: 0.628087, loss_d: 0.494124
Epoch finished! Loss: 1.291997603237859
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.555640, loss_ss: 0.782677, loss_d: 0.772963
0.0385 --- loss: 1.171237, loss_ss: 0.918188, loss_d: 0.253049
0.0769 --- loss: 0.853320, loss_ss: 0.631575, loss_d: 0.221745
0.1154 --- loss: 1.414105, loss_ss: 0.898043, loss_d: 0.516062
0.1538 --- loss: 1.854184, loss_ss: 0.803570, loss_d: 1.050614
0.1923 --- loss: 1.136600, loss_ss: 0.722719, loss_d: 0.413881
0.2308 --- loss: 1.918986, loss_ss: 1.150847, loss_d: 0.768139
0.2692 --- loss: 1.337064, loss_ss: 0.871868, loss_d: 0.465197
0.3077 --- loss: 1.202709, loss_ss: 0.800863, loss_d: 0.401846
0.3462 --- loss: 1.437297, loss_ss: 1.226240, loss_d: 0.211056
0.3846 --- loss: 0.958889, loss_ss: 0.702630, loss_d: 0.256259
0.4231 --- loss: 1.309180, loss_ss: 1.054337, loss_d: 0.254843
0.4615 --- loss: 1.275198, loss_ss: 0.889452, loss_d: 0.385745
0.5000 --- loss: 1.224667, loss_ss: 0.869338, loss_d: 0.355329
0.5385 --- loss: 1.074213, loss_ss: 0.814394, loss_d: 0.259819
0.5769 --- loss: 1.445438, loss_ss: 0.835092, loss_d: 0.610346
0.6154 --- loss: 1.254068, loss_ss: 0.844264, loss_d: 0.409804
0.6538 --- loss: 1.110466, loss_ss: 0.859514, loss_d: 0.250952
0.6923 --- loss: 1.098458, loss_ss: 0.869591, loss_d: 0.228867
0.7308 --- loss: 1.029326, loss_ss: 0.873626, loss_d: 0.155700
0.7692 --- loss: 0.945150, loss_ss: 0.787103, loss_d: 0.158047
0.8077 --- loss: 1.177782, loss_ss: 0.987786, loss_d: 0.189995
0.8462 --- loss: 1.549264, loss_ss: 1.104352, loss_d: 0.444912
0.8846 --- loss: 1.060533, loss_ss: 0.861791, loss_d: 0.198742
0.9231 --- loss: 0.970318, loss_ss: 0.766088, loss_d: 0.204229
0.9615 --- loss: 1.257135, loss_ss: 0.777929, loss_d: 0.479206
Epoch finished! Loss: 1.2697883264438525
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.866848, loss_ss: 0.947497, loss_d: 0.919352
0.0385 --- loss: 1.194932, loss_ss: 0.839604, loss_d: 0.355328
0.0769 --- loss: 1.496239, loss_ss: 0.945935, loss_d: 0.550304
0.1154 --- loss: 1.301408, loss_ss: 0.874773, loss_d: 0.426635
0.1538 --- loss: 1.198191, loss_ss: 0.734910, loss_d: 0.463280
0.1923 --- loss: 1.060583, loss_ss: 0.711894, loss_d: 0.348689
0.2308 --- loss: 1.409019, loss_ss: 0.747847, loss_d: 0.661172
0.2692 --- loss: 1.000194, loss_ss: 0.807364, loss_d: 0.192830
0.3077 --- loss: 1.237883, loss_ss: 0.880557, loss_d: 0.357327
0.3462 --- loss: 1.139191, loss_ss: 0.972370, loss_d: 0.166822
0.3846 --- loss: 1.763442, loss_ss: 1.119331, loss_d: 0.644110
0.4231 --- loss: 1.091604, loss_ss: 0.705381, loss_d: 0.386223
0.4615 --- loss: 1.126107, loss_ss: 0.872758, loss_d: 0.253348
0.5000 --- loss: 1.128451, loss_ss: 0.752473, loss_d: 0.375978
0.5385 --- loss: 1.561183, loss_ss: 1.044132, loss_d: 0.517051
0.5769 --- loss: 1.497531, loss_ss: 0.913235, loss_d: 0.584297
0.6154 --- loss: 1.262971, loss_ss: 1.032271, loss_d: 0.230700
0.6538 --- loss: 1.556587, loss_ss: 1.063024, loss_d: 0.493563
0.6923 --- loss: 0.702088, loss_ss: 0.629563, loss_d: 0.072525
0.7308 --- loss: 1.002944, loss_ss: 0.570142, loss_d: 0.432802
0.7692 --- loss: 1.067102, loss_ss: 0.997322, loss_d: 0.069780
0.8077 --- loss: 1.007120, loss_ss: 0.812583, loss_d: 0.194537
0.8462 --- loss: 1.116111, loss_ss: 0.949414, loss_d: 0.166697
0.8846 --- loss: 1.721632, loss_ss: 1.280763, loss_d: 0.440870
0.9231 --- loss: 1.373170, loss_ss: 1.159801, loss_d: 0.213369
0.9615 --- loss: 1.176370, loss_ss: 0.907184, loss_d: 0.269186
Epoch finished! Loss: 1.2089636440903064
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.244949, loss_ss: 0.865224, loss_d: 0.379724
0.0385 --- loss: 1.213613, loss_ss: 0.901676, loss_d: 0.311937
0.0769 --- loss: 0.920011, loss_ss: 0.764916, loss_d: 0.155095
0.1154 --- loss: 1.002257, loss_ss: 0.772286, loss_d: 0.229970
0.1538 --- loss: 1.572476, loss_ss: 0.900286, loss_d: 0.672190
0.1923 --- loss: 1.956941, loss_ss: 1.501487, loss_d: 0.455454
0.2308 --- loss: 1.183835, loss_ss: 0.774490, loss_d: 0.409345
0.2692 --- loss: 1.137799, loss_ss: 0.825234, loss_d: 0.312565
0.3077 --- loss: 1.416066, loss_ss: 1.172145, loss_d: 0.243921
0.3462 --- loss: 1.066728, loss_ss: 0.686444, loss_d: 0.380285
0.3846 --- loss: 0.932929, loss_ss: 0.751751, loss_d: 0.181177
0.4231 --- loss: 0.876189, loss_ss: 0.539616, loss_d: 0.336574
0.4615 --- loss: 1.632967, loss_ss: 0.801611, loss_d: 0.831356
0.5000 --- loss: 1.062546, loss_ss: 0.733222, loss_d: 0.329324
0.5385 --- loss: 1.153069, loss_ss: 0.825683, loss_d: 0.327386
0.5769 --- loss: 1.522541, loss_ss: 1.341092, loss_d: 0.181449
0.6154 --- loss: 1.475510, loss_ss: 1.087050, loss_d: 0.388460
0.6538 --- loss: 1.334237, loss_ss: 1.066897, loss_d: 0.267339
0.6923 --- loss: 1.107509, loss_ss: 0.929777, loss_d: 0.177732
0.7308 --- loss: 0.955830, loss_ss: 0.789199, loss_d: 0.166631
0.7692 --- loss: 0.824887, loss_ss: 0.689082, loss_d: 0.135804
0.8077 --- loss: 1.116542, loss_ss: 0.815830, loss_d: 0.300712
0.8462 --- loss: 1.116152, loss_ss: 0.763797, loss_d: 0.352355
0.8846 --- loss: 1.142002, loss_ss: 0.793813, loss_d: 0.348188
0.9231 --- loss: 0.998894, loss_ss: 0.904582, loss_d: 0.094311
0.9615 --- loss: 0.953141, loss_ss: 0.762496, loss_d: 0.190645
Epoch finished! Loss: 1.1710920271726188
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.154208, loss_ss: 1.045398, loss_d: 0.108810
0.0385 --- loss: 0.822851, loss_ss: 0.754055, loss_d: 0.068796
0.0769 --- loss: 0.969272, loss_ss: 0.910198, loss_d: 0.059074
0.1154 --- loss: 0.986364, loss_ss: 0.831952, loss_d: 0.154412
0.1538 --- loss: 1.134015, loss_ss: 0.846389, loss_d: 0.287626
0.1923 --- loss: 1.071329, loss_ss: 0.915205, loss_d: 0.156125
0.2308 --- loss: 1.052422, loss_ss: 0.943872, loss_d: 0.108550
0.2692 --- loss: 1.225629, loss_ss: 0.912795, loss_d: 0.312834
0.3077 --- loss: 1.588721, loss_ss: 0.641843, loss_d: 0.946878
0.3462 --- loss: 1.269990, loss_ss: 0.859219, loss_d: 0.410771
0.3846 --- loss: 1.160954, loss_ss: 0.873976, loss_d: 0.286977
0.4231 --- loss: 1.745740, loss_ss: 1.262230, loss_d: 0.483509
0.4615 --- loss: 1.538292, loss_ss: 1.286279, loss_d: 0.252013
0.5000 --- loss: 0.903525, loss_ss: 0.715576, loss_d: 0.187949
0.5385 --- loss: 1.582197, loss_ss: 1.477925, loss_d: 0.104272
0.5769 --- loss: 1.308476, loss_ss: 1.086895, loss_d: 0.221581
0.6154 --- loss: 1.028796, loss_ss: 0.959800, loss_d: 0.068996
0.6538 --- loss: 0.682552, loss_ss: 0.480400, loss_d: 0.202153
0.6923 --- loss: 1.411527, loss_ss: 0.842624, loss_d: 0.568902
0.7308 --- loss: 0.993176, loss_ss: 0.859276, loss_d: 0.133900
0.7692 --- loss: 1.025203, loss_ss: 0.759303, loss_d: 0.265900
0.8077 --- loss: 0.919273, loss_ss: 0.821459, loss_d: 0.097814
0.8462 --- loss: 1.146323, loss_ss: 0.749475, loss_d: 0.396848
0.8846 --- loss: 0.905809, loss_ss: 0.776158, loss_d: 0.129650
0.9231 --- loss: 1.739347, loss_ss: 0.907813, loss_d: 0.831534
0.9615 --- loss: 1.116355, loss_ss: 0.877909, loss_d: 0.238446
Epoch finished! Loss: 1.1631582556544124
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5421052631578948
             precision    recall  f1-score   support

        0.0       0.12      0.82      0.21        40
        1.0       0.11      0.34      0.17        79
        2.0       0.88      0.79      0.83       553
        3.0       0.98      0.61      0.75        69
        4.0       0.92      0.20      0.33       399

avg / total       0.82      0.54      0.58      1140
 


====== chp001-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  78.86  82.50   78.73  12.36     21.50
1  76.32  34.18   79.45  11.02     16.67
2  84.21  78.66   89.44  87.53     82.86
3  97.54  60.87   99.91  97.67     75.00
4  71.49  20.30   99.06  92.05     33.26
Total accuracy: 54.21%
Average sen: 55.30%
Average spec: 89.32%
Macro f1-score: 45.86%
Diagnosis acc on 15mins: 1.0
[0.99457824 0.9999994  0.9999994  0.99991715 0.99999928 0.99965668
 0.99970466 0.99999225 0.99999285 0.99999905 0.99999547 0.93393594
 0.83261091 0.9991684  0.99967635 0.99998772 0.99999774 0.99998629
 0.9999789  0.97904944 0.9999994  0.99998963 0.99618715 0.99997258
 0.9999975  0.86927509 0.99999952 0.99999976 0.99999809 0.99994361
 0.99995744 0.99999809 0.99998081 0.99998236 0.99999738 0.99995816
 0.96125722 0.92412758]
pred: 0.986548618266457, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp002-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.349397, loss_ss: 1.653518, loss_d: 0.695879
0.0384 --- loss: 2.235564, loss_ss: 1.695550, loss_d: 0.540014
0.0769 --- loss: 2.126346, loss_ss: 1.685343, loss_d: 0.441003
0.1153 --- loss: 1.998782, loss_ss: 1.511709, loss_d: 0.487073
0.1537 --- loss: 2.228893, loss_ss: 1.450119, loss_d: 0.778774
0.1922 --- loss: 2.126859, loss_ss: 1.456947, loss_d: 0.669912
0.2306 --- loss: 1.884600, loss_ss: 1.389164, loss_d: 0.495437
0.2690 --- loss: 2.212339, loss_ss: 1.642227, loss_d: 0.570112
0.3075 --- loss: 2.189815, loss_ss: 1.339634, loss_d: 0.850181
0.3459 --- loss: 1.885994, loss_ss: 1.414405, loss_d: 0.471589
0.3843 --- loss: 1.848171, loss_ss: 1.443568, loss_d: 0.404603
0.4228 --- loss: 1.838955, loss_ss: 1.336512, loss_d: 0.502443
0.4612 --- loss: 1.953607, loss_ss: 1.283167, loss_d: 0.670440
0.4996 --- loss: 1.923072, loss_ss: 1.315367, loss_d: 0.607705
0.5380 --- loss: 2.078345, loss_ss: 1.306946, loss_d: 0.771399
0.5765 --- loss: 1.997428, loss_ss: 1.280241, loss_d: 0.717188
0.6149 --- loss: 1.838472, loss_ss: 1.418961, loss_d: 0.419512
0.6533 --- loss: 1.750706, loss_ss: 1.186285, loss_d: 0.564422
0.6918 --- loss: 1.831760, loss_ss: 1.274826, loss_d: 0.556934
0.7302 --- loss: 2.088957, loss_ss: 1.580603, loss_d: 0.508354
0.7686 --- loss: 1.939710, loss_ss: 1.329727, loss_d: 0.609983
0.8071 --- loss: 2.156075, loss_ss: 1.384041, loss_d: 0.772034
0.8455 --- loss: 1.641425, loss_ss: 1.183157, loss_d: 0.458268
0.8839 --- loss: 1.802049, loss_ss: 1.218176, loss_d: 0.583873
0.9224 --- loss: 1.872902, loss_ss: 1.194376, loss_d: 0.678526
0.9608 --- loss: 1.778122, loss_ss: 1.102583, loss_d: 0.675539
0.9992 --- loss: 1.871863, loss_ss: 1.576280, loss_d: 0.295582
Epoch finished! Loss: 1.9710197118612436
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.811908, loss_ss: 1.423124, loss_d: 0.388784
0.0384 --- loss: 1.885437, loss_ss: 1.082260, loss_d: 0.803177
0.0769 --- loss: 1.740244, loss_ss: 1.116681, loss_d: 0.623563
0.1153 --- loss: 1.926236, loss_ss: 1.306291, loss_d: 0.619944
0.1537 --- loss: 1.587054, loss_ss: 1.067731, loss_d: 0.519323
0.1922 --- loss: 1.613402, loss_ss: 1.137934, loss_d: 0.475468
0.2306 --- loss: 2.088125, loss_ss: 1.164965, loss_d: 0.923160
0.2690 --- loss: 1.528870, loss_ss: 1.121690, loss_d: 0.407180
0.3075 --- loss: 1.942708, loss_ss: 1.295910, loss_d: 0.646798
0.3459 --- loss: 1.696880, loss_ss: 1.169258, loss_d: 0.527622
0.3843 --- loss: 1.427299, loss_ss: 0.933336, loss_d: 0.493962
0.4228 --- loss: 2.140816, loss_ss: 1.247002, loss_d: 0.893815
0.4612 --- loss: 1.714564, loss_ss: 1.015409, loss_d: 0.699155
0.4996 --- loss: 1.656646, loss_ss: 1.202920, loss_d: 0.453726
0.5380 --- loss: 1.886554, loss_ss: 1.161407, loss_d: 0.725147
0.5765 --- loss: 2.007217, loss_ss: 1.042469, loss_d: 0.964749
0.6149 --- loss: 2.058285, loss_ss: 1.461056, loss_d: 0.597229
0.6533 --- loss: 1.453006, loss_ss: 1.037447, loss_d: 0.415558
0.6918 --- loss: 1.663743, loss_ss: 1.105765, loss_d: 0.557978
0.7302 --- loss: 1.895823, loss_ss: 1.019285, loss_d: 0.876539
0.7686 --- loss: 1.848706, loss_ss: 1.318186, loss_d: 0.530520
0.8071 --- loss: 1.515043, loss_ss: 0.985390, loss_d: 0.529653
0.8455 --- loss: 1.721864, loss_ss: 1.192107, loss_d: 0.529756
0.8839 --- loss: 1.340332, loss_ss: 0.864413, loss_d: 0.475919
0.9224 --- loss: 2.155688, loss_ss: 1.247831, loss_d: 0.907857
0.9608 --- loss: 1.690846, loss_ss: 1.143081, loss_d: 0.547765
0.9992 --- loss: 1.335762, loss_ss: 1.018157, loss_d: 0.317605
Epoch finished! Loss: 1.713128489255905
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.357721, loss_ss: 0.914238, loss_d: 0.443483
0.0384 --- loss: 1.519188, loss_ss: 0.970907, loss_d: 0.548281
0.0769 --- loss: 1.480489, loss_ss: 1.045099, loss_d: 0.435390
0.1153 --- loss: 2.016847, loss_ss: 1.109891, loss_d: 0.906956
0.1537 --- loss: 2.086053, loss_ss: 1.075118, loss_d: 1.010934
0.1922 --- loss: 1.505071, loss_ss: 0.936797, loss_d: 0.568275
0.2306 --- loss: 1.660780, loss_ss: 0.813822, loss_d: 0.846958
0.2690 --- loss: 1.581284, loss_ss: 1.017849, loss_d: 0.563435
0.3075 --- loss: 1.866756, loss_ss: 1.163484, loss_d: 0.703273
0.3459 --- loss: 1.683358, loss_ss: 0.982772, loss_d: 0.700586
0.3843 --- loss: 1.818882, loss_ss: 1.005888, loss_d: 0.812994
0.4228 --- loss: 1.410300, loss_ss: 0.796838, loss_d: 0.613461
0.4612 --- loss: 1.933953, loss_ss: 1.393011, loss_d: 0.540941
0.4996 --- loss: 1.647742, loss_ss: 1.259968, loss_d: 0.387774
0.5380 --- loss: 1.420689, loss_ss: 0.763055, loss_d: 0.657634
0.5765 --- loss: 1.604758, loss_ss: 1.129056, loss_d: 0.475702
0.6149 --- loss: 1.919878, loss_ss: 1.185575, loss_d: 0.734304
0.6533 --- loss: 1.794838, loss_ss: 1.276814, loss_d: 0.518025
0.6918 --- loss: 1.423241, loss_ss: 0.987550, loss_d: 0.435690
0.7302 --- loss: 2.191099, loss_ss: 1.766849, loss_d: 0.424251
0.7686 --- loss: 1.478667, loss_ss: 1.051545, loss_d: 0.427122
0.8071 --- loss: 1.484763, loss_ss: 1.019457, loss_d: 0.465306
0.8455 --- loss: 1.486531, loss_ss: 0.788001, loss_d: 0.698530
0.8839 --- loss: 1.743963, loss_ss: 1.262839, loss_d: 0.481124
0.9224 --- loss: 1.473182, loss_ss: 1.043528, loss_d: 0.429654
0.9608 --- loss: 1.212216, loss_ss: 0.901124, loss_d: 0.311092
0.9992 --- loss: 1.839226, loss_ss: 1.537115, loss_d: 0.302111
Epoch finished! Loss: 1.6285426396590013
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.895306, loss_ss: 1.177689, loss_d: 0.717617
0.0384 --- loss: 1.750824, loss_ss: 0.936654, loss_d: 0.814170
0.0769 --- loss: 1.467530, loss_ss: 0.940980, loss_d: 0.526550
0.1153 --- loss: 1.703985, loss_ss: 1.295505, loss_d: 0.408480
0.1537 --- loss: 1.420175, loss_ss: 0.975441, loss_d: 0.444735
0.1922 --- loss: 1.330493, loss_ss: 0.858373, loss_d: 0.472120
0.2306 --- loss: 1.419999, loss_ss: 0.917792, loss_d: 0.502207
0.2690 --- loss: 1.402515, loss_ss: 0.810540, loss_d: 0.591975
0.3075 --- loss: 1.690725, loss_ss: 1.124435, loss_d: 0.566290
0.3459 --- loss: 1.394967, loss_ss: 1.086821, loss_d: 0.308147
0.3843 --- loss: 1.389781, loss_ss: 0.862643, loss_d: 0.527138
0.4228 --- loss: 1.668152, loss_ss: 1.045755, loss_d: 0.622398
0.4612 --- loss: 1.645649, loss_ss: 1.177178, loss_d: 0.468471
0.4996 --- loss: 1.486376, loss_ss: 0.979370, loss_d: 0.507007
0.5380 --- loss: 1.523723, loss_ss: 1.080152, loss_d: 0.443571
0.5765 --- loss: 1.255369, loss_ss: 0.986542, loss_d: 0.268827
0.6149 --- loss: 1.029066, loss_ss: 0.763216, loss_d: 0.265850
0.6533 --- loss: 1.820225, loss_ss: 0.940548, loss_d: 0.879677
0.6918 --- loss: 1.825515, loss_ss: 1.160079, loss_d: 0.665437
0.7302 --- loss: 1.689739, loss_ss: 1.143542, loss_d: 0.546197
0.7686 --- loss: 1.523415, loss_ss: 0.832433, loss_d: 0.690982
0.8071 --- loss: 1.438886, loss_ss: 1.000981, loss_d: 0.437905
0.8455 --- loss: 1.343639, loss_ss: 0.951714, loss_d: 0.391925
0.8839 --- loss: 1.256821, loss_ss: 0.884663, loss_d: 0.372158
0.9224 --- loss: 1.364277, loss_ss: 0.962469, loss_d: 0.401808
0.9608 --- loss: 1.628030, loss_ss: 1.181923, loss_d: 0.446108
0.9992 --- loss: 1.857213, loss_ss: 1.317692, loss_d: 0.539521
Epoch finished! Loss: 1.5260564336409936
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.459088, loss_ss: 1.108284, loss_d: 0.350804
0.0384 --- loss: 1.668649, loss_ss: 1.270123, loss_d: 0.398526
0.0769 --- loss: 1.884985, loss_ss: 0.961789, loss_d: 0.923195
0.1153 --- loss: 1.341063, loss_ss: 1.023270, loss_d: 0.317793
0.1537 --- loss: 1.250658, loss_ss: 0.908945, loss_d: 0.341713
0.1922 --- loss: 1.201066, loss_ss: 0.849934, loss_d: 0.351132
0.2306 --- loss: 1.816923, loss_ss: 1.198606, loss_d: 0.618317
0.2690 --- loss: 1.592032, loss_ss: 1.254488, loss_d: 0.337544
0.3075 --- loss: 1.151145, loss_ss: 0.829287, loss_d: 0.321858
0.3459 --- loss: 1.147151, loss_ss: 0.931048, loss_d: 0.216103
0.3843 --- loss: 1.189008, loss_ss: 0.863576, loss_d: 0.325432
0.4228 --- loss: 1.167570, loss_ss: 0.923835, loss_d: 0.243735
0.4612 --- loss: 1.294019, loss_ss: 1.016237, loss_d: 0.277783
0.4996 --- loss: 0.828629, loss_ss: 0.656304, loss_d: 0.172326
0.5380 --- loss: 1.655640, loss_ss: 0.817625, loss_d: 0.838016
0.5765 --- loss: 1.782057, loss_ss: 0.839191, loss_d: 0.942866
0.6149 --- loss: 1.234550, loss_ss: 0.951565, loss_d: 0.282985
0.6533 --- loss: 1.252719, loss_ss: 0.842816, loss_d: 0.409903
0.6918 --- loss: 1.927003, loss_ss: 1.046624, loss_d: 0.880379
0.7302 --- loss: 1.547257, loss_ss: 0.839950, loss_d: 0.707307
0.7686 --- loss: 1.408166, loss_ss: 0.962338, loss_d: 0.445828
0.8071 --- loss: 1.427676, loss_ss: 1.026755, loss_d: 0.400921
0.8455 --- loss: 1.157376, loss_ss: 0.796040, loss_d: 0.361337
0.8839 --- loss: 2.267553, loss_ss: 1.506103, loss_d: 0.761450
0.9224 --- loss: 1.485507, loss_ss: 1.227056, loss_d: 0.258450
0.9608 --- loss: 1.467803, loss_ss: 0.883297, loss_d: 0.584506
0.9992 --- loss: 2.160414, loss_ss: 1.776217, loss_d: 0.384198
Epoch finished! Loss: 1.423137753055646
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.224733, loss_ss: 0.723073, loss_d: 0.501660
0.0384 --- loss: 1.045431, loss_ss: 0.737929, loss_d: 0.307502
0.0769 --- loss: 1.033803, loss_ss: 0.711650, loss_d: 0.322153
0.1153 --- loss: 1.350902, loss_ss: 0.724359, loss_d: 0.626544
0.1537 --- loss: 0.944551, loss_ss: 0.771983, loss_d: 0.172568
0.1922 --- loss: 1.255301, loss_ss: 0.846874, loss_d: 0.408427
0.2306 --- loss: 1.111900, loss_ss: 0.948611, loss_d: 0.163290
0.2690 --- loss: 0.926954, loss_ss: 0.770363, loss_d: 0.156591
0.3075 --- loss: 0.961751, loss_ss: 0.791767, loss_d: 0.169984
0.3459 --- loss: 1.322063, loss_ss: 1.039628, loss_d: 0.282435
0.3843 --- loss: 1.077627, loss_ss: 0.813652, loss_d: 0.263976
0.4228 --- loss: 1.105787, loss_ss: 0.863232, loss_d: 0.242555
0.4612 --- loss: 2.005458, loss_ss: 0.965121, loss_d: 1.040336
0.4996 --- loss: 1.701609, loss_ss: 1.298464, loss_d: 0.403145
0.5380 --- loss: 0.920160, loss_ss: 0.677794, loss_d: 0.242365
0.5765 --- loss: 1.118473, loss_ss: 0.620826, loss_d: 0.497646
0.6149 --- loss: 1.042297, loss_ss: 0.829375, loss_d: 0.212922
0.6533 --- loss: 1.432991, loss_ss: 1.119022, loss_d: 0.313968
0.6918 --- loss: 1.164353, loss_ss: 0.771111, loss_d: 0.393242
0.7302 --- loss: 1.242957, loss_ss: 0.812524, loss_d: 0.430433
0.7686 --- loss: 1.472326, loss_ss: 0.922335, loss_d: 0.549991
0.8071 --- loss: 0.914576, loss_ss: 0.680026, loss_d: 0.234550
0.8455 --- loss: 1.302767, loss_ss: 0.913494, loss_d: 0.389273
0.8839 --- loss: 1.235122, loss_ss: 0.812483, loss_d: 0.422639
0.9224 --- loss: 1.149514, loss_ss: 0.895710, loss_d: 0.253804
0.9608 --- loss: 1.384610, loss_ss: 0.876852, loss_d: 0.507758
0.9992 --- loss: 3.441904, loss_ss: 0.792870, loss_d: 2.649034
Epoch finished! Loss: 1.3285026034483542
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.460327, loss_ss: 0.660444, loss_d: 0.799882
0.0384 --- loss: 1.137260, loss_ss: 0.874257, loss_d: 0.263004
0.0769 --- loss: 1.655837, loss_ss: 1.207653, loss_d: 0.448184
0.1153 --- loss: 1.167720, loss_ss: 0.888386, loss_d: 0.279334
0.1537 --- loss: 1.331621, loss_ss: 1.007397, loss_d: 0.324224
0.1922 --- loss: 0.988754, loss_ss: 0.807326, loss_d: 0.181428
0.2306 --- loss: 1.051114, loss_ss: 0.752243, loss_d: 0.298870
0.2690 --- loss: 1.186985, loss_ss: 0.965179, loss_d: 0.221806
0.3075 --- loss: 1.055149, loss_ss: 0.660300, loss_d: 0.394849
0.3459 --- loss: 1.409770, loss_ss: 1.118804, loss_d: 0.290966
0.3843 --- loss: 1.065912, loss_ss: 0.917916, loss_d: 0.147996
0.4228 --- loss: 1.227483, loss_ss: 0.764756, loss_d: 0.462727
0.4612 --- loss: 1.589005, loss_ss: 1.184931, loss_d: 0.404074
0.4996 --- loss: 1.130982, loss_ss: 0.721574, loss_d: 0.409408
0.5380 --- loss: 1.334619, loss_ss: 0.823273, loss_d: 0.511346
0.5765 --- loss: 1.111757, loss_ss: 0.850478, loss_d: 0.261279
0.6149 --- loss: 1.194088, loss_ss: 0.882328, loss_d: 0.311761
0.6533 --- loss: 1.112647, loss_ss: 0.858104, loss_d: 0.254542
0.6918 --- loss: 1.453572, loss_ss: 1.165680, loss_d: 0.287893
0.7302 --- loss: 1.203660, loss_ss: 1.052845, loss_d: 0.150815
0.7686 --- loss: 1.077215, loss_ss: 0.721162, loss_d: 0.356052
0.8071 --- loss: 1.409779, loss_ss: 0.824491, loss_d: 0.585288
0.8455 --- loss: 0.983335, loss_ss: 0.865928, loss_d: 0.117407
0.8839 --- loss: 1.050873, loss_ss: 0.834967, loss_d: 0.215906
0.9224 --- loss: 1.159706, loss_ss: 0.681781, loss_d: 0.477925
0.9608 --- loss: 0.936347, loss_ss: 0.721898, loss_d: 0.214449
0.9992 --- loss: 1.884629, loss_ss: 1.569892, loss_d: 0.314737
Epoch finished! Loss: 1.2671799982969578
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.016215, loss_ss: 0.811091, loss_d: 0.205124
0.0384 --- loss: 1.562242, loss_ss: 0.791016, loss_d: 0.771225
0.0769 --- loss: 1.217817, loss_ss: 0.957355, loss_d: 0.260462
0.1153 --- loss: 1.325946, loss_ss: 1.136954, loss_d: 0.188992
0.1537 --- loss: 0.974531, loss_ss: 0.759584, loss_d: 0.214946
0.1922 --- loss: 1.619154, loss_ss: 1.128636, loss_d: 0.490518
0.2306 --- loss: 1.363057, loss_ss: 0.953697, loss_d: 0.409360
0.2690 --- loss: 1.402357, loss_ss: 1.208763, loss_d: 0.193593
0.3075 --- loss: 1.293283, loss_ss: 0.920678, loss_d: 0.372605
0.3459 --- loss: 1.257564, loss_ss: 0.798167, loss_d: 0.459397
0.3843 --- loss: 1.174365, loss_ss: 0.958320, loss_d: 0.216044
0.4228 --- loss: 0.977055, loss_ss: 0.736618, loss_d: 0.240437
0.4612 --- loss: 1.078946, loss_ss: 0.789356, loss_d: 0.289590
0.4996 --- loss: 1.406614, loss_ss: 0.975198, loss_d: 0.431416
0.5380 --- loss: 1.161084, loss_ss: 0.887759, loss_d: 0.273325
0.5765 --- loss: 1.626058, loss_ss: 0.765800, loss_d: 0.860257
0.6149 --- loss: 1.437903, loss_ss: 0.804457, loss_d: 0.633446
0.6533 --- loss: 0.816403, loss_ss: 0.718514, loss_d: 0.097889
0.6918 --- loss: 1.643104, loss_ss: 1.017213, loss_d: 0.625891
0.7302 --- loss: 1.268726, loss_ss: 0.907363, loss_d: 0.361363
0.7686 --- loss: 1.284357, loss_ss: 0.911668, loss_d: 0.372689
0.8071 --- loss: 1.430326, loss_ss: 0.975407, loss_d: 0.454919
0.8455 --- loss: 1.049264, loss_ss: 0.759764, loss_d: 0.289500
0.8839 --- loss: 1.021817, loss_ss: 0.852627, loss_d: 0.169190
0.9224 --- loss: 1.038212, loss_ss: 0.843809, loss_d: 0.194403
0.9608 --- loss: 0.967226, loss_ss: 0.780852, loss_d: 0.186374
0.9992 --- loss: 1.774494, loss_ss: 1.380421, loss_d: 0.394073
Epoch finished! Loss: 1.2308874251750799
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.432142, loss_ss: 1.055013, loss_d: 0.377129
0.0384 --- loss: 1.122954, loss_ss: 0.695491, loss_d: 0.427463
0.0769 --- loss: 1.430983, loss_ss: 0.962656, loss_d: 0.468326
0.1153 --- loss: 1.034114, loss_ss: 0.806568, loss_d: 0.227546
0.1537 --- loss: 1.178394, loss_ss: 0.930068, loss_d: 0.248326
0.1922 --- loss: 1.049784, loss_ss: 0.854358, loss_d: 0.195426
0.2306 --- loss: 0.991622, loss_ss: 0.740874, loss_d: 0.250748
0.2690 --- loss: 0.980748, loss_ss: 0.753223, loss_d: 0.227525
0.3075 --- loss: 1.212514, loss_ss: 1.019512, loss_d: 0.193002
0.3459 --- loss: 1.111696, loss_ss: 0.789330, loss_d: 0.322367
0.3843 --- loss: 0.961974, loss_ss: 0.677869, loss_d: 0.284105
0.4228 --- loss: 1.508047, loss_ss: 0.971894, loss_d: 0.536153
0.4612 --- loss: 1.374142, loss_ss: 0.856649, loss_d: 0.517493
0.4996 --- loss: 1.645514, loss_ss: 1.082993, loss_d: 0.562521
0.5380 --- loss: 1.428622, loss_ss: 1.016868, loss_d: 0.411754
0.5765 --- loss: 1.025424, loss_ss: 0.821919, loss_d: 0.203505
0.6149 --- loss: 1.496296, loss_ss: 0.946152, loss_d: 0.550144
0.6533 --- loss: 0.965346, loss_ss: 0.845123, loss_d: 0.120223
0.6918 --- loss: 1.011950, loss_ss: 0.912546, loss_d: 0.099404
0.7302 --- loss: 0.936055, loss_ss: 0.662008, loss_d: 0.274046
0.7686 --- loss: 1.104732, loss_ss: 0.883176, loss_d: 0.221556
0.8071 --- loss: 1.031447, loss_ss: 0.767720, loss_d: 0.263728
0.8455 --- loss: 1.022792, loss_ss: 0.853953, loss_d: 0.168838
0.8839 --- loss: 1.591432, loss_ss: 0.769703, loss_d: 0.821729
0.9224 --- loss: 1.210075, loss_ss: 0.836812, loss_d: 0.373263
0.9608 --- loss: 0.936152, loss_ss: 0.796493, loss_d: 0.139660
0.9992 --- loss: 1.261499, loss_ss: 1.059045, loss_d: 0.202454
Epoch finished! Loss: 1.1814253463194921
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.978267, loss_ss: 0.661964, loss_d: 0.316303
0.0384 --- loss: 0.935214, loss_ss: 0.825257, loss_d: 0.109957
0.0769 --- loss: 1.104574, loss_ss: 0.828402, loss_d: 0.276172
0.1153 --- loss: 1.111226, loss_ss: 0.940341, loss_d: 0.170885
0.1537 --- loss: 1.105359, loss_ss: 0.725732, loss_d: 0.379627
0.1922 --- loss: 1.374806, loss_ss: 0.712214, loss_d: 0.662592
0.2306 --- loss: 1.479036, loss_ss: 0.806846, loss_d: 0.672190
0.2690 --- loss: 1.466110, loss_ss: 1.028161, loss_d: 0.437949
0.3075 --- loss: 0.953377, loss_ss: 0.770420, loss_d: 0.182957
0.3459 --- loss: 1.315489, loss_ss: 0.951147, loss_d: 0.364342
0.3843 --- loss: 0.846869, loss_ss: 0.742303, loss_d: 0.104567
0.4228 --- loss: 1.078635, loss_ss: 0.944489, loss_d: 0.134147
0.4612 --- loss: 1.047744, loss_ss: 0.867139, loss_d: 0.180605
0.4996 --- loss: 1.028828, loss_ss: 0.646782, loss_d: 0.382045
0.5380 --- loss: 1.575334, loss_ss: 0.927608, loss_d: 0.647726
0.5765 --- loss: 0.824113, loss_ss: 0.675165, loss_d: 0.148948
0.6149 --- loss: 1.081822, loss_ss: 0.821382, loss_d: 0.260439
0.6533 --- loss: 1.077232, loss_ss: 0.879544, loss_d: 0.197687
0.6918 --- loss: 1.084799, loss_ss: 0.911913, loss_d: 0.172887
0.7302 --- loss: 0.752378, loss_ss: 0.675011, loss_d: 0.077367
0.7686 --- loss: 1.376995, loss_ss: 1.148661, loss_d: 0.228335
0.8071 --- loss: 1.149030, loss_ss: 0.621592, loss_d: 0.527438
0.8455 --- loss: 0.998254, loss_ss: 0.773475, loss_d: 0.224779
0.8839 --- loss: 0.722528, loss_ss: 0.581622, loss_d: 0.140906
0.9224 --- loss: 1.319757, loss_ss: 0.990370, loss_d: 0.329387
0.9608 --- loss: 1.026146, loss_ss: 0.854007, loss_d: 0.172139
0.9992 --- loss: 2.417703, loss_ss: 2.361886, loss_d: 0.055817
Epoch finished! Loss: 1.1501614229037211
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6916666666666667
             precision    recall  f1-score   support

        0.0       0.75      0.61      0.68       260
        1.0       0.86      0.24      0.38       248
        2.0       0.75      0.99      0.86       375
        3.0       1.00      0.79      0.88       169
        4.0       0.13      0.82      0.23        28

avg / total       0.80      0.69      0.69      1080
 


====== chp002-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  85.83  61.15   93.66   75.36     67.52
1  81.67  24.19   98.80   85.71     37.74
2  88.43  98.93   82.84   75.41     85.58
3  96.76  79.29  100.00  100.00     88.45
4  85.65  82.14   85.74   13.29     22.89
Total accuracy: 69.17%
Average sen: 69.14%
Average spec: 92.21%
Macro f1-score: 60.43%
Diagnosis acc on 15mins: 0.7777777777777778
[0.95020908 0.82952201 0.99695969 0.99906415 0.99921083 0.96337622
 0.48751011 0.69285583 0.73609978 0.46584335 0.9170413  0.99201983
 0.40556407 0.9974106  0.75591719 0.86709356 0.99974555 0.99781895
 0.99998641 0.9999975  0.9954347  0.95465893 0.98060697 0.73916119
 0.16853148 0.90692997 0.92794603 0.30655327 0.29310799 0.89833939
 0.93748772 0.93428785 0.901196   0.74185759 0.49999785 0.48434347]
pred: 0.7978801785243882, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp003-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.234468, loss_ss: 1.521568, loss_d: 0.712901
0.0384 --- loss: 3.160706, loss_ss: 1.523542, loss_d: 1.637164
0.0768 --- loss: 1.865641, loss_ss: 1.376581, loss_d: 0.489060
0.1152 --- loss: 2.334937, loss_ss: 1.668681, loss_d: 0.666256
0.1536 --- loss: 2.159699, loss_ss: 1.298411, loss_d: 0.861288
0.1919 --- loss: 2.019488, loss_ss: 1.281773, loss_d: 0.737715
0.2303 --- loss: 1.849062, loss_ss: 1.347695, loss_d: 0.501367
0.2687 --- loss: 1.867064, loss_ss: 1.418570, loss_d: 0.448494
0.3071 --- loss: 1.923436, loss_ss: 1.251867, loss_d: 0.671569
0.3455 --- loss: 1.935689, loss_ss: 1.250947, loss_d: 0.684742
0.3839 --- loss: 1.881878, loss_ss: 1.370756, loss_d: 0.511123
0.4223 --- loss: 2.219090, loss_ss: 1.338371, loss_d: 0.880719
0.4607 --- loss: 1.865274, loss_ss: 1.396295, loss_d: 0.468979
0.4990 --- loss: 1.971810, loss_ss: 1.413964, loss_d: 0.557846
0.5374 --- loss: 1.918117, loss_ss: 1.342228, loss_d: 0.575889
0.5758 --- loss: 1.745425, loss_ss: 1.240385, loss_d: 0.505040
0.6142 --- loss: 1.872495, loss_ss: 1.227908, loss_d: 0.644587
0.6526 --- loss: 1.706532, loss_ss: 1.145963, loss_d: 0.560569
0.6910 --- loss: 1.801624, loss_ss: 1.295991, loss_d: 0.505632
0.7294 --- loss: 1.757282, loss_ss: 1.212387, loss_d: 0.544895
0.7678 --- loss: 1.642419, loss_ss: 1.160922, loss_d: 0.481497
0.8061 --- loss: 1.757426, loss_ss: 1.298656, loss_d: 0.458769
0.8445 --- loss: 1.584945, loss_ss: 1.107049, loss_d: 0.477896
0.8829 --- loss: 2.095039, loss_ss: 1.126993, loss_d: 0.968046
0.9213 --- loss: 1.898095, loss_ss: 1.187664, loss_d: 0.710431
0.9597 --- loss: 1.592269, loss_ss: 1.138097, loss_d: 0.454172
0.9981 --- loss: 2.108731, loss_ss: 1.667808, loss_d: 0.440923
Epoch finished! Loss: 1.925737846814669
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.813052, loss_ss: 1.267730, loss_d: 0.545322
0.0384 --- loss: 2.255031, loss_ss: 1.178360, loss_d: 1.076671
0.0768 --- loss: 1.684143, loss_ss: 1.038290, loss_d: 0.645853
0.1152 --- loss: 1.792614, loss_ss: 1.190144, loss_d: 0.602470
0.1536 --- loss: 1.955990, loss_ss: 1.528272, loss_d: 0.427718
0.1919 --- loss: 1.796710, loss_ss: 1.353136, loss_d: 0.443575
0.2303 --- loss: 1.552130, loss_ss: 1.216701, loss_d: 0.335429
0.2687 --- loss: 1.605795, loss_ss: 1.044147, loss_d: 0.561648
0.3071 --- loss: 1.733390, loss_ss: 1.156803, loss_d: 0.576587
0.3455 --- loss: 1.763049, loss_ss: 1.186444, loss_d: 0.576605
0.3839 --- loss: 1.628776, loss_ss: 1.142493, loss_d: 0.486283
0.4223 --- loss: 1.468882, loss_ss: 1.029483, loss_d: 0.439399
0.4607 --- loss: 1.800446, loss_ss: 1.227209, loss_d: 0.573237
0.4990 --- loss: 1.550629, loss_ss: 1.154684, loss_d: 0.395945
0.5374 --- loss: 1.844749, loss_ss: 1.362126, loss_d: 0.482623
0.5758 --- loss: 2.091644, loss_ss: 1.372250, loss_d: 0.719393
0.6142 --- loss: 1.625073, loss_ss: 1.181495, loss_d: 0.443578
0.6526 --- loss: 1.875465, loss_ss: 1.061502, loss_d: 0.813963
0.6910 --- loss: 1.489927, loss_ss: 1.027566, loss_d: 0.462361
0.7294 --- loss: 1.843641, loss_ss: 1.076802, loss_d: 0.766838
0.7678 --- loss: 1.776359, loss_ss: 1.124835, loss_d: 0.651524
0.8061 --- loss: 1.431972, loss_ss: 0.995884, loss_d: 0.436088
0.8445 --- loss: 1.738038, loss_ss: 1.193692, loss_d: 0.544347
0.8829 --- loss: 1.614904, loss_ss: 1.090166, loss_d: 0.524738
0.9213 --- loss: 1.789006, loss_ss: 1.183865, loss_d: 0.605140
0.9597 --- loss: 1.905346, loss_ss: 1.030858, loss_d: 0.874488
0.9981 --- loss: 1.690493, loss_ss: 1.050569, loss_d: 0.639924
Epoch finished! Loss: 1.734805778815196
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.429643, loss_ss: 1.014122, loss_d: 0.415521
0.0384 --- loss: 2.076065, loss_ss: 1.270795, loss_d: 0.805271
0.0768 --- loss: 1.566213, loss_ss: 1.101401, loss_d: 0.464812
0.1152 --- loss: 1.754441, loss_ss: 1.113585, loss_d: 0.640856
0.1536 --- loss: 1.446158, loss_ss: 1.026301, loss_d: 0.419857
0.1919 --- loss: 1.498590, loss_ss: 1.003724, loss_d: 0.494866
0.2303 --- loss: 1.417608, loss_ss: 1.086496, loss_d: 0.331112
0.2687 --- loss: 1.764521, loss_ss: 1.289003, loss_d: 0.475518
0.3071 --- loss: 1.923160, loss_ss: 1.059765, loss_d: 0.863395
0.3455 --- loss: 1.544465, loss_ss: 0.956463, loss_d: 0.588002
0.3839 --- loss: 1.803292, loss_ss: 1.158903, loss_d: 0.644389
0.4223 --- loss: 1.344123, loss_ss: 0.959598, loss_d: 0.384525
0.4607 --- loss: 1.352328, loss_ss: 0.901084, loss_d: 0.451244
0.4990 --- loss: 1.505609, loss_ss: 0.916489, loss_d: 0.589120
0.5374 --- loss: 1.298834, loss_ss: 1.008327, loss_d: 0.290507
0.5758 --- loss: 1.632164, loss_ss: 0.986818, loss_d: 0.645346
0.6142 --- loss: 1.432362, loss_ss: 0.959960, loss_d: 0.472402
0.6526 --- loss: 1.417620, loss_ss: 1.042115, loss_d: 0.375505
0.6910 --- loss: 1.663598, loss_ss: 1.340529, loss_d: 0.323069
0.7294 --- loss: 1.618391, loss_ss: 1.090874, loss_d: 0.527517
0.7678 --- loss: 1.228327, loss_ss: 0.937009, loss_d: 0.291318
0.8061 --- loss: 1.751970, loss_ss: 1.073012, loss_d: 0.678957
0.8445 --- loss: 1.316909, loss_ss: 0.928092, loss_d: 0.388817
0.8829 --- loss: 1.546917, loss_ss: 0.826209, loss_d: 0.720708
0.9213 --- loss: 1.289720, loss_ss: 0.894093, loss_d: 0.395627
0.9597 --- loss: 1.736190, loss_ss: 1.133964, loss_d: 0.602226
0.9981 --- loss: 1.686499, loss_ss: 1.342152, loss_d: 0.344347
Epoch finished! Loss: 1.6063888980792118
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.446604, loss_ss: 0.983809, loss_d: 0.462795
0.0384 --- loss: 1.218624, loss_ss: 0.917239, loss_d: 0.301384
0.0768 --- loss: 1.331574, loss_ss: 0.967811, loss_d: 0.363763
0.1152 --- loss: 1.738058, loss_ss: 0.946935, loss_d: 0.791123
0.1536 --- loss: 1.716657, loss_ss: 0.837502, loss_d: 0.879155
0.1919 --- loss: 1.912710, loss_ss: 1.211539, loss_d: 0.701170
0.2303 --- loss: 1.536345, loss_ss: 1.027928, loss_d: 0.508416
0.2687 --- loss: 1.287617, loss_ss: 0.891564, loss_d: 0.396052
0.3071 --- loss: 1.871590, loss_ss: 1.068651, loss_d: 0.802939
0.3455 --- loss: 1.455321, loss_ss: 1.139604, loss_d: 0.315717
0.3839 --- loss: 1.559995, loss_ss: 1.026144, loss_d: 0.533850
0.4223 --- loss: 1.492709, loss_ss: 1.179810, loss_d: 0.312899
0.4607 --- loss: 1.253570, loss_ss: 1.011185, loss_d: 0.242384
0.4990 --- loss: 1.186281, loss_ss: 0.790528, loss_d: 0.395753
0.5374 --- loss: 1.823719, loss_ss: 1.210014, loss_d: 0.613705
0.5758 --- loss: 1.629810, loss_ss: 0.994276, loss_d: 0.635534
0.6142 --- loss: 1.557255, loss_ss: 0.987701, loss_d: 0.569555
0.6526 --- loss: 1.292503, loss_ss: 0.798705, loss_d: 0.493798
0.6910 --- loss: 2.108922, loss_ss: 0.966395, loss_d: 1.142527
0.7294 --- loss: 1.407239, loss_ss: 0.837800, loss_d: 0.569439
0.7678 --- loss: 1.505159, loss_ss: 0.997393, loss_d: 0.507766
0.8061 --- loss: 1.376158, loss_ss: 0.976362, loss_d: 0.399796
0.8445 --- loss: 1.437811, loss_ss: 0.959171, loss_d: 0.478640
0.8829 --- loss: 1.489812, loss_ss: 0.988804, loss_d: 0.501009
0.9213 --- loss: 1.416053, loss_ss: 1.060496, loss_d: 0.355557
0.9597 --- loss: 1.447587, loss_ss: 0.954110, loss_d: 0.493476
0.9981 --- loss: 1.328892, loss_ss: 0.705046, loss_d: 0.623845
Epoch finished! Loss: 1.481357959142098
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.101196, loss_ss: 0.690945, loss_d: 0.410251
0.0384 --- loss: 1.308991, loss_ss: 0.800513, loss_d: 0.508479
0.0768 --- loss: 1.411482, loss_ss: 1.034381, loss_d: 0.377101
0.1152 --- loss: 1.391366, loss_ss: 0.809324, loss_d: 0.582042
0.1536 --- loss: 1.438695, loss_ss: 0.999370, loss_d: 0.439325
0.1919 --- loss: 1.041064, loss_ss: 0.699550, loss_d: 0.341514
0.2303 --- loss: 1.524250, loss_ss: 0.930250, loss_d: 0.594000
0.2687 --- loss: 1.582047, loss_ss: 1.243055, loss_d: 0.338991
0.3071 --- loss: 1.272109, loss_ss: 0.817827, loss_d: 0.454282
0.3455 --- loss: 1.589834, loss_ss: 1.039503, loss_d: 0.550331
0.3839 --- loss: 1.995171, loss_ss: 1.119793, loss_d: 0.875378
0.4223 --- loss: 1.230387, loss_ss: 0.871798, loss_d: 0.358589
0.4607 --- loss: 1.625866, loss_ss: 0.979201, loss_d: 0.646665
0.4990 --- loss: 1.320879, loss_ss: 0.935538, loss_d: 0.385342
0.5374 --- loss: 1.685991, loss_ss: 0.968752, loss_d: 0.717239
0.5758 --- loss: 1.361220, loss_ss: 0.746711, loss_d: 0.614509
0.6142 --- loss: 1.148805, loss_ss: 0.693451, loss_d: 0.455354
0.6526 --- loss: 1.494656, loss_ss: 1.194441, loss_d: 0.300215
0.6910 --- loss: 1.320461, loss_ss: 0.882487, loss_d: 0.437974
0.7294 --- loss: 1.298225, loss_ss: 0.976701, loss_d: 0.321524
0.7678 --- loss: 1.295034, loss_ss: 0.801918, loss_d: 0.493117
0.8061 --- loss: 1.248072, loss_ss: 0.759780, loss_d: 0.488292
0.8445 --- loss: 2.013397, loss_ss: 1.293400, loss_d: 0.719997
0.8829 --- loss: 1.175632, loss_ss: 0.868565, loss_d: 0.307067
0.9213 --- loss: 1.356191, loss_ss: 0.885407, loss_d: 0.470784
0.9597 --- loss: 1.124926, loss_ss: 0.853352, loss_d: 0.271574
0.9981 --- loss: 1.211696, loss_ss: 0.960267, loss_d: 0.251428
Epoch finished! Loss: 1.4282121014136535
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.101725, loss_ss: 0.889200, loss_d: 0.212525
0.0384 --- loss: 1.363774, loss_ss: 1.018027, loss_d: 0.345747
0.0768 --- loss: 1.478405, loss_ss: 1.188292, loss_d: 0.290113
0.1152 --- loss: 1.142262, loss_ss: 0.866373, loss_d: 0.275889
0.1536 --- loss: 1.023902, loss_ss: 0.755181, loss_d: 0.268721
0.1919 --- loss: 1.993648, loss_ss: 1.030544, loss_d: 0.963103
0.2303 --- loss: 1.060341, loss_ss: 0.766811, loss_d: 0.293530
0.2687 --- loss: 1.663758, loss_ss: 1.034635, loss_d: 0.629123
0.3071 --- loss: 1.313587, loss_ss: 0.993844, loss_d: 0.319744
0.3455 --- loss: 1.134324, loss_ss: 0.805032, loss_d: 0.329292
0.3839 --- loss: 1.224615, loss_ss: 0.936287, loss_d: 0.288328
0.4223 --- loss: 1.268367, loss_ss: 1.043196, loss_d: 0.225171
0.4607 --- loss: 1.326954, loss_ss: 0.865952, loss_d: 0.461002
0.4990 --- loss: 1.610861, loss_ss: 0.947254, loss_d: 0.663607
0.5374 --- loss: 1.797421, loss_ss: 1.068749, loss_d: 0.728672
0.5758 --- loss: 1.747526, loss_ss: 1.004310, loss_d: 0.743216
0.6142 --- loss: 1.338919, loss_ss: 0.914251, loss_d: 0.424668
0.6526 --- loss: 1.161593, loss_ss: 0.894504, loss_d: 0.267089
0.6910 --- loss: 1.351364, loss_ss: 0.869898, loss_d: 0.481467
0.7294 --- loss: 1.103632, loss_ss: 0.726928, loss_d: 0.376704
0.7678 --- loss: 1.224646, loss_ss: 0.965632, loss_d: 0.259014
0.8061 --- loss: 1.072507, loss_ss: 0.786084, loss_d: 0.286422
0.8445 --- loss: 1.316769, loss_ss: 1.047822, loss_d: 0.268946
0.8829 --- loss: 1.343935, loss_ss: 1.059411, loss_d: 0.284524
0.9213 --- loss: 1.018761, loss_ss: 0.759298, loss_d: 0.259463
0.9597 --- loss: 0.776325, loss_ss: 0.647933, loss_d: 0.128392
0.9981 --- loss: 1.974190, loss_ss: 1.386292, loss_d: 0.587898
Epoch finished! Loss: 1.3222065567970276
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.083830, loss_ss: 0.695352, loss_d: 0.388478
0.0384 --- loss: 1.152542, loss_ss: 0.726366, loss_d: 0.426176
0.0768 --- loss: 1.283616, loss_ss: 1.025108, loss_d: 0.258507
0.1152 --- loss: 1.137424, loss_ss: 0.848108, loss_d: 0.289316
0.1536 --- loss: 1.303754, loss_ss: 0.967933, loss_d: 0.335822
0.1919 --- loss: 1.211191, loss_ss: 0.838894, loss_d: 0.372297
0.2303 --- loss: 1.469294, loss_ss: 0.768887, loss_d: 0.700407
0.2687 --- loss: 1.261208, loss_ss: 0.913029, loss_d: 0.348179
0.3071 --- loss: 1.589706, loss_ss: 1.284744, loss_d: 0.304962
0.3455 --- loss: 1.260353, loss_ss: 0.973857, loss_d: 0.286496
0.3839 --- loss: 1.095825, loss_ss: 0.934939, loss_d: 0.160886
0.4223 --- loss: 1.389619, loss_ss: 0.883995, loss_d: 0.505624
0.4607 --- loss: 1.456160, loss_ss: 0.762354, loss_d: 0.693805
0.4990 --- loss: 1.421978, loss_ss: 0.969753, loss_d: 0.452225
0.5374 --- loss: 1.274080, loss_ss: 1.032102, loss_d: 0.241978
0.5758 --- loss: 1.354174, loss_ss: 1.068587, loss_d: 0.285587
0.6142 --- loss: 1.114552, loss_ss: 0.757919, loss_d: 0.356633
0.6526 --- loss: 1.262272, loss_ss: 0.601251, loss_d: 0.661021
0.6910 --- loss: 1.436162, loss_ss: 1.180028, loss_d: 0.256134
0.7294 --- loss: 1.631897, loss_ss: 0.913796, loss_d: 0.718101
0.7678 --- loss: 1.344773, loss_ss: 1.007671, loss_d: 0.337102
0.8061 --- loss: 1.104210, loss_ss: 0.813234, loss_d: 0.290976
0.8445 --- loss: 1.040007, loss_ss: 0.769059, loss_d: 0.270949
0.8829 --- loss: 1.009928, loss_ss: 0.678692, loss_d: 0.331236
0.9213 --- loss: 1.039441, loss_ss: 0.704184, loss_d: 0.335258
0.9597 --- loss: 0.920768, loss_ss: 0.712456, loss_d: 0.208312
0.9981 --- loss: 1.074625, loss_ss: 0.809780, loss_d: 0.264845
Epoch finished! Loss: 1.2706411139323162
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.207982, loss_ss: 0.922713, loss_d: 0.285269
0.0384 --- loss: 0.863913, loss_ss: 0.620835, loss_d: 0.243078
0.0768 --- loss: 0.992943, loss_ss: 0.805211, loss_d: 0.187732
0.1152 --- loss: 0.950908, loss_ss: 0.732540, loss_d: 0.218368
0.1536 --- loss: 1.280562, loss_ss: 0.821183, loss_d: 0.459380
0.1919 --- loss: 0.944918, loss_ss: 0.730409, loss_d: 0.214509
0.2303 --- loss: 1.034284, loss_ss: 0.792444, loss_d: 0.241840
0.2687 --- loss: 1.125326, loss_ss: 0.920096, loss_d: 0.205230
0.3071 --- loss: 1.264158, loss_ss: 0.991711, loss_d: 0.272446
0.3455 --- loss: 0.910345, loss_ss: 0.698292, loss_d: 0.212054
0.3839 --- loss: 0.970536, loss_ss: 0.725185, loss_d: 0.245350
0.4223 --- loss: 1.080357, loss_ss: 0.861274, loss_d: 0.219083
0.4607 --- loss: 1.525588, loss_ss: 0.827206, loss_d: 0.698382
0.4990 --- loss: 0.805716, loss_ss: 0.596828, loss_d: 0.208888
0.5374 --- loss: 1.093289, loss_ss: 0.891234, loss_d: 0.202055
0.5758 --- loss: 1.114631, loss_ss: 0.918615, loss_d: 0.196015
0.6142 --- loss: 1.465001, loss_ss: 1.134760, loss_d: 0.330241
0.6526 --- loss: 0.862313, loss_ss: 0.578416, loss_d: 0.283897
0.6910 --- loss: 0.979125, loss_ss: 0.768472, loss_d: 0.210653
0.7294 --- loss: 1.073535, loss_ss: 0.808449, loss_d: 0.265085
0.7678 --- loss: 1.389251, loss_ss: 0.894437, loss_d: 0.494815
0.8061 --- loss: 1.065112, loss_ss: 0.762632, loss_d: 0.302479
0.8445 --- loss: 1.011812, loss_ss: 0.753542, loss_d: 0.258270
0.8829 --- loss: 1.543257, loss_ss: 1.132023, loss_d: 0.411234
0.9213 --- loss: 0.825995, loss_ss: 0.578660, loss_d: 0.247336
0.9597 --- loss: 1.197016, loss_ss: 0.891007, loss_d: 0.306010
0.9981 --- loss: 0.887072, loss_ss: 0.608810, loss_d: 0.278262
Epoch finished! Loss: 1.2276758102270273
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.080385, loss_ss: 0.901840, loss_d: 0.178546
0.0384 --- loss: 1.450446, loss_ss: 0.877179, loss_d: 0.573266
0.0768 --- loss: 1.514397, loss_ss: 1.146979, loss_d: 0.367418
0.1152 --- loss: 0.982335, loss_ss: 0.721320, loss_d: 0.261015
0.1536 --- loss: 1.116758, loss_ss: 0.796653, loss_d: 0.320104
0.1919 --- loss: 1.448555, loss_ss: 0.838265, loss_d: 0.610290
0.2303 --- loss: 0.985188, loss_ss: 0.787213, loss_d: 0.197975
0.2687 --- loss: 1.122142, loss_ss: 0.921720, loss_d: 0.200422
0.3071 --- loss: 0.959600, loss_ss: 0.668576, loss_d: 0.291024
0.3455 --- loss: 1.024712, loss_ss: 0.693403, loss_d: 0.331310
0.3839 --- loss: 1.168997, loss_ss: 0.875989, loss_d: 0.293008
0.4223 --- loss: 1.151805, loss_ss: 0.837574, loss_d: 0.314231
0.4607 --- loss: 1.079964, loss_ss: 0.784504, loss_d: 0.295460
0.4990 --- loss: 1.599524, loss_ss: 1.356890, loss_d: 0.242634
0.5374 --- loss: 1.201212, loss_ss: 0.961442, loss_d: 0.239770
0.5758 --- loss: 1.161660, loss_ss: 0.905117, loss_d: 0.256543
0.6142 --- loss: 1.183832, loss_ss: 0.862978, loss_d: 0.320853
0.6526 --- loss: 1.184760, loss_ss: 0.853475, loss_d: 0.331285
0.6910 --- loss: 1.320894, loss_ss: 0.774826, loss_d: 0.546068
0.7294 --- loss: 1.462074, loss_ss: 1.074917, loss_d: 0.387158
0.7678 --- loss: 1.150933, loss_ss: 0.870259, loss_d: 0.280674
0.8061 --- loss: 1.979282, loss_ss: 0.804577, loss_d: 1.174705
0.8445 --- loss: 1.188598, loss_ss: 0.964312, loss_d: 0.224287
0.8829 --- loss: 0.987872, loss_ss: 0.758091, loss_d: 0.229781
0.9213 --- loss: 0.871639, loss_ss: 0.557218, loss_d: 0.314421
0.9597 --- loss: 1.009746, loss_ss: 0.820587, loss_d: 0.189159
0.9981 --- loss: 1.393272, loss_ss: 0.921932, loss_d: 0.471340
Epoch finished! Loss: 1.1870835104813942
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.470246, loss_ss: 1.110247, loss_d: 0.359999
0.0384 --- loss: 1.172651, loss_ss: 0.938776, loss_d: 0.233875
0.0768 --- loss: 0.980976, loss_ss: 0.772643, loss_d: 0.208333
0.1152 --- loss: 0.961715, loss_ss: 0.778686, loss_d: 0.183029
0.1536 --- loss: 0.972080, loss_ss: 0.758123, loss_d: 0.213957
0.1919 --- loss: 1.401500, loss_ss: 1.193438, loss_d: 0.208062
0.2303 --- loss: 1.216221, loss_ss: 0.959833, loss_d: 0.256388
0.2687 --- loss: 1.106804, loss_ss: 0.899822, loss_d: 0.206982
0.3071 --- loss: 1.792024, loss_ss: 1.229153, loss_d: 0.562871
0.3455 --- loss: 0.963026, loss_ss: 0.739297, loss_d: 0.223729
0.3839 --- loss: 1.322498, loss_ss: 0.992794, loss_d: 0.329704
0.4223 --- loss: 0.945704, loss_ss: 0.698646, loss_d: 0.247058
0.4607 --- loss: 0.930532, loss_ss: 0.723360, loss_d: 0.207172
0.4990 --- loss: 1.078263, loss_ss: 0.833510, loss_d: 0.244752
0.5374 --- loss: 0.953108, loss_ss: 0.671281, loss_d: 0.281826
0.5758 --- loss: 1.226355, loss_ss: 0.879977, loss_d: 0.346379
0.6142 --- loss: 0.866828, loss_ss: 0.667129, loss_d: 0.199700
0.6526 --- loss: 0.843389, loss_ss: 0.626252, loss_d: 0.217137
0.6910 --- loss: 1.236249, loss_ss: 1.024979, loss_d: 0.211270
0.7294 --- loss: 0.848372, loss_ss: 0.651198, loss_d: 0.197174
0.7678 --- loss: 1.256320, loss_ss: 0.713133, loss_d: 0.543188
0.8061 --- loss: 1.190945, loss_ss: 0.887179, loss_d: 0.303766
0.8445 --- loss: 0.989633, loss_ss: 0.799482, loss_d: 0.190151
0.8829 --- loss: 1.343132, loss_ss: 1.000729, loss_d: 0.342403
0.9213 --- loss: 1.005383, loss_ss: 0.825078, loss_d: 0.180305
0.9597 --- loss: 0.810690, loss_ss: 0.652607, loss_d: 0.158083
0.9981 --- loss: 1.148869, loss_ss: 0.966576, loss_d: 0.182293
Epoch finished! Loss: 1.157100464976751
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6141414141414141
             precision    recall  f1-score   support

        0.0       0.29      0.33      0.31        80
        1.0       0.10      0.66      0.18        38
        2.0       0.86      0.63      0.72       478
        3.0       0.99      0.74      0.85       196
        4.0       0.71      0.56      0.63       198

avg / total       0.78      0.61      0.67       990
 


====== chp003-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.18  32.50   93.08  29.21     30.77
1  76.36  65.79   76.79  10.16     17.61
2  76.97  62.76   90.23  85.71     72.46
3  94.75  74.49   99.75  98.65     84.88
4  86.57  56.06   94.19  70.70     62.54
Total accuracy: 61.41%
Average sen: 58.32%
Average spec: 90.81%
Macro f1-score: 53.65%
Diagnosis acc on 15mins: 1.0
[0.59886622 0.62526643 0.72115964 0.99728978 0.97066498 0.98609143
 0.96788198 0.88307393 0.62010938 0.8084017  0.90173471 0.99715132
 0.98203146 0.93262154 0.91850841 0.73665285 0.69925123 0.55155933
 0.51117778 0.99303788 0.99828112 0.95568085 0.79845029 0.98980546
 0.97488141 0.9989543  0.9837991  0.97602421 0.59804887 0.99732071
 0.91648418 0.9259544  0.87878472]
pred: 0.8604545936439977, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp004-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.505208, loss_ss: 1.750987, loss_d: 0.754222
0.0384 --- loss: 2.409909, loss_ss: 1.882979, loss_d: 0.526930
0.0767 --- loss: 2.478473, loss_ss: 1.754179, loss_d: 0.724294
0.1151 --- loss: 1.927885, loss_ss: 1.462465, loss_d: 0.465420
0.1535 --- loss: 2.131255, loss_ss: 1.500723, loss_d: 0.630532
0.1919 --- loss: 2.099944, loss_ss: 1.422192, loss_d: 0.677753
0.2302 --- loss: 1.964127, loss_ss: 1.400371, loss_d: 0.563756
0.2686 --- loss: 2.343063, loss_ss: 1.396364, loss_d: 0.946699
0.3070 --- loss: 2.071855, loss_ss: 1.473690, loss_d: 0.598165
0.3454 --- loss: 2.115128, loss_ss: 1.622919, loss_d: 0.492209
0.3837 --- loss: 1.707060, loss_ss: 1.287484, loss_d: 0.419576
0.4221 --- loss: 2.108539, loss_ss: 1.461001, loss_d: 0.647539
0.4605 --- loss: 2.304153, loss_ss: 1.379127, loss_d: 0.925026
0.4988 --- loss: 2.153491, loss_ss: 1.477371, loss_d: 0.676120
0.5372 --- loss: 2.052526, loss_ss: 1.346867, loss_d: 0.705660
0.5756 --- loss: 2.180335, loss_ss: 1.272599, loss_d: 0.907736
0.6140 --- loss: 2.038953, loss_ss: 1.490440, loss_d: 0.548513
0.6523 --- loss: 1.777991, loss_ss: 1.338337, loss_d: 0.439654
0.6907 --- loss: 1.936004, loss_ss: 1.278746, loss_d: 0.657258
0.7291 --- loss: 2.233759, loss_ss: 1.454350, loss_d: 0.779409
0.7675 --- loss: 2.158575, loss_ss: 1.305318, loss_d: 0.853257
0.8058 --- loss: 2.063803, loss_ss: 1.379806, loss_d: 0.683997
0.8442 --- loss: 1.921664, loss_ss: 1.321859, loss_d: 0.599805
0.8826 --- loss: 1.951474, loss_ss: 1.310722, loss_d: 0.640752
0.9210 --- loss: 1.509914, loss_ss: 1.141198, loss_d: 0.368716
0.9593 --- loss: 2.053632, loss_ss: 1.377825, loss_d: 0.675807
0.9977 --- loss: 1.902214, loss_ss: 1.456826, loss_d: 0.445388
Epoch finished! Loss: 2.013278935964291
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.102982, loss_ss: 1.151598, loss_d: 0.951385
0.0384 --- loss: 1.893840, loss_ss: 1.205488, loss_d: 0.688352
0.0767 --- loss: 1.703620, loss_ss: 1.205542, loss_d: 0.498078
0.1151 --- loss: 2.028211, loss_ss: 1.396868, loss_d: 0.631343
0.1535 --- loss: 1.777570, loss_ss: 1.167504, loss_d: 0.610066
0.1919 --- loss: 1.477188, loss_ss: 1.141545, loss_d: 0.335643
0.2302 --- loss: 1.613909, loss_ss: 1.057762, loss_d: 0.556148
0.2686 --- loss: 1.996206, loss_ss: 1.291244, loss_d: 0.704962
0.3070 --- loss: 1.864990, loss_ss: 1.371546, loss_d: 0.493445
0.3454 --- loss: 1.721181, loss_ss: 1.193641, loss_d: 0.527540
0.3837 --- loss: 1.556296, loss_ss: 1.170360, loss_d: 0.385936
0.4221 --- loss: 1.835603, loss_ss: 1.226971, loss_d: 0.608632
0.4605 --- loss: 1.805682, loss_ss: 1.253125, loss_d: 0.552557
0.4988 --- loss: 2.214376, loss_ss: 1.515240, loss_d: 0.699136
0.5372 --- loss: 2.005704, loss_ss: 1.379397, loss_d: 0.626306
0.5756 --- loss: 1.692284, loss_ss: 1.141548, loss_d: 0.550736
0.6140 --- loss: 1.674020, loss_ss: 1.089950, loss_d: 0.584070
0.6523 --- loss: 1.699557, loss_ss: 1.237580, loss_d: 0.461977
0.6907 --- loss: 1.844826, loss_ss: 1.055055, loss_d: 0.789771
0.7291 --- loss: 1.698331, loss_ss: 1.084661, loss_d: 0.613670
0.7675 --- loss: 1.545540, loss_ss: 1.006015, loss_d: 0.539524
0.8058 --- loss: 1.617370, loss_ss: 0.980277, loss_d: 0.637094
0.8442 --- loss: 1.662137, loss_ss: 1.196893, loss_d: 0.465244
0.8826 --- loss: 1.393066, loss_ss: 1.055039, loss_d: 0.338028
0.9210 --- loss: 1.655793, loss_ss: 1.090771, loss_d: 0.565022
0.9593 --- loss: 1.685875, loss_ss: 1.085061, loss_d: 0.600814
0.9977 --- loss: 1.627615, loss_ss: 1.217716, loss_d: 0.409899
Epoch finished! Loss: 1.7673541688002072
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.564693, loss_ss: 1.093501, loss_d: 0.471192
0.0384 --- loss: 1.920591, loss_ss: 1.205886, loss_d: 0.714705
0.0767 --- loss: 1.612042, loss_ss: 1.239009, loss_d: 0.373034
0.1151 --- loss: 1.896627, loss_ss: 1.118540, loss_d: 0.778087
0.1535 --- loss: 1.653179, loss_ss: 1.110871, loss_d: 0.542308
0.1919 --- loss: 1.696662, loss_ss: 1.039991, loss_d: 0.656671
0.2302 --- loss: 1.530979, loss_ss: 0.913039, loss_d: 0.617940
0.2686 --- loss: 1.655828, loss_ss: 1.192516, loss_d: 0.463312
0.3070 --- loss: 1.506867, loss_ss: 1.062319, loss_d: 0.444547
0.3454 --- loss: 1.850123, loss_ss: 1.077306, loss_d: 0.772816
0.3837 --- loss: 1.949762, loss_ss: 1.477227, loss_d: 0.472536
0.4221 --- loss: 1.616275, loss_ss: 0.978798, loss_d: 0.637477
0.4605 --- loss: 1.608713, loss_ss: 0.972352, loss_d: 0.636361
0.4988 --- loss: 1.568596, loss_ss: 0.898910, loss_d: 0.669686
0.5372 --- loss: 1.983830, loss_ss: 1.416476, loss_d: 0.567354
0.5756 --- loss: 1.602506, loss_ss: 1.111357, loss_d: 0.491149
0.6140 --- loss: 1.643917, loss_ss: 1.088598, loss_d: 0.555319
0.6523 --- loss: 1.672410, loss_ss: 1.161367, loss_d: 0.511043
0.6907 --- loss: 1.713423, loss_ss: 1.193637, loss_d: 0.519786
0.7291 --- loss: 1.402206, loss_ss: 0.843225, loss_d: 0.558981
0.7675 --- loss: 1.740032, loss_ss: 0.993287, loss_d: 0.746745
0.8058 --- loss: 1.359452, loss_ss: 1.019532, loss_d: 0.339920
0.8442 --- loss: 1.155211, loss_ss: 0.809803, loss_d: 0.345407
0.8826 --- loss: 1.186268, loss_ss: 0.776595, loss_d: 0.409674
0.9210 --- loss: 1.419827, loss_ss: 0.830935, loss_d: 0.588892
0.9593 --- loss: 1.424633, loss_ss: 0.957291, loss_d: 0.467342
0.9977 --- loss: 1.662767, loss_ss: 1.132509, loss_d: 0.530257
Epoch finished! Loss: 1.6243996986976037
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.499613, loss_ss: 0.929263, loss_d: 0.570350
0.0384 --- loss: 1.573790, loss_ss: 1.134930, loss_d: 0.438860
0.0767 --- loss: 1.669449, loss_ss: 0.749585, loss_d: 0.919864
0.1151 --- loss: 2.019352, loss_ss: 1.340309, loss_d: 0.679043
0.1535 --- loss: 1.355610, loss_ss: 0.900860, loss_d: 0.454750
0.1919 --- loss: 1.592896, loss_ss: 0.852430, loss_d: 0.740466
0.2302 --- loss: 1.476192, loss_ss: 0.840758, loss_d: 0.635434
0.2686 --- loss: 1.546888, loss_ss: 0.943903, loss_d: 0.602985
0.3070 --- loss: 1.975013, loss_ss: 1.256805, loss_d: 0.718208
0.3454 --- loss: 1.238732, loss_ss: 0.743741, loss_d: 0.494991
0.3837 --- loss: 1.649960, loss_ss: 0.988715, loss_d: 0.661245
0.4221 --- loss: 1.644280, loss_ss: 1.093235, loss_d: 0.551045
0.4605 --- loss: 1.387924, loss_ss: 0.792794, loss_d: 0.595131
0.4988 --- loss: 1.515949, loss_ss: 0.878341, loss_d: 0.637608
0.5372 --- loss: 1.325253, loss_ss: 0.833106, loss_d: 0.492147
0.5756 --- loss: 1.319929, loss_ss: 0.867950, loss_d: 0.451979
0.6140 --- loss: 1.799219, loss_ss: 1.236200, loss_d: 0.563019
0.6523 --- loss: 1.624357, loss_ss: 1.121492, loss_d: 0.502865
0.6907 --- loss: 1.465495, loss_ss: 0.921702, loss_d: 0.543793
0.7291 --- loss: 1.676913, loss_ss: 1.031563, loss_d: 0.645350
0.7675 --- loss: 1.378807, loss_ss: 1.026532, loss_d: 0.352275
0.8058 --- loss: 1.486135, loss_ss: 0.948483, loss_d: 0.537652
0.8442 --- loss: 1.171312, loss_ss: 0.834378, loss_d: 0.336934
0.8826 --- loss: 1.600128, loss_ss: 1.091758, loss_d: 0.508370
0.9210 --- loss: 1.670599, loss_ss: 0.899454, loss_d: 0.771145
0.9593 --- loss: 1.524611, loss_ss: 0.972347, loss_d: 0.552263
0.9977 --- loss: 1.587490, loss_ss: 0.971848, loss_d: 0.615642
Epoch finished! Loss: 1.5264096099596758
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.421575, loss_ss: 0.880679, loss_d: 0.540896
0.0384 --- loss: 1.390935, loss_ss: 0.814864, loss_d: 0.576071
0.0767 --- loss: 1.623422, loss_ss: 0.819646, loss_d: 0.803776
0.1151 --- loss: 1.659780, loss_ss: 1.309575, loss_d: 0.350205
0.1535 --- loss: 1.811425, loss_ss: 1.030156, loss_d: 0.781269
0.1919 --- loss: 1.451129, loss_ss: 0.853281, loss_d: 0.597848
0.2302 --- loss: 1.290648, loss_ss: 0.724869, loss_d: 0.565779
0.2686 --- loss: 1.302045, loss_ss: 0.887128, loss_d: 0.414918
0.3070 --- loss: 1.616476, loss_ss: 1.006138, loss_d: 0.610337
0.3454 --- loss: 1.235055, loss_ss: 0.991236, loss_d: 0.243819
0.3837 --- loss: 1.309953, loss_ss: 0.751669, loss_d: 0.558284
0.4221 --- loss: 1.131635, loss_ss: 0.646725, loss_d: 0.484910
0.4605 --- loss: 1.199625, loss_ss: 0.777030, loss_d: 0.422595
0.4988 --- loss: 1.450958, loss_ss: 1.082442, loss_d: 0.368516
0.5372 --- loss: 1.219294, loss_ss: 0.944620, loss_d: 0.274674
0.5756 --- loss: 1.212145, loss_ss: 0.985691, loss_d: 0.226454
0.6140 --- loss: 1.482664, loss_ss: 1.073544, loss_d: 0.409120
0.6523 --- loss: 1.493991, loss_ss: 1.034925, loss_d: 0.459066
0.6907 --- loss: 1.295779, loss_ss: 0.664733, loss_d: 0.631046
0.7291 --- loss: 1.492037, loss_ss: 1.000456, loss_d: 0.491581
0.7675 --- loss: 1.137926, loss_ss: 0.831806, loss_d: 0.306120
0.8058 --- loss: 1.586113, loss_ss: 0.985131, loss_d: 0.600982
0.8442 --- loss: 1.379795, loss_ss: 0.787705, loss_d: 0.592090
0.8826 --- loss: 1.183625, loss_ss: 0.868882, loss_d: 0.314743
0.9210 --- loss: 1.528948, loss_ss: 1.021163, loss_d: 0.507785
0.9593 --- loss: 1.862177, loss_ss: 1.044308, loss_d: 0.817869
0.9977 --- loss: 1.091378, loss_ss: 0.882849, loss_d: 0.208529
Epoch finished! Loss: 1.4169962369478666
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.296438, loss_ss: 0.748073, loss_d: 0.548365
0.0384 --- loss: 1.310342, loss_ss: 1.068232, loss_d: 0.242109
0.0767 --- loss: 1.498164, loss_ss: 1.008525, loss_d: 0.489639
0.1151 --- loss: 1.478706, loss_ss: 0.917419, loss_d: 0.561287
0.1535 --- loss: 1.335417, loss_ss: 0.933847, loss_d: 0.401570
0.1919 --- loss: 1.506692, loss_ss: 1.124989, loss_d: 0.381703
0.2302 --- loss: 1.232778, loss_ss: 0.693294, loss_d: 0.539485
0.2686 --- loss: 1.506362, loss_ss: 0.839640, loss_d: 0.666722
0.3070 --- loss: 1.064108, loss_ss: 0.707597, loss_d: 0.356511
0.3454 --- loss: 1.447280, loss_ss: 1.244108, loss_d: 0.203172
0.3837 --- loss: 1.784501, loss_ss: 0.972390, loss_d: 0.812112
0.4221 --- loss: 1.940957, loss_ss: 0.898137, loss_d: 1.042819
0.4605 --- loss: 1.307641, loss_ss: 0.859029, loss_d: 0.448613
0.4988 --- loss: 1.392186, loss_ss: 0.869985, loss_d: 0.522201
0.5372 --- loss: 1.205052, loss_ss: 0.911937, loss_d: 0.293115
0.5756 --- loss: 1.486993, loss_ss: 0.806492, loss_d: 0.680501
0.6140 --- loss: 1.164050, loss_ss: 0.858881, loss_d: 0.305169
0.6523 --- loss: 1.634259, loss_ss: 0.930513, loss_d: 0.703745
0.6907 --- loss: 1.441683, loss_ss: 1.027030, loss_d: 0.414653
0.7291 --- loss: 1.661040, loss_ss: 0.867888, loss_d: 0.793152
0.7675 --- loss: 1.118627, loss_ss: 0.670905, loss_d: 0.447722
0.8058 --- loss: 1.305587, loss_ss: 0.982058, loss_d: 0.323529
0.8442 --- loss: 1.378384, loss_ss: 0.871787, loss_d: 0.506597
0.8826 --- loss: 1.155042, loss_ss: 0.759975, loss_d: 0.395067
0.9210 --- loss: 1.216959, loss_ss: 1.008820, loss_d: 0.208139
0.9593 --- loss: 0.968722, loss_ss: 0.809195, loss_d: 0.159527
0.9977 --- loss: 1.015180, loss_ss: 0.708384, loss_d: 0.306796
Epoch finished! Loss: 1.3641728401184081
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.233640, loss_ss: 0.835773, loss_d: 0.397867
0.0384 --- loss: 1.616139, loss_ss: 1.233830, loss_d: 0.382308
0.0767 --- loss: 1.881360, loss_ss: 1.015880, loss_d: 0.865480
0.1151 --- loss: 1.079256, loss_ss: 0.795340, loss_d: 0.283917
0.1535 --- loss: 1.450502, loss_ss: 0.736204, loss_d: 0.714298
0.1919 --- loss: 1.190799, loss_ss: 0.706636, loss_d: 0.484163
0.2302 --- loss: 1.402497, loss_ss: 1.030855, loss_d: 0.371642
0.2686 --- loss: 1.293289, loss_ss: 0.983696, loss_d: 0.309593
0.3070 --- loss: 1.488706, loss_ss: 0.836566, loss_d: 0.652140
0.3454 --- loss: 1.101369, loss_ss: 0.883083, loss_d: 0.218286
0.3837 --- loss: 1.321369, loss_ss: 0.840764, loss_d: 0.480605
0.4221 --- loss: 1.633920, loss_ss: 1.307201, loss_d: 0.326719
0.4605 --- loss: 1.062645, loss_ss: 0.865129, loss_d: 0.197516
0.4988 --- loss: 1.295835, loss_ss: 0.693616, loss_d: 0.602219
0.5372 --- loss: 1.389306, loss_ss: 1.000545, loss_d: 0.388761
0.5756 --- loss: 1.206124, loss_ss: 0.783277, loss_d: 0.422847
0.6140 --- loss: 0.877608, loss_ss: 0.700218, loss_d: 0.177390
0.6523 --- loss: 0.962153, loss_ss: 0.796968, loss_d: 0.165186
0.6907 --- loss: 1.159873, loss_ss: 0.850031, loss_d: 0.309842
0.7291 --- loss: 0.983224, loss_ss: 0.823154, loss_d: 0.160070
0.7675 --- loss: 1.238466, loss_ss: 0.747618, loss_d: 0.490848
0.8058 --- loss: 1.152383, loss_ss: 0.821836, loss_d: 0.330547
0.8442 --- loss: 1.108635, loss_ss: 0.888223, loss_d: 0.220413
0.8826 --- loss: 0.918664, loss_ss: 0.792779, loss_d: 0.125885
0.9210 --- loss: 1.637345, loss_ss: 1.328832, loss_d: 0.308513
0.9593 --- loss: 0.874472, loss_ss: 0.680370, loss_d: 0.194102
0.9977 --- loss: 1.251930, loss_ss: 1.030558, loss_d: 0.221372
Epoch finished! Loss: 1.2904609100176738
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.205219, loss_ss: 0.866886, loss_d: 0.338333
0.0384 --- loss: 1.079526, loss_ss: 0.894397, loss_d: 0.185129
0.0767 --- loss: 1.344852, loss_ss: 0.773705, loss_d: 0.571147
0.1151 --- loss: 1.146294, loss_ss: 0.736801, loss_d: 0.409493
0.1535 --- loss: 1.185768, loss_ss: 0.755415, loss_d: 0.430352
0.1919 --- loss: 0.953204, loss_ss: 0.602798, loss_d: 0.350406
0.2302 --- loss: 1.213369, loss_ss: 0.986235, loss_d: 0.227134
0.2686 --- loss: 0.773001, loss_ss: 0.625284, loss_d: 0.147717
0.3070 --- loss: 0.943898, loss_ss: 0.710358, loss_d: 0.233540
0.3454 --- loss: 1.769198, loss_ss: 1.236470, loss_d: 0.532728
0.3837 --- loss: 1.184979, loss_ss: 0.720017, loss_d: 0.464963
0.4221 --- loss: 1.293974, loss_ss: 0.855246, loss_d: 0.438729
0.4605 --- loss: 0.912010, loss_ss: 0.735978, loss_d: 0.176032
0.4988 --- loss: 1.139712, loss_ss: 0.868199, loss_d: 0.271513
0.5372 --- loss: 1.349303, loss_ss: 0.736585, loss_d: 0.612719
0.5756 --- loss: 1.059211, loss_ss: 0.813348, loss_d: 0.245863
0.6140 --- loss: 1.535229, loss_ss: 1.267455, loss_d: 0.267774
0.6523 --- loss: 1.062796, loss_ss: 0.785226, loss_d: 0.277569
0.6907 --- loss: 0.947441, loss_ss: 0.584618, loss_d: 0.362823
0.7291 --- loss: 1.406033, loss_ss: 1.103595, loss_d: 0.302438
0.7675 --- loss: 1.409069, loss_ss: 1.020838, loss_d: 0.388231
0.8058 --- loss: 1.492002, loss_ss: 1.063952, loss_d: 0.428050
0.8442 --- loss: 0.999947, loss_ss: 0.832971, loss_d: 0.166976
0.8826 --- loss: 1.424603, loss_ss: 1.018112, loss_d: 0.406491
0.9210 --- loss: 1.195116, loss_ss: 0.733992, loss_d: 0.461123
0.9593 --- loss: 1.088691, loss_ss: 0.767661, loss_d: 0.321030
0.9977 --- loss: 1.199384, loss_ss: 0.807443, loss_d: 0.391941
Epoch finished! Loss: 1.266098207464585
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.967629, loss_ss: 0.691020, loss_d: 0.276609
0.0384 --- loss: 1.622109, loss_ss: 1.377637, loss_d: 0.244472
0.0767 --- loss: 1.543953, loss_ss: 1.189692, loss_d: 0.354262
0.1151 --- loss: 1.052303, loss_ss: 0.614994, loss_d: 0.437309
0.1535 --- loss: 0.903984, loss_ss: 0.615909, loss_d: 0.288075
0.1919 --- loss: 1.352312, loss_ss: 0.810702, loss_d: 0.541610
0.2302 --- loss: 1.620168, loss_ss: 1.039985, loss_d: 0.580183
0.2686 --- loss: 1.568913, loss_ss: 0.787245, loss_d: 0.781669
0.3070 --- loss: 1.089864, loss_ss: 0.890748, loss_d: 0.199116
0.3454 --- loss: 1.021822, loss_ss: 0.779884, loss_d: 0.241938
0.3837 --- loss: 1.010983, loss_ss: 0.816786, loss_d: 0.194197
0.4221 --- loss: 1.521552, loss_ss: 1.096991, loss_d: 0.424562
0.4605 --- loss: 1.601323, loss_ss: 1.486393, loss_d: 0.114930
0.4988 --- loss: 1.036459, loss_ss: 0.831737, loss_d: 0.204722
0.5372 --- loss: 1.323530, loss_ss: 0.866653, loss_d: 0.456878
0.5756 --- loss: 1.081319, loss_ss: 0.785496, loss_d: 0.295823
0.6140 --- loss: 1.830719, loss_ss: 0.863493, loss_d: 0.967225
0.6523 --- loss: 1.148365, loss_ss: 0.859492, loss_d: 0.288874
0.6907 --- loss: 1.089957, loss_ss: 0.695851, loss_d: 0.394106
0.7291 --- loss: 1.403080, loss_ss: 0.709992, loss_d: 0.693089
0.7675 --- loss: 1.127299, loss_ss: 0.772447, loss_d: 0.354852
0.8058 --- loss: 1.393515, loss_ss: 1.093714, loss_d: 0.299801
0.8442 --- loss: 1.154780, loss_ss: 0.866053, loss_d: 0.288727
0.8826 --- loss: 0.960379, loss_ss: 0.753789, loss_d: 0.206590
0.9210 --- loss: 1.543749, loss_ss: 1.190578, loss_d: 0.353171
0.9593 --- loss: 0.986629, loss_ss: 0.811162, loss_d: 0.175468
0.9977 --- loss: 1.090606, loss_ss: 0.730231, loss_d: 0.360375
Epoch finished! Loss: 1.232281417113084
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.888691, loss_ss: 0.729998, loss_d: 0.158693
0.0384 --- loss: 0.791668, loss_ss: 0.657189, loss_d: 0.134479
0.0767 --- loss: 2.079102, loss_ss: 0.684973, loss_d: 1.394129
0.1151 --- loss: 1.168665, loss_ss: 0.835098, loss_d: 0.333567
0.1535 --- loss: 1.092689, loss_ss: 0.820784, loss_d: 0.271905
0.1919 --- loss: 1.411209, loss_ss: 1.096889, loss_d: 0.314320
0.2302 --- loss: 1.186277, loss_ss: 0.648529, loss_d: 0.537747
0.2686 --- loss: 1.187367, loss_ss: 0.851419, loss_d: 0.335947
0.3070 --- loss: 1.063534, loss_ss: 0.680205, loss_d: 0.383329
0.3454 --- loss: 1.007465, loss_ss: 0.913170, loss_d: 0.094294
0.3837 --- loss: 1.582228, loss_ss: 1.089473, loss_d: 0.492755
0.4221 --- loss: 1.054995, loss_ss: 0.683886, loss_d: 0.371110
0.4605 --- loss: 1.108761, loss_ss: 0.762480, loss_d: 0.346281
0.4988 --- loss: 1.102510, loss_ss: 0.812407, loss_d: 0.290102
0.5372 --- loss: 1.693018, loss_ss: 1.185525, loss_d: 0.507493
0.5756 --- loss: 0.780754, loss_ss: 0.623718, loss_d: 0.157036
0.6140 --- loss: 1.544628, loss_ss: 1.138884, loss_d: 0.405744
0.6523 --- loss: 1.789459, loss_ss: 0.674980, loss_d: 1.114479
0.6907 --- loss: 0.959474, loss_ss: 0.695768, loss_d: 0.263706
0.7291 --- loss: 1.059333, loss_ss: 0.905199, loss_d: 0.154134
0.7675 --- loss: 1.219063, loss_ss: 1.043731, loss_d: 0.175331
0.8058 --- loss: 0.958656, loss_ss: 0.747102, loss_d: 0.211554
0.8442 --- loss: 1.021736, loss_ss: 0.725147, loss_d: 0.296588
0.8826 --- loss: 1.074037, loss_ss: 0.871454, loss_d: 0.202583
0.9210 --- loss: 1.298181, loss_ss: 0.797313, loss_d: 0.500868
0.9593 --- loss: 1.014997, loss_ss: 0.777150, loss_d: 0.237847
0.9977 --- loss: 2.464296, loss_ss: 0.679003, loss_d: 1.785294
Epoch finished! Loss: 1.1839545431045386
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5927083333333333
             precision    recall  f1-score   support

        0.0       0.71      0.53      0.61       135
        1.0       0.25      0.06      0.09       141
        2.0       0.61      0.58      0.60       354
        3.0       0.60      0.92      0.73       197
        4.0       0.55      0.75      0.63       133

avg / total       0.56      0.59      0.56       960
 


====== chp004-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.42  53.33   96.48  71.29     61.02
1  83.65   5.67   97.07  25.00      9.25
2  70.83  58.47   78.05  60.88     59.65
3  85.62  92.39   83.88  59.67     72.51
4  88.02  75.19   90.08  54.95     63.49
Total accuracy: 59.27%
Average sen: 57.01%
Average spec: 89.11%
Macro f1-score: 53.18%
Diagnosis acc on 15mins: 1.0
[0.97409725 0.98265678 0.97291911 0.94997329 0.9806686  0.98386085
 0.98499793 0.98507392 0.98528999 0.99143642 0.98648053 0.98687881
 0.96835548 0.98349482 0.97786772 0.98721224 0.98201895 0.68312156
 0.98482412 0.97723639 0.9886955  0.9849571  0.98662591 0.98378825
 0.98133618 0.98531806 0.9668979  0.96126038 0.98440808 0.98478031
 0.98497838 0.9873569 ]
pred: 0.9715271163731813, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp005-nsrr. train_data(2595), test_data(43) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.405878, loss_ss: 1.682013, loss_d: 0.723865
0.0385 --- loss: 2.005183, loss_ss: 1.502271, loss_d: 0.502912
0.0771 --- loss: 1.919682, loss_ss: 1.377299, loss_d: 0.542383
0.1156 --- loss: 2.109318, loss_ss: 1.527627, loss_d: 0.581691
0.1541 --- loss: 2.001710, loss_ss: 1.351805, loss_d: 0.649905
0.1927 --- loss: 2.261275, loss_ss: 1.332824, loss_d: 0.928451
0.2312 --- loss: 1.967136, loss_ss: 1.367005, loss_d: 0.600131
0.2697 --- loss: 2.364347, loss_ss: 1.309716, loss_d: 1.054631
0.3083 --- loss: 1.959612, loss_ss: 1.307453, loss_d: 0.652159
0.3468 --- loss: 1.846471, loss_ss: 1.297887, loss_d: 0.548584
0.3854 --- loss: 1.759650, loss_ss: 1.365531, loss_d: 0.394120
0.4239 --- loss: 2.114308, loss_ss: 1.311113, loss_d: 0.803195
0.4624 --- loss: 2.033465, loss_ss: 1.440613, loss_d: 0.592852
0.5010 --- loss: 1.779963, loss_ss: 1.200716, loss_d: 0.579248
0.5395 --- loss: 2.283741, loss_ss: 1.238544, loss_d: 1.045196
0.5780 --- loss: 1.872264, loss_ss: 1.302395, loss_d: 0.569869
0.6166 --- loss: 1.786758, loss_ss: 1.152595, loss_d: 0.634164
0.6551 --- loss: 1.549342, loss_ss: 1.066852, loss_d: 0.482490
0.6936 --- loss: 1.814003, loss_ss: 1.182880, loss_d: 0.631123
0.7322 --- loss: 2.097193, loss_ss: 1.179066, loss_d: 0.918127
0.7707 --- loss: 1.734225, loss_ss: 1.188431, loss_d: 0.545795
0.8092 --- loss: 1.570064, loss_ss: 1.084913, loss_d: 0.485150
0.8478 --- loss: 1.720148, loss_ss: 1.089517, loss_d: 0.630631
0.8863 --- loss: 1.767951, loss_ss: 1.259769, loss_d: 0.508181
0.9249 --- loss: 1.636533, loss_ss: 1.261171, loss_d: 0.375362
0.9634 --- loss: 2.148401, loss_ss: 1.272369, loss_d: 0.876032
Epoch finished! Loss: 1.9252402694989355
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.799473, loss_ss: 1.171223, loss_d: 0.628250
0.0385 --- loss: 1.652264, loss_ss: 1.149063, loss_d: 0.503202
0.0771 --- loss: 1.760709, loss_ss: 1.149632, loss_d: 0.611077
0.1156 --- loss: 2.126458, loss_ss: 1.307867, loss_d: 0.818591
0.1541 --- loss: 2.032353, loss_ss: 1.230503, loss_d: 0.801850
0.1927 --- loss: 1.976128, loss_ss: 1.264905, loss_d: 0.711223
0.2312 --- loss: 1.997976, loss_ss: 1.361044, loss_d: 0.636932
0.2697 --- loss: 1.741443, loss_ss: 1.162046, loss_d: 0.579397
0.3083 --- loss: 1.908301, loss_ss: 1.245725, loss_d: 0.662576
0.3468 --- loss: 1.508290, loss_ss: 0.972264, loss_d: 0.536025
0.3854 --- loss: 1.666822, loss_ss: 1.093296, loss_d: 0.573526
0.4239 --- loss: 1.540270, loss_ss: 0.975439, loss_d: 0.564830
0.4624 --- loss: 1.646459, loss_ss: 1.024155, loss_d: 0.622303
0.5010 --- loss: 1.444443, loss_ss: 1.029921, loss_d: 0.414522
0.5395 --- loss: 1.383547, loss_ss: 1.042969, loss_d: 0.340578
0.5780 --- loss: 1.765612, loss_ss: 1.089211, loss_d: 0.676401
0.6166 --- loss: 1.718588, loss_ss: 1.167057, loss_d: 0.551531
0.6551 --- loss: 1.455950, loss_ss: 0.936028, loss_d: 0.519923
0.6936 --- loss: 1.637636, loss_ss: 1.032964, loss_d: 0.604673
0.7322 --- loss: 1.371469, loss_ss: 0.916544, loss_d: 0.454925
0.7707 --- loss: 1.926730, loss_ss: 1.124679, loss_d: 0.802051
0.8092 --- loss: 1.905321, loss_ss: 1.049029, loss_d: 0.856292
0.8478 --- loss: 1.794768, loss_ss: 1.039133, loss_d: 0.755636
0.8863 --- loss: 1.346878, loss_ss: 1.029259, loss_d: 0.317619
0.9249 --- loss: 1.665063, loss_ss: 1.129323, loss_d: 0.535740
0.9634 --- loss: 1.826284, loss_ss: 1.308769, loss_d: 0.517514
Epoch finished! Loss: 1.711577703133513
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.416177, loss_ss: 1.160258, loss_d: 0.255919
0.0385 --- loss: 1.644373, loss_ss: 1.166994, loss_d: 0.477379
0.0771 --- loss: 1.582405, loss_ss: 1.175907, loss_d: 0.406498
0.1156 --- loss: 1.570486, loss_ss: 0.991512, loss_d: 0.578974
0.1541 --- loss: 1.524597, loss_ss: 0.985189, loss_d: 0.539409
0.1927 --- loss: 1.605565, loss_ss: 1.098451, loss_d: 0.507114
0.2312 --- loss: 1.712823, loss_ss: 1.067396, loss_d: 0.645428
0.2697 --- loss: 1.215444, loss_ss: 0.796157, loss_d: 0.419287
0.3083 --- loss: 1.464740, loss_ss: 1.142949, loss_d: 0.321791
0.3468 --- loss: 1.299874, loss_ss: 1.040137, loss_d: 0.259737
0.3854 --- loss: 1.865477, loss_ss: 1.065169, loss_d: 0.800308
0.4239 --- loss: 1.712831, loss_ss: 1.239589, loss_d: 0.473242
0.4624 --- loss: 1.346443, loss_ss: 1.010434, loss_d: 0.336010
0.5010 --- loss: 1.468340, loss_ss: 1.176300, loss_d: 0.292040
0.5395 --- loss: 1.330783, loss_ss: 0.917299, loss_d: 0.413484
0.5780 --- loss: 1.336421, loss_ss: 0.910720, loss_d: 0.425700
0.6166 --- loss: 1.558062, loss_ss: 1.053838, loss_d: 0.504224
0.6551 --- loss: 1.930014, loss_ss: 1.281416, loss_d: 0.648598
0.6936 --- loss: 1.384300, loss_ss: 0.865831, loss_d: 0.518469
0.7322 --- loss: 1.934176, loss_ss: 1.215324, loss_d: 0.718852
0.7707 --- loss: 1.714120, loss_ss: 0.942261, loss_d: 0.771860
0.8092 --- loss: 1.370965, loss_ss: 1.013303, loss_d: 0.357662
0.8478 --- loss: 1.616224, loss_ss: 1.121553, loss_d: 0.494672
0.8863 --- loss: 2.240873, loss_ss: 1.573623, loss_d: 0.667250
0.9249 --- loss: 1.324723, loss_ss: 0.885379, loss_d: 0.439344
0.9634 --- loss: 1.080311, loss_ss: 0.722847, loss_d: 0.357464
Epoch finished! Loss: 1.5645814613946156
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.568168, loss_ss: 1.053546, loss_d: 0.514622
0.0385 --- loss: 1.322835, loss_ss: 0.968741, loss_d: 0.354094
0.0771 --- loss: 1.400887, loss_ss: 0.723605, loss_d: 0.677282
0.1156 --- loss: 2.155108, loss_ss: 1.093979, loss_d: 1.061128
0.1541 --- loss: 1.379983, loss_ss: 1.006561, loss_d: 0.373421
0.1927 --- loss: 1.411736, loss_ss: 0.779941, loss_d: 0.631795
0.2312 --- loss: 1.403719, loss_ss: 1.120727, loss_d: 0.282992
0.2697 --- loss: 1.136481, loss_ss: 0.889724, loss_d: 0.246757
0.3083 --- loss: 1.229740, loss_ss: 0.957379, loss_d: 0.272361
0.3468 --- loss: 1.346927, loss_ss: 1.037787, loss_d: 0.309140
0.3854 --- loss: 1.839186, loss_ss: 1.179442, loss_d: 0.659744
0.4239 --- loss: 1.308491, loss_ss: 1.005484, loss_d: 0.303007
0.4624 --- loss: 1.570630, loss_ss: 1.227554, loss_d: 0.343076
0.5010 --- loss: 1.354048, loss_ss: 0.837701, loss_d: 0.516347
0.5395 --- loss: 1.496192, loss_ss: 1.039802, loss_d: 0.456390
0.5780 --- loss: 1.369920, loss_ss: 0.871701, loss_d: 0.498219
0.6166 --- loss: 1.352152, loss_ss: 1.062575, loss_d: 0.289578
0.6551 --- loss: 1.787397, loss_ss: 1.368642, loss_d: 0.418755
0.6936 --- loss: 1.307966, loss_ss: 1.009129, loss_d: 0.298838
0.7322 --- loss: 1.366465, loss_ss: 0.876361, loss_d: 0.490104
0.7707 --- loss: 1.522087, loss_ss: 1.068214, loss_d: 0.453873
0.8092 --- loss: 1.709469, loss_ss: 0.974138, loss_d: 0.735331
0.8478 --- loss: 1.217662, loss_ss: 0.814339, loss_d: 0.403323
0.8863 --- loss: 1.469468, loss_ss: 1.149992, loss_d: 0.319476
0.9249 --- loss: 1.521321, loss_ss: 1.049739, loss_d: 0.471582
0.9634 --- loss: 1.436542, loss_ss: 1.053854, loss_d: 0.382687
Epoch finished! Loss: 1.4548866016984445
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.577097, loss_ss: 1.121549, loss_d: 0.455548
0.0385 --- loss: 1.095635, loss_ss: 0.722855, loss_d: 0.372780
0.0771 --- loss: 1.164867, loss_ss: 0.793464, loss_d: 0.371403
0.1156 --- loss: 1.751724, loss_ss: 0.743187, loss_d: 1.008536
0.1541 --- loss: 1.605127, loss_ss: 0.765591, loss_d: 0.839536
0.1927 --- loss: 1.158842, loss_ss: 0.825813, loss_d: 0.333029
0.2312 --- loss: 1.802874, loss_ss: 1.132390, loss_d: 0.670484
0.2697 --- loss: 1.263410, loss_ss: 0.944856, loss_d: 0.318554
0.3083 --- loss: 1.337171, loss_ss: 0.931674, loss_d: 0.405497
0.3468 --- loss: 1.554688, loss_ss: 1.168030, loss_d: 0.386658
0.3854 --- loss: 1.406902, loss_ss: 1.007975, loss_d: 0.398927
0.4239 --- loss: 1.436081, loss_ss: 1.005742, loss_d: 0.430339
0.4624 --- loss: 1.318088, loss_ss: 1.043213, loss_d: 0.274875
0.5010 --- loss: 1.109691, loss_ss: 0.894751, loss_d: 0.214939
0.5395 --- loss: 1.511442, loss_ss: 0.824063, loss_d: 0.687379
0.5780 --- loss: 1.013155, loss_ss: 0.817920, loss_d: 0.195235
0.6166 --- loss: 1.269293, loss_ss: 0.841975, loss_d: 0.427318
0.6551 --- loss: 1.308653, loss_ss: 0.948472, loss_d: 0.360181
0.6936 --- loss: 1.205364, loss_ss: 0.910240, loss_d: 0.295124
0.7322 --- loss: 1.240541, loss_ss: 0.958621, loss_d: 0.281919
0.7707 --- loss: 1.240159, loss_ss: 0.973542, loss_d: 0.266617
0.8092 --- loss: 0.900686, loss_ss: 0.683519, loss_d: 0.217167
0.8478 --- loss: 1.399516, loss_ss: 1.150784, loss_d: 0.248731
0.8863 --- loss: 1.156571, loss_ss: 0.812556, loss_d: 0.344015
0.9249 --- loss: 1.458657, loss_ss: 1.106026, loss_d: 0.352631
0.9634 --- loss: 1.107033, loss_ss: 0.852781, loss_d: 0.254252
Epoch finished! Loss: 1.377414231825059
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.222596, loss_ss: 0.601360, loss_d: 0.621236
0.0385 --- loss: 1.110389, loss_ss: 0.873004, loss_d: 0.237385
0.0771 --- loss: 1.727741, loss_ss: 1.421760, loss_d: 0.305981
0.1156 --- loss: 1.302156, loss_ss: 0.879950, loss_d: 0.422207
0.1541 --- loss: 1.325247, loss_ss: 0.749604, loss_d: 0.575643
0.1927 --- loss: 1.446987, loss_ss: 1.068525, loss_d: 0.378462
0.2312 --- loss: 1.372833, loss_ss: 1.045847, loss_d: 0.326986
0.2697 --- loss: 1.085988, loss_ss: 0.806691, loss_d: 0.279297
0.3083 --- loss: 0.992732, loss_ss: 0.750478, loss_d: 0.242254
0.3468 --- loss: 1.392451, loss_ss: 1.161442, loss_d: 0.231008
0.3854 --- loss: 1.138279, loss_ss: 0.952153, loss_d: 0.186125
0.4239 --- loss: 1.510362, loss_ss: 0.929497, loss_d: 0.580864
0.4624 --- loss: 0.958191, loss_ss: 0.809003, loss_d: 0.149188
0.5010 --- loss: 1.396997, loss_ss: 0.731621, loss_d: 0.665376
0.5395 --- loss: 1.205223, loss_ss: 0.989722, loss_d: 0.215501
0.5780 --- loss: 1.211545, loss_ss: 0.991352, loss_d: 0.220193
0.6166 --- loss: 1.144485, loss_ss: 0.783369, loss_d: 0.361116
0.6551 --- loss: 2.102562, loss_ss: 0.901702, loss_d: 1.200860
0.6936 --- loss: 1.047293, loss_ss: 0.694405, loss_d: 0.352888
0.7322 --- loss: 1.325411, loss_ss: 0.990363, loss_d: 0.335048
0.7707 --- loss: 1.090829, loss_ss: 0.815107, loss_d: 0.275723
0.8092 --- loss: 1.746584, loss_ss: 1.442473, loss_d: 0.304111
0.8478 --- loss: 1.218517, loss_ss: 0.960047, loss_d: 0.258470
0.8863 --- loss: 1.194099, loss_ss: 0.763876, loss_d: 0.430224
0.9249 --- loss: 1.020606, loss_ss: 0.804333, loss_d: 0.216273
0.9634 --- loss: 1.099169, loss_ss: 0.831806, loss_d: 0.267363
Epoch finished! Loss: 1.3342280841241931
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.685597, loss_ss: 1.062106, loss_d: 0.623492
0.0385 --- loss: 1.149429, loss_ss: 0.865969, loss_d: 0.283460
0.0771 --- loss: 0.926369, loss_ss: 0.536686, loss_d: 0.389683
0.1156 --- loss: 1.245576, loss_ss: 0.726996, loss_d: 0.518580
0.1541 --- loss: 1.061484, loss_ss: 0.876342, loss_d: 0.185141
0.1927 --- loss: 1.092272, loss_ss: 0.864368, loss_d: 0.227904
0.2312 --- loss: 1.136788, loss_ss: 0.891874, loss_d: 0.244915
0.2697 --- loss: 1.430778, loss_ss: 0.923076, loss_d: 0.507702
0.3083 --- loss: 1.886257, loss_ss: 0.788777, loss_d: 1.097480
0.3468 --- loss: 1.717031, loss_ss: 0.777444, loss_d: 0.939586
0.3854 --- loss: 1.352245, loss_ss: 1.043214, loss_d: 0.309031
0.4239 --- loss: 1.149077, loss_ss: 0.923662, loss_d: 0.225414
0.4624 --- loss: 1.210877, loss_ss: 0.998852, loss_d: 0.212025
0.5010 --- loss: 1.459100, loss_ss: 1.033359, loss_d: 0.425741
0.5395 --- loss: 1.228102, loss_ss: 0.702645, loss_d: 0.525457
0.5780 --- loss: 1.280645, loss_ss: 0.914484, loss_d: 0.366161
0.6166 --- loss: 0.725930, loss_ss: 0.570585, loss_d: 0.155345
0.6551 --- loss: 1.539650, loss_ss: 1.166643, loss_d: 0.373007
0.6936 --- loss: 2.157138, loss_ss: 1.276322, loss_d: 0.880816
0.7322 --- loss: 0.788688, loss_ss: 0.682586, loss_d: 0.106102
0.7707 --- loss: 2.395453, loss_ss: 1.083954, loss_d: 1.311500
0.8092 --- loss: 1.185163, loss_ss: 0.645324, loss_d: 0.539839
0.8478 --- loss: 1.292201, loss_ss: 0.954054, loss_d: 0.338147
0.8863 --- loss: 1.137983, loss_ss: 0.725474, loss_d: 0.412509
0.9249 --- loss: 1.265896, loss_ss: 0.999382, loss_d: 0.266514
0.9634 --- loss: 1.181776, loss_ss: 0.913551, loss_d: 0.268224
Epoch finished! Loss: 1.2879418293481628
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.600844, loss_ss: 0.998933, loss_d: 0.601911
0.0385 --- loss: 1.189705, loss_ss: 1.058493, loss_d: 0.131213
0.0771 --- loss: 1.056671, loss_ss: 0.798693, loss_d: 0.257979
0.1156 --- loss: 0.999828, loss_ss: 0.714535, loss_d: 0.285293
0.1541 --- loss: 1.022277, loss_ss: 0.679805, loss_d: 0.342472
0.1927 --- loss: 1.251073, loss_ss: 0.843058, loss_d: 0.408016
0.2312 --- loss: 1.484133, loss_ss: 1.170497, loss_d: 0.313636
0.2697 --- loss: 1.569485, loss_ss: 1.110780, loss_d: 0.458705
0.3083 --- loss: 0.791690, loss_ss: 0.525421, loss_d: 0.266269
0.3468 --- loss: 1.709524, loss_ss: 1.379694, loss_d: 0.329830
0.3854 --- loss: 1.082740, loss_ss: 0.733392, loss_d: 0.349348
0.4239 --- loss: 1.304176, loss_ss: 0.977644, loss_d: 0.326533
0.4624 --- loss: 1.396520, loss_ss: 0.880951, loss_d: 0.515569
0.5010 --- loss: 0.843269, loss_ss: 0.674336, loss_d: 0.168933
0.5395 --- loss: 1.916725, loss_ss: 0.836082, loss_d: 1.080643
0.5780 --- loss: 1.357407, loss_ss: 0.843053, loss_d: 0.514354
0.6166 --- loss: 1.354347, loss_ss: 1.141558, loss_d: 0.212789
0.6551 --- loss: 1.336247, loss_ss: 1.115296, loss_d: 0.220951
0.6936 --- loss: 1.308349, loss_ss: 0.942892, loss_d: 0.365458
0.7322 --- loss: 0.917428, loss_ss: 0.757486, loss_d: 0.159942
0.7707 --- loss: 1.022010, loss_ss: 0.823478, loss_d: 0.198532
0.8092 --- loss: 1.325753, loss_ss: 1.129492, loss_d: 0.196261
0.8478 --- loss: 1.221598, loss_ss: 1.055592, loss_d: 0.166006
0.8863 --- loss: 1.640064, loss_ss: 1.087652, loss_d: 0.552411
0.9249 --- loss: 1.422248, loss_ss: 0.828585, loss_d: 0.593663
0.9634 --- loss: 0.996269, loss_ss: 0.747818, loss_d: 0.248451
Epoch finished! Loss: 1.2505161124767024
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.897828, loss_ss: 0.709077, loss_d: 0.188751
0.0385 --- loss: 1.390367, loss_ss: 1.022373, loss_d: 0.367994
0.0771 --- loss: 1.291876, loss_ss: 1.075769, loss_d: 0.216107
0.1156 --- loss: 1.111305, loss_ss: 0.861132, loss_d: 0.250173
0.1541 --- loss: 0.967086, loss_ss: 0.776182, loss_d: 0.190904
0.1927 --- loss: 0.981266, loss_ss: 0.772517, loss_d: 0.208749
0.2312 --- loss: 1.670238, loss_ss: 1.035996, loss_d: 0.634242
0.2697 --- loss: 1.494383, loss_ss: 0.841197, loss_d: 0.653186
0.3083 --- loss: 1.259172, loss_ss: 0.771639, loss_d: 0.487534
0.3468 --- loss: 1.025602, loss_ss: 0.839042, loss_d: 0.186560
0.3854 --- loss: 0.909569, loss_ss: 0.642834, loss_d: 0.266736
0.4239 --- loss: 1.595102, loss_ss: 1.109988, loss_d: 0.485114
0.4624 --- loss: 1.097597, loss_ss: 0.766469, loss_d: 0.331128
0.5010 --- loss: 1.251669, loss_ss: 1.007624, loss_d: 0.244045
0.5395 --- loss: 0.885263, loss_ss: 0.691885, loss_d: 0.193378
0.5780 --- loss: 0.952830, loss_ss: 0.817706, loss_d: 0.135124
0.6166 --- loss: 1.204952, loss_ss: 1.088552, loss_d: 0.116399
0.6551 --- loss: 1.089606, loss_ss: 0.874394, loss_d: 0.215212
0.6936 --- loss: 1.102303, loss_ss: 0.789178, loss_d: 0.313124
0.7322 --- loss: 1.233090, loss_ss: 0.933154, loss_d: 0.299937
0.7707 --- loss: 0.949114, loss_ss: 0.760064, loss_d: 0.189050
0.8092 --- loss: 1.146188, loss_ss: 0.780830, loss_d: 0.365358
0.8478 --- loss: 1.242908, loss_ss: 0.863034, loss_d: 0.379874
0.8863 --- loss: 1.102382, loss_ss: 0.773917, loss_d: 0.328465
0.9249 --- loss: 1.337173, loss_ss: 0.973651, loss_d: 0.363522
0.9634 --- loss: 1.223974, loss_ss: 0.787649, loss_d: 0.436325
Epoch finished! Loss: 1.205257071491374
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.038392, loss_ss: 0.777557, loss_d: 0.260835
0.0385 --- loss: 1.167400, loss_ss: 0.892131, loss_d: 0.275270
0.0771 --- loss: 1.163332, loss_ss: 0.945116, loss_d: 0.218215
0.1156 --- loss: 0.751189, loss_ss: 0.630439, loss_d: 0.120749
0.1541 --- loss: 1.483132, loss_ss: 1.151524, loss_d: 0.331608
0.1927 --- loss: 1.367743, loss_ss: 0.907903, loss_d: 0.459840
0.2312 --- loss: 1.633916, loss_ss: 0.998274, loss_d: 0.635642
0.2697 --- loss: 1.194161, loss_ss: 0.798951, loss_d: 0.395210
0.3083 --- loss: 1.165190, loss_ss: 1.039225, loss_d: 0.125965
0.3468 --- loss: 1.210594, loss_ss: 0.872039, loss_d: 0.338555
0.3854 --- loss: 0.751842, loss_ss: 0.541229, loss_d: 0.210614
0.4239 --- loss: 1.280475, loss_ss: 1.045270, loss_d: 0.235205
0.4624 --- loss: 0.871499, loss_ss: 0.714874, loss_d: 0.156625
0.5010 --- loss: 1.235372, loss_ss: 0.940611, loss_d: 0.294762
0.5395 --- loss: 0.993249, loss_ss: 0.914697, loss_d: 0.078553
0.5780 --- loss: 1.786951, loss_ss: 1.038934, loss_d: 0.748017
0.6166 --- loss: 0.993079, loss_ss: 0.921751, loss_d: 0.071327
0.6551 --- loss: 1.315171, loss_ss: 1.142971, loss_d: 0.172200
0.6936 --- loss: 1.216216, loss_ss: 0.774111, loss_d: 0.442106
0.7322 --- loss: 0.733714, loss_ss: 0.660072, loss_d: 0.073642
0.7707 --- loss: 1.730264, loss_ss: 0.806414, loss_d: 0.923851
0.8092 --- loss: 1.548349, loss_ss: 1.080952, loss_d: 0.467397
0.8478 --- loss: 1.066891, loss_ss: 0.925579, loss_d: 0.141312
0.8863 --- loss: 0.965140, loss_ss: 0.817876, loss_d: 0.147264
0.9249 --- loss: 1.541227, loss_ss: 1.097063, loss_d: 0.444164
0.9634 --- loss: 0.907806, loss_ss: 0.727090, loss_d: 0.180716
Epoch finished! Loss: 1.169043219457722
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7062015503875969
             precision    recall  f1-score   support

        0.0       0.45      0.57      0.50        69
        1.0       0.00      0.00      0.00       238
        2.0       0.81      0.91      0.86       565
        3.0       0.94      0.84      0.89       136
        4.0       0.54      0.87      0.67       282

avg / total       0.60      0.71      0.64      1290
 


====== chp005-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  94.03  56.52   96.15  45.35     50.32
1  81.47   0.00   99.90   0.00      0.00
2  86.82  90.80   83.72  81.30     85.79
3  97.75  83.82   99.39  94.21     88.72
4  81.16  86.88   79.56  54.32     66.85
Total accuracy: 70.62%
Average sen: 63.60%
Average spec: 91.75%
Macro f1-score: 58.33%
Diagnosis acc on 15mins: 1.0
[0.99758399 0.99134201 0.94414419 0.98858672 0.99891698 0.99847156
 0.99918944 0.99836272 0.99637336 0.99806875 0.99808025 0.988841
 0.97246844 0.99884355 0.9947477  0.99668604 0.99656856 0.99096698
 0.99840158 0.99666023 0.99691951 0.99924529 0.99897718 0.99877423
 0.99745697 0.99922621 0.99734771 0.99692565 0.97958678 0.9963814
 0.99802136 0.99629527 0.92837512 0.9988091  0.96552724 0.99805909
 0.99393797 0.99728143 0.99868661 0.9986338  0.97307938 0.99535203
 0.99832076]
pred: 0.991733119931332, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp006-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.430501, loss_ss: 1.744462, loss_d: 0.686039
0.0384 --- loss: 2.162063, loss_ss: 1.424557, loss_d: 0.737506
0.0769 --- loss: 2.148417, loss_ss: 1.602148, loss_d: 0.546270
0.1153 --- loss: 1.940624, loss_ss: 1.608566, loss_d: 0.332058
0.1537 --- loss: 2.146139, loss_ss: 1.423692, loss_d: 0.722448
0.1922 --- loss: 2.307640, loss_ss: 1.679499, loss_d: 0.628141
0.2306 --- loss: 2.295004, loss_ss: 1.570911, loss_d: 0.724093
0.2690 --- loss: 2.112236, loss_ss: 1.623588, loss_d: 0.488649
0.3075 --- loss: 2.105227, loss_ss: 1.433175, loss_d: 0.672052
0.3459 --- loss: 2.057635, loss_ss: 1.374339, loss_d: 0.683295
0.3843 --- loss: 1.758717, loss_ss: 1.260072, loss_d: 0.498645
0.4228 --- loss: 2.080811, loss_ss: 1.386376, loss_d: 0.694435
0.4612 --- loss: 2.069989, loss_ss: 1.533798, loss_d: 0.536191
0.4996 --- loss: 1.870308, loss_ss: 1.248053, loss_d: 0.622256
0.5380 --- loss: 1.991410, loss_ss: 1.237223, loss_d: 0.754188
0.5765 --- loss: 1.824751, loss_ss: 1.262640, loss_d: 0.562111
0.6149 --- loss: 1.814220, loss_ss: 1.314628, loss_d: 0.499592
0.6533 --- loss: 1.632009, loss_ss: 1.158108, loss_d: 0.473901
0.6918 --- loss: 1.762594, loss_ss: 1.362926, loss_d: 0.399669
0.7302 --- loss: 1.942210, loss_ss: 1.219659, loss_d: 0.722551
0.7686 --- loss: 2.021663, loss_ss: 1.313440, loss_d: 0.708223
0.8071 --- loss: 1.776792, loss_ss: 1.209748, loss_d: 0.567044
0.8455 --- loss: 2.104148, loss_ss: 1.358761, loss_d: 0.745388
0.8839 --- loss: 1.726437, loss_ss: 1.090491, loss_d: 0.635946
0.9224 --- loss: 1.712555, loss_ss: 1.360618, loss_d: 0.351937
0.9608 --- loss: 1.403721, loss_ss: 1.174295, loss_d: 0.229426
0.9992 --- loss: 3.347108, loss_ss: 1.807125, loss_d: 1.539983
Epoch finished! Loss: 1.9943978662674244
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.693532, loss_ss: 1.202108, loss_d: 0.491424
0.0384 --- loss: 1.811758, loss_ss: 1.191676, loss_d: 0.620082
0.0769 --- loss: 2.109291, loss_ss: 1.328156, loss_d: 0.781135
0.1153 --- loss: 1.926090, loss_ss: 1.270790, loss_d: 0.655301
0.1537 --- loss: 1.839326, loss_ss: 1.304652, loss_d: 0.534674
0.1922 --- loss: 1.346773, loss_ss: 1.094832, loss_d: 0.251941
0.2306 --- loss: 1.758005, loss_ss: 1.392073, loss_d: 0.365932
0.2690 --- loss: 1.756028, loss_ss: 1.209928, loss_d: 0.546100
0.3075 --- loss: 1.645731, loss_ss: 1.067916, loss_d: 0.577815
0.3459 --- loss: 1.680945, loss_ss: 1.257264, loss_d: 0.423681
0.3843 --- loss: 1.738204, loss_ss: 1.205474, loss_d: 0.532730
0.4228 --- loss: 1.635433, loss_ss: 1.066008, loss_d: 0.569426
0.4612 --- loss: 1.692335, loss_ss: 1.261239, loss_d: 0.431096
0.4996 --- loss: 1.771206, loss_ss: 1.095129, loss_d: 0.676077
0.5380 --- loss: 1.962257, loss_ss: 1.295250, loss_d: 0.667007
0.5765 --- loss: 1.773450, loss_ss: 1.014390, loss_d: 0.759060
0.6149 --- loss: 1.656695, loss_ss: 1.276156, loss_d: 0.380539
0.6533 --- loss: 1.947913, loss_ss: 1.141522, loss_d: 0.806391
0.6918 --- loss: 1.889607, loss_ss: 1.343413, loss_d: 0.546193
0.7302 --- loss: 1.822133, loss_ss: 1.048294, loss_d: 0.773838
0.7686 --- loss: 1.649502, loss_ss: 1.128339, loss_d: 0.521163
0.8071 --- loss: 1.598421, loss_ss: 1.031767, loss_d: 0.566654
0.8455 --- loss: 1.736056, loss_ss: 1.192487, loss_d: 0.543569
0.8839 --- loss: 1.955014, loss_ss: 1.201305, loss_d: 0.753709
0.9224 --- loss: 1.884386, loss_ss: 1.126781, loss_d: 0.757605
0.9608 --- loss: 1.815117, loss_ss: 0.983880, loss_d: 0.831237
0.9992 --- loss: 2.369577, loss_ss: 1.060227, loss_d: 1.309350
Epoch finished! Loss: 1.786682094518955
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.526053, loss_ss: 1.128516, loss_d: 0.397537
0.0384 --- loss: 1.874437, loss_ss: 1.255896, loss_d: 0.618541
0.0769 --- loss: 1.616609, loss_ss: 0.826029, loss_d: 0.790580
0.1153 --- loss: 1.723670, loss_ss: 1.034732, loss_d: 0.688938
0.1537 --- loss: 1.638000, loss_ss: 1.087792, loss_d: 0.550208
0.1922 --- loss: 1.828965, loss_ss: 1.055975, loss_d: 0.772989
0.2306 --- loss: 1.712922, loss_ss: 1.276449, loss_d: 0.436473
0.2690 --- loss: 1.514731, loss_ss: 0.974494, loss_d: 0.540237
0.3075 --- loss: 1.391719, loss_ss: 0.936016, loss_d: 0.455703
0.3459 --- loss: 1.531554, loss_ss: 0.941272, loss_d: 0.590281
0.3843 --- loss: 1.728582, loss_ss: 1.103262, loss_d: 0.625320
0.4228 --- loss: 1.694276, loss_ss: 1.344112, loss_d: 0.350164
0.4612 --- loss: 1.529567, loss_ss: 0.895328, loss_d: 0.634240
0.4996 --- loss: 1.643500, loss_ss: 1.110353, loss_d: 0.533147
0.5380 --- loss: 2.014107, loss_ss: 1.134941, loss_d: 0.879166
0.5765 --- loss: 1.737613, loss_ss: 1.431957, loss_d: 0.305656
0.6149 --- loss: 1.450180, loss_ss: 0.966517, loss_d: 0.483663
0.6533 --- loss: 1.851124, loss_ss: 1.325349, loss_d: 0.525776
0.6918 --- loss: 1.755959, loss_ss: 0.930182, loss_d: 0.825777
0.7302 --- loss: 1.857104, loss_ss: 1.302301, loss_d: 0.554803
0.7686 --- loss: 1.477427, loss_ss: 1.123112, loss_d: 0.354315
0.8071 --- loss: 1.577346, loss_ss: 1.095001, loss_d: 0.482346
0.8455 --- loss: 1.485900, loss_ss: 0.902909, loss_d: 0.582991
0.8839 --- loss: 1.372570, loss_ss: 0.966167, loss_d: 0.406403
0.9224 --- loss: 1.555664, loss_ss: 1.079092, loss_d: 0.476572
0.9608 --- loss: 1.536960, loss_ss: 1.177837, loss_d: 0.359122
0.9992 --- loss: 2.758498, loss_ss: 1.592587, loss_d: 1.165911
Epoch finished! Loss: 1.6660808994219853
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 2.058313, loss_ss: 1.390853, loss_d: 0.667461
0.0384 --- loss: 1.356753, loss_ss: 0.896771, loss_d: 0.459982
0.0769 --- loss: 1.542731, loss_ss: 0.923121, loss_d: 0.619611
0.1153 --- loss: 1.582565, loss_ss: 1.002274, loss_d: 0.580291
0.1537 --- loss: 1.694355, loss_ss: 1.057381, loss_d: 0.636974
0.1922 --- loss: 1.568030, loss_ss: 0.884491, loss_d: 0.683539
0.2306 --- loss: 1.634133, loss_ss: 1.029402, loss_d: 0.604730
0.2690 --- loss: 1.314925, loss_ss: 0.810573, loss_d: 0.504352
0.3075 --- loss: 1.281349, loss_ss: 0.840019, loss_d: 0.441331
0.3459 --- loss: 1.439069, loss_ss: 0.827466, loss_d: 0.611603
0.3843 --- loss: 1.963111, loss_ss: 1.306043, loss_d: 0.657067
0.4228 --- loss: 1.825328, loss_ss: 1.206027, loss_d: 0.619300
0.4612 --- loss: 1.618075, loss_ss: 0.983188, loss_d: 0.634888
0.4996 --- loss: 1.607923, loss_ss: 0.930454, loss_d: 0.677469
0.5380 --- loss: 1.732170, loss_ss: 1.036581, loss_d: 0.695589
0.5765 --- loss: 1.963336, loss_ss: 1.118617, loss_d: 0.844719
0.6149 --- loss: 1.628372, loss_ss: 1.179359, loss_d: 0.449013
0.6533 --- loss: 1.455218, loss_ss: 1.072006, loss_d: 0.383212
0.6918 --- loss: 1.270015, loss_ss: 0.839855, loss_d: 0.430160
0.7302 --- loss: 1.782729, loss_ss: 0.939840, loss_d: 0.842889
0.7686 --- loss: 1.211154, loss_ss: 0.937056, loss_d: 0.274098
0.8071 --- loss: 1.343191, loss_ss: 0.714273, loss_d: 0.628918
0.8455 --- loss: 1.525590, loss_ss: 0.937150, loss_d: 0.588439
0.8839 --- loss: 1.803234, loss_ss: 1.173286, loss_d: 0.629947
0.9224 --- loss: 1.441184, loss_ss: 0.951710, loss_d: 0.489474
0.9608 --- loss: 1.683866, loss_ss: 1.297255, loss_d: 0.386611
0.9992 --- loss: 3.126164, loss_ss: 1.272615, loss_d: 1.853549
Epoch finished! Loss: 1.5623922797349783
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.202621, loss_ss: 0.903633, loss_d: 0.298988
0.0384 --- loss: 1.654648, loss_ss: 0.926014, loss_d: 0.728633
0.0769 --- loss: 1.359764, loss_ss: 0.787705, loss_d: 0.572059
0.1153 --- loss: 1.343830, loss_ss: 0.803793, loss_d: 0.540037
0.1537 --- loss: 1.158066, loss_ss: 0.788655, loss_d: 0.369411
0.1922 --- loss: 1.454061, loss_ss: 0.953870, loss_d: 0.500190
0.2306 --- loss: 1.543843, loss_ss: 0.840410, loss_d: 0.703433
0.2690 --- loss: 1.445704, loss_ss: 1.124702, loss_d: 0.321002
0.3075 --- loss: 1.694621, loss_ss: 1.191248, loss_d: 0.503373
0.3459 --- loss: 1.099119, loss_ss: 0.788325, loss_d: 0.310794
0.3843 --- loss: 1.663061, loss_ss: 1.098843, loss_d: 0.564218
0.4228 --- loss: 1.577231, loss_ss: 0.928921, loss_d: 0.648311
0.4612 --- loss: 1.611406, loss_ss: 0.816135, loss_d: 0.795271
0.4996 --- loss: 1.397048, loss_ss: 0.904835, loss_d: 0.492213
0.5380 --- loss: 1.415861, loss_ss: 0.893945, loss_d: 0.521917
0.5765 --- loss: 1.459754, loss_ss: 1.176818, loss_d: 0.282936
0.6149 --- loss: 1.273878, loss_ss: 0.904692, loss_d: 0.369186
0.6533 --- loss: 1.609838, loss_ss: 0.802597, loss_d: 0.807241
0.6918 --- loss: 1.478118, loss_ss: 1.054779, loss_d: 0.423339
0.7302 --- loss: 1.535649, loss_ss: 0.850753, loss_d: 0.684896
0.7686 --- loss: 1.836851, loss_ss: 1.258316, loss_d: 0.578535
0.8071 --- loss: 1.271963, loss_ss: 0.932925, loss_d: 0.339038
0.8455 --- loss: 1.483121, loss_ss: 1.071485, loss_d: 0.411635
0.8839 --- loss: 1.881728, loss_ss: 1.288742, loss_d: 0.592987
0.9224 --- loss: 1.384995, loss_ss: 0.983068, loss_d: 0.401927
0.9608 --- loss: 1.498607, loss_ss: 1.002673, loss_d: 0.495934
0.9992 --- loss: 1.521110, loss_ss: 1.173937, loss_d: 0.347173
Epoch finished! Loss: 1.461047112941742
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.411704, loss_ss: 0.956351, loss_d: 0.455354
0.0384 --- loss: 1.366234, loss_ss: 0.998870, loss_d: 0.367364
0.0769 --- loss: 1.150779, loss_ss: 0.796269, loss_d: 0.354510
0.1153 --- loss: 1.313918, loss_ss: 0.986155, loss_d: 0.327763
0.1537 --- loss: 1.514049, loss_ss: 0.739403, loss_d: 0.774647
0.1922 --- loss: 1.003380, loss_ss: 0.703123, loss_d: 0.300257
0.2306 --- loss: 1.209940, loss_ss: 0.949454, loss_d: 0.260486
0.2690 --- loss: 1.278358, loss_ss: 0.839075, loss_d: 0.439284
0.3075 --- loss: 1.284446, loss_ss: 0.960680, loss_d: 0.323766
0.3459 --- loss: 1.247279, loss_ss: 0.769392, loss_d: 0.477887
0.3843 --- loss: 1.747275, loss_ss: 1.178139, loss_d: 0.569135
0.4228 --- loss: 1.212152, loss_ss: 0.942885, loss_d: 0.269267
0.4612 --- loss: 1.365659, loss_ss: 1.083315, loss_d: 0.282344
0.4996 --- loss: 1.446624, loss_ss: 0.975551, loss_d: 0.471073
0.5380 --- loss: 1.260385, loss_ss: 0.961982, loss_d: 0.298403
0.5765 --- loss: 1.519311, loss_ss: 1.092808, loss_d: 0.426503
0.6149 --- loss: 1.715744, loss_ss: 1.032083, loss_d: 0.683661
0.6533 --- loss: 1.180334, loss_ss: 0.846409, loss_d: 0.333925
0.6918 --- loss: 1.429467, loss_ss: 1.041806, loss_d: 0.387661
0.7302 --- loss: 1.507776, loss_ss: 1.030317, loss_d: 0.477459
0.7686 --- loss: 1.277267, loss_ss: 0.951263, loss_d: 0.326004
0.8071 --- loss: 1.334458, loss_ss: 0.769835, loss_d: 0.564622
0.8455 --- loss: 1.159148, loss_ss: 0.796505, loss_d: 0.362643
0.8839 --- loss: 1.606347, loss_ss: 1.287556, loss_d: 0.318791
0.9224 --- loss: 0.896111, loss_ss: 0.624811, loss_d: 0.271300
0.9608 --- loss: 1.546034, loss_ss: 1.207540, loss_d: 0.338494
0.9992 --- loss: 3.111896, loss_ss: 0.925648, loss_d: 2.186248
Epoch finished! Loss: 1.3767865999386861
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.131209, loss_ss: 0.894032, loss_d: 0.237177
0.0384 --- loss: 1.317742, loss_ss: 1.010702, loss_d: 0.307039
0.0769 --- loss: 1.401423, loss_ss: 0.898302, loss_d: 0.503121
0.1153 --- loss: 1.578342, loss_ss: 1.251063, loss_d: 0.327279
0.1537 --- loss: 1.276178, loss_ss: 1.021261, loss_d: 0.254917
0.1922 --- loss: 1.221046, loss_ss: 0.736987, loss_d: 0.484059
0.2306 --- loss: 1.159734, loss_ss: 0.797010, loss_d: 0.362724
0.2690 --- loss: 1.641420, loss_ss: 1.115958, loss_d: 0.525462
0.3075 --- loss: 1.581139, loss_ss: 1.261396, loss_d: 0.319743
0.3459 --- loss: 1.396680, loss_ss: 1.082049, loss_d: 0.314631
0.3843 --- loss: 0.924636, loss_ss: 0.773824, loss_d: 0.150812
0.4228 --- loss: 0.840604, loss_ss: 0.743833, loss_d: 0.096771
0.4612 --- loss: 0.760916, loss_ss: 0.555655, loss_d: 0.205261
0.4996 --- loss: 0.996565, loss_ss: 0.730557, loss_d: 0.266009
0.5380 --- loss: 1.116842, loss_ss: 0.655080, loss_d: 0.461762
0.5765 --- loss: 1.304790, loss_ss: 0.728159, loss_d: 0.576631
0.6149 --- loss: 1.537404, loss_ss: 1.271333, loss_d: 0.266071
0.6533 --- loss: 1.223343, loss_ss: 0.977640, loss_d: 0.245703
0.6918 --- loss: 1.393649, loss_ss: 0.795951, loss_d: 0.597698
0.7302 --- loss: 1.307087, loss_ss: 1.006366, loss_d: 0.300722
0.7686 --- loss: 1.191737, loss_ss: 0.720490, loss_d: 0.471246
0.8071 --- loss: 1.568405, loss_ss: 1.152497, loss_d: 0.415909
0.8455 --- loss: 1.064228, loss_ss: 0.721234, loss_d: 0.342994
0.8839 --- loss: 1.026505, loss_ss: 0.792178, loss_d: 0.234327
0.9224 --- loss: 1.150377, loss_ss: 0.975603, loss_d: 0.174774
0.9608 --- loss: 1.680960, loss_ss: 0.759511, loss_d: 0.921449
0.9992 --- loss: 2.388116, loss_ss: 2.157780, loss_d: 0.230336
Epoch finished! Loss: 1.3122461825609206
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.512591, loss_ss: 1.104965, loss_d: 0.407625
0.0384 --- loss: 1.300808, loss_ss: 0.696835, loss_d: 0.603973
0.0769 --- loss: 0.865134, loss_ss: 0.778579, loss_d: 0.086555
0.1153 --- loss: 1.406192, loss_ss: 0.673361, loss_d: 0.732831
0.1537 --- loss: 1.166305, loss_ss: 1.022332, loss_d: 0.143973
0.1922 --- loss: 1.311814, loss_ss: 0.970701, loss_d: 0.341113
0.2306 --- loss: 1.281750, loss_ss: 0.861123, loss_d: 0.420627
0.2690 --- loss: 1.632479, loss_ss: 0.948318, loss_d: 0.684161
0.3075 --- loss: 1.383613, loss_ss: 0.872530, loss_d: 0.511084
0.3459 --- loss: 1.199193, loss_ss: 0.871986, loss_d: 0.327207
0.3843 --- loss: 1.742337, loss_ss: 1.000216, loss_d: 0.742121
0.4228 --- loss: 1.129754, loss_ss: 0.868181, loss_d: 0.261573
0.4612 --- loss: 1.342874, loss_ss: 0.895551, loss_d: 0.447323
0.4996 --- loss: 0.936472, loss_ss: 0.740761, loss_d: 0.195711
0.5380 --- loss: 0.928201, loss_ss: 0.687619, loss_d: 0.240582
0.5765 --- loss: 1.146089, loss_ss: 0.883999, loss_d: 0.262090
0.6149 --- loss: 1.039037, loss_ss: 0.764436, loss_d: 0.274601
0.6533 --- loss: 1.280405, loss_ss: 0.955789, loss_d: 0.324616
0.6918 --- loss: 1.379460, loss_ss: 0.958048, loss_d: 0.421412
0.7302 --- loss: 1.103091, loss_ss: 0.759282, loss_d: 0.343809
0.7686 --- loss: 1.681809, loss_ss: 1.185561, loss_d: 0.496248
0.8071 --- loss: 1.596301, loss_ss: 1.269477, loss_d: 0.326824
0.8455 --- loss: 1.462651, loss_ss: 1.072148, loss_d: 0.390504
0.8839 --- loss: 1.525619, loss_ss: 0.965293, loss_d: 0.560326
0.9224 --- loss: 1.347769, loss_ss: 1.170829, loss_d: 0.176940
0.9608 --- loss: 1.133539, loss_ss: 0.602747, loss_d: 0.530792
0.9992 --- loss: 0.698674, loss_ss: 0.462323, loss_d: 0.236351
Epoch finished! Loss: 1.2487397143473993
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.083403, loss_ss: 0.788415, loss_d: 0.294988
0.0384 --- loss: 1.431243, loss_ss: 1.176414, loss_d: 0.254828
0.0769 --- loss: 1.338573, loss_ss: 1.017814, loss_d: 0.320759
0.1153 --- loss: 1.164644, loss_ss: 0.754980, loss_d: 0.409664
0.1537 --- loss: 1.062907, loss_ss: 0.756216, loss_d: 0.306691
0.1922 --- loss: 0.817844, loss_ss: 0.580338, loss_d: 0.237506
0.2306 --- loss: 0.898070, loss_ss: 0.763219, loss_d: 0.134851
0.2690 --- loss: 0.957609, loss_ss: 0.652617, loss_d: 0.304992
0.3075 --- loss: 1.570844, loss_ss: 0.925863, loss_d: 0.644981
0.3459 --- loss: 0.901549, loss_ss: 0.684264, loss_d: 0.217285
0.3843 --- loss: 1.849285, loss_ss: 0.996206, loss_d: 0.853079
0.4228 --- loss: 1.057340, loss_ss: 0.760208, loss_d: 0.297132
0.4612 --- loss: 1.192853, loss_ss: 0.984727, loss_d: 0.208126
0.4996 --- loss: 1.359892, loss_ss: 1.106865, loss_d: 0.253027
0.5380 --- loss: 1.014030, loss_ss: 0.732542, loss_d: 0.281488
0.5765 --- loss: 1.013361, loss_ss: 0.797587, loss_d: 0.215774
0.6149 --- loss: 0.869284, loss_ss: 0.593119, loss_d: 0.276165
0.6533 --- loss: 1.252156, loss_ss: 0.967995, loss_d: 0.284161
0.6918 --- loss: 1.175302, loss_ss: 0.794207, loss_d: 0.381095
0.7302 --- loss: 1.528540, loss_ss: 0.983678, loss_d: 0.544862
0.7686 --- loss: 1.095598, loss_ss: 0.673888, loss_d: 0.421710
0.8071 --- loss: 0.978626, loss_ss: 0.806665, loss_d: 0.171961
0.8455 --- loss: 1.095175, loss_ss: 0.943816, loss_d: 0.151359
0.8839 --- loss: 1.088808, loss_ss: 0.926512, loss_d: 0.162296
0.9224 --- loss: 1.268066, loss_ss: 1.061817, loss_d: 0.206250
0.9608 --- loss: 0.870942, loss_ss: 0.632181, loss_d: 0.238761
0.9992 --- loss: 1.550686, loss_ss: 1.087499, loss_d: 0.463187
Epoch finished! Loss: 1.2143532477892363
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.160007, loss_ss: 0.772243, loss_d: 0.387764
0.0384 --- loss: 0.968333, loss_ss: 0.765595, loss_d: 0.202738
0.0769 --- loss: 0.955743, loss_ss: 0.671659, loss_d: 0.284084
0.1153 --- loss: 1.066822, loss_ss: 0.780776, loss_d: 0.286045
0.1537 --- loss: 1.129237, loss_ss: 0.984343, loss_d: 0.144894
0.1922 --- loss: 1.053349, loss_ss: 0.788037, loss_d: 0.265312
0.2306 --- loss: 1.284759, loss_ss: 0.684338, loss_d: 0.600421
0.2690 --- loss: 1.045605, loss_ss: 0.920801, loss_d: 0.124804
0.3075 --- loss: 1.153110, loss_ss: 0.753980, loss_d: 0.399130
0.3459 --- loss: 1.347180, loss_ss: 0.915656, loss_d: 0.431524
0.3843 --- loss: 1.153829, loss_ss: 0.863509, loss_d: 0.290319
0.4228 --- loss: 1.344404, loss_ss: 0.883734, loss_d: 0.460670
0.4612 --- loss: 0.969333, loss_ss: 0.722694, loss_d: 0.246640
0.4996 --- loss: 1.052633, loss_ss: 0.758881, loss_d: 0.293752
0.5380 --- loss: 0.800417, loss_ss: 0.719927, loss_d: 0.080490
0.5765 --- loss: 1.021969, loss_ss: 0.772466, loss_d: 0.249503
0.6149 --- loss: 1.016971, loss_ss: 0.867221, loss_d: 0.149750
0.6533 --- loss: 0.867252, loss_ss: 0.667801, loss_d: 0.199451
0.6918 --- loss: 1.736957, loss_ss: 1.224383, loss_d: 0.512574
0.7302 --- loss: 0.865872, loss_ss: 0.771590, loss_d: 0.094282
0.7686 --- loss: 1.266050, loss_ss: 0.794108, loss_d: 0.471942
0.8071 --- loss: 1.258114, loss_ss: 0.766657, loss_d: 0.491456
0.8455 --- loss: 0.992698, loss_ss: 0.710990, loss_d: 0.281708
0.8839 --- loss: 0.879671, loss_ss: 0.716780, loss_d: 0.162890
0.9224 --- loss: 1.355772, loss_ss: 0.722699, loss_d: 0.633073
0.9608 --- loss: 0.842707, loss_ss: 0.621246, loss_d: 0.221460
0.9992 --- loss: 1.312292, loss_ss: 1.079952, loss_d: 0.232341
Epoch finished! Loss: 1.1761846038011403
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.562037037037037
             precision    recall  f1-score   support

        0.0       0.37      0.67      0.48       120
        1.0       0.53      0.21      0.31       322
        2.0       0.48      0.94      0.64       274
        3.0       0.99      0.87      0.92       224
        4.0       0.86      0.04      0.08       140

avg / total       0.64      0.56      0.51      1080
 


====== chp006-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.89  66.67   86.04  37.38     47.90
1  71.02  21.43   92.08  53.49     30.60
2  72.96  94.16   65.76  48.31     63.86
3  97.04  86.61   99.77  98.98     92.38
4  87.50   4.29   99.89  85.71      8.16
Total accuracy: 56.20%
Average sen: 54.63%
Average spec: 88.71%
Macro f1-score: 48.58%
Diagnosis acc on 15mins: 1.0
[0.94667721 0.56173426 0.87879342 0.92308635 0.97598821 0.60536951
 0.7495532  0.98481315 0.97719085 0.98944479 0.85279703 0.97100854
 0.99653542 0.91594428 0.98291504 0.97065485 0.79752469 0.99747181
 0.99820626 0.90743476 0.99332517 0.90378529 0.97505414 0.99803096
 0.74660707 0.95918137 0.71529019 0.8125385  0.96421301 0.72406781
 0.88697493 0.96790165 0.90901929 0.8925128  0.91953117 0.99123198]
pred: 0.8984002487527, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp007-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.156928, loss_ss: 1.536522, loss_d: 0.620406
0.0385 --- loss: 1.977814, loss_ss: 1.498668, loss_d: 0.479146
0.0769 --- loss: 2.292510, loss_ss: 1.605625, loss_d: 0.686885
0.1154 --- loss: 1.708964, loss_ss: 1.462207, loss_d: 0.246757
0.1538 --- loss: 2.002951, loss_ss: 1.373681, loss_d: 0.629270
0.1923 --- loss: 1.984723, loss_ss: 1.296743, loss_d: 0.687980
0.2308 --- loss: 1.944381, loss_ss: 1.479619, loss_d: 0.464762
0.2692 --- loss: 2.096130, loss_ss: 1.413897, loss_d: 0.682232
0.3077 --- loss: 1.664116, loss_ss: 1.251229, loss_d: 0.412887
0.3462 --- loss: 1.939960, loss_ss: 1.271859, loss_d: 0.668102
0.3846 --- loss: 1.919618, loss_ss: 1.178517, loss_d: 0.741101
0.4231 --- loss: 1.921944, loss_ss: 1.096238, loss_d: 0.825706
0.4615 --- loss: 1.653572, loss_ss: 1.051415, loss_d: 0.602157
0.5000 --- loss: 1.908698, loss_ss: 1.173493, loss_d: 0.735205
0.5385 --- loss: 1.948751, loss_ss: 1.139828, loss_d: 0.808923
0.5769 --- loss: 1.891715, loss_ss: 1.086654, loss_d: 0.805061
0.6154 --- loss: 1.766633, loss_ss: 1.167206, loss_d: 0.599428
0.6538 --- loss: 1.716048, loss_ss: 1.120349, loss_d: 0.595699
0.6923 --- loss: 1.705032, loss_ss: 1.171288, loss_d: 0.533744
0.7308 --- loss: 1.602330, loss_ss: 1.063798, loss_d: 0.538532
0.7692 --- loss: 1.638769, loss_ss: 1.151003, loss_d: 0.487766
0.8077 --- loss: 1.751059, loss_ss: 1.099576, loss_d: 0.651484
0.8462 --- loss: 1.883587, loss_ss: 1.347767, loss_d: 0.535820
0.8846 --- loss: 1.812186, loss_ss: 1.127459, loss_d: 0.684728
0.9231 --- loss: 1.638785, loss_ss: 1.177705, loss_d: 0.461080
0.9615 --- loss: 1.749895, loss_ss: 1.220183, loss_d: 0.529712
Epoch finished! Loss: 1.8561477384972296
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.830157, loss_ss: 1.213380, loss_d: 0.616777
0.0385 --- loss: 1.859411, loss_ss: 1.131144, loss_d: 0.728267
0.0769 --- loss: 1.729896, loss_ss: 0.938314, loss_d: 0.791581
0.1154 --- loss: 1.698532, loss_ss: 0.936429, loss_d: 0.762103
0.1538 --- loss: 1.821905, loss_ss: 1.029527, loss_d: 0.792378
0.1923 --- loss: 1.548777, loss_ss: 0.958922, loss_d: 0.589855
0.2308 --- loss: 1.593205, loss_ss: 1.057738, loss_d: 0.535467
0.2692 --- loss: 1.686197, loss_ss: 1.276522, loss_d: 0.409675
0.3077 --- loss: 1.509785, loss_ss: 0.973965, loss_d: 0.535820
0.3462 --- loss: 1.704666, loss_ss: 1.120882, loss_d: 0.583784
0.3846 --- loss: 1.410638, loss_ss: 1.054708, loss_d: 0.355930
0.4231 --- loss: 1.770211, loss_ss: 1.274981, loss_d: 0.495230
0.4615 --- loss: 1.880360, loss_ss: 1.147567, loss_d: 0.732794
0.5000 --- loss: 1.559606, loss_ss: 0.989561, loss_d: 0.570045
0.5385 --- loss: 1.599961, loss_ss: 1.165928, loss_d: 0.434032
0.5769 --- loss: 1.600053, loss_ss: 1.097510, loss_d: 0.502543
0.6154 --- loss: 1.757620, loss_ss: 1.232903, loss_d: 0.524717
0.6538 --- loss: 1.391847, loss_ss: 0.899926, loss_d: 0.491921
0.6923 --- loss: 1.683175, loss_ss: 1.029144, loss_d: 0.654031
0.7308 --- loss: 1.718104, loss_ss: 1.159573, loss_d: 0.558531
0.7692 --- loss: 1.772048, loss_ss: 0.952599, loss_d: 0.819449
0.8077 --- loss: 1.283765, loss_ss: 0.993705, loss_d: 0.290060
0.8462 --- loss: 1.496481, loss_ss: 0.915782, loss_d: 0.580699
0.8846 --- loss: 1.636264, loss_ss: 1.137486, loss_d: 0.498778
0.9231 --- loss: 1.956877, loss_ss: 1.165831, loss_d: 0.791047
0.9615 --- loss: 1.746689, loss_ss: 1.181373, loss_d: 0.565316
Epoch finished! Loss: 1.6591085241568135
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.473640, loss_ss: 1.082613, loss_d: 0.391026
0.0385 --- loss: 1.418171, loss_ss: 0.977971, loss_d: 0.440199
0.0769 --- loss: 1.469891, loss_ss: 0.811342, loss_d: 0.658549
0.1154 --- loss: 1.627570, loss_ss: 0.977421, loss_d: 0.650149
0.1538 --- loss: 1.713241, loss_ss: 1.099393, loss_d: 0.613847
0.1923 --- loss: 1.863173, loss_ss: 1.360431, loss_d: 0.502743
0.2308 --- loss: 1.626712, loss_ss: 0.994912, loss_d: 0.631800
0.2692 --- loss: 1.581633, loss_ss: 1.135211, loss_d: 0.446422
0.3077 --- loss: 1.422505, loss_ss: 0.956704, loss_d: 0.465800
0.3462 --- loss: 1.777363, loss_ss: 1.213064, loss_d: 0.564299
0.3846 --- loss: 1.762106, loss_ss: 1.155614, loss_d: 0.606492
0.4231 --- loss: 1.572474, loss_ss: 1.239703, loss_d: 0.332770
0.4615 --- loss: 1.472139, loss_ss: 0.873138, loss_d: 0.599001
0.5000 --- loss: 1.304482, loss_ss: 0.853024, loss_d: 0.451458
0.5385 --- loss: 1.338380, loss_ss: 0.861530, loss_d: 0.476850
0.5769 --- loss: 1.465110, loss_ss: 0.836841, loss_d: 0.628269
0.6154 --- loss: 1.826405, loss_ss: 0.874897, loss_d: 0.951508
0.6538 --- loss: 1.810557, loss_ss: 1.168592, loss_d: 0.641966
0.6923 --- loss: 1.917591, loss_ss: 1.243677, loss_d: 0.673914
0.7308 --- loss: 1.886152, loss_ss: 0.946206, loss_d: 0.939946
0.7692 --- loss: 1.691466, loss_ss: 1.145762, loss_d: 0.545704
0.8077 --- loss: 1.643538, loss_ss: 0.961851, loss_d: 0.681687
0.8462 --- loss: 1.380667, loss_ss: 0.818889, loss_d: 0.561778
0.8846 --- loss: 1.574191, loss_ss: 0.638937, loss_d: 0.935254
0.9231 --- loss: 1.777975, loss_ss: 1.376587, loss_d: 0.401388
0.9615 --- loss: 1.307940, loss_ss: 0.815435, loss_d: 0.492505
Epoch finished! Loss: 1.5430858972910289
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.414100, loss_ss: 0.859127, loss_d: 0.554973
0.0385 --- loss: 1.418256, loss_ss: 0.952169, loss_d: 0.466087
0.0769 --- loss: 1.212569, loss_ss: 0.897867, loss_d: 0.314702
0.1154 --- loss: 1.023731, loss_ss: 0.705530, loss_d: 0.318201
0.1538 --- loss: 1.832824, loss_ss: 0.723607, loss_d: 1.109217
0.1923 --- loss: 1.699098, loss_ss: 0.881306, loss_d: 0.817792
0.2308 --- loss: 1.433658, loss_ss: 1.148795, loss_d: 0.284863
0.2692 --- loss: 1.256169, loss_ss: 0.949740, loss_d: 0.306429
0.3077 --- loss: 1.256628, loss_ss: 0.896216, loss_d: 0.360412
0.3462 --- loss: 1.314301, loss_ss: 0.896593, loss_d: 0.417709
0.3846 --- loss: 1.484984, loss_ss: 0.993831, loss_d: 0.491153
0.4231 --- loss: 1.275213, loss_ss: 0.746019, loss_d: 0.529193
0.4615 --- loss: 1.303402, loss_ss: 0.824718, loss_d: 0.478684
0.5000 --- loss: 1.601727, loss_ss: 1.008484, loss_d: 0.593244
0.5385 --- loss: 1.326683, loss_ss: 0.892730, loss_d: 0.433953
0.5769 --- loss: 1.500187, loss_ss: 0.913247, loss_d: 0.586940
0.6154 --- loss: 1.076023, loss_ss: 0.900386, loss_d: 0.175637
0.6538 --- loss: 1.301073, loss_ss: 0.869200, loss_d: 0.431873
0.6923 --- loss: 1.180918, loss_ss: 0.761957, loss_d: 0.418961
0.7308 --- loss: 1.474121, loss_ss: 1.006262, loss_d: 0.467859
0.7692 --- loss: 1.676865, loss_ss: 1.011048, loss_d: 0.665816
0.8077 --- loss: 1.558804, loss_ss: 1.186767, loss_d: 0.372037
0.8462 --- loss: 1.671350, loss_ss: 0.881342, loss_d: 0.790008
0.8846 --- loss: 1.249918, loss_ss: 0.940200, loss_d: 0.309718
0.9231 --- loss: 1.919973, loss_ss: 1.099723, loss_d: 0.820250
0.9615 --- loss: 1.190538, loss_ss: 0.729169, loss_d: 0.461369
Epoch finished! Loss: 1.441487358573781
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.447442, loss_ss: 0.986107, loss_d: 0.461335
0.0385 --- loss: 1.386582, loss_ss: 1.009909, loss_d: 0.376673
0.0769 --- loss: 1.616476, loss_ss: 0.818900, loss_d: 0.797577
0.1154 --- loss: 0.996891, loss_ss: 0.663157, loss_d: 0.333733
0.1538 --- loss: 1.501830, loss_ss: 1.010773, loss_d: 0.491057
0.1923 --- loss: 1.449128, loss_ss: 0.939271, loss_d: 0.509857
0.2308 --- loss: 1.417259, loss_ss: 0.903190, loss_d: 0.514069
0.2692 --- loss: 1.303834, loss_ss: 0.996214, loss_d: 0.307619
0.3077 --- loss: 1.067781, loss_ss: 0.802369, loss_d: 0.265412
0.3462 --- loss: 1.201235, loss_ss: 0.959696, loss_d: 0.241539
0.3846 --- loss: 1.220796, loss_ss: 0.699377, loss_d: 0.521420
0.4231 --- loss: 1.636386, loss_ss: 1.012119, loss_d: 0.624268
0.4615 --- loss: 1.033033, loss_ss: 0.619936, loss_d: 0.413096
0.5000 --- loss: 1.439913, loss_ss: 0.947704, loss_d: 0.492209
0.5385 --- loss: 1.202652, loss_ss: 0.805051, loss_d: 0.397601
0.5769 --- loss: 1.465291, loss_ss: 0.952780, loss_d: 0.512511
0.6154 --- loss: 1.131672, loss_ss: 0.717238, loss_d: 0.414434
0.6538 --- loss: 1.243058, loss_ss: 0.894467, loss_d: 0.348591
0.6923 --- loss: 1.168164, loss_ss: 0.823305, loss_d: 0.344859
0.7308 --- loss: 1.404487, loss_ss: 1.019579, loss_d: 0.384908
0.7692 --- loss: 1.182115, loss_ss: 0.843279, loss_d: 0.338836
0.8077 --- loss: 1.520167, loss_ss: 1.068020, loss_d: 0.452147
0.8462 --- loss: 1.252397, loss_ss: 1.011948, loss_d: 0.240449
0.8846 --- loss: 1.186550, loss_ss: 0.961625, loss_d: 0.224925
0.9231 --- loss: 1.363201, loss_ss: 0.770964, loss_d: 0.592237
0.9615 --- loss: 1.679573, loss_ss: 0.850862, loss_d: 0.828711
Epoch finished! Loss: 1.3596427406123246
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.926356, loss_ss: 0.758070, loss_d: 0.168286
0.0385 --- loss: 1.254718, loss_ss: 1.095279, loss_d: 0.159439
0.0769 --- loss: 1.351129, loss_ss: 0.856956, loss_d: 0.494173
0.1154 --- loss: 1.428568, loss_ss: 1.052517, loss_d: 0.376051
0.1538 --- loss: 1.045365, loss_ss: 0.717488, loss_d: 0.327877
0.1923 --- loss: 1.225142, loss_ss: 0.839594, loss_d: 0.385548
0.2308 --- loss: 1.383852, loss_ss: 0.818626, loss_d: 0.565225
0.2692 --- loss: 1.269746, loss_ss: 0.968707, loss_d: 0.301040
0.3077 --- loss: 1.101000, loss_ss: 0.849248, loss_d: 0.251752
0.3462 --- loss: 1.223896, loss_ss: 0.749616, loss_d: 0.474280
0.3846 --- loss: 1.304537, loss_ss: 0.760082, loss_d: 0.544455
0.4231 --- loss: 2.150911, loss_ss: 1.574258, loss_d: 0.576653
0.4615 --- loss: 1.437233, loss_ss: 0.922081, loss_d: 0.515153
0.5000 --- loss: 0.962556, loss_ss: 0.745242, loss_d: 0.217313
0.5385 --- loss: 0.941700, loss_ss: 0.527554, loss_d: 0.414146
0.5769 --- loss: 1.144275, loss_ss: 0.647568, loss_d: 0.496707
0.6154 --- loss: 0.836621, loss_ss: 0.694422, loss_d: 0.142198
0.6538 --- loss: 1.167985, loss_ss: 0.841129, loss_d: 0.326856
0.6923 --- loss: 1.448583, loss_ss: 0.974521, loss_d: 0.474063
0.7308 --- loss: 1.271363, loss_ss: 0.848953, loss_d: 0.422410
0.7692 --- loss: 1.678905, loss_ss: 0.980535, loss_d: 0.698370
0.8077 --- loss: 1.669823, loss_ss: 1.425632, loss_d: 0.244192
0.8462 --- loss: 1.380138, loss_ss: 0.859937, loss_d: 0.520201
0.8846 --- loss: 1.220877, loss_ss: 0.998087, loss_d: 0.222790
0.9231 --- loss: 1.624159, loss_ss: 1.216855, loss_d: 0.407305
0.9615 --- loss: 1.142813, loss_ss: 0.912752, loss_d: 0.230060
Epoch finished! Loss: 1.3192288919305248
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.059765, loss_ss: 0.717536, loss_d: 0.342229
0.0385 --- loss: 1.181214, loss_ss: 0.882314, loss_d: 0.298900
0.0769 --- loss: 0.997535, loss_ss: 0.677837, loss_d: 0.319698
0.1154 --- loss: 1.211091, loss_ss: 0.934273, loss_d: 0.276817
0.1538 --- loss: 1.352672, loss_ss: 1.041093, loss_d: 0.311579
0.1923 --- loss: 1.166914, loss_ss: 0.945527, loss_d: 0.221386
0.2308 --- loss: 1.300088, loss_ss: 0.756089, loss_d: 0.543999
0.2692 --- loss: 1.081093, loss_ss: 0.764317, loss_d: 0.316776
0.3077 --- loss: 1.433124, loss_ss: 0.966275, loss_d: 0.466849
0.3462 --- loss: 1.295554, loss_ss: 1.032074, loss_d: 0.263480
0.3846 --- loss: 0.860054, loss_ss: 0.602162, loss_d: 0.257892
0.4231 --- loss: 1.261183, loss_ss: 0.758312, loss_d: 0.502871
0.4615 --- loss: 1.460543, loss_ss: 1.163717, loss_d: 0.296827
0.5000 --- loss: 1.595275, loss_ss: 0.858306, loss_d: 0.736969
0.5385 --- loss: 1.227933, loss_ss: 0.949472, loss_d: 0.278461
0.5769 --- loss: 1.322888, loss_ss: 0.929700, loss_d: 0.393188
0.6154 --- loss: 1.321649, loss_ss: 0.922327, loss_d: 0.399322
0.6538 --- loss: 1.183834, loss_ss: 0.888401, loss_d: 0.295433
0.6923 --- loss: 0.931164, loss_ss: 0.700064, loss_d: 0.231100
0.7308 --- loss: 1.223144, loss_ss: 1.038240, loss_d: 0.184903
0.7692 --- loss: 1.531176, loss_ss: 1.073493, loss_d: 0.457683
0.8077 --- loss: 1.167586, loss_ss: 0.966158, loss_d: 0.201428
0.8462 --- loss: 1.013133, loss_ss: 0.836991, loss_d: 0.176143
0.8846 --- loss: 1.709043, loss_ss: 0.655009, loss_d: 1.054034
0.9231 --- loss: 1.417624, loss_ss: 0.913790, loss_d: 0.503834
0.9615 --- loss: 1.152705, loss_ss: 0.949536, loss_d: 0.203169
Epoch finished! Loss: 1.2656133867598869
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.081315, loss_ss: 0.592259, loss_d: 0.489056
0.0385 --- loss: 1.333799, loss_ss: 1.007553, loss_d: 0.326245
0.0769 --- loss: 1.068476, loss_ss: 0.900116, loss_d: 0.168360
0.1154 --- loss: 1.226582, loss_ss: 0.733638, loss_d: 0.492944
0.1538 --- loss: 1.158982, loss_ss: 0.786773, loss_d: 0.372208
0.1923 --- loss: 1.356121, loss_ss: 0.951057, loss_d: 0.405064
0.2308 --- loss: 1.014074, loss_ss: 0.636834, loss_d: 0.377239
0.2692 --- loss: 1.005928, loss_ss: 0.814267, loss_d: 0.191661
0.3077 --- loss: 0.984509, loss_ss: 0.668814, loss_d: 0.315695
0.3462 --- loss: 1.008545, loss_ss: 0.759922, loss_d: 0.248623
0.3846 --- loss: 1.349747, loss_ss: 0.852912, loss_d: 0.496836
0.4231 --- loss: 1.094308, loss_ss: 0.877281, loss_d: 0.217027
0.4615 --- loss: 1.161378, loss_ss: 1.007664, loss_d: 0.153714
0.5000 --- loss: 0.945204, loss_ss: 0.739107, loss_d: 0.206097
0.5385 --- loss: 1.608224, loss_ss: 1.333505, loss_d: 0.274719
0.5769 --- loss: 1.038003, loss_ss: 0.835293, loss_d: 0.202710
0.6154 --- loss: 1.248090, loss_ss: 0.697858, loss_d: 0.550232
0.6538 --- loss: 1.101612, loss_ss: 0.980588, loss_d: 0.121025
0.6923 --- loss: 1.154014, loss_ss: 0.909188, loss_d: 0.244825
0.7308 --- loss: 1.125126, loss_ss: 0.956239, loss_d: 0.168887
0.7692 --- loss: 1.259592, loss_ss: 0.924743, loss_d: 0.334848
0.8077 --- loss: 0.869248, loss_ss: 0.674822, loss_d: 0.194426
0.8462 --- loss: 0.937901, loss_ss: 0.728054, loss_d: 0.209847
0.8846 --- loss: 1.699257, loss_ss: 1.112957, loss_d: 0.586300
0.9231 --- loss: 1.017818, loss_ss: 0.800339, loss_d: 0.217478
0.9615 --- loss: 1.263983, loss_ss: 0.948183, loss_d: 0.315800
Epoch finished! Loss: 1.196631303855351
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.868545, loss_ss: 0.605940, loss_d: 0.262605
0.0385 --- loss: 1.159748, loss_ss: 0.818628, loss_d: 0.341120
0.0769 --- loss: 0.949572, loss_ss: 0.791335, loss_d: 0.158237
0.1154 --- loss: 0.969173, loss_ss: 0.750194, loss_d: 0.218979
0.1538 --- loss: 1.394539, loss_ss: 1.082152, loss_d: 0.312387
0.1923 --- loss: 0.941379, loss_ss: 0.781264, loss_d: 0.160115
0.2308 --- loss: 1.366448, loss_ss: 0.725135, loss_d: 0.641313
0.2692 --- loss: 1.342359, loss_ss: 0.958812, loss_d: 0.383547
0.3077 --- loss: 1.684882, loss_ss: 1.339623, loss_d: 0.345259
0.3462 --- loss: 0.909580, loss_ss: 0.688053, loss_d: 0.221527
0.3846 --- loss: 1.185765, loss_ss: 0.788588, loss_d: 0.397176
0.4231 --- loss: 0.713042, loss_ss: 0.586908, loss_d: 0.126134
0.4615 --- loss: 1.035244, loss_ss: 0.733004, loss_d: 0.302240
0.5000 --- loss: 0.628450, loss_ss: 0.518529, loss_d: 0.109921
0.5385 --- loss: 1.157573, loss_ss: 0.979961, loss_d: 0.177611
0.5769 --- loss: 1.057427, loss_ss: 0.768260, loss_d: 0.289167
0.6154 --- loss: 1.122267, loss_ss: 0.922649, loss_d: 0.199618
0.6538 --- loss: 1.463662, loss_ss: 1.052492, loss_d: 0.411169
0.6923 --- loss: 1.534342, loss_ss: 0.962691, loss_d: 0.571651
0.7308 --- loss: 1.033025, loss_ss: 0.824076, loss_d: 0.208949
0.7692 --- loss: 0.903408, loss_ss: 0.655787, loss_d: 0.247620
0.8077 --- loss: 1.107090, loss_ss: 0.693653, loss_d: 0.413436
0.8462 --- loss: 1.030139, loss_ss: 0.760178, loss_d: 0.269960
0.8846 --- loss: 1.040957, loss_ss: 0.543914, loss_d: 0.497044
0.9231 --- loss: 0.800198, loss_ss: 0.648389, loss_d: 0.151809
0.9615 --- loss: 1.424377, loss_ss: 1.184579, loss_d: 0.239798
Epoch finished! Loss: 1.1611983410179845
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.894860, loss_ss: 0.711293, loss_d: 0.183567
0.0385 --- loss: 1.212929, loss_ss: 0.814445, loss_d: 0.398483
0.0769 --- loss: 1.653542, loss_ss: 1.181801, loss_d: 0.471742
0.1154 --- loss: 1.171209, loss_ss: 0.877632, loss_d: 0.293577
0.1538 --- loss: 1.054985, loss_ss: 0.759894, loss_d: 0.295091
0.1923 --- loss: 0.828602, loss_ss: 0.685532, loss_d: 0.143070
0.2308 --- loss: 1.049889, loss_ss: 0.742547, loss_d: 0.307341
0.2692 --- loss: 0.874640, loss_ss: 0.777651, loss_d: 0.096989
0.3077 --- loss: 0.945991, loss_ss: 0.646133, loss_d: 0.299858
0.3462 --- loss: 0.968323, loss_ss: 0.792518, loss_d: 0.175805
0.3846 --- loss: 1.272615, loss_ss: 1.048667, loss_d: 0.223948
0.4231 --- loss: 1.104892, loss_ss: 0.854884, loss_d: 0.250008
0.4615 --- loss: 1.390592, loss_ss: 0.851885, loss_d: 0.538707
0.5000 --- loss: 1.724682, loss_ss: 1.112233, loss_d: 0.612448
0.5385 --- loss: 0.969921, loss_ss: 0.766937, loss_d: 0.202984
0.5769 --- loss: 1.047629, loss_ss: 0.817384, loss_d: 0.230245
0.6154 --- loss: 1.028661, loss_ss: 0.905929, loss_d: 0.122733
0.6538 --- loss: 1.163731, loss_ss: 1.052813, loss_d: 0.110918
0.6923 --- loss: 1.467285, loss_ss: 1.106241, loss_d: 0.361044
0.7308 --- loss: 0.954249, loss_ss: 0.790031, loss_d: 0.164218
0.7692 --- loss: 1.193986, loss_ss: 0.833696, loss_d: 0.360290
0.8077 --- loss: 1.235772, loss_ss: 0.934164, loss_d: 0.301608
0.8462 --- loss: 1.305862, loss_ss: 1.116023, loss_d: 0.189839
0.8846 --- loss: 0.994409, loss_ss: 0.809694, loss_d: 0.184715
0.9231 --- loss: 1.258417, loss_ss: 1.116473, loss_d: 0.141944
0.9615 --- loss: 1.017967, loss_ss: 0.643730, loss_d: 0.374237
Epoch finished! Loss: 1.1468440165390839
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.718421052631579
             precision    recall  f1-score   support

        0.0       0.72      0.70      0.71       166
        1.0       0.13      0.28      0.18        58
        2.0       0.71      0.83      0.76       397
        3.0       0.88      0.93      0.91       165
        4.0       0.93      0.57      0.71       354

avg / total       0.78      0.72      0.73      1140
 


====== chp007-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.75  70.48   95.38  72.22     71.34
1  87.28  27.59   90.48  13.45     18.08
2  82.11  83.38   81.43  70.58     76.44
3  97.19  93.33   97.85  88.00     90.59
4  85.35  56.78   98.22  93.49     70.65
Total accuracy: 71.84%
Average sen: 66.31%
Average spec: 92.67%
Macro f1-score: 65.42%
Diagnosis acc on 15mins: 0.9736842105263158
[0.96672773 0.97347212 0.97671777 0.97313243 0.25201735 0.93177718
 0.97960955 0.71346444 0.94016814 0.5921393  0.97587729 0.97028875
 0.97050136 0.97766268 0.98163879 0.96675807 0.76085341 0.91194934
 0.96334922 0.97433871 0.97142959 0.97368932 0.96459013 0.97054672
 0.97539812 0.9739204  0.97106332 0.96635556 0.96318132 0.97195089
 0.92766619 0.97215706 0.6259467  0.65967405 0.95303679 0.97037637
 0.97328329 0.97286183]
pred: 0.9081466127383081, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp008-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.244215, loss_ss: 1.563948, loss_d: 0.680267
0.0384 --- loss: 2.200469, loss_ss: 1.611802, loss_d: 0.588667
0.0767 --- loss: 2.299551, loss_ss: 1.627268, loss_d: 0.672282
0.1151 --- loss: 2.082992, loss_ss: 1.364640, loss_d: 0.718352
0.1534 --- loss: 2.372304, loss_ss: 1.575585, loss_d: 0.796719
0.1918 --- loss: 1.873581, loss_ss: 1.471856, loss_d: 0.401726
0.2301 --- loss: 1.918914, loss_ss: 1.307721, loss_d: 0.611192
0.2685 --- loss: 2.049670, loss_ss: 1.463848, loss_d: 0.585822
0.3069 --- loss: 1.800232, loss_ss: 1.259003, loss_d: 0.541229
0.3452 --- loss: 2.166920, loss_ss: 1.484604, loss_d: 0.682316
0.3836 --- loss: 1.646794, loss_ss: 1.335686, loss_d: 0.311108
0.4219 --- loss: 2.142771, loss_ss: 1.375295, loss_d: 0.767476
0.4603 --- loss: 2.199851, loss_ss: 1.333025, loss_d: 0.866827
0.4987 --- loss: 1.832404, loss_ss: 1.172000, loss_d: 0.660405
0.5370 --- loss: 1.846456, loss_ss: 1.071657, loss_d: 0.774799
0.5754 --- loss: 2.019929, loss_ss: 1.383330, loss_d: 0.636599
0.6137 --- loss: 1.912823, loss_ss: 1.173964, loss_d: 0.738859
0.6521 --- loss: 1.698508, loss_ss: 1.205962, loss_d: 0.492545
0.6904 --- loss: 1.971878, loss_ss: 1.428027, loss_d: 0.543851
0.7288 --- loss: 2.004106, loss_ss: 1.488833, loss_d: 0.515274
0.7672 --- loss: 1.853854, loss_ss: 1.322412, loss_d: 0.531442
0.8055 --- loss: 1.943921, loss_ss: 1.350027, loss_d: 0.593894
0.8439 --- loss: 1.671003, loss_ss: 1.242649, loss_d: 0.428354
0.8822 --- loss: 1.852657, loss_ss: 1.243495, loss_d: 0.609162
0.9206 --- loss: 1.992773, loss_ss: 1.464717, loss_d: 0.528056
0.9590 --- loss: 1.744014, loss_ss: 1.218661, loss_d: 0.525353
0.9973 --- loss: 2.478341, loss_ss: 1.396309, loss_d: 1.082031
Epoch finished! Loss: 1.93612443621342
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.557741, loss_ss: 1.015874, loss_d: 0.541866
0.0384 --- loss: 1.850176, loss_ss: 1.318468, loss_d: 0.531708
0.0767 --- loss: 1.886377, loss_ss: 1.204426, loss_d: 0.681951
0.1151 --- loss: 1.772442, loss_ss: 1.276080, loss_d: 0.496363
0.1534 --- loss: 1.544465, loss_ss: 1.216907, loss_d: 0.327558
0.1918 --- loss: 1.728104, loss_ss: 1.211437, loss_d: 0.516667
0.2301 --- loss: 1.864308, loss_ss: 1.160417, loss_d: 0.703891
0.2685 --- loss: 2.004706, loss_ss: 1.339132, loss_d: 0.665574
0.3069 --- loss: 2.014787, loss_ss: 1.252976, loss_d: 0.761811
0.3452 --- loss: 1.763692, loss_ss: 1.114172, loss_d: 0.649519
0.3836 --- loss: 2.239882, loss_ss: 1.482811, loss_d: 0.757071
0.4219 --- loss: 1.949703, loss_ss: 1.143783, loss_d: 0.805920
0.4603 --- loss: 1.647101, loss_ss: 1.074376, loss_d: 0.572725
0.4987 --- loss: 2.050305, loss_ss: 1.304069, loss_d: 0.746236
0.5370 --- loss: 1.690929, loss_ss: 1.157545, loss_d: 0.533383
0.5754 --- loss: 1.909220, loss_ss: 1.137655, loss_d: 0.771565
0.6137 --- loss: 2.018609, loss_ss: 1.386490, loss_d: 0.632119
0.6521 --- loss: 1.792622, loss_ss: 1.294873, loss_d: 0.497749
0.6904 --- loss: 1.859184, loss_ss: 1.102198, loss_d: 0.756986
0.7288 --- loss: 1.370756, loss_ss: 1.039417, loss_d: 0.331339
0.7672 --- loss: 1.901916, loss_ss: 1.264418, loss_d: 0.637498
0.8055 --- loss: 1.877744, loss_ss: 1.228525, loss_d: 0.649219
0.8439 --- loss: 1.504894, loss_ss: 1.114012, loss_d: 0.390882
0.8822 --- loss: 2.085222, loss_ss: 1.519024, loss_d: 0.566198
0.9206 --- loss: 1.797433, loss_ss: 1.225415, loss_d: 0.572018
0.9590 --- loss: 1.883368, loss_ss: 1.332731, loss_d: 0.550637
0.9973 --- loss: 1.727702, loss_ss: 1.167467, loss_d: 0.560235
Epoch finished! Loss: 1.7725941103238325
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.576911, loss_ss: 1.062195, loss_d: 0.514717
0.0384 --- loss: 1.780773, loss_ss: 0.965323, loss_d: 0.815450
0.0767 --- loss: 1.531641, loss_ss: 1.076132, loss_d: 0.455509
0.1151 --- loss: 1.489085, loss_ss: 1.065149, loss_d: 0.423936
0.1534 --- loss: 1.664681, loss_ss: 0.954520, loss_d: 0.710161
0.1918 --- loss: 1.809166, loss_ss: 1.101699, loss_d: 0.707466
0.2301 --- loss: 1.643768, loss_ss: 0.946923, loss_d: 0.696845
0.2685 --- loss: 1.368013, loss_ss: 0.912682, loss_d: 0.455331
0.3069 --- loss: 1.493069, loss_ss: 0.986606, loss_d: 0.506464
0.3452 --- loss: 1.663169, loss_ss: 1.164666, loss_d: 0.498502
0.3836 --- loss: 1.729980, loss_ss: 1.166447, loss_d: 0.563532
0.4219 --- loss: 1.773369, loss_ss: 1.131790, loss_d: 0.641579
0.4603 --- loss: 1.655704, loss_ss: 1.248564, loss_d: 0.407140
0.4987 --- loss: 1.649823, loss_ss: 1.163997, loss_d: 0.485826
0.5370 --- loss: 2.051548, loss_ss: 1.164781, loss_d: 0.886766
0.5754 --- loss: 1.647198, loss_ss: 1.027651, loss_d: 0.619547
0.6137 --- loss: 1.490400, loss_ss: 1.094348, loss_d: 0.396052
0.6521 --- loss: 1.560059, loss_ss: 0.856004, loss_d: 0.704055
0.6904 --- loss: 1.873320, loss_ss: 1.064238, loss_d: 0.809083
0.7288 --- loss: 1.590513, loss_ss: 1.076866, loss_d: 0.513647
0.7672 --- loss: 1.676440, loss_ss: 0.943928, loss_d: 0.732512
0.8055 --- loss: 1.661422, loss_ss: 1.078309, loss_d: 0.583113
0.8439 --- loss: 1.757659, loss_ss: 1.208114, loss_d: 0.549545
0.8822 --- loss: 2.246178, loss_ss: 1.603746, loss_d: 0.642432
0.9206 --- loss: 1.395137, loss_ss: 0.940485, loss_d: 0.454653
0.9590 --- loss: 1.978738, loss_ss: 1.293596, loss_d: 0.685143
0.9973 --- loss: 1.384653, loss_ss: 0.888632, loss_d: 0.496021
Epoch finished! Loss: 1.665449412052448
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.773852, loss_ss: 1.060655, loss_d: 0.713196
0.0384 --- loss: 1.575452, loss_ss: 1.070748, loss_d: 0.504705
0.0767 --- loss: 1.326875, loss_ss: 0.805756, loss_d: 0.521119
0.1151 --- loss: 1.763760, loss_ss: 1.271573, loss_d: 0.492187
0.1534 --- loss: 1.759855, loss_ss: 1.229745, loss_d: 0.530110
0.1918 --- loss: 1.535106, loss_ss: 0.933054, loss_d: 0.602053
0.2301 --- loss: 1.285324, loss_ss: 0.812408, loss_d: 0.472916
0.2685 --- loss: 1.599540, loss_ss: 1.090727, loss_d: 0.508813
0.3069 --- loss: 1.405447, loss_ss: 0.867624, loss_d: 0.537822
0.3452 --- loss: 2.006957, loss_ss: 1.184429, loss_d: 0.822528
0.3836 --- loss: 1.332134, loss_ss: 0.798482, loss_d: 0.533652
0.4219 --- loss: 1.358490, loss_ss: 0.834803, loss_d: 0.523687
0.4603 --- loss: 1.622545, loss_ss: 1.108309, loss_d: 0.514236
0.4987 --- loss: 1.705131, loss_ss: 1.116769, loss_d: 0.588361
0.5370 --- loss: 1.484430, loss_ss: 1.073631, loss_d: 0.410800
0.5754 --- loss: 1.575143, loss_ss: 1.030833, loss_d: 0.544310
0.6137 --- loss: 1.497622, loss_ss: 0.928890, loss_d: 0.568731
0.6521 --- loss: 1.810203, loss_ss: 1.076051, loss_d: 0.734152
0.6904 --- loss: 1.779662, loss_ss: 1.342389, loss_d: 0.437274
0.7288 --- loss: 1.652067, loss_ss: 1.004332, loss_d: 0.647735
0.7672 --- loss: 1.466964, loss_ss: 1.026435, loss_d: 0.440528
0.8055 --- loss: 1.495706, loss_ss: 1.044694, loss_d: 0.451012
0.8439 --- loss: 1.829399, loss_ss: 1.115728, loss_d: 0.713671
0.8822 --- loss: 2.036417, loss_ss: 1.323457, loss_d: 0.712960
0.9206 --- loss: 1.290360, loss_ss: 0.843867, loss_d: 0.446494
0.9590 --- loss: 1.540602, loss_ss: 1.067371, loss_d: 0.473231
0.9973 --- loss: 1.140357, loss_ss: 0.940340, loss_d: 0.200018
Epoch finished! Loss: 1.5404117928101466
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.640476, loss_ss: 1.049127, loss_d: 0.591349
0.0384 --- loss: 1.769796, loss_ss: 1.072237, loss_d: 0.697559
0.0767 --- loss: 1.941337, loss_ss: 1.319567, loss_d: 0.621771
0.1151 --- loss: 1.700887, loss_ss: 1.313072, loss_d: 0.387815
0.1534 --- loss: 1.365754, loss_ss: 0.961668, loss_d: 0.404086
0.1918 --- loss: 1.192733, loss_ss: 0.894050, loss_d: 0.298683
0.2301 --- loss: 1.432479, loss_ss: 0.651620, loss_d: 0.780859
0.2685 --- loss: 1.592211, loss_ss: 0.963116, loss_d: 0.629095
0.3069 --- loss: 1.665771, loss_ss: 1.175218, loss_d: 0.490553
0.3452 --- loss: 1.774466, loss_ss: 1.026492, loss_d: 0.747975
0.3836 --- loss: 1.283391, loss_ss: 0.735797, loss_d: 0.547594
0.4219 --- loss: 1.622073, loss_ss: 1.313943, loss_d: 0.308130
0.4603 --- loss: 1.705404, loss_ss: 1.110624, loss_d: 0.594781
0.4987 --- loss: 1.228840, loss_ss: 0.802133, loss_d: 0.426707
0.5370 --- loss: 1.036971, loss_ss: 0.800157, loss_d: 0.236814
0.5754 --- loss: 1.492478, loss_ss: 0.742184, loss_d: 0.750295
0.6137 --- loss: 1.201131, loss_ss: 0.746479, loss_d: 0.454653
0.6521 --- loss: 1.387491, loss_ss: 0.942566, loss_d: 0.444925
0.6904 --- loss: 1.699346, loss_ss: 1.124634, loss_d: 0.574712
0.7288 --- loss: 1.804574, loss_ss: 0.811178, loss_d: 0.993396
0.7672 --- loss: 1.273374, loss_ss: 0.786322, loss_d: 0.487053
0.8055 --- loss: 1.098908, loss_ss: 0.912753, loss_d: 0.186155
0.8439 --- loss: 1.387540, loss_ss: 1.085653, loss_d: 0.301888
0.8822 --- loss: 1.516613, loss_ss: 0.877317, loss_d: 0.639296
0.9206 --- loss: 1.383705, loss_ss: 1.018113, loss_d: 0.365592
0.9590 --- loss: 1.473604, loss_ss: 1.188209, loss_d: 0.285395
0.9973 --- loss: 1.302925, loss_ss: 1.068746, loss_d: 0.234179
Epoch finished! Loss: 1.4372352673457218
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.390638, loss_ss: 1.008452, loss_d: 0.382185
0.0384 --- loss: 1.246595, loss_ss: 0.988663, loss_d: 0.257932
0.0767 --- loss: 1.671770, loss_ss: 0.992750, loss_d: 0.679020
0.1151 --- loss: 1.628598, loss_ss: 1.085936, loss_d: 0.542661
0.1534 --- loss: 1.311374, loss_ss: 0.797554, loss_d: 0.513820
0.1918 --- loss: 1.397199, loss_ss: 1.021216, loss_d: 0.375984
0.2301 --- loss: 1.079054, loss_ss: 0.763267, loss_d: 0.315787
0.2685 --- loss: 1.313043, loss_ss: 0.962982, loss_d: 0.350061
0.3069 --- loss: 1.276862, loss_ss: 0.783176, loss_d: 0.493686
0.3452 --- loss: 1.382645, loss_ss: 0.798983, loss_d: 0.583663
0.3836 --- loss: 1.329001, loss_ss: 1.023368, loss_d: 0.305633
0.4219 --- loss: 1.057513, loss_ss: 0.804050, loss_d: 0.253463
0.4603 --- loss: 1.644985, loss_ss: 0.983817, loss_d: 0.661168
0.4987 --- loss: 1.107667, loss_ss: 0.797003, loss_d: 0.310663
0.5370 --- loss: 1.124493, loss_ss: 0.738191, loss_d: 0.386302
0.5754 --- loss: 1.216545, loss_ss: 0.755209, loss_d: 0.461337
0.6137 --- loss: 1.068728, loss_ss: 0.859816, loss_d: 0.208912
0.6521 --- loss: 1.268399, loss_ss: 1.014634, loss_d: 0.253765
0.6904 --- loss: 1.467373, loss_ss: 0.812068, loss_d: 0.655305
0.7288 --- loss: 1.320640, loss_ss: 0.901857, loss_d: 0.418782
0.7672 --- loss: 1.334563, loss_ss: 0.837812, loss_d: 0.496751
0.8055 --- loss: 1.387698, loss_ss: 1.026653, loss_d: 0.361045
0.8439 --- loss: 1.147929, loss_ss: 0.931880, loss_d: 0.216049
0.8822 --- loss: 1.074300, loss_ss: 0.839026, loss_d: 0.235273
0.9206 --- loss: 1.513165, loss_ss: 1.016914, loss_d: 0.496251
0.9590 --- loss: 0.954343, loss_ss: 0.726062, loss_d: 0.228281
0.9973 --- loss: 1.833245, loss_ss: 1.166447, loss_d: 0.666798
Epoch finished! Loss: 1.3739534666905036
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.199052, loss_ss: 0.951110, loss_d: 0.247942
0.0384 --- loss: 1.109637, loss_ss: 0.773486, loss_d: 0.336152
0.0767 --- loss: 0.878241, loss_ss: 0.689407, loss_d: 0.188834
0.1151 --- loss: 0.936701, loss_ss: 0.753003, loss_d: 0.183699
0.1534 --- loss: 1.049123, loss_ss: 0.686449, loss_d: 0.362674
0.1918 --- loss: 1.335751, loss_ss: 1.070650, loss_d: 0.265102
0.2301 --- loss: 1.369029, loss_ss: 1.212071, loss_d: 0.156958
0.2685 --- loss: 1.325979, loss_ss: 0.539736, loss_d: 0.786242
0.3069 --- loss: 1.591267, loss_ss: 1.039482, loss_d: 0.551785
0.3452 --- loss: 0.913313, loss_ss: 0.623317, loss_d: 0.289997
0.3836 --- loss: 1.580660, loss_ss: 1.048351, loss_d: 0.532310
0.4219 --- loss: 1.558534, loss_ss: 1.117840, loss_d: 0.440694
0.4603 --- loss: 1.128217, loss_ss: 0.819029, loss_d: 0.309189
0.4987 --- loss: 1.755236, loss_ss: 0.958339, loss_d: 0.796897
0.5370 --- loss: 1.177825, loss_ss: 0.819149, loss_d: 0.358676
0.5754 --- loss: 1.132122, loss_ss: 0.919654, loss_d: 0.212468
0.6137 --- loss: 1.133408, loss_ss: 0.793689, loss_d: 0.339719
0.6521 --- loss: 1.242711, loss_ss: 1.003564, loss_d: 0.239147
0.6904 --- loss: 1.127714, loss_ss: 0.627200, loss_d: 0.500513
0.7288 --- loss: 1.227991, loss_ss: 0.967522, loss_d: 0.260469
0.7672 --- loss: 1.152091, loss_ss: 0.961497, loss_d: 0.190594
0.8055 --- loss: 1.093596, loss_ss: 0.773189, loss_d: 0.320407
0.8439 --- loss: 1.102787, loss_ss: 0.828437, loss_d: 0.274351
0.8822 --- loss: 1.502521, loss_ss: 1.061361, loss_d: 0.441160
0.9206 --- loss: 1.072105, loss_ss: 0.810899, loss_d: 0.261206
0.9590 --- loss: 0.993249, loss_ss: 0.834530, loss_d: 0.158719
0.9973 --- loss: 1.835199, loss_ss: 0.892651, loss_d: 0.942548
Epoch finished! Loss: 1.2846005611694775
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.960858, loss_ss: 0.580866, loss_d: 0.379992
0.0384 --- loss: 1.118604, loss_ss: 0.817967, loss_d: 0.300637
0.0767 --- loss: 1.348859, loss_ss: 1.059975, loss_d: 0.288884
0.1151 --- loss: 1.275834, loss_ss: 0.899850, loss_d: 0.375984
0.1534 --- loss: 1.451928, loss_ss: 0.923935, loss_d: 0.527993
0.1918 --- loss: 1.163617, loss_ss: 0.936826, loss_d: 0.226791
0.2301 --- loss: 0.869642, loss_ss: 0.703486, loss_d: 0.166156
0.2685 --- loss: 1.107211, loss_ss: 0.761342, loss_d: 0.345869
0.3069 --- loss: 1.061689, loss_ss: 0.819403, loss_d: 0.242286
0.3452 --- loss: 1.353320, loss_ss: 0.963980, loss_d: 0.389340
0.3836 --- loss: 1.675433, loss_ss: 0.869377, loss_d: 0.806056
0.4219 --- loss: 0.935342, loss_ss: 0.778871, loss_d: 0.156471
0.4603 --- loss: 0.907740, loss_ss: 0.703337, loss_d: 0.204402
0.4987 --- loss: 1.087230, loss_ss: 0.910168, loss_d: 0.177062
0.5370 --- loss: 1.193986, loss_ss: 0.934207, loss_d: 0.259779
0.5754 --- loss: 1.094363, loss_ss: 0.733851, loss_d: 0.360512
0.6137 --- loss: 1.199849, loss_ss: 0.890132, loss_d: 0.309717
0.6521 --- loss: 1.047532, loss_ss: 0.788818, loss_d: 0.258714
0.6904 --- loss: 1.032214, loss_ss: 0.724155, loss_d: 0.308059
0.7288 --- loss: 0.993383, loss_ss: 0.759615, loss_d: 0.233768
0.7672 --- loss: 1.123052, loss_ss: 0.963332, loss_d: 0.159721
0.8055 --- loss: 1.227616, loss_ss: 0.994165, loss_d: 0.233451
0.8439 --- loss: 1.159273, loss_ss: 0.704842, loss_d: 0.454431
0.8822 --- loss: 1.388766, loss_ss: 1.198032, loss_d: 0.190734
0.9206 --- loss: 0.944952, loss_ss: 0.778077, loss_d: 0.166875
0.9590 --- loss: 0.963051, loss_ss: 0.652607, loss_d: 0.310444
0.9973 --- loss: 1.055378, loss_ss: 0.806544, loss_d: 0.248834
Epoch finished! Loss: 1.2133575070362825
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.477021, loss_ss: 0.993275, loss_d: 0.483747
0.0384 --- loss: 1.026700, loss_ss: 0.598506, loss_d: 0.428194
0.0767 --- loss: 1.100928, loss_ss: 0.862591, loss_d: 0.238337
0.1151 --- loss: 1.230766, loss_ss: 0.888247, loss_d: 0.342518
0.1534 --- loss: 1.034848, loss_ss: 0.781822, loss_d: 0.253026
0.1918 --- loss: 1.059859, loss_ss: 0.913219, loss_d: 0.146640
0.2301 --- loss: 1.270645, loss_ss: 0.721212, loss_d: 0.549434
0.2685 --- loss: 1.000541, loss_ss: 0.848656, loss_d: 0.151886
0.3069 --- loss: 1.159509, loss_ss: 0.931151, loss_d: 0.228358
0.3452 --- loss: 1.183191, loss_ss: 0.874875, loss_d: 0.308317
0.3836 --- loss: 1.025498, loss_ss: 0.752109, loss_d: 0.273388
0.4219 --- loss: 0.966223, loss_ss: 0.850612, loss_d: 0.115611
0.4603 --- loss: 0.996360, loss_ss: 0.837451, loss_d: 0.158909
0.4987 --- loss: 0.964491, loss_ss: 0.747465, loss_d: 0.217026
0.5370 --- loss: 1.693402, loss_ss: 1.335493, loss_d: 0.357909
0.5754 --- loss: 1.382645, loss_ss: 1.230619, loss_d: 0.152026
0.6137 --- loss: 1.833626, loss_ss: 0.899390, loss_d: 0.934236
0.6521 --- loss: 0.994105, loss_ss: 0.818488, loss_d: 0.175617
0.6904 --- loss: 1.051301, loss_ss: 0.885336, loss_d: 0.165964
0.7288 --- loss: 1.101951, loss_ss: 0.947615, loss_d: 0.154336
0.7672 --- loss: 1.141135, loss_ss: 1.027948, loss_d: 0.113187
0.8055 --- loss: 1.243155, loss_ss: 0.672793, loss_d: 0.570362
0.8439 --- loss: 1.473443, loss_ss: 0.755948, loss_d: 0.717495
0.8822 --- loss: 0.918639, loss_ss: 0.786723, loss_d: 0.131915
0.9206 --- loss: 1.102232, loss_ss: 0.905694, loss_d: 0.196538
0.9590 --- loss: 1.633048, loss_ss: 0.858104, loss_d: 0.774944
0.9973 --- loss: 1.258313, loss_ss: 0.803308, loss_d: 0.455005
Epoch finished! Loss: 1.1917766165274841
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.109827, loss_ss: 0.851723, loss_d: 0.258104
0.0384 --- loss: 0.897049, loss_ss: 0.659341, loss_d: 0.237708
0.0767 --- loss: 1.298865, loss_ss: 0.926852, loss_d: 0.372013
0.1151 --- loss: 1.508201, loss_ss: 0.946899, loss_d: 0.561302
0.1534 --- loss: 1.394612, loss_ss: 0.819530, loss_d: 0.575082
0.1918 --- loss: 0.903903, loss_ss: 0.693976, loss_d: 0.209927
0.2301 --- loss: 1.088789, loss_ss: 0.939691, loss_d: 0.149098
0.2685 --- loss: 1.210114, loss_ss: 0.996100, loss_d: 0.214015
0.3069 --- loss: 0.647436, loss_ss: 0.547591, loss_d: 0.099845
0.3452 --- loss: 1.263398, loss_ss: 0.956106, loss_d: 0.307292
0.3836 --- loss: 1.812456, loss_ss: 1.164932, loss_d: 0.647524
0.4219 --- loss: 0.972572, loss_ss: 0.759243, loss_d: 0.213329
0.4603 --- loss: 0.804101, loss_ss: 0.695803, loss_d: 0.108297
0.4987 --- loss: 0.945701, loss_ss: 0.816238, loss_d: 0.129463
0.5370 --- loss: 1.167952, loss_ss: 0.888704, loss_d: 0.279247
0.5754 --- loss: 1.086025, loss_ss: 0.728694, loss_d: 0.357332
0.6137 --- loss: 1.013780, loss_ss: 0.865433, loss_d: 0.148347
0.6521 --- loss: 1.088278, loss_ss: 0.716209, loss_d: 0.372069
0.6904 --- loss: 0.941347, loss_ss: 0.778651, loss_d: 0.162695
0.7288 --- loss: 1.257805, loss_ss: 0.971156, loss_d: 0.286649
0.7672 --- loss: 1.613677, loss_ss: 1.167810, loss_d: 0.445867
0.8055 --- loss: 0.832624, loss_ss: 0.733530, loss_d: 0.099095
0.8439 --- loss: 1.024862, loss_ss: 0.843358, loss_d: 0.181504
0.8822 --- loss: 1.426618, loss_ss: 1.055194, loss_d: 0.371424
0.9206 --- loss: 0.949218, loss_ss: 0.716840, loss_d: 0.232378
0.9590 --- loss: 1.144339, loss_ss: 1.005292, loss_d: 0.139047
0.9973 --- loss: 1.140132, loss_ss: 0.965091, loss_d: 0.175040
Epoch finished! Loss: 1.1441679750497524
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6548387096774193
             precision    recall  f1-score   support

        0.0       0.57      0.91      0.70       119
        1.0       0.00      0.00      0.00        37
        2.0       0.95      0.33      0.49       387
        3.0       0.71      0.97      0.82       263
        4.0       0.48      0.96      0.64       124

avg / total       0.73      0.65      0.61       930
 


====== chp008-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  89.89  90.76   89.77  56.54     69.68
1  96.02   0.00  100.00   0.00      0.00
2  71.29  32.82   98.71  94.78     48.75
3  88.06  96.96   84.56  71.23     82.13
4  85.70  95.97   84.12  48.18     64.15
Total accuracy: 65.48%
Average sen: 63.30%
Average spec: 91.43%
Macro f1-score: 52.94%
Diagnosis acc on 15mins: 0.6129032258064516
[0.70104444 0.26955914 0.20733635 0.12483847 0.72883153 0.79757315
 0.68933731 0.96893513 0.51646566 0.23825777 0.47387204 0.73265642
 0.80456048 0.78263855 0.80039614 0.19524488 0.14705963 0.13087624
 0.55358732 0.73897815 0.67419404 0.9331798  0.20152795 0.22581339
 0.17098925 0.25776875 0.61653    0.73116314 0.68187642 0.99935538
 0.99862397]
pred: 0.5513893836928953, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp009-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.450475, loss_ss: 1.708366, loss_d: 0.742109
0.0384 --- loss: 1.919115, loss_ss: 1.419430, loss_d: 0.499685
0.0768 --- loss: 2.007836, loss_ss: 1.351719, loss_d: 0.656117
0.1152 --- loss: 1.953372, loss_ss: 1.326174, loss_d: 0.627198
0.1536 --- loss: 1.891595, loss_ss: 1.377679, loss_d: 0.513916
0.1920 --- loss: 1.646272, loss_ss: 1.325739, loss_d: 0.320533
0.2304 --- loss: 1.624496, loss_ss: 1.176067, loss_d: 0.448430
0.2688 --- loss: 2.034218, loss_ss: 1.613266, loss_d: 0.420952
0.3072 --- loss: 1.589126, loss_ss: 1.126710, loss_d: 0.462415
0.3456 --- loss: 1.901446, loss_ss: 1.273931, loss_d: 0.627515
0.3840 --- loss: 1.946549, loss_ss: 1.221136, loss_d: 0.725413
0.4224 --- loss: 1.555506, loss_ss: 1.131515, loss_d: 0.423991
0.4608 --- loss: 1.637567, loss_ss: 1.127066, loss_d: 0.510501
0.4992 --- loss: 1.588283, loss_ss: 1.126494, loss_d: 0.461789
0.5376 --- loss: 1.684481, loss_ss: 1.179213, loss_d: 0.505268
0.5760 --- loss: 1.767217, loss_ss: 1.305534, loss_d: 0.461683
0.6144 --- loss: 1.585011, loss_ss: 0.880264, loss_d: 0.704747
0.6528 --- loss: 1.951351, loss_ss: 1.290368, loss_d: 0.660984
0.6912 --- loss: 1.832885, loss_ss: 1.290595, loss_d: 0.542290
0.7296 --- loss: 1.949129, loss_ss: 1.322955, loss_d: 0.626173
0.7680 --- loss: 1.927394, loss_ss: 1.124138, loss_d: 0.803256
0.8065 --- loss: 1.998333, loss_ss: 1.199782, loss_d: 0.798551
0.8449 --- loss: 1.878069, loss_ss: 1.231760, loss_d: 0.646309
0.8833 --- loss: 1.548821, loss_ss: 1.064413, loss_d: 0.484407
0.9217 --- loss: 2.239432, loss_ss: 1.327582, loss_d: 0.911849
0.9601 --- loss: 1.494082, loss_ss: 0.948707, loss_d: 0.545375
0.9985 --- loss: 1.870789, loss_ss: 1.236984, loss_d: 0.633805
Epoch finished! Loss: 1.870912632575402
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.784307, loss_ss: 1.393651, loss_d: 0.390657
0.0384 --- loss: 1.825119, loss_ss: 1.025685, loss_d: 0.799434
0.0768 --- loss: 1.597434, loss_ss: 0.996713, loss_d: 0.600720
0.1152 --- loss: 1.516347, loss_ss: 1.043901, loss_d: 0.472446
0.1536 --- loss: 1.799522, loss_ss: 1.087149, loss_d: 0.712373
0.1920 --- loss: 1.404917, loss_ss: 0.981537, loss_d: 0.423380
0.2304 --- loss: 1.717416, loss_ss: 1.094181, loss_d: 0.623235
0.2688 --- loss: 1.860226, loss_ss: 1.255752, loss_d: 0.604473
0.3072 --- loss: 1.840869, loss_ss: 1.017044, loss_d: 0.823825
0.3456 --- loss: 1.627088, loss_ss: 1.022615, loss_d: 0.604474
0.3840 --- loss: 1.692870, loss_ss: 1.118326, loss_d: 0.574544
0.4224 --- loss: 1.825654, loss_ss: 1.381420, loss_d: 0.444234
0.4608 --- loss: 1.866007, loss_ss: 1.231070, loss_d: 0.634937
0.4992 --- loss: 1.334220, loss_ss: 1.084350, loss_d: 0.249870
0.5376 --- loss: 1.837481, loss_ss: 0.952271, loss_d: 0.885210
0.5760 --- loss: 1.561498, loss_ss: 1.027357, loss_d: 0.534141
0.6144 --- loss: 1.633882, loss_ss: 0.937664, loss_d: 0.696218
0.6528 --- loss: 1.670892, loss_ss: 1.107324, loss_d: 0.563568
0.6912 --- loss: 1.551395, loss_ss: 0.886843, loss_d: 0.664552
0.7296 --- loss: 1.369446, loss_ss: 0.752420, loss_d: 0.617026
0.7680 --- loss: 1.915639, loss_ss: 1.111338, loss_d: 0.804301
0.8065 --- loss: 1.881398, loss_ss: 1.233276, loss_d: 0.648122
0.8449 --- loss: 1.490408, loss_ss: 0.901020, loss_d: 0.589388
0.8833 --- loss: 1.783486, loss_ss: 1.050200, loss_d: 0.733286
0.9217 --- loss: 1.777000, loss_ss: 1.379105, loss_d: 0.397895
0.9601 --- loss: 1.737223, loss_ss: 1.277953, loss_d: 0.459270
0.9985 --- loss: 1.373573, loss_ss: 0.824639, loss_d: 0.548934
Epoch finished! Loss: 1.6820918935995834
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.395656, loss_ss: 0.851889, loss_d: 0.543767
0.0384 --- loss: 1.794689, loss_ss: 1.190238, loss_d: 0.604451
0.0768 --- loss: 1.273363, loss_ss: 0.865073, loss_d: 0.408290
0.1152 --- loss: 1.235503, loss_ss: 0.872598, loss_d: 0.362905
0.1536 --- loss: 1.539329, loss_ss: 0.902401, loss_d: 0.636928
0.1920 --- loss: 1.707156, loss_ss: 1.055800, loss_d: 0.651356
0.2304 --- loss: 1.642777, loss_ss: 0.870650, loss_d: 0.772127
0.2688 --- loss: 1.549945, loss_ss: 0.981203, loss_d: 0.568741
0.3072 --- loss: 1.474339, loss_ss: 0.910918, loss_d: 0.563421
0.3456 --- loss: 1.439134, loss_ss: 0.854035, loss_d: 0.585099
0.3840 --- loss: 1.572893, loss_ss: 1.052507, loss_d: 0.520386
0.4224 --- loss: 1.474271, loss_ss: 0.891298, loss_d: 0.582972
0.4608 --- loss: 0.974578, loss_ss: 0.650128, loss_d: 0.324450
0.4992 --- loss: 1.252888, loss_ss: 0.746637, loss_d: 0.506252
0.5376 --- loss: 1.307339, loss_ss: 0.749761, loss_d: 0.557578
0.5760 --- loss: 1.753767, loss_ss: 1.092543, loss_d: 0.661224
0.6144 --- loss: 1.717708, loss_ss: 0.874595, loss_d: 0.843113
0.6528 --- loss: 1.536717, loss_ss: 1.277956, loss_d: 0.258761
0.6912 --- loss: 1.422434, loss_ss: 0.989039, loss_d: 0.433395
0.7296 --- loss: 1.649263, loss_ss: 0.871629, loss_d: 0.777634
0.7680 --- loss: 1.405512, loss_ss: 0.787369, loss_d: 0.618143
0.8065 --- loss: 1.964082, loss_ss: 1.092589, loss_d: 0.871493
0.8449 --- loss: 1.638086, loss_ss: 0.898145, loss_d: 0.739942
0.8833 --- loss: 1.722170, loss_ss: 1.327679, loss_d: 0.394491
0.9217 --- loss: 1.672276, loss_ss: 1.055507, loss_d: 0.616769
0.9601 --- loss: 1.764335, loss_ss: 1.069752, loss_d: 0.694582
0.9985 --- loss: 1.649633, loss_ss: 0.954996, loss_d: 0.694637
Epoch finished! Loss: 1.5628599350269023
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.078349, loss_ss: 0.666523, loss_d: 0.411826
0.0384 --- loss: 1.428564, loss_ss: 0.815496, loss_d: 0.613068
0.0768 --- loss: 1.657120, loss_ss: 0.991711, loss_d: 0.665409
0.1152 --- loss: 1.850976, loss_ss: 1.399058, loss_d: 0.451917
0.1536 --- loss: 1.508511, loss_ss: 1.150501, loss_d: 0.358009
0.1920 --- loss: 1.770825, loss_ss: 1.356523, loss_d: 0.414302
0.2304 --- loss: 1.306399, loss_ss: 0.775264, loss_d: 0.531135
0.2688 --- loss: 1.669223, loss_ss: 1.199305, loss_d: 0.469918
0.3072 --- loss: 1.517239, loss_ss: 0.998105, loss_d: 0.519134
0.3456 --- loss: 1.366391, loss_ss: 0.989156, loss_d: 0.377235
0.3840 --- loss: 1.000527, loss_ss: 0.759805, loss_d: 0.240722
0.4224 --- loss: 1.210488, loss_ss: 0.810299, loss_d: 0.400189
0.4608 --- loss: 1.378523, loss_ss: 1.069794, loss_d: 0.308729
0.4992 --- loss: 1.511096, loss_ss: 1.051749, loss_d: 0.459347
0.5376 --- loss: 1.156789, loss_ss: 0.736653, loss_d: 0.420135
0.5760 --- loss: 1.553079, loss_ss: 1.107417, loss_d: 0.445661
0.6144 --- loss: 1.392877, loss_ss: 0.966587, loss_d: 0.426289
0.6528 --- loss: 1.249353, loss_ss: 0.853938, loss_d: 0.395415
0.6912 --- loss: 1.411084, loss_ss: 0.792467, loss_d: 0.618618
0.7296 --- loss: 1.471550, loss_ss: 0.895508, loss_d: 0.576042
0.7680 --- loss: 1.627514, loss_ss: 1.058114, loss_d: 0.569401
0.8065 --- loss: 1.361483, loss_ss: 0.887036, loss_d: 0.474448
0.8449 --- loss: 1.401287, loss_ss: 1.062603, loss_d: 0.338684
0.8833 --- loss: 1.336819, loss_ss: 0.862969, loss_d: 0.473850
0.9217 --- loss: 1.451653, loss_ss: 1.055041, loss_d: 0.396611
0.9601 --- loss: 1.547854, loss_ss: 1.016088, loss_d: 0.531766
0.9985 --- loss: 1.415356, loss_ss: 1.024647, loss_d: 0.390709
Epoch finished! Loss: 1.4945250015992384
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.714320, loss_ss: 1.260041, loss_d: 0.454279
0.0384 --- loss: 1.693635, loss_ss: 1.277767, loss_d: 0.415868
0.0768 --- loss: 1.336418, loss_ss: 0.850008, loss_d: 0.486409
0.1152 --- loss: 1.373736, loss_ss: 0.914228, loss_d: 0.459508
0.1536 --- loss: 1.474789, loss_ss: 0.826157, loss_d: 0.648632
0.1920 --- loss: 1.329950, loss_ss: 0.948459, loss_d: 0.381491
0.2304 --- loss: 1.514982, loss_ss: 0.874038, loss_d: 0.640944
0.2688 --- loss: 0.959432, loss_ss: 0.716116, loss_d: 0.243316
0.3072 --- loss: 1.169023, loss_ss: 0.946544, loss_d: 0.222479
0.3456 --- loss: 1.260055, loss_ss: 0.976677, loss_d: 0.283378
0.3840 --- loss: 1.189357, loss_ss: 0.841800, loss_d: 0.347557
0.4224 --- loss: 1.322123, loss_ss: 0.776018, loss_d: 0.546105
0.4608 --- loss: 1.733760, loss_ss: 1.115228, loss_d: 0.618532
0.4992 --- loss: 1.630268, loss_ss: 0.762968, loss_d: 0.867300
0.5376 --- loss: 1.419849, loss_ss: 0.753730, loss_d: 0.666119
0.5760 --- loss: 1.331568, loss_ss: 0.990061, loss_d: 0.341507
0.6144 --- loss: 1.217188, loss_ss: 0.695676, loss_d: 0.521512
0.6528 --- loss: 1.785255, loss_ss: 0.834645, loss_d: 0.950610
0.6912 --- loss: 1.306340, loss_ss: 0.892874, loss_d: 0.413466
0.7296 --- loss: 1.286462, loss_ss: 1.022639, loss_d: 0.263823
0.7680 --- loss: 1.523070, loss_ss: 0.861419, loss_d: 0.661651
0.8065 --- loss: 0.935272, loss_ss: 0.704103, loss_d: 0.231169
0.8449 --- loss: 1.213100, loss_ss: 1.009235, loss_d: 0.203865
0.8833 --- loss: 1.555694, loss_ss: 1.080015, loss_d: 0.475679
0.9217 --- loss: 1.456612, loss_ss: 0.858744, loss_d: 0.597868
0.9601 --- loss: 1.517250, loss_ss: 1.016986, loss_d: 0.500265
0.9985 --- loss: 1.228174, loss_ss: 0.765678, loss_d: 0.462496
Epoch finished! Loss: 1.4136509015009953
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.007580, loss_ss: 0.546497, loss_d: 0.461083
0.0384 --- loss: 1.841691, loss_ss: 0.993655, loss_d: 0.848035
0.0768 --- loss: 1.140726, loss_ss: 0.940097, loss_d: 0.200629
0.1152 --- loss: 1.583971, loss_ss: 1.205529, loss_d: 0.378442
0.1536 --- loss: 1.073170, loss_ss: 0.743703, loss_d: 0.329466
0.1920 --- loss: 1.109931, loss_ss: 0.858502, loss_d: 0.251429
0.2304 --- loss: 1.437077, loss_ss: 1.194261, loss_d: 0.242816
0.2688 --- loss: 1.366302, loss_ss: 0.678426, loss_d: 0.687876
0.3072 --- loss: 1.815135, loss_ss: 1.162522, loss_d: 0.652612
0.3456 --- loss: 1.264651, loss_ss: 1.016739, loss_d: 0.247912
0.3840 --- loss: 1.271850, loss_ss: 0.798668, loss_d: 0.473181
0.4224 --- loss: 1.361143, loss_ss: 0.942120, loss_d: 0.419022
0.4608 --- loss: 1.165759, loss_ss: 0.937376, loss_d: 0.228383
0.4992 --- loss: 1.062937, loss_ss: 0.778030, loss_d: 0.284907
0.5376 --- loss: 1.171600, loss_ss: 0.812771, loss_d: 0.358829
0.5760 --- loss: 0.852428, loss_ss: 0.754456, loss_d: 0.097973
0.6144 --- loss: 1.717860, loss_ss: 0.852815, loss_d: 0.865046
0.6528 --- loss: 1.226338, loss_ss: 0.773466, loss_d: 0.452872
0.6912 --- loss: 1.773241, loss_ss: 1.089010, loss_d: 0.684231
0.7296 --- loss: 1.211513, loss_ss: 0.676988, loss_d: 0.534525
0.7680 --- loss: 1.432116, loss_ss: 0.810210, loss_d: 0.621906
0.8065 --- loss: 1.688213, loss_ss: 1.109022, loss_d: 0.579191
0.8449 --- loss: 1.434544, loss_ss: 0.907028, loss_d: 0.527516
0.8833 --- loss: 1.159277, loss_ss: 0.871014, loss_d: 0.288263
0.9217 --- loss: 1.419620, loss_ss: 0.965226, loss_d: 0.454394
0.9601 --- loss: 1.323557, loss_ss: 0.913146, loss_d: 0.410411
0.9985 --- loss: 2.306733, loss_ss: 1.006866, loss_d: 1.299867
Epoch finished! Loss: 1.331614264845848
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.055517, loss_ss: 0.747124, loss_d: 0.308394
0.0384 --- loss: 1.151747, loss_ss: 0.835859, loss_d: 0.315887
0.0768 --- loss: 1.292458, loss_ss: 0.864998, loss_d: 0.427461
0.1152 --- loss: 1.042155, loss_ss: 0.615769, loss_d: 0.426387
0.1536 --- loss: 1.316910, loss_ss: 1.059588, loss_d: 0.257322
0.1920 --- loss: 1.097172, loss_ss: 0.828196, loss_d: 0.268976
0.2304 --- loss: 1.204987, loss_ss: 0.774125, loss_d: 0.430861
0.2688 --- loss: 1.177332, loss_ss: 0.830639, loss_d: 0.346693
0.3072 --- loss: 1.611657, loss_ss: 0.862056, loss_d: 0.749601
0.3456 --- loss: 1.179590, loss_ss: 0.924552, loss_d: 0.255038
0.3840 --- loss: 1.034584, loss_ss: 0.710437, loss_d: 0.324146
0.4224 --- loss: 1.429685, loss_ss: 0.907211, loss_d: 0.522475
0.4608 --- loss: 1.192203, loss_ss: 0.887976, loss_d: 0.304227
0.4992 --- loss: 1.343748, loss_ss: 0.961027, loss_d: 0.382720
0.5376 --- loss: 1.501425, loss_ss: 0.903214, loss_d: 0.598211
0.5760 --- loss: 1.458366, loss_ss: 0.842978, loss_d: 0.615388
0.6144 --- loss: 1.339193, loss_ss: 1.035640, loss_d: 0.303553
0.6528 --- loss: 1.388591, loss_ss: 1.016596, loss_d: 0.371995
0.6912 --- loss: 1.129974, loss_ss: 0.840908, loss_d: 0.289065
0.7296 --- loss: 0.756867, loss_ss: 0.580230, loss_d: 0.176637
0.7680 --- loss: 1.337703, loss_ss: 0.989045, loss_d: 0.348658
0.8065 --- loss: 1.092985, loss_ss: 0.839740, loss_d: 0.253245
0.8449 --- loss: 1.142009, loss_ss: 0.762336, loss_d: 0.379673
0.8833 --- loss: 1.515806, loss_ss: 1.176891, loss_d: 0.338914
0.9217 --- loss: 1.064406, loss_ss: 0.613102, loss_d: 0.451303
0.9601 --- loss: 0.994679, loss_ss: 0.749313, loss_d: 0.245366
0.9985 --- loss: 0.847340, loss_ss: 0.706441, loss_d: 0.140900
Epoch finished! Loss: 1.2713753111087358
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.133199, loss_ss: 0.944551, loss_d: 0.188648
0.0384 --- loss: 0.928775, loss_ss: 0.569526, loss_d: 0.359249
0.0768 --- loss: 1.348593, loss_ss: 1.111391, loss_d: 0.237203
0.1152 --- loss: 0.772312, loss_ss: 0.658264, loss_d: 0.114048
0.1536 --- loss: 1.198480, loss_ss: 0.855047, loss_d: 0.343433
0.1920 --- loss: 1.260507, loss_ss: 0.653659, loss_d: 0.606847
0.2304 --- loss: 1.508013, loss_ss: 1.023367, loss_d: 0.484645
0.2688 --- loss: 1.199401, loss_ss: 0.892150, loss_d: 0.307251
0.3072 --- loss: 1.341966, loss_ss: 0.941459, loss_d: 0.400507
0.3456 --- loss: 1.379789, loss_ss: 0.792500, loss_d: 0.587289
0.3840 --- loss: 1.784375, loss_ss: 1.139751, loss_d: 0.644625
0.4224 --- loss: 1.314677, loss_ss: 0.934763, loss_d: 0.379914
0.4608 --- loss: 1.174839, loss_ss: 0.800099, loss_d: 0.374739
0.4992 --- loss: 0.835618, loss_ss: 0.630604, loss_d: 0.205014
0.5376 --- loss: 1.271351, loss_ss: 0.691663, loss_d: 0.579688
0.5760 --- loss: 0.962832, loss_ss: 0.689394, loss_d: 0.273439
0.6144 --- loss: 1.363139, loss_ss: 0.925687, loss_d: 0.437453
0.6528 --- loss: 1.195060, loss_ss: 0.882145, loss_d: 0.312915
0.6912 --- loss: 0.803517, loss_ss: 0.510001, loss_d: 0.293516
0.7296 --- loss: 1.983446, loss_ss: 0.815386, loss_d: 1.168060
0.7680 --- loss: 1.308924, loss_ss: 1.007796, loss_d: 0.301127
0.8065 --- loss: 0.964831, loss_ss: 0.824682, loss_d: 0.140149
0.8449 --- loss: 1.382911, loss_ss: 0.768073, loss_d: 0.614838
0.8833 --- loss: 1.049449, loss_ss: 0.822503, loss_d: 0.226946
0.9217 --- loss: 1.332857, loss_ss: 0.925918, loss_d: 0.406939
0.9601 --- loss: 1.656386, loss_ss: 1.334236, loss_d: 0.322150
0.9985 --- loss: 1.335976, loss_ss: 0.967920, loss_d: 0.368055
Epoch finished! Loss: 1.237603267110311
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.198006, loss_ss: 0.930505, loss_d: 0.267501
0.0384 --- loss: 1.308053, loss_ss: 0.786726, loss_d: 0.521327
0.0768 --- loss: 0.942753, loss_ss: 0.662196, loss_d: 0.280557
0.1152 --- loss: 1.307218, loss_ss: 0.785990, loss_d: 0.521227
0.1536 --- loss: 0.963082, loss_ss: 0.752402, loss_d: 0.210680
0.1920 --- loss: 0.971117, loss_ss: 0.567902, loss_d: 0.403215
0.2304 --- loss: 1.206898, loss_ss: 0.910437, loss_d: 0.296461
0.2688 --- loss: 1.035896, loss_ss: 0.926521, loss_d: 0.109375
0.3072 --- loss: 1.517513, loss_ss: 1.073403, loss_d: 0.444110
0.3456 --- loss: 1.284456, loss_ss: 1.099649, loss_d: 0.184807
0.3840 --- loss: 0.820845, loss_ss: 0.619220, loss_d: 0.201625
0.4224 --- loss: 1.213675, loss_ss: 0.935471, loss_d: 0.278204
0.4608 --- loss: 1.452697, loss_ss: 0.948227, loss_d: 0.504470
0.4992 --- loss: 1.260250, loss_ss: 0.911763, loss_d: 0.348487
0.5376 --- loss: 1.053669, loss_ss: 0.693604, loss_d: 0.360065
0.5760 --- loss: 1.017301, loss_ss: 0.845021, loss_d: 0.172280
0.6144 --- loss: 1.122247, loss_ss: 0.860304, loss_d: 0.261943
0.6528 --- loss: 1.321715, loss_ss: 0.774203, loss_d: 0.547512
0.6912 --- loss: 0.669909, loss_ss: 0.522382, loss_d: 0.147527
0.7296 --- loss: 1.226108, loss_ss: 0.960871, loss_d: 0.265236
0.7680 --- loss: 1.433915, loss_ss: 0.746682, loss_d: 0.687233
0.8065 --- loss: 1.434019, loss_ss: 0.830581, loss_d: 0.603438
0.8449 --- loss: 1.042298, loss_ss: 0.626384, loss_d: 0.415915
0.8833 --- loss: 0.855780, loss_ss: 0.595126, loss_d: 0.260654
0.9217 --- loss: 0.913833, loss_ss: 0.643539, loss_d: 0.270293
0.9601 --- loss: 0.907523, loss_ss: 0.738907, loss_d: 0.168616
0.9985 --- loss: 1.194426, loss_ss: 1.103705, loss_d: 0.090721
Epoch finished! Loss: 1.1733821506683644
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.963251, loss_ss: 0.726481, loss_d: 0.236770
0.0384 --- loss: 1.154264, loss_ss: 0.988057, loss_d: 0.166207
0.0768 --- loss: 0.933366, loss_ss: 0.676127, loss_d: 0.257240
0.1152 --- loss: 0.759457, loss_ss: 0.648396, loss_d: 0.111061
0.1536 --- loss: 1.584348, loss_ss: 1.198247, loss_d: 0.386101
0.1920 --- loss: 1.423902, loss_ss: 1.351055, loss_d: 0.072847
0.2304 --- loss: 1.283022, loss_ss: 1.058959, loss_d: 0.224063
0.2688 --- loss: 1.640316, loss_ss: 1.024344, loss_d: 0.615972
0.3072 --- loss: 0.948053, loss_ss: 0.748228, loss_d: 0.199825
0.3456 --- loss: 1.305924, loss_ss: 0.920069, loss_d: 0.385854
0.3840 --- loss: 1.446902, loss_ss: 0.935902, loss_d: 0.511000
0.4224 --- loss: 0.787364, loss_ss: 0.664582, loss_d: 0.122782
0.4608 --- loss: 0.852822, loss_ss: 0.659905, loss_d: 0.192917
0.4992 --- loss: 0.767230, loss_ss: 0.630781, loss_d: 0.136449
0.5376 --- loss: 1.027584, loss_ss: 0.761137, loss_d: 0.266447
0.5760 --- loss: 1.370788, loss_ss: 1.202711, loss_d: 0.168077
0.6144 --- loss: 1.044277, loss_ss: 0.699805, loss_d: 0.344473
0.6528 --- loss: 1.001937, loss_ss: 0.690383, loss_d: 0.311553
0.6912 --- loss: 1.242428, loss_ss: 0.996324, loss_d: 0.246104
0.7296 --- loss: 0.844674, loss_ss: 0.739685, loss_d: 0.104988
0.7680 --- loss: 0.580245, loss_ss: 0.485174, loss_d: 0.095071
0.8065 --- loss: 1.061434, loss_ss: 0.722139, loss_d: 0.339295
0.8449 --- loss: 1.758624, loss_ss: 1.151778, loss_d: 0.606846
0.8833 --- loss: 0.913385, loss_ss: 0.660497, loss_d: 0.252889
0.9217 --- loss: 1.250112, loss_ss: 0.938835, loss_d: 0.311276
0.9601 --- loss: 1.593231, loss_ss: 0.823711, loss_d: 0.769520
0.9985 --- loss: 1.524518, loss_ss: 1.346962, loss_d: 0.177556
Epoch finished! Loss: 1.1712492018938065
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7627450980392156
             precision    recall  f1-score   support

        0.0       0.58      0.90      0.70        96
        1.0       0.30      0.07      0.12       123
        2.0       0.71      0.90      0.79       355
        3.0       0.98      0.91      0.95       209
        4.0       0.87      0.73      0.80       237

avg / total       0.74      0.76      0.74      1020
 


====== chp009-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.84  89.58   93.18  57.72     70.20
1  86.76   7.32   97.66  30.00     11.76
2  83.63  89.58   80.45  70.98     79.20
3  97.94  91.39   99.63  98.45     94.79
4  91.37  73.42   96.81  87.44     79.82
Total accuracy: 76.27%
Average sen: 70.26%
Average spec: 93.55%
Macro f1-score: 67.16%
Diagnosis acc on 15mins: 1.0
[0.99812025 0.99756455 0.99993992 0.92932612 0.82478732 0.96973932
 0.99992728 0.99994528 0.99998641 0.99999142 0.99999619 0.99998677
 0.9999727  0.99998236 0.99984479 0.9999361  0.99977118 0.99997151
 0.99974972 0.999856   0.90835553 0.84524363 0.84521461 0.99998498
 0.99992609 0.99996328 0.99994171 0.9999212  0.99997306 0.99989784
 0.99998999 0.99998009 0.9999752  0.99968851]
pred: 0.979895614525851, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp010-nsrr. train_data(2606), test_data(32) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.219098, loss_ss: 1.531232, loss_d: 0.687867
0.0384 --- loss: 2.275398, loss_ss: 1.827454, loss_d: 0.447944
0.0767 --- loss: 2.123387, loss_ss: 1.548030, loss_d: 0.575358
0.1151 --- loss: 2.493977, loss_ss: 1.543907, loss_d: 0.950070
0.1535 --- loss: 2.045890, loss_ss: 1.379874, loss_d: 0.666016
0.1919 --- loss: 2.155476, loss_ss: 1.692737, loss_d: 0.462739
0.2302 --- loss: 2.143061, loss_ss: 1.420763, loss_d: 0.722298
0.2686 --- loss: 1.880767, loss_ss: 1.521859, loss_d: 0.358907
0.3070 --- loss: 2.207809, loss_ss: 1.417783, loss_d: 0.790026
0.3454 --- loss: 1.978964, loss_ss: 1.490219, loss_d: 0.488745
0.3837 --- loss: 1.908987, loss_ss: 1.467852, loss_d: 0.441134
0.4221 --- loss: 2.000588, loss_ss: 1.431090, loss_d: 0.569498
0.4605 --- loss: 2.042760, loss_ss: 1.492939, loss_d: 0.549821
0.4988 --- loss: 2.065312, loss_ss: 1.530574, loss_d: 0.534738
0.5372 --- loss: 1.869183, loss_ss: 1.244391, loss_d: 0.624792
0.5756 --- loss: 2.188152, loss_ss: 1.365918, loss_d: 0.822234
0.6140 --- loss: 2.103483, loss_ss: 1.575292, loss_d: 0.528191
0.6523 --- loss: 1.839299, loss_ss: 1.349061, loss_d: 0.490238
0.6907 --- loss: 1.916001, loss_ss: 1.269283, loss_d: 0.646718
0.7291 --- loss: 2.013501, loss_ss: 1.546468, loss_d: 0.467034
0.7675 --- loss: 1.895635, loss_ss: 1.348712, loss_d: 0.546923
0.8058 --- loss: 2.144361, loss_ss: 1.451814, loss_d: 0.692547
0.8442 --- loss: 1.894145, loss_ss: 1.386603, loss_d: 0.507542
0.8826 --- loss: 1.996339, loss_ss: 1.393689, loss_d: 0.602650
0.9210 --- loss: 1.705417, loss_ss: 1.307298, loss_d: 0.398118
0.9593 --- loss: 1.616876, loss_ss: 1.255193, loss_d: 0.361683
0.9977 --- loss: 1.924321, loss_ss: 1.365248, loss_d: 0.559073
Epoch finished! Loss: 2.074996078472871
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.915933, loss_ss: 1.384891, loss_d: 0.531042
0.0384 --- loss: 1.969641, loss_ss: 1.288761, loss_d: 0.680880
0.0767 --- loss: 1.945282, loss_ss: 1.348340, loss_d: 0.596942
0.1151 --- loss: 2.075741, loss_ss: 1.496716, loss_d: 0.579025
0.1535 --- loss: 2.104948, loss_ss: 1.265381, loss_d: 0.839567
0.1919 --- loss: 1.549814, loss_ss: 1.100382, loss_d: 0.449431
0.2302 --- loss: 1.775510, loss_ss: 1.238763, loss_d: 0.536747
0.2686 --- loss: 1.948827, loss_ss: 1.277044, loss_d: 0.671783
0.3070 --- loss: 1.499239, loss_ss: 1.153919, loss_d: 0.345320
0.3454 --- loss: 1.780960, loss_ss: 1.112374, loss_d: 0.668586
0.3837 --- loss: 1.719380, loss_ss: 1.130442, loss_d: 0.588938
0.4221 --- loss: 1.805120, loss_ss: 1.072290, loss_d: 0.732830
0.4605 --- loss: 1.689015, loss_ss: 1.239289, loss_d: 0.449726
0.4988 --- loss: 1.841518, loss_ss: 1.033144, loss_d: 0.808375
0.5372 --- loss: 1.700698, loss_ss: 1.148531, loss_d: 0.552167
0.5756 --- loss: 1.651308, loss_ss: 1.186535, loss_d: 0.464773
0.6140 --- loss: 1.756480, loss_ss: 1.285453, loss_d: 0.471027
0.6523 --- loss: 1.402489, loss_ss: 0.948864, loss_d: 0.453626
0.6907 --- loss: 1.726743, loss_ss: 1.165028, loss_d: 0.561715
0.7291 --- loss: 1.851524, loss_ss: 1.286897, loss_d: 0.564626
0.7675 --- loss: 1.675229, loss_ss: 1.001043, loss_d: 0.674185
0.8058 --- loss: 1.823610, loss_ss: 1.126299, loss_d: 0.697311
0.8442 --- loss: 1.897014, loss_ss: 1.346772, loss_d: 0.550242
0.8826 --- loss: 1.588870, loss_ss: 1.021343, loss_d: 0.567528
0.9210 --- loss: 1.712884, loss_ss: 1.218126, loss_d: 0.494758
0.9593 --- loss: 1.655478, loss_ss: 0.953515, loss_d: 0.701963
0.9977 --- loss: 1.607761, loss_ss: 1.116035, loss_d: 0.491725
Epoch finished! Loss: 1.762528692300503
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.283328, loss_ss: 0.917810, loss_d: 0.365518
0.0384 --- loss: 1.459936, loss_ss: 1.026761, loss_d: 0.433175
0.0767 --- loss: 1.470001, loss_ss: 0.926845, loss_d: 0.543156
0.1151 --- loss: 1.455765, loss_ss: 1.104909, loss_d: 0.350856
0.1535 --- loss: 1.600756, loss_ss: 1.311138, loss_d: 0.289618
0.1919 --- loss: 1.580974, loss_ss: 0.915974, loss_d: 0.665001
0.2302 --- loss: 2.043437, loss_ss: 1.338712, loss_d: 0.704726
0.2686 --- loss: 1.419928, loss_ss: 0.816933, loss_d: 0.602995
0.3070 --- loss: 1.515806, loss_ss: 1.116703, loss_d: 0.399103
0.3454 --- loss: 1.892810, loss_ss: 1.144545, loss_d: 0.748265
0.3837 --- loss: 1.423293, loss_ss: 1.058962, loss_d: 0.364331
0.4221 --- loss: 1.919243, loss_ss: 1.133662, loss_d: 0.785581
0.4605 --- loss: 1.554743, loss_ss: 0.931539, loss_d: 0.623204
0.4988 --- loss: 1.356618, loss_ss: 0.997683, loss_d: 0.358935
0.5372 --- loss: 1.540542, loss_ss: 0.999243, loss_d: 0.541300
0.5756 --- loss: 1.774543, loss_ss: 1.180587, loss_d: 0.593957
0.6140 --- loss: 1.781950, loss_ss: 1.137164, loss_d: 0.644787
0.6523 --- loss: 1.417558, loss_ss: 0.838129, loss_d: 0.579429
0.6907 --- loss: 1.477542, loss_ss: 1.103698, loss_d: 0.373843
0.7291 --- loss: 1.318909, loss_ss: 1.002595, loss_d: 0.316314
0.7675 --- loss: 1.995946, loss_ss: 1.079103, loss_d: 0.916843
0.8058 --- loss: 1.628052, loss_ss: 1.070190, loss_d: 0.557862
0.8442 --- loss: 1.536499, loss_ss: 0.989590, loss_d: 0.546909
0.8826 --- loss: 1.522686, loss_ss: 1.131241, loss_d: 0.391444
0.9210 --- loss: 1.241570, loss_ss: 0.922558, loss_d: 0.319012
0.9593 --- loss: 1.540234, loss_ss: 0.910711, loss_d: 0.629523
0.9977 --- loss: 1.220114, loss_ss: 0.919399, loss_d: 0.300715
Epoch finished! Loss: 1.5834456737224871
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.289865, loss_ss: 0.918836, loss_d: 0.371029
0.0384 --- loss: 1.321533, loss_ss: 0.929791, loss_d: 0.391742
0.0767 --- loss: 2.015866, loss_ss: 1.044427, loss_d: 0.971439
0.1151 --- loss: 1.396578, loss_ss: 0.941544, loss_d: 0.455035
0.1535 --- loss: 2.179014, loss_ss: 1.381072, loss_d: 0.797943
0.1919 --- loss: 1.182916, loss_ss: 0.905885, loss_d: 0.277031
0.2302 --- loss: 1.191031, loss_ss: 0.920310, loss_d: 0.270721
0.2686 --- loss: 1.206460, loss_ss: 1.012600, loss_d: 0.193859
0.3070 --- loss: 1.281011, loss_ss: 0.902740, loss_d: 0.378271
0.3454 --- loss: 1.705939, loss_ss: 0.893363, loss_d: 0.812576
0.3837 --- loss: 1.642253, loss_ss: 0.710132, loss_d: 0.932122
0.4221 --- loss: 1.760586, loss_ss: 1.093530, loss_d: 0.667056
0.4605 --- loss: 1.373392, loss_ss: 0.962583, loss_d: 0.410809
0.4988 --- loss: 1.271986, loss_ss: 0.903173, loss_d: 0.368813
0.5372 --- loss: 1.281206, loss_ss: 0.919527, loss_d: 0.361679
0.5756 --- loss: 1.727782, loss_ss: 0.921490, loss_d: 0.806293
0.6140 --- loss: 1.455319, loss_ss: 1.070323, loss_d: 0.384996
0.6523 --- loss: 1.558118, loss_ss: 0.838129, loss_d: 0.719989
0.6907 --- loss: 1.232891, loss_ss: 0.940755, loss_d: 0.292136
0.7291 --- loss: 1.402915, loss_ss: 0.958971, loss_d: 0.443944
0.7675 --- loss: 1.313044, loss_ss: 0.990481, loss_d: 0.322563
0.8058 --- loss: 1.518145, loss_ss: 0.903994, loss_d: 0.614151
0.8442 --- loss: 1.459856, loss_ss: 1.124104, loss_d: 0.335752
0.8826 --- loss: 1.286360, loss_ss: 0.780496, loss_d: 0.505864
0.9210 --- loss: 1.419146, loss_ss: 0.984047, loss_d: 0.435100
0.9593 --- loss: 1.317929, loss_ss: 0.986862, loss_d: 0.331067
0.9977 --- loss: 1.462534, loss_ss: 1.120891, loss_d: 0.341643
Epoch finished! Loss: 1.427969275529568
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.014179, loss_ss: 0.815647, loss_d: 0.198532
0.0384 --- loss: 1.712925, loss_ss: 1.220586, loss_d: 0.492339
0.0767 --- loss: 1.256762, loss_ss: 0.714323, loss_d: 0.542439
0.1151 --- loss: 1.928225, loss_ss: 0.944510, loss_d: 0.983715
0.1535 --- loss: 1.088944, loss_ss: 0.755412, loss_d: 0.333533
0.1919 --- loss: 1.548449, loss_ss: 0.811641, loss_d: 0.736807
0.2302 --- loss: 1.279166, loss_ss: 1.036177, loss_d: 0.242989
0.2686 --- loss: 1.313218, loss_ss: 1.057838, loss_d: 0.255380
0.3070 --- loss: 1.383502, loss_ss: 1.006280, loss_d: 0.377222
0.3454 --- loss: 1.178201, loss_ss: 0.768580, loss_d: 0.409621
0.3837 --- loss: 1.344971, loss_ss: 0.958524, loss_d: 0.386447
0.4221 --- loss: 1.486352, loss_ss: 1.003108, loss_d: 0.483245
0.4605 --- loss: 1.241315, loss_ss: 0.964932, loss_d: 0.276383
0.4988 --- loss: 1.416888, loss_ss: 1.103147, loss_d: 0.313741
0.5372 --- loss: 1.082530, loss_ss: 0.889547, loss_d: 0.192983
0.5756 --- loss: 1.396795, loss_ss: 1.003449, loss_d: 0.393347
0.6140 --- loss: 0.950074, loss_ss: 0.726056, loss_d: 0.224019
0.6523 --- loss: 1.222923, loss_ss: 0.605119, loss_d: 0.617805
0.6907 --- loss: 1.487827, loss_ss: 0.910773, loss_d: 0.577054
0.7291 --- loss: 1.245938, loss_ss: 1.020241, loss_d: 0.225697
0.7675 --- loss: 1.270345, loss_ss: 1.053757, loss_d: 0.216589
0.8058 --- loss: 1.154700, loss_ss: 0.800073, loss_d: 0.354627
0.8442 --- loss: 1.002234, loss_ss: 0.789854, loss_d: 0.212379
0.8826 --- loss: 1.959251, loss_ss: 1.034309, loss_d: 0.924943
0.9210 --- loss: 1.703019, loss_ss: 0.912959, loss_d: 0.790059
0.9593 --- loss: 1.715600, loss_ss: 1.356421, loss_d: 0.359179
0.9977 --- loss: 1.524525, loss_ss: 1.183653, loss_d: 0.340872
Epoch finished! Loss: 1.331548603452169
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.958698, loss_ss: 0.736695, loss_d: 0.222003
0.0384 --- loss: 1.099911, loss_ss: 0.991271, loss_d: 0.108639
0.0767 --- loss: 1.307898, loss_ss: 0.981703, loss_d: 0.326195
0.1151 --- loss: 1.500378, loss_ss: 1.048297, loss_d: 0.452081
0.1535 --- loss: 0.949411, loss_ss: 0.638854, loss_d: 0.310557
0.1919 --- loss: 1.249040, loss_ss: 1.070926, loss_d: 0.178114
0.2302 --- loss: 1.265316, loss_ss: 1.162806, loss_d: 0.102510
0.2686 --- loss: 1.366298, loss_ss: 1.047943, loss_d: 0.318355
0.3070 --- loss: 1.073610, loss_ss: 0.928076, loss_d: 0.145534
0.3454 --- loss: 1.580885, loss_ss: 1.148336, loss_d: 0.432549
0.3837 --- loss: 0.807668, loss_ss: 0.605909, loss_d: 0.201759
0.4221 --- loss: 1.504580, loss_ss: 1.087274, loss_d: 0.417306
0.4605 --- loss: 0.952785, loss_ss: 0.700607, loss_d: 0.252178
0.4988 --- loss: 1.227167, loss_ss: 0.952896, loss_d: 0.274271
0.5372 --- loss: 1.686911, loss_ss: 1.190991, loss_d: 0.495920
0.5756 --- loss: 1.432892, loss_ss: 0.809129, loss_d: 0.623763
0.6140 --- loss: 1.488604, loss_ss: 0.984718, loss_d: 0.503886
0.6523 --- loss: 0.820934, loss_ss: 0.662068, loss_d: 0.158867
0.6907 --- loss: 1.183200, loss_ss: 0.953253, loss_d: 0.229947
0.7291 --- loss: 0.934713, loss_ss: 0.703587, loss_d: 0.231126
0.7675 --- loss: 1.393821, loss_ss: 1.145708, loss_d: 0.248112
0.8058 --- loss: 1.175636, loss_ss: 0.960904, loss_d: 0.214731
0.8442 --- loss: 0.992255, loss_ss: 0.683556, loss_d: 0.308699
0.8826 --- loss: 1.871399, loss_ss: 0.913892, loss_d: 0.957507
0.9210 --- loss: 1.185329, loss_ss: 0.879304, loss_d: 0.306024
0.9593 --- loss: 1.328855, loss_ss: 0.919856, loss_d: 0.408999
0.9977 --- loss: 1.060241, loss_ss: 0.735434, loss_d: 0.324807
Epoch finished! Loss: 1.2565092199123822
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.951874, loss_ss: 0.649181, loss_d: 0.302694
0.0384 --- loss: 0.885865, loss_ss: 0.665358, loss_d: 0.220507
0.0767 --- loss: 1.417684, loss_ss: 0.980583, loss_d: 0.437101
0.1151 --- loss: 1.121383, loss_ss: 0.911939, loss_d: 0.209444
0.1535 --- loss: 1.183356, loss_ss: 0.642610, loss_d: 0.540746
0.1919 --- loss: 1.534930, loss_ss: 0.830179, loss_d: 0.704751
0.2302 --- loss: 1.159789, loss_ss: 0.745180, loss_d: 0.414609
0.2686 --- loss: 1.621593, loss_ss: 1.244561, loss_d: 0.377032
0.3070 --- loss: 1.272189, loss_ss: 0.808239, loss_d: 0.463949
0.3454 --- loss: 1.389072, loss_ss: 0.909224, loss_d: 0.479849
0.3837 --- loss: 1.029623, loss_ss: 0.658789, loss_d: 0.370834
0.4221 --- loss: 1.404689, loss_ss: 1.104747, loss_d: 0.299943
0.4605 --- loss: 1.102384, loss_ss: 0.945909, loss_d: 0.156476
0.4988 --- loss: 0.919117, loss_ss: 0.749965, loss_d: 0.169152
0.5372 --- loss: 1.526300, loss_ss: 0.776494, loss_d: 0.749806
0.5756 --- loss: 1.661472, loss_ss: 1.077473, loss_d: 0.583999
0.6140 --- loss: 1.257231, loss_ss: 0.589269, loss_d: 0.667962
0.6523 --- loss: 1.237373, loss_ss: 1.010530, loss_d: 0.226843
0.6907 --- loss: 0.941921, loss_ss: 0.629483, loss_d: 0.312438
0.7291 --- loss: 1.066264, loss_ss: 0.899903, loss_d: 0.166360
0.7675 --- loss: 0.890364, loss_ss: 0.770447, loss_d: 0.119918
0.8058 --- loss: 1.157936, loss_ss: 0.832150, loss_d: 0.325786
0.8442 --- loss: 1.316258, loss_ss: 0.859426, loss_d: 0.456832
0.8826 --- loss: 1.017755, loss_ss: 0.909559, loss_d: 0.108196
0.9210 --- loss: 1.524752, loss_ss: 1.157005, loss_d: 0.367748
0.9593 --- loss: 0.922166, loss_ss: 0.775164, loss_d: 0.147002
0.9977 --- loss: 1.454312, loss_ss: 0.759564, loss_d: 0.694748
Epoch finished! Loss: 1.2137521535158158
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.126523, loss_ss: 0.879732, loss_d: 0.246791
0.0384 --- loss: 1.129662, loss_ss: 0.893186, loss_d: 0.236476
0.0767 --- loss: 0.801619, loss_ss: 0.583395, loss_d: 0.218224
0.1151 --- loss: 1.128222, loss_ss: 0.800462, loss_d: 0.327760
0.1535 --- loss: 1.455385, loss_ss: 0.961577, loss_d: 0.493808
0.1919 --- loss: 1.541908, loss_ss: 1.147994, loss_d: 0.393914
0.2302 --- loss: 2.018056, loss_ss: 1.608277, loss_d: 0.409779
0.2686 --- loss: 1.358592, loss_ss: 0.845254, loss_d: 0.513338
0.3070 --- loss: 1.127005, loss_ss: 0.931218, loss_d: 0.195787
0.3454 --- loss: 1.336964, loss_ss: 0.806839, loss_d: 0.530125
0.3837 --- loss: 0.901700, loss_ss: 0.736768, loss_d: 0.164932
0.4221 --- loss: 0.882101, loss_ss: 0.721497, loss_d: 0.160604
0.4605 --- loss: 1.053793, loss_ss: 0.802700, loss_d: 0.251092
0.4988 --- loss: 0.956500, loss_ss: 0.774086, loss_d: 0.182414
0.5372 --- loss: 1.070748, loss_ss: 0.722825, loss_d: 0.347923
0.5756 --- loss: 0.984123, loss_ss: 0.781402, loss_d: 0.202721
0.6140 --- loss: 0.893636, loss_ss: 0.826701, loss_d: 0.066935
0.6523 --- loss: 1.326200, loss_ss: 0.710183, loss_d: 0.616017
0.6907 --- loss: 1.332536, loss_ss: 1.121649, loss_d: 0.210887
0.7291 --- loss: 0.984044, loss_ss: 0.853966, loss_d: 0.130078
0.7675 --- loss: 1.359502, loss_ss: 1.097231, loss_d: 0.262271
0.8058 --- loss: 1.248311, loss_ss: 0.855589, loss_d: 0.392722
0.8442 --- loss: 1.058435, loss_ss: 0.892751, loss_d: 0.165684
0.8826 --- loss: 1.592975, loss_ss: 1.132737, loss_d: 0.460237
0.9210 --- loss: 1.336886, loss_ss: 1.048212, loss_d: 0.288674
0.9593 --- loss: 1.220046, loss_ss: 0.996977, loss_d: 0.223069
0.9977 --- loss: 1.319572, loss_ss: 0.944218, loss_d: 0.375354
Epoch finished! Loss: 1.1814239916893152
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.912690, loss_ss: 0.696398, loss_d: 0.216292
0.0384 --- loss: 1.303292, loss_ss: 1.001238, loss_d: 0.302053
0.0767 --- loss: 0.983130, loss_ss: 0.747573, loss_d: 0.235558
0.1151 --- loss: 1.181568, loss_ss: 0.693674, loss_d: 0.487895
0.1535 --- loss: 1.279264, loss_ss: 0.886171, loss_d: 0.393093
0.1919 --- loss: 1.427485, loss_ss: 0.976995, loss_d: 0.450490
0.2302 --- loss: 1.086722, loss_ss: 0.910819, loss_d: 0.175903
0.2686 --- loss: 1.002693, loss_ss: 0.858797, loss_d: 0.143896
0.3070 --- loss: 1.037166, loss_ss: 0.801586, loss_d: 0.235580
0.3454 --- loss: 1.435659, loss_ss: 1.136201, loss_d: 0.299458
0.3837 --- loss: 1.462186, loss_ss: 1.070599, loss_d: 0.391587
0.4221 --- loss: 1.535453, loss_ss: 0.838863, loss_d: 0.696589
0.4605 --- loss: 1.455126, loss_ss: 0.837835, loss_d: 0.617292
0.4988 --- loss: 1.087460, loss_ss: 0.600649, loss_d: 0.486811
0.5372 --- loss: 1.183561, loss_ss: 1.027073, loss_d: 0.156488
0.5756 --- loss: 1.232117, loss_ss: 0.913614, loss_d: 0.318503
0.6140 --- loss: 1.255705, loss_ss: 1.002313, loss_d: 0.253392
0.6523 --- loss: 0.729593, loss_ss: 0.516578, loss_d: 0.213014
0.6907 --- loss: 1.016624, loss_ss: 0.821792, loss_d: 0.194832
0.7291 --- loss: 0.805769, loss_ss: 0.710263, loss_d: 0.095506
0.7675 --- loss: 1.660066, loss_ss: 1.354733, loss_d: 0.305334
0.8058 --- loss: 1.282728, loss_ss: 0.944994, loss_d: 0.337734
0.8442 --- loss: 1.375457, loss_ss: 0.783458, loss_d: 0.591999
0.8826 --- loss: 1.200447, loss_ss: 0.768361, loss_d: 0.432086
0.9210 --- loss: 0.953394, loss_ss: 0.778154, loss_d: 0.175240
0.9593 --- loss: 0.852416, loss_ss: 0.752295, loss_d: 0.100121
0.9977 --- loss: 1.521557, loss_ss: 1.433849, loss_d: 0.087708
Epoch finished! Loss: 1.1432967809530405
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.941412, loss_ss: 0.756170, loss_d: 0.185242
0.0384 --- loss: 1.163002, loss_ss: 1.099940, loss_d: 0.063062
0.0767 --- loss: 0.818594, loss_ss: 0.695448, loss_d: 0.123146
0.1151 --- loss: 0.945038, loss_ss: 0.788327, loss_d: 0.156710
0.1535 --- loss: 1.598725, loss_ss: 1.277402, loss_d: 0.321323
0.1919 --- loss: 0.911321, loss_ss: 0.684394, loss_d: 0.226927
0.2302 --- loss: 1.048487, loss_ss: 0.821719, loss_d: 0.226768
0.2686 --- loss: 1.530539, loss_ss: 1.173380, loss_d: 0.357159
0.3070 --- loss: 0.948712, loss_ss: 0.659516, loss_d: 0.289196
0.3454 --- loss: 1.359217, loss_ss: 1.193218, loss_d: 0.165999
0.3837 --- loss: 1.027878, loss_ss: 0.792703, loss_d: 0.235175
0.4221 --- loss: 1.048744, loss_ss: 0.956078, loss_d: 0.092666
0.4605 --- loss: 1.311839, loss_ss: 0.910951, loss_d: 0.400888
0.4988 --- loss: 1.025738, loss_ss: 0.767908, loss_d: 0.257830
0.5372 --- loss: 1.036188, loss_ss: 0.562228, loss_d: 0.473959
0.5756 --- loss: 1.000966, loss_ss: 0.780525, loss_d: 0.220441
0.6140 --- loss: 1.145187, loss_ss: 0.981763, loss_d: 0.163424
0.6523 --- loss: 0.993403, loss_ss: 0.925060, loss_d: 0.068342
0.6907 --- loss: 1.333061, loss_ss: 1.012474, loss_d: 0.320587
0.7291 --- loss: 0.965903, loss_ss: 0.707767, loss_d: 0.258136
0.7675 --- loss: 0.763308, loss_ss: 0.530595, loss_d: 0.232713
0.8058 --- loss: 1.073186, loss_ss: 0.756259, loss_d: 0.316927
0.8442 --- loss: 0.795173, loss_ss: 0.673459, loss_d: 0.121714
0.8826 --- loss: 1.306126, loss_ss: 1.049650, loss_d: 0.256476
0.9210 --- loss: 1.246865, loss_ss: 1.012972, loss_d: 0.233893
0.9593 --- loss: 0.941184, loss_ss: 0.684634, loss_d: 0.256550
0.9977 --- loss: 1.069845, loss_ss: 0.616552, loss_d: 0.453293
Epoch finished! Loss: 1.1400090091503583
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6
             precision    recall  f1-score   support

        0.0       0.22      0.88      0.35        57
        1.0       0.00      0.00      0.00        60
        2.0       0.99      0.48      0.65       496
        3.0       0.78      0.94      0.85        90
        4.0       0.54      0.78      0.64       257

avg / total       0.74      0.60      0.61       960
 


====== chp010-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  80.42  87.72   79.96  21.65     34.72
1  93.12   0.00   99.33   0.00      0.00
2  73.02  48.39   99.35  98.77     64.95
3  96.98  94.44   97.24  77.98     85.43
4  76.46  78.21   75.82  54.18     64.01
Total accuracy: 60.00%
Average sen: 61.75%
Average spec: 90.34%
Macro f1-score: 49.82%
Diagnosis acc on 15mins: 1.0
[0.98578411 0.98285151 0.58786923 0.70877081 0.89535207 0.84341776
 0.99095309 0.96859241 0.99230015 0.97819841 0.99714452 0.90970969
 0.80573171 0.97776276 0.98737413 0.92717648 0.92987698 0.97605568
 0.99998927 0.53531766 0.91030043 0.92526776 0.97546947 0.97521973
 0.92128259 0.9804551  0.96062273 0.7892738  0.94774312 0.95239019
 0.97050762 0.95107144]
pred: 0.9137447625398636, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp011-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.327112, loss_ss: 1.656337, loss_d: 0.670775
0.0384 --- loss: 2.353509, loss_ss: 1.504367, loss_d: 0.849142
0.0768 --- loss: 1.956882, loss_ss: 1.418762, loss_d: 0.538120
0.1152 --- loss: 2.162950, loss_ss: 1.466237, loss_d: 0.696713
0.1536 --- loss: 2.166312, loss_ss: 1.511185, loss_d: 0.655127
0.1919 --- loss: 2.067244, loss_ss: 1.327645, loss_d: 0.739599
0.2303 --- loss: 1.883284, loss_ss: 1.441253, loss_d: 0.442031
0.2687 --- loss: 2.175976, loss_ss: 1.442714, loss_d: 0.733262
0.3071 --- loss: 1.859827, loss_ss: 1.350942, loss_d: 0.508885
0.3455 --- loss: 2.091249, loss_ss: 1.560697, loss_d: 0.530552
0.3839 --- loss: 1.612630, loss_ss: 1.196076, loss_d: 0.416554
0.4223 --- loss: 2.031864, loss_ss: 1.199481, loss_d: 0.832383
0.4607 --- loss: 1.872603, loss_ss: 1.312248, loss_d: 0.560355
0.4990 --- loss: 1.980592, loss_ss: 1.329180, loss_d: 0.651412
0.5374 --- loss: 1.739959, loss_ss: 1.240139, loss_d: 0.499820
0.5758 --- loss: 1.424953, loss_ss: 1.185379, loss_d: 0.239575
0.6142 --- loss: 1.377597, loss_ss: 1.180083, loss_d: 0.197514
0.6526 --- loss: 1.637143, loss_ss: 1.168769, loss_d: 0.468374
0.6910 --- loss: 2.084151, loss_ss: 1.338872, loss_d: 0.745278
0.7294 --- loss: 1.567441, loss_ss: 1.115936, loss_d: 0.451506
0.7678 --- loss: 1.731472, loss_ss: 1.243260, loss_d: 0.488212
0.8061 --- loss: 1.599309, loss_ss: 1.128286, loss_d: 0.471023
0.8445 --- loss: 1.819584, loss_ss: 1.211290, loss_d: 0.608294
0.8829 --- loss: 1.996324, loss_ss: 1.271201, loss_d: 0.725124
0.9213 --- loss: 1.718040, loss_ss: 1.191631, loss_d: 0.526409
0.9597 --- loss: 1.773036, loss_ss: 1.199922, loss_d: 0.573114
0.9981 --- loss: 1.848715, loss_ss: 1.221274, loss_d: 0.627442
Epoch finished! Loss: 1.9308072699950292
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.610934, loss_ss: 0.844749, loss_d: 0.766186
0.0384 --- loss: 1.594039, loss_ss: 1.074584, loss_d: 0.519455
0.0768 --- loss: 1.390637, loss_ss: 0.889605, loss_d: 0.501032
0.1152 --- loss: 1.709476, loss_ss: 1.214490, loss_d: 0.494986
0.1536 --- loss: 1.870432, loss_ss: 1.361088, loss_d: 0.509344
0.1919 --- loss: 1.714370, loss_ss: 1.151891, loss_d: 0.562479
0.2303 --- loss: 1.460776, loss_ss: 0.961914, loss_d: 0.498862
0.2687 --- loss: 1.745705, loss_ss: 0.966570, loss_d: 0.779135
0.3071 --- loss: 1.891976, loss_ss: 1.281865, loss_d: 0.610111
0.3455 --- loss: 1.584997, loss_ss: 1.074458, loss_d: 0.510539
0.3839 --- loss: 1.614401, loss_ss: 1.087436, loss_d: 0.526965
0.4223 --- loss: 1.664893, loss_ss: 1.163372, loss_d: 0.501521
0.4607 --- loss: 1.543933, loss_ss: 0.893914, loss_d: 0.650019
0.4990 --- loss: 1.508103, loss_ss: 1.024470, loss_d: 0.483633
0.5374 --- loss: 1.891488, loss_ss: 1.342927, loss_d: 0.548561
0.5758 --- loss: 2.273598, loss_ss: 1.369914, loss_d: 0.903684
0.6142 --- loss: 1.753271, loss_ss: 0.986711, loss_d: 0.766560
0.6526 --- loss: 1.710223, loss_ss: 1.063899, loss_d: 0.646324
0.6910 --- loss: 1.552558, loss_ss: 0.963250, loss_d: 0.589309
0.7294 --- loss: 1.347525, loss_ss: 0.941197, loss_d: 0.406328
0.7678 --- loss: 1.892815, loss_ss: 1.398830, loss_d: 0.493984
0.8061 --- loss: 1.655446, loss_ss: 1.288622, loss_d: 0.366824
0.8445 --- loss: 1.893642, loss_ss: 1.300760, loss_d: 0.592883
0.8829 --- loss: 1.432387, loss_ss: 0.915541, loss_d: 0.516846
0.9213 --- loss: 1.687407, loss_ss: 1.058412, loss_d: 0.628996
0.9597 --- loss: 1.761781, loss_ss: 1.135402, loss_d: 0.626379
0.9981 --- loss: 1.170307, loss_ss: 0.649489, loss_d: 0.520817
Epoch finished! Loss: 1.6773333315665906
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.716627, loss_ss: 1.139346, loss_d: 0.577281
0.0384 --- loss: 1.163388, loss_ss: 0.696500, loss_d: 0.466887
0.0768 --- loss: 1.683057, loss_ss: 1.057306, loss_d: 0.625751
0.1152 --- loss: 1.348456, loss_ss: 0.814104, loss_d: 0.534352
0.1536 --- loss: 1.847267, loss_ss: 1.001225, loss_d: 0.846042
0.1919 --- loss: 1.391000, loss_ss: 0.964004, loss_d: 0.426997
0.2303 --- loss: 1.449970, loss_ss: 1.031875, loss_d: 0.418095
0.2687 --- loss: 1.550716, loss_ss: 0.888199, loss_d: 0.662518
0.3071 --- loss: 1.687306, loss_ss: 0.983665, loss_d: 0.703641
0.3455 --- loss: 1.419509, loss_ss: 1.090161, loss_d: 0.329348
0.3839 --- loss: 1.353374, loss_ss: 0.827827, loss_d: 0.525547
0.4223 --- loss: 1.524573, loss_ss: 0.787822, loss_d: 0.736751
0.4607 --- loss: 1.305851, loss_ss: 0.852396, loss_d: 0.453455
0.4990 --- loss: 1.763249, loss_ss: 1.012581, loss_d: 0.750668
0.5374 --- loss: 1.720379, loss_ss: 1.047772, loss_d: 0.672607
0.5758 --- loss: 1.463776, loss_ss: 0.969710, loss_d: 0.494066
0.6142 --- loss: 1.443597, loss_ss: 0.833408, loss_d: 0.610189
0.6526 --- loss: 1.453488, loss_ss: 1.011706, loss_d: 0.441782
0.6910 --- loss: 1.369304, loss_ss: 0.718273, loss_d: 0.651031
0.7294 --- loss: 1.713957, loss_ss: 0.942697, loss_d: 0.771260
0.7678 --- loss: 1.455540, loss_ss: 0.838195, loss_d: 0.617345
0.8061 --- loss: 1.564385, loss_ss: 1.018948, loss_d: 0.545437
0.8445 --- loss: 1.427407, loss_ss: 0.753470, loss_d: 0.673937
0.8829 --- loss: 1.370807, loss_ss: 0.963430, loss_d: 0.407376
0.9213 --- loss: 1.572802, loss_ss: 1.101927, loss_d: 0.470875
0.9597 --- loss: 1.594492, loss_ss: 1.085521, loss_d: 0.508971
0.9981 --- loss: 1.419984, loss_ss: 0.928532, loss_d: 0.491452
Epoch finished! Loss: 1.6074364570470956
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.795082, loss_ss: 1.025764, loss_d: 0.769318
0.0384 --- loss: 1.535279, loss_ss: 0.925688, loss_d: 0.609590
0.0768 --- loss: 1.894264, loss_ss: 1.185743, loss_d: 0.708521
0.1152 --- loss: 1.375587, loss_ss: 0.991479, loss_d: 0.384108
0.1536 --- loss: 1.909557, loss_ss: 1.301018, loss_d: 0.608538
0.1919 --- loss: 1.510641, loss_ss: 1.005106, loss_d: 0.505534
0.2303 --- loss: 1.308246, loss_ss: 0.880151, loss_d: 0.428095
0.2687 --- loss: 1.581051, loss_ss: 0.851343, loss_d: 0.729707
0.3071 --- loss: 1.468013, loss_ss: 1.050070, loss_d: 0.417943
0.3455 --- loss: 1.428304, loss_ss: 0.740297, loss_d: 0.688007
0.3839 --- loss: 1.637122, loss_ss: 0.879575, loss_d: 0.757547
0.4223 --- loss: 1.430641, loss_ss: 0.944933, loss_d: 0.485708
0.4607 --- loss: 1.390715, loss_ss: 0.938338, loss_d: 0.452377
0.4990 --- loss: 1.807137, loss_ss: 1.091873, loss_d: 0.715265
0.5374 --- loss: 1.368224, loss_ss: 0.725738, loss_d: 0.642485
0.5758 --- loss: 1.368544, loss_ss: 0.779877, loss_d: 0.588667
0.6142 --- loss: 1.558794, loss_ss: 0.903248, loss_d: 0.655546
0.6526 --- loss: 1.377874, loss_ss: 0.873377, loss_d: 0.504497
0.6910 --- loss: 1.033056, loss_ss: 0.626234, loss_d: 0.406822
0.7294 --- loss: 1.473899, loss_ss: 0.894499, loss_d: 0.579400
0.7678 --- loss: 1.415930, loss_ss: 0.989655, loss_d: 0.426275
0.8061 --- loss: 1.445687, loss_ss: 0.766340, loss_d: 0.679346
0.8445 --- loss: 2.109535, loss_ss: 1.137606, loss_d: 0.971930
0.8829 --- loss: 1.536234, loss_ss: 1.002700, loss_d: 0.533534
0.9213 --- loss: 1.373676, loss_ss: 0.806534, loss_d: 0.567142
0.9597 --- loss: 1.443015, loss_ss: 0.972253, loss_d: 0.470761
0.9981 --- loss: 1.790362, loss_ss: 1.142576, loss_d: 0.647786
Epoch finished! Loss: 1.5508406744553493
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.767408, loss_ss: 0.982314, loss_d: 0.785095
0.0384 --- loss: 1.389281, loss_ss: 0.852285, loss_d: 0.536996
0.0768 --- loss: 1.684229, loss_ss: 1.006005, loss_d: 0.678225
0.1152 --- loss: 1.379916, loss_ss: 0.936847, loss_d: 0.443069
0.1536 --- loss: 1.564368, loss_ss: 0.952448, loss_d: 0.611921
0.1919 --- loss: 1.404327, loss_ss: 0.808653, loss_d: 0.595674
0.2303 --- loss: 1.562722, loss_ss: 1.005405, loss_d: 0.557317
0.2687 --- loss: 1.523868, loss_ss: 1.223255, loss_d: 0.300613
0.3071 --- loss: 1.370160, loss_ss: 1.023024, loss_d: 0.347136
0.3455 --- loss: 1.888975, loss_ss: 0.935305, loss_d: 0.953670
0.3839 --- loss: 1.371854, loss_ss: 0.848823, loss_d: 0.523031
0.4223 --- loss: 1.792354, loss_ss: 1.181002, loss_d: 0.611351
0.4607 --- loss: 1.427072, loss_ss: 0.800918, loss_d: 0.626154
0.4990 --- loss: 1.233457, loss_ss: 0.769936, loss_d: 0.463521
0.5374 --- loss: 1.303233, loss_ss: 0.720985, loss_d: 0.582248
0.5758 --- loss: 1.592733, loss_ss: 0.831463, loss_d: 0.761270
0.6142 --- loss: 1.344186, loss_ss: 0.894770, loss_d: 0.449415
0.6526 --- loss: 1.314359, loss_ss: 0.838329, loss_d: 0.476029
0.6910 --- loss: 1.295032, loss_ss: 0.854727, loss_d: 0.440306
0.7294 --- loss: 1.181983, loss_ss: 0.699953, loss_d: 0.482030
0.7678 --- loss: 1.611915, loss_ss: 0.903087, loss_d: 0.708829
0.8061 --- loss: 1.639541, loss_ss: 0.754889, loss_d: 0.884652
0.8445 --- loss: 1.967888, loss_ss: 1.278185, loss_d: 0.689703
0.8829 --- loss: 2.830317, loss_ss: 2.065794, loss_d: 0.764523
0.9213 --- loss: 1.287467, loss_ss: 0.916924, loss_d: 0.370544
0.9597 --- loss: 1.457486, loss_ss: 1.085085, loss_d: 0.372401
0.9981 --- loss: 1.169434, loss_ss: 0.847998, loss_d: 0.321436
Epoch finished! Loss: 1.489300783780905
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.773567, loss_ss: 0.998553, loss_d: 0.775014
0.0384 --- loss: 1.749867, loss_ss: 1.159222, loss_d: 0.590645
0.0768 --- loss: 1.166345, loss_ss: 0.729938, loss_d: 0.436407
0.1152 --- loss: 1.598862, loss_ss: 1.068740, loss_d: 0.530121
0.1536 --- loss: 1.141004, loss_ss: 0.862180, loss_d: 0.278824
0.1919 --- loss: 1.220380, loss_ss: 0.746048, loss_d: 0.474332
0.2303 --- loss: 1.924721, loss_ss: 0.976285, loss_d: 0.948436
0.2687 --- loss: 1.265953, loss_ss: 0.952591, loss_d: 0.313362
0.3071 --- loss: 1.316589, loss_ss: 1.050144, loss_d: 0.266445
0.3455 --- loss: 1.266516, loss_ss: 0.845932, loss_d: 0.420584
0.3839 --- loss: 1.250205, loss_ss: 0.810743, loss_d: 0.439462
0.4223 --- loss: 1.616574, loss_ss: 0.854432, loss_d: 0.762141
0.4607 --- loss: 1.160627, loss_ss: 0.572747, loss_d: 0.587880
0.4990 --- loss: 1.029363, loss_ss: 0.659273, loss_d: 0.370091
0.5374 --- loss: 1.673613, loss_ss: 0.923809, loss_d: 0.749804
0.5758 --- loss: 1.505875, loss_ss: 1.075332, loss_d: 0.430543
0.6142 --- loss: 1.414528, loss_ss: 1.168880, loss_d: 0.245647
0.6526 --- loss: 1.234030, loss_ss: 0.792210, loss_d: 0.441819
0.6910 --- loss: 0.865871, loss_ss: 0.716234, loss_d: 0.149637
0.7294 --- loss: 1.164142, loss_ss: 0.754308, loss_d: 0.409834
0.7678 --- loss: 1.258248, loss_ss: 0.831603, loss_d: 0.426645
0.8061 --- loss: 1.330896, loss_ss: 1.049716, loss_d: 0.281179
0.8445 --- loss: 1.363662, loss_ss: 0.979659, loss_d: 0.384003
0.8829 --- loss: 1.442809, loss_ss: 0.650713, loss_d: 0.792096
0.9213 --- loss: 1.051689, loss_ss: 0.685155, loss_d: 0.366534
0.9597 --- loss: 1.578602, loss_ss: 0.943498, loss_d: 0.635104
0.9981 --- loss: 1.400784, loss_ss: 1.055140, loss_d: 0.345644
Epoch finished! Loss: 1.3818885755080443
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.118482, loss_ss: 0.850613, loss_d: 0.267868
0.0384 --- loss: 0.889420, loss_ss: 0.628012, loss_d: 0.261407
0.0768 --- loss: 0.885456, loss_ss: 0.640345, loss_d: 0.245110
0.1152 --- loss: 1.089093, loss_ss: 0.903838, loss_d: 0.185255
0.1536 --- loss: 1.278467, loss_ss: 0.962519, loss_d: 0.315948
0.1919 --- loss: 1.230879, loss_ss: 0.756785, loss_d: 0.474093
0.2303 --- loss: 1.326424, loss_ss: 0.945478, loss_d: 0.380946
0.2687 --- loss: 1.060593, loss_ss: 0.784230, loss_d: 0.276363
0.3071 --- loss: 1.601916, loss_ss: 0.917198, loss_d: 0.684718
0.3455 --- loss: 1.247043, loss_ss: 0.835789, loss_d: 0.411254
0.3839 --- loss: 1.249275, loss_ss: 0.829489, loss_d: 0.419786
0.4223 --- loss: 1.157272, loss_ss: 0.902097, loss_d: 0.255175
0.4607 --- loss: 1.268999, loss_ss: 0.913458, loss_d: 0.355541
0.4990 --- loss: 1.090990, loss_ss: 0.627773, loss_d: 0.463217
0.5374 --- loss: 1.760729, loss_ss: 0.840561, loss_d: 0.920168
0.5758 --- loss: 1.180216, loss_ss: 0.786088, loss_d: 0.394128
0.6142 --- loss: 1.382007, loss_ss: 1.018916, loss_d: 0.363091
0.6526 --- loss: 1.307164, loss_ss: 1.005000, loss_d: 0.302165
0.6910 --- loss: 1.040877, loss_ss: 0.741618, loss_d: 0.299258
0.7294 --- loss: 1.461918, loss_ss: 1.105088, loss_d: 0.356830
0.7678 --- loss: 1.237116, loss_ss: 0.951580, loss_d: 0.285536
0.8061 --- loss: 1.037635, loss_ss: 0.937692, loss_d: 0.099943
0.8445 --- loss: 1.101761, loss_ss: 0.736669, loss_d: 0.365093
0.8829 --- loss: 1.010426, loss_ss: 0.819595, loss_d: 0.190831
0.9213 --- loss: 1.233606, loss_ss: 0.798205, loss_d: 0.435401
0.9597 --- loss: 1.626424, loss_ss: 1.153362, loss_d: 0.473062
0.9981 --- loss: 1.921893, loss_ss: 1.580940, loss_d: 0.340953
Epoch finished! Loss: 1.3065967534597103
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.306821, loss_ss: 0.937869, loss_d: 0.368952
0.0384 --- loss: 1.138780, loss_ss: 0.755558, loss_d: 0.383222
0.0768 --- loss: 1.045503, loss_ss: 0.716152, loss_d: 0.329351
0.1152 --- loss: 0.939957, loss_ss: 0.756401, loss_d: 0.183556
0.1536 --- loss: 1.472435, loss_ss: 0.949108, loss_d: 0.523326
0.1919 --- loss: 1.834816, loss_ss: 0.835628, loss_d: 0.999188
0.2303 --- loss: 0.868543, loss_ss: 0.694375, loss_d: 0.174168
0.2687 --- loss: 1.409039, loss_ss: 0.727947, loss_d: 0.681092
0.3071 --- loss: 1.000903, loss_ss: 0.756539, loss_d: 0.244364
0.3455 --- loss: 0.876133, loss_ss: 0.679972, loss_d: 0.196161
0.3839 --- loss: 1.157703, loss_ss: 0.672003, loss_d: 0.485700
0.4223 --- loss: 1.016225, loss_ss: 0.664628, loss_d: 0.351597
0.4607 --- loss: 1.251898, loss_ss: 0.831489, loss_d: 0.420408
0.4990 --- loss: 1.499263, loss_ss: 0.973249, loss_d: 0.526014
0.5374 --- loss: 1.388222, loss_ss: 0.894930, loss_d: 0.493292
0.5758 --- loss: 1.221068, loss_ss: 0.958573, loss_d: 0.262495
0.6142 --- loss: 1.482791, loss_ss: 0.964388, loss_d: 0.518403
0.6526 --- loss: 0.995008, loss_ss: 0.758353, loss_d: 0.236655
0.6910 --- loss: 1.146618, loss_ss: 0.953260, loss_d: 0.193358
0.7294 --- loss: 1.247310, loss_ss: 0.897861, loss_d: 0.349449
0.7678 --- loss: 0.956898, loss_ss: 0.648932, loss_d: 0.307966
0.8061 --- loss: 1.407855, loss_ss: 0.730840, loss_d: 0.677015
0.8445 --- loss: 1.041031, loss_ss: 0.587662, loss_d: 0.453370
0.8829 --- loss: 1.015536, loss_ss: 0.776936, loss_d: 0.238600
0.9213 --- loss: 1.217173, loss_ss: 0.810793, loss_d: 0.406380
0.9597 --- loss: 1.159167, loss_ss: 0.980542, loss_d: 0.178624
0.9981 --- loss: 1.398535, loss_ss: 1.276651, loss_d: 0.121884
Epoch finished! Loss: 1.2343690248636099
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.200423, loss_ss: 0.817750, loss_d: 0.382673
0.0384 --- loss: 1.223114, loss_ss: 1.039287, loss_d: 0.183827
0.0768 --- loss: 0.858451, loss_ss: 0.725223, loss_d: 0.133229
0.1152 --- loss: 1.212389, loss_ss: 0.676985, loss_d: 0.535405
0.1536 --- loss: 1.586437, loss_ss: 0.901813, loss_d: 0.684624
0.1919 --- loss: 0.755316, loss_ss: 0.591101, loss_d: 0.164216
0.2303 --- loss: 1.165513, loss_ss: 0.914775, loss_d: 0.250738
0.2687 --- loss: 1.112542, loss_ss: 0.780254, loss_d: 0.332288
0.3071 --- loss: 1.477063, loss_ss: 1.326492, loss_d: 0.150570
0.3455 --- loss: 0.979369, loss_ss: 0.856828, loss_d: 0.122540
0.3839 --- loss: 0.854929, loss_ss: 0.640122, loss_d: 0.214807
0.4223 --- loss: 1.299160, loss_ss: 0.823247, loss_d: 0.475913
0.4607 --- loss: 1.081595, loss_ss: 0.884546, loss_d: 0.197049
0.4990 --- loss: 0.937899, loss_ss: 0.717023, loss_d: 0.220876
0.5374 --- loss: 0.939999, loss_ss: 0.700274, loss_d: 0.239725
0.5758 --- loss: 0.850414, loss_ss: 0.696825, loss_d: 0.153589
0.6142 --- loss: 1.332841, loss_ss: 0.893780, loss_d: 0.439060
0.6526 --- loss: 1.040216, loss_ss: 0.930479, loss_d: 0.109737
0.6910 --- loss: 1.046873, loss_ss: 0.794424, loss_d: 0.252449
0.7294 --- loss: 0.960419, loss_ss: 0.779211, loss_d: 0.181208
0.7678 --- loss: 0.984986, loss_ss: 0.831506, loss_d: 0.153479
0.8061 --- loss: 1.123936, loss_ss: 1.006234, loss_d: 0.117702
0.8445 --- loss: 1.293190, loss_ss: 0.867240, loss_d: 0.425950
0.8829 --- loss: 0.953977, loss_ss: 0.747096, loss_d: 0.206881
0.9213 --- loss: 1.332056, loss_ss: 0.712391, loss_d: 0.619665
0.9597 --- loss: 0.983018, loss_ss: 0.773624, loss_d: 0.209394
0.9981 --- loss: 1.827941, loss_ss: 0.975585, loss_d: 0.852356
Epoch finished! Loss: 1.178135513342344
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.907720, loss_ss: 0.593424, loss_d: 0.314295
0.0384 --- loss: 1.249571, loss_ss: 1.032205, loss_d: 0.217366
0.0768 --- loss: 1.408979, loss_ss: 0.916569, loss_d: 0.492410
0.1152 --- loss: 0.884127, loss_ss: 0.587407, loss_d: 0.296720
0.1536 --- loss: 0.991246, loss_ss: 0.761284, loss_d: 0.229962
0.1919 --- loss: 1.452470, loss_ss: 0.813665, loss_d: 0.638805
0.2303 --- loss: 1.277880, loss_ss: 1.099300, loss_d: 0.178580
0.2687 --- loss: 0.915300, loss_ss: 0.689536, loss_d: 0.225764
0.3071 --- loss: 1.107263, loss_ss: 0.915720, loss_d: 0.191543
0.3455 --- loss: 1.624981, loss_ss: 1.192376, loss_d: 0.432605
0.3839 --- loss: 0.788032, loss_ss: 0.725620, loss_d: 0.062412
0.4223 --- loss: 1.272972, loss_ss: 0.719146, loss_d: 0.553826
0.4607 --- loss: 1.137560, loss_ss: 1.022481, loss_d: 0.115079
0.4990 --- loss: 0.760191, loss_ss: 0.645838, loss_d: 0.114353
0.5374 --- loss: 1.509817, loss_ss: 0.586929, loss_d: 0.922888
0.5758 --- loss: 1.494136, loss_ss: 1.334956, loss_d: 0.159181
0.6142 --- loss: 1.524981, loss_ss: 0.599764, loss_d: 0.925217
0.6526 --- loss: 0.762288, loss_ss: 0.582527, loss_d: 0.179761
0.6910 --- loss: 1.235124, loss_ss: 0.764940, loss_d: 0.470184
0.7294 --- loss: 1.627704, loss_ss: 0.808166, loss_d: 0.819538
0.7678 --- loss: 1.128216, loss_ss: 0.880345, loss_d: 0.247870
0.8061 --- loss: 1.304950, loss_ss: 0.989458, loss_d: 0.315492
0.8445 --- loss: 1.136280, loss_ss: 0.944927, loss_d: 0.191352
0.8829 --- loss: 1.196883, loss_ss: 0.965302, loss_d: 0.231581
0.9213 --- loss: 1.189125, loss_ss: 1.054579, loss_d: 0.134546
0.9597 --- loss: 1.314521, loss_ss: 0.983369, loss_d: 0.331152
0.9981 --- loss: 1.138370, loss_ss: 0.961188, loss_d: 0.177181
Epoch finished! Loss: 1.144877315713809
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5959595959595959
             precision    recall  f1-score   support

        0.0       0.70      0.27      0.39       219
        1.0       0.20      0.09      0.13       143
        2.0       0.44      0.91      0.60       221
        3.0       0.96      0.85      0.90       271
        4.0       0.58      0.64      0.61       136

avg / total       0.63      0.60      0.57       990
 


====== chp011-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  81.31  26.94   96.76  70.24     38.94
1  81.72   9.09   93.98  20.31     12.56
2  72.53  90.95   67.23  44.37     59.64
3  94.85  84.87   98.61  95.83     90.02
4  88.79  63.97   92.74  58.39     61.05
Total accuracy: 59.60%
Average sen: 55.16%
Average spec: 89.86%
Macro f1-score: 52.44%
Diagnosis acc on 15mins: 0.8484848484848485
[0.6465652  0.71241838 0.56171608 0.95464665 0.83948308 0.81440449
 0.99710196 0.99353665 0.99739623 0.60588175 0.99999595 0.98664784
 0.92292041 0.9277218  0.76225346 0.98808926 0.97004086 0.99932444
 0.9942683  0.22652273 0.98790562 0.68160331 0.19696495 0.6260199
 0.97435343 0.99187624 0.87108529 0.84407294 0.96134114 0.98752928
 0.2630018  0.13860941 0.26546431]
pred: 0.7785079736601223, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp012-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.330100, loss_ss: 1.605105, loss_d: 0.724995
0.0384 --- loss: 2.191118, loss_ss: 1.495024, loss_d: 0.696094
0.0769 --- loss: 2.041203, loss_ss: 1.475832, loss_d: 0.565371
0.1153 --- loss: 2.291879, loss_ss: 1.600576, loss_d: 0.691303
0.1538 --- loss: 2.066860, loss_ss: 1.422870, loss_d: 0.643989
0.1922 --- loss: 2.080782, loss_ss: 1.478456, loss_d: 0.602326
0.2307 --- loss: 2.050077, loss_ss: 1.428193, loss_d: 0.621884
0.2691 --- loss: 2.082286, loss_ss: 1.391311, loss_d: 0.690974
0.3076 --- loss: 1.857105, loss_ss: 1.352837, loss_d: 0.504268
0.3460 --- loss: 1.959339, loss_ss: 1.330805, loss_d: 0.628533
0.3845 --- loss: 1.805970, loss_ss: 1.402163, loss_d: 0.403807
0.4229 --- loss: 1.667395, loss_ss: 1.312433, loss_d: 0.354962
0.4614 --- loss: 2.017722, loss_ss: 1.363987, loss_d: 0.653735
0.4998 --- loss: 1.942421, loss_ss: 1.341522, loss_d: 0.600900
0.5383 --- loss: 2.129965, loss_ss: 1.272640, loss_d: 0.857326
0.5767 --- loss: 2.151594, loss_ss: 1.404135, loss_d: 0.747459
0.6151 --- loss: 1.887460, loss_ss: 1.273652, loss_d: 0.613809
0.6536 --- loss: 1.810922, loss_ss: 1.286013, loss_d: 0.524909
0.6920 --- loss: 2.102440, loss_ss: 1.359633, loss_d: 0.742808
0.7305 --- loss: 1.767459, loss_ss: 1.148461, loss_d: 0.618998
0.7689 --- loss: 1.750990, loss_ss: 1.067811, loss_d: 0.683179
0.8074 --- loss: 1.835046, loss_ss: 1.136195, loss_d: 0.698851
0.8458 --- loss: 1.733025, loss_ss: 1.221802, loss_d: 0.511223
0.8843 --- loss: 1.886165, loss_ss: 1.084797, loss_d: 0.801367
0.9227 --- loss: 1.497484, loss_ss: 1.036971, loss_d: 0.460513
0.9612 --- loss: 1.731894, loss_ss: 1.141882, loss_d: 0.590012
0.9996 --- loss: 2.646459, loss_ss: 1.203603, loss_d: 1.442857
Epoch finished! Loss: 1.9432312960808094
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.604928, loss_ss: 1.186547, loss_d: 0.418382
0.0384 --- loss: 1.775883, loss_ss: 1.174316, loss_d: 0.601567
0.0769 --- loss: 1.742785, loss_ss: 1.015851, loss_d: 0.726934
0.1153 --- loss: 1.704126, loss_ss: 1.193723, loss_d: 0.510402
0.1538 --- loss: 2.023029, loss_ss: 1.420775, loss_d: 0.602254
0.1922 --- loss: 1.651602, loss_ss: 1.142921, loss_d: 0.508681
0.2307 --- loss: 1.896957, loss_ss: 1.251510, loss_d: 0.645447
0.2691 --- loss: 1.702291, loss_ss: 1.249563, loss_d: 0.452728
0.3076 --- loss: 1.562523, loss_ss: 1.089270, loss_d: 0.473252
0.3460 --- loss: 1.862374, loss_ss: 1.192901, loss_d: 0.669472
0.3845 --- loss: 1.742746, loss_ss: 0.911886, loss_d: 0.830861
0.4229 --- loss: 1.295273, loss_ss: 0.868125, loss_d: 0.427148
0.4614 --- loss: 1.613133, loss_ss: 1.024600, loss_d: 0.588534
0.4998 --- loss: 2.039949, loss_ss: 1.234957, loss_d: 0.804993
0.5383 --- loss: 1.600434, loss_ss: 1.225044, loss_d: 0.375390
0.5767 --- loss: 1.443685, loss_ss: 1.155666, loss_d: 0.288020
0.6151 --- loss: 1.597089, loss_ss: 1.175100, loss_d: 0.421989
0.6536 --- loss: 1.733443, loss_ss: 1.076709, loss_d: 0.656734
0.6920 --- loss: 2.079733, loss_ss: 1.140529, loss_d: 0.939204
0.7305 --- loss: 1.364157, loss_ss: 0.855731, loss_d: 0.508426
0.7689 --- loss: 1.759604, loss_ss: 0.856696, loss_d: 0.902907
0.8074 --- loss: 1.690318, loss_ss: 1.164456, loss_d: 0.525862
0.8458 --- loss: 1.579321, loss_ss: 1.062706, loss_d: 0.516615
0.8843 --- loss: 1.542731, loss_ss: 1.195594, loss_d: 0.347137
0.9227 --- loss: 1.533848, loss_ss: 1.022111, loss_d: 0.511737
0.9612 --- loss: 1.781863, loss_ss: 0.944459, loss_d: 0.837404
0.9996 --- loss: 1.591393, loss_ss: 1.200103, loss_d: 0.391290
Epoch finished! Loss: 1.66962284216514
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.609893, loss_ss: 0.967670, loss_d: 0.642223
0.0384 --- loss: 1.971093, loss_ss: 1.164600, loss_d: 0.806493
0.0769 --- loss: 1.426633, loss_ss: 0.841968, loss_d: 0.584665
0.1153 --- loss: 1.689611, loss_ss: 0.707554, loss_d: 0.982056
0.1538 --- loss: 1.596108, loss_ss: 1.068922, loss_d: 0.527186
0.1922 --- loss: 1.365210, loss_ss: 0.940342, loss_d: 0.424868
0.2307 --- loss: 1.976418, loss_ss: 0.926039, loss_d: 1.050380
0.2691 --- loss: 1.740079, loss_ss: 1.176250, loss_d: 0.563830
0.3076 --- loss: 1.361993, loss_ss: 0.794901, loss_d: 0.567092
0.3460 --- loss: 1.528660, loss_ss: 0.959966, loss_d: 0.568694
0.3845 --- loss: 1.565294, loss_ss: 1.074703, loss_d: 0.490591
0.4229 --- loss: 1.547038, loss_ss: 0.955296, loss_d: 0.591741
0.4614 --- loss: 1.439566, loss_ss: 1.016047, loss_d: 0.423519
0.4998 --- loss: 1.356543, loss_ss: 0.682975, loss_d: 0.673568
0.5383 --- loss: 2.182433, loss_ss: 1.475525, loss_d: 0.706908
0.5767 --- loss: 1.640611, loss_ss: 1.160105, loss_d: 0.480506
0.6151 --- loss: 1.864259, loss_ss: 0.907407, loss_d: 0.956852
0.6536 --- loss: 1.354735, loss_ss: 0.989936, loss_d: 0.364799
0.6920 --- loss: 1.605814, loss_ss: 1.141657, loss_d: 0.464157
0.7305 --- loss: 1.572687, loss_ss: 1.116633, loss_d: 0.456054
0.7689 --- loss: 1.492916, loss_ss: 0.791707, loss_d: 0.701209
0.8074 --- loss: 1.373094, loss_ss: 1.060145, loss_d: 0.312949
0.8458 --- loss: 1.343450, loss_ss: 0.687712, loss_d: 0.655738
0.8843 --- loss: 1.275041, loss_ss: 0.765924, loss_d: 0.509117
0.9227 --- loss: 1.597883, loss_ss: 1.157019, loss_d: 0.440865
0.9612 --- loss: 1.674198, loss_ss: 1.120277, loss_d: 0.553921
0.9996 --- loss: 1.552137, loss_ss: 1.346183, loss_d: 0.205953
Epoch finished! Loss: 1.550183168741373
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.656506, loss_ss: 1.029015, loss_d: 0.627491
0.0384 --- loss: 1.332610, loss_ss: 0.842075, loss_d: 0.490535
0.0769 --- loss: 1.550814, loss_ss: 1.008972, loss_d: 0.541842
0.1153 --- loss: 1.193413, loss_ss: 0.787617, loss_d: 0.405796
0.1538 --- loss: 1.345249, loss_ss: 0.895293, loss_d: 0.449956
0.1922 --- loss: 1.569236, loss_ss: 1.194537, loss_d: 0.374700
0.2307 --- loss: 1.346399, loss_ss: 0.705742, loss_d: 0.640658
0.2691 --- loss: 1.440764, loss_ss: 0.806415, loss_d: 0.634350
0.3076 --- loss: 1.657454, loss_ss: 0.977935, loss_d: 0.679520
0.3460 --- loss: 1.625578, loss_ss: 1.225060, loss_d: 0.400518
0.3845 --- loss: 1.929808, loss_ss: 1.089974, loss_d: 0.839833
0.4229 --- loss: 1.217616, loss_ss: 0.751640, loss_d: 0.465976
0.4614 --- loss: 1.258653, loss_ss: 0.770595, loss_d: 0.488058
0.4998 --- loss: 1.283851, loss_ss: 0.779163, loss_d: 0.504688
0.5383 --- loss: 1.199821, loss_ss: 0.930657, loss_d: 0.269164
0.5767 --- loss: 1.327964, loss_ss: 0.801206, loss_d: 0.526758
0.6151 --- loss: 1.314075, loss_ss: 0.964002, loss_d: 0.350072
0.6536 --- loss: 1.329797, loss_ss: 1.057613, loss_d: 0.272184
0.6920 --- loss: 1.517760, loss_ss: 1.145620, loss_d: 0.372139
0.7305 --- loss: 1.963369, loss_ss: 1.095002, loss_d: 0.868367
0.7689 --- loss: 1.161149, loss_ss: 0.895696, loss_d: 0.265453
0.8074 --- loss: 1.387986, loss_ss: 0.958461, loss_d: 0.429525
0.8458 --- loss: 1.094825, loss_ss: 0.821408, loss_d: 0.273417
0.8843 --- loss: 1.282778, loss_ss: 0.777481, loss_d: 0.505298
0.9227 --- loss: 1.248962, loss_ss: 0.814614, loss_d: 0.434348
0.9612 --- loss: 1.051224, loss_ss: 0.825653, loss_d: 0.225571
0.9996 --- loss: 1.500561, loss_ss: 1.354572, loss_d: 0.145989
Epoch finished! Loss: 1.4374382115327395
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.605648, loss_ss: 1.395820, loss_d: 0.209828
0.0384 --- loss: 1.422855, loss_ss: 1.053910, loss_d: 0.368945
0.0769 --- loss: 0.884676, loss_ss: 0.697737, loss_d: 0.186939
0.1153 --- loss: 1.755395, loss_ss: 1.178949, loss_d: 0.576445
0.1538 --- loss: 1.321795, loss_ss: 1.029032, loss_d: 0.292763
0.1922 --- loss: 0.934165, loss_ss: 0.655404, loss_d: 0.278761
0.2307 --- loss: 1.563536, loss_ss: 1.181734, loss_d: 0.381802
0.2691 --- loss: 1.410976, loss_ss: 1.113543, loss_d: 0.297433
0.3076 --- loss: 1.114590, loss_ss: 0.834841, loss_d: 0.279749
0.3460 --- loss: 1.734882, loss_ss: 1.326459, loss_d: 0.408424
0.3845 --- loss: 1.023536, loss_ss: 0.670856, loss_d: 0.352681
0.4229 --- loss: 1.915214, loss_ss: 1.142708, loss_d: 0.772506
0.4614 --- loss: 0.892293, loss_ss: 0.754973, loss_d: 0.137321
0.4998 --- loss: 1.379632, loss_ss: 1.020318, loss_d: 0.359314
0.5383 --- loss: 1.557727, loss_ss: 0.907616, loss_d: 0.650111
0.5767 --- loss: 1.539432, loss_ss: 0.907531, loss_d: 0.631900
0.6151 --- loss: 1.064360, loss_ss: 0.788827, loss_d: 0.275533
0.6536 --- loss: 1.500682, loss_ss: 1.032679, loss_d: 0.468003
0.6920 --- loss: 1.478441, loss_ss: 0.795938, loss_d: 0.682502
0.7305 --- loss: 1.307254, loss_ss: 0.820875, loss_d: 0.486379
0.7689 --- loss: 1.596413, loss_ss: 0.665213, loss_d: 0.931200
0.8074 --- loss: 1.469011, loss_ss: 0.982308, loss_d: 0.486703
0.8458 --- loss: 1.545933, loss_ss: 1.117078, loss_d: 0.428855
0.8843 --- loss: 1.126367, loss_ss: 0.661070, loss_d: 0.465297
0.9227 --- loss: 1.049904, loss_ss: 0.669748, loss_d: 0.380156
0.9612 --- loss: 1.643977, loss_ss: 1.299241, loss_d: 0.344736
0.9996 --- loss: 1.393230, loss_ss: 1.285462, loss_d: 0.107768
Epoch finished! Loss: 1.3246678327138608
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.220894, loss_ss: 0.779344, loss_d: 0.441549
0.0384 --- loss: 0.950790, loss_ss: 0.770484, loss_d: 0.180306
0.0769 --- loss: 1.160893, loss_ss: 0.892612, loss_d: 0.268282
0.1153 --- loss: 1.292048, loss_ss: 0.883974, loss_d: 0.408074
0.1538 --- loss: 1.154610, loss_ss: 0.820718, loss_d: 0.333892
0.1922 --- loss: 1.269751, loss_ss: 1.116571, loss_d: 0.153180
0.2307 --- loss: 1.577472, loss_ss: 0.846255, loss_d: 0.731218
0.2691 --- loss: 1.375418, loss_ss: 0.848159, loss_d: 0.527260
0.3076 --- loss: 1.251348, loss_ss: 1.103278, loss_d: 0.148070
0.3460 --- loss: 0.934713, loss_ss: 0.777176, loss_d: 0.157537
0.3845 --- loss: 1.350801, loss_ss: 1.033635, loss_d: 0.317167
0.4229 --- loss: 0.833507, loss_ss: 0.730134, loss_d: 0.103373
0.4614 --- loss: 1.210876, loss_ss: 0.949705, loss_d: 0.261171
0.4998 --- loss: 1.214571, loss_ss: 0.799902, loss_d: 0.414669
0.5383 --- loss: 0.939549, loss_ss: 0.658041, loss_d: 0.281508
0.5767 --- loss: 1.142342, loss_ss: 0.900397, loss_d: 0.241945
0.6151 --- loss: 1.048621, loss_ss: 0.864425, loss_d: 0.184197
0.6536 --- loss: 1.271666, loss_ss: 0.743375, loss_d: 0.528291
0.6920 --- loss: 1.207436, loss_ss: 0.900317, loss_d: 0.307119
0.7305 --- loss: 1.228090, loss_ss: 1.055572, loss_d: 0.172517
0.7689 --- loss: 0.813540, loss_ss: 0.619297, loss_d: 0.194243
0.8074 --- loss: 0.801890, loss_ss: 0.638081, loss_d: 0.163809
0.8458 --- loss: 0.828909, loss_ss: 0.658543, loss_d: 0.170366
0.8843 --- loss: 1.114728, loss_ss: 0.900220, loss_d: 0.214508
0.9227 --- loss: 1.736356, loss_ss: 1.407170, loss_d: 0.329186
0.9612 --- loss: 0.867127, loss_ss: 0.671643, loss_d: 0.195484
0.9996 --- loss: 5.356955, loss_ss: 3.064122, loss_d: 2.292832
Epoch finished! Loss: 1.2648480158585769
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.035551, loss_ss: 0.908451, loss_d: 0.127100
0.0384 --- loss: 1.086740, loss_ss: 0.948006, loss_d: 0.138734
0.0769 --- loss: 1.089130, loss_ss: 0.891783, loss_d: 0.197347
0.1153 --- loss: 1.217637, loss_ss: 0.899858, loss_d: 0.317779
0.1538 --- loss: 1.091153, loss_ss: 0.849993, loss_d: 0.241160
0.1922 --- loss: 1.872397, loss_ss: 1.500636, loss_d: 0.371761
0.2307 --- loss: 1.219967, loss_ss: 0.845163, loss_d: 0.374804
0.2691 --- loss: 0.935261, loss_ss: 0.803112, loss_d: 0.132149
0.3076 --- loss: 0.953367, loss_ss: 0.619371, loss_d: 0.333996
0.3460 --- loss: 0.818946, loss_ss: 0.602796, loss_d: 0.216151
0.3845 --- loss: 1.156612, loss_ss: 0.919077, loss_d: 0.237536
0.4229 --- loss: 1.013192, loss_ss: 0.830134, loss_d: 0.183058
0.4614 --- loss: 0.980373, loss_ss: 0.776930, loss_d: 0.203444
0.4998 --- loss: 1.030966, loss_ss: 0.839677, loss_d: 0.191289
0.5383 --- loss: 1.111312, loss_ss: 0.865714, loss_d: 0.245598
0.5767 --- loss: 1.249992, loss_ss: 0.919886, loss_d: 0.330105
0.6151 --- loss: 1.073341, loss_ss: 0.971047, loss_d: 0.102294
0.6536 --- loss: 1.612743, loss_ss: 1.270953, loss_d: 0.341791
0.6920 --- loss: 1.025426, loss_ss: 0.902955, loss_d: 0.122471
0.7305 --- loss: 1.023672, loss_ss: 0.624096, loss_d: 0.399576
0.7689 --- loss: 1.561848, loss_ss: 1.175481, loss_d: 0.386367
0.8074 --- loss: 1.122379, loss_ss: 0.842369, loss_d: 0.280010
0.8458 --- loss: 1.267728, loss_ss: 0.907826, loss_d: 0.359902
0.8843 --- loss: 1.200217, loss_ss: 1.015100, loss_d: 0.185116
0.9227 --- loss: 0.877362, loss_ss: 0.673027, loss_d: 0.204335
0.9612 --- loss: 1.009601, loss_ss: 0.866084, loss_d: 0.143517
0.9996 --- loss: 2.093445, loss_ss: 2.022421, loss_d: 0.071024
Epoch finished! Loss: 1.1872591924208862
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.210341, loss_ss: 0.922177, loss_d: 0.288164
0.0384 --- loss: 1.211107, loss_ss: 1.033628, loss_d: 0.177480
0.0769 --- loss: 1.313743, loss_ss: 0.960470, loss_d: 0.353272
0.1153 --- loss: 1.085023, loss_ss: 0.980958, loss_d: 0.104065
0.1538 --- loss: 1.105084, loss_ss: 0.902750, loss_d: 0.202334
0.1922 --- loss: 1.340088, loss_ss: 0.891812, loss_d: 0.448275
0.2307 --- loss: 1.043437, loss_ss: 0.792827, loss_d: 0.250610
0.2691 --- loss: 1.340813, loss_ss: 0.847580, loss_d: 0.493233
0.3076 --- loss: 0.992667, loss_ss: 0.856979, loss_d: 0.135688
0.3460 --- loss: 2.001839, loss_ss: 0.908570, loss_d: 1.093269
0.3845 --- loss: 0.828655, loss_ss: 0.737219, loss_d: 0.091436
0.4229 --- loss: 1.381451, loss_ss: 0.918406, loss_d: 0.463045
0.4614 --- loss: 1.255628, loss_ss: 1.081117, loss_d: 0.174511
0.4998 --- loss: 1.351825, loss_ss: 0.982025, loss_d: 0.369801
0.5383 --- loss: 0.839685, loss_ss: 0.674989, loss_d: 0.164696
0.5767 --- loss: 1.114044, loss_ss: 0.855243, loss_d: 0.258802
0.6151 --- loss: 1.946365, loss_ss: 0.739013, loss_d: 1.207352
0.6536 --- loss: 1.032243, loss_ss: 0.692431, loss_d: 0.339812
0.6920 --- loss: 1.620733, loss_ss: 0.772422, loss_d: 0.848311
0.7305 --- loss: 1.033055, loss_ss: 0.587443, loss_d: 0.445611
0.7689 --- loss: 1.113038, loss_ss: 0.935708, loss_d: 0.177330
0.8074 --- loss: 1.222497, loss_ss: 0.899268, loss_d: 0.323229
0.8458 --- loss: 1.043433, loss_ss: 0.802446, loss_d: 0.240987
0.8843 --- loss: 0.925509, loss_ss: 0.768366, loss_d: 0.157143
0.9227 --- loss: 1.102571, loss_ss: 0.795886, loss_d: 0.306685
0.9612 --- loss: 1.112763, loss_ss: 0.895967, loss_d: 0.216796
0.9996 --- loss: 2.651043, loss_ss: 2.581804, loss_d: 0.069240
Epoch finished! Loss: 1.1459028163781533
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.841723, loss_ss: 0.707208, loss_d: 0.134515
0.0384 --- loss: 1.120592, loss_ss: 0.911554, loss_d: 0.209039
0.0769 --- loss: 1.209831, loss_ss: 1.005979, loss_d: 0.203853
0.1153 --- loss: 1.076986, loss_ss: 0.939349, loss_d: 0.137637
0.1538 --- loss: 1.020874, loss_ss: 0.902644, loss_d: 0.118230
0.1922 --- loss: 1.086572, loss_ss: 0.777217, loss_d: 0.309355
0.2307 --- loss: 0.821891, loss_ss: 0.588435, loss_d: 0.233456
0.2691 --- loss: 1.039799, loss_ss: 0.797875, loss_d: 0.241924
0.3076 --- loss: 1.169187, loss_ss: 1.085003, loss_d: 0.084184
0.3460 --- loss: 1.030500, loss_ss: 0.782629, loss_d: 0.247872
0.3845 --- loss: 0.768281, loss_ss: 0.627512, loss_d: 0.140769
0.4229 --- loss: 1.119447, loss_ss: 0.799856, loss_d: 0.319591
0.4614 --- loss: 1.044162, loss_ss: 0.832930, loss_d: 0.211232
0.4998 --- loss: 1.020106, loss_ss: 0.583356, loss_d: 0.436749
0.5383 --- loss: 1.009676, loss_ss: 0.853564, loss_d: 0.156112
0.5767 --- loss: 0.996459, loss_ss: 0.821737, loss_d: 0.174722
0.6151 --- loss: 1.474833, loss_ss: 1.202201, loss_d: 0.272633
0.6536 --- loss: 0.955171, loss_ss: 0.658271, loss_d: 0.296900
0.6920 --- loss: 1.229099, loss_ss: 1.055320, loss_d: 0.173779
0.7305 --- loss: 0.806295, loss_ss: 0.704623, loss_d: 0.101672
0.7689 --- loss: 0.774304, loss_ss: 0.639126, loss_d: 0.135179
0.8074 --- loss: 1.050363, loss_ss: 0.967854, loss_d: 0.082509
0.8458 --- loss: 0.926815, loss_ss: 0.849054, loss_d: 0.077761
0.8843 --- loss: 1.198184, loss_ss: 0.957130, loss_d: 0.241055
0.9227 --- loss: 0.853310, loss_ss: 0.660663, loss_d: 0.192648
0.9612 --- loss: 0.864606, loss_ss: 0.625833, loss_d: 0.238772
0.9996 --- loss: 1.038889, loss_ss: 1.000679, loss_d: 0.038210
Epoch finished! Loss: 1.1282677760491004
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 2.044119, loss_ss: 0.780483, loss_d: 1.263637
0.0384 --- loss: 1.426409, loss_ss: 0.958370, loss_d: 0.468039
0.0769 --- loss: 0.916192, loss_ss: 0.781013, loss_d: 0.135179
0.1153 --- loss: 1.028634, loss_ss: 0.901872, loss_d: 0.126762
0.1538 --- loss: 0.972802, loss_ss: 0.792158, loss_d: 0.180644
0.1922 --- loss: 1.375285, loss_ss: 0.858404, loss_d: 0.516882
0.2307 --- loss: 0.981255, loss_ss: 0.877554, loss_d: 0.103701
0.2691 --- loss: 1.407934, loss_ss: 1.022295, loss_d: 0.385638
0.3076 --- loss: 1.204390, loss_ss: 1.081630, loss_d: 0.122760
0.3460 --- loss: 0.837301, loss_ss: 0.722124, loss_d: 0.115177
0.3845 --- loss: 0.907467, loss_ss: 0.689471, loss_d: 0.217996
0.4229 --- loss: 1.089944, loss_ss: 0.911615, loss_d: 0.178329
0.4614 --- loss: 1.119523, loss_ss: 0.845606, loss_d: 0.273917
0.4998 --- loss: 0.808458, loss_ss: 0.639459, loss_d: 0.168999
0.5383 --- loss: 0.817271, loss_ss: 0.717590, loss_d: 0.099681
0.5767 --- loss: 0.925386, loss_ss: 0.789615, loss_d: 0.135770
0.6151 --- loss: 1.300222, loss_ss: 0.916244, loss_d: 0.383977
0.6536 --- loss: 1.018064, loss_ss: 0.872961, loss_d: 0.145103
0.6920 --- loss: 1.156089, loss_ss: 0.502349, loss_d: 0.653740
0.7305 --- loss: 1.173236, loss_ss: 0.785573, loss_d: 0.387663
0.7689 --- loss: 1.049156, loss_ss: 0.878843, loss_d: 0.170313
0.8074 --- loss: 0.706629, loss_ss: 0.495833, loss_d: 0.210796
0.8458 --- loss: 0.891249, loss_ss: 0.725492, loss_d: 0.165757
0.8843 --- loss: 1.038362, loss_ss: 0.857383, loss_d: 0.180979
0.9227 --- loss: 0.902353, loss_ss: 0.766128, loss_d: 0.136225
0.9612 --- loss: 1.001006, loss_ss: 0.721964, loss_d: 0.279041
0.9996 --- loss: 1.488527, loss_ss: 1.451424, loss_d: 0.037103
Epoch finished! Loss: 1.1102135484035198
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7036036036036036
             precision    recall  f1-score   support

        0.0       0.17      0.35      0.23        23
        1.0       0.28      0.21      0.24       182
        2.0       0.73      0.73      0.73       379
        3.0       0.93      0.98      0.95       203
        4.0       0.77      0.80      0.79       323

avg / total       0.69      0.70      0.70      1110
 


====== chp012-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.23  34.78   96.50  17.39     23.19
1  78.29  21.43   89.44  28.47     24.45
2  81.53  73.09   85.91  72.89     72.99
3  98.29  97.54   98.46  93.40     95.42
4  87.39  80.19   90.34  77.31     78.72
Total accuracy: 70.36%
Average sen: 61.40%
Average spec: 92.13%
Macro f1-score: 58.96%
Diagnosis acc on 15mins: 0.7297297297297297
[0.96718085 0.23347399 0.10149611 0.28558996 0.42277014 0.48511827
 0.90333498 0.21412429 0.691733   0.49952313 0.73211437 0.9537797
 0.9116118  0.98747909 0.9566735  0.96749741 0.97942871 0.25641581
 0.42083129 0.86368436 0.96900392 0.94813186 0.99186409 0.99384612
 0.26014876 0.9822129  0.88019162 0.9139334  0.96826297 0.7148056
 0.93720251 0.97334236 0.99831033 0.96123087 0.92472422 0.92778099
 0.84835714]
pred: 0.7574921735637897, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp013-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.315024, loss_ss: 1.616320, loss_d: 0.698705
0.0384 --- loss: 2.206833, loss_ss: 1.620552, loss_d: 0.586281
0.0768 --- loss: 2.032917, loss_ss: 1.485522, loss_d: 0.547395
0.1152 --- loss: 2.241173, loss_ss: 1.569307, loss_d: 0.671867
0.1536 --- loss: 1.953006, loss_ss: 1.335312, loss_d: 0.617695
0.1919 --- loss: 2.209965, loss_ss: 1.529328, loss_d: 0.680637
0.2303 --- loss: 1.927524, loss_ss: 1.407305, loss_d: 0.520220
0.2687 --- loss: 1.925085, loss_ss: 1.464352, loss_d: 0.460734
0.3071 --- loss: 2.368964, loss_ss: 1.437408, loss_d: 0.931555
0.3455 --- loss: 2.164270, loss_ss: 1.317664, loss_d: 0.846606
0.3839 --- loss: 2.158092, loss_ss: 1.508522, loss_d: 0.649571
0.4223 --- loss: 1.920508, loss_ss: 1.283136, loss_d: 0.637372
0.4607 --- loss: 1.951689, loss_ss: 1.374234, loss_d: 0.577455
0.4990 --- loss: 1.713564, loss_ss: 1.218869, loss_d: 0.494695
0.5374 --- loss: 1.861109, loss_ss: 1.128190, loss_d: 0.732920
0.5758 --- loss: 1.660305, loss_ss: 1.233178, loss_d: 0.427127
0.6142 --- loss: 1.796297, loss_ss: 1.224520, loss_d: 0.571778
0.6526 --- loss: 1.926737, loss_ss: 1.341604, loss_d: 0.585132
0.6910 --- loss: 1.924822, loss_ss: 1.380139, loss_d: 0.544683
0.7294 --- loss: 1.797266, loss_ss: 1.482093, loss_d: 0.315173
0.7678 --- loss: 1.865056, loss_ss: 1.154695, loss_d: 0.710361
0.8061 --- loss: 1.850917, loss_ss: 1.188367, loss_d: 0.662550
0.8445 --- loss: 1.826472, loss_ss: 1.158047, loss_d: 0.668425
0.8829 --- loss: 1.634224, loss_ss: 1.071011, loss_d: 0.563213
0.9213 --- loss: 1.556549, loss_ss: 0.995531, loss_d: 0.561018
0.9597 --- loss: 1.825892, loss_ss: 1.147753, loss_d: 0.678139
0.9981 --- loss: 1.512226, loss_ss: 1.115245, loss_d: 0.396981
Epoch finished! Loss: 1.943124011846689
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.656127, loss_ss: 1.030140, loss_d: 0.625987
0.0384 --- loss: 2.221104, loss_ss: 1.230271, loss_d: 0.990833
0.0768 --- loss: 1.854423, loss_ss: 0.995729, loss_d: 0.858694
0.1152 --- loss: 1.553062, loss_ss: 0.983393, loss_d: 0.569669
0.1536 --- loss: 1.590438, loss_ss: 1.073763, loss_d: 0.516675
0.1919 --- loss: 1.573161, loss_ss: 1.082311, loss_d: 0.490850
0.2303 --- loss: 2.092314, loss_ss: 1.338854, loss_d: 0.753460
0.2687 --- loss: 1.982806, loss_ss: 1.181342, loss_d: 0.801464
0.3071 --- loss: 1.816549, loss_ss: 1.225221, loss_d: 0.591328
0.3455 --- loss: 1.735094, loss_ss: 1.136799, loss_d: 0.598296
0.3839 --- loss: 1.581867, loss_ss: 1.121220, loss_d: 0.460648
0.4223 --- loss: 1.797385, loss_ss: 1.162630, loss_d: 0.634755
0.4607 --- loss: 1.650247, loss_ss: 1.199070, loss_d: 0.451176
0.4990 --- loss: 1.880667, loss_ss: 1.367984, loss_d: 0.512682
0.5374 --- loss: 1.568707, loss_ss: 1.111852, loss_d: 0.456855
0.5758 --- loss: 1.642672, loss_ss: 1.236204, loss_d: 0.406468
0.6142 --- loss: 1.430797, loss_ss: 0.943460, loss_d: 0.487337
0.6526 --- loss: 1.624705, loss_ss: 1.235319, loss_d: 0.389386
0.6910 --- loss: 1.524692, loss_ss: 1.048236, loss_d: 0.476456
0.7294 --- loss: 1.467256, loss_ss: 0.959296, loss_d: 0.507960
0.7678 --- loss: 1.754489, loss_ss: 1.317909, loss_d: 0.436579
0.8061 --- loss: 1.397684, loss_ss: 0.994771, loss_d: 0.402913
0.8445 --- loss: 1.410822, loss_ss: 0.822065, loss_d: 0.588757
0.8829 --- loss: 1.332902, loss_ss: 0.842492, loss_d: 0.490410
0.9213 --- loss: 1.641917, loss_ss: 1.155806, loss_d: 0.486111
0.9597 --- loss: 1.270987, loss_ss: 0.839707, loss_d: 0.431280
0.9981 --- loss: 1.695460, loss_ss: 1.231024, loss_d: 0.464436
Epoch finished! Loss: 1.6574803329431094
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.405709, loss_ss: 1.098972, loss_d: 0.306737
0.0384 --- loss: 1.401917, loss_ss: 1.005615, loss_d: 0.396302
0.0768 --- loss: 1.860555, loss_ss: 0.986377, loss_d: 0.874178
0.1152 --- loss: 1.358702, loss_ss: 1.017809, loss_d: 0.340894
0.1536 --- loss: 1.237972, loss_ss: 0.801560, loss_d: 0.436412
0.1919 --- loss: 1.591126, loss_ss: 1.062706, loss_d: 0.528420
0.2303 --- loss: 1.732647, loss_ss: 1.132022, loss_d: 0.600625
0.2687 --- loss: 1.339622, loss_ss: 0.964292, loss_d: 0.375330
0.3071 --- loss: 1.566996, loss_ss: 0.856017, loss_d: 0.710979
0.3455 --- loss: 1.211094, loss_ss: 0.908955, loss_d: 0.302139
0.3839 --- loss: 1.546603, loss_ss: 0.891355, loss_d: 0.655247
0.4223 --- loss: 1.896544, loss_ss: 1.392907, loss_d: 0.503637
0.4607 --- loss: 1.569304, loss_ss: 0.968139, loss_d: 0.601166
0.4990 --- loss: 1.723249, loss_ss: 0.862427, loss_d: 0.860821
0.5374 --- loss: 1.364356, loss_ss: 0.783177, loss_d: 0.581179
0.5758 --- loss: 1.371267, loss_ss: 1.063453, loss_d: 0.307815
0.6142 --- loss: 1.815693, loss_ss: 1.144501, loss_d: 0.671192
0.6526 --- loss: 1.998429, loss_ss: 1.068693, loss_d: 0.929737
0.6910 --- loss: 1.787257, loss_ss: 1.459180, loss_d: 0.328077
0.7294 --- loss: 1.304574, loss_ss: 1.007563, loss_d: 0.297012
0.7678 --- loss: 1.500731, loss_ss: 1.046501, loss_d: 0.454229
0.8061 --- loss: 1.457735, loss_ss: 1.084865, loss_d: 0.372869
0.8445 --- loss: 1.416337, loss_ss: 1.037823, loss_d: 0.378514
0.8829 --- loss: 1.739203, loss_ss: 1.335763, loss_d: 0.403440
0.9213 --- loss: 1.423435, loss_ss: 1.001909, loss_d: 0.421526
0.9597 --- loss: 1.391527, loss_ss: 0.954717, loss_d: 0.436811
0.9981 --- loss: 0.933306, loss_ss: 0.810836, loss_d: 0.122470
Epoch finished! Loss: 1.522131203688108
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.278685, loss_ss: 1.096957, loss_d: 0.181727
0.0384 --- loss: 1.636151, loss_ss: 0.919293, loss_d: 0.716858
0.0768 --- loss: 2.033437, loss_ss: 1.244210, loss_d: 0.789227
0.1152 --- loss: 1.434803, loss_ss: 1.112721, loss_d: 0.322082
0.1536 --- loss: 1.487546, loss_ss: 1.008167, loss_d: 0.479379
0.1919 --- loss: 1.915109, loss_ss: 0.940031, loss_d: 0.975078
0.2303 --- loss: 1.902083, loss_ss: 1.442068, loss_d: 0.460015
0.2687 --- loss: 1.654861, loss_ss: 1.197633, loss_d: 0.457228
0.3071 --- loss: 1.100986, loss_ss: 0.958416, loss_d: 0.142570
0.3455 --- loss: 1.556103, loss_ss: 0.920954, loss_d: 0.635149
0.3839 --- loss: 1.596443, loss_ss: 1.130914, loss_d: 0.465529
0.4223 --- loss: 1.307340, loss_ss: 0.865864, loss_d: 0.441476
0.4607 --- loss: 1.451673, loss_ss: 1.201671, loss_d: 0.250002
0.4990 --- loss: 1.162851, loss_ss: 0.897063, loss_d: 0.265788
0.5374 --- loss: 1.165069, loss_ss: 0.920599, loss_d: 0.244471
0.5758 --- loss: 1.307744, loss_ss: 0.849328, loss_d: 0.458415
0.6142 --- loss: 1.699355, loss_ss: 1.289666, loss_d: 0.409689
0.6526 --- loss: 1.757148, loss_ss: 1.049379, loss_d: 0.707769
0.6910 --- loss: 1.286773, loss_ss: 1.078639, loss_d: 0.208134
0.7294 --- loss: 1.186428, loss_ss: 0.979839, loss_d: 0.206589
0.7678 --- loss: 1.323651, loss_ss: 0.907895, loss_d: 0.415755
0.8061 --- loss: 2.049928, loss_ss: 1.128647, loss_d: 0.921281
0.8445 --- loss: 1.661836, loss_ss: 1.261531, loss_d: 0.400305
0.8829 --- loss: 1.372339, loss_ss: 1.000314, loss_d: 0.372026
0.9213 --- loss: 1.329907, loss_ss: 0.767208, loss_d: 0.562699
0.9597 --- loss: 1.391671, loss_ss: 1.091546, loss_d: 0.300124
0.9981 --- loss: 1.630440, loss_ss: 1.116783, loss_d: 0.513657
Epoch finished! Loss: 1.435795576755817
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.620763, loss_ss: 1.061197, loss_d: 0.559567
0.0384 --- loss: 1.463599, loss_ss: 1.073261, loss_d: 0.390338
0.0768 --- loss: 1.161168, loss_ss: 0.793658, loss_d: 0.367510
0.1152 --- loss: 1.420785, loss_ss: 1.083954, loss_d: 0.336831
0.1536 --- loss: 1.234939, loss_ss: 0.895149, loss_d: 0.339790
0.1919 --- loss: 1.092073, loss_ss: 0.846055, loss_d: 0.246018
0.2303 --- loss: 1.494296, loss_ss: 1.091763, loss_d: 0.402533
0.2687 --- loss: 1.883121, loss_ss: 1.025731, loss_d: 0.857390
0.3071 --- loss: 1.314514, loss_ss: 1.163661, loss_d: 0.150853
0.3455 --- loss: 1.174204, loss_ss: 0.856853, loss_d: 0.317351
0.3839 --- loss: 2.461009, loss_ss: 1.353640, loss_d: 1.107369
0.4223 --- loss: 1.414176, loss_ss: 0.873311, loss_d: 0.540865
0.4607 --- loss: 1.473676, loss_ss: 1.072294, loss_d: 0.401382
0.4990 --- loss: 1.331527, loss_ss: 0.955633, loss_d: 0.375894
0.5374 --- loss: 1.323836, loss_ss: 0.778928, loss_d: 0.544908
0.5758 --- loss: 1.548652, loss_ss: 0.977732, loss_d: 0.570920
0.6142 --- loss: 1.238755, loss_ss: 0.627779, loss_d: 0.610976
0.6526 --- loss: 1.162952, loss_ss: 0.938332, loss_d: 0.224621
0.6910 --- loss: 1.516106, loss_ss: 1.153113, loss_d: 0.362993
0.7294 --- loss: 1.424762, loss_ss: 0.913564, loss_d: 0.511199
0.7678 --- loss: 1.409753, loss_ss: 1.080320, loss_d: 0.329432
0.8061 --- loss: 1.526854, loss_ss: 0.833543, loss_d: 0.693311
0.8445 --- loss: 1.384906, loss_ss: 1.124805, loss_d: 0.260102
0.8829 --- loss: 1.166414, loss_ss: 0.878362, loss_d: 0.288051
0.9213 --- loss: 1.079322, loss_ss: 0.800896, loss_d: 0.278426
0.9597 --- loss: 1.207988, loss_ss: 0.905304, loss_d: 0.302684
0.9981 --- loss: 1.187967, loss_ss: 1.052974, loss_d: 0.134993
Epoch finished! Loss: 1.3263557133766322
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.621548, loss_ss: 1.371075, loss_d: 0.250473
0.0384 --- loss: 1.461139, loss_ss: 0.919320, loss_d: 0.541818
0.0768 --- loss: 1.238600, loss_ss: 0.627592, loss_d: 0.611008
0.1152 --- loss: 1.301104, loss_ss: 0.963943, loss_d: 0.337161
0.1536 --- loss: 1.092071, loss_ss: 0.636194, loss_d: 0.455877
0.1919 --- loss: 1.050729, loss_ss: 0.710284, loss_d: 0.340445
0.2303 --- loss: 1.058513, loss_ss: 0.792163, loss_d: 0.266350
0.2687 --- loss: 1.837084, loss_ss: 1.570876, loss_d: 0.266207
0.3071 --- loss: 0.845246, loss_ss: 0.661522, loss_d: 0.183724
0.3455 --- loss: 1.378037, loss_ss: 0.673834, loss_d: 0.704203
0.3839 --- loss: 0.824336, loss_ss: 0.674717, loss_d: 0.149619
0.4223 --- loss: 1.056601, loss_ss: 0.932574, loss_d: 0.124027
0.4607 --- loss: 1.244702, loss_ss: 0.775917, loss_d: 0.468785
0.4990 --- loss: 0.909996, loss_ss: 0.721282, loss_d: 0.188714
0.5374 --- loss: 1.210775, loss_ss: 0.937570, loss_d: 0.273206
0.5758 --- loss: 1.335504, loss_ss: 1.108876, loss_d: 0.226628
0.6142 --- loss: 0.907180, loss_ss: 0.644885, loss_d: 0.262295
0.6526 --- loss: 0.961843, loss_ss: 0.726655, loss_d: 0.235188
0.6910 --- loss: 0.997335, loss_ss: 0.825100, loss_d: 0.172235
0.7294 --- loss: 1.327522, loss_ss: 1.176029, loss_d: 0.151492
0.7678 --- loss: 1.067556, loss_ss: 0.709118, loss_d: 0.358437
0.8061 --- loss: 1.102321, loss_ss: 0.889423, loss_d: 0.212898
0.8445 --- loss: 1.343634, loss_ss: 1.081413, loss_d: 0.262221
0.8829 --- loss: 1.006788, loss_ss: 0.708363, loss_d: 0.298425
0.9213 --- loss: 1.108271, loss_ss: 0.812167, loss_d: 0.296104
0.9597 --- loss: 1.553156, loss_ss: 1.109036, loss_d: 0.444120
0.9981 --- loss: 1.514071, loss_ss: 1.093373, loss_d: 0.420698
Epoch finished! Loss: 1.2594422340393066
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.643941, loss_ss: 0.847332, loss_d: 0.796609
0.0384 --- loss: 0.850451, loss_ss: 0.719065, loss_d: 0.131386
0.0768 --- loss: 1.037391, loss_ss: 0.870368, loss_d: 0.167023
0.1152 --- loss: 0.997620, loss_ss: 0.792446, loss_d: 0.205174
0.1536 --- loss: 0.994074, loss_ss: 0.904152, loss_d: 0.089922
0.1919 --- loss: 1.352602, loss_ss: 0.852498, loss_d: 0.500105
0.2303 --- loss: 0.980052, loss_ss: 0.790438, loss_d: 0.189614
0.2687 --- loss: 1.189916, loss_ss: 1.014044, loss_d: 0.175872
0.3071 --- loss: 0.875852, loss_ss: 0.685555, loss_d: 0.190298
0.3455 --- loss: 1.046097, loss_ss: 0.656060, loss_d: 0.390036
0.3839 --- loss: 1.009924, loss_ss: 0.879904, loss_d: 0.130020
0.4223 --- loss: 1.455339, loss_ss: 1.253006, loss_d: 0.202333
0.4607 --- loss: 1.149112, loss_ss: 1.015897, loss_d: 0.133215
0.4990 --- loss: 1.226921, loss_ss: 1.057963, loss_d: 0.168959
0.5374 --- loss: 1.177766, loss_ss: 0.831416, loss_d: 0.346350
0.5758 --- loss: 1.304058, loss_ss: 0.695695, loss_d: 0.608363
0.6142 --- loss: 1.016273, loss_ss: 0.634778, loss_d: 0.381495
0.6526 --- loss: 1.047837, loss_ss: 0.781196, loss_d: 0.266641
0.6910 --- loss: 1.335584, loss_ss: 1.137672, loss_d: 0.197912
0.7294 --- loss: 1.070757, loss_ss: 0.872958, loss_d: 0.197799
0.7678 --- loss: 1.298318, loss_ss: 0.870553, loss_d: 0.427765
0.8061 --- loss: 1.188484, loss_ss: 0.761982, loss_d: 0.426502
0.8445 --- loss: 1.551900, loss_ss: 1.064948, loss_d: 0.486952
0.8829 --- loss: 1.369468, loss_ss: 0.672614, loss_d: 0.696854
0.9213 --- loss: 1.162518, loss_ss: 0.651163, loss_d: 0.511355
0.9597 --- loss: 0.980402, loss_ss: 0.712566, loss_d: 0.267836
0.9981 --- loss: 1.219202, loss_ss: 0.762802, loss_d: 0.456400
Epoch finished! Loss: 1.2205638681466764
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.040425, loss_ss: 0.870387, loss_d: 0.170038
0.0384 --- loss: 1.265440, loss_ss: 0.880372, loss_d: 0.385068
0.0768 --- loss: 1.581053, loss_ss: 0.897455, loss_d: 0.683598
0.1152 --- loss: 1.103640, loss_ss: 0.771324, loss_d: 0.332316
0.1536 --- loss: 1.193469, loss_ss: 0.954716, loss_d: 0.238753
0.1919 --- loss: 1.373522, loss_ss: 1.023420, loss_d: 0.350102
0.2303 --- loss: 1.117326, loss_ss: 0.953920, loss_d: 0.163406
0.2687 --- loss: 1.600439, loss_ss: 0.929433, loss_d: 0.671006
0.3071 --- loss: 1.815602, loss_ss: 0.952373, loss_d: 0.863229
0.3455 --- loss: 1.166809, loss_ss: 0.925290, loss_d: 0.241519
0.3839 --- loss: 1.543272, loss_ss: 0.907468, loss_d: 0.635805
0.4223 --- loss: 1.769213, loss_ss: 0.700788, loss_d: 1.068425
0.4607 --- loss: 0.962972, loss_ss: 0.861555, loss_d: 0.101417
0.4990 --- loss: 0.974800, loss_ss: 0.815367, loss_d: 0.159433
0.5374 --- loss: 1.281280, loss_ss: 0.955683, loss_d: 0.325597
0.5758 --- loss: 0.923206, loss_ss: 0.705556, loss_d: 0.217650
0.6142 --- loss: 1.088860, loss_ss: 0.777501, loss_d: 0.311359
0.6526 --- loss: 1.484732, loss_ss: 1.200559, loss_d: 0.284173
0.6910 --- loss: 1.082021, loss_ss: 0.760341, loss_d: 0.321680
0.7294 --- loss: 1.093289, loss_ss: 0.934503, loss_d: 0.158786
0.7678 --- loss: 0.954952, loss_ss: 0.807105, loss_d: 0.147847
0.8061 --- loss: 1.023223, loss_ss: 0.749009, loss_d: 0.274214
0.8445 --- loss: 0.943186, loss_ss: 0.790605, loss_d: 0.152582
0.8829 --- loss: 1.430484, loss_ss: 0.984736, loss_d: 0.445749
0.9213 --- loss: 0.790986, loss_ss: 0.607596, loss_d: 0.183390
0.9597 --- loss: 0.956992, loss_ss: 0.825760, loss_d: 0.131232
0.9981 --- loss: 1.810082, loss_ss: 1.148693, loss_d: 0.661389
Epoch finished! Loss: 1.210355110351856
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.266367, loss_ss: 0.787059, loss_d: 0.479309
0.0384 --- loss: 1.043347, loss_ss: 0.673431, loss_d: 0.369916
0.0768 --- loss: 1.083407, loss_ss: 0.951677, loss_d: 0.131730
0.1152 --- loss: 1.092696, loss_ss: 0.803839, loss_d: 0.288857
0.1536 --- loss: 1.113517, loss_ss: 0.796317, loss_d: 0.317201
0.1919 --- loss: 1.156629, loss_ss: 0.894382, loss_d: 0.262247
0.2303 --- loss: 1.180850, loss_ss: 0.883609, loss_d: 0.297240
0.2687 --- loss: 1.235394, loss_ss: 1.073542, loss_d: 0.161852
0.3071 --- loss: 1.253636, loss_ss: 0.904012, loss_d: 0.349624
0.3455 --- loss: 1.467763, loss_ss: 1.046568, loss_d: 0.421195
0.3839 --- loss: 0.891255, loss_ss: 0.751910, loss_d: 0.139346
0.4223 --- loss: 1.325254, loss_ss: 0.797114, loss_d: 0.528140
0.4607 --- loss: 0.786066, loss_ss: 0.703057, loss_d: 0.083009
0.4990 --- loss: 1.572966, loss_ss: 0.863306, loss_d: 0.709660
0.5374 --- loss: 1.123192, loss_ss: 0.937505, loss_d: 0.185687
0.5758 --- loss: 1.140129, loss_ss: 0.747471, loss_d: 0.392659
0.6142 --- loss: 0.858753, loss_ss: 0.763838, loss_d: 0.094915
0.6526 --- loss: 1.000307, loss_ss: 0.807652, loss_d: 0.192655
0.6910 --- loss: 1.543006, loss_ss: 1.186500, loss_d: 0.356506
0.7294 --- loss: 1.384499, loss_ss: 0.840534, loss_d: 0.543964
0.7678 --- loss: 0.806898, loss_ss: 0.517114, loss_d: 0.289785
0.8061 --- loss: 1.058628, loss_ss: 0.817734, loss_d: 0.240894
0.8445 --- loss: 1.541649, loss_ss: 1.251384, loss_d: 0.290265
0.8829 --- loss: 1.292467, loss_ss: 0.997279, loss_d: 0.295188
0.9213 --- loss: 1.053739, loss_ss: 0.586166, loss_d: 0.467573
0.9597 --- loss: 0.899281, loss_ss: 0.746429, loss_d: 0.152852
0.9981 --- loss: 2.034097, loss_ss: 1.089317, loss_d: 0.944780
Epoch finished! Loss: 1.1579078392340587
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.220013, loss_ss: 0.798894, loss_d: 0.421120
0.0384 --- loss: 1.054826, loss_ss: 0.820561, loss_d: 0.234265
0.0768 --- loss: 1.221178, loss_ss: 1.035946, loss_d: 0.185232
0.1152 --- loss: 0.913542, loss_ss: 0.789526, loss_d: 0.124016
0.1536 --- loss: 1.415839, loss_ss: 0.901247, loss_d: 0.514592
0.1919 --- loss: 0.822542, loss_ss: 0.717068, loss_d: 0.105474
0.2303 --- loss: 1.094713, loss_ss: 0.904245, loss_d: 0.190468
0.2687 --- loss: 0.928191, loss_ss: 0.736041, loss_d: 0.192150
0.3071 --- loss: 1.034496, loss_ss: 0.769524, loss_d: 0.264971
0.3455 --- loss: 1.080990, loss_ss: 0.787446, loss_d: 0.293544
0.3839 --- loss: 1.229569, loss_ss: 0.972973, loss_d: 0.256596
0.4223 --- loss: 0.688489, loss_ss: 0.591525, loss_d: 0.096964
0.4607 --- loss: 1.094210, loss_ss: 0.587073, loss_d: 0.507137
0.4990 --- loss: 1.059550, loss_ss: 0.721288, loss_d: 0.338262
0.5374 --- loss: 1.468496, loss_ss: 0.970731, loss_d: 0.497765
0.5758 --- loss: 1.006808, loss_ss: 0.794531, loss_d: 0.212278
0.6142 --- loss: 1.142091, loss_ss: 0.840421, loss_d: 0.301670
0.6526 --- loss: 1.181640, loss_ss: 0.791649, loss_d: 0.389991
0.6910 --- loss: 1.688825, loss_ss: 1.403305, loss_d: 0.285520
0.7294 --- loss: 1.128108, loss_ss: 0.915213, loss_d: 0.212895
0.7678 --- loss: 1.142593, loss_ss: 0.679129, loss_d: 0.463464
0.8061 --- loss: 1.132806, loss_ss: 0.755169, loss_d: 0.377637
0.8445 --- loss: 1.223029, loss_ss: 1.018326, loss_d: 0.204703
0.8829 --- loss: 0.761716, loss_ss: 0.648599, loss_d: 0.113117
0.9213 --- loss: 1.040210, loss_ss: 0.697963, loss_d: 0.342247
0.9597 --- loss: 1.594400, loss_ss: 0.818122, loss_d: 0.776278
0.9981 --- loss: 1.767956, loss_ss: 1.239775, loss_d: 0.528181
Epoch finished! Loss: 1.1411742584063456
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6282828282828283
             precision    recall  f1-score   support

        0.0       0.25      0.88      0.39        33
        1.0       0.50      0.09      0.15       142
        2.0       0.79      0.63      0.70       433
        3.0       0.57      0.87      0.68       189
        4.0       0.67      0.74      0.70       193

avg / total       0.67      0.63      0.61       990
 


====== chp013-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.71  87.88   90.80  24.79     38.67
1  85.66   9.15   98.47  50.00     15.48
2  76.67  63.28   87.07  79.19     70.35
3  84.75  86.77   84.27  56.55     68.48
4  87.88  73.58   91.34  67.30     70.30
Total accuracy: 62.83%
Average sen: 64.13%
Average spec: 90.39%
Macro f1-score: 52.65%
Diagnosis acc on 15mins: 0.8181818181818182
[0.13243718 0.6006614  0.67756748 0.64181471 0.51826572 0.20853145
 0.11722674 0.35363844 0.11547222 0.13749826 0.65329605 0.65995091
 0.65987283 0.71032339 0.93811738 0.98130381 0.81461388 0.99139142
 0.99635339 0.96031225 0.98252398 0.99285477 0.87681055 0.98585576
 0.62025118 0.91437483 0.98007375 0.97981757 0.92092127 0.77860272
 0.85907131 0.97642082 0.9737224 ]
pred: 0.7184833283677245, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp014-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.384247, loss_ss: 1.695358, loss_d: 0.688889
0.0384 --- loss: 2.054604, loss_ss: 1.456842, loss_d: 0.597762
0.0768 --- loss: 2.202505, loss_ss: 1.502693, loss_d: 0.699812
0.1152 --- loss: 2.228827, loss_ss: 1.505509, loss_d: 0.723318
0.1536 --- loss: 1.771079, loss_ss: 1.289689, loss_d: 0.481390
0.1919 --- loss: 1.902726, loss_ss: 1.362773, loss_d: 0.539953
0.2303 --- loss: 1.634816, loss_ss: 1.306904, loss_d: 0.327912
0.2687 --- loss: 1.970320, loss_ss: 1.345351, loss_d: 0.624970
0.3071 --- loss: 2.194829, loss_ss: 1.258980, loss_d: 0.935849
0.3455 --- loss: 1.797113, loss_ss: 1.272780, loss_d: 0.524333
0.3839 --- loss: 1.757603, loss_ss: 1.129109, loss_d: 0.628494
0.4223 --- loss: 1.753301, loss_ss: 1.127192, loss_d: 0.626109
0.4607 --- loss: 1.935216, loss_ss: 1.478242, loss_d: 0.456974
0.4990 --- loss: 1.855460, loss_ss: 1.391837, loss_d: 0.463623
0.5374 --- loss: 1.838566, loss_ss: 1.269223, loss_d: 0.569344
0.5758 --- loss: 1.573931, loss_ss: 1.236646, loss_d: 0.337285
0.6142 --- loss: 1.684507, loss_ss: 1.192504, loss_d: 0.492004
0.6526 --- loss: 1.775527, loss_ss: 1.125409, loss_d: 0.650119
0.6910 --- loss: 1.882091, loss_ss: 1.272683, loss_d: 0.609408
0.7294 --- loss: 1.867818, loss_ss: 1.119638, loss_d: 0.748180
0.7678 --- loss: 1.803175, loss_ss: 1.199770, loss_d: 0.603405
0.8061 --- loss: 1.674343, loss_ss: 1.053676, loss_d: 0.620667
0.8445 --- loss: 1.626516, loss_ss: 1.088861, loss_d: 0.537655
0.8829 --- loss: 1.600436, loss_ss: 1.056479, loss_d: 0.543957
0.9213 --- loss: 1.657501, loss_ss: 1.194839, loss_d: 0.462661
0.9597 --- loss: 1.549932, loss_ss: 1.076234, loss_d: 0.473697
0.9981 --- loss: 1.850208, loss_ss: 1.486861, loss_d: 0.363348
Epoch finished! Loss: 1.8848434186898746
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.706481, loss_ss: 1.078107, loss_d: 0.628375
0.0384 --- loss: 1.721411, loss_ss: 1.178354, loss_d: 0.543056
0.0768 --- loss: 1.947219, loss_ss: 1.135260, loss_d: 0.811959
0.1152 --- loss: 1.766504, loss_ss: 1.026538, loss_d: 0.739966
0.1536 --- loss: 1.567940, loss_ss: 0.961906, loss_d: 0.606034
0.1919 --- loss: 1.641217, loss_ss: 0.939717, loss_d: 0.701500
0.2303 --- loss: 1.582704, loss_ss: 1.013214, loss_d: 0.569490
0.2687 --- loss: 1.744153, loss_ss: 1.020129, loss_d: 0.724024
0.3071 --- loss: 1.576165, loss_ss: 1.123488, loss_d: 0.452677
0.3455 --- loss: 2.132703, loss_ss: 1.282075, loss_d: 0.850628
0.3839 --- loss: 1.891724, loss_ss: 1.256578, loss_d: 0.635147
0.4223 --- loss: 1.998985, loss_ss: 1.083454, loss_d: 0.915531
0.4607 --- loss: 1.800702, loss_ss: 0.989720, loss_d: 0.810982
0.4990 --- loss: 1.715411, loss_ss: 1.134112, loss_d: 0.581299
0.5374 --- loss: 1.389683, loss_ss: 0.967635, loss_d: 0.422048
0.5758 --- loss: 1.686608, loss_ss: 1.182706, loss_d: 0.503901
0.6142 --- loss: 1.989881, loss_ss: 1.040486, loss_d: 0.949395
0.6526 --- loss: 1.877333, loss_ss: 1.265297, loss_d: 0.612036
0.6910 --- loss: 1.560176, loss_ss: 0.979385, loss_d: 0.580791
0.7294 --- loss: 1.289896, loss_ss: 1.054245, loss_d: 0.235651
0.7678 --- loss: 1.541398, loss_ss: 0.941664, loss_d: 0.599734
0.8061 --- loss: 1.863480, loss_ss: 1.302981, loss_d: 0.560499
0.8445 --- loss: 1.802700, loss_ss: 1.279834, loss_d: 0.522866
0.8829 --- loss: 1.479893, loss_ss: 0.922730, loss_d: 0.557163
0.9213 --- loss: 1.582420, loss_ss: 0.915569, loss_d: 0.666851
0.9597 --- loss: 1.246525, loss_ss: 0.869524, loss_d: 0.377001
0.9981 --- loss: 1.624230, loss_ss: 0.740569, loss_d: 0.883661
Epoch finished! Loss: 1.6937963279394004
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.327157, loss_ss: 0.881928, loss_d: 0.445229
0.0384 --- loss: 1.402537, loss_ss: 0.894511, loss_d: 0.508026
0.0768 --- loss: 1.817263, loss_ss: 1.093261, loss_d: 0.724002
0.1152 --- loss: 1.555929, loss_ss: 1.010817, loss_d: 0.545112
0.1536 --- loss: 1.628049, loss_ss: 1.023334, loss_d: 0.604715
0.1919 --- loss: 1.896836, loss_ss: 1.041780, loss_d: 0.855056
0.2303 --- loss: 1.609680, loss_ss: 1.029479, loss_d: 0.580201
0.2687 --- loss: 1.471102, loss_ss: 1.091253, loss_d: 0.379848
0.3071 --- loss: 1.752518, loss_ss: 1.050111, loss_d: 0.702407
0.3455 --- loss: 2.013357, loss_ss: 1.436231, loss_d: 0.577126
0.3839 --- loss: 1.403173, loss_ss: 1.042058, loss_d: 0.361115
0.4223 --- loss: 1.792643, loss_ss: 1.149607, loss_d: 0.643036
0.4607 --- loss: 1.588323, loss_ss: 0.961078, loss_d: 0.627245
0.4990 --- loss: 1.691561, loss_ss: 1.193500, loss_d: 0.498062
0.5374 --- loss: 1.508334, loss_ss: 0.992061, loss_d: 0.516273
0.5758 --- loss: 1.664747, loss_ss: 1.088779, loss_d: 0.575969
0.6142 --- loss: 1.441279, loss_ss: 0.874571, loss_d: 0.566708
0.6526 --- loss: 1.493782, loss_ss: 0.920230, loss_d: 0.573552
0.6910 --- loss: 1.323598, loss_ss: 0.902886, loss_d: 0.420712
0.7294 --- loss: 1.207967, loss_ss: 0.856865, loss_d: 0.351101
0.7678 --- loss: 1.525087, loss_ss: 1.077116, loss_d: 0.447970
0.8061 --- loss: 1.325371, loss_ss: 0.841383, loss_d: 0.483988
0.8445 --- loss: 1.241474, loss_ss: 0.960159, loss_d: 0.281314
0.8829 --- loss: 1.270434, loss_ss: 0.871833, loss_d: 0.398601
0.9213 --- loss: 1.395322, loss_ss: 0.969475, loss_d: 0.425847
0.9597 --- loss: 1.405951, loss_ss: 0.950328, loss_d: 0.455623
0.9981 --- loss: 1.748435, loss_ss: 1.437523, loss_d: 0.310912
Epoch finished! Loss: 1.5528968109534338
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.120962, loss_ss: 0.830592, loss_d: 0.290370
0.0384 --- loss: 1.213665, loss_ss: 0.944060, loss_d: 0.269605
0.0768 --- loss: 2.102367, loss_ss: 0.908476, loss_d: 1.193891
0.1152 --- loss: 1.421952, loss_ss: 0.911768, loss_d: 0.510184
0.1536 --- loss: 1.338614, loss_ss: 0.896994, loss_d: 0.441620
0.1919 --- loss: 1.507504, loss_ss: 0.993432, loss_d: 0.514072
0.2303 --- loss: 1.319683, loss_ss: 1.013933, loss_d: 0.305751
0.2687 --- loss: 1.279261, loss_ss: 1.008649, loss_d: 0.270612
0.3071 --- loss: 1.707609, loss_ss: 1.251236, loss_d: 0.456373
0.3455 --- loss: 1.511844, loss_ss: 0.941753, loss_d: 0.570091
0.3839 --- loss: 1.727716, loss_ss: 0.901573, loss_d: 0.826143
0.4223 --- loss: 1.255243, loss_ss: 0.855805, loss_d: 0.399438
0.4607 --- loss: 1.448585, loss_ss: 0.987719, loss_d: 0.460865
0.4990 --- loss: 1.650576, loss_ss: 1.138927, loss_d: 0.511650
0.5374 --- loss: 1.355674, loss_ss: 0.756968, loss_d: 0.598707
0.5758 --- loss: 1.742559, loss_ss: 1.005819, loss_d: 0.736740
0.6142 --- loss: 1.402516, loss_ss: 0.901080, loss_d: 0.501437
0.6526 --- loss: 1.721886, loss_ss: 1.292144, loss_d: 0.429742
0.6910 --- loss: 1.541042, loss_ss: 1.339939, loss_d: 0.201103
0.7294 --- loss: 1.536535, loss_ss: 1.013515, loss_d: 0.523020
0.7678 --- loss: 1.609369, loss_ss: 0.968474, loss_d: 0.640895
0.8061 --- loss: 1.466778, loss_ss: 0.869114, loss_d: 0.597665
0.8445 --- loss: 1.734614, loss_ss: 0.992176, loss_d: 0.742439
0.8829 --- loss: 1.249141, loss_ss: 0.844655, loss_d: 0.404486
0.9213 --- loss: 1.188785, loss_ss: 0.850249, loss_d: 0.338535
0.9597 --- loss: 1.213969, loss_ss: 0.818690, loss_d: 0.395279
0.9981 --- loss: 1.235950, loss_ss: 0.709209, loss_d: 0.526741
Epoch finished! Loss: 1.4730925578337448
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.688172, loss_ss: 1.137792, loss_d: 0.550380
0.0384 --- loss: 1.186980, loss_ss: 0.813553, loss_d: 0.373428
0.0768 --- loss: 1.799938, loss_ss: 0.947654, loss_d: 0.852284
0.1152 --- loss: 1.208580, loss_ss: 0.925388, loss_d: 0.283192
0.1536 --- loss: 1.237809, loss_ss: 0.889429, loss_d: 0.348380
0.1919 --- loss: 1.145146, loss_ss: 0.832183, loss_d: 0.312963
0.2303 --- loss: 0.914203, loss_ss: 0.712919, loss_d: 0.201284
0.2687 --- loss: 1.254952, loss_ss: 0.957356, loss_d: 0.297596
0.3071 --- loss: 1.121210, loss_ss: 0.846612, loss_d: 0.274598
0.3455 --- loss: 1.774203, loss_ss: 1.138041, loss_d: 0.636162
0.3839 --- loss: 2.111918, loss_ss: 1.144469, loss_d: 0.967450
0.4223 --- loss: 1.420447, loss_ss: 0.967557, loss_d: 0.452890
0.4607 --- loss: 1.224441, loss_ss: 0.998157, loss_d: 0.226284
0.4990 --- loss: 1.777187, loss_ss: 1.194464, loss_d: 0.582724
0.5374 --- loss: 1.184643, loss_ss: 0.954773, loss_d: 0.229869
0.5758 --- loss: 1.509801, loss_ss: 1.192878, loss_d: 0.316923
0.6142 --- loss: 1.242609, loss_ss: 0.831437, loss_d: 0.411172
0.6526 --- loss: 0.869180, loss_ss: 0.640227, loss_d: 0.228952
0.6910 --- loss: 1.118727, loss_ss: 0.817219, loss_d: 0.301508
0.7294 --- loss: 1.424276, loss_ss: 0.918910, loss_d: 0.505366
0.7678 --- loss: 1.166105, loss_ss: 0.862801, loss_d: 0.303303
0.8061 --- loss: 1.432317, loss_ss: 1.033130, loss_d: 0.399188
0.8445 --- loss: 1.640075, loss_ss: 1.047073, loss_d: 0.593002
0.8829 --- loss: 1.111402, loss_ss: 0.646635, loss_d: 0.464767
0.9213 --- loss: 2.413533, loss_ss: 0.963778, loss_d: 1.449755
0.9597 --- loss: 1.364754, loss_ss: 0.810093, loss_d: 0.554661
0.9981 --- loss: 1.083866, loss_ss: 0.874149, loss_d: 0.209717
Epoch finished! Loss: 1.362134023813101
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.329437, loss_ss: 0.621667, loss_d: 0.707769
0.0384 --- loss: 1.345774, loss_ss: 0.954590, loss_d: 0.391184
0.0768 --- loss: 0.998085, loss_ss: 0.700598, loss_d: 0.297488
0.1152 --- loss: 1.180710, loss_ss: 0.864549, loss_d: 0.316161
0.1536 --- loss: 1.684255, loss_ss: 0.858218, loss_d: 0.826037
0.1919 --- loss: 1.370978, loss_ss: 0.729666, loss_d: 0.641312
0.2303 --- loss: 1.292744, loss_ss: 0.790673, loss_d: 0.502070
0.2687 --- loss: 1.250983, loss_ss: 0.870198, loss_d: 0.380785
0.3071 --- loss: 0.958719, loss_ss: 0.768657, loss_d: 0.190061
0.3455 --- loss: 0.944657, loss_ss: 0.736030, loss_d: 0.208628
0.3839 --- loss: 1.400583, loss_ss: 0.999171, loss_d: 0.401413
0.4223 --- loss: 1.547013, loss_ss: 0.979435, loss_d: 0.567578
0.4607 --- loss: 1.323243, loss_ss: 1.060774, loss_d: 0.262469
0.4990 --- loss: 1.237808, loss_ss: 0.892376, loss_d: 0.345431
0.5374 --- loss: 1.011099, loss_ss: 0.799462, loss_d: 0.211637
0.5758 --- loss: 1.207334, loss_ss: 0.940721, loss_d: 0.266613
0.6142 --- loss: 1.445602, loss_ss: 0.849573, loss_d: 0.596029
0.6526 --- loss: 1.030763, loss_ss: 0.794724, loss_d: 0.236039
0.6910 --- loss: 1.506059, loss_ss: 0.886294, loss_d: 0.619765
0.7294 --- loss: 1.133867, loss_ss: 0.911315, loss_d: 0.222552
0.7678 --- loss: 1.353144, loss_ss: 0.814686, loss_d: 0.538458
0.8061 --- loss: 1.999362, loss_ss: 1.068926, loss_d: 0.930437
0.8445 --- loss: 1.145007, loss_ss: 0.789407, loss_d: 0.355599
0.8829 --- loss: 1.342605, loss_ss: 0.776988, loss_d: 0.565617
0.9213 --- loss: 1.683116, loss_ss: 1.001630, loss_d: 0.681487
0.9597 --- loss: 1.835747, loss_ss: 1.089847, loss_d: 0.745900
0.9981 --- loss: 1.234814, loss_ss: 0.712112, loss_d: 0.522702
Epoch finished! Loss: 1.3054518468104876
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.087080, loss_ss: 0.800358, loss_d: 0.286722
0.0384 --- loss: 1.259726, loss_ss: 0.878437, loss_d: 0.381288
0.0768 --- loss: 1.618048, loss_ss: 1.013406, loss_d: 0.604642
0.1152 --- loss: 1.169911, loss_ss: 0.634247, loss_d: 0.535663
0.1536 --- loss: 1.299474, loss_ss: 0.900299, loss_d: 0.399175
0.1919 --- loss: 1.223674, loss_ss: 0.800162, loss_d: 0.423512
0.2303 --- loss: 1.756810, loss_ss: 0.961464, loss_d: 0.795346
0.2687 --- loss: 1.300129, loss_ss: 1.101628, loss_d: 0.198501
0.3071 --- loss: 0.990119, loss_ss: 0.680820, loss_d: 0.309299
0.3455 --- loss: 1.187266, loss_ss: 0.858028, loss_d: 0.329238
0.3839 --- loss: 1.085812, loss_ss: 0.698649, loss_d: 0.387163
0.4223 --- loss: 0.987671, loss_ss: 0.779911, loss_d: 0.207760
0.4607 --- loss: 0.788104, loss_ss: 0.646648, loss_d: 0.141456
0.4990 --- loss: 1.623336, loss_ss: 0.809955, loss_d: 0.813382
0.5374 --- loss: 0.978969, loss_ss: 0.731291, loss_d: 0.247677
0.5758 --- loss: 1.416891, loss_ss: 0.917825, loss_d: 0.499066
0.6142 --- loss: 1.185668, loss_ss: 1.006764, loss_d: 0.178903
0.6526 --- loss: 1.584008, loss_ss: 0.871822, loss_d: 0.712186
0.6910 --- loss: 1.016809, loss_ss: 0.728493, loss_d: 0.288316
0.7294 --- loss: 1.202238, loss_ss: 0.960623, loss_d: 0.241614
0.7678 --- loss: 1.073283, loss_ss: 0.822934, loss_d: 0.250349
0.8061 --- loss: 1.553027, loss_ss: 1.336853, loss_d: 0.216174
0.8445 --- loss: 1.000982, loss_ss: 0.827578, loss_d: 0.173404
0.8829 --- loss: 1.568676, loss_ss: 1.098672, loss_d: 0.470004
0.9213 --- loss: 1.365782, loss_ss: 0.897026, loss_d: 0.468756
0.9597 --- loss: 1.083423, loss_ss: 0.807399, loss_d: 0.276024
0.9981 --- loss: 1.307115, loss_ss: 1.076535, loss_d: 0.230580
Epoch finished! Loss: 1.259210074864901
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.240406, loss_ss: 0.986372, loss_d: 0.254034
0.0384 --- loss: 2.097581, loss_ss: 1.012918, loss_d: 1.084663
0.0768 --- loss: 1.115583, loss_ss: 0.739455, loss_d: 0.376129
0.1152 --- loss: 1.583831, loss_ss: 1.259670, loss_d: 0.324161
0.1536 --- loss: 1.347294, loss_ss: 1.160839, loss_d: 0.186454
0.1919 --- loss: 1.389266, loss_ss: 0.986981, loss_d: 0.402284
0.2303 --- loss: 1.158422, loss_ss: 0.832238, loss_d: 0.326183
0.2687 --- loss: 0.975334, loss_ss: 0.721947, loss_d: 0.253386
0.3071 --- loss: 1.466648, loss_ss: 1.024418, loss_d: 0.442230
0.3455 --- loss: 1.157009, loss_ss: 0.806392, loss_d: 0.350617
0.3839 --- loss: 1.199565, loss_ss: 0.957963, loss_d: 0.241602
0.4223 --- loss: 1.489394, loss_ss: 1.026551, loss_d: 0.462844
0.4607 --- loss: 1.122347, loss_ss: 0.640646, loss_d: 0.481701
0.4990 --- loss: 1.462128, loss_ss: 1.265226, loss_d: 0.196903
0.5374 --- loss: 0.928883, loss_ss: 0.615959, loss_d: 0.312924
0.5758 --- loss: 0.859676, loss_ss: 0.667874, loss_d: 0.191802
0.6142 --- loss: 1.054040, loss_ss: 0.878489, loss_d: 0.175551
0.6526 --- loss: 1.415064, loss_ss: 1.019437, loss_d: 0.395627
0.6910 --- loss: 1.568242, loss_ss: 0.909999, loss_d: 0.658243
0.7294 --- loss: 1.307425, loss_ss: 0.971439, loss_d: 0.335986
0.7678 --- loss: 1.293256, loss_ss: 0.910891, loss_d: 0.382366
0.8061 --- loss: 1.015078, loss_ss: 0.740532, loss_d: 0.274546
0.8445 --- loss: 1.267804, loss_ss: 0.755429, loss_d: 0.512376
0.8829 --- loss: 1.663433, loss_ss: 0.651529, loss_d: 1.011903
0.9213 --- loss: 1.699185, loss_ss: 0.857766, loss_d: 0.841419
0.9597 --- loss: 1.688146, loss_ss: 0.988729, loss_d: 0.699417
0.9981 --- loss: 0.826372, loss_ss: 0.672684, loss_d: 0.153688
Epoch finished! Loss: 1.2317898576076214
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.845109, loss_ss: 0.746904, loss_d: 0.098205
0.0384 --- loss: 0.903076, loss_ss: 0.493734, loss_d: 0.409343
0.0768 --- loss: 0.933756, loss_ss: 0.734987, loss_d: 0.198769
0.1152 --- loss: 1.041396, loss_ss: 0.794166, loss_d: 0.247230
0.1536 --- loss: 1.293088, loss_ss: 0.954695, loss_d: 0.338392
0.1919 --- loss: 1.280708, loss_ss: 0.703855, loss_d: 0.576853
0.2303 --- loss: 1.131653, loss_ss: 0.909821, loss_d: 0.221832
0.2687 --- loss: 1.105189, loss_ss: 0.744826, loss_d: 0.360363
0.3071 --- loss: 1.235525, loss_ss: 0.886725, loss_d: 0.348800
0.3455 --- loss: 1.168650, loss_ss: 0.747917, loss_d: 0.420733
0.3839 --- loss: 1.143855, loss_ss: 0.720333, loss_d: 0.423521
0.4223 --- loss: 1.395001, loss_ss: 0.971728, loss_d: 0.423273
0.4607 --- loss: 1.809458, loss_ss: 1.527327, loss_d: 0.282132
0.4990 --- loss: 1.103575, loss_ss: 0.831706, loss_d: 0.271869
0.5374 --- loss: 0.824664, loss_ss: 0.561509, loss_d: 0.263155
0.5758 --- loss: 0.906199, loss_ss: 0.644404, loss_d: 0.261795
0.6142 --- loss: 1.506243, loss_ss: 0.950578, loss_d: 0.555664
0.6526 --- loss: 1.071447, loss_ss: 0.764847, loss_d: 0.306601
0.6910 --- loss: 1.362342, loss_ss: 1.192814, loss_d: 0.169528
0.7294 --- loss: 1.301061, loss_ss: 0.685945, loss_d: 0.615117
0.7678 --- loss: 0.934631, loss_ss: 0.716394, loss_d: 0.218237
0.8061 --- loss: 1.136709, loss_ss: 0.840484, loss_d: 0.296225
0.8445 --- loss: 1.101583, loss_ss: 0.726999, loss_d: 0.374584
0.8829 --- loss: 1.612601, loss_ss: 1.162278, loss_d: 0.450323
0.9213 --- loss: 1.369003, loss_ss: 1.073659, loss_d: 0.295344
0.9597 --- loss: 1.259308, loss_ss: 0.887734, loss_d: 0.371574
0.9981 --- loss: 1.287667, loss_ss: 0.795087, loss_d: 0.492580
Epoch finished! Loss: 1.2061399863316462
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.953926, loss_ss: 0.680617, loss_d: 0.273310
0.0384 --- loss: 1.767974, loss_ss: 0.782258, loss_d: 0.985717
0.0768 --- loss: 0.875597, loss_ss: 0.642386, loss_d: 0.233211
0.1152 --- loss: 1.171932, loss_ss: 0.812310, loss_d: 0.359621
0.1536 --- loss: 0.986583, loss_ss: 0.805995, loss_d: 0.180588
0.1919 --- loss: 1.159340, loss_ss: 0.888886, loss_d: 0.270454
0.2303 --- loss: 0.902735, loss_ss: 0.701473, loss_d: 0.201262
0.2687 --- loss: 0.908780, loss_ss: 0.712487, loss_d: 0.196292
0.3071 --- loss: 1.420765, loss_ss: 0.971869, loss_d: 0.448896
0.3455 --- loss: 0.776406, loss_ss: 0.657997, loss_d: 0.118409
0.3839 --- loss: 0.929187, loss_ss: 0.853195, loss_d: 0.075992
0.4223 --- loss: 1.219587, loss_ss: 1.107987, loss_d: 0.111600
0.4607 --- loss: 1.342112, loss_ss: 1.081107, loss_d: 0.261005
0.4990 --- loss: 1.196866, loss_ss: 0.729188, loss_d: 0.467678
0.5374 --- loss: 0.968367, loss_ss: 0.689526, loss_d: 0.278841
0.5758 --- loss: 1.027045, loss_ss: 0.899068, loss_d: 0.127977
0.6142 --- loss: 1.053533, loss_ss: 0.829354, loss_d: 0.224179
0.6526 --- loss: 1.488862, loss_ss: 1.089777, loss_d: 0.399085
0.6910 --- loss: 0.905852, loss_ss: 0.739433, loss_d: 0.166418
0.7294 --- loss: 0.882936, loss_ss: 0.584694, loss_d: 0.298242
0.7678 --- loss: 1.207979, loss_ss: 0.994646, loss_d: 0.213333
0.8061 --- loss: 0.875467, loss_ss: 0.703427, loss_d: 0.172040
0.8445 --- loss: 0.972092, loss_ss: 0.775436, loss_d: 0.196657
0.8829 --- loss: 1.229318, loss_ss: 0.675819, loss_d: 0.553499
0.9213 --- loss: 0.949847, loss_ss: 0.807736, loss_d: 0.142110
0.9597 --- loss: 1.058108, loss_ss: 0.851224, loss_d: 0.206884
0.9981 --- loss: 1.412246, loss_ss: 1.132573, loss_d: 0.279673
Epoch finished! Loss: 1.1686460678394024
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6050505050505051
             precision    recall  f1-score   support

        0.0       0.50      0.98      0.66       203
        1.0       0.14      0.29      0.19        68
        2.0       0.84      0.69      0.76       397
        3.0       1.00      0.68      0.81       146
        4.0       0.45      0.03      0.05       176

avg / total       0.67      0.61      0.58       990
 


====== chp014-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  79.09  98.03   74.21   49.50     65.79
1  82.22  29.41   86.12   13.51     18.52
2  82.22  69.27   90.89   83.59     75.76
3  95.35  68.49  100.00  100.00     81.30
4  82.12   2.84   99.26   45.45      5.35
Total accuracy: 60.51%
Average sen: 53.61%
Average spec: 90.10%
Macro f1-score: 49.34%
Diagnosis acc on 15mins: 1.0
[0.98773426 0.98566145 0.98902076 0.98802829 0.98364246 0.98402554
 0.97212541 0.97912472 0.9896102  0.98992401 0.97024393 0.98867804
 0.98778522 0.98721433 0.98413473 0.98305213 0.98485535 0.98882294
 0.97256202 0.9882884  0.98294985 0.98947734 0.9875235  0.98732436
 0.9865303  0.9896102  0.98554188 0.98708725 0.98249024 0.9884035
 0.98889941 0.98361963 0.97773242]
pred: 0.9849007292227312, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp015-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.384444, loss_ss: 1.680581, loss_d: 0.703863
0.0385 --- loss: 2.604035, loss_ss: 1.701945, loss_d: 0.902090
0.0769 --- loss: 2.203617, loss_ss: 1.441649, loss_d: 0.761968
0.1154 --- loss: 2.243002, loss_ss: 1.444942, loss_d: 0.798060
0.1538 --- loss: 2.377043, loss_ss: 1.526752, loss_d: 0.850291
0.1923 --- loss: 2.283217, loss_ss: 1.487788, loss_d: 0.795429
0.2308 --- loss: 2.202718, loss_ss: 1.480473, loss_d: 0.722245
0.2692 --- loss: 1.804848, loss_ss: 1.405600, loss_d: 0.399247
0.3077 --- loss: 1.775582, loss_ss: 1.280458, loss_d: 0.495124
0.3462 --- loss: 2.174814, loss_ss: 1.338786, loss_d: 0.836029
0.3846 --- loss: 1.807722, loss_ss: 1.281069, loss_d: 0.526653
0.4231 --- loss: 1.766835, loss_ss: 1.337357, loss_d: 0.429478
0.4615 --- loss: 2.210150, loss_ss: 1.500217, loss_d: 0.709933
0.5000 --- loss: 2.085708, loss_ss: 1.345624, loss_d: 0.740084
0.5385 --- loss: 1.820276, loss_ss: 1.248195, loss_d: 0.572081
0.5769 --- loss: 2.181062, loss_ss: 1.447583, loss_d: 0.733479
0.6154 --- loss: 1.950894, loss_ss: 1.143122, loss_d: 0.807772
0.6538 --- loss: 1.932652, loss_ss: 1.289966, loss_d: 0.642685
0.6923 --- loss: 1.938227, loss_ss: 1.174966, loss_d: 0.763261
0.7308 --- loss: 1.957061, loss_ss: 1.344172, loss_d: 0.612889
0.7692 --- loss: 1.894871, loss_ss: 1.373068, loss_d: 0.521804
0.8077 --- loss: 1.547404, loss_ss: 1.174073, loss_d: 0.373331
0.8462 --- loss: 1.775533, loss_ss: 1.080860, loss_d: 0.694673
0.8846 --- loss: 1.834860, loss_ss: 1.136288, loss_d: 0.698573
0.9231 --- loss: 1.896348, loss_ss: 1.308019, loss_d: 0.588328
0.9615 --- loss: 1.671420, loss_ss: 1.106812, loss_d: 0.564607
Epoch finished! Loss: 1.9776016317279181
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.667698, loss_ss: 1.227448, loss_d: 0.440250
0.0385 --- loss: 1.598826, loss_ss: 1.183885, loss_d: 0.414941
0.0769 --- loss: 1.839965, loss_ss: 1.323924, loss_d: 0.516041
0.1154 --- loss: 1.591763, loss_ss: 1.060245, loss_d: 0.531518
0.1538 --- loss: 1.789704, loss_ss: 1.190543, loss_d: 0.599161
0.1923 --- loss: 1.625867, loss_ss: 1.142289, loss_d: 0.483578
0.2308 --- loss: 1.542487, loss_ss: 1.023071, loss_d: 0.519417
0.2692 --- loss: 1.878712, loss_ss: 1.383371, loss_d: 0.495341
0.3077 --- loss: 1.844190, loss_ss: 1.045222, loss_d: 0.798968
0.3462 --- loss: 1.498192, loss_ss: 0.981840, loss_d: 0.516352
0.3846 --- loss: 1.509533, loss_ss: 1.078836, loss_d: 0.430697
0.4231 --- loss: 1.859282, loss_ss: 0.931925, loss_d: 0.927358
0.4615 --- loss: 1.977185, loss_ss: 1.522206, loss_d: 0.454978
0.5000 --- loss: 1.564638, loss_ss: 1.078974, loss_d: 0.485664
0.5385 --- loss: 2.003283, loss_ss: 1.439363, loss_d: 0.563920
0.5769 --- loss: 1.684645, loss_ss: 1.034115, loss_d: 0.650530
0.6154 --- loss: 2.167995, loss_ss: 1.533293, loss_d: 0.634702
0.6538 --- loss: 1.744395, loss_ss: 1.085056, loss_d: 0.659338
0.6923 --- loss: 2.033813, loss_ss: 1.186998, loss_d: 0.846815
0.7308 --- loss: 2.417718, loss_ss: 1.306976, loss_d: 1.110742
0.7692 --- loss: 1.962333, loss_ss: 1.160695, loss_d: 0.801638
0.8077 --- loss: 1.643909, loss_ss: 1.124862, loss_d: 0.519047
0.8462 --- loss: 1.644259, loss_ss: 0.982175, loss_d: 0.662084
0.8846 --- loss: 1.492811, loss_ss: 0.915064, loss_d: 0.577746
0.9231 --- loss: 1.643503, loss_ss: 1.054885, loss_d: 0.588618
0.9615 --- loss: 2.017810, loss_ss: 1.336096, loss_d: 0.681714
Epoch finished! Loss: 1.7186413671979572
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.922535, loss_ss: 1.515486, loss_d: 0.407048
0.0385 --- loss: 1.562008, loss_ss: 1.058650, loss_d: 0.503358
0.0769 --- loss: 2.078166, loss_ss: 1.283612, loss_d: 0.794554
0.1154 --- loss: 1.527007, loss_ss: 0.996219, loss_d: 0.530788
0.1538 --- loss: 1.515759, loss_ss: 1.011126, loss_d: 0.504633
0.1923 --- loss: 1.959912, loss_ss: 1.614259, loss_d: 0.345652
0.2308 --- loss: 1.558404, loss_ss: 1.075258, loss_d: 0.483146
0.2692 --- loss: 1.655424, loss_ss: 1.033072, loss_d: 0.622351
0.3077 --- loss: 1.580940, loss_ss: 1.041338, loss_d: 0.539602
0.3462 --- loss: 1.337108, loss_ss: 0.852390, loss_d: 0.484718
0.3846 --- loss: 1.399295, loss_ss: 0.865372, loss_d: 0.533923
0.4231 --- loss: 1.453614, loss_ss: 0.988464, loss_d: 0.465150
0.4615 --- loss: 1.556649, loss_ss: 1.158938, loss_d: 0.397711
0.5000 --- loss: 1.662393, loss_ss: 0.873293, loss_d: 0.789100
0.5385 --- loss: 1.673495, loss_ss: 1.298352, loss_d: 0.375142
0.5769 --- loss: 1.700463, loss_ss: 0.982608, loss_d: 0.717855
0.6154 --- loss: 1.548693, loss_ss: 0.914973, loss_d: 0.633721
0.6538 --- loss: 1.555045, loss_ss: 0.909288, loss_d: 0.645757
0.6923 --- loss: 1.513003, loss_ss: 0.926480, loss_d: 0.586523
0.7308 --- loss: 1.989860, loss_ss: 1.449896, loss_d: 0.539964
0.7692 --- loss: 1.715649, loss_ss: 0.913940, loss_d: 0.801708
0.8077 --- loss: 1.580909, loss_ss: 1.093819, loss_d: 0.487091
0.8462 --- loss: 1.507038, loss_ss: 1.120082, loss_d: 0.386956
0.8846 --- loss: 1.747631, loss_ss: 0.939092, loss_d: 0.808539
0.9231 --- loss: 1.585010, loss_ss: 1.117887, loss_d: 0.467123
0.9615 --- loss: 1.378421, loss_ss: 0.870439, loss_d: 0.507982
Epoch finished! Loss: 1.624979872961302
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.644016, loss_ss: 0.787119, loss_d: 0.856897
0.0385 --- loss: 1.546987, loss_ss: 0.731517, loss_d: 0.815470
0.0769 --- loss: 1.751349, loss_ss: 1.174301, loss_d: 0.577048
0.1154 --- loss: 1.639612, loss_ss: 0.886676, loss_d: 0.752936
0.1538 --- loss: 1.558489, loss_ss: 1.153357, loss_d: 0.405132
0.1923 --- loss: 1.689025, loss_ss: 1.135448, loss_d: 0.553578
0.2308 --- loss: 1.621034, loss_ss: 1.085044, loss_d: 0.535990
0.2692 --- loss: 1.631706, loss_ss: 1.157479, loss_d: 0.474226
0.3077 --- loss: 1.537923, loss_ss: 1.126638, loss_d: 0.411285
0.3462 --- loss: 1.444680, loss_ss: 0.863136, loss_d: 0.581544
0.3846 --- loss: 1.817309, loss_ss: 0.883240, loss_d: 0.934069
0.4231 --- loss: 1.697682, loss_ss: 1.200245, loss_d: 0.497437
0.4615 --- loss: 1.415997, loss_ss: 0.720376, loss_d: 0.695621
0.5000 --- loss: 1.301858, loss_ss: 0.736876, loss_d: 0.564982
0.5385 --- loss: 1.501560, loss_ss: 0.953679, loss_d: 0.547881
0.5769 --- loss: 1.581691, loss_ss: 0.810947, loss_d: 0.770744
0.6154 --- loss: 1.631503, loss_ss: 1.240810, loss_d: 0.390692
0.6538 --- loss: 1.454704, loss_ss: 0.780382, loss_d: 0.674323
0.6923 --- loss: 1.433879, loss_ss: 0.884545, loss_d: 0.549334
0.7308 --- loss: 1.558693, loss_ss: 0.829707, loss_d: 0.728987
0.7692 --- loss: 1.316408, loss_ss: 0.852626, loss_d: 0.463782
0.8077 --- loss: 1.989902, loss_ss: 1.152391, loss_d: 0.837511
0.8462 --- loss: 1.373889, loss_ss: 0.922718, loss_d: 0.451171
0.8846 --- loss: 1.618394, loss_ss: 1.019033, loss_d: 0.599361
0.9231 --- loss: 1.404177, loss_ss: 1.030337, loss_d: 0.373840
0.9615 --- loss: 1.278864, loss_ss: 0.860857, loss_d: 0.418007
Epoch finished! Loss: 1.560222493175374
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.171853, loss_ss: 0.718106, loss_d: 0.453747
0.0385 --- loss: 1.219247, loss_ss: 0.737804, loss_d: 0.481443
0.0769 --- loss: 1.637752, loss_ss: 1.070659, loss_d: 0.567093
0.1154 --- loss: 1.562332, loss_ss: 1.226513, loss_d: 0.335819
0.1538 --- loss: 1.615582, loss_ss: 1.316170, loss_d: 0.299411
0.1923 --- loss: 1.166276, loss_ss: 0.684162, loss_d: 0.482114
0.2308 --- loss: 1.285496, loss_ss: 0.844165, loss_d: 0.441331
0.2692 --- loss: 1.687072, loss_ss: 0.880083, loss_d: 0.806989
0.3077 --- loss: 1.300713, loss_ss: 0.914909, loss_d: 0.385804
0.3462 --- loss: 1.310202, loss_ss: 0.842352, loss_d: 0.467849
0.3846 --- loss: 1.425370, loss_ss: 0.900594, loss_d: 0.524776
0.4231 --- loss: 1.460833, loss_ss: 1.096012, loss_d: 0.364821
0.4615 --- loss: 1.516027, loss_ss: 0.952248, loss_d: 0.563779
0.5000 --- loss: 1.493321, loss_ss: 1.143469, loss_d: 0.349852
0.5385 --- loss: 1.549007, loss_ss: 1.193649, loss_d: 0.355358
0.5769 --- loss: 1.666806, loss_ss: 0.799255, loss_d: 0.867552
0.6154 --- loss: 1.744271, loss_ss: 0.897676, loss_d: 0.846594
0.6538 --- loss: 1.432218, loss_ss: 0.866268, loss_d: 0.565950
0.6923 --- loss: 1.475699, loss_ss: 0.966032, loss_d: 0.509668
0.7308 --- loss: 1.472573, loss_ss: 0.799433, loss_d: 0.673139
0.7692 --- loss: 1.456570, loss_ss: 0.927267, loss_d: 0.529304
0.8077 --- loss: 1.358485, loss_ss: 0.940723, loss_d: 0.417762
0.8462 --- loss: 1.462382, loss_ss: 0.907173, loss_d: 0.555209
0.8846 --- loss: 1.465575, loss_ss: 0.889073, loss_d: 0.576502
0.9231 --- loss: 1.863206, loss_ss: 0.782704, loss_d: 1.080502
0.9615 --- loss: 1.869641, loss_ss: 1.036399, loss_d: 0.833242
Epoch finished! Loss: 1.486736587575964
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.448587, loss_ss: 1.007377, loss_d: 0.441210
0.0385 --- loss: 1.135960, loss_ss: 0.779362, loss_d: 0.356598
0.0769 --- loss: 1.447578, loss_ss: 0.773351, loss_d: 0.674227
0.1154 --- loss: 0.979260, loss_ss: 0.690538, loss_d: 0.288722
0.1538 --- loss: 1.152220, loss_ss: 0.864291, loss_d: 0.287929
0.1923 --- loss: 2.535866, loss_ss: 1.683912, loss_d: 0.851954
0.2308 --- loss: 1.334062, loss_ss: 1.049512, loss_d: 0.284551
0.2692 --- loss: 1.271835, loss_ss: 0.832890, loss_d: 0.438946
0.3077 --- loss: 1.610592, loss_ss: 0.986069, loss_d: 0.624523
0.3462 --- loss: 1.463432, loss_ss: 1.028538, loss_d: 0.434894
0.3846 --- loss: 1.343749, loss_ss: 0.910898, loss_d: 0.432852
0.4231 --- loss: 1.239574, loss_ss: 0.927170, loss_d: 0.312403
0.4615 --- loss: 1.454518, loss_ss: 0.874236, loss_d: 0.580282
0.5000 --- loss: 1.469662, loss_ss: 0.956064, loss_d: 0.513598
0.5385 --- loss: 1.600290, loss_ss: 0.963393, loss_d: 0.636897
0.5769 --- loss: 1.518555, loss_ss: 0.995906, loss_d: 0.522649
0.6154 --- loss: 1.066011, loss_ss: 0.715681, loss_d: 0.350330
0.6538 --- loss: 1.281333, loss_ss: 0.978174, loss_d: 0.303159
0.6923 --- loss: 1.213264, loss_ss: 0.901908, loss_d: 0.311356
0.7308 --- loss: 1.155459, loss_ss: 0.957892, loss_d: 0.197567
0.7692 --- loss: 1.204959, loss_ss: 0.887355, loss_d: 0.317603
0.8077 --- loss: 1.256886, loss_ss: 1.026209, loss_d: 0.230677
0.8462 --- loss: 1.534418, loss_ss: 1.118493, loss_d: 0.415924
0.8846 --- loss: 1.265679, loss_ss: 1.014569, loss_d: 0.251110
0.9231 --- loss: 1.160141, loss_ss: 0.937160, loss_d: 0.222981
0.9615 --- loss: 1.232566, loss_ss: 0.725354, loss_d: 0.507213
Epoch finished! Loss: 1.4005451519977172
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.412189, loss_ss: 1.173482, loss_d: 0.238707
0.0385 --- loss: 1.293004, loss_ss: 0.982135, loss_d: 0.310869
0.0769 --- loss: 1.612308, loss_ss: 0.956187, loss_d: 0.656122
0.1154 --- loss: 1.175309, loss_ss: 0.956862, loss_d: 0.218447
0.1538 --- loss: 1.081643, loss_ss: 0.914751, loss_d: 0.166892
0.1923 --- loss: 1.180210, loss_ss: 1.025886, loss_d: 0.154324
0.2308 --- loss: 1.432429, loss_ss: 1.073622, loss_d: 0.358807
0.2692 --- loss: 1.126602, loss_ss: 0.847898, loss_d: 0.278703
0.3077 --- loss: 1.054944, loss_ss: 0.698200, loss_d: 0.356745
0.3462 --- loss: 1.479529, loss_ss: 1.214985, loss_d: 0.264544
0.3846 --- loss: 1.479022, loss_ss: 0.825244, loss_d: 0.653778
0.4231 --- loss: 1.653594, loss_ss: 1.014727, loss_d: 0.638866
0.4615 --- loss: 0.983638, loss_ss: 0.787527, loss_d: 0.196111
0.5000 --- loss: 1.029990, loss_ss: 0.850126, loss_d: 0.179865
0.5385 --- loss: 1.299455, loss_ss: 0.790799, loss_d: 0.508655
0.5769 --- loss: 1.293514, loss_ss: 0.879836, loss_d: 0.413678
0.6154 --- loss: 1.464957, loss_ss: 1.064501, loss_d: 0.400456
0.6538 --- loss: 1.954689, loss_ss: 1.739212, loss_d: 0.215477
0.6923 --- loss: 1.623088, loss_ss: 0.846163, loss_d: 0.776925
0.7308 --- loss: 0.893687, loss_ss: 0.745704, loss_d: 0.147983
0.7692 --- loss: 1.365913, loss_ss: 0.956089, loss_d: 0.409824
0.8077 --- loss: 1.103634, loss_ss: 0.636721, loss_d: 0.466913
0.8462 --- loss: 1.675953, loss_ss: 1.024150, loss_d: 0.651803
0.8846 --- loss: 1.061331, loss_ss: 0.770908, loss_d: 0.290422
0.9231 --- loss: 1.129355, loss_ss: 0.829276, loss_d: 0.300079
0.9615 --- loss: 1.299399, loss_ss: 0.876595, loss_d: 0.422804
Epoch finished! Loss: 1.284287593769751
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.373052, loss_ss: 0.780444, loss_d: 0.592608
0.0385 --- loss: 1.171319, loss_ss: 0.993441, loss_d: 0.177879
0.0769 --- loss: 1.209587, loss_ss: 1.032795, loss_d: 0.176792
0.1154 --- loss: 1.244126, loss_ss: 0.848451, loss_d: 0.395674
0.1538 --- loss: 1.395555, loss_ss: 1.025984, loss_d: 0.369571
0.1923 --- loss: 1.610288, loss_ss: 1.144388, loss_d: 0.465901
0.2308 --- loss: 1.187940, loss_ss: 0.817173, loss_d: 0.370767
0.2692 --- loss: 0.983206, loss_ss: 0.780556, loss_d: 0.202650
0.3077 --- loss: 0.904770, loss_ss: 0.648754, loss_d: 0.256016
0.3462 --- loss: 1.296016, loss_ss: 1.065708, loss_d: 0.230308
0.3846 --- loss: 1.096325, loss_ss: 0.961895, loss_d: 0.134430
0.4231 --- loss: 1.082001, loss_ss: 0.788155, loss_d: 0.293846
0.4615 --- loss: 1.120009, loss_ss: 0.905846, loss_d: 0.214163
0.5000 --- loss: 1.608300, loss_ss: 0.737847, loss_d: 0.870453
0.5385 --- loss: 0.796213, loss_ss: 0.722138, loss_d: 0.074075
0.5769 --- loss: 1.153283, loss_ss: 0.926002, loss_d: 0.227281
0.6154 --- loss: 1.049099, loss_ss: 0.957738, loss_d: 0.091361
0.6538 --- loss: 1.384057, loss_ss: 0.681173, loss_d: 0.702885
0.6923 --- loss: 1.298910, loss_ss: 0.973283, loss_d: 0.325627
0.7308 --- loss: 1.064831, loss_ss: 0.831316, loss_d: 0.233515
0.7692 --- loss: 0.938897, loss_ss: 0.745687, loss_d: 0.193210
0.8077 --- loss: 1.409638, loss_ss: 0.966257, loss_d: 0.443381
0.8462 --- loss: 1.064016, loss_ss: 0.797712, loss_d: 0.266303
0.8846 --- loss: 1.075944, loss_ss: 0.822485, loss_d: 0.253459
0.9231 --- loss: 1.249596, loss_ss: 1.043972, loss_d: 0.205624
0.9615 --- loss: 1.308176, loss_ss: 0.801045, loss_d: 0.507132
Epoch finished! Loss: 1.2096189897953313
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.252812, loss_ss: 0.694179, loss_d: 0.558632
0.0385 --- loss: 0.853448, loss_ss: 0.619174, loss_d: 0.234274
0.0769 --- loss: 1.352530, loss_ss: 0.620144, loss_d: 0.732386
0.1154 --- loss: 1.668762, loss_ss: 1.233073, loss_d: 0.435689
0.1538 --- loss: 1.267300, loss_ss: 1.087939, loss_d: 0.179361
0.1923 --- loss: 0.872433, loss_ss: 0.649851, loss_d: 0.222583
0.2308 --- loss: 1.489799, loss_ss: 0.721269, loss_d: 0.768530
0.2692 --- loss: 0.750456, loss_ss: 0.646765, loss_d: 0.103691
0.3077 --- loss: 1.127884, loss_ss: 0.870481, loss_d: 0.257403
0.3462 --- loss: 1.383011, loss_ss: 1.137415, loss_d: 0.245597
0.3846 --- loss: 1.570157, loss_ss: 1.182976, loss_d: 0.387181
0.4231 --- loss: 1.232610, loss_ss: 0.781364, loss_d: 0.451246
0.4615 --- loss: 1.271245, loss_ss: 0.996594, loss_d: 0.274651
0.5000 --- loss: 1.615140, loss_ss: 1.377326, loss_d: 0.237813
0.5385 --- loss: 1.130860, loss_ss: 0.832017, loss_d: 0.298843
0.5769 --- loss: 1.663489, loss_ss: 0.967147, loss_d: 0.696342
0.6154 --- loss: 1.829591, loss_ss: 0.856496, loss_d: 0.973095
0.6538 --- loss: 0.812686, loss_ss: 0.581032, loss_d: 0.231655
0.6923 --- loss: 1.132143, loss_ss: 0.770010, loss_d: 0.362133
0.7308 --- loss: 1.635124, loss_ss: 0.823271, loss_d: 0.811854
0.7692 --- loss: 1.491937, loss_ss: 0.924170, loss_d: 0.567767
0.8077 --- loss: 1.101444, loss_ss: 0.780570, loss_d: 0.320874
0.8462 --- loss: 1.353033, loss_ss: 1.099942, loss_d: 0.253091
0.8846 --- loss: 1.016429, loss_ss: 0.810859, loss_d: 0.205570
0.9231 --- loss: 1.099312, loss_ss: 0.953511, loss_d: 0.145801
0.9615 --- loss: 1.162271, loss_ss: 0.745573, loss_d: 0.416698
Epoch finished! Loss: 1.1972868711791904
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.422322, loss_ss: 1.103312, loss_d: 0.319010
0.0385 --- loss: 1.389971, loss_ss: 0.712475, loss_d: 0.677496
0.0769 --- loss: 0.804949, loss_ss: 0.668489, loss_d: 0.136460
0.1154 --- loss: 0.948321, loss_ss: 0.748809, loss_d: 0.199512
0.1538 --- loss: 0.881840, loss_ss: 0.739028, loss_d: 0.142812
0.1923 --- loss: 1.099587, loss_ss: 0.888188, loss_d: 0.211399
0.2308 --- loss: 1.500750, loss_ss: 0.982207, loss_d: 0.518542
0.2692 --- loss: 1.240822, loss_ss: 0.841124, loss_d: 0.399698
0.3077 --- loss: 0.945920, loss_ss: 0.683372, loss_d: 0.262548
0.3462 --- loss: 0.916931, loss_ss: 0.521026, loss_d: 0.395905
0.3846 --- loss: 1.018800, loss_ss: 0.711095, loss_d: 0.307705
0.4231 --- loss: 0.688544, loss_ss: 0.599497, loss_d: 0.089047
0.4615 --- loss: 1.483734, loss_ss: 1.042838, loss_d: 0.440895
0.5000 --- loss: 0.871256, loss_ss: 0.720249, loss_d: 0.151007
0.5385 --- loss: 1.132822, loss_ss: 0.710690, loss_d: 0.422132
0.5769 --- loss: 1.198956, loss_ss: 0.857168, loss_d: 0.341788
0.6154 --- loss: 1.124229, loss_ss: 0.937132, loss_d: 0.187098
0.6538 --- loss: 1.094530, loss_ss: 0.997409, loss_d: 0.097121
0.6923 --- loss: 1.541812, loss_ss: 0.647902, loss_d: 0.893910
0.7308 --- loss: 1.074534, loss_ss: 0.903128, loss_d: 0.171406
0.7692 --- loss: 1.338489, loss_ss: 1.077068, loss_d: 0.261421
0.8077 --- loss: 1.117721, loss_ss: 0.918912, loss_d: 0.198808
0.8462 --- loss: 1.103040, loss_ss: 0.877697, loss_d: 0.225343
0.8846 --- loss: 1.698094, loss_ss: 0.805355, loss_d: 0.892740
0.9231 --- loss: 0.864529, loss_ss: 0.760199, loss_d: 0.104330
0.9615 --- loss: 1.935156, loss_ss: 0.743361, loss_d: 1.191795
Epoch finished! Loss: 1.1447057321264937
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6754385964912281
             precision    recall  f1-score   support

        0.0       0.27      0.79      0.40        67
        1.0       0.74      0.23      0.35       281
        2.0       0.82      0.78      0.80       335
        3.0       0.99      0.82      0.90       264
        4.0       0.56      0.92      0.69       193

avg / total       0.76      0.68      0.67      1140
 


====== chp015-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.88  79.10   86.30  26.50     39.70
1  79.04  22.78   97.44  74.42     34.88
2  88.33  77.61   92.80  81.76     79.63
3  95.61  81.82   99.77  99.08     89.63
4  86.23  91.71   85.11  55.66     69.28
Total accuracy: 67.54%
Average sen: 70.60%
Average spec: 92.28%
Macro f1-score: 62.62%
Diagnosis acc on 15mins: 0.3157894736842105
[0.56429005 0.20536125 0.23726971 0.25863275 0.34813151 0.31115606
 0.28306556 0.18428135 0.23377249 0.13918713 0.29322335 0.79158372
 0.55170846 0.47902849 0.26025289 0.32477441 0.32929292 0.67309624
 0.91364938 0.40377957 0.31717962 0.55032903 0.19224359 0.78639936
 0.64216697 0.86276555 0.19680232 0.27039766 0.30652401 0.34196734
 0.27338135 0.17799434 0.27693689 0.44102436 0.82733047 0.45833057
 0.8784464  0.73621714]
pred: 0.4295256388814826, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp016-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.427778, loss_ss: 1.662956, loss_d: 0.764822
0.0385 --- loss: 2.087144, loss_ss: 1.436038, loss_d: 0.651106
0.0770 --- loss: 2.322072, loss_ss: 1.467504, loss_d: 0.854568
0.1156 --- loss: 1.896390, loss_ss: 1.603531, loss_d: 0.292859
0.1541 --- loss: 1.910652, loss_ss: 1.394344, loss_d: 0.516309
0.1926 --- loss: 2.134921, loss_ss: 1.494393, loss_d: 0.640529
0.2311 --- loss: 1.973787, loss_ss: 1.155075, loss_d: 0.818712
0.2696 --- loss: 1.920468, loss_ss: 1.209951, loss_d: 0.710517
0.3082 --- loss: 2.104913, loss_ss: 1.427346, loss_d: 0.677567
0.3467 --- loss: 1.859919, loss_ss: 1.221109, loss_d: 0.638810
0.3852 --- loss: 1.828131, loss_ss: 1.136809, loss_d: 0.691322
0.4237 --- loss: 1.893330, loss_ss: 1.173449, loss_d: 0.719881
0.4622 --- loss: 1.888758, loss_ss: 1.260169, loss_d: 0.628589
0.5008 --- loss: 1.763449, loss_ss: 1.198117, loss_d: 0.565332
0.5393 --- loss: 1.871995, loss_ss: 1.224965, loss_d: 0.647030
0.5778 --- loss: 1.772860, loss_ss: 1.087422, loss_d: 0.685438
0.6163 --- loss: 1.654691, loss_ss: 1.187284, loss_d: 0.467406
0.6549 --- loss: 1.913689, loss_ss: 1.288178, loss_d: 0.625511
0.6934 --- loss: 1.863806, loss_ss: 1.340810, loss_d: 0.522996
0.7319 --- loss: 1.639949, loss_ss: 0.942499, loss_d: 0.697450
0.7704 --- loss: 1.635690, loss_ss: 1.279760, loss_d: 0.355930
0.8089 --- loss: 1.534250, loss_ss: 1.202423, loss_d: 0.331827
0.8475 --- loss: 1.578037, loss_ss: 1.113891, loss_d: 0.464145
0.8860 --- loss: 1.653862, loss_ss: 1.400320, loss_d: 0.253542
0.9245 --- loss: 1.770421, loss_ss: 1.174868, loss_d: 0.595552
0.9630 --- loss: 1.642767, loss_ss: 0.910283, loss_d: 0.732484
Epoch finished! Loss: 1.864253510379423
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.485305, loss_ss: 0.968338, loss_d: 0.516967
0.0385 --- loss: 1.842889, loss_ss: 1.282105, loss_d: 0.560784
0.0770 --- loss: 1.527454, loss_ss: 0.981399, loss_d: 0.546055
0.1156 --- loss: 1.741012, loss_ss: 1.044070, loss_d: 0.696942
0.1541 --- loss: 1.790739, loss_ss: 1.181001, loss_d: 0.609739
0.1926 --- loss: 1.421564, loss_ss: 1.080388, loss_d: 0.341176
0.2311 --- loss: 1.457870, loss_ss: 0.907335, loss_d: 0.550535
0.2696 --- loss: 1.446212, loss_ss: 1.072167, loss_d: 0.374045
0.3082 --- loss: 2.139710, loss_ss: 0.858087, loss_d: 1.281623
0.3467 --- loss: 1.864984, loss_ss: 1.164862, loss_d: 0.700122
0.3852 --- loss: 2.070814, loss_ss: 1.403296, loss_d: 0.667518
0.4237 --- loss: 1.745742, loss_ss: 1.033220, loss_d: 0.712521
0.4622 --- loss: 1.849873, loss_ss: 0.966170, loss_d: 0.883703
0.5008 --- loss: 1.616979, loss_ss: 1.116282, loss_d: 0.500697
0.5393 --- loss: 1.414780, loss_ss: 1.087644, loss_d: 0.327137
0.5778 --- loss: 1.717313, loss_ss: 0.936365, loss_d: 0.780948
0.6163 --- loss: 1.325132, loss_ss: 0.882567, loss_d: 0.442565
0.6549 --- loss: 1.359201, loss_ss: 0.961183, loss_d: 0.398017
0.6934 --- loss: 1.982245, loss_ss: 1.235697, loss_d: 0.746548
0.7319 --- loss: 1.279461, loss_ss: 0.818455, loss_d: 0.461006
0.7704 --- loss: 1.503788, loss_ss: 1.067800, loss_d: 0.435988
0.8089 --- loss: 1.417352, loss_ss: 1.040241, loss_d: 0.377111
0.8475 --- loss: 1.578772, loss_ss: 1.003605, loss_d: 0.575167
0.8860 --- loss: 1.414847, loss_ss: 0.849285, loss_d: 0.565562
0.9245 --- loss: 1.380830, loss_ss: 0.900127, loss_d: 0.480703
0.9630 --- loss: 1.650084, loss_ss: 1.024536, loss_d: 0.625548
Epoch finished! Loss: 1.6258491622895348
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.643777, loss_ss: 1.023408, loss_d: 0.620369
0.0385 --- loss: 1.675890, loss_ss: 1.164582, loss_d: 0.511308
0.0770 --- loss: 1.796405, loss_ss: 0.915333, loss_d: 0.881072
0.1156 --- loss: 1.563026, loss_ss: 0.913768, loss_d: 0.649258
0.1541 --- loss: 1.482805, loss_ss: 0.835981, loss_d: 0.646824
0.1926 --- loss: 1.459257, loss_ss: 0.816954, loss_d: 0.642303
0.2311 --- loss: 1.633083, loss_ss: 1.047506, loss_d: 0.585577
0.2696 --- loss: 1.433477, loss_ss: 0.914283, loss_d: 0.519194
0.3082 --- loss: 2.022603, loss_ss: 1.342315, loss_d: 0.680288
0.3467 --- loss: 2.230343, loss_ss: 1.327618, loss_d: 0.902724
0.3852 --- loss: 1.398446, loss_ss: 0.961922, loss_d: 0.436524
0.4237 --- loss: 1.599609, loss_ss: 0.920217, loss_d: 0.679392
0.4622 --- loss: 1.282816, loss_ss: 1.026237, loss_d: 0.256579
0.5008 --- loss: 1.534333, loss_ss: 0.916227, loss_d: 0.618107
0.5393 --- loss: 1.499529, loss_ss: 0.986373, loss_d: 0.513156
0.5778 --- loss: 1.495209, loss_ss: 1.189028, loss_d: 0.306181
0.6163 --- loss: 1.274957, loss_ss: 0.924573, loss_d: 0.350384
0.6549 --- loss: 1.860226, loss_ss: 1.213900, loss_d: 0.646326
0.6934 --- loss: 1.359037, loss_ss: 1.041433, loss_d: 0.317604
0.7319 --- loss: 1.218315, loss_ss: 0.940650, loss_d: 0.277665
0.7704 --- loss: 1.449915, loss_ss: 1.203452, loss_d: 0.246464
0.8089 --- loss: 1.198068, loss_ss: 0.819531, loss_d: 0.378536
0.8475 --- loss: 1.462122, loss_ss: 1.076829, loss_d: 0.385293
0.8860 --- loss: 1.765176, loss_ss: 1.210510, loss_d: 0.554666
0.9245 --- loss: 1.695730, loss_ss: 1.193414, loss_d: 0.502316
0.9630 --- loss: 1.487683, loss_ss: 0.844536, loss_d: 0.643147
Epoch finished! Loss: 1.5114880017792396
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.123401, loss_ss: 0.743544, loss_d: 0.379857
0.0385 --- loss: 1.668812, loss_ss: 0.931040, loss_d: 0.737772
0.0770 --- loss: 1.620325, loss_ss: 1.233119, loss_d: 0.387206
0.1156 --- loss: 1.797322, loss_ss: 1.069707, loss_d: 0.727615
0.1541 --- loss: 1.835872, loss_ss: 0.967461, loss_d: 0.868411
0.1926 --- loss: 1.148489, loss_ss: 0.945092, loss_d: 0.203397
0.2311 --- loss: 1.558922, loss_ss: 0.964254, loss_d: 0.594668
0.2696 --- loss: 1.375785, loss_ss: 0.895523, loss_d: 0.480262
0.3082 --- loss: 0.999023, loss_ss: 0.798447, loss_d: 0.200577
0.3467 --- loss: 1.087815, loss_ss: 0.865303, loss_d: 0.222511
0.3852 --- loss: 1.057745, loss_ss: 0.787597, loss_d: 0.270149
0.4237 --- loss: 1.463702, loss_ss: 1.049651, loss_d: 0.414051
0.4622 --- loss: 0.937383, loss_ss: 0.668659, loss_d: 0.268724
0.5008 --- loss: 1.252478, loss_ss: 0.788965, loss_d: 0.463513
0.5393 --- loss: 1.166438, loss_ss: 0.729997, loss_d: 0.436441
0.5778 --- loss: 2.013144, loss_ss: 0.824670, loss_d: 1.188474
0.6163 --- loss: 1.809123, loss_ss: 1.145491, loss_d: 0.663633
0.6549 --- loss: 1.299008, loss_ss: 0.860825, loss_d: 0.438183
0.6934 --- loss: 1.287382, loss_ss: 0.752628, loss_d: 0.534754
0.7319 --- loss: 1.789999, loss_ss: 0.887814, loss_d: 0.902185
0.7704 --- loss: 1.478529, loss_ss: 0.870944, loss_d: 0.607584
0.8089 --- loss: 1.625143, loss_ss: 0.996069, loss_d: 0.629074
0.8475 --- loss: 1.528563, loss_ss: 1.184794, loss_d: 0.343770
0.8860 --- loss: 1.327963, loss_ss: 0.823505, loss_d: 0.504459
0.9245 --- loss: 1.744674, loss_ss: 0.903750, loss_d: 0.840925
0.9630 --- loss: 1.356976, loss_ss: 1.071165, loss_d: 0.285811
Epoch finished! Loss: 1.4400513162944308
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.697272, loss_ss: 0.986496, loss_d: 0.710776
0.0385 --- loss: 1.130106, loss_ss: 0.749652, loss_d: 0.380454
0.0770 --- loss: 1.220405, loss_ss: 0.715336, loss_d: 0.505069
0.1156 --- loss: 1.581140, loss_ss: 1.021527, loss_d: 0.559613
0.1541 --- loss: 1.645309, loss_ss: 1.038405, loss_d: 0.606904
0.1926 --- loss: 1.145609, loss_ss: 0.778497, loss_d: 0.367112
0.2311 --- loss: 1.879147, loss_ss: 0.770378, loss_d: 1.108770
0.2696 --- loss: 1.378307, loss_ss: 0.870603, loss_d: 0.507703
0.3082 --- loss: 1.391676, loss_ss: 1.007223, loss_d: 0.384453
0.3467 --- loss: 1.270777, loss_ss: 0.945125, loss_d: 0.325652
0.3852 --- loss: 1.122333, loss_ss: 0.795930, loss_d: 0.326403
0.4237 --- loss: 1.636606, loss_ss: 1.119927, loss_d: 0.516679
0.4622 --- loss: 0.856665, loss_ss: 0.627126, loss_d: 0.229539
0.5008 --- loss: 1.541963, loss_ss: 0.811251, loss_d: 0.730712
0.5393 --- loss: 1.417537, loss_ss: 0.964665, loss_d: 0.452872
0.5778 --- loss: 0.989978, loss_ss: 0.757394, loss_d: 0.232583
0.6163 --- loss: 1.457819, loss_ss: 1.075014, loss_d: 0.382804
0.6549 --- loss: 1.244049, loss_ss: 0.758500, loss_d: 0.485549
0.6934 --- loss: 1.329936, loss_ss: 0.953263, loss_d: 0.376672
0.7319 --- loss: 1.294937, loss_ss: 0.791596, loss_d: 0.503341
0.7704 --- loss: 1.100130, loss_ss: 0.944426, loss_d: 0.155704
0.8089 --- loss: 1.231682, loss_ss: 0.802385, loss_d: 0.429297
0.8475 --- loss: 1.431328, loss_ss: 0.970269, loss_d: 0.461059
0.8860 --- loss: 1.030752, loss_ss: 0.716936, loss_d: 0.313816
0.9245 --- loss: 0.953874, loss_ss: 0.512092, loss_d: 0.441782
0.9630 --- loss: 1.262095, loss_ss: 0.673284, loss_d: 0.588811
Epoch finished! Loss: 1.4069230662349568
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.107339, loss_ss: 0.809320, loss_d: 0.298020
0.0385 --- loss: 1.657575, loss_ss: 0.903741, loss_d: 0.753834
0.0770 --- loss: 1.028895, loss_ss: 0.839391, loss_d: 0.189505
0.1156 --- loss: 1.097181, loss_ss: 0.741271, loss_d: 0.355909
0.1541 --- loss: 1.297619, loss_ss: 0.925681, loss_d: 0.371938
0.1926 --- loss: 1.544865, loss_ss: 0.871173, loss_d: 0.673692
0.2311 --- loss: 0.974203, loss_ss: 0.787990, loss_d: 0.186212
0.2696 --- loss: 1.655080, loss_ss: 1.126496, loss_d: 0.528583
0.3082 --- loss: 1.133130, loss_ss: 0.949362, loss_d: 0.183768
0.3467 --- loss: 1.258436, loss_ss: 0.932015, loss_d: 0.326421
0.3852 --- loss: 0.972330, loss_ss: 0.713512, loss_d: 0.258818
0.4237 --- loss: 1.440926, loss_ss: 0.971914, loss_d: 0.469013
0.4622 --- loss: 1.354800, loss_ss: 0.874329, loss_d: 0.480471
0.5008 --- loss: 1.465239, loss_ss: 0.981160, loss_d: 0.484079
0.5393 --- loss: 1.353350, loss_ss: 0.897929, loss_d: 0.455421
0.5778 --- loss: 1.221634, loss_ss: 0.868499, loss_d: 0.353135
0.6163 --- loss: 1.511038, loss_ss: 1.175290, loss_d: 0.335749
0.6549 --- loss: 1.253823, loss_ss: 0.727741, loss_d: 0.526082
0.6934 --- loss: 0.977948, loss_ss: 0.752302, loss_d: 0.225646
0.7319 --- loss: 1.740920, loss_ss: 1.411991, loss_d: 0.328929
0.7704 --- loss: 1.150676, loss_ss: 0.762608, loss_d: 0.388069
0.8089 --- loss: 1.385853, loss_ss: 0.831355, loss_d: 0.554497
0.8475 --- loss: 1.281948, loss_ss: 0.814703, loss_d: 0.467245
0.8860 --- loss: 1.175703, loss_ss: 0.904907, loss_d: 0.270795
0.9245 --- loss: 0.872430, loss_ss: 0.624627, loss_d: 0.247804
0.9630 --- loss: 0.974522, loss_ss: 0.796150, loss_d: 0.178372
Epoch finished! Loss: 1.3442070907607502
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.357018, loss_ss: 1.011058, loss_d: 0.345960
0.0385 --- loss: 1.045092, loss_ss: 0.784804, loss_d: 0.260288
0.0770 --- loss: 1.331763, loss_ss: 0.912667, loss_d: 0.419096
0.1156 --- loss: 1.979495, loss_ss: 0.997281, loss_d: 0.982214
0.1541 --- loss: 0.857044, loss_ss: 0.681753, loss_d: 0.175292
0.1926 --- loss: 0.990807, loss_ss: 0.722740, loss_d: 0.268066
0.2311 --- loss: 1.608968, loss_ss: 0.920176, loss_d: 0.688793
0.2696 --- loss: 1.170061, loss_ss: 0.983088, loss_d: 0.186972
0.3082 --- loss: 1.539994, loss_ss: 0.868603, loss_d: 0.671390
0.3467 --- loss: 1.323539, loss_ss: 0.792344, loss_d: 0.531195
0.3852 --- loss: 1.192443, loss_ss: 0.916942, loss_d: 0.275501
0.4237 --- loss: 1.143789, loss_ss: 0.581356, loss_d: 0.562433
0.4622 --- loss: 1.161266, loss_ss: 0.826397, loss_d: 0.334869
0.5008 --- loss: 1.477757, loss_ss: 1.036051, loss_d: 0.441706
0.5393 --- loss: 2.177068, loss_ss: 0.744247, loss_d: 1.432821
0.5778 --- loss: 1.082186, loss_ss: 0.713606, loss_d: 0.368580
0.6163 --- loss: 1.591447, loss_ss: 1.081520, loss_d: 0.509927
0.6549 --- loss: 1.261767, loss_ss: 0.917413, loss_d: 0.344354
0.6934 --- loss: 1.310340, loss_ss: 0.993427, loss_d: 0.316913
0.7319 --- loss: 1.031085, loss_ss: 0.754381, loss_d: 0.276704
0.7704 --- loss: 0.743184, loss_ss: 0.605005, loss_d: 0.138178
0.8089 --- loss: 0.926633, loss_ss: 0.692818, loss_d: 0.233816
0.8475 --- loss: 1.159737, loss_ss: 1.007125, loss_d: 0.152612
0.8860 --- loss: 1.462808, loss_ss: 0.868560, loss_d: 0.594248
0.9245 --- loss: 0.966207, loss_ss: 0.600947, loss_d: 0.365260
0.9630 --- loss: 1.378638, loss_ss: 0.944342, loss_d: 0.434296
Epoch finished! Loss: 1.2687757643493447
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.879510, loss_ss: 0.646603, loss_d: 0.232907
0.0385 --- loss: 1.138710, loss_ss: 0.720110, loss_d: 0.418600
0.0770 --- loss: 1.719010, loss_ss: 1.158293, loss_d: 0.560717
0.1156 --- loss: 0.919044, loss_ss: 0.675852, loss_d: 0.243192
0.1541 --- loss: 1.075872, loss_ss: 0.780948, loss_d: 0.294925
0.1926 --- loss: 1.283147, loss_ss: 0.931691, loss_d: 0.351456
0.2311 --- loss: 1.308351, loss_ss: 0.742058, loss_d: 0.566293
0.2696 --- loss: 1.033985, loss_ss: 0.787330, loss_d: 0.246654
0.3082 --- loss: 1.272189, loss_ss: 1.083952, loss_d: 0.188237
0.3467 --- loss: 1.422195, loss_ss: 0.899901, loss_d: 0.522294
0.3852 --- loss: 0.833468, loss_ss: 0.719160, loss_d: 0.114309
0.4237 --- loss: 1.374274, loss_ss: 1.067308, loss_d: 0.306965
0.4622 --- loss: 1.472776, loss_ss: 1.134514, loss_d: 0.338262
0.5008 --- loss: 1.331906, loss_ss: 0.899330, loss_d: 0.432576
0.5393 --- loss: 1.246654, loss_ss: 1.108003, loss_d: 0.138651
0.5778 --- loss: 1.107167, loss_ss: 0.905857, loss_d: 0.201310
0.6163 --- loss: 1.146902, loss_ss: 0.945643, loss_d: 0.201259
0.6549 --- loss: 1.211276, loss_ss: 0.609900, loss_d: 0.601376
0.6934 --- loss: 1.023682, loss_ss: 0.699540, loss_d: 0.324142
0.7319 --- loss: 1.253162, loss_ss: 0.845025, loss_d: 0.408137
0.7704 --- loss: 1.040087, loss_ss: 0.729761, loss_d: 0.310326
0.8089 --- loss: 1.426878, loss_ss: 0.970922, loss_d: 0.455956
0.8475 --- loss: 1.198756, loss_ss: 1.012850, loss_d: 0.185906
0.8860 --- loss: 1.072655, loss_ss: 0.759323, loss_d: 0.313332
0.9245 --- loss: 1.385450, loss_ss: 0.981665, loss_d: 0.403785
0.9630 --- loss: 1.185437, loss_ss: 0.787674, loss_d: 0.397763
Epoch finished! Loss: 1.2342544264774986
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.677227, loss_ss: 0.827224, loss_d: 0.850003
0.0385 --- loss: 0.729686, loss_ss: 0.580366, loss_d: 0.149320
0.0770 --- loss: 0.913255, loss_ss: 0.691120, loss_d: 0.222135
0.1156 --- loss: 0.879894, loss_ss: 0.682803, loss_d: 0.197092
0.1541 --- loss: 1.792206, loss_ss: 1.288351, loss_d: 0.503855
0.1926 --- loss: 0.913453, loss_ss: 0.613751, loss_d: 0.299701
0.2311 --- loss: 1.049459, loss_ss: 0.793906, loss_d: 0.255553
0.2696 --- loss: 1.720478, loss_ss: 1.048518, loss_d: 0.671960
0.3082 --- loss: 1.227696, loss_ss: 0.832043, loss_d: 0.395652
0.3467 --- loss: 1.114139, loss_ss: 0.918987, loss_d: 0.195153
0.3852 --- loss: 1.002056, loss_ss: 0.721355, loss_d: 0.280701
0.4237 --- loss: 1.503677, loss_ss: 1.250581, loss_d: 0.253097
0.4622 --- loss: 1.167445, loss_ss: 0.922101, loss_d: 0.245345
0.5008 --- loss: 1.227243, loss_ss: 0.985844, loss_d: 0.241399
0.5393 --- loss: 1.846318, loss_ss: 0.876671, loss_d: 0.969648
0.5778 --- loss: 0.849681, loss_ss: 0.652280, loss_d: 0.197401
0.6163 --- loss: 1.266653, loss_ss: 0.713281, loss_d: 0.553372
0.6549 --- loss: 1.184319, loss_ss: 0.777715, loss_d: 0.406605
0.6934 --- loss: 1.414461, loss_ss: 1.052855, loss_d: 0.361606
0.7319 --- loss: 0.907947, loss_ss: 0.686283, loss_d: 0.221664
0.7704 --- loss: 1.450883, loss_ss: 0.763148, loss_d: 0.687734
0.8089 --- loss: 1.559274, loss_ss: 0.889334, loss_d: 0.669939
0.8475 --- loss: 1.188574, loss_ss: 0.994941, loss_d: 0.193633
0.8860 --- loss: 1.209111, loss_ss: 0.852476, loss_d: 0.356635
0.9245 --- loss: 1.189149, loss_ss: 0.974040, loss_d: 0.215109
0.9630 --- loss: 1.353173, loss_ss: 0.842435, loss_d: 0.510738
Epoch finished! Loss: 1.227266890662057
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.237609, loss_ss: 0.769923, loss_d: 0.467686
0.0385 --- loss: 1.155129, loss_ss: 0.926916, loss_d: 0.228213
0.0770 --- loss: 1.006850, loss_ss: 0.810251, loss_d: 0.196599
0.1156 --- loss: 0.907036, loss_ss: 0.741256, loss_d: 0.165780
0.1541 --- loss: 0.930260, loss_ss: 0.575776, loss_d: 0.354484
0.1926 --- loss: 1.326263, loss_ss: 1.101450, loss_d: 0.224813
0.2311 --- loss: 1.263031, loss_ss: 0.779093, loss_d: 0.483938
0.2696 --- loss: 1.141202, loss_ss: 0.885741, loss_d: 0.255461
0.3082 --- loss: 0.945780, loss_ss: 0.717852, loss_d: 0.227928
0.3467 --- loss: 1.066088, loss_ss: 0.699311, loss_d: 0.366778
0.3852 --- loss: 1.113389, loss_ss: 0.975455, loss_d: 0.137935
0.4237 --- loss: 0.873364, loss_ss: 0.686308, loss_d: 0.187056
0.4622 --- loss: 1.617805, loss_ss: 1.067505, loss_d: 0.550300
0.5008 --- loss: 1.070137, loss_ss: 0.825517, loss_d: 0.244620
0.5393 --- loss: 1.363607, loss_ss: 1.019994, loss_d: 0.343613
0.5778 --- loss: 1.046296, loss_ss: 0.778740, loss_d: 0.267555
0.6163 --- loss: 1.324278, loss_ss: 0.995495, loss_d: 0.328783
0.6549 --- loss: 1.221862, loss_ss: 0.826230, loss_d: 0.395631
0.6934 --- loss: 1.464622, loss_ss: 1.140598, loss_d: 0.324024
0.7319 --- loss: 1.118370, loss_ss: 0.994023, loss_d: 0.124348
0.7704 --- loss: 1.016451, loss_ss: 0.786830, loss_d: 0.229622
0.8089 --- loss: 1.054791, loss_ss: 0.942654, loss_d: 0.112138
0.8475 --- loss: 1.022534, loss_ss: 0.894903, loss_d: 0.127631
0.8860 --- loss: 1.299193, loss_ss: 1.127722, loss_d: 0.171471
0.9245 --- loss: 1.089319, loss_ss: 0.863456, loss_d: 0.225864
0.9630 --- loss: 1.286224, loss_ss: 0.921497, loss_d: 0.364727
Epoch finished! Loss: 1.179666586364098
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6865079365079365
             precision    recall  f1-score   support

        0.0       0.98      0.82      0.89       297
        1.0       0.79      0.11      0.19       289
        2.0       0.47      0.96      0.63       330
        3.0       0.92      0.90      0.91       133
        4.0       0.91      0.73      0.81       211

avg / total       0.78      0.69      0.65      1260
 


====== chp016-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.24  81.82   99.38  97.59     89.01
1  78.89  10.73   99.18  79.49     18.90
2  70.79  95.76   61.94  47.16     63.20
3  98.10  90.23   99.02  91.60     90.91
4  94.29  73.46   98.47  90.64     81.15
Total accuracy: 68.65%
Average sen: 70.40%
Average spec: 91.60%
Macro f1-score: 68.63%
Diagnosis acc on 15mins: 1.0
[0.94574779 0.67205983 0.98989046 0.9469322  0.97993016 0.8098076
 0.98895848 0.99305552 0.99881846 0.99524176 0.99643421 0.99628603
 0.98378974 0.66050345 0.99590081 0.9955675  0.99609935 0.96162283
 0.94967782 0.99881566 0.99162489 0.9840678  0.86106068 0.77907133
 0.89438987 0.93979275 0.74151212 0.87381977 0.99429977 0.72839224
 0.99727601 0.99759775 0.99520314 0.99724019 0.86109561 0.70726234
 0.99210042 0.99561346 0.98807573 0.95367855 0.50763041 0.70801306]
pred: 0.9129513700803121, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp017-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.354035, loss_ss: 1.709564, loss_d: 0.644471
0.0384 --- loss: 2.416583, loss_ss: 1.505352, loss_d: 0.911231
0.0768 --- loss: 2.291064, loss_ss: 1.631314, loss_d: 0.659750
0.1152 --- loss: 2.112107, loss_ss: 1.528450, loss_d: 0.583657
0.1536 --- loss: 1.650861, loss_ss: 1.259248, loss_d: 0.391613
0.1919 --- loss: 2.019365, loss_ss: 1.331624, loss_d: 0.687741
0.2303 --- loss: 1.965206, loss_ss: 1.253224, loss_d: 0.711981
0.2687 --- loss: 1.805902, loss_ss: 1.303636, loss_d: 0.502266
0.3071 --- loss: 2.122341, loss_ss: 1.511272, loss_d: 0.611070
0.3455 --- loss: 1.865323, loss_ss: 1.242442, loss_d: 0.622881
0.3839 --- loss: 1.860454, loss_ss: 1.268255, loss_d: 0.592199
0.4223 --- loss: 1.756145, loss_ss: 1.283029, loss_d: 0.473117
0.4607 --- loss: 1.817454, loss_ss: 1.299042, loss_d: 0.518412
0.4990 --- loss: 1.772624, loss_ss: 1.263633, loss_d: 0.508991
0.5374 --- loss: 1.622544, loss_ss: 1.122985, loss_d: 0.499559
0.5758 --- loss: 1.635739, loss_ss: 1.069497, loss_d: 0.566242
0.6142 --- loss: 1.650788, loss_ss: 1.141688, loss_d: 0.509100
0.6526 --- loss: 1.958382, loss_ss: 1.352407, loss_d: 0.605975
0.6910 --- loss: 1.683102, loss_ss: 1.137312, loss_d: 0.545790
0.7294 --- loss: 1.844639, loss_ss: 1.134945, loss_d: 0.709694
0.7678 --- loss: 1.944663, loss_ss: 1.342111, loss_d: 0.602552
0.8061 --- loss: 1.834506, loss_ss: 1.181814, loss_d: 0.652692
0.8445 --- loss: 1.501816, loss_ss: 1.126331, loss_d: 0.375485
0.8829 --- loss: 1.538871, loss_ss: 0.951918, loss_d: 0.586953
0.9213 --- loss: 1.743626, loss_ss: 1.047019, loss_d: 0.696607
0.9597 --- loss: 1.909554, loss_ss: 1.179675, loss_d: 0.729879
0.9981 --- loss: 2.044887, loss_ss: 1.031257, loss_d: 1.013631
Epoch finished! Loss: 1.8699343131138728
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.971054, loss_ss: 1.096489, loss_d: 0.874566
0.0384 --- loss: 1.726832, loss_ss: 1.133174, loss_d: 0.593658
0.0768 --- loss: 1.786863, loss_ss: 1.021912, loss_d: 0.764951
0.1152 --- loss: 1.250296, loss_ss: 0.851731, loss_d: 0.398565
0.1536 --- loss: 1.653870, loss_ss: 0.857212, loss_d: 0.796658
0.1919 --- loss: 1.610139, loss_ss: 1.000951, loss_d: 0.609187
0.2303 --- loss: 1.489096, loss_ss: 0.992195, loss_d: 0.496902
0.2687 --- loss: 1.464406, loss_ss: 0.859641, loss_d: 0.604765
0.3071 --- loss: 1.590892, loss_ss: 0.924718, loss_d: 0.666174
0.3455 --- loss: 1.844254, loss_ss: 0.911245, loss_d: 0.933009
0.3839 --- loss: 1.676597, loss_ss: 0.992940, loss_d: 0.683657
0.4223 --- loss: 1.879715, loss_ss: 1.225429, loss_d: 0.654286
0.4607 --- loss: 1.639704, loss_ss: 0.993308, loss_d: 0.646396
0.4990 --- loss: 1.584858, loss_ss: 1.154942, loss_d: 0.429916
0.5374 --- loss: 1.963920, loss_ss: 1.256240, loss_d: 0.707680
0.5758 --- loss: 2.027257, loss_ss: 1.271285, loss_d: 0.755973
0.6142 --- loss: 1.710048, loss_ss: 0.986787, loss_d: 0.723261
0.6526 --- loss: 1.632686, loss_ss: 1.108201, loss_d: 0.524485
0.6910 --- loss: 1.735280, loss_ss: 1.256398, loss_d: 0.478882
0.7294 --- loss: 2.009396, loss_ss: 1.364512, loss_d: 0.644884
0.7678 --- loss: 1.906392, loss_ss: 1.320311, loss_d: 0.586081
0.8061 --- loss: 1.619838, loss_ss: 0.947630, loss_d: 0.672209
0.8445 --- loss: 1.493085, loss_ss: 1.047757, loss_d: 0.445328
0.8829 --- loss: 1.791711, loss_ss: 1.364871, loss_d: 0.426840
0.9213 --- loss: 2.052365, loss_ss: 1.390167, loss_d: 0.662198
0.9597 --- loss: 1.562141, loss_ss: 1.020243, loss_d: 0.541898
0.9981 --- loss: 1.679689, loss_ss: 1.015844, loss_d: 0.663845
Epoch finished! Loss: 1.6765064221162063
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.879619, loss_ss: 1.433173, loss_d: 0.446447
0.0384 --- loss: 1.632250, loss_ss: 0.943745, loss_d: 0.688505
0.0768 --- loss: 1.416994, loss_ss: 0.765116, loss_d: 0.651878
0.1152 --- loss: 1.646737, loss_ss: 0.960904, loss_d: 0.685833
0.1536 --- loss: 1.515119, loss_ss: 1.096441, loss_d: 0.418678
0.1919 --- loss: 1.703763, loss_ss: 1.072568, loss_d: 0.631195
0.2303 --- loss: 2.235288, loss_ss: 1.491175, loss_d: 0.744113
0.2687 --- loss: 1.537858, loss_ss: 0.976196, loss_d: 0.561662
0.3071 --- loss: 1.711252, loss_ss: 0.984823, loss_d: 0.726430
0.3455 --- loss: 1.597023, loss_ss: 1.075569, loss_d: 0.521454
0.3839 --- loss: 1.164569, loss_ss: 0.894996, loss_d: 0.269572
0.4223 --- loss: 1.663942, loss_ss: 1.056932, loss_d: 0.607010
0.4607 --- loss: 1.657665, loss_ss: 0.913285, loss_d: 0.744380
0.4990 --- loss: 1.854850, loss_ss: 1.276476, loss_d: 0.578375
0.5374 --- loss: 1.486565, loss_ss: 0.978235, loss_d: 0.508329
0.5758 --- loss: 1.463139, loss_ss: 0.919153, loss_d: 0.543986
0.6142 --- loss: 1.268535, loss_ss: 0.858349, loss_d: 0.410187
0.6526 --- loss: 2.028277, loss_ss: 1.032773, loss_d: 0.995504
0.6910 --- loss: 1.818744, loss_ss: 1.323680, loss_d: 0.495064
0.7294 --- loss: 1.556852, loss_ss: 1.141489, loss_d: 0.415364
0.7678 --- loss: 1.589578, loss_ss: 1.189727, loss_d: 0.399852
0.8061 --- loss: 1.334439, loss_ss: 0.729392, loss_d: 0.605047
0.8445 --- loss: 1.684161, loss_ss: 1.153103, loss_d: 0.531058
0.8829 --- loss: 0.996883, loss_ss: 0.742440, loss_d: 0.254443
0.9213 --- loss: 1.103209, loss_ss: 0.865287, loss_d: 0.237922
0.9597 --- loss: 1.812973, loss_ss: 1.395819, loss_d: 0.417154
0.9981 --- loss: 1.830375, loss_ss: 1.174672, loss_d: 0.655703
Epoch finished! Loss: 1.5652936541117155
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.372676, loss_ss: 0.834148, loss_d: 0.538529
0.0384 --- loss: 1.245224, loss_ss: 0.856747, loss_d: 0.388477
0.0768 --- loss: 1.525146, loss_ss: 0.948129, loss_d: 0.577017
0.1152 --- loss: 1.403364, loss_ss: 1.007888, loss_d: 0.395477
0.1536 --- loss: 1.706681, loss_ss: 1.125507, loss_d: 0.581174
0.1919 --- loss: 1.331127, loss_ss: 1.035566, loss_d: 0.295561
0.2303 --- loss: 1.805305, loss_ss: 0.867447, loss_d: 0.937857
0.2687 --- loss: 1.966556, loss_ss: 1.251152, loss_d: 0.715404
0.3071 --- loss: 1.249187, loss_ss: 0.950400, loss_d: 0.298787
0.3455 --- loss: 1.492364, loss_ss: 0.794937, loss_d: 0.697427
0.3839 --- loss: 1.416339, loss_ss: 0.866670, loss_d: 0.549668
0.4223 --- loss: 1.600802, loss_ss: 1.245989, loss_d: 0.354813
0.4607 --- loss: 1.265676, loss_ss: 1.026187, loss_d: 0.239489
0.4990 --- loss: 1.204886, loss_ss: 0.766695, loss_d: 0.438191
0.5374 --- loss: 1.688246, loss_ss: 0.989542, loss_d: 0.698703
0.5758 --- loss: 1.356653, loss_ss: 0.822446, loss_d: 0.534207
0.6142 --- loss: 1.373186, loss_ss: 0.822046, loss_d: 0.551140
0.6526 --- loss: 1.771343, loss_ss: 1.051071, loss_d: 0.720273
0.6910 --- loss: 1.378290, loss_ss: 0.801365, loss_d: 0.576925
0.7294 --- loss: 1.862562, loss_ss: 1.326739, loss_d: 0.535823
0.7678 --- loss: 1.295203, loss_ss: 0.809395, loss_d: 0.485808
0.8061 --- loss: 1.645191, loss_ss: 1.063760, loss_d: 0.581431
0.8445 --- loss: 1.401131, loss_ss: 1.189376, loss_d: 0.211755
0.8829 --- loss: 2.079470, loss_ss: 1.102239, loss_d: 0.977231
0.9213 --- loss: 1.128145, loss_ss: 0.855094, loss_d: 0.273051
0.9597 --- loss: 1.396716, loss_ss: 0.920145, loss_d: 0.476571
0.9981 --- loss: 1.656359, loss_ss: 1.250929, loss_d: 0.405430
Epoch finished! Loss: 1.4508886406054864
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.712375, loss_ss: 0.916493, loss_d: 0.795882
0.0384 --- loss: 1.304379, loss_ss: 0.896819, loss_d: 0.407559
0.0768 --- loss: 1.016565, loss_ss: 0.732794, loss_d: 0.283771
0.1152 --- loss: 1.544742, loss_ss: 1.017987, loss_d: 0.526755
0.1536 --- loss: 1.787158, loss_ss: 1.156482, loss_d: 0.630676
0.1919 --- loss: 1.467405, loss_ss: 0.973639, loss_d: 0.493766
0.2303 --- loss: 1.260291, loss_ss: 0.784079, loss_d: 0.476212
0.2687 --- loss: 1.379619, loss_ss: 1.027350, loss_d: 0.352269
0.3071 --- loss: 1.236247, loss_ss: 0.753371, loss_d: 0.482876
0.3455 --- loss: 1.344497, loss_ss: 0.884560, loss_d: 0.459937
0.3839 --- loss: 1.212441, loss_ss: 0.962589, loss_d: 0.249852
0.4223 --- loss: 1.473155, loss_ss: 0.865092, loss_d: 0.608062
0.4607 --- loss: 1.457173, loss_ss: 0.827418, loss_d: 0.629754
0.4990 --- loss: 1.387143, loss_ss: 1.221096, loss_d: 0.166047
0.5374 --- loss: 1.199682, loss_ss: 0.980965, loss_d: 0.218716
0.5758 --- loss: 1.225972, loss_ss: 0.857470, loss_d: 0.368502
0.6142 --- loss: 1.121557, loss_ss: 0.786706, loss_d: 0.334850
0.6526 --- loss: 1.555257, loss_ss: 1.212816, loss_d: 0.342441
0.6910 --- loss: 1.196066, loss_ss: 0.998760, loss_d: 0.197307
0.7294 --- loss: 1.330581, loss_ss: 0.985291, loss_d: 0.345290
0.7678 --- loss: 1.017494, loss_ss: 0.599851, loss_d: 0.417643
0.8061 --- loss: 1.367311, loss_ss: 0.730436, loss_d: 0.636875
0.8445 --- loss: 1.103990, loss_ss: 0.804586, loss_d: 0.299404
0.8829 --- loss: 1.720551, loss_ss: 0.740576, loss_d: 0.979975
0.9213 --- loss: 1.244818, loss_ss: 0.747513, loss_d: 0.497305
0.9597 --- loss: 1.523140, loss_ss: 1.221035, loss_d: 0.302105
0.9981 --- loss: 1.464112, loss_ss: 1.029532, loss_d: 0.434580
Epoch finished! Loss: 1.369325633920156
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.922714, loss_ss: 0.636388, loss_d: 0.286326
0.0384 --- loss: 1.003721, loss_ss: 0.668238, loss_d: 0.335483
0.0768 --- loss: 0.995016, loss_ss: 0.881312, loss_d: 0.113705
0.1152 --- loss: 1.426874, loss_ss: 0.987885, loss_d: 0.438990
0.1536 --- loss: 1.172952, loss_ss: 0.773591, loss_d: 0.399361
0.1919 --- loss: 1.298537, loss_ss: 0.879642, loss_d: 0.418895
0.2303 --- loss: 1.392744, loss_ss: 0.760590, loss_d: 0.632154
0.2687 --- loss: 1.252003, loss_ss: 0.816012, loss_d: 0.435990
0.3071 --- loss: 1.050522, loss_ss: 0.699840, loss_d: 0.350681
0.3455 --- loss: 1.270079, loss_ss: 0.811293, loss_d: 0.458786
0.3839 --- loss: 1.419121, loss_ss: 1.021124, loss_d: 0.397997
0.4223 --- loss: 1.116616, loss_ss: 0.809229, loss_d: 0.307386
0.4607 --- loss: 1.557528, loss_ss: 1.016924, loss_d: 0.540604
0.4990 --- loss: 1.544440, loss_ss: 1.165812, loss_d: 0.378628
0.5374 --- loss: 1.340738, loss_ss: 1.032285, loss_d: 0.308453
0.5758 --- loss: 1.086014, loss_ss: 0.871604, loss_d: 0.214410
0.6142 --- loss: 1.102034, loss_ss: 0.805995, loss_d: 0.296039
0.6526 --- loss: 1.050129, loss_ss: 0.931166, loss_d: 0.118963
0.6910 --- loss: 1.043448, loss_ss: 0.889298, loss_d: 0.154150
0.7294 --- loss: 0.914821, loss_ss: 0.734072, loss_d: 0.180749
0.7678 --- loss: 1.241578, loss_ss: 1.049345, loss_d: 0.192234
0.8061 --- loss: 0.898748, loss_ss: 0.664793, loss_d: 0.233956
0.8445 --- loss: 1.156363, loss_ss: 0.651452, loss_d: 0.504911
0.8829 --- loss: 1.396837, loss_ss: 1.044917, loss_d: 0.351919
0.9213 --- loss: 0.961064, loss_ss: 0.774021, loss_d: 0.187044
0.9597 --- loss: 1.160449, loss_ss: 0.978168, loss_d: 0.182281
0.9981 --- loss: 0.812379, loss_ss: 0.715368, loss_d: 0.097012
Epoch finished! Loss: 1.314108565220466
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.863753, loss_ss: 0.757981, loss_d: 0.105772
0.0384 --- loss: 1.032233, loss_ss: 0.915522, loss_d: 0.116710
0.0768 --- loss: 1.963368, loss_ss: 1.349452, loss_d: 0.613917
0.1152 --- loss: 0.994091, loss_ss: 0.851957, loss_d: 0.142134
0.1536 --- loss: 1.066989, loss_ss: 0.671267, loss_d: 0.395722
0.1919 --- loss: 0.999684, loss_ss: 0.786794, loss_d: 0.212890
0.2303 --- loss: 0.953998, loss_ss: 0.695763, loss_d: 0.258236
0.2687 --- loss: 1.325709, loss_ss: 0.986907, loss_d: 0.338802
0.3071 --- loss: 1.246382, loss_ss: 1.067328, loss_d: 0.179054
0.3455 --- loss: 1.380099, loss_ss: 0.762325, loss_d: 0.617774
0.3839 --- loss: 1.251457, loss_ss: 0.899185, loss_d: 0.352272
0.4223 --- loss: 1.167526, loss_ss: 0.942844, loss_d: 0.224682
0.4607 --- loss: 1.282040, loss_ss: 0.908612, loss_d: 0.373428
0.4990 --- loss: 1.684967, loss_ss: 1.081840, loss_d: 0.603127
0.5374 --- loss: 1.330811, loss_ss: 0.965356, loss_d: 0.365456
0.5758 --- loss: 0.995207, loss_ss: 0.733385, loss_d: 0.261822
0.6142 --- loss: 1.014292, loss_ss: 0.881369, loss_d: 0.132923
0.6526 --- loss: 1.512069, loss_ss: 0.873632, loss_d: 0.638436
0.6910 --- loss: 1.286141, loss_ss: 0.940576, loss_d: 0.345565
0.7294 --- loss: 1.102837, loss_ss: 0.863174, loss_d: 0.239663
0.7678 --- loss: 1.024051, loss_ss: 0.874769, loss_d: 0.149282
0.8061 --- loss: 0.982232, loss_ss: 0.870581, loss_d: 0.111651
0.8445 --- loss: 0.860096, loss_ss: 0.709361, loss_d: 0.150735
0.8829 --- loss: 1.201212, loss_ss: 1.002352, loss_d: 0.198860
0.9213 --- loss: 1.199396, loss_ss: 0.978040, loss_d: 0.221356
0.9597 --- loss: 1.284392, loss_ss: 1.008411, loss_d: 0.275981
0.9981 --- loss: 1.655652, loss_ss: 1.088721, loss_d: 0.566931
Epoch finished! Loss: 1.2671757427545693
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.139166, loss_ss: 0.999086, loss_d: 0.140081
0.0384 --- loss: 0.805747, loss_ss: 0.717146, loss_d: 0.088601
0.0768 --- loss: 0.788755, loss_ss: 0.659227, loss_d: 0.129528
0.1152 --- loss: 0.849518, loss_ss: 0.614898, loss_d: 0.234620
0.1536 --- loss: 1.394417, loss_ss: 0.946933, loss_d: 0.447484
0.1919 --- loss: 1.336140, loss_ss: 0.866796, loss_d: 0.469344
0.2303 --- loss: 1.186457, loss_ss: 0.927640, loss_d: 0.258817
0.2687 --- loss: 1.274817, loss_ss: 0.938297, loss_d: 0.336520
0.3071 --- loss: 0.745437, loss_ss: 0.595483, loss_d: 0.149954
0.3455 --- loss: 1.515282, loss_ss: 0.829225, loss_d: 0.686056
0.3839 --- loss: 1.182615, loss_ss: 1.053242, loss_d: 0.129373
0.4223 --- loss: 0.971294, loss_ss: 0.874883, loss_d: 0.096411
0.4607 --- loss: 1.067352, loss_ss: 0.781110, loss_d: 0.286241
0.4990 --- loss: 1.290545, loss_ss: 1.046500, loss_d: 0.244045
0.5374 --- loss: 1.880832, loss_ss: 0.952657, loss_d: 0.928175
0.5758 --- loss: 0.985267, loss_ss: 0.820319, loss_d: 0.164948
0.6142 --- loss: 1.336573, loss_ss: 1.182978, loss_d: 0.153594
0.6526 --- loss: 1.186300, loss_ss: 0.638509, loss_d: 0.547791
0.6910 --- loss: 1.151046, loss_ss: 0.989119, loss_d: 0.161926
0.7294 --- loss: 1.328128, loss_ss: 1.121375, loss_d: 0.206754
0.7678 --- loss: 1.027884, loss_ss: 0.849710, loss_d: 0.178173
0.8061 --- loss: 0.976286, loss_ss: 0.808579, loss_d: 0.167707
0.8445 --- loss: 1.131093, loss_ss: 0.625914, loss_d: 0.505179
0.8829 --- loss: 0.835720, loss_ss: 0.661606, loss_d: 0.174114
0.9213 --- loss: 1.357873, loss_ss: 1.229988, loss_d: 0.127886
0.9597 --- loss: 1.476680, loss_ss: 1.163331, loss_d: 0.313349
0.9981 --- loss: 0.833814, loss_ss: 0.769444, loss_d: 0.064370
Epoch finished! Loss: 1.1762746643561584
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.071640, loss_ss: 0.990331, loss_d: 0.081309
0.0384 --- loss: 1.012535, loss_ss: 0.916608, loss_d: 0.095926
0.0768 --- loss: 1.449976, loss_ss: 1.168139, loss_d: 0.281836
0.1152 --- loss: 1.392306, loss_ss: 0.993182, loss_d: 0.399124
0.1536 --- loss: 1.723686, loss_ss: 1.013812, loss_d: 0.709874
0.1919 --- loss: 1.344557, loss_ss: 1.076836, loss_d: 0.267722
0.2303 --- loss: 1.154982, loss_ss: 0.920221, loss_d: 0.234761
0.2687 --- loss: 1.086311, loss_ss: 0.922399, loss_d: 0.163912
0.3071 --- loss: 1.158275, loss_ss: 0.860470, loss_d: 0.297805
0.3455 --- loss: 1.003447, loss_ss: 0.783433, loss_d: 0.220014
0.3839 --- loss: 1.046384, loss_ss: 0.899866, loss_d: 0.146517
0.4223 --- loss: 1.050368, loss_ss: 0.597112, loss_d: 0.453256
0.4607 --- loss: 1.087441, loss_ss: 0.942993, loss_d: 0.144448
0.4990 --- loss: 1.352213, loss_ss: 1.138450, loss_d: 0.213763
0.5374 --- loss: 1.047664, loss_ss: 0.938091, loss_d: 0.109573
0.5758 --- loss: 1.432211, loss_ss: 0.816786, loss_d: 0.615425
0.6142 --- loss: 1.059105, loss_ss: 0.813963, loss_d: 0.245142
0.6526 --- loss: 0.875491, loss_ss: 0.704356, loss_d: 0.171135
0.6910 --- loss: 0.919387, loss_ss: 0.734326, loss_d: 0.185061
0.7294 --- loss: 1.552797, loss_ss: 0.916550, loss_d: 0.636247
0.7678 --- loss: 1.402827, loss_ss: 0.913793, loss_d: 0.489033
0.8061 --- loss: 1.103677, loss_ss: 0.987924, loss_d: 0.115753
0.8445 --- loss: 1.433776, loss_ss: 0.911636, loss_d: 0.522139
0.8829 --- loss: 0.952134, loss_ss: 0.593561, loss_d: 0.358574
0.9213 --- loss: 1.268055, loss_ss: 0.887593, loss_d: 0.380462
0.9597 --- loss: 1.018057, loss_ss: 0.884832, loss_d: 0.133224
0.9981 --- loss: 1.261445, loss_ss: 1.067596, loss_d: 0.193849
Epoch finished! Loss: 1.1582101322137393
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.818293, loss_ss: 0.743075, loss_d: 0.075218
0.0384 --- loss: 1.216527, loss_ss: 0.966749, loss_d: 0.249778
0.0768 --- loss: 0.951494, loss_ss: 0.795018, loss_d: 0.156476
0.1152 --- loss: 1.058043, loss_ss: 0.665748, loss_d: 0.392295
0.1536 --- loss: 1.049635, loss_ss: 0.847038, loss_d: 0.202597
0.1919 --- loss: 1.206620, loss_ss: 0.756593, loss_d: 0.450027
0.2303 --- loss: 1.450136, loss_ss: 0.788164, loss_d: 0.661972
0.2687 --- loss: 1.229627, loss_ss: 1.090506, loss_d: 0.139121
0.3071 --- loss: 1.725812, loss_ss: 1.103764, loss_d: 0.622049
0.3455 --- loss: 1.162224, loss_ss: 0.776022, loss_d: 0.386202
0.3839 --- loss: 0.712111, loss_ss: 0.615596, loss_d: 0.096514
0.4223 --- loss: 1.324816, loss_ss: 0.889174, loss_d: 0.435642
0.4607 --- loss: 1.274474, loss_ss: 1.056508, loss_d: 0.217966
0.4990 --- loss: 1.274367, loss_ss: 0.864976, loss_d: 0.409391
0.5374 --- loss: 1.486019, loss_ss: 1.201464, loss_d: 0.284555
0.5758 --- loss: 0.965804, loss_ss: 0.797640, loss_d: 0.168165
0.6142 --- loss: 1.051344, loss_ss: 0.805555, loss_d: 0.245789
0.6526 --- loss: 0.944704, loss_ss: 0.772593, loss_d: 0.172111
0.6910 --- loss: 1.058395, loss_ss: 0.887216, loss_d: 0.171179
0.7294 --- loss: 0.756573, loss_ss: 0.620042, loss_d: 0.136531
0.7678 --- loss: 1.019491, loss_ss: 0.860721, loss_d: 0.158770
0.8061 --- loss: 0.992864, loss_ss: 0.880561, loss_d: 0.112303
0.8445 --- loss: 1.018051, loss_ss: 0.738167, loss_d: 0.279884
0.8829 --- loss: 1.123008, loss_ss: 1.053931, loss_d: 0.069077
0.9213 --- loss: 1.467686, loss_ss: 0.769294, loss_d: 0.698392
0.9597 --- loss: 0.850394, loss_ss: 0.651334, loss_d: 0.199060
0.9981 --- loss: 0.952028, loss_ss: 0.802447, loss_d: 0.149581
Epoch finished! Loss: 1.133001982477995
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.3686868686868687
             precision    recall  f1-score   support

        0.0       0.48      0.30      0.37       237
        1.0       0.35      0.02      0.05       249
        2.0       0.46      0.49      0.47       210
        3.0       0.61      0.56      0.59       245
        4.0       0.13      0.98      0.23        49

avg / total       0.46      0.37      0.36       990
 


====== chp017-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  75.56  29.96   89.91  48.30     36.98
1  74.34   2.41   98.52  35.29      4.51
2  76.87  48.57   84.49  45.74     47.11
3  80.30  56.33   88.19  61.06     58.60
4  66.67  97.96   65.04  12.73     22.54
Total accuracy: 36.87%
Average sen: 47.04%
Average spec: 85.23%
Macro f1-score: 33.95%
Diagnosis acc on 15mins: 1.0
[0.87018925 0.82036585 0.95125639 0.97581995 0.96462274 0.97846669
 0.9319604  0.85651094 0.98827809 0.98506504 0.69964534 0.67561728
 0.95938957 0.8611908  0.77901638 0.99927384 0.99993384 0.99988675
 0.72107631 0.74622631 0.80445319 0.94223732 0.97491211 0.98285484
 0.97893393 0.77370101 0.91764772 0.8351025  0.79306906 0.56845653
 0.90588027 0.90293467 0.64597052]
pred: 0.8724225885940321, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp018-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.236662, loss_ss: 1.536186, loss_d: 0.700476
0.0384 --- loss: 2.275053, loss_ss: 1.604450, loss_d: 0.670603
0.0769 --- loss: 2.071317, loss_ss: 1.464240, loss_d: 0.607077
0.1153 --- loss: 2.071111, loss_ss: 1.329072, loss_d: 0.742039
0.1538 --- loss: 1.934143, loss_ss: 1.415121, loss_d: 0.519023
0.1922 --- loss: 2.041155, loss_ss: 1.273393, loss_d: 0.767762
0.2307 --- loss: 1.908883, loss_ss: 1.277334, loss_d: 0.631548
0.2691 --- loss: 1.920273, loss_ss: 1.253329, loss_d: 0.666944
0.3076 --- loss: 1.842230, loss_ss: 1.317091, loss_d: 0.525139
0.3460 --- loss: 1.836661, loss_ss: 1.184113, loss_d: 0.652548
0.3845 --- loss: 1.964131, loss_ss: 1.220598, loss_d: 0.743533
0.4229 --- loss: 2.072373, loss_ss: 1.437537, loss_d: 0.634837
0.4614 --- loss: 2.161861, loss_ss: 1.381339, loss_d: 0.780521
0.4998 --- loss: 1.948114, loss_ss: 1.187735, loss_d: 0.760379
0.5383 --- loss: 1.796080, loss_ss: 1.138243, loss_d: 0.657837
0.5767 --- loss: 1.772694, loss_ss: 1.138788, loss_d: 0.633906
0.6151 --- loss: 1.850698, loss_ss: 1.144768, loss_d: 0.705930
0.6536 --- loss: 1.723303, loss_ss: 1.122444, loss_d: 0.600859
0.6920 --- loss: 1.421972, loss_ss: 1.064230, loss_d: 0.357742
0.7305 --- loss: 1.759742, loss_ss: 1.276769, loss_d: 0.482973
0.7689 --- loss: 1.693304, loss_ss: 1.248414, loss_d: 0.444889
0.8074 --- loss: 1.647088, loss_ss: 1.124620, loss_d: 0.522469
0.8458 --- loss: 1.899869, loss_ss: 1.315319, loss_d: 0.584550
0.8843 --- loss: 1.826896, loss_ss: 1.153108, loss_d: 0.673789
0.9227 --- loss: 1.773996, loss_ss: 1.038208, loss_d: 0.735788
0.9612 --- loss: 1.536205, loss_ss: 1.035171, loss_d: 0.501034
0.9996 --- loss: 2.159190, loss_ss: 1.933237, loss_d: 0.225952
Epoch finished! Loss: 1.854426317031567
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.040968, loss_ss: 1.316244, loss_d: 0.724725
0.0384 --- loss: 1.497909, loss_ss: 1.037382, loss_d: 0.460526
0.0769 --- loss: 1.781288, loss_ss: 1.030342, loss_d: 0.750947
0.1153 --- loss: 1.792497, loss_ss: 1.066332, loss_d: 0.726166
0.1538 --- loss: 1.755666, loss_ss: 0.991651, loss_d: 0.764014
0.1922 --- loss: 1.619174, loss_ss: 1.134593, loss_d: 0.484581
0.2307 --- loss: 1.477303, loss_ss: 1.057305, loss_d: 0.419998
0.2691 --- loss: 1.773420, loss_ss: 1.123964, loss_d: 0.649456
0.3076 --- loss: 1.628812, loss_ss: 1.063517, loss_d: 0.565295
0.3460 --- loss: 1.781337, loss_ss: 1.059823, loss_d: 0.721514
0.3845 --- loss: 1.484861, loss_ss: 0.849459, loss_d: 0.635402
0.4229 --- loss: 1.462641, loss_ss: 0.916596, loss_d: 0.546045
0.4614 --- loss: 1.644100, loss_ss: 1.087665, loss_d: 0.556435
0.4998 --- loss: 1.480544, loss_ss: 0.847619, loss_d: 0.632925
0.5383 --- loss: 1.575281, loss_ss: 1.085723, loss_d: 0.489558
0.5767 --- loss: 1.552322, loss_ss: 0.944902, loss_d: 0.607420
0.6151 --- loss: 1.533676, loss_ss: 0.997159, loss_d: 0.536517
0.6536 --- loss: 1.722168, loss_ss: 0.985152, loss_d: 0.737016
0.6920 --- loss: 1.319172, loss_ss: 0.795889, loss_d: 0.523282
0.7305 --- loss: 1.460155, loss_ss: 0.996771, loss_d: 0.463383
0.7689 --- loss: 1.512988, loss_ss: 0.882632, loss_d: 0.630356
0.8074 --- loss: 1.356342, loss_ss: 0.784617, loss_d: 0.571724
0.8458 --- loss: 1.745238, loss_ss: 1.080148, loss_d: 0.665090
0.8843 --- loss: 1.701449, loss_ss: 1.102582, loss_d: 0.598866
0.9227 --- loss: 1.306484, loss_ss: 0.975802, loss_d: 0.330682
0.9612 --- loss: 1.713948, loss_ss: 1.091267, loss_d: 0.622682
0.9996 --- loss: 1.317322, loss_ss: 1.076504, loss_d: 0.240818
Epoch finished! Loss: 1.6310716963731327
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.452339, loss_ss: 1.024356, loss_d: 0.427983
0.0384 --- loss: 1.511648, loss_ss: 0.780721, loss_d: 0.730927
0.0769 --- loss: 1.425661, loss_ss: 0.927227, loss_d: 0.498433
0.1153 --- loss: 1.540009, loss_ss: 1.098487, loss_d: 0.441522
0.1538 --- loss: 1.370050, loss_ss: 0.969286, loss_d: 0.400764
0.1922 --- loss: 1.566141, loss_ss: 0.950567, loss_d: 0.615574
0.2307 --- loss: 1.912086, loss_ss: 1.048742, loss_d: 0.863344
0.2691 --- loss: 1.627413, loss_ss: 0.972147, loss_d: 0.655266
0.3076 --- loss: 1.733960, loss_ss: 1.095602, loss_d: 0.638358
0.3460 --- loss: 1.501300, loss_ss: 0.853540, loss_d: 0.647761
0.3845 --- loss: 1.638402, loss_ss: 1.049579, loss_d: 0.588823
0.4229 --- loss: 1.632315, loss_ss: 1.108217, loss_d: 0.524099
0.4614 --- loss: 1.528571, loss_ss: 0.897807, loss_d: 0.630764
0.4998 --- loss: 1.263887, loss_ss: 0.737021, loss_d: 0.526866
0.5383 --- loss: 1.460742, loss_ss: 0.960103, loss_d: 0.500639
0.5767 --- loss: 1.346871, loss_ss: 0.757540, loss_d: 0.589331
0.6151 --- loss: 1.577082, loss_ss: 1.124564, loss_d: 0.452518
0.6536 --- loss: 1.758049, loss_ss: 1.089436, loss_d: 0.668612
0.6920 --- loss: 1.602310, loss_ss: 0.885366, loss_d: 0.716944
0.7305 --- loss: 1.384205, loss_ss: 0.938716, loss_d: 0.445489
0.7689 --- loss: 1.488482, loss_ss: 1.073510, loss_d: 0.414971
0.8074 --- loss: 1.725933, loss_ss: 1.120187, loss_d: 0.605746
0.8458 --- loss: 1.189229, loss_ss: 0.757171, loss_d: 0.432058
0.8843 --- loss: 1.776665, loss_ss: 1.189166, loss_d: 0.587499
0.9227 --- loss: 1.773151, loss_ss: 1.106526, loss_d: 0.666625
0.9612 --- loss: 1.885182, loss_ss: 1.242684, loss_d: 0.642498
0.9996 --- loss: 1.733294, loss_ss: 1.515186, loss_d: 0.218108
Epoch finished! Loss: 1.5721794192607585
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.440239, loss_ss: 0.925420, loss_d: 0.514819
0.0384 --- loss: 1.717368, loss_ss: 0.795130, loss_d: 0.922238
0.0769 --- loss: 1.798074, loss_ss: 1.160464, loss_d: 0.637610
0.1153 --- loss: 1.423091, loss_ss: 0.658461, loss_d: 0.764629
0.1538 --- loss: 1.585755, loss_ss: 0.949222, loss_d: 0.636533
0.1922 --- loss: 1.304348, loss_ss: 0.657355, loss_d: 0.646993
0.2307 --- loss: 1.472493, loss_ss: 1.007010, loss_d: 0.465482
0.2691 --- loss: 1.727973, loss_ss: 1.247960, loss_d: 0.480013
0.3076 --- loss: 1.428740, loss_ss: 0.944682, loss_d: 0.484058
0.3460 --- loss: 1.223727, loss_ss: 0.815531, loss_d: 0.408196
0.3845 --- loss: 1.471886, loss_ss: 0.905961, loss_d: 0.565925
0.4229 --- loss: 1.610088, loss_ss: 0.932639, loss_d: 0.677449
0.4614 --- loss: 1.223588, loss_ss: 0.842455, loss_d: 0.381133
0.4998 --- loss: 1.411568, loss_ss: 0.923623, loss_d: 0.487945
0.5383 --- loss: 1.496265, loss_ss: 0.920710, loss_d: 0.575555
0.5767 --- loss: 1.574510, loss_ss: 0.911260, loss_d: 0.663251
0.6151 --- loss: 1.389005, loss_ss: 0.824081, loss_d: 0.564924
0.6536 --- loss: 1.534533, loss_ss: 0.985369, loss_d: 0.549164
0.6920 --- loss: 1.466878, loss_ss: 0.882094, loss_d: 0.584784
0.7305 --- loss: 1.661768, loss_ss: 0.872212, loss_d: 0.789557
0.7689 --- loss: 1.322989, loss_ss: 0.968429, loss_d: 0.354560
0.8074 --- loss: 1.516688, loss_ss: 0.905213, loss_d: 0.611475
0.8458 --- loss: 1.330798, loss_ss: 0.759411, loss_d: 0.571387
0.8843 --- loss: 1.429897, loss_ss: 0.988461, loss_d: 0.441436
0.9227 --- loss: 1.576698, loss_ss: 0.910807, loss_d: 0.665892
0.9612 --- loss: 1.662894, loss_ss: 1.156972, loss_d: 0.505921
0.9996 --- loss: 2.677309, loss_ss: 2.320974, loss_d: 0.356334
Epoch finished! Loss: 1.5314771906687663
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.366884, loss_ss: 0.873166, loss_d: 0.493718
0.0384 --- loss: 1.411587, loss_ss: 1.113248, loss_d: 0.298339
0.0769 --- loss: 1.610783, loss_ss: 1.103097, loss_d: 0.507686
0.1153 --- loss: 1.705748, loss_ss: 1.164282, loss_d: 0.541466
0.1538 --- loss: 1.559856, loss_ss: 1.041919, loss_d: 0.517937
0.1922 --- loss: 1.442519, loss_ss: 0.826017, loss_d: 0.616501
0.2307 --- loss: 1.703986, loss_ss: 1.360209, loss_d: 0.343777
0.2691 --- loss: 1.611127, loss_ss: 1.235289, loss_d: 0.375838
0.3076 --- loss: 1.562974, loss_ss: 0.995405, loss_d: 0.567569
0.3460 --- loss: 1.343213, loss_ss: 0.909656, loss_d: 0.433556
0.3845 --- loss: 1.841945, loss_ss: 0.729881, loss_d: 1.112064
0.4229 --- loss: 1.211703, loss_ss: 0.675040, loss_d: 0.536663
0.4614 --- loss: 1.517408, loss_ss: 1.025107, loss_d: 0.492301
0.4998 --- loss: 1.205073, loss_ss: 0.859732, loss_d: 0.345342
0.5383 --- loss: 1.351974, loss_ss: 0.747529, loss_d: 0.604445
0.5767 --- loss: 1.765353, loss_ss: 0.796894, loss_d: 0.968459
0.6151 --- loss: 2.482560, loss_ss: 1.536318, loss_d: 0.946242
0.6536 --- loss: 1.462933, loss_ss: 0.981560, loss_d: 0.481372
0.6920 --- loss: 1.435823, loss_ss: 1.014080, loss_d: 0.421743
0.7305 --- loss: 1.416484, loss_ss: 0.959186, loss_d: 0.457298
0.7689 --- loss: 2.123152, loss_ss: 1.412431, loss_d: 0.710721
0.8074 --- loss: 1.601415, loss_ss: 0.984606, loss_d: 0.616809
0.8458 --- loss: 1.487379, loss_ss: 1.062497, loss_d: 0.424882
0.8843 --- loss: 1.364772, loss_ss: 0.992826, loss_d: 0.371947
0.9227 --- loss: 1.414269, loss_ss: 1.011695, loss_d: 0.402574
0.9612 --- loss: 1.518446, loss_ss: 0.863780, loss_d: 0.654666
0.9996 --- loss: 2.494018, loss_ss: 2.333323, loss_d: 0.160695
Epoch finished! Loss: 1.4587700974482756
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.996572, loss_ss: 0.621371, loss_d: 0.375200
0.0384 --- loss: 1.461072, loss_ss: 0.685221, loss_d: 0.775850
0.0769 --- loss: 1.185044, loss_ss: 0.813844, loss_d: 0.371200
0.1153 --- loss: 1.436417, loss_ss: 0.773985, loss_d: 0.662433
0.1538 --- loss: 1.240607, loss_ss: 0.838427, loss_d: 0.402180
0.1922 --- loss: 1.248892, loss_ss: 0.784015, loss_d: 0.464876
0.2307 --- loss: 1.248055, loss_ss: 0.875509, loss_d: 0.372546
0.2691 --- loss: 1.444868, loss_ss: 0.850158, loss_d: 0.594710
0.3076 --- loss: 1.272133, loss_ss: 0.899391, loss_d: 0.372743
0.3460 --- loss: 1.005847, loss_ss: 0.743943, loss_d: 0.261904
0.3845 --- loss: 1.574157, loss_ss: 1.332945, loss_d: 0.241213
0.4229 --- loss: 1.575773, loss_ss: 1.214857, loss_d: 0.360916
0.4614 --- loss: 1.476399, loss_ss: 0.920994, loss_d: 0.555405
0.4998 --- loss: 1.229287, loss_ss: 0.959320, loss_d: 0.269967
0.5383 --- loss: 1.325189, loss_ss: 0.862550, loss_d: 0.462640
0.5767 --- loss: 1.448025, loss_ss: 1.026693, loss_d: 0.421332
0.6151 --- loss: 1.185804, loss_ss: 1.041130, loss_d: 0.144674
0.6536 --- loss: 1.263521, loss_ss: 0.853227, loss_d: 0.410293
0.6920 --- loss: 1.694982, loss_ss: 0.906680, loss_d: 0.788301
0.7305 --- loss: 1.530551, loss_ss: 1.063655, loss_d: 0.466896
0.7689 --- loss: 1.175493, loss_ss: 0.830306, loss_d: 0.345187
0.8074 --- loss: 1.251080, loss_ss: 0.890472, loss_d: 0.360608
0.8458 --- loss: 1.026067, loss_ss: 0.644529, loss_d: 0.381537
0.8843 --- loss: 1.448349, loss_ss: 0.685813, loss_d: 0.762536
0.9227 --- loss: 1.639975, loss_ss: 0.934700, loss_d: 0.705275
0.9612 --- loss: 1.328687, loss_ss: 1.130745, loss_d: 0.197941
0.9996 --- loss: 1.054455, loss_ss: 0.851438, loss_d: 0.203017
Epoch finished! Loss: 1.375569604910337
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 0.914587, loss_ss: 0.485690, loss_d: 0.428897
0.0384 --- loss: 1.192779, loss_ss: 0.960144, loss_d: 0.232636
0.0769 --- loss: 1.498994, loss_ss: 1.255102, loss_d: 0.243892
0.1153 --- loss: 1.337274, loss_ss: 1.044733, loss_d: 0.292541
0.1538 --- loss: 1.149164, loss_ss: 0.941041, loss_d: 0.208122
0.1922 --- loss: 1.464040, loss_ss: 0.837279, loss_d: 0.626760
0.2307 --- loss: 1.110739, loss_ss: 0.753740, loss_d: 0.356999
0.2691 --- loss: 1.318583, loss_ss: 0.877026, loss_d: 0.441557
0.3076 --- loss: 1.676725, loss_ss: 1.186745, loss_d: 0.489980
0.3460 --- loss: 1.285654, loss_ss: 1.031971, loss_d: 0.253683
0.3845 --- loss: 1.172484, loss_ss: 0.908401, loss_d: 0.264083
0.4229 --- loss: 0.907356, loss_ss: 0.767048, loss_d: 0.140308
0.4614 --- loss: 1.234603, loss_ss: 1.042138, loss_d: 0.192465
0.4998 --- loss: 1.388009, loss_ss: 0.981362, loss_d: 0.406647
0.5383 --- loss: 1.024478, loss_ss: 0.750311, loss_d: 0.274167
0.5767 --- loss: 1.031302, loss_ss: 0.743829, loss_d: 0.287473
0.6151 --- loss: 1.234904, loss_ss: 0.857105, loss_d: 0.377799
0.6536 --- loss: 1.066785, loss_ss: 0.908824, loss_d: 0.157962
0.6920 --- loss: 1.441650, loss_ss: 1.160250, loss_d: 0.281400
0.7305 --- loss: 0.980930, loss_ss: 0.527120, loss_d: 0.453810
0.7689 --- loss: 1.513545, loss_ss: 1.003475, loss_d: 0.510070
0.8074 --- loss: 1.830904, loss_ss: 1.161683, loss_d: 0.669221
0.8458 --- loss: 1.220317, loss_ss: 1.011579, loss_d: 0.208738
0.8843 --- loss: 1.343832, loss_ss: 0.965478, loss_d: 0.378354
0.9227 --- loss: 1.048924, loss_ss: 0.670220, loss_d: 0.378704
0.9612 --- loss: 1.794736, loss_ss: 0.917649, loss_d: 0.877087
0.9996 --- loss: 2.226879, loss_ss: 0.810147, loss_d: 1.416731
Epoch finished! Loss: 1.3196500982229526
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.291363, loss_ss: 0.957253, loss_d: 0.334110
0.0384 --- loss: 1.496388, loss_ss: 0.943588, loss_d: 0.552800
0.0769 --- loss: 1.580478, loss_ss: 1.032478, loss_d: 0.548000
0.1153 --- loss: 1.671353, loss_ss: 0.969336, loss_d: 0.702017
0.1538 --- loss: 1.219050, loss_ss: 0.801753, loss_d: 0.417297
0.1922 --- loss: 1.545267, loss_ss: 1.056223, loss_d: 0.489044
0.2307 --- loss: 1.031894, loss_ss: 0.778522, loss_d: 0.253373
0.2691 --- loss: 1.325520, loss_ss: 0.839948, loss_d: 0.485571
0.3076 --- loss: 1.057517, loss_ss: 0.893235, loss_d: 0.164282
0.3460 --- loss: 1.086414, loss_ss: 0.729990, loss_d: 0.356424
0.3845 --- loss: 1.763861, loss_ss: 0.734009, loss_d: 1.029852
0.4229 --- loss: 0.952546, loss_ss: 0.731365, loss_d: 0.221181
0.4614 --- loss: 0.933445, loss_ss: 0.778319, loss_d: 0.155126
0.4998 --- loss: 1.967305, loss_ss: 0.883224, loss_d: 1.084081
0.5383 --- loss: 1.066008, loss_ss: 0.644927, loss_d: 0.421082
0.5767 --- loss: 1.318505, loss_ss: 0.944659, loss_d: 0.373846
0.6151 --- loss: 1.104607, loss_ss: 0.680047, loss_d: 0.424560
0.6536 --- loss: 1.148884, loss_ss: 0.739506, loss_d: 0.409378
0.6920 --- loss: 1.651747, loss_ss: 1.129488, loss_d: 0.522260
0.7305 --- loss: 1.337929, loss_ss: 0.750347, loss_d: 0.587582
0.7689 --- loss: 1.969777, loss_ss: 1.083335, loss_d: 0.886442
0.8074 --- loss: 1.708264, loss_ss: 0.576155, loss_d: 1.132108
0.8458 --- loss: 1.327964, loss_ss: 0.843790, loss_d: 0.484174
0.8843 --- loss: 0.790191, loss_ss: 0.583281, loss_d: 0.206911
0.9227 --- loss: 1.046630, loss_ss: 0.785382, loss_d: 0.261249
0.9612 --- loss: 1.005382, loss_ss: 0.714172, loss_d: 0.291210
0.9996 --- loss: 2.489056, loss_ss: 2.207993, loss_d: 0.281064
Epoch finished! Loss: 1.2673596755816385
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.192945, loss_ss: 0.778714, loss_d: 0.414231
0.0384 --- loss: 1.447169, loss_ss: 1.208940, loss_d: 0.238229
0.0769 --- loss: 1.139623, loss_ss: 0.923077, loss_d: 0.216546
0.1153 --- loss: 1.129331, loss_ss: 0.838354, loss_d: 0.290977
0.1538 --- loss: 1.346581, loss_ss: 1.145424, loss_d: 0.201157
0.1922 --- loss: 1.231047, loss_ss: 0.706514, loss_d: 0.524533
0.2307 --- loss: 0.999959, loss_ss: 0.685370, loss_d: 0.314589
0.2691 --- loss: 1.352662, loss_ss: 0.769084, loss_d: 0.583578
0.3076 --- loss: 1.083048, loss_ss: 0.692815, loss_d: 0.390233
0.3460 --- loss: 0.993510, loss_ss: 0.819662, loss_d: 0.173847
0.3845 --- loss: 1.639721, loss_ss: 1.173191, loss_d: 0.466530
0.4229 --- loss: 1.284329, loss_ss: 0.947434, loss_d: 0.336894
0.4614 --- loss: 1.059010, loss_ss: 0.829119, loss_d: 0.229891
0.4998 --- loss: 1.170922, loss_ss: 0.935209, loss_d: 0.235713
0.5383 --- loss: 1.273942, loss_ss: 0.838423, loss_d: 0.435519
0.5767 --- loss: 1.227356, loss_ss: 0.962190, loss_d: 0.265166
0.6151 --- loss: 1.265704, loss_ss: 0.732059, loss_d: 0.533645
0.6536 --- loss: 1.231977, loss_ss: 0.934691, loss_d: 0.297286
0.6920 --- loss: 1.185021, loss_ss: 0.999017, loss_d: 0.186004
0.7305 --- loss: 1.006059, loss_ss: 0.787770, loss_d: 0.218290
0.7689 --- loss: 1.349454, loss_ss: 0.829843, loss_d: 0.519611
0.8074 --- loss: 1.522084, loss_ss: 1.041229, loss_d: 0.480856
0.8458 --- loss: 1.069603, loss_ss: 0.866593, loss_d: 0.203010
0.8843 --- loss: 0.970596, loss_ss: 0.819028, loss_d: 0.151568
0.9227 --- loss: 0.948053, loss_ss: 0.697406, loss_d: 0.250647
0.9612 --- loss: 0.982593, loss_ss: 0.668510, loss_d: 0.314083
0.9996 --- loss: 3.742100, loss_ss: 2.244309, loss_d: 1.497791
Epoch finished! Loss: 1.232583127801235
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.132510, loss_ss: 0.947151, loss_d: 0.185359
0.0384 --- loss: 1.146253, loss_ss: 0.762578, loss_d: 0.383676
0.0769 --- loss: 0.783470, loss_ss: 0.568247, loss_d: 0.215223
0.1153 --- loss: 1.271248, loss_ss: 0.984330, loss_d: 0.286919
0.1538 --- loss: 1.043066, loss_ss: 0.924017, loss_d: 0.119050
0.1922 --- loss: 0.609556, loss_ss: 0.483686, loss_d: 0.125869
0.2307 --- loss: 1.348994, loss_ss: 1.094050, loss_d: 0.254944
0.2691 --- loss: 0.812764, loss_ss: 0.669908, loss_d: 0.142856
0.3076 --- loss: 0.875484, loss_ss: 0.606545, loss_d: 0.268940
0.3460 --- loss: 1.342162, loss_ss: 1.161730, loss_d: 0.180433
0.3845 --- loss: 1.516808, loss_ss: 1.130985, loss_d: 0.385823
0.4229 --- loss: 1.224217, loss_ss: 0.977211, loss_d: 0.247006
0.4614 --- loss: 0.824595, loss_ss: 0.658536, loss_d: 0.166058
0.4998 --- loss: 1.289686, loss_ss: 0.895341, loss_d: 0.394345
0.5383 --- loss: 1.370414, loss_ss: 0.957604, loss_d: 0.412811
0.5767 --- loss: 1.316029, loss_ss: 0.843547, loss_d: 0.472482
0.6151 --- loss: 1.008289, loss_ss: 0.732498, loss_d: 0.275791
0.6536 --- loss: 0.976474, loss_ss: 0.802036, loss_d: 0.174438
0.6920 --- loss: 1.341911, loss_ss: 1.089560, loss_d: 0.252351
0.7305 --- loss: 1.199848, loss_ss: 0.764259, loss_d: 0.435590
0.7689 --- loss: 1.067727, loss_ss: 0.843694, loss_d: 0.224032
0.8074 --- loss: 1.014911, loss_ss: 0.811547, loss_d: 0.203364
0.8458 --- loss: 1.053200, loss_ss: 0.835139, loss_d: 0.218062
0.8843 --- loss: 0.923458, loss_ss: 0.658551, loss_d: 0.264907
0.9227 --- loss: 1.370057, loss_ss: 1.157104, loss_d: 0.212953
0.9612 --- loss: 0.935539, loss_ss: 0.777304, loss_d: 0.158236
0.9996 --- loss: 1.473339, loss_ss: 1.307503, loss_d: 0.165836
Epoch finished! Loss: 1.1727576739512957
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6666666666666666
             precision    recall  f1-score   support

        0.0       0.74      0.79      0.76       138
        1.0       1.00      0.01      0.02       123
        2.0       0.31      0.93      0.46       120
        3.0       1.00      0.64      0.78       363
        4.0       0.78      0.78      0.78       366

avg / total       0.82      0.67      0.66      1110
 


====== chp018-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  93.87  78.99   95.99   73.65     76.22
1  89.01   0.81  100.00  100.00      1.61
2  76.67  92.50   74.75   30.75     46.15
3  88.20  63.91  100.00  100.00     77.98
4  85.59  78.42   89.11   77.99     78.20
Total accuracy: 66.67%
Average sen: 62.93%
Average spec: 91.97%
Macro f1-score: 56.04%
Diagnosis acc on 15mins: 0.8378378378378378
[0.85678542 0.1682893  0.69493693 0.87173533 0.51710212 0.45781678
 0.72415978 0.66682476 0.9494803  0.71958959 0.51218867 0.43326345
 0.82171637 0.91541415 0.92616743 0.94547397 0.94293529 0.82456261
 0.25440499 0.87435514 0.94243902 0.92425954 0.78929782 0.77444273
 0.83164108 0.9134531  0.77422094 0.93842298 0.93131906 0.36403832
 0.87767178 0.91988927 0.97830373 0.95686448 0.76411313 0.50288206
 0.35317189]
pred: 0.7463144136441721, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp019-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.470079, loss_ss: 1.699628, loss_d: 0.770451
0.0384 --- loss: 2.254823, loss_ss: 1.626167, loss_d: 0.628656
0.0767 --- loss: 2.070222, loss_ss: 1.511835, loss_d: 0.558387
0.1151 --- loss: 2.084646, loss_ss: 1.592763, loss_d: 0.491883
0.1534 --- loss: 2.177421, loss_ss: 1.420639, loss_d: 0.756782
0.1918 --- loss: 2.019087, loss_ss: 1.402184, loss_d: 0.616903
0.2301 --- loss: 1.755177, loss_ss: 1.381727, loss_d: 0.373451
0.2685 --- loss: 1.835724, loss_ss: 1.265608, loss_d: 0.570117
0.3069 --- loss: 1.874661, loss_ss: 1.354331, loss_d: 0.520331
0.3452 --- loss: 1.734826, loss_ss: 1.240691, loss_d: 0.494135
0.3836 --- loss: 2.046350, loss_ss: 1.273920, loss_d: 0.772431
0.4219 --- loss: 1.887072, loss_ss: 1.238864, loss_d: 0.648208
0.4603 --- loss: 1.894683, loss_ss: 1.191763, loss_d: 0.702921
0.4987 --- loss: 1.709533, loss_ss: 1.298487, loss_d: 0.411046
0.5370 --- loss: 1.743799, loss_ss: 1.250317, loss_d: 0.493482
0.5754 --- loss: 1.705838, loss_ss: 1.349965, loss_d: 0.355872
0.6137 --- loss: 1.668684, loss_ss: 1.134923, loss_d: 0.533760
0.6521 --- loss: 1.985031, loss_ss: 1.237307, loss_d: 0.747724
0.6904 --- loss: 1.934984, loss_ss: 1.338423, loss_d: 0.596561
0.7288 --- loss: 1.510233, loss_ss: 1.200273, loss_d: 0.309960
0.7672 --- loss: 1.475766, loss_ss: 1.206434, loss_d: 0.269331
0.8055 --- loss: 1.626715, loss_ss: 1.192617, loss_d: 0.434098
0.8439 --- loss: 1.853654, loss_ss: 1.147748, loss_d: 0.705906
0.8822 --- loss: 1.587236, loss_ss: 1.158219, loss_d: 0.429017
0.9206 --- loss: 1.832213, loss_ss: 1.100081, loss_d: 0.732133
0.9590 --- loss: 1.645244, loss_ss: 1.100435, loss_d: 0.544809
0.9973 --- loss: 1.614705, loss_ss: 1.082961, loss_d: 0.531744
Epoch finished! Loss: 1.9037515053382286
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.670446, loss_ss: 1.002436, loss_d: 0.668011
0.0384 --- loss: 1.769306, loss_ss: 1.001745, loss_d: 0.767562
0.0767 --- loss: 1.615757, loss_ss: 1.006900, loss_d: 0.608858
0.1151 --- loss: 1.871125, loss_ss: 1.261195, loss_d: 0.609930
0.1534 --- loss: 1.648439, loss_ss: 0.960212, loss_d: 0.688228
0.1918 --- loss: 1.560759, loss_ss: 1.021037, loss_d: 0.539722
0.2301 --- loss: 1.486014, loss_ss: 1.038954, loss_d: 0.447059
0.2685 --- loss: 1.668115, loss_ss: 1.038285, loss_d: 0.629830
0.3069 --- loss: 1.351642, loss_ss: 1.002314, loss_d: 0.349328
0.3452 --- loss: 1.640036, loss_ss: 1.135965, loss_d: 0.504071
0.3836 --- loss: 1.803868, loss_ss: 1.034076, loss_d: 0.769792
0.4219 --- loss: 1.808491, loss_ss: 1.080167, loss_d: 0.728324
0.4603 --- loss: 1.559404, loss_ss: 1.120595, loss_d: 0.438809
0.4987 --- loss: 1.363205, loss_ss: 0.894854, loss_d: 0.468351
0.5370 --- loss: 1.626450, loss_ss: 1.195280, loss_d: 0.431170
0.5754 --- loss: 1.636050, loss_ss: 1.027567, loss_d: 0.608483
0.6137 --- loss: 1.550692, loss_ss: 0.896579, loss_d: 0.654113
0.6521 --- loss: 1.669144, loss_ss: 1.029511, loss_d: 0.639634
0.6904 --- loss: 1.502008, loss_ss: 1.053098, loss_d: 0.448909
0.7288 --- loss: 1.610576, loss_ss: 0.944479, loss_d: 0.666097
0.7672 --- loss: 1.560937, loss_ss: 0.841621, loss_d: 0.719316
0.8055 --- loss: 1.493737, loss_ss: 1.098878, loss_d: 0.394859
0.8439 --- loss: 1.738911, loss_ss: 0.996859, loss_d: 0.742052
0.8822 --- loss: 1.489670, loss_ss: 1.005210, loss_d: 0.484460
0.9206 --- loss: 1.723981, loss_ss: 1.022975, loss_d: 0.701006
0.9590 --- loss: 1.722373, loss_ss: 1.097378, loss_d: 0.624995
0.9973 --- loss: 1.736183, loss_ss: 1.186389, loss_d: 0.549794
Epoch finished! Loss: 1.6605641608054822
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.617583, loss_ss: 1.027252, loss_d: 0.590331
0.0384 --- loss: 2.003731, loss_ss: 1.225038, loss_d: 0.778693
0.0767 --- loss: 1.560877, loss_ss: 1.083107, loss_d: 0.477769
0.1151 --- loss: 1.606117, loss_ss: 0.900251, loss_d: 0.705866
0.1534 --- loss: 1.341358, loss_ss: 0.759609, loss_d: 0.581749
0.1918 --- loss: 1.565582, loss_ss: 1.079794, loss_d: 0.485788
0.2301 --- loss: 1.402833, loss_ss: 0.953555, loss_d: 0.449278
0.2685 --- loss: 1.528293, loss_ss: 1.259211, loss_d: 0.269082
0.3069 --- loss: 1.296034, loss_ss: 0.870963, loss_d: 0.425072
0.3452 --- loss: 1.401927, loss_ss: 0.835060, loss_d: 0.566867
0.3836 --- loss: 1.302675, loss_ss: 0.806598, loss_d: 0.496076
0.4219 --- loss: 1.991866, loss_ss: 1.389616, loss_d: 0.602250
0.4603 --- loss: 1.419507, loss_ss: 1.040705, loss_d: 0.378802
0.4987 --- loss: 1.508824, loss_ss: 0.874056, loss_d: 0.634768
0.5370 --- loss: 1.463377, loss_ss: 0.871652, loss_d: 0.591724
0.5754 --- loss: 1.466517, loss_ss: 0.989367, loss_d: 0.477150
0.6137 --- loss: 1.731829, loss_ss: 1.009633, loss_d: 0.722196
0.6521 --- loss: 1.542499, loss_ss: 0.720294, loss_d: 0.822205
0.6904 --- loss: 1.892743, loss_ss: 1.462312, loss_d: 0.430430
0.7288 --- loss: 1.731133, loss_ss: 0.970753, loss_d: 0.760380
0.7672 --- loss: 1.314123, loss_ss: 0.837571, loss_d: 0.476552
0.8055 --- loss: 1.369795, loss_ss: 0.888711, loss_d: 0.481083
0.8439 --- loss: 1.948707, loss_ss: 1.074669, loss_d: 0.874038
0.8822 --- loss: 1.707609, loss_ss: 1.021146, loss_d: 0.686463
0.9206 --- loss: 1.411171, loss_ss: 0.898984, loss_d: 0.512187
0.9590 --- loss: 1.550816, loss_ss: 0.964661, loss_d: 0.586155
0.9973 --- loss: 1.467340, loss_ss: 0.989721, loss_d: 0.477619
Epoch finished! Loss: 1.5579521413032824
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.251233, loss_ss: 0.913193, loss_d: 0.338040
0.0384 --- loss: 1.383261, loss_ss: 0.890302, loss_d: 0.492959
0.0767 --- loss: 1.220541, loss_ss: 0.827573, loss_d: 0.392968
0.1151 --- loss: 1.301755, loss_ss: 1.023615, loss_d: 0.278140
0.1534 --- loss: 1.450914, loss_ss: 0.819285, loss_d: 0.631629
0.1918 --- loss: 1.275356, loss_ss: 0.890825, loss_d: 0.384531
0.2301 --- loss: 1.617519, loss_ss: 0.910862, loss_d: 0.706657
0.2685 --- loss: 1.310301, loss_ss: 1.000563, loss_d: 0.309738
0.3069 --- loss: 1.559102, loss_ss: 0.991155, loss_d: 0.567947
0.3452 --- loss: 1.403448, loss_ss: 0.972704, loss_d: 0.430744
0.3836 --- loss: 1.341014, loss_ss: 0.846170, loss_d: 0.494844
0.4219 --- loss: 1.800042, loss_ss: 0.925952, loss_d: 0.874089
0.4603 --- loss: 1.447213, loss_ss: 0.855423, loss_d: 0.591790
0.4987 --- loss: 1.384314, loss_ss: 0.706182, loss_d: 0.678131
0.5370 --- loss: 1.198697, loss_ss: 0.849527, loss_d: 0.349170
0.5754 --- loss: 1.622112, loss_ss: 0.988979, loss_d: 0.633133
0.6137 --- loss: 1.721434, loss_ss: 1.401946, loss_d: 0.319489
0.6521 --- loss: 1.626589, loss_ss: 1.150400, loss_d: 0.476188
0.6904 --- loss: 1.214863, loss_ss: 0.919580, loss_d: 0.295283
0.7288 --- loss: 1.591904, loss_ss: 1.354849, loss_d: 0.237055
0.7672 --- loss: 1.534985, loss_ss: 0.926445, loss_d: 0.608541
0.8055 --- loss: 1.415295, loss_ss: 0.890148, loss_d: 0.525147
0.8439 --- loss: 1.733897, loss_ss: 1.170122, loss_d: 0.563775
0.8822 --- loss: 1.449263, loss_ss: 0.725358, loss_d: 0.723905
0.9206 --- loss: 1.619604, loss_ss: 1.047036, loss_d: 0.572567
0.9590 --- loss: 1.446009, loss_ss: 0.818655, loss_d: 0.627354
0.9973 --- loss: 1.183654, loss_ss: 0.845237, loss_d: 0.338417
Epoch finished! Loss: 1.47093537908334
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.445243, loss_ss: 0.837434, loss_d: 0.607809
0.0384 --- loss: 1.717622, loss_ss: 1.071680, loss_d: 0.645941
0.0767 --- loss: 1.023085, loss_ss: 0.799713, loss_d: 0.223372
0.1151 --- loss: 1.315970, loss_ss: 1.042886, loss_d: 0.273084
0.1534 --- loss: 1.539096, loss_ss: 1.081926, loss_d: 0.457170
0.1918 --- loss: 1.600079, loss_ss: 1.092008, loss_d: 0.508070
0.2301 --- loss: 1.495831, loss_ss: 0.889832, loss_d: 0.605999
0.2685 --- loss: 1.771610, loss_ss: 1.200376, loss_d: 0.571234
0.3069 --- loss: 1.445584, loss_ss: 0.841251, loss_d: 0.604333
0.3452 --- loss: 1.410905, loss_ss: 1.032322, loss_d: 0.378584
0.3836 --- loss: 1.333783, loss_ss: 0.960726, loss_d: 0.373057
0.4219 --- loss: 1.515251, loss_ss: 0.835840, loss_d: 0.679411
0.4603 --- loss: 1.700929, loss_ss: 0.873941, loss_d: 0.826988
0.4987 --- loss: 1.406850, loss_ss: 0.884372, loss_d: 0.522478
0.5370 --- loss: 1.165749, loss_ss: 0.929435, loss_d: 0.236314
0.5754 --- loss: 1.416812, loss_ss: 0.814293, loss_d: 0.602519
0.6137 --- loss: 1.702160, loss_ss: 1.222650, loss_d: 0.479510
0.6521 --- loss: 0.999359, loss_ss: 0.723106, loss_d: 0.276253
0.6904 --- loss: 1.128555, loss_ss: 0.871573, loss_d: 0.256982
0.7288 --- loss: 1.414296, loss_ss: 0.848134, loss_d: 0.566161
0.7672 --- loss: 1.334570, loss_ss: 0.910514, loss_d: 0.424055
0.8055 --- loss: 1.403854, loss_ss: 1.054410, loss_d: 0.349444
0.8439 --- loss: 1.514331, loss_ss: 0.917154, loss_d: 0.597177
0.8822 --- loss: 0.953135, loss_ss: 0.745496, loss_d: 0.207639
0.9206 --- loss: 1.138401, loss_ss: 0.818415, loss_d: 0.319986
0.9590 --- loss: 1.359608, loss_ss: 1.012130, loss_d: 0.347478
0.9973 --- loss: 1.340066, loss_ss: 0.904675, loss_d: 0.435391
Epoch finished! Loss: 1.4024740423147495
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.187333, loss_ss: 0.925712, loss_d: 0.261622
0.0384 --- loss: 1.388463, loss_ss: 0.721468, loss_d: 0.666995
0.0767 --- loss: 1.339650, loss_ss: 1.097705, loss_d: 0.241945
0.1151 --- loss: 1.077904, loss_ss: 0.843105, loss_d: 0.234799
0.1534 --- loss: 1.528955, loss_ss: 1.013310, loss_d: 0.515645
0.1918 --- loss: 0.980397, loss_ss: 0.631329, loss_d: 0.349068
0.2301 --- loss: 1.325807, loss_ss: 0.742958, loss_d: 0.582849
0.2685 --- loss: 1.413759, loss_ss: 0.821909, loss_d: 0.591850
0.3069 --- loss: 1.675717, loss_ss: 1.068054, loss_d: 0.607663
0.3452 --- loss: 1.511542, loss_ss: 0.746498, loss_d: 0.765044
0.3836 --- loss: 1.330434, loss_ss: 0.925952, loss_d: 0.404482
0.4219 --- loss: 1.208994, loss_ss: 0.910873, loss_d: 0.298121
0.4603 --- loss: 1.107870, loss_ss: 0.770175, loss_d: 0.337695
0.4987 --- loss: 2.038826, loss_ss: 1.341598, loss_d: 0.697229
0.5370 --- loss: 1.640597, loss_ss: 1.256941, loss_d: 0.383656
0.5754 --- loss: 1.180292, loss_ss: 0.890811, loss_d: 0.289480
0.6137 --- loss: 1.350242, loss_ss: 0.658475, loss_d: 0.691767
0.6521 --- loss: 1.426335, loss_ss: 0.870088, loss_d: 0.556247
0.6904 --- loss: 1.473135, loss_ss: 1.034311, loss_d: 0.438824
0.7288 --- loss: 1.109216, loss_ss: 0.870824, loss_d: 0.238391
0.7672 --- loss: 1.164760, loss_ss: 0.931806, loss_d: 0.232954
0.8055 --- loss: 1.219342, loss_ss: 0.891143, loss_d: 0.328199
0.8439 --- loss: 1.290729, loss_ss: 0.939644, loss_d: 0.351085
0.8822 --- loss: 1.361677, loss_ss: 0.921429, loss_d: 0.440248
0.9206 --- loss: 1.581015, loss_ss: 0.776765, loss_d: 0.804250
0.9590 --- loss: 1.047246, loss_ss: 0.891344, loss_d: 0.155902
0.9973 --- loss: 2.883919, loss_ss: 0.992211, loss_d: 1.891708
Epoch finished! Loss: 1.348727693236791
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.737232, loss_ss: 0.869058, loss_d: 0.868175
0.0384 --- loss: 1.121997, loss_ss: 0.655527, loss_d: 0.466470
0.0767 --- loss: 1.247224, loss_ss: 0.814615, loss_d: 0.432609
0.1151 --- loss: 1.489100, loss_ss: 1.255293, loss_d: 0.233807
0.1534 --- loss: 1.164317, loss_ss: 0.835642, loss_d: 0.328675
0.1918 --- loss: 0.802437, loss_ss: 0.567843, loss_d: 0.234594
0.2301 --- loss: 1.336782, loss_ss: 0.955334, loss_d: 0.381447
0.2685 --- loss: 1.139793, loss_ss: 0.809834, loss_d: 0.329959
0.3069 --- loss: 1.648303, loss_ss: 1.117577, loss_d: 0.530726
0.3452 --- loss: 1.764259, loss_ss: 1.550159, loss_d: 0.214100
0.3836 --- loss: 1.396321, loss_ss: 0.910234, loss_d: 0.486087
0.4219 --- loss: 1.132065, loss_ss: 0.904288, loss_d: 0.227777
0.4603 --- loss: 1.238702, loss_ss: 0.898534, loss_d: 0.340167
0.4987 --- loss: 1.594865, loss_ss: 1.088008, loss_d: 0.506858
0.5370 --- loss: 1.081924, loss_ss: 0.874376, loss_d: 0.207549
0.5754 --- loss: 1.708226, loss_ss: 1.196086, loss_d: 0.512140
0.6137 --- loss: 1.101351, loss_ss: 0.595595, loss_d: 0.505756
0.6521 --- loss: 1.335569, loss_ss: 0.712452, loss_d: 0.623117
0.6904 --- loss: 1.748322, loss_ss: 0.678053, loss_d: 1.070270
0.7288 --- loss: 1.295012, loss_ss: 0.919628, loss_d: 0.375384
0.7672 --- loss: 1.676264, loss_ss: 0.991026, loss_d: 0.685238
0.8055 --- loss: 1.628613, loss_ss: 1.138554, loss_d: 0.490059
0.8439 --- loss: 1.112362, loss_ss: 0.742941, loss_d: 0.369420
0.8822 --- loss: 1.396473, loss_ss: 0.848942, loss_d: 0.547532
0.9206 --- loss: 1.627453, loss_ss: 0.716022, loss_d: 0.911432
0.9590 --- loss: 1.968957, loss_ss: 1.132682, loss_d: 0.836276
0.9973 --- loss: 1.230880, loss_ss: 0.831710, loss_d: 0.399170
Epoch finished! Loss: 1.3331531098255744
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.550876, loss_ss: 0.993607, loss_d: 0.557269
0.0384 --- loss: 1.252615, loss_ss: 0.851157, loss_d: 0.401457
0.0767 --- loss: 1.347279, loss_ss: 0.789892, loss_d: 0.557387
0.1151 --- loss: 1.708605, loss_ss: 0.905875, loss_d: 0.802730
0.1534 --- loss: 1.086455, loss_ss: 0.786404, loss_d: 0.300051
0.1918 --- loss: 1.299313, loss_ss: 0.881701, loss_d: 0.417612
0.2301 --- loss: 1.783750, loss_ss: 1.163538, loss_d: 0.620212
0.2685 --- loss: 1.327582, loss_ss: 0.999265, loss_d: 0.328317
0.3069 --- loss: 1.244589, loss_ss: 0.811388, loss_d: 0.433200
0.3452 --- loss: 1.552899, loss_ss: 0.962991, loss_d: 0.589908
0.3836 --- loss: 1.634920, loss_ss: 1.105589, loss_d: 0.529331
0.4219 --- loss: 1.247700, loss_ss: 0.683928, loss_d: 0.563772
0.4603 --- loss: 1.018939, loss_ss: 0.805404, loss_d: 0.213536
0.4987 --- loss: 1.117683, loss_ss: 0.862505, loss_d: 0.255178
0.5370 --- loss: 0.870297, loss_ss: 0.644066, loss_d: 0.226231
0.5754 --- loss: 1.349828, loss_ss: 0.859298, loss_d: 0.490529
0.6137 --- loss: 1.495837, loss_ss: 1.175146, loss_d: 0.320692
0.6521 --- loss: 1.102924, loss_ss: 0.797923, loss_d: 0.305001
0.6904 --- loss: 1.523617, loss_ss: 0.814470, loss_d: 0.709147
0.7288 --- loss: 0.974700, loss_ss: 0.686967, loss_d: 0.287733
0.7672 --- loss: 1.091878, loss_ss: 0.840185, loss_d: 0.251693
0.8055 --- loss: 1.130130, loss_ss: 0.756586, loss_d: 0.373544
0.8439 --- loss: 1.629992, loss_ss: 1.156078, loss_d: 0.473915
0.8822 --- loss: 1.542107, loss_ss: 0.916969, loss_d: 0.625138
0.9206 --- loss: 1.179315, loss_ss: 0.840995, loss_d: 0.338321
0.9590 --- loss: 1.242955, loss_ss: 0.782261, loss_d: 0.460695
0.9973 --- loss: 1.017784, loss_ss: 0.846524, loss_d: 0.171260
Epoch finished! Loss: 1.2710811821314005
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.022560, loss_ss: 0.779875, loss_d: 0.242685
0.0384 --- loss: 1.538340, loss_ss: 0.931335, loss_d: 0.607004
0.0767 --- loss: 1.716936, loss_ss: 1.074832, loss_d: 0.642104
0.1151 --- loss: 1.221321, loss_ss: 0.959540, loss_d: 0.261780
0.1534 --- loss: 1.512012, loss_ss: 0.809268, loss_d: 0.702744
0.1918 --- loss: 1.247918, loss_ss: 0.778464, loss_d: 0.469453
0.2301 --- loss: 1.195991, loss_ss: 0.901990, loss_d: 0.294001
0.2685 --- loss: 0.996427, loss_ss: 0.755234, loss_d: 0.241193
0.3069 --- loss: 1.784660, loss_ss: 1.215780, loss_d: 0.568881
0.3452 --- loss: 1.185113, loss_ss: 0.961768, loss_d: 0.223345
0.3836 --- loss: 1.099885, loss_ss: 0.783662, loss_d: 0.316223
0.4219 --- loss: 1.301184, loss_ss: 1.069628, loss_d: 0.231556
0.4603 --- loss: 0.881086, loss_ss: 0.534621, loss_d: 0.346465
0.4987 --- loss: 1.388507, loss_ss: 1.026062, loss_d: 0.362445
0.5370 --- loss: 1.548531, loss_ss: 1.153312, loss_d: 0.395220
0.5754 --- loss: 0.888974, loss_ss: 0.519147, loss_d: 0.369827
0.6137 --- loss: 0.892225, loss_ss: 0.705883, loss_d: 0.186342
0.6521 --- loss: 0.960244, loss_ss: 0.550722, loss_d: 0.409522
0.6904 --- loss: 0.963561, loss_ss: 0.711144, loss_d: 0.252417
0.7288 --- loss: 1.354195, loss_ss: 0.868654, loss_d: 0.485540
0.7672 --- loss: 0.882691, loss_ss: 0.718395, loss_d: 0.164296
0.8055 --- loss: 1.047710, loss_ss: 0.690478, loss_d: 0.357232
0.8439 --- loss: 1.003083, loss_ss: 0.859389, loss_d: 0.143694
0.8822 --- loss: 1.388371, loss_ss: 0.821624, loss_d: 0.566747
0.9206 --- loss: 1.230314, loss_ss: 0.613192, loss_d: 0.617122
0.9590 --- loss: 1.237261, loss_ss: 0.877200, loss_d: 0.360060
0.9973 --- loss: 0.941602, loss_ss: 0.547962, loss_d: 0.393640
Epoch finished! Loss: 1.2086513441342575
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.060247, loss_ss: 0.562795, loss_d: 0.497452
0.0384 --- loss: 1.311036, loss_ss: 1.079553, loss_d: 0.231482
0.0767 --- loss: 0.846680, loss_ss: 0.663124, loss_d: 0.183556
0.1151 --- loss: 1.198750, loss_ss: 0.894650, loss_d: 0.304099
0.1534 --- loss: 1.368346, loss_ss: 0.914974, loss_d: 0.453372
0.1918 --- loss: 1.211160, loss_ss: 0.612201, loss_d: 0.598959
0.2301 --- loss: 0.967288, loss_ss: 0.818493, loss_d: 0.148795
0.2685 --- loss: 1.670366, loss_ss: 1.334798, loss_d: 0.335568
0.3069 --- loss: 1.015186, loss_ss: 0.737680, loss_d: 0.277506
0.3452 --- loss: 1.122714, loss_ss: 0.779018, loss_d: 0.343697
0.3836 --- loss: 1.235141, loss_ss: 0.862681, loss_d: 0.372460
0.4219 --- loss: 1.235479, loss_ss: 1.019264, loss_d: 0.216215
0.4603 --- loss: 1.193254, loss_ss: 0.924164, loss_d: 0.269090
0.4987 --- loss: 0.959288, loss_ss: 0.806101, loss_d: 0.153187
0.5370 --- loss: 1.307362, loss_ss: 1.157945, loss_d: 0.149417
0.5754 --- loss: 1.383238, loss_ss: 0.893288, loss_d: 0.489950
0.6137 --- loss: 1.155838, loss_ss: 1.016963, loss_d: 0.138875
0.6521 --- loss: 1.736452, loss_ss: 0.953038, loss_d: 0.783414
0.6904 --- loss: 1.682167, loss_ss: 0.949507, loss_d: 0.732660
0.7288 --- loss: 1.249219, loss_ss: 0.981130, loss_d: 0.268088
0.7672 --- loss: 1.344371, loss_ss: 0.788236, loss_d: 0.556135
0.8055 --- loss: 1.195775, loss_ss: 1.011718, loss_d: 0.184057
0.8439 --- loss: 0.958767, loss_ss: 0.679783, loss_d: 0.278984
0.8822 --- loss: 1.116744, loss_ss: 0.842655, loss_d: 0.274089
0.9206 --- loss: 1.255330, loss_ss: 0.706852, loss_d: 0.548479
0.9590 --- loss: 0.895791, loss_ss: 0.726562, loss_d: 0.169229
0.9973 --- loss: 0.939366, loss_ss: 0.818205, loss_d: 0.121161
Epoch finished! Loss: 1.1650656255391927
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5333333333333333
             precision    recall  f1-score   support

        0.0       0.26      0.53      0.35        36
        1.0       0.50      0.03      0.05       112
        2.0       0.36      0.84      0.50       224
        3.0       0.88      0.88      0.88       226
        4.0       0.89      0.26      0.40       332

avg / total       0.69      0.53      0.50       930
 


====== chp019-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.37  52.78   93.96  26.03     34.86
1  87.96   2.68   99.63  50.00      5.08
2  59.89  84.38   52.12  35.86     50.33
3  93.98  87.61   96.02  87.61     87.61
4  72.47  26.20   98.16  88.78     40.47
Total accuracy: 53.33%
Average sen: 50.73%
Average spec: 87.98%
Macro f1-score: 43.67%
Diagnosis acc on 15mins: 1.0
[0.93732804 0.56675363 0.83289278 0.85565919 0.86658245 0.94056112
 0.90281779 0.90958536 0.85972607 0.84139103 0.8274731  0.90411162
 0.87972075 0.9795959  0.9588666  0.96433717 0.97922528 0.94174629
 0.98073888 0.96146512 0.90068817 0.95747924 0.84740973 0.91830724
 0.98108816 0.98769522 0.97248399 0.98709041 0.91412002 0.9027378
 0.96976858]
pred: 0.9106273131985818, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp020-nsrr. train_data(2600), test_data(38) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.320078, loss_ss: 1.622561, loss_d: 0.697517
0.0385 --- loss: 1.988454, loss_ss: 1.440722, loss_d: 0.547732
0.0769 --- loss: 2.002547, loss_ss: 1.341358, loss_d: 0.661189
0.1154 --- loss: 1.946067, loss_ss: 1.522805, loss_d: 0.423262
0.1538 --- loss: 2.170130, loss_ss: 1.416146, loss_d: 0.753984
0.1923 --- loss: 2.001209, loss_ss: 1.308638, loss_d: 0.692571
0.2308 --- loss: 1.942917, loss_ss: 1.235426, loss_d: 0.707491
0.2692 --- loss: 2.159187, loss_ss: 1.537202, loss_d: 0.621985
0.3077 --- loss: 2.182756, loss_ss: 1.373541, loss_d: 0.809215
0.3462 --- loss: 1.917580, loss_ss: 1.346284, loss_d: 0.571295
0.3846 --- loss: 1.897006, loss_ss: 1.316551, loss_d: 0.580455
0.4231 --- loss: 1.942270, loss_ss: 1.374367, loss_d: 0.567904
0.4615 --- loss: 2.246706, loss_ss: 1.409679, loss_d: 0.837028
0.5000 --- loss: 1.464706, loss_ss: 1.142304, loss_d: 0.322402
0.5385 --- loss: 1.749327, loss_ss: 1.262572, loss_d: 0.486755
0.5769 --- loss: 2.024706, loss_ss: 1.197989, loss_d: 0.826717
0.6154 --- loss: 1.645837, loss_ss: 1.242118, loss_d: 0.403719
0.6538 --- loss: 1.934482, loss_ss: 1.276405, loss_d: 0.658077
0.6923 --- loss: 2.134058, loss_ss: 1.530482, loss_d: 0.603576
0.7308 --- loss: 1.746760, loss_ss: 1.128571, loss_d: 0.618189
0.7692 --- loss: 1.792264, loss_ss: 1.263117, loss_d: 0.529147
0.8077 --- loss: 1.743827, loss_ss: 1.181309, loss_d: 0.562518
0.8462 --- loss: 1.826910, loss_ss: 1.167318, loss_d: 0.659593
0.8846 --- loss: 1.512376, loss_ss: 1.049838, loss_d: 0.462538
0.9231 --- loss: 1.599766, loss_ss: 1.194915, loss_d: 0.404852
0.9615 --- loss: 1.626349, loss_ss: 1.128622, loss_d: 0.497726
Epoch finished! Loss: 1.9000960777164886
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.660534, loss_ss: 1.218745, loss_d: 0.441789
0.0385 --- loss: 1.628879, loss_ss: 1.021084, loss_d: 0.607795
0.0769 --- loss: 1.453981, loss_ss: 1.009797, loss_d: 0.444184
0.1154 --- loss: 1.393048, loss_ss: 0.988519, loss_d: 0.404529
0.1538 --- loss: 1.605539, loss_ss: 1.178641, loss_d: 0.426899
0.1923 --- loss: 1.552149, loss_ss: 0.899588, loss_d: 0.652562
0.2308 --- loss: 1.714670, loss_ss: 1.042751, loss_d: 0.671919
0.2692 --- loss: 2.017346, loss_ss: 1.554789, loss_d: 0.462557
0.3077 --- loss: 1.871115, loss_ss: 1.096117, loss_d: 0.774998
0.3462 --- loss: 1.758511, loss_ss: 1.085835, loss_d: 0.672677
0.3846 --- loss: 1.904176, loss_ss: 1.353204, loss_d: 0.550972
0.4231 --- loss: 1.518245, loss_ss: 1.005425, loss_d: 0.512820
0.4615 --- loss: 1.697209, loss_ss: 1.164557, loss_d: 0.532652
0.5000 --- loss: 1.676791, loss_ss: 1.077782, loss_d: 0.599009
0.5385 --- loss: 1.674775, loss_ss: 1.065118, loss_d: 0.609657
0.5769 --- loss: 1.220955, loss_ss: 0.800133, loss_d: 0.420822
0.6154 --- loss: 1.534557, loss_ss: 1.100224, loss_d: 0.434332
0.6538 --- loss: 1.497241, loss_ss: 1.134861, loss_d: 0.362380
0.6923 --- loss: 1.809538, loss_ss: 1.232437, loss_d: 0.577102
0.7308 --- loss: 1.486599, loss_ss: 0.932289, loss_d: 0.554310
0.7692 --- loss: 1.630823, loss_ss: 0.954609, loss_d: 0.676214
0.8077 --- loss: 1.905562, loss_ss: 1.219470, loss_d: 0.686092
0.8462 --- loss: 1.739377, loss_ss: 1.172723, loss_d: 0.566654
0.8846 --- loss: 1.362606, loss_ss: 0.935205, loss_d: 0.427401
0.9231 --- loss: 1.317633, loss_ss: 0.895889, loss_d: 0.421743
0.9615 --- loss: 1.615004, loss_ss: 1.061895, loss_d: 0.553109
Epoch finished! Loss: 1.6835161019476224
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.504369, loss_ss: 1.110269, loss_d: 0.394100
0.0385 --- loss: 1.592245, loss_ss: 0.976294, loss_d: 0.615950
0.0769 --- loss: 1.699784, loss_ss: 1.220660, loss_d: 0.479124
0.1154 --- loss: 1.757492, loss_ss: 1.047295, loss_d: 0.710197
0.1538 --- loss: 1.705902, loss_ss: 1.220972, loss_d: 0.484930
0.1923 --- loss: 1.725541, loss_ss: 1.220470, loss_d: 0.505070
0.2308 --- loss: 1.631066, loss_ss: 1.000087, loss_d: 0.630979
0.2692 --- loss: 1.845310, loss_ss: 1.187921, loss_d: 0.657390
0.3077 --- loss: 1.545438, loss_ss: 0.945017, loss_d: 0.600421
0.3462 --- loss: 1.659876, loss_ss: 1.009891, loss_d: 0.649985
0.3846 --- loss: 1.544570, loss_ss: 1.112885, loss_d: 0.431685
0.4231 --- loss: 1.671051, loss_ss: 1.004602, loss_d: 0.666448
0.4615 --- loss: 1.636245, loss_ss: 1.117871, loss_d: 0.518374
0.5000 --- loss: 1.549433, loss_ss: 1.118628, loss_d: 0.430805
0.5385 --- loss: 1.362788, loss_ss: 0.838945, loss_d: 0.523843
0.5769 --- loss: 1.485031, loss_ss: 1.098366, loss_d: 0.386665
0.6154 --- loss: 1.994976, loss_ss: 1.286636, loss_d: 0.708340
0.6538 --- loss: 1.538523, loss_ss: 1.078978, loss_d: 0.459545
0.6923 --- loss: 1.343668, loss_ss: 0.820912, loss_d: 0.522757
0.7308 --- loss: 1.452130, loss_ss: 0.845681, loss_d: 0.606449
0.7692 --- loss: 1.339687, loss_ss: 0.897856, loss_d: 0.441831
0.8077 --- loss: 1.324763, loss_ss: 0.901304, loss_d: 0.423460
0.8462 --- loss: 1.366899, loss_ss: 0.936560, loss_d: 0.430339
0.8846 --- loss: 1.915986, loss_ss: 1.217031, loss_d: 0.698955
0.9231 --- loss: 1.969125, loss_ss: 1.268278, loss_d: 0.700847
0.9615 --- loss: 1.485035, loss_ss: 0.970891, loss_d: 0.514144
Epoch finished! Loss: 1.6035211910152067
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.349593, loss_ss: 0.822168, loss_d: 0.527425
0.0385 --- loss: 1.746055, loss_ss: 1.146784, loss_d: 0.599271
0.0769 --- loss: 1.515860, loss_ss: 0.850186, loss_d: 0.665674
0.1154 --- loss: 1.113406, loss_ss: 0.775186, loss_d: 0.338219
0.1538 --- loss: 1.389024, loss_ss: 0.837207, loss_d: 0.551817
0.1923 --- loss: 1.759588, loss_ss: 1.109393, loss_d: 0.650195
0.2308 --- loss: 1.165540, loss_ss: 0.728766, loss_d: 0.436774
0.2692 --- loss: 1.356370, loss_ss: 0.924726, loss_d: 0.431644
0.3077 --- loss: 1.525028, loss_ss: 1.066223, loss_d: 0.458804
0.3462 --- loss: 1.440115, loss_ss: 0.949723, loss_d: 0.490392
0.3846 --- loss: 1.264867, loss_ss: 0.896568, loss_d: 0.368298
0.4231 --- loss: 1.298123, loss_ss: 1.028343, loss_d: 0.269780
0.4615 --- loss: 1.293454, loss_ss: 1.045859, loss_d: 0.247595
0.5000 --- loss: 1.631388, loss_ss: 1.332090, loss_d: 0.299299
0.5385 --- loss: 1.456215, loss_ss: 0.894939, loss_d: 0.561276
0.5769 --- loss: 1.675139, loss_ss: 1.113977, loss_d: 0.561162
0.6154 --- loss: 1.445333, loss_ss: 0.995759, loss_d: 0.449573
0.6538 --- loss: 1.297051, loss_ss: 1.055630, loss_d: 0.241420
0.6923 --- loss: 1.372307, loss_ss: 0.872905, loss_d: 0.499401
0.7308 --- loss: 1.577070, loss_ss: 1.183057, loss_d: 0.394014
0.7692 --- loss: 1.464303, loss_ss: 0.953163, loss_d: 0.511140
0.8077 --- loss: 1.462170, loss_ss: 1.180278, loss_d: 0.281892
0.8462 --- loss: 1.596959, loss_ss: 1.115822, loss_d: 0.481138
0.8846 --- loss: 1.227671, loss_ss: 0.891642, loss_d: 0.336028
0.9231 --- loss: 1.495299, loss_ss: 1.175893, loss_d: 0.319405
0.9615 --- loss: 1.660558, loss_ss: 0.841319, loss_d: 0.819239
Epoch finished! Loss: 1.5288529193539417
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.452427, loss_ss: 0.812286, loss_d: 0.640140
0.0385 --- loss: 1.231820, loss_ss: 0.808645, loss_d: 0.423175
0.0769 --- loss: 1.548283, loss_ss: 0.954102, loss_d: 0.594181
0.1154 --- loss: 1.375798, loss_ss: 0.795340, loss_d: 0.580457
0.1538 --- loss: 1.309100, loss_ss: 1.049508, loss_d: 0.259592
0.1923 --- loss: 1.407471, loss_ss: 0.920322, loss_d: 0.487149
0.2308 --- loss: 1.579807, loss_ss: 1.073149, loss_d: 0.506657
0.2692 --- loss: 1.918063, loss_ss: 1.370658, loss_d: 0.547405
0.3077 --- loss: 1.135149, loss_ss: 0.945578, loss_d: 0.189571
0.3462 --- loss: 1.430724, loss_ss: 0.745873, loss_d: 0.684851
0.3846 --- loss: 1.497245, loss_ss: 0.915008, loss_d: 0.582237
0.4231 --- loss: 1.147654, loss_ss: 0.814961, loss_d: 0.332693
0.4615 --- loss: 1.098307, loss_ss: 0.735268, loss_d: 0.363039
0.5000 --- loss: 0.946413, loss_ss: 0.714927, loss_d: 0.231486
0.5385 --- loss: 1.463485, loss_ss: 0.919743, loss_d: 0.543741
0.5769 --- loss: 1.354668, loss_ss: 1.089504, loss_d: 0.265164
0.6154 --- loss: 1.385494, loss_ss: 0.946504, loss_d: 0.438990
0.6538 --- loss: 1.441106, loss_ss: 0.878776, loss_d: 0.562330
0.6923 --- loss: 1.407069, loss_ss: 0.984654, loss_d: 0.422415
0.7308 --- loss: 1.092711, loss_ss: 0.824795, loss_d: 0.267916
0.7692 --- loss: 1.534048, loss_ss: 1.022276, loss_d: 0.511772
0.8077 --- loss: 1.321032, loss_ss: 0.955711, loss_d: 0.365322
0.8462 --- loss: 1.621549, loss_ss: 0.833732, loss_d: 0.787818
0.8846 --- loss: 1.628948, loss_ss: 1.215078, loss_d: 0.413869
0.9231 --- loss: 1.168906, loss_ss: 0.727805, loss_d: 0.441101
0.9615 --- loss: 1.402535, loss_ss: 1.103053, loss_d: 0.299481
Epoch finished! Loss: 1.4400863513983355
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.268767, loss_ss: 0.884702, loss_d: 0.384065
0.0385 --- loss: 1.223310, loss_ss: 0.951558, loss_d: 0.271751
0.0769 --- loss: 1.174641, loss_ss: 0.883003, loss_d: 0.291638
0.1154 --- loss: 1.047011, loss_ss: 0.730968, loss_d: 0.316043
0.1538 --- loss: 1.551295, loss_ss: 0.992972, loss_d: 0.558324
0.1923 --- loss: 1.536676, loss_ss: 0.890375, loss_d: 0.646301
0.2308 --- loss: 1.344591, loss_ss: 0.869788, loss_d: 0.474802
0.2692 --- loss: 1.425429, loss_ss: 0.750509, loss_d: 0.674920
0.3077 --- loss: 1.207867, loss_ss: 0.944306, loss_d: 0.263561
0.3462 --- loss: 1.023707, loss_ss: 0.777010, loss_d: 0.246698
0.3846 --- loss: 1.083685, loss_ss: 0.768615, loss_d: 0.315070
0.4231 --- loss: 1.516645, loss_ss: 0.947846, loss_d: 0.568799
0.4615 --- loss: 1.057683, loss_ss: 0.845522, loss_d: 0.212162
0.5000 --- loss: 1.255177, loss_ss: 0.929347, loss_d: 0.325830
0.5385 --- loss: 1.449914, loss_ss: 1.169106, loss_d: 0.280808
0.5769 --- loss: 1.538399, loss_ss: 0.738856, loss_d: 0.799543
0.6154 --- loss: 1.580100, loss_ss: 1.103328, loss_d: 0.476772
0.6538 --- loss: 0.965948, loss_ss: 0.805402, loss_d: 0.160546
0.6923 --- loss: 1.636131, loss_ss: 1.215167, loss_d: 0.420964
0.7308 --- loss: 1.333277, loss_ss: 0.910416, loss_d: 0.422861
0.7692 --- loss: 1.636117, loss_ss: 1.076169, loss_d: 0.559949
0.8077 --- loss: 1.100667, loss_ss: 0.883103, loss_d: 0.217564
0.8462 --- loss: 1.552713, loss_ss: 1.328330, loss_d: 0.224383
0.8846 --- loss: 1.363997, loss_ss: 1.086049, loss_d: 0.277947
0.9231 --- loss: 1.557000, loss_ss: 1.237327, loss_d: 0.319673
0.9615 --- loss: 1.650175, loss_ss: 1.494306, loss_d: 0.155870
Epoch finished! Loss: 1.346564691959661
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.034065, loss_ss: 0.885202, loss_d: 0.148863
0.0385 --- loss: 1.091427, loss_ss: 0.743908, loss_d: 0.347519
0.0769 --- loss: 1.091818, loss_ss: 0.874610, loss_d: 0.217208
0.1154 --- loss: 1.282176, loss_ss: 0.844051, loss_d: 0.438125
0.1538 --- loss: 1.188079, loss_ss: 0.998170, loss_d: 0.189910
0.1923 --- loss: 1.195900, loss_ss: 0.807197, loss_d: 0.388703
0.2308 --- loss: 1.638235, loss_ss: 1.214150, loss_d: 0.424085
0.2692 --- loss: 1.547532, loss_ss: 1.421805, loss_d: 0.125727
0.3077 --- loss: 1.042569, loss_ss: 0.704851, loss_d: 0.337718
0.3462 --- loss: 1.741587, loss_ss: 0.637540, loss_d: 1.104047
0.3846 --- loss: 1.456295, loss_ss: 0.976933, loss_d: 0.479362
0.4231 --- loss: 1.485798, loss_ss: 0.910007, loss_d: 0.575791
0.4615 --- loss: 1.137586, loss_ss: 0.924097, loss_d: 0.213489
0.5000 --- loss: 1.096822, loss_ss: 0.679020, loss_d: 0.417802
0.5385 --- loss: 1.785591, loss_ss: 1.039782, loss_d: 0.745809
0.5769 --- loss: 0.980903, loss_ss: 0.802619, loss_d: 0.178283
0.6154 --- loss: 1.807208, loss_ss: 1.069242, loss_d: 0.737966
0.6538 --- loss: 1.456844, loss_ss: 0.808812, loss_d: 0.648032
0.6923 --- loss: 1.140725, loss_ss: 0.740020, loss_d: 0.400705
0.7308 --- loss: 1.144897, loss_ss: 0.664661, loss_d: 0.480236
0.7692 --- loss: 1.169663, loss_ss: 0.763009, loss_d: 0.406654
0.8077 --- loss: 1.594893, loss_ss: 1.225231, loss_d: 0.369662
0.8462 --- loss: 1.655566, loss_ss: 1.183954, loss_d: 0.471611
0.8846 --- loss: 1.133535, loss_ss: 0.970590, loss_d: 0.162945
0.9231 --- loss: 1.439476, loss_ss: 0.982577, loss_d: 0.456898
0.9615 --- loss: 1.629144, loss_ss: 0.911502, loss_d: 0.717642
Epoch finished! Loss: 1.28295661675884
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.211207, loss_ss: 0.840818, loss_d: 0.370389
0.0385 --- loss: 1.130868, loss_ss: 0.871842, loss_d: 0.259026
0.0769 --- loss: 1.211012, loss_ss: 0.971773, loss_d: 0.239239
0.1154 --- loss: 1.328701, loss_ss: 0.712590, loss_d: 0.616111
0.1538 --- loss: 1.417722, loss_ss: 0.938182, loss_d: 0.479540
0.1923 --- loss: 1.409743, loss_ss: 1.038769, loss_d: 0.370974
0.2308 --- loss: 1.065588, loss_ss: 0.768613, loss_d: 0.296975
0.2692 --- loss: 1.323043, loss_ss: 1.089600, loss_d: 0.233443
0.3077 --- loss: 1.244700, loss_ss: 0.862765, loss_d: 0.381935
0.3462 --- loss: 1.201013, loss_ss: 1.026756, loss_d: 0.174257
0.3846 --- loss: 1.121318, loss_ss: 0.828309, loss_d: 0.293010
0.4231 --- loss: 1.238281, loss_ss: 0.919236, loss_d: 0.319044
0.4615 --- loss: 1.663740, loss_ss: 0.891061, loss_d: 0.772679
0.5000 --- loss: 1.216041, loss_ss: 0.859366, loss_d: 0.356675
0.5385 --- loss: 1.034251, loss_ss: 0.822671, loss_d: 0.211580
0.5769 --- loss: 0.883362, loss_ss: 0.727013, loss_d: 0.156349
0.6154 --- loss: 1.274258, loss_ss: 0.875098, loss_d: 0.399160
0.6538 --- loss: 0.991459, loss_ss: 0.833256, loss_d: 0.158202
0.6923 --- loss: 0.963055, loss_ss: 0.800950, loss_d: 0.162105
0.7308 --- loss: 0.981460, loss_ss: 0.860515, loss_d: 0.120945
0.7692 --- loss: 1.242373, loss_ss: 0.947717, loss_d: 0.294657
0.8077 --- loss: 1.001899, loss_ss: 0.815267, loss_d: 0.186632
0.8462 --- loss: 1.310329, loss_ss: 1.165704, loss_d: 0.144625
0.8846 --- loss: 1.093928, loss_ss: 0.959827, loss_d: 0.134102
0.9231 --- loss: 1.046850, loss_ss: 0.868160, loss_d: 0.178690
0.9615 --- loss: 1.050047, loss_ss: 0.943489, loss_d: 0.106558
Epoch finished! Loss: 1.215445295033768
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.231412, loss_ss: 1.053414, loss_d: 0.177998
0.0385 --- loss: 1.455757, loss_ss: 1.306370, loss_d: 0.149387
0.0769 --- loss: 1.092033, loss_ss: 0.897942, loss_d: 0.194091
0.1154 --- loss: 1.008812, loss_ss: 0.851485, loss_d: 0.157327
0.1538 --- loss: 1.165172, loss_ss: 0.955117, loss_d: 0.210055
0.1923 --- loss: 0.942358, loss_ss: 0.827543, loss_d: 0.114816
0.2308 --- loss: 1.243296, loss_ss: 0.880011, loss_d: 0.363284
0.2692 --- loss: 1.321501, loss_ss: 1.180390, loss_d: 0.141111
0.3077 --- loss: 0.898748, loss_ss: 0.634198, loss_d: 0.264550
0.3462 --- loss: 1.003896, loss_ss: 0.777422, loss_d: 0.226474
0.3846 --- loss: 1.437907, loss_ss: 1.008718, loss_d: 0.429189
0.4231 --- loss: 1.108509, loss_ss: 0.762146, loss_d: 0.346363
0.4615 --- loss: 0.999428, loss_ss: 0.781476, loss_d: 0.217952
0.5000 --- loss: 1.391780, loss_ss: 1.035945, loss_d: 0.355836
0.5385 --- loss: 0.927848, loss_ss: 0.778274, loss_d: 0.149574
0.5769 --- loss: 1.916678, loss_ss: 1.075655, loss_d: 0.841022
0.6154 --- loss: 1.470993, loss_ss: 0.871817, loss_d: 0.599176
0.6538 --- loss: 1.397538, loss_ss: 1.029392, loss_d: 0.368147
0.6923 --- loss: 1.012278, loss_ss: 0.780896, loss_d: 0.231382
0.7308 --- loss: 1.058235, loss_ss: 0.802521, loss_d: 0.255714
0.7692 --- loss: 1.052048, loss_ss: 0.619329, loss_d: 0.432720
0.8077 --- loss: 1.730078, loss_ss: 0.721923, loss_d: 1.008156
0.8462 --- loss: 0.893761, loss_ss: 0.710146, loss_d: 0.183615
0.8846 --- loss: 1.044523, loss_ss: 0.786773, loss_d: 0.257750
0.9231 --- loss: 1.109776, loss_ss: 0.722732, loss_d: 0.387044
0.9615 --- loss: 1.396103, loss_ss: 1.035852, loss_d: 0.360251
Epoch finished! Loss: 1.2087737400099117
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.095606, loss_ss: 0.735168, loss_d: 0.360438
0.0385 --- loss: 0.856404, loss_ss: 0.684360, loss_d: 0.172044
0.0769 --- loss: 0.830061, loss_ss: 0.628000, loss_d: 0.202061
0.1154 --- loss: 1.787685, loss_ss: 0.778698, loss_d: 1.008988
0.1538 --- loss: 1.098764, loss_ss: 0.850691, loss_d: 0.248073
0.1923 --- loss: 1.485217, loss_ss: 0.744869, loss_d: 0.740349
0.2308 --- loss: 0.851909, loss_ss: 0.639287, loss_d: 0.212622
0.2692 --- loss: 1.038030, loss_ss: 0.877664, loss_d: 0.160366
0.3077 --- loss: 0.817594, loss_ss: 0.707819, loss_d: 0.109775
0.3462 --- loss: 1.159920, loss_ss: 0.810381, loss_d: 0.349539
0.3846 --- loss: 1.231962, loss_ss: 0.740287, loss_d: 0.491675
0.4231 --- loss: 0.787497, loss_ss: 0.687102, loss_d: 0.100395
0.4615 --- loss: 0.997938, loss_ss: 0.794583, loss_d: 0.203354
0.5000 --- loss: 1.010054, loss_ss: 0.869768, loss_d: 0.140286
0.5385 --- loss: 1.474765, loss_ss: 1.040612, loss_d: 0.434152
0.5769 --- loss: 1.041682, loss_ss: 0.657771, loss_d: 0.383911
0.6154 --- loss: 1.797729, loss_ss: 1.178285, loss_d: 0.619444
0.6538 --- loss: 1.566460, loss_ss: 1.101149, loss_d: 0.465311
0.6923 --- loss: 1.037046, loss_ss: 0.855556, loss_d: 0.181490
0.7308 --- loss: 1.256741, loss_ss: 0.828792, loss_d: 0.427949
0.7692 --- loss: 0.982324, loss_ss: 0.817782, loss_d: 0.164542
0.8077 --- loss: 0.834547, loss_ss: 0.685067, loss_d: 0.149480
0.8462 --- loss: 0.903237, loss_ss: 0.752069, loss_d: 0.151168
0.8846 --- loss: 1.303535, loss_ss: 1.025653, loss_d: 0.277882
0.9231 --- loss: 0.722478, loss_ss: 0.637130, loss_d: 0.085348
0.9615 --- loss: 1.062464, loss_ss: 0.886816, loss_d: 0.175649
Epoch finished! Loss: 1.1482302592527913
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6052631578947368
             precision    recall  f1-score   support

        0.0       0.81      0.54      0.65       297
        1.0       0.43      0.07      0.13       200
        2.0       0.54      1.00      0.70       354
        3.0       0.97      0.48      0.65       159
        4.0       0.49      0.65      0.56       130

avg / total       0.65      0.61      0.56      1140
 


====== chp020-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.65  53.87   95.49  80.81     64.65
1  82.02   7.50   97.87  42.86     12.77
2  73.33  99.72   61.45  53.81     69.90
3  92.63  48.43   99.80  97.47     64.71
4  88.42  65.38   91.39  49.42     56.29
Total accuracy: 60.53%
Average sen: 54.98%
Average spec: 89.20%
Macro f1-score: 53.66%
Diagnosis acc on 15mins: 0.9210526315789473
[0.9111374  0.90618747 0.44176564 0.34620363 0.84546268 0.70421088
 0.45133874 0.72006142 0.76306868 0.99545938 0.99984598 0.99975246
 0.99948186 0.94603735 0.79310793 0.97096115 0.99901998 0.99867463
 0.9998455  0.99994814 0.9999212  0.99937171 0.99763322 0.98675323
 0.96599883 0.99701393 0.89545554 0.84960413 0.86159348 0.99758279
 0.9949013  0.99897373 0.99951363 0.99821007 0.94329733 0.90722805
 0.99805629 0.87509269]
pred: 0.8962571589570296, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp022-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.274885, loss_ss: 1.595115, loss_d: 0.679771
0.0385 --- loss: 2.213790, loss_ss: 1.410879, loss_d: 0.802911
0.0770 --- loss: 2.072660, loss_ss: 1.384993, loss_d: 0.687667
0.1156 --- loss: 1.851005, loss_ss: 1.408771, loss_d: 0.442235
0.1541 --- loss: 1.878133, loss_ss: 1.481797, loss_d: 0.396336
0.1926 --- loss: 2.125038, loss_ss: 1.558906, loss_d: 0.566132
0.2311 --- loss: 2.084901, loss_ss: 1.411621, loss_d: 0.673280
0.2696 --- loss: 1.744095, loss_ss: 1.441874, loss_d: 0.302221
0.3082 --- loss: 1.970077, loss_ss: 1.355601, loss_d: 0.614476
0.3467 --- loss: 1.505811, loss_ss: 1.236607, loss_d: 0.269203
0.3852 --- loss: 2.079810, loss_ss: 1.361846, loss_d: 0.717963
0.4237 --- loss: 1.799781, loss_ss: 1.188123, loss_d: 0.611658
0.4622 --- loss: 2.056736, loss_ss: 1.543748, loss_d: 0.512988
0.5008 --- loss: 1.860713, loss_ss: 1.260773, loss_d: 0.599939
0.5393 --- loss: 2.021528, loss_ss: 1.572304, loss_d: 0.449224
0.5778 --- loss: 1.785783, loss_ss: 1.197624, loss_d: 0.588160
0.6163 --- loss: 1.862661, loss_ss: 1.389126, loss_d: 0.473535
0.6549 --- loss: 1.808441, loss_ss: 1.280698, loss_d: 0.527743
0.6934 --- loss: 1.731546, loss_ss: 1.167506, loss_d: 0.564041
0.7319 --- loss: 1.977180, loss_ss: 1.509002, loss_d: 0.468178
0.7704 --- loss: 1.793538, loss_ss: 1.195353, loss_d: 0.598185
0.8089 --- loss: 2.129651, loss_ss: 1.506107, loss_d: 0.623544
0.8475 --- loss: 1.382559, loss_ss: 1.212139, loss_d: 0.170420
0.8860 --- loss: 1.867753, loss_ss: 1.246328, loss_d: 0.621425
0.9245 --- loss: 1.816833, loss_ss: 1.044720, loss_d: 0.772113
0.9630 --- loss: 1.832983, loss_ss: 1.042480, loss_d: 0.790503
Epoch finished! Loss: 1.9187809523468313
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.753051, loss_ss: 1.254896, loss_d: 0.498155
0.0385 --- loss: 1.991444, loss_ss: 1.248094, loss_d: 0.743350
0.0770 --- loss: 1.559904, loss_ss: 1.110881, loss_d: 0.449023
0.1156 --- loss: 1.695092, loss_ss: 1.352679, loss_d: 0.342413
0.1541 --- loss: 2.077483, loss_ss: 1.152311, loss_d: 0.925172
0.1926 --- loss: 1.697273, loss_ss: 1.171260, loss_d: 0.526013
0.2311 --- loss: 1.709944, loss_ss: 1.178079, loss_d: 0.531866
0.2696 --- loss: 1.705240, loss_ss: 1.020477, loss_d: 0.684764
0.3082 --- loss: 1.556776, loss_ss: 1.182378, loss_d: 0.374399
0.3467 --- loss: 1.531819, loss_ss: 1.130171, loss_d: 0.401648
0.3852 --- loss: 1.864180, loss_ss: 1.136294, loss_d: 0.727886
0.4237 --- loss: 1.828894, loss_ss: 1.254616, loss_d: 0.574278
0.4622 --- loss: 1.767765, loss_ss: 1.158351, loss_d: 0.609414
0.5008 --- loss: 1.584632, loss_ss: 1.060407, loss_d: 0.524224
0.5393 --- loss: 1.375317, loss_ss: 0.911114, loss_d: 0.464203
0.5778 --- loss: 1.783666, loss_ss: 1.169925, loss_d: 0.613741
0.6163 --- loss: 1.619132, loss_ss: 0.981009, loss_d: 0.638123
0.6549 --- loss: 1.601810, loss_ss: 1.050343, loss_d: 0.551467
0.6934 --- loss: 1.973832, loss_ss: 1.155679, loss_d: 0.818153
0.7319 --- loss: 1.747516, loss_ss: 0.947793, loss_d: 0.799723
0.7704 --- loss: 1.624148, loss_ss: 0.860294, loss_d: 0.763855
0.8089 --- loss: 1.445266, loss_ss: 1.076777, loss_d: 0.368489
0.8475 --- loss: 1.580474, loss_ss: 0.813220, loss_d: 0.767254
0.8860 --- loss: 1.941966, loss_ss: 1.110780, loss_d: 0.831185
0.9245 --- loss: 1.338299, loss_ss: 0.867193, loss_d: 0.471107
0.9630 --- loss: 1.586637, loss_ss: 0.963999, loss_d: 0.622638
Epoch finished! Loss: 1.6786749814007733
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.830715, loss_ss: 1.115077, loss_d: 0.715638
0.0385 --- loss: 1.651829, loss_ss: 1.022539, loss_d: 0.629290
0.0770 --- loss: 1.704366, loss_ss: 0.944197, loss_d: 0.760169
0.1156 --- loss: 1.528008, loss_ss: 0.920811, loss_d: 0.607196
0.1541 --- loss: 1.377887, loss_ss: 0.905557, loss_d: 0.472330
0.1926 --- loss: 1.765636, loss_ss: 0.833785, loss_d: 0.931851
0.2311 --- loss: 1.979808, loss_ss: 1.324712, loss_d: 0.655096
0.2696 --- loss: 1.655399, loss_ss: 1.013130, loss_d: 0.642269
0.3082 --- loss: 1.635221, loss_ss: 1.140584, loss_d: 0.494637
0.3467 --- loss: 1.236568, loss_ss: 0.798420, loss_d: 0.438148
0.3852 --- loss: 1.884083, loss_ss: 1.262282, loss_d: 0.621801
0.4237 --- loss: 1.895785, loss_ss: 1.255138, loss_d: 0.640647
0.4622 --- loss: 1.914239, loss_ss: 0.966069, loss_d: 0.948170
0.5008 --- loss: 1.643147, loss_ss: 1.125164, loss_d: 0.517983
0.5393 --- loss: 1.633126, loss_ss: 1.051791, loss_d: 0.581334
0.5778 --- loss: 1.704453, loss_ss: 1.187380, loss_d: 0.517073
0.6163 --- loss: 1.422497, loss_ss: 0.801912, loss_d: 0.620585
0.6549 --- loss: 1.271530, loss_ss: 0.843585, loss_d: 0.427945
0.6934 --- loss: 1.213799, loss_ss: 0.881674, loss_d: 0.332124
0.7319 --- loss: 1.640699, loss_ss: 0.863696, loss_d: 0.777003
0.7704 --- loss: 1.393654, loss_ss: 1.015877, loss_d: 0.377777
0.8089 --- loss: 1.354213, loss_ss: 0.886505, loss_d: 0.467709
0.8475 --- loss: 1.252126, loss_ss: 0.745977, loss_d: 0.506149
0.8860 --- loss: 1.622569, loss_ss: 1.167983, loss_d: 0.454586
0.9245 --- loss: 1.397472, loss_ss: 0.953689, loss_d: 0.443783
0.9630 --- loss: 1.803429, loss_ss: 0.929767, loss_d: 0.873662
Epoch finished! Loss: 1.5720903413176077
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.281998, loss_ss: 0.788858, loss_d: 0.493140
0.0385 --- loss: 1.187532, loss_ss: 0.691564, loss_d: 0.495969
0.0770 --- loss: 1.505355, loss_ss: 0.879095, loss_d: 0.626260
0.1156 --- loss: 1.836309, loss_ss: 1.117562, loss_d: 0.718746
0.1541 --- loss: 1.327855, loss_ss: 0.774855, loss_d: 0.552999
0.1926 --- loss: 1.277419, loss_ss: 0.822508, loss_d: 0.454911
0.2311 --- loss: 1.366361, loss_ss: 0.849589, loss_d: 0.516772
0.2696 --- loss: 2.280064, loss_ss: 1.657007, loss_d: 0.623056
0.3082 --- loss: 1.349238, loss_ss: 0.936326, loss_d: 0.412912
0.3467 --- loss: 1.726552, loss_ss: 1.061910, loss_d: 0.664642
0.3852 --- loss: 1.399314, loss_ss: 0.789344, loss_d: 0.609970
0.4237 --- loss: 1.704530, loss_ss: 0.904415, loss_d: 0.800115
0.4622 --- loss: 1.879630, loss_ss: 1.311106, loss_d: 0.568524
0.5008 --- loss: 1.464792, loss_ss: 0.927585, loss_d: 0.537207
0.5393 --- loss: 1.611279, loss_ss: 1.090410, loss_d: 0.520868
0.5778 --- loss: 1.638786, loss_ss: 1.103978, loss_d: 0.534808
0.6163 --- loss: 1.720332, loss_ss: 0.925347, loss_d: 0.794985
0.6549 --- loss: 1.755962, loss_ss: 1.071754, loss_d: 0.684208
0.6934 --- loss: 1.362303, loss_ss: 0.929746, loss_d: 0.432557
0.7319 --- loss: 1.386541, loss_ss: 0.896675, loss_d: 0.489866
0.7704 --- loss: 1.442065, loss_ss: 0.888026, loss_d: 0.554038
0.8089 --- loss: 1.397607, loss_ss: 1.050583, loss_d: 0.347024
0.8475 --- loss: 1.316725, loss_ss: 0.894123, loss_d: 0.422603
0.8860 --- loss: 1.153996, loss_ss: 0.762704, loss_d: 0.391292
0.9245 --- loss: 1.676905, loss_ss: 1.092193, loss_d: 0.584712
0.9630 --- loss: 1.223856, loss_ss: 0.795325, loss_d: 0.428531
Epoch finished! Loss: 1.5015355917017432
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.184992, loss_ss: 0.614127, loss_d: 0.570865
0.0385 --- loss: 1.740063, loss_ss: 1.026698, loss_d: 0.713365
0.0770 --- loss: 1.403737, loss_ss: 1.023681, loss_d: 0.380056
0.1156 --- loss: 1.486381, loss_ss: 0.928242, loss_d: 0.558139
0.1541 --- loss: 1.386550, loss_ss: 0.991953, loss_d: 0.394597
0.1926 --- loss: 1.404586, loss_ss: 0.919624, loss_d: 0.484962
0.2311 --- loss: 1.430692, loss_ss: 0.984114, loss_d: 0.446578
0.2696 --- loss: 1.107929, loss_ss: 0.893006, loss_d: 0.214923
0.3082 --- loss: 0.770337, loss_ss: 0.552814, loss_d: 0.217523
0.3467 --- loss: 1.385618, loss_ss: 1.079125, loss_d: 0.306493
0.3852 --- loss: 1.582182, loss_ss: 1.189142, loss_d: 0.393040
0.4237 --- loss: 1.305778, loss_ss: 0.826774, loss_d: 0.479003
0.4622 --- loss: 1.417021, loss_ss: 0.963747, loss_d: 0.453274
0.5008 --- loss: 1.619840, loss_ss: 0.992537, loss_d: 0.627303
0.5393 --- loss: 1.033275, loss_ss: 0.787056, loss_d: 0.246219
0.5778 --- loss: 1.061715, loss_ss: 0.595691, loss_d: 0.466024
0.6163 --- loss: 1.387757, loss_ss: 0.874173, loss_d: 0.513584
0.6549 --- loss: 1.260502, loss_ss: 0.825781, loss_d: 0.434722
0.6934 --- loss: 1.239268, loss_ss: 0.607180, loss_d: 0.632089
0.7319 --- loss: 1.207550, loss_ss: 0.727660, loss_d: 0.479890
0.7704 --- loss: 1.205647, loss_ss: 0.919140, loss_d: 0.286507
0.8089 --- loss: 1.162400, loss_ss: 0.905478, loss_d: 0.256922
0.8475 --- loss: 1.442695, loss_ss: 0.943305, loss_d: 0.499390
0.8860 --- loss: 1.396029, loss_ss: 0.980714, loss_d: 0.415315
0.9245 --- loss: 1.592232, loss_ss: 0.994491, loss_d: 0.597742
0.9630 --- loss: 1.748413, loss_ss: 0.862643, loss_d: 0.885770
Epoch finished! Loss: 1.406208588579907
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.178530, loss_ss: 0.718226, loss_d: 0.460305
0.0385 --- loss: 1.227297, loss_ss: 0.722644, loss_d: 0.504654
0.0770 --- loss: 1.240044, loss_ss: 0.883647, loss_d: 0.356397
0.1156 --- loss: 1.169376, loss_ss: 0.792313, loss_d: 0.377063
0.1541 --- loss: 1.280963, loss_ss: 0.777112, loss_d: 0.503851
0.1926 --- loss: 1.490882, loss_ss: 0.876853, loss_d: 0.614029
0.2311 --- loss: 1.417118, loss_ss: 0.944616, loss_d: 0.472502
0.2696 --- loss: 1.036586, loss_ss: 0.757760, loss_d: 0.278826
0.3082 --- loss: 1.599691, loss_ss: 1.050725, loss_d: 0.548966
0.3467 --- loss: 1.359915, loss_ss: 0.806613, loss_d: 0.553302
0.3852 --- loss: 1.133765, loss_ss: 0.786288, loss_d: 0.347477
0.4237 --- loss: 1.078055, loss_ss: 0.929277, loss_d: 0.148778
0.4622 --- loss: 1.123231, loss_ss: 0.867332, loss_d: 0.255899
0.5008 --- loss: 1.406916, loss_ss: 0.912894, loss_d: 0.494022
0.5393 --- loss: 1.407558, loss_ss: 0.861051, loss_d: 0.546507
0.5778 --- loss: 1.110955, loss_ss: 0.691096, loss_d: 0.419859
0.6163 --- loss: 1.844843, loss_ss: 0.944449, loss_d: 0.900394
0.6549 --- loss: 1.272973, loss_ss: 0.977441, loss_d: 0.295532
0.6934 --- loss: 1.694393, loss_ss: 0.987667, loss_d: 0.706725
0.7319 --- loss: 1.634166, loss_ss: 0.764678, loss_d: 0.869488
0.7704 --- loss: 1.250622, loss_ss: 0.717976, loss_d: 0.532646
0.8089 --- loss: 1.199015, loss_ss: 0.962968, loss_d: 0.236046
0.8475 --- loss: 1.125728, loss_ss: 0.918251, loss_d: 0.207478
0.8860 --- loss: 1.195018, loss_ss: 1.002979, loss_d: 0.192039
0.9245 --- loss: 1.605853, loss_ss: 1.046471, loss_d: 0.559382
0.9630 --- loss: 1.427820, loss_ss: 1.163976, loss_d: 0.263844
Epoch finished! Loss: 1.3156966412849869
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.378687, loss_ss: 0.956294, loss_d: 0.422392
0.0385 --- loss: 1.602865, loss_ss: 1.016698, loss_d: 0.586167
0.0770 --- loss: 1.287039, loss_ss: 0.922852, loss_d: 0.364186
0.1156 --- loss: 0.946277, loss_ss: 0.738132, loss_d: 0.208146
0.1541 --- loss: 0.947406, loss_ss: 0.727649, loss_d: 0.219756
0.1926 --- loss: 1.240181, loss_ss: 0.853076, loss_d: 0.387105
0.2311 --- loss: 1.297596, loss_ss: 0.923392, loss_d: 0.374203
0.2696 --- loss: 1.496924, loss_ss: 1.253272, loss_d: 0.243652
0.3082 --- loss: 0.967081, loss_ss: 0.719583, loss_d: 0.247498
0.3467 --- loss: 1.356904, loss_ss: 1.070504, loss_d: 0.286400
0.3852 --- loss: 1.091807, loss_ss: 0.762703, loss_d: 0.329104
0.4237 --- loss: 1.194672, loss_ss: 0.760609, loss_d: 0.434063
0.4622 --- loss: 1.385972, loss_ss: 1.253722, loss_d: 0.132250
0.5008 --- loss: 1.252681, loss_ss: 1.003556, loss_d: 0.249124
0.5393 --- loss: 1.133927, loss_ss: 0.902133, loss_d: 0.231794
0.5778 --- loss: 1.463484, loss_ss: 1.012936, loss_d: 0.450548
0.6163 --- loss: 1.169795, loss_ss: 0.960679, loss_d: 0.209116
0.6549 --- loss: 0.914160, loss_ss: 0.710147, loss_d: 0.204013
0.6934 --- loss: 1.575395, loss_ss: 1.078480, loss_d: 0.496915
0.7319 --- loss: 1.369249, loss_ss: 0.874792, loss_d: 0.494457
0.7704 --- loss: 1.861014, loss_ss: 1.107075, loss_d: 0.753939
0.8089 --- loss: 1.473417, loss_ss: 0.870861, loss_d: 0.602556
0.8475 --- loss: 2.021808, loss_ss: 0.817314, loss_d: 1.204493
0.8860 --- loss: 1.069390, loss_ss: 0.717914, loss_d: 0.351476
0.9245 --- loss: 1.044656, loss_ss: 0.761000, loss_d: 0.283656
0.9630 --- loss: 1.199119, loss_ss: 0.955162, loss_d: 0.243957
Epoch finished! Loss: 1.2753927875669766
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.475703, loss_ss: 0.965921, loss_d: 0.509783
0.0385 --- loss: 1.495832, loss_ss: 0.943973, loss_d: 0.551859
0.0770 --- loss: 1.317164, loss_ss: 1.060254, loss_d: 0.256910
0.1156 --- loss: 1.162733, loss_ss: 0.991916, loss_d: 0.170817
0.1541 --- loss: 0.742860, loss_ss: 0.435337, loss_d: 0.307523
0.1926 --- loss: 1.187356, loss_ss: 0.831008, loss_d: 0.356348
0.2311 --- loss: 1.120083, loss_ss: 0.749085, loss_d: 0.370998
0.2696 --- loss: 1.349667, loss_ss: 0.849153, loss_d: 0.500514
0.3082 --- loss: 1.580369, loss_ss: 1.202216, loss_d: 0.378153
0.3467 --- loss: 1.852660, loss_ss: 1.192801, loss_d: 0.659860
0.3852 --- loss: 1.347187, loss_ss: 0.897283, loss_d: 0.449904
0.4237 --- loss: 1.080474, loss_ss: 0.908076, loss_d: 0.172397
0.4622 --- loss: 1.086453, loss_ss: 0.890992, loss_d: 0.195460
0.5008 --- loss: 0.912865, loss_ss: 0.580182, loss_d: 0.332683
0.5393 --- loss: 1.591831, loss_ss: 1.334634, loss_d: 0.257197
0.5778 --- loss: 0.983065, loss_ss: 0.738732, loss_d: 0.244333
0.6163 --- loss: 0.948297, loss_ss: 0.647838, loss_d: 0.300458
0.6549 --- loss: 1.086427, loss_ss: 0.694905, loss_d: 0.391522
0.6934 --- loss: 1.186998, loss_ss: 0.940880, loss_d: 0.246118
0.7319 --- loss: 1.131277, loss_ss: 0.962701, loss_d: 0.168575
0.7704 --- loss: 1.259223, loss_ss: 0.759088, loss_d: 0.500135
0.8089 --- loss: 1.228672, loss_ss: 0.993604, loss_d: 0.235068
0.8475 --- loss: 1.076720, loss_ss: 0.714252, loss_d: 0.362468
0.8860 --- loss: 1.318335, loss_ss: 1.036494, loss_d: 0.281841
0.9245 --- loss: 1.786218, loss_ss: 1.090584, loss_d: 0.695635
0.9630 --- loss: 1.124872, loss_ss: 0.830338, loss_d: 0.294533
Epoch finished! Loss: 1.2519427774955867
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.754473, loss_ss: 1.116933, loss_d: 0.637540
0.0385 --- loss: 1.301260, loss_ss: 0.858445, loss_d: 0.442815
0.0770 --- loss: 1.553955, loss_ss: 1.004640, loss_d: 0.549315
0.1156 --- loss: 1.042560, loss_ss: 0.879170, loss_d: 0.163390
0.1541 --- loss: 1.141034, loss_ss: 0.914122, loss_d: 0.226912
0.1926 --- loss: 0.986590, loss_ss: 0.836865, loss_d: 0.149724
0.2311 --- loss: 1.447016, loss_ss: 0.514920, loss_d: 0.932097
0.2696 --- loss: 0.785833, loss_ss: 0.600384, loss_d: 0.185449
0.3082 --- loss: 1.032070, loss_ss: 0.822738, loss_d: 0.209332
0.3467 --- loss: 0.897572, loss_ss: 0.537064, loss_d: 0.360508
0.3852 --- loss: 1.144893, loss_ss: 0.841603, loss_d: 0.303290
0.4237 --- loss: 1.045179, loss_ss: 0.721818, loss_d: 0.323361
0.4622 --- loss: 1.170043, loss_ss: 0.643009, loss_d: 0.527034
0.5008 --- loss: 1.547918, loss_ss: 0.793949, loss_d: 0.753969
0.5393 --- loss: 1.137680, loss_ss: 0.876216, loss_d: 0.261464
0.5778 --- loss: 1.087045, loss_ss: 0.863559, loss_d: 0.223487
0.6163 --- loss: 1.495926, loss_ss: 0.958684, loss_d: 0.537242
0.6549 --- loss: 1.201251, loss_ss: 0.815669, loss_d: 0.385582
0.6934 --- loss: 1.127282, loss_ss: 0.604645, loss_d: 0.522637
0.7319 --- loss: 0.931975, loss_ss: 0.735107, loss_d: 0.196868
0.7704 --- loss: 1.317934, loss_ss: 0.798608, loss_d: 0.519326
0.8089 --- loss: 1.123957, loss_ss: 0.672472, loss_d: 0.451485
0.8475 --- loss: 1.133262, loss_ss: 0.788996, loss_d: 0.344265
0.8860 --- loss: 0.859869, loss_ss: 0.590424, loss_d: 0.269445
0.9245 --- loss: 0.935981, loss_ss: 0.691702, loss_d: 0.244279
0.9630 --- loss: 1.170185, loss_ss: 0.710767, loss_d: 0.459418
Epoch finished! Loss: 1.2297824386464122
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.224063, loss_ss: 0.700217, loss_d: 0.523846
0.0385 --- loss: 1.071975, loss_ss: 0.775071, loss_d: 0.296904
0.0770 --- loss: 1.238417, loss_ss: 0.984932, loss_d: 0.253485
0.1156 --- loss: 1.377518, loss_ss: 1.003970, loss_d: 0.373548
0.1541 --- loss: 1.166906, loss_ss: 0.886426, loss_d: 0.280480
0.1926 --- loss: 0.883714, loss_ss: 0.700314, loss_d: 0.183399
0.2311 --- loss: 0.864884, loss_ss: 0.706981, loss_d: 0.157902
0.2696 --- loss: 0.974397, loss_ss: 0.810630, loss_d: 0.163767
0.3082 --- loss: 0.873633, loss_ss: 0.731323, loss_d: 0.142310
0.3467 --- loss: 1.021842, loss_ss: 0.776047, loss_d: 0.245796
0.3852 --- loss: 1.252366, loss_ss: 1.028829, loss_d: 0.223536
0.4237 --- loss: 1.038140, loss_ss: 0.871338, loss_d: 0.166802
0.4622 --- loss: 1.038959, loss_ss: 0.759014, loss_d: 0.279945
0.5008 --- loss: 0.828123, loss_ss: 0.666148, loss_d: 0.161975
0.5393 --- loss: 1.384570, loss_ss: 0.949247, loss_d: 0.435324
0.5778 --- loss: 0.752755, loss_ss: 0.578057, loss_d: 0.174698
0.6163 --- loss: 1.225651, loss_ss: 0.770337, loss_d: 0.455314
0.6549 --- loss: 1.075341, loss_ss: 0.838406, loss_d: 0.236935
0.6934 --- loss: 1.691654, loss_ss: 1.492859, loss_d: 0.198795
0.7319 --- loss: 1.120226, loss_ss: 0.843634, loss_d: 0.276592
0.7704 --- loss: 1.538787, loss_ss: 1.015073, loss_d: 0.523714
0.8089 --- loss: 0.990491, loss_ss: 0.686051, loss_d: 0.304440
0.8475 --- loss: 1.550056, loss_ss: 0.683411, loss_d: 0.866645
0.8860 --- loss: 1.124252, loss_ss: 0.784909, loss_d: 0.339343
0.9245 --- loss: 1.643572, loss_ss: 1.398029, loss_d: 0.245542
0.9630 --- loss: 1.030024, loss_ss: 0.862106, loss_d: 0.167918
Epoch finished! Loss: 1.1893136241261102
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6619047619047619
             precision    recall  f1-score   support

        0.0       0.78      0.84      0.81       253
        1.0       0.51      0.27      0.35       293
        2.0       0.67      0.83      0.74       468
        3.0       0.56      0.90      0.69       107
        4.0       0.73      0.43      0.54       139

avg / total       0.65      0.66      0.64      1260
 


====== chp022-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.98  83.79   94.04  77.94     80.76
1  76.90  26.96   92.04  50.64     35.19
2  78.33  82.69   75.76  66.84     73.93
3  93.17  89.72   93.50  56.14     69.06
4  91.98  43.17   98.04  73.17     54.30
Total accuracy: 66.19%
Average sen: 65.27%
Average spec: 90.67%
Macro f1-score: 62.65%
Diagnosis acc on 15mins: 1.0
[0.99848586 0.9966718  0.99733055 0.99584216 0.99703145 0.99296772
 0.99322879 0.99418628 0.99657285 0.99466646 0.99584347 0.9967829
 0.99733633 0.99645495 0.9981457  0.99240726 0.99549651 0.99643803
 0.99680066 0.99722052 0.99531132 0.99019343 0.9976936  0.9966132
 0.99784791 0.99514174 0.99452609 0.99681681 0.99513561 0.99549133
 0.99261135 0.99034774 0.99067396 0.99327362 0.99547881 0.99527174
 0.99257398 0.99438184 0.9943006  0.99073517 0.99328035 0.99712461]
pred: 0.9951127398581732, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp024-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.568007, loss_ss: 1.840210, loss_d: 0.727798
0.0384 --- loss: 2.196759, loss_ss: 1.569531, loss_d: 0.627227
0.0769 --- loss: 2.772701, loss_ss: 1.572733, loss_d: 1.199968
0.1153 --- loss: 2.583655, loss_ss: 1.552850, loss_d: 1.030805
0.1538 --- loss: 2.594568, loss_ss: 1.614264, loss_d: 0.980304
0.1922 --- loss: 2.296990, loss_ss: 1.605558, loss_d: 0.691432
0.2307 --- loss: 2.027821, loss_ss: 1.434161, loss_d: 0.593660
0.2691 --- loss: 2.182803, loss_ss: 1.482611, loss_d: 0.700191
0.3076 --- loss: 2.122162, loss_ss: 1.393400, loss_d: 0.728762
0.3460 --- loss: 1.794569, loss_ss: 1.321076, loss_d: 0.473493
0.3845 --- loss: 1.957706, loss_ss: 1.342512, loss_d: 0.615194
0.4229 --- loss: 1.959803, loss_ss: 1.434357, loss_d: 0.525446
0.4614 --- loss: 1.682121, loss_ss: 1.259146, loss_d: 0.422975
0.4998 --- loss: 2.145769, loss_ss: 1.207097, loss_d: 0.938672
0.5383 --- loss: 1.915955, loss_ss: 1.289563, loss_d: 0.626392
0.5767 --- loss: 1.989216, loss_ss: 1.434865, loss_d: 0.554351
0.6151 --- loss: 1.810822, loss_ss: 1.309924, loss_d: 0.500899
0.6536 --- loss: 1.800534, loss_ss: 1.300231, loss_d: 0.500303
0.6920 --- loss: 1.914109, loss_ss: 1.224703, loss_d: 0.689406
0.7305 --- loss: 1.875244, loss_ss: 1.217084, loss_d: 0.658160
0.7689 --- loss: 2.045474, loss_ss: 1.538369, loss_d: 0.507105
0.8074 --- loss: 1.976060, loss_ss: 1.353277, loss_d: 0.622783
0.8458 --- loss: 1.978371, loss_ss: 1.240470, loss_d: 0.737902
0.8843 --- loss: 1.772029, loss_ss: 1.115364, loss_d: 0.656665
0.9227 --- loss: 1.861257, loss_ss: 1.202302, loss_d: 0.658955
0.9612 --- loss: 1.701315, loss_ss: 1.248727, loss_d: 0.452588
0.9996 --- loss: 2.273823, loss_ss: 1.882702, loss_d: 0.391120
Epoch finished! Loss: 1.9777094662189483
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.679385, loss_ss: 1.094816, loss_d: 0.584569
0.0384 --- loss: 1.431036, loss_ss: 1.042128, loss_d: 0.388908
0.0769 --- loss: 1.745643, loss_ss: 1.269959, loss_d: 0.475685
0.1153 --- loss: 1.843358, loss_ss: 1.252805, loss_d: 0.590553
0.1538 --- loss: 2.027818, loss_ss: 1.291365, loss_d: 0.736453
0.1922 --- loss: 1.439653, loss_ss: 1.121726, loss_d: 0.317927
0.2307 --- loss: 1.804869, loss_ss: 1.009600, loss_d: 0.795269
0.2691 --- loss: 1.708947, loss_ss: 1.168088, loss_d: 0.540859
0.3076 --- loss: 1.659736, loss_ss: 0.980610, loss_d: 0.679125
0.3460 --- loss: 1.847619, loss_ss: 1.070101, loss_d: 0.777518
0.3845 --- loss: 1.732919, loss_ss: 1.221267, loss_d: 0.511652
0.4229 --- loss: 1.505947, loss_ss: 1.014733, loss_d: 0.491214
0.4614 --- loss: 1.571227, loss_ss: 1.069396, loss_d: 0.501831
0.4998 --- loss: 1.745286, loss_ss: 1.054033, loss_d: 0.691252
0.5383 --- loss: 1.769229, loss_ss: 1.120346, loss_d: 0.648883
0.5767 --- loss: 1.808376, loss_ss: 1.043270, loss_d: 0.765106
0.6151 --- loss: 1.766826, loss_ss: 1.037058, loss_d: 0.729769
0.6536 --- loss: 2.026709, loss_ss: 1.214612, loss_d: 0.812096
0.6920 --- loss: 1.265455, loss_ss: 0.872064, loss_d: 0.393391
0.7305 --- loss: 1.645161, loss_ss: 0.841466, loss_d: 0.803695
0.7689 --- loss: 1.250230, loss_ss: 0.970549, loss_d: 0.279681
0.8074 --- loss: 1.748061, loss_ss: 0.953453, loss_d: 0.794609
0.8458 --- loss: 1.563703, loss_ss: 1.117903, loss_d: 0.445800
0.8843 --- loss: 1.463787, loss_ss: 1.147590, loss_d: 0.316198
0.9227 --- loss: 1.793688, loss_ss: 1.154704, loss_d: 0.638984
0.9612 --- loss: 1.560989, loss_ss: 0.987746, loss_d: 0.573243
0.9996 --- loss: 1.507876, loss_ss: 1.219829, loss_d: 0.288047
Epoch finished! Loss: 1.6909909596809973
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.317637, loss_ss: 0.827227, loss_d: 0.490410
0.0384 --- loss: 1.584091, loss_ss: 0.870255, loss_d: 0.713836
0.0769 --- loss: 1.787083, loss_ss: 1.103276, loss_d: 0.683807
0.1153 --- loss: 1.575985, loss_ss: 0.944180, loss_d: 0.631805
0.1538 --- loss: 1.200367, loss_ss: 0.752236, loss_d: 0.448131
0.1922 --- loss: 1.710083, loss_ss: 0.921218, loss_d: 0.788865
0.2307 --- loss: 1.654691, loss_ss: 1.089526, loss_d: 0.565165
0.2691 --- loss: 1.355339, loss_ss: 0.787889, loss_d: 0.567450
0.3076 --- loss: 1.806087, loss_ss: 0.976039, loss_d: 0.830048
0.3460 --- loss: 2.208698, loss_ss: 1.375528, loss_d: 0.833170
0.3845 --- loss: 1.232961, loss_ss: 0.840690, loss_d: 0.392271
0.4229 --- loss: 1.462531, loss_ss: 0.997408, loss_d: 0.465123
0.4614 --- loss: 1.913713, loss_ss: 1.014056, loss_d: 0.899657
0.4998 --- loss: 1.384365, loss_ss: 1.012827, loss_d: 0.371538
0.5383 --- loss: 1.442370, loss_ss: 0.975126, loss_d: 0.467244
0.5767 --- loss: 1.376940, loss_ss: 0.813283, loss_d: 0.563656
0.6151 --- loss: 1.749167, loss_ss: 1.056601, loss_d: 0.692566
0.6536 --- loss: 1.424824, loss_ss: 0.754230, loss_d: 0.670594
0.6920 --- loss: 1.338690, loss_ss: 0.844207, loss_d: 0.494483
0.7305 --- loss: 2.026219, loss_ss: 1.171583, loss_d: 0.854636
0.7689 --- loss: 1.562706, loss_ss: 1.078323, loss_d: 0.484383
0.8074 --- loss: 1.466143, loss_ss: 1.001500, loss_d: 0.464643
0.8458 --- loss: 1.112382, loss_ss: 0.833420, loss_d: 0.278962
0.8843 --- loss: 1.607831, loss_ss: 0.796885, loss_d: 0.810946
0.9227 --- loss: 1.557420, loss_ss: 1.220991, loss_d: 0.336429
0.9612 --- loss: 1.241043, loss_ss: 0.747400, loss_d: 0.493643
0.9996 --- loss: 1.903134, loss_ss: 1.728967, loss_d: 0.174167
Epoch finished! Loss: 1.5430811632138033
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.638202, loss_ss: 1.022067, loss_d: 0.616135
0.0384 --- loss: 1.590592, loss_ss: 1.154416, loss_d: 0.436176
0.0769 --- loss: 1.582943, loss_ss: 1.007369, loss_d: 0.575574
0.1153 --- loss: 1.732719, loss_ss: 1.304183, loss_d: 0.428536
0.1538 --- loss: 1.318512, loss_ss: 0.728052, loss_d: 0.590459
0.1922 --- loss: 1.474763, loss_ss: 0.978435, loss_d: 0.496328
0.2307 --- loss: 1.539767, loss_ss: 0.812267, loss_d: 0.727500
0.2691 --- loss: 1.612917, loss_ss: 1.221759, loss_d: 0.391158
0.3076 --- loss: 1.436428, loss_ss: 0.826832, loss_d: 0.609595
0.3460 --- loss: 1.241142, loss_ss: 0.754608, loss_d: 0.486533
0.3845 --- loss: 1.450119, loss_ss: 1.065463, loss_d: 0.384657
0.4229 --- loss: 1.682242, loss_ss: 1.062925, loss_d: 0.619317
0.4614 --- loss: 1.176621, loss_ss: 0.694248, loss_d: 0.482373
0.4998 --- loss: 1.382136, loss_ss: 0.997640, loss_d: 0.384496
0.5383 --- loss: 1.447881, loss_ss: 1.076595, loss_d: 0.371286
0.5767 --- loss: 1.013996, loss_ss: 0.753131, loss_d: 0.260865
0.6151 --- loss: 1.589286, loss_ss: 1.213818, loss_d: 0.375467
0.6536 --- loss: 1.380639, loss_ss: 1.107743, loss_d: 0.272897
0.6920 --- loss: 1.511425, loss_ss: 0.873542, loss_d: 0.637882
0.7305 --- loss: 1.358234, loss_ss: 0.882538, loss_d: 0.475696
0.7689 --- loss: 1.342244, loss_ss: 1.081856, loss_d: 0.260389
0.8074 --- loss: 1.488911, loss_ss: 1.085517, loss_d: 0.403394
0.8458 --- loss: 1.371441, loss_ss: 0.985199, loss_d: 0.386242
0.8843 --- loss: 1.094235, loss_ss: 0.851886, loss_d: 0.242349
0.9227 --- loss: 1.220365, loss_ss: 1.047834, loss_d: 0.172531
0.9612 --- loss: 1.722209, loss_ss: 1.136982, loss_d: 0.585226
0.9996 --- loss: 2.253415, loss_ss: 2.068466, loss_d: 0.184950
Epoch finished! Loss: 1.4498229052011784
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.488877, loss_ss: 1.015060, loss_d: 0.473817
0.0384 --- loss: 1.386417, loss_ss: 1.024920, loss_d: 0.361496
0.0769 --- loss: 1.506223, loss_ss: 0.916335, loss_d: 0.589888
0.1153 --- loss: 1.162553, loss_ss: 0.821226, loss_d: 0.341326
0.1538 --- loss: 1.800537, loss_ss: 0.917929, loss_d: 0.882608
0.1922 --- loss: 1.885254, loss_ss: 1.105322, loss_d: 0.779931
0.2307 --- loss: 1.294743, loss_ss: 0.751609, loss_d: 0.543135
0.2691 --- loss: 1.162634, loss_ss: 0.892833, loss_d: 0.269801
0.3076 --- loss: 1.493612, loss_ss: 0.773339, loss_d: 0.720273
0.3460 --- loss: 1.067584, loss_ss: 0.854717, loss_d: 0.212867
0.3845 --- loss: 1.137705, loss_ss: 0.847222, loss_d: 0.290483
0.4229 --- loss: 1.203822, loss_ss: 0.850909, loss_d: 0.352913
0.4614 --- loss: 1.119058, loss_ss: 0.912745, loss_d: 0.206314
0.4998 --- loss: 1.100904, loss_ss: 0.696729, loss_d: 0.404175
0.5383 --- loss: 1.248745, loss_ss: 1.079749, loss_d: 0.168996
0.5767 --- loss: 1.248750, loss_ss: 0.901475, loss_d: 0.347275
0.6151 --- loss: 1.612175, loss_ss: 0.955010, loss_d: 0.657165
0.6536 --- loss: 1.560312, loss_ss: 0.903930, loss_d: 0.656382
0.6920 --- loss: 1.132702, loss_ss: 0.884304, loss_d: 0.248398
0.7305 --- loss: 1.459640, loss_ss: 0.870835, loss_d: 0.588805
0.7689 --- loss: 1.348184, loss_ss: 1.086445, loss_d: 0.261739
0.8074 --- loss: 1.146656, loss_ss: 0.766100, loss_d: 0.380555
0.8458 --- loss: 1.244540, loss_ss: 0.843744, loss_d: 0.400796
0.8843 --- loss: 1.244033, loss_ss: 0.936303, loss_d: 0.307730
0.9227 --- loss: 1.119839, loss_ss: 0.803746, loss_d: 0.316092
0.9612 --- loss: 1.157467, loss_ss: 1.007549, loss_d: 0.149918
0.9996 --- loss: 4.557580, loss_ss: 2.646640, loss_d: 1.910940
Epoch finished! Loss: 1.3528485376101274
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.181614, loss_ss: 0.760075, loss_d: 0.421540
0.0384 --- loss: 1.845076, loss_ss: 1.274828, loss_d: 0.570248
0.0769 --- loss: 1.184726, loss_ss: 0.813131, loss_d: 0.371595
0.1153 --- loss: 1.438324, loss_ss: 1.104187, loss_d: 0.334136
0.1538 --- loss: 1.373141, loss_ss: 1.025512, loss_d: 0.347629
0.1922 --- loss: 1.229747, loss_ss: 0.701548, loss_d: 0.528199
0.2307 --- loss: 1.183861, loss_ss: 0.752075, loss_d: 0.431786
0.2691 --- loss: 1.373421, loss_ss: 1.024349, loss_d: 0.349072
0.3076 --- loss: 1.331581, loss_ss: 0.871235, loss_d: 0.460346
0.3460 --- loss: 1.285228, loss_ss: 0.875235, loss_d: 0.409993
0.3845 --- loss: 1.634265, loss_ss: 0.966302, loss_d: 0.667963
0.4229 --- loss: 1.790725, loss_ss: 1.376290, loss_d: 0.414436
0.4614 --- loss: 1.213310, loss_ss: 0.921324, loss_d: 0.291986
0.4998 --- loss: 1.224650, loss_ss: 0.845447, loss_d: 0.379203
0.5383 --- loss: 1.214084, loss_ss: 0.957541, loss_d: 0.256543
0.5767 --- loss: 1.360042, loss_ss: 0.904350, loss_d: 0.455692
0.6151 --- loss: 1.294726, loss_ss: 0.821777, loss_d: 0.472949
0.6536 --- loss: 1.378674, loss_ss: 0.781704, loss_d: 0.596969
0.6920 --- loss: 1.101392, loss_ss: 0.691054, loss_d: 0.410338
0.7305 --- loss: 1.071220, loss_ss: 0.810893, loss_d: 0.260327
0.7689 --- loss: 1.140830, loss_ss: 0.773068, loss_d: 0.367762
0.8074 --- loss: 1.242657, loss_ss: 0.997305, loss_d: 0.245353
0.8458 --- loss: 1.015589, loss_ss: 0.841997, loss_d: 0.173592
0.8843 --- loss: 1.201661, loss_ss: 0.813891, loss_d: 0.387770
0.9227 --- loss: 1.131442, loss_ss: 0.911239, loss_d: 0.220203
0.9612 --- loss: 0.977113, loss_ss: 0.708304, loss_d: 0.268809
0.9996 --- loss: 2.236084, loss_ss: 1.992845, loss_d: 0.243238
Epoch finished! Loss: 1.321495139140349
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.706112, loss_ss: 1.045814, loss_d: 0.660299
0.0384 --- loss: 1.646654, loss_ss: 0.845116, loss_d: 0.801538
0.0769 --- loss: 0.909705, loss_ss: 0.650482, loss_d: 0.259223
0.1153 --- loss: 1.288850, loss_ss: 1.096699, loss_d: 0.192152
0.1538 --- loss: 1.182978, loss_ss: 0.961149, loss_d: 0.221829
0.1922 --- loss: 1.247414, loss_ss: 1.007768, loss_d: 0.239647
0.2307 --- loss: 1.695256, loss_ss: 0.750834, loss_d: 0.944422
0.2691 --- loss: 0.942591, loss_ss: 0.671404, loss_d: 0.271187
0.3076 --- loss: 1.049518, loss_ss: 0.778030, loss_d: 0.271488
0.3460 --- loss: 1.430282, loss_ss: 0.823440, loss_d: 0.606842
0.3845 --- loss: 1.562377, loss_ss: 1.432884, loss_d: 0.129493
0.4229 --- loss: 1.384467, loss_ss: 1.014327, loss_d: 0.370140
0.4614 --- loss: 1.537609, loss_ss: 0.868180, loss_d: 0.669429
0.4998 --- loss: 1.341150, loss_ss: 0.866198, loss_d: 0.474953
0.5383 --- loss: 1.230883, loss_ss: 0.916410, loss_d: 0.314473
0.5767 --- loss: 1.526554, loss_ss: 0.741943, loss_d: 0.784610
0.6151 --- loss: 1.016207, loss_ss: 0.802571, loss_d: 0.213636
0.6536 --- loss: 1.147350, loss_ss: 0.712312, loss_d: 0.435038
0.6920 --- loss: 1.824249, loss_ss: 0.880179, loss_d: 0.944070
0.7305 --- loss: 1.323937, loss_ss: 0.882296, loss_d: 0.441641
0.7689 --- loss: 1.408545, loss_ss: 0.816156, loss_d: 0.592389
0.8074 --- loss: 1.329993, loss_ss: 0.614477, loss_d: 0.715516
0.8458 --- loss: 1.493106, loss_ss: 0.785409, loss_d: 0.707696
0.8843 --- loss: 1.399685, loss_ss: 0.849010, loss_d: 0.550675
0.9227 --- loss: 1.412070, loss_ss: 1.083125, loss_d: 0.328945
0.9612 --- loss: 1.406622, loss_ss: 1.011383, loss_d: 0.395239
0.9996 --- loss: 1.527418, loss_ss: 1.365515, loss_d: 0.161903
Epoch finished! Loss: 1.249350798359284
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.321175, loss_ss: 1.005710, loss_d: 0.315465
0.0384 --- loss: 0.884766, loss_ss: 0.690995, loss_d: 0.193771
0.0769 --- loss: 0.826151, loss_ss: 0.540061, loss_d: 0.286091
0.1153 --- loss: 1.380569, loss_ss: 0.743944, loss_d: 0.636625
0.1538 --- loss: 1.461145, loss_ss: 1.049623, loss_d: 0.411522
0.1922 --- loss: 1.089770, loss_ss: 0.756156, loss_d: 0.333614
0.2307 --- loss: 1.256866, loss_ss: 0.902362, loss_d: 0.354504
0.2691 --- loss: 1.037441, loss_ss: 0.740953, loss_d: 0.296488
0.3076 --- loss: 0.886755, loss_ss: 0.814247, loss_d: 0.072509
0.3460 --- loss: 1.209872, loss_ss: 0.918275, loss_d: 0.291597
0.3845 --- loss: 1.160246, loss_ss: 0.684416, loss_d: 0.475829
0.4229 --- loss: 1.280065, loss_ss: 0.862314, loss_d: 0.417752
0.4614 --- loss: 1.382100, loss_ss: 1.015585, loss_d: 0.366515
0.4998 --- loss: 1.563708, loss_ss: 1.035225, loss_d: 0.528482
0.5383 --- loss: 1.030630, loss_ss: 0.768105, loss_d: 0.262525
0.5767 --- loss: 1.589517, loss_ss: 1.184752, loss_d: 0.404765
0.6151 --- loss: 0.950681, loss_ss: 0.797674, loss_d: 0.153007
0.6536 --- loss: 1.261763, loss_ss: 1.043090, loss_d: 0.218673
0.6920 --- loss: 1.570074, loss_ss: 0.760272, loss_d: 0.809802
0.7305 --- loss: 1.342794, loss_ss: 0.870593, loss_d: 0.472201
0.7689 --- loss: 1.091134, loss_ss: 0.974837, loss_d: 0.116297
0.8074 --- loss: 1.005395, loss_ss: 0.770687, loss_d: 0.234707
0.8458 --- loss: 1.416865, loss_ss: 0.927488, loss_d: 0.489377
0.8843 --- loss: 1.174072, loss_ss: 0.756967, loss_d: 0.417105
0.9227 --- loss: 0.899477, loss_ss: 0.744444, loss_d: 0.155033
0.9612 --- loss: 1.234807, loss_ss: 0.830610, loss_d: 0.404197
0.9996 --- loss: 0.919191, loss_ss: 0.867335, loss_d: 0.051855
Epoch finished! Loss: 1.1916688268001263
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.248395, loss_ss: 1.083053, loss_d: 0.165342
0.0384 --- loss: 1.001216, loss_ss: 0.724721, loss_d: 0.276495
0.0769 --- loss: 2.353889, loss_ss: 0.899477, loss_d: 1.454411
0.1153 --- loss: 0.912757, loss_ss: 0.636374, loss_d: 0.276383
0.1538 --- loss: 1.196129, loss_ss: 0.739601, loss_d: 0.456527
0.1922 --- loss: 1.236476, loss_ss: 0.899550, loss_d: 0.336926
0.2307 --- loss: 1.678753, loss_ss: 0.719507, loss_d: 0.959246
0.2691 --- loss: 1.034733, loss_ss: 0.776376, loss_d: 0.258357
0.3076 --- loss: 0.809351, loss_ss: 0.647968, loss_d: 0.161383
0.3460 --- loss: 1.050857, loss_ss: 0.756879, loss_d: 0.293978
0.3845 --- loss: 1.135356, loss_ss: 0.834268, loss_d: 0.301088
0.4229 --- loss: 1.316204, loss_ss: 1.093635, loss_d: 0.222569
0.4614 --- loss: 1.093773, loss_ss: 0.773773, loss_d: 0.319999
0.4998 --- loss: 1.021050, loss_ss: 0.697231, loss_d: 0.323820
0.5383 --- loss: 1.015011, loss_ss: 0.826042, loss_d: 0.188969
0.5767 --- loss: 1.422821, loss_ss: 0.794796, loss_d: 0.628025
0.6151 --- loss: 0.950597, loss_ss: 0.629323, loss_d: 0.321274
0.6536 --- loss: 1.152457, loss_ss: 0.653351, loss_d: 0.499106
0.6920 --- loss: 1.174067, loss_ss: 0.839153, loss_d: 0.334914
0.7305 --- loss: 1.181200, loss_ss: 0.732841, loss_d: 0.448359
0.7689 --- loss: 1.347726, loss_ss: 0.990373, loss_d: 0.357353
0.8074 --- loss: 0.761818, loss_ss: 0.631615, loss_d: 0.130203
0.8458 --- loss: 1.139905, loss_ss: 0.901891, loss_d: 0.238014
0.8843 --- loss: 0.857482, loss_ss: 0.716582, loss_d: 0.140900
0.9227 --- loss: 1.580475, loss_ss: 0.937506, loss_d: 0.642968
0.9612 --- loss: 1.231282, loss_ss: 0.976411, loss_d: 0.254871
0.9996 --- loss: 1.174696, loss_ss: 1.063448, loss_d: 0.111248
Epoch finished! Loss: 1.2013467499843011
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.053210, loss_ss: 0.898441, loss_d: 0.154770
0.0384 --- loss: 0.856240, loss_ss: 0.717365, loss_d: 0.138875
0.0769 --- loss: 0.832143, loss_ss: 0.710778, loss_d: 0.121365
0.1153 --- loss: 1.117361, loss_ss: 0.915567, loss_d: 0.201794
0.1538 --- loss: 1.048931, loss_ss: 0.818016, loss_d: 0.230915
0.1922 --- loss: 1.917238, loss_ss: 1.522524, loss_d: 0.394714
0.2307 --- loss: 0.801987, loss_ss: 0.604639, loss_d: 0.197349
0.2691 --- loss: 1.451113, loss_ss: 0.946248, loss_d: 0.504865
0.3076 --- loss: 1.050681, loss_ss: 0.644313, loss_d: 0.406368
0.3460 --- loss: 1.021277, loss_ss: 0.749810, loss_d: 0.271467
0.3845 --- loss: 0.823746, loss_ss: 0.640206, loss_d: 0.183540
0.4229 --- loss: 0.811025, loss_ss: 0.616720, loss_d: 0.194304
0.4614 --- loss: 1.392335, loss_ss: 0.701273, loss_d: 0.691062
0.4998 --- loss: 1.201322, loss_ss: 0.659035, loss_d: 0.542287
0.5383 --- loss: 1.259488, loss_ss: 0.751882, loss_d: 0.507606
0.5767 --- loss: 1.016852, loss_ss: 0.790796, loss_d: 0.226056
0.6151 --- loss: 1.096779, loss_ss: 0.746742, loss_d: 0.350037
0.6536 --- loss: 1.098948, loss_ss: 0.753262, loss_d: 0.345686
0.6920 --- loss: 1.748127, loss_ss: 0.943884, loss_d: 0.804243
0.7305 --- loss: 1.251710, loss_ss: 0.991868, loss_d: 0.259843
0.7689 --- loss: 1.181550, loss_ss: 1.054353, loss_d: 0.127197
0.8074 --- loss: 1.236010, loss_ss: 0.896326, loss_d: 0.339684
0.8458 --- loss: 1.136325, loss_ss: 0.977889, loss_d: 0.158435
0.8843 --- loss: 0.952291, loss_ss: 0.774818, loss_d: 0.177473
0.9227 --- loss: 0.814381, loss_ss: 0.675028, loss_d: 0.139353
0.9612 --- loss: 2.003729, loss_ss: 1.383029, loss_d: 0.620700
0.9996 --- loss: 1.215399, loss_ss: 1.104297, loss_d: 0.111102
Epoch finished! Loss: 1.1589103258573092
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6198198198198198
             precision    recall  f1-score   support

        0.0       0.70      0.66      0.68       232
        1.0       0.37      0.22      0.28       179
        2.0       0.62      0.65      0.63       246
        3.0       0.99      0.73      0.84       339
        4.0       0.32      0.77      0.45       114

avg / total       0.68      0.62      0.63      1110
 


====== chp024-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.03  65.52   92.71  70.37     67.86
1  81.26  22.35   92.59  36.70     27.78
2  83.51  64.63   88.89  62.35     63.47
3  91.62  73.45   99.61  98.81     84.26
4  80.54  77.19   80.92  31.65     44.90
Total accuracy: 61.98%
Average sen: 60.63%
Average spec: 90.94%
Macro f1-score: 57.65%
Diagnosis acc on 15mins: 1.0
[0.67941988 0.65282917 0.85757732 0.63149118 0.96721274 0.98712677
 0.97841293 0.9336102  0.98707229 0.93349791 0.97866952 0.97177505
 0.98137498 0.98511469 0.9388535  0.97308832 0.96235919 0.91410029
 0.98528999 0.9847014  0.96402413 0.99184507 0.98377901 0.98952907
 0.9906131  0.97560263 0.74632764 0.94841719 0.97985667 0.9852041
 0.99753201 0.9886862  0.9142586  0.96080261 0.96682781 0.99200398
 0.9778837 ]
pred: 0.9361289417421496, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp025-nsrr. train_data(2624), test_data(14) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.413281, loss_ss: 1.747354, loss_d: 0.665927
0.0381 --- loss: 1.817650, loss_ss: 1.518382, loss_d: 0.299268
0.0762 --- loss: 2.250124, loss_ss: 1.429697, loss_d: 0.820427
0.1143 --- loss: 1.941094, loss_ss: 1.504452, loss_d: 0.436642
0.1524 --- loss: 1.992528, loss_ss: 1.542244, loss_d: 0.450283
0.1905 --- loss: 2.035893, loss_ss: 1.524084, loss_d: 0.511809
0.2287 --- loss: 2.112967, loss_ss: 1.447167, loss_d: 0.665800
0.2668 --- loss: 2.186019, loss_ss: 1.563500, loss_d: 0.622519
0.3049 --- loss: 1.893184, loss_ss: 1.390614, loss_d: 0.502570
0.3430 --- loss: 2.122793, loss_ss: 1.520009, loss_d: 0.602784
0.3811 --- loss: 1.946755, loss_ss: 1.254061, loss_d: 0.692693
0.4192 --- loss: 2.052622, loss_ss: 1.380170, loss_d: 0.672452
0.4573 --- loss: 1.813935, loss_ss: 1.273863, loss_d: 0.540072
0.4954 --- loss: 1.995285, loss_ss: 1.283555, loss_d: 0.711730
0.5335 --- loss: 1.871291, loss_ss: 1.293517, loss_d: 0.577774
0.5716 --- loss: 1.970627, loss_ss: 1.403781, loss_d: 0.566846
0.6098 --- loss: 1.863283, loss_ss: 1.235751, loss_d: 0.627532
0.6479 --- loss: 1.751443, loss_ss: 1.160055, loss_d: 0.591388
0.6860 --- loss: 1.865490, loss_ss: 1.307101, loss_d: 0.558389
0.7241 --- loss: 1.946868, loss_ss: 1.133754, loss_d: 0.813113
0.7622 --- loss: 1.854302, loss_ss: 1.341498, loss_d: 0.512804
0.8003 --- loss: 1.913819, loss_ss: 1.294739, loss_d: 0.619080
0.8384 --- loss: 1.809518, loss_ss: 1.346271, loss_d: 0.463247
0.8765 --- loss: 1.919291, loss_ss: 1.199998, loss_d: 0.719294
0.9146 --- loss: 2.047194, loss_ss: 1.174901, loss_d: 0.872293
0.9527 --- loss: 2.026079, loss_ss: 1.393584, loss_d: 0.632495
0.9909 --- loss: 1.743820, loss_ss: 1.123205, loss_d: 0.620615
Epoch finished! Loss: 1.9372633645552715
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.960994, loss_ss: 1.100266, loss_d: 0.860728
0.0381 --- loss: 1.836410, loss_ss: 1.137203, loss_d: 0.699207
0.0762 --- loss: 1.677222, loss_ss: 1.066730, loss_d: 0.610493
0.1143 --- loss: 1.864960, loss_ss: 1.251204, loss_d: 0.613756
0.1524 --- loss: 1.641234, loss_ss: 1.218286, loss_d: 0.422948
0.1905 --- loss: 1.437430, loss_ss: 1.057108, loss_d: 0.380321
0.2287 --- loss: 1.905010, loss_ss: 1.310742, loss_d: 0.594268
0.2668 --- loss: 2.070605, loss_ss: 1.152273, loss_d: 0.918332
0.3049 --- loss: 1.925833, loss_ss: 1.097267, loss_d: 0.828566
0.3430 --- loss: 1.564302, loss_ss: 0.887508, loss_d: 0.676794
0.3811 --- loss: 1.632278, loss_ss: 1.074112, loss_d: 0.558166
0.4192 --- loss: 1.964207, loss_ss: 1.206930, loss_d: 0.757277
0.4573 --- loss: 1.525171, loss_ss: 0.838186, loss_d: 0.686985
0.4954 --- loss: 1.754013, loss_ss: 1.245181, loss_d: 0.508832
0.5335 --- loss: 1.727798, loss_ss: 1.137605, loss_d: 0.590193
0.5716 --- loss: 1.584972, loss_ss: 1.115965, loss_d: 0.469007
0.6098 --- loss: 1.556752, loss_ss: 1.068889, loss_d: 0.487863
0.6479 --- loss: 1.946518, loss_ss: 1.327059, loss_d: 0.619460
0.6860 --- loss: 1.783780, loss_ss: 1.032021, loss_d: 0.751759
0.7241 --- loss: 1.408214, loss_ss: 0.957068, loss_d: 0.451147
0.7622 --- loss: 1.809562, loss_ss: 0.944361, loss_d: 0.865202
0.8003 --- loss: 1.547075, loss_ss: 0.825362, loss_d: 0.721713
0.8384 --- loss: 1.687652, loss_ss: 1.312756, loss_d: 0.374896
0.8765 --- loss: 1.515383, loss_ss: 0.958370, loss_d: 0.557013
0.9146 --- loss: 1.348079, loss_ss: 0.849416, loss_d: 0.498663
0.9527 --- loss: 1.573246, loss_ss: 1.200315, loss_d: 0.372931
0.9909 --- loss: 1.869366, loss_ss: 1.065355, loss_d: 0.804011
Epoch finished! Loss: 1.6639110546075662
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.594017, loss_ss: 1.142373, loss_d: 0.451644
0.0381 --- loss: 1.810189, loss_ss: 1.153792, loss_d: 0.656397
0.0762 --- loss: 1.869608, loss_ss: 1.161993, loss_d: 0.707615
0.1143 --- loss: 1.754022, loss_ss: 1.222010, loss_d: 0.532012
0.1524 --- loss: 1.422298, loss_ss: 1.022339, loss_d: 0.399960
0.1905 --- loss: 1.743375, loss_ss: 0.904809, loss_d: 0.838565
0.2287 --- loss: 1.879525, loss_ss: 1.302025, loss_d: 0.577499
0.2668 --- loss: 1.345458, loss_ss: 0.783609, loss_d: 0.561849
0.3049 --- loss: 1.746784, loss_ss: 1.229162, loss_d: 0.517622
0.3430 --- loss: 1.556399, loss_ss: 0.996179, loss_d: 0.560220
0.3811 --- loss: 1.394786, loss_ss: 0.899134, loss_d: 0.495652
0.4192 --- loss: 1.680032, loss_ss: 0.929791, loss_d: 0.750241
0.4573 --- loss: 1.504293, loss_ss: 0.938107, loss_d: 0.566186
0.4954 --- loss: 1.332991, loss_ss: 0.773940, loss_d: 0.559051
0.5335 --- loss: 1.529545, loss_ss: 0.956788, loss_d: 0.572757
0.5716 --- loss: 1.617636, loss_ss: 1.115126, loss_d: 0.502510
0.6098 --- loss: 1.657605, loss_ss: 1.003820, loss_d: 0.653785
0.6479 --- loss: 1.497785, loss_ss: 1.039190, loss_d: 0.458595
0.6860 --- loss: 1.513505, loss_ss: 0.977524, loss_d: 0.535981
0.7241 --- loss: 1.626002, loss_ss: 0.844332, loss_d: 0.781670
0.7622 --- loss: 1.607766, loss_ss: 1.107345, loss_d: 0.500421
0.8003 --- loss: 1.376269, loss_ss: 0.979731, loss_d: 0.396538
0.8384 --- loss: 1.643637, loss_ss: 1.091764, loss_d: 0.551873
0.8765 --- loss: 1.296547, loss_ss: 0.782441, loss_d: 0.514106
0.9146 --- loss: 1.861169, loss_ss: 1.128566, loss_d: 0.732603
0.9527 --- loss: 1.630950, loss_ss: 1.129711, loss_d: 0.501239
0.9909 --- loss: 1.588717, loss_ss: 1.122566, loss_d: 0.466151
Epoch finished! Loss: 1.5549739635627688
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.221694, loss_ss: 0.825265, loss_d: 0.396429
0.0381 --- loss: 1.531621, loss_ss: 0.832127, loss_d: 0.699493
0.0762 --- loss: 1.240765, loss_ss: 0.794076, loss_d: 0.446690
0.1143 --- loss: 1.744060, loss_ss: 1.007487, loss_d: 0.736573
0.1524 --- loss: 1.347382, loss_ss: 0.792247, loss_d: 0.555135
0.1905 --- loss: 1.517302, loss_ss: 0.840612, loss_d: 0.676690
0.2287 --- loss: 1.549719, loss_ss: 0.943039, loss_d: 0.606681
0.2668 --- loss: 1.301365, loss_ss: 0.778841, loss_d: 0.522524
0.3049 --- loss: 1.782795, loss_ss: 1.176318, loss_d: 0.606478
0.3430 --- loss: 1.642454, loss_ss: 1.124254, loss_d: 0.518200
0.3811 --- loss: 1.713422, loss_ss: 1.180107, loss_d: 0.533315
0.4192 --- loss: 1.580545, loss_ss: 0.924211, loss_d: 0.656334
0.4573 --- loss: 1.703334, loss_ss: 0.905111, loss_d: 0.798223
0.4954 --- loss: 1.188658, loss_ss: 0.567946, loss_d: 0.620712
0.5335 --- loss: 1.576319, loss_ss: 1.034903, loss_d: 0.541416
0.5716 --- loss: 1.741349, loss_ss: 1.268954, loss_d: 0.472395
0.6098 --- loss: 1.606476, loss_ss: 0.826578, loss_d: 0.779899
0.6479 --- loss: 1.542030, loss_ss: 0.742257, loss_d: 0.799773
0.6860 --- loss: 1.686266, loss_ss: 1.056940, loss_d: 0.629326
0.7241 --- loss: 1.430163, loss_ss: 0.743191, loss_d: 0.686972
0.7622 --- loss: 1.240254, loss_ss: 0.862076, loss_d: 0.378178
0.8003 --- loss: 1.691374, loss_ss: 1.039287, loss_d: 0.652086
0.8384 --- loss: 1.424269, loss_ss: 0.868854, loss_d: 0.555415
0.8765 --- loss: 1.564600, loss_ss: 0.895089, loss_d: 0.669512
0.9146 --- loss: 1.594653, loss_ss: 0.953453, loss_d: 0.641200
0.9527 --- loss: 1.363400, loss_ss: 0.877961, loss_d: 0.485439
0.9909 --- loss: 1.429059, loss_ss: 0.927518, loss_d: 0.501540
Epoch finished! Loss: 1.507310481926867
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.202684, loss_ss: 0.732483, loss_d: 0.470201
0.0381 --- loss: 1.311751, loss_ss: 0.678479, loss_d: 0.633272
0.0762 --- loss: 1.549494, loss_ss: 1.125134, loss_d: 0.424360
0.1143 --- loss: 1.658360, loss_ss: 0.819760, loss_d: 0.838600
0.1524 --- loss: 1.253191, loss_ss: 0.687277, loss_d: 0.565913
0.1905 --- loss: 1.145642, loss_ss: 0.810282, loss_d: 0.335360
0.2287 --- loss: 1.480665, loss_ss: 0.896904, loss_d: 0.583761
0.2668 --- loss: 1.807356, loss_ss: 0.933328, loss_d: 0.874028
0.3049 --- loss: 1.279325, loss_ss: 0.642332, loss_d: 0.636993
0.3430 --- loss: 1.443574, loss_ss: 0.894998, loss_d: 0.548576
0.3811 --- loss: 1.458679, loss_ss: 0.990191, loss_d: 0.468488
0.4192 --- loss: 1.218432, loss_ss: 0.836101, loss_d: 0.382331
0.4573 --- loss: 1.575641, loss_ss: 0.907995, loss_d: 0.667646
0.4954 --- loss: 1.339060, loss_ss: 0.763700, loss_d: 0.575360
0.5335 --- loss: 1.517372, loss_ss: 0.976664, loss_d: 0.540709
0.5716 --- loss: 1.133802, loss_ss: 0.669220, loss_d: 0.464582
0.6098 --- loss: 1.283530, loss_ss: 0.914598, loss_d: 0.368933
0.6479 --- loss: 1.761935, loss_ss: 1.142140, loss_d: 0.619795
0.6860 --- loss: 1.424734, loss_ss: 0.865636, loss_d: 0.559098
0.7241 --- loss: 1.146544, loss_ss: 0.775837, loss_d: 0.370707
0.7622 --- loss: 1.751186, loss_ss: 0.879827, loss_d: 0.871360
0.8003 --- loss: 1.082665, loss_ss: 0.751508, loss_d: 0.331157
0.8384 --- loss: 1.539100, loss_ss: 1.213463, loss_d: 0.325637
0.8765 --- loss: 1.791638, loss_ss: 0.832290, loss_d: 0.959348
0.9146 --- loss: 1.597581, loss_ss: 1.156506, loss_d: 0.441075
0.9527 --- loss: 1.403673, loss_ss: 0.894496, loss_d: 0.509177
0.9909 --- loss: 1.836378, loss_ss: 1.198317, loss_d: 0.638061
Epoch finished! Loss: 1.4498696379534162
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.440428, loss_ss: 0.825634, loss_d: 0.614794
0.0381 --- loss: 1.435327, loss_ss: 1.026682, loss_d: 0.408645
0.0762 --- loss: 1.119078, loss_ss: 0.863872, loss_d: 0.255206
0.1143 --- loss: 1.392697, loss_ss: 0.824786, loss_d: 0.567911
0.1524 --- loss: 1.196543, loss_ss: 0.747810, loss_d: 0.448734
0.1905 --- loss: 1.369745, loss_ss: 0.802999, loss_d: 0.566746
0.2287 --- loss: 1.408054, loss_ss: 1.051283, loss_d: 0.356771
0.2668 --- loss: 1.610480, loss_ss: 0.905030, loss_d: 0.705450
0.3049 --- loss: 1.131619, loss_ss: 0.774924, loss_d: 0.356695
0.3430 --- loss: 0.914490, loss_ss: 0.703163, loss_d: 0.211326
0.3811 --- loss: 1.229962, loss_ss: 0.723602, loss_d: 0.506360
0.4192 --- loss: 1.401502, loss_ss: 1.131520, loss_d: 0.269982
0.4573 --- loss: 1.094752, loss_ss: 0.851976, loss_d: 0.242776
0.4954 --- loss: 1.297850, loss_ss: 0.737746, loss_d: 0.560103
0.5335 --- loss: 1.180715, loss_ss: 0.859257, loss_d: 0.321458
0.5716 --- loss: 1.424760, loss_ss: 1.133329, loss_d: 0.291431
0.6098 --- loss: 1.573063, loss_ss: 0.919557, loss_d: 0.653505
0.6479 --- loss: 1.031984, loss_ss: 0.761586, loss_d: 0.270398
0.6860 --- loss: 1.336161, loss_ss: 0.910050, loss_d: 0.426112
0.7241 --- loss: 1.696567, loss_ss: 1.003125, loss_d: 0.693442
0.7622 --- loss: 1.026861, loss_ss: 0.647765, loss_d: 0.379096
0.8003 --- loss: 1.200223, loss_ss: 0.904507, loss_d: 0.295717
0.8384 --- loss: 1.385072, loss_ss: 0.863812, loss_d: 0.521259
0.8765 --- loss: 1.768280, loss_ss: 1.310390, loss_d: 0.457890
0.9146 --- loss: 1.326622, loss_ss: 0.734225, loss_d: 0.592397
0.9527 --- loss: 1.204763, loss_ss: 0.998383, loss_d: 0.206379
0.9909 --- loss: 0.953078, loss_ss: 0.745980, loss_d: 0.207097
Epoch finished! Loss: 1.3397044978523982
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.079809, loss_ss: 0.769590, loss_d: 0.310220
0.0381 --- loss: 1.094914, loss_ss: 0.903156, loss_d: 0.191758
0.0762 --- loss: 0.791675, loss_ss: 0.651497, loss_d: 0.140177
0.1143 --- loss: 1.329967, loss_ss: 0.916577, loss_d: 0.413390
0.1524 --- loss: 1.367725, loss_ss: 1.003513, loss_d: 0.364212
0.1905 --- loss: 1.286300, loss_ss: 0.947979, loss_d: 0.338321
0.2287 --- loss: 0.939452, loss_ss: 0.727246, loss_d: 0.212206
0.2668 --- loss: 1.703740, loss_ss: 1.128371, loss_d: 0.575369
0.3049 --- loss: 1.163720, loss_ss: 0.951093, loss_d: 0.212627
0.3430 --- loss: 1.219619, loss_ss: 0.817753, loss_d: 0.401866
0.3811 --- loss: 0.974465, loss_ss: 0.692879, loss_d: 0.281586
0.4192 --- loss: 1.288953, loss_ss: 0.863540, loss_d: 0.425413
0.4573 --- loss: 1.604993, loss_ss: 1.240723, loss_d: 0.364270
0.4954 --- loss: 1.466076, loss_ss: 0.915884, loss_d: 0.550192
0.5335 --- loss: 1.239167, loss_ss: 0.882189, loss_d: 0.356977
0.5716 --- loss: 1.390321, loss_ss: 0.671859, loss_d: 0.718462
0.6098 --- loss: 1.410417, loss_ss: 0.950120, loss_d: 0.460297
0.6479 --- loss: 1.409595, loss_ss: 0.879238, loss_d: 0.530356
0.6860 --- loss: 1.008277, loss_ss: 0.806721, loss_d: 0.201557
0.7241 --- loss: 1.058317, loss_ss: 0.904926, loss_d: 0.153391
0.7622 --- loss: 1.635609, loss_ss: 1.245269, loss_d: 0.390340
0.8003 --- loss: 0.935536, loss_ss: 0.667744, loss_d: 0.267792
0.8384 --- loss: 1.213161, loss_ss: 0.768735, loss_d: 0.444425
0.8765 --- loss: 1.395145, loss_ss: 0.872676, loss_d: 0.522470
0.9146 --- loss: 1.678825, loss_ss: 0.916251, loss_d: 0.762574
0.9527 --- loss: 1.422762, loss_ss: 0.966305, loss_d: 0.456457
0.9909 --- loss: 1.092382, loss_ss: 0.650926, loss_d: 0.441457
Epoch finished! Loss: 1.2849959983625485
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.203124, loss_ss: 0.812988, loss_d: 0.390135
0.0381 --- loss: 1.293829, loss_ss: 0.883919, loss_d: 0.409910
0.0762 --- loss: 1.274442, loss_ss: 0.898771, loss_d: 0.375672
0.1143 --- loss: 1.182099, loss_ss: 0.888172, loss_d: 0.293928
0.1524 --- loss: 0.888277, loss_ss: 0.569408, loss_d: 0.318869
0.1905 --- loss: 1.518475, loss_ss: 1.050627, loss_d: 0.467848
0.2287 --- loss: 1.513874, loss_ss: 1.231793, loss_d: 0.282081
0.2668 --- loss: 1.193252, loss_ss: 0.807985, loss_d: 0.385267
0.3049 --- loss: 1.139388, loss_ss: 0.930686, loss_d: 0.208702
0.3430 --- loss: 1.127796, loss_ss: 0.757387, loss_d: 0.370409
0.3811 --- loss: 1.627110, loss_ss: 1.205405, loss_d: 0.421704
0.4192 --- loss: 1.293103, loss_ss: 1.043765, loss_d: 0.249338
0.4573 --- loss: 1.068017, loss_ss: 0.736068, loss_d: 0.331949
0.4954 --- loss: 1.124132, loss_ss: 0.734542, loss_d: 0.389590
0.5335 --- loss: 1.362571, loss_ss: 1.002935, loss_d: 0.359636
0.5716 --- loss: 1.306384, loss_ss: 0.833535, loss_d: 0.472848
0.6098 --- loss: 1.367047, loss_ss: 0.939873, loss_d: 0.427173
0.6479 --- loss: 1.335353, loss_ss: 0.952333, loss_d: 0.383020
0.6860 --- loss: 1.464621, loss_ss: 0.848685, loss_d: 0.615936
0.7241 --- loss: 1.231131, loss_ss: 1.044559, loss_d: 0.186572
0.7622 --- loss: 1.184759, loss_ss: 0.735768, loss_d: 0.448992
0.8003 --- loss: 1.380621, loss_ss: 1.101311, loss_d: 0.279310
0.8384 --- loss: 1.086315, loss_ss: 0.871290, loss_d: 0.215025
0.8765 --- loss: 0.955768, loss_ss: 0.789329, loss_d: 0.166439
0.9146 --- loss: 0.979135, loss_ss: 0.727241, loss_d: 0.251894
0.9527 --- loss: 0.978582, loss_ss: 0.809173, loss_d: 0.169409
0.9909 --- loss: 0.924500, loss_ss: 0.701730, loss_d: 0.222770
Epoch finished! Loss: 1.2453446511093897
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.892175, loss_ss: 0.711830, loss_d: 0.180344
0.0381 --- loss: 1.122326, loss_ss: 0.815694, loss_d: 0.306632
0.0762 --- loss: 0.906813, loss_ss: 0.596553, loss_d: 0.310259
0.1143 --- loss: 1.362534, loss_ss: 0.743937, loss_d: 0.618598
0.1524 --- loss: 0.863067, loss_ss: 0.734079, loss_d: 0.128988
0.1905 --- loss: 2.079747, loss_ss: 1.250615, loss_d: 0.829132
0.2287 --- loss: 1.160675, loss_ss: 0.703856, loss_d: 0.456818
0.2668 --- loss: 0.773707, loss_ss: 0.624387, loss_d: 0.149320
0.3049 --- loss: 1.375328, loss_ss: 1.152624, loss_d: 0.222704
0.3430 --- loss: 1.137442, loss_ss: 0.934120, loss_d: 0.203322
0.3811 --- loss: 1.141791, loss_ss: 0.902792, loss_d: 0.238999
0.4192 --- loss: 1.088524, loss_ss: 0.605406, loss_d: 0.483118
0.4573 --- loss: 1.102250, loss_ss: 0.863924, loss_d: 0.238325
0.4954 --- loss: 1.023616, loss_ss: 0.710510, loss_d: 0.313106
0.5335 --- loss: 1.321260, loss_ss: 1.094625, loss_d: 0.226635
0.5716 --- loss: 1.070649, loss_ss: 0.873428, loss_d: 0.197221
0.6098 --- loss: 0.798113, loss_ss: 0.481425, loss_d: 0.316688
0.6479 --- loss: 1.207205, loss_ss: 1.023974, loss_d: 0.183231
0.6860 --- loss: 1.339917, loss_ss: 0.895319, loss_d: 0.444598
0.7241 --- loss: 1.466036, loss_ss: 1.122108, loss_d: 0.343928
0.7622 --- loss: 1.378872, loss_ss: 1.128802, loss_d: 0.250071
0.8003 --- loss: 1.122393, loss_ss: 0.872211, loss_d: 0.250182
0.8384 --- loss: 0.894715, loss_ss: 0.724484, loss_d: 0.170230
0.8765 --- loss: 1.172368, loss_ss: 0.965720, loss_d: 0.206648
0.9146 --- loss: 0.921690, loss_ss: 0.821017, loss_d: 0.100673
0.9527 --- loss: 1.436406, loss_ss: 1.067144, loss_d: 0.369263
0.9909 --- loss: 1.412371, loss_ss: 0.913227, loss_d: 0.499144
Epoch finished! Loss: 1.1951582827640854
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.828247, loss_ss: 0.711694, loss_d: 0.116552
0.0381 --- loss: 1.125583, loss_ss: 0.732046, loss_d: 0.393537
0.0762 --- loss: 1.238827, loss_ss: 0.924000, loss_d: 0.314827
0.1143 --- loss: 0.959208, loss_ss: 0.760563, loss_d: 0.198645
0.1524 --- loss: 0.826259, loss_ss: 0.675243, loss_d: 0.151016
0.1905 --- loss: 0.983970, loss_ss: 0.799089, loss_d: 0.184881
0.2287 --- loss: 1.043408, loss_ss: 0.759278, loss_d: 0.284129
0.2668 --- loss: 1.563091, loss_ss: 1.066596, loss_d: 0.496495
0.3049 --- loss: 1.268192, loss_ss: 0.947650, loss_d: 0.320542
0.3430 --- loss: 1.689384, loss_ss: 0.997697, loss_d: 0.691688
0.3811 --- loss: 1.292627, loss_ss: 1.181829, loss_d: 0.110798
0.4192 --- loss: 0.950083, loss_ss: 0.640306, loss_d: 0.309777
0.4573 --- loss: 0.833566, loss_ss: 0.676943, loss_d: 0.156622
0.4954 --- loss: 1.349324, loss_ss: 0.836299, loss_d: 0.513026
0.5335 --- loss: 1.325805, loss_ss: 1.083452, loss_d: 0.242353
0.5716 --- loss: 1.302343, loss_ss: 0.959679, loss_d: 0.342663
0.6098 --- loss: 0.901087, loss_ss: 0.681213, loss_d: 0.219874
0.6479 --- loss: 1.414313, loss_ss: 1.100541, loss_d: 0.313773
0.6860 --- loss: 1.210271, loss_ss: 1.011605, loss_d: 0.198666
0.7241 --- loss: 0.787963, loss_ss: 0.648654, loss_d: 0.139308
0.7622 --- loss: 0.981497, loss_ss: 0.598148, loss_d: 0.383349
0.8003 --- loss: 1.011931, loss_ss: 0.782490, loss_d: 0.229441
0.8384 --- loss: 0.901253, loss_ss: 0.735402, loss_d: 0.165851
0.8765 --- loss: 1.195988, loss_ss: 1.042664, loss_d: 0.153324
0.9146 --- loss: 1.699732, loss_ss: 0.769109, loss_d: 0.930623
0.9527 --- loss: 1.215155, loss_ss: 0.955070, loss_d: 0.260085
0.9909 --- loss: 0.931683, loss_ss: 0.682917, loss_d: 0.248767
Epoch finished! Loss: 1.1540451823300077
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.9285714285714286
             precision    recall  f1-score   support

        0.0       0.99      0.98      0.99       304
        1.0       0.75      0.12      0.21        25
        2.0       0.55      0.97      0.70        29
        3.0       1.00      0.97      0.98        62
        4.0       0.00      0.00      0.00         0

avg / total       0.95      0.93      0.92       420
 


====== chp025-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  98.10  98.36   97.41   99.01     98.68
1  94.52  12.00   99.75   75.00     20.69
2  94.29  96.55   94.12   54.90     70.00
3  99.52  96.77  100.00  100.00     98.36
4  99.29    NaN   99.29    0.00       NaN
Total accuracy: 92.86%
Average sen: 75.92%
Average spec: 98.11%
Macro f1-score: 71.93%
Diagnosis acc on 15mins: 1.0
[0.99989843 0.9998951  0.94441593 0.99997699 0.96608204 0.93993294
 0.95222092 0.99011993 0.98593986 0.99609971 0.98496467 0.98117208
 0.94008672 0.99993587]
pred: 0.9771957993507385, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp026-nsrr. train_data(2607), test_data(31) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.620029, loss_ss: 1.901659, loss_d: 0.718371
0.0384 --- loss: 2.288314, loss_ss: 1.656248, loss_d: 0.632066
0.0767 --- loss: 2.269136, loss_ss: 1.656719, loss_d: 0.612417
0.1151 --- loss: 2.349289, loss_ss: 1.700892, loss_d: 0.648398
0.1534 --- loss: 2.199175, loss_ss: 1.615737, loss_d: 0.583439
0.1918 --- loss: 2.031482, loss_ss: 1.521028, loss_d: 0.510454
0.2301 --- loss: 2.074172, loss_ss: 1.407512, loss_d: 0.666661
0.2685 --- loss: 2.263286, loss_ss: 1.421576, loss_d: 0.841710
0.3069 --- loss: 2.094314, loss_ss: 1.258566, loss_d: 0.835748
0.3452 --- loss: 2.022612, loss_ss: 1.429391, loss_d: 0.593221
0.3836 --- loss: 2.069757, loss_ss: 1.378929, loss_d: 0.690827
0.4219 --- loss: 1.985888, loss_ss: 1.508502, loss_d: 0.477386
0.4603 --- loss: 1.686468, loss_ss: 1.364814, loss_d: 0.321654
0.4987 --- loss: 1.820041, loss_ss: 1.298828, loss_d: 0.521213
0.5370 --- loss: 2.157445, loss_ss: 1.378433, loss_d: 0.779012
0.5754 --- loss: 1.864771, loss_ss: 1.262001, loss_d: 0.602770
0.6137 --- loss: 1.733226, loss_ss: 1.101595, loss_d: 0.631631
0.6521 --- loss: 1.771619, loss_ss: 1.243271, loss_d: 0.528348
0.6904 --- loss: 2.197440, loss_ss: 1.580631, loss_d: 0.616809
0.7288 --- loss: 1.874793, loss_ss: 1.192256, loss_d: 0.682537
0.7672 --- loss: 1.919964, loss_ss: 1.240242, loss_d: 0.679722
0.8055 --- loss: 2.306748, loss_ss: 1.468231, loss_d: 0.838517
0.8439 --- loss: 1.728215, loss_ss: 1.381209, loss_d: 0.347005
0.8822 --- loss: 1.952833, loss_ss: 1.169917, loss_d: 0.782916
0.9206 --- loss: 2.008204, loss_ss: 1.429201, loss_d: 0.579004
0.9590 --- loss: 1.917229, loss_ss: 1.177223, loss_d: 0.740005
0.9973 --- loss: 1.757715, loss_ss: 1.164137, loss_d: 0.593578
Epoch finished! Loss: 2.01429331440192
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.950817, loss_ss: 1.293138, loss_d: 0.657678
0.0384 --- loss: 1.689578, loss_ss: 1.198375, loss_d: 0.491203
0.0767 --- loss: 1.765363, loss_ss: 1.059917, loss_d: 0.705446
0.1151 --- loss: 1.664984, loss_ss: 1.200165, loss_d: 0.464819
0.1534 --- loss: 2.017535, loss_ss: 1.336244, loss_d: 0.681291
0.1918 --- loss: 1.842003, loss_ss: 1.224038, loss_d: 0.617965
0.2301 --- loss: 1.784075, loss_ss: 1.472648, loss_d: 0.311428
0.2685 --- loss: 1.809365, loss_ss: 1.243063, loss_d: 0.566302
0.3069 --- loss: 1.880686, loss_ss: 1.314180, loss_d: 0.566507
0.3452 --- loss: 1.806666, loss_ss: 1.238461, loss_d: 0.568205
0.3836 --- loss: 1.802271, loss_ss: 1.205986, loss_d: 0.596284
0.4219 --- loss: 1.827693, loss_ss: 1.190877, loss_d: 0.636816
0.4603 --- loss: 1.926020, loss_ss: 1.292104, loss_d: 0.633916
0.4987 --- loss: 1.747477, loss_ss: 1.205596, loss_d: 0.541882
0.5370 --- loss: 1.903996, loss_ss: 1.436135, loss_d: 0.467860
0.5754 --- loss: 1.838830, loss_ss: 1.290161, loss_d: 0.548669
0.6137 --- loss: 1.929264, loss_ss: 1.105834, loss_d: 0.823430
0.6521 --- loss: 1.598999, loss_ss: 1.091568, loss_d: 0.507431
0.6904 --- loss: 2.002636, loss_ss: 1.366662, loss_d: 0.635975
0.7288 --- loss: 1.768044, loss_ss: 1.107150, loss_d: 0.660895
0.7672 --- loss: 1.657105, loss_ss: 1.138382, loss_d: 0.518723
0.8055 --- loss: 1.992293, loss_ss: 1.347264, loss_d: 0.645029
0.8439 --- loss: 1.515020, loss_ss: 1.232426, loss_d: 0.282594
0.8822 --- loss: 1.771883, loss_ss: 1.140964, loss_d: 0.630919
0.9206 --- loss: 1.940231, loss_ss: 1.336088, loss_d: 0.604144
0.9590 --- loss: 1.924049, loss_ss: 1.419397, loss_d: 0.504653
0.9973 --- loss: 1.618783, loss_ss: 1.139043, loss_d: 0.479739
Epoch finished! Loss: 1.8199861934551826
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.776762, loss_ss: 1.251065, loss_d: 0.525697
0.0384 --- loss: 1.707303, loss_ss: 1.220435, loss_d: 0.486868
0.0767 --- loss: 1.728918, loss_ss: 1.073416, loss_d: 0.655502
0.1151 --- loss: 2.145175, loss_ss: 1.324413, loss_d: 0.820762
0.1534 --- loss: 1.626227, loss_ss: 1.093465, loss_d: 0.532762
0.1918 --- loss: 1.569256, loss_ss: 1.081174, loss_d: 0.488081
0.2301 --- loss: 1.543799, loss_ss: 1.052882, loss_d: 0.490917
0.2685 --- loss: 1.469827, loss_ss: 1.082202, loss_d: 0.387626
0.3069 --- loss: 1.679645, loss_ss: 1.043748, loss_d: 0.635897
0.3452 --- loss: 1.680698, loss_ss: 1.318776, loss_d: 0.361923
0.3836 --- loss: 1.829376, loss_ss: 1.282539, loss_d: 0.546837
0.4219 --- loss: 2.012907, loss_ss: 1.496947, loss_d: 0.515960
0.4603 --- loss: 1.288834, loss_ss: 0.898059, loss_d: 0.390775
0.4987 --- loss: 1.541642, loss_ss: 0.891850, loss_d: 0.649791
0.5370 --- loss: 1.566985, loss_ss: 1.056907, loss_d: 0.510079
0.5754 --- loss: 1.874987, loss_ss: 1.205863, loss_d: 0.669124
0.6137 --- loss: 2.101848, loss_ss: 1.561221, loss_d: 0.540627
0.6521 --- loss: 1.313059, loss_ss: 0.991063, loss_d: 0.321997
0.6904 --- loss: 1.327719, loss_ss: 1.030786, loss_d: 0.296933
0.7288 --- loss: 2.258988, loss_ss: 1.243658, loss_d: 1.015329
0.7672 --- loss: 1.639798, loss_ss: 1.285634, loss_d: 0.354164
0.8055 --- loss: 1.808227, loss_ss: 1.265423, loss_d: 0.542804
0.8439 --- loss: 1.590350, loss_ss: 0.989560, loss_d: 0.600790
0.8822 --- loss: 1.433310, loss_ss: 0.959389, loss_d: 0.473921
0.9206 --- loss: 1.624959, loss_ss: 1.030838, loss_d: 0.594121
0.9590 --- loss: 1.749240, loss_ss: 1.238590, loss_d: 0.510650
0.9973 --- loss: 1.337402, loss_ss: 0.868862, loss_d: 0.468541
Epoch finished! Loss: 1.7139963470972501
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.726422, loss_ss: 1.094019, loss_d: 0.632403
0.0384 --- loss: 1.410981, loss_ss: 0.964438, loss_d: 0.446542
0.0767 --- loss: 1.722027, loss_ss: 1.097230, loss_d: 0.624797
0.1151 --- loss: 1.741969, loss_ss: 1.306647, loss_d: 0.435322
0.1534 --- loss: 1.587799, loss_ss: 0.970595, loss_d: 0.617204
0.1918 --- loss: 1.421645, loss_ss: 1.007809, loss_d: 0.413836
0.2301 --- loss: 1.852018, loss_ss: 1.092685, loss_d: 0.759333
0.2685 --- loss: 1.606860, loss_ss: 0.933020, loss_d: 0.673840
0.3069 --- loss: 1.678386, loss_ss: 1.151474, loss_d: 0.526912
0.3452 --- loss: 1.954056, loss_ss: 1.217290, loss_d: 0.736766
0.3836 --- loss: 1.275679, loss_ss: 0.793884, loss_d: 0.481796
0.4219 --- loss: 1.618647, loss_ss: 1.190087, loss_d: 0.428560
0.4603 --- loss: 1.818248, loss_ss: 0.904075, loss_d: 0.914174
0.4987 --- loss: 1.409863, loss_ss: 0.892456, loss_d: 0.517407
0.5370 --- loss: 1.616903, loss_ss: 1.092554, loss_d: 0.524349
0.5754 --- loss: 1.801771, loss_ss: 1.149251, loss_d: 0.652520
0.6137 --- loss: 1.691167, loss_ss: 0.979066, loss_d: 0.712101
0.6521 --- loss: 1.696011, loss_ss: 1.023163, loss_d: 0.672848
0.6904 --- loss: 1.482606, loss_ss: 0.886509, loss_d: 0.596097
0.7288 --- loss: 1.391764, loss_ss: 1.136005, loss_d: 0.255759
0.7672 --- loss: 1.328167, loss_ss: 0.959762, loss_d: 0.368405
0.8055 --- loss: 1.542109, loss_ss: 0.939524, loss_d: 0.602585
0.8439 --- loss: 1.725317, loss_ss: 0.985685, loss_d: 0.739633
0.8822 --- loss: 1.409354, loss_ss: 1.021677, loss_d: 0.387677
0.9206 --- loss: 1.420293, loss_ss: 1.118449, loss_d: 0.301844
0.9590 --- loss: 1.516932, loss_ss: 0.954801, loss_d: 0.562130
0.9973 --- loss: 1.504707, loss_ss: 1.200110, loss_d: 0.304597
Epoch finished! Loss: 1.605212882390389
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.657285, loss_ss: 1.076683, loss_d: 0.580602
0.0384 --- loss: 1.505731, loss_ss: 0.861624, loss_d: 0.644107
0.0767 --- loss: 1.238662, loss_ss: 0.957666, loss_d: 0.280996
0.1151 --- loss: 1.619069, loss_ss: 1.322620, loss_d: 0.296449
0.1534 --- loss: 1.125939, loss_ss: 0.888123, loss_d: 0.237816
0.1918 --- loss: 1.652959, loss_ss: 0.870200, loss_d: 0.782758
0.2301 --- loss: 1.223989, loss_ss: 0.960451, loss_d: 0.263539
0.2685 --- loss: 1.625771, loss_ss: 0.889862, loss_d: 0.735909
0.3069 --- loss: 1.175415, loss_ss: 0.783298, loss_d: 0.392117
0.3452 --- loss: 1.367703, loss_ss: 1.121694, loss_d: 0.246009
0.3836 --- loss: 1.707085, loss_ss: 1.188944, loss_d: 0.518141
0.4219 --- loss: 1.254244, loss_ss: 0.946021, loss_d: 0.308223
0.4603 --- loss: 1.259411, loss_ss: 1.008750, loss_d: 0.250661
0.4987 --- loss: 1.472724, loss_ss: 0.991217, loss_d: 0.481507
0.5370 --- loss: 1.747497, loss_ss: 1.138185, loss_d: 0.609312
0.5754 --- loss: 1.437306, loss_ss: 0.766685, loss_d: 0.670621
0.6137 --- loss: 1.181959, loss_ss: 0.789860, loss_d: 0.392098
0.6521 --- loss: 1.505576, loss_ss: 0.821252, loss_d: 0.684323
0.6904 --- loss: 1.672997, loss_ss: 1.035066, loss_d: 0.637931
0.7288 --- loss: 1.682878, loss_ss: 1.073402, loss_d: 0.609475
0.7672 --- loss: 1.636901, loss_ss: 1.132098, loss_d: 0.504803
0.8055 --- loss: 1.392509, loss_ss: 0.973863, loss_d: 0.418645
0.8439 --- loss: 1.337198, loss_ss: 0.997312, loss_d: 0.339887
0.8822 --- loss: 1.401480, loss_ss: 0.873297, loss_d: 0.528182
0.9206 --- loss: 1.387018, loss_ss: 1.145283, loss_d: 0.241735
0.9590 --- loss: 1.253708, loss_ss: 0.988793, loss_d: 0.264914
0.9973 --- loss: 2.590545, loss_ss: 1.481104, loss_d: 1.109441
Epoch finished! Loss: 1.4749536603689193
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.417266, loss_ss: 1.146010, loss_d: 0.271256
0.0384 --- loss: 1.398726, loss_ss: 1.066289, loss_d: 0.332437
0.0767 --- loss: 1.110339, loss_ss: 0.898738, loss_d: 0.211601
0.1151 --- loss: 1.698375, loss_ss: 1.470442, loss_d: 0.227932
0.1534 --- loss: 1.106854, loss_ss: 0.861744, loss_d: 0.245110
0.1918 --- loss: 1.150425, loss_ss: 0.863814, loss_d: 0.286611
0.2301 --- loss: 1.216729, loss_ss: 1.037118, loss_d: 0.179611
0.2685 --- loss: 1.722557, loss_ss: 1.304495, loss_d: 0.418062
0.3069 --- loss: 1.398515, loss_ss: 0.841900, loss_d: 0.556615
0.3452 --- loss: 1.344053, loss_ss: 0.967128, loss_d: 0.376926
0.3836 --- loss: 1.286241, loss_ss: 0.878145, loss_d: 0.408096
0.4219 --- loss: 1.280184, loss_ss: 1.039569, loss_d: 0.240615
0.4603 --- loss: 1.780807, loss_ss: 0.883065, loss_d: 0.897742
0.4987 --- loss: 1.334764, loss_ss: 1.103115, loss_d: 0.231649
0.5370 --- loss: 1.135482, loss_ss: 0.880384, loss_d: 0.255098
0.5754 --- loss: 1.060074, loss_ss: 0.852384, loss_d: 0.207690
0.6137 --- loss: 1.351422, loss_ss: 0.993104, loss_d: 0.358318
0.6521 --- loss: 1.331829, loss_ss: 0.926038, loss_d: 0.405791
0.6904 --- loss: 1.395169, loss_ss: 1.058035, loss_d: 0.337134
0.7288 --- loss: 1.084581, loss_ss: 0.789808, loss_d: 0.294772
0.7672 --- loss: 1.434473, loss_ss: 0.864508, loss_d: 0.569965
0.8055 --- loss: 1.969104, loss_ss: 1.137495, loss_d: 0.831609
0.8439 --- loss: 1.248754, loss_ss: 0.868995, loss_d: 0.379759
0.8822 --- loss: 1.339357, loss_ss: 1.062673, loss_d: 0.276684
0.9206 --- loss: 1.244677, loss_ss: 1.003542, loss_d: 0.241135
0.9590 --- loss: 1.477102, loss_ss: 1.022913, loss_d: 0.454189
0.9973 --- loss: 1.113098, loss_ss: 0.899421, loss_d: 0.213677
Epoch finished! Loss: 1.36549367583715
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.042367, loss_ss: 0.741428, loss_d: 0.300939
0.0384 --- loss: 1.883770, loss_ss: 0.850316, loss_d: 1.033454
0.0767 --- loss: 1.487191, loss_ss: 1.091191, loss_d: 0.396000
0.1151 --- loss: 1.320499, loss_ss: 0.784246, loss_d: 0.536253
0.1534 --- loss: 1.406335, loss_ss: 0.846395, loss_d: 0.559940
0.1918 --- loss: 1.305366, loss_ss: 0.912238, loss_d: 0.393128
0.2301 --- loss: 0.975626, loss_ss: 0.763146, loss_d: 0.212480
0.2685 --- loss: 1.073175, loss_ss: 0.804083, loss_d: 0.269092
0.3069 --- loss: 1.039958, loss_ss: 0.854687, loss_d: 0.185272
0.3452 --- loss: 0.928719, loss_ss: 0.725047, loss_d: 0.203672
0.3836 --- loss: 1.176850, loss_ss: 0.941100, loss_d: 0.235750
0.4219 --- loss: 1.098807, loss_ss: 0.758817, loss_d: 0.339990
0.4603 --- loss: 1.055783, loss_ss: 0.838406, loss_d: 0.217377
0.4987 --- loss: 1.514411, loss_ss: 0.946794, loss_d: 0.567617
0.5370 --- loss: 1.342285, loss_ss: 1.125168, loss_d: 0.217117
0.5754 --- loss: 1.332160, loss_ss: 1.021153, loss_d: 0.311006
0.6137 --- loss: 1.368187, loss_ss: 0.909837, loss_d: 0.458350
0.6521 --- loss: 1.381814, loss_ss: 0.883641, loss_d: 0.498173
0.6904 --- loss: 1.466356, loss_ss: 1.134310, loss_d: 0.332046
0.7288 --- loss: 1.408156, loss_ss: 0.767663, loss_d: 0.640494
0.7672 --- loss: 2.028090, loss_ss: 0.920390, loss_d: 1.107701
0.8055 --- loss: 1.419315, loss_ss: 1.025376, loss_d: 0.393939
0.8439 --- loss: 1.346004, loss_ss: 0.752022, loss_d: 0.593982
0.8822 --- loss: 1.604125, loss_ss: 1.170213, loss_d: 0.433912
0.9206 --- loss: 1.212845, loss_ss: 0.782176, loss_d: 0.430669
0.9590 --- loss: 1.262590, loss_ss: 0.871714, loss_d: 0.390876
0.9973 --- loss: 2.158440, loss_ss: 0.797986, loss_d: 1.360453
Epoch finished! Loss: 1.3012990506795736
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.959283, loss_ss: 0.712540, loss_d: 0.246743
0.0384 --- loss: 1.176776, loss_ss: 0.959772, loss_d: 0.217004
0.0767 --- loss: 1.371832, loss_ss: 0.741505, loss_d: 0.630327
0.1151 --- loss: 1.054645, loss_ss: 0.864134, loss_d: 0.190512
0.1534 --- loss: 1.115371, loss_ss: 0.986343, loss_d: 0.129028
0.1918 --- loss: 1.312742, loss_ss: 0.738500, loss_d: 0.574242
0.2301 --- loss: 1.252666, loss_ss: 1.090328, loss_d: 0.162338
0.2685 --- loss: 1.536009, loss_ss: 0.796378, loss_d: 0.739630
0.3069 --- loss: 1.011668, loss_ss: 0.778554, loss_d: 0.233114
0.3452 --- loss: 1.215679, loss_ss: 0.916961, loss_d: 0.298717
0.3836 --- loss: 0.872661, loss_ss: 0.723590, loss_d: 0.149072
0.4219 --- loss: 1.159076, loss_ss: 0.868800, loss_d: 0.290276
0.4603 --- loss: 1.381762, loss_ss: 0.900853, loss_d: 0.480908
0.4987 --- loss: 1.542990, loss_ss: 1.104126, loss_d: 0.438864
0.5370 --- loss: 1.330059, loss_ss: 1.051278, loss_d: 0.278780
0.5754 --- loss: 1.235325, loss_ss: 0.954504, loss_d: 0.280822
0.6137 --- loss: 1.055446, loss_ss: 0.631263, loss_d: 0.424183
0.6521 --- loss: 1.052842, loss_ss: 0.744027, loss_d: 0.308815
0.6904 --- loss: 1.224102, loss_ss: 1.001184, loss_d: 0.222918
0.7288 --- loss: 1.222240, loss_ss: 0.654541, loss_d: 0.567699
0.7672 --- loss: 1.556503, loss_ss: 1.090620, loss_d: 0.465883
0.8055 --- loss: 1.433504, loss_ss: 0.767445, loss_d: 0.666059
0.8439 --- loss: 1.155072, loss_ss: 0.749490, loss_d: 0.405582
0.8822 --- loss: 1.854357, loss_ss: 1.419016, loss_d: 0.435341
0.9206 --- loss: 1.141145, loss_ss: 0.928665, loss_d: 0.212481
0.9590 --- loss: 1.336197, loss_ss: 1.139153, loss_d: 0.197043
0.9973 --- loss: 2.963341, loss_ss: 0.745974, loss_d: 2.217367
Epoch finished! Loss: 1.272724150465085
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.045421, loss_ss: 0.636663, loss_d: 0.408758
0.0384 --- loss: 1.232564, loss_ss: 0.768877, loss_d: 0.463687
0.0767 --- loss: 1.143620, loss_ss: 0.696105, loss_d: 0.447515
0.1151 --- loss: 1.301761, loss_ss: 1.083338, loss_d: 0.218423
0.1534 --- loss: 1.252872, loss_ss: 0.798789, loss_d: 0.454083
0.1918 --- loss: 1.493299, loss_ss: 0.974180, loss_d: 0.519120
0.2301 --- loss: 1.015262, loss_ss: 0.700993, loss_d: 0.314269
0.2685 --- loss: 1.533793, loss_ss: 1.050383, loss_d: 0.483411
0.3069 --- loss: 1.659199, loss_ss: 0.908969, loss_d: 0.750230
0.3452 --- loss: 1.763600, loss_ss: 0.806676, loss_d: 0.956924
0.3836 --- loss: 1.424697, loss_ss: 1.095504, loss_d: 0.329193
0.4219 --- loss: 0.988070, loss_ss: 0.679700, loss_d: 0.308370
0.4603 --- loss: 1.378690, loss_ss: 0.956798, loss_d: 0.421892
0.4987 --- loss: 1.334579, loss_ss: 0.773410, loss_d: 0.561169
0.5370 --- loss: 1.600104, loss_ss: 0.998346, loss_d: 0.601758
0.5754 --- loss: 1.313317, loss_ss: 0.865119, loss_d: 0.448197
0.6137 --- loss: 0.925386, loss_ss: 0.650007, loss_d: 0.275379
0.6521 --- loss: 1.383461, loss_ss: 0.905748, loss_d: 0.477712
0.6904 --- loss: 1.115250, loss_ss: 0.821168, loss_d: 0.294082
0.7288 --- loss: 1.006125, loss_ss: 0.725033, loss_d: 0.281092
0.7672 --- loss: 1.130587, loss_ss: 0.844504, loss_d: 0.286083
0.8055 --- loss: 0.856190, loss_ss: 0.664501, loss_d: 0.191689
0.8439 --- loss: 1.329732, loss_ss: 0.766868, loss_d: 0.562864
0.8822 --- loss: 1.146036, loss_ss: 1.018549, loss_d: 0.127486
0.9206 --- loss: 1.206602, loss_ss: 0.942697, loss_d: 0.263904
0.9590 --- loss: 1.014601, loss_ss: 0.608105, loss_d: 0.406496
0.9973 --- loss: 1.621537, loss_ss: 1.142525, loss_d: 0.479012
Epoch finished! Loss: 1.2356593070121913
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.881022, loss_ss: 0.687912, loss_d: 0.193110
0.0384 --- loss: 1.241634, loss_ss: 0.769727, loss_d: 0.471907
0.0767 --- loss: 0.925574, loss_ss: 0.721714, loss_d: 0.203859
0.1151 --- loss: 1.383379, loss_ss: 0.928449, loss_d: 0.454930
0.1534 --- loss: 1.269048, loss_ss: 0.999236, loss_d: 0.269812
0.1918 --- loss: 1.325675, loss_ss: 1.068992, loss_d: 0.256684
0.2301 --- loss: 1.436015, loss_ss: 1.264738, loss_d: 0.171278
0.2685 --- loss: 1.303044, loss_ss: 0.878399, loss_d: 0.424645
0.3069 --- loss: 1.669051, loss_ss: 1.115342, loss_d: 0.553709
0.3452 --- loss: 1.195024, loss_ss: 0.913565, loss_d: 0.281460
0.3836 --- loss: 1.517124, loss_ss: 0.921897, loss_d: 0.595227
0.4219 --- loss: 0.858194, loss_ss: 0.619389, loss_d: 0.238805
0.4603 --- loss: 0.938269, loss_ss: 0.739706, loss_d: 0.198564
0.4987 --- loss: 1.177532, loss_ss: 0.949511, loss_d: 0.228022
0.5370 --- loss: 1.149114, loss_ss: 0.840725, loss_d: 0.308389
0.5754 --- loss: 1.100077, loss_ss: 0.678807, loss_d: 0.421270
0.6137 --- loss: 1.192310, loss_ss: 0.900983, loss_d: 0.291327
0.6521 --- loss: 0.738341, loss_ss: 0.540126, loss_d: 0.198214
0.6904 --- loss: 1.096195, loss_ss: 0.911413, loss_d: 0.184782
0.7288 --- loss: 1.194501, loss_ss: 0.823803, loss_d: 0.370697
0.7672 --- loss: 1.492372, loss_ss: 1.224623, loss_d: 0.267749
0.8055 --- loss: 0.964346, loss_ss: 0.669095, loss_d: 0.295251
0.8439 --- loss: 0.989270, loss_ss: 0.638432, loss_d: 0.350838
0.8822 --- loss: 1.281298, loss_ss: 1.017353, loss_d: 0.263945
0.9206 --- loss: 1.208012, loss_ss: 0.992464, loss_d: 0.215547
0.9590 --- loss: 1.155821, loss_ss: 0.876224, loss_d: 0.279597
0.9973 --- loss: 1.038995, loss_ss: 0.685679, loss_d: 0.353316
Epoch finished! Loss: 1.1828237453332313
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7752688172043011
             precision    recall  f1-score   support

        0.0       0.58      0.88      0.70        58
        1.0       0.37      0.24      0.29        55
        2.0       0.93      0.67      0.78       412
        3.0       0.79      0.94      0.86       182
        4.0       0.71      0.93      0.81       223

avg / total       0.80      0.78      0.77       930
 


====== chp026-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  95.27  87.93   95.76  57.95     69.86
1  93.12  23.64   97.49  37.14     28.89
2  83.33  67.48   95.95  92.98     78.20
3  93.98  93.96   93.98  79.17     85.93
4  89.35  93.27   88.12  71.23     80.78
Total accuracy: 77.53%
Average sen: 73.25%
Average spec: 94.26%
Macro f1-score: 68.73%
Diagnosis acc on 15mins: 0.7096774193548387
[0.93575722 0.61243373 0.4777739  0.69764376 0.44269529 0.75490075
 0.98107463 0.94932902 0.79316634 0.97159666 0.87257373 0.99865401
 0.47069448 0.79182953 0.87061602 0.9357127  0.48738453 0.66936886
 0.3870061  0.94255888 0.93198329 0.95592511 0.98840404 0.84470344
 0.42165068 0.99321944 0.48251188 0.45187229 0.98982877 0.76197588
 0.42809531]
pred: 0.7513851696445096, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp028-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.378563, loss_ss: 1.675485, loss_d: 0.703078
0.0384 --- loss: 2.652105, loss_ss: 1.602072, loss_d: 1.050033
0.0768 --- loss: 2.109239, loss_ss: 1.610441, loss_d: 0.498798
0.1152 --- loss: 2.179212, loss_ss: 1.713609, loss_d: 0.465604
0.1536 --- loss: 2.209025, loss_ss: 1.465733, loss_d: 0.743292
0.1920 --- loss: 2.120390, loss_ss: 1.560607, loss_d: 0.559784
0.2304 --- loss: 2.124741, loss_ss: 1.598290, loss_d: 0.526451
0.2688 --- loss: 1.722564, loss_ss: 1.275366, loss_d: 0.447198
0.3072 --- loss: 1.946940, loss_ss: 1.369310, loss_d: 0.577631
0.3456 --- loss: 1.711144, loss_ss: 1.324821, loss_d: 0.386323
0.3840 --- loss: 1.765632, loss_ss: 1.328470, loss_d: 0.437162
0.4224 --- loss: 1.977714, loss_ss: 1.272986, loss_d: 0.704727
0.4608 --- loss: 2.273649, loss_ss: 1.620992, loss_d: 0.652656
0.4992 --- loss: 1.802612, loss_ss: 1.273105, loss_d: 0.529507
0.5376 --- loss: 1.834764, loss_ss: 1.474182, loss_d: 0.360582
0.5760 --- loss: 2.109964, loss_ss: 1.427461, loss_d: 0.682502
0.6144 --- loss: 1.991759, loss_ss: 1.363037, loss_d: 0.628722
0.6528 --- loss: 2.226421, loss_ss: 1.522142, loss_d: 0.704279
0.6912 --- loss: 2.112400, loss_ss: 1.208527, loss_d: 0.903873
0.7296 --- loss: 2.014279, loss_ss: 1.496347, loss_d: 0.517932
0.7680 --- loss: 1.872049, loss_ss: 1.110415, loss_d: 0.761633
0.8065 --- loss: 2.165283, loss_ss: 1.559608, loss_d: 0.605675
0.8449 --- loss: 1.764673, loss_ss: 1.150158, loss_d: 0.614515
0.8833 --- loss: 1.774037, loss_ss: 1.210154, loss_d: 0.563883
0.9217 --- loss: 1.710588, loss_ss: 1.096754, loss_d: 0.613835
0.9601 --- loss: 1.942464, loss_ss: 1.228132, loss_d: 0.714332
0.9985 --- loss: 1.970088, loss_ss: 1.151600, loss_d: 0.818488
Epoch finished! Loss: 1.9869408336969523
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.903199, loss_ss: 1.252838, loss_d: 0.650362
0.0384 --- loss: 1.926977, loss_ss: 1.286113, loss_d: 0.640864
0.0768 --- loss: 1.666541, loss_ss: 1.191447, loss_d: 0.475094
0.1152 --- loss: 1.443731, loss_ss: 1.114454, loss_d: 0.329277
0.1536 --- loss: 1.400278, loss_ss: 0.921989, loss_d: 0.478289
0.1920 --- loss: 1.685579, loss_ss: 1.133101, loss_d: 0.552477
0.2304 --- loss: 1.833725, loss_ss: 1.186754, loss_d: 0.646970
0.2688 --- loss: 1.733770, loss_ss: 1.243701, loss_d: 0.490069
0.3072 --- loss: 1.667535, loss_ss: 1.154985, loss_d: 0.512550
0.3456 --- loss: 1.581080, loss_ss: 0.924603, loss_d: 0.656476
0.3840 --- loss: 2.024508, loss_ss: 1.252851, loss_d: 0.771657
0.4224 --- loss: 1.917107, loss_ss: 1.402742, loss_d: 0.514365
0.4608 --- loss: 1.517929, loss_ss: 1.123172, loss_d: 0.394757
0.4992 --- loss: 1.902071, loss_ss: 1.066465, loss_d: 0.835605
0.5376 --- loss: 1.845873, loss_ss: 1.151146, loss_d: 0.694726
0.5760 --- loss: 1.670769, loss_ss: 1.252447, loss_d: 0.418322
0.6144 --- loss: 1.484366, loss_ss: 0.928378, loss_d: 0.555988
0.6528 --- loss: 1.791123, loss_ss: 1.196239, loss_d: 0.594884
0.6912 --- loss: 1.725250, loss_ss: 1.068108, loss_d: 0.657141
0.7296 --- loss: 1.524629, loss_ss: 0.987689, loss_d: 0.536940
0.7680 --- loss: 1.673501, loss_ss: 0.973234, loss_d: 0.700266
0.8065 --- loss: 1.418214, loss_ss: 0.916915, loss_d: 0.501299
0.8449 --- loss: 1.610874, loss_ss: 1.129849, loss_d: 0.481025
0.8833 --- loss: 1.374373, loss_ss: 0.774400, loss_d: 0.599973
0.9217 --- loss: 1.769880, loss_ss: 1.149493, loss_d: 0.620386
0.9601 --- loss: 1.811698, loss_ss: 1.137769, loss_d: 0.673928
0.9985 --- loss: 1.874181, loss_ss: 1.293108, loss_d: 0.581073
Epoch finished! Loss: 1.7017274709848258
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.357776, loss_ss: 0.854881, loss_d: 0.502895
0.0384 --- loss: 1.427369, loss_ss: 0.902473, loss_d: 0.524896
0.0768 --- loss: 1.673887, loss_ss: 0.998648, loss_d: 0.675239
0.1152 --- loss: 1.338615, loss_ss: 1.027097, loss_d: 0.311517
0.1536 --- loss: 1.899688, loss_ss: 1.336662, loss_d: 0.563026
0.1920 --- loss: 1.801048, loss_ss: 1.310128, loss_d: 0.490919
0.2304 --- loss: 1.457883, loss_ss: 0.844852, loss_d: 0.613032
0.2688 --- loss: 1.539363, loss_ss: 1.041402, loss_d: 0.497961
0.3072 --- loss: 1.265831, loss_ss: 0.826183, loss_d: 0.439647
0.3456 --- loss: 1.347583, loss_ss: 1.011920, loss_d: 0.335663
0.3840 --- loss: 1.523640, loss_ss: 1.120512, loss_d: 0.403128
0.4224 --- loss: 1.353491, loss_ss: 0.929253, loss_d: 0.424238
0.4608 --- loss: 1.372036, loss_ss: 0.818309, loss_d: 0.553726
0.4992 --- loss: 1.349486, loss_ss: 0.813934, loss_d: 0.535552
0.5376 --- loss: 1.550758, loss_ss: 1.008543, loss_d: 0.542215
0.5760 --- loss: 1.568897, loss_ss: 0.931207, loss_d: 0.637689
0.6144 --- loss: 1.910353, loss_ss: 1.227760, loss_d: 0.682593
0.6528 --- loss: 1.400946, loss_ss: 0.956870, loss_d: 0.444076
0.6912 --- loss: 1.485769, loss_ss: 0.718830, loss_d: 0.766939
0.7296 --- loss: 1.639610, loss_ss: 1.044302, loss_d: 0.595308
0.7680 --- loss: 1.171587, loss_ss: 0.872800, loss_d: 0.298786
0.8065 --- loss: 1.843900, loss_ss: 1.007985, loss_d: 0.835915
0.8449 --- loss: 1.625499, loss_ss: 1.149669, loss_d: 0.475831
0.8833 --- loss: 1.667933, loss_ss: 0.959422, loss_d: 0.708511
0.9217 --- loss: 1.731251, loss_ss: 1.164192, loss_d: 0.567058
0.9601 --- loss: 1.362188, loss_ss: 0.899121, loss_d: 0.463067
0.9985 --- loss: 2.163359, loss_ss: 1.024348, loss_d: 1.139011
Epoch finished! Loss: 1.5841996344236227
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.229495, loss_ss: 0.846831, loss_d: 0.382664
0.0384 --- loss: 1.207945, loss_ss: 0.963771, loss_d: 0.244174
0.0768 --- loss: 1.655404, loss_ss: 0.992062, loss_d: 0.663342
0.1152 --- loss: 1.189130, loss_ss: 0.902593, loss_d: 0.286536
0.1536 --- loss: 1.973887, loss_ss: 1.432283, loss_d: 0.541604
0.1920 --- loss: 1.788752, loss_ss: 1.044128, loss_d: 0.744624
0.2304 --- loss: 1.303353, loss_ss: 0.873740, loss_d: 0.429613
0.2688 --- loss: 1.177035, loss_ss: 0.894522, loss_d: 0.282512
0.3072 --- loss: 1.648302, loss_ss: 1.218241, loss_d: 0.430060
0.3456 --- loss: 1.463292, loss_ss: 0.848229, loss_d: 0.615063
0.3840 --- loss: 1.507408, loss_ss: 1.010280, loss_d: 0.497128
0.4224 --- loss: 1.217719, loss_ss: 0.742635, loss_d: 0.475084
0.4608 --- loss: 1.587435, loss_ss: 0.669246, loss_d: 0.918189
0.4992 --- loss: 1.574927, loss_ss: 0.783289, loss_d: 0.791638
0.5376 --- loss: 1.372228, loss_ss: 0.831057, loss_d: 0.541172
0.5760 --- loss: 1.242442, loss_ss: 0.995949, loss_d: 0.246494
0.6144 --- loss: 1.434246, loss_ss: 1.095910, loss_d: 0.338336
0.6528 --- loss: 1.247716, loss_ss: 0.811529, loss_d: 0.436188
0.6912 --- loss: 1.745067, loss_ss: 0.827800, loss_d: 0.917268
0.7296 --- loss: 1.271867, loss_ss: 0.979831, loss_d: 0.292035
0.7680 --- loss: 1.523247, loss_ss: 0.841266, loss_d: 0.681981
0.8065 --- loss: 1.439588, loss_ss: 0.867427, loss_d: 0.572161
0.8449 --- loss: 1.347549, loss_ss: 1.128922, loss_d: 0.218627
0.8833 --- loss: 1.365953, loss_ss: 1.054304, loss_d: 0.311649
0.9217 --- loss: 1.360031, loss_ss: 0.882879, loss_d: 0.477152
0.9601 --- loss: 1.248876, loss_ss: 0.777761, loss_d: 0.471115
0.9985 --- loss: 1.204680, loss_ss: 0.882872, loss_d: 0.321808
Epoch finished! Loss: 1.4514818764649904
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.294286, loss_ss: 0.967636, loss_d: 0.326650
0.0384 --- loss: 1.662050, loss_ss: 0.906338, loss_d: 0.755711
0.0768 --- loss: 1.456566, loss_ss: 0.973093, loss_d: 0.483472
0.1152 --- loss: 1.236119, loss_ss: 0.992876, loss_d: 0.243242
0.1536 --- loss: 1.429975, loss_ss: 0.917536, loss_d: 0.512439
0.1920 --- loss: 1.181841, loss_ss: 0.964508, loss_d: 0.217334
0.2304 --- loss: 1.315703, loss_ss: 0.932932, loss_d: 0.382770
0.2688 --- loss: 1.391045, loss_ss: 1.002565, loss_d: 0.388480
0.3072 --- loss: 1.256234, loss_ss: 0.942994, loss_d: 0.313240
0.3456 --- loss: 2.062834, loss_ss: 1.052313, loss_d: 1.010522
0.3840 --- loss: 1.025599, loss_ss: 0.748833, loss_d: 0.276766
0.4224 --- loss: 1.468400, loss_ss: 0.917213, loss_d: 0.551187
0.4608 --- loss: 1.315975, loss_ss: 0.819627, loss_d: 0.496348
0.4992 --- loss: 1.100240, loss_ss: 0.828978, loss_d: 0.271262
0.5376 --- loss: 1.096735, loss_ss: 0.806323, loss_d: 0.290412
0.5760 --- loss: 1.242528, loss_ss: 0.851723, loss_d: 0.390805
0.6144 --- loss: 1.422551, loss_ss: 0.935138, loss_d: 0.487413
0.6528 --- loss: 1.364429, loss_ss: 0.874098, loss_d: 0.490331
0.6912 --- loss: 1.138553, loss_ss: 0.500336, loss_d: 0.638217
0.7296 --- loss: 1.050133, loss_ss: 0.718819, loss_d: 0.331315
0.7680 --- loss: 1.419046, loss_ss: 0.732640, loss_d: 0.686406
0.8065 --- loss: 1.415889, loss_ss: 0.840601, loss_d: 0.575288
0.8449 --- loss: 1.149722, loss_ss: 0.753265, loss_d: 0.396457
0.8833 --- loss: 1.273691, loss_ss: 0.971118, loss_d: 0.302574
0.9217 --- loss: 2.121425, loss_ss: 0.972378, loss_d: 1.149046
0.9601 --- loss: 1.302599, loss_ss: 0.881581, loss_d: 0.421017
0.9985 --- loss: 1.116789, loss_ss: 0.950338, loss_d: 0.166451
Epoch finished! Loss: 1.3575465346758182
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.291564, loss_ss: 0.901263, loss_d: 0.390301
0.0384 --- loss: 1.345831, loss_ss: 0.849336, loss_d: 0.496495
0.0768 --- loss: 0.932763, loss_ss: 0.747741, loss_d: 0.185023
0.1152 --- loss: 1.090723, loss_ss: 0.795186, loss_d: 0.295537
0.1536 --- loss: 1.104298, loss_ss: 0.899026, loss_d: 0.205272
0.1920 --- loss: 1.105134, loss_ss: 0.903051, loss_d: 0.202084
0.2304 --- loss: 1.433725, loss_ss: 0.910657, loss_d: 0.523067
0.2688 --- loss: 0.869049, loss_ss: 0.683728, loss_d: 0.185321
0.3072 --- loss: 1.292003, loss_ss: 0.961563, loss_d: 0.330440
0.3456 --- loss: 1.126916, loss_ss: 0.986207, loss_d: 0.140709
0.3840 --- loss: 1.067860, loss_ss: 0.705512, loss_d: 0.362348
0.4224 --- loss: 0.941481, loss_ss: 0.713932, loss_d: 0.227549
0.4608 --- loss: 1.335193, loss_ss: 0.964095, loss_d: 0.371098
0.4992 --- loss: 1.357990, loss_ss: 1.124818, loss_d: 0.233172
0.5376 --- loss: 1.172471, loss_ss: 1.018565, loss_d: 0.153906
0.5760 --- loss: 1.113367, loss_ss: 0.797866, loss_d: 0.315502
0.6144 --- loss: 0.908033, loss_ss: 0.746879, loss_d: 0.161154
0.6528 --- loss: 1.109469, loss_ss: 0.846724, loss_d: 0.262744
0.6912 --- loss: 1.140298, loss_ss: 0.880714, loss_d: 0.259583
0.7296 --- loss: 1.167759, loss_ss: 0.937058, loss_d: 0.230701
0.7680 --- loss: 1.217415, loss_ss: 1.006073, loss_d: 0.211342
0.8065 --- loss: 0.877039, loss_ss: 0.652972, loss_d: 0.224068
0.8449 --- loss: 1.210640, loss_ss: 0.987208, loss_d: 0.223432
0.8833 --- loss: 1.361520, loss_ss: 0.981971, loss_d: 0.379549
0.9217 --- loss: 1.368958, loss_ss: 0.893237, loss_d: 0.475721
0.9601 --- loss: 1.086260, loss_ss: 0.633319, loss_d: 0.452940
0.9985 --- loss: 0.903517, loss_ss: 0.724607, loss_d: 0.178910
Epoch finished! Loss: 1.2703627091187697
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.281736, loss_ss: 0.974776, loss_d: 0.306960
0.0384 --- loss: 1.246637, loss_ss: 0.991463, loss_d: 0.255175
0.0768 --- loss: 1.617816, loss_ss: 1.188645, loss_d: 0.429171
0.1152 --- loss: 0.977304, loss_ss: 0.895941, loss_d: 0.081363
0.1536 --- loss: 0.907800, loss_ss: 0.806351, loss_d: 0.101449
0.1920 --- loss: 1.505264, loss_ss: 0.885146, loss_d: 0.620118
0.2304 --- loss: 1.194522, loss_ss: 0.765914, loss_d: 0.428608
0.2688 --- loss: 0.787843, loss_ss: 0.566355, loss_d: 0.221488
0.3072 --- loss: 1.298435, loss_ss: 1.071790, loss_d: 0.226646
0.3456 --- loss: 1.753987, loss_ss: 0.820823, loss_d: 0.933164
0.3840 --- loss: 1.340809, loss_ss: 0.879351, loss_d: 0.461457
0.4224 --- loss: 1.126113, loss_ss: 0.682055, loss_d: 0.444058
0.4608 --- loss: 1.176250, loss_ss: 0.872415, loss_d: 0.303835
0.4992 --- loss: 0.987229, loss_ss: 0.793578, loss_d: 0.193651
0.5376 --- loss: 1.588251, loss_ss: 1.084435, loss_d: 0.503816
0.5760 --- loss: 1.306272, loss_ss: 0.839412, loss_d: 0.466860
0.6144 --- loss: 1.035092, loss_ss: 0.712435, loss_d: 0.322657
0.6528 --- loss: 1.593582, loss_ss: 0.717033, loss_d: 0.876548
0.6912 --- loss: 1.155201, loss_ss: 0.912550, loss_d: 0.242651
0.7296 --- loss: 1.214565, loss_ss: 0.919432, loss_d: 0.295133
0.7680 --- loss: 1.736964, loss_ss: 1.237329, loss_d: 0.499635
0.8065 --- loss: 0.746546, loss_ss: 0.577021, loss_d: 0.169525
0.8449 --- loss: 1.226767, loss_ss: 0.725553, loss_d: 0.501215
0.8833 --- loss: 1.046353, loss_ss: 0.697203, loss_d: 0.349150
0.9217 --- loss: 1.063845, loss_ss: 0.897672, loss_d: 0.166173
0.9601 --- loss: 1.218877, loss_ss: 0.945802, loss_d: 0.273075
0.9985 --- loss: 0.917300, loss_ss: 0.825487, loss_d: 0.091814
Epoch finished! Loss: 1.1878719141850105
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.459770, loss_ss: 1.130449, loss_d: 0.329321
0.0384 --- loss: 1.130440, loss_ss: 0.984131, loss_d: 0.146309
0.0768 --- loss: 1.631031, loss_ss: 1.178457, loss_d: 0.452574
0.1152 --- loss: 0.965647, loss_ss: 0.886715, loss_d: 0.078932
0.1536 --- loss: 0.915038, loss_ss: 0.787925, loss_d: 0.127113
0.1920 --- loss: 0.809690, loss_ss: 0.628984, loss_d: 0.180706
0.2304 --- loss: 1.586350, loss_ss: 1.471743, loss_d: 0.114607
0.2688 --- loss: 1.220798, loss_ss: 0.981895, loss_d: 0.238903
0.3072 --- loss: 1.373964, loss_ss: 0.787759, loss_d: 0.586206
0.3456 --- loss: 1.001914, loss_ss: 0.784139, loss_d: 0.217774
0.3840 --- loss: 1.296030, loss_ss: 1.177285, loss_d: 0.118745
0.4224 --- loss: 1.397132, loss_ss: 0.945027, loss_d: 0.452105
0.4608 --- loss: 1.513649, loss_ss: 1.034596, loss_d: 0.479053
0.4992 --- loss: 1.081145, loss_ss: 0.838289, loss_d: 0.242855
0.5376 --- loss: 0.870459, loss_ss: 0.498474, loss_d: 0.371986
0.5760 --- loss: 1.379484, loss_ss: 1.138408, loss_d: 0.241076
0.6144 --- loss: 0.806622, loss_ss: 0.662590, loss_d: 0.144032
0.6528 --- loss: 1.519015, loss_ss: 1.000740, loss_d: 0.518275
0.6912 --- loss: 1.046369, loss_ss: 0.844932, loss_d: 0.201438
0.7296 --- loss: 1.062487, loss_ss: 0.817353, loss_d: 0.245134
0.7680 --- loss: 1.289374, loss_ss: 0.999898, loss_d: 0.289476
0.8065 --- loss: 1.363648, loss_ss: 1.173548, loss_d: 0.190099
0.8449 --- loss: 0.993859, loss_ss: 0.809901, loss_d: 0.183959
0.8833 --- loss: 1.348634, loss_ss: 1.155867, loss_d: 0.192767
0.9217 --- loss: 0.942741, loss_ss: 0.810934, loss_d: 0.131807
0.9601 --- loss: 1.111446, loss_ss: 0.869753, loss_d: 0.241693
0.9985 --- loss: 2.223935, loss_ss: 1.753521, loss_d: 0.470414
Epoch finished! Loss: 1.1606264306948735
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.457976, loss_ss: 1.318914, loss_d: 0.139062
0.0384 --- loss: 1.105024, loss_ss: 0.809805, loss_d: 0.295218
0.0768 --- loss: 0.835707, loss_ss: 0.705330, loss_d: 0.130377
0.1152 --- loss: 0.751089, loss_ss: 0.663694, loss_d: 0.087395
0.1536 --- loss: 1.036421, loss_ss: 0.795994, loss_d: 0.240427
0.1920 --- loss: 1.192177, loss_ss: 0.863219, loss_d: 0.328958
0.2304 --- loss: 1.106132, loss_ss: 0.901296, loss_d: 0.204836
0.2688 --- loss: 1.109241, loss_ss: 0.730022, loss_d: 0.379219
0.3072 --- loss: 0.990232, loss_ss: 0.854198, loss_d: 0.136034
0.3456 --- loss: 1.166778, loss_ss: 0.998838, loss_d: 0.167939
0.3840 --- loss: 0.877842, loss_ss: 0.821012, loss_d: 0.056830
0.4224 --- loss: 0.945250, loss_ss: 0.648743, loss_d: 0.296508
0.4608 --- loss: 1.052457, loss_ss: 0.806509, loss_d: 0.245948
0.4992 --- loss: 0.944436, loss_ss: 0.779445, loss_d: 0.164990
0.5376 --- loss: 1.493126, loss_ss: 1.018229, loss_d: 0.474897
0.5760 --- loss: 0.943032, loss_ss: 0.837284, loss_d: 0.105748
0.6144 --- loss: 1.339307, loss_ss: 1.098356, loss_d: 0.240951
0.6528 --- loss: 1.022785, loss_ss: 0.787880, loss_d: 0.234905
0.6912 --- loss: 1.346906, loss_ss: 1.020919, loss_d: 0.325987
0.7296 --- loss: 1.037977, loss_ss: 0.769060, loss_d: 0.268917
0.7680 --- loss: 0.890182, loss_ss: 0.622943, loss_d: 0.267240
0.8065 --- loss: 1.481443, loss_ss: 1.219074, loss_d: 0.262369
0.8449 --- loss: 0.982023, loss_ss: 0.836317, loss_d: 0.145706
0.8833 --- loss: 1.374443, loss_ss: 1.195732, loss_d: 0.178711
0.9217 --- loss: 0.919813, loss_ss: 0.739478, loss_d: 0.180335
0.9601 --- loss: 1.349872, loss_ss: 1.056530, loss_d: 0.293342
0.9985 --- loss: 1.379041, loss_ss: 0.908057, loss_d: 0.470984
Epoch finished! Loss: 1.1427197804817786
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.181796, loss_ss: 0.946878, loss_d: 0.234918
0.0384 --- loss: 1.078729, loss_ss: 0.756457, loss_d: 0.322272
0.0768 --- loss: 0.842512, loss_ss: 0.561394, loss_d: 0.281118
0.1152 --- loss: 0.844919, loss_ss: 0.634345, loss_d: 0.210574
0.1536 --- loss: 0.899713, loss_ss: 0.776270, loss_d: 0.123443
0.1920 --- loss: 0.824547, loss_ss: 0.739220, loss_d: 0.085327
0.2304 --- loss: 1.013758, loss_ss: 0.936714, loss_d: 0.077044
0.2688 --- loss: 1.074747, loss_ss: 0.843251, loss_d: 0.231496
0.3072 --- loss: 1.121413, loss_ss: 0.871394, loss_d: 0.250019
0.3456 --- loss: 0.780753, loss_ss: 0.702435, loss_d: 0.078317
0.3840 --- loss: 0.831546, loss_ss: 0.754476, loss_d: 0.077070
0.4224 --- loss: 0.880258, loss_ss: 0.731496, loss_d: 0.148762
0.4608 --- loss: 1.476262, loss_ss: 0.942735, loss_d: 0.533527
0.4992 --- loss: 0.795189, loss_ss: 0.748221, loss_d: 0.046968
0.5376 --- loss: 1.634592, loss_ss: 1.122198, loss_d: 0.512394
0.5760 --- loss: 1.486540, loss_ss: 0.723640, loss_d: 0.762901
0.6144 --- loss: 1.072675, loss_ss: 0.994140, loss_d: 0.078535
0.6528 --- loss: 1.631515, loss_ss: 0.751568, loss_d: 0.879947
0.6912 --- loss: 1.358908, loss_ss: 0.918043, loss_d: 0.440865
0.7296 --- loss: 1.288662, loss_ss: 0.794669, loss_d: 0.493994
0.7680 --- loss: 1.086468, loss_ss: 0.978189, loss_d: 0.108279
0.8065 --- loss: 1.057285, loss_ss: 0.851323, loss_d: 0.205962
0.8449 --- loss: 1.809999, loss_ss: 1.575654, loss_d: 0.234345
0.8833 --- loss: 1.019279, loss_ss: 0.911541, loss_d: 0.107738
0.9217 --- loss: 0.921703, loss_ss: 0.816409, loss_d: 0.105294
0.9601 --- loss: 0.721154, loss_ss: 0.554976, loss_d: 0.166178
0.9985 --- loss: 1.800152, loss_ss: 0.959537, loss_d: 0.840615
Epoch finished! Loss: 1.1025137738539623
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7124631992149166
             precision    recall  f1-score   support

        0.0       0.86      0.75      0.80       101
        1.0       0.20      0.64      0.30        55
        2.0       0.84      0.74      0.79       382
        3.0       0.67      0.86      0.75       191
        4.0       0.98      0.59      0.73       290

avg / total       0.82      0.71      0.74      1019
 


====== chp028-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.37  75.25   98.69  86.36     80.42
1  83.91  63.64   85.06  19.55     29.91
2  84.99  73.56   91.84  84.38     78.60
3  89.40  85.86   90.22  66.94     75.23
4  87.83  58.62   99.45  97.70     73.28
Total accuracy: 71.25%
Average sen: 71.39%
Average spec: 93.05%
Macro f1-score: 67.49%
Diagnosis acc on 15mins: 1.0
[0.99892443 0.99174398 0.98874563 0.99993622 0.99975175 0.99920303
 0.99969172 0.99801171 0.99981183 0.99996448 0.99999809 0.99989986
 0.99955517 0.99999833 0.99899489 0.99895096 0.99736398 0.99929917
 0.99995458 0.99998963 0.99999297 0.9999975  0.99976987 0.99923611
 0.99948478 0.99998045 0.99991465 0.99999154 0.99999309 0.99982327
 0.9995504  0.99805248 0.99786097 0.99805546]
pred: 0.9988674398730782, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp029-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.447223, loss_ss: 1.729659, loss_d: 0.717565
0.0384 --- loss: 2.281677, loss_ss: 1.431440, loss_d: 0.850237
0.0768 --- loss: 2.188219, loss_ss: 1.567356, loss_d: 0.620864
0.1152 --- loss: 1.871222, loss_ss: 1.422281, loss_d: 0.448940
0.1536 --- loss: 1.774594, loss_ss: 1.302841, loss_d: 0.471753
0.1920 --- loss: 2.302858, loss_ss: 1.560225, loss_d: 0.742633
0.2304 --- loss: 1.786442, loss_ss: 1.361353, loss_d: 0.425090
0.2688 --- loss: 1.987166, loss_ss: 1.414111, loss_d: 0.573055
0.3072 --- loss: 1.916055, loss_ss: 1.359620, loss_d: 0.556435
0.3456 --- loss: 1.803671, loss_ss: 1.314391, loss_d: 0.489280
0.3840 --- loss: 1.840660, loss_ss: 1.325672, loss_d: 0.514988
0.4224 --- loss: 1.876670, loss_ss: 1.291993, loss_d: 0.584678
0.4608 --- loss: 1.910982, loss_ss: 1.222677, loss_d: 0.688305
0.4992 --- loss: 1.878582, loss_ss: 1.352212, loss_d: 0.526369
0.5376 --- loss: 1.735137, loss_ss: 1.213637, loss_d: 0.521501
0.5760 --- loss: 1.901681, loss_ss: 1.296142, loss_d: 0.605538
0.6144 --- loss: 1.827845, loss_ss: 1.154518, loss_d: 0.673327
0.6528 --- loss: 1.646337, loss_ss: 1.137024, loss_d: 0.509313
0.6912 --- loss: 1.542315, loss_ss: 1.017528, loss_d: 0.524787
0.7296 --- loss: 1.939337, loss_ss: 1.331572, loss_d: 0.607765
0.7680 --- loss: 1.847525, loss_ss: 1.356260, loss_d: 0.491265
0.8065 --- loss: 1.737170, loss_ss: 1.262289, loss_d: 0.474881
0.8449 --- loss: 1.482344, loss_ss: 1.045580, loss_d: 0.436764
0.8833 --- loss: 1.793062, loss_ss: 1.183321, loss_d: 0.609741
0.9217 --- loss: 1.754015, loss_ss: 1.087251, loss_d: 0.666764
0.9601 --- loss: 1.658771, loss_ss: 1.141768, loss_d: 0.517004
0.9985 --- loss: 2.130225, loss_ss: 1.167225, loss_d: 0.963000
Epoch finished! Loss: 1.8965770198748662
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.926064, loss_ss: 1.017018, loss_d: 0.909045
0.0384 --- loss: 1.711098, loss_ss: 1.058328, loss_d: 0.652770
0.0768 --- loss: 1.613038, loss_ss: 1.106226, loss_d: 0.506813
0.1152 --- loss: 1.380859, loss_ss: 0.952319, loss_d: 0.428540
0.1536 --- loss: 1.610304, loss_ss: 1.330991, loss_d: 0.279313
0.1920 --- loss: 1.804111, loss_ss: 1.301803, loss_d: 0.502309
0.2304 --- loss: 1.840035, loss_ss: 0.983126, loss_d: 0.856909
0.2688 --- loss: 1.510427, loss_ss: 0.933228, loss_d: 0.577200
0.3072 --- loss: 1.973652, loss_ss: 1.245191, loss_d: 0.728460
0.3456 --- loss: 1.487550, loss_ss: 1.002361, loss_d: 0.485189
0.3840 --- loss: 1.465773, loss_ss: 0.940928, loss_d: 0.524845
0.4224 --- loss: 1.696520, loss_ss: 1.208555, loss_d: 0.487965
0.4608 --- loss: 2.000360, loss_ss: 1.225229, loss_d: 0.775131
0.4992 --- loss: 1.585890, loss_ss: 1.092598, loss_d: 0.493292
0.5376 --- loss: 1.371239, loss_ss: 0.842798, loss_d: 0.528441
0.5760 --- loss: 1.191364, loss_ss: 0.850943, loss_d: 0.340421
0.6144 --- loss: 1.630697, loss_ss: 0.988748, loss_d: 0.641949
0.6528 --- loss: 1.763233, loss_ss: 1.226306, loss_d: 0.536927
0.6912 --- loss: 1.717859, loss_ss: 1.109838, loss_d: 0.608021
0.7296 --- loss: 1.775918, loss_ss: 1.300474, loss_d: 0.475444
0.7680 --- loss: 1.354012, loss_ss: 0.911379, loss_d: 0.442634
0.8065 --- loss: 1.245191, loss_ss: 0.911756, loss_d: 0.333436
0.8449 --- loss: 1.884148, loss_ss: 1.162455, loss_d: 0.721693
0.8833 --- loss: 1.558590, loss_ss: 1.137584, loss_d: 0.421006
0.9217 --- loss: 1.617585, loss_ss: 0.885366, loss_d: 0.732219
0.9601 --- loss: 1.730041, loss_ss: 1.171474, loss_d: 0.558567
0.9985 --- loss: 1.532726, loss_ss: 0.998758, loss_d: 0.533969
Epoch finished! Loss: 1.6696486404308906
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.583670, loss_ss: 1.157893, loss_d: 0.425776
0.0384 --- loss: 1.491390, loss_ss: 0.803774, loss_d: 0.687615
0.0768 --- loss: 1.291705, loss_ss: 0.902746, loss_d: 0.388959
0.1152 --- loss: 1.654484, loss_ss: 0.997224, loss_d: 0.657260
0.1536 --- loss: 1.540513, loss_ss: 1.130882, loss_d: 0.409631
0.1920 --- loss: 1.929198, loss_ss: 0.885023, loss_d: 1.044175
0.2304 --- loss: 1.853156, loss_ss: 1.170077, loss_d: 0.683079
0.2688 --- loss: 1.609039, loss_ss: 0.988626, loss_d: 0.620413
0.3072 --- loss: 1.729623, loss_ss: 1.012149, loss_d: 0.717474
0.3456 --- loss: 1.431216, loss_ss: 0.872007, loss_d: 0.559208
0.3840 --- loss: 1.615517, loss_ss: 0.870259, loss_d: 0.745258
0.4224 --- loss: 1.449414, loss_ss: 0.741046, loss_d: 0.708368
0.4608 --- loss: 1.465888, loss_ss: 0.939936, loss_d: 0.525951
0.4992 --- loss: 2.142623, loss_ss: 1.512318, loss_d: 0.630306
0.5376 --- loss: 1.632623, loss_ss: 0.902576, loss_d: 0.730048
0.5760 --- loss: 1.449262, loss_ss: 0.932375, loss_d: 0.516886
0.6144 --- loss: 1.354022, loss_ss: 0.895364, loss_d: 0.458658
0.6528 --- loss: 1.540838, loss_ss: 0.965276, loss_d: 0.575562
0.6912 --- loss: 1.602155, loss_ss: 1.105409, loss_d: 0.496746
0.7296 --- loss: 1.684450, loss_ss: 1.078674, loss_d: 0.605776
0.7680 --- loss: 1.772133, loss_ss: 0.859430, loss_d: 0.912704
0.8065 --- loss: 1.104354, loss_ss: 0.842419, loss_d: 0.261935
0.8449 --- loss: 1.511860, loss_ss: 1.216629, loss_d: 0.295230
0.8833 --- loss: 1.437538, loss_ss: 0.882949, loss_d: 0.554590
0.9217 --- loss: 1.581051, loss_ss: 0.901002, loss_d: 0.680048
0.9601 --- loss: 1.833303, loss_ss: 1.317204, loss_d: 0.516099
0.9985 --- loss: 1.519895, loss_ss: 1.238942, loss_d: 0.280953
Epoch finished! Loss: 1.5759115430024955
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.666717, loss_ss: 1.023179, loss_d: 0.643538
0.0384 --- loss: 2.448771, loss_ss: 1.325267, loss_d: 1.123505
0.0768 --- loss: 1.863886, loss_ss: 0.910760, loss_d: 0.953126
0.1152 --- loss: 1.305458, loss_ss: 0.859374, loss_d: 0.446084
0.1536 --- loss: 1.580989, loss_ss: 0.958810, loss_d: 0.622179
0.1920 --- loss: 1.391626, loss_ss: 0.918748, loss_d: 0.472878
0.2304 --- loss: 1.129944, loss_ss: 0.790725, loss_d: 0.339219
0.2688 --- loss: 1.101630, loss_ss: 0.827083, loss_d: 0.274547
0.3072 --- loss: 1.810486, loss_ss: 0.914693, loss_d: 0.895793
0.3456 --- loss: 1.557327, loss_ss: 0.865363, loss_d: 0.691963
0.3840 --- loss: 1.595952, loss_ss: 1.014607, loss_d: 0.581345
0.4224 --- loss: 1.446596, loss_ss: 0.921690, loss_d: 0.524906
0.4608 --- loss: 1.487111, loss_ss: 0.814117, loss_d: 0.672994
0.4992 --- loss: 1.340387, loss_ss: 0.898792, loss_d: 0.441595
0.5376 --- loss: 1.520144, loss_ss: 0.819143, loss_d: 0.701001
0.5760 --- loss: 1.565441, loss_ss: 0.986134, loss_d: 0.579307
0.6144 --- loss: 1.769426, loss_ss: 0.976738, loss_d: 0.792688
0.6528 --- loss: 1.827087, loss_ss: 1.177837, loss_d: 0.649250
0.6912 --- loss: 1.398312, loss_ss: 0.918446, loss_d: 0.479866
0.7296 --- loss: 1.315308, loss_ss: 0.828741, loss_d: 0.486567
0.7680 --- loss: 1.221553, loss_ss: 0.825281, loss_d: 0.396272
0.8065 --- loss: 1.270073, loss_ss: 0.828866, loss_d: 0.441207
0.8449 --- loss: 1.561366, loss_ss: 1.023969, loss_d: 0.537397
0.8833 --- loss: 2.011133, loss_ss: 0.972151, loss_d: 1.038983
0.9217 --- loss: 1.456687, loss_ss: 1.009990, loss_d: 0.446697
0.9601 --- loss: 1.795932, loss_ss: 1.213227, loss_d: 0.582706
0.9985 --- loss: 1.834412, loss_ss: 1.226472, loss_d: 0.607940
Epoch finished! Loss: 1.526856925854316
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.429170, loss_ss: 0.812955, loss_d: 0.616215
0.0384 --- loss: 1.287811, loss_ss: 0.773989, loss_d: 0.513821
0.0768 --- loss: 1.625342, loss_ss: 0.848065, loss_d: 0.777277
0.1152 --- loss: 1.296648, loss_ss: 0.694167, loss_d: 0.602481
0.1536 --- loss: 1.375630, loss_ss: 0.797067, loss_d: 0.578563
0.1920 --- loss: 1.653098, loss_ss: 1.022062, loss_d: 0.631036
0.2304 --- loss: 1.529307, loss_ss: 1.078638, loss_d: 0.450668
0.2688 --- loss: 1.414701, loss_ss: 0.606086, loss_d: 0.808615
0.3072 --- loss: 1.411696, loss_ss: 0.981235, loss_d: 0.430461
0.3456 --- loss: 1.264769, loss_ss: 0.902728, loss_d: 0.362040
0.3840 --- loss: 1.488111, loss_ss: 0.981108, loss_d: 0.507003
0.4224 --- loss: 1.966902, loss_ss: 1.192083, loss_d: 0.774819
0.4608 --- loss: 1.580444, loss_ss: 0.935538, loss_d: 0.644906
0.4992 --- loss: 1.249013, loss_ss: 0.773488, loss_d: 0.475525
0.5376 --- loss: 1.509897, loss_ss: 0.767873, loss_d: 0.742025
0.5760 --- loss: 1.301241, loss_ss: 0.748508, loss_d: 0.552733
0.6144 --- loss: 2.132275, loss_ss: 1.229556, loss_d: 0.902719
0.6528 --- loss: 1.548960, loss_ss: 0.911716, loss_d: 0.637245
0.6912 --- loss: 1.203782, loss_ss: 0.665796, loss_d: 0.537986
0.7296 --- loss: 1.449094, loss_ss: 0.931443, loss_d: 0.517652
0.7680 --- loss: 1.606405, loss_ss: 0.873479, loss_d: 0.732926
0.8065 --- loss: 1.518067, loss_ss: 0.825611, loss_d: 0.692456
0.8449 --- loss: 1.405630, loss_ss: 0.949412, loss_d: 0.456218
0.8833 --- loss: 1.081946, loss_ss: 0.811529, loss_d: 0.270417
0.9217 --- loss: 1.492829, loss_ss: 1.052366, loss_d: 0.440463
0.9601 --- loss: 1.360168, loss_ss: 0.739327, loss_d: 0.620841
0.9985 --- loss: 1.152286, loss_ss: 0.878865, loss_d: 0.273420
Epoch finished! Loss: 1.4862460338152372
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.222902, loss_ss: 0.749116, loss_d: 0.473786
0.0384 --- loss: 1.409387, loss_ss: 0.821445, loss_d: 0.587942
0.0768 --- loss: 1.167713, loss_ss: 0.898111, loss_d: 0.269602
0.1152 --- loss: 1.446895, loss_ss: 0.887806, loss_d: 0.559089
0.1536 --- loss: 1.142948, loss_ss: 0.792912, loss_d: 0.350036
0.1920 --- loss: 1.760576, loss_ss: 1.200705, loss_d: 0.559872
0.2304 --- loss: 1.186454, loss_ss: 0.705573, loss_d: 0.480881
0.2688 --- loss: 1.469489, loss_ss: 0.614018, loss_d: 0.855471
0.3072 --- loss: 1.207235, loss_ss: 0.865251, loss_d: 0.341984
0.3456 --- loss: 1.435665, loss_ss: 0.865560, loss_d: 0.570105
0.3840 --- loss: 1.568690, loss_ss: 0.921001, loss_d: 0.647689
0.4224 --- loss: 1.474226, loss_ss: 1.120397, loss_d: 0.353829
0.4608 --- loss: 1.299748, loss_ss: 0.728816, loss_d: 0.570932
0.4992 --- loss: 1.382803, loss_ss: 1.033558, loss_d: 0.349245
0.5376 --- loss: 1.514436, loss_ss: 0.817831, loss_d: 0.696605
0.5760 --- loss: 1.528086, loss_ss: 0.746146, loss_d: 0.781940
0.6144 --- loss: 1.323904, loss_ss: 0.920353, loss_d: 0.403551
0.6528 --- loss: 1.526203, loss_ss: 1.272907, loss_d: 0.253295
0.6912 --- loss: 1.224424, loss_ss: 0.926014, loss_d: 0.298410
0.7296 --- loss: 1.443870, loss_ss: 0.952153, loss_d: 0.491716
0.7680 --- loss: 1.083055, loss_ss: 0.747793, loss_d: 0.335263
0.8065 --- loss: 1.535948, loss_ss: 1.210581, loss_d: 0.325367
0.8449 --- loss: 1.380209, loss_ss: 0.764083, loss_d: 0.616126
0.8833 --- loss: 1.098076, loss_ss: 0.728355, loss_d: 0.369721
0.9217 --- loss: 1.081805, loss_ss: 0.874661, loss_d: 0.207144
0.9601 --- loss: 1.621449, loss_ss: 0.988741, loss_d: 0.632708
0.9985 --- loss: 1.403482, loss_ss: 0.974064, loss_d: 0.429417
Epoch finished! Loss: 1.3994058510431877
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.422393, loss_ss: 1.043127, loss_d: 0.379266
0.0384 --- loss: 1.440238, loss_ss: 0.765782, loss_d: 0.674456
0.0768 --- loss: 1.271089, loss_ss: 0.891175, loss_d: 0.379914
0.1152 --- loss: 1.256473, loss_ss: 0.849791, loss_d: 0.406683
0.1536 --- loss: 1.670890, loss_ss: 0.869516, loss_d: 0.801374
0.1920 --- loss: 1.427552, loss_ss: 1.018162, loss_d: 0.409390
0.2304 --- loss: 1.306243, loss_ss: 0.947346, loss_d: 0.358897
0.2688 --- loss: 1.180080, loss_ss: 0.600676, loss_d: 0.579404
0.3072 --- loss: 1.565393, loss_ss: 1.147349, loss_d: 0.418045
0.3456 --- loss: 1.563633, loss_ss: 0.872504, loss_d: 0.691129
0.3840 --- loss: 1.739805, loss_ss: 0.798536, loss_d: 0.941269
0.4224 --- loss: 1.369915, loss_ss: 1.002355, loss_d: 0.367560
0.4608 --- loss: 1.014014, loss_ss: 0.597205, loss_d: 0.416810
0.4992 --- loss: 1.697157, loss_ss: 0.556019, loss_d: 1.141138
0.5376 --- loss: 1.221380, loss_ss: 0.957984, loss_d: 0.263396
0.5760 --- loss: 1.452060, loss_ss: 0.947514, loss_d: 0.504546
0.6144 --- loss: 0.939383, loss_ss: 0.624022, loss_d: 0.315361
0.6528 --- loss: 1.385560, loss_ss: 0.934217, loss_d: 0.451343
0.6912 --- loss: 1.673030, loss_ss: 1.217890, loss_d: 0.455140
0.7296 --- loss: 1.300032, loss_ss: 0.887118, loss_d: 0.412914
0.7680 --- loss: 1.689524, loss_ss: 1.220963, loss_d: 0.468561
0.8065 --- loss: 1.543567, loss_ss: 1.047679, loss_d: 0.495888
0.8449 --- loss: 1.306635, loss_ss: 0.931486, loss_d: 0.375149
0.8833 --- loss: 1.200894, loss_ss: 0.720941, loss_d: 0.479953
0.9217 --- loss: 1.304546, loss_ss: 0.749509, loss_d: 0.555037
0.9601 --- loss: 1.364458, loss_ss: 0.644697, loss_d: 0.719760
0.9985 --- loss: 0.918484, loss_ss: 0.747797, loss_d: 0.170687
Epoch finished! Loss: 1.349506423335809
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.052648, loss_ss: 0.753654, loss_d: 0.298993
0.0384 --- loss: 0.814879, loss_ss: 0.535494, loss_d: 0.279385
0.0768 --- loss: 1.337186, loss_ss: 0.720334, loss_d: 0.616851
0.1152 --- loss: 1.139690, loss_ss: 0.823062, loss_d: 0.316628
0.1536 --- loss: 1.440760, loss_ss: 1.071442, loss_d: 0.369317
0.1920 --- loss: 1.612197, loss_ss: 1.015382, loss_d: 0.596815
0.2304 --- loss: 1.410036, loss_ss: 0.958375, loss_d: 0.451661
0.2688 --- loss: 0.872002, loss_ss: 0.680038, loss_d: 0.191964
0.3072 --- loss: 1.395528, loss_ss: 0.836481, loss_d: 0.559047
0.3456 --- loss: 1.544362, loss_ss: 1.264561, loss_d: 0.279801
0.3840 --- loss: 0.816107, loss_ss: 0.566346, loss_d: 0.249761
0.4224 --- loss: 1.132626, loss_ss: 0.940890, loss_d: 0.191736
0.4608 --- loss: 1.199204, loss_ss: 0.932933, loss_d: 0.266272
0.4992 --- loss: 1.006505, loss_ss: 0.709401, loss_d: 0.297104
0.5376 --- loss: 1.493073, loss_ss: 0.940979, loss_d: 0.552094
0.5760 --- loss: 1.184096, loss_ss: 0.816567, loss_d: 0.367529
0.6144 --- loss: 1.470053, loss_ss: 0.881262, loss_d: 0.588791
0.6528 --- loss: 0.924378, loss_ss: 0.646834, loss_d: 0.277544
0.6912 --- loss: 1.371807, loss_ss: 0.951285, loss_d: 0.420522
0.7296 --- loss: 1.355312, loss_ss: 0.833013, loss_d: 0.522299
0.7680 --- loss: 1.593970, loss_ss: 1.295233, loss_d: 0.298737
0.8065 --- loss: 1.472764, loss_ss: 1.008919, loss_d: 0.463845
0.8449 --- loss: 1.452966, loss_ss: 0.788639, loss_d: 0.664327
0.8833 --- loss: 1.263506, loss_ss: 0.949470, loss_d: 0.314037
0.9217 --- loss: 0.944766, loss_ss: 0.702918, loss_d: 0.241848
0.9601 --- loss: 1.430593, loss_ss: 1.118693, loss_d: 0.311901
0.9985 --- loss: 1.371366, loss_ss: 1.059513, loss_d: 0.311853
Epoch finished! Loss: 1.2764500182408554
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.034043, loss_ss: 0.795608, loss_d: 0.238435
0.0384 --- loss: 0.791792, loss_ss: 0.667456, loss_d: 0.124336
0.0768 --- loss: 1.265341, loss_ss: 0.763453, loss_d: 0.501887
0.1152 --- loss: 1.371965, loss_ss: 0.815095, loss_d: 0.556870
0.1536 --- loss: 1.121895, loss_ss: 0.944377, loss_d: 0.177518
0.1920 --- loss: 1.242434, loss_ss: 1.001066, loss_d: 0.241368
0.2304 --- loss: 1.042512, loss_ss: 0.671469, loss_d: 0.371043
0.2688 --- loss: 1.272214, loss_ss: 0.901114, loss_d: 0.371099
0.3072 --- loss: 1.279359, loss_ss: 0.954474, loss_d: 0.324885
0.3456 --- loss: 1.498697, loss_ss: 0.971122, loss_d: 0.527575
0.3840 --- loss: 1.161672, loss_ss: 0.872504, loss_d: 0.289168
0.4224 --- loss: 1.139485, loss_ss: 0.750494, loss_d: 0.388990
0.4608 --- loss: 1.132630, loss_ss: 0.835600, loss_d: 0.297030
0.4992 --- loss: 1.339345, loss_ss: 1.110087, loss_d: 0.229258
0.5376 --- loss: 1.216499, loss_ss: 0.777274, loss_d: 0.439225
0.5760 --- loss: 1.175119, loss_ss: 0.848664, loss_d: 0.326455
0.6144 --- loss: 0.896137, loss_ss: 0.729177, loss_d: 0.166960
0.6528 --- loss: 1.346680, loss_ss: 1.024244, loss_d: 0.322436
0.6912 --- loss: 1.143869, loss_ss: 0.939428, loss_d: 0.204441
0.7296 --- loss: 1.045564, loss_ss: 0.738442, loss_d: 0.307123
0.7680 --- loss: 1.116336, loss_ss: 0.845758, loss_d: 0.270577
0.8065 --- loss: 1.117559, loss_ss: 0.732856, loss_d: 0.384703
0.8449 --- loss: 2.278797, loss_ss: 1.155412, loss_d: 1.123385
0.8833 --- loss: 1.261626, loss_ss: 0.938977, loss_d: 0.322648
0.9217 --- loss: 1.265439, loss_ss: 0.898129, loss_d: 0.367310
0.9601 --- loss: 1.562476, loss_ss: 1.234816, loss_d: 0.327660
0.9985 --- loss: 1.942285, loss_ss: 1.630198, loss_d: 0.312087
Epoch finished! Loss: 1.2623289028039346
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.294456, loss_ss: 0.680954, loss_d: 0.613501
0.0384 --- loss: 1.941383, loss_ss: 1.578149, loss_d: 0.363234
0.0768 --- loss: 1.740690, loss_ss: 0.866781, loss_d: 0.873909
0.1152 --- loss: 0.835634, loss_ss: 0.586171, loss_d: 0.249463
0.1536 --- loss: 1.160070, loss_ss: 0.797119, loss_d: 0.362951
0.1920 --- loss: 1.544654, loss_ss: 1.186794, loss_d: 0.357860
0.2304 --- loss: 1.073261, loss_ss: 0.695013, loss_d: 0.378248
0.2688 --- loss: 1.096791, loss_ss: 0.793747, loss_d: 0.303045
0.3072 --- loss: 1.271419, loss_ss: 0.696881, loss_d: 0.574539
0.3456 --- loss: 0.945518, loss_ss: 0.708341, loss_d: 0.237177
0.3840 --- loss: 1.238028, loss_ss: 0.981498, loss_d: 0.256530
0.4224 --- loss: 0.716169, loss_ss: 0.574271, loss_d: 0.141898
0.4608 --- loss: 1.246028, loss_ss: 1.106411, loss_d: 0.139618
0.4992 --- loss: 1.023407, loss_ss: 0.551314, loss_d: 0.472093
0.5376 --- loss: 1.060635, loss_ss: 0.745914, loss_d: 0.314721
0.5760 --- loss: 1.063347, loss_ss: 0.942860, loss_d: 0.120487
0.6144 --- loss: 1.483670, loss_ss: 0.776040, loss_d: 0.707630
0.6528 --- loss: 1.620906, loss_ss: 1.216209, loss_d: 0.404697
0.6912 --- loss: 1.481157, loss_ss: 0.820863, loss_d: 0.660294
0.7296 --- loss: 1.081871, loss_ss: 0.638333, loss_d: 0.443538
0.7680 --- loss: 1.086831, loss_ss: 0.765703, loss_d: 0.321128
0.8065 --- loss: 1.255565, loss_ss: 0.727481, loss_d: 0.528084
0.8449 --- loss: 1.586505, loss_ss: 1.178673, loss_d: 0.407832
0.8833 --- loss: 0.867767, loss_ss: 0.692652, loss_d: 0.175115
0.9217 --- loss: 1.089132, loss_ss: 0.866898, loss_d: 0.222234
0.9601 --- loss: 1.210020, loss_ss: 0.579740, loss_d: 0.630280
0.9985 --- loss: 0.735869, loss_ss: 0.612952, loss_d: 0.122918
Epoch finished! Loss: 1.204146344615863
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7666666666666667
             precision    recall  f1-score   support

        0.0       0.81      0.52      0.63        66
        1.0       0.00      0.00      0.00        44
        2.0       0.70      0.90      0.79       406
        3.0       0.96      0.74      0.84       334
        4.0       0.68      0.80      0.74       170

avg / total       0.76      0.77      0.75      1020
 


====== chp029-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  96.08  51.52   99.16  80.95     62.96
1  95.39   0.00   99.69   0.00      0.00
2  80.78  89.66   74.92  70.27     78.79
3  90.59  74.25   98.54  96.12     83.78
4  90.49  80.00   92.59  68.34     73.71
Total accuracy: 76.67%
Average sen: 59.08%
Average spec: 92.98%
Macro f1-score: 59.85%
Diagnosis acc on 15mins: 0.7647058823529411
[0.8495785  0.96690506 0.9639439  0.86231685 0.58086741 0.64782035
 0.42180878 0.45324716 0.4805792  0.96324658 0.90104216 0.93350309
 0.78123432 0.85721916 0.61737084 0.4760865  0.73731029 0.90340686
 0.96441424 0.96633488 0.93898487 0.65109271 0.85922784 0.93969011
 0.9502601  0.42735988 0.51750678 0.84337318 0.90632826 0.96373713
 0.92052406 0.45650619 0.46404919 0.44641656]
pred: 0.7533321468269124, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp030-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.474639, loss_ss: 1.790927, loss_d: 0.683712
0.0385 --- loss: 2.057984, loss_ss: 1.743601, loss_d: 0.314383
0.0770 --- loss: 2.411399, loss_ss: 1.558283, loss_d: 0.853116
0.1155 --- loss: 1.928617, loss_ss: 1.349687, loss_d: 0.578931
0.1540 --- loss: 2.096053, loss_ss: 1.420358, loss_d: 0.675696
0.1925 --- loss: 2.008715, loss_ss: 1.395530, loss_d: 0.613186
0.2309 --- loss: 1.874907, loss_ss: 1.351845, loss_d: 0.523062
0.2694 --- loss: 1.848394, loss_ss: 1.447242, loss_d: 0.401152
0.3079 --- loss: 1.581158, loss_ss: 1.149872, loss_d: 0.431286
0.3464 --- loss: 1.896634, loss_ss: 1.445334, loss_d: 0.451299
0.3849 --- loss: 1.964692, loss_ss: 1.452088, loss_d: 0.512605
0.4234 --- loss: 1.713696, loss_ss: 1.216609, loss_d: 0.497088
0.4619 --- loss: 1.736665, loss_ss: 1.206365, loss_d: 0.530300
0.5004 --- loss: 1.760420, loss_ss: 1.093132, loss_d: 0.667287
0.5389 --- loss: 1.611609, loss_ss: 1.255770, loss_d: 0.355839
0.5774 --- loss: 1.824896, loss_ss: 1.192151, loss_d: 0.632745
0.6159 --- loss: 1.732282, loss_ss: 1.171328, loss_d: 0.560954
0.6543 --- loss: 1.698352, loss_ss: 1.024817, loss_d: 0.673535
0.6928 --- loss: 1.735795, loss_ss: 1.030530, loss_d: 0.705265
0.7313 --- loss: 1.873381, loss_ss: 1.209495, loss_d: 0.663886
0.7698 --- loss: 1.700755, loss_ss: 1.007659, loss_d: 0.693096
0.8083 --- loss: 1.816352, loss_ss: 1.145440, loss_d: 0.670912
0.8468 --- loss: 1.891915, loss_ss: 1.281820, loss_d: 0.610095
0.8853 --- loss: 1.546643, loss_ss: 1.001575, loss_d: 0.545069
0.9238 --- loss: 1.986992, loss_ss: 1.280387, loss_d: 0.706605
0.9623 --- loss: 1.807949, loss_ss: 1.203077, loss_d: 0.604872
Epoch finished! Loss: 1.8913967425298506
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.664666, loss_ss: 1.279769, loss_d: 0.384897
0.0385 --- loss: 1.654295, loss_ss: 1.212698, loss_d: 0.441598
0.0770 --- loss: 1.598660, loss_ss: 1.151722, loss_d: 0.446938
0.1155 --- loss: 1.726387, loss_ss: 1.127259, loss_d: 0.599129
0.1540 --- loss: 2.103298, loss_ss: 1.274819, loss_d: 0.828480
0.1925 --- loss: 1.537016, loss_ss: 1.084117, loss_d: 0.452899
0.2309 --- loss: 1.557345, loss_ss: 1.017723, loss_d: 0.539621
0.2694 --- loss: 1.675731, loss_ss: 1.092188, loss_d: 0.583543
0.3079 --- loss: 1.916468, loss_ss: 1.284952, loss_d: 0.631516
0.3464 --- loss: 1.557677, loss_ss: 1.025945, loss_d: 0.531732
0.3849 --- loss: 1.958114, loss_ss: 1.423407, loss_d: 0.534707
0.4234 --- loss: 1.763644, loss_ss: 1.215065, loss_d: 0.548579
0.4619 --- loss: 1.760133, loss_ss: 1.337849, loss_d: 0.422283
0.5004 --- loss: 1.607271, loss_ss: 1.088339, loss_d: 0.518933
0.5389 --- loss: 1.777095, loss_ss: 1.208475, loss_d: 0.568620
0.5774 --- loss: 1.672882, loss_ss: 1.208673, loss_d: 0.464209
0.6159 --- loss: 1.466120, loss_ss: 1.182616, loss_d: 0.283504
0.6543 --- loss: 1.475233, loss_ss: 0.983918, loss_d: 0.491315
0.6928 --- loss: 1.578353, loss_ss: 1.088755, loss_d: 0.489598
0.7313 --- loss: 1.852674, loss_ss: 1.212353, loss_d: 0.640321
0.7698 --- loss: 1.880238, loss_ss: 1.021603, loss_d: 0.858636
0.8083 --- loss: 1.368401, loss_ss: 0.970065, loss_d: 0.398336
0.8468 --- loss: 1.533985, loss_ss: 0.973413, loss_d: 0.560572
0.8853 --- loss: 1.832345, loss_ss: 1.217005, loss_d: 0.615340
0.9238 --- loss: 1.681878, loss_ss: 1.170122, loss_d: 0.511757
0.9623 --- loss: 1.921385, loss_ss: 1.095548, loss_d: 0.825837
Epoch finished! Loss: 1.6959938892526516
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.137690, loss_ss: 0.841843, loss_d: 0.295847
0.0385 --- loss: 1.375057, loss_ss: 0.870147, loss_d: 0.504910
0.0770 --- loss: 1.413839, loss_ss: 0.956638, loss_d: 0.457202
0.1155 --- loss: 1.454046, loss_ss: 1.077342, loss_d: 0.376704
0.1540 --- loss: 1.848270, loss_ss: 1.051175, loss_d: 0.797095
0.1925 --- loss: 1.808048, loss_ss: 0.894767, loss_d: 0.913281
0.2309 --- loss: 1.616150, loss_ss: 1.116539, loss_d: 0.499611
0.2694 --- loss: 1.431704, loss_ss: 0.861829, loss_d: 0.569876
0.3079 --- loss: 1.564400, loss_ss: 1.063284, loss_d: 0.501116
0.3464 --- loss: 1.553755, loss_ss: 0.988308, loss_d: 0.565447
0.3849 --- loss: 1.698382, loss_ss: 1.197975, loss_d: 0.500407
0.4234 --- loss: 1.429152, loss_ss: 0.894438, loss_d: 0.534714
0.4619 --- loss: 1.583436, loss_ss: 0.936957, loss_d: 0.646479
0.5004 --- loss: 1.404635, loss_ss: 0.989837, loss_d: 0.414797
0.5389 --- loss: 1.515081, loss_ss: 0.915098, loss_d: 0.599983
0.5774 --- loss: 1.589631, loss_ss: 0.968732, loss_d: 0.620899
0.6159 --- loss: 1.703586, loss_ss: 1.177037, loss_d: 0.526549
0.6543 --- loss: 1.511240, loss_ss: 1.106506, loss_d: 0.404734
0.6928 --- loss: 1.501979, loss_ss: 1.223164, loss_d: 0.278815
0.7313 --- loss: 1.584355, loss_ss: 1.294083, loss_d: 0.290271
0.7698 --- loss: 1.739236, loss_ss: 1.053455, loss_d: 0.685781
0.8083 --- loss: 1.224842, loss_ss: 0.823922, loss_d: 0.400919
0.8468 --- loss: 1.987051, loss_ss: 1.480855, loss_d: 0.506196
0.8853 --- loss: 1.749087, loss_ss: 1.543677, loss_d: 0.205409
0.9238 --- loss: 1.319719, loss_ss: 0.809320, loss_d: 0.510399
0.9623 --- loss: 1.625551, loss_ss: 0.911573, loss_d: 0.713979
Epoch finished! Loss: 1.5871548247613503
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.706174, loss_ss: 0.934801, loss_d: 0.771373
0.0385 --- loss: 1.782620, loss_ss: 1.365767, loss_d: 0.416853
0.0770 --- loss: 2.028752, loss_ss: 1.589872, loss_d: 0.438880
0.1155 --- loss: 1.834875, loss_ss: 1.405994, loss_d: 0.428881
0.1540 --- loss: 1.586200, loss_ss: 1.091561, loss_d: 0.494639
0.1925 --- loss: 1.600549, loss_ss: 0.933530, loss_d: 0.667018
0.2309 --- loss: 1.609320, loss_ss: 1.021409, loss_d: 0.587910
0.2694 --- loss: 1.391494, loss_ss: 0.882363, loss_d: 0.509131
0.3079 --- loss: 1.665177, loss_ss: 1.050101, loss_d: 0.615076
0.3464 --- loss: 1.436251, loss_ss: 0.888274, loss_d: 0.547977
0.3849 --- loss: 1.493702, loss_ss: 0.920354, loss_d: 0.573349
0.4234 --- loss: 1.630470, loss_ss: 0.998064, loss_d: 0.632406
0.4619 --- loss: 1.565852, loss_ss: 0.983769, loss_d: 0.582083
0.5004 --- loss: 1.417578, loss_ss: 0.927540, loss_d: 0.490039
0.5389 --- loss: 1.321791, loss_ss: 0.810443, loss_d: 0.511349
0.5774 --- loss: 1.916867, loss_ss: 0.972394, loss_d: 0.944473
0.6159 --- loss: 1.550769, loss_ss: 0.953285, loss_d: 0.597485
0.6543 --- loss: 1.545573, loss_ss: 1.014512, loss_d: 0.531061
0.6928 --- loss: 1.461118, loss_ss: 0.941129, loss_d: 0.519990
0.7313 --- loss: 1.174695, loss_ss: 0.786476, loss_d: 0.388220
0.7698 --- loss: 1.644770, loss_ss: 0.946797, loss_d: 0.697974
0.8083 --- loss: 1.302848, loss_ss: 0.881605, loss_d: 0.421243
0.8468 --- loss: 1.447744, loss_ss: 1.207206, loss_d: 0.240538
0.8853 --- loss: 1.160193, loss_ss: 0.931149, loss_d: 0.229043
0.9238 --- loss: 1.518575, loss_ss: 0.983328, loss_d: 0.535248
0.9623 --- loss: 1.380964, loss_ss: 0.924947, loss_d: 0.456017
Epoch finished! Loss: 1.5054945135668898
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.537068, loss_ss: 0.822787, loss_d: 0.714281
0.0385 --- loss: 1.323546, loss_ss: 1.028708, loss_d: 0.294837
0.0770 --- loss: 1.400191, loss_ss: 1.006658, loss_d: 0.393532
0.1155 --- loss: 1.363052, loss_ss: 0.919205, loss_d: 0.443847
0.1540 --- loss: 1.667869, loss_ss: 1.119070, loss_d: 0.548799
0.1925 --- loss: 1.149507, loss_ss: 0.741773, loss_d: 0.407734
0.2309 --- loss: 1.254179, loss_ss: 0.761714, loss_d: 0.492465
0.2694 --- loss: 1.306931, loss_ss: 0.941052, loss_d: 0.365879
0.3079 --- loss: 1.448591, loss_ss: 0.995066, loss_d: 0.453525
0.3464 --- loss: 1.338634, loss_ss: 0.975653, loss_d: 0.362981
0.3849 --- loss: 1.010849, loss_ss: 0.711036, loss_d: 0.299813
0.4234 --- loss: 1.638077, loss_ss: 1.291469, loss_d: 0.346608
0.4619 --- loss: 1.492893, loss_ss: 1.029945, loss_d: 0.462947
0.5004 --- loss: 1.635100, loss_ss: 0.802931, loss_d: 0.832169
0.5389 --- loss: 1.848994, loss_ss: 0.908017, loss_d: 0.940976
0.5774 --- loss: 1.497917, loss_ss: 1.091517, loss_d: 0.406400
0.6159 --- loss: 1.181446, loss_ss: 0.884608, loss_d: 0.296838
0.6543 --- loss: 1.538022, loss_ss: 1.005075, loss_d: 0.532946
0.6928 --- loss: 1.297874, loss_ss: 0.930652, loss_d: 0.367222
0.7313 --- loss: 1.216674, loss_ss: 0.865353, loss_d: 0.351322
0.7698 --- loss: 1.223517, loss_ss: 1.014970, loss_d: 0.208548
0.8083 --- loss: 1.269262, loss_ss: 0.999305, loss_d: 0.269957
0.8468 --- loss: 1.080940, loss_ss: 0.882910, loss_d: 0.198030
0.8853 --- loss: 2.070041, loss_ss: 0.760512, loss_d: 1.309529
0.9238 --- loss: 1.419606, loss_ss: 0.853118, loss_d: 0.566487
0.9623 --- loss: 1.805086, loss_ss: 1.200394, loss_d: 0.604691
Epoch finished! Loss: 1.4081248693944866
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.436001, loss_ss: 0.790728, loss_d: 0.645274
0.0385 --- loss: 1.112671, loss_ss: 0.881977, loss_d: 0.230694
0.0770 --- loss: 0.978722, loss_ss: 0.780915, loss_d: 0.197807
0.1155 --- loss: 1.304992, loss_ss: 1.030767, loss_d: 0.274224
0.1540 --- loss: 1.387939, loss_ss: 1.080846, loss_d: 0.307093
0.1925 --- loss: 1.490886, loss_ss: 1.150089, loss_d: 0.340797
0.2309 --- loss: 1.288383, loss_ss: 0.690102, loss_d: 0.598281
0.2694 --- loss: 1.670443, loss_ss: 1.012650, loss_d: 0.657792
0.3079 --- loss: 1.416647, loss_ss: 1.080907, loss_d: 0.335741
0.3464 --- loss: 1.882348, loss_ss: 1.014614, loss_d: 0.867734
0.3849 --- loss: 1.251624, loss_ss: 0.887025, loss_d: 0.364599
0.4234 --- loss: 1.127860, loss_ss: 0.853243, loss_d: 0.274617
0.4619 --- loss: 1.431394, loss_ss: 1.023765, loss_d: 0.407629
0.5004 --- loss: 1.101946, loss_ss: 0.858051, loss_d: 0.243895
0.5389 --- loss: 1.008364, loss_ss: 0.808289, loss_d: 0.200075
0.5774 --- loss: 1.114110, loss_ss: 0.651968, loss_d: 0.462141
0.6159 --- loss: 0.992630, loss_ss: 0.825689, loss_d: 0.166941
0.6543 --- loss: 1.289825, loss_ss: 0.903366, loss_d: 0.386459
0.6928 --- loss: 1.287012, loss_ss: 1.004670, loss_d: 0.282342
0.7313 --- loss: 1.255888, loss_ss: 0.828657, loss_d: 0.427230
0.7698 --- loss: 1.279267, loss_ss: 0.839198, loss_d: 0.440069
0.8083 --- loss: 1.276894, loss_ss: 0.878965, loss_d: 0.397929
0.8468 --- loss: 1.474780, loss_ss: 0.832096, loss_d: 0.642683
0.8853 --- loss: 1.321101, loss_ss: 0.904056, loss_d: 0.417045
0.9238 --- loss: 1.597942, loss_ss: 1.220680, loss_d: 0.377262
0.9623 --- loss: 1.072658, loss_ss: 0.670143, loss_d: 0.402515
Epoch finished! Loss: 1.339235201535538
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.172251, loss_ss: 0.822540, loss_d: 0.349711
0.0385 --- loss: 0.974745, loss_ss: 0.632812, loss_d: 0.341933
0.0770 --- loss: 1.402993, loss_ss: 1.002108, loss_d: 0.400885
0.1155 --- loss: 1.072247, loss_ss: 0.622199, loss_d: 0.450048
0.1540 --- loss: 1.319941, loss_ss: 1.026691, loss_d: 0.293251
0.1925 --- loss: 1.134528, loss_ss: 0.970607, loss_d: 0.163921
0.2309 --- loss: 1.775244, loss_ss: 1.314010, loss_d: 0.461234
0.2694 --- loss: 1.197083, loss_ss: 0.843178, loss_d: 0.353905
0.3079 --- loss: 1.114673, loss_ss: 0.788520, loss_d: 0.326153
0.3464 --- loss: 1.537548, loss_ss: 1.081896, loss_d: 0.455652
0.3849 --- loss: 1.355462, loss_ss: 0.942530, loss_d: 0.412932
0.4234 --- loss: 1.087955, loss_ss: 0.782952, loss_d: 0.305003
0.4619 --- loss: 1.204139, loss_ss: 0.713171, loss_d: 0.490968
0.5004 --- loss: 0.965304, loss_ss: 0.754221, loss_d: 0.211084
0.5389 --- loss: 1.672962, loss_ss: 1.106607, loss_d: 0.566355
0.5774 --- loss: 1.547197, loss_ss: 1.181503, loss_d: 0.365694
0.6159 --- loss: 1.733294, loss_ss: 0.917055, loss_d: 0.816239
0.6543 --- loss: 1.470443, loss_ss: 0.649556, loss_d: 0.820887
0.6928 --- loss: 1.251637, loss_ss: 0.845228, loss_d: 0.406409
0.7313 --- loss: 1.381412, loss_ss: 1.093768, loss_d: 0.287643
0.7698 --- loss: 1.841129, loss_ss: 1.365643, loss_d: 0.475485
0.8083 --- loss: 1.102021, loss_ss: 0.927990, loss_d: 0.174031
0.8468 --- loss: 1.824353, loss_ss: 0.732100, loss_d: 1.092253
0.8853 --- loss: 1.174708, loss_ss: 0.922166, loss_d: 0.252542
0.9238 --- loss: 1.174883, loss_ss: 0.914591, loss_d: 0.260291
0.9623 --- loss: 0.877220, loss_ss: 0.607811, loss_d: 0.269409
Epoch finished! Loss: 1.28128284515101
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.833437, loss_ss: 0.662332, loss_d: 0.171105
0.0385 --- loss: 1.286810, loss_ss: 0.793809, loss_d: 0.493001
0.0770 --- loss: 1.311666, loss_ss: 0.892435, loss_d: 0.419231
0.1155 --- loss: 1.001588, loss_ss: 0.764284, loss_d: 0.237304
0.1540 --- loss: 1.206458, loss_ss: 1.037193, loss_d: 0.169266
0.1925 --- loss: 1.181731, loss_ss: 0.842213, loss_d: 0.339517
0.2309 --- loss: 1.363466, loss_ss: 0.847293, loss_d: 0.516172
0.2694 --- loss: 0.893878, loss_ss: 0.698471, loss_d: 0.195407
0.3079 --- loss: 0.787085, loss_ss: 0.644355, loss_d: 0.142731
0.3464 --- loss: 0.871826, loss_ss: 0.736314, loss_d: 0.135512
0.3849 --- loss: 1.260582, loss_ss: 0.875395, loss_d: 0.385187
0.4234 --- loss: 1.522358, loss_ss: 0.996074, loss_d: 0.526285
0.4619 --- loss: 1.008012, loss_ss: 0.700167, loss_d: 0.307844
0.5004 --- loss: 1.249669, loss_ss: 0.820642, loss_d: 0.429027
0.5389 --- loss: 1.203115, loss_ss: 0.953592, loss_d: 0.249523
0.5774 --- loss: 0.890948, loss_ss: 0.741738, loss_d: 0.149210
0.6159 --- loss: 1.673544, loss_ss: 0.755525, loss_d: 0.918019
0.6543 --- loss: 0.953697, loss_ss: 0.681421, loss_d: 0.272276
0.6928 --- loss: 0.921064, loss_ss: 0.575303, loss_d: 0.345761
0.7313 --- loss: 0.884903, loss_ss: 0.660269, loss_d: 0.224634
0.7698 --- loss: 1.260940, loss_ss: 1.108379, loss_d: 0.152561
0.8083 --- loss: 1.369179, loss_ss: 0.738765, loss_d: 0.630414
0.8468 --- loss: 1.271462, loss_ss: 1.026844, loss_d: 0.244619
0.8853 --- loss: 0.912425, loss_ss: 0.792980, loss_d: 0.119445
0.9238 --- loss: 0.908434, loss_ss: 0.670327, loss_d: 0.238106
0.9623 --- loss: 0.954688, loss_ss: 0.721288, loss_d: 0.233399
Epoch finished! Loss: 1.238745213245333
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.187181, loss_ss: 0.993663, loss_d: 0.193519
0.0385 --- loss: 1.397562, loss_ss: 0.848690, loss_d: 0.548872
0.0770 --- loss: 1.022389, loss_ss: 0.820234, loss_d: 0.202155
0.1155 --- loss: 1.710307, loss_ss: 0.982231, loss_d: 0.728077
0.1540 --- loss: 1.301050, loss_ss: 1.130519, loss_d: 0.170532
0.1925 --- loss: 0.735485, loss_ss: 0.554550, loss_d: 0.180936
0.2309 --- loss: 1.444662, loss_ss: 1.169448, loss_d: 0.275214
0.2694 --- loss: 0.971253, loss_ss: 0.776766, loss_d: 0.194486
0.3079 --- loss: 1.503767, loss_ss: 0.708638, loss_d: 0.795129
0.3464 --- loss: 1.063117, loss_ss: 0.772148, loss_d: 0.290969
0.3849 --- loss: 1.196763, loss_ss: 1.036267, loss_d: 0.160497
0.4234 --- loss: 0.809403, loss_ss: 0.554241, loss_d: 0.255162
0.4619 --- loss: 1.623637, loss_ss: 1.154154, loss_d: 0.469483
0.5004 --- loss: 1.257582, loss_ss: 0.795449, loss_d: 0.462133
0.5389 --- loss: 0.819933, loss_ss: 0.705465, loss_d: 0.114468
0.5774 --- loss: 1.325495, loss_ss: 1.155164, loss_d: 0.170331
0.6159 --- loss: 1.155491, loss_ss: 0.900121, loss_d: 0.255370
0.6543 --- loss: 0.981126, loss_ss: 0.869100, loss_d: 0.112026
0.6928 --- loss: 1.755517, loss_ss: 0.623575, loss_d: 1.131942
0.7313 --- loss: 1.944845, loss_ss: 0.921001, loss_d: 1.023844
0.7698 --- loss: 1.028688, loss_ss: 0.704804, loss_d: 0.323883
0.8083 --- loss: 1.175182, loss_ss: 1.009779, loss_d: 0.165403
0.8468 --- loss: 1.274951, loss_ss: 0.673033, loss_d: 0.601918
0.8853 --- loss: 0.990638, loss_ss: 0.718279, loss_d: 0.272359
0.9238 --- loss: 1.047849, loss_ss: 0.904899, loss_d: 0.142951
0.9623 --- loss: 1.125211, loss_ss: 1.010650, loss_d: 0.114561
Epoch finished! Loss: 1.212057280034172
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.130313, loss_ss: 0.756360, loss_d: 0.373953
0.0385 --- loss: 1.143679, loss_ss: 0.757009, loss_d: 0.386670
0.0770 --- loss: 0.674187, loss_ss: 0.532045, loss_d: 0.142142
0.1155 --- loss: 1.463212, loss_ss: 0.972201, loss_d: 0.491011
0.1540 --- loss: 0.923076, loss_ss: 0.677108, loss_d: 0.245968
0.1925 --- loss: 1.569985, loss_ss: 1.226797, loss_d: 0.343188
0.2309 --- loss: 0.970896, loss_ss: 0.830383, loss_d: 0.140513
0.2694 --- loss: 0.862020, loss_ss: 0.712373, loss_d: 0.149647
0.3079 --- loss: 1.121547, loss_ss: 0.945681, loss_d: 0.175866
0.3464 --- loss: 0.939824, loss_ss: 0.718128, loss_d: 0.221696
0.3849 --- loss: 1.278322, loss_ss: 0.940399, loss_d: 0.337924
0.4234 --- loss: 0.713223, loss_ss: 0.467943, loss_d: 0.245281
0.4619 --- loss: 1.015306, loss_ss: 0.777920, loss_d: 0.237385
0.5004 --- loss: 1.404970, loss_ss: 0.883516, loss_d: 0.521454
0.5389 --- loss: 1.341254, loss_ss: 1.126699, loss_d: 0.214555
0.5774 --- loss: 1.573286, loss_ss: 0.649470, loss_d: 0.923816
0.6159 --- loss: 1.702956, loss_ss: 1.175094, loss_d: 0.527862
0.6543 --- loss: 1.323843, loss_ss: 0.873548, loss_d: 0.450295
0.6928 --- loss: 1.534855, loss_ss: 0.650414, loss_d: 0.884440
0.7313 --- loss: 1.085864, loss_ss: 0.928517, loss_d: 0.157347
0.7698 --- loss: 1.404470, loss_ss: 0.972463, loss_d: 0.432007
0.8083 --- loss: 1.098626, loss_ss: 0.934378, loss_d: 0.164248
0.8468 --- loss: 1.698701, loss_ss: 1.183303, loss_d: 0.515398
0.8853 --- loss: 1.007482, loss_ss: 0.876722, loss_d: 0.130761
0.9238 --- loss: 0.993351, loss_ss: 0.656133, loss_d: 0.337217
0.9623 --- loss: 1.042917, loss_ss: 0.818886, loss_d: 0.224030
Epoch finished! Loss: 1.1698852108942497
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4178482068390325
             precision    recall  f1-score   support

        0.0       0.82      0.46      0.59       350
        1.0       0.50      0.09      0.16       204
        2.0       0.53      0.45      0.49       346
        3.0       1.00      0.26      0.41       179
        4.0       0.19      1.00      0.32       120

avg / total       0.65      0.42      0.43      1199
 


====== chp030-nsrr ======
   acc %   sen %  spec %   ppr %  f1-score
0  81.32   45.71   96.00   82.47     58.82
1  82.99    9.31   98.09   50.00     15.70
2  72.39   45.09   83.47   52.53     48.52
3  88.91   25.70  100.00  100.00     40.89
4  57.96  100.00   53.29   19.23     32.26
Total accuracy: 41.78%
Average sen: 45.16%
Average spec: 86.17%
Macro f1-score: 39.24%
Diagnosis acc on 15mins: 1.0
[0.94708455 0.79865527 0.99353254 0.59410298 0.95824534 0.97510934
 0.98730499 0.98015255 0.99927443 0.95890224 0.95111877 0.79547966
 0.56087482 0.89108449 0.9979862  0.87186491 0.6780957  0.95285666
 0.90743423 0.99919897 0.97091424 0.94903922 0.98117781 0.95311856
 0.93033153 0.90606058 0.99868172 0.96481878 0.97776049 0.99949956
 0.95230347 0.7066651  0.74764359 0.98902613 0.97286195 0.76281315
 0.62174255 0.92930752 0.93939114 0.98016012]
pred: 0.9007918953895568, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp031-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.611079, loss_ss: 1.941789, loss_d: 0.669290
0.0384 --- loss: 2.283307, loss_ss: 1.817895, loss_d: 0.465412
0.0769 --- loss: 2.284127, loss_ss: 1.577558, loss_d: 0.706569
0.1153 --- loss: 2.253531, loss_ss: 1.562537, loss_d: 0.690994
0.1538 --- loss: 2.635629, loss_ss: 1.991215, loss_d: 0.644414
0.1922 --- loss: 2.034037, loss_ss: 1.557771, loss_d: 0.476266
0.2307 --- loss: 1.955592, loss_ss: 1.340131, loss_d: 0.615461
0.2691 --- loss: 2.494926, loss_ss: 1.747348, loss_d: 0.747578
0.3076 --- loss: 2.021255, loss_ss: 1.460407, loss_d: 0.560849
0.3460 --- loss: 2.092501, loss_ss: 1.590950, loss_d: 0.501551
0.3845 --- loss: 1.896339, loss_ss: 1.343825, loss_d: 0.552515
0.4229 --- loss: 2.019489, loss_ss: 1.649325, loss_d: 0.370164
0.4614 --- loss: 2.003678, loss_ss: 1.396410, loss_d: 0.607268
0.4998 --- loss: 1.860301, loss_ss: 1.328929, loss_d: 0.531372
0.5383 --- loss: 2.008181, loss_ss: 1.412624, loss_d: 0.595557
0.5767 --- loss: 2.074700, loss_ss: 1.353705, loss_d: 0.720996
0.6151 --- loss: 2.059751, loss_ss: 1.404992, loss_d: 0.654759
0.6536 --- loss: 2.140317, loss_ss: 1.472237, loss_d: 0.668080
0.6920 --- loss: 2.268825, loss_ss: 1.339058, loss_d: 0.929767
0.7305 --- loss: 2.007615, loss_ss: 1.399986, loss_d: 0.607629
0.7689 --- loss: 2.048625, loss_ss: 1.388693, loss_d: 0.659931
0.8074 --- loss: 2.105122, loss_ss: 1.627868, loss_d: 0.477254
0.8458 --- loss: 2.094743, loss_ss: 1.479798, loss_d: 0.614946
0.8843 --- loss: 1.838445, loss_ss: 1.394748, loss_d: 0.443697
0.9227 --- loss: 2.213175, loss_ss: 1.463117, loss_d: 0.750058
0.9612 --- loss: 1.917026, loss_ss: 1.425944, loss_d: 0.491082
0.9996 --- loss: 2.034745, loss_ss: 1.623270, loss_d: 0.411476
Epoch finished! Loss: 2.072171129171665
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.853331, loss_ss: 1.218352, loss_d: 0.634979
0.0384 --- loss: 1.694368, loss_ss: 1.101843, loss_d: 0.592526
0.0769 --- loss: 1.726985, loss_ss: 1.156708, loss_d: 0.570276
0.1153 --- loss: 1.426811, loss_ss: 1.126389, loss_d: 0.300422
0.1538 --- loss: 1.907646, loss_ss: 1.169748, loss_d: 0.737899
0.1922 --- loss: 1.543731, loss_ss: 1.240112, loss_d: 0.303619
0.2307 --- loss: 1.569667, loss_ss: 1.067894, loss_d: 0.501773
0.2691 --- loss: 1.926282, loss_ss: 1.483182, loss_d: 0.443100
0.3076 --- loss: 1.646678, loss_ss: 1.135428, loss_d: 0.511250
0.3460 --- loss: 1.877803, loss_ss: 1.208005, loss_d: 0.669799
0.3845 --- loss: 1.878675, loss_ss: 1.165124, loss_d: 0.713552
0.4229 --- loss: 1.763020, loss_ss: 1.243942, loss_d: 0.519078
0.4614 --- loss: 1.669817, loss_ss: 1.075701, loss_d: 0.594115
0.4998 --- loss: 1.827197, loss_ss: 1.088685, loss_d: 0.738512
0.5383 --- loss: 1.650086, loss_ss: 1.154298, loss_d: 0.495788
0.5767 --- loss: 1.753848, loss_ss: 1.198901, loss_d: 0.554947
0.6151 --- loss: 1.747390, loss_ss: 1.042836, loss_d: 0.704554
0.6536 --- loss: 1.844908, loss_ss: 1.206591, loss_d: 0.638317
0.6920 --- loss: 1.803437, loss_ss: 1.127076, loss_d: 0.676360
0.7305 --- loss: 1.684092, loss_ss: 1.216046, loss_d: 0.468046
0.7689 --- loss: 1.476486, loss_ss: 1.111950, loss_d: 0.364536
0.8074 --- loss: 1.680198, loss_ss: 1.155730, loss_d: 0.524469
0.8458 --- loss: 1.863395, loss_ss: 1.067344, loss_d: 0.796051
0.8843 --- loss: 1.642926, loss_ss: 1.052617, loss_d: 0.590308
0.9227 --- loss: 1.465502, loss_ss: 1.058761, loss_d: 0.406741
0.9612 --- loss: 1.683595, loss_ss: 1.240541, loss_d: 0.443053
0.9996 --- loss: 1.615831, loss_ss: 1.382030, loss_d: 0.233802
Epoch finished! Loss: 1.7423147815924425
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.410531, loss_ss: 1.149205, loss_d: 0.261326
0.0384 --- loss: 1.666806, loss_ss: 1.178138, loss_d: 0.488668
0.0769 --- loss: 1.390511, loss_ss: 0.887010, loss_d: 0.503502
0.1153 --- loss: 1.568022, loss_ss: 0.878403, loss_d: 0.689620
0.1538 --- loss: 1.656336, loss_ss: 0.897344, loss_d: 0.758992
0.1922 --- loss: 1.983230, loss_ss: 1.304044, loss_d: 0.679186
0.2307 --- loss: 1.311793, loss_ss: 0.974098, loss_d: 0.337695
0.2691 --- loss: 1.848297, loss_ss: 1.503961, loss_d: 0.344336
0.3076 --- loss: 2.160313, loss_ss: 1.357698, loss_d: 0.802615
0.3460 --- loss: 1.630964, loss_ss: 1.128748, loss_d: 0.502216
0.3845 --- loss: 1.680667, loss_ss: 1.092661, loss_d: 0.588006
0.4229 --- loss: 1.749101, loss_ss: 0.968810, loss_d: 0.780290
0.4614 --- loss: 1.470367, loss_ss: 0.893675, loss_d: 0.576692
0.4998 --- loss: 1.491815, loss_ss: 0.828096, loss_d: 0.663719
0.5383 --- loss: 1.708974, loss_ss: 1.182280, loss_d: 0.526694
0.5767 --- loss: 1.416080, loss_ss: 1.027843, loss_d: 0.388238
0.6151 --- loss: 1.847122, loss_ss: 1.067624, loss_d: 0.779498
0.6536 --- loss: 1.303646, loss_ss: 0.968947, loss_d: 0.334699
0.6920 --- loss: 1.453723, loss_ss: 1.039040, loss_d: 0.414684
0.7305 --- loss: 1.584226, loss_ss: 0.922409, loss_d: 0.661817
0.7689 --- loss: 2.043817, loss_ss: 1.499824, loss_d: 0.543993
0.8074 --- loss: 1.638391, loss_ss: 1.168446, loss_d: 0.469946
0.8458 --- loss: 1.524059, loss_ss: 0.987724, loss_d: 0.536335
0.8843 --- loss: 1.705329, loss_ss: 1.111196, loss_d: 0.594132
0.9227 --- loss: 1.426819, loss_ss: 0.888271, loss_d: 0.538548
0.9612 --- loss: 1.699620, loss_ss: 1.217382, loss_d: 0.482238
0.9996 --- loss: 2.123643, loss_ss: 0.789258, loss_d: 1.334385
Epoch finished! Loss: 1.6224751903460577
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.540562, loss_ss: 1.114648, loss_d: 0.425914
0.0384 --- loss: 1.647919, loss_ss: 1.044072, loss_d: 0.603847
0.0769 --- loss: 1.481844, loss_ss: 0.956140, loss_d: 0.525704
0.1153 --- loss: 1.903256, loss_ss: 1.060853, loss_d: 0.842403
0.1538 --- loss: 1.746670, loss_ss: 1.247997, loss_d: 0.498673
0.1922 --- loss: 1.525796, loss_ss: 1.034626, loss_d: 0.491170
0.2307 --- loss: 1.568316, loss_ss: 0.938488, loss_d: 0.629828
0.2691 --- loss: 1.611418, loss_ss: 1.062320, loss_d: 0.549098
0.3076 --- loss: 1.318363, loss_ss: 0.990928, loss_d: 0.327435
0.3460 --- loss: 1.526193, loss_ss: 0.883719, loss_d: 0.642475
0.3845 --- loss: 1.378333, loss_ss: 0.954648, loss_d: 0.423685
0.4229 --- loss: 1.391392, loss_ss: 0.932971, loss_d: 0.458421
0.4614 --- loss: 1.362529, loss_ss: 0.927996, loss_d: 0.434532
0.4998 --- loss: 1.753762, loss_ss: 1.123095, loss_d: 0.630668
0.5383 --- loss: 1.342411, loss_ss: 0.973608, loss_d: 0.368803
0.5767 --- loss: 1.871205, loss_ss: 1.285416, loss_d: 0.585789
0.6151 --- loss: 1.346943, loss_ss: 0.927893, loss_d: 0.419050
0.6536 --- loss: 1.512576, loss_ss: 0.955015, loss_d: 0.557561
0.6920 --- loss: 1.363514, loss_ss: 1.060997, loss_d: 0.302517
0.7305 --- loss: 1.489209, loss_ss: 0.967583, loss_d: 0.521627
0.7689 --- loss: 1.325299, loss_ss: 1.004738, loss_d: 0.320561
0.8074 --- loss: 1.177514, loss_ss: 0.860122, loss_d: 0.317392
0.8458 --- loss: 1.741738, loss_ss: 1.347836, loss_d: 0.393903
0.8843 --- loss: 1.248342, loss_ss: 0.954676, loss_d: 0.293666
0.9227 --- loss: 1.479441, loss_ss: 1.074607, loss_d: 0.404834
0.9612 --- loss: 1.348887, loss_ss: 0.785574, loss_d: 0.563313
0.9996 --- loss: 2.754519, loss_ss: 1.012015, loss_d: 1.742504
Epoch finished! Loss: 1.5223277461070281
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.493097, loss_ss: 0.967493, loss_d: 0.525604
0.0384 --- loss: 1.349487, loss_ss: 0.900916, loss_d: 0.448571
0.0769 --- loss: 1.464923, loss_ss: 0.894746, loss_d: 0.570177
0.1153 --- loss: 1.377012, loss_ss: 1.031379, loss_d: 0.345634
0.1538 --- loss: 1.820099, loss_ss: 1.232425, loss_d: 0.587674
0.1922 --- loss: 1.410863, loss_ss: 0.926228, loss_d: 0.484635
0.2307 --- loss: 1.067546, loss_ss: 0.798357, loss_d: 0.269188
0.2691 --- loss: 1.310603, loss_ss: 0.812633, loss_d: 0.497970
0.3076 --- loss: 1.157185, loss_ss: 0.655578, loss_d: 0.501608
0.3460 --- loss: 1.388373, loss_ss: 1.126140, loss_d: 0.262233
0.3845 --- loss: 1.087593, loss_ss: 0.781548, loss_d: 0.306045
0.4229 --- loss: 1.466489, loss_ss: 1.173159, loss_d: 0.293330
0.4614 --- loss: 1.102541, loss_ss: 0.602425, loss_d: 0.500117
0.4998 --- loss: 1.439332, loss_ss: 0.943858, loss_d: 0.495474
0.5383 --- loss: 1.259542, loss_ss: 0.719172, loss_d: 0.540371
0.5767 --- loss: 1.474274, loss_ss: 1.116207, loss_d: 0.358067
0.6151 --- loss: 1.205057, loss_ss: 0.672417, loss_d: 0.532640
0.6536 --- loss: 1.431573, loss_ss: 0.890280, loss_d: 0.541293
0.6920 --- loss: 1.174977, loss_ss: 0.899471, loss_d: 0.275506
0.7305 --- loss: 1.609391, loss_ss: 1.059584, loss_d: 0.549807
0.7689 --- loss: 1.129297, loss_ss: 0.817305, loss_d: 0.311992
0.8074 --- loss: 1.337888, loss_ss: 0.954726, loss_d: 0.383162
0.8458 --- loss: 1.708999, loss_ss: 0.878370, loss_d: 0.830629
0.8843 --- loss: 1.441898, loss_ss: 0.920669, loss_d: 0.521229
0.9227 --- loss: 1.478144, loss_ss: 0.825036, loss_d: 0.653108
0.9612 --- loss: 1.526793, loss_ss: 1.099395, loss_d: 0.427398
0.9996 --- loss: 2.261908, loss_ss: 2.002579, loss_d: 0.259328
Epoch finished! Loss: 1.4664142260184654
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.501931, loss_ss: 1.035672, loss_d: 0.466259
0.0384 --- loss: 1.347902, loss_ss: 0.874980, loss_d: 0.472922
0.0769 --- loss: 1.511982, loss_ss: 1.250748, loss_d: 0.261235
0.1153 --- loss: 1.675117, loss_ss: 1.398239, loss_d: 0.276878
0.1538 --- loss: 1.076229, loss_ss: 0.818593, loss_d: 0.257637
0.1922 --- loss: 1.033680, loss_ss: 0.636583, loss_d: 0.397097
0.2307 --- loss: 1.655551, loss_ss: 1.125421, loss_d: 0.530130
0.2691 --- loss: 1.157885, loss_ss: 0.898559, loss_d: 0.259326
0.3076 --- loss: 1.384999, loss_ss: 1.047484, loss_d: 0.337514
0.3460 --- loss: 1.051680, loss_ss: 0.659910, loss_d: 0.391770
0.3845 --- loss: 1.160405, loss_ss: 0.651519, loss_d: 0.508886
0.4229 --- loss: 1.565111, loss_ss: 1.176954, loss_d: 0.388157
0.4614 --- loss: 1.446918, loss_ss: 0.954728, loss_d: 0.492190
0.4998 --- loss: 1.861286, loss_ss: 0.929724, loss_d: 0.931562
0.5383 --- loss: 1.373919, loss_ss: 0.741946, loss_d: 0.631973
0.5767 --- loss: 1.438663, loss_ss: 0.974022, loss_d: 0.464640
0.6151 --- loss: 1.200672, loss_ss: 0.665617, loss_d: 0.535055
0.6536 --- loss: 1.043902, loss_ss: 0.733705, loss_d: 0.310197
0.6920 --- loss: 1.422673, loss_ss: 0.816359, loss_d: 0.606314
0.7305 --- loss: 1.405285, loss_ss: 0.711948, loss_d: 0.693336
0.7689 --- loss: 1.256907, loss_ss: 1.068075, loss_d: 0.188832
0.8074 --- loss: 1.317996, loss_ss: 0.883728, loss_d: 0.434268
0.8458 --- loss: 1.889439, loss_ss: 0.868327, loss_d: 1.021112
0.8843 --- loss: 1.119293, loss_ss: 0.869122, loss_d: 0.250171
0.9227 --- loss: 1.163840, loss_ss: 0.925231, loss_d: 0.238609
0.9612 --- loss: 1.429187, loss_ss: 1.207860, loss_d: 0.221327
0.9996 --- loss: 4.492175, loss_ss: 2.344737, loss_d: 2.147438
Epoch finished! Loss: 1.3690368285545935
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.136091, loss_ss: 0.929861, loss_d: 0.206230
0.0384 --- loss: 1.444484, loss_ss: 1.075500, loss_d: 0.368984
0.0769 --- loss: 1.377090, loss_ss: 1.129064, loss_d: 0.248026
0.1153 --- loss: 1.263517, loss_ss: 0.742639, loss_d: 0.520878
0.1538 --- loss: 1.190044, loss_ss: 0.911310, loss_d: 0.278734
0.1922 --- loss: 1.156657, loss_ss: 0.948708, loss_d: 0.207949
0.2307 --- loss: 1.421338, loss_ss: 1.122988, loss_d: 0.298350
0.2691 --- loss: 0.919379, loss_ss: 0.624647, loss_d: 0.294731
0.3076 --- loss: 1.119452, loss_ss: 0.908002, loss_d: 0.211450
0.3460 --- loss: 1.406678, loss_ss: 0.718022, loss_d: 0.688656
0.3845 --- loss: 1.601107, loss_ss: 1.001940, loss_d: 0.599168
0.4229 --- loss: 1.439113, loss_ss: 1.061267, loss_d: 0.377846
0.4614 --- loss: 1.239369, loss_ss: 0.949335, loss_d: 0.290034
0.4998 --- loss: 1.695037, loss_ss: 0.847738, loss_d: 0.847300
0.5383 --- loss: 1.320456, loss_ss: 1.087428, loss_d: 0.233028
0.5767 --- loss: 1.308591, loss_ss: 0.858821, loss_d: 0.449770
0.6151 --- loss: 1.500487, loss_ss: 1.053011, loss_d: 0.447476
0.6536 --- loss: 1.230517, loss_ss: 0.945086, loss_d: 0.285430
0.6920 --- loss: 1.140090, loss_ss: 0.749021, loss_d: 0.391068
0.7305 --- loss: 1.293196, loss_ss: 1.057535, loss_d: 0.235661
0.7689 --- loss: 0.922242, loss_ss: 0.670756, loss_d: 0.251486
0.8074 --- loss: 0.741297, loss_ss: 0.553947, loss_d: 0.187350
0.8458 --- loss: 1.106199, loss_ss: 1.006538, loss_d: 0.099660
0.8843 --- loss: 1.155165, loss_ss: 0.781003, loss_d: 0.374162
0.9227 --- loss: 1.266691, loss_ss: 0.995634, loss_d: 0.271057
0.9612 --- loss: 1.192974, loss_ss: 0.944921, loss_d: 0.248053
0.9996 --- loss: 2.795725, loss_ss: 2.573115, loss_d: 0.222609
Epoch finished! Loss: 1.311379581460586
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.091325, loss_ss: 0.929529, loss_d: 0.161796
0.0384 --- loss: 1.241631, loss_ss: 0.950082, loss_d: 0.291549
0.0769 --- loss: 1.299422, loss_ss: 0.904193, loss_d: 0.395228
0.1153 --- loss: 0.989724, loss_ss: 0.810091, loss_d: 0.179633
0.1538 --- loss: 1.241279, loss_ss: 0.848790, loss_d: 0.392488
0.1922 --- loss: 1.455701, loss_ss: 1.063928, loss_d: 0.391773
0.2307 --- loss: 1.195390, loss_ss: 0.845284, loss_d: 0.350106
0.2691 --- loss: 1.137236, loss_ss: 0.707330, loss_d: 0.429907
0.3076 --- loss: 1.431405, loss_ss: 0.984658, loss_d: 0.446747
0.3460 --- loss: 1.551820, loss_ss: 0.933381, loss_d: 0.618439
0.3845 --- loss: 1.166102, loss_ss: 0.930680, loss_d: 0.235422
0.4229 --- loss: 1.924796, loss_ss: 1.132065, loss_d: 0.792732
0.4614 --- loss: 0.797955, loss_ss: 0.646223, loss_d: 0.151732
0.4998 --- loss: 1.652841, loss_ss: 1.064297, loss_d: 0.588544
0.5383 --- loss: 0.846497, loss_ss: 0.646369, loss_d: 0.200128
0.5767 --- loss: 0.918289, loss_ss: 0.785204, loss_d: 0.133085
0.6151 --- loss: 1.232276, loss_ss: 0.911690, loss_d: 0.320587
0.6536 --- loss: 1.255961, loss_ss: 0.851569, loss_d: 0.404392
0.6920 --- loss: 1.174991, loss_ss: 0.740174, loss_d: 0.434817
0.7305 --- loss: 1.283503, loss_ss: 0.818913, loss_d: 0.464591
0.7689 --- loss: 1.069199, loss_ss: 0.847938, loss_d: 0.221261
0.8074 --- loss: 1.304093, loss_ss: 0.703770, loss_d: 0.600324
0.8458 --- loss: 1.135902, loss_ss: 0.857310, loss_d: 0.278591
0.8843 --- loss: 0.892157, loss_ss: 0.707968, loss_d: 0.184189
0.9227 --- loss: 1.367642, loss_ss: 0.871453, loss_d: 0.496188
0.9612 --- loss: 0.810211, loss_ss: 0.635753, loss_d: 0.174458
0.9996 --- loss: 4.163883, loss_ss: 0.962076, loss_d: 3.201807
Epoch finished! Loss: 1.2676017946921863
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.193583, loss_ss: 0.910939, loss_d: 0.282645
0.0384 --- loss: 0.928180, loss_ss: 0.738549, loss_d: 0.189631
0.0769 --- loss: 1.057637, loss_ss: 0.858739, loss_d: 0.198898
0.1153 --- loss: 1.795823, loss_ss: 1.022241, loss_d: 0.773582
0.1538 --- loss: 1.203154, loss_ss: 0.824516, loss_d: 0.378638
0.1922 --- loss: 1.497836, loss_ss: 1.001637, loss_d: 0.496199
0.2307 --- loss: 1.020197, loss_ss: 0.827976, loss_d: 0.192221
0.2691 --- loss: 1.009272, loss_ss: 0.805485, loss_d: 0.203787
0.3076 --- loss: 0.948323, loss_ss: 0.807563, loss_d: 0.140760
0.3460 --- loss: 0.892825, loss_ss: 0.633467, loss_d: 0.259358
0.3845 --- loss: 1.191587, loss_ss: 1.037705, loss_d: 0.153883
0.4229 --- loss: 1.237448, loss_ss: 0.993296, loss_d: 0.244152
0.4614 --- loss: 1.258692, loss_ss: 0.750846, loss_d: 0.507846
0.4998 --- loss: 1.055590, loss_ss: 0.836880, loss_d: 0.218710
0.5383 --- loss: 0.891915, loss_ss: 0.762916, loss_d: 0.128999
0.5767 --- loss: 1.395445, loss_ss: 1.015254, loss_d: 0.380190
0.6151 --- loss: 1.093904, loss_ss: 0.624304, loss_d: 0.469601
0.6536 --- loss: 1.087482, loss_ss: 0.805813, loss_d: 0.281669
0.6920 --- loss: 1.147108, loss_ss: 0.873160, loss_d: 0.273948
0.7305 --- loss: 1.302385, loss_ss: 1.023961, loss_d: 0.278425
0.7689 --- loss: 1.805018, loss_ss: 1.046500, loss_d: 0.758518
0.8074 --- loss: 1.387742, loss_ss: 1.099780, loss_d: 0.287962
0.8458 --- loss: 0.945601, loss_ss: 0.753445, loss_d: 0.192156
0.8843 --- loss: 1.117139, loss_ss: 0.943466, loss_d: 0.173674
0.9227 --- loss: 1.292196, loss_ss: 0.981935, loss_d: 0.310261
0.9612 --- loss: 1.327677, loss_ss: 1.184196, loss_d: 0.143482
0.9996 --- loss: 2.878003, loss_ss: 2.787411, loss_d: 0.090592
Epoch finished! Loss: 1.227954707466639
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.131541, loss_ss: 0.858328, loss_d: 0.273213
0.0384 --- loss: 0.971163, loss_ss: 0.774156, loss_d: 0.197007
0.0769 --- loss: 1.108508, loss_ss: 0.887951, loss_d: 0.220558
0.1153 --- loss: 1.757372, loss_ss: 1.258387, loss_d: 0.498985
0.1538 --- loss: 1.329066, loss_ss: 0.952433, loss_d: 0.376633
0.1922 --- loss: 1.650479, loss_ss: 1.363905, loss_d: 0.286574
0.2307 --- loss: 0.933709, loss_ss: 0.764881, loss_d: 0.168828
0.2691 --- loss: 0.738541, loss_ss: 0.633782, loss_d: 0.104759
0.3076 --- loss: 0.993041, loss_ss: 0.758524, loss_d: 0.234517
0.3460 --- loss: 1.839270, loss_ss: 0.981264, loss_d: 0.858006
0.3845 --- loss: 1.528202, loss_ss: 1.280944, loss_d: 0.247258
0.4229 --- loss: 1.353380, loss_ss: 1.035789, loss_d: 0.317590
0.4614 --- loss: 1.167052, loss_ss: 0.918833, loss_d: 0.248219
0.4998 --- loss: 1.061406, loss_ss: 0.811781, loss_d: 0.249624
0.5383 --- loss: 1.116186, loss_ss: 0.682471, loss_d: 0.433715
0.5767 --- loss: 0.908068, loss_ss: 0.697900, loss_d: 0.210168
0.6151 --- loss: 0.966115, loss_ss: 0.737436, loss_d: 0.228679
0.6536 --- loss: 0.870885, loss_ss: 0.616685, loss_d: 0.254200
0.6920 --- loss: 1.727874, loss_ss: 1.089115, loss_d: 0.638759
0.7305 --- loss: 1.080172, loss_ss: 0.863525, loss_d: 0.216648
0.7689 --- loss: 1.371035, loss_ss: 1.134060, loss_d: 0.236975
0.8074 --- loss: 1.072011, loss_ss: 0.760988, loss_d: 0.311023
0.8458 --- loss: 0.956046, loss_ss: 0.671387, loss_d: 0.284659
0.8843 --- loss: 1.150767, loss_ss: 0.980917, loss_d: 0.169849
0.9227 --- loss: 0.807457, loss_ss: 0.657438, loss_d: 0.150019
0.9612 --- loss: 1.990171, loss_ss: 0.662280, loss_d: 1.327891
0.9996 --- loss: 3.798952, loss_ss: 1.322901, loss_d: 2.476052
Epoch finished! Loss: 1.1942279694172053
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.590990990990991
             precision    recall  f1-score   support

        0.0       0.21      0.53      0.31        51
        1.0       0.00      0.00      0.00        48
        2.0       0.47      0.87      0.61       309
        3.0       0.83      0.90      0.86       229
        4.0       0.97      0.33      0.49       473

avg / total       0.73      0.59      0.57      1110
 


====== chp031-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  88.92  52.94   90.65  21.43     30.51
1  95.68   0.00  100.00   0.00      0.00
2  68.65  87.06   61.55  46.62     60.72
3  94.05  89.96   95.12  82.73     86.19
4  70.90  32.56   99.37  97.47     48.81
Total accuracy: 59.10%
Average sen: 52.50%
Average spec: 89.34%
Macro f1-score: 45.25%
Diagnosis acc on 15mins: 0.1891891891891892
[0.3168031  0.2322105  0.15607603 0.15924603 0.1864325  0.166053
 0.15843338 0.12822866 0.05318799 0.65441716 0.46867862 0.20301977
 0.57980263 0.66372532 0.66590625 0.75991863 0.40157923 0.2965858
 0.19437645 0.10098255 0.19670561 0.32664442 0.13754533 0.67925942
 0.36421466 0.11846405 0.07843164 0.28316763 0.49454331 0.10572108
 0.18597928 0.29851443 0.09625529 0.0932304  0.60399348 0.33970168
 0.23660551]
pred: 0.30228758965795105, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp032-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.377141, loss_ss: 1.672874, loss_d: 0.704267
0.0384 --- loss: 1.969459, loss_ss: 1.360883, loss_d: 0.608576
0.0768 --- loss: 1.634205, loss_ss: 1.408282, loss_d: 0.225923
0.1153 --- loss: 2.066735, loss_ss: 1.562001, loss_d: 0.504733
0.1537 --- loss: 2.143682, loss_ss: 1.290296, loss_d: 0.853386
0.1921 --- loss: 2.000352, loss_ss: 1.641068, loss_d: 0.359284
0.2305 --- loss: 1.843854, loss_ss: 1.380359, loss_d: 0.463495
0.2689 --- loss: 2.123325, loss_ss: 1.379335, loss_d: 0.743989
0.3073 --- loss: 1.832570, loss_ss: 1.339028, loss_d: 0.493542
0.3458 --- loss: 1.822710, loss_ss: 1.224510, loss_d: 0.598200
0.3842 --- loss: 1.957711, loss_ss: 1.438127, loss_d: 0.519584
0.4226 --- loss: 2.273184, loss_ss: 1.695271, loss_d: 0.577913
0.4610 --- loss: 1.683999, loss_ss: 1.226144, loss_d: 0.457855
0.4994 --- loss: 1.930510, loss_ss: 1.344356, loss_d: 0.586154
0.5378 --- loss: 1.837888, loss_ss: 1.449561, loss_d: 0.388327
0.5763 --- loss: 1.938101, loss_ss: 1.313082, loss_d: 0.625019
0.6147 --- loss: 1.816741, loss_ss: 1.224508, loss_d: 0.592232
0.6531 --- loss: 1.739961, loss_ss: 1.243946, loss_d: 0.496016
0.6915 --- loss: 1.821557, loss_ss: 1.322724, loss_d: 0.498833
0.7299 --- loss: 1.907707, loss_ss: 1.335488, loss_d: 0.572219
0.7683 --- loss: 2.003132, loss_ss: 1.270978, loss_d: 0.732154
0.8068 --- loss: 1.982359, loss_ss: 1.259981, loss_d: 0.722378
0.8452 --- loss: 1.536854, loss_ss: 1.089608, loss_d: 0.447246
0.8836 --- loss: 1.594916, loss_ss: 1.115013, loss_d: 0.479903
0.9220 --- loss: 2.178600, loss_ss: 1.591590, loss_d: 0.587010
0.9604 --- loss: 1.669617, loss_ss: 1.285872, loss_d: 0.383744
0.9988 --- loss: 1.968307, loss_ss: 1.162504, loss_d: 0.805803
Epoch finished! Loss: 1.9587354164857131
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.415195, loss_ss: 1.071302, loss_d: 0.343893
0.0384 --- loss: 1.703736, loss_ss: 1.347448, loss_d: 0.356288
0.0768 --- loss: 1.634373, loss_ss: 1.114472, loss_d: 0.519900
0.1153 --- loss: 2.148052, loss_ss: 1.320223, loss_d: 0.827829
0.1537 --- loss: 1.644304, loss_ss: 1.238429, loss_d: 0.405875
0.1921 --- loss: 1.641180, loss_ss: 1.188500, loss_d: 0.452680
0.2305 --- loss: 2.047506, loss_ss: 1.317704, loss_d: 0.729802
0.2689 --- loss: 1.829627, loss_ss: 0.991648, loss_d: 0.837979
0.3073 --- loss: 1.757383, loss_ss: 1.228537, loss_d: 0.528845
0.3458 --- loss: 1.799933, loss_ss: 1.043708, loss_d: 0.756225
0.3842 --- loss: 1.695653, loss_ss: 1.279063, loss_d: 0.416590
0.4226 --- loss: 1.612826, loss_ss: 1.065882, loss_d: 0.546944
0.4610 --- loss: 1.609413, loss_ss: 1.075953, loss_d: 0.533460
0.4994 --- loss: 1.589573, loss_ss: 1.038988, loss_d: 0.550585
0.5378 --- loss: 1.936058, loss_ss: 1.276159, loss_d: 0.659898
0.5763 --- loss: 1.635409, loss_ss: 1.159272, loss_d: 0.476137
0.6147 --- loss: 1.673095, loss_ss: 1.254325, loss_d: 0.418769
0.6531 --- loss: 1.842322, loss_ss: 0.862780, loss_d: 0.979542
0.6915 --- loss: 1.529199, loss_ss: 1.237795, loss_d: 0.291403
0.7299 --- loss: 1.836932, loss_ss: 1.225750, loss_d: 0.611182
0.7683 --- loss: 1.571743, loss_ss: 1.054640, loss_d: 0.517103
0.8068 --- loss: 1.843004, loss_ss: 1.118669, loss_d: 0.724335
0.8452 --- loss: 1.514948, loss_ss: 0.927303, loss_d: 0.587645
0.8836 --- loss: 1.479588, loss_ss: 1.018265, loss_d: 0.461323
0.9220 --- loss: 1.704855, loss_ss: 1.057035, loss_d: 0.647820
0.9604 --- loss: 1.866197, loss_ss: 1.154728, loss_d: 0.711469
0.9988 --- loss: 1.317472, loss_ss: 1.061036, loss_d: 0.256436
Epoch finished! Loss: 1.7126369260824643
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.450233, loss_ss: 0.885817, loss_d: 0.564416
0.0384 --- loss: 1.796310, loss_ss: 1.170340, loss_d: 0.625970
0.0768 --- loss: 1.479210, loss_ss: 0.955624, loss_d: 0.523586
0.1153 --- loss: 1.500083, loss_ss: 0.938690, loss_d: 0.561393
0.1537 --- loss: 1.569077, loss_ss: 1.120109, loss_d: 0.448968
0.1921 --- loss: 1.664829, loss_ss: 1.025422, loss_d: 0.639407
0.2305 --- loss: 1.507501, loss_ss: 0.819085, loss_d: 0.688416
0.2689 --- loss: 1.690919, loss_ss: 1.051678, loss_d: 0.639241
0.3073 --- loss: 1.434708, loss_ss: 0.949934, loss_d: 0.484774
0.3458 --- loss: 1.771493, loss_ss: 1.278399, loss_d: 0.493094
0.3842 --- loss: 1.615350, loss_ss: 0.997508, loss_d: 0.617842
0.4226 --- loss: 2.189010, loss_ss: 1.316423, loss_d: 0.872587
0.4610 --- loss: 1.354580, loss_ss: 0.978809, loss_d: 0.375771
0.4994 --- loss: 2.202206, loss_ss: 1.442510, loss_d: 0.759696
0.5378 --- loss: 1.457172, loss_ss: 1.009626, loss_d: 0.447546
0.5763 --- loss: 1.401791, loss_ss: 1.016770, loss_d: 0.385021
0.6147 --- loss: 1.679476, loss_ss: 1.132178, loss_d: 0.547298
0.6531 --- loss: 1.331740, loss_ss: 1.021907, loss_d: 0.309833
0.6915 --- loss: 1.721444, loss_ss: 1.077935, loss_d: 0.643509
0.7299 --- loss: 1.506564, loss_ss: 1.088366, loss_d: 0.418198
0.7683 --- loss: 1.445143, loss_ss: 1.044301, loss_d: 0.400842
0.8068 --- loss: 1.890985, loss_ss: 1.238151, loss_d: 0.652834
0.8452 --- loss: 1.539532, loss_ss: 1.188054, loss_d: 0.351478
0.8836 --- loss: 1.639334, loss_ss: 1.059835, loss_d: 0.579500
0.9220 --- loss: 1.772896, loss_ss: 0.863701, loss_d: 0.909195
0.9604 --- loss: 1.731954, loss_ss: 1.025636, loss_d: 0.706318
0.9988 --- loss: 1.083607, loss_ss: 0.766784, loss_d: 0.316824
Epoch finished! Loss: 1.6203223682366885
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.320987, loss_ss: 0.852633, loss_d: 0.468353
0.0384 --- loss: 1.440101, loss_ss: 0.997619, loss_d: 0.442482
0.0768 --- loss: 1.275813, loss_ss: 1.029569, loss_d: 0.246244
0.1153 --- loss: 1.567710, loss_ss: 1.084666, loss_d: 0.483044
0.1537 --- loss: 1.441545, loss_ss: 0.988129, loss_d: 0.453416
0.1921 --- loss: 1.691830, loss_ss: 1.156064, loss_d: 0.535766
0.2305 --- loss: 1.550497, loss_ss: 1.019254, loss_d: 0.531243
0.2689 --- loss: 1.284080, loss_ss: 0.970177, loss_d: 0.313904
0.3073 --- loss: 1.930924, loss_ss: 1.160354, loss_d: 0.770569
0.3458 --- loss: 1.421661, loss_ss: 0.698906, loss_d: 0.722756
0.3842 --- loss: 1.355948, loss_ss: 0.923768, loss_d: 0.432180
0.4226 --- loss: 1.340301, loss_ss: 0.980283, loss_d: 0.360018
0.4610 --- loss: 1.805409, loss_ss: 0.966408, loss_d: 0.839001
0.4994 --- loss: 1.410232, loss_ss: 0.870119, loss_d: 0.540113
0.5378 --- loss: 1.644265, loss_ss: 1.318722, loss_d: 0.325543
0.5763 --- loss: 1.186566, loss_ss: 0.677273, loss_d: 0.509293
0.6147 --- loss: 1.427538, loss_ss: 1.059678, loss_d: 0.367860
0.6531 --- loss: 1.194750, loss_ss: 0.860160, loss_d: 0.334590
0.6915 --- loss: 1.378646, loss_ss: 0.955977, loss_d: 0.422669
0.7299 --- loss: 1.699632, loss_ss: 0.947692, loss_d: 0.751941
0.7683 --- loss: 1.343310, loss_ss: 0.800826, loss_d: 0.542484
0.8068 --- loss: 1.560173, loss_ss: 1.131830, loss_d: 0.428343
0.8452 --- loss: 1.116946, loss_ss: 0.819560, loss_d: 0.297386
0.8836 --- loss: 1.213434, loss_ss: 0.918919, loss_d: 0.294515
0.9220 --- loss: 1.361193, loss_ss: 0.945783, loss_d: 0.415410
0.9604 --- loss: 1.310124, loss_ss: 0.864507, loss_d: 0.445617
0.9988 --- loss: 1.369002, loss_ss: 1.157756, loss_d: 0.211245
Epoch finished! Loss: 1.4727839093941908
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.390772, loss_ss: 0.833781, loss_d: 0.556991
0.0384 --- loss: 1.163631, loss_ss: 0.832661, loss_d: 0.330970
0.0768 --- loss: 0.992266, loss_ss: 0.756935, loss_d: 0.235331
0.1153 --- loss: 1.283777, loss_ss: 0.814064, loss_d: 0.469713
0.1537 --- loss: 1.536306, loss_ss: 0.807307, loss_d: 0.728998
0.1921 --- loss: 1.290863, loss_ss: 1.010294, loss_d: 0.280569
0.2305 --- loss: 1.208206, loss_ss: 0.876313, loss_d: 0.331893
0.2689 --- loss: 1.528551, loss_ss: 1.146669, loss_d: 0.381882
0.3073 --- loss: 1.537604, loss_ss: 0.951692, loss_d: 0.585912
0.3458 --- loss: 1.452084, loss_ss: 0.988743, loss_d: 0.463341
0.3842 --- loss: 1.866637, loss_ss: 1.172002, loss_d: 0.694635
0.4226 --- loss: 1.689647, loss_ss: 0.906396, loss_d: 0.783252
0.4610 --- loss: 1.487232, loss_ss: 1.175144, loss_d: 0.312087
0.4994 --- loss: 1.196715, loss_ss: 0.853070, loss_d: 0.343644
0.5378 --- loss: 1.002790, loss_ss: 0.784780, loss_d: 0.218010
0.5763 --- loss: 1.303727, loss_ss: 1.037917, loss_d: 0.265810
0.6147 --- loss: 1.034188, loss_ss: 0.826620, loss_d: 0.207568
0.6531 --- loss: 1.360699, loss_ss: 0.757555, loss_d: 0.603144
0.6915 --- loss: 1.356536, loss_ss: 0.975180, loss_d: 0.381357
0.7299 --- loss: 1.121955, loss_ss: 0.902083, loss_d: 0.219872
0.7683 --- loss: 1.182232, loss_ss: 0.805850, loss_d: 0.376382
0.8068 --- loss: 1.752294, loss_ss: 1.317595, loss_d: 0.434698
0.8452 --- loss: 1.191959, loss_ss: 0.767767, loss_d: 0.424191
0.8836 --- loss: 1.831264, loss_ss: 1.455506, loss_d: 0.375759
0.9220 --- loss: 1.523133, loss_ss: 1.020707, loss_d: 0.502425
0.9604 --- loss: 1.668014, loss_ss: 0.811934, loss_d: 0.856080
0.9988 --- loss: 1.981951, loss_ss: 0.991268, loss_d: 0.990683
Epoch finished! Loss: 1.404456897194569
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.323432, loss_ss: 0.902536, loss_d: 0.420897
0.0384 --- loss: 1.759143, loss_ss: 1.137423, loss_d: 0.621720
0.0768 --- loss: 1.256594, loss_ss: 0.760400, loss_d: 0.496194
0.1153 --- loss: 1.073552, loss_ss: 0.858169, loss_d: 0.215384
0.1537 --- loss: 1.147028, loss_ss: 0.756130, loss_d: 0.390898
0.1921 --- loss: 1.278636, loss_ss: 1.000003, loss_d: 0.278633
0.2305 --- loss: 1.381280, loss_ss: 1.173888, loss_d: 0.207393
0.2689 --- loss: 1.112278, loss_ss: 0.803250, loss_d: 0.309027
0.3073 --- loss: 0.892896, loss_ss: 0.596015, loss_d: 0.296881
0.3458 --- loss: 1.902519, loss_ss: 1.115244, loss_d: 0.787275
0.3842 --- loss: 1.372510, loss_ss: 0.929698, loss_d: 0.442812
0.4226 --- loss: 1.436632, loss_ss: 0.916748, loss_d: 0.519884
0.4610 --- loss: 1.575261, loss_ss: 1.044871, loss_d: 0.530390
0.4994 --- loss: 1.055592, loss_ss: 0.837020, loss_d: 0.218572
0.5378 --- loss: 1.421119, loss_ss: 1.129354, loss_d: 0.291765
0.5763 --- loss: 1.643041, loss_ss: 1.127521, loss_d: 0.515520
0.6147 --- loss: 1.285675, loss_ss: 0.825397, loss_d: 0.460278
0.6531 --- loss: 1.644307, loss_ss: 1.152175, loss_d: 0.492132
0.6915 --- loss: 1.273025, loss_ss: 1.027435, loss_d: 0.245590
0.7299 --- loss: 1.117766, loss_ss: 0.958452, loss_d: 0.159315
0.7683 --- loss: 1.353721, loss_ss: 1.159408, loss_d: 0.194312
0.8068 --- loss: 1.530799, loss_ss: 1.161142, loss_d: 0.369657
0.8452 --- loss: 1.322011, loss_ss: 0.864826, loss_d: 0.457185
0.8836 --- loss: 1.340385, loss_ss: 0.949781, loss_d: 0.390604
0.9220 --- loss: 1.596160, loss_ss: 1.024863, loss_d: 0.571296
0.9604 --- loss: 1.154892, loss_ss: 0.886928, loss_d: 0.267964
0.9988 --- loss: 1.326759, loss_ss: 1.175293, loss_d: 0.151466
Epoch finished! Loss: 1.3351792028317084
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.468457, loss_ss: 0.817896, loss_d: 0.650562
0.0384 --- loss: 0.918438, loss_ss: 0.740635, loss_d: 0.177803
0.0768 --- loss: 0.812863, loss_ss: 0.658975, loss_d: 0.153888
0.1153 --- loss: 1.071673, loss_ss: 0.771800, loss_d: 0.299873
0.1537 --- loss: 1.134330, loss_ss: 0.994640, loss_d: 0.139690
0.1921 --- loss: 1.225956, loss_ss: 0.615325, loss_d: 0.610632
0.2305 --- loss: 1.471381, loss_ss: 0.974726, loss_d: 0.496656
0.2689 --- loss: 1.518399, loss_ss: 1.334038, loss_d: 0.184361
0.3073 --- loss: 1.404267, loss_ss: 1.132502, loss_d: 0.271765
0.3458 --- loss: 1.399999, loss_ss: 0.841956, loss_d: 0.558043
0.3842 --- loss: 1.325616, loss_ss: 1.077234, loss_d: 0.248381
0.4226 --- loss: 1.413240, loss_ss: 0.961464, loss_d: 0.451777
0.4610 --- loss: 1.106017, loss_ss: 0.685500, loss_d: 0.420517
0.4994 --- loss: 1.260813, loss_ss: 0.902890, loss_d: 0.357922
0.5378 --- loss: 0.954666, loss_ss: 0.785105, loss_d: 0.169561
0.5763 --- loss: 1.092190, loss_ss: 0.565844, loss_d: 0.526346
0.6147 --- loss: 0.786346, loss_ss: 0.573086, loss_d: 0.213259
0.6531 --- loss: 1.539135, loss_ss: 0.950570, loss_d: 0.588565
0.6915 --- loss: 1.098318, loss_ss: 0.829308, loss_d: 0.269010
0.7299 --- loss: 1.389806, loss_ss: 1.200400, loss_d: 0.189405
0.7683 --- loss: 1.568510, loss_ss: 0.827928, loss_d: 0.740582
0.8068 --- loss: 1.451957, loss_ss: 1.160074, loss_d: 0.291883
0.8452 --- loss: 0.962400, loss_ss: 0.759689, loss_d: 0.202711
0.8836 --- loss: 0.951855, loss_ss: 0.595343, loss_d: 0.356512
0.9220 --- loss: 1.009153, loss_ss: 0.781081, loss_d: 0.228071
0.9604 --- loss: 1.108715, loss_ss: 0.991188, loss_d: 0.117527
0.9988 --- loss: 1.285204, loss_ss: 0.801029, loss_d: 0.484175
Epoch finished! Loss: 1.2827989981724666
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.241391, loss_ss: 1.086887, loss_d: 0.154503
0.0384 --- loss: 1.227863, loss_ss: 1.036847, loss_d: 0.191016
0.0768 --- loss: 1.098417, loss_ss: 0.912604, loss_d: 0.185813
0.1153 --- loss: 1.468989, loss_ss: 1.122169, loss_d: 0.346819
0.1537 --- loss: 1.526047, loss_ss: 1.156515, loss_d: 0.369532
0.1921 --- loss: 1.204460, loss_ss: 0.834980, loss_d: 0.369480
0.2305 --- loss: 1.425857, loss_ss: 1.219759, loss_d: 0.206099
0.2689 --- loss: 1.395911, loss_ss: 0.843267, loss_d: 0.552644
0.3073 --- loss: 1.084388, loss_ss: 0.922391, loss_d: 0.161997
0.3458 --- loss: 1.022432, loss_ss: 0.900750, loss_d: 0.121683
0.3842 --- loss: 1.387908, loss_ss: 0.937250, loss_d: 0.450658
0.4226 --- loss: 1.354941, loss_ss: 1.115553, loss_d: 0.239388
0.4610 --- loss: 1.192672, loss_ss: 0.862961, loss_d: 0.329711
0.4994 --- loss: 0.905932, loss_ss: 0.655935, loss_d: 0.249997
0.5378 --- loss: 1.414927, loss_ss: 0.894122, loss_d: 0.520805
0.5763 --- loss: 0.939009, loss_ss: 0.756874, loss_d: 0.182135
0.6147 --- loss: 1.729811, loss_ss: 0.781310, loss_d: 0.948501
0.6531 --- loss: 1.282716, loss_ss: 1.065954, loss_d: 0.216762
0.6915 --- loss: 1.291239, loss_ss: 0.557050, loss_d: 0.734190
0.7299 --- loss: 1.024869, loss_ss: 0.870806, loss_d: 0.154063
0.7683 --- loss: 1.084099, loss_ss: 0.895464, loss_d: 0.188635
0.8068 --- loss: 0.870934, loss_ss: 0.699260, loss_d: 0.171675
0.8452 --- loss: 1.255464, loss_ss: 1.018173, loss_d: 0.237291
0.8836 --- loss: 1.206289, loss_ss: 0.831817, loss_d: 0.374472
0.9220 --- loss: 1.616389, loss_ss: 0.949324, loss_d: 0.667064
0.9604 --- loss: 1.611078, loss_ss: 1.179064, loss_d: 0.432015
0.9988 --- loss: 0.929157, loss_ss: 0.725861, loss_d: 0.203296
Epoch finished! Loss: 1.2576025685438743
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.319563, loss_ss: 1.004348, loss_d: 0.315215
0.0384 --- loss: 0.886382, loss_ss: 0.512909, loss_d: 0.373473
0.0768 --- loss: 0.981957, loss_ss: 0.685254, loss_d: 0.296703
0.1153 --- loss: 1.218195, loss_ss: 0.609880, loss_d: 0.608315
0.1537 --- loss: 1.007516, loss_ss: 0.821580, loss_d: 0.185936
0.1921 --- loss: 1.581242, loss_ss: 0.898256, loss_d: 0.682986
0.2305 --- loss: 0.934770, loss_ss: 0.790789, loss_d: 0.143981
0.2689 --- loss: 1.008774, loss_ss: 0.716960, loss_d: 0.291814
0.3073 --- loss: 1.120173, loss_ss: 0.684203, loss_d: 0.435970
0.3458 --- loss: 1.303084, loss_ss: 1.068915, loss_d: 0.234169
0.3842 --- loss: 1.050793, loss_ss: 0.958667, loss_d: 0.092125
0.4226 --- loss: 1.425702, loss_ss: 0.908606, loss_d: 0.517096
0.4610 --- loss: 0.859595, loss_ss: 0.598369, loss_d: 0.261226
0.4994 --- loss: 1.055664, loss_ss: 0.908602, loss_d: 0.147062
0.5378 --- loss: 1.711089, loss_ss: 1.026833, loss_d: 0.684256
0.5763 --- loss: 0.867619, loss_ss: 0.743292, loss_d: 0.124327
0.6147 --- loss: 1.050612, loss_ss: 0.628841, loss_d: 0.421771
0.6531 --- loss: 1.403859, loss_ss: 1.162460, loss_d: 0.241400
0.6915 --- loss: 1.021435, loss_ss: 0.786977, loss_d: 0.234458
0.7299 --- loss: 1.433511, loss_ss: 1.186776, loss_d: 0.246735
0.7683 --- loss: 1.036586, loss_ss: 0.770896, loss_d: 0.265690
0.8068 --- loss: 0.958883, loss_ss: 0.677730, loss_d: 0.281153
0.8452 --- loss: 0.966612, loss_ss: 0.692651, loss_d: 0.273961
0.8836 --- loss: 1.387134, loss_ss: 0.636869, loss_d: 0.750265
0.9220 --- loss: 1.046162, loss_ss: 0.869412, loss_d: 0.176750
0.9604 --- loss: 1.139189, loss_ss: 0.805023, loss_d: 0.334166
0.9988 --- loss: 1.506424, loss_ss: 1.036851, loss_d: 0.469573
Epoch finished! Loss: 1.2166102689046125
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.069178, loss_ss: 0.913895, loss_d: 0.155282
0.0384 --- loss: 1.084400, loss_ss: 0.753529, loss_d: 0.330871
0.0768 --- loss: 0.932412, loss_ss: 0.730942, loss_d: 0.201470
0.1153 --- loss: 1.249661, loss_ss: 0.986634, loss_d: 0.263027
0.1537 --- loss: 1.177360, loss_ss: 1.069653, loss_d: 0.107707
0.1921 --- loss: 1.291443, loss_ss: 1.125250, loss_d: 0.166194
0.2305 --- loss: 1.201078, loss_ss: 0.908818, loss_d: 0.292259
0.2689 --- loss: 0.833114, loss_ss: 0.573263, loss_d: 0.259851
0.3073 --- loss: 0.999909, loss_ss: 0.639461, loss_d: 0.360448
0.3458 --- loss: 1.232211, loss_ss: 0.759809, loss_d: 0.472402
0.3842 --- loss: 1.227441, loss_ss: 0.859270, loss_d: 0.368171
0.4226 --- loss: 1.291821, loss_ss: 0.783742, loss_d: 0.508079
0.4610 --- loss: 1.141835, loss_ss: 0.911798, loss_d: 0.230037
0.4994 --- loss: 0.862540, loss_ss: 0.694054, loss_d: 0.168486
0.5378 --- loss: 1.436370, loss_ss: 1.158729, loss_d: 0.277641
0.5763 --- loss: 1.429342, loss_ss: 0.981191, loss_d: 0.448151
0.6147 --- loss: 1.075549, loss_ss: 0.857913, loss_d: 0.217636
0.6531 --- loss: 1.110319, loss_ss: 0.837619, loss_d: 0.272701
0.6915 --- loss: 1.419522, loss_ss: 0.958614, loss_d: 0.460908
0.7299 --- loss: 1.235643, loss_ss: 0.849619, loss_d: 0.386024
0.7683 --- loss: 1.781611, loss_ss: 1.067445, loss_d: 0.714166
0.8068 --- loss: 0.993091, loss_ss: 0.726339, loss_d: 0.266752
0.8452 --- loss: 1.333741, loss_ss: 1.121413, loss_d: 0.212327
0.8836 --- loss: 1.444702, loss_ss: 0.972823, loss_d: 0.471879
0.9220 --- loss: 0.834143, loss_ss: 0.652099, loss_d: 0.182044
0.9604 --- loss: 1.019893, loss_ss: 0.560091, loss_d: 0.459801
0.9988 --- loss: 1.456063, loss_ss: 0.940108, loss_d: 0.515955
Epoch finished! Loss: 1.1834231819097811
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6771428571428572
             precision    recall  f1-score   support

        0.0       0.66      0.62      0.64        47
        1.0       0.67      0.02      0.04       108
        2.0       0.92      0.61      0.74       516
        3.0       0.74      0.95      0.84       150
        4.0       0.47      0.97      0.64       229

avg / total       0.76      0.68      0.65      1050
 


====== chp032-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.86  61.70   98.50  65.91     63.74
1  89.81   1.85   99.89  66.67      3.60
2  78.38  61.05   95.13  92.38     73.51
3  94.67  95.33   94.56  74.48     83.63
4  75.71  96.94   69.79  47.23     63.52
Total accuracy: 67.71%
Average sen: 63.38%
Average spec: 91.58%
Macro f1-score: 57.60%
Diagnosis acc on 15mins: 1.0
[0.8065182  0.97644198 0.76194489 0.52667248 0.57154882 0.56619591
 0.69033372 0.90700793 0.6556263  0.98184055 0.93078083 0.64914435
 0.83344024 0.93004185 0.68997937 0.59910691 0.90009063 0.83412367
 0.97440493 0.99574065 0.89528781 0.91908938 0.92722261 0.9573397
 0.7468282  0.84239745 0.8995375  0.89948928 0.99094158 0.98054737
 0.64480996 0.98693943 0.91477543 0.79729319 0.9722954 ]
pred: 0.8330222436359951, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp033-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.268513, loss_ss: 1.567799, loss_d: 0.700714
0.0384 --- loss: 2.083157, loss_ss: 1.460904, loss_d: 0.622253
0.0768 --- loss: 2.129558, loss_ss: 1.417563, loss_d: 0.711995
0.1152 --- loss: 2.055813, loss_ss: 1.445201, loss_d: 0.610611
0.1536 --- loss: 1.647538, loss_ss: 1.411735, loss_d: 0.235803
0.1919 --- loss: 2.274320, loss_ss: 1.407701, loss_d: 0.866619
0.2303 --- loss: 2.000687, loss_ss: 1.430577, loss_d: 0.570110
0.2687 --- loss: 1.992060, loss_ss: 1.363516, loss_d: 0.628545
0.3071 --- loss: 2.070407, loss_ss: 1.453007, loss_d: 0.617400
0.3455 --- loss: 1.932602, loss_ss: 1.276859, loss_d: 0.655744
0.3839 --- loss: 1.878427, loss_ss: 1.347625, loss_d: 0.530802
0.4223 --- loss: 1.845571, loss_ss: 1.350897, loss_d: 0.494675
0.4607 --- loss: 2.042006, loss_ss: 1.425404, loss_d: 0.616603
0.4990 --- loss: 1.979735, loss_ss: 1.322115, loss_d: 0.657620
0.5374 --- loss: 1.883239, loss_ss: 1.333728, loss_d: 0.549511
0.5758 --- loss: 2.004234, loss_ss: 1.445615, loss_d: 0.558620
0.6142 --- loss: 1.922163, loss_ss: 1.302931, loss_d: 0.619232
0.6526 --- loss: 1.855472, loss_ss: 1.236297, loss_d: 0.619175
0.6910 --- loss: 2.022851, loss_ss: 1.340990, loss_d: 0.681861
0.7294 --- loss: 1.645289, loss_ss: 1.183783, loss_d: 0.461506
0.7678 --- loss: 2.258864, loss_ss: 1.584150, loss_d: 0.674714
0.8061 --- loss: 1.819963, loss_ss: 1.274091, loss_d: 0.545872
0.8445 --- loss: 1.688941, loss_ss: 1.109676, loss_d: 0.579266
0.8829 --- loss: 2.121403, loss_ss: 1.504759, loss_d: 0.616644
0.9213 --- loss: 1.525306, loss_ss: 1.128269, loss_d: 0.397038
0.9597 --- loss: 1.675839, loss_ss: 1.172038, loss_d: 0.503801
0.9981 --- loss: 1.914526, loss_ss: 1.578550, loss_d: 0.335977
Epoch finished! Loss: 1.92316447863212
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.745843, loss_ss: 0.995909, loss_d: 0.749934
0.0384 --- loss: 1.636356, loss_ss: 1.138332, loss_d: 0.498024
0.0768 --- loss: 1.782559, loss_ss: 1.170187, loss_d: 0.612372
0.1152 --- loss: 1.847075, loss_ss: 1.373588, loss_d: 0.473487
0.1536 --- loss: 1.641315, loss_ss: 1.215917, loss_d: 0.425399
0.1919 --- loss: 1.876730, loss_ss: 1.438295, loss_d: 0.438434
0.2303 --- loss: 2.000826, loss_ss: 1.298717, loss_d: 0.702108
0.2687 --- loss: 1.652915, loss_ss: 1.218642, loss_d: 0.434272
0.3071 --- loss: 1.657700, loss_ss: 1.210839, loss_d: 0.446861
0.3455 --- loss: 1.739163, loss_ss: 1.168215, loss_d: 0.570948
0.3839 --- loss: 1.846653, loss_ss: 1.246036, loss_d: 0.600617
0.4223 --- loss: 1.585515, loss_ss: 1.122604, loss_d: 0.462911
0.4607 --- loss: 1.719500, loss_ss: 1.054761, loss_d: 0.664739
0.4990 --- loss: 1.630191, loss_ss: 1.393728, loss_d: 0.236463
0.5374 --- loss: 1.835401, loss_ss: 0.895960, loss_d: 0.939441
0.5758 --- loss: 1.537516, loss_ss: 1.060337, loss_d: 0.477179
0.6142 --- loss: 1.637622, loss_ss: 1.242430, loss_d: 0.395192
0.6526 --- loss: 2.302543, loss_ss: 1.378190, loss_d: 0.924353
0.6910 --- loss: 1.779397, loss_ss: 0.896671, loss_d: 0.882727
0.7294 --- loss: 1.758255, loss_ss: 1.241085, loss_d: 0.517169
0.7678 --- loss: 1.602764, loss_ss: 0.985874, loss_d: 0.616890
0.8061 --- loss: 1.505648, loss_ss: 1.184844, loss_d: 0.320804
0.8445 --- loss: 1.451625, loss_ss: 1.060189, loss_d: 0.391436
0.8829 --- loss: 1.523523, loss_ss: 1.092109, loss_d: 0.431414
0.9213 --- loss: 2.082319, loss_ss: 1.047975, loss_d: 1.034344
0.9597 --- loss: 1.177485, loss_ss: 0.824603, loss_d: 0.352882
0.9981 --- loss: 1.825798, loss_ss: 0.966022, loss_d: 0.859776
Epoch finished! Loss: 1.7032659957042107
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.533840, loss_ss: 1.040657, loss_d: 0.493183
0.0384 --- loss: 1.593841, loss_ss: 1.106165, loss_d: 0.487676
0.0768 --- loss: 1.584291, loss_ss: 0.831447, loss_d: 0.752843
0.1152 --- loss: 1.431286, loss_ss: 1.060690, loss_d: 0.370596
0.1536 --- loss: 1.978201, loss_ss: 1.286589, loss_d: 0.691612
0.1919 --- loss: 1.207749, loss_ss: 0.958959, loss_d: 0.248790
0.2303 --- loss: 1.553653, loss_ss: 1.080555, loss_d: 0.473098
0.2687 --- loss: 1.293504, loss_ss: 0.980098, loss_d: 0.313405
0.3071 --- loss: 1.782042, loss_ss: 1.108254, loss_d: 0.673788
0.3455 --- loss: 1.661837, loss_ss: 1.162398, loss_d: 0.499439
0.3839 --- loss: 1.685174, loss_ss: 0.917054, loss_d: 0.768120
0.4223 --- loss: 1.589798, loss_ss: 1.121235, loss_d: 0.468563
0.4607 --- loss: 2.218300, loss_ss: 1.374846, loss_d: 0.843454
0.4990 --- loss: 1.718213, loss_ss: 1.233776, loss_d: 0.484437
0.5374 --- loss: 2.158734, loss_ss: 1.352118, loss_d: 0.806616
0.5758 --- loss: 1.639796, loss_ss: 1.104553, loss_d: 0.535243
0.6142 --- loss: 1.448478, loss_ss: 1.072047, loss_d: 0.376431
0.6526 --- loss: 1.541776, loss_ss: 1.127298, loss_d: 0.414478
0.6910 --- loss: 1.803138, loss_ss: 1.063388, loss_d: 0.739750
0.7294 --- loss: 1.832970, loss_ss: 0.850201, loss_d: 0.982769
0.7678 --- loss: 1.533411, loss_ss: 1.179904, loss_d: 0.353506
0.8061 --- loss: 1.480684, loss_ss: 1.028903, loss_d: 0.451781
0.8445 --- loss: 1.383453, loss_ss: 0.887996, loss_d: 0.495457
0.8829 --- loss: 1.498214, loss_ss: 1.153262, loss_d: 0.344953
0.9213 --- loss: 2.065485, loss_ss: 1.137884, loss_d: 0.927601
0.9597 --- loss: 1.720980, loss_ss: 1.039796, loss_d: 0.681183
0.9981 --- loss: 1.846096, loss_ss: 1.300624, loss_d: 0.545472
Epoch finished! Loss: 1.594631202862813
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.582285, loss_ss: 0.926264, loss_d: 0.656021
0.0384 --- loss: 1.186274, loss_ss: 0.850019, loss_d: 0.336254
0.0768 --- loss: 1.502809, loss_ss: 1.116633, loss_d: 0.386176
0.1152 --- loss: 1.191901, loss_ss: 0.868022, loss_d: 0.323879
0.1536 --- loss: 1.574143, loss_ss: 1.050798, loss_d: 0.523346
0.1919 --- loss: 1.471294, loss_ss: 0.835315, loss_d: 0.635979
0.2303 --- loss: 1.261817, loss_ss: 0.826942, loss_d: 0.434875
0.2687 --- loss: 1.340396, loss_ss: 0.716267, loss_d: 0.624129
0.3071 --- loss: 1.604545, loss_ss: 1.023837, loss_d: 0.580708
0.3455 --- loss: 1.099815, loss_ss: 0.826304, loss_d: 0.273512
0.3839 --- loss: 1.172064, loss_ss: 0.784300, loss_d: 0.387764
0.4223 --- loss: 1.440673, loss_ss: 0.886971, loss_d: 0.553702
0.4607 --- loss: 1.568628, loss_ss: 0.960180, loss_d: 0.608447
0.4990 --- loss: 1.007832, loss_ss: 0.757038, loss_d: 0.250794
0.5374 --- loss: 1.293942, loss_ss: 0.856791, loss_d: 0.437151
0.5758 --- loss: 1.280277, loss_ss: 0.852592, loss_d: 0.427684
0.6142 --- loss: 1.378116, loss_ss: 0.807950, loss_d: 0.570165
0.6526 --- loss: 1.022114, loss_ss: 0.877579, loss_d: 0.144535
0.6910 --- loss: 1.394686, loss_ss: 0.985528, loss_d: 0.409157
0.7294 --- loss: 2.263881, loss_ss: 1.587959, loss_d: 0.675921
0.7678 --- loss: 1.512385, loss_ss: 1.117449, loss_d: 0.394936
0.8061 --- loss: 1.617197, loss_ss: 0.982066, loss_d: 0.635131
0.8445 --- loss: 1.399806, loss_ss: 1.050940, loss_d: 0.348866
0.8829 --- loss: 1.385067, loss_ss: 0.860833, loss_d: 0.524235
0.9213 --- loss: 1.079892, loss_ss: 0.826251, loss_d: 0.253641
0.9597 --- loss: 1.369698, loss_ss: 0.919951, loss_d: 0.449746
0.9981 --- loss: 1.932471, loss_ss: 1.551678, loss_d: 0.380793
Epoch finished! Loss: 1.4831741225260955
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.347751, loss_ss: 0.860689, loss_d: 0.487062
0.0384 --- loss: 1.531701, loss_ss: 0.921338, loss_d: 0.610363
0.0768 --- loss: 1.525063, loss_ss: 1.125044, loss_d: 0.400020
0.1152 --- loss: 1.503201, loss_ss: 0.956085, loss_d: 0.547116
0.1536 --- loss: 1.314128, loss_ss: 0.859172, loss_d: 0.454956
0.1919 --- loss: 1.645200, loss_ss: 0.967976, loss_d: 0.677224
0.2303 --- loss: 1.161728, loss_ss: 0.994854, loss_d: 0.166874
0.2687 --- loss: 1.684774, loss_ss: 1.042758, loss_d: 0.642016
0.3071 --- loss: 1.621800, loss_ss: 0.923294, loss_d: 0.698506
0.3455 --- loss: 1.383658, loss_ss: 1.008082, loss_d: 0.375576
0.3839 --- loss: 1.789223, loss_ss: 1.132161, loss_d: 0.657062
0.4223 --- loss: 1.276057, loss_ss: 0.856035, loss_d: 0.420021
0.4607 --- loss: 1.480008, loss_ss: 1.199695, loss_d: 0.280313
0.4990 --- loss: 1.264632, loss_ss: 1.008304, loss_d: 0.256328
0.5374 --- loss: 1.269236, loss_ss: 0.831220, loss_d: 0.438016
0.5758 --- loss: 1.207008, loss_ss: 0.784789, loss_d: 0.422219
0.6142 --- loss: 1.337327, loss_ss: 0.980956, loss_d: 0.356371
0.6526 --- loss: 1.459805, loss_ss: 1.065590, loss_d: 0.394215
0.6910 --- loss: 1.053908, loss_ss: 0.750867, loss_d: 0.303041
0.7294 --- loss: 1.272418, loss_ss: 0.911410, loss_d: 0.361008
0.7678 --- loss: 1.850426, loss_ss: 1.066396, loss_d: 0.784031
0.8061 --- loss: 1.803017, loss_ss: 0.908890, loss_d: 0.894127
0.8445 --- loss: 1.416089, loss_ss: 1.167055, loss_d: 0.249034
0.8829 --- loss: 1.172684, loss_ss: 0.854923, loss_d: 0.317761
0.9213 --- loss: 1.070030, loss_ss: 0.910766, loss_d: 0.159264
0.9597 --- loss: 1.911865, loss_ss: 1.426388, loss_d: 0.485477
0.9981 --- loss: 1.289223, loss_ss: 1.032892, loss_d: 0.256331
Epoch finished! Loss: 1.4076087864545674
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.239912, loss_ss: 0.948526, loss_d: 0.291387
0.0384 --- loss: 1.157183, loss_ss: 0.965096, loss_d: 0.192087
0.0768 --- loss: 1.133585, loss_ss: 0.853478, loss_d: 0.280107
0.1152 --- loss: 1.701242, loss_ss: 1.047191, loss_d: 0.654051
0.1536 --- loss: 1.365059, loss_ss: 0.897579, loss_d: 0.467480
0.1919 --- loss: 1.797498, loss_ss: 1.298019, loss_d: 0.499479
0.2303 --- loss: 1.764711, loss_ss: 1.114495, loss_d: 0.650216
0.2687 --- loss: 1.259757, loss_ss: 0.821367, loss_d: 0.438390
0.3071 --- loss: 1.238886, loss_ss: 0.816804, loss_d: 0.422082
0.3455 --- loss: 1.610739, loss_ss: 0.846230, loss_d: 0.764509
0.3839 --- loss: 1.535728, loss_ss: 1.025673, loss_d: 0.510055
0.4223 --- loss: 1.324979, loss_ss: 0.999315, loss_d: 0.325663
0.4607 --- loss: 1.440192, loss_ss: 1.167805, loss_d: 0.272386
0.4990 --- loss: 1.322454, loss_ss: 0.859779, loss_d: 0.462676
0.5374 --- loss: 1.781054, loss_ss: 1.092321, loss_d: 0.688733
0.5758 --- loss: 1.167341, loss_ss: 0.581003, loss_d: 0.586338
0.6142 --- loss: 1.534619, loss_ss: 1.021276, loss_d: 0.513343
0.6526 --- loss: 1.054492, loss_ss: 0.842445, loss_d: 0.212048
0.6910 --- loss: 1.256482, loss_ss: 0.851957, loss_d: 0.404525
0.7294 --- loss: 1.438682, loss_ss: 1.151268, loss_d: 0.287414
0.7678 --- loss: 1.149990, loss_ss: 0.980884, loss_d: 0.169106
0.8061 --- loss: 1.188027, loss_ss: 0.998988, loss_d: 0.189039
0.8445 --- loss: 1.402112, loss_ss: 1.059204, loss_d: 0.342908
0.8829 --- loss: 0.996487, loss_ss: 0.786484, loss_d: 0.210003
0.9213 --- loss: 1.082754, loss_ss: 0.812046, loss_d: 0.270708
0.9597 --- loss: 1.125566, loss_ss: 0.667988, loss_d: 0.457577
0.9981 --- loss: 1.361734, loss_ss: 1.041531, loss_d: 0.320203
Epoch finished! Loss: 1.3187349954476724
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.415461, loss_ss: 0.980989, loss_d: 0.434472
0.0384 --- loss: 1.363126, loss_ss: 0.945058, loss_d: 0.418068
0.0768 --- loss: 1.434720, loss_ss: 0.791857, loss_d: 0.642863
0.1152 --- loss: 1.066365, loss_ss: 0.783260, loss_d: 0.283105
0.1536 --- loss: 1.507125, loss_ss: 0.970248, loss_d: 0.536877
0.1919 --- loss: 1.485102, loss_ss: 1.114498, loss_d: 0.370604
0.2303 --- loss: 1.567545, loss_ss: 0.896756, loss_d: 0.670789
0.2687 --- loss: 1.240778, loss_ss: 1.061453, loss_d: 0.179325
0.3071 --- loss: 0.992752, loss_ss: 0.854244, loss_d: 0.138509
0.3455 --- loss: 1.747347, loss_ss: 0.900973, loss_d: 0.846373
0.3839 --- loss: 1.005804, loss_ss: 0.817099, loss_d: 0.188706
0.4223 --- loss: 1.397535, loss_ss: 0.968875, loss_d: 0.428660
0.4607 --- loss: 1.106909, loss_ss: 0.920574, loss_d: 0.186335
0.4990 --- loss: 1.233614, loss_ss: 0.983009, loss_d: 0.250605
0.5374 --- loss: 1.411641, loss_ss: 1.008890, loss_d: 0.402752
0.5758 --- loss: 1.208205, loss_ss: 0.780746, loss_d: 0.427459
0.6142 --- loss: 1.392242, loss_ss: 1.161618, loss_d: 0.230624
0.6526 --- loss: 1.101445, loss_ss: 0.750261, loss_d: 0.351184
0.6910 --- loss: 0.968292, loss_ss: 0.806404, loss_d: 0.161889
0.7294 --- loss: 1.099560, loss_ss: 0.963195, loss_d: 0.136364
0.7678 --- loss: 1.612618, loss_ss: 1.046015, loss_d: 0.566604
0.8061 --- loss: 1.024089, loss_ss: 0.843347, loss_d: 0.180742
0.8445 --- loss: 1.364804, loss_ss: 0.861751, loss_d: 0.503053
0.8829 --- loss: 1.175890, loss_ss: 0.898069, loss_d: 0.277821
0.9213 --- loss: 1.028028, loss_ss: 0.870707, loss_d: 0.157321
0.9597 --- loss: 1.469506, loss_ss: 1.158134, loss_d: 0.311373
0.9981 --- loss: 0.829149, loss_ss: 0.636993, loss_d: 0.192156
Epoch finished! Loss: 1.264493089226576
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.781476, loss_ss: 0.671998, loss_d: 0.109478
0.0384 --- loss: 1.442989, loss_ss: 0.822054, loss_d: 0.620935
0.0768 --- loss: 1.093903, loss_ss: 0.826061, loss_d: 0.267842
0.1152 --- loss: 1.508761, loss_ss: 0.945206, loss_d: 0.563555
0.1536 --- loss: 1.358791, loss_ss: 1.265935, loss_d: 0.092856
0.1919 --- loss: 0.995171, loss_ss: 0.748677, loss_d: 0.246495
0.2303 --- loss: 1.056035, loss_ss: 0.843870, loss_d: 0.212165
0.2687 --- loss: 1.038096, loss_ss: 0.606054, loss_d: 0.432042
0.3071 --- loss: 0.924182, loss_ss: 0.783970, loss_d: 0.140213
0.3455 --- loss: 1.633885, loss_ss: 1.185825, loss_d: 0.448060
0.3839 --- loss: 0.876697, loss_ss: 0.677831, loss_d: 0.198866
0.4223 --- loss: 1.498014, loss_ss: 1.057580, loss_d: 0.440435
0.4607 --- loss: 1.550853, loss_ss: 0.933681, loss_d: 0.617172
0.4990 --- loss: 0.875694, loss_ss: 0.678353, loss_d: 0.197340
0.5374 --- loss: 1.285142, loss_ss: 0.820404, loss_d: 0.464738
0.5758 --- loss: 1.284745, loss_ss: 0.947077, loss_d: 0.337668
0.6142 --- loss: 0.721238, loss_ss: 0.600394, loss_d: 0.120844
0.6526 --- loss: 1.276467, loss_ss: 0.961682, loss_d: 0.314785
0.6910 --- loss: 1.208645, loss_ss: 1.089019, loss_d: 0.119626
0.7294 --- loss: 1.976654, loss_ss: 0.942920, loss_d: 1.033734
0.7678 --- loss: 1.889382, loss_ss: 1.516863, loss_d: 0.372519
0.8061 --- loss: 1.010829, loss_ss: 0.739371, loss_d: 0.271458
0.8445 --- loss: 1.317317, loss_ss: 0.737695, loss_d: 0.579622
0.8829 --- loss: 1.445570, loss_ss: 1.087508, loss_d: 0.358062
0.9213 --- loss: 1.153983, loss_ss: 0.867940, loss_d: 0.286042
0.9597 --- loss: 1.111005, loss_ss: 0.744374, loss_d: 0.366632
0.9981 --- loss: 1.505717, loss_ss: 1.454866, loss_d: 0.050851
Epoch finished! Loss: 1.2335529703360337
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.010089, loss_ss: 0.943582, loss_d: 0.066507
0.0384 --- loss: 1.173025, loss_ss: 0.966946, loss_d: 0.206079
0.0768 --- loss: 0.769376, loss_ss: 0.648337, loss_d: 0.121040
0.1152 --- loss: 1.242649, loss_ss: 0.776331, loss_d: 0.466317
0.1536 --- loss: 1.247956, loss_ss: 0.819739, loss_d: 0.428217
0.1919 --- loss: 1.075875, loss_ss: 0.705334, loss_d: 0.370541
0.2303 --- loss: 0.900523, loss_ss: 0.759049, loss_d: 0.141474
0.2687 --- loss: 1.474675, loss_ss: 0.940711, loss_d: 0.533964
0.3071 --- loss: 1.272838, loss_ss: 0.976184, loss_d: 0.296654
0.3455 --- loss: 1.336742, loss_ss: 1.109756, loss_d: 0.226985
0.3839 --- loss: 1.395949, loss_ss: 0.901635, loss_d: 0.494314
0.4223 --- loss: 1.052996, loss_ss: 0.929927, loss_d: 0.123069
0.4607 --- loss: 1.075544, loss_ss: 0.960213, loss_d: 0.115331
0.4990 --- loss: 1.386432, loss_ss: 0.941213, loss_d: 0.445220
0.5374 --- loss: 1.010644, loss_ss: 0.774764, loss_d: 0.235880
0.5758 --- loss: 1.042776, loss_ss: 0.919233, loss_d: 0.123543
0.6142 --- loss: 0.825257, loss_ss: 0.758996, loss_d: 0.066262
0.6526 --- loss: 1.000202, loss_ss: 0.849897, loss_d: 0.150305
0.6910 --- loss: 1.271939, loss_ss: 0.775845, loss_d: 0.496094
0.7294 --- loss: 1.617317, loss_ss: 0.727932, loss_d: 0.889385
0.7678 --- loss: 1.181489, loss_ss: 1.077437, loss_d: 0.104052
0.8061 --- loss: 1.021399, loss_ss: 0.878066, loss_d: 0.143333
0.8445 --- loss: 1.010327, loss_ss: 0.880717, loss_d: 0.129610
0.8829 --- loss: 1.418790, loss_ss: 0.803030, loss_d: 0.615760
0.9213 --- loss: 0.901259, loss_ss: 0.734891, loss_d: 0.166369
0.9597 --- loss: 0.854699, loss_ss: 0.647139, loss_d: 0.207560
0.9981 --- loss: 2.173424, loss_ss: 0.653501, loss_d: 1.519923
Epoch finished! Loss: 1.1887730506750254
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.361681, loss_ss: 0.777404, loss_d: 0.584277
0.0384 --- loss: 1.142567, loss_ss: 0.775688, loss_d: 0.366879
0.0768 --- loss: 0.955197, loss_ss: 0.747674, loss_d: 0.207523
0.1152 --- loss: 0.690728, loss_ss: 0.542818, loss_d: 0.147911
0.1536 --- loss: 1.667583, loss_ss: 0.923304, loss_d: 0.744279
0.1919 --- loss: 1.022840, loss_ss: 0.780132, loss_d: 0.242708
0.2303 --- loss: 1.023971, loss_ss: 0.793126, loss_d: 0.230844
0.2687 --- loss: 1.165088, loss_ss: 0.946352, loss_d: 0.218737
0.3071 --- loss: 1.081807, loss_ss: 0.831639, loss_d: 0.250169
0.3455 --- loss: 1.028850, loss_ss: 0.873830, loss_d: 0.155020
0.3839 --- loss: 1.141995, loss_ss: 0.912103, loss_d: 0.229891
0.4223 --- loss: 0.900702, loss_ss: 0.710819, loss_d: 0.189883
0.4607 --- loss: 0.922903, loss_ss: 0.750092, loss_d: 0.172811
0.4990 --- loss: 1.197530, loss_ss: 0.837928, loss_d: 0.359601
0.5374 --- loss: 1.488298, loss_ss: 0.893949, loss_d: 0.594349
0.5758 --- loss: 1.010174, loss_ss: 0.831827, loss_d: 0.178347
0.6142 --- loss: 1.155397, loss_ss: 0.890575, loss_d: 0.264821
0.6526 --- loss: 0.899608, loss_ss: 0.827323, loss_d: 0.072286
0.6910 --- loss: 0.840903, loss_ss: 0.620452, loss_d: 0.220451
0.7294 --- loss: 0.975881, loss_ss: 0.847354, loss_d: 0.128527
0.7678 --- loss: 1.738114, loss_ss: 1.476842, loss_d: 0.261272
0.8061 --- loss: 1.352880, loss_ss: 1.043861, loss_d: 0.309019
0.8445 --- loss: 1.212859, loss_ss: 1.068559, loss_d: 0.144300
0.8829 --- loss: 1.591342, loss_ss: 0.867742, loss_d: 0.723600
0.9213 --- loss: 1.997564, loss_ss: 1.098469, loss_d: 0.899094
0.9597 --- loss: 1.190179, loss_ss: 0.715442, loss_d: 0.474737
0.9981 --- loss: 1.247465, loss_ss: 0.821581, loss_d: 0.425884
Epoch finished! Loss: 1.1759908066346094
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6686868686868687
             precision    recall  f1-score   support

        0.0       0.29      0.75      0.42        32
        1.0       0.63      0.18      0.27       251
        2.0       0.64      0.77      0.70       208
        3.0       0.99      0.85      0.92       254
        4.0       0.59      0.88      0.71       245

avg / total       0.70      0.67      0.64       990
 


====== chp033-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.23  75.00   93.84  28.92     41.74
1  76.46  17.53   96.48  62.86     27.41
2  85.96  77.40   88.24  63.64     69.85
3  96.06  85.43   99.73  99.09     91.75
4  82.02  88.16   80.00  59.18     70.82
Total accuracy: 66.87%
Average sen: 68.71%
Average spec: 91.66%
Macro f1-score: 60.32%
Diagnosis acc on 15mins: 0.9696969696969697
[0.58718663 0.73038161 0.80965167 0.83989507 0.69560015 0.96910322
 0.98934853 0.98490357 0.98570758 0.96011662 0.72919136 0.69123
 0.9705978  0.9391641  0.75582838 0.84252614 0.76907313 0.97900963
 0.61858988 0.99048001 0.98432815 0.9510448  0.92927086 0.31010732
 0.97302711 0.97529095 0.8625977  0.69406509 0.7672742  0.62258464
 0.69739729 0.76231325 0.7882601 ]
pred: 0.8228832293640483, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp034-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.265474, loss_ss: 1.581818, loss_d: 0.683656
0.0384 --- loss: 2.265575, loss_ss: 1.510813, loss_d: 0.754762
0.0768 --- loss: 2.270217, loss_ss: 1.469530, loss_d: 0.800686
0.1152 --- loss: 2.048417, loss_ss: 1.528722, loss_d: 0.519696
0.1536 --- loss: 1.689254, loss_ss: 1.248525, loss_d: 0.440729
0.1920 --- loss: 2.199287, loss_ss: 1.458820, loss_d: 0.740468
0.2304 --- loss: 2.024335, loss_ss: 1.288856, loss_d: 0.735479
0.2688 --- loss: 1.853915, loss_ss: 1.303884, loss_d: 0.550030
0.3072 --- loss: 1.858327, loss_ss: 1.357881, loss_d: 0.500446
0.3456 --- loss: 1.937794, loss_ss: 1.363862, loss_d: 0.573932
0.3840 --- loss: 1.949650, loss_ss: 1.115156, loss_d: 0.834494
0.4224 --- loss: 1.984174, loss_ss: 1.327448, loss_d: 0.656727
0.4608 --- loss: 1.674251, loss_ss: 1.167815, loss_d: 0.506436
0.4992 --- loss: 1.697241, loss_ss: 1.213923, loss_d: 0.483318
0.5376 --- loss: 1.714867, loss_ss: 1.127421, loss_d: 0.587446
0.5760 --- loss: 1.869225, loss_ss: 1.279583, loss_d: 0.589642
0.6144 --- loss: 1.880258, loss_ss: 1.222433, loss_d: 0.657825
0.6528 --- loss: 1.797666, loss_ss: 1.279468, loss_d: 0.518198
0.6912 --- loss: 1.824939, loss_ss: 1.207341, loss_d: 0.617598
0.7296 --- loss: 1.734360, loss_ss: 1.209860, loss_d: 0.524499
0.7680 --- loss: 1.943064, loss_ss: 1.533302, loss_d: 0.409762
0.8065 --- loss: 1.647375, loss_ss: 1.242107, loss_d: 0.405268
0.8449 --- loss: 1.690360, loss_ss: 1.122626, loss_d: 0.567734
0.8833 --- loss: 2.003221, loss_ss: 1.119419, loss_d: 0.883802
0.9217 --- loss: 2.102370, loss_ss: 1.631089, loss_d: 0.471281
0.9601 --- loss: 1.753106, loss_ss: 1.270989, loss_d: 0.482117
0.9985 --- loss: 2.234101, loss_ss: 1.873064, loss_d: 0.361037
Epoch finished! Loss: 1.899935151063479
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.981859, loss_ss: 1.449085, loss_d: 0.532774
0.0384 --- loss: 1.496347, loss_ss: 0.992295, loss_d: 0.504052
0.0768 --- loss: 1.747449, loss_ss: 1.226974, loss_d: 0.520475
0.1152 --- loss: 1.722108, loss_ss: 1.199103, loss_d: 0.523005
0.1536 --- loss: 1.562396, loss_ss: 1.022002, loss_d: 0.540394
0.1920 --- loss: 1.821819, loss_ss: 1.266089, loss_d: 0.555731
0.2304 --- loss: 1.435878, loss_ss: 1.108467, loss_d: 0.327411
0.2688 --- loss: 1.521201, loss_ss: 0.932947, loss_d: 0.588254
0.3072 --- loss: 1.572579, loss_ss: 1.079232, loss_d: 0.493347
0.3456 --- loss: 1.793815, loss_ss: 1.085792, loss_d: 0.708023
0.3840 --- loss: 1.417590, loss_ss: 1.095849, loss_d: 0.321741
0.4224 --- loss: 2.065868, loss_ss: 1.112712, loss_d: 0.953156
0.4608 --- loss: 1.745286, loss_ss: 1.166852, loss_d: 0.578433
0.4992 --- loss: 1.772528, loss_ss: 1.130212, loss_d: 0.642316
0.5376 --- loss: 1.625833, loss_ss: 1.183016, loss_d: 0.442818
0.5760 --- loss: 1.800687, loss_ss: 1.125609, loss_d: 0.675078
0.6144 --- loss: 1.470088, loss_ss: 1.021240, loss_d: 0.448848
0.6528 --- loss: 2.038252, loss_ss: 1.019859, loss_d: 1.018393
0.6912 --- loss: 1.862558, loss_ss: 1.184701, loss_d: 0.677857
0.7296 --- loss: 1.823826, loss_ss: 1.049935, loss_d: 0.773890
0.7680 --- loss: 1.454179, loss_ss: 1.024489, loss_d: 0.429690
0.8065 --- loss: 2.057857, loss_ss: 1.109636, loss_d: 0.948220
0.8449 --- loss: 1.629540, loss_ss: 1.059386, loss_d: 0.570154
0.8833 --- loss: 1.664876, loss_ss: 1.068449, loss_d: 0.596427
0.9217 --- loss: 1.756863, loss_ss: 1.368887, loss_d: 0.387976
0.9601 --- loss: 2.238177, loss_ss: 1.568013, loss_d: 0.670164
0.9985 --- loss: 2.029186, loss_ss: 1.445486, loss_d: 0.583700
Epoch finished! Loss: 1.7254423535787142
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.646007, loss_ss: 1.016106, loss_d: 0.629901
0.0384 --- loss: 1.665466, loss_ss: 0.955646, loss_d: 0.709819
0.0768 --- loss: 1.839967, loss_ss: 1.070039, loss_d: 0.769929
0.1152 --- loss: 1.555215, loss_ss: 1.021485, loss_d: 0.533730
0.1536 --- loss: 1.266633, loss_ss: 0.899271, loss_d: 0.367361
0.1920 --- loss: 1.632256, loss_ss: 1.267710, loss_d: 0.364545
0.2304 --- loss: 1.761866, loss_ss: 1.085897, loss_d: 0.675969
0.2688 --- loss: 1.433980, loss_ss: 0.856373, loss_d: 0.577608
0.3072 --- loss: 1.703259, loss_ss: 0.963935, loss_d: 0.739324
0.3456 --- loss: 1.711466, loss_ss: 1.182875, loss_d: 0.528591
0.3840 --- loss: 1.764808, loss_ss: 0.985539, loss_d: 0.779269
0.4224 --- loss: 1.584720, loss_ss: 1.147849, loss_d: 0.436871
0.4608 --- loss: 2.004591, loss_ss: 1.364161, loss_d: 0.640430
0.4992 --- loss: 1.781057, loss_ss: 1.033597, loss_d: 0.747460
0.5376 --- loss: 1.642376, loss_ss: 0.855038, loss_d: 0.787339
0.5760 --- loss: 1.431106, loss_ss: 0.949995, loss_d: 0.481111
0.6144 --- loss: 1.871797, loss_ss: 1.164338, loss_d: 0.707460
0.6528 --- loss: 1.574106, loss_ss: 0.817268, loss_d: 0.756838
0.6912 --- loss: 1.703318, loss_ss: 1.163983, loss_d: 0.539334
0.7296 --- loss: 1.867998, loss_ss: 1.335498, loss_d: 0.532500
0.7680 --- loss: 1.594692, loss_ss: 1.058830, loss_d: 0.535861
0.8065 --- loss: 1.796919, loss_ss: 1.025753, loss_d: 0.771166
0.8449 --- loss: 1.410047, loss_ss: 1.164024, loss_d: 0.246023
0.8833 --- loss: 1.541994, loss_ss: 0.878432, loss_d: 0.663562
0.9217 --- loss: 1.399030, loss_ss: 0.976987, loss_d: 0.422043
0.9601 --- loss: 1.773807, loss_ss: 1.363657, loss_d: 0.410150
0.9985 --- loss: 1.516735, loss_ss: 1.285184, loss_d: 0.231552
Epoch finished! Loss: 1.642575471676313
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.360708, loss_ss: 0.819601, loss_d: 0.541107
0.0384 --- loss: 1.351752, loss_ss: 1.037737, loss_d: 0.314015
0.0768 --- loss: 1.207666, loss_ss: 0.703781, loss_d: 0.503885
0.1152 --- loss: 1.291521, loss_ss: 0.884806, loss_d: 0.406715
0.1536 --- loss: 1.389294, loss_ss: 0.979796, loss_d: 0.409498
0.1920 --- loss: 1.488950, loss_ss: 0.954943, loss_d: 0.534007
0.2304 --- loss: 1.210546, loss_ss: 0.704370, loss_d: 0.506176
0.2688 --- loss: 1.471668, loss_ss: 1.008918, loss_d: 0.462751
0.3072 --- loss: 1.701605, loss_ss: 1.203037, loss_d: 0.498567
0.3456 --- loss: 1.794383, loss_ss: 1.501420, loss_d: 0.292963
0.3840 --- loss: 1.523464, loss_ss: 1.164552, loss_d: 0.358912
0.4224 --- loss: 1.954854, loss_ss: 1.394470, loss_d: 0.560384
0.4608 --- loss: 1.530339, loss_ss: 0.997709, loss_d: 0.532630
0.4992 --- loss: 1.875426, loss_ss: 1.321212, loss_d: 0.554214
0.5376 --- loss: 1.498979, loss_ss: 0.797231, loss_d: 0.701748
0.5760 --- loss: 1.590332, loss_ss: 0.977127, loss_d: 0.613204
0.6144 --- loss: 2.071214, loss_ss: 1.068670, loss_d: 1.002543
0.6528 --- loss: 1.310465, loss_ss: 0.815901, loss_d: 0.494565
0.6912 --- loss: 1.267449, loss_ss: 0.922934, loss_d: 0.344515
0.7296 --- loss: 1.303895, loss_ss: 0.882216, loss_d: 0.421679
0.7680 --- loss: 1.695812, loss_ss: 1.409836, loss_d: 0.285976
0.8065 --- loss: 1.567282, loss_ss: 0.975499, loss_d: 0.591784
0.8449 --- loss: 1.757562, loss_ss: 1.158767, loss_d: 0.598795
0.8833 --- loss: 1.267784, loss_ss: 0.728854, loss_d: 0.538930
0.9217 --- loss: 1.225974, loss_ss: 0.859562, loss_d: 0.366412
0.9601 --- loss: 1.434856, loss_ss: 1.087167, loss_d: 0.347689
0.9985 --- loss: 2.206130, loss_ss: 0.951204, loss_d: 1.254925
Epoch finished! Loss: 1.5621717787705935
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.374856, loss_ss: 1.055676, loss_d: 0.319181
0.0384 --- loss: 1.323609, loss_ss: 0.939689, loss_d: 0.383920
0.0768 --- loss: 1.244367, loss_ss: 0.920179, loss_d: 0.324189
0.1152 --- loss: 1.282042, loss_ss: 0.966092, loss_d: 0.315950
0.1536 --- loss: 1.406089, loss_ss: 0.949091, loss_d: 0.456998
0.1920 --- loss: 1.715673, loss_ss: 1.108317, loss_d: 0.607356
0.2304 --- loss: 1.673387, loss_ss: 0.851481, loss_d: 0.821906
0.2688 --- loss: 2.224274, loss_ss: 1.179474, loss_d: 1.044800
0.3072 --- loss: 1.837701, loss_ss: 1.410228, loss_d: 0.427474
0.3456 --- loss: 1.290022, loss_ss: 0.981692, loss_d: 0.308330
0.3840 --- loss: 1.315054, loss_ss: 0.980712, loss_d: 0.334342
0.4224 --- loss: 1.581360, loss_ss: 1.075265, loss_d: 0.506095
0.4608 --- loss: 1.639767, loss_ss: 1.236346, loss_d: 0.403420
0.4992 --- loss: 1.366888, loss_ss: 0.969484, loss_d: 0.397404
0.5376 --- loss: 1.070788, loss_ss: 0.699381, loss_d: 0.371407
0.5760 --- loss: 1.491500, loss_ss: 1.061546, loss_d: 0.429954
0.6144 --- loss: 1.385334, loss_ss: 1.243891, loss_d: 0.141443
0.6528 --- loss: 1.586501, loss_ss: 1.133693, loss_d: 0.452808
0.6912 --- loss: 1.092634, loss_ss: 0.856321, loss_d: 0.236313
0.7296 --- loss: 1.656596, loss_ss: 1.111954, loss_d: 0.544642
0.7680 --- loss: 1.841565, loss_ss: 1.261147, loss_d: 0.580418
0.8065 --- loss: 1.656588, loss_ss: 0.729684, loss_d: 0.926904
0.8449 --- loss: 1.324607, loss_ss: 0.880930, loss_d: 0.443677
0.8833 --- loss: 1.374914, loss_ss: 0.943096, loss_d: 0.431818
0.9217 --- loss: 2.384103, loss_ss: 1.331107, loss_d: 1.052996
0.9601 --- loss: 1.436156, loss_ss: 0.936047, loss_d: 0.500108
0.9985 --- loss: 1.551578, loss_ss: 0.963644, loss_d: 0.587934
Epoch finished! Loss: 1.4639200843297517
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.476796, loss_ss: 0.856688, loss_d: 0.620108
0.0384 --- loss: 1.194946, loss_ss: 0.926291, loss_d: 0.268655
0.0768 --- loss: 1.143379, loss_ss: 0.951445, loss_d: 0.191934
0.1152 --- loss: 1.174017, loss_ss: 0.662218, loss_d: 0.511799
0.1536 --- loss: 1.608438, loss_ss: 0.691245, loss_d: 0.917193
0.1920 --- loss: 1.727897, loss_ss: 1.069903, loss_d: 0.657994
0.2304 --- loss: 1.474853, loss_ss: 1.273055, loss_d: 0.201798
0.2688 --- loss: 1.733249, loss_ss: 0.807662, loss_d: 0.925587
0.3072 --- loss: 1.534105, loss_ss: 0.917307, loss_d: 0.616798
0.3456 --- loss: 1.370459, loss_ss: 1.052763, loss_d: 0.317696
0.3840 --- loss: 1.483914, loss_ss: 1.033924, loss_d: 0.449990
0.4224 --- loss: 1.396795, loss_ss: 0.923606, loss_d: 0.473189
0.4608 --- loss: 1.747879, loss_ss: 0.982016, loss_d: 0.765863
0.4992 --- loss: 1.194069, loss_ss: 0.843288, loss_d: 0.350780
0.5376 --- loss: 1.629506, loss_ss: 1.264325, loss_d: 0.365181
0.5760 --- loss: 1.328765, loss_ss: 0.913814, loss_d: 0.414952
0.6144 --- loss: 1.223007, loss_ss: 0.994414, loss_d: 0.228593
0.6528 --- loss: 1.332459, loss_ss: 0.871494, loss_d: 0.460965
0.6912 --- loss: 1.760880, loss_ss: 0.834143, loss_d: 0.926737
0.7296 --- loss: 1.325174, loss_ss: 0.898773, loss_d: 0.426401
0.7680 --- loss: 1.827191, loss_ss: 0.771598, loss_d: 1.055593
0.8065 --- loss: 1.194800, loss_ss: 0.830631, loss_d: 0.364170
0.8449 --- loss: 1.472482, loss_ss: 0.903381, loss_d: 0.569101
0.8833 --- loss: 1.708384, loss_ss: 1.160581, loss_d: 0.547803
0.9217 --- loss: 1.074911, loss_ss: 0.722484, loss_d: 0.352427
0.9601 --- loss: 1.162499, loss_ss: 0.759493, loss_d: 0.403006
0.9985 --- loss: 1.370550, loss_ss: 1.034271, loss_d: 0.336279
Epoch finished! Loss: 1.3820136297207612
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.066890, loss_ss: 0.725898, loss_d: 0.340993
0.0384 --- loss: 1.672845, loss_ss: 1.510201, loss_d: 0.162644
0.0768 --- loss: 1.351713, loss_ss: 1.159130, loss_d: 0.192583
0.1152 --- loss: 1.552686, loss_ss: 1.035893, loss_d: 0.516793
0.1536 --- loss: 1.247195, loss_ss: 0.927651, loss_d: 0.319544
0.1920 --- loss: 1.224298, loss_ss: 1.030644, loss_d: 0.193654
0.2304 --- loss: 1.217166, loss_ss: 0.940682, loss_d: 0.276484
0.2688 --- loss: 1.260898, loss_ss: 1.112027, loss_d: 0.148871
0.3072 --- loss: 1.262492, loss_ss: 0.782739, loss_d: 0.479753
0.3456 --- loss: 1.099117, loss_ss: 0.693975, loss_d: 0.405142
0.3840 --- loss: 0.987906, loss_ss: 0.624056, loss_d: 0.363850
0.4224 --- loss: 0.979636, loss_ss: 0.810992, loss_d: 0.168644
0.4608 --- loss: 0.895219, loss_ss: 0.685454, loss_d: 0.209765
0.4992 --- loss: 0.961286, loss_ss: 0.718305, loss_d: 0.242981
0.5376 --- loss: 1.365668, loss_ss: 1.036739, loss_d: 0.328929
0.5760 --- loss: 1.358550, loss_ss: 1.103166, loss_d: 0.255384
0.6144 --- loss: 1.276774, loss_ss: 0.994856, loss_d: 0.281918
0.6528 --- loss: 1.385836, loss_ss: 1.118091, loss_d: 0.267745
0.6912 --- loss: 1.896859, loss_ss: 1.048443, loss_d: 0.848416
0.7296 --- loss: 1.131661, loss_ss: 0.899156, loss_d: 0.232505
0.7680 --- loss: 1.581869, loss_ss: 1.068079, loss_d: 0.513790
0.8065 --- loss: 1.027078, loss_ss: 0.858149, loss_d: 0.168929
0.8449 --- loss: 1.124777, loss_ss: 0.813830, loss_d: 0.310947
0.8833 --- loss: 1.165830, loss_ss: 0.858814, loss_d: 0.307016
0.9217 --- loss: 1.675932, loss_ss: 0.948366, loss_d: 0.727566
0.9601 --- loss: 1.178778, loss_ss: 0.886590, loss_d: 0.292188
0.9985 --- loss: 1.117728, loss_ss: 0.705110, loss_d: 0.412617
Epoch finished! Loss: 1.305595080439861
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.308986, loss_ss: 0.863280, loss_d: 0.445706
0.0384 --- loss: 1.050874, loss_ss: 0.738713, loss_d: 0.312161
0.0768 --- loss: 1.370298, loss_ss: 0.781562, loss_d: 0.588736
0.1152 --- loss: 1.926913, loss_ss: 1.299673, loss_d: 0.627240
0.1536 --- loss: 1.131498, loss_ss: 0.856544, loss_d: 0.274954
0.1920 --- loss: 0.826701, loss_ss: 0.615153, loss_d: 0.211548
0.2304 --- loss: 0.935336, loss_ss: 0.771660, loss_d: 0.163676
0.2688 --- loss: 1.452245, loss_ss: 1.269377, loss_d: 0.182869
0.3072 --- loss: 1.292734, loss_ss: 0.996871, loss_d: 0.295863
0.3456 --- loss: 1.488627, loss_ss: 0.874817, loss_d: 0.613811
0.3840 --- loss: 1.323130, loss_ss: 1.083981, loss_d: 0.239149
0.4224 --- loss: 1.505310, loss_ss: 0.871138, loss_d: 0.634172
0.4608 --- loss: 1.376757, loss_ss: 1.176825, loss_d: 0.199933
0.4992 --- loss: 1.378795, loss_ss: 0.844233, loss_d: 0.534562
0.5376 --- loss: 1.149999, loss_ss: 0.871007, loss_d: 0.278993
0.5760 --- loss: 1.301544, loss_ss: 1.068403, loss_d: 0.233142
0.6144 --- loss: 1.315448, loss_ss: 1.190195, loss_d: 0.125252
0.6528 --- loss: 1.161187, loss_ss: 0.743309, loss_d: 0.417877
0.6912 --- loss: 1.292775, loss_ss: 0.995230, loss_d: 0.297545
0.7296 --- loss: 1.225618, loss_ss: 0.674508, loss_d: 0.551110
0.7680 --- loss: 1.430953, loss_ss: 1.024583, loss_d: 0.406370
0.8065 --- loss: 1.002189, loss_ss: 0.809868, loss_d: 0.192321
0.8449 --- loss: 1.131123, loss_ss: 0.893426, loss_d: 0.237696
0.8833 --- loss: 1.450221, loss_ss: 1.028627, loss_d: 0.421594
0.9217 --- loss: 1.138740, loss_ss: 0.852091, loss_d: 0.286649
0.9601 --- loss: 1.806732, loss_ss: 1.196162, loss_d: 0.610570
0.9985 --- loss: 1.145843, loss_ss: 0.885427, loss_d: 0.260416
Epoch finished! Loss: 1.2756678730249404
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.070297, loss_ss: 0.928508, loss_d: 0.141789
0.0384 --- loss: 1.149325, loss_ss: 0.847934, loss_d: 0.301390
0.0768 --- loss: 1.041619, loss_ss: 0.850824, loss_d: 0.190795
0.1152 --- loss: 1.353836, loss_ss: 0.902348, loss_d: 0.451488
0.1536 --- loss: 1.378083, loss_ss: 1.216004, loss_d: 0.162079
0.1920 --- loss: 1.892885, loss_ss: 0.982215, loss_d: 0.910670
0.2304 --- loss: 0.961851, loss_ss: 0.721935, loss_d: 0.239917
0.2688 --- loss: 1.081973, loss_ss: 0.807659, loss_d: 0.274314
0.3072 --- loss: 1.059589, loss_ss: 0.773834, loss_d: 0.285755
0.3456 --- loss: 1.254430, loss_ss: 0.967842, loss_d: 0.286588
0.3840 --- loss: 1.296530, loss_ss: 1.049675, loss_d: 0.246855
0.4224 --- loss: 1.369967, loss_ss: 0.942105, loss_d: 0.427862
0.4608 --- loss: 1.084249, loss_ss: 0.967970, loss_d: 0.116279
0.4992 --- loss: 1.002592, loss_ss: 0.755578, loss_d: 0.247014
0.5376 --- loss: 1.467924, loss_ss: 0.862132, loss_d: 0.605792
0.5760 --- loss: 1.259141, loss_ss: 1.033806, loss_d: 0.225335
0.6144 --- loss: 0.934755, loss_ss: 0.734285, loss_d: 0.200470
0.6528 --- loss: 1.959119, loss_ss: 0.958013, loss_d: 1.001106
0.6912 --- loss: 1.030300, loss_ss: 0.838062, loss_d: 0.192238
0.7296 --- loss: 1.471018, loss_ss: 1.285267, loss_d: 0.185752
0.7680 --- loss: 1.052492, loss_ss: 0.856463, loss_d: 0.196029
0.8065 --- loss: 1.394806, loss_ss: 1.027506, loss_d: 0.367299
0.8449 --- loss: 1.354199, loss_ss: 1.263425, loss_d: 0.090774
0.8833 --- loss: 0.868029, loss_ss: 0.764894, loss_d: 0.103135
0.9217 --- loss: 1.039812, loss_ss: 0.879002, loss_d: 0.160810
0.9601 --- loss: 1.055871, loss_ss: 0.816640, loss_d: 0.239231
0.9985 --- loss: 1.074557, loss_ss: 0.953081, loss_d: 0.121476
Epoch finished! Loss: 1.200346075113003
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.168291, loss_ss: 0.891069, loss_d: 0.277222
0.0384 --- loss: 0.635348, loss_ss: 0.550380, loss_d: 0.084968
0.0768 --- loss: 1.251292, loss_ss: 1.062494, loss_d: 0.188798
0.1152 --- loss: 1.257461, loss_ss: 1.054950, loss_d: 0.202511
0.1536 --- loss: 1.255713, loss_ss: 1.140659, loss_d: 0.115054
0.1920 --- loss: 0.812581, loss_ss: 0.681134, loss_d: 0.131447
0.2304 --- loss: 1.000582, loss_ss: 0.866031, loss_d: 0.134551
0.2688 --- loss: 1.352226, loss_ss: 0.952136, loss_d: 0.400090
0.3072 --- loss: 1.332240, loss_ss: 0.897999, loss_d: 0.434241
0.3456 --- loss: 1.210828, loss_ss: 0.894481, loss_d: 0.316347
0.3840 --- loss: 1.238953, loss_ss: 0.758579, loss_d: 0.480374
0.4224 --- loss: 1.127605, loss_ss: 0.797411, loss_d: 0.330194
0.4608 --- loss: 0.993475, loss_ss: 0.777671, loss_d: 0.215805
0.4992 --- loss: 1.111107, loss_ss: 0.944355, loss_d: 0.166752
0.5376 --- loss: 1.154975, loss_ss: 1.018992, loss_d: 0.135983
0.5760 --- loss: 1.025320, loss_ss: 0.821203, loss_d: 0.204117
0.6144 --- loss: 1.052192, loss_ss: 0.877194, loss_d: 0.174998
0.6528 --- loss: 1.372454, loss_ss: 1.159338, loss_d: 0.213116
0.6912 --- loss: 1.280552, loss_ss: 1.120835, loss_d: 0.159718
0.7296 --- loss: 1.121602, loss_ss: 0.999022, loss_d: 0.122580
0.7680 --- loss: 0.813541, loss_ss: 0.725078, loss_d: 0.088463
0.8065 --- loss: 1.557617, loss_ss: 1.011042, loss_d: 0.546575
0.8449 --- loss: 1.117136, loss_ss: 0.997744, loss_d: 0.119392
0.8833 --- loss: 1.000534, loss_ss: 0.846106, loss_d: 0.154428
0.9217 --- loss: 1.081162, loss_ss: 0.921972, loss_d: 0.159190
0.9601 --- loss: 1.145280, loss_ss: 0.677036, loss_d: 0.468244
0.9985 --- loss: 0.857975, loss_ss: 0.763680, loss_d: 0.094295
Epoch finished! Loss: 1.1573933903987592
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7294117647058823
             precision    recall  f1-score   support

        0.0       0.00      0.00      0.00        17
        1.0       0.13      0.03      0.05        62
        2.0       0.71      0.77      0.74       372
        3.0       0.97      0.73      0.83       337
        4.0       0.65      0.91      0.76       232

avg / total       0.74      0.73      0.72      1020
 


====== chp034-nsrr ======

The f1-score of  0  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  95.78   0.00   97.41   0.00      0.00
1  92.84   3.23   98.64  13.33      5.19
2  80.00  76.88   81.79  70.79     73.71
3  90.39  73.00   98.98  97.23     83.39
4  86.86  90.52   85.79  65.22     75.81
Total accuracy: 72.94%
Average sen: 48.72%
Average spec: 92.52%
Macro f1-score: 47.62%
Diagnosis acc on 15mins: 0.47058823529411764
[0.75781852 0.2445614  0.7265166  0.32416064 0.51746088 0.33885446
 0.75892425 0.54145646 0.91368878 0.89677787 0.07919257 0.32436523
 0.64752662 0.27261052 0.26954094 0.22541577 0.25171363 0.34080487
 0.9746806  0.26989815 0.39096385 0.87937272 0.21347468 0.53824687
 0.70041341 0.380299   0.35835183 0.81633055 0.74835217 0.31314451
 0.95701581 0.38282272 0.56696749 0.38008443]
pred: 0.5088767288800549, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp036-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.355677, loss_ss: 1.698497, loss_d: 0.657180
0.0385 --- loss: 2.058616, loss_ss: 1.605888, loss_d: 0.452728
0.0770 --- loss: 2.123851, loss_ss: 1.516118, loss_d: 0.607733
0.1156 --- loss: 2.284189, loss_ss: 1.689741, loss_d: 0.594448
0.1541 --- loss: 2.105594, loss_ss: 1.620689, loss_d: 0.484906
0.1926 --- loss: 2.122468, loss_ss: 1.494188, loss_d: 0.628280
0.2311 --- loss: 2.123090, loss_ss: 1.380641, loss_d: 0.742449
0.2696 --- loss: 2.228317, loss_ss: 1.523936, loss_d: 0.704382
0.3082 --- loss: 2.119822, loss_ss: 1.703892, loss_d: 0.415930
0.3467 --- loss: 1.894786, loss_ss: 1.447832, loss_d: 0.446954
0.3852 --- loss: 1.940549, loss_ss: 1.335845, loss_d: 0.604704
0.4237 --- loss: 2.258052, loss_ss: 1.672617, loss_d: 0.585434
0.4622 --- loss: 2.217285, loss_ss: 1.429113, loss_d: 0.788171
0.5008 --- loss: 1.830370, loss_ss: 1.291808, loss_d: 0.538562
0.5393 --- loss: 2.059726, loss_ss: 1.681659, loss_d: 0.378066
0.5778 --- loss: 2.317606, loss_ss: 1.612524, loss_d: 0.705082
0.6163 --- loss: 2.057525, loss_ss: 1.323144, loss_d: 0.734380
0.6549 --- loss: 1.766650, loss_ss: 1.250095, loss_d: 0.516555
0.6934 --- loss: 1.932287, loss_ss: 1.421513, loss_d: 0.510774
0.7319 --- loss: 2.196914, loss_ss: 1.594692, loss_d: 0.602222
0.7704 --- loss: 2.286089, loss_ss: 1.392999, loss_d: 0.893090
0.8089 --- loss: 2.025569, loss_ss: 1.326592, loss_d: 0.698976
0.8475 --- loss: 2.217844, loss_ss: 1.624565, loss_d: 0.593279
0.8860 --- loss: 1.780500, loss_ss: 1.252185, loss_d: 0.528314
0.9245 --- loss: 1.788567, loss_ss: 1.366112, loss_d: 0.422456
0.9630 --- loss: 1.930884, loss_ss: 1.106527, loss_d: 0.824357
Epoch finished! Loss: 2.0613163102087366
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.754847, loss_ss: 1.117460, loss_d: 0.637387
0.0385 --- loss: 2.126836, loss_ss: 1.497999, loss_d: 0.628837
0.0770 --- loss: 1.540459, loss_ss: 1.117727, loss_d: 0.422731
0.1156 --- loss: 1.768218, loss_ss: 1.291319, loss_d: 0.476898
0.1541 --- loss: 2.079511, loss_ss: 1.214508, loss_d: 0.865003
0.1926 --- loss: 1.729021, loss_ss: 1.103198, loss_d: 0.625823
0.2311 --- loss: 1.749062, loss_ss: 1.284918, loss_d: 0.464144
0.2696 --- loss: 1.590764, loss_ss: 1.092654, loss_d: 0.498110
0.3082 --- loss: 1.556693, loss_ss: 1.293857, loss_d: 0.262836
0.3467 --- loss: 1.635492, loss_ss: 1.202490, loss_d: 0.433002
0.3852 --- loss: 1.945260, loss_ss: 1.203908, loss_d: 0.741351
0.4237 --- loss: 1.695587, loss_ss: 1.183225, loss_d: 0.512361
0.4622 --- loss: 1.330659, loss_ss: 0.926745, loss_d: 0.403914
0.5008 --- loss: 1.730791, loss_ss: 1.162033, loss_d: 0.568757
0.5393 --- loss: 1.751502, loss_ss: 1.189451, loss_d: 0.562051
0.5778 --- loss: 1.917946, loss_ss: 1.231744, loss_d: 0.686202
0.6163 --- loss: 1.863382, loss_ss: 1.159995, loss_d: 0.703387
0.6549 --- loss: 1.524658, loss_ss: 1.058372, loss_d: 0.466286
0.6934 --- loss: 1.825378, loss_ss: 0.979138, loss_d: 0.846240
0.7319 --- loss: 1.724079, loss_ss: 1.165267, loss_d: 0.558812
0.7704 --- loss: 2.077610, loss_ss: 1.346258, loss_d: 0.731352
0.8089 --- loss: 1.847592, loss_ss: 1.196115, loss_d: 0.651478
0.8475 --- loss: 1.803617, loss_ss: 1.280607, loss_d: 0.523009
0.8860 --- loss: 1.748516, loss_ss: 1.165586, loss_d: 0.582930
0.9245 --- loss: 1.895401, loss_ss: 1.108486, loss_d: 0.786915
0.9630 --- loss: 1.538252, loss_ss: 1.134584, loss_d: 0.403668
Epoch finished! Loss: 1.7744544933201263
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.450159, loss_ss: 1.075148, loss_d: 0.375012
0.0385 --- loss: 2.195031, loss_ss: 1.223907, loss_d: 0.971124
0.0770 --- loss: 1.746246, loss_ss: 1.198626, loss_d: 0.547621
0.1156 --- loss: 1.781339, loss_ss: 1.083690, loss_d: 0.697649
0.1541 --- loss: 1.804769, loss_ss: 1.405912, loss_d: 0.398857
0.1926 --- loss: 1.611115, loss_ss: 1.025091, loss_d: 0.586024
0.2311 --- loss: 2.019566, loss_ss: 1.229530, loss_d: 0.790036
0.2696 --- loss: 1.982541, loss_ss: 1.234066, loss_d: 0.748474
0.3082 --- loss: 1.745034, loss_ss: 1.106945, loss_d: 0.638090
0.3467 --- loss: 1.507479, loss_ss: 0.873146, loss_d: 0.634333
0.3852 --- loss: 1.604999, loss_ss: 1.108527, loss_d: 0.496473
0.4237 --- loss: 1.330160, loss_ss: 0.820498, loss_d: 0.509661
0.4622 --- loss: 1.805858, loss_ss: 1.108691, loss_d: 0.697167
0.5008 --- loss: 1.682246, loss_ss: 1.079341, loss_d: 0.602905
0.5393 --- loss: 2.033422, loss_ss: 1.439745, loss_d: 0.593677
0.5778 --- loss: 1.572131, loss_ss: 1.116548, loss_d: 0.455583
0.6163 --- loss: 1.681852, loss_ss: 1.346650, loss_d: 0.335202
0.6549 --- loss: 1.534706, loss_ss: 1.052644, loss_d: 0.482063
0.6934 --- loss: 1.443584, loss_ss: 1.076571, loss_d: 0.367013
0.7319 --- loss: 1.338566, loss_ss: 0.928077, loss_d: 0.410489
0.7704 --- loss: 1.340829, loss_ss: 0.946557, loss_d: 0.394272
0.8089 --- loss: 1.916640, loss_ss: 1.131214, loss_d: 0.785426
0.8475 --- loss: 1.342337, loss_ss: 0.978682, loss_d: 0.363655
0.8860 --- loss: 1.506336, loss_ss: 0.940261, loss_d: 0.566075
0.9245 --- loss: 1.566785, loss_ss: 1.031191, loss_d: 0.535594
0.9630 --- loss: 1.502268, loss_ss: 0.957941, loss_d: 0.544327
Epoch finished! Loss: 1.684205637935506
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.492458, loss_ss: 0.990492, loss_d: 0.501966
0.0385 --- loss: 1.756058, loss_ss: 0.851403, loss_d: 0.904655
0.0770 --- loss: 1.454679, loss_ss: 1.062284, loss_d: 0.392395
0.1156 --- loss: 1.574232, loss_ss: 1.006980, loss_d: 0.567253
0.1541 --- loss: 1.445625, loss_ss: 0.998609, loss_d: 0.447016
0.1926 --- loss: 1.754347, loss_ss: 0.999758, loss_d: 0.754589
0.2311 --- loss: 1.694779, loss_ss: 0.945396, loss_d: 0.749384
0.2696 --- loss: 1.778426, loss_ss: 1.160205, loss_d: 0.618221
0.3082 --- loss: 1.358883, loss_ss: 0.748088, loss_d: 0.610795
0.3467 --- loss: 1.680609, loss_ss: 0.990880, loss_d: 0.689728
0.3852 --- loss: 1.599232, loss_ss: 1.073767, loss_d: 0.525465
0.4237 --- loss: 1.061739, loss_ss: 0.647015, loss_d: 0.414724
0.4622 --- loss: 1.448820, loss_ss: 0.968249, loss_d: 0.480571
0.5008 --- loss: 1.304625, loss_ss: 0.777187, loss_d: 0.527439
0.5393 --- loss: 1.314795, loss_ss: 0.762632, loss_d: 0.552163
0.5778 --- loss: 1.362157, loss_ss: 0.914449, loss_d: 0.447707
0.6163 --- loss: 1.579048, loss_ss: 0.929188, loss_d: 0.649861
0.6549 --- loss: 1.393384, loss_ss: 1.134326, loss_d: 0.259058
0.6934 --- loss: 1.351008, loss_ss: 0.960317, loss_d: 0.390691
0.7319 --- loss: 1.374840, loss_ss: 0.948224, loss_d: 0.426617
0.7704 --- loss: 1.469377, loss_ss: 1.003395, loss_d: 0.465982
0.8089 --- loss: 1.499856, loss_ss: 0.978484, loss_d: 0.521372
0.8475 --- loss: 1.762454, loss_ss: 1.304225, loss_d: 0.458229
0.8860 --- loss: 1.748128, loss_ss: 1.306568, loss_d: 0.441560
0.9245 --- loss: 1.425299, loss_ss: 0.895704, loss_d: 0.529594
0.9630 --- loss: 1.630517, loss_ss: 1.103586, loss_d: 0.526931
Epoch finished! Loss: 1.5932278757389908
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.626019, loss_ss: 1.019284, loss_d: 0.606735
0.0385 --- loss: 1.209008, loss_ss: 0.869718, loss_d: 0.339290
0.0770 --- loss: 1.417378, loss_ss: 1.044417, loss_d: 0.372961
0.1156 --- loss: 1.225506, loss_ss: 0.933893, loss_d: 0.291613
0.1541 --- loss: 1.215735, loss_ss: 0.863001, loss_d: 0.352733
0.1926 --- loss: 1.524897, loss_ss: 1.179461, loss_d: 0.345436
0.2311 --- loss: 1.241868, loss_ss: 0.784566, loss_d: 0.457303
0.2696 --- loss: 1.547930, loss_ss: 0.960850, loss_d: 0.587079
0.3082 --- loss: 1.303417, loss_ss: 0.878485, loss_d: 0.424932
0.3467 --- loss: 1.423475, loss_ss: 0.973967, loss_d: 0.449508
0.3852 --- loss: 1.838613, loss_ss: 1.567821, loss_d: 0.270792
0.4237 --- loss: 1.552101, loss_ss: 0.845690, loss_d: 0.706411
0.4622 --- loss: 1.328165, loss_ss: 0.888927, loss_d: 0.439238
0.5008 --- loss: 1.612872, loss_ss: 1.081298, loss_d: 0.531575
0.5393 --- loss: 2.133747, loss_ss: 1.560654, loss_d: 0.573093
0.5778 --- loss: 1.501963, loss_ss: 0.978960, loss_d: 0.523004
0.6163 --- loss: 1.519761, loss_ss: 1.028230, loss_d: 0.491531
0.6549 --- loss: 1.520394, loss_ss: 1.108180, loss_d: 0.412213
0.6934 --- loss: 1.390694, loss_ss: 0.996730, loss_d: 0.393964
0.7319 --- loss: 1.608328, loss_ss: 1.230599, loss_d: 0.377729
0.7704 --- loss: 1.524088, loss_ss: 0.830585, loss_d: 0.693503
0.8089 --- loss: 1.430614, loss_ss: 1.052161, loss_d: 0.378453
0.8475 --- loss: 1.330348, loss_ss: 0.945348, loss_d: 0.385000
0.8860 --- loss: 1.294417, loss_ss: 0.864840, loss_d: 0.429577
0.9245 --- loss: 1.341426, loss_ss: 1.012921, loss_d: 0.328504
0.9630 --- loss: 1.269302, loss_ss: 0.895573, loss_d: 0.373730
Epoch finished! Loss: 1.4929372836263943
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.647214, loss_ss: 1.066068, loss_d: 0.581146
0.0385 --- loss: 1.696811, loss_ss: 1.351308, loss_d: 0.345503
0.0770 --- loss: 1.422377, loss_ss: 0.725158, loss_d: 0.697219
0.1156 --- loss: 1.531500, loss_ss: 1.021817, loss_d: 0.509683
0.1541 --- loss: 1.434015, loss_ss: 1.053527, loss_d: 0.380487
0.1926 --- loss: 1.021342, loss_ss: 0.858880, loss_d: 0.162462
0.2311 --- loss: 1.319190, loss_ss: 0.818410, loss_d: 0.500780
0.2696 --- loss: 1.073403, loss_ss: 0.820655, loss_d: 0.252748
0.3082 --- loss: 1.824537, loss_ss: 1.370844, loss_d: 0.453693
0.3467 --- loss: 1.448228, loss_ss: 1.089897, loss_d: 0.358331
0.3852 --- loss: 1.257318, loss_ss: 0.855734, loss_d: 0.401585
0.4237 --- loss: 1.369761, loss_ss: 0.854208, loss_d: 0.515553
0.4622 --- loss: 1.616512, loss_ss: 1.158127, loss_d: 0.458385
0.5008 --- loss: 1.423080, loss_ss: 0.987256, loss_d: 0.435823
0.5393 --- loss: 1.401893, loss_ss: 0.793773, loss_d: 0.608120
0.5778 --- loss: 1.396578, loss_ss: 1.084258, loss_d: 0.312320
0.6163 --- loss: 0.864874, loss_ss: 0.664155, loss_d: 0.200719
0.6549 --- loss: 1.340924, loss_ss: 0.813720, loss_d: 0.527204
0.6934 --- loss: 1.575647, loss_ss: 1.157133, loss_d: 0.418515
0.7319 --- loss: 1.254769, loss_ss: 0.799576, loss_d: 0.455192
0.7704 --- loss: 1.043793, loss_ss: 0.729799, loss_d: 0.313994
0.8089 --- loss: 1.436039, loss_ss: 1.066635, loss_d: 0.369405
0.8475 --- loss: 1.354226, loss_ss: 0.876863, loss_d: 0.477363
0.8860 --- loss: 1.810520, loss_ss: 1.444286, loss_d: 0.366234
0.9245 --- loss: 1.081496, loss_ss: 0.837215, loss_d: 0.244282
0.9630 --- loss: 1.200418, loss_ss: 0.864746, loss_d: 0.335673
Epoch finished! Loss: 1.4049672905542676
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.808264, loss_ss: 1.102335, loss_d: 0.705929
0.0385 --- loss: 1.342645, loss_ss: 0.974626, loss_d: 0.368019
0.0770 --- loss: 1.350329, loss_ss: 1.036374, loss_d: 0.313955
0.1156 --- loss: 1.450958, loss_ss: 1.172807, loss_d: 0.278151
0.1541 --- loss: 1.406684, loss_ss: 0.995637, loss_d: 0.411047
0.1926 --- loss: 1.815231, loss_ss: 1.196985, loss_d: 0.618246
0.2311 --- loss: 2.528958, loss_ss: 1.468542, loss_d: 1.060416
0.2696 --- loss: 1.035969, loss_ss: 0.704904, loss_d: 0.331065
0.3082 --- loss: 1.139441, loss_ss: 0.855797, loss_d: 0.283645
0.3467 --- loss: 2.046431, loss_ss: 0.826665, loss_d: 1.219766
0.3852 --- loss: 1.430110, loss_ss: 0.967263, loss_d: 0.462848
0.4237 --- loss: 1.621663, loss_ss: 1.076471, loss_d: 0.545192
0.4622 --- loss: 1.219601, loss_ss: 0.756216, loss_d: 0.463385
0.5008 --- loss: 1.411166, loss_ss: 0.774084, loss_d: 0.637082
0.5393 --- loss: 1.173357, loss_ss: 0.820730, loss_d: 0.352627
0.5778 --- loss: 1.733031, loss_ss: 0.918763, loss_d: 0.814268
0.6163 --- loss: 1.457142, loss_ss: 0.996171, loss_d: 0.460971
0.6549 --- loss: 1.141336, loss_ss: 0.906179, loss_d: 0.235157
0.6934 --- loss: 1.360935, loss_ss: 0.942736, loss_d: 0.418199
0.7319 --- loss: 1.003806, loss_ss: 0.812243, loss_d: 0.191563
0.7704 --- loss: 1.267310, loss_ss: 0.999557, loss_d: 0.267754
0.8089 --- loss: 1.198246, loss_ss: 0.958983, loss_d: 0.239263
0.8475 --- loss: 0.914764, loss_ss: 0.734044, loss_d: 0.180720
0.8860 --- loss: 1.183193, loss_ss: 0.819311, loss_d: 0.363883
0.9245 --- loss: 1.048812, loss_ss: 0.772564, loss_d: 0.276248
0.9630 --- loss: 1.217704, loss_ss: 0.875915, loss_d: 0.341789
Epoch finished! Loss: 1.3456527245551002
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.393573, loss_ss: 1.124256, loss_d: 0.269318
0.0385 --- loss: 1.373254, loss_ss: 0.978514, loss_d: 0.394740
0.0770 --- loss: 1.682318, loss_ss: 0.910829, loss_d: 0.771489
0.1156 --- loss: 1.517652, loss_ss: 1.156805, loss_d: 0.360847
0.1541 --- loss: 1.046345, loss_ss: 0.903594, loss_d: 0.142751
0.1926 --- loss: 1.243254, loss_ss: 0.785180, loss_d: 0.458074
0.2311 --- loss: 1.290482, loss_ss: 0.795418, loss_d: 0.495064
0.2696 --- loss: 1.435163, loss_ss: 0.826921, loss_d: 0.608241
0.3082 --- loss: 1.180334, loss_ss: 0.918592, loss_d: 0.261742
0.3467 --- loss: 1.344657, loss_ss: 0.706661, loss_d: 0.637996
0.3852 --- loss: 1.624191, loss_ss: 1.125542, loss_d: 0.498648
0.4237 --- loss: 1.243501, loss_ss: 0.872432, loss_d: 0.371068
0.4622 --- loss: 1.427006, loss_ss: 1.104334, loss_d: 0.322672
0.5008 --- loss: 1.608614, loss_ss: 0.848897, loss_d: 0.759717
0.5393 --- loss: 1.189457, loss_ss: 1.069659, loss_d: 0.119798
0.5778 --- loss: 0.868722, loss_ss: 0.704117, loss_d: 0.164604
0.6163 --- loss: 1.052334, loss_ss: 0.898697, loss_d: 0.153637
0.6549 --- loss: 0.977879, loss_ss: 0.816666, loss_d: 0.161213
0.6934 --- loss: 1.240625, loss_ss: 1.040956, loss_d: 0.199669
0.7319 --- loss: 1.072153, loss_ss: 0.988965, loss_d: 0.083188
0.7704 --- loss: 1.141310, loss_ss: 0.916566, loss_d: 0.224745
0.8089 --- loss: 1.027476, loss_ss: 0.794303, loss_d: 0.233173
0.8475 --- loss: 1.448174, loss_ss: 1.173549, loss_d: 0.274624
0.8860 --- loss: 0.867554, loss_ss: 0.716274, loss_d: 0.151281
0.9245 --- loss: 1.365378, loss_ss: 1.048016, loss_d: 0.317362
0.9630 --- loss: 1.189901, loss_ss: 0.824338, loss_d: 0.365563
Epoch finished! Loss: 1.27492654024404
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.346826, loss_ss: 0.925109, loss_d: 0.421717
0.0385 --- loss: 0.992216, loss_ss: 0.703296, loss_d: 0.288920
0.0770 --- loss: 0.944045, loss_ss: 0.771331, loss_d: 0.172714
0.1156 --- loss: 1.273660, loss_ss: 1.068517, loss_d: 0.205143
0.1541 --- loss: 1.193746, loss_ss: 0.955883, loss_d: 0.237863
0.1926 --- loss: 1.206529, loss_ss: 0.893200, loss_d: 0.313329
0.2311 --- loss: 1.419357, loss_ss: 1.048867, loss_d: 0.370491
0.2696 --- loss: 1.068422, loss_ss: 0.732319, loss_d: 0.336103
0.3082 --- loss: 2.035239, loss_ss: 1.466408, loss_d: 0.568831
0.3467 --- loss: 1.421057, loss_ss: 1.087822, loss_d: 0.333235
0.3852 --- loss: 1.498467, loss_ss: 1.224250, loss_d: 0.274217
0.4237 --- loss: 0.924693, loss_ss: 0.651859, loss_d: 0.272834
0.4622 --- loss: 1.125851, loss_ss: 0.754632, loss_d: 0.371219
0.5008 --- loss: 1.384130, loss_ss: 1.178386, loss_d: 0.205744
0.5393 --- loss: 0.859456, loss_ss: 0.685001, loss_d: 0.174455
0.5778 --- loss: 1.147174, loss_ss: 0.907517, loss_d: 0.239658
0.6163 --- loss: 0.843322, loss_ss: 0.667090, loss_d: 0.176233
0.6549 --- loss: 1.594868, loss_ss: 0.906798, loss_d: 0.688070
0.6934 --- loss: 1.281242, loss_ss: 0.941660, loss_d: 0.339582
0.7319 --- loss: 1.132614, loss_ss: 0.954398, loss_d: 0.178216
0.7704 --- loss: 0.960659, loss_ss: 0.899614, loss_d: 0.061045
0.8089 --- loss: 1.227245, loss_ss: 0.971752, loss_d: 0.255493
0.8475 --- loss: 1.208583, loss_ss: 0.887540, loss_d: 0.321043
0.8860 --- loss: 1.796269, loss_ss: 1.433961, loss_d: 0.362308
0.9245 --- loss: 1.224852, loss_ss: 0.906001, loss_d: 0.318851
0.9630 --- loss: 0.977342, loss_ss: 0.725195, loss_d: 0.252146
Epoch finished! Loss: 1.2479585512724622
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.920910, loss_ss: 0.712454, loss_d: 0.208456
0.0385 --- loss: 1.182986, loss_ss: 0.975734, loss_d: 0.207252
0.0770 --- loss: 1.170213, loss_ss: 0.914389, loss_d: 0.255824
0.1156 --- loss: 1.102242, loss_ss: 0.875012, loss_d: 0.227229
0.1541 --- loss: 1.449315, loss_ss: 0.944493, loss_d: 0.504821
0.1926 --- loss: 1.050353, loss_ss: 0.815537, loss_d: 0.234816
0.2311 --- loss: 1.495212, loss_ss: 1.096109, loss_d: 0.399102
0.2696 --- loss: 1.275694, loss_ss: 1.151528, loss_d: 0.124166
0.3082 --- loss: 1.235694, loss_ss: 0.999703, loss_d: 0.235991
0.3467 --- loss: 1.007228, loss_ss: 0.849948, loss_d: 0.157281
0.3852 --- loss: 1.305955, loss_ss: 1.005179, loss_d: 0.300776
0.4237 --- loss: 1.170360, loss_ss: 1.016790, loss_d: 0.153570
0.4622 --- loss: 0.874754, loss_ss: 0.723940, loss_d: 0.150815
0.5008 --- loss: 0.964168, loss_ss: 0.773649, loss_d: 0.190519
0.5393 --- loss: 1.212116, loss_ss: 0.897102, loss_d: 0.315014
0.5778 --- loss: 0.901698, loss_ss: 0.714812, loss_d: 0.186886
0.6163 --- loss: 1.402538, loss_ss: 0.945496, loss_d: 0.457042
0.6549 --- loss: 1.107769, loss_ss: 0.982378, loss_d: 0.125391
0.6934 --- loss: 1.294196, loss_ss: 1.047989, loss_d: 0.246207
0.7319 --- loss: 0.789479, loss_ss: 0.576463, loss_d: 0.213016
0.7704 --- loss: 1.370430, loss_ss: 0.954648, loss_d: 0.415782
0.8089 --- loss: 1.146689, loss_ss: 0.888161, loss_d: 0.258528
0.8475 --- loss: 1.101181, loss_ss: 0.877843, loss_d: 0.223337
0.8860 --- loss: 1.174978, loss_ss: 0.995676, loss_d: 0.179302
0.9245 --- loss: 0.822513, loss_ss: 0.554099, loss_d: 0.268414
0.9630 --- loss: 1.196783, loss_ss: 0.638500, loss_d: 0.558283
Epoch finished! Loss: 1.2195086994686641
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6658730158730158
             precision    recall  f1-score   support

        0.0       0.57      0.73      0.64       237
        1.0       0.50      0.01      0.01       167
        2.0       0.87      0.70      0.78       563
        3.0       0.08      0.88      0.14         8
        4.0       0.64      0.93      0.76       285

avg / total       0.71      0.67      0.64      1260
 


====== chp036-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.60  72.57   87.39  57.14     63.94
1  86.75   0.60   99.91  50.00      1.18
2  81.90  69.80   91.68  87.14     77.51
3  93.33  87.50   93.37   7.78     14.29
4  86.59  93.33   84.62  63.94     75.89
Total accuracy: 66.59%
Average sen: 64.76%
Average spec: 91.39%
Macro f1-score: 46.56%
Diagnosis acc on 15mins: 1.0
[0.71259183 0.97610188 0.96884209 0.97729117 0.9707374  0.95669252
 0.96714818 0.98539805 0.97895539 0.98008853 0.97042084 0.98100978
 0.974392   0.98451078 0.9885667  0.93905157 0.95140529 0.93729442
 0.95468259 0.77886772 0.98286325 0.99040353 0.99064386 0.95201731
 0.96713793 0.98127925 0.76775944 0.95500147 0.86854374 0.95611435
 0.97271293 0.97785825 0.96262425 0.97520769 0.9541437  0.98228884
 0.9916448  0.98123538 0.9371047  0.959243   0.94554013 0.59845638]
pred: 0.9424731646265302, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp037-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.406933, loss_ss: 1.739432, loss_d: 0.667501
0.0384 --- loss: 2.178958, loss_ss: 1.605196, loss_d: 0.573763
0.0768 --- loss: 2.165566, loss_ss: 1.687222, loss_d: 0.478344
0.1152 --- loss: 2.172688, loss_ss: 1.578387, loss_d: 0.594301
0.1536 --- loss: 2.014921, loss_ss: 1.446816, loss_d: 0.568105
0.1920 --- loss: 1.928962, loss_ss: 1.498929, loss_d: 0.430033
0.2304 --- loss: 2.199748, loss_ss: 1.512550, loss_d: 0.687198
0.2688 --- loss: 2.556397, loss_ss: 1.605775, loss_d: 0.950623
0.3072 --- loss: 1.964118, loss_ss: 1.350738, loss_d: 0.613381
0.3456 --- loss: 2.081800, loss_ss: 1.356486, loss_d: 0.725314
0.3840 --- loss: 2.221310, loss_ss: 1.704963, loss_d: 0.516347
0.4224 --- loss: 2.112134, loss_ss: 1.490549, loss_d: 0.621585
0.4608 --- loss: 2.084817, loss_ss: 1.507811, loss_d: 0.577006
0.4992 --- loss: 2.173355, loss_ss: 1.491986, loss_d: 0.681369
0.5376 --- loss: 1.757080, loss_ss: 1.237491, loss_d: 0.519589
0.5760 --- loss: 2.047255, loss_ss: 1.524465, loss_d: 0.522789
0.6144 --- loss: 1.749715, loss_ss: 1.284969, loss_d: 0.464745
0.6528 --- loss: 1.895616, loss_ss: 1.290609, loss_d: 0.605007
0.6912 --- loss: 2.407327, loss_ss: 1.565686, loss_d: 0.841641
0.7296 --- loss: 2.310613, loss_ss: 1.459512, loss_d: 0.851101
0.7680 --- loss: 1.892042, loss_ss: 1.330118, loss_d: 0.561924
0.8065 --- loss: 1.501090, loss_ss: 1.176289, loss_d: 0.324801
0.8449 --- loss: 1.959055, loss_ss: 1.462559, loss_d: 0.496497
0.8833 --- loss: 1.709013, loss_ss: 1.198986, loss_d: 0.510026
0.9217 --- loss: 1.499172, loss_ss: 1.124814, loss_d: 0.374357
0.9601 --- loss: 1.775110, loss_ss: 1.115725, loss_d: 0.659386
0.9985 --- loss: 1.820609, loss_ss: 1.370382, loss_d: 0.450227
Epoch finished! Loss: 2.006719265534328
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.835281, loss_ss: 1.273888, loss_d: 0.561393
0.0384 --- loss: 1.694564, loss_ss: 1.401983, loss_d: 0.292581
0.0768 --- loss: 2.196638, loss_ss: 1.071473, loss_d: 1.125164
0.1152 --- loss: 2.059596, loss_ss: 1.552742, loss_d: 0.506854
0.1536 --- loss: 1.973949, loss_ss: 1.347151, loss_d: 0.626799
0.1920 --- loss: 1.621228, loss_ss: 1.144318, loss_d: 0.476911
0.2304 --- loss: 1.403371, loss_ss: 1.082931, loss_d: 0.320440
0.2688 --- loss: 1.830739, loss_ss: 1.297895, loss_d: 0.532844
0.3072 --- loss: 1.782165, loss_ss: 1.217885, loss_d: 0.564280
0.3456 --- loss: 1.795022, loss_ss: 1.391124, loss_d: 0.403898
0.3840 --- loss: 1.593956, loss_ss: 1.276882, loss_d: 0.317074
0.4224 --- loss: 1.782481, loss_ss: 1.303069, loss_d: 0.479412
0.4608 --- loss: 1.890024, loss_ss: 1.283243, loss_d: 0.606781
0.4992 --- loss: 1.845373, loss_ss: 1.084484, loss_d: 0.760889
0.5376 --- loss: 1.907970, loss_ss: 1.324512, loss_d: 0.583458
0.5760 --- loss: 1.926529, loss_ss: 1.138907, loss_d: 0.787622
0.6144 --- loss: 1.542557, loss_ss: 1.143791, loss_d: 0.398766
0.6528 --- loss: 1.708858, loss_ss: 1.020278, loss_d: 0.688580
0.6912 --- loss: 1.654192, loss_ss: 1.057438, loss_d: 0.596754
0.7296 --- loss: 1.663894, loss_ss: 1.289755, loss_d: 0.374139
0.7680 --- loss: 1.856713, loss_ss: 1.258856, loss_d: 0.597857
0.8065 --- loss: 1.350478, loss_ss: 0.849202, loss_d: 0.501276
0.8449 --- loss: 1.315758, loss_ss: 0.899223, loss_d: 0.416535
0.8833 --- loss: 1.499184, loss_ss: 1.092104, loss_d: 0.407080
0.9217 --- loss: 1.574809, loss_ss: 0.955899, loss_d: 0.618909
0.9601 --- loss: 1.254829, loss_ss: 1.013232, loss_d: 0.241596
0.9985 --- loss: 1.558123, loss_ss: 0.899070, loss_d: 0.659053
Epoch finished! Loss: 1.7341731731708234
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.246411, loss_ss: 0.873464, loss_d: 0.372947
0.0384 --- loss: 1.599418, loss_ss: 1.164360, loss_d: 0.435058
0.0768 --- loss: 1.741092, loss_ss: 1.129581, loss_d: 0.611511
0.1152 --- loss: 1.708936, loss_ss: 1.017752, loss_d: 0.691184
0.1536 --- loss: 1.379997, loss_ss: 0.971131, loss_d: 0.408866
0.1920 --- loss: 1.542340, loss_ss: 1.157368, loss_d: 0.384972
0.2304 --- loss: 1.426570, loss_ss: 0.879370, loss_d: 0.547201
0.2688 --- loss: 1.955780, loss_ss: 1.286780, loss_d: 0.669000
0.3072 --- loss: 1.685262, loss_ss: 1.123173, loss_d: 0.562089
0.3456 --- loss: 1.426231, loss_ss: 0.880693, loss_d: 0.545538
0.3840 --- loss: 1.810783, loss_ss: 1.109049, loss_d: 0.701734
0.4224 --- loss: 1.524192, loss_ss: 1.040267, loss_d: 0.483925
0.4608 --- loss: 1.825418, loss_ss: 1.314290, loss_d: 0.511128
0.4992 --- loss: 2.065399, loss_ss: 1.109982, loss_d: 0.955417
0.5376 --- loss: 1.614779, loss_ss: 1.048280, loss_d: 0.566498
0.5760 --- loss: 1.731191, loss_ss: 1.263405, loss_d: 0.467786
0.6144 --- loss: 1.512982, loss_ss: 1.203036, loss_d: 0.309947
0.6528 --- loss: 1.538826, loss_ss: 0.950924, loss_d: 0.587902
0.6912 --- loss: 1.248893, loss_ss: 0.936663, loss_d: 0.312229
0.7296 --- loss: 1.626927, loss_ss: 1.036467, loss_d: 0.590460
0.7680 --- loss: 1.719859, loss_ss: 1.098855, loss_d: 0.621004
0.8065 --- loss: 1.514305, loss_ss: 0.976421, loss_d: 0.537883
0.8449 --- loss: 1.497160, loss_ss: 0.899479, loss_d: 0.597681
0.8833 --- loss: 1.841555, loss_ss: 1.289474, loss_d: 0.552081
0.9217 --- loss: 1.836212, loss_ss: 1.162902, loss_d: 0.673311
0.9601 --- loss: 1.674134, loss_ss: 1.023999, loss_d: 0.650136
0.9985 --- loss: 1.598774, loss_ss: 0.891655, loss_d: 0.707120
Epoch finished! Loss: 1.5694743651610155
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.592602, loss_ss: 0.795444, loss_d: 0.797158
0.0384 --- loss: 1.376528, loss_ss: 0.725154, loss_d: 0.651374
0.0768 --- loss: 1.211567, loss_ss: 0.707509, loss_d: 0.504058
0.1152 --- loss: 1.574024, loss_ss: 0.946027, loss_d: 0.627997
0.1536 --- loss: 1.251370, loss_ss: 0.943152, loss_d: 0.308218
0.1920 --- loss: 1.588756, loss_ss: 1.189413, loss_d: 0.399343
0.2304 --- loss: 1.699101, loss_ss: 1.026829, loss_d: 0.672272
0.2688 --- loss: 1.584516, loss_ss: 1.091091, loss_d: 0.493425
0.3072 --- loss: 1.483404, loss_ss: 1.117048, loss_d: 0.366355
0.3456 --- loss: 1.305842, loss_ss: 0.854936, loss_d: 0.450906
0.3840 --- loss: 1.365404, loss_ss: 0.919938, loss_d: 0.445466
0.4224 --- loss: 1.480587, loss_ss: 0.918116, loss_d: 0.562471
0.4608 --- loss: 1.279260, loss_ss: 0.788596, loss_d: 0.490664
0.4992 --- loss: 1.429945, loss_ss: 0.929997, loss_d: 0.499947
0.5376 --- loss: 1.341193, loss_ss: 0.982764, loss_d: 0.358429
0.5760 --- loss: 1.061595, loss_ss: 0.838465, loss_d: 0.223130
0.6144 --- loss: 1.444535, loss_ss: 0.883308, loss_d: 0.561227
0.6528 --- loss: 1.583504, loss_ss: 0.925129, loss_d: 0.658376
0.6912 --- loss: 1.307411, loss_ss: 0.835411, loss_d: 0.472000
0.7296 --- loss: 1.071836, loss_ss: 0.689940, loss_d: 0.381897
0.7680 --- loss: 1.268760, loss_ss: 0.917240, loss_d: 0.351520
0.8065 --- loss: 1.406324, loss_ss: 1.232283, loss_d: 0.174041
0.8449 --- loss: 1.461920, loss_ss: 0.938955, loss_d: 0.522965
0.8833 --- loss: 1.590891, loss_ss: 0.939152, loss_d: 0.651739
0.9217 --- loss: 1.691045, loss_ss: 1.029790, loss_d: 0.661255
0.9601 --- loss: 1.520716, loss_ss: 0.996219, loss_d: 0.524497
0.9985 --- loss: 1.719617, loss_ss: 1.399639, loss_d: 0.319977
Epoch finished! Loss: 1.4628415417212706
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.804466, loss_ss: 1.315598, loss_d: 0.488868
0.0384 --- loss: 1.077902, loss_ss: 0.650846, loss_d: 0.427056
0.0768 --- loss: 1.873463, loss_ss: 1.093008, loss_d: 0.780455
0.1152 --- loss: 1.298561, loss_ss: 0.912251, loss_d: 0.386310
0.1536 --- loss: 1.615817, loss_ss: 0.827364, loss_d: 0.788453
0.1920 --- loss: 1.389395, loss_ss: 1.002689, loss_d: 0.386706
0.2304 --- loss: 1.579098, loss_ss: 0.823445, loss_d: 0.755653
0.2688 --- loss: 1.049357, loss_ss: 0.748204, loss_d: 0.301153
0.3072 --- loss: 1.168949, loss_ss: 0.898684, loss_d: 0.270264
0.3456 --- loss: 1.085755, loss_ss: 0.785048, loss_d: 0.300707
0.3840 --- loss: 1.307554, loss_ss: 0.782184, loss_d: 0.525371
0.4224 --- loss: 1.729852, loss_ss: 1.003223, loss_d: 0.726629
0.4608 --- loss: 1.357512, loss_ss: 0.982882, loss_d: 0.374630
0.4992 --- loss: 1.364647, loss_ss: 1.016046, loss_d: 0.348601
0.5376 --- loss: 1.581730, loss_ss: 0.679480, loss_d: 0.902250
0.5760 --- loss: 1.508392, loss_ss: 0.961126, loss_d: 0.547266
0.6144 --- loss: 1.294521, loss_ss: 0.727349, loss_d: 0.567172
0.6528 --- loss: 1.677523, loss_ss: 1.020077, loss_d: 0.657446
0.6912 --- loss: 1.247060, loss_ss: 0.935651, loss_d: 0.311409
0.7296 --- loss: 1.726857, loss_ss: 1.015282, loss_d: 0.711575
0.7680 --- loss: 1.123852, loss_ss: 0.830120, loss_d: 0.293732
0.8065 --- loss: 1.232787, loss_ss: 0.997017, loss_d: 0.235770
0.8449 --- loss: 1.066200, loss_ss: 0.869210, loss_d: 0.196991
0.8833 --- loss: 1.371584, loss_ss: 1.062209, loss_d: 0.309375
0.9217 --- loss: 1.306853, loss_ss: 0.906334, loss_d: 0.400519
0.9601 --- loss: 1.485785, loss_ss: 1.093641, loss_d: 0.392144
0.9985 --- loss: 1.824699, loss_ss: 1.237177, loss_d: 0.587522
Epoch finished! Loss: 1.4202216217151056
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.058774, loss_ss: 0.710379, loss_d: 0.348395
0.0384 --- loss: 1.186603, loss_ss: 0.835910, loss_d: 0.350693
0.0768 --- loss: 1.178771, loss_ss: 0.903249, loss_d: 0.275522
0.1152 --- loss: 1.275080, loss_ss: 0.841689, loss_d: 0.433391
0.1536 --- loss: 1.280546, loss_ss: 0.938706, loss_d: 0.341840
0.1920 --- loss: 1.663100, loss_ss: 0.726401, loss_d: 0.936699
0.2304 --- loss: 1.407963, loss_ss: 1.084139, loss_d: 0.323825
0.2688 --- loss: 1.373963, loss_ss: 0.753262, loss_d: 0.620701
0.3072 --- loss: 1.505890, loss_ss: 0.954874, loss_d: 0.551015
0.3456 --- loss: 1.474320, loss_ss: 1.188683, loss_d: 0.285637
0.3840 --- loss: 1.690387, loss_ss: 0.722079, loss_d: 0.968308
0.4224 --- loss: 0.963190, loss_ss: 0.644116, loss_d: 0.319074
0.4608 --- loss: 1.167745, loss_ss: 0.830063, loss_d: 0.337682
0.4992 --- loss: 1.108920, loss_ss: 0.768373, loss_d: 0.340547
0.5376 --- loss: 1.394322, loss_ss: 0.835503, loss_d: 0.558819
0.5760 --- loss: 1.078081, loss_ss: 0.675169, loss_d: 0.402913
0.6144 --- loss: 1.801824, loss_ss: 1.139274, loss_d: 0.662549
0.6528 --- loss: 1.511360, loss_ss: 1.044778, loss_d: 0.466581
0.6912 --- loss: 1.183584, loss_ss: 0.757325, loss_d: 0.426259
0.7296 --- loss: 1.415952, loss_ss: 0.809125, loss_d: 0.606827
0.7680 --- loss: 1.202644, loss_ss: 0.748635, loss_d: 0.454010
0.8065 --- loss: 1.029557, loss_ss: 0.729760, loss_d: 0.299798
0.8449 --- loss: 1.110452, loss_ss: 0.939147, loss_d: 0.171305
0.8833 --- loss: 1.528052, loss_ss: 1.130592, loss_d: 0.397460
0.9217 --- loss: 1.506951, loss_ss: 0.980149, loss_d: 0.526802
0.9601 --- loss: 1.028098, loss_ss: 0.727404, loss_d: 0.300694
0.9985 --- loss: 1.633890, loss_ss: 1.277282, loss_d: 0.356608
Epoch finished! Loss: 1.3673883403723057
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.591850, loss_ss: 0.994798, loss_d: 0.597052
0.0384 --- loss: 1.378839, loss_ss: 0.812803, loss_d: 0.566036
0.0768 --- loss: 1.222323, loss_ss: 1.056462, loss_d: 0.165861
0.1152 --- loss: 1.781209, loss_ss: 1.030806, loss_d: 0.750403
0.1536 --- loss: 0.987102, loss_ss: 0.649395, loss_d: 0.337706
0.1920 --- loss: 1.850972, loss_ss: 1.283573, loss_d: 0.567399
0.2304 --- loss: 1.130710, loss_ss: 0.859861, loss_d: 0.270849
0.2688 --- loss: 1.387041, loss_ss: 0.798515, loss_d: 0.588525
0.3072 --- loss: 1.553923, loss_ss: 0.980717, loss_d: 0.573206
0.3456 --- loss: 1.292976, loss_ss: 1.097322, loss_d: 0.195654
0.3840 --- loss: 1.518469, loss_ss: 1.265286, loss_d: 0.253183
0.4224 --- loss: 1.312999, loss_ss: 0.776477, loss_d: 0.536523
0.4608 --- loss: 1.477102, loss_ss: 0.922587, loss_d: 0.554515
0.4992 --- loss: 1.856619, loss_ss: 0.695764, loss_d: 1.160854
0.5376 --- loss: 1.225136, loss_ss: 0.809399, loss_d: 0.415737
0.5760 --- loss: 1.218496, loss_ss: 0.771677, loss_d: 0.446820
0.6144 --- loss: 1.141740, loss_ss: 0.683890, loss_d: 0.457850
0.6528 --- loss: 1.232164, loss_ss: 0.767603, loss_d: 0.464561
0.6912 --- loss: 0.965991, loss_ss: 0.754015, loss_d: 0.211976
0.7296 --- loss: 1.632461, loss_ss: 0.931219, loss_d: 0.701242
0.7680 --- loss: 1.250839, loss_ss: 0.739986, loss_d: 0.510853
0.8065 --- loss: 1.393302, loss_ss: 0.960784, loss_d: 0.432518
0.8449 --- loss: 1.791205, loss_ss: 1.211720, loss_d: 0.579485
0.8833 --- loss: 1.063346, loss_ss: 0.876925, loss_d: 0.186421
0.9217 --- loss: 1.113799, loss_ss: 0.808829, loss_d: 0.304971
0.9601 --- loss: 0.927248, loss_ss: 0.765753, loss_d: 0.161495
0.9985 --- loss: 2.367076, loss_ss: 0.894098, loss_d: 1.472978
Epoch finished! Loss: 1.3147889043276126
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.068407, loss_ss: 0.876966, loss_d: 0.191441
0.0384 --- loss: 1.292042, loss_ss: 0.896694, loss_d: 0.395348
0.0768 --- loss: 1.544494, loss_ss: 1.073357, loss_d: 0.471137
0.1152 --- loss: 1.378671, loss_ss: 0.970814, loss_d: 0.407857
0.1536 --- loss: 0.853009, loss_ss: 0.611412, loss_d: 0.241597
0.1920 --- loss: 1.099658, loss_ss: 0.877317, loss_d: 0.222341
0.2304 --- loss: 1.167455, loss_ss: 0.830683, loss_d: 0.336773
0.2688 --- loss: 1.303732, loss_ss: 0.923205, loss_d: 0.380527
0.3072 --- loss: 0.971615, loss_ss: 0.759284, loss_d: 0.212331
0.3456 --- loss: 1.314817, loss_ss: 1.097417, loss_d: 0.217400
0.3840 --- loss: 1.121888, loss_ss: 0.910841, loss_d: 0.211047
0.4224 --- loss: 1.537978, loss_ss: 0.910993, loss_d: 0.626985
0.4608 --- loss: 0.900609, loss_ss: 0.706879, loss_d: 0.193731
0.4992 --- loss: 1.473210, loss_ss: 0.990077, loss_d: 0.483132
0.5376 --- loss: 0.947399, loss_ss: 0.782918, loss_d: 0.164481
0.5760 --- loss: 0.991668, loss_ss: 0.811548, loss_d: 0.180120
0.6144 --- loss: 1.006020, loss_ss: 0.838773, loss_d: 0.167247
0.6528 --- loss: 0.891919, loss_ss: 0.604969, loss_d: 0.286949
0.6912 --- loss: 1.189968, loss_ss: 0.754554, loss_d: 0.435413
0.7296 --- loss: 1.406538, loss_ss: 1.026525, loss_d: 0.380013
0.7680 --- loss: 1.270248, loss_ss: 0.815364, loss_d: 0.454884
0.8065 --- loss: 1.417593, loss_ss: 1.184691, loss_d: 0.232901
0.8449 --- loss: 1.232015, loss_ss: 0.749714, loss_d: 0.482301
0.8833 --- loss: 1.774316, loss_ss: 1.146154, loss_d: 0.628162
0.9217 --- loss: 1.004180, loss_ss: 0.666440, loss_d: 0.337741
0.9601 --- loss: 1.346329, loss_ss: 1.160607, loss_d: 0.185722
0.9985 --- loss: 1.386590, loss_ss: 1.043372, loss_d: 0.343218
Epoch finished! Loss: 1.2374417593845954
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.932702, loss_ss: 0.743989, loss_d: 0.188714
0.0384 --- loss: 1.514851, loss_ss: 0.911371, loss_d: 0.603480
0.0768 --- loss: 1.136311, loss_ss: 0.899908, loss_d: 0.236403
0.1152 --- loss: 1.592195, loss_ss: 1.153806, loss_d: 0.438389
0.1536 --- loss: 1.250906, loss_ss: 0.745352, loss_d: 0.505554
0.1920 --- loss: 1.378622, loss_ss: 0.994430, loss_d: 0.384192
0.2304 --- loss: 1.711290, loss_ss: 1.117459, loss_d: 0.593831
0.2688 --- loss: 1.429573, loss_ss: 0.947725, loss_d: 0.481847
0.3072 --- loss: 1.423065, loss_ss: 0.880604, loss_d: 0.542461
0.3456 --- loss: 1.097651, loss_ss: 0.848653, loss_d: 0.248998
0.3840 --- loss: 1.209558, loss_ss: 0.780121, loss_d: 0.429436
0.4224 --- loss: 1.073536, loss_ss: 0.744653, loss_d: 0.328882
0.4608 --- loss: 1.274040, loss_ss: 0.826745, loss_d: 0.447296
0.4992 --- loss: 1.083980, loss_ss: 0.886337, loss_d: 0.197642
0.5376 --- loss: 2.035361, loss_ss: 0.864335, loss_d: 1.171026
0.5760 --- loss: 1.055982, loss_ss: 0.833543, loss_d: 0.222439
0.6144 --- loss: 1.672952, loss_ss: 0.886620, loss_d: 0.786332
0.6528 --- loss: 1.092993, loss_ss: 0.607954, loss_d: 0.485039
0.6912 --- loss: 1.212194, loss_ss: 0.873129, loss_d: 0.339065
0.7296 --- loss: 1.233385, loss_ss: 1.040071, loss_d: 0.193315
0.7680 --- loss: 0.987089, loss_ss: 0.786449, loss_d: 0.200640
0.8065 --- loss: 0.906671, loss_ss: 0.663024, loss_d: 0.243647
0.8449 --- loss: 1.151608, loss_ss: 0.984709, loss_d: 0.166898
0.8833 --- loss: 1.395590, loss_ss: 1.177174, loss_d: 0.218416
0.9217 --- loss: 1.071710, loss_ss: 0.754647, loss_d: 0.317064
0.9601 --- loss: 1.190230, loss_ss: 0.754851, loss_d: 0.435379
0.9985 --- loss: 1.955904, loss_ss: 1.410474, loss_d: 0.545430
Epoch finished! Loss: 1.2132312955764624
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.378110, loss_ss: 0.829375, loss_d: 0.548735
0.0384 --- loss: 1.562770, loss_ss: 1.107374, loss_d: 0.455396
0.0768 --- loss: 1.161126, loss_ss: 0.815889, loss_d: 0.345237
0.1152 --- loss: 1.404193, loss_ss: 0.874109, loss_d: 0.530084
0.1536 --- loss: 1.480242, loss_ss: 1.121898, loss_d: 0.358344
0.1920 --- loss: 1.378576, loss_ss: 1.118111, loss_d: 0.260465
0.2304 --- loss: 0.789685, loss_ss: 0.523686, loss_d: 0.265999
0.2688 --- loss: 0.899426, loss_ss: 0.680056, loss_d: 0.219370
0.3072 --- loss: 1.425077, loss_ss: 1.074674, loss_d: 0.350403
0.3456 --- loss: 1.237849, loss_ss: 1.053938, loss_d: 0.183911
0.3840 --- loss: 1.235936, loss_ss: 0.899589, loss_d: 0.336347
0.4224 --- loss: 1.066493, loss_ss: 0.939365, loss_d: 0.127127
0.4608 --- loss: 0.984631, loss_ss: 0.714709, loss_d: 0.269922
0.4992 --- loss: 0.794547, loss_ss: 0.682133, loss_d: 0.112414
0.5376 --- loss: 1.395258, loss_ss: 0.880141, loss_d: 0.515117
0.5760 --- loss: 1.089206, loss_ss: 0.922228, loss_d: 0.166978
0.6144 --- loss: 0.886894, loss_ss: 0.744104, loss_d: 0.142790
0.6528 --- loss: 1.169867, loss_ss: 1.017653, loss_d: 0.152214
0.6912 --- loss: 0.734214, loss_ss: 0.617906, loss_d: 0.116308
0.7296 --- loss: 1.045923, loss_ss: 0.912003, loss_d: 0.133921
0.7680 --- loss: 1.335937, loss_ss: 0.611042, loss_d: 0.724895
0.8065 --- loss: 1.496337, loss_ss: 0.996197, loss_d: 0.500140
0.8449 --- loss: 1.175602, loss_ss: 0.686628, loss_d: 0.488975
0.8833 --- loss: 1.049122, loss_ss: 0.803112, loss_d: 0.246010
0.9217 --- loss: 0.958442, loss_ss: 0.662418, loss_d: 0.296023
0.9601 --- loss: 0.902450, loss_ss: 0.779462, loss_d: 0.122988
0.9985 --- loss: 0.898955, loss_ss: 0.532211, loss_d: 0.366744
Epoch finished! Loss: 1.177256039243478
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5667976424361493
             precision    recall  f1-score   support

        0.0       0.71      0.43      0.54       197
        1.0       0.22      0.19      0.20       161
        2.0       0.69      0.51      0.59       348
        3.0       0.98      0.89      0.93       208
        4.0       0.31      0.94      0.47       104

avg / total       0.64      0.57      0.58      1018
 


====== chp037-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.66  43.15   95.86  71.43     53.80
1  76.72  18.63   87.63  22.06     20.20
2  75.54  51.44   88.06  69.11     58.98
3  97.35  88.94   99.51  97.88     93.20
4  78.09  94.23   76.26  31.11     46.78
Total accuracy: 56.68%
Average sen: 59.28%
Average spec: 89.46%
Macro f1-score: 54.59%
Diagnosis acc on 15mins: 0.5
[0.2042447  0.47263128 0.89417899 0.80570161 0.99551791 0.91556048
 0.18627587 0.17835598 0.98543918 0.1832528  0.8457467  0.8700124
 0.34777275 0.9763906  0.65047693 0.31512341 0.35227165 0.91370988
 0.64041191 0.22238958 0.89185482 0.929205   0.22116925 0.92825729
 0.33254215 0.10221465 0.95489401 0.37214896 0.25584602 0.34636933
 0.24248168 0.57937866 0.18298936 0.66269356]
pred: 0.5575738040839925, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp038-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.281802, loss_ss: 1.559787, loss_d: 0.722015
0.0384 --- loss: 1.982095, loss_ss: 1.358301, loss_d: 0.623794
0.0768 --- loss: 2.070011, loss_ss: 1.522845, loss_d: 0.547166
0.1152 --- loss: 1.969011, loss_ss: 1.497441, loss_d: 0.471570
0.1536 --- loss: 2.234729, loss_ss: 1.555372, loss_d: 0.679356
0.1920 --- loss: 1.930204, loss_ss: 1.654658, loss_d: 0.275545
0.2304 --- loss: 2.020606, loss_ss: 1.513259, loss_d: 0.507346
0.2688 --- loss: 2.163155, loss_ss: 1.349061, loss_d: 0.814093
0.3072 --- loss: 2.060269, loss_ss: 1.393436, loss_d: 0.666833
0.3456 --- loss: 1.893031, loss_ss: 1.297075, loss_d: 0.595957
0.3840 --- loss: 2.237090, loss_ss: 1.416770, loss_d: 0.820320
0.4224 --- loss: 1.960863, loss_ss: 1.183221, loss_d: 0.777642
0.4608 --- loss: 2.204480, loss_ss: 1.327804, loss_d: 0.876676
0.4992 --- loss: 1.856020, loss_ss: 1.442620, loss_d: 0.413401
0.5376 --- loss: 1.694093, loss_ss: 1.079545, loss_d: 0.614547
0.5760 --- loss: 1.848279, loss_ss: 1.184843, loss_d: 0.663436
0.6144 --- loss: 1.695552, loss_ss: 1.190448, loss_d: 0.505104
0.6528 --- loss: 2.040617, loss_ss: 1.409444, loss_d: 0.631172
0.6912 --- loss: 1.909566, loss_ss: 1.217761, loss_d: 0.691805
0.7296 --- loss: 1.915270, loss_ss: 1.289026, loss_d: 0.626244
0.7680 --- loss: 1.740492, loss_ss: 1.191303, loss_d: 0.549189
0.8065 --- loss: 1.819070, loss_ss: 1.171211, loss_d: 0.647859
0.8449 --- loss: 1.972283, loss_ss: 1.233162, loss_d: 0.739122
0.8833 --- loss: 1.794955, loss_ss: 1.458113, loss_d: 0.336843
0.9217 --- loss: 1.523439, loss_ss: 0.971827, loss_d: 0.551612
0.9601 --- loss: 2.002383, loss_ss: 1.206391, loss_d: 0.795992
0.9985 --- loss: 1.455659, loss_ss: 1.127964, loss_d: 0.327695
Epoch finished! Loss: 1.9062000980743996
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 2.025517, loss_ss: 1.545289, loss_d: 0.480228
0.0384 --- loss: 1.858812, loss_ss: 1.091797, loss_d: 0.767014
0.0768 --- loss: 1.837816, loss_ss: 1.389269, loss_d: 0.448548
0.1152 --- loss: 1.645870, loss_ss: 1.069906, loss_d: 0.575964
0.1536 --- loss: 1.591203, loss_ss: 1.110725, loss_d: 0.480478
0.1920 --- loss: 1.732212, loss_ss: 1.220536, loss_d: 0.511676
0.2304 --- loss: 1.564804, loss_ss: 1.012518, loss_d: 0.552287
0.2688 --- loss: 1.703327, loss_ss: 1.044747, loss_d: 0.658581
0.3072 --- loss: 1.933752, loss_ss: 1.422351, loss_d: 0.511401
0.3456 --- loss: 2.295089, loss_ss: 1.867058, loss_d: 0.428030
0.3840 --- loss: 1.384065, loss_ss: 1.020157, loss_d: 0.363907
0.4224 --- loss: 1.813206, loss_ss: 1.213209, loss_d: 0.599997
0.4608 --- loss: 1.607227, loss_ss: 0.902139, loss_d: 0.705087
0.4992 --- loss: 1.624563, loss_ss: 0.979223, loss_d: 0.645341
0.5376 --- loss: 1.520302, loss_ss: 0.870911, loss_d: 0.649391
0.5760 --- loss: 1.701442, loss_ss: 1.349050, loss_d: 0.352392
0.6144 --- loss: 1.551846, loss_ss: 1.251071, loss_d: 0.300775
0.6528 --- loss: 1.674674, loss_ss: 1.186427, loss_d: 0.488248
0.6912 --- loss: 1.679103, loss_ss: 1.257372, loss_d: 0.421731
0.7296 --- loss: 1.716891, loss_ss: 0.937550, loss_d: 0.779341
0.7680 --- loss: 1.746369, loss_ss: 1.166570, loss_d: 0.579799
0.8065 --- loss: 1.961051, loss_ss: 1.060442, loss_d: 0.900608
0.8449 --- loss: 1.657939, loss_ss: 0.949580, loss_d: 0.708359
0.8833 --- loss: 1.426237, loss_ss: 0.962862, loss_d: 0.463376
0.9217 --- loss: 1.335950, loss_ss: 0.944254, loss_d: 0.391695
0.9601 --- loss: 1.900188, loss_ss: 1.376080, loss_d: 0.524108
0.9985 --- loss: 1.185852, loss_ss: 0.864183, loss_d: 0.321669
Epoch finished! Loss: 1.7298453014630537
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.470635, loss_ss: 0.872503, loss_d: 0.598132
0.0384 --- loss: 1.600523, loss_ss: 1.031715, loss_d: 0.568808
0.0768 --- loss: 1.617754, loss_ss: 1.122475, loss_d: 0.495279
0.1152 --- loss: 1.569616, loss_ss: 1.142500, loss_d: 0.427117
0.1536 --- loss: 1.470885, loss_ss: 0.935771, loss_d: 0.535114
0.1920 --- loss: 1.563493, loss_ss: 1.145349, loss_d: 0.418144
0.2304 --- loss: 1.414008, loss_ss: 0.974663, loss_d: 0.439345
0.2688 --- loss: 1.320802, loss_ss: 1.017549, loss_d: 0.303253
0.3072 --- loss: 1.523296, loss_ss: 1.143509, loss_d: 0.379787
0.3456 --- loss: 1.484958, loss_ss: 1.194527, loss_d: 0.290431
0.3840 --- loss: 1.696649, loss_ss: 1.172586, loss_d: 0.524063
0.4224 --- loss: 1.362506, loss_ss: 0.989704, loss_d: 0.372802
0.4608 --- loss: 1.305590, loss_ss: 0.948221, loss_d: 0.357369
0.4992 --- loss: 1.441162, loss_ss: 0.921284, loss_d: 0.519878
0.5376 --- loss: 1.718715, loss_ss: 1.249416, loss_d: 0.469299
0.5760 --- loss: 1.499711, loss_ss: 1.013662, loss_d: 0.486049
0.6144 --- loss: 1.565761, loss_ss: 1.225915, loss_d: 0.339846
0.6528 --- loss: 1.449329, loss_ss: 1.101846, loss_d: 0.347482
0.6912 --- loss: 1.636648, loss_ss: 1.131186, loss_d: 0.505462
0.7296 --- loss: 1.089268, loss_ss: 0.847532, loss_d: 0.241736
0.7680 --- loss: 1.752197, loss_ss: 1.339448, loss_d: 0.412749
0.8065 --- loss: 1.532570, loss_ss: 0.982857, loss_d: 0.549714
0.8449 --- loss: 1.475155, loss_ss: 1.190683, loss_d: 0.284472
0.8833 --- loss: 1.650372, loss_ss: 1.141833, loss_d: 0.508539
0.9217 --- loss: 1.599895, loss_ss: 0.966123, loss_d: 0.633772
0.9601 --- loss: 1.393229, loss_ss: 0.941258, loss_d: 0.451971
0.9985 --- loss: 1.836003, loss_ss: 1.483420, loss_d: 0.352583
Epoch finished! Loss: 1.610808774141165
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.599367, loss_ss: 0.893298, loss_d: 0.706069
0.0384 --- loss: 1.305514, loss_ss: 0.947366, loss_d: 0.358148
0.0768 --- loss: 1.819101, loss_ss: 1.113013, loss_d: 0.706088
0.1152 --- loss: 1.617225, loss_ss: 1.116103, loss_d: 0.501123
0.1536 --- loss: 1.241862, loss_ss: 0.946054, loss_d: 0.295809
0.1920 --- loss: 1.733317, loss_ss: 1.063083, loss_d: 0.670234
0.2304 --- loss: 1.025805, loss_ss: 0.737947, loss_d: 0.287858
0.2688 --- loss: 1.451744, loss_ss: 0.905993, loss_d: 0.545751
0.3072 --- loss: 1.669391, loss_ss: 1.362857, loss_d: 0.306534
0.3456 --- loss: 1.453402, loss_ss: 0.890707, loss_d: 0.562695
0.3840 --- loss: 1.549241, loss_ss: 0.854780, loss_d: 0.694461
0.4224 --- loss: 1.332308, loss_ss: 0.934207, loss_d: 0.398101
0.4608 --- loss: 1.836903, loss_ss: 1.009396, loss_d: 0.827507
0.4992 --- loss: 1.348466, loss_ss: 0.833347, loss_d: 0.515119
0.5376 --- loss: 1.339636, loss_ss: 0.979940, loss_d: 0.359697
0.5760 --- loss: 1.977664, loss_ss: 1.114739, loss_d: 0.862925
0.6144 --- loss: 1.496815, loss_ss: 0.813284, loss_d: 0.683531
0.6528 --- loss: 1.505224, loss_ss: 1.149044, loss_d: 0.356180
0.6912 --- loss: 1.541825, loss_ss: 1.009889, loss_d: 0.531936
0.7296 --- loss: 1.478902, loss_ss: 1.272392, loss_d: 0.206510
0.7680 --- loss: 1.512263, loss_ss: 1.115944, loss_d: 0.396319
0.8065 --- loss: 0.973614, loss_ss: 0.752916, loss_d: 0.220699
0.8449 --- loss: 1.058114, loss_ss: 0.858375, loss_d: 0.199740
0.8833 --- loss: 1.233471, loss_ss: 0.732584, loss_d: 0.500887
0.9217 --- loss: 1.539911, loss_ss: 0.974429, loss_d: 0.565482
0.9601 --- loss: 1.762254, loss_ss: 0.978117, loss_d: 0.784137
0.9985 --- loss: 1.398865, loss_ss: 1.232614, loss_d: 0.166251
Epoch finished! Loss: 1.514137243766051
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.222504, loss_ss: 0.936225, loss_d: 0.286279
0.0384 --- loss: 1.743913, loss_ss: 0.976626, loss_d: 0.767286
0.0768 --- loss: 1.311414, loss_ss: 0.971192, loss_d: 0.340222
0.1152 --- loss: 1.927796, loss_ss: 1.100006, loss_d: 0.827790
0.1536 --- loss: 1.289359, loss_ss: 0.848795, loss_d: 0.440564
0.1920 --- loss: 1.219509, loss_ss: 0.844520, loss_d: 0.374989
0.2304 --- loss: 1.459225, loss_ss: 1.140612, loss_d: 0.318613
0.2688 --- loss: 1.409455, loss_ss: 0.913253, loss_d: 0.496202
0.3072 --- loss: 1.679258, loss_ss: 0.756959, loss_d: 0.922300
0.3456 --- loss: 1.754052, loss_ss: 0.985757, loss_d: 0.768295
0.3840 --- loss: 1.582595, loss_ss: 0.986983, loss_d: 0.595612
0.4224 --- loss: 1.413772, loss_ss: 0.919318, loss_d: 0.494454
0.4608 --- loss: 1.531157, loss_ss: 1.169136, loss_d: 0.362021
0.4992 --- loss: 1.417603, loss_ss: 1.005822, loss_d: 0.411781
0.5376 --- loss: 1.214994, loss_ss: 0.983090, loss_d: 0.231904
0.5760 --- loss: 1.066287, loss_ss: 0.814947, loss_d: 0.251339
0.6144 --- loss: 1.347493, loss_ss: 1.184558, loss_d: 0.162935
0.6528 --- loss: 1.135466, loss_ss: 0.877908, loss_d: 0.257559
0.6912 --- loss: 1.827966, loss_ss: 1.096650, loss_d: 0.731316
0.7296 --- loss: 1.279853, loss_ss: 0.944800, loss_d: 0.335054
0.7680 --- loss: 1.339329, loss_ss: 0.830628, loss_d: 0.508701
0.8065 --- loss: 1.609826, loss_ss: 0.900987, loss_d: 0.708840
0.8449 --- loss: 1.236810, loss_ss: 0.890878, loss_d: 0.345932
0.8833 --- loss: 1.281017, loss_ss: 0.815510, loss_d: 0.465506
0.9217 --- loss: 1.332465, loss_ss: 0.894995, loss_d: 0.437470
0.9601 --- loss: 1.442903, loss_ss: 1.160844, loss_d: 0.282059
0.9985 --- loss: 1.546498, loss_ss: 1.214478, loss_d: 0.332020
Epoch finished! Loss: 1.426979296024029
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.195787, loss_ss: 0.905492, loss_d: 0.290295
0.0384 --- loss: 1.450769, loss_ss: 1.195434, loss_d: 0.255335
0.0768 --- loss: 1.550794, loss_ss: 1.104601, loss_d: 0.446193
0.1152 --- loss: 1.256358, loss_ss: 0.861350, loss_d: 0.395008
0.1536 --- loss: 1.484182, loss_ss: 0.950361, loss_d: 0.533821
0.1920 --- loss: 1.105679, loss_ss: 0.840755, loss_d: 0.264925
0.2304 --- loss: 1.151485, loss_ss: 0.750641, loss_d: 0.400844
0.2688 --- loss: 1.826257, loss_ss: 1.270238, loss_d: 0.556018
0.3072 --- loss: 1.541811, loss_ss: 0.754286, loss_d: 0.787525
0.3456 --- loss: 1.406729, loss_ss: 1.070669, loss_d: 0.336059
0.3840 --- loss: 1.207376, loss_ss: 1.029101, loss_d: 0.178275
0.4224 --- loss: 1.883861, loss_ss: 1.515102, loss_d: 0.368759
0.4608 --- loss: 1.402545, loss_ss: 0.914817, loss_d: 0.487728
0.4992 --- loss: 1.659646, loss_ss: 1.323815, loss_d: 0.335831
0.5376 --- loss: 0.983438, loss_ss: 0.717889, loss_d: 0.265549
0.5760 --- loss: 1.255088, loss_ss: 1.028589, loss_d: 0.226499
0.6144 --- loss: 1.448971, loss_ss: 0.935428, loss_d: 0.513542
0.6528 --- loss: 1.095753, loss_ss: 0.811576, loss_d: 0.284178
0.6912 --- loss: 1.334461, loss_ss: 0.985668, loss_d: 0.348793
0.7296 --- loss: 0.940486, loss_ss: 0.819065, loss_d: 0.121420
0.7680 --- loss: 1.308531, loss_ss: 0.889226, loss_d: 0.419305
0.8065 --- loss: 1.311285, loss_ss: 1.064405, loss_d: 0.246880
0.8449 --- loss: 1.631552, loss_ss: 0.951885, loss_d: 0.679667
0.8833 --- loss: 1.434857, loss_ss: 1.104175, loss_d: 0.330682
0.9217 --- loss: 1.154445, loss_ss: 0.943849, loss_d: 0.210595
0.9601 --- loss: 1.479349, loss_ss: 0.884816, loss_d: 0.594533
0.9985 --- loss: 1.470616, loss_ss: 1.165143, loss_d: 0.305473
Epoch finished! Loss: 1.3655164546691454
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.316719, loss_ss: 0.919465, loss_d: 0.397254
0.0384 --- loss: 1.867159, loss_ss: 1.006148, loss_d: 0.861011
0.0768 --- loss: 1.541058, loss_ss: 1.027823, loss_d: 0.513235
0.1152 --- loss: 1.565449, loss_ss: 1.225435, loss_d: 0.340015
0.1536 --- loss: 1.114929, loss_ss: 0.696917, loss_d: 0.418012
0.1920 --- loss: 1.187780, loss_ss: 0.736722, loss_d: 0.451058
0.2304 --- loss: 1.102107, loss_ss: 0.820832, loss_d: 0.281275
0.2688 --- loss: 1.384834, loss_ss: 1.133031, loss_d: 0.251803
0.3072 --- loss: 1.020758, loss_ss: 0.730594, loss_d: 0.290164
0.3456 --- loss: 1.705285, loss_ss: 1.161746, loss_d: 0.543539
0.3840 --- loss: 1.059883, loss_ss: 0.884748, loss_d: 0.175135
0.4224 --- loss: 1.143570, loss_ss: 0.994201, loss_d: 0.149369
0.4608 --- loss: 1.229295, loss_ss: 0.913623, loss_d: 0.315673
0.4992 --- loss: 1.008357, loss_ss: 0.846906, loss_d: 0.161451
0.5376 --- loss: 1.796353, loss_ss: 0.991332, loss_d: 0.805021
0.5760 --- loss: 1.135965, loss_ss: 0.926396, loss_d: 0.209569
0.6144 --- loss: 0.954751, loss_ss: 0.698167, loss_d: 0.256584
0.6528 --- loss: 1.382303, loss_ss: 0.854575, loss_d: 0.527728
0.6912 --- loss: 1.508112, loss_ss: 1.081792, loss_d: 0.426320
0.7296 --- loss: 0.867557, loss_ss: 0.574677, loss_d: 0.292880
0.7680 --- loss: 1.320803, loss_ss: 1.028135, loss_d: 0.292668
0.8065 --- loss: 1.254718, loss_ss: 0.936267, loss_d: 0.318451
0.8449 --- loss: 0.843206, loss_ss: 0.696547, loss_d: 0.146659
0.8833 --- loss: 1.300139, loss_ss: 1.066615, loss_d: 0.233524
0.9217 --- loss: 1.061662, loss_ss: 0.960705, loss_d: 0.100956
0.9601 --- loss: 1.682848, loss_ss: 0.833071, loss_d: 0.849777
0.9985 --- loss: 1.697852, loss_ss: 1.142259, loss_d: 0.555592
Epoch finished! Loss: 1.2987630309966893
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.040947, loss_ss: 0.805556, loss_d: 0.235390
0.0384 --- loss: 1.299782, loss_ss: 1.078590, loss_d: 0.221193
0.0768 --- loss: 1.097170, loss_ss: 0.861986, loss_d: 0.235185
0.1152 --- loss: 1.031187, loss_ss: 0.801089, loss_d: 0.230099
0.1536 --- loss: 1.185669, loss_ss: 0.725506, loss_d: 0.460162
0.1920 --- loss: 1.508235, loss_ss: 0.974972, loss_d: 0.533263
0.2304 --- loss: 1.153797, loss_ss: 1.008725, loss_d: 0.145072
0.2688 --- loss: 1.468074, loss_ss: 0.974177, loss_d: 0.493897
0.3072 --- loss: 1.398157, loss_ss: 0.691889, loss_d: 0.706268
0.3456 --- loss: 1.141204, loss_ss: 0.933357, loss_d: 0.207847
0.3840 --- loss: 1.040259, loss_ss: 0.802998, loss_d: 0.237261
0.4224 --- loss: 1.345395, loss_ss: 1.089356, loss_d: 0.256039
0.4608 --- loss: 1.207277, loss_ss: 0.860011, loss_d: 0.347266
0.4992 --- loss: 1.297107, loss_ss: 1.051300, loss_d: 0.245807
0.5376 --- loss: 1.033978, loss_ss: 0.871639, loss_d: 0.162338
0.5760 --- loss: 1.357391, loss_ss: 1.036620, loss_d: 0.320771
0.6144 --- loss: 1.122353, loss_ss: 0.879619, loss_d: 0.242734
0.6528 --- loss: 1.563712, loss_ss: 1.282899, loss_d: 0.280813
0.6912 --- loss: 1.167573, loss_ss: 0.746361, loss_d: 0.421212
0.7296 --- loss: 0.959855, loss_ss: 0.735085, loss_d: 0.224770
0.7680 --- loss: 1.336910, loss_ss: 0.958002, loss_d: 0.378909
0.8065 --- loss: 1.237038, loss_ss: 1.009770, loss_d: 0.227268
0.8449 --- loss: 1.026012, loss_ss: 0.739885, loss_d: 0.286128
0.8833 --- loss: 1.126910, loss_ss: 0.699085, loss_d: 0.427824
0.9217 --- loss: 1.346940, loss_ss: 1.162591, loss_d: 0.184349
0.9601 --- loss: 1.450630, loss_ss: 1.159439, loss_d: 0.291191
0.9985 --- loss: 1.654437, loss_ss: 1.206066, loss_d: 0.448370
Epoch finished! Loss: 1.2402791429024476
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.162180, loss_ss: 0.820347, loss_d: 0.341834
0.0384 --- loss: 1.075002, loss_ss: 0.820122, loss_d: 0.254881
0.0768 --- loss: 0.943668, loss_ss: 0.791812, loss_d: 0.151856
0.1152 --- loss: 1.256021, loss_ss: 1.059159, loss_d: 0.196862
0.1536 --- loss: 1.211235, loss_ss: 1.060574, loss_d: 0.150661
0.1920 --- loss: 1.146205, loss_ss: 0.845069, loss_d: 0.301137
0.2304 --- loss: 1.319032, loss_ss: 0.795964, loss_d: 0.523068
0.2688 --- loss: 1.225449, loss_ss: 1.072947, loss_d: 0.152502
0.3072 --- loss: 0.730602, loss_ss: 0.583832, loss_d: 0.146770
0.3456 --- loss: 1.291582, loss_ss: 0.976115, loss_d: 0.315466
0.3840 --- loss: 1.017156, loss_ss: 0.655319, loss_d: 0.361836
0.4224 --- loss: 1.113988, loss_ss: 0.881150, loss_d: 0.232837
0.4608 --- loss: 1.479623, loss_ss: 1.291644, loss_d: 0.187979
0.4992 --- loss: 1.339458, loss_ss: 0.821294, loss_d: 0.518164
0.5376 --- loss: 1.221054, loss_ss: 1.017800, loss_d: 0.203254
0.5760 --- loss: 1.112399, loss_ss: 0.941753, loss_d: 0.170646
0.6144 --- loss: 1.016979, loss_ss: 0.838345, loss_d: 0.178634
0.6528 --- loss: 1.108930, loss_ss: 1.004781, loss_d: 0.104150
0.6912 --- loss: 1.175146, loss_ss: 0.510399, loss_d: 0.664747
0.7296 --- loss: 1.194932, loss_ss: 1.008610, loss_d: 0.186322
0.7680 --- loss: 1.236518, loss_ss: 0.958382, loss_d: 0.278136
0.8065 --- loss: 1.042252, loss_ss: 0.900430, loss_d: 0.141822
0.8449 --- loss: 0.980361, loss_ss: 0.816595, loss_d: 0.163766
0.8833 --- loss: 0.931601, loss_ss: 0.770951, loss_d: 0.160650
0.9217 --- loss: 0.821395, loss_ss: 0.698909, loss_d: 0.122486
0.9601 --- loss: 1.320424, loss_ss: 0.848422, loss_d: 0.472002
0.9985 --- loss: 0.696412, loss_ss: 0.626643, loss_d: 0.069769
Epoch finished! Loss: 1.1884371069761424
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.018709, loss_ss: 0.802491, loss_d: 0.216218
0.0384 --- loss: 0.871056, loss_ss: 0.675423, loss_d: 0.195633
0.0768 --- loss: 1.004035, loss_ss: 0.889858, loss_d: 0.114177
0.1152 --- loss: 1.191085, loss_ss: 0.853689, loss_d: 0.337395
0.1536 --- loss: 1.237627, loss_ss: 1.102299, loss_d: 0.135329
0.1920 --- loss: 1.502115, loss_ss: 1.171545, loss_d: 0.330570
0.2304 --- loss: 0.786942, loss_ss: 0.685565, loss_d: 0.101377
0.2688 --- loss: 0.925680, loss_ss: 0.819805, loss_d: 0.105875
0.3072 --- loss: 1.139304, loss_ss: 1.003843, loss_d: 0.135461
0.3456 --- loss: 1.418542, loss_ss: 0.796384, loss_d: 0.622157
0.3840 --- loss: 1.137190, loss_ss: 0.919275, loss_d: 0.217915
0.4224 --- loss: 0.928354, loss_ss: 0.716242, loss_d: 0.212112
0.4608 --- loss: 1.364344, loss_ss: 0.847429, loss_d: 0.516916
0.4992 --- loss: 0.990991, loss_ss: 0.647579, loss_d: 0.343411
0.5376 --- loss: 1.168152, loss_ss: 0.717856, loss_d: 0.450296
0.5760 --- loss: 0.855924, loss_ss: 0.788031, loss_d: 0.067893
0.6144 --- loss: 1.081336, loss_ss: 0.792129, loss_d: 0.289207
0.6528 --- loss: 1.128772, loss_ss: 1.059925, loss_d: 0.068847
0.6912 --- loss: 1.299320, loss_ss: 1.173166, loss_d: 0.126154
0.7296 --- loss: 0.979341, loss_ss: 0.796529, loss_d: 0.182812
0.7680 --- loss: 1.328784, loss_ss: 0.761625, loss_d: 0.567160
0.8065 --- loss: 1.481059, loss_ss: 0.979327, loss_d: 0.501732
0.8449 --- loss: 0.913922, loss_ss: 0.690168, loss_d: 0.223754
0.8833 --- loss: 0.830815, loss_ss: 0.741296, loss_d: 0.089518
0.9217 --- loss: 1.242524, loss_ss: 1.051915, loss_d: 0.190609
0.9601 --- loss: 1.525102, loss_ss: 1.063317, loss_d: 0.461784
0.9985 --- loss: 1.320576, loss_ss: 0.946956, loss_d: 0.373620
Epoch finished! Loss: 1.1473786177543492
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7098039215686275
             precision    recall  f1-score   support

        0.0       0.37      0.69      0.48        62
        1.0       0.33      0.02      0.04       178
        2.0       0.72      0.92      0.81       437
        3.0       0.94      0.89      0.91       102
        4.0       0.77      0.76      0.77       241

avg / total       0.67      0.71      0.66      1020
 


====== chp038-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  90.88  69.35   92.28  36.75     48.04
1  82.16   2.25   99.05  33.33      4.21
2  81.57  92.22   73.58  72.35     81.09
3  98.33  89.22   99.35  93.81     91.46
4  89.02  75.93   93.07  77.22     76.57
Total accuracy: 70.98%
Average sen: 65.79%
Average spec: 91.46%
Macro f1-score: 60.27%
Diagnosis acc on 15mins: 0.9705882352941176
[0.99901795 0.96855921 0.99771643 0.99124748 0.97120935 0.99103349
 0.94919223 0.99204868 0.99887437 0.99866748 0.99648595 0.99430472
 0.9682256  0.99593771 0.9967128  0.90156561 0.78499639 0.95689243
 0.99880385 0.99834383 0.90641052 0.99932146 0.99780434 0.99362731
 0.94646531 0.95943224 0.99328607 0.99876922 0.99311298 0.97742778
 0.99365282 0.99529785 0.99904889 0.27655855]
pred: 0.9552956144599354, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp039-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.348879, loss_ss: 1.620960, loss_d: 0.727919
0.0384 --- loss: 2.463601, loss_ss: 1.538800, loss_d: 0.924801
0.0769 --- loss: 1.711978, loss_ss: 1.489909, loss_d: 0.222070
0.1153 --- loss: 1.920942, loss_ss: 1.445856, loss_d: 0.475086
0.1538 --- loss: 2.284212, loss_ss: 1.466538, loss_d: 0.817674
0.1922 --- loss: 2.070943, loss_ss: 1.408829, loss_d: 0.662114
0.2307 --- loss: 1.891380, loss_ss: 1.448732, loss_d: 0.442649
0.2691 --- loss: 1.770593, loss_ss: 1.342789, loss_d: 0.427804
0.3076 --- loss: 1.725708, loss_ss: 1.274449, loss_d: 0.451259
0.3460 --- loss: 1.728543, loss_ss: 1.264348, loss_d: 0.464195
0.3845 --- loss: 2.002290, loss_ss: 1.353723, loss_d: 0.648567
0.4229 --- loss: 1.959907, loss_ss: 1.269529, loss_d: 0.690378
0.4614 --- loss: 1.866925, loss_ss: 1.238447, loss_d: 0.628479
0.4998 --- loss: 1.663265, loss_ss: 1.296255, loss_d: 0.367010
0.5383 --- loss: 2.202207, loss_ss: 1.337936, loss_d: 0.864271
0.5767 --- loss: 1.611868, loss_ss: 1.241964, loss_d: 0.369904
0.6151 --- loss: 1.783427, loss_ss: 1.214577, loss_d: 0.568850
0.6536 --- loss: 1.796154, loss_ss: 1.208028, loss_d: 0.588127
0.6920 --- loss: 1.818292, loss_ss: 1.115078, loss_d: 0.703213
0.7305 --- loss: 1.878175, loss_ss: 1.108350, loss_d: 0.769825
0.7689 --- loss: 1.772676, loss_ss: 1.115169, loss_d: 0.657506
0.8074 --- loss: 1.584895, loss_ss: 1.148262, loss_d: 0.436634
0.8458 --- loss: 1.942464, loss_ss: 1.045490, loss_d: 0.896973
0.8843 --- loss: 1.785746, loss_ss: 1.111322, loss_d: 0.674424
0.9227 --- loss: 1.907749, loss_ss: 1.172120, loss_d: 0.735629
0.9612 --- loss: 1.659503, loss_ss: 1.238274, loss_d: 0.421229
0.9996 --- loss: 2.966772, loss_ss: 1.224999, loss_d: 1.741773
Epoch finished! Loss: 1.8965066410028018
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.566580, loss_ss: 1.150212, loss_d: 0.416368
0.0384 --- loss: 1.519570, loss_ss: 1.038138, loss_d: 0.481432
0.0769 --- loss: 1.762281, loss_ss: 1.142408, loss_d: 0.619873
0.1153 --- loss: 1.412831, loss_ss: 0.952172, loss_d: 0.460659
0.1538 --- loss: 1.552905, loss_ss: 0.990365, loss_d: 0.562540
0.1922 --- loss: 1.679936, loss_ss: 0.965192, loss_d: 0.714744
0.2307 --- loss: 1.728364, loss_ss: 1.079656, loss_d: 0.648708
0.2691 --- loss: 1.844405, loss_ss: 1.130960, loss_d: 0.713445
0.3076 --- loss: 1.339251, loss_ss: 1.052819, loss_d: 0.286432
0.3460 --- loss: 1.781898, loss_ss: 0.992979, loss_d: 0.788919
0.3845 --- loss: 1.561029, loss_ss: 0.889007, loss_d: 0.672023
0.4229 --- loss: 1.526372, loss_ss: 0.960372, loss_d: 0.566000
0.4614 --- loss: 1.719218, loss_ss: 1.176018, loss_d: 0.543200
0.4998 --- loss: 1.437617, loss_ss: 0.947720, loss_d: 0.489896
0.5383 --- loss: 1.979914, loss_ss: 1.125008, loss_d: 0.854907
0.5767 --- loss: 1.580997, loss_ss: 0.979743, loss_d: 0.601254
0.6151 --- loss: 1.621867, loss_ss: 1.170277, loss_d: 0.451590
0.6536 --- loss: 1.611851, loss_ss: 0.959363, loss_d: 0.652488
0.6920 --- loss: 1.646056, loss_ss: 1.084178, loss_d: 0.561877
0.7305 --- loss: 1.734780, loss_ss: 1.105599, loss_d: 0.629181
0.7689 --- loss: 1.538067, loss_ss: 1.149158, loss_d: 0.388909
0.8074 --- loss: 1.394888, loss_ss: 1.009262, loss_d: 0.385626
0.8458 --- loss: 1.708753, loss_ss: 1.121957, loss_d: 0.586796
0.8843 --- loss: 1.550214, loss_ss: 1.087493, loss_d: 0.462721
0.9227 --- loss: 1.557471, loss_ss: 0.946545, loss_d: 0.610925
0.9612 --- loss: 1.376347, loss_ss: 0.962439, loss_d: 0.413909
0.9996 --- loss: 1.504597, loss_ss: 1.163242, loss_d: 0.341355
Epoch finished! Loss: 1.659952069245852
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.679626, loss_ss: 1.194675, loss_d: 0.484951
0.0384 --- loss: 2.216725, loss_ss: 0.956272, loss_d: 1.260453
0.0769 --- loss: 1.458825, loss_ss: 0.778602, loss_d: 0.680223
0.1153 --- loss: 1.622104, loss_ss: 0.905134, loss_d: 0.716970
0.1538 --- loss: 1.575338, loss_ss: 0.940184, loss_d: 0.635154
0.1922 --- loss: 1.437434, loss_ss: 0.946590, loss_d: 0.490844
0.2307 --- loss: 2.164793, loss_ss: 1.205728, loss_d: 0.959065
0.2691 --- loss: 1.511182, loss_ss: 1.056912, loss_d: 0.454270
0.3076 --- loss: 1.532751, loss_ss: 0.886810, loss_d: 0.645940
0.3460 --- loss: 1.640662, loss_ss: 1.010432, loss_d: 0.630230
0.3845 --- loss: 1.379322, loss_ss: 0.703474, loss_d: 0.675848
0.4229 --- loss: 1.675773, loss_ss: 1.088693, loss_d: 0.587079
0.4614 --- loss: 1.637927, loss_ss: 1.144816, loss_d: 0.493111
0.4998 --- loss: 1.713798, loss_ss: 1.168361, loss_d: 0.545437
0.5383 --- loss: 1.544616, loss_ss: 0.887510, loss_d: 0.657106
0.5767 --- loss: 1.560026, loss_ss: 0.777451, loss_d: 0.782575
0.6151 --- loss: 1.931275, loss_ss: 1.076876, loss_d: 0.854400
0.6536 --- loss: 1.780734, loss_ss: 1.113315, loss_d: 0.667419
0.6920 --- loss: 1.670866, loss_ss: 1.272899, loss_d: 0.397967
0.7305 --- loss: 1.494304, loss_ss: 0.999878, loss_d: 0.494426
0.7689 --- loss: 1.262109, loss_ss: 0.887335, loss_d: 0.374774
0.8074 --- loss: 2.023682, loss_ss: 0.933641, loss_d: 1.090041
0.8458 --- loss: 1.883314, loss_ss: 1.095175, loss_d: 0.788139
0.8843 --- loss: 1.439080, loss_ss: 0.887665, loss_d: 0.551415
0.9227 --- loss: 1.321822, loss_ss: 0.774209, loss_d: 0.547613
0.9612 --- loss: 1.298722, loss_ss: 0.825876, loss_d: 0.472846
0.9996 --- loss: 2.855341, loss_ss: 2.537546, loss_d: 0.317794
Epoch finished! Loss: 1.582837056196653
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.789231, loss_ss: 0.888747, loss_d: 0.900483
0.0384 --- loss: 1.536674, loss_ss: 0.860501, loss_d: 0.676173
0.0769 --- loss: 1.217063, loss_ss: 0.756727, loss_d: 0.460337
0.1153 --- loss: 1.173053, loss_ss: 0.741746, loss_d: 0.431307
0.1538 --- loss: 1.531162, loss_ss: 1.058465, loss_d: 0.472697
0.1922 --- loss: 1.755098, loss_ss: 0.871521, loss_d: 0.883576
0.2307 --- loss: 1.626191, loss_ss: 0.960362, loss_d: 0.665829
0.2691 --- loss: 1.705006, loss_ss: 1.039376, loss_d: 0.665630
0.3076 --- loss: 1.598402, loss_ss: 0.876074, loss_d: 0.722328
0.3460 --- loss: 1.753464, loss_ss: 0.988192, loss_d: 0.765272
0.3845 --- loss: 1.542113, loss_ss: 0.915282, loss_d: 0.626831
0.4229 --- loss: 1.461814, loss_ss: 0.883455, loss_d: 0.578360
0.4614 --- loss: 1.344234, loss_ss: 1.058715, loss_d: 0.285519
0.4998 --- loss: 1.715906, loss_ss: 1.298960, loss_d: 0.416946
0.5383 --- loss: 1.852355, loss_ss: 1.301113, loss_d: 0.551243
0.5767 --- loss: 1.509457, loss_ss: 0.862588, loss_d: 0.646869
0.6151 --- loss: 1.684826, loss_ss: 0.724509, loss_d: 0.960316
0.6536 --- loss: 1.470052, loss_ss: 0.872018, loss_d: 0.598034
0.6920 --- loss: 1.337608, loss_ss: 0.681119, loss_d: 0.656489
0.7305 --- loss: 1.502978, loss_ss: 0.918270, loss_d: 0.584708
0.7689 --- loss: 1.562251, loss_ss: 0.868434, loss_d: 0.693817
0.8074 --- loss: 1.850515, loss_ss: 0.958102, loss_d: 0.892413
0.8458 --- loss: 1.531179, loss_ss: 1.219921, loss_d: 0.311258
0.8843 --- loss: 1.394777, loss_ss: 0.946456, loss_d: 0.448321
0.9227 --- loss: 1.609961, loss_ss: 0.795003, loss_d: 0.814958
0.9612 --- loss: 1.360558, loss_ss: 0.852306, loss_d: 0.508252
0.9996 --- loss: 1.422599, loss_ss: 1.189892, loss_d: 0.232707
Epoch finished! Loss: 1.5134238027609312
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.511702, loss_ss: 1.030169, loss_d: 0.481533
0.0384 --- loss: 1.749813, loss_ss: 0.738235, loss_d: 1.011578
0.0769 --- loss: 1.477856, loss_ss: 0.826074, loss_d: 0.651782
0.1153 --- loss: 1.519010, loss_ss: 1.028536, loss_d: 0.490474
0.1538 --- loss: 1.492636, loss_ss: 1.100659, loss_d: 0.391977
0.1922 --- loss: 1.849154, loss_ss: 1.242349, loss_d: 0.606805
0.2307 --- loss: 1.378755, loss_ss: 0.944011, loss_d: 0.434743
0.2691 --- loss: 1.297011, loss_ss: 0.781501, loss_d: 0.515510
0.3076 --- loss: 1.673363, loss_ss: 1.156368, loss_d: 0.516995
0.3460 --- loss: 1.482056, loss_ss: 0.634453, loss_d: 0.847603
0.3845 --- loss: 1.818956, loss_ss: 0.906684, loss_d: 0.912272
0.4229 --- loss: 1.574865, loss_ss: 1.010607, loss_d: 0.564257
0.4614 --- loss: 1.359143, loss_ss: 0.758042, loss_d: 0.601101
0.4998 --- loss: 1.478621, loss_ss: 1.087966, loss_d: 0.390656
0.5383 --- loss: 1.548515, loss_ss: 1.241233, loss_d: 0.307283
0.5767 --- loss: 1.374589, loss_ss: 0.722440, loss_d: 0.652149
0.6151 --- loss: 1.281825, loss_ss: 0.699652, loss_d: 0.582174
0.6536 --- loss: 1.996069, loss_ss: 1.309904, loss_d: 0.686165
0.6920 --- loss: 1.666093, loss_ss: 0.910158, loss_d: 0.755935
0.7305 --- loss: 1.597527, loss_ss: 0.954826, loss_d: 0.642700
0.7689 --- loss: 1.655556, loss_ss: 1.125106, loss_d: 0.530450
0.8074 --- loss: 1.365603, loss_ss: 0.802397, loss_d: 0.563207
0.8458 --- loss: 1.340871, loss_ss: 1.037794, loss_d: 0.303076
0.8843 --- loss: 1.610902, loss_ss: 0.919149, loss_d: 0.691753
0.9227 --- loss: 1.110564, loss_ss: 0.689976, loss_d: 0.420588
0.9612 --- loss: 1.663390, loss_ss: 1.095146, loss_d: 0.568243
0.9996 --- loss: 2.365193, loss_ss: 2.087508, loss_d: 0.277685
Epoch finished! Loss: 1.4754316861812884
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.217451, loss_ss: 0.848013, loss_d: 0.369437
0.0384 --- loss: 1.567194, loss_ss: 0.940878, loss_d: 0.626316
0.0769 --- loss: 1.485537, loss_ss: 1.150185, loss_d: 0.335352
0.1153 --- loss: 1.656509, loss_ss: 0.806513, loss_d: 0.849996
0.1538 --- loss: 1.345574, loss_ss: 0.998537, loss_d: 0.347037
0.1922 --- loss: 1.486278, loss_ss: 0.847976, loss_d: 0.638302
0.2307 --- loss: 1.583227, loss_ss: 0.794335, loss_d: 0.788892
0.2691 --- loss: 1.632189, loss_ss: 1.019974, loss_d: 0.612215
0.3076 --- loss: 1.245633, loss_ss: 0.769020, loss_d: 0.476613
0.3460 --- loss: 1.654381, loss_ss: 1.187139, loss_d: 0.467242
0.3845 --- loss: 1.908571, loss_ss: 1.069797, loss_d: 0.838774
0.4229 --- loss: 1.401270, loss_ss: 0.884389, loss_d: 0.516880
0.4614 --- loss: 1.532390, loss_ss: 1.081873, loss_d: 0.450517
0.4998 --- loss: 1.319656, loss_ss: 0.809408, loss_d: 0.510248
0.5383 --- loss: 1.198125, loss_ss: 0.752549, loss_d: 0.445576
0.5767 --- loss: 1.532243, loss_ss: 0.993611, loss_d: 0.538632
0.6151 --- loss: 1.461616, loss_ss: 1.017448, loss_d: 0.444168
0.6536 --- loss: 1.161387, loss_ss: 0.793887, loss_d: 0.367500
0.6920 --- loss: 0.923804, loss_ss: 0.713750, loss_d: 0.210054
0.7305 --- loss: 1.388359, loss_ss: 0.876458, loss_d: 0.511901
0.7689 --- loss: 1.264532, loss_ss: 1.015148, loss_d: 0.249384
0.8074 --- loss: 0.963421, loss_ss: 0.579359, loss_d: 0.384063
0.8458 --- loss: 1.288448, loss_ss: 0.781142, loss_d: 0.507306
0.8843 --- loss: 1.388649, loss_ss: 0.724288, loss_d: 0.664361
0.9227 --- loss: 1.218366, loss_ss: 0.939831, loss_d: 0.278535
0.9612 --- loss: 1.382045, loss_ss: 0.950657, loss_d: 0.431388
0.9996 --- loss: 1.596211, loss_ss: 1.368444, loss_d: 0.227767
Epoch finished! Loss: 1.4296971454070164
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.246089, loss_ss: 0.665743, loss_d: 0.580346
0.0384 --- loss: 1.489191, loss_ss: 0.817639, loss_d: 0.671552
0.0769 --- loss: 1.425443, loss_ss: 1.066872, loss_d: 0.358571
0.1153 --- loss: 1.199134, loss_ss: 0.802660, loss_d: 0.396474
0.1538 --- loss: 1.116997, loss_ss: 0.756599, loss_d: 0.360398
0.1922 --- loss: 1.232008, loss_ss: 0.893700, loss_d: 0.338309
0.2307 --- loss: 1.007773, loss_ss: 0.724677, loss_d: 0.283096
0.2691 --- loss: 1.472716, loss_ss: 1.065419, loss_d: 0.407297
0.3076 --- loss: 1.164388, loss_ss: 0.831148, loss_d: 0.333240
0.3460 --- loss: 1.481218, loss_ss: 0.821062, loss_d: 0.660156
0.3845 --- loss: 1.080052, loss_ss: 0.772486, loss_d: 0.307565
0.4229 --- loss: 1.387429, loss_ss: 0.617826, loss_d: 0.769603
0.4614 --- loss: 1.278436, loss_ss: 0.981597, loss_d: 0.296838
0.4998 --- loss: 1.075874, loss_ss: 0.829475, loss_d: 0.246399
0.5383 --- loss: 0.961578, loss_ss: 0.680019, loss_d: 0.281559
0.5767 --- loss: 1.171781, loss_ss: 0.871814, loss_d: 0.299967
0.6151 --- loss: 1.145537, loss_ss: 0.870721, loss_d: 0.274816
0.6536 --- loss: 1.365812, loss_ss: 0.837539, loss_d: 0.528273
0.6920 --- loss: 1.243302, loss_ss: 0.754810, loss_d: 0.488492
0.7305 --- loss: 1.456124, loss_ss: 1.011018, loss_d: 0.445106
0.7689 --- loss: 1.015494, loss_ss: 0.720250, loss_d: 0.295244
0.8074 --- loss: 1.781828, loss_ss: 0.851494, loss_d: 0.930335
0.8458 --- loss: 1.389885, loss_ss: 0.754123, loss_d: 0.635763
0.8843 --- loss: 1.486357, loss_ss: 1.047435, loss_d: 0.438922
0.9227 --- loss: 1.531190, loss_ss: 0.736404, loss_d: 0.794786
0.9612 --- loss: 1.203966, loss_ss: 0.762511, loss_d: 0.441455
0.9996 --- loss: 1.484511, loss_ss: 1.363448, loss_d: 0.121063
Epoch finished! Loss: 1.3180502598102277
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.197598, loss_ss: 0.987209, loss_d: 0.210389
0.0384 --- loss: 0.998141, loss_ss: 0.584282, loss_d: 0.413859
0.0769 --- loss: 0.789634, loss_ss: 0.616008, loss_d: 0.173626
0.1153 --- loss: 1.229106, loss_ss: 0.890931, loss_d: 0.338175
0.1538 --- loss: 1.435954, loss_ss: 1.058674, loss_d: 0.377281
0.1922 --- loss: 1.426404, loss_ss: 1.121421, loss_d: 0.304983
0.2307 --- loss: 1.026583, loss_ss: 0.866741, loss_d: 0.159841
0.2691 --- loss: 1.542044, loss_ss: 0.995873, loss_d: 0.546171
0.3076 --- loss: 1.135347, loss_ss: 0.770472, loss_d: 0.364875
0.3460 --- loss: 1.107297, loss_ss: 0.638545, loss_d: 0.468752
0.3845 --- loss: 1.470177, loss_ss: 1.250982, loss_d: 0.219195
0.4229 --- loss: 0.992693, loss_ss: 0.813014, loss_d: 0.179679
0.4614 --- loss: 1.110119, loss_ss: 0.644700, loss_d: 0.465420
0.4998 --- loss: 1.499872, loss_ss: 0.946833, loss_d: 0.553038
0.5383 --- loss: 1.258003, loss_ss: 0.813254, loss_d: 0.444749
0.5767 --- loss: 1.491589, loss_ss: 1.031451, loss_d: 0.460138
0.6151 --- loss: 0.958304, loss_ss: 0.741746, loss_d: 0.216558
0.6536 --- loss: 1.175124, loss_ss: 0.645533, loss_d: 0.529591
0.6920 --- loss: 1.577630, loss_ss: 0.958032, loss_d: 0.619599
0.7305 --- loss: 1.783382, loss_ss: 0.984388, loss_d: 0.798994
0.7689 --- loss: 1.625684, loss_ss: 1.065457, loss_d: 0.560227
0.8074 --- loss: 1.389324, loss_ss: 0.946791, loss_d: 0.442533
0.8458 --- loss: 1.121123, loss_ss: 0.877320, loss_d: 0.243803
0.8843 --- loss: 1.093578, loss_ss: 0.808619, loss_d: 0.284959
0.9227 --- loss: 1.521116, loss_ss: 0.789597, loss_d: 0.731519
0.9612 --- loss: 1.049798, loss_ss: 0.837882, loss_d: 0.211917
0.9996 --- loss: 4.309040, loss_ss: 1.636472, loss_d: 2.672568
Epoch finished! Loss: 1.2681737104287514
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.188673, loss_ss: 0.836926, loss_d: 0.351747
0.0384 --- loss: 1.242381, loss_ss: 0.909195, loss_d: 0.333185
0.0769 --- loss: 0.895815, loss_ss: 0.645625, loss_d: 0.250190
0.1153 --- loss: 1.016528, loss_ss: 0.575131, loss_d: 0.441396
0.1538 --- loss: 1.266016, loss_ss: 0.951980, loss_d: 0.314036
0.1922 --- loss: 1.733132, loss_ss: 1.051574, loss_d: 0.681558
0.2307 --- loss: 1.229446, loss_ss: 0.925025, loss_d: 0.304420
0.2691 --- loss: 1.127959, loss_ss: 0.699287, loss_d: 0.428672
0.3076 --- loss: 1.843168, loss_ss: 0.928801, loss_d: 0.914367
0.3460 --- loss: 0.972476, loss_ss: 0.760911, loss_d: 0.211566
0.3845 --- loss: 1.221671, loss_ss: 0.833812, loss_d: 0.387859
0.4229 --- loss: 0.887042, loss_ss: 0.706019, loss_d: 0.181022
0.4614 --- loss: 1.115483, loss_ss: 0.763566, loss_d: 0.351917
0.4998 --- loss: 1.600116, loss_ss: 1.015887, loss_d: 0.584229
0.5383 --- loss: 1.368238, loss_ss: 0.900525, loss_d: 0.467713
0.5767 --- loss: 1.198119, loss_ss: 0.909719, loss_d: 0.288400
0.6151 --- loss: 1.255010, loss_ss: 0.880588, loss_d: 0.374421
0.6536 --- loss: 1.212884, loss_ss: 0.930519, loss_d: 0.282366
0.6920 --- loss: 0.931841, loss_ss: 0.740956, loss_d: 0.190885
0.7305 --- loss: 0.854170, loss_ss: 0.618850, loss_d: 0.235320
0.7689 --- loss: 1.139914, loss_ss: 0.872560, loss_d: 0.267354
0.8074 --- loss: 1.554574, loss_ss: 1.077808, loss_d: 0.476766
0.8458 --- loss: 0.999576, loss_ss: 0.707114, loss_d: 0.292462
0.8843 --- loss: 1.254027, loss_ss: 0.830975, loss_d: 0.423052
0.9227 --- loss: 1.568040, loss_ss: 1.381649, loss_d: 0.186391
0.9612 --- loss: 1.482218, loss_ss: 0.724667, loss_d: 0.757550
0.9996 --- loss: 2.125669, loss_ss: 2.015185, loss_d: 0.110484
Epoch finished! Loss: 1.2067424891086724
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.100703, loss_ss: 0.902640, loss_d: 0.198063
0.0384 --- loss: 1.461504, loss_ss: 0.935703, loss_d: 0.525800
0.0769 --- loss: 1.247414, loss_ss: 0.848893, loss_d: 0.398520
0.1153 --- loss: 1.018963, loss_ss: 0.810476, loss_d: 0.208487
0.1538 --- loss: 0.867781, loss_ss: 0.664532, loss_d: 0.203249
0.1922 --- loss: 1.254095, loss_ss: 0.714713, loss_d: 0.539382
0.2307 --- loss: 1.022422, loss_ss: 0.776370, loss_d: 0.246052
0.2691 --- loss: 0.961760, loss_ss: 0.819501, loss_d: 0.142259
0.3076 --- loss: 0.956603, loss_ss: 0.785867, loss_d: 0.170736
0.3460 --- loss: 1.083688, loss_ss: 0.794552, loss_d: 0.289136
0.3845 --- loss: 1.013186, loss_ss: 0.678393, loss_d: 0.334793
0.4229 --- loss: 1.763564, loss_ss: 0.875554, loss_d: 0.888010
0.4614 --- loss: 1.120850, loss_ss: 0.922512, loss_d: 0.198339
0.4998 --- loss: 1.592526, loss_ss: 1.288989, loss_d: 0.303537
0.5383 --- loss: 1.374298, loss_ss: 0.938815, loss_d: 0.435483
0.5767 --- loss: 1.263432, loss_ss: 0.827829, loss_d: 0.435604
0.6151 --- loss: 1.037037, loss_ss: 0.540401, loss_d: 0.496636
0.6536 --- loss: 1.113580, loss_ss: 0.925067, loss_d: 0.188513
0.6920 --- loss: 1.077503, loss_ss: 0.825120, loss_d: 0.252383
0.7305 --- loss: 0.834002, loss_ss: 0.641109, loss_d: 0.192892
0.7689 --- loss: 1.041302, loss_ss: 0.724182, loss_d: 0.317119
0.8074 --- loss: 1.208094, loss_ss: 0.909322, loss_d: 0.298772
0.8458 --- loss: 0.867869, loss_ss: 0.673935, loss_d: 0.193933
0.8843 --- loss: 1.063727, loss_ss: 0.957204, loss_d: 0.106523
0.9227 --- loss: 1.200687, loss_ss: 0.868870, loss_d: 0.331817
0.9612 --- loss: 1.704575, loss_ss: 1.373301, loss_d: 0.331274
0.9996 --- loss: 1.372223, loss_ss: 1.058116, loss_d: 0.314107
Epoch finished! Loss: 1.1695950863453057
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4009009009009009
             precision    recall  f1-score   support

        0.0       0.08      0.84      0.14        19
        1.0       0.30      0.05      0.09       355
        2.0       0.84      0.32      0.47       376
        3.0       0.99      0.85      0.91       199
        4.0       0.23      0.74      0.35       161

avg / total       0.59      0.40      0.40      1110
 


====== chp039-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  82.34  84.21   82.31   7.66     14.04
1  65.77   5.35   94.17  30.16      9.09
2  75.05  32.45   96.87  84.14     46.83
3  97.12  84.92   99.78  98.83     91.35
4  59.91  73.91   57.53  22.80     34.85
Total accuracy: 40.09%
Average sen: 56.17%
Average spec: 86.13%
Macro f1-score: 39.23%
Diagnosis acc on 15mins: 1.0
[0.98283386 0.98450941 0.97634375 0.94372255 0.97377026 0.97237992
 0.96515077 0.98220772 0.97959489 0.9588269  0.98766065 0.98235255
 0.97633982 0.97912544 0.97458738 0.97020411 0.9713164  0.96951914
 0.98797148 0.98155791 0.97658485 0.98183954 0.98668718 0.97993249
 0.97803169 0.98397195 0.9867155  0.98744339 0.98434621 0.97894454
 0.97782421 0.98259604 0.98371798 0.98144102 0.97455186 0.97769803
 0.98277098]
pred: 0.9779749287141336, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp040-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.515045, loss_ss: 1.822055, loss_d: 0.692990
0.0384 --- loss: 2.704610, loss_ss: 1.442531, loss_d: 1.262079
0.0768 --- loss: 2.428460, loss_ss: 1.494190, loss_d: 0.934270
0.1153 --- loss: 1.913573, loss_ss: 1.479007, loss_d: 0.434566
0.1537 --- loss: 2.106234, loss_ss: 1.362301, loss_d: 0.743933
0.1921 --- loss: 2.168487, loss_ss: 1.403698, loss_d: 0.764789
0.2305 --- loss: 1.997950, loss_ss: 1.414309, loss_d: 0.583641
0.2689 --- loss: 1.811978, loss_ss: 1.313663, loss_d: 0.498315
0.3073 --- loss: 1.973006, loss_ss: 1.422111, loss_d: 0.550895
0.3458 --- loss: 2.298002, loss_ss: 1.381286, loss_d: 0.916716
0.3842 --- loss: 2.067330, loss_ss: 1.358419, loss_d: 0.708911
0.4226 --- loss: 1.781779, loss_ss: 1.292120, loss_d: 0.489659
0.4610 --- loss: 1.802409, loss_ss: 1.361928, loss_d: 0.440482
0.4994 --- loss: 1.882751, loss_ss: 1.549225, loss_d: 0.333525
0.5378 --- loss: 1.962062, loss_ss: 1.233243, loss_d: 0.728819
0.5763 --- loss: 1.844376, loss_ss: 1.349938, loss_d: 0.494438
0.6147 --- loss: 1.792049, loss_ss: 1.374372, loss_d: 0.417677
0.6531 --- loss: 1.690014, loss_ss: 1.252256, loss_d: 0.437757
0.6915 --- loss: 1.718121, loss_ss: 1.286017, loss_d: 0.432104
0.7299 --- loss: 1.772850, loss_ss: 1.153425, loss_d: 0.619424
0.7683 --- loss: 1.919097, loss_ss: 1.119377, loss_d: 0.799720
0.8068 --- loss: 1.864645, loss_ss: 1.217755, loss_d: 0.646890
0.8452 --- loss: 1.785467, loss_ss: 1.146749, loss_d: 0.638718
0.8836 --- loss: 1.826088, loss_ss: 1.282966, loss_d: 0.543123
0.9220 --- loss: 1.915161, loss_ss: 1.141546, loss_d: 0.773615
0.9604 --- loss: 2.036702, loss_ss: 1.305252, loss_d: 0.731450
0.9988 --- loss: 1.930627, loss_ss: 1.113191, loss_d: 0.817435
Epoch finished! Loss: 1.9373654952416053
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.720926, loss_ss: 1.066358, loss_d: 0.654568
0.0384 --- loss: 1.643970, loss_ss: 1.139014, loss_d: 0.504956
0.0768 --- loss: 1.465741, loss_ss: 0.984409, loss_d: 0.481332
0.1153 --- loss: 1.469906, loss_ss: 1.143893, loss_d: 0.326014
0.1537 --- loss: 1.823717, loss_ss: 1.062015, loss_d: 0.761702
0.1921 --- loss: 1.505260, loss_ss: 1.169079, loss_d: 0.336181
0.2305 --- loss: 1.909970, loss_ss: 1.323463, loss_d: 0.586507
0.2689 --- loss: 1.719480, loss_ss: 1.139294, loss_d: 0.580187
0.3073 --- loss: 1.799670, loss_ss: 1.079437, loss_d: 0.720232
0.3458 --- loss: 1.767243, loss_ss: 1.072283, loss_d: 0.694960
0.3842 --- loss: 1.900806, loss_ss: 1.191164, loss_d: 0.709642
0.4226 --- loss: 1.495215, loss_ss: 1.146980, loss_d: 0.348234
0.4610 --- loss: 1.606615, loss_ss: 1.110370, loss_d: 0.496245
0.4994 --- loss: 1.950710, loss_ss: 1.461769, loss_d: 0.488941
0.5378 --- loss: 1.605471, loss_ss: 1.308577, loss_d: 0.296894
0.5763 --- loss: 1.613172, loss_ss: 1.022137, loss_d: 0.591035
0.6147 --- loss: 1.565910, loss_ss: 1.010795, loss_d: 0.555115
0.6531 --- loss: 1.551963, loss_ss: 0.936750, loss_d: 0.615213
0.6915 --- loss: 1.414740, loss_ss: 1.065571, loss_d: 0.349170
0.7299 --- loss: 1.922734, loss_ss: 1.397300, loss_d: 0.525435
0.7683 --- loss: 1.689786, loss_ss: 1.092081, loss_d: 0.597705
0.8068 --- loss: 1.624657, loss_ss: 1.028232, loss_d: 0.596425
0.8452 --- loss: 1.655185, loss_ss: 1.094852, loss_d: 0.560333
0.8836 --- loss: 1.745286, loss_ss: 1.095471, loss_d: 0.649815
0.9220 --- loss: 1.570335, loss_ss: 0.889944, loss_d: 0.680391
0.9604 --- loss: 1.763054, loss_ss: 0.907821, loss_d: 0.855233
0.9988 --- loss: 1.747583, loss_ss: 1.142658, loss_d: 0.604926
Epoch finished! Loss: 1.6983711146391356
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.188724, loss_ss: 0.830171, loss_d: 0.358553
0.0384 --- loss: 1.533742, loss_ss: 1.026848, loss_d: 0.506895
0.0768 --- loss: 1.542581, loss_ss: 0.890122, loss_d: 0.652460
0.1153 --- loss: 1.582241, loss_ss: 0.955626, loss_d: 0.626615
0.1537 --- loss: 1.502753, loss_ss: 1.006009, loss_d: 0.496744
0.1921 --- loss: 1.819218, loss_ss: 1.204153, loss_d: 0.615066
0.2305 --- loss: 2.549861, loss_ss: 1.588402, loss_d: 0.961459
0.2689 --- loss: 1.811688, loss_ss: 1.102318, loss_d: 0.709370
0.3073 --- loss: 1.723470, loss_ss: 1.129679, loss_d: 0.593791
0.3458 --- loss: 1.328940, loss_ss: 1.054985, loss_d: 0.273955
0.3842 --- loss: 1.305841, loss_ss: 0.883286, loss_d: 0.422554
0.4226 --- loss: 1.926031, loss_ss: 1.263662, loss_d: 0.662369
0.4610 --- loss: 1.399340, loss_ss: 1.038491, loss_d: 0.360849
0.4994 --- loss: 1.653030, loss_ss: 0.830086, loss_d: 0.822944
0.5378 --- loss: 1.432753, loss_ss: 0.966243, loss_d: 0.466510
0.5763 --- loss: 1.616983, loss_ss: 1.226091, loss_d: 0.390892
0.6147 --- loss: 1.671966, loss_ss: 1.049459, loss_d: 0.622507
0.6531 --- loss: 1.650776, loss_ss: 0.853976, loss_d: 0.796801
0.6915 --- loss: 1.463474, loss_ss: 0.976109, loss_d: 0.487365
0.7299 --- loss: 1.474047, loss_ss: 0.911619, loss_d: 0.562428
0.7683 --- loss: 1.440532, loss_ss: 0.972685, loss_d: 0.467848
0.8068 --- loss: 1.414238, loss_ss: 0.715004, loss_d: 0.699235
0.8452 --- loss: 1.531172, loss_ss: 1.024730, loss_d: 0.506442
0.8836 --- loss: 1.619658, loss_ss: 1.150636, loss_d: 0.469022
0.9220 --- loss: 1.938709, loss_ss: 1.064465, loss_d: 0.874244
0.9604 --- loss: 1.607433, loss_ss: 1.056386, loss_d: 0.551047
0.9988 --- loss: 1.751045, loss_ss: 1.377976, loss_d: 0.373070
Epoch finished! Loss: 1.5636041971353385
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.180821, loss_ss: 0.805421, loss_d: 0.375400
0.0384 --- loss: 1.938580, loss_ss: 1.072953, loss_d: 0.865628
0.0768 --- loss: 1.378535, loss_ss: 0.902053, loss_d: 0.476483
0.1153 --- loss: 1.476986, loss_ss: 1.045902, loss_d: 0.431084
0.1537 --- loss: 1.513526, loss_ss: 1.081634, loss_d: 0.431892
0.1921 --- loss: 1.854663, loss_ss: 0.958433, loss_d: 0.896230
0.2305 --- loss: 1.871873, loss_ss: 1.360037, loss_d: 0.511836
0.2689 --- loss: 1.391397, loss_ss: 0.887849, loss_d: 0.503548
0.3073 --- loss: 1.769778, loss_ss: 0.985242, loss_d: 0.784536
0.3458 --- loss: 1.352199, loss_ss: 0.994728, loss_d: 0.357471
0.3842 --- loss: 1.567750, loss_ss: 1.136147, loss_d: 0.431603
0.4226 --- loss: 1.721062, loss_ss: 0.925249, loss_d: 0.795813
0.4610 --- loss: 1.254698, loss_ss: 0.911437, loss_d: 0.343261
0.4994 --- loss: 1.354880, loss_ss: 1.000741, loss_d: 0.354139
0.5378 --- loss: 1.726133, loss_ss: 0.972447, loss_d: 0.753686
0.5763 --- loss: 1.292986, loss_ss: 0.941698, loss_d: 0.351289
0.6147 --- loss: 1.695107, loss_ss: 0.988543, loss_d: 0.706564
0.6531 --- loss: 1.721978, loss_ss: 1.088333, loss_d: 0.633646
0.6915 --- loss: 1.666870, loss_ss: 1.259678, loss_d: 0.407191
0.7299 --- loss: 1.567935, loss_ss: 0.733539, loss_d: 0.834396
0.7683 --- loss: 1.590443, loss_ss: 1.225524, loss_d: 0.364919
0.8068 --- loss: 1.351338, loss_ss: 0.806122, loss_d: 0.545216
0.8452 --- loss: 1.257402, loss_ss: 0.924671, loss_d: 0.332731
0.8836 --- loss: 1.389048, loss_ss: 1.160349, loss_d: 0.228699
0.9220 --- loss: 1.597942, loss_ss: 1.048842, loss_d: 0.549099
0.9604 --- loss: 1.662194, loss_ss: 1.108843, loss_d: 0.553351
0.9988 --- loss: 2.184401, loss_ss: 1.962344, loss_d: 0.222057
Epoch finished! Loss: 1.46758266549844
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.294346, loss_ss: 0.805760, loss_d: 0.488586
0.0384 --- loss: 1.119144, loss_ss: 0.742732, loss_d: 0.376413
0.0768 --- loss: 1.628155, loss_ss: 1.154095, loss_d: 0.474060
0.1153 --- loss: 1.120151, loss_ss: 0.718400, loss_d: 0.401752
0.1537 --- loss: 1.271459, loss_ss: 0.905908, loss_d: 0.365551
0.1921 --- loss: 0.900553, loss_ss: 0.672560, loss_d: 0.227993
0.2305 --- loss: 1.460337, loss_ss: 0.865777, loss_d: 0.594561
0.2689 --- loss: 1.389622, loss_ss: 0.771232, loss_d: 0.618389
0.3073 --- loss: 1.372429, loss_ss: 0.945636, loss_d: 0.426793
0.3458 --- loss: 0.878271, loss_ss: 0.628528, loss_d: 0.249742
0.3842 --- loss: 1.751937, loss_ss: 1.063488, loss_d: 0.688449
0.4226 --- loss: 1.357731, loss_ss: 0.921631, loss_d: 0.436100
0.4610 --- loss: 1.291620, loss_ss: 0.981350, loss_d: 0.310270
0.4994 --- loss: 1.361455, loss_ss: 0.920072, loss_d: 0.441383
0.5378 --- loss: 1.669514, loss_ss: 0.859863, loss_d: 0.809651
0.5763 --- loss: 1.403352, loss_ss: 0.971375, loss_d: 0.431977
0.6147 --- loss: 1.681213, loss_ss: 0.871203, loss_d: 0.810009
0.6531 --- loss: 1.384272, loss_ss: 0.932966, loss_d: 0.451306
0.6915 --- loss: 0.968953, loss_ss: 0.761275, loss_d: 0.207677
0.7299 --- loss: 1.460096, loss_ss: 0.794144, loss_d: 0.665952
0.7683 --- loss: 1.369684, loss_ss: 1.000808, loss_d: 0.368876
0.8068 --- loss: 1.408928, loss_ss: 0.949639, loss_d: 0.459289
0.8452 --- loss: 1.272923, loss_ss: 0.791818, loss_d: 0.481105
0.8836 --- loss: 1.159776, loss_ss: 0.939086, loss_d: 0.220690
0.9220 --- loss: 2.297700, loss_ss: 0.842753, loss_d: 1.454947
0.9604 --- loss: 1.343260, loss_ss: 1.005609, loss_d: 0.337651
0.9988 --- loss: 2.454261, loss_ss: 1.048764, loss_d: 1.405497
Epoch finished! Loss: 1.4008521476617226
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.590604, loss_ss: 1.018296, loss_d: 0.572308
0.0384 --- loss: 1.551431, loss_ss: 1.050939, loss_d: 0.500492
0.0768 --- loss: 1.218103, loss_ss: 0.808074, loss_d: 0.410029
0.1153 --- loss: 1.208596, loss_ss: 0.902096, loss_d: 0.306499
0.1537 --- loss: 1.015306, loss_ss: 0.672440, loss_d: 0.342866
0.1921 --- loss: 1.207984, loss_ss: 0.793405, loss_d: 0.414579
0.2305 --- loss: 1.823508, loss_ss: 1.112785, loss_d: 0.710723
0.2689 --- loss: 1.564908, loss_ss: 0.903304, loss_d: 0.661604
0.3073 --- loss: 1.545976, loss_ss: 0.950835, loss_d: 0.595141
0.3458 --- loss: 1.280039, loss_ss: 0.886049, loss_d: 0.393990
0.3842 --- loss: 1.184330, loss_ss: 0.831960, loss_d: 0.352370
0.4226 --- loss: 1.182030, loss_ss: 0.850216, loss_d: 0.331814
0.4610 --- loss: 1.111293, loss_ss: 0.879124, loss_d: 0.232169
0.4994 --- loss: 1.297516, loss_ss: 0.906110, loss_d: 0.391406
0.5378 --- loss: 1.165870, loss_ss: 0.893298, loss_d: 0.272571
0.5763 --- loss: 1.114406, loss_ss: 0.915603, loss_d: 0.198803
0.6147 --- loss: 1.300095, loss_ss: 0.990628, loss_d: 0.309468
0.6531 --- loss: 0.982515, loss_ss: 0.795215, loss_d: 0.187300
0.6915 --- loss: 1.085907, loss_ss: 0.953131, loss_d: 0.132776
0.7299 --- loss: 0.994886, loss_ss: 0.721324, loss_d: 0.273562
0.7683 --- loss: 1.385527, loss_ss: 1.178816, loss_d: 0.206711
0.8068 --- loss: 1.179557, loss_ss: 0.908713, loss_d: 0.270844
0.8452 --- loss: 1.161948, loss_ss: 0.677273, loss_d: 0.484675
0.8836 --- loss: 1.615002, loss_ss: 1.118766, loss_d: 0.496236
0.9220 --- loss: 1.559313, loss_ss: 0.779918, loss_d: 0.779394
0.9604 --- loss: 1.109497, loss_ss: 0.662970, loss_d: 0.446526
0.9988 --- loss: 1.641995, loss_ss: 0.730001, loss_d: 0.911994
Epoch finished! Loss: 1.315996662240762
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.181765, loss_ss: 0.820014, loss_d: 0.361751
0.0384 --- loss: 1.395014, loss_ss: 0.921727, loss_d: 0.473286
0.0768 --- loss: 1.068664, loss_ss: 0.701384, loss_d: 0.367279
0.1153 --- loss: 1.481230, loss_ss: 1.198581, loss_d: 0.282649
0.1537 --- loss: 1.405261, loss_ss: 1.031942, loss_d: 0.373319
0.1921 --- loss: 1.428943, loss_ss: 0.793258, loss_d: 0.635685
0.2305 --- loss: 1.399394, loss_ss: 0.864169, loss_d: 0.535225
0.2689 --- loss: 1.233759, loss_ss: 0.975097, loss_d: 0.258662
0.3073 --- loss: 1.384957, loss_ss: 0.924637, loss_d: 0.460319
0.3458 --- loss: 1.680632, loss_ss: 0.946563, loss_d: 0.734069
0.3842 --- loss: 1.348211, loss_ss: 1.027654, loss_d: 0.320557
0.4226 --- loss: 1.332731, loss_ss: 0.856462, loss_d: 0.476269
0.4610 --- loss: 1.513863, loss_ss: 0.920366, loss_d: 0.593497
0.4994 --- loss: 0.863054, loss_ss: 0.672999, loss_d: 0.190055
0.5378 --- loss: 1.228470, loss_ss: 1.033931, loss_d: 0.194539
0.5763 --- loss: 2.006282, loss_ss: 0.823284, loss_d: 1.182998
0.6147 --- loss: 1.285296, loss_ss: 0.912452, loss_d: 0.372844
0.6531 --- loss: 1.271812, loss_ss: 0.969559, loss_d: 0.302253
0.6915 --- loss: 1.016627, loss_ss: 0.836449, loss_d: 0.180178
0.7299 --- loss: 1.297457, loss_ss: 0.884305, loss_d: 0.413152
0.7683 --- loss: 1.562909, loss_ss: 1.306450, loss_d: 0.256459
0.8068 --- loss: 1.140369, loss_ss: 0.610419, loss_d: 0.529950
0.8452 --- loss: 1.591562, loss_ss: 1.286870, loss_d: 0.304692
0.8836 --- loss: 1.447925, loss_ss: 0.871098, loss_d: 0.576827
0.9220 --- loss: 1.004333, loss_ss: 0.782666, loss_d: 0.221667
0.9604 --- loss: 0.994167, loss_ss: 0.798392, loss_d: 0.195775
0.9988 --- loss: 2.261647, loss_ss: 0.934881, loss_d: 1.326765
Epoch finished! Loss: 1.3015809721671618
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.075028, loss_ss: 0.779549, loss_d: 0.295479
0.0384 --- loss: 1.232637, loss_ss: 0.926347, loss_d: 0.306290
0.0768 --- loss: 1.290324, loss_ss: 0.963331, loss_d: 0.326992
0.1153 --- loss: 1.701545, loss_ss: 1.159611, loss_d: 0.541934
0.1537 --- loss: 1.020812, loss_ss: 0.806258, loss_d: 0.214555
0.1921 --- loss: 0.997916, loss_ss: 0.757312, loss_d: 0.240604
0.2305 --- loss: 0.739723, loss_ss: 0.588497, loss_d: 0.151226
0.2689 --- loss: 1.109471, loss_ss: 0.784211, loss_d: 0.325260
0.3073 --- loss: 1.341258, loss_ss: 1.114021, loss_d: 0.227237
0.3458 --- loss: 1.096978, loss_ss: 0.955609, loss_d: 0.141369
0.3842 --- loss: 1.013510, loss_ss: 0.802754, loss_d: 0.210755
0.4226 --- loss: 1.184706, loss_ss: 0.995903, loss_d: 0.188803
0.4610 --- loss: 2.261535, loss_ss: 1.662481, loss_d: 0.599055
0.4994 --- loss: 1.484524, loss_ss: 0.848130, loss_d: 0.636394
0.5378 --- loss: 1.275003, loss_ss: 0.736229, loss_d: 0.538774
0.5763 --- loss: 1.065254, loss_ss: 0.870987, loss_d: 0.194268
0.6147 --- loss: 1.141592, loss_ss: 0.844897, loss_d: 0.296696
0.6531 --- loss: 1.222882, loss_ss: 0.906289, loss_d: 0.316594
0.6915 --- loss: 1.069465, loss_ss: 0.861933, loss_d: 0.207532
0.7299 --- loss: 1.462875, loss_ss: 1.001802, loss_d: 0.461072
0.7683 --- loss: 0.946976, loss_ss: 0.685945, loss_d: 0.261032
0.8068 --- loss: 1.151939, loss_ss: 0.907819, loss_d: 0.244120
0.8452 --- loss: 1.095240, loss_ss: 0.884231, loss_d: 0.211009
0.8836 --- loss: 1.135227, loss_ss: 0.877561, loss_d: 0.257666
0.9220 --- loss: 1.197270, loss_ss: 0.711512, loss_d: 0.485758
0.9604 --- loss: 1.025137, loss_ss: 0.785766, loss_d: 0.239371
0.9988 --- loss: 0.947014, loss_ss: 0.840577, loss_d: 0.106438
Epoch finished! Loss: 1.2465435305467019
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.974704, loss_ss: 0.784722, loss_d: 0.189982
0.0384 --- loss: 1.833791, loss_ss: 1.080286, loss_d: 0.753505
0.0768 --- loss: 1.010215, loss_ss: 0.718459, loss_d: 0.291756
0.1153 --- loss: 1.220841, loss_ss: 0.981861, loss_d: 0.238980
0.1537 --- loss: 1.104043, loss_ss: 0.805525, loss_d: 0.298518
0.1921 --- loss: 1.788707, loss_ss: 0.813934, loss_d: 0.974773
0.2305 --- loss: 0.966613, loss_ss: 0.723575, loss_d: 0.243038
0.2689 --- loss: 1.301118, loss_ss: 0.729150, loss_d: 0.571968
0.3073 --- loss: 1.034779, loss_ss: 0.778534, loss_d: 0.256245
0.3458 --- loss: 1.243185, loss_ss: 1.022745, loss_d: 0.220440
0.3842 --- loss: 1.278227, loss_ss: 1.058063, loss_d: 0.220164
0.4226 --- loss: 1.838122, loss_ss: 1.243246, loss_d: 0.594876
0.4610 --- loss: 1.051197, loss_ss: 0.768144, loss_d: 0.283053
0.4994 --- loss: 1.690863, loss_ss: 1.249944, loss_d: 0.440920
0.5378 --- loss: 1.191711, loss_ss: 1.019458, loss_d: 0.172253
0.5763 --- loss: 0.753823, loss_ss: 0.643178, loss_d: 0.110645
0.6147 --- loss: 0.899536, loss_ss: 0.749762, loss_d: 0.149774
0.6531 --- loss: 1.716901, loss_ss: 1.563689, loss_d: 0.153212
0.6915 --- loss: 1.014845, loss_ss: 0.753516, loss_d: 0.261329
0.7299 --- loss: 1.395319, loss_ss: 0.905971, loss_d: 0.489347
0.7683 --- loss: 0.892034, loss_ss: 0.640909, loss_d: 0.251124
0.8068 --- loss: 1.096478, loss_ss: 0.595640, loss_d: 0.500838
0.8452 --- loss: 1.066541, loss_ss: 0.898052, loss_d: 0.168490
0.8836 --- loss: 0.963550, loss_ss: 0.697932, loss_d: 0.265618
0.9220 --- loss: 1.425941, loss_ss: 0.880064, loss_d: 0.545877
0.9604 --- loss: 1.058770, loss_ss: 0.948313, loss_d: 0.110458
0.9988 --- loss: 1.255213, loss_ss: 0.785202, loss_d: 0.470012
Epoch finished! Loss: 1.194958497927739
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.116705, loss_ss: 0.899230, loss_d: 0.217475
0.0384 --- loss: 1.181396, loss_ss: 0.842842, loss_d: 0.338555
0.0768 --- loss: 1.739022, loss_ss: 1.265841, loss_d: 0.473181
0.1153 --- loss: 1.248578, loss_ss: 1.118304, loss_d: 0.130274
0.1537 --- loss: 1.407951, loss_ss: 1.264148, loss_d: 0.143803
0.1921 --- loss: 1.181262, loss_ss: 0.974903, loss_d: 0.206359
0.2305 --- loss: 1.230337, loss_ss: 0.868696, loss_d: 0.361641
0.2689 --- loss: 1.251059, loss_ss: 0.822304, loss_d: 0.428755
0.3073 --- loss: 1.005872, loss_ss: 0.795401, loss_d: 0.210471
0.3458 --- loss: 1.183438, loss_ss: 0.986327, loss_d: 0.197111
0.3842 --- loss: 1.147340, loss_ss: 0.801333, loss_d: 0.346007
0.4226 --- loss: 1.136445, loss_ss: 0.570380, loss_d: 0.566065
0.4610 --- loss: 0.912687, loss_ss: 0.773026, loss_d: 0.139661
0.4994 --- loss: 1.103164, loss_ss: 0.951097, loss_d: 0.152067
0.5378 --- loss: 1.070520, loss_ss: 0.808076, loss_d: 0.262444
0.5763 --- loss: 1.044391, loss_ss: 0.762235, loss_d: 0.282156
0.6147 --- loss: 1.587414, loss_ss: 1.115250, loss_d: 0.472165
0.6531 --- loss: 0.814247, loss_ss: 0.579049, loss_d: 0.235198
0.6915 --- loss: 0.807592, loss_ss: 0.656142, loss_d: 0.151451
0.7299 --- loss: 1.531597, loss_ss: 0.878986, loss_d: 0.652611
0.7683 --- loss: 1.115816, loss_ss: 0.871880, loss_d: 0.243936
0.8068 --- loss: 0.804775, loss_ss: 0.635706, loss_d: 0.169069
0.8452 --- loss: 1.091084, loss_ss: 0.683215, loss_d: 0.407869
0.8836 --- loss: 0.884581, loss_ss: 0.610574, loss_d: 0.274006
0.9220 --- loss: 1.248311, loss_ss: 0.923991, loss_d: 0.324320
0.9604 --- loss: 1.496214, loss_ss: 1.078147, loss_d: 0.418066
0.9988 --- loss: 1.301969, loss_ss: 0.730264, loss_d: 0.571705
Epoch finished! Loss: 1.179848565046604
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7114285714285714
             precision    recall  f1-score   support

        0.0       0.97      0.56      0.71       163
        1.0       0.00      0.00      0.00       142
        2.0       0.62      0.98      0.76       329
        3.0       0.96      0.74      0.84       200
        4.0       0.66      0.86      0.75       216

avg / total       0.66      0.71      0.66      1050
 


====== chp040-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  92.95  56.44   99.66  96.84     71.32
1  86.38   0.00   99.89   0.00      0.00
2  80.48  97.57   72.68  61.97     75.80
3  94.48  74.50   99.18  95.51     83.71
4  88.00  85.65   88.61  66.07     74.60
Total accuracy: 71.14%
Average sen: 62.83%
Average spec: 92.00%
Macro f1-score: 61.08%
Diagnosis acc on 15mins: 1.0
[0.97225797 0.97317058 0.83168513 0.92301393 0.80412877 0.93346483
 0.80131745 0.98424709 0.89482915 0.96516901 0.95866352 0.9237721
 0.96704549 0.95461631 0.83899486 0.79368007 0.63421798 0.88303626
 0.78102553 0.94043493 0.98390168 0.89257938 0.98798174 0.97019714
 0.78347182 0.83364171 0.83099395 0.8884989  0.86892074 0.94501585
 0.92348552 0.83935016 0.89046806 0.96116799 0.98844564]
pred: 0.8956254635538373, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp041-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.563028, loss_ss: 1.785816, loss_d: 0.777211
0.0384 --- loss: 3.267310, loss_ss: 1.715004, loss_d: 1.552306
0.0769 --- loss: 2.280249, loss_ss: 1.527547, loss_d: 0.752702
0.1153 --- loss: 2.378171, loss_ss: 1.605595, loss_d: 0.772576
0.1537 --- loss: 1.963288, loss_ss: 1.416949, loss_d: 0.546340
0.1922 --- loss: 2.203988, loss_ss: 1.414591, loss_d: 0.789397
0.2306 --- loss: 1.887382, loss_ss: 1.357284, loss_d: 0.530098
0.2690 --- loss: 2.084162, loss_ss: 1.294677, loss_d: 0.789485
0.3075 --- loss: 2.021764, loss_ss: 1.453307, loss_d: 0.568457
0.3459 --- loss: 1.586334, loss_ss: 1.195852, loss_d: 0.390483
0.3843 --- loss: 1.595606, loss_ss: 1.285351, loss_d: 0.310255
0.4228 --- loss: 1.966481, loss_ss: 1.377467, loss_d: 0.589014
0.4612 --- loss: 1.552735, loss_ss: 1.128054, loss_d: 0.424681
0.4996 --- loss: 1.946492, loss_ss: 1.477216, loss_d: 0.469276
0.5380 --- loss: 2.022474, loss_ss: 1.525013, loss_d: 0.497461
0.5765 --- loss: 2.028159, loss_ss: 1.428171, loss_d: 0.599988
0.6149 --- loss: 1.956363, loss_ss: 1.329453, loss_d: 0.626910
0.6533 --- loss: 2.180150, loss_ss: 1.449189, loss_d: 0.730960
0.6918 --- loss: 2.004113, loss_ss: 1.277613, loss_d: 0.726500
0.7302 --- loss: 2.346618, loss_ss: 1.545150, loss_d: 0.801468
0.7686 --- loss: 1.724943, loss_ss: 1.234945, loss_d: 0.489998
0.8071 --- loss: 1.764904, loss_ss: 1.227023, loss_d: 0.537881
0.8455 --- loss: 1.763055, loss_ss: 1.284461, loss_d: 0.478594
0.8839 --- loss: 1.835117, loss_ss: 1.229658, loss_d: 0.605459
0.9224 --- loss: 2.208881, loss_ss: 1.527075, loss_d: 0.681806
0.9608 --- loss: 2.019361, loss_ss: 1.428899, loss_d: 0.590462
0.9992 --- loss: 2.079808, loss_ss: 1.664988, loss_d: 0.414820
Epoch finished! Loss: 1.954810590010423
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.609855, loss_ss: 1.046292, loss_d: 0.563563
0.0384 --- loss: 1.971987, loss_ss: 1.368308, loss_d: 0.603679
0.0769 --- loss: 1.528516, loss_ss: 1.099567, loss_d: 0.428949
0.1153 --- loss: 1.795699, loss_ss: 1.253321, loss_d: 0.542378
0.1537 --- loss: 1.598936, loss_ss: 1.111962, loss_d: 0.486974
0.1922 --- loss: 1.905594, loss_ss: 1.225868, loss_d: 0.679725
0.2306 --- loss: 1.471355, loss_ss: 1.043531, loss_d: 0.427824
0.2690 --- loss: 2.315933, loss_ss: 1.183755, loss_d: 1.132179
0.3075 --- loss: 1.741533, loss_ss: 1.114229, loss_d: 0.627304
0.3459 --- loss: 1.762540, loss_ss: 1.098369, loss_d: 0.664171
0.3843 --- loss: 1.752208, loss_ss: 1.148721, loss_d: 0.603486
0.4228 --- loss: 1.835005, loss_ss: 1.133356, loss_d: 0.701649
0.4612 --- loss: 1.464127, loss_ss: 0.965191, loss_d: 0.498936
0.4996 --- loss: 1.517098, loss_ss: 0.969797, loss_d: 0.547301
0.5380 --- loss: 1.532784, loss_ss: 1.058496, loss_d: 0.474288
0.5765 --- loss: 1.871065, loss_ss: 1.320500, loss_d: 0.550564
0.6149 --- loss: 1.612310, loss_ss: 1.278849, loss_d: 0.333461
0.6533 --- loss: 1.545930, loss_ss: 0.883527, loss_d: 0.662403
0.6918 --- loss: 1.885116, loss_ss: 1.146368, loss_d: 0.738748
0.7302 --- loss: 1.609955, loss_ss: 1.193730, loss_d: 0.416225
0.7686 --- loss: 1.397580, loss_ss: 1.073846, loss_d: 0.323735
0.8071 --- loss: 1.598847, loss_ss: 1.279059, loss_d: 0.319788
0.8455 --- loss: 1.537482, loss_ss: 0.919436, loss_d: 0.618046
0.8839 --- loss: 1.487048, loss_ss: 1.066196, loss_d: 0.420852
0.9224 --- loss: 1.471939, loss_ss: 1.069150, loss_d: 0.402789
0.9608 --- loss: 1.750218, loss_ss: 1.110184, loss_d: 0.640033
0.9992 --- loss: 2.429243, loss_ss: 1.341171, loss_d: 1.088072
Epoch finished! Loss: 1.7172902469451612
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.584840, loss_ss: 0.837657, loss_d: 0.747183
0.0384 --- loss: 1.658669, loss_ss: 1.038734, loss_d: 0.619935
0.0769 --- loss: 1.532063, loss_ss: 0.977466, loss_d: 0.554597
0.1153 --- loss: 1.792268, loss_ss: 1.271416, loss_d: 0.520852
0.1537 --- loss: 1.625118, loss_ss: 1.100422, loss_d: 0.524696
0.1922 --- loss: 1.763303, loss_ss: 1.221331, loss_d: 0.541972
0.2306 --- loss: 1.808199, loss_ss: 1.242790, loss_d: 0.565409
0.2690 --- loss: 1.792923, loss_ss: 1.276770, loss_d: 0.516153
0.3075 --- loss: 1.772714, loss_ss: 0.735273, loss_d: 1.037441
0.3459 --- loss: 1.414577, loss_ss: 0.918232, loss_d: 0.496346
0.3843 --- loss: 1.575738, loss_ss: 1.162990, loss_d: 0.412748
0.4228 --- loss: 1.642292, loss_ss: 1.122679, loss_d: 0.519613
0.4612 --- loss: 1.617033, loss_ss: 1.030557, loss_d: 0.586477
0.4996 --- loss: 1.665665, loss_ss: 1.042351, loss_d: 0.623315
0.5380 --- loss: 1.884652, loss_ss: 1.125234, loss_d: 0.759418
0.5765 --- loss: 1.780508, loss_ss: 0.916529, loss_d: 0.863979
0.6149 --- loss: 1.433523, loss_ss: 0.812016, loss_d: 0.621507
0.6533 --- loss: 1.584683, loss_ss: 0.989159, loss_d: 0.595525
0.6918 --- loss: 1.609642, loss_ss: 1.026430, loss_d: 0.583211
0.7302 --- loss: 1.544000, loss_ss: 1.007469, loss_d: 0.536531
0.7686 --- loss: 1.761484, loss_ss: 1.013981, loss_d: 0.747503
0.8071 --- loss: 1.539585, loss_ss: 1.029462, loss_d: 0.510123
0.8455 --- loss: 1.688980, loss_ss: 0.944957, loss_d: 0.744023
0.8839 --- loss: 1.855140, loss_ss: 1.291255, loss_d: 0.563886
0.9224 --- loss: 1.745979, loss_ss: 1.224380, loss_d: 0.521599
0.9608 --- loss: 1.654643, loss_ss: 1.132703, loss_d: 0.521941
0.9992 --- loss: 2.035906, loss_ss: 1.760513, loss_d: 0.275394
Epoch finished! Loss: 1.5923457966401027
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.312944, loss_ss: 0.941019, loss_d: 0.371925
0.0384 --- loss: 1.360772, loss_ss: 1.004399, loss_d: 0.356373
0.0769 --- loss: 1.393807, loss_ss: 0.912451, loss_d: 0.481356
0.1153 --- loss: 1.509602, loss_ss: 1.034628, loss_d: 0.474974
0.1537 --- loss: 1.988089, loss_ss: 1.165856, loss_d: 0.822232
0.1922 --- loss: 1.523210, loss_ss: 1.023016, loss_d: 0.500195
0.2306 --- loss: 1.444781, loss_ss: 0.847123, loss_d: 0.597658
0.2690 --- loss: 1.510845, loss_ss: 1.033136, loss_d: 0.477709
0.3075 --- loss: 1.823978, loss_ss: 1.435074, loss_d: 0.388904
0.3459 --- loss: 1.200598, loss_ss: 0.748891, loss_d: 0.451707
0.3843 --- loss: 1.710667, loss_ss: 1.257817, loss_d: 0.452849
0.4228 --- loss: 1.866587, loss_ss: 1.120556, loss_d: 0.746030
0.4612 --- loss: 1.232294, loss_ss: 0.857490, loss_d: 0.374804
0.4996 --- loss: 1.378039, loss_ss: 0.891248, loss_d: 0.486791
0.5380 --- loss: 1.451215, loss_ss: 0.977891, loss_d: 0.473324
0.5765 --- loss: 1.337903, loss_ss: 0.976265, loss_d: 0.361638
0.6149 --- loss: 1.463095, loss_ss: 0.956499, loss_d: 0.506596
0.6533 --- loss: 1.538109, loss_ss: 1.085888, loss_d: 0.452221
0.6918 --- loss: 1.504493, loss_ss: 1.028415, loss_d: 0.476078
0.7302 --- loss: 1.797071, loss_ss: 0.986895, loss_d: 0.810176
0.7686 --- loss: 1.161824, loss_ss: 0.899454, loss_d: 0.262370
0.8071 --- loss: 1.364737, loss_ss: 0.794693, loss_d: 0.570044
0.8455 --- loss: 1.537094, loss_ss: 1.197453, loss_d: 0.339641
0.8839 --- loss: 1.267341, loss_ss: 0.816585, loss_d: 0.450756
0.9224 --- loss: 1.687679, loss_ss: 0.891951, loss_d: 0.795728
0.9608 --- loss: 1.163440, loss_ss: 0.706320, loss_d: 0.457120
0.9992 --- loss: 1.423360, loss_ss: 1.097072, loss_d: 0.326289
Epoch finished! Loss: 1.5079308124688955
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.402947, loss_ss: 0.932663, loss_d: 0.470284
0.0384 --- loss: 1.526759, loss_ss: 0.931700, loss_d: 0.595059
0.0769 --- loss: 1.227212, loss_ss: 0.989523, loss_d: 0.237688
0.1153 --- loss: 1.514735, loss_ss: 0.883664, loss_d: 0.631070
0.1537 --- loss: 1.289899, loss_ss: 0.816151, loss_d: 0.473748
0.1922 --- loss: 1.475833, loss_ss: 0.857062, loss_d: 0.618771
0.2306 --- loss: 1.431757, loss_ss: 0.897054, loss_d: 0.534703
0.2690 --- loss: 1.162661, loss_ss: 0.803685, loss_d: 0.358976
0.3075 --- loss: 1.703970, loss_ss: 1.018142, loss_d: 0.685828
0.3459 --- loss: 1.172800, loss_ss: 0.906587, loss_d: 0.266214
0.3843 --- loss: 1.194988, loss_ss: 0.942678, loss_d: 0.252310
0.4228 --- loss: 1.760339, loss_ss: 0.740703, loss_d: 1.019635
0.4612 --- loss: 1.444997, loss_ss: 1.183029, loss_d: 0.261968
0.4996 --- loss: 1.440703, loss_ss: 0.951206, loss_d: 0.489497
0.5380 --- loss: 1.826436, loss_ss: 0.959448, loss_d: 0.866988
0.5765 --- loss: 1.215097, loss_ss: 0.969528, loss_d: 0.245569
0.6149 --- loss: 1.504770, loss_ss: 1.066008, loss_d: 0.438763
0.6533 --- loss: 1.353054, loss_ss: 1.018144, loss_d: 0.334910
0.6918 --- loss: 1.237235, loss_ss: 1.009865, loss_d: 0.227370
0.7302 --- loss: 1.330101, loss_ss: 0.805654, loss_d: 0.524447
0.7686 --- loss: 1.385527, loss_ss: 0.956846, loss_d: 0.428681
0.8071 --- loss: 1.376340, loss_ss: 0.917388, loss_d: 0.458952
0.8455 --- loss: 1.172688, loss_ss: 0.938181, loss_d: 0.234507
0.8839 --- loss: 1.393213, loss_ss: 0.763670, loss_d: 0.629542
0.9224 --- loss: 1.185709, loss_ss: 0.886941, loss_d: 0.298768
0.9608 --- loss: 1.214299, loss_ss: 0.921237, loss_d: 0.293062
0.9992 --- loss: 1.571130, loss_ss: 1.356053, loss_d: 0.215077
Epoch finished! Loss: 1.3814676344394683
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.958644, loss_ss: 0.598108, loss_d: 0.360536
0.0384 --- loss: 1.046258, loss_ss: 0.848986, loss_d: 0.197273
0.0769 --- loss: 1.464522, loss_ss: 1.085803, loss_d: 0.378719
0.1153 --- loss: 1.606601, loss_ss: 0.794798, loss_d: 0.811803
0.1537 --- loss: 1.145731, loss_ss: 0.741584, loss_d: 0.404147
0.1922 --- loss: 1.524433, loss_ss: 1.124208, loss_d: 0.400225
0.2306 --- loss: 1.374592, loss_ss: 0.875478, loss_d: 0.499114
0.2690 --- loss: 1.128882, loss_ss: 0.735561, loss_d: 0.393321
0.3075 --- loss: 1.330996, loss_ss: 0.920928, loss_d: 0.410068
0.3459 --- loss: 1.131405, loss_ss: 0.839690, loss_d: 0.291715
0.3843 --- loss: 1.612630, loss_ss: 1.321827, loss_d: 0.290802
0.4228 --- loss: 1.426458, loss_ss: 1.018991, loss_d: 0.407466
0.4612 --- loss: 0.874330, loss_ss: 0.679414, loss_d: 0.194916
0.4996 --- loss: 1.345598, loss_ss: 0.923447, loss_d: 0.422151
0.5380 --- loss: 1.179730, loss_ss: 0.832313, loss_d: 0.347417
0.5765 --- loss: 1.097600, loss_ss: 0.841191, loss_d: 0.256409
0.6149 --- loss: 1.583941, loss_ss: 0.866398, loss_d: 0.717543
0.6533 --- loss: 1.458191, loss_ss: 1.181784, loss_d: 0.276407
0.6918 --- loss: 1.238574, loss_ss: 0.822820, loss_d: 0.415754
0.7302 --- loss: 1.501245, loss_ss: 0.971329, loss_d: 0.529916
0.7686 --- loss: 1.225677, loss_ss: 0.857405, loss_d: 0.368271
0.8071 --- loss: 1.319996, loss_ss: 1.012827, loss_d: 0.307169
0.8455 --- loss: 1.460045, loss_ss: 0.765518, loss_d: 0.694527
0.8839 --- loss: 1.241863, loss_ss: 0.821031, loss_d: 0.420832
0.9224 --- loss: 1.629011, loss_ss: 1.124670, loss_d: 0.504341
0.9608 --- loss: 0.769455, loss_ss: 0.682611, loss_d: 0.086844
0.9992 --- loss: 3.591943, loss_ss: 1.129428, loss_d: 2.462515
Epoch finished! Loss: 1.292648005256286
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.252887, loss_ss: 0.903927, loss_d: 0.348960
0.0384 --- loss: 0.856022, loss_ss: 0.684894, loss_d: 0.171128
0.0769 --- loss: 1.245870, loss_ss: 0.809914, loss_d: 0.435957
0.1153 --- loss: 1.491945, loss_ss: 1.250670, loss_d: 0.241275
0.1537 --- loss: 1.648917, loss_ss: 0.935105, loss_d: 0.713812
0.1922 --- loss: 1.213186, loss_ss: 0.998516, loss_d: 0.214670
0.2306 --- loss: 1.453538, loss_ss: 0.785138, loss_d: 0.668400
0.2690 --- loss: 1.365285, loss_ss: 0.697622, loss_d: 0.667663
0.3075 --- loss: 1.287082, loss_ss: 0.734451, loss_d: 0.552631
0.3459 --- loss: 1.149659, loss_ss: 0.636266, loss_d: 0.513394
0.3843 --- loss: 1.208104, loss_ss: 0.911799, loss_d: 0.296304
0.4228 --- loss: 1.495463, loss_ss: 1.028426, loss_d: 0.467037
0.4612 --- loss: 0.901954, loss_ss: 0.725084, loss_d: 0.176870
0.4996 --- loss: 1.405591, loss_ss: 0.993201, loss_d: 0.412390
0.5380 --- loss: 1.154327, loss_ss: 1.058749, loss_d: 0.095578
0.5765 --- loss: 1.325491, loss_ss: 1.041126, loss_d: 0.284365
0.6149 --- loss: 1.125813, loss_ss: 0.850109, loss_d: 0.275703
0.6533 --- loss: 1.447071, loss_ss: 1.031432, loss_d: 0.415639
0.6918 --- loss: 1.197912, loss_ss: 0.863887, loss_d: 0.334025
0.7302 --- loss: 1.206278, loss_ss: 0.973939, loss_d: 0.232339
0.7686 --- loss: 1.053285, loss_ss: 0.783280, loss_d: 0.270005
0.8071 --- loss: 1.439228, loss_ss: 1.112524, loss_d: 0.326704
0.8455 --- loss: 1.208766, loss_ss: 0.798182, loss_d: 0.410584
0.8839 --- loss: 1.265901, loss_ss: 1.004183, loss_d: 0.261718
0.9224 --- loss: 1.405755, loss_ss: 0.963615, loss_d: 0.442140
0.9608 --- loss: 1.041052, loss_ss: 0.840385, loss_d: 0.200666
0.9992 --- loss: 1.156767, loss_ss: 1.019720, loss_d: 0.137047
Epoch finished! Loss: 1.2315966794124016
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.474292, loss_ss: 0.877082, loss_d: 0.597210
0.0384 --- loss: 1.239580, loss_ss: 0.826707, loss_d: 0.412873
0.0769 --- loss: 0.877495, loss_ss: 0.704703, loss_d: 0.172792
0.1153 --- loss: 1.564789, loss_ss: 1.377303, loss_d: 0.187485
0.1537 --- loss: 1.367667, loss_ss: 0.623034, loss_d: 0.744633
0.1922 --- loss: 1.152693, loss_ss: 0.833427, loss_d: 0.319265
0.2306 --- loss: 1.146365, loss_ss: 0.622896, loss_d: 0.523469
0.2690 --- loss: 1.433206, loss_ss: 0.998352, loss_d: 0.434854
0.3075 --- loss: 1.102915, loss_ss: 0.856739, loss_d: 0.246176
0.3459 --- loss: 0.805438, loss_ss: 0.693597, loss_d: 0.111841
0.3843 --- loss: 1.335096, loss_ss: 1.041859, loss_d: 0.293237
0.4228 --- loss: 1.350225, loss_ss: 1.008352, loss_d: 0.341873
0.4612 --- loss: 0.807076, loss_ss: 0.679900, loss_d: 0.127176
0.4996 --- loss: 1.385176, loss_ss: 0.940040, loss_d: 0.445136
0.5380 --- loss: 1.321960, loss_ss: 1.068153, loss_d: 0.253807
0.5765 --- loss: 1.099703, loss_ss: 0.861005, loss_d: 0.238699
0.6149 --- loss: 1.191977, loss_ss: 0.872774, loss_d: 0.319202
0.6533 --- loss: 0.897731, loss_ss: 0.707233, loss_d: 0.190498
0.6918 --- loss: 1.330071, loss_ss: 0.929908, loss_d: 0.400164
0.7302 --- loss: 1.039179, loss_ss: 0.893649, loss_d: 0.145530
0.7686 --- loss: 1.301366, loss_ss: 1.029267, loss_d: 0.272099
0.8071 --- loss: 0.896267, loss_ss: 0.802311, loss_d: 0.093956
0.8455 --- loss: 1.513637, loss_ss: 0.944620, loss_d: 0.569017
0.8839 --- loss: 1.374821, loss_ss: 1.157187, loss_d: 0.217634
0.9224 --- loss: 1.382067, loss_ss: 1.071944, loss_d: 0.310123
0.9608 --- loss: 0.904645, loss_ss: 0.804547, loss_d: 0.100098
0.9992 --- loss: 5.112893, loss_ss: 1.767474, loss_d: 3.345419
Epoch finished! Loss: 1.1972521096467972
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.802295, loss_ss: 0.606880, loss_d: 0.195415
0.0384 --- loss: 1.004931, loss_ss: 0.797082, loss_d: 0.207849
0.0769 --- loss: 1.009426, loss_ss: 0.850368, loss_d: 0.159058
0.1153 --- loss: 1.387846, loss_ss: 1.105634, loss_d: 0.282212
0.1537 --- loss: 0.786991, loss_ss: 0.680311, loss_d: 0.106680
0.1922 --- loss: 1.326936, loss_ss: 0.830644, loss_d: 0.496291
0.2306 --- loss: 1.217035, loss_ss: 0.879520, loss_d: 0.337514
0.2690 --- loss: 1.057405, loss_ss: 0.559090, loss_d: 0.498315
0.3075 --- loss: 1.031852, loss_ss: 0.975692, loss_d: 0.056160
0.3459 --- loss: 0.694451, loss_ss: 0.618083, loss_d: 0.076368
0.3843 --- loss: 1.259823, loss_ss: 0.640239, loss_d: 0.619584
0.4228 --- loss: 0.781402, loss_ss: 0.615624, loss_d: 0.165778
0.4612 --- loss: 1.028240, loss_ss: 0.907767, loss_d: 0.120473
0.4996 --- loss: 0.947688, loss_ss: 0.859953, loss_d: 0.087735
0.5380 --- loss: 1.015015, loss_ss: 0.851737, loss_d: 0.163279
0.5765 --- loss: 1.283549, loss_ss: 0.679417, loss_d: 0.604132
0.6149 --- loss: 1.431231, loss_ss: 0.915464, loss_d: 0.515767
0.6533 --- loss: 0.736466, loss_ss: 0.575764, loss_d: 0.160701
0.6918 --- loss: 0.879653, loss_ss: 0.656177, loss_d: 0.223476
0.7302 --- loss: 1.063986, loss_ss: 0.777362, loss_d: 0.286624
0.7686 --- loss: 1.042015, loss_ss: 0.936209, loss_d: 0.105806
0.8071 --- loss: 0.979334, loss_ss: 0.782901, loss_d: 0.196433
0.8455 --- loss: 1.010909, loss_ss: 0.832465, loss_d: 0.178444
0.8839 --- loss: 1.577392, loss_ss: 0.640698, loss_d: 0.936694
0.9224 --- loss: 1.907419, loss_ss: 1.249250, loss_d: 0.658169
0.9608 --- loss: 1.076354, loss_ss: 0.776908, loss_d: 0.299445
0.9992 --- loss: 1.105301, loss_ss: 0.669650, loss_d: 0.435651
Epoch finished! Loss: 1.1520652564672322
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.872466, loss_ss: 0.729046, loss_d: 0.143421
0.0384 --- loss: 0.987923, loss_ss: 0.847525, loss_d: 0.140398
0.0769 --- loss: 0.856810, loss_ss: 0.592888, loss_d: 0.263922
0.1153 --- loss: 1.490223, loss_ss: 0.835054, loss_d: 0.655169
0.1537 --- loss: 1.240523, loss_ss: 0.818106, loss_d: 0.422417
0.1922 --- loss: 0.982433, loss_ss: 0.660942, loss_d: 0.321491
0.2306 --- loss: 0.823738, loss_ss: 0.652698, loss_d: 0.171040
0.2690 --- loss: 0.925255, loss_ss: 0.713161, loss_d: 0.212093
0.3075 --- loss: 1.544959, loss_ss: 0.895627, loss_d: 0.649333
0.3459 --- loss: 0.958256, loss_ss: 0.796280, loss_d: 0.161976
0.3843 --- loss: 0.887263, loss_ss: 0.617771, loss_d: 0.269492
0.4228 --- loss: 1.304740, loss_ss: 1.002828, loss_d: 0.301912
0.4612 --- loss: 1.130392, loss_ss: 0.866518, loss_d: 0.263874
0.4996 --- loss: 0.908910, loss_ss: 0.719866, loss_d: 0.189044
0.5380 --- loss: 0.830277, loss_ss: 0.726531, loss_d: 0.103747
0.5765 --- loss: 0.947826, loss_ss: 0.741589, loss_d: 0.206236
0.6149 --- loss: 0.901593, loss_ss: 0.715056, loss_d: 0.186537
0.6533 --- loss: 0.937399, loss_ss: 0.764910, loss_d: 0.172489
0.6918 --- loss: 1.177348, loss_ss: 1.071214, loss_d: 0.106134
0.7302 --- loss: 1.251767, loss_ss: 0.888047, loss_d: 0.363720
0.7686 --- loss: 1.007750, loss_ss: 0.629942, loss_d: 0.377808
0.8071 --- loss: 0.928575, loss_ss: 0.816896, loss_d: 0.111679
0.8455 --- loss: 1.585926, loss_ss: 0.981088, loss_d: 0.604838
0.8839 --- loss: 1.940986, loss_ss: 0.787091, loss_d: 1.153895
0.9224 --- loss: 1.053042, loss_ss: 0.782444, loss_d: 0.270599
0.9608 --- loss: 0.956392, loss_ss: 0.880454, loss_d: 0.075938
0.9992 --- loss: 0.941535, loss_ss: 0.850488, loss_d: 0.091047
Epoch finished! Loss: 1.1081804229662968
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6527777777777778
             precision    recall  f1-score   support

        0.0       0.85      0.53      0.65       196
        1.0       0.15      0.43      0.23        58
        2.0       0.82      0.73      0.77       527
        3.0       0.26      1.00      0.41        33
        4.0       0.80      0.60      0.69       266

avg / total       0.77      0.65      0.69      1080
 


====== chp041-nsrr ======
   acc %   sen %  spec %  ppr %  f1-score
0  89.72   53.06   97.85  84.55     65.20
1  84.26   43.10   86.59  15.43     22.73
2  78.98   72.68   84.99  82.19     77.14
3  91.11  100.00   90.83  25.58     40.74
4  86.48   60.15   95.09  80.00     68.67
Total accuracy: 65.28%
Average sen: 65.80%
Average spec: 91.07%
Macro f1-score: 54.90%
Diagnosis acc on 15mins: 1.0
[0.9967103  0.97015035 0.99168831 0.98525441 0.99392772 0.9905681
 0.96676975 0.91657627 0.96234971 0.9631803  0.98841375 0.98712003
 0.99434459 0.99839765 0.99614418 0.99998236 0.96357453 0.988644
 0.90706748 0.98172987 0.99623376 0.99890447 0.99651635 0.99652356
 0.98868841 0.9989832  0.98593175 0.98927838 0.99568766 0.99641967
 0.99486709 0.99866307 0.99949837 0.98754698 0.96711326 0.99798125]
pred: 0.9842064132293066, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp042-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.357405, loss_ss: 1.644253, loss_d: 0.713152
0.0384 --- loss: 2.537545, loss_ss: 1.442731, loss_d: 1.094813
0.0769 --- loss: 2.054050, loss_ss: 1.463823, loss_d: 0.590226
0.1153 --- loss: 2.354442, loss_ss: 1.324747, loss_d: 1.029695
0.1538 --- loss: 2.054261, loss_ss: 1.451645, loss_d: 0.602616
0.1922 --- loss: 1.697796, loss_ss: 1.271969, loss_d: 0.425826
0.2307 --- loss: 1.823885, loss_ss: 1.432685, loss_d: 0.391200
0.2691 --- loss: 2.326805, loss_ss: 1.380109, loss_d: 0.946696
0.3076 --- loss: 1.957495, loss_ss: 1.271465, loss_d: 0.686030
0.3460 --- loss: 1.870615, loss_ss: 1.104648, loss_d: 0.765967
0.3845 --- loss: 1.466266, loss_ss: 1.157226, loss_d: 0.309040
0.4229 --- loss: 1.827158, loss_ss: 1.211957, loss_d: 0.615201
0.4614 --- loss: 1.896266, loss_ss: 1.164265, loss_d: 0.732001
0.4998 --- loss: 2.033837, loss_ss: 1.390426, loss_d: 0.643412
0.5383 --- loss: 2.006487, loss_ss: 1.264416, loss_d: 0.742070
0.5767 --- loss: 1.790679, loss_ss: 1.137398, loss_d: 0.653281
0.6151 --- loss: 2.028537, loss_ss: 1.269111, loss_d: 0.759426
0.6536 --- loss: 1.738679, loss_ss: 1.148167, loss_d: 0.590512
0.6920 --- loss: 1.974676, loss_ss: 1.264683, loss_d: 0.709993
0.7305 --- loss: 1.787288, loss_ss: 1.210280, loss_d: 0.577008
0.7689 --- loss: 1.714412, loss_ss: 1.264418, loss_d: 0.449994
0.8074 --- loss: 1.681677, loss_ss: 1.260317, loss_d: 0.421361
0.8458 --- loss: 1.867313, loss_ss: 1.329731, loss_d: 0.537582
0.8843 --- loss: 1.709183, loss_ss: 1.153004, loss_d: 0.556178
0.9227 --- loss: 1.723484, loss_ss: 1.230289, loss_d: 0.493194
0.9612 --- loss: 1.814803, loss_ss: 1.274264, loss_d: 0.540539
0.9996 --- loss: 1.738606, loss_ss: 1.390593, loss_d: 0.348013
Epoch finished! Loss: 1.9016523118202502
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.887876, loss_ss: 1.235483, loss_d: 0.652393
0.0384 --- loss: 1.899678, loss_ss: 1.399247, loss_d: 0.500430
0.0769 --- loss: 1.765844, loss_ss: 1.336619, loss_d: 0.429224
0.1153 --- loss: 1.611838, loss_ss: 1.108727, loss_d: 0.503111
0.1538 --- loss: 1.505208, loss_ss: 1.103648, loss_d: 0.401560
0.1922 --- loss: 1.616253, loss_ss: 1.306749, loss_d: 0.309504
0.2307 --- loss: 1.609215, loss_ss: 1.084407, loss_d: 0.524809
0.2691 --- loss: 1.968305, loss_ss: 1.078483, loss_d: 0.889822
0.3076 --- loss: 1.956586, loss_ss: 1.266005, loss_d: 0.690581
0.3460 --- loss: 1.628135, loss_ss: 1.251266, loss_d: 0.376869
0.3845 --- loss: 1.806405, loss_ss: 1.248064, loss_d: 0.558340
0.4229 --- loss: 1.536976, loss_ss: 1.186029, loss_d: 0.350947
0.4614 --- loss: 1.869715, loss_ss: 1.127697, loss_d: 0.742018
0.4998 --- loss: 1.615579, loss_ss: 0.964898, loss_d: 0.650681
0.5383 --- loss: 1.867831, loss_ss: 1.305260, loss_d: 0.562571
0.5767 --- loss: 1.879436, loss_ss: 1.215005, loss_d: 0.664431
0.6151 --- loss: 1.931839, loss_ss: 1.131473, loss_d: 0.800366
0.6536 --- loss: 1.652150, loss_ss: 1.088910, loss_d: 0.563240
0.6920 --- loss: 1.612879, loss_ss: 0.986361, loss_d: 0.626518
0.7305 --- loss: 1.309941, loss_ss: 0.883731, loss_d: 0.426210
0.7689 --- loss: 1.535858, loss_ss: 0.990964, loss_d: 0.544894
0.8074 --- loss: 1.606184, loss_ss: 1.066984, loss_d: 0.539200
0.8458 --- loss: 1.600502, loss_ss: 0.939746, loss_d: 0.660756
0.8843 --- loss: 1.424979, loss_ss: 1.019162, loss_d: 0.405817
0.9227 --- loss: 2.235520, loss_ss: 1.328700, loss_d: 0.906819
0.9612 --- loss: 1.750532, loss_ss: 0.987420, loss_d: 0.763112
0.9996 --- loss: 3.020479, loss_ss: 1.093914, loss_d: 1.926565
Epoch finished! Loss: 1.6847959692661578
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.552260, loss_ss: 1.015940, loss_d: 0.536320
0.0384 --- loss: 1.526312, loss_ss: 1.146272, loss_d: 0.380040
0.0769 --- loss: 1.787349, loss_ss: 1.124233, loss_d: 0.663116
0.1153 --- loss: 1.827774, loss_ss: 1.044672, loss_d: 0.783102
0.1538 --- loss: 1.600822, loss_ss: 1.170355, loss_d: 0.430467
0.1922 --- loss: 1.601992, loss_ss: 1.017270, loss_d: 0.584723
0.2307 --- loss: 1.289189, loss_ss: 0.928253, loss_d: 0.360937
0.2691 --- loss: 1.290368, loss_ss: 0.819752, loss_d: 0.470616
0.3076 --- loss: 1.464380, loss_ss: 1.137405, loss_d: 0.326975
0.3460 --- loss: 1.523937, loss_ss: 0.915929, loss_d: 0.608007
0.3845 --- loss: 1.710211, loss_ss: 1.144743, loss_d: 0.565468
0.4229 --- loss: 1.927082, loss_ss: 1.109469, loss_d: 0.817614
0.4614 --- loss: 1.420779, loss_ss: 0.966235, loss_d: 0.454544
0.4998 --- loss: 1.278260, loss_ss: 0.914278, loss_d: 0.363982
0.5383 --- loss: 1.465635, loss_ss: 1.122500, loss_d: 0.343136
0.5767 --- loss: 1.549944, loss_ss: 1.064586, loss_d: 0.485358
0.6151 --- loss: 1.467414, loss_ss: 0.990677, loss_d: 0.476736
0.6536 --- loss: 1.628025, loss_ss: 1.136857, loss_d: 0.491167
0.6920 --- loss: 1.598709, loss_ss: 1.066754, loss_d: 0.531954
0.7305 --- loss: 1.669351, loss_ss: 1.225101, loss_d: 0.444249
0.7689 --- loss: 1.289287, loss_ss: 0.957046, loss_d: 0.332241
0.8074 --- loss: 2.114856, loss_ss: 1.149018, loss_d: 0.965838
0.8458 --- loss: 1.692240, loss_ss: 0.913991, loss_d: 0.778249
0.8843 --- loss: 1.295233, loss_ss: 1.041383, loss_d: 0.253851
0.9227 --- loss: 1.103807, loss_ss: 0.712319, loss_d: 0.391487
0.9612 --- loss: 1.519413, loss_ss: 1.005785, loss_d: 0.513628
0.9996 --- loss: 3.574479, loss_ss: 1.540590, loss_d: 2.033889
Epoch finished! Loss: 1.5510153852976285
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.595098, loss_ss: 1.205044, loss_d: 0.390054
0.0384 --- loss: 1.547887, loss_ss: 1.003692, loss_d: 0.544195
0.0769 --- loss: 1.610982, loss_ss: 1.174292, loss_d: 0.436690
0.1153 --- loss: 1.462584, loss_ss: 1.013901, loss_d: 0.448683
0.1538 --- loss: 1.768843, loss_ss: 0.963588, loss_d: 0.805255
0.1922 --- loss: 1.351018, loss_ss: 0.847553, loss_d: 0.503465
0.2307 --- loss: 1.630434, loss_ss: 1.085681, loss_d: 0.544753
0.2691 --- loss: 1.417950, loss_ss: 1.087837, loss_d: 0.330113
0.3076 --- loss: 1.510885, loss_ss: 0.988029, loss_d: 0.522856
0.3460 --- loss: 1.544068, loss_ss: 0.809330, loss_d: 0.734737
0.3845 --- loss: 1.307040, loss_ss: 1.035895, loss_d: 0.271146
0.4229 --- loss: 1.422130, loss_ss: 0.858590, loss_d: 0.563540
0.4614 --- loss: 1.691044, loss_ss: 1.228769, loss_d: 0.462275
0.4998 --- loss: 1.711137, loss_ss: 1.039322, loss_d: 0.671815
0.5383 --- loss: 1.718876, loss_ss: 0.723142, loss_d: 0.995733
0.5767 --- loss: 1.352338, loss_ss: 0.867339, loss_d: 0.485000
0.6151 --- loss: 1.273926, loss_ss: 0.923570, loss_d: 0.350356
0.6536 --- loss: 1.578850, loss_ss: 1.060251, loss_d: 0.518599
0.6920 --- loss: 1.449695, loss_ss: 1.175649, loss_d: 0.274046
0.7305 --- loss: 1.469235, loss_ss: 0.958530, loss_d: 0.510704
0.7689 --- loss: 1.440715, loss_ss: 0.992438, loss_d: 0.448277
0.8074 --- loss: 1.379709, loss_ss: 0.761258, loss_d: 0.618451
0.8458 --- loss: 1.759768, loss_ss: 1.005026, loss_d: 0.754742
0.8843 --- loss: 1.412175, loss_ss: 1.035723, loss_d: 0.376452
0.9227 --- loss: 1.429340, loss_ss: 1.080901, loss_d: 0.348438
0.9612 --- loss: 1.987403, loss_ss: 1.203134, loss_d: 0.784269
0.9996 --- loss: 1.200941, loss_ss: 0.927620, loss_d: 0.273321
Epoch finished! Loss: 1.4390581266238138
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.382024, loss_ss: 0.922944, loss_d: 0.459080
0.0384 --- loss: 1.330383, loss_ss: 0.819697, loss_d: 0.510686
0.0769 --- loss: 1.585647, loss_ss: 0.809359, loss_d: 0.776288
0.1153 --- loss: 1.426206, loss_ss: 0.998625, loss_d: 0.427581
0.1538 --- loss: 1.449073, loss_ss: 1.070299, loss_d: 0.378774
0.1922 --- loss: 1.976276, loss_ss: 1.315970, loss_d: 0.660307
0.2307 --- loss: 1.207291, loss_ss: 0.924322, loss_d: 0.282969
0.2691 --- loss: 1.368449, loss_ss: 0.967099, loss_d: 0.401350
0.3076 --- loss: 1.561571, loss_ss: 1.159029, loss_d: 0.402541
0.3460 --- loss: 1.273921, loss_ss: 0.797622, loss_d: 0.476299
0.3845 --- loss: 1.133164, loss_ss: 0.910056, loss_d: 0.223109
0.4229 --- loss: 1.404330, loss_ss: 0.763478, loss_d: 0.640853
0.4614 --- loss: 0.990642, loss_ss: 0.729481, loss_d: 0.261162
0.4998 --- loss: 1.440655, loss_ss: 1.147128, loss_d: 0.293527
0.5383 --- loss: 0.980573, loss_ss: 0.744986, loss_d: 0.235587
0.5767 --- loss: 0.992193, loss_ss: 0.643621, loss_d: 0.348572
0.6151 --- loss: 1.181875, loss_ss: 0.918616, loss_d: 0.263259
0.6536 --- loss: 1.013506, loss_ss: 0.813254, loss_d: 0.200252
0.6920 --- loss: 1.026414, loss_ss: 0.754217, loss_d: 0.272197
0.7305 --- loss: 1.334015, loss_ss: 0.957564, loss_d: 0.376452
0.7689 --- loss: 1.158268, loss_ss: 0.907458, loss_d: 0.250809
0.8074 --- loss: 1.494364, loss_ss: 0.848883, loss_d: 0.645481
0.8458 --- loss: 1.103779, loss_ss: 0.767089, loss_d: 0.336691
0.8843 --- loss: 1.546368, loss_ss: 0.516902, loss_d: 1.029466
0.9227 --- loss: 1.243178, loss_ss: 0.930737, loss_d: 0.312440
0.9612 --- loss: 1.143629, loss_ss: 0.835879, loss_d: 0.307751
0.9996 --- loss: 3.121079, loss_ss: 0.774644, loss_d: 2.346435
Epoch finished! Loss: 1.381554544201264
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.043081, loss_ss: 0.785193, loss_d: 0.257888
0.0384 --- loss: 1.123177, loss_ss: 0.793449, loss_d: 0.329728
0.0769 --- loss: 1.179722, loss_ss: 0.881204, loss_d: 0.298518
0.1153 --- loss: 1.268417, loss_ss: 1.014701, loss_d: 0.253716
0.1538 --- loss: 1.396218, loss_ss: 0.953865, loss_d: 0.442353
0.1922 --- loss: 1.322671, loss_ss: 0.838759, loss_d: 0.483912
0.2307 --- loss: 1.067819, loss_ss: 0.677228, loss_d: 0.390591
0.2691 --- loss: 1.242987, loss_ss: 1.010180, loss_d: 0.232808
0.3076 --- loss: 1.189929, loss_ss: 1.021892, loss_d: 0.168037
0.3460 --- loss: 1.385821, loss_ss: 0.797384, loss_d: 0.588436
0.3845 --- loss: 2.056130, loss_ss: 1.543332, loss_d: 0.512798
0.4229 --- loss: 1.253580, loss_ss: 0.882218, loss_d: 0.371361
0.4614 --- loss: 1.203649, loss_ss: 0.997285, loss_d: 0.206364
0.4998 --- loss: 1.278367, loss_ss: 0.748552, loss_d: 0.529815
0.5383 --- loss: 0.990527, loss_ss: 0.769860, loss_d: 0.220667
0.5767 --- loss: 1.060603, loss_ss: 0.698301, loss_d: 0.362301
0.6151 --- loss: 1.125883, loss_ss: 0.900838, loss_d: 0.225045
0.6536 --- loss: 1.147297, loss_ss: 0.825465, loss_d: 0.321832
0.6920 --- loss: 1.056797, loss_ss: 0.860062, loss_d: 0.196734
0.7305 --- loss: 1.193904, loss_ss: 1.031731, loss_d: 0.162173
0.7689 --- loss: 1.628506, loss_ss: 1.032478, loss_d: 0.596028
0.8074 --- loss: 1.361065, loss_ss: 0.916094, loss_d: 0.444971
0.8458 --- loss: 1.575742, loss_ss: 0.838592, loss_d: 0.737150
0.8843 --- loss: 1.062873, loss_ss: 0.761228, loss_d: 0.301645
0.9227 --- loss: 1.256883, loss_ss: 1.005395, loss_d: 0.251488
0.9612 --- loss: 1.111869, loss_ss: 0.607240, loss_d: 0.504629
0.9996 --- loss: 1.605535, loss_ss: 1.346199, loss_d: 0.259337
Epoch finished! Loss: 1.2762869337430367
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.287707, loss_ss: 1.019301, loss_d: 0.268406
0.0384 --- loss: 1.217997, loss_ss: 0.982697, loss_d: 0.235300
0.0769 --- loss: 1.420231, loss_ss: 1.008656, loss_d: 0.411575
0.1153 --- loss: 1.417815, loss_ss: 1.203453, loss_d: 0.214362
0.1538 --- loss: 0.991100, loss_ss: 0.821593, loss_d: 0.169507
0.1922 --- loss: 1.057846, loss_ss: 0.895830, loss_d: 0.162016
0.2307 --- loss: 1.016717, loss_ss: 0.730820, loss_d: 0.285897
0.2691 --- loss: 1.074223, loss_ss: 0.846470, loss_d: 0.227754
0.3076 --- loss: 1.131181, loss_ss: 0.845745, loss_d: 0.285435
0.3460 --- loss: 1.039335, loss_ss: 0.849520, loss_d: 0.189815
0.3845 --- loss: 1.030409, loss_ss: 0.895154, loss_d: 0.135255
0.4229 --- loss: 1.326163, loss_ss: 0.708504, loss_d: 0.617658
0.4614 --- loss: 1.434395, loss_ss: 1.088654, loss_d: 0.345741
0.4998 --- loss: 1.334016, loss_ss: 0.954782, loss_d: 0.379234
0.5383 --- loss: 1.110783, loss_ss: 0.827705, loss_d: 0.283078
0.5767 --- loss: 1.050890, loss_ss: 0.909512, loss_d: 0.141378
0.6151 --- loss: 2.006893, loss_ss: 1.275301, loss_d: 0.731592
0.6536 --- loss: 1.438815, loss_ss: 0.620209, loss_d: 0.818607
0.6920 --- loss: 1.295806, loss_ss: 1.087105, loss_d: 0.208700
0.7305 --- loss: 0.949749, loss_ss: 0.770958, loss_d: 0.178791
0.7689 --- loss: 1.009171, loss_ss: 0.842243, loss_d: 0.166927
0.8074 --- loss: 0.882564, loss_ss: 0.743802, loss_d: 0.138763
0.8458 --- loss: 1.557642, loss_ss: 1.055911, loss_d: 0.501731
0.8843 --- loss: 1.018316, loss_ss: 0.818506, loss_d: 0.199810
0.9227 --- loss: 1.163071, loss_ss: 0.772661, loss_d: 0.390409
0.9612 --- loss: 1.195378, loss_ss: 0.977827, loss_d: 0.217551
0.9996 --- loss: 1.728007, loss_ss: 1.570128, loss_d: 0.157878
Epoch finished! Loss: 1.2455341229071983
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.256210, loss_ss: 0.935004, loss_d: 0.321207
0.0384 --- loss: 1.314075, loss_ss: 0.644091, loss_d: 0.669984
0.0769 --- loss: 1.030211, loss_ss: 0.863533, loss_d: 0.166678
0.1153 --- loss: 1.254408, loss_ss: 0.619359, loss_d: 0.635049
0.1538 --- loss: 1.256525, loss_ss: 0.877294, loss_d: 0.379231
0.1922 --- loss: 1.388527, loss_ss: 1.189791, loss_d: 0.198736
0.2307 --- loss: 1.308707, loss_ss: 1.089771, loss_d: 0.218936
0.2691 --- loss: 1.332384, loss_ss: 1.144851, loss_d: 0.187534
0.3076 --- loss: 1.584052, loss_ss: 0.755213, loss_d: 0.828838
0.3460 --- loss: 1.306949, loss_ss: 1.079439, loss_d: 0.227510
0.3845 --- loss: 1.697927, loss_ss: 0.980387, loss_d: 0.717539
0.4229 --- loss: 0.972969, loss_ss: 0.853594, loss_d: 0.119375
0.4614 --- loss: 2.022338, loss_ss: 1.036138, loss_d: 0.986201
0.4998 --- loss: 1.298622, loss_ss: 0.977230, loss_d: 0.321392
0.5383 --- loss: 1.307892, loss_ss: 1.134891, loss_d: 0.173002
0.5767 --- loss: 0.898411, loss_ss: 0.733277, loss_d: 0.165135
0.6151 --- loss: 0.948654, loss_ss: 0.725244, loss_d: 0.223410
0.6536 --- loss: 1.785685, loss_ss: 1.132113, loss_d: 0.653572
0.6920 --- loss: 1.362712, loss_ss: 0.965392, loss_d: 0.397320
0.7305 --- loss: 1.035743, loss_ss: 0.787881, loss_d: 0.247862
0.7689 --- loss: 0.940566, loss_ss: 0.813102, loss_d: 0.127463
0.8074 --- loss: 1.109085, loss_ss: 0.901915, loss_d: 0.207171
0.8458 --- loss: 1.378955, loss_ss: 0.962728, loss_d: 0.416226
0.8843 --- loss: 1.364186, loss_ss: 0.961045, loss_d: 0.403141
0.9227 --- loss: 1.171320, loss_ss: 0.860146, loss_d: 0.311174
0.9612 --- loss: 1.233966, loss_ss: 0.944247, loss_d: 0.289719
0.9996 --- loss: 1.515637, loss_ss: 1.361361, loss_d: 0.154276
Epoch finished! Loss: 1.2119555211984194
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.112291, loss_ss: 0.901416, loss_d: 0.210874
0.0384 --- loss: 1.473746, loss_ss: 1.145463, loss_d: 0.328284
0.0769 --- loss: 1.177217, loss_ss: 0.980386, loss_d: 0.196831
0.1153 --- loss: 1.110631, loss_ss: 0.885876, loss_d: 0.224755
0.1538 --- loss: 1.209753, loss_ss: 1.032613, loss_d: 0.177140
0.1922 --- loss: 0.946026, loss_ss: 0.767338, loss_d: 0.178688
0.2307 --- loss: 1.197870, loss_ss: 0.827976, loss_d: 0.369894
0.2691 --- loss: 0.984663, loss_ss: 0.771557, loss_d: 0.213106
0.3076 --- loss: 1.071974, loss_ss: 0.876669, loss_d: 0.195305
0.3460 --- loss: 0.970949, loss_ss: 0.793913, loss_d: 0.177036
0.3845 --- loss: 1.112106, loss_ss: 0.650960, loss_d: 0.461146
0.4229 --- loss: 1.264354, loss_ss: 1.056948, loss_d: 0.207406
0.4614 --- loss: 1.075444, loss_ss: 0.814982, loss_d: 0.260462
0.4998 --- loss: 0.844384, loss_ss: 0.663524, loss_d: 0.180860
0.5383 --- loss: 1.019513, loss_ss: 0.749699, loss_d: 0.269814
0.5767 --- loss: 1.898321, loss_ss: 0.929431, loss_d: 0.968889
0.6151 --- loss: 1.247213, loss_ss: 0.582193, loss_d: 0.665020
0.6536 --- loss: 1.794259, loss_ss: 1.083366, loss_d: 0.710893
0.6920 --- loss: 1.466504, loss_ss: 1.146994, loss_d: 0.319510
0.7305 --- loss: 0.905542, loss_ss: 0.771092, loss_d: 0.134450
0.7689 --- loss: 0.986873, loss_ss: 0.822497, loss_d: 0.164375
0.8074 --- loss: 1.174611, loss_ss: 0.719908, loss_d: 0.454703
0.8458 --- loss: 1.050926, loss_ss: 0.845674, loss_d: 0.205252
0.8843 --- loss: 1.189694, loss_ss: 1.074749, loss_d: 0.114945
0.9227 --- loss: 1.150828, loss_ss: 0.787601, loss_d: 0.363227
0.9612 --- loss: 1.094057, loss_ss: 0.909225, loss_d: 0.184832
0.9996 --- loss: 1.043531, loss_ss: 0.941964, loss_d: 0.101566
Epoch finished! Loss: 1.1735656722233845
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.180254, loss_ss: 0.862935, loss_d: 0.317319
0.0384 --- loss: 1.025921, loss_ss: 0.828295, loss_d: 0.197625
0.0769 --- loss: 0.935764, loss_ss: 0.814037, loss_d: 0.121727
0.1153 --- loss: 0.817648, loss_ss: 0.723046, loss_d: 0.094602
0.1538 --- loss: 1.153368, loss_ss: 0.790124, loss_d: 0.363244
0.1922 --- loss: 0.924924, loss_ss: 0.712245, loss_d: 0.212679
0.2307 --- loss: 1.492923, loss_ss: 1.063919, loss_d: 0.429004
0.2691 --- loss: 1.108715, loss_ss: 0.955006, loss_d: 0.153709
0.3076 --- loss: 0.911800, loss_ss: 0.710442, loss_d: 0.201359
0.3460 --- loss: 0.835242, loss_ss: 0.716978, loss_d: 0.118263
0.3845 --- loss: 1.560272, loss_ss: 0.968893, loss_d: 0.591379
0.4229 --- loss: 1.071140, loss_ss: 0.755708, loss_d: 0.315432
0.4614 --- loss: 0.888062, loss_ss: 0.700302, loss_d: 0.187760
0.4998 --- loss: 1.236187, loss_ss: 0.999171, loss_d: 0.237016
0.5383 --- loss: 0.832027, loss_ss: 0.671624, loss_d: 0.160403
0.5767 --- loss: 0.793925, loss_ss: 0.681698, loss_d: 0.112227
0.6151 --- loss: 1.190275, loss_ss: 1.037434, loss_d: 0.152841
0.6536 --- loss: 1.191233, loss_ss: 1.108870, loss_d: 0.082363
0.6920 --- loss: 0.793088, loss_ss: 0.696618, loss_d: 0.096470
0.7305 --- loss: 1.252752, loss_ss: 0.873912, loss_d: 0.378840
0.7689 --- loss: 1.397733, loss_ss: 1.147594, loss_d: 0.250139
0.8074 --- loss: 1.241687, loss_ss: 0.927580, loss_d: 0.314107
0.8458 --- loss: 0.852937, loss_ss: 0.663840, loss_d: 0.189097
0.8843 --- loss: 0.747847, loss_ss: 0.643605, loss_d: 0.104242
0.9227 --- loss: 1.812886, loss_ss: 1.195888, loss_d: 0.616999
0.9612 --- loss: 1.185541, loss_ss: 1.003348, loss_d: 0.182193
0.9996 --- loss: 2.738096, loss_ss: 2.665229, loss_d: 0.072868
Epoch finished! Loss: 1.1464337232021184
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6684684684684684
             precision    recall  f1-score   support

        0.0       0.47      0.56      0.51       153
        1.0       0.51      0.64      0.56       232
        2.0       0.81      0.66      0.73       441
        3.0       0.97      0.77      0.86        93
        4.0       0.73      0.75      0.74       191

avg / total       0.70      0.67      0.68      1110
 


====== chp042-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.14  56.21   89.76  46.74     51.04
1  79.37  63.79   83.49  50.51     56.38
2  80.36  66.21   89.69  80.89     72.82
3  97.93  77.42   99.80  97.30     86.23
4  90.90  75.39   94.12  72.73     74.04
Total accuracy: 66.85%
Average sen: 67.81%
Average spec: 91.37%
Macro f1-score: 68.10%
Diagnosis acc on 15mins: 1.0
[0.91864002 0.6894424  0.75863159 0.96131605 0.98765194 0.99933749
 0.99987471 0.98990411 0.98380035 0.60916895 0.99152476 0.89642787
 0.87760001 0.90986395 0.98042333 0.98902917 0.99416792 0.99830794
 0.99415225 0.99891281 0.9986065  0.99796152 0.90837139 0.90762186
 0.94408929 0.98637694 0.99857759 0.99753594 0.99813408 0.97746003
 0.98242044 0.96250129 0.99368554 0.77313966 0.91748977 0.96822184
 0.9947983 ]
pred: 0.941491070631388, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp043-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.321600, loss_ss: 1.579944, loss_d: 0.741656
0.0385 --- loss: 2.327914, loss_ss: 1.524489, loss_d: 0.803425
0.0770 --- loss: 2.072491, loss_ss: 1.528946, loss_d: 0.543544
0.1155 --- loss: 2.122340, loss_ss: 1.470078, loss_d: 0.652263
0.1540 --- loss: 2.057351, loss_ss: 1.546301, loss_d: 0.511050
0.1925 --- loss: 2.071682, loss_ss: 1.243571, loss_d: 0.828112
0.2309 --- loss: 2.027387, loss_ss: 1.393457, loss_d: 0.633931
0.2694 --- loss: 1.558595, loss_ss: 1.217998, loss_d: 0.340596
0.3079 --- loss: 1.501393, loss_ss: 1.064468, loss_d: 0.436925
0.3464 --- loss: 1.605907, loss_ss: 1.358795, loss_d: 0.247112
0.3849 --- loss: 2.148217, loss_ss: 1.261694, loss_d: 0.886524
0.4234 --- loss: 1.948563, loss_ss: 1.451168, loss_d: 0.497395
0.4619 --- loss: 2.124935, loss_ss: 1.417396, loss_d: 0.707539
0.5004 --- loss: 1.941934, loss_ss: 1.313321, loss_d: 0.628613
0.5389 --- loss: 1.773025, loss_ss: 1.276881, loss_d: 0.496144
0.5774 --- loss: 1.984307, loss_ss: 1.281443, loss_d: 0.702864
0.6159 --- loss: 2.022015, loss_ss: 1.432805, loss_d: 0.589210
0.6543 --- loss: 1.979530, loss_ss: 1.115677, loss_d: 0.863852
0.6928 --- loss: 1.987660, loss_ss: 1.180157, loss_d: 0.807503
0.7313 --- loss: 1.728007, loss_ss: 1.153935, loss_d: 0.574072
0.7698 --- loss: 1.900155, loss_ss: 1.349741, loss_d: 0.550414
0.8083 --- loss: 2.046343, loss_ss: 1.129183, loss_d: 0.917160
0.8468 --- loss: 1.821563, loss_ss: 1.172706, loss_d: 0.648857
0.8853 --- loss: 1.759145, loss_ss: 1.178794, loss_d: 0.580351
0.9238 --- loss: 2.023327, loss_ss: 1.153641, loss_d: 0.869686
0.9623 --- loss: 1.800139, loss_ss: 1.014588, loss_d: 0.785552
Epoch finished! Loss: 1.9192754462879136
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.448861, loss_ss: 0.870149, loss_d: 0.578713
0.0385 --- loss: 1.567958, loss_ss: 1.071361, loss_d: 0.496597
0.0770 --- loss: 1.751534, loss_ss: 1.166161, loss_d: 0.585374
0.1155 --- loss: 1.937412, loss_ss: 1.193258, loss_d: 0.744153
0.1540 --- loss: 1.823650, loss_ss: 1.261751, loss_d: 0.561899
0.1925 --- loss: 1.896777, loss_ss: 1.294399, loss_d: 0.602378
0.2309 --- loss: 1.659505, loss_ss: 1.063886, loss_d: 0.595619
0.2694 --- loss: 1.805832, loss_ss: 1.388504, loss_d: 0.417328
0.3079 --- loss: 1.610953, loss_ss: 1.319867, loss_d: 0.291086
0.3464 --- loss: 1.741256, loss_ss: 1.169806, loss_d: 0.571450
0.3849 --- loss: 1.593134, loss_ss: 1.026485, loss_d: 0.566649
0.4234 --- loss: 1.874659, loss_ss: 1.314928, loss_d: 0.559731
0.4619 --- loss: 2.404651, loss_ss: 1.323685, loss_d: 1.080966
0.5004 --- loss: 1.485923, loss_ss: 0.979872, loss_d: 0.506051
0.5389 --- loss: 1.524854, loss_ss: 1.034424, loss_d: 0.490430
0.5774 --- loss: 1.726506, loss_ss: 1.069039, loss_d: 0.657467
0.6159 --- loss: 1.764503, loss_ss: 1.122319, loss_d: 0.642183
0.6543 --- loss: 1.945027, loss_ss: 1.373239, loss_d: 0.571788
0.6928 --- loss: 1.819089, loss_ss: 1.091591, loss_d: 0.727498
0.7313 --- loss: 1.441165, loss_ss: 1.007922, loss_d: 0.433242
0.7698 --- loss: 1.470862, loss_ss: 1.068890, loss_d: 0.401972
0.8083 --- loss: 1.517330, loss_ss: 0.945097, loss_d: 0.572232
0.8468 --- loss: 1.572083, loss_ss: 1.002608, loss_d: 0.569475
0.8853 --- loss: 1.815642, loss_ss: 1.136356, loss_d: 0.679285
0.9238 --- loss: 1.559515, loss_ss: 0.921178, loss_d: 0.638337
0.9623 --- loss: 1.846092, loss_ss: 1.187376, loss_d: 0.658716
Epoch finished! Loss: 1.6876684105074085
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.717195, loss_ss: 1.111565, loss_d: 0.605630
0.0385 --- loss: 1.436511, loss_ss: 0.874621, loss_d: 0.561890
0.0770 --- loss: 1.634515, loss_ss: 0.832645, loss_d: 0.801870
0.1155 --- loss: 1.337406, loss_ss: 0.807802, loss_d: 0.529604
0.1540 --- loss: 1.753922, loss_ss: 1.121714, loss_d: 0.632208
0.1925 --- loss: 1.453728, loss_ss: 0.928260, loss_d: 0.525469
0.2309 --- loss: 1.518974, loss_ss: 1.072111, loss_d: 0.446862
0.2694 --- loss: 1.339206, loss_ss: 0.962864, loss_d: 0.376342
0.3079 --- loss: 1.758487, loss_ss: 1.141177, loss_d: 0.617310
0.3464 --- loss: 1.483166, loss_ss: 0.841530, loss_d: 0.641636
0.3849 --- loss: 1.747132, loss_ss: 1.224821, loss_d: 0.522311
0.4234 --- loss: 1.637231, loss_ss: 1.344941, loss_d: 0.292290
0.4619 --- loss: 1.269498, loss_ss: 0.866934, loss_d: 0.402564
0.5004 --- loss: 1.919082, loss_ss: 0.827544, loss_d: 1.091538
0.5389 --- loss: 1.355508, loss_ss: 0.838305, loss_d: 0.517203
0.5774 --- loss: 1.580756, loss_ss: 1.111560, loss_d: 0.469196
0.6159 --- loss: 1.467721, loss_ss: 1.073751, loss_d: 0.393970
0.6543 --- loss: 1.432660, loss_ss: 1.018828, loss_d: 0.413832
0.6928 --- loss: 1.578604, loss_ss: 1.298476, loss_d: 0.280128
0.7313 --- loss: 1.605807, loss_ss: 1.138583, loss_d: 0.467224
0.7698 --- loss: 1.539594, loss_ss: 1.130627, loss_d: 0.408967
0.8083 --- loss: 1.724774, loss_ss: 0.986266, loss_d: 0.738508
0.8468 --- loss: 1.510039, loss_ss: 0.832741, loss_d: 0.677298
0.8853 --- loss: 1.368940, loss_ss: 0.901479, loss_d: 0.467461
0.9238 --- loss: 1.812559, loss_ss: 1.129604, loss_d: 0.682954
0.9623 --- loss: 1.986125, loss_ss: 0.912542, loss_d: 1.073583
Epoch finished! Loss: 1.589123062185339
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.709013, loss_ss: 1.085673, loss_d: 0.623339
0.0385 --- loss: 1.523353, loss_ss: 0.849495, loss_d: 0.673858
0.0770 --- loss: 1.320144, loss_ss: 0.824643, loss_d: 0.495501
0.1155 --- loss: 1.931198, loss_ss: 1.486908, loss_d: 0.444290
0.1540 --- loss: 1.703489, loss_ss: 1.195877, loss_d: 0.507612
0.1925 --- loss: 1.653093, loss_ss: 0.967882, loss_d: 0.685211
0.2309 --- loss: 1.287854, loss_ss: 0.773059, loss_d: 0.514796
0.2694 --- loss: 1.534356, loss_ss: 1.039940, loss_d: 0.494416
0.3079 --- loss: 1.182433, loss_ss: 0.901109, loss_d: 0.281325
0.3464 --- loss: 1.199849, loss_ss: 0.896557, loss_d: 0.303291
0.3849 --- loss: 1.329596, loss_ss: 0.873027, loss_d: 0.456569
0.4234 --- loss: 1.623052, loss_ss: 1.179498, loss_d: 0.443555
0.4619 --- loss: 1.515331, loss_ss: 0.986596, loss_d: 0.528736
0.5004 --- loss: 1.115209, loss_ss: 0.706278, loss_d: 0.408931
0.5389 --- loss: 1.506631, loss_ss: 0.985422, loss_d: 0.521208
0.5774 --- loss: 1.819226, loss_ss: 0.738710, loss_d: 1.080516
0.6159 --- loss: 1.492805, loss_ss: 1.142250, loss_d: 0.350555
0.6543 --- loss: 1.196124, loss_ss: 0.703843, loss_d: 0.492280
0.6928 --- loss: 1.265363, loss_ss: 0.840038, loss_d: 0.425325
0.7313 --- loss: 1.466879, loss_ss: 0.913365, loss_d: 0.553513
0.7698 --- loss: 1.613520, loss_ss: 0.994911, loss_d: 0.618609
0.8083 --- loss: 1.904215, loss_ss: 1.220319, loss_d: 0.683896
0.8468 --- loss: 1.524584, loss_ss: 0.969289, loss_d: 0.555295
0.8853 --- loss: 1.568903, loss_ss: 1.165699, loss_d: 0.403205
0.9238 --- loss: 1.467130, loss_ss: 1.065553, loss_d: 0.401577
0.9623 --- loss: 1.616176, loss_ss: 1.164470, loss_d: 0.451706
Epoch finished! Loss: 1.4897143794763041
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.196464, loss_ss: 0.739558, loss_d: 0.456906
0.0385 --- loss: 1.243426, loss_ss: 0.937991, loss_d: 0.305436
0.0770 --- loss: 1.585457, loss_ss: 1.071634, loss_d: 0.513823
0.1155 --- loss: 1.568575, loss_ss: 0.955882, loss_d: 0.612693
0.1540 --- loss: 1.301424, loss_ss: 0.885571, loss_d: 0.415853
0.1925 --- loss: 1.445930, loss_ss: 0.794391, loss_d: 0.651540
0.2309 --- loss: 1.617726, loss_ss: 0.808479, loss_d: 0.809247
0.2694 --- loss: 1.360180, loss_ss: 0.901302, loss_d: 0.458879
0.3079 --- loss: 1.432474, loss_ss: 0.742863, loss_d: 0.689611
0.3464 --- loss: 1.301485, loss_ss: 0.996228, loss_d: 0.305257
0.3849 --- loss: 1.455638, loss_ss: 0.846764, loss_d: 0.608874
0.4234 --- loss: 1.245771, loss_ss: 1.025505, loss_d: 0.220266
0.4619 --- loss: 1.516646, loss_ss: 0.996435, loss_d: 0.520212
0.5004 --- loss: 1.307487, loss_ss: 0.935875, loss_d: 0.371612
0.5389 --- loss: 1.441267, loss_ss: 1.049932, loss_d: 0.391335
0.5774 --- loss: 1.003988, loss_ss: 0.813716, loss_d: 0.190272
0.6159 --- loss: 1.140577, loss_ss: 0.954171, loss_d: 0.186406
0.6543 --- loss: 1.289615, loss_ss: 0.856200, loss_d: 0.433415
0.6928 --- loss: 1.077359, loss_ss: 0.770455, loss_d: 0.306905
0.7313 --- loss: 1.603660, loss_ss: 1.242755, loss_d: 0.360905
0.7698 --- loss: 1.222593, loss_ss: 0.847156, loss_d: 0.375437
0.8083 --- loss: 0.923708, loss_ss: 0.676217, loss_d: 0.247492
0.8468 --- loss: 1.423610, loss_ss: 0.829327, loss_d: 0.594283
0.8853 --- loss: 1.051384, loss_ss: 0.700576, loss_d: 0.350808
0.9238 --- loss: 1.001272, loss_ss: 0.729469, loss_d: 0.271803
0.9623 --- loss: 1.243754, loss_ss: 0.788394, loss_d: 0.455361
Epoch finished! Loss: 1.3957333615387728
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.089920, loss_ss: 0.679957, loss_d: 0.409963
0.0385 --- loss: 1.055710, loss_ss: 0.787654, loss_d: 0.268056
0.0770 --- loss: 1.081689, loss_ss: 0.768869, loss_d: 0.312819
0.1155 --- loss: 1.071947, loss_ss: 0.831046, loss_d: 0.240901
0.1540 --- loss: 1.404035, loss_ss: 0.902127, loss_d: 0.501908
0.1925 --- loss: 1.173743, loss_ss: 0.838520, loss_d: 0.335224
0.2309 --- loss: 1.231305, loss_ss: 0.914730, loss_d: 0.316575
0.2694 --- loss: 1.286731, loss_ss: 1.007540, loss_d: 0.279191
0.3079 --- loss: 1.552474, loss_ss: 1.242797, loss_d: 0.309677
0.3464 --- loss: 1.412904, loss_ss: 0.883413, loss_d: 0.529491
0.3849 --- loss: 1.503703, loss_ss: 1.112608, loss_d: 0.391095
0.4234 --- loss: 1.086022, loss_ss: 0.587637, loss_d: 0.498385
0.4619 --- loss: 1.537602, loss_ss: 0.772036, loss_d: 0.765566
0.5004 --- loss: 1.368250, loss_ss: 1.131379, loss_d: 0.236871
0.5389 --- loss: 1.256223, loss_ss: 0.935762, loss_d: 0.320461
0.5774 --- loss: 1.254241, loss_ss: 0.991472, loss_d: 0.262769
0.6159 --- loss: 1.034098, loss_ss: 0.765881, loss_d: 0.268217
0.6543 --- loss: 1.804580, loss_ss: 0.828481, loss_d: 0.976098
0.6928 --- loss: 1.123320, loss_ss: 0.674842, loss_d: 0.448478
0.7313 --- loss: 1.653105, loss_ss: 1.040713, loss_d: 0.612392
0.7698 --- loss: 1.514700, loss_ss: 0.902025, loss_d: 0.612675
0.8083 --- loss: 1.168227, loss_ss: 0.871953, loss_d: 0.296274
0.8468 --- loss: 1.246522, loss_ss: 0.794024, loss_d: 0.452498
0.8853 --- loss: 0.921129, loss_ss: 0.697165, loss_d: 0.223965
0.9238 --- loss: 1.603670, loss_ss: 1.177179, loss_d: 0.426491
0.9623 --- loss: 1.144020, loss_ss: 0.912131, loss_d: 0.231890
Epoch finished! Loss: 1.3035717321178628
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.323388, loss_ss: 0.957189, loss_d: 0.366199
0.0385 --- loss: 1.037290, loss_ss: 0.883148, loss_d: 0.154142
0.0770 --- loss: 1.178256, loss_ss: 0.913265, loss_d: 0.264991
0.1155 --- loss: 1.710543, loss_ss: 0.816720, loss_d: 0.893823
0.1540 --- loss: 1.427020, loss_ss: 1.000378, loss_d: 0.426643
0.1925 --- loss: 1.297914, loss_ss: 0.731755, loss_d: 0.566159
0.2309 --- loss: 1.255172, loss_ss: 0.858871, loss_d: 0.396302
0.2694 --- loss: 0.945430, loss_ss: 0.756454, loss_d: 0.188977
0.3079 --- loss: 0.976329, loss_ss: 0.795166, loss_d: 0.181163
0.3464 --- loss: 1.355455, loss_ss: 0.719738, loss_d: 0.635717
0.3849 --- loss: 0.964021, loss_ss: 0.710304, loss_d: 0.253717
0.4234 --- loss: 1.164555, loss_ss: 0.827150, loss_d: 0.337406
0.4619 --- loss: 1.222750, loss_ss: 0.857705, loss_d: 0.365045
0.5004 --- loss: 1.117622, loss_ss: 0.766336, loss_d: 0.351286
0.5389 --- loss: 1.605961, loss_ss: 0.981084, loss_d: 0.624877
0.5774 --- loss: 1.233967, loss_ss: 0.920715, loss_d: 0.313252
0.6159 --- loss: 0.905917, loss_ss: 0.647944, loss_d: 0.257973
0.6543 --- loss: 1.095019, loss_ss: 0.775286, loss_d: 0.319733
0.6928 --- loss: 1.450635, loss_ss: 0.922652, loss_d: 0.527983
0.7313 --- loss: 0.997761, loss_ss: 0.767844, loss_d: 0.229917
0.7698 --- loss: 1.452721, loss_ss: 1.117322, loss_d: 0.335399
0.8083 --- loss: 0.991226, loss_ss: 0.828397, loss_d: 0.162829
0.8468 --- loss: 1.349031, loss_ss: 0.845173, loss_d: 0.503858
0.8853 --- loss: 1.534339, loss_ss: 0.901868, loss_d: 0.632470
0.9238 --- loss: 1.797270, loss_ss: 1.434117, loss_d: 0.363153
0.9623 --- loss: 1.285363, loss_ss: 1.006650, loss_d: 0.278713
Epoch finished! Loss: 1.2561676366448862
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.978930, loss_ss: 0.619228, loss_d: 0.359701
0.0385 --- loss: 1.329304, loss_ss: 1.016393, loss_d: 0.312911
0.0770 --- loss: 1.241727, loss_ss: 0.867059, loss_d: 0.374668
0.1155 --- loss: 1.163225, loss_ss: 0.950206, loss_d: 0.213019
0.1540 --- loss: 1.122132, loss_ss: 0.734110, loss_d: 0.388022
0.1925 --- loss: 1.201871, loss_ss: 0.872579, loss_d: 0.329291
0.2309 --- loss: 0.966234, loss_ss: 0.705405, loss_d: 0.260829
0.2694 --- loss: 1.470689, loss_ss: 0.879028, loss_d: 0.591661
0.3079 --- loss: 0.930896, loss_ss: 0.771281, loss_d: 0.159615
0.3464 --- loss: 1.436301, loss_ss: 0.872594, loss_d: 0.563707
0.3849 --- loss: 1.410909, loss_ss: 0.853878, loss_d: 0.557031
0.4234 --- loss: 0.918420, loss_ss: 0.739072, loss_d: 0.179348
0.4619 --- loss: 1.280724, loss_ss: 0.890754, loss_d: 0.389970
0.5004 --- loss: 1.163797, loss_ss: 0.994780, loss_d: 0.169017
0.5389 --- loss: 0.815887, loss_ss: 0.524704, loss_d: 0.291183
0.5774 --- loss: 1.314230, loss_ss: 1.063520, loss_d: 0.250710
0.6159 --- loss: 0.795227, loss_ss: 0.708529, loss_d: 0.086698
0.6543 --- loss: 1.021988, loss_ss: 0.702083, loss_d: 0.319905
0.6928 --- loss: 1.436729, loss_ss: 0.937951, loss_d: 0.498778
0.7313 --- loss: 1.488427, loss_ss: 1.083382, loss_d: 0.405045
0.7698 --- loss: 1.021136, loss_ss: 0.806755, loss_d: 0.214381
0.8083 --- loss: 1.310021, loss_ss: 0.902041, loss_d: 0.407979
0.8468 --- loss: 1.139086, loss_ss: 0.991085, loss_d: 0.148001
0.8853 --- loss: 1.140420, loss_ss: 1.019143, loss_d: 0.121276
0.9238 --- loss: 1.118726, loss_ss: 0.895116, loss_d: 0.223610
0.9623 --- loss: 1.204843, loss_ss: 0.880652, loss_d: 0.324190
Epoch finished! Loss: 1.2078232070193788
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.818467, loss_ss: 0.669052, loss_d: 0.149415
0.0385 --- loss: 1.222697, loss_ss: 0.694478, loss_d: 0.528219
0.0770 --- loss: 0.899144, loss_ss: 0.709827, loss_d: 0.189318
0.1155 --- loss: 0.992782, loss_ss: 0.809249, loss_d: 0.183533
0.1540 --- loss: 1.201588, loss_ss: 0.945871, loss_d: 0.255717
0.1925 --- loss: 1.065228, loss_ss: 0.998361, loss_d: 0.066866
0.2309 --- loss: 1.046956, loss_ss: 0.920341, loss_d: 0.126615
0.2694 --- loss: 0.981108, loss_ss: 0.781523, loss_d: 0.199585
0.3079 --- loss: 1.610696, loss_ss: 0.949368, loss_d: 0.661328
0.3464 --- loss: 1.224125, loss_ss: 0.838843, loss_d: 0.385283
0.3849 --- loss: 0.943577, loss_ss: 0.732995, loss_d: 0.210581
0.4234 --- loss: 1.165288, loss_ss: 0.868883, loss_d: 0.296405
0.4619 --- loss: 1.155300, loss_ss: 0.790329, loss_d: 0.364971
0.5004 --- loss: 1.148206, loss_ss: 0.872603, loss_d: 0.275603
0.5389 --- loss: 1.071840, loss_ss: 0.696274, loss_d: 0.375567
0.5774 --- loss: 1.465938, loss_ss: 0.967846, loss_d: 0.498092
0.6159 --- loss: 1.101545, loss_ss: 0.945151, loss_d: 0.156394
0.6543 --- loss: 1.225388, loss_ss: 0.842295, loss_d: 0.383093
0.6928 --- loss: 1.186800, loss_ss: 0.963610, loss_d: 0.223190
0.7313 --- loss: 1.036300, loss_ss: 0.895550, loss_d: 0.140751
0.7698 --- loss: 1.119886, loss_ss: 0.679921, loss_d: 0.439966
0.8083 --- loss: 1.216323, loss_ss: 0.978306, loss_d: 0.238017
0.8468 --- loss: 1.186311, loss_ss: 0.994864, loss_d: 0.191447
0.8853 --- loss: 1.146562, loss_ss: 1.014438, loss_d: 0.132124
0.9238 --- loss: 1.323899, loss_ss: 0.906907, loss_d: 0.416992
0.9623 --- loss: 0.958429, loss_ss: 0.680217, loss_d: 0.278212
Epoch finished! Loss: 1.1579555252343992
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.019186, loss_ss: 0.883790, loss_d: 0.135395
0.0385 --- loss: 0.998858, loss_ss: 0.822773, loss_d: 0.176085
0.0770 --- loss: 0.972954, loss_ss: 0.772046, loss_d: 0.200908
0.1155 --- loss: 1.300817, loss_ss: 1.022404, loss_d: 0.278413
0.1540 --- loss: 1.164299, loss_ss: 1.055215, loss_d: 0.109084
0.1925 --- loss: 1.183823, loss_ss: 0.757480, loss_d: 0.426343
0.2309 --- loss: 0.718874, loss_ss: 0.626786, loss_d: 0.092088
0.2694 --- loss: 1.029786, loss_ss: 0.867400, loss_d: 0.162386
0.3079 --- loss: 1.594693, loss_ss: 0.885201, loss_d: 0.709491
0.3464 --- loss: 0.948473, loss_ss: 0.802518, loss_d: 0.145955
0.3849 --- loss: 0.879382, loss_ss: 0.739957, loss_d: 0.139425
0.4234 --- loss: 0.973971, loss_ss: 0.784311, loss_d: 0.189660
0.4619 --- loss: 1.088934, loss_ss: 0.790546, loss_d: 0.298389
0.5004 --- loss: 0.893040, loss_ss: 0.812901, loss_d: 0.080139
0.5389 --- loss: 2.040292, loss_ss: 0.850076, loss_d: 1.190216
0.5774 --- loss: 1.111703, loss_ss: 0.802290, loss_d: 0.309413
0.6159 --- loss: 1.139120, loss_ss: 1.033503, loss_d: 0.105618
0.6543 --- loss: 1.563517, loss_ss: 1.136446, loss_d: 0.427072
0.6928 --- loss: 1.342725, loss_ss: 1.120068, loss_d: 0.222657
0.7313 --- loss: 1.088515, loss_ss: 0.917632, loss_d: 0.170883
0.7698 --- loss: 1.139704, loss_ss: 0.841697, loss_d: 0.298007
0.8083 --- loss: 1.168589, loss_ss: 1.019787, loss_d: 0.148801
0.8468 --- loss: 1.113695, loss_ss: 0.716050, loss_d: 0.397645
0.8853 --- loss: 0.937792, loss_ss: 0.789412, loss_d: 0.148380
0.9238 --- loss: 1.216289, loss_ss: 0.972779, loss_d: 0.243510
0.9623 --- loss: 1.352898, loss_ss: 1.120547, loss_d: 0.232351
Epoch finished! Loss: 1.110734960287234
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6375
             precision    recall  f1-score   support

        0.0       0.74      0.65      0.69       143
        1.0       0.39      0.14      0.20       197
        2.0       0.85      0.67      0.75       506
        3.0       0.84      0.72      0.77        64
        4.0       0.47      0.90      0.62       290

avg / total       0.67      0.64      0.62      1200
 


====== chp043-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  93.17  65.03   96.97  74.40     69.40
1  82.25  13.71   95.71  38.57     20.22
2  81.17  67.00   91.50  85.18     75.00
3  97.75  71.88   99.21  83.64     77.31
4  73.17  89.66   67.91  47.10     61.76
Total accuracy: 63.75%
Average sen: 61.45%
Average spec: 90.26%
Macro f1-score: 60.74%
Diagnosis acc on 15mins: 0.975
[0.99132216 0.93128866 0.06334355 0.99059451 0.98783714 0.91213924
 0.98669726 0.97726554 0.99564004 0.98360622 0.98655605 0.98945272
 0.99525177 0.99726868 0.99496484 0.98513073 0.99016613 0.99649882
 0.68905318 0.98687267 0.99683422 0.99843735 0.99867463 0.99497777
 0.99707711 0.99863929 0.99850249 0.99817836 0.99921751 0.9991166
 0.99116713 0.99752289 0.99309301 0.98907381 0.99564928 0.99817598
 0.99842501 0.99607652 0.98644835 0.98906994]
pred: 0.9586326785385608, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp044-nsrr. train_data(2603), test_data(35) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.254216, loss_ss: 1.549058, loss_d: 0.705158
0.0384 --- loss: 1.760951, loss_ss: 1.253156, loss_d: 0.507795
0.0768 --- loss: 2.080123, loss_ss: 1.402363, loss_d: 0.677760
0.1153 --- loss: 1.783514, loss_ss: 1.288736, loss_d: 0.494779
0.1537 --- loss: 1.972597, loss_ss: 1.404611, loss_d: 0.567986
0.1921 --- loss: 2.032400, loss_ss: 1.226256, loss_d: 0.806144
0.2305 --- loss: 2.024623, loss_ss: 1.335110, loss_d: 0.689513
0.2689 --- loss: 1.916705, loss_ss: 1.159627, loss_d: 0.757078
0.3073 --- loss: 1.758588, loss_ss: 1.275619, loss_d: 0.482970
0.3458 --- loss: 1.881625, loss_ss: 1.333063, loss_d: 0.548562
0.3842 --- loss: 1.867037, loss_ss: 1.201309, loss_d: 0.665728
0.4226 --- loss: 1.599288, loss_ss: 1.101454, loss_d: 0.497834
0.4610 --- loss: 1.596085, loss_ss: 1.212749, loss_d: 0.383336
0.4994 --- loss: 1.497208, loss_ss: 1.087253, loss_d: 0.409954
0.5378 --- loss: 1.708979, loss_ss: 1.106874, loss_d: 0.602105
0.5763 --- loss: 1.585049, loss_ss: 0.988534, loss_d: 0.596515
0.6147 --- loss: 1.814383, loss_ss: 1.232584, loss_d: 0.581799
0.6531 --- loss: 1.695765, loss_ss: 1.018393, loss_d: 0.677372
0.6915 --- loss: 1.839651, loss_ss: 1.156132, loss_d: 0.683519
0.7299 --- loss: 1.657956, loss_ss: 1.112123, loss_d: 0.545833
0.7683 --- loss: 1.792197, loss_ss: 1.115183, loss_d: 0.677015
0.8068 --- loss: 1.653384, loss_ss: 1.058141, loss_d: 0.595243
0.8452 --- loss: 1.403473, loss_ss: 0.991176, loss_d: 0.412297
0.8836 --- loss: 1.460499, loss_ss: 0.997557, loss_d: 0.462942
0.9220 --- loss: 1.603718, loss_ss: 1.043035, loss_d: 0.560683
0.9604 --- loss: 1.934937, loss_ss: 1.321161, loss_d: 0.613776
0.9988 --- loss: 1.808167, loss_ss: 1.203901, loss_d: 0.604267
Epoch finished! Loss: 1.838707326925718
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.626461, loss_ss: 1.056322, loss_d: 0.570139
0.0384 --- loss: 1.607653, loss_ss: 1.046210, loss_d: 0.561443
0.0768 --- loss: 2.310764, loss_ss: 1.495024, loss_d: 0.815740
0.1153 --- loss: 1.434209, loss_ss: 0.910783, loss_d: 0.523427
0.1537 --- loss: 1.402015, loss_ss: 0.867331, loss_d: 0.534684
0.1921 --- loss: 1.896588, loss_ss: 0.878886, loss_d: 1.017702
0.2305 --- loss: 1.813697, loss_ss: 1.253278, loss_d: 0.560418
0.2689 --- loss: 1.186944, loss_ss: 0.841819, loss_d: 0.345125
0.3073 --- loss: 1.906831, loss_ss: 1.377854, loss_d: 0.528977
0.3458 --- loss: 1.805360, loss_ss: 0.949224, loss_d: 0.856136
0.3842 --- loss: 1.889810, loss_ss: 0.965182, loss_d: 0.924628
0.4226 --- loss: 2.029358, loss_ss: 1.233406, loss_d: 0.795952
0.4610 --- loss: 1.715002, loss_ss: 1.190525, loss_d: 0.524477
0.4994 --- loss: 1.447465, loss_ss: 1.054821, loss_d: 0.392644
0.5378 --- loss: 1.293924, loss_ss: 1.047343, loss_d: 0.246582
0.5763 --- loss: 1.879709, loss_ss: 1.321392, loss_d: 0.558317
0.6147 --- loss: 1.577485, loss_ss: 0.989257, loss_d: 0.588229
0.6531 --- loss: 1.506265, loss_ss: 0.808800, loss_d: 0.697465
0.6915 --- loss: 1.686275, loss_ss: 0.946175, loss_d: 0.740100
0.7299 --- loss: 1.506110, loss_ss: 0.970363, loss_d: 0.535747
0.7683 --- loss: 1.330496, loss_ss: 0.697041, loss_d: 0.633455
0.8068 --- loss: 1.565136, loss_ss: 1.106294, loss_d: 0.458842
0.8452 --- loss: 1.295894, loss_ss: 0.930604, loss_d: 0.365290
0.8836 --- loss: 1.738260, loss_ss: 1.010734, loss_d: 0.727526
0.9220 --- loss: 1.429756, loss_ss: 0.847598, loss_d: 0.582158
0.9604 --- loss: 1.803056, loss_ss: 1.238298, loss_d: 0.564758
0.9988 --- loss: 1.922917, loss_ss: 1.088147, loss_d: 0.834770
Epoch finished! Loss: 1.636955211712764
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.550170, loss_ss: 0.968136, loss_d: 0.582034
0.0384 --- loss: 1.432664, loss_ss: 0.913891, loss_d: 0.518772
0.0768 --- loss: 1.733370, loss_ss: 1.141080, loss_d: 0.592290
0.1153 --- loss: 1.597922, loss_ss: 0.892225, loss_d: 0.705697
0.1537 --- loss: 1.387412, loss_ss: 1.135576, loss_d: 0.251836
0.1921 --- loss: 1.651676, loss_ss: 0.879248, loss_d: 0.772428
0.2305 --- loss: 1.388153, loss_ss: 1.044581, loss_d: 0.343572
0.2689 --- loss: 1.505609, loss_ss: 0.673371, loss_d: 0.832239
0.3073 --- loss: 1.677661, loss_ss: 1.075731, loss_d: 0.601930
0.3458 --- loss: 1.775723, loss_ss: 1.336149, loss_d: 0.439574
0.3842 --- loss: 1.453580, loss_ss: 1.003407, loss_d: 0.450173
0.4226 --- loss: 1.358037, loss_ss: 0.888561, loss_d: 0.469476
0.4610 --- loss: 1.169232, loss_ss: 0.850227, loss_d: 0.319005
0.4994 --- loss: 1.576915, loss_ss: 0.826156, loss_d: 0.750759
0.5378 --- loss: 1.693477, loss_ss: 0.992425, loss_d: 0.701053
0.5763 --- loss: 1.662964, loss_ss: 1.305741, loss_d: 0.357224
0.6147 --- loss: 1.416626, loss_ss: 0.822801, loss_d: 0.593825
0.6531 --- loss: 1.438623, loss_ss: 1.085600, loss_d: 0.353023
0.6915 --- loss: 1.258065, loss_ss: 1.044445, loss_d: 0.213620
0.7299 --- loss: 1.309122, loss_ss: 0.958339, loss_d: 0.350783
0.7683 --- loss: 1.751494, loss_ss: 1.082771, loss_d: 0.668723
0.8068 --- loss: 1.411196, loss_ss: 0.884862, loss_d: 0.526334
0.8452 --- loss: 1.157212, loss_ss: 0.531857, loss_d: 0.625355
0.8836 --- loss: 1.382114, loss_ss: 0.929922, loss_d: 0.452192
0.9220 --- loss: 1.401376, loss_ss: 0.960941, loss_d: 0.440435
0.9604 --- loss: 1.403909, loss_ss: 0.997241, loss_d: 0.406668
0.9988 --- loss: 1.596608, loss_ss: 1.135532, loss_d: 0.461076
Epoch finished! Loss: 1.5055664855700273
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.412544, loss_ss: 0.841426, loss_d: 0.571118
0.0384 --- loss: 1.635675, loss_ss: 0.945957, loss_d: 0.689718
0.0768 --- loss: 1.926352, loss_ss: 1.310653, loss_d: 0.615699
0.1153 --- loss: 1.155935, loss_ss: 0.886647, loss_d: 0.269289
0.1537 --- loss: 1.254091, loss_ss: 0.930788, loss_d: 0.323303
0.1921 --- loss: 1.092674, loss_ss: 0.775627, loss_d: 0.317047
0.2305 --- loss: 1.571732, loss_ss: 1.154657, loss_d: 0.417076
0.2689 --- loss: 1.178096, loss_ss: 0.923080, loss_d: 0.255016
0.3073 --- loss: 1.102451, loss_ss: 0.569742, loss_d: 0.532709
0.3458 --- loss: 1.156844, loss_ss: 0.819663, loss_d: 0.337181
0.3842 --- loss: 1.641896, loss_ss: 0.929987, loss_d: 0.711909
0.4226 --- loss: 0.957808, loss_ss: 0.777759, loss_d: 0.180049
0.4610 --- loss: 1.369387, loss_ss: 0.864214, loss_d: 0.505173
0.4994 --- loss: 2.065067, loss_ss: 1.234924, loss_d: 0.830143
0.5378 --- loss: 1.165040, loss_ss: 0.854354, loss_d: 0.310686
0.5763 --- loss: 1.604085, loss_ss: 1.072003, loss_d: 0.532082
0.6147 --- loss: 1.278626, loss_ss: 0.974620, loss_d: 0.304006
0.6531 --- loss: 1.687350, loss_ss: 1.143819, loss_d: 0.543531
0.6915 --- loss: 1.352657, loss_ss: 1.010906, loss_d: 0.341751
0.7299 --- loss: 1.355929, loss_ss: 0.915735, loss_d: 0.440194
0.7683 --- loss: 1.442194, loss_ss: 1.012761, loss_d: 0.429433
0.8068 --- loss: 1.015267, loss_ss: 0.800278, loss_d: 0.214989
0.8452 --- loss: 1.645982, loss_ss: 1.164763, loss_d: 0.481219
0.8836 --- loss: 1.530210, loss_ss: 1.125386, loss_d: 0.404824
0.9220 --- loss: 1.385588, loss_ss: 1.072876, loss_d: 0.312712
0.9604 --- loss: 1.349207, loss_ss: 1.040956, loss_d: 0.308250
0.9988 --- loss: 1.602380, loss_ss: 1.195827, loss_d: 0.406553
Epoch finished! Loss: 1.4193958988556494
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.238605, loss_ss: 0.958747, loss_d: 0.279858
0.0384 --- loss: 1.051798, loss_ss: 0.899277, loss_d: 0.152521
0.0768 --- loss: 1.666235, loss_ss: 1.052460, loss_d: 0.613774
0.1153 --- loss: 1.711142, loss_ss: 1.052317, loss_d: 0.658825
0.1537 --- loss: 1.446888, loss_ss: 0.996941, loss_d: 0.449947
0.1921 --- loss: 1.087833, loss_ss: 0.705181, loss_d: 0.382652
0.2305 --- loss: 1.748914, loss_ss: 1.325398, loss_d: 0.423517
0.2689 --- loss: 1.512616, loss_ss: 0.834385, loss_d: 0.678231
0.3073 --- loss: 1.373444, loss_ss: 0.945079, loss_d: 0.428364
0.3458 --- loss: 1.934527, loss_ss: 1.028527, loss_d: 0.906000
0.3842 --- loss: 1.562996, loss_ss: 0.826503, loss_d: 0.736493
0.4226 --- loss: 1.281082, loss_ss: 0.752398, loss_d: 0.528683
0.4610 --- loss: 1.550712, loss_ss: 1.128810, loss_d: 0.421903
0.4994 --- loss: 1.504170, loss_ss: 1.100664, loss_d: 0.403506
0.5378 --- loss: 1.512955, loss_ss: 1.136129, loss_d: 0.376826
0.5763 --- loss: 1.481465, loss_ss: 1.106060, loss_d: 0.375405
0.6147 --- loss: 0.966658, loss_ss: 0.660915, loss_d: 0.305743
0.6531 --- loss: 1.343185, loss_ss: 0.985262, loss_d: 0.357924
0.6915 --- loss: 1.021481, loss_ss: 0.799866, loss_d: 0.221616
0.7299 --- loss: 1.518324, loss_ss: 0.728479, loss_d: 0.789844
0.7683 --- loss: 1.086620, loss_ss: 0.765048, loss_d: 0.321572
0.8068 --- loss: 1.473012, loss_ss: 0.783735, loss_d: 0.689277
0.8452 --- loss: 1.104385, loss_ss: 0.730564, loss_d: 0.373821
0.8836 --- loss: 1.144405, loss_ss: 0.772307, loss_d: 0.372097
0.9220 --- loss: 1.319710, loss_ss: 1.074925, loss_d: 0.244785
0.9604 --- loss: 1.079840, loss_ss: 0.846211, loss_d: 0.233629
0.9988 --- loss: 1.597867, loss_ss: 0.850142, loss_d: 0.747726
Epoch finished! Loss: 1.362870552448126
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.164611, loss_ss: 0.702664, loss_d: 0.461947
0.0384 --- loss: 1.427886, loss_ss: 0.822221, loss_d: 0.605665
0.0768 --- loss: 1.286433, loss_ss: 1.000993, loss_d: 0.285440
0.1153 --- loss: 1.636319, loss_ss: 1.394532, loss_d: 0.241787
0.1537 --- loss: 1.203165, loss_ss: 0.948677, loss_d: 0.254487
0.1921 --- loss: 0.894972, loss_ss: 0.767239, loss_d: 0.127733
0.2305 --- loss: 1.579556, loss_ss: 0.919494, loss_d: 0.660062
0.2689 --- loss: 1.400338, loss_ss: 0.864284, loss_d: 0.536053
0.3073 --- loss: 0.936725, loss_ss: 0.606266, loss_d: 0.330459
0.3458 --- loss: 1.564721, loss_ss: 1.097425, loss_d: 0.467296
0.3842 --- loss: 1.921426, loss_ss: 1.006760, loss_d: 0.914666
0.4226 --- loss: 1.325335, loss_ss: 0.916306, loss_d: 0.409029
0.4610 --- loss: 1.460778, loss_ss: 0.987426, loss_d: 0.473352
0.4994 --- loss: 1.164445, loss_ss: 0.957029, loss_d: 0.207416
0.5378 --- loss: 1.180852, loss_ss: 0.774935, loss_d: 0.405917
0.5763 --- loss: 1.412653, loss_ss: 1.063669, loss_d: 0.348984
0.6147 --- loss: 1.058169, loss_ss: 0.831107, loss_d: 0.227062
0.6531 --- loss: 1.198853, loss_ss: 0.599980, loss_d: 0.598874
0.6915 --- loss: 1.112735, loss_ss: 0.806682, loss_d: 0.306053
0.7299 --- loss: 1.411693, loss_ss: 1.148322, loss_d: 0.263372
0.7683 --- loss: 1.341870, loss_ss: 1.081435, loss_d: 0.260435
0.8068 --- loss: 1.932791, loss_ss: 0.932923, loss_d: 0.999869
0.8452 --- loss: 1.213343, loss_ss: 0.799431, loss_d: 0.413912
0.8836 --- loss: 1.184791, loss_ss: 0.840327, loss_d: 0.344464
0.9220 --- loss: 1.394551, loss_ss: 0.960864, loss_d: 0.433688
0.9604 --- loss: 1.265655, loss_ss: 0.975745, loss_d: 0.289910
0.9988 --- loss: 1.207003, loss_ss: 0.928443, loss_d: 0.278559
Epoch finished! Loss: 1.3051674991846085
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.486719, loss_ss: 1.234833, loss_d: 0.251885
0.0384 --- loss: 1.360775, loss_ss: 1.153068, loss_d: 0.207707
0.0768 --- loss: 0.942168, loss_ss: 0.722017, loss_d: 0.220151
0.1153 --- loss: 1.124418, loss_ss: 0.846543, loss_d: 0.277875
0.1537 --- loss: 1.281615, loss_ss: 1.021806, loss_d: 0.259809
0.1921 --- loss: 1.264146, loss_ss: 0.972263, loss_d: 0.291883
0.2305 --- loss: 1.083707, loss_ss: 0.777274, loss_d: 0.306434
0.2689 --- loss: 1.432979, loss_ss: 1.037284, loss_d: 0.395696
0.3073 --- loss: 1.073150, loss_ss: 0.814789, loss_d: 0.258362
0.3458 --- loss: 0.822215, loss_ss: 0.637746, loss_d: 0.184469
0.3842 --- loss: 0.907814, loss_ss: 0.606711, loss_d: 0.301103
0.4226 --- loss: 1.161989, loss_ss: 0.890277, loss_d: 0.271712
0.4610 --- loss: 1.417012, loss_ss: 1.068272, loss_d: 0.348741
0.4994 --- loss: 0.963829, loss_ss: 0.703386, loss_d: 0.260443
0.5378 --- loss: 1.122777, loss_ss: 0.878019, loss_d: 0.244757
0.5763 --- loss: 1.056498, loss_ss: 0.848632, loss_d: 0.207866
0.6147 --- loss: 1.152821, loss_ss: 0.920036, loss_d: 0.232786
0.6531 --- loss: 1.015263, loss_ss: 0.851620, loss_d: 0.163643
0.6915 --- loss: 1.372342, loss_ss: 1.210563, loss_d: 0.161779
0.7299 --- loss: 1.173192, loss_ss: 0.797140, loss_d: 0.376052
0.7683 --- loss: 1.206542, loss_ss: 1.002790, loss_d: 0.203752
0.8068 --- loss: 1.041821, loss_ss: 0.863243, loss_d: 0.178578
0.8452 --- loss: 1.062316, loss_ss: 0.618230, loss_d: 0.444086
0.8836 --- loss: 1.267399, loss_ss: 1.093618, loss_d: 0.173782
0.9220 --- loss: 1.385289, loss_ss: 1.123741, loss_d: 0.261548
0.9604 --- loss: 1.411108, loss_ss: 1.002606, loss_d: 0.408502
0.9988 --- loss: 1.173637, loss_ss: 1.044675, loss_d: 0.128962
Epoch finished! Loss: 1.2576353135017249
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.206645, loss_ss: 1.017652, loss_d: 0.188993
0.0384 --- loss: 1.163068, loss_ss: 0.918268, loss_d: 0.244799
0.0768 --- loss: 1.298312, loss_ss: 1.006933, loss_d: 0.291378
0.1153 --- loss: 1.527501, loss_ss: 0.925699, loss_d: 0.601802
0.1537 --- loss: 1.207759, loss_ss: 0.768143, loss_d: 0.439616
0.1921 --- loss: 0.972551, loss_ss: 0.720258, loss_d: 0.252293
0.2305 --- loss: 1.278111, loss_ss: 0.928339, loss_d: 0.349772
0.2689 --- loss: 0.849951, loss_ss: 0.731153, loss_d: 0.118798
0.3073 --- loss: 1.557662, loss_ss: 1.132706, loss_d: 0.424957
0.3458 --- loss: 1.509388, loss_ss: 0.793451, loss_d: 0.715937
0.3842 --- loss: 1.260038, loss_ss: 0.793954, loss_d: 0.466084
0.4226 --- loss: 1.478593, loss_ss: 0.687548, loss_d: 0.791045
0.4610 --- loss: 1.017474, loss_ss: 0.770693, loss_d: 0.246780
0.4994 --- loss: 1.214328, loss_ss: 0.772226, loss_d: 0.442102
0.5378 --- loss: 0.890341, loss_ss: 0.669296, loss_d: 0.221045
0.5763 --- loss: 1.406367, loss_ss: 1.006859, loss_d: 0.399508
0.6147 --- loss: 1.243541, loss_ss: 0.823840, loss_d: 0.419700
0.6531 --- loss: 1.356293, loss_ss: 1.086689, loss_d: 0.269603
0.6915 --- loss: 1.386009, loss_ss: 1.013921, loss_d: 0.372088
0.7299 --- loss: 0.945636, loss_ss: 0.839606, loss_d: 0.106030
0.7683 --- loss: 1.240240, loss_ss: 0.891491, loss_d: 0.348749
0.8068 --- loss: 1.204463, loss_ss: 0.958904, loss_d: 0.245560
0.8452 --- loss: 1.093793, loss_ss: 0.693847, loss_d: 0.399947
0.8836 --- loss: 1.021696, loss_ss: 0.711792, loss_d: 0.309905
0.9220 --- loss: 1.199922, loss_ss: 1.044976, loss_d: 0.154946
0.9604 --- loss: 1.317137, loss_ss: 1.038482, loss_d: 0.278655
0.9988 --- loss: 1.148972, loss_ss: 1.056422, loss_d: 0.092550
Epoch finished! Loss: 1.1884333945237673
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.166787, loss_ss: 0.910288, loss_d: 0.256499
0.0384 --- loss: 1.195648, loss_ss: 0.884734, loss_d: 0.310914
0.0768 --- loss: 0.813112, loss_ss: 0.625343, loss_d: 0.187769
0.1153 --- loss: 1.187699, loss_ss: 0.924789, loss_d: 0.262911
0.1537 --- loss: 1.055400, loss_ss: 0.758909, loss_d: 0.296491
0.1921 --- loss: 1.216733, loss_ss: 0.745942, loss_d: 0.470791
0.2305 --- loss: 1.580906, loss_ss: 1.086386, loss_d: 0.494520
0.2689 --- loss: 1.201887, loss_ss: 1.043658, loss_d: 0.158228
0.3073 --- loss: 1.088794, loss_ss: 0.935357, loss_d: 0.153437
0.3458 --- loss: 1.163425, loss_ss: 0.934423, loss_d: 0.229002
0.3842 --- loss: 1.453743, loss_ss: 1.046466, loss_d: 0.407277
0.4226 --- loss: 1.159840, loss_ss: 0.795560, loss_d: 0.364279
0.4610 --- loss: 1.189968, loss_ss: 0.859502, loss_d: 0.330466
0.4994 --- loss: 1.154271, loss_ss: 0.902142, loss_d: 0.252129
0.5378 --- loss: 0.921355, loss_ss: 0.591622, loss_d: 0.329733
0.5763 --- loss: 1.378247, loss_ss: 0.681873, loss_d: 0.696374
0.6147 --- loss: 1.210910, loss_ss: 0.947255, loss_d: 0.263655
0.6531 --- loss: 1.586532, loss_ss: 0.855657, loss_d: 0.730875
0.6915 --- loss: 0.971495, loss_ss: 0.755360, loss_d: 0.216135
0.7299 --- loss: 0.766804, loss_ss: 0.574781, loss_d: 0.192023
0.7683 --- loss: 0.804391, loss_ss: 0.654093, loss_d: 0.150299
0.8068 --- loss: 1.473901, loss_ss: 0.658903, loss_d: 0.814998
0.8452 --- loss: 0.884289, loss_ss: 0.628179, loss_d: 0.256110
0.8836 --- loss: 0.869761, loss_ss: 0.700652, loss_d: 0.169109
0.9220 --- loss: 1.002356, loss_ss: 0.852955, loss_d: 0.149400
0.9604 --- loss: 1.472162, loss_ss: 0.903207, loss_d: 0.568954
0.9988 --- loss: 1.758554, loss_ss: 1.178138, loss_d: 0.580416
Epoch finished! Loss: 1.165899228132688
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.434992, loss_ss: 0.932829, loss_d: 0.502164
0.0384 --- loss: 1.236074, loss_ss: 0.898720, loss_d: 0.337354
0.0768 --- loss: 0.884070, loss_ss: 0.700164, loss_d: 0.183906
0.1153 --- loss: 1.070719, loss_ss: 0.825419, loss_d: 0.245300
0.1537 --- loss: 1.349097, loss_ss: 1.046216, loss_d: 0.302881
0.1921 --- loss: 1.045427, loss_ss: 0.750282, loss_d: 0.295145
0.2305 --- loss: 1.220671, loss_ss: 1.106052, loss_d: 0.114620
0.2689 --- loss: 0.996321, loss_ss: 0.800092, loss_d: 0.196229
0.3073 --- loss: 1.277622, loss_ss: 0.856066, loss_d: 0.421556
0.3458 --- loss: 0.829317, loss_ss: 0.762095, loss_d: 0.067222
0.3842 --- loss: 1.320044, loss_ss: 1.144372, loss_d: 0.175671
0.4226 --- loss: 1.213574, loss_ss: 0.919695, loss_d: 0.293879
0.4610 --- loss: 0.911018, loss_ss: 0.751032, loss_d: 0.159986
0.4994 --- loss: 1.113282, loss_ss: 0.724672, loss_d: 0.388610
0.5378 --- loss: 0.767819, loss_ss: 0.650164, loss_d: 0.117655
0.5763 --- loss: 1.183018, loss_ss: 0.973577, loss_d: 0.209441
0.6147 --- loss: 0.847207, loss_ss: 0.571844, loss_d: 0.275363
0.6531 --- loss: 1.228773, loss_ss: 1.045760, loss_d: 0.183013
0.6915 --- loss: 1.239831, loss_ss: 0.962595, loss_d: 0.277237
0.7299 --- loss: 1.127642, loss_ss: 0.811637, loss_d: 0.316004
0.7683 --- loss: 1.260625, loss_ss: 0.756366, loss_d: 0.504259
0.8068 --- loss: 0.940799, loss_ss: 0.652833, loss_d: 0.287966
0.8452 --- loss: 1.165598, loss_ss: 0.842105, loss_d: 0.323493
0.8836 --- loss: 1.147369, loss_ss: 0.789702, loss_d: 0.357667
0.9220 --- loss: 0.945370, loss_ss: 0.837504, loss_d: 0.107866
0.9604 --- loss: 1.057476, loss_ss: 0.930335, loss_d: 0.127141
0.9988 --- loss: 1.357707, loss_ss: 0.780275, loss_d: 0.577432
Epoch finished! Loss: 1.135976179287984
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6723809523809524
             precision    recall  f1-score   support

        0.0       0.37      0.60      0.45        25
        1.0       0.15      0.10      0.12        93
        2.0       0.58      0.62      0.60       324
        3.0       0.93      0.80      0.86       484
        4.0       0.51      0.78      0.62       124

avg / total       0.69      0.67      0.67      1050
 


====== chp044-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  96.57  60.00   97.46  36.59     45.45
1  87.24   9.68   94.78  15.25     11.84
2  74.38  61.73   80.03  57.97     59.79
3  87.71  79.55   94.70  92.77     85.65
4  88.57  78.23   89.96  51.05     61.78
Total accuracy: 67.24%
Average sen: 57.84%
Average spec: 91.38%
Macro f1-score: 52.90%
Diagnosis acc on 15mins: 1.0
[0.95863044 0.9968183  0.90109444 0.9154554  0.83730298 0.97052181
 0.99951816 0.99948537 0.99186277 0.99565083 0.99921572 0.98109967
 0.99784935 0.99939024 0.98709238 0.91852492 0.9464469  0.91643453
 0.91371685 0.9972716  0.99909103 0.99776757 0.98923057 0.99767667
 0.99019617 0.99087536 0.997015   0.99589241 0.96432608 0.97574484
 0.99579912 0.94493794 0.99890137 0.99604589 0.9322598 ]
pred: 0.9711183565003532, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp045-nsrr. train_data(2598), test_data(40) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.372001, loss_ss: 1.705079, loss_d: 0.666922
0.0385 --- loss: 2.175621, loss_ss: 1.637737, loss_d: 0.537884
0.0770 --- loss: 1.929325, loss_ss: 1.400043, loss_d: 0.529282
0.1155 --- loss: 1.960521, loss_ss: 1.355615, loss_d: 0.604906
0.1540 --- loss: 2.001373, loss_ss: 1.371782, loss_d: 0.629590
0.1925 --- loss: 1.799281, loss_ss: 1.308256, loss_d: 0.491025
0.2309 --- loss: 1.895585, loss_ss: 1.418238, loss_d: 0.477348
0.2694 --- loss: 2.122058, loss_ss: 1.437098, loss_d: 0.684960
0.3079 --- loss: 1.699682, loss_ss: 1.184809, loss_d: 0.514873
0.3464 --- loss: 1.922913, loss_ss: 1.343583, loss_d: 0.579331
0.3849 --- loss: 2.103260, loss_ss: 1.431303, loss_d: 0.671958
0.4234 --- loss: 2.067231, loss_ss: 1.436315, loss_d: 0.630916
0.4619 --- loss: 1.616127, loss_ss: 1.160125, loss_d: 0.456002
0.5004 --- loss: 1.888431, loss_ss: 1.307910, loss_d: 0.580520
0.5389 --- loss: 1.766737, loss_ss: 1.365004, loss_d: 0.401733
0.5774 --- loss: 1.883390, loss_ss: 1.182827, loss_d: 0.700564
0.6159 --- loss: 1.942995, loss_ss: 1.281714, loss_d: 0.661281
0.6543 --- loss: 1.702100, loss_ss: 1.219304, loss_d: 0.482796
0.6928 --- loss: 1.869049, loss_ss: 1.309471, loss_d: 0.559578
0.7313 --- loss: 2.006982, loss_ss: 1.377217, loss_d: 0.629765
0.7698 --- loss: 1.632882, loss_ss: 1.329450, loss_d: 0.303432
0.8083 --- loss: 1.852695, loss_ss: 1.312319, loss_d: 0.540376
0.8468 --- loss: 1.941932, loss_ss: 1.263453, loss_d: 0.678479
0.8853 --- loss: 1.533732, loss_ss: 1.199237, loss_d: 0.334495
0.9238 --- loss: 1.860043, loss_ss: 1.193242, loss_d: 0.666801
0.9623 --- loss: 1.790545, loss_ss: 1.259575, loss_d: 0.530971
Epoch finished! Loss: 1.9032911241744936
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.587291, loss_ss: 1.066564, loss_d: 0.520727
0.0385 --- loss: 2.135326, loss_ss: 1.387429, loss_d: 0.747897
0.0770 --- loss: 1.802690, loss_ss: 1.065034, loss_d: 0.737655
0.1155 --- loss: 1.595521, loss_ss: 1.094476, loss_d: 0.501046
0.1540 --- loss: 1.690103, loss_ss: 1.142268, loss_d: 0.547835
0.1925 --- loss: 1.703958, loss_ss: 1.259767, loss_d: 0.444191
0.2309 --- loss: 2.105332, loss_ss: 1.126801, loss_d: 0.978531
0.2694 --- loss: 1.395768, loss_ss: 1.012534, loss_d: 0.383234
0.3079 --- loss: 1.479094, loss_ss: 1.094399, loss_d: 0.384695
0.3464 --- loss: 1.240981, loss_ss: 0.895883, loss_d: 0.345098
0.3849 --- loss: 1.534764, loss_ss: 1.250235, loss_d: 0.284529
0.4234 --- loss: 1.306335, loss_ss: 0.909973, loss_d: 0.396362
0.4619 --- loss: 1.683824, loss_ss: 1.106299, loss_d: 0.577525
0.5004 --- loss: 1.762339, loss_ss: 1.190478, loss_d: 0.571861
0.5389 --- loss: 1.410133, loss_ss: 0.993004, loss_d: 0.417128
0.5774 --- loss: 1.960716, loss_ss: 1.008847, loss_d: 0.951869
0.6159 --- loss: 1.937151, loss_ss: 1.224836, loss_d: 0.712315
0.6543 --- loss: 1.617530, loss_ss: 1.244225, loss_d: 0.373306
0.6928 --- loss: 1.519975, loss_ss: 1.036295, loss_d: 0.483679
0.7313 --- loss: 1.900099, loss_ss: 1.041837, loss_d: 0.858262
0.7698 --- loss: 1.568320, loss_ss: 1.023783, loss_d: 0.544537
0.8083 --- loss: 1.628116, loss_ss: 1.109748, loss_d: 0.518368
0.8468 --- loss: 1.911660, loss_ss: 1.064058, loss_d: 0.847602
0.8853 --- loss: 1.878179, loss_ss: 1.112383, loss_d: 0.765797
0.9238 --- loss: 1.690295, loss_ss: 0.953745, loss_d: 0.736550
0.9623 --- loss: 1.813414, loss_ss: 1.220627, loss_d: 0.592787
Epoch finished! Loss: 1.6678679997396284
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 2.037401, loss_ss: 1.011087, loss_d: 1.026314
0.0385 --- loss: 1.541806, loss_ss: 1.158507, loss_d: 0.383299
0.0770 --- loss: 1.297411, loss_ss: 0.914122, loss_d: 0.383289
0.1155 --- loss: 1.643573, loss_ss: 1.087129, loss_d: 0.556444
0.1540 --- loss: 1.494455, loss_ss: 1.015723, loss_d: 0.478732
0.1925 --- loss: 1.476026, loss_ss: 0.828660, loss_d: 0.647366
0.2309 --- loss: 1.362926, loss_ss: 0.804802, loss_d: 0.558124
0.2694 --- loss: 1.406273, loss_ss: 0.935660, loss_d: 0.470613
0.3079 --- loss: 1.523324, loss_ss: 1.109861, loss_d: 0.413463
0.3464 --- loss: 1.409213, loss_ss: 1.077435, loss_d: 0.331778
0.3849 --- loss: 1.787778, loss_ss: 1.147516, loss_d: 0.640262
0.4234 --- loss: 1.543845, loss_ss: 0.785082, loss_d: 0.758763
0.4619 --- loss: 1.606697, loss_ss: 0.999743, loss_d: 0.606954
0.5004 --- loss: 1.584481, loss_ss: 1.106004, loss_d: 0.478476
0.5389 --- loss: 1.281489, loss_ss: 0.902126, loss_d: 0.379363
0.5774 --- loss: 1.679546, loss_ss: 1.072960, loss_d: 0.606586
0.6159 --- loss: 1.400901, loss_ss: 1.101852, loss_d: 0.299049
0.6543 --- loss: 1.252797, loss_ss: 0.987300, loss_d: 0.265498
0.6928 --- loss: 1.346953, loss_ss: 0.874753, loss_d: 0.472200
0.7313 --- loss: 1.572271, loss_ss: 1.018640, loss_d: 0.553631
0.7698 --- loss: 1.269986, loss_ss: 0.859177, loss_d: 0.410809
0.8083 --- loss: 1.806921, loss_ss: 0.914383, loss_d: 0.892538
0.8468 --- loss: 1.512383, loss_ss: 0.852679, loss_d: 0.659704
0.8853 --- loss: 1.764757, loss_ss: 1.245397, loss_d: 0.519360
0.9238 --- loss: 1.324410, loss_ss: 1.005476, loss_d: 0.318934
0.9623 --- loss: 1.565422, loss_ss: 0.939720, loss_d: 0.625702
Epoch finished! Loss: 1.5072761953567446
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.162973, loss_ss: 0.835040, loss_d: 0.327932
0.0385 --- loss: 1.258794, loss_ss: 0.716124, loss_d: 0.542669
0.0770 --- loss: 1.098048, loss_ss: 0.839458, loss_d: 0.258590
0.1155 --- loss: 1.672801, loss_ss: 1.143854, loss_d: 0.528947
0.1540 --- loss: 1.015178, loss_ss: 0.756194, loss_d: 0.258984
0.1925 --- loss: 1.351518, loss_ss: 0.995325, loss_d: 0.356193
0.2309 --- loss: 1.437944, loss_ss: 0.999393, loss_d: 0.438551
0.2694 --- loss: 1.682905, loss_ss: 1.180502, loss_d: 0.502403
0.3079 --- loss: 1.220380, loss_ss: 1.010641, loss_d: 0.209739
0.3464 --- loss: 1.279596, loss_ss: 0.933801, loss_d: 0.345795
0.3849 --- loss: 1.543827, loss_ss: 1.078578, loss_d: 0.465250
0.4234 --- loss: 1.026559, loss_ss: 0.812485, loss_d: 0.214074
0.4619 --- loss: 1.845347, loss_ss: 1.290001, loss_d: 0.555346
0.5004 --- loss: 1.314436, loss_ss: 1.001483, loss_d: 0.312953
0.5389 --- loss: 1.371643, loss_ss: 0.884775, loss_d: 0.486867
0.5774 --- loss: 1.703899, loss_ss: 1.274558, loss_d: 0.429340
0.6159 --- loss: 1.510541, loss_ss: 1.136712, loss_d: 0.373829
0.6543 --- loss: 1.214652, loss_ss: 0.856331, loss_d: 0.358320
0.6928 --- loss: 1.718896, loss_ss: 1.039528, loss_d: 0.679368
0.7313 --- loss: 1.482873, loss_ss: 1.167917, loss_d: 0.314956
0.7698 --- loss: 1.348956, loss_ss: 1.062924, loss_d: 0.286032
0.8083 --- loss: 1.885715, loss_ss: 1.392248, loss_d: 0.493466
0.8468 --- loss: 1.225559, loss_ss: 0.852132, loss_d: 0.373427
0.8853 --- loss: 1.203210, loss_ss: 0.834153, loss_d: 0.369058
0.9238 --- loss: 1.889586, loss_ss: 0.982774, loss_d: 0.906812
0.9623 --- loss: 1.282040, loss_ss: 0.927869, loss_d: 0.354171
Epoch finished! Loss: 1.4298618030824257
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.529535, loss_ss: 0.890212, loss_d: 0.639323
0.0385 --- loss: 1.085484, loss_ss: 0.919214, loss_d: 0.166269
0.0770 --- loss: 1.011381, loss_ss: 0.738241, loss_d: 0.273141
0.1155 --- loss: 1.116667, loss_ss: 0.911217, loss_d: 0.205449
0.1540 --- loss: 1.564316, loss_ss: 1.075511, loss_d: 0.488804
0.1925 --- loss: 1.237874, loss_ss: 1.004355, loss_d: 0.233518
0.2309 --- loss: 1.564455, loss_ss: 0.872842, loss_d: 0.691613
0.2694 --- loss: 0.958381, loss_ss: 0.666463, loss_d: 0.291918
0.3079 --- loss: 1.456562, loss_ss: 0.993909, loss_d: 0.462652
0.3464 --- loss: 1.179808, loss_ss: 0.957615, loss_d: 0.222193
0.3849 --- loss: 1.299184, loss_ss: 0.789505, loss_d: 0.509679
0.4234 --- loss: 1.930914, loss_ss: 0.982516, loss_d: 0.948398
0.4619 --- loss: 0.861354, loss_ss: 0.613930, loss_d: 0.247424
0.5004 --- loss: 1.058641, loss_ss: 0.805087, loss_d: 0.253554
0.5389 --- loss: 1.179583, loss_ss: 0.955479, loss_d: 0.224104
0.5774 --- loss: 1.111657, loss_ss: 0.774371, loss_d: 0.337286
0.6159 --- loss: 1.474383, loss_ss: 0.864272, loss_d: 0.610111
0.6543 --- loss: 1.166849, loss_ss: 0.756395, loss_d: 0.410454
0.6928 --- loss: 1.545459, loss_ss: 0.958796, loss_d: 0.586663
0.7313 --- loss: 1.513798, loss_ss: 1.078424, loss_d: 0.435374
0.7698 --- loss: 1.307213, loss_ss: 0.953117, loss_d: 0.354096
0.8083 --- loss: 1.305911, loss_ss: 1.001460, loss_d: 0.304451
0.8468 --- loss: 1.842516, loss_ss: 1.214266, loss_d: 0.628250
0.8853 --- loss: 1.098575, loss_ss: 0.927894, loss_d: 0.170681
0.9238 --- loss: 0.971208, loss_ss: 0.726131, loss_d: 0.245077
0.9623 --- loss: 1.727142, loss_ss: 0.988571, loss_d: 0.738571
Epoch finished! Loss: 1.3464475320112752
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.109990, loss_ss: 0.858896, loss_d: 0.251094
0.0385 --- loss: 1.563801, loss_ss: 1.303329, loss_d: 0.260471
0.0770 --- loss: 1.379585, loss_ss: 0.909540, loss_d: 0.470045
0.1155 --- loss: 1.049226, loss_ss: 0.722710, loss_d: 0.326516
0.1540 --- loss: 1.564211, loss_ss: 1.114597, loss_d: 0.449614
0.1925 --- loss: 1.058523, loss_ss: 0.742467, loss_d: 0.316055
0.2309 --- loss: 1.055426, loss_ss: 0.874406, loss_d: 0.181020
0.2694 --- loss: 1.197065, loss_ss: 0.825094, loss_d: 0.371971
0.3079 --- loss: 2.037061, loss_ss: 0.851341, loss_d: 1.185720
0.3464 --- loss: 1.269346, loss_ss: 0.752395, loss_d: 0.516951
0.3849 --- loss: 1.620854, loss_ss: 1.110826, loss_d: 0.510027
0.4234 --- loss: 1.046245, loss_ss: 0.747643, loss_d: 0.298602
0.4619 --- loss: 1.257781, loss_ss: 0.979407, loss_d: 0.278373
0.5004 --- loss: 1.346367, loss_ss: 0.899359, loss_d: 0.447008
0.5389 --- loss: 1.100247, loss_ss: 0.793138, loss_d: 0.307109
0.5774 --- loss: 1.054237, loss_ss: 0.922356, loss_d: 0.131881
0.6159 --- loss: 1.100954, loss_ss: 0.884681, loss_d: 0.216273
0.6543 --- loss: 1.412501, loss_ss: 0.722843, loss_d: 0.689658
0.6928 --- loss: 1.095411, loss_ss: 0.626800, loss_d: 0.468612
0.7313 --- loss: 1.084159, loss_ss: 0.904988, loss_d: 0.179170
0.7698 --- loss: 1.436062, loss_ss: 1.092053, loss_d: 0.344009
0.8083 --- loss: 1.497238, loss_ss: 0.628729, loss_d: 0.868509
0.8468 --- loss: 1.520273, loss_ss: 1.218196, loss_d: 0.302077
0.8853 --- loss: 1.377732, loss_ss: 0.874898, loss_d: 0.502834
0.9238 --- loss: 0.967959, loss_ss: 0.809933, loss_d: 0.158026
0.9623 --- loss: 1.196045, loss_ss: 0.940096, loss_d: 0.255949
Epoch finished! Loss: 1.2810033605825948
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.365810, loss_ss: 0.954784, loss_d: 0.411026
0.0385 --- loss: 1.195818, loss_ss: 0.985688, loss_d: 0.210130
0.0770 --- loss: 1.312188, loss_ss: 1.062638, loss_d: 0.249550
0.1155 --- loss: 1.152521, loss_ss: 0.952114, loss_d: 0.200407
0.1540 --- loss: 1.136432, loss_ss: 0.760353, loss_d: 0.376078
0.1925 --- loss: 1.070851, loss_ss: 0.937895, loss_d: 0.132956
0.2309 --- loss: 0.833037, loss_ss: 0.670941, loss_d: 0.162096
0.2694 --- loss: 1.498870, loss_ss: 1.019884, loss_d: 0.478986
0.3079 --- loss: 1.165965, loss_ss: 0.793297, loss_d: 0.372668
0.3464 --- loss: 1.161070, loss_ss: 0.901096, loss_d: 0.259975
0.3849 --- loss: 1.227060, loss_ss: 0.966440, loss_d: 0.260620
0.4234 --- loss: 0.935419, loss_ss: 0.541007, loss_d: 0.394413
0.4619 --- loss: 0.717568, loss_ss: 0.530315, loss_d: 0.187253
0.5004 --- loss: 1.138617, loss_ss: 0.683178, loss_d: 0.455439
0.5389 --- loss: 1.273453, loss_ss: 0.949035, loss_d: 0.324418
0.5774 --- loss: 1.381239, loss_ss: 0.992605, loss_d: 0.388634
0.6159 --- loss: 1.083882, loss_ss: 0.678901, loss_d: 0.404981
0.6543 --- loss: 1.401903, loss_ss: 0.647077, loss_d: 0.754825
0.6928 --- loss: 1.145201, loss_ss: 0.955209, loss_d: 0.189992
0.7313 --- loss: 0.985718, loss_ss: 0.726290, loss_d: 0.259429
0.7698 --- loss: 1.067834, loss_ss: 0.882260, loss_d: 0.185573
0.8083 --- loss: 1.485861, loss_ss: 1.169937, loss_d: 0.315923
0.8468 --- loss: 1.308197, loss_ss: 1.001664, loss_d: 0.306533
0.8853 --- loss: 1.112149, loss_ss: 0.782501, loss_d: 0.329649
0.9238 --- loss: 1.242357, loss_ss: 0.896059, loss_d: 0.346298
0.9623 --- loss: 0.864163, loss_ss: 0.709797, loss_d: 0.154366
Epoch finished! Loss: 1.2409449969939743
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.283211, loss_ss: 1.015204, loss_d: 0.268007
0.0385 --- loss: 1.087664, loss_ss: 0.824843, loss_d: 0.262821
0.0770 --- loss: 0.991398, loss_ss: 0.843697, loss_d: 0.147701
0.1155 --- loss: 1.356635, loss_ss: 0.851984, loss_d: 0.504650
0.1540 --- loss: 1.132961, loss_ss: 0.961739, loss_d: 0.171221
0.1925 --- loss: 1.264885, loss_ss: 1.134087, loss_d: 0.130797
0.2309 --- loss: 1.525621, loss_ss: 1.016410, loss_d: 0.509211
0.2694 --- loss: 1.425955, loss_ss: 0.951524, loss_d: 0.474430
0.3079 --- loss: 1.268728, loss_ss: 0.817901, loss_d: 0.450826
0.3464 --- loss: 1.328753, loss_ss: 1.168260, loss_d: 0.160493
0.3849 --- loss: 1.492047, loss_ss: 0.999201, loss_d: 0.492846
0.4234 --- loss: 0.939018, loss_ss: 0.782614, loss_d: 0.156404
0.4619 --- loss: 0.958888, loss_ss: 0.823948, loss_d: 0.134940
0.5004 --- loss: 1.113042, loss_ss: 0.821289, loss_d: 0.291754
0.5389 --- loss: 1.437058, loss_ss: 1.149993, loss_d: 0.287065
0.5774 --- loss: 1.301260, loss_ss: 1.119072, loss_d: 0.182188
0.6159 --- loss: 1.182889, loss_ss: 0.624159, loss_d: 0.558730
0.6543 --- loss: 1.157386, loss_ss: 0.731957, loss_d: 0.425429
0.6928 --- loss: 1.193546, loss_ss: 0.929238, loss_d: 0.264308
0.7313 --- loss: 0.847508, loss_ss: 0.699769, loss_d: 0.147739
0.7698 --- loss: 1.343904, loss_ss: 1.043021, loss_d: 0.300884
0.8083 --- loss: 1.158160, loss_ss: 0.846459, loss_d: 0.311701
0.8468 --- loss: 1.242985, loss_ss: 1.010491, loss_d: 0.232494
0.8853 --- loss: 0.799934, loss_ss: 0.655511, loss_d: 0.144423
0.9238 --- loss: 0.869207, loss_ss: 0.711790, loss_d: 0.157418
0.9623 --- loss: 0.888510, loss_ss: 0.710376, loss_d: 0.178133
Epoch finished! Loss: 1.2050286503832313
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.900570, loss_ss: 0.679699, loss_d: 0.220872
0.0385 --- loss: 1.159769, loss_ss: 0.866039, loss_d: 0.293730
0.0770 --- loss: 1.279120, loss_ss: 0.673978, loss_d: 0.605142
0.1155 --- loss: 1.425388, loss_ss: 1.195992, loss_d: 0.229396
0.1540 --- loss: 1.360554, loss_ss: 0.777491, loss_d: 0.583063
0.1925 --- loss: 1.011773, loss_ss: 0.758055, loss_d: 0.253718
0.2309 --- loss: 0.886868, loss_ss: 0.771359, loss_d: 0.115509
0.2694 --- loss: 1.356068, loss_ss: 0.912929, loss_d: 0.443138
0.3079 --- loss: 0.908123, loss_ss: 0.540814, loss_d: 0.367309
0.3464 --- loss: 1.206028, loss_ss: 0.851137, loss_d: 0.354891
0.3849 --- loss: 1.218383, loss_ss: 1.035079, loss_d: 0.183304
0.4234 --- loss: 1.198589, loss_ss: 0.997952, loss_d: 0.200637
0.4619 --- loss: 1.656914, loss_ss: 0.888027, loss_d: 0.768887
0.5004 --- loss: 1.110580, loss_ss: 0.753071, loss_d: 0.357509
0.5389 --- loss: 1.150312, loss_ss: 0.892197, loss_d: 0.258116
0.5774 --- loss: 1.114699, loss_ss: 0.854681, loss_d: 0.260018
0.6159 --- loss: 1.081504, loss_ss: 0.902861, loss_d: 0.178643
0.6543 --- loss: 0.748775, loss_ss: 0.656627, loss_d: 0.092148
0.6928 --- loss: 1.270552, loss_ss: 0.910295, loss_d: 0.360258
0.7313 --- loss: 1.610910, loss_ss: 1.345355, loss_d: 0.265555
0.7698 --- loss: 1.336497, loss_ss: 0.819549, loss_d: 0.516948
0.8083 --- loss: 1.265498, loss_ss: 1.013254, loss_d: 0.252243
0.8468 --- loss: 1.054438, loss_ss: 0.752280, loss_d: 0.302158
0.8853 --- loss: 1.505836, loss_ss: 1.257234, loss_d: 0.248602
0.9238 --- loss: 1.289172, loss_ss: 1.025825, loss_d: 0.263347
0.9623 --- loss: 0.986549, loss_ss: 0.860312, loss_d: 0.126237
Epoch finished! Loss: 1.1982742943818965
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.987620, loss_ss: 0.699823, loss_d: 0.287797
0.0385 --- loss: 1.292512, loss_ss: 1.004988, loss_d: 0.287524
0.0770 --- loss: 1.413435, loss_ss: 1.136640, loss_d: 0.276795
0.1155 --- loss: 1.083244, loss_ss: 0.944165, loss_d: 0.139079
0.1540 --- loss: 0.859405, loss_ss: 0.753417, loss_d: 0.105988
0.1925 --- loss: 0.923319, loss_ss: 0.772504, loss_d: 0.150814
0.2309 --- loss: 0.894919, loss_ss: 0.648450, loss_d: 0.246469
0.2694 --- loss: 0.942891, loss_ss: 0.691424, loss_d: 0.251467
0.3079 --- loss: 0.748521, loss_ss: 0.577841, loss_d: 0.170680
0.3464 --- loss: 1.117030, loss_ss: 0.916686, loss_d: 0.200344
0.3849 --- loss: 0.942680, loss_ss: 0.823183, loss_d: 0.119497
0.4234 --- loss: 1.524067, loss_ss: 1.092964, loss_d: 0.431102
0.4619 --- loss: 1.020834, loss_ss: 0.977332, loss_d: 0.043502
0.5004 --- loss: 1.146056, loss_ss: 0.888053, loss_d: 0.258002
0.5389 --- loss: 1.098898, loss_ss: 0.696921, loss_d: 0.401977
0.5774 --- loss: 1.082685, loss_ss: 0.922722, loss_d: 0.159963
0.6159 --- loss: 1.067179, loss_ss: 0.742899, loss_d: 0.324280
0.6543 --- loss: 1.153982, loss_ss: 0.868615, loss_d: 0.285367
0.6928 --- loss: 1.218293, loss_ss: 1.023021, loss_d: 0.195272
0.7313 --- loss: 1.040721, loss_ss: 0.908307, loss_d: 0.132414
0.7698 --- loss: 1.005514, loss_ss: 0.875052, loss_d: 0.130462
0.8083 --- loss: 0.727744, loss_ss: 0.596854, loss_d: 0.130890
0.8468 --- loss: 0.746779, loss_ss: 0.540211, loss_d: 0.206567
0.8853 --- loss: 1.254840, loss_ss: 0.673969, loss_d: 0.580871
0.9238 --- loss: 1.319276, loss_ss: 1.121816, loss_d: 0.197460
0.9623 --- loss: 0.953020, loss_ss: 0.784890, loss_d: 0.168130
Epoch finished! Loss: 1.1371603888894601
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.677231025854879
             precision    recall  f1-score   support

        0.0       0.74      0.68      0.71       151
        1.0       0.57      0.24      0.34       135
        2.0       0.78      0.66      0.71       442
        3.0       0.73      0.77      0.75       221
        4.0       0.54      0.86      0.67       250

avg / total       0.69      0.68      0.67      1199
 


====== chp045-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.91  68.21   96.47  73.57     70.79
1  89.41  23.70   97.74  57.14     33.51
2  80.57  65.61   89.30  78.17     71.34
3  90.66  77.38   93.66  73.39     75.33
4  81.90  86.40   80.72  54.14     66.56
Total accuracy: 67.72%
Average sen: 64.26%
Average spec: 91.58%
Macro f1-score: 63.51%
Diagnosis acc on 15mins: 0.85
[0.32869738 0.94260842 0.90944409 0.94989562 0.53178    0.27434459
 0.92086434 0.84961641 0.98232031 0.92070502 0.96893936 0.9775368
 0.83827996 0.93647259 0.81646609 0.87319303 0.90551287 0.77885264
 0.93393564 0.90743476 0.98784208 0.63772404 0.34541374 0.62452912
 0.54043776 0.89811951 0.95416647 0.45381585 0.92376292 0.90009236
 0.73236275 0.81716919 0.47527385 0.93223006 0.85925847 0.95478487
 0.38848022 0.75554919 0.8904826  0.98118126]
pred: 0.7899894066154957, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp046-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.282643, loss_ss: 1.565676, loss_d: 0.716967
0.0384 --- loss: 2.005562, loss_ss: 1.384901, loss_d: 0.620661
0.0769 --- loss: 1.889441, loss_ss: 1.458061, loss_d: 0.431380
0.1153 --- loss: 1.885823, loss_ss: 1.295472, loss_d: 0.590351
0.1537 --- loss: 1.987513, loss_ss: 1.397334, loss_d: 0.590179
0.1922 --- loss: 1.851104, loss_ss: 1.309943, loss_d: 0.541161
0.2306 --- loss: 2.085799, loss_ss: 1.121471, loss_d: 0.964328
0.2690 --- loss: 2.036976, loss_ss: 1.303705, loss_d: 0.733270
0.3075 --- loss: 1.891347, loss_ss: 1.210631, loss_d: 0.680716
0.3459 --- loss: 1.880498, loss_ss: 1.280904, loss_d: 0.599595
0.3843 --- loss: 1.919375, loss_ss: 1.352500, loss_d: 0.566875
0.4228 --- loss: 1.932216, loss_ss: 1.410987, loss_d: 0.521229
0.4612 --- loss: 1.899320, loss_ss: 1.383044, loss_d: 0.516275
0.4996 --- loss: 1.798226, loss_ss: 1.161978, loss_d: 0.636248
0.5380 --- loss: 1.940812, loss_ss: 1.287177, loss_d: 0.653635
0.5765 --- loss: 1.749815, loss_ss: 1.330261, loss_d: 0.419554
0.6149 --- loss: 1.799132, loss_ss: 1.291228, loss_d: 0.507905
0.6533 --- loss: 1.738883, loss_ss: 1.169037, loss_d: 0.569846
0.6918 --- loss: 1.846731, loss_ss: 1.085484, loss_d: 0.761247
0.7302 --- loss: 1.581863, loss_ss: 1.154131, loss_d: 0.427732
0.7686 --- loss: 1.611671, loss_ss: 1.216287, loss_d: 0.395384
0.8071 --- loss: 1.912566, loss_ss: 1.133334, loss_d: 0.779233
0.8455 --- loss: 1.967722, loss_ss: 1.380009, loss_d: 0.587713
0.8839 --- loss: 1.890105, loss_ss: 1.258076, loss_d: 0.632029
0.9224 --- loss: 1.447266, loss_ss: 1.033957, loss_d: 0.413309
0.9608 --- loss: 1.766938, loss_ss: 1.309650, loss_d: 0.457288
0.9992 --- loss: 1.649942, loss_ss: 1.295720, loss_d: 0.354222
Epoch finished! Loss: 1.890838400217203
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.667945, loss_ss: 1.146931, loss_d: 0.521014
0.0384 --- loss: 1.600814, loss_ss: 1.051270, loss_d: 0.549544
0.0769 --- loss: 1.917426, loss_ss: 1.235774, loss_d: 0.681652
0.1153 --- loss: 1.761704, loss_ss: 1.162990, loss_d: 0.598714
0.1537 --- loss: 1.883698, loss_ss: 1.157305, loss_d: 0.726392
0.1922 --- loss: 1.737483, loss_ss: 0.983266, loss_d: 0.754217
0.2306 --- loss: 1.803195, loss_ss: 1.268807, loss_d: 0.534388
0.2690 --- loss: 1.762257, loss_ss: 1.156077, loss_d: 0.606180
0.3075 --- loss: 1.482080, loss_ss: 0.939464, loss_d: 0.542616
0.3459 --- loss: 1.712001, loss_ss: 0.884181, loss_d: 0.827820
0.3843 --- loss: 1.689146, loss_ss: 0.980227, loss_d: 0.708919
0.4228 --- loss: 1.622674, loss_ss: 1.033258, loss_d: 0.589416
0.4612 --- loss: 1.712314, loss_ss: 1.170470, loss_d: 0.541844
0.4996 --- loss: 1.568434, loss_ss: 1.070364, loss_d: 0.498070
0.5380 --- loss: 1.696594, loss_ss: 0.911926, loss_d: 0.784668
0.5765 --- loss: 2.432087, loss_ss: 1.789977, loss_d: 0.642110
0.6149 --- loss: 1.588248, loss_ss: 0.878372, loss_d: 0.709876
0.6533 --- loss: 1.439887, loss_ss: 0.949237, loss_d: 0.490650
0.6918 --- loss: 1.387344, loss_ss: 1.020470, loss_d: 0.366874
0.7302 --- loss: 1.732706, loss_ss: 1.039666, loss_d: 0.693039
0.7686 --- loss: 2.131639, loss_ss: 1.449191, loss_d: 0.682448
0.8071 --- loss: 1.783482, loss_ss: 1.121965, loss_d: 0.661517
0.8455 --- loss: 1.727425, loss_ss: 0.955333, loss_d: 0.772092
0.8839 --- loss: 1.401269, loss_ss: 0.863144, loss_d: 0.538124
0.9224 --- loss: 1.544856, loss_ss: 0.937093, loss_d: 0.607763
0.9608 --- loss: 1.558556, loss_ss: 0.952216, loss_d: 0.606340
0.9992 --- loss: 1.755901, loss_ss: 1.409944, loss_d: 0.345956
Epoch finished! Loss: 1.6996371837762685
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.417114, loss_ss: 1.094915, loss_d: 0.322199
0.0384 --- loss: 1.380362, loss_ss: 0.881610, loss_d: 0.498751
0.0769 --- loss: 1.496812, loss_ss: 0.972001, loss_d: 0.524811
0.1153 --- loss: 1.648148, loss_ss: 1.187238, loss_d: 0.460910
0.1537 --- loss: 1.638263, loss_ss: 1.115171, loss_d: 0.523092
0.1922 --- loss: 1.462846, loss_ss: 0.949148, loss_d: 0.513698
0.2306 --- loss: 1.789674, loss_ss: 1.119748, loss_d: 0.669926
0.2690 --- loss: 1.493934, loss_ss: 0.960282, loss_d: 0.533652
0.3075 --- loss: 1.710380, loss_ss: 0.953421, loss_d: 0.756960
0.3459 --- loss: 1.625728, loss_ss: 0.846384, loss_d: 0.779345
0.3843 --- loss: 1.468673, loss_ss: 1.079171, loss_d: 0.389502
0.4228 --- loss: 1.548084, loss_ss: 1.041999, loss_d: 0.506085
0.4612 --- loss: 1.668466, loss_ss: 1.227235, loss_d: 0.441231
0.4996 --- loss: 1.329776, loss_ss: 0.890963, loss_d: 0.438813
0.5380 --- loss: 1.834099, loss_ss: 1.140484, loss_d: 0.693615
0.5765 --- loss: 1.505369, loss_ss: 1.034302, loss_d: 0.471067
0.6149 --- loss: 1.568213, loss_ss: 0.866490, loss_d: 0.701723
0.6533 --- loss: 1.494984, loss_ss: 0.768412, loss_d: 0.726572
0.6918 --- loss: 1.654892, loss_ss: 1.069639, loss_d: 0.585253
0.7302 --- loss: 1.327717, loss_ss: 0.747313, loss_d: 0.580403
0.7686 --- loss: 1.844073, loss_ss: 1.151018, loss_d: 0.693055
0.8071 --- loss: 1.752612, loss_ss: 0.813679, loss_d: 0.938933
0.8455 --- loss: 1.672615, loss_ss: 1.033609, loss_d: 0.639005
0.8839 --- loss: 1.719531, loss_ss: 1.175146, loss_d: 0.544386
0.9224 --- loss: 1.797999, loss_ss: 0.912574, loss_d: 0.885425
0.9608 --- loss: 1.417055, loss_ss: 1.043052, loss_d: 0.374003
0.9992 --- loss: 1.634410, loss_ss: 1.394686, loss_d: 0.239724
Epoch finished! Loss: 1.5790312024263236
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.592802, loss_ss: 0.875428, loss_d: 0.717373
0.0384 --- loss: 1.182256, loss_ss: 0.876044, loss_d: 0.306212
0.0769 --- loss: 1.204635, loss_ss: 0.921682, loss_d: 0.282953
0.1153 --- loss: 1.172372, loss_ss: 0.881534, loss_d: 0.290837
0.1537 --- loss: 1.865356, loss_ss: 0.971222, loss_d: 0.894134
0.1922 --- loss: 1.344172, loss_ss: 0.855747, loss_d: 0.488425
0.2306 --- loss: 1.358915, loss_ss: 0.907834, loss_d: 0.451081
0.2690 --- loss: 1.682266, loss_ss: 0.905088, loss_d: 0.777179
0.3075 --- loss: 1.338405, loss_ss: 0.997659, loss_d: 0.340746
0.3459 --- loss: 1.880942, loss_ss: 1.176192, loss_d: 0.704750
0.3843 --- loss: 1.487096, loss_ss: 0.894053, loss_d: 0.593043
0.4228 --- loss: 1.476677, loss_ss: 0.813453, loss_d: 0.663224
0.4612 --- loss: 1.713401, loss_ss: 1.206804, loss_d: 0.506598
0.4996 --- loss: 1.630330, loss_ss: 1.184244, loss_d: 0.446086
0.5380 --- loss: 1.250287, loss_ss: 0.964381, loss_d: 0.285906
0.5765 --- loss: 1.233616, loss_ss: 0.786164, loss_d: 0.447452
0.6149 --- loss: 1.682976, loss_ss: 0.951469, loss_d: 0.731507
0.6533 --- loss: 1.158122, loss_ss: 0.764359, loss_d: 0.393763
0.6918 --- loss: 1.206394, loss_ss: 0.787105, loss_d: 0.419289
0.7302 --- loss: 1.127886, loss_ss: 0.850930, loss_d: 0.276955
0.7686 --- loss: 1.777671, loss_ss: 0.896559, loss_d: 0.881112
0.8071 --- loss: 1.866380, loss_ss: 1.212517, loss_d: 0.653863
0.8455 --- loss: 0.997246, loss_ss: 0.691082, loss_d: 0.306164
0.8839 --- loss: 1.013329, loss_ss: 0.805785, loss_d: 0.207544
0.9224 --- loss: 1.116564, loss_ss: 0.880780, loss_d: 0.235784
0.9608 --- loss: 1.181351, loss_ss: 0.746398, loss_d: 0.434953
0.9992 --- loss: 2.418198, loss_ss: 2.216943, loss_d: 0.201255
Epoch finished! Loss: 1.4554928841499182
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.423186, loss_ss: 0.743699, loss_d: 0.679487
0.0384 --- loss: 1.497537, loss_ss: 0.850180, loss_d: 0.647357
0.0769 --- loss: 1.154184, loss_ss: 0.941337, loss_d: 0.212847
0.1153 --- loss: 1.453962, loss_ss: 1.055616, loss_d: 0.398346
0.1537 --- loss: 1.459320, loss_ss: 1.130908, loss_d: 0.328411
0.1922 --- loss: 1.151778, loss_ss: 0.706176, loss_d: 0.445603
0.2306 --- loss: 1.597042, loss_ss: 0.890920, loss_d: 0.706123
0.2690 --- loss: 1.717677, loss_ss: 1.405384, loss_d: 0.312293
0.3075 --- loss: 1.196776, loss_ss: 0.951720, loss_d: 0.245057
0.3459 --- loss: 1.264606, loss_ss: 0.812136, loss_d: 0.452470
0.3843 --- loss: 1.212578, loss_ss: 0.962234, loss_d: 0.250345
0.4228 --- loss: 1.413968, loss_ss: 0.946694, loss_d: 0.467274
0.4612 --- loss: 1.569493, loss_ss: 1.092480, loss_d: 0.477013
0.4996 --- loss: 1.136930, loss_ss: 0.585740, loss_d: 0.551189
0.5380 --- loss: 1.196481, loss_ss: 0.851959, loss_d: 0.344522
0.5765 --- loss: 1.318659, loss_ss: 1.053638, loss_d: 0.265021
0.6149 --- loss: 1.179556, loss_ss: 0.934861, loss_d: 0.244694
0.6533 --- loss: 1.144920, loss_ss: 0.889163, loss_d: 0.255757
0.6918 --- loss: 1.467517, loss_ss: 0.806821, loss_d: 0.660696
0.7302 --- loss: 1.223993, loss_ss: 0.849344, loss_d: 0.374649
0.7686 --- loss: 1.050192, loss_ss: 0.820235, loss_d: 0.229957
0.8071 --- loss: 1.260986, loss_ss: 0.919764, loss_d: 0.341222
0.8455 --- loss: 1.205858, loss_ss: 0.966270, loss_d: 0.239587
0.8839 --- loss: 1.337028, loss_ss: 0.880308, loss_d: 0.456721
0.9224 --- loss: 0.888606, loss_ss: 0.603445, loss_d: 0.285162
0.9608 --- loss: 1.061224, loss_ss: 0.738172, loss_d: 0.323052
0.9992 --- loss: 1.433983, loss_ss: 1.191142, loss_d: 0.242841
Epoch finished! Loss: 1.3815193889232782
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.529327, loss_ss: 1.140925, loss_d: 0.388402
0.0384 --- loss: 1.282983, loss_ss: 0.886567, loss_d: 0.396416
0.0769 --- loss: 1.661464, loss_ss: 1.121386, loss_d: 0.540078
0.1153 --- loss: 1.197722, loss_ss: 0.679875, loss_d: 0.517847
0.1537 --- loss: 1.747458, loss_ss: 1.137930, loss_d: 0.609528
0.1922 --- loss: 1.307232, loss_ss: 1.089739, loss_d: 0.217494
0.2306 --- loss: 1.554950, loss_ss: 1.046609, loss_d: 0.508341
0.2690 --- loss: 1.026002, loss_ss: 0.707013, loss_d: 0.318989
0.3075 --- loss: 1.797554, loss_ss: 1.083147, loss_d: 0.714407
0.3459 --- loss: 1.227816, loss_ss: 0.874142, loss_d: 0.353674
0.3843 --- loss: 1.322088, loss_ss: 0.753871, loss_d: 0.568218
0.4228 --- loss: 2.009607, loss_ss: 1.460941, loss_d: 0.548666
0.4612 --- loss: 1.793099, loss_ss: 1.176049, loss_d: 0.617050
0.4996 --- loss: 1.077433, loss_ss: 0.775959, loss_d: 0.301474
0.5380 --- loss: 1.140014, loss_ss: 0.637682, loss_d: 0.502332
0.5765 --- loss: 1.400381, loss_ss: 0.738921, loss_d: 0.661460
0.6149 --- loss: 1.147523, loss_ss: 0.754151, loss_d: 0.393373
0.6533 --- loss: 1.231515, loss_ss: 0.911090, loss_d: 0.320426
0.6918 --- loss: 1.769158, loss_ss: 1.271406, loss_d: 0.497751
0.7302 --- loss: 1.296883, loss_ss: 0.918899, loss_d: 0.377984
0.7686 --- loss: 1.277968, loss_ss: 0.852588, loss_d: 0.425380
0.8071 --- loss: 1.360804, loss_ss: 1.120291, loss_d: 0.240512
0.8455 --- loss: 1.561006, loss_ss: 0.888033, loss_d: 0.672973
0.8839 --- loss: 1.347470, loss_ss: 0.995674, loss_d: 0.351796
0.9224 --- loss: 0.983649, loss_ss: 0.616309, loss_d: 0.367340
0.9608 --- loss: 0.986664, loss_ss: 0.779678, loss_d: 0.206986
0.9992 --- loss: 1.236100, loss_ss: 0.751000, loss_d: 0.485100
Epoch finished! Loss: 1.3339084409750426
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.822732, loss_ss: 1.006536, loss_d: 0.816196
0.0384 --- loss: 1.191803, loss_ss: 0.794796, loss_d: 0.397007
0.0769 --- loss: 1.135910, loss_ss: 0.865016, loss_d: 0.270894
0.1153 --- loss: 1.416293, loss_ss: 1.101993, loss_d: 0.314300
0.1537 --- loss: 1.290098, loss_ss: 0.942515, loss_d: 0.347583
0.1922 --- loss: 1.058968, loss_ss: 0.890572, loss_d: 0.168397
0.2306 --- loss: 1.205805, loss_ss: 1.052607, loss_d: 0.153198
0.2690 --- loss: 1.709024, loss_ss: 0.974699, loss_d: 0.734325
0.3075 --- loss: 1.464781, loss_ss: 1.083091, loss_d: 0.381690
0.3459 --- loss: 1.024367, loss_ss: 0.833134, loss_d: 0.191234
0.3843 --- loss: 1.539548, loss_ss: 1.124066, loss_d: 0.415482
0.4228 --- loss: 0.928300, loss_ss: 0.672182, loss_d: 0.256118
0.4612 --- loss: 1.427418, loss_ss: 0.694017, loss_d: 0.733401
0.4996 --- loss: 1.102500, loss_ss: 0.840453, loss_d: 0.262047
0.5380 --- loss: 1.224699, loss_ss: 0.749363, loss_d: 0.475336
0.5765 --- loss: 1.334791, loss_ss: 1.061066, loss_d: 0.273725
0.6149 --- loss: 1.139886, loss_ss: 0.877025, loss_d: 0.262861
0.6533 --- loss: 1.230355, loss_ss: 0.875042, loss_d: 0.355313
0.6918 --- loss: 1.312165, loss_ss: 1.002600, loss_d: 0.309566
0.7302 --- loss: 1.334525, loss_ss: 1.048824, loss_d: 0.285701
0.7686 --- loss: 1.187016, loss_ss: 0.769975, loss_d: 0.417041
0.8071 --- loss: 1.386803, loss_ss: 0.679587, loss_d: 0.707216
0.8455 --- loss: 1.288184, loss_ss: 0.974323, loss_d: 0.313861
0.8839 --- loss: 1.623770, loss_ss: 1.113046, loss_d: 0.510724
0.9224 --- loss: 1.528853, loss_ss: 1.063209, loss_d: 0.465644
0.9608 --- loss: 1.241972, loss_ss: 0.644314, loss_d: 0.597658
0.9992 --- loss: 1.879245, loss_ss: 1.563892, loss_d: 0.315353
Epoch finished! Loss: 1.2967332090322787
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.166911, loss_ss: 0.736561, loss_d: 0.430351
0.0384 --- loss: 1.622726, loss_ss: 1.134040, loss_d: 0.488685
0.0769 --- loss: 1.414093, loss_ss: 0.874264, loss_d: 0.539830
0.1153 --- loss: 1.242198, loss_ss: 0.740256, loss_d: 0.501941
0.1537 --- loss: 1.057000, loss_ss: 0.867523, loss_d: 0.189477
0.1922 --- loss: 0.719370, loss_ss: 0.550789, loss_d: 0.168580
0.2306 --- loss: 1.011935, loss_ss: 0.727605, loss_d: 0.284330
0.2690 --- loss: 0.867728, loss_ss: 0.641750, loss_d: 0.225978
0.3075 --- loss: 0.993347, loss_ss: 0.699003, loss_d: 0.294344
0.3459 --- loss: 1.152408, loss_ss: 0.950807, loss_d: 0.201602
0.3843 --- loss: 1.360175, loss_ss: 0.813031, loss_d: 0.547144
0.4228 --- loss: 1.079830, loss_ss: 0.856760, loss_d: 0.223070
0.4612 --- loss: 1.024288, loss_ss: 0.659218, loss_d: 0.365070
0.4996 --- loss: 1.251744, loss_ss: 0.749757, loss_d: 0.501987
0.5380 --- loss: 1.441650, loss_ss: 1.229065, loss_d: 0.212584
0.5765 --- loss: 1.046781, loss_ss: 0.723876, loss_d: 0.322905
0.6149 --- loss: 0.762437, loss_ss: 0.545203, loss_d: 0.217234
0.6533 --- loss: 1.392609, loss_ss: 0.919420, loss_d: 0.473189
0.6918 --- loss: 1.530807, loss_ss: 1.051882, loss_d: 0.478926
0.7302 --- loss: 1.277539, loss_ss: 0.850795, loss_d: 0.426744
0.7686 --- loss: 0.929879, loss_ss: 0.761240, loss_d: 0.168638
0.8071 --- loss: 1.329654, loss_ss: 1.036070, loss_d: 0.293584
0.8455 --- loss: 1.637707, loss_ss: 0.878393, loss_d: 0.759314
0.8839 --- loss: 1.119929, loss_ss: 0.636853, loss_d: 0.483075
0.9224 --- loss: 1.305366, loss_ss: 0.733164, loss_d: 0.572202
0.9608 --- loss: 1.471833, loss_ss: 0.998566, loss_d: 0.473267
0.9992 --- loss: 4.231991, loss_ss: 1.115873, loss_d: 3.116118
Epoch finished! Loss: 1.2706289660472136
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.617621, loss_ss: 1.078491, loss_d: 0.539130
0.0384 --- loss: 1.054129, loss_ss: 0.787805, loss_d: 0.266323
0.0769 --- loss: 0.978935, loss_ss: 0.708080, loss_d: 0.270854
0.1153 --- loss: 1.152426, loss_ss: 0.942028, loss_d: 0.210398
0.1537 --- loss: 1.083686, loss_ss: 0.834189, loss_d: 0.249497
0.1922 --- loss: 1.210426, loss_ss: 0.807361, loss_d: 0.403065
0.2306 --- loss: 2.130339, loss_ss: 1.061588, loss_d: 1.068752
0.2690 --- loss: 1.650667, loss_ss: 1.137835, loss_d: 0.512832
0.3075 --- loss: 1.369373, loss_ss: 0.911256, loss_d: 0.458117
0.3459 --- loss: 1.302099, loss_ss: 0.970629, loss_d: 0.331469
0.3843 --- loss: 0.950819, loss_ss: 0.677283, loss_d: 0.273536
0.4228 --- loss: 1.078838, loss_ss: 0.842498, loss_d: 0.236340
0.4612 --- loss: 1.092422, loss_ss: 0.923411, loss_d: 0.169012
0.4996 --- loss: 1.233301, loss_ss: 0.912903, loss_d: 0.320398
0.5380 --- loss: 1.405201, loss_ss: 1.202173, loss_d: 0.203028
0.5765 --- loss: 1.204625, loss_ss: 0.921378, loss_d: 0.283247
0.6149 --- loss: 0.921715, loss_ss: 0.821777, loss_d: 0.099938
0.6533 --- loss: 1.243456, loss_ss: 0.926544, loss_d: 0.316911
0.6918 --- loss: 1.294347, loss_ss: 0.673255, loss_d: 0.621092
0.7302 --- loss: 1.104798, loss_ss: 0.933497, loss_d: 0.171302
0.7686 --- loss: 1.134242, loss_ss: 0.780516, loss_d: 0.353726
0.8071 --- loss: 1.287079, loss_ss: 0.819870, loss_d: 0.467209
0.8455 --- loss: 0.938863, loss_ss: 0.775352, loss_d: 0.163511
0.8839 --- loss: 1.655986, loss_ss: 0.807891, loss_d: 0.848096
0.9224 --- loss: 1.242955, loss_ss: 0.873979, loss_d: 0.368976
0.9608 --- loss: 1.205878, loss_ss: 0.725651, loss_d: 0.480227
0.9992 --- loss: 1.455281, loss_ss: 1.024977, loss_d: 0.430304
Epoch finished! Loss: 1.21876240670681
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.966716, loss_ss: 0.631571, loss_d: 0.335145
0.0384 --- loss: 1.153540, loss_ss: 0.871121, loss_d: 0.282419
0.0769 --- loss: 1.450222, loss_ss: 1.129984, loss_d: 0.320239
0.1153 --- loss: 1.421237, loss_ss: 0.712695, loss_d: 0.708542
0.1537 --- loss: 0.876614, loss_ss: 0.687509, loss_d: 0.189106
0.1922 --- loss: 1.493229, loss_ss: 0.992063, loss_d: 0.501166
0.2306 --- loss: 1.431794, loss_ss: 1.139910, loss_d: 0.291885
0.2690 --- loss: 1.122237, loss_ss: 0.905130, loss_d: 0.217107
0.3075 --- loss: 1.675184, loss_ss: 1.225510, loss_d: 0.449674
0.3459 --- loss: 1.238267, loss_ss: 0.807683, loss_d: 0.430584
0.3843 --- loss: 1.528829, loss_ss: 0.948821, loss_d: 0.580008
0.4228 --- loss: 1.444104, loss_ss: 1.075523, loss_d: 0.368581
0.4612 --- loss: 1.210335, loss_ss: 0.822088, loss_d: 0.388247
0.4996 --- loss: 1.346734, loss_ss: 1.097688, loss_d: 0.249046
0.5380 --- loss: 1.116475, loss_ss: 0.886091, loss_d: 0.230384
0.5765 --- loss: 1.392419, loss_ss: 0.783552, loss_d: 0.608867
0.6149 --- loss: 1.044940, loss_ss: 0.781700, loss_d: 0.263240
0.6533 --- loss: 0.982039, loss_ss: 0.859808, loss_d: 0.122230
0.6918 --- loss: 1.045642, loss_ss: 0.911644, loss_d: 0.133998
0.7302 --- loss: 0.961730, loss_ss: 0.797371, loss_d: 0.164359
0.7686 --- loss: 0.736731, loss_ss: 0.586044, loss_d: 0.150687
0.8071 --- loss: 0.978474, loss_ss: 0.792694, loss_d: 0.185780
0.8455 --- loss: 1.130112, loss_ss: 0.706138, loss_d: 0.423974
0.8839 --- loss: 0.992508, loss_ss: 0.719243, loss_d: 0.273265
0.9224 --- loss: 0.929809, loss_ss: 0.834752, loss_d: 0.095057
0.9608 --- loss: 1.246105, loss_ss: 0.752219, loss_d: 0.493886
0.9992 --- loss: 1.002161, loss_ss: 0.916313, loss_d: 0.085849
Epoch finished! Loss: 1.1681422171684412
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4425925925925926
             precision    recall  f1-score   support

        0.0       0.58      0.84      0.68       226
        1.0       0.47      0.41      0.44       357
        2.0       0.27      0.40      0.32       192
        3.0       0.01      0.50      0.02         2
        4.0       0.86      0.22      0.35       303

avg / total       0.57      0.44      0.44      1080
 


====== chp046-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  83.70  83.63   83.72  57.62     68.23
1  65.46  40.90   77.59  47.40     43.91
2  70.09  39.58   76.69  26.86     32.00
3  92.22  50.00   92.30   1.19      2.33
4  77.04  21.78   98.58  85.71     34.74
Total accuracy: 44.26%
Average sen: 47.18%
Average spec: 85.78%
Macro f1-score: 36.24%
Diagnosis acc on 15mins: 1.0
[0.98241836 0.98109519 0.99690801 0.99803442 0.99758005 0.99974817
 0.95942843 0.98696923 0.99985445 0.95021248 0.9539575  0.9996208
 0.99978667 0.99635077 0.99834132 0.99883515 0.99984598 0.99984622
 0.97712255 0.99500883 0.977422   0.99963236 0.99976593 0.99985099
 0.99993861 0.99991953 0.99988949 0.99939668 0.99993277 0.99937361
 0.99935573 0.99941182 0.99994731 0.99989116 0.99938631 0.9997322 ]
pred: 0.9928836408588622, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp047-nsrr. train_data(2609), test_data(29) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.536170, loss_ss: 1.794202, loss_d: 0.741968
0.0383 --- loss: 1.877216, loss_ss: 1.528805, loss_d: 0.348411
0.0767 --- loss: 2.140489, loss_ss: 1.466057, loss_d: 0.674432
0.1150 --- loss: 2.213372, loss_ss: 1.590135, loss_d: 0.623237
0.1533 --- loss: 2.119485, loss_ss: 1.508659, loss_d: 0.610826
0.1916 --- loss: 1.656476, loss_ss: 1.432647, loss_d: 0.223828
0.2300 --- loss: 2.026343, loss_ss: 1.533895, loss_d: 0.492448
0.2683 --- loss: 2.136481, loss_ss: 1.484438, loss_d: 0.652043
0.3066 --- loss: 2.209991, loss_ss: 1.381761, loss_d: 0.828230
0.3450 --- loss: 1.825652, loss_ss: 1.400322, loss_d: 0.425330
0.3833 --- loss: 2.023536, loss_ss: 1.393970, loss_d: 0.629567
0.4216 --- loss: 2.012036, loss_ss: 1.487402, loss_d: 0.524634
0.4599 --- loss: 1.914380, loss_ss: 1.287374, loss_d: 0.627006
0.4983 --- loss: 2.012442, loss_ss: 1.312819, loss_d: 0.699623
0.5366 --- loss: 2.049700, loss_ss: 1.365904, loss_d: 0.683797
0.5749 --- loss: 2.300835, loss_ss: 1.455200, loss_d: 0.845634
0.6133 --- loss: 1.745603, loss_ss: 1.366532, loss_d: 0.379070
0.6516 --- loss: 1.701031, loss_ss: 1.261227, loss_d: 0.439805
0.6899 --- loss: 2.017198, loss_ss: 1.346204, loss_d: 0.670994
0.7282 --- loss: 2.094997, loss_ss: 1.259257, loss_d: 0.835740
0.7666 --- loss: 1.502399, loss_ss: 1.174399, loss_d: 0.328000
0.8049 --- loss: 2.014467, loss_ss: 1.185382, loss_d: 0.829085
0.8432 --- loss: 2.086423, loss_ss: 1.178826, loss_d: 0.907597
0.8816 --- loss: 1.952427, loss_ss: 1.347050, loss_d: 0.605376
0.9199 --- loss: 1.796579, loss_ss: 1.132593, loss_d: 0.663986
0.9582 --- loss: 1.914882, loss_ss: 1.304890, loss_d: 0.609991
0.9966 --- loss: 1.763532, loss_ss: 1.242547, loss_d: 0.520985
Epoch finished! Loss: 2.000774597663146
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.613748, loss_ss: 1.201834, loss_d: 0.411914
0.0383 --- loss: 1.503674, loss_ss: 1.087288, loss_d: 0.416386
0.0767 --- loss: 1.783284, loss_ss: 1.240823, loss_d: 0.542461
0.1150 --- loss: 1.667063, loss_ss: 1.181093, loss_d: 0.485970
0.1533 --- loss: 1.517217, loss_ss: 1.198554, loss_d: 0.318663
0.1916 --- loss: 1.790087, loss_ss: 1.258928, loss_d: 0.531159
0.2300 --- loss: 1.687415, loss_ss: 1.263908, loss_d: 0.423507
0.2683 --- loss: 1.575203, loss_ss: 1.175297, loss_d: 0.399906
0.3066 --- loss: 1.881734, loss_ss: 1.380458, loss_d: 0.501275
0.3450 --- loss: 1.735512, loss_ss: 1.217350, loss_d: 0.518162
0.3833 --- loss: 1.719122, loss_ss: 1.268995, loss_d: 0.450128
0.4216 --- loss: 1.502930, loss_ss: 1.147954, loss_d: 0.354975
0.4599 --- loss: 1.699405, loss_ss: 1.262990, loss_d: 0.436415
0.4983 --- loss: 2.060737, loss_ss: 1.433484, loss_d: 0.627253
0.5366 --- loss: 1.517773, loss_ss: 1.000235, loss_d: 0.517539
0.5749 --- loss: 1.399410, loss_ss: 0.894672, loss_d: 0.504739
0.6133 --- loss: 2.203042, loss_ss: 1.220465, loss_d: 0.982577
0.6516 --- loss: 1.833915, loss_ss: 1.227380, loss_d: 0.606535
0.6899 --- loss: 1.622016, loss_ss: 0.957435, loss_d: 0.664581
0.7282 --- loss: 1.703684, loss_ss: 1.332252, loss_d: 0.371432
0.7666 --- loss: 1.960518, loss_ss: 1.068812, loss_d: 0.891706
0.8049 --- loss: 1.543185, loss_ss: 0.959831, loss_d: 0.583354
0.8432 --- loss: 1.613687, loss_ss: 0.921825, loss_d: 0.691862
0.8816 --- loss: 1.720011, loss_ss: 1.189534, loss_d: 0.530478
0.9199 --- loss: 1.565532, loss_ss: 0.934660, loss_d: 0.630871
0.9582 --- loss: 1.400426, loss_ss: 0.990462, loss_d: 0.409964
0.9966 --- loss: 1.590498, loss_ss: 1.051217, loss_d: 0.539281
Epoch finished! Loss: 1.7172633322385642
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.344830, loss_ss: 0.837050, loss_d: 0.507779
0.0383 --- loss: 1.538329, loss_ss: 1.026734, loss_d: 0.511595
0.0767 --- loss: 1.552469, loss_ss: 0.791052, loss_d: 0.761417
0.1150 --- loss: 1.625251, loss_ss: 0.990623, loss_d: 0.634628
0.1533 --- loss: 1.359515, loss_ss: 0.881688, loss_d: 0.477828
0.1916 --- loss: 1.604824, loss_ss: 1.116682, loss_d: 0.488142
0.2300 --- loss: 2.003924, loss_ss: 1.068006, loss_d: 0.935917
0.2683 --- loss: 1.459502, loss_ss: 0.999755, loss_d: 0.459747
0.3066 --- loss: 1.327419, loss_ss: 0.822429, loss_d: 0.504990
0.3450 --- loss: 1.574256, loss_ss: 0.945472, loss_d: 0.628784
0.3833 --- loss: 1.845384, loss_ss: 1.327367, loss_d: 0.518017
0.4216 --- loss: 1.402269, loss_ss: 0.893915, loss_d: 0.508354
0.4599 --- loss: 1.265803, loss_ss: 0.852363, loss_d: 0.413440
0.4983 --- loss: 1.769201, loss_ss: 1.186614, loss_d: 0.582587
0.5366 --- loss: 1.495038, loss_ss: 0.820642, loss_d: 0.674396
0.5749 --- loss: 2.029093, loss_ss: 1.228487, loss_d: 0.800606
0.6133 --- loss: 1.502778, loss_ss: 1.013012, loss_d: 0.489766
0.6516 --- loss: 1.321762, loss_ss: 0.921159, loss_d: 0.400602
0.6899 --- loss: 1.408639, loss_ss: 0.899447, loss_d: 0.509193
0.7282 --- loss: 2.242632, loss_ss: 1.332202, loss_d: 0.910429
0.7666 --- loss: 1.471705, loss_ss: 0.853619, loss_d: 0.618086
0.8049 --- loss: 1.433885, loss_ss: 0.809089, loss_d: 0.624797
0.8432 --- loss: 1.671986, loss_ss: 0.751339, loss_d: 0.920646
0.8816 --- loss: 1.541019, loss_ss: 0.895842, loss_d: 0.645177
0.9199 --- loss: 1.520146, loss_ss: 0.962055, loss_d: 0.558091
0.9582 --- loss: 1.496276, loss_ss: 0.887814, loss_d: 0.608462
0.9966 --- loss: 1.324540, loss_ss: 0.751793, loss_d: 0.572747
Epoch finished! Loss: 1.5999604197648856
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.376974, loss_ss: 0.846658, loss_d: 0.530316
0.0383 --- loss: 1.326011, loss_ss: 0.872784, loss_d: 0.453227
0.0767 --- loss: 1.920102, loss_ss: 1.387912, loss_d: 0.532190
0.1150 --- loss: 1.392001, loss_ss: 0.860468, loss_d: 0.531533
0.1533 --- loss: 1.776944, loss_ss: 1.276561, loss_d: 0.500383
0.1916 --- loss: 1.446837, loss_ss: 0.746061, loss_d: 0.700776
0.2300 --- loss: 1.384507, loss_ss: 0.887115, loss_d: 0.497392
0.2683 --- loss: 1.844791, loss_ss: 1.175322, loss_d: 0.669470
0.3066 --- loss: 1.358602, loss_ss: 0.936958, loss_d: 0.421644
0.3450 --- loss: 1.750638, loss_ss: 1.149421, loss_d: 0.601218
0.3833 --- loss: 1.230518, loss_ss: 0.715364, loss_d: 0.515154
0.4216 --- loss: 1.252280, loss_ss: 0.815117, loss_d: 0.437163
0.4599 --- loss: 1.964516, loss_ss: 1.298460, loss_d: 0.666056
0.4983 --- loss: 1.305555, loss_ss: 0.784827, loss_d: 0.520728
0.5366 --- loss: 1.418867, loss_ss: 0.945101, loss_d: 0.473766
0.5749 --- loss: 1.611577, loss_ss: 1.103097, loss_d: 0.508480
0.6133 --- loss: 1.539177, loss_ss: 0.740090, loss_d: 0.799087
0.6516 --- loss: 1.355817, loss_ss: 0.907925, loss_d: 0.447892
0.6899 --- loss: 1.735724, loss_ss: 0.951083, loss_d: 0.784641
0.7282 --- loss: 1.668327, loss_ss: 0.947995, loss_d: 0.720331
0.7666 --- loss: 1.323883, loss_ss: 0.688837, loss_d: 0.635046
0.8049 --- loss: 1.932695, loss_ss: 1.465245, loss_d: 0.467450
0.8432 --- loss: 1.360984, loss_ss: 0.854046, loss_d: 0.506938
0.8816 --- loss: 1.405965, loss_ss: 0.808890, loss_d: 0.597076
0.9199 --- loss: 1.876645, loss_ss: 1.083530, loss_d: 0.793115
0.9582 --- loss: 2.167795, loss_ss: 1.719111, loss_d: 0.448684
0.9966 --- loss: 1.285505, loss_ss: 0.666492, loss_d: 0.619013
Epoch finished! Loss: 1.5616834677182712
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.292131, loss_ss: 0.800354, loss_d: 0.491777
0.0383 --- loss: 1.247661, loss_ss: 0.875694, loss_d: 0.371967
0.0767 --- loss: 1.648664, loss_ss: 1.073972, loss_d: 0.574692
0.1150 --- loss: 1.673157, loss_ss: 0.993706, loss_d: 0.679451
0.1533 --- loss: 1.596901, loss_ss: 0.920320, loss_d: 0.676580
0.1916 --- loss: 1.333431, loss_ss: 0.904054, loss_d: 0.429377
0.2300 --- loss: 1.285728, loss_ss: 0.790946, loss_d: 0.494782
0.2683 --- loss: 1.274503, loss_ss: 0.841605, loss_d: 0.432897
0.3066 --- loss: 1.384138, loss_ss: 0.993502, loss_d: 0.390635
0.3450 --- loss: 1.039439, loss_ss: 0.646902, loss_d: 0.392537
0.3833 --- loss: 1.455540, loss_ss: 0.791762, loss_d: 0.663778
0.4216 --- loss: 1.590099, loss_ss: 1.217568, loss_d: 0.372531
0.4599 --- loss: 1.226123, loss_ss: 0.972552, loss_d: 0.253571
0.4983 --- loss: 1.284172, loss_ss: 0.899227, loss_d: 0.384945
0.5366 --- loss: 1.610877, loss_ss: 0.911497, loss_d: 0.699380
0.5749 --- loss: 1.089289, loss_ss: 0.765795, loss_d: 0.323494
0.6133 --- loss: 1.111582, loss_ss: 0.811830, loss_d: 0.299751
0.6516 --- loss: 1.550826, loss_ss: 0.993819, loss_d: 0.557007
0.6899 --- loss: 1.705959, loss_ss: 0.722400, loss_d: 0.983559
0.7282 --- loss: 1.828611, loss_ss: 1.196256, loss_d: 0.632356
0.7666 --- loss: 1.413597, loss_ss: 0.969299, loss_d: 0.444298
0.8049 --- loss: 1.079528, loss_ss: 0.734152, loss_d: 0.345376
0.8432 --- loss: 1.730402, loss_ss: 1.209541, loss_d: 0.520861
0.8816 --- loss: 1.477582, loss_ss: 0.868102, loss_d: 0.609480
0.9199 --- loss: 1.602716, loss_ss: 1.083732, loss_d: 0.518985
0.9582 --- loss: 1.270368, loss_ss: 0.908575, loss_d: 0.361792
0.9966 --- loss: 1.514689, loss_ss: 1.034806, loss_d: 0.479883
Epoch finished! Loss: 1.4721796998610863
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.382846, loss_ss: 1.116215, loss_d: 0.266631
0.0383 --- loss: 1.341528, loss_ss: 0.696692, loss_d: 0.644836
0.0767 --- loss: 1.456698, loss_ss: 1.274484, loss_d: 0.182214
0.1150 --- loss: 2.177038, loss_ss: 1.106259, loss_d: 1.070779
0.1533 --- loss: 1.572053, loss_ss: 0.890553, loss_d: 0.681500
0.1916 --- loss: 1.159289, loss_ss: 0.913109, loss_d: 0.246180
0.2300 --- loss: 1.732813, loss_ss: 1.022758, loss_d: 0.710055
0.2683 --- loss: 1.371266, loss_ss: 0.825121, loss_d: 0.546145
0.3066 --- loss: 1.091252, loss_ss: 0.747868, loss_d: 0.343384
0.3450 --- loss: 1.299537, loss_ss: 1.004909, loss_d: 0.294628
0.3833 --- loss: 1.798777, loss_ss: 0.853599, loss_d: 0.945177
0.4216 --- loss: 1.504588, loss_ss: 1.228408, loss_d: 0.276179
0.4599 --- loss: 1.338152, loss_ss: 1.004652, loss_d: 0.333500
0.4983 --- loss: 1.650654, loss_ss: 1.388355, loss_d: 0.262299
0.5366 --- loss: 1.683012, loss_ss: 0.961600, loss_d: 0.721411
0.5749 --- loss: 1.591798, loss_ss: 0.961059, loss_d: 0.630739
0.6133 --- loss: 1.189654, loss_ss: 0.867716, loss_d: 0.321937
0.6516 --- loss: 1.489305, loss_ss: 0.987942, loss_d: 0.501363
0.6899 --- loss: 1.786489, loss_ss: 1.342500, loss_d: 0.443989
0.7282 --- loss: 1.792588, loss_ss: 1.169004, loss_d: 0.623583
0.7666 --- loss: 1.722462, loss_ss: 1.069005, loss_d: 0.653457
0.8049 --- loss: 1.847081, loss_ss: 1.043304, loss_d: 0.803777
0.8432 --- loss: 1.790797, loss_ss: 1.308701, loss_d: 0.482096
0.8816 --- loss: 1.233698, loss_ss: 0.802971, loss_d: 0.430727
0.9199 --- loss: 1.359368, loss_ss: 0.778682, loss_d: 0.580686
0.9582 --- loss: 1.863081, loss_ss: 1.366885, loss_d: 0.496196
0.9966 --- loss: 1.316969, loss_ss: 0.909220, loss_d: 0.407750
Epoch finished! Loss: 1.4011479130158058
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.167730, loss_ss: 0.917203, loss_d: 0.250527
0.0383 --- loss: 1.496623, loss_ss: 1.131223, loss_d: 0.365400
0.0767 --- loss: 1.226696, loss_ss: 0.956583, loss_d: 0.270113
0.1150 --- loss: 1.109587, loss_ss: 0.667582, loss_d: 0.442005
0.1533 --- loss: 1.832991, loss_ss: 1.413593, loss_d: 0.419398
0.1916 --- loss: 1.835414, loss_ss: 1.282185, loss_d: 0.553229
0.2300 --- loss: 1.234828, loss_ss: 0.884080, loss_d: 0.350748
0.2683 --- loss: 1.235438, loss_ss: 0.922127, loss_d: 0.313311
0.3066 --- loss: 1.650791, loss_ss: 1.057714, loss_d: 0.593077
0.3450 --- loss: 1.510607, loss_ss: 0.876854, loss_d: 0.633753
0.3833 --- loss: 1.718389, loss_ss: 0.697013, loss_d: 1.021376
0.4216 --- loss: 1.582047, loss_ss: 0.875182, loss_d: 0.706865
0.4599 --- loss: 1.608566, loss_ss: 0.998340, loss_d: 0.610226
0.4983 --- loss: 1.267558, loss_ss: 0.835223, loss_d: 0.432335
0.5366 --- loss: 1.016283, loss_ss: 0.651481, loss_d: 0.364802
0.5749 --- loss: 1.512090, loss_ss: 0.812600, loss_d: 0.699489
0.6133 --- loss: 1.923428, loss_ss: 1.539713, loss_d: 0.383715
0.6516 --- loss: 1.242856, loss_ss: 0.708138, loss_d: 0.534718
0.6899 --- loss: 1.466470, loss_ss: 0.766039, loss_d: 0.700431
0.7282 --- loss: 1.109389, loss_ss: 0.695124, loss_d: 0.414265
0.7666 --- loss: 1.184779, loss_ss: 0.749540, loss_d: 0.435239
0.8049 --- loss: 0.901207, loss_ss: 0.714825, loss_d: 0.186383
0.8432 --- loss: 1.470448, loss_ss: 0.963749, loss_d: 0.506699
0.8816 --- loss: 1.531136, loss_ss: 1.007240, loss_d: 0.523897
0.9199 --- loss: 1.089993, loss_ss: 0.883725, loss_d: 0.206268
0.9582 --- loss: 1.158420, loss_ss: 0.692089, loss_d: 0.466331
0.9966 --- loss: 1.771006, loss_ss: 0.584168, loss_d: 1.186837
Epoch finished! Loss: 1.3174052080282799
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 2.140744, loss_ss: 0.965041, loss_d: 1.175702
0.0383 --- loss: 1.108021, loss_ss: 0.828021, loss_d: 0.280000
0.0767 --- loss: 0.980476, loss_ss: 0.504502, loss_d: 0.475974
0.1150 --- loss: 1.561483, loss_ss: 1.243168, loss_d: 0.318316
0.1533 --- loss: 1.118542, loss_ss: 0.862802, loss_d: 0.255740
0.1916 --- loss: 1.549560, loss_ss: 1.128965, loss_d: 0.420595
0.2300 --- loss: 1.529674, loss_ss: 0.788412, loss_d: 0.741262
0.2683 --- loss: 1.339930, loss_ss: 0.992053, loss_d: 0.347877
0.3066 --- loss: 1.542156, loss_ss: 1.217665, loss_d: 0.324491
0.3450 --- loss: 1.107151, loss_ss: 0.874434, loss_d: 0.232717
0.3833 --- loss: 0.980788, loss_ss: 0.751757, loss_d: 0.229030
0.4216 --- loss: 0.823374, loss_ss: 0.577847, loss_d: 0.245527
0.4599 --- loss: 1.456237, loss_ss: 0.836322, loss_d: 0.619915
0.4983 --- loss: 1.106261, loss_ss: 0.932609, loss_d: 0.173652
0.5366 --- loss: 1.171052, loss_ss: 0.694667, loss_d: 0.476385
0.5749 --- loss: 1.623488, loss_ss: 0.869088, loss_d: 0.754400
0.6133 --- loss: 1.137450, loss_ss: 0.757029, loss_d: 0.380420
0.6516 --- loss: 1.156221, loss_ss: 0.752015, loss_d: 0.404207
0.6899 --- loss: 1.409918, loss_ss: 1.092410, loss_d: 0.317508
0.7282 --- loss: 1.380249, loss_ss: 0.908221, loss_d: 0.472028
0.7666 --- loss: 1.232132, loss_ss: 1.030605, loss_d: 0.201528
0.8049 --- loss: 1.222439, loss_ss: 0.957722, loss_d: 0.264717
0.8432 --- loss: 0.941150, loss_ss: 0.722086, loss_d: 0.219064
0.8816 --- loss: 1.457453, loss_ss: 0.719646, loss_d: 0.737807
0.9199 --- loss: 1.567375, loss_ss: 1.315351, loss_d: 0.252024
0.9582 --- loss: 1.672638, loss_ss: 1.368995, loss_d: 0.303643
0.9966 --- loss: 0.996979, loss_ss: 0.740368, loss_d: 0.256611
Epoch finished! Loss: 1.2757759204277626
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.940949, loss_ss: 0.735197, loss_d: 0.205752
0.0383 --- loss: 1.405423, loss_ss: 0.977601, loss_d: 0.427823
0.0767 --- loss: 1.008677, loss_ss: 0.760202, loss_d: 0.248475
0.1150 --- loss: 1.013662, loss_ss: 0.767998, loss_d: 0.245664
0.1533 --- loss: 1.094756, loss_ss: 0.814082, loss_d: 0.280674
0.1916 --- loss: 1.131511, loss_ss: 0.692059, loss_d: 0.439452
0.2300 --- loss: 1.388116, loss_ss: 0.825153, loss_d: 0.562962
0.2683 --- loss: 0.989049, loss_ss: 0.860542, loss_d: 0.128507
0.3066 --- loss: 1.016254, loss_ss: 0.678537, loss_d: 0.337717
0.3450 --- loss: 1.339905, loss_ss: 1.086653, loss_d: 0.253252
0.3833 --- loss: 1.293557, loss_ss: 0.981040, loss_d: 0.312517
0.4216 --- loss: 1.030018, loss_ss: 0.689398, loss_d: 0.340620
0.4599 --- loss: 1.471331, loss_ss: 0.692701, loss_d: 0.778629
0.4983 --- loss: 1.514688, loss_ss: 0.852978, loss_d: 0.661710
0.5366 --- loss: 1.041017, loss_ss: 0.776212, loss_d: 0.264805
0.5749 --- loss: 1.287114, loss_ss: 0.862946, loss_d: 0.424168
0.6133 --- loss: 2.314423, loss_ss: 0.898239, loss_d: 1.416184
0.6516 --- loss: 1.492512, loss_ss: 0.958535, loss_d: 0.533977
0.6899 --- loss: 1.444546, loss_ss: 0.800606, loss_d: 0.643940
0.7282 --- loss: 1.544548, loss_ss: 0.745778, loss_d: 0.798770
0.7666 --- loss: 0.972207, loss_ss: 0.842835, loss_d: 0.129372
0.8049 --- loss: 0.886533, loss_ss: 0.711644, loss_d: 0.174889
0.8432 --- loss: 1.045849, loss_ss: 0.742303, loss_d: 0.303546
0.8816 --- loss: 1.460233, loss_ss: 1.199746, loss_d: 0.260488
0.9199 --- loss: 1.275577, loss_ss: 0.867960, loss_d: 0.407617
0.9582 --- loss: 1.168494, loss_ss: 0.810276, loss_d: 0.358218
0.9966 --- loss: 0.975012, loss_ss: 0.588107, loss_d: 0.386905
Epoch finished! Loss: 1.231198440377529
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.699745, loss_ss: 0.933937, loss_d: 0.765809
0.0383 --- loss: 1.115688, loss_ss: 0.929001, loss_d: 0.186687
0.0767 --- loss: 1.223678, loss_ss: 0.718925, loss_d: 0.504753
0.1150 --- loss: 0.993123, loss_ss: 0.690117, loss_d: 0.303006
0.1533 --- loss: 1.324065, loss_ss: 0.939791, loss_d: 0.384273
0.1916 --- loss: 1.534244, loss_ss: 1.182374, loss_d: 0.351871
0.2300 --- loss: 1.297149, loss_ss: 1.119139, loss_d: 0.178010
0.2683 --- loss: 1.392287, loss_ss: 1.018510, loss_d: 0.373777
0.3066 --- loss: 1.096114, loss_ss: 0.842581, loss_d: 0.253533
0.3450 --- loss: 1.501994, loss_ss: 0.783416, loss_d: 0.718578
0.3833 --- loss: 1.392298, loss_ss: 1.019591, loss_d: 0.372707
0.4216 --- loss: 1.142513, loss_ss: 0.722470, loss_d: 0.420043
0.4599 --- loss: 1.511618, loss_ss: 1.178642, loss_d: 0.332976
0.4983 --- loss: 0.966282, loss_ss: 0.603539, loss_d: 0.362743
0.5366 --- loss: 0.911744, loss_ss: 0.738927, loss_d: 0.172818
0.5749 --- loss: 1.388111, loss_ss: 1.056096, loss_d: 0.332016
0.6133 --- loss: 1.174093, loss_ss: 0.781143, loss_d: 0.392949
0.6516 --- loss: 1.161568, loss_ss: 0.742906, loss_d: 0.418662
0.6899 --- loss: 1.147619, loss_ss: 0.927049, loss_d: 0.220570
0.7282 --- loss: 1.205334, loss_ss: 0.823582, loss_d: 0.381751
0.7666 --- loss: 0.845877, loss_ss: 0.663767, loss_d: 0.182110
0.8049 --- loss: 1.439374, loss_ss: 1.014996, loss_d: 0.424378
0.8432 --- loss: 1.196136, loss_ss: 0.825374, loss_d: 0.370762
0.8816 --- loss: 1.183845, loss_ss: 0.873723, loss_d: 0.310123
0.9199 --- loss: 0.945107, loss_ss: 0.767211, loss_d: 0.177895
0.9582 --- loss: 1.249400, loss_ss: 1.008233, loss_d: 0.241167
0.9966 --- loss: 1.097131, loss_ss: 0.854547, loss_d: 0.242584
Epoch finished! Loss: 1.2145320931306252
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.4517241379310345
             precision    recall  f1-score   support

        0.0       0.51      0.58      0.54       291
        1.0       0.12      0.00      0.01       231
        2.0       0.51      0.77      0.61       233
        3.0       0.00      0.00      0.00        25
        4.0       0.26      0.47      0.33        90

avg / total       0.37      0.45      0.38       870
 


====== chp047-nsrr ======

The f1-score of  3  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  67.24  58.42   71.68  50.90     54.40
1  72.76   0.43   98.90  12.50      0.84
2  73.68  77.25   72.37  50.56     61.12
3  96.09   0.00   98.93   0.00      0.00
4  80.57  46.67   84.49  25.77     33.20
Total accuracy: 45.17%
Average sen: 36.55%
Average spec: 85.27%
Macro f1-score: 29.91%
Diagnosis acc on 15mins: 0.8620689655172413
[0.90336484 0.99686605 0.96088946 0.97791559 0.95862895 0.89402252
 0.96593404 0.88153338 0.93370622 0.96677029 0.94237322 0.97243327
 0.9637658  0.9434768  0.82992107 0.85751396 0.23705505 0.72163856
 0.83927029 0.94618678 0.96214098 0.96202171 0.98689795 0.37911823
 0.46454176 0.56660658 0.9288851  0.59318167 0.45099121]
pred: 0.8271603908004432, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp048-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.290622, loss_ss: 1.650086, loss_d: 0.640536
0.0384 --- loss: 2.061446, loss_ss: 1.443418, loss_d: 0.618028
0.0768 --- loss: 2.082917, loss_ss: 1.574447, loss_d: 0.508470
0.1152 --- loss: 2.005557, loss_ss: 1.429238, loss_d: 0.576319
0.1536 --- loss: 1.971920, loss_ss: 1.467414, loss_d: 0.504506
0.1920 --- loss: 2.027586, loss_ss: 1.317636, loss_d: 0.709949
0.2304 --- loss: 1.828300, loss_ss: 1.276167, loss_d: 0.552133
0.2688 --- loss: 2.241336, loss_ss: 1.357437, loss_d: 0.883899
0.3072 --- loss: 1.865738, loss_ss: 1.343845, loss_d: 0.521893
0.3456 --- loss: 2.051437, loss_ss: 1.394884, loss_d: 0.656554
0.3840 --- loss: 1.992892, loss_ss: 1.257188, loss_d: 0.735704
0.4224 --- loss: 1.939478, loss_ss: 1.201833, loss_d: 0.737646
0.4608 --- loss: 1.863219, loss_ss: 1.285710, loss_d: 0.577509
0.4992 --- loss: 1.904122, loss_ss: 1.327314, loss_d: 0.576807
0.5376 --- loss: 1.990992, loss_ss: 1.267058, loss_d: 0.723934
0.5760 --- loss: 1.990525, loss_ss: 1.193456, loss_d: 0.797069
0.6144 --- loss: 1.516905, loss_ss: 1.149400, loss_d: 0.367505
0.6528 --- loss: 2.156885, loss_ss: 1.249168, loss_d: 0.907717
0.6912 --- loss: 1.946060, loss_ss: 1.418214, loss_d: 0.527846
0.7296 --- loss: 2.024194, loss_ss: 1.404087, loss_d: 0.620107
0.7680 --- loss: 1.727001, loss_ss: 1.206499, loss_d: 0.520502
0.8065 --- loss: 1.727881, loss_ss: 1.149249, loss_d: 0.578632
0.8449 --- loss: 1.956640, loss_ss: 1.260962, loss_d: 0.695678
0.8833 --- loss: 1.898072, loss_ss: 1.165110, loss_d: 0.732962
0.9217 --- loss: 2.108364, loss_ss: 1.256782, loss_d: 0.851582
0.9601 --- loss: 1.687231, loss_ss: 1.126243, loss_d: 0.560988
0.9985 --- loss: 1.825702, loss_ss: 0.982377, loss_d: 0.843325
Epoch finished! Loss: 1.9004338709207682
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.523387, loss_ss: 1.138616, loss_d: 0.384771
0.0384 --- loss: 1.767961, loss_ss: 1.036798, loss_d: 0.731163
0.0768 --- loss: 1.980941, loss_ss: 1.522831, loss_d: 0.458110
0.1152 --- loss: 1.656980, loss_ss: 1.000133, loss_d: 0.656847
0.1536 --- loss: 1.845922, loss_ss: 1.253491, loss_d: 0.592431
0.1920 --- loss: 1.939522, loss_ss: 1.236966, loss_d: 0.702557
0.2304 --- loss: 1.543869, loss_ss: 1.173737, loss_d: 0.370132
0.2688 --- loss: 1.887682, loss_ss: 1.489752, loss_d: 0.397930
0.3072 --- loss: 1.835206, loss_ss: 1.193690, loss_d: 0.641516
0.3456 --- loss: 1.556334, loss_ss: 1.199688, loss_d: 0.356646
0.3840 --- loss: 1.624592, loss_ss: 1.084037, loss_d: 0.540555
0.4224 --- loss: 1.540684, loss_ss: 0.972377, loss_d: 0.568307
0.4608 --- loss: 1.696730, loss_ss: 1.123207, loss_d: 0.573524
0.4992 --- loss: 1.726726, loss_ss: 1.056098, loss_d: 0.670628
0.5376 --- loss: 1.507594, loss_ss: 1.007695, loss_d: 0.499899
0.5760 --- loss: 1.565435, loss_ss: 1.199706, loss_d: 0.365729
0.6144 --- loss: 1.802343, loss_ss: 1.065094, loss_d: 0.737249
0.6528 --- loss: 1.501238, loss_ss: 1.038244, loss_d: 0.462993
0.6912 --- loss: 1.343949, loss_ss: 0.842358, loss_d: 0.501591
0.7296 --- loss: 1.632728, loss_ss: 1.136572, loss_d: 0.496156
0.7680 --- loss: 1.409705, loss_ss: 0.842594, loss_d: 0.567111
0.8065 --- loss: 1.345086, loss_ss: 0.951630, loss_d: 0.393456
0.8449 --- loss: 1.629908, loss_ss: 0.950433, loss_d: 0.679474
0.8833 --- loss: 1.837920, loss_ss: 1.046953, loss_d: 0.790967
0.9217 --- loss: 1.497604, loss_ss: 0.878603, loss_d: 0.619002
0.9601 --- loss: 1.833258, loss_ss: 1.299144, loss_d: 0.534114
0.9985 --- loss: 2.095029, loss_ss: 1.246517, loss_d: 0.848512
Epoch finished! Loss: 1.6677836807874533
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.421693, loss_ss: 0.730174, loss_d: 0.691519
0.0384 --- loss: 1.548688, loss_ss: 1.048421, loss_d: 0.500267
0.0768 --- loss: 1.552557, loss_ss: 0.894307, loss_d: 0.658250
0.1152 --- loss: 2.011929, loss_ss: 1.182606, loss_d: 0.829323
0.1536 --- loss: 1.794928, loss_ss: 1.185944, loss_d: 0.608984
0.1920 --- loss: 1.857471, loss_ss: 1.254879, loss_d: 0.602592
0.2304 --- loss: 1.446572, loss_ss: 0.975066, loss_d: 0.471506
0.2688 --- loss: 1.738160, loss_ss: 1.235364, loss_d: 0.502795
0.3072 --- loss: 1.913297, loss_ss: 1.241522, loss_d: 0.671774
0.3456 --- loss: 1.484826, loss_ss: 1.005373, loss_d: 0.479453
0.3840 --- loss: 1.663393, loss_ss: 0.930789, loss_d: 0.732604
0.4224 --- loss: 1.425921, loss_ss: 1.053368, loss_d: 0.372552
0.4608 --- loss: 1.425552, loss_ss: 0.832852, loss_d: 0.592700
0.4992 --- loss: 1.969147, loss_ss: 1.215269, loss_d: 0.753879
0.5376 --- loss: 1.447504, loss_ss: 0.929174, loss_d: 0.518330
0.5760 --- loss: 1.585482, loss_ss: 0.880225, loss_d: 0.705257
0.6144 --- loss: 1.719704, loss_ss: 1.010606, loss_d: 0.709098
0.6528 --- loss: 1.528736, loss_ss: 1.243390, loss_d: 0.285346
0.6912 --- loss: 1.844213, loss_ss: 1.272201, loss_d: 0.572012
0.7296 --- loss: 1.712965, loss_ss: 1.084982, loss_d: 0.627983
0.7680 --- loss: 1.646617, loss_ss: 1.001586, loss_d: 0.645031
0.8065 --- loss: 1.675695, loss_ss: 1.234292, loss_d: 0.441403
0.8449 --- loss: 1.681868, loss_ss: 1.085531, loss_d: 0.596337
0.8833 --- loss: 1.734685, loss_ss: 1.037956, loss_d: 0.696728
0.9217 --- loss: 1.924303, loss_ss: 1.239568, loss_d: 0.684735
0.9601 --- loss: 1.343568, loss_ss: 0.868266, loss_d: 0.475302
0.9985 --- loss: 1.631754, loss_ss: 1.306194, loss_d: 0.325559
Epoch finished! Loss: 1.5998764858796046
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.233642, loss_ss: 0.917398, loss_d: 0.316244
0.0384 --- loss: 1.527445, loss_ss: 1.224941, loss_d: 0.302504
0.0768 --- loss: 1.377130, loss_ss: 0.963040, loss_d: 0.414090
0.1152 --- loss: 1.419287, loss_ss: 1.065929, loss_d: 0.353359
0.1536 --- loss: 1.650869, loss_ss: 1.252801, loss_d: 0.398068
0.1920 --- loss: 1.547749, loss_ss: 1.199587, loss_d: 0.348162
0.2304 --- loss: 1.178703, loss_ss: 0.802218, loss_d: 0.376485
0.2688 --- loss: 1.629229, loss_ss: 0.925229, loss_d: 0.703999
0.3072 --- loss: 1.405448, loss_ss: 0.805891, loss_d: 0.599557
0.3456 --- loss: 1.738120, loss_ss: 1.112874, loss_d: 0.625246
0.3840 --- loss: 2.234846, loss_ss: 0.764196, loss_d: 1.470650
0.4224 --- loss: 1.721755, loss_ss: 0.985112, loss_d: 0.736643
0.4608 --- loss: 1.480508, loss_ss: 0.883874, loss_d: 0.596635
0.4992 --- loss: 1.437924, loss_ss: 0.849063, loss_d: 0.588862
0.5376 --- loss: 1.638857, loss_ss: 1.027644, loss_d: 0.611213
0.5760 --- loss: 1.369908, loss_ss: 0.794130, loss_d: 0.575779
0.6144 --- loss: 1.144102, loss_ss: 0.814710, loss_d: 0.329391
0.6528 --- loss: 1.302515, loss_ss: 0.897352, loss_d: 0.405163
0.6912 --- loss: 1.837806, loss_ss: 1.283453, loss_d: 0.554353
0.7296 --- loss: 1.666040, loss_ss: 1.069904, loss_d: 0.596136
0.7680 --- loss: 1.809168, loss_ss: 1.114155, loss_d: 0.695014
0.8065 --- loss: 1.571410, loss_ss: 1.221895, loss_d: 0.349515
0.8449 --- loss: 1.244354, loss_ss: 0.971272, loss_d: 0.273082
0.8833 --- loss: 1.532393, loss_ss: 0.892650, loss_d: 0.639743
0.9217 --- loss: 1.323643, loss_ss: 0.925363, loss_d: 0.398280
0.9601 --- loss: 1.816407, loss_ss: 1.276147, loss_d: 0.540260
0.9985 --- loss: 1.581662, loss_ss: 1.332227, loss_d: 0.249435
Epoch finished! Loss: 1.4763227513203254
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.633626, loss_ss: 1.110927, loss_d: 0.522699
0.0384 --- loss: 1.392660, loss_ss: 1.001588, loss_d: 0.391072
0.0768 --- loss: 1.034376, loss_ss: 0.729476, loss_d: 0.304900
0.1152 --- loss: 1.608350, loss_ss: 1.193492, loss_d: 0.414858
0.1536 --- loss: 1.545015, loss_ss: 1.037800, loss_d: 0.507215
0.1920 --- loss: 1.669844, loss_ss: 1.002510, loss_d: 0.667334
0.2304 --- loss: 1.512012, loss_ss: 1.117780, loss_d: 0.394232
0.2688 --- loss: 1.056599, loss_ss: 0.800739, loss_d: 0.255860
0.3072 --- loss: 1.096478, loss_ss: 0.678498, loss_d: 0.417980
0.3456 --- loss: 1.096277, loss_ss: 0.781386, loss_d: 0.314891
0.3840 --- loss: 2.025853, loss_ss: 1.361747, loss_d: 0.664105
0.4224 --- loss: 1.435702, loss_ss: 1.184654, loss_d: 0.251048
0.4608 --- loss: 1.451583, loss_ss: 1.051908, loss_d: 0.399676
0.4992 --- loss: 1.471060, loss_ss: 1.031769, loss_d: 0.439291
0.5376 --- loss: 1.302392, loss_ss: 0.880632, loss_d: 0.421761
0.5760 --- loss: 1.539019, loss_ss: 1.026770, loss_d: 0.512249
0.6144 --- loss: 1.462656, loss_ss: 1.167713, loss_d: 0.294942
0.6528 --- loss: 0.933729, loss_ss: 0.728388, loss_d: 0.205341
0.6912 --- loss: 0.964103, loss_ss: 0.658904, loss_d: 0.305199
0.7296 --- loss: 1.583623, loss_ss: 1.371077, loss_d: 0.212546
0.7680 --- loss: 1.112756, loss_ss: 0.787604, loss_d: 0.325153
0.8065 --- loss: 1.139282, loss_ss: 0.656641, loss_d: 0.482641
0.8449 --- loss: 1.052922, loss_ss: 0.828940, loss_d: 0.223981
0.8833 --- loss: 1.232602, loss_ss: 0.949366, loss_d: 0.283236
0.9217 --- loss: 1.280322, loss_ss: 1.171283, loss_d: 0.109038
0.9601 --- loss: 1.851806, loss_ss: 1.287394, loss_d: 0.564412
0.9985 --- loss: 1.853504, loss_ss: 0.898191, loss_d: 0.955313
Epoch finished! Loss: 1.349176660638589
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.534748, loss_ss: 1.067899, loss_d: 0.466849
0.0384 --- loss: 1.318614, loss_ss: 0.685607, loss_d: 0.633007
0.0768 --- loss: 1.104277, loss_ss: 0.806756, loss_d: 0.297521
0.1152 --- loss: 1.143177, loss_ss: 0.899882, loss_d: 0.243294
0.1536 --- loss: 1.028796, loss_ss: 0.788745, loss_d: 0.240052
0.1920 --- loss: 1.091704, loss_ss: 0.889915, loss_d: 0.201789
0.2304 --- loss: 1.239662, loss_ss: 0.752468, loss_d: 0.487194
0.2688 --- loss: 1.132136, loss_ss: 1.031694, loss_d: 0.100442
0.3072 --- loss: 1.562872, loss_ss: 0.889018, loss_d: 0.673854
0.3456 --- loss: 1.266005, loss_ss: 1.057105, loss_d: 0.208900
0.3840 --- loss: 1.161381, loss_ss: 0.910708, loss_d: 0.250673
0.4224 --- loss: 1.385384, loss_ss: 1.054543, loss_d: 0.330842
0.4608 --- loss: 1.383695, loss_ss: 1.135187, loss_d: 0.248507
0.4992 --- loss: 1.480159, loss_ss: 0.922593, loss_d: 0.557566
0.5376 --- loss: 1.180986, loss_ss: 0.875542, loss_d: 0.305444
0.5760 --- loss: 1.325410, loss_ss: 0.811463, loss_d: 0.513946
0.6144 --- loss: 1.148480, loss_ss: 1.035436, loss_d: 0.113044
0.6528 --- loss: 0.962455, loss_ss: 0.693313, loss_d: 0.269141
0.6912 --- loss: 1.382832, loss_ss: 1.120244, loss_d: 0.262589
0.7296 --- loss: 1.431271, loss_ss: 1.145017, loss_d: 0.286255
0.7680 --- loss: 0.902879, loss_ss: 0.715638, loss_d: 0.187240
0.8065 --- loss: 1.390709, loss_ss: 1.135320, loss_d: 0.255389
0.8449 --- loss: 0.956999, loss_ss: 0.808849, loss_d: 0.148149
0.8833 --- loss: 0.947289, loss_ss: 0.787445, loss_d: 0.159843
0.9217 --- loss: 1.059911, loss_ss: 0.817452, loss_d: 0.242459
0.9601 --- loss: 1.490250, loss_ss: 0.865511, loss_d: 0.624739
0.9985 --- loss: 2.304481, loss_ss: 1.050006, loss_d: 1.254475
Epoch finished! Loss: 1.2749621803943927
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.408445, loss_ss: 0.873408, loss_d: 0.535037
0.0384 --- loss: 1.207278, loss_ss: 0.923480, loss_d: 0.283797
0.0768 --- loss: 1.063410, loss_ss: 0.898673, loss_d: 0.164737
0.1152 --- loss: 1.102897, loss_ss: 0.829540, loss_d: 0.273357
0.1536 --- loss: 1.219914, loss_ss: 0.900496, loss_d: 0.319418
0.1920 --- loss: 1.653139, loss_ss: 1.000859, loss_d: 0.652280
0.2304 --- loss: 1.156531, loss_ss: 0.875967, loss_d: 0.280564
0.2688 --- loss: 1.467194, loss_ss: 0.929642, loss_d: 0.537552
0.3072 --- loss: 1.342968, loss_ss: 0.869877, loss_d: 0.473091
0.3456 --- loss: 1.084416, loss_ss: 0.875507, loss_d: 0.208909
0.3840 --- loss: 1.488266, loss_ss: 0.921935, loss_d: 0.566331
0.4224 --- loss: 1.050732, loss_ss: 0.727949, loss_d: 0.322783
0.4608 --- loss: 1.861168, loss_ss: 0.793615, loss_d: 1.067553
0.4992 --- loss: 1.271009, loss_ss: 1.117885, loss_d: 0.153124
0.5376 --- loss: 1.403638, loss_ss: 1.164648, loss_d: 0.238990
0.5760 --- loss: 1.066050, loss_ss: 0.809693, loss_d: 0.256357
0.6144 --- loss: 1.092443, loss_ss: 0.915580, loss_d: 0.176863
0.6528 --- loss: 0.969194, loss_ss: 0.767152, loss_d: 0.202042
0.6912 --- loss: 1.558608, loss_ss: 1.367135, loss_d: 0.191473
0.7296 --- loss: 1.376550, loss_ss: 1.013963, loss_d: 0.362587
0.7680 --- loss: 1.420456, loss_ss: 0.975624, loss_d: 0.444832
0.8065 --- loss: 1.269985, loss_ss: 0.781728, loss_d: 0.488257
0.8449 --- loss: 1.149896, loss_ss: 1.007752, loss_d: 0.142143
0.8833 --- loss: 1.170433, loss_ss: 0.995626, loss_d: 0.174807
0.9217 --- loss: 1.157638, loss_ss: 1.030281, loss_d: 0.127357
0.9601 --- loss: 1.044926, loss_ss: 0.820940, loss_d: 0.223986
0.9985 --- loss: 1.245043, loss_ss: 0.936317, loss_d: 0.308726
Epoch finished! Loss: 1.2150861265567632
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 0.967640, loss_ss: 0.746658, loss_d: 0.220982
0.0384 --- loss: 1.180633, loss_ss: 1.080652, loss_d: 0.099981
0.0768 --- loss: 0.986840, loss_ss: 0.886442, loss_d: 0.100399
0.1152 --- loss: 0.842588, loss_ss: 0.748673, loss_d: 0.093915
0.1536 --- loss: 1.262733, loss_ss: 1.100865, loss_d: 0.161868
0.1920 --- loss: 1.116150, loss_ss: 1.026044, loss_d: 0.090105
0.2304 --- loss: 0.843077, loss_ss: 0.789465, loss_d: 0.053612
0.2688 --- loss: 0.735947, loss_ss: 0.633733, loss_d: 0.102213
0.3072 --- loss: 1.182894, loss_ss: 0.903695, loss_d: 0.279199
0.3456 --- loss: 1.025916, loss_ss: 0.939386, loss_d: 0.086530
0.3840 --- loss: 1.082164, loss_ss: 0.844282, loss_d: 0.237883
0.4224 --- loss: 1.195157, loss_ss: 1.005073, loss_d: 0.190083
0.4608 --- loss: 1.153077, loss_ss: 0.751085, loss_d: 0.401992
0.4992 --- loss: 1.121036, loss_ss: 1.005047, loss_d: 0.115989
0.5376 --- loss: 1.111240, loss_ss: 0.923251, loss_d: 0.187989
0.5760 --- loss: 0.983116, loss_ss: 0.835211, loss_d: 0.147905
0.6144 --- loss: 1.120501, loss_ss: 0.726357, loss_d: 0.394144
0.6528 --- loss: 1.414431, loss_ss: 0.827550, loss_d: 0.586881
0.6912 --- loss: 1.552711, loss_ss: 1.123134, loss_d: 0.429576
0.7296 --- loss: 1.025739, loss_ss: 0.687217, loss_d: 0.338522
0.7680 --- loss: 1.268475, loss_ss: 1.085654, loss_d: 0.182821
0.8065 --- loss: 1.405497, loss_ss: 0.846636, loss_d: 0.558861
0.8449 --- loss: 0.932096, loss_ss: 0.716092, loss_d: 0.216004
0.8833 --- loss: 0.883119, loss_ss: 0.738316, loss_d: 0.144803
0.9217 --- loss: 1.155155, loss_ss: 0.696346, loss_d: 0.458809
0.9601 --- loss: 1.086269, loss_ss: 0.927302, loss_d: 0.158966
0.9985 --- loss: 1.509759, loss_ss: 0.864025, loss_d: 0.645734
Epoch finished! Loss: 1.1555873902944418
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.998713, loss_ss: 1.211940, loss_d: 0.786773
0.0384 --- loss: 1.383619, loss_ss: 1.169019, loss_d: 0.214601
0.0768 --- loss: 1.065226, loss_ss: 0.804381, loss_d: 0.260844
0.1152 --- loss: 1.264803, loss_ss: 1.063081, loss_d: 0.201722
0.1536 --- loss: 0.858772, loss_ss: 0.701339, loss_d: 0.157433
0.1920 --- loss: 1.345217, loss_ss: 1.006841, loss_d: 0.338376
0.2304 --- loss: 1.179258, loss_ss: 0.826678, loss_d: 0.352580
0.2688 --- loss: 1.199002, loss_ss: 0.811751, loss_d: 0.387251
0.3072 --- loss: 0.995566, loss_ss: 0.901850, loss_d: 0.093716
0.3456 --- loss: 1.105115, loss_ss: 0.873269, loss_d: 0.231846
0.3840 --- loss: 1.169574, loss_ss: 1.057580, loss_d: 0.111994
0.4224 --- loss: 1.201770, loss_ss: 0.821703, loss_d: 0.380067
0.4608 --- loss: 1.076488, loss_ss: 0.936475, loss_d: 0.140013
0.4992 --- loss: 1.571978, loss_ss: 0.986984, loss_d: 0.584995
0.5376 --- loss: 0.860806, loss_ss: 0.769811, loss_d: 0.090995
0.5760 --- loss: 1.138422, loss_ss: 0.700847, loss_d: 0.437575
0.6144 --- loss: 0.728859, loss_ss: 0.663923, loss_d: 0.064936
0.6528 --- loss: 1.045839, loss_ss: 0.984028, loss_d: 0.061811
0.6912 --- loss: 1.009724, loss_ss: 0.901761, loss_d: 0.107963
0.7296 --- loss: 1.151586, loss_ss: 0.584185, loss_d: 0.567401
0.7680 --- loss: 0.604018, loss_ss: 0.557039, loss_d: 0.046980
0.8065 --- loss: 0.884104, loss_ss: 0.775481, loss_d: 0.108623
0.8449 --- loss: 0.726886, loss_ss: 0.664899, loss_d: 0.061987
0.8833 --- loss: 0.989377, loss_ss: 0.671624, loss_d: 0.317754
0.9217 --- loss: 1.198137, loss_ss: 1.023430, loss_d: 0.174707
0.9601 --- loss: 1.191795, loss_ss: 0.945330, loss_d: 0.246465
0.9985 --- loss: 1.903744, loss_ss: 0.918974, loss_d: 0.984770
Epoch finished! Loss: 1.1590762986586645
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.286060, loss_ss: 1.087759, loss_d: 0.198302
0.0384 --- loss: 0.998160, loss_ss: 0.807289, loss_d: 0.190870
0.0768 --- loss: 0.770872, loss_ss: 0.686802, loss_d: 0.084069
0.1152 --- loss: 1.449672, loss_ss: 0.744267, loss_d: 0.705405
0.1536 --- loss: 0.957880, loss_ss: 0.761586, loss_d: 0.196294
0.1920 --- loss: 1.439231, loss_ss: 0.960154, loss_d: 0.479076
0.2304 --- loss: 0.791994, loss_ss: 0.608221, loss_d: 0.183773
0.2688 --- loss: 1.348782, loss_ss: 0.862097, loss_d: 0.486685
0.3072 --- loss: 0.923181, loss_ss: 0.813554, loss_d: 0.109627
0.3456 --- loss: 1.323937, loss_ss: 0.666548, loss_d: 0.657389
0.3840 --- loss: 1.040707, loss_ss: 0.803024, loss_d: 0.237684
0.4224 --- loss: 1.342614, loss_ss: 1.047573, loss_d: 0.295041
0.4608 --- loss: 0.840866, loss_ss: 0.731431, loss_d: 0.109435
0.4992 --- loss: 0.748006, loss_ss: 0.557456, loss_d: 0.190550
0.5376 --- loss: 0.907417, loss_ss: 0.826157, loss_d: 0.081260
0.5760 --- loss: 1.592695, loss_ss: 1.120715, loss_d: 0.471980
0.6144 --- loss: 0.997993, loss_ss: 0.905985, loss_d: 0.092008
0.6528 --- loss: 1.035374, loss_ss: 0.871424, loss_d: 0.163950
0.6912 --- loss: 1.354632, loss_ss: 1.219924, loss_d: 0.134708
0.7296 --- loss: 1.143812, loss_ss: 0.777394, loss_d: 0.366418
0.7680 --- loss: 1.008683, loss_ss: 0.923933, loss_d: 0.084750
0.8065 --- loss: 1.513423, loss_ss: 1.316555, loss_d: 0.196868
0.8449 --- loss: 1.184226, loss_ss: 0.814027, loss_d: 0.370199
0.8833 --- loss: 0.987256, loss_ss: 0.717559, loss_d: 0.269698
0.9217 --- loss: 0.980698, loss_ss: 0.820158, loss_d: 0.160541
0.9601 --- loss: 1.407435, loss_ss: 1.300629, loss_d: 0.106806
0.9985 --- loss: 0.883871, loss_ss: 0.785857, loss_d: 0.098014
Epoch finished! Loss: 1.1371652882832748
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6480392156862745
             precision    recall  f1-score   support

        0.0       0.23      0.84      0.36        38
        1.0       0.50      0.03      0.05       144
        2.0       0.70      0.87      0.77       495
        3.0       0.61      0.70      0.66       107
        4.0       0.90      0.51      0.65       236

avg / total       0.69      0.65      0.62      1020
 


====== chp048-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  88.73  84.21   88.90  22.70     35.75
1  85.88   2.78   99.54  50.00      5.26
2  75.49  86.87   64.76  69.92     77.48
3  92.25  70.09   94.85  61.48     65.50
4  87.25  50.85   98.21  89.55     64.86
Total accuracy: 64.80%
Average sen: 58.96%
Average spec: 89.25%
Macro f1-score: 49.77%
Diagnosis acc on 15mins: 0.0
[0.00744609 0.04303339 0.01343773 0.02395053 0.1998798  0.21272336
 0.19556126 0.09066042 0.08111383 0.07628775 0.01092092 0.31247395
 0.04785031 0.13317116 0.01403234 0.02524293 0.00554674 0.00275771
 0.06044096 0.07229006 0.0777711  0.12709607 0.07143714 0.42615539
 0.12946044 0.01232384 0.02657716 0.09868864 0.14809054 0.05574518
 0.17864926 0.20066774 0.09796425 0.13556609]
pred: 0.10044159030076116, label: 1
Wrong!!! Real Diagnosis: Narcolepsy type 1

=== Test on chp049-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.419826, loss_ss: 1.714349, loss_d: 0.705476
0.0384 --- loss: 1.829633, loss_ss: 1.479680, loss_d: 0.349953
0.0769 --- loss: 2.024084, loss_ss: 1.439436, loss_d: 0.584648
0.1153 --- loss: 2.247798, loss_ss: 1.311490, loss_d: 0.936307
0.1537 --- loss: 1.677716, loss_ss: 1.373339, loss_d: 0.304377
0.1922 --- loss: 2.094298, loss_ss: 1.399361, loss_d: 0.694938
0.2306 --- loss: 2.224051, loss_ss: 1.367652, loss_d: 0.856399
0.2690 --- loss: 1.857622, loss_ss: 1.262624, loss_d: 0.594997
0.3075 --- loss: 1.799622, loss_ss: 1.308684, loss_d: 0.490938
0.3459 --- loss: 1.853771, loss_ss: 1.272244, loss_d: 0.581527
0.3843 --- loss: 1.734095, loss_ss: 1.308623, loss_d: 0.425472
0.4228 --- loss: 1.681682, loss_ss: 1.218201, loss_d: 0.463482
0.4612 --- loss: 1.609055, loss_ss: 1.247132, loss_d: 0.361923
0.4996 --- loss: 1.713353, loss_ss: 1.254536, loss_d: 0.458817
0.5380 --- loss: 1.846359, loss_ss: 1.140287, loss_d: 0.706072
0.5765 --- loss: 1.703651, loss_ss: 1.226989, loss_d: 0.476662
0.6149 --- loss: 1.828405, loss_ss: 1.334050, loss_d: 0.494355
0.6533 --- loss: 1.944030, loss_ss: 1.246197, loss_d: 0.697832
0.6918 --- loss: 1.572013, loss_ss: 1.168089, loss_d: 0.403923
0.7302 --- loss: 2.032970, loss_ss: 1.057584, loss_d: 0.975386
0.7686 --- loss: 1.625156, loss_ss: 1.173954, loss_d: 0.451202
0.8071 --- loss: 1.773476, loss_ss: 1.140993, loss_d: 0.632483
0.8455 --- loss: 1.662130, loss_ss: 1.116417, loss_d: 0.545713
0.8839 --- loss: 1.717937, loss_ss: 1.237115, loss_d: 0.480822
0.9224 --- loss: 1.880878, loss_ss: 1.226688, loss_d: 0.654190
0.9608 --- loss: 1.772383, loss_ss: 1.057643, loss_d: 0.714740
0.9992 --- loss: 2.356306, loss_ss: 1.072211, loss_d: 1.284095
Epoch finished! Loss: 1.9060404672072484
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.723259, loss_ss: 1.005252, loss_d: 0.718006
0.0384 --- loss: 1.575192, loss_ss: 1.156395, loss_d: 0.418797
0.0769 --- loss: 1.880156, loss_ss: 1.213928, loss_d: 0.666228
0.1153 --- loss: 1.802388, loss_ss: 0.962011, loss_d: 0.840377
0.1537 --- loss: 1.522216, loss_ss: 1.018316, loss_d: 0.503900
0.1922 --- loss: 1.886754, loss_ss: 1.295248, loss_d: 0.591507
0.2306 --- loss: 1.397284, loss_ss: 1.054220, loss_d: 0.343064
0.2690 --- loss: 1.650232, loss_ss: 1.213113, loss_d: 0.437119
0.3075 --- loss: 1.835804, loss_ss: 1.316184, loss_d: 0.519620
0.3459 --- loss: 1.664378, loss_ss: 1.076776, loss_d: 0.587602
0.3843 --- loss: 1.784721, loss_ss: 0.966436, loss_d: 0.818285
0.4228 --- loss: 1.709062, loss_ss: 1.202719, loss_d: 0.506343
0.4612 --- loss: 1.716154, loss_ss: 1.219095, loss_d: 0.497059
0.4996 --- loss: 1.631427, loss_ss: 1.034979, loss_d: 0.596448
0.5380 --- loss: 1.842298, loss_ss: 1.142147, loss_d: 0.700151
0.5765 --- loss: 1.551199, loss_ss: 1.119722, loss_d: 0.431478
0.6149 --- loss: 1.730326, loss_ss: 1.198900, loss_d: 0.531426
0.6533 --- loss: 1.754781, loss_ss: 0.885740, loss_d: 0.869042
0.6918 --- loss: 1.589306, loss_ss: 1.029736, loss_d: 0.559570
0.7302 --- loss: 1.563038, loss_ss: 0.886916, loss_d: 0.676122
0.7686 --- loss: 1.888863, loss_ss: 1.339354, loss_d: 0.549508
0.8071 --- loss: 1.844251, loss_ss: 1.101936, loss_d: 0.742315
0.8455 --- loss: 1.470618, loss_ss: 1.053520, loss_d: 0.417098
0.8839 --- loss: 1.476037, loss_ss: 0.882639, loss_d: 0.593397
0.9224 --- loss: 1.537457, loss_ss: 0.918570, loss_d: 0.618887
0.9608 --- loss: 1.408122, loss_ss: 0.957627, loss_d: 0.450495
0.9992 --- loss: 1.681494, loss_ss: 1.081543, loss_d: 0.599951
Epoch finished! Loss: 1.6764635975544269
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.416444, loss_ss: 1.051759, loss_d: 0.364685
0.0384 --- loss: 1.734598, loss_ss: 1.179434, loss_d: 0.555163
0.0769 --- loss: 1.551577, loss_ss: 0.984173, loss_d: 0.567405
0.1153 --- loss: 1.491121, loss_ss: 1.038281, loss_d: 0.452840
0.1537 --- loss: 1.439653, loss_ss: 0.792755, loss_d: 0.646898
0.1922 --- loss: 1.499382, loss_ss: 0.898922, loss_d: 0.600460
0.2306 --- loss: 1.784212, loss_ss: 0.994588, loss_d: 0.789625
0.2690 --- loss: 1.703980, loss_ss: 1.153630, loss_d: 0.550350
0.3075 --- loss: 1.751454, loss_ss: 1.179225, loss_d: 0.572229
0.3459 --- loss: 1.511032, loss_ss: 1.016577, loss_d: 0.494455
0.3843 --- loss: 1.455797, loss_ss: 0.782038, loss_d: 0.673759
0.4228 --- loss: 1.573247, loss_ss: 1.103870, loss_d: 0.469377
0.4612 --- loss: 1.680178, loss_ss: 1.047403, loss_d: 0.632776
0.4996 --- loss: 1.868916, loss_ss: 1.130085, loss_d: 0.738831
0.5380 --- loss: 1.425915, loss_ss: 0.863251, loss_d: 0.562665
0.5765 --- loss: 1.249576, loss_ss: 0.811408, loss_d: 0.438169
0.6149 --- loss: 1.372249, loss_ss: 1.004480, loss_d: 0.367769
0.6533 --- loss: 1.761819, loss_ss: 1.004819, loss_d: 0.756999
0.6918 --- loss: 1.718048, loss_ss: 1.037269, loss_d: 0.680778
0.7302 --- loss: 1.593371, loss_ss: 1.072882, loss_d: 0.520490
0.7686 --- loss: 1.777403, loss_ss: 1.153336, loss_d: 0.624067
0.8071 --- loss: 1.351580, loss_ss: 0.802232, loss_d: 0.549348
0.8455 --- loss: 1.633783, loss_ss: 1.073002, loss_d: 0.560781
0.8839 --- loss: 1.290411, loss_ss: 0.893855, loss_d: 0.396556
0.9224 --- loss: 1.592715, loss_ss: 0.931750, loss_d: 0.660964
0.9608 --- loss: 1.568886, loss_ss: 1.066772, loss_d: 0.502114
0.9992 --- loss: 1.977461, loss_ss: 1.712666, loss_d: 0.264796
Epoch finished! Loss: 1.5640828164724203
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.538290, loss_ss: 0.783532, loss_d: 0.754759
0.0384 --- loss: 1.763297, loss_ss: 0.976345, loss_d: 0.786952
0.0769 --- loss: 1.928547, loss_ss: 1.339519, loss_d: 0.589028
0.1153 --- loss: 1.526541, loss_ss: 1.251867, loss_d: 0.274674
0.1537 --- loss: 1.631201, loss_ss: 1.142948, loss_d: 0.488252
0.1922 --- loss: 1.573298, loss_ss: 1.192122, loss_d: 0.381176
0.2306 --- loss: 1.757291, loss_ss: 1.121491, loss_d: 0.635800
0.2690 --- loss: 1.620793, loss_ss: 1.059931, loss_d: 0.560862
0.3075 --- loss: 1.718433, loss_ss: 0.843555, loss_d: 0.874878
0.3459 --- loss: 1.431722, loss_ss: 0.887786, loss_d: 0.543936
0.3843 --- loss: 1.292705, loss_ss: 0.640850, loss_d: 0.651855
0.4228 --- loss: 1.535790, loss_ss: 0.967289, loss_d: 0.568501
0.4612 --- loss: 1.251991, loss_ss: 0.854333, loss_d: 0.397658
0.4996 --- loss: 1.485377, loss_ss: 0.883576, loss_d: 0.601801
0.5380 --- loss: 1.340087, loss_ss: 0.893591, loss_d: 0.446496
0.5765 --- loss: 1.559304, loss_ss: 1.039636, loss_d: 0.519668
0.6149 --- loss: 1.307683, loss_ss: 0.774457, loss_d: 0.533227
0.6533 --- loss: 1.585860, loss_ss: 0.838449, loss_d: 0.747412
0.6918 --- loss: 1.205412, loss_ss: 0.937862, loss_d: 0.267550
0.7302 --- loss: 1.345142, loss_ss: 0.960734, loss_d: 0.384408
0.7686 --- loss: 1.276867, loss_ss: 0.877526, loss_d: 0.399341
0.8071 --- loss: 1.854688, loss_ss: 0.955177, loss_d: 0.899511
0.8455 --- loss: 1.504403, loss_ss: 0.757310, loss_d: 0.747092
0.8839 --- loss: 1.124656, loss_ss: 0.791536, loss_d: 0.333120
0.9224 --- loss: 1.724440, loss_ss: 1.137087, loss_d: 0.587353
0.9608 --- loss: 1.054510, loss_ss: 0.889145, loss_d: 0.165365
0.9992 --- loss: 1.382102, loss_ss: 0.884813, loss_d: 0.497289
Epoch finished! Loss: 1.4772664358982672
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.048194, loss_ss: 0.840906, loss_d: 0.207288
0.0384 --- loss: 1.480168, loss_ss: 0.913288, loss_d: 0.566880
0.0769 --- loss: 1.832192, loss_ss: 1.174386, loss_d: 0.657806
0.1153 --- loss: 1.281987, loss_ss: 0.812055, loss_d: 0.469932
0.1537 --- loss: 1.408527, loss_ss: 0.953470, loss_d: 0.455057
0.1922 --- loss: 1.569336, loss_ss: 1.223404, loss_d: 0.345932
0.2306 --- loss: 1.286383, loss_ss: 0.974608, loss_d: 0.311774
0.2690 --- loss: 1.466624, loss_ss: 0.966132, loss_d: 0.500492
0.3075 --- loss: 1.368997, loss_ss: 0.918142, loss_d: 0.450854
0.3459 --- loss: 1.430307, loss_ss: 0.918758, loss_d: 0.511549
0.3843 --- loss: 1.281782, loss_ss: 0.825691, loss_d: 0.456091
0.4228 --- loss: 1.170696, loss_ss: 0.833760, loss_d: 0.336936
0.4612 --- loss: 1.118744, loss_ss: 0.911994, loss_d: 0.206750
0.4996 --- loss: 1.144209, loss_ss: 0.967981, loss_d: 0.176229
0.5380 --- loss: 1.062083, loss_ss: 0.760540, loss_d: 0.301543
0.5765 --- loss: 1.179345, loss_ss: 0.969351, loss_d: 0.209994
0.6149 --- loss: 1.144976, loss_ss: 0.987358, loss_d: 0.157618
0.6533 --- loss: 1.238353, loss_ss: 0.826661, loss_d: 0.411692
0.6918 --- loss: 1.203075, loss_ss: 0.627784, loss_d: 0.575292
0.7302 --- loss: 1.230439, loss_ss: 0.983597, loss_d: 0.246843
0.7686 --- loss: 1.205564, loss_ss: 0.720029, loss_d: 0.485535
0.8071 --- loss: 1.104517, loss_ss: 0.703893, loss_d: 0.400624
0.8455 --- loss: 1.137959, loss_ss: 0.970131, loss_d: 0.167828
0.8839 --- loss: 1.321577, loss_ss: 0.970179, loss_d: 0.351399
0.9224 --- loss: 1.159055, loss_ss: 0.748652, loss_d: 0.410403
0.9608 --- loss: 1.298095, loss_ss: 0.785004, loss_d: 0.513091
0.9992 --- loss: 1.243283, loss_ss: 0.989797, loss_d: 0.253486
Epoch finished! Loss: 1.381583307339595
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.289458, loss_ss: 0.793719, loss_d: 0.495739
0.0384 --- loss: 1.222881, loss_ss: 0.912506, loss_d: 0.310375
0.0769 --- loss: 1.473384, loss_ss: 0.617953, loss_d: 0.855431
0.1153 --- loss: 1.559028, loss_ss: 1.005103, loss_d: 0.553926
0.1537 --- loss: 1.384513, loss_ss: 0.849652, loss_d: 0.534861
0.1922 --- loss: 1.413148, loss_ss: 1.081937, loss_d: 0.331211
0.2306 --- loss: 1.235982, loss_ss: 0.858423, loss_d: 0.377559
0.2690 --- loss: 1.052876, loss_ss: 0.749046, loss_d: 0.303831
0.3075 --- loss: 1.321674, loss_ss: 1.098897, loss_d: 0.222777
0.3459 --- loss: 1.338358, loss_ss: 0.961736, loss_d: 0.376622
0.3843 --- loss: 1.479177, loss_ss: 0.807297, loss_d: 0.671880
0.4228 --- loss: 1.130141, loss_ss: 0.780798, loss_d: 0.349342
0.4612 --- loss: 1.685937, loss_ss: 1.451080, loss_d: 0.234857
0.4996 --- loss: 1.292653, loss_ss: 0.994210, loss_d: 0.298443
0.5380 --- loss: 1.711598, loss_ss: 1.197116, loss_d: 0.514482
0.5765 --- loss: 1.309223, loss_ss: 1.082754, loss_d: 0.226469
0.6149 --- loss: 1.557891, loss_ss: 1.225477, loss_d: 0.332414
0.6533 --- loss: 1.063892, loss_ss: 0.830555, loss_d: 0.233337
0.6918 --- loss: 1.276476, loss_ss: 0.969318, loss_d: 0.307158
0.7302 --- loss: 1.208495, loss_ss: 0.749366, loss_d: 0.459129
0.7686 --- loss: 0.935773, loss_ss: 0.659197, loss_d: 0.276576
0.8071 --- loss: 1.149830, loss_ss: 0.859351, loss_d: 0.290479
0.8455 --- loss: 1.558552, loss_ss: 1.315247, loss_d: 0.243305
0.8839 --- loss: 1.271237, loss_ss: 0.761087, loss_d: 0.510150
0.9224 --- loss: 1.255805, loss_ss: 0.517207, loss_d: 0.738598
0.9608 --- loss: 1.035035, loss_ss: 0.814716, loss_d: 0.220319
0.9992 --- loss: 3.585257, loss_ss: 1.285116, loss_d: 2.300141
Epoch finished! Loss: 1.3253560751676559
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.681661, loss_ss: 1.080184, loss_d: 0.601477
0.0384 --- loss: 1.261081, loss_ss: 0.875715, loss_d: 0.385365
0.0769 --- loss: 1.223107, loss_ss: 0.774794, loss_d: 0.448313
0.1153 --- loss: 1.534901, loss_ss: 0.871940, loss_d: 0.662961
0.1537 --- loss: 1.077275, loss_ss: 0.847937, loss_d: 0.229337
0.1922 --- loss: 1.016999, loss_ss: 0.815529, loss_d: 0.201470
0.2306 --- loss: 1.282018, loss_ss: 1.049007, loss_d: 0.233011
0.2690 --- loss: 1.030515, loss_ss: 0.766183, loss_d: 0.264332
0.3075 --- loss: 1.357795, loss_ss: 0.803755, loss_d: 0.554040
0.3459 --- loss: 1.111879, loss_ss: 0.915587, loss_d: 0.196292
0.3843 --- loss: 1.146841, loss_ss: 0.966461, loss_d: 0.180380
0.4228 --- loss: 0.959656, loss_ss: 0.776381, loss_d: 0.183274
0.4612 --- loss: 1.229802, loss_ss: 0.781882, loss_d: 0.447920
0.4996 --- loss: 1.422946, loss_ss: 1.087782, loss_d: 0.335164
0.5380 --- loss: 0.934640, loss_ss: 0.649529, loss_d: 0.285110
0.5765 --- loss: 1.281414, loss_ss: 0.917098, loss_d: 0.364316
0.6149 --- loss: 1.575419, loss_ss: 0.678314, loss_d: 0.897105
0.6533 --- loss: 1.516722, loss_ss: 1.040467, loss_d: 0.476255
0.6918 --- loss: 1.380818, loss_ss: 0.774042, loss_d: 0.606776
0.7302 --- loss: 1.394767, loss_ss: 1.063661, loss_d: 0.331105
0.7686 --- loss: 1.085830, loss_ss: 0.954093, loss_d: 0.131737
0.8071 --- loss: 1.450234, loss_ss: 0.820272, loss_d: 0.629962
0.8455 --- loss: 0.809770, loss_ss: 0.594743, loss_d: 0.215026
0.8839 --- loss: 1.201933, loss_ss: 1.005852, loss_d: 0.196081
0.9224 --- loss: 0.975364, loss_ss: 0.848515, loss_d: 0.126848
0.9608 --- loss: 1.668766, loss_ss: 1.224349, loss_d: 0.444417
0.9992 --- loss: 1.671224, loss_ss: 1.205121, loss_d: 0.466103
Epoch finished! Loss: 1.2739151486983666
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.314006, loss_ss: 1.024265, loss_d: 0.289742
0.0384 --- loss: 1.129205, loss_ss: 0.827109, loss_d: 0.302096
0.0769 --- loss: 0.960894, loss_ss: 0.801476, loss_d: 0.159417
0.1153 --- loss: 0.912640, loss_ss: 0.655612, loss_d: 0.257029
0.1537 --- loss: 1.167209, loss_ss: 0.822693, loss_d: 0.344516
0.1922 --- loss: 1.214036, loss_ss: 1.027024, loss_d: 0.187012
0.2306 --- loss: 1.257862, loss_ss: 0.835354, loss_d: 0.422508
0.2690 --- loss: 1.115228, loss_ss: 0.813276, loss_d: 0.301952
0.3075 --- loss: 1.816092, loss_ss: 1.494244, loss_d: 0.321847
0.3459 --- loss: 1.256348, loss_ss: 0.869873, loss_d: 0.386475
0.3843 --- loss: 1.298625, loss_ss: 0.864623, loss_d: 0.434002
0.4228 --- loss: 0.815798, loss_ss: 0.653940, loss_d: 0.161858
0.4612 --- loss: 1.330090, loss_ss: 0.802957, loss_d: 0.527133
0.4996 --- loss: 1.377719, loss_ss: 0.867900, loss_d: 0.509819
0.5380 --- loss: 1.009562, loss_ss: 0.695043, loss_d: 0.314519
0.5765 --- loss: 1.658906, loss_ss: 1.350325, loss_d: 0.308581
0.6149 --- loss: 1.006222, loss_ss: 0.676951, loss_d: 0.329271
0.6533 --- loss: 0.934646, loss_ss: 0.751718, loss_d: 0.182929
0.6918 --- loss: 0.996577, loss_ss: 0.740534, loss_d: 0.256043
0.7302 --- loss: 0.923638, loss_ss: 0.740683, loss_d: 0.182956
0.7686 --- loss: 1.503843, loss_ss: 0.631782, loss_d: 0.872061
0.8071 --- loss: 0.924760, loss_ss: 0.684934, loss_d: 0.239825
0.8455 --- loss: 1.085834, loss_ss: 0.950669, loss_d: 0.135165
0.8839 --- loss: 0.836672, loss_ss: 0.696907, loss_d: 0.139765
0.9224 --- loss: 1.203467, loss_ss: 0.950976, loss_d: 0.252491
0.9608 --- loss: 1.049822, loss_ss: 0.830222, loss_d: 0.219600
0.9992 --- loss: 1.455222, loss_ss: 1.101099, loss_d: 0.354123
Epoch finished! Loss: 1.2097572101996494
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 0.764787, loss_ss: 0.609916, loss_d: 0.154871
0.0384 --- loss: 1.094649, loss_ss: 0.874307, loss_d: 0.220342
0.0769 --- loss: 1.092489, loss_ss: 0.843352, loss_d: 0.249137
0.1153 --- loss: 1.195035, loss_ss: 0.856374, loss_d: 0.338661
0.1537 --- loss: 1.213088, loss_ss: 0.847832, loss_d: 0.365256
0.1922 --- loss: 0.880188, loss_ss: 0.726957, loss_d: 0.153231
0.2306 --- loss: 0.849627, loss_ss: 0.651903, loss_d: 0.197724
0.2690 --- loss: 1.174196, loss_ss: 0.977262, loss_d: 0.196933
0.3075 --- loss: 1.162417, loss_ss: 0.867693, loss_d: 0.294724
0.3459 --- loss: 1.072324, loss_ss: 0.885881, loss_d: 0.186443
0.3843 --- loss: 1.446096, loss_ss: 1.028451, loss_d: 0.417645
0.4228 --- loss: 1.073360, loss_ss: 0.949824, loss_d: 0.123536
0.4612 --- loss: 0.831111, loss_ss: 0.708286, loss_d: 0.122825
0.4996 --- loss: 0.974157, loss_ss: 0.687769, loss_d: 0.286388
0.5380 --- loss: 1.090319, loss_ss: 0.910362, loss_d: 0.179958
0.5765 --- loss: 0.852287, loss_ss: 0.630170, loss_d: 0.222118
0.6149 --- loss: 1.253986, loss_ss: 0.766792, loss_d: 0.487194
0.6533 --- loss: 1.425556, loss_ss: 1.167331, loss_d: 0.258226
0.6918 --- loss: 1.192894, loss_ss: 0.926969, loss_d: 0.265925
0.7302 --- loss: 1.533899, loss_ss: 0.977099, loss_d: 0.556800
0.7686 --- loss: 1.407315, loss_ss: 0.685986, loss_d: 0.721329
0.8071 --- loss: 1.018400, loss_ss: 0.815338, loss_d: 0.203062
0.8455 --- loss: 1.336181, loss_ss: 1.006491, loss_d: 0.329690
0.8839 --- loss: 0.959422, loss_ss: 0.803521, loss_d: 0.155901
0.9224 --- loss: 1.817210, loss_ss: 1.033226, loss_d: 0.783984
0.9608 --- loss: 1.099415, loss_ss: 0.955529, loss_d: 0.143886
0.9992 --- loss: 3.479982, loss_ss: 0.938775, loss_d: 2.541207
Epoch finished! Loss: 1.181782530592038
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.233673, loss_ss: 0.684563, loss_d: 0.549110
0.0384 --- loss: 1.443440, loss_ss: 1.030264, loss_d: 0.413176
0.0769 --- loss: 1.776429, loss_ss: 1.100085, loss_d: 0.676344
0.1153 --- loss: 1.135386, loss_ss: 0.653283, loss_d: 0.482103
0.1537 --- loss: 0.884506, loss_ss: 0.683306, loss_d: 0.201200
0.1922 --- loss: 0.954463, loss_ss: 0.783998, loss_d: 0.170465
0.2306 --- loss: 1.217762, loss_ss: 1.088165, loss_d: 0.129597
0.2690 --- loss: 1.361490, loss_ss: 1.108358, loss_d: 0.253132
0.3075 --- loss: 1.143699, loss_ss: 0.981811, loss_d: 0.161888
0.3459 --- loss: 1.148746, loss_ss: 0.887584, loss_d: 0.261162
0.3843 --- loss: 1.106267, loss_ss: 0.700927, loss_d: 0.405340
0.4228 --- loss: 1.869456, loss_ss: 1.317941, loss_d: 0.551515
0.4612 --- loss: 1.119898, loss_ss: 0.999819, loss_d: 0.120079
0.4996 --- loss: 1.289133, loss_ss: 0.926969, loss_d: 0.362164
0.5380 --- loss: 1.448008, loss_ss: 1.014186, loss_d: 0.433821
0.5765 --- loss: 1.272238, loss_ss: 0.869642, loss_d: 0.402596
0.6149 --- loss: 1.020966, loss_ss: 0.746774, loss_d: 0.274192
0.6533 --- loss: 1.002753, loss_ss: 0.572044, loss_d: 0.430710
0.6918 --- loss: 1.487255, loss_ss: 0.644059, loss_d: 0.843196
0.7302 --- loss: 1.360100, loss_ss: 0.917267, loss_d: 0.442832
0.7686 --- loss: 1.091110, loss_ss: 0.656381, loss_d: 0.434729
0.8071 --- loss: 1.749038, loss_ss: 1.155258, loss_d: 0.593780
0.8455 --- loss: 1.470832, loss_ss: 1.128276, loss_d: 0.342556
0.8839 --- loss: 1.120708, loss_ss: 0.800600, loss_d: 0.320108
0.9224 --- loss: 0.906786, loss_ss: 0.722195, loss_d: 0.184591
0.9608 --- loss: 1.266736, loss_ss: 1.037962, loss_d: 0.228774
0.9992 --- loss: 0.910707, loss_ss: 0.706016, loss_d: 0.204690
Epoch finished! Loss: 1.1543575655955536
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6444444444444445
             precision    recall  f1-score   support

        0.0       0.59      0.51      0.54       108
        1.0       0.56      0.76      0.64       387
        2.0       0.71      0.43      0.53       360
        3.0       0.76      0.95      0.85        95
        4.0       0.83      0.79      0.81       130

avg / total       0.66      0.64      0.63      1080
 


====== chp049-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  91.48  50.93   95.99  58.51     54.46
1  69.72  75.97   66.23  55.68     64.26
2  75.19  42.78   91.39  71.30     53.47
3  96.94  94.74   97.16  76.27     84.51
4  95.56  79.23   97.79  83.06     81.10
Total accuracy: 64.44%
Average sen: 68.73%
Average spec: 89.71%
Macro f1-score: 67.56%
Diagnosis acc on 15mins: 1.0
[0.99997258 0.99999106 0.99999452 0.99999881 0.99999821 0.99999416
 0.99992907 0.99997938 0.99999809 0.99999678 0.9999994  0.99999928
 0.99999917 0.99999893 0.99999571 0.99999785 0.99999845 0.9999994
 0.99999356 0.99989247 0.99990416 0.99999416 0.9999994  0.99999416
 0.99998891 0.99999928 0.9999789  0.99999952 0.99999833 0.9999975
 0.99999905 0.99999404 0.99994004 0.99998677 0.99999273 0.99999762]
pred: 0.9999858736991882, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp051-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.451998, loss_ss: 1.779289, loss_d: 0.672709
0.0384 --- loss: 2.269795, loss_ss: 1.604900, loss_d: 0.664895
0.0769 --- loss: 1.974305, loss_ss: 1.642572, loss_d: 0.331733
0.1153 --- loss: 1.915192, loss_ss: 1.403416, loss_d: 0.511776
0.1537 --- loss: 1.797403, loss_ss: 1.413974, loss_d: 0.383428
0.1922 --- loss: 1.920090, loss_ss: 1.303223, loss_d: 0.616867
0.2306 --- loss: 1.890674, loss_ss: 1.316404, loss_d: 0.574270
0.2690 --- loss: 2.081711, loss_ss: 1.496517, loss_d: 0.585195
0.3075 --- loss: 1.936466, loss_ss: 1.308378, loss_d: 0.628087
0.3459 --- loss: 1.932342, loss_ss: 1.475805, loss_d: 0.456537
0.3843 --- loss: 1.903553, loss_ss: 1.382934, loss_d: 0.520620
0.4228 --- loss: 1.888198, loss_ss: 1.305638, loss_d: 0.582560
0.4612 --- loss: 1.990783, loss_ss: 1.375520, loss_d: 0.615262
0.4996 --- loss: 1.931316, loss_ss: 1.366755, loss_d: 0.564561
0.5380 --- loss: 2.218116, loss_ss: 1.310191, loss_d: 0.907925
0.5765 --- loss: 1.885644, loss_ss: 1.361883, loss_d: 0.523761
0.6149 --- loss: 1.970420, loss_ss: 1.239757, loss_d: 0.730663
0.6533 --- loss: 1.860951, loss_ss: 1.290741, loss_d: 0.570210
0.6918 --- loss: 2.025249, loss_ss: 1.348716, loss_d: 0.676532
0.7302 --- loss: 1.802395, loss_ss: 1.257635, loss_d: 0.544761
0.7686 --- loss: 2.111424, loss_ss: 1.453817, loss_d: 0.657607
0.8071 --- loss: 1.531146, loss_ss: 1.078695, loss_d: 0.452451
0.8455 --- loss: 2.262600, loss_ss: 1.464661, loss_d: 0.797939
0.8839 --- loss: 1.710061, loss_ss: 1.029828, loss_d: 0.680233
0.9224 --- loss: 2.022709, loss_ss: 1.306738, loss_d: 0.715971
0.9608 --- loss: 1.700376, loss_ss: 1.076288, loss_d: 0.624088
0.9992 --- loss: 1.762501, loss_ss: 1.508138, loss_d: 0.254363
Epoch finished! Loss: 1.9398677408695222
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.975174, loss_ss: 1.298617, loss_d: 0.676557
0.0384 --- loss: 1.764469, loss_ss: 1.302828, loss_d: 0.461641
0.0769 --- loss: 1.715433, loss_ss: 1.056226, loss_d: 0.659207
0.1153 --- loss: 1.810372, loss_ss: 1.187858, loss_d: 0.622514
0.1537 --- loss: 1.760565, loss_ss: 1.313247, loss_d: 0.447318
0.1922 --- loss: 1.798608, loss_ss: 1.322675, loss_d: 0.475934
0.2306 --- loss: 1.830948, loss_ss: 1.397626, loss_d: 0.433321
0.2690 --- loss: 1.595565, loss_ss: 1.010880, loss_d: 0.584685
0.3075 --- loss: 1.797756, loss_ss: 1.377215, loss_d: 0.420540
0.3459 --- loss: 1.814688, loss_ss: 1.029366, loss_d: 0.785322
0.3843 --- loss: 1.841413, loss_ss: 1.308853, loss_d: 0.532560
0.4228 --- loss: 1.381254, loss_ss: 0.935889, loss_d: 0.445365
0.4612 --- loss: 1.801841, loss_ss: 1.150647, loss_d: 0.651194
0.4996 --- loss: 1.945252, loss_ss: 1.180313, loss_d: 0.764939
0.5380 --- loss: 1.458208, loss_ss: 0.871671, loss_d: 0.586537
0.5765 --- loss: 1.376637, loss_ss: 0.856279, loss_d: 0.520359
0.6149 --- loss: 1.839112, loss_ss: 1.152625, loss_d: 0.686487
0.6533 --- loss: 1.519418, loss_ss: 1.115940, loss_d: 0.403478
0.6918 --- loss: 1.542984, loss_ss: 1.195196, loss_d: 0.347788
0.7302 --- loss: 1.773690, loss_ss: 1.216766, loss_d: 0.556924
0.7686 --- loss: 1.725275, loss_ss: 0.929883, loss_d: 0.795392
0.8071 --- loss: 1.934303, loss_ss: 1.178835, loss_d: 0.755468
0.8455 --- loss: 1.624052, loss_ss: 1.158844, loss_d: 0.465208
0.8839 --- loss: 1.717429, loss_ss: 1.230509, loss_d: 0.486920
0.9224 --- loss: 1.591486, loss_ss: 1.211519, loss_d: 0.379967
0.9608 --- loss: 1.631570, loss_ss: 1.129558, loss_d: 0.502012
0.9992 --- loss: 2.696465, loss_ss: 1.865438, loss_d: 0.831026
Epoch finished! Loss: 1.727420855485476
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.549981, loss_ss: 0.863435, loss_d: 0.686546
0.0384 --- loss: 1.395977, loss_ss: 0.961314, loss_d: 0.434662
0.0769 --- loss: 1.549459, loss_ss: 1.067202, loss_d: 0.482257
0.1153 --- loss: 1.616998, loss_ss: 1.093777, loss_d: 0.523220
0.1537 --- loss: 1.783468, loss_ss: 1.085504, loss_d: 0.697964
0.1922 --- loss: 1.938535, loss_ss: 1.221802, loss_d: 0.716733
0.2306 --- loss: 1.491938, loss_ss: 0.982373, loss_d: 0.509565
0.2690 --- loss: 1.488720, loss_ss: 1.155287, loss_d: 0.333433
0.3075 --- loss: 1.847405, loss_ss: 1.154206, loss_d: 0.693200
0.3459 --- loss: 1.865501, loss_ss: 1.291594, loss_d: 0.573907
0.3843 --- loss: 1.401461, loss_ss: 0.972537, loss_d: 0.428925
0.4228 --- loss: 1.898547, loss_ss: 0.896159, loss_d: 1.002388
0.4612 --- loss: 2.186610, loss_ss: 1.143457, loss_d: 1.043153
0.4996 --- loss: 1.606767, loss_ss: 1.294441, loss_d: 0.312326
0.5380 --- loss: 1.535182, loss_ss: 1.050478, loss_d: 0.484704
0.5765 --- loss: 1.578304, loss_ss: 1.168565, loss_d: 0.409739
0.6149 --- loss: 1.870740, loss_ss: 1.162066, loss_d: 0.708674
0.6533 --- loss: 1.504528, loss_ss: 1.085453, loss_d: 0.419075
0.6918 --- loss: 1.825844, loss_ss: 1.308355, loss_d: 0.517489
0.7302 --- loss: 1.221822, loss_ss: 0.932224, loss_d: 0.289598
0.7686 --- loss: 1.940702, loss_ss: 1.218323, loss_d: 0.722380
0.8071 --- loss: 1.636781, loss_ss: 1.022440, loss_d: 0.614341
0.8455 --- loss: 1.337206, loss_ss: 0.862328, loss_d: 0.474878
0.8839 --- loss: 1.355793, loss_ss: 0.901471, loss_d: 0.454322
0.9224 --- loss: 2.046073, loss_ss: 1.423655, loss_d: 0.622418
0.9608 --- loss: 2.101681, loss_ss: 1.223099, loss_d: 0.878582
0.9992 --- loss: 1.949796, loss_ss: 1.378023, loss_d: 0.571772
Epoch finished! Loss: 1.6455076332275684
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.832432, loss_ss: 1.143388, loss_d: 0.689044
0.0384 --- loss: 1.616393, loss_ss: 1.005298, loss_d: 0.611095
0.0769 --- loss: 1.171473, loss_ss: 0.914372, loss_d: 0.257100
0.1153 --- loss: 1.186439, loss_ss: 0.906762, loss_d: 0.279678
0.1537 --- loss: 1.804413, loss_ss: 0.942504, loss_d: 0.861909
0.1922 --- loss: 1.687169, loss_ss: 0.926367, loss_d: 0.760802
0.2306 --- loss: 1.652606, loss_ss: 1.050918, loss_d: 0.601688
0.2690 --- loss: 1.423003, loss_ss: 0.918293, loss_d: 0.504711
0.3075 --- loss: 1.464738, loss_ss: 0.932574, loss_d: 0.532164
0.3459 --- loss: 1.373069, loss_ss: 0.940493, loss_d: 0.432576
0.3843 --- loss: 1.994440, loss_ss: 1.488401, loss_d: 0.506039
0.4228 --- loss: 1.793825, loss_ss: 1.138006, loss_d: 0.655818
0.4612 --- loss: 1.565145, loss_ss: 0.921556, loss_d: 0.643589
0.4996 --- loss: 1.469920, loss_ss: 0.888795, loss_d: 0.581125
0.5380 --- loss: 1.427705, loss_ss: 0.979992, loss_d: 0.447713
0.5765 --- loss: 1.579434, loss_ss: 0.876695, loss_d: 0.702739
0.6149 --- loss: 1.458574, loss_ss: 0.981229, loss_d: 0.477345
0.6533 --- loss: 1.498994, loss_ss: 0.850245, loss_d: 0.648750
0.6918 --- loss: 1.684144, loss_ss: 1.083270, loss_d: 0.600874
0.7302 --- loss: 1.478634, loss_ss: 0.737241, loss_d: 0.741394
0.7686 --- loss: 1.773579, loss_ss: 1.412291, loss_d: 0.361288
0.8071 --- loss: 1.421850, loss_ss: 0.959897, loss_d: 0.461953
0.8455 --- loss: 1.784983, loss_ss: 1.025317, loss_d: 0.759666
0.8839 --- loss: 1.352895, loss_ss: 0.837833, loss_d: 0.515062
0.9224 --- loss: 1.765495, loss_ss: 0.962554, loss_d: 0.802941
0.9608 --- loss: 1.412359, loss_ss: 0.894891, loss_d: 0.517467
0.9992 --- loss: 2.949625, loss_ss: 1.872544, loss_d: 1.077081
Epoch finished! Loss: 1.5854231926111075
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.429446, loss_ss: 0.737836, loss_d: 0.691610
0.0384 --- loss: 1.408233, loss_ss: 0.802723, loss_d: 0.605510
0.0769 --- loss: 1.540310, loss_ss: 0.805663, loss_d: 0.734647
0.1153 --- loss: 1.494797, loss_ss: 0.817972, loss_d: 0.676825
0.1537 --- loss: 1.361942, loss_ss: 0.761395, loss_d: 0.600547
0.1922 --- loss: 1.537084, loss_ss: 1.000172, loss_d: 0.536913
0.2306 --- loss: 1.223355, loss_ss: 0.775454, loss_d: 0.447901
0.2690 --- loss: 1.641259, loss_ss: 1.019541, loss_d: 0.621717
0.3075 --- loss: 1.247040, loss_ss: 0.859842, loss_d: 0.387198
0.3459 --- loss: 1.488540, loss_ss: 0.958100, loss_d: 0.530440
0.3843 --- loss: 1.832042, loss_ss: 0.981313, loss_d: 0.850729
0.4228 --- loss: 2.150086, loss_ss: 1.578071, loss_d: 0.572015
0.4612 --- loss: 1.536237, loss_ss: 1.138853, loss_d: 0.397383
0.4996 --- loss: 1.427817, loss_ss: 0.833058, loss_d: 0.594759
0.5380 --- loss: 1.614484, loss_ss: 1.123620, loss_d: 0.490864
0.5765 --- loss: 1.767515, loss_ss: 1.179096, loss_d: 0.588419
0.6149 --- loss: 1.427787, loss_ss: 1.067753, loss_d: 0.360033
0.6533 --- loss: 1.148910, loss_ss: 0.618294, loss_d: 0.530616
0.6918 --- loss: 1.811434, loss_ss: 0.905786, loss_d: 0.905649
0.7302 --- loss: 1.708278, loss_ss: 0.947309, loss_d: 0.760969
0.7686 --- loss: 1.296781, loss_ss: 0.695634, loss_d: 0.601147
0.8071 --- loss: 1.670413, loss_ss: 1.118526, loss_d: 0.551887
0.8455 --- loss: 1.711910, loss_ss: 1.103093, loss_d: 0.608818
0.8839 --- loss: 1.255526, loss_ss: 0.690628, loss_d: 0.564898
0.9224 --- loss: 1.616926, loss_ss: 0.859077, loss_d: 0.757849
0.9608 --- loss: 1.602456, loss_ss: 1.145073, loss_d: 0.457383
0.9992 --- loss: 1.862461, loss_ss: 1.298218, loss_d: 0.564242
Epoch finished! Loss: 1.5281641212793498
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.663147, loss_ss: 0.809435, loss_d: 0.853712
0.0384 --- loss: 1.612139, loss_ss: 1.007106, loss_d: 0.605033
0.0769 --- loss: 1.404780, loss_ss: 0.790618, loss_d: 0.614162
0.1153 --- loss: 1.280351, loss_ss: 0.683649, loss_d: 0.596702
0.1537 --- loss: 1.607340, loss_ss: 0.819450, loss_d: 0.787889
0.1922 --- loss: 1.325694, loss_ss: 0.973238, loss_d: 0.352457
0.2306 --- loss: 1.069278, loss_ss: 0.633459, loss_d: 0.435819
0.2690 --- loss: 1.404705, loss_ss: 0.906054, loss_d: 0.498650
0.3075 --- loss: 1.950008, loss_ss: 0.846266, loss_d: 1.103742
0.3459 --- loss: 1.746610, loss_ss: 1.025525, loss_d: 0.721085
0.3843 --- loss: 1.498224, loss_ss: 1.014792, loss_d: 0.483432
0.4228 --- loss: 1.400823, loss_ss: 0.716088, loss_d: 0.684735
0.4612 --- loss: 1.677052, loss_ss: 0.954992, loss_d: 0.722061
0.4996 --- loss: 1.526439, loss_ss: 0.910280, loss_d: 0.616159
0.5380 --- loss: 1.555328, loss_ss: 0.935609, loss_d: 0.619719
0.5765 --- loss: 1.262487, loss_ss: 0.780113, loss_d: 0.482374
0.6149 --- loss: 1.845081, loss_ss: 1.321823, loss_d: 0.523258
0.6533 --- loss: 1.193972, loss_ss: 0.928668, loss_d: 0.265304
0.6918 --- loss: 1.854401, loss_ss: 1.116323, loss_d: 0.738078
0.7302 --- loss: 1.505715, loss_ss: 0.868447, loss_d: 0.637267
0.7686 --- loss: 1.297443, loss_ss: 0.969591, loss_d: 0.327852
0.8071 --- loss: 1.337551, loss_ss: 0.849486, loss_d: 0.488065
0.8455 --- loss: 1.367463, loss_ss: 0.883274, loss_d: 0.484189
0.8839 --- loss: 1.506798, loss_ss: 1.067366, loss_d: 0.439432
0.9224 --- loss: 1.411943, loss_ss: 0.999203, loss_d: 0.412740
0.9608 --- loss: 1.501877, loss_ss: 0.931762, loss_d: 0.570115
0.9992 --- loss: 1.897183, loss_ss: 0.949878, loss_d: 0.947305
Epoch finished! Loss: 1.4800876007630275
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.697143, loss_ss: 1.365341, loss_d: 0.331802
0.0384 --- loss: 1.293601, loss_ss: 0.759807, loss_d: 0.533794
0.0769 --- loss: 1.554014, loss_ss: 0.992040, loss_d: 0.561974
0.1153 --- loss: 1.728003, loss_ss: 1.014148, loss_d: 0.713855
0.1537 --- loss: 1.695218, loss_ss: 0.949265, loss_d: 0.745953
0.1922 --- loss: 1.468913, loss_ss: 0.778903, loss_d: 0.690010
0.2306 --- loss: 1.171635, loss_ss: 0.649697, loss_d: 0.521937
0.2690 --- loss: 1.691842, loss_ss: 1.072404, loss_d: 0.619438
0.3075 --- loss: 1.493604, loss_ss: 0.831519, loss_d: 0.662085
0.3459 --- loss: 1.069630, loss_ss: 0.702311, loss_d: 0.367319
0.3843 --- loss: 1.747034, loss_ss: 1.011908, loss_d: 0.735125
0.4228 --- loss: 1.271059, loss_ss: 0.765496, loss_d: 0.505563
0.4612 --- loss: 1.228190, loss_ss: 0.847692, loss_d: 0.380499
0.4996 --- loss: 1.552736, loss_ss: 0.833162, loss_d: 0.719574
0.5380 --- loss: 2.021146, loss_ss: 0.846717, loss_d: 1.174428
0.5765 --- loss: 1.399094, loss_ss: 0.967383, loss_d: 0.431711
0.6149 --- loss: 1.228202, loss_ss: 0.791810, loss_d: 0.436392
0.6533 --- loss: 1.660022, loss_ss: 1.090407, loss_d: 0.569614
0.6918 --- loss: 1.142100, loss_ss: 0.805467, loss_d: 0.336632
0.7302 --- loss: 0.926050, loss_ss: 0.634804, loss_d: 0.291246
0.7686 --- loss: 1.132762, loss_ss: 0.746167, loss_d: 0.386595
0.8071 --- loss: 1.786625, loss_ss: 0.924133, loss_d: 0.862492
0.8455 --- loss: 1.109088, loss_ss: 0.726516, loss_d: 0.382572
0.8839 --- loss: 1.678854, loss_ss: 1.048614, loss_d: 0.630240
0.9224 --- loss: 1.746461, loss_ss: 0.999398, loss_d: 0.747064
0.9608 --- loss: 1.423970, loss_ss: 1.034860, loss_d: 0.389110
0.9992 --- loss: 1.929458, loss_ss: 1.328716, loss_d: 0.600742
Epoch finished! Loss: 1.440564421736277
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.393082, loss_ss: 0.895953, loss_d: 0.497129
0.0384 --- loss: 1.149560, loss_ss: 0.669838, loss_d: 0.479722
0.0769 --- loss: 1.105245, loss_ss: 0.708882, loss_d: 0.396363
0.1153 --- loss: 1.292882, loss_ss: 0.963118, loss_d: 0.329764
0.1537 --- loss: 1.093158, loss_ss: 0.637278, loss_d: 0.455880
0.1922 --- loss: 1.283906, loss_ss: 0.824403, loss_d: 0.459503
0.2306 --- loss: 1.315053, loss_ss: 0.886606, loss_d: 0.428447
0.2690 --- loss: 1.261651, loss_ss: 0.819735, loss_d: 0.441916
0.3075 --- loss: 1.187921, loss_ss: 0.870295, loss_d: 0.317627
0.3459 --- loss: 1.178172, loss_ss: 0.897781, loss_d: 0.280391
0.3843 --- loss: 1.160761, loss_ss: 0.689758, loss_d: 0.471002
0.4228 --- loss: 1.538705, loss_ss: 1.091027, loss_d: 0.447677
0.4612 --- loss: 1.376342, loss_ss: 1.032733, loss_d: 0.343609
0.4996 --- loss: 1.276437, loss_ss: 0.795737, loss_d: 0.480700
0.5380 --- loss: 1.135748, loss_ss: 0.851575, loss_d: 0.284173
0.5765 --- loss: 1.409737, loss_ss: 1.106563, loss_d: 0.303173
0.6149 --- loss: 1.513164, loss_ss: 1.000017, loss_d: 0.513146
0.6533 --- loss: 1.652011, loss_ss: 0.877341, loss_d: 0.774670
0.6918 --- loss: 1.089863, loss_ss: 0.765093, loss_d: 0.324770
0.7302 --- loss: 0.955219, loss_ss: 0.644066, loss_d: 0.311153
0.7686 --- loss: 1.453318, loss_ss: 0.949921, loss_d: 0.503397
0.8071 --- loss: 1.659845, loss_ss: 1.243544, loss_d: 0.416301
0.8455 --- loss: 1.230378, loss_ss: 0.913021, loss_d: 0.317357
0.8839 --- loss: 1.341417, loss_ss: 1.000575, loss_d: 0.340842
0.9224 --- loss: 1.370836, loss_ss: 0.957543, loss_d: 0.413294
0.9608 --- loss: 1.126188, loss_ss: 0.738238, loss_d: 0.387950
0.9992 --- loss: 2.966485, loss_ss: 1.255573, loss_d: 1.710912
Epoch finished! Loss: 1.3690606463413972
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.508529, loss_ss: 1.109066, loss_d: 0.399463
0.0384 --- loss: 1.205205, loss_ss: 0.730021, loss_d: 0.475184
0.0769 --- loss: 1.341952, loss_ss: 0.918369, loss_d: 0.423582
0.1153 --- loss: 1.003650, loss_ss: 0.748584, loss_d: 0.255066
0.1537 --- loss: 1.043531, loss_ss: 0.672507, loss_d: 0.371024
0.1922 --- loss: 1.192535, loss_ss: 0.763806, loss_d: 0.428728
0.2306 --- loss: 1.264139, loss_ss: 0.885192, loss_d: 0.378947
0.2690 --- loss: 1.220575, loss_ss: 0.959707, loss_d: 0.260868
0.3075 --- loss: 1.826809, loss_ss: 0.909202, loss_d: 0.917607
0.3459 --- loss: 1.416145, loss_ss: 1.005027, loss_d: 0.411119
0.3843 --- loss: 1.578002, loss_ss: 1.113273, loss_d: 0.464729
0.4228 --- loss: 0.948209, loss_ss: 0.650171, loss_d: 0.298038
0.4612 --- loss: 1.358250, loss_ss: 0.659185, loss_d: 0.699065
0.4996 --- loss: 1.405546, loss_ss: 0.859686, loss_d: 0.545860
0.5380 --- loss: 1.023842, loss_ss: 0.747006, loss_d: 0.276836
0.5765 --- loss: 1.482763, loss_ss: 1.009232, loss_d: 0.473531
0.6149 --- loss: 1.706136, loss_ss: 0.775412, loss_d: 0.930724
0.6533 --- loss: 1.301106, loss_ss: 1.051845, loss_d: 0.249261
0.6918 --- loss: 1.086347, loss_ss: 0.789909, loss_d: 0.296438
0.7302 --- loss: 1.201761, loss_ss: 0.849211, loss_d: 0.352550
0.7686 --- loss: 1.526414, loss_ss: 1.077875, loss_d: 0.448538
0.8071 --- loss: 1.243477, loss_ss: 0.684631, loss_d: 0.558846
0.8455 --- loss: 1.262422, loss_ss: 0.794717, loss_d: 0.467705
0.8839 --- loss: 1.008922, loss_ss: 0.786453, loss_d: 0.222469
0.9224 --- loss: 1.235500, loss_ss: 0.808636, loss_d: 0.426864
0.9608 --- loss: 1.251118, loss_ss: 1.032133, loss_d: 0.218986
0.9992 --- loss: 3.114640, loss_ss: 0.780055, loss_d: 2.334585
Epoch finished! Loss: 1.2801788857349983
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.157812, loss_ss: 0.678696, loss_d: 0.479115
0.0384 --- loss: 1.025423, loss_ss: 0.777191, loss_d: 0.248232
0.0769 --- loss: 1.046850, loss_ss: 0.836382, loss_d: 0.210469
0.1153 --- loss: 1.243298, loss_ss: 0.666085, loss_d: 0.577214
0.1537 --- loss: 0.930377, loss_ss: 0.710250, loss_d: 0.220128
0.1922 --- loss: 0.898815, loss_ss: 0.605539, loss_d: 0.293276
0.2306 --- loss: 1.181417, loss_ss: 0.669033, loss_d: 0.512384
0.2690 --- loss: 1.252855, loss_ss: 0.795859, loss_d: 0.456996
0.3075 --- loss: 0.902283, loss_ss: 0.708189, loss_d: 0.194094
0.3459 --- loss: 1.114170, loss_ss: 0.716621, loss_d: 0.397549
0.3843 --- loss: 1.218381, loss_ss: 0.818565, loss_d: 0.399816
0.4228 --- loss: 1.304061, loss_ss: 1.030930, loss_d: 0.273131
0.4612 --- loss: 1.463568, loss_ss: 1.194351, loss_d: 0.269217
0.4996 --- loss: 1.287258, loss_ss: 0.736882, loss_d: 0.550376
0.5380 --- loss: 1.241307, loss_ss: 0.676054, loss_d: 0.565252
0.5765 --- loss: 1.377831, loss_ss: 0.892845, loss_d: 0.484986
0.6149 --- loss: 1.090724, loss_ss: 0.911568, loss_d: 0.179155
0.6533 --- loss: 1.057436, loss_ss: 0.759417, loss_d: 0.298019
0.6918 --- loss: 0.944797, loss_ss: 0.736645, loss_d: 0.208152
0.7302 --- loss: 1.150589, loss_ss: 0.830445, loss_d: 0.320144
0.7686 --- loss: 1.129170, loss_ss: 0.733527, loss_d: 0.395644
0.8071 --- loss: 1.311082, loss_ss: 0.793592, loss_d: 0.517490
0.8455 --- loss: 1.470330, loss_ss: 1.034887, loss_d: 0.435443
0.8839 --- loss: 1.460000, loss_ss: 1.043663, loss_d: 0.416336
0.9224 --- loss: 0.941024, loss_ss: 0.620377, loss_d: 0.320648
0.9608 --- loss: 1.532398, loss_ss: 0.904940, loss_d: 0.627457
0.9992 --- loss: 1.093752, loss_ss: 0.486693, loss_d: 0.607059
Epoch finished! Loss: 1.2508245037152217
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.5861111111111111
             precision    recall  f1-score   support

        0.0       0.17      0.97      0.28        30
        1.0       0.33      0.01      0.03       136
        2.0       0.68      0.38      0.49       404
        3.0       0.62      0.86      0.72       239
        4.0       0.71      0.89      0.79       271

avg / total       0.62      0.59      0.55      1080
 


====== chp051-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  86.48  96.67   86.19  16.67     28.43
1  87.22   1.47   99.58  33.33      2.82
2  70.19  38.37   89.20  67.98     49.05
3  85.19  86.19   84.90  61.86     72.03
4  88.15  88.93   87.89  71.09     79.02
Total accuracy: 58.61%
Average sen: 62.33%
Average spec: 89.55%
Macro f1-score: 46.27%
Diagnosis acc on 15mins: 1.0
[0.95983726 0.97400916 0.98179299 0.88471228 0.91886985 0.8445406
 0.90571517 0.88119757 0.83785093 0.91639054 0.99111921 0.98800671
 0.93809724 0.9239291  0.97661144 0.98491675 0.97838575 0.90656769
 0.9137693  0.88922369 0.892452   0.96674466 0.92127353 0.98770088
 0.96479422 0.97861391 0.85350966 0.87080061 0.89796054 0.86539751
 0.95222598 0.89101589 0.93642223 0.95942384 0.9287082  0.9889397 ]
pred: 0.9292090717289183, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp052-nsrr. train_data(2605), test_data(33) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.279841, loss_ss: 1.593063, loss_d: 0.686778
0.0384 --- loss: 2.133183, loss_ss: 1.589020, loss_d: 0.544163
0.0768 --- loss: 2.122391, loss_ss: 1.564097, loss_d: 0.558295
0.1152 --- loss: 2.126091, loss_ss: 1.514008, loss_d: 0.612083
0.1536 --- loss: 2.208869, loss_ss: 1.592131, loss_d: 0.616738
0.1919 --- loss: 1.868158, loss_ss: 1.410637, loss_d: 0.457521
0.2303 --- loss: 2.429821, loss_ss: 1.576814, loss_d: 0.853007
0.2687 --- loss: 2.129485, loss_ss: 1.431179, loss_d: 0.698306
0.3071 --- loss: 2.054527, loss_ss: 1.390913, loss_d: 0.663614
0.3455 --- loss: 2.109475, loss_ss: 1.355397, loss_d: 0.754077
0.3839 --- loss: 1.731760, loss_ss: 1.446623, loss_d: 0.285136
0.4223 --- loss: 2.100894, loss_ss: 1.291723, loss_d: 0.809171
0.4607 --- loss: 1.932243, loss_ss: 1.447497, loss_d: 0.484746
0.4990 --- loss: 1.945591, loss_ss: 1.507344, loss_d: 0.438247
0.5374 --- loss: 1.793774, loss_ss: 1.355069, loss_d: 0.438705
0.5758 --- loss: 2.020602, loss_ss: 1.191893, loss_d: 0.828709
0.6142 --- loss: 1.788778, loss_ss: 1.318509, loss_d: 0.470268
0.6526 --- loss: 1.903376, loss_ss: 1.246182, loss_d: 0.657194
0.6910 --- loss: 1.849078, loss_ss: 1.296742, loss_d: 0.552336
0.7294 --- loss: 1.858652, loss_ss: 1.490398, loss_d: 0.368254
0.7678 --- loss: 1.800445, loss_ss: 1.341900, loss_d: 0.458545
0.8061 --- loss: 2.118937, loss_ss: 1.506642, loss_d: 0.612296
0.8445 --- loss: 2.064331, loss_ss: 1.501778, loss_d: 0.562553
0.8829 --- loss: 1.967808, loss_ss: 1.131552, loss_d: 0.836256
0.9213 --- loss: 1.722183, loss_ss: 1.269618, loss_d: 0.452565
0.9597 --- loss: 1.843517, loss_ss: 1.192725, loss_d: 0.650792
0.9981 --- loss: 2.188487, loss_ss: 1.802193, loss_d: 0.386294
Epoch finished! Loss: 1.9842568035309132
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.674878, loss_ss: 1.195789, loss_d: 0.479089
0.0384 --- loss: 1.858890, loss_ss: 1.075063, loss_d: 0.783827
0.0768 --- loss: 1.850431, loss_ss: 1.247622, loss_d: 0.602809
0.1152 --- loss: 2.059706, loss_ss: 0.993086, loss_d: 1.066620
0.1536 --- loss: 1.672233, loss_ss: 1.231376, loss_d: 0.440856
0.1919 --- loss: 1.817405, loss_ss: 1.106123, loss_d: 0.711282
0.2303 --- loss: 1.660883, loss_ss: 1.163152, loss_d: 0.497731
0.2687 --- loss: 1.707457, loss_ss: 1.257187, loss_d: 0.450270
0.3071 --- loss: 1.598907, loss_ss: 1.049840, loss_d: 0.549067
0.3455 --- loss: 1.923276, loss_ss: 1.441801, loss_d: 0.481475
0.3839 --- loss: 2.224946, loss_ss: 1.370077, loss_d: 0.854870
0.4223 --- loss: 1.595106, loss_ss: 0.969899, loss_d: 0.625206
0.4607 --- loss: 1.864586, loss_ss: 1.248630, loss_d: 0.615956
0.4990 --- loss: 1.605174, loss_ss: 1.078106, loss_d: 0.527067
0.5374 --- loss: 1.712265, loss_ss: 1.164289, loss_d: 0.547976
0.5758 --- loss: 1.687184, loss_ss: 1.142421, loss_d: 0.544763
0.6142 --- loss: 1.845978, loss_ss: 1.247822, loss_d: 0.598157
0.6526 --- loss: 1.810097, loss_ss: 1.424790, loss_d: 0.385307
0.6910 --- loss: 2.024968, loss_ss: 1.163391, loss_d: 0.861577
0.7294 --- loss: 1.788475, loss_ss: 1.195944, loss_d: 0.592530
0.7678 --- loss: 1.765000, loss_ss: 1.095081, loss_d: 0.669919
0.8061 --- loss: 1.475804, loss_ss: 0.989496, loss_d: 0.486308
0.8445 --- loss: 1.477920, loss_ss: 1.256824, loss_d: 0.221096
0.8829 --- loss: 1.458263, loss_ss: 1.078361, loss_d: 0.379902
0.9213 --- loss: 1.482321, loss_ss: 1.129600, loss_d: 0.352721
0.9597 --- loss: 1.800876, loss_ss: 1.031735, loss_d: 0.769141
0.9981 --- loss: 1.850135, loss_ss: 1.219849, loss_d: 0.630286
Epoch finished! Loss: 1.7398436757234426
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.823187, loss_ss: 1.421043, loss_d: 0.402144
0.0384 --- loss: 1.348067, loss_ss: 0.940156, loss_d: 0.407912
0.0768 --- loss: 1.847522, loss_ss: 1.241604, loss_d: 0.605918
0.1152 --- loss: 1.599233, loss_ss: 1.323578, loss_d: 0.275656
0.1536 --- loss: 1.746841, loss_ss: 1.326619, loss_d: 0.420222
0.1919 --- loss: 1.716789, loss_ss: 1.189861, loss_d: 0.526928
0.2303 --- loss: 1.420194, loss_ss: 1.042782, loss_d: 0.377412
0.2687 --- loss: 1.523956, loss_ss: 0.839541, loss_d: 0.684415
0.3071 --- loss: 1.498745, loss_ss: 0.947630, loss_d: 0.551115
0.3455 --- loss: 1.318578, loss_ss: 0.846402, loss_d: 0.472176
0.3839 --- loss: 1.423013, loss_ss: 1.045940, loss_d: 0.377073
0.4223 --- loss: 1.804019, loss_ss: 1.057915, loss_d: 0.746104
0.4607 --- loss: 1.856558, loss_ss: 0.898070, loss_d: 0.958488
0.4990 --- loss: 1.650989, loss_ss: 1.084255, loss_d: 0.566735
0.5374 --- loss: 1.434357, loss_ss: 0.883560, loss_d: 0.550798
0.5758 --- loss: 1.541298, loss_ss: 1.238081, loss_d: 0.303217
0.6142 --- loss: 1.487917, loss_ss: 1.071289, loss_d: 0.416628
0.6526 --- loss: 1.232012, loss_ss: 0.928155, loss_d: 0.303857
0.6910 --- loss: 1.971627, loss_ss: 1.036364, loss_d: 0.935263
0.7294 --- loss: 1.729334, loss_ss: 1.137066, loss_d: 0.592269
0.7678 --- loss: 1.730393, loss_ss: 1.005073, loss_d: 0.725320
0.8061 --- loss: 1.583317, loss_ss: 1.063064, loss_d: 0.520253
0.8445 --- loss: 2.021849, loss_ss: 1.378281, loss_d: 0.643568
0.8829 --- loss: 1.667217, loss_ss: 1.127639, loss_d: 0.539577
0.9213 --- loss: 1.660990, loss_ss: 1.185763, loss_d: 0.475227
0.9597 --- loss: 1.458945, loss_ss: 1.141711, loss_d: 0.317234
0.9981 --- loss: 1.507198, loss_ss: 0.806339, loss_d: 0.700859
Epoch finished! Loss: 1.5771863162517548
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.792363, loss_ss: 1.225510, loss_d: 0.566853
0.0384 --- loss: 1.116697, loss_ss: 0.867251, loss_d: 0.249445
0.0768 --- loss: 1.279791, loss_ss: 0.861442, loss_d: 0.418349
0.1152 --- loss: 1.714417, loss_ss: 1.096964, loss_d: 0.617453
0.1536 --- loss: 1.367672, loss_ss: 0.921250, loss_d: 0.446422
0.1919 --- loss: 1.013433, loss_ss: 0.762213, loss_d: 0.251221
0.2303 --- loss: 1.399944, loss_ss: 0.975429, loss_d: 0.424516
0.2687 --- loss: 2.121334, loss_ss: 0.983383, loss_d: 1.137950
0.3071 --- loss: 1.037352, loss_ss: 0.835962, loss_d: 0.201390
0.3455 --- loss: 1.223394, loss_ss: 0.859453, loss_d: 0.363942
0.3839 --- loss: 1.128864, loss_ss: 0.846740, loss_d: 0.282125
0.4223 --- loss: 1.733076, loss_ss: 1.228120, loss_d: 0.504956
0.4607 --- loss: 1.760295, loss_ss: 0.967002, loss_d: 0.793293
0.4990 --- loss: 1.305314, loss_ss: 0.798701, loss_d: 0.506613
0.5374 --- loss: 1.621989, loss_ss: 1.009901, loss_d: 0.612088
0.5758 --- loss: 1.648190, loss_ss: 0.986110, loss_d: 0.662080
0.6142 --- loss: 1.631511, loss_ss: 1.024839, loss_d: 0.606672
0.6526 --- loss: 1.579674, loss_ss: 0.911421, loss_d: 0.668254
0.6910 --- loss: 1.260401, loss_ss: 0.972516, loss_d: 0.287885
0.7294 --- loss: 1.702410, loss_ss: 1.049899, loss_d: 0.652511
0.7678 --- loss: 1.213435, loss_ss: 0.858750, loss_d: 0.354685
0.8061 --- loss: 1.233167, loss_ss: 0.865996, loss_d: 0.367171
0.8445 --- loss: 1.234970, loss_ss: 0.789329, loss_d: 0.445641
0.8829 --- loss: 1.495719, loss_ss: 1.022640, loss_d: 0.473080
0.9213 --- loss: 1.237250, loss_ss: 0.858987, loss_d: 0.378262
0.9597 --- loss: 1.371813, loss_ss: 0.914557, loss_d: 0.457257
0.9981 --- loss: 1.405182, loss_ss: 0.995186, loss_d: 0.409995
Epoch finished! Loss: 1.4637731912044378
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.373328, loss_ss: 1.115652, loss_d: 0.257676
0.0384 --- loss: 1.091930, loss_ss: 0.766912, loss_d: 0.325019
0.0768 --- loss: 1.463494, loss_ss: 1.029350, loss_d: 0.434144
0.1152 --- loss: 1.471662, loss_ss: 1.053322, loss_d: 0.418340
0.1536 --- loss: 1.153653, loss_ss: 0.915258, loss_d: 0.238395
0.1919 --- loss: 1.174427, loss_ss: 0.764054, loss_d: 0.410373
0.2303 --- loss: 1.188031, loss_ss: 0.919438, loss_d: 0.268593
0.2687 --- loss: 1.727106, loss_ss: 1.271325, loss_d: 0.455781
0.3071 --- loss: 0.927775, loss_ss: 0.726056, loss_d: 0.201719
0.3455 --- loss: 1.339676, loss_ss: 0.876799, loss_d: 0.462877
0.3839 --- loss: 1.452213, loss_ss: 0.881356, loss_d: 0.570857
0.4223 --- loss: 1.473297, loss_ss: 0.883425, loss_d: 0.589871
0.4607 --- loss: 1.783579, loss_ss: 1.291890, loss_d: 0.491689
0.4990 --- loss: 1.381259, loss_ss: 1.020737, loss_d: 0.360521
0.5374 --- loss: 2.127934, loss_ss: 1.667332, loss_d: 0.460602
0.5758 --- loss: 1.091801, loss_ss: 0.637262, loss_d: 0.454539
0.6142 --- loss: 1.308880, loss_ss: 1.058191, loss_d: 0.250689
0.6526 --- loss: 1.380800, loss_ss: 0.876475, loss_d: 0.504325
0.6910 --- loss: 0.864301, loss_ss: 0.655033, loss_d: 0.209268
0.7294 --- loss: 1.733218, loss_ss: 1.313745, loss_d: 0.419474
0.7678 --- loss: 1.237160, loss_ss: 0.805610, loss_d: 0.431551
0.8061 --- loss: 1.347370, loss_ss: 1.132376, loss_d: 0.214994
0.8445 --- loss: 1.783226, loss_ss: 1.158315, loss_d: 0.624911
0.8829 --- loss: 0.848096, loss_ss: 0.636815, loss_d: 0.211281
0.9213 --- loss: 1.556446, loss_ss: 1.025286, loss_d: 0.531159
0.9597 --- loss: 1.399234, loss_ss: 0.773807, loss_d: 0.625427
0.9981 --- loss: 1.228962, loss_ss: 1.001595, loss_d: 0.227366
Epoch finished! Loss: 1.419591052027849
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.564548, loss_ss: 1.310625, loss_d: 0.253924
0.0384 --- loss: 1.427082, loss_ss: 1.016064, loss_d: 0.411018
0.0768 --- loss: 1.340918, loss_ss: 0.863945, loss_d: 0.476973
0.1152 --- loss: 1.347382, loss_ss: 0.769963, loss_d: 0.577418
0.1536 --- loss: 1.117249, loss_ss: 0.736484, loss_d: 0.380765
0.1919 --- loss: 1.199700, loss_ss: 0.981102, loss_d: 0.218598
0.2303 --- loss: 1.726371, loss_ss: 1.202264, loss_d: 0.524107
0.2687 --- loss: 1.364818, loss_ss: 0.902052, loss_d: 0.462766
0.3071 --- loss: 1.250918, loss_ss: 1.038362, loss_d: 0.212556
0.3455 --- loss: 1.157779, loss_ss: 0.922123, loss_d: 0.235656
0.3839 --- loss: 1.206459, loss_ss: 0.975208, loss_d: 0.231251
0.4223 --- loss: 1.259912, loss_ss: 0.783899, loss_d: 0.476014
0.4607 --- loss: 1.110017, loss_ss: 0.861158, loss_d: 0.248860
0.4990 --- loss: 1.104018, loss_ss: 0.753628, loss_d: 0.350390
0.5374 --- loss: 1.325798, loss_ss: 0.908660, loss_d: 0.417139
0.5758 --- loss: 1.083097, loss_ss: 0.853717, loss_d: 0.229380
0.6142 --- loss: 1.212551, loss_ss: 0.878636, loss_d: 0.333915
0.6526 --- loss: 1.085740, loss_ss: 0.848768, loss_d: 0.236972
0.6910 --- loss: 1.428384, loss_ss: 0.856908, loss_d: 0.571477
0.7294 --- loss: 0.981341, loss_ss: 0.706225, loss_d: 0.275115
0.7678 --- loss: 1.176383, loss_ss: 0.981672, loss_d: 0.194712
0.8061 --- loss: 0.953685, loss_ss: 0.805410, loss_d: 0.148275
0.8445 --- loss: 1.588965, loss_ss: 0.946826, loss_d: 0.642138
0.8829 --- loss: 1.075937, loss_ss: 0.737420, loss_d: 0.338518
0.9213 --- loss: 1.419321, loss_ss: 0.923581, loss_d: 0.495740
0.9597 --- loss: 1.296416, loss_ss: 0.792444, loss_d: 0.503971
0.9981 --- loss: 1.268409, loss_ss: 0.483492, loss_d: 0.784917
Epoch finished! Loss: 1.3562977369015032
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.016058, loss_ss: 0.685886, loss_d: 0.330172
0.0384 --- loss: 0.918016, loss_ss: 0.757527, loss_d: 0.160490
0.0768 --- loss: 1.434852, loss_ss: 0.791454, loss_d: 0.643398
0.1152 --- loss: 1.371220, loss_ss: 1.116773, loss_d: 0.254447
0.1536 --- loss: 1.340056, loss_ss: 0.949593, loss_d: 0.390463
0.1919 --- loss: 1.173744, loss_ss: 0.936977, loss_d: 0.236767
0.2303 --- loss: 1.223217, loss_ss: 0.720612, loss_d: 0.502606
0.2687 --- loss: 0.963752, loss_ss: 0.670687, loss_d: 0.293065
0.3071 --- loss: 0.972249, loss_ss: 0.687019, loss_d: 0.285230
0.3455 --- loss: 1.452545, loss_ss: 1.036894, loss_d: 0.415651
0.3839 --- loss: 1.356926, loss_ss: 0.948295, loss_d: 0.408631
0.4223 --- loss: 1.228989, loss_ss: 0.956246, loss_d: 0.272742
0.4607 --- loss: 1.741453, loss_ss: 1.439347, loss_d: 0.302106
0.4990 --- loss: 1.195569, loss_ss: 0.946558, loss_d: 0.249011
0.5374 --- loss: 1.226283, loss_ss: 0.850792, loss_d: 0.375491
0.5758 --- loss: 1.357870, loss_ss: 1.010541, loss_d: 0.347329
0.6142 --- loss: 1.321645, loss_ss: 0.709652, loss_d: 0.611993
0.6526 --- loss: 1.031674, loss_ss: 0.804993, loss_d: 0.226681
0.6910 --- loss: 1.573869, loss_ss: 1.058919, loss_d: 0.514950
0.7294 --- loss: 1.298212, loss_ss: 1.040803, loss_d: 0.257409
0.7678 --- loss: 1.270334, loss_ss: 1.118746, loss_d: 0.151588
0.8061 --- loss: 0.846140, loss_ss: 0.573129, loss_d: 0.273010
0.8445 --- loss: 1.240315, loss_ss: 0.726857, loss_d: 0.513458
0.8829 --- loss: 1.457325, loss_ss: 1.239651, loss_d: 0.217674
0.9213 --- loss: 1.030509, loss_ss: 0.885455, loss_d: 0.145054
0.9597 --- loss: 1.551477, loss_ss: 1.199408, loss_d: 0.352069
0.9981 --- loss: 1.592372, loss_ss: 1.388499, loss_d: 0.203873
Epoch finished! Loss: 1.31294985298927
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.033332, loss_ss: 0.875772, loss_d: 0.157560
0.0384 --- loss: 1.747315, loss_ss: 1.181933, loss_d: 0.565382
0.0768 --- loss: 1.162761, loss_ss: 0.851012, loss_d: 0.311750
0.1152 --- loss: 1.210482, loss_ss: 0.834290, loss_d: 0.376192
0.1536 --- loss: 0.920813, loss_ss: 0.645710, loss_d: 0.275102
0.1919 --- loss: 1.671085, loss_ss: 0.900128, loss_d: 0.770958
0.2303 --- loss: 1.066795, loss_ss: 0.828643, loss_d: 0.238151
0.2687 --- loss: 1.341079, loss_ss: 1.079971, loss_d: 0.261107
0.3071 --- loss: 1.046136, loss_ss: 0.717063, loss_d: 0.329073
0.3455 --- loss: 1.215966, loss_ss: 0.714340, loss_d: 0.501626
0.3839 --- loss: 1.217173, loss_ss: 0.787805, loss_d: 0.429368
0.4223 --- loss: 1.142821, loss_ss: 0.848071, loss_d: 0.294750
0.4607 --- loss: 1.294034, loss_ss: 0.947970, loss_d: 0.346064
0.4990 --- loss: 1.270170, loss_ss: 0.690058, loss_d: 0.580112
0.5374 --- loss: 0.975451, loss_ss: 0.696513, loss_d: 0.278937
0.5758 --- loss: 1.050683, loss_ss: 0.791975, loss_d: 0.258708
0.6142 --- loss: 2.134087, loss_ss: 0.834109, loss_d: 1.299979
0.6526 --- loss: 1.318825, loss_ss: 1.056278, loss_d: 0.262547
0.6910 --- loss: 1.328443, loss_ss: 0.754906, loss_d: 0.573537
0.7294 --- loss: 1.333817, loss_ss: 1.060123, loss_d: 0.273693
0.7678 --- loss: 1.046842, loss_ss: 0.655735, loss_d: 0.391107
0.8061 --- loss: 1.255102, loss_ss: 0.865089, loss_d: 0.390013
0.8445 --- loss: 1.638380, loss_ss: 0.905546, loss_d: 0.732834
0.8829 --- loss: 1.056008, loss_ss: 0.834891, loss_d: 0.221117
0.9213 --- loss: 1.624027, loss_ss: 1.165445, loss_d: 0.458583
0.9597 --- loss: 0.981982, loss_ss: 0.595355, loss_d: 0.386627
0.9981 --- loss: 0.766211, loss_ss: 0.555011, loss_d: 0.211200
Epoch finished! Loss: 1.2605114191770554
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.466374, loss_ss: 1.116952, loss_d: 0.349422
0.0384 --- loss: 1.346401, loss_ss: 0.774947, loss_d: 0.571454
0.0768 --- loss: 1.334454, loss_ss: 0.811951, loss_d: 0.522503
0.1152 --- loss: 0.978295, loss_ss: 0.689146, loss_d: 0.289149
0.1536 --- loss: 0.933227, loss_ss: 0.786503, loss_d: 0.146724
0.1919 --- loss: 0.847614, loss_ss: 0.608939, loss_d: 0.238675
0.2303 --- loss: 1.030616, loss_ss: 0.837824, loss_d: 0.192792
0.2687 --- loss: 1.208246, loss_ss: 1.118936, loss_d: 0.089310
0.3071 --- loss: 1.026463, loss_ss: 0.896384, loss_d: 0.130079
0.3455 --- loss: 1.355735, loss_ss: 0.655570, loss_d: 0.700165
0.3839 --- loss: 1.215399, loss_ss: 0.876976, loss_d: 0.338423
0.4223 --- loss: 1.779262, loss_ss: 0.840580, loss_d: 0.938682
0.4607 --- loss: 1.184662, loss_ss: 0.774535, loss_d: 0.410127
0.4990 --- loss: 1.036524, loss_ss: 0.841824, loss_d: 0.194701
0.5374 --- loss: 1.203044, loss_ss: 0.891376, loss_d: 0.311668
0.5758 --- loss: 1.697520, loss_ss: 0.717083, loss_d: 0.980436
0.6142 --- loss: 0.830060, loss_ss: 0.613030, loss_d: 0.217030
0.6526 --- loss: 1.561944, loss_ss: 1.267695, loss_d: 0.294249
0.6910 --- loss: 1.061315, loss_ss: 0.756783, loss_d: 0.304532
0.7294 --- loss: 1.056048, loss_ss: 0.668908, loss_d: 0.387139
0.7678 --- loss: 1.050011, loss_ss: 0.769191, loss_d: 0.280820
0.8061 --- loss: 1.205246, loss_ss: 1.116317, loss_d: 0.088929
0.8445 --- loss: 0.940614, loss_ss: 0.855730, loss_d: 0.084883
0.8829 --- loss: 0.914357, loss_ss: 0.809244, loss_d: 0.105113
0.9213 --- loss: 0.725479, loss_ss: 0.593119, loss_d: 0.132360
0.9597 --- loss: 1.409382, loss_ss: 0.573515, loss_d: 0.835867
0.9981 --- loss: 0.966223, loss_ss: 0.685801, loss_d: 0.280423
Epoch finished! Loss: 1.2026720127234092
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.464983, loss_ss: 1.025951, loss_d: 0.439032
0.0384 --- loss: 1.047471, loss_ss: 0.871821, loss_d: 0.175650
0.0768 --- loss: 0.766829, loss_ss: 0.591180, loss_d: 0.175649
0.1152 --- loss: 1.237371, loss_ss: 0.970533, loss_d: 0.266838
0.1536 --- loss: 1.068578, loss_ss: 0.748795, loss_d: 0.319783
0.1919 --- loss: 1.471881, loss_ss: 1.039398, loss_d: 0.432483
0.2303 --- loss: 1.043688, loss_ss: 0.730412, loss_d: 0.313276
0.2687 --- loss: 1.672294, loss_ss: 1.296527, loss_d: 0.375768
0.3071 --- loss: 1.492243, loss_ss: 1.065308, loss_d: 0.426935
0.3455 --- loss: 0.833512, loss_ss: 0.704556, loss_d: 0.128955
0.3839 --- loss: 1.713872, loss_ss: 1.303714, loss_d: 0.410158
0.4223 --- loss: 1.602364, loss_ss: 0.868105, loss_d: 0.734259
0.4607 --- loss: 1.355730, loss_ss: 0.983429, loss_d: 0.372301
0.4990 --- loss: 0.979432, loss_ss: 0.838432, loss_d: 0.141001
0.5374 --- loss: 1.142618, loss_ss: 0.893667, loss_d: 0.248951
0.5758 --- loss: 1.208894, loss_ss: 0.761596, loss_d: 0.447298
0.6142 --- loss: 1.327655, loss_ss: 0.859746, loss_d: 0.467909
0.6526 --- loss: 0.719433, loss_ss: 0.633623, loss_d: 0.085810
0.6910 --- loss: 0.953292, loss_ss: 0.681452, loss_d: 0.271840
0.7294 --- loss: 1.066813, loss_ss: 0.720521, loss_d: 0.346293
0.7678 --- loss: 0.686033, loss_ss: 0.606951, loss_d: 0.079082
0.8061 --- loss: 0.807144, loss_ss: 0.685978, loss_d: 0.121166
0.8445 --- loss: 1.053297, loss_ss: 0.945635, loss_d: 0.107662
0.8829 --- loss: 1.280581, loss_ss: 0.963894, loss_d: 0.316687
0.9213 --- loss: 0.850323, loss_ss: 0.626799, loss_d: 0.223525
0.9597 --- loss: 1.045490, loss_ss: 0.750599, loss_d: 0.294891
0.9981 --- loss: 3.262095, loss_ss: 2.889160, loss_d: 0.372935
Epoch finished! Loss: 1.1673588706896856
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7343434343434343
             precision    recall  f1-score   support

        0.0       0.96      0.72      0.82       159
        1.0       0.26      0.34      0.29        87
        2.0       0.81      0.84      0.83       439
        3.0       0.91      0.41      0.57        99
        4.0       0.68      0.84      0.75       206

avg / total       0.77      0.73      0.74       990
 


====== chp052-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  94.95  71.70   99.40  95.80     82.01
1  85.45  34.48   90.37  25.64     29.41
2  84.24  83.83   84.57  81.24     82.51
3  93.74  41.41   99.55  91.11     56.94
4  88.48  84.47   89.54  67.97     75.32
Total accuracy: 73.43%
Average sen: 63.18%
Average spec: 92.69%
Macro f1-score: 65.24%
Diagnosis acc on 15mins: 0.9090909090909091
[0.32636866 0.30211306 0.38688773 0.75160581 0.90583652 0.92298579
 0.91820079 0.96869165 0.86339444 0.91981751 0.92232758 0.86431414
 0.81312233 0.82913661 0.99525708 0.84872228 0.94604731 0.98968142
 0.99509877 0.90668875 0.61478549 0.65633291 0.91048479 0.88540441
 0.9611215  0.95561576 0.70955616 0.87774581 0.53052181 0.88068175
 0.83795792 0.99577749 0.98436469]
pred: 0.8235348092787194, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp053-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.329760, loss_ss: 1.626838, loss_d: 0.702922
0.0384 --- loss: 2.103797, loss_ss: 1.571097, loss_d: 0.532701
0.0769 --- loss: 2.202447, loss_ss: 1.535960, loss_d: 0.666487
0.1153 --- loss: 1.872033, loss_ss: 1.402884, loss_d: 0.469150
0.1537 --- loss: 2.231090, loss_ss: 1.466161, loss_d: 0.764929
0.1922 --- loss: 2.028207, loss_ss: 1.377607, loss_d: 0.650600
0.2306 --- loss: 1.889874, loss_ss: 1.389588, loss_d: 0.500286
0.2690 --- loss: 2.217645, loss_ss: 1.313417, loss_d: 0.904228
0.3075 --- loss: 1.885373, loss_ss: 1.276407, loss_d: 0.608966
0.3459 --- loss: 1.770709, loss_ss: 1.296671, loss_d: 0.474038
0.3843 --- loss: 1.787330, loss_ss: 1.250787, loss_d: 0.536544
0.4228 --- loss: 1.920004, loss_ss: 1.296405, loss_d: 0.623598
0.4612 --- loss: 1.913754, loss_ss: 1.332713, loss_d: 0.581041
0.4996 --- loss: 1.644889, loss_ss: 1.195534, loss_d: 0.449355
0.5380 --- loss: 2.141846, loss_ss: 1.290993, loss_d: 0.850854
0.5765 --- loss: 1.753421, loss_ss: 1.215086, loss_d: 0.538335
0.6149 --- loss: 2.178084, loss_ss: 1.549065, loss_d: 0.629019
0.6533 --- loss: 1.627597, loss_ss: 1.224332, loss_d: 0.403265
0.6918 --- loss: 2.051571, loss_ss: 1.298113, loss_d: 0.753458
0.7302 --- loss: 2.053039, loss_ss: 1.402138, loss_d: 0.650901
0.7686 --- loss: 1.703885, loss_ss: 1.128514, loss_d: 0.575371
0.8071 --- loss: 1.626890, loss_ss: 1.152266, loss_d: 0.474625
0.8455 --- loss: 1.594787, loss_ss: 1.100816, loss_d: 0.493971
0.8839 --- loss: 1.675900, loss_ss: 1.222489, loss_d: 0.453411
0.9224 --- loss: 1.672141, loss_ss: 0.991211, loss_d: 0.680930
0.9608 --- loss: 1.690992, loss_ss: 1.160862, loss_d: 0.530131
0.9992 --- loss: 2.038922, loss_ss: 1.653473, loss_d: 0.385448
Epoch finished! Loss: 1.9316017737755409
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.758749, loss_ss: 1.117137, loss_d: 0.641611
0.0384 --- loss: 1.570552, loss_ss: 1.063912, loss_d: 0.506640
0.0769 --- loss: 1.844466, loss_ss: 1.015141, loss_d: 0.829325
0.1153 --- loss: 1.447684, loss_ss: 1.184407, loss_d: 0.263277
0.1537 --- loss: 1.990808, loss_ss: 1.054607, loss_d: 0.936202
0.1922 --- loss: 1.510596, loss_ss: 1.131621, loss_d: 0.378975
0.2306 --- loss: 1.564646, loss_ss: 0.962165, loss_d: 0.602481
0.2690 --- loss: 1.977452, loss_ss: 1.168844, loss_d: 0.808607
0.3075 --- loss: 1.596943, loss_ss: 0.929126, loss_d: 0.667818
0.3459 --- loss: 1.494618, loss_ss: 0.971176, loss_d: 0.523442
0.3843 --- loss: 1.767975, loss_ss: 1.069841, loss_d: 0.698135
0.4228 --- loss: 1.549058, loss_ss: 0.983174, loss_d: 0.565884
0.4612 --- loss: 1.678906, loss_ss: 1.140682, loss_d: 0.538224
0.4996 --- loss: 1.832144, loss_ss: 1.169580, loss_d: 0.662564
0.5380 --- loss: 1.759567, loss_ss: 1.300872, loss_d: 0.458695
0.5765 --- loss: 1.729029, loss_ss: 1.057632, loss_d: 0.671397
0.6149 --- loss: 1.493304, loss_ss: 1.160684, loss_d: 0.332620
0.6533 --- loss: 1.373201, loss_ss: 0.983703, loss_d: 0.389497
0.6918 --- loss: 1.377455, loss_ss: 0.927012, loss_d: 0.450442
0.7302 --- loss: 1.696172, loss_ss: 1.166216, loss_d: 0.529957
0.7686 --- loss: 1.843811, loss_ss: 1.381645, loss_d: 0.462166
0.8071 --- loss: 1.480803, loss_ss: 1.141967, loss_d: 0.338835
0.8455 --- loss: 1.502737, loss_ss: 1.017425, loss_d: 0.485312
0.8839 --- loss: 1.509116, loss_ss: 0.865798, loss_d: 0.643318
0.9224 --- loss: 1.408511, loss_ss: 0.893255, loss_d: 0.515257
0.9608 --- loss: 1.576037, loss_ss: 0.984724, loss_d: 0.591313
0.9992 --- loss: 1.423457, loss_ss: 1.087695, loss_d: 0.335762
Epoch finished! Loss: 1.6999863785046798
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.591675, loss_ss: 1.133581, loss_d: 0.458094
0.0384 --- loss: 1.641016, loss_ss: 1.216995, loss_d: 0.424020
0.0769 --- loss: 1.535321, loss_ss: 1.052527, loss_d: 0.482794
0.1153 --- loss: 1.846119, loss_ss: 1.326056, loss_d: 0.520062
0.1537 --- loss: 1.963424, loss_ss: 1.126993, loss_d: 0.836431
0.1922 --- loss: 1.473993, loss_ss: 0.924886, loss_d: 0.549107
0.2306 --- loss: 1.710397, loss_ss: 1.131255, loss_d: 0.579141
0.2690 --- loss: 1.553726, loss_ss: 1.023597, loss_d: 0.530129
0.3075 --- loss: 1.664210, loss_ss: 1.008222, loss_d: 0.655989
0.3459 --- loss: 1.976352, loss_ss: 1.316507, loss_d: 0.659845
0.3843 --- loss: 1.610301, loss_ss: 0.981981, loss_d: 0.628321
0.4228 --- loss: 1.451143, loss_ss: 0.908641, loss_d: 0.542503
0.4612 --- loss: 1.483795, loss_ss: 0.840385, loss_d: 0.643410
0.4996 --- loss: 1.457547, loss_ss: 1.022353, loss_d: 0.435194
0.5380 --- loss: 1.618574, loss_ss: 0.962865, loss_d: 0.655709
0.5765 --- loss: 1.397551, loss_ss: 0.903831, loss_d: 0.493720
0.6149 --- loss: 1.433367, loss_ss: 0.851453, loss_d: 0.581914
0.6533 --- loss: 1.449280, loss_ss: 1.095786, loss_d: 0.353494
0.6918 --- loss: 1.595309, loss_ss: 1.115252, loss_d: 0.480058
0.7302 --- loss: 1.631443, loss_ss: 1.120872, loss_d: 0.510571
0.7686 --- loss: 1.395084, loss_ss: 0.800699, loss_d: 0.594385
0.8071 --- loss: 1.879999, loss_ss: 1.078857, loss_d: 0.801142
0.8455 --- loss: 1.788743, loss_ss: 1.298329, loss_d: 0.490414
0.8839 --- loss: 1.570334, loss_ss: 1.175725, loss_d: 0.394609
0.9224 --- loss: 1.937824, loss_ss: 1.329539, loss_d: 0.608285
0.9608 --- loss: 1.344427, loss_ss: 1.057573, loss_d: 0.286854
0.9992 --- loss: 2.721299, loss_ss: 0.784807, loss_d: 1.936492
Epoch finished! Loss: 1.5813342447464283
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.443314, loss_ss: 0.828514, loss_d: 0.614800
0.0384 --- loss: 1.913035, loss_ss: 0.899620, loss_d: 1.013415
0.0769 --- loss: 1.659471, loss_ss: 1.219263, loss_d: 0.440208
0.1153 --- loss: 1.399173, loss_ss: 1.027260, loss_d: 0.371913
0.1537 --- loss: 1.447558, loss_ss: 0.836378, loss_d: 0.611180
0.1922 --- loss: 1.632440, loss_ss: 0.862086, loss_d: 0.770354
0.2306 --- loss: 1.620349, loss_ss: 1.023621, loss_d: 0.596728
0.2690 --- loss: 2.224265, loss_ss: 1.226830, loss_d: 0.997435
0.3075 --- loss: 1.311631, loss_ss: 0.995714, loss_d: 0.315917
0.3459 --- loss: 1.328759, loss_ss: 0.950429, loss_d: 0.378330
0.3843 --- loss: 1.663452, loss_ss: 1.414941, loss_d: 0.248511
0.4228 --- loss: 1.764495, loss_ss: 0.939040, loss_d: 0.825455
0.4612 --- loss: 1.247299, loss_ss: 0.894144, loss_d: 0.353155
0.4996 --- loss: 1.439707, loss_ss: 0.975717, loss_d: 0.463990
0.5380 --- loss: 1.614495, loss_ss: 0.905911, loss_d: 0.708584
0.5765 --- loss: 1.381084, loss_ss: 0.916937, loss_d: 0.464147
0.6149 --- loss: 1.363051, loss_ss: 1.040115, loss_d: 0.322935
0.6533 --- loss: 1.374790, loss_ss: 1.140767, loss_d: 0.234022
0.6918 --- loss: 1.394901, loss_ss: 1.117978, loss_d: 0.276924
0.7302 --- loss: 1.688113, loss_ss: 0.728349, loss_d: 0.959764
0.7686 --- loss: 1.315796, loss_ss: 1.053684, loss_d: 0.262112
0.8071 --- loss: 1.500789, loss_ss: 0.890651, loss_d: 0.610138
0.8455 --- loss: 1.536814, loss_ss: 0.921457, loss_d: 0.615357
0.8839 --- loss: 1.171437, loss_ss: 0.795661, loss_d: 0.375776
0.9224 --- loss: 1.224693, loss_ss: 0.761539, loss_d: 0.463155
0.9608 --- loss: 1.275986, loss_ss: 0.832395, loss_d: 0.443591
0.9992 --- loss: 2.724473, loss_ss: 1.029471, loss_d: 1.695003
Epoch finished! Loss: 1.4822988966336617
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.094843, loss_ss: 0.672609, loss_d: 0.422233
0.0384 --- loss: 1.338816, loss_ss: 0.831940, loss_d: 0.506877
0.0769 --- loss: 1.476792, loss_ss: 1.127940, loss_d: 0.348852
0.1153 --- loss: 1.462921, loss_ss: 0.927604, loss_d: 0.535318
0.1537 --- loss: 1.707432, loss_ss: 0.914578, loss_d: 0.792854
0.1922 --- loss: 1.998312, loss_ss: 1.064339, loss_d: 0.933972
0.2306 --- loss: 1.450305, loss_ss: 0.861023, loss_d: 0.589282
0.2690 --- loss: 1.515363, loss_ss: 0.960901, loss_d: 0.554462
0.3075 --- loss: 1.169993, loss_ss: 0.833523, loss_d: 0.336471
0.3459 --- loss: 0.939090, loss_ss: 0.737889, loss_d: 0.201201
0.3843 --- loss: 1.223512, loss_ss: 0.864497, loss_d: 0.359015
0.4228 --- loss: 1.954613, loss_ss: 1.352380, loss_d: 0.602233
0.4612 --- loss: 1.581591, loss_ss: 0.869643, loss_d: 0.711948
0.4996 --- loss: 1.219477, loss_ss: 0.920610, loss_d: 0.298866
0.5380 --- loss: 1.305596, loss_ss: 0.946546, loss_d: 0.359050
0.5765 --- loss: 1.000755, loss_ss: 0.796280, loss_d: 0.204475
0.6149 --- loss: 1.285857, loss_ss: 0.947641, loss_d: 0.338217
0.6533 --- loss: 1.516686, loss_ss: 0.882263, loss_d: 0.634423
0.6918 --- loss: 1.048657, loss_ss: 0.831962, loss_d: 0.216695
0.7302 --- loss: 1.368257, loss_ss: 1.025710, loss_d: 0.342547
0.7686 --- loss: 1.174566, loss_ss: 0.831541, loss_d: 0.343026
0.8071 --- loss: 1.258227, loss_ss: 0.924284, loss_d: 0.333943
0.8455 --- loss: 1.169478, loss_ss: 0.906780, loss_d: 0.262699
0.8839 --- loss: 1.255147, loss_ss: 0.849519, loss_d: 0.405629
0.9224 --- loss: 1.373542, loss_ss: 0.962022, loss_d: 0.411520
0.9608 --- loss: 1.417737, loss_ss: 1.128803, loss_d: 0.288934
0.9992 --- loss: 4.690628, loss_ss: 2.777389, loss_d: 1.913239
Epoch finished! Loss: 1.4041581392288207
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.949584, loss_ss: 0.720522, loss_d: 0.229062
0.0384 --- loss: 1.454436, loss_ss: 0.990623, loss_d: 0.463813
0.0769 --- loss: 1.733049, loss_ss: 0.948115, loss_d: 0.784934
0.1153 --- loss: 1.376462, loss_ss: 0.859722, loss_d: 0.516740
0.1537 --- loss: 1.325745, loss_ss: 0.796203, loss_d: 0.529542
0.1922 --- loss: 1.432804, loss_ss: 0.867066, loss_d: 0.565737
0.2306 --- loss: 1.281788, loss_ss: 0.849405, loss_d: 0.432383
0.2690 --- loss: 1.394972, loss_ss: 0.917936, loss_d: 0.477036
0.3075 --- loss: 1.538766, loss_ss: 0.790582, loss_d: 0.748184
0.3459 --- loss: 1.233208, loss_ss: 0.838558, loss_d: 0.394650
0.3843 --- loss: 1.126713, loss_ss: 0.685287, loss_d: 0.441426
0.4228 --- loss: 1.315026, loss_ss: 0.946428, loss_d: 0.368598
0.4612 --- loss: 0.978013, loss_ss: 0.694398, loss_d: 0.283615
0.4996 --- loss: 0.909158, loss_ss: 0.720756, loss_d: 0.188402
0.5380 --- loss: 1.190822, loss_ss: 0.841650, loss_d: 0.349173
0.5765 --- loss: 1.741910, loss_ss: 1.017876, loss_d: 0.724034
0.6149 --- loss: 0.917418, loss_ss: 0.762352, loss_d: 0.155066
0.6533 --- loss: 1.331685, loss_ss: 0.961974, loss_d: 0.369711
0.6918 --- loss: 1.200739, loss_ss: 1.011943, loss_d: 0.188797
0.7302 --- loss: 1.149127, loss_ss: 0.872159, loss_d: 0.276968
0.7686 --- loss: 0.941747, loss_ss: 0.697807, loss_d: 0.243940
0.8071 --- loss: 1.008571, loss_ss: 0.837340, loss_d: 0.171231
0.8455 --- loss: 1.695319, loss_ss: 1.546419, loss_d: 0.148900
0.8839 --- loss: 1.369875, loss_ss: 1.142877, loss_d: 0.226998
0.9224 --- loss: 1.505681, loss_ss: 1.047347, loss_d: 0.458334
0.9608 --- loss: 1.433028, loss_ss: 0.936850, loss_d: 0.496177
0.9992 --- loss: 1.444722, loss_ss: 1.173936, loss_d: 0.270785
Epoch finished! Loss: 1.3917327690583008
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.474126, loss_ss: 0.998462, loss_d: 0.475664
0.0384 --- loss: 0.971016, loss_ss: 0.653178, loss_d: 0.317838
0.0769 --- loss: 1.548230, loss_ss: 1.068673, loss_d: 0.479557
0.1153 --- loss: 1.545865, loss_ss: 0.974175, loss_d: 0.571689
0.1537 --- loss: 1.342018, loss_ss: 0.919203, loss_d: 0.422816
0.1922 --- loss: 1.213935, loss_ss: 0.956865, loss_d: 0.257070
0.2306 --- loss: 1.390220, loss_ss: 1.220844, loss_d: 0.169376
0.2690 --- loss: 1.150901, loss_ss: 0.904518, loss_d: 0.246383
0.3075 --- loss: 1.236546, loss_ss: 0.848639, loss_d: 0.387908
0.3459 --- loss: 1.175749, loss_ss: 0.910951, loss_d: 0.264798
0.3843 --- loss: 1.164495, loss_ss: 1.009405, loss_d: 0.155090
0.4228 --- loss: 1.502715, loss_ss: 1.053630, loss_d: 0.449085
0.4612 --- loss: 1.157893, loss_ss: 0.905001, loss_d: 0.252893
0.4996 --- loss: 1.196218, loss_ss: 0.891230, loss_d: 0.304988
0.5380 --- loss: 1.123752, loss_ss: 0.943392, loss_d: 0.180361
0.5765 --- loss: 1.160997, loss_ss: 0.931619, loss_d: 0.229378
0.6149 --- loss: 1.366150, loss_ss: 0.978140, loss_d: 0.388010
0.6533 --- loss: 1.326203, loss_ss: 0.829177, loss_d: 0.497026
0.6918 --- loss: 0.880252, loss_ss: 0.663634, loss_d: 0.216617
0.7302 --- loss: 1.173919, loss_ss: 0.964766, loss_d: 0.209153
0.7686 --- loss: 1.591294, loss_ss: 1.226969, loss_d: 0.364325
0.8071 --- loss: 1.530323, loss_ss: 0.902536, loss_d: 0.627787
0.8455 --- loss: 1.306472, loss_ss: 1.023217, loss_d: 0.283255
0.8839 --- loss: 1.292398, loss_ss: 0.867249, loss_d: 0.425149
0.9224 --- loss: 0.936938, loss_ss: 0.792916, loss_d: 0.144022
0.9608 --- loss: 1.363086, loss_ss: 0.864314, loss_d: 0.498772
0.9992 --- loss: 2.026092, loss_ss: 1.487271, loss_d: 0.538821
Epoch finished! Loss: 1.2775167125921982
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.055271, loss_ss: 0.921008, loss_d: 0.134263
0.0384 --- loss: 0.828769, loss_ss: 0.593091, loss_d: 0.235678
0.0769 --- loss: 0.970478, loss_ss: 0.807115, loss_d: 0.163363
0.1153 --- loss: 0.998246, loss_ss: 0.801442, loss_d: 0.196804
0.1537 --- loss: 0.994222, loss_ss: 0.606961, loss_d: 0.387261
0.1922 --- loss: 1.473700, loss_ss: 0.886417, loss_d: 0.587283
0.2306 --- loss: 1.304009, loss_ss: 1.002735, loss_d: 0.301274
0.2690 --- loss: 1.093065, loss_ss: 0.801651, loss_d: 0.291413
0.3075 --- loss: 0.923910, loss_ss: 0.663677, loss_d: 0.260233
0.3459 --- loss: 1.502446, loss_ss: 1.052460, loss_d: 0.449986
0.3843 --- loss: 1.414255, loss_ss: 0.931122, loss_d: 0.483133
0.4228 --- loss: 1.491101, loss_ss: 0.941353, loss_d: 0.549748
0.4612 --- loss: 1.189849, loss_ss: 0.752888, loss_d: 0.436961
0.4996 --- loss: 1.006598, loss_ss: 0.696604, loss_d: 0.309994
0.5380 --- loss: 1.297403, loss_ss: 0.930502, loss_d: 0.366901
0.5765 --- loss: 1.080086, loss_ss: 0.854751, loss_d: 0.225335
0.6149 --- loss: 1.380749, loss_ss: 1.210771, loss_d: 0.169977
0.6533 --- loss: 1.389481, loss_ss: 0.867436, loss_d: 0.522044
0.6918 --- loss: 1.058070, loss_ss: 0.728532, loss_d: 0.329539
0.7302 --- loss: 1.174876, loss_ss: 0.600669, loss_d: 0.574207
0.7686 --- loss: 1.399119, loss_ss: 1.158224, loss_d: 0.240895
0.8071 --- loss: 1.163143, loss_ss: 0.895852, loss_d: 0.267290
0.8455 --- loss: 1.153111, loss_ss: 1.013038, loss_d: 0.140074
0.8839 --- loss: 1.252609, loss_ss: 1.114189, loss_d: 0.138419
0.9224 --- loss: 0.872492, loss_ss: 0.661223, loss_d: 0.211269
0.9608 --- loss: 0.956493, loss_ss: 0.752263, loss_d: 0.204229
0.9992 --- loss: 1.359980, loss_ss: 1.166049, loss_d: 0.193930
Epoch finished! Loss: 1.236404791015845
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.357594, loss_ss: 1.137873, loss_d: 0.219721
0.0384 --- loss: 1.223379, loss_ss: 0.917550, loss_d: 0.305829
0.0769 --- loss: 0.994865, loss_ss: 0.756181, loss_d: 0.238684
0.1153 --- loss: 0.966769, loss_ss: 0.770950, loss_d: 0.195819
0.1537 --- loss: 1.113403, loss_ss: 0.886717, loss_d: 0.226686
0.1922 --- loss: 1.372399, loss_ss: 1.006219, loss_d: 0.366180
0.2306 --- loss: 1.154828, loss_ss: 0.797238, loss_d: 0.357590
0.2690 --- loss: 1.040276, loss_ss: 0.888128, loss_d: 0.152147
0.3075 --- loss: 1.365968, loss_ss: 0.912593, loss_d: 0.453374
0.3459 --- loss: 1.754637, loss_ss: 1.024132, loss_d: 0.730505
0.3843 --- loss: 1.335361, loss_ss: 0.826999, loss_d: 0.508362
0.4228 --- loss: 1.145456, loss_ss: 0.595006, loss_d: 0.550450
0.4612 --- loss: 1.307968, loss_ss: 0.879593, loss_d: 0.428375
0.4996 --- loss: 0.850228, loss_ss: 0.651815, loss_d: 0.198413
0.5380 --- loss: 1.144716, loss_ss: 0.545150, loss_d: 0.599566
0.5765 --- loss: 1.587841, loss_ss: 1.176259, loss_d: 0.411582
0.6149 --- loss: 1.145752, loss_ss: 0.959602, loss_d: 0.186150
0.6533 --- loss: 1.283751, loss_ss: 1.046628, loss_d: 0.237122
0.6918 --- loss: 1.148564, loss_ss: 0.858674, loss_d: 0.289890
0.7302 --- loss: 1.375182, loss_ss: 0.971678, loss_d: 0.403503
0.7686 --- loss: 1.612554, loss_ss: 0.951861, loss_d: 0.660694
0.8071 --- loss: 1.068132, loss_ss: 0.856687, loss_d: 0.211445
0.8455 --- loss: 1.713928, loss_ss: 1.034223, loss_d: 0.679704
0.8839 --- loss: 0.837667, loss_ss: 0.696095, loss_d: 0.141572
0.9224 --- loss: 1.117991, loss_ss: 0.833808, loss_d: 0.284183
0.9608 --- loss: 1.312687, loss_ss: 0.715090, loss_d: 0.597596
0.9992 --- loss: 1.731505, loss_ss: 1.239988, loss_d: 0.491517
Epoch finished! Loss: 1.2317730571214969
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.010289, loss_ss: 0.782791, loss_d: 0.227498
0.0384 --- loss: 1.091636, loss_ss: 0.889648, loss_d: 0.201988
0.0769 --- loss: 0.959433, loss_ss: 0.759142, loss_d: 0.200291
0.1153 --- loss: 0.962443, loss_ss: 0.761450, loss_d: 0.200993
0.1537 --- loss: 0.941518, loss_ss: 0.662150, loss_d: 0.279368
0.1922 --- loss: 0.742482, loss_ss: 0.621297, loss_d: 0.121185
0.2306 --- loss: 1.595038, loss_ss: 0.965918, loss_d: 0.629120
0.2690 --- loss: 0.976499, loss_ss: 0.752663, loss_d: 0.223836
0.3075 --- loss: 1.141735, loss_ss: 0.936045, loss_d: 0.205690
0.3459 --- loss: 0.945995, loss_ss: 0.647143, loss_d: 0.298852
0.3843 --- loss: 1.080774, loss_ss: 0.785894, loss_d: 0.294880
0.4228 --- loss: 0.709687, loss_ss: 0.574515, loss_d: 0.135172
0.4612 --- loss: 1.006326, loss_ss: 0.797131, loss_d: 0.209195
0.4996 --- loss: 1.384311, loss_ss: 1.018629, loss_d: 0.365681
0.5380 --- loss: 0.881059, loss_ss: 0.668448, loss_d: 0.212611
0.5765 --- loss: 0.942747, loss_ss: 0.768132, loss_d: 0.174615
0.6149 --- loss: 1.192283, loss_ss: 0.698941, loss_d: 0.493342
0.6533 --- loss: 1.419179, loss_ss: 0.985883, loss_d: 0.433296
0.6918 --- loss: 0.901764, loss_ss: 0.697537, loss_d: 0.204227
0.7302 --- loss: 1.505898, loss_ss: 1.102798, loss_d: 0.403100
0.7686 --- loss: 0.784189, loss_ss: 0.591386, loss_d: 0.192802
0.8071 --- loss: 1.118636, loss_ss: 0.708272, loss_d: 0.410363
0.8455 --- loss: 1.278680, loss_ss: 0.880253, loss_d: 0.398427
0.8839 --- loss: 1.520656, loss_ss: 0.906655, loss_d: 0.614001
0.9224 --- loss: 1.010264, loss_ss: 0.885723, loss_d: 0.124540
0.9608 --- loss: 1.517458, loss_ss: 1.269419, loss_d: 0.248039
0.9992 --- loss: 2.280948, loss_ss: 2.031468, loss_d: 0.249480
Epoch finished! Loss: 1.1758848733626879
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.687962962962963
             precision    recall  f1-score   support

        0.0       0.63      0.88      0.73       251
        1.0       0.40      0.04      0.07       147
        2.0       0.68      0.70      0.69       305
        3.0       0.79      0.97      0.87       250
        4.0       0.67      0.46      0.54       127

avg / total       0.65      0.69      0.64      1080
 


====== chp053-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  85.00  88.45   83.96  62.54     73.27
1  86.11   4.08   99.04  40.00      7.41
2  82.22  70.49   86.84  67.82     69.13
3  93.24  96.80   92.17  78.83     86.89
4  91.02  45.67   97.06  67.44     54.46
Total accuracy: 68.80%
Average sen: 61.10%
Average spec: 91.81%
Macro f1-score: 58.23%
Diagnosis acc on 15mins: 0.8888888888888888
[0.52646691 0.56948745 0.8920126  0.90696841 0.95087719 0.93392992
 0.63675976 0.92464155 0.52713764 0.45306891 0.78972661 0.90392143
 0.4760603  0.8720305  0.59905678 0.3847416  0.46900287 0.67965233
 0.67327261 0.82077157 0.92532074 0.93206382 0.92334443 0.93662381
 0.92938679 0.87134814 0.5483461  0.51079011 0.63023442 0.8643074
 0.77275449 0.91447687 0.6445213  0.71627241 0.69678611 0.75341541]
pred: 0.7377660920222601, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp054-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.382007, loss_ss: 1.688550, loss_d: 0.693458
0.0384 --- loss: 2.161530, loss_ss: 1.577274, loss_d: 0.584256
0.0769 --- loss: 2.119282, loss_ss: 1.469044, loss_d: 0.650238
0.1153 --- loss: 2.100492, loss_ss: 1.541287, loss_d: 0.559206
0.1538 --- loss: 2.215457, loss_ss: 1.637285, loss_d: 0.578172
0.1922 --- loss: 2.332507, loss_ss: 1.382200, loss_d: 0.950307
0.2307 --- loss: 1.804824, loss_ss: 1.231090, loss_d: 0.573734
0.2691 --- loss: 2.556568, loss_ss: 1.668208, loss_d: 0.888360
0.3076 --- loss: 1.841698, loss_ss: 1.350784, loss_d: 0.490915
0.3460 --- loss: 1.935984, loss_ss: 1.371749, loss_d: 0.564235
0.3845 --- loss: 2.046759, loss_ss: 1.456043, loss_d: 0.590717
0.4229 --- loss: 2.304114, loss_ss: 1.432563, loss_d: 0.871550
0.4614 --- loss: 2.156654, loss_ss: 1.481623, loss_d: 0.675031
0.4998 --- loss: 1.854714, loss_ss: 1.322448, loss_d: 0.532265
0.5383 --- loss: 1.681968, loss_ss: 1.271693, loss_d: 0.410275
0.5767 --- loss: 2.039807, loss_ss: 1.256960, loss_d: 0.782848
0.6151 --- loss: 2.025806, loss_ss: 1.201213, loss_d: 0.824593
0.6536 --- loss: 1.858883, loss_ss: 1.356405, loss_d: 0.502479
0.6920 --- loss: 1.852214, loss_ss: 1.208132, loss_d: 0.644082
0.7305 --- loss: 1.661252, loss_ss: 1.109327, loss_d: 0.551925
0.7689 --- loss: 1.909453, loss_ss: 1.183954, loss_d: 0.725500
0.8074 --- loss: 1.802579, loss_ss: 1.177529, loss_d: 0.625050
0.8458 --- loss: 1.751150, loss_ss: 1.202429, loss_d: 0.548720
0.8843 --- loss: 1.737736, loss_ss: 1.182920, loss_d: 0.554817
0.9227 --- loss: 1.695533, loss_ss: 1.229221, loss_d: 0.466312
0.9612 --- loss: 1.684366, loss_ss: 1.272068, loss_d: 0.412298
0.9996 --- loss: 1.867207, loss_ss: 1.483868, loss_d: 0.383339
Epoch finished! Loss: 1.9747221309405107
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.806731, loss_ss: 1.236059, loss_d: 0.570672
0.0384 --- loss: 1.870985, loss_ss: 1.392466, loss_d: 0.478518
0.0769 --- loss: 1.918588, loss_ss: 1.103723, loss_d: 0.814865
0.1153 --- loss: 1.841724, loss_ss: 1.219144, loss_d: 0.622581
0.1538 --- loss: 1.420005, loss_ss: 0.993422, loss_d: 0.426583
0.1922 --- loss: 1.710644, loss_ss: 1.130272, loss_d: 0.580372
0.2307 --- loss: 1.587814, loss_ss: 1.033427, loss_d: 0.554386
0.2691 --- loss: 1.786934, loss_ss: 1.226939, loss_d: 0.559994
0.3076 --- loss: 1.851516, loss_ss: 1.018840, loss_d: 0.832675
0.3460 --- loss: 1.757700, loss_ss: 1.162413, loss_d: 0.595286
0.3845 --- loss: 1.795002, loss_ss: 1.346880, loss_d: 0.448123
0.4229 --- loss: 2.012590, loss_ss: 1.102459, loss_d: 0.910130
0.4614 --- loss: 1.762635, loss_ss: 1.247718, loss_d: 0.514916
0.4998 --- loss: 1.827183, loss_ss: 1.174841, loss_d: 0.652341
0.5383 --- loss: 1.775097, loss_ss: 1.272005, loss_d: 0.503092
0.5767 --- loss: 1.616749, loss_ss: 1.087206, loss_d: 0.529544
0.6151 --- loss: 1.492245, loss_ss: 1.125059, loss_d: 0.367186
0.6536 --- loss: 1.550657, loss_ss: 1.176991, loss_d: 0.373666
0.6920 --- loss: 1.684716, loss_ss: 0.912015, loss_d: 0.772701
0.7305 --- loss: 1.891318, loss_ss: 1.250728, loss_d: 0.640590
0.7689 --- loss: 1.671259, loss_ss: 0.896820, loss_d: 0.774440
0.8074 --- loss: 1.659389, loss_ss: 0.950181, loss_d: 0.709208
0.8458 --- loss: 1.604800, loss_ss: 1.006848, loss_d: 0.597951
0.8843 --- loss: 1.481572, loss_ss: 0.740956, loss_d: 0.740617
0.9227 --- loss: 1.665015, loss_ss: 1.004491, loss_d: 0.660524
0.9612 --- loss: 1.679971, loss_ss: 1.115953, loss_d: 0.564018
0.9996 --- loss: 1.327151, loss_ss: 1.046350, loss_d: 0.280801
Epoch finished! Loss: 1.6873533446055191
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.397225, loss_ss: 0.893174, loss_d: 0.504051
0.0384 --- loss: 1.482506, loss_ss: 0.916235, loss_d: 0.566271
0.0769 --- loss: 1.630377, loss_ss: 1.112745, loss_d: 0.517632
0.1153 --- loss: 1.266718, loss_ss: 1.041456, loss_d: 0.225261
0.1538 --- loss: 1.549217, loss_ss: 1.089136, loss_d: 0.460081
0.1922 --- loss: 1.615998, loss_ss: 1.044578, loss_d: 0.571419
0.2307 --- loss: 1.423822, loss_ss: 0.958318, loss_d: 0.465504
0.2691 --- loss: 1.499026, loss_ss: 1.010939, loss_d: 0.488087
0.3076 --- loss: 1.645238, loss_ss: 1.038374, loss_d: 0.606864
0.3460 --- loss: 1.061082, loss_ss: 0.774782, loss_d: 0.286300
0.3845 --- loss: 1.530113, loss_ss: 0.993357, loss_d: 0.536756
0.4229 --- loss: 1.920576, loss_ss: 1.008147, loss_d: 0.912430
0.4614 --- loss: 1.365108, loss_ss: 0.900958, loss_d: 0.464150
0.4998 --- loss: 2.301929, loss_ss: 1.166229, loss_d: 1.135700
0.5383 --- loss: 1.601274, loss_ss: 1.055314, loss_d: 0.545960
0.5767 --- loss: 1.514948, loss_ss: 0.931530, loss_d: 0.583418
0.6151 --- loss: 1.733039, loss_ss: 0.849646, loss_d: 0.883393
0.6536 --- loss: 1.532910, loss_ss: 1.007491, loss_d: 0.525418
0.6920 --- loss: 1.194855, loss_ss: 0.762821, loss_d: 0.432033
0.7305 --- loss: 1.888999, loss_ss: 0.974974, loss_d: 0.914025
0.7689 --- loss: 1.289111, loss_ss: 0.998041, loss_d: 0.291070
0.8074 --- loss: 1.572019, loss_ss: 1.193635, loss_d: 0.378384
0.8458 --- loss: 1.507970, loss_ss: 1.007879, loss_d: 0.500091
0.8843 --- loss: 1.644667, loss_ss: 1.010359, loss_d: 0.634308
0.9227 --- loss: 1.468259, loss_ss: 0.901750, loss_d: 0.566510
0.9612 --- loss: 1.505518, loss_ss: 0.996752, loss_d: 0.508766
0.9996 --- loss: 2.985501, loss_ss: 2.609339, loss_d: 0.376161
Epoch finished! Loss: 1.583053553562898
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.320154, loss_ss: 0.807686, loss_d: 0.512468
0.0384 --- loss: 1.747009, loss_ss: 0.986005, loss_d: 0.761004
0.0769 --- loss: 1.543913, loss_ss: 0.920632, loss_d: 0.623282
0.1153 --- loss: 1.362482, loss_ss: 0.947156, loss_d: 0.415325
0.1538 --- loss: 1.483741, loss_ss: 0.929805, loss_d: 0.553935
0.1922 --- loss: 1.322897, loss_ss: 0.982936, loss_d: 0.339961
0.2307 --- loss: 1.412280, loss_ss: 0.838305, loss_d: 0.573974
0.2691 --- loss: 1.289569, loss_ss: 0.789112, loss_d: 0.500457
0.3076 --- loss: 1.215264, loss_ss: 0.788800, loss_d: 0.426464
0.3460 --- loss: 1.385462, loss_ss: 1.149687, loss_d: 0.235776
0.3845 --- loss: 1.387084, loss_ss: 1.108798, loss_d: 0.278286
0.4229 --- loss: 1.363146, loss_ss: 1.008959, loss_d: 0.354187
0.4614 --- loss: 1.606877, loss_ss: 1.360531, loss_d: 0.246345
0.4998 --- loss: 1.326025, loss_ss: 0.771640, loss_d: 0.554385
0.5383 --- loss: 1.064846, loss_ss: 0.862272, loss_d: 0.202574
0.5767 --- loss: 1.860213, loss_ss: 0.911408, loss_d: 0.948805
0.6151 --- loss: 1.650864, loss_ss: 0.884946, loss_d: 0.765918
0.6536 --- loss: 1.309722, loss_ss: 0.822183, loss_d: 0.487539
0.6920 --- loss: 1.475981, loss_ss: 0.931001, loss_d: 0.544980
0.7305 --- loss: 0.875707, loss_ss: 0.583843, loss_d: 0.291865
0.7689 --- loss: 1.187374, loss_ss: 0.853055, loss_d: 0.334318
0.8074 --- loss: 1.850049, loss_ss: 1.125109, loss_d: 0.724941
0.8458 --- loss: 1.878347, loss_ss: 0.925935, loss_d: 0.952412
0.8843 --- loss: 1.667000, loss_ss: 1.331917, loss_d: 0.335083
0.9227 --- loss: 1.362630, loss_ss: 1.077995, loss_d: 0.284635
0.9612 --- loss: 1.647980, loss_ss: 1.113194, loss_d: 0.534787
0.9996 --- loss: 4.172943, loss_ss: 2.448784, loss_d: 1.724160
Epoch finished! Loss: 1.4943920905773456
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.133637, loss_ss: 0.780584, loss_d: 0.353052
0.0384 --- loss: 1.466845, loss_ss: 1.046606, loss_d: 0.420239
0.0769 --- loss: 1.208745, loss_ss: 0.899239, loss_d: 0.309506
0.1153 --- loss: 1.403788, loss_ss: 0.943745, loss_d: 0.460043
0.1538 --- loss: 1.305353, loss_ss: 1.118633, loss_d: 0.186719
0.1922 --- loss: 1.125276, loss_ss: 0.925591, loss_d: 0.199684
0.2307 --- loss: 1.021856, loss_ss: 0.684724, loss_d: 0.337132
0.2691 --- loss: 1.627711, loss_ss: 1.068977, loss_d: 0.558733
0.3076 --- loss: 1.046414, loss_ss: 0.731373, loss_d: 0.315041
0.3460 --- loss: 1.266772, loss_ss: 0.728863, loss_d: 0.537908
0.3845 --- loss: 1.498718, loss_ss: 1.227687, loss_d: 0.271031
0.4229 --- loss: 1.461631, loss_ss: 1.095585, loss_d: 0.366046
0.4614 --- loss: 1.300148, loss_ss: 0.803189, loss_d: 0.496959
0.4998 --- loss: 1.353330, loss_ss: 0.710926, loss_d: 0.642405
0.5383 --- loss: 1.593913, loss_ss: 1.094808, loss_d: 0.499105
0.5767 --- loss: 1.193105, loss_ss: 0.904239, loss_d: 0.288866
0.6151 --- loss: 1.332330, loss_ss: 0.787386, loss_d: 0.544944
0.6536 --- loss: 1.196660, loss_ss: 0.788291, loss_d: 0.408369
0.6920 --- loss: 1.453081, loss_ss: 0.836941, loss_d: 0.616139
0.7305 --- loss: 1.184190, loss_ss: 0.788401, loss_d: 0.395790
0.7689 --- loss: 1.020865, loss_ss: 0.625313, loss_d: 0.395551
0.8074 --- loss: 1.364842, loss_ss: 1.015105, loss_d: 0.349736
0.8458 --- loss: 1.474285, loss_ss: 0.949434, loss_d: 0.524851
0.8843 --- loss: 1.286983, loss_ss: 0.858046, loss_d: 0.428936
0.9227 --- loss: 1.218216, loss_ss: 0.779837, loss_d: 0.438379
0.9612 --- loss: 1.566119, loss_ss: 0.989983, loss_d: 0.576136
0.9996 --- loss: 3.236512, loss_ss: 1.251110, loss_d: 1.985401
Epoch finished! Loss: 1.3950484757240003
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.990700, loss_ss: 0.819211, loss_d: 0.171489
0.0384 --- loss: 1.261920, loss_ss: 0.777871, loss_d: 0.484049
0.0769 --- loss: 1.289116, loss_ss: 0.915299, loss_d: 0.373817
0.1153 --- loss: 1.720389, loss_ss: 0.804048, loss_d: 0.916341
0.1538 --- loss: 1.381714, loss_ss: 0.868805, loss_d: 0.512909
0.1922 --- loss: 1.361188, loss_ss: 0.948439, loss_d: 0.412749
0.2307 --- loss: 1.204110, loss_ss: 0.717075, loss_d: 0.487035
0.2691 --- loss: 1.309364, loss_ss: 0.844464, loss_d: 0.464901
0.3076 --- loss: 1.039862, loss_ss: 0.698081, loss_d: 0.341781
0.3460 --- loss: 1.506478, loss_ss: 1.098810, loss_d: 0.407668
0.3845 --- loss: 2.177295, loss_ss: 0.792093, loss_d: 1.385203
0.4229 --- loss: 1.627788, loss_ss: 1.310933, loss_d: 0.316855
0.4614 --- loss: 1.534215, loss_ss: 1.071042, loss_d: 0.463173
0.4998 --- loss: 1.706493, loss_ss: 1.214284, loss_d: 0.492209
0.5383 --- loss: 1.951652, loss_ss: 0.922325, loss_d: 1.029326
0.5767 --- loss: 1.229247, loss_ss: 0.949154, loss_d: 0.280093
0.6151 --- loss: 1.080401, loss_ss: 0.726728, loss_d: 0.353674
0.6536 --- loss: 1.210667, loss_ss: 0.882464, loss_d: 0.328203
0.6920 --- loss: 2.472909, loss_ss: 1.534554, loss_d: 0.938355
0.7305 --- loss: 1.254907, loss_ss: 0.877488, loss_d: 0.377419
0.7689 --- loss: 1.406625, loss_ss: 0.986811, loss_d: 0.419814
0.8074 --- loss: 1.453841, loss_ss: 0.900356, loss_d: 0.553485
0.8458 --- loss: 1.311191, loss_ss: 0.952755, loss_d: 0.358436
0.8843 --- loss: 1.413993, loss_ss: 0.959424, loss_d: 0.454569
0.9227 --- loss: 1.502901, loss_ss: 0.791460, loss_d: 0.711441
0.9612 --- loss: 1.836101, loss_ss: 0.841639, loss_d: 0.994463
0.9996 --- loss: 3.030257, loss_ss: 2.821642, loss_d: 0.208616
Epoch finished! Loss: 1.3577567889140203
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.152581, loss_ss: 0.648803, loss_d: 0.503778
0.0384 --- loss: 1.385455, loss_ss: 0.954950, loss_d: 0.430505
0.0769 --- loss: 1.069158, loss_ss: 0.836314, loss_d: 0.232844
0.1153 --- loss: 1.470827, loss_ss: 1.063945, loss_d: 0.406882
0.1538 --- loss: 1.364540, loss_ss: 0.916181, loss_d: 0.448359
0.1922 --- loss: 1.545317, loss_ss: 0.830486, loss_d: 0.714832
0.2307 --- loss: 0.823503, loss_ss: 0.637062, loss_d: 0.186440
0.2691 --- loss: 1.370163, loss_ss: 0.820466, loss_d: 0.549696
0.3076 --- loss: 2.080864, loss_ss: 0.832358, loss_d: 1.248506
0.3460 --- loss: 1.186324, loss_ss: 0.709577, loss_d: 0.476747
0.3845 --- loss: 1.225712, loss_ss: 0.994160, loss_d: 0.231552
0.4229 --- loss: 0.915191, loss_ss: 0.733306, loss_d: 0.181885
0.4614 --- loss: 1.700366, loss_ss: 0.753093, loss_d: 0.947273
0.4998 --- loss: 1.253219, loss_ss: 0.843268, loss_d: 0.409951
0.5383 --- loss: 1.371914, loss_ss: 0.710255, loss_d: 0.661659
0.5767 --- loss: 1.129651, loss_ss: 0.829210, loss_d: 0.300441
0.6151 --- loss: 1.374605, loss_ss: 1.033525, loss_d: 0.341081
0.6536 --- loss: 1.117153, loss_ss: 0.916766, loss_d: 0.200388
0.6920 --- loss: 1.294117, loss_ss: 0.693356, loss_d: 0.600761
0.7305 --- loss: 1.108368, loss_ss: 0.902765, loss_d: 0.205603
0.7689 --- loss: 1.104255, loss_ss: 0.746182, loss_d: 0.358073
0.8074 --- loss: 1.231824, loss_ss: 0.865394, loss_d: 0.366430
0.8458 --- loss: 0.982946, loss_ss: 0.647718, loss_d: 0.335228
0.8843 --- loss: 0.959574, loss_ss: 0.688156, loss_d: 0.271419
0.9227 --- loss: 0.994959, loss_ss: 0.634868, loss_d: 0.360091
0.9612 --- loss: 1.123446, loss_ss: 0.783700, loss_d: 0.339745
0.9996 --- loss: 1.706756, loss_ss: 1.622358, loss_d: 0.084398
Epoch finished! Loss: 1.297284802335959
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.098480, loss_ss: 0.888553, loss_d: 0.209927
0.0384 --- loss: 1.322376, loss_ss: 1.053642, loss_d: 0.268734
0.0769 --- loss: 1.099918, loss_ss: 0.855875, loss_d: 0.244043
0.1153 --- loss: 1.066276, loss_ss: 0.855658, loss_d: 0.210618
0.1538 --- loss: 1.256360, loss_ss: 1.001031, loss_d: 0.255329
0.1922 --- loss: 1.048258, loss_ss: 0.843004, loss_d: 0.205254
0.2307 --- loss: 1.137785, loss_ss: 0.768124, loss_d: 0.369662
0.2691 --- loss: 1.041286, loss_ss: 0.776446, loss_d: 0.264840
0.3076 --- loss: 1.144869, loss_ss: 0.842062, loss_d: 0.302807
0.3460 --- loss: 0.983872, loss_ss: 0.849933, loss_d: 0.133938
0.3845 --- loss: 1.004508, loss_ss: 0.741884, loss_d: 0.262624
0.4229 --- loss: 1.591825, loss_ss: 1.352338, loss_d: 0.239487
0.4614 --- loss: 1.729851, loss_ss: 1.422581, loss_d: 0.307270
0.4998 --- loss: 1.182997, loss_ss: 0.913847, loss_d: 0.269150
0.5383 --- loss: 1.551847, loss_ss: 0.756860, loss_d: 0.794987
0.5767 --- loss: 1.196971, loss_ss: 0.756506, loss_d: 0.440464
0.6151 --- loss: 0.843547, loss_ss: 0.599609, loss_d: 0.243938
0.6536 --- loss: 0.959527, loss_ss: 0.613029, loss_d: 0.346499
0.6920 --- loss: 1.920660, loss_ss: 1.238263, loss_d: 0.682396
0.7305 --- loss: 1.098174, loss_ss: 0.799525, loss_d: 0.298649
0.7689 --- loss: 0.929411, loss_ss: 0.556034, loss_d: 0.373377
0.8074 --- loss: 0.885731, loss_ss: 0.686606, loss_d: 0.199125
0.8458 --- loss: 1.228538, loss_ss: 0.968645, loss_d: 0.259893
0.8843 --- loss: 1.113500, loss_ss: 0.890104, loss_d: 0.223395
0.9227 --- loss: 1.349145, loss_ss: 0.780867, loss_d: 0.568278
0.9612 --- loss: 1.661441, loss_ss: 0.931598, loss_d: 0.729843
0.9996 --- loss: 1.441058, loss_ss: 1.353084, loss_d: 0.087974
Epoch finished! Loss: 1.2474025753828195
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.337899, loss_ss: 0.733764, loss_d: 0.604135
0.0384 --- loss: 1.335145, loss_ss: 1.121134, loss_d: 0.214011
0.0769 --- loss: 0.901141, loss_ss: 0.763377, loss_d: 0.137763
0.1153 --- loss: 0.866146, loss_ss: 0.754984, loss_d: 0.111161
0.1538 --- loss: 0.771076, loss_ss: 0.671063, loss_d: 0.100014
0.1922 --- loss: 1.305107, loss_ss: 1.045362, loss_d: 0.259745
0.2307 --- loss: 1.434329, loss_ss: 1.214875, loss_d: 0.219454
0.2691 --- loss: 1.426562, loss_ss: 0.730912, loss_d: 0.695650
0.3076 --- loss: 1.297354, loss_ss: 1.046327, loss_d: 0.251026
0.3460 --- loss: 1.688383, loss_ss: 1.500701, loss_d: 0.187682
0.3845 --- loss: 1.056862, loss_ss: 0.883770, loss_d: 0.173092
0.4229 --- loss: 1.261271, loss_ss: 1.020623, loss_d: 0.240648
0.4614 --- loss: 1.141989, loss_ss: 0.864860, loss_d: 0.277129
0.4998 --- loss: 1.360136, loss_ss: 0.978310, loss_d: 0.381826
0.5383 --- loss: 1.145305, loss_ss: 0.973640, loss_d: 0.171665
0.5767 --- loss: 1.307374, loss_ss: 0.695553, loss_d: 0.611821
0.6151 --- loss: 0.824480, loss_ss: 0.676426, loss_d: 0.148053
0.6536 --- loss: 1.133966, loss_ss: 0.895255, loss_d: 0.238711
0.6920 --- loss: 1.532469, loss_ss: 0.921219, loss_d: 0.611249
0.7305 --- loss: 0.925719, loss_ss: 0.611949, loss_d: 0.313770
0.7689 --- loss: 1.039954, loss_ss: 0.692194, loss_d: 0.347760
0.8074 --- loss: 1.320905, loss_ss: 1.001976, loss_d: 0.318929
0.8458 --- loss: 0.973327, loss_ss: 0.741993, loss_d: 0.231333
0.8843 --- loss: 1.698081, loss_ss: 0.977813, loss_d: 0.720268
0.9227 --- loss: 1.412201, loss_ss: 0.957684, loss_d: 0.454517
0.9612 --- loss: 0.689419, loss_ss: 0.532941, loss_d: 0.156479
0.9996 --- loss: 1.869985, loss_ss: 1.667602, loss_d: 0.202383
Epoch finished! Loss: 1.1955256496484463
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.418702, loss_ss: 1.298450, loss_d: 0.120252
0.0384 --- loss: 0.984721, loss_ss: 0.724578, loss_d: 0.260143
0.0769 --- loss: 0.956997, loss_ss: 0.773681, loss_d: 0.183316
0.1153 --- loss: 1.598433, loss_ss: 1.216481, loss_d: 0.381953
0.1538 --- loss: 1.287758, loss_ss: 1.098777, loss_d: 0.188981
0.1922 --- loss: 1.084298, loss_ss: 0.952845, loss_d: 0.131454
0.2307 --- loss: 0.936012, loss_ss: 0.785757, loss_d: 0.150255
0.2691 --- loss: 1.698013, loss_ss: 0.857720, loss_d: 0.840293
0.3076 --- loss: 1.106893, loss_ss: 0.863699, loss_d: 0.243195
0.3460 --- loss: 0.986652, loss_ss: 0.814311, loss_d: 0.172341
0.3845 --- loss: 0.845837, loss_ss: 0.716662, loss_d: 0.129175
0.4229 --- loss: 0.817282, loss_ss: 0.709999, loss_d: 0.107283
0.4614 --- loss: 1.499405, loss_ss: 1.300213, loss_d: 0.199192
0.4998 --- loss: 1.036180, loss_ss: 0.792463, loss_d: 0.243717
0.5383 --- loss: 1.131327, loss_ss: 0.961383, loss_d: 0.169944
0.5767 --- loss: 1.085075, loss_ss: 0.824419, loss_d: 0.260656
0.6151 --- loss: 0.970210, loss_ss: 0.738786, loss_d: 0.231424
0.6536 --- loss: 0.774543, loss_ss: 0.625666, loss_d: 0.148877
0.6920 --- loss: 1.218627, loss_ss: 0.832206, loss_d: 0.386421
0.7305 --- loss: 1.050098, loss_ss: 0.820973, loss_d: 0.229125
0.7689 --- loss: 1.098837, loss_ss: 0.900874, loss_d: 0.197963
0.8074 --- loss: 0.916014, loss_ss: 0.654489, loss_d: 0.261525
0.8458 --- loss: 1.078346, loss_ss: 0.660285, loss_d: 0.418061
0.8843 --- loss: 0.782663, loss_ss: 0.641312, loss_d: 0.141351
0.9227 --- loss: 2.340368, loss_ss: 1.837873, loss_d: 0.502496
0.9612 --- loss: 1.617615, loss_ss: 1.136967, loss_d: 0.480648
0.9996 --- loss: 6.633465, loss_ss: 2.917400, loss_d: 3.716065
Epoch finished! Loss: 1.1860842645168304
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.7234234234234235
             precision    recall  f1-score   support

        0.0       0.85      0.48      0.62       231
        1.0       0.50      0.01      0.02        92
        2.0       0.65      0.94      0.77       472
        3.0       0.89      0.91      0.90        99
        4.0       0.79      0.73      0.76       216

avg / total       0.73      0.72      0.69      1110
 


====== chp054-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  87.48  48.48   97.72  84.85     61.71
1  91.71   1.09   99.90  50.00      2.13
2  76.31  93.86   63.32  65.44     77.11
3  98.20  90.91   98.91  89.11     90.00
4  90.99  72.69   95.41  79.29     75.85
Total accuracy: 72.34%
Average sen: 61.40%
Average spec: 91.06%
Macro f1-score: 61.36%
Diagnosis acc on 15mins: 0.972972972972973
[0.97653663 0.9142977  0.93695533 0.8670094  0.95670289 0.95839369
 0.90906864 0.37829798 0.76590472 0.883268   0.94177169 0.71549618
 0.95965385 0.66744566 0.94742894 0.87197113 0.60566288 0.84743834
 0.65822655 0.99387932 0.88755798 0.69767278 0.82284242 0.65823656
 0.96959305 0.9676097  0.7484237  0.94655317 0.71399343 0.61667746
 0.85788041 0.99857259 0.99908602 0.99708682 0.95944893 0.97236633
 0.99486911]
pred: 0.8530778385497428, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp055-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.268164, loss_ss: 1.580038, loss_d: 0.688125
0.0384 --- loss: 2.220936, loss_ss: 1.470351, loss_d: 0.750585
0.0769 --- loss: 2.028292, loss_ss: 1.692020, loss_d: 0.336272
0.1153 --- loss: 2.221136, loss_ss: 1.410496, loss_d: 0.810640
0.1538 --- loss: 1.857342, loss_ss: 1.377431, loss_d: 0.479911
0.1922 --- loss: 1.939304, loss_ss: 1.344143, loss_d: 0.595161
0.2307 --- loss: 1.917871, loss_ss: 1.272061, loss_d: 0.645810
0.2691 --- loss: 1.872444, loss_ss: 1.293403, loss_d: 0.579041
0.3076 --- loss: 1.825240, loss_ss: 1.240785, loss_d: 0.584455
0.3460 --- loss: 1.779395, loss_ss: 1.349190, loss_d: 0.430205
0.3845 --- loss: 1.907178, loss_ss: 1.317455, loss_d: 0.589723
0.4229 --- loss: 1.847696, loss_ss: 1.365370, loss_d: 0.482327
0.4614 --- loss: 1.719771, loss_ss: 1.200924, loss_d: 0.518847
0.4998 --- loss: 2.026255, loss_ss: 1.093589, loss_d: 0.932665
0.5383 --- loss: 1.656016, loss_ss: 1.111745, loss_d: 0.544271
0.5767 --- loss: 2.009269, loss_ss: 1.412437, loss_d: 0.596832
0.6151 --- loss: 1.738288, loss_ss: 1.132617, loss_d: 0.605672
0.6536 --- loss: 1.616848, loss_ss: 1.148615, loss_d: 0.468232
0.6920 --- loss: 1.774667, loss_ss: 1.195903, loss_d: 0.578764
0.7305 --- loss: 1.710144, loss_ss: 1.302117, loss_d: 0.408027
0.7689 --- loss: 1.993256, loss_ss: 1.331719, loss_d: 0.661537
0.8074 --- loss: 1.688265, loss_ss: 1.059349, loss_d: 0.628915
0.8458 --- loss: 2.413385, loss_ss: 1.256520, loss_d: 1.156866
0.8843 --- loss: 1.655321, loss_ss: 1.093017, loss_d: 0.562304
0.9227 --- loss: 1.645746, loss_ss: 1.157430, loss_d: 0.488316
0.9612 --- loss: 1.850913, loss_ss: 1.233527, loss_d: 0.617386
0.9996 --- loss: 2.487114, loss_ss: 2.041730, loss_d: 0.445384
Epoch finished! Loss: 1.898548024892807
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.732473, loss_ss: 1.024536, loss_d: 0.707937
0.0384 --- loss: 1.620539, loss_ss: 1.127244, loss_d: 0.493295
0.0769 --- loss: 1.787749, loss_ss: 1.079378, loss_d: 0.708371
0.1153 --- loss: 1.521390, loss_ss: 1.066995, loss_d: 0.454395
0.1538 --- loss: 1.950120, loss_ss: 1.250114, loss_d: 0.700007
0.1922 --- loss: 1.657015, loss_ss: 1.266060, loss_d: 0.390955
0.2307 --- loss: 1.638681, loss_ss: 1.032505, loss_d: 0.606175
0.2691 --- loss: 1.749630, loss_ss: 1.235607, loss_d: 0.514023
0.3076 --- loss: 1.751278, loss_ss: 1.163713, loss_d: 0.587566
0.3460 --- loss: 1.428753, loss_ss: 1.047435, loss_d: 0.381318
0.3845 --- loss: 1.639539, loss_ss: 1.003174, loss_d: 0.636365
0.4229 --- loss: 1.674149, loss_ss: 1.236937, loss_d: 0.437212
0.4614 --- loss: 1.613353, loss_ss: 1.036617, loss_d: 0.576736
0.4998 --- loss: 2.116202, loss_ss: 1.372117, loss_d: 0.744085
0.5383 --- loss: 1.648975, loss_ss: 0.941440, loss_d: 0.707534
0.5767 --- loss: 1.816266, loss_ss: 1.080017, loss_d: 0.736248
0.6151 --- loss: 1.577545, loss_ss: 1.115691, loss_d: 0.461854
0.6536 --- loss: 1.639921, loss_ss: 1.055339, loss_d: 0.584582
0.6920 --- loss: 1.978944, loss_ss: 1.106781, loss_d: 0.872162
0.7305 --- loss: 1.843479, loss_ss: 1.075559, loss_d: 0.767920
0.7689 --- loss: 1.671324, loss_ss: 0.964899, loss_d: 0.706425
0.8074 --- loss: 1.835516, loss_ss: 1.129021, loss_d: 0.706495
0.8458 --- loss: 1.921044, loss_ss: 1.204935, loss_d: 0.716109
0.8843 --- loss: 1.579044, loss_ss: 1.016259, loss_d: 0.562785
0.9227 --- loss: 1.554608, loss_ss: 1.069359, loss_d: 0.485249
0.9612 --- loss: 1.837286, loss_ss: 1.339755, loss_d: 0.497531
0.9996 --- loss: 2.511554, loss_ss: 2.269247, loss_d: 0.242307
Epoch finished! Loss: 1.7330676532708682
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.772696, loss_ss: 1.411990, loss_d: 0.360706
0.0384 --- loss: 1.650573, loss_ss: 1.080632, loss_d: 0.569941
0.0769 --- loss: 2.004282, loss_ss: 1.207916, loss_d: 0.796366
0.1153 --- loss: 1.440145, loss_ss: 1.083147, loss_d: 0.356999
0.1538 --- loss: 1.631464, loss_ss: 0.930821, loss_d: 0.700643
0.1922 --- loss: 1.452236, loss_ss: 0.966591, loss_d: 0.485645
0.2307 --- loss: 1.324608, loss_ss: 0.977771, loss_d: 0.346837
0.2691 --- loss: 1.728420, loss_ss: 1.185238, loss_d: 0.543182
0.3076 --- loss: 1.431595, loss_ss: 0.937023, loss_d: 0.494572
0.3460 --- loss: 2.065421, loss_ss: 1.429181, loss_d: 0.636239
0.3845 --- loss: 1.846585, loss_ss: 1.138700, loss_d: 0.707885
0.4229 --- loss: 1.430979, loss_ss: 1.083588, loss_d: 0.347392
0.4614 --- loss: 2.209351, loss_ss: 1.490506, loss_d: 0.718844
0.4998 --- loss: 1.821671, loss_ss: 1.187401, loss_d: 0.634270
0.5383 --- loss: 1.563448, loss_ss: 1.143395, loss_d: 0.420052
0.5767 --- loss: 1.735652, loss_ss: 1.056776, loss_d: 0.678876
0.6151 --- loss: 1.457505, loss_ss: 0.697017, loss_d: 0.760488
0.6536 --- loss: 1.837176, loss_ss: 1.234410, loss_d: 0.602766
0.6920 --- loss: 1.745403, loss_ss: 1.229996, loss_d: 0.515406
0.7305 --- loss: 1.447382, loss_ss: 0.841981, loss_d: 0.605402
0.7689 --- loss: 1.446112, loss_ss: 0.981715, loss_d: 0.464397
0.8074 --- loss: 2.008314, loss_ss: 1.243372, loss_d: 0.764941
0.8458 --- loss: 1.852153, loss_ss: 1.098632, loss_d: 0.753520
0.8843 --- loss: 1.650323, loss_ss: 1.086007, loss_d: 0.564316
0.9227 --- loss: 1.885710, loss_ss: 1.120359, loss_d: 0.765351
0.9612 --- loss: 1.488357, loss_ss: 1.138683, loss_d: 0.349673
0.9996 --- loss: 1.871641, loss_ss: 1.699982, loss_d: 0.171659
Epoch finished! Loss: 1.648427906861672
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.440301, loss_ss: 1.142730, loss_d: 0.297571
0.0384 --- loss: 1.571214, loss_ss: 0.868001, loss_d: 0.703213
0.0769 --- loss: 1.829599, loss_ss: 1.134025, loss_d: 0.695573
0.1153 --- loss: 1.445724, loss_ss: 1.001499, loss_d: 0.444226
0.1538 --- loss: 1.855765, loss_ss: 1.082201, loss_d: 0.773564
0.1922 --- loss: 1.352748, loss_ss: 0.901715, loss_d: 0.451033
0.2307 --- loss: 1.581067, loss_ss: 1.075428, loss_d: 0.505639
0.2691 --- loss: 1.335703, loss_ss: 1.069268, loss_d: 0.266435
0.3076 --- loss: 1.658498, loss_ss: 0.980748, loss_d: 0.677750
0.3460 --- loss: 1.610933, loss_ss: 1.033690, loss_d: 0.577243
0.3845 --- loss: 1.301128, loss_ss: 0.875717, loss_d: 0.425411
0.4229 --- loss: 1.713560, loss_ss: 0.972516, loss_d: 0.741044
0.4614 --- loss: 1.154358, loss_ss: 0.835705, loss_d: 0.318652
0.4998 --- loss: 1.344000, loss_ss: 0.925243, loss_d: 0.418757
0.5383 --- loss: 1.562328, loss_ss: 1.016850, loss_d: 0.545478
0.5767 --- loss: 1.378237, loss_ss: 1.023747, loss_d: 0.354490
0.6151 --- loss: 1.253091, loss_ss: 1.019714, loss_d: 0.233377
0.6536 --- loss: 1.651733, loss_ss: 1.405623, loss_d: 0.246110
0.6920 --- loss: 1.622216, loss_ss: 1.048395, loss_d: 0.573821
0.7305 --- loss: 1.702763, loss_ss: 0.856619, loss_d: 0.846143
0.7689 --- loss: 2.043521, loss_ss: 0.897210, loss_d: 1.146312
0.8074 --- loss: 1.360116, loss_ss: 1.032827, loss_d: 0.327288
0.8458 --- loss: 1.416813, loss_ss: 0.794424, loss_d: 0.622389
0.8843 --- loss: 1.234380, loss_ss: 0.974124, loss_d: 0.260256
0.9227 --- loss: 1.300043, loss_ss: 0.853217, loss_d: 0.446827
0.9612 --- loss: 1.380471, loss_ss: 0.848405, loss_d: 0.532066
0.9996 --- loss: 1.798267, loss_ss: 1.577661, loss_d: 0.220606
Epoch finished! Loss: 1.5214840164551369
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.360699, loss_ss: 0.894897, loss_d: 0.465801
0.0384 --- loss: 1.703155, loss_ss: 1.140806, loss_d: 0.562349
0.0769 --- loss: 1.246144, loss_ss: 1.039076, loss_d: 0.207068
0.1153 --- loss: 1.244416, loss_ss: 1.012535, loss_d: 0.231881
0.1538 --- loss: 1.209731, loss_ss: 0.897825, loss_d: 0.311906
0.1922 --- loss: 1.025863, loss_ss: 0.761343, loss_d: 0.264520
0.2307 --- loss: 1.175595, loss_ss: 0.836709, loss_d: 0.338886
0.2691 --- loss: 1.417366, loss_ss: 0.989075, loss_d: 0.428290
0.3076 --- loss: 1.263822, loss_ss: 0.921929, loss_d: 0.341892
0.3460 --- loss: 1.292930, loss_ss: 0.926410, loss_d: 0.366520
0.3845 --- loss: 1.267704, loss_ss: 1.002977, loss_d: 0.264727
0.4229 --- loss: 1.097414, loss_ss: 0.821821, loss_d: 0.275594
0.4614 --- loss: 1.274554, loss_ss: 0.714499, loss_d: 0.560055
0.4998 --- loss: 1.165184, loss_ss: 0.783656, loss_d: 0.381528
0.5383 --- loss: 1.512531, loss_ss: 1.060006, loss_d: 0.452524
0.5767 --- loss: 1.285858, loss_ss: 0.948802, loss_d: 0.337056
0.6151 --- loss: 1.415861, loss_ss: 1.262263, loss_d: 0.153598
0.6536 --- loss: 1.171067, loss_ss: 0.860026, loss_d: 0.311040
0.6920 --- loss: 1.487338, loss_ss: 1.149353, loss_d: 0.337985
0.7305 --- loss: 1.762386, loss_ss: 1.287565, loss_d: 0.474821
0.7689 --- loss: 1.318524, loss_ss: 0.842971, loss_d: 0.475553
0.8074 --- loss: 1.882371, loss_ss: 1.248568, loss_d: 0.633803
0.8458 --- loss: 1.677946, loss_ss: 1.325203, loss_d: 0.352743
0.8843 --- loss: 1.245391, loss_ss: 0.784597, loss_d: 0.460794
0.9227 --- loss: 1.172546, loss_ss: 0.961942, loss_d: 0.210604
0.9612 --- loss: 1.148870, loss_ss: 0.954066, loss_d: 0.194804
0.9996 --- loss: 2.370887, loss_ss: 2.200895, loss_d: 0.169992
Epoch finished! Loss: 1.4228499985658205
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 0.987577, loss_ss: 0.729866, loss_d: 0.257711
0.0384 --- loss: 1.361727, loss_ss: 1.164406, loss_d: 0.197321
0.0769 --- loss: 1.540453, loss_ss: 1.223732, loss_d: 0.316721
0.1153 --- loss: 1.188599, loss_ss: 0.927047, loss_d: 0.261553
0.1538 --- loss: 1.220290, loss_ss: 0.841625, loss_d: 0.378665
0.1922 --- loss: 1.212646, loss_ss: 0.983761, loss_d: 0.228886
0.2307 --- loss: 1.127317, loss_ss: 0.845031, loss_d: 0.282286
0.2691 --- loss: 1.552226, loss_ss: 0.950453, loss_d: 0.601772
0.3076 --- loss: 1.451879, loss_ss: 1.125605, loss_d: 0.326275
0.3460 --- loss: 1.320871, loss_ss: 0.862372, loss_d: 0.458499
0.3845 --- loss: 1.211042, loss_ss: 0.842099, loss_d: 0.368944
0.4229 --- loss: 1.239800, loss_ss: 0.946152, loss_d: 0.293648
0.4614 --- loss: 1.345616, loss_ss: 0.877234, loss_d: 0.468381
0.4998 --- loss: 1.885316, loss_ss: 1.084319, loss_d: 0.800997
0.5383 --- loss: 1.122093, loss_ss: 0.745043, loss_d: 0.377050
0.5767 --- loss: 0.946264, loss_ss: 0.657062, loss_d: 0.289202
0.6151 --- loss: 1.626456, loss_ss: 1.004444, loss_d: 0.622013
0.6536 --- loss: 1.145970, loss_ss: 0.888742, loss_d: 0.257228
0.6920 --- loss: 1.443375, loss_ss: 1.015016, loss_d: 0.428360
0.7305 --- loss: 1.350503, loss_ss: 0.964883, loss_d: 0.385620
0.7689 --- loss: 1.070241, loss_ss: 0.763532, loss_d: 0.306709
0.8074 --- loss: 1.094294, loss_ss: 0.880003, loss_d: 0.214291
0.8458 --- loss: 1.613816, loss_ss: 1.293428, loss_d: 0.320388
0.8843 --- loss: 1.346669, loss_ss: 0.782504, loss_d: 0.564165
0.9227 --- loss: 0.942280, loss_ss: 0.725152, loss_d: 0.217128
0.9612 --- loss: 1.095902, loss_ss: 0.914038, loss_d: 0.181864
0.9996 --- loss: 1.646676, loss_ss: 1.561871, loss_d: 0.084805
Epoch finished! Loss: 1.3455036064753165
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.734391, loss_ss: 1.267097, loss_d: 0.467295
0.0384 --- loss: 1.150538, loss_ss: 0.944263, loss_d: 0.206275
0.0769 --- loss: 1.301896, loss_ss: 1.152430, loss_d: 0.149466
0.1153 --- loss: 1.550173, loss_ss: 1.130264, loss_d: 0.419909
0.1538 --- loss: 0.945534, loss_ss: 0.594120, loss_d: 0.351413
0.1922 --- loss: 1.317220, loss_ss: 1.077993, loss_d: 0.239227
0.2307 --- loss: 1.349387, loss_ss: 0.908410, loss_d: 0.440977
0.2691 --- loss: 1.099536, loss_ss: 0.961186, loss_d: 0.138350
0.3076 --- loss: 1.505265, loss_ss: 0.954868, loss_d: 0.550397
0.3460 --- loss: 1.166989, loss_ss: 0.974390, loss_d: 0.192599
0.3845 --- loss: 1.302246, loss_ss: 0.853027, loss_d: 0.449219
0.4229 --- loss: 1.223819, loss_ss: 0.855114, loss_d: 0.368705
0.4614 --- loss: 0.961512, loss_ss: 0.749232, loss_d: 0.212280
0.4998 --- loss: 0.957772, loss_ss: 0.641957, loss_d: 0.315815
0.5383 --- loss: 1.280969, loss_ss: 0.836524, loss_d: 0.444446
0.5767 --- loss: 1.390214, loss_ss: 1.063985, loss_d: 0.326228
0.6151 --- loss: 1.326466, loss_ss: 1.059321, loss_d: 0.267145
0.6536 --- loss: 1.079873, loss_ss: 0.907024, loss_d: 0.172849
0.6920 --- loss: 1.443983, loss_ss: 1.056282, loss_d: 0.387701
0.7305 --- loss: 1.506130, loss_ss: 0.916382, loss_d: 0.589749
0.7689 --- loss: 1.336160, loss_ss: 1.070043, loss_d: 0.266116
0.8074 --- loss: 1.288437, loss_ss: 0.731915, loss_d: 0.556522
0.8458 --- loss: 1.258730, loss_ss: 0.980757, loss_d: 0.277973
0.8843 --- loss: 1.352845, loss_ss: 0.743224, loss_d: 0.609621
0.9227 --- loss: 1.527197, loss_ss: 1.155801, loss_d: 0.371396
0.9612 --- loss: 1.009749, loss_ss: 0.812504, loss_d: 0.197244
0.9996 --- loss: 3.318738, loss_ss: 3.196545, loss_d: 0.122193
Epoch finished! Loss: 1.2807154884705176
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.411993, loss_ss: 1.191934, loss_d: 0.220059
0.0384 --- loss: 1.287855, loss_ss: 1.029718, loss_d: 0.258137
0.0769 --- loss: 1.361423, loss_ss: 1.186776, loss_d: 0.174647
0.1153 --- loss: 1.297467, loss_ss: 0.780468, loss_d: 0.516999
0.1538 --- loss: 1.091887, loss_ss: 0.822089, loss_d: 0.269797
0.1922 --- loss: 0.984878, loss_ss: 0.772894, loss_d: 0.211984
0.2307 --- loss: 1.511477, loss_ss: 1.009781, loss_d: 0.501696
0.2691 --- loss: 1.893205, loss_ss: 1.061024, loss_d: 0.832181
0.3076 --- loss: 1.416413, loss_ss: 0.779735, loss_d: 0.636678
0.3460 --- loss: 1.682529, loss_ss: 1.313745, loss_d: 0.368784
0.3845 --- loss: 1.303622, loss_ss: 0.726095, loss_d: 0.577527
0.4229 --- loss: 0.874148, loss_ss: 0.736285, loss_d: 0.137863
0.4614 --- loss: 1.491284, loss_ss: 1.145298, loss_d: 0.345986
0.4998 --- loss: 1.014349, loss_ss: 0.866843, loss_d: 0.147507
0.5383 --- loss: 1.472573, loss_ss: 1.258529, loss_d: 0.214044
0.5767 --- loss: 1.929144, loss_ss: 1.257520, loss_d: 0.671624
0.6151 --- loss: 1.348925, loss_ss: 0.867614, loss_d: 0.481310
0.6536 --- loss: 1.754833, loss_ss: 1.374853, loss_d: 0.379981
0.6920 --- loss: 1.166006, loss_ss: 0.699702, loss_d: 0.466304
0.7305 --- loss: 1.329800, loss_ss: 0.889542, loss_d: 0.440258
0.7689 --- loss: 1.584892, loss_ss: 0.876422, loss_d: 0.708470
0.8074 --- loss: 1.246909, loss_ss: 1.065539, loss_d: 0.181371
0.8458 --- loss: 1.192519, loss_ss: 0.842086, loss_d: 0.350433
0.8843 --- loss: 1.073020, loss_ss: 0.917006, loss_d: 0.156014
0.9227 --- loss: 1.153883, loss_ss: 0.673059, loss_d: 0.480824
0.9612 --- loss: 1.022913, loss_ss: 0.745091, loss_d: 0.277822
0.9996 --- loss: 1.046805, loss_ss: 1.019948, loss_d: 0.026856
Epoch finished! Loss: 1.2382953293048418
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.155367, loss_ss: 0.953588, loss_d: 0.201780
0.0384 --- loss: 1.183219, loss_ss: 0.848312, loss_d: 0.334908
0.0769 --- loss: 1.027256, loss_ss: 0.922712, loss_d: 0.104543
0.1153 --- loss: 0.948178, loss_ss: 0.822685, loss_d: 0.125492
0.1538 --- loss: 1.758496, loss_ss: 0.731957, loss_d: 1.026539
0.1922 --- loss: 1.052090, loss_ss: 0.798042, loss_d: 0.254048
0.2307 --- loss: 1.120374, loss_ss: 0.799084, loss_d: 0.321290
0.2691 --- loss: 1.207462, loss_ss: 0.868524, loss_d: 0.338938
0.3076 --- loss: 1.033022, loss_ss: 0.801316, loss_d: 0.231706
0.3460 --- loss: 1.083535, loss_ss: 0.970888, loss_d: 0.112647
0.3845 --- loss: 1.083386, loss_ss: 0.631464, loss_d: 0.451922
0.4229 --- loss: 1.303991, loss_ss: 0.865849, loss_d: 0.438142
0.4614 --- loss: 0.952703, loss_ss: 0.786681, loss_d: 0.166022
0.4998 --- loss: 1.255067, loss_ss: 1.069209, loss_d: 0.185858
0.5383 --- loss: 0.988824, loss_ss: 0.878824, loss_d: 0.109999
0.5767 --- loss: 1.296990, loss_ss: 0.992362, loss_d: 0.304628
0.6151 --- loss: 1.003206, loss_ss: 0.784065, loss_d: 0.219141
0.6536 --- loss: 1.023575, loss_ss: 0.803859, loss_d: 0.219716
0.6920 --- loss: 1.570339, loss_ss: 1.224952, loss_d: 0.345387
0.7305 --- loss: 0.922011, loss_ss: 0.698556, loss_d: 0.223454
0.7689 --- loss: 1.118001, loss_ss: 0.907078, loss_d: 0.210923
0.8074 --- loss: 0.788180, loss_ss: 0.649320, loss_d: 0.138860
0.8458 --- loss: 1.066671, loss_ss: 0.749739, loss_d: 0.316933
0.8843 --- loss: 1.392841, loss_ss: 1.062644, loss_d: 0.330197
0.9227 --- loss: 0.858594, loss_ss: 0.738216, loss_d: 0.120377
0.9612 --- loss: 1.294842, loss_ss: 1.003159, loss_d: 0.291684
0.9996 --- loss: 0.950750, loss_ss: 0.922152, loss_d: 0.028598
Epoch finished! Loss: 1.1661205128981518
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.096473, loss_ss: 0.905336, loss_d: 0.191137
0.0384 --- loss: 0.903913, loss_ss: 0.713627, loss_d: 0.190287
0.0769 --- loss: 0.992536, loss_ss: 0.704134, loss_d: 0.288402
0.1153 --- loss: 1.794879, loss_ss: 0.936588, loss_d: 0.858291
0.1538 --- loss: 1.310605, loss_ss: 0.813110, loss_d: 0.497495
0.1922 --- loss: 1.241084, loss_ss: 0.807274, loss_d: 0.433809
0.2307 --- loss: 0.844997, loss_ss: 0.691612, loss_d: 0.153385
0.2691 --- loss: 1.005082, loss_ss: 0.749248, loss_d: 0.255834
0.3076 --- loss: 1.472809, loss_ss: 0.853404, loss_d: 0.619405
0.3460 --- loss: 1.208860, loss_ss: 0.996409, loss_d: 0.212451
0.3845 --- loss: 1.299107, loss_ss: 1.050475, loss_d: 0.248632
0.4229 --- loss: 1.130690, loss_ss: 0.904970, loss_d: 0.225721
0.4614 --- loss: 0.722287, loss_ss: 0.530204, loss_d: 0.192083
0.4998 --- loss: 0.948834, loss_ss: 0.787794, loss_d: 0.161040
0.5383 --- loss: 1.014557, loss_ss: 0.956359, loss_d: 0.058198
0.5767 --- loss: 1.051841, loss_ss: 0.953548, loss_d: 0.098294
0.6151 --- loss: 0.833261, loss_ss: 0.766437, loss_d: 0.066824
0.6536 --- loss: 0.922665, loss_ss: 0.647732, loss_d: 0.274932
0.6920 --- loss: 1.453009, loss_ss: 1.241723, loss_d: 0.211287
0.7305 --- loss: 1.588714, loss_ss: 0.675694, loss_d: 0.913020
0.7689 --- loss: 1.370105, loss_ss: 0.985539, loss_d: 0.384566
0.8074 --- loss: 1.319844, loss_ss: 1.175845, loss_d: 0.143999
0.8458 --- loss: 0.966904, loss_ss: 0.849904, loss_d: 0.117000
0.8843 --- loss: 1.010790, loss_ss: 0.959544, loss_d: 0.051246
0.9227 --- loss: 0.865974, loss_ss: 0.818177, loss_d: 0.047797
0.9612 --- loss: 1.292641, loss_ss: 1.064459, loss_d: 0.228182
0.9996 --- loss: 1.292296, loss_ss: 1.230684, loss_d: 0.061612
Epoch finished! Loss: 1.1281613148175753
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.35765765765765767
             precision    recall  f1-score   support

        0.0       0.89      0.12      0.21       211
        1.0       0.00      0.00      0.00       184
        2.0       0.53      0.28      0.37       408
        3.0       0.28      1.00      0.44       130
        4.0       0.32      0.71      0.44       177

avg / total       0.45      0.36      0.30      1110
 


====== chp055-nsrr ======

The ppr of  1  has ZeroDivisionError.

The f1-score of  1  has ZeroDivisionError.
   acc %   sen %  spec %  ppr %  f1-score
0  82.97   11.85   99.67  89.29     20.92
1  83.42    0.00  100.00   0.00      0.00
2  64.41   28.43   85.33  52.97     37.00
3  69.82  100.00   65.82  27.96     43.70
4  70.90   71.19   70.85  31.66     43.83
Total accuracy: 35.77%
Average sen: 42.29%
Average spec: 84.33%
Macro f1-score: 29.09%
Diagnosis acc on 15mins: 1.0
[0.87314332 0.91508132 0.86634743 0.84151745 0.84138042 0.84711826
 0.91483933 0.88328958 0.70537519 0.94408256 0.92478693 0.94229668
 0.84770501 0.87960786 0.91459376 0.90886199 0.89715803 0.94892746
 0.95254582 0.85747415 0.75686556 0.91684896 0.87132806 0.9098742
 0.87719226 0.82964832 0.88700777 0.62907094 0.85330337 0.91813558
 0.92710567 0.5382297  0.95935458 0.93520319 0.90859354 0.83111912
 0.89594138]
pred: 0.8689447222529231, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp056-nsrr. train_data(2602), test_data(36) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.535299, loss_ss: 1.841776, loss_d: 0.693522
0.0384 --- loss: 2.281734, loss_ss: 1.499033, loss_d: 0.782701
0.0769 --- loss: 2.442321, loss_ss: 1.737869, loss_d: 0.704452
0.1153 --- loss: 1.876213, loss_ss: 1.342852, loss_d: 0.533361
0.1537 --- loss: 1.966408, loss_ss: 1.446700, loss_d: 0.519709
0.1922 --- loss: 1.922689, loss_ss: 1.440285, loss_d: 0.482403
0.2306 --- loss: 1.957663, loss_ss: 1.404392, loss_d: 0.553271
0.2690 --- loss: 1.879798, loss_ss: 1.478008, loss_d: 0.401790
0.3075 --- loss: 2.251875, loss_ss: 1.463908, loss_d: 0.787968
0.3459 --- loss: 1.835053, loss_ss: 1.251524, loss_d: 0.583529
0.3843 --- loss: 2.152046, loss_ss: 1.468308, loss_d: 0.683737
0.4228 --- loss: 1.597537, loss_ss: 1.143303, loss_d: 0.454233
0.4612 --- loss: 1.985855, loss_ss: 1.195092, loss_d: 0.790763
0.4996 --- loss: 2.058326, loss_ss: 1.564888, loss_d: 0.493438
0.5380 --- loss: 1.825424, loss_ss: 1.274532, loss_d: 0.550891
0.5765 --- loss: 1.783356, loss_ss: 1.318925, loss_d: 0.464432
0.6149 --- loss: 1.795056, loss_ss: 1.330644, loss_d: 0.464412
0.6533 --- loss: 1.972873, loss_ss: 1.418336, loss_d: 0.554537
0.6918 --- loss: 1.836831, loss_ss: 1.294136, loss_d: 0.542696
0.7302 --- loss: 2.259732, loss_ss: 1.413337, loss_d: 0.846395
0.7686 --- loss: 1.889812, loss_ss: 1.217635, loss_d: 0.672177
0.8071 --- loss: 1.430067, loss_ss: 0.985244, loss_d: 0.444823
0.8455 --- loss: 1.708949, loss_ss: 1.106744, loss_d: 0.602205
0.8839 --- loss: 1.925062, loss_ss: 1.206712, loss_d: 0.718350
0.9224 --- loss: 1.499471, loss_ss: 1.125263, loss_d: 0.374207
0.9608 --- loss: 2.051135, loss_ss: 1.314701, loss_d: 0.736434
0.9992 --- loss: 2.120534, loss_ss: 1.805599, loss_d: 0.314935
Epoch finished! Loss: 1.9340481726022867
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.622879, loss_ss: 1.170155, loss_d: 0.452724
0.0384 --- loss: 1.906474, loss_ss: 1.404046, loss_d: 0.502429
0.0769 --- loss: 1.762239, loss_ss: 1.356280, loss_d: 0.405959
0.1153 --- loss: 1.618366, loss_ss: 1.118673, loss_d: 0.499694
0.1537 --- loss: 1.947084, loss_ss: 1.231122, loss_d: 0.715962
0.1922 --- loss: 1.837058, loss_ss: 1.220932, loss_d: 0.616126
0.2306 --- loss: 1.643546, loss_ss: 0.986124, loss_d: 0.657421
0.2690 --- loss: 1.531502, loss_ss: 0.967642, loss_d: 0.563860
0.3075 --- loss: 1.888372, loss_ss: 1.250157, loss_d: 0.638215
0.3459 --- loss: 1.687992, loss_ss: 1.111228, loss_d: 0.576764
0.3843 --- loss: 1.642148, loss_ss: 1.070587, loss_d: 0.571561
0.4228 --- loss: 1.598865, loss_ss: 1.278295, loss_d: 0.320570
0.4612 --- loss: 1.714044, loss_ss: 1.139668, loss_d: 0.574376
0.4996 --- loss: 1.798081, loss_ss: 1.210060, loss_d: 0.588021
0.5380 --- loss: 1.591323, loss_ss: 1.109485, loss_d: 0.481838
0.5765 --- loss: 1.899915, loss_ss: 1.149221, loss_d: 0.750693
0.6149 --- loss: 1.566541, loss_ss: 1.043495, loss_d: 0.523046
0.6533 --- loss: 1.368452, loss_ss: 0.987932, loss_d: 0.380520
0.6918 --- loss: 2.349830, loss_ss: 1.297346, loss_d: 1.052485
0.7302 --- loss: 1.662642, loss_ss: 0.988220, loss_d: 0.674421
0.7686 --- loss: 1.577999, loss_ss: 1.067955, loss_d: 0.510044
0.8071 --- loss: 1.830444, loss_ss: 1.313474, loss_d: 0.516970
0.8455 --- loss: 1.592443, loss_ss: 0.938486, loss_d: 0.653957
0.8839 --- loss: 1.451942, loss_ss: 0.978389, loss_d: 0.473553
0.9224 --- loss: 1.357595, loss_ss: 1.056418, loss_d: 0.301178
0.9608 --- loss: 1.705978, loss_ss: 1.171276, loss_d: 0.534702
0.9992 --- loss: 1.837068, loss_ss: 1.116909, loss_d: 0.720158
Epoch finished! Loss: 1.685851454276305
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.547424, loss_ss: 1.061281, loss_d: 0.486143
0.0384 --- loss: 1.378676, loss_ss: 0.866625, loss_d: 0.512051
0.0769 --- loss: 1.500530, loss_ss: 1.085548, loss_d: 0.414981
0.1153 --- loss: 1.356570, loss_ss: 0.984277, loss_d: 0.372292
0.1537 --- loss: 1.291503, loss_ss: 0.925683, loss_d: 0.365821
0.1922 --- loss: 1.786828, loss_ss: 1.349714, loss_d: 0.437114
0.2306 --- loss: 1.874234, loss_ss: 1.291680, loss_d: 0.582554
0.2690 --- loss: 1.335255, loss_ss: 0.855903, loss_d: 0.479352
0.3075 --- loss: 1.203792, loss_ss: 0.925840, loss_d: 0.277952
0.3459 --- loss: 1.130989, loss_ss: 0.779248, loss_d: 0.351740
0.3843 --- loss: 1.620090, loss_ss: 0.901438, loss_d: 0.718652
0.4228 --- loss: 1.485317, loss_ss: 0.914719, loss_d: 0.570598
0.4612 --- loss: 1.311708, loss_ss: 0.973220, loss_d: 0.338488
0.4996 --- loss: 1.787554, loss_ss: 0.949886, loss_d: 0.837669
0.5380 --- loss: 1.633009, loss_ss: 0.964335, loss_d: 0.668674
0.5765 --- loss: 1.083361, loss_ss: 0.789493, loss_d: 0.293868
0.6149 --- loss: 1.717832, loss_ss: 0.928749, loss_d: 0.789083
0.6533 --- loss: 1.501866, loss_ss: 1.152311, loss_d: 0.349555
0.6918 --- loss: 1.555751, loss_ss: 0.853059, loss_d: 0.702692
0.7302 --- loss: 2.596089, loss_ss: 1.907580, loss_d: 0.688509
0.7686 --- loss: 1.246886, loss_ss: 0.752527, loss_d: 0.494359
0.8071 --- loss: 1.274047, loss_ss: 0.921557, loss_d: 0.352489
0.8455 --- loss: 1.492562, loss_ss: 1.040715, loss_d: 0.451846
0.8839 --- loss: 1.606024, loss_ss: 1.146847, loss_d: 0.459177
0.9224 --- loss: 1.328537, loss_ss: 1.074704, loss_d: 0.253833
0.9608 --- loss: 1.070049, loss_ss: 0.791730, loss_d: 0.278320
0.9992 --- loss: 1.152052, loss_ss: 0.827588, loss_d: 0.324463
Epoch finished! Loss: 1.5169108046935156
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.164662, loss_ss: 0.716552, loss_d: 0.448110
0.0384 --- loss: 1.141101, loss_ss: 0.745860, loss_d: 0.395242
0.0769 --- loss: 1.576482, loss_ss: 0.972038, loss_d: 0.604444
0.1153 --- loss: 1.335264, loss_ss: 0.850996, loss_d: 0.484268
0.1537 --- loss: 1.534358, loss_ss: 1.076010, loss_d: 0.458349
0.1922 --- loss: 1.555322, loss_ss: 1.167328, loss_d: 0.387994
0.2306 --- loss: 1.667222, loss_ss: 0.949937, loss_d: 0.717285
0.2690 --- loss: 1.680531, loss_ss: 0.839369, loss_d: 0.841162
0.3075 --- loss: 1.252524, loss_ss: 0.949334, loss_d: 0.303190
0.3459 --- loss: 2.018834, loss_ss: 1.309737, loss_d: 0.709097
0.3843 --- loss: 1.351599, loss_ss: 1.042287, loss_d: 0.309312
0.4228 --- loss: 1.615075, loss_ss: 0.801986, loss_d: 0.813089
0.4612 --- loss: 1.451852, loss_ss: 0.781922, loss_d: 0.669930
0.4996 --- loss: 1.378373, loss_ss: 1.013276, loss_d: 0.365098
0.5380 --- loss: 1.192405, loss_ss: 0.887278, loss_d: 0.305127
0.5765 --- loss: 1.675453, loss_ss: 0.980222, loss_d: 0.695231
0.6149 --- loss: 1.326815, loss_ss: 1.113079, loss_d: 0.213737
0.6533 --- loss: 1.270409, loss_ss: 0.997375, loss_d: 0.273034
0.6918 --- loss: 1.312230, loss_ss: 1.042363, loss_d: 0.269867
0.7302 --- loss: 1.558578, loss_ss: 0.771334, loss_d: 0.787243
0.7686 --- loss: 1.180455, loss_ss: 0.929969, loss_d: 0.250486
0.8071 --- loss: 1.049879, loss_ss: 0.761309, loss_d: 0.288570
0.8455 --- loss: 1.048283, loss_ss: 0.782786, loss_d: 0.265497
0.8839 --- loss: 1.887356, loss_ss: 1.161801, loss_d: 0.725555
0.9224 --- loss: 1.193431, loss_ss: 0.925532, loss_d: 0.267899
0.9608 --- loss: 1.312458, loss_ss: 1.011467, loss_d: 0.300991
0.9992 --- loss: 1.934033, loss_ss: 1.651239, loss_d: 0.282794
Epoch finished! Loss: 1.4502970282848064
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.173988, loss_ss: 0.903748, loss_d: 0.270239
0.0384 --- loss: 1.116001, loss_ss: 0.888318, loss_d: 0.227683
0.0769 --- loss: 1.366668, loss_ss: 0.987585, loss_d: 0.379083
0.1153 --- loss: 1.167077, loss_ss: 0.817914, loss_d: 0.349163
0.1537 --- loss: 1.109857, loss_ss: 0.812410, loss_d: 0.297446
0.1922 --- loss: 1.143332, loss_ss: 0.743956, loss_d: 0.399376
0.2306 --- loss: 1.502294, loss_ss: 0.829007, loss_d: 0.673288
0.2690 --- loss: 1.208148, loss_ss: 0.827630, loss_d: 0.380519
0.3075 --- loss: 1.502908, loss_ss: 1.248814, loss_d: 0.254094
0.3459 --- loss: 1.425689, loss_ss: 1.035182, loss_d: 0.390507
0.3843 --- loss: 1.738625, loss_ss: 1.062652, loss_d: 0.675973
0.4228 --- loss: 1.736588, loss_ss: 1.463978, loss_d: 0.272610
0.4612 --- loss: 0.987636, loss_ss: 0.805672, loss_d: 0.181965
0.4996 --- loss: 1.249654, loss_ss: 1.030172, loss_d: 0.219482
0.5380 --- loss: 1.357241, loss_ss: 0.919964, loss_d: 0.437277
0.5765 --- loss: 1.208477, loss_ss: 0.877340, loss_d: 0.331138
0.6149 --- loss: 1.402255, loss_ss: 1.039073, loss_d: 0.363182
0.6533 --- loss: 1.725617, loss_ss: 1.297645, loss_d: 0.427972
0.6918 --- loss: 1.453205, loss_ss: 0.794110, loss_d: 0.659095
0.7302 --- loss: 1.224996, loss_ss: 1.073086, loss_d: 0.151910
0.7686 --- loss: 1.240532, loss_ss: 0.713246, loss_d: 0.527285
0.8071 --- loss: 1.356500, loss_ss: 0.775179, loss_d: 0.581321
0.8455 --- loss: 1.450475, loss_ss: 0.973240, loss_d: 0.477235
0.8839 --- loss: 1.216388, loss_ss: 0.942752, loss_d: 0.273636
0.9224 --- loss: 1.593377, loss_ss: 0.843093, loss_d: 0.750284
0.9608 --- loss: 1.311943, loss_ss: 0.750275, loss_d: 0.561669
0.9992 --- loss: 1.167540, loss_ss: 0.956673, loss_d: 0.210867
Epoch finished! Loss: 1.3638303972207584
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.385067, loss_ss: 0.823117, loss_d: 0.561950
0.0384 --- loss: 0.945745, loss_ss: 0.740435, loss_d: 0.205311
0.0769 --- loss: 1.537100, loss_ss: 1.131470, loss_d: 0.405630
0.1153 --- loss: 0.937371, loss_ss: 0.665580, loss_d: 0.271791
0.1537 --- loss: 0.877700, loss_ss: 0.711755, loss_d: 0.165944
0.1922 --- loss: 1.353882, loss_ss: 0.893325, loss_d: 0.460557
0.2306 --- loss: 1.241703, loss_ss: 0.881436, loss_d: 0.360267
0.2690 --- loss: 1.187314, loss_ss: 0.915370, loss_d: 0.271944
0.3075 --- loss: 1.677384, loss_ss: 1.076593, loss_d: 0.600791
0.3459 --- loss: 1.276410, loss_ss: 0.778148, loss_d: 0.498262
0.3843 --- loss: 1.261444, loss_ss: 0.898797, loss_d: 0.362647
0.4228 --- loss: 1.007964, loss_ss: 0.852698, loss_d: 0.155266
0.4612 --- loss: 1.374741, loss_ss: 0.766245, loss_d: 0.608496
0.4996 --- loss: 1.117688, loss_ss: 0.899772, loss_d: 0.217916
0.5380 --- loss: 1.349721, loss_ss: 1.093097, loss_d: 0.256624
0.5765 --- loss: 1.577778, loss_ss: 1.229385, loss_d: 0.348393
0.6149 --- loss: 1.438350, loss_ss: 0.851719, loss_d: 0.586631
0.6533 --- loss: 1.551514, loss_ss: 0.799298, loss_d: 0.752217
0.6918 --- loss: 1.091883, loss_ss: 0.824654, loss_d: 0.267229
0.7302 --- loss: 1.272442, loss_ss: 0.787523, loss_d: 0.484919
0.7686 --- loss: 1.279571, loss_ss: 0.983595, loss_d: 0.295976
0.8071 --- loss: 1.197021, loss_ss: 0.677726, loss_d: 0.519295
0.8455 --- loss: 1.273050, loss_ss: 0.854302, loss_d: 0.418747
0.8839 --- loss: 1.052898, loss_ss: 0.806340, loss_d: 0.246558
0.9224 --- loss: 0.978183, loss_ss: 0.798450, loss_d: 0.179733
0.9608 --- loss: 1.341991, loss_ss: 0.976204, loss_d: 0.365786
0.9992 --- loss: 2.129322, loss_ss: 1.583242, loss_d: 0.546079
Epoch finished! Loss: 1.3034063472197606
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.285179, loss_ss: 0.906731, loss_d: 0.378448
0.0384 --- loss: 1.146457, loss_ss: 0.802173, loss_d: 0.344283
0.0769 --- loss: 0.946713, loss_ss: 0.678245, loss_d: 0.268469
0.1153 --- loss: 1.235631, loss_ss: 0.875634, loss_d: 0.359996
0.1537 --- loss: 1.466427, loss_ss: 0.902106, loss_d: 0.564322
0.1922 --- loss: 1.231396, loss_ss: 0.819112, loss_d: 0.412284
0.2306 --- loss: 1.067536, loss_ss: 0.846511, loss_d: 0.221025
0.2690 --- loss: 1.243304, loss_ss: 0.961830, loss_d: 0.281474
0.3075 --- loss: 1.026006, loss_ss: 0.842991, loss_d: 0.183014
0.3459 --- loss: 1.257532, loss_ss: 0.915354, loss_d: 0.342178
0.3843 --- loss: 1.490837, loss_ss: 1.118319, loss_d: 0.372518
0.4228 --- loss: 1.142139, loss_ss: 0.667668, loss_d: 0.474471
0.4612 --- loss: 1.147849, loss_ss: 0.781000, loss_d: 0.366849
0.4996 --- loss: 1.476331, loss_ss: 0.969445, loss_d: 0.506886
0.5380 --- loss: 1.642325, loss_ss: 1.017601, loss_d: 0.624724
0.5765 --- loss: 1.105122, loss_ss: 0.753972, loss_d: 0.351150
0.6149 --- loss: 1.384244, loss_ss: 1.170758, loss_d: 0.213486
0.6533 --- loss: 0.953930, loss_ss: 0.607867, loss_d: 0.346063
0.6918 --- loss: 1.016868, loss_ss: 0.710200, loss_d: 0.306668
0.7302 --- loss: 1.430286, loss_ss: 1.095998, loss_d: 0.334288
0.7686 --- loss: 1.144620, loss_ss: 0.906090, loss_d: 0.238530
0.8071 --- loss: 1.023679, loss_ss: 0.754883, loss_d: 0.268796
0.8455 --- loss: 1.061274, loss_ss: 0.892518, loss_d: 0.168756
0.8839 --- loss: 1.024884, loss_ss: 0.789299, loss_d: 0.235584
0.9224 --- loss: 1.300919, loss_ss: 0.972542, loss_d: 0.328377
0.9608 --- loss: 1.036832, loss_ss: 0.786474, loss_d: 0.250358
0.9992 --- loss: 0.993650, loss_ss: 0.631227, loss_d: 0.362423
Epoch finished! Loss: 1.2663877739356115
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.494386, loss_ss: 1.149439, loss_d: 0.344947
0.0384 --- loss: 0.945822, loss_ss: 0.674905, loss_d: 0.270917
0.0769 --- loss: 1.820353, loss_ss: 1.235757, loss_d: 0.584597
0.1153 --- loss: 1.072011, loss_ss: 0.675283, loss_d: 0.396728
0.1537 --- loss: 1.034273, loss_ss: 0.837229, loss_d: 0.197045
0.1922 --- loss: 1.677317, loss_ss: 1.120150, loss_d: 0.557167
0.2306 --- loss: 1.107083, loss_ss: 0.879566, loss_d: 0.227518
0.2690 --- loss: 1.183066, loss_ss: 1.071416, loss_d: 0.111650
0.3075 --- loss: 1.181323, loss_ss: 0.805825, loss_d: 0.375499
0.3459 --- loss: 1.605175, loss_ss: 0.738313, loss_d: 0.866862
0.3843 --- loss: 1.619978, loss_ss: 0.926994, loss_d: 0.692983
0.4228 --- loss: 1.267837, loss_ss: 0.836399, loss_d: 0.431438
0.4612 --- loss: 1.347752, loss_ss: 0.786254, loss_d: 0.561498
0.4996 --- loss: 1.177201, loss_ss: 0.948546, loss_d: 0.228655
0.5380 --- loss: 1.162673, loss_ss: 0.932061, loss_d: 0.230612
0.5765 --- loss: 1.587588, loss_ss: 0.954213, loss_d: 0.633376
0.6149 --- loss: 1.526970, loss_ss: 1.017677, loss_d: 0.509293
0.6533 --- loss: 1.143012, loss_ss: 0.783611, loss_d: 0.359401
0.6918 --- loss: 1.261634, loss_ss: 0.863166, loss_d: 0.398468
0.7302 --- loss: 1.158942, loss_ss: 0.929261, loss_d: 0.229681
0.7686 --- loss: 1.113696, loss_ss: 0.732074, loss_d: 0.381622
0.8071 --- loss: 1.346693, loss_ss: 0.914930, loss_d: 0.431763
0.8455 --- loss: 1.020038, loss_ss: 0.795614, loss_d: 0.224424
0.8839 --- loss: 1.260736, loss_ss: 1.048365, loss_d: 0.212372
0.9224 --- loss: 1.003896, loss_ss: 0.733922, loss_d: 0.269974
0.9608 --- loss: 1.071086, loss_ss: 0.949005, loss_d: 0.122081
0.9992 --- loss: 1.752285, loss_ss: 1.393882, loss_d: 0.358403
Epoch finished! Loss: 1.2328884702462417
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.016017, loss_ss: 0.543871, loss_d: 0.472146
0.0384 --- loss: 0.840192, loss_ss: 0.589745, loss_d: 0.250447
0.0769 --- loss: 1.191449, loss_ss: 1.006881, loss_d: 0.184568
0.1153 --- loss: 1.349311, loss_ss: 0.907598, loss_d: 0.441714
0.1537 --- loss: 0.964981, loss_ss: 0.713046, loss_d: 0.251935
0.1922 --- loss: 1.338186, loss_ss: 1.134597, loss_d: 0.203589
0.2306 --- loss: 0.955652, loss_ss: 0.832193, loss_d: 0.123459
0.2690 --- loss: 1.232728, loss_ss: 0.959816, loss_d: 0.272912
0.3075 --- loss: 0.986485, loss_ss: 0.878880, loss_d: 0.107605
0.3459 --- loss: 1.325776, loss_ss: 0.908498, loss_d: 0.417278
0.3843 --- loss: 0.936914, loss_ss: 0.662252, loss_d: 0.274662
0.4228 --- loss: 1.282508, loss_ss: 1.009172, loss_d: 0.273336
0.4612 --- loss: 1.380051, loss_ss: 1.200095, loss_d: 0.179956
0.4996 --- loss: 1.085702, loss_ss: 0.716162, loss_d: 0.369540
0.5380 --- loss: 1.127411, loss_ss: 0.780919, loss_d: 0.346492
0.5765 --- loss: 1.335224, loss_ss: 0.881703, loss_d: 0.453520
0.6149 --- loss: 1.041415, loss_ss: 0.739130, loss_d: 0.302285
0.6533 --- loss: 1.081867, loss_ss: 0.966691, loss_d: 0.115176
0.6918 --- loss: 1.137021, loss_ss: 0.886397, loss_d: 0.250623
0.7302 --- loss: 0.994977, loss_ss: 0.888941, loss_d: 0.106037
0.7686 --- loss: 0.880394, loss_ss: 0.788215, loss_d: 0.092179
0.8071 --- loss: 1.293561, loss_ss: 0.755926, loss_d: 0.537635
0.8455 --- loss: 0.852468, loss_ss: 0.762694, loss_d: 0.089774
0.8839 --- loss: 1.159464, loss_ss: 0.913334, loss_d: 0.246130
0.9224 --- loss: 1.204958, loss_ss: 0.770038, loss_d: 0.434920
0.9608 --- loss: 1.452647, loss_ss: 0.631685, loss_d: 0.820962
0.9992 --- loss: 1.637768, loss_ss: 1.045960, loss_d: 0.591808
Epoch finished! Loss: 1.171560606131187
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.897683, loss_ss: 0.785564, loss_d: 0.112119
0.0384 --- loss: 0.980308, loss_ss: 0.765709, loss_d: 0.214599
0.0769 --- loss: 1.239116, loss_ss: 0.958064, loss_d: 0.281052
0.1153 --- loss: 1.297892, loss_ss: 1.094762, loss_d: 0.203130
0.1537 --- loss: 1.296827, loss_ss: 1.073518, loss_d: 0.223309
0.1922 --- loss: 1.297331, loss_ss: 0.931574, loss_d: 0.365757
0.2306 --- loss: 1.295966, loss_ss: 0.934219, loss_d: 0.361747
0.2690 --- loss: 1.261304, loss_ss: 0.971438, loss_d: 0.289867
0.3075 --- loss: 1.046350, loss_ss: 0.570404, loss_d: 0.475945
0.3459 --- loss: 1.016833, loss_ss: 0.770413, loss_d: 0.246420
0.3843 --- loss: 0.863577, loss_ss: 0.722142, loss_d: 0.141435
0.4228 --- loss: 1.117605, loss_ss: 0.773712, loss_d: 0.343893
0.4612 --- loss: 1.297559, loss_ss: 1.069116, loss_d: 0.228443
0.4996 --- loss: 1.359135, loss_ss: 1.012843, loss_d: 0.346292
0.5380 --- loss: 1.040143, loss_ss: 0.803167, loss_d: 0.236976
0.5765 --- loss: 1.004260, loss_ss: 0.901089, loss_d: 0.103172
0.6149 --- loss: 1.567741, loss_ss: 1.402534, loss_d: 0.165207
0.6533 --- loss: 0.918701, loss_ss: 0.773288, loss_d: 0.145413
0.6918 --- loss: 1.169422, loss_ss: 0.774479, loss_d: 0.394942
0.7302 --- loss: 1.150985, loss_ss: 0.818565, loss_d: 0.332420
0.7686 --- loss: 1.074035, loss_ss: 0.849547, loss_d: 0.224488
0.8071 --- loss: 1.052667, loss_ss: 0.825607, loss_d: 0.227060
0.8455 --- loss: 1.057329, loss_ss: 0.538382, loss_d: 0.518947
0.8839 --- loss: 0.978595, loss_ss: 0.670046, loss_d: 0.308549
0.9224 --- loss: 0.940213, loss_ss: 0.789815, loss_d: 0.150398
0.9608 --- loss: 1.101033, loss_ss: 0.794930, loss_d: 0.306103
0.9992 --- loss: 1.336338, loss_ss: 1.165496, loss_d: 0.170842
Epoch finished! Loss: 1.1519025921821595
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6166666666666667
             precision    recall  f1-score   support

        0.0       0.23      0.72      0.35        78
        1.0       0.57      0.16      0.25       284
        2.0       0.67      0.87      0.76       258
        3.0       0.94      0.97      0.96       185
        4.0       0.69      0.58      0.63       275

avg / total       0.66      0.62      0.60      1080
 


====== chp056-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.74  71.79   81.44  23.14     35.00
1  74.72  16.20   95.60  56.79     25.21
2  86.76  86.82   86.74  67.27     75.80
3  98.52  97.30   98.77  94.24     95.74
4  82.59  58.18   90.93  68.67     62.99
Total accuracy: 61.67%
Average sen: 66.06%
Average spec: 90.70%
Macro f1-score: 58.95%
Diagnosis acc on 15mins: 1.0
[0.99920779 0.9963187  0.99911636 0.99761605 0.99961412 0.99990201
 0.99973923 0.99951577 0.9992736  0.99953735 0.99993718 0.99976879
 0.89499319 0.99988949 0.99974698 0.99967527 0.99998844 0.99998856
 0.9997043  0.9996599  0.99996042 0.99996269 0.99989486 0.99918681
 0.99880385 0.99895775 0.99763656 0.91823435 0.99935573 0.99983346
 0.99973959 0.99995661 0.99993956 0.99893636 0.99924314 0.99685526]
pred: 0.9941580577029122, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp057-nsrr. train_data(2599), test_data(39) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.360819, loss_ss: 1.693481, loss_d: 0.667338
0.0385 --- loss: 2.636480, loss_ss: 1.759866, loss_d: 0.876614
0.0770 --- loss: 2.058981, loss_ss: 1.460257, loss_d: 0.598723
0.1154 --- loss: 1.705115, loss_ss: 1.430970, loss_d: 0.274145
0.1539 --- loss: 2.066339, loss_ss: 1.511414, loss_d: 0.554925
0.1924 --- loss: 1.996842, loss_ss: 1.256767, loss_d: 0.740075
0.2309 --- loss: 2.211557, loss_ss: 1.435896, loss_d: 0.775661
0.2693 --- loss: 1.932203, loss_ss: 1.482723, loss_d: 0.449480
0.3078 --- loss: 1.875247, loss_ss: 1.380510, loss_d: 0.494737
0.3463 --- loss: 1.983191, loss_ss: 1.500228, loss_d: 0.482962
0.3848 --- loss: 1.888019, loss_ss: 1.378880, loss_d: 0.509138
0.4232 --- loss: 2.274725, loss_ss: 1.416565, loss_d: 0.858159
0.4617 --- loss: 1.810330, loss_ss: 1.335630, loss_d: 0.474700
0.5002 --- loss: 2.069289, loss_ss: 1.432463, loss_d: 0.636826
0.5387 --- loss: 2.090437, loss_ss: 1.255167, loss_d: 0.835269
0.5771 --- loss: 1.983069, loss_ss: 1.395890, loss_d: 0.587179
0.6156 --- loss: 2.087894, loss_ss: 1.344675, loss_d: 0.743219
0.6541 --- loss: 1.883212, loss_ss: 1.355987, loss_d: 0.527225
0.6926 --- loss: 1.663394, loss_ss: 1.271379, loss_d: 0.392015
0.7311 --- loss: 2.010753, loss_ss: 1.269308, loss_d: 0.741446
0.7695 --- loss: 1.655220, loss_ss: 1.270597, loss_d: 0.384623
0.8080 --- loss: 2.014794, loss_ss: 1.457033, loss_d: 0.557761
0.8465 --- loss: 1.762317, loss_ss: 1.160099, loss_d: 0.602218
0.8850 --- loss: 1.797792, loss_ss: 1.223807, loss_d: 0.573985
0.9234 --- loss: 1.807715, loss_ss: 1.244023, loss_d: 0.563693
0.9619 --- loss: 1.922853, loss_ss: 1.282472, loss_d: 0.640382
Epoch finished! Loss: 1.9833660443317016
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.652967, loss_ss: 1.059076, loss_d: 0.593891
0.0385 --- loss: 2.192361, loss_ss: 1.545083, loss_d: 0.647278
0.0770 --- loss: 1.674093, loss_ss: 1.277013, loss_d: 0.397081
0.1154 --- loss: 1.967688, loss_ss: 1.219295, loss_d: 0.748393
0.1539 --- loss: 1.870106, loss_ss: 1.225293, loss_d: 0.644812
0.1924 --- loss: 1.894522, loss_ss: 1.144556, loss_d: 0.749967
0.2309 --- loss: 1.708091, loss_ss: 1.172823, loss_d: 0.535268
0.2693 --- loss: 1.755729, loss_ss: 1.271663, loss_d: 0.484066
0.3078 --- loss: 1.664675, loss_ss: 1.131616, loss_d: 0.533059
0.3463 --- loss: 1.940356, loss_ss: 1.345117, loss_d: 0.595239
0.3848 --- loss: 1.797100, loss_ss: 1.211373, loss_d: 0.585727
0.4232 --- loss: 1.829833, loss_ss: 1.249563, loss_d: 0.580270
0.4617 --- loss: 1.653493, loss_ss: 1.129900, loss_d: 0.523593
0.5002 --- loss: 1.685443, loss_ss: 1.082954, loss_d: 0.602490
0.5387 --- loss: 1.935326, loss_ss: 1.129031, loss_d: 0.806294
0.5771 --- loss: 1.970728, loss_ss: 1.431308, loss_d: 0.539420
0.6156 --- loss: 1.979088, loss_ss: 1.257205, loss_d: 0.721883
0.6541 --- loss: 1.667000, loss_ss: 1.057933, loss_d: 0.609067
0.6926 --- loss: 1.628006, loss_ss: 1.067382, loss_d: 0.560624
0.7311 --- loss: 1.627414, loss_ss: 0.987566, loss_d: 0.639848
0.7695 --- loss: 2.020894, loss_ss: 1.276518, loss_d: 0.744377
0.8080 --- loss: 1.814924, loss_ss: 1.204109, loss_d: 0.610815
0.8465 --- loss: 1.590282, loss_ss: 1.102878, loss_d: 0.487404
0.8850 --- loss: 1.681331, loss_ss: 1.072600, loss_d: 0.608732
0.9234 --- loss: 2.000120, loss_ss: 1.067271, loss_d: 0.932850
0.9619 --- loss: 1.587478, loss_ss: 1.143763, loss_d: 0.443715
Epoch finished! Loss: 1.8108838902477131
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.628495, loss_ss: 1.051929, loss_d: 0.576566
0.0385 --- loss: 1.537262, loss_ss: 1.044617, loss_d: 0.492645
0.0770 --- loss: 1.709884, loss_ss: 1.038615, loss_d: 0.671269
0.1154 --- loss: 1.797135, loss_ss: 1.044386, loss_d: 0.752749
0.1539 --- loss: 1.807563, loss_ss: 1.237288, loss_d: 0.570275
0.1924 --- loss: 1.832550, loss_ss: 1.227933, loss_d: 0.604618
0.2309 --- loss: 1.688899, loss_ss: 1.223201, loss_d: 0.465698
0.2693 --- loss: 1.938590, loss_ss: 1.298104, loss_d: 0.640486
0.3078 --- loss: 1.488845, loss_ss: 0.993500, loss_d: 0.495346
0.3463 --- loss: 1.721877, loss_ss: 1.193222, loss_d: 0.528655
0.3848 --- loss: 1.563008, loss_ss: 1.092667, loss_d: 0.470341
0.4232 --- loss: 1.650134, loss_ss: 1.001504, loss_d: 0.648631
0.4617 --- loss: 1.485775, loss_ss: 0.920730, loss_d: 0.565045
0.5002 --- loss: 1.642277, loss_ss: 1.184370, loss_d: 0.457907
0.5387 --- loss: 1.772942, loss_ss: 1.340922, loss_d: 0.432020
0.5771 --- loss: 2.213004, loss_ss: 1.323852, loss_d: 0.889152
0.6156 --- loss: 1.838506, loss_ss: 1.256591, loss_d: 0.581915
0.6541 --- loss: 1.872964, loss_ss: 1.119791, loss_d: 0.753174
0.6926 --- loss: 1.449778, loss_ss: 1.135795, loss_d: 0.313983
0.7311 --- loss: 1.619471, loss_ss: 0.795830, loss_d: 0.823641
0.7695 --- loss: 1.524900, loss_ss: 0.868327, loss_d: 0.656573
0.8080 --- loss: 1.538693, loss_ss: 1.008601, loss_d: 0.530091
0.8465 --- loss: 1.718976, loss_ss: 1.144263, loss_d: 0.574713
0.8850 --- loss: 1.882834, loss_ss: 1.300425, loss_d: 0.582409
0.9234 --- loss: 1.574994, loss_ss: 1.069272, loss_d: 0.505722
0.9619 --- loss: 1.805791, loss_ss: 1.309681, loss_d: 0.496110
Epoch finished! Loss: 1.7147579326592817
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.615457, loss_ss: 1.152179, loss_d: 0.463278
0.0385 --- loss: 1.443227, loss_ss: 0.918618, loss_d: 0.524609
0.0770 --- loss: 1.405205, loss_ss: 0.900869, loss_d: 0.504336
0.1154 --- loss: 1.465635, loss_ss: 0.976666, loss_d: 0.488968
0.1539 --- loss: 1.327481, loss_ss: 0.941580, loss_d: 0.385902
0.1924 --- loss: 1.624142, loss_ss: 1.109408, loss_d: 0.514734
0.2309 --- loss: 1.577718, loss_ss: 0.975037, loss_d: 0.602681
0.2693 --- loss: 1.800678, loss_ss: 1.219413, loss_d: 0.581266
0.3078 --- loss: 1.521857, loss_ss: 1.040157, loss_d: 0.481700
0.3463 --- loss: 1.442656, loss_ss: 0.924007, loss_d: 0.518649
0.3848 --- loss: 1.323125, loss_ss: 1.006984, loss_d: 0.316141
0.4232 --- loss: 1.514532, loss_ss: 1.072791, loss_d: 0.441741
0.4617 --- loss: 1.787957, loss_ss: 0.992710, loss_d: 0.795247
0.5002 --- loss: 1.624259, loss_ss: 0.964690, loss_d: 0.659569
0.5387 --- loss: 1.767496, loss_ss: 1.282484, loss_d: 0.485012
0.5771 --- loss: 1.446752, loss_ss: 0.956628, loss_d: 0.490123
0.6156 --- loss: 1.723093, loss_ss: 1.090071, loss_d: 0.633022
0.6541 --- loss: 1.673384, loss_ss: 1.242530, loss_d: 0.430854
0.6926 --- loss: 1.495243, loss_ss: 0.901909, loss_d: 0.593334
0.7311 --- loss: 1.610946, loss_ss: 1.091525, loss_d: 0.519421
0.7695 --- loss: 1.726951, loss_ss: 0.856664, loss_d: 0.870287
0.8080 --- loss: 2.113749, loss_ss: 1.655384, loss_d: 0.458365
0.8465 --- loss: 1.435663, loss_ss: 0.796046, loss_d: 0.639617
0.8850 --- loss: 1.351061, loss_ss: 0.939951, loss_d: 0.411110
0.9234 --- loss: 1.386457, loss_ss: 0.819246, loss_d: 0.567211
0.9619 --- loss: 1.753453, loss_ss: 1.369928, loss_d: 0.383526
Epoch finished! Loss: 1.6259410767941862
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.676572, loss_ss: 1.150242, loss_d: 0.526330
0.0385 --- loss: 1.400105, loss_ss: 1.020140, loss_d: 0.379965
0.0770 --- loss: 1.681587, loss_ss: 1.171932, loss_d: 0.509655
0.1154 --- loss: 1.318893, loss_ss: 1.027795, loss_d: 0.291098
0.1539 --- loss: 1.823583, loss_ss: 1.150180, loss_d: 0.673402
0.1924 --- loss: 1.918945, loss_ss: 0.949053, loss_d: 0.969893
0.2309 --- loss: 2.123952, loss_ss: 1.335780, loss_d: 0.788172
0.2693 --- loss: 1.574878, loss_ss: 1.182143, loss_d: 0.392735
0.3078 --- loss: 1.474566, loss_ss: 1.161360, loss_d: 0.313206
0.3463 --- loss: 1.939363, loss_ss: 1.509731, loss_d: 0.429632
0.3848 --- loss: 1.563358, loss_ss: 1.073728, loss_d: 0.489630
0.4232 --- loss: 1.177346, loss_ss: 0.838138, loss_d: 0.339209
0.4617 --- loss: 1.557100, loss_ss: 0.921231, loss_d: 0.635868
0.5002 --- loss: 1.282900, loss_ss: 0.759162, loss_d: 0.523738
0.5387 --- loss: 1.483732, loss_ss: 1.055796, loss_d: 0.427936
0.5771 --- loss: 1.420927, loss_ss: 0.883856, loss_d: 0.537070
0.6156 --- loss: 1.533459, loss_ss: 1.061380, loss_d: 0.472079
0.6541 --- loss: 1.605329, loss_ss: 1.204234, loss_d: 0.401094
0.6926 --- loss: 1.500719, loss_ss: 1.098493, loss_d: 0.402226
0.7311 --- loss: 1.300665, loss_ss: 1.034640, loss_d: 0.266026
0.7695 --- loss: 1.847037, loss_ss: 0.877464, loss_d: 0.969573
0.8080 --- loss: 1.799694, loss_ss: 1.053698, loss_d: 0.745995
0.8465 --- loss: 1.364541, loss_ss: 0.933121, loss_d: 0.431420
0.8850 --- loss: 1.353825, loss_ss: 0.846318, loss_d: 0.507507
0.9234 --- loss: 1.894506, loss_ss: 1.194658, loss_d: 0.699848
0.9619 --- loss: 1.178154, loss_ss: 0.755859, loss_d: 0.422295
Epoch finished! Loss: 1.5273360515653396
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.264403, loss_ss: 0.928935, loss_d: 0.335468
0.0385 --- loss: 1.603114, loss_ss: 0.869682, loss_d: 0.733431
0.0770 --- loss: 1.327574, loss_ss: 0.868315, loss_d: 0.459259
0.1154 --- loss: 1.513042, loss_ss: 0.881320, loss_d: 0.631722
0.1539 --- loss: 1.192330, loss_ss: 0.891581, loss_d: 0.300749
0.1924 --- loss: 1.724752, loss_ss: 1.276817, loss_d: 0.447935
0.2309 --- loss: 1.362052, loss_ss: 0.849112, loss_d: 0.512940
0.2693 --- loss: 1.866022, loss_ss: 1.120236, loss_d: 0.745786
0.3078 --- loss: 1.573239, loss_ss: 1.059271, loss_d: 0.513969
0.3463 --- loss: 1.675357, loss_ss: 1.114691, loss_d: 0.560666
0.3848 --- loss: 1.586252, loss_ss: 0.969853, loss_d: 0.616399
0.4232 --- loss: 1.487499, loss_ss: 1.160170, loss_d: 0.327330
0.4617 --- loss: 1.432771, loss_ss: 1.184626, loss_d: 0.248145
0.5002 --- loss: 1.575379, loss_ss: 0.870844, loss_d: 0.704535
0.5387 --- loss: 1.686228, loss_ss: 1.030627, loss_d: 0.655601
0.5771 --- loss: 1.617590, loss_ss: 1.160836, loss_d: 0.456755
0.6156 --- loss: 1.395923, loss_ss: 1.085645, loss_d: 0.310278
0.6541 --- loss: 1.377563, loss_ss: 1.075491, loss_d: 0.302072
0.6926 --- loss: 1.164654, loss_ss: 0.793360, loss_d: 0.371293
0.7311 --- loss: 1.800919, loss_ss: 0.872408, loss_d: 0.928511
0.7695 --- loss: 1.263102, loss_ss: 0.923972, loss_d: 0.339130
0.8080 --- loss: 1.546440, loss_ss: 1.095969, loss_d: 0.450471
0.8465 --- loss: 1.328313, loss_ss: 0.965205, loss_d: 0.363108
0.8850 --- loss: 1.199582, loss_ss: 0.743746, loss_d: 0.455836
0.9234 --- loss: 1.317130, loss_ss: 0.868844, loss_d: 0.448286
0.9619 --- loss: 1.435094, loss_ss: 1.073047, loss_d: 0.362047
Epoch finished! Loss: 1.4553253374504767
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.245654, loss_ss: 0.882432, loss_d: 0.363223
0.0385 --- loss: 1.010690, loss_ss: 0.747655, loss_d: 0.263035
0.0770 --- loss: 1.451345, loss_ss: 0.962950, loss_d: 0.488395
0.1154 --- loss: 1.197724, loss_ss: 0.896249, loss_d: 0.301475
0.1539 --- loss: 1.145606, loss_ss: 0.774264, loss_d: 0.371342
0.1924 --- loss: 1.388163, loss_ss: 0.676700, loss_d: 0.711463
0.2309 --- loss: 1.225708, loss_ss: 0.883446, loss_d: 0.342263
0.2693 --- loss: 1.677920, loss_ss: 1.030238, loss_d: 0.647681
0.3078 --- loss: 1.887806, loss_ss: 1.126938, loss_d: 0.760868
0.3463 --- loss: 1.371861, loss_ss: 1.032380, loss_d: 0.339480
0.3848 --- loss: 1.368463, loss_ss: 0.875433, loss_d: 0.493030
0.4232 --- loss: 1.255748, loss_ss: 0.896239, loss_d: 0.359509
0.4617 --- loss: 1.392811, loss_ss: 1.058213, loss_d: 0.334598
0.5002 --- loss: 0.975698, loss_ss: 0.643563, loss_d: 0.332135
0.5387 --- loss: 1.514337, loss_ss: 1.097711, loss_d: 0.416626
0.5771 --- loss: 1.275982, loss_ss: 0.893401, loss_d: 0.382582
0.6156 --- loss: 1.377642, loss_ss: 0.817498, loss_d: 0.560144
0.6541 --- loss: 1.383937, loss_ss: 1.073260, loss_d: 0.310677
0.6926 --- loss: 2.099286, loss_ss: 1.528722, loss_d: 0.570564
0.7311 --- loss: 1.571243, loss_ss: 1.167529, loss_d: 0.403714
0.7695 --- loss: 1.477909, loss_ss: 0.751853, loss_d: 0.726056
0.8080 --- loss: 1.238350, loss_ss: 0.596763, loss_d: 0.641587
0.8465 --- loss: 1.242747, loss_ss: 0.731894, loss_d: 0.510853
0.8850 --- loss: 1.131820, loss_ss: 0.766423, loss_d: 0.365397
0.9234 --- loss: 1.465499, loss_ss: 0.915571, loss_d: 0.549927
0.9619 --- loss: 1.097214, loss_ss: 0.798258, loss_d: 0.298956
Epoch finished! Loss: 1.3620146924924665
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.638006, loss_ss: 0.971463, loss_d: 0.666542
0.0385 --- loss: 1.216998, loss_ss: 0.910629, loss_d: 0.306369
0.0770 --- loss: 1.278365, loss_ss: 0.851482, loss_d: 0.426884
0.1154 --- loss: 1.492852, loss_ss: 1.093343, loss_d: 0.399509
0.1539 --- loss: 1.551005, loss_ss: 0.842236, loss_d: 0.708769
0.1924 --- loss: 1.629148, loss_ss: 1.264604, loss_d: 0.364544
0.2309 --- loss: 1.301757, loss_ss: 0.974655, loss_d: 0.327102
0.2693 --- loss: 1.508177, loss_ss: 0.991865, loss_d: 0.516312
0.3078 --- loss: 1.568503, loss_ss: 0.908730, loss_d: 0.659773
0.3463 --- loss: 1.366077, loss_ss: 1.132218, loss_d: 0.233859
0.3848 --- loss: 1.342572, loss_ss: 1.047614, loss_d: 0.294958
0.4232 --- loss: 1.527639, loss_ss: 0.983884, loss_d: 0.543755
0.4617 --- loss: 0.999516, loss_ss: 0.705571, loss_d: 0.293944
0.5002 --- loss: 1.244442, loss_ss: 0.841900, loss_d: 0.402542
0.5387 --- loss: 1.331229, loss_ss: 0.970193, loss_d: 0.361036
0.5771 --- loss: 1.070981, loss_ss: 0.812563, loss_d: 0.258418
0.6156 --- loss: 1.708544, loss_ss: 0.913970, loss_d: 0.794574
0.6541 --- loss: 1.163733, loss_ss: 0.707765, loss_d: 0.455968
0.6926 --- loss: 1.315894, loss_ss: 0.944532, loss_d: 0.371362
0.7311 --- loss: 1.005448, loss_ss: 0.749659, loss_d: 0.255789
0.7695 --- loss: 1.382870, loss_ss: 1.076665, loss_d: 0.306205
0.8080 --- loss: 1.317176, loss_ss: 0.893254, loss_d: 0.423922
0.8465 --- loss: 1.198273, loss_ss: 0.685758, loss_d: 0.512515
0.8850 --- loss: 1.201499, loss_ss: 0.737502, loss_d: 0.463997
0.9234 --- loss: 1.210649, loss_ss: 0.965761, loss_d: 0.244887
0.9619 --- loss: 1.207387, loss_ss: 0.804255, loss_d: 0.403132
Epoch finished! Loss: 1.3072078969027545
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 2.028913, loss_ss: 0.829676, loss_d: 1.199238
0.0385 --- loss: 1.416997, loss_ss: 1.061262, loss_d: 0.355735
0.0770 --- loss: 1.030063, loss_ss: 0.743942, loss_d: 0.286120
0.1154 --- loss: 0.916367, loss_ss: 0.653476, loss_d: 0.262892
0.1539 --- loss: 1.252169, loss_ss: 0.826171, loss_d: 0.425997
0.1924 --- loss: 0.963066, loss_ss: 0.649435, loss_d: 0.313631
0.2309 --- loss: 1.593353, loss_ss: 1.224458, loss_d: 0.368895
0.2693 --- loss: 1.291105, loss_ss: 0.908008, loss_d: 0.383097
0.3078 --- loss: 1.220332, loss_ss: 0.759179, loss_d: 0.461153
0.3463 --- loss: 1.133300, loss_ss: 0.899117, loss_d: 0.234182
0.3848 --- loss: 0.984231, loss_ss: 0.717166, loss_d: 0.267065
0.4232 --- loss: 1.391356, loss_ss: 0.718181, loss_d: 0.673175
0.4617 --- loss: 1.069075, loss_ss: 0.820229, loss_d: 0.248846
0.5002 --- loss: 1.096239, loss_ss: 0.775086, loss_d: 0.321153
0.5387 --- loss: 1.331365, loss_ss: 0.945320, loss_d: 0.386044
0.5771 --- loss: 1.600628, loss_ss: 1.104245, loss_d: 0.496384
0.6156 --- loss: 1.153941, loss_ss: 0.757656, loss_d: 0.396285
0.6541 --- loss: 1.373200, loss_ss: 0.732981, loss_d: 0.640219
0.6926 --- loss: 1.126677, loss_ss: 0.968741, loss_d: 0.157937
0.7311 --- loss: 1.332870, loss_ss: 1.045437, loss_d: 0.287433
0.7695 --- loss: 0.883829, loss_ss: 0.637340, loss_d: 0.246490
0.8080 --- loss: 1.483402, loss_ss: 1.235093, loss_d: 0.248308
0.8465 --- loss: 1.270015, loss_ss: 0.817853, loss_d: 0.452162
0.8850 --- loss: 1.331655, loss_ss: 1.031950, loss_d: 0.299706
0.9234 --- loss: 0.927262, loss_ss: 0.632770, loss_d: 0.294492
0.9619 --- loss: 0.970572, loss_ss: 0.786751, loss_d: 0.183821
Epoch finished! Loss: 1.2477104424509762
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.044804, loss_ss: 0.839685, loss_d: 0.205119
0.0385 --- loss: 1.344236, loss_ss: 1.081940, loss_d: 0.262297
0.0770 --- loss: 1.002941, loss_ss: 0.844203, loss_d: 0.158738
0.1154 --- loss: 0.858735, loss_ss: 0.759356, loss_d: 0.099379
0.1539 --- loss: 0.957127, loss_ss: 0.747732, loss_d: 0.209395
0.1924 --- loss: 0.976177, loss_ss: 0.731076, loss_d: 0.245101
0.2309 --- loss: 1.121525, loss_ss: 0.795584, loss_d: 0.325940
0.2693 --- loss: 1.275855, loss_ss: 1.013650, loss_d: 0.262205
0.3078 --- loss: 1.381561, loss_ss: 0.925004, loss_d: 0.456557
0.3463 --- loss: 1.308070, loss_ss: 1.063845, loss_d: 0.244226
0.3848 --- loss: 1.109864, loss_ss: 0.722952, loss_d: 0.386912
0.4232 --- loss: 1.015681, loss_ss: 0.828438, loss_d: 0.187243
0.4617 --- loss: 0.865857, loss_ss: 0.688974, loss_d: 0.176883
0.5002 --- loss: 1.522178, loss_ss: 1.195615, loss_d: 0.326563
0.5387 --- loss: 1.040171, loss_ss: 0.817689, loss_d: 0.222482
0.5771 --- loss: 1.032936, loss_ss: 0.752731, loss_d: 0.280205
0.6156 --- loss: 1.413372, loss_ss: 1.097078, loss_d: 0.316293
0.6541 --- loss: 1.018493, loss_ss: 0.601735, loss_d: 0.416758
0.6926 --- loss: 0.889925, loss_ss: 0.639337, loss_d: 0.250588
0.7311 --- loss: 1.058060, loss_ss: 0.869868, loss_d: 0.188192
0.7695 --- loss: 1.381034, loss_ss: 0.559255, loss_d: 0.821779
0.8080 --- loss: 0.903998, loss_ss: 0.581175, loss_d: 0.322823
0.8465 --- loss: 0.969289, loss_ss: 0.764164, loss_d: 0.205125
0.8850 --- loss: 0.982798, loss_ss: 0.693142, loss_d: 0.289656
0.9234 --- loss: 1.299185, loss_ss: 0.862807, loss_d: 0.436378
0.9619 --- loss: 1.222963, loss_ss: 0.744911, loss_d: 0.478052
Epoch finished! Loss: 1.2076529713210913
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6706586826347305
             precision    recall  f1-score   support

        0.0       0.61      0.81      0.70       267
        1.0       0.50      0.01      0.03       152
        2.0       0.69      0.91      0.78       496
        3.0       0.65      0.99      0.78        74
        4.0       1.00      0.23      0.37       180

avg / total       0.69      0.67      0.60      1169
 


====== chp057-nsrr ======
   acc %  sen %  spec %   ppr %  f1-score
0  83.83  81.27   84.59   60.96     69.66
1  87.00   1.32   99.80   50.00      2.56
2  78.61  90.93   69.54   68.75     78.30
3  96.58  98.65   96.44   65.18     78.49
4  88.11  22.78  100.00  100.00     37.10
Total accuracy: 67.07%
Average sen: 58.99%
Average spec: 90.07%
Macro f1-score: 53.22%
Diagnosis acc on 15mins: 1.0
[0.91645932 0.87965065 0.52210647 0.72163779 0.88378865 0.98896837
 0.99316496 0.98893553 0.97609335 0.97688121 0.94688547 0.82865387
 0.99648982 0.99287635 0.99402434 0.99639773 0.85687715 0.94936585
 0.99460536 0.98788702 0.99400973 0.97711527 0.99408287 0.98913693
 0.97650129 0.97867078 0.97175074 0.92498249 0.963247   0.99475765
 0.94759953 0.99722099 0.9908703  0.96938109 0.90940106 0.99051952
 0.9739942  0.99084514 0.98835224]
pred: 0.9465176432560651, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp058-nsrr. train_data(2604), test_data(34) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.263849, loss_ss: 1.603669, loss_d: 0.660181
0.0384 --- loss: 1.734961, loss_ss: 1.381366, loss_d: 0.353595
0.0768 --- loss: 1.938282, loss_ss: 1.680269, loss_d: 0.258012
0.1152 --- loss: 2.067445, loss_ss: 1.529693, loss_d: 0.537753
0.1536 --- loss: 2.222325, loss_ss: 1.522871, loss_d: 0.699454
0.1920 --- loss: 2.300423, loss_ss: 1.472703, loss_d: 0.827720
0.2304 --- loss: 2.196196, loss_ss: 1.483500, loss_d: 0.712695
0.2688 --- loss: 1.797173, loss_ss: 1.411427, loss_d: 0.385746
0.3072 --- loss: 1.860279, loss_ss: 1.417050, loss_d: 0.443229
0.3456 --- loss: 2.094422, loss_ss: 1.457789, loss_d: 0.636632
0.3840 --- loss: 2.095354, loss_ss: 1.566770, loss_d: 0.528584
0.4224 --- loss: 2.052546, loss_ss: 1.486806, loss_d: 0.565740
0.4608 --- loss: 2.096952, loss_ss: 1.470510, loss_d: 0.626441
0.4992 --- loss: 2.142903, loss_ss: 1.445947, loss_d: 0.696956
0.5376 --- loss: 1.955873, loss_ss: 1.395244, loss_d: 0.560629
0.5760 --- loss: 1.954976, loss_ss: 1.430611, loss_d: 0.524365
0.6144 --- loss: 1.803330, loss_ss: 1.293192, loss_d: 0.510138
0.6528 --- loss: 1.915248, loss_ss: 1.373496, loss_d: 0.541753
0.6912 --- loss: 2.237601, loss_ss: 1.502555, loss_d: 0.735045
0.7296 --- loss: 2.045996, loss_ss: 1.411494, loss_d: 0.634502
0.7680 --- loss: 2.083108, loss_ss: 1.323125, loss_d: 0.759984
0.8065 --- loss: 2.051775, loss_ss: 1.474707, loss_d: 0.577068
0.8449 --- loss: 1.739051, loss_ss: 1.276648, loss_d: 0.462403
0.8833 --- loss: 1.984319, loss_ss: 1.458357, loss_d: 0.525962
0.9217 --- loss: 2.060447, loss_ss: 1.260299, loss_d: 0.800147
0.9601 --- loss: 1.722673, loss_ss: 1.163526, loss_d: 0.559147
0.9985 --- loss: 1.639257, loss_ss: 1.396862, loss_d: 0.242396
Epoch finished! Loss: 2.054255605660952
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.799061, loss_ss: 1.281286, loss_d: 0.517776
0.0384 --- loss: 1.816036, loss_ss: 1.259842, loss_d: 0.556194
0.0768 --- loss: 2.084139, loss_ss: 1.286476, loss_d: 0.797663
0.1152 --- loss: 1.780739, loss_ss: 1.336006, loss_d: 0.444733
0.1536 --- loss: 1.767424, loss_ss: 1.214901, loss_d: 0.552523
0.1920 --- loss: 1.918863, loss_ss: 1.451950, loss_d: 0.466913
0.2304 --- loss: 1.675640, loss_ss: 1.253581, loss_d: 0.422059
0.2688 --- loss: 1.987564, loss_ss: 1.276397, loss_d: 0.711166
0.3072 --- loss: 2.128544, loss_ss: 1.409596, loss_d: 0.718948
0.3456 --- loss: 1.606373, loss_ss: 1.177903, loss_d: 0.428469
0.3840 --- loss: 1.805238, loss_ss: 1.158036, loss_d: 0.647202
0.4224 --- loss: 1.929177, loss_ss: 1.045210, loss_d: 0.883967
0.4608 --- loss: 1.987792, loss_ss: 1.288165, loss_d: 0.699628
0.4992 --- loss: 1.701115, loss_ss: 1.203962, loss_d: 0.497153
0.5376 --- loss: 1.702047, loss_ss: 1.290416, loss_d: 0.411631
0.5760 --- loss: 1.601309, loss_ss: 1.171003, loss_d: 0.430305
0.6144 --- loss: 1.914902, loss_ss: 1.215371, loss_d: 0.699531
0.6528 --- loss: 1.492190, loss_ss: 1.042315, loss_d: 0.449875
0.6912 --- loss: 1.912175, loss_ss: 1.124070, loss_d: 0.788105
0.7296 --- loss: 1.966647, loss_ss: 1.212871, loss_d: 0.753776
0.7680 --- loss: 1.600162, loss_ss: 1.281093, loss_d: 0.319069
0.8065 --- loss: 1.717046, loss_ss: 0.990287, loss_d: 0.726759
0.8449 --- loss: 1.439586, loss_ss: 1.040714, loss_d: 0.398872
0.8833 --- loss: 1.835680, loss_ss: 1.044944, loss_d: 0.790736
0.9217 --- loss: 1.922643, loss_ss: 1.166771, loss_d: 0.755872
0.9601 --- loss: 1.693448, loss_ss: 0.992593, loss_d: 0.700855
0.9985 --- loss: 1.765759, loss_ss: 0.972117, loss_d: 0.793643
Epoch finished! Loss: 1.7848288082159482
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.817659, loss_ss: 1.212430, loss_d: 0.605229
0.0384 --- loss: 1.751213, loss_ss: 0.996861, loss_d: 0.754352
0.0768 --- loss: 1.702637, loss_ss: 0.881030, loss_d: 0.821607
0.1152 --- loss: 1.561167, loss_ss: 0.911023, loss_d: 0.650144
0.1536 --- loss: 1.783578, loss_ss: 1.104567, loss_d: 0.679010
0.1920 --- loss: 1.696772, loss_ss: 1.055348, loss_d: 0.641424
0.2304 --- loss: 1.368086, loss_ss: 1.022091, loss_d: 0.345995
0.2688 --- loss: 1.658873, loss_ss: 1.115566, loss_d: 0.543308
0.3072 --- loss: 1.850471, loss_ss: 0.983364, loss_d: 0.867107
0.3456 --- loss: 1.528919, loss_ss: 0.909940, loss_d: 0.618979
0.3840 --- loss: 1.445579, loss_ss: 0.888167, loss_d: 0.557412
0.4224 --- loss: 1.711954, loss_ss: 1.201723, loss_d: 0.510231
0.4608 --- loss: 1.580740, loss_ss: 1.062935, loss_d: 0.517804
0.4992 --- loss: 1.120456, loss_ss: 0.828532, loss_d: 0.291925
0.5376 --- loss: 2.179198, loss_ss: 0.956037, loss_d: 1.223161
0.5760 --- loss: 1.730150, loss_ss: 0.880151, loss_d: 0.849999
0.6144 --- loss: 1.649117, loss_ss: 0.981436, loss_d: 0.667681
0.6528 --- loss: 1.400291, loss_ss: 1.045069, loss_d: 0.355222
0.6912 --- loss: 1.557751, loss_ss: 0.967111, loss_d: 0.590641
0.7296 --- loss: 1.790954, loss_ss: 0.925816, loss_d: 0.865137
0.7680 --- loss: 1.546648, loss_ss: 0.828482, loss_d: 0.718166
0.8065 --- loss: 1.671040, loss_ss: 0.841955, loss_d: 0.829085
0.8449 --- loss: 1.553042, loss_ss: 0.848716, loss_d: 0.704327
0.8833 --- loss: 1.632374, loss_ss: 1.088434, loss_d: 0.543939
0.9217 --- loss: 1.599260, loss_ss: 0.772275, loss_d: 0.826985
0.9601 --- loss: 1.697000, loss_ss: 0.896066, loss_d: 0.800933
0.9985 --- loss: 1.978794, loss_ss: 1.686103, loss_d: 0.292691
Epoch finished! Loss: 1.6052779619510358
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.437521, loss_ss: 1.067656, loss_d: 0.369865
0.0384 --- loss: 1.805413, loss_ss: 0.936096, loss_d: 0.869317
0.0768 --- loss: 1.792302, loss_ss: 1.100884, loss_d: 0.691418
0.1152 --- loss: 1.832093, loss_ss: 1.035865, loss_d: 0.796228
0.1536 --- loss: 1.417406, loss_ss: 0.895868, loss_d: 0.521537
0.1920 --- loss: 1.378273, loss_ss: 0.990495, loss_d: 0.387779
0.2304 --- loss: 1.781482, loss_ss: 0.865482, loss_d: 0.916000
0.2688 --- loss: 1.351841, loss_ss: 0.946359, loss_d: 0.405482
0.3072 --- loss: 1.432713, loss_ss: 0.762082, loss_d: 0.670631
0.3456 --- loss: 1.409621, loss_ss: 0.899492, loss_d: 0.510129
0.3840 --- loss: 1.492379, loss_ss: 0.894266, loss_d: 0.598113
0.4224 --- loss: 1.571562, loss_ss: 1.004214, loss_d: 0.567348
0.4608 --- loss: 1.586702, loss_ss: 0.685092, loss_d: 0.901610
0.4992 --- loss: 1.747993, loss_ss: 1.103205, loss_d: 0.644788
0.5376 --- loss: 1.524885, loss_ss: 1.050121, loss_d: 0.474764
0.5760 --- loss: 1.478010, loss_ss: 0.972608, loss_d: 0.505402
0.6144 --- loss: 1.403749, loss_ss: 0.872002, loss_d: 0.531746
0.6528 --- loss: 1.639033, loss_ss: 1.141349, loss_d: 0.497684
0.6912 --- loss: 1.480524, loss_ss: 0.977594, loss_d: 0.502930
0.7296 --- loss: 2.236645, loss_ss: 1.140097, loss_d: 1.096548
0.7680 --- loss: 1.353126, loss_ss: 0.945317, loss_d: 0.407809
0.8065 --- loss: 1.315180, loss_ss: 0.770141, loss_d: 0.545038
0.8449 --- loss: 1.461128, loss_ss: 0.910240, loss_d: 0.550888
0.8833 --- loss: 1.319109, loss_ss: 0.828110, loss_d: 0.490999
0.9217 --- loss: 1.358343, loss_ss: 0.976097, loss_d: 0.382246
0.9601 --- loss: 1.618464, loss_ss: 1.037383, loss_d: 0.581081
0.9985 --- loss: 1.377078, loss_ss: 0.990472, loss_d: 0.386606
Epoch finished! Loss: 1.5368473424361302
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 2.040487, loss_ss: 1.154515, loss_d: 0.885972
0.0384 --- loss: 1.784454, loss_ss: 1.185659, loss_d: 0.598795
0.0768 --- loss: 1.244806, loss_ss: 0.884682, loss_d: 0.360125
0.1152 --- loss: 1.676028, loss_ss: 1.240276, loss_d: 0.435752
0.1536 --- loss: 1.661701, loss_ss: 0.818607, loss_d: 0.843095
0.1920 --- loss: 1.504220, loss_ss: 0.773625, loss_d: 0.730595
0.2304 --- loss: 1.420800, loss_ss: 0.870388, loss_d: 0.550412
0.2688 --- loss: 1.331065, loss_ss: 0.804249, loss_d: 0.526816
0.3072 --- loss: 1.441815, loss_ss: 0.928776, loss_d: 0.513039
0.3456 --- loss: 1.499869, loss_ss: 1.012554, loss_d: 0.487315
0.3840 --- loss: 1.329328, loss_ss: 0.838003, loss_d: 0.491325
0.4224 --- loss: 1.991777, loss_ss: 1.122205, loss_d: 0.869572
0.4608 --- loss: 1.331806, loss_ss: 0.960162, loss_d: 0.371645
0.4992 --- loss: 1.407256, loss_ss: 0.880928, loss_d: 0.526328
0.5376 --- loss: 1.674101, loss_ss: 1.175977, loss_d: 0.498124
0.5760 --- loss: 1.075366, loss_ss: 0.651882, loss_d: 0.423484
0.6144 --- loss: 1.199372, loss_ss: 0.851597, loss_d: 0.347775
0.6528 --- loss: 1.394831, loss_ss: 0.710950, loss_d: 0.683881
0.6912 --- loss: 1.497706, loss_ss: 0.959598, loss_d: 0.538108
0.7296 --- loss: 1.825692, loss_ss: 1.127783, loss_d: 0.697909
0.7680 --- loss: 1.305197, loss_ss: 0.889733, loss_d: 0.415464
0.8065 --- loss: 1.204589, loss_ss: 0.768672, loss_d: 0.435917
0.8449 --- loss: 1.569134, loss_ss: 1.011567, loss_d: 0.557566
0.8833 --- loss: 1.530827, loss_ss: 1.176351, loss_d: 0.354475
0.9217 --- loss: 1.879851, loss_ss: 1.142230, loss_d: 0.737621
0.9601 --- loss: 1.363487, loss_ss: 1.057417, loss_d: 0.306069
0.9985 --- loss: 1.389905, loss_ss: 1.110518, loss_d: 0.279387
Epoch finished! Loss: 1.504969014112766
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.217588, loss_ss: 0.772409, loss_d: 0.445179
0.0384 --- loss: 1.326556, loss_ss: 0.871713, loss_d: 0.454843
0.0768 --- loss: 1.220521, loss_ss: 0.782355, loss_d: 0.438166
0.1152 --- loss: 1.317022, loss_ss: 0.862150, loss_d: 0.454872
0.1536 --- loss: 1.615079, loss_ss: 1.010238, loss_d: 0.604840
0.1920 --- loss: 1.367368, loss_ss: 0.948015, loss_d: 0.419353
0.2304 --- loss: 1.850593, loss_ss: 1.397696, loss_d: 0.452897
0.2688 --- loss: 1.231780, loss_ss: 0.915662, loss_d: 0.316118
0.3072 --- loss: 1.380569, loss_ss: 0.747890, loss_d: 0.632680
0.3456 --- loss: 1.940857, loss_ss: 0.975089, loss_d: 0.965768
0.3840 --- loss: 1.989361, loss_ss: 1.136578, loss_d: 0.852783
0.4224 --- loss: 1.212422, loss_ss: 0.699098, loss_d: 0.513325
0.4608 --- loss: 1.591769, loss_ss: 0.883044, loss_d: 0.708726
0.4992 --- loss: 1.464989, loss_ss: 1.003443, loss_d: 0.461546
0.5376 --- loss: 1.662055, loss_ss: 0.962212, loss_d: 0.699843
0.5760 --- loss: 1.266853, loss_ss: 0.884935, loss_d: 0.381918
0.6144 --- loss: 1.394318, loss_ss: 0.956959, loss_d: 0.437359
0.6528 --- loss: 1.329711, loss_ss: 0.808283, loss_d: 0.521428
0.6912 --- loss: 1.512615, loss_ss: 0.788882, loss_d: 0.723733
0.7296 --- loss: 1.675321, loss_ss: 0.920719, loss_d: 0.754602
0.7680 --- loss: 1.342013, loss_ss: 0.834390, loss_d: 0.507623
0.8065 --- loss: 1.200089, loss_ss: 0.863544, loss_d: 0.336544
0.8449 --- loss: 1.199553, loss_ss: 0.524921, loss_d: 0.674633
0.8833 --- loss: 1.784637, loss_ss: 1.421054, loss_d: 0.363583
0.9217 --- loss: 1.419334, loss_ss: 1.074847, loss_d: 0.344488
0.9601 --- loss: 1.219973, loss_ss: 0.918272, loss_d: 0.301701
0.9985 --- loss: 1.380071, loss_ss: 1.130726, loss_d: 0.249345
Epoch finished! Loss: 1.4222674729732367
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.011497, loss_ss: 0.724993, loss_d: 0.286505
0.0384 --- loss: 1.114316, loss_ss: 0.888422, loss_d: 0.225894
0.0768 --- loss: 1.268474, loss_ss: 0.908771, loss_d: 0.359703
0.1152 --- loss: 1.514363, loss_ss: 0.896815, loss_d: 0.617548
0.1536 --- loss: 1.182176, loss_ss: 0.762399, loss_d: 0.419777
0.1920 --- loss: 1.319374, loss_ss: 0.895073, loss_d: 0.424300
0.2304 --- loss: 1.058903, loss_ss: 0.791783, loss_d: 0.267120
0.2688 --- loss: 1.315278, loss_ss: 0.976785, loss_d: 0.338492
0.3072 --- loss: 1.063804, loss_ss: 0.706959, loss_d: 0.356845
0.3456 --- loss: 1.250793, loss_ss: 0.931736, loss_d: 0.319056
0.3840 --- loss: 1.571296, loss_ss: 0.709962, loss_d: 0.861334
0.4224 --- loss: 1.050713, loss_ss: 0.610658, loss_d: 0.440054
0.4608 --- loss: 1.201725, loss_ss: 0.811197, loss_d: 0.390527
0.4992 --- loss: 1.298601, loss_ss: 0.894028, loss_d: 0.404572
0.5376 --- loss: 1.110298, loss_ss: 0.808968, loss_d: 0.301330
0.5760 --- loss: 1.025292, loss_ss: 0.715786, loss_d: 0.309506
0.6144 --- loss: 1.154603, loss_ss: 0.782428, loss_d: 0.372174
0.6528 --- loss: 1.032390, loss_ss: 0.813118, loss_d: 0.219272
0.6912 --- loss: 0.940558, loss_ss: 0.749568, loss_d: 0.190990
0.7296 --- loss: 1.181752, loss_ss: 0.938067, loss_d: 0.243685
0.7680 --- loss: 1.763248, loss_ss: 1.447936, loss_d: 0.315312
0.8065 --- loss: 1.108043, loss_ss: 0.682384, loss_d: 0.425659
0.8449 --- loss: 1.149144, loss_ss: 0.885822, loss_d: 0.263321
0.8833 --- loss: 1.151553, loss_ss: 0.667935, loss_d: 0.483618
0.9217 --- loss: 1.135131, loss_ss: 0.903962, loss_d: 0.231169
0.9601 --- loss: 1.087961, loss_ss: 0.763397, loss_d: 0.324564
0.9985 --- loss: 2.376073, loss_ss: 1.071781, loss_d: 1.304292
Epoch finished! Loss: 1.318711836521442
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.584103, loss_ss: 0.955643, loss_d: 0.628461
0.0384 --- loss: 1.251690, loss_ss: 0.599689, loss_d: 0.652000
0.0768 --- loss: 1.611684, loss_ss: 1.211666, loss_d: 0.400018
0.1152 --- loss: 1.277021, loss_ss: 1.040972, loss_d: 0.236048
0.1536 --- loss: 1.195249, loss_ss: 0.699971, loss_d: 0.495278
0.1920 --- loss: 1.164402, loss_ss: 0.855130, loss_d: 0.309272
0.2304 --- loss: 1.334524, loss_ss: 0.919382, loss_d: 0.415142
0.2688 --- loss: 1.260165, loss_ss: 1.044105, loss_d: 0.216059
0.3072 --- loss: 1.221124, loss_ss: 1.011912, loss_d: 0.209212
0.3456 --- loss: 1.091545, loss_ss: 0.796175, loss_d: 0.295370
0.3840 --- loss: 1.386025, loss_ss: 0.739597, loss_d: 0.646429
0.4224 --- loss: 1.379350, loss_ss: 1.162063, loss_d: 0.217287
0.4608 --- loss: 1.448969, loss_ss: 1.228086, loss_d: 0.220883
0.4992 --- loss: 1.112937, loss_ss: 0.786919, loss_d: 0.326018
0.5376 --- loss: 1.971290, loss_ss: 1.093561, loss_d: 0.877729
0.5760 --- loss: 1.276569, loss_ss: 1.047788, loss_d: 0.228782
0.6144 --- loss: 1.119143, loss_ss: 0.765562, loss_d: 0.353581
0.6528 --- loss: 0.674268, loss_ss: 0.519283, loss_d: 0.154985
0.6912 --- loss: 1.057181, loss_ss: 0.619097, loss_d: 0.438084
0.7296 --- loss: 1.057700, loss_ss: 0.861146, loss_d: 0.196554
0.7680 --- loss: 2.211062, loss_ss: 1.054644, loss_d: 1.156419
0.8065 --- loss: 1.577220, loss_ss: 1.024601, loss_d: 0.552619
0.8449 --- loss: 0.963853, loss_ss: 0.452501, loss_d: 0.511351
0.8833 --- loss: 1.178186, loss_ss: 0.825920, loss_d: 0.352266
0.9217 --- loss: 0.978697, loss_ss: 0.597742, loss_d: 0.380955
0.9601 --- loss: 1.384808, loss_ss: 0.968668, loss_d: 0.416140
0.9985 --- loss: 0.993362, loss_ss: 0.897390, loss_d: 0.095971
Epoch finished! Loss: 1.2321190785903198
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.067878, loss_ss: 0.906743, loss_d: 0.161135
0.0384 --- loss: 1.775741, loss_ss: 0.872418, loss_d: 0.903322
0.0768 --- loss: 0.970863, loss_ss: 0.815675, loss_d: 0.155188
0.1152 --- loss: 0.878614, loss_ss: 0.590699, loss_d: 0.287914
0.1536 --- loss: 1.206535, loss_ss: 0.824027, loss_d: 0.382508
0.1920 --- loss: 0.938361, loss_ss: 0.781006, loss_d: 0.157354
0.2304 --- loss: 1.124854, loss_ss: 0.725177, loss_d: 0.399677
0.2688 --- loss: 1.031565, loss_ss: 0.835979, loss_d: 0.195586
0.3072 --- loss: 1.163266, loss_ss: 0.991737, loss_d: 0.171530
0.3456 --- loss: 1.114706, loss_ss: 0.939548, loss_d: 0.175158
0.3840 --- loss: 1.000082, loss_ss: 0.817758, loss_d: 0.182324
0.4224 --- loss: 1.134341, loss_ss: 0.995113, loss_d: 0.139228
0.4608 --- loss: 0.756963, loss_ss: 0.640558, loss_d: 0.116405
0.4992 --- loss: 2.124726, loss_ss: 1.131287, loss_d: 0.993439
0.5376 --- loss: 1.054141, loss_ss: 0.907579, loss_d: 0.146562
0.5760 --- loss: 1.500706, loss_ss: 0.815848, loss_d: 0.684858
0.6144 --- loss: 1.335524, loss_ss: 0.777106, loss_d: 0.558418
0.6528 --- loss: 1.500997, loss_ss: 1.310651, loss_d: 0.190347
0.6912 --- loss: 1.055444, loss_ss: 0.802765, loss_d: 0.252679
0.7296 --- loss: 1.496253, loss_ss: 1.305896, loss_d: 0.190357
0.7680 --- loss: 1.325886, loss_ss: 1.092885, loss_d: 0.233001
0.8065 --- loss: 0.763531, loss_ss: 0.610764, loss_d: 0.152767
0.8449 --- loss: 0.793438, loss_ss: 0.610303, loss_d: 0.183135
0.8833 --- loss: 1.170891, loss_ss: 1.045999, loss_d: 0.124892
0.9217 --- loss: 1.883474, loss_ss: 0.814172, loss_d: 1.069302
0.9601 --- loss: 1.447542, loss_ss: 0.998561, loss_d: 0.448981
0.9985 --- loss: 1.031324, loss_ss: 0.844221, loss_d: 0.187103
Epoch finished! Loss: 1.172556208188717
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.798779, loss_ss: 0.590560, loss_d: 0.208218
0.0384 --- loss: 0.898336, loss_ss: 0.692345, loss_d: 0.205990
0.0768 --- loss: 1.123354, loss_ss: 0.927156, loss_d: 0.196198
0.1152 --- loss: 1.001283, loss_ss: 0.952642, loss_d: 0.048641
0.1536 --- loss: 1.375082, loss_ss: 0.654725, loss_d: 0.720357
0.1920 --- loss: 1.469900, loss_ss: 0.774095, loss_d: 0.695805
0.2304 --- loss: 1.052164, loss_ss: 0.910149, loss_d: 0.142016
0.2688 --- loss: 1.348195, loss_ss: 0.926435, loss_d: 0.421761
0.3072 --- loss: 1.459965, loss_ss: 1.111067, loss_d: 0.348897
0.3456 --- loss: 0.851983, loss_ss: 0.730837, loss_d: 0.121146
0.3840 --- loss: 1.440667, loss_ss: 0.744908, loss_d: 0.695759
0.4224 --- loss: 1.105674, loss_ss: 0.974065, loss_d: 0.131609
0.4608 --- loss: 1.019028, loss_ss: 0.584465, loss_d: 0.434563
0.4992 --- loss: 1.262552, loss_ss: 1.042617, loss_d: 0.219934
0.5376 --- loss: 1.062166, loss_ss: 0.862308, loss_d: 0.199858
0.5760 --- loss: 1.475857, loss_ss: 1.073779, loss_d: 0.402078
0.6144 --- loss: 1.258656, loss_ss: 1.016492, loss_d: 0.242164
0.6528 --- loss: 0.988639, loss_ss: 0.731179, loss_d: 0.257459
0.6912 --- loss: 1.212307, loss_ss: 0.950308, loss_d: 0.261999
0.7296 --- loss: 1.183615, loss_ss: 0.836750, loss_d: 0.346865
0.7680 --- loss: 1.113921, loss_ss: 0.830290, loss_d: 0.283631
0.8065 --- loss: 0.962473, loss_ss: 0.630622, loss_d: 0.331852
0.8449 --- loss: 1.605866, loss_ss: 1.072321, loss_d: 0.533545
0.8833 --- loss: 1.446427, loss_ss: 1.225794, loss_d: 0.220633
0.9217 --- loss: 1.020569, loss_ss: 0.750246, loss_d: 0.270323
0.9601 --- loss: 1.330910, loss_ss: 0.911926, loss_d: 0.418984
0.9985 --- loss: 1.881459, loss_ss: 0.823972, loss_d: 1.057487
Epoch finished! Loss: 1.1230051292822911
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6745098039215687
             precision    recall  f1-score   support

        0.0       0.77      0.34      0.47       105
        1.0       0.00      0.00      0.00        44
        2.0       0.57      0.92      0.70       317
        3.0       0.95      0.76      0.84       258
        4.0       0.68      0.56      0.61       296

avg / total       0.69      0.67      0.66      1020
 


====== chp058-nsrr ======

The f1-score of  1  has ZeroDivisionError.
   acc %  sen %  spec %  ppr %  f1-score
0  92.16  34.29   98.80  76.60     47.37
1  94.61   0.00   98.87   0.00      0.00
2  75.78  92.11   68.42  56.81     70.28
3  92.75  75.58   98.56  94.66     84.05
4  79.61  55.74   89.36  68.18     61.34
Total accuracy: 67.45%
Average sen: 51.54%
Average spec: 90.80%
Macro f1-score: 52.61%
Diagnosis acc on 15mins: 0.9705882352941176
[0.82962924 0.99327236 0.9548803  0.93538201 0.73772407 0.54202938
 0.77777469 0.71750861 0.9965803  0.9986999  0.85965323 0.68258637
 0.5503124  0.9378078  0.68781167 0.75409019 0.8088488  0.84822887
 0.48409146 0.83670479 0.98654836 0.96281284 0.68952703 0.6868794
 0.9591918  0.50085223 0.8503117  0.67350364 0.69880015 0.79090679
 0.65378326 0.93700409 0.9487533  0.78768659]
pred: 0.7958875771831063, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp059-nsrr. train_data(2601), test_data(37) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.336044, loss_ss: 1.618258, loss_d: 0.717787
0.0384 --- loss: 1.990358, loss_ss: 1.464153, loss_d: 0.526205
0.0769 --- loss: 1.892267, loss_ss: 1.322686, loss_d: 0.569581
0.1153 --- loss: 2.075066, loss_ss: 1.352928, loss_d: 0.722137
0.1538 --- loss: 1.805125, loss_ss: 1.175518, loss_d: 0.629607
0.1922 --- loss: 1.999286, loss_ss: 1.380005, loss_d: 0.619281
0.2307 --- loss: 1.948142, loss_ss: 1.352701, loss_d: 0.595440
0.2691 --- loss: 1.672626, loss_ss: 1.274945, loss_d: 0.397681
0.3076 --- loss: 1.964019, loss_ss: 1.356213, loss_d: 0.607806
0.3460 --- loss: 1.775018, loss_ss: 1.237123, loss_d: 0.537896
0.3845 --- loss: 1.792631, loss_ss: 1.392854, loss_d: 0.399776
0.4229 --- loss: 1.838767, loss_ss: 1.276884, loss_d: 0.561883
0.4614 --- loss: 1.924631, loss_ss: 1.398149, loss_d: 0.526482
0.4998 --- loss: 1.960865, loss_ss: 1.264422, loss_d: 0.696442
0.5383 --- loss: 1.910103, loss_ss: 1.216153, loss_d: 0.693949
0.5767 --- loss: 1.583850, loss_ss: 1.018777, loss_d: 0.565073
0.6151 --- loss: 2.086210, loss_ss: 1.250533, loss_d: 0.835677
0.6536 --- loss: 1.881806, loss_ss: 0.938683, loss_d: 0.943123
0.6920 --- loss: 1.407234, loss_ss: 1.001604, loss_d: 0.405630
0.7305 --- loss: 1.836688, loss_ss: 0.874352, loss_d: 0.962336
0.7689 --- loss: 1.818351, loss_ss: 1.150335, loss_d: 0.668016
0.8074 --- loss: 1.595618, loss_ss: 1.139244, loss_d: 0.456375
0.8458 --- loss: 1.684366, loss_ss: 1.281679, loss_d: 0.402687
0.8843 --- loss: 1.889584, loss_ss: 1.263807, loss_d: 0.625777
0.9227 --- loss: 1.743827, loss_ss: 1.250047, loss_d: 0.493780
0.9612 --- loss: 1.745811, loss_ss: 1.104898, loss_d: 0.640913
0.9996 --- loss: 2.413006, loss_ss: 1.137794, loss_d: 1.275212
Epoch finished! Loss: 1.8615096559891333
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.721542, loss_ss: 1.015947, loss_d: 0.705595
0.0384 --- loss: 1.777740, loss_ss: 1.051266, loss_d: 0.726474
0.0769 --- loss: 1.557128, loss_ss: 0.874958, loss_d: 0.682170
0.1153 --- loss: 2.229212, loss_ss: 1.279638, loss_d: 0.949574
0.1538 --- loss: 1.413696, loss_ss: 1.062165, loss_d: 0.351531
0.1922 --- loss: 1.867870, loss_ss: 1.083127, loss_d: 0.784743
0.2307 --- loss: 1.695837, loss_ss: 1.357945, loss_d: 0.337892
0.2691 --- loss: 1.602408, loss_ss: 1.110019, loss_d: 0.492389
0.3076 --- loss: 1.383852, loss_ss: 0.941489, loss_d: 0.442363
0.3460 --- loss: 1.445842, loss_ss: 1.032409, loss_d: 0.413433
0.3845 --- loss: 1.728090, loss_ss: 1.129189, loss_d: 0.598901
0.4229 --- loss: 1.731703, loss_ss: 1.102720, loss_d: 0.628983
0.4614 --- loss: 1.488545, loss_ss: 1.104554, loss_d: 0.383991
0.4998 --- loss: 1.779006, loss_ss: 1.006836, loss_d: 0.772169
0.5383 --- loss: 1.428226, loss_ss: 0.913952, loss_d: 0.514274
0.5767 --- loss: 1.295586, loss_ss: 0.852102, loss_d: 0.443484
0.6151 --- loss: 1.321619, loss_ss: 0.801432, loss_d: 0.520187
0.6536 --- loss: 2.050091, loss_ss: 0.700236, loss_d: 1.349854
0.6920 --- loss: 1.213869, loss_ss: 0.772936, loss_d: 0.440933
0.7305 --- loss: 1.370775, loss_ss: 1.025437, loss_d: 0.345338
0.7689 --- loss: 1.611165, loss_ss: 0.961731, loss_d: 0.649433
0.8074 --- loss: 1.295933, loss_ss: 0.953748, loss_d: 0.342185
0.8458 --- loss: 1.944286, loss_ss: 1.394844, loss_d: 0.549442
0.8843 --- loss: 1.882807, loss_ss: 1.109970, loss_d: 0.772837
0.9227 --- loss: 1.602335, loss_ss: 1.205731, loss_d: 0.396604
0.9612 --- loss: 1.352341, loss_ss: 0.953486, loss_d: 0.398855
0.9996 --- loss: 2.812398, loss_ss: 1.197730, loss_d: 1.614668
Epoch finished! Loss: 1.6347349552007822
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.917064, loss_ss: 1.365729, loss_d: 0.551335
0.0384 --- loss: 1.462143, loss_ss: 0.990992, loss_d: 0.471151
0.0769 --- loss: 1.381651, loss_ss: 0.871618, loss_d: 0.510033
0.1153 --- loss: 1.236172, loss_ss: 0.855937, loss_d: 0.380235
0.1538 --- loss: 1.609775, loss_ss: 0.795056, loss_d: 0.814719
0.1922 --- loss: 1.427204, loss_ss: 1.037789, loss_d: 0.389416
0.2307 --- loss: 1.429210, loss_ss: 0.824795, loss_d: 0.604414
0.2691 --- loss: 1.737064, loss_ss: 0.802578, loss_d: 0.934487
0.3076 --- loss: 1.717269, loss_ss: 1.072584, loss_d: 0.644685
0.3460 --- loss: 1.437626, loss_ss: 1.147036, loss_d: 0.290590
0.3845 --- loss: 1.841701, loss_ss: 0.754151, loss_d: 1.087549
0.4229 --- loss: 1.621580, loss_ss: 0.763173, loss_d: 0.858408
0.4614 --- loss: 1.488857, loss_ss: 0.845227, loss_d: 0.643629
0.4998 --- loss: 1.595458, loss_ss: 1.068303, loss_d: 0.527155
0.5383 --- loss: 1.771594, loss_ss: 1.152833, loss_d: 0.618761
0.5767 --- loss: 1.479802, loss_ss: 1.156417, loss_d: 0.323385
0.6151 --- loss: 1.400479, loss_ss: 0.865857, loss_d: 0.534622
0.6536 --- loss: 1.639524, loss_ss: 0.958940, loss_d: 0.680584
0.6920 --- loss: 1.477939, loss_ss: 0.864561, loss_d: 0.613378
0.7305 --- loss: 1.450313, loss_ss: 0.905572, loss_d: 0.544741
0.7689 --- loss: 1.260198, loss_ss: 0.757941, loss_d: 0.502257
0.8074 --- loss: 1.111099, loss_ss: 0.739768, loss_d: 0.371330
0.8458 --- loss: 1.644020, loss_ss: 1.232281, loss_d: 0.411739
0.8843 --- loss: 1.590518, loss_ss: 1.255121, loss_d: 0.335397
0.9227 --- loss: 1.653781, loss_ss: 1.106694, loss_d: 0.547087
0.9612 --- loss: 1.525044, loss_ss: 1.002194, loss_d: 0.522850
0.9996 --- loss: 1.594731, loss_ss: 1.245419, loss_d: 0.349313
Epoch finished! Loss: 1.5471026260119218
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.381440, loss_ss: 0.986739, loss_d: 0.394702
0.0384 --- loss: 1.168430, loss_ss: 0.846062, loss_d: 0.322367
0.0769 --- loss: 1.814098, loss_ss: 1.002795, loss_d: 0.811303
0.1153 --- loss: 1.155545, loss_ss: 0.835972, loss_d: 0.319573
0.1538 --- loss: 1.307986, loss_ss: 0.885163, loss_d: 0.422823
0.1922 --- loss: 1.215894, loss_ss: 0.802872, loss_d: 0.413022
0.2307 --- loss: 1.579326, loss_ss: 0.968868, loss_d: 0.610458
0.2691 --- loss: 0.941077, loss_ss: 0.629014, loss_d: 0.312063
0.3076 --- loss: 1.709016, loss_ss: 0.959325, loss_d: 0.749691
0.3460 --- loss: 1.381349, loss_ss: 1.022619, loss_d: 0.358730
0.3845 --- loss: 1.378724, loss_ss: 0.668708, loss_d: 0.710016
0.4229 --- loss: 1.300383, loss_ss: 0.853684, loss_d: 0.446699
0.4614 --- loss: 1.397404, loss_ss: 0.913447, loss_d: 0.483958
0.4998 --- loss: 1.353509, loss_ss: 1.101421, loss_d: 0.252088
0.5383 --- loss: 1.352264, loss_ss: 1.092258, loss_d: 0.260006
0.5767 --- loss: 1.623203, loss_ss: 1.003238, loss_d: 0.619965
0.6151 --- loss: 1.437594, loss_ss: 1.179251, loss_d: 0.258343
0.6536 --- loss: 1.339239, loss_ss: 0.897664, loss_d: 0.441575
0.6920 --- loss: 1.196523, loss_ss: 0.977265, loss_d: 0.219258
0.7305 --- loss: 1.091950, loss_ss: 0.815568, loss_d: 0.276382
0.7689 --- loss: 1.449358, loss_ss: 0.971998, loss_d: 0.477359
0.8074 --- loss: 1.316861, loss_ss: 0.788515, loss_d: 0.528346
0.8458 --- loss: 1.199097, loss_ss: 0.892325, loss_d: 0.306772
0.8843 --- loss: 0.883746, loss_ss: 0.620964, loss_d: 0.262783
0.9227 --- loss: 0.964478, loss_ss: 0.734786, loss_d: 0.229692
0.9612 --- loss: 1.174540, loss_ss: 1.021900, loss_d: 0.152641
0.9996 --- loss: 4.315950, loss_ss: 2.861537, loss_d: 1.454413
Epoch finished! Loss: 1.4420404995863254
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.400651, loss_ss: 0.790854, loss_d: 0.609797
0.0384 --- loss: 1.363050, loss_ss: 1.025649, loss_d: 0.337401
0.0769 --- loss: 1.244786, loss_ss: 0.839700, loss_d: 0.405086
0.1153 --- loss: 1.490788, loss_ss: 1.005105, loss_d: 0.485683
0.1538 --- loss: 1.082855, loss_ss: 0.849042, loss_d: 0.233813
0.1922 --- loss: 1.307463, loss_ss: 0.859915, loss_d: 0.447548
0.2307 --- loss: 0.937485, loss_ss: 0.621899, loss_d: 0.315586
0.2691 --- loss: 1.220760, loss_ss: 0.803886, loss_d: 0.416874
0.3076 --- loss: 1.483813, loss_ss: 1.007324, loss_d: 0.476489
0.3460 --- loss: 2.076882, loss_ss: 1.172983, loss_d: 0.903899
0.3845 --- loss: 1.075360, loss_ss: 0.751535, loss_d: 0.323825
0.4229 --- loss: 1.555065, loss_ss: 0.894131, loss_d: 0.660934
0.4614 --- loss: 1.347830, loss_ss: 0.977331, loss_d: 0.370499
0.4998 --- loss: 1.080298, loss_ss: 0.755633, loss_d: 0.324665
0.5383 --- loss: 1.576313, loss_ss: 1.138591, loss_d: 0.437723
0.5767 --- loss: 0.997463, loss_ss: 0.751748, loss_d: 0.245716
0.6151 --- loss: 1.225943, loss_ss: 0.634314, loss_d: 0.591629
0.6536 --- loss: 1.171537, loss_ss: 0.845939, loss_d: 0.325597
0.6920 --- loss: 1.313028, loss_ss: 0.792080, loss_d: 0.520947
0.7305 --- loss: 1.531946, loss_ss: 0.975729, loss_d: 0.556217
0.7689 --- loss: 1.333738, loss_ss: 0.889318, loss_d: 0.444420
0.8074 --- loss: 1.452775, loss_ss: 1.043612, loss_d: 0.409163
0.8458 --- loss: 1.148316, loss_ss: 0.888641, loss_d: 0.259675
0.8843 --- loss: 1.450454, loss_ss: 0.958353, loss_d: 0.492101
0.9227 --- loss: 1.280662, loss_ss: 0.868410, loss_d: 0.412252
0.9612 --- loss: 1.355674, loss_ss: 0.989453, loss_d: 0.366220
0.9996 --- loss: 1.526722, loss_ss: 1.286146, loss_d: 0.240576
Epoch finished! Loss: 1.3701692069952305
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.213498, loss_ss: 0.923990, loss_d: 0.289508
0.0384 --- loss: 1.268803, loss_ss: 1.015913, loss_d: 0.252889
0.0769 --- loss: 1.955726, loss_ss: 1.109467, loss_d: 0.846259
0.1153 --- loss: 1.157018, loss_ss: 0.819327, loss_d: 0.337690
0.1538 --- loss: 1.061121, loss_ss: 0.843663, loss_d: 0.217458
0.1922 --- loss: 1.216951, loss_ss: 0.864532, loss_d: 0.352419
0.2307 --- loss: 0.941460, loss_ss: 0.752413, loss_d: 0.189046
0.2691 --- loss: 1.540211, loss_ss: 1.030132, loss_d: 0.510079
0.3076 --- loss: 1.006152, loss_ss: 0.754879, loss_d: 0.251273
0.3460 --- loss: 1.420933, loss_ss: 1.167699, loss_d: 0.253233
0.3845 --- loss: 1.231568, loss_ss: 0.922212, loss_d: 0.309356
0.4229 --- loss: 1.254011, loss_ss: 0.872596, loss_d: 0.381416
0.4614 --- loss: 1.094997, loss_ss: 0.876011, loss_d: 0.218986
0.4998 --- loss: 1.866021, loss_ss: 1.082821, loss_d: 0.783200
0.5383 --- loss: 0.899899, loss_ss: 0.746921, loss_d: 0.152978
0.5767 --- loss: 1.225220, loss_ss: 0.847824, loss_d: 0.377396
0.6151 --- loss: 1.787009, loss_ss: 0.833971, loss_d: 0.953038
0.6536 --- loss: 1.354986, loss_ss: 0.888392, loss_d: 0.466594
0.6920 --- loss: 1.297905, loss_ss: 0.878527, loss_d: 0.419378
0.7305 --- loss: 1.141220, loss_ss: 1.001173, loss_d: 0.140047
0.7689 --- loss: 1.394001, loss_ss: 0.736726, loss_d: 0.657275
0.8074 --- loss: 1.206793, loss_ss: 0.824694, loss_d: 0.382099
0.8458 --- loss: 1.197404, loss_ss: 0.915226, loss_d: 0.282178
0.8843 --- loss: 2.126006, loss_ss: 0.877563, loss_d: 1.248443
0.9227 --- loss: 1.078025, loss_ss: 0.697537, loss_d: 0.380488
0.9612 --- loss: 1.284669, loss_ss: 1.026121, loss_d: 0.258548
0.9996 --- loss: 2.140321, loss_ss: 2.039062, loss_d: 0.101259
Epoch finished! Loss: 1.3014523272330945
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.770520, loss_ss: 0.874309, loss_d: 0.896211
0.0384 --- loss: 1.819818, loss_ss: 1.321303, loss_d: 0.498514
0.0769 --- loss: 1.392957, loss_ss: 1.063575, loss_d: 0.329382
0.1153 --- loss: 1.240318, loss_ss: 0.973546, loss_d: 0.266773
0.1538 --- loss: 0.950534, loss_ss: 0.768018, loss_d: 0.182516
0.1922 --- loss: 1.183667, loss_ss: 0.988498, loss_d: 0.195169
0.2307 --- loss: 1.271541, loss_ss: 0.993182, loss_d: 0.278359
0.2691 --- loss: 1.233154, loss_ss: 0.809721, loss_d: 0.423433
0.3076 --- loss: 1.206934, loss_ss: 0.834212, loss_d: 0.372723
0.3460 --- loss: 1.048930, loss_ss: 0.657281, loss_d: 0.391649
0.3845 --- loss: 1.359201, loss_ss: 0.895006, loss_d: 0.464196
0.4229 --- loss: 1.481840, loss_ss: 1.253182, loss_d: 0.228657
0.4614 --- loss: 0.924146, loss_ss: 0.760616, loss_d: 0.163530
0.4998 --- loss: 1.639904, loss_ss: 1.462870, loss_d: 0.177034
0.5383 --- loss: 1.327992, loss_ss: 0.916868, loss_d: 0.411124
0.5767 --- loss: 1.490993, loss_ss: 1.164019, loss_d: 0.326974
0.6151 --- loss: 0.848114, loss_ss: 0.674829, loss_d: 0.173286
0.6536 --- loss: 1.019331, loss_ss: 0.848885, loss_d: 0.170447
0.6920 --- loss: 1.118151, loss_ss: 0.878424, loss_d: 0.239727
0.7305 --- loss: 1.108516, loss_ss: 0.819409, loss_d: 0.289106
0.7689 --- loss: 1.356559, loss_ss: 0.936643, loss_d: 0.419916
0.8074 --- loss: 1.279833, loss_ss: 0.886992, loss_d: 0.392841
0.8458 --- loss: 0.878169, loss_ss: 0.629847, loss_d: 0.248322
0.8843 --- loss: 1.187154, loss_ss: 0.936255, loss_d: 0.250899
0.9227 --- loss: 0.896723, loss_ss: 0.635849, loss_d: 0.260875
0.9612 --- loss: 1.337216, loss_ss: 1.026880, loss_d: 0.310336
0.9996 --- loss: 2.587493, loss_ss: 2.421117, loss_d: 0.166377
Epoch finished! Loss: 1.2803717924998357
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.447404, loss_ss: 0.991113, loss_d: 0.456291
0.0384 --- loss: 1.152992, loss_ss: 0.884114, loss_d: 0.268878
0.0769 --- loss: 1.731820, loss_ss: 0.629303, loss_d: 1.102517
0.1153 --- loss: 1.125077, loss_ss: 0.825405, loss_d: 0.299672
0.1538 --- loss: 1.245611, loss_ss: 0.690252, loss_d: 0.555359
0.1922 --- loss: 1.039206, loss_ss: 0.769205, loss_d: 0.270002
0.2307 --- loss: 1.239399, loss_ss: 0.699452, loss_d: 0.539947
0.2691 --- loss: 1.332682, loss_ss: 0.732958, loss_d: 0.599724
0.3076 --- loss: 1.156646, loss_ss: 0.797653, loss_d: 0.358993
0.3460 --- loss: 1.126458, loss_ss: 0.557738, loss_d: 0.568720
0.3845 --- loss: 1.089522, loss_ss: 0.905287, loss_d: 0.184235
0.4229 --- loss: 0.952407, loss_ss: 0.674451, loss_d: 0.277955
0.4614 --- loss: 1.029716, loss_ss: 0.768660, loss_d: 0.261056
0.4998 --- loss: 1.626672, loss_ss: 1.002249, loss_d: 0.624423
0.5383 --- loss: 1.330474, loss_ss: 0.802310, loss_d: 0.528163
0.5767 --- loss: 1.173377, loss_ss: 0.924179, loss_d: 0.249198
0.6151 --- loss: 0.960049, loss_ss: 0.786067, loss_d: 0.173982
0.6536 --- loss: 0.896516, loss_ss: 0.719158, loss_d: 0.177358
0.6920 --- loss: 1.615147, loss_ss: 1.373259, loss_d: 0.241888
0.7305 --- loss: 1.502758, loss_ss: 0.799834, loss_d: 0.702924
0.7689 --- loss: 0.854482, loss_ss: 0.722062, loss_d: 0.132420
0.8074 --- loss: 1.578054, loss_ss: 0.709203, loss_d: 0.868851
0.8458 --- loss: 1.403171, loss_ss: 0.886908, loss_d: 0.516263
0.8843 --- loss: 1.016152, loss_ss: 0.795060, loss_d: 0.221093
0.9227 --- loss: 1.898470, loss_ss: 0.931682, loss_d: 0.966788
0.9612 --- loss: 1.298488, loss_ss: 1.020019, loss_d: 0.278469
0.9996 --- loss: 3.090740, loss_ss: 3.029998, loss_d: 0.060742
Epoch finished! Loss: 1.268273478975663
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.912051, loss_ss: 0.888191, loss_d: 1.023861
0.0384 --- loss: 1.076172, loss_ss: 0.898171, loss_d: 0.178000
0.0769 --- loss: 1.152658, loss_ss: 0.870786, loss_d: 0.281872
0.1153 --- loss: 1.037502, loss_ss: 0.856561, loss_d: 0.180941
0.1538 --- loss: 1.196676, loss_ss: 1.059283, loss_d: 0.137393
0.1922 --- loss: 1.413512, loss_ss: 0.998969, loss_d: 0.414543
0.2307 --- loss: 1.462119, loss_ss: 0.740846, loss_d: 0.721273
0.2691 --- loss: 1.519516, loss_ss: 1.007538, loss_d: 0.511977
0.3076 --- loss: 1.272100, loss_ss: 0.845586, loss_d: 0.426514
0.3460 --- loss: 0.811316, loss_ss: 0.613790, loss_d: 0.197525
0.3845 --- loss: 1.214410, loss_ss: 0.845724, loss_d: 0.368686
0.4229 --- loss: 0.900665, loss_ss: 0.733994, loss_d: 0.166671
0.4614 --- loss: 1.050831, loss_ss: 0.900881, loss_d: 0.149950
0.4998 --- loss: 0.972005, loss_ss: 0.811974, loss_d: 0.160031
0.5383 --- loss: 1.166329, loss_ss: 0.786015, loss_d: 0.380314
0.5767 --- loss: 1.116392, loss_ss: 0.737673, loss_d: 0.378719
0.6151 --- loss: 1.374007, loss_ss: 0.692607, loss_d: 0.681399
0.6536 --- loss: 1.425378, loss_ss: 1.016511, loss_d: 0.408867
0.6920 --- loss: 1.413861, loss_ss: 0.963791, loss_d: 0.450070
0.7305 --- loss: 1.191062, loss_ss: 0.887382, loss_d: 0.303680
0.7689 --- loss: 1.124782, loss_ss: 0.931737, loss_d: 0.193045
0.8074 --- loss: 1.078489, loss_ss: 0.751329, loss_d: 0.327161
0.8458 --- loss: 1.233849, loss_ss: 0.940343, loss_d: 0.293505
0.8843 --- loss: 1.223718, loss_ss: 0.850251, loss_d: 0.373466
0.9227 --- loss: 1.415609, loss_ss: 1.181003, loss_d: 0.234606
0.9612 --- loss: 0.883740, loss_ss: 0.755519, loss_d: 0.128221
0.9996 --- loss: 4.811656, loss_ss: 2.498550, loss_d: 2.313106
Epoch finished! Loss: 1.236673035300695
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 0.889608, loss_ss: 0.677331, loss_d: 0.212277
0.0384 --- loss: 1.121078, loss_ss: 0.573105, loss_d: 0.547973
0.0769 --- loss: 1.161343, loss_ss: 0.736267, loss_d: 0.425076
0.1153 --- loss: 1.181430, loss_ss: 0.936067, loss_d: 0.245363
0.1538 --- loss: 1.037490, loss_ss: 0.889780, loss_d: 0.147709
0.1922 --- loss: 0.947373, loss_ss: 0.837942, loss_d: 0.109431
0.2307 --- loss: 1.276821, loss_ss: 1.042307, loss_d: 0.234513
0.2691 --- loss: 0.950807, loss_ss: 0.864194, loss_d: 0.086613
0.3076 --- loss: 1.052603, loss_ss: 0.724476, loss_d: 0.328127
0.3460 --- loss: 1.229526, loss_ss: 0.985474, loss_d: 0.244052
0.3845 --- loss: 0.982850, loss_ss: 0.792931, loss_d: 0.189919
0.4229 --- loss: 1.233098, loss_ss: 0.964628, loss_d: 0.268470
0.4614 --- loss: 0.847272, loss_ss: 0.625095, loss_d: 0.222176
0.4998 --- loss: 1.209568, loss_ss: 0.717143, loss_d: 0.492425
0.5383 --- loss: 0.771876, loss_ss: 0.625101, loss_d: 0.146775
0.5767 --- loss: 1.054217, loss_ss: 0.863716, loss_d: 0.190501
0.6151 --- loss: 1.064756, loss_ss: 0.766508, loss_d: 0.298248
0.6536 --- loss: 0.859120, loss_ss: 0.711973, loss_d: 0.147146
0.6920 --- loss: 1.144085, loss_ss: 0.933981, loss_d: 0.210105
0.7305 --- loss: 1.025777, loss_ss: 0.721544, loss_d: 0.304233
0.7689 --- loss: 1.594699, loss_ss: 1.116547, loss_d: 0.478152
0.8074 --- loss: 0.877815, loss_ss: 0.745874, loss_d: 0.131941
0.8458 --- loss: 1.091614, loss_ss: 0.880017, loss_d: 0.211598
0.8843 --- loss: 1.204967, loss_ss: 1.043054, loss_d: 0.161913
0.9227 --- loss: 1.172163, loss_ss: 0.803118, loss_d: 0.369046
0.9612 --- loss: 1.041374, loss_ss: 0.911299, loss_d: 0.130075
0.9996 --- loss: 3.435184, loss_ss: 3.352028, loss_d: 0.083156
Epoch finished! Loss: 1.1811155706644059
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.718018018018018
             precision    recall  f1-score   support

        0.0       0.78      0.89      0.84       247
        1.0       0.52      0.61      0.56       254
        2.0       0.81      0.65      0.72       355
        3.0       0.91      0.57      0.70        87
        4.0       0.73      0.84      0.78       167

avg / total       0.73      0.72      0.72      1110
 


====== chp059-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  92.16  89.47   92.93  78.37     83.55
1  78.38  61.02   83.53  52.36     56.36
2  83.96  65.07   92.85  81.05     72.19
3  96.22  57.47   99.51  90.91     70.42
4  92.88  83.83   94.49  72.92     77.99
Total accuracy: 71.80%
Average sen: 71.37%
Average spec: 92.66%
Macro f1-score: 72.10%
Diagnosis acc on 15mins: 1.0
[0.99665415 0.9977507  0.98402405 0.98950046 0.99678063 0.98609537
 0.98915511 0.99464417 0.99906832 0.99959689 0.99953139 0.99755532
 0.99294347 0.98964673 0.99841332 0.95949954 0.96918654 0.99435037
 0.99295557 0.99262434 0.9985739  0.99822122 0.99856722 0.99792743
 0.98499805 0.82571203 0.98338175 0.98760116 0.99549085 0.99476236
 0.99895656 0.99899918 0.99329221 0.95325577 0.97367948 0.9879027
 0.98512101]
pred: 0.9858491710714392, label: 1
Right! Diagnosis: Narcolepsy type 1

=== Test on chp060-nsrr. train_data(2596), test_data(42) ===
Define dataloader
==== START TRAINING ====
Starting epoch 1/10.
0.0000 --- loss: 2.394828, loss_ss: 1.702978, loss_d: 0.691850
0.0385 --- loss: 2.247408, loss_ss: 1.642283, loss_d: 0.605125
0.0770 --- loss: 2.227882, loss_ss: 1.550314, loss_d: 0.677568
0.1156 --- loss: 2.256918, loss_ss: 1.305151, loss_d: 0.951767
0.1541 --- loss: 2.163568, loss_ss: 1.324676, loss_d: 0.838892
0.1926 --- loss: 2.039372, loss_ss: 1.459705, loss_d: 0.579667
0.2311 --- loss: 1.850516, loss_ss: 1.231584, loss_d: 0.618932
0.2696 --- loss: 2.033467, loss_ss: 1.356987, loss_d: 0.676480
0.3082 --- loss: 1.663196, loss_ss: 1.170057, loss_d: 0.493139
0.3467 --- loss: 1.785547, loss_ss: 1.225752, loss_d: 0.559795
0.3852 --- loss: 1.706535, loss_ss: 1.072360, loss_d: 0.634176
0.4237 --- loss: 1.851832, loss_ss: 1.330248, loss_d: 0.521584
0.4622 --- loss: 1.881427, loss_ss: 1.171687, loss_d: 0.709740
0.5008 --- loss: 2.105228, loss_ss: 1.183577, loss_d: 0.921651
0.5393 --- loss: 1.840388, loss_ss: 1.182778, loss_d: 0.657610
0.5778 --- loss: 1.835910, loss_ss: 1.072469, loss_d: 0.763442
0.6163 --- loss: 1.821618, loss_ss: 1.213107, loss_d: 0.608511
0.6549 --- loss: 1.858520, loss_ss: 1.268941, loss_d: 0.589579
0.6934 --- loss: 1.862361, loss_ss: 1.155635, loss_d: 0.706726
0.7319 --- loss: 1.694866, loss_ss: 1.006851, loss_d: 0.688014
0.7704 --- loss: 1.800457, loss_ss: 1.194548, loss_d: 0.605910
0.8089 --- loss: 1.629781, loss_ss: 1.177355, loss_d: 0.452426
0.8475 --- loss: 1.845237, loss_ss: 1.196718, loss_d: 0.648519
0.8860 --- loss: 1.410676, loss_ss: 0.987563, loss_d: 0.423113
0.9245 --- loss: 1.659549, loss_ss: 1.155491, loss_d: 0.504058
0.9630 --- loss: 1.937639, loss_ss: 1.297052, loss_d: 0.640588
Epoch finished! Loss: 1.867364957986191
Checkpoint 1 saved !
Starting epoch 2/10.
0.0000 --- loss: 1.305587, loss_ss: 0.969961, loss_d: 0.335625
0.0385 --- loss: 1.962178, loss_ss: 1.215561, loss_d: 0.746616
0.0770 --- loss: 1.645698, loss_ss: 1.051136, loss_d: 0.594562
0.1156 --- loss: 1.676107, loss_ss: 1.045512, loss_d: 0.630595
0.1541 --- loss: 1.468630, loss_ss: 0.946636, loss_d: 0.521994
0.1926 --- loss: 1.693082, loss_ss: 1.096317, loss_d: 0.596765
0.2311 --- loss: 1.801230, loss_ss: 1.173276, loss_d: 0.627953
0.2696 --- loss: 1.696315, loss_ss: 1.254479, loss_d: 0.441836
0.3082 --- loss: 1.815257, loss_ss: 1.056088, loss_d: 0.759169
0.3467 --- loss: 1.768427, loss_ss: 1.046539, loss_d: 0.721888
0.3852 --- loss: 2.017558, loss_ss: 1.513475, loss_d: 0.504083
0.4237 --- loss: 1.858811, loss_ss: 1.270279, loss_d: 0.588531
0.4622 --- loss: 1.697048, loss_ss: 0.991823, loss_d: 0.705226
0.5008 --- loss: 1.946299, loss_ss: 1.488048, loss_d: 0.458251
0.5393 --- loss: 1.824550, loss_ss: 1.382694, loss_d: 0.441857
0.5778 --- loss: 1.453768, loss_ss: 0.982580, loss_d: 0.471189
0.6163 --- loss: 1.781232, loss_ss: 1.239197, loss_d: 0.542035
0.6549 --- loss: 1.608633, loss_ss: 1.349572, loss_d: 0.259061
0.6934 --- loss: 2.048158, loss_ss: 1.146599, loss_d: 0.901559
0.7319 --- loss: 1.837085, loss_ss: 1.062234, loss_d: 0.774851
0.7704 --- loss: 1.809340, loss_ss: 1.227868, loss_d: 0.581473
0.8089 --- loss: 1.819828, loss_ss: 1.039944, loss_d: 0.779884
0.8475 --- loss: 1.938233, loss_ss: 1.442824, loss_d: 0.495409
0.8860 --- loss: 1.803107, loss_ss: 1.202542, loss_d: 0.600564
0.9245 --- loss: 1.727743, loss_ss: 1.035517, loss_d: 0.692227
0.9630 --- loss: 1.402422, loss_ss: 1.035976, loss_d: 0.366446
Epoch finished! Loss: 1.7186036970624592
Checkpoint 2 saved !
Starting epoch 3/10.
0.0000 --- loss: 1.635378, loss_ss: 1.121089, loss_d: 0.514289
0.0385 --- loss: 1.349019, loss_ss: 0.809743, loss_d: 0.539276
0.0770 --- loss: 1.353158, loss_ss: 0.824371, loss_d: 0.528787
0.1156 --- loss: 1.394075, loss_ss: 1.056341, loss_d: 0.337734
0.1541 --- loss: 2.111700, loss_ss: 1.465255, loss_d: 0.646445
0.1926 --- loss: 1.687243, loss_ss: 1.180171, loss_d: 0.507073
0.2311 --- loss: 1.627196, loss_ss: 0.984847, loss_d: 0.642349
0.2696 --- loss: 1.643734, loss_ss: 0.940962, loss_d: 0.702772
0.3082 --- loss: 1.406332, loss_ss: 1.020924, loss_d: 0.385407
0.3467 --- loss: 1.747983, loss_ss: 1.138155, loss_d: 0.609828
0.3852 --- loss: 1.740874, loss_ss: 1.024918, loss_d: 0.715956
0.4237 --- loss: 1.677815, loss_ss: 1.251640, loss_d: 0.426174
0.4622 --- loss: 1.707408, loss_ss: 1.375286, loss_d: 0.332122
0.5008 --- loss: 1.603124, loss_ss: 0.925179, loss_d: 0.677944
0.5393 --- loss: 1.644166, loss_ss: 0.979974, loss_d: 0.664192
0.5778 --- loss: 1.466374, loss_ss: 0.949841, loss_d: 0.516533
0.6163 --- loss: 1.726576, loss_ss: 1.093891, loss_d: 0.632685
0.6549 --- loss: 1.593476, loss_ss: 0.877134, loss_d: 0.716342
0.6934 --- loss: 1.954673, loss_ss: 1.067402, loss_d: 0.887271
0.7319 --- loss: 1.890091, loss_ss: 1.083741, loss_d: 0.806350
0.7704 --- loss: 1.580077, loss_ss: 1.018835, loss_d: 0.561242
0.8089 --- loss: 1.301589, loss_ss: 0.837388, loss_d: 0.464201
0.8475 --- loss: 1.513593, loss_ss: 0.845812, loss_d: 0.667780
0.8860 --- loss: 1.551124, loss_ss: 1.128926, loss_d: 0.422198
0.9245 --- loss: 1.860252, loss_ss: 1.159871, loss_d: 0.700382
0.9630 --- loss: 1.758747, loss_ss: 0.983038, loss_d: 0.775709
Epoch finished! Loss: 1.67945058511491
Checkpoint 3 saved !
Starting epoch 4/10.
0.0000 --- loss: 1.650747, loss_ss: 1.104236, loss_d: 0.546511
0.0385 --- loss: 1.345066, loss_ss: 0.980856, loss_d: 0.364211
0.0770 --- loss: 1.333545, loss_ss: 1.064304, loss_d: 0.269240
0.1156 --- loss: 1.735556, loss_ss: 1.265148, loss_d: 0.470408
0.1541 --- loss: 1.913383, loss_ss: 1.078776, loss_d: 0.834607
0.1926 --- loss: 1.716459, loss_ss: 1.172826, loss_d: 0.543633
0.2311 --- loss: 1.991634, loss_ss: 1.301183, loss_d: 0.690452
0.2696 --- loss: 1.248779, loss_ss: 0.823549, loss_d: 0.425229
0.3082 --- loss: 1.526259, loss_ss: 0.934775, loss_d: 0.591484
0.3467 --- loss: 1.902858, loss_ss: 1.030290, loss_d: 0.872568
0.3852 --- loss: 1.745993, loss_ss: 1.077603, loss_d: 0.668390
0.4237 --- loss: 1.266638, loss_ss: 0.804992, loss_d: 0.461645
0.4622 --- loss: 1.646832, loss_ss: 1.056270, loss_d: 0.590562
0.5008 --- loss: 1.936393, loss_ss: 1.425993, loss_d: 0.510401
0.5393 --- loss: 1.385731, loss_ss: 0.881501, loss_d: 0.504230
0.5778 --- loss: 1.653591, loss_ss: 1.103846, loss_d: 0.549745
0.6163 --- loss: 1.476622, loss_ss: 1.048173, loss_d: 0.428450
0.6549 --- loss: 1.271032, loss_ss: 0.857272, loss_d: 0.413761
0.6934 --- loss: 1.561110, loss_ss: 0.880348, loss_d: 0.680762
0.7319 --- loss: 1.249931, loss_ss: 0.975595, loss_d: 0.274336
0.7704 --- loss: 1.825638, loss_ss: 1.132807, loss_d: 0.692831
0.8089 --- loss: 1.291604, loss_ss: 0.735377, loss_d: 0.556228
0.8475 --- loss: 1.494121, loss_ss: 1.068721, loss_d: 0.425400
0.8860 --- loss: 1.391975, loss_ss: 0.911858, loss_d: 0.480117
0.9245 --- loss: 1.601233, loss_ss: 0.990826, loss_d: 0.610406
0.9630 --- loss: 1.694558, loss_ss: 0.980036, loss_d: 0.714523
Epoch finished! Loss: 1.6162464236660814
Checkpoint 4 saved !
Starting epoch 5/10.
0.0000 --- loss: 1.897767, loss_ss: 1.298237, loss_d: 0.599530
0.0385 --- loss: 1.606987, loss_ss: 1.117031, loss_d: 0.489956
0.0770 --- loss: 1.622957, loss_ss: 0.939485, loss_d: 0.683472
0.1156 --- loss: 1.882643, loss_ss: 1.070720, loss_d: 0.811923
0.1541 --- loss: 1.583784, loss_ss: 1.002246, loss_d: 0.581539
0.1926 --- loss: 1.356517, loss_ss: 0.881049, loss_d: 0.475469
0.2311 --- loss: 1.687492, loss_ss: 1.175931, loss_d: 0.511561
0.2696 --- loss: 1.634908, loss_ss: 0.925254, loss_d: 0.709654
0.3082 --- loss: 1.192989, loss_ss: 0.878879, loss_d: 0.314110
0.3467 --- loss: 1.694440, loss_ss: 1.192931, loss_d: 0.501509
0.3852 --- loss: 1.403879, loss_ss: 0.968332, loss_d: 0.435547
0.4237 --- loss: 1.354191, loss_ss: 1.014227, loss_d: 0.339964
0.4622 --- loss: 1.815479, loss_ss: 0.977763, loss_d: 0.837716
0.5008 --- loss: 1.227762, loss_ss: 0.796950, loss_d: 0.430811
0.5393 --- loss: 1.396573, loss_ss: 0.937662, loss_d: 0.458911
0.5778 --- loss: 1.844295, loss_ss: 1.106769, loss_d: 0.737526
0.6163 --- loss: 1.679124, loss_ss: 1.150332, loss_d: 0.528792
0.6549 --- loss: 1.375973, loss_ss: 0.938960, loss_d: 0.437012
0.6934 --- loss: 1.415967, loss_ss: 1.015877, loss_d: 0.400089
0.7319 --- loss: 1.873405, loss_ss: 1.067754, loss_d: 0.805651
0.7704 --- loss: 1.672343, loss_ss: 1.066477, loss_d: 0.605866
0.8089 --- loss: 1.412689, loss_ss: 0.820860, loss_d: 0.591829
0.8475 --- loss: 1.329376, loss_ss: 0.815545, loss_d: 0.513831
0.8860 --- loss: 1.941043, loss_ss: 1.068544, loss_d: 0.872499
0.9245 --- loss: 1.238858, loss_ss: 0.862656, loss_d: 0.376202
0.9630 --- loss: 1.326226, loss_ss: 0.978900, loss_d: 0.347326
Epoch finished! Loss: 1.5685377019712823
Checkpoint 5 saved !
Starting epoch 6/10.
0.0000 --- loss: 1.516935, loss_ss: 1.116642, loss_d: 0.400293
0.0385 --- loss: 1.527303, loss_ss: 0.722714, loss_d: 0.804589
0.0770 --- loss: 1.735786, loss_ss: 0.990348, loss_d: 0.745438
0.1156 --- loss: 1.328640, loss_ss: 1.012154, loss_d: 0.316486
0.1541 --- loss: 1.270856, loss_ss: 0.975864, loss_d: 0.294992
0.1926 --- loss: 1.093324, loss_ss: 0.803222, loss_d: 0.290101
0.2311 --- loss: 1.222089, loss_ss: 0.981804, loss_d: 0.240285
0.2696 --- loss: 1.437468, loss_ss: 0.918876, loss_d: 0.518592
0.3082 --- loss: 1.980767, loss_ss: 1.177317, loss_d: 0.803450
0.3467 --- loss: 1.516521, loss_ss: 0.914160, loss_d: 0.602361
0.3852 --- loss: 1.878140, loss_ss: 1.010038, loss_d: 0.868102
0.4237 --- loss: 1.147353, loss_ss: 0.794807, loss_d: 0.352545
0.4622 --- loss: 1.263930, loss_ss: 0.776119, loss_d: 0.487811
0.5008 --- loss: 1.478201, loss_ss: 1.008129, loss_d: 0.470072
0.5393 --- loss: 1.448352, loss_ss: 1.058281, loss_d: 0.390071
0.5778 --- loss: 1.548056, loss_ss: 0.881692, loss_d: 0.666364
0.6163 --- loss: 1.107793, loss_ss: 0.839712, loss_d: 0.268081
0.6549 --- loss: 1.501766, loss_ss: 0.887187, loss_d: 0.614579
0.6934 --- loss: 1.716402, loss_ss: 1.261607, loss_d: 0.454795
0.7319 --- loss: 1.180331, loss_ss: 0.980917, loss_d: 0.199415
0.7704 --- loss: 1.655754, loss_ss: 1.240120, loss_d: 0.415633
0.8089 --- loss: 1.328712, loss_ss: 0.776308, loss_d: 0.552404
0.8475 --- loss: 1.464998, loss_ss: 1.100330, loss_d: 0.364669
0.8860 --- loss: 1.522699, loss_ss: 1.172108, loss_d: 0.350591
0.9245 --- loss: 1.284736, loss_ss: 1.100998, loss_d: 0.183738
0.9630 --- loss: 1.544332, loss_ss: 1.075592, loss_d: 0.468740
Epoch finished! Loss: 1.4344455047463818
Checkpoint 6 saved !
Starting epoch 7/10.
0.0000 --- loss: 1.425007, loss_ss: 0.977415, loss_d: 0.447592
0.0385 --- loss: 1.462837, loss_ss: 1.181750, loss_d: 0.281088
0.0770 --- loss: 1.288148, loss_ss: 0.935424, loss_d: 0.352723
0.1156 --- loss: 1.447636, loss_ss: 1.030278, loss_d: 0.417358
0.1541 --- loss: 1.434877, loss_ss: 1.219203, loss_d: 0.215673
0.1926 --- loss: 1.769267, loss_ss: 1.394231, loss_d: 0.375036
0.2311 --- loss: 1.703679, loss_ss: 0.982031, loss_d: 0.721647
0.2696 --- loss: 2.169055, loss_ss: 1.255865, loss_d: 0.913191
0.3082 --- loss: 1.352091, loss_ss: 0.791080, loss_d: 0.561011
0.3467 --- loss: 1.254011, loss_ss: 0.848221, loss_d: 0.405791
0.3852 --- loss: 1.532757, loss_ss: 1.261808, loss_d: 0.270949
0.4237 --- loss: 1.403699, loss_ss: 0.834692, loss_d: 0.569007
0.4622 --- loss: 1.211021, loss_ss: 0.832065, loss_d: 0.378957
0.5008 --- loss: 1.220188, loss_ss: 0.891950, loss_d: 0.328238
0.5393 --- loss: 1.794112, loss_ss: 0.851739, loss_d: 0.942373
0.5778 --- loss: 1.694460, loss_ss: 0.891914, loss_d: 0.802546
0.6163 --- loss: 1.541151, loss_ss: 1.135903, loss_d: 0.405247
0.6549 --- loss: 1.480875, loss_ss: 0.995008, loss_d: 0.485868
0.6934 --- loss: 1.200200, loss_ss: 0.930837, loss_d: 0.269363
0.7319 --- loss: 1.333580, loss_ss: 0.796572, loss_d: 0.537009
0.7704 --- loss: 0.958216, loss_ss: 0.789844, loss_d: 0.168372
0.8089 --- loss: 1.081583, loss_ss: 0.881772, loss_d: 0.199812
0.8475 --- loss: 1.218106, loss_ss: 0.775597, loss_d: 0.442508
0.8860 --- loss: 1.215049, loss_ss: 0.864515, loss_d: 0.350534
0.9245 --- loss: 1.332826, loss_ss: 1.183023, loss_d: 0.149804
0.9630 --- loss: 1.960240, loss_ss: 0.871401, loss_d: 1.088839
Epoch finished! Loss: 1.3415694660201496
Checkpoint 7 saved !
Starting epoch 8/10.
0.0000 --- loss: 1.250505, loss_ss: 0.913544, loss_d: 0.336961
0.0385 --- loss: 0.935225, loss_ss: 0.808359, loss_d: 0.126866
0.0770 --- loss: 1.189997, loss_ss: 0.946292, loss_d: 0.243705
0.1156 --- loss: 1.236264, loss_ss: 0.928781, loss_d: 0.307483
0.1541 --- loss: 1.079581, loss_ss: 0.896443, loss_d: 0.183138
0.1926 --- loss: 1.338950, loss_ss: 0.740068, loss_d: 0.598881
0.2311 --- loss: 1.161266, loss_ss: 0.981472, loss_d: 0.179794
0.2696 --- loss: 1.104257, loss_ss: 0.876086, loss_d: 0.228172
0.3082 --- loss: 1.174085, loss_ss: 0.844241, loss_d: 0.329844
0.3467 --- loss: 1.022435, loss_ss: 0.805063, loss_d: 0.217371
0.3852 --- loss: 1.269711, loss_ss: 0.944943, loss_d: 0.324768
0.4237 --- loss: 1.216929, loss_ss: 0.948712, loss_d: 0.268217
0.4622 --- loss: 1.230207, loss_ss: 0.769053, loss_d: 0.461154
0.5008 --- loss: 1.147417, loss_ss: 0.781492, loss_d: 0.365926
0.5393 --- loss: 1.332776, loss_ss: 0.836605, loss_d: 0.496171
0.5778 --- loss: 1.269881, loss_ss: 0.876103, loss_d: 0.393778
0.6163 --- loss: 1.211313, loss_ss: 0.698388, loss_d: 0.512925
0.6549 --- loss: 0.982991, loss_ss: 0.828310, loss_d: 0.154681
0.6934 --- loss: 1.160812, loss_ss: 0.968302, loss_d: 0.192510
0.7319 --- loss: 0.889875, loss_ss: 0.676188, loss_d: 0.213687
0.7704 --- loss: 1.064248, loss_ss: 0.666070, loss_d: 0.398178
0.8089 --- loss: 2.240502, loss_ss: 1.492216, loss_d: 0.748287
0.8475 --- loss: 1.395072, loss_ss: 0.826517, loss_d: 0.568556
0.8860 --- loss: 1.278746, loss_ss: 0.888241, loss_d: 0.390505
0.9245 --- loss: 1.193376, loss_ss: 0.912779, loss_d: 0.280596
0.9630 --- loss: 1.348991, loss_ss: 1.124636, loss_d: 0.224356
Epoch finished! Loss: 1.2748305760755503
Checkpoint 8 saved !
Starting epoch 9/10.
0.0000 --- loss: 1.310293, loss_ss: 1.091575, loss_d: 0.218718
0.0385 --- loss: 1.195918, loss_ss: 0.867234, loss_d: 0.328684
0.0770 --- loss: 1.576505, loss_ss: 1.364170, loss_d: 0.212335
0.1156 --- loss: 1.149220, loss_ss: 0.880111, loss_d: 0.269109
0.1541 --- loss: 1.701586, loss_ss: 1.414747, loss_d: 0.286840
0.1926 --- loss: 1.162302, loss_ss: 0.675062, loss_d: 0.487240
0.2311 --- loss: 1.329117, loss_ss: 0.971530, loss_d: 0.357587
0.2696 --- loss: 0.913954, loss_ss: 0.776010, loss_d: 0.137944
0.3082 --- loss: 1.087699, loss_ss: 0.861031, loss_d: 0.226668
0.3467 --- loss: 1.400707, loss_ss: 0.870341, loss_d: 0.530367
0.3852 --- loss: 1.074811, loss_ss: 0.907453, loss_d: 0.167358
0.4237 --- loss: 1.585658, loss_ss: 0.759837, loss_d: 0.825821
0.4622 --- loss: 0.946600, loss_ss: 0.755013, loss_d: 0.191588
0.5008 --- loss: 1.358529, loss_ss: 0.992037, loss_d: 0.366492
0.5393 --- loss: 1.105150, loss_ss: 0.910389, loss_d: 0.194761
0.5778 --- loss: 0.981733, loss_ss: 0.903741, loss_d: 0.077993
0.6163 --- loss: 1.157297, loss_ss: 1.012037, loss_d: 0.145260
0.6549 --- loss: 1.227102, loss_ss: 1.048472, loss_d: 0.178629
0.6934 --- loss: 1.230159, loss_ss: 0.673148, loss_d: 0.557011
0.7319 --- loss: 1.230481, loss_ss: 0.876989, loss_d: 0.353492
0.7704 --- loss: 1.301790, loss_ss: 1.031067, loss_d: 0.270723
0.8089 --- loss: 1.255313, loss_ss: 0.837090, loss_d: 0.418223
0.8475 --- loss: 1.135315, loss_ss: 1.001828, loss_d: 0.133487
0.8860 --- loss: 0.896952, loss_ss: 0.791899, loss_d: 0.105053
0.9245 --- loss: 0.995575, loss_ss: 0.819837, loss_d: 0.175738
0.9630 --- loss: 1.240693, loss_ss: 1.080132, loss_d: 0.160561
Epoch finished! Loss: 1.238291598655082
Checkpoint 9 saved !
Starting epoch 10/10.
0.0000 --- loss: 1.006762, loss_ss: 0.807097, loss_d: 0.199665
0.0385 --- loss: 1.301099, loss_ss: 1.019403, loss_d: 0.281697
0.0770 --- loss: 0.892350, loss_ss: 0.788549, loss_d: 0.103801
0.1156 --- loss: 1.673988, loss_ss: 1.272026, loss_d: 0.401962
0.1541 --- loss: 1.055448, loss_ss: 0.929301, loss_d: 0.126147
0.1926 --- loss: 1.189904, loss_ss: 0.962852, loss_d: 0.227052
0.2311 --- loss: 0.962451, loss_ss: 0.842725, loss_d: 0.119726
0.2696 --- loss: 0.958303, loss_ss: 0.831766, loss_d: 0.126537
0.3082 --- loss: 1.155790, loss_ss: 0.933929, loss_d: 0.221862
0.3467 --- loss: 0.915259, loss_ss: 0.778750, loss_d: 0.136509
0.3852 --- loss: 1.089124, loss_ss: 0.888718, loss_d: 0.200406
0.4237 --- loss: 1.130801, loss_ss: 0.948199, loss_d: 0.182602
0.4622 --- loss: 1.021289, loss_ss: 0.861995, loss_d: 0.159294
0.5008 --- loss: 1.783892, loss_ss: 1.437414, loss_d: 0.346478
0.5393 --- loss: 0.913362, loss_ss: 0.706175, loss_d: 0.207187
0.5778 --- loss: 1.030891, loss_ss: 0.904421, loss_d: 0.126470
0.6163 --- loss: 1.666695, loss_ss: 1.093459, loss_d: 0.573237
0.6549 --- loss: 1.811197, loss_ss: 1.194086, loss_d: 0.617110
0.6934 --- loss: 1.163603, loss_ss: 1.026276, loss_d: 0.137327
0.7319 --- loss: 1.005645, loss_ss: 0.740168, loss_d: 0.265477
0.7704 --- loss: 1.263816, loss_ss: 0.799870, loss_d: 0.463946
0.8089 --- loss: 1.542915, loss_ss: 1.089907, loss_d: 0.453008
0.8475 --- loss: 1.073687, loss_ss: 0.892217, loss_d: 0.181471
0.8860 --- loss: 1.176653, loss_ss: 0.825410, loss_d: 0.351243
0.9245 --- loss: 1.587985, loss_ss: 1.059094, loss_d: 0.528891
0.9630 --- loss: 1.264805, loss_ss: 0.996752, loss_d: 0.268054
Epoch finished! Loss: 1.1892647623555541
Checkpoint 10 saved !
==== START TESTING ====
hello
Sleep stage: acc = 0.6253968253968254
             precision    recall  f1-score   support

        0.0       0.86      0.64      0.73       519
        1.0       0.36      0.27      0.31       201
        2.0       0.48      0.95      0.63       228
        3.0       0.92      0.84      0.87       158
        4.0       0.43      0.34      0.38       154

avg / total       0.67      0.63      0.62      1260
 


====== chp060-nsrr ======
   acc %  sen %  spec %  ppr %  f1-score
0  80.87  63.97   92.71  86.01     73.37
1  80.63  27.36   90.75  35.95     31.07
2  80.16  94.74   76.94  47.58     63.34
3  96.98  83.54   98.91  91.67     87.42
4  86.43  34.42   93.67  43.09     38.27
Total accuracy: 62.54%
Average sen: 60.81%
Average spec: 90.60%
Macro f1-score: 58.69%
Diagnosis acc on 15mins: 0.9761904761904762
[0.63750625 0.46930766 0.82061565 0.9818387  0.89047796 0.846295
 0.79713935 0.94494325 0.88743126 0.81446218 0.95311886 0.80323797
 0.94714797 0.87828451 0.9667753  0.96692121 0.99474192 0.9896825
 0.97724074 0.99225813 0.63694978 0.62230396 0.87698227 0.99350125
 0.97827339 0.99176812 0.88789111 0.99599862 0.60811287 0.8620702
 0.99704558 0.98323971 0.99773175 0.99599409 0.99592197 0.987867
 0.74554878 0.64554429 0.93101376 0.60730946 0.68330872 0.83717245]
pred: 0.8671660834834689, label: 1
Right! Diagnosis: Narcolepsy type 1

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  89.04  67.78   92.46  59.11     63.15
1  85.94  17.66   95.84  38.14     24.14
2  79.29  75.66   81.50  71.30     73.42
3  93.28  79.18   96.28  81.95     80.54
4  85.56  68.60   89.32  58.71     63.27
Total accuracy: 66.56%
Average sen: 61.78%
Average spec: 91.08%
Macro f1-score: 60.90%
Diagnosis acc on patients: 0.8461538461538461

====== all ======
   acc %  sen %  spec %  ppr %  f1-score
0  84.62  60.87   94.55  82.35     70.00
1  84.62  94.55   60.87  85.25     89.66
Total accuracy: 84.62%
Average sen: 77.71%
Average spec: 77.71%
Macro f1-score: 79.83%
fpr: 0.0, tpr: 0.01818181818181818, threshold: 0.9999858736991882, 
fpr: 0.0, tpr: 0.2, threshold: 0.979895614525851, 
fpr: 0.043478260869565216, tpr: 0.2, threshold: 0.978648972922358, 
fpr: 0.043478260869565216, tpr: 0.4, threshold: 0.9292090717289183, 
fpr: 0.08695652173913043, tpr: 0.4, threshold: 0.9194950938224793, 
fpr: 0.08695652173913043, tpr: 0.43636363636363634, threshold: 0.9129513700803121, 
fpr: 0.13043478260869565, tpr: 0.43636363636363634, threshold: 0.9112788842570397, 
fpr: 0.13043478260869565, tpr: 0.6181818181818182, threshold: 0.8604545936439977, 
fpr: 0.17391304347826086, tpr: 0.6181818181818182, threshold: 0.859458448710265, 
fpr: 0.17391304347826086, tpr: 0.6727272727272727, threshold: 0.8271603908004432, 
fpr: 0.21739130434782608, tpr: 0.6727272727272727, threshold: 0.8263148511094707, 
fpr: 0.21739130434782608, tpr: 0.7818181818181819, threshold: 0.7785079736601223, 
fpr: 0.2608695652173913, tpr: 0.7818181818181819, threshold: 0.757603800131215, 
fpr: 0.2608695652173913, tpr: 0.8727272727272727, threshold: 0.7377660920222601, 
fpr: 0.30434782608695654, tpr: 0.8727272727272727, threshold: 0.7295776442173989, 
fpr: 0.30434782608695654, tpr: 0.8909090909090909, threshold: 0.7184833283677245, 
fpr: 0.34782608695652173, tpr: 0.8909090909090909, threshold: 0.6553978727709863, 
fpr: 0.34782608695652173, tpr: 0.9272727272727272, threshold: 0.5513893836928953, 
fpr: 0.391304347826087, tpr: 0.9272727272727272, threshold: 0.5391531688826424, 
fpr: 0.391304347826087, tpr: 0.9454545454545454, threshold: 0.5088767288800549, 
fpr: 0.4782608695652174, tpr: 0.9454545454545454, threshold: 0.4469292461872101, 
fpr: 0.4782608695652174, tpr: 0.9636363636363636, threshold: 0.4295256388814826, 
fpr: 0.5652173913043478, tpr: 0.9636363636363636, threshold: 0.30779621723507133, 
fpr: 0.5652173913043478, tpr: 0.9818181818181818, threshold: 0.30228758965795105, 
fpr: 0.9130434782608695, tpr: 0.9818181818181818, threshold: 0.10414291803954256, 
fpr: 0.9130434782608695, tpr: 1.0, threshold: 0.10044159030076116, 
fpr: 1.0, tpr: 1.0, threshold: 0.03815560016570793, 

best_threshold: 0.7377660920222601, best_fpr: 0.2608695652173913, best_tpr: 0.8727272727272727
fpr: 0.0, tpr: 0.0005125576627370579, threshold: 0.9999997615814209, 
fpr: 0.0, tpr: 0.0015376729882111738, threshold: 0.9999995231628418, 
fpr: 0.0, tpr: 0.0046130189646335215, threshold: 0.9999994039535522, 
fpr: 0.0, tpr: 0.006150691952844695, threshold: 0.9999992847442627, 
fpr: 0.0, tpr: 0.006663249615581753, threshold: 0.9999991655349731, 
fpr: 0.0, tpr: 0.007688364941055869, threshold: 0.9999990463256836, 
fpr: 0.0, tpr: 0.009226037929267043, threshold: 0.9999984502792358, 
fpr: 0.0, tpr: 0.010251153254741158, threshold: 0.9999983310699463, 
fpr: 0.0, tpr: 0.010763710917478216, threshold: 0.9999982118606567, 
fpr: 0.0, tpr: 0.012813941568426449, threshold: 0.9999980926513672, 
fpr: 0.0, tpr: 0.014351614556637622, threshold: 0.999997615814209, 
fpr: 0.0, tpr: 0.016401845207585853, threshold: 0.9999974966049194, 
fpr: 0.0, tpr: 0.016914402870322913, threshold: 0.9999973773956299, 
fpr: 0.001455604075691412, tpr: 0.016914402870322913, threshold: 0.9999972581863403, 
fpr: 0.001455604075691412, tpr: 0.01998974884674526, threshold: 0.9999945163726807, 
fpr: 0.001455604075691412, tpr: 0.021527421834956432, threshold: 0.999994158744812, 
fpr: 0.001455604075691412, tpr: 0.02665299846232701, threshold: 0.9999910593032837, 
fpr: 0.002911208151382824, tpr: 0.02665299846232701, threshold: 0.9999903440475464, 
fpr: 0.002911208151382824, tpr: 0.02716555612506407, threshold: 0.9999899864196777, 
fpr: 0.002911208151382824, tpr: 0.028190671450538187, threshold: 0.9999896287918091, 
fpr: 0.002911208151382824, tpr: 0.030753459764223477, threshold: 0.9999877214431763, 
fpr: 0.002911208151382824, tpr: 0.032803690415171706, threshold: 0.9999864101409912, 
fpr: 0.002911208151382824, tpr: 0.033828805740645826, threshold: 0.9999849796295166, 
fpr: 0.002911208151382824, tpr: 0.035366478728856995, threshold: 0.9999823570251465, 
fpr: 0.002911208151382824, tpr: 0.03741670937980523, threshold: 0.9999793767929077, 
fpr: 0.002911208151382824, tpr: 0.03844182470527934, threshold: 0.9999788999557495, 
fpr: 0.002911208151382824, tpr: 0.040492055356227574, threshold: 0.9999727010726929, 
fpr: 0.002911208151382824, tpr: 0.041517170681701694, threshold: 0.9999725818634033, 
fpr: 0.002911208151382824, tpr: 0.04202972834443875, threshold: 0.9999715089797974, 
fpr: 0.004366812227074236, tpr: 0.04202972834443875, threshold: 0.9999651908874512, 
fpr: 0.004366812227074236, tpr: 0.04715530497180933, threshold: 0.9999473094940186, 
fpr: 0.005822416302765648, tpr: 0.04715530497180933, threshold: 0.9999465942382812, 
fpr: 0.005822416302765648, tpr: 0.052793439261916965, threshold: 0.9999358654022217, 
fpr: 0.00727802037845706, tpr: 0.052793439261916965, threshold: 0.999934196472168, 
fpr: 0.00727802037845706, tpr: 0.055356227575602254, threshold: 0.9999260902404785, 
fpr: 0.00727802037845706, tpr: 0.056381342901076374, threshold: 0.9999212026596069, 
fpr: 0.00727802037845706, tpr: 0.05689390056381343, threshold: 0.9999195337295532, 
fpr: 0.008733624454148471, tpr: 0.05740645822655049, threshold: 0.9999171495437622, 
fpr: 0.008733624454148471, tpr: 0.058944131214761664, threshold: 0.9999020099639893, 
fpr: 0.010189228529839884, tpr: 0.058944131214761664, threshold: 0.9999011754989624, 
fpr: 0.010189228529839884, tpr: 0.06253203485392107, threshold: 0.9998911619186401, 
fpr: 0.010189228529839884, tpr: 0.06355715017939519, threshold: 0.9998894929885864, 
fpr: 0.010189228529839884, tpr: 0.06663249615581752, threshold: 0.9998462200164795, 
fpr: 0.010189228529839884, tpr: 0.06765761148129165, threshold: 0.9998459815979004, 
fpr: 0.010189228529839884, tpr: 0.0902101486417222, threshold: 0.9994118213653564, 
fpr: 0.011644832605531296, tpr: 0.0902101486417222, threshold: 0.9994043111801147, 
fpr: 0.011644832605531296, tpr: 0.09277293695540749, threshold: 0.9993717074394226, 
fpr: 0.011644832605531296, tpr: 0.0937980522808816, threshold: 0.9993557333946228, 
fpr: 0.011644832605531296, tpr: 0.09943618657098924, threshold: 0.9992361068725586, 
fpr: 0.013100436681222707, tpr: 0.09943618657098924, threshold: 0.9992350339889526, 
fpr: 0.013100436681222707, tpr: 0.10302409021014865, threshold: 0.9991989731788635, 
fpr: 0.01455604075691412, tpr: 0.10302409021014865, threshold: 0.9991924166679382, 
fpr: 0.01455604075691412, tpr: 0.10456176319835982, threshold: 0.9991683959960938, 
fpr: 0.01601164483260553, tpr: 0.10456176319835982, threshold: 0.9991500377655029, 
fpr: 0.01601164483260553, tpr: 0.10763710917478217, threshold: 0.9990641474723816, 
fpr: 0.017467248908296942, tpr: 0.10763710917478217, threshold: 0.999054491519928, 
fpr: 0.017467248908296942, tpr: 0.11019989748846745, threshold: 0.9989948868751526, 
fpr: 0.018922852983988356, tpr: 0.11019989748846745, threshold: 0.9989863038063049, 
fpr: 0.018922852983988356, tpr: 0.11993849308047155, threshold: 0.9988090991973877, 
fpr: 0.018922852983988356, tpr: 0.12096360840594567, threshold: 0.9988038539886475, 
fpr: 0.018922852983988356, tpr: 0.12352639671963096, threshold: 0.9986817240715027, 
fpr: 0.018922852983988356, tpr: 0.12455151204510508, threshold: 0.9986746311187744, 
fpr: 0.018922852983988356, tpr: 0.13582778062532036, threshold: 0.9983413219451904, 
fpr: 0.020378457059679767, tpr: 0.13582778062532036, threshold: 0.9983356595039368, 
fpr: 0.020378457059679767, tpr: 0.13941568426447976, threshold: 0.9982062578201294, 
fpr: 0.021834061135371178, tpr: 0.13941568426447976, threshold: 0.9981892704963684, 
fpr: 0.021834061135371178, tpr: 0.1486417221937468, threshold: 0.9979615211486816, 
fpr: 0.023289665211062592, tpr: 0.1486417221937468, threshold: 0.9979530572891235, 
fpr: 0.023289665211062592, tpr: 0.14915427985648386, threshold: 0.9979274272918701, 
fpr: 0.026200873362445413, tpr: 0.14915427985648386, threshold: 0.9978917241096497, 
fpr: 0.026200873362445413, tpr: 0.15171706817016914, threshold: 0.9978043437004089, 
fpr: 0.027656477438136828, tpr: 0.15171706817016914, threshold: 0.9977939128875732, 
fpr: 0.027656477438136828, tpr: 0.15479241414659148, threshold: 0.9976766705513, 
fpr: 0.02911208151382824, tpr: 0.15479241414659148, threshold: 0.9976471066474915, 
fpr: 0.02911208151382824, tpr: 0.16094310609943618, threshold: 0.9975228905677795, 
fpr: 0.03056768558951965, tpr: 0.16094310609943618, threshold: 0.9975124597549438, 
fpr: 0.03056768558951965, tpr: 0.1619682214249103, threshold: 0.997456967830658, 
fpr: 0.03202328966521106, tpr: 0.1619682214249103, threshold: 0.9974198341369629, 
fpr: 0.03202328966521106, tpr: 0.1629933367503844, threshold: 0.9973962306976318, 
fpr: 0.033478893740902474, tpr: 0.1629933367503844, threshold: 0.9973823428153992, 
fpr: 0.033478893740902474, tpr: 0.16965658636596617, threshold: 0.997220516204834, 
fpr: 0.034934497816593885, tpr: 0.16965658636596617, threshold: 0.9971790313720703, 
fpr: 0.034934497816593885, tpr: 0.1727319323423885, threshold: 0.9970771074295044, 
fpr: 0.036390101892285295, tpr: 0.1727319323423885, threshold: 0.9970675110816956, 
fpr: 0.036390101892285295, tpr: 0.1824705279343926, threshold: 0.9966860413551331, 
fpr: 0.03784570596797671, tpr: 0.1824705279343926, threshold: 0.996677041053772, 
fpr: 0.03784570596797671, tpr: 0.18349564325986673, threshold: 0.9966602325439453, 
fpr: 0.039301310043668124, tpr: 0.18349564325986673, threshold: 0.9966599941253662, 
fpr: 0.039301310043668124, tpr: 0.19374679651460788, threshold: 0.9963507652282715, 
fpr: 0.040756914119359534, tpr: 0.19374679651460788, threshold: 0.9963248372077942, 
fpr: 0.040756914119359534, tpr: 0.19887237314197848, threshold: 0.9960458874702454, 
fpr: 0.043668122270742356, tpr: 0.19887237314197848, threshold: 0.995998740196228, 
fpr: 0.043668122270742356, tpr: 0.20194771911840081, threshold: 0.9958924055099487, 
fpr: 0.04512372634643377, tpr: 0.20194771911840081, threshold: 0.9958810806274414, 
fpr: 0.04512372634643377, tpr: 0.20297283444387493, threshold: 0.9958421587944031, 
fpr: 0.046579330422125184, tpr: 0.20297283444387493, threshold: 0.9958154559135437, 
fpr: 0.046579330422125184, tpr: 0.20758585340850846, threshold: 0.9955675005912781, 
fpr: 0.048034934497816595, tpr: 0.20758585340850846, threshold: 0.9955472946166992, 
fpr: 0.048034934497816595, tpr: 0.21117375704766786, threshold: 0.9954347014427185, 
fpr: 0.049490538573508006, tpr: 0.21117375704766786, threshold: 0.9953739047050476, 
fpr: 0.049490538573508006, tpr: 0.2168118913377755, threshold: 0.9950987696647644, 
fpr: 0.050946142649199416, tpr: 0.2168118913377755, threshold: 0.9950610995292664, 
fpr: 0.050946142649199416, tpr: 0.21783700666324962, threshold: 0.9949777722358704, 
fpr: 0.05240174672489083, tpr: 0.21783700666324962, threshold: 0.9949669241905212, 
fpr: 0.05240174672489083, tpr: 0.21834956432598668, threshold: 0.9949648380279541, 
fpr: 0.053857350800582245, tpr: 0.21834956432598668, threshold: 0.9949634075164795, 
fpr: 0.053857350800582245, tpr: 0.2203997949769349, threshold: 0.9947983026504517, 
fpr: 0.055312954876273655, tpr: 0.2203997949769349, threshold: 0.9947904348373413, 
fpr: 0.055312954876273655, tpr: 0.22347514095335724, threshold: 0.9946441650390625, 
fpr: 0.056768558951965066, tpr: 0.22347514095335724, threshold: 0.994641900062561, 
fpr: 0.056768558951965066, tpr: 0.22450025627883136, threshold: 0.9945782423019409, 
fpr: 0.05822416302765648, tpr: 0.22450025627883136, threshold: 0.9945465326309204, 
fpr: 0.05822416302765648, tpr: 0.2337262942080984, threshold: 0.9938461184501648, 
fpr: 0.05967976710334789, tpr: 0.2337262942080984, threshold: 0.9937487840652466, 
fpr: 0.05967976710334789, tpr: 0.24038954382368016, threshold: 0.9932287931442261, 
fpr: 0.0611353711790393, tpr: 0.24038954382368016, threshold: 0.993221640586853, 
fpr: 0.0611353711790393, tpr: 0.2460276781137878, threshold: 0.9928547739982605, 
fpr: 0.06404657933042213, tpr: 0.2460276781137878, threshold: 0.9926395416259766, 
fpr: 0.06404657933042213, tpr: 0.25422860071758074, threshold: 0.9917439818382263, 
fpr: 0.06695778748180495, tpr: 0.25422860071758074, threshold: 0.991690993309021, 
fpr: 0.06695778748180495, tpr: 0.25525371604305486, threshold: 0.9916447997093201, 
fpr: 0.06841339155749636, tpr: 0.25525371604305486, threshold: 0.991637647151947, 
fpr: 0.06841339155749636, tpr: 0.25627883136852897, threshold: 0.9915247559547424, 
fpr: 0.06986899563318777, tpr: 0.25627883136852897, threshold: 0.991520345211029, 
fpr: 0.06986899563318777, tpr: 0.2593541773449513, threshold: 0.9912319779396057, 
fpr: 0.07132459970887918, tpr: 0.2593541773449513, threshold: 0.9911916851997375, 
fpr: 0.07132459970887918, tpr: 0.2603792926704254, threshold: 0.9911192059516907, 
fpr: 0.07278020378457059, tpr: 0.2603792926704254, threshold: 0.9910911321640015, 
fpr: 0.07278020378457059, tpr: 0.2608918503331625, threshold: 0.9910334944725037, 
fpr: 0.07423580786026202, tpr: 0.2608918503331625, threshold: 0.9910072684288025, 
fpr: 0.07423580786026202, tpr: 0.2690927729369554, threshold: 0.9903477430343628, 
fpr: 0.07569141193595343, tpr: 0.2690927729369554, threshold: 0.9902613759040833, 
fpr: 0.07569141193595343, tpr: 0.27268067657611483, threshold: 0.989890456199646, 
fpr: 0.07714701601164484, tpr: 0.27268067657611483, threshold: 0.989865243434906, 
fpr: 0.07714701601164484, tpr: 0.2752434648898001, threshold: 0.9896467328071594, 
fpr: 0.07714701601164484, tpr: 0.27626858021527423, threshold: 0.9896101951599121, 
fpr: 0.07714701601164484, tpr: 0.283444387493593, threshold: 0.9890261292457581, 
fpr: 0.08005822416302766, tpr: 0.283444387493593, threshold: 0.9890226125717163, 
fpr: 0.08005822416302766, tpr: 0.2860071758072783, threshold: 0.9889355301856995, 
fpr: 0.08151382823871907, tpr: 0.2860071758072783, threshold: 0.9889153838157654, 
fpr: 0.08151382823871907, tpr: 0.291645310097386, threshold: 0.9885666966438293, 
fpr: 0.08296943231441048, tpr: 0.291645310097386, threshold: 0.9885337948799133, 
fpr: 0.08296943231441048, tpr: 0.3044592516658124, threshold: 0.9876519441604614, 
fpr: 0.08442503639010189, tpr: 0.3044592516658124, threshold: 0.9876112341880798, 
fpr: 0.08442503639010189, tpr: 0.31727319323423886, threshold: 0.9867154955863953, 
fpr: 0.0858806404657933, tpr: 0.31727319323423886, threshold: 0.9867033958435059, 
fpr: 0.0858806404657933, tpr: 0.3223987698616094, threshold: 0.986376941204071, 
fpr: 0.08879184861717612, tpr: 0.3223987698616094, threshold: 0.9861209988594055, 
fpr: 0.08879184861717612, tpr: 0.32342388518708354, threshold: 0.9860914349555969, 
fpr: 0.09024745269286755, tpr: 0.32342388518708354, threshold: 0.9859734773635864, 
fpr: 0.09024745269286755, tpr: 0.3259866735007688, threshold: 0.9857075810432434, 
fpr: 0.09170305676855896, tpr: 0.3259866735007688, threshold: 0.9856905341148376, 
fpr: 0.09170305676855896, tpr: 0.3285494618144541, threshold: 0.9853180646896362, 
fpr: 0.09170305676855896, tpr: 0.3295745771399282, threshold: 0.985289990901947, 
fpr: 0.09170305676855896, tpr: 0.33316248077908767, threshold: 0.9850650429725647, 
fpr: 0.09315866084425037, tpr: 0.33316248077908767, threshold: 0.9849997758865356, 
fpr: 0.09315866084425037, tpr: 0.3388006150691953, threshold: 0.9847803115844727, 
fpr: 0.09461426491994178, tpr: 0.3388006150691953, threshold: 0.9847455620765686, 
fpr: 0.09461426491994178, tpr: 0.34033828805740646, threshold: 0.9845094084739685, 
fpr: 0.09606986899563319, tpr: 0.34033828805740646, threshold: 0.9844590425491333, 
fpr: 0.09606986899563319, tpr: 0.3521271143003588, threshold: 0.9833817481994629, 
fpr: 0.0975254730713246, tpr: 0.3521271143003588, threshold: 0.9832442402839661, 
fpr: 0.0975254730713246, tpr: 0.3603280369041517, threshold: 0.9823525547981262, 
fpr: 0.09898107714701601, tpr: 0.3603280369041517, threshold: 0.9823212623596191, 
fpr: 0.09898107714701601, tpr: 0.36135315222962583, threshold: 0.9822888374328613, 
fpr: 0.10043668122270742, tpr: 0.36135315222962583, threshold: 0.9822559356689453, 
fpr: 0.10043668122270742, tpr: 0.36340338288057406, threshold: 0.9820189476013184, 
fpr: 0.10189228529839883, tpr: 0.36340338288057406, threshold: 0.9819132685661316, 
fpr: 0.10189228529839883, tpr: 0.37006663249615585, threshold: 0.9812353849411011, 
fpr: 0.10334788937409024, tpr: 0.37006663249615585, threshold: 0.9812033772468567, 
fpr: 0.10334788937409024, tpr: 0.3762173244490005, threshold: 0.9805473685264587, 
fpr: 0.10480349344978165, tpr: 0.3762173244490005, threshold: 0.9805168509483337, 
fpr: 0.10480349344978165, tpr: 0.40492055356227574, threshold: 0.9767177700996399, 
fpr: 0.10625909752547306, tpr: 0.40492055356227574, threshold: 0.9766716957092285, 
fpr: 0.10625909752547306, tpr: 0.41517170681701693, threshold: 0.9753981232643127, 
fpr: 0.1091703056768559, tpr: 0.41517170681701693, threshold: 0.9753034114837646, 
fpr: 0.1091703056768559, tpr: 0.41722193746796515, threshold: 0.975109338760376, 
fpr: 0.11062590975254731, tpr: 0.41722193746796515, threshold: 0.9750723838806152, 
fpr: 0.11062590975254731, tpr: 0.4177344951307022, threshold: 0.975054144859314, 
fpr: 0.11208151382823872, tpr: 0.4177344951307022, threshold: 0.975002110004425, 
fpr: 0.11208151382823872, tpr: 0.4192721681189134, threshold: 0.9746806025505066, 
fpr: 0.11353711790393013, tpr: 0.4192721681189134, threshold: 0.9746144413948059, 
fpr: 0.11353711790393013, tpr: 0.41978472578165044, threshold: 0.9745873808860779, 
fpr: 0.11499272197962154, tpr: 0.41978472578165044, threshold: 0.9745723605155945, 
fpr: 0.11499272197962154, tpr: 0.4238851870835469, threshold: 0.9739941954612732, 
fpr: 0.11644832605531295, tpr: 0.4238851870835469, threshold: 0.973929762840271, 
fpr: 0.11644832605531295, tpr: 0.4269605330599692, threshold: 0.9734721183776855, 
fpr: 0.11935953420669577, tpr: 0.4269605330599692, threshold: 0.9734233617782593, 
fpr: 0.11935953420669577, tpr: 0.4274730907227063, threshold: 0.9733423590660095, 
fpr: 0.12081513828238719, tpr: 0.4274730907227063, threshold: 0.9733384251594543, 
fpr: 0.12081513828238719, tpr: 0.42798564838544334, threshold: 0.9732832908630371, 
fpr: 0.1222707423580786, tpr: 0.42798564838544334, threshold: 0.9732374548912048, 
fpr: 0.1222707423580786, tpr: 0.42901076371091745, threshold: 0.9731324315071106, 
fpr: 0.12372634643377002, tpr: 0.42901076371091745, threshold: 0.9731054902076721, 
fpr: 0.12372634643377002, tpr: 0.4341363403382881, threshold: 0.9724684357643127, 
fpr: 0.12518195050946143, tpr: 0.4341363403382881, threshold: 0.9724406003952026, 
fpr: 0.12518195050946143, tpr: 0.43772424397744747, threshold: 0.9721254110336304, 
fpr: 0.13100436681222707, tpr: 0.43772424397744747, threshold: 0.9719569683074951, 
fpr: 0.13100436681222707, tpr: 0.44131214761660686, threshold: 0.9712093472480774, 
fpr: 0.1324599708879185, tpr: 0.44131214761660686, threshold: 0.9711472988128662, 
fpr: 0.1324599708879185, tpr: 0.4433623782675551, threshold: 0.9709142446517944, 
fpr: 0.1339155749636099, tpr: 0.4433623782675551, threshold: 0.9708430171012878, 
fpr: 0.1339155749636099, tpr: 0.45156330087134805, threshold: 0.9700408577919006, 
fpr: 0.13682678311499272, tpr: 0.45156330087134805, threshold: 0.9697964191436768, 
fpr: 0.13682678311499272, tpr: 0.4618144541260892, threshold: 0.967881977558136, 
fpr: 0.14119359534206696, tpr: 0.4618144541260892, threshold: 0.9677185416221619, 
fpr: 0.14119359534206696, tpr: 0.4628395694515633, threshold: 0.9674974083900452, 
fpr: 0.14264919941775836, tpr: 0.4628395694515633, threshold: 0.9674941897392273, 
fpr: 0.14264919941775836, tpr: 0.47104049205535625, threshold: 0.9667277336120605, 
fpr: 0.14410480349344978, tpr: 0.47104049205535625, threshold: 0.9666175842285156, 
fpr: 0.14410480349344978, tpr: 0.4761660686827268, threshold: 0.9647942185401917, 
fpr: 0.14556040756914118, tpr: 0.4761660686827268, threshold: 0.9647323489189148, 
fpr: 0.14556040756914118, tpr: 0.48385443362378266, threshold: 0.9632465839385986, 
fpr: 0.1470160116448326, tpr: 0.48385443362378266, threshold: 0.963230311870575, 
fpr: 0.1470160116448326, tpr: 0.4900051255766274, threshold: 0.961341142654419, 
fpr: 0.14847161572052403, tpr: 0.4900051255766274, threshold: 0.9613355398178101, 
fpr: 0.14847161572052403, tpr: 0.4946181445412609, threshold: 0.9606227278709412, 
fpr: 0.15138282387190685, tpr: 0.4946181445412609, threshold: 0.9603918790817261, 
fpr: 0.15138282387190685, tpr: 0.5023065094823168, threshold: 0.9589022397994995, 
fpr: 0.15283842794759825, tpr: 0.5023065094823168, threshold: 0.9588825106620789, 
fpr: 0.15283842794759825, tpr: 0.5099948744233727, threshold: 0.9566735029220581, 
fpr: 0.15574963609898107, tpr: 0.5099948744233727, threshold: 0.9562596678733826, 
fpr: 0.15574963609898107, tpr: 0.5120451050743209, threshold: 0.955615758895874, 
fpr: 0.1572052401746725, tpr: 0.5120451050743209, threshold: 0.9554442167282104, 
fpr: 0.1572052401746725, tpr: 0.5243464889800102, threshold: 0.9520173072814941, 
fpr: 0.16011644832605532, tpr: 0.5243464889800102, threshold: 0.9515262842178345, 
fpr: 0.16011644832605532, tpr: 0.5335725269092773, threshold: 0.9489274621009827, 
fpr: 0.1615720524017467, tpr: 0.5335725269092773, threshold: 0.9488111138343811, 
fpr: 0.1615720524017467, tpr: 0.5345976422347514, threshold: 0.9484171867370605, 
fpr: 0.16302765647743814, tpr: 0.5345976422347514, threshold: 0.9481795430183411, 
fpr: 0.16302765647743814, tpr: 0.5361353152229625, threshold: 0.9475995302200317, 
fpr: 0.16448326055312956, tpr: 0.5361353152229625, threshold: 0.947541356086731, 
fpr: 0.16448326055312956, tpr: 0.5427985648385444, threshold: 0.9457477927207947, 
fpr: 0.16593886462882096, tpr: 0.5427985648385444, threshold: 0.9456732869148254, 
fpr: 0.16593886462882096, tpr: 0.5438236801640185, threshold: 0.9454739689826965, 
fpr: 0.16739446870451238, tpr: 0.5438236801640185, threshold: 0.9453614354133606, 
fpr: 0.16739446870451238, tpr: 0.5453613531522297, threshold: 0.9449379444122314, 
fpr: 0.1703056768558952, tpr: 0.5453613531522297, threshold: 0.9447707533836365, 
fpr: 0.1703056768558952, tpr: 0.5474115838031779, threshold: 0.9440825581550598, 
fpr: 0.1717612809315866, tpr: 0.5474115838031779, threshold: 0.9437955021858215, 
fpr: 0.1717612809315866, tpr: 0.548436699128652, threshold: 0.9434767961502075, 
fpr: 0.17321688500727803, tpr: 0.548436699128652, threshold: 0.9434027671813965, 
fpr: 0.17321688500727803, tpr: 0.5499743721168632, threshold: 0.9426084160804749, 
fpr: 0.17467248908296942, tpr: 0.5499743721168632, threshold: 0.9426041841506958, 
fpr: 0.17467248908296942, tpr: 0.5525371604305485, threshold: 0.9422373175621033, 
fpr: 0.17758369723435224, tpr: 0.5525371604305485, threshold: 0.9421918392181396, 
fpr: 0.17758369723435224, tpr: 0.5597129677088672, threshold: 0.9388535022735596, 
fpr: 0.17903930131004367, tpr: 0.5597129677088672, threshold: 0.938583493232727, 
fpr: 0.17903930131004367, tpr: 0.5653511019989749, threshold: 0.9369553327560425, 
fpr: 0.1804949053857351, tpr: 0.5653511019989749, threshold: 0.9368196129798889, 
fpr: 0.1804949053857351, tpr: 0.566888774987186, threshold: 0.9364222288131714, 
fpr: 0.18340611353711792, tpr: 0.566888774987186, threshold: 0.9357675909996033, 
fpr: 0.18340611353711792, tpr: 0.5679138903126602, threshold: 0.9357126951217651, 
fpr: 0.1848617176128093, tpr: 0.5679138903126602, threshold: 0.9356264472007751, 
fpr: 0.1848617176128093, tpr: 0.5689390056381343, threshold: 0.9352031946182251, 
fpr: 0.18631732168850074, tpr: 0.5689390056381343, threshold: 0.9351522922515869, 
fpr: 0.18631732168850074, tpr: 0.5740645822655048, threshold: 0.9331797957420349, 
fpr: 0.18777292576419213, tpr: 0.5740645822655048, threshold: 0.932838499546051, 
fpr: 0.18777292576419213, tpr: 0.5791901588928754, threshold: 0.9310137629508972, 
fpr: 0.18922852983988356, tpr: 0.5791901588928754, threshold: 0.9309865832328796, 
fpr: 0.18922852983988356, tpr: 0.5812403895438237, threshold: 0.929876983165741, 
fpr: 0.19213973799126638, tpr: 0.5812403895438237, threshold: 0.9297124743461609, 
fpr: 0.19213973799126638, tpr: 0.5920041004613019, threshold: 0.924982488155365, 
fpr: 0.19359534206695778, tpr: 0.5920041004613019, threshold: 0.9248852133750916, 
fpr: 0.19359534206695778, tpr: 0.5996924654023578, threshold: 0.9223275780677795, 
fpr: 0.1950509461426492, tpr: 0.5996924654023578, threshold: 0.9214634299278259, 
fpr: 0.1950509461426492, tpr: 0.6053305996924654, threshold: 0.9188698530197144, 
fpr: 0.1965065502183406, tpr: 0.6053305996924654, threshold: 0.9187813401222229, 
fpr: 0.1965065502183406, tpr: 0.6181445412608918, threshold: 0.9144768714904785, 
fpr: 0.19796215429403202, tpr: 0.6181445412608918, threshold: 0.9144408106803894, 
fpr: 0.19796215429403202, tpr: 0.6304459251665813, threshold: 0.9094010591506958, 
fpr: 0.19941775836972345, tpr: 0.6304459251665813, threshold: 0.909255862236023, 
fpr: 0.19941775836972345, tpr: 0.6340338288057407, threshold: 0.9076218605041504, 
fpr: 0.19941775836972345, tpr: 0.6350589441312148, threshold: 0.9074347615242004, 
fpr: 0.19941775836972345, tpr: 0.6447975397232188, threshold: 0.9037852883338928, 
fpr: 0.20087336244541484, tpr: 0.6447975397232188, threshold: 0.9036523103713989, 
fpr: 0.20087336244541484, tpr: 0.6478728856996412, threshold: 0.9027377963066101, 
fpr: 0.20232896652110627, tpr: 0.6478728856996412, threshold: 0.902430534362793, 
fpr: 0.20232896652110627, tpr: 0.6488980010251153, threshold: 0.9015656113624573, 
fpr: 0.20378457059679767, tpr: 0.6488980010251153, threshold: 0.9013134241104126, 
fpr: 0.20378457059679767, tpr: 0.6519733470015376, threshold: 0.9000906348228455, 
fpr: 0.2052401746724891, tpr: 0.6519733470015376, threshold: 0.9000576138496399, 
fpr: 0.2052401746724891, tpr: 0.6529984623270118, threshold: 0.8994892835617065, 
fpr: 0.2066957787481805, tpr: 0.6529984623270118, threshold: 0.8993499875068665, 
fpr: 0.2066957787481805, tpr: 0.655561250640697, threshold: 0.896777868270874, 
fpr: 0.2081513828238719, tpr: 0.655561250640697, threshold: 0.8965351581573486, 
fpr: 0.2081513828238719, tpr: 0.6565863659661711, threshold: 0.8959413766860962, 
fpr: 0.2096069868995633, tpr: 0.6565863659661711, threshold: 0.8955833911895752, 
fpr: 0.2096069868995633, tpr: 0.6699128651973347, threshold: 0.8854044079780579, 
fpr: 0.21106259097525473, tpr: 0.6699128651973347, threshold: 0.8853129148483276, 
fpr: 0.21106259097525473, tpr: 0.6740133264992312, threshold: 0.8811975717544556, 
fpr: 0.21251819505094613, tpr: 0.6740133264992312, threshold: 0.8811464905738831, 
fpr: 0.21251819505094613, tpr: 0.6822142491030241, threshold: 0.8768105506896973, 
fpr: 0.21542940320232898, tpr: 0.6822142491030241, threshold: 0.8754059076309204, 
fpr: 0.21542940320232898, tpr: 0.6847770374167094, threshold: 0.8731433153152466, 
fpr: 0.21688500727802038, tpr: 0.6847770374167094, threshold: 0.8726152181625366, 
fpr: 0.21688500727802038, tpr: 0.6945156330087134, threshold: 0.8663474321365356, 
fpr: 0.2197962154294032, tpr: 0.6945156330087134, threshold: 0.8658819198608398, 
fpr: 0.2197962154294032, tpr: 0.6950281906714505, threshold: 0.8653975129127502, 
fpr: 0.22125181950509462, tpr: 0.6950281906714505, threshold: 0.8645702004432678, 
fpr: 0.22125181950509462, tpr: 0.7052793439261917, threshold: 0.857513964176178, 
fpr: 0.22270742358078602, tpr: 0.7052793439261917, threshold: 0.8574852347373962, 
fpr: 0.22270742358078602, tpr: 0.7083546899026141, threshold: 0.8556591868400574, 
fpr: 0.22416302765647744, tpr: 0.7083546899026141, threshold: 0.8553863763809204, 
fpr: 0.22416302765647744, tpr: 0.7088672475653511, threshold: 0.8535096645355225, 
fpr: 0.22561863173216884, tpr: 0.7088672475653511, threshold: 0.8533812761306763, 
fpr: 0.22561863173216884, tpr: 0.7155304971809329, threshold: 0.8471182584762573, 
fpr: 0.22707423580786026, tpr: 0.7155304971809329, threshold: 0.8463315367698669, 
fpr: 0.22707423580786026, tpr: 0.7216811891337775, threshold: 0.8423974514007568, 
fpr: 0.22852983988355166, tpr: 0.7216811891337775, threshold: 0.8419423699378967, 
fpr: 0.22852983988355166, tpr: 0.7232188621219887, threshold: 0.8413804173469543, 
fpr: 0.2314410480349345, tpr: 0.7232188621219887, threshold: 0.8401870131492615, 
fpr: 0.2314410480349345, tpr: 0.7237314197847258, threshold: 0.8398950695991516, 
fpr: 0.23435225618631733, tpr: 0.7237314197847258, threshold: 0.8397531509399414, 
fpr: 0.23435225618631733, tpr: 0.7242439774474628, threshold: 0.8394830822944641, 
fpr: 0.23580786026200873, tpr: 0.7242439774474628, threshold: 0.839413046836853, 
fpr: 0.23580786026200873, tpr: 0.7252690927729369, threshold: 0.839270293712616, 
fpr: 0.23726346433770015, tpr: 0.7252690927729369, threshold: 0.8390754461288452, 
fpr: 0.23726346433770015, tpr: 0.7288569964120963, threshold: 0.8367047905921936, 
fpr: 0.24017467248908297, tpr: 0.7288569964120963, threshold: 0.8352382183074951, 
fpr: 0.24017467248908297, tpr: 0.7319323423885187, threshold: 0.8326109051704407, 
fpr: 0.24163027656477437, tpr: 0.7319323423885187, threshold: 0.8319101929664612, 
fpr: 0.24163027656477437, tpr: 0.734495130702204, threshold: 0.8299210667610168, 
fpr: 0.2430858806404658, tpr: 0.734495130702204, threshold: 0.8298786282539368, 
fpr: 0.2430858806404658, tpr: 0.7380830343413634, threshold: 0.827330470085144, 
fpr: 0.2445414847161572, tpr: 0.7380830343413634, threshold: 0.8258338570594788, 
fpr: 0.2445414847161572, tpr: 0.7396207073295745, threshold: 0.8245626091957092, 
fpr: 0.24745269286754004, tpr: 0.7396207073295745, threshold: 0.824084460735321, 
fpr: 0.24745269286754004, tpr: 0.7401332649923117, threshold: 0.8228424191474915, 
fpr: 0.24890829694323144, tpr: 0.7401332649923117, threshold: 0.8220034837722778, 
fpr: 0.24890829694323144, tpr: 0.7437211686314711, threshold: 0.8163305521011353, 
fpr: 0.25036390101892286, tpr: 0.7437211686314711, threshold: 0.8156343698501587, 
fpr: 0.25036390101892286, tpr: 0.7452588416196823, threshold: 0.8144044876098633, 
fpr: 0.25181950509461426, tpr: 0.7452588416196823, threshold: 0.8135353922843933, 
fpr: 0.25181950509461426, tpr: 0.7514095335725269, threshold: 0.8041287660598755, 
fpr: 0.2547307132459971, tpr: 0.7514095335725269, threshold: 0.8032780885696411, 
fpr: 0.2547307132459971, tpr: 0.751922091235264, threshold: 0.8032379746437073, 
fpr: 0.2561863173216885, tpr: 0.751922091235264, threshold: 0.8028374910354614, 
fpr: 0.2561863173216885, tpr: 0.7539723218862122, threshold: 0.7984502911567688, 
fpr: 0.2576419213973799, tpr: 0.7539723218862122, threshold: 0.7978805303573608, 
fpr: 0.2576419213973799, tpr: 0.7565351101998975, threshold: 0.7954796552658081, 
fpr: 0.26055312954876275, tpr: 0.7565351101998975, threshold: 0.7943505048751831, 
fpr: 0.26055312954876275, tpr: 0.7601230138390569, threshold: 0.7909067869186401, 
fpr: 0.26200873362445415, tpr: 0.7601230138390569, threshold: 0.7904173731803894, 
fpr: 0.26200873362445415, tpr: 0.7631983598154792, threshold: 0.7863993644714355, 
fpr: 0.26346433770014555, tpr: 0.7631983598154792, threshold: 0.7856220006942749, 
fpr: 0.26346433770014555, tpr: 0.7637109174782163, threshold: 0.7849963903427124, 
fpr: 0.2663755458515284, tpr: 0.7637109174782163, threshold: 0.7837338447570801, 
fpr: 0.2663755458515284, tpr: 0.7647360328036904, threshold: 0.7826385498046875, 
fpr: 0.2692867540029112, tpr: 0.7647360328036904, threshold: 0.78125, 
fpr: 0.2692867540029112, tpr: 0.7678113787801127, threshold: 0.778852641582489, 
fpr: 0.27074235807860264, tpr: 0.7678113787801127, threshold: 0.7787725925445557, 
fpr: 0.27074235807860264, tpr: 0.770374167093798, threshold: 0.773701012134552, 
fpr: 0.27219796215429404, tpr: 0.770374167093798, threshold: 0.7733355164527893, 
fpr: 0.27219796215429404, tpr: 0.7713992824192721, threshold: 0.7727544903755188, 
fpr: 0.2765647743813683, tpr: 0.7713992824192721, threshold: 0.769422173500061, 
fpr: 0.2765647743813683, tpr: 0.7734495130702204, threshold: 0.7659047245979309, 
fpr: 0.2780203784570597, tpr: 0.7734495130702204, threshold: 0.7647044062614441, 
fpr: 0.2780203784570597, tpr: 0.7739620707329574, threshold: 0.7641131281852722, 
fpr: 0.2794759825327511, tpr: 0.7739620707329574, threshold: 0.7633219957351685, 
fpr: 0.2794759825327511, tpr: 0.7775499743721168, threshold: 0.7608534097671509, 
fpr: 0.2823871906841339, tpr: 0.7775499743721168, threshold: 0.7599762678146362, 
fpr: 0.2823871906841339, tpr: 0.7801127626858022, threshold: 0.7568655610084534, 
fpr: 0.2852983988355167, tpr: 0.7801127626858022, threshold: 0.755962610244751, 
fpr: 0.2852983988355167, tpr: 0.7837006663249616, threshold: 0.7516058087348938, 
fpr: 0.28820960698689957, tpr: 0.7837006663249616, threshold: 0.7501724362373352, 
fpr: 0.28820960698689957, tpr: 0.787801127626858, threshold: 0.7462263107299805, 
fpr: 0.28966521106259097, tpr: 0.787801127626858, threshold: 0.7460998892784119, 
fpr: 0.28966521106259097, tpr: 0.7883136852895951, threshold: 0.7455487847328186, 
fpr: 0.2925764192139738, tpr: 0.7883136852895951, threshold: 0.7419602274894714, 
fpr: 0.2925764192139738, tpr: 0.7954894925679139, threshold: 0.7303816080093384, 
fpr: 0.2954876273653566, tpr: 0.7954894925679139, threshold: 0.7299505472183228, 
fpr: 0.2954876273653566, tpr: 0.7970271655561251, threshold: 0.7283922433853149, 
fpr: 0.29694323144104806, tpr: 0.7970271655561251, threshold: 0.7282299995422363, 
fpr: 0.29694323144104806, tpr: 0.7975397232188621, threshold: 0.726516604423523, 
fpr: 0.29839883551673946, tpr: 0.7975397232188621, threshold: 0.7243548631668091, 
fpr: 0.29839883551673946, tpr: 0.7985648385443362, threshold: 0.7240678071975708, 
fpr: 0.29985443959243085, tpr: 0.7985648385443362, threshold: 0.7226876020431519, 
fpr: 0.29985443959243085, tpr: 0.8006150691952845, threshold: 0.7210763096809387, 
fpr: 0.3027656477438137, tpr: 0.8006150691952845, threshold: 0.7210032343864441, 
fpr: 0.3027656477438137, tpr: 0.8021527421834956, threshold: 0.7175086140632629, 
fpr: 0.3042212518195051, tpr: 0.8021527421834956, threshold: 0.7168847918510437, 
fpr: 0.3042212518195051, tpr: 0.805228088159918, threshold: 0.7134644389152527, 
fpr: 0.3056768558951965, tpr: 0.805228088159918, threshold: 0.7128942608833313, 
fpr: 0.3056768558951965, tpr: 0.8103536647872885, threshold: 0.7042108774185181, 
fpr: 0.30858806404657935, tpr: 0.8103536647872885, threshold: 0.7019000053405762, 
fpr: 0.30858806404657935, tpr: 0.8113787801127627, threshold: 0.7004134058952332, 
fpr: 0.31149927219796214, tpr: 0.8113787801127627, threshold: 0.70006263256073, 
fpr: 0.31149927219796214, tpr: 0.8159917990773962, threshold: 0.6949369311332703, 
fpr: 0.3129548762736536, tpr: 0.8159917990773962, threshold: 0.6942176818847656, 
fpr: 0.3129548762736536, tpr: 0.8206048180420298, threshold: 0.6893373131752014, 
fpr: 0.314410480349345, tpr: 0.8206048180420298, threshold: 0.6892960071563721, 
fpr: 0.314410480349345, tpr: 0.8211173757047668, threshold: 0.6890531778335571, 
fpr: 0.3158660844250364, tpr: 0.8211173757047668, threshold: 0.6883344054222107, 
fpr: 0.3158660844250364, tpr: 0.822142491030241, threshold: 0.6868793964385986, 
fpr: 0.31877729257641924, tpr: 0.822142491030241, threshold: 0.6835507750511169, 
fpr: 0.31877729257641924, tpr: 0.8262429523321374, threshold: 0.6792594194412231, 
fpr: 0.32023289665211063, tpr: 0.8262429523321374, threshold: 0.6788753867149353, 
fpr: 0.32023289665211063, tpr: 0.8272680676576115, threshold: 0.6775674819946289, 
fpr: 0.32168850072780203, tpr: 0.8272680676576115, threshold: 0.6766266226768494, 
fpr: 0.32168850072780203, tpr: 0.8298308559712968, threshold: 0.673096239566803, 
fpr: 0.3231441048034934, tpr: 0.8298308559712968, threshold: 0.6724578142166138, 
fpr: 0.3231441048034934, tpr: 0.8303434136340339, threshold: 0.6720598340034485, 
fpr: 0.3245997088791849, tpr: 0.8303434136340339, threshold: 0.6706750988960266, 
fpr: 0.3245997088791849, tpr: 0.831881086622245, threshold: 0.6668247580528259, 
fpr: 0.3260553129548763, tpr: 0.831881086622245, threshold: 0.6659096479415894, 
fpr: 0.3260553129548763, tpr: 0.8323936442849821, threshold: 0.6659062504768372, 
fpr: 0.3289665211062591, tpr: 0.8323936442849821, threshold: 0.6646000146865845, 
fpr: 0.3289665211062591, tpr: 0.8354689902614044, threshold: 0.6596740484237671, 
fpr: 0.3304221251819505, tpr: 0.8354689902614044, threshold: 0.6588097810745239, 
fpr: 0.3304221251819505, tpr: 0.8370066632496156, threshold: 0.6563329100608826, 
fpr: 0.3318777292576419, tpr: 0.8370066632496156, threshold: 0.6562612056732178, 
fpr: 0.3318777292576419, tpr: 0.8395694515633009, threshold: 0.6528291702270508, 
fpr: 0.3333333333333333, tpr: 0.8395694515633009, threshold: 0.6513078212738037, 
fpr: 0.3333333333333333, tpr: 0.8400820092260379, threshold: 0.6510927081108093, 
fpr: 0.33478893740902477, tpr: 0.8400820092260379, threshold: 0.6507768034934998, 
fpr: 0.33478893740902477, tpr: 0.8487954894925679, threshold: 0.6342179775238037, 
fpr: 0.33624454148471616, tpr: 0.8487954894925679, threshold: 0.6331686973571777, 
fpr: 0.33624454148471616, tpr: 0.8523833931317273, threshold: 0.6245291233062744, 
fpr: 0.33770014556040756, tpr: 0.8523833931317273, threshold: 0.6245015263557434, 
fpr: 0.33770014556040756, tpr: 0.8549461814454126, threshold: 0.6201093792915344, 
fpr: 0.33915574963609896, tpr: 0.8549461814454126, threshold: 0.6200351715087891, 
fpr: 0.33915574963609896, tpr: 0.8554587391081496, threshold: 0.6185898780822754, 
fpr: 0.3406113537117904, tpr: 0.8554587391081496, threshold: 0.6178204417228699, 
fpr: 0.3406113537117904, tpr: 0.8580215274218349, threshold: 0.6124337315559387, 
fpr: 0.3420669577874818, tpr: 0.8580215274218349, threshold: 0.6094387173652649, 
fpr: 0.3420669577874818, tpr: 0.8595592004100461, threshold: 0.6073094606399536, 
fpr: 0.34497816593886466, tpr: 0.8595592004100461, threshold: 0.6061610579490662, 
fpr: 0.34497816593886466, tpr: 0.8610968733982574, threshold: 0.605369508266449, 
fpr: 0.34788937409024745, tpr: 0.8610968733982574, threshold: 0.6041457056999207, 
fpr: 0.34788937409024745, tpr: 0.8616094310609944, threshold: 0.6039934754371643, 
fpr: 0.3522561863173217, tpr: 0.8616094310609944, threshold: 0.6011967658996582, 
fpr: 0.3522561863173217, tpr: 0.8662224500256279, threshold: 0.5921393036842346, 
fpr: 0.3537117903930131, tpr: 0.8662224500256279, threshold: 0.5919841527938843, 
fpr: 0.3537117903930131, tpr: 0.867247565351102, threshold: 0.5871866345405579, 
fpr: 0.3609898107714702, tpr: 0.867247565351102, threshold: 0.5824716091156006, 
fpr: 0.3609898107714702, tpr: 0.8677601230138391, threshold: 0.5808674097061157, 
fpr: 0.3624454148471616, tpr: 0.8677601230138391, threshold: 0.5800269842147827, 
fpr: 0.3624454148471616, tpr: 0.8687852383393132, threshold: 0.5793786644935608, 
fpr: 0.36681222707423583, tpr: 0.8687852383393132, threshold: 0.572629988193512, 
fpr: 0.36681222707423583, tpr: 0.8708354689902614, threshold: 0.5669674873352051, 
fpr: 0.3682678311499272, tpr: 0.8708354689902614, threshold: 0.5669125318527222, 
fpr: 0.3682678311499272, tpr: 0.8718605843157355, threshold: 0.5666065812110901, 
fpr: 0.37117903930131, tpr: 0.8718605843157355, threshold: 0.5664026737213135, 
fpr: 0.37117903930131, tpr: 0.8744233726294208, threshold: 0.5608748197555542, 
fpr: 0.3726346433770015, tpr: 0.8744233726294208, threshold: 0.5577417612075806, 
fpr: 0.3726346433770015, tpr: 0.8749359302921579, threshold: 0.5535873174667358, 
fpr: 0.37409024745269287, tpr: 0.8749359302921579, threshold: 0.5527791976928711, 
fpr: 0.37409024745269287, tpr: 0.8769861609431061, threshold: 0.5503123998641968, 
fpr: 0.37700145560407566, tpr: 0.8769861609431061, threshold: 0.5484048128128052, 
fpr: 0.37700145560407566, tpr: 0.8774987186058432, threshold: 0.5483461022377014, 
fpr: 0.38282387190684136, tpr: 0.8774987186058432, threshold: 0.5427563190460205, 
fpr: 0.38282387190684136, tpr: 0.8785238339313173, threshold: 0.5414564609527588, 
fpr: 0.38427947598253276, tpr: 0.8785238339313173, threshold: 0.5413456559181213, 
fpr: 0.38427947598253276, tpr: 0.8815991799077396, threshold: 0.530521810054779, 
fpr: 0.38573508005822416, tpr: 0.8815991799077396, threshold: 0.5284623503684998, 
fpr: 0.38573508005822416, tpr: 0.8862121988723731, threshold: 0.5164656639099121, 
fpr: 0.388646288209607, tpr: 0.8862121988723731, threshold: 0.5133166909217834, 
fpr: 0.388646288209607, tpr: 0.8877498718605843, threshold: 0.5107901096343994, 
fpr: 0.3915574963609898, tpr: 0.8877498718605843, threshold: 0.5086516737937927, 
fpr: 0.3915574963609898, tpr: 0.8898001025115325, threshold: 0.4999978542327881, 
fpr: 0.3930131004366812, tpr: 0.8898001025115325, threshold: 0.4997125267982483, 
fpr: 0.3930131004366812, tpr: 0.8903126601742696, threshold: 0.4995231330394745, 
fpr: 0.39446870451237265, tpr: 0.8903126601742696, threshold: 0.49813112616539, 
fpr: 0.39446870451237265, tpr: 0.8908252178370066, threshold: 0.49454331398010254, 
fpr: 0.3988355167394469, tpr: 0.8908252178370066, threshold: 0.49266400933265686, 
fpr: 0.3988355167394469, tpr: 0.8918503331624807, threshold: 0.48738452792167664, 
fpr: 0.4002911208151383, tpr: 0.8918503331624807, threshold: 0.48555639386177063, 
fpr: 0.4002911208151383, tpr: 0.8928754484879549, threshold: 0.4843434691429138, 
fpr: 0.4017467248908297, tpr: 0.8928754484879549, threshold: 0.48422348499298096, 
fpr: 0.4017467248908297, tpr: 0.8933880061506919, threshold: 0.48409146070480347, 
fpr: 0.4032023289665211, tpr: 0.8933880061506919, threshold: 0.4829838275909424, 
fpr: 0.4032023289665211, tpr: 0.894413121476166, threshold: 0.4805791974067688, 
fpr: 0.40465793304221254, tpr: 0.894413121476166, threshold: 0.48022913932800293, 
fpr: 0.40465793304221254, tpr: 0.8964633521271143, threshold: 0.47606030106544495, 
fpr: 0.40611353711790393, tpr: 0.8964633521271143, threshold: 0.4759266972541809, 
fpr: 0.40611353711790393, tpr: 0.8980010251153254, threshold: 0.4726312756538391, 
fpr: 0.40756914119359533, tpr: 0.8980010251153254, threshold: 0.4709201455116272, 
fpr: 0.40756914119359533, tpr: 0.9015889287544849, threshold: 0.46404919028282166, 
fpr: 0.4090247452692867, tpr: 0.9015889287544849, threshold: 0.46299415826797485, 
fpr: 0.4090247452692867, tpr: 0.9031266017426961, threshold: 0.4565061926841736, 
fpr: 0.4104803493449782, tpr: 0.9031266017426961, threshold: 0.4553373456001282, 
fpr: 0.4104803493449782, tpr: 0.9062019477191184, threshold: 0.4509912133216858, 
fpr: 0.413391557496361, tpr: 0.9062019477191184, threshold: 0.44740551710128784, 
fpr: 0.4570596797671033, tpr: 0.9062019477191184, threshold: 0.4469292461872101, 
fpr: 0.4570596797671033, tpr: 0.9067145053818555, threshold: 0.44641655683517456, 
fpr: 0.46142649199417757, tpr: 0.9067145053818555, threshold: 0.44274088740348816, 
fpr: 0.46142649199417757, tpr: 0.9082521783700667, threshold: 0.4410243630409241, 
fpr: 0.4672489082969432, tpr: 0.9082521783700667, threshold: 0.4353475868701935, 
fpr: 0.4672489082969432, tpr: 0.9087647360328037, threshold: 0.4332634508609772, 
fpr: 0.47307132459970885, tpr: 0.9087647360328037, threshold: 0.42865633964538574, 
fpr: 0.47307132459970885, tpr: 0.9103024090210149, threshold: 0.4261553883552551, 
fpr: 0.4745269286754003, tpr: 0.9103024090210149, threshold: 0.4243459701538086, 
fpr: 0.4745269286754003, tpr: 0.9123526396719631, threshold: 0.4208312928676605, 
fpr: 0.48180494905385735, tpr: 0.9123526396719631, threshold: 0.40734320878982544, 
fpr: 0.48180494905385735, tpr: 0.9138903126601743, threshold: 0.40157923102378845, 
fpr: 0.4861717612809316, tpr: 0.9138903126601743, threshold: 0.39103689789772034, 
fpr: 0.4861717612809316, tpr: 0.9159405433111225, threshold: 0.38688772916793823, 
fpr: 0.487627365356623, tpr: 0.9159405433111225, threshold: 0.3851156234741211, 
fpr: 0.487627365356623, tpr: 0.9164531009738596, threshold: 0.3847416043281555, 
fpr: 0.4890829694323144, tpr: 0.9164531009738596, threshold: 0.3835315406322479, 
fpr: 0.4890829694323144, tpr: 0.9185033316248078, threshold: 0.3791182339191437, 
fpr: 0.49053857350800584, tpr: 0.9185033316248078, threshold: 0.37831783294677734, 
fpr: 0.49053857350800584, tpr: 0.9190158892875449, threshold: 0.37829798460006714, 
fpr: 0.49344978165938863, tpr: 0.9190158892875449, threshold: 0.3732092082500458, 
fpr: 0.49344978165938863, tpr: 0.9195284469502819, threshold: 0.37214896082878113, 
fpr: 0.4978165938864629, tpr: 0.9195284469502819, threshold: 0.36738231778144836, 
fpr: 0.4978165938864629, tpr: 0.920553562275756, threshold: 0.3640383183956146, 
fpr: 0.4992721979621543, tpr: 0.920553562275756, threshold: 0.359371542930603, 
fpr: 0.4992721979621543, tpr: 0.9210661199384931, threshold: 0.35835182666778564, 
fpr: 0.5036390101892285, tpr: 0.9210661199384931, threshold: 0.3553594946861267, 
fpr: 0.5036390101892285, tpr: 0.9246540235776525, threshold: 0.34620362520217896, 
fpr: 0.50509461426492, tpr: 0.9246540235776525, threshold: 0.3457970917224884, 
fpr: 0.50509461426492, tpr: 0.9256791389031266, threshold: 0.3419673442840576, 
fpr: 0.5065502183406113, tpr: 0.9256791389031266, threshold: 0.34087762236595154, 
fpr: 0.5065502183406113, tpr: 0.9261916965658636, threshold: 0.3408048748970032, 
fpr: 0.5080058224163028, tpr: 0.9261916965658636, threshold: 0.33970239758491516, 
fpr: 0.5080058224163028, tpr: 0.9277293695540748, threshold: 0.33254215121269226, 
fpr: 0.5094614264919942, tpr: 0.9277293695540748, threshold: 0.3308054208755493, 
fpr: 0.5094614264919942, tpr: 0.929779600205023, threshold: 0.32636865973472595, 
fpr: 0.5109170305676856, tpr: 0.929779600205023, threshold: 0.3247802257537842, 
fpr: 0.5109170305676856, tpr: 0.9313172731932342, threshold: 0.324160635471344, 
fpr: 0.5152838427947598, tpr: 0.9313172731932342, threshold: 0.3176926076412201, 
fpr: 0.5152838427947598, tpr: 0.9323423885187083, threshold: 0.31680309772491455, 
fpr: 0.5167394468704513, tpr: 0.9323423885187083, threshold: 0.3156018853187561, 
fpr: 0.5167394468704513, tpr: 0.9338800615069195, threshold: 0.31247395277023315, 
fpr: 0.5181950509461426, tpr: 0.9338800615069195, threshold: 0.3113362491130829, 
fpr: 0.5181950509461426, tpr: 0.9349051768323936, threshold: 0.3101073205471039, 
fpr: 0.5225618631732168, tpr: 0.9349051768323936, threshold: 0.30756694078445435, 
fpr: 0.5225618631732168, tpr: 0.9359302921578677, threshold: 0.30652400851249695, 
fpr: 0.5240174672489083, tpr: 0.9359302921578677, threshold: 0.30437397956848145, 
fpr: 0.5240174672489083, tpr: 0.9364428498206048, threshold: 0.30211305618286133, 
fpr: 0.5254730713245997, tpr: 0.9364428498206048, threshold: 0.30181533098220825, 
fpr: 0.5254730713245997, tpr: 0.9369554074833418, threshold: 0.2985144257545471, 
fpr: 0.5269286754002911, tpr: 0.9369554074833418, threshold: 0.2976221740245819, 
fpr: 0.5269286754002911, tpr: 0.9374679651460789, threshold: 0.2965857982635498, 
fpr: 0.5283842794759825, tpr: 0.9374679651460789, threshold: 0.2948123514652252, 
fpr: 0.5283842794759825, tpr: 0.938493080471553, threshold: 0.2931079864501953, 
fpr: 0.5312954876273653, tpr: 0.938493080471553, threshold: 0.2885203957557678, 
fpr: 0.5312954876273653, tpr: 0.93900563813429, threshold: 0.28558996319770813, 
fpr: 0.5342066957787481, tpr: 0.93900563813429, threshold: 0.2833320200443268, 
fpr: 0.5342066957787481, tpr: 0.9400307534597643, threshold: 0.2830655574798584, 
fpr: 0.5414847161572053, tpr: 0.9400307534597643, threshold: 0.2796126902103424, 
fpr: 0.5414847161572053, tpr: 0.9415684264479754, threshold: 0.2743445932865143, 
fpr: 0.5458515283842795, tpr: 0.9415684264479754, threshold: 0.2736426293849945, 
fpr: 0.5458515283842795, tpr: 0.9420809841107125, threshold: 0.2733813524246216, 
fpr: 0.5487627365356623, tpr: 0.9420809841107125, threshold: 0.2730123996734619, 
fpr: 0.5487627365356623, tpr: 0.9425935417734496, threshold: 0.27261051535606384, 
fpr: 0.5502183406113537, tpr: 0.9425935417734496, threshold: 0.2708262801170349, 
fpr: 0.5502183406113537, tpr: 0.9446437724243978, threshold: 0.269540935754776, 
fpr: 0.5531295487627366, tpr: 0.9446437724243978, threshold: 0.265600323677063, 
fpr: 0.5531295487627366, tpr: 0.9451563300871348, threshold: 0.26546430587768555, 
fpr: 0.5560407569141194, tpr: 0.9451563300871348, threshold: 0.2631930112838745, 
fpr: 0.5560407569141194, tpr: 0.9456688877498719, threshold: 0.26300179958343506, 
fpr: 0.5574963609898108, tpr: 0.9456688877498719, threshold: 0.26183366775512695, 
fpr: 0.5574963609898108, tpr: 0.946694003075346, threshold: 0.2601487636566162, 
fpr: 0.5604075691411936, tpr: 0.946694003075346, threshold: 0.259523868560791, 
fpr: 0.5604075691411936, tpr: 0.9477191184008201, threshold: 0.25776875019073486, 
fpr: 0.5618631732168851, tpr: 0.9477191184008201, threshold: 0.25666141510009766, 
fpr: 0.5618631732168851, tpr: 0.9492567913890313, threshold: 0.2544049918651581, 
fpr: 0.5647743813682679, tpr: 0.9492567913890313, threshold: 0.25218257308006287, 
fpr: 0.5647743813682679, tpr: 0.9502819067145054, threshold: 0.2517136335372925, 
fpr: 0.5735080058224163, tpr: 0.9502819067145054, threshold: 0.2446385771036148, 
fpr: 0.5735080058224163, tpr: 0.9513070220399795, threshold: 0.24248167872428894, 
fpr: 0.5778748180494906, tpr: 0.9513070220399795, threshold: 0.24103394150733948, 
fpr: 0.5778748180494906, tpr: 0.9518195797027166, threshold: 0.2382577657699585, 
fpr: 0.5793304221251819, tpr: 0.9518195797027166, threshold: 0.23821492493152618, 
fpr: 0.5793304221251819, tpr: 0.9523321373654536, threshold: 0.23726971447467804, 
fpr: 0.5807860262008734, tpr: 0.9523321373654536, threshold: 0.23724114894866943, 
fpr: 0.5807860262008734, tpr: 0.9528446950281907, threshold: 0.23705504834651947, 
fpr: 0.5822416302765647, tpr: 0.9528446950281907, threshold: 0.23701687157154083, 
fpr: 0.5822416302765647, tpr: 0.9533572526909277, threshold: 0.23660551011562347, 
fpr: 0.5836972343522562, tpr: 0.9533572526909277, threshold: 0.23477846384048462, 
fpr: 0.5836972343522562, tpr: 0.9543823680164019, threshold: 0.2334739863872528, 
fpr: 0.5851528384279476, tpr: 0.9543823680164019, threshold: 0.23290793597698212, 
fpr: 0.5851528384279476, tpr: 0.9548949256791389, threshold: 0.23221050202846527, 
fpr: 0.5909752547307132, tpr: 0.9548949256791389, threshold: 0.22654521465301514, 
fpr: 0.5909752547307132, tpr: 0.955407483341876, threshold: 0.22652272880077362, 
fpr: 0.5924308588064047, tpr: 0.955407483341876, threshold: 0.22627121210098267, 
fpr: 0.5924308588064047, tpr: 0.9564325986673501, threshold: 0.22541576623916626, 
fpr: 0.5953420669577875, tpr: 0.9564325986673501, threshold: 0.22247673571109772, 
fpr: 0.5953420669577875, tpr: 0.9574577139928242, threshold: 0.22116924822330475, 
fpr: 0.6011644832605532, tpr: 0.9574577139928242, threshold: 0.21660609543323517, 
fpr: 0.6011644832605532, tpr: 0.9579702716555613, threshold: 0.21412429213523865, 
fpr: 0.604075691411936, tpr: 0.9579702716555613, threshold: 0.2139490395784378, 
fpr: 0.604075691411936, tpr: 0.9589953869810354, threshold: 0.21272335946559906, 
fpr: 0.6069868995633187, tpr: 0.9589953869810354, threshold: 0.21216601133346558, 
fpr: 0.6069868995633187, tpr: 0.9600205023065095, threshold: 0.20733635127544403, 
fpr: 0.6098981077147017, tpr: 0.9600205023065095, threshold: 0.20537295937538147, 
fpr: 0.6098981077147017, tpr: 0.9605330599692465, threshold: 0.2053612470626831, 
fpr: 0.611353711790393, tpr: 0.9605330599692465, threshold: 0.20448894798755646, 
fpr: 0.611353711790393, tpr: 0.9610456176319836, threshold: 0.2042447030544281, 
fpr: 0.6128093158660844, tpr: 0.9610456176319836, threshold: 0.20323875546455383, 
fpr: 0.6128093158660844, tpr: 0.9620707329574577, threshold: 0.20152795314788818, 
fpr: 0.6142649199417758, tpr: 0.9620707329574577, threshold: 0.20100553333759308, 
fpr: 0.6142649199417758, tpr: 0.9630958482829318, threshold: 0.19987979531288147, 
fpr: 0.61863173216885, tpr: 0.9630958482829318, threshold: 0.19765090942382812, 
fpr: 0.61863173216885, tpr: 0.9656586365966171, threshold: 0.19524487853050232, 
fpr: 0.6215429403202329, tpr: 0.9656586365966171, threshold: 0.19461971521377563, 
fpr: 0.6215429403202329, tpr: 0.9661711942593542, threshold: 0.19437645375728607, 
fpr: 0.6229985443959243, tpr: 0.9661711942593542, threshold: 0.19431257247924805, 
fpr: 0.6229985443959243, tpr: 0.9666837519220912, threshold: 0.19224359095096588, 
fpr: 0.6317321688500728, tpr: 0.9666837519220912, threshold: 0.18676668405532837, 
fpr: 0.6317321688500728, tpr: 0.9682214249103024, threshold: 0.18597927689552307, 
fpr: 0.6331877729257642, tpr: 0.9682214249103024, threshold: 0.18468573689460754, 
fpr: 0.6331877729257642, tpr: 0.9687339825730394, threshold: 0.1842813491821289, 
fpr: 0.6346433770014556, tpr: 0.9687339825730394, threshold: 0.18369309604167938, 
fpr: 0.6346433770014556, tpr: 0.9697590978985136, threshold: 0.18298935890197754, 
fpr: 0.6375545851528385, tpr: 0.9697590978985136, threshold: 0.17956000566482544, 
fpr: 0.6375545851528385, tpr: 0.9702716555612506, threshold: 0.17864926159381866, 
fpr: 0.6390101892285298, tpr: 0.9702716555612506, threshold: 0.17849643528461456, 
fpr: 0.6390101892285298, tpr: 0.9707842132239877, threshold: 0.17835597693920135, 
fpr: 0.6404657933042213, tpr: 0.9707842132239877, threshold: 0.17807213962078094, 
fpr: 0.6404657933042213, tpr: 0.9712967708867247, threshold: 0.17799434065818787, 
fpr: 0.6477438136826783, tpr: 0.9712967708867247, threshold: 0.17128807306289673, 
fpr: 0.6477438136826783, tpr: 0.9718093285494618, threshold: 0.1709892451763153, 
fpr: 0.6506550218340611, tpr: 0.9718093285494618, threshold: 0.16865013539791107, 
fpr: 0.6506550218340611, tpr: 0.9728344438749359, threshold: 0.16828930377960205, 
fpr: 0.6564774381368268, tpr: 0.9728344438749359, threshold: 0.16662123799324036, 
fpr: 0.6564774381368268, tpr: 0.973347001537673, threshold: 0.16605299711227417, 
fpr: 0.6681222707423581, tpr: 0.973347001537673, threshold: 0.15948903560638428, 
fpr: 0.6681222707423581, tpr: 0.9743721168631471, threshold: 0.15843337774276733, 
fpr: 0.6724890829694323, tpr: 0.9743721168631471, threshold: 0.15801462531089783, 
fpr: 0.6724890829694323, tpr: 0.9748846745258841, threshold: 0.15607602894306183, 
fpr: 0.6826783114992722, tpr: 0.9748846745258841, threshold: 0.14908747375011444, 
fpr: 0.6826783114992722, tpr: 0.9759097898513582, threshold: 0.1470596343278885, 
fpr: 0.6943231441048034, tpr: 0.9759097898513582, threshold: 0.14293457567691803, 
fpr: 0.6943231441048034, tpr: 0.9764223475140953, threshold: 0.13918712735176086, 
fpr: 0.6957787481804949, tpr: 0.9764223475140953, threshold: 0.13870468735694885, 
fpr: 0.6957787481804949, tpr: 0.9779600205023065, threshold: 0.13749825954437256, 
fpr: 0.6986899563318777, tpr: 0.9779600205023065, threshold: 0.1365659236907959, 
fpr: 0.6986899563318777, tpr: 0.9784725781650435, threshold: 0.1355660855770111, 
fpr: 0.7074235807860262, tpr: 0.9784725781650435, threshold: 0.13345809280872345, 
fpr: 0.7074235807860262, tpr: 0.9789851358277806, threshold: 0.13317115604877472, 
fpr: 0.7088791848617176, tpr: 0.9789851358277806, threshold: 0.132985919713974, 
fpr: 0.7088791848617176, tpr: 0.9794976934905176, threshold: 0.13243718445301056, 
fpr: 0.7117903930131004, tpr: 0.9794976934905176, threshold: 0.13148123025894165, 
fpr: 0.7117903930131004, tpr: 0.9805228088159919, threshold: 0.1294604390859604, 
fpr: 0.7132459970887919, tpr: 0.9805228088159919, threshold: 0.12881188094615936, 
fpr: 0.7132459970887919, tpr: 0.9810353664787289, threshold: 0.12822866439819336, 
fpr: 0.7176128093158661, tpr: 0.9810353664787289, threshold: 0.12762510776519775, 
fpr: 0.7176128093158661, tpr: 0.981547924141466, threshold: 0.12709607183933258, 
fpr: 0.7205240174672489, tpr: 0.981547924141466, threshold: 0.12521424889564514, 
fpr: 0.7205240174672489, tpr: 0.982060481804203, threshold: 0.12483847141265869, 
fpr: 0.7379912663755459, tpr: 0.982060481804203, threshold: 0.11896786838769913, 
fpr: 0.7379912663755459, tpr: 0.9830855971296771, threshold: 0.117226742208004, 
fpr: 0.7394468704512372, tpr: 0.9830855971296771, threshold: 0.1162986159324646, 
fpr: 0.7394468704512372, tpr: 0.9835981547924142, threshold: 0.1154722198843956, 
fpr: 0.7554585152838428, tpr: 0.9835981547924142, threshold: 0.10591937601566315, 
fpr: 0.7554585152838428, tpr: 0.9841107124551512, threshold: 0.10572107881307602, 
fpr: 0.7656477438136827, tpr: 0.9841107124551512, threshold: 0.10230951011180878, 
fpr: 0.7656477438136827, tpr: 0.9846232701178883, threshold: 0.10221464931964874, 
fpr: 0.7685589519650655, tpr: 0.9846232701178883, threshold: 0.10177451372146606, 
fpr: 0.7685589519650655, tpr: 0.9856483854433624, threshold: 0.10098255425691605, 
fpr: 0.7714701601164483, tpr: 0.9856483854433624, threshold: 0.10091368108987808, 
fpr: 0.7714701601164483, tpr: 0.9861609431060995, threshold: 0.09868863970041275, 
fpr: 0.7743813682678311, tpr: 0.9861609431060995, threshold: 0.09811461716890335, 
fpr: 0.7743813682678311, tpr: 0.9866735007688365, threshold: 0.09796424955129623, 
fpr: 0.7787481804949054, tpr: 0.9866735007688365, threshold: 0.09634764492511749, 
fpr: 0.7787481804949054, tpr: 0.9871860584315736, threshold: 0.09625529497861862, 
fpr: 0.784570596797671, tpr: 0.9871860584315736, threshold: 0.09484229981899261, 
fpr: 0.784570596797671, tpr: 0.9876986160943106, threshold: 0.09323039650917053, 
fpr: 0.7933042212518195, tpr: 0.9876986160943106, threshold: 0.0913497805595398, 
fpr: 0.7933042212518195, tpr: 0.9882111737570477, threshold: 0.09066041558980942, 
fpr: 0.8165938864628821, tpr: 0.9882111737570477, threshold: 0.08185387402772903, 
fpr: 0.8165938864628821, tpr: 0.9892362890825218, threshold: 0.07919257134199142, 
fpr: 0.8195050946142649, tpr: 0.9892362890825218, threshold: 0.07844894379377365, 
fpr: 0.8195050946142649, tpr: 0.9902614044079959, threshold: 0.07777109742164612, 
fpr: 0.8224163027656477, tpr: 0.9902614044079959, threshold: 0.07724738121032715, 
fpr: 0.8224163027656477, tpr: 0.990773962070733, threshold: 0.07628775388002396, 
fpr: 0.8311499272197962, tpr: 0.990773962070733, threshold: 0.07267392426729202, 
fpr: 0.8311499272197962, tpr: 0.99128651973347, threshold: 0.07229006290435791, 
fpr: 0.8355167394468704, tpr: 0.99128651973347, threshold: 0.07190393656492233, 
fpr: 0.8355167394468704, tpr: 0.9917990773962071, threshold: 0.07143714278936386, 
fpr: 0.8617176128093159, tpr: 0.9917990773962071, threshold: 0.06397492438554764, 
fpr: 0.8617176128093159, tpr: 0.9923116350589442, threshold: 0.06334355473518372, 
fpr: 0.8675400291120815, tpr: 0.9923116350589442, threshold: 0.061157189309597015, 
fpr: 0.8675400291120815, tpr: 0.9928241927216812, threshold: 0.06044096127152443, 
fpr: 0.883551673944687, tpr: 0.9928241927216812, threshold: 0.05607140436768532, 
fpr: 0.883551673944687, tpr: 0.9933367503844183, threshold: 0.05574518069624901, 
fpr: 0.8850072780203785, tpr: 0.9933367503844183, threshold: 0.053788188844919205, 
fpr: 0.8850072780203785, tpr: 0.9938493080471553, threshold: 0.05318798869848251, 
fpr: 0.8981077147016011, tpr: 0.9938493080471553, threshold: 0.04839319363236427, 
fpr: 0.8981077147016011, tpr: 0.9943618657098924, threshold: 0.04785031080245972, 
fpr: 0.9068413391557496, tpr: 0.9943618657098924, threshold: 0.043601974844932556, 
fpr: 0.9068413391557496, tpr: 0.9948744233726294, threshold: 0.04303339123725891, 
fpr: 0.9286754002911208, tpr: 0.9948744233726294, threshold: 0.026702459901571274, 
fpr: 0.9286754002911208, tpr: 0.9953869810353665, threshold: 0.026577159762382507, 
fpr: 0.9315866084425036, tpr: 0.9953869810353665, threshold: 0.025950638577342033, 
fpr: 0.9315866084425036, tpr: 0.9958995386981035, threshold: 0.02524292655289173, 
fpr: 0.9344978165938864, tpr: 0.9958995386981035, threshold: 0.024422537535429, 
fpr: 0.9344978165938864, tpr: 0.9964120963608406, threshold: 0.023950528353452682, 
fpr: 0.9534206695778749, tpr: 0.9964120963608406, threshold: 0.014136901125311852, 
fpr: 0.9534206695778749, tpr: 0.9969246540235777, threshold: 0.01403233502060175, 
fpr: 0.9563318777292577, tpr: 0.9969246540235777, threshold: 0.01397501491010189, 
fpr: 0.9563318777292577, tpr: 0.9974372116863147, threshold: 0.013437733054161072, 
fpr: 0.9606986899563319, tpr: 0.9974372116863147, threshold: 0.0126180499792099, 
fpr: 0.9606986899563319, tpr: 0.9979497693490518, threshold: 0.012323842383921146, 
fpr: 0.975254730713246, tpr: 0.9979497693490518, threshold: 0.01097002811729908, 
fpr: 0.975254730713246, tpr: 0.9984623270117888, threshold: 0.010920916683971882, 
fpr: 0.9883551673944687, tpr: 0.9984623270117888, threshold: 0.007937029004096985, 
fpr: 0.9883551673944687, tpr: 0.9989748846745259, threshold: 0.007446092553436756, 
fpr: 0.9898107714701602, tpr: 0.9989748846745259, threshold: 0.00578944431617856, 
fpr: 0.9898107714701602, tpr: 0.9994874423372629, threshold: 0.005546736530959606, 
fpr: 0.9941775836972343, tpr: 0.9994874423372629, threshold: 0.004636621102690697, 
fpr: 0.9941775836972343, tpr: 1.0, threshold: 0.0027577129658311605, 
fpr: 1.0, tpr: 1.0, threshold: 0.00037488710950128734, 

best_threshold: 0.6073094606399536, best_fpr: 0.3420669577874818, best_tpr: 0.8595592004100461
